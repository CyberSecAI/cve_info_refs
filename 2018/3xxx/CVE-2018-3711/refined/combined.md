=== Content from github.com_8de11147_20250124_213253.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffastify%2Ffastify%2Fpull%2F627)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffastify%2Ffastify%2Fpull%2F627)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=fastify%2Ffastify)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[fastify](/fastify)
/
**[fastify](/fastify/fastify)**
Public

* [Notifications](/login?return_to=%2Ffastify%2Ffastify) You must be signed in to change notification settings
* [Fork
  2.3k](/login?return_to=%2Ffastify%2Ffastify)
* [Star
   32.9k](/login?return_to=%2Ffastify%2Ffastify)

* [Code](/fastify/fastify)
* [Issues
  60](/fastify/fastify/issues)
* [Pull requests
  32](/fastify/fastify/pulls)
* [Discussions](/fastify/fastify/discussions)
* [Actions](/fastify/fastify/actions)
* [Projects
  0](/fastify/fastify/projects)
* [Security](/fastify/fastify/security)
* [Insights](/fastify/fastify/pulse)

Additional navigation options

* [Code](/fastify/fastify)
* [Issues](/fastify/fastify/issues)
* [Pull requests](/fastify/fastify/pulls)
* [Discussions](/fastify/fastify/discussions)
* [Actions](/fastify/fastify/actions)
* [Projects](/fastify/fastify/projects)
* [Security](/fastify/fastify/security)
* [Insights](/fastify/fastify/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Ffastify%2Ffastify%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Ffastify%2Ffastify%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Add option to limit the size of request bodies for the default body parser #627

 Merged

[delvedor](/delvedor)
merged 3 commits into
[fastify:master](/fastify/fastify/tree/master "fastify/fastify:master")
from
[nwoltman:json-limit](/nwoltman/fastify/tree/json-limit "nwoltman/fastify:json-limit")

Jan 8, 2018

 Merged

# [Add option to limit the size of request bodies for the default body parser](#top) #627

[delvedor](/delvedor)
merged 3 commits into
[fastify:master](/fastify/fastify/tree/master "fastify/fastify:master")
from
[nwoltman:json-limit](/nwoltman/fastify/tree/json-limit "nwoltman/fastify:json-limit")

Jan 8, 2018

[Conversation
41](/fastify/fastify/pull/627)
[Commits
3](/fastify/fastify/pull/627/commits)
[Checks
0](/fastify/fastify/pull/627/checks)
[Files changed](/fastify/fastify/pull/627/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![nwoltman](https://avatars.githubusercontent.com/u/5128013?s=60&v=4)](/nwoltman)

Copy link

Contributor

### @nwoltman **[nwoltman](/nwoltman)** commented [Jan 7, 2018](#issue-286550146) • edited Loading

Adds a `jsonBodyLimit` option that can be configured with the initial `fastify` call and at routes.

```
const fastify = require('fastify')({ jsonBodyLimit: 1000 })

fastify.route({
  method: 'POST'
  url: '/form',
  jsonBodyLimit: 10000,
  handler() { ... }
})
```

Default limit is `1 MiB`.

#### Checklist

* run `npm run test` and `npm run benchmark`
* tests and/or benchmarks are included
* documentation is changed or added
* commit message and code follows [Code of conduct](https://github.com/fastify/fastify/blob/master/CODE_OF_CONDUCT.md)

Sorry, something went wrong.

All reactions

 [![@nwoltman](https://avatars.githubusercontent.com/u/5128013?s=40&u=70f7f1e517d2ed18cdf75057014fa6529d836f13&v=4)](/nwoltman)
[nwoltman](/nwoltman)
requested review from
[mcollina](/mcollina),
[jsumners](/jsumners),
[allevo](/allevo),
[StarpTech](/StarpTech) and
[delvedor](/delvedor)
[January 7, 2018 07:14](#event-1412650806)

[![mcollina](https://avatars.githubusercontent.com/u/52195?s=60&v=4)](/mcollina)

**[mcollina](/mcollina)**
reviewed
[Jan 7, 2018](#pullrequestreview-87094725)

 [View reviewed changes](/fastify/fastify/pull/627/files)

[test/fastify-options.test.js](/fastify/fastify/pull/627/files#diff-779dd0a3f43fef08c0116aa72289778b0eea88d942d0c3c7eb5f5ebd7b1e6463)
Outdated

|  |  | const t = require('tap') |
| --- | --- | --- |
|  |  | const test = t.test |
|  |  |  |
|  |  | test('jsonBodyLimit option', t => { |

Copy link

Member

### @mcollina **[mcollina](/mcollina)** [Jan 7, 2018](#discussion_r160044840)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

can you just name this file ‘jsonBodyLimit’?

Sorry, something went wrong.

All reactions

[lib/handleRequest.js](/fastify/fastify/pull/627/files#diff-15a9e086692377c86b02752c54c928f4ca6f697758fc5dacc09bbde1d2dff96b)
Outdated

|  |  | } |
| --- | --- | --- |
|  |  |  |
|  |  | const req = request.req |
|  |  | const chunks = [] |

Copy link

Member

### @mcollina **[mcollina](/mcollina)** [Jan 7, 2018](#discussion_r160044861)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I’m confident that accumulating as a string is faster that accumulating in an array. Can you restore that?

You can call setEncoding(‘utf8’) to avoid relying on defaults.

Sorry, something went wrong.

All reactions

Copy link

Member

### @mcollina **[mcollina](/mcollina)** [Jan 7, 2018](#discussion_r160044889)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Or you can keep receiving buffers, but accumulate as String (it might be simpler to do the rest of the checks.

Sorry, something went wrong.

All reactions

Copy link

Member

### @delvedor **[delvedor](/delvedor)** [Jan 7, 2018](#discussion_r160045703)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Agree with [@mcollina](https://github.com/mcollina).

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @nwoltman **[nwoltman](/nwoltman)** [Jan 7, 2018](#discussion_r160056992)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

After some benchmarking, I found that you're right [@mcollina](https://github.com/mcollina), accumulating as a string is faster.

I also found that performance can be doubled by doing

`body += chunk.toString()` rather than `body += chunk`.

Sorry, something went wrong.

 👍
1
 delvedor reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Copy link

Member

### @StarpTech **[StarpTech](/StarpTech)** [Jan 7, 2018](#discussion_r160057619) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Does it make sense to use `flatstr` after that step?

Sorry, something went wrong.

All reactions

Copy link

Member

### @mcollina **[mcollina](/mcollina)** [Jan 7, 2018](#discussion_r160057915)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

no. flatstr is only useful when sending data out.

Sorry, something went wrong.

 👍
1
 StarpTech reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[lib/handleRequest.js](/fastify/fastify/pull/627/files#diff-15a9e086692377c86b02752c54c928f4ca6f697758fc5dacc09bbde1d2dff96b)
Outdated

|  |  | function removeHandlers () { |
| --- | --- | --- |
|  |  | req.removeListener('data', onData) |
|  |  | req.removeListener('end', onEnd) |
|  |  | req.removeListener('error', onEnd) |
|  |  | } |

Copy link

Member

### @mcollina **[mcollina](/mcollina)** [Jan 7, 2018](#discussion_r160044902)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

can you avoid allocating this closure at all? (copy-paste is ok).

Sorry, something went wrong.

 👍
1
 nwoltman reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[lib/handleRequest.js](/fastify/fastify/pull/627/files#diff-15a9e086692377c86b02752c54c928f4ca6f697758fc5dacc09bbde1d2dff96b)
Outdated

|  |  | function onEnd () { |
| --- | --- | --- |
|  |  |  |
|  |  | function onEnd (err) { |
|  |  | removeHandlers() |

Copy link

Member

### @mcollina **[mcollina](/mcollina)** [Jan 7, 2018](#discussion_r160044922)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

it might not be needed to remove the handlers there. Removing those is costly, so we can eve skip it altogether.

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @nwoltman **[nwoltman](/nwoltman)** [Jan 7, 2018](#discussion_r160054511)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

If `error` is emitted, is it impossible for other events to be emitted after? Even if a user does `req.emit('error')`?

Sorry, something went wrong.

All reactions

Copy link

Member

### @mcollina **[mcollina](/mcollina)** [Jan 7, 2018](#discussion_r160057263)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I think we can leave them there, we had no problems so far.

It won’t protect from direct emit, but it’s protected from the core point of view!

Sorry, something went wrong.

All reactions

[lib/handleRequest.js](/fastify/fastify/pull/627/files#diff-15a9e086692377c86b02752c54c928f4ca6f697758fc5dacc09bbde1d2dff96b)
Outdated

|  |  | var req = request.req |
| --- | --- | --- |
|  |  | req.on('error', onError) |
|  |  | function jsonBody (request, reply, limit) { |
|  |  | const contentLength = Number.parseInt(request.headers['content-length'], 10) |

Copy link

Member

### @mcollina **[mcollina](/mcollina)** [Jan 7, 2018](#discussion_r160044937)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

We should not assume Content-Length is present.

Sorry, something went wrong.

 👍
1
 delvedor reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Copy link

Member

### @jsumners **[jsumners](/jsumners)** [Jan 7, 2018](#discussion_r160050517)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

The short circuit is good. Just wrap it with a check for the header first.

Sorry, something went wrong.

All reactions

[![delvedor](https://avatars.githubusercontent.com/u/4865608?s=60&v=4)](/delvedor)

**[delvedor](/delvedor)**
reviewed
[Jan 7, 2018](#pullrequestreview-87095594)

 [View reviewed changes](/fastify/fastify/pull/627/files)

[fastify.js](/fastify/fastify/pull/627/files#diff-a36b53a0e851347821d855f09722921b64d2792750d1deaab126fe54964498a9)
Outdated

|  |  | var jsonBodyLimit = \_fastify.\_jsonBodyLimit |
| --- | --- | --- |
|  |  | if (opts.jsonBodyLimit !== undefined) { |
|  |  | if (!Number.isInteger(opts.jsonBodyLimit)) { |
|  |  | throw new TypeError(`'jsonBodyLimit' option must be an integer. Got: '${opts.jsonBodyLimit}'`) |

Copy link

Member

### @delvedor **[delvedor](/delvedor)** [Jan 7, 2018](#discussion_r160045686)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I would add a `typeof` after "Got".

`Got: '${typeof opts.jsonBodyLimit}'`

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @nwoltman **[nwoltman](/nwoltman)** [Jan 7, 2018](#discussion_r160057082)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

With [this suggestion](https://github.com/fastify/fastify/pull/627#discussion_r160046782) from [@StarpTech](https://github.com/StarpTech), users will need to see the actual value to understand why it wasn't valid.

Sorry, something went wrong.

 👍
1
 delvedor reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[![@delvedor](https://avatars.githubusercontent.com/u/4865608?s=40&u=1baacaccb1096537c1c69be56439e85faaf48f8b&v=4)](/delvedor)
[delvedor](/delvedor)
added
the
[feature](/fastify/fastify/labels/feature)
label
[Jan 7, 2018](#event-1412693667)

[![allevo](https://avatars.githubusercontent.com/u/1054125?s=60&v=4)](/allevo)

**[allevo](/allevo)**
reviewed
[Jan 7, 2018](#pullrequestreview-87095378)

 [View reviewed changes](/fastify/fastify/pull/627/files)

[fastify.js](/fastify/fastify/pull/627/files#diff-a36b53a0e851347821d855f09722921b64d2792750d1deaab126fe54964498a9)
Outdated

|  |  | } |
| --- | --- | --- |
|  |  | fastify.\_jsonBodyLimit = options.jsonBodyLimit |
|  |  | } else { |
|  |  | fastify.\_jsonBodyLimit = 1000 \* 1000 // 1 MB |

Copy link

Member

### @allevo **[allevo](/allevo)** [Jan 7, 2018](#discussion_r160045437)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Could you use an external constant for this?

Sorry, something went wrong.

All reactions

Copy link

Member

### @mcollina **[mcollina](/mcollina)** [Jan 7, 2018](#discussion_r160057227)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

It’s 1024 \* 1024.

Sorry, something went wrong.

 👍
2
 allevo and delvedor reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Copy link

Contributor

Author

### @nwoltman **[nwoltman](/nwoltman)** [Jan 7, 2018](#discussion_r160057352)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

So we want [`MiB`](https://en.wikipedia.org/wiki/Mebibyte) then? I would actually agree with this since base-2 values are more common in networking applications.

Sorry, something went wrong.

All reactions

Copy link

Member

### @mcollina **[mcollina](/mcollina)** [Jan 7, 2018](#discussion_r160057900)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I think we should use base2 values.

Sorry, something went wrong.

 👍
2
 delvedor and nwoltman reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

[fastify.js](/fastify/fastify/pull/627/files#diff-a36b53a0e851347821d855f09722921b64d2792750d1deaab126fe54964498a9)
Outdated

|  |  | throw new TypeError(`'jsonBodyLimit' option must be an integer. Got: '${opts.jsonBodyLimit}'`) |
| --- | --- | --- |
|  |  | } |
|  |  | jsonBodyLimit = opts.jsonBodyLimit |
|  |  | } |

Copy link

Member

### @allevo **[allevo](/allevo)** [Jan 7, 2018](#discussion_r160045482)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

This check is made twice. Can you refactor this point ?

Sorry, something went wrong.

 👍
1
 nwoltman reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[lib/handleRequest.js](/fastify/fastify/pull/627/files#diff-15a9e086692377c86b02752c54c928f4ca6f697758fc5dacc09bbde1d2dff96b)
Outdated

|  |  | receivedLength += chunk.length |
| --- | --- | --- |
|  |  |  |
|  |  | if (receivedLength > limit) { |
|  |  | removeHandlers() |

Copy link

Member

### @allevo **[allevo](/allevo)** [Jan 7, 2018](#discussion_r160045598)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

`onData` handler is binded to the event emitter. So `this` here is the `req`. Use it in order to avoid the closure in `removeHandlers` function.

Sorry, something went wrong.

All reactions

[lib/handleRequest.js](/fastify/fastify/pull/627/files#diff-15a9e086692377c86b02752c54c928f4ca6f697758fc5dacc09bbde1d2dff96b)
Outdated

|  |  | @@ -23,7 +23,7 @@ function handleRequest (req, res, params, context) { | |
| --- | --- | --- | --- |
|  |  | if (method === 'POST' || method === 'PUT' || method === 'PATCH') { |
|  |  | // application/json content type |
|  |  | if (contentType && contentType.indexOf('application/json') > -1) { |
|  |  | return jsonBody(request, reply) |
|  |  | return jsonBody(request, reply, context.\_jsonBodyLimit) |

Copy link

Member

### @allevo **[allevo](/allevo)** [Jan 7, 2018](#discussion_r160045720)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

An object can be better here: it's future proof

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @nwoltman **[nwoltman](/nwoltman)** [Jan 7, 2018](#discussion_r160057491)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

[@allevo](https://github.com/allevo) Yes I agree it would be future proof. It would be nice to not allocate an object though. It would also be nice to wait until Node 4 support is dropped so we can use object destructuring in `jsonBody`.

I can add it if you insist though.

Sorry, something went wrong.

All reactions

Copy link

Member

### @delvedor **[delvedor](/delvedor)** [Jan 7, 2018](#discussion_r160057990)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Since this is an internal function we can leave it as is.

It will not be nice, but is fast :)

Sorry, something went wrong.

All reactions

Copy link

Member

### @allevo **[allevo](/allevo)** [Jan 7, 2018](#discussion_r160060206)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Truly the parser options can be stored inside the route definition aka `Context`. Without create any object at runtime

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @nwoltman **[nwoltman](/nwoltman)** [Jan 7, 2018](#discussion_r160061068)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

That sounds good to me 👍

How does this look?

```
diff --git a/fastify.js b/fastify.js
index 6d35bdc..d6155ee 100644
--- a/fastify.js
+++ b/fastify.js
@@ -494,7 +494,9 @@ function build (options) {
     this.config = config
     this.errorHandler = errorHandler
     this._middie = middie
-    this._jsonBodyLimit = jsonBodyLimit
+    this._jsonParserOptions = {
+      limit: jsonBodyLimit
+    }
     this._fastify = fastify
   }

diff --git a/lib/handleRequest.js b/lib/handleRequest.js
index d07bd29..79a8bb2 100644
--- a/lib/handleRequest.js
+++ b/lib/handleRequest.js
@@ -23,7 +23,7 @@ function handleRequest (req, res, params, context) {
   if (method === 'POST' || method === 'PUT' || method === 'PATCH') {
     // application/json content type
     if (contentType && contentType.indexOf('application/json') > -1) {
-      return jsonBody(request, reply, context._jsonBodyLimit)
+      return jsonBody(request, reply, context._jsonParserOptions)
     }

     // custom parser for a given content type
@@ -42,7 +42,7 @@ function handleRequest (req, res, params, context) {

     // application/json content type
     if (contentType.indexOf('application/json') > -1) {
-      return jsonBody(request, reply, context._jsonBodyLimit)
+      return jsonBody(request, reply, context._jsonParserOptions)
     }
     // custom parser for a given content type
     if (context.contentTypeParser.fastHasHeader(contentType)) {
@@ -57,7 +57,8 @@ function handleRequest (req, res, params, context) {
   return
 }

-function jsonBody (request, reply, limit) {
+function jsonBody (request, reply, options) {
+  const limit = options.limit
   const contentLength = request.headers['content-length'] === undefined
```

[@mcollina](https://github.com/mcollina) [@delvedor](https://github.com/delvedor) ?

Sorry, something went wrong.

All reactions

Copy link

Member

### @mcollina **[mcollina](/mcollina)** [Jan 7, 2018](#discussion_r160061810)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Yes, it’s ok.

Sorry, something went wrong.

All reactions

[lib/handleRequest.js](/fastify/fastify/pull/627/files#diff-15a9e086692377c86b02752c54c928f4ca6f697758fc5dacc09bbde1d2dff96b)

|  |  | } |
| --- | --- | --- |
|  |  |  |
|  |  | if (!Number.isNaN(contentLength) && receivedLength !== contentLength) { |
|  |  | reply.code(400).send(new Error('Request body size did not match Content-Length')) |

Copy link

Member

### @allevo **[allevo](/allevo)** [Jan 7, 2018](#discussion_r160045773)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

is 400 the correct HTTP status code?

Sorry, something went wrong.

All reactions

Copy link

Member

### @StarpTech **[StarpTech](/StarpTech)** [Jan 7, 2018](#discussion_r160046462) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

yes, according to this <https://github.com/stream-utils/raw-body/blob/master/index.js#L263> it's correct because we evaluate just the request (headers) not the content (payload).

Sorry, something went wrong.

 👍
1
 allevo reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[![StarpTech](https://avatars.githubusercontent.com/u/1764424?s=60&v=4)](/StarpTech)

**[StarpTech](/StarpTech)**
reviewed
[Jan 7, 2018](#pullrequestreview-87096653)

 [View reviewed changes](/fastify/fastify/pull/627/files)

[fastify.js](/fastify/fastify/pull/627/files#diff-a36b53a0e851347821d855f09722921b64d2792750d1deaab126fe54964498a9)
Outdated

|  |  | @@ -394,6 +405,14 @@ function build (options) { | |
| --- | --- | --- | --- |
|  |  | throw new Error(`Missing handler function for ${opts.method}:${opts.url} route.`) |
|  |  | } |
|  |  |  |
|  |  | var jsonBodyLimit = \_fastify.\_jsonBodyLimit |
|  |  | if (opts.jsonBodyLimit !== undefined) { |
|  |  | if (!Number.isInteger(opts.jsonBodyLimit)) { |

Copy link

Member

### @StarpTech **[StarpTech](/StarpTech)** [Jan 7, 2018](#discussion_r160046782) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

You should only allow unsigned integers.

```
if (!Number.isInteger(opts.jsonBodyLimit)) {
 if(opts.jsonBodyLimit <= 0) {
    throw new Error(`jsonBodyLimit should be positive integer ....`)
  }
}
```

Sorry, something went wrong.

All reactions

[![@nwoltman](https://avatars.githubusercontent.com/u/5128013?s=40&v=4)](/nwoltman)

`[Add option to limit the size of request bodies for the default body p…](/fastify/fastify/pull/627/commits/fabd2a011f2ffbb877394abe699f549513ffbd76 "Add option to limit the size of request bodies for the default body parser")`
 …

`[fabd2a0](/fastify/fastify/pull/627/commits/fabd2a011f2ffbb877394abe699f549513ffbd76)`

```
…arser
```

 [![@nwoltman](https://avatars.githubusercontent.com/u/5128013?s=40&u=70f7f1e517d2ed18cdf75057014fa6529d836f13&v=4)](/nwoltman)
[nwoltman](/nwoltman)
[force-pushed](/fastify/fastify/compare/31700bbf5fd7195757a043eac83a8854af4a9de2..912dcaa9016ee635e42bfcea5edda25dc1d85d1c)
the
json-limit

branch
from
[`31700bb`](/fastify/fastify/commit/31700bbf5fd7195757a043eac83a8854af4a9de2) to
[`912dcaa`](/fastify/fastify/commit/912dcaa9016ee635e42bfcea5edda25dc1d85d1c)  [Compare](/fastify/fastify/compare/31700bbf5fd7195757a043eac83a8854af4a9de2..912dcaa9016ee635e42bfcea5edda25dc1d85d1c)
[January 7, 2018 20:10](#event-1412854056)

[![@nwoltman](https://avatars.githubusercontent.com/u/5128013?s=40&v=4)](/nwoltman)

`[Addressed comments](/fastify/fastify/pull/627/commits/c42fd308d82aa57eb15a41d7dd60a2351302c64a "Addressed comments")`

`[c42fd30](/fastify/fastify/pull/627/commits/c42fd308d82aa57eb15a41d7dd60a2351302c64a)`

 [![@nwoltman](https://avatars.githubusercontent.com/u/5128013?s=40&u=70f7f1e517d2ed18cdf75057014fa6529d836f13&v=4)](/nwoltman)
[nwoltman](/nwoltman)
[force-pushed](/fastify/fastify/compare/912dcaa9016ee635e42bfcea5edda25dc1d85d1c..c42fd308d82aa57eb15a41d7dd60a2351302c64a)
the
json-limit

branch
from
[`912dcaa`](/fastify/fastify/commit/912dcaa9016ee635e42bfcea5edda25dc1d85d1c) to
[`c42fd30`](/fastify/fastify/commit/c42fd308d82aa57eb15a41d7dd60a2351302c64a)  [Compare](/fastify/fastify/compare/912dcaa9016ee635e42bfcea5edda25dc1d85d1c..c42fd308d82aa57eb15a41d7dd60a2351302c64a)
[January 7, 2018 20:37](#event-1412862594)

[![@nwoltman](https://avatars.githubusercontent.com/u/5128013?s=80&u=70f7f1e517d2ed18cdf75057014fa6529d836f13&v=4)](/nwoltman)

Copy link

Contributor

Author

### **[nwoltman](/nwoltman)** commented [Jan 7, 2018](#issuecomment-355850997)

| Updated 🎉 |
| --- |

All reactions

Sorry, something went wrong.

[![nwoltman](https://avatars.githubusercontent.com/u/5128013?s=60&v=4)](/nwoltman)

**[nwoltman](/nwoltman)**
commented
[Jan 7, 2018](#pullrequestreview-87109563)

 [View reviewed changes](/fastify/fastify/pull/627/files/c42fd308d82aa57eb15a41d7dd60a2351302c64a)

[test/helper.js](/fastify/fastify/pull/627/files/c42fd308d82aa57eb15a41d7dd60a2351302c64a#diff-f25fd70bcc2003be84cf284d003e927ea4035f5e9f9496721461ddfa234c541c)

|  |  | }) |
| --- | --- | --- |
|  |  |  |
|  |  | // Node errors for OPTIONS requests with a stream body and no Content-Length header |
|  |  | if (upMethod !== 'OPTIONS') { |

Copy link

Contributor

Author

### @nwoltman **[nwoltman](/nwoltman)** [Jan 7, 2018](#discussion_r160059730)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

It seems like there's a bug in Node. On Node 4 this test fails with an error and on the other versions it tries to attach too many `error` event handlers to the `req`, which produces a Node warning and errors with a `400` status.

Sorry, something went wrong.

All reactions

Copy link

Member

### @allevo **[allevo](/allevo)** [Jan 7, 2018](#discussion_r160063664)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

How many `error` handlers are attached to `req`?

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @nwoltman **[nwoltman](/nwoltman)** [Jan 7, 2018](#discussion_r160064280)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Here's what I'm getting from Node:

```
(node:10380) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 error listeners added. Use emitter.setMaxListeners() to increase limit
    at _addListener (events.js:280:19)
    at Socket.addListener (events.js:297:10)
    at Socket.Readable.on (_stream_readable.js:772:35)
    at Socket.socketOnWrap [as on] (_http_server.js:651:37)
    at Socket.socketOnError (_http_server.js:456:8)
    at onParserExecuteCommon (_http_server.js:467:19)
    at onParserExecute (_http_server.js:450:3)

```

I guess I meant the handlers are being attached to the socket, not `req` specifically.

Sorry, something went wrong.

All reactions

[![mcollina](https://avatars.githubusercontent.com/u/52195?s=60&v=4)](/mcollina)

**[mcollina](/mcollina)**
approved these changes
[Jan 7, 2018](#pullrequestreview-87111640)

 [View reviewed changes](/fastify/fastify/pull/627/files/c42fd308d82aa57eb15a41d7dd60a2351302c64a)

Copy link

Member

### @mcollina **[mcollina](/mcollina)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM

Sorry, something went wrong.

All reactions

[![@nwoltman](https://avatars.githubusercontent.com/u/5128013?s=40&v=4)](/nwoltman)

`[Set _jsonParserOptions object on Context](/fastify/fastify/pull/627/commits/79edc6b8b726bcc2d394fc83479f14e9c5c10b34 "Set _jsonParserOptions object on Context")`

`[79edc6b](/fastify/fastify/pull/627/commits/79edc6b8b726bcc2d394fc83479f14e9c5c10b34)`

[![@nwoltman](https://avatars.githubusercontent.com/u/5128013?s=80&u=70f7f1e517d2ed18cdf75057014fa6529d836f13&v=4)](/nwoltman)

Copy link

Contributor

Author

### **[nwoltman](/nwoltman)** commented [Jan 7, 2018](#issuecomment-355857930)

| Updated to use a `_jsonParserOptions` object on the `Context`. [@allevo](https://github.com/allevo) |
| --- |

 👍
1
 allevo reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![allevo](https://avatars.githubusercontent.com/u/1054125?s=60&v=4)](/allevo)

**[allevo](/allevo)**
reviewed
[Jan 7, 2018](#pullrequestreview-87113523)

 [View reviewed changes](/fastify/fastify/pull/627/files/79edc6b8b726bcc2d394fc83479f14e9c5c10b34)

[lib/handleRequest.js](/fastify/fastify/pull/627/files/79edc6b8b726bcc2d394fc83479f14e9c5c10b34#diff-15a9e086692377c86b02752c54c928f4ca6f697758fc5dacc09bbde1d2dff96b)

|  |  | return |
| --- | --- | --- |
|  |  | } |
|  |  |  |
|  |  | body += chunk.toString() |

Copy link

Member

### @allevo **[allevo](/allevo)** [Jan 7, 2018](#discussion_r160063641)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

`chunk + ''` performs better

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @nwoltman **[nwoltman](/nwoltman)** [Jan 7, 2018](#discussion_r160064171)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

In my benchmarks that performs exactly the same as `body += chunk`

(I tried on both Node 8.9.4 and 9.3.0)

Sorry, something went wrong.

All reactions

[![allevo](https://avatars.githubusercontent.com/u/1054125?s=60&v=4)](/allevo)

**[allevo](/allevo)**
approved these changes
[Jan 7, 2018](#pullrequestreview-87114186)

 [View reviewed changes](/fastify/fastify/pull/627/files/79edc6b8b726bcc2d394fc83479f14e9c5c10b34)

Copy link

Member

### @allevo **[allevo](/allevo)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM

Sorry, something went wrong.

All reactions

[![delvedor](https://avatars.githubusercontent.com/u/4865608?s=60&v=4)](/delvedor)

**[delvedor](/delvedor)**
approved these changes
[Jan 8, 2018](#pullrequestreview-87152356)

 [View reviewed changes](/fastify/fastify/pull/627/files/79edc6b8b726bcc2d394fc83479f14e9c5c10b34)

Copy link

Member

### @delvedor **[delvedor](/delvedor)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM

Sorry, something went wrong.

All reactions

[![@delvedor](https://avatars.githubusercontent.com/u/4865608?s=40&u=1baacaccb1096537c1c69be56439e85faaf48f8b&v=4)](/delvedor)
[delvedor](/delvedor)
merged commit [`7f2b88f`](/fastify/fastify/commit/7f2b88f7f523698b8bf258f8235c400af4532097)
into
fastify:master

[Jan 8, 2018](https://github.com/fastify/fastify/pull/627#event-1413258451)

 [![@nwoltman](https://avatars.githubusercontent.com/u/5128013?s=40&u=70f7f1e517d2ed18cdf75057014fa6529d836f13&v=4)](/nwoltman)
[nwoltman](/nwoltman)
deleted the
json-limit

branch
[January 8, 2018 15:53](#event-1413881204)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=80&v=4)](/apps/github-actions)

Copy link

### **[github-actions](/apps/github-actions) bot** commented [Feb 21, 2022](#issuecomment-1046356353)

| This pull request has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs. |
| --- |

All reactions

Sorry, something went wrong.

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
locked as **resolved** and limited conversation to collaborators
[Feb 21, 2022](#event-6108021409)

[![@Eomm](https://avatars.githubusercontent.com/u/11404065?s=40&u=b491aa951de42e0c1fcd8f0a75dc731073f1bc5d&v=4)](/Eomm)
[Eomm](/Eomm)
added
the
[semver-minor](/fastify/fastify/labels/semver-minor)
Issue or PR that should land as semver minor
label
[Apr 1, 2023](#event-8903540812)

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffastify%2Ffastify%2Fpull%2F627).

Reviewers

[![@StarpTech](https://avatars.githubusercontent.com/u/1764424?s=40&v=4)](/StarpTech) [StarpTech](/StarpTech)

StarpTech left review comments

[![@delvedor](https://avatars.githubusercontent.com/u/4865608?s=40&v=4)](/delvedor) [delvedor](/delvedor)

delvedor approved these changes

[![@allevo](https://avatars.githubusercontent.com/u/1054125?s=40&v=4)](/allevo) [allevo](/allevo)

allevo approved these changes

[![@mcollina](https://avatars.githubusercontent.com/u/52195?s=40&v=4)](/mcollina) [mcollina](/mcollina)

mcollina approved these changes

[![@jsumners](https://avatars.githubusercontent.com/u/321201?s=40&v=4)](/jsumners) [jsumners](/jsumners)

 Awaiting requested review from jsumners

Assignees

No one assigned

Labels

[semver-minor](/fastify/fastify/labels/semver-minor)
Issue or PR that should land as semver minor

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

7 participants

[![@nwoltman](https://avatars.githubusercontent.com/u/5128013?s=52&v=4)](/nwoltman) [![@mcollina](https://avatars.githubusercontent.com/u/52195?s=52&v=4)](/mcollina) [![@jsumners](https://avatars.githubusercontent.com/u/321201?s=52&v=4)](/jsumners) [![@allevo](https://avatars.githubusercontent.com/u/1054125?s=52&v=4)](/allevo) [![@StarpTech](https://avatars.githubusercontent.com/u/1764424?s=52&v=4)](/StarpTech) [![@delvedor](https://avatars.githubusercontent.com/u/4865608?s=52&v=4)](/delvedor) [![@Eomm](https://avatars.githubusercontent.com/u/11404065?s=52&v=4)](/Eomm)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


