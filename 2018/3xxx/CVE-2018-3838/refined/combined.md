=== Content from www.debian.org_412891d8_20250125_230044.html ===


---

[[Date Prev](msg00110.html)][[Date Next](msg00112.html)]
[[Thread Prev](msg00110.html)][[Thread Next](msg00112.html)]
[[Date Index](maillist.html#00111)]
[[Thread Index](threads.html#00111)]

# [SECURITY] [DSA 4184-1] sdl-image1.2 security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4184-1] sdl-image1.2 security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Sat, 28 Apr 2018 19:28:02 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/E1fCVVq-0007tZ-2S%40seger.debian.org)Â [E1fCVVq-0007tZ-2S@seger.debian.org](msg00111.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4184-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
April 28, 2018                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : sdl-image1.2
CVE ID         : CVE-2017-2887 CVE-2017-12122 CVE-2017-14440 CVE-2017-14441
                 CVE-2017-14442 CVE-2017-14448 CVE-2017-14450 CVE-2018-3837
                 CVE-2018-3838 CVE-2018-3839
Debian Bug     : 878267

Multiple vulnerabilities have been discovered in the image loading
library for Simple DirectMedia Layer 1.2, which could result in denial
of service or the execution of arbitrary code if malformed image files
are opened.

For the oldstable distribution (jessie), these problems have been fixed
in version 1.2.12-5+deb8u1.

For the stable distribution (stretch), these problems have been fixed in
version 1.2.12-5+deb9u1.

We recommend that you upgrade your sdl-image1.2 packages.

For the detailed security status of sdl-image1.2 please refer to its
security tracker page at:
<https://security-tracker.debian.org/tracker/sdl-image1.2>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEERkRAmAjBceBVMd3uBUy48xNDz0QFAlrkyb1fFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldDQ2
NDQ0MDk4MDhDMTcxRTA1NTMxRERFRTA1NENCOEYzMTM0M0NGNDQACgkQBUy48xND
z0TZog//ayJ8Vts0SVEvs7XESknn5WiaV5vVQrXolV/TtAgE/P44dIsSWc69KF9H
Ekow/khSG+IAWmDsvTPNQhuzaukmdANGwSmr5zBU0mrnAI8k+yGzsGEGcN6WntUx
O2hVSxN1VwpuPwFKll0Xcl4gESFwGE9b/67frQVj7ESoAzJ+Ox7Z6Y7I24DOvSbr
86Sxw6cD3X6gm33qKsvwq2cQX/ra1VLQGNiMvxgt0m5c0Nfru4kjwLIOu2dJtaJG
WBqag5uwJxYxQJg9tll3Fb5oSqcTRAeLjkK3ucNbiMqmOotGekMY139wKkUJikrD
ZQNAdm1pmRwBJUy37eKIU9ZdF0pYAiOVDozrlGHVdxuijwLpMOAgE7AAmnFw86pS
TOIBekAZghasNIt+fUhgV5clg2FE+g4sz34QYu8d4tavnQstcTJB2mn/LqVKvB7T
asX+WbxjtNTZ7tqhGYYNlfGFC6LfVzULowK0ESDttuuKajUqLWqvWh/16E5LpP8L
GIQYqq21jDTtKNiCjiqpgYOD4oQKxpvxG9htbIzEznjZwvpnuUlcf+MQiXirYTzM
fXBRGAmo1Bsh9fQDZJqiuG7SZ7cMpvgXdiV1cAHqgFrskqJJd85FsCgyVqbDa1fv
amJNEe+EkEsKitITbzKsty2CxeseEauTJtui0TGqtOL9Uhj8xFo=
=oVng
-----END PGP SIGNATURE-----

```

---



=== Content from security.gentoo.org_9a542572_20250125_230042.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# SDL2\_Image: Multiple vulnerabilities â€” GLSA **201903-17**

Multiple vulnerabilities have been found in the image loading
library
for Simple DirectMedia Layer, the worst of which could result in the remote
execution of arbitrary code.

### Affected packages

| Package | **media-libs/sdl2-image** on all architectures |
| --- | --- |
| Affected versions | < **2.0.4** |
| Unaffected versions | >= **2.0.4** |

### Background

SDL\_image is an image file library that loads images as SDL surfaces,
and supports various formats like BMP, GIF, JPEG, LBM, PCX, PNG, PNM,
TGA, TIFF, XCF, XPM, and XV.

### Description

Multiple vulnerabilities have been discovered in SDL2\_Image. Please
review the CVE identifiers referenced below for details.

### Impact

A remote attacker, by enticing a user to process a specially crafted
image file, could execute arbitrary code, cause a Denial of Service
condition, or obtain sensitive information.

### Workaround

There is no known workaround at this time.

### Resolution

All SDL2\_Image users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=media-libs/sdl2-image-2.0.4"

```
### References

* [CVE-2017-12122](https://nvd.nist.gov/vuln/detail/CVE-2017-12122)
* [CVE-2017-14440](https://nvd.nist.gov/vuln/detail/CVE-2017-14440)
* [CVE-2017-14441](https://nvd.nist.gov/vuln/detail/CVE-2017-14441)
* [CVE-2017-14442](https://nvd.nist.gov/vuln/detail/CVE-2017-14442)
* [CVE-2017-14448](https://nvd.nist.gov/vuln/detail/CVE-2017-14448)
* [CVE-2017-14449](https://nvd.nist.gov/vuln/detail/CVE-2017-14449)
* [CVE-2017-14450](https://nvd.nist.gov/vuln/detail/CVE-2017-14450)
* [CVE-2018-3837](https://nvd.nist.gov/vuln/detail/CVE-2018-3837)
* [CVE-2018-3838](https://nvd.nist.gov/vuln/detail/CVE-2018-3838)
* [CVE-2018-3839](https://nvd.nist.gov/vuln/detail/CVE-2018-3839)
* [CVE-2018-3977](https://nvd.nist.gov/vuln/detail/CVE-2018-3977)

**Release date**

March 28, 2019

**Latest revision**

March 28, 2019: 1

**Severity**

normal

**Exploitable**

local, remote

**Bugzilla entries**

* [655226](https://bugs.gentoo.org/show_bug.cgi?id=655226)
* [674132](https://bugs.gentoo.org/show_bug.cgi?id=674132)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**



=== Content from www.debian.org_e2909116_20250125_230043.html ===


---

[[Date Prev](msg00103.html)][[Date Next](msg00105.html)]
[[Thread Prev](msg00103.html)][[Thread Next](msg00105.html)]
[[Date Index](maillist.html#00104)]
[[Thread Index](threads.html#00104)]

# [SECURITY] [DSA 4177-1] libsdl2-image security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4177-1] libsdl2-image security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Fri, 20 Apr 2018 22:16:50 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20180420201650.GA7380%40pisco.westfalen.local)Â [20180420201650.GA7380@pisco.westfalen.local](msg00104.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4177-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
April 20, 2018                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : libsdl2-image
CVE ID         : CVE-2017-2887  CVE-2017-12122 CVE-2017-14440 CVE-2017-14441
                 CVE-2017-14442 CVE-2017-14448 CVE-2017-14449 CVE-2017-14450
                 CVE-2018-3837  CVE-2018-3838  CVE-2018-3839

Multiple vulnerabilities have been discovered in the image loading
library for Simple DirectMedia Layer 2, which could result in denial of
service or the execution of arbitrary code if malformed image files are
opened.

For the oldstable distribution (jessie), these problems have been fixed
in version 2.0.0+dfsg-3+deb8u1.

For the stable distribution (stretch), these problems have been fixed in
version 2.0.1+dfsg-2+deb9u1.

We recommend that you upgrade your libsdl2-image packages.

For the detailed security status of libsdl2-image please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/libsdl2-image>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAlraSnYACgkQEMKTtsN8
Tjbd7RAAi1WGlcur3NflOdj1yy+VTnrurmB33trBRd6vWgRZndysRQz8ifqEqfbq
8h2FybTcVZ7cHjIoHgKDLYJt21Er+gaDUYF6EQsjvs7BYnseLcRHTe5NmBSaDLkp
ahjyNat3KBU7riNKLv7p3aHlae/XZECB9/GCcURQ4cJ7RFsVGIRvHQixaUNsD3f2
Y/4Kndn4MEN/27v9eKstWiJdskwHn6I1rEGFEaeU7gdLLTr02yLycoApinjavJzn
ryzetzu/K78OA3QC+IUiOHSILxvn/p1aH/EYbkbbHN5oUkQUTYjtYDKWgzP+BN/C
bhxe5w5O8l/ysEL9UW7Yiq2fwkTGKNMT7E/Ru+s0oCykiVemaYvGsFj0WP27vGV7
08oQ6z1Ry+DZUd4AnywGvYF0xdcRB5n/O1fF+HQSz+RqaoArkwzD868khTDwzZuY
DiDsXknPV8rlN8XC3ubUI42xqEK31j2dgP3BTyBXdqaa7+36FsHTraLRbd9KVtWg
RRoyqPAlt0pJgC5G4gMmlaibEgE0euT1bLnxf/0dsqrzdLTgaUxHLWnEJ3Ntm1H5
9adyp8ObVmPzsGI5BzSWTsgo8YjaC+f36zPJH6Sq5/pqPs7kZ7PXq8Al+FKLUiuL
rPTeHpvBAgZe0NTdeqIBwJ//0s7mIDRIKl+WwUFbEhFIUo6xmnw=
=7zfP
-----END PGP SIGNATURE-----

```

---



=== Content from www.talosintelligence.com_60166908_20250125_230044.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

Ã—

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2018-0520

## Simple DirectMedia Layer SDL2\_Image load\_xcf\_tile\_rle Information Disclosure Vulnerability

##### April 10, 2018

##### CVE Number

CVE-2018-3838

### Summary

An exploitable information vulnerability exists in the XCF image rendering functionality of SDL2\_image-2.0.2. A specially crafted XCF image can cause an out-of-bounds read on the heap, resulting in information disclosure. An attacker can display a specially crafted image to trigger this vulnerability.

### Tested Versions

Simple DirectMedia Layer SDL2\_image 2.0.2

### Product URLs

<https://www.libsdl.org/projects/SDL_image/>

### CVSSv3 Score

5.3 - CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N

### CWE

CWE-126: Buffer Over-read

### Details

LibSDL is a multi-platform library for easy access to low level hardware and graphics, providing support for a large amount of games, software, and emulators. The last known count of software using LibSDL (from 2012) listed the number at upwards of 120. The LibSDL2\_Image library is an optional component that deals specifically with parsing and displaying a variety of image file formats, creating a single and uniform API for image processing, regardless of the type.

When parsing and storing an XCF file (the native file type for Gimp), the LibSDL2 library implements a custom RLE inflater for the compressed XCF data. The code that handles this is listed below:

```
//IMG_xcf.c
static unsigned char * load_xcf_tile_rle (SDL_RWops * src, Uint32 len, int bpp, int x, int y)
	unsigned char * load, * t, * data, * d;
	Uint32 reallen;
      		int i, size, count, j, length;
  		unsigned char val;

```
t = load = (unsigned char \*) SDL\_malloc (len); //[1]
reallen = SDL\_RWread (src, t, 1, len); //[2]
```
	data = (unsigned char *) SDL_malloc (x*y*bpp);  //[3]
	[...]

```

From the above, it should be noted that the `bpp`,`x`, and `y` parameters are all under the fileâ€™s control, along with the `len` field, which is derived from the calling function as such:

```
do_layer_surface(SDL_Surface * surface, SDL_RWops * src, xcf_header * head, xcf_layer * layer, load_tile_type load_tile) {

    	SDL_RWseek(src, layer->hierarchy_file_offset, RW_SEEK_SET);
	    	hierarchy = read_xcf_hierarchy(src); // [1]
		level = NULL;
		for (i = 0; hierarchy->level_file_offsets[i]; i++) {
   			SDL_RWseek(src, hierarchy->level_file_offsets[i], RW_SEEK_SET);
    			level = read_xcf_level(src); //[2]

    			ty = tx = 0;
    			for (j = 0; level->tile_file_offsets[j]; j++) {
       				SDL_RWseek(src, level->tile_file_offsets[j], RW_SEEK_SET);
        			[...]

        			if (level->tile_file_offsets[j + 1]) {
           			tile = load_tile(src, level->tile_file_offsets[j + 1] - level->tile_file_offsets[j], hierarchy->bpp, ox, oy);  // [3]
			} else {
           				 tile = load_tile(src, ox * oy * 6, hierarchy->bpp, ox, oy);
        			}
[...]

```

To sum up the above, each XCF surface can have multiple layers, and these layers have a hierarchy, which is read in at [1] and dictates the order in which the image layers are rendered. Then, each layer has a set of tiles (which are just blocks of image data), which must be read in first before rendering. These tiles can be different sizes, so an array of file offsets are read in at [2], such that the parsing can be done correctly. After this, the library loops over the tile offsets, and seeks for the tile data in the file, reading the tile data at [3]. â€˜load\_tileâ€™ is a function pointer to the load\_xcf\_tile\_rle function that we were at before. Of most note for this bug, is the fact that the â€˜lenâ€™ parameter from the load\_xcf\_tile\_rle function is calculated from `level->tile_file_offsets[j + 1] â€“ level->tile_file_offsets[j]`, as long as level->tile\_file\_offsets[j+1] is != 0.

Thus, if we make our XCF file have two consecutive tile\_file\_offsets that are equivalent, our call to load\_xcf\_tile\_rle becomes load\_xcf\_tile\_rle(src,0,hierarchy->bpp,ox,oy). This causes issues further down inside load\_xcf\_tile\_rle as we end up doing a call to malloc(0) for our source buffer:

```
static unsigned char * load_xcf_tile_rle (SDL_RWops * src, Uint32 len, int bpp, int x, int y) 	{
  	unsigned char * load, * t, * data, * d;
  	Uint32 reallen;
 	int i, size, count, j, length;
  	unsigned char val;

```
t = load = (unsigned char \*) SDL\_malloc (len); // [1]

Since SDL\_malloc is a simple wrapper around normal malloc, this depends on the specific implementation of malloc for the system, but at least on Debian Linux, m0560874168f86c7aeeee2edcf2cea202alloc(0) returns a valid buffer of the minimum chunk size possible for the given architecture, which is usually 16 bytes on a 64 byte system. But regardless of the exact byte count, the amount of bytes read in from this malloc(0) buffer for data is going to be far greater for any image of reasonable size, as the destination bufferâ€™s size is x*y*bpp. This results in a large user-controlled amount of data being read from the heap and populated into the XCF tile for further processing, creating an out of bounds read.

### Crash Information

(Note: Compiled with ASAN)

```
Program received signal SIGSEGV, Segmentation fault.
0x00007f692455e127 in load_xcf_tile_rle (src=0x60700000dfb0, len=0x0, bpp=0x3, x=0x40, y=0x40) at IMG_xcf.c:496
warning: Source file is more recent than executable.
496
-------------------------------------------------------------------------[ registers ]----
$rax   : 0x0000602000010000 -> 0x0000000000000000 -> 0x0000000000000000
$rbx   : 0x00007ffd66fd8c30 -> 0x00007ffd66fda37f -> 0x3134373830363530 -> 0x3134373830363530 ("05608741"?)
$rcx   : 0x22ffffff00000000 -> 0x22ffffff00000000
$rdx   : 0x0000602000010001 -> 0x0000000000000000 -> 0x0000000000000000
$rsp   : 0x00007ffd66fd88d0 -> 0x00007ffd66fd8940 -> 0x00007ffd66fd89f0 -> 0x00007ffd66fd8ab0 -> 0x00007ffd66fd8af0 -> 0x00007ffd66fd8b20
-> 0x0000000000000002 ->
0x0000000000000002
$rbp   : 0x00007ffd66fd8940 -> 0x00007ffd66fd89f0 -> 0x00007ffd66fd8ab0 -> 0x00007ffd66fd8af0 -> 0x00007ffd66fd8b20 ->
0x0000000000000002 -> 0x0000000000000002
$rsi   : 0x0000000000000013 -> 0x0000000000000013
$rdi   : 0x00007f6924ae8540 -> 0x0000000000000014 -> 0x0000000000000014
$rip   : 0x00007f692455e127 -> <load_xcf_tile_rle+168> movzx eax, BYTE PTR [rax]
$r8    : 0x0000000000000000 -> 0x0000000000000000
$r9    : 0x000000000000001e -> 0x000000000000001e
$r10   : 0x00000000004bd553 -> 0x6349643375c08548 -> 0x6349643375c08548
$r11   : 0x0000000000000008 -> 0x0000000000000008
$r12   : 0x00000000004bd3e4 -> <_start+0> xor ebp, ebp
$r13   : 0x00007ffd66fd8c20 -> 0x0000000000000002 -> 0x0000000000000002
$r14   : 0xfffffffffffffff8 -> 0xfffffffffffffff8
$r15   : 0x0000000000000000 -> 0x0000000000000000
$eflags: [carry PARITY adjust zero sign trap INTERRUPT direction overflow RESUME virtualx86 identification]
-----------------------------------------------------------------------------[ stack ]----
0x00007ffd66fd88d0|+0x00: 0x00007ffd66fd8940 -> 0x00007ffd66fd89f0 -> 0x00007ffd66fd8ab0 -> 0x00007ffd66fd8af0 -> 0x00007ffd66fd8b20 ->
0x0000000000000002 -> 0x0000000000000002
<-$rsp
0x00007ffd66fd88d8|+0x08: 0x0000004000000040 -> 0x0000000000000000 -> 0x0000000000000000
0x00007ffd66fd88e0|+0x10: 0x0000000000000003 -> 0x0000000000000003
0x00007ffd66fd88e8|+0x18: 0x000060700000dfb0 -> 0x00007f69247c0e48 -> 0x20ec8348e5894855 -> 0x20ec8348e5894855
0x00007ffd66fd88f0|+0x20: 0x0000000000000000 -> 0x0000000000000000
0x00007ffd66fd88f8|+0x28: 0x00007f69236c097d -> 0x01c4f6038bc28948 -> 0x01c4f6038bc28948
0x00007ffd66fd8900|+0x30: 0x00006270001b2100 -> 0x0000be0000be0000 -> 0x0000be0000be0000
0x00007ffd66fd8908|+0x38: 0x00000000247c0f03 -> 0x00000000247c0f03
------------------------------------------------------------------[ code:i386:x86-64 ]----
0x7f692455e10f <load_xcf_tile_rle+144> mov    DWORD PTR [rbp-0x1c], 0x0
0x7f692455e116 <load_xcf_tile_rle+151> jmp    0x7f692455e22a <load_xcf_tile_rle+427>
0x7f692455e11b <load_xcf_tile_rle+156> mov    rax, QWORD PTR [rbp-0x8]
0x7f692455e11f <load_xcf_tile_rle+160> lea    rdx, [rax+0x1]
0x7f692455e123 <load_xcf_tile_rle+164> mov    QWORD PTR [rbp-0x8], rdx
->0x7f692455e127 <load_xcf_tile_rle+168> movzx  eax, BYTE PTR [rax]
0x7f692455e12a <load_xcf_tile_rle+171> mov    BYTE PTR [rbp-0x41], al
0x7f692455e12d <load_xcf_tile_rle+174> movzx  eax, BYTE PTR [rbp-0x41]
0x7f692455e131 <load_xcf_tile_rle+178> mov    DWORD PTR [rbp-0x24], eax
0x7f692455e134 <load_xcf_tile_rle+181> cmp    DWORD PTR [rbp-0x24], 0x7f
0x7f692455e138 <load_xcf_tile_rle+185> jle    0x7f692455e1b0 <load_xcf_tile_rle+305>
--------------------------------------------------------------[ source:IMG_xcf.c+496 ]----
492    for (i = 0; i < bpp; i++) { //ah, we write every 'i'th byte in the Surface
493      d    = data + i; //d is the offending variable...
494      size = x*y; //0x1000
495      count = 0;
-> 496
497      while (size > 0) { //size == amount of pixels (=>total size == x*y*bpp)
498        val = *t++; // #! t => OOB. Size starts at 0x1000
499
500        length = val; //length == length of consecutive pixels that are same color?
---------------------------------------------------------------------------[ threads ]----
[#0] Id 1, Name: "", stopped, reason: SIGSEGV
-----------------------------------------------------------------------------[ trace ]----
[#0] 0x7f692455e127->Name: load_xcf_tile_rle(src=0x60700000dfb0, len=0x0, bpp=0x3, x=0x40, y=0x40)
[#1] 0x7f692455e55d->Name: do_layer_surface(surface=0x60800000be20, src=0x60700000dfb0, head=0x60700000df40, layer=0x60600000eea0,
load_tile=0x7f692455e07f <load_xcf_tile_rle>)
[#2] 0x7f692455ee24->Name: IMG_LoadXCF_RW(src=0x60700000dfb0)
[#3] 0x7f692453c7ef->Name: IMG_LoadTyped_RW(src=0x60700000dfb0, freesrc=0x1, type=0x0)
[#4] 0x7f692453c5e0->Name: IMG_Load(file=0x7ffd66fda37f "0560874168f86c7aeeee2edcf2cea202")
[#5] 0x4bd553->Name: main(argc=<optimized out>, argv=<optimized out>)
------------------------------------------------------------------------------------------

```
### Timeline

2018-02-06 - Vendor Disclosure

2018-02-07 - Vendor patched

2018-04-10 - Public Release

##### Credit

Discovered by Lilith of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2018-0521](/vulnerability_reports/TALOS-2018-0521) [Previous Report

TALOS-2018-0519](/vulnerability_reports/TALOS-2018-0519)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

Â©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)


