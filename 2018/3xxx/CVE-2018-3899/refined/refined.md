The provided content is related to CVE-2018-3899.

**Root cause of vulnerability:**
A stack-based buffer overflow vulnerability exists in the `trans_info` function when parsing the password parameter from a QR code. This occurs because the `sscanf` function is used to copy data into a fixed-size buffer on the stack without proper bounds checking, leading to an overflow if the input data exceeds the buffer's capacity.

**Weaknesses/vulnerabilities present:**
- Stack-based buffer overflow (CWE-121) in the `trans_info` function.
- Lack of bounds checking when using `sscanf` to copy data into stack-allocated buffers.
- Vulnerable parsing of data from a QR code, specifically the password parameter.

**Impact of exploitation:**
Successful exploitation allows an attacker to overwrite the return address on the stack, enabling arbitrary code execution on the device. This could give the attacker full control of the device.

**Attack vectors:**
An attacker can exploit this vulnerability by crafting a malicious QR code containing an overly long password parameter. The victim would have to scan the malicious QR code with the vulnerable Yi Home Camera.
Alternatively, a user could be convinced to display a QR code from the internet to their camera, which could exploit this vulnerability.

**Required attacker capabilities/position:**
- The attacker needs the capability to generate a QR code with a long password parameter.
- The attacker needs the victim to scan the malicious QR code using the vulnerable Yi Home Camera.

**Additional details:**
- The vulnerability is triggered in the `trans_info` function when parsing the parameters within a string that is extracted from the scanned QR code. Specifically, when parsing the `&p=` parameter (password).
- The `sscanf` function is used to extract the value of the parameter, copying the string into the `password_dst` buffer located on the stack. Because there is no length limit on `sscanf`, a long parameter value can overwrite the return address stored on the stack.
- The exploit is triggered when the function returns. Therefore the device needs to connect to the network first for the exploit to work, which occurs after scanning a valid QR code.
- The maximum QR code read length is 263 characters, which is sufficient for a buffer overflow on either the SSID or password buffers.
- CVE-2018-3898 is a similar vulnerability, but it is triggered by a long SSID parameter (`&s=`), instead of the password parameter (`&p=`).