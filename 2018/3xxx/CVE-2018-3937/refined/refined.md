- **Root cause of vulnerability**: The vulnerability is due to a lack of proper input sanitization when parsing the server address within the `measurement` parameter of HTTP requests to `main.cgi`. This unsanitized input is then used in a command executed via `system`.
- **Weaknesses/vulnerabilities present**:
    - OS Command Injection (CWE-78)
    - Improper handling of user-supplied input
- **Impact of exploitation**:
    - Arbitrary command execution on the affected device
    - Full control of the camera and potentially the network
- **Attack vectors**:
    - Sending a specially crafted HTTP GET request to `/command/main.cgi`.
- **Required attacker capabilities/position**:
    - The attacker needs to be able to send HTTP requests to the camera.
    - No authentication is required, making it an easily exploitable vulnerability.
- **Additional details**:
   - The vulnerability is triggered by including shell commands within the server address field of the `measurement` parameter. Specifically, the value passed to the `-c` parameter of the iperf command is vulnerable
   - The `measurement` parameter takes the following format: `measurement=bitrate,client,[server_address],udp|tcp,[port]`. The vulnerability lies in the processing of the `server_address`.
   - The `main.cgi` script parses the input by splitting the string at commas, but it doesn't sanitize the content of the server address field, allowing for command injection.
   - The iperf command is then executed via a shell, enabling command injection.