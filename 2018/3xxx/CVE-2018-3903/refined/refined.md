- **Root cause of vulnerability**: The `video-core` process in Samsung SmartThings Hub incorrectly handles user-controlled JSON payloads when updating camera information. Specifically, the `memcpy` function copies data from the JSON payload into stack buffers without proper size checks.
- **Weaknesses/vulnerabilities present**:
  - **Classic Buffer Overflow (CWE-120)**: The `memcpy` function copies data from a user-controlled JSON string into a fixed-size buffer on the stack without verifying if the source string's length exceeds the buffer's capacity, leading to a buffer overflow.
- **Impact of exploitation**:
    - An attacker can overwrite the return address on the stack, leading to arbitrary code execution with root privileges, since `video-core` is running as root.
- **Attack vectors**:
    - **Impersonating Remote Servers**: An attacker who can impersonate the remote SmartThings servers can send malicious HTTP requests to `hubCore`, which relays them to the vulnerable `video-core` process.
    - **Malicious SmartApps**: A malicious SmartApp installed on the hub can send crafted HTTP requests directly to the `video-core` process.
    - **Malicious Mobile Application**: A malicious request could potentially be sent from the SmartThings mobile application to the remote SmartThings servers which may relay it to the hub. This vector was not tested as it could affect live infrastructure.
- **Required attacker capabilities/position**:
    - The attacker needs to be able to send crafted HTTP requests to the `video-core` process listening on localhost port 3000.
    - This can be achieved by:
       - Impersonating the remote SmartThings servers, which communicate with `hubCore` via a persistent TLS connection. `hubCore` then relays HTTP requests to `video-core`.
       - Developing and installing a malicious SmartApp that executes in the `hubCore` process and can connect to localhost.
       - Possibly by controlling the SmartThings mobile application which would communicate with the remote server, which in turn, could relay the request to the hub via TLS.