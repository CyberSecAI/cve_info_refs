Based on the provided content, here's the vulnerability information for CVE-2018-3871:

**Root cause of vulnerability:**
The vulnerability is caused by an out-of-bounds write in the PCX parsing functionality of Canvas Draw 4.0.0. Specifically, the application does not properly validate the column and row sizes specified in the PCX image header.

**Weaknesses/vulnerabilities present:**
- **Out-of-bounds write:** The application attempts to write image data to a memory location outside of the allocated buffer due to incorrect column/row values in the PCX header.
- **Insufficient input validation:** The application fails to validate the values for image dimensions in the PCX header leading to negative values when performing calculations resulting in memory access out of bounds.

**Impact of exploitation:**
- **Code Execution:** By controlling the out-of-bounds write, an attacker can overwrite arbitrary data which could lead to arbitrary code execution.
- **Crash:** The out-of-bounds write leads to an application crash due to accessing invalid memory locations.

**Attack vectors:**
- The attacker must provide a specially crafted PCX image file to the vulnerable application.

**Required attacker capabilities/position:**
- The attacker needs to be able to deliver the crafted PCX image file and have the victim open it using the vulnerable software.
- No special privileges are required.

**Additional Details:**

- The vulnerability is located within the `invert_map` function of the ImageIO library.
- The vulnerability occurs when the application calculates image dimensions using potentially malformed values present in the PCX header.
- Specifically, the `left` value in the header is set too high, resulting in a negative value for column calculation leading to an out of bounds write when accessing the image map.
- The crash analysis shows that the out-of-bounds write occurs when the application attempts to write data to an address controlled by the user due to the invalid PCX header.