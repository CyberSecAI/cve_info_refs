- **Root cause of vulnerability:** The `video-core` process in Samsung SmartThings Hub incorrectly parses user-controlled JSON payloads, leading to a JSON injection. This injection, in turn, results in a SQL injection due to lack of sanitization.
- **Weaknesses/vulnerabilities present:**
    - Improper neutralization of special elements in output used by a downstream component ('Injection') (CWE-74).
    - Lack of sanitization of user-supplied JSON parameters before being used to construct a SQL query.
    - Use of `sprintf` to build a JSON string using attacker-controlled data without proper escaping, which allows injection of single quotes and additional fields.
    - The `json-c` library compiled with `JSON_TOKENER_STRICT=0` allows strings with both single and double quotes in the JSON payload.
    - Stack-based buffer overflow due to unexpected overlong `locationId` read from the database when deleting a camera. (This is related to TALOS-2018-0557 but is a consequence of this vulnerability).
- **Impact of exploitation:**
    - Arbitrary SQL query execution, which could lead to arbitrary code execution in the context of the `video-core` process.
    -  Denial of Service (DoS) by crashing the `video-core` process due to stack-based buffer overflow (related to TALOS-2018-0557).
- **Attack vectors:**
    - An attacker able to impersonate the remote SmartThings servers can send arbitrary HTTP requests to `hubCore`, which would be relayed to the vulnerable `video-core` process.
    - SmartThings SmartApps can be used to send arbitrary HTTP requests directly to the vulnerable `video-core` process via localhost connection.
    - Potentially, a malicious request from the SmartThings mobile application to the remote SmartThings servers could be used, if the server APIs allow such relay. This would require a valid OAuth bearer token or username/password.
- **Required attacker capabilities/position:**
    - For the server impersonation vector, the attacker needs to be able to impersonate the remote SmartThings servers.
    - For the SmartApps vector, the attacker needs to be able to create and run a SmartApp on the hub.
    - For the mobile application vector, the attacker would need a valid OAuth token or the credentials to obtain it.
    - The attacker must be able to send HTTP requests to the `video-core` process on port 3000 (localhost).