- **Root cause of vulnerability**: A buffer overflow occurs in the `video-core` process of Samsung SmartThings Hub when handling a PUT request to the `/cameras/<camera-id>` path. The `memcpy` function copies the user-controlled URL field from a JSON payload to a stack buffer without checking its size, leading to a buffer overflow.
- **Weaknesses/vulnerabilities present**:
    - Classic buffer overflow (CWE-120): The `memcpy` operation copies a user-provided string to a stack buffer without validating the length of the input, allowing an attacker to write past the buffer's boundaries.
- **Impact of exploitation**:
    - Code execution: By overwriting the saved-PC on the stack with a controlled value, an attacker can gain arbitrary code execution on the vulnerable `video-core` process which runs as root.
    - Process crash: Overwriting the stack can lead to a denial of service by crashing the `video-core` process.
- **Attack vectors**:
    - Impersonating SmartThings servers: An attacker can impersonate the remote SmartThings servers to send malicious HTTP requests to the `hubCore` process, which relays them to the vulnerable `video-core` process.
    - Malicious SmartApps: An attacker can create and deploy a SmartApp to the hub that sends malicious HTTP requests directly to the `video-core` process.
    - Potentially through the mobile application: An attacker might be able to send a malicious request via the mobile application that could be relayed by the SmartThings servers to the hub, although this vector was not fully tested.
- **Required attacker capabilities/position**:
    - Ability to send HTTP requests to the `video-core` process, either via impersonating the remote servers, using a SmartApp running on the hub or potentially through the mobile application if it relays the attack.
    -  For some attack vectors a valid OAuth bearer token is required or username and password for account ownership.