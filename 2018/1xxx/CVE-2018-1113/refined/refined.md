```
{
  "CVE-2018-1113": {
    "related_content": [
      {
        "source": "www.redhat.com_3bd17e9a_20250126_082822.html",
        "vulnerability": "UNRELATED"
      },
      {
        "source": "access.redhat.com_d83c3b3a_20250126_082833.html",
         "vulnerability": "UNRELATED"
      },
      {
        "source": "bugzilla.redhat.com_b7cad6b6_20250126_082833.html",
        "vulnerability": {
          "root_cause": "The `setup` package in Fedora and Red Hat Enterprise Linux included `/sbin/nologin` and `/usr/sbin/nologin` in `/etc/shells`.",
          "weaknesses": [
            "Inclusion of `/sbin/nologin` and `/usr/sbin/nologin` in `/etc/shells`",
             "Violated security assumptions made by `pam_shells` and daemons that rely on `/etc/shells` for valid shells."
          ],
          "impact": "Users with `/sbin/nologin` set as their shell, could under certain circumstances, still access the system.",
          "attack_vectors": [
            "Exploitation of the inclusion of `/sbin/nologin` and `/usr/sbin/nologin` in `/etc/shells` by bypassing the intended restrictions."
          ],
          "required_attacker_capabilities": [
            "Ability to leverage the fact that `/sbin/nologin` is listed as a valid shell in `/etc/shells`."
          ],
          "additional_details": "SELinux and gdm had workarounds for this issue. Recommendation: change the user's login shell to a harmless command not in '/etc/shells' (e.g. '/bin/false'), lock the user's password, and restrict access to the user's home directory."
        }
      },
      {
        "source": "bugzilla.redhat.com_bd9fd357_20250126_082827.html",
        "vulnerability": {
          "root_cause": "The `setup` package included `/sbin/nologin` and `/usr/sbin/nologin` in `/etc/shells`, which violates the security assumptions of `su`, `nologin` and `/etc/shells`.",
          "weaknesses": [
            "Listing `nologin` in `/etc/shells` which should only contain non-restricted shells"
          ],
           "impact": "Users with `/sbin/nologin` as shell can still log in using `su -s /usr/bin/bash - user`. `su` should not allow a restricted shell and should adhere to the entries in `/etc/shells`.",
          "attack_vectors": [
            "Use `su` to bypass the restriction of the `nologin` shell."
          ],
          "required_attacker_capabilities": [
            "Ability to use `su` command"
          ],
           "additional_details": "The issue was introduced by the `setup` package, not `util-linux`. The fix was to remove `/sbin/nologin` and `/usr/sbin/nologin` from `/etc/shells`."
        }
      },
       {
        "source": "www.redhat.com_6f06c008_20250126_082824.html",
        "vulnerability": "UNRELATED"
      },
      {
        "source": "access.redhat.com_454c41e2_20250125_122415.html",
        "vulnerability": "UNRELATED"
      },
       {
        "source": "www.redhat.com_d853cde0_20250126_082831.html",
        "vulnerability": "UNRELATED"
      },
       {
        "source": "bugzilla.redhat.com_708b3eaf_20250126_082831.html",
         "vulnerability": "UNRELATED"
       },
      {
        "source": "bugzilla.redhat.com_1243c730_20250125_122422.html",
        "vulnerability": {
          "root_cause": "The `setup` package added `/sbin/nologin` and `/usr/sbin/nologin` to `/etc/shells`",
          "weaknesses": [
            "`/etc/shells` was modified to include `nologin`",
             "Security assumptions of `pam_shells` and daemons relying on `/etc/shells` were violated."
          ],
          "impact": "Users with `/sbin/nologin` as their shell could still access the system under some circumstances.",
          "attack_vectors": [
            "Bypassing intended shell restrictions by exploiting `nologin` being listed in `/etc/shells`."
           ],
          "required_attacker_capabilities": [
            "Ability to authenticate to the system"
          ],
           "additional_details": "SELinux and gdm had special case workarounds. A three-pronged approach to prevent access was recommended: change the user's login shell to a harmless command not in '/etc/shells', lock the user's password, and restrict access to the user's home directory."
        }
      },
       {
        "source": "www.redhat.com_1345f500_20250126_082823.html",
        "vulnerability": "UNRELATED"
      },
      {
        "source": "www.redhat.com_9b9f148b_20250126_082824.html",
        "vulnerability": "UNRELATED"
       },
      {
        "source": "access.redhat.com_fb91be51_20250126_082826.html",
        "vulnerability": "UNRELATED"
      },
      {
         "source": "access.redhat.com_9bcd4bd1_20250125_122415.html",
        "vulnerability": {
            "root_cause": "The setup package included `/sbin/nologin` in `/etc/shells`.",
            "weaknesses": [
               "Listing `/sbin/nologin` in `/etc/shells`."
            ],
             "impact": "Users could bypass shell restrictions meant to prevent login.",
              "attack_vectors": [
                "Exploiting the presence of `/sbin/nologin` in `/etc/shells` to bypass intended login restrictions."
              ],
             "required_attacker_capabilities": [
                "Ability to authenticate as a user"
              ],
            "additional_details": "Red Hat Enterprise Linux 7.6 Release Notes mentioned that this issue was fixed by removing nologin from `/etc/shells`"
          }
       },
         {
        "source": "access.redhat.com_6a9f92b2_20250126_082829.html",
        "vulnerability": "UNRELATED"
      }
    ]
  }
}
```