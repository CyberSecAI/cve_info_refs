Based on the provided content, here's the breakdown of the vulnerability:

*   **Root Cause:** The vulnerability stems from the fact that Moodle did not properly check the suspension status of users when they were authenticating via the OAuth2 authentication method.

*   **Weaknesses/Vulnerabilities:**
    *   **Insufficient Access Control:** Suspended user accounts were not being properly blocked during login attempts when using OAuth2.
    *   **Authentication Bypass:**  The system failed to prevent suspended users from authenticating to the platform via OAuth2.

*   **Impact of Exploitation:**
    *   A suspended user, who should have been denied access, could still log in to the Moodle site. This could allow them to access resources, participate in activities, or cause unauthorized changes depending on their privileges and the system's configurations.

*   **Attack Vectors:**
    *   The user has to have an account that was once active on the system via OAuth2 authentication.
    *   The user account has to be suspended by the Moodle administrator.
    *   The user attempts to authenticate via OAuth2.

*   **Required Attacker Capabilities/Position:**
    *   The attacker must be a user who was once confirmed and active using the OAuth2 authentication method.
    *   The user's account must have been subsequently suspended by a Moodle administrator.
    *   The attacker needs to be able to initiate the OAuth2 authentication process.

**Additional Details:**

*   The vulnerability is tracked as **MSA-18-0006** in Moodle's security announcements.
*   The affected versions are Moodle **3.4 to 3.4.1** and **3.3 to 3.3.4**.
*   The vulnerability was fixed in Moodle versions **3.4.2** and **3.3.5.**
*   The fix is associated with the commit [MDL-60101](http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-60101).
*   The vulnerability was reported by Helen Foster.