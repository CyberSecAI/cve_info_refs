```
{
  "CVE-2018-1058": {
    "Metadata": {
      "ID": "CVE-2018-1058",
      "Description": "PLACEHOLDER - Implement CVE description retrieval"
    },
    "Analysis": {
      "Summary": "The provided documents describe a vulnerability in PostgreSQL related to uncontrolled search path elements in pg_dump and other client applications, identified as CVE-2018-1058. This vulnerability allows a user with CREATE privileges on any schema to execute arbitrary SQL functions under the identity of another user (often a superuser) due to the way PostgreSQL client applications handle the search_path setting.",
      "Root Cause": "The vulnerability stems from the fact that client applications like pg_dump, by default, include every schema at the front of their search path, and other client applications, such as vacuumdb, leave the search_path unchanged which allows an attacker to insert a trojan-horse function.",
      "Vulnerabilities": [
        "Uncontrolled search path vulnerability."
      ],
      "Impact": "An attacker can execute arbitrary SQL code with the permissions of a superuser or another user who executes a client application, leading to potential privilege escalation, data compromise or other malicious activity. This can also cause other unexpected behavior.",
       "Attack Vector": "An attacker with `CREATE` privileges in any schema, including the default `public` schema, can create objects (e.g., functions, operators) with the same name as objects in other schemas that would be used in a victim's query. When that victim runs a query, their client application may use the malicious object instead of intended one. In addition, client applications like pg_dump, pg_upgrade and other tools were themselves vulnerable."
,
      "Attacker Capabilities": "An attacker needs to have the ability to create objects in a database schema, which can often be accomplished by having a valid database user account and `CREATE` privileges in at least one schema.  It is also necessary for the attacker to somehow cause the victim to execute code that depends on the `search_path`.",
       "Affected Versions": [
         "PostgreSQL versions 9.3, 9.4, 9.5, 9.6, and 10 prior to the patched versions.",
         "Red Hat Software Collections (multiple versions)",
         "Red Hat Virtualization Manager 4.2",
         "Red Hat CloudForms Management Engine 5.9",
         "Ubuntu 17.10, 16.04, 14.04."
        ]
    },
    "Resolution": {
     "Mitigation": [
        "The upstream PostgreSQL project recommends the following mitigations:",
        "Revoke CREATE privilege on the public schema from public: REVOKE CREATE ON SCHEMA public FROM PUBLIC;",
        "Modify the search_path of database users: ALTER ROLE username SET search_path = \"\\$user\";",
        "Set the default search_path to not include untrusted schemas in the postgresql.conf configuration file."

      ],
     "Official Patches": [
         "PostgreSQL versions 10.3, 9.6.8, 9.5.12, 9.4.17, and 9.3.22 and later versions address this issue.",
         "Red Hat Software Collections packages have been updated to address this vulnerability.",
         "Red Hat Virtualization Manager and CloudForms Management Engine have also been updated.",
          "Ubuntu 17.10, 16.04, 14.04 have been updated."
      ]
    }
  }
}
```