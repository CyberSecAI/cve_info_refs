=== Content from mahara.org_11b4b922_20250125_051702.html ===

[Skip to main content](#header-main)

* [Login](https://mahara.org/?login)

Show search

SearchGo

[![Mahara ePortfolio System](https://mahara.org/theme/mahara-org/images/site-logo.svg?v=4171)](https://mahara.org/)
[![Mahara ePortfolio System](https://mahara.org/theme/raw/images/site-logo-small.svg?v=4171)](https://mahara.org/)
Show main menu

* [Home](https://mahara.org/)
* [Subscription](https://mahara.org/subscription)
* [Demo](https://mahara.org/demo)
* About

  + [About Mahara](https://mahara.org/about)
  + [About open source](https://mahara.org/about/opensource)
  + [Features](https://mahara.org/features)
  + [What is an ePortfolio?](https://mahara.org/about/eportfolios)
  + [Who is using Mahara?](https://mahara.org/showcase)
  + [News and announcements](https://mahara.org/news)
  + [Newsletter](https://mahara.org/newsletter)
  + [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* Community

  + [Community](https://mahara.org/community)
  + [Forums](https://mahara.org/forums)
  + [Mahara manual](https://mahara.org/documentation)
  + [Wiki](https://mahara.org/wiki)
  + [Bug / feature tracker](https://mahara.org/tracker)
  + [Release notes](https://mahara.org/releasenotes)
  + [Security](https://mahara.org/security)
  + [Contributors](https://mahara.org/community/contributors)
  + [Branding](https://mahara.org/branding)
  + [Events](https://mahara.org/events)
* Partners

  + [Partners](https://mahara.org/partners)
  + [Business Partners](https://mahara.org/business-partners)
  + [Supporters](https://mahara.org/supporters)

# Portfolios for your learning community

SearchGo

[Try out Mahara](http://demo.mahara.org/)

![Continuous single line drawing of a puhutukawa tree with a tui on the branches](https://mahara.org/theme/mahara-org/images/dashboard-tree-desktop-full.svg)

![Continuous single line drawing of a person working on a laptop](https://mahara.org/theme/mahara-org/images/dashboard-person-desktop.svg)

## Create portfolios

Using Mahara, students and staff create their personal learning stories by uploading evidence of activities they have participated in, and embedding publicly accessible content they have previously put online. They can write reflections on their experiences that frame this evidence, map it to competencies or registration requirements, and provide necessary context.

Mahara can be used for many different portfolio purposes, such as study, professional development, work-integrated learning, assessment, showcase and presentation, and employability.

[Learn about the portfolio options](https://mahara.org/view/view.php?id=137010)

## Share work

Mahara allows portfolios to be shared flexibly with one person, a specific group of people, or the entire world. Access can be further restricted to a particular time frame or just within an assessment task.

[Find out about sharing portfolios](https://mahara.org/view/view.php?id=137011)

![Continuous single line drawing of a paper plane in flight](https://mahara.org/theme/mahara-org/images/dashboard-paperplane-desktop.svg)

![Continuous single line drawing of a group of people sitting around a laptop in discussion](https://mahara.org/theme/mahara-org/images/dashboard-group-desktop.svg)

## Engage with others

Mahara makes it easy to comment and give feedback. Portfolios can also be submitted to learning management systems via LTI (Learning Tools Interoperability) for marking.

Groups in Mahara allow people to create portfolios collaboratively and engage in forum discussions.

[Learn about collaborating in Mahara](https://mahara.org/view/view.php?id=137012)

## Listen to portfolio stories

In our podcast 'Create. Share. Engage.' portfolio practitioners, researchers, learning designers, and portfolio authors share their journey. Learn how they navigate the many different facets of portfolios in general, and Mahara specifically.

[Listen on the podcast website or in your favourite app](https://podcast.mahara.org/)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-desktop.svg)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-logo.svg)

Mahara Community

* [About
  (tab)](https://mahara.org/group/mahara-community)
* [Members
  (tab)](https://mahara.org/group/members.php?id=1)
* [Forums
  (tab selected)](https://mahara.org/interaction/forum/index.php?group=1)
* [Portfolios
  (tab)](https://mahara.org/view/groupviews.php?group=1)

# Forums | Mahara Community

## [Security Announcements](https://mahara.org/interaction/forum/view.php?id=43) / Security issue relating to cross-site scripting <16.10.9; <17.04.7; <17.10.4

---

This topic is closed. Only moderators and the group administrators can post new replies.

![Robert Lyon's profile picture](https://mahara.org/thumb.php?type=profileiconbyid&maxwidth=40&maxheight=40&id=313288)
[Robert Lyon](https://mahara.org/user/robertlyon-1)

Posts: 778

06 April 2018, 11:32

Avoid relying on TinyMCE code stripping alone

Vuln type: XSS
Impact: Code execution

Mahara 16.10 before 16.10.9, 17.04 before 17.04.7 and 17.10 before 17.10.4 are vulnerable to bad input when TinyMCE is bypassed by POST packages. Therefore, Mahara should not rely on TinyMCE's code stripping alone but also clean input on the server / PHP side as one can create own packets of POST data containing bad content with which to hit the server.

Reported by 陈瑞琦 (Chen Ruiqi)
Bug report: [https://bugs.launchpad.net/mahara/+bug/1744789](https://bugs.launchpad.net/mahara/%2Bbug/1744789)
CVE reference: [CVE-2018-6182](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-6182)

1 result

## Subscribe to our monthly newsletter

Do you want to stay updated on the latest news from Mahara and wider portfolio community? Subscribe to the monthly Mahara newsletter from Catalyst, the maintainers of Mahara.

[Sign up for the newsletter](https://zcu.nz/wpPM)

Create. Share. Engage.
[Try out Mahara](http://demo.mahara.org/)
[Support Mahara](https://mahara.org/subscription)

#### [Support](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Mahara manual](https://mahara.org/documentation)
* [Wiki](https://mahara.org/wiki)
* [Bug / feature tracker](https://mahara.org/tracker)
* [Extended security support](https://mahara.org/extended-security-support)

#### [Get involved](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Code repository](https://mahara.org/repository)
* [Contribute](https://mahara.org/contribute)
* [Release notes](https://mahara.org/releasenotes)
* [Events](https://mahara.org/events)

#### [About](https://mahara.org/about)

* [News and announcements](https://mahara.org/news)
* [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* [Contributors](https://mahara.org/community/contributors)
* [Security](https://mahara.org/security)
* [Accessibility](https://mahara.org/accessibility)

#### [Home](https://mahara.org/)

#### [Partners](https://mahara.org/partners)

#### [Subscription](https://mahara.org/subscription)

#### [Demo site](https://mahara.org/demo)

[![Powered by Mahara](https://mahara.org/theme/mahara-org/images/powered_by_mahara.svg?v=4171)](https://mahara.org/)

* [Legal](https://mahara.org/legal.php)
* [Contact us](https://mahara.org/contact.php)
* [Help](https://manual.mahara.org/en/24.04/)

[![Developed and maintained by Catalyst](https://mahara.org/theme/mahara-org/images/maintained-by-catalyst.png)](https://catalyst.net.nz/)

[Follow us on LinkedIn](https://www.linkedin.com/company/1845966)

[Find us on Mastodon](https://mastodon.nzoss.nz/%40mahara)



=== Content from bugs.launchpad.net_07195ca2_20250126_061445.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1744789/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Avoid relying on TinyMCE code stripping alone

Bug #1744789 reported by
[Robert Lyon](https://launchpad.net/~robertl-9)
on 2018-01-22

[256](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | High | [Robert Lyon](https://launchpad.net/~robertl-9) | [Mahara 18.04.0](https://launchpad.net/mahara/%2Bmilestone/18.04.0) |
|  | [16.10](https://bugs.launchpad.net/mahara/16.10) | Fix Released | High | Unassigned | [Mahara 16.10.9](https://launchpad.net/mahara/%2Bmilestone/16.10.9) |
|  | [17.04](https://bugs.launchpad.net/mahara/17.04) | Fix Released | High | Unassigned | [Mahara 17.04.7](https://launchpad.net/mahara/%2Bmilestone/17.04.7) |
|  | [17.10](https://bugs.launchpad.net/mahara/17.10) | Fix Released | High | Unassigned | [Mahara 17.10.4](https://launchpad.net/mahara/%2Bmilestone/17.10.4) |
|  | [18.04](https://bugs.launchpad.net/mahara/18.04) | Fix Released | High | [Robert Lyon](https://launchpad.net/~robertl-9) | [Mahara 18.04.0](https://launchpad.net/mahara/%2Bmilestone/18.04.0) |
|  | [18.10](https://bugs.launchpad.net/mahara/18.10) | Fix Released | High | Unassigned | [Mahara 18.10.0](https://launchpad.net/mahara/%2Bmilestone/18.10.0) |

### Bug Description

TinyMCE will strip bad strings from input, eg <script> tags but we must make sure we don't just rely on that alone. We should also clean up input on the server/php end as one can create their own packet of POST data containing bad content to hit the server with.

This can be seen in the Wall plugin where we can make a wallpost POST package have a bad 'text' value and have it save unaltered.

## CVE References

* [2018-6182](/bugs/cve/2018-6182 "Mahara 16.10 before 16.10.9 and 17.04...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9) wrote on 2018-01-22: |  |  | [#1](/mahara/%2Bbug/1744789/comments/1) |
| --- | --- | --- | --- |

Need to check all the places where the tinymce is used for a form field and make sure it is being saved in a safe way on the php side

Need to check all the places where the tinymce is used for a form field and make sure it is being saved in a safe way on the php side

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2018-01-23: |  |  | [#2](/mahara/%2Bbug/1744789/comments/2) |
| --- | --- | --- | --- |

Discoverer credit: 陈瑞琦 (Chen Ruiqi)

Discoverer credit: 陈瑞琦 (Chen Ruiqi)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2018-04-05:  [**A change has been merged**](/mahara/%2Bbug/1744789/comments/3) |  |  | [#3](/mahara/%2Bbug/1744789/comments/3) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/8784>

Committed: <https://git.mahara.org/mahara/mahara/commit/8a8b21e4014137680da34d00af76c608c3f8b222>

Submitter: Robert Lyon (<email address hidden>)

Branch: 18.04\_STABLE

commit 8a8b21e4014137680da34d00af76c608c3f8b222

Author: Robert Lyon <email address hidden>

Date: Thu Jan 18 10:43:37 2018 +1300

Security [Bug 1744789](/bugs/1744789): Remove bad code from wallpost post

We currently escape post content before submission

But we also need to do cleaning on php side incase hacker posts directly

Also needing to clean up annotations with bad html in their

descriptions and resume composite fields with bad html in their

descriptions

behatnotneeded

Change-Id: I8c7def1acad7b6692a96b2ba065c23abcd69cfb5

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit cff112250a5710b7a897e0f392a429cd29779ecc)

Reviewed: https://reviews.mahara.org/8784
Committed: https://git.mahara.org/mahara/mahara/commit/8a8b21e4014137680da34d00af76c608c3f8b222
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 18.04\_STABLE
commit 8a8b21e4014137680da34d00af76c608c3f8b222
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Thu Jan 18 10:43:37 2018 +1300
Security Bug 1744789: Remove bad code from wallpost post
We currently escape post content before submission
But we also need to do cleaning on php side incase hacker posts directly
Also needing to clean up annotations with bad html in their
descriptions and resume composite fields with bad html in their
descriptions
behatnotneeded
Change-Id: I8c7def1acad7b6692a96b2ba065c23abcd69cfb5
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit cff112250a5710b7a897e0f392a429cd29779ecc)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2018-04-05:  [**A patch has been submitted for review**](/mahara/%2Bbug/1744789/comments/4) |  |  | [#4](/mahara/%2Bbug/1744789/comments/4) |
| --- | --- | --- | --- |

Patch for "17.10\_STABLE" branch: <https://reviews.mahara.org/8785>

Patch for "17.10\_STABLE" branch: https://reviews.mahara.org/8785

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2018-04-05: |  |  | [#5](/mahara/%2Bbug/1744789/comments/5) |
| --- | --- | --- | --- |

Patch for "17.04\_STABLE" branch: <https://reviews.mahara.org/8786>

Patch for "17.04\_STABLE" branch: https://reviews.mahara.org/8786

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2018-04-05: |  |  | [#6](/mahara/%2Bbug/1744789/comments/6) |
| --- | --- | --- | --- |

Patch for "16.10\_STABLE" branch: <https://reviews.mahara.org/8787>

Patch for "16.10\_STABLE" branch: https://reviews.mahara.org/8787

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2018-04-05:  [**A change has been merged**](/mahara/%2Bbug/1744789/comments/7) |  |  | [#7](/mahara/%2Bbug/1744789/comments/7) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/8787>

Committed: <https://git.mahara.org/mahara/mahara/commit/b0bdbc78e23ae0b5905fa50c6faed5803fdba6f4>

Submitter: Robert Lyon (<email address hidden>)

Branch: 16.10\_STABLE

commit b0bdbc78e23ae0b5905fa50c6faed5803fdba6f4

Author: Robert Lyon <email address hidden>

Date: Thu Jan 18 10:43:37 2018 +1300

Security [Bug 1744789](/bugs/1744789): Remove bad code from wallpost post

We currently escape post content before submission

But we also need to do cleaning on php side incase hacker posts directly

Also needing to clean up annotations with bad html in their

descriptions and resume composite fields with bad html in their

descriptions

behatnotneeded

Change-Id: I8c7def1acad7b6692a96b2ba065c23abcd69cfb5

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit cff112250a5710b7a897e0f392a429cd29779ecc)

(cherry picked from commit 8a8b21e4014137680da34d00af76c608c3f8b222)

Reviewed: https://reviews.mahara.org/8787
Committed: https://git.mahara.org/mahara/mahara/commit/b0bdbc78e23ae0b5905fa50c6faed5803fdba6f4
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 16.10\_STABLE
commit b0bdbc78e23ae0b5905fa50c6faed5803fdba6f4
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Thu Jan 18 10:43:37 2018 +1300
Security Bug 1744789: Remove bad code from wallpost post
We currently escape post content before submission
But we also need to do cleaning on php side incase hacker posts directly
Also needing to clean up annotations with bad html in their
descriptions and resume composite fields with bad html in their
descriptions
behatnotneeded
Change-Id: I8c7def1acad7b6692a96b2ba065c23abcd69cfb5
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit cff112250a5710b7a897e0f392a429cd29779ecc)
(cherry picked from commit 8a8b21e4014137680da34d00af76c608c3f8b222)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2018-04-05: |  |  | [#8](/mahara/%2Bbug/1744789/comments/8) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/8785>

Committed: <https://git.mahara.org/mahara/mahara/commit/bc568169ba3fc7aae348fe8e4b190d1a3d691a74>

Submitter: Robert Lyon (<email address hidden>)

Branch: 17.10\_STABLE

commit bc568169ba3fc7aae348fe8e4b190d1a3d691a74

Author: Robert Lyon <email address hidden>

Date: Thu Jan 18 10:43:37 2018 +1300

Security [Bug 1744789](/bugs/1744789): Remove bad code from wallpost post

We currently escape post content before submission

But we also need to do cleaning on php side incase hacker posts directly

Also needing to clean up annotations with bad html in their

descriptions and resume composite fields with bad html in their

descriptions

behatnotneeded

Change-Id: I8c7def1acad7b6692a96b2ba065c23abcd69cfb5

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit cff112250a5710b7a897e0f392a429cd29779ecc)

(cherry picked from commit 8a8b21e4014137680da34d00af76c608c3f8b222)

Reviewed: https://reviews.mahara.org/8785
Committed: https://git.mahara.org/mahara/mahara/commit/bc568169ba3fc7aae348fe8e4b190d1a3d691a74
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 17.10\_STABLE
commit bc568169ba3fc7aae348fe8e4b190d1a3d691a74
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Thu Jan 18 10:43:37 2018 +1300
Security Bug 1744789: Remove bad code from wallpost post
We currently escape post content before submission
But we also need to do cleaning on php side incase hacker posts directly
Also needing to clean up annotations with bad html in their
descriptions and resume composite fields with bad html in their
descriptions
behatnotneeded
Change-Id: I8c7def1acad7b6692a96b2ba065c23abcd69cfb5
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit cff112250a5710b7a897e0f392a429cd29779ecc)
(cherry picked from commit 8a8b21e4014137680da34d00af76c608c3f8b222)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2018-04-05: |  |  | [#9](/mahara/%2Bbug/1744789/comments/9) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/8786>

Committed: <https://git.mahara.org/mahara/mahara/commit/4037f9bf730cfb995b89db11fe93d83b06bf6fc8>

Submitter: Robert Lyon (<email address hidden>)

Branch: 17.04\_STABLE

commit 4037f9bf730cfb995b89db11fe93d83b06bf6fc8

Author: Robert Lyon <email address hidden>

Date: Thu Jan 18 10:43:37 2018 +1300

Security [Bug 1744789](/bugs/1744789): Remove bad code from wallpost post

We currently escape post content before submission

But we also need to do cleaning on php side incase hacker posts directly

Also needing to clean up annotations with bad html in their

descriptions and resume composite fields with bad html in their

descriptions

behatnotneeded

Change-Id: I8c7def1acad7b6692a96b2ba065c23abcd69cfb5

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit cff112250a5710b7a897e0f392a429cd29779ecc)

(cherry picked from commit 8a8b21e4014137680da34d00af76c608c3f8b222)

Reviewed: https://reviews.mahara.org/8786
Committed: https://git.mahara.org/mahara/mahara/commit/4037f9bf730cfb995b89db11fe93d83b06bf6fc8
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 17.04\_STABLE
commit 4037f9bf730cfb995b89db11fe93d83b06bf6fc8
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Thu Jan 18 10:43:37 2018 +1300
Security Bug 1744789: Remove bad code from wallpost post
We currently escape post content before submission
But we also need to do cleaning on php side incase hacker posts directly
Also needing to clean up annotations with bad html in their
descriptions and resume composite fields with bad html in their
descriptions
behatnotneeded
Change-Id: I8c7def1acad7b6692a96b2ba065c23abcd69cfb5
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit cff112250a5710b7a897e0f392a429cd29779ecc)
(cherry picked from commit 8a8b21e4014137680da34d00af76c608c3f8b222)

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2018-04-05

| **information type**: | Private Security → Public Security |
| --- | --- |

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2018-04-05

| **summary**: | - Avoid relying on TinyMCE code stipping alone+ Avoid relying on TinyMCE code stripping alone |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1744789/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1744789/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1744789/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1744789/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_9b952fc4_20250126_061446.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1744789/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Avoid relying on TinyMCE code stripping alone

Bug #1744789 reported by
[Robert Lyon](https://launchpad.net/~robertl-9)
on 2018-01-22

[256](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | High | [Robert Lyon](https://launchpad.net/~robertl-9) | [Mahara 18.04.0](https://launchpad.net/mahara/%2Bmilestone/18.04.0) |
|  | [16.10](https://bugs.launchpad.net/mahara/16.10) | Fix Released | High | Unassigned | [Mahara 16.10.9](https://launchpad.net/mahara/%2Bmilestone/16.10.9) |
|  | [17.04](https://bugs.launchpad.net/mahara/17.04) | Fix Released | High | Unassigned | [Mahara 17.04.7](https://launchpad.net/mahara/%2Bmilestone/17.04.7) |
|  | [17.10](https://bugs.launchpad.net/mahara/17.10) | Fix Released | High | Unassigned | [Mahara 17.10.4](https://launchpad.net/mahara/%2Bmilestone/17.10.4) |
|  | [18.04](https://bugs.launchpad.net/mahara/18.04) | Fix Released | High | [Robert Lyon](https://launchpad.net/~robertl-9) | [Mahara 18.04.0](https://launchpad.net/mahara/%2Bmilestone/18.04.0) |
|  | [18.10](https://bugs.launchpad.net/mahara/18.10) | Fix Released | High | Unassigned | [Mahara 18.10.0](https://launchpad.net/mahara/%2Bmilestone/18.10.0) |

### Bug Description

TinyMCE will strip bad strings from input, eg <script> tags but we must make sure we don't just rely on that alone. We should also clean up input on the server/php end as one can create their own packet of POST data containing bad content to hit the server with.

This can be seen in the Wall plugin where we can make a wallpost POST package have a bad 'text' value and have it save unaltered.

## CVE References

* [2018-6182](/bugs/cve/2018-6182 "Mahara 16.10 before 16.10.9 and 17.04...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9) wrote on 2018-01-22: |  |  | [#1](/mahara/%2Bbug/1744789/comments/1) |
| --- | --- | --- | --- |

Need to check all the places where the tinymce is used for a form field and make sure it is being saved in a safe way on the php side

Need to check all the places where the tinymce is used for a form field and make sure it is being saved in a safe way on the php side

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2018-01-23: |  |  | [#2](/mahara/%2Bbug/1744789/comments/2) |
| --- | --- | --- | --- |

Discoverer credit: 陈瑞琦 (Chen Ruiqi)

Discoverer credit: 陈瑞琦 (Chen Ruiqi)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2018-04-05:  [**A change has been merged**](/mahara/%2Bbug/1744789/comments/3) |  |  | [#3](/mahara/%2Bbug/1744789/comments/3) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/8784>

Committed: <https://git.mahara.org/mahara/mahara/commit/8a8b21e4014137680da34d00af76c608c3f8b222>

Submitter: Robert Lyon (<email address hidden>)

Branch: 18.04\_STABLE

commit 8a8b21e4014137680da34d00af76c608c3f8b222

Author: Robert Lyon <email address hidden>

Date: Thu Jan 18 10:43:37 2018 +1300

Security [Bug 1744789](/bugs/1744789): Remove bad code from wallpost post

We currently escape post content before submission

But we also need to do cleaning on php side incase hacker posts directly

Also needing to clean up annotations with bad html in their

descriptions and resume composite fields with bad html in their

descriptions

behatnotneeded

Change-Id: I8c7def1acad7b6692a96b2ba065c23abcd69cfb5

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit cff112250a5710b7a897e0f392a429cd29779ecc)

Reviewed: https://reviews.mahara.org/8784
Committed: https://git.mahara.org/mahara/mahara/commit/8a8b21e4014137680da34d00af76c608c3f8b222
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 18.04\_STABLE
commit 8a8b21e4014137680da34d00af76c608c3f8b222
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Thu Jan 18 10:43:37 2018 +1300
Security Bug 1744789: Remove bad code from wallpost post
We currently escape post content before submission
But we also need to do cleaning on php side incase hacker posts directly
Also needing to clean up annotations with bad html in their
descriptions and resume composite fields with bad html in their
descriptions
behatnotneeded
Change-Id: I8c7def1acad7b6692a96b2ba065c23abcd69cfb5
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit cff112250a5710b7a897e0f392a429cd29779ecc)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2018-04-05:  [**A patch has been submitted for review**](/mahara/%2Bbug/1744789/comments/4) |  |  | [#4](/mahara/%2Bbug/1744789/comments/4) |
| --- | --- | --- | --- |

Patch for "17.10\_STABLE" branch: <https://reviews.mahara.org/8785>

Patch for "17.10\_STABLE" branch: https://reviews.mahara.org/8785

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2018-04-05: |  |  | [#5](/mahara/%2Bbug/1744789/comments/5) |
| --- | --- | --- | --- |

Patch for "17.04\_STABLE" branch: <https://reviews.mahara.org/8786>

Patch for "17.04\_STABLE" branch: https://reviews.mahara.org/8786

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2018-04-05: |  |  | [#6](/mahara/%2Bbug/1744789/comments/6) |
| --- | --- | --- | --- |

Patch for "16.10\_STABLE" branch: <https://reviews.mahara.org/8787>

Patch for "16.10\_STABLE" branch: https://reviews.mahara.org/8787

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2018-04-05:  [**A change has been merged**](/mahara/%2Bbug/1744789/comments/7) |  |  | [#7](/mahara/%2Bbug/1744789/comments/7) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/8787>

Committed: <https://git.mahara.org/mahara/mahara/commit/b0bdbc78e23ae0b5905fa50c6faed5803fdba6f4>

Submitter: Robert Lyon (<email address hidden>)

Branch: 16.10\_STABLE

commit b0bdbc78e23ae0b5905fa50c6faed5803fdba6f4

Author: Robert Lyon <email address hidden>

Date: Thu Jan 18 10:43:37 2018 +1300

Security [Bug 1744789](/bugs/1744789): Remove bad code from wallpost post

We currently escape post content before submission

But we also need to do cleaning on php side incase hacker posts directly

Also needing to clean up annotations with bad html in their

descriptions and resume composite fields with bad html in their

descriptions

behatnotneeded

Change-Id: I8c7def1acad7b6692a96b2ba065c23abcd69cfb5

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit cff112250a5710b7a897e0f392a429cd29779ecc)

(cherry picked from commit 8a8b21e4014137680da34d00af76c608c3f8b222)

Reviewed: https://reviews.mahara.org/8787
Committed: https://git.mahara.org/mahara/mahara/commit/b0bdbc78e23ae0b5905fa50c6faed5803fdba6f4
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 16.10\_STABLE
commit b0bdbc78e23ae0b5905fa50c6faed5803fdba6f4
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Thu Jan 18 10:43:37 2018 +1300
Security Bug 1744789: Remove bad code from wallpost post
We currently escape post content before submission
But we also need to do cleaning on php side incase hacker posts directly
Also needing to clean up annotations with bad html in their
descriptions and resume composite fields with bad html in their
descriptions
behatnotneeded
Change-Id: I8c7def1acad7b6692a96b2ba065c23abcd69cfb5
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit cff112250a5710b7a897e0f392a429cd29779ecc)
(cherry picked from commit 8a8b21e4014137680da34d00af76c608c3f8b222)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2018-04-05: |  |  | [#8](/mahara/%2Bbug/1744789/comments/8) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/8785>

Committed: <https://git.mahara.org/mahara/mahara/commit/bc568169ba3fc7aae348fe8e4b190d1a3d691a74>

Submitter: Robert Lyon (<email address hidden>)

Branch: 17.10\_STABLE

commit bc568169ba3fc7aae348fe8e4b190d1a3d691a74

Author: Robert Lyon <email address hidden>

Date: Thu Jan 18 10:43:37 2018 +1300

Security [Bug 1744789](/bugs/1744789): Remove bad code from wallpost post

We currently escape post content before submission

But we also need to do cleaning on php side incase hacker posts directly

Also needing to clean up annotations with bad html in their

descriptions and resume composite fields with bad html in their

descriptions

behatnotneeded

Change-Id: I8c7def1acad7b6692a96b2ba065c23abcd69cfb5

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit cff112250a5710b7a897e0f392a429cd29779ecc)

(cherry picked from commit 8a8b21e4014137680da34d00af76c608c3f8b222)

Reviewed: https://reviews.mahara.org/8785
Committed: https://git.mahara.org/mahara/mahara/commit/bc568169ba3fc7aae348fe8e4b190d1a3d691a74
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 17.10\_STABLE
commit bc568169ba3fc7aae348fe8e4b190d1a3d691a74
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Thu Jan 18 10:43:37 2018 +1300
Security Bug 1744789: Remove bad code from wallpost post
We currently escape post content before submission
But we also need to do cleaning on php side incase hacker posts directly
Also needing to clean up annotations with bad html in their
descriptions and resume composite fields with bad html in their
descriptions
behatnotneeded
Change-Id: I8c7def1acad7b6692a96b2ba065c23abcd69cfb5
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit cff112250a5710b7a897e0f392a429cd29779ecc)
(cherry picked from commit 8a8b21e4014137680da34d00af76c608c3f8b222)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2018-04-05: |  |  | [#9](/mahara/%2Bbug/1744789/comments/9) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/8786>

Committed: <https://git.mahara.org/mahara/mahara/commit/4037f9bf730cfb995b89db11fe93d83b06bf6fc8>

Submitter: Robert Lyon (<email address hidden>)

Branch: 17.04\_STABLE

commit 4037f9bf730cfb995b89db11fe93d83b06bf6fc8

Author: Robert Lyon <email address hidden>

Date: Thu Jan 18 10:43:37 2018 +1300

Security [Bug 1744789](/bugs/1744789): Remove bad code from wallpost post

We currently escape post content before submission

But we also need to do cleaning on php side incase hacker posts directly

Also needing to clean up annotations with bad html in their

descriptions and resume composite fields with bad html in their

descriptions

behatnotneeded

Change-Id: I8c7def1acad7b6692a96b2ba065c23abcd69cfb5

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit cff112250a5710b7a897e0f392a429cd29779ecc)

(cherry picked from commit 8a8b21e4014137680da34d00af76c608c3f8b222)

Reviewed: https://reviews.mahara.org/8786
Committed: https://git.mahara.org/mahara/mahara/commit/4037f9bf730cfb995b89db11fe93d83b06bf6fc8
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 17.04\_STABLE
commit 4037f9bf730cfb995b89db11fe93d83b06bf6fc8
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Thu Jan 18 10:43:37 2018 +1300
Security Bug 1744789: Remove bad code from wallpost post
We currently escape post content before submission
But we also need to do cleaning on php side incase hacker posts directly
Also needing to clean up annotations with bad html in their
descriptions and resume composite fields with bad html in their
descriptions
behatnotneeded
Change-Id: I8c7def1acad7b6692a96b2ba065c23abcd69cfb5
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit cff112250a5710b7a897e0f392a429cd29779ecc)
(cherry picked from commit 8a8b21e4014137680da34d00af76c608c3f8b222)

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2018-04-05

| **information type**: | Private Security → Public Security |
| --- | --- |

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2018-04-05

| **summary**: | - Avoid relying on TinyMCE code stipping alone+ Avoid relying on TinyMCE code stripping alone |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1744789/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1744789/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1744789/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1744789/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))


