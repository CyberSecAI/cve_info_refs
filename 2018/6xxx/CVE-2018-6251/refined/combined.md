=== Content from www.talosintelligence.com_88532809_20250125_175440.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2018-0514

## Nvidia D3D10 Driver Pixel Shader Heap Memory Corruption Vulnerability

##### March 28, 2018

##### CVE Number

CVE-2018-6251

### Summary

An exploitable heap memory corruption vulnerability exists in the NVIDIA D3D10 Driver 22.21.13.8607. A specially crafted pixel shader can cause heap memory corruption, resulting in at least denial of service, and potential code execution. An attacker can provide a specially crafted shader file (either in binary or text form) to trigger this vulnerability. This vulnerability is present in the Nvidia Driver and can be triggered on a regular system as well as from a VMware guest, and the VMware host will be affected (potentially leading to VMware crash or guest-to-host escape)

### Tested Versions

NVIDIA nvwgf2umx.dll 22.21.13.8607 (x64) on Windows 10 x64
VMware Workstation 14 (14.0.0 build-6661328) with Windows 10 x64 as guestVM

### Product URLs

<http://nvidia.com>

### CVSSv3 Score

9.0 - CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H

### CWE

CWE-122: Heap-based Buffer Overflow

### Details

This vulnerability can be triggered by supplying a malformed pixel shader (in text or binary form) to the NVIDIA nvwgf2umx.dll driver. Such an attack can be triggered from a local machine (usermode), from a VMware guest usermode (to cause memory corruption on VMware host) or theoretically through WEBGL (remote website) — assuming the browser will not use ANGLE, and will somehow supply the malformed shader to the vulnerable NVIDIA driver.

A specifically crafted shader file causes the nvwgf2umx.dll driver to write data beyond the designated heap memory region. This happens in the following code:

```
.text:000000000018DA7F                 mov     r8d, ebx
.text:000000000018DA82                 lea     rcx, [rdi+28h]  ; rcx = 1st arg ->
.text:000000000018DA82                                         ; [rcx]   = heap buffer
.text:000000000018DA82                                         ; [rcx+8] = index
.text:000000000018DA86                 mov     edx, esi
.text:000000000018DA88                 call    preBUG_BUG
.text:000000000018DA88
.text:000000000018DA8D
...
.text:000000000025C780 preBUG_BUG
...
.text:000000000025C7A1                 mov     eax, [rbx+8]    ; [rbx+8] -> index
.text:000000000025C7A4                 xor     edx, edx
.text:000000000025C7A6                 imul    rcx, rax, 0B0h  ; rcx = rax * 0xB0
.text:000000000025C7AD                 mov     r8d, 0B0h
.text:000000000025C7B3                 add     rcx, [rbx]      ; rcx = dest heap memory region
.text:000000000025C7B3                                         ; calculated from heap_buffer + (index * 0xB0)
.text:000000000025C7B6                 call    corrupt_1        ;
.text:000000000025C7BB                 mov     eax, [rbx+8]    ; again
.text:000000000025C7BE                 imul    rcx, rax, 0B0h
.text:000000000025C7C5                 mov     rax, [rbx]
.text:000000000025C7C8                 mov     dword ptr [rcx+rax], 1  ; 2
...
.text:000000000025C83A                 inc     dword ptr [rbx+8] ; inc++
.text:000000000025C83D                 xor     eax, eax
.text:000000000025C83F
.text:000000000025C83F loc_25C83F:                             ; CODE XREF: preBUG_BUG+1B^j
.text:000000000025C83F                                         ; preBUG_BUG+B8^j
.text:000000000025C83F                 mov     rbx, [rsp+38h+arg_0]
.text:000000000025C844                 add     rsp, 30h
.text:000000000025C848                 pop     rdi
.text:000000000025C849                 retn
.text:000000000025C849 preBUG_BUG   endp

```

Note how the heap destination region is calculated (instructions at 0x025C7A6-0x25C7B3). As you can see, there is an index value that is increased every time the “preBUG\_BUG” function is called (instruction at 0x25C83A). This index is multiplied by 0xB0 (imul instruction) and added to the correct heap memory region address. This calculated memory address is used for further write operations.

An attacker can control the number of times this function (preBUG\_BUG) will be executed. This is achieved by the structure of the supplied shader itself. Therefore, when the index is high enough, a memory corruption will occur. The memory corruption itself is done through memset(dest, 0, 0xB0) inside a different function, and by single dword memory writes, like at 0x25C7C8. Whether such “limited” control for the attacker is enough to turn this bug into code execution is questionable, but cannot be excluded entirely.

```
...
before call preBUG_BUG @rcx(=rbx)=0x000001e7efe15fb8 [rcx]=0x000001e7f04321d0 [rcx+8]=0x000001e60000003f
after call preBUG_BUG
before call preBUG_BUG @rcx(=rbx)=0x000001e7efe15fb8 [rcx]=0x000001e7f04321d0 [rcx+8]=0x000001e600000040
after call preBUG_BUG
...
Critical error detected c0000374
(29a8.2cd0): Break instruction exception - code 80000003 (first chance)
ntdll!RtlReportCriticalFailure+0x56:
00007ff9`7b80878a cc              int     3
0:014> !heap -v -s
**************************************************************
*                                                            *
*                  HEAP ERROR DETECTED                       *
*                                                            *
**************************************************************

Details:

Heap address:  000001e606210000
Error address: 000001e7f0434dd0
Last known valid blocks: before - 000001e7f04321c0, after - 000001e7f0436040
Error type:    HEAP_FAILURE_BUFFER_OVERRUN
Details:       The heap manager detected an error whose features are
               consistent with a buffer overrun.
Follow-up:     Enable pageheap.

Stack trace:
                00007ff97b73eea8: ntdll!RtlpFreeHeap+0x00000000000011e8
                00007ff97b736a99: ntdll!RtlFreeHeap+0x0000000000000409
                00007ff93f63f950: nvwgf2umx!NVAPI_Thunk+0x000000000079e920
                00007ff93e8ac489: nvwgf2umx!OpenAdapter12+0x00000000002384f9
                00007ff93e684aef: nvwgf2umx!OpenAdapter12+0x0000000000010b5f
                00007ff93e684d91: nvwgf2umx!OpenAdapter12+0x0000000000010e01
                00007ff93e814091: nvwgf2umx!OpenAdapter12+0x00000000001a0101
                00007ff93f20cba0: nvwgf2umx!NVAPI_Thunk+0x000000000036bb70
                00007ff93f2080b7: nvwgf2umx!NVAPI_Thunk+0x0000000000367087
                00007ff97515ec93: D3D11!CPixelShader::CLS::FinalConstruct+0x0000000000000223
                00007ff9751667b8: D3D11!CLayeredObjectWithCLS<CPixelShader>::FinalConstruct+0x00000000000000c8
                00007ff975165ac5: D3D11!CLayeredObjectWithCLS<CPixelShader>::CreateInstance+0x000000000000016d
                00007ff9751328ac: D3D11!CDevice::CreateLayeredChild+0x0000000000001ffc
                00007ff97514fa78: D3D11!NDXGI::CDevice::CreateLayeredChild+0x0000000000000298
                00007ff97514bb3c: D3D11!NOutermost::CDevice::CreateLayeredChild+0x000000000000025c
                00007ff975135798: D3D11!CDevice::CreateAndRecreateLayeredChild<SD3D11LayeredPixelShaderCreationArgs>+0x000000000000006c

0:014> db 0x000001e7f04321d0+(0x40 * 0xB0)
000001e7`f0434dd0  01 00 00 00 81 00 00 00-82 00 00 00 00 00 00 00  ................
000001e7`f0434de0  00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00  ................
000001e7`f0434df0  00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00  ................
000001e7`f0434e00  00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00  ................
000001e7`f0434e10  00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00  ................
000001e7`f0434e20  00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00  ................
000001e7`f0434e30  00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00  ................
000001e7`f0434e40  00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00  ................

```
### Crash Information

```
(VMware workstation without gflags set)
0:014> !analyze -v
*******************************************************************************
*                                                                             *
*                        Exception Analysis                                   *
*                                                                             *
*******************************************************************************

*** ERROR: Module load completed but symbols could not be loaded for K:\tools\vmware\x64\vmware-vmx-debug.exe
GetUrlPageData2 (WinHttp) failed: 12002.

DUMP_CLASS: 2

DUMP_QUALIFIER: 0

FAULTING_IP:
ntdll!RtlReportCriticalFailure+56
00007ff9`7b80878a cc              int     3

EXCEPTION_RECORD:  (.exr -1)
ExceptionAddress: 00007ff97b80878a (ntdll!RtlReportCriticalFailure+0x0000000000000056)
   ExceptionCode: 80000003 (Break instruction exception)
  ExceptionFlags: 00000000
NumberParameters: 1
   Parameter[0]: 0000000000000000

FAULTING_THREAD:  00002cd0

BUGCHECK_STR:  BREAKPOINT

DEFAULT_BUCKET_ID:  BREAKPOINT

PROCESS_NAME:  vmware-vmx-debug.exe

ERROR_CODE: (NTSTATUS) 0x80000003 - {EXCEPTION}  Breakpoint  A breakpoint has been reached.

EXCEPTION_CODE: (HRESULT) 0x80000003 (2147483651) - One or more arguments are invalid

EXCEPTION_CODE_STR:  80000003

EXCEPTION_PARAMETER1:  0000000000000000

WATSON_BKT_PROCSTAMP:  59bfca5c

WATSON_BKT_PROCVER:  14.0.0.24051

PROCESS_VER_PRODUCT:  VMware Workstation

WATSON_BKT_MODULE:  ntdll.dll

WATSON_BKT_MODSTAMP:  6dead514

WATSON_BKT_MODOFFSET:  f878a

WATSON_BKT_MODVER:  10.0.16299.192

MODULE_VER_PRODUCT:  MicrosoftÆ WindowsÆ Operating System

BUILD_VERSION_STRING:  10.0.16299.15 (WinBuild.160101.0800)

MODLIST_WITH_TSCHKSUM_HASH:  d324a5816e027ccac6c968a73e12862c54588920

MODLIST_SHA1_HASH:  8ff41397b04bf015e5036dd1a59e7c32bdf3a3d2

NTGLOBALFLAG:  0

APPLICATION_VERIFIER_FLAGS:  0

PRODUCT_TYPE:  1

SUITE_MASK:  272

DUMP_TYPE:  fe

ANALYSIS_SESSION_HOST:  CLAB

ANALYSIS_SESSION_TIME:  01-11-2018 11:29:29.0242

ANALYSIS_VERSION: 10.0.16299.15 amd64fre

THREAD_ATTRIBUTES:
ADDITIONAL_DEBUG_TEXT:  Followup set based on attribute [Is_ChosenCrashFollowupThread] from Frame:[0] on thread:[PSEUDO_THREAD]

THREAD_SHA1_HASH_MOD_FUNC:  07047ca36effb8368d08f479e78df03e744877f5

THREAD_SHA1_HASH_MOD_FUNC_OFFSET:  532a8d6237e583dd4ba3779a968c9c330867fa53

OS_LOCALE:  ENU

PROBLEM_CLASSES:

    ID:     [0n309]
    Type:   [@APPLICATION_FAULT_STRING]
    Class:  Primary
    Scope:  DEFAULT_BUCKET_ID (Failure Bucket ID prefix)
            BUCKET_ID
    Name:   Omit
    Data:   Add
            String: [BREAKPOINT]
    PID:    [Unspecified]
    TID:    [Unspecified]
    Frame:  [0]

PRIMARY_PROBLEM_CLASS:  BREAKPOINT

LAST_CONTROL_TRANSFER:  from 00007ff97b80fd0a to 00007ff97b80878a

STACK_TEXT:
00000000`00000000 00000000`00000000 heap_corruption!vmware-vmx-debug.exe+0x0

THREAD_SHA1_HASH_MOD:  ca4e26064d24ef7512d2e94de5a93c38dbe82fe9

SYMBOL_STACK_INDEX:  0

SYMBOL_NAME:  heap_corruption!vmware-vmx-debug.exe

FOLLOWUP_NAME:  MachineOwner

MODULE_NAME: heap_corruption

IMAGE_NAME:  heap_corruption

DEBUG_FLR_IMAGE_TIMESTAMP:  0

STACK_COMMAND:  !heap ; ** Pseudo Context ** ManagedPseudo ** Value: 1f4ad34ea40 ** ; kb

BUCKET_ID:  BREAKPOINT_heap_corruption!vmware-vmx-debug.exe

FAILURE_EXCEPTION_CODE:  80000003

FAILURE_IMAGE_NAME:  heap_corruption

BUCKET_ID_IMAGE_STR:  heap_corruption

FAILURE_MODULE_NAME:  heap_corruption

BUCKET_ID_MODULE_STR:  heap_corruption

FAILURE_FUNCTION_NAME:  vmware-vmx-debug.exe

BUCKET_ID_FUNCTION_STR:  vmware-vmx-debug.exe

BUCKET_ID_OFFSET:  0

BUCKET_ID_MODTIMEDATESTAMP:  0

BUCKET_ID_MODCHECKSUM:  0

BUCKET_ID_MODVER_STR:  0.0.0.0

BUCKET_ID_PREFIX_STR:  BREAKPOINT_

FAILURE_PROBLEM_CLASS:  BREAKPOINT

FAILURE_SYMBOL_NAME:  heap_corruption!vmware-vmx-debug.exe

FAILURE_BUCKET_ID:  BREAKPOINT_80000003_heap_corruption!vmware-vmx-debug.exe

WATSON_STAGEONE_URL:  http://watson.microsoft.com/StageOne/vmware-vmx-
 debug.exe/14.0.0.24051/59bfca5c/ntdll.dll/10.0.16299.192/6dead514/80000003/000f878a.htm?Retriage=1

TARGET_TIME:  2018-01-11T10:29:34.000Z

OSBUILD:  16299

OSSERVICEPACK:  15

SERVICEPACK_NUMBER: 0

OS_REVISION: 0

OSPLATFORM_TYPE:  x64

OSNAME:  Windows 10

OSEDITION:  Windows 10 WinNt SingleUserTS

USER_LCID:  0

OSBUILD_TIMESTAMP:  1976-06-22 08:45:20

BUILDDATESTAMP_STR:  160101.0800

BUILDLAB_STR:  WinBuild

BUILDOSVER_STR:  10.0.16299.15

ANALYSIS_SESSION_ELAPSED_TIME:  65ea

ANALYSIS_SOURCE:  UM

FAILURE_ID_HASH_STRING:  um:breakpoint_80000003_heap_corruption!vmware-vmx-debug.exe

FAILURE_ID_HASH:  {40137b19-9790-906b-ba12-c68e4e0b8ab9}

Followup:     MachineOwner
---------

0:014> !heap -v -s
**************************************************************
*                                                            *
*                  HEAP ERROR DETECTED                       *
*                                                            *
**************************************************************

Details:

Heap address:  000001e606210000
Error address: 000001e7f0434dd0
Last known valid blocks: before - 000001e7f04321c0, after - 000001e7f0436040
Error type:    HEAP_FAILURE_BUFFER_OVERRUN
Details:       The heap manager detected an error whose features are
               consistent with a buffer overrun.
Follow-up:     Enable pageheap.

Stack trace:
                00007ff97b73eea8: ntdll!RtlpFreeHeap+0x00000000000011e8
                00007ff97b736a99: ntdll!RtlFreeHeap+0x0000000000000409
                00007ff93f63f950: nvwgf2umx!NVAPI_Thunk+0x000000000079e920
                00007ff93e8ac489: nvwgf2umx!OpenAdapter12+0x00000000002384f9
                00007ff93e684aef: nvwgf2umx!OpenAdapter12+0x0000000000010b5f
                00007ff93e684d91: nvwgf2umx!OpenAdapter12+0x0000000000010e01
                00007ff93e814091: nvwgf2umx!OpenAdapter12+0x00000000001a0101
                00007ff93f20cba0: nvwgf2umx!NVAPI_Thunk+0x000000000036bb70
                00007ff93f2080b7: nvwgf2umx!NVAPI_Thunk+0x0000000000367087
                00007ff97515ec93: D3D11!CPixelShader::CLS::FinalConstruct+0x0000000000000223
                00007ff9751667b8: D3D11!CLayeredObjectWithCLS<CPixelShader>::FinalConstruct+0x00000000000000c8
                00007ff975165ac5: D3D11!CLayeredObjectWithCLS<CPixelShader>::CreateInstance+0x000000000000016d
                00007ff9751328ac: D3D11!CDevice::CreateLayeredChild+0x0000000000001ffc
                00007ff97514fa78: D3D11!NDXGI::CDevice::CreateLayeredChild+0x0000000000000298
                00007ff97514bb3c: D3D11!NOutermost::CDevice::CreateLayeredChild+0x000000000000025c
                00007ff975135798: D3D11!CDevice::CreateAndRecreateLayeredChild<SD3D11LayeredPixelShaderCreationArgs>+0x000000000000006c

; standalone app with gflags set (non virtualized environment)

0:007> !analyze -v
*******************************************************************************
*                                                                             *
*                        Exception Analysis                                   *
*                                                                             *
*******************************************************************************

DUMP_CLASS: 2

DUMP_QUALIFIER: 0

FAULTING_IP:
nvwgf2umx!NVAPI_Thunk+77de79
00007ff9`3f61eea9 f3aa            rep stos byte ptr [rdi]

EXCEPTION_RECORD:  (.exr -1)
ExceptionAddress: 00007ff93f61eea9 (nvwgf2umx!NVAPI_Thunk+0x000000000077de79)
   ExceptionCode: c0000005 (Access violation)
  ExceptionFlags: 00000000
NumberParameters: 2
   Parameter[0]: 0000000000000001
   Parameter[1]: 0000028d7972f000
Attempt to write to address 0000028d7972f000

FAULTING_THREAD:  000027d4

PROCESS_NAME:  SampleDX10.exe

ERROR_CODE: (NTSTATUS) 0xc0000005 - The instruction at 0x%p referenced memory at 0x%p. The memory could not be %s.

EXCEPTION_CODE: (NTSTATUS) 0xc0000005 - The instruction at 0x%p referenced memory at 0x%p. The memory could not be %s.

EXCEPTION_CODE_STR:  c0000005

EXCEPTION_PARAMETER1:  0000000000000001

EXCEPTION_PARAMETER2:  0000028d7972f000

FOLLOWUP_IP:
nvwgf2umx!NVAPI_Thunk+77de79
00007ff9`3f61eea9 f3aa            rep stos byte ptr [rdi]

WRITE_ADDRESS:  0000028d7972f000

WATSON_BKT_PROCSTAMP:  5a560624

WATSON_BKT_MODULE:  nvwgf2umx.dll

WATSON_BKT_MODSTAMP:  5a395c58

WATSON_BKT_MODOFFSET:  fbeea9

WATSON_BKT_MODVER:  22.21.13.8607

MODULE_VER_PRODUCT:  NVIDIA D3D10 drivers

BUILD_VERSION_STRING:  10.0.16299.15 (WinBuild.160101.0800)

MODLIST_WITH_TSCHKSUM_HASH:  19374f54c72ce7f0180fd805008defc414e147af

MODLIST_SHA1_HASH:  6d5dcfe7f2d1a6b2f918e0d0fce4573bf4e39f70

NTGLOBALFLAG:  2000100

PROCESS_BAM_CURRENT_THROTTLED: 0

PROCESS_BAM_PREVIOUS_THROTTLED: 0

APPLICATION_VERIFIER_FLAGS:  81643027

PRODUCT_TYPE:  1

SUITE_MASK:  272

DUMP_TYPE:  fe

APPLICATION_VERIFIER_LOADED: 1

ANALYSIS_SESSION_HOST:  CLAB

ANALYSIS_SESSION_TIME:  01-11-2018 12:59:07.0024

ANALYSIS_VERSION: 10.0.16299.15 amd64fre

THREAD_ATTRIBUTES:
OS_LOCALE:  ENU

PROBLEM_CLASSES:

    ID:     [0n301]
    Type:   [@ACCESS_VIOLATION]
    Class:  Addendum
    Scope:  BUCKET_ID
    Name:   Omit
    Data:   Omit
    PID:    [Unspecified]
    TID:    [0x27d4]
    Frame:  [0] : nvwgf2umx!NVAPI_Thunk

    ID:     [0n274]
    Type:   [INVALID_POINTER_WRITE]
    Class:  Primary
    Scope:  DEFAULT_BUCKET_ID (Failure Bucket ID prefix)
            BUCKET_ID
    Name:   Add
    Data:   Omit
    PID:    [Unspecified]
    TID:    [0x27d4]
    Frame:  [0] : nvwgf2umx!NVAPI_Thunk

    ID:     [0n92]
    Type:   [AVRF]
    Class:  Addendum
    Scope:  DEFAULT_BUCKET_ID (Failure Bucket ID prefix)
            BUCKET_ID
    Name:   Add
    Data:   Omit
    PID:    [0x1b68]
    TID:    [0x27d4]
    Frame:  [0] : nvwgf2umx!NVAPI_Thunk

    ID:     [0n111]
    Type:   [EXPLOITABLE]
    Class:  Addendum
    Scope:  DEFAULT_BUCKET_ID (Failure Bucket ID prefix)
            BUCKET_ID
    Name:   Add
    Data:   Omit
    PID:    [0x1b68]
    TID:    [0x27d4]
    Frame:  [0] : nvwgf2umx!NVAPI_Thunk

BUGCHECK_STR:  APPLICATION_FAULT_INVALID_POINTER_WRITE_EXPLOITABLE_AVRF

DEFAULT_BUCKET_ID:  INVALID_POINTER_WRITE_EXPLOITABLE_AVRF

PRIMARY_PROBLEM_CLASS:  APPLICATION_FAULT

LAST_CONTROL_TRANSFER:  from 00007ff93e8ac7bb to 00007ff93f61eea9

STACK_TEXT:
00000090`37b9f1f8 00007ff9`3e8ac7bb : 00000000`00000000 00000000`00000000 7fffffff`ffffffff 00000000`00000001 :
 nvwgf2umx!NVAPI_Thunk+0x77de79
00000090`37b9f200 00007ff9`3e7dda8d : 00000000`00050000 00000000`00000000 00000000`00050000 0000028d`796ea640 :
 nvwgf2umx!OpenAdapter12+0x23882b
00000090`37b9f240 00007ff9`3e7d1fe7 : 0000028d`796ea640 00000000`00000000 00000000`00000000 0000028d`796ea640 :
 nvwgf2umx!OpenAdapter12+0x169afd
00000090`37b9f3a0 00007ff9`3e7d1194 : 00000000`00000065 00000000`00000036 00000090`37b9f8b0 0000028d`796e55a0 :
 nvwgf2umx!OpenAdapter12+0x15e057
00000090`37b9f830 00007ff9`3e6848e3 : 0000028d`79714bc0 00000090`37b9fa38 00000000`00000000 00000000`00000000 :
 nvwgf2umx!OpenAdapter12+0x15d204
00000090`37b9f8f0 00007ff9`3e684d91 : 00000000`00000000 00007ff9`77ec3a80 00000000`000000bc 00007ff9`77ec3b2f :
 nvwgf2umx!OpenAdapter12+0x10953
00000090`37b9f9d0 00007ff9`3e8b7996 : 0000028d`76939900 00007ff9`62cc7499 00000000`00000000 0000028d`796d6cc0 :
 nvwgf2umx!OpenAdapter12+0x10e01
00000090`37b9fac0 00007ff9`3e9208ff : 0000028d`796e8fc0 00000000`00000001 00000000`00000000 0000028d`78ce6b90 :
 nvwgf2umx!OpenAdapter12+0x243a06
00000090`37b9fb70 00007ff9`3e92083f : 0000028d`78ce6d28 00000000`00000000 00000000`00000000 00000000`00000000 :
 nvwgf2umx!OpenAdapter12+0x2ac96f
00000090`37b9fbb0 00007ff9`3f636821 : 0000028d`79486fd0 0000028d`79486fd0 00000000`00000000 00000000`00000000 :
 nvwgf2umx!OpenAdapter12+0x2ac8af
00000090`37b9fbe0 00007ff9`62cced34 : 0000028d`6e3e1fc0 00000000`00000000 00000000`00000000 00000000`00000000 :
 nvwgf2umx!NVAPI_Thunk+0x7957f1
00000090`37b9fc10 00007ff9`7ac31fe4 : 00000000`00000000 00000000`00000000 00000000`00000000 00000000`00000000 :
 vfbasics!AVrfpStandardThreadFunction+0x44
00000090`37b9fc50 00007ff9`7b77efb1 : 00000000`00000000 00000000`00000000 00000000`00000000 00000000`00000000 :
 KERNEL32!BaseThreadInitThunk+0x14
00000090`37b9fc80 00000000`00000000 : 00000000`00000000 00000000`00000000 00000000`00000000 00000000`00000000 :
 ntdll!RtlUserThreadStart+0x21

STACK_COMMAND:  ~7s ; .cxr ; kb

THREAD_SHA1_HASH_MOD_FUNC:  d4a848f7cf8f28c393c8f892ffc126f817f50c8b

THREAD_SHA1_HASH_MOD_FUNC_OFFSET:  9909c28e91814d594e2f6129cc353a48da500291

THREAD_SHA1_HASH_MOD:  17e0877601acb0b895b4661be06fea469326e60b

FAULT_INSTR_CODE:  8b48aaf3

SYMBOL_STACK_INDEX:  0

SYMBOL_NAME:  nvwgf2umx!NVAPI_Thunk+77de79

FOLLOWUP_NAME:  MachineOwner

MODULE_NAME: nvwgf2umx

IMAGE_NAME:  nvwgf2umx.dll

DEBUG_FLR_IMAGE_TIMESTAMP:  5a395c58

FAILURE_BUCKET_ID:  INVALID_POINTER_WRITE_EXPLOITABLE_AVRF_c0000005_nvwgf2umx.dll!NVAPI_Thunk

BUCKET_ID:  APPLICATION_FAULT_INVALID_POINTER_WRITE_EXPLOITABLE_AVRF_nvwgf2umx!NVAPI_Thunk+77de79

FAILURE_EXCEPTION_CODE:  c0000005

FAILURE_IMAGE_NAME:  nvwgf2umx.dll

BUCKET_ID_IMAGE_STR:  nvwgf2umx.dll

FAILURE_MODULE_NAME:  nvwgf2umx

BUCKET_ID_MODULE_STR:  nvwgf2umx

FAILURE_FUNCTION_NAME:  NVAPI_Thunk

BUCKET_ID_FUNCTION_STR:  NVAPI_Thunk

BUCKET_ID_OFFSET:  77de79

BUCKET_ID_MODPRIVATE: 1

BUCKET_ID_MODTIMEDATESTAMP:  5a395c58

BUCKET_ID_MODCHECKSUM:  1934a09

BUCKET_ID_MODVER_STR:  22.21.13.8607

BUCKET_ID_PREFIX_STR:  APPLICATION_FAULT_INVALID_POINTER_WRITE_EXPLOITABLE_AVRF_

FAILURE_PROBLEM_CLASS:  APPLICATION_FAULT

FAILURE_SYMBOL_NAME:  nvwgf2umx.dll!NVAPI_Thunk

TARGET_TIME:  2018-01-11T11:59:08.000Z

OSBUILD:  16299

OSSERVICEPACK:  15

SERVICEPACK_NUMBER: 0

OS_REVISION: 0

OSPLATFORM_TYPE:  x64

OSNAME:  Windows 10

OSEDITION:  Windows 10 WinNt SingleUserTS

USER_LCID:  0

OSBUILD_TIMESTAMP:  1976-06-22 08:45:20

BUILDDATESTAMP_STR:  160101.0800

BUILDLAB_STR:  WinBuild

BUILDOSVER_STR:  10.0.16299.15

ANALYSIS_SESSION_ELAPSED_TIME:  658

ANALYSIS_SOURCE:  UM

FAILURE_ID_HASH_STRING:  um:invalid_pointer_write_exploitable_avrf_c0000005_nvwgf2umx.dll!nvapi_thunk

FAILURE_ID_HASH:  {b2ac358b-d8f3-ac8e-1c53-e0f6a04b51c7}

Followup:     MachineOwner
---------

0:007> !exploitable

!exploitable 1.6.0.0
Exploitability Classification: EXPLOITABLE
Recommended Bug Title: Exploitable - User Mode Write AV starting at nvwgf2umx!NVAPI_Thunk+0x000000000077de79
(Hash=0x982d6a78.0x949f2650)

```
### Timeline

2018-01-22 - Vendor Disclosure

2018-03-28 - Public Release

##### Credit

Discovered by Piotr Bania of Cisco Talos

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2018-0522](/vulnerability_reports/TALOS-2018-0522) [Previous Report

TALOS-2017-0376](/vulnerability_reports/TALOS-2017-0376)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from nvidia.custhelp.com_8cc14e2d_20250125_175439.html ===

[Skip Navigation](#rn_MainContent)
Your browser either does not have JavaScript enabled or does not appear to support enough features of JavaScript to be used well on this site.

## NVIDIA SUPPORT

[NVIDIA Home](http://www.nvidia.com/page/home.html) > [Support Home Page](http://www.nvidia.com/page/support.html) > [Knowledgebase Home Page](/app/home/) >  Security Bulletin: NVIDIA GPU Display Driver Security Updates for Multiple Vulnerabilities

[Log In](https://login.nvidia.com/authorize?response_type=code&client_id=qtGdYjahOV9NjYJ6iTPXfYDu_Z20k-ualaLp5b2vNVg&redirect_uri=https%3A%2F%2Fnvidia.custhelp.com%2Fapp%2Futils%2Fstarfleet_login&scope=openid+profile+email&state=%2Fapp%2Fanswers%2Fdetail%2Fa_id%2F4649) | [Sign Up](https://login.nvidia.com/authorize?response_type=code&client_id=qtGdYjahOV9NjYJ6iTPXfYDu_Z20k-ualaLp5b2vNVg&redirect_uri=https%3A%2F%2Fnvidia.custhelp.com%2Fapp%2Futils%2Fstarfleet_login&scope=openid+profile+email&state=%2Fapp%2Fanswers%2Fdetail%2Fa_id%2F4649)

# Security Bulletin: NVIDIA GPU Display Driver Security Updates for Multiple Vulnerabilities

Updated 09/29/2021 01:08 PM

## NVIDIA GPU display driver vulnerabilities may lead to code execution, denial of service, information disclosure, or escalation of privileges.

## Go to [NVIDIA Product Security](http://www.nvidia.com/product-security/).

---

### Vulnerability Details

This section summarizes the potential vulnerabilities. Descriptions use [CWE™](https://cwe.mitre.org/) and risk assessments follow [CVSS](https://www.first.org/cvss/user-guide).

#### CVE-2018-6247

NVIDIA Windows GPU Display Driver contains a vulnerability in the kernel mode layer (nvlddmkm.sys) handler for DxgkDdiEscape where a NULL pointer dereference may lead to denial of service or possible escalation of privileges.

CVSS Base Score: 8.8
CVSS Temporal Score: 7.9
CVSS Vector: CVSS:3.0/[AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C)

#### CVE-2018-6248

NVIDIA Windows GPU Display Driver contains a vulnerability in the kernel mode layer handler for DxgkDdiEscape where the software uses a sequential operation to read or write a buffer, but it uses an incorrect length value that causes it to access memory that is outside of the bounds of the buffer which may lead to denial of service or possible escalation of privileges.

CVSS Base Score: 8.8
CVSS Temporal Score: 7.9
CVSS Vector: CVSS:3.0/[AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C)

#### CVE-2018-6249

NVIDIA GPU Display Driver contains a vulnerability in kernel mode layer handler where a NULL pointer dereference may lead to denial of service or potential escalation of privileges.

CVSS Base Score: 8.8
CVSS Temporal Score: 7.9
CVSS Vector: CVSS:3.0/[AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C)

#### CVE-2018-6250

NVIDIA Windows GPU Display Driver contains a vulnerability in the kernel mode layer (nvlddmkm.sys) handler for DxgkDdiEscape where a NULL pointer dereference occurs, which may lead to denial of service or possible escalation of privileges.

CVSS Base Score: 8.2
CVSS Temporal Score: 7.1
CVSS Vector: CVSS:3.0/[AV:L/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:L/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H/E:U/RL:O/RC:C)

#### CVE-2018-6251

NVIDIA Windows GPU Display Driver contains a vulnerability in the DirectX 10 Usermode driver, where a specially crafted pixel shader can cause writing to unallocated memory, leading to denial of service or potential code execution.

CVSS Base Score: 7.0
CVSS Temporal Score: 6.3
CVSS Vector: CVSS:3.0/[AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C)

#### CVE-2018-6252

NVIDIA Windows GPU Display Driver contains a vulnerability in the kernel mode layer handler for DxgkDdiEscape where the software allows an actor access to restricted functionality that is unnecessary for production usage, and which may result in denial of service.

CVSS Base Score: 6.5
CVSS Temporal Score: 5.9
CVSS Vector: CVSS:3.0/[AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H/E:P/RL:O/RC:C](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H/E:P/RL:O/RC:C)

#### CVE-2018-6253

NVIDIA GPU Display Driver contains a vulnerability in the DirectX and OpenGL Usermode drivers where a specially crafted pixel shader can cause infinite recursion leading to denial of service.

CVSS Base Score: 5.5
CVSS Temporal Score: 5.0
CVSS Vector: CVSS:3.0/[AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C)

*NVIDIA’s risk assessment is based on an average of risk across a diverse set of installed systems and may not represent the true risk of your local installation. NVIDIA recommends consulting a security or IT professional to evaluate the risk to your specific configuration. NVIDIA doesn’t know of any exploits of these issues at this time.*

### Affected Software

The following software is impacted by the issues described in this bulletin.

Affected Software
| **CVEs** | **Software Products** | **Operating Systems** |
| --- | --- | --- |
| CVE-2018-6247 CVE-2018-6248 CVE-2018-6249 CVE-2018-6250 CVE-2018-6251 CVE-2018-6252 | GeForce Quadro NVS Tesla | Windows |
| CVE-2018-6249 CVE-2018-6253 | GeForce Quadro NVS Tesla | Windows Linux FreeBSD Solaris |

**Notes:**

* For available security updates, see [Software Security Updates](#software-security-updates).
* The table may not be a comprehensive list of all impacted software versions or driver branches and may be updated as more information becomes available. For the latest information, check for updates to this bulletin or go to [NVIDIA Product Security](https://www.nvidia.com/en-us/product-security/) to subscribe to security bulletin notifications.
* Support may have expired for certain software versions or driver branches. Check the [Windows legacy GPU releases](http://nvidia.custhelp.com/app/answers/detail/a_id/3473) and [UNIX legacy GPU releases](http://nvidia.custhelp.com/app/answers/detail/a_id/3142) or contact [NVIDIA Support](http://www.nvidia.com/object/support.html) with any questions.

### Software Security Updates

The following supported software versions contain the security updates for the issues described in this bulletin. If you are using an unsupported software version or an earlier driver branch that is no longer supported, upgrade to one of the updated supported versions listed.

#### Windows

Windows
| **Product** | **Product Series** | **OS** | **Driver Branch** | **Updated Versions** |
| --- | --- | --- | --- | --- |
| GeForce | All | Windows | R390 | 391.35 including HD Audio 1.3.36.6 |
| Quadro, NVS | All | Windows | R390 | 391.33 including HD Audio 1.3.36.6 |
| R384 | 386.28 including HD Audio 1.3.36.6 |
| Tesla | All | Windows | R390 | 391.29 including HD Audio 1.3.36.6 |
| R384 | 386.28 including HD Audio 1.3.36.6 |

#### Linux

Linux
| **Product** | **Product Series** | **OS** | **Driver Branch** | **Updated Versions** |
| --- | --- | --- | --- | --- |
| GeForce | All | Linux, FreeBSD, Solaris | R390 | 390.48 |
| --- | --- | --- | --- | --- |
| R384 | 384.130 |
| Quadro, NVS | All | Linux, FreeBSD, Solaris | R390 | 390.48 |
| R384 | 384.130 |
| Tesla | All | Linux | R390 | 390.46 |
| R384 | 384.125 |

#### Notes

* Download GPU fixes from the [NVIDIA Driver Downloads](http://www.nvidia.com/Download/index.aspx) page.
* If you are an Enterprise Services customer using DGX-1 or DGX Station, visit the [NVIDIA Support Enterprise Services](https://nvid.nvidia.com/enterpriselogin) portal for guidance.
* Your computer hardware vendor may provide you with security updates in a driver version not listed in the tables above. If so, check the vendor's security bulletin to determine which driver versions from the vendor contain the security updates.

### Mitigations

None.

### Acknowledgements

CVE-2018-6251: NVIDIA thanks Piotr Bania of Cisco Talos for reporting this issue to NVIDIA PSIRT.

CVE-2018-6253: NVIDIA thanks the member of Cisco Talos for reporting this issue to NVIDIA PSIRT.

### Get the Most Up to Date Product Security Information

To learn more about the vulnerability management process followed by the NVIDIA Product Security Incident Response Team (PSIRT), see the current list of NVIDIA security bulletins, or subscribe to security bulletin notifications, go to [NVIDIA Product Security](http://www.nvidia.com/product-security/).

### **Revision History**

| **Revision** | **Date** | **Description** |
| --- | --- | --- |
| 2.2 | April 26, 2018 | Further clarified the note about driver versions not listed in this bulletin provided by hardware vendors |
| 2.1 | April 24, 2018 | Clarified the note about driver versions not listed in this bulletin provided by hardware vendors |
| 2.0 | April 16, 2018 | Added a note about driver versions not listed in this bulletin provided by hardware vendors |
| 1.0 | March 28, 2018 | Initial release |

### Frequently Asked Questions (FAQs)

#### How do I know what driver version I have installed?

1. Launch Windows Device Manager.
2. Select **Display Adapters**.
3. Select the **NVIDIA GPU** node and right-click.
4. Go to the **Driver** tab.

The driver version can be deciphered as shown in the following examples: 10.18.13.6472 is 364.72 and 10.18.13.472 is 304.72

##### Disclaimer

ALL NVIDIA INFORMATION, DESIGN SPECIFICATIONS, REFERENCE BOARDS, FILES, DRAWINGS, DIAGNOSTICS, LISTS, AND OTHER DOCUMENTS (TOGETHER AND SEPARATELY, “MATERIALS”) ARE BEING PROVIDED “AS IS.” NVIDIA MAKES NO WARRANTIES, EXPRESS, IMPLIED, STATUTORY, OR OTHERWISE WITH RESPECT TO THE MATERIALS, AND ALL EXPRESS OR IMPLIED CONDITIONS, REPRESENTATIONS AND WARRANTIES, INCLUDING ANY IMPLIED WARRANTY OR CONDITION OF TITLE, MERCHANTABILITY, SATISFACTORY QUALITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT, ARE HEREBY EXCLUDED TO THE MAXIMUM EXTENT PERMITTED BY LAW.

Information furnished is believed to be accurate and reliable. However, NVIDIA Corporation assumes no responsibility for the consequences of use of such information or for any infringement of patents or other rights of third parties that may result from its use. No license is granted by implication or otherwise under any patent or patent rights of NVIDIA Corporation. Specifications mentioned in this publication are subject to change without notice. This publication supersedes and replaces all information previously supplied. NVIDIA Corporation products are not authorized for use as critical components in life support devices or systems without express written approval of NVIDIA Corporation.

## Is this answer helpful?

Yes
No

## Answers others found helpful

* [Security Bulletin: NVIDIA SHIELD TV Security Updates for Multiple Vulnerabilities](/app/answers/detail/a_id/4631/related/1)
* [Security Bulletin: NVIDIA GPU Display driver contains multiple vulnerabilities in the kernel mode layer handler](/app/answers/detail/a_id/4462/related/1)
* [Security Bulletin: Multiple vulnerabilities in the NVIDIA Windows GPU Display Driver kernel mode layer (nvlddmkm.sys) handler for DxgkDdiEscape and a vulnerability in the Linux GPU Display Driver kernel mode layer (nvidia.ko)](/app/answers/detail/a_id/4278/related/1)
* [Security Notice: CPU Speculative Side Channel Vulnerabilities](/app/answers/detail/a_id/4609/related/1)
* [Security Bulletin: NVIDIA Driver Security Updates for CPU Speculative Side Channel Vulnerabilities](/app/answers/detail/a_id/4611/related/1)

## Previously viewed answers

* [Security Bulletin: NVIDIA Jetson TX1 and TX2 L4T...](/app/answers/detail/a_id/4787)
* [Security Bulletin: NVIDIA Jetson TX1, Jetson TK1...](/app/answers/detail/a_id/4635)
* [Security Bulletin: NVIDIA Tegra Jetson L4T...](/app/answers/detail/a_id/4561)
* [Security Bulletin: Multiple vulnerabilities in...](/app/answers/detail/a_id/4278)
* [Security Bulletin: NVIDIA SHIELD TV Security...](/app/answers/detail/a_id/4631)

### Live Chat

#### Chat online with one of our support agents

[CHAT NOW](/app/chat/chat_launch/)

### ASK US A QUESTION

#### Contact Support for assistance

#### 800.797.6530

[Ask a Question](/app/ask)


