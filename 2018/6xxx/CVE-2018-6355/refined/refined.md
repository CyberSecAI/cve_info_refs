- **Root cause of vulnerability:** The iBall 300M router's firmware does not properly sanitize the `lang` parameter in the `/goform/setLang` endpoint, allowing an attacker to inject malicious JavaScript code.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS).
- **Impact of exploitation:** Successful exploitation allows an attacker to execute arbitrary JavaScript code in the context of the router's web interface. This could lead to:
    - Code execution (e.g., modifying router settings, redirecting traffic).
    - Denial of Service (DoS) (e.g., by disrupting the router's web interface).
    - Information Disclosure (e.g., stealing admin credentials, accessing sensitive information).
- **Attack vectors:** An unauthenticated attacker sends a POST request to `/goform/setLang` with a malicious JavaScript payload in the `lang` parameter (e.g., `lang=en";</script><script>alert(document.domain);</script>`). This payload is then stored by the router, and executed when an administrator visits the router's web interface (e.g., 192.168.1.1).
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP POST requests to the router, no authentication is required. The attacker does not need to be on the same local network as the router to inject the script, but an admin needs to access the web interface for the injected code to execute.