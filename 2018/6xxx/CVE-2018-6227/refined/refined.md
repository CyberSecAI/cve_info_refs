The provided content relates to CVE-2018-6227.

**Root cause of vulnerability:**
The vulnerability stems from a lack of sanitization of the `hidEmails` parameter in the `editPolicy.jsp` script, allowing for the injection of malicious JavaScript code.

**Weaknesses/vulnerabilities present:**
- Stored Cross-Site Scripting (XSS) vulnerability (CWE-79)

**Impact of exploitation:**
An attacker can inject arbitrary JavaScript code into the `hidEmails` parameter. This code is then stored unescaped and rendered every time the `policies.do` script is executed. This could lead to various attacks, including session hijacking, defacement of the web interface, or the execution of malicious code on the browsers of other users who access the policies page.

**Attack vectors:**
- The attack vector is through the web interface of the Trend Micro Email Encryption Gateway.
- An attacker sends a crafted POST request to `/editPolicy.jsp` with a malicious script in the `hidEmails` parameter.

**Required attacker capabilities/position:**
- The attacker needs to be able to send HTTP requests to the affected web interface.
- The attacker needs to have an account with access to the policy management page.