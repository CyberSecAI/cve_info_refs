```
{
  "vulnerability": {
    "cve_id": "CVE-2018-6882",
    "description": "A Cross-Site Scripting (XSS) vulnerability was found in Zimbra Collaboration Suite (ZCS). This issue allows an attacker to perform a wide variety of actions such as performing arbitrary actions on their behalf or presenting a fake login screen to collect usernames and passwords. In order to exploit this issue, the attacker has to lure a victim into opening a specially crafted email in ZCS.",
    "affected_product": "Zimbra Collaboration Suite (ZCS)",
    "versions": "Likely present in all versions of ZCS from 8.5.0 until 8.8.7 where the fix was introduced.",
    "root_cause": "The vulnerability stems from the lack of sanitization of the `Content-Location` header when generating attachment links in the `ZmMailMsgView.getAttachmentLinkHtml` function.",
    "weaknesses": [
      "Cross-Site Scripting (XSS)",
        "Improper Input Sanitization"
    ],
    "impact": "An attacker can execute arbitrary JavaScript code within the context of a victim's Zimbra session. This allows the attacker to perform actions on behalf of the user, including stealing cookies, redirecting to malicious pages, displaying phishing content, or performing arbitrary actions using the user's privileges.",
    "attack_vector": "The attack vector is through a specially crafted email message. The attacker includes a malicious `Content-Location` header in an email that is sent to a victim using the Zimbra email client. When the victim opens the email in ZCS, the malicious script within the attachment link is executed.",
     "required_capabilities": "The attacker needs to be able to send emails to a victim user. The user needs to open the email in ZCS to trigger the XSS vulnerability.",
      "additional_details": "The `Content-Location` header value is directly inserted into an `<a>` tag's `href` attribute without any sanitization, enabling the injection of arbitrary HTML and JavaScript.",
     "fix": "The issue is fixed in Zimbra Collaboration Suite version 8.8.7. Additionally, the default value for `zimbraPrefShortEmailAddress` was set to `FALSE` to mitigate related spoofing issues."
  }
}
```