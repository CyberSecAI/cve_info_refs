=== Content from simplesamlphp.org_08d13051_20250124_115244.html ===


[Simple
SAML
php](https://simplesamlphp.org)

[Home](https://simplesamlphp.org) Â» SSPSA 201801-03: Use of insecure connection charset (sqlauth module)

[Download](/download)

[Documentation](/docs)

[Security](/security)

[Modules](/modules/)

[Support](/support/)

[Contribute](/contrib/)

## Date

January 30, 2018
## Affected versions

`SimpleSAMLphp < 1.15.2`
## Severity

Low
## Reference

CVE-2018-6521
# 201801-03

**Use of insecure connection charset (sqlauth module)**

### Background

The *sqlauth* module provides an authentication source (`sqlauth:SQL`) that allows authenticating users against a
database holding their credentials. This module supports any database backend supported by PDO, including MySQL, and
the use of unicode code points is allowed both for usernames and passwords.

Regarding unicode support, MySQL has long supported the `utf8` charset for database, table and column names, as well as
for actual contents and connections. This charset, though, only partially implements UTF-8 encoding, despite its
name.

### Description

The `utf8` connection charset is used by the `sqlauth:SQL` authentication source in the *sqlauth* module. Due to the
lack of proper support for UTF-8 encoding provided by this charset, encoded symbols that take up four bytes instead of
three or less arenâ€™t supported. This issue, together with the fact that MySQL truncates a query when an unsupported
character is found (in this case, any unicode code point represented with four bytes), could lead to serious security
issues such as authentication bypass, unauthorized database manipulation or stored Cross-Site Scripting attacks.

Two mitigating factors concur in this case, making the issue not exploitable to the best of our knowledge:

* The module uses prepared statements to avoid SQL injections. This is an effective countermeasure to avoid SQL query
  truncation on unsupported characters.
* The issue is typically exploited with *insert* or *update* statements. That would allow an attacker to alter the
  HTML output produced by a page and execute arbitrary code on the victimâ€™s browser (stored XSS). This module uses
  *select* statements, effectively removing the possibility to store arbitrary code to be executed.

In order to avoid any possible future issues, the connection charset has been changed from `utf8` to `utf8mb4` when
using a MySQL backend, which implements full unicode support.

### Affected versions

All SimpleSAMLphp versions up to (and including) **1.15.1**.

### Impact

At of the moment of this writing, **there is no known way to exploit the issue** described in this advisory.

However, the issue could be leveraged by an attacker in combination with other unknown issues in order to:

* bypass authentication.
* access and modify the contents of the userâ€™s credentials database.
* perform stored Cross-Site Scripting attacks, running arbitrary code in the victimâ€™s web browser.

### Resolution

Upgrade to the [latest version](/download).

### Credit

This security issue was discovered during a security audit performed by Cure53 and reported on December 18, 2017.

![](/res/ssplogo-fish-2.svg)



=== Content from lists.debian.org_42fec56e_20250124_115243.html ===


---

[[Date Prev](msg00007.html)][[Date Next](msg00009.html)]
[[Thread Prev](msg00007.html)][[Thread Next](msg00009.html)]
[[Date Index](maillist.html#00008)]
[[Thread Index](threads.html#00008)]

# [SECURITY] [DLA 1273-1] simplesamlphp security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1273-1] simplesamlphp security update
* *From*: Abhijith PA <abhijith@disroot.org>
* *Date*: Fri, 9 Feb 2018 08:41:36 +0530
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/5c57f98b-005e-6b34-f539-7b06f4698b18%40disroot.org)Â [5c57f98b-005e-6b34-f539-7b06f4698b18@disroot.org](msg00008.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Package        : simplesamlphp
Version        : 1.9.2-1+deb7u2
CVE ID         : CVE-2017-18121 CVE-2017-18122 CVE-2018-6521
Debian Bug     : 889286

simplesamlphp, an authentication and federation application has been
found vulnerable to Cross Site Scripting (XSS), signature validation
byepass and using insecure connection charset.

CVE-2017-18121

    A Cross Site Scripting (XSS) issue has been found in the
    consentAdmin module of SimpleSAMLphp through 1.14.15, allowing an
    attacker to manually craft links that a victim can open, executing
    arbitrary javascript code.

CVE-2017-18122

    A signature-validation bypass issue was discovered in SimpleSAMLphp
    through 1.14.16. Service Provider using SAML 1.1 will regard as
    valid any unsigned SAML response containing more than one signed
    assertion, provided that the signature of at least one of the
    assertions is valid. Attributes contained in all the assertions
    received will be merged and the entityID of the first assertion
    received will be used, allowing an attacker to impersonate any user
    of any IdP given an assertion signed by the targeted IdP.

CVE-2018-6521

    The sqlauth module in SimpleSAMLphp before 1.15.2 relies on the
    MySQL utf8 charset, which truncates queries upon encountering
    four-byte characters. There might be a scenario in which this allows
    remote attackers to bypass intended access restrictions.

For Debian 7 "Wheezy", these problems have been fixed in version
1.9.2-1+deb7u2.

We recommend that you upgrade your simplesamlphp packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE7xPqJqaY/zX9fJAuhj1N8u2cKO8FAlp9EV8ACgkQhj1N8u2c
KO/K4hAAlIP/4Ps1uZHL5Y2rzG49Kjp/zc8MJfq5oLYvOwDS9vIL2T2IgMJyBupy
ZSLtgFk7IHQBM8D7E9CZXp7jI9RVzvAgdEwCN2F9Of/AdcvUOqY9Cwxeb46+ucol
sHielH22DJyzXJQUfydc1XV8znk33hK5Ooi8Vd06d5fd+HJ32/h4TbY4OqyIu+ux
Lxz+jqYks3hbhqwWa6opuekiZLRxBX0/QE6DCpfFRsgXDI0sl3btSRLPfC6EO2do
CUq8tCafL3NxhRjRaJ4+KPtwlarME41joA4hLX3JT+TNvmTA/Mr1LR1Pm+2CtiSm
qttXM0bljJHMGMp9BRt9apz0bqcOfka9npRmfvMXQRbEMlKKIGjf+HFtXWCU1tNo
2llodH037vC1u/fRah7+O4GQryWIJGdV3McdtsOTSx26IhSRXbP9cnEGZUfNTh7F
GS8jC3z9ueEAe6cGlTjeYcZPxKPbJ3pYWyA7Ud+5n0SmuJeFcoFyijR2Gf76nitu
54flMWf618K2Cur3ejLwnXmYq1Bhge+aHN0ej6Kq9T0YpkoCUstHhk0VdMVwcrfe
h8n+JOovgPaxhqkW2/P/wuWYoa/5k+vH1qwz0/vReWkOfJO3grkplvjB1YluD/Dj
2h81jxBCdEYdfPemHA2QkIaEeI7pwlAlMK0DmMr9MTZ0iz3YDvs=
=CeUf
-----END PGP SIGNATURE-----

```

---



=== Content from www.debian.org_5ef32076_20250124_115245.html ===


---

[[Date Prev](msg00051.html)][[Date Next](msg00053.html)]
[[Thread Prev](msg00051.html)][[Thread Next](msg00053.html)]
[[Date Index](maillist.html#00052)]
[[Thread Index](threads.html#00052)]

# [SECURITY] [DSA 4127-1] simplesamlphp security update

---

* *To*: <debian-security-announce@lists.debian.org>
* *Subject*: [SECURITY] [DSA 4127-1] simplesamlphp security update
* *From*: Thijs Kinkhorst <thijs@debian.org>
* *Date*: Fri, 2 Mar 2018 07:15:39 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/d799a440-d6f3-6b56-2a75-52fa2c61fc46%40debian.org)Â [d799a440-d6f3-6b56-2a75-52fa2c61fc46@debian.org](msg00052.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4127-1                   security@debian.org
<https://www.debian.org/security/>                          Thijs Kinkhorst
March 02, 2018                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : simplesamlphp
CVE ID         : CVE-2017-12867 CVE-2017-12869 CVE-2017-12873
                 CVE-2017-12874 CVE-2017-18121 CVE-2017-18122
                 CVE-2018-6519 CVE-2018-6521
Debian Bug     : 889286

Several vulnerabilities have been discovered in SimpleSAMLphp, a
framework for authentication, primarily via the SAML protocol.

CVE-2017-12867

     Attackers with access to a secret token could extend its validity
     period by manipulating the prepended time offset.

CVE-2017-12869

    When using the multiauth module, attackers can bypass authentication
    context restrictions and use any authentication source defined in
    the config.

CVE-2017-12873

    Defensive measures have been taken to prevent the administrator
    from misconfiguring persistent NameIDs to avoid identifier clash.
    (Affects Debian 8 Jesse only.)

CVE-2017-12874

    The InfoCard module could accept incorrectly signed XML messages
    in rare occasions.

CVE-2017-18121

    The consentAdmin module was vulnerable to a Cross-Site Scripting
    attack, allowing an attacker to craft links that could execute
     arbitrary JavaScript code in the victim's browser.

CVE-2017-18122

    The (deprecated) SAML 1.1 implementation would regard as valid any
    unsigned SAML response containing more than one signed assertion,
    provided that the signature of at least one of the assertions was
    valid, allowing an attacker that could obtain a valid signed
    assertion from an IdP to impersonate users from that IdP.

CVE-2018-6519

    Regular expression denial of service when parsing extraordinarily
    long timestamps.

CVE-2018-6521

    Change sqlauth module MySQL charset from utf8 to utf8mb to
    prevent theoretical query truncation that could allow remote
    attackers to bypass intended access restrictions

SSPSA-201802-01 (no CVE yet)

    Critical signature validation vulnerability.

For the oldstable distribution (jessie), these problems have been fixed
in version 1.13.1-2+deb8u1.

For the stable distribution (stretch), these problems have been fixed in
version 1.14.11-1+deb9u1.

We recommend that you upgrade your simplesamlphp packages.

For the detailed security status of simplesamlphp please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/simplesamlphp>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQEuBAEBCAAYBQJamOwIERx0aGlqc0BkZWJpYW4ub3JnAAoJEFb2GnlAHawEn6IH
/3wbUbHLQUuTHhS2E+n4u//hv9kE0TUrjXZak47KYo6vFwhxHyDeKAWlDFqwld8y
L6a5OFL9UZNaQbTOh8MvgD7Q9y8dwiGlC2USjBWlA7BO2HunZ2jqy904c1q36d7I
fAH4TszQ7P/k8uxkNCRPH5GZZiiYnZXRtjiC+x2R860jSHvtlLg0/rMKqSdgBKXd
sD5Dkx4oSeXTZiIVJQl7J+d1rUnuxBAidaqcSIgJOzXsOoPHbS7pfczpZ6kte9K6
s6PfSP39OPIfwbFTTxs1q9SBV3lv59QL3tW91i/XucAAyvsUsvqLVN5xRDllAIAc
RjhqAED45Wis3aG2D7c7Rhc=
=6tNs
-----END PGP SIGNATURE-----

```

---


