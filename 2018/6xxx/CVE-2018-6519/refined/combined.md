=== Content from www.debian.org_5ef32076_20250125_220535.html ===


---

[[Date Prev](msg00051.html)][[Date Next](msg00053.html)]
[[Thread Prev](msg00051.html)][[Thread Next](msg00053.html)]
[[Date Index](maillist.html#00052)]
[[Thread Index](threads.html#00052)]

# [SECURITY] [DSA 4127-1] simplesamlphp security update

---

* *To*: <debian-security-announce@lists.debian.org>
* *Subject*: [SECURITY] [DSA 4127-1] simplesamlphp security update
* *From*: Thijs Kinkhorst <thijs@debian.org>
* *Date*: Fri, 2 Mar 2018 07:15:39 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/d799a440-d6f3-6b56-2a75-52fa2c61fc46%40debian.org)Â [d799a440-d6f3-6b56-2a75-52fa2c61fc46@debian.org](msg00052.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4127-1                   security@debian.org
<https://www.debian.org/security/>                          Thijs Kinkhorst
March 02, 2018                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : simplesamlphp
CVE ID         : CVE-2017-12867 CVE-2017-12869 CVE-2017-12873
                 CVE-2017-12874 CVE-2017-18121 CVE-2017-18122
                 CVE-2018-6519 CVE-2018-6521
Debian Bug     : 889286

Several vulnerabilities have been discovered in SimpleSAMLphp, a
framework for authentication, primarily via the SAML protocol.

CVE-2017-12867

     Attackers with access to a secret token could extend its validity
     period by manipulating the prepended time offset.

CVE-2017-12869

    When using the multiauth module, attackers can bypass authentication
    context restrictions and use any authentication source defined in
    the config.

CVE-2017-12873

    Defensive measures have been taken to prevent the administrator
    from misconfiguring persistent NameIDs to avoid identifier clash.
    (Affects Debian 8 Jesse only.)

CVE-2017-12874

    The InfoCard module could accept incorrectly signed XML messages
    in rare occasions.

CVE-2017-18121

    The consentAdmin module was vulnerable to a Cross-Site Scripting
    attack, allowing an attacker to craft links that could execute
     arbitrary JavaScript code in the victim's browser.

CVE-2017-18122

    The (deprecated) SAML 1.1 implementation would regard as valid any
    unsigned SAML response containing more than one signed assertion,
    provided that the signature of at least one of the assertions was
    valid, allowing an attacker that could obtain a valid signed
    assertion from an IdP to impersonate users from that IdP.

CVE-2018-6519

    Regular expression denial of service when parsing extraordinarily
    long timestamps.

CVE-2018-6521

    Change sqlauth module MySQL charset from utf8 to utf8mb to
    prevent theoretical query truncation that could allow remote
    attackers to bypass intended access restrictions

SSPSA-201802-01 (no CVE yet)

    Critical signature validation vulnerability.

For the oldstable distribution (jessie), these problems have been fixed
in version 1.13.1-2+deb8u1.

For the stable distribution (stretch), these problems have been fixed in
version 1.14.11-1+deb9u1.

We recommend that you upgrade your simplesamlphp packages.

For the detailed security status of simplesamlphp please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/simplesamlphp>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQEuBAEBCAAYBQJamOwIERx0aGlqc0BkZWJpYW4ub3JnAAoJEFb2GnlAHawEn6IH
/3wbUbHLQUuTHhS2E+n4u//hv9kE0TUrjXZak47KYo6vFwhxHyDeKAWlDFqwld8y
L6a5OFL9UZNaQbTOh8MvgD7Q9y8dwiGlC2USjBWlA7BO2HunZ2jqy904c1q36d7I
fAH4TszQ7P/k8uxkNCRPH5GZZiiYnZXRtjiC+x2R860jSHvtlLg0/rMKqSdgBKXd
sD5Dkx4oSeXTZiIVJQl7J+d1rUnuxBAidaqcSIgJOzXsOoPHbS7pfczpZ6kte9K6
s6PfSP39OPIfwbFTTxs1q9SBV3lv59QL3tW91i/XucAAyvsUsvqLVN5xRDllAIAc
RjhqAED45Wis3aG2D7c7Rhc=
=6tNs
-----END PGP SIGNATURE-----

```

---



=== Content from simplesamlphp.org_31ef194e_20250125_220534.html ===


[Simple
SAML
php](https://simplesamlphp.org)

[Home](https://simplesamlphp.org) Â» SSPSA 201801-01: Denial of Service in timestamp validation function

[Download](/download)

[Documentation](/docs)

[Security](/security)

[Modules](/modules/)

[Support](/support/)

[Contribute](/contrib/)

## Date

January 25, 2018
## Affected versions

`simplesamlphp/saml2 < 1.10.4`
# 201801-01

**Denial of Service in timestamp validation function**

### Background

SAML messages and metadata use timestamps to express the validity of a given document based on the current time. These
timestamps use a common format, `xs:DateTime`, in order to convey precise moments in time. Even though the SAML
standard recommends not relying on time resolutions finer than milliseconds, the fact is that implementors use different
precisions and therefore the SAML2 library tries to accommodate for all possible (and legal) values.

### Description

When parsing a timestamp contained inside a SAML document, the SAML2 library uses a regular expression to validate its
format and parse its components. The given regular expression sets no limits for the fraction of seconds part, such that
an arbitrary amount of digits can be processed. This opens up the possibility to perform a *denial of service* attack
by sending a large number of digits as the fraction of a second in a timestamp, making the processing script choke while
evaluating the regular expression.

### Affected versions

All **simplesamlphp/saml2** versions 1.x, 2.x and 3.x are affected, up to (including) **1.10.3**, **2.3.4** and **3.1**,
respectively.

### Impact

An attacker can inject an arbitrary amount of digits into a valid `xs:DateTime` timestamp and send a SAML document with
it to be processed by the library, making it hang while trying to process it, effectively achieving a denial of
service.

### Resolution

Upgrade to the latest versions of the library.

### Credit

This security issue was discovered during a security audit performed by Cure53 and reported on December 18, 2017.

![](/res/ssplogo-fish-2.svg)


