=== Content from auth0.com_50c17ab9_20250125_031612.html ===
[Skip to main content](#maincontent)​[Articles](/docs/articles)[Quickstarts](/docs/quickstarts)[Auth0 APIs](/docs/api)[SDKs](/docs/libraries)[Contact sales](https://auth0.com/get-started?place=header&type=button&text=talk%20to%20sales) Log inSign up

---

​[Articles](/docs/articles)[Quickstarts](/docs/quickstarts)[Auth0 APIs](/docs/api)[SDKs](/docs/libraries)[Contact sales](https://auth0.com/get-started?place=header&type=button&text=talk%20to%20sales) Log inSign up

1. Main Menu
[###### Secure](/docs/secure)

Protect Your Application

* [Application Credentials](/docs/secure/application-credentials "Application Credentials")
* [Attack Protection](/docs/secure/attack-protection "Attack Protection")
* [Continuous Session Protection](/docs/secure/continuous-session-protection "Continuous Session Protection")
* [Highly Regulated Identity](/docs/secure/highly-regulated-identity "Highly Regulated Identity")
* [Multi-Factor Authentication](/docs/secure/multi-factor-authentication "Multi-Factor Authentication")
* [Security Center](/docs/secure/security-center "Security Center")
* [Security Guidance](/docs/secure/security-guidance "Security Guidance")
* [General Security Tips](/docs/secure/security-guidance/tips "General Security Tips")
* [Security Bulletins](/docs/secure/security-guidance/security-bulletins "Security Bulletins")
* [CVE-2022-23539, CVE-2022-23541, CVE-2022-23540: Security Update for jsonwebtoken](/docs/secure/security-guidance/security-bulletins/2022-12-21-jsonwebtoken "CVE-2022-23539, CVE-2022-23541, CVE-2022-23540: Security Update for jsonwebtoken")
* [CVE-2022-23505: Security Update for passport-wsfed-saml2 Library](/docs/secure/security-guidance/security-bulletins/cve-2022-23505 "CVE-2022-23505: Security Update for passport-wsfed-saml2 Library")
* [CVE-2022-24794: Security Update for Express OpenID Connect Library](/docs/secure/security-guidance/security-bulletins/cve-2022-24794 "CVE-2022-24794: Security Update for Express OpenID Connect Library")
* [CVE-2021-43812: Security Update for Next.js Auth0 Library](/docs/secure/security-guidance/security-bulletins/cve-2021-43812 "CVE-2021-43812: Security Update for Next.js Auth0 Library")
* [CVE-2021-41246: Security Update for Express OpenID Connect Library](/docs/secure/security-guidance/security-bulletins/cve-2021-41246 "CVE-2021-41246: Security Update for Express OpenID Connect Library")
* [CVE-2021-32702: Security Update for Auth0 Next.js Library](/docs/secure/security-guidance/security-bulletins/cve-2021-32702 "CVE-2021-32702: Security Update for Auth0 Next.js Library")
* [CVE-2021-32641: Security Update for Auth0 Lock Library](/docs/secure/security-guidance/security-bulletins/cve-2021-32641 "CVE-2021-32641: Security Update for Auth0 Lock Library")
* [CVE 2020-15259: Security Update for ad-ldap-connector](/docs/secure/security-guidance/security-bulletins/cve-2020-15259 "CVE 2020-15259: Security Update for ad-ldap-connector")
* [CVE-2020-15240: Security Update for omniauth-auth0 JWT Validation](/docs/secure/security-guidance/security-bulletins/cve-2020-15240 "CVE-2020-15240: Security Update for omniauth-auth0 JWT Validation")
* [CVE-2020-15125: Security Update for node-auth0 Library](/docs/secure/security-guidance/security-bulletins/cve-2020-15125 "CVE-2020-15125: Security Update for node-auth0 Library")
* [CVE-2020-15119: Security Update for Auth0 Lock Library](/docs/secure/security-guidance/security-bulletins/cve-2020-15119 "CVE-2020-15119: Security Update for Auth0 Lock Library")
* [CVE-2020-15084: Security Update for express-jwt Library](/docs/secure/security-guidance/security-bulletins/cve-2020-15084 "CVE-2020-15084: Security Update for express-jwt Library")
* [CVE-2020-5391, CVE-2020-5392, CVE-2020-6753, CVE-2020-7948, CVE-2020-7947: Security Update for WordPress Plugin for Auth0](/docs/secure/security-guidance/security-bulletins/2020-03-31-wpauth0 "CVE-2020-5391, CVE-2020-5392, CVE-2020-6753, CVE-2020-7948, CVE-2020-7947: Security Update for WordPress Plugin for Auth0")
* [CVE-2020-5263: Security Update for auth0.js Library](/docs/secure/security-guidance/security-bulletins/cve-2020-5263 "CVE-2020-5263: Security Update for auth0.js Library")
* [CVE-2019-20174: Security Update for Auth0 Lock Library](/docs/secure/security-guidance/security-bulletins/cve-2019-20174 "CVE-2019-20174: Security Update for Auth0 Lock Library")
* [CVE-2019-16929: Security Vulnerability in auth0.net](/docs/secure/security-guidance/security-bulletins/cve-2019-16929 "CVE-2019-16929: Security Vulnerability in auth0.net")
* [CVE-2019-13483: Security Vulnerability in Passport-SharePoint](/docs/secure/security-guidance/security-bulletins/cve-2019-13483 "CVE-2019-13483: Security Vulnerability in Passport-SharePoint")
* [CVE-2019-7644: Security Vulnerability in Auth0-WCF-Service-JWT](/docs/secure/security-guidance/security-bulletins/cve-2019-7644 "CVE-2019-7644: Security Vulnerability in Auth0-WCF-Service-JWT")
* [CVE-2019-20173: Security Update for WordPress Plugin for Auth0 wp-auth0](/docs/secure/security-guidance/security-bulletins/cve-2019-20173 "CVE-2019-20173: Security Update for WordPress Plugin for Auth0 wp-auth0")
* [CVE-2018-15121: Security Vulnerability in auth0-aspnet and auth0-aspnet-owin](/docs/secure/security-guidance/security-bulletins/cve-2018-15121 "CVE-2018-15121: Security Vulnerability in auth0-aspnet and auth0-aspnet-owin")
* [CVE-2018-11537: Security Update for angular-jwt Allow List Bypass](/docs/secure/security-guidance/security-bulletins/cve-2018-11537 "CVE-2018-11537: Security Update for angular-jwt Allow List Bypass")
* [CVE-2018-7307: Security Vulnerability for auth0.js < 9.3](/docs/secure/security-guidance/security-bulletins/cve-2018-7307 "CVE-2018-7307: Security Vulnerability for auth0.js < 9.3")
* [CVE-2018-6874: Security Vulnerability in the Auth0 Authentication Service](/docs/secure/security-guidance/security-bulletins/cve-2018-6874 "CVE-2018-6874: Security Vulnerability in the Auth0 Authentication Service")
* [CVE-2018-6873: Security Vulnerability in the Auth0 Authentication Service](/docs/secure/security-guidance/security-bulletins/cve-2018-6873 "CVE-2018-6873: Security Vulnerability in the Auth0 Authentication Service")
* [CVE-2017-17068: Security Update for auth0.js Popup Callback Vulnerability](/docs/secure/security-guidance/security-bulletins/cve-2017-17068 "CVE-2017-17068: Security Update for auth0.js Popup Callback Vulnerability")
* [CVE-2017-16897: Security Update for passport-wsfed-saml2 Passport Strategy Library](/docs/secure/security-guidance/security-bulletins/cve-2017-16897 "CVE-2017-16897: Security Update for passport-wsfed-saml2 Passport Strategy Library")
* [Auth0 Security Bulletin for Rules](/docs/secure/security-guidance/security-bulletins/2019-01-10-rules "Auth0 Security Bulletin for Rules")
* [Auth0 Security Bulletin for Assigning Scopes Based on Email Address](/docs/secure/security-guidance/security-bulletins/2019-09-05-scopes "Auth0 Security Bulletin for Assigning Scopes Based on Email Address")
* [Data Security](/docs/secure/security-guidance/data-security "Data Security")
* [Prevent Common Cybersecurity Threats](/docs/secure/security-guidance/prevent-threats "Prevent Common Cybersecurity Threats")
* [Incident Response: Using Logs](/docs/secure/security-guidance/incident-response-using-logs "Incident Response: Using Logs")
* [Tokens](/docs/secure/tokens "Tokens")

Compliance

* [Data Privacy and Compliance](/docs/secure/data-privacy-and-compliance "Data Privacy and Compliance")

1. [Docs](/docs)
3. [Secure](/docs/secure)
5. [Security Guidance](/docs/secure/security-guidance)
7. [Security Bulletins](/docs/secure/security-guidance/security-bulletins)
9. [CVE-2018-6874: Security Vulnerability in the Auth0 Authentication Service](/docs/secure/security-guidance/security-bulletins/cve-2018-6874)
# CVE-2018-6874: Security Vulnerability in the Auth0 Authentication Service

**Published**: April 4, 2018

**CVE number**: CVE-2018-6874

**Credit**: Internal

## Overview

A vulnerability has been identified in the Auth0 authentication service. Tenants of the service with the Legacy Lock API flag enabled in the service’s management dashboard are affected. If the flag is not visible, it is disabled. Disabling the flag may break applications employing the auth0.js library with version `< 9.0.0` or the Lock library with version `< 11.0.0` for crossdomain username/password based authentication - also known as [embedded login](/docs/authenticate/login/universal-vs-embedded-login). Further, any cross-domain use of the `/usernamepassword/login` authentication api endpoint outside of those libraries may also be affected.

After the verification of user credentials on `/usernamepassword/login`, an HTML form is rendered into the user’s browser and automatically executed. It POSTs a JSON Web Token (JWT) to the `/login/callback` endpoint. This authenticated token maintains state regarding the identity of the user; this cannot be done directly due to crossdomain session management restrictions maintained by most modern browsers. Due to the lack of session binding, this form post is susceptible to [CSRF](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29). An attacker with valid user credentials at an Auth0 tenant can use them to gain such a form, and then employ techniques such as social engineering or clickjacking to have a victim’s browser execute it. The victim will then have a login session at the Auth0 tenant under the attacker’s account - and therefore be recognized as the attacker by any downstream application in its federation. Should the user undertake any actions while maliciously logged in as such, those actions and any related information will be visible to the attacker.

The attack does not allow any escalation of privileges on behalf of the attacker, and the victim’s actions visible to the attacker are restricted to whatever permissions have been granted to that attacker within the system. The victim will also be fully recognized as the attacker within the federation, and so may be shown account information or other context clues that reveal they are not operating within the auspices of their own account.

## Am I affected?

You are affected if you employ username/password authentication (with any database and/or connection) for your Auth0 tenant, and the Legacy Lock API flag in the Auth0 management dashboard is visible and flagged on.

## How to fix that?

To mitigate the vulnerability, toggle the flag to off. The `/usernamepassword/login` endpoint will still work for logins from the Universal Login page hosted on `/login`, however these - as same-domain logins - will be protected from CSRF. Otherwise, toggling the flag will disable cross-domain authentication on that endpoint.

For applications employing auth0.js version `< 9.0.0` or Lock version `< 11.0.0`, this may break user logins. Upgrading to auth0.js version `> 9.0.0` or Lock version `> 11.0.0` will restore embedded username/password authentication using cross-origin authentication (note the limitations). Applications are also encouraged to migrate to Universal Login.

Private SaaS Appliances running versions `> 14591` with the Legacy Lock API flag set to off are not affected by this vulnerability.

### Will this update impact my users?

If the Legacy Lock API is disabled without applications having migrated, then all user logins employing the affected functionality will break. Auth0 intends to enforce disablement of the Legacy Lock API for all tenants on July 16th, 2018. The choice of migration may affect the specific user experience of logging into your service, however users, their information, and their sessions will not be otherwise impacted.

Was this article helpful?

Yes No

Developers

* [Developer Hub](https://developer.auth0.com/resources)
* [Code Samples and Guides](https://developer.auth0.com/resources/code-samples)
* [Blog posts](https://auth0.com/blog/developers/)
* [Videos](https://auth0.com/docs/videos)
* [Identity Unlocked - Podcasts](https://identityunlocked.auth0.com/public/49/Identity%2C-Unlocked.--bed7fada)
* [Zero Index Newsletter](https://developer.auth0.com/newsletter)

Documentation

* [Articles](https://auth0.com/docs/articles)
* [Quickstarts](https://auth0.com/docs/quickstarts)
* [APIs](https://auth0.com/docs/api)
* [SDK Libraries](https://auth0.com/docs/libraries)
* [Blog](https://auth0.com/blog/)
* [Reports](https://auth0.com/resources/ebooks)
* [Webinars](https://auth0.com/resources/webinars)

Get Involved

* [Forum](https://community.auth0.com/)
* [Events](https://developer.auth0.com/events)
* [Ambassador Program](https://auth0.com/ambassador-program)
* [Auth0 Research Program](https://auth0.com/research-program)

Company

* [Our Customers](https://auth0.com/customers)
* [Compliance - Ensuring privacy and security](https://auth0.com/security)
* [Partners](https://auth0.com/partners)
* [Careers We're hiring!](https://www.okta.com/company/careers/)
* [Okta + Auth0](https://www.okta.com/okta-and-auth0/)

Support Center

* [Community](https://community.auth0.com/)
* [Support](https://support.auth0.com/)
* [Help](https://community.auth0.com/c/help/6)
* [FAQs](https://community.auth0.com/c/faq/42)
* [Auth0 Marketplace](https://marketplace.auth0.com)

Learning

* [Learn](https://auth0.com/learn)
* [Intro to IAM (CIAM)](https://auth0.com/intro-to-iam)
* [Blog](https://auth0.com/blog/)

Platform

* [Access Management](https://auth0.com/platform/access-management)
* [Extensibility](https://auth0.com/platform/extensibility)
* [Security](https://auth0.com/platform/login-security)
* [User Management](https://auth0.com/platform/user-management)
* [Authentication](https://auth0.com/platform/authentication)

Features

* [Universal Login](https://auth0.com/features/universal-login)
* [Single Sign On](https://auth0.com/features/single-sign-on)
* [Multifactor Authentication](https://auth0.com/features/multifactor-authentication)
* [Actions](https://auth0.com/features/actions)
* [Machine to Machine](https://auth0.com/features/machine-to-machine)
* [Passwordless](https://auth0.com/features/passwordless)
* [Breached Passwords](https://auth0.com/features/breached-passwords)

© 2025 Okta, Inc. All Rights Reserved.

[Status](https://status.auth0.com) • [Legal](https://www.okta.com/agreements/) • [Privacy](https://auth0.com/privacy) • [Terms](https://auth0.com/web-terms) • [Your Privacy Choices](https://auth0.com/your-privacy-choices)![](https://cdn.auth0.com/website/footer/ccpa.svg)[Status](https://status.auth0.com) • [Legal](https://www.okta.com/agreements/) • [Privacy](https://auth0.com/privacy) • [Terms](https://auth0.com/web-terms) • [Your Privacy Choices](https://auth0.com/your-privacy-choices)![](https://cdn.auth0.com/website/footer/ccpa.svg)
