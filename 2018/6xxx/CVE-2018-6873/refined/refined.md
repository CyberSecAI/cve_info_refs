- **Root cause of vulnerability**: The Auth0 authentication service failed to properly validate the audience claim within JWTs used in the `/login/callback` endpoint.
- **Weaknesses/vulnerabilities present**: Inadequate validation of the JWT audience claim, which allows tokens intended for one tenant to be used in another. Additionally, the custom database feature allows generation of tokens with arbitrary user identifiers.
- **Impact of exploitation**: Privilege escalation, allowing an attacker to log in as another user (victim) on a target tenant. For instance, an attacker could log in as a tenant administrator and perform administrative tasks.
- **Attack vectors**: The attacker needs to obtain the user identifier of the victim at the target tenant (which is generally considered public information). The attacker then constructs a JWT with the victim's identifier and a target audience which is not properly validated. The attacker submits this crafted JWT to the /login/callback endpoint of a vulnerable Auth0 tenant.
- **Required attacker capabilities/position**: The attacker needs to know the user identifier of the victim at the target tenant. The attacker needs to be able to craft JWTs with custom identifiers.