=== Content from github.com_e2c2c54f_20250125_234452.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhashicorp%2Fterraform-provider-aws%2Fpull%2F3934)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhashicorp%2Fterraform-provider-aws%2Fpull%2F3934)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fpull_requests%2Fshow&source=header-repo&source_repo=hashicorp%2Fterraform-provider-aws)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[hashicorp](/hashicorp)
/
**[terraform-provider-aws](/hashicorp/terraform-provider-aws)**
Public

* [Notifications](/login?return_to=%2Fhashicorp%2Fterraform-provider-aws) You must be signed in to change notification settings
* [Fork
  9.3k](/login?return_to=%2Fhashicorp%2Fterraform-provider-aws)
* [Star
   10k](/login?return_to=%2Fhashicorp%2Fterraform-provider-aws)

* [Code](/hashicorp/terraform-provider-aws)
* [Issues
  3.3k](/hashicorp/terraform-provider-aws/issues)
* [Pull requests
  386](/hashicorp/terraform-provider-aws/pulls)
* [Actions](/hashicorp/terraform-provider-aws/actions)
* [Security](/hashicorp/terraform-provider-aws/security)
* [Insights](/hashicorp/terraform-provider-aws/pulse)

Additional navigation options

* [Code](/hashicorp/terraform-provider-aws)
* [Issues](/hashicorp/terraform-provider-aws/issues)
* [Pull requests](/hashicorp/terraform-provider-aws/pulls)
* [Actions](/hashicorp/terraform-provider-aws/actions)
* [Security](/hashicorp/terraform-provider-aws/security)
* [Insights](/hashicorp/terraform-provider-aws/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fhashicorp%2Fterraform-provider-aws%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fhashicorp%2Fterraform-provider-aws%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix password generation in resourceAwsIamUserLoginProfile #3934

 Closed

[KellerFuchs](/KellerFuchs)
wants to merge
6
commits into
[hashicorp:master](/hashicorp/terraform-provider-aws/tree/master "hashicorp/terraform-provider-aws:master")
from
[hashbang:generatePassword](/hashbang/terraform-provider-aws/tree/generatePassword "hashbang/terraform-provider-aws:generatePassword")

 Closed

# [Fix password generation in resourceAwsIamUserLoginProfile](#top) #3934

[KellerFuchs](/KellerFuchs)
wants to merge
6
commits into
[hashicorp:master](/hashicorp/terraform-provider-aws/tree/master "hashicorp/terraform-provider-aws:master")
from
[hashbang:generatePassword](/hashbang/terraform-provider-aws/tree/generatePassword "hashbang/terraform-provider-aws:generatePassword")

[Conversation
37](/hashicorp/terraform-provider-aws/pull/3934)
[Commits
6](/hashicorp/terraform-provider-aws/pull/3934/commits)
[Checks
0](/hashicorp/terraform-provider-aws/pull/3934/checks)
[Files changed](/hashicorp/terraform-provider-aws/pull/3934/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=60&v=4)](/KellerFuchs)

Copy link

Contributor

### @KellerFuchs **[KellerFuchs](/KellerFuchs)** commented [Mar 27, 2018](#issue-308958500)

The current `generatePassword()` has massive issues:

* it uses the PRNG from `math/rand`, which is *not* secure;
* it seeds said PRNG with non-random data (the current time);
* the password generation method samples one character from each charset, then shuffles the results; this results in suboptimal password entropy, as for a 20-character long (for example), one would know it contains exactly 5 lowercase letters, 5 uppercase letters, 5 digits and 5 ‚Äúspecial characters‚Äù.

I strongly suggest publishing an advisory after merging this (and updating the vendor-ed source in terraform), as it means that Terraform users have had IAM accounts provisionned with weak, easily-bruteforceable password.

Sorry, something went wrong.

 üéâ
7
 emilva, lrvick, momota10, berney, thomwiggers, tsoporan, and eneveu reacted with hooray emoji

All reactions

* üéâ
  7 reactions

 [KellerFuchs](/KellerFuchs)
added 2 commits
[March 27, 2018 14:44](#commits-pushed-392dbde)

[![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=40&v=4)](/KellerFuchs)

`[resource_aws_iam_user_login_profile/generatePassword(): Use a CSPRNG](/hashicorp/terraform-provider-aws/pull/3934/commits/392dbde24d86605fd5bd319734ce1e721869e680 "resource_aws_iam_user_login_profile/generatePassword(): Use a CSPRNG

There are 2 major issues with the previous generatePassword() function:
- It does not use a cryptographically-secure RNG, meaning that its output
  is not guaranteed to be secret;
- It is seeded only from the current time, making it very easy to bruteforce
  the password for an adversary with (limited) information on the creation
  time of the account.")`
 ‚Ä¶

`[392dbde](/hashicorp/terraform-provider-aws/pull/3934/commits/392dbde24d86605fd5bd319734ce1e721869e680)`

```
There are 2 major issues with the previous generatePassword() function:
- It does not use a cryptographically-secure RNG, meaning that its output
  is not guaranteed to be secret;
- It is seeded only from the current time, making it very easy to bruteforce
  the password for an adversary with (limited) information on the creation
  time of the account.
```

[![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=40&v=4)](/KellerFuchs)

`[resource_aws_iam_user_login_profile: Make uniformly random passwords](/hashicorp/terraform-provider-aws/pull/3934/commits/a88a14b4ceb504d0d6b11d359b0899b6a8c900fa "resource_aws_iam_user_login_profile: Make uniformly random passwords

This maximises the entropy of the resulting password, given a fixed
charset and length; given that the charset contains 2*26 + 10 + 20
distinct charactes, using length-21 passwords results in password
entropy above 128 bits.")`
 ‚Ä¶

`[a88a14b](/hashicorp/terraform-provider-aws/pull/3934/commits/a88a14b4ceb504d0d6b11d359b0899b6a8c900fa)`

```
This maximises the entropy of the resulting password, given a fixed
charset and length; given that the charset contains 2*26 + 10 + 20
distinct charactes, using length-21 passwords results in password
entropy above 128 bits.
```

![@ghost](https://avatars.githubusercontent.com/u/10137?s=32&v=4)
**ghost**
added
the
[size/S](/hashicorp/terraform-provider-aws/labels/size/S)
Managed by automation to categorize the size of a PR.
label
[Mar 27, 2018](#event-1543155881)

[![RyanSquared](https://avatars.githubusercontent.com/u/12415837?s=60&v=4)](/RyanSquared)

**[RyanSquared](/RyanSquared)**
reviewed
[Mar 27, 2018](#pullrequestreview-107280159)

 [View reviewed changes](/hashicorp/terraform-provider-aws/pull/3934/files/a88a14b4ceb504d0d6b11d359b0899b6a8c900fa)

[aws/resource\_aws\_iam\_user\_login\_profile.go](/hashicorp/terraform-provider-aws/pull/3934/files/392dbde24d86605fd5bd319734ce1e721869e680..a88a14b4ceb504d0d6b11d359b0899b6a8c900fa#diff-3877dd21320621968897ed1115cca1b9badba2be6bb75a2502e70c9aad63b104)
Outdated

|  |  | result[i] = b |
| --- | --- | --- |
|  |  | i = i + 1 |
|  |  | for i := 0; i < length; i++ { |
|  |  | result[i] = charset[rand.Int(len(charset))] |

Copy link

### @RyanSquared **[RyanSquared](/RyanSquared)** [Mar 27, 2018](#discussion_r177415597)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

It's technically possible to have a password now that is exactly one character, if somehow `rand.Int()` always returns 0. I am not sure if there is a `crypto/rand` alternative to `rand.Perm()`, which returns a random permutation.

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @KellerFuchs **[KellerFuchs](/KellerFuchs)** [Mar 27, 2018](#discussion_r177416953)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

If by ‚Äúexactly one character‚Äù, you mean the same, repeated characted, then yes it is, though it is vanishingly unlikely.

As `crypto/rand` uses OS-provided randomness (either a syscall like `getentropy(3)` or `/dev/urandom`), if it provides you with non-random numbers, you have a bigger problem.

Sorry, something went wrong.

All reactions

Copy link

### @RyanSquared **[RyanSquared](/RyanSquared)** [Mar 27, 2018](#discussion_r177417753)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

There's still the case where it could avoid required characters, like all uppercase, or required symbols.

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @paultyng **[paultyng](/paultyng)** [Mar 27, 2018](#discussion_r177479624)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Yeah, I called this out as well, that was what I suspect the reasoning for the division of the character sets previously.

Sorry, something went wrong.

All reactions

Copy link

### @RyanSquared **[RyanSquared](/RyanSquared)** [Mar 27, 2018](#discussion_r177481659)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I discussed it with KellerFuchs on IRC, and a few points were discussed:

1. Password policies were discouraged by the NIST publication about passwords and 2fa
2. The original code didn't attempt to conform to existing IAM policies, but rather just attempted it by just putting in what characters it thought would be required

Sorry, something went wrong.

All reactions

[![@bflad](https://avatars.githubusercontent.com/u/189114?s=40&v=4)](/bflad)
[bflad](/bflad)
added
the
[service/iam](/hashicorp/terraform-provider-aws/labels/service/iam)
Issues and PRs that pertain to the iam service.
label
[Mar 27, 2018](#event-1543170261)

[![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=80&u=9607b8b970e57b7063ca7abf8bbf58ef704eb286&v=4)](/KellerFuchs)

Copy link

Contributor

Author

### **[KellerFuchs](/KellerFuchs)** commented [Mar 27, 2018](#issuecomment-376518918)

| PS: Crediting [@lrvick](https://github.com/lrvick) for pointing out the code fragment. |
| --- |

 üëç
1
 lrvick reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

![@ghost](https://avatars.githubusercontent.com/u/10137?s=32&v=4)
**ghost**
added
the
[size/S](/hashicorp/terraform-provider-aws/labels/size/S)
Managed by automation to categorize the size of a PR.
label
[Mar 27, 2018](#event-1543187695)

 [![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=40&u=9607b8b970e57b7063ca7abf8bbf58ef704eb286&v=4)](/KellerFuchs)
[KellerFuchs](/KellerFuchs)
[force-pushed](/hashicorp/terraform-provider-aws/compare/60c64cb49bdcfe253945b91f9e3894746276fc6e..61815205f3acb29535ab137427f9568711ea5075)
the
generatePassword

branch
from
[`60c64cb`](/hashicorp/terraform-provider-aws/commit/60c64cb49bdcfe253945b91f9e3894746276fc6e) to
[`6181520`](/hashicorp/terraform-provider-aws/commit/61815205f3acb29535ab137427f9568711ea5075)  [Compare](/hashicorp/terraform-provider-aws/compare/60c64cb49bdcfe253945b91f9e3894746276fc6e..61815205f3acb29535ab137427f9568711ea5075)
[March 27, 2018 13:16](#event-1543192144)

![@ghost](https://avatars.githubusercontent.com/u/10137?s=32&v=4)
**ghost**
added
[size/M](/hashicorp/terraform-provider-aws/labels/size/M)
Managed by automation to categorize the size of a PR.
and removed
[size/S](/hashicorp/terraform-provider-aws/labels/size/S)
Managed by automation to categorize the size of a PR.
labels
[Mar 27, 2018](#event-1543192175)

[![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=80&u=9607b8b970e57b7063ca7abf8bbf58ef704eb286&v=4)](/KellerFuchs)

Copy link

Contributor

Author

### **[KellerFuchs](/KellerFuchs)** commented [Mar 27, 2018](#issuecomment-376521188)

| Clearly, I don't know how to use `crypto/rand` before my second coffee; fixing this in a jiffy. |
| --- |

All reactions

Sorry, something went wrong.

 [![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=40&u=9607b8b970e57b7063ca7abf8bbf58ef704eb286&v=4)](/KellerFuchs)
[KellerFuchs](/KellerFuchs)
[force-pushed](/hashicorp/terraform-provider-aws/compare/61815205f3acb29535ab137427f9568711ea5075..7d2b63e582f844b5c073967df7b1dbf88a8825a2)
the
generatePassword

branch
from
[`6181520`](/hashicorp/terraform-provider-aws/commit/61815205f3acb29535ab137427f9568711ea5075) to
[`7d2b63e`](/hashicorp/terraform-provider-aws/commit/7d2b63e582f844b5c073967df7b1dbf88a8825a2)  [Compare](/hashicorp/terraform-provider-aws/compare/61815205f3acb29535ab137427f9568711ea5075..7d2b63e582f844b5c073967df7b1dbf88a8825a2)
[March 27, 2018 13:33](#event-1543232107)

![@ghost](https://avatars.githubusercontent.com/u/10137?s=32&v=4)
**ghost**
added
the
[size/M](/hashicorp/terraform-provider-aws/labels/size/M)
Managed by automation to categorize the size of a PR.
label
[Mar 27, 2018](#event-1543232159)

 [![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=40&u=9607b8b970e57b7063ca7abf8bbf58ef704eb286&v=4)](/KellerFuchs)
[KellerFuchs](/KellerFuchs)
[force-pushed](/hashicorp/terraform-provider-aws/compare/7d2b63e582f844b5c073967df7b1dbf88a8825a2..c77603cd30b9fa6bc5010079250770bc16bf43fb)
the
generatePassword

branch
from
[`7d2b63e`](/hashicorp/terraform-provider-aws/commit/7d2b63e582f844b5c073967df7b1dbf88a8825a2) to
[`c77603c`](/hashicorp/terraform-provider-aws/commit/c77603cd30b9fa6bc5010079250770bc16bf43fb)  [Compare](/hashicorp/terraform-provider-aws/compare/7d2b63e582f844b5c073967df7b1dbf88a8825a2..c77603cd30b9fa6bc5010079250770bc16bf43fb)
[March 27, 2018 13:39](#event-1543246806)

![@ghost](https://avatars.githubusercontent.com/u/10137?s=32&v=4)
**ghost**
added
the
[size/M](/hashicorp/terraform-provider-aws/labels/size/M)
Managed by automation to categorize the size of a PR.
label
[Mar 27, 2018](#event-1543246866)

[![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=40&v=4)](/KellerFuchs)

`[fixup! resource_aws_iam_user_login_profile/generatePassword(): Use a ‚Ä¶](/hashicorp/terraform-provider-aws/pull/3934/commits/59e015727fe93ae137f6e7f3880502595a700f4c "fixup! resource_aws_iam_user_login_profile/generatePassword(): Use a CSPRNG")`
 ‚Ä¶

`[59e0157](/hashicorp/terraform-provider-aws/pull/3934/commits/59e015727fe93ae137f6e7f3880502595a700f4c)`

```
‚Ä¶CSPRNG
```

 [![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=40&u=9607b8b970e57b7063ca7abf8bbf58ef704eb286&v=4)](/KellerFuchs)
[KellerFuchs](/KellerFuchs)
[force-pushed](/hashicorp/terraform-provider-aws/compare/c77603cd30b9fa6bc5010079250770bc16bf43fb..59e015727fe93ae137f6e7f3880502595a700f4c)
the
generatePassword

branch
from
[`c77603c`](/hashicorp/terraform-provider-aws/commit/c77603cd30b9fa6bc5010079250770bc16bf43fb) to
[`59e0157`](/hashicorp/terraform-provider-aws/commit/59e015727fe93ae137f6e7f3880502595a700f4c)  [Compare](/hashicorp/terraform-provider-aws/compare/c77603cd30b9fa6bc5010079250770bc16bf43fb..59e015727fe93ae137f6e7f3880502595a700f4c)
[March 27, 2018 13:53](#event-1543281040)

![@ghost](https://avatars.githubusercontent.com/u/10137?s=32&v=4)
**ghost**
added
the
[size/M](/hashicorp/terraform-provider-aws/labels/size/M)
Managed by automation to categorize the size of a PR.
label
[Mar 27, 2018](#event-1543281080)

[![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=80&u=9607b8b970e57b7063ca7abf8bbf58ef704eb286&v=4)](/KellerFuchs)

Copy link

Contributor

Author

### **[KellerFuchs](/KellerFuchs)** commented [Mar 27, 2018](#issuecomment-376557250)

| [@bflad](https://github.com/bflad) Can you escalate this to whoever deals with security at [@hashicorp](https://github.com/hashicorp) ? It's a pretty bad one. |
| --- |

All reactions

Sorry, something went wrong.

[![jbardin](https://avatars.githubusercontent.com/u/35067?s=60&v=4)](/jbardin)

**[jbardin](/jbardin)**
approved these changes
[Mar 27, 2018](#pullrequestreview-107330157)

 [View reviewed changes](/hashicorp/terraform-provider-aws/pull/3934/files/59e015727fe93ae137f6e7f3880502595a700f4c)

Copy link

Member

### @jbardin **[jbardin](/jbardin)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Hi [@KellerFuchs](https://github.com/KellerFuchs),

Thanks for submitting this. This looks good, and the comments here are strictly about better matching code style (and the regular aws committers can certainly override me on those points ;) )

Sorry, something went wrong.

All reactions

[aws/resource\_aws\_iam\_user\_login\_profile.go](/hashicorp/terraform-provider-aws/pull/3934/files/59e015727fe93ae137f6e7f3880502595a700f4c#diff-3877dd21320621968897ed1115cca1b9badba2be6bb75a2502e70c9aad63b104)
Outdated

|  |  | for \_, b := range components { |
| --- | --- | --- |
|  |  | result[i] = b |
|  |  | i = i + 1 |
|  |  | for i := 0; i < length; i++ { |

Copy link

Member

### @jbardin **[jbardin](/jbardin)** [Mar 27, 2018](#discussion_r177457318)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

use `range` over `result` here

Sorry, something went wrong.

All reactions

[aws/resource\_aws\_iam\_user\_login\_profile.go](/hashicorp/terraform-provider-aws/pull/3934/files/59e015727fe93ae137f6e7f3880502595a700f4c#diff-3877dd21320621968897ed1115cca1b9badba2be6bb75a2502e70c9aad63b104)
Outdated

|  |  | result[i] = b |
| --- | --- | --- |
|  |  | i = i + 1 |
|  |  | for i := 0; i < length; i++ { |
|  |  | r, err := rand.Int(rand.Reader, big.NewInt(int64(len(charset)))) |

Copy link

Member

### @jbardin **[jbardin](/jbardin)** [Mar 27, 2018](#discussion_r177457468)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

create the `big.Int` outside of the for loop.

Sorry, something went wrong.

All reactions

[aws/resource\_aws\_iam\_user\_login\_profile.go](/hashicorp/terraform-provider-aws/pull/3934/files/59e015727fe93ae137f6e7f3880502595a700f4c#diff-3877dd21320621968897ed1115cca1b9badba2be6bb75a2502e70c9aad63b104)
Outdated

|  |  | if err != nil { |
| --- | --- | --- |
|  |  | panic(err) |
|  |  | } |
|  |  | if r.IsInt64() { |

Copy link

Member

### @jbardin **[jbardin](/jbardin)** [Mar 27, 2018](#discussion_r177457681)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Invert this boolean and remove the else block

Sorry, something went wrong.

All reactions

[![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=40&v=4)](/KellerFuchs)

`[Handling](/hashicorp/terraform-provider-aws/pull/3934/commits/51ab8162ebc33a3412bf1febcd2d292c2ecdc8e3 "Handling @jbardin's comments") [@jbardin](https://github.com/jbardin)['s comments](/hashicorp/terraform-provider-aws/pull/3934/commits/51ab8162ebc33a3412bf1febcd2d292c2ecdc8e3 "Handling @jbardin's comments")`

`[51ab816](/hashicorp/terraform-provider-aws/pull/3934/commits/51ab8162ebc33a3412bf1febcd2d292c2ecdc8e3)`

![@ghost](https://avatars.githubusercontent.com/u/10137?s=32&v=4)
**ghost**
added
the
[size/M](/hashicorp/terraform-provider-aws/labels/size/M)
Managed by automation to categorize the size of a PR.
label
[Mar 27, 2018](#event-1543547999)

[![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=80&u=9607b8b970e57b7063ca7abf8bbf58ef704eb286&v=4)](/KellerFuchs)

Copy link

Contributor

Author

### **[KellerFuchs](/KellerFuchs)** commented [Mar 27, 2018](#issuecomment-376572040)

| [@jbardin](https://github.com/jbardin) Done :) |
| --- |

All reactions

Sorry, something went wrong.

[![jbardin](https://avatars.githubusercontent.com/u/35067?s=60&v=4)](/jbardin)

**[jbardin](/jbardin)**
previously approved these changes
[Mar 27, 2018](#pullrequestreview-107348325)

 [View reviewed changes](/hashicorp/terraform-provider-aws/pull/3934/files/51ab8162ebc33a3412bf1febcd2d292c2ecdc8e3)

Copy link

Member

### @jbardin **[jbardin](/jbardin)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Sorry, I don't mean to nitpick here, especially if Go isn't your usual tool. Just a couple minor nits

Sorry, something went wrong.

All reactions

[aws/resource\_aws\_iam\_user\_login\_profile.go](/hashicorp/terraform-provider-aws/pull/3934/files/51ab8162ebc33a3412bf1febcd2d292c2ecdc8e3#diff-3877dd21320621968897ed1115cca1b9badba2be6bb75a2502e70c9aad63b104)
Outdated

|  |  | i = i + 1 |
| --- | --- | --- |
|  |  | charset\_size := big.NewInt(int64(len(charset))) |
|  |  |  |
|  |  | for i, \_ := range result { |

Copy link

Member

### @jbardin **[jbardin](/jbardin)** [Mar 27, 2018](#discussion_r177472225)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

One last thing -- the `, _` can be left out entirely here

Sorry, something went wrong.

All reactions

[aws/resource\_aws\_iam\_user\_login\_profile.go](/hashicorp/terraform-provider-aws/pull/3934/files/51ab8162ebc33a3412bf1febcd2d292c2ecdc8e3#diff-3877dd21320621968897ed1115cca1b9badba2be6bb75a2502e70c9aad63b104)
Outdated

|  |  | for \_, b := range components { |
| --- | --- | --- |
|  |  | result[i] = b |
|  |  | i = i + 1 |
|  |  | charset\_size := big.NewInt(int64(len(charset))) |

Copy link

Member

### @jbardin **[jbardin](/jbardin)** [Mar 27, 2018](#discussion_r177472488)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

while we're at it, might as well use `charsetSize` here

Sorry, something went wrong.

All reactions

[![@jbardin](https://avatars.githubusercontent.com/u/35067?s=80&u=378390a987ace0ce8cb7eb7f46ae4d1bd4bd44dc&v=4)](/jbardin)

Copy link

Member

### **[jbardin](/jbardin)** commented [Mar 27, 2018](#issuecomment-376574042)

| Hi [@KellerFuchs](https://github.com/KellerFuchs),  Thanks for taking the time to submit this! I'd just like to point out for reference, our [Security Policy](https://www.hashicorp.com/security) and [Community Guidelines](https://www.hashicorp.com/community-guidelines), for others wishing to report security issues in the future, or to get in contact directly with our security team. |
| --- |

All reactions

Sorry, something went wrong.

[![@paultyng](https://avatars.githubusercontent.com/u/422474?s=80&u=db482cdd9177b3f7950797bd16afbfac0888085e&v=4)](/paultyng)

Copy link

Contributor

### **[paultyng](/paultyng)** commented [Mar 27, 2018](#issuecomment-376576154)

| FWIW the character class code is probably there because someone could have an IAM password policy that enforces those checks, so this may start breaking for people, need to make sure that use case is considered.  <https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html> |
| --- |

All reactions

Sorry, something went wrong.

[![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=80&u=9607b8b970e57b7063ca7abf8bbf58ef704eb286&v=4)](/KellerFuchs)

Copy link

Contributor

Author

### **[KellerFuchs](/KellerFuchs)** commented [Mar 27, 2018](#issuecomment-376576340) ‚Ä¢ edited Loading

| [@jbardin](https://github.com/jbardin) Thanks a lot; I looked for a proper security contact before dumping this in a PR, but couldn't find it. Perhaps add a link in `README.md` or `.github/*.md` ? |
| --- |

 üëç
3
 jbardin, lrvick, and erran reacted with thumbs up emoji

All reactions

* üëç
  3 reactions

Sorry, something went wrong.

[![@paultyng](https://avatars.githubusercontent.com/u/422474?s=80&u=db482cdd9177b3f7950797bd16afbfac0888085e&v=4)](/paultyng)

Copy link

Contributor

### **[paultyng](/paultyng)** commented [Mar 27, 2018](#issuecomment-376587951)

| Something like this would satisfy the character class issues and uses `crypto/rand`: <https://github.com/sethvargo/go-password> |
| --- |

All reactions

Sorry, something went wrong.

[![@jbardin](https://avatars.githubusercontent.com/u/35067?s=80&u=378390a987ace0ce8cb7eb7f46ae4d1bd4bd44dc&v=4)](/jbardin)

Copy link

Member

### **[jbardin](/jbardin)** commented [Mar 27, 2018](#issuecomment-376589267)

| [@paultyng](https://github.com/paultyng), Yeah, I misread the previous code from the diff -- looking at the old code directly it seems that it was attempting to take each specific component, but it was not a fair distribution.  I think it's probably better to take a normally distributed password generated like this and verify it it against the policy after. (or we can vet the package linked above) |
| --- |

 üëç
1
 paultyng reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@paultyng](https://avatars.githubusercontent.com/u/422474?s=80&u=db482cdd9177b3f7950797bd16afbfac0888085e&v=4)](/paultyng)

Copy link

Contributor

### **[paultyng](/paultyng)** commented [Mar 27, 2018](#issuecomment-376598658) ‚Ä¢ edited Loading

| I think the main issue with that package is that it allows for too many special characters, IAM only allows for `! @ # $ % ^ & * ( ) _ + - = [ ] { } | '` per <https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html#password-policy-details>  vs [in the package](https://github.com/sethvargo/go-password/blob/master/password/generate.go#L30):  ``` Symbols = "~!@#$%^&*()_+`-={}|[]\\:\"<>?,./" ```  So possibly would need to fork that I guess to HC? |
| --- |

All reactions

Sorry, something went wrong.

 [![@paultyng](https://avatars.githubusercontent.com/u/422474?s=40&u=db482cdd9177b3f7950797bd16afbfac0888085e&v=4)](/paultyng)
[paultyng](/paultyng)
dismissed
[jbardin](/jbardin)‚Äôs [stale review](#pullrequestreview-107348325)
[March 27, 2018 17:37](#event-1543815578)

Needs to satisfy the password policy issues mentioned above

[![paultyng](https://avatars.githubusercontent.com/u/422474?s=60&v=4)](/paultyng)

**[paultyng](/paultyng)**
previously requested changes
[Mar 27, 2018](#pullrequestreview-107399513)

 [View reviewed changes](/hashicorp/terraform-provider-aws/pull/3934/files/51ab8162ebc33a3412bf1febcd2d292c2ecdc8e3)

[aws/resource\_aws\_iam\_user\_login\_profile.go](/hashicorp/terraform-provider-aws/pull/3934/files/51ab8162ebc33a3412bf1febcd2d292c2ecdc8e3#diff-3877dd21320621968897ed1115cca1b9badba2be6bb75a2502e70c9aad63b104)
Outdated

|  |  | } |
| --- | --- | --- |
|  |  | charset := `abcdefghijklmnopqrstuvwxyz |
|  |  | ABCDEFGHIJKLMNOPQRSTUVWXYZ |
|  |  | 012346789 |

Copy link

Contributor

### @paultyng **[paultyng](/paultyng)** [Mar 27, 2018](#discussion_r177514890) ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

üò¢ this is missing 5

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @paultyng **[paultyng](/paultyng)** [Mar 27, 2018](#discussion_r177515379)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I guess that was missed quite a while ago :(

Sorry, something went wrong.

All reactions

[![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=40&v=4)](/KellerFuchs)

`[generatePassword(): Add the missing 5](/hashicorp/terraform-provider-aws/pull/3934/commits/c67b24b65d4a47e63aa250d024939ec993c930eb "generatePassword(): Add the missing 5

Thanks to @paultyng for the catch.")`
 ‚Ä¶

`[c67b24b](/hashicorp/terraform-provider-aws/pull/3934/commits/c67b24b65d4a47e63aa250d024939ec993c930eb)`

```
Thanks to [@paultyng](https://github.com/paultyng) for the catch.
```

![@ghost](https://avatars.githubusercontent.com/u/10137?s=32&v=4)
**ghost**
added
the
[size/M](/hashicorp/terraform-provider-aws/labels/size/M)
Managed by automation to categorize the size of a PR.
label
[Mar 27, 2018](#event-1543973978)

 [![@paultyng](https://avatars.githubusercontent.com/u/422474?s=40&u=db482cdd9177b3f7950797bd16afbfac0888085e&v=4)](/paultyng)
[paultyng](/paultyng)
dismissed
their [stale review](#pullrequestreview-107399513)
[March 27, 2018 18:57](#event-1543986445)

5 added

[![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=80&u=9607b8b970e57b7063ca7abf8bbf58ef704eb286&v=4)](/KellerFuchs)

Copy link

Contributor

Author

### **[KellerFuchs](/KellerFuchs)** commented [Mar 27, 2018](#issuecomment-376637168) ‚Ä¢ edited Loading

| [@paultyng](https://github.com/paultyng) FWIW, the core of `go-password` does pretty much the same thing as this: return a random element (as in, the element at a random index) from a ‚Äúcharset‚Äù buffer, and fill another buffer with the result, then return it as a string.  It does rejection sampling around that, to enforce ‚Äúat least x {alphanum; symbols; ...}‚Äù constraints, but as far as I understand it's not needed here? If it *really* is, rejection sampling is the way to go, but that sort of policy can dangerousely reduce password entropy (and, BTW, NIST also advises against it). |
| --- |

All reactions

Sorry, something went wrong.

[![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=40&v=4)](/KellerFuchs)

`[Picking all the nits from](/hashicorp/terraform-provider-aws/pull/3934/commits/e7ca4b6a26bdb3f1f90ac0f054d3af562f95718b "Picking all the nits from @jbardin") [@jbardin](https://github.com/jbardin)`

`[e7ca4b6](/hashicorp/terraform-provider-aws/pull/3934/commits/e7ca4b6a26bdb3f1f90ac0f054d3af562f95718b)`

![@ghost](https://avatars.githubusercontent.com/u/10137?s=32&v=4)
**ghost**
added
the
[size/M](/hashicorp/terraform-provider-aws/labels/size/M)
Managed by automation to categorize the size of a PR.
label
[Mar 27, 2018](#event-1544040596)

[![@jbardin](https://avatars.githubusercontent.com/u/35067?s=80&u=378390a987ace0ce8cb7eb7f46ae4d1bd4bd44dc&v=4)](/jbardin)

Copy link

Member

### **[jbardin](/jbardin)** commented [Mar 27, 2018](#issuecomment-376649638)

| Thanks [@KellerFuchs](https://github.com/KellerFuchs),  I'm also not strongly in favor of the go-password algorithm, since it only inserts a set number of "optional" characters, meaning you don't get much additional entropy as from a normal distribution. I'm OK with rejection sampling of the results in this case, since we have no choice but to conform to the set policy in some way.  Thanks! |
| --- |

All reactions

Sorry, something went wrong.

[![@paultyng](https://avatars.githubusercontent.com/u/422474?s=80&u=db482cdd9177b3f7950797bd16afbfac0888085e&v=4)](/paultyng)

Copy link

Contributor

### **[paultyng](/paultyng)** commented [Mar 27, 2018](#issuecomment-376705164)

| In this case we are unfortunately at the mercy of how IAM is configured, but it is possible to query IAM to see what the policy is before forcing the rejections.  <https://docs.aws.amazon.com/sdk-for-go/api/service/iam/#IAM.GetAccountPasswordPolicy> |
| --- |

All reactions

Sorry, something went wrong.

[![mwhooker](https://avatars.githubusercontent.com/u/15618?s=60&v=4)](/mwhooker)

**[mwhooker](/mwhooker)**
reviewed
[Mar 28, 2018](#pullrequestreview-107544168)

 [View reviewed changes](/hashicorp/terraform-provider-aws/pull/3934/files/e7ca4b6a26bdb3f1f90ac0f054d3af562f95718b)

[aws/resource\_aws\_iam\_user\_login\_profile.go](/hashicorp/terraform-provider-aws/pull/3934/files/e7ca4b6a26bdb3f1f90ac0f054d3af562f95718b#diff-3877dd21320621968897ed1115cca1b9badba2be6bb75a2502e70c9aad63b104)

|  |  | charset := `abcdefghijklmnopqrstuvwxyz |
| --- | --- | --- |
|  |  | ABCDEFGHIJKLMNOPQRSTUVWXYZ |
|  |  | 0123456789 |
|  |  | !@#$%^&\*()\_+-=[]{}|'` |

Copy link

### @mwhooker **[mwhooker](/mwhooker)** [Mar 28, 2018](#discussion_r177638248)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I think you may want to make this something like

```
	charsets := strings.Join([]string{
		"abcdefghijklmnopqrstuvwxyz",
		"ABCDEFGHIJKLMNOPQRSTUVWXYZ",
		"012346789",
		"!@#$%^&*()_+-=[]{}|'",
	}, "")

```

since this has 3 newlines in it

<https://play.golang.org/p/UkuPLAvmbuS>

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @KellerFuchs **[KellerFuchs](/KellerFuchs)** [Mar 29, 2018](#discussion_r178127113) ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Oops, thanks a lot.

I did pretty much what you did to test, but got ‚Äúluckier‚Äù (and had a larger non-`\n` charset) :/

Sorry, something went wrong.

All reactions

[![@bflad](https://avatars.githubusercontent.com/u/189114?s=40&v=4)](/bflad)
[bflad](/bflad)
added this to the [v1.14.0](/hashicorp/terraform-provider-aws/milestone/16) milestone
[Mar 29, 2018](#event-1548021817)

[![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=80&u=9607b8b970e57b7063ca7abf8bbf58ef704eb286&v=4)](/KellerFuchs)

Copy link

Contributor

Author

### **[KellerFuchs](/KellerFuchs)** commented [Mar 29, 2018](#issuecomment-377310700) ‚Ä¢ edited Loading

| Sorry for the slow replies, my laptop died earlier in the week so it took a while to be back online. FYI, this issue was assigned [CVE-2018-9057](https://github.com/advisories/GHSA-r48h-jr2j-9g78 "CVE-2018-9057"). |
| --- |

All reactions

Sorry, something went wrong.

[![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=80&u=9607b8b970e57b7063ca7abf8bbf58ef704eb286&v=4)](/KellerFuchs)

Copy link

Contributor

Author

### **[KellerFuchs](/KellerFuchs)** commented [Mar 29, 2018](#issuecomment-377311694)

| [@paultyng](https://github.com/paultyng) As far as I understand, there is no default password policy, and users setting one can break the current code too? If that's correct, shouldn't that go in a separate issue? |
| --- |

All reactions

Sorry, something went wrong.

[![@jbardin](https://avatars.githubusercontent.com/u/35067?s=80&u=378390a987ace0ce8cb7eb7f46ae4d1bd4bd44dc&v=4)](/jbardin)

Copy link

Member

### **[jbardin](/jbardin)** commented [Mar 29, 2018](#issuecomment-377313431)

| [@KellerFuchs](https://github.com/KellerFuchs),  No worries, thanks for the update.  Yes, the only default in the policy is the minimum length of 6, and this particular PR doesn't need to deal with the policy directly. The old code would probably pass any reasonable policy, but that was at the expense of not generating good passwords. I'll follow up with a separate PR regarding the policy checks. |
| --- |

All reactions

Sorry, something went wrong.

[![@jbardin](https://avatars.githubusercontent.com/u/35067?s=80&u=378390a987ace0ce8cb7eb7f46ae4d1bd4bd44dc&v=4)](/jbardin)

Copy link

Member

### **[jbardin](/jbardin)** commented [Mar 29, 2018](#issuecomment-377339252)

| Hi [@KellerFuchs](https://github.com/KellerFuchs),  Thanks again for your work on this. Since the charset needed to be updated, I moved your commit into a new branch and made the modifications there, along with the policy checking. The new PR is [#3989](https://github.com/hashicorp/terraform-provider-aws/pull/3989).  Closing this since it's been superseded. |
| --- |

All reactions

Sorry, something went wrong.

[![@jbardin](https://avatars.githubusercontent.com/u/35067?s=40&u=378390a987ace0ce8cb7eb7f46ae4d1bd4bd44dc&v=4)](/jbardin)
[jbardin](/jbardin)
closed this
[Mar 29, 2018](#event-1548584340)

[![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=80&u=9607b8b970e57b7063ca7abf8bbf58ef704eb286&v=4)](/KellerFuchs)

Copy link

Contributor

Author

### **[KellerFuchs](/KellerFuchs)** commented [Mar 29, 2018](#issuecomment-377357944)

| [@jbardin](https://github.com/jbardin) Am I misunderstanding something, or is [#3989](https://github.com/hashicorp/terraform-provider-aws/pull/3989) meant to does with the case where there is a password policy set? If so, please reopen, so we can get the security-relevant bits actually merged and deployed, and keep the work on the other issue (not checking and conforming to password policies) in [#3989](https://github.com/hashicorp/terraform-provider-aws/pull/3989) |
| --- |

All reactions

Sorry, something went wrong.

[![@jbardin](https://avatars.githubusercontent.com/u/35067?s=80&u=378390a987ace0ce8cb7eb7f46ae4d1bd4bd44dc&v=4)](/jbardin)

Copy link

Member

### **[jbardin](/jbardin)** commented [Mar 29, 2018](#issuecomment-377360965)

| [@KellerFuchs](https://github.com/KellerFuchs), we are intending to merge the security related commit and the policy checks together to prevent breaking existing users. The policy work isn't going to delay the release. |
| --- |

All reactions

Sorry, something went wrong.

[![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=80&u=9607b8b970e57b7063ca7abf8bbf58ef704eb286&v=4)](/KellerFuchs)

Copy link

Contributor

Author

### **[KellerFuchs](/KellerFuchs)** commented [Mar 29, 2018](#issuecomment-377361298)

| Mkay |
| --- |

All reactions

Sorry, something went wrong.

[![@ghost](https://avatars.githubusercontent.com/u/10137?s=80&v=4)](/ghost)

Copy link

### **[ghost](/ghost)** commented [Apr 7, 2020](#issuecomment-610511725)

| I'm going to lock this issue because it has been closed for *30 days* ‚è≥. This helps our maintainers find and focus on the active issues.  If you feel this issue should be reopened, we encourage creating a new issue linking back to this one for added context. Thanks! |
| --- |

All reactions

Sorry, something went wrong.

![@ghost](https://avatars.githubusercontent.com/u/10137?s=32&v=4)
**ghost**
locked and limited conversation to collaborators
[Apr 7, 2020](#event-3210837400)

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhashicorp%2Fterraform-provider-aws%2Fpull%2F3934).

Reviewers

[![@RyanSquared](https://avatars.githubusercontent.com/u/12415837?s=40&v=4)](/RyanSquared) [RyanSquared](/RyanSquared)

RyanSquared left review comments

[![@paultyng](https://avatars.githubusercontent.com/u/422474?s=40&v=4)](/paultyng) [paultyng](/paultyng)

paultyng left review comments

[![@mwhooker](https://avatars.githubusercontent.com/u/15618?s=40&v=4)](/mwhooker) [mwhooker](/mwhooker)

mwhooker left review comments

[![@jbardin](https://avatars.githubusercontent.com/u/35067?s=40&v=4)](/jbardin) [jbardin](/jbardin)

jbardin left review comments

Assignees

No one assigned

Labels

[service/iam](/hashicorp/terraform-provider-aws/labels/service/iam)
Issues and PRs that pertain to the iam service.
[size/M](/hashicorp/terraform-provider-aws/labels/size/M)
Managed by automation to categorize the size of a PR.

Projects

None yet

Milestone

 [**v1.14.0**](/hashicorp/terraform-provider-aws/milestone/16 "v1.14.0")

Development

Successfully merging this pull request may close these issues.

6 participants

[![@KellerFuchs](https://avatars.githubusercontent.com/u/14331571?s=52&v=4)](/KellerFuchs) [![@jbardin](https://avatars.githubusercontent.com/u/35067?s=52&v=4)](/jbardin) [![@paultyng](https://avatars.githubusercontent.com/u/422474?s=52&v=4)](/paultyng) [![@mwhooker](https://avatars.githubusercontent.com/u/15618?s=52&v=4)](/mwhooker) [![@RyanSquared](https://avatars.githubusercontent.com/u/12415837?s=52&v=4)](/RyanSquared) [![@bflad](https://avatars.githubusercontent.com/u/189114?s=52&v=4)](/bflad)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_b15caca0_20250126_125149.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-r48h-jr2j-9g78)

**CVE-2018-9057**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-r48h-jr2j-9g78)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2018-9057](/advisories/GHSA-r48h-jr2j-9g78)

## HashiCorp Terraform Amazon Web Services (AWS) uses an insecure PRNG

Critical severity

GitHub Reviewed

Published
May 14, 2022
to the GitHub Advisory Database
‚Ä¢
Updated Feb 21, 2024

[Vulnerability details](/advisories/GHSA-r48h-jr2j-9g78)
[Dependabot alerts
0](/advisories/GHSA-r48h-jr2j-9g78/dependabot)

## Package

gomod

github.com/hashicorp/terraform-provider-aws
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

< 1.14.0

## Patched versions

1.14.0

## Description

aws/resource\_aws\_iam\_user\_login\_profile.go in the HashiCorp Terraform Amazon Web Services (AWS) provider through v1.12.0 has an inappropriate PRNG algorithm and seeding, which makes it easier for remote attackers to obtain access by leveraging an IAM account that was provisioned with a weak password.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2018-9057>
* [hashicorp/terraform-provider-aws#3934](https://github.com/hashicorp/terraform-provider-aws/pull/3934)
* [hashicorp/terraform-provider-aws#3934](https://github.com/hashicorp/terraform-provider-aws/pull/3934)
* [hashicorp/terraform-provider-aws#3989](https://github.com/hashicorp/terraform-provider-aws/pull/3989)
* [hashicorp/terraform-provider-aws@efa8cd4](https://github.com/hashicorp/terraform-provider-aws/commit/efa8cd45c6484ff70b2a515ea7ff06f2459d4ddf)
* <https://github.com/hashicorp/terraform-provider-aws/blob/02b039aa82dd7fc6e4a97a0922cc5dbbab724021/resource_aws_iam_user_login_profile.go#L70-L80>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2018-9057)
Mar 27, 2018

Published to the GitHub Advisory Database
May 14, 2022

Reviewed
Feb 21, 2024

Last updated
Feb 21, 2024

### Severity

Critical

9.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

### EPSS score

0.683%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (80th percentile)

### Weaknesses

[CWE-332](/advisories?query=cwe%3A332)

### CVE ID

CVE-2018-9057

### GHSA ID

GHSA-r48h-jr2j-9g78

### Source code

[hashicorp/terraform-provider-aws](https://github.com/hashicorp/terraform-provider-aws)

### Credits

* [![@iann0036](https://avatars.githubusercontent.com/u/4401744?s=40&v=4)](/iann0036)
  [iann0036](/iann0036)
  Analyst

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-r48h-jr2j-9g78/improve).

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


