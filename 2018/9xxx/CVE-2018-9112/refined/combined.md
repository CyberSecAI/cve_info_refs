=== Content from gist.github.com_b759389b_20250124_221445.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FChuanYuan-Huang%2Fa92b8b32980123d5fa9bf5a8299114bf)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FChuanYuan-Huang%2Fa92b8b32980123d5fa9bf5a8299114bf&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FChuanYuan-Huang%2Fa92b8b32980123d5fa9bf5a8299114bf) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FChuanYuan-Huang%2Fa92b8b32980123d5fa9bf5a8299114bf&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@ChuanYuan-Huang](https://avatars.githubusercontent.com/u/36685098?s=64&v=4)](/ChuanYuan-Huang)

# [ChuanYuan-Huang](/ChuanYuan-Huang)/**[CVE-2018-9111 and CVE-2018-9112.md](/ChuanYuan-Huang/a92b8b32980123d5fa9bf5a8299114bf)**

Created
May 10, 2018 01:14

Show Gist options

* [Download ZIP](/ChuanYuan-Huang/a92b8b32980123d5fa9bf5a8299114bf/archive/a214ec0b26704d6c9ba0922bcb11f4f00d539446.zip)

* [Star
  1
  (1)](/login?return_to=https%3A%2F%2Fgist.github.com%2FChuanYuan-Huang%2Fa92b8b32980123d5fa9bf5a8299114bf)You must be signed in to star a gist
* [Fork
  0
  (0)](/login?return_to=https%3A%2F%2Fgist.github.com%2FChuanYuan-Huang%2Fa92b8b32980123d5fa9bf5a8299114bf)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/ChuanYuan-Huang/a92b8b32980123d5fa9bf5a8299114bf.js&quot;&gt;&lt;/script&gt;
* Save ChuanYuan-Huang/a92b8b32980123d5fa9bf5a8299114bf to your computer and use it in GitHub Desktop.

[Code](/ChuanYuan-Huang/a92b8b32980123d5fa9bf5a8299114bf)
[Revisions
1](/ChuanYuan-Huang/a92b8b32980123d5fa9bf5a8299114bf/revisions)
[Stars
1](/ChuanYuan-Huang/a92b8b32980123d5fa9bf5a8299114bf/stargazers)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/ChuanYuan-Huang/a92b8b32980123d5fa9bf5a8299114bf.js&quot;&gt;&lt;/script&gt;

Save ChuanYuan-Huang/a92b8b32980123d5fa9bf5a8299114bf to your computer and use it in GitHub Desktop.

[Download ZIP](/ChuanYuan-Huang/a92b8b32980123d5fa9bf5a8299114bf/archive/a214ec0b26704d6c9ba0922bcb11f4f00d539446.zip)

CVE-2018-9111 and CVE-2018-9112 Foxconn FEMTO XSS and without Validation and Integrity Checking

 [Raw](/ChuanYuan-Huang/a92b8b32980123d5fa9bf5a8299114bf/raw/a214ec0b26704d6c9ba0922bcb11f4f00d539446/CVE-2018-9111%2520and%2520CVE-2018-9112.md)

[**CVE-2018-9111 and CVE-2018-9112.md**](#file-cve-2018-9111-and-cve-2018-9112-md)

# ***CVE-2018-9111***

## [Suggested description] Cross Site Scripting (XSS) exists on the Foxconn FEMTO AP-FC4064-T AP\_GT\_B38\_5.8.3lb15-W47 LTE Build 15 via the configuration of a user account. An attacker can execute arbitrary script on an unsuspecting user's browser.

## [Vulnerability Type] Cross Site Scripting (XSS)

[Vendor of Product]
Foxconn Electronics Inc.

---

[Affected Product Code Base]
FEMTO AP-FC4064-T - AP\_GT\_B38\_5.8.3lb15-W47 LTE Build 15

---

## [Affected Component] Web management page

## [Attack Type] Remote

[Impact Code execution]
true

---

[Discoverer]
CFL Lab

# ***CVE-2018-9112***

[Suggested description]
A low privileged account with a weak default password exists on the Foxconn FEMTO AP-FC4064-T AP\_GT\_B38\_5.8.3lb15-W47 LTE Build
15. In addition, its web management page relies on the existence or values of cookies when performing security-critical operations. One can gain privileges by modifying cookies.

---

## [VulnerabilityType Other] CWE-565: Reliance on Cookies without Validation and Integrity Checking

[Vendor of Product]
Foxconn Electronics Inc.

---

[Affected Product Code Base]
FEMTO AP-FC4064-T - AP\_GT\_B38\_5.8.3lb15-W47 LTE Build 15

---

## [Affected Component] affect whole web management page

[Attack Type]
Remote

---

[Impact Escalation of Privileges]
true

---

## [Attack Vectors] modify cookies.

[Discoverer]
CFL Lab

[![@ChuanYuan-Huang](https://avatars.githubusercontent.com/u/36685098?s=80&v=4)](/ChuanYuan-Huang)

Copy link

Author

### **[ChuanYuan-Huang](/ChuanYuan-Huang)** commented [May 10, 2018](/ChuanYuan-Huang/a92b8b32980123d5fa9bf5a8299114bf?permalink_comment_id=2584443#gistcomment-2584443)

When login into the web interface of Foxconn FEMTO AP-FC4064-T AP\_GT\_B38\_5.8.3lb15-W47 LTE Build 15 there had Cross Site Scripting occur.

The attacker can input some html code to cause Cross Site Scripting.

亞太電信的魔速方塊是由鴻海集團所製造的毫微微型基地台，在FEMTO AP-FC4064-T AP\_GT\_B38\_5.8.3lb15-W47 LTE Build 15此版韌體中，發現有跨站腳本攻擊的現象發生。

[![001](https://user-images.githubusercontent.com/36685098/39847161-b5c48ce2-5432-11e8-9d6f-d291d86a4bdb.jpg)](https://user-images.githubusercontent.com/36685098/39847161-b5c48ce2-5432-11e8-9d6f-d291d86a4bdb.jpg)

[![002](https://user-images.githubusercontent.com/36685098/39847165-baa8fd4c-5432-11e8-842a-f53ee86a4ec0.png)](https://user-images.githubusercontent.com/36685098/39847165-baa8fd4c-5432-11e8-842a-f53ee86a4ec0.png)

A low privileged account with a weak default password exists on the Foxconn FEMTO AP-FC4064-T AP\_GT\_B38\_5.8.3lb15-W47 LTE Build 15. In addition, its web management page relies on the existence or values of cookies when performing security-critical operations. One can gain privileges by modifying cookies.

在亞太電信魔速方塊版本FEMTO AP-FC4064-T AP\_GT\_B38\_5.8.3lb15-W47 LTE Build 15中，存在著一個風險，有心人士可以藉由低權限的網頁管理帳號透過更改cookies提權至高權限的管理帳號。在此案例中，使用者可以輸入預設低權限的帳號「admin/admin」登入系統。

There had some accounts with different privileges on the Foxconn FEMTO AP-FC4064-T AP\_GT\_B38\_5.8.3lb15-W47 LTE Build 15.

The account “admin” with low privileges of the web interface.

The account “foxconn” with highest privileges of the web interface.

Use “admin” to login. (admin/admin)

[![003](https://user-images.githubusercontent.com/36685098/39847182-d3557c62-5432-11e8-8231-7326c2dc6329.png)](https://user-images.githubusercontent.com/36685098/39847182-d3557c62-5432-11e8-8231-7326c2dc6329.png)

We can see the account “admin” can read some config data, but it could not modify any setting here.

雖然叫做「admin」但是實際上只能觀看網頁內容，不能修改任何參數。

[![004](https://user-images.githubusercontent.com/36685098/39847205-ec67732c-5432-11e8-9270-443d662ef55c.png)](https://user-images.githubusercontent.com/36685098/39847205-ec67732c-5432-11e8-9270-443d662ef55c.png)

[![005](https://user-images.githubusercontent.com/36685098/39847209-f11ae1a6-5432-11e8-9ce4-ad8dce72adff.png)](https://user-images.githubusercontent.com/36685098/39847209-f11ae1a6-5432-11e8-9ce4-ad8dce72adff.png)

Then we use the account “foxconn” to login. We can see some difference between “admin”.

接著我們使用網頁管理介面最高權限帳號「foxconn」登入，網頁中顯示的內容較「admin」登入時多出許多。使用該帳號確實能更改裡面的參數。

[![006](https://user-images.githubusercontent.com/36685098/39847230-081d6072-5433-11e8-9aa8-6754b8d580a7.png)](https://user-images.githubusercontent.com/36685098/39847230-081d6072-5433-11e8-9aa8-6754b8d580a7.png)

And we can do some change with the config data just like …

[![007](https://user-images.githubusercontent.com/36685098/39847241-19ed2936-5433-11e8-8e3f-09f185c37f43.png)](https://user-images.githubusercontent.com/36685098/39847241-19ed2936-5433-11e8-8e3f-09f185c37f43.png)

We can see the Cookie which is using “admin” to login.

以下是使用帳號「admin」登入的封包內容。

[![008](https://user-images.githubusercontent.com/36685098/39847254-2c73f0e4-5433-11e8-911d-c7bac7efbc8a.png)](https://user-images.githubusercontent.com/36685098/39847254-2c73f0e4-5433-11e8-911d-c7bac7efbc8a.png)

And this one is using “foxconn” to login

以下是使用帳號「foxconn」登入的封包內容。

[![009](https://user-images.githubusercontent.com/36685098/39847271-3fc6f128-5433-11e8-9274-174e166c441a.png)](https://user-images.githubusercontent.com/36685098/39847271-3fc6f128-5433-11e8-9274-174e166c441a.png)

I guess it maybe not had any identification to check the accounts. So I gain privileges by modifying cookies. (Mode=low => Mode=ENG)

本團隊猜測此設備應無除密碼外對設備帳號的辨識方式，故將登入時的封包內容進行修改。(Mode=low => Mode=ENG)

[![010](https://user-images.githubusercontent.com/36685098/39847292-5dab1d36-5433-11e8-99b0-a4b75906be3c.png)](https://user-images.githubusercontent.com/36685098/39847292-5dab1d36-5433-11e8-99b0-a4b75906be3c.png)

[![011](https://user-images.githubusercontent.com/36685098/39847294-614b3462-5433-11e8-9f75-95c92fde62c8.png)](https://user-images.githubusercontent.com/36685098/39847294-614b3462-5433-11e8-9f75-95c92fde62c8.png)

[![012](https://user-images.githubusercontent.com/36685098/39847298-64179618-5433-11e8-97b4-4bbe1cf76e1c.png)](https://user-images.githubusercontent.com/36685098/39847298-64179618-5433-11e8-97b4-4bbe1cf76e1c.png)

最後證實該設備確實只透過更改cookie的方式就提權至高權限帳號，然後在先前本團隊提報的[CVE-2018-6312](https://github.com/advisories/GHSA-5vvc-wv25-82fx "CVE-2018-6312")部分就不用再透過任何字典檔攻擊猜測最高權限使用者的密碼。通報亞太電信後，亞太電信第一時間也積極處理相關資安的議題。

Finally, although I use low privilege account “admin” to login, but I can gain privileges by modifying cookies.

And it also can used in the situation [CVE-2018-6312](https://github.com/advisories/GHSA-5vvc-wv25-82fx "CVE-2018-6312") that we had posted before.

[CVE-2018-6312](https://github.com/advisories/GHSA-5vvc-wv25-82fx "CVE-2018-6312")： <https://gist.github.com/DrmnSamoLiu/cd1d6fa59501f161616686296aa4a6c8>

The attacker can just use 「admin/admin」to get the target’s root privilege without using brute-force attack to get higest privilege account “foxconn”’s password.

After reporting to APTG and Foxconn, they released a patch within a week and resolved these problems.

-CFL Lab

Sorry, something went wrong.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2FChuanYuan-Huang%2Fa92b8b32980123d5fa9bf5a8299114bf)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from avatars.githubusercontent.com_433d67e5_20250126_040145.html ===
�PNG

   
IHDR  �  �   �.�b  �IDATx���A��@@��\* �"�����ǆ���r݋�[��@�T�O�9������^ `��H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A������c?W�p���Z�܈/; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; �1Ƙ3���9��{yo� S�f|�9G��+��܈>c���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; �z�{;�s�
����1�X��]}�载V�p%7��g,� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$<�s&�9gp/��5a��� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�c��z��:�s�
�{o��+\ɍ���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A��c��; �:/; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; �\_   ��#�6�� (    IEND�B`�
