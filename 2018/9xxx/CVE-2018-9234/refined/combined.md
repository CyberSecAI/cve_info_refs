=== Content from files.gnupg.net_84331c53_20250126_074148.html ===
diff --git a/g10/sig-check.c b/g10/sig-check.c
index 23af12b2e..ab8bd66a4 100644
--- a/g10/sig-check.c
+++ b/g10/sig-check.c
@@ -1140,9 +1140,16 @@ check\_key\_signature2 (ctrl\_t ctrl,
/\* Certification revocation. \*/
|| sig->sig\_class == 0x30)
{
- kbnode\_t unode = find\_prev\_kbnode (root, node, PKT\_USER\_ID);
+ kbnode\_t unode = find\_prev\_kbnode (root, node, PKT\_USER\_ID);
- if (unode)
+ if (!(pk->pubkey\_usage & PUBKEY\_USAGE\_CERT))
+ {
+ if (!opt.quiet)
+ log\_info ("certified by incapable key (%s)", keystr\_from\_pk(pk));
+ rc = gpg\_error (GPG\_ERR\_WRONG\_KEY\_USAGE);
+ }
+
+ if (unode)
{
rc = check\_signature\_metadata\_validity (pk, sig, r\_expired, NULL);
if (! rc)
@@ -1154,13 +1161,13 @@ check\_key\_signature2 (ctrl\_t ctrl,
sig, root, unode->pkt, NULL, ret\_pk);
}
}
- else
- {
+ else
+ {
if (!opt.quiet)
- log\_info ("key %s: no user ID for key signature packet"
- " of class %02x\n",keystr\_from\_pk(pk),sig->sig\_class);
- rc = GPG\_ERR\_SIG\_CLASS;
- }
+ log\_info ("key %s: no user ID for key signature packet"
+ " of class %02x\n",keystr\_from\_pk(pk),sig->sig\_class);
+ rc = gpg\_error (GPG\_ERR\_SIG\_CLASS);
+ }
}
else
{


=== Content from dev.gnupg.org_41bf1832_20250125_090250.html ===
Page Menu[Home GnuPG](/)

* SearchConfigure Global Search

[Log In](/auth/start/?next=%2FT3844)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T3844
# Able to certify public keys without a certify key present when using smartcard.Closed, Resolved[Public](/policy/explain/PHID-TASK-fj4y7x7da7vmlk44t22i/view/)Actions

* [Edit Task](/maniphest/task/edit/3844/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/edit/form/1/?parent=3844&template=3844&status=open)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-fj4y7x7da7vmlk44t22i/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-fj4y7x7da7vmlk44t22i/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-fj4y7x7da7vmlk44t22i/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-fj4y7x7da7vmlk44t22i/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-fj4y7x7da7vmlk44t22i/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-fj4y7x7da7vmlk44t22i/)
* [Edit Revisions](/search/rel/task.has-revision/PHID-TASK-fj4y7x7da7vmlk44t22i/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-fj4y7x7da7vmlk44t22i/)
* [Award Token](/token/give/PHID-TASK-fj4y7x7da7vmlk44t22i/)

Assigned To

|  | [• gniibe](/p/gniibe/) |
| --- | --- |

Authored By

|  | [lrvick](/p/lrvick/) |
| --- | --- |
| Mar 19 2018, 3:05 AM2018-03-19 03:05:54 (UTC+1) |

Tags

* [Bug Report](/tag/bug_report/)
* [gnupg (gpg22)](/tag/gpg22/) [(Backlog)](/project/board/61/)
Subscribers

|  | [bcl](/p/bcl/) |
| --- | --- |

|  | [dkg](/p/dkg/) |
| --- | --- |

|  | [lrvick](/p/lrvick/) |
| --- | --- |

|  | [• werner](/p/werner/) |
| --- | --- |

# Description

When using a GnuPG smartcard in 2.2.4+ with an offline master [C]ertify key, it is possible to sign the keys of others with only a [S]igning subkey present.

Once a key has been erroneously signed and pushed to keyservers in this way, gpg won't allow it to be signed again correctly with the master key, claiming it is already signed.

Was able to reproduce on 2.2.4 on Arch Linux and 2.2.5 on OSX Sierra with a Yubikey 4 and RSA4096 subkeys and Yubikey Neo with RSA2048 subkeys. Also reproduced with pcscd and with gpg built-in scdaemon.

Example:

```
[lrvick@kephel ~]$ gpg --version
gpg (GnuPG) 2.2.4
libgcrypt 1.8.2
Copyright (C) 2017 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <https://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Home: /home/lrvick/.gnupg
Supported algorithms:
Pubkey: RSA, ELG, DSA, ECDH, ECDSA, EDDSA
Cipher: IDEA, 3DES, CAST5, BLOWFISH, AES, AES192, AES256, TWOFISH,
        CAMELLIA128, CAMELLIA192, CAMELLIA256
Hash: SHA1, RIPEMD160, SHA256, SHA384, SHA512, SHA224
Compression: Uncompressed, ZIP, ZLIB, BZIP2
[lrvick@kephel ~]$ gpg --card-status

Reader ...........: 1050:0407:X:0
Application ID ...: D2760001240102010006057635220000
Version ..........: 2.1
Manufacturer .....: Yubico
Serial number ....: 05763522
Name of cardholder: Lance Vick
Language prefs ...: en
Sex ..............: male
URL of public key : https://lrvick.net/0x36C8AAA9.asc
Login data .......: lrvick
Signature PIN ....: not forced
Key attributes ...: rsa4096 rsa4096 rsa4096
Max. PIN lengths .: 127 127 127
PIN retry counter : 3 0 3
Signature counter : 390
Signature key ....: 6755 3FBD A46B B71A BD2E  0B0B 8E47 A1EC 35A1 551D
      created ....: 2016-02-15 00:49:42
Encryption key....: 54BA 9099 5CCB D6D6 B0E6  8D27 CDAB 3CCD A649 FFDA
      created ....: 2009-05-09 02:05:34
Authentication key: 4654 2022 DCA1 27AD 42D8  B9FE 6C1F 8F1D 4D08 A9A6
      created ....: 2015-02-01 08:16:59
General key info..: sub  rsa4096/8E47A1EC35A1551D 2016-02-15 Lance R. Vick (Personal) <lance@lrvick.net>
sec#  rsa4096/E90A401336C8AAA9  created: 2009-05-09  expires: 2018-07-03
ssb#  rsa2048/8D5B2F41F66444E5  created: 2015-03-19  expires: 2018-05-29
ssb#  rsa2048/530106BDD94A0B8A  created: 2015-03-19  expires: 2018-05-29
ssb#  rsa2048/D362694AF189271D  created: 2015-03-19  expires: 2018-05-29
ssb>  rsa4096/CDAB3CCDA649FFDA  created: 2009-05-09  expires: 2018-07-03
                                card-no: 0006 05763522
ssb>  rsa4096/6C1F8F1D4D08A9A6  created: 2015-02-01  expires: 2018-07-03
                                card-no: 0006 05763522
ssb>  rsa4096/8E47A1EC35A1551D  created: 2016-02-15  expires: 2018-07-03
                                card-no: 0006 05763522
[lrvick@kephel ~]$ gpg --list-secret-keys lance@lrvick.net
sec#  rsa4096 2009-05-09 [SC] [expires: 2018-07-03]
      6B61ECD76088748C70590D55E90A401336C8AAA9
uid           [ultimate] Lance R. Vick (Personal) <lance@lrvick.net>
uid           [ultimate] [jpeg image of size 6119]
uid           [ultimate] Lance R. Vick (Work) <lance@bitgo.com>
ssb#  rsa2048 2015-03-19 [S] [expires: 2018-05-29]
ssb#  rsa2048 2015-03-19 [E] [expires: 2018-05-29]
ssb#  rsa2048 2015-03-19 [A] [expires: 2018-05-29]
ssb>  rsa4096 2009-05-09 [E] [expires: 2018-07-03]
ssb>  rsa4096 2015-02-01 [A] [expires: 2018-07-03]
ssb>  rsa4096 2016-02-15 [S] [expires: 2018-07-03]

[lrvick@kephel ~]$ gpg --list-keys john@doe.com
pub   rsa2048 2018-03-10 [SC] [expires: 2020-03-09]
      691D9AC876EAABBC0AFA5403DF5E676BBF2D7AE8
uid           [ultimate] John Doe <john@doe.com>
sub   rsa2048 2018-03-10 [E] [expires: 2020-03-09]

[lrvick@kephel ~]$ gpg --sign-key 691D9AC876EAABBC0AFA5403DF5E676BBF2D7AE8

sec  rsa2048/DF5E676BBF2D7AE8
     created: 2018-03-10  expires: 2020-03-09  usage: SC
     trust: ultimate      validity: ultimate
ssb  rsa2048/02E38722C42DA22F
     created: 2018-03-10  expires: 2020-03-09  usage: E
[ultimate] (1). John Doe <john@doe.com>

sec  rsa2048/DF5E676BBF2D7AE8
     created: 2018-03-10  expires: 2020-03-09  usage: SC
     trust: ultimate      validity: ultimate
 Primary key fingerprint: 691D 9AC8 76EA ABBC 0AFA  5403 DF5E 676B BF2D 7AE8

     John Doe <john@doe.com>

This key is due to expire on 2020-03-09.
Are you sure that you want to sign this key with your
key "Lance R. Vick (Personal) <lance@lrvick.net>" (8E47A1EC35A1551D)

Really sign? (y/N) y

[lrvick@kephel ~]$ gpg --list-sigs 691D9AC876EAABBC0AFA5403DF5E676BBF2D7AE8
pub   rsa2048 2018-03-10 [SC] [expires: 2020-03-09]
      691D9AC876EAABBC0AFA5403DF5E676BBF2D7AE8
uid           [ultimate] John Doe <john@doe.com>
sig 3        DF5E676BBF2D7AE8 2018-03-10  John Doe <john@doe.com>
sig          8E47A1EC35A1551D 2018-03-10  Lance R. Vick (Personal) <lance@lrvick.net>
sub   rsa2048 2018-03-10 [E] [expires: 2020-03-09]
sig          DF5E676BBF2D7AE8 2018-03-10  John Doe <john@doe.com>
```
# Details

Version 2.2.5
# Revisions and Commits

| [rG GnuPG](/source/gnupg/) | | | |
| --- | --- | --- | --- |
|  | rG1a5d95e7319e [gpg: Check that a key may do certifications.](/rG1a5d95e7319e7e6f0dd11064a26cbbc371b05214) |
|  | rGa17d2d1f690e [g10: Fix filtering by PK->REQ\_USAGE.](/rGa17d2d1f690ebe5d005b4589a5fe378b6487c657) |

# Related Objects

* Mentions

Mentioned In [T3970: Change capabilities / usage flags in edit-key](/T3970)
### Event Timeline

[lrvick](/p/lrvick/) renamed this task from Able to certify keys without a certify key present when using smartcard. to Able to certify public keys without a certify key present when using smartcard..[Mar 19 2018, 3:05 AM2018-03-19 03:05:54 (UTC+1)](#111665)[lrvick](/p/lrvick/) created this task.[lrvick](/p/lrvick/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-mf6cukoz4mzrdci/)[Mar 19 2018, 3:08 AM2018-03-19 03:08:26 (UTC+1)](#111666)[lrvick](/p/lrvick/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-6ggfpgejk6kyite/)[lrvick](/p/lrvick/) added a comment.[Mar 19 2018, 5:26 AM2018-03-19 05:26:05 (UTC+1)](#111668)Comment Actions

Reproduced again with a brand new Yubikey 4 Nano on another Arch Linux machine with a newly created test keychain:

```
[lrvick@qatan ~]$ gpg --list-secret-keys test@user.com
sec#  rsa4096 2018-03-19 [C] [expires: 2019-03-19]
      C1F0C6A9F5F69C17F191D4E02CCD7B5711024FF5
uid           [ unknown] Test User <test@user.com>
ssb>  rsa4096 2018-03-19 [S] [expires: 2019-03-19]
ssb>  rsa4096 2018-03-19 [E] [expires: 2019-03-19]
ssb>  rsa4096 2018-03-19 [A] [expires: 2019-03-19]

[lrvick@qatan ~]$ gpg --card-status

Reader ...........: 1050:0407:X:0
Application ID ...: D2760001240102010006064514430000
Version ..........: 2.1
Manufacturer .....: Yubico
Serial number ....: 06451443
Name of cardholder: [not set]
Language prefs ...: [not set]
Sex ..............: unspecified
URL of public key : [not set]
Login data .......: [not set]
Signature PIN ....: not forced
Key attributes ...: rsa4096 rsa4096 rsa4096
Max. PIN lengths .: 127 127 127
PIN retry counter : 3 0 3
Signature counter : 2
Signature key ....: 70F3 E108 54FE 1543 77FB  2952 90CD 672F 25BB 6CA4
      created ....: 2018-03-19 03:55:44
Encryption key....: E818 2161 D30C 8CF1 B0C4  B1C8 F893 D52B D380 3E55
      created ....: 2018-03-19 03:55:47
Authentication key: A514 B27D 471B 8478 87AE  910D 995A 0D90 3CC5 D604
      created ....: 2018-03-19 03:55:48
General key info..: sub  rsa4096/90CD672F25BB6CA4 2018-03-19 Test User <test@user.com>
sec#  rsa4096/2CCD7B5711024FF5  created: 2018-03-19  expires: 2019-03-19
ssb>  rsa4096/90CD672F25BB6CA4  created: 2018-03-19  expires: 2019-03-19
                                card-no: 0006 06451443
ssb>  rsa4096/F893D52BD3803E55  created: 2018-03-19  expires: 2019-03-19
                                card-no: 0006 06451443
ssb>  rsa4096/995A0D903CC5D604  created: 2018-03-19  expires: 2019-03-19
                                card-no: 0006 06451443
[lrvick@qatan ~]$ gpg --list-keys jdoe@example.com
pub   rsa2048 2018-03-19 [SC] [expires: 2020-03-18]
      483B197C8D155B6D1D1032D9F08F443160EAE3A0
uid           [ unknown] John Doe <jdoe@example.com>
sub   rsa2048 2018-03-19 [E] [expires: 2020-03-18]

[lrvick@qatan ~]$ gpg --sign-key 483B197C8D155B6D1D1032D9F08F443160EAE3A0

pub  rsa2048/F08F443160EAE3A0
     created: 2018-03-19  expires: 2020-03-18  usage: SC
     trust: unknown       validity: unknown
sub  rsa2048/B831D9F85950283D
     created: 2018-03-19  expires: 2020-03-18  usage: E
[ unknown] (1). John Doe <jdoe@example.com>

pub  rsa2048/F08F443160EAE3A0
     created: 2018-03-19  expires: 2020-03-18  usage: SC
     trust: unknown       validity: unknown
 Primary key fingerprint: 483B 197C 8D15 5B6D 1D10  32D9 F08F 4431 60EA E3A0

     John Doe <jdoe@example.com>

This key is due to expire on 2020-03-18.
Are you sure that you want to sign this key with your
key "Test User <test@user.com>" (90CD672F25BB6CA4)

Really sign? (y/N) y

[lrvick@qatan ~]$ gpg --list-sigs jdoe@example.com
pub   rsa2048 2018-03-19 [SC] [expires: 2020-03-18]
      483B197C8D155B6D1D1032D9F08F443160EAE3A0
uid           [ unknown] John Doe <jdoe@example.com>
sig 3        F08F443160EAE3A0 2018-03-19  John Doe <jdoe@example.com>
sig          90CD672F25BB6CA4 2018-03-19  Test User <test@user.com>
sub   rsa2048 2018-03-19 [E] [expires: 2020-03-18]
sig          F08F443160EAE3A0 2018-03-19  John Doe <jdoe@example.com>
```

Attached is a full scdaemon guru log of the above operations.

scdeamon.log93 KB[Download](https://files.gnupg.net/file/download/ut2lxkr5e5fxx4o2mrpx/PHID-FILE-niv57tskgdjewifzwcwd/scdeamon.log)

[• werner](/p/werner/) triaged this task as High priority.[Mar 20 2018, 11:32 AM2018-03-20 11:32:20 (UTC+1)](#111722)[• werner](/p/werner/) added a project: [gnupg (gpg20)](/tag/gpg20/).[• gniibe](/p/gniibe/) claimed this task.[Apr 2 2018, 10:43 AM2018-04-02 10:43:52 (UTC+2)](#112214)[• gniibe](/p/gniibe/) added a commit: [rGa17d2d1f690e: g10: Fix filtering by PK->REQ\_USAGE.](/rGa17d2d1f690ebe5d005b4589a5fe378b6487c657).[Apr 2 2018, 10:49 AM2018-04-02 10:49:20 (UTC+2)](#112215)[• gniibe](/p/gniibe/) changed the task status from Open to Testing.[Apr 3 2018, 1:25 AM2018-04-03 01:25:25 (UTC+2)](#112228)Comment Actions

I think that I located the bug and fixed. I wonder why Werner put gpg20 tag.

[bcl](/p/bcl/) added a subscriber: [bcl](/p/bcl/).[Apr 5 2018, 6:18 PM2018-04-05 18:18:20 (UTC+2)](#112368)Comment Actions

Shouldn't this also be applied to STABLE-BRANCH-1-4?

[• gniibe](/p/gniibe/) added a comment.[Apr 6 2018, 1:09 AM2018-04-06 01:09:17 (UTC+2)](#112369)Comment Actions

The bug is specific to 2.2, which may select available key on card. When such a selection, checking the PK->REQ\_USAGE was missed.

[• gniibe](/p/gniibe/) added a comment.[Apr 6 2018, 2:28 AM2018-04-06 02:28:47 (UTC+2)](#112382)Comment Actions

If someone claims this is a kind of vulnerability, I think that what we need to fix is signature checking side:

gpg-CVE-2018-9234.diff1 KB[Download](https://files.gnupg.net/file/download/6b6renzt7zdtsyrged7k/PHID-FILE-m27bucahkcbbwcryixzy/gpg-CVE-2018-9234.diff)

Speaking about this, similar patch would be required to gpg1.4.

[• gniibe](/p/gniibe/) added a comment.Edited · [Apr 6 2018, 8:55 AM2018-04-06 08:55:20 (UTC+2)](#112386)Comment Actions

Sorry, the patch above is completely wrong, since pk->pubkey\_usage is not the right key to check.

I created another patch:

<https://dev.gnupg.org/D460>

I wish this patch is correct.

[• werner](/p/werner/) edited projects, added [gnupg (gpg22)](/tag/gpg22/); removed [gnupg (gpg20)](/tag/gpg20/).[Apr 6 2018, 9:26 AM2018-04-06 09:26:42 (UTC+2)](#112388)[• werner](/p/werner/) added a subscriber: [• werner](/p/werner/).Comment Actions

The gpg20 tag was a typo.

[• werner](/p/werner/) added a comment.[Apr 6 2018, 11:16 AM2018-04-06 11:16:34 (UTC+2)](#112392)Comment Actions

I have another patch proposal to check the key usage. However, there is a catch-22. We get the usage flags from the key signatures and thus we can only check them after we checked the key signature.

0001-gpg-Check-that-a-key-may-do-certifications.patch1 KB[Download](https://files.gnupg.net/file/download/eu6mlrybd3tce5773mjm/PHID-FILE-5vx2gueyzi3xup7y73cn/0001-gpg-Check-that-a-key-may-do-certifications.patch)

[• werner](/p/werner/) added a comment.[Apr 6 2018, 11:32 AM2018-04-06 11:32:53 (UTC+2)](#112393)Comment Actions

Forget my former comment. We only need to check subkeys becuase the primary key can always certify.

Here is a new revision of the patch: 0001-gpg-Check-that-a-key-may-do-certifications.patch1 KB[Download](https://files.gnupg.net/file/download/3tvtouvl26cyhse6xn4j/PHID-FILE-mduofjztmxfnsrli3f3j/0001-gpg-Check-that-a-key-may-do-certifications.patch)

[• gniibe](/p/gniibe/) added a comment.[Apr 6 2018, 1:34 PM2018-04-06 13:34:32 (UTC+2)](#112405)Comment Actions

The patch has two parts; (1) detecting signature by incapable key and (2) limiting key with relevant capability.

I think that (1) is enough. I wonder with (2), (1) would not occur.

[• werner](/p/werner/) added a comment.[Apr 6 2018, 4:38 PM2018-04-06 16:38:25 (UTC+2)](#112406)Comment Actions

Right with (2) (1) will not occur if the key has been created with GnuPG. However, we have caches in the code path and further rogue software may create creates, interesting keys (tm). Thus I consider it better to explicitly request keys with cert flag set.

[• gniibe](/p/gniibe/) added a comment.[Apr 9 2018, 1:20 AM2018-04-09 01:20:05 (UTC+2)](#112423)Comment Actions

I see. Got it.

[• werner](/p/werner/) added a commit: [rG1a5d95e7319e: gpg: Check that a key may do certifications.](/rG1a5d95e7319e7e6f0dd11064a26cbbc371b05214).[Apr 9 2018, 10:33 AM2018-04-09 10:33:11 (UTC+2)](#112446)[damadmai](/p/damadmai/) mentioned this in [T3970: Change capabilities / usage flags in edit-key](/T3970).[May 9 2018, 6:19 PM2018-05-09 18:19:04 (UTC+2)](#114233)[dkg](/p/dkg/) added a subscriber: [dkg](/p/dkg/).[Jun 8 2018, 11:58 PM2018-06-08 23:58:07 (UTC+2)](#115097)Comment Actions

fwiw, i agree that if there's any security vulnerability here, it is in the verification side, not the creation side.

[• werner](/p/werner/) added a comment.[Jun 9 2018, 11:35 AM2018-06-09 11:35:53 (UTC+2)](#115109)Comment Actions

So we had two releases with the fist. Can we set this bug to resolved?

[• gniibe](/p/gniibe/) closed this task as Resolved.[Jun 11 2018, 8:41 AM2018-06-11 08:41:08 (UTC+2)](#115115)Comment Actions

Yes, closing.

[Log In to Comment](/login/?next=)

=== Content from usn.ubuntu.com_2b495fa2_20250125_090250.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3675-1: GnuPG vulnerabilities

11 June 2018

Several security issues were fixed in GnuPG.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 18.04 ESM](/security/notices?release=bionic)
* [Ubuntu 17.10](/security/notices?release=artful)
* [Ubuntu 16.04 ESM](/security/notices?release=xenial)
* [Ubuntu 14.04 ESM](/security/notices?release=trusty)

## Packages

* [gnupg](/security/cves?package=gnupg) - GNU privacy guard - a free PGP replacement
* [gnupg2](/security/cves?package=gnupg2) - GNU privacy guard - a free PGP replacement

## Details

Marcus Brinkmann discovered that during decryption or verification,

GnuPG did not properly filter out terminal sequences when reporting the

original filename. An attacker could use this to specially craft a file

that would cause an application parsing GnuPG output to incorrectly

interpret the status of the cryptographic operation reported by GnuPG.

([CVE-2018-12020](/security/CVE-2018-12020))

Lance Vick discovered that GnuPG did not enforce configurations where

key certification required an offline primary Certify key. An attacker

with access to a signing subkey could generate certifications that

appeared to be valid. This issue only affected Ubuntu 18.04 LTS.

([CVE-2018-9234](/security/CVE-2018-9234))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 18.04

* [gnupg](https://launchpad.net/ubuntu/%2Bsource/gnupg2)
  -
  [2.2.4-1ubuntu1.1](https://launchpad.net/ubuntu/%2Bsource/gnupg2/2.2.4-1ubuntu1.1)
* [gpg](https://launchpad.net/ubuntu/%2Bsource/gnupg2)
  -
  [2.2.4-1ubuntu1.1](https://launchpad.net/ubuntu/%2Bsource/gnupg2/2.2.4-1ubuntu1.1)

##### Ubuntu 17.10

* [gnupg](https://launchpad.net/ubuntu/%2Bsource/gnupg2)
  -
  [2.1.15-1ubuntu8.1](https://launchpad.net/ubuntu/%2Bsource/gnupg2/2.1.15-1ubuntu8.1)

##### Ubuntu 16.04

* [gnupg](https://launchpad.net/ubuntu/%2Bsource/gnupg)
  -
  [1.4.20-1ubuntu3.2](https://launchpad.net/ubuntu/%2Bsource/gnupg/1.4.20-1ubuntu3.2)

##### Ubuntu 14.04

* [gnupg](https://launchpad.net/ubuntu/%2Bsource/gnupg)
  -
  [1.4.16-1ubuntu2.5](https://launchpad.net/ubuntu/%2Bsource/gnupg/1.4.16-1ubuntu2.5)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2018-12020](/security/CVE-2018-12020)
* [CVE-2018-9234](/security/CVE-2018-9234)

## Related notices

* [USN-3675-3](/security/notices/USN-3675-3)
* [USN-3675-2](/security/notices/USN-3675-2)
* [USN-3964-1](/security/notices/USN-3964-1)
* [USN-4839-1](/security/notices/USN-4839-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page


