=== Content from medium.com_d475db69_20250125_050625.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5a0abc147d7a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40TheWindowsTwin%2Fvulnerability-in-freesshd-5a0abc147d7a&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40TheWindowsTwin%2Fvulnerability-in-freesshd-5a0abc147d7a&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Vulnerability in freeSSHd

[![Michael Roberts](https://miro.medium.com/v2/da:true/resize:fill:88:88/0*VtpH2ylTZnONd1Q_)](/%40TheWindowsTwin?source=post_page---byline--5a0abc147d7a--------------------------------)

[Michael Roberts](/%40TheWindowsTwin?source=post_page---byline--5a0abc147d7a--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe93a06344505&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40TheWindowsTwin%2Fvulnerability-in-freesshd-5a0abc147d7a&user=Michael+Roberts&userId=e93a06344505&source=post_page-e93a06344505--byline--5a0abc147d7a---------------------post_header-----------)

3 min read·Jul 8, 2018

--

1

Listen

Share

The following article is a proof of concept for CVE-2018–9853 a vulnerabilty in the latest version of [freeSSHd](http://www.freesshd.com) (1.3.1).

We will highlight how insecure access control in freeSSHd version 1.3.1 allows attackers to obtain the privileges of the freesshd.exe process by leveraging the ability to login to an unprivileged account on the server.

# Proof of Concept

Let’s start with a clean install of freeSSHd on any version of windows, here we demonstrate Windows 7. The #1 search result for “ssh server on windows 7” is a [TechRepublic](https://www.techrepublic.com/blog/tr-dojo/set-up-a-free-ssh-server-on-windows-7-with-freesshd/) article, assuming most users will be following said article we will as well. Below is a new install of freeSSHd version 1.3.1:

![]()

Default install of latest version of freeSSHd

As you can see, as soon as the application is opened the SSH server starts running. Now we will create windows users and add them to freeSSHd:

![]()

Creating the user accounts

In the picture above, we have created a user named ***standardaccount*** and did not add them to the administrators group. However, when we log in with putty in the next few images you will see ***standardaccount*** is able to run commands as an administrator.

![]()

Logging in with **standardaccount**

We are now ssh’d into the machine under the ***standardaccount*** credentials; however, this account has full administrative permissions as required by the first two commands below:

![]()

Running elevated commands

What is interesting is that the command “*whoami*” displays “win7client\testadmin” the user that launched the process. Whoever logs into the ssh server has the rights of said admin, whether they are an admin themselves or not. This concludes the proof of concept, now for a few more details:

freeSSHd has not received an update in several years, like any outdated software it is not recommended that it still be used. Instead there are alternatives like [OpenSSH](https://www.openssh.com) and [bitvise](https://www.bitvise.com/ssh-server). This vulnerability may still be impactful because freeSSHd is still distributed on their website and through the popular windows package manager [chocolatey](https://chocolatey.org). On chocolatey alone, freesshd has 10,487 downloads in the last 3 years. Any of these servers that are currently running are vulnerable to this exploit unless they are configured to run as a service.

For additional content, follow me on Twitter: [@TheWindowsTwin](https://twitter.com/TheWindowsTwin)

[Security](/tag/security?source=post_page-----5a0abc147d7a--------------------------------)[Windows 7](/tag/windows-7?source=post_page-----5a0abc147d7a--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----5a0abc147d7a--------------------------------)[Ssh](/tag/ssh?source=post_page-----5a0abc147d7a--------------------------------)[Github](/tag/github?source=post_page-----5a0abc147d7a--------------------------------)

--

--

1

[![Michael Roberts](https://miro.medium.com/v2/resize:fill:96:96/0*VtpH2ylTZnONd1Q_)](/%40TheWindowsTwin?source=post_page---post_author_info--5a0abc147d7a--------------------------------)[![Michael Roberts](https://miro.medium.com/v2/resize:fill:128:128/0*VtpH2ylTZnONd1Q_)](/%40TheWindowsTwin?source=post_page---post_author_info--5a0abc147d7a--------------------------------)Follow[## Written by Michael Roberts](/%40TheWindowsTwin?source=post_page---post_author_info--5a0abc147d7a--------------------------------)[1 Follower](/%40TheWindowsTwin/followers?source=post_page---post_author_info--5a0abc147d7a--------------------------------)·[4 Following](/%40TheWindowsTwin/following?source=post_page---post_author_info--5a0abc147d7a--------------------------------)Follow
## Responses (1)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----5a0abc147d7a--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----5a0abc147d7a--------------------------------)[About](/about?autoplay=1&source=post_page-----5a0abc147d7a--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----5a0abc147d7a--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----5a0abc147d7a--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----5a0abc147d7a--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5a0abc147d7a--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5a0abc147d7a--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----5a0abc147d7a--------------------------------)[Teams](/business?source=post_page-----5a0abc147d7a--------------------------------)


