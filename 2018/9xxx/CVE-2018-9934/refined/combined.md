=== Content from www.cnblogs.com_b76471da_20250125_080512.html ===


[![](https://img2024.cnblogs.com/blog/35695/202412/35695-20241201073014811-1847930772.jpg)](https://www.doubao.com?channel=cnblogs&source=hw_db_cnblogs)

* [![博客园Logo](//assets.cnblogs.com/logo.svg)](https://www.cnblogs.com/ "开发者的网上家园")
* [会员](https://cnblogs.vip/)
* [周边](https://cnblogs.vip/store)
* [众包](https://www.cnblogs.com/cmt/p/18500368)
* [新闻](https://news.cnblogs.com/)
* [博问](https://q.cnblogs.com/)
* [闪存](https://ing.cnblogs.com/)
* [赞助商](https://www.cnblogs.com/cmt/p/18341478)
* [Chat2DB](https://chat2db-ai.com/)

* ![搜索](//assets.cnblogs.com/icons/search.svg)
  ![搜索](//assets.cnblogs.com/icons/enter.svg)
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    所有博客
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    当前博客
* [![写随笔](//assets.cnblogs.com/icons/newpost.svg)](https://i.cnblogs.com/EditPosts.aspx?opt=1 "写随笔")
  [![我的博客](//assets.cnblogs.com/icons/myblog.svg)](https://passport.cnblogs.com/GetBlogApplyStatus.aspx "我的博客")
  [![短消息](//assets.cnblogs.com/icons/message.svg)](https://msg.cnblogs.com/ "短消息")
  ![简洁模式](//assets.cnblogs.com/icons/lite-mode-on.svg)
  [![用户头像](//assets.cnblogs.com/icons/avatar-default.svg)](https://home.cnblogs.com/)
  [我的博客](https://passport.cnblogs.com/GetBlogApplyStatus.aspx)
  [我的园子](https://home.cnblogs.com/)
  [账号设置](https://account.cnblogs.com/settings/account)
  简洁模式 ![](/images/lite-mode-check.svg)...
  退出登录

  [注册](https://account.cnblogs.com/signup)
  登录

![谨以此模板祝贺【博客园开发者征途】系列图书《你必须知道的.net》出版发行](/skins/insidedotnet/images/top.gif)
[![返回主页](/skins/custom/images/logo.gif)](https://www.cnblogs.com/babers/)
# [Babers](https://www.cnblogs.com/babers)

##

* [首页](https://www.cnblogs.com/babers/)
* [新随笔](https://i.cnblogs.com/EditPosts.aspx?opt=1)
* [管理](https://i.cnblogs.com/)
* 订阅
  [![订阅](/skins/insidedotnet/images/xml.gif)](https://www.cnblogs.com/babers/rss/)

# [MetInfo Password Reset Poisoning By Host Header Attack](https://www.cnblogs.com/babers/p/8503116.html "发布于 2018-03-03 21:35")

if we know some user's email, the we will can reset the user's email by host header attack.

The attack vector is that the user binded email and we know the user's email.

The following POST request is the normal request.

![](https://images2018.cnblogs.com/blog/868176/201803/868176-20180303213427470-423588703.jpg)

as the picture shows,the request host header is **Localhost**.

so the reset password email is like this:

![](https://images2018.cnblogs.com/blog/868176/201803/868176-20180303213434560-1289532528.jpg)

but this link'host comes from the reset passowrd request host header.If we change the reset passowrd request host header, then the reset passowrd link in email will changes.

so if a attacker konw some user's email and change the host header of the reset passowrd request. when the user click the fake reset password link, the attacker will receive this request, then change the link with the true host, finally change the user's password.

1. change the host header of the reset passowrd request

![](https://images2018.cnblogs.com/blog/868176/201803/868176-20180303213439887-194937587.jpg)

2. the user will receive the reset password email like this

![](https://images2018.cnblogs.com/blog/868176/201803/868176-20180303213445727-1764843810.jpg)

3. the user click the fake reset password link.
4. the attacker will receive this request.

![](https://images2018.cnblogs.com/blog/868176/201803/868176-20180303213451444-1860171487.jpg)

5. then the attacker change this request with the true host(the website's host), and visit the link to change the user's password.

![](https://images2018.cnblogs.com/blog/868176/201803/868176-20180303213457853-1331099057.jpg)

posted @
2018-03-03 21:35
[babers](https://www.cnblogs.com/babers)
阅读(1134)
评论(0)
[编辑](https://i.cnblogs.com/EditPosts.aspx?postid=8503116)
收藏
举报

刷新页面[返回顶部](#top)

[![](https://img2024.cnblogs.com/blog/35695/202412/35695-20241201072501456-2052907165.jpg)](https://www.doubao.com?channel=cnblogs&source=hw_db_cnblogs)

Copyright © 2025 babers

Powered by .NET 9.0 on Kubernetes
谨以此模板祝贺【博客园开发者征途】系列图书之《你必须知道的.NET》出版发行



=== Content from www.cnblogs.com_7fbbc926_20250125_080513.html ===


[![](https://img2024.cnblogs.com/blog/35695/202412/35695-20241201073014811-1847930772.jpg)](https://www.doubao.com?channel=cnblogs&source=hw_db_cnblogs)

* [![博客园Logo](//assets.cnblogs.com/logo.svg)](https://www.cnblogs.com/ "开发者的网上家园")
* [会员](https://cnblogs.vip/)
* [周边](https://cnblogs.vip/store)
* [众包](https://www.cnblogs.com/cmt/p/18500368)
* [新闻](https://news.cnblogs.com/)
* [博问](https://q.cnblogs.com/)
* [闪存](https://ing.cnblogs.com/)
* [赞助商](https://www.cnblogs.com/cmt/p/18341478)
* [Chat2DB](https://chat2db-ai.com/)

* ![搜索](//assets.cnblogs.com/icons/search.svg)
  ![搜索](//assets.cnblogs.com/icons/enter.svg)
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    所有博客
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    当前博客
* [![写随笔](//assets.cnblogs.com/icons/newpost.svg)](https://i.cnblogs.com/EditPosts.aspx?opt=1 "写随笔")
  [![我的博客](//assets.cnblogs.com/icons/myblog.svg)](https://passport.cnblogs.com/GetBlogApplyStatus.aspx "我的博客")
  [![短消息](//assets.cnblogs.com/icons/message.svg)](https://msg.cnblogs.com/ "短消息")
  ![简洁模式](//assets.cnblogs.com/icons/lite-mode-on.svg)
  [![用户头像](//assets.cnblogs.com/icons/avatar-default.svg)](https://home.cnblogs.com/)
  [我的博客](https://passport.cnblogs.com/GetBlogApplyStatus.aspx)
  [我的园子](https://home.cnblogs.com/)
  [账号设置](https://account.cnblogs.com/settings/account)
  简洁模式 ![](/images/lite-mode-check.svg)...
  退出登录

  [注册](https://account.cnblogs.com/signup)
  登录

![谨以此模板祝贺【博客园开发者征途】系列图书《你必须知道的.net》出版发行](/skins/insidedotnet/images/top.gif)
[![返回主页](/skins/custom/images/logo.gif)](https://www.cnblogs.com/babers/)
# [Babers](https://www.cnblogs.com/babers)

##

* [首页](https://www.cnblogs.com/babers/)
* [新随笔](https://i.cnblogs.com/EditPosts.aspx?opt=1)
* [管理](https://i.cnblogs.com/)
* 订阅
  [![订阅](/skins/insidedotnet/images/xml.gif)](https://www.cnblogs.com/babers/rss/)

# [MetInfo Host头污染导致重置用户密码](https://www.cnblogs.com/babers/p/8745739.html "发布于 2018-04-08 16:29")

if we know some user's email, the we will can reset the user's email by host header attack.

如果我们知道了某个注册用户的邮箱，那么我们就能够通过头注入的方式重置任意用户的密码。所以这个漏洞的攻击前提是在于用户必须要绑定邮箱，且我们知道这个用户的邮箱。

正常的找回密码发送的请求如下：

![](https://images2018.cnblogs.com/blog/868176/201804/868176-20180408162629752-156545068.jpg)

通过这个图片可以看出来，由于我们是在本地搭建的，所有请求头是**localhost**。所以我们收到的重置密码的链接如下：

![](https://images2018.cnblogs.com/blog/868176/201804/868176-20180408162645790-622449255.jpg)

其中这个重置密码连接的Host头就是来自于我们上面找回密码发送请求时的Host头。如果我们修改找回密码时的请求头为我们的恶意Host，那么重置密码的链接也将发生改变。

所以如果一个攻击这修改了请求头为自己的DNS服务器，并且知道某位用户的邮箱，就可以发送一份伪造的重置密码的邮件到用户的邮箱。当用户点击之后，攻击者就可以收到这个请求包括其中的Token，攻击者将其替换为真实的请求头，那么就可以修改掉用户的密码了。

操作步骤如下：

1. 修改重置密码请求的Host头

   ![](https://images2018.cnblogs.com/blog/868176/201804/868176-20180408162650756-814024383.jpg)
2. 用户收到的重置密码邮箱如下：

   ![](https://images2018.cnblogs.com/blog/868176/201804/868176-20180408162658180-939688286.jpg)
3. 用户点击重置密码的连接
4. 攻击者通过自己的DNS服务器收到如下的信息。

   ![](https://images2018.cnblogs.com/blog/868176/201804/868176-20180408162704088-665476007.jpg)
5. 攻击者将其替换为真实的请求头，让访问这个连接就可以修改用户的密码了。

   ![](https://images2018.cnblogs.com/blog/868176/201804/868176-20180408162708857-45139494.jpg)

### 漏洞原因：

造成这个漏洞的原因是在于,在进行邮件请求地址拼接的时候，使用是通过`$_M`取的host都信息，而`$_M`是通过`$_SERVER['HTTP_HOST']`直接获取的HOST头信息，没有进行任何的校验，所以导致攻击者能够能够修改Host头信息，从而进行重置密码的链接的修改。

posted @
2018-04-08 16:29
[babers](https://www.cnblogs.com/babers)
阅读(1306)
评论(0)
[编辑](https://i.cnblogs.com/EditPosts.aspx?postid=8745739)
收藏
举报

刷新页面[返回顶部](#top)

[![](https://img2024.cnblogs.com/blog/35695/202412/35695-20241210184144496-425627414.jpg)](https://www.marscode.cn/?utm_source=advertising&utm_medium=cnblogs.com_ug_cpa&utm_term=hw_marscode_cnblogs&utm_content=home)

Copyright © 2025 babers


