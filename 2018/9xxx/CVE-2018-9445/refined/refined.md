```
{
  "vulnerability": {
    "root_cause": "The `vold` service uses the `blkid` command to gather information about USB storage devices. The `blkid` command outputs device information, including the label, UUID, and filesystem type. The parsing logic in `vold` uses `strstr` and `sscanf` to extract these values. The vulnerability exists because the label string is not properly sanitized before being used in the string parsing operations, allowing an attacker to inject malicious values into the fsUuid variable.",
    "weaknesses": [
      "Improper input validation in `vold` when parsing the output of `blkid` command.",
      "Lack of sanitization of the LABEL field from the `blkid` output which can be controlled by an attacker",
      "Directory traversal vulnerability due to the ability to inject `../` into the fsUuid variable."
    ],
    "impact": "An attacker can control the mount point of a USB storage device, leading to potential code execution and data exfiltration from the device. This is achieved by injecting a malicious path into the `fsUuid` variable that results in mounting the USB storage at an attacker-controlled location, which can overwrite system files.",
    "attack_vectors": [
      "Physical access to the Android device to insert a maliciously crafted USB storage device.",
      "The malicious USB device contains a specially crafted label that injects a path to a directory traversal.",
       "The USB device uses a romfs filesystem to bypass the initial fsck checks and inject the path, followed by a vfat filesystem that actually mounts the device.",
       "An attacker controlled USB storage device delivers different data based on different reads."
    ],
    "required_capabilities": [
      "Ability to create a specially formatted USB storage device.",
        "Physical access to the target Android device.",
        "The device's disk encryption keys must be unlocked for the attack to succeed."
    ],
    "additional_details": "The vulnerability can be exploited even when the phone is locked. A proof-of-concept is provided that shows how to exfiltrate photos from the device by injecting a malicious payload into `/data/dalvik-cache` that then gets executed by com.android.externalstorage/.MountReceiver which has access to `/storage/emulated/0` directory.  The exploit utilizes a crafted romfs filesystem to inject a path containing `../` for directory traversal. Afterwards, a vfat filesystem is used for mounting to place the crafted payload and configuration files"
  }
}
```