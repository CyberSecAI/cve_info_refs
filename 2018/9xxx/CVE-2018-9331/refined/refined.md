- **Root cause of vulnerability**: The `adv.php` script in zzcms allows arbitrary file deletion due to insufficient validation of the `oldimg` parameter.
- **Weaknesses/vulnerabilities present**:
    - **Arbitrary file deletion:** The script uses user-supplied input (`oldimg`) to construct a file path and subsequently delete that file without proper validation.
    - **Lack of input validation/sanitization**: The `oldimg` parameter is not checked for allowed paths or file types, permitting an attacker to specify any file path accessible by the webserver process.
- **Impact of exploitation**:
    - **Arbitrary File Deletion:** Attackers can delete any file accessible by the webserver user, including critical system files, configuration files, or data files.
    - **Website Hijacking:** By deleting `install.lock`, attackers could reinstall the CMS, potentially gaining administrative access and control over the website.
    - **Database Compromise:** Attackers could potentially gain access to the website database if configuration files containing database credentials are deleted
- **Attack vectors**:
    - **HTTP POST request**: The vulnerability can be exploited by sending a crafted HTTP POST request to `/user/adv.php` with the `action=modify` parameter and a malicious `oldimg` parameter.
- **Required attacker capabilities/position**:
    - **Access to `adv.php`**: The attacker needs to be able to send requests to the `adv.php` endpoint.
    - **User with "company" role**: Based on the content, the attacker must register with a "company" role for the account.
    - **Knowledge of file paths**: The attacker must know or be able to guess file paths on the server to target specific files.