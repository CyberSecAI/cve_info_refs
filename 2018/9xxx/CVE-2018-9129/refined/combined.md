=== Content from web-in-security.blogspot.com_48ae4d6e_20250124_180558.html ===


# [On Web-Security and -Insecurity](https://web-in-security.blogspot.com/)

Recent research on web security and related topics. Provided and maintained by members and friends of the [Chair for Network and Data Security](https://www.nds.rub.de/chair/news/) at the Ruhr University Bochum, Faculty of Electrical Engineering and Information Technology, Horst Görtz Institute for IT-Security.

## Monday, August 13, 2018

### Practical Bleichenbacher Attacks on IPsec IKE

We found out that reusing a key pair across different versions and modes of IPsec IKE can lead to cross-protocol authentication bypasses, enabling the impersonation of a victim host or network by attackers. These vulnerabilities existed in implementations by Cisco, Huawei, and others.

This week at the [USENIX Security conference](https://www.usenix.org/conference/usenixsecurity18), I will present our [research paper on IPsec attacks](https://www.usenix.org/conference/usenixsecurity18/presentation/felsch): *The Dangers of Key Reuse: Practical Attacks on IPsec IKE* written by Martin Grothe, Jörg Schwenk, and me from Ruhr University Bochum as well as Adam Czubak and Marcin Szymanek from the University of Opole [[alternative link to the paper]](https://www.nds.rub.de/media/nds/veroeffentlichungen/2018/08/13/sec18-felsch.pdf). This blog post is intended for people who like to get a comprehensive summary of our findings rather than to read a long research paper.
### IPsec and Internet Key Exchange (IKE)

IPsec enables cryptographic protection of IP packets. It is commonly used to build VPNs (Virtual Private Networks). For key establishment, the IKE protocol is used. IKE exists in two versions, each with different modes, different phases, several authentication methods, and conﬁguration options. Therefore, IKE is one of the most complex cryptographic protocols in use.

In version 1 of IKE (IKEv1), four authentication methods are available for Phase 1, in which initial authenticated keying material is established: Two public key encryption based methods, one signature based method, and a PSK (Pre-Shared Key) based method.

### Attacks on IKE implementations

With our attacks we can impersonate an IKE device: If the attack is successful, we share a set of (falsely) authenticated symmetric keys with the victim device, and can successfully complete the handshake – this holds for both IKEv1 and IKEv2. The attacks are based on Bleichenbacher oracles in the IKEv1 implementations of four large network equipment manufacturers: Cisco, Huawei, Clavister, and ZyXEL. These Bleichenbacher oracles can also be used to forge digital signatures, which breaks the signature based IKEv1 and IKEv2 variants. Those who are unfamiliar with Bleichenbacher attacks may read [this post by our colleague Juraj Somorovsky](https://web-in-security.blogspot.com/2014/08/old-attacks-on-new-tls-implementations.html) for an explanation.

|  |
| --- |
| The affected hardware test devices by Huawei, Cisco, and ZyXEL in our network lab. |

We show that the strength of these oracles is sufficient to break all handshake variants in IKEv1 and IKEv2 (except those based on PSKs) when given access to powerful network equipment. We furthermore demonstrate that key reuse across protocols as implemented in certain network equipment carries high security risks.

We additionally show that both PSK based modes can be broken with an [offline dictionary attack if the PSK has low entropy](https://web-in-security.blogspot.com/2018/08/practical-dictionary-attack-on-ipsec-ike.html). Such an attack was previously only documented for one of those modes (edit: see [this comment](https://web-in-security.blogspot.com/2018/08/practical-dictionary-attack-on-ipsec-ike.html#credits)). We thus show attacks against all authentication modes in both IKEv1 and IKEv2 under reasonable assumptions.

|  |
| --- |
| The relationship between IKEv1 Phase 1, Phase 2, and IPsec ESP. Multiple simultaneous Phase 2 connections can be established from a single Phase 1 connection. Grey parts are encrypted, either with IKE derived keys (light grey) or with IPsec keys (dark grey). The numbers at the curly brackets denote the number of messages to be exchanged in the protocol. |

### Where's the bug?

The public key encryption (PKE) based authentication mode of IKE requires that both parties exchanged their public keys securely beforehand (e. g. with certiﬁcates during an earlier handshake with signature based authentication). [RFC 2409](https://tools.ietf.org/html/rfc2409#section-5.2) advertises this mode of authentication with a plausibly deniable exchange to raise the privacy level. In this mode, messages three and four of the handshake exchange encrypted nonces and identities. They are encrypted using the public key of the respective other party. The encoding format for the ciphertexts is PKCS #1 v1.5.

Bleichenbacher attacks are adaptive chosen ciphertext attacks against RSA-PKCS #1 v1.5. Though the attack has been known for two decades, it is a [common pitfall for developers](https://robotattack.org/). The mandatory use of PKCS #1 v1.5 in the PKE authentication methods raised suspicion of whether implementations resist Bleichenbacher attacks.

PKE authentication is available and fully functional in Cisco’s IOS operating system. In Clavister’s cOS and ZyXEL’s ZyWALL USG devices, PKE is not ofﬁcially available. There is no documentation and no conﬁguration option for it and it is therefore not fully functional. Nevertheless, these implementations processed messages using PKE authentication in our tests.

Huawei implements a *revised mode* of the PKE mode mentioned in the RFC that saves one private key operation per peer (we call it RPKE mode). It is available in certain Huawei devices including the Secospace USG2000 series.

We were able to conﬁrm the existence of Bleichenbacher oracles in all these implementations. Here are the CVE entries and security advisories by the vendors (I will add links once they are available):

* Cisco: [CVE-2018-0131](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0131), [Security Advisory](https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180813-rsa-nonce)
* Huawei: [CVE-2017-17305](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17305), [Security Advisory](https://www.huawei.com/en/psirt/security-advisories/huawei-sa-20180813-01-Bleichenbacher-en)
* Clavister: [CVE-2018-8753](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8753), [Security Advisory](https://www.clavister.com/advisories/security/clav-sa-0157-bleichenbacher-oracle-vulnerability-in-ikev1)
* Zyxel: [CVE-2018-9129](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-9129), [Security Advisory](https://www.zyxel.com/support/bleichenbacher_attack_vulnerability.shtml)

On an abstract level, these oracles work as follows: If we replace the ciphertext of the nonce in the third handshake message with a modiﬁed RSA ciphertext, the responder will either indicate an error (Cisco, Clavister, and ZyXEL) or silently abort (Huawei) if the ciphertext is not PKCS #1 v1.5 compliant. Otherwise, the responder continues with the fourth message (Cisco and Huawei) or return an error notiﬁcation with a different message (Clavister and ZyXEL) if the ciphertext is in fact PKCS #1 v1.5 compliant. Each time we learn that the ciphertext was valid, we can advance the Bleichenbacher attack one more step.

### A Bleichenbacher Attack Against PKE

If a Bleichenbacher oracle is discovered in a TLS implementation, then TLS-RSA is broken since one can compute the Premaster Secret and the TLS session keys without any time limit on the usage of the oracle. For IKEv1, the situation is more difﬁcult: Even if there is a strong Bleichenbacher oracle in PKE and RPKE mode, our attack must succeed within the lifetime of the IKEv1 Phase 1 session, since a Diffie-Hellman key exchange during the handshake provides an additional layer of security that is not present in TLS-RSA. For example, for Cisco this time limit is currently ﬁxed to 60 seconds for IKEv1 and 240 seconds for IKEv2.

To phrase it differently: In TLS-RSA, a Bleichenbacher oracle allows to perform an *ex post attack* to break the conﬁdentiality of the TLS session later on, whereas in IKEv1 a Bleichenbacher oracle only can be used to perform an *online attack* to impersonate one of the two parties in real time.

|  |
| --- |
| Bleichenbacher attack against IKEv1 PKE based authentication. |

The figure above depicts a direct attack on IKEv1 PKE:

1. The attackers initiate an IKEv1 PKE based key exchange with Responder A and adhere to the protocol until receiving the fourth message. They extract the encrypted nonce from this message, and record the other public values of the handshake.
2. The attackers keep the IKE handshake with Responder A alive as long as the responder allows. For Cisco and ZyXEL we know that handshakes are cancelled after 60 seconds, Clavister and Huawei do so after 30 seconds.
3. The attackers initiate several parallel PKE based key exchanges to Responder B.

* In each of these exchanges, they send and receive the ﬁrst two messages according to the protocol speciﬁcations.
* In the third message, they include a modiﬁed version of the encrypted nonce according to the the Bleichenbacher attack methodology.
* They wait until they receive an answer or they can reliably determine that this message will not be sent (timeout or reception of a repeated second handshake message).

5. After receiving enough answers from Responder B, the attackers can compute the plaintext of the nonce.
6. The attackers now have all the information to complete the key derivation and the handshake. They thus can impersonate Responder B to Responder A.

### Key Reuse

Maintaining individual keys and key pairs for each protocol version, mode, and authentication method of IKE is difﬁcult to achieve in practice.
It is oftentimes simply not supported by implementations.
This is the case with the implementations by Clavister and ZyXEL, for example. Thus, it is common practice to have only one RSA key pair for the whole IKE protocol family. The actual security of the protocol family in this case crucially depends on its cross-ciphersuite and cross-version security. In fact, our Huawei test device reuses its RSA key pair even for SSH host identification, which further exposes this key pair.

### A Cross-Protocol Version Attack with Digital Signature Based Authentication

#### Signature Forgery Using Bleichenbacher's Attack

It is well known that in the case of RSA, performing a decryption and creating a signature is mathematically the same operation. Bleichenbacher's original paper already mentioned that the attack could also be used to forge signatures over attacker-chosen data. In [two](https://www.nds.rub.de/research/publications/backwards-compatibility/) [papers](https://www.nds.rub.de/research/publications/ccs15/) that my colleagues at our chair have published, this has been exploited for attacks
on XML-based Web Services, TLS 1.3, and Google's QUIC protocol. The [ROBOT paper](https://www.usenix.org/conference/usenixsecurity18/presentation/bock) used this attack to forge a signature from Facebook's web servers as proof of exploitability.

#### IKEv2 With Digital Signatures

Digital signature based authentication is supported by both IKEv1 and IKEv2.
We focus here on IKEv2 because on Cisco routers, an IKEv2 handshake may take up to four minutes.
This more relaxed timer compared to IKEv1 makes it an interesting attack target.

I promised that this blogpost will only give a comprehensive summary, therefore I am skipping all the details about IKEv2 here. It is enough to know that the structure of IKEv2 is fundamentally different from IKEv1.

If you're familiar with IT-security, then you will believe me that if digital signatures are used for authentication, it is not particularly good if an attacker can get a signature over attacker chosen data. We managed to develop an attack that exploits an IKEv1 Bleichenbacher oracle at some peer A to get a signature that can be used to break the IKEv2 authentication at another peer B. This requires that peer A reuses its key pair for IKEv2 also for IKEv1. For the details, please read our [paper](https://www.usenix.org/conference/usenixsecurity18/presentation/felsch) [[alternative link to the paper]](https://www.nds.rub.de/media/nds/veroeffentlichungen/2018/08/13/sec18-felsch.pdf).
### Evaluation and Results

For testing the attack, we used a Cisco ASR 1001-X router running IOS XE in version 03.16.02.S with IOS version 15.5(3)S2. Unfortunately, Cisco’s implementation is not optimized for throughput. From our observations we assume that all cryptographic calculations for IKE are done by the device’s CPU despite it having a hardware accelerator for cryptography. One can easily overload the device’s CPU for several seconds with a standard PC bursting handshake messages, even with the default limit for concurrent handshakes. And even if the CPU load is kept below 100 %, we nevertheless observed packet loss.

For the decryption attack on Cisco’s IKEv1 responder, we need to ﬁnish the Bleichenbacher attack in 60 seconds. If the public key of our ASR 1001-X router is 1024 bits long, we measured an average of 850 responses to Bleichenbacher requests per second. Therefore, an attack must succeed with at most 51,000 Bleichenbacher requests.

But another limit is the management of Security Associations (SAs). There is a global limit of 900 Phase 1 SAs under negotiation per Cisco device in the default conﬁguration. If this number is exceeded, one is blocked. Thus, one cannot start individual handshakes for each Bleichenbacher request to issue. Instead, SAs have to be reused as long as their error counter allows. Furthermore, establishing SAs with Cisco IOS is really slow. During the attack, the negotiations in the first two messages of IKEv1 require more time than the actual Bleichenbacher attack.

We managed to perform a successful decryption attack against our ASR 1001-X router with approximately 19,000 Bleichenbacher requests. However, due to the necessary SA negotiations, the attack took 13 minutes.

For the statistics and for the attack evaluation of digital signature forgery, we used a simulator with an oracle that behaves exactly as the ones by Cisco, Clavister, and ZyXEL.
We found that about 26% of attacks against IKEv1 could be successful based on the cryptographic performance of our Cisco device.
For digital signature forgery, about 22% of attacks could be successful under the same assumptions.

Note that (without a patched IOS), only non-cryptographic performance issues prevented a succesful attack on our Cisco device. There might be faster devices that do not suffer from this. Also note that a too slow Bleichenbacher attack does not permanently lock out attackers. If a timeout occurs, they can just start over with a new attack using fresh values hoping to require fewer requests. If the victim has deployed multiple responders sharing one key pair (e. g. for load balancing), this could also be leveraged to speed up an attack.

### Responsible Disclosure

We reported our ﬁndings to Cisco, Huawei, Clavister, and ZyXEL. Cisco published ﬁxes with IOS XE versions 16.3.6, 16.6.3, and 16.7.1. They further informed us that the PKE mode will be removed with the next major release.

Huawei published [ﬁrmware version V300R001C10SPH702](http://support.huawei.com/enterprise/en/security/usg2200-pid-8577340/software/22993185) for the Secospace USG2000 series that removes the Bleichenbacher oracle and the crash bugs we identiﬁed. Customers who use other affected Huawei devices will be contacted directly by their support team as part of a need-to-know strategy.

Clavister removed the vulnerable authentication method with cOS version 12.00.09. ZyXEL responded that our ZyWALL USG 100 test device is from a legacy model series that is end-of-support. Therefore, these devices will not receive a ﬁx. For the successor models, the patched ﬁrmware version ZLD 4.32 (Release Notes) is available.
### FAQs

* **Why don't you have a cool name for this attack?**
  The attack itself already has a name, it's *Bleichenbacher's attack*. We just show how Bleichenbacher attacks can be applied to IKE and how they can break the protocol's security. So, if you like, call it *IPsec-Bleichenbacher* or *IKE-**Bleichenbacher.*
* **Do you have a logo for the attack?**
  No.
* **My machine was running a vulnerable firmware. Have I been attacked?**
  We have no indication that the attack was ever used in the wild. However, if you are still concerned, check your logs. The attack is not silent. If your machine was used for a Bleichenbacher attack, there should be many log entries about decryption errors. If your machine was the one that got tricked (Responder A in our figures), then you could probably find log entries about unfinished handshake attempts.
* **Where can I learn more?**
  First of all, you can read the [paper](https://www.usenix.org/conference/usenixsecurity18/presentation/felsch) [[alternative link to the paper]](https://www.nds.rub.de/media/nds/veroeffentlichungen/2018/08/13/sec18-felsch.pdf). Second, you can watch the presentation, either live at the conference or later [on this page](https://www.usenix.org/conference/usenixsecurity18/presentation/felsch).
* **What else does the paper contain?**
  The paper contains a lot more details than this blogpost. It explains all authentication methods including IKEv2 and it gives message flow diagrams of the protocols. There, we describe a variant of the attack that uses the Bleichenbacher oracles to forge signatures to target IKEv2. Furthermore, we describe the quirks of Huawei's implementation including crash bugs that could allow for Denial-of-Service attacks. Last but not least, it describes a dictionary attack against the PSK mode of authentication that is [covered in a separate blogpost](https://web-in-security.blogspot.com/2018/08/practical-dictionary-attack-on-ipsec-ike.html).

### Media Coverage, Blogs, and more

#### English

* [Press release by the Ruhr University Bochum](http://news.rub.de/english/press-releases/2018-08-15-information-technology-security-gaps-identified-internet-protocol-ipsec)
* [BleepingComputer](https://www.bleepingcomputer.com/news/security/cisco-patches-its-operating-systems-against-new-ike-crypto-attack/)
* [Computer Business Review](https://www.cbronline.com/news/cisco-patches-systems)
* [Medium](https://medium.com/asecuritysite-when-bob-met-alice/this-attack-has-been-around-for-20-years-and-its-back-again-with-the-bleichenbacher-oracle-a585c34c9890)
* [SecurityWeek](https://www.securityweek.com/crypto-flaw-affects-products-cisco-huawei-zyxel)
* [The Register](https://www.theregister.co.uk/2018/08/14/cisco_patches_ios/)
* [ZDNet](https://www.zdnet.com/article/cisco-patches-router-os-against-new-crypto-attack-on-business-vpns/)
#### German

* [Pressemeldung der Ruhr-Universität Bochum](http://news.rub.de/wissenschaft/2018-08-14-informationstechnologie-sicherheitsluecken-internetprotokoll-identifiziert)
* [FOCUS Online](https://www.focus.de/regional/bochum/ruhr-universitaet-bochum-informationstechnologie_id_9413666.html)
* [SecuPedia](https://www.secupedia.info/aktuelles/sicherheitsluecken-im-internetprotokoll-ipsec-identifiziert-11380)

By

[Dennis Felsch](https://www.blogger.com/profile/12182286066107494835 "author profile")

at

[August 13, 2018](https://web-in-security.blogspot.com/2018/08/practical-bleichenbacher-attacks-on-ipsec-ike.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4368746671291156803&postID=950597863483439369&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4368746671291156803&postID=950597863483439369&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4368746671291156803&postID=950597863483439369&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4368746671291156803&postID=950597863483439369&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4368746671291156803&postID=950597863483439369&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4368746671291156803&postID=950597863483439369&target=pinterest "Share to Pinterest")

Labels:
[Bleichenbacher's attack](https://web-in-security.blogspot.com/search/label/Bleichenbacher%27s%20attack),
[IPsec](https://web-in-security.blogspot.com/search/label/IPsec)

[Newer Post](https://web-in-security.blogspot.com/2019/02/how-to-spoof-pdf-signatures.html "Newer Post")

[Older Post](https://web-in-security.blogspot.com/2018/08/practical-dictionary-attack-on-ipsec-ike.html "Older Post")

[Home](https://web-in-security.blogspot.com/)

## Beliebte Posts

* [DTD Cheat Sheet](https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html)
  When evaluating the security of XML based services, one should always consider DTD based attack vectors, such as XML External Entities (XXE)...
* [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjNLb0a-zFJzIiZmszBiOQ-lIHh2aTj4QJQPJfex1s7w-4LNHwITmG_E9dIKp6kvDlciE3RI8bU5CaJTP4aZ7hzP00GriKmR8suSbw7Gp95_XcvSUS7GVsSzvXxRPwIPLBbTX7jHvx36wju/w72-h72-p-k-no-nu/example-alexa-750.gif)](https://web-in-security.blogspot.com/2017/07/cors-misconfigurations-on-large-scale.html)

  [CORS misconfigurations on a large scale](https://web-in-security.blogspot.com/2017/07/cors-misconfigurations-on-large-scale.html)
   Inspired by James Kettle 's great OWASP AppSec Europe talk on CORS misconfigurations, we decided to fiddle around with CORS security i...
* [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhADa0hibGGhVGWTfKFqcqtxyVNlGh2vF9YTqrwJW7E2gHJVsqblB0n9zN1tF67ueCteFMdZ5OMwTYn3P_BjZGLvJ5qNwxl1COTo1nPAoAyaLtSLLvu576m_vAV2D_OKsTt9bHQwT_r3u1J/w72-h72-p-k-no-nu/4739678.jpg)](https://web-in-security.blogspot.com/2017/01/printer-security.html)

  [Printer Security](https://web-in-security.blogspot.com/2017/01/printer-security.html)
   Printers belong arguably to the most common devices we use. They are available in every household, office, company, governmental, medic...
* [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiu5MG4NaWNq1kRV5R0p_grxuqkBaqz6jKQEACe1Tu16gBSsD9TshyLkxtyaCAvhKbU_Busl4BLCChQdc0Q0m9J7jEnQdc_Q3jzamBjzvVWa9cBngiKmnnPEZpwiuOdGTZYkxyQouy-Th4/w72-h72-p-k-no-nu/Bildschirmfoto+von+%25C3%2582%25C2%25BB2016-06-15+10-36-31%25C3%2582%25C2%25AB.png)](https://web-in-security.blogspot.com/2016/07/how-to-break-microsoft-rights.html)

  [How to Break Microsoft Rights Management Services](https://web-in-security.blogspot.com/2016/07/how-to-break-microsoft-rights.html)
   In this post, we provide a security analysis of Microsoft Rights Management Services (RMS) and present two working attacks:  We complete...
* [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj8UHg9RU4vEgOVkDT70hZeHP6KTHT4q2U5qqnj_xI2C5MlbfqD79ih5XfAZJE3ouwfNVPy1h9BdBYlcXZU99hYG5K4cxuyXbp_7xPNbjZLJaTzVkAqEuOLCT0i4PdcjrMlepKcJ7ScTSbu/w72-h72-p-k-no-nu/pdf-doc-1.png)](https://web-in-security.blogspot.com/2019/02/how-to-spoof-pdf-signatures.html)

  [How To Spoof PDF Signatures](https://web-in-security.blogspot.com/2019/02/how-to-spoof-pdf-signatures.html)
  One year ago, we received a contract as a PDF file. It was digitally signed. We looked at the document - ignoring the "certificate is n...

## Search This Blog

|  |  |
| --- | --- |

## Blog Archive

* ►
  [2022](https://web-in-security.blogspot.com/2022/)
  (3)
  + ►
    [October](https://web-in-security.blogspot.com/2022/10/)
    (3)

* ►
  [2021](https://web-in-security.blogspot.com/2021/)
  (8)
  + ►
    [October](https://web-in-security.blogspot.com/2021/10/)
    (1)
  + ►
    [June](https://web-in-security.blogspot.com/2021/06/)
    (1)
  + ►
    [May](https://web-in-security.blogspot.com/2021/05/)
    (2)
  + ►
    [February](https://web-in-security.blogspot.com/2021/02/)
    (3)
  + ►
    [January](https://web-in-security.blogspot.com/2021/01/)
    (1)

* ►
  [2020](https://web-in-security.blogspot.com/2020/)
  (3)
  + ►
    [November](https://web-in-security.blogspot.com/2020/11/)
    (1)
  + ►
    [July](https://web-in-security.blogspot.com/2020/07/)
    (1)
  + ►
    [January](https://web-in-security.blogspot.com/2020/01/)
    (1)

* ►
  [2019](https://web-in-security.blogspot.com/2019/)
  (9)
  + ►
    [October](https://web-in-security.blogspot.com/2019/10/)
    (1)
  + ►
    [September](https://web-in-security.blogspot.com/2019/09/)
    (1)
  + ►
    [July](https://web-in-security.blogspot.com/2019/07/)
    (1)
  + ►
    [June](https://web-in-security.blogspot.com/2019/06/)
    (1)
  + ►
    [May](https://web-in-security.blogspot.com/2019/05/)
    (2)
  + ►
    [March](https://web-in-security.blogspot.com/2019/03/)
    (2)
  + ►
    [February](https://web-in-security.blogspot.com/2019/02/)
    (1)

* ▼
  [2018](https://web-in-security.blogspot.com/2018/)
  (6)
  + ▼
    [August](https://web-in-security.blogspot.com/2018/08/)
    (3)
    - [Practical Bleichenbacher Attacks on IPsec IKE](https://web-in-security.blogspot.com/2018/08/practical-bleichenbacher-attacks-on-ipsec-ike.html)
    - [Practical Dictionary Attack on IPsec IKE](https://web-in-security.blogspot.com/2018/08/practical-dictionary-attack-on-ipsec-ike.html)
    - [Save Your Cloud: Gain Root Access to VMs in OpenNe...](https://web-in-security.blogspot.com/2018/08/save-your-cloud-gain-root-access-to-vms.html)
  + ►
    [July](https://web-in-security.blogspot.com/2018/07/)
    (2)
  + ►
    [January](https://web-in-security.blogspot.com/2018/01/)
    (1)

* ►
  [2017](https://web-in-security.blogspot.com/2017/)
  (8)
  + ►
    [December](https://web-in-security.blogspot.com/2017/12/)
    (1)
  + ►
    [August](https://web-in-security.blogspot.com/2017/08/)
    (2)
  + ►
    [July](https://web-in-security.blogspot.com/2017/07/)
    (2)
  + ►
    [June](https://web-in-security.blogspot.com/2017/06/)
    (1)
  + ►
    [January](https://web-in-security.blogspot.com/2017/01/)
    (2)

* ►
  [2016](https://web-in-security.blogspot.com/2016/)
  (6)
  + ►
    [September](https://web-in-security.blogspot.com/2016/09/)
    (1)
  + ►
    [July](https://web-in-security.blogspot.com/2016/07/)
    (1)
  + ►
    [May](https://web-in-security.blogspot.com/2016/05/)
    (1)
  + ►
    [March](https://web-in-security.blogspot.com/2016/03/)
    (2)
  + ►
    [January](https://web-in-security.blogspot.com/2016/01/)
    (1)

* ►
  [2015](https://web-in-security.blogspot.com/2015/)
  (12)
  + ►
    [December](https://web-in-security.blogspot.com/2015/12/)
    (1)
  + ►
    [November](https://web-in-security.blogspot.com/2015/11/)
    (2)
  + ►
    [October](https://web-in-security.blogspot.com/2015/10/)
    (1)
  + ►
    [September](https://web-in-security.blogspot.com/2015/09/)
    (1)
  + ►
    [August](https://web-in-security.blogspot.com/2015/08/)
    (1)
  + ►
    [June](https://web-in-security.blogspot.com/2015/06/)
    (1)
  + ►
    [May](https://web-in-security.blogspot.com/2015/05/)
    (1)
  + ►
    [April](https://web-in-security.blogspot.com/2015/04/)
    (2)
  + ►
    [January](https://web-in-security.blogspot.com/2015/01/)
    (2)

* ►
  [2014](https://web-in-security.blogspot.com/2014/)
  (8)
  + ►
    [December](https://web-in-security.blogspot.com/2014/12/)
    (3)
  + ►
    [November](https://web-in-security.blogspot.com/2014/11/)
    (2)
  + ►
    [October](https://web-in-security.blogspot.com/2014/10/)
    (2)
  + ►
    [August](https://web-in-security.blogspot.com/2014/08/)
    (1)

## Beliebte Posts

* [DTD Cheat Sheet](https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html)
* [CORS misconfigurations on a large scale](https://web-in-security.blogspot.com/2017/07/cors-misconfigurations-on-large-scale.html)
* [Printer Security](https://web-in-security.blogspot.com/2017/01/printer-security.html)
* [How to Break Microsoft Rights Management Services](https://web-in-security.blogspot.com/2016/07/how-to-break-microsoft-rights.html)
* [How To Spoof PDF Signatures](https://web-in-security.blogspot.com/2019/02/how-to-spoof-pdf-signatures.html)

## Contributors

* [Christian Mainka](https://www.blogger.com/profile/03101190660160388247)
* [Dennis Felsch](https://www.blogger.com/profile/12182286066107494835)
* [Dominik Noss](https://www.blogger.com/profile/09630455338217988219)
* [Jens Müller](https://www.blogger.com/profile/00175179986359584758)
* [Juraj Somorovsky](https://www.blogger.com/profile/10091106963061940906)
* [Louis](https://www.blogger.com/profile/00904431686503247027)
* [Marcus Brinkmann](https://www.blogger.com/profile/04089113267366742328)
* [Marcus Niemietz](https://www.blogger.com/profile/05855449018819534912)
* [Paul Rösler](https://www.blogger.com/profile/07715695421532677074)
* [Simon Rohlmann](https://www.blogger.com/profile/00939138882293992102)
* [Tibor](https://www.blogger.com/profile/17916718858123463390)
* [Vladislav Mladenov](https://www.blogger.com/profile/17414364386706504989)
* [Vladislav Mladenov](https://www.blogger.com/profile/04175238043874429160)
* [ic0ns](https://www.blogger.com/profile/05268217928620872405)

|  |  |
| --- | --- |

|  |  |
| --- | --- |

Simple theme. Powered by [Blogger](https://www.blogger.com).



=== Content from www.zyxel.com_1bee1332_20250126_024329.html ===



=== Content from www.clavister.com_12b570f3_20250126_024329.html ===

[![MyClavister](/static/gfx/myclavister-logo-white.png)](/)

* [Login](/login/)
* [Privacy & Cookies](/privacy-cookies-policy/)
* [Clavister.com](https://www.clavister.com)

##### MyClavister Feedback

×

Help us improve MyClavister by writing a review below. Any feedback is appreciated and will help us provide the best possible service for you.

How would you rate MyClavister?
☆
☆
☆
☆
☆

Review

###

Thank you for submitting feedback on MyClavister!

Close
Submit

[Advisories](/advisories/)
[Security](/advisories/security/)

# Security Advisories

## CLAV-SA-0157 Bleichenbacher Oracle Vulnerability in IKEv1

 [Back to list](/advisories/security/)

| **Advisory ID** | CLAV-SA-0157 |
| --- | --- |
| **Summary** | Bleichenbacher Oracle Vulnerability in IKEv1 |
| **Updated** | 2018-08-15 |
| **First Published** | 2018-08-15 |
| **Impact** | Medium |
| **CVSS URL** | <https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:W/RC:C> |
| **CVSS Score** | 5.9 |
| **CVEs** | * [CVE‑2018‑8753](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8753) |
| **Affected Products** | * cOS Core |

## Introduction

Clavister's implementation of IKEv1 contains an oracle for PKCS#1 validity. An Attacker can determine whether the plain-text with the nonce sent in the third message of the handshake was PKCS#1-valid by examining the error message returned by the firewall.

## Detailed Description

Clavister's IKEv1 implementation contains an oracle for PKCS#1 validity. You can determine whether the plain-text with the nonce sent in the third message of the handshake was PKCS#1-valid by examining the error message returned by the firewall. If the error message contains the text "Data length too large for private key to decrypt", then the plain-text was valid (despite the error). If the error message is only 8 bytes long, then the plain-text was invalid.

The researchers implemented and tested an attack against cOS Core version 12.00.06. The attack efficiency has a random component that makes it hard to estimate how long it will take before an attacker can achieve successful decryption. The fastest attack the researchers performed in their test setup took 9400 requests to the firewall and 51 minutes.

The attack works as follows:

1. The attacker gets a single cipher-text (e.g. by eavesdropping it)
2. The attacker creates new cipher-texts by modifying the original one exploiting some mathematical properties of RSA.
3. The new cipher-texts are sent to the server observing its reaction.
4. After doing this for thousands of cipher-texts, the attacker can decrypt the original cipher-text without the key.

Due to the timeouts of IKE SAs, the missing configuration options, and the Diffie-Hellman key exchange, it's not possible to attack the IKEv1 handshake with RSA encrypted nonces directly. However, since the gateway certificate of the device may be reused for other purposes, an attacker could e.g. attack the TLS protection of the configuration website of the firewall.

For more details check the researchers blog post linked in the references section of this advisory.

## Affected Versions

The following versions are affected by this vulnerability:

1. All cOS Core 12.00.xx versions before 12.00.09
2. All cOS Core 11.20.xx versions before 11.20.06
3. All cOS Core 11.00.xx versions before 11.00.11
4. Any older versions of cOS Core with IKEv1 support

## Fix Information

RSA authentication was permanently disabled for IKEv1.

## Security Patches

The vulnerability was fixed in the following versions:

1. cOS Core 12.00.09
2. cOS Core 11.20.06
3. cOS Core 11.00.11

Updated versions are available for download through My Clavister portal ([Link](https://www.clavister.com/))

## References

* <https://web-in-security.blogspot.com/2018/08/practical-bleichenbacher-attacks-on-ipsec-ike.html>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8753>

## Acknowledgements

Clavister thanks the following researchers for their responsible disclosure and continuous assistance during the vulnerability triage process:

* **Dennis Felsch** *(Ruhr-University Bochum)*
* **Martin Grothe** *(Ruhr-University Bochum)*
* **Jörg Schwenk** *(Ruhr-University Bochum)*
* **Adam Czubak** *(University of Opole)*
* **Marcin Szymanek** *(University of Opole)*

## Contact

* E-mail: <security@[clavister.com](http://clavister.com/)>
* PGP: id 8813E86F, fingerprint A91407250F753C1D27263A7EBE9E30498813E86F
* WWW: Tickets can also be created through <https://www.clavister.com/>


