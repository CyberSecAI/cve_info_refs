=== Content from www.zend.com_7cc19f43_20250125_162428.html ===
[Skip to main content](#main-content)[Created with Avocode.](https://www.perforce.com "Perforce")
### Secondary Navigation

* [PHP Security Center](/php-security-center)
* [Blog](/blog)
* [Store](/announcement/zend-store-announcement)
* [Downloads](/downloads)
  + [Downloads](/downloads)
  + [Plugins](/plugins)
  + [MyZend Account](https://www.zend-zce.com/en/user/loginregister)
* [Company](/about)
  + [About Zend by Perforce](/about)
  + [Careers at Perforce](https://www.perforce.com/careers)
  + [Customers](/customers)
  + [Partners](/partners)
  + [Press](/press/press-releases)
* [Contact](/contact-us)
  + [Contact Us](/contact-us)
  + [Request Pricing](/pricing)
  + [Request Support](https://portal.perforce.com/s/)
  + [Subscribe](/subscription-management-center)
[![Home](/sites/default/themes/custom/zend/logo.svg)](/)[Zend](/)
### Main Navigation - Mega Menu

* Products
  ### Main Navigation - Mega Menu

  + [ZendPHP](/products/zendphp-enterprise "PHP Runtime and Support")PHP Runtime and Support
  + [PHP LTS](/services/php-long-term-support "Patches for EOL PHP")Patches for EOL PHP
  + [ZendHQ](/products/zendphp-enterprise/zendhq "Must-Have Extension for ZendPHP")Must-Have Extension for ZendPHP
  + [Zend Server](/products/zend-server "PHP Application Server")PHP Application Server
* Services
  ### Main Navigation - Mega Menu

  + [Service Overview](/services)
  + [Migration Services](/services/migration)
  + [Audits](/services/performance-auditing)
  + [CI/CD](/services/continuous-delivery)
  + [Custom Consulting](/services/custom-consulting)
  + [Admin as a Service](/services/admin-as-a-service)

  ![Services](https://www.zend.com/sites/zend/files/image/2019-09/image-services-migration-php7_0.png)

  Innovate faster and cut risk with PHP experts from Zend Services.

  [Explore Services](/services)
* Solutions
  ### Main Navigation - Mega Menu

  + [PHP Cloud Solutions](https://www.zend.com/solutions/cloud)
  + [PHP Container Solutions](https://www.zend.com/solutions/containers)
  + [PHP Security Solutions](https://www.zend.com/solutions/security)
  + [Windows Solutions](https://www.zend.com/solutions/php-windows)
  + [Hosting Provider Solutions](https://www.zend.com/solutions/php-hosting-providers)

  ![Zend Solutions Cloud](/sites/default/files/image/2021-06/image-webinar-cloud-orchestration.jpg)

  See How Zend Helps Leading Hosting Providers Keep Their Managed Sites on Secure PHP

  [Read More](/solutions/php-hosting-providers)
* Training
  ### Main Navigation - Mega Menu

  + [Training Overview](/training/php)

  ![Training](https://www.zend.com/sites/default/files/image/2024-01/iamge-zend-training-courses-computer.jpg)

  Learn PHP from PHP experts with free, on-demand, and instructor led courses.

  [Explore Training](/training/php)
* Resources
  ### Main Navigation - Mega Menu

  + [Explore Resources](/resources)
  + [Events & Webinars](/resources/events)
  + [Papers & Videos](/resources/papers-and-videos)
  + [Recorded Webinars](/resources/recorded-webinars)
  + [Blog](/blog)[![Cloud Orchestration]()](/webinars/orchestrating-your-php-applications)
  ### [Orchestrating Your PHP Applications](/webinars/orchestrating-your-php-applications)

  [Watch Now](/webinars/orchestrating-your-php-applications)
* Support
  ### Main Navigation - Mega Menu

  + [Explore Support](/support)
  + [PHP Long-Term Support](/services/php-long-term-support)
  + [Knowledgebase](https://portal.perforce.com/s/topic/0TO5Y00000ByxvrWAB/zend)
  + [Documentation](https://help.zend.com/)
  + [Download Software](/downloads)
  + [Download Plugins](/plugins)
  + [Request Support](https://portal.perforce.com)

  ![Support](/sites/zend/files/image/2020-09/zend-mega-menu-support.jpg)

  Submit support requests and browse self-service resources.

  [Explore Support](/support)
* [Try Free](/products/zendphp-enterprise/trial)
* [PHP Security Center](/resources/php-security-center)
* [Blog](/blog)
* [Store](https://www.roguewave.com/zend-store/)
* Downloads
  ### Main Navigation - Mega Menu

  + [Downloads](/downloads)
  + [Plugins](/plugins)
  + [MyZend Account](https://www.zend-zce.com/en/user/loginregister)
  + [Downloads](/downloads)
  + [Plugins](/plugins)
  + [MyZend Account](https://www.zend-zce.com/en/user/loginregister)
* Company
  ### Main Navigation - Mega Menu

  + [About Zend by Perforce](/about)
  + [Careers at Perforce](https://www.perforce.com/careers)
  + [Customers](/customers)
  + [Partners](/partners)
  + [About Zend by Perforce](/about)
  + [Careers at Perforce](https://www.perforce.com/careers)
  + [Customers](/customers)
  + [Partners](/partners)
* Contact
  ### Main Navigation - Mega Menu

  + [Contact Us](/contact-us)
  + [Request Support](https://jira.roguewave.com/servicedesk/customer/portal/9/user/login)
  + [Subscribe](/subscription-management-center)
# Solvingthe Hardest Problemsin PHP

Solve your hardest PHP problems with industry-leading products and services from Zend, including LTS for PHP 7.2, 7.3, 7.4, and 8.0.

Talk to Our[PHP](/contact-us)Experts Today

## Secured PHP Runtimes and PHP LTS

Maintain compliance when using EOL PHP, with:

* Backported PHP patches for EOL PHP
* LTS for PHP 7.2, 7.3, 7.4, and 8.0
* Dedicated 24/7/365 support
* Container and cloud-ready PHP images

[Discover ZendPHP](/products/zendphp-enterprise)

## Make Our PHP Experts Your PHP Experts

Now offering a full suite of services, including:

* Migration Services
* Consultative Services
* Performance Auditing
* Modernization Services

[See Service Options](/services)

## PHP Monitoring and Debugging Made Easy

Maintain compliance when using EOL PHP, with:

* Plug and play PHP monitoring
* Instantly profile / debug your PHP app
* Easy-to-use orchestration tooling

[Experience ZendHQ](/products/zendphp-enterprise/zendhq)

## All-In-One PHP Application Server

All the pieces you need for lightning-fast PHP dev.

* Code tracing and JobQueue functionality
* Automated PHP updates and patches
* Performance monitoring and debugging
* Ready-to-go extensions and plugins

[Explore Zend Server](/products/zend-server)

## See Why Zend Is the Top Choice for PHP

For over 20 years, Zend has been trusted by Fortune 100 businesses around the world.

[SEE CASE STUDIES](/customers)

![mittwald]()
## mittwald Managed Hosting Customers Stay Secure With PHP LTS From Zend

mittwald, a global leader in web hosting, partnered with Zend to deliver value, security, and peace of mind to their customers.

[READ THE CASE STUDY](https://www.zend.com/customers/case-studies/mittwald)

### “Zend’s deep PHP expertise and easy-to-integrate LTS builds streamlined our processes — allowing us to deliver value and a stress-free experience to our customers.”

Your browser does not support the video tag.
## World-Class PHP Training

Learn PHP – from PHP basics to advanced  – all from Zend PHP experts.
Free, on-demand, and instructor-led courses now available.

[SEE AVAILABLE COURSES](/training/php)

## Connect With Our PHP Experts

rgb(0,207,255)
### Footer menu

* [Products](/products)
  + [ZendPHP](/products/zendphp-enterprise)
  + [PHP Long-Term Support](/services/php-long-term-support)
  + [ZendHQ](/products/zendphp-enterprise/zendhq)
  + [Zend Server](/products/zend-server)
  + [Laminas Enterprise Support](/products/laminas-enterprise-support)
  + [PHP Development Tools](/products/php-tools)
* [Services](/services)
  + [PHP Long-Term Support](/services/php-long-term-support)
  + [Migration Services](/services/migration)
  + [Audits](/services/performance-auditing)
  + [CI/CD Services](/services/continuous-delivery)
  + [Custom Consulting](/services/custom-consulting)
  + [Admin as a Service](/services/admin-as-a-service)
* [Free Trials and Demos](/free-trial)
  + [ZendPHP Trial](/products/zendphp-enterprise/trial)
  + [Zend Server Trial](/free-trial)
  + [ZendHQ Demo](/products/zendphp-enterprise/zendhq/demo)
* [Training](/training/php)
* [Resources](/resources)
  + [PHP Security Center](/php-security-center)
  + [Papers & Videos](/resources/papers-and-videos)
  + [Events & Webinars](/resources/events)
  + [Recorded Webinars](/resources/recorded-webinars)
  + [Blog](/blog)
  + [Case Studies](/customers)
* [Hubs](/resources/developing-web-applications-php)
  + [PHP Versions Guide](/resources/php-versions)
  + [Developing Web Apps With PHP](/resources/developing-web-applications-php)
  + [Guide to PHP and IBM i](/resources/guide-php-ibm-i)
  + [PHP Security](/resources/php-security)
* [Store](/announcement/zend-store-announcement)
* [Downloads](/downloads)
  + [MyZend Account](https://www.zend-zce.com/en/user/loginregister)
  + [Plugins](/plugins)
  + [Container Registry](https://cr.zend.com/)
* [Support](/support)
  + [PHP Long-term Support](/services/php-long-term-support)
  + [Knowledgebase](https://portal.perforce.com/s/topic/0TO5Y00000ByxvrWAB/zend)
  + [Documentation](https://help.zend.com/)
  + [Software End of Life Policy](https://www.perforce.com/support/eol-policy)
* [Contact](/contact-us)
  + [Request Pricing](/pricing)
  + [Request Support](https://portal.perforce.com/s/)
  + [Subscribe](/subscription-management-center)
* [Company](/about)
  + [About Zend by Perforce](/about)
  + [Careers at Perforce](https://www.perforce.com/careers)
  + [Customers](/customers)
  + [Partners](/partners)
  + [Press](/press/press-releases)
[![Home](/sites/default/themes/custom/zend/logo.svg)](/)

Zend by [Perforce](https://www.perforce.com) ©  Perforce Software, Inc.
[Terms of Use](/terms-use)  |  [Privacy Policy](/privacy-policy) | [Sitemap](/sitemap)

### Social Menu

* [Facebook](https://www.facebook.com/ZendTechnologies/)
* [LinkedIn](https://www.linkedin.com/company/zend-technologies/)
* [Twitter](https://twitter.com/zend)
* [YouTube](https://www.youtube.com/user/ZendTechnologies)
* [RSS](/blog/feed)
Send Feedback



=== Content from www.synacktiv.com_5826a019_20250125_162427.html ===
Cross-Site Scripting vulnerabilities
in Zend Server < 9.1.3

Security advisory
2018-04-23

Thomas Chauchefoin
Julien Egloff

www.synacktiv.com

5 rue Sextius Michel 75015 Paris

Vulnerability description

Presentation of Zend Server / Zend Debugger
“With Zend Server, development and operation teams are equipped with the software infrastructure, tools, and best practices
for productive collaboration and continuous delivery of their mobile and web apps with exceptional performance, reliability,
and security.”1

“The Zend Debugger is the PHP extension which should be installed on your Web server in order to perform optimal remote
debugging and profiling using Zend Studio. […] The Zend Debugger comes bundled with both Zend Core and Zend Platform
and does not need to be installed separately.”2

The issue
Synacktiv discovered that Zend Debugger does not correctly encode user-controlled data before using it in error messages.
Thus, an attacker could abuse it to craft arbitrary HTML elements in server’s response, leading to a possibility of Cross-Site
Scripting (XSS) attacks. Technical details are documented in the Attack scenario part of this document.

The  only  requirement   is  that  the  Zend   Debugger  module   has  to  be   loaded  and   enabled.  It   does   not   require  any  prior
authentication and will work for any domain served by the web server where this module is present.

It should be noted that this vulnerability does not appear to be present in production mode and that development instances of
Zend Server are not supposed to be exposed to the Internet.

Affected versions
The following versions are known to be affected:

•

Zend Debugger, bundled with Zend Server 9.0.1 up to 9.1.3 and up to 8.5.9.

Official mitigation
Zend Server 8.5.9 and 9.1.3 bundle a fixed version of Zend Debugger.

Timeline

Date

2018-02-02

2018-04-17

2018-04-19

2018-04-23

Action

Advisory sent to Zend.

Zend publishes Zend Server 8.5.9 and 9.3.13.

MITRE assigns CVE-2018-10230 to the vulnerability.

Advisory published.

1 http://www.zend.com/en/products/zend_server

2 https://www.zend.com/topics/Zend-Debugger-Installation-Guide.pdf

3 http://forums.zend.com/viewtopic.php?f=8&t=134223

 2/3

Technical description and proof-of-concept

Initial vulnerability discovery
In  ZendDebugger.so, the function at  0x00015D10 is responsible of  handling user’s connection and retrieving the actual
configuration directives (from URL parameters or configuration file). When asking the debugger to connect back to a host,
Zend Debugger will try to resolve its hostname (if applicable) and then connect to it. If it fails to resolve the domain name or
connect to the host, the value extracted from the URL parameter debug_host will be inserted into server’s response without
a proper encoding:

  while ( 1 )
  {
    [...]
    if ( zend_debugger_lookup_hostname(host_2, &addr_1.sa_data[2]) == -1 )
    {
      zend_realloc_printf(v41, "Failed to resolve host '%s'. ", host_2, v41);
      goto SKIP_CONNECT;
    }
    if ( zend_debugger_check_ip_allowed(&addr_1, 16LL, host_2, v41) )
      goto SKIP_CONNECT;
    if ( !connect(v4, &addr_1, 0x10u) )
      break;
    zend_realloc_printf(v41, "Failed to connect to host '%s'. ", host_2, v41);

At 0x0001E3E0, some code is responsible for matching denied / allowed hosts with the one provided in  debug_host, as
well as returning an error message if it is not allowed:

    if ( allowed_hosts )
    {
      if ( *allowed_hosts )
      {
LABEL_24:
        if ( zend_match_host_masks(host, allowed_hosts, ',') == -1 )
        {
          zend_realloc_printf(
            out_buffer,
            "Host '%s' is not allowed to open debug sessions - please configure
zend_debugger.allow_hosts in the ini file.",
            host);
          return 0xFFFFFFFFLL;
        }
      }
    }

Once again, the user-controlled value is not properly encoded before being inserted into the response. All the other error
messages formatted using debug_host are affected and must be fixed.

Proof of concept
On any host where the module is installed and enabled, an attacker can trigger this vulnerability by adding his payload in the
parameter debug_host, like in the following example:

index.php?debug_host=synacktiv.ninja<script>alert(document.domain)</script>&start_debug=1

Impact
A successful  exploitation   allows  an  unauthenticated  attacker  to  craft  hyperlinks  that,   once  accessed  by a  victim, would
execute arbitrary JavaScript code in his browser in the context of the website. Thus, if this victim is currently authenticated to
this website (for instance via session cookies), the attacker would be able to perform actions on this website on victim’s
behalf. If the victim is not authenticated, this could still allow performing phishing attacks to steal credentials.

 3/3


