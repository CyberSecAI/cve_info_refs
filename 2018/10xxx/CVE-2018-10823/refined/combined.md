=== Content from sploit.tech_41115771_20250125_130031.html ===

[sploit.tech](/)

[About](/about/)

Found CVEs:

* [CVE-2015-5459](/2015/06/30/ManageEngine-Password-Manager-Pro-SQL-injection.html)
* [CVE-2017-15653](/2018/01/16/ASUS-part-II.html)
* [CVE-2017-15654](/2018/01/16/ASUS-part-II.html)
* [CVE-2017-15655](/2018/01/16/ASUS-part-I.html)
* [CVE-2017-15656](/2018/01/16/ASUS-part-II.html)
* [CVE-2018-10822](/2018/10/12/D-Link.html)
* [CVE-2018-10823](/2018/10/12/D-Link.html)
* [CVE-2018-10824](/2018/10/12/D-Link.html)
* [CVE-2019-19822](/2019/12/16/Realtek-TOTOLINK.html)
* [CVE-2019-19823](/2019/12/16/Realtek-TOTOLINK.html)
* [CVE-2019-19824](/2019/12/16/Realtek-TOTOLINK.html)
* [CVE-2019-19825](/2019/12/16/Realtek-TOTOLINK.html)
* [CVE-2020-13449](/2020/12/29/Gotenberg.html)
* [CVE-2020-13450](/2020/12/29/Gotenberg.html)
* [CVE-2020-13451](/2020/12/29/Gotenberg.html)
* [CVE-2020-13452](/2020/12/29/Gotenberg.html)
* [CVE-2024-11716](/2024/12/24/CTFd.html)
* [CVE-2024-11717](/2024/12/24/CTFd.html)

# D-Link routers - full takeover

Oct 12, 2018

I have found multiple vulnerabilities in D-Link router httpd server. These vulnerabilities are present in multiple D-Link types of routers. All three taken together allow to take a full control over te router including code execution.

---

# 1. Directory Traversal

**CVE**: CVE-2018-10822

**CVSS v3**: 8.6

AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N

**Description**:
Directory traversal vulnerability in the web interface on D-Link routers:

* DWR-116 through 1.06,
* DIR-140L through 1.02,
* DIR-640L through 1.02,
* DWR-512 through 2.02,
* DWR-712 through 2.02,
* DWR-912 through 2.02,
* DWR-921 through 2.02,
* DWR-111 through 1.01,
* and probably others with the same type of firmware

allows remote attackers to read arbitrary files via a /.. or // after âGET /uirâ in an HTTP request.

NOTE: this vulnerability exists because of an incorrect fix for CVE-2017-6190.

PoC:

```
$ curl http://routerip/uir//etc/passwd

```

The vulnerability can be used retrieve administrative password using the other disclosed vulnerability - CVE-2018-10824.

This vulnerability was reported previously by Patryk Bogdan in CVE-2017-6190 but he reported it is fixed in certain release but unfortunately it is still present in even newer releases. The vulnerability is also present in other D-Link routers and can be
exploited not only (as the original author stated) by double dot but also absolutely using double slash.

---

# 2. Password stored in plaintext

**CVE**: CVE-2018-10824

**Description**:

An issue was discovered on D-Link routers:

* DWR-116 through 1.06,
* DIR-140L through 1.02,
* DIR-640L through 1.02,
* DWR-512 through 2.02,
* DWR-712 through 2.02,
* DWR-912 through 2.02,
* DWR-921 through 2.02,
* DWR-111 through 1.01,
* and probably others with the same type of firmware.

NOTE: I have changed the filename in description to XXX because the vendor leaves some EOL routers unpatched and the attack is too simple

The administrative password is stored in plaintext in the /tmp/XXX/0 file. An attacker having a directory traversal (or LFI) can easily get full router access.

PoC using the directory traversal vulnerability disclosed above - CVE-2018-10822

```
$ curl http://routerip/uir//tmp/XXX/0

```

This command returns a binary config file which contains admin username and password as well as many other router configuration settings. By using the directory traversal vulnerability it is possible to read the file without authentication.

---

# 3. Shell command injection

**CVE**: CVE-2018-10823

**CVSS v3**: 9.1

AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H

**Description**:
An issue was discovered on D-Link routers:

* DWR-116 through 1.06,
* DWR-512 through 2.02,
* DWR-712 through 2.02,
* DWR-912 through 2.02,
* DWR-921 through 2.02,
* DWR-111 through 1.01,
* and probably others with the same type of firmware.

An authenticated attacker may execute arbitrary code by injecting the shell command into the chkisg.htm page Sip parameter. This allows for full control over the device internals.

PoC:

1. Login to the router.
2. Request the following URL after login:
   ```
   $ curl http://routerip/chkisg.htm%3FSip%3D1.1.1.1%20%7C%20cat%20%2Fetc%2Fpasswd

   ```
3. See the passwd file contents in the response.

---

# Exploiting all together

Taking all the three together it is easy to gain full router control including arbitrary code execution.

Suggested **CVSS v3** for all three (1-3): **10.0**

AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

**Video**:

**Timeline**:

* 09.05.2018 - vendor notified
* 06.06.2018 - asked vendor about the status because of long vendor response
* 22.06.2018 - recieved a reply that a patch will be released for DWR-116 and DWR-111, for the other devices which are EOL an announcement will be released
* 09.09.2018 - still no reply from vendor about the patches or announcement, I have warned the vendor that if I will not get a reply in a month I will publish the disclosure
* 12.10.2018 - disclosing the vulnerabilities

---

tags:
[CVE](/tags/CVE)
[D-Link](/tags/D-Link)
[router](/tags/router)
[CVE-2018-10822](/tags/CVE-2018-10822)
[CVE-2018-10823](/tags/CVE-2018-10823)
[CVE-2018-10824](/tags/CVE-2018-10824)

All blog tags:

* [CVE (5)](/tags/CVE)
* [ASUS (2)](/tags/ASUS)
* [router (2)](/tags/router)
* [ManageEngine (1)](/tags/ManageEngine)
* [Password (1)](/tags/Password)
* [Manager (1)](/tags/Manager)
* [Plus (1)](/tags/Plus)
* [CVE-2015-5459 (1)](/tags/CVE-2015-5459)
* [CVE-2017-15655 (1)](/tags/CVE-2017-15655)
* [CVE-2017-15653 (1)](/tags/CVE-2017-15653)
* [CVE-2017-15654 (1)](/tags/CVE-2017-15654)
* [CVE-2017-15656 (1)](/tags/CVE-2017-15656)
* [D-Link (1)](/tags/D-Link)
* [CVE-2018-10822 (1)](/tags/CVE-2018-10822)
* [CVE-2018-10823 (1)](/tags/CVE-2018-10823)
* [CVE-2018-10824 (1)](/tags/CVE-2018-10824)
* [TOTOLINK (1)](/tags/TOTOLINK)
* [Realtek (1)](/tags/Realtek)
* [SDK (1)](/tags/SDK)
* [CVE-2019-19822 (1)](/tags/CVE-2019-19822)
* [CVE-2019-19823 (1)](/tags/CVE-2019-19823)
* [CVE-2019-19824 (1)](/tags/CVE-2019-19824)
* [CVE-2019-19825 (1)](/tags/CVE-2019-19825)
* [Gotenberg (1)](/tags/Gotenberg)
* [PDF (1)](/tags/PDF)
* [CVE-2020-13449 (1)](/tags/CVE-2020-13449)
* [CVE-2020-13450 (1)](/tags/CVE-2020-13450)
* [CVE-2020-13451 (1)](/tags/CVE-2020-13451)
* [CVE-2020-13452 (1)](/tags/CVE-2020-13452)
* [CTF (1)](/tags/CTF)
* [CTFd (1)](/tags/CTFd)
* [CVE-2024-11716 (1)](/tags/CVE-2024-11716)
* [CVE-2024-11717 (1)](/tags/CVE-2024-11717)

## sploit.tech

* Blazej Adamczyk (br0x)
* me@br0x.pl

* [br0xpl](https://github.com/br0xpl)

sploit.tech - security research team focused at finding juicy vulnerabilities here and there, feel free to join us!



=== Content from seclists.org_23dd7925_20250125_130032.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](33)
[By Date](date.html#36)
[![Next](/images/right-icon-16x16.png)](37)

[![Previous](/images/left-icon-16x16.png)](33)
[By Thread](index.html#36)
[![Next](/images/right-icon-16x16.png)](38)

![](/shared/images/nst-icons.svg#search)

# Multiple vulnerabilities in D-Link routers

---

*From*: Błażej Adamczyk <blazej.adamczyk () gmail com>

*Date*: Fri, 12 Oct 2018 16:54:08 +0200

---

```
              ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
               MULTIPLE VULNERABILITIES IN D-LINK ROUTERS

                         Blazej Adamczyk (br0x)
                       blazej.adamczyk () gmail com
                          <http://sploit.tech/>
              ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

                               12.10.2018

1 Directory Traversal in httpd server in several series of D-Link
routers
═══════════════════════════════════════════════════════════════════════
══

  CVE: CVE-2018-10822

  CVSS v3: 8.6 (AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N)

  Directory traversal vulnerability in the web interface on D-Link
  routers:
  • DWR-116 through 1.06,
  • DIR-140L through 1.02,
  • DIR-640L through 1.02,
  • DWR-512 through 2.02,
  • DWR-712 through 2.02,
  • DWR-912 through 2.02,
  • DWR-921 through 2.02,
  • DWR-111 through 1.01,
  • and probably others with the same type of firmware

  allows remote attackers to read arbitrary files via a /.. or // after
  "GET /uir" in an HTTP request.

  NOTE: this vulnerability exists because of an incorrect fix for
  CVE-2017-6190.

  PoC:
  ┌────
  │ $ curl <http://routerip/uir//etc/passwd>
  └────

  The vulnerability can be used retrieve administrative password using
  the other disclosed vulnerability - CVE-2018-10824

  This vulnerability was reported previously by Patryk Bogdan in
  CVE-2017-6190 but he reported it is fixed in certain release but
  unfortunately it is still present in even newer releases. The
  vulnerability is also present in other D-Link routers and can be
  exploited not only (as the original author stated) by double dot but
  also absolutely using double slash.

2 Password stored in plaintext in several series of D-Link routers
══════════════════════════════════════════════════════════════════

  CVE: CVE-2018-10824

  An issue was discovered on D-Link routers:
  • DWR-116 through 1.06,
  • DIR-140L through 1.02,
  • DIR-640L through 1.02,
  • DWR-512 through 2.02,
  • DWR-712 through 2.02,
  • DWR-912 through 2.02,
  • DWR-921 through 2.02,
  • DWR-111 through 1.01,
  • and probably others with the same type of firmware.

  NOTE: I have changed the filename in description to XXX because the
  vendor leaves some EOL routers unpatched and the attack is too
simple.

  The administrative password is stored in plaintext in the /tmp/XXX/0
  file. An attacker having a directory traversal (or LFI) can easily
get
  full router access.

  PoC using the directory traversal vulnerability disclosed at the same
  time - CVE-2018-10822

  ┌────
  │ $ curl <http://routerip/uir//tmp/XXX/0>
  └────

  This command returns a binary config file which contains admin
  username and password as well as many other router configuration
  settings. By using the directory traversal vulnerability it is
  possible to read the file without authentication.

3 Shell command injection in httpd server of a several series of D-Link
routers
═══════════════════════════════════════════════════════════════════════
════════

  CVE: CVE-2018-10823

  CVSS v3: 9.1 (AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H)

  An issue was discovered on D-Link routers:
  • DWR-116 through 1.06,
  • DWR-512 through 2.02,
  • DWR-712 through 2.02,
  • DWR-912 through 2.02,
  • DWR-921 through 2.02,
  • DWR-111 through 1.01,
  • and probably others with the same type of firmware.

  An authenticated attacker may execute arbitrary code by injecting the
  shell command into the chkisg.htm page Sip parameter. This allows for
  full control over the device internals.

  PoC:
  1. Login to the router.
  2. Request the following URL after login:
     ┌────
     │ $ curl <http://routerip/chkisg.htm%3FSip%3D1.1.1.1%20%7C%20cat%20>
%2Fetc%2Fpasswd
     └────
  3. See the passwd file contents in the response.

4 Exploiting all together
═════════════════════════

  CVSS v3: 10 (AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

  Taking all the three together it is easy to gain full router control
  including arbitrary code execution.

  Description with video: [<http://sploit.tech/2018/10/12/D-Link.html>]

5 Timeline
══════════

  • 09.05.2018 - vendor notified
  • 06.06.2018 - asked vendor about the status because of long vendor
    response
  • 22.06.2018 - received a reply that a patch will be released for
    DWR-116 and DWR-111, for the other devices which are EOL an
    announcement will be released
  • 09.09.2018 - still no reply from vendor about the patches or
    announcement, I have warned the vendor that if I will not get a
    reply in a month I will publish the disclosure
  • 12.10.2018 - disclosing the vulnerabilities

```

**Attachment:
[signature.asc](att-36/signature_asc.bin)**

*Description:* This is a digitally signed message part

```

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](33)
[By Date](date.html#36)
[![Next](/images/right-icon-16x16.png)](37)

[![Previous](/images/left-icon-16x16.png)](33)
[By Thread](index.html#36)
[![Next](/images/right-icon-16x16.png)](38)

### Current thread:

* **Multiple vulnerabilities in D-Link routers** *Błażej Adamczyk (Oct 16)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


