- **Root cause of vulnerability**: The vulnerability lies in the improper implementation of code signing API checks by third-party developers when handling Fat/Universal binaries. Specifically, the API `SecCodeCheckValidity` does not verify the CA root of trust for nested binaries within a Fat/Universal file after verifying the first binary. This allows an attacker to include a malicious, ad-hoc signed binary within a Fat/Universal file that is checked as valid.
- **Weaknesses/vulnerabilities present**:
    - Lack of CA root of trust verification for nested binaries within Fat/Universal files.
    - Preference for native CPU architecture during code signing checks, which can be bypassed by including a non-native architecture binary ahead in the file.
    - Improper usage of code signing APIs by third-party developers, who fail to verify all architectures within Fat/Universal files and apply the “anchor apple” requirement.
- **Impact of exploitation**:
    - Bypassing code signing checks can lead to the execution of malicious, unsigned code, which is incorrectly identified as valid by security tools.
    - Undermines the trust in code signing and impacts various security products such as whitelisting, antivirus, incident response, and threat hunting.
    - Malicious code can be disguised as valid, signed code, potentially evading detection and compromising systems.
- **Attack vectors**:
    - Creation of a malformed Fat/Universal file that includes an Apple-signed binary as the first entry and a malicious ad-hoc signed binary as a subsequent entry.
    - Setting the CPU type in the Fat header of the Apple binary to an invalid type or one not native to the target host, causing the loader to execute the malicious binary.
- **Required attacker capabilities/position**:
    - Ability to create a Fat/Universal file with a signed Apple binary as the first entry and an ad-hoc signed malicious binary as a subsequent entry.
    - No admin access or memory corruption is required.
    - Needs knowledge of the Fat/Universal file format and how code signing APIs function.