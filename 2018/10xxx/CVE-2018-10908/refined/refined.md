```
{
  "vulnerability_details": {
    "root_cause": "The `qemu-img` tool, when processing untrusted image files, is vulnerable to excessive memory or CPU consumption if a crafted image is provided. VDSM, which uses `qemu-img`, was not limiting resources for the qemu-img process.",
    "weaknesses": [
      "VDSM calls `qemu-img` without resource limits",
      "The `qemu-img` tool is susceptible to DoS by crafted images"
    ],
    "impact": "A malicious user could upload a crafted image that causes the `qemu-img` process to consume excessive CPU time or memory, leading to a denial-of-service condition that can affect other users on the same host.",
    "attack_vectors": [
      "Upload of a crafted image file"
    ],
    "attacker_capabilities": "An attacker needs to be able to upload an image file to the VDSM system, meaning they have some level of access to the system."
  },
  "additional_details": {
    "fix_details": "The fix involves using `prlimit` to set limits on CPU time and address space when invoking `qemu-img` with untrusted images. The `qemuimg.info()` function has a new `trusted_image` option, set to True by default. If `trusted_image` is set to `False`, resource limits are applied, and the command is terminated if it exceeds 30 seconds or allocates more than 1 GB of memory. The fix is implemented in commit `6ce96e77be98e7c2bd0daa57294b717b71fa6641`",
    "related_cves": [
      "CVE-2015-5162"
    ],
     "additional_references": [
      "http://lists.nongnu.org/archive/html/qemu-block/2018-07/msg00488.html",
       "https://gerrit.ovirt.org/#/c/93195/"
    ]
  }
}
```