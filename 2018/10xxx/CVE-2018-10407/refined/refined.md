The provided content is related to CVE-2018-10407.

**Root cause of vulnerability:**
The vulnerability stems from the improper use of the code signing API by third-party developers when checking Fat/Universal binaries on macOS. Specifically, the `SecCodeCheckValidity` API, when not used correctly, only checks the first binary in a Fat/Universal file for its signature, and then checks subsequent binaries for matching team identifiers and cryptographic signatures but fails to verify the CA root of trust. The Mach-O loader, when loading a fat binary will load the binary based on the CPU_TYPE field in the Fat header. By manipulating this field to contain an invalid CPU type or a non-native CPU type, the loader will load a different embedded binary and bypass security checks.

**Weaknesses/vulnerabilities present:**
- Improper handling of Fat/Universal binaries during code signing checks by third party developers.
- Lack of verification of the CA root of trust for nested binaries within Fat/Universal files when using `SecCodeCheckValidity`.
- Preference by the code signing API to check the native CPU architecture, which can be bypassed by providing a non-native CPU architecture binary within a Fat/Universal file.
- The vulnerability exists in the difference between how the Mach-O loader loads signed code and how improperly used Code Signing APIs check signed code.

**Impact of exploitation:**
- Bypassing code signing checks, allowing unsigned or malicious code to be executed as if it were signed by Apple.
- Undermining the core security construct of code signing on macOS, potentially affecting a variety of security, forensics, and incident response tools.
- Allowing attackers to evade detection by whitelisting, antivirus, and other security products that rely on code signing.

**Attack vectors:**
- Creation of a malformed Fat/Universal binary containing a validly signed Apple binary (first binary), along with an unsigned or malicious binary that is adhoc signed (second binary) compiled for a non-native architecture (i386).
- Manipulation of the CPU\_TYPE field in the Fat header to an invalid type or valid non-native CPU type, causing the Mach-O loader to execute the malicious binary.

**Required attacker capabilities/position:**
- Ability to create or modify Fat/Universal binaries.
- Basic understanding of macOS code signing and Mach-O binary structure.
- No requirement for administrative privileges or memory corruption techniques.
- Ability to compile binaries for i386 architecture and sign them ad-hoc.