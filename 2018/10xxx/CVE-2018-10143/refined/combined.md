=== Content from support.paloaltonetworks.com_1b49f74e_20250126_095926.html ===

[![](https://marketplace-images-pan.s3.us-west-2.amazonaws.com/orangBlackLogo.png)](https://www.paloaltonetworks.com/)

![](https://marketplace-images-pan.s3.us-west-2.amazonaws.com/orange-backdrop-new3.png)

## Cookies are required

Cookies are disabled on your browser. Please enable Cookies and refresh this page.

[Refresh](.)

![Palo Alto Networks](https://sso.paloaltonetworks.com/fs/bco/1/fs08ykaqtm4jZfxqB0j6)

## The page has timed out

If this page does not reload automatically, please refresh your browser.

By signing in, you agree to our
[Terms](https://www.paloaltonetworks.com/legal-notices/terms-of-use)
and acknowledge our
[Privacy Statement](https://www.paloaltonetworks.com/legal-notices/privacy).

[![](https://marketplace-images-pan.s3.us-west-2.amazonaws.com/orangBlackLogo.png)](https://www.paloaltonetworks.com/)

### Company

* [About Palo Alto Networks](https://www.paloaltonetworks.com/company)
* [Careers](https://www.paloaltonetworks.com/company/careers)

### Legal Notices

* [Privacy](https://www.paloaltonetworks.com/legal-notices/privacy)
* [Terms of Use](https://www.paloaltonetworks.com/legal-notices/terms-of-use)

### Resources

* [Support](https://live.paloaltonetworks.com/t5/custom/page/page-id/Support)
* [Live Community](https://live.paloaltonetworks.com/)
* [Email Subscription](https://www.paloaltonetworks.com/company/subscriptions)
* [Beacon](https://beacon.exceedlms.com/student/catalog)

* [path fill-rule="evenodd" clip-rule="evenodd" d="M27.7 27.4c0 .883-.674 1.6-1.505 1.6H1.938c-.83 0-1.504-.717-1.504-1.6V1.6c0-.884.673-1.6 1.504-1.6h24.257c.83 0 1.505.716 1.505 1.6v25.8zm-8.453-9.63V29h-4.25V17.77h-3.553v-4.377h3.554v-3.228c0-3.745 2.15-5.785 5.292-5.785 1.505 0 2.799.12 3.175.172v3.915h-2.179c-1.708 0-2.039.864-2.039 2.132v2.794h4.075l-.53 4.377h-3.545z"/>](https://www.linkedin.com/company/palo-alto-networks)

© Palo Alto Networks, Inc. All rights reserved.



=== Content from doddsecurity.com_de1d9c1f_20250125_154319.html ===

[Skip to the content](#site-content)

Search

[Dodd Security](https://doddsecurity.com)

Offensive Security and Application Security Perspectives

* [About](https://doddsecurity.com/about/)
* [Vulnerabilities](https://doddsecurity.com/published-vulnerabilities/)

* [About](https://doddsecurity.com/about/)
* [Vulnerabilities](https://doddsecurity.com/published-vulnerabilities/)

[Vulnerability Research](https://doddsecurity.com/category/vulnerability-research/)

# Command Injection on Palo Alto Networks Expedition

Posted by [Reginald Dodd](https://doddsecurity.com/author/regg/) on [December 12, 2018](https://doddsecurity.com/234/command-injection-on-palo-alto-networks-expedition/)

![](https://doddsecurity.com/wp-content/uploads/2018/12/doddsecurity-post6-816x427.png)

Read Next →

[![](https://doddsecurity.com/wp-content/uploads/2023/05/geoserver2-400x200.png)

Vulnerability Research

### XXE in GeoServer](https://doddsecurity.com/412/xxe-in-geoserver/)
[![](https://doddsecurity.com/wp-content/uploads/2023/04/supportcandy-400x200.png)

Vulnerability Research

### Unauthorized Account Creation in SupportCandy](https://doddsecurity.com/396/unauthorized-account-creation-in-supportcandy/)
[![](https://doddsecurity.com/wp-content/uploads/2019/07/opencats-400x200.png)

Vulnerability Research

### XML External Entity Injection (XXE) in OpenCats Applicant Tracking System](https://doddsecurity.com/312/xml-external-entity-injection-xxe-in-opencats-applicant-tracking-system/)

Name: [Palo Alto Networks Expedition (Migration Tool)](https://live.paloaltonetworks.com/t5/Expedition-Migration-Tool/ct-p/migration_tool)

Vendor: Palo Alto Networks

Vulnerability: Unauthenticated Command Injection

Vendor Advisory: [Palo Alto Networks Advisory](https://securityadvisories.paloaltonetworks.com/Home/Detail/138)

Affected Versions: Versions before 1.0.108

CVE ID: CVE-2018-10143

Expedition (Migration Tool) is provided by Palo Alto Networks to assist with moving firewall configurations from another vendor to Palo Alto’s product. It makes the conversion process easier to accomplish. The virtual appliance can be downloaded [here](https://live.paloaltonetworks.com/t5/Expedition-Migration-Tool/ct-p/migration_tool).

Any unauthenticated user on the network could execute remote commands on the Expedition Tool under the context of the web-server user.

The command injection exists within a file named convertCSVtoParquet.php in the user-controlled POST parameter named “path”.

For command injection to work within the “path” parameter, the string that contains the injected command(s) must look similar to this format:

```
1:2:/tmp/log && COMMAND_INJECTION_HERE
```

Replace COMMAND\_INJECTION\_HERE with any command or chain of commands.

---

#### Proof of Concept

I am running a command that lists the current directory and piping the ouput to a netcat listener.

![](https://doddsecurity.com/wp-content/uploads/2018/12/expedition4-1.png)
![](https://doddsecurity.com/wp-content/uploads/2018/12/expedition5.png)

---

#### The Exploit

I wrote a quick exploit that exploits the vulnerability. I am executing a base64 encoded bash reverse shell in the image below.

![](https://doddsecurity.com/wp-content/uploads/2018/12/expedition_exploit1.png)

I received a shell and ran the “hostname” command.

![](https://doddsecurity.com/wp-content/uploads/2018/12/expedition_exploit2.png)

---

#### Timeline

Before I post the timeline, I just wanted to say that it is always great to see security teams that swiftly respond and patch vulnerabilities after disclosures. It was good to see Palo Alto Networks PSIRT team’s response, and they kept me in the loop!

* November 29, 2018 – I disclosed to the vendor.
* November 30, 2018 – The vendor confirmed the vulnerability.
* December 5, 2018 – The vendor said this was fixed in version 1.0.108.
* December 11, 2018 – The vendor posted their [security advisory](https://securityadvisories.paloaltonetworks.com/Home/Detail/138) on their website and assigned a CVE.
* December 12, 2018 – Published (this post).

[command injection](https://doddsecurity.com/tag/command-injection/)[cve](https://doddsecurity.com/tag/cve/)[remote command execution](https://doddsecurity.com/tag/remote-command-execution/)[responsible disclosure](https://doddsecurity.com/tag/responsible-disclosure/)
[![](https://secure.gravatar.com/avatar/3437b25bca2894ee732acfa46c82096e?s=100&d=mm&r=g)](https://doddsecurity.com/author/regg/)
#### [Reginald Dodd](https://doddsecurity.com/author/regg/)

Reginald is an information security professional with experience that spans numerous industries. He has discovered unknown vulnerabilities in numerous products. He has earned a Master’s degree in Information Security and Assurance, GIAC certifications, and Offensive Security certifications.

Read Next →

[![](https://doddsecurity.com/wp-content/uploads/2023/05/geoserver2-400x200.png)

Vulnerability Research

### XXE in GeoServer](https://doddsecurity.com/412/xxe-in-geoserver/)
[![](https://doddsecurity.com/wp-content/uploads/2023/04/supportcandy-400x200.png)

Vulnerability Research

### Unauthorized Account Creation in SupportCandy](https://doddsecurity.com/396/unauthorized-account-creation-in-supportcandy/)
[![](https://doddsecurity.com/wp-content/uploads/2019/07/opencats-400x200.png)

Vulnerability Research

### XML External Entity Injection (XXE) in OpenCats Applicant Tracking System](https://doddsecurity.com/312/xml-external-entity-injection-xxe-in-opencats-applicant-tracking-system/)

### The Author

![](https://doddsecurity.com/wp-content/uploads/2018/12/Reginald-Dodd-Cropped.png)

Hi, I’m Reginald Dodd, an offensive security engineer and the author of this blog. This is where I document my perspectives on offensive security and application security in my personal time.

Read my [About Me](http://doddsecurity.com/about/) page for more on me.

### Follow

* [GitHub](https://github.com/doddr)
* [LinkedIn](https://www.linkedin.com/in/reginalddodd/)
* [RSS](https://doddsecurity.com/feed/)
### Categories

* [General](https://doddsecurity.com/category/general/)
* [Vulnerability Research](https://doddsecurity.com/category/vulnerability-research/)

To the top

© 2025 [Dodd Security](https://doddsecurity.com/)



=== Content from cvssjs.github.io_d30284e6_20250126_095927.html ===

### CVSS v3.1 Base Score Calculator

Copyright 2019 © Chandan



=== Content from security.paloaltonetworks.com_e3ce2099_20250125_154325.html ===


* [Get support](https://support.paloaltonetworks.com/support)
* [Security advisories](/)
* [Report vulnerabilities](/report)
* [Bug Bounty](/scope)
* [Subscribe](https://support.paloaltonetworks.com/SupportAccount/Preferences)
* [RSS feed](/rss.xml)
[Palo Alto Networks Security Advisories](/) /
CVE-2018-10143
## CVE-2018-10143 Remote Code Execution in Expedition Migration Tool

047910
[Severity
9.8 ·
CRITICAL](https://cvssjs.github.io/#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H "CVSS-B: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H")Attack Vector
**NETWORK**Scope
**UNCHANGED**Attack Complexity
**LOW**Confidentiality Impact
**HIGH**Privileges Required
**NONE**Integrity Impact
**HIGH**User Interaction
**NONE**Availability Impact
**HIGH**[CVE](https://www.cve.org/CVERecord?id=CVE-2018-10143 "See CVE.org record")
[JSON](/json/CVE-2018-10143 "Download the information in this advisory in CVE-JSON format")
[CSAF](/csaf/CVE-2018-10143 "Download the information in this advisory in CSAF format")

 Published
**2018-12-11** Updated
**2018-12-11**Reference
**MT-794,
PAN-SA-2018-0017**Discovered
**externally**
### Description

A remote code execution vulnerability exists in the Palo Alto Networks Migration Tool (“Expedition”). (Ref # MT-794/ CVE-2018-10143)

Successful exploitation of this issue may allow an unauthenticated attacker with remote access to run system level commands on the device hosting this service/application.

This issue affects Expedition 1.0.107 and earlier.

Note that this issue only impacts the Palo Alto Networks Migration Tool (“Expedition”), a tool available from the Palo Alto Networks Live site. This issue does not affect PAN-OS or any other supported product or service. For more information on Expedition, see: <https://live.paloaltonetworks.com/t5/Expedition-Migration-Tool/ct-p/migration_tool>.

### Product Status

| Versions | Affected | Unaffected |
| Expedition 1.0 | <= 1.0.107 | >= 1.0.108 |

### Severity: CRITICAL

CVSSv3.1
Base Score:
9.8 ([CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://cvssjs.github.io/#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H))

### Weakness Type

[CWE-269 Improper Privilege Management](https://cwe.mitre.org/data/definitions/269 "More at https://cwe.mitre.org/data/definitions/269")

### Solution

Expedition 1.0.108 and later

### Workarounds and Mitigations

N/A

### Acknowledgments

Palo Alto Networks would like to thank Reginald Dodd for reporting this issue.[Terms of use](https://www.paloaltonetworks.com/legal-notices/terms-of-use)[Privacy](https://www.paloaltonetworks.com/legal-notices/privacy)[Product Security Assurance and Vulnerability Disclosure Policy](https://paloaltonetworks.com/product-security-assurance)[Report vulnerabilities](/report)[Manage subscriptions](https://support.paloaltonetworks.com/SupportAccount/Preferences)© 2025 Palo Alto Networks, Inc. All rights reserved.

=== Content from securityadvisories.paloaltonetworks.com_99d728f1_20250126_095924.html ===


* [Get support](https://support.paloaltonetworks.com/support)
* [Security advisories](/)
* [Report vulnerabilities](/report)
* [Bug Bounty](/scope)
* [Subscribe](https://support.paloaltonetworks.com/SupportAccount/Preferences)
* [RSS feed](/rss.xml)
[Palo Alto Networks Security Advisories](/) /
CVE-2018-10143
## CVE-2018-10143 Remote Code Execution in Expedition Migration Tool

047910
[Severity
9.8 ·
CRITICAL](https://cvssjs.github.io/#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H "CVSS-B: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H")Attack Vector
**NETWORK**Scope
**UNCHANGED**Attack Complexity
**LOW**Confidentiality Impact
**HIGH**Privileges Required
**NONE**Integrity Impact
**HIGH**User Interaction
**NONE**Availability Impact
**HIGH**[CVE](https://www.cve.org/CVERecord?id=CVE-2018-10143 "See CVE.org record")
[JSON](/json/CVE-2018-10143 "Download the information in this advisory in CVE-JSON format")
[CSAF](/csaf/CVE-2018-10143 "Download the information in this advisory in CSAF format")

 Published
**2018-12-11** Updated
**2018-12-11**Reference
**MT-794,
PAN-SA-2018-0017**Discovered
**externally**
### Description

A remote code execution vulnerability exists in the Palo Alto Networks Migration Tool (“Expedition”). (Ref # MT-794/ CVE-2018-10143)

Successful exploitation of this issue may allow an unauthenticated attacker with remote access to run system level commands on the device hosting this service/application.

This issue affects Expedition 1.0.107 and earlier.

Note that this issue only impacts the Palo Alto Networks Migration Tool (“Expedition”), a tool available from the Palo Alto Networks Live site. This issue does not affect PAN-OS or any other supported product or service. For more information on Expedition, see: <https://live.paloaltonetworks.com/t5/Expedition-Migration-Tool/ct-p/migration_tool>.

### Product Status

| Versions | Affected | Unaffected |
| Expedition 1.0 | <= 1.0.107 | >= 1.0.108 |

### Severity: CRITICAL

CVSSv3.1
Base Score:
9.8 ([CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://cvssjs.github.io/#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H))

### Weakness Type

[CWE-269 Improper Privilege Management](https://cwe.mitre.org/data/definitions/269 "More at https://cwe.mitre.org/data/definitions/269")

### Solution

Expedition 1.0.108 and later

### Workarounds and Mitigations

N/A

### Acknowledgments

Palo Alto Networks would like to thank Reginald Dodd for reporting this issue.[Terms of use](https://www.paloaltonetworks.com/legal-notices/terms-of-use)[Privacy](https://www.paloaltonetworks.com/legal-notices/privacy)[Product Security Assurance and Vulnerability Disclosure Policy](https://paloaltonetworks.com/product-security-assurance)[Report vulnerabilities](/report)[Manage subscriptions](https://support.paloaltonetworks.com/SupportAccount/Preferences)© 2025 Palo Alto Networks, Inc. All rights reserved.
