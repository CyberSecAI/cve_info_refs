The provided content relates to CVE-2018-10717.

**Root cause of vulnerability:**
A heap-based buffer overflow exists in the `WritePixels` function within `ngiflib.c`. The `tocopy` variable, which determines how many bytes to copy, can exceed the size of the destination buffer `context->frbuff_p.p8`, leading to a buffer overflow when `memcpy` is called.

**Weaknesses/vulnerabilities present:**
- Heap-based buffer overflow.

**Impact of exploitation:**
- Memory corruption, potentially leading to arbitrary code execution.
- Program crash, as demonstrated by the ASAN output.

**Attack vectors:**
- Maliciously crafted GIF files that trigger the overflow in the `WritePixels` function.

**Required attacker capabilities/position:**
- The attacker needs to be able to provide a specially crafted GIF file to be processed by the vulnerable software.
- No special user privileges are required to trigger this vulnerability.

**Additional details:**
- The ASAN output clearly shows the heap-buffer-overflow at address `0x63000000fe00` during a `memcpy` operation.
- The affected code snippet in `WritePixels` is where the crash occurs.
- The fix involves checking if `npix` (remaining pixels to process) is less than `stack_top - stackp`. If it is, then only `npix` bytes are copied. Otherwise, if `npix >= stack_top - stackp` then the full stack is copied, avoiding the overflow. This fix was made in commit `cf429e0a2fe26b5f01ce0c8e9b79432e94509b6e`.
- A test case `corpus_1.zip` is provided which can be used to trigger the vulnerability.