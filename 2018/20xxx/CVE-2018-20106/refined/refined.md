Based on the provided content, here's an analysis of CVE-2018-20106:

**Root Cause of Vulnerability:**

The vulnerability stems from improper handling of special characters, specifically backticks (`), within the password field when testing SMB printer connections in the `yast2-printer` module. The password is directly embedded into a bash command, which is then executed.

**Weaknesses/Vulnerabilities Present:**

*   **Command Injection:** The primary vulnerability is command injection. When a password contains a backtick, the bash shell interprets the content within the backticks as a command to execute. This allows for arbitrary command execution on the system.

*   **Lack of Input Sanitization:** The `yast2-printer` module lacks input sanitization and validation for the password field. It does not escape or properly quote the password before embedding it into a bash command.

**Impact of Exploitation:**

*   **Arbitrary Command Execution:** An attacker who can control the password provided to the `yast2-printer` configuration can execute arbitrary commands with the privileges of the user running the YaST printer module (typically root).
*   **System Compromise:** This could lead to a complete system compromise depending on the commands executed.
*   **Denial of Service:** An attacker could execute commands that could make the system unstable and lead to a denial of service.
*   **Data Breach:** Data stored on the system could potentially be accessed or modified.

**Attack Vectors:**

*   **Malicious Configuration:** An attacker could maliciously configure the SMB printer settings and include a backtick in the password field via the YaST printer module.
*   **Compromised Credentials:** If an attacker obtains valid user credentials with a backtick in the password, they could exploit the vulnerability.

**Required Attacker Capabilities/Position:**

*   **User with YaST Access:** The attacker needs to have the ability to configure printer settings via YaST or have control over the input to yast2-printer. This typically requires root access.
*   **Knowledge of Vulnerability:** The attacker needs to be aware of the vulnerability and the use of backticks in bash command execution.

**Additional Details:**

*   The issue is not just about the connection test failing, but the ability to execute arbitrary commands due to the way the password is used in the bash command.
*   The vulnerability was introduced with commit `5305ab79` when YCP files were converted into Ruby.
*   Initially, the developers' argument was that since root provides these values, it's their responsibility for any consequences. However, this stance was reconsidered.
*   The issue is present not only in OpenSUSE Tumbleweed but also in older versions of SUSE like SLE-12-SP3.
*   A fix has been implemented in Tumbleweed via a build request.