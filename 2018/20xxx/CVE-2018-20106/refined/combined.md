=== Content from idp-portal.suse.com_6b95d262_20250126_083608.html ===

## UCS

# Welcome to Univention Corporate Server

## JavaScript required

A browser with JavaScript enabled is required in order to use this service.

When using Internet Explorer, please check your security settings and add this address to your trusted sites.



=== Content from bugzilla.suse.com_3c40444e_20250125_123924.html ===


| Bugzilla – Bug 1114853 | VUL-1: CVE-2018-20106: yast2-printer: SMB printer settings test fails if the password includes a backtick | Last modified: 2023-03-22 14:07:12 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1114853)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 1114853**](show_bug.cgi?id=1114853)
(CVE-2018-20106)
- VUL-1: CVE-2018-20106: yast2-printer: SMB printer settings test fails if the password includes a backtick

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-1: CVE-2018-20106: yast2-printer: SMB printer settings test fails if the ...

| | [Status](page.cgi?id=status_resolution_matrix.html): | REOPENED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2018-20106 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | openSUSE Tumbleweed | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | openSUSE | | [Component:](describecomponents.cgi?product=openSUSE Tumbleweed "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Security ([show other bugs](buglist.cgi?component=Security&product=openSUSE%20Tumbleweed&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | Current | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P4 - Low **Severity**: Normal ([vote](page.cgi?id=voting/user.html&bug_id=1114853#vote_1114853)) | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Johannes Meixner | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | E-mail List | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://smash.suse.de/issue/218841/> | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | CVSSv3:SUSE:CVE-2018-20106:6.3:(AV:L/... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2018-11-06 13:00 UTC by Dainius Masiliunas | | --- | --- | | Modified: | 2023-03-22 14:07 UTC ([History](show_activity.cgi?id=1114853)) | | CC List: | 5 users (show)  jsegitz jsmeix karol mmeisters mvidner | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=1114853)  | Flags: | karol: needinfo? (jsmeix) | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=1114853&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=1114853&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1114853#c0)  Dainius Masiliunas   2018-11-06 13:00:11 UTC  ``` In YaST printer settings, connection wizard, SMB/CIFS option, if the password of the user includes a backtick character, YaST always fails the connection test with the error:  sh: -c: line 0: unexpected EOF while looking for matching ``' sh: -c: line 1: syntax error: unexpected end of file  If that backtick is escaped with a backslash, it works, but the backslash is considered to be a part of the password... So then it fails to actually print. So either the connection test succeeds, or the printing succeeds, not both.  On a somewhat related note, I wonder if there is a way to specify that the username and password ought to be requested every time from the user, instead of being stored on disk. ``` [Comment 1](show_bug.cgi?id=1114853#c1)  Johannes Segitz   2018-11-07 16:46:08 UTC  ``` This is a security issue. I'm currently looking at issues like these in [bsc#353876](http://bugzilla.suse.com/show_bug.cgi?id=353876), but we can track this one already here ``` [Comment 2](show_bug.cgi?id=1114853#c2)  Martin Vidner   2018-11-15 13:15:35 UTC  ``` Confirmed on Leap 15.0: Print via Network > Connection Wizard > Windows...(SMB/CIFS) > fill in Server+Printer+User+Password `xeyes` > Test Connection   y2log says: 2018-11-15 14:07:33 <1> dhcp52(2290) [Ruby] modules/Printerlib.rb:97 Executing bash commandline: /usr/lib/YaST2/bin/test_remote_smb "myworkgroup" "myserver" "myprinter" "myuser" "mypass`xeyes`" 5 ``` [Comment 3](show_bug.cgi?id=1114853#c3)  Johannes Meixner   2018-11-16 14:34:18 UTC  ``` As far as I remember at the time when the yast2-printer test scripts /usr/lib/YaST2/bin/test_device /usr/lib/YaST2/bin/test_remote_ipp /usr/lib/YaST2/bin/test_remote_lpd /usr/lib/YaST2/bin/test_remote_novell /usr/lib/YaST2/bin/test_remote_smb /usr/lib/YaST2/bin/test_remote_socket were made the reasoning why there are no input value checks was that when those scripts are called from the YaST printer module it was 'root' who made the inputs values.  If root thinks it is a good idea to use e.g. '$( rm -rf / )' as password, he should know about possible consequences.  Even when those scripts are called by another user that user should also know how things work.  As far as I remember from the past (since a longer time I do no longer work on YaST modules - my last yast2-printer RPM changelog entry is from Jan. 2015) there are in general no such kind of input value checks in YaST so that root could provide e.g. '$( rm -rf / )' at many places in YaST. ``` [Comment 4](show_bug.cgi?id=1114853#c4)  Johannes Segitz   2018-11-16 14:52:13 UTC  ``` (In reply to Johannes Meixner from [comment #3](show_bug.cgi?id=1114853#c3)) We have two problems here. One is usability. Some passwords just don't work, so we need to fix it anyway.  The other is a security problem. You're correct that root specifies these values, so we could go with the 'he has the right to shoot himself' argument. But we would like to add additional hardening measures since it's hard to judge if the input might not come from an untrusted source later on. So as a hardening measure we currently check problems like these ([bsc#353876](http://bugzilla.suse.com/show_bug.cgi?id=353876)) and want to have them fixed. ``` [Comment 5](show_bug.cgi?id=1114853#c5)  Dainius Masiliunas   2018-11-16 15:42:50 UTC  ``` I don't agree with the argument to begin with; if root sets the password as '$( rm -rf / )', they expect that this will make it so that the password is '$( rm -rf / )', rather than executing the password as a command. (Also, in this case the password is not root's, it's the printer's, so the user may have no control over what it is.) ``` [Comment 6](show_bug.cgi?id=1114853#c6)  Johannes Segitz   2019-01-07 13:07:10 UTC  ``` I assigned CVE-2018-20106 for further tracking ``` [Comment 7](show_bug.cgi?id=1114853#c7)  Karol Babioch   2019-01-07 13:52:07 UTC  ``` Looking at the code of connectionwizard.rb [1] it seems that the vulnerable code was introduced with commit 5305ab79, which converted YCP files into Ruby. The code prior to that looks also vulnerable to this, although I did not test it.  Unfortunately tags are not being used consistently, so I don't know which exact versions and/or codestreams are affected by this:            password = (string)UI::QueryWidget( `pass, `Value );           test_command = sformat( "%1test_remote_smb \"%2\" \"%3\" \"%4\" \"%5\" \"%6\" %7",                                   Printerlib::yast_bin_dir,                                   workgroup,                                   host,                                   queue,                                   user,                                   password,                                   timeout                                 );           if( ! Printerlib::ExecuteBashCommand( test_command) )  It was first introduced with commit fe970eca. Prior to that the code looked something like that:              if( size( smb["user"]:"" ) > 0                 && size( smb["pass"]:"" ) > 0               )             { connection_uri = sformat( "%1%2:%3@",                                         connection_uri,                                         smb["user"]:"",                                         smb["pass"]:""                                       );             }  This connection_uri string is then handed over to the Printer object, but no Bash invocation is happening here (at least not in this module). After having a quick look at the the code in question, I couldn't find any suspicious looking command execution. However, I might have missed something.  [1]: <https://github.com/yast/yast-printer/blob/master/src/include/printer/connectionwizard.rb#L2972> ``` [Comment 8](show_bug.cgi?id=1114853#c8)  Johannes Meixner   2019-12-05 14:09:56 UTC  ``` Got fixed via <https://build.opensuse.org/request/show/689019> ``` [Comment 9](show_bug.cgi?id=1114853#c9)  Marcus Meissner   2023-03-22 13:32:33 UTC  ``` so far not fixed for   SUSE:SLE-12-SP3:Update/yast2-printer  we should still fix it there if possible. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=1114853)
* - [XML](show_bug.cgi?ctype=xml&id=1114853)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=1114853)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1114853)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)


