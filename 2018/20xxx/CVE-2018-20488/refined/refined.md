```
{
  "vulnerability_details": {
    "root_cause": "GitLab incorrectly checks `can_update_branch?` for tags, preventing pipeline creation, but when triggered, secret CI variables are exposed because tags are being treated as branches for authorization checks.",
    "weaknesses": [
      "Incorrect authorization check for tags",
      "Exposure of protected CI variables to unauthorized pipelines"
    ],
    "impact": "An attacker can gain access to protected CI variables by creating a tag with the same name as a protected branch or wildcard, and triggering a pipeline for that tag.",
    "attack_vectors": [
      "Creating a tag with the same name as a protected branch",
      "Triggering a pipeline for the created tag (e.g., using trigger tokens or repository mirroring)"
    ],
    "required_attacker_capabilities": "Attacker needs to be able to create tags and trigger pipelines in the affected project. This can happen if attacker has write access to the repo or through methods like triggering pipeline through token or repository mirroring"
  }
}
```