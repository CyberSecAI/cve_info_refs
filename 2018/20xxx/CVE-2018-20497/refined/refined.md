- **Root cause of vulnerability**: The mirroring repositories function in GitLab allows users to specify various schemes (ssh, http, https, git) to fetch repositories. The SSRF fix implemented previously was not applied to this functionality.
- **Weaknesses/vulnerabilities present**: Server-Side Request Forgery (SSRF). The application makes requests to URLs provided by the user without proper validation or sanitization, allowing the attacker to make the server interact with internal and external resources.
- **Impact of exploitation**: An attacker can use the mirroring function to make GitLab's server perform requests to internal hosts and cloud endpoints like GCP's metadata server, which can potentially lead to information disclosure or other malicious actions within the internal network.
- **Attack vectors**: The attacker can specify a malicious URL within the mirroring repository URL setting.
- **Required attacker capabilities/position**: The attacker needs to have an account with a project in GitLab and be able to access the project's settings page for mirroring repositories.