Based on the provided content, here's a breakdown of the vulnerabilities associated with CVE-2018-20148:

**Root Cause of Vulnerability:**
*   The primary issue is a PHP object injection vulnerability stemming from the mishandling of serialized data within the `wp_get_attachment_thumb_file` function, specifically when using "phar://" URLs. This function is used in processing media attachments and their thumbnails.

**Weaknesses/Vulnerabilities Present:**

1.  **PHP Object Injection:** The core vulnerability is that attackers can inject malicious PHP objects by crafting metadata within a `wp.getMediaItem` XMLRPC call. This is possible because of the insecure handling of serialized data within the `wp_get_attachment_thumb_file` function when processing phar:// URLs.
2.  **Mishandling of Serialized Data:** The application improperly handles serialized data from external sources. When a phar:// URL is processed, serialized data is read and unserialized, allowing the attacker to control the PHP objects being instantiated and executed.

**Impact of Exploitation:**

*   **Remote Code Execution (RCE):** By injecting malicious PHP objects, attackers can achieve remote code execution, allowing them to run arbitrary code on the server. This can lead to complete site takeover, data theft, and other malicious activities.
*   **Site Takeover:** As stated, successful exploitation could lead to full site compromise, where the attacker gains administrative control of the WordPress website.

**Attack Vectors:**

*   **XMLRPC Interface:**  The vulnerability can be exploited via the `wp.getMediaItem` XMLRPC call, which allows attackers to supply crafted metadata.
*   **File Upload:** The vulnerability can be triggered through the phar:// stream wrapper when a crafted thumbnail is uploaded. The thumbnail does not necessarily have to be a valid image, but just have the correct extension to pass initial checks.

**Required Attacker Capabilities/Position:**

*   **Contributor Role:** An attacker only needs to have a Contributor role on the WordPress site. This role has the capability to upload files.
*   **Crafted Metadata/Files:** The attacker needs to be able to create crafted metadata in a way that triggers the unserialization vulnerability. This involves exploiting the way WordPress processes `phar://` URLs. They can also upload specifically crafted files that trigger this vulnerability, including a crafted thumbnail file.

**Additional Details**
*   This vulnerability is related to several other vulnerabilities fixed in the same WordPress update, including those that could lead to Cross-Site Scripting (XSS), unauthorized file deletion, and unauthorized post creation.
*   The vulnerability was disclosed by Sam Thomas from Secarma Labs.
*   The fix for this vulnerability is included in WordPress versions 5.0.1 and 4.9.9, which was released in December 2018.
*   The vulnerability was initially reported to WordPress via HackerOne in February 2017.
*   The `file_exists` function in `wp-includes/post.php` using parameters controlled by the attacker was the initial trigger.

This information is based on a combination of details from the release notes and security news articles concerning this vulnerability.