- **Root cause of vulnerability**: The `push()` function in `jsonparse.c` does not properly check if the stack buffer is full before writing new data, leading to a stack buffer overflow.
- **Weaknesses/vulnerabilities present**: Stack-based buffer overflow in the `push()` function of the JSON parser. The function `push()` increments the depth counter and then returns a boolean to indicate if the depth is within the maximum, but this return value is not checked.
- **Impact of exploitation**: Overwriting the stack allows to overwrite the return address on the stack or stack canary, leading to a crash of the application (segmentation fault) which can be used for Denial of Service attacks.
- **Attack vectors**: By providing a specially crafted JSON input with a nested structure that exceeds the `JSONPARSE_MAX_DEPTH` limit.
- **Required attacker capabilities/position**: The attacker needs to be able to provide input JSON to the vulnerable parser. This can be achieved by sending malicious input to an IoT device that processes JSON data. The attack vector is local.