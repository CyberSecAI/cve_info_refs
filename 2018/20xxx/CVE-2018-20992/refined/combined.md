=== Content from github.com_20f1dc54_20250126_013428.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fruuda%2Fclaxon%2Fcommit%2F8f28e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fruuda%2Fclaxon%2Fcommit%2F8f28e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ruuda%2Fclaxon)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ruuda](/ruuda)
/
**[claxon](/ruuda/claxon)**
Public

* [Notifications](/login?return_to=%2Fruuda%2Fclaxon) You must be signed in to change notification settings
* [Fork
  28](/login?return_to=%2Fruuda%2Fclaxon)
* [Star
   289](/login?return_to=%2Fruuda%2Fclaxon)

* [Code](/ruuda/claxon)
* [Issues
  6](/ruuda/claxon/issues)
* [Pull requests
  3](/ruuda/claxon/pulls)
* [Actions](/ruuda/claxon/actions)
* [Security](/ruuda/claxon/security)
* [Insights](/ruuda/claxon/pulse)

Additional navigation options

* [Code](/ruuda/claxon)
* [Issues](/ruuda/claxon/issues)
* [Pull requests](/ruuda/claxon/pulls)
* [Actions](/ruuda/claxon/actions)
* [Security](/ruuda/claxon/security)
* [Insights](/ruuda/claxon/pulse)

## Commit

[Permalink](/ruuda/claxon/commit/8f28ec275e412dd3af4f3cda460605512faf332c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix bug in decoding residuals

[Browse files](/ruuda/claxon/tree/8f28ec275e412dd3af4f3cda460605512faf332c)
Browse the repository at this point in the history

```
A partition order could occur, such that the block size was not a
multiple of 2^order. Computation of the number of samples per partition
did not account for this case, rounding down due to the bit shift. This
meant that we would not fill the entire decode buffer.

Claxon does not zero the decode buffer because it is (should be)
overwritten anyway, and in the case of a format error, where the buffer
might be only partially full, the buffer is not exposed again.
Furthermore, the way decoding works in most places, is that we fill the
entire buffer, just by looping to fill it. If the input bitstream does
not contain enough data to fill the buffer, then that's a format error.
In a few places though, we need to slice up the buffer before decoding
into it: for decoding individual channels, and also for decoding
residuals, which are split into partitions.

This particular format error was especially nasty because it did not
cause a format error down the line. Instead, it caused the buffer to be
sliced in a way where the slices together did not cover the entire
buffer, and so parts of uninitialized memory could remain in the buffer.

Thanks a lot to Sergey "Shnatsel" Davidoff for reporting this bug,
together with elaborate steps to reproduce that allowed me to pinpoint
the cause quickly.
```

* Loading branch information

[![@ruuda](https://avatars.githubusercontent.com/u/506953?s=40&v=4)](/ruuda)

[ruuda](/ruuda/claxon/commits?author=ruuda "View all commits by ruuda")
committed
Aug 23, 2018

1 parent
[cd82be3](/ruuda/claxon/commit/cd82be35f413940ba446d2a19f10d74b86466487)

commit 8f28ec2

Showing
**1 changed file**
with
**19 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

25 changes: 19 additions & 6 deletions

25
[src/subframe.rs](#diff-a620da2061364c11f6cb31047a4cbae01df80977f37111233572501de9036def "src/subframe.rs")

Show comments

[View file](/ruuda/claxon/blob/8f28ec275e412dd3af4f3cda460605512faf332c/src/subframe.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -254,35 +254,48 @@ fn decode\_residual<R: ReadBytes>(input: &mut Bitstream<R>, |
|  |  | // most 2^16 - 1 samples in the block. No values have been marked as |
|  |  | // invalid by the specification though. |
|  |  | let n\_partitions = 1u32 << order; |
|  |  | let n\_samples = block\_size >> order; |
|  |  | let n\_samples\_per\_partition = block\_size >> order; |
|  |  |  |
|  |  | // The partitions together must fill the block. If the block size is not a |
|  |  | // multiple of 2^order; if we shifted off some bits, then we would not fill |
|  |  | // the entire block. Such a partition order is invalid for this block size. |
|  |  | if block\_size & (n\_partitions - 1) as u16 != 0 { |
|  |  | return fmt\_err("invalid partition order") |
|  |  | } |
|  |  |  |
|  |  | // NOTE: the check above checks that block\_size is a multiple of n\_partitions |
|  |  | // (this works because n\_partitions is a power of 2). The check below is |
|  |  | // equivalent but more expensive. |
|  |  | debug\_assert\_eq!(n\_partitions \* n\_samples\_per\_partition as u32, block\_size as u32); |
|  |  |  |
|  |  | let n\_warm\_up = block\_size - buffer.len() as u16; |
|  |  |  |
|  |  | // The partition size must be at least as big as the number of warm-up |
|  |  | // samples, otherwise the size of the first partition is negative. |
|  |  | if n\_warm\_up > n\_samples { |
|  |  | if n\_warm\_up > n\_samples\_per\_partition { |
|  |  | return fmt\_err("invalid residual"); |
|  |  | } |
|  |  |  |
|  |  | // Finally decode the partitions themselves. |
|  |  | match partition\_type { |
|  |  | RicePartitionType::Rice => { |
|  |  | let mut start = 0; |
|  |  | let mut len = n\_samples - n\_warm\_up; |
|  |  | let mut len = n\_samples\_per\_partition - n\_warm\_up; |
|  |  | for \_ in 0..n\_partitions { |
|  |  | let slice = &mut buffer[start..start + len as usize]; |
|  |  | try!(decode\_rice\_partition(input, slice)); |
|  |  | start = start + len as usize; |
|  |  | len = n\_samples; |
|  |  | len = n\_samples\_per\_partition; |
|  |  | } |
|  |  | } |
|  |  | RicePartitionType::Rice2 => { |
|  |  | let mut start = 0; |
|  |  | let mut len = n\_samples - n\_warm\_up; |
|  |  | let mut len = n\_samples\_per\_partition - n\_warm\_up; |
|  |  | for \_ in 0..n\_partitions { |
|  |  | let slice = &mut buffer[start..start + len as usize]; |
|  |  | try!(decode\_rice2\_partition(input, slice)); |
|  |  | start = start + len as usize; |
|  |  | len = n\_samples; |
|  |  | len = n\_samples\_per\_partition; |
|  |  | } |
|  |  | } |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8f28ec2`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fruuda%2Fclaxon%2Fcommit%2F8f28e) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_55626361_20250126_013427.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-8c6g-4xc5-w96c)

**CVE-2018-20992**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-8c6g-4xc5-w96c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2018-20992](/advisories/GHSA-8c6g-4xc5-w96c)

## Uninitialized memory exposure in claxon

Moderate severity

GitHub Reviewed

Published
Aug 25, 2021
to the GitHub Advisory Database
•
Updated Jun 13, 2023

[Vulnerability details](/advisories/GHSA-8c6g-4xc5-w96c)
[Dependabot alerts
0](/advisories/GHSA-8c6g-4xc5-w96c/dependabot)

## Package

cargo

claxon
([Rust](/advisories?query=ecosystem%3Arust))

## Affected versions

>= 0.4.0, < 0.4.1
< 0.3.2

## Patched versions

0.4.1
0.3.2

## Description

Affected versions of Claxon made an invalid assumption about the decode buffer size being a multiple of a value read from the bitstream. This could cause parts of the decode buffer to not be overwritten. If the decode buffer was newly allocated and uninitialized, this uninitialized memory could be exposed.

This allows an attacker to observe parts of the uninitialized memory in the decoded audio stream.

The flaw was corrected by checking that the value read from the bitstream divides the decode buffer size, and returning a format error if it does not. If an error is returned, the decode buffer is not exposed. Regression tests and an additional fuzzer have been added to prevent similar flaws in the future.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2018-20992>
* [ruuda/claxon@8f28ec2](https://github.com/ruuda/claxon/commit/8f28ec275e412dd3af4f3cda460605512faf332c)
* <https://rustsec.org/advisories/RUSTSEC-2018-0004.html>
* <https://github.com/ruuda/claxon/releases/tag/v0.3.2>
* <https://github.com/ruuda/claxon/releases/tag/v0.4.1>

Reviewed
Aug 19, 2021

Published to the GitHub Advisory Database
Aug 25, 2021

Last updated
Jun 13, 2023

### Severity

Moderate

6.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N

### EPSS score

0.123%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (48th percentile)

### Weaknesses

[CWE-908](/advisories?query=cwe%3A908)

### CVE ID

CVE-2018-20992

### GHSA ID

GHSA-8c6g-4xc5-w96c

### Source code

[ruuda/claxon](https://github.com/ruuda/claxon)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-8c6g-4xc5-w96c/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from crates.io_d47c2219_20250126_013427.html ===

For full functionality of this site it is necessary to enable JavaScript.



=== Content from github.com_44fc0afa_20250126_013428.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fruuda%2Fclaxon%2Fcommit%2F8f28ec275e412dd3af4f3cda460605512faf332c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fruuda%2Fclaxon%2Fcommit%2F8f28ec275e412dd3af4f3cda460605512faf332c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ruuda%2Fclaxon)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ruuda](/ruuda)
/
**[claxon](/ruuda/claxon)**
Public

* [Notifications](/login?return_to=%2Fruuda%2Fclaxon) You must be signed in to change notification settings
* [Fork
  28](/login?return_to=%2Fruuda%2Fclaxon)
* [Star
   289](/login?return_to=%2Fruuda%2Fclaxon)

* [Code](/ruuda/claxon)
* [Issues
  6](/ruuda/claxon/issues)
* [Pull requests
  3](/ruuda/claxon/pulls)
* [Actions](/ruuda/claxon/actions)
* [Security](/ruuda/claxon/security)
* [Insights](/ruuda/claxon/pulse)

Additional navigation options

* [Code](/ruuda/claxon)
* [Issues](/ruuda/claxon/issues)
* [Pull requests](/ruuda/claxon/pulls)
* [Actions](/ruuda/claxon/actions)
* [Security](/ruuda/claxon/security)
* [Insights](/ruuda/claxon/pulse)

## Commit

[Permalink](/ruuda/claxon/commit/8f28ec275e412dd3af4f3cda460605512faf332c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix bug in decoding residuals

[Browse files](/ruuda/claxon/tree/8f28ec275e412dd3af4f3cda460605512faf332c)
Browse the repository at this point in the history

```
A partition order could occur, such that the block size was not a
multiple of 2^order. Computation of the number of samples per partition
did not account for this case, rounding down due to the bit shift. This
meant that we would not fill the entire decode buffer.

Claxon does not zero the decode buffer because it is (should be)
overwritten anyway, and in the case of a format error, where the buffer
might be only partially full, the buffer is not exposed again.
Furthermore, the way decoding works in most places, is that we fill the
entire buffer, just by looping to fill it. If the input bitstream does
not contain enough data to fill the buffer, then that's a format error.
In a few places though, we need to slice up the buffer before decoding
into it: for decoding individual channels, and also for decoding
residuals, which are split into partitions.

This particular format error was especially nasty because it did not
cause a format error down the line. Instead, it caused the buffer to be
sliced in a way where the slices together did not cover the entire
buffer, and so parts of uninitialized memory could remain in the buffer.

Thanks a lot to Sergey "Shnatsel" Davidoff for reporting this bug,
together with elaborate steps to reproduce that allowed me to pinpoint
the cause quickly.
```

* Loading branch information

[![@ruuda](https://avatars.githubusercontent.com/u/506953?s=40&v=4)](/ruuda)

[ruuda](/ruuda/claxon/commits?author=ruuda "View all commits by ruuda")
committed
Aug 23, 2018

1 parent
[cd82be3](/ruuda/claxon/commit/cd82be35f413940ba446d2a19f10d74b86466487)

commit 8f28ec2

Showing
**1 changed file**
with
**19 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

25 changes: 19 additions & 6 deletions

25
[src/subframe.rs](#diff-a620da2061364c11f6cb31047a4cbae01df80977f37111233572501de9036def "src/subframe.rs")

Show comments

[View file](/ruuda/claxon/blob/8f28ec275e412dd3af4f3cda460605512faf332c/src/subframe.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -254,35 +254,48 @@ fn decode\_residual<R: ReadBytes>(input: &mut Bitstream<R>, |
|  |  | // most 2^16 - 1 samples in the block. No values have been marked as |
|  |  | // invalid by the specification though. |
|  |  | let n\_partitions = 1u32 << order; |
|  |  | let n\_samples = block\_size >> order; |
|  |  | let n\_samples\_per\_partition = block\_size >> order; |
|  |  |  |
|  |  | // The partitions together must fill the block. If the block size is not a |
|  |  | // multiple of 2^order; if we shifted off some bits, then we would not fill |
|  |  | // the entire block. Such a partition order is invalid for this block size. |
|  |  | if block\_size & (n\_partitions - 1) as u16 != 0 { |
|  |  | return fmt\_err("invalid partition order") |
|  |  | } |
|  |  |  |
|  |  | // NOTE: the check above checks that block\_size is a multiple of n\_partitions |
|  |  | // (this works because n\_partitions is a power of 2). The check below is |
|  |  | // equivalent but more expensive. |
|  |  | debug\_assert\_eq!(n\_partitions \* n\_samples\_per\_partition as u32, block\_size as u32); |
|  |  |  |
|  |  | let n\_warm\_up = block\_size - buffer.len() as u16; |
|  |  |  |
|  |  | // The partition size must be at least as big as the number of warm-up |
|  |  | // samples, otherwise the size of the first partition is negative. |
|  |  | if n\_warm\_up > n\_samples { |
|  |  | if n\_warm\_up > n\_samples\_per\_partition { |
|  |  | return fmt\_err("invalid residual"); |
|  |  | } |
|  |  |  |
|  |  | // Finally decode the partitions themselves. |
|  |  | match partition\_type { |
|  |  | RicePartitionType::Rice => { |
|  |  | let mut start = 0; |
|  |  | let mut len = n\_samples - n\_warm\_up; |
|  |  | let mut len = n\_samples\_per\_partition - n\_warm\_up; |
|  |  | for \_ in 0..n\_partitions { |
|  |  | let slice = &mut buffer[start..start + len as usize]; |
|  |  | try!(decode\_rice\_partition(input, slice)); |
|  |  | start = start + len as usize; |
|  |  | len = n\_samples; |
|  |  | len = n\_samples\_per\_partition; |
|  |  | } |
|  |  | } |
|  |  | RicePartitionType::Rice2 => { |
|  |  | let mut start = 0; |
|  |  | let mut len = n\_samples - n\_warm\_up; |
|  |  | let mut len = n\_samples\_per\_partition - n\_warm\_up; |
|  |  | for \_ in 0..n\_partitions { |
|  |  | let slice = &mut buffer[start..start + len as usize]; |
|  |  | try!(decode\_rice2\_partition(input, slice)); |
|  |  | start = start + len as usize; |
|  |  | len = n\_samples; |
|  |  | len = n\_samples\_per\_partition; |
|  |  | } |
|  |  | } |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8f28ec2`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fruuda%2Fclaxon%2Fcommit%2F8f28ec275e412dd3af4f3cda460605512faf332c) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from rustsec.org_80834902_20250124_143047.html ===


RUSTSEC-2018-0004: claxon: Malicious input could cause uninitialized memory to be exposed › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/claxon/RUSTSEC-2018-0004.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/claxon/RUSTSEC-2018-0004.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2018-0004)

# RUSTSEC-2018-0004

Malicious input could cause uninitialized memory to be exposed

Reported
August 25, 2018

Issued
October 1, 2020

(last modified: June 13, 2023)

Package
[claxon](/packages/claxon.html)
([crates.io](https://crates.io/crates/claxon))

Type
Vulnerability

Keywords
[#uninitialized-memory](/keywords/uninitialized-memory.html)

Aliases

* [CVE-2018-20992](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20992)
* [GHSA-8c6g-4xc5-w96c](https://github.com/advisories/GHSA-8c6g-4xc5-w96c)

References

* <https://github.com/ruuda/claxon/commit/8f28ec275e412dd3af4f3cda460605512faf332c>

CVSS Score
6.5
MEDIUM

CVSS Details
Attack vectorNetwork
Attack complexityLow
Privileges requiredNone
User interactionRequired
ScopeUnchanged
ConfidentialityHigh
IntegrityNone
AvailabilityNone

CVSS Vector
[CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N)
Patched

* `^0.3.2`
* `>=0.4.1`

### Description

Affected versions of Claxon made an invalid assumption about the decode buffer
size being a multiple of a value read from the bitstream. This could cause parts
of the decode buffer to not be overwritten. If the decode buffer was newly
allocated and uninitialized, this uninitialized memory could be exposed.

This allows an attacker to observe parts of the uninitialized memory in the
decoded audio stream.

The flaw was corrected by checking that the value read from the bitstream divides
the decode buffer size, and returning a format error if it does not. If an error
is returned, the decode buffer is not exposed. Regression tests and an
additional fuzzer have been added to prevent similar flaws in the future.

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.


