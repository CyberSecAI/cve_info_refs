=== Content from github.com_328be18a_20250125_230419.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fpull%2F1168%2Fcommits%2Fc58df149900df862806d0e892859b41115875845)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fpull%2F1168%2Fcommits%2Fc58df149900df862806d0e892859b41115875845)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fpull_requests%2Fshow%2Fcommits&source=header-repo&source_repo=uclouvain%2Fopenjpeg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[uclouvain](/uclouvain)
/
**[openjpeg](/uclouvain/openjpeg)**
Public

* [Notifications](/login?return_to=%2Fuclouvain%2Fopenjpeg) You must be signed in to change notification settings
* [Fork
  468](/login?return_to=%2Fuclouvain%2Fopenjpeg)
* [Star
   995](/login?return_to=%2Fuclouvain%2Fopenjpeg)

* [Code](/uclouvain/openjpeg)
* [Issues
  300](/uclouvain/openjpeg/issues)
* [Pull requests
  34](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects
  0](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

Additional navigation options

* [Code](/uclouvain/openjpeg)
* [Issues](/uclouvain/openjpeg/issues)
* [Pull requests](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fuclouvain%2Fopenjpeg%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fuclouvain%2Fopenjpeg%2Fissues%2Fnew%2Fchoose)
to your account

# Fix multiple potential vulnerabilities and bugs #1168

 Merged

[rouault](/rouault)
merged 8 commits into
[uclouvain:master](/uclouvain/openjpeg/tree/master "uclouvain/openjpeg:master")
from
[YangY-Xiao:fix\_dev](/YangY-Xiao/openjpeg/tree/fix_dev "YangY-Xiao/openjpeg:fix_dev")

Dec 7, 2018

[Conversation
6](/uclouvain/openjpeg/pull/1168)
[Commits
8](/uclouvain/openjpeg/pull/1168/commits)
[Checks
0](/uclouvain/openjpeg/pull/1168/checks)
[Files changed](/uclouvain/openjpeg/pull/1168/files)

 Merged

# [Fix multiple potential vulnerabilities and bugs](#top) #1168

Changes from **1 commit**

Commits

[Show all changes

8 commits](/uclouvain/openjpeg/pull/1168/files)
Select commit
Hold shift + click to select a range

[`c5bd64e`
[MJ2] To avoid divisions by zero / undefined behaviour on shift

Yoha-test Nov 23, 2018](/uclouvain/openjpeg/pull/1168/commits/c5bd64ea146162967c29bd2af0cbb845ba3eaaaf)
[`619e1b0`
[JPWL] fix CVE-2018-16375

Yoha-test Nov 23, 2018](/uclouvain/openjpeg/pull/1168/commits/619e1b086eaa21ebd9b23eb67deee543b07bf06f)
[`46822d0`
[JPWL] imagetotga(): fix read heap buffer overflow if numcomps < 3 (#‚Ä¶

Yoha-test Nov 23, 2018](/uclouvain/openjpeg/pull/1168/commits/46822d0eddc3324b2a056bc60ffa997027bebd66)
[`c277159`
[MJ2] Avoid index out of bounds access to pi->include[]

Yoha-test Nov 23, 2018](/uclouvain/openjpeg/pull/1168/commits/c277159986c80142180fbe5efb256bbf3bdf3edc)
[`c58df14`
[OPENJP2] change the way to compute \*p\_tx0, \*p\_tx1, \*p\_ty0, \*p\_ty1 in‚Ä¶

Yoha-test Nov 23, 2018](/uclouvain/openjpeg/pull/1168/commits/c58df149900df862806d0e892859b41115875845)
[`ce9583d`
[JPWL] opj\_compress: reorder checks related to code block dimensions‚Ä¶

Yoha-test Nov 23, 2018](/uclouvain/openjpeg/pull/1168/commits/ce9583d1d7627e007a34a31ae4e22a00d78bd153)
[`bd88611`
[JP3D] To avoid divisions by zero / undefined behaviour on shift (CV‚Ä¶

Yoha-test Nov 23, 2018](/uclouvain/openjpeg/pull/1168/commits/bd88611ed9ad7144ec4f3de54790cd848175891b)
[`05be308`
[JPWL] tgatoimage(): avoid excessive memory allocation attempt,

Yoha-test Nov 28, 2018](/uclouvain/openjpeg/pull/1168/commits/05be3084460e46282ee63f04c72c451f3271fd28)

**File filter**

### Filter by extension

Filter by extension

.c
(1)

All 1 file type selected

---

Viewed files

[Clear filters](/uclouvain/openjpeg/pull/1168/commits/c58df149900df862806d0e892859b41115875845)

 **Conversations**

Failed to load comments.  Retry

 Loading

 **Jump to**

Jump to file

Failed to load files.  Retry

 Loading

##### Diff view

![Unified Diff View](https://github.githubassets.com/assets/unified-6de447b07fd7.svg)

Unified

![Split Diff View](https://github.githubassets.com/assets/split-b930d4a1df45.svg)

Split

Hide whitespace

 Apply and reload

Show whitespace

##### Diff view

![Unified Diff View](https://github.githubassets.com/assets/unified-6de447b07fd7.svg)

Unified

![Split Diff View](https://github.githubassets.com/assets/split-b930d4a1df45.svg)

Split

Hide whitespace

 Apply and reload

 [Prev](/uclouvain/openjpeg/pull/1168/commits/c277159986c80142180fbe5efb256bbf3bdf3edc)Previous commit

 [Next](/uclouvain/openjpeg/pull/1168/commits/ce9583d1d7627e007a34a31ae4e22a00d78bd153)Next commit

[OPENJP2] change the way to compute \*p\_tx0, \*p\_tx1, \*p\_ty0, \*p\_ty1 in‚Ä¶

```
‚Ä¶ function

opj_get_encoding_parameters

Signed-off-by: Young_X <YangX92@hotmail.com>
```

* Loading branch information

[![@Yoha-test](https://avatars.githubusercontent.com/u/68892399?s=40&v=4)](/Yoha-test)

[Yoha-test](/uclouvain/openjpeg/commits?author=Yoha-test "View all commits by Yoha-test")
committed
Nov 28, 2018

commit c58df149900df862806d0e892859b41115875845

## There are no files selected for viewing

19 changes: 11 additions & 8 deletions

19
[src/lib/openjp2/pi.c](#diff-2d87a2b9d28551231d2495a42a632760b7386044f236b4464ca28bbbe9320f98 "src/lib/openjp2/pi.c")

Show comments

[View file](/YangY-Xiao/openjpeg/blob/c58df149900df862806d0e892859b41115875845/src/lib/openjp2/pi.c)
Edit file

Delete file

[Open in desktop](https://desktop.github.com)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -748,6 +748,9 @@ static void opj\_get\_encoding\_parameters(const opj\_image\_t \*p\_image, |
|  |  | /\* position in x and y of tile \*/ |
|  |  | OPJ\_UINT32 p, q; |
|  |  |  |
|  |  | /\* non-corrected (in regard to image offset) tile offset \*/ |
|  |  | OPJ\_UINT32 l\_tx0, l\_ty0; |
|  |  |  |
|  |  | /\* preconditions \*/ |
|  |  | assert(p\_cp != 00); |
|  |  | assert(p\_image != 00); |
| Expand All | | @@ -763,14 +766,14 @@ static void opj\_get\_encoding\_parameters(const opj\_image\_t \*p\_image, |
|  |  | q = p\_tileno / p\_cp->tw; |
|  |  |  |
|  |  | /\* find extent of tile \*/ |
|  |  | \*p\_tx0 = opj\_int\_max((OPJ\_INT32)(p\_cp->tx0 + p \* p\_cp->tdx), |
|  |  | (OPJ\_INT32)p\_image->x0); |
|  |  | \*p\_tx1 = opj\_int\_min((OPJ\_INT32)(p\_cp->tx0 + (p + 1) \* p\_cp->tdx), |
|  |  | (OPJ\_INT32)p\_image->x1); |
|  |  | \*p\_ty0 = opj\_int\_max((OPJ\_INT32)(p\_cp->ty0 + q \* p\_cp->tdy), |
|  |  | (OPJ\_INT32)p\_image->y0); |
|  |  | \*p\_ty1 = opj\_int\_min((OPJ\_INT32)(p\_cp->ty0 + (q + 1) \* p\_cp->tdy), |
|  |  | (OPJ\_INT32)p\_image->y1); |
|  |  | l\_tx0 = p\_cp->tx0 + p \* |
|  |  | p\_cp->tdx; /\* can't be greater than p\_image->x1 so won't overflow \*/ |
|  |  | \*p\_tx0 = (OPJ\_INT32)opj\_uint\_max(l\_tx0, p\_image->x0); |
|  |  | \*p\_tx1 = (OPJ\_INT32)opj\_uint\_min(opj\_uint\_adds(l\_tx0, p\_cp->tdx), p\_image->x1); |
|  |  | l\_ty0 = p\_cp->ty0 + q \* |
|  |  | p\_cp->tdy; /\* can't be greater than p\_image->y1 so won't overflow \*/ |
|  |  | \*p\_ty0 = (OPJ\_INT32)opj\_uint\_max(l\_ty0, p\_image->y0); |
|  |  | \*p\_ty1 = (OPJ\_INT32)opj\_uint\_min(opj\_uint\_adds(l\_ty0, p\_cp->tdy), p\_image->y1); |
|  |  |  |
|  |  | /\* max precision is 0 (can only grow) \*/ |
|  |  | \*p\_max\_prec = 0; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_1f79cc4b_20250125_230418.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%2F431)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fissues%2F431)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=uclouvain%2Fopenjpeg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[uclouvain](/uclouvain)
/
**[openjpeg](/uclouvain/openjpeg)**
Public

* [Notifications](/login?return_to=%2Fuclouvain%2Fopenjpeg) You must be signed in to change notification settings
* [Fork
  468](/login?return_to=%2Fuclouvain%2Fopenjpeg)
* [Star
   995](/login?return_to=%2Fuclouvain%2Fopenjpeg)

* [Code](/uclouvain/openjpeg)
* [Issues
  300](/uclouvain/openjpeg/issues)
* [Pull requests
  34](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects
  0](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

Additional navigation options

* [Code](/uclouvain/openjpeg)
* [Issues](/uclouvain/openjpeg/issues)
* [Pull requests](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

# Heap-buffer-overflow in opj\_tcd\_init\_decode\_tile¬†#431

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Heap-buffer-overflow in opj\_tcd\_init\_decode\_tile](#top)#431Copy linkAssignees [![mayeut](https://avatars.githubusercontent.com/u/9768336?s=64&v=4)](/mayeut)Labels[Priority-Critical](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22Priority-Critical%22)[Restrict-View-CoreTeam](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22Restrict-View-CoreTeam%22)[bug](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22bug%22)[![@gcode-importer](https://avatars.githubusercontent.com/u/12817608?u=2df5f7fbcad9b9724ab3be7060ff5e0649966506&v=4&size=80)](/gcode-importer)
## Description

[![@gcode-importer](https://avatars.githubusercontent.com/u/12817608?u=2df5f7fbcad9b9724ab3be7060ff5e0649966506&v=4&size=48)](/gcode-importer)[gcode-importer](https://github.com/gcode-importer)opened [on Nov 14, 2014](https://github.com/uclouvain/openjpeg/issues/431#issue-87401059)

Originally reported on Google Code with ID 431

```
https://code.google.com/p/chromium/issues/detail?id=431288

Reproduced on trunk r2924 using MacOS x86 ASan build :
ASAN_OPTIONS="allocator_may_return_null=1" ./bin/opj_decompress -i ../../ex/0.jp2 -o
0.bmp

[INFO] Start to read j2k main header (119).
[INFO] Main header has been correctly decoded.
[INFO] No decoded area parameters, set the decoded area to the whole image
ERROR in tgt_create while allocating node of the tree
WARNING: No incltree created.
ERROR in tgt_create while allocating node of the tree
WARNING: No imsbtree created.
=================================================================
==3245==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x02f03d00 at pc 0x007f193c
bp 0xbffa61f8 sp 0xbffa61f4
READ of size 4 at 0x02f03d00 thread T0
    #0 0x7f193b in opj_tcd_code_block_dec_allocate /Users/Matt/Dev/OpenJpeg/issue398/src/lib/openjp2/tcd.c:1051:13
    #1 0x7f0bed in opj_tcd_init_decode_tile /Users/Matt/Dev/OpenJpeg/issue398/src/lib/openjp2/tcd.c:1012:1
    #2 0x79bfce in opj_j2k_read_tile_header /Users/Matt/Dev/OpenJpeg/issue398/src/lib/openjp2/j2k.c:8008:15
    #3 0x7b3007 in opj_j2k_decode_tiles /Users/Matt/Dev/OpenJpeg/issue398/src/lib/openjp2/j2k.c:9543:23
    #4 0x799b07 in opj_j2k_exec /Users/Matt/Dev/OpenJpeg/issue398/src/lib/openjp2/j2k.c:7435:41
    #5 0x7a3723 in opj_j2k_decode /Users/Matt/Dev/OpenJpeg/issue398/src/lib/openjp2/j2k.c:9762:15
    #6 0x7ba8df in opj_jp2_decode /Users/Matt/Dev/OpenJpeg/issue398/src/lib/openjp2/jp2.c:1398:8
    #7 0x7c6c83 in opj_decode /Users/Matt/Dev/OpenJpeg/issue398/src/lib/openjp2/openjpeg.c:412:10
    #8 0x5d12c in main /Users/Matt/Dev/OpenJpeg/issue398/src/bin/jp2/opj_decompress.c:821:10
    #9 0x9a68d6d8 in start (/usr/lib/system/libdyld.dylib+0x36d8)
    #10 0x4 (<unknown module>)

0x02f03d00 is located 0 bytes to the right of 7168-byte region [0x02f02100,0x02f03d00)
allocated by thread T0 here:
    #0 0x2c0dba in wrap_malloc (/Users/Matt/Dev/llvm-clang-3.5.0-macosx-apple-darwin/lib/clang/3.5.0/lib/darwin/libclang_rt.asan_osx_dynamic.dylib+0x2fdba)
    #1 0x7f08b9 in opj_tcd_init_decode_tile /Users/Matt/Dev/OpenJpeg/issue398/src/lib/openjp2/tcd.c:1012:1
    #2 0x79bfce in opj_j2k_read_tile_header /Users/Matt/Dev/OpenJpeg/issue398/src/lib/openjp2/j2k.c:8008:15
    #3 0x7b3007 in opj_j2k_decode_tiles /Users/Matt/Dev/OpenJpeg/issue398/src/lib/openjp2/j2k.c:9543:23
    #4 0x799b07 in opj_j2k_exec /Users/Matt/Dev/OpenJpeg/issue398/src/lib/openjp2/j2k.c:7435:41
    #5 0x7a3723 in opj_j2k_decode /Users/Matt/Dev/OpenJpeg/issue398/src/lib/openjp2/j2k.c:9762:15
    #6 0x7ba8df in opj_jp2_decode /Users/Matt/Dev/OpenJpeg/issue398/src/lib/openjp2/jp2.c:1398:8
    #7 0x7c6c83 in opj_decode /Users/Matt/Dev/OpenJpeg/issue398/src/lib/openjp2/openjpeg.c:412:10
    #8 0x5d12c in main /Users/Matt/Dev/OpenJpeg/issue398/src/bin/jp2/opj_decompress.c:821:10
    #9 0x9a68d6d8 in start (/usr/lib/system/libdyld.dylib+0x36d8)
    #10 0x4 (<unknown module>)

SUMMARY: AddressSanitizer: heap-buffer-overflow /Users/Matt/Dev/OpenJpeg/issue398/src/lib/openjp2/tcd.c:1051
opj_tcd_code_block_dec_allocate
Shadow bytes around the buggy address:
  0x205e0750: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x205e0760: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x205e0770: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x205e0780: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x205e0790: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x205e07a0:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x205e07b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x205e07c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x205e07d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x205e07e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x205e07f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  ASan internal:           fe
==3245==ABORTING

```

Reported by [mayeut](https://github.com/mayeut) on 2014-11-14 19:45:14

## Metadata

### Assignees

* [![@mayeut](https://avatars.githubusercontent.com/u/9768336?s=64&v=4)mayeut](/mayeut)
### Labels

[Priority-Critical](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22Priority-Critical%22)[Restrict-View-CoreTeam](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22Restrict-View-CoreTeam%22)[bug](https://github.com/uclouvain/openjpeg/issues?q=state%3Aopen%20label%3A%22bug%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from lists.debian.org_01a79067_20250125_230420.html ===


---

[[Date Prev](msg00009.html)][[Date Next](msg00011.html)]
[[Thread Prev](msg00009.html)][[Thread Next](msg00011.html)]
[[Date Index](maillist.html#00010)]
[[Thread Index](threads.html#00010)]

# [SECURITY] [DLA 1851-1] openjpeg2 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1851-1] openjpeg2 security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Wed, 10 Jul 2019 20:17:41 +0200
* *Message-id*: <[[üîé]](/msgid-search/ba77e139-8a5c-056a-d324-7fbd2943c0ee%40debian.org)¬†[ba77e139-8a5c-056a-d324-7fbd2943c0ee@debian.org](msg00010.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Package        : openjpeg2
Version        : 2.1.0-2+deb8u7
CVE ID         : CVE-2016-9112 CVE-2018-20847
Debian Bug     : 931294 844551

Two security vulnerabilities were discovered in openjpeg2, a JPEG 2000
image library.

CVE-2016-9112

     A floating point exception or divide by zero in the function
     opj_pi_next_cprl may lead to a denial-of-service.

CVE-2018-20847

     An improper computation of values in the function
     opj_get_encoding_parameters can lead to an integer overflow.
     This issue was partly fixed by the patch for CVE-2015-1239.

For Debian 8 "Jessie", these problems have been fixed in version
2.1.0-2+deb8u7.

We recommend that you upgrade your openjpeg2 packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEErPPQiO8y7e9qGoNf2a0UuVE7UeQFAl0mK8VfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldEFD
RjNEMDg4RUYzMkVERUY2QTFBODM1RkQ5QUQxNEI5NTEzQjUxRTQACgkQ2a0UuVE7
UeQhHA/9FIx06atS757tVz05E34Kj3UBHKq1KPPPyzliFvq1OJoCoJRFAlg7VeYM
771a61wMnqIo03B4Ng61pqRxOtgzjVha+hVfHdJwNpqutyJqL4+QU6hXm4q9fsWZ
xhgiI7HSiDeI3XlrwL0TDaUpZRKezQRDM8WSCBDtzsdHIHw9FbASkvLebtfENMN0
XxxxjFQpBV1zsBo5sX/ivhqDCpQ/9vT2Mf4YO/Ia85w6mJYG3CbJ4Oq3W8mUlE4/
/YGe8KaNCJOueai9tU2q+KDTiEW8l+xCqbRRC1mvGjbOnWzEYEK5n8aAfjCJnH8/
8wJy8fRhVbNGb4bC5i0fehhgBHNKxozA5klhkcPB2OZDDCY5bNfFeyNj+5jltGws
RDyeFE3qGUga+lKSyrg9A6HwwtsIRvpRreraWahfz98OnSAkCJMnpUJeG9/w6fgo
T9fETdUrCDx5UqjrAYhVOclZodECixQnJQnfS7ig9euXM7bkhNTbSyCYLSet4+oc
JDKcvD1maaZcj5vVkjoksmDczJWzRxsMG0i48OqzRNeppOA/MNtx7h70Ryg1qQLn
xJcAuYyflxGofhfuUAIMnI5b5iK/+q9rp98bBG31lpuoNzIl0/UWN/dWzjOviONu
0bdD8ryvTVMBw/PtNPdCVYLYPUya2T68FybTduZedNKSopClnuQ=
=dXLr
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_d48e7ad6_20250125_230418.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fcommit%2F5d00b719f4b93b1445e6fb4c766b9a9883c57949)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fcommit%2F5d00b719f4b93b1445e6fb4c766b9a9883c57949)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=uclouvain%2Fopenjpeg)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[uclouvain](/uclouvain)
/
**[openjpeg](/uclouvain/openjpeg)**
Public

* [Notifications](/login?return_to=%2Fuclouvain%2Fopenjpeg) You must be signed in to change notification settings
* [Fork
  468](/login?return_to=%2Fuclouvain%2Fopenjpeg)
* [Star
   995](/login?return_to=%2Fuclouvain%2Fopenjpeg)

* [Code](/uclouvain/openjpeg)
* [Issues
  300](/uclouvain/openjpeg/issues)
* [Pull requests
  34](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects
  0](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

Additional navigation options

* [Code](/uclouvain/openjpeg)
* [Issues](/uclouvain/openjpeg/issues)
* [Pull requests](/uclouvain/openjpeg/pulls)
* [Actions](/uclouvain/openjpeg/actions)
* [Projects](/uclouvain/openjpeg/projects)
* [Wiki](/uclouvain/openjpeg/wiki)
* [Security](/uclouvain/openjpeg/security)
* [Insights](/uclouvain/openjpeg/pulse)

## Commit

[Permalink](/uclouvain/openjpeg/commit/5d00b719f4b93b1445e6fb4c766b9a9883c57949)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[trunk] fixed a buffer overflow in opj\_tcd\_init\_decode\_tile

[Browse files](/uclouvain/openjpeg/tree/5d00b719f4b93b1445e6fb4c766b9a9883c57949)
Browse the repository at this point in the history

```
Update issue 431
```

* Loading branch information

[![@detonin](https://avatars.githubusercontent.com/u/429904?s=40&v=4)](/detonin)

[detonin](/uclouvain/openjpeg/commits?author=detonin "View all commits by detonin")
committed
Jan 15, 2015

1 parent
[42132ed](/uclouvain/openjpeg/commit/42132ed6b56120e45356a7c8cfdea7b6e39cd058)

commit 5d00b71

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**9 additions**
and
**8 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/lib/openjp2

  + src/lib/openjp2/pi.c
    [pi.c](#diff-2d87a2b9d28551231d2495a42a632760b7386044f236b4464ca28bbbe9320f98)
  + src/lib/openjp2/tcd.c
    [tcd.c](#diff-9f3b24ffd188ebff3aa6707064d92f37fd858a3b78d3984272a7896e6beff360)

## There are no files selected for viewing

8 changes: 4 additions & 4 deletions

8
[src/lib/openjp2/pi.c](#diff-2d87a2b9d28551231d2495a42a632760b7386044f236b4464ca28bbbe9320f98 "src/lib/openjp2/pi.c")

Show comments

[View file](/uclouvain/openjpeg/blob/5d00b719f4b93b1445e6fb4c766b9a9883c57949/src/lib/openjp2/pi.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -708,10 +708,10 @@ void opj\_get\_all\_encoding\_parameters( const opj\_image\_t \*p\_image, |
|  |  | q = tileno / p\_cp->tw; |
|  |  |  |
|  |  | /\* here calculation of tx0, tx1, ty0, ty1, maxprec, l\_dx and l\_dy \*/ |
|  |  | \*p\_tx0 = opj\_int\_max((OPJ\_INT32)(p\_cp->tx0 + p \* p\_cp->tdx), (OPJ\_INT32)p\_image->x0); |
|  |  | \*p\_tx1 = opj\_int\_min((OPJ\_INT32)(p\_cp->tx0 + (p + 1) \* p\_cp->tdx), (OPJ\_INT32)p\_image->x1); |
|  |  | \*p\_ty0 = opj\_int\_max((OPJ\_INT32)(p\_cp->ty0 + q \* p\_cp->tdy), (OPJ\_INT32)p\_image->y0); |
|  |  | \*p\_ty1 = opj\_int\_min((OPJ\_INT32)(p\_cp->ty0 + (q + 1) \* p\_cp->tdy), (OPJ\_INT32)p\_image->y1); |
|  |  | \*p\_tx0 = (OPJ\_INT32)opj\_uint\_max(p\_cp->tx0 + p \* p\_cp->tdx, p\_image->x0); |
|  |  | \*p\_tx1 = (OPJ\_INT32)opj\_uint\_min(p\_cp->tx0 + (p + 1) \* p\_cp->tdx, p\_image->x1); |
|  |  | \*p\_ty0 = (OPJ\_INT32)opj\_uint\_max(p\_cp->ty0 + q \* p\_cp->tdy, p\_image->y0); |
|  |  | \*p\_ty1 = (OPJ\_INT32)opj\_uint\_min(p\_cp->ty0 + (q + 1) \* p\_cp->tdy, p\_image->y1); |
|  |  |  |
|  |  | /\* max precision and resolution is 0 (can only grow)\*/ |
|  |  | \*p\_max\_prec = 0; |
| Expand Down | |  |

9 changes: 5 additions & 4 deletions

9
[src/lib/openjp2/tcd.c](#diff-9f3b24ffd188ebff3aa6707064d92f37fd858a3b78d3984272a7896e6beff360 "src/lib/openjp2/tcd.c")

Show comments

[View file](/uclouvain/openjpeg/blob/5d00b719f4b93b1445e6fb4c766b9a9883c57949/src/lib/openjp2/tcd.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -701,10 +701,11 @@ static INLINE OPJ\_BOOL opj\_tcd\_init\_tile(opj\_tcd\_t \*p\_tcd, OPJ\_UINT32 p\_tile\_no, |
|  |  | /\*fprintf(stderr, "Tile coordinate = %d,%d\n", p, q);\*/ |
|  |  |  |
|  |  | /\* 4 borders of the tile rescale on the image if necessary \*/ |
|  |  | l\_tile->x0 = opj\_int\_max((OPJ\_INT32)(l\_cp->tx0 + p \* l\_cp->tdx), (OPJ\_INT32)l\_image->x0); |
|  |  | l\_tile->y0 = opj\_int\_max((OPJ\_INT32)(l\_cp->ty0 + q \* l\_cp->tdy), (OPJ\_INT32)l\_image->y0); |
|  |  | l\_tile->x1 = opj\_int\_min((OPJ\_INT32)(l\_cp->tx0 + (p + 1) \* l\_cp->tdx), (OPJ\_INT32)l\_image->x1); |
|  |  | l\_tile->y1 = opj\_int\_min((OPJ\_INT32)(l\_cp->ty0 + (q + 1) \* l\_cp->tdy), (OPJ\_INT32)l\_image->y1); |
|  |  | l\_tile->x0 = (OPJ\_INT32)opj\_uint\_max(l\_cp->tx0 + p \* l\_cp->tdx, l\_image->x0); |
|  |  | l\_tile->y0 = (OPJ\_INT32)opj\_uint\_max(l\_cp->ty0 + q \* l\_cp->tdy, l\_image->y0); |
|  |  | l\_tile->x1 = (OPJ\_INT32)opj\_uint\_min(l\_cp->tx0 + (p + 1) \* l\_cp->tdx, l\_image->x1); |
|  |  | l\_tile->y1 = (OPJ\_INT32)opj\_uint\_min(l\_cp->ty0 + (q + 1) \* l\_cp->tdy, l\_image->y1); |
|  |  |  |
|  |  | /\* testcase 1888.pdf.asan.35.988 \*/ |
|  |  | if (l\_tccp->numresolutions == 0) { |
|  |  | fprintf(stderr, "tiles require at least one resolution\n"); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `5d00b71`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fuclouvain%2Fopenjpeg%2Fcommit%2F5d00b719f4b93b1445e6fb4c766b9a9883c57949) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


