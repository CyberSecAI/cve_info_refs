The provided content relates to a vulnerability where Mailpile's setup dialog offered revoked PGP keys to users.

**Root cause of vulnerability:**
The Mailpile application was not properly filtering out revoked, disabled, and expired PGP keys when listing available keys for use during account setup. This caused the application to present unusable keys to users, potentially leading to configuration issues and users not being able to use those keys.

**Weaknesses/vulnerabilities:**
- Inadequate filtering of PGP keys: The application's logic for listing secret keys did not consider the revocation, disabled, and expired status of keys.
- GPG Version Dependency: Older versions of gpg displayed the necessary validity information differently from the current versions, resulting in a workaround that was incomplete.

**Impact of exploitation:**
- Users could mistakenly select revoked or unusable keys, leading to failed encryption and signing operations.
- Configuration issues when setting up new accounts

**Attack vectors:**
- An attacker with control over PGP keys could revoke them, and the application would still offer those keys to users
- The vulnerability is not related to direct exploitation but rather an issue with functionality that can cause a degraded user experience.

**Required attacker capabilities/position:**
- No specific attacker capabilities or position is required to exploit this vulnerability. The issue stems from the application's own logic.