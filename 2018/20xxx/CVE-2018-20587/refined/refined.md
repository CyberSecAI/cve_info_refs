Based on the provided information, here's an analysis of CVE-2018-20587:

**Root cause of vulnerability:**

The vulnerability stems from the Bitcoin Core and Bitcoin Knots RPC service attempting to bind and listen for connections on both IPv4 and IPv6 localhost. If binding to one of the protocols fails, the software will still start. Another user on the same system can bind to the port of the failed protocol and forward requests to the port of the successful protocol, thereby intercepting RPC requests.

**Weaknesses/vulnerabilities present:**

*   **Incorrect Access Control:** The software does not properly ensure that the RPC service binds to both IPv4 and IPv6 localhost interfaces, allowing a malicious user to intercept requests intended for the Bitcoin node.
*   **Silent Failure:** The software silently ignores failures to bind to one of the RPC listening ports.
*   **Lack of Alert:** There is no alert or warning when the RPC service fails to bind to one of the ports.

**Impact of exploitation:**

*   **Theft:** An attacker can intercept RPC requests and responses, including authentication credentials and wallet passwords (if wallets are unlocked through the RPC interface).
*   **Compromise of Consensus:** An attacker can use stolen credentials to make their own RPC calls, which may compromise consensus, send the walletâ€™s bitcoins elsewhere, and so on.

**Attack vectors:**

*   **Local/Remote Access:** An attacker needs to have the ability to run their own services on the same computer as the vulnerable Bitcoin node. This could be either local or remote access.
*   **RPC Service Enabled:** The target system must have the RPC service enabled.
*   **Node not running:** Attempting to use the RPC service while the node is not running will create a security risk since the node will not be able to prevent the attack.

**Required attacker capabilities/position:**

*   Must be a user on the same multi-user system as the target Bitcoin node.
*   Must be able to bind to network ports on the system.
*   Must be able to intercept and forward network traffic.

**Additional Details:**

*   This vulnerability affects all currently released versions of Bitcoin Core, including the latest 0.17.1 at the time of disclosure, and Bitcoin Knots prior to 0.17.1.knots20181229.
*   The risk is considered low and might not be fixed in Bitcoin Core.
*   The vulnerability can be mitigated by:
    *   Forbidding usage of the computer by other people.
    *   Forbidding other users from binding to the RPC port.
    *   Turning off the RPC service entirely.
    *   Checking the debug log for binding failures before using the RPC service.
    *   Configuring the node to bind to only one RPC port.
*   Bitcoin Knots 0.17.1.knots20181229 has an experimental fix.

This vulnerability is related to the RPC service binding to both IPv4 and IPv6, not just one, as described by the official description of CVE-2018-20587.