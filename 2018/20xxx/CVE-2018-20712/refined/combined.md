=== Content from sourceware.org_ab222e02_20250124_170722.html ===


Sourceware Bugzilla – Bug 24043
Heap-buffer-overflow problem in function d\_expression\_1 in cp-demangle.c, as demonstrated by c++filt
Last modified: 2019-01-04 16:56:53 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=24043&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=24043&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 24043**](show_bug.cgi?id=24043)
- Heap-buffer-overflow problem in function d\_expression\_1 in cp-demangle.c, as demonstrated by c++filt

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Heap-buffer-overflow problem in function d\_expression\_1 in cp-demangle.c, as ...

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED MOVED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | binutils | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=binutils "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | binutils ([show other bugs](buglist.cgi?component=binutils&product=binutils&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 2.32 | |  | | | [Importance](page.cgi?id=fields.html#importance): | P2 normal | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Not yet assigned to anyone | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2018-12-28 09:21 UTC by wcventure | | --- | --- | | Modified: | 2019-01-04 16:56 UTC ([History](show_activity.cgi?id=24043)) | | CC List: | 1 user (show)  nickc | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Host:](page.cgi?id=fields.html#cf_gcchost "A custom Free Text field in this installation of Bugzilla.") |  | | [Target:](page.cgi?id=fields.html#cf_gcctarget "A custom Free Text field in this installation of Bugzilla.") |  | | [Build:](page.cgi?id=fields.html#cf_gccbuild "A custom Free Text field in this installation of Bugzilla.") |  | | [Last reconfirmed:](page.cgi?id=fields.html#cf_reconfirmed_on "A custom Date/Time field in this installation of Bugzilla.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**POC1**](attachment.cgi?id=11499 "View the content of the attachment") (173 bytes, application/octet-stream)  [2018-12-28 09:21 UTC](#attach_11499 "Go to the comment associated with the attachment"), wcventure | [Details](attachment.cgi?id=11499&action=edit) | | [**POC2**](attachment.cgi?id=11500 "View the content of the attachment") (178 bytes, application/octet-stream)  [2018-12-28 09:22 UTC](#attach_11500 "Go to the comment associated with the attachment"), wcventure | [Details](attachment.cgi?id=11500&action=edit) | | [**POC3**](attachment.cgi?id=11501 "View the content of the attachment") (142 bytes, application/octet-stream)  [2018-12-28 09:22 UTC](#attach_11501 "Go to the comment associated with the attachment"), wcventure | [Details](attachment.cgi?id=11501&action=edit) | | [View All](attachment.cgi?bugid=24043&action=viewall)  [Add an attachment](attachment.cgi?bugid=24043&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=24043&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=24043#c0)  wcventure    2018-12-28 09:21:51 UTC  ``` Created [attachment 11499](attachment.cgi?id=11499 "POC1") [[details]](attachment.cgi?id=11499&action=edit "POC1") POC1  Hi, there.  A Heap-buffer-overflow problem was discovered in function function d_expression_1 in cp-demangle.c of binutils latest code base, too. A crafted ELF input can cause segment faults and I have confirmed them with address sanitizer too.  Please use the "./c++filt -t < $POC" to reproduce the bug.  Note that this error only occurs in the last code base, maybe this is a regression error. I will show you the commit ID.  > $ git log > commit ebb8004a18a3808d7197762faf3c5aaeae82371f > Author: GDB Administrator <gdbadmin@sourceware.org> > Date:   Wed Dec 19 00:00:21 2018 +0000 >  >     Automatic date update in version.in  The ASAN dumps the stack trace as follows:  > ================================================================= > ==83311==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000000059 at pc 0x000000ac9a4b bp 0x7ffeedce2490 sp 0x7ffeedce2488 > READ of size 1 at 0x602000000059 thread T0 >     #0 0xac9a4a in d_expression_1 /binutils-gdb/libiberty/./cp-demangle.c:3356:12 >     #1 0xab4724 in d_expression /binutils-gdb/libiberty/./cp-demangle.c:3531:9 >     #2 0xaacdbe in cplus_demangle_type /binutils-gdb/libiberty/./cp-demangle.c:2615:9 >     #3 0xaaab09 in cplus_demangle_type /binutils-gdb/libiberty/./cp-demangle.c:2411:10 >     #4 0xaac400 in cplus_demangle_type /binutils-gdb/libiberty/./cp-demangle.c:2568:26 >     #5 0xaac400 in cplus_demangle_type /binutils-gdb/libiberty/./cp-demangle.c:2568:26 >     #6 0xab8dc1 in d_demangle_callback /binutils-gdb/libiberty/./cp-demangle.c:6289:7 >     #7 0xab7d4f in d_demangle /binutils-gdb/libiberty/./cp-demangle.c:6343:12 >     #8 0xab7b66 in cplus_demangle_v3 /binutils-gdb/libiberty/./cp-demangle.c:6500:10 >     #9 0xa75571 in cplus_demangle /binutils-gdb/libiberty/./cplus-dem.c:881:13 >     #10 0xa904ba in demangle_template_value_parm /binutils-gdb/libiberty/./cplus-dem.c:2146:12 >     #11 0xa8a190 in demangle_template /binutils-gdb/libiberty/./cplus-dem.c:2331:14 >     #12 0xa849c8 in demangle_signature /binutils-gdb/libiberty/./cplus-dem.c:1709:18 >     #13 0xa9715e in iterate_demangle_function /binutils-gdb/libiberty/./cplus-dem.c:2761:14 >     #14 0xa81759 in demangle_prefix /binutils-gdb/libiberty/./cplus-dem.c:2989:14 >     #15 0xa7a694 in internal_cplus_demangle /binutils-gdb/libiberty/./cplus-dem.c:1254:14 >     #16 0xa75cbb in cplus_demangle /binutils-gdb/libiberty/./cplus-dem.c:919:9 >     #17 0x51518c in demangle_it /binutils-gdb/binutils/cxxfilt.c:66:12 >     #18 0x5149e7 in main /binutils-gdb/binutils/cxxfilt.c:288:4 >     #19 0x7f702142782f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f) >     #20 0x41ab28 in _start (/binutils-gdb/build/bin/c++filt+0x41ab28) >  > 0x602000000059 is located 0 bytes to the right of 9-byte region [0x602000000050,0x602000000059) > allocated by thread T0 here: >     #0 0x4daa50 in malloc /home/tangyun/Documents/Git/llvm-6.0.1/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:88 >     #1 0xb0740f in xmalloc /binutils-gdb/libiberty/./xmalloc.c:147:12 >     #2 0xa903af in demangle_template_value_parm /binutils-gdb/libiberty/./cplus-dem.c:2138:18 >     #3 0xa8a190 in demangle_template /binutils-gdb/libiberty/./cplus-dem.c:2331:14 >     #4 0xa849c8 in demangle_signature /binutils-gdb/libiberty/./cplus-dem.c:1709:18 >     #5 0xa9715e in iterate_demangle_function /binutils-gdb/libiberty/./cplus-dem.c:2761:14 >     #6 0xa81759 in demangle_prefix /binutils-gdb/libiberty/./cplus-dem.c:2989:14 >     #7 0xa7a694 in internal_cplus_demangle /binutils-gdb/libiberty/./cplus-dem.c:1254:14 >     #8 0xa75cbb in cplus_demangle /binutils-gdb/libiberty/./cplus-dem.c:919:9 >     #9 0x51518c in demangle_it /binutils-gdb/binutils/cxxfilt.c:66:12 >     #10 0x5149e7 in main /binutils-gdb/binutils/cxxfilt.c:288:4 >     #11 0x7f702142782f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f) >  > SUMMARY: AddressSanitizer: heap-buffer-overflow /binutils-gdb/libiberty/./cp-demangle.c:3356:12 in d_expression_1 > Shadow bytes around the buggy address: >   0x0c047fff7fb0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 >   0x0c047fff7fc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 >   0x0c047fff7fd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 >   0x0c047fff7fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 >   0x0c047fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 > =>0x0c047fff8000: fa fa 02 fa fa fa 06 fa fa fa 00[01]fa fa fa fa >   0x0c047fff8010: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa >   0x0c047fff8020: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa >   0x0c047fff8030: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa >   0x0c047fff8040: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa >   0x0c047fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa > Shadow byte legend (one shadow byte represents 8 application bytes): >   Addressable:           00 >   Partially addressable: 01 02 03 04 05 06 07 >   Heap left redzone:       fa >   Freed heap region:       fd >   Stack left redzone:      f1 >   Stack mid redzone:       f2 >   Stack right redzone:     f3 >   Stack after return:      f5 >   Stack use after scope:   f8 >   Global redzone:          f9 >   Global init order:       f6 >   Poisoned by user:        f7 >   Container overflow:      fc >   Array cookie:            ac >   Intra object redzone:    bb >   ASan internal:           fe >   Left alloca redzone:     ca >   Right alloca redzone:    cb > ==83311==ABORTING ```  [Comment 1](show_bug.cgi?id=24043#c1)  wcventure    2018-12-28 09:22:19 UTC  ``` Created [attachment 11500](attachment.cgi?id=11500 "POC2") [[details]](attachment.cgi?id=11500&action=edit "POC2") POC2 ```  [Comment 2](show_bug.cgi?id=24043#c2)  wcventure    2018-12-28 09:22:35 UTC  ``` Created [attachment 11501](attachment.cgi?id=11501 "POC3") [[details]](attachment.cgi?id=11501&action=edit "POC3") POC3 ```  [Comment 3](show_bug.cgi?id=24043#c3)  wcventure    2018-12-28 10:24:00 UTC  ``` That 's because "d_advance (di, 2);" in function d_expression_1, it change di->n = di + 2; leading to buffer-over-flow problem.   > 3353      d_advance (di, 2); > 3354      if (peek == 't') > 3355	type = cplus_demangle_type (di); > 3356      if (!d_peek_next_char (di)) > 3357	return NULL; ```  [Comment 4](show_bug.cgi?id=24043#c4)  Nick Clifton    2019-01-04 16:46:41 UTC  ``` Hi wcventure,    Thanks for reporting this problem.  Unfortunately the cp-demangle.c source   file, although used by the binutils, is actually maintained by the gcc   project.  Therefore please could you report this bug here:  <https://gcc.gnu.org/bugzilla/enter_bug.cgi?product=gcc&Bugzilla_remember=on&Bugzilla_restrictlogin=on&GoAheadAndLogIn=Log%20in>  Cheers   Nick ```  [Comment 5](show_bug.cgi?id=24043#c5)  wcventure    2019-01-04 16:56:53 UTC  ``` This issue is moved to  <https://gcc.gnu.org/bugzilla/show_bug.cgi?id=88629> ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=24043)
* - [XML](show_bug.cgi?ctype=xml&id=24043)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=24043)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=24043&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=24043&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from gcc.gnu.org_9d4aecb1_20250124_170719.html ===


GCC Bugzilla – Bug 88629
Regression lead to Heap-buffer-overflow problem in function d\_expression\_1 in cp-demangle.c, as demonstrated by c++filt
Last modified: 2021-01-12 11:23:41 UTC

* [Home](./)
* | [New](enter_bug.cgi?product=gcc)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=88629&GoAheadAndLogIn=1)

  Remember

  [x]
* |
  [Forgot Password](show_bug.cgi?id=88629&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 88629**](show_bug.cgi?id=88629)
(CVE-2018-20712)
- Regression lead to Heap-buffer-overflow problem in function d\_expression\_1 in cp-demangle.c, as demonstrated by c++filt

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Regression lead to Heap-buffer-overflow problem in function d\_expression\_1 in...

| | [Status](page.cgi?id=fields.html#bug_status): | UNCONFIRMED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2018-20712 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | gcc | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=gcc "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | demangler ([show other bugs](buglist.cgi?component=demangler&product=gcc&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unknown | |  | | | [Importance](page.cgi?id=fields.html#importance): | P3 normal | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Not yet assigned to anyone | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2018-12-28 09:27 UTC by Cheng Wen | | --- | --- | | Modified: | 2021-01-12 11:23 UTC ([History](show_activity.cgi?id=88629)) | | CC List: | 4 users (show)  nickc nickc prajwapa trupti\_pardeshi | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Host:](page.cgi?id=fields.html#cf_gcchost "The machine that you are building for. That's the value you passed to ./configure --host.") |  | | [Target:](page.cgi?id=fields.html#cf_gcctarget "The machine that GCC will produce code for. That's the value you passed to ./configure --target.") |  | | [Build:](page.cgi?id=fields.html#cf_gccbuild "The machine you are building on. That's the value you passed to ./configure --build.") |  | | [Known to work:](page.cgi?id=fields.html#cf_known_to_work "Known versions for which the issue is not reproducible.") |  | | [Known to fail:](page.cgi?id=fields.html#cf_known_to_fail "Known versions for which the issue is reproducible.") |  | | [Last reconfirmed:](page.cgi?id=fields.html#cf_reconfirmed_on "Last time the issue was confirmed as still being present.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**POC1**](attachment.cgi?id=45294 "View the content of the attachment") (173 bytes, application/octet-stream)  [2018-12-28 09:27 UTC](#attach_45294 "Go to the comment associated with the attachment"), Cheng Wen | [Details](attachment.cgi?id=45294&action=edit) | | [**POC2**](attachment.cgi?id=45295 "View the content of the attachment") (178 bytes, application/octet-stream)  [2018-12-28 09:27 UTC](#attach_45295 "Go to the comment associated with the attachment"), Cheng Wen | [Details](attachment.cgi?id=45295&action=edit) | | [**POC3**](attachment.cgi?id=45296 "View the content of the attachment") (142 bytes, application/octet-stream)  [2018-12-28 09:27 UTC](#attach_45296 "Go to the comment associated with the attachment"), Cheng Wen | [Details](attachment.cgi?id=45296&action=edit) | | [View All](attachment.cgi?bugid=88629&action=viewall)  [Add an attachment](attachment.cgi?bugid=88629&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=88629&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=88629#c0)  Cheng Wen    2018-12-28 09:27:10 UTC  ``` Created [attachment 45294](attachment.cgi?id=45294 "POC1") [[details]](attachment.cgi?id=45294&action=edit "POC1") POC1  Hi, there.  A Heap-buffer-overflow problem was discovered in function function d_expression_1 in cp-demangle.c of binutils latest code base, too. A crafted ELF input can cause segment faults and I have confirmed them with address sanitizer too.  Please use the "./c++filt -t < $POC" to reproduce the bug.  Note that this error only occurs in the last code base, maybe this is a regression error. I will show you the commit ID.  > $ git log > commit ebb8004a18a3808d7197762faf3c5aaeae82371f > Author: GDB Administrator <gdbadmin@sourceware.org> > Date:   Wed Dec 19 00:00:21 2018 +0000 >  >     Automatic date update in version.in  The ASAN dumps the stack trace as follows:  > ================================================================= > ==83311==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000000059 at pc 0x000000ac9a4b bp 0x7ffeedce2490 sp 0x7ffeedce2488 > READ of size 1 at 0x602000000059 thread T0 >     #0 0xac9a4a in d_expression_1 /binutils-gdb/libiberty/./cp-demangle.c:3356:12 >     #1 0xab4724 in d_expression /binutils-gdb/libiberty/./cp-demangle.c:3531:9 >     #2 0xaacdbe in cplus_demangle_type /binutils-gdb/libiberty/./cp-demangle.c:2615:9 >     #3 0xaaab09 in cplus_demangle_type /binutils-gdb/libiberty/./cp-demangle.c:2411:10 >     #4 0xaac400 in cplus_demangle_type /binutils-gdb/libiberty/./cp-demangle.c:2568:26 >     #5 0xaac400 in cplus_demangle_type /binutils-gdb/libiberty/./cp-demangle.c:2568:26 >     #6 0xab8dc1 in d_demangle_callback /binutils-gdb/libiberty/./cp-demangle.c:6289:7 >     #7 0xab7d4f in d_demangle /binutils-gdb/libiberty/./cp-demangle.c:6343:12 >     #8 0xab7b66 in cplus_demangle_v3 /binutils-gdb/libiberty/./cp-demangle.c:6500:10 >     #9 0xa75571 in cplus_demangle /binutils-gdb/libiberty/./cplus-dem.c:881:13 >     #10 0xa904ba in demangle_template_value_parm /binutils-gdb/libiberty/./cplus-dem.c:2146:12 >     #11 0xa8a190 in demangle_template /binutils-gdb/libiberty/./cplus-dem.c:2331:14 >     #12 0xa849c8 in demangle_signature /binutils-gdb/libiberty/./cplus-dem.c:1709:18 >     #13 0xa9715e in iterate_demangle_function /binutils-gdb/libiberty/./cplus-dem.c:2761:14 >     #14 0xa81759 in demangle_prefix /binutils-gdb/libiberty/./cplus-dem.c:2989:14 >     #15 0xa7a694 in internal_cplus_demangle /binutils-gdb/libiberty/./cplus-dem.c:1254:14 >     #16 0xa75cbb in cplus_demangle /binutils-gdb/libiberty/./cplus-dem.c:919:9 >     #17 0x51518c in demangle_it /binutils-gdb/binutils/cxxfilt.c:66:12 >     #18 0x5149e7 in main /binutils-gdb/binutils/cxxfilt.c:288:4 >     #19 0x7f702142782f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f) >     #20 0x41ab28 in _start (/binutils-gdb/build/bin/c++filt+0x41ab28) >  > 0x602000000059 is located 0 bytes to the right of 9-byte region [0x602000000050,0x602000000059) > allocated by thread T0 here: >     #0 0x4daa50 in malloc /home/tangyun/Documents/Git/llvm-6.0.1/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:88 >     #1 0xb0740f in xmalloc /binutils-gdb/libiberty/./xmalloc.c:147:12 >     #2 0xa903af in demangle_template_value_parm /binutils-gdb/libiberty/./cplus-dem.c:2138:18 >     #3 0xa8a190 in demangle_template /binutils-gdb/libiberty/./cplus-dem.c:2331:14 >     #4 0xa849c8 in demangle_signature /binutils-gdb/libiberty/./cplus-dem.c:1709:18 >     #5 0xa9715e in iterate_demangle_function /binutils-gdb/libiberty/./cplus-dem.c:2761:14 >     #6 0xa81759 in demangle_prefix /binutils-gdb/libiberty/./cplus-dem.c:2989:14 >     #7 0xa7a694 in internal_cplus_demangle /binutils-gdb/libiberty/./cplus-dem.c:1254:14 >     #8 0xa75cbb in cplus_demangle /binutils-gdb/libiberty/./cplus-dem.c:919:9 >     #9 0x51518c in demangle_it /binutils-gdb/binutils/cxxfilt.c:66:12 >     #10 0x5149e7 in main /binutils-gdb/binutils/cxxfilt.c:288:4 >     #11 0x7f702142782f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2082f) >  > SUMMARY: AddressSanitizer: heap-buffer-overflow /binutils-gdb/libiberty/./cp-demangle.c:3356:12 in d_expression_1 > Shadow bytes around the buggy address: >   0x0c047fff7fb0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 >   0x0c047fff7fc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 >   0x0c047fff7fd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 >   0x0c047fff7fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 >   0x0c047fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 > =>0x0c047fff8000: fa fa 02 fa fa fa 06 fa fa fa 00[01]fa fa fa fa >   0x0c047fff8010: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa >   0x0c047fff8020: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa >   0x0c047fff8030: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa >   0x0c047fff8040: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa >   0x0c047fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa > Shadow byte legend (one shadow byte represents 8 application bytes): >   Addressable:           00 >   Partially addressable: 01 02 03 04 05 06 07 >   Heap left redzone:       fa >   Freed heap region:       fd >   Stack left redzone:      f1 >   Stack mid redzone:       f2 >   Stack right redzone:     f3 >   Stack after return:      f5 >   Stack use after scope:   f8 >   Global redzone:          f9 >   Global init order:       f6 >   Poisoned by user:        f7 >   Container overflow:      fc >   Array cookie:            ac >   Intra object redzone:    bb >   ASan internal:           fe >   Left alloca redzone:     ca >   Right alloca redzone:    cb > ==83311==ABORTING ```  [Comment 1](show_bug.cgi?id=88629#c1)  Cheng Wen    2018-12-28 09:27:34 UTC  ``` Created [attachment 45295](attachment.cgi?id=45295 "POC2") [[details]](attachment.cgi?id=45295&action=edit "POC2") POC2 ```  [Comment 2](show_bug.cgi?id=88629#c2)  Cheng Wen    2018-12-28 09:27:49 UTC  ``` Created [attachment 45296](attachment.cgi?id=45296 "POC3") [[details]](attachment.cgi?id=45296&action=edit "POC3") POC3 ```  [Comment 3](show_bug.cgi?id=88629#c3)  Cheng Wen    2018-12-28 10:23:29 UTC  ``` That 's because "d_advance (di, 2);" in function d_expression_1, it change di->n = di + 2; leading to buffer-over-flow problem.   > 3353      d_advance (di, 2); > 3354      if (peek == 't') > 3355	type = cplus_demangle_type (di); > 3356      if (!d_peek_next_char (di)) > 3357	return NULL; ```  [Comment 4](show_bug.cgi?id=88629#c4)  Cheng Wen    2019-01-11 06:04:12 UTC  ``` Hi, does anyone here to look at this bug? ```  [Comment 5](show_bug.cgi?id=88629#c5)  Cheng Wen    2019-02-01 07:21:12 UTC  ``` This bug got assigned CVE-2018-20712 ```  [Comment 6](show_bug.cgi?id=88629#c6)  Christian Biesinger    2019-12-04 23:11:18 UTC  ``` I can't reproduce this on any of the three testcases with today's binutils built with ASAN ```  [Comment 7](show_bug.cgi?id=88629#c7)  Trupti Pardeshi    2020-05-07 12:15:36 UTC  ``` Hi,  May I know, if this bug is going to be fixed in binutils and in which version?   Any heads up will be appreciated.  Best Regards, ```  [Comment 8](show_bug.cgi?id=88629#c8)  Cheng Wen    2020-05-07 12:49:17 UTC  ``` (In reply to Trupti Pardeshi from [comment #7](show_bug.cgi?id=88629#c7))  > commit ebb8004a18a3808d7197762faf3c5aaeae82371f > Author: GDB Administrator <gdbadmin@sourceware.org> > Date:   Wed Dec 19 00:00:21 2018 +0000 >  >     Automatic date update in version.in ```  [Comment 9](show_bug.cgi?id=88629#c9)  Trupti Pardeshi    2020-06-12 05:14:02 UTC  ``` Hi,  Didn't understand reply given [comment#8](show_bug.cgi?id=88629#c8).  Please, may I know, if this bug is going to be fixed in binutils and in which version?   Or this will be closed as Not reproduced as per [comment#6](show_bug.cgi?id=88629#c6).  Any heads up will be appreciated.  Best Regards, ```  [Comment 10](show_bug.cgi?id=88629#c10)  Cheng Wen    2020-06-14 11:41:25 UTC  ``` (In reply to Trupti Pardeshi from [comment #9](show_bug.cgi?id=88629#c9))  This bug can be reproduced in the commit version ebb8004a18a3808d7197762faf3c5aaeae82371f.  But now is fixed. ```  [Comment 11](show_bug.cgi?id=88629#c11)  Trupti Pardeshi    2020-06-15 07:54:17 UTC  ``` (In reply to Cheng Wen from [comment #10](show_bug.cgi?id=88629#c10)) > (In reply to Trupti Pardeshi from [comment #9](show_bug.cgi?id=88629#c9)) >  > This bug can be reproduced in the commit version > ebb8004a18a3808d7197762faf3c5aaeae82371f. >  > But now is fixed.  Thanks for reply Cheng. But could you please help me to know, the version of binutils and version of gcc having the fix of this issue?  Knowing fixed-in version (of binutils and gcc) will be very helpful.  Looking forward for reply.  Many Thanks, Trupti ```  [Comment 12](show_bug.cgi?id=88629#c12)  prajwapa    2021-01-12 07:44:23 UTC  ``` Could someone please let me know, in which binutils version is this fixed?(In reply to Cheng Wen from [comment #10](show_bug.cgi?id=88629#c10)) > (In reply to Trupti Pardeshi from [comment #9](show_bug.cgi?id=88629#c9)) >  > This bug can be reproduced in the commit version > ebb8004a18a3808d7197762faf3c5aaeae82371f. >  > But now is fixed.  Could you please let me know, in which binutils version is this fixed?  Thanks. ```  [Comment 13](show_bug.cgi?id=88629#c13)  Nick Clifton    2021-01-12 11:23:41 UTC  ``` (In reply to prajwapa from [comment #12](show_bug.cgi?id=88629#c12))  > Could you please let me know, in which binutils version is this fixed?  Not really.  I can confirm that the test cases do not fail when tested with binutils 2.35 (with sanitization enabled) and with any binutils all the way back to 2.30 if sanitization is not enabled.  Given that the bug was reported in 2018-12 and assuming that it was fixed at some point in the 6 months after that, then the nearest binutils release that would have included the fix is 2.33.  I hope that this helps.  Cheers   Nick ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=88629)
* - [XML](show_bug.cgi?ctype=xml&id=88629)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=88629)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?product=gcc)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=88629&GoAheadAndLogIn=1)

    Remember

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=88629&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from support.f5.com_bb3bc47e_20250124_170723.html ===
Loading×Sorry to interruptCSS ErrorRefresh
