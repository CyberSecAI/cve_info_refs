=== Content from forums.rancher.com_c9178974_20250124_162346.html ===


[Rancher Labs](/)

# [Announcements](/c/announcements/12)

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [About the Announcements category](https://forums.rancher.com/t/about-the-announcements-category/156) |  | 0 | 4242 | July 27, 2015 |
| [Kubernetes v1.29.12, v1.30.8, and v1.31.4](https://forums.rancher.com/t/kubernetes-v1-29-12-v1-30-8-and-v1-31-4/45007) |  | 1 | 35 | January 22, 2025 |
| [Rancher Release v2.10.1](https://forums.rancher.com/t/rancher-release-v2-10-1/44762) |  | 1 | 222 | December 19, 2024 |
| [Rancher Release v2.10.0](https://forums.rancher.com/t/rancher-release-v2-10-0/44525) |  | 3 | 443 | November 19, 2024 |
| [Kubernetes v1.28.15, v1.29.10, and v1.30.6](https://forums.rancher.com/t/kubernetes-v1-28-15-v1-29-10-and-v1-30-6/44496) |  | 1 | 111 | November 12, 2024 |
| [Rancher Release v2.9.3](https://forums.rancher.com/t/rancher-release-v2-9-3/44373) |  | 1 | 617 | October 25, 2024 |
| [Kubernetes v1.28.14, v1.29.9 and v1.30.5](https://forums.rancher.com/t/kubernetes-v1-28-14-v1-29-9-and-v1-30-5/44346) |  | 0 | 96 | October 21, 2024 |
| [Rancher Release v2.9.2](https://forums.rancher.com/t/rancher-release-v2-9-2/44104) |  | 1 | 732 | September 20, 2024 |
| [Rancher Release v2.9.1](https://forums.rancher.com/t/rancher-release-v2-9-1/43935) |  | 1 | 662 | August 26, 2024 |
| [Kubernetes v1.27.16, v1.28.12, v1.29.7 and v1.30.3](https://forums.rancher.com/t/kubernetes-v1-27-16-v1-28-12-v1-29-7-and-v1-30-3/43783) |  | 0 | 212 | August 5, 2024 |
| [Rancher Release v2.9.0](https://forums.rancher.com/t/rancher-release-v2-9-0/43755) |  | 1 | 1521 | July 31, 2024 |
| [Upcoming Changes to the Forums](https://forums.rancher.com/t/upcoming-changes-to-the-forums/43593) |  | 0 | 116 | July 11, 2024 |
| [The Rancher Roundup, Issue #19](https://forums.rancher.com/t/the-rancher-roundup-issue-19/43538) |  | 1 | 211 | July 8, 2024 |
| [Rancher Release v2.8.5](https://forums.rancher.com/t/rancher-release-v2-8-5/43420) |  | 1 | 1976 | June 18, 2024 |
| [Kubernetes v1.27.14 and v1.28.10](https://forums.rancher.com/t/kubernetes-v1-27-14-and-v1-28-10/43366) |  | 0 | 369 | June 11, 2024 |
| [Rancher Release v2.8.4](https://forums.rancher.com/t/rancher-release-v2-8-4/43231) |  | 1 | 917 | May 22, 2024 |
| [Kubernetes v1.27.13, v1.28.9](https://forums.rancher.com/t/kubernetes-v1-27-13-v1-28-9/43141) |  | 0 | 438 | May 13, 2024 |
| [Kubernetes v1.26.15, v1.27.12, v1.28.8](https://forums.rancher.com/t/kubernetes-v1-26-15-v1-27-12-v1-28-8/42926) |  | 0 | 535 | April 10, 2024 |
| [Rancher release v2.8.3](https://forums.rancher.com/t/rancher-release-v2-8-3/42856) |  | 1 | 2175 | March 28, 2024 |
| [Kubernetes v1.26.14, v1.27.11](https://forums.rancher.com/t/kubernetes-v1-26-14-v1-27-11/42691) |  | 0 | 404 | March 7, 2024 |
| [Kubernetes v1.26.13, v1.27.10](https://forums.rancher.com/t/kubernetes-v1-26-13-v1-27-10/42560) |  | 0 | 534 | February 14, 2024 |
| [Rancher Release v2.8.2](https://forums.rancher.com/t/rancher-release-v2-8-2/42526) |  | 1 | 2270 | February 8, 2024 |
| [Rancher Release v2.7.10](https://forums.rancher.com/t/rancher-release-v2-7-10/42525) |  | 1 | 1212 | February 8, 2024 |
| [Rancher Release v2.6.14](https://forums.rancher.com/t/rancher-release-v2-6-14/42524) |  | 1 | 950 | February 8, 2024 |
| [Rancher Release v2.8.1](https://forums.rancher.com/t/rancher-release-v2-8-1/42468) |  | 1 | 2210 | January 31, 2024 |
| [Kubernetes v1.25.16, v1.26.11, v1.27.8](https://forums.rancher.com/t/kubernetes-v1-25-16-v1-26-11-v1-27-8/42192) |  | 1 | 725 | December 19, 2023 |
| [Rancher Release v2.8.0](https://forums.rancher.com/t/rancher-release-v2-8-0/42098) |  | 1 | 3360 | December 6, 2023 |
| [Kubernetes v1.25.14 | v1.26.9 (RKE1), 1.25.15 | v1.26.10 (RKE2/K3s)](https://forums.rancher.com/t/kubernetes-v1-25-14-v1-26-9-rke1-1-25-15-v1-26-10-rke2-k3s/41966) |  | 1 | 577 | November 17, 2023 |
| [Rancher Release v2.7.9](https://forums.rancher.com/t/rancher-release-v2-7-9/41872) |  | 1 | 2527 | November 2, 2023 |
| [Kubernetes v1.24.17, v1.25.13, v1.26.8](https://forums.rancher.com/t/kubernetes-v1-24-17-v1-25-13-v1-26-8/41485) |  | 1 | 742 | September 11, 2023 |

**[next page →](/c/announcements/12?page=1)**

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled



=== Content from rancher.com_a4f9b0ba_20250124_162355.html ===


[![The Logo of Rancher: an Open Source Kubernetes Multi Cluster Management Platform](https://www.rancher.com/assets/img/logos/rancher-suse-logo-horizontal-color.svg)](https://www.rancher.com)

* Why Rancher?
  + [Why Rancher?](https://www.rancher.com/why-rancher)
  + [Use cases​](https://www.rancher.com/use-cases)
  + [Our Difference​](https://www.rancher.com/why-rancher/rancher-difference)
* Our Platform
  + [Overview of Rancher Prime](https://www.rancher.com/products/rancher-platform)
  + [Cloud-Native Infrastructure](https://www.rancher.com/categories/cloud-native-infrastructure)
  + [Security & Performance](https://www.rancher.com/categories/security-observability)
  + [Application Development](https://www.rancher.com/categories/app-deployment%20)
  + [Kubernetes Distributions](https://www.rancher.com/categories/distributions)
* [Support](/support)
  + [Rancher Support](https://www.rancher.com/support)
    [Support Request](https://scc.suse.com/)
    [Documentation](https://rancher.com/docs/)
* Learn
  + [Rancher Academy](https://www.rancher.academy)
  + [Get Certified](https://www.suse.com/training/exam/?product=rancher)
  + [Documentation](https://rancher.com/docs/)
* [Community](https://www.rancher.com/community)
  + [Slack](https://slack.rancher.io/)
  + [Blogs](https://www.suse.com/c/rancherblog/)
  + [Join the Community](/community)
  + [GitHub](https://github.com/rancher/rancher)
  + [Events & Webinars](https://www.rancher.com/events)
  + [Community Projects](https://www.rancher.com/projects)
* [Government](https://www.rancher.com/government)
* [Pricing](https://www.rancher.com/pricing)
* [Get started](https://www.rancher.com/quick-start)

* [Government](https://www.rancher.com/government)
* [Pricing](https://www.rancher.com/pricing)

[![Rancher Logo](https://www.rancher.com/assets/img/logos/rancher-suse-logo-horizontal-color.svg)](https://www.rancher.com)

* [Why Rancher?](https://www.rancher.com/why-rancher)

  + [![Why Rancher](https://www.rancher.com/assets/img/icons/why-rancher-nav/nav-icon-1.svg)
    Why Rancher?
    How Rancher makes container adoption simple.](https://www.rancher.com/why-rancher)
    [![How We strengthen Kubernetes](https://www.rancher.com/assets/img/icons/why-rancher-nav/nav-icon-3.svg)
    Use cases​
    How we are different than our competitors.](https://www.rancher.com/use-cases)
    [![Our Difference​ ](https://www.rancher.com/assets/img/icons/why-rancher-nav/nav-icon-4.svg)
    Our Difference​
    Learn about our support offerings for Rancher.](https://www.rancher.com/why-rancher/rancher-difference)
* [Our Platform](https://www.rancher.com/products)

  - [![Overview of Rancher Prime](https://www.rancher.com/assets/img/icons/rancher-prime.svg)Overview of Rancher Prime](https://www.rancher.com/products/rancher-platform)
  - [![Rancher capabilites logo](https://www.rancher.com/assets/img/icons/why-rancher-nav/infra.svg)
    Cloud-Native Infrastructure
    Manage your entire cloud-native stack with Rancher Prime, covering OS, storage, VMs, containers, and more — on one platform.](https://www.rancher.com/categories/cloud-native-infrastructure)
    [![Rancher capabilites logo](https://www.rancher.com/assets/img/icons/why-rancher-nav/security.svg)
    Security & Performance
    Secure your Kubernetes with Rancher Prime with zero-trust full lifecycle container management, advanced policy management and insights.](https://www.rancher.com/categories/security-observability)
    [![Rancher capabilites logo](https://www.rancher.com/assets/img/icons/why-rancher-nav/application.svg)
    Application Development
    Improve developer productivity with Rancher Prime. Optimize workflows for better reliability across container-based applications.](https://www.rancher.com/categories/app-deployment)
    [![Rancher capabilites logo](https://www.rancher.com/assets/img/icons/why-rancher-nav/kubernetes.svg)
    Kubernetes Distributions
    Establish your Kubernetes environment on Rancher’s certified and secure distributions, ideal for sensitive and edge workloads.](https://www.rancher.com/categories/distributions)
* [Support](/support)

  - [![Rancher Support icon](https://www.rancher.com/assets/img/icons/why-rancher-nav/support.svg)
    Rancher Support
    Learn more about Rancher Prime support and access free support tools.](https://www.rancher.com/support)
    [![Support Request icon](https://www.rancher.com/assets/img/icons/why-rancher-nav/request.svg)
    Support Request
    Submit a support case in SUSE Customer Center.](https://scc.suse.com/)
    [![rke](https://www.rancher.com/assets/img/icons/why-rancher-nav/nav-icon-6.svg)
    Documentation
    Technical documentation and quick start guides.](https://rancher.com/docs/)
* [Learn](https://www.rancher.com/learn-the-basics)

  - [![Slack](https://www.rancher.com/assets/img/rancher-academy-logo.png)](https://www.rancher.academy)
    [![Slack](https://www.rancher.com/assets/img/icons/why-rancher-nav/nav-icon-9.svg)](https://www.suse.com/training/exam/?product=rancher)
    [![Slack](https://www.rancher.com/assets/img/icons/why-rancher-nav/nav-icon-6.svg)](https://rancher.com/docs/)
* [Community](https://www.rancher.com/community)

  - [![Slack](https://www.rancher.com/assets/img/icons/slack.svg)](https://slack.rancher.io/)
    [![Blogs](https://www.rancher.com/assets/img/icons/why-rancher-nav/nav-icon-8.svg)](https://www.suse.com/c/rancherblog)
    [![GitHub](https://www.rancher.com/assets/img/icons/github.svg)](https://github.com/rancher/rancher)
    [![Events & Webinars](https://www.rancher.com/assets/img/icons/icon-calendar.svg)](https://www.rancher.com/events)
  - ![Events & Webinars](https://www.rancher.com/assets/img/icons/communities.svg)
* [Get started](https://www.rancher.com/quick-start)

[< Back to Blog](/c/rancherblog/)

# Explaining security vulnerabilities addressed in Rancher v2.1.6 and v2.0.11

January 29, 2019
|
By:
Rancher Admin

Share

Today we announced releases v2.1.6 and v2.0.11 to address two security vulnerabilities recently discovered in Rancher. The first vulnerability allows users in the Default project of a cluster to escalate privileges to that of a cluster admin through a service account. The second vulnerability allows members to have continued access to create, update, read, and delete namespaces in a project after they have been removed from it. You can view the official CVEs here [CVE-2018-20321](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20321) and here [CVE-2019-6287](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-6287). This blog will explain each of these issues in more detail, their impact to users, and what can and should be done.

## CVE-2018-20321 – Privilege escalation through service account

This vulnerability affects all versions from v2.0.0 – v2.1.5. It allows any project member with access to the default namespace to use a service account created by the Rancher control plane. This service account can be used to execute administrator level API calls against the Kubernetes cluster.

The name of the service account is “netes-default”. It is created in the “default” namespace and given the “cluster-admin” clusterRole. This grants full administrator privileges to the cluster. To understand this vulnerability, you must understand that once a service account is created in a namespace, anyone with member level privileges in that namespace is allowed to use that service account. This is known and expected service account behavior (see [the Kubernetes documentation](https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/) for more details). However, the vulnerability arises from the fact that Rancher placed the service account in the default namespace and that namespace into the Default project. This namespace and project are expected to be used by non-admin users to create and manage workloads. The service account should not be exposed in a normal member-level namespace or project. It should be created in a namespace and project that only administrators have access to.

While we highly recommend that you upgrade to address this problem, we’ve also written [step-by-step mitigation instructions](https://github.com/rancher/rancher/issues/17725#issuecomment-458730471) you can take to quarantine the default namespace if you cannot immediately upgrade. Additionally, because the fix involves a data migration (deleting a service account and creating it elsewhere), rolling Rancher back from the patched version to a version prior to the patch is more complicated than usual. We have documented these steps [here](https://rancher.com/docs/rancher/v2.x/en/upgrades/rollbacks/).

The new releases address this problem by deleting the service account and recreating it in the cattle-system namespace, which is not placed in the Default project. In versions v2.0.8 and later, it is placed in the “System” project. In versions v2.0.7 and under, the “System” project does not exist and so it is up to the administrator to place the namespace into a project.

Many thanks to Rancher community members Michal Swierczewski and Mateusz Dyminski for discovering and reporting this issue.

## CVE-2019-6287 – Privileges not fully revoked when a member is removed from a project

This vulnerability also affects v2.0.0 – v2.1.5. Unfortunately, there are no practical mitigation steps and you must upgrade to address the issue. It allows members who were removed from a project to continue to be able create, update, read, and delete namespaces in that project. They cannot access resources (ie pods and services) in the namespaces, they can just manipulate the namespace resources themselves.

This vulnerability exists because Rancher is not properly cleaning up all of the roleBindings associated with a user or group when that member is removed from a project. A roleBinding is a Kubernetes construct that defines the access a user or group has to resources. It is used to enforce role-based access control (RBAC). When a user or group is added to a project in Rancher, several roleBindings are created in the Kubernetes cluster. Rancher creates multiple rolebindings in order to enforce proper RBAC controls over our “project” concept, which is not native to Kubernetes. When that user or group is removed from the project, all of these roleBindings should be cleaned up, but this bug is preventing the cleanup of roleBindings that control access to the namespaces in the project. Under the covers, it is caused by two logic flaws in how we determine what roleBindings should be deleted.

For more information on Kubernetes roles and roleBindings and RBAC in general, see the Kubernetes documentation here: <https://kubernetes.io/docs/reference/access-authn-authz/rbac/>. For more information on how Rancher builds on top of Kubernetes RBAC, see our documentation here: <https://rancher.com/docs/rancher/v2.x/en/admin-settings/rbac/>.

Note that this vulnerability can be exploited through the Rancher UI, API, or through kubectl using the kubeconfig that users can create in the Rancher UI. If the user was only added to a single project in a cluster and was then removed from that project, they would not see the cluster in the UI or API any more and thus would not be able to exploit the issue through those means. However, if they previously created and saved a kubeconfig for the cluster from the UI, they would still be able to exploit this vulnerability through kubectl.

The new releases address this vulnerability by removing previously orphaned roleBindings and ensuring that cleanup is properly enforced for all future project member removals.

If you have security related issues to report, please submit them via email to security@rancher.com. We support responsible disclosure and endeavor to resolve all issues in a reasonable time frame.

(Visited 34 times, 1 visits today)

## Related Articles

Apr 18th, 2023

#### [Driving Innovation with Extensible Interoperability in Rancher’s Spring ’23 Release](https://www.suse.com/c/rancher_blog/driving-innovation-with-extensible-interoperability-in-ranchers-spring-23-release/)

[Wendie Cheung](https://www.suse.com/c/author/wendie-cheungsuse-com/ "Posts by Wendie Cheung")

Feb 01st, 2023

#### [How To Simplify Your Kubernetes Adoption Using Rancher](https://www.suse.com/c/rancher_blog/how-to-simplify-your-kubernetes-adoption-using-rancher/)

[Andrés Valero](https://www.suse.com/c/author/avalerosuse-com/ "Posts by Andrés Valero")

Apr 18th, 2023

#### [Utilizing the New Rancher UI Extensions Framework](https://www.suse.com/c/rancher_blog/utilizing-rancher-ui-extensions/)

[nwmacd](https://www.suse.com/c/author/nwmacd/ "Posts by nwmacd")

May 12th, 2023

#### [Container Management – Decoding Kubernetes Management Platforms Part 2](https://www.suse.com/c/rancher_blog/container-management-decoding-kubernetes-management-platforms-part-2/)

[Andrés Valero](https://www.suse.com/c/author/avalerosuse-com/ "Posts by Andrés Valero")

Connect with us

* [![Twitter Link](https://www.rancher.com/assets/img/icons/social-icons/logo-white.png)](https://twitter.com/Rancher_Labs)
* [![Linkedin Link](https://www.rancher.com/assets/img/icons/social-icons/icon-linkedin.svg)](https://www.linkedin.com/company/rancher)
* [![Facebook Link](https://www.rancher.com/assets/img/icons/social-icons/icon-facebook.svg)](https://www.facebook.com/rancherlabs/)
* [![Youtube Link](https://www.rancher.com/assets/img/icons/social-icons/icon-youtube.svg)](https://www.youtube.com/channel/UCh5Xtp82q8wjijP8npkVTBA)
* [![Github Link](https://www.rancher.com/assets/img/icons/social-icons/icon-github.svg)](https://github.com/rancher/rancher)
* [![Slack Link](https://www.rancher.com/assets/img/icons/social-icons/icon-slack.svg)](https://slack.rancher.io/)

* Our Platform
* [Overview](https://www.rancher.com/products/rancher-platform)
* [Cloud-Native Infrastructure](https://www.rancher.com/categories/cloud-native-infrastructure)
* [Security & Performance](https://www.rancher.com/categories/security-observability)
* [Application Development](https://www.rancher.com/categories/app-deployment)
* [Kubernetes Distributions](https://www.rancher.com/categories/distributions)

* Learn
* [Rancher Academy](https://www.rancher.academy)
* [Get Certified](https://www.suse.com/training/exam/?product=rancher)

* Support
* [Rancher Support](https://www.rancher.com/support)
* [Support Request](https://scc.suse.com/)
* [Documentation](https://rancher.com/docs/)

* About
* [About Rancher](https://www.rancher.com/about)
* [About SUSE](https://www.suse.com/company/about/)
* [SUSE Customer Center](https://myaccount.suse.com/)
* [Partners](https://www.suse.com/partners/find-partner/)
* [Events](https://www.rancher.com/events)
* [Contact Us](https://www.rancher.com/contact)

* © Copyright 2024 Rancher. All Rights Reserved.
* [Privacy Policy](https://www.suse.com/company/legal) and [Cookie Policy](https://www.suse.com/company/legal/cookies-policy/)


