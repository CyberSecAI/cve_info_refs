```
{
  "CVE-2018-20179": {
    "description": "rdesktop versions up to and including v1.8.3 contain an Integer Underflow that leads to a Heap-Based Buffer Overflow in the function lspci_process() and results in memory corruption and probably even a remote code execution.",
    "root_cause": "The vulnerability is caused by an integer underflow when calculating the remaining length (`pkglen`) of a packet in the `lspci_process()` function. When a chopped packet is sent to the client, the invariant `s->p <= s->end` is broken. This causes `pkglen` calculation to result in an integer underflow, which further leads to an integer overflow when allocating memory via `xmalloc(pkglen + 1)`. A heap-based buffer overflow occurs when data is copied using a proprietary `STRNCPY` implementation to the undersized allocated buffer.",
    "weaknesses": [
      "Integer Underflow",
      "Heap-Based Buffer Overflow",
      "Out-of-bounds Read"
    ],
    "impact": "Remote code execution on the client machine, memory corruption.",
    "attack_vectors": "A malicious RDP server sends specially crafted packets to the vulnerable RDP client.",
    "attacker_capabilities": "Attacker needs to control a malicious RDP server and needs no user interaction to execute the attack.",
    "details": "The vulnerability exists within the lspci channel of rdesktop. The vulnerability is triggered when processing a packet with an insufficient size. The vulnerability is achieved by breaking the invariant `s->p <= s->end` in the stream, leading to an integer underflow when calculating `pkglen` and integer overflow when allocating memory via `xmalloc(pkglen + 1)`. The data is then copied to a small buffer leading to a heap-based buffer overflow. This vulnerability is present in rdesktop versions up to and including v1.8.3. The fix involves adding bounds checking to protocol handling."
  }
}
```