=== Content from botan.randombit.net_902741fa_20250125_114416.html ===

# Botan

# Release Notes[Â¶](#release-notes "Link to this heading")

## Version 3.6.1, 2024-10-26[Â¶](#version-3-6-1-2024-10-26 "Link to this heading")

* Notice: Botan 3.7.0 will remove support for the currently supported
  experimental Kyber r3 TLS ciphersuites, leaving only the standardized
  ML-KEM suites. (GH #4407 #4403)
* Fix a bug in x86 CPUID detection introduced in 3.6.0 which would cause
  crashes on systems which have BMI1 but not BMI2. (GH #4402 #4401)
* Fix a bug in SLH-DSA signing, which did not default to the FIPS
  required randomized variant. (GH #4398)
* Modify how elliptic curve blinding is performed, reducing the number
  of self-additions that may occur during multiplication. (GH #4408)
* In `speed` command line utility, also iterate keygen several times.
  (GH #4381)

## Version 3.6.0, 2024-10-21[Â¶](#version-3-6-0-2024-10-21 "Link to this heading")

* Fully integrate and further optimize the new ECC library first introduced in
  3.5.0. For common curves, operations are 2 to 3 times faster. This also
  introduces a new API for low level EC operations, such a point multiplication,
  using `EC_Scalar` and `EC_AffinePoint` types.
  (GH #4042 #4113 #4147 #4190 #4191 #4113 #4143 #4171 #4203 #4205 #4207
  #4209 #4210 #4211 #4212 #4213 #4215 #4217 #4218 #4221 #4225 #4226 #4235
  #4237 #4240 #4242 #4256 #4257 #4261 #4264 #4276 #4284 #4300)
* Add support for FIPS 203 ML-KEM, the NIST standardized version of Kyber (GH #3893)
* Add support for FIPS 204 ML-DSA, the NIST standardized version of Dilithium (GH #4270)
* Add support for FIPS 205 SLH-DSA, the NIST standardized version of SPHINCS+ (GH #4291)
* Add support for TPM2 hardware (GH #4337 #4357 #4361)
* Add support for jitterentropy RNG (GH #4325)
* Constant time programming improvements including `CT::Option`
  (GH #4175 #4197 #4198 #4204 #4207 #4254 #4260)
* Improve performance of hex (GH #4275) and base64 (GH #4271)
* In ECDSA blind the constant time inversion of the nonce, as an extra precaution
  against side channel attacks. (GH #4259)
* Add support for AVX2-VAES instructions (GH #4286 #4287)
* Add GFNI-AVX2 acceleration for SM4 (GH #4289)
* Add support for elliptic curve numsp512d1 (GH #4251)
* Apply const-time checking annotations to Dilithium and Kyber (GH #4223),
  X448/Ed448 (GH #4204), FrodoKEM (GH #4198), LMS (GH #4272)
* Refactor internals of Dilithium and Kyber to share common elements (GH #4024)
* Add a test suite for validating the const-time annotations (GH #4182)
* Internal refactorings of public key encryption to improve memory
  safety and side channel resistance. (GH #4238 #4239)
* Cache the DER encoding of the OID format of an elliptic curve (GH #4193)
* Correct inconsistencies with use of `BOTAN_CLEAR_CPUID` where dependent
  instruction sets were not always disabled. (GH #4290)
* Deprecate the x25519/Kyber-512-r3 TLS ciphersuite. (GH #4347)
* Add CI nightly test using Intel SDE to test AVX-512 (GH #4296)
* Fix armv7/aarch64 CPU feature detection on FreeBSD (GH #4315)
* Add support for armv7/aarch64/ppc64 CPU feature detection on OpenBSD,
  using a new API added in OpenBSD 7.6 (GH #4312)
* Fix a bug in the `speed` cli utility which caused it to report incorrect
  values, especially for ciphers/hashes with small input sizes. (GH #4311)
* Fix a bug where CMake and pkg-config files might be installed to the
  wrong path (GH #4236 #4231)
* Fix certificate validation when the trust root is a self-signed MD2 cert.
  (GH #4247 #4248)
* Internal âstrong typesâ improvments (GH #4170)
* Refactor the `speed` cli utility (GH #4364 #4367 #4369)
* Fix a test that was somewhat brittle and would fail if a specific
  certificate was not in the system trust root store. (GH #4280)
* Update some documentation comments (GH #4185)
* In Argon2, avoid instantiating a thread pool when `p == 1` (GH #4195 #4199)
* Disable the thread pool by default on Emscripten target (GH #4195 #4199)
* Add compile time option to disable all use of inline assembly (GH #4273 #4265)

## Version 3.5.0, 2024-07-08[Â¶](#version-3-5-0-2024-07-08 "Link to this heading")

* CVE-2024-34702: Fix a DoS caused by excessive name constraints. (GH #4186)
* CVE-2024-39312: Fix a name constraint processing error, where if
  permitted and excluded rules both applied to a certificate, only the
  permitted rules would be checked.
* Add a new much faster elliptic curve implementation. In this release,
  this implementation is only used for hash2curve. (GH #3979)
* Add support for LMS hash based signatures (GH #3716 #4059)
* Add support for SSLKEYLOGFILE logging (GH #4043)
* Optimize processing in FFI `botan_cipher_update` (GH #3951)
* Add `Public_Key::raw_public_key_bits` (GH #3985)
* Optimize XTS mode (GH #4047)
* Optimize name constraint processing (GH #4047)
* Optimize FrodoKEM-AES (GH #4176 #4174 #4173)
* The build system now distinguishes between LLVM Clang and XCodeâs Clang
  fork. For the latter, use compiler target âxcodeâ. (GH #4010)
* Fix a bug in `scrypt` autotune where, if it was called with a
  nominal maximum memory limit of zero (meant to indicate no limit)
  would only ever return parameters using 1 MB.
* Constant time programming improvements including `CT::value_barrier`
  and `CT::Choice` (GH #4154 #4115 #4096 #4108)
* Refactor and optimize AlternativeName. This includes a new API.
  The old API is retained but deprecated. (GH #4034)
* Kyber internals refactoring (GH #3887)
* Generate Kuznyechik tables at compile time instead of hard coding them.
  (GH #4017)
* Enable using `sysctlbyname` on iOS (GH #4018)
* Previously Curve25519 was used to refer to key exchange over the Montgomery
  curve modulo 2\*\*255-19. This is now called X25519 in all cases. Typedefs and a
  deprecated header are retained for compatibility with older versions. (GH
  #4012)
* Fix several bugs related to encoding and decoding ASN.1 object identifiers
  when the second arc is larger than 40. (GH #4063 #4023)
* Avoid sending IP addresses in the Server Name Indicator TLS extension, if
  an IP address is used to initialize the TLS\_Server\_Info struct. (GH #4059)
* During X.509 certificate verification, first verify the entire sequence
  of signatures, then do other validation. (GH #4045)
* In DTLS fix a bug affecting retransmission of client hellos. (GH #4037)
* Fix a number of bugs related to name constraint processing. (GH #4074)
* Add support for parsing TNAuthList (secure telephony identity credentials
  extension) from RFC 8226. (GH #4116)
* Add One-Step KDF from SP 800-56C (GH #4121)
* Fix a bug in RFC 6979 mode ECDSA. This only caused problems when
  testing with certain curves and does not have any security or interop
  implications. (GH #4040)
* Previously elliptic curve private keys could be of any size, with the
  effective key reduced modulo the group order. Now during decoding the
  private key must be in the specified bound. (GH #4040)
* Elliptic curve groups now verify that the prime and group order are
  related in the manner expected. (GH #4039 #4041)
* Add a script to run the Limbo X.509 path validation test suite.
* Update the BoGo TLS test suite (GH #4078)
* Deprecate various low level BigInt and elliptic curve interfaces (GH #4038 #4056)
* In 3.3.0, support for application specific curves in EC\_Group with
  parameters larger than 521 bits was deprecated. This release expands
  that deprecation to further restrict future use of application
  specific curves (see deprecated.rst for details). Add a new EC\_Group
  constructor which enforces these restrictions. (GH #4038)
* Fix a bug when creating a PKCS10 request or X.509 self signed certificate
  when SubjectAlternativeName was included in the provided extensions. If
  this occurred, any other values (eg opts.dns) would be ignored. (GH #4032)
* Various low level multi precision integer refactorings and improvements.
  (GH #4156 #4149 #4007 #4008 #3989 #3987)
* Increase the maximum supported key length of KMAC to 192 bytes (GH #4109)
* Improve the utilities for checked (overflow safe) addition and multiplication.
  (GH #3999)
* Optimize parsing of IPv4 dotted quad strings (GH #4058)
* A system for marking modules as deprecated was introduced in 3.4.0, but it did
  not mark any modules as deprecated. This has now been applied to various
  modules, which will then be disabled if `--disable-deprecated-features`
  option is used at build time. (GH #4050)
* Fix a bug in `configure.py` that caused `--with-stack-protector` to not
  work. (GH #3996)
* Upgrade CI to use XCode 15.2 on x86-64 and XCode 15.3 on aarch64. (GH #4005)
* Update most CI builds to run on Ubuntu 24.04 (GH #4098)
* Various `clang-tidy` fixes (GH #4070 #4075)
* Fixes for GCC 14 (GH #4046)
* Fix Roughtime to not reference a deprecated Cloudflare server. (GH #4002 #3937)

## Version 3.4.0, 2024-04-08[Â¶](#version-3-4-0-2024-04-08 "Link to this heading")

* Add Ed448 signatures and X448 key exchange (GH #3933)
* X.509 certificate verification now can optionally ignore the
  expiration date of root certificates. (GH #3938)
* Support for âhybridâ EC point encoding is now deprecated. (GH #3981)
* Support for creating EC\_Group objects with parameters larger than
  521 bits is now deprecated (GH #3980)
* Add new build options to disable deprecated features, and to enable
  experimental features. (GH #3910)
* Fix a bug affecting use of SIV and CCM ciphers in the FFI interface.
  (GH #3971)
* Add new FFI interface `botan_cipher_requires_entire_message` (GH #3969)
* Internal refactorings of the mp layer to support a new elliptic
  curve library. (GH #3973 #3977 #3962 #3957 #3964 #3956 #3961 #3950)
* Use a new method for constant time division in Kyber to avoid a possible
  side channel where the compiler inserts use of a variable time division.
  (GH #3959)
* Refactor test RNG usage to improve reproducibility. (GH #3920)
* Add `std::span` interfaces to `BigInt` (GH #3866)
* Refactorings and improvements to low level load/store utility
  functions. (GH #3869)
* Fix the amalgamation build on ARM64 (GH #3931)
* Add Mac ARM based CI build (GH #3931)
* Fix a thread serialization bug that caused sporadic test failures.
  (GH #3922)
* Update GH Actions to v4 (GH #3923)
* Add examples of password based encryption and HTTPS+ASIO client.
  (GH #3935 #3910)

## Version 3.3.0, 2024-02-20[Â¶](#version-3-3-0-2024-02-20 "Link to this heading")

* CVE-2024-34703 Fix a potential denial of service caused by accepting
  arbitrary length primes as potential elliptic curve parameters in
  ASN.1 encodings. With very large inputs the primality verification
  can become computationally expensive. Now any prime field larger
  than 1024 bits is rejected immediately. Reported by Bing Shi. (GH #3913)
* Add FrodoKEM post-quantum KEM (GH #3679 #3807 #3892)
* Add support for Blake2s (GH #3796)
* Add support for RFC 7250 in TLS 1.3 to allow authenticating peers
  using raw public keys (GH #3771)
* Update the BSI TLS policy to match the latest TR, particularly
  enabling support for TLS 1.3 (GH #3809)
* Add AsymmetricKey::generate\_another() to generate a new key of the
  same type and parameters as an existing key (GH #3770 #3786)
* Add Private\_Key::remaining\_operations() that indicates the number of
  remaining signatures for stateful hash-based signatures (GH #3821)
* Add implementation of EC\_PrivateKey::check\_key() (GH #3782 #3804)
* Add hardware acceleration for SHA-512 on ARMv8 (GH #3860 #3864)
* X.509 certificates that contain Authority Information Access (AIA)
  extensions can now be encoded (GH #3784)
* Various functions defined in `mem_ops.h` are now deprecated
  for public use (GH #3759 #3752 #3757)
* The ASIO TLS stream can now be used with C++20 coroutines (GH #3764)
* New public header asio\_compat.h to check compatibility of the ASIO
  TLS stream with the available boost version (1.73.0+) (GH #3765)
* Flatten input buffer sequences in the ASIO TLS stream to avoid
  creating unnecessarily small TLS records (GH #3839)
* Hard-rename the potentially harmful build configuration flag
  âterminate-on-asserts to âunsafe-terminate-on-asserts (GH #3755)
* Use modern SQLite3 APIs with integer width annotations from SQLite3 3.37
  (GH #3788 #3793)
* Generate and install a CMake package config file (botan-config.cmake)
  (GH #3722 #3827 #3830 #3825)
* Add TLS::Channel::is\_handshake\_complete() predicate method (GH #3762)
* Add support for setting thread names on Haiku OS and DragonflyBSD
  (GH #3758 #3785)
* Use /Zc:throwingNew with MSVC (GH #3858)
* Work around a warning in GCC 13 (GH #3852)
* Add a CLI utility for testing RSA side channels using the MARVIN
  toolkit (GH #3749)
* CLI utility âtls\_http\_serverâ is now based on Boost Beast
  (GH #3763 #3791)
* CLI utility âtls\_client\_helloâ can detect and handle TLS 1.3 messages
  (GH #3820)
* Add a detailed migration guide for users of OpenSSL 1.1 (GH #3815)
* Various updates to the documentation and code examples
  (GH #3777 #3805 #3802 #3794 #3815 #3823 #3828 #3842 #3841 #3849 #3745)
* Fixes and improvements to the build experience using `ninja`
  (GH #3751 #3750 #3769 #3798 #3848)
* Fix handling of cofactors when performing scalar blinding in EC (GH #3803)
* Fix potential timing side channels in Kyber (GH #3846 #3874)
* Fix a potential dangling reference resulting in a crash in the OCB
  mode of operation (GH #3814)
* Fix validity checks in the construction of the ASIO TLS stream
  (GH #3766)
* Fix error code handling in ASIO TLS stream (GH #3795 #3801 #3773)
* Fix a TLS 1.3 assertion failure that would trigger if the
  application callback returned an empty certificate chain. (GH #3754)
* Fix a RFC 7919 conformance bug introduced in 3.2.0, where the TLS
  server would fail to reject a client hello that advertised (only)
  FFDHE groups that are not known to us. (GH #3743 #3742 #3729)
* Fix that modifications made in TLS::Callbacks::tls\_modify\_extensions()
  for the TLS 1.3 Certificate message were not being applied. (GH #3792)
* Fix string mapping of the PKCS#11 mechanism RSA signing mechanism that
  use SHA-384 (GH #3868)
* Fix a build issue on NetBSD (GH #3767)
* Fix the configure.py to avoid recursing out of our source tree (GH #3748)
* Fix various clang-tidy warnings (GH #3822)
* Fix CLI tests on windows and enable them in CI (GH #3845)
* Use `BufferStuffer` and `concat` helpers in public key code
  (GH #3756 #3753)
* Add a nightly test to ensure hybrid TLS 1.3 PQ/T compatibility with
  external implementations (GH #3740)
* Internal memory operation helpers are now memory container agnostic
  using C++20 ranges (GH #3715 #3707)
* Public and internal headers are now clearly separated in the build
  directory. That restricts the examples build target to public headers.
  (GH #3880)
* House keeping for better code formatting with clang-format
  (GH #3862 #3865)
* Build documentation in CI and fail on warnings or errors (GH #3838)
* Work around a GitHub Actions CI issue (actions/runner-images#8659)
  (GH #3783 #3833 #3888)

## Version 3.2.0, 2023-10-09[Â¶](#version-3-2-0-2023-10-09 "Link to this heading")

* Add support for (experimental!) post-quantum secure key exchange
  in TLS 1.3 (GH #3609 #3732 #3733 #3739)
* Add support for TLS PSK (GH #3618)
* Add a first class interface for XOFs (GH #3671 #3672 #3701)
* Add KMAC from NIST SP 800-185 (GH #3689)
* Add cSHAKE XOF; currently this is not exposed to library users but
  is only for deriving further cSHAKE derived functions. (GH #3671)
* Add improved APIs for key encapsulation (GH #3611 #3652 #3653)
* As Kyberâs 90s mode is not included in the NIST draft specification,
  and most implementations only support the SHAKE based mechanism,
  the Kyber 90s mode is now deprecated. (GH #3695)
* Previously `KyberMode` enums had elements like `Kyber512` to identify the
  scheme. These have changed to have `_R3` suffixes (like `Kyber512_R3`) to
  clearly indicate these are not the final version but is instead the version
  from round3 of the PQC competition. The old names continue on as (deprecated)
  aliases. (GH #3695)
* Fix bugs in various signature algorithms where if a signature
  operation was used after the key object had been deleted, a use
  after free would occur. (GH #3702)
* The types defined in pubkey.h can now be moved (GH #3655)
* Add the Russian block cipher Kuznyechik (GH #3680 #3724)
* The `TLS::Group_Params` enum is now a class which emulates the
  behavior of the enumeration. (GH #3729)
* Implement serialization for the Certificate Authority TLS extension
  (GH #3687)
* Refactored the internal buffering logic of most hash functions
  (GH #3705 #3693 #3736)
* Add OS support for naming threads; now Botan thread pool threads
  are identified by name. (GH #3628 #3738)
* Updated the TLS documentation to reflect TLS 1.3 support and
  the removal of TLS 1.0 and 1.1. (GH #3708)
* Upon deserialization, the `EC_Group` type now tracks the encoding
  which was used to create it. This is necessary to implement policies
  which prohibit use of explicit curve encodings (which are in any case
  deprecated). (GH #3665)
* If compiling against an old glibc which does not support the `getrandom`
  call, now the raw syscall is used instead. (GH #3688 #3685)
* On MinGW the global thread pool is disabled by default (GH #3726 #2582)
* Various internal functions now use `std::span` instead of raw pointers
  plus length field. NOTE: any implementations of `BlockCipher`, `HashFunction`
  etc that live outside the library will have to be updated. This is not covered
  by the SemVer guarantee; see `doc/sem_ver.rst` (GH #3684 #3681 #3713 #3714
  #3698 #3696)
* Add helper for buffer alignment, and adopt it within the hash function
  implementations. (GH #3693)
* Added support for encoding CRL Distribution Points extension in new
  certificates (GH #3712)
* Internal refactoring of SHA-3 to support further SHA-3 derived functionality
  (GH #3673)
* Add support for testing using TLS-Anvil (GH #3651) and fix a few cases
  where the TLS implementation sent the incorrect alert type in various
  error cases which were discovered using TLS-Anvil (GH #3676)
* Add initial (currently somewhat experimental) support for using the ninja
  build system as an alternative to make. (GH #3677)
* Remove an unused variable in BLAKE2b (GH #3624)
* Fix a number of clang-tidy warnings in the headers (GH #3646)
* Add checks for invalid length AD in Argon2 (GH #3626)
* CI now uses Android NDK 26, and earlier NDKs are not supported
  due to limitations of the C++ library in earlier NDKs (GH #3718)
* Improve support for IBMâs XLC compiler (GH #3730)
* Avoid compilation failures when using `-Werror` mode with GCC 12
  due to spurious warnings in that version. (GH #3711 #3709)

## Version 3.1.1, 2023-07-13[Â¶](#version-3-1-1-2023-07-13 "Link to this heading")

* Fix two tests which were insufficiently serialized. This would
  cause sporadic test failures, particularly on machines with
  many cores. (GH #3625 #3623)

## Version 3.1.0, 2023-07-11[Â¶](#version-3-1-0-2023-07-11 "Link to this heading")

* Add SPHINCS+ post quantum hash based signature scheme (GH #3564 #3549)
* Several small TLS compliance fixes, primarily around rejecting
  invalid behavior from the peer (GH #3520 #3537)
* Adapt TLS 1.3 to use a KEM interface to prepare for PQ key exchange
  (GH #3608)
* Fix custom key exchange logic integration for TLS 1.2 server (GH #3539)
* Add initial wrappers for using AVX-512, and implement AVX-512 versions
  of ChaCha and Serpent. (GH #3206 #3536)
* Add support for an environmental variable which can disable CPU extensions
  (GH #3535)
* Update the BSI policy to match the latest TR (GH #3482)
* Update the BoringSSL test suite shim (GH #3616)
* Add FFI functions relating to Kyber key management (GH #3546)
* The entire codebase has been reformatted using `clang-format`.
  (GH #3502 #3558 #3559)
* Fix many warnings generated from `clang-tidy`.
* `BigInt::random_integer` could take a long time if requested to
  generate a number within a small range between two large integers.
  (GH #3594)
* Fix bugs related to `--library-suffix` option. (GH #3511)
* Improve cli handling of PBKDF configuration (GH #3518)
* Fix the cli to properly update stateful keys (namely XMSS) when using such
  a key to sign a X.509 certificate (GH #3579)
* Add support for using PSK in the TLS CLI utilities (GH #3552)
* Add an example of hybrid RSA+symmetric encryption (GH #3551)
* In the Python module, the pbkdf function defaulted to 10K iterations.
  This has been changed to 100K.
* Switch to using coveralls.io for coverage report (GH #3512)
* Add a script to analyze the output of `botan timing_test`
* Due to problems that arise if the build directory and source
  directory are on different filesystems, now hardlinks are only
  used during the build if explicitly requested. (GH #3504)
* The `ffi.h` header no longer depends on the `compiler.h` header.
  (GH #3531)
* Avoid using varargs macros for `BOTAN_UNUSED` (GH #3530)
* Small base64 encoding optimization (GH #3528)
* If the build system detects that the compiler in use is not supported,
  it will error immediately rather than allow a failing build. Currently
  this is only supported for GCC, Clang, and MSVC. (GH #3526)
* The examples are now a first class build target; include
  `examples` in the set provided to `--build-targets=` option in
  order to enable them. (GH #3527)
* Remove the (undocumented, unsupported) support for CMake (GH #3501)

## Version 3.0.0, 2023-04-11[Â¶](#version-3-0-0-2023-04-11 "Link to this heading")

* Botan is now a C++20 codebase; compiler requirements have been
  increased to GCC 11, Clang 14, or MSVC 2022. (GH #2455 #3086)

### Breaking Changes[Â¶](#breaking-changes "Link to this heading")

* Remove many deprecated headers. In particular all algorithm specific
  headers (such as `aes.h`) are no longer available; instead objects
  must be created through the base class `create` functions. (GH #2456)
* Removed most functions previously marked as deprecated.
* Remove several deprecated algorithms including CAST-256, MISTY1, Kasumi,
  DESX, XTEA, PBKDF1, MCEIES, CBC-MAC, Tiger, NEWHOPE, and CECPQ1 (GH #2434 #3094)
* Remove the entropy source which walked `/proc` as it is no longer
  required on modern systems. (GH #2692)
* Remove the entropy source which reads from `/dev/random` as it is
  supplanted by the extant source one which reads from the system RNG.
  (GH #2636)
* Remove use of `shared_ptr` from certificate store API, as since
  2.4.0 `X509_Certificate` is internally a `shared_ptr`. (GH #2484)
* Several enums including `DL_Group::Format`, `EC_Group_Formatting`,
  `CRL_Code`, `ASN1_Tag`, `Key_Constraints` and `Signature_Format` are
  now `enum class`. The `ASN1_Tag` enum has been split into `ASN1_Type`
  and `ASN1_Class`. (GH #2551 #2552 #3084 #2584 #3225)
* Avoid using or returning raw pointers whenever possible. (GH #2683 #2684
  #2685 #2687 #2688 #2690 #2691 #2693 #2694 #2695 #2696 #2697 #2700 #2703 #2708
  #3220)
* Remove support for HP and Pathscale compilers, Google NaCL (GH #2455),
  and IncludeOS (GH #3406)
* Remove deprecated `Data_Store` class (GH #2461)
* Remove deprecated public member variables of `OID`, `Attribute`,
  `BER_Object`, and `AlgorithmIdentifier`. (GH #2462)
* âSHA-160â and âSHA1â are no longer recognized as names for âSHA-1â
  (GH #3186)

### TLS Changes[Â¶](#tls-changes "Link to this heading")

* Added support for TLS v1.3
* Support for TLS 1.0, TLS 1.1, and DTLS 1.0 have been removed (GH #2631)
* Remove several deprecated features in TLS including DSA ciphersuites (GH #2505),
  anonymous ciphersuites (GH #2497), SHA-1 signatures in TLS 1.2 (GH #2537),
  SRP ciphersuites (GH #2506), SEED ciphersuites (GH #2509),
  Camellia CBC ciphersuites (GH #2509), AES-128 OCB ciphersuites (GH #2511),
  DHE\_PSK suites (GH #2512), CECPQ1 ciphersuites (GH #3094)

### New Cryptographic Algorithms[Â¶](#new-cryptographic-algorithms "Link to this heading")

* Add support for Kyber post-quantum KEM (GH #2872 #2500)
* Add support for Dilithium lattice based signatures (GH #2973 #3212)
* Add support for hashing onto an elliptic curve using the SSWU
  technique of draft-irtf-cfrg-hash-to-curve (GH #2726)
* Add support for keyed BLAKE2b (GH #2524)

### New APIs[Â¶](#new-apis "Link to this heading")

* Add new interface `T::new_object` which supplants `T::clone`. The
  difference is that `new_object` returns a `unique_ptr<T>` instead of a raw
  pointer `T*`. `T::clone` is retained but simply releases the result of
  `new_object`. (GH #2689 #2704)
* Add an API to `PasswordHash` accepting an AD and/or secret key, allowing
  those facilities to be used without using an algorithm specific API (GH #2707)
* Add new `X509_DN::DER_encode` function. (GH #2472)
* New API `Public_Key::get_int_field` for getting the integer fields of a public
  (or private) key by name (GH #3200)
* New `Cipher_Mode` APIs `ideal_granularity` and `requires_entire_message`
  (GH #3172 #3168)
* New `Private_Key::public_key` returns a new object containing the public
  key associated with that private key. (GH #2520)
* `SymmetricAlgorithm::has_keying_material` allows checking if a key has
  already been set on an object (GH #3295)
* Many new functions in the C89 interface; see the API reference for more details.

### Implementation Improvements[Â¶](#implementation-improvements "Link to this heading")

* Add AVX2 implementation of Argon2 (GH #3205)
* Use smaller tables in the implementations of Camellia, ARIA, SEED, DES,
  and Whirlpool (GH #2534 #2558)
* Modify DES/3DES to use a new implementation which avoids most
  cache-based side channels. (GH #2565 #2678)
* Optimizations for SHACAL2, especially improving ARMv8 and POWER (GH #2556 #2557)
* Add a fast path for inversion modulo `2*o` with `o` odd, and modify RSA
  key generation so that `phi(n)` is always of this form. (GH #2634)
* Use constant-time code instead of table lookups when computing parity bits
  (GH #2560), choosing ASN.1 string type (GH #2559) and when converting to/from
  the bcrypt variant of base64 (GH #2561)
* Change how DL exponents are sized; now exponents are slightly larger and
  are always chosen to be 8-bit aligned. (GH #2545)

### Other Improvements[Â¶](#other-improvements "Link to this heading")

* Changes to `TLS::Stream` to make it compatible with generic completion tokens.
  (GH #2667 #2648)
* When creating an `EC_Group` from parameters, cause the OID to be set if it
  is a known group. (GH #2654 #2649)
* Fix bugs in GMAC and SipHash where they would require a fresh key be
  provided for each message. (GH #2908)

## Version 2.19.5, 2024-07-08[Â¶](#version-2-19-5-2024-07-08 "Link to this heading")

* A reminder that Botan2 reaches end of life at the end of 2024
* CVE-2024-34702: Fix a DoS caused by excessive name constraints. (GH #4187)
* CVE-2024-39312: Fix a name constraint processing error, where if
  permitted and excluded rules both applied to a certificate, only the
  permitted rules would be checked. (GH #4187)
* Fix a crash in OCB (GH #3812 #3924)
* During certificate verification, first verify the entire chain of
  certificates, then perform other validation. (GH #4052 #4045)
* Fix a test failure in compression with certain versions of zlib (GH #4135 #3896)
* Fix some iterator debugging errors in TLS CBC decryption. (GH #4125 #4130)
* Avoid a miscompilation in ARIA when using XCode 14 (GH #3465 #3492 #4053)

## Version 2.19.4, 2024-02-20[Â¶](#version-2-19-4-2024-02-20 "Link to this heading")

* CVE-2024-34703 Fix a potential denial of service caused by accepting
  arbitrary length primes as potential elliptic curve parameters in
  ASN.1 encodings. With very large inputs the primality verification
  can become computationally expensive. Now any prime field larger
  than 1024 bits is rejected immediately. Reported by Bing Shi. (GH #3914)
* Switch to using a constant time binary algorithm for computing
  GCD (GH #3912)
* Fix a bug in SHAKE\_Cipher which could cause incorrect output
  if set\_key was called multiple times. (GH #3192)
* Fix a bug in RSA-KEM encryption where the shared secret key
  was incorrectly not padded to exactly the byte length of the
  modulus. This would cause an incorrect shared key with ~1/256
  probability. (GH #3380)
* In RSA decryption and signature verification, reject bytestrings
  which are longer than the public modulus. Previously, otherwise
  valid signatures/ciphertexts with additional leading zero bytes
  would also be accepted. (GH #3380)
* Add support for short nonces in XTS (GH #3384 #3336)
* Fix NIST keywrap which was incorrect when wrapping 64-bit keys
  (GH #3384 #3340)
* Fix nonce handling bug in EAX (GH #3382 #3335)
* Fix a bug in PKCS11 AttributeContainer where adding an attribute
  that already existed could cause incorrect references to the
  existing attributes. (GH #3185)
* Apply patches which allow GCC 4.7 to compile Botan 2.x. Previously
  at least GCC 4.8 had been required. (GH #3273)
* Fix a build time problem affecting VCpkg (GH #3071)
* Fix a build problem affecting Windows ARM with Visual C++ (GH #3871)

## Version 2.19.3, 2022-11-16[Â¶](#version-2-19-3-2022-11-16 "Link to this heading")

* CVE-2022-43705: A malicious OCSP responder could forge OCSP
  responses due to a failure to validate that an embedded certificate
  was issued by the end-entity issuing certificate authority.

## Version 2.19.2, 2022-06-03[Â¶](#version-2-19-2-2022-06-03 "Link to this heading")

* Add support for parallel computation in Argon2 (GH #2937 #2926)
* Add SSSE3 implementation of Argon2 (GH #2937 #2927)
* The OpenSSL provider was incompatible with OpenSSL 3.0.
  It has been removed (GH #2902)
* Avoid using reserve in secure\_vector appending, which caused
  a performance problem (GH #2945 #2920)
* Fix TLS::Text\_Policy behavior when X25519 is disabled
  at build time (GH #2894)
* Fix several warnings from Clang (#2888 #2886)

## Version 2.19.1, 2022-01-21[Â¶](#version-2-19-1-2022-01-21 "Link to this heading")

* Fix a compilation problem affecting macOS XCode (GH #2880)
* Fix a build problem preventing amalgamation builds in 2.19.0
  (GH #2879)

## Version 2.19.0, 2022-01-19[Â¶](#version-2-19-0-2022-01-19 "Link to this heading")

* Add a forward error correction code compatible with the
  zfec library (GH #2868 #2866)
* Improve Emscripten build (GH #2864)
* Always use `-L` before build flags (GH #2858 2848)
* Fix compilation issue on earlier macOS versions (GH #2851)
* Add a GCC 4.8 CI target to prevent build regressions (GH #2869)
* Add support for Loongarch64 (GH #2877)
* Check OSXSAVE flag before using AVX2 instructions (GH #2878)

## Version 2.18.2, 2021-10-25[Â¶](#version-2-18-2-2021-10-25 "Link to this heading")

* Avoid using short exponents when encrypting in ElGamal, as some PGP
  implementations generate keys with parameters that are weak when
  short exponents are used (GH #2794)
* Fix a low risk OAEP decryption side channel (GH #2797)
* Work around a miscompilation of SHA-3 caused by a bug in Clang 12
  and XCode 13. (GH #2826)
* Remove support in OpenSSL provider for algorithms which are
  disabled by default in OpenSSL 3.0 (GH #2823, #2814)
* Add CI based on GitHub actions to replace Travis CI (GH #2632)
* Fix the online OCSP test, as the certificate involved had expired.
  (GH #2799)
* Fix some test failures induced by the expiration of the trust root
  âDST Root CA X3â (GH #2820)

## Version 2.18.1, 2021-05-09[Â¶](#version-2-18-1-2021-05-09 "Link to this heading")

* Fix a build regression in 2.18.0 which caused linker flags which
  contain `-l` within them (such as `-fuse-linker-plugin`) to
  be misinterpreted. (GH #2715)
* Fix a bug which caused decoding a certificate which contained
  more than one name in a single RDN. (GH #2611 #2630 #2724)
* Fix a bug which caused OID lookup failures when run in a locale
  which uses thousands separators (pt\_BR was reported as having
  this issue). (GH #2732 #2730 #2237)
* DNS names in name constraints were compared with case sensitivity, which
  could cause valid certificates to be rejected. (GH #2739 #2735)
* X.509 name constraint extensions were rejected if non-critical. RFC 5280
  requires conforming CAs issue such extensions as critical, but not all
  certificates are compliant, and all other known implementations do not
  require this. (GH #2739 #2736)
* X.509 name constraints were incorrectly applied to the certificate which
  included the constraint. (GH #2739 #2737)

## Version 2.18.0, 2021-04-15[Â¶](#version-2-18-0-2021-04-15 "Link to this heading")

* Add support for implementing custom RNG objects through the
  FFI interface (GH #2627 #2600)
* Improve safegcd bounds, improving runtime performance (GH #2628 #2619)
* Fix a bug introduced in 2.9.0 where BigInt::operator< would return
  an incorrect result if both operands were negative. (GH #2641 #2638)
* Reject non-TLS messages as quickly as possible without waiting for
  a full record. (GH #2676)
* Add build support for RISC-V 32
* Fixes for TLS::Stream::async\_shutdown (GH #2673)
* Fix a regression introduced in 2.17.0 where LDFLAGS which add an extra
  library (such as `-latomic` needed on SPARC) were not always applied
  effectively. (GH #2622 #2623 #2625)

## Version 2.17.3, 2020-12-21[Â¶](#version-2-17-3-2020-12-21 "Link to this heading")

* CVE-2021-24115 Change base64, base58, base32, and hex encoding and
  decoding operations to run in constant time (GH #2549)
* Fix a build problem on PPC64 building with Clang (GH #2547)
* Fix an install problem introduced in 2.17.2 affecting MSVC 2015
* Fix use of -L flag in linking when configured using `--with-external-libdir`
  (GH #2496)
* Fix a build problem on big-endian PowerPC related to VSX instructions
  in the AES code. (GH #2515)

## Version 2.17.2, 2020-11-13[Â¶](#version-2-17-2-2020-11-13 "Link to this heading")

* Fix an build problem on ppc64 introduced with certain recent
  versions of GCC or binutils where using the DARN instruction
  requires using an appropriate -mcpu flag to enable the instruction
  in the assembler. (GH #2481 2463)
* Resolve an issue in the modular square root algorithm where a loop
  to find a quadratic non-residue could, for a carefully chosen
  composite modulus, not terminate in a timely manner. (GH #2482 #2476)
* Fix a regression in MinGW builds introduced in 2.17.1

## Version 2.17.1, 2020-11-07[Â¶](#version-2-17-1-2020-11-07 "Link to this heading")

* Fix a build problem that could occur if Python was not in the PATH.
  This was known to occur on some installations of macOS.
* Re-enable support for the x86 CLMUL instruction on Visual C++, which was
  accidentally disabled starting in 2.12.0. (GH #2460)

## Version 2.17.0, 2020-11-05[Â¶](#version-2-17-0-2020-11-05 "Link to this heading")

* Fix a bug in ECDSA which could occur when the group size and hash length
  differ. In this case, on occasion the generated signature would not be
  accepted by other ECDSA implementations. This was particularly likely to
  affect users of 160-bit or 239-bit curves. (GH #2433 #2415)
* Fix a bug in ECDSA verification when the public key was chosen to be
  a small multiple of the group generator. In that case, verification
  would fail even if the signature was actually valid. (GH #2425)
* SIVâs functionality of supporting multiple associated data inputs has been
  generalized onto the AEAD\_Mode interface. However at the moment SIV is the
  only AEAD implemented which supports more than one AD. (GH #2440)
* The contents of ASN.1 headers `asn1_str.h`, `asn1_time.h`, `asn1_oid.h`
  and `alg_id.h` have been moved to `asn1_obj.h`. The header files remain
  but simply forward the include to `asn1_obj.h`. These now-empty header files
  are deprecated, and will be removed in a future major release. (GH #2441)
* The contents of X.509/PKIX headers `asn1_attribute.h` `asn1_alt_name.h`
  `name_constraint.h` `x509_dn.h` `cert_status.h` and `key_constraint.h`
  have been merged into `pkix_enums.h` (for enumerations) and `pkix_types.h`
  (for all other definitions). The previous header files remain but simply
  forward the include to the new header containing the definition. These
  now-empty header files are deprecated, and will be removed in a future major
  release. (GH #2441)
* A number of other headers including those related to HOTP/TOTP, XMSS,
  PKCS11, PSK\_DB have also been merged. Any now deprecated/empty headers
  simply include the new header and issue a deprecation warning.
  (GH #2443 #2446 #2447 2448 #2449)
* Small optimizations in the non-hardware assisted AES key generation
  code path (GH #2417 #2418)
* Move the GHASH code to a new module in utils, making it possible
  to build GMAC support without requiring GCM (GH #2416)
* Add more detection logic for AVX-512 features (GH #2430)
* Avoid std::is\_pod which is deprecated in C++20 (GH #2429)
* Fix a bug parsing deeply nested cipher names (GH #2426)
* Add support for `aarch64_be` target CPU (GH #2422)
* Fix order of linker flags so they are always applied effectively (GH #2420)
* Prevent requesting DER encoding of signatures when the algorithm
  did not support it (GH #2419)

## Version 2.16.0, 2020-10-06[Â¶](#version-2-16-0-2020-10-06 "Link to this heading")

* Now userspace PRNG objects (such as AutoSeeded\_RNG and HMAC\_DRBG)
  use an internal lock, which allows safe concurrent use. This however
  is purely a precaution in case of accidental sharing of such RNG
  objects; for performance reasons it is always preferable to use
  a RNG per thread if a userspace RNG is needed. (GH #2399)
* DL\_Group and EC\_Group objects now track if they were created from a
  known trusted group (such as P-256 or an IPsec DH parameter). If
  so, then verification tests can be relaxed, as compared to
  parameters which may have been maliciously constructed in order to
  pass primality checks. (GH #2409)
* RandomNumberGenerator::add\_entropy\_T assumed its input was a POD
  type but did not verify this. (GH #2403)
* Support OCSP responders that live on a non-standard port (GH #2401)
* Add support for Solaris sandbox (GH #2385)
* Support suffixes on release numbers for alpha/beta releases (GH #2404)
* Fix a bug in EAX which allowed requesting a 0 length tag, which had
  the effect of using a full length tag. Instead omit the length field,
  or request the full tag length explicitly. (GH #2392 #2390)
* Fix a memory leak in GCM where if passed an unsuitable block cipher
  (eg not 128 bit) it would throw an exception and leak the cipher
  object. (GH #2392 #2388)

## Version 2.15.0, 2020-07-07[Â¶](#version-2-15-0-2020-07-07 "Link to this heading")

* Fix a bug where the name constraint extension did not constrain the
  alternative DN field which can be included in a subject alternative name. This
  would allow a corrupted sub-CA which was otherwise constrained by a name
  constraint to issue a certificate with a prohibited DN.
* Fix a bug in the TLS server during client authentication where where
  if a (disabled by default) static RSA ciphersuite was selected, then
  no certificate request would be sent. This would have an equivalent
  effect to a client which simply replied with an empty Certificate
  message. (GH #2367)
* Replace the T-Tables implementation of AES with a 32-bit bitsliced
  version. As a result AES is now constant time on all processors.
  (GH #2346 #2348 #2353 #2329 #2355)
* In TLS, enforce that the key usage given in the server certificate
  allows the operation being performed in the ciphersuite. (GH #2367)
* In X.509 certificates, verify that the algorithm parameters are
  the expected NULL or empty. (GH #2367)
* Change the HMAC key schedule to attempt to reduce the information
  leaked from the key schedule with regards to the length of the key,
  as this is at times (as for example in PBKDF2) sensitive information.
  (GH #2362)
* Add Processor\_RNG which wraps RDRAND or the POWER DARN RNG
  instructions. The previous RDRAND\_RNG interface is deprecated.
  (GH #2352)
* The documentation claimed that mlocked pages were created with a
  guard page both before and after. However only a trailing guard page
  was used. Add a leading guard page. (GH #2334)
* Add support for generating and verifying DER-encoded ECDSA signatures
  in the C and Python interfaces. (GH #2357 #2356)
* Workaround a bug in GCCâs UbSan which triggered on a code sequence
  in XMSS (GH #2322)
* When building documentation using Sphinx avoid parallel builds with
  version 3.0 due to a bug in that version (GH #2326 #2324)
* Fix a memory leak in the CommonCrypto block cipher calls (GH #2371)
* Fix a flaky test that would occasionally fail when running the tests
  with a large number of threads. (GH #2325 #2197)
* Additional algorithms are now deprecated: XTEA, GOST, and Tiger.
  They will be removed in a future major release.

## Version 2.14.0, 2020-04-06[Â¶](#version-2-14-0-2020-04-06 "Link to this heading")

* Add support for using POWER8+ VPSUMD instruction to accelerate GCM
  (GH #2247)
* Optimize the vector permute AES implementation, especially improving
  performance on ARMv7, Aarch64, and POWER. (GH #2243)
* Use a new algorithm for modular inversions which is both faster and
  more resistant to side channel attacks. (GH #2287 #2296 #2301)
* Address an issue in CBC padding which would leak the length of the
  plaintext which was being padded. Unpadding during decryption was
  not affected. Thanks to Maximilian Blochberger for reporting this.
  (GH #2312)
* Optimize NIST prime field reductions, improving ECDSA by 3-9% (GH #2295)
* Increase the size of the ECC blinding mask and scale it based on the
  size of the group order. (GH #880 #893 #2308)
* Add server side support for the TLS asio wrapper. (GH #2229)
* Add support for using Windows certificate store on MinGW (GH #2280)
* Use the library thread pool instead of a new thread for RSA computations,
  improving signature performance by up to 20%. (GH #2257)
* Precompute and cache additional fields in `X509_Certificate` (GH #2250)
* Add a CLI utility `cpu_clock` which estimates the speed of the
  processor cycle counter. (GH #2251)
* Fix a bug which prevented using DER-encoded ECDSA signatures with a PKCS11
  key (GH #2293)
* Enable use of raw block ciphers from CommonCrypto (GH #2278)
* Support for splitting up the amalgamation file by ABI extension has
  been removed. Instead only `botan_all.cpp` and `botan_all.h` are
  generated. (GH #2246)
* Improve support for baremetal systems with no underlying OS, with
  target OS `none` (GH #2303 #2304 #2305)
* The build system now avoids using `-rpath=$ORIGIN` or (on macOS)
  install\_name which allowed running the tests from the build
  directory without setting `LD_LIBRARY_PATH`/`DYLD_LIBRARY_PATH`
  environment variables. Instead set the dynamic linker variables
  appropriately, or use `make check`. (GH #2294 #2302)
* Add new option `--name-amalgamation` which allows naming the
  amalgamation output, instead of the default `botan_all`. (GH #2246)
* Avoid using symbolic links on Windows (GH #2288 #2286 #2285)
* Fix a bug that prevented compilation of the amalgamation on ARM and
  POWER processors (GH #2245 #2241)
* Fix some build problems under Intel C++ (GH #2260)
* Remove use of Toolhelp Windows library, which was known to trigger
  false positives under some antivirus systems. (GH #2261)
* Fix a compilation problem when building on Windows in Unicode mode.
  Add Unicode build to CI to prevent regressions. (GH #2254 #2256)
* Work around a GCC bug affecting old libc (GH #2235)
* Workaround a bug in macOS 10.15 which caused a test to crash.
  (GH #2279 #2268)
* Avoid a crash in PKCS8::load\_key due to a bug in Clang 8.
  (GH #2277)

## Version 2.13.0, 2020-01-06[Â¶](#version-2-13-0-2020-01-06 "Link to this heading")

* Add Roughtime client (GH #2143 #1842)
* Add support for XMSS X.509 certificates (GH #2172)
* Add support for X.509 CRLs in FFI layer and Python wrapper (GH #2213)
* It is now possible to disable TLS v1.0/v1.1 and DTLS v1.0 at build time.
  (GH #2188)
* The format of encrypted TLS sessions has changed, which will invalidate all
  existing session tickets. The new format will make it easier to support ticket
  key rotation in the future. (GH #2225)
* Improve RSA key generation performance (GH #2148)
* Make gcd computation constant-time (GH #2147)
* Add AVX2 implementation of SHACAL2 (GH #2196)
* Update BSI policy to reflect 2019 update of TR 02102-2 (GH #2195)
* Support more functionality for X.509 in the Python API (GH #2165)
* Add `generic` CPU target useful when building for some new or unusual
  platform.
* Disable MD5 in BSI or NIST modes (GH #2188)
* Disable stack protector on MinGW as it causes crashes with some recent
  versions. (GH #2187)
* On Windows the DLL is now installed into the binary directory (GH #2233)
* Previously Windows required an explicit `.lib` suffix be added when
  providing an explicit library name, as is used for example for Boost.
  Now the `.lib` suffix is implicit, and should be omitted.
* Remove the 32-bit x86 inline asm for Visual C++ as it seemed to not offer
  much in the way of improved performance. (GH #2204 #256)
* Resolve all compile time warnings generated by GCC, Clang and MSVC.
  Modify CI to compile with warnings-as-errors. (GH #2170 #2206 #2211 #2212)
* Fix bugs linking to 3rd party libraries on Windows due to invalid
  link specifiers. (GH #2210 #2215)
* Add long input and NIST Monte-Carlo hash function tests.
* Fix a bug introduced in 2.12.0 where `TLS::Channel::is_active` and
  `TLS::Channel::is_closed` could simultaneously return true.
  (GH #2174 #2171)
* Use `std::shared_ptr` instead of `boost::shared_ptr` in some examples.
  (GH #2155)

## Version 2.12.1, 2019-10-14[Â¶](#version-2-12-1-2019-10-14 "Link to this heading")

* Fix a bug that prevented building with nmake (GH #2142 #2141)
* Fix an issue where make install would attempt to build targets which
  were disabled. (GH #2140)
* If the option `--without-documentation` is used, avoid invoking the
  documentation build script. (GH #2138)
* Fix a bug that prevented compilation on x86-32 using GCC 4.9 (GH #2139)
* Fix a bug in CCM encryption, where it was possible to call `finish` without
  ever setting a nonce (GH #2151 #2150)
* Improve ECIES/DLIES interfaces. If no initialization vector was set, they
  would typically produce hard to understand exceptions. (GH #2151 #2150)

## Version 2.12.0, 2019-10-07[Â¶](#version-2-12-0-2019-10-07 "Link to this heading")

* Many currently public headers are being deprecated. If any such header is
  included by an application, a warning is issued at compile time. Headers
  issuing this warning will be made internal in a future major release.
  (GH #2061)
* RSA signature performance improvements (GH #2068 #2070)
* Performance improvements for GCM (GH #2024 #2099 #2119), OCB (#2122),
  XTS (#2123) and ChaCha20Poly1305 (GH #2117), especially for small messages.
* Add support for constant time AES using NEON and AltiVec (GH #2093 #2095 #2100)
* Improve performance of POWER8 AES instructions (GH #2096)
* Add support for the POWER9 hardware random number generator (GH #2026)
* Add support for 64-bit version of RDRAND, doubling performance on x86-64 (GH #934 #2022)
* In DTLS server, support a client crashing and then reconnecting from
  the same source port, as described in RFC 6347 sec 4.2.8 (GH #2029)
* Optimize DTLS MTU splitting to split precisely to the set MTU (GH #2042)
* Add support for the TLS v1.3 downgrade indicator. (GH #2027)
* Improve the error messages generated when an invalid TLS state transition occurs
  (GH #2030)
* Fix some edge cases around TLS close\_notify support. (GH #2054)
* Modifications to support GOST 34.10-2012 signatures (GH #2055 #2056 #1860 #1897)
* Add some new APIs on `OID` objects (GH #2057)
* Properly decode OCSP responses which indicate an error (GH #2110)
* Add a function to remove an X.509 extension from an Extensions object.
  (GH #2101 #2073 #2065)
* Support Argon2 outputs longer than 64 bytes (GH #2079 #2078)
* Correct a bug in CAST-128 which caused incorrect computation using
  11, 13, 14, or 15 byte keys. (GH #2081)
* Fix a bug which would cause Streebog to produce incorrect outputs for
  certain messages (GH #2082 #2083)
* Fix a bug that prevented loading EC points with an affine x or y
  value of 0. For certain curves such points can exist. (GH #2102)
* Fix a bug which would cause PBKDF2 to go into a very long loop if
  it was requested to use an iteration count of 0. (GH #2090 #2088)
* The BearSSL provider has been removed (GH #2020)
* Add a new `entropy` cli which allows sampling the output of the entropy sources.
* Add new `base32_enc` and `base32_dec` cli for base32 encoding operations. (GH #2111)
* Support setting TLS policies in CLIs like `tls_client` and `tls_proxy_server` (GH #2047)
* The tests now run in multithreaded mode by default. Provide option `--test-threads=1` to
  return to previous single-threaded behavior. (GH #2071 #2075)
* Cleanups in TLS record layer (GH #2021)
* Fix typos in some OCSP enums which used âOSCPâ instead. (GH #2048)
* In the Python module, avoid trying to load DLLs for names that donât match the current
  platform (GH #2062 #2059)
* In the Python module, also look for `botan.dll` so Python wrapper can run on Windows.
  (GH #2059 #2060)
* Add support for TOTP algorithm to the Python module. (GH #2112)
* Now the minimum Windows target is set to Windows 7 (GH #2036 #2028)
* Add `BOTAN_FORCE_INLINE` macro to resolve a performance issue with BLAKE2b on MSVC
  (GH #2092 #2089)
* Avoid using `__GNUG__` in headers that may be consumed by a C compiler (GH #2013)
* Improve the PKCS11 tests (GH #2115)
* Fix a warning from Klocwork (GH #2128 #2129)
* Fix a bug which caused amalgamation builds to fail on iOS (GH #2045)
* Support disabling thread local storage, needed for building on old iOS (GH #2045)
* Add a script to help with building for Android, using Docker (GH #2016 #2033 #513)
* Add Android NDK build to Travis CI (GH #2017)

## Version 2.11.0, 2019-07-01[Â¶](#version-2-11-0-2019-07-01 "Link to this heading")

* Add Argon2 PBKDF and password hash (GH #459 #1981 #1987)
* Add Bcrypt-PBKDF (GH #1990)
* Add a libsodium compat layer in sodium.h (GH #1996)
* XMSS now follows RFC 8391 which is incompatible with previous versions, which
  had followed draft 6. (GH #1858 #2003)
* Add server side support for issuing DTLS HelloVerifyRequest messages
  (GH #1999)
* Add a shim allowing testing Botan against the BoringSSL test suite,
  and fix a number of bugs in TLS found using it.
  (GH #1954 #1955 #1956 #1959 #1966 #1970)
* Add support for the TLS v1.3 supported\_versions extension. (GH #1976)
* Add Ed25519ph compatible with RFC 8032 (GH #1699 #2000)
* Add support for OCSP stapling on server side. (GH #1703 #1967)
* Add a `boost::asio` TLS stream compatible with `boost::asio::ssl`.
  (GH #1839 #1927 #1992)
* Add a certificate store for Linux/Unix systems. (GH #1885 #1936)
* Add a certificate store for Windows systems. (GH #1931)
* Add a generic `System_Certificate_Store` which wraps Windows, macOS,
  and Linux certificate stores. (GH #1893)
* Fix verification rooted in a v1 certificate which previously would fail.
  (GH #1890)
* Add ability to specify the maximum age of an OCSP response which does not
  have the nextUpdate field set. (GH #1974 #1995)
* Fix X509\_DN::operator< which could erroneously return true in both
  directions (ie, DN1 < DN2 && DN2 < DN1). This would break STL
  containers using a DN as the key. (GH #1938)
* It is now possible to create intermediate CA certificates using the
  command line interface. (GH #1879 #1889)
* Add a new build time option to set where the system stores trusted
  certificates. (GH #1888)
* New `trust_roots` CLI that examines the system certificate store.
  (GH #1893)
* Fix bugs and add many new features in the Python wrapper.
  (GH #1899 #1900 #1901 #1902 #1903 #1904 #1906 #1907 #1915)
* Various FFI interfaces which are redundant with other APIs are now
  deprecated. The deprecation message suggests the alternate API to use.
  (GH #1915)
* Fix decoding of RSA-OAEP certificates. (GH #1943 #1944)
* Allow setting multiple organization unit fields in a certificate or
  certificate request. (GH #1939)
* Increase the maximum allowed year in ASN1\_Time to 3100. This works
  around a problem parsing certs in AppVeyorâs trust store.
* Add `--format` option to `rng` CLI command allowing to format
  as base64, base58 or binary in addition to hex. (GH #1945)
* Remove use of table lookups for IP/FP transforms in DES (GH #1928)
* Improve the tests for SRP6 (GH #1917 #1923)
* Document the build system
* When available use POSIX `sysconf` to detect the number of CPUs (GH #1877)
* Add functionality to handle Boost naming conventions on different platforms,
  especially affecting Windows. Enable Boost in AppVeyor builds. (GH #1964)
* Add alternate implementation of `getauxval` for older Android (GH #1962)
* Add `configure.py` option allowing to set arbitrary macros during build.
  (GH #1960)
* Use FreeBSDâs `elf_aux_info` to detect ARM and POWER CPU features
  (GH #1895)
* Use FreeBSDâs `PROT_MAX` to prevent mmap regions from being made executable
  later. (GH #2001)
* Fix a memory leak in the tests (GH #1886)
* Fix an issue building with the new Boost 1.70 (GH #1881 #1880)
* Fix an issue with UbSan in the tests (GH #1892)
* Remove use of `-mabi` flag when building on MIPS64 (GH #1918)
* Make it possible to specify additional libraries in `LDFLAGS` (GH #1916)
* Fix some warnings from Clang 8 (GH #1941)
* Fix the makefile .PHONY syntax (GH #1874)
* Fix build issue with SoftHSM 2.5.0 (GH #1986)

## Version 2.10.0, 2019-03-30[Â¶](#version-2-10-0-2019-03-30 "Link to this heading")

* Notice: the developers plan to switch from gzip to xz compression for
  releases starting in 2.11. If this is a problem please comment at
  <https://github.com/randombit/botan/issues/1872>
* Warning: XMSS currently implements draft-06 which is not compatible with the
  final RFC 8391 specification. A PR is open to fix this, however it will break
  all current uses of XMSS. If you are currently using XMSS please comment at
  <https://github.com/randombit/botan/pull/1858>. Otherwise the PR will be merged
  and support for draft-06 will be removed starting in 2.11.
* Added a new certificate store implementation that can access the
  MacOS keychain certificate store. (GH #1830)
* Redesigned `Memory_Pool` class, which services allocations out of a
  set of pages locked into memory (using `mlock`/`VirtualLock`). It is now
  faster and with improved exploit mitigations. (GH #1800)
* Add BMI2 implementations of SHA-512 and SHA-3 which improve performance by
  25-35% on common CPUs. (GH #1815)
* Unroll SHA-3 computation improving performance by 10-12% (GH #1838)
* Add a `Thread_Pool` class. It is now possible to run the tests in multiple
  threads with `--test-threads=N` flag to select the number of threads to use.
  Use `--test-threads=0` to run with as many CPU cores as are available on the
  current system. The default remains single threaded. (GH #1819)
* XMSS signatures now uses a global thread pool instead of spawning new threads
  for each usage. This improves signature generation performance by between 10%
  and 60% depending on architecture and core count. (GH #1864)
* Some functions related to encoding and decoding BigInts have been deprecated.
  (GH #1817)
* Binary encoding and decoding of BigInts has been optimized by performing
  word-size operations when possible. (GH #1817)
* Rename the exception `Integrity_Failure` to `Invalid_Authentication_Tag` to make
  its meaning and usage more clear. The old name remains as a typedef. (GH #1816)
* Support for using Boost `filesystem` and MSVCâs `std::filesystem` have been
  removed, since already POSIX and Win32 versions had to be maintained for
  portability. (GH #1814)
* Newly generated McEliece and XMSS keys now default to being encrypted using
  SIV mode, support for which was added in 2.8.0. Previously GCM was used by
  default for these algorithms.
* Use `arc4random` on Android systems (GH #1851)
* Fix the encoding of PGP-S2K iteration counts (GH #1853 #1854)
* Add a facility for sandboxing the command line util. Currently FreeBSD
  (Capsicum) and OpenBSD (`pledge`) sandboxes are supported. (GH #1808)
* Use `if constexpr` when available.
* Disable building shared libs on iOS as it was broken and it is not clear shared
  libraries are ever useful on iOS (GH #1865)
* Renamed the `darwin` build target to `macos`. This should not cause any
  user-visible change. (GH #1866)
* Add support for using `sccache` to cache the Windows CI build (GH #1807)
* Add `--extra-cxxflags` option which allows adding compilation flags without
  overriding the default set. (GH #1826)
* Add `--format=` option to the `hash` cli which allows formatting the output
  as base64 or base58, default output remains hex.
* Add `base58_enc` and `base58_dec` cli utils for base58 encoding/decoding.
  (GH #1848)
* Enable `getentropy` by default on macOS (GH #1862)
* Avoid using `-momit-leaf-frame-pointer` flags, since `-fomit-frame-pointer`
  is already the default with recent versions of GCC.
* Fix XLC sanitizer flags.
* Rename `Blake2b` class to `BLAKE2b` to match the official name. There is
  a typedef for compat.
* Fix a bug where loading a raw `Ed25519_PublicKey` of incorrect length would
  lead to a crash. (GH #1850)
* Fix a bug that caused compilation problems using CryptoNG PRNG. (GH #1832)
* Extended SHAKE-128 cipher to support any key between 1 and 160 bytes, instead
  of only multiples of 8 bytes.
* Minor HMAC optimizations.
* Build fixes for GNU/Hurd.
* Fix a bug that prevented generating or verifying Ed25519 signatures in the CLI
  (GH #1828 #1829)
* Fix a compilation error when building the amalgamation outside of the original
  source directory when AVX2 was enabled. (GH #1812)
* Fix a crash when creating the amalgamation if a header file was edited on
  Windows but then the amalgamation was built on Linux (GH #1763)

## Version 2.9.0, 2019-01-04[Â¶](#version-2-9-0-2019-01-04 "Link to this heading")

* CVE-2018-20187 Address a side channel during ECC key generation,
  which used an unblinded Montgomery ladder. As a result, a timing
  attack can reveal information about the high bits of the secret key.
* Fix bugs in TLS which caused negotiation failures when the client
  used an unknown signature algorithm or version (GH #1711 #1709 #1708)
* Fix bug affecting GCM, EAX and ChaCha20Poly1305 where if the associated data
  was set after starting a message, the new AD was not reflected in the produced
  tag. Now with these modes setting an AD after beginning a message throws an
  exception.
* Use a smaller sieve which improves performance of prime generation.
* Fixed a bug that caused ChaCha to produce incorrect output after encrypting
  256 GB. (GH #1728)
* Add NEON and AltiVec implementations of ChaCha (GH #1719 #1728 #1729)
* Optimize AVX2 ChaCha (GH #1730)
* Many more operations in BigInt, ECC and RSA code paths are either fully const time
  or avoid problematic branches that could potentially be exploited in a side
  channel attack. (GH #1738 #1750 #1754 #1755 #1757 #1758 #1759 #1762 #1765
  #1770 #1773 #1774 #1779 #1780 #1794 #1795 #1796 #1797)
* Several optimizations for BigInt and ECC, improving ECDSA performance by as
  much as 30%. (GH #1734 #1737 #1777 #1750 #1737 #1788)
* Support recovering an ECDSA public key from a message/signature pair (GH #664 #1784)
* Add base58 encoding/decoding functions (GH #1783)
* In the command line interface, add support for reading passphrases from the
  terminal with echo disabled (GH #1756)
* Add `CT::Mask` type to simplify const-time programming (GH #1751)
* Add new configure options `--disable-bmi2`, `--disable-rdrand`,
  and `--disable-rdseed` to prevent use of those instruction sets.
* Add `error_type` and `error_code` functions to Exception type (GH #1744)
* Now on POSIX systems `posix_memalign` is used instead of `mmap` for
  allocating the page-locked memory pool. This avoids issues with `fork`.
  (GH #602 #1798)
* When available, use RDRAND to generate the additional data in
  `Stateful_RNG::randomize_with_ts_input`
* Use vzeroall/vzeroupper intrinsics to avoid AVX2/SSE transition penalties.
* Support for Visual C++ 2013 has been removed (GH #1557 #1697)
* Resolve a memory leak when verifying ECDSA signatures with versions
  of OpenSSL before 1.1.0 (GH #1698)
* Resolve a memory leak using ECDH via OpenSSL (GH #1767)
* Fix an error in XTS which prohibited encrypting values which were
  exactly the same length as the underlying block size. Messages of
  this size are allowed by the standard and other XTS implementations.
  (GH #1706)
* Resolve a bug in TSS which resulted in it using an incorrect length
  field in the shares. Now the correct length is encoded, but either
  correct or buggy lengths are accepted when decoding. (GH #1722)
* Correct a bug when reducing a negative `BigInt` modulo a small power of 2.
  (GH #1755)
* Add CLI utils for threshold secret splitting. (GH #1722)
* Fix a bug introduced in 2.8.0 that caused compilation failure if using
  a single amalgamation file with AVX2 enabled. (GH #1700)
* Add an explicit OS target for Emscripten and improve support for it.
  (GH #1702)
* Fix small issues when building for QNX
* Switch the Travis CI build to using Ubuntu 16.04 (GH #1767)
* Add options to `configure.py` to disable generation of `pkg-config`
  file, and (for systems where `pkg-config` support defaults to off,
  like Windows), to enable generating it. (GH #1268)
* Modify `configure.py` to accept empty lists or trailing/extra commas.
  (GH #1705)

## Version 2.8.0, 2018-10-01[Â¶](#version-2-8-0-2018-10-01 "Link to this heading")

* Add support for using Apple CommonCrypto library for hashing (GH #1667),
  cipher modes (GH #1674) and block ciphers (GH #1673).
* Support for negotiating TLS versions 1.0 and 1.1 is disabled in the default
  TLS policy. In addition, support for negotiating TLS ciphersuites using CBC or
  CCM mode is disabled by default. Applications which need to interop with old
  peers must enable these in their TLS policy object. (GH #1651)
* During primality testing, use a Lucas test in addition to Miller-Rabin. It is
  possible to construct a composite integer which passes n Miller-Rabin tests
  with probability (1/4)^n. So for a incautious verifier using a small number
  of tests (under 16 or so) it is possible if unlikely they would accept such a
  composite as prime. Adding a Lucas test precludes such an attack. (GH #1636)
* Add XChaCha and XChaCha20Poly1305 (GH #1640)
* Add AVX2 implementations of ChaCha (GH #1662) and Serpent (GH #1660)
* Add a new password hashing interface in pwdhash.h (GH #1670)
* C binding improvements. Added functions to get name and supported
  keylengths of cipher, hash and MAC objects, support for FE1 format
  preserving encryption (GH #1625 #1646), functions to load and save
  RSA keys in PKCS #1 format (GH #1621), HOTP and TOTP algorithms,
  scrypt, certificate verification (GH #1647), functions to get the
  output length of public key operations (GH #1642), and functions for
  loading and serializing X25519 keys (GH #1681)
* Support for building with BOTAN\_MP\_WORD\_BITS set to 8 or 16 has been removed.
* Previously SM2 had two distinct key types, one for signatures and another for
  encryption. They have now been merged into a single key type since in practice
  it seems the same key is at times used for both operations. (GH #1637)
* The `Cipher_Mode` class now derives from `SymmetricAlgorithm` (GH #1639)
* Add support for using the ARMv8 instructions for SM4 encryption (GH #1622)
* The entropy source using `SecRandomCopyBytes` has been removed as it was
  redundant with other entropy sources (GH #1668)
* The Python module has much better error checking and reporting, and offers new
  functionality such as scrypt, MPI and FPE. (GH #1643 #1646)
* Fixed a bug that caused CCM to fail with an exception when used with L=8
  (GH #1631 #1632)
* The default bcrypt work factor has been increased from 10 to 12.
* The default algorithm used in passhash9 has changed from SHA-256 to SHA-512,
  and the default work factor increased from 10 to 15.
* In ECC private keys, include the public key data for compatibility with
  GnuTLS (GH #1634 #1635)
* Add support for using Linux `getrandom` syscall to access the system PRNG.
  This is disabled by default, use `--with-os-feature=getrandom` to enable.
* It is now possible to encrypt private keys using SIV mode.
* The FFI function botan\_privkey\_load now ignores its rng argument.
* Resolve a problem when building under Visual C++ 15.8 (GH #1624)
* Fix a bug in XSalsa20 (192-bit Salsa nonces) where if set\_iv was called twice
  without calling set\_key, the resulting encryption was incorrect. (GH #1640)
* Handle an error seen when verifying invalid ECDSA signatures using LibreSSL
  on non x86-64 platforms (GH #1627 #1628)
* Fix bugs in PKCS7 and X9.23 CBC padding schemes, which would ignore
  the first byte in the event the padding took up the entire block. (GH #1690)
* Correct bugs which would cause CFB, OCB, and GCM modes to crash when they
  were used in an unkeyed state. (GH #1639)
* Optimizations for SM4 and Poly1305
* Avoid a cache side channel in the AES key schedule
* Add `pk_encrypt` and `pk_decrypt` CLI operations
* Now `asn1print` CLI defaults to printing context-specific fields.
* Use codec\_base for Base64, which matches how Base32 is implemented (GH #1597)
* The `cast` module has been split up into `cast128` and `cast256` (GH #1685)
* When building under Visual C++ 2013, the user must acknowledge the upcoming
  removal of support using the configure.py flag `--ack-vc2013-deprecated`
  (GH #1557)

## Version 2.7.0, 2018-07-02[Â¶](#version-2-7-0-2018-07-02 "Link to this heading")

* CVE-2018-12435 Avoid a side channel in ECDSA signature generation (GH #1604)
* Avoid a side channel in RSA key generation due to use of a non-constant time
  gcd algorithm. (GH #1542 #1556)
* Optimize prime generation, especially improving RSA key generation. (GH #1542)
* Make Karatsuba multiplication, Montgomery field operations, Barrett reduction
  and Montgomery exponentiation const time (GH #1540 #1606 #1609 #1610)
* Optimizations for elliptic curve operations especially improving reductions
  and inversions modulo NIST primes (GH #1534 #1538 #1545 #1546 #1547 #1550)
* Add 24 word wide Comba multiplication, improving 3072-bit RSA and DH by ~25%.
  (GH #1564)
* Unroll Montgomery reduction for specific sizes (GH #1603)
* Improved performance of signature verification in ECGDSA, ECKCDSA,
  SM2 and GOST by 10-15%.
* XMSS optimizations (GH #1583 #1585)
* Fix an error that meant XMSS would only sign half as many signatures as is
  allowed (GH #1582)
* Add support for base32 encoding/decoding (GH #1541)
* Add BMI2 optimized version of SHA-256, 40% faster on Skylake (GH #1584)
* Allow the year to be up to 2200 in ASN.1 time objects. Previously this
  was limited to 2100. (GH #1536)
* Add support for Scrypt password hashing (GH #1570)
* Add support for using Scrypt for private key encryption (GH #1574)
* Optimizations for DES/3DES, approx 50% faster when used in certain modes such
  as CBC decrypt or CTR.
* XMSS signature verification did not check that the signature was of
  the expected length which could lead to a crash. (GH #1537)
* The bcrypt variants 2b and 2y are now supported.
* Support for 192-bit Suite B TLS profile is now implemented, as the 128-bit
  Suite B is since 2015 not allowed anymore.
* Previously botan allowed GCM to be used with an empty nonce, which is not
  allowed by the specification. Now such nonces are rejected.
* Avoid problems on Windows when compiling in Unicode mode (GH #1615 #1616)
* Previously for ASN.1 encoded signatures (eg ECDSA) Botan would accept any
  valid BER encoding. Now only the single valid DER encoding is accepted.
* Correct an error that could in rare cases cause an internal error exception
  when doing computations with the P-224 curve.
* Optimizations to reduce allocations/copies during DER encoding and BER
  decoding (GH #1571 #1572 #1600)
* Botan generates X.509 subject key IDs by hashing the public key with whatever
  hash function is being used to sign the certificate. However especially for
  SHA-512 this caused SKIDs that were far longer than necessary. Now all SKIDs
  are truncated to 192 bits.
* In the test suite use `mkstemp` to create temporary files instead of
  creating them in the current working directory. (GH #1533 #1530)
* It is now possible to safely override `CXX` when invoking make in addition
  to when `configure.py` is run. (GH #1579)
* OIDs for Camellia and SM4 in CBC and GCM mode are now defined, making it
  possible to use this algorithms for private key encryption.
* Avoid creating symlinks to the shared object on OpenBSD (#1535)
* The `factor` command runs much faster on larger inputs now.
* Support for Windows Phone/UWP was deprecated starting in 2.5. This deprecation
  has been reversed as it seems UWP is still actively used. (GH #1586 #1587)
* Support for Visual C++ 2013 is deprecated, and will be removed in Jan 2019.
* Added support for GCCâs âsysroot option to configure.py for cross-compiling.

## Version 2.6.0, 2018-04-10[Â¶](#version-2-6-0-2018-04-10 "Link to this heading")

* CVE-2018-9860 Fix a bug decrypting TLS CBC ciphertexts which could
  for a malformed ciphertext cause the decryptor to read and HMAC an
  additional 64K bytes of data which is not part of the record. This
  could cause a crash if the read went into unmapped memory. No
  information leak or out of bounds write occurs.
* Add support for OAEP labels (GH #1508)
* RSA signing is about 15% faster (GH #1523) and RSA verification is
  about 50% faster.
* Add exponent blinding to RSA (GH #1523)
* Add `Cipher_Mode::create` and `AEAD_Mode::create` (GH #1527)
* Fix bug in TLS server introduced in 2.5 which caused connection to
  fail if the client offered any signature algorithm not known to the
  server (for example RSA/SHA-224).
* Fix a bug in inline asm that would with GCC 7.3 cause incorrect
  computations and an infinite loop during the tests. (GH #1524 #1529)

## Version 2.5.0, 2018-04-02[Â¶](#version-2-5-0-2018-04-02 "Link to this heading")

* Fix error in certificate wildcard matching (CVE-2018-9127), where a
  wildcard cert for `b*.example.com` would be accepted as a match for
  any host with name `*b*.example.com` (GH #1519)
* Add support for RSA-PSS signatures in TLS (GH #1285)
* Ed25519 certificates are now supported (GH #1501)
* Many optimizations in ECC operations. ECDSA signatures are 8-10 times faster.
  ECDSA verification is about twice as fast. ECDH key agreement is 3-4 times
  faster. (GH #1457 #1478)
* Implement product scanning Montgomery reduction, which improves Diffie-Hellman
  and RSA performance by 10 to 20% on most platforms. (GH #1472)
* DSA signing and verification performance has improved by 30-50%.
* Add a new Credentials\_Manager callback that specifies which CAs the server
  has indicated it trusts (GH #1395 fixing #1261)
* Add new TLS::Callbacks methods that allow creating or removing extensions,
  as well as examining extensions sent by the peer (GH #1394 #1186)
* Add new TLS::Callbacks methods that allow an application to
  negotiate use of custom elliptic curves. (GH #1448)
* Add ability to create custom elliptic curves (GH #1441 #1444)
* Add support for POWER8 AES instructions (GH #1459 #1393 #1206)
* Fix DSA/ECDSA handling of hashes longer than the group order (GH #1502 #986)
* The default encoding of ECC public keys has changed from compressed
  to uncompressed point representation. This improves compatibility with
  some common software packages including Golangâs standard library.
  (GH #1480 #1483)
* It is now possible to create DNs with custom components. (GH #1490 #1492)
* It is now possible to specify the serial number of created certificates,
  instead of using the default 128-bit random integer. (GH #1489 #1491)
* Change DL\_Group and EC\_Group to store their data as shared\_ptr for
  fast copying. Also both classes precompute additional useful values
  (eg for modular reductions). (GH #1435 #1454)
* On Windows platforms RtlGenRandom is now used in preference to CryptoAPI
  or CryptoNG libraries. (GH #1494)
* Make it possible for PKCS10 requests to include custom extensions. This also
  makes it possible to use multiple SubjectAlternativeNames of a single type in
  a request, which was previously not possible. (GH #1429 #1428)
* Add new optimized interface for FE1 format preserving encryption. By caching a
  number of values computed in the course of the FPE calculation, it provides a
  6-7x speedup versus the old API. (GH #1469)
* Add DSA and ElGamal keygen functions to FFI (#1426)
* Add `Pipe::prepend_filter` to replace deprecated `Pipe::prepend` (GH #1402)
* Fix a memory leak in the OpenSSL block cipher integration, introduced in 2.2.0
* Use an improved algorithm for generating safe primes which is several tens of
  times faster. Also, fix a bug in the prime sieving algorithm which caused
  standard prime generation (like for RSA keys) to be slower than necessary.
  (GH #1413 #1411)
* Correct the return value of `PK_Encryptor::maximum_input_size` which
  reported a much too small value (GH #1410)
* Remove use of CPU specific optimization flags, instead the user should set
  these via CXXFLAGS if desired. (GH #1392)
* Resolve an issue that would cause a crash in the tests if they were run on
  a machine without SSE2/NEON/VMX instructions. (GH #1495)
* The Python module now tries to load DLLs from a list of names and
  uses the first one which successfully loads and indicates it
  supports the desired API level. (GH #1497)
* Various minor optimizations for SHA-3 (GH #1433 #1434)
* The output of `botan --help` has been improved (GH #1387)
* Add `--der-format` flag to command line utils, making it possible verify
  DSA/ECDSA signatures generated by OpenSSL command line (GH #1409)
* Add support for `--library-suffix` option to `configure.py` (GH #1405 #1404)
* Use feature flags to enable/disable system specific code (GH #1378)
* Add `--msvc-runtime` option to allow using static runtime (GH #1499 #210)
* Add `--enable-sanitizers=` option to allow specifying which sanitizers to
  enable. The existing `--with-sanitizers` option just enables some default
  set which is known to work with the minimum required compiler versions.
* Use either `rst2man` or `rst2man.py` for generating man page as
  distributions differ on where this program is installed (GH #1516)
* The threefish module has been renamed threefish\_512 since that is the
  algorithm it provides. (GH #1477)
* The Perl XS based wrapper has been removed, as it was unmaintained and
  broken. (GH #1412)
* The sqlite3 encryption patch under `contrib` has been removed. It
  is still maintained by the original author at
  <https://github.com/OlivierJG/botansqlite3>
* Support for Windows Phone is deprecated.

## Version 2.4.0, 2018-01-08[Â¶](#version-2-4-0-2018-01-08 "Link to this heading")

* Several build improvements requested by downstream packagers, including the
  ability to disable building the static library. All makefile constructs that
  were specific to nmake or GNU make have been eliminated, thus the option
  `--makefile-style` which was previously used to select the makefile type has
  also been removed. (GH #1230 #1237 #1300 #1318 #1319 #1324 #1325 #1346)
* Support for negotiating the DH group as specified in RFC 7919 is now available
  in TLS (GH #1263)
* Support for ARIA-GCM ciphersuites are now available in TLS. They are disabled
  by default. (GH #1284)
* Add support for generating and verifying X.509 objects (certificates, CRLs,
  etc) using RSA-PSS signatures (GH #1270 and #1368)
* Add support for AES key wrapping with padding, as specified in RFC 5649 and
  NIST SP 800-38F (GH #1301)
* OCSP requests made during certificate verification had the potential to hang
  forever. Now the sockets are non-blocking and a timeout is enforced. (GH #1360
  fixing GH #1326)
* Add `Public_Key::fingerprint_public` which allows fingerprinting the public key.
  The previously available `Private_Key::fingerprint` is deprecated, now
  `Private_Key::fingerprint_private` should be used if this is required.
  (GH #1357)
* ECC certificates generated by Botan used an invalid encoding for the
  parameters field, which was rejected by some certificate validation libraries
  notably BouncyCastle. (GH #1367)
* Loading an ECC key which used OID encoding for the domain parameters, then
  saving it, would result in a key using the explicit parameters encoding.
  Now the OID encoding is retained. (GH #1365)
* Correct various problems in certificate path validation that arose when
  multiple paths could be constructed leading to a trusted root but due to
  other constraints only some of them validated. (GH #1363)
* It is now possible for certificate validation to return warning indicators,
  such as that the distinguished name is not within allowed limits or that a
  certificate with a negative serial number was observed. (GH #1363 #1359)
* XMSS signatures now are multi-threaded for improved performance (GH #1267)
* Fix a bug that caused the TLS peer cert list to be empty on a resumed session.
  (GH #1303 #1342)
* Increase the maximum HMAC key length from 512 bytes to 4096 bytes. This allows
  using a DH key exchange in TLS with a group greater than 4096 bits. (GH #1316)
* Fix a bug in the TLS server where, on receiving an SSLv3 client hello, it
  would attempt to negotiate TLS v1.2. Now a protocol\_version alert is sent.
  Found with tlsfuzzer. (GH #1316)
* Fix several bugs related to sending the wrong TLS alert type in various error
  scenarios, caught with tlsfuzzer.
* Add support for a `tls_http_server` command line utility which responds to
  simple GET requests. This is useful for testing against a browser, or various
  TLS test tools which expect the underlying protocol to be HTTP. (GH #1315)
* Add an interface for generic PSK data stores, as well as an implementation
  which encrypts stored values with AES key wrapping. (GH #1302)
* Optimize GCM mode on systems both with and without carryless multiply
  support. This includes a new base case implementation (still constant time), a
  new SSSE3 implementation for systems with SSSE3 but not clmul, and better
  algorithms for systems with clmul and pmull. (GH #1253 #1263)
* Various optimizations for OCB, CFB, CTR, SM3, SM4, GMAC, BLAKE2b, Blowfish,
  Twofish, CAST-128, and CRC24 (GH #1281)
* Salsa20 now supports the seek operation.
* Add `EC_Group::known_named_groups` (GH #1339)
* Symmetric algorithms (block ciphers, stream ciphers, MACs) now verify that a
  key was set before accepting data. Previously attempting to use an unkeyed
  object would instead result in either a crash or invalid outputs. (GH #1279)
* The X509 certificate, CRL and PKCS10 types have been heavily refactored
  internally. Previously all data of these types was serialized to strings, then
  in the event a more complicated data structure (such as X509\_DN) was needed,
  it would be recreated from the string representation. However the round trip
  process was not perfect and could cause fields to become lost. This approach
  is no longer used, fixing several bugs (GH #1010 #1089 #1242 #1252). The
  internal data is now stored in a `shared_ptr`, so copying such objects is
  now very cheap. (GH #884)
* ASN.1 string objects previously held their contents as ISO 8859-1 codepoints.
  However this led to certificates which contained strings outside of this
  character set (eg in Cyrillic, Greek, or Chinese) being rejected. Now the
  strings are always converted to UTF-8, which allows representing any
  character. In addition, UCS-4 strings are now supported.
  (GH #1113 #1250 #1287 #1289)
* It is now possible to create an uninitialized X509\_Certificate object. Such an
  object will throw if any attempt to access its members is made. (GH #1335)
* In BER decoder, avoid unbounded stack recursion when parsing nested indefinite
  length values. Now at most 16 nested indefinite length values are accepted,
  anything deeper resulting in a decoding error. (GH #1304 OSS-Fuzz 4353).
* A new ASN.1 printer API allows generating a string representation of arbitrary
  BER data. This is used in the `asn1print` command line utility and may be
  useful in other applications, for instance for debugging.
* New functions for bit rotations that distinguish rotating by a compile-time
  constant vs a runtime variable rotation. This allows better optimizations in
  both cases. Notably performance of CAST-128 and CAST-256 are substantially
  improved. (GH #1247)
* TLS CBC ciphersuites now are implemented using the standard CBC code, instead
  of reimplementing CBC inside the TLS stack. This allows for parallel
  decryption of TLS CBC ciphertexts, and improves performance especially when
  using AES hardware support. (GH #1269)
* Add callbacks to make it possible for an application using TLS to provide
  custom implementations of signature schemes, eg when offloading the
  computations to another device. (GH #1332)
* Use a direct calculation for calendar computations instead of relying on
  non-portable operating system interfaces. (GH #1336)
* Fix a bug in the amalgamation generation which could cause build failures on
  some systems including macOS. (GH #1264 #1265)
* A particular code sequence in TLS handshake would always (with an ECC
  ciphersuite) result in an exception being thrown and then caught. This has
  changed so no exception is thrown. (GH #1275)
* The code for byteswapping has been improved for ARMv7 and for Windows x86-64
  systems using MSVC. (GH #1274)
* The GMAC class no longer derives from GHASH. This should not cause any
  noticeable change for applications. (GH #1253)
* The base implementation of AES now uses a single 4K table, instead of 4 such
  tables. This offers a significant improvement against cache-based side
  channels without hurting performance too much. In addition the table is now
  guaranteed to be aligned on a cache line, which ensures the additional
  countermeasure of reading each cache line works as expected. (GH #1255)
* In TLS client resumption, avoid sending a OCSP stapling request. This caused
  resumption failures with some servers. (GH #1276)
* The overhead of making a call through the FFI layer has been reduced.
* The IDs for SHA-3 PKCSv1.5 signatures added in 2.3.0 were incorrect. They have
  been changed to use the correct encoding, and a test added to ensure such
  errors do not recur.
* Counter mode allows setting a configurable width of the counter. Previously it
  was allowed for a counter of even 8 bits wide, which would mean the keystream
  would repeat after just 256 blocks. Now it requires the width be at least 32
  bits. The only way this feature could be used was by manually constructing a
  `CTR_BE` object and setting the second parameter to something in the range
  of 1 to 3.
* A new mechanism for formatting ASN.1 data is included in `asn1_print.h`.
  This is the same functionality used by the command line `asn1print` util,
  now cleaned up and moved to the library.
* Add `Pipe::append_filter`. This is like the existing (deprecated)
  `Pipe::append`, the difference being that `append_filter` only
  allows modification before the first call to `start_msg`. (GH #1306 #1307)
* The size of ASN1\_Tag is increased to 32 bits. This avoids a problem
  with UbSan (GH #751)
* Fix a bug affecting bzip2 compression. In certain circumstances, compression
  would fail with `BZ_SEQUENCE_ERROR` due to calling bzlib in an way it does
  not support. (GH #1308 #1309)
* In 2.3.0, final annotations were added to many classes including the TLS
  policies (like `Strict_Policy` and `BSI_TR_02102_2`). However it is
  reasonable and useful for an application to derive from one of these policies, so
  as to create an application specific policy that is based on a library-provided
  policy, but with a few tweaks. So the final annotations have been removed on
  these classes. (GH #1292)
* A new option `--with-pdf` enables building a PDF copy of the handbook.
  (GH #1337)
* A new option `--with-rst2man` enables building a man page for the
  command line util using Docutils rst2man. (GH #1349)
* Support for NEON is now enabled under Clang.
* Now the compiler version is detected using the preprocessor, instead of trying
  to parse the output of the compilerâs version string, which was subject to
  problems with localization. (GH #1358)
* By default the gzip compressor will not include a timestamp in the header.
  The timestamp can be set by passing it to the `Gzip_Compression`
  constructor.
* Resolve a performance regression on Windows involving the system stats
  entropy source. (GH #1369)
* Add an OID for RIPEMD-160
* Fixes for CMake build (GH #1251)
* Avoid some signed overflow warnings (GH #1220 #1245)
* As upstream support for Native Client has been deprecated by Google, support
  is now also deprecated in Botan and will be removed in a future release.
* The Perl-XS wrapper has not been maintained in many years. It is now deprecated,
  and if no attempts are made to revive it, it will be removed in a future release.
* Support for building on IRIX has been removed.

## Version 2.3.0, 2017-10-02[Â¶](#version-2-3-0-2017-10-02 "Link to this heading")

* Address a side channel affecting modular exponentiation. An attacker
  capable of a local or cross-VM cache analysis attack may be able
  to recover bits of secret exponents as used in RSA, DH, etc.
  CVE-2017-14737
* Add the SHACAL2 block cipher, including optimizations using SIMD and SHA-NI
  instructions. (GH #1151)
* Add the ARIA block cipher (GH #1004 and #1157)
* Add support for the ARMv8 AES instructions (GH #1182 and #1146)
* Add support for the ARMv8 PMULL instruction (GH #1181 and #842)
* On macOS and iOS the `System_RNG` class is now implemented using `arc4random`.
  Previously the system RNG class was not available on iOS. (GH #1219)
* Optimized the CMAC polynomial doubling operation, and removed a small timing
  channel due to a conditional operation.
* Added support for the ECDHE\_PSK AEAD TLS ciphersuites from
  draft-ietf-tls-ecdhe-psk-aead-05.
* SM2 encryption and signature schemes were previously hardcoded to use SM3
  hash, now any hash is allowed. (GH #1188)
* SM2 encryption in 2.2.0 followed an obsolete version of the standard. The
  format of the ciphertext changed in a more recent revision of the standard,
  and now uses an ASN.1 encoding. Botan has changed to reflect this format,
  which is compatible with GmSSL (GH #1218)
* OCB mode now supports 192, 256 and 512 bit block ciphers. (GH #1205)
* XTS mode now supports 256-bit and 512-bit block ciphers.
* Add ids to allow SHA-3 signatures with PKCSv1.5 (GH #1184)
* Add support for `PSSR_Raw` signatures which PSS sign an externally derived
  hash. (GH #1212 #1211)
* GCM now supports truncated tags in the range 96â¦128 bits. GCM had
  previously supported 64-bit truncated tags, but these are known to
  be insecure and are now deprecated. (GH #1210 #1207)
* Add a new TLS policy hook `allow_client_initiated_renegotiation` which is the
  parallel of the existing `allow_server_initiated_renegotiation`. If set to
  false, servers will reject attempts by the client to renegotiation the
  session, instead sending a `no_renegotiation` warning alert. Note that the
  default is `false`, ie that client renegotiation is now prohibited by default.
  (GH #872)
* Add HKDF-Expand-Label function which is used in TLS v1.3 and QUIC protocols.
  (GH #1226)
* Fix decoding of ECC keys that use extensions from RFC 5915 (GH #1208)
* The entropy source that called CryptGenRandom has been removed, and
  replaced by a version which invokes the system PRNG, which may
  be CryptGenRandom or some other source. (GH #1180)
* Add support for gathering entropy using the Crypt-NG BCryptGenRandom
  API. This is necessary to build for Windows Phone/Windows Store. (GH #1180)
* Extend âRawâ signature padding (which allows signing a hash computed
  externally) to optionally take a hash function name. In this case, it will be
  verified that the input matches the expected hash size. This also will
  control the hash algorithm used for RFC 6979 deterministic nonces; previously
  SHA-512 was always used for RFC 6979 nonces with âRawâ. (GH #1153)
* The advertised FFI API version has increased. This should have happened
  already in 2.2 but was neglected. The `botan_ffi_supports_api` call will
  return true for either the current or older versions of the API version since
  no backwards incompatible changes have occurred.
* Add new C89 API functions `botan_hex_decode`, `botan_base64_encode`,
  `botan_base64_decode`, `botan_constant_time_compare`.
* Add new C89 API functions `botan_privkey_load_dh`, `botan_pubkey_load_dh`,
  and `botan_privkey_create_dh` (GH #1155)
* Add `is_passhash9_alg_supported` (GH #1154)
* The `power_mod` function now supports negative bases (GH #1179 #1168)
* Add a new command line utility for examining TLS client hellos.
* Added a new target for LLVM bitcode (GH #1169)
* Improve support for Windows Phone (GH #1180 #796 #794)
* Correct return value of `botan_pk_op_verify_finish`. In 2.2.0 this function
  returned -1 on invalid signature, instead of 1 which was used in 2.0, 2.1, and
  now again in 2.3. (GH #1189 #1187)
* Allow loading unencrypted private keys via FFI API (GH #1197)
* Add new command line options `--rng-type=drbg` and `--drbg-seed` which
  allow running commands with a deterministic RNG. (GH #1169)
* Fix a number of warnings seen under Visual C++ (GH #1171 #795)
* Workaround a GCC 7 bug that caused miscompilation of the GOST-34.11 hash
  function on x86-32. (GH #882 #1148)
* Fix a bug in SIMD\_4x32 which affected little-endian PowerPC processors.
  This would cause test failures for Serpent, among other problems.
* Fix Altivec runtime detection, which was broken starting in Botan 2.1.0
* Optimized the verification of TLS CBC padding bytes. Previously the check
  examined every byte of the record, even though at most 256 bytes of padding
  may be appended. (GH #1227)
* Simplified definition of `Botan::secure_allocator`. In particular, not
  defining the `construct` and `destroy` methods avoids a performance problem
  under MSVC. (GH #1228 and #1229)
* The `secure_allocator` class now uses `calloc` and `free` instead of
  `new` and `delete`. In addition the actual allocation operation is hidden
  inside of compiled functions, which significantly reduces code size. (GH #1231)
* The `secure_scrub_memory` function now uses `explicit_bzero` on OpenBSD.
* Previously ARM feature detection (NEON, AES, â¦) relied on getauxval, which
  is only supported on Linux and Android. Now iOS is supported, by checking the
  model name/version and matching it against known versions. Unfortunately this
  is the best available technique on iOS. On Aarch64 systems that are not iOS or
  Linux/Android, a technique based on trial execution while catching SIGILL is
  used. (GH #1213)
* The output of `botan config libs` was incorrect, it produced `-lbotan-2.X`
  where X is the minor version, instead of the actual lib name `-lbotan-2`.
* Add `constant_time_compare` as better named equivalent of `same_mem`.
* Silence a Clang warning in `create_private_key` (GH #1150)
* The fuzzers have been better integrated with the main build. See the
  handbook for details. (GH #1158)
* The Travis CI and AppVeyor CI builds are now run via a Python script. This
  makes it easier to replicate the behavior of the CI build locally. Also a
  number of changes were made to improve the turnaround time of CI builds.
  (GH #1162 #1199)
* Add support for Win32 filesystem operation, so the tests pass completely
  on MinGW now (GH #1203)
* Added a script to automate running TLS-Attacker tests.
* The distribution script now creates reproducible outputs, by
  forcing all modification times, uids, etc to values fixed by the release date.
  (GH #1217)
* The `BOTAN_DLL` macro has been split up into `BOTAN_PUBLIC_API`,
  `BOTAN_UNSTABLE_API` and `BOTAN_TEST_API` which allows
  indicating in the header the API stability of the export. All three
  are defined as `BOTAN_DLL` so overriding just that macro continues
  to work as before. (GH #1216)
* Optimize `bigint_divop` when a double-word type is available. (GH #494)
* Fix several memory leaks in the tests. Additionally a false positive
  leak seen under `valgrind` in the `fork` tests for the RNG was resolved.
* Export `CurveGFp_Repr` type (only used internally) to resolve a
  long standing UBSan warning. (GH #453)
* Now `-fstack-protector` and similar flags that affect linking are exported
  in `botan config ldflags` as they already were in the `pkg-config` output.
  (GH #863)
* Remove double underscore in header guards to avoid using names
  reserved by ISO C++. (GH #512)
* Additions to the SRP documentation (GH #1029)
* The package transform (in `package.h`) is now deprecated, and will be
  removed in a future release. (GH #1215)
* Add more tests for the const-time utils (GH #1214)
* Fix a bug in FFI tests that caused the test files not to be found when using
  `--data-dir` option (GH #1149)
* C++ `final` annotations have been added to classes which are not
  intended for derivation. This keyword was already in use but was not
  applied consistently.
* A typedef `SecureVector` has been added for the `secure_vector` type.
  This makes porting code from 1.10 to 2.x API slightly simpler.
* Header files have been cleaned up to remove unnecessary inclusions. In some
  cases it may be required to include additional botan headers to get all the
  declarations that were previously visible. For example, `bigint.h` no longer
  includes `rng.h`, but just forward declares `RandomNumberGenerator`.
* Improved support for IBM xlc compiler.

## Version 2.2.0, 2017-08-07[Â¶](#version-2-2-0-2017-08-07 "Link to this heading")

* Add the Ed25519 signature scheme (GH #1066)
* The format of x25519 keys, which previously used a non-standard encoding,
  has changed to match the upcoming IETF specification. (GH #1076)
* Add the SM2 signature scheme (GH #1082)
* Add the SM2 public key encryption scheme (GH #1142)
* Add the SM3 hash function (GH #996)
* Add the Streebog (GOST R 34.11-2012) hash function (GH #1114)
* Add the SM4 block cipher (GH #1080)
* Add the PGP S2K algorithm (GH #1060)
* Add SP 800-56A KDF (GH #1040)
* Add ChaCha\_RNG which is a very fast and completely non-standard
  random bit generator (GH #1137)
* Add support for SHA-1 and SHA-2 instructions added in Intel Goldmont
  (GH #826)
* Add support for SHA-1 and SHA-2 instructions added in ARMv8 (GH #844)
* Add support for HOTP (RFC 4226) and TOTP (RFC 6238)
  one-time-password algorithms (GH #1054)
* Fix a bug that caused secure\_allocator to not fully zeroize blocks
  when sizeof(T) was greater than 1.
* Add HashFunction::copy\_state which allows efficiently computing the
  hash of several messages with a common prefix (GH #1056 #1037)
* ECC keys now encode their parameters using an OID instead of a literal
  encoding of the domain parameters. This will lead to smaller public and
  private keys in most instances. (GH #1093)
* The OpenSSL backend now supports the 1.1.0 API (GH #1056)
* Add a preliminary provider using BearSSL, currently EC and hashes supported
  (GH #1094)
* Fix a bug in certificate path length checking that could cause valid
  chains to be rejected. (GH #1053)
* It is possible for CBC, CFB, and stream ciphers to carry over the
  nonce from the previous message, which is needed by some applications.
  This worked in 1.10 but broke in 2.0. (GH #1044 fixing GH #864)
* Avoid recursion in BER\_Decoder::get\_next\_object which could cause
  stack exhaustion. (GH #989)
* Fix missing flush in DataSink\_Stream::end\_msg. (GH #972 fixing GH #972)
* Allow to seek in the big endian counter mode of operation (GH #999)
* Support loading ElGamal keys through FFI interface (GH #1008)
* Support Windows sockets in `http_util` (allowing OCSP checks on Windows),
  as well as in the TLS command line utils (GH #1138).
* The `--destdir` flag to `configure.py` has been removed. Instead use
  the `DESTDIR` environment variable at install time. This change was
  done to more closely match how autoconf handles this case.
  (GH #1139 #1111 #997 #996).
* Many changes to configure.py and botan2.py to make them pylint clean
  (GH #1041 #1002 #984)
* Add command line utils `hmac` (GH #1001), `encryption` (GH #359),
  `hex_enc`, and `hex_dec`.
* Fix an error in `sign_cert` command line util, which ignored the
  `--ca-key-pass` option. (GH #1106)
* The `speed` util can now benchmark multiple buffer sizes (GH #1084)
* Fix return value of FFI botan\_bcrypt\_is\_valid (GH #1033)
* Support generating RSA keys using OpenSSL (GH #1035)
* Add new FFI functions botan\_hash\_block\_size (GH #1036),
  botan\_hash\_copy\_state (GH #1059), botan\_scrub\_mem
* Add support for RFC 3394 keywrap through FFI (GH #1135)
* Support AES-CBC ciphers via OpenSSL (GH #1022)
* Add function to return certificates included in OCSP response (GH #1123)
* Complete wildcard handling for X.509 certificates (GH #1017)
* Add some missing functions to TLS::Text\_Policy (GH #1023)
* It was previously possible to use `--single-amalgamation-file`
  without `--amalgamation`, though it did not do anything useful. Now
  `--single-amalgamation-file` requires `--amalgamation` also be set
  on the command line.

## Version 2.1.0, 2017-04-04[Â¶](#version-2-1-0-2017-04-04 "Link to this heading")

* Fix incorrect truncation in Bcrypt. Passwords in length between 56 and 72
  characters were truncated at 56 characters. Found and reported by Solar Designer.
  (CVE-2017-7252) (GH #938)
* Fix a bug in X509 DN string comparisons that could result in out of bound
  reads. This could result in information leakage, denial of service, or
  potentially incorrect certificate validation results. Found independently
  by Cisco Talos team and OSS-Fuzz. (CVE-2017-2801)
* Correct minimum work factor for Bcrypt password hashes. All other
  implementations require the work factor be at least 4. Previously Botan simply
  required it be greater than zero. (GH #938)
* Converge on a single side channel silent EC blinded multiply algorithm.
  Uses Montgomery ladder with order/2 bits scalar blinding and point randomization
  now by default. (GH #893)
* Add ability to search for certificates using the SHA-256 of the distinguished name.
  (GH #900)
* Support a 0-length IV in ChaCha stream cipher. Such an IV is treated
  identically to an 8-byte IV of all zeros.
* Add new interfaces to the C API including multiple precision integers, key
  validity tests, block ciphers, and extracting algorithm specific key parameters
  (such as the modulus and public exponent from RSA public keys). GH #899 #944
  #946 #961 #964
* The PKCS11 module did not require any external dependencies, so it
  has been enabled by default. The `--with-pkcs11` and `--without-pkcs11`
  flags to `configure.py` have been removed. PKCS11 can still be disabled
  using `--disable-modules=pkcs11` (GH #837)
* Add `OS::run_cpu_instruction_probe` for runtime probing of ISA extensions.
  Supporting this requires system-specific techniques, currently Windows SEH and
  Unix signal handling are supported.
* Add support for ARM NEON in the SIMD\_4x32 type
* Add support for ARM CPU feature detection using getauxval (GH #843)
* Previously Botan forbid any use of times past 2037 to avoid Y2038 issues.
  Now this restriction is only in place on systems which have a 32-bit
  `time_t`. (GH #933 fixing #917)
* Add generic type decoder function to BER decoder (GH #897)
* Fix portability or build problems affecting Sun Studio compiler (GH #846),
  Solaris, ppc64le, DragonflyBSD (GH #887)
* Add `--with-external-libdir` to configure.py (GH #857 fixing #19 #767)
* Add `OS::get_high_resolution_clock` which returns the best resolution
  clock available on the system.
* Change `OS::get_processor_timestamp` to return 0 if no hardware
  cycle counter is available. Previously it silently fell back on some
  other clock type.
* Report cycles/byte in the output of `botan speed`.
* Add speed tests for modular exponentiations and ECC scalar multiplies.
* Avoid using IP address for SNI in `tls_client`. (GH #942)
* Add command line util `timing_test` which enables running
  timing-based side channel analysis of TLS CBC decryption, ECC scalar
  multiplies, OAEP decoding, and other operations which are prone to
  providing an oracle via side channel. This replaces the standalone
  timing test suite added in 1.11.34, which has been removed.
* Various cleanups and refactorings (GH #965)
* Add wrapper of C++14 make\_unique (GH #974)
* Fix pkg-config output when âbuild-dir was used (GH #936)
* Make it possible to disable -fstack-protector using a build-time flag.
  GH #863
* Add tests for TLS DSA ciphersuites, more Noekeon tests, others.
* Avoid a GCC warning that triggered on the public key types (GH #849)
* Fix various warnings flagged by pylint and pyflakes linters in
  configure.py and botan.py (GH #832 #836 #839 #962 #975)
* Improve support for OpenBSD including using getentropy (GH #954)
  for PRNG seeding, and arc4random to access system RNG (GH #953)
* Add ability to build through CMake. As of now this is only supported
  for development rather than production builds. (GH #967)
* Rename python wrapper to botan2.py (GH #847)
* Change name constraint test to use a fixed reference time. Test certs have expired.
* Increase Miller-Rabin iterations for DSA primes to match FIPS 186-4. (GH #881)
* Fix possible ISO 9796-2 padding side channel, and add a missing length check (GH #891)
* In command line utility, prefer the system RNG if it is available.

## Version 2.0.1, 2017-01-09[Â¶](#version-2-0-1-2017-01-09 "Link to this heading")

* Change an unintended behavior of 2.0.0, which named the include
  directory `botan-2.0`. Since future release of Botan-2 should be
  compatible with code written against old versions, there does not
  seem to be any reason to version the include directory with the
  minor number. (GH #830 #833)
* Fix a bug which caused an error when building on Cygwin or
  other platforms where shared libraries are not supported.
  (GH #821)
* Enable use of readdir on Cygwin, which allows the tests to run (GH #824)
* Switch to readthedocs Sphinx theme by default (GH #822 #823)

## Version 2.0.0, 2017-01-06[Â¶](#version-2-0-0-2017-01-06 "Link to this heading")

* With this release the project adopts Semantic Versioning (GH #766)
* Fix a longstanding bug in modular exponentiation which caused most
  exponentiations modulo an even number to have an incorrect result; such moduli
  occur only rarely in cryptographic contexts. (GH #754)
* Fix a bug in BigInt multiply operation, introduced in 1.11.30, which could
  cause incorrect results. Found by OSS-Fuzz fuzzing the ressol function, where
  the bug manifested as an incorrect modular exponentiation. OSS-Fuzz bug #287
* Fix a bug that meant the âietf/modp/6144â and âietf/modp/8192â discrete log
  groups used an incorrect value for the generator, specifically the value
  (p-1)/2 was used instead of the correct value of 2.
* The DL\_Group enum value X942\_DH\_PARAMETERS has been renamed
  ANSI\_X9\_42\_DH\_PARAMETERS to avoid a conflict with Windows headers (GH #482)
* Change default PEM header for X942 DH to match OpenSSL. Either version is
  accepted on reading. (GH #818)
* DL\_Group strong generation previously set the generator to 2. However
  sometimes 2 generates the entire group mod p, rather than the subgroup mod q.
  This is invalid by X9.42 standard, and exposes incautious applications to
  small subgroup attacks. Now DL\_Group uses the smallest g which is a quadratic
  residue. (GH #818)
* Add iOS build target instead of piggybacking on OS X configuration. (GH #793)
* Changes all Public\_Key derived class ctors to take a std::vector instead of a
  secure\_vector for the DER encoded public key bits. (GH #768)
* Allow use of custom extensions when creating X.509 certificates (GH #744)
* The default TLS policy now requires 2048 or larger DH groups by default.
* Add BSI\_TR\_02102\_2 TLS::Policy subclass representing BSI TR-02102-2 recommendations.
* The default Path\_Validation\_Restrictions constructor has changed to
  require at least 110 bit signature strength. This means 1024 bit RSA
  certificates and also SHA-1 certificates are rejected by default.
  Both settings were already the default for certificate validation in
  TLS handshake, but this changes it for applications also.
* Add ISO 9796-2 signature padding schemes DS2 and DS3. These schemes provide
  message recovery (part or all of the plaintext message can be recovered from
  the signature alone) and are used by some industry protocols. (GH #759)
* Rewrite all the code that handles parsing CBC padding bytes to run without
  conditional jumps or loads. (GH #765 #728)
* Fix deref of invalid memory location in TLS client when the server chooses a
  ciphersuite value larger than the largest TLS ciphersuite ID compiled into the
  table. This might conceivably cause a crash in rare circumstances, but does
  not seem to be further exploitable. (GH #758)
* Rename Public\_Key::x509\_subject\_public\_key, which does not return a
  X.509 SubjectPublicKey, to public\_key\_bits. Add a new non-virtual function
  Public\_Key::subject\_public\_key which does exactly that. (GH #685 #757)
* Rename Private\_Key::pkcs8\_private\_key, which does not return a
  PKCS#8 private key, to private\_key\_bits. Add a new non-virtual function
  Private\_Key::private\_key\_info which does exactly that. (GH #685 #757)
* The deprecated ECB Cipher\_Mode class has been removed (GH #756)
* The class SRP6\_Authenticator\_File (in srp6\_files.h) was meant to parse GnuTLS
  SRP files. But it was completely untested, and it turns out due to several
  problems it was completely unable to parse any SRP file correctly. It has
  been removed, with a future replacement planned that can handle both
  flat files (in the actual SRP format) or using a SQL database.
* Fix tests errors when write access to /dev/urandom is prohibited (GH #748)
* Add more Diffie-Hellman tests (GH #790), tests for RSA blinding, others.
* Add tls\_ciphers command which prints the ciphersuites a client
  hello will contain, depending on the policy specified.
* Prevent TLS from negotiating SHA-2 ciphersuites in TLS v1.0/v1.1. These
  ciphersuites are technically not defined except for v1.2, so disable
  them in older protocols. (GH #496)
* Documentation: add project goals (GH #788) and side channel info (GH #787)

## Older Versions[Â¶](#older-versions "Link to this heading")

* The release notes for versions 0.7.0 through 1.11.34 can be found in
  `doc/old_news.rst`

### Table of Contents

* [Botan: Crypto and TLS for Modern C++](index.html)
* Release Notes
  + [Version 3.6.1, 2024-10-26](#version-3-6-1-2024-10-26)
  + [Version 3.6.0, 2024-10-21](#version-3-6-0-2024-10-21)
  + [Version 3.5.0, 2024-07-08](#version-3-5-0-2024-07-08)
  + [Version 3.4.0, 2024-04-08](#version-3-4-0-2024-04-08)
  + [Version 3.3.0, 2024-02-20](#version-3-3-0-2024-02-20)
  + [Version 3.2.0, 2023-10-09](#version-3-2-0-2023-10-09)
  + [Version 3.1.1, 2023-07-13](#version-3-1-1-2023-07-13)
  + [Version 3.1.0, 2023-07-11](#version-3-1-0-2023-07-11)
  + [Version 3.0.0, 2023-04-11](#version-3-0-0-2023-04-11)
    - [Breaking Changes](#breaking-changes)
    - [TLS Changes](#tls-changes)
    - [New Cryptographic Algorithms](#new-cryptographic-algorithms)
    - [New APIs](#new-apis)
    - [Implementation Improvements](#implementation-improvements)
    - [Other Improvements](#other-improvements)
  + [Version 2.19.5, 2024-07-08](#version-2-19-5-2024-07-08)
  + [Version 2.19.4, 2024-02-20](#version-2-19-4-2024-02-20)
  + [Version 2.19.3, 2022-11-16](#version-2-19-3-2022-11-16)
  + [Version 2.19.2, 2022-06-03](#version-2-19-2-2022-06-03)
  + [Version 2.19.1, 2022-01-21](#version-2-19-1-2022-01-21)
  + [Version 2.19.0, 2022-01-19](#version-2-19-0-2022-01-19)
  + [Version 2.18.2, 2021-10-25](#version-2-18-2-2021-10-25)
  + [Version 2.18.1, 2021-05-09](#version-2-18-1-2021-05-09)
  + [Version 2.18.0, 2021-04-15](#version-2-18-0-2021-04-15)
  + [Version 2.17.3, 2020-12-21](#version-2-17-3-2020-12-21)
  + [Version 2.17.2, 2020-11-13](#version-2-17-2-2020-11-13)
  + [Version 2.17.1, 2020-11-07](#version-2-17-1-2020-11-07)
  + [Version 2.17.0, 2020-11-05](#version-2-17-0-2020-11-05)
  + [Version 2.16.0, 2020-10-06](#version-2-16-0-2020-10-06)
  + [Version 2.15.0, 2020-07-07](#version-2-15-0-2020-07-07)
  + [Version 2.14.0, 2020-04-06](#version-2-14-0-2020-04-06)
  + [Version 2.13.0, 2020-01-06](#version-2-13-0-2020-01-06)
  + [Version 2.12.1, 2019-10-14](#version-2-12-1-2019-10-14)
  + [Version 2.12.0, 2019-10-07](#version-2-12-0-2019-10-07)
  + [Version 2.11.0, 2019-07-01](#version-2-11-0-2019-07-01)
  + [Version 2.10.0, 2019-03-30](#version-2-10-0-2019-03-30)
  + [Version 2.9.0, 2019-01-04](#version-2-9-0-2019-01-04)
  + [Version 2.8.0, 2018-10-01](#version-2-8-0-2018-10-01)
  + [Version 2.7.0, 2018-07-02](#version-2-7-0-2018-07-02)
  + [Version 2.6.0, 2018-04-10](#version-2-6-0-2018-04-10)
  + [Version 2.5.0, 2018-04-02](#version-2-5-0-2018-04-02)
  + [Version 2.4.0, 2018-01-08](#version-2-4-0-2018-01-08)
  + [Version 2.3.0, 2017-10-02](#version-2-3-0-2017-10-02)
  + [Version 2.2.0, 2017-08-07](#version-2-2-0-2017-08-07)
  + [Version 2.1.0, 2017-04-04](#version-2-1-0-2017-04-04)
  + [Version 2.0.1, 2017-01-09](#version-2-0-1-2017-01-09)
  + [Version 2.0.0, 2017-01-06](#version-2-0-0-2017-01-06)
  + [Older Versions](#older-versions)
* [Security Advisories](security.html)
* [User Guide](https://botan.randombit.net/handbook)
* [API Reference](https://botan.randombit.net/doxygen)

### Search

[previous](index.html "Botan: Crypto and TLS for Modern C++") |
[next](security.html "Security Advisories") |
[index](genindex.html "General Index")

Last updated on 2024-10-26.



=== Content from botan.randombit.net_1d45ecc2_20250125_114416.html ===

# Botan

# Security Advisories[Â¶](#security-advisories "Link to this heading")

If you think you have found a security bug in Botan please contact
Jack Lloyd (jack@randombit.net). If you would like to encrypt your
mail please use:

```
pub   rsa3072/57123B60 2015-03-23
      Key fingerprint = 4E60 C735 51AF 2188 DF0A  5A62 78E9 8043 5712 3B60
      uid         Jack Lloyd <jack@randombit.net>

```

This key can be found in the file `doc/pgpkey.txt` or online at
<https://keybase.io/jacklloyd> and on most PGP keyservers.

## 2024[Â¶](#id1 "Link to this heading")

* 2024-07-08 (CVE-2024-34702): Denial of Service Due to Excessive Name Constraints

  Checking name constraints in X.509 certificates is quadratic in the number of
  names and name constraints. An attacker who presented a certificate chain
  which contained a very large number of names in the SubjectAlternativeName,
  signed by a CA certificate which contained a large number of name constraints,
  could cause a denial of service.

  Introduced in 2.0.0, fixed in 2.19.5 and 3.5.0

  Found and reported by Bing Shi.
* 2024-07-08 (CVE-2024-39312): Authorization Error due to Name Constraint Decoding Bug

  A bug in the parsing of name constraint extensions in X.509 certificates meant
  that if the extension included both permitted subtrees and excluded subtrees,
  only the permitted subtree would be checked. If a certificate included a name
  which was permitted by the permitted subtree but also excluded by excluded
  subtree, it would be accepted.

  Introduced in 2.0.0, fixed in 2.19.5 and 3.5.0
* 2024-02-20: Kyber side channel

  The Kyber implementation was vulnerable to the KyberSlash1 and
  KyberSlash2 side channel issues.

  Introduced in 3.0.0, fixed in 3.3.0
* 2024-02-20 (CVE-2024-34703): DoS due to oversized elliptic curve parameters

  When decoding an ASN.1 encoded elliptic curve, Botan would verify the p
  parameter was actually prime, and at least some minimum size. However it
  failed to check if the prime was far too large (for example thousands of
  bits), in which case checking the prime would take a significant amount of
  computation. Now the maximum size of arbitrary elliptic curves when decoding
  from ASN.1 is limited.

  Reported by Bing Shi

  Fixed in 3.3.0 and 2.19.4

## 2022[Â¶](#id2 "Link to this heading")

* 2022-11-16 (CVE-2022-43705): Failure to correctly check OCSP responder embedded certificate

  OCSP responses for some end entity are either signed by the issuing CA certificate of
  the PKI, or an OCSP responder certificate that the PKI authorized to sign responses in
  their name. In the latter case, the responder certificate (and its validation path
  certificate) may be embedded into the OCSP response and clients must verify that such
  certificates are indeed authorized by the CA when validating OCSP responses.

  The OCSP implementation failed to verify that an authorized responder certificate
  embedded in an OCSP response is authorized by the issuing CA. As a result, any valid
  signature by an embedded certificate passed the check and was allowed to make claims
  about the revocation status of certificates of any CA.

  Attackers that are in a position to spoof OCSP responses for a client could therefore
  render legitimate certificates of a 3rd party CA as revoked or even use a compromised
  (and actually revoked) certificate by spoofing an OCSP-âOKâ response. E.g. an attacker
  could exploit this to impersonate a legitimate TLS server using a compromised
  certificate of that host and get around the revocation check using OCSP stapling.

  Introduced in 1.11.34, fixed in 2.19.3 and 3.0.0

## 2020[Â¶](#id3 "Link to this heading")

* 2020-12-21 (CVE-2021-24115): Codec encoding/decoding was not constant time

  The base64, base32, base58 and hex encoding/decoding routines used lookup
  tables which could leak information via a cache-based side channel attack.
  The encoding tables were small and unlikely to be exploitable, but the
  decoding tables were large enough to cause non-negligible information
  leakage. In particular parsing an unencrypted PEM-encoded private key within
  an SGX enclave could be easily attacked to leak key material.

  Identified and reported by Jan Wichelmann, Thomas Eisenbarth,
  Sebastian Berndt, and Florian Sieck.

  Fixed in 2.17.3
* 2020-07-05: Failure to enforce name constraints on alternative names

  The path validation algorithm enforced name constraints on the primary DN
  included in the certificate but failed to do so against alternative DNs which
  may be included in the subject alternative name. This would allow a corrupted
  sub-CA which was constrained by a name constraints extension in its own
  certificate to issue a certificate containing a prohibited DN. Until 2.15.0,
  there was no API to access these alternative name DNs so it is unlikely that
  any application would make incorrect access control decisions on the basis of
  the incorrect DN. Reported by Mario Korth of Ruhr-UniversitÃ¤t Bochum.

  Introduced in 1.11.29, fixed in 2.15.0
* 2020-03-24: Side channel during CBC padding

  The CBC padding operations were not constant time and as a result would leak
  the length of the plaintext values which were being padded to an attacker
  running a side channel attack via shared resources such as cache or branch
  predictor. No information about the contents was leaked, but the length alone
  might be used to make inferences about the contents. This issue affects TLS
  CBC ciphersuites as well as CBC encryption using PKCS7 or other similar padding
  mechanisms. In all cases, the unpadding operations were already constant time
  and are not affected. Reported by Maximilian Blochberger of UniversitÃ¤t
  Hamburg.

  Fixed in 2.14.0, all prior versions affected.

## 2018[Â¶](#id4 "Link to this heading")

* 2018-12-17 (CVE-2018-20187): Side channel during ECC key generation

  A timing side channel during ECC key generation could leak information about
  the high bits of the secret scalar. Such information allows an attacker to
  perform a brute force attack on the key somewhat more efficiently than they
  would otherwise. Found by JÃ¡n JanÄÃ¡r using ECTester.

  Introduced in 1.11.20, fixed in 2.8.0.
* 2018-06-13 (CVE-2018-12435): ECDSA side channel

  A side channel in the ECDSA signature operation could allow a local attacker
  to recover the secret key. Found by Keegan Ryan of NCC Group.

  Bug introduced in 2.5.0, fixed in 2.7.0. The 1.10 branch is not affected.
* 2018-04-10 (CVE-2018-9860): Memory overread in TLS CBC decryption

  An off by one error in TLS CBC decryption meant that for a particular
  malformed ciphertext, the receiver would miscompute a length field and HMAC
  exactly 64K bytes of data following the record buffer as if it was part of the
  message. This cannot be used to leak information since the MAC comparison will
  subsequently fail and the connection will be closed. However it might be used
  for denial of service. Found by OSS-Fuzz.

  Bug introduced in 1.11.32, fixed in 2.6.0
* 2018-03-29 (CVE-2018-9127): Invalid wildcard match

  RFC 6125 wildcard matching was incorrectly implemented, so that a wildcard
  certificate such as `b*.domain.com` would match any hosts `*b*.domain.com`
  instead of just server names beginning with `b`. The host and certificate
  would still have to be in the same domain name. Reported by Fabian WeiÃberg of
  Rohde and Schwarz Cybersecurity.

  Bug introduced in 2.2.0, fixed in 2.5.0

## 2017[Â¶](#id5 "Link to this heading")

* 2017-10-02 (CVE-2017-14737): Potential side channel using cache information

  In the Montgomery exponentiation code, a table of precomputed values
  is used. An attacker able to analyze which cache lines were accessed
  (perhaps via an active attack such as Prime+Probe) could recover
  information about the exponent. Identified in âCacheD: Identifying
  Cache-Based Timing Channels in Production Softwareâ by Wang, Wang,
  Liu, Zhang, and Wu (Usenix Security 2017).

  Fixed in 1.10.17 and 2.3.0, all prior versions affected.
* 2017-07-16: Failure to fully zeroize memory before free

  The secure\_allocator type attempts to zeroize memory before freeing it. Due to
  a error sometimes only a portion of the memory would be zeroed, because of a
  confusion between the number of elements vs the number of bytes that those
  elements use. So byte vectors would always be fully zeroed (since the two
  notions result in the same value), but for example with an array of 32-bit
  integers, only the first 1/4 of the elements would be zeroed before being
  deallocated. This may result in information leakage, if an attacker can access
  memory on the heap. Reported by Roman Pozlevich.

  Bug introduced in 1.11.10, fixed in 2.2.0
* 2017-04-04 (CVE-2017-2801): Incorrect comparison in X.509 DN strings

  Botanâs implementation of X.509 name comparisons had a flaw which
  could result in an out of bound memory read while processing a
  specially formed DN. This could potentially be exploited for
  information disclosure or denial of service, or result in incorrect
  validation results. Found independently by Aleksandar Nikolic of
  Cisco Talos, and OSS-Fuzz automated fuzzing infrastructure.

  Bug introduced in 1.6.0 or earlier, fixed in 2.1.0 and 1.10.16
* 2017-03-23 (CVE-2017-7252): Incorrect bcrypt computation

  Botanâs implementation of bcrypt password hashing scheme truncated long
  passwords at 56 characters, instead of at bcryptâs standard 72 characters
  limit. Passwords with lengths between these two bounds could be cracked more
  easily than should be the case due to the final password bytes being ignored.
  Found and reported by Solar Designer.

  Bug introduced in 1.11.0, fixed in 2.1.0.

## 2016[Â¶](#id6 "Link to this heading")

* 2016-11-27 (CVE-2016-9132) Integer overflow in BER decoder

  While decoding BER length fields, an integer overflow could occur. This could
  occur while parsing untrusted inputs such as X.509 certificates. The overflow
  does not seem to lead to any obviously exploitable condition, but exploitation
  cannot be positively ruled out. Only 32-bit platforms are likely affected; to
  cause an overflow on 64-bit the parsed data would have to be many gigabytes.
  Bug found by Falko Strenzke, cryptosource GmbH.

  Fixed in 1.10.14 and 1.11.34, all prior versions affected.
* 2016-10-26 (CVE-2016-8871) OAEP side channel

  A side channel in OAEP decoding could be used to distinguish RSA ciphertexts
  that did or did not have a leading 0 byte. For an attacker capable of
  precisely measuring the time taken for OAEP decoding, this could be used as an
  oracle allowing decryption of arbitrary RSA ciphertexts. Remote exploitation
  seems difficult as OAEP decoding is always paired with RSA decryption, which
  takes substantially more (and variable) time, and so will tend to mask the
  timing channel. This attack does seems well within reach of a local attacker
  capable of a cache or branch predictor based side channel attack. Finding,
  analysis, and patch by Juraj Somorovsky.

  Introduced in 1.11.29, fixed in 1.11.33
* 2016-08-30 (CVE-2016-6878) Undefined behavior in Curve25519

  On systems without a native 128-bit integer type, the Curve25519 code invoked
  undefined behavior. This was known to produce incorrect results on 32-bit ARM
  when compiled by Clang.

  Introduced in 1.11.12, fixed in 1.11.31
* 2016-08-30 (CVE-2016-6879) Bad result from X509\_Certificate::allowed\_usage

  If allowed\_usage was called with more than one Key\_Usage set in the enum
  value, the function would return true if *any* of the allowed usages were set,
  instead of if *all* of the allowed usages are set. This could be used to
  bypass an application key usage check. Credit to Daniel Neus of Rohde &
  Schwarz Cybersecurity for finding this issue.

  Introduced in 1.11.0, fixed in 1.11.31
* 2016-03-17 (CVE-2016-2849): ECDSA side channel

  ECDSA (and DSA) signature algorithms perform a modular inverse on the
  signature nonce k. The modular inverse algorithm used had input dependent
  loops, and it is possible a side channel attack could recover sufficient
  information about the nonce to eventually recover the ECDSA secret key. Found
  by Sean Devlin.

  Introduced in 1.7.15, fixed in 1.10.13 and 1.11.29
* 2016-03-17 (CVE-2016-2850): Failure to enforce TLS policy

  TLS v1.2 allows negotiating which signature algorithms and hash functions each
  side is willing to accept. However received signatures were not actually
  checked against the specified policy. This had the effect of allowing a
  server to use an MD5 or SHA-1 signature, even though the default policy
  prohibits it. The same issue affected client cert authentication.

  The TLS client also failed to verify that the ECC curve the server chose to
  use was one which was acceptable by the client policy.

  Introduced in 1.11.0, fixed in 1.11.29
* 2016-02-01 (CVE-2016-2196): Overwrite in P-521 reduction

  The P-521 reduction function would overwrite zero to one word
  following the allocated block. This could potentially result
  in remote code execution or a crash. Found with AFL

  Introduced in 1.11.10, fixed in 1.11.27
* 2016-02-01 (CVE-2016-2195): Heap overflow on invalid ECC point

  The PointGFp constructor did not check that the affine coordinate
  arguments were less than the prime, but then in curve multiplication
  assumed that both arguments if multiplied would fit into an integer
  twice the size of the prime.

  The bigint\_mul and bigint\_sqr functions received the size of the
  output buffer, but only used it to dispatch to a faster algorithm in
  cases where there was sufficient output space to call an unrolled
  multiplication function.

  The result is a heap overflow accessible via ECC point decoding,
  which accepted untrusted inputs. This is likely exploitable for
  remote code execution.

  On systems which use the mlock pool allocator, it would allow an
  attacker to overwrite memory held in secure\_vector objects. After
  this point the write will hit the guard page at the end of the
  mmapâed region so it probably could not be used for code execution
  directly, but would allow overwriting adjacent key material.

  Found by Alex Gaynor fuzzing with AFL

  Introduced in 1.9.18, fixed in 1.11.27 and 1.10.11
* 2016-02-01 (CVE-2016-2194): Infinite loop in modular square root algorithm

  The ressol function implements the Tonelli-Shanks algorithm for
  finding square roots could be sent into a nearly infinite loop due
  to a misplaced conditional check. This could occur if a composite
  modulus is provided, as this algorithm is only defined for primes.
  This function is exposed to attacker controlled input via the OS2ECP
  function during ECC point decompression. Found by AFL

  Introduced in 1.7.15, fixed in 1.11.27 and 1.10.11

## 2015[Â¶](#id7 "Link to this heading")

* 2015-11-04: TLS certificate authentication bypass

  When the bugs affecting X.509 path validation were fixed in 1.11.22, a check
  in Credentials\_Manager::verify\_certificate\_chain was accidentally removed
  which caused path validation failures not to be signaled to the TLS layer. So
  for affected versions, certificate authentication in TLS is bypassed. As a
  workaround, applications can override the call and implement the correct
  check. Reported by Florent Le Coz in GH #324

  Introduced in 1.11.22, fixed in 1.11.24
* 2015-10-26 (CVE-2015-7824): Padding oracle attack on TLS

  A padding oracle attack was possible against TLS CBC ciphersuites because if a
  certain length check on the packet fields failed, a different alert type than
  one used for message authentication failure would be returned to the sender.
  This check triggering would leak information about the value of the padding
  bytes and could be used to perform iterative decryption.

  As with most such oracle attacks, the danger depends on the underlying
  protocol - HTTP servers are particularly vulnerable. The current analysis
  suggests that to exploit it an attacker would first have to guess several
  bytes of plaintext, but again this is quite possible in many situations
  including HTTP.

  Found in a review by Sirrix AG and 3curity GmbH.

  Introduced in 1.11.0, fixed in 1.11.22
* 2015-10-26 (CVE-2015-7825): Infinite loop during certificate path validation

  When evaluating a certificate path, if a loop in the certificate chain
  was encountered (for instance where C1 certifies C2, which certifies C1)
  an infinite loop would occur eventually resulting in memory exhaustion.
  Found in a review by Sirrix AG and 3curity GmbH.

  Introduced in 1.11.6, fixed in 1.11.22
* 2015-10-26 (CVE-2015-7826): Acceptance of invalid certificate names

  RFC 6125 specifies how to match a X.509v3 certificate against a DNS name
  for application usage.

  Otherwise valid certificates using wildcards would be accepted as matching
  certain hostnames that should they should not according to RFC 6125. For
  example a certificate issued for `*.example.com` should match
  `foo.example.com` but not `example.com` or `bar.foo.example.com`. Previously
  Botan would accept such a certificate as also valid for `bar.foo.example.com`.

  RFC 6125 also requires that when matching a X.509 certificate against a DNS
  name, the CN entry is only compared if no subjectAlternativeName entry is
  available. Previously X509\_Certificate::matches\_dns\_name would always check
  both names.

  Found in a review by Sirrix AG and 3curity GmbH.

  Introduced in 1.11.0, fixed in 1.11.22
* 2015-10-26 (CVE-2015-7827): PKCS #1 v1.5 decoding was not constant time

  During RSA decryption, how long decoding of PKCS #1 v1.5 padding took was
  input dependent. If these differences could be measured by an attacker, it
  could be used to mount a Bleichenbacher million-message attack. PKCS #1 v1.5
  decoding has been rewritten to use a sequence of operations which do not
  contain any input-dependent indexes or jumps. Notations for checking constant
  time blocks with ctgrind (<https://github.com/agl/ctgrind>) were added to PKCS
  #1 decoding among other areas. Found in a review by Sirrix AG and 3curity GmbH.

  Fixed in 1.11.22 and 1.10.13. Affected all previous versions.
* 2015-08-03 (CVE-2015-5726): Crash in BER decoder

  The BER decoder would crash due to reading from offset 0 of an empty vector if
  it encountered a BIT STRING which did not contain any data at all. This can be
  used to easily crash applications reading untrusted ASN.1 data, but does not
  seem exploitable for code execution. Found with afl.

  Fixed in 1.11.19 and 1.10.10, affected all previous versions of 1.10 and 1.11
* 2015-08-03 (CVE-2015-5727): Excess memory allocation in BER decoder

  The BER decoder would allocate a fairly arbitrary amount of memory in a length
  field, even if there was no chance the read request would succeed. This might
  cause the process to run out of memory or invoke the OOM killer. Found with afl.

  Fixed in 1.11.19 and 1.10.10, affected all previous versions of 1.10 and 1.11

## 2014[Â¶](#id8 "Link to this heading")

* 2014-04-10 (CVE-2014-9742): Insufficient randomness in Miller-Rabin primality check

  A bug in the Miller-Rabin primality test resulted in only a single random base
  being used instead of a sequence of such bases. This increased the probability
  that a non-prime would be accepted by is\_prime or that a randomly generated
  prime might actually be composite. The probability of a random 1024 bit
  number being incorrectly classed as prime with a single base is around 2^-40.
  Reported by Jeff Marrison.

  Introduced in 1.8.3, fixed in 1.10.8 and 1.11.9

### Table of Contents

* [Botan: Crypto and TLS for Modern C++](index.html)
* [Release Notes](news.html)
* Security Advisories
  + [2024](#id1)
  + [2022](#id2)
  + [2020](#id3)
  + [2018](#id4)
  + [2017](#id5)
  + [2016](#id6)
  + [2015](#id7)
  + [2014](#id8)
* [User Guide](https://botan.randombit.net/handbook)
* [API Reference](https://botan.randombit.net/doxygen)

### Search

[previous](news.html "Release Notes") |
[index](genindex.html "General Index")

Last updated on 2024-10-26.



=== Content from github.com_9b3f3aeb_20250125_114418.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcrocs-muni%2FECTester)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcrocs-muni%2FECTester)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=crocs-muni%2FECTester)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[crocs-muni](/crocs-muni)
/
**[ECTester](/crocs-muni/ECTester)**
Public

* [Notifications](/login?return_to=%2Fcrocs-muni%2FECTester) You must be signed in to change notification settings
* [Fork
  14](/login?return_to=%2Fcrocs-muni%2FECTester)
* [Star
   66](/login?return_to=%2Fcrocs-muni%2FECTester)

Tests support and behavior of elliptic curve cryptography implementations on JavaCards (TYPE\_EC\_FP and TYPE\_EC\_F2M) and in selected software libraries.

[crocs-muni.github.io/ECTester](https://crocs-muni.github.io/ECTester "https://crocs-muni.github.io/ECTester")

### License

[MIT license](/crocs-muni/ECTester/blob/master/LICENSE)

[66
stars](/crocs-muni/ECTester/stargazers) [14
forks](/crocs-muni/ECTester/forks) [Branches](/crocs-muni/ECTester/branches) [Tags](/crocs-muni/ECTester/tags) [Activity](/crocs-muni/ECTester/activity)
 [Star](/login?return_to=%2Fcrocs-muni%2FECTester)

 [Notifications](/login?return_to=%2Fcrocs-muni%2FECTester) You must be signed in to change notification settings

* [Code](/crocs-muni/ECTester)
* [Issues
  2](/crocs-muni/ECTester/issues)
* [Pull requests
  0](/crocs-muni/ECTester/pulls)
* [Actions](/crocs-muni/ECTester/actions)
* [Projects
  0](/crocs-muni/ECTester/projects)
* [Security](/crocs-muni/ECTester/security)
* [Insights](/crocs-muni/ECTester/pulse)

Additional navigation options

* [Code](/crocs-muni/ECTester)
* [Issues](/crocs-muni/ECTester/issues)
* [Pull requests](/crocs-muni/ECTester/pulls)
* [Actions](/crocs-muni/ECTester/actions)
* [Projects](/crocs-muni/ECTester/projects)
* [Security](/crocs-muni/ECTester/security)
* [Insights](/crocs-muni/ECTester/pulse)

# crocs-muni/ECTester

    master[Branches](/crocs-muni/ECTester/branches)[Tags](/crocs-muni/ECTester/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[876 Commits](/crocs-muni/ECTester/commits/master/) | | |
| [.github/workflows](/crocs-muni/ECTester/tree/master/.github/workflows "This path skips through empty directories") | | [.github/workflows](/crocs-muni/ECTester/tree/master/.github/workflows "This path skips through empty directories") |  |  |
| [applet](/crocs-muni/ECTester/tree/master/applet "applet") | | [applet](/crocs-muni/ECTester/tree/master/applet "applet") |  |  |
| [common](/crocs-muni/ECTester/tree/master/common "common") | | [common](/crocs-muni/ECTester/tree/master/common "common") |  |  |
| [docs](/crocs-muni/ECTester/tree/master/docs "docs") | | [docs](/crocs-muni/ECTester/tree/master/docs "docs") |  |  |
| [ext](/crocs-muni/ECTester/tree/master/ext "ext") | | [ext](/crocs-muni/ECTester/tree/master/ext "ext") |  |  |
| [gradle/wrapper](/crocs-muni/ECTester/tree/master/gradle/wrapper "This path skips through empty directories") | | [gradle/wrapper](/crocs-muni/ECTester/tree/master/gradle/wrapper "This path skips through empty directories") |  |  |
| [nix](/crocs-muni/ECTester/tree/master/nix "nix") | | [nix](/crocs-muni/ECTester/tree/master/nix "nix") |  |  |
| [reader](/crocs-muni/ECTester/tree/master/reader "reader") | | [reader](/crocs-muni/ECTester/tree/master/reader "reader") |  |  |
| [standalone](/crocs-muni/ECTester/tree/master/standalone "standalone") | | [standalone](/crocs-muni/ECTester/tree/master/standalone "standalone") |  |  |
| [util](/crocs-muni/ECTester/tree/master/util "util") | | [util](/crocs-muni/ECTester/tree/master/util "util") |  |  |
| [.codecov.yml](/crocs-muni/ECTester/blob/master/.codecov.yml ".codecov.yml") | | [.codecov.yml](/crocs-muni/ECTester/blob/master/.codecov.yml ".codecov.yml") |  |  |
| [.editorconfig](/crocs-muni/ECTester/blob/master/.editorconfig ".editorconfig") | | [.editorconfig](/crocs-muni/ECTester/blob/master/.editorconfig ".editorconfig") |  |  |
| [.gitattributes](/crocs-muni/ECTester/blob/master/.gitattributes ".gitattributes") | | [.gitattributes](/crocs-muni/ECTester/blob/master/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/crocs-muni/ECTester/blob/master/.gitignore ".gitignore") | | [.gitignore](/crocs-muni/ECTester/blob/master/.gitignore ".gitignore") |  |  |
| [.gitmodules](/crocs-muni/ECTester/blob/master/.gitmodules ".gitmodules") | | [.gitmodules](/crocs-muni/ECTester/blob/master/.gitmodules ".gitmodules") |  |  |
| [LICENSE](/crocs-muni/ECTester/blob/master/LICENSE "LICENSE") | | [LICENSE](/crocs-muni/ECTester/blob/master/LICENSE "LICENSE") |  |  |
| [README.md](/crocs-muni/ECTester/blob/master/README.md "README.md") | | [README.md](/crocs-muni/ECTester/blob/master/README.md "README.md") |  |  |
| [flake.lock](/crocs-muni/ECTester/blob/master/flake.lock "flake.lock") | | [flake.lock](/crocs-muni/ECTester/blob/master/flake.lock "flake.lock") |  |  |
| [flake.nix](/crocs-muni/ECTester/blob/master/flake.nix "flake.nix") | | [flake.nix](/crocs-muni/ECTester/blob/master/flake.nix "flake.nix") |  |  |
| [gradle.lock](/crocs-muni/ECTester/blob/master/gradle.lock "gradle.lock") | | [gradle.lock](/crocs-muni/ECTester/blob/master/gradle.lock "gradle.lock") |  |  |
| [gradlew](/crocs-muni/ECTester/blob/master/gradlew "gradlew") | | [gradlew](/crocs-muni/ECTester/blob/master/gradlew "gradlew") |  |  |
| [gradlew.bat](/crocs-muni/ECTester/blob/master/gradlew.bat "gradlew.bat") | | [gradlew.bat](/crocs-muni/ECTester/blob/master/gradlew.bat "gradlew.bat") |  |  |
| [requirements.txt](/crocs-muni/ECTester/blob/master/requirements.txt "requirements.txt") | | [requirements.txt](/crocs-muni/ECTester/blob/master/requirements.txt "requirements.txt") |  |  |
| [settings.gradle.kts](/crocs-muni/ECTester/blob/master/settings.gradle.kts "settings.gradle.kts") | | [settings.gradle.kts](/crocs-muni/ECTester/blob/master/settings.gradle.kts "settings.gradle.kts") |  |  |
| View all files | | |

## Repository files navigation

* README
* License
#

[![Build](https://github.com/crocs-muni/ECTester/actions/workflows/build.yml/badge.svg)](https://github.com/crocs-muni/ECTester/actions/workflows/build.yml) [![codecov](https://camo.githubusercontent.com/6bd7bafbc22bc6b62881c7f9e85f94039dd07024640c41fd79754e16e88fbb84/68747470733a2f2f636f6465636f762e696f2f6769746875622f63726f63732d6d756e692f45435465737465722f67726170682f62616467652e7376673f746f6b656e3d756c5830665a51696e70)](https://codecov.io/github/crocs-muni/ECTester) [![GitHub release](https://camo.githubusercontent.com/fc7d6e66ef37686126827ace3a8edcb84d227bdeb74ede3b9900fc03469f7443/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f72656c656173652f63726f63732d6d756e692f45435445737465722e737667)](https://github.com/crocs-muni/ECTester/releases) [![license](https://camo.githubusercontent.com/12fea51b1f5ec82bf227d5e0b9a100cbfce504618c447c7edd9208c7c227c2cd/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f63726f63732d6d756e692f45435465737465722e737667)](https://github.com/crocs-muni/ECTester/blob/master/LICENSE) [![docs](https://camo.githubusercontent.com/d924248f8cf6a02b505b0b510b04dd1ba293ae7e1d403a38a190a2530b028ae2/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d6769746875622e696f2d627269676874677265656e2e737667)](https://crocs-muni.github.io/ECTester/)

ECTester is a tool for testing and analysis of elliptic curve cryptography implementations on JavaCards and in
cryptographic libraries. It consists of four separate parts:

* The ECTester applet, a JavaCard applet that provides the testing interface
* The ECTesterReader app, a reader app that works with the applet
* The ECTesterStandalone app, which tests software cryptographic libraries
* Jupyter notebooks for analysis and visualization of data from the apps

For more information on ECC support on JavaCards see the [GitHub page](https://crocs-muni.github.io/ECTester/), with results, tables and docs.

This project is developed by the [Centre for Research On Cryptography and Security](https://crocs.fi.muni.cz) at Faculty of Informatics, Masaryk University.

## Contents

* [Setup](#setup)
* [JavaCard testing](#javacard-testing): [Examples](#examples)
* [Standalone library testing](#standalone-library-testing): [Examples](#examples-1)
* [Analysis](#analysis): [Examples](#examples-2)

## Other documentation

* [TESTS](/crocs-muni/ECTester/blob/master/docs/TESTS.md): Description of card test suites.
* [CURVES](/crocs-muni/ECTester/blob/master/docs/CURVES.md): Description of curve and test data contained in ECTester.
* [FORMAT](/crocs-muni/ECTester/blob/master/docs/FORMAT.md): Description of input and output formats used by ECTester.
* [LIBS](/crocs-muni/ECTester/blob/master/docs/LIBS.md): List of cryptographic libraries supported by ECTester and their characteristics.
* [VULNS](/crocs-muni/ECTester/blob/master/docs/VULNS.md): List of vulnerabilities discovered using ECTester.

## Setup

ECTester uses Gradle (and Gradle wrapper) for its build.
There are three parts of ECTester, the JavaCard applet used for testing, the reader app which controls it and the
standalone app which tests software libraries. The target platform for ECTester is Linux, but things should work on
Windows as well, although testing of standalone libraries will be limited to Java libraries and Microsoft CNG library.

The ECTester parts require different Java versions. Reader and standalone parts require Java >= 15 while the applet build
will be able to target different JavaCard versions based on the Java version, see [this list](https://github.com/martinpaljak/ant-javacard/wiki/JavaCard-SDK-and-JDK-version-compatibility).

To build ECTester simply do:

```
git submodule update --init --recursive       # To initialize submodules (JavaCard SDKs, Microsoft CNG, BoringSSL, ...)
./gradlew :applet:buildJavaCard               # To build the applet (cap) -> "applet/build/javacard/applet[221,222,305].cap".
./gradlew :reader:uberJar                     # To build the reader tool (jar) -> "reader/build/libs/ECTesterReader.jar"
./gradlew :standalone:libs                    # To build the native library shims.
./gradlew :standalone:uberJar                 # To build the standalone tool (jar) -> "standalone/build/libs/ECTesterStandalone.jar"
```

The applet comes in several flavors, targeting JavaCard `2.2.1`, `2.2.2` and `3.0.5`. The `2.2.2` and later flavors
support extended length APDUs which are necessary for some commands to work properly.

To build the standalone part, which involves numerous cryptographic libraries, one has two options.

* Install these cryptographic libraries system-wide and let the build use those.
* Use [Nix](https://nixos.org/) to build the tool part with given library versions.

See the section on [setup](#setup-1) of standalone library testing for more details.

## JavaCard testing

The JavaCard part of ECTester targets testing elliptic curve cryptography implementations in programmable smart cards of the JavaCard platform, version 2.2.1 and up. The reader app supports many actions, the main one being [testing](#test): the running of predetermined test suites that test the JavaCard for support, performance and vulnerabilities. The other actions focus on data collection, [generating keys](#generate), [signing data](#ecdsa), [performing key agreement](#ecdh) or [exporting the preset curves](#export), output of the mentioned actions can then be analyzed using the Jupyter notebooks, see [analysis](#analysis).

1. Upload `applet/build/applet/ectester[221,222,305].cap` using your favorite tool (e.g., [GlobalPlatformPro tool](https://github.com/martinpaljak/GlobalPlatform)).
2. Run `java -jar reader/build/libs/ECTesterReader.jar -t` or other data collection commands.
3. Inspect output log with annotated results.

Following operations are tested in the default test suite, which is just a basic support test suite:

* Allocation of new KeyPair class for specified parameters
* Generation of KeyPair with default curve
* Setting of custom curve and KeyPair generation
* Generation of shared secret via ECDH
* Signature via ECDSA

See `java -jar ECTesterReader.jar -h`, `java -jar ECTesterReader.jar -ls` and [TESTS](/crocs-muni/ECTester/blob/master/docs/TESTS.md) for more.

### Actions

Actions for the reader app, exactly one of which is required for every run.

#### Test

`-t / --test [test_suite]`

Perform support, performance and vulnerability tests of ECC.

Currently supported test suites include:

* `default`
* `test-vectors`
* `compression`
* `miscellaneous`
* `signature`
* `wrong`\*
* `invalid`\*
* `twist`\*
* `degenerate`\*
* `composite`\*
* `cofactor`\*
* `edge-cases`\*

**\*NOTE: The `wrong`, `composite`, `invalid`,`twist`, `cofactor`, `edge-cases` and `degenerate` test suites caused temporary/permanent DoS of some cards. These test suites prompt you for
confirmation before running, be cautious.**

To select which tests will be performed, it is possible to enter the test suite name with a suffix
which specifies the number of the first test to be run, and optionally the number of the last test to be run as `-t <test_suite>[:start_index[:stop_index]]`.

Use with `-o / --output [out_type:]<out_file>` to output the test results to a file.
For possible formats of this file see [FORMAT](/crocs-muni/ECTester/blob/master/docs/FORMAT.md).
For more info about the test suites see [TESTS](/crocs-muni/ECTester/blob/master/docs/TESTS.md).

#### Export

`-e / --export`

Exports the default curves (if any) that are preset on the card.
Use with `-o / --output [out_file]` to output the curve parameters to a file.
For format of this file see [FORMAT](/crocs-muni/ECTester/blob/master/docs/FORMAT.md).

#### Generate

`-g / --generate [amount]`

Generates batch of EC keypairs and exports them.

Use with `-o / --output [out_file]` to output the generated keys to a file.
Use with `--time` to measure time as a difference of real duration of the operation and the dry-run duration of the operation.
For format of this file see [FORMAT](/crocs-muni/ECTester/blob/master/docs/FORMAT.md).

#### ECDH

`-dh / --ecdh [count]`

Performs ECDH.

Use with `-o / --output [out_file]` to output into a file.
Use with `--time` to measure time as a difference of real duration of the operation and the dry-run duration of the operation.
For format of this file see [FORMAT](/crocs-muni/ECTester/blob/master/docs/FORMAT.md).
Respects the KeyAgreement type specified in `-ka / --ka-type [type]`.

#### ECDSA

`-dsa / --ecdsa [count]`

Performs ECDSA.
Useful with `-i / --input [in_file]` to sign the contents of a file.
Use with `-o / --output [out_file]` to output into a file.
Use with `--time` to measure time as a difference of real duration of the operation and the dry-run duration of the operation.
For format of these files see [FORMAT](/crocs-muni/ECTester/blob/master/docs/FORMAT.md).
Respects the Signature type specified in `-sig / --sig-type [type]`.

#### List named curves

`-ln / --list-named [category/name]`

Lists categories of curves, keys and keypairs embedded in ECTester's jar, along with some information about them.
These can be used as arguments to the `-n[c|k|pub|priv] / --named-[curve|key|public|private]` parameters, using the format: `category/name`.

For example:
`secg/secp192r1` identifies the SECG 192 bit prime field curve known as `secp192r1`.

For more info about the curves and curve categories see [CURVES](/crocs-muni/ECTester/blob/master/docs/CURVES.md).

#### List test suites

`-ls / --list-suites`

Lists the implemented test suites and gives their short description.

#### Get applet info

`-nf / --info`

Get and print ECTester applet info from an applet installed on a card.

Outputs:

* Card ATR
* Negotiated protocol (T=0/T=1)
* ECTester applet version
* ECTester APDU support (basic/extended APDU)
* JavaCard API version
* JavaCard cleanup support
* ECTester internal array sizes and APDU buffer size

### Examples

Snippet below shows running the default test suite while simulating(`-s`), so using JCardSim.
This shows that JCardsim simulates 112b Fp support with default curve present and supports ECDH, ECDHC and ECDSA.

```
> java -jar ECTesterReader.jar -t -s
═══ Running test suite: default ═══
═══ The default test suite tests basic support of ECDH and ECDSA.
═══ Date: 2018.05.02 20:29:38
═══ ECTester version: v0.3.0
═══ Card ATR: 3bfa1800008131fe454a434f5033315632333298
■━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━┓
 OK ╋ (0) Get applet info: v0.3.0; 3.0; basic                                                             ┃ SUCCESS   ┃ All sub-tests had the expected result.
    ┗  OK ━ Get applet info                                                                               ┃ SUCCESS   ┃    0 ms ┃  OK   (0x9000)
■━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━┓
 OK ╋ (1) Tests of 112b ALG_EC_FP support.                                                                ┃ SUCCESS   ┃ All sub-tests matched the expected mask.
    ┣  OK ━ Allocate both keypairs 112b ALG_EC_FP                                                         ┃ SUCCESS   ┃  166 ms ┃  OK   (0x9000) OK   (0x9000)
    ┣  OK ━ Generate both keypairs                                                                        ┃ SUCCESS   ┃   19 ms ┃  OK   (0x9000) OK   (0x9000)
    ┣  OK ━ Allocate both keypairs 112b ALG_EC_FP                                                         ┃ SUCCESS   ┃    0 ms ┃  OK   (0x9000) OK   (0x9000)
    ┣  OK ━ Set custom curve parameters on both keypairs                                                  ┃ SUCCESS   ┃    0 ms ┃  OK   (0x9000) OK   (0x9000)
    ┣  OK ━ Generate both keypairs                                                                        ┃ SUCCESS   ┃    5 ms ┃  OK   (0x9000) OK   (0x9000)
    ┣  OK ┳ KeyAgreement tests.                                                                           ┃ SUCCESS   ┃ Some sub-tests did have the expected result.
    ┃     ┣  OK ┳ Test of the ALG_EC_SVDP_DH KeyAgreement.                                                ┃ SUCCESS   ┃ Some ECDH is supported.
    ┃     ┃     ┣  OK ━ Allocate KeyAgreement(ALG_EC_SVDP_DH) object                                      ┃ SUCCESS   ┃    1 ms ┃  OK   (0x9000)
    ┃     ┃     ┣  OK ━ ALG_EC_SVDP_DH of local pubkey and remote privkey                                 ┃ SUCCESS   ┃    2 ms ┃  OK   (0x9000)
    ┃     ┃     ┣  OK ━ ALG_EC_SVDP_DH of local pubkey and remote privkey(COMPRESSED point)               ┃ SUCCESS   ┃    3 ms ┃  OK   (0x9000)
    ┃     ┃     ┗  OK ━ Mean = 1879950 ns, Median = 1835076 ns, Mode = 1763287 ns                         ┃ SUCCESS   ┃    1 ms ┃  OK   (0x9000)
    ┃     ┣  OK ┳ Test of the ALG_EC_SVDP_DHC KeyAgreement.                                               ┃ SUCCESS   ┃ Some ECDH is supported.
    ┃     ┃     ┣  OK ━ Allocate KeyAgreement(ALG_EC_SVDP_DHC) object                                     ┃ SUCCESS   ┃    0 ms ┃  OK   (0x9000)
    ┃     ┃     ┣  OK ━ ALG_EC_SVDP_DHC of local pubkey and remote privkey                                ┃ SUCCESS   ┃    1 ms ┃  OK   (0x9000)
    ┃     ┃     ┣  OK ━ ALG_EC_SVDP_DHC of local pubkey and remote privkey(COMPRESSED point)              ┃ SUCCESS   ┃    2 ms ┃  OK   (0x9000)
    ┃     ┃     ┗  OK ━ Mean = 1748499 ns, Median = 1760792 ns, Mode = 1647372 ns                         ┃ SUCCESS   ┃    1 ms ┃  OK   (0x9000)
    ┃     ┣ NOK ━ Allocate KeyAgreement(ALG_EC_SVDP_DH_PLAIN) object                                      ┃ FAILURE   ┃    0 ms ┃  fail (NO_SUCH_ALG, 0x0003)
    ┃     ┣ NOK ━ Allocate KeyAgreement(ALG_EC_SVDP_DHC_PLAIN) object                                     ┃ FAILURE   ┃    0 ms ┃  fail (NO_SUCH_ALG, 0x0003)
    ┃     ┣ NOK ━ Allocate KeyAgreement(ALG_EC_PACE_GM) object                                            ┃ FAILURE   ┃    0 ms ┃  fail (NO_SUCH_ALG, 0x0003)
    ┃     ┗ NOK ━ Allocate KeyAgreement(ALG_EC_SVDP_DH_PLAIN_XY) object                                   ┃ FAILURE   ┃    0 ms ┃  fail (NO_SUCH_ALG, 0x0003)
    ┗  OK ┳ Signature tests.                                                                              ┃ SUCCESS   ┃ Some sub-tests did have the expected result.
          ┣  OK ┳ Test of the ALG_ECDSA_SHA signature.                                                    ┃ SUCCESS   ┃ All sub-tests had the expected result.
          ┃     ┣  OK ━ Allocate Signature(ALG_ECDSA_SHA) object                                          ┃ SUCCESS   ┃    2 ms ┃  OK   (0x9000)
          ┃     ┣  OK ━ ALG_ECDSA_SHA with local keypair(random data)                                     ┃ SUCCESS   ┃   17 ms ┃  OK   (0x9000)
          ┃     ┣  OK ━ Sign (Mean = 1451086 ns, Median = 1413292 ns, Mode = 1378296 ns)                  ┃ SUCCESS   ┃    1 ms ┃  OK   (0x9000)
          ┃     ┗  OK ━ Verify (Mean = 1850022 ns, Median = 1837022 ns, Mode = 1744613 ns)                ┃ SUCCESS   ┃    1 ms ┃  OK   (0x9000)
          ┣ NOK ━ Allocate Signature(ALG_ECDSA_SHA_224) object                                            ┃ FAILURE   ┃    0 ms ┃  fail (NO_SUCH_ALG, 0x0003)
          ┣ NOK ━ Allocate Signature(ALG_ECDSA_SHA_256) object                                            ┃ FAILURE   ┃    0 ms ┃  fail (NO_SUCH_ALG, 0x0003)
          ┣ NOK ━ Allocate Signature(ALG_ECDSA_SHA_384) object                                            ┃ FAILURE   ┃    0 ms ┃  fail (NO_SUCH_ALG, 0x0003)
          ┗ NOK ━ Allocate Signature(ALG_ECDSA_SHA_512) object                                            ┃ FAILURE   ┃    0 ms ┃  fail (NO_SUCH_ALG, 0x0003)

```

#### Legend

* Some general information about the test suite and card is output first, test data follows after.
* The **OK**/**NOK** values on the left represent the complete evaluated result of a test, as a test can be expected
  to succeed or fail, this is different than the values on the right:
  + **SUCCESS**: Is **OK**, the test was expected to pass and it did.
  + **FAILURE**: Is **NOK**, the test was expected to pass, but it did not.
  + **UXSUCCESS**: Is **NOK**, the test was expected to fail, but it did not.
  + **XFAILURE**: Is **OK**, the test was expected to fail, and it did.
  + **ERROR**: Is **NOK** an unexpected error during testing arose.
* The tests can be compounded into compound tests, which are visible as a tree of tests and sub-tests.
* The duration of non-compound tests is shown in the third column, this is a rough estimate, measured from before the APDU is sent, to just after the response is received.
* The cause of the test result, is shown in the last column, for non-compound tests, these are JavaCard(or custom) status words, from operations done on the card.

If you are interested in testing support for other JavaCard algorithms, please visit JCAlgTester project: <https://github.com/crocs-muni/JCAlgTest>

Snippet below shows collection of 1000 of ECDSA signatures (`--ecdsa`) over a prime field (`-fp`) 160 bit (`-b`) curve, which will be the `secp160r1` curve, because of the `-u` switch, which selects one of the SECG curves for the bit-length. The applet signes randomly generated but static data using a fixed key (`--fixed`). Timing data is collected and output in nanoseconds (`--time-unit`) and output into `out.csv`.

```
> java -jar ECTesterReader.jar --ecdsa 1000 -fp -b 160 -u --fixed --time-unit nano -o out.csv
Allocate Signature(ALG_ECDSA_SHA) object                               ┃   10 ms ┃  OK   (0x9000)
Allocate local keypair 160b ALG_EC_FP                                  ┃   57 ms ┃  OK   (0x9000)
Set secp160r1 curve parameters on local keypair                        ┃    0 ms ┃  OK   (0x9000)
Generate local keypair                                                 ┃   49 ms ┃  OK   (0x9000)
Export keypair params from both keys of local keypair                  ┃    0 ms ┃  OK   (0x9000)
ALG_ECDSA_SHA signature with local keypair(provided data)              ┃   31 ms ┃  OK   (0x9000)
ALG_ECDSA_SHA verification with local keypair(provided data)           ┃   40 ms ┃  OK   (0x9000)
ALG_ECDSA_SHA signature with local keypair(provided data)              ┃   12 ms ┃  OK   (0x9000)
ALG_ECDSA_SHA verification with local keypair(provided data)           ┃   19 ms ┃  OK   (0x9000)
ALG_ECDSA_SHA signature with local keypair(provided data)              ┃   14 ms ┃  OK   (0x9000)
ALG_ECDSA_SHA verification with local keypair(provided data)           ┃   19 ms ┃  OK   (0x9000)
ALG_ECDSA_SHA signature with local keypair(provided data)              ┃   14 ms ┃  OK   (0x9000)
...

```

The output of the above command, `out.csv` looks something like this:

```
index;signTime[nano];verifyTime[nano];data;pubW;privS;signature[SHA1];nonce;valid
0;26255357;28391390;a82187036e952ef2facb119b283883473944a0705f6e5979bf941789006b1b66;0463456917124646414c737ab5b2f83cf14d87139d047eac35b3e045a3e779ba345150d02e334454a8;3ebe95d4fda4988e000cba9b0cce25992da0f11d;302c02144be3feb924778b4ef4dff059935a53ca38b5016c02144161ca9cce5afbe2d06fd37379200eec0ad9c9d3;00c79485ede7e464b8c37312008fc54fea69d75463;1
1;14306042;20846855;a82187036e952ef2facb119b283883473944a0705f6e5979bf941789006b1b66;0463456917124646414c737ab5b2f83cf14d87139d047eac35b3e045a3e779ba345150d02e334454a8;3ebe95d4fda4988e000cba9b0cce25992da0f11d;302d021500a3684c699aded3af7b6e9c2d5bd033974443588c02143ee89959bb25c524da19b90f852e0dfcdb4ed6f6;00d9e1ad90d83dd3fc23b91061de6abf094e23e15a;1
2;16327883;18140346;a82187036e952ef2facb119b283883473944a0705f6e5979bf941789006b1b66;0463456917124646414c737ab5b2f83cf14d87139d047eac35b3e045a3e779ba345150d02e334454a8;3ebe95d4fda4988e000cba9b0cce25992da0f11d;302d0214429d54da93314437c5e1dd8a5244050f6b810dd3021500b989c5f990e702f319fb862d74172f5cc704e968;6206c53cabfc51fdcce5b5c551f091ddc5064dc2;1
3;19589990;37379094;a82187036e952ef2facb119b283883473944a0705f6e5979bf941789006b1b66;0463456917124646414c737ab5b2f83cf14d87139d047eac35b3e045a3e779ba345150d02e334454a8;3ebe95d4fda4988e000cba9b0cce25992da0f11d;302c02142017caabf802f18c5ac26d7b9c4679d34fcbd335021442a6dd6d63e136a27cda25e0e6197db4a30a9609;00ecdd91d35735d084dfb912d4aeca7e3f68cf2cd5;1
4;15369903;22086733;a82187036e952ef2facb119b283883473944a0705f6e5979bf941789006b1b66;0463456917124646414c737ab5b2f83cf14d87139d047eac35b3e045a3e779ba345150d02e334454a8;3ebe95d4fda4988e000cba9b0cce25992da0f11d;302e021500c82cb5d17aa2c1e13659c3ee0be8896f8e416731021500a1bdbfb48c46490c82af88f590c79d5770916c79;0094f752027314501b3586295c660576c184d9c9ee;1

```

This output can be then analysed using Jupyter notebooks in the `util` directory, see [analysis](#analysis) for more.

Snippet below shows output of the info command:

```
> java -jar ECTesterReader.jar -nf
Card ATR:				                3bdb960080b1fe451f830031c064c308010001900095
Card protocol:				            T=1
ECTester applet version:		        v0.3.3
ECTester applet APDU support:		    extended length
JavaCard API version:			        2.2
JavaCard supports system cleanup:	    true
Array sizes (apduBuf,ram,ram2,apduArr):	635 256 256 512

```

## Standalone library testing

The standalone part of ECTester targets testing elliptic curve cryptography implementations in Java and native cryptographic libraries.

Currently supported libraries include:

* [BouncyCastle](https://bouncycastle.org/java.html) (Java)
* [Sun EC](https://docs.oracle.com/javase/7/docs/technotes/guides/security/SunProviders.html#SunEC) (Java)
* [OpenSSL](https://www.openssl.org/)
* [BoringSSL](https://boringssl.googlesource.com/boringssl)
* [wolfSSL](https://www.wolfssl.com/)
* [Crypto++](https://cryptopp.com/)
* [libtomcrypt](http://www.libtom.net/LibTomCrypt/)
* [libgcrypt](https://www.gnupg.org/related_software/libgcrypt/)
* [Botan](https://botan.randombit.net/)
* [Microsoft CNG](https://msdn.microsoft.com/en-us/library/windows/desktop/aa376210%28v%3Dvs.85%29.aspx)
* [Intel Performance Primitives Crypto](https://github.com/intel/ipp-crypto)
* [MbedTLS](https://github.com/ARMmbed/mbedtls)
* [Nettle](https://www.lysator.liu.se/~nisse/nettle/)
* [LibreSSL](https://www.libressl.org/)

For more information on ECC libraries see [LIBS](/crocs-muni/ECTester/blob/master/docs/LIBS.md).

### Setup

ECTester interfaces with native libraries by using custom shim libraries that expose the functionality via the
[Java Native Interface](https://en.wikipedia.org/wiki/Java_Native_Interface), these can be found in the
[standalone/src/main/java/cz/crcs/ectester/standalone/libs/jni](/crocs-muni/ECTester/blob/master/standalone/src/main/java/cz/crcs/ectester/standalone/libs/jni) directory along with a Makefile
(Makefile.bat for Windows). The shim library will depend on the native library, and have a name like
`boringssl_provider.so`, `botan_provider.so`, `cryptopp_provider.so` and `openssl_provider.so`.
The Makefile has a target for every library that it supports that builds its shim, see the `help`
target for more info.

However, building these shims and in general the target libraries can be tricky to do so reliably across
systems and setups. Thus ECTester offers two ways of doing so.

* The first way is to install the libraries system-wide and rely on pkg-config to find proper configuration
  for the shims and link them dynamically.
* The second way is to use [Nix](https://nixos.org/) to build the given versions of the libraries and shims and
  link them statically.

#### Nix

Install [Nix](https://nixos.org/download/), then to build:

```
# To build a library in a given version run (example OpenSSL 3.3.1):
nix build "#lib.openssl.v331"
# To build a shim using a given version of a library (example mbedTLS 3.5):
nix build "#shim.mbedtls.v35"
# To build ECTesterStandalone.jar with a given version of a library (example libgcrypt 1.9.4):
nix build "?submodules=1#gcrypt.v194"

# The available versions of the libraries are in the nix/*_pkg_versions.json files.
# The "default" version always points to the most recent version.
# To build ECTesterStandalone with all the libraries in default versions:
nix build "?submodules=1#"
```

Each of the build steps above puts (symlinks really) its results into `./result` directory.
However, subsequent builds then replace that with their own results. To run ECTesterStandalone
with a given library version and arguments do:

```
# This runs the default test-suite agains LibreSSL 3.9.2
nix run "?submodules=1#libressl.v392" --- test default LibreSSL
```

#### Gradle

```
./gradlew :standalone:libs                    # To build the native library shims.
./gradlew :standalone:uberJar                 # To build the standalone tool (jar) -> "standalone/build/libs/ECTesterStandalone.jar"
```

Simply doing the above should build everything necessary to test libraries via the standalone app,
(except the BoringSSL, LibreSSL, ipp-crypto, mbedTLS, and wolfCrypt libraries)
the sections below describe the details of how that works and what needs to be done if it doesn't.

To see whether your build was successful, run:
`java -jar standalone/build/libs/ECTesterStandalone.jar list-libs` and observe if your target libraries are included in
the output. If they are not, and they are native libraries, it means that either the shim library was not built
successfully or that the actual native library couldn't be found and loaded on runtime. To solve the former, look for
build errors during the ant run in the `libs-try` step, for the latter, if the library is in an non-standard location
specifying `LD_LIBRARY_PATH` will help load it. Consulting the next sections should help solve both.

The `:standalone:libs` task invokes the Makefile, which tries to build the
C/C++ shim libraries required for ECTester to test the actual native cryptographic libraries from Java.
The Makefile uses pkg-config to locate the libraries installed, thus if non-standard location of the tested libraries is
used, the Makefile or your pkg-config needs some changes to work.

There are two important environmental variables that should be set in your environment. First, you should set
`JAVA_HOME` which should point to your JDK. The tooling uses `JAVA_HOME` to locate native Java library headers,
like `jni.h`. Second, ECTester uses pkg-config to locate the native libraries, if your pkg-config files are in an
unusual place the pkg-config command would not find them by default, you should set `PKG_CONFIG_PATH` to the directory
containing the `*.pc` files. If pkg-config files are unavailable for the library you are trying to test, you will need
to change the Makefile manually to apply the correct options to the commands (CFLAGS, include options, linker options...).

Below you can see how a full build with all the libraries currently supported on Linux looks

```
> cd standalone/src/main/resources/cz/crcs/ectester/standalone/libs/jni
> make -f Makefile.ext
cc -DLTM_DESC  -fPIC -I"/usr/lib/jvm/java-21-openjdk/include" -I"/usr/lib/jvm/java-21-openjdk/include/linux" -I. -Wno-deprecated-declarations -O2 -c tomcrypt.c
cc -fPIC -I"/usr/lib/jvm/java-21-openjdk/include" -I"/usr/lib/jvm/java-21-openjdk/include/linux" -I. -Wno-deprecated-declarations -O2 -c c_utils.c
cc -o lib_timing.so -shared -fPIC -I"/usr/lib/jvm/java-21-openjdk/include" -I"/usr/lib/jvm/java-21-openjdk/include/linux" -I. -Wno-deprecated-declarations -O2 -Wl,-soname,lib_timing.so c_timing.c
cc -fPIC -shared -O2 -o tomcrypt_provider.so -Wl,-rpath,'$ORIGIN/lib' tomcrypt.o c_utils.o -L. -ltommath -ltomcrypt -l:lib_timing.so
g++ -I/usr/include/botan-2 -fPIC -I"/usr/lib/jvm/java-21-openjdk/include" -I"/usr/lib/jvm/java-21-openjdk/include/linux" -I. -Wno-deprecated-declarations -O2 -c botan.cpp
g++ -fPIC -I"/usr/lib/jvm/java-21-openjdk/include" -I"/usr/lib/jvm/java-21-openjdk/include/linux" -I. -Wno-deprecated-declarations -O2 -c cpp_utils.cpp
g++ -fPIC -shared -O2 -o botan_provider.so -Wl,-rpath,'$ORIGIN/lib' botan.o cpp_utils.o -L. -lbotan-2 -fstack-protector -m64 -pthread -l:lib_timing.so
g++  -fPIC -I"/usr/lib/jvm/java-21-openjdk/include" -I"/usr/lib/jvm/java-21-openjdk/include/linux" -I. -Wno-deprecated-declarations -O2 -c cryptopp.cpp
g++ -fPIC -shared -O2 -o cryptopp_provider.so -Wl,-rpath,'$ORIGIN/lib' cryptopp.o cpp_utils.o -L. -lcryptopp -l:lib_timing.so
cc  -fPIC -I"/usr/lib/jvm/java-21-openjdk/include" -I"/usr/lib/jvm/java-21-openjdk/include/linux" -I. -Wno-deprecated-declarations -O2 -c openssl.c
cc -fPIC -shared -O2 -o openssl_provider.so -Wl,-rpath,'$ORIGIN/lib' openssl.o c_utils.o -L. -lssl -lcrypto -l:lib_timing.so
cc -I../../../../../../../../../../boringssl/include/ -fPIC -I"/usr/lib/jvm/java-21-openjdk/include" -I"/usr/lib/jvm/java-21-openjdk/include/linux" -I. -Wno-deprecated-declarations -O2 -c boringssl.c
cp ../../../../../../../../../../boringssl/build/crypto/libcrypto.so lib_boringssl.so
cc -fPIC -shared -O2 -o boringssl_provider.so -Wl,-rpath,'$ORIGIN/lib' boringssl.o c_utils.o -L. lib_boringssl.so -l:lib_timing.so
cc -I/usr/local/include -fPIC -I"/usr/lib/jvm/java-21-openjdk/include" -I"/usr/lib/jvm/java-21-openjdk/include/linux" -I. -Wno-deprecated-declarations -O2 -c gcrypt.c
cc -fPIC -shared -O2 -o gcrypt_provider.so -Wl,-rpath,'$ORIGIN/lib' gcrypt.o c_utils.o -L. -L/usr/local/lib -lgcrypt -lgpg-error -l:lib_timing.so
cc -I../../../../../../../../../../ext/mbedtls/include/ -fPIC -I"/usr/lib/jvm/java-21-openjdk/include" -I"/usr/lib/jvm/java-21-openjdk/include/linux" -I. -Wno-deprecated-declarations -O2 -c mbedtls.c
cp ../../../../../../../../../../ext/mbedtls/build/library/libmbedcrypto.so lib_mbedtls.so
cc -fPIC -shared -O2 -o mbedtls_provider.so -Wl,-rpath,'$ORIGIN/lib' mbedtls.o c_utils.o -L. lib_mbedtls.so -l:lib_timing.so
cc -I../../../../../../../../../../ipp-crypto/build/.build/RELEASE/include/ -fPIC -I"/usr/lib/jvm/java-21-openjdk/include" -I"/usr/lib/jvm/java-21-openjdk/include/linux" -I. -Wno-deprecated-declarations -O2 -c ippcp.c
cp ../../../../../../../../../../ipp-crypto/build/.build/RELEASE/lib/libippcp.so lib_ippcp.so
cc -fPIC -shared -O2 -o ippcp_provider.so -Wl,-rpath,'$ORIGIN/lib' ippcp.o c_utils.o -L. lib_ippcp.so -l:lib_timing.so
cc  -lhogweed -lgmp -fPIC -I"/usr/lib/jvm/java-21-openjdk/include" -I"/usr/lib/jvm/java-21-openjdk/include/linux" -I. -Wno-deprecated-declarations -O2 -c nettle.c
cc -fPIC -shared -O2 -o nettle_provider.so -Wl,-rpath,'$ORIGIN/lib' nettle.o c_utils.o -L. -lnettle -l:lib_timing.so -lhogweed -lgmp
cc -I../../../../../../../../../../ext/libressl/include/ -fPIC -I"/usr/lib/jvm/java-21-openjdk/include" -I"/usr/lib/jvm/java-21-openjdk/include/linux" -I. -Wno-deprecated-declarations -O2 -c libressl.c
cp ../../../../../../../../../../ext/libressl/build/crypto/libcrypto.so lib_libressl.so
cc -fPIC -shared -O2 -o libressl_provider.so -Wl,-rpath,'$ORIGIN/lib' libressl.o c_utils.o -L. lib_libressl.so -l:lib_timing.so

```

BoringSSL, LibreSSL, ipp-crypto, mbedTLS and partially wolfCrypt are included as git submodules.
Make sure you run: `git submodule update --init --recursive`
after checking out the ECTester repository to initialize them.

To build BoringSSL do:

```
cd ext/boringssl
cmake -GNinja -Bbuild -DBUILD_SHARED_LIBS=1
cd build
ninja
```

To build LibreSSL do:

```
cd ext/libressl
./autogen.sh
cmake -GNinja -Bbuild -DBUILD_SHARED_LIBS=1
cd build
ninja
```

To build ipp-crypto do:
(Make sure you have the necessary [build requirements](https://github.com/intel/ipp-crypto/blob/develop/BUILD.md))

```
cd ext/ipp-crypto
CC=clang CXX=clang++ cmake CMakeLists.txt -GNinja -Bbuild -DARCH=intel64  # Does not work with GCC 12+
cd build
ninja
```

To build mbedTLS do:

```
cd ext/mbedtls
python -m venv virt
. virt/bin/activate
pip install -r scripts/basic.requirements.txt
cmake -GNinja -Bbuild -DUSE_SHARED_MBEDTLS_LIBRARY=On
cd build
ninja
```

To build wolfCrypt-JNI do:
(You need to have wolfSSL installed and ready for development)

```
cd ext/wolfcrypt-jni
mkdir junit
wget -P junit/ https://repo1.maven.org/maven2/junit/junit/4.13.2/junit-4.13.2.jar
wget -P junit/ https://repo1.maven.org/maven2/org/hamcrest/hamcrest-all/1.3/hamcrest-all-1.3.jar
make -f makefile.linux
env JUNIT_HOME=junit/ ant build-jce-release
```

The produced `lib/wolfcrypt-jni.jar` will be automatically included into the standalone JAR when building `standalone:uberJar`.
However, the produced `lib/libwolfcryptjni.so` native library will not be automatically loaded. You thus need to include it
on `LD_LIBRARY_PATH`.

Consult the GitHub CI [build script](/crocs-muni/ECTester/blob/master/.github/workflows/build.yml) for an example that runs on Ubuntu 22.04.

### Examples

Snippet below shows how the `list-libs` command for well, listing currently supported libraries, behaves if all supported libraries are present (on Linux).

```
> java -jar ECTesterStandalone.jar list-libs
	- SunEC
		- Fullname: SunEC
		- Version: 21
		- Supports native timing: []
		- Supports deterministic PRNG: true
		- KeyPairGenerators: EC, Ed25519, Ed448, EdDSA, X25519, X448, XDH
		- KeyAgreements: ECDH, X25519, X448, XDH
		- Signatures: ECDSA, Ed25519, Ed448, EdDSA, NONEwithECDSA, SHA224withECDSA, SHA256withECDSA, SHA3-224withECDSA, SHA3-256withECDSA, SHA3-384withECDSA, SHA3-512withECDSA, SHA384withECDSA, SHA512withECDSA
		- Curves: secp256r1, secp384r1, secp521r1

	- BouncyCastle
		- Fullname: BC
		- Version: 1.77
		- Supports native timing: []
		- Supports deterministic PRNG: true
		- KeyPairGenerators: EC, ECDH, ECDHC, ECDSA, ECMQV, Ed25519, Ed448, EdDSA, X25519, X448, XDH
		- KeyAgreements: ECCDHwithSHA1KDF, ECCDHwithSHA224KDF, ECCDHwithSHA256KDF, ECCDHwithSHA384KDF, ECCDHwithSHA512KDF, ECDH, ECDHC, ECDHwithSHA1KDF, ECDHwithSHA224KDF, ECDHwithSHA256KDF, ECDHwithSHA384KDF, ECDHwithSHA512KDF, X25519, X448, XDH
		- Signatures: ECDDSA, ECDSA, ECGOST3410, ECGOST3410-2012-256, ECGOST3410-2012-512, Ed25519, Ed448, EdDSA, GOST3411-2012-256withECGOST3410-2012-256, GOST3411-2012-512withECGOST3410-2012-512, GOST3411withECGOST3410, NONEwithECDSA, RIPEMD160withECDSA, RIPEMD160withPLAIN-ECDSA, SHA1withCVC-ECDSA, SHA1withECNR, SHA1withPLAIN-ECDSA, SHA224withCVC-ECDSA, SHA224withECDDSA, SHA224withECDSA, SHA224withECNR, SHA224withPLAIN-ECDSA, SHA256withCVC-ECDSA, SHA256withECDDSA, SHA256withECDSA, SHA256withECNR, SHA256withPLAIN-ECDSA, SHA3-224withECDDSA, SHA3-224withECDSA, SHA3-256withECDDSA, SHA3-256withECDSA, SHA3-384withECDDSA, SHA3-384withECDSA, SHA3-512withECDDSA, SHA3-512withECDSA, SHA384withCVC-ECDSA, SHA384withECDDSA, SHA384withECDSA, SHA384withPLAIN-ECDSA, SHA512withCVC-ECDSA, SHA512withECDDSA, SHA512withECDSA, SHA512withECNR, SHA512withPLAIN-ECDSA, SM3withSM2
		- Curves: B-163, B-233, B-283, B-409, B-571, FRP256v1, GostR3410-2001-CryptoPro-A, GostR3410-2001-CryptoPro-B, GostR3410-2001-CryptoPro-C, GostR3410-2001-CryptoPro-XchA, GostR3410-2001-CryptoPro-XchB, K-163, K-233, K-283, K-409, K-571, P-192, P-224, P-256, P-384, P-521, Tc26-Gost-3410-12-256-paramSetA, Tc26-Gost-3410-12-512-paramSetA, Tc26-Gost-3410-12-512-paramSetB, Tc26-Gost-3410-12-512-paramSetC, brainpoolP160r1, brainpoolP160t1, brainpoolP192r1, brainpoolP192t1, brainpoolP224r1, brainpoolP224t1, brainpoolP256r1, brainpoolP256t1, brainpoolP320r1, brainpoolP320t1, brainpoolP384r1, brainpoolP384t1, brainpoolP512r1, brainpoolP512t1, c2pnb163v1, c2pnb163v2, c2pnb163v3, c2pnb176w1, c2pnb208w1, c2pnb272w1, c2pnb304w1, c2pnb368w1, c2tnb191v1, c2tnb191v2, c2tnb191v3, c2tnb239v1, c2tnb239v2, c2tnb239v3, c2tnb359v1, c2tnb431r1, prime192v1, prime192v2, prime192v3, prime239v1, prime239v2, prime239v3, prime256v1, secp112r1, secp112r2, secp128r1, secp128r2, secp160k1, secp160r1, secp160r2, secp192k1, secp192r1, secp224k1, secp224r1, secp256k1, secp256r1, secp384r1, secp521r1, sect113r1, sect113r2, sect131r1, sect131r2, sect163k1, sect163r1, sect163r2, sect193r1, sect193r2, sect233k1, sect233r1, sect239k1, sect283k1, sect283r1, sect409k1, sect409r1, sect571k1, sect571r1, sm2p256v1, wapi192v1, wapip192v1

	- tomcrypt
		- Fullname: libtomcrypt 1.18.2
		- Version: 1.18
		- Supports native timing: [cputime-processor, cputime-thread, monotonic, monotonic-raw, rdtsc]
		- Supports deterministic PRNG: true
		- KeyPairGenerators: EC
		- KeyAgreements: ECDH
		- Signatures: NONEwithECDSA
		- Curves: ECC-192, ECC-224, ECC-256, ECC-384, ECC-521, SECP112R1, SECP128R1, SECP160R1

	- Botan
		- Fullname: Botan 2.19.5
		- Version: 2.193
		- Supports native timing: [cputime-processor, cputime-thread, monotonic, monotonic-raw, rdtsc]
		- Supports deterministic PRNG: true
		- KeyPairGenerators: ECDH, ECDSA, ECGDSA, ECKCDSA
		- KeyAgreements: ECDH, ECDHwithSHA1KDF, ECDHwithSHA224KDF, ECDHwithSHA256KDF, ECDHwithSHA384KDF, ECDHwithSHA512KDF
		- Signatures: ECDSA, ECGDSA, ECKCDSA, NONEwithECDSA, NONEwithECGDSA, NONEwithECKCDSA, SHA224withECDSA, SHA224withECGDSA, SHA224withECKCDSA, SHA256withECDSA, SHA256withECKCDSA, SHA384withECDSA, SHA384withECGDSA, SHA384withECKCDSA, SHA512withECDSA, SHA512withECGDSA, SHA512withECKCDSA
		- Curves: brainpool160r1, brainpool192r1, brainpool224r1, brainpool256r1, brainpool320r1, brainpool384r1, brainpool512r1, frp256v1, gost_256A, gost_512A, secp160k1, secp160r1, secp160r2, secp192k1, secp192r1, secp224k1, secp224r1, secp256k1, secp256r1, secp384r1, secp521r1, sm2p256v1, x962_p192v2, x962_p192v3, x962_p239v1, x962_p239v2, x962_p239v3

	- Crypto++
		- Fullname: Crypto++
		- Version: 8.0
		- Supports native timing: [cputime-processor, cputime-thread, monotonic, monotonic-raw, rdtsc]
		- Supports deterministic PRNG: true
		- KeyPairGenerators: ECDH, ECDSA
		- KeyAgreements: ECDH
		- Signatures: ECDSA, SHA224withECDSA, SHA256withECDSA, SHA384withECDSA, SHA512withECDSA
		- Curves: 1.2.156.10197.1.301, 1.2.156.10197.1.301.3.1, 1.2.840.10045.3.1.1, 1.2.840.10045.3.1.7, 1.3.132.0.1, 1.3.132.0.10, 1.3.132.0.15, 1.3.132.0.16, 1.3.132.0.17, 1.3.132.0.2, 1.3.132.0.22, 1.3.132.0.23, 1.3.132.0.24, 1.3.132.0.25, 1.3.132.0.26, 1.3.132.0.27, 1.3.132.0.28, 1.3.132.0.29, 1.3.132.0.3, 1.3.132.0.30, 1.3.132.0.31, 1.3.132.0.32, 1.3.132.0.33, 1.3.132.0.34, 1.3.132.0.35, 1.3.132.0.36, 1.3.132.0.37, 1.3.132.0.38, 1.3.132.0.39, 1.3.132.0.4, 1.3.132.0.5, 1.3.132.0.6, 1.3.132.0.7, 1.3.132.0.8, 1.3.132.0.9, 1.3.36.3.3.2.8.1.1.1, 1.3.36.3.3.2.8.1.1.11, 1.3.36.3.3.2.8.1.1.13, 1.3.36.3.3.2.8.1.1.3, 1.3.36.3.3.2.8.1.1.5, 1.3.36.3.3.2.8.1.1.7, 1.3.36.3.3.2.8.1.1.9

	- OpenSSL
		- Fullname: OpenSSL 3.2.1 30 Jan 2024
		- Version: 3.2
		- Supports native timing: [cputime-processor, cputime-thread, monotonic, monotonic-raw, rdtsc]
		- Supports deterministic PRNG: true
		- KeyPairGenerators: EC
		- KeyAgreements: ECDH
		- Signatures: NONEwithECDSA
		- Curves: Oakley-EC2N-3, Oakley-EC2N-4, SM2, brainpoolP160r1, brainpoolP160t1, brainpoolP192r1, brainpoolP192t1, brainpoolP224r1, brainpoolP224t1, brainpoolP256r1, brainpoolP256t1, brainpoolP320r1, brainpoolP320t1, brainpoolP384r1, brainpoolP384t1, brainpoolP512r1, brainpoolP512t1, c2pnb163v1, c2pnb163v2, c2pnb163v3, c2pnb176v1, c2pnb208w1, c2pnb272w1, c2pnb304w1, c2pnb368w1, c2tnb191v1, c2tnb191v2, c2tnb191v3, c2tnb239v1, c2tnb239v2, c2tnb239v3, c2tnb359v1, c2tnb431r1, prime192v1, prime192v2, prime192v3, prime239v1, prime239v2, prime239v3, prime256v1, secp112r1, secp112r2, secp128r1, secp128r2, secp160k1, secp160r1, secp160r2, secp192k1, secp224k1, secp224r1, secp256k1, secp384r1, secp521r1, sect113r1, sect113r2, sect131r1, sect131r2, sect163k1, sect163r1, sect163r2, sect193r1, sect193r2, sect233k1, sect233r1, sect239k1, sect283k1, sect283r1, sect409k1, sect409r1, sect571k1, sect571r1, wap-wsg-idm-ecid-wtls1, wap-wsg-idm-ecid-wtls10, wap-wsg-idm-ecid-wtls11, wap-wsg-idm-ecid-wtls12, wap-wsg-idm-ecid-wtls3, wap-wsg-idm-ecid-wtls4, wap-wsg-idm-ecid-wtls5, wap-wsg-idm-ecid-wtls6, wap-wsg-idm-ecid-wtls7, wap-wsg-idm-ecid-wtls8, wap-wsg-idm-ecid-wtls9

	- BoringSSL
		- Fullname: OpenSSL 1.1.1 (compatible; BoringSSL)
		- Version: 1.11
		- Supports native timing: [cputime-processor, cputime-thread, monotonic, monotonic-raw, rdtsc]
		- Supports deterministic PRNG: false
		- KeyPairGenerators: EC
		- KeyAgreements: ECDH
		- Signatures: NONEwithECDSA
		- Curves: prime256v1, secp224r1, secp384r1, secp521r1

	- libgcrypt
		- Fullname: libgcrypt 1.11.0-unknown
		- Version: 1.11
		- Supports native timing: [cputime-processor, cputime-thread, monotonic, monotonic-raw, rdtsc]
		- Supports deterministic PRNG: false
		- KeyPairGenerators: EC
		- KeyAgreements: ECDH
		- Signatures: ECDDSA, ECDSA, NONEwithECDSA, SHA224withECDDSA, SHA224withECDSA, SHA256withECDDSA, SHA256withECDSA, SHA384withECDDSA, SHA384withECDSA, SHA512withECDDSA, SHA512withECDSA
		- Curves: Curve25519, Ed25519, Ed448, GOST2001-CryptoPro-A, GOST2001-CryptoPro-B, GOST2001-CryptoPro-C, GOST2001-test, GOST2012-256-A, GOST2012-512-tc26-A, GOST2012-512-tc26-B, GOST2012-512-tc26-C, GOST2012-512-test, NIST P-192, NIST P-224, NIST P-256, NIST P-384, NIST P-521, X448, brainpoolP160r1, brainpoolP192r1, brainpoolP224r1, brainpoolP256r1, brainpoolP320r1, brainpoolP384r1, brainpoolP512r1, secp256k1, sm2p256v1

	- mbedTLS
		- Fullname: Mbed TLS 3.5.2
		- Version: 3.52
		- Supports native timing: [cputime-processor, cputime-thread, monotonic, monotonic-raw, rdtsc]
		- Supports deterministic PRNG: true
		- KeyPairGenerators: EC
		- KeyAgreements: ECDH
		- Signatures: NONEwithECDSA
		- Curves: brainpoolP256r1, brainpoolP384r1, brainpoolP512r1, secp192k1, secp192r1, secp224k1, secp224r1, secp256k1, secp256r1, secp384r1, secp521r1, x25519, x448

	- IPPCP
		- Fullname: ippCP AVX2 (l9)
		- Version: 2021.7
		- Supports native timing: [cputime-processor, cputime-thread, monotonic, monotonic-raw, rdtsc]
		- Supports deterministic PRNG: true
		- KeyPairGenerators: EC
		- KeyAgreements: ECDH
		- Signatures: NONEwithECDSA
		- Curves: secp112r1, secp112r2, secp128r1, secp128r2, secp160r1, secp160r2, secp192r1, secp224r1, secp256r1, secp384r1, secp521r1

	- Nettle
		- Fullname: Nettle
		- Version: 3.9
		- Supports native timing: [cputime-processor, cputime-thread, monotonic, monotonic-raw, rdtsc]
		- Supports deterministic PRNG: true
		- KeyPairGenerators: EC
		- KeyAgreements: ECDH
		- Signatures: NONEwithECDSA
		- Curves: secp192r1, secp224r1, secp256r1, secp384r1, secp521r1

	- LibreSSL
		- Fullname: LibreSSL 3.9.0
		- Version: 3.9
		- Supports native timing: [cputime-processor, cputime-thread, monotonic, monotonic-raw, rdtsc]
		- Supports deterministic PRNG: false
		- KeyPairGenerators: EC
		- KeyAgreements: ECDH
		- Signatures: NONEwithECDSA
		- Curves: FRP256v1, brainpoolP160r1, brainpoolP160t1, brainpoolP192r1, brainpoolP192t1, brainpoolP224r1, brainpoolP224t1, brainpoolP256r1, brainpoolP256t1, brainpoolP320r1, brainpoolP320t1, brainpoolP384r1, brainpoolP384t1, brainpoolP512r1, brainpoolP512t1, prime192v1, prime192v2, prime192v3, prime239v1, prime239v2, prime239v3, prime256v1, secp112r1, secp112r2, secp128r1, secp128r2, secp160k1, secp160r1, secp160r2, secp192k1, secp224k1, secp224r1, secp256k1, secp384r1, secp521r1, wap-wsg-idm-ecid-wtls12, wap-wsg-idm-ecid-wtls6, wap-wsg-idm-ecid-wtls7, wap-wsg-idm-ecid-wtls8, wap-wsg-idm-ecid-wtls9

```

Snippet below demonstrates generation of 1000 (`-n`) keys on the named curve `secp256r1` (`-nc`) using the BouncyCastle library.

```
> java -jar ECTesterStandalone.jar generate -n 1000 -nc secg/secp256r1 Bouncy
index;time[nano];pubW;privS
0;18459241;04886c2d253490d6a80906628aea65dc6763fe53690241d54de1f479f44d120e6349528644b3736eda0a8a0326563c3a846a415e1ff029a22404718c91770349d4;532e9b01e439df0ae63f7ed0a9c5f57f91175fd21d80a1d048c93fda7b704522
1;1672835;049de329ce6d7d031a693143890ea7a277c0cb400b534b3a075614a1ec7d0b1e1680bd6791bb5027007ea286aa86a3af451e6772440be0adb3b19d249a47f8581e;00d69151b165880f93d18b4870b613e012ff00883192cd405d1fccd23e9001f9cc
2;1433582;04cdf57599adb2096259ce55cc7bb8f4278ea50e8eb40eece42b73f532ac92da1702da16dcfbc378170828dfab29e202aefcce98573d94b37a911ab6d69f4de690;7fb22f96166c90436caa3be55023750333c9b4101761dd5e5257d0909a377435
3;1388344;043f031b1efe0946c4cb4bf154c1ebefd63c3759aff2b021ae3338c99572fee66eb93dbd2f54907c55005df47618365f2f25238e8956cf27a132bc22ee1a014b5a;17c5e6164fced4ea35def7b6889797e10ac1c122044d139b56fd77bd6db973bd
4;1190134;043495f79ae0d6ef885ea4229da46b07aedd10bf7646f91fc7ccdce1f24839e7323e101cdd4acd90e8deb023faf324c1d8cb37421df38f268d28bc83a39297ee0b;6effde3b884f22ecd6e8dbe01e90c80587be9fa7fe39a0293e34c9254efb1210
5;858219;0472197b8c6622a1715e7a3cbb4e2fcdb58448880b35f65295c68992a2646904619d85f87896aeefdd1704d04a9f0956f5bd4c6147f01b1fdc0dbd1d82d9554c4a;73c2d2f87f83d8f568d4173b98eab8e9ded2e17a9561cd194adcbb3d139242d0
6;873804;04829646ac5dbf5324c217a0d24239e33bfd4680634ae70fc27a9884f38b4eac04416c5127eec915993fc4d89076e7540bc973644c0ba2b5a509386734693daf9b;7dd1eccbe8919fe3dd7612fb22fa5fd060f6cb40e0abdc0f9f977e1f949f9ca6
...

```

Snippet below demonstrates performing 10 ECDSA signatures, without hashing the message (`-t NONEwithECDSA`) on the `secp256r1` curve, with a fixed keypair throught the process (`--fixed`), utilizing the rdtsc instruction to measure duration (`--time-source`) and using the MatrixSSL library.

```
> java -jar ECTesterStandalone.jar ecdsa -n 10 -t NONEwithECDSA -nc secg/secp256r1 --fixed --time-source rdtsc OpenSSL
index;signTime[instr];verifyTime[instr];data;pubW;privS;signature[NONE];nonce;verified
0;6785333;18200703;24b064ff5a4d08df6f982d0e139677fb4e66602bea01e381e16d4d3614fd09d5;0429ef9b52fc5c9b8711c938820f4d15d6aab1dcd8aa5a80e754233f23c622a5a174cca795068aff9c979bff7e6f1345b529612a4d16df6adf56b8ac250a1fafc3;54d06d1a79b2b43dc072b96ca7b9f045fda84ac13f74ef81fab0d561a47d11d1;3045022070ca3dfe2017892d23a2301b2465ab387af7999c79de7dae53ec04d1600a25800221009fc9a6fe20c7930b9d8be40424ab4b08fa641f339efa81e6ccf5497cd71180f0;57ebf83913734ff0a78fa952da12996c48da17fbcf5967e74eb3e2c6b5e726b1;1
1;8582180;16170010;24b064ff5a4d08df6f982d0e139677fb4e66602bea01e381e16d4d3614fd09d5;0429ef9b52fc5c9b8711c938820f4d15d6aab1dcd8aa5a80e754233f23c622a5a174cca795068aff9c979bff7e6f1345b529612a4d16df6adf56b8ac250a1fafc3;54d06d1a79b2b43dc072b96ca7b9f045fda84ac13f74ef81fab0d561a47d11d1;3045022100efd3efc1bb2ed243eec9bea4bc331966e869c02df1fc8686a7649708c106595a022050e9a2548bac56bb3287f27c1761136947eefaa8a92f31978ed9485a03cb8f3d;0f5d3cc25d3eb69177b7917631f5639a088773873e91c1adb0a2b753987cace8;1
2;14906610;28661375;24b064ff5a4d08df6f982d0e139677fb4e66602bea01e381e16d4d3614fd09d5;0429ef9b52fc5c9b8711c938820f4d15d6aab1dcd8aa5a80e754233f23c622a5a174cca795068aff9c979bff7e6f1345b529612a4d16df6adf56b8ac250a1fafc3;54d06d1a79b2b43dc072b96ca7b9f045fda84ac13f74ef81fab0d561a47d11d1;3044022012ff4f949d1957c160ffdf5e53e6d3925c464954a79df2a613360e9513f647f5022001c337de39c78d16db21ee061a7f85cdd52a249570b59ef3f6c43f94a494a3a7;01525f491f4173281eb2f23877d816aa20f77f25ef87c9241dc130c2b862f923;1
3;14364756;17223863;24b064ff5a4d08df6f982d0e139677fb4e66602bea01e381e16d4d3614fd09d5;0429ef9b52fc5c9b8711c938820f4d15d6aab1dcd8aa5a80e754233f23c622a5a174cca795068aff9c979bff7e6f1345b529612a4d16df6adf56b8ac250a1fafc3;54d06d1a79b2b43dc072b96ca7b9f045fda84ac13f74ef81fab0d561a47d11d1;3046022100ddad3254d04df6914b886275b1d01939ea64481fba8bea2c4b3eac611ef3ce4a022100ca7702d7d1bea15bf7c8e77da9421e053e6b2235e3390fdcc0b60a69dc5cbc16;00810fe33ddc3dcee687f6310394c2f326d6024103e0b5dca97ddd157bb9d82721;1
4;8211882;14507032;24b064ff5a4d08df6f982d0e139677fb4e66602bea01e381e16d4d3614fd09d5;0429ef9b52fc5c9b8711c938820f4d15d6aab1dcd8aa5a80e754233f23c622a5a174cca795068aff9c979bff7e6f1345b529612a4d16df6adf56b8ac250a1fafc3;54d06d1a79b2b43dc072b96ca7b9f045fda84ac13f74ef81fab0d561a47d11d1;3046022100ae041e36e82c8f5d96f93beabb7bdfd070f88426b2b19ce53dea42f19a493500022100b20e409621effb91c92f79e3a125c02c16bdea3bbc6b690c47af8d87ff9994cf;54396537f7426576a6a0ba71bef63c5a1400b6baec9684807180696cb619ae5a;1
...

```

Snippet below demonstrates performing 10000 ECDH key agreements, using the curve name `secp256r1` (`-cn`, the difference between the `-cn` option and the `-nc` option is that the latter looks up the curve in ECTester's database and passes the parameters to the library explicitly, while the former passes the name to the library) using the MbedTLS library.

```
> java -jar ECTesterStandalone.jar ecdh -n 10000 -cn secp256r1 mbedTLS
index;time[nano];pubW;privS;secret[NONE]
0;5952101;04367ef86b5fbf1b4716bf7822342ebb19a9b6bcfbdb4f4950bf090ba2d1263579dac3e8447c21202432c76f89a0b48a1c16970e4fde67853c8d389da3f02fcdfc;00ecc7b46513149ab19fbeb1c49c1706712dc7da3899add30eb935e18fe5851d79;a94524fa98e0e5b3e139afdb89b73b843e48d5491b19585a5dcae02f20f13088
1;6099022;0439803db68efddbfc3fba1feae41118b02e35d009670fbb4c5dfe6a56fe20829b42e101d0c55bf905276ac71af7e215714cf41742c1f8a2d102761b9eb307d209;6f43118f50ddfef724288ad4f116354bec4735370cb221547b76b18832daaea9;d1b90ed000ca9542ac2101383397a7180cdcd6896b1ccfb5b719da734ad96bf1
2;6479870;0479a06bef6ad14e54f043c04a1747e9c4199a648651066274fef6a1e291ef01364968fe087c6d2bdbfc99118e3fa3c122362a9e84bd4e2d955fa1234d4d7b5fcf;3e3e7fb34c248c059a90cff03126fbb8bf72e27608c2a1aa6351ec393c560bb3;a455a16a834c73823ab44dd6124a50640b4bb5256beddb9cd6f4b1e98377e4b5
3;6071236;04e57a603e491c9139a61b56dce7cbef3f3c7bdae375a6ee7e99631c5d9318e4e88a5edbe7290f73e5d925b10ce5c6b20dcd00fb7bb24aa4b2a3305ac444838906;3b1464a35c007ed437265ad292ff56a67666456eff7de97ff3a87594b3827c9e;2daa2d01d04b677df66ca4293aa14d492239cb066b1a87915d92915c723ffb3b
4;6545463;04031c6fd3510a3381a0c8b3479a482b38bc5820a48c7bae4a2460805daf90d064441990bd1651a646c38d416ad8d4be39d4a4d58a19ed4532142148f80127412c;5dc92b7b09b91a2249d94b42083e7ad77a30b86a88d03db262d562477b3a7fc7;5520240090f83e506d915e43133fa0fe48338b29ee42279406ad63a7c10e57a1
5;7244349;0461f7ece97faeb52c367a550eb275b103b60f3beb8f07021f4e8c3991a95a454baca85b893fda2600ec56130de1117f0fbcc55bd9045abd1b26e7fc74cc701069;704f250ad24b94a1cdf3543954e9c5bfeb865a742c603a15cb7d7238807f113b;c74fca9cf311ea456ac0a0e8888f26de32716977f9ead6c15e0e3b066d7faa4c
6;6318854;042e99f9808b2b4c4fbf23a6d00a619e7f9d12035ab4c0a731d6eb8396e5caec5842ad551081fe2270eb8036dec88234d15b0f8a261cbc53eb9bc6c5d61704d1ec;4d3d375f5d6b27e1a6de8a154915fa7eec3871eac55da1e2a501e73f31a26c3c;407db9be0a58bc3c159fbb6b960dd9cd5bc90ebf79724660bb3e6d350ff07ed0
7;6730228;040b235b6b894351305d0c43625cf8eb4640627a506980e9e51d15be8fc3fb677165e95b4e235f3d6909a676b433d996d932840a731d13e0172858ba5e83ce0cc3;008bb99df5b2d1dc91e08eb03f9b5b1f599e00249ac1c0ca17c821e62e2a18d140;c0767fa0cbacee16d0058b5c1c1f7e42e3fcf663c43c76e67d5d2b443d454131
8;5522559;04acdec418cfa1ae61a3f969602480e362784e45f6c2d05e06ce30e363e616b6dcb00373d266fb9a5f731b88bb265b23683de5d5bbe35d709cafd3f57742fc6abf;00fe4f270444b99adaeae0bc525a857cb57d3075767183a15e5db9bc71aff8cbb2;e1fa8558593e56dd3108493d5171beb41922bbe23a6924525d2e0469c9de0cdb
...

```

Snippet below demonstrates the support for using a deterministic PRNG (`-ps`) in some of the libraries (see the output of `list-libs`):

```
> java -jar ECTesterStandalone.jar generate -n 5 -ps 1234 -b 256 Bouncy
index;time[nano];pubW;privS
0;33664582;04db8bdd6cb30d08a0355d48b65ddfc123944d29395f9f5e1bc2bfe70b4ee44ad39e4005df1e61251b4e9a9d8d47b78fd4ce98181883d2bfd634743758397f54ae;00e08df38827302c3315b833022189f61af3af9fbcb6e53697724374861f1982ee
1;3584575;0458bc7baf831c1a316a8deb9fb3109841f10d3cb8828b583b9883a518fa04633488e2fa991e70c98612c989fdfd6aa25118947e8a17bfc36ad1f51a8bdc473e3d;0f5a481f518751bbd2112e4fcc3d1ac60cd66a474af9a57cedbd1e62a52b6bd9
2;2746750;04827d7247b6d478cc85df313a9ea4f102301b0bd125b18e0111cd02e53b319830b2d0218551504cfc6b1226ac7fa430388f677cab2ea36997e344078328d12207;222898920190d28dac732b8e1fa69dd9907c667604c54db70c41b4815eafc94b
3;2828535;0473104cec678c5ea20857435f19280975c2a3b2d22e7f8005c33d019de6b707012960b96a80f0f358a69dcd5dd34c748cae3fa9f45b720f5a7d241017010c1af1;3fb2f7c3a15f86f000017e42f79557befe7472ff462d3321bc13a043c251345c
4;14181365;04854011114eb3e0fcf21f2416e0adbb0fc81d84530860ca40b6a86c85aa4e66b455382b71f8b6144f6294376912334ff1b23bb49da8fe1bda0e0e89ccbe9145f6;65675a954fff3287be1fc61dbb176f6784ece16c6b5675d556c57fd58974b358
> java -jar ECTesterStandalone.jar generate -n 5 -ps 1234 -b 256 Bouncy
index;time[nano];pubW;privS
0;35138528;04db8bdd6cb30d08a0355d48b65ddfc123944d29395f9f5e1bc2bfe70b4ee44ad39e4005df1e61251b4e9a9d8d47b78fd4ce98181883d2bfd634743758397f54ae;00e08df38827302c3315b833022189f61af3af9fbcb6e53697724374861f1982ee
1;2351304;0458bc7baf831c1a316a8deb9fb3109841f10d3cb8828b583b9883a518fa04633488e2fa991e70c98612c989fdfd6aa25118947e8a17bfc36ad1f51a8bdc473e3d;0f5a481f518751bbd2112e4fcc3d1ac60cd66a474af9a57cedbd1e62a52b6bd9
2;3315124;04827d7247b6d478cc85df313a9ea4f102301b0bd125b18e0111cd02e53b319830b2d0218551504cfc6b1226ac7fa430388f677cab2ea36997e344078328d12207;222898920190d28dac732b8e1fa69dd9907c667604c54db70c41b4815eafc94b
3;2883430;0473104cec678c5ea20857435f19280975c2a3b2d22e7f8005c33d019de6b707012960b96a80f0f358a69dcd5dd34c748cae3fa9f45b720f5a7d241017010c1af1;3fb2f7c3a15f86f000017e42f79557befe7472ff462d3321bc13a043c251345c
4;2060970;04854011114eb3e0fcf21f2416e0adbb0fc81d84530860ca40b6a86c85aa4e66b455382b71f8b6144f6294376912334ff1b23bb49da8fe1bda0e0e89ccbe9145f6;65675a954fff3287be1fc61dbb176f6784ece16c6b5675d556c57fd58974b358

```

It is recommended to disable [CPU frequency scaling](https://wiki.archlinux.org/index.php/CPU_frequency_scaling) of your processor before performing collection of timing data, as it adds significant noise to the data as it kicks in. Also, running the collection on very high priority and locked to a single core (`taskset -c 0`) helps as well.

## Analysis

ECTester contains a few Jupyter notebooks that perform timing analysis on data generated by either the ECTester reader app or the standalone app. These notebooks currently operate on data from the ECDSA, ECDH or key generation commands.

[![ECDSA at mybinder.org](https://camo.githubusercontent.com/b18f3e30537f3b3e5a73b0b3e076c8235824295cb95c70a2bc0c65c665f7a3cb/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c61756e63682d45434453412d3537394143412e7376673f6c6f676f3d646174613a696d6167652f706e673b6261736536342c6956424f5277304b47676f414141414e535568455567414141466b414141425a43414d41414142693158696441414142386c424d5645582f2f2f39586d73726d5a5948316f6c4a586d7372316f6c4a586d73726d5a5948316f6c4a586d7372316f6c4a586d73726d5a5948316f6c4c316f6c4a586d7372316f6c4a586d73726d5a5948316f6c4c316f6c4a586d73726d5a5948316f6c4a586d7372316f6c4c316f6c4a586d73726d5a5948316f6c4c316f6c4a586d73726d5a5948316f6c4c316f6c4c306e4666316f6c4a586d73726d5a5948316f6c4a586d737138645a62316f6c4a586d73726d5a5948316f6c4a586d7370586d7370586d7372316f6c4c316f6c4a586d73726d5a5948316f6c4a586d7372316f6c4c316f6c4a586d73726d5a5948316f6c4c316f6c4c65614956586d73726d5a5948316f6c4c316f6c4c316f6c4a586d73726d5a5948316f6c4c6e613331586d7372316f6c4a586d7372316f6c4a586d73726d5a5948316f6c4c716f5672316f6c4a586d7372316f6c4a586d73726d5a5948316f6c4c316f6c4b6b6661506f6258767669476162676164586d737154684b756f664b486d5a34446f626e72316f6c4a586d7372316f6c4a586d7370586d7372316f6c4a586d7372665a34547568576e316f6c4c316f6c4a586d737142693758316f6c4a586d73705a6d736c626d4d68626d7364656d7356666c385a676d734e696d384a706b3846306d3752346d3746356e4c42366a6268376a62694469724f4569624f476e4b614d68712b506e6143566736715767367165674b6166663657686e704b6f664b47746e6f6d78655a79336e6f4736645a692b6e33764363705044637050476e33624c62342f4d6234375562497256613472596f476a6461496265614958686f57486d5a59486f6258767063486a716448587265484c726f56727366472f7568476e75683262776a3248786b3137796c31767a6d6c6a7a6d316a306e6c58316f6c4c33414a58574141414162585253546c4d414542415148783867494341754c6a41774d447739505542415145705155464258563168675947426b6348427763586c3867494341676f69496b4a43516c4a69636e4a32676f4b436d714b2b77734c433475734441774d6a50304e4451314e6257334e7a67344f4469352b337638504477382f54303950583239766233392f66352b6672372b2f7a382f507a392f76372b7a637a43786741414243354a524546556541484e31756c336b3055554276436231435456706d706169744147534c537053754b434c577062544b4e4a46476c63534d414646363369556d5263634e4736674c6275786b585536364a415565662f394c53706d586e794c72335435414f2f727a6c357a6a31333770313336424953793434664b4a5875474e2f64313950556659654f36375a6e717466324b4833334964317073586f466457333073505a31734d767332443036304148717773344648654a6f6a4c5a716e773533636d6676672b5852386d43304f456a75787258456b5835796465564a4c56496c563065313050586b356b37645965487537436a316a2b3439754b6737754c55363174474c77316c713237756751596c636c4843346267763756512b5441796a355a632f556a735076733173643563577279574f6274765754324550613472746e5757334a6b706a67674570624f73507237463745794e657774704249736c41377034334843736e776f6f5854456333556d506d434e6e356c7271544a7879366e526d636176475a56742f334461327044354e4876734f484a43726463314732723344495470553779696337772f3752786e6a63306b7435474334646a697632537a3346623269455a6734312f64647346446f79755972496b6d4665687a304852327468506751714d79515962324f7442305778735a33426547332b7770526231767a6c325559426f6738466647687474464b6a7441636c6e5a5972526f397279473975472f465a515534414567385a45394c6a474d7a546d714b58504c6e6c57566e496c51515476784a663869703756676a5a6a795650726a77317465356f744d37526d5037786d2b734b32477639493847692b2b425262456b5239454277387a5255634b7877703733786b614c697151622b6b4764754a544e484737327a6357394c6f4a677151787050332f546a2f2f633379423074717a616d6c30352f2b6f72484c6b73564f2b39356b58372f3771674a766e6a6c72667232476773797830656f793975507a4e355350643836615867674f73454b573250727a37647533564944332f747a732f735352733277376f7656484b746a7258327064375a4d6c547841596642414c396a694477664c6b713535546d376966684d6c5447507943417337524652686e34374a6e6c634239524d355439374153755a584963564e755544496e647044626473667271734f707065586c35592b58564b646a464354682b7a476156756a3064397a79303550504b33517a42616d786477745443727a79672f3252766632457374556a6f72644777612f6b78396d534a4c72386d4c4c744357384848474a63325235685332313949694636506e5475734f71634d6c3537676d305a386b616e4b4d41516730715379755a666e377a4974736247794f39516c6e7859306543754431584c3279732f4d737251686c74453755673075464f7a75664a4645325078426f2f59417838585050644477574e304d72445259495a46306d534d4b434e4867614956466f42624e6f4c4a37744551444b784746306b634c51696d6f6a435a6f7076304f6b4e4f795743436739584d5641693741524a7a51644d3251556830676d426f7a6a6333536b6736645342527144475953554f7536365a672b4932664e5a732f4d332f662f47726c2f586e794631477733564b43657a30504e35495566464c717667554e344330714e715973355968504c2b61565a594445344970556b35376f53466e4a6d3446794371714f45306a685932534d794c466f6f35367a796f366265634f5335555644646a37566968307a702b74634d6877527042654c797174496a6c4a4b41495a5362493853475346336b307041336d52357448757750466f61374e3772656f713262714373416b314871437535757649316e364a755258492b53314d636f3534596d595477636e36416569632b6b73735869385870584334563374372f414475544e4b61514a6453634141414141456c46546b5375516d4343)](https://mybinder.org/v2/gh/crocs-muni/ECTester/master?filepath=util%2Fplot_dsa.ipynb) [![ECDH at mybinder.org](https://camo.githubusercontent.com/6043e8bf0ca328828d1a68e1d8bcc7b3347be3042e468ccbb723b9280577e925/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c61756e63682d454344482d3537394143412e7376673f6c6f676f3d646174613a696d6167652f706e673b6261736536342c6956424f5277304b47676f414141414e535568455567414141466b414141425a43414d41414142693158696441414142386c424d5645582f2f2f39586d73726d5a5948316f6c4a586d7372316f6c4a586d73726d5a5948316f6c4a586d7372316f6c4a586d73726d5a5948316f6c4c316f6c4a586d7372316f6c4a586d73726d5a5948316f6c4c316f6c4a586d73726d5a5948316f6c4a586d7372316f6c4c316f6c4a586d73726d5a5948316f6c4c316f6c4a586d73726d5a5948316f6c4c316f6c4c306e4666316f6c4a586d73726d5a5948316f6c4a586d737138645a62316f6c4a586d73726d5a5948316f6c4a586d7370586d7370586d7372316f6c4c316f6c4a586d73726d5a5948316f6c4a586d7372316f6c4c316f6c4a586d73726d5a5948316f6c4c316f6c4c65614956586d73726d5a5948316f6c4c316f6c4c316f6c4a586d73726d5a5948316f6c4c6e613331586d7372316f6c4a586d7372316f6c4a586d73726d5a5948316f6c4c716f5672316f6c4a586d7372316f6c4a586d73726d5a5948316f6c4c316f6c4b6b6661506f6258767669476162676164586d737154684b756f664b486d5a34446f626e72316f6c4a586d7372316f6c4a586d7370586d7372316f6c4a586d7372665a34547568576e316f6c4c316f6c4a586d737142693758316f6c4a586d73705a6d736c626d4d68626d7364656d7356666c385a676d734e696d384a706b3846306d3752346d3746356e4c42366a6268376a62694469724f4569624f476e4b614d68712b506e6143566736715767367165674b6166663657686e704b6f664b47746e6f6d78655a79336e6f4736645a692b6e33764363705044637050476e33624c62342f4d6234375562497256613472596f476a6461496265614958686f57486d5a59486f6258767063486a716448587265484c726f56727366472f7568476e75683262776a3248786b3137796c31767a6d6c6a7a6d316a306e6c58316f6c4c33414a58574141414162585253546c4d414542415148783867494341754c6a41774d447739505542415145705155464258563168675947426b6348427763586c3867494341676f69496b4a43516c4a69636e4a32676f4b436d714b2b77734c433475734441774d6a50304e4451314e6257334e7a67344f4469352b337638504477382f54303950583239766233392f66352b6672372b2f7a382f507a392f76372b7a637a43786741414243354a524546556541484e31756c336b3055554276436231435456706d706169744147534c537053754b434c577062544b4e4a46476c63534d414646363369556d5263634e4736674c6275786b585536364a415565662f394c53706d586e794c72335435414f2f727a6c357a6a31333770313336424953793434664b4a5875474e2f64313950556659654f36375a6e717466324b4833334964317073586f466457333073505a31734d767332443036304148717773344648654a6f6a4c5a716e773533636d6676672b5852386d43304f456a75787258456b5835796465564a4c56496c563065313050586b356b37645965487537436a316a2b3439754b6737754c55363174474c77316c713237756751596c636c4843346267763756512b5441796a355a632f556a735076733173643563577279574f6274765754324550613472746e5757334a6b706a67674570624f73507237463745794e657774704249736c41377034334843736e776f6f5854456333556d506d434e6e356c7271544a7879366e526d636176475a56742f334461327044354e4876734f484a43726463314732723344495470553779696337772f3752786e6a63306b7435474334646a697632537a3346623269455a6734312f64647346446f79755972496b6d4665687a304852327468506751714d79515962324f7442305778735a33426547332b7770526231767a6c325559426f6738466647687474464b6a7441636c6e5a5972526f397279473975472f465a515534414567385a45394c6a474d7a546d714b58504c6e6c57566e496c51515476784a663869703756676a5a6a795650726a77317465356f744d37526d5037786d2b734b32477639493847692b2b425262456b5239454277387a5255634b7877703733786b614c697151622b6b4764754a544e484737327a6357394c6f4a677151787050332f546a2f2f633379423074717a616d6c30352f2b6f72484c6b73564f2b39356b58372f3771674a766e6a6c72667232476773797830656f793975507a4e355350643836615867674f73454b573250727a37647533564944332f747a732f735352733277376f7656484b746a7258327064375a4d6c547841596642414c396a694477664c6b713535546d376966684d6c5447507943417337524652686e34374a6e6c634239524d355439374153755a584963564e755544496e647044626473667271734f707065586c35592b58564b646a464354682b7a476156756a3064397a79303550504b33517a42616d786477745443727a79672f3252766632457374556a6f72644777612f6b78396d534a4c72386d4c4c744357384848474a63325235685332313949694636506e5475734f71634d6c3537676d305a386b616e4b4d41516730715379755a666e377a4974736247794f39516c6e7859306543754431584c3279732f4d737251686c74453755673075464f7a75664a4645325078426f2f59417838585050644477574e304d72445259495a46306d534d4b434e4867614956466f42624e6f4c4a37744551444b784746306b634c51696d6f6a435a6f7076304f6b4e4f795743436739584d5641693741524a7a51644d3251556830676d426f7a6a6333536b6736645342527144475953554f7536365a672b4932664e5a732f4d332f662f47726c2f586e794631477733564b43657a30504e35495566464c717667554e344330714e715973355968504c2b61565a594445344970556b35376f53466e4a6d3446794371714f45306a685932534d794c466f6f35367a796f366265634f5335555644646a37566968307a702b74634d6877527042654c797174496a6c4a4b41495a5362493853475346336b307041336d52357448757750466f61374e3772656f713262714373416b314871437535757649316e364a755258492b53314d636f3534596d595477636e36416569632b6b73735869385870584334563374372f414475544e4b61514a6453634141414141456c46546b5375516d4343)](https://mybinder.org/v2/gh/crocs-muni/ECTester/master?filepath=util%2Fplot_dh.ipynb) [![Key generation at mybinder.org](https://camo.githubusercontent.com/48707184e8d82d7fc76aabbb9e0b4984c449cf1d38c6da61d6d5f063cd5cd65f/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c61756e63682d4b657967656e2d3537394143412e7376673f6c6f676f3d646174613a696d6167652f706e673b6261736536342c6956424f5277304b47676f414141414e535568455567414141466b414141425a43414d41414142693158696441414142386c424d5645582f2f2f39586d73726d5a5948316f6c4a586d7372316f6c4a586d73726d5a5948316f6c4a586d7372316f6c4a586d73726d5a5948316f6c4c316f6c4a586d7372316f6c4a586d73726d5a5948316f6c4c316f6c4a586d73726d5a5948316f6c4a586d7372316f6c4c316f6c4a586d73726d5a5948316f6c4c316f6c4a586d73726d5a5948316f6c4c316f6c4c306e4666316f6c4a586d73726d5a5948316f6c4a586d737138645a62316f6c4a586d73726d5a5948316f6c4a586d7370586d7370586d7372316f6c4c316f6c4a586d73726d5a5948316f6c4a586d7372316f6c4c316f6c4a586d73726d5a5948316f6c4c316f6c4c65614956586d73726d5a5948316f6c4c316f6c4c316f6c4a586d73726d5a5948316f6c4c6e613331586d7372316f6c4a586d7372316f6c4a586d73726d5a5948316f6c4c716f5672316f6c4a586d7372316f6c4a586d73726d5a5948316f6c4c316f6c4b6b6661506f6258767669476162676164586d737154684b756f664b486d5a34446f626e72316f6c4a586d7372316f6c4a586d7370586d7372316f6c4a586d7372665a34547568576e316f6c4c316f6c4a586d737142693758316f6c4a586d73705a6d736c626d4d68626d7364656d7356666c385a676d734e696d384a706b3846306d3752346d3746356e4c42366a6268376a62694469724f4569624f476e4b614d68712b506e6143566736715767367165674b6166663657686e704b6f664b47746e6f6d78655a79336e6f4736645a692b6e33764363705044637050476e33624c62342f4d6234375562497256613472596f476a6461496265614958686f57486d5a59486f6258767063486a716448587265484c726f56727366472f7568476e75683262776a3248786b3137796c31767a6d6c6a7a6d316a306e6c58316f6c4c33414a58574141414162585253546c4d414542415148783867494341754c6a41774d447739505542415145705155464258563168675947426b6348427763586c3867494341676f69496b4a43516c4a69636e4a32676f4b436d714b2b77734c433475734441774d6a50304e4451314e6257334e7a67344f4469352b337638504477382f54303950583239766233392f66352b6672372b2f7a382f507a392f76372b7a637a43786741414243354a524546556541484e31756c336b3055554276436231435456706d706169744147534c537053754b434c577062544b4e4a46476c63534d414646363369556d5263634e4736674c6275786b585536364a415565662f394c53706d586e794c72335435414f2f727a6c357a6a31333770313336424953793434664b4a5875474e2f64313950556659654f36375a6e717466324b4833334964317073586f466457333073505a31734d767332443036304148717773344648654a6f6a4c5a716e773533636d6676672b5852386d43304f456a75787258456b5835796465564a4c56496c563065313050586b356b37645965487537436a316a2b3439754b6737754c55363174474c77316c713237756751596c636c4843346267763756512b5441796a355a632f556a735076733173643563577279574f6274765754324550613472746e5757334a6b706a67674570624f73507237463745794e657774704249736c41377034334843736e776f6f5854456333556d506d434e6e356c7271544a7879366e526d636176475a56742f334461327044354e4876734f484a43726463314732723344495470553779696337772f3752786e6a63306b7435474334646a697632537a3346623269455a6734312f64647346446f79755972496b6d4665687a304852327468506751714d79515962324f7442305778735a33426547332b7770526231767a6c325559426f6738466647687474464b6a7441636c6e5a5972526f397279473975472f465a515534414567385a45394c6a474d7a546d714b58504c6e6c57566e496c51515476784a663869703756676a5a6a795650726a77317465356f744d37526d5037786d2b734b32477639493847692b2b425262456b5239454277387a5255634b7877703733786b614c697151622b6b4764754a544e484737327a6357394c6f4a677151787050332f546a2f2f633379423074717a616d6c30352f2b6f72484c6b73564f2b39356b58372f3771674a766e6a6c72667232476773797830656f793975507a4e355350643836615867674f73454b573250727a37647533564944332f747a732f735352733277376f7656484b746a7258327064375a4d6c547841596642414c396a694477664c6b713535546d376966684d6c5447507943417337524652686e34374a6e6c634239524d355439374153755a584963564e755544496e647044626473667271734f707065586c35592b58564b646a464354682b7a476156756a3064397a79303550504b33517a42616d786477745443727a79672f3252766632457374556a6f72644777612f6b78396d534a4c72386d4c4c744357384848474a63325235685332313949694636506e5475734f71634d6c3537676d305a386b616e4b4d41516730715379755a666e377a4974736247794f39516c6e7859306543754431584c3279732f4d737251686c74453755673075464f7a75664a4645325078426f2f59417838585050644477574e304d72445259495a46306d534d4b434e4867614956466f42624e6f4c4a37744551444b784746306b634c51696d6f6a435a6f7076304f6b4e4f795743436739584d5641693741524a7a51644d3251556830676d426f7a6a6333536b6736645342527144475953554f7536365a672b4932664e5a732f4d332f662f47726c2f586e794631477733564b43657a30504e35495566464c717667554e344330714e715973355968504c2b61565a594445344970556b35376f53466e4a6d3446794371714f45306a685932534d794c466f6f35367a796f366265634f5335555644646a37566968307a702b74634d6877527042654c797174496a6c4a4b41495a5362493853475346336b307041336d52357448757750466f61374e3772656f713262714373416b314871437535757649316e364a755258492b53314d636f3534596d595477636e36416569632b6b73735869385870584334563374372f414475544e4b61514a6453634141414141456c46546b5375516d4343)](https://mybinder.org/v2/gh/crocs-muni/ECTester/master?filepath=util%2Fplot_gen.ipynb)

### Requirements

* matplotlib
* numpy
* scipy
* Jupyter
* asn1crypto

### Examples

#### ECDSA timing analysis

To analyze ECDSA data, use the `plot_dsa.ipynb` notebook. Enter the options in the second cell, including filename, curve, desired time units and then simply run the following cells to obtain heatmaps of the timing data of ECDSA like those displayed below.

[![](/crocs-muni/ECTester/raw/master/docs/leaky_msb.png)](/crocs-muni/ECTester/blob/master/docs/leaky_msb.png)
This heatmap above is a heatmap of the most significant byte of ECDSA random nonces and the signature time, one can see that there is a clear dependency between certain most significant bits of the nonce and signature time. This is due to the scalar multiplication leaking via timing and was the issue behind [CVE-2019-14318](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-14318) in Crypto++.

[![](/crocs-muni/ECTester/raw/master/docs/nonleaky_msb.png)](/crocs-muni/ECTester/blob/master/docs/nonleaky_msb.png)
This heatmap shows a non leaking implementation that is constant time and does not leak any information (via timing) about the secret scalar in scalar multiplication.

## About

Tests support and behavior of elliptic curve cryptography implementations on JavaCards (TYPE\_EC\_FP and TYPE\_EC\_F2M) and in selected software libraries.

[crocs-muni.github.io/ECTester](https://crocs-muni.github.io/ECTester "https://crocs-muni.github.io/ECTester")

### Topics

[ecdsa](/topics/ecdsa "Topic: ecdsa")
[ecdh](/topics/ecdh "Topic: ecdh")
[elliptic-curves](/topics/elliptic-curves "Topic: elliptic-curves")
[javacard](/topics/javacard "Topic: javacard")

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/crocs-muni/ECTester/activity)
[Custom properties](/crocs-muni/ECTester/custom-properties)
### Stars

[**66**
stars](/crocs-muni/ECTester/stargazers)
### Watchers

[**9**
watching](/crocs-muni/ECTester/watchers)
### Forks

[**14**
forks](/crocs-muni/ECTester/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fcrocs-muni%2FECTester&report=crocs-muni+%28user%29)

## [Releases 9](/crocs-muni/ECTester/releases)

[ECTester v0.3.3
Latest

Mar 18, 2019](/crocs-muni/ECTester/releases/tag/0.3.3)
[+ 8 releases](/crocs-muni/ECTester/releases)

## [Packages 0](/orgs/crocs-muni/packages?repo_name=ECTester)

No packages published

## [Contributors 6](/crocs-muni/ECTester/graphs/contributors)

## Languages

* [Java
  61.9%](/crocs-muni/ECTester/search?l=java)
* [C
  19.9%](/crocs-muni/ECTester/search?l=c)
* [C++
  5.9%](/crocs-muni/ECTester/search?l=c%2B%2B)
* [Jupyter Notebook
  5.0%](/crocs-muni/ECTester/search?l=jupyter-notebook)
* [Python
  3.9%](/crocs-muni/ECTester/search?l=python)
* [Nix
  2.7%](/crocs-muni/ECTester/search?l=nix)
* Other
  0.7%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


