=== Content from github.com_c07b1344_20250124_230539.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fethereum%2Fgo-ethereum%2Fissues%2F18289)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fethereum%2Fgo-ethereum%2Fissues%2F18289)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=ethereum%2Fgo-ethereum)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ethereum](/ethereum)
/
**[go-ethereum](/ethereum/go-ethereum)**
Public

* [Notifications](/login?return_to=%2Fethereum%2Fgo-ethereum) You must be signed in to change notification settings
* [Fork
  20.5k](/login?return_to=%2Fethereum%2Fgo-ethereum)
* [Star
   48.2k](/login?return_to=%2Fethereum%2Fgo-ethereum)

* [Code](/ethereum/go-ethereum)
* [Issues
  189](/ethereum/go-ethereum/issues)
* [Pull requests
  93](/ethereum/go-ethereum/pulls)
* [Actions](/ethereum/go-ethereum/actions)
* [Projects
  0](/ethereum/go-ethereum/projects)
* [Wiki](/ethereum/go-ethereum/wiki)
* [Security](/ethereum/go-ethereum/security)
* [Insights](/ethereum/go-ethereum/pulse)

Additional navigation options

* [Code](/ethereum/go-ethereum)
* [Issues](/ethereum/go-ethereum/issues)
* [Pull requests](/ethereum/go-ethereum/pulls)
* [Actions](/ethereum/go-ethereum/actions)
* [Projects](/ethereum/go-ethereum/projects)
* [Wiki](/ethereum/go-ethereum/wiki)
* [Security](/ethereum/go-ethereum/security)
* [Insights](/ethereum/go-ethereum/pulse)

# EVM dynamic array maybe occupy large memory #18289

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[EVM dynamic array maybe occupy large memory](#top)#18289Copy link[![@lcatro](https://avatars.githubusercontent.com/u/10431717?u=e1365c35e062474098cb5de9bbb16aa92c243b6b&v=4&size=80)](/lcatro)
## Description

[![@lcatro](https://avatars.githubusercontent.com/u/10431717?u=e1365c35e062474098cb5de9bbb16aa92c243b6b&v=4&size=48)](/lcatro)[lcatro](https://github.com/lcatro)opened [on Dec 12, 2018](https://github.com/ethereum/go-ethereum/issues/18289#issue-390050286)
#### System information

Geth version: `1.8.19`

OS & Version: Linux

Commit hash : no found

#### Expected behaviour

Dynamic array save itself length in memory and this length will restrict index of array .

```

    function a(uint[] b) {
        b[2]=0x10;
    }

```

See the assambly ,`b[2] = 0x10` implicate index of array check .

```

----  Address 0x97  Function a() Main Code  ----
151 JUMPDEST
152 PUSH1 10    ;  value : 0x10
154 DUP2
155 PUSH1 02    ;  index of array .0x02
157 DUP2
158 MLOAD       ;  MLOAD 0x80 ,Get the array length
159 DUP2
160 LT          ;  check index of array with array lengtj
161 ISZERO
162 ISZERO
163 PUSH1 a7
165 JUMPI       ;  jump to write data into array
166 INVALID     ;  exit contract
----  Address 0xA7  ----
167 JUMPDEST
168 PUSH1 20    ;  /
170 SWAP1       ;  |
171 DUP2        ;  |
172 MUL         ;  |  calculate the data location in array and store the number in it
173 SWAP1       ;  |
174 SWAP2       ;  |
175 ADD         ;  |
176 ADD         ;  \
177 MSTORE      ;  MSTORE 0xE0,0x10 .

```

So call function a like this `a([1,2,3])` ,`b[2]=0x10` will success execute ;but `a([1,2])` ,`b[2]=0x10` will except.

#### Actual behaviour

We know Solc will auto insert array index check code in assambly ,so I try still rewrite the dynamic length .

```

pragma solidity ^0.4.24;

contract test {

    function a(uint[] b) {
        b.length = 0x10;
    }

}

```

Unfortunately ,it can't pass compile .It mean we rewrite the length of dynamic array .But I try to rewrite the array length on memory that is work .

```

pragma solidity ^0.4.24;

contract test {

    function a(uint[] b,uint[] c) {
        uint c_length = c.length;
        assembly {
            mstore(add(0x80,mul(3,0x20)),0x5)  //  rewrite the length of dynamic array in memory
        }
        c_length = c.length;   //  array length change to 0x5
    }

}

```

Lastly ,I try writing a data to offset 0xC800000 in array .EVM will occupy large memory (200 MB)

```
pragma solidity ^0.4.24;

contract test {

    function a(uint[] b,uint[] c) {
        uint c_length = c.length;
        assembly {
            mstore(add(0x80,mul(3,0x20)),0xAAAAAAAA)
        }
        c_length = c.length;
        c[0xC800000] = 0xFF;
    }

}

```
#### Steps to reproduce the behaviour

This is EVM test command (ignore gas-limit ):

./evm --code 608060405260043610610041576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806396f40e3d14610046575b600080fd5b34801561005257600080fd5b506100ed60048036038101908080359060200190820180359060200190808060200260200160405190810160405280939291908181526020018383602002808284378201915050505050509192919290803590602001908201803590602001908080602002602001604051908101604052809392919081815260200183836020028082843782019150505050505091929192905050506100ef565b005b60008151905063aaaaaaaa6020600302608001528151905060ff826210000081518110151561011a57fe5b90602001906020020181815250505050505600a165627a7a72305820fe133e12a0270131204b3cc47bb934f4d348bad747ca490adc53d935690806ac0029 --input 96f40e3d000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000004 --gas 10000000000000000 --debug run

[![image](https://user-images.githubusercontent.com/10431717/49844385-bdf05e80-fdfd-11e8-9220-637e65fefdb0.png)](https://user-images.githubusercontent.com/10431717/49844385-bdf05e80-fdfd-11e8-9220-637e65fefdb0.png)

[![image](https://user-images.githubusercontent.com/10431717/49844431-e9734900-fdfd-11e8-9e08-436628cecf88.png)](https://user-images.githubusercontent.com/10431717/49844431-e9734900-fdfd-11e8-9e08-436628cecf88.png)

#### Backtrace

Not found ,you can see large memory alloc output on console by --debug flag .

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


