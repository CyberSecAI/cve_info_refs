```
{
  "vulnerability_details": [
    {
      "root_cause": "A buffer overflow vulnerability exists in the Build Engine due to insufficient bounds checking when reading map files. Specifically, the `kread` function reads a user-controlled `numsectors` value from the map file and uses it to read a number of sectors into the `sector` buffer. If `numsectors` is greater than the size of the `sector` buffer, a buffer overflow occurs.",
      "weaknesses": [
        "Buffer overflow due to lack of bounds checking.",
         "Use of user-controlled values without proper validation to determine the size of memory operations.",
        "The kread function blindly reads a specified number of bytes without checking buffer boundaries."
      ],
      "impact": "An attacker can overwrite the stack, control EIP (Extended Instruction Pointer), and execute arbitrary code. This could lead to complete system compromise.",
      "attack_vectors": "A malicious map file can be crafted to exploit this vulnerability. The attacker crafts a map file with a `numsectors` value exceeding the declared size of the `sector` buffer. When the map file is parsed, the vulnerable `kread` function is called with the crafted `numsectors`, causing the overflow.",
      "required_capabilities": "The attacker needs to be able to provide a crafted map file to be loaded by the vulnerable software. No special privileges are required on the system."
    }
  ],
    "additional_details": [
        {
          "detail": "The vulnerability is present in the ENGINE.C file, specifically in the following code:\n\n```c\n1935   kread(fil,&numsectors,2);\n1936   kread(fil,&sector[0],sizeof(sectortype)*numsectors);\n```",
           "detail": "The variable `sector` has a fixed size of `MAXSECTORS * sizeof(struct sectortype)` = 1024 * 40 = 40960 bytes. The attacker controls `numsectors`, so setting it to more than `MAXSECTORS` will cause a buffer overflow when `kread` reads `sizeof(sectortype) * numsectors` bytes into the buffer `sector`."
          
         },
    {
          "detail":"The `kread` function reads data from the map file which has various vulnerable components, including walls, sprites, palette, palookups, translucency, tiles, and voxels. All these can potentially lead to buffer overflows if their respective sizes are not checked against what the map file specifies",
           "detail":"Multiple code snippets relying on `kread` are vulnerable: In `ENGINE.C` there are potential overflows in `walls`, `sprites`, `palette`, `palookups`, `transluc`, `tilesizx`, `tilesizy` and `picanm`. In `KDMENG.C` the functions reading wave data, sound samples, and track data are also vulnerable."
          
         },
   {
          "detail": "Several games based on the Build engine are vulnerable, including Duke Nukem 3D, Shadow Warrior, and Redneck Rampage. However, Blood was determined to be not vulnerable"
    },
  {
         "detail":"The provided github repository contains a proof of concept (PoC) exploit that causes a stack overflow and allows control of the EIP"
     }
    ]
}
```