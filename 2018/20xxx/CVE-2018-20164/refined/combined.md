=== Content from github.com_2efe15e1_20250125_042314.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fua-parser%2Fuap-core%2Fcommit%2F156f7e12b215bddbaf3df4514c399d683e6cdadc)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fua-parser%2Fuap-core%2Fcommit%2F156f7e12b215bddbaf3df4514c399d683e6cdadc)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ua-parser%2Fuap-core)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ua-parser](/ua-parser)
/
**[uap-core](/ua-parser/uap-core)**
Public

* [Notifications](/login?return_to=%2Fua-parser%2Fuap-core) You must be signed in to change notification settings
* [Fork
  452](/login?return_to=%2Fua-parser%2Fuap-core)
* [Star
   763](/login?return_to=%2Fua-parser%2Fuap-core)

* [Code](/ua-parser/uap-core)
* [Issues
  96](/ua-parser/uap-core/issues)
* [Pull requests
  28](/ua-parser/uap-core/pulls)
* [Actions](/ua-parser/uap-core/actions)
* [Projects
  0](/ua-parser/uap-core/projects)
* [Security](/ua-parser/uap-core/security)
* [Insights](/ua-parser/uap-core/pulse)

Additional navigation options

* [Code](/ua-parser/uap-core)
* [Issues](/ua-parser/uap-core/issues)
* [Pull requests](/ua-parser/uap-core/pulls)
* [Actions](/ua-parser/uap-core/actions)
* [Projects](/ua-parser/uap-core/projects)
* [Security](/ua-parser/uap-core/security)
* [Insights](/ua-parser/uap-core/pulse)

## Commit

[Permalink](/ua-parser/uap-core/commit/156f7e12b215bddbaf3df4514c399d683e6cdadc)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#363](https://github.com/ua-parser/uap-core/pull/363) from commenthol/safe-regex

[Browse files](/ua-parser/uap-core/tree/156f7e12b215bddbaf3df4514c399d683e6cdadc)
Browse the repository at this point in the history

```
regexes update
```

* Loading branch information

[![@commenthol](https://avatars.githubusercontent.com/u/2604482?s=40&v=4)](/commenthol)

[commenthol](/ua-parser/uap-core/commits?author=commenthol "View all commits by commenthol")
authored
Dec 14, 2018

2 parents
[4e97f11](/ua-parser/uap-core/commit/4e97f111af71597d038eff1730fb8d7e4f4e7ae4)
+
[5290cd1](/ua-parser/uap-core/commit/5290cd11644d5e1069ac7cf52c3c3b7defdfb80d)

commit 156f7e1

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**241 additions**
and
**210 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .travis.yml
  [.travis.yml](#diff-6ac3f79fc25d95cd1e3d51da53a4b21b939437392578a35ae8cd6d5366ca5485)
* CONTRIBUTING.md
  [CONTRIBUTING.md](#diff-eca12c0a30e25b4b46522ebf89465a03ba72a03f540796c979137931d8f92055)
* package.json
  [package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519)
* regexes.yaml
  [regexes.yaml](#diff-a0533c4376496778507a39315add4334b0f730d1380850fce73a36512f3c199b)
* tests

  + tests/mocha.opts
    [mocha.opts](#diff-d44bed05d8b151188ed0618f767c6ad45619c0a05531592d3b1d93c39483b5fa)
  + tests/regexes.js
    [regexes.js](#diff-e6c8e323808e591c3f9fc4346a879bacfb6d6df710fcfaf2135589fc98be1373)

## There are no files selected for viewing

5 changes: 2 additions & 3 deletions

5
[.travis.yml](#diff-6ac3f79fc25d95cd1e3d51da53a4b21b939437392578a35ae8cd6d5366ca5485 ".travis.yml")

Show comments

[View file](/ua-parser/uap-core/blob/156f7e12b215bddbaf3df4514c399d683e6cdadc/.travis.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,14 +1,13 @@ |
|  |  | sudo: false |
|  |  | language: node\_js |
|  |  | node\_js: |
|  |  | - 4 |
|  |  | - 6 |
|  |  | - 8 |
|  |  | - 10 |
|  |  | - node |
|  |  |  |
|  |  | script: |
|  |  | - "npm test" |
|  |  |  |
|  |  |  |
|  |  | notifications: |
|  |  | irc: "chat.freenode.net#ua-parser" |
|  |  |  |

7 changes: 4 additions & 3 deletions

7
[CONTRIBUTING.md](#diff-eca12c0a30e25b4b46522ebf89465a03ba72a03f540796c979137931d8f92055 "CONTRIBUTING.md")

Show comments

[View file](/ua-parser/uap-core/blob/156f7e12b215bddbaf3df4514c399d683e6cdadc/CONTRIBUTING.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -10,9 +10,10 @@ Contributing to the project, especially `regexes.yaml`, is both welcomed and enc |
|  |  | \* `tests/test\_device.yaml` |
|  |  | \* `tests/test\_os.yaml` |
|  |  | \* `tests/test\_ua.yaml` |
|  |  | 5. Push your branch to GitHub and submit a pull request |
|  |  | 6. Monitor the pull request to make sure the Travis build succeeds. If it fails simply make the necessary changes to your branch and push it. Travis will re-test the changes. |
|  |  | 5. Check that your regex is not vulnerable to [ReDoS](https://www.owasp.org/index.php/Regular\_expression\_Denial\_of\_Service\_-\_ReDoS) using the test in `tests/regexes.js` |
|  |  | 6. Push your branch to GitHub and submit a pull request |
|  |  | 7. Monitor the pull request to make sure the Travis build succeeds. If it fails simply make the necessary changes to your branch and push it. Travis will re-test the changes. |
|  |  |  |
|  |  | That's it. If you don't feel comfortable forking the project or modifying the YAML you can also [submit an issue](https://github.com/ua-parser/uap-core/issues) that includes the appropriate user agent string and the expected results of parsing. |
|  |  |  |
|  |  | Thanks! |
|  |  | Thanks! |

7 changes: 4 additions & 3 deletions

7
[package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519 "package.json")

Show comments

[View file](/ua-parser/uap-core/blob/156f7e12b215bddbaf3df4514c399d683e6cdadc/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,11 +25,12 @@ |
|  |  | } |
|  |  | ], |
|  |  | "devDependencies": { |
|  |  | "yamlparser": ">=0.0.2", |
|  |  | "mocha": "\*", |
|  |  | "uap-ref-impl": "ua-parser/uap-ref-impl" |
|  |  | "safe-regex": "^2.0.1", |
|  |  | "uap-ref-impl": "git+https://github.com/ua-parser/uap-ref-impl#master", |
|  |  | "yamlparser": ">=0.0.2" |
|  |  | }, |
|  |  | "scripts": { |
|  |  | "test": "mocha -u tdd -R min ./tests/test.js" |
|  |  | "test": "mocha --opts ./tests/mocha.opts ./tests" |
|  |  | } |
|  |  | } |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `156f7e1`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fua-parser%2Fuap-core%2Fcommit%2F156f7e12b215bddbaf3df4514c399d683e6cdadc) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_938c4f6f_20250125_042315.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fua-parser%2Fuap-core%2Fissues%2F332)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fua-parser%2Fuap-core%2Fissues%2F332)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=ua-parser%2Fuap-core)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ua-parser](/ua-parser)
/
**[uap-core](/ua-parser/uap-core)**
Public

* [Notifications](/login?return_to=%2Fua-parser%2Fuap-core) You must be signed in to change notification settings
* [Fork
  452](/login?return_to=%2Fua-parser%2Fuap-core)
* [Star
   763](/login?return_to=%2Fua-parser%2Fuap-core)

* [Code](/ua-parser/uap-core)
* [Issues
  96](/ua-parser/uap-core/issues)
* [Pull requests
  28](/ua-parser/uap-core/pulls)
* [Actions](/ua-parser/uap-core/actions)
* [Projects
  0](/ua-parser/uap-core/projects)
* [Security](/ua-parser/uap-core/security)
* [Insights](/ua-parser/uap-core/pulse)

Additional navigation options

* [Code](/ua-parser/uap-core)
* [Issues](/ua-parser/uap-core/issues)
* [Pull requests](/ua-parser/uap-core/pulls)
* [Actions](/ua-parser/uap-core/actions)
* [Projects](/ua-parser/uap-core/projects)
* [Security](/ua-parser/uap-core/security)
* [Insights](/ua-parser/uap-core/pulse)

# Performance issue with backtracking caused by some regexes #332

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosed[#368](https://github.com/ua-parser/uap-core/pull/368)Closed[Performance issue with backtracking caused by some regexes](#top)#332[#368](https://github.com/ua-parser/uap-core/pull/368)Copy linkLabels[question](https://github.com/ua-parser/uap-core/issues?q=state%3Aopen%20label%3A%22question%22)[![@elukey](https://avatars.githubusercontent.com/u/1536240?v=4&size=80)](/elukey)
## Description

[![@elukey](https://avatars.githubusercontent.com/u/1536240?v=4&size=48)](/elukey)[elukey](https://github.com/elukey)opened [on Jul 30, 2018](https://github.com/ua-parser/uap-core/issues/332#issue-345763182)

Hi! We are happy users of uap-core via <https://github.com/ua-parser/uap-python>, but we have recently noticed that some regexes may lead to excessive backtracking.

The regex that caused some issue for us is the following:

^(.\*)/(\d+).?(\d+)?.?(\d+)?.?(\d+)? CFNetwork

A simple python script like the following hangs on my laptop for several minutes:

```
user_agent = "Mozilla/5.0 (X11; Linux x86_64_128) AppleWebKit/11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.111111111111111111111111111111111111111111111111111111111111111111111111 (KHTML, like Gecko) Linux/222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222"
import re
pattern = re.compile(r'^(.*)/(\d+)\.?(\d+)?.?(\d+)?.?(\d+)? CFNetwork')
pattern.search(user_agent)

```

The main problem seems to be backtracking caused by the various blocks with .?, that doesn't happen if the regex is split into multiple ones for example:

```
^(.*)/(\d+) CFNetwork
^(.*)/(\d+)\.(\d+)? CFNetwork
^(.*)/(\d+)\.(\d+)\.(\d+)? CFNetwork
^(.*)/(\d+)\.(\d+)\.(\d+)\.?(\d+)? CFNetwork

```

The example that I brought up is of course a corner case, but even shorter strings with the same format can cause slow downs in parsing or hanging. It would be great to find a solution that is probably more verbose but that doesn't lead to these issues.

Thanks in advance!

Luca

👍3
## Metadata

### Assignees

No one assigned

### Labels

[question](https://github.com/ua-parser/uap-core/issues?q=state%3Aopen%20label%3A%22question%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c65cac1b_20250126_055700.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fua-parser)

[ua-parser](/ua-parser)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fua-parser)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Corg-login%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@ua-parser](https://avatars.githubusercontent.com/u/1764972?s=200&v=4)

# ua-parser

* [Overview](/ua-parser)
* [Repositories](/orgs/ua-parser/repositories)
* [Projects](/orgs/ua-parser/projects)
* [Packages](/orgs/ua-parser/packages)
* [People](/orgs/ua-parser/people)

More

* [Overview](/ua-parser)
* [Repositories](/orgs/ua-parser/repositories)
* [Projects](/orgs/ua-parser/projects)
* [Packages](/orgs/ua-parser/packages)
* [People](/orgs/ua-parser/people)

## Popular repositories Loading

1. [uap-core](/ua-parser/uap-core) uap-core
   Public

   The regex file necessary to build language ports of Browserscope's user agent parser.

   JavaScript

   [764](/ua-parser/uap-core/stargazers)
   [452](/ua-parser/uap-core/forks)
2. [uap-python](/ua-parser/uap-python) uap-python
   Public

   Python implementation of ua-parser

   Python

   [592](/ua-parser/uap-python/stargazers)
   [154](/ua-parser/uap-python/forks)
3. [uap-php](/ua-parser/uap-php) uap-php
   Public

   PHP implementation of ua-parser

   PHP

   [529](/ua-parser/uap-php/stargazers)
   [84](/ua-parser/uap-php/forks)
4. [uap-java](/ua-parser/uap-java) uap-java
   Public

   Java implementation of ua-parser

   Java

   [399](/ua-parser/uap-java/stargazers)
   [176](/ua-parser/uap-java/forks)
5. [uap-csharp](/ua-parser/uap-csharp) uap-csharp
   Public

   C# implementation of ua-parser

   C#

   [391](/ua-parser/uap-csharp/stargazers)
   [105](/ua-parser/uap-csharp/forks)
6. [uap-go](/ua-parser/uap-go) uap-go
   Public

   Go implementation of ua-parser

   Go

   [366](/ua-parser/uap-go/stargazers)
   [106](/ua-parser/uap-go/forks)

### Repositories

 Loading

 Type

Select type

All

Public

Sources

Forks

Archived

Mirrors

Templates

 Language

Select language

All

C#

C++

Clojure

CSS

D

Go

Haskell

Java

JavaScript

Perl

PHP

Python

Ruby

Rust

Scala

 Sort

Select order

Last updated

Name

Stars

Showing 10 of 19 repositories

* [uap-core](/ua-parser/uap-core)
  Public

  The regex file necessary to build language ports of Browserscope's user agent parser.

   ua-parser/uap-core’s past year of commit activity

  JavaScript

  [764](/ua-parser/uap-core/stargazers)
  [452](/ua-parser/uap-core/forks)
  [96](/ua-parser/uap-core/issues)
  [28](/ua-parser/uap-core/pulls)
  Updated Jan 22, 2025
* [uap-python](/ua-parser/uap-python)
  Public

  Python implementation of ua-parser

   ua-parser/uap-python’s past year of commit activity

  Python

  [592](/ua-parser/uap-python/stargazers)

  Apache-2.0

  [154](/ua-parser/uap-python/forks)
  [4](/ua-parser/uap-python/issues)
  [1](/ua-parser/uap-python/pulls)
  Updated Dec 22, 2024
* [uap-rust](/ua-parser/uap-rust)
  Public

   ua-parser/uap-rust’s past year of commit activity

  Rust

  0

  [3](/ua-parser/uap-rust/forks)
  [5](/ua-parser/uap-rust/issues)
  [0](/ua-parser/uap-rust/pulls)
  Updated Dec 22, 2024
* [uap-ruby](/ua-parser/uap-ruby)
  Public

  A simple, comprehensive Ruby gem for parsing user agent strings with the help of BrowserScope's UA database

   ua-parser/uap-ruby’s past year of commit activity

  Ruby

  [256](/ua-parser/uap-ruby/stargazers)

  MIT

  [42](/ua-parser/uap-ruby/forks)
  [6](/ua-parser/uap-ruby/issues)
  [1](/ua-parser/uap-ruby/pulls)
  Updated Dec 11, 2024
* [uap-go](/ua-parser/uap-go)
  Public

  Go implementation of ua-parser

   ua-parser/uap-go’s past year of commit activity

  Go

  [366](/ua-parser/uap-go/stargazers)
  [106](/ua-parser/uap-go/forks)
  [7](/ua-parser/uap-go/issues)
  [1](/ua-parser/uap-go/pulls)
  Updated Oct 12, 2024
* [uap-scala](/ua-parser/uap-scala)
  Public

  Scala port of ua-parser

   ua-parser/uap-scala’s past year of commit activity

  Scala

  [98](/ua-parser/uap-scala/stargazers)

  WTFPL

  [49](/ua-parser/uap-scala/forks)
  [1](/ua-parser/uap-scala/issues)
  [8](/ua-parser/uap-scala/pulls)
  Updated Aug 23, 2024
* [uap-cpp](/ua-parser/uap-cpp)
  Public

  C++ implementation of ua-parser

   ua-parser/uap-cpp’s past year of commit activity

  C++

  [37](/ua-parser/uap-cpp/stargazers)

  MIT

  [30](/ua-parser/uap-cpp/forks)
  [2](/ua-parser/uap-cpp/issues)
  [1](/ua-parser/uap-cpp/pulls)
  Updated Jun 19, 2024
* [uap-php](/ua-parser/uap-php)
  Public

  PHP implementation of ua-parser

   ua-parser/uap-php’s past year of commit activity

  PHP

  [529](/ua-parser/uap-php/stargazers)
  [84](/ua-parser/uap-php/forks)
  [4](/ua-parser/uap-php/issues)
  [8](/ua-parser/uap-php/pulls)
  Updated Jun 3, 2024
* [uap-d](/ua-parser/uap-d)
  Public

  D implementation of ua-parser

   ua-parser/uap-d’s past year of commit activity

  D

  [4](/ua-parser/uap-d/stargazers)

  MIT

  [3](/ua-parser/uap-d/forks)
  [0](/ua-parser/uap-d/issues)
  [1](/ua-parser/uap-d/pulls)
  Updated May 14, 2024
* [uap-java](/ua-parser/uap-java)
  Public

  Java implementation of ua-parser

   ua-parser/uap-java’s past year of commit activity

  Java

  [399](/ua-parser/uap-java/stargazers)
  [176](/ua-parser/uap-java/forks)
  [10](/ua-parser/uap-java/issues)
  [12](/ua-parser/uap-java/pulls)
  Updated Jan 25, 2024

 [View all repositories](/orgs/ua-parser/repositories?type=all)

[#### People](/orgs/ua-parser/people)
[![@mattrobenolt](https://avatars.githubusercontent.com/u/375744?s=70&v=4)](/mattrobenolt) [![@migueldemoura](https://avatars.githubusercontent.com/u/9093796?s=70&v=4)](/migueldemoura)

#### Top languages

Loading…

#### Most used topics

Loading…

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.x41-dsec.de_7075a65d_20250126_055701.html ===

[![X41 D-Sec logotype](/assets/images/svg/logo.svg)](/)
![X41 D-Sec logotype](/assets/images/svg/hamburger.svg)

* [Company](/company/)
  + [Mission](/company/#company)
  + [Locations](/company/#locations)
* [News](/news/)
  + [ResearchBlog](/news/)
  + [Lab](/news/lab/)
* [PetâHMR](/pethmr/)
* [Services](/services/)
  + [Code Audit](/services/code-audit/)
  + [Red Teaming](/services/red-teaming/)
  + [Security Research](/services/security-research/)
  + [Penetration Testing](/services/penetration-testing/)
  + [Fuzzing](/services/fuzzing/)
  + [AppSec](/services/appsec/)
* [References](/references/)
* [Contact](/contact/)
* [Jobs](/jobs/)
* [FAQ](/faq/)

# NEWS

X41 D-SEC GmbH Security Advisory: X41-2018-009

# ReDoS Vulnerability in UA-Parser

**Severity Rating:** Medium

**Confirmed Affected Versions:** 2015-05-14 and newer, commit 6fd6c261274254bcbbacd77ef4b12534c7f9923d

**Confirmed Patched Versions:** v0.6.0 released 2018-12-14, commit 010ccdc7303546cd22b9da687c29f4a996990014

**Vendor:** UA-Parser Project

**Vendor URL:** https://github.com/ua-parser

**Vector:** HTTP request

**Credit:** X41 D-SEC GmbH, Luc Gommans

**Status:** Public

**CVE:** CVE-2018-20164

**CVSSv3 Score:** 5.3

**CVSSv3 Vector:** AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L

**Advisory-URL:** https://www.x41-dsec.de/lab/advisories/x41-2018-009-uaparser/

# Summary and Impact

The programming library UA-Parser uses regular expressions to identify user agent strings. The complexity of some of the regular expressions is such that an attacker can craft special patterns that keep the server busy for a long time. By sending many requests in short order, an attacker can exhaust the amount of processing power available. This causes the website to become unavailable for legitimate visitors.

In common setups, the user agent string is parsed whenever a page is visited. This means that anyone can abuse the bug, typically without authentication. There are no common circumstances which would prevent an attack from working reliably, i.e. an attacker can consistently and repeatedly exploit the issue until the site has become unreachable.

For more information on regular expression-based denial of service, see the OWASP page on ReDoS: <https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS>

The UA-Parser project consists of a core repository, uap-core, and implementations in various languages. The regular expressions are defined in the core project and each implementation is automatically vulnerable.

# Product Description

When a user agent (such as a browser) connects to a website, it identifies itself with a âuser agent stringâ. This string helps the server determine relevant content, for example to serve the appropriate installer for visitors with different operating systems. The UA-Parser project collects regular expressions that extract the type of device and operating system from these strings. Implementations in different languages are automatically vulnerable, including the reference implementation in JavaScript: <https://github.com/ua-parser/uap-ref-impl>

# Proof of Concept

There are multiple vulnerable regular expressions. They are collected in the file `regex.yaml`, for example on lines 911 and 4961. The regular expression on line 911 is as follows:

`(x86_64|aarch64)\ (\d+)+\.(\d+)+\.(\d+)+.*Chrome.*(?:CitrixChromeApp)$`

Any implementation using this library will hang for a few seconds (on comodity hardware) when sending the following HTTP request:

```
GET / HTTP/1.0
User-Agent: x86_64 1111111111111111111111111111

```

Normal user agent strings can be over a hundred bytes long: this string of 35 bytes is not an abnormal request. Adding one more byte makes the processing significantly longer.

This particular regular expression was introduced in September 2018. The regular expression on line 4961 was introduced in May 2015 and can be exploited as follows:

```
GET / HTTP/1.0
User-Agent: HbbTV/1.1.1CE-HTML/1.1;THOM;SW-Version/1;SW-Version/1;SW-Version/1;SW-Version/1;SW-Version/1;SW-Version/1;SW-Version/1;SW-Version/1;SW-Version/1;SW-Version/1;LF

```

Each additional repetition of `SW-Version/1;` will multiply the processing time by roughly a factor 6.2. Where eleven repetitions take about seven seconds, fourteen repetitions already occupy a server for half an hour.

# Workarounds

As demonstrated, the input does not have to be particularly long to exploit the issue. This may be the case, and a few hundred kilobytes may slow down most regular expressions, but limiting the maximum length is not a solution by itself.

The root cause is the regular expression, which should be limited in complexity. This involves manual work and there is no solution that can be applied to all regular expressions in the project.

To aid in identifying problematic regular expressions, one may use projects such as <https://github.com/jagracey/RegEx-DoS>.

# Timeline

**2018-11-26** Issue found.

**2018-11-29** Permission from customer to disclose to upstream.

**2018-11-29** Requested secure channel from vendor for communication.

**2018-12-04** Disclosed to vendor.

**2018-12-14** Patch released by vendor, CVE number requested.

**2018-12-15** CVE-2018-20164 assigned.

**2019-01-10** Advisory released.

# About X41 D-SEC GmbH

X41 is an expert provider for application security services. Having extensive industry experience and expertise in the area of information security, a strong core security team of world class security experts enables X41 to perform premium security services.

Fields of expertise in the area of application security are security-oriented code reviews, binary reverse engineering, and vulnerability discovery. Custom research, IT security consulting, and support services are core competencies of X41.

Author:
Luc Gommans

Date: December 14, 2018

«
[Happy Holidays](/security/research/job/news/2018/12/04/x41-happy-holidays/)

[X41 BeanStack - Java Fingerprinting Database](/security/research/job/news/2019/04/24/x41-beanstack-release/)
»

CONTACT
X41 D-Sec GmbH
Soerser Weg 20
52070 Aachen

+49 (0) 241 9809418-0
+49 (0) 241 9809418-9
info@x41-dsec.de

[PGP Key](/static/pgp/0x6746CF4698A7AB6Epub.asc.txt)

Connect
[Github
![X41 Github](/assets/images/svg/github.svg)](https://github.com/x41sec "X41 Github")
[Mastodon
![X41 Mastodon](/assets/images/svg/mastodon.svg)](https://infosec.exchange/%40x41sec "X41 Mastodon")
[Twitter
![X41 Twitter](/assets/images/svg/twitter.svg)](https://twitter.com/X41Sec "X41 Twitter")
[LinkedIn
![X41 LinkedIn](/assets/images/svg/linkedin.svg)](https://de.linkedin.com/company/x41 "X41 LinkedIn")

[FAQ](/faq/)
[Partners](/references/)
[Terms of Use](/terms/)
[Privacy](/privacy/)
[Imprint](/imprint/)



=== Content from github.com_c53d3858_20250125_042313.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fua-parser%2Fuap-core%2Fcommit%2F010ccdc7303546cd22b9da687c29f4a996990014)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fua-parser%2Fuap-core%2Fcommit%2F010ccdc7303546cd22b9da687c29f4a996990014)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ua-parser%2Fuap-core)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ua-parser](/ua-parser)
/
**[uap-core](/ua-parser/uap-core)**
Public

* [Notifications](/login?return_to=%2Fua-parser%2Fuap-core) You must be signed in to change notification settings
* [Fork
  452](/login?return_to=%2Fua-parser%2Fuap-core)
* [Star
   763](/login?return_to=%2Fua-parser%2Fuap-core)

* [Code](/ua-parser/uap-core)
* [Issues
  96](/ua-parser/uap-core/issues)
* [Pull requests
  28](/ua-parser/uap-core/pulls)
* [Actions](/ua-parser/uap-core/actions)
* [Projects
  0](/ua-parser/uap-core/projects)
* [Security](/ua-parser/uap-core/security)
* [Insights](/ua-parser/uap-core/pulse)

Additional navigation options

* [Code](/ua-parser/uap-core)
* [Issues](/ua-parser/uap-core/issues)
* [Pull requests](/ua-parser/uap-core/pulls)
* [Actions](/ua-parser/uap-core/actions)
* [Projects](/ua-parser/uap-core/projects)
* [Security](/ua-parser/uap-core/security)
* [Insights](/ua-parser/uap-core/pulse)

## Commit

[Permalink](/ua-parser/uap-core/commit/010ccdc7303546cd22b9da687c29f4a996990014)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

0.6.0

[Browse files](/ua-parser/uap-core/tree/010ccdc7303546cd22b9da687c29f4a996990014)
Browse the repository at this point in the history

* Loading branch information

[![@commenthol](https://avatars.githubusercontent.com/u/2604482?s=40&v=4)](/commenthol)

[commenthol](/ua-parser/uap-core/commits?author=commenthol "View all commits by commenthol")
committed
Dec 14, 2018

1 parent
[764947f](/ua-parser/uap-core/commit/764947f552c6fc9ac80759acb5165a83ee746678)

commit 010ccdc

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519 "package.json")

Show comments

[View file](/ua-parser/uap-core/blob/010ccdc7303546cd22b9da687c29f4a996990014/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,7 +1,7 @@ |
|  |  | { |
|  |  | "name": "uap-core", |
|  |  | "description": "The regex file necessary to build language ports of Browserscope's user agent parser.", |
|  |  | "version": "0.5.0", |
|  |  | "version": "0.6.0", |
|  |  | "maintainers": [ |
|  |  | { |
|  |  | "name": "Tobie Langel", |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `010ccdc`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fua-parser%2Fuap-core%2Fcommit%2F010ccdc7303546cd22b9da687c29f4a996990014) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


