```
{
  "vulnerability_details": {
    "root_cause": "The getUserMedia API was not properly checking if the document was fully active before starting audio capture. This allowed audio capture to be initiated from a document that was no longer active, resulting in a permission prompt showing the wrong origin.",
    "weaknesses": [
      "Improper origin validation for audio capture requests",
      "Lack of check for fully active document context before initiating audio capture"
    ],
    "impact": "An audio capture session can start under an incorrect origin from the site making the capture request. Users are still prompted to allow the request but the prompt can display the wrong origin, leading to user confusion about which site is making the request to capture an audio stream.",
    "attack_vectors": [
      "By loading a page in a subframe or window.open, grabbing relevant objects, navigating the page to a new origin, and then calling methods on the grabbed objects.",
      "Using a crafted webpage that quickly navigates to another origin after calling `getUserMedia`."
    ],
    "required_attacker_capabilities": "The attacker needs to be able to load a page in a subframe/window and execute JavaScript in it, then navigate the page to a new origin and subsequently call methods on the objects grabbed from the original page before navigation.",
    "additional_details": "The vulnerability was caused by the getUserMedia API not checking for a 'fully active' document when processing the request. This allowed a permission prompt for audio capture to be displayed for the wrong origin because the prompt's origin was derived from a WindowProxy instead of a Window. The fix involves checking if the document is fully active before requesting audio capture permissions, preventing the wrong origin from being shown in the prompt."
  }
}
```