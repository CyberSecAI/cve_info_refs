- **Root cause of vulnerability:** Improper sanitization of the 'alias' and 'ips' parameters in the `/opt/vyatta/share/vyatta-cfg/templates/system/static-host-mapping/host-name/node.def` file.
- **Weaknesses/vulnerabilities present:** Command injection vulnerability. The lack of sanitization allows an attacker to inject arbitrary commands into the 'alias' parameter.
- **Impact of exploitation:** Arbitrary code execution on the router with admin privileges. The provided example demonstrates the ability to create and write to a PHP file.
- **Attack vectors:** HTTP POST request to the `/api/edge/feature.json` endpoint with a crafted JSON payload containing the malicious 'alias' parameter.
- **Required attacker capabilities/position:** The attacker needs to have administrative credentials to access the API and perform the POST request, and knowledge of required Cookie and CSRF-TOKEN.