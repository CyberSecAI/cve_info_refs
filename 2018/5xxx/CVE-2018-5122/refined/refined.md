```json
{
  "cve": "CVE-2018-5122",
  "description": "A potential integer overflow in the `DoCrypt` function of WebCrypto was identified. If a means was found of exploiting it, it could result in an out-of-bounds write.",
  "affected_components": [
    "WebCrypto API",
      "AesTask::DoCrypt()"
  ],
  "root_cause": "Integer overflow in calculation of buffer size within `AesTask::DoCrypt()`. The `maxLen` variable, calculated as `dataLen + 16`, can overflow if `dataLen` is large enough. This leads to a smaller `mResult` buffer allocation than required.",
  "vulnerabilities": [
    "Integer overflow",
    "Out-of-bounds write"
  ],
  "impact": "If exploited, the integer overflow can lead to an out-of-bounds write during encryption or decryption operations using the WebCrypto API. This can lead to memory corruption and potentially arbitrary code execution.",
  "attack_vector": "An attacker can craft a large ArrayBuffer to be used with the WebCrypto API, specifically with the `encrypt` or `decrypt` functions.",
  "attacker_capabilities": "An attacker needs to be able to pass a large data length to the WebCrypto API's encrypt or decrypt functions via an ArrayBuffer.",
  "additional_information": "The vulnerability is in the `dom/crypto/WebCryptoTask.cpp` file within the `AesTask::DoCrypt()` function. The fix involves adding a check to ensure `dataLen` is less than `0xfffffff0` to prevent the integer overflow. The `PK11_Encrypt` and `PK11_Decrypt` functions which are called in `AesTask::DoCrypt()` do not perform checks on the output buffer length which makes exploitation possible."
}
```