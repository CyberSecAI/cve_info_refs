- **Root cause of vulnerability:** The SonicWall SonicOS NSA web interface suffers from persistent input validation vulnerabilities and a filter bypass issue. The application fails to properly sanitize user-supplied input in several fields of the "Users - Settings - Configure SSO" module, allowing injection of malicious script codes. Additionally, a filter intended to block malicious code can be bypassed using specific techniques.
- **Weaknesses/vulnerabilities present:**
    - **Persistent XSS (Cross-Site Scripting):** The application does not adequately sanitize input fields like `Host Name / IP Address`, `Client Name/IP Address`, and `Proxy Forward To` within the SSO configuration modules. This allows attackers to inject arbitrary JavaScript code that is stored and executed when the configuration is viewed.
    - **Filter Bypass:** The implemented filter mechanism to secure validation can be bypassed using `mouseover onload` link, `img src onload` with `cookie alert`, and similar techniques. This allows attackers to inject and execute malicious scripts despite the filter.
- **Impact of exploitation:** Successful exploitation can lead to:
    - Session hijacking
    - Persistent phishing attacks
    - Persistent external redirects
    - Persistent loading of malicious script codes
    - Persistent web module context manipulation
- **Attack vectors:**
    - The attack vector is remote via the web interface.
    - The vulnerabilities are located within the `Users - Settings - Configure SSO` module specifically in `SSO Agents`, `Terminal Services Agent Settings`, and `RADIUS Accounting Single-Sign-On` sections.
- **Required attacker capabilities/position:**
    - Attackers need a low-privileged web application user account to access the vulnerable modules.
    - Low to medium user interaction is required.