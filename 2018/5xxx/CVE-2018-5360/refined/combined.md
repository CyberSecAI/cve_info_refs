=== Content from bugzilla.maptools.org_5dc02a14_20250125_051314.html ===


|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Search](query.cgi)
* |
* | [Reports](report.cgi)
* | [New Account](createaccount.cgi)
* |
  [Help](docs/en/html/bug_page.html)
* | [Log In](http://bugzilla.maptools.org/show_bug.cgi?id=2500&GoAheadAndLogIn=1)

*First*
*Last*
*Prev*
*Next*

*No search results available*

[**Bug 2500**](show_bug.cgi?id=2500) -
CVE-2014-8127 libtiff: Out-of-bounds Read in the tiffset tool

| Summary: | CVE-2014-8127 libtiff: Out-of-bounds Read in the tiffset tool |
| --- | --- |

| | **[Status](page.cgi?id=fields.html#status)**: | RESOLVED FIXED | | --- | --- | |  | | | **Product**: | libtiff | | **[Component](describecomponents.cgi?product=libtiff):** | default | | **Version**: | unspecified | | **Platform**: | PC Linux | |  | | | **[Importance](page.cgi?id=fields.html#importance)**: | P1 critical | | **Target Milestone**: | --- | | **[Assigned To](page.cgi?id=fields.html#assigned_to)**: | Frank Warmerdam | |  | | | **URL**: |  | | **Whiteboard**: |  | | | **[Keywords](describekeywords.cgi)**: |  | | |  | | | Depends on: |  | | Blocks: |  ||  | Show dependency [tree](showdependencytree.cgi?id=2500&hide_resolved=1) / [graph](showdependencygraph.cgi?id=2500) | | |  | | **Reported**: | 2015-01-07 15:56 by william.robinet-libtiff@conostix.com | | --- | --- | | **Modified**: | 2016-10-25 16:39 ([History](show_activity.cgi?id=2500)) | |  | | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| Attachments | |
| --- | --- |
| [**19\_tiffset.tiff**](attachment.cgi?id=601 "View the content of the attachment") (234 bytes, image/tiff)  [2015-01-07 15:56](#attach_601 "Go to the comment associated with the attachment"), william.robinet-libtiff@conostix.com | [Details](attachment.cgi?id=601&action=edit) |
| [**19\_tiffset\_gdb.out**](attachment.cgi?id=602 "View the content of the attachment") (2.74 KB, text/plain)  [2015-01-07 15:56](#attach_602 "Go to the comment associated with the attachment"), william.robinet-libtiff@conostix.com | [Details](attachment.cgi?id=602&action=edit) |
| [**19\_tiffset\_valgrind.out**](attachment.cgi?id=603 "View the content of the attachment") (4.04 KB, text/plain)  [2015-01-07 15:57](#attach_603 "Go to the comment associated with the attachment"), william.robinet-libtiff@conostix.com | [Details](attachment.cgi?id=603&action=edit) |
| [Add an attachment](attachment.cgi?bugid=2500&action=enter) (proposed patch, testcase, etc.) | |

| Note You need to [log in](show_bug.cgi?id=2500&GoAheadAndLogIn=1) before you can comment on or make changes to this bug.   ---   *[Description](show_bug.cgi?id=2500#c0) From william.robinet-libtiff@conostix.com  2015-01-07 15:56:06* ``` [Created an attachment (id=601)](attachment.cgi?id=601 "19_tiffset.tiff") [[details]](attachment.cgi?id=601&action=edit "19_tiffset.tiff") 19_tiffset.tiff  A segmentation fault due to an out-of-bounds read in the tiffset tool can be triggered with a malformed TIFF file.  The attached file named 19_tiffset.tiff triggers the issue with the following command:  $ tiffset 19_tiffset.tiff (The 19_tiffset.tiff file will be altered by tiffset, it must be restored to trigger the error again.)  The invalid read occurs in the TIFFWriteDirectoryTagLongLong8Array function in tif_dirwrite.c at line 1623.  Program received signal SIGSEGV, Segmentation fault. 0x00007ffff7b6d848 in TIFFWriteDirectoryTagLongLong8Array (tif=0x604010, ndir=0x7fffffffe3bc, dir=0x606790, tag=273, count=1, value=0x0) at tif_dirwrite.c:1623 1623            if (*ma>0xFFFFFFFF) (gdb) p *ma Cannot access memory at address 0x0 (gdb)  The 19_tiffset_gdb.out file is a gdb stacktrace after the crash. The 19_tiffset_valgrind.out is a valgrind memcheck output of the tool running with the crash file.  This has been tested on Ubuntu 14.04.1 LTS (amd64) with libtiff-tools 4.0.3-7ubuntu0.1 and on current libtiff CVS revision (07/01/2015). I used the same CVE id as the one assigned by distros [AT] vs.openwall.org on the 3rd of December 2014. ```  ------- *Comment [#1](show_bug.cgi?id=2500#c1) From william.robinet-libtiff@conostix.com  2015-01-07 15:56:50* ------- ``` [Created an attachment (id=602)](attachment.cgi?id=602 "19_tiffset_gdb.out") [[details]](attachment.cgi?id=602&action=edit "19_tiffset_gdb.out") 19_tiffset_gdb.out ```  ------- *Comment [#2](show_bug.cgi?id=2500#c2) From william.robinet-libtiff@conostix.com  2015-01-07 15:57:16* ------- ``` [Created an attachment (id=603)](attachment.cgi?id=603 "19_tiffset_valgrind.out") [[details]](attachment.cgi?id=603&action=edit "19_tiffset_valgrind.out") 19_tiffset_valgrind.out ```  ------- *Comment [#3](show_bug.cgi?id=2500#c3) From Even Rouault  2015-01-22 05:08:08* ------- ``` Please check against the latest CVS head as a number of crashes have been solved. ```  ------- *Comment [#4](show_bug.cgi?id=2500#c4) From Even Rouault  2015-01-22 05:09:11* ------- ``` Disregard my above comment. Didn't read carefully your report ```  ------- *Comment [#5](show_bug.cgi?id=2500#c5) From Even Rouault  2016-10-25 15:18:37* ------- ``` *** [Bug 2546](show_bug.cgi?id=2546 "RESOLVED DUPLICATE - CVE-2016-3658: libtiff 4.0.6 illegel read") has been marked as a duplicate of this bug. *** ```  ------- *Comment [#6](show_bug.cgi?id=2500#c6) From Even Rouault  2016-10-25 15:19:19* ------- ``` This issue has been reported more recently as [http://bugzilla.maptools.org/show_bug.cgi?id=2546](show_bug.cgi?id=2546 "RESOLVED DUPLICATE - CVE-2016-3658: libtiff 4.0.6 illegel read") / CVE-2016-3658 ```  ------- *Comment [#7](show_bug.cgi?id=2500#c7) From Even Rouault  2016-10-25 16:35:42* ------- ``` Fixed per:  2016-10-25 Even Rouault <even.rouault at spatialys.com>          * libtiff/tif_dir.c: discard values of SMinSampleValue and         SMaxSampleValue when they have been read and the value of         SamplesPerPixel is changed afterwards (like when reading a         OJPEG compressed image with a missing SamplesPerPixel tag,         and whose photometric is RGB or YCbCr, forcing SamplesPerPixel         being 3). Otherwise when rewriting the directory (for example         with tiffset, we will expect 3 values whereas the array had been         allocated with just one), thus causing a out of bound read access.         Fixes [http://bugzilla.maptools.org/show_bug.cgi?id=2500](show_bug.cgi?id=2500 "RESOLVED FIXED - CVE-2014-8127 libtiff: Out-of-bounds Read in the tiffset tool")         (CVE-2014-8127, duplicate: CVE-2016-3658)          * libtiff/tif_write.c: avoid null pointer dereference on td_stripoffset         when writing directory, if FIELD_STRIPOFFSETS was artificially set         for a hack case in OJPEG case.         Fixes [http://bugzilla.maptools.org/show_bug.cgi?id=2500](show_bug.cgi?id=2500 "RESOLVED FIXED - CVE-2014-8127 libtiff: Out-of-bounds Read in the tiffset tool")         (CVE-2014-8127, duplicate: CVE-2016-3658)  /cvs/maptools/cvsroot/libtiff/ChangeLog,v  <--  ChangeLog new revision: 1.1146; previous revision: 1.1145 /cvs/maptools/cvsroot/libtiff/libtiff/tif_dir.c,v  <--  libtiff/tif_dir.c new revision: 1.127; previous revision: 1.126 /cvs/maptools/cvsroot/libtiff/libtiff/tif_dirwrite.c,v  <--  libtiff/tif_dirwrite.c new revision: 1.83; previous revision: 1.82 ```  ------- *Comment [#8](show_bug.cgi?id=2500#c8) From Even Rouault  2016-10-25 16:39:10* ------- ``` Note: the above ChangeLog entry was incorrect. It should have mentionned libtiff/tif_dirwrite.c (and not libtiff/tif_write.c) ``` |
| --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=2500)
* - [XML](show_bug.cgi?ctype=xml&id=2500)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=2500)
* - Top of page

*First*
*Last*
*Prev*
*Next*

*No search results available*

* Actions:
  + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Search](query.cgi)
  + |
  + | [Reports](report.cgi)
  + | [New Account](createaccount.cgi)
  + |
    [Help](docs/en/html/bug_page.html)
  + | [Log In](http://bugzilla.maptools.org/show_bug.cgi?id=2500&GoAheadAndLogIn=1)



=== Content from gitlab.com_0c8caa3d_20250125_051316.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

**Commit
739dcd28**

authored
Oct 25, 2016
by
**[![Even Rouault's avatar](https://secure.gravatar.com/avatar/500ba7d293a5756c62a8df5080babc81356561e90be2b6a054f806d88acfebaf?s=96&d=identicon "Even Rouault")](/rouault)
[Even Rouault](/rouault)**

[Browse files](/libtiff/libtiff/-/tree/739dcd28a061738b317c1e9f91029d9cbc157159)

### \* libtiff/tif\_dir.c: discard values of SMinSampleValue and

```
SMaxSampleValue when they have been read and the value of
SamplesPerPixel is changed afterwards (like when reading a
OJPEG compressed image with a missing SamplesPerPixel tag,
and whose photometric is RGB or YCbCr, forcing SamplesPerPixel
being 3). Otherwise when rewriting the directory (for example
with tiffset, we will expect 3 values whereas the array had been
allocated with just one), thus causing a out of bound read access.
Fixes <http://bugzilla.maptools.org/show_bug.cgi?id=2500>
(CVE-2014-8127, duplicate: CVE-2016-3658)

* libtiff/tif_write.c: avoid null pointer dereference on td_stripoffset
when writing directory, if FIELD_STRIPOFFSETS was artificially set
for a hack case	in OJPEG case.
Fixes <http://bugzilla.maptools.org/show_bug.cgi?id=2500>
(CVE-2014-8127, duplicate: CVE-2016-3658)
```

parent
[0c05834d](/libtiff/libtiff/-/commit/0c05834d05b36c2976dca77adb4cae42db3e43cd)

Loading

Loading

Loading

* [Changes
  3](/libtiff/libtiff/-/commit/739dcd28a061738b317c1e9f91029d9cbc157159)

[Hide whitespace changes](/libtiff/libtiff/-/commit/739dcd28a061738b317c1e9f91029d9cbc157159?action=show&controller=projects%2Fcommit&id=739dcd28a061738b317c1e9f91029d9cbc157159&namespace_id=libtiff&project_id=libtiff&w=1)
[Inline](/libtiff/libtiff/-/commit/739dcd28a061738b317c1e9f91029d9cbc157159?view=inline)
[Side-by-side](/libtiff/libtiff/-/commit/739dcd28a061738b317c1e9f91029d9cbc157159?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment


