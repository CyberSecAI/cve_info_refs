The provided content relates to CVE-2014-8127.

**Root cause of vulnerability:**
- An out-of-bounds read in the `tiffset` tool due to inconsistent handling of `SMinSampleValue` and `SMaxSampleValue` tags when the `SamplesPerPixel` tag is changed after the values have been read. Specifically, when rewriting the directory, the tool expects a number of values for these tags corresponding to the new `SamplesPerPixel` value, while the allocated array still corresponds to the old value, causing an out-of-bounds read. Additionally, there is a null pointer dereference on `td_stripoffset` when writing the directory in certain cases involving OJPEG compression.

**Weaknesses/vulnerabilities present:**
- Out-of-bounds read vulnerability in `TIFFWriteDirectoryTagLongLong8Array` function in `tif_dirwrite.c`.
- Null pointer dereference in `tif_write.c` related to `td_stripoffset` when writing directory.

**Impact of exploitation:**
- Segmentation fault due to an out-of-bounds read which can crash the application.
- Potential for denial of service.
- The out of bounds read in `TIFFWriteDirectoryTagLongLong8Array` may have the possibility to be developed into arbitrary code execution, but is not stated explicitly.

**Attack vectors:**
- Maliciously crafted TIFF file.
- The vulnerability is triggered when processing the crafted TIFF file using the `tiffset` tool.

**Required attacker capabilities/position:**
- Ability to provide a malformed TIFF file to a user who then processes the file with the `tiffset` tool.