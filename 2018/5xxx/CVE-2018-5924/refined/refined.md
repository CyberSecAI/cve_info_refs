- **Root cause of vulnerability:** The vulnerability lies in the custom JPEG parser implemented by the printer's firmware. Specifically, a stack-based buffer overflow occurs when processing the DHT (Define Huffman Table) marker in a JPEG file received via fax.
- **Weaknesses/vulnerabilities present:** A stack-based buffer overflow in the JPEG parser's DHT marker processing logic. The parser copies data from the received fax (interpreted as a JPEG file) into a local stack buffer without proper bounds checking.
- **Impact of exploitation:** Successful exploitation allows arbitrary code execution on the printer. This can lead to complete control over the printer, potentially enabling attackers to infiltrate the connected network, steal printed documents, and perform other malicious activities. In this instance, the researchers were able to use the vulnerability to load a custom payload that allowed them to take over the LCD screen, check network connectivity and launch Eternal Blue and Double Pulsar against other machines on the same network.
- **Attack vectors:** A malicious fax containing a crafted JPEG file with a specially crafted DHT marker is sent to the vulnerable printer. The printer's fax functionality receives and processes the fax which triggers the vulnerability.
- **Required attacker capabilities/position:** The attacker only requires the target's fax number and the ability to send a crafted fax to that number. No other special access is needed.