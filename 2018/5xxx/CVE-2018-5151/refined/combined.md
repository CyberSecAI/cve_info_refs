=== Content from www.mozilla.org_879d4593_20250125_161139.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2018-11

## Security vulnerabilities fixed in Firefox 60

Announced
May 9, 2018
Impact
critical
Products
Firefox
Fixed in

* Firefox 60

#### [#CVE-2018-5154: Use-after-free with SVG animations and clip paths](#CVE-2018-5154)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur while enumerating attributes during SVG animations with clip paths. This results in a potentially exploitable crash.

##### References

* [Bug 1443092](https://bugzilla.mozilla.org/show_bug.cgi?id=1443092)

#### [#CVE-2018-5155: Use-after-free with SVG animations and text paths](#CVE-2018-5155)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur while adjusting layout during SVG animations with text paths. This results in a potentially exploitable crash.

##### References

* [Bug 1448774](https://bugzilla.mozilla.org/show_bug.cgi?id=1448774)

#### [#CVE-2018-5157: Same-origin bypass of PDF Viewer to view protected PDF files](#CVE-2018-5157)

Reporter
Wladimir Palant
Impact
high
##### Description

Same-origin protections for the PDF viewer can be bypassed, allowing a malicious site to intercept messages meant for the viewer. This could allow the site to retrieve PDF files restricted to viewing by an authenticated user on a third-party website.

##### References

* [Bug 1449898](https://bugzilla.mozilla.org/show_bug.cgi?id=1449898)

#### [#CVE-2018-5158: Malicious PDF can inject JavaScript into PDF Viewer](#CVE-2018-5158)

Reporter
Wladimir Palant
Impact
high
##### Description

The PDF viewer does not sufficiently sanitize PostScript calculator functions, allowing malicious JavaScript to be injected through a crafted PDF file. This JavaScript can then be run with the permissions of the PDF viewer by its worker.

##### References

* [Bug 1452075](https://bugzilla.mozilla.org/show_bug.cgi?id=1452075)

#### [#CVE-2018-5159: Integer overflow and out-of-bounds write in Skia](#CVE-2018-5159)

Reporter
Ivan Fratric
Impact
high
##### Description

An integer overflow can occur in the Skia library due to 32-bit integer use in an array without integer overflow checks, resulting in possible out-of-bounds writes. This could lead to a potentially exploitable crash triggerable by web content.

##### References

* [Bug 1441941](https://bugzilla.mozilla.org/show_bug.cgi?id=1441941)

#### [#CVE-2018-5160: Uninitialized memory use by WebRTC encoder](#CVE-2018-5160)

Reporter
Andreas Perhson
Impact
high
##### Description

WebRTC can use a `WrappedI420Buffer` pixel buffer but the owning image object can be freed while it is still in use. This can result in the WebRTC encoder using uninitialized memory, leading to a potentially exploitable crash.

##### References

* [Bug 1436117](https://bugzilla.mozilla.org/show_bug.cgi?id=1436117)

#### [#CVE-2018-5152: WebExtensions information leak through webRequest API](#CVE-2018-5152)

Reporter
Andy McKay
Impact
moderate
##### Description

WebExtensions with the appropriate permissions can attach content scripts to Mozilla sites such as accounts.firefox.com and listen to network traffic to the site through the `webRequest` API. For example, this allows for the interception of username and an encrypted password during login to Firefox Accounts. This issue does not expose synchronization traffic directly and is limited to the process of user login to the website and the data displayed to the user once logged in.

##### References

* [Bug 1415644](https://bugzilla.mozilla.org/show_bug.cgi?id=1415644)
* [Bug 1427289](https://bugzilla.mozilla.org/show_bug.cgi?id=1427289)

#### [#CVE-2018-5153: Out-of-bounds read in mixed content websocket messages](#CVE-2018-5153)

Reporter
Dennis Fuchs
Impact
moderate
##### Description

If websocket data is sent with mixed text and binary in a single message, the binary data can be corrupted. This can result in an out-of-bounds read with the read memory sent to the originating server in response.

##### References

* [Bug 1436809](https://bugzilla.mozilla.org/show_bug.cgi?id=1436809)

#### [#CVE-2018-5163: Replacing cached data in JavaScript Start-up Bytecode Cache](#CVE-2018-5163)

Reporter
Nicolas B. Pierron
Impact
moderate
##### Description

If a malicious attacker has used another vulnerability to gain full control over a content process, they may be able to replace the alternate data resources stored in the JavaScript Start-up Bytecode Cache (JSBC) for other JavaScript code. If the parent process then runs this replaced code, the executed script would be run with the parent process' privileges, escaping the sandbox on content processes.

##### References

* [Bug 1426353](https://bugzilla.mozilla.org/show_bug.cgi?id=1426353)

#### [#CVE-2018-5164: CSP not applied to all multipart content sent with multipart/x-mixed-replace](#CVE-2018-5164)

Reporter
Khalil Zhani
Impact
moderate
##### Description

Content Security Policy (CSP) is not applied correctly to all parts of multipart content sent with the `multipart/x-mixed-replace` MIME type. This could allow for script to run where CSP should block it, allowing for cross-site scripting (XSS) and other attacks.

##### References

* [Bug 1416045](https://bugzilla.mozilla.org/show_bug.cgi?id=1416045)

#### [#CVE-2018-5166: WebExtension host permission bypass through filterReponseData](#CVE-2018-5166)

Reporter
Francois Lajeunesse Robert
Impact
moderate
##### Description

WebExtensions can use request redirection and a `filterReponseData` filter to bypass host permission settings to redirect network traffic and access content from a host for which they do not have explicit user permission.

##### References

* [Bug 1437325](https://bugzilla.mozilla.org/show_bug.cgi?id=1437325)

#### [#CVE-2018-5167: Improper linkification of chrome: and javascript: content in web console and JavaScript debugger](#CVE-2018-5167)

Reporter
Wladimir Palant
Impact
moderate
##### Description

The web console and JavaScript debugger do not sanitize all output that can be hyperlinked. Both will display `chrome:` links as active, clickable hyperlinks in their output. Web sites should not be able to directly link to internal chrome pages. Additionally, the JavaScript debugger will display `javascript:` links, which users could be tricked into clicking by malicious sites.

##### References

* [Bug 1447969](https://bugzilla.mozilla.org/show_bug.cgi?id=1447969)

#### [#CVE-2018-5168: Lightweight themes can be installed without user interaction](#CVE-2018-5168)

Reporter
Wladimir Palant
Impact
moderate
##### Description

Sites can bypass security checks on permissions to install lightweight themes by manipulating the `baseURI` property of the theme element. This could allow a malicious site to install a theme without user interaction which could contain offensive or embarrassing images.

##### References

* [Bug 1449548](https://bugzilla.mozilla.org/show_bug.cgi?id=1449548)

#### [#CVE-2018-5169: Dragging and dropping link text onto home button can set home page to include chrome pages](#CVE-2018-5169)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

If manipulated hyperlinked text with `chrome:` URL contained in it is dragged and dropped on the "home" icon, the home page can be reset to include a normally-unlinkable chrome page as one of the home page tabs.

##### References

* [Bug 1319157](https://bugzilla.mozilla.org/show_bug.cgi?id=1319157)

#### [#CVE-2018-5172: Pasted script from clipboard can run in the Live Bookmarks page or PDF viewer](#CVE-2018-5172)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

The Live Bookmarks page and the PDF viewer can run injected script content if a user pastes script from the clipboard into them while viewing RSS feeds or PDF files. This could allow a malicious site to socially engineer a user to copy and paste malicious script content that could then run with the context of either page but does not allow for privilege escalation.

##### References

* [Bug 1436482](https://bugzilla.mozilla.org/show_bug.cgi?id=1436482)

#### [#CVE-2018-5173: File name spoofing of Downloads panel with Unicode characters](#CVE-2018-5173)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

The filename appearing in the `Downloads` panel improperly renders some Unicode characters, allowing for the file name to be spoofed. This can be used to obscure the file extension of potentially executable files from user view in the panel.
*Note: the dialog to open the file will show the full, correct filename and whether it is executable or not.*

##### References

* [Bug 1438025](https://bugzilla.mozilla.org/show_bug.cgi?id=1438025)

#### [#CVE-2018-5174: Windows Defender SmartScreen UI runs with less secure behavior for downloaded files in Windows 10 April 2018 Update](#CVE-2018-5174)

Reporter
Jimmy
Impact
moderate
##### Description

In the Windows 10 April 2018 Update, Windows Defender SmartScreen honors the `SEE_MASK_FLAG_NO_UI` flag associated with downloaded files and will not show any UI. Files that are unknown and potentially dangerous will be allowed to run because SmartScreen will not prompt the user for a decision, and if the user is offline all files will be allowed to be opened because Windows won’t prompt the user to ask what to do. Firefox incorrectly sets this flag when downloading files, leading to less secure behavior from SmartScreen.
*Note: this issue only affects Windows 10 users running the April 2018 update or later. It does not affect other Windows users or other operating systems.*

##### References

* [Bug 1447080](https://bugzilla.mozilla.org/show_bug.cgi?id=1447080)

#### [#CVE-2018-5175: Universal CSP bypass on sites using strict-dynamic in their policies](#CVE-2018-5175)

Reporter
Masato Kinugawa
Impact
moderate
##### Description

A mechanism to bypass Content Security Policy (CSP) protections on sites that have a `script-src` policy of `'strict-dynamic'`. If a target website contains an HTML injection flaw an attacker could inject a reference to a copy of the `require.js` library that is part of Firefox’s Developer Tools, and then use a known technique using that library to bypass the CSP restrictions on executing injected scripts.

##### References

* [Bug 1432358](https://bugzilla.mozilla.org/show_bug.cgi?id=1432358)

#### [#CVE-2018-5176: JSON Viewer script injection](#CVE-2018-5176)

Reporter
Tadj Youssouf
Impact
moderate
##### Description

The JSON Viewer displays clickable hyperlinks for strings that are parseable as URLs, including `javascript:` links. If a JSON file contains malicious JavaScript script embedded as `javascript:` links, users may be tricked into clicking and running this code in the context of the JSON Viewer. This can allow for the theft of cookies and authorization tokens which are accessible to that context.

##### References

* [Bug 1442840](https://bugzilla.mozilla.org/show_bug.cgi?id=1442840)

#### [#CVE-2018-5177: Buffer overflow in XSLT during number formatting](#CVE-2018-5177)

Reporter
Guyio
Impact
moderate
##### Description

A vulnerability exists in XSLT during number formatting where a negative buffer size may be allocated in some instances, leading to a buffer overflow and crash if it occurs.

##### References

* [Bug 1451908](https://bugzilla.mozilla.org/show_bug.cgi?id=1451908)

#### [#CVE-2018-5165: Checkbox for enabling Flash protected mode is inverted in 32-bit Firefox](#CVE-2018-5165)

Reporter
David Parks
Impact
low
##### Description

In 32-bit versions of Firefox, the Adobe Flash plugin setting for "Enable Adobe Flash protected mode" is unchecked by default even though the Adobe Flash sandbox is actually enabled. The displayed state is the reverse of the true setting, resulting in user confusion. This could cause users to select this setting intending to activate it and inadvertently turn protections off.

##### References

* [Bug 1451452](https://bugzilla.mozilla.org/show_bug.cgi?id=1451452)

#### [#CVE-2018-5180: heap-use-after-free in mozilla::WebGLContext::DrawElementsInstanced](#CVE-2018-5180)

Reporter
Nils
Impact
low
##### Description

A use-after-free vulnerability can occur during WebGL operations. While this results in a potentially exploitable crash, the vulnerability is limited because the memory is freed and reused in a brief window of time during the freeing of the same callstack.

##### References

* [Bug 1444086](https://bugzilla.mozilla.org/show_bug.cgi?id=1444086)

#### [#CVE-2018-5181: Local file can be displayed in noopener tab through drag and drop of hyperlink](#CVE-2018-5181)

Reporter
Abdulrahman Alqabandi
Impact
low
##### Description

If a URL using the `file:` protocol is dragged and dropped onto an open tab that is running in a different child process the tab will open a local file corresponding to the dropped URL, contrary to policy. One way to make the target tab open more reliably in a separate process is to open it with the `noopener` keyword.

##### References

* [Bug 1424107](https://bugzilla.mozilla.org/show_bug.cgi?id=1424107)

#### [#CVE-2018-5182: Local file can be displayed from hyperlink dragged and dropped on addressbar](#CVE-2018-5182)

Reporter
Jordi Chancel
Impact
low
##### Description

If a text string that happens to be a filename in the operating system's native format is dragged and dropped onto the addressbar the specified local file will be opened. This is contrary to policy and is what would happen if the string were the equivalent `file:` URL.

##### References

* [Bug 1435908](https://bugzilla.mozilla.org/show_bug.cgi?id=1435908)

#### [#CVE-2018-5179: Service workers can self update to keep a worker running](#CVE-2018-5179)

Reporter
Yannic Bonenberger
Impact
low
##### Description

A service worker can send the "activate" event on itself periodically which allows it to run perpetually. This would allow any malicious activity, such as logging an IP address by the service worker, to occur in the background.

##### References

* [Bug 1432846](https://bugzilla.mozilla.org/show_bug.cgi?id=1432846)

#### [#CVE-2018-5151: Memory safety bugs fixed in Firefox 60](#CVE-2018-5151)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Christoph Diehl, Christian Holler, Jon Coppeard, Jason Kratzer, Nathan Froyd, Paul Theriault, Ryan VanderMeulen, Tyson Smith, Sebastian Hengst, Byron Campen, Emilio Cobos Álvarez, Ronald Crane, and Phillipp reported memory safety bugs present in Firefox 59. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 60](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1445234%2C1449530%2C1437455%2C1447989%2C1438827%2C1436983%2C1435036%2C1440465%2C1439723%2C1448771%2C1453653%2C1454359%2C1432323%2C1454126%2C1436759%2C1439655%2C1448612%2C1449358%2C1367727%2C1452417)

#### [#CVE-2018-5150: Memory safety bugs fixed in Firefox 60 and Firefox ESR 52.8](#CVE-2018-5150)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Christoph Diehl, Randell Jesup, Tyson Smith, Alex Gaynor, Ronald Crane, Julian Hector, Kannan Vijayan, and Jason Kratzer reported memory safety bugs present in Firefox 59 and Firefox ESR 52.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 60 and Firefox ESR 52.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1388020%2C1433609%2C1409440%2C1448705%2C1451376%2C1452202%2C1444668%2C1393367%2C1411415%2C1426129)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_25edab76_20250125_161131.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Sat Jan 25 2025 08:11:31 PST

* **Bug ID:**
  1445234,
  1449530,
  1437455,
  1447989,
  1438827,
  1436983,
  1435036,
  1440465,
  1439723,
  1448771,
  1453653,
  1454359,
  1432323,
  1454126,
  1436759,
  1439655,
  1448612,
  1449358,
  1367727,
  1452417

---

20 bugs found.

| [ID](/buglist.cgi?bug_id=1445234%2C1449530%2C1437455%2C1447989%2C1438827%2C1436983%2C1435036%2C1440465%2C1439723%2C1448771%2C1453653%2C1454359%2C1432323%2C1454126%2C1436759%2C1439655%2C1448612%2C1449358%2C1367727%2C1452417&query_format=advanced&order=bug_id%20DESC&query_based_on=) | [Type](/buglist.cgi?bug_id=1445234%2C1449530%2C1437455%2C1447989%2C1438827%2C1436983%2C1435036%2C1440465%2C1439723%2C1448771%2C1453653%2C1454359%2C1432323%2C1454126%2C1436759%2C1439655%2C1448612%2C1449358%2C1367727%2C1452417&query_format=advanced&order=bug_type%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Summary](/buglist.cgi?bug_id=1445234%2C1449530%2C1437455%2C1447989%2C1438827%2C1436983%2C1435036%2C1440465%2C1439723%2C1448771%2C1453653%2C1454359%2C1432323%2C1454126%2C1436759%2C1439655%2C1448612%2C1449358%2C1367727%2C1452417&query_format=advanced&order=short_desc%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Product](/buglist.cgi?bug_id=1445234%2C1449530%2C1437455%2C1447989%2C1438827%2C1436983%2C1435036%2C1440465%2C1439723%2C1448771%2C1453653%2C1454359%2C1432323%2C1454126%2C1436759%2C1439655%2C1448612%2C1449358%2C1367727%2C1452417&query_format=advanced&order=product%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Comp](/buglist.cgi?bug_id=1445234%2C1449530%2C1437455%2C1447989%2C1438827%2C1436983%2C1435036%2C1440465%2C1439723%2C1448771%2C1453653%2C1454359%2C1432323%2C1454126%2C1436759%2C1439655%2C1448612%2C1449358%2C1367727%2C1452417&query_format=advanced&order=component%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Assignee▲](/buglist.cgi?bug_id=1445234%2C1449530%2C1437455%2C1447989%2C1438827%2C1436983%2C1435036%2C1440465%2C1439723%2C1448771%2C1453653%2C1454359%2C1432323%2C1454126%2C1436759%2C1439655%2C1448612%2C1449358%2C1367727%2C1452417&query_format=advanced&order=assigned_to%20DESC%2Cbug_status%2Cpriority%2Cbug_id&query_based_on=) | [Status▲](/buglist.cgi?bug_id=1445234%2C1449530%2C1437455%2C1447989%2C1438827%2C1436983%2C1435036%2C1440465%2C1439723%2C1448771%2C1453653%2C1454359%2C1432323%2C1454126%2C1436759%2C1439655%2C1448612%2C1449358%2C1367727%2C1452417&query_format=advanced&order=bug_status%20DESC%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Resolution](/buglist.cgi?bug_id=1445234%2C1449530%2C1437455%2C1447989%2C1438827%2C1436983%2C1435036%2C1440465%2C1439723%2C1448771%2C1453653%2C1454359%2C1432323%2C1454126%2C1436759%2C1439655%2C1448612%2C1449358%2C1367727%2C1452417&query_format=advanced&order=resolution%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Updated](/buglist.cgi?bug_id=1445234%2C1449530%2C1437455%2C1447989%2C1438827%2C1436983%2C1435036%2C1440465%2C1439723%2C1448771%2C1453653%2C1454359%2C1432323%2C1454126%2C1436759%2C1439655%2C1448612%2C1449358%2C1367727%2C1452417&query_format=advanced&order=changeddate%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [1435036](/show_bug.cgi?id=1435036 "RESOLVED FIXED - AddressSanitizer: heap-use-after-free /builds/worker/workspace/build/src/dom/media/MediaManager.cpp:4419:7 in ChromeAffectingStateChanged") |  | [AddressSanitizer: heap-use-after-free /builds/worker/workspace/build/src/dom/media/MediaManager.cpp:4419:7 in ChromeAffectingStateChanged](/show_bug.cgi?id=1435036) | Core | WebRTC | apehrson | RESO | FIXE | 2020-02-28 |
| [1439655](/show_bug.cgi?id=1439655 "RESOLVED FIXED - Wild pointer read in copy_and_extend_plane") |  | [Wild pointer read in copy\_and\_extend\_plane](/show_bug.cgi?id=1439655) | Core | WebRTC: Audio/Video | apehrson | RESO | FIXE | 2019-05-24 |
| [1436983](/show_bug.cgi?id=1436983 "RESOLVED FIXED - CodeGenerator::link can GC before capturing read barriers") |  | [CodeGenerator::link can GC before capturing read barriers](/show_bug.cgi?id=1436983) | Core | JavaScript: GC | jcoppeard | RESO | FIXE | 2018-11-05 |
| [1437455](/show_bug.cgi?id=1437455 "RESOLVED FIXED - Assertion failure: off.assigned() && offset >= 0 && unsigned(offset) < size(), at js/src/jit/shared/IonAssemblerBuffer.h:379") |  | [Assertion failure: off.assigned() && offset >= 0 && unsigned(offset) < size(), at js/src/jit/shared/IonAssemblerBuffer.h:379](/show_bug.cgi?id=1437455) | Core | JavaScript Engine | lhansen | RESO | FIXE | 2018-08-28 |
| [1454126](/show_bug.cgi?id=1454126 "RESOLVED FIXED - crash at null in [@ nsMappedAttributes::GetAttr]") |  | [crash at null in [@ nsMappedAttributes::GetAttr]](/show_bug.cgi?id=1454126) | Core | DOM: Editor | masayuki | RESO | FIXE | 2019-05-24 |
| [1454359](/show_bug.cgi?id=1454359 "RESOLVED FIXED - Cherry-pick more upstream FreeType oss-fuzz fixes") |  | [Cherry-pick more upstream FreeType oss-fuzz fixes](/show_bug.cgi?id=1454359) | Core | Graphics: Text | ryanvm | RESO | FIXE | 2018-08-28 |
| [1367727](/show_bug.cgi?id=1367727 "RESOLVED FIXED - Crash in js::gc::AtomMarkingRuntime::markAtom") |  | [Crash in js::gc::AtomMarkingRuntime::markAtom](/show_bug.cgi?id=1367727) | Core | JavaScript Engine | tcampbell | RESO | FIXE | 2018-08-28 |
| [1452417](/show_bug.cgi?id=1452417 "RESOLVED FIXED - Crash in nsCOMPtr<T>::nsCOMPtr<T> | nsHostResolver::DetachCallback") |  | [Crash in nsCOMPtr<T>::nsCOMPtr<T> | nsHostResolver::DetachCallback](/show_bug.cgi?id=1452417) | Core | Networking: DNS | valentin.gosu | RESO | FIXE | 2018-08-28 |
| [1436759](/show_bug.cgi?id=1436759 "RESOLVED FIXED - Intermittent SUMMARY: AddressSanitizer: heap-use-after-free /builds/worker/workspace/build/src/media/mtransport/sigslot.h:2007:11 in sigslot::_connection4<mozilla::TransportLayerIce, mozilla::NrIceMediaStream*, int, unsigned char const*, int, sigslot::si") |  | [Intermittent SUMMARY: AddressSanitizer: heap-use-after-free /builds/worker/workspace/build/src/media/mtransport/sigslot.h:2007:11 in sigslot::\_connection4<mozilla::TransportLayerIce, mozilla::NrIceMediaStream\*, int, unsigned char const\*, int, sigslot::si](/show_bug.cgi?id=1436759) | Core | WebRTC | mfroman | RESO | FIXE | 2020-02-28 |
| [1449358](/show_bug.cgi?id=1449358 "RESOLVED FIXED - Latent heap corruption on allocator mismatch in nsAuthSambaNTLM::GetNextToken()") |  | [Latent heap corruption on allocator mismatch in nsAuthSambaNTLM::GetNextToken()](/show_bug.cgi?id=1449358) | Core | Networking: HTTP | alex.gaynor | RESO | FIXE | 2024-05-30 |
| [1445234](/show_bug.cgi?id=1445234 "RESOLVED FIXED - IPC: crash [@get_gtk_cursor]") |  | [IPC: crash [@get\_gtk\_cursor]](/show_bug.cgi?id=1445234) | Core | DOM: Content Process | alex.gaynor | RESO | FIXE | 2019-05-24 |
| [1448612](/show_bug.cgi?id=1448612 "RESOLVED FIXED - Double free in nsStreamLoader (presumably because of FetchConsumer stuff).") |  | [Double free in nsStreamLoader (presumably because of FetchConsumer stuff).](/show_bug.cgi?id=1448612) | Core | DOM: Workers | emilio | RESO | FIXE | 2018-08-28 |
| [1432323](/show_bug.cgi?id=1432323 "RESOLVED FIXED - UBSan: member access within address 0x6030002a4d80 which does not point to an object of type 'nsCOMArrayEnumerator' in /xpcom/ds/nsArrayEnumerator.cpp:197") |  | [UBSan: member access within address 0x6030002a4d80 which does not point to an object of type 'nsCOMArrayEnumerator' in /xpcom/ds/nsArrayEnumerator.cpp:197](/show_bug.cgi?id=1432323) | Core | XPCOM | ericrahm+bz | RESO | FIXE | 2018-11-05 |
| [1439723](/show_bug.cgi?id=1439723 "RESOLVED FIXED - Nullable::SetValue leads to footguns in the animation code") |  | [Nullable::SetValue leads to footguns in the animation code](/show_bug.cgi?id=1439723) | Core | DOM: Animation | froydnj+bz | RESO | FIXE | 2018-11-05 |
| [1440465](/show_bug.cgi?id=1440465 "RESOLVED FIXED - uninitialized memory accesses in AutoPointerEventTargetUpdater") |  | [uninitialized memory accesses in AutoPointerEventTargetUpdater](/show_bug.cgi?id=1440465) | Core | Layout | froydnj+bz | RESO | FIXE | 2018-08-28 |
| [1438827](/show_bug.cgi?id=1438827 "RESOLVED FIXED - Assertion failures while tracing ARM assembler: data >> 28 != 0xf") |  | [Assertion failures while tracing ARM assembler: data >> 28 != 0xf](/show_bug.cgi?id=1438827) | Core | JavaScript Engine: J | jcoppeard | RESO | FIXE | 2018-11-05 |
| [1448771](/show_bug.cgi?id=1448771 "RESOLVED FIXED - Buffer overflow in hyphen (not the same as 1390550)") |  | [Buffer overflow in hyphen (not the same as 1390550)](/show_bug.cgi?id=1448771) | Core | Layout: Text and Fon | jfkthame | RESO | FIXE | 2018-11-05 |
| [1453653](/show_bug.cgi?id=1453653 "RESOLVED FIXED - Cherry-pick an upstream FreeType integer overflow fix") |  | [Cherry-pick an upstream FreeType integer overflow fix](/show_bug.cgi?id=1453653) | Core | Graphics: Text | ryanvm | RESO | FIXE | 2018-08-28 |
| [1449530](/show_bug.cgi?id=1449530 "RESOLVED FIXED - IPC: global-buffer-overflow crash with PDocAccessible::Msg_StateChangeEvent [@FireStateChangeEvent]") |  | [IPC: global-buffer-overflow crash with PDocAccessible::Msg\_StateChangeEvent [@FireStateChangeEvent]](/show_bug.cgi?id=1449530) | Core | Disability Access AP | surkov.alexander | RESO | FIXE | 2019-05-24 |
| [1447989](/show_bug.cgi?id=1447989 "VERIFIED FIXED - Crash [@ js::ReportMagicWordFailure] or Crash [@ js::ConstraintTypeSet::addType] with GC") |  | [Crash [@ js::ReportMagicWordFailure] or Crash [@ js::ConstraintTypeSet::addType] with GC](/show_bug.cgi?id=1447989) | Core | JavaScript Engine | jdemooij | VERI | FIXE | 2023-12-06 |

20 bugs found.

|  |  | [REST](/rest/bug?include_fields=id,summary,status&bug_id=1445234%2C1449530%2C1437455%2C1447989%2C1438827%2C1436983%2C1435036%2C1440465%2C1439723%2C1448771%2C1453653%2C1454359%2C1432323%2C1454126%2C1436759%2C1439655%2C1448612%2C1449358%2C1367727%2C1452417 "Query as a REST API request") | [CSV](/buglist.cgi?bug_id=1445234%2C1449530%2C1437455%2C1447989%2C1438827%2C1436983%2C1435036%2C1440465%2C1439723%2C1448771%2C1453653%2C1454359%2C1432323%2C1454126%2C1436759%2C1439655%2C1448612%2C1449358%2C1367727%2C1452417&query_format=advanced&ctype=csv&human=1) | [Feed](/buglist.cgi?bug_id=1445234%2C1449530%2C1437455%2C1447989%2C1438827%2C1436983%2C1435036%2C1440465%2C1439723%2C1448771%2C1453653%2C1454359%2C1432323%2C1454126%2C1436759%2C1439655%2C1448612%2C1449358%2C1367727%2C1452417&query_format=advanced&title=Bug%20List&ctype=atom) | [iCalendar](/buglist.cgi?bug_id=1445234%2C1449530%2C1437455%2C1447989%2C1438827%2C1436983%2C1435036%2C1440465%2C1439723%2C1448771%2C1453653%2C1454359%2C1432323%2C1454126%2C1436759%2C1439655%2C1448612%2C1449358%2C1367727%2C1452417&query_format=advanced&ctype=ics)  [Change Columns](/colchange.cgi?bug_id=1445234%2C1449530%2C1437455%2C1447989%2C1438827%2C1436983%2C1435036%2C1440465%2C1439723%2C1448771%2C1453653%2C1454359%2C1432323%2C1454126%2C1436759%2C1439655%2C1448612%2C1449358%2C1367727%2C1452417&query_format=advanced&query_based_on=) | [Edit Search](/query.cgi?bug_id=1445234%2C1449530%2C1437455%2C1447989%2C1438827%2C1436983%2C1435036%2C1440465%2C1439723%2C1448771%2C1453653%2C1454359%2C1432323%2C1454126%2C1436759%2C1439655%2C1448612%2C1449358%2C1367727%2C1452417&query_format=advanced) |  | as |
| --- | --- | --- | --- | --- | --- |

[File
a new bug
in the "Core" product](/enter_bug.cgi?product=Core)



=== Content from bugzilla.mozilla.org_f457b9e7_20250126_101121.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1432846)
* [XML](/show_bug.cgi?ctype=xml&id=1432846)

Closed
[Bug 1432846](/show_bug.cgi?id=1432846)
(CVE-2018-5179)

Opened 7 years ago
Closed 7 years ago

# Self-update service worker to stay alive

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Self-update service worker to stay alive

## Categories

### (Core :: DOM: Service Workers, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Service%20Workers#DOM%3A%20Service%20Workers)

DOM: Service Workers
▾

Core :: DOM: Service Workers
This component covers the [Service Worker](https://github.com/slightlyoff/ServiceWorker/) implementation in Gecko.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Service%20Workers&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Service%20Workers&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Service%20Workers)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

57 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla60

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr52 | --- | [disabled](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=disabled) |
| firefox58 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox58&o1=equals&v1=wontfix) |
| firefox59 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox59&o1=equals&v1=wontfix) |
| firefox60 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr52 |  | disabled |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox58 |  | wontfix |
| firefox59 |  | wontfix |
| firefox60 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: contact, Assigned: catalinb)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/87e3213e4c2ccbf859894566982a1e54?d=mm&size=40)  [catalinb](/user_profile?user_id=488358)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/0dcb8085aab2f202a7ab5275992c73e8?d=mm&size=40)  [contact](/user_profile?user_id=610581)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/056757eff6ed7c8ec26f61e3bf7695fe?d=mm&size=40)  [smaug](/user_profile?user_id=39966)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1445475](/show_bug.cgi?id=1445475 "RESOLVED FIXED - Crash in mozilla::dom::ServiceWorkerPrivate::StoreISupports")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[eviltraps](/show_bug.cgi?id=432687 "NEW - [meta] Protect users from websites that trap them or destroy their experience")

Dependency [tree](/showdependencytree.cgi?id=1432846&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1432846)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[bugs.chromium.org/p/chromium/issues/d...](https://bugs.chromium.org/p/chromium/issues/detail?id=805496 "https://bugs.chromium.org/p/chromium/issues/detail?id=805496")

## Details

### (Keywords: csectype-dos, privacy, sec-low, Whiteboard: [Embargo until Chrome?][adv-main60+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2018-5179

[Keywords:](/describekeywords.cgi)

[csectype-dos](/buglist.cgi?keywords=csectype-dos&resolution=---),
[privacy](/buglist.cgi?keywords=privacy&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[Embargo until Chrome?][adv-main60+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [emilghitta](/user_profile?user_id=588744) | [qe-verify](#c36 "7 years ago") | - |
| --- | --- | --- |
| [emilghitta](/user_profile?user_id=588744) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 5 obsolete files)

| [sw.go](/attachment.cgi?id=8945135)  [7 years ago](#c0)  [Yannic Bonenberger](/user_profile?user_id=610581)   1.00 KB, text/plain |  | [Details](/attachment.cgi?id=8945135&action=edit) |
| --- | --- | --- |
| [Delay update runnables from service workers that don't control any clients. r=bkelly](/attachment.cgi?id=8951365)  [7 years ago](#c13)  [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)   9.53 KB, patch | bkelly : [review-](#c16 "7 years ago") | [Details](/attachment.cgi?id=8951365&action=edit) | [Diff](/attachment.cgi?id=8951365&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8951365) |
| [Add test for self updating service worker. r=bkelly](/attachment.cgi?id=8951366)  [7 years ago](#c14)  [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)   5.22 KB, patch | bkelly : [review+](#c28 "7 years ago") | [Details](/attachment.cgi?id=8951366&action=edit) | [Diff](/attachment.cgi?id=8951366&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8951366) |
| [Delay update runnables from service workers that don't control any clients.](/attachment.cgi?id=8952339)  [7 years ago](#c18)  [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)   9.48 KB, patch | bkelly : [review-](#c19 "7 years ago") | [Details](/attachment.cgi?id=8952339&action=edit) | [Diff](/attachment.cgi?id=8952339&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8952339) |
| [Delay update runnables from service workers that don't control any clients.](/attachment.cgi?id=8952746)  [7 years ago](#c21)  [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)   9.34 KB, patch |  | [Details](/attachment.cgi?id=8952746&action=edit) | [Diff](/attachment.cgi?id=8952746&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8952746) |
| [Delay update runnables from service workers that don't control any clients.](/attachment.cgi?id=8952748)  [7 years ago](#c22)  [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)   8.94 KB, patch |  | [Details](/attachment.cgi?id=8952748&action=edit) | [Diff](/attachment.cgi?id=8952748&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8952748) |
| [Delay update runnables from service workers that don't control any clients.](/attachment.cgi?id=8952749)  [7 years ago](#c23)  [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)   8.97 KB, patch | bkelly : [review-](#c27 "7 years ago") | [Details](/attachment.cgi?id=8952749&action=edit) | [Diff](/attachment.cgi?id=8952749&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8952749) |
| [Delay update runnables from service workers that don't control any clients.](/attachment.cgi?id=8954360)  [7 years ago](#c29)  [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)   12.36 KB, patch | bkelly : [review+](#c30 "7 years ago") | [Details](/attachment.cgi?id=8954360&action=edit) | [Diff](/attachment.cgi?id=8954360&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8954360) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Yannic Bonenberger](/user_profile?user_id=610581)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1432846#c0)• 7 years ago |
|  | |

Attached file
[sw.go](attachment.cgi?id=8945135)
— [Details](attachment.cgi?id=8945135&action=edit)

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10\_13\_2) AppleWebKit/604.4.7 (KHTML, like Gecko) Version/11.0.2 Safari/604.4.7
Steps to reproduce:
VULNERABILITY DETAILS
Service workers can self update to keep at least one version running.
This was also reported to Chrome (Spec bug?).
REPRODUCTION CASE
1. Create index.html to load SW
<!DOCTYPE html>
<script>
navigator.serviceWorker.register('/sw.js');
</script>
2. Create sw.js, and make sure the file will change every time the SW updates.
One simple way of doing this is by adding the current timestamp to sw.js.
(I attached a simple Go program for this).
// Time: {now}
function wait(ms) {
// This is only to show
const i = setInterval(() => console.log('is alive'), 1000);
return new Promise(resolve => setTimeout(() => {
clearInterval(i);
resolve();
}, ms));
}
self.addEventListener('activate', event => {
// Don't wait too long or the worker will be killed and this does not work.
event.waitUntil(wait(120000).then(() => {
self.registration.update();
}));
});
3. Open the html file (<http://localhost:5000/index.html>).
This will register the SW and fire the |activate| event, which will wait some time and then self-update the SW. Because we include a unique timestamp in sw.js, SW will update and fire the |activate| event on the new worker.
This can be repeated forever to keep at least one version running.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1432846#a576_406194)• 7 years ago |

Group: firefox-core-security → core-securityComponent: Untriaged → DOM: Service WorkersProduct: Firefox → Core

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1432846#a595_406194)• 7 years ago |

Summary: Security: Self-update service worker to stay alive → Self-update service worker to stay alive

|  | [Ben Kelly [:bkelly, not reviewing]](/user_profile?user_id=465500) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1432846#c1)• 7 years ago |
|  | |

This is bad for battery and memory, but its unclear to me if its a security issue.

|  | [Yannic Bonenberger](/user_profile?user_id=610581)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1432846#c2)• 7 years ago |
|  | |

I think this is a security issue because it violates the user's privacy.
Let's say we use the running SW to ping a server instead of logging a message.
Websites can now use this to track their users after they close the page, at least until they close the browser.
If these websites have permission to send push notifications, they are able to track users even if they restart Firefox like this:
1. SW pings server.
2. If server did not receive a ping for some time, it sends an invisible push notification to the user which will be delivered when the user opens Firefox again.

|  | [Ben Kelly [:bkelly, not reviewing]](/user_profile?user_id=465500) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1432846#c3)• 7 years ago |
|  | |

If a service worker has push notifications permission then the server can already send push notifications to start the service worker in the background. It can use waitUntil() to hold the worker alive 5 minutes or so currently. Its unclear to me if we have throttling that would prevent push notifications coming once every 5 minutes.
By track, what exactly do you mean? Tracking based on their ip address?

|  | [Yannic Bonenberger](/user_profile?user_id=610581)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1432846#c4)• 7 years ago |
|  | |

Tracking could be done based on ip addresses, or by including a unique token in the name of the service worker script.
The ability to track a user was only an example of how it can be a privacy issue. People could also use this to execute tasks which consume a lot of cpu or memory.
I think there are good reasons for the restriction that service workers cannot do this, and the example above shows a way to bypass it.
If you decide to close this, i'd like to ask you to not make this report public yet. Chromium has a similar issue which can be used to run a service worker every time the browser starts and keep it running until the user closes the browser, but Chromium does not require the user to grant any permission to do this.

|  | [Ben Kelly [:bkelly, not reviewing]](/user_profile?user_id=465500) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1432846#c5)• 7 years ago |
|  | |

I'm not saying we shouldn't fix the issue. I was trying to determine if its a security issue and if so, how severe it is:
<https://wiki.mozilla.org/Security_Severity_Ratings>
We may need a spec change to deal with the self update() call.

|  | [Ben Kelly [:bkelly, not reviewing]](/user_profile?user_id=465500) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1432846#c6)• 7 years ago |
|  | |

Do we have any way to have spec discussions about private bugs like this?Flags: needinfo?(annevk)

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1432846#c7)• 7 years ago |
|  | |

There's no formalized way of handling it. I suggest discussing it here or in an equivalent bug of another browser. I copied Jake and Jungkee for their perspective.Flags: needinfo?(annevk)

|  | [Ben Kelly [:bkelly, not reviewing]](/user_profile?user_id=465500) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1432846#c8)• 7 years ago |
|  | |

I'm also now in an email thread with Matt Falkenhagen and Ali Alabbas.
The main concern so far is using this to mine bitcoin, etc.
There are a few solutions on the table. In order of difficulty:
1. Reject self-update calls by service workers if there are no window/worker clients open.
2. Progressively delay the start of the update process every time self-update is called by a service worker while there are no clients open. It will work a few times, but eventually the delay will be greater than the service worker timeout and it will be killed. Opening a controlled client would reset the progressive delay.
3. Propagate the lifetime budget of the service worker through the update process to the new worker's install and activate events. Those events budgets are limited by the initial budget of the service worker that did a self-update. This is similar to how we solved self-postMessage(), but its a bit weird since the update results fires two events instead of one.
I think we ultimately want to do (3), but we don't have very good infrastructure to support that. (1) might break some real sites. I think we probably want to do (2) for now.
Once we implement budget lifetime propagation for self.postMessage() then we can maybe make updates use that mechanism as well.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1432846#c9)• 7 years ago |
|  | |

May not need to be hidden unless chrome also wants to treat it as sensitive. Privacy issue (unlike Push the user hasn't agreed to it) and avenue for resource abuse, but not an exploit.Keywords: [csectype-dos](/buglist.cgi?keywords=csectype-dos&resolution=---),
[privacy](/buglist.cgi?keywords=privacy&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1432846#a91771_1689)• 7 years ago |

Blocks: [eviltraps](/show_bug.cgi?id=432687 "NEW - [meta] Protect users from websites that trap them or destroy their experience")

|  | [Ben Kelly [:bkelly, not reviewing]](/user_profile?user_id=465500) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1432846#c10)• 7 years ago |
|  | |

Marion, we should probably work this in the FF60 time frame. We probably want to do one of our short term fixes (probable 2 from [comment 8](/show_bug.cgi?id=1432846#c8 "RESOLVED FIXED - Self-update service worker to stay alive")).Flags: needinfo?(mdaly)

|  | [Marion Daly [:mdaly]](/user_profile?user_id=609492) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1432846#a167595_609492)• 7 years ago |

Assignee: nobody → catalin.badea392
[status-firefox60](/buglist.cgi?f1=cf_status_firefox60&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=affected)Flags: needinfo?(mdaly)Priority: -- → P2

|  | [Marion Daly [:mdaly]](/user_profile?user_id=609492) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1432846#c11)• 7 years ago |
|  | |

Catalin, would you want to take a look at this for us?Flags: needinfo?(catalin.badea392)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1432846#a537966_1689)• 7 years ago |

Group: core-security → dom-core-security

|  | [Ben Kelly [:bkelly, not reviewing]](/user_profile?user_id=465500) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1432846#c12)• 7 years ago |
|  | |

Hey Catalin, I think I mispoke in our meeting about this bug the other day. I think I said something like we should store the current update delay on the WorkerPrivate so it resets when the SW thread is killed. I don't think that is correct.
Instead we should probably store the current update delay on ServiceWorkerInfo and the ServiceWorkerManager should call a method to reset it when the list of controlled clients goes from zero to one entry. Basically, if the user opened a window to this site, then clear the progressive delay mitigation.
Sorry for any confusion I might have introduced at the meeting.

|  | [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1432846#c13)• 7 years ago |
|  | |

Attached patch

[Delay update runnables from service workers that don't control any clients. r=bkelly](attachment.cgi?id=8951365&action=diff) (obsolete)
— [Details](attachment.cgi?id=8951365&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8951365)

|  | [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1432846#c14)• 7 years ago |
|  | |

Attached patch

[Add test for self updating service worker. r=bkelly](attachment.cgi?id=8951366&action=diff)
— [Details](attachment.cgi?id=8951366&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8951366)

|  | [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1432846#c15)• 7 years ago |
|  | |

Comment on [attachment 8951365](/attachment.cgi?id=8951365 "Delay update runnables from service workers that don't control any clients. r=bkelly") [[details]](/attachment.cgi?id=8951365&action=edit "Delay update runnables from service workers that don't control any clients. r=bkelly") [[diff]](/attachment.cgi?id=8951365&action=diff "Delay update runnables from service workers that don't control any clients. r=bkelly") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8951365)
Delay update runnables from service workers that don't control any clients. r=bkelly
With this patch, calling registration.update() while not controlling clients will incurr a 5s \* |multiplier| delay before the update is processed. The multiplier doubles for each request and resets when the worker starts controlling a document.Flags: needinfo?(catalin.badea392)
[Attachment #8951365](/attachment.cgi?id=8951365&action=edit "Delay update runnables from service workers that don't control any clients. r=bkelly") -
Flags: review?(bkelly)

|  | [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1432846#a1907792_488358)• 7 years ago |

[Attachment #8951366](/attachment.cgi?id=8951366&action=edit "Add test for self updating service worker. r=bkelly") -
Flags: review?(bkelly)

|  | [Ben Kelly [:bkelly, not reviewing]](/user_profile?user_id=465500) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1432846#c16)• 7 years ago |
|  | |

Comment on [attachment 8951365](/attachment.cgi?id=8951365 "Delay update runnables from service workers that don't control any clients. r=bkelly") [[details]](/attachment.cgi?id=8951365&action=edit "Delay update runnables from service workers that don't control any clients. r=bkelly") [[diff]](/attachment.cgi?id=8951365&action=diff "Delay update runnables from service workers that don't control any clients. r=bkelly") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8951365)
Delay update runnables from service workers that don't control any clients. r=bkelly
Review of [attachment 8951365](/attachment.cgi?id=8951365 "Delay update runnables from service workers that don't control any clients. r=bkelly") [[details]](/attachment.cgi?id=8951365&action=edit "Delay update runnables from service workers that don't control any clients. r=bkelly") [[diff]](/attachment.cgi?id=8951365&action=diff "Delay update runnables from service workers that don't control any clients. r=bkelly") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8951365):
-----------------------------------------------------------------
Please see the comments about not delaying update() calls that are initiated from other contexts then the SW's own thread.
Overall, I'm also a bit nervous about putting this in ServiceWorkerJobQueue. That code has been particularly sensitive to breakage in the past. The delayed job concept does not fit very well either as its unclear how a delayed job related to the queue concept. Finally, since this is a temporary mitigation, I'd like to avoid putting it too deep in the life cycle code.
What about making update() in the service worker setup an nsITimer that then calls UpdateInternal()? So the job isn't created until this timer executes. The timer would have to lookup the registration again in case it went away, etc.
::: dom/serviceworkers/ServiceWorkerJobQueue.cpp
@@ +117,5 @@
> +{
> + uint32\_t delay = Preferences::GetInt("dom.serviceWorkers.update\_delay",
> + 5000);
> + uint32\_t timeout = delay \* mDelayMultiplier;
> + mDelayMultiplier \*= 2;
We need to reset the delay multiplier to zero when the registration starts controlling a client. The easiest way to do this would be to put the mDelayedMultiplier on ServiceWorkerRegistrationInfo and reset it in StartControllingClient.
::: dom/serviceworkers/ServiceWorkerManager.cpp
@@ +327,5 @@
> +
> + auto jobQueueTrigger = MakeScopeExit([&] {
> + nsAutoCString scopeKey;
> + nsresult rv = PrincipalToScopeKey(aRegistrationInfo->Principal(), scopeKey);
> + Unused << rv;
nit: Don't declare rv and just do Unused << PrincipalToScopeKey() if that is the behavior you want.
@@ +2940,5 @@
>
> + if (registration->IsControllingClients()) {
> + queue->ScheduleJob(job);
> + } else {
> + queue->ScheduleDelayedJob(job);
I don't think we want to delay update() calls from the main window. We only want to delay self-update from the service worker.
Maybe you could add something to ServiceWorkerUpdateFinishCallback to tell if its a self-update. Then you could do something like:
if (aCallback->IsSelfUpdate() && !registration->IsControllingClients()) {
queue->ScheduleJob(job);
} else {
queue->ScheduledDelayedJob(job);
}
See my other comment on a possibly different way to do it without modifying ServiceWorkerJob.
[Attachment #8951365](/attachment.cgi?id=8951365&action=edit "Delay update runnables from service workers that don't control any clients. r=bkelly") -
Flags: review?(bkelly) → review-

|  | [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1432846#c17)• 7 years ago |
|  | |

(In reply to Ben Kelly [:bkelly] from [comment #16](/show_bug.cgi?id=1432846#c16 "RESOLVED FIXED - Self-update service worker to stay alive"))
> Comment on [attachment 8951365](/attachment.cgi?id=8951365 "Delay update runnables from service workers that don't control any clients. r=bkelly") [[details]](/attachment.cgi?id=8951365&action=edit "Delay update runnables from service workers that don't control any clients. r=bkelly") [[diff]](/attachment.cgi?id=8951365&action=diff "Delay update runnables from service workers that don't control any clients. r=bkelly") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8951365)
> Delay update runnables from service workers that don't control any clients.
> r=bkelly
>
> Review of [attachment 8951365](/attachment.cgi?id=8951365 "Delay update runnables from service workers that don't control any clients. r=bkelly") [[details]](/attachment.cgi?id=8951365&action=edit "Delay update runnables from service workers that don't control any clients. r=bkelly") [[diff]](/attachment.cgi?id=8951365&action=diff "Delay update runnables from service workers that don't control any clients. r=bkelly") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8951365):
> -----------------------------------------------------------------
>
> Please see the comments about not delaying update() calls that are initiated
> from other contexts then the SW's own thread.
That's definitely a bug, yes.
>
> Overall, I'm also a bit nervous about putting this in ServiceWorkerJobQueue.
> That code has been particularly sensitive to breakage in the past. The
> delayed job concept does not fit very well either as its unclear how a
> delayed job related to the queue concept. Finally, since this is a
> temporary mitigation, I'd like to avoid putting it too deep in the life
> cycle code.
>
> What about making update() in the service worker setup an nsITimer that then
> calls UpdateInternal()? So the job isn't created until this timer executes.
> The timer would have to lookup the registration again in case it went away,
> etc.
I think no matter how we approach this, something on the main thread needs to
own the pending update runnables/jobs until their timer fires. This allows
us to do proper cleanup at shutdown or when a registration is removed.
My initial choice with ServiceWorkerJobQueue was because it kept things sort
of contained. After talking to baku, I think ServiceWorkerPrivate should own it:
If the SW is terminated and there's a pending update job on the main thread
holding a promise proxy, the shutdown procedure won't complete until
that promsie proxy is released. We might end up keeping dangling terminating
workers for a long time.
>
> ::: dom/serviceworkers/ServiceWorkerJobQueue.cpp
> @@ +117,5 @@
> > +{
> > + uint32\_t delay = Preferences::GetInt("dom.serviceWorkers.update\_delay",
> > + 5000);
> > + uint32\_t timeout = delay \* mDelayMultiplier;
> > + mDelayMultiplier \*= 2;
>
> We need to reset the delay multiplier to zero when the registration starts
> controlling a client. The easiest way to do this would be to put the
> mDelayedMultiplier on ServiceWorkerRegistrationInfo and reset it in
> StartControllingClient.
>
> ::: dom/serviceworkers/ServiceWorkerManager.cpp
> @@ +327,5 @@
> > +
> > + auto jobQueueTrigger = MakeScopeExit([&] {
> > + nsAutoCString scopeKey;
> > + nsresult rv = PrincipalToScopeKey(aRegistrationInfo->Principal(), scopeKey);
> > + Unused << rv;
>
> nit: Don't declare rv and just do Unused << PrincipalToScopeKey() if that is
> the behavior you want.
>
> @@ +2940,5 @@
> >
> > + if (registration->IsControllingClients()) {
> > + queue->ScheduleJob(job);
> > + } else {
> > + queue->ScheduleDelayedJob(job);
>
> I don't think we want to delay update() calls from the main window. We only
> want to delay self-update from the service worker.
>
> Maybe you could add something to ServiceWorkerUpdateFinishCallback to tell
> if its a self-update. Then you could do something like:
>
> if (aCallback->IsSelfUpdate() && !registration->IsControllingClients()) {
> queue->ScheduleJob(job);
> } else {
> queue->ScheduledDelayedJob(job);
> }
>
> See my other comment on a possibly different way to do it without modifying
> ServiceWorkerJob.

|  | [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1432846#c18)• 7 years ago |
|  | |

Attached patch

[Delay update runnables from service workers that don't control any clients.](attachment.cgi?id=8952339&action=diff) (obsolete)
— [Details](attachment.cgi?id=8952339&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8952339)

[Attachment #8952339](/attachment.cgi?id=8952339&action=edit "Delay update runnables from service workers that don't control any clients.") -
Flags: review?(bkelly)

|  | [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1432846#a2316166_488358)• 7 years ago |

[Attachment #8951365](/attachment.cgi?id=8951365&action=edit "Delay update runnables from service workers that don't control any clients. r=bkelly") -
Attachment is obsolete: true

|  | [Ben Kelly [:bkelly, not reviewing]](/user_profile?user_id=465500) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1432846#c19)• 7 years ago |
|  | |

Comment on [attachment 8952339](/attachment.cgi?id=8952339 "Delay update runnables from service workers that don't control any clients.") [[details]](/attachment.cgi?id=8952339&action=edit "Delay update runnables from service workers that don't control any clients.") [[diff]](/attachment.cgi?id=8952339&action=diff "Delay update runnables from service workers that don't control any clients.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8952339)
Delay update runnables from service workers that don't control any clients.
Review of [attachment 8952339](/attachment.cgi?id=8952339 "Delay update runnables from service workers that don't control any clients.") [[details]](/attachment.cgi?id=8952339&action=edit "Delay update runnables from service workers that don't control any clients.") [[diff]](/attachment.cgi?id=8952339&action=diff "Delay update runnables from service workers that don't control any clients.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8952339):
-----------------------------------------------------------------
Looking better, but I think there are still some things to sort through. Let me know if the comments below make sense. Thanks!
::: dom/serviceworkers/ServiceWorkerInfo.cpp
@@ +324,5 @@
> mCreationTimeStamp).ToMicroseconds());
> }
>
> +void
> +ServiceWorkerInfo::ResetUpdateDelay()
ResetUpdateDelay() doesn't seem to be called anywhere.
@@ +330,5 @@
> + mDelayMultiplier = 0;
> +}
> +
> +uint32\_t
> +ServiceWorkerInfo::GetUpdateDelay(bool aIsControllingClients)
I think the delay probably needs to be stored on ServiceWorkerRegistrationInfo instead of the ServiceWorkerInfo. In a chained update scenario we will have multiple ServiceWorkerInfo objects cycling through. We don't want to lose the delay the install of each new worker.
::: dom/serviceworkers/ServiceWorkerManager.h
@@ +316,5 @@
> + // This method generates a key using appId and isInElementBrowser from the
> + // principal. We don't use the origin because it can change during the
> + // loading.
> + static nsresult
> + PrincipalToScopeKey(nsIPrincipal\* aPrincipal, nsACString& aKey);
I don't think you need to make this public.
::: dom/serviceworkers/ServiceWorkerRegistrationImpl.cpp
@@ +321,5 @@
> + return NS\_OK;
> + }
> +
> + nsAutoCString scopeKey;
> + nsresult rv = ServiceWorkerManager::PrincipalToScopeKey(principal, scopeKey);
It seems like scopeKey is not used here and can be removed.
@@ +333,5 @@
> + return NS\_OK;
> + }
> +
> + uint64\_t id = mPromiseProxy->GetWorkerPrivate()->ServiceWorkerID();
> + RefPtr<ServiceWorkerInfo> worker = registration->GetServiceWorkerInfoById(id);
If we store the delay on the registration this bit can go away.
@@ +341,5 @@
> + // if we have a timer object, it means we've already been delayed once.
> + if (delay && !mTimer) {
> + auto cb = [] (nsITimer\* aTimer, void\* aClosure) {
> + MOZ\_ASSERT(aClosure);
> + static\_cast<SWRUpdateRunnable\*>(aClosure)->Run();
This is unsafe. The closure is not ref-counted by the timer. It is held alive by the ServiceWorkerPrivate::StoreISupports(), but that reference is cleared in TerminateWorker(). If TerminateWorker() is called before the timer fires then this will hit a UAF.
Rather than using StoreISupports(), I think it might be better to just add an explicit timer list:
nsTArray<nsCOMPtr<nsITimer>> mTimerList;
The timer can hold a strong ref to the runnable like:
RefPtr<ServiceWorkerPrivate> swp = worker->WorkerPrivate();
nsCOMPtr<nsIRunnable> self = this;
auto cb = [self = Move(self), swp = Move(swp)] (nsITimer\* aTimer, void\* aClosure) {
swp->ClearTimer(aTimer);
self->Run()
}
The ServiceWorkerPrivate can then also cancel the timers in NoteDeadServiceWorkerInfo(), etc. This would be necessary to break the ref-cycle from timer->SWP->timer in a timely manner when we are shutting down.
Or maybe make the SWP hold a list of the update runnables themselves and give it an explicit cancel method, etc. Not sure which would be cleaner.
@@ +348,5 @@
> +
> + Result<nsCOMPtr<nsITimer>, nsresult> result =
> + NS\_NewTimerWithFuncCallback(cb, this, delay, nsITimer::TYPE\_ONE\_SHOT,
> + "dom::SWRUpdateRunnable::TimerRunnable",
> + GetCurrentThreadEventTarget());
Instead of GetCurrentThreadEventTarget(), please use SystemGroup::GetEventTarget(TaskCategory::Other).
@@ +350,5 @@
> + NS\_NewTimerWithFuncCallback(cb, this, delay, nsITimer::TYPE\_ONE\_SHOT,
> + "dom::SWRUpdateRunnable::TimerRunnable",
> + GetCurrentThreadEventTarget());
> + mTimer = result.unwrapOr(nullptr);
> + MOZ\_ASSERT(mTimer);
Can we make this a runtime check and only save our state on SWP if we pass it?
[Attachment #8952339](/attachment.cgi?id=8952339&action=edit "Delay update runnables from service workers that don't control any clients.") -
Flags: review?(bkelly) → review-

|  | [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1432846#c20)• 7 years ago |
|  | |

The timer should be cancelled on release, so we shouldn't hit a UAF. Unless I'm wrong?
<https://searchfox.org/mozilla-central/source/xpcom/threads/nsTimerImpl.cpp#326>

|  | [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1432846#c21)• 7 years ago |
|  | |

Attached patch

[Delay update runnables from service workers that don't control any clients.](attachment.cgi?id=8952746&action=diff) (obsolete)
— [Details](attachment.cgi?id=8952746&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8952746)

SWRUpdateRunnable now explicitly calls Cancel in its destructor. Addressed other
comments.

|  | [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1432846#a2414699_488358)• 7 years ago |

[Attachment #8952339](/attachment.cgi?id=8952339&action=edit "Delay update runnables from service workers that don't control any clients.") -
Attachment is obsolete: true

|  | [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1432846#c22)• 7 years ago |
|  | |

Attached patch

[Delay update runnables from service workers that don't control any clients.](attachment.cgi?id=8952748&action=diff) (obsolete)
— [Details](attachment.cgi?id=8952748&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8952748)

nit fixes.
[Attachment #8952748](/attachment.cgi?id=8952748&action=edit "Delay update runnables from service workers that don't control any clients.") -
Flags: review?(bkelly)

|  | [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1432846#a2414898_488358)• 7 years ago |

[Attachment #8952746](/attachment.cgi?id=8952746&action=edit "Delay update runnables from service workers that don't control any clients.") -
Attachment is obsolete: true

|  | [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1432846#c23)• 7 years ago |
|  | |

Attached patch

[Delay update runnables from service workers that don't control any clients.](attachment.cgi?id=8952749&action=diff) (obsolete)
— [Details](attachment.cgi?id=8952749&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8952749)

[Attachment #8952749](/attachment.cgi?id=8952749&action=edit "Delay update runnables from service workers that don't control any clients.") -
Flags: review?(bkelly)

|  | [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1432846#a2415431_488358)• 7 years ago |

[Attachment #8952748](/attachment.cgi?id=8952748&action=edit "Delay update runnables from service workers that don't control any clients.") -
Attachment is obsolete: true
[Attachment #8952748](/attachment.cgi?id=8952748&action=edit "Delay update runnables from service workers that don't control any clients.") -
Flags: review?(bkelly)

|  | [Yannic Bonenberger](/user_profile?user_id=610581)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1432846#c24)• 7 years ago |
|  | |

Comment on [attachment 8952749](/attachment.cgi?id=8952749 "Delay update runnables from service workers that don't control any clients.") [[details]](/attachment.cgi?id=8952749&action=edit "Delay update runnables from service workers that don't control any clients.") [[diff]](/attachment.cgi?id=8952749&action=diff "Delay update runnables from service workers that don't control any clients.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8952749)
Delay update runnables from service workers that don't control any clients.
Review of [attachment 8952749](/attachment.cgi?id=8952749 "Delay update runnables from service workers that don't control any clients.") [[details]](/attachment.cgi?id=8952749&action=edit "Delay update runnables from service workers that don't control any clients.") [[diff]](/attachment.cgi?id=8952749&action=diff "Delay update runnables from service workers that don't control any clients.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8952749):
-----------------------------------------------------------------
Just took a quick look at some of your changes.
Let me know if the comments below make sense. Thanks!
::: dom/serviceworkers/ServiceWorkerRegistrationImpl.cpp
@@ +350,5 @@
> + worker->WorkerPrivate()->StoreISupports(static\_cast<nsIRunnable\*>(this));
> + return NS\_OK;
> + }
> +
> + if (mTimer) {
That logic looks wrong to me.
If update() is delayed for the first time, |mTimer| will be nullptr and the update will be delayed because the condition in line 336 is true. If a worker immediately calls update() again without waiting for the promise to settle, that condition won't be true because we have a timer now.
If we have a timer, this condition here will be true, the timer will be deleted and the update is executed without delay. This means workers would just need to call update two times in a row to keep themselves alive.
::: dom/serviceworkers/ServiceWorkerRegistrationInfo.cpp
@@ +719,5 @@
> +uint32\_t
> +ServiceWorkerRegistrationInfo::GetUpdateDelay()
> +{
> + if (!mControlledClientsCounter) {
> + ++mDelayMultiplier;
I think you might want to do this after calculating the current delay to not delay the first update.
@@ +730,5 @@
> + if (mDelayMultiplier >= INT\_MAX / (delay ? delay : 1)) {
> + return INT\_MAX;
> + }
> +
> + delay \*= mDelayMultiplier;
Wouldn't it be better to store the delay and double it every time this method is called?
This way the backoff would be exponential instead of linear.
Matt Falkenhagen pointed out in the Chromium review that workers get a lot of time on every update() (It's 5 min install + 5 min activate in Chromium, not sure about the exact times in Firefox, but I expect them to be similar).
Calling update() n times will result in n\*10 minutes runtime, and if the delay is increased only 5 seconds every time update() is called, that will result a lot of runtime.

|  | [Ben Kelly [:bkelly, not reviewing]](/user_profile?user_id=465500) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1432846#c25)• 7 years ago |
|  | |

(In reply to Yannic Bonenberger from [comment #24](/show_bug.cgi?id=1432846#c24 "RESOLVED FIXED - Self-update service worker to stay alive"))
> ::: dom/serviceworkers/ServiceWorkerRegistrationImpl.cpp
> @@ +350,5 @@
> > + worker->WorkerPrivate()->StoreISupports(static\_cast<nsIRunnable\*>(this));
> > + return NS\_OK;
> > + }
> > +
> > + if (mTimer) {
>
> That logic looks wrong to me.
> If update() is delayed for the first time, |mTimer| will be nullptr and the
> update will be delayed because the condition in line 336 is true. If a
> worker immediately calls update() again without waiting for the promise to
> settle, that condition won't be true because we have a timer now.
> If we have a timer, this condition here will be true, the timer will be
> deleted and the update is executed without delay. This means workers would
> just need to call update two times in a row to keep themselves alive.
I don't think this works like you are interpreting it. The mTimer member is on on the SWRUpdateRunnable and you get a new runnable every time script calls update(). So each update() call gets its own mTimer member. Stacked update() calls should not interfere with each other.

|  | [Yannic Bonenberger](/user_profile?user_id=610581)  Reporter |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1432846#c26)• 7 years ago |
|  | |

You're right, I interpreted this to be one mTimer member on ServiceWorkerRegistrationImpl. If every call gets its own timer, than this works as it's supposed to.
(In reply to Ben Kelly [:bkelly] from [comment #25](/show_bug.cgi?id=1432846#c25 "RESOLVED FIXED - Self-update service worker to stay alive"))
> (In reply to Yannic Bonenberger from [comment #24](/show_bug.cgi?id=1432846#c24 "RESOLVED FIXED - Self-update service worker to stay alive"))
> > ::: dom/serviceworkers/ServiceWorkerRegistrationImpl.cpp
> > @@ +350,5 @@
> > > + worker->WorkerPrivate()->StoreISupports(static\_cast<nsIRunnable\*>(this));
> > > + return NS\_OK;
> > > + }
> > > +
> > > + if (mTimer) {
> >
> > That logic looks wrong to me.
> > If update() is delayed for the first time, |mTimer| will be nullptr and the
> > update will be delayed because the condition in line 336 is true. If a
> > worker immediately calls update() again without waiting for the promise to
> > settle, that condition won't be true because we have a timer now.
> > If we have a timer, this condition here will be true, the timer will be
> > deleted and the update is executed without delay. This means workers would
> > just need to call update two times in a row to keep themselves alive.
>
> I don't think this works like you are interpreting it. The mTimer member is
> on on the SWRUpdateRunnable and you get a new runnable every time script
> calls update(). So each update() call gets its own mTimer member. Stacked
> update() calls should not interfere with each other.

|  | [Ben Kelly [:bkelly, not reviewing]](/user_profile?user_id=465500) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1432846#c27)• 7 years ago |
|  | |

Comment on [attachment 8952749](/attachment.cgi?id=8952749 "Delay update runnables from service workers that don't control any clients.") [[details]](/attachment.cgi?id=8952749&action=edit "Delay update runnables from service workers that don't control any clients.") [[diff]](/attachment.cgi?id=8952749&action=diff "Delay update runnables from service workers that don't control any clients.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8952749)
Delay update runnables from service workers that don't control any clients.
Review of [attachment 8952749](/attachment.cgi?id=8952749 "Delay update runnables from service workers that don't control any clients.") [[details]](/attachment.cgi?id=8952749&action=edit "Delay update runnables from service workers that don't control any clients.") [[diff]](/attachment.cgi?id=8952749&action=diff "Delay update runnables from service workers that don't control any clients.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8952749):
-----------------------------------------------------------------
Still looking better, but I'm sorry I can't get over the raw void \* pointer passed in the closure. I've just had to fix too many of those in the past, even if its nsTimer code handles it better today. I would really prefer a strong ref.
::: dom/serviceworkers/ServiceWorkerManager.cpp
@@ +324,5 @@
>
> const ServiceWorkerDescriptor& active =
> aRegistrationInfo->GetActive()->Descriptor();
>
> + aRegistrationInfo->ResetUpdateDelay();
I think it would be cleaner to make ResetUpdateDelay() private and call it from ServiceWorkerRegistrationInfo::StartControllingClient().
<https://searchfox.org/mozilla-central/rev/9a8d3f8191b15cdca89a7ce044c7bea2dd0462dc/dom/serviceworkers/ServiceWorkerRegistrationInfo.h#94>
Or just set mUpdateMultiplier to zero directly there.
::: dom/serviceworkers/ServiceWorkerRegistrationImpl.cpp
@@ +286,5 @@
> SWRUpdateRunnable(PromiseWorkerProxy\* aPromiseProxy, const nsAString& aScope)
> : Runnable("dom::SWRUpdateRunnable")
> , mPromiseProxy(aPromiseProxy)
> , mScope(aScope)
> + , mTimer(nullptr)
nit: You don't need to explicitly initialize nsCOMPtr<> with nullptr.
@@ +313,5 @@
> return NS\_OK;
> }
>
> principal = mPromiseProxy->GetWorkerPrivate()->GetPrincipal();
> + id = mPromiseProxy->GetWorkerPrivate()->ServiceWorkerID();
Rather than use the ServiceWorkerID(), please use ServiceWorkerDescriptor. We currently have some problems with matching only on ID in multi-e10s. The descriptor provides more of a safe match.
I think it would be a bit preferable to capture this on the worker thread in the constructor.
@@ +328,5 @@
> + if (NS\_WARN\_IF(!registration)) {
> + return NS\_OK;
> + }
> +
> + RefPtr<ServiceWorkerInfo> worker = registration->GetServiceWorkerInfoById(id);
Please use ServiceWorkerRegistrationInfo::GetByDescriptor() here.
Also, please add a comment that a lot of this is very specific to our partial implementation. It currently does not handle:
1. ServiceWorkerRegistration.update() called from other worker types. It assumes its only ever called from a ServiceWorker global.
2. It assumes the registration corresponds to self.registration on the service worker global. It doesn't handle a registration for a different scope from the current service worker.
These work today because the only worker context ServiceWorkerRegistration we expose is self.registration. When we expose ServiceWorkerContainer and ServiceWorker on worker contexts fully this code will have to handle those other situations.
@@ +335,5 @@
> + // if we have a timer object, it means we've already been delayed once.
> + if (delay && !mTimer) {
> + auto cb = [] (nsITimer\* aTimer, void\* aClosure) {
> + MOZ\_ASSERT(aClosure);
> + static\_cast<SWRUpdateRunnable\*>(aClosure)->Run();
I'm sorry, but I still think using an un-ref'd closure is a huge risk. I've spent too much time removing this kind of usage from SWM to add another one. I've even talked with Nathan about removing it from the nsITimer API because its a footgun.
I feel like we should be able to avoid it in this case without too much effort.
For example:
1. Remove the mTimer member on SWRUpdateRunnable and replace it with a mDelayed boolean.
2. Store the nsITimer in the ServiceWorkerPrivate::StoreISupports();
3. Have the lambda capture a strong ref to the runnable instead of passing it through as a void\* closure.
This will rely on the auto-cancel on last ref, but I think I prefer that over use a raw pointer for closure here. And if we wanted to we could even add an explicit cancel by making TerminateWorker QI to nsITimer and call Cancel(), etc.
@@ +346,5 @@
> + if (NS\_WARN\_IF(!mTimer)) {
> + return NS\_OK;
> + }
> +
> + worker->WorkerPrivate()->StoreISupports(static\_cast<nsIRunnable\*>(this));
Please change the MOZ\_ASSERT(mWorkerPrivate) in StoreISupports() to a MOZ\_DIAGNOSTIC\_ASSERT(). I want to make sure future changes don't accidentally call StoreISupports on a ServiceWorkerPrivate that does not have a running worker. Again, its not possible with our self.registration partial implementation, but it would be easy to accidentally do in the future.
Also, please add a comment indicating we are storing the runnable on the calling workers private and we expect the reference to be dropped when that SWP terminates.
::: dom/serviceworkers/ServiceWorkerRegistrationInfo.cpp
@@ +730,5 @@
> + if (mDelayMultiplier >= INT\_MAX / (delay ? delay : 1)) {
> + return INT\_MAX;
> + }
> +
> + delay \*= mDelayMultiplier;
I do agree we're probably not aggressive enough with the delay. I think we should aim for an exponential delay progression like:
0
30 seconds
900 seconds
This would give a malicious script about 30 minutes of processing time.
[Attachment #8952749](/attachment.cgi?id=8952749&action=edit "Delay update runnables from service workers that don't control any clients.") -
Flags: review?(bkelly) → review-

|  | [Ben Kelly [:bkelly, not reviewing]](/user_profile?user_id=465500) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1432846#c28)• 7 years ago |
|  | |

Comment on [attachment 8951366](/attachment.cgi?id=8951366 "Add test for self updating service worker. r=bkelly") [[details]](/attachment.cgi?id=8951366&action=edit "Add test for self updating service worker. r=bkelly") [[diff]](/attachment.cgi?id=8951366&action=diff "Add test for self updating service worker. r=bkelly") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8951366)
Add test for self updating service worker. r=bkelly
Review of [attachment 8951366](/attachment.cgi?id=8951366 "Add test for self updating service worker. r=bkelly") [[details]](/attachment.cgi?id=8951366&action=edit "Add test for self updating service worker. r=bkelly") [[diff]](/attachment.cgi?id=8951366&action=diff "Add test for self updating service worker. r=bkelly") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8951366):
-----------------------------------------------------------------
Thanks! r=me with comments addressed.
::: dom/serviceworkers/test/self\_update\_worker.sjs
@@ +9,5 @@
> + for (i = 0; i < clients.length; i++) {
> + clients[i].postMessage({version: version});
> + }
> + }).then(function() {
> + self.registration.update();
Do we want waitUntil() to block on the update() promise? Its not being returned at the moment.
@@ +11,5 @@
> + }
> + }).then(function() {
> + self.registration.update();
> + });
> + event.waitUntil(promise);
nit: We can use async functions to make this a bit easier to read:
event.waitUntil(async function() {
let clients = await clients.matchAll({ includeUncontrolled: true });
await self.registration.update();
}());
@@ +16,5 @@
> +};
> +`;
> +
> +function handleRequest(request, response) {
> + let count = getState("count");
Nice. I didn't know about getState() and setState() in .py scripts here.
::: dom/serviceworkers/test/test\_self\_update\_worker.html
@@ +35,5 @@
> + }
> +
> + await SpecialPowers.pushPrefEnv({"set": [
> + ["dom.serviceWorkers.idle\_timeout", 299999],
> + ["dom.serviceWorkers.idle\_timeout", 0],
This sets idle\_timeout twice?
@@ +47,5 @@
> + return waitForState(worker, 'activated', registration);
> + });
> +
> + // We need to wait a reasonable time to give the self updating worker a chance
> + // to change to a newer version. Register and activate an empty worker two times.
I think maybe we should go through more iterations of the dummy scope registration/activation/uninstall. You do two here, but we also only check that two of the test script are activated as well. It seems like its possible for those to end up matching simply by chance. Can we do something like 10 iterations of the dummy stuff instead?
@@ +52,5 @@
> + await navigator.serviceWorker.register("empty.js", { scope: "./empty/"})
> + .then(function(registration) {
> + worker = registration.installing;
> + return waitForState(worker, 'activated', registration).then(function() {
> + registration.unregister();
Please wait for the unregister() promise to settle.
@@ +56,5 @@
> + registration.unregister();
> + });
> + });
> +
> + await navigator.serviceWorker.register("empty.js", { scope: "./empty/"})
Maybe use a cache busting scope here, like `"./empty?q=" + Date.now()`.
@@ +62,5 @@
> + worker = registration.installing;
> + return waitForState(worker, 'activated', registration).then(function() {
> + registration.unregister();
> + });
> + });
nit: Can you refactor this into a "waitForDummyScope" or something?
@@ +67,5 @@
> +
> +
> + await registration.unregister();
> + await SpecialPowers.popPrefEnv();
> + await SpecialPowers.popPrefEnv();
I don't think you should have to explicitly popPrefEnv(). The test harness does it automatically at the end.
[Attachment #8951366](/attachment.cgi?id=8951366&action=edit "Add test for self updating service worker. r=bkelly") -
Flags: review?(bkelly) → review+

|  | [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1432846#c29)• 7 years ago |
|  | |

Attached patch

[Delay update runnables from service workers that don't control any clients.](attachment.cgi?id=8954360&action=diff)
— [Details](attachment.cgi?id=8954360&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8954360)

Delay now is 1s \* [0, 30, 900, ..]. SWP now holds the timer object instead of the runnable.
Addressed other comments too.
[Attachment #8954360](/attachment.cgi?id=8954360&action=edit "Delay update runnables from service workers that don't control any clients.") -
Flags: review?(bkelly)

|  | [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1432846#a2926428_488358)• 7 years ago |

[Attachment #8952749](/attachment.cgi?id=8952749&action=edit "Delay update runnables from service workers that don't control any clients.") -
Attachment is obsolete: true

|  | [Ben Kelly [:bkelly, not reviewing]](/user_profile?user_id=465500) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1432846#c30)• 7 years ago |
|  | |

Comment on [attachment 8954360](/attachment.cgi?id=8954360 "Delay update runnables from service workers that don't control any clients.") [[details]](/attachment.cgi?id=8954360&action=edit "Delay update runnables from service workers that don't control any clients.") [[diff]](/attachment.cgi?id=8954360&action=diff "Delay update runnables from service workers that don't control any clients.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8954360)
Delay update runnables from service workers that don't control any clients.
Review of [attachment 8954360](/attachment.cgi?id=8954360 "Delay update runnables from service workers that don't control any clients.") [[details]](/attachment.cgi?id=8954360&action=edit "Delay update runnables from service workers that don't control any clients.") [[diff]](/attachment.cgi?id=8954360&action=diff "Delay update runnables from service workers that don't control any clients.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1432846&attachment=8954360):
-----------------------------------------------------------------
Thanks!
::: dom/serviceworkers/ServiceWorkerRegistrationInfo.h
@@ +213,5 @@
> const ServiceWorkerRegistrationDescriptor&
> Descriptor() const;
>
> + void
> + ResetUpdateDelay();
I think we can remove this declaration now.
[Attachment #8954360](/attachment.cgi?id=8954360&action=edit "Delay update runnables from service workers that don't control any clients.") -
Flags: review?(bkelly) → review+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1432846#c31)• 7 years ago |
|  | |

Landed:
<https://hg.mozilla.org/integration/mozilla-inbound/rev/a92cc56bbaa4c96f79cc3af122a1307f00ddccb9>
<https://hg.mozilla.org/integration/mozilla-inbound/rev/a2ae02b5fe728e545a0b302e30ec63615f0b052c>
Follow-up:
<https://hg.mozilla.org/integration/mozilla-inbound/rev/5e3b28d03b34269c9153eba45ad6892512e398ee>
Backout for build bustage on Windows at dom/serviceworkers/ServiceWorkerRegistrationImpl.cpp:301:
<https://hg.mozilla.org/integration/mozilla-inbound/rev/8474740da082541ef65f90d0f54091ca15fd2e2c>
Follow-up push with failures: <https://treeherder.mozilla.org/#/jobs?repo=mozilla-inbound&revision=5e3b28d03b34269c9153eba45ad6892512e398ee&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception&filter-resultStatus=retry&filter-resultStatus=usercancel&filter-resultStatus=runnable>
Failure log: <https://treeherder.mozilla.org/logviewer.html#?job_id=165249817&repo=mozilla-inbound>
z:/build/build/src/dom/serviceworkers/ServiceWorkerRegistrationImpl.cpp(301): error C2695: 'mozilla::dom::`anonymous-namespace'::SWRUpdateRunnable::TimerCallback::Notify': overriding virtual function differs from 'nsITimerCallback::Notify' only by calling conventionFlags: needinfo?(catalin.badea392)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1432846#c32)• 7 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/8b2b977347eb5e1579759925af366ed8bb337a04>
<https://hg.mozilla.org/integration/mozilla-inbound/rev/d994e314879426eaae8871e949d656241a8871f1>
<https://hg.mozilla.org/mozilla-central/rev/d994e3148794>
<https://hg.mozilla.org/mozilla-central/rev/8b2b977347eb>Status: UNCONFIRMED → RESOLVEDClosed: 7 years ago
[status-firefox60](/buglist.cgi?f1=cf_status_firefox60&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla60

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1432846#a3219802_75935)• 7 years ago |

[status-firefox58](/buglist.cgi?f1=cf_status_firefox58&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox58&o1=equals&v1=wontfix)
[status-firefox59](/buglist.cgi?f1=cf_status_firefox59&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox59&o1=equals&v1=wontfix)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
--- → [disabled](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=disabled)

|  | [Cătălin Badea (:catalinb)](/user_profile?user_id=488358)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1432846#a3222051_488358)• 7 years ago |

Flags: needinfo?(catalin.badea392)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1432846#a4112129_1689)• 7 years ago |

Group: dom-core-security → core-security-release

|  | [[:philipp]](/user_profile?user_id=209011) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1432846#a4165073_209011)• 7 years ago |

Depends on: [1445475](/show_bug.cgi?id=1445475 "RESOLVED FIXED - Crash in mozilla::dom::ServiceWorkerPrivate::StoreISupports")

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1432846#a7971198_280903)• 7 years ago |

Whiteboard: [adv-main60+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1432846#a8328238_280903)• 7 years ago |

Alias: CVE-2018-5179

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1432846#c33)• 7 years ago |
|  | |

Yannic: I can't find a chrome bug on this which may mean it's still hidden (I searched for bugs filed by you, which might also be the problem if you use a different name there). Please add a link to the chrome bug in a comment here so we can check when they've gone public with it.Flags: needinfo?(contact)Whiteboard: [adv-main60+] → [Embargo until Chrome?][adv-main60+]

|  | [Emil Ghitta, QA [:emilghitta]](/user_profile?user_id=588744) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1432846#c34)• 7 years ago |
|  | |

Hi Catalin!
Would this fix benefit from manual testing?
If so, could you provide us some clear steps to reproduce this issue? I tried running the proof of concept from [comment 0](/show_bug.cgi?id=1432846#c0 "RESOLVED FIXED - Self-update service worker to stay alive") but I can't manage to verify if this issue was fixed or not.
Thanks!Flags: needinfo?(catalin.badea392)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1432846#c35)• 7 years ago |
|  | |

Responding for :catalinb who has moved on from MoCo. The "Add test for self updating service worker." patch included an automated test which should provide the necessary test coverage. :bkelly performed the initial review of the automated test and I also inspected the test when reviewing a follow-up patch, so I think we have sufficient confidence in the test. So there shouldn't be a need for additional manual testing.Flags: needinfo?(catalin.badea392)

|  | [Emil Ghitta, QA [:emilghitta]](/user_profile?user_id=588744) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1432846#c36)• 7 years ago |
|  | |

Awesome.
Thanks Andrew!Flags: qe-verify-

|  | [Yannic Bonenberger](/user_profile?user_id=610581)  Reporter |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1432846#c37)• 7 years ago |
|  | |

Daniel: Sorry that I didn't reply earlier. The Chromium bug is <http://crbug.com/805496>Flags: needinfo?(contact)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1432846#a24642837_1689)• 6 years ago |

Group: core-security-releaseSee Also: → <https://bugs.chromium.org/p/chromium/issues/detail?id=805496>
You need to [log in](/show_bug.cgi?id=1432846&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Yannic Bonenberger](/user_profile?user_id=610581)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from usn.ubuntu.com_914abf6f_20250125_161134.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3645-1: Firefox vulnerabilities

11 May 2018

Firefox could be made to crash or run programs as your login if it
opened a malicious website.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 18.04 ESM](/security/notices?release=bionic)
* [Ubuntu 17.10](/security/notices?release=artful)
* [Ubuntu 16.04 ESM](/security/notices?release=xenial)
* [Ubuntu 14.04 ESM](/security/notices?release=trusty)

## Packages

* [firefox](/security/cves?package=firefox) - Mozilla Open Source web browser

## Details

Multiple security issues were discovered in Firefox. If a user were

tricked in to opening a specially crafted website, an attacker could

potentially exploit these to cause a denial of service via application

crash, bypass same-origin restrictions, conduct cross-site scripting (XSS)

attacks, install lightweight themes without user interaction, spoof the

filename in the downloads panel, or execute arbitrary code.

([CVE-2018-5150](/security/CVE-2018-5150), [CVE-2018-5151](/security/CVE-2018-5151), [CVE-2018-5153](/security/CVE-2018-5153), [CVE-2018-5154](/security/CVE-2018-5154),

[CVE-2018-5155](/security/CVE-2018-5155), [CVE-2018-5157](/security/CVE-2018-5157), [CVE-2018-5158](/security/CVE-2018-5158), [CVE-2018-5159](/security/CVE-2018-5159), [CVE-2018-5160](/security/CVE-2018-5160),

[CVE-2018-5163](/security/CVE-2018-5163), [CVE-2018-5164](/security/CVE-2018-5164), [CVE-2018-5168](/security/CVE-2018-5168), [CVE-2018-5173](/security/CVE-2018-5173), [CVE-2018-5175](/security/CVE-2018-5175),

[CVE-2018-5177](/security/CVE-2018-5177), [CVE-2018-5180](/security/CVE-2018-5180))

Multiple security issues were discovered with WebExtensions. If a user

were tricked in to installing a specially crafted extension, an attacker

could potentially exploit these to obtain sensitive information, or bypass

security restrictions. ([CVE-2018-5152](/security/CVE-2018-5152), [CVE-2018-5166](/security/CVE-2018-5166))

It was discovered that the web console and JavaScript debugger incorrectly

linkified chrome: and javascript URLs. If a user were tricked in to

clicking a specially crafted link, an attacker could potentially exploit

this to conduct cross-site scripting (XSS) attacks. ([CVE-2018-5167](/security/CVE-2018-5167))

It was discovered that dragging and dropping link text on to the home

button could set the home page to include chrome pages. If a user were

tricked in to dragging and dropping a specially crafted link on to the

home button, an attacker could potentially exploit this bypass security

restrictions. ([CVE-2018-5169](/security/CVE-2018-5169))

It was discovered that the Live Bookmarks page and PDF viewer would run

script pasted from the clipboard. If a user were tricked in to copying and

pasting specially crafted text, an attacker could potentially exploit this

to conduct cross-site scripting (XSS) attacks. ([CVE-2018-5172](/security/CVE-2018-5172))

It was discovered that the JSON viewer incorrectly linkified javascript:

URLs. If a user were tricked in to clicking on a specially crafted link,

an attacker could potentially exploit this to obtain sensitive

information. ([CVE-2018-5176](/security/CVE-2018-5176))

It was discovered that dragging a file: URL on to a tab that is running in

a different process would cause the file to open in that process. If a

user were tricked in to dragging a file: URL, an attacker could

potentially exploit this to bypass intended security policies.

([CVE-2018-5181](/security/CVE-2018-5181))

It was discovered that dragging text that is a file: URL on to the

addressbar would open the specified file. If a user were tricked in to

dragging specially crafted text on to the addressbar, an attacker could

potentially exploit this to bypass intended security policies.

([CVE-2018-5182](/security/CVE-2018-5182))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 18.04

* [firefox](https://launchpad.net/ubuntu/%2Bsource/firefox)
  -
  [60.0+build2-0ubuntu1](https://launchpad.net/ubuntu/%2Bsource/firefox/60.0%2Bbuild2-0ubuntu1)

##### Ubuntu 17.10

* [firefox](https://launchpad.net/ubuntu/%2Bsource/firefox)
  -
  [60.0+build2-0ubuntu0.17.10.1](https://launchpad.net/ubuntu/%2Bsource/firefox/60.0%2Bbuild2-0ubuntu0.17.10.1)

##### Ubuntu 16.04

* [firefox](https://launchpad.net/ubuntu/%2Bsource/firefox)
  -
  [60.0+build2-0ubuntu0.16.04.1](https://launchpad.net/ubuntu/%2Bsource/firefox/60.0%2Bbuild2-0ubuntu0.16.04.1)

##### Ubuntu 14.04

* [firefox](https://launchpad.net/ubuntu/%2Bsource/firefox)
  -
  [60.0+build2-0ubuntu0.14.04.1](https://launchpad.net/ubuntu/%2Bsource/firefox/60.0%2Bbuild2-0ubuntu0.14.04.1)

After a standard system update you need to restart Firefox to make

all the necessary changes.

## References

* [CVE-2018-5150](/security/CVE-2018-5150)
* [CVE-2018-5151](/security/CVE-2018-5151)
* [CVE-2018-5152](/security/CVE-2018-5152)
* [CVE-2018-5153](/security/CVE-2018-5153)
* [CVE-2018-5154](/security/CVE-2018-5154)
* [CVE-2018-5155](/security/CVE-2018-5155)
* [CVE-2018-5157](/security/CVE-2018-5157)
* [CVE-2018-5158](/security/CVE-2018-5158)
* [CVE-2018-5159](/security/CVE-2018-5159)
* [CVE-2018-5160](/security/CVE-2018-5160)
* [CVE-2018-5163](/security/CVE-2018-5163)
* [CVE-2018-5164](/security/CVE-2018-5164)
* [CVE-2018-5166](/security/CVE-2018-5166)
* [CVE-2018-5167](/security/CVE-2018-5167)
* [CVE-2018-5168](/security/CVE-2018-5168)
* [CVE-2018-5169](/security/CVE-2018-5169)
* [CVE-2018-5172](/security/CVE-2018-5172)
* [CVE-2018-5173](/security/CVE-2018-5173)
* [CVE-2018-5175](/security/CVE-2018-5175)
* [CVE-2018-5176](/security/CVE-2018-5176)
* [CVE-2018-5177](/security/CVE-2018-5177)
* [CVE-2018-5180](/security/CVE-2018-5180)
* [CVE-2018-5181](/security/CVE-2018-5181)
* [CVE-2018-5182](/security/CVE-2018-5182)

## Related notices

* [USN-3660-1](/security/notices/USN-3660-1)
* [USN-3688-1](/security/notices/USN-3688-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page


