=== Content from 1337sec.blogspot.de_77de5a53_20250125_122301.html ===

[Skip to main content](#main)

### Search This Blog

# [1337 Security](https://1337sec.blogspot.com/)

### Auditing the Oral-B App (v5.0.0)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[January 08, 2018](https://1337sec.blogspot.com/2018/01/auditing-oral-b-app-v500.html "permanent link")

Upon quickly assessing the Oral-B app (com.pg.oralb.oralbapp), the following findings have been made:
### Hardcoded AES parameters (CVE-2018-5298) and twitter keys

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiJqORraqY6YwfmeNNNuWwnlymIF1_F0kd4RQNVLDbkisIjETDQ7jw5byRpNRsdNOZPTpypeDPigncT54GwDtMdMiYgiz9N0DCi8PTk7MSWWV86uQ0_XzZMRTS5sOnj7-u3yF5dy0CBnCw6/s1600/keys.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiJqORraqY6YwfmeNNNuWwnlymIF1_F0kd4RQNVLDbkisIjETDQ7jw5byRpNRsdNOZPTpypeDPigncT54GwDtMdMiYgiz9N0DCi8PTk7MSWWV86uQ0_XzZMRTS5sOnj7-u3yF5dy0CBnCw6/s1600/keys.png)

These parameters are stored in the class *OralBApplication* and also get used there:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg35zTdfp4rDIFlWVIVt5OQ55GgvbdEH1scmqftpB8t4mn9Qo1NC_XdY5JaAIYSrjraiTz4gD6fgWlynl8ziJwWM2JxMs_wZ8Nb7_J9ssV3U7nAh0B_MJI20cSVevHhiceOSGk4bZnk7KNu/s640/keyUsage.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg35zTdfp4rDIFlWVIVt5OQ55GgvbdEH1scmqftpB8t4mn9Qo1NC_XdY5JaAIYSrjraiTz4gD6fgWlynl8ziJwWM2JxMs_wZ8Nb7_J9ssV3U7nAh0B_MJI20cSVevHhiceOSGk4bZnk7KNu/s1600/keyUsage.png)

Using the twitter secrets, it's possible to create bearer tokens impersonating the Oral-B twitter application. The secrets stored in the app are application tokens only - in my tests it was not possible to authenticate in user context.

The stored AES parameters are used to encrypt and decrypt the locally stored shared preferences in the class called *Preferences*:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjhR0UMjKrE61feZlGiZ74M-cZMCdNNI352lShqQYBU27ZdL59byKNPL7GI_lVrt0Am14yunDDim5_dkdeZO3RCm-HNRfnAmxbuFzZ2nxHzDG4IZkKmV6vZq3F3G2Q1lfNOV2xwWGs99ncR/s640/sharedPrefsEnc.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjhR0UMjKrE61feZlGiZ74M-cZMCdNNI352lShqQYBU27ZdL59byKNPL7GI_lVrt0Am14yunDDim5_dkdeZO3RCm-HNRfnAmxbuFzZ2nxHzDG4IZkKmV6vZq3F3G2Q1lfNOV2xwWGs99ncR/s1600/sharedPrefsEnc.png)

Because of the static key, an attacker can gain access to user data more easily by leveraging access to the preferences XML file.

### Tracking

Upon running the app, the user automatically gets tracked. There is no opt-in required, it's enabled by default.

As you can see, third party advertising providers are allowed to gain access to the user location automatically. Unique advertising IDs are automatically assigned.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiCnN9E4N9ZsEL8ArzOH4JaoDortoOt0kwIlyv-nHezVxxZd44SnopR_TB57aFDsKu1c7do8u7mMKNx4t_e_S1evr-8ZyOK-xXk5jhPDi66k5c-sW5rHkarYqmwPgNzjstQnFc4XXFem3OH/s1600/3dpartyTracking.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiCnN9E4N9ZsEL8ArzOH4JaoDortoOt0kwIlyv-nHezVxxZd44SnopR_TB57aFDsKu1c7do8u7mMKNx4t_e_S1evr-8ZyOK-xXk5jhPDi66k5c-sW5rHkarYqmwPgNzjstQnFc4XXFem3OH/s1600/3dpartyTracking.png)

It's possible to add your dentist to the Oral-B app. This process uses a **server side API** to search for a specific dentist in your location. This allows Oral-B to access your location and gain information about your dentist:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgoFuLgZ5UF6KhtfN2s18OouPipDp93t5co7bTdY5B-cCg5XcQNICM8VEa3QjfVJge3ieDcz2p7Nt7QUPodLqw-gNk-m46gqSgWa-D1e9aaR7nE4ZKAV9kPv3TKYAKRtIbd-SJLw6LbpGkS/s1600/dentistSearchLocationName.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgoFuLgZ5UF6KhtfN2s18OouPipDp93t5co7bTdY5B-cCg5XcQNICM8VEa3QjfVJge3ieDcz2p7Nt7QUPodLqw-gNk-m46gqSgWa-D1e9aaR7nE4ZKAV9kPv3TKYAKRtIbd-SJLw6LbpGkS/s1600/dentistSearchLocationName.png)

Of course, facebook tracking is also enabled by default:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhobF5J78TCDgbopxLTIeVtOrYD_KEaGlv8C9AFZWHiUG08qSORl3-T6muRB1w_w6DxOXOiOcsPzEmY4LAZ_3PSzh6_BMgnqmYOX9l1ScMg6h7d1fWbzZWdyQCZXYv4KwSIPNoi_FmR16dh/s640/facebookTracking.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhobF5J78TCDgbopxLTIeVtOrYD_KEaGlv8C9AFZWHiUG08qSORl3-T6muRB1w_w6DxOXOiOcsPzEmY4LAZ_3PSzh6_BMgnqmYOX9l1ScMg6h7d1fWbzZWdyQCZXYv4KwSIPNoi_FmR16dh/s1600/facebookTracking.png)

Last but not least, the weather functionality of course also requires and transmits your current location:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgQsdookFOVkR-Ao-qbAUFpSCIjfkPVlMnFzEmBl7gp_YZ52zOGwrhJ_z4bdEsX5gklE_-cesa_sO2sExIU1wXsAJNO9Sy9hogF8Ka30mXbImpK8YpwsRg0IjZrsHDNGpk9luJZ6N4RKu_l/s640/weatherLocation.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgQsdookFOVkR-Ao-qbAUFpSCIjfkPVlMnFzEmBl7gp_YZ52zOGwrhJ_z4bdEsX5gklE_-cesa_sO2sExIU1wXsAJNO9Sy9hogF8Ka30mXbImpK8YpwsRg0IjZrsHDNGpk9luJZ6N4RKu_l/s1600/weatherLocation.png)

Please note no transmission of user specific brushing data has been identified. However, there is a cache that saves your last brushing sessions <:

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Popular posts from this blog

### [Auditing NQ Contacts Backup & Restore 1.1](https://1337sec.blogspot.com/2017/10/auditing-nq-contacts-backup-restore-11.html)

[October 29, 2017](https://1337sec.blogspot.com/2017/10/auditing-nq-contacts-backup-restore-11.html "permanent link")

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiFP3Vt95Odc28i0JCZumQ2CaChZAdn83nZjXU0Diolx3lWR3tNRW6ozgneZ64hbq4HJQgWTlDQpqjDKxKdXGkfFHHOKRRDR4kilaUhMMkISw022_-_pKp2ykq8WjQ_-0fC9re49tVC7O6O/s1600/xml.png)](https://1337sec.blogspot.com/2017/10/auditing-nq-contacts-backup-restore-11.html)

NQ Contacts Backup & Restore is an android app that allows users to backup and restore contact data (as vcard) to/from the remote NQ server. For the audit, the android app was the primary target.  Note: The app shares its code base with NQ Mobile Security & Anti Virus  - hence the odd class names for a simple contact backup app. Lack of HTTPS usage  When logging in or transmitting data, the app communicates with the remote server via HTTP. This can be exploited in various ways. One of these is sniffing the request when a user logs in:   As you can see, the username is being transmitted in cleartext.  The password is hashed with SHA-1. An attacker can now crack the SHA-1 hash (because that's pretty easy nowadays): Additionally, an attacker could use the sniffed hash to download the stored contacts from the server directly. As described later, the attacker can also access transmitted contact data. Vulnerability type: Plaintext data tran...

[Read more](https://1337sec.blogspot.com/2017/10/auditing-nq-contacts-backup-restore-11.html "Auditing NQ Contacts Backup & Restore 1.1")

### [Auditing WriteDiary.com (CVE-2017-15581 & CVE-2017-15582)](https://1337sec.blogspot.com/2017/10/auditing-writediarycom-cve-2017-15581.html)

[October 27, 2017](https://1337sec.blogspot.com/2017/10/auditing-writediarycom-cve-2017-15581.html "permanent link")

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhifJa_dgKZjxsj8BHzF7jMXgQXJdxlBXXTNki7w174xonwIA3xlUhK1Z-6q-YDdCYO-E4Ef_yyoDTty58jW1_WwxhhBXNnkv3MAndHRDUMP8ZDNtFdQKfjN_6eJbv95f1bthDn6ENQDYkP/s1600/cleartext_pw.png)](https://1337sec.blogspot.com/2017/10/auditing-writediarycom-cve-2017-15581.html)

General note: The developer and owner of both the webapp and android app has been contacted multiple times to develop a quick fix for the issues addressed in this blog post and a vulnerability concerning the webapp which isn't described here. However, no response has been received. WriteDiary consists of a webapp ( WriteDiary.com ) and an android app  (version 4.72). For the audit, the android app was the primary target. CVE-2017-15581 : Lack of HTTPS-usage, lack of user data encryption when transmitting In the "Diary with lock" (aka WriteDiary) application 4.72 for Android, neither HTTPS (check strings.xml for api\_url\_prod :  http ://diary.adpog.com/api2)  nor other encryption is used for transmitting data, despite the documentation that the product is intended for "a personal journal of secrets and feelings," which allows remote attackers to obtain sensitive information by sniffing the network during LoginActivity or NoteActivity execution. ...

[Read more](https://1337sec.blogspot.com/2017/10/auditing-writediarycom-cve-2017-15581.html "Auditing WriteDiary.com (CVE-2017-15581 & CVE-2017-15582)")

[Powered by Blogger](https://www.blogger.com)

Theme images by [Terraxplorer](http://www.istockphoto.com/file_closeup.php?id=4502756&platform=blogger)

[Banana Joe](https://www.blogger.com/profile/07123599309238725850)

[Visit profile](https://www.blogger.com/profile/07123599309238725850)

### Archive

* [January 20181](https://1337sec.blogspot.com/2018/01/)
* [October 20172](https://1337sec.blogspot.com/2017/10/)

### [Report Abuse](https://www.blogger.com/go/report-abuse)


