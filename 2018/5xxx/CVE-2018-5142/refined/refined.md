```
{
  "cve": "CVE-2018-5142",
  "affected_product": "Firefox",
  "vulnerability_details": {
    "root_cause": "The Media Capture and Streams API permission prompts use the document URI instead of the origin for data and blob URLs.",
    "weaknesses": [
      "Incorrect origin display in permission prompts",
      "Lack of proper handling for data: and blob: URLs."
    ],
    "impact": "Users may be confused about which site is requesting permission due to the \"Unknown protocol\" message, potentially leading them to grant permission to malicious sites.",
    "attack_vectors": [
      "A malicious website using data or blob URLs to request media permissions."
    ],
    "attacker_capabilities": "An attacker needs to host a malicious webpage that uses data or blob URLs to trigger the permission request."
  },
  "patch_details": {
        "solution": "The vulnerability was resolved by using the origin of the request instead of the document URI when displaying the permission prompt for the Media Capture and Streams API in Firefox. This ensures that the correct origin is displayed, even for data and blob URLs.",
         "commits": [
          "https://hg.mozilla.org/integration/mozilla-inbound/rev/784e8f4a3209082492f44f511180c0168e7c38eb"
         ]
     }
}
```