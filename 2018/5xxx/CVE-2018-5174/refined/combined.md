=== Content from www.mozilla.org_0ad64fec_20250125_013938.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2018-12

## Security vulnerabilities fixed in Firefox ESR 52.8

Announced
May 9, 2018
Impact
critical
Products
Firefox ESR
Fixed in

* Firefox ESR 52.8

#### [#CVE-2018-5183: Backport critical security fixes in Skia](#CVE-2018-5183)

Reporter
Mozilla Developers
Impact
critical
##### Description

Mozilla developers backported selected changes in the Skia library to the ESR52 branch of Firefox. These changes correct memory corruption issues including invalid buffer reads and writes during graphic operations.

##### References

* [Bug 1454692](https://bugzilla.mozilla.org/show_bug.cgi?id=1454692)

#### [#CVE-2018-5154: Use-after-free with SVG animations and clip paths](#CVE-2018-5154)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur while enumerating attributes during SVG animations with clip paths. This results in a potentially exploitable crash.

##### References

* [Bug 1443092](https://bugzilla.mozilla.org/show_bug.cgi?id=1443092)

#### [#CVE-2018-5155: Use-after-free with SVG animations and text paths](#CVE-2018-5155)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur while adjusting layout during SVG animations with text paths. This results in a potentially exploitable crash.

##### References

* [Bug 1448774](https://bugzilla.mozilla.org/show_bug.cgi?id=1448774)

#### [#CVE-2018-5157: Same-origin bypass of PDF Viewer to view protected PDF files](#CVE-2018-5157)

Reporter
Wladimir Palant
Impact
high
##### Description

Same-origin protections for the PDF viewer can be bypassed, allowing a malicious site to intercept messages meant for the viewer. This could allow the site to retrieve PDF files restricted to viewing by an authenticated user on a third-party website.

##### References

* [Bug 1449898](https://bugzilla.mozilla.org/show_bug.cgi?id=1449898)

#### [#CVE-2018-5158: Malicious PDF can inject JavaScript into PDF Viewer](#CVE-2018-5158)

Reporter
Wladimir Palant
Impact
high
##### Description

The PDF viewer does not sufficiently sanitize PostScript calculator functions, allowing malicious JavaScript to be injected through a crafted PDF file. This JavaScript can then be run with the permissions of the PDF viewer by its worker.

##### References

* [Bug 1452075](https://bugzilla.mozilla.org/show_bug.cgi?id=1452075)

#### [#CVE-2018-5159: Integer overflow and out-of-bounds write in Skia](#CVE-2018-5159)

Reporter
Ivan Fratric
Impact
high
##### Description

An integer overflow can occur in the Skia library due to 32-bit integer use in an array without integer overflow checks, resulting in possible out-of-bounds writes. This could lead to a potentially exploitable crash triggerable by web content.

##### References

* [Bug 1441941](https://bugzilla.mozilla.org/show_bug.cgi?id=1441941)

#### [#CVE-2018-5168: Lightweight themes can be installed without user interaction](#CVE-2018-5168)

Reporter
Wladimir Palant
Impact
moderate
##### Description

Sites can bypass security checks on permissions to install lightweight themes by manipulating the `baseURI` property of the theme element. This could allow a malicious site to install a theme without user interaction which could contain offensive or embarrassing images.

##### References

* [Bug 1449548](https://bugzilla.mozilla.org/show_bug.cgi?id=1449548)

#### [#CVE-2018-5174: Windows Defender SmartScreen UI runs with less secure behavior for downloaded files in Windows 10 April 2018 Update](#CVE-2018-5174)

Reporter
Jimmy
Impact
moderate
##### Description

In the Windows 10 April 2018 Update, Windows Defender SmartScreen honors the `SEE_MASK_FLAG_NO_UI` flag associated with downloaded files and will not show any UI. Files that are unknown and potentially dangerous will be allowed to run because SmartScreen will not prompt the user for a decision, and if the user is offline all files will be allowed to be opened because Windows won’t prompt the user to ask what to do. Firefox incorrectly sets this flag when downloading files, leading to less secure behavior from SmartScreen.
*Note: this issue only affects Windows 10 users running the April 2018 update or later. It does not affect other Windows users or other operating systems.*

##### References

* [Bug 1447080](https://bugzilla.mozilla.org/show_bug.cgi?id=1447080)

#### [#CVE-2018-5178: Buffer overflow during UTF-8 to Unicode string conversion through legacy extension](#CVE-2018-5178)

Reporter
Root Object
Impact
moderate
##### Description

A buffer overflow was found during UTF8 to Unicode string conversion within JavaScript with extremely large amounts of data. This vulnerability requires the use of a malicious or vulnerable legacy extension in order to occur.

##### References

* [Bug 1443891](https://bugzilla.mozilla.org/show_bug.cgi?id=1443891)

#### [#CVE-2018-5150: Memory safety bugs fixed in Firefox 60 and Firefox ESR 52.8](#CVE-2018-5150)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Christoph Diehl, Randell Jesup, Tyson Smith, Alex Gaynor, Ronald Crane, Julian Hector, Kannan Vijayan, and Jason Kratzer reported memory safety bugs present in Firefox 59 and Firefox ESR 52.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 60 and Firefox ESR 52.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1388020%2C1433609%2C1409440%2C1448705%2C1451376%2C1452202%2C1444668%2C1393367%2C1411415%2C1426129)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_25210423_20250125_013937.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1447080)
* [XML](/show_bug.cgi?ctype=xml&id=1447080)

Closed
[Bug 1447080](/show_bug.cgi?id=1447080)
(CVE-2018-5174)

Opened 7 years ago
Closed 7 years ago

# Security: SEE\_MASK\_FLAG\_NO\_UI behavior changes in Windows 10, allowing SmartScreen bypass

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Security: SEE\_MASK\_FLAG\_NO\_UI behavior changes in Windows 10, allowing SmartScreen bypass

## Categories

### (Core :: Widget: Win32, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Widget%3A%20Win32#Widget%3A%20Win32)

Widget: Win32
▾

Core :: Widget: Win32
Mapping of cross platform widget interfaces to Win32 platform APIs.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Widget%3A%20Win32&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Widget%3A%20Win32&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Widget%3A%20Win32)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

59 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla61

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr52 | [60+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=60%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=fixed) |
| firefox59 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox59&o1=equals&v1=wontfix) |
| firefox60 | [+](/buglist.cgi?f1=cf_tracking_firefox60&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=fixed) |
| firefox61 | [+](/buglist.cgi?f1=cf_tracking_firefox61&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr52 | 60+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox59 |  | wontfix |
| firefox60 | + | fixed |
| firefox61 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jafeher, Assigned: jimm)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [jimm](/user_profile?user_id=279663)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/12a94ec61fd924f763a9160dab90e6a7?d=mm&size=40)  [jafeher](/user_profile?user_id=614245)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/605ee8cd1c9a74704916c7bdc4e4865d?d=mm&size=40)  [rkraesig](/user_profile?user_id=699639)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

16 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[CVE-2007-4841](/show_bug.cgi?id=394974 "RESOLVED FIXED - URIs with invalid % encodings launch wrong handler on WinXP+IE7")

Dependency [tree](/showdependencytree.cgi?id=1447080&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1447080)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-other, sec-moderate, Whiteboard: [adv-main60+][adv-esr52.8+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2018-5174

[Keywords:](/describekeywords.cgi)

[csectype-other](/buglist.cgi?keywords=csectype-other&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main60+][adv-esr52.8+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

```
Steps to reproduce:

Download and run these files:
Known malware: <https://demo.smartscreen.msft.net/download/known/knownmalicious.exe>
Unknown program: <https://demo.smartscreen.msft.net/download/unknown/freevideo.exe>
Offline: Any of the above with internet on the machine off

More details about the issue:
In the next Windows Release (Redstone 4), Windows Defender SmartScreen will honor the SEE_MASK_FLAG_NO_UI flag. This flag is passed through shellexecute when a user runs an executable, or other supported file, through the firefox download manager. Edge/Windows Explorer do not pass this flag and are unaffected.

There are three problematic scenarios with this flag set:

1. Known malware will be blocked silently: Windows will not show any SmartScreen UI for these types of files, and the user will have no opportunity to override the block through Firefox. The user will not have any indication that executing the file did anything. (Current behavipo
2. Unknown file downloads will be allowed - This is a large number of files and all will be allowed. There is a chance for polymorphic malware to be bucketed within these types of files.
3. User is offline - User is unable to contact SmartScreen. All executions and file opens allowed.

SEE_MASK_FLAG_NO_UI *not* set: all 3 cases will result in a block experience for the user.

SEE_MASK_FLAG_NO_UI *is* set (current Firefox behavior): files in scenario #2 and #3 will be allowed to run even if SmartScreen would otherwise have blocked them.
```

## Attachments

### (4 files)

| [patch v.1](/attachment.cgi?id=8962342)  [7 years ago](#c10)  [Jim Mathies [:jimm]](/user_profile?user_id=279663)   1.18 KB, patch | handyman : [review+](#c25 "7 years ago")  RyanVM : [approval-mozilla-beta+](#c33 "7 years ago")  lizzard : [approval-mozilla-esr52+](#c43 "7 years ago") | [Details](/attachment.cgi?id=8962342&action=edit) | [Diff](/attachment.cgi?id=8962342&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1447080&attachment=8962342) |
| --- | --- | --- |
| [Win7 SmartScreen warning](/attachment.cgi?id=8962702)  [7 years ago](#c16)  [Jim Mathies [:jimm]](/user_profile?user_id=279663)   168.15 KB, image/jpeg |  | [Details](/attachment.cgi?id=8962702&action=edit) |
| [knownmalicious.exe on win10](/attachment.cgi?id=8963034)  [7 years ago](#c18)  [Romain Testard [:RT]](/user_profile?user_id=486264)   57.43 KB, image/png |  | [Details](/attachment.cgi?id=8963034&action=edit) |
| [freevideo.exe on win10](/attachment.cgi?id=8963036)  [7 years ago](#c19)  [Romain Testard [:RT]](/user_profile?user_id=486264)   75.01 KB, image/png |  | [Details](/attachment.cgi?id=8963036&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jimmy](/user_profile?user_id=614245)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1447080#c0)• 7 years ago |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.162 Safari/537.36
Steps to reproduce:
Download and run these files:
Known malware: <https://demo.smartscreen.msft.net/download/known/knownmalicious.exe>
Unknown program: <https://demo.smartscreen.msft.net/download/unknown/freevideo.exe>
Offline: Any of the above with internet on the machine off
More details about the issue:
In the next Windows Release (Redstone 4), Windows Defender SmartScreen will honor the SEE\_MASK\_FLAG\_NO\_UI flag. This flag is passed through shellexecute when a user runs an executable, or other supported file, through the firefox download manager. Edge/Windows Explorer do not pass this flag and are unaffected.
There are three problematic scenarios
1. Known malware - Blocked silently: We will not show any SmartScreen UI for these types of files, but the user will have no opportunity to override the block through firefox. The user will not have any indication that executing the file did anything.
2. Unknowns - The file is unknown to our service. This is a large number of files and all will be allowed. There is a chance for polymorphic malware to be bucketed here.
3. Offline - User is unable to contact smartscreen. Always allowed.
When SEE\_MASK\_FLAG\_NO\_UI is not set, all 3 cases will result in a block experience for the user.
Actual results:
Files are not run. They are silently blocked
Expected results:
Files are not run. They are blocked by SmartScreen.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1447080#c1)• 7 years ago |
|  | |

As best I can tell this was added in [bug 394974](/show_bug.cgi?id=394974 "RESOLVED FIXED - URIs with invalid % encodings launch wrong handler on WinXP+IE7") for Firefox 2.0 (hi, 2006 called, it wants its flags back, etc.).
Jim, can we just drop this flag? Is there an alternative we should be using? It's not clear from [bug 394974](/show_bug.cgi?id=394974 "RESOLVED FIXED - URIs with invalid % encodings launch wrong handler on WinXP+IE7") why this flag was added (though some of the others are more obvious).
I expect we'll want to have a fix in place for 60 given the release timelines for the spring updates in the past (april last year for that one). I don't know how we feel about 59 for this.Group: firefox-core-security → core-security
[status-firefox59](/buglist.cgi?f1=cf_status_firefox59&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox59&o1=equals&v1=affected)
[status-firefox60](/buglist.cgi?f1=cf_status_firefox60&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=affected)
[status-firefox61](/buglist.cgi?f1=cf_status_firefox61&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=affected)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected)Component: Untriaged → Widget: Win32Flags: needinfo?(jmathies)Product: Firefox → Core

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1447080#c2)• 7 years ago |
|  | |

(In reply to :Gijs from [comment #1](/show_bug.cgi?id=1447080#c1 "VERIFIED FIXED - Security: SEE_MASK_FLAG_NO_UI behavior changes in Windows 10, allowing SmartScreen bypass"))
> As best I can tell this was added in [bug 394974](/show_bug.cgi?id=394974 "RESOLVED FIXED - URIs with invalid % encodings launch wrong handler on WinXP+IE7") for Firefox 2.0 (hi, 2006
> called, it wants its flags back, etc.).
>
> Jim, can we just drop this flag? Is there an alternative we should be using?
> It's not clear from [bug 394974](/show_bug.cgi?id=394974 "RESOLVED FIXED - URIs with invalid % encodings launch wrong handler on WinXP+IE7") why this flag was added (though some of the
> others are more obvious).
>
> I expect we'll want to have a fix in place for 60 given the release
> timelines for the spring updates in the past (april last year for that one).
> I don't know how we feel about 59 for this.
I think I just added that because it seemed like a good flag to pass. I don't remember any other specifics.Flags: needinfo?(jmathies)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1447080#c3)• 7 years ago |
|  | |

Who is jkf49@cornell.edu ? This report sounds like it was filed by a Microsoft employee, but I don't recognize the account.Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1447080#c4)• 7 years ago |
|  | |

I have no idea, but removing the flag and showing errors seems like a good thing regardless.
I don't know why this is a hidden security bug or described as a "bypass". From the description it sounds like things that SmartScreen would block are blocked, just silently, and additional things SmartScreen wouldn't block (offline) are also blocked -- perhaps a bug but not going to cause any security issues.Flags: needinfo?(dveditz) → needinfo?(jkf49)

|  | [Jimmy](/user_profile?user_id=614245)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1447080#c5)• 7 years ago |
|  | |

Hey, I'm a dev on the smartscreen team. Sorry, it looks like I didn't update the "actual results" properly.
The security issue is the bucket of unknowns and offline.
The unknown bucket has the potential to contain things like polymorphic malware and will be allowed
Offline: running files offline will also be allowed. These could be files that would normally be blocked by smartscreen.Flags: needinfo?(jkf49)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1447080#c6)• 7 years ago |
|  | |

Dan, should we open this?Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1447080#c7)• 7 years ago |
|  | |

jafeher: I wrote a "User Story" to replace your original description that hopefully removes the confusion. Did I get it right?
(meanwhile I'll set a security rating assuming it is)User Story: (updated)Flags: needinfo?(dveditz) → needinfo?(jafeher)Keywords: [csectype-other](/buglist.cgi?keywords=csectype-other&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1447080#c8)• 7 years ago |
|  | |

Jim: we'd like this fixed in 60 so it's not too behind the Windows release. Who owns this code now?
[status-firefox59](/buglist.cgi?f1=cf_status_firefox59&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox59&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox59&o1=equals&v1=wontfix)
[tracking-firefox60](/buglist.cgi?f1=cf_tracking_firefox60&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox60&o1=equals&v1=%2B)
[tracking-firefox61](/buglist.cgi?f1=cf_tracking_firefox61&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox61&o1=equals&v1=%2B)
[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
--- → [60+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=60%2B)Flags: needinfo?(jmathies)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1447080#a587965_279663)• 7 years ago |

Assignee: nobody → jmathiesFlags: needinfo?(jmathies)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1447080#a587972_279663)• 7 years ago |

Priority: -- → P1

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1447080#c9)• 7 years ago |
|  | |

<https://treeherder.mozilla.org/#/jobs?repo=try&revision=9fe49528449fc627b96fe03ebe4757bbf67fcac1>

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1447080#c10)• 7 years ago |
|  | |

Attached patch

[patch v.1](attachment.cgi?id=8962342&action=diff)
— [Details](attachment.cgi?id=8962342&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1447080&attachment=8962342)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1447080#c11)• 7 years ago |
|  | |

Comment on [attachment 8962342](/attachment.cgi?id=8962342 "patch v.1") [[details]](/attachment.cgi?id=8962342&action=edit "patch v.1") [[diff]](/attachment.cgi?id=8962342&action=diff "patch v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1447080&attachment=8962342)
patch v.1
David mind looking this one line change over? I did a little research on this flag, didn't find anything out on the net indicating this change might introduce some sort of issue. Generally looks like a safe change although I do wonder if users will start seeing error messages when executing attachments due to this. If so, hopefully those messages are useful. Not sure we want to push this out fast, I think lots of bake time is warranted here.
[Attachment #8962342](/attachment.cgi?id=8962342&action=edit "patch v.1") -
Flags: review?(davidp99)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1447080#a613498_1689)• 7 years ago |

Group: core-security → layout-core-security

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1447080#c12)• 7 years ago |
|  | |

Comment on [attachment 8962342](/attachment.cgi?id=8962342 "patch v.1") [[details]](/attachment.cgi?id=8962342&action=edit "patch v.1") [[diff]](/attachment.cgi?id=8962342&action=diff "patch v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1447080&attachment=8962342)
patch v.1
Putting this on hold after discussing with David. We're not sure we want to make these changes. Blocking #2 in particular sounds like it would produce really awful user experiences. #3 is questionable as well.
[Attachment #8962342](/attachment.cgi?id=8962342&action=edit "patch v.1") -
Flags: review?(davidp99)

|  | [Jimmy](/user_profile?user_id=614245)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1447080#c13)• 7 years ago |
|  | |

User story looks correct.
@Jim This is how SmartScreen has functioned previously. Chrome has agreed to making this same change. Any commonly downloaded file quickly get reputation in smartscreen and will be allowed. Clicking through SmartScreen once will clear mark of the web and that file will not be blocked again.
Let me know if you require any more information.Flags: needinfo?(jafeher)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1447080#c14)• 7 years ago |
|  | |

SmartScreen description off wikipedia -
"It is designed to help protect users against attacks that utilize social engineering and drive-by downloads to infect a system by scanning URLs accessed by a user against a blacklist of websites containing known threats."
<https://en.wikipedia.org/wiki/Microsoft_SmartScreen>

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1447080#c15)• 7 years ago |
|  | |

Hey Romain, can Product provide some input here? Sounds like we probably want to ship this flag but there's an open question as to how annoying it might be for the user. We could tie this to a hidden pref if we think users might want a way to disable. Although I'd prefer not adding that unless we absolutely need it.Flags: needinfo?(rtestard)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1447080#c16)• 7 years ago |
|  | |

Attached image
[Win7 SmartScreen warning](attachment.cgi?id=8962702)
— [Details](attachment.cgi?id=8962702&action=edit)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1447080#a672675_279663)• 7 years ago |

User Story: (updated)

|  | [Romain Testard [:RT]](/user_profile?user_id=486264) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1447080#c17)• 7 years ago |
|  | |

(In reply to Jim Mathies [:jimm] from [comment #15](/show_bug.cgi?id=1447080#c15 "VERIFIED FIXED - Security: SEE_MASK_FLAG_NO_UI behavior changes in Windows 10, allowing SmartScreen bypass"))
> Hey Romain, can Product provide some input here? Sounds like we probably
> want to ship this flag but there's an open question as to how annoying it
> might be for the user. We could tie this to a hidden pref if we think users
> might want a way to disable. Although I'd prefer not adding that unless we
> absolutely need it.
My understanding is that this will only impact Win10 users updating to Redstone 4 (Released Apr 10th it seems).
I tested the files provided in the user story (I run Redstone 3 with Firefox 59.0.2) and both get me a warning screen (red for the known malware and blue for the unknown program) when I attempt to run them (see attached). Can you clarify what is the actual Win10 user experience if SEE\_MASK\_FLAG\_NO\_UI is \*not\* set with Redstone 4 ?
Also do we have telemetry for how often we set that flag on Win10?Flags: needinfo?(rtestard)

|  | [Romain Testard [:RT]](/user_profile?user_id=486264) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1447080#c18)• 7 years ago |
|  | |

Attached image
[knownmalicious.exe on win10](attachment.cgi?id=8963034)
— [Details](attachment.cgi?id=8963034&action=edit)

knownmalicious.exe on win10

|  | [Romain Testard [:RT]](/user_profile?user_id=486264) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1447080#c19)• 7 years ago |
|  | |

Attached image
[freevideo.exe on win10](attachment.cgi?id=8963036)
— [Details](attachment.cgi?id=8963036&action=edit)

|  | [David Parks [:handyman]](/user_profile?user_id=506442) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1447080#c20)• 7 years ago |
|  | |

FWIW, I'd add that the "unknown program" case Romain speaks of (the freevideo.exe one) requires the user to click "More Information" to get to a prompt that allows them to run the program anyway. Since Firefox is my browser, I very rarely see this prompt so it trips me up every time. It takes me a moment to figure out what to do and I already know what to do.

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1447080#c21)• 7 years ago |
|  | |

(In reply to Romain Testard [:RT] from [comment #17](/show_bug.cgi?id=1447080#c17 "VERIFIED FIXED - Security: SEE_MASK_FLAG_NO_UI behavior changes in Windows 10, allowing SmartScreen bypass"))
> (In reply to Jim Mathies [:jimm] from [comment #15](/show_bug.cgi?id=1447080#c15 "VERIFIED FIXED - Security: SEE_MASK_FLAG_NO_UI behavior changes in Windows 10, allowing SmartScreen bypass"))
> > Hey Romain, can Product provide some input here? Sounds like we probably
> > want to ship this flag but there's an open question as to how annoying it
> > might be for the user. We could tie this to a hidden pref if we think users
> > might want a way to disable. Although I'd prefer not adding that unless we
> > absolutely need it.
>
> My understanding is that this will only impact Win10 users updating to
> Redstone 4 (Released Apr 10th it seems).
Correct.
> I tested the files provided in the user story (I run Redstone 3 with Firefox
> 59.0.2) and both get me a warning screen (red for the known malware and blue
> for the unknown program) when I attempt to run them (see attached). Can you
> clarify what is the actual Win10 user experience if SEE\_MASK\_FLAG\_NO\_UI is
> \*not\* set with Redstone 4 ?
According to Microsoft the second two test cases would result in execution without a prompt starting in redstone 4. We still get a block in #1, but apparently we won't get the Windows warning dialog, it'll just fail silently.
> Also do we have telemetry for how often we set that flag on Win10?
We pass this to the API call that launches 3rd party apps for us, so we always pass it. The question is do we want to stop doing that.
The more I dig into this, the more I'm convinced we should take this change.Status: UNCONFIRMED → NEWEver confirmed: trueFlags: needinfo?(rtestard)

|  | [Romain Testard [:RT]](/user_profile?user_id=486264) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1447080#c22)• 7 years ago |
|  | |

Thanks. Talking about experience change between current and Redstone 4 with flag removed my understanding is it will be:
1 Known malware: currently the user sees the red screen, in Redstone 4 with flag removed the user would just see nothing (silent fail. This sounds fine to me if the security risk warrants preventing the user from running the file
2 Unknown program: currently the user sees the blue screen, in Redstone 4 with flag removed the user would still see the blue screen (no change). (I understand from the user story that there is a block in this case and I assume the blue screen as UI)
It sounds to me like we should implement the change since the user experience is only impacted in (1) in a case where known malware would now be prevented from running.
My question above on telemetry was to understand how often the average user sees the screen in scenario (2) although if my interpretation is right this will not change assuming we remove the flag so no need to look into this.Flags: needinfo?(rtestard)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1447080#c23)• 7 years ago |
|  | |

(In reply to Romain Testard [:RT] from [comment #22](/show_bug.cgi?id=1447080#c22 "VERIFIED FIXED - Security: SEE_MASK_FLAG_NO_UI behavior changes in Windows 10, allowing SmartScreen bypass"))
> Thanks. Talking about experience change between current and Redstone 4 with
> flag removed my understanding is it will be:
> 1 Known malware: currently the user sees the red screen, in Redstone 4 with
> flag removed the user would just see nothing (silent fail. This sounds fine
> to me if the security risk warrants preventing the user from running the file
This is incorrect. Currently Firefox will trigger a blocked execution prompt in pre-redstone4 versions of Windows. In redstone4, (according to our ms friend here) current Firefox will fail silently. Landing the patch here (removing the "don't show ui" flag) will not impact Firefox behavior on pre-redtone4, with redstone4 landing the patch will trigger a blocked execution prompt.
> 2 Unknown program: currently the user sees the blue screen, in Redstone 4
> with flag removed the user would still see the blue screen (no change). (I
> understand from the user story that there is a block in this case and I
> assume the blue screen as UI)
Reversed again, but generally yes we want to fix the issue where the blue screen might not display. Landing this patch will accomplish this.
> It sounds to me like we should implement the change since the user
> experience is only impacted in (1) in a case where known malware would now
> be prevented from running.
Ok, we're going land this such that on redstone 4 and beyond, our users get prompted with warnings in all three cases here. Without this patch, those warnings would not be displayed (as they currently are in pre-redstone4 releases of Windows.)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1447080#c24)• 7 years ago |
|  | |

Comment on [attachment 8962342](/attachment.cgi?id=8962342 "patch v.1") [[details]](/attachment.cgi?id=8962342&action=edit "patch v.1") [[diff]](/attachment.cgi?id=8962342&action=diff "patch v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1447080&attachment=8962342)
patch v.1
We've decided to take this.
[Attachment #8962342](/attachment.cgi?id=8962342&action=edit "patch v.1") -
Flags: review?(davidp99)

|  | [David Parks [:handyman]](/user_profile?user_id=506442) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1447080#c25)• 7 years ago |
|  | |

Comment on [attachment 8962342](/attachment.cgi?id=8962342 "patch v.1") [[details]](/attachment.cgi?id=8962342&action=edit "patch v.1") [[diff]](/attachment.cgi?id=8962342&action=diff "patch v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1447080&attachment=8962342)
patch v.1
Review of [attachment 8962342](/attachment.cgi?id=8962342 "patch v.1") [[details]](/attachment.cgi?id=8962342&action=edit "patch v.1") [[diff]](/attachment.cgi?id=8962342&action=diff "patch v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1447080&attachment=8962342):
-----------------------------------------------------------------
Agreed. Its too valuable to go without.
[Attachment #8962342](/attachment.cgi?id=8962342&action=edit "patch v.1") -
Flags: review?(davidp99) → review+

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1447080#a1917548_279663)• 7 years ago |

Blocks: [CVE-2007-4841](/show_bug.cgi?id=394974 "RESOLVED FIXED - URIs with invalid % encodings launch wrong handler on WinXP+IE7")

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1447080#c26)• 7 years ago |
|  | |

Comment on [attachment 8962342](/attachment.cgi?id=8962342 "patch v.1") [[details]](/attachment.cgi?id=8962342&action=edit "patch v.1") [[diff]](/attachment.cgi?id=8962342&action=diff "patch v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1447080&attachment=8962342)
patch v.1
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
This is not a vulnerability bug. Flag change that impacts operating system security response to 3rd party content handling via Firefox.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
no
Which older supported branches are affected by this flaw?
all
If not all supported branches, which bug introduced the flaw?
[bug 394974](/show_bug.cgi?id=394974 "RESOLVED FIXED - URIs with invalid % encodings launch wrong handler on WinXP+IE7")
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
no, and this is not needed. we're going to fix this in current release, and uplift to 60 ESR.
How likely is this patch to cause regressions; how much testing does it need?
medium?
[Attachment #8962342](/attachment.cgi?id=8962342&action=edit "patch v.1") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1447080#c27)• 7 years ago |
|  | |

Comment on [attachment 8962342](/attachment.cgi?id=8962342 "patch v.1") [[details]](/attachment.cgi?id=8962342&action=edit "patch v.1") [[diff]](/attachment.cgi?id=8962342&action=diff "patch v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1447080&attachment=8962342)
patch v.1
As a sec-moderate, this doesn't need sec-approval to land. Let's get it onto trunk and then see about uplifting it to Beta. That will need to happen within the next two weeks so we have a couple of beta left before we ship 60.
[Attachment #8962342](/attachment.cgi?id=8962342&action=edit "patch v.1") -
Flags: sec-approval?

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1447080#a2051552_279663)• 7 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1447080#c28)• 7 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/56bfd2178dcad46a5b611b14e31938f1d96124a0>Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1447080#c29)• 7 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/56bfd2178dca>Status: NEW → RESOLVEDClosed: 7 years ago
[status-firefox61](/buglist.cgi?f1=cf_status_firefox61&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla61

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1447080#c30)• 7 years ago |
|  | |

Seems worth a Beta uplift request at least. What are your thoughts on ESR52 (EOL in late August)?Flags: needinfo?(jmathies)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1447080#c31)• 7 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #30](/show_bug.cgi?id=1447080#c30 "VERIFIED FIXED - Security: SEE_MASK_FLAG_NO_UI behavior changes in Windows 10, allowing SmartScreen bypass"))
> Seems worth a Beta uplift request at least. What are your thoughts on ESR52
> (EOL in late August)?
Once we've verified this is 'ok', this patch can ship to pretty much any release we have right now.Flags: needinfo?(jmathies)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1447080#c32)• 7 years ago |
|  | |

Comment on [attachment 8962342](/attachment.cgi?id=8962342 "patch v.1") [[details]](/attachment.cgi?id=8962342&action=edit "patch v.1") [[diff]](/attachment.cgi?id=8962342&action=diff "patch v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1447080&attachment=8962342)
patch v.1
Approval Request Comment
[Feature/Bug causing the regression]:
A newer version of Windows will ship feature changes that are impacted by this flag.
[User impact if declined]:
No warning UI when users interact with untrusted files.
[Is this code covered by automated tests?]:
yes.
[Has the fix been verified in Nightly?]:
No, we probably should ask for pi on the affected windows version. I will file a pi request.
[Needs manual test from QE? If yes, steps to reproduce]:
see user story
[List of other uplifts needed for the feature/fix]:
none
[Is the change risky?]:
no
[Why is the change risky/not risky?]:
well understood side effects.
[String changes made/needed]:
none.
[Attachment #8962342](/attachment.cgi?id=8962342&action=edit "patch v.1") -
Flags: approval-mozilla-beta?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1447080#a2164227_75935)• 7 years ago |

Group: layout-core-security → core-security-release

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1447080#a2230200_75935)• 7 years ago |

Flags: qe-verify+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1447080#c33)• 7 years ago |
|  | |

Comment on [attachment 8962342](/attachment.cgi?id=8962342 "patch v.1") [[details]](/attachment.cgi?id=8962342&action=edit "patch v.1") [[diff]](/attachment.cgi?id=8962342&action=diff "patch v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1447080&attachment=8962342)
patch v.1
Approved for 60.0b13. Per Jim's PI request, let's get some extra QA attention on it as well.
[Attachment #8962342](/attachment.cgi?id=8962342&action=edit "patch v.1") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1447080#c34)• 7 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/ed7be30d3141>
[status-firefox60](/buglist.cgi?f1=cf_status_firefox60&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=fixed)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1447080#c35)• 7 years ago |
|  | |

Hey jafeher, We're not seeing the prompting in Windows version 1803 (OS Build 17133.73) with our updated version of Firefox. Just want to confirm that the new behavior you describe is in the Windows build above.Flags: needinfo?(jafeher)

|  | [Jimmy](/user_profile?user_id=614245)  Reporter |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1447080#c36)• 7 years ago |
|  | |

Yes this behavior should exist in that build.
Is this change available in any public beta version of firefox that I can test?Flags: needinfo?(jafeher) → needinfo?(jmathies)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1447080#c37)• 7 years ago |
|  | |

Yes, 60.0b13 was released today with this fix included.
<https://www.mozilla.org/en-US/firefox/channel/desktop/>

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1447080#a2529365_279663)• 7 years ago |

Flags: needinfo?(jmathies)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1447080#a2529375_279663)• 7 years ago |

Flags: needinfo?(jafeher)

|  | [Jimmy](/user_profile?user_id=614245)  Reporter |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1447080#c38)• 7 years ago |
|  | |

Thanks for the information.
We did not realize that Firefox/Chrome call ShellexecuteExW in different ways. There is also a Windows bug in the path that firefox calls. We are working on a fix and will get this out in an early servicing patch.
Let me know if you require any other information.Flags: needinfo?(jafeher)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1447080#a3385826_280903)• 7 years ago |

Whiteboard: [adv-main60+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1447080#c39)• 7 years ago |
|  | |

This seems to have missed the ESR52 train as well despite being tracking for 60+ and affected.Flags: needinfo?(lhenry)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1447080#c40)• 7 years ago |
|  | |

Can you create a patch for esr52 and request uplift? Thanks.Flags: needinfo?(lhenry) → needinfo?(jmathies)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1447080#c41)• 7 years ago |
|  | |

(In reply to Jimmy from [comment #38](/show_bug.cgi?id=1447080#c38 "VERIFIED FIXED - Security: SEE_MASK_FLAG_NO_UI behavior changes in Windows 10, allowing SmartScreen bypass"))
> Thanks for the information.
>
> We did not realize that Firefox/Chrome call ShellexecuteExW in different
> ways. There is also a Windows bug in the path that firefox calls. We are
> working on a fix and will get this out in an early servicing patch.
>
> Let me know if you require any other information.
Thanks for the follow up. Is there something we can change on our side? The code in question is here [1]. (In reply to Liz Henry (:lizzard) (needinfo? me) from [comment #40](/show_bug.cgi?id=1447080#c40 "VERIFIED FIXED - Security: SEE_MASK_FLAG_NO_UI behavior changes in Windows 10, allowing SmartScreen bypass"))
> Can you create a patch for esr52 and request uplift? Thanks.
The existing patch should apply cleanly there, it's a one line change. I'll flag it.Flags: needinfo?(jmathies)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1447080#c42)• 7 years ago |
|  | |

Comment on [attachment 8962342](/attachment.cgi?id=8962342 "patch v.1") [[details]](/attachment.cgi?id=8962342&action=edit "patch v.1") [[diff]](/attachment.cgi?id=8962342&action=diff "patch v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1447080&attachment=8962342)
patch v.1
[Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration:
New security related behavioral change in Windows 10 needs to be enabled on our end through a minor code change.
User impact if declined:
Issues with silent failures when handling file downloads under the newest version of windows 10.
Fix Landed on Version:
60, 61.
Risk to taking this patch (and alternatives if risky):
Low risk, well understood change requested by Microsoft.
String or UUID changes made by this patch:
none.
[Attachment #8962342](/attachment.cgi?id=8962342&action=edit "patch v.1") -
Flags: approval-mozilla-esr52?

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1447080#c43)• 7 years ago |
|  | |

Comment on [attachment 8962342](/attachment.cgi?id=8962342 "patch v.1") [[details]](/attachment.cgi?id=8962342&action=edit "patch v.1") [[diff]](/attachment.cgi?id=8962342&action=diff "patch v.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1447080&attachment=8962342)
patch v.1
While this is a fix for a sec-moderate issue I think it warrants uplift to esr52 because it may be a widespread issue with the upcoming Windows update.
[Attachment #8962342](/attachment.cgi?id=8962342&action=edit "patch v.1") -
Flags: approval-mozilla-esr52? → approval-mozilla-esr52+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1447080#a3628954_280903)• 7 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1447080#c44)• 7 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr52/rev/621034a42acc>
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=fixed)Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1447080#a3639917_280903)• 7 years ago |

Whiteboard: [adv-main60+] → [adv-main60+][adv-esr52.8+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1447080#a3657822_280903)• 7 years ago |

Alias: CVE-2018-5174

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1447080#c45)• 7 years ago |
|  | |

Hi Jim,
I have retested this issue (followed the steps from [comment 0](/show_bug.cgi?id=1447080#c0 "VERIFIED FIXED - Security: SEE_MASK_FLAG_NO_UI behavior changes in Windows 10, allowing SmartScreen bypass")) on Windows 10 x64 Version 1803 (OS Build 17134.5), and the prompts are still not displayed, on 52.8.1 Esr, 60.0.2 Release and 61.0b14 Beta.
It seems that Edge/Chrome blocks properly both files mentioned in [comment 0](/show_bug.cgi?id=1447080#c0 "VERIFIED FIXED - Security: SEE_MASK_FLAG_NO_UI behavior changes in Windows 10, allowing SmartScreen bypass"), when running them.
Any idea what might be wrong here, can you please take a look?Flags: needinfo?(jmathies)

|  | [Jimmy](/user_profile?user_id=614245)  Reporter |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1447080#c46)• 7 years ago |
|  | |

This fix required a change on the Windows side as well. It is going through servicing now and will be released at the end of this month. I'm not sure of the exact date.
I have validated that firefox has the same behavior as Edge/Chrome with this update.

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663)  Assignee |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1447080#c47)• 7 years ago |
|  | |

(In reply to Jimmy from [comment #46](/show_bug.cgi?id=1447080#c46 "VERIFIED FIXED - Security: SEE_MASK_FLAG_NO_UI behavior changes in Windows 10, allowing SmartScreen bypass"))
> This fix required a change on the Windows side as well. It is going through
> servicing now and will be released at the end of this month. I'm not sure of
> the exact date.
>
> I have validated that firefox has the same behavior as Edge/Chrome with this
> update.
Thanks!Flags: needinfo?(jmathies)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1447080#a14038603_1689)• 6 years ago |

Group: core-security-release

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1447080#c48)• 6 years ago |
|  | |

Closing this bug as verified fixed per [comment 46](/show_bug.cgi?id=1447080#c46 "VERIFIED FIXED - Security: SEE_MASK_FLAG_NO_UI behavior changes in Windows 10, allowing SmartScreen bypass").

Status: RESOLVED → VERIFIEDFlags: qe-verify+
You need to [log in](/show_bug.cgi?id=1447080&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jim Mathies [:jimm]](/user_profile?user_id=279663)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_91680c8b_20250126_050650.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1438025)
* [XML](/show_bug.cgi?ctype=xml&id=1438025)

Closed
[Bug 1438025](/show_bug.cgi?id=1438025)
(CVE-2018-5173)

Opened 7 years ago
Closed 7 years ago

# browser.downloads.download should remove \u202E (RLO) chars

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

browser.downloads.download should remove \u202E (RLO) chars

## Categories

### (WebExtensions :: Untriaged, defect, P2)

[Product:](/describecomponents.cgi?product=WebExtensions)

WebExtensions
▾

WebExtensions
File feature requests and bugs related to the WebExtension add-on API.
[See Open Bugs in This Product](/buglist.cgi?product=WebExtensions&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=WebExtensions)
Watch This Product

[Component:](/describecomponents.cgi?product=WebExtensions&component=Untriaged#Untriaged)

Untriaged
▾

WebExtensions :: Untriaged
File feature requests and bugs related to the WebExtension add-on API.
[See Open Bugs in This Component](/buglist.cgi?product=WebExtensions&component=Untriaged&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=WebExtensions&component=Untriaged&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=WebExtensions&component=Untriaged)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

60 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### (firefox-esr52- wontfix, firefox59 wontfix, firefox60+ verified, firefox61+ verified)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla61

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr52 | [-](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=wontfix) |
| firefox59 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox59&o1=equals&v1=wontfix) |
| firefox60 | [+](/buglist.cgi?f1=cf_tracking_firefox60&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=verified) |
| firefox61 | [+](/buglist.cgi?f1=cf_tracking_firefox61&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr52 | - | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox59 |  | wontfix |
| firefox60 | + | verified |
| firefox61 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

[Blocking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Blocking_Flags)

| webextensions | --- |
| --- | --- |

## People

### (Reporter: qab, Assigned: zombie)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=40)  [zombie](/user_profile?user_id=445095)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1cea46da7dbb1ab6b82e8c1421e4ee70?d=mm&size=40)  [qab](/user_profile?user_id=550582)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e2fa737f7938f690847d2f5eeea87025?d=mm&size=40)  [willdurand](/user_profile?user_id=603050)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-spoof, reporter-external, sec-moderate, Whiteboard: [adv-main60+][post-critsmash-triage])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2018-5173

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main60+][post-critsmash-triage]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a4131761_1689 "7 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [zombie](/user_profile?user_id=445095) | [in-testsuite](#c26 "7 years ago") | ? |
| --- | --- | --- |
| [zombie](/user_profile?user_id=445095) | in-testsuite | ? |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 3 obsolete files)

| [PoC](/attachment.cgi?id=8950753)  [7 years ago](#c0)  [Abdulrahman Alqabandi](/user_profile?user_id=550582)   826 bytes, application/zip |  | [Details](/attachment.cgi?id=8950753&action=edit) |
| --- | --- | --- |
| [pef.png](/attachment.cgi?id=8951754)  [7 years ago](#c2)  [Abdulrahman Alqabandi](/user_profile?user_id=550582)   9.05 KB, image/png |  | [Details](/attachment.cgi?id=8951754&action=edit) |
| [fix-1438025.patch](/attachment.cgi?id=8961201)  [7 years ago](#c7)  [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)   821 bytes, patch | Paolo : [review+](#c9 "7 years ago") | [Details](/attachment.cgi?id=8961201&action=edit) | [Diff](/attachment.cgi?id=8961201&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8961201) |
| [fix-1438025-v2.patch](/attachment.cgi?id=8962075)  [7 years ago](#c10)  [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)   1.47 KB, patch | kmag : [review+](#c13 "7 years ago")  Paolo : [review+](#c12 "7 years ago") | [Details](/attachment.cgi?id=8962075&action=edit) | [Diff](/attachment.cgi?id=8962075&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8962075) |
| [test-1438025-v2.patch](/attachment.cgi?id=8962076)  [7 years ago](#c11)  [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)   1.88 KB, patch | kmag : [review+](#a3358861_106098 "7 years ago") | [Details](/attachment.cgi?id=8962076&action=edit) | [Diff](/attachment.cgi?id=8962076&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8962076) |
| [fix-1438025-v3.patch](/attachment.cgi?id=8962099)  [7 years ago](#c15)  [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)   1.48 KB, patch | zombie : [review+](#a3371243_445095 "7 years ago")  RyanVM : [approval-mozilla-beta+](#c24 "7 years ago")  RyanVM : [checkin+](#c21 "7 years ago") | [Details](/attachment.cgi?id=8962099&action=edit) | [Diff](/attachment.cgi?id=8962099&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8962099) |
| [test-1438025-v3.patch](/attachment.cgi?id=8962100)  [7 years ago](#c16)  [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)   2.02 KB, patch | zombie : [review+](#c17 "7 years ago") | [Details](/attachment.cgi?id=8962100&action=edit) | [Diff](/attachment.cgi?id=8962100&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8962100) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Abdulrahman Alqabandi](/user_profile?user_id=550582)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1438025#c0)• 7 years ago |
|  | |

Attached file
[PoC](attachment.cgi?id=8950753)
— [Details](attachment.cgi?id=8950753&action=edit)

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36
Steps to reproduce:
Added "\u202E" to a filename passed to downloads.download() results in a filename spoof.
Actual results:
Downloading with filename="test\u202Egpj.bat" results in a filename appearing to be "testtab.jpg" in the downloads panel.
When attempting to open this file, the prompt that appears reminding user that this is an executable is all reversed text and illegible.
Expected results:
Strip "\u202E"

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1438025#c1)• 7 years ago |
|  | |

Is this really a "web extension" issue? Can you do the same thing using the HTML download= attribute or Content-Disposition: attachment? It's the same download panel AFAIK.
In the end wouldn't we warn that it's an executable type still? (yes, you've filed other bugs wrt that. I meant usually)Flags: needinfo?(qab)Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Abdulrahman Alqabandi](/user_profile?user_id=550582)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1438025#c2)• 7 years ago |
|  | |

Attached image
[pef.png](attachment.cgi?id=8951754)
— [Details](attachment.cgi?id=8951754&action=edit)

(In reply to Daniel Veditz [:dveditz] from [comment #1](/show_bug.cgi?id=1438025#c1 "VERIFIED FIXED - browser.downloads.download should remove \u202E (RLO) chars"))
> Is this really a "web extension" issue? Can you do the same thing using the
> HTML download= attribute or Content-Disposition: attachment? It's the same
> download panel AFAIK.
Unless I am missing something but I could not reproduce using an anchor tag download or 'Content-Disposition' header. It looks like in those cases the RLO character is stripped.
> In the end wouldn't we warn that it's an executable type still? (yes, you've
> filed other bugs wrt that. I meant usually)
Yes, the usual 'Open executable file?' prompt appears but like I mentioned its text is reversed since its trying to display the filename that contains the RLO char. (Check attached screenshot)
Also, mark of the web does apply here too.Flags: needinfo?(qab)

|  | [David Durst [:ddurst]](/user_profile?user_id=500559) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1438025#a1374716_500559)• 7 years ago |

Assignee: nobody → tomicaPriority: -- → P2

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1438025#c3)• 7 years ago |
|  | |

Zombie, I think this bug might interest you. There are a few other places where we need to encode special characters like this already:
<https://searchfox.org/mozilla-central/rev/769222fadff46164f8cc0dc7a0bae5a60dc2f335/browser/base/content/browser.js#4415>
<https://searchfox.org/mozilla-central/rev/769222fadff46164f8cc0dc7a0bae5a60dc2f335/browser/base/content/browser.js#2799-2810>
It would be nice to have a centralized helper to handle this, and then apply it in the above two places as well as the download manager UI (and probably a bunch of other places, too...)Assignee: tomica → nobodyFlags: needinfo?(tomica)

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1438025#c4)• 7 years ago |
|  | |

> it in the above two places as well as the download manager UI
You don't think we should nerf the actual filename, only when we display it in the UI? That seems prone to error.
> (and probably a bunch of other places, too...)
uh, that's a little open-ended.Assignee: nobody → tomicaStatus: UNCONFIRMED → ASSIGNEDEver confirmed: trueFlags: needinfo?(tomica)

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1438025#c5)• 7 years ago |
|  | |

(In reply to Tomislav Jovanovic :zombie from [comment #4](/show_bug.cgi?id=1438025#c4 "VERIFIED FIXED - browser.downloads.download should remove \u202E (RLO) chars"))
> > it in the above two places as well as the download manager UI
> You don't think we should nerf the actual filename, only when we display it
> in the UI? That seems prone to error.
Don't particularly care about the filename. That's really up to the OS to deal with. But I don't really object to it.
> > (and probably a bunch of other places, too...)
> uh, that's a little open-ended.
It's a lot open ended, really. I'm not sure how far we should go with this, but it's potentially a problem anywhere we display strings from untrusted sources. Extension install dialogs, for instance.
I just mention it for completeness. At this point, I'm mainly just looking to fix this instance and have a starting point for fixing the rest.

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1438025#c6)• 7 years ago |
|  | |

I have a patch to escape BIDI characters in the Downloads Panel and the "Open Executable File" dialog, but after further investigation, I'm not sure that's the right place to handle this.
Quoting from section 4.1 of <https://www.ietf.org/rfc/rfc3987.txt>
> [...] IRIs MUST NOT contain bidirectional formatting characters
> (LRM, RLM, LRE, RLE, LRO, RLO, and PDF). They affect the visual
> rendering of the IRI but do not appear themselves. It would
> therefore not be possible to input an IRI with such characters
> correctly.
We seem to already %encode BIDI characters in URIs, and that probably explains why other approaches from [comment 1](/show_bug.cgi?id=1438025#c1 "VERIFIED FIXED - browser.downloads.download should remove \u202E (RLO) chars") don't work, so the only remaining way they could appear in the Downloads UI is from extensions.
And since the whole design of the downloads API is to support functionality already possible using the browser, I don't think we should even try to encode/filter BIDI characters, but instead simply throw on them, just like we do for other special characters:
<https://searchfox.org/mozilla-central/rev/b29daa/toolkit/components/extensions/ext-downloads.js#433-435>

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1438025#c7)• 7 years ago |
|  | |

Attached patch

[fix-1438025.patch](attachment.cgi?id=8961201&action=diff) (obsolete)
— [Details](attachment.cgi?id=8961201&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8961201)

This patch strips all BIDI characters from the filename in the DownloadPaths.santize() method.
ext-downloads code will note that sanitized filename is different from the original, and throw:
<https://searchfox.org/mozilla-central/rev/b29daa/toolkit/components/extensions/ext-downloads.js#433>
I believe other non-extension uses of Downloads already strip or escape BIDI characters before getting to this stage, but in case some of them slip, this will serve as belt+suspenders.
No comments or tests in this patch, and the commit message is vague while technically correct. I'm adding Paolo as a reviewer, since the patch is in toolkit/downloads code.
[Attachment #8961201](/attachment.cgi?id=8961201&action=edit "fix-1438025.patch") -
Flags: review?(kmaglione+bmo)

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1438025#a3112996_445095)• 7 years ago |

[Attachment #8961201](/attachment.cgi?id=8961201&action=edit "fix-1438025.patch") -
Flags: review?(paolo.mozmail)

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1438025#c8)• 7 years ago |
|  | |

(In reply to Kris Maglione [:kmag] (long backlog; ping on IRC if you're blocked) from [comment #3](/show_bug.cgi?id=1438025#c3 "VERIFIED FIXED - browser.downloads.download should remove \u202E (RLO) chars"))
> It would be nice to have a centralized helper to handle this, and then apply
> it in the above two places as well as the download manager UI
Forgot to note, I would rather refactor unrelated code in a followup bug (6 weeks after this), where I'll be able to add both tests and comments, and safely use Try.

|  | [:Paolo Amadini](/user_profile?user_id=332229) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1438025#c9)• 7 years ago |
|  | |

Comment on [attachment 8961201](/attachment.cgi?id=8961201 "fix-1438025.patch") [[details]](/attachment.cgi?id=8961201&action=edit "fix-1438025.patch") [[diff]](/attachment.cgi?id=8961201&action=diff "fix-1438025.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8961201)
fix-1438025.patch
Looks good to me. I guess we may find out that we regress file names with mixed scripts, but it's probably a necessary compromise at the moment.
I don't see a reason not to land a test at the same time, since it's obvious which characters we're stripping anyways. In particular it can be useful to test that things are done in the right order, for example "\u200e \u202b\u202c\u202d\u202etest\x7f\u200f" should become "test" with no spaces around it.
We can still consider leaving detailed comments to a later patch, but we should definitely add them eventually, in order to explain why this change can't just be reverted to make mixed scripts work. I recommend preparing a separate patch with the comments.
[Attachment #8961201](/attachment.cgi?id=8961201&action=edit "fix-1438025.patch") -
Flags: review?(paolo.mozmail) → review+

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1438025#c10)• 7 years ago |
|  | |

Attached patch

[fix-1438025-v2.patch](attachment.cgi?id=8962075&action=diff) (obsolete)
— [Details](attachment.cgi?id=8962075&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8962075)

(In reply to :Paolo Amadini from [comment #9](/show_bug.cgi?id=1438025#c9 "VERIFIED FIXED - browser.downloads.download should remove \u202E (RLO) chars"))
> Looks good to me. I guess we may find out that we regress file names with
> mixed scripts, but it's probably a necessary compromise at the moment.
This won't regress most of filenames with mixed scripts. I tested the "common" way they can appear in document titles, and words using "strong bidi characters" still preserve the correct ordering, for example:
Your search "הצהרות" didn't match anything.
which is a Hebrew word in the middle of an English title, and works as expected. What doesn't work is using explicit BIDI formatting characters, which is so rarely done, that my file manager (Total Commander) simply refuses to execute such files with the message:
WARNING: The filename contains characters typical for a virus/worm. Function aborted.
I believe we are in good company here.
> I don't see a reason not to land a test at the same time, since it's obvious
> which characters we're stripping anyways.
Oh, my original instinct was to test this in web extensions test, which would clearly point to the current known way of exploiting this. But I think landing a unit test for toolkit/downloads is much safer, so I included it in the updated patch.
> In particular it can be useful to test that things are done in the right order,
> for example "\u200e\u202b\u202c\u202d\u202etest\x7f\u200f" should become "test"
> with no spaces around it.
Good thinking. This example did work as expected, but multiple illegal chars that get converted to space, separated by a bidi character didn't, so I reordered the operations in the updated patch.
> We can still consider leaving detailed comments to a later patch, but we
> should definitely add them eventually, in order to explain why this change
> can't just be reverted to make mixed scripts work. I recommend preparing a
> separate patch with the comments.
Added comments to the other patch that also includes the web extensions test (to land in 6 weeks).
[Attachment #8961201](/attachment.cgi?id=8961201&action=edit "fix-1438025.patch") -
Attachment is obsolete: true
[Attachment #8961201](/attachment.cgi?id=8961201&action=edit "fix-1438025.patch") -
Flags: review?(kmaglione+bmo)
[Attachment #8962075](/attachment.cgi?id=8962075&action=edit "fix-1438025-v2.patch") -
Flags: review?(kmaglione+bmo)

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1438025#a3357044_445095)• 7 years ago |

[Attachment #8962075](/attachment.cgi?id=8962075&action=edit "fix-1438025-v2.patch") -
Flags: review?(paolo.mozmail)

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1438025#c11)• 7 years ago |
|  | |

Attached patch

[test-1438025-v2.patch](attachment.cgi?id=8962076&action=diff) (obsolete)
— [Details](attachment.cgi?id=8962076&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8962076)

Comment and test, for landing in 6 weeks.
[Attachment #8962076](/attachment.cgi?id=8962076&action=edit "test-1438025-v2.patch") -
Flags: review?(kmaglione+bmo)

|  | [:Paolo Amadini](/user_profile?user_id=332229) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1438025#c12)• 7 years ago |
|  | |

Comment on [attachment 8962075](/attachment.cgi?id=8962075 "fix-1438025-v2.patch") [[details]](/attachment.cgi?id=8962075&action=edit "fix-1438025-v2.patch") [[diff]](/attachment.cgi?id=8962075&action=diff "fix-1438025-v2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8962075)
fix-1438025-v2.patch
Review of [attachment 8962075](/attachment.cgi?id=8962075 "fix-1438025-v2.patch") [[details]](/attachment.cgi?id=8962075&action=edit "fix-1438025-v2.patch") [[diff]](/attachment.cgi?id=8962075&action=diff "fix-1438025-v2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8962075):
-----------------------------------------------------------------
Thanks for the details about mixed scripts in [comment 10](/show_bug.cgi?id=1438025#c10 "VERIFIED FIXED - browser.downloads.download should remove \u202E (RLO) chars")! I would add a short note in the other patch about these characters being rare and not necessary to render mixed scripts correctly.
::: toolkit/components/downloads/test/unit/test\_DownloadPaths.js
@@ +79,5 @@
> testSanitize(" . ", "");
> +
> + // Stripping of BIDI formatting characters.
> + testSanitize("\u200e\u202b\u202c\u202d\u202etest\x7f\u200f", "test");
> + testSanitize("AB\x7f\u202e\x7f\u202e\x7fCD", "AB CD");
And thanks for the second test case and associated fix too!
Let's put \u202a somewhere for completeness, I forgot it in the example.
[Attachment #8962075](/attachment.cgi?id=8962075&action=edit "fix-1438025-v2.patch") -
Flags: review?(paolo.mozmail) → review+

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1438025#c13)• 7 years ago |
|  | |

Comment on [attachment 8962075](/attachment.cgi?id=8962075 "fix-1438025-v2.patch") [[details]](/attachment.cgi?id=8962075&action=edit "fix-1438025-v2.patch") [[diff]](/attachment.cgi?id=8962075&action=diff "fix-1438025-v2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8962075)
fix-1438025-v2.patch
Review of [attachment 8962075](/attachment.cgi?id=8962075 "fix-1438025-v2.patch") [[details]](/attachment.cgi?id=8962075&action=edit "fix-1438025-v2.patch") [[diff]](/attachment.cgi?id=8962075&action=diff "fix-1438025-v2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8962075):
-----------------------------------------------------------------
Thanks
[Attachment #8962075](/attachment.cgi?id=8962075&action=edit "fix-1438025-v2.patch") -
Flags: review?(kmaglione+bmo) → review+

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1438025#a3358861_106098)• 7 years ago |

[Attachment #8962076](/attachment.cgi?id=8962076&action=edit "test-1438025-v2.patch") -
Flags: review?(kmaglione+bmo) → review+

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1438025#c14)• 7 years ago |
|  | |

Hey Daniel, this bug is (likely) present in previous ESR 52, but the fix would need to be in a different part of the code, which more clearly hints at what the exploit is.
Since this is sec-moderate, Kris suggested we should only uplift to current beta, which will be the next ESR 60 in a ~month. Are you ok with that? And if so, does this bug need sec-approval to uplift to beta?Flags: needinfo?(dveditz)

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1438025#c15)• 7 years ago |
|  | |

Attached patch

[fix-1438025-v3.patch](attachment.cgi?id=8962099&action=diff)
— [Details](attachment.cgi?id=8962099&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8962099)

[Attachment #8962075](/attachment.cgi?id=8962075&action=edit "fix-1438025-v2.patch") -
Attachment is obsolete: true

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1438025#c16)• 7 years ago |
|  | |

Attached patch

[test-1438025-v3.patch](attachment.cgi?id=8962100&action=diff)
— [Details](attachment.cgi?id=8962100&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8962100)

[Attachment #8962076](/attachment.cgi?id=8962076&action=edit "test-1438025-v2.patch") -
Attachment is obsolete: true

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1438025#a3371243_445095)• 7 years ago |

[Attachment #8962099](/attachment.cgi?id=8962099&action=edit "fix-1438025-v3.patch") -
Flags: review+

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1438025#c17)• 7 years ago |
|  | |

Comment on [attachment 8962100](/attachment.cgi?id=8962100 "test-1438025-v3.patch") [[details]](/attachment.cgi?id=8962100&action=edit "test-1438025-v3.patch") [[diff]](/attachment.cgi?id=8962100&action=diff "test-1438025-v3.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8962100)
test-1438025-v3.patch
carried over
[Attachment #8962100](/attachment.cgi?id=8962100&action=edit "test-1438025-v3.patch") -
Flags: review+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1438025#c18)• 7 years ago |
|  | |

(In reply to Tomislav Jovanovic :zombie from [comment #14](/show_bug.cgi?id=1438025#c14 "VERIFIED FIXED - browser.downloads.download should remove \u202E (RLO) chars"))
> Since this is sec-moderate, Kris suggested we should only uplift to current
> beta, which will be the next ESR 60 in a ~month. Are you ok with that?
I can live with that (though note that ESR-52 will be supported for another 3 months after 60 is released)
> if so, does this bug need sec-approval to uplift to beta?
It doesn't need sec-approval to land (on nightly) but you do need to request normal approval to land on beta.
[status-firefox59](/buglist.cgi?f1=cf_status_firefox59&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox59&o1=equals&v1=wontfix)
[status-firefox60](/buglist.cgi?f1=cf_status_firefox60&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=affected)
[status-firefox61](/buglist.cgi?f1=cf_status_firefox61&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=affected)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected)
[tracking-firefox60](/buglist.cgi?f1=cf_tracking_firefox60&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox60&o1=equals&v1=%2B)
[tracking-firefox61](/buglist.cgi?f1=cf_tracking_firefox61&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox61&o1=equals&v1=%2B)
[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
--- → [-](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=-)Flags: needinfo?(dveditz)

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1438025#c19)• 7 years ago |
|  | |

Thanks Daniel.Keywords: [leave-open](/buglist.cgi?keywords=leave-open&resolution=---)

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1438025#c20)• 7 years ago |
|  | |

Comment on [attachment 8962099](/attachment.cgi?id=8962099 "fix-1438025-v3.patch") [[details]](/attachment.cgi?id=8962099&action=edit "fix-1438025-v3.patch") [[diff]](/attachment.cgi?id=8962099&action=diff "fix-1438025-v3.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8962099)
fix-1438025-v3.patch
Sheriffs: please land only this patch, and leave the bug open.
[Attachment #8962099](/attachment.cgi?id=8962099&action=edit "fix-1438025-v3.patch") -
Flags: checkin?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1438025#c21)• 7 years ago |
|  | |

Comment on [attachment 8962099](/attachment.cgi?id=8962099 "fix-1438025-v3.patch") [[details]](/attachment.cgi?id=8962099&action=edit "fix-1438025-v3.patch") [[diff]](/attachment.cgi?id=8962099&action=diff "fix-1438025-v3.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8962099)
fix-1438025-v3.patch
<https://hg.mozilla.org/integration/mozilla-inbound/rev/9728993469256a713ec5e8b953f2ea01089d250c>
[Attachment #8962099](/attachment.cgi?id=8962099&action=edit "fix-1438025-v3.patch") -
Flags: checkin? → checkin+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1438025#c22)• 7 years ago |
|  | |

Merged to m-c:
<https://hg.mozilla.org/mozilla-central/rev/972899346925>

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1438025#c23)• 7 years ago |
|  | |

Comment on [attachment 8962099](/attachment.cgi?id=8962099 "fix-1438025-v3.patch") [[details]](/attachment.cgi?id=8962099&action=edit "fix-1438025-v3.patch") [[diff]](/attachment.cgi?id=8962099&action=diff "fix-1438025-v3.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8962099)
fix-1438025-v3.patch
> Approval Request Comment
> [Feature/Bug causing the regression]:
N/A
> [User impact if declined]:
Filename extension spoofing by extensions.
> [Is this code covered by automated tests?]:
Yes
> [Has the fix been verified in Nightly?]:
Yes
> [Needs manual test from QE? If yes, steps to reproduce]:
Not sure if QA could try downloading files from some popular RTL download websites (Arabic, Hebrew...), to check my assumptions from [comment 10](/show_bug.cgi?id=1438025#c10 "VERIFIED FIXED - browser.downloads.download should remove \u202E (RLO) chars").
> [List of other uplifts needed for the feature/fix]:
None
> [Is the change risky?]:
Not exactly.
> [Why is the change risky/not risky?]:
We know it \_will\_ break some use-cases (see [comment 10](/show_bug.cgi?id=1438025#c10 "VERIFIED FIXED - browser.downloads.download should remove \u202E (RLO) chars")), but we believe they are rare, and have evaluated that is an acceptable trade-off in the name of security.
> [String changes made/needed]:
None
[Attachment #8962099](/attachment.cgi?id=8962099&action=edit "fix-1438025-v3.patch") -
Flags: approval-mozilla-beta?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1438025#c24)• 7 years ago |
|  | |

Comment on [attachment 8962099](/attachment.cgi?id=8962099 "fix-1438025-v3.patch") [[details]](/attachment.cgi?id=8962099&action=edit "fix-1438025-v3.patch") [[diff]](/attachment.cgi?id=8962099&action=diff "fix-1438025-v3.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1438025&attachment=8962099)
fix-1438025-v3.patch
Approved for 60.0b8.
[Attachment #8962099](/attachment.cgi?id=8962099&action=edit "fix-1438025-v3.patch") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1438025#c25)• 7 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/4702ec51711e>Status: ASSIGNED → RESOLVEDClosed: 7 years ago
[status-firefox60](/buglist.cgi?f1=cf_status_firefox60&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=fixed)
[status-firefox61](/buglist.cgi?f1=cf_status_firefox61&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=fixed)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=wontfix)Flags: in-testsuite?Keywords: [leave-open](/buglist.cgi?keywords=leave-open&resolution=---)Resolution: --- → FIXEDTarget Milestone: --- → mozilla61

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1438025#a3708371_280903)• 7 years ago |

Flags: sec-bounty?

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1438025#a3708573_445095)• 7 years ago |

Flags: in-testsuite?

|  | [Tomislav Jovanovic :zombie](/user_profile?user_id=445095)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1438025#c26)• 7 years ago |
|  | |

adding flag for myself..Flags: in-testsuite?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1438025#a4131761_1689)• 7 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1438025#a4148332_1689)• 7 years ago |

Group: toolkit-core-security → core-security-release

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1438025#a6308942_280903)• 7 years ago |

Whiteboard: [adv-main60+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1438025#a6582236_280903)• 7 years ago |

Alias: CVE-2018-5173

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1438025#a6711849_488993)• 7 years ago |

Flags: qe-verify+Whiteboard: [adv-main60+] → [adv-main60+][post-critsmash-triage]

|  | [Emil Ghitta, QA [:emilghitta]](/user_profile?user_id=588744) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1438025#c27)• 7 years ago |
|  | |

I have managed to reproduce this issue using Firefox 60.0a1 (BuildId:20180213220104).
This issue is verified fixed using Firefox 61.0a1 (BuildId:20180503220110) and Firefox 60.0 (BuildId:20180430165945) on Windows 10 64bit.Status: RESOLVED → VERIFIED
[status-firefox60](/buglist.cgi?f1=cf_status_firefox60&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=verified)
[status-firefox61](/buglist.cgi?f1=cf_status_firefox61&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=verified)Flags: qe-verify+

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1438025#a10879204_546015)• 7 years ago |

Product: Toolkit → WebExtensions

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1438025#a22897148_1689)• 6 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1438025#a198527878_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1438025&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Abdulrahman Alqabandi](/user_profile?user_id=550582)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_9f5af0e2_20250126_050648.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1449548)
* [XML](/show_bug.cgi?ctype=xml&id=1449548)

Closed
[Bug 1449548](/show_bug.cgi?id=1449548)
(CVE-2018-5168)

Opened 7 years ago
Closed 7 years ago

# Lightweight themes can be installed automatically, without user's consent

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Lightweight themes can be installed automatically, without user's consent

## Categories

### (Toolkit :: Add-ons Manager, defect)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Add-ons%20Manager#Add-ons%20Manager)

Add-ons Manager
▾

Toolkit :: Add-ons Manager
The management and update windows for extensions and themes (add-ons).
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Add-ons%20Manager&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Add-ons%20Manager&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Add-ons%20Manager)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla61

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr52 | [60+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=60%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=verified) |
| firefox59 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox59&o1=equals&v1=wontfix) |
| firefox60 | [+](/buglist.cgi?f1=cf_tracking_firefox60&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=verified) |
| firefox61 | [+](/buglist.cgi?f1=cf_tracking_firefox61&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr52 | 60+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox59 |  | wontfix |
| firefox60 | + | verified |
| firefox61 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jwkbugzilla, Assigned: Gijs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/bd1b9ed4ddafb4e94ca9ec218f77fdb4?d=mm&size=40)  [jwkbugzilla](/user_profile?user_id=109976)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e2fa737f7938f690847d2f5eeea87025?d=mm&size=40)  [willdurand](/user_profile?user_id=603050)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-priv-escalation, reporter-external, sec-moderate, Whiteboard: [adv-main60+][adv-esr52.8+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2018-5168

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main60+][adv-esr52.8+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1056964_1689 "7 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [Proof of concept page](/attachment.cgi?id=8963092)  [7 years ago](#c0)  [Wladimir Palant](/user_profile?user_id=109976)   1.69 KB, text/html |  | [Details](/attachment.cgi?id=8963092&action=edit) |
| --- | --- | --- |
| [Patch v0.1](/attachment.cgi?id=8963107)  [7 years ago](#c3)  [:Gijs (he/him)](/user_profile?user_id=159069)   8.09 KB, patch | aswan : [review+](#c11 "7 years ago")  mconley : [review+](#c7 "7 years ago")  RyanVM : [approval-mozilla-beta+](#c15 "7 years ago") | [Details](/attachment.cgi?id=8963107&action=edit) | [Diff](/attachment.cgi?id=8963107&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1449548&attachment=8963107) |
| [Patch for esr](/attachment.cgi?id=8965509)  [7 years ago](#c17)  [:Gijs (he/him)](/user_profile?user_id=159069)   8.29 KB, patch | Gijs : [review+](#c17 "7 years ago")  RyanVM : [approval-mozilla-esr52+](#c18 "7 years ago") | [Details](/attachment.cgi?id=8965509&action=edit) | [Diff](/attachment.cgi?id=8965509&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1449548&attachment=8965509) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Wladimir Palant](/user_profile?user_id=109976)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1449548#c0)• 7 years ago |
|  | |

Attached file
[Proof of concept page](attachment.cgi?id=8963092)
— [Details](attachment.cgi?id=8963092&action=edit)

The security checks determining which websites are allowed to install lightweight themes and particularly which are allowed to install them without user's consent are based on the baseURI property of the theme element. Unlike the document URI, this property can be easily manipulated - e.g. by using a <base href="..."> tag. This is what the attached proof of concept page does - opening it will immediately install a theme named "Hacked you" because the security checks consider that page to be discovery.addons.mozilla.org. This is also problematic in light of [bug 527463](/show_bug.cgi?id=527463 "RESOLVED INVALID - Update checks for lightweight themes should not happen for non-whitelisted sites"): a theme might not even change the appearance of Firefox but invisibly track the user via updateURL instead.

|  | [Wladimir Palant](/user_profile?user_id=109976)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1449548#c1)• 7 years ago |
|  | |

Forgot to mention, I reproduced this in Firefox 61.0a1 (2018-03-28) nightly on Linux.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1449548#c2)• 7 years ago |
|  | |

(In reply to Wladimir Palant (for Adblock Plus info Cc bugzilla@adblockplus.org) from [comment #0](/show_bug.cgi?id=1449548#c0 "VERIFIED FIXED - Lightweight themes can be installed automatically, without user's consent"))
> Unlike the document URI, this property can be easily manipulated
Using the document URI would still be wrong. We've audited for this in the past. Ugh.Assignee: nobody → gijskruitbosch+bugsStatus: NEW → ASSIGNED

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1449548#c3)• 7 years ago |
|  | |

Attached patch

[Patch v0.1](attachment.cgi?id=8963107&action=diff)
— [Details](attachment.cgi?id=8963107&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1449548&attachment=8963107)

[Attachment #8963107](/attachment.cgi?id=8963107&action=edit "Patch v0.1") -
Flags: review?(mconley)
[Attachment #8963107](/attachment.cgi?id=8963107&action=edit "Patch v0.1") -
Flags: review?(aswan)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1449548#c4)• 7 years ago |
|  | |

Comment on [attachment 8963107](/attachment.cgi?id=8963107 "Patch v0.1") [[details]](/attachment.cgi?id=8963107&action=edit "Patch v0.1") [[diff]](/attachment.cgi?id=8963107&action=diff "Patch v0.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1449548&attachment=8963107)
Patch v0.1
Review of [attachment 8963107](/attachment.cgi?id=8963107 "Patch v0.1") [[details]](/attachment.cgi?id=8963107&action=edit "Patch v0.1") [[diff]](/attachment.cgi?id=8963107&action=diff "Patch v0.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1449548&attachment=8963107):
-----------------------------------------------------------------
::: browser/base/content/browser-addons.js
@@ +667,4 @@
> return false;
> }
>
> + if (!principal.URI.schemeIs("https")) {
Self-nit: this can probably be unified with the previous condition.
@@ +674,5 @@
> let pm = Services.perms;
> + return pm.testPermission(principal.URI, "install") == pm.ALLOW\_ACTION;
> + },
> +
> + \_showUndoPrompt(principal) {
Self-nit: should probably call this \_shouldShowUndoPrompt. Also, perhaps it's better off being re-inlined into the 1 callsite. \*shrug\*. Up to y'all what you think is better.

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1449548#c5)• 7 years ago |
|  | |

Out of curiosity, how did you find this? I would like us to audit for more mistaken checks here, but it's not clear to me how to go about that - obviously not all uses of 'baseURI' are suspect, and there are rather a lot of them. :-\
Separately, we're already looking at how to do a better job of doing a unified set of security checks for things like this, which would have helped... See also discussion at <https://groups.google.com/forum/?fromgroups=&hl=en#!topic/firefox-dev/naSYfA-e2Jw> , for which (coincidentally) there's a meeting later today.Flags: needinfo?(gaubugzilla)

|  | [Wladimir Palant](/user_profile?user_id=109976)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1449548#c6)• 7 years ago |
|  | |

(In reply to :Gijs from [comment #5](/show_bug.cgi?id=1449548#c5 "VERIFIED FIXED - Lightweight themes can be installed automatically, without user's consent"))
> Out of curiosity, how did you find this?
Nothing fancy - I am going through all code interacting with web pages, looking for wrong assumptions. In particular, this means all addEventListener(...,...,...,true) calls.Flags: needinfo?(gaubugzilla)

|  | [Mike Conley (:mconley) (:⚙️)](/user_profile?user_id=403756) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1449548#c7)• 7 years ago |
|  | |

Comment on [attachment 8963107](/attachment.cgi?id=8963107 "Patch v0.1") [[details]](/attachment.cgi?id=8963107&action=edit "Patch v0.1") [[diff]](/attachment.cgi?id=8963107&action=diff "Patch v0.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1449548&attachment=8963107)
Patch v0.1
Review of [attachment 8963107](/attachment.cgi?id=8963107 "Patch v0.1") [[details]](/attachment.cgi?id=8963107&action=edit "Patch v0.1") [[diff]](/attachment.cgi?id=8963107&action=diff "Patch v0.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1449548&attachment=8963107):
-----------------------------------------------------------------
Good catch, Wladimir, and thanks for hopping on this, Gijs.
Patch looks good to me - though I wonder if we need to be sending baseURI at all now.
::: browser/base/content/content.js
@@ +999,5 @@
> handleEvent(event) {
> switch (event.type) {
> case "InstallBrowserTheme": {
> sendAsyncMessage("LightWeightThemeWebInstaller:Install", {
> baseURI: event.target.baseURI,
Should we even keep sending the baseURI here? Looking at the patch and the rest of LightweightThemeManager.jsm, it looks like it's only used by \_sanitizeTheme... maybe we should use the principal URI there as well instead?
@@ +1007,5 @@
> break;
> }
> case "PreviewBrowserTheme": {
> sendAsyncMessage("LightWeightThemeWebInstaller:Preview", {
> baseURI: event.target.baseURI,
Same as above.
[Attachment #8963107](/attachment.cgi?id=8963107&action=edit "Patch v0.1") -
Flags: review?(mconley) → review+

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1449548#c8)• 7 years ago |
|  | |

(In reply to Mike Conley (:mconley) (:⚙️) (Totally backlogged on reviews and needinfos) from [comment #7](/show_bug.cgi?id=1449548#c7 "VERIFIED FIXED - Lightweight themes can be installed automatically, without user's consent"))
> Should we even keep sending the baseURI here? Looking at the patch and the
> rest of LightweightThemeManager.jsm, it looks like it's only used by
> \_sanitizeTheme... maybe we should use the principal URI there as well
> instead?
It gets used to resolve relative URIs in the theme, and nothing else AFAICT. So if the theme specified a background image as 'foo.jpg', it'd get resolved against the base URI defined in the document that specified the lwtheme. I think that's probably fine, and potentially needs to keep doing what it's doing to avoid a case where some webpage hypothetically had:
// on www.foo.com/mythemes/
<base href="mythemeresources/">
<body data-lwthemestuff="... foo.jpg">
because if we use the principal's URI that won't use the baseURI, and so the image URIs won't resolve correctly.
It's an edgecase, but because this isn't technically a security check, I think it's OK.

|  | [Mike Conley (:mconley) (:⚙️)](/user_profile?user_id=403756) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1449548#c9)• 7 years ago |
|  | |

Makes sense, okay. Thanks.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1449548#c10)• 7 years ago |
|  | |

Once again bitten in the butt by giving special powers to our own web pages.
The actual security damage here is low (easily reset from the addons dialog) but the potential reputational damage could be horrible if script-kiddies weaponize competing offensive images and spread via malicious ads.
[status-firefox59](/buglist.cgi?f1=cf_status_firefox59&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox59&o1=equals&v1=wontfix)
[status-firefox60](/buglist.cgi?f1=cf_status_firefox60&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=affected)
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected)
[tracking-firefox60](/buglist.cgi?f1=cf_tracking_firefox60&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox60&o1=equals&v1=%2B)
[tracking-firefox61](/buglist.cgi?f1=cf_tracking_firefox61&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox61&o1=equals&v1=%2B)
[tracking-firefox-esr52](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=isnotempty):
--- → [60+](/buglist.cgi?f1=cf_tracking_firefox_esr52&o1=equals&v1=60%2B)Flags: sec-bounty?Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Andrew Swan [:aswan]](/user_profile?user_id=561655) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1449548#c11)• 7 years ago |
|  | |

Comment on [attachment 8963107](/attachment.cgi?id=8963107 "Patch v0.1") [[details]](/attachment.cgi?id=8963107&action=edit "Patch v0.1") [[diff]](/attachment.cgi?id=8963107&action=diff "Patch v0.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1449548&attachment=8963107)
Patch v0.1
Review of [attachment 8963107](/attachment.cgi?id=8963107 "Patch v0.1") [[details]](/attachment.cgi?id=8963107&action=edit "Patch v0.1") [[diff]](/attachment.cgi?id=8963107&action=diff "Patch v0.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1449548&attachment=8963107):
-----------------------------------------------------------------
I assume you flagged me for the webapi.testing bits, r=me on that.
Between Gijs and mconley I think the baseURI/principal bits have been carefully thought through but if you want another reviewer with a deep enough understanding to spot potential issues, I don't think I have the depth to provide that...
[Attachment #8963107](/attachment.cgi?id=8963107&action=edit "Patch v0.1") -
Flags: review?(aswan) → review+

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1449548#c12)• 7 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/a578a9117c193ecfd6c7abdca5fbb841e46155ab>

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1449548#c13)• 7 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/a578a9117c19>Status: ASSIGNED → RESOLVEDClosed: 7 years ago
[status-firefox61](/buglist.cgi?f1=cf_status_firefox61&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla61

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1449548#c14)• 7 years ago |
|  | |

Comment on [attachment 8963107](/attachment.cgi?id=8963107 "Patch v0.1") [[details]](/attachment.cgi?id=8963107&action=edit "Patch v0.1") [[diff]](/attachment.cgi?id=8963107&action=diff "Patch v0.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1449548&attachment=8963107)
Patch v0.1
Approval Request Comment
[Feature/Bug causing the regression]: n/a
[User impact if declined]: security issue where people can driveby-install lightweight themes
[Is this code covered by automated tests?]: generally yes, in <https://dxr.mozilla.org/mozilla-central/source/browser/base/content/test/general/browser_bug592338.js> .
[Has the fix been verified in Nightly?]: not yet
[Needs manual test from QE? If yes, steps to reproduce]:
1. open testcase on this bug
2. theme shouldn't automatically install (ie only install after explicit user confirmation in the doorhanger)
[List of other uplifts needed for the feature/fix]: n/a
[Is the change risky?]: no
[Why is the change risky/not risky?]: small JS-only change in a feature that we only really use for lwt install/preview on AMO. Also, this is a security fix and we still have quite some beta runway left, so I'm not too worried...
[String changes made/needed]: no
[Attachment #8963107](/attachment.cgi?id=8963107&action=edit "Patch v0.1") -
Flags: approval-mozilla-beta?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1449548#c15)• 7 years ago |
|  | |

Comment on [attachment 8963107](/attachment.cgi?id=8963107 "Patch v0.1") [[details]](/attachment.cgi?id=8963107&action=edit "Patch v0.1") [[diff]](/attachment.cgi?id=8963107&action=diff "Patch v0.1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1449548&attachment=8963107)
Patch v0.1
Approved for 60.0b11.
[Attachment #8963107](/attachment.cgi?id=8963107&action=edit "Patch v0.1") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1449548#c16)• 7 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/ba71ad255604>
Are we thinking about rebasing this for ESR52 too?
[status-firefox60](/buglist.cgi?f1=cf_status_firefox60&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=fixed)Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1449548#c17)• 7 years ago |
|  | |

Attached patch

[Patch for esr](attachment.cgi?id=8965509&action=diff)
— [Details](attachment.cgi?id=8965509&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1449548&attachment=8965509)

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #16](/show_bug.cgi?id=1449548#c16 "VERIFIED FIXED - Lightweight themes can be installed automatically, without user's consent"))
> <https://hg.mozilla.org/releases/mozilla-beta/rev/ba71ad255604>
>
> Are we thinking about rebasing this for ESR52 too?
Can do.
[Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration:
sec-moderate with driveby negative effects for users, relatively simple patch
User impact if declined: security issue.
Fix Landed on Version: 61, uplift to 60
Risk to taking this patch (and alternatives if risky): relatively low... small-ish JS-only patch, has automated tests for the basics not breaking.
String or UUID changes made by this patch: noneFlags: needinfo?(gijskruitbosch+bugs)
[Attachment #8965509](/attachment.cgi?id=8965509&action=edit "Patch for esr") -
Flags: review+
[Attachment #8965509](/attachment.cgi?id=8965509&action=edit "Patch for esr") -
Flags: approval-mozilla-esr52?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1449548#c18)• 7 years ago |
|  | |

Comment on [attachment 8965509](/attachment.cgi?id=8965509 "Patch for esr") [[details]](/attachment.cgi?id=8965509&action=edit "Patch for esr") [[diff]](/attachment.cgi?id=8965509&action=diff "Patch for esr") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1449548&attachment=8965509)
Patch for esr
If kids these days are anything like me and my friends were back in school, [comment 10](/show_bug.cgi?id=1449548#c10 "VERIFIED FIXED - Lightweight themes can be installed automatically, without user's consent") sounds frighteningly plausible in situations where ESR is likely being used. Approved for 52.8.0.
[Attachment #8965509](/attachment.cgi?id=8965509&action=edit "Patch for esr") -
Flags: approval-mozilla-esr52? → approval-mozilla-esr52+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1449548#c19)• 7 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr52/rev/48a678d7cb81>
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1449548#a1056964_1689)• 7 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1449548#a1836521_1689)• 7 years ago |

Group: toolkit-core-security → core-security-release

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1449548#a2545659_280903)• 7 years ago |

Whiteboard: [adv-main60+][adv-esr52.8+]

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1449548#a2689015_488993)• 7 years ago |

Flags: qe-verify+

|  | [Emil Ghitta, QA [:emilghitta]](/user_profile?user_id=588744) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1449548#c20)• 7 years ago |
|  | |

I have managed to reproduce the issue described in [comment 0](/show_bug.cgi?id=1449548#c0 "VERIFIED FIXED - Lightweight themes can be installed automatically, without user's consent") using Firefox 61.0a1 (BuildId:20180328220110).
This issue is verified fixed using Firefox 61.0a1 (BuildId:20180429220443) and Firefox 60.0b16 on Windows 10 64bit, macOS 10.12.6 and Ubuntu 16.04 64bit.
Leaving a ni on myself to verify this on 52.8.0.
[status-firefox60](/buglist.cgi?f1=cf_status_firefox60&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox60&o1=equals&v1=verified)
[status-firefox61](/buglist.cgi?f1=cf_status_firefox61&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox61&o1=equals&v1=verified)Flags: needinfo?(emil.ghitta)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1449548#a2901826_280903)• 7 years ago |

Alias: CVE-2018-5168

|  | [Emil Ghitta, QA [:emilghitta]](/user_profile?user_id=588744) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1449548#c21)• 7 years ago |
|  | |

This issue is verified fixed using Firefox 52.8.0 esr on Windows 10 64bit, macOS 10.13.3 and Ubuntu 16.06 64bit.Status: RESOLVED → VERIFIED
[status-firefox-esr52](/buglist.cgi?f1=cf_status_firefox_esr52&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr52&o1=equals&v1=verified)Flags: qe-verify+Flags: needinfo?(emil.ghitta)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1449548#a13282864_1689)• 6 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1449548#a194847777_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1449548&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Wladimir Palant](/user_profile?user_id=109976)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_ce17d30f_20250125_013939.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2018-13

## Security vulnerabilities fixed in Thunderbird 52.8

Announced
May 18, 2018
Impact
critical
Products
Thunderbird
Fixed in

* Thunderbird 52.8

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2018-5183: Backport critical security fixes in Skia](#CVE-2018-5183)

Reporter
Mozilla Developers
Impact
critical
##### Description

Mozilla developers backported selected changes in the Skia library. These changes correct memory corruption issues including invalid buffer reads and writes during graphic operations.

##### References

* [Bug 1454692](https://bugzilla.mozilla.org/show_bug.cgi?id=1454692)

#### [#CVE-2018-5184: Full plaintext recovery in S/MIME via chosen-ciphertext attack](#CVE-2018-5184)

Reporter
Damian Poddebniak, Christian Dresen, Jens Müller, Fabian Ising, Sebastian Schinzel, Simon Friedberger, Juraj Somorovsky, Jörg Schwenk
Impact
high
##### Description

Using remote content in encrypted messages can lead to the disclosure of plaintext.

##### References

* [Bug 1411592](https://bugzilla.mozilla.org/show_bug.cgi?id=1411592)

#### [#CVE-2018-5154: Use-after-free with SVG animations and clip paths](#CVE-2018-5154)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur while enumerating attributes during SVG animations with clip paths. This results in a potentially exploitable crash.

##### References

* [Bug 1443092](https://bugzilla.mozilla.org/show_bug.cgi?id=1443092)

#### [#CVE-2018-5155: Use-after-free with SVG animations and text paths](#CVE-2018-5155)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur while adjusting layout during SVG animations with text paths. This results in a potentially exploitable crash.

##### References

* [Bug 1448774](https://bugzilla.mozilla.org/show_bug.cgi?id=1448774)

#### [#CVE-2018-5159: Integer overflow and out-of-bounds write in Skia](#CVE-2018-5159)

Reporter
Ivan Fratric
Impact
high
##### Description

An integer overflow can occur in the Skia library due to 32-bit integer use in an array without integer overflow checks, resulting in possible out-of-bounds writes. This could lead to a potentially exploitable crash triggerable by web content.

##### References

* [Bug 1441941](https://bugzilla.mozilla.org/show_bug.cgi?id=1441941)

#### [#CVE-2018-5161: Hang via malformed headers](#CVE-2018-5161)

Reporter
cure53
Impact
moderate
##### Description

Crafted message headers can cause a Thunderbird process to hang on receiving the message.

##### References

* [Bug 1411720](https://bugzilla.mozilla.org/show_bug.cgi?id=1411720)

#### [#CVE-2018-5162: Encrypted mail leaks plaintext through src attribute](#CVE-2018-5162)

Reporter
Damian Poddebniak, Christian Dresen, Jens Müller, Fabian Ising, Sebastian Schinzel, Simon Friedberger, Juraj Somorovsky, Jörg Schwenk
Impact
moderate
##### Description

Plaintext of decrypted emails can leak through the src attribute of remote images, or links.

##### References

* [Bug 1457721](https://bugzilla.mozilla.org/show_bug.cgi?id=1457721)

#### [#CVE-2018-5170: Filename spoofing for external attachments](#CVE-2018-5170)

Reporter
cure53
Impact
moderate
##### Description

It is possible to spoof the filename of an attachment and display an arbitrary attachment name. This could lead to a user opening a remote attachment which is a different file type than expected.

##### References

* [Bug 1411732](https://bugzilla.mozilla.org/show_bug.cgi?id=1411732)

#### [#CVE-2018-5168: Lightweight themes can be installed without user interaction](#CVE-2018-5168)

Reporter
Wladimir Palant
Impact
moderate
##### Description

Sites can bypass security checks on permissions to install lightweight themes by manipulating the `baseURI` property of the theme element. This could allow a malicious site to install a theme without user interaction which could contain offensive or embarrassing images.

##### References

* [Bug 1449548](https://bugzilla.mozilla.org/show_bug.cgi?id=1449548)

#### [#CVE-2018-5174: Windows Defender SmartScreen UI runs with less secure behavior for downloaded files in Windows 10 April 2018 Update](#CVE-2018-5174)

Reporter
Jimmy
Impact
moderate
##### Description

In the Windows 10 April 2018 Update, Windows Defender SmartScreen honors the `SEE_MASK_FLAG_NO_UI` flag associated with downloaded files and will not show any UI. Files that are unknown and potentially dangerous will be allowed to run because SmartScreen will not prompt the user for a decision, and if the user is offline all files will be allowed to be opened because Windows won’t prompt the user to ask what to do. Firefox incorrectly sets this flag when downloading files, leading to less secure behavior from SmartScreen.
*Note: this issue only affects Windows 10 users running the April 2018 update or later. It does not affect other Windows users or other operating systems.*

##### References

* [Bug 1447080](https://bugzilla.mozilla.org/show_bug.cgi?id=1447080)

#### [#CVE-2018-5178: Buffer overflow during UTF-8 to Unicode string conversion through legacy extension](#CVE-2018-5178)

Reporter
Root Object
Impact
moderate
##### Description

A buffer overflow was found during UTF8 to Unicode string conversion within JavaScript with extremely large amounts of data. This vulnerability requires the use of a malicious or vulnerable legacy extension in order to occur.

##### References

* [Bug 1443891](https://bugzilla.mozilla.org/show_bug.cgi?id=1443891)

#### [#CVE-2018-5185: Leaking plaintext through HTML forms](#CVE-2018-5185)

Reporter
Damian Poddebniak, Christian Dresen, Jens Müller, Fabian Ising, Sebastian Schinzel, Simon Friedberger, Juraj Somorovsky, Jörg Schwenk
Impact
low
##### Description

Plaintext of decrypted emails can leak through by user submitting an embedded form.

##### References

* [Bug 1450345](https://bugzilla.mozilla.org/show_bug.cgi?id=1450345)

#### [#CVE-2018-5150: Memory safety bugs fixed in Firefox 60, Firefox ESR 52.8, and Thunderbird 52.8](#CVE-2018-5150)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Christoph Diehl, Randell Jesup, Tyson Smith, Alex Gaynor, Ronald Crane, Julian Hector, Kannan Vijayan, and Jason Kratzer reported memory safety bugs present in Firefox 59, Firefox ESR 52.7, and Thunderbird 52.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 60, Firefox ESR 52.8, and Thunderbird 52.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1388020%2C1433609%2C1409440%2C1448705%2C1451376%2C1452202%2C1444668%2C1393367%2C1411415%2C1426129)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_879d4593_20250125_013938.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2018-11

## Security vulnerabilities fixed in Firefox 60

Announced
May 9, 2018
Impact
critical
Products
Firefox
Fixed in

* Firefox 60

#### [#CVE-2018-5154: Use-after-free with SVG animations and clip paths](#CVE-2018-5154)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur while enumerating attributes during SVG animations with clip paths. This results in a potentially exploitable crash.

##### References

* [Bug 1443092](https://bugzilla.mozilla.org/show_bug.cgi?id=1443092)

#### [#CVE-2018-5155: Use-after-free with SVG animations and text paths](#CVE-2018-5155)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability can occur while adjusting layout during SVG animations with text paths. This results in a potentially exploitable crash.

##### References

* [Bug 1448774](https://bugzilla.mozilla.org/show_bug.cgi?id=1448774)

#### [#CVE-2018-5157: Same-origin bypass of PDF Viewer to view protected PDF files](#CVE-2018-5157)

Reporter
Wladimir Palant
Impact
high
##### Description

Same-origin protections for the PDF viewer can be bypassed, allowing a malicious site to intercept messages meant for the viewer. This could allow the site to retrieve PDF files restricted to viewing by an authenticated user on a third-party website.

##### References

* [Bug 1449898](https://bugzilla.mozilla.org/show_bug.cgi?id=1449898)

#### [#CVE-2018-5158: Malicious PDF can inject JavaScript into PDF Viewer](#CVE-2018-5158)

Reporter
Wladimir Palant
Impact
high
##### Description

The PDF viewer does not sufficiently sanitize PostScript calculator functions, allowing malicious JavaScript to be injected through a crafted PDF file. This JavaScript can then be run with the permissions of the PDF viewer by its worker.

##### References

* [Bug 1452075](https://bugzilla.mozilla.org/show_bug.cgi?id=1452075)

#### [#CVE-2018-5159: Integer overflow and out-of-bounds write in Skia](#CVE-2018-5159)

Reporter
Ivan Fratric
Impact
high
##### Description

An integer overflow can occur in the Skia library due to 32-bit integer use in an array without integer overflow checks, resulting in possible out-of-bounds writes. This could lead to a potentially exploitable crash triggerable by web content.

##### References

* [Bug 1441941](https://bugzilla.mozilla.org/show_bug.cgi?id=1441941)

#### [#CVE-2018-5160: Uninitialized memory use by WebRTC encoder](#CVE-2018-5160)

Reporter
Andreas Perhson
Impact
high
##### Description

WebRTC can use a `WrappedI420Buffer` pixel buffer but the owning image object can be freed while it is still in use. This can result in the WebRTC encoder using uninitialized memory, leading to a potentially exploitable crash.

##### References

* [Bug 1436117](https://bugzilla.mozilla.org/show_bug.cgi?id=1436117)

#### [#CVE-2018-5152: WebExtensions information leak through webRequest API](#CVE-2018-5152)

Reporter
Andy McKay
Impact
moderate
##### Description

WebExtensions with the appropriate permissions can attach content scripts to Mozilla sites such as accounts.firefox.com and listen to network traffic to the site through the `webRequest` API. For example, this allows for the interception of username and an encrypted password during login to Firefox Accounts. This issue does not expose synchronization traffic directly and is limited to the process of user login to the website and the data displayed to the user once logged in.

##### References

* [Bug 1415644](https://bugzilla.mozilla.org/show_bug.cgi?id=1415644)
* [Bug 1427289](https://bugzilla.mozilla.org/show_bug.cgi?id=1427289)

#### [#CVE-2018-5153: Out-of-bounds read in mixed content websocket messages](#CVE-2018-5153)

Reporter
Dennis Fuchs
Impact
moderate
##### Description

If websocket data is sent with mixed text and binary in a single message, the binary data can be corrupted. This can result in an out-of-bounds read with the read memory sent to the originating server in response.

##### References

* [Bug 1436809](https://bugzilla.mozilla.org/show_bug.cgi?id=1436809)

#### [#CVE-2018-5163: Replacing cached data in JavaScript Start-up Bytecode Cache](#CVE-2018-5163)

Reporter
Nicolas B. Pierron
Impact
moderate
##### Description

If a malicious attacker has used another vulnerability to gain full control over a content process, they may be able to replace the alternate data resources stored in the JavaScript Start-up Bytecode Cache (JSBC) for other JavaScript code. If the parent process then runs this replaced code, the executed script would be run with the parent process' privileges, escaping the sandbox on content processes.

##### References

* [Bug 1426353](https://bugzilla.mozilla.org/show_bug.cgi?id=1426353)

#### [#CVE-2018-5164: CSP not applied to all multipart content sent with multipart/x-mixed-replace](#CVE-2018-5164)

Reporter
Khalil Zhani
Impact
moderate
##### Description

Content Security Policy (CSP) is not applied correctly to all parts of multipart content sent with the `multipart/x-mixed-replace` MIME type. This could allow for script to run where CSP should block it, allowing for cross-site scripting (XSS) and other attacks.

##### References

* [Bug 1416045](https://bugzilla.mozilla.org/show_bug.cgi?id=1416045)

#### [#CVE-2018-5166: WebExtension host permission bypass through filterReponseData](#CVE-2018-5166)

Reporter
Francois Lajeunesse Robert
Impact
moderate
##### Description

WebExtensions can use request redirection and a `filterReponseData` filter to bypass host permission settings to redirect network traffic and access content from a host for which they do not have explicit user permission.

##### References

* [Bug 1437325](https://bugzilla.mozilla.org/show_bug.cgi?id=1437325)

#### [#CVE-2018-5167: Improper linkification of chrome: and javascript: content in web console and JavaScript debugger](#CVE-2018-5167)

Reporter
Wladimir Palant
Impact
moderate
##### Description

The web console and JavaScript debugger do not sanitize all output that can be hyperlinked. Both will display `chrome:` links as active, clickable hyperlinks in their output. Web sites should not be able to directly link to internal chrome pages. Additionally, the JavaScript debugger will display `javascript:` links, which users could be tricked into clicking by malicious sites.

##### References

* [Bug 1447969](https://bugzilla.mozilla.org/show_bug.cgi?id=1447969)

#### [#CVE-2018-5168: Lightweight themes can be installed without user interaction](#CVE-2018-5168)

Reporter
Wladimir Palant
Impact
moderate
##### Description

Sites can bypass security checks on permissions to install lightweight themes by manipulating the `baseURI` property of the theme element. This could allow a malicious site to install a theme without user interaction which could contain offensive or embarrassing images.

##### References

* [Bug 1449548](https://bugzilla.mozilla.org/show_bug.cgi?id=1449548)

#### [#CVE-2018-5169: Dragging and dropping link text onto home button can set home page to include chrome pages](#CVE-2018-5169)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

If manipulated hyperlinked text with `chrome:` URL contained in it is dragged and dropped on the "home" icon, the home page can be reset to include a normally-unlinkable chrome page as one of the home page tabs.

##### References

* [Bug 1319157](https://bugzilla.mozilla.org/show_bug.cgi?id=1319157)

#### [#CVE-2018-5172: Pasted script from clipboard can run in the Live Bookmarks page or PDF viewer](#CVE-2018-5172)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

The Live Bookmarks page and the PDF viewer can run injected script content if a user pastes script from the clipboard into them while viewing RSS feeds or PDF files. This could allow a malicious site to socially engineer a user to copy and paste malicious script content that could then run with the context of either page but does not allow for privilege escalation.

##### References

* [Bug 1436482](https://bugzilla.mozilla.org/show_bug.cgi?id=1436482)

#### [#CVE-2018-5173: File name spoofing of Downloads panel with Unicode characters](#CVE-2018-5173)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

The filename appearing in the `Downloads` panel improperly renders some Unicode characters, allowing for the file name to be spoofed. This can be used to obscure the file extension of potentially executable files from user view in the panel.
*Note: the dialog to open the file will show the full, correct filename and whether it is executable or not.*

##### References

* [Bug 1438025](https://bugzilla.mozilla.org/show_bug.cgi?id=1438025)

#### [#CVE-2018-5174: Windows Defender SmartScreen UI runs with less secure behavior for downloaded files in Windows 10 April 2018 Update](#CVE-2018-5174)

Reporter
Jimmy
Impact
moderate
##### Description

In the Windows 10 April 2018 Update, Windows Defender SmartScreen honors the `SEE_MASK_FLAG_NO_UI` flag associated with downloaded files and will not show any UI. Files that are unknown and potentially dangerous will be allowed to run because SmartScreen will not prompt the user for a decision, and if the user is offline all files will be allowed to be opened because Windows won’t prompt the user to ask what to do. Firefox incorrectly sets this flag when downloading files, leading to less secure behavior from SmartScreen.
*Note: this issue only affects Windows 10 users running the April 2018 update or later. It does not affect other Windows users or other operating systems.*

##### References

* [Bug 1447080](https://bugzilla.mozilla.org/show_bug.cgi?id=1447080)

#### [#CVE-2018-5175: Universal CSP bypass on sites using strict-dynamic in their policies](#CVE-2018-5175)

Reporter
Masato Kinugawa
Impact
moderate
##### Description

A mechanism to bypass Content Security Policy (CSP) protections on sites that have a `script-src` policy of `'strict-dynamic'`. If a target website contains an HTML injection flaw an attacker could inject a reference to a copy of the `require.js` library that is part of Firefox’s Developer Tools, and then use a known technique using that library to bypass the CSP restrictions on executing injected scripts.

##### References

* [Bug 1432358](https://bugzilla.mozilla.org/show_bug.cgi?id=1432358)

#### [#CVE-2018-5176: JSON Viewer script injection](#CVE-2018-5176)

Reporter
Tadj Youssouf
Impact
moderate
##### Description

The JSON Viewer displays clickable hyperlinks for strings that are parseable as URLs, including `javascript:` links. If a JSON file contains malicious JavaScript script embedded as `javascript:` links, users may be tricked into clicking and running this code in the context of the JSON Viewer. This can allow for the theft of cookies and authorization tokens which are accessible to that context.

##### References

* [Bug 1442840](https://bugzilla.mozilla.org/show_bug.cgi?id=1442840)

#### [#CVE-2018-5177: Buffer overflow in XSLT during number formatting](#CVE-2018-5177)

Reporter
Guyio
Impact
moderate
##### Description

A vulnerability exists in XSLT during number formatting where a negative buffer size may be allocated in some instances, leading to a buffer overflow and crash if it occurs.

##### References

* [Bug 1451908](https://bugzilla.mozilla.org/show_bug.cgi?id=1451908)

#### [#CVE-2018-5165: Checkbox for enabling Flash protected mode is inverted in 32-bit Firefox](#CVE-2018-5165)

Reporter
David Parks
Impact
low
##### Description

In 32-bit versions of Firefox, the Adobe Flash plugin setting for "Enable Adobe Flash protected mode" is unchecked by default even though the Adobe Flash sandbox is actually enabled. The displayed state is the reverse of the true setting, resulting in user confusion. This could cause users to select this setting intending to activate it and inadvertently turn protections off.

##### References

* [Bug 1451452](https://bugzilla.mozilla.org/show_bug.cgi?id=1451452)

#### [#CVE-2018-5180: heap-use-after-free in mozilla::WebGLContext::DrawElementsInstanced](#CVE-2018-5180)

Reporter
Nils
Impact
low
##### Description

A use-after-free vulnerability can occur during WebGL operations. While this results in a potentially exploitable crash, the vulnerability is limited because the memory is freed and reused in a brief window of time during the freeing of the same callstack.

##### References

* [Bug 1444086](https://bugzilla.mozilla.org/show_bug.cgi?id=1444086)

#### [#CVE-2018-5181: Local file can be displayed in noopener tab through drag and drop of hyperlink](#CVE-2018-5181)

Reporter
Abdulrahman Alqabandi
Impact
low
##### Description

If a URL using the `file:` protocol is dragged and dropped onto an open tab that is running in a different child process the tab will open a local file corresponding to the dropped URL, contrary to policy. One way to make the target tab open more reliably in a separate process is to open it with the `noopener` keyword.

##### References

* [Bug 1424107](https://bugzilla.mozilla.org/show_bug.cgi?id=1424107)

#### [#CVE-2018-5182: Local file can be displayed from hyperlink dragged and dropped on addressbar](#CVE-2018-5182)

Reporter
Jordi Chancel
Impact
low
##### Description

If a text string that happens to be a filename in the operating system's native format is dragged and dropped onto the addressbar the specified local file will be opened. This is contrary to policy and is what would happen if the string were the equivalent `file:` URL.

##### References

* [Bug 1435908](https://bugzilla.mozilla.org/show_bug.cgi?id=1435908)

#### [#CVE-2018-5179: Service workers can self update to keep a worker running](#CVE-2018-5179)

Reporter
Yannic Bonenberger
Impact
low
##### Description

A service worker can send the "activate" event on itself periodically which allows it to run perpetually. This would allow any malicious activity, such as logging an IP address by the service worker, to occur in the background.

##### References

* [Bug 1432846](https://bugzilla.mozilla.org/show_bug.cgi?id=1432846)

#### [#CVE-2018-5151: Memory safety bugs fixed in Firefox 60](#CVE-2018-5151)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Christoph Diehl, Christian Holler, Jon Coppeard, Jason Kratzer, Nathan Froyd, Paul Theriault, Ryan VanderMeulen, Tyson Smith, Sebastian Hengst, Byron Campen, Emilio Cobos Álvarez, Ronald Crane, and Phillipp reported memory safety bugs present in Firefox 59. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 60](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1445234%2C1449530%2C1437455%2C1447989%2C1438827%2C1436983%2C1435036%2C1440465%2C1439723%2C1448771%2C1453653%2C1454359%2C1432323%2C1454126%2C1436759%2C1439655%2C1448612%2C1449358%2C1367727%2C1452417)

#### [#CVE-2018-5150: Memory safety bugs fixed in Firefox 60 and Firefox ESR 52.8](#CVE-2018-5150)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Christoph Diehl, Randell Jesup, Tyson Smith, Alex Gaynor, Ronald Crane, Julian Hector, Kannan Vijayan, and Jason Kratzer reported memory safety bugs present in Firefox 59 and Firefox ESR 52.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 60 and Firefox ESR 52.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1388020%2C1433609%2C1409440%2C1448705%2C1451376%2C1452202%2C1444668%2C1393367%2C1411415%2C1426129)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_73f8d6fa_20250126_050647.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)


