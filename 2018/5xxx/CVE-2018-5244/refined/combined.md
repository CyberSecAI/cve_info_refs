=== Content from xenbits.xen.org_5c9721a8_20250125_155324.html ===

# Information

| Advisory | [XSA-253](advisory-253.html) |
| --- | --- |
| Public release | 2018-01-04 12:00 |
| Updated | 2018-01-06 15:24 |
| Version | 3 |
| CVE(s) | [CVE-2018-5244](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5244) |
| Title | x86: memory leak with MSR emulation |

# Files

<advisory-253.txt> (signed advisory file)

<xsa253.patch>
# Advisory

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2018-5244 / XSA-253
                              version 3

                  x86: memory leak with MSR emulation

UPDATES IN VERSION 3
====================

CVE assigned.

ISSUE DESCRIPTION
=================

In Xen 4.10, new infrastructure was introduced as part of an overhaul to
how MSR emulation happens for guests.  Unfortunately, one tracking
structure isn't freed when a vcpu is destroyed.

IMPACT
======

A memory allocation of 8 bytes is leaked each time a vcpu is destroyed.

A malicious guest may, by frequently rebooting over extended periods of
time, run the system out of memory, resulting in a Denial of Service
(DoS).

VULNERABLE SYSTEMS
==================

Xen versions 4.10 and later are affected.  Xen 4.9 and earlier are not
affected.

Only x86 systems are affected.  ARM systems are not.

All guest kinds can exploit this vulnerability.

MITIGATION
==========

Limiting the frequency with which a guest is able to reboot, will
limit the memory leak.

Rebooting each host (after migrating its guests) periodically will
reclaim the leaked space.

CREDITS
=======

This issue was discovered by Andrew Cooper of Citrix.

RESOLUTION
==========

Applying the appropriate attached patch resolves this issue.

xsa253.patch           Xen 4.10, xen-unstable

$ sha256sum xsa253*
[bba1abb5e4368421de29385e37f8477bf3534d3ba3ff7e2aae9c9d3da53f1393  xsa253.patch](xsa253.patch)
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  <http://www.xenproject.org/security-policy.html>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBCAAGBQJaUOoXAAoJEIP+FMlX6CvZchUIAKlvxu5o9IcIyULARW0s2YEA
6ueK3tyaH2vlWH1IG9KORletdAGALJrfEODt8SBJb+0rKDZKGHSKNB7a911QRebK
njXdSpdb1WCdHmStI82csLKvdMGbrFq/6wWFJRt1eFtzr7Qt3rwKXtHv/OI4Kr1T
sZ+K6M2KCavkJ+yPSF/f9GTBuD6iiu2E7RI5HzbjdV+k9E7tJkURH2/BPAfhhhyo
zsColbPQAxm96RCHIEPaOI5qZXVcfL+5VNbUh5+6vOtUiZdpnOMHmSwDF0AZc1hO
0YQ93/8blRm7N914rn8gu0zY+nQHcgC2klWzHOcCFirzTI0aHXfQQJsX9Oe6g3w=
=CX95
-----END PGP SIGNATURE-----

```

---

Xenproject.org Security Team


=== Content from security.gentoo.org_81bd4b38_20250125_155323.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Xen: Multiple vulnerabilities — GLSA **201810-06**

Multiple vulnerabilities have been found in Xen, the worst of which
could cause a Denial of Service condition.

### Affected packages

| Package | **app-emulation/xen** on all architectures |
| --- | --- |
| Affected versions | < **4.10.1-r2** |
| Unaffected versions | >= **4.10.1-r2** |

| Package | **app-emulation/xen-tools** on all architectures |
| --- | --- |
| Affected versions | < **4.10.1-r2** |
| Unaffected versions | >= **4.10.1-r2** |

### Background

Xen is a bare-metal hypervisor.

### Description

Multiple vulnerabilities have been discovered in Xen. Please review the
referenced CVE identifiers for details.

### Impact

A local attacker could cause a Denial of Service condition or disclose
sensitive information.

### Workaround

There is no known workaround at this time.

### Resolution

All Xen users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/xen-4.10.1-r2"

```

All Xen tools users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=app-emulation/xen-tools-4.10.1-r2"

```
### References

* [CVE-2017-5715](https://nvd.nist.gov/vuln/detail/CVE-2017-5715)
* [CVE-2017-5753](https://nvd.nist.gov/vuln/detail/CVE-2017-5753)
* [CVE-2017-5754](https://nvd.nist.gov/vuln/detail/CVE-2017-5754)
* [CVE-2018-10471](https://nvd.nist.gov/vuln/detail/CVE-2018-10471)
* [CVE-2018-10472](https://nvd.nist.gov/vuln/detail/CVE-2018-10472)
* [CVE-2018-10981](https://nvd.nist.gov/vuln/detail/CVE-2018-10981)
* [CVE-2018-10982](https://nvd.nist.gov/vuln/detail/CVE-2018-10982)
* [CVE-2018-12891](https://nvd.nist.gov/vuln/detail/CVE-2018-12891)
* [CVE-2018-12892](https://nvd.nist.gov/vuln/detail/CVE-2018-12892)
* [CVE-2018-12893](https://nvd.nist.gov/vuln/detail/CVE-2018-12893)
* [CVE-2018-15468](https://nvd.nist.gov/vuln/detail/CVE-2018-15468)
* [CVE-2018-15469](https://nvd.nist.gov/vuln/detail/CVE-2018-15469)
* [CVE-2018-15470](https://nvd.nist.gov/vuln/detail/CVE-2018-15470)
* [CVE-2018-3620](https://nvd.nist.gov/vuln/detail/CVE-2018-3620)
* [CVE-2018-3646](https://nvd.nist.gov/vuln/detail/CVE-2018-3646)
* [CVE-2018-5244](https://nvd.nist.gov/vuln/detail/CVE-2018-5244)
* [CVE-2018-7540](https://nvd.nist.gov/vuln/detail/CVE-2018-7540)
* [CVE-2018-7541](https://nvd.nist.gov/vuln/detail/CVE-2018-7541)
* [CVE-2018-7542](https://nvd.nist.gov/vuln/detail/CVE-2018-7542)

**Release date**

October 30, 2018

**Latest revision**

October 30, 2018: 2

**Severity**

normal

**Exploitable**

local

**Bugzilla entries**

* [643350](https://bugs.gentoo.org/show_bug.cgi?id=643350)
* [655188](https://bugs.gentoo.org/show_bug.cgi?id=655188)
* [655544](https://bugs.gentoo.org/show_bug.cgi?id=655544)
* [659442](https://bugs.gentoo.org/show_bug.cgi?id=659442)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


