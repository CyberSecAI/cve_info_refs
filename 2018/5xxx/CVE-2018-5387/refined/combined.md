=== Content from www.kb.cert.org_59033050_20250124_204639.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#475445

## Multiple SAML libraries may allow authentication bypass via incorrect XML canonicalization and DOM traversal

#### Vulnerability Note VU#475445

Original Release Date: 2018-02-27 | Last Revised: 2018-06-05

---

### Overview

Multiple SAML libraries may incorrectly utilize the results of XML DOM traversal and canonicalization APIs in such a way that an attacker may be able to manipulate the SAML data without invalidating the cryptographic signature, allowing the attack to potentially bypass authentication to SAML service providers.

### Description

| [**CWE-287**](https://cwe.mitre.org/data/definitions/287.html)**: Improper Authentication**  Security Assertion Markup Language (SAML) is an XML-based markup language for security assertions regarding authentication and permissions, most commonly used for single sign-on (SSO) services.Some XML DOM traversal and canonicalization APIs may be inconsistent in handling of comments within XML nodes. Incorrect use of these APIs by some SAML libraries results in incorrect parsing of the inner text of XML nodes such that any inner text after the comment is lost prior to cryptographically signing the SAML message. Text after the comment therefore has no impact on the signature on the SAML message.A remote attacker can modify SAML content for a SAML service provider without invalidating the cryptographic signature, which may allow attackers to bypass primary authentication for the affected SAML service providerThe following CVEs are assigned:CVE-2017-11427 - OneLogin’s "python-saml"CVE-2017-11428 - OneLogin’s "ruby-saml"CVE-2017-11429 - Clever’s "saml2-js"CVE-2017-11430 - "OmniAuth-SAML"CVE-2018-0489 - Shibboleth openSAML C++CVE-2018-5387 - Wizkunde SAMLBaseMore information is available in the researcher's [blog post](https://duo.com/blog/duo-finds-saml-vulnerabilities-affecting-multiple-implementations). |
| --- |

### Impact

| By modifying SAML content without invalidating the cryptographic signature, a remote, unauthenticated attacker may be able to bypass primary authentication for an affected SAML service provider. |
| --- |

### Solution

| **Apply updates**Affected SAML service providers should update software to utilize the latest releases of affected SAML libraries. Please see the vendor list below for more information. |
| --- |

### Vendor Information

475445
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23475445/) to view vendors.**
### [Clever, Inc.](#CHEU-AVBRWY) Affected

Notified:  January 24, 2018  Updated: February 26, 2018

**Statement Date:   February 24, 2018**

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

Both versions 1.x and 2.x versions are affected. A patch is available for both versions.

### [Duo Security](#GWAN-AW963A) Affected

Updated:  February 28, 2018

**Statement Date:   December 19, 2017**

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

Duo Network Gateway (DNG) is affected and assigned CVE-2018-7340.

### Vendor References

* <https://duo.com/blog/duo-finds-saml-vulnerabilities-affecting-multiple-implementations>
* <https://duo.com/labs/psa/duo-psa-2017-003>

### [OmniAuth](#CHEU-AVBRWW) Affected

Notified:  January 24, 2018  Updated: February 06, 2018

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [OneLogin Inc](#CHEU-AVBRX8) Affected

Notified:  January 24, 2018  Updated: February 27, 2018

**Statement Date:   February 27, 2018**

### Status

Affected

### Vendor Statement

Refer to the vendor's [official notice](https://support.onelogin.com/hc/en-us/articles/360001271891).

### Vendor Information

Refer to the vendor's [official notice](https://support.onelogin.com/hc/en-us/articles/360001271891).

### Vendor References

* <https://support.onelogin.com/hc/en-us/articles/360001271891>

### Addendum

Specific patch commits:

ruby-saml <https://github.com/onelogin/ruby-saml/releases/tag/v1.7.0>
python-saml <https://github.com/onelogin/python-saml/releases/tag/v2.4.0>
python3-saml <https://github.com/onelogin/python3-saml/releases/tag/v1.4.0>

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Pulse Secure](#GWAN-AXATWL) Affected

Updated:  March 28, 2018

### Status

Affected

### Vendor Statement

| | All Pulse Secure products were evaluated and the following products are known to be vulnerable by this issue:     + All supported versions of Pulse Connect Secure with SAML authentication server configured as Service Provider + Pulse WorkSpace with SAML enabled + Pulse One with Enterprise (SAML) SSO enabled on the admin login + vTM 17.4 (Only) with a virtual server configured for SAML authentication.  For a list of supported software versions, please refer to our [EOL policy](https://www.pulsesecure.net/support/eol/). All other Pulse Secure products (not listed above) were determined as not vulnerable. | | --- | |
| --- | --- |

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <http://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA43667/>

### [Shibboleth Consortium](#CHEU-AVBRX6) Affected

Notified:  January 24, 2018  Updated: March 14, 2018

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <https://shibboleth.net/community/advisories/secadv_20180227.txt>

### [Wizkunde B.V.](#GWAN-AXJK24) Affected

Updated:  April 05, 2018

**Statement Date:   April 03, 2018**

### Status

Affected

### Vendor Statement

We've got notified about this bug on Monday 3-4-2018 and immediately took actions to fix the ability to exploit this at implementations of our library.

The patch is written in this commit:
<https://github.com/Wizkunde/SAMLBase/commit/482cdf8c090e0f1179073034ebcb609ac7c3f5b3>

### Vendor Information

Wizkunde SAMLBase prior to version 1.2.7 is affected, the issue was addressed in version 1.2.7. CVE-2018-5387 has been assigned.

### Vendor References

* <https://github.com/Wizkunde/SAMLBase/issues/3>
* <https://github.com/Wizkunde/SAMLBase/commit/482cdf8c090e0f1179073034ebcb609ac7c3f5b3>

### [AssureBridge](#GWAN-AWDTB6) Not Affected

Updated:  February 27, 2018

**Statement Date:   February 27, 2018**

### Status

Not Affected

### Vendor Statement

We have tested against the vulnerability and determined that our SAML SSO product is not affected.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Box](#CHEU-AW9V2E) Not Affected

Notified:  February 23, 2018  Updated: February 28, 2018

**Statement Date:   February 27, 2018**

### Status

Not Affected

### Vendor Statement

Box is not affected by VU#475445 and has provided guidance to customers on our community site here:
<https://community.box.com/t5/Box-Product-News/Recently-reported-SAML-vulnerabilities-What-you-need-to-know-as/ba-p/52403>

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <https://community.box.com/t5/Box-Product-News/Recently-reported-SAML-vulnerabilities-What-you-need-to-know-as/ba-p/52403>

### [CA Technologies](#GWAN-AWMM35) Not Affected

Updated:  March 07, 2018

**Statement Date:   March 06, 2018**

### Status

Not Affected

### Vendor Statement

"The results of testing have concluded that CA Single Sign-On, and the previously named CA Federation, is not affected by this vulnerability."

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <https://support.ca.com/us/product-content/status/announcement-documents/2018/ca---proactive-notification---smplc---advisory---asmplc-100601.html>

### [Cisco](#CHEU-AW9V2H) Not Affected

Notified:  February 23, 2018  Updated: June 05, 2018

**Statement Date:   March 01, 2018**

### Status

Not Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

Cisco AnyConnect and ASA and FTD software are not vulnerable.

### [ComponentSpace Pty Ltd](#GWAN-AWENPK) Not Affected

Updated:  February 28, 2018

**Statement Date:   February 28, 2018**

### Status

Not Affected

### Vendor Statement

We have tested for this vulnerability and have determined that none of our SAML products are affected.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Entr'ouvert](#CHEU-AVBRWU) Not Affected

Notified:  January 24, 2018  Updated: February 28, 2018

**Statement Date:   February 28, 2018**

### Status

Not Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

Entr'ouvert develops the lasso C library that implements SAML2. Entr'ouvert has determined lasso is not affected by this vulnerability.

### [ForgeRock](#GWAN-AWMTCP) Not Affected

Updated:  March 07, 2018

**Statement Date:   March 07, 2018**

### Status

Not Affected

### Vendor Statement

"ForgeRock has carefully assessed our implementations of SAML 1.x, SAML2, [OAuth2 SAML2 Grant](https://tools.ietf.org/html/rfc7522), WS-Federation and the Java Fedlet, and determined that we are not affected by this vulnerability."

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <https://backstage.forgerock.com/knowledge/kb/article/a44883924>

### [GitHub](#CHEU-AVBRX2) Not Affected

Notified:  January 24, 2018  Updated: March 01, 2018

**Statement Date:   February 28, 2018**

### Status

Not Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

Neither GitHub nor GitHub Enterprise are affected by this vulnerability.

### [Google](#CHEU-AW9V2K) Not Affected

Notified:  February 23, 2018  Updated: March 01, 2018

**Statement Date:   February 28, 2018**

### Status

Not Affected

### Vendor Statement

Google Cloud / G Suite's SAML single sign-on for managed Google accounts using third party Identity Providers<<https://support.google.com/a/answer/60224>> is not affected by this vulnerability.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Microsoft](#CHEU-AW9V2C) Not Affected

Notified:  February 23, 2018  Updated: March 02, 2018

**Statement Date:   March 02, 2018**

### Status

Not Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

Microsoft Azure Active Directory (AAS) and Microsoft Windows Server Active Directory Federation Services (ADFS) are not affected.

### [Okta Inc.](#CHEU-AVGQJE) Not Affected

Notified:  January 29, 2018  Updated: February 27, 2018

**Statement Date:   February 15, 2018**

### Status

Not Affected

### Vendor Statement

Okta was made aware of the vulnerability before the public disclosure and immediately undertook a thorough code review and patched. Okta is not vulnerable, and we don't have any indication that the vulnerability was exploited in our systems.

### Vendor Information

Okta is the leading independent provider of identity for the enterprise. The Okta Identity Cloud enables organizations to secure and manage their extended enterprise and transform their customers’ experiences. With over 5,000 pre-built integrations to applications, infrastructure and devices, Okta customers can easily and securely adopt the technologies they need to fulfill their missions.

### Vendor References

* <https://www.okta.com/blog/2018/02/what-you-need-to-know-about-saml-vulnerability-research/>

### [Ping Identity](#GWAN-AWEP55) Not Affected

Updated:  February 28, 2018

**Statement Date:   February 28, 2018**

### Status

Not Affected

### Vendor Statement

Ping Identity products (PingFederate, PingOne) have been verified and found to be Not Affected by VU#475445.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Pivotal Software, Inc.](#CHEU-AVBRWS) Not Affected

Notified:  January 24, 2018  Updated: February 28, 2018

**Statement Date:   February 28, 2018**

### Status

Not Affected

### Vendor Statement

The Pivotal, Spring and Cloud Foundry teams have determined that the UAA project and Spring Security SAML are not exposed to this vulnerability and therefore does not require any upgrades.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <https://www.pivotal.io/security/vu475445>
* <https://www.cloudfoundry.org/blog/vu475445>

### [SAML (golang)](#CHEU-AWWQQK) Not Affected

Notified:  March 16, 2018  Updated: March 19, 2018

**Statement Date:   March 19, 2018**

### Status

Not Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### Vendor References

* <https://github.com/crewjam/saml/pull/140>

### [Tools4Ever](#GWAN-AYW38V) Not Affected

Updated:  May 18, 2018

**Statement Date:   May 16, 2018**

### Status

Not Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

Tools4ever utilizes an unaffected SAML library.

### [VMware](#GWAN-AWMLZ4) Not Affected

Updated:  March 07, 2018

**Statement Date:   March 06, 2018**

### Status

Not Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The following products have been determined to be unaffected:
נVMware vCenter Server
נVMware Identity Manager
נVMware Cloud Director

### Vendor References

* <https://kb.vmware.com/s/article/53040>

### [Danish e-Infrastructure Cooperation (WAYF)](#CHEU-AVBRX4) Unknown

Notified:  January 24, 2018  Updated: January 24, 2018

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [GitLab Inc.](#CHEU-AWGLBL) Unknown

Notified:  March 02, 2018  Updated: March 02, 2018

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [SSO Easy](#GWAN-AWGLE5) Unknown

Updated:  March 02, 2018

**Statement Date:   March 02, 2018**

### Status

Unknown

### Vendor Statement

We have tested for this vulnerability and have determined that the SAML functionality and processing is not affected by VU#475445.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

View all 26 vendorsView less vendors

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 6.3 | AV:N/AC:M/Au:S/C:C/I:N/A:N |
| Temporal | 4.9 | E:POC/RL:OF/RC:C |
| Environmental | 4.9 | CDP:ND/TD:ND/CR:ND/IR:ND/AR:ND |

### References

* <https://duo.com/blog/duo-finds-saml-vulnerabilities-affecting-multiple-implementations>
* <https://duo.com/labs/psa/duo-psa-2017-003>
* <https://cwe.mitre.org/data/definitions/287.html>
### Acknowledgements

Thanks to Kelby Ludwig of Duo Security for reporting this vulnerability.

This document was written by Garret Wassermann.

### Other Information

| **CVE IDs:** | [CVE-2017-11427](http://web.nvd.nist.gov/vuln/detail/CVE-2017-11427), [CVE-2017-11428](http://web.nvd.nist.gov/vuln/detail/CVE-2017-11428), [CVE-2017-11429](http://web.nvd.nist.gov/vuln/detail/CVE-2017-11429), [CVE-2017-11430](http://web.nvd.nist.gov/vuln/detail/CVE-2017-11430), [CVE-2018-0489](http://web.nvd.nist.gov/vuln/detail/CVE-2018-0489), [CVE-2018-5387](http://web.nvd.nist.gov/vuln/detail/CVE-2018-5387) |
| --- | --- |
| **Date Public:** | 2018-02-27 |
| **Date First Published:** | 2018-02-27 |
| **Date Last Updated:** | 2018-06-05 18:02 UTC |
| **Document Revision:** | 121 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from duo.com_1a1328df_20250126_032343.html ===

[Skip navigation](#main-content)

Search

[Duo Blog](/blog)

* [Docs & Support](/docs)
  + [See All Duo Documentation](/docs)
    - [Getting Started with Duo](/docs/getting-started)
    - [Free Trial Onboarding Guide](/support/free-trial-onboarding-guide)
    - [Duo Essentials Edition](/docs#duo-essentials-features)
    - [Remote Access & VPN](/docs#remote-access-and-vpn)
  + [See All Duo Resources](/resources)
    - [Events & Webinars](/resources/events)
    - [eBooks](/resources/ebooks)
    - [Duo Videos](/resources/videos)
  + [See all Duo Support](/support)
    - [Support for Duo Users](/support#enduserresources)
    - [Support for Admins](/support#adminresources)
    - [Additional Support Information](https://help.duo.com/s/?language=en_US)

[Admin Login](https://admin.duosecurity.com/)

[![Duo Security](/assets/img/duoLogo-web.png)](/)

[![Duo Security](/assets/img/duoLogo-web.png)](/)

* [Admin Login](https://admin.duosecurity.com/)

  Search
* [Our Product](/product)
  ### Duo does it all

  Let us show you. Explore our security stack or request a demo.

  [Contact sales](/about/contact)

  ### [Key Capabilities](/product)

  ### [A black square featuring a prominent circle positioned at its center, creating a striking visual contrast.](/product/passport)

  ### [A fingerprint icon displayed prominently against a solid black background, symbolizing identity and security.](/product/cisco-identity-intelligence)

  ### [A bold check mark within a circle, contrasting sharply with the black background for visual impact.Multi-Factor Authentication (MFA)](/product/multi-factor-authentication-mfa)

  ### [Icon of a radio tower set against a solid black background, symbolizing communication and broadcasting technology.Remote Access](/product/remote-access)

  ### [A computer monitor displaying a phone placed on its surface, illustrating a modern workspace setup.Device Trust](/product/device-trust)

  ### [A gray square positioned centrally against a solid black background, creating a stark contrast in colors.Single Sign-On (SSO)](/product/single-sign-on-sso)

  ### [A gray square featuring a subtle wave pattern, creating a textured and dynamic visual effect.Adaptive Access Policies](/product/adaptive-access-policies)

  ### [Explore Duo Products](/product)

  ### [For Small or Medium Businesses](/product/small-to-medium-business)

  ### [For Enterprise](/product/enterprise)

  ### [For Federal Government](/product/federal-government)

  ### [For State and Local Government](/product/state-and-local-government)
* [Solutions](/solutions)
  ### Security, solved

  Start a free trial to see how Duo can step up your security.

  [Try for free](https://signup.duo.com/)

  ### [All Solutions](/solutions)

  ### [A gray circle centered on a solid black background, creating a striking contrast between the two colors.Continuous Identity Security](/solutions/continuous-identity-security)

  ### [A battery icon featuring two stars, symbolizing high energy or performance.Zero Trust Security](/solutions/zero-trust-security)

  ### [A close-up of a finger with a circular outline surrounding it, emphasizing the finger's position and detail.Passwordless](/solutions/passwordless)

  ### [A simple fish icon displayed prominently against a solid black background.Phishing Prevention](/solutions/phishing-prevention)

  ### [A monochrome icon of a ship's wheel, representing steering and control.Risk-Based Authentication](/solutions/risk-based-authentication)

  ### [All Industries](/solutions)

  ### [K-12 Education](/solutions/k-12)

  ### [Higher Education](/solutions/higher-ed)

  ### [Finance](/solutions/financial)

  ### [Legal](/solutions/legal)

  ### [Retail](/solutions/retail)

  ### [Technology](/solutions/technology)

  ### [Federal Government](/solutions/federal-government)

  ### [State & Local Government](/solutions/state-and-local-government)
* [Why Duo?](/why-duo)
  ### Built for your world

  Duo works where you do, with tools built for your industry’s unique needs.

  [Try for free](https://signup.duo.com/)

  ### [We Have It All](/why-duo)

  ### [Icon of a running man depicted on a solid black background, symbolizing speed and athleticism.Speed to Security](/why-duo/speed-to-security)

  ### [A bold check mark within a circle, contrasting sharply with the black background for visual impact.Next Level MFA](/why-duo/next-level-mfa)

  ### [A shield icon displayed prominently against a solid black background, symbolizing protection and security.Protection and Productivity](/why-duo/protection-and-productivity)

  ### [Cloud icon featuring a prominent check mark, symbolizing approval or successful completion of a task.Complete Protection](/why-duo/complete-coverage)

  ### [About Duo](/about)

  ### [Explore Duo Demos](/demos)

  ### [Explore Customer Stories](/solutions/customer-stories)

  ### [Duo's competitive advantage](/why-duo#duos-competitive-advantage)
* [Pricing](/editions-and-pricing)
  ### Flexible, affordable security

  Get world-class data protection without breaking the bank.

  [Ready to buy now?](/editions-and-pricing/ready-to-buy-now)

  ### CompareEditions

  ![A green circle containing a smaller circle within its center, creating a layered visual effect.](/img/asset/aW1nL2ljb25zL25hdi9jb21wYXJlLWVkaXRpb25zLnBuZw==?s=3acf5c0d481caf92ed20d4db46e1310a)
  [Explore plans](/editions-and-pricing)

  ### Essentials$3/User/Month

  ![A green circle containing three evenly spaced dots within its interior.](/img/asset/aW1nL2ljb25zL25hdi9kdW8tZXNzZW50aWFscy5wbmc=?s=ad160e57abf336bee144a3ef02a280ab)
  [View Essentials](/editions-and-pricing/duo-essentials)

  ### Advantage$6/User/Month

  ![A green circle containing four smaller circles arranged within it, creating a visually balanced design.](/img/asset/aW1nL2ljb25zL25hdi9kdW8tYWR2YW50YWdlLnBuZw==?s=84f217535e6dd91cadb57c16d84f1b3a)
  [View Advantage](/editions-and-pricing/duo-advantage)

  ### Premier$9/User/Month

  ![A green circle adorned with white dots, creating a visually appealing and simple design.](/img/asset/aW1nL2ljb25zL25hdi9kdW8tcHJlbWllci5wbmc=?s=eb72ef69ef64353c59ff8a998496aff2)
  [View Premier](/editions-and-pricing/duo-premier)

  ![A circular icon featuring a green and white design, symbolizing freshness and simplicity.](/img/asset/aW1nL2ljb25zL25hdi9kdW8tZnJlZS5wbmc=?s=b55982c88f5fd6c13726caa710ccb707)
  ### Have a team of 10 users or less?

  [Learn more about Duo Free](/editions-and-pricing/duo-free)

  ### Have a team of 10 users or less?

  ![A circular icon featuring a green and white design, symbolizing freshness and simplicity.](/img/asset/aW1nL2ljb25zL25hdi9kdW8tZnJlZS5wbmc=?s=b55982c88f5fd6c13726caa710ccb707)
  [Learn more about Duo Free](/editions-and-pricing/duo-free)
* [Duo Blog](/blog)
* [Docs & Support](/docs)
  ### [See All Duo Documentation](/docs)

  ### [Getting Started with Duo](/docs/getting-started)

  ### [Free Trial Onboarding Guide](/support/free-trial-onboarding-guide)

  ### [Duo Essentials Edition](/docs#duo-essentials-features)

  ### [Remote Access & VPN](/docs#remote-access-and-vpn)

  ### [See All Duo Resources](/resources)

  ### [Events & Webinars](/resources/events)

  ### [eBooks](/resources/ebooks)

  ### [Duo Videos](/resources/videos)

  ### [See all Duo Support](/support)

  ### [Support for Duo Users](/support#enduserresources)

  ### [Support for Admins](/support#adminresources)

  ### [Additional Support Information](https://help.duo.com/s/?language=en_US)

Search

[Duo Blog](/blog)

* [Docs & Support](/docs)
  + [See All Duo Documentation](/docs)
    - [Getting Started with Duo](/docs/getting-started)
    - [Free Trial Onboarding Guide](/support/free-trial-onboarding-guide)
    - [Duo Essentials Edition](/docs#duo-essentials-features)
    - [Remote Access & VPN](/docs#remote-access-and-vpn)
  + [See All Duo Resources](/resources)
    - [Events & Webinars](/resources/events)
    - [eBooks](/resources/ebooks)
    - [Duo Videos](/resources/videos)
  + [See all Duo Support](/support)
    - [Support for Duo Users](/support#enduserresources)
    - [Support for Admins](/support#adminresources)
    - [Additional Support Information](https://help.duo.com/s/?language=en_US)

[Admin Login](https://admin.duosecurity.com/)

[Contact Sales](/about/contact)
[Free Trial](https://signup.duo.com)

[Contact Sales](/about/contact)
[Free Trial](https://signup.duo.com)

* Keep In Touch

* [Blog Home](/blog)
* Categories

  + [Duo Labs](/blog/category/duo-labs)
  + [Industry Events](/blog/category/industry-events)
  + [Industry News](/blog/category/industry-news)
  + [Product & Engineering](/blog/category/product-and-engineering)
* Archive

  + [January, 2025](/blog/archive/2025/01)
  + [December, 2024](/blog/archive/2024/12)
  + [November, 2024](/blog/archive/2024/11)
  + [October, 2024](/blog/archive/2024/10)
  + [September, 2024](/blog/archive/2024/09)
  + [August, 2024](/blog/archive/2024/08)
  + [July, 2024](/blog/archive/2024/07)
  + [June, 2024](/blog/archive/2024/06)
  + [May, 2024](/blog/archive/2024/05)
  + [April, 2024](/blog/archive/2024/04)
  + [March, 2024](/blog/archive/2024/03)
  + [February, 2024](/blog/archive/2024/02)
* [Categories & Archive](#blog-nav-drawer)

#### Categories & Archive

* [Duo Labs](/blog/category/duo-labs)
* [Industry Events](/blog/category/industry-events)
* [Industry News](/blog/category/industry-news)
* [Product & Engineering](/blog/category/product-and-engineering)

+ [January, 2025](/blog/archive/2025/01)
+ [December, 2024](/blog/archive/2024/12)
+ [November, 2024](/blog/archive/2024/11)
+ [October, 2024](/blog/archive/2024/10)
+ [September, 2024](/blog/archive/2024/09)
+ [August, 2024](/blog/archive/2024/08)
+ [July, 2024](/blog/archive/2024/07)
+ [June, 2024](/blog/archive/2024/06)
+ [May, 2024](/blog/archive/2024/05)
+ [April, 2024](/blog/archive/2024/04)
+ [March, 2024](/blog/archive/2024/03)
+ [February, 2024](/blog/archive/2024/02)

![](/img/asset/aW1nL2Jsb2cvbGlnaHRidWxiLWRpc2NvdmVyeS5qcGc=?w=1440&h=490&fit=crop&s=dfb7f9cb9d9038d8560c5950065df111)

[**Duo Labs**](/blog/category/duo-labs)
###### February 27, 2018 [Kelby Ludwig](/blog/post-author/kludwig)

# Duo Finds SAML Vulnerabilities Affecting Multiple Implementations

This blog post describes a new vulnerability class that affects SAML-based single sign-on (SSO) systems. This vulnerability can allow an attacker with authenticated access to trick SAML systems into authenticating as a different user without knowledge of the victim user’s password.

[Duo Labs](https://duo.com/labs), the advanced research team of Duo Security, has identified multiple vendors that were affected by this flaw:

* OneLogin - python-saml - CVE-2017-11427
* OneLogin - ruby-saml - CVE-2017-11428
* Clever - saml2-js - CVE-2017-11429
* OmniAuth-SAML - CVE-2017-11430
* Shibboleth - CVE-2018-0489
* Duo Network Gateway - CVE-2018-7340

We recommend that individuals that rely on SAML-based SSO to update any affected software to patch this vulnerability. If you are a Duo Security customer running Duo Network Gateway (DNG), please see our [Product Security Advisory here](https://duo.com/labs/psa/duo-psa-2017-003).

## SAML Responses, Briefly

The Security Assertion Markup Language, SAML, is a popular standard used in single sign-on systems. [Greg Seador has written a great pedagogical guide on SAML](https://duo.com/blog/the-beer-drinkers-guide-to-saml) that I highly recommend if you aren't familiar with it.

For the purpose of introducing this vulnerability, the most important concept to grasp is what a SAML `Response` means to a Service Provider (SP), and how it is processed. `Response` processing has a lot of subtleties, but a simplified version often looks like:

* The user authenticates to an Identity Provider (IdP) such as Duo or GSuite which generates a signed SAML `Response`. The user’s browser then forwards this response along to an SP such as Slack or Github.
* The SP validates the SAML `Response`s signature.
* If the signature is valid, a string identifier within the SAML Response (e.g. the `NameID`) will identify which user to authenticate.

A really simplified SAML `Response` could look something like:

```
<SAMLResponse>
    <Issuer>https://idp.com/</Issuer>
    <Assertion ID="_id1234">
        <Subject>
            <NameID>user@user.com</NameID>
        </Subject>
    </Assertion>
    <Signature>
        <SignedInfo>
            <CanonicalizationMethod Algorithm="xml-c14n11"/>
            <Reference URI="#_id1234"/>
        </SignedInfo>
        <SignatureValue>
            some base64 data that represents the signature of the assertion
        </SignatureValue>
    </Signature>
</SAMLResponse>

```

This example omits a lot of information, but that omitted information is not too important for this vulnerability. The two essential elements from the above XML blob are the `Assertion` and the `Signature` element. The `Assertion` element is ultimately saying "Hey, I, the Identity Provider, authenticated the user `user@user.com`." A signature is generated for that `Assertion` element and stored as part of the `Signature` element.

The `Signature` element, if done correctly, should prevent modification of the `NameID`. Since the SP likely uses the `NameID` to determine what user should be authenticated, the signature prevents an attacker from changing their own assertion with the `NameID` "attacker@user.com" to "user@user.com." If an attacker can modify the `NameID` without invalidating the signature, that would be bad (hint, hint)!

## XML Canononononicalizizization: Easier Spelt Than Done

The next relevant aspect of XML signatures is XML canonicalization. XML canonicalization allows two logically equivalent XML documents to have the same byte representation. For example:

```
<A X="1" Y="2">some text<!-- and a comment --></A>

```

and

```
< A Y="2" X="1" >some text</ A >

```

These two documents have different byte representations, but convey the same information (i.e. they are logically equivalent).

Canonicalization is applied to XML elements prior to signing. This prevents practically meaningless differences in the XML document from leading to different digital signatures. This is an important point so I'll emphasize it here: multiple different-but-similar XML documents can have the same exact signature. This is fine, for the most part, as what differences matter are specified by the canonicalization algorithm.

As you might have noticed in the toy SAML Response above, the `CanonicalizationMethod` specifies which canonicalization method to apply prior to signing the document. There are a couple of algorithms outlined in the [XML Signature specification](https://www.w3.org/TR/xmldsig-core1/#sec-c14nAlg), but the most common algorithm in practice seems to be `http://www.w3.org/2001/10/xml-exc-c14n#` (which I'll just shorten to `exc-c14n`).

There is a variant of `exc-c14n` that has the identifier `http://www.w3.org/2001/10/xml-exc-c14n#WithComments`. This variation of `exc-c14n` does not omit comments, so the two XML documents above would *not* have the same canonical representation. This distinction between the two algorithms will be important later.

## XML APIs: One Tree; Many Ways

One of the causes of this vulnerability is a subtle and arguably unexpected behavior of XML libraries like Python’s `lxml` or Ruby’s `REXML`. Consider the following XML element, `NameID`:

```
<NameID>kludwig</NameID>

```

And if you wanted to extract the user identifier from that element, in Python, you may do the following:

```
from defusedxml.lxml import fromstring
payload = "<NameID>kludwig</NameID>"
data = fromstring(payload)
return data.text # should return 'kludwig'

```

Makes sense, right? The `.text` method extracts the text of the `NameID` element.

Now, what happens if I switch things up a bit, and add a comment to this element:

```
from defusedxml.lxml import fromstring
doc = "<NameID>klud<!-- a comment? -->wig</NameID>"
data = fromstring(payload)
return data.text # should return ‘kludwig’?

```

If you would expect the exact same result regardless of the comment addition, I think you are in the same boat as me and many others. However, the `.text` API in `lxml` returns `klud`! Why is that?

Well, I think what `lxml` is doing here is *technically* correct, albeit a bit unintuitive. If you think of the XML document as a tree, the XML document looks like:

```
element: NameID
|_ text: klud
|_ comment: a comment?
|_ text: wig

```

and `lxml` is just not reading text after the first text node ends. Compare that with the uncommented node which would be represented by:

```
element: NameID
|_ text: kludwig

```

Stopping at the first text node in this case makes perfect sense!

Another XML parsing library that exhibits similar behavior is Ruby's `REXML`. The documentation for their [`get_text` method](https://ruby-doc.org/stdlib-2.2.3/libdoc/rexml/rdoc/REXML/Element.html#method-i-get_text) hints at why these XML APIs exhibit this behavior:

```
[get_text] returns the first child Text node, if any, or nil otherwise. This method returns the actual Text node, rather than the String content.

```

Stopping text extraction after the first child, while unintuitive, might be fine if all XML APIs behaved this way. Unfortunately, this is not the case, and some XML libraries have nearly identical APIs but handle text extraction differently:

```
import xml.etree.ElementTree as et
doc = "<NameID>klud<!-- a comment? -->wig</NameID>"
data = et.fromstring(payload)
return data.text # returns 'kludwig'

```

I have also seen a few implementations that don’t leverage an XML API, but do text extraction manually by just extracting the inner text of a node’s first child. This is just another path to the same exact substring text extraction behavior.

## The Vulnerability

So now we have the three ingredients that enable this vulnerability:

* SAML Responses contain strings that identify the authenticating user.
* XML canonicalization (in most cases) will remove comments as part of signature validation, so adding comments to a SAML Response will not invalidate the signature.
* XML text extraction may only return a substring of the text within an XML element when comments are present.

So, as an attacker with access to the account `user@user.com.evil.com`, I can modify *my own* SAML assertions to change the NameID to `user@user.com` when processed by the SP. Now with a simple seven-character addition to the previous toy SAML Response, we have our payload:

```
<SAMLResponse>
    <Issuer>https://idp.com/</Issuer>
    <Assertion ID="_id1234">
        <Subject>
            <NameID>user@user.com<!---->.evil.com</NameID>
        </Subject>
    </Assertion>
    <Signature>
        <SignedInfo>
            <CanonicalizationMethod Algorithm="xml-c14n11"/>
            <Reference URI="#_id1234"/>
        </SignedInfo>
        <SignatureValue>
            some base64 data that represents the signature of the assertion
        </SignatureValue>
    </Signature>
</SAMLResponse>

```
## How Does This Affect Services That Rely on SAML?

Now for the fun part: it varies greatly!

The presence of this behavior is not great, but not always exploitable. SAML IdPs and SPs are generally very configurable, so there is lots of room for increasing or decreasing impact.

For example, SAML SPs that use email addresses and validate their domain against a whitelist are much less likely to be exploitable than SPs that allow arbitrary strings as user identifiers.

On the IdP side, openly allowing users to register accounts is one way to increase the impact of this issue. A manual user provisioning process may add a barrier to entry that makes exploitation a bit more infeasible.

## Remediation

Remediation of this issue somewhat depends on what relationship you have with SAML.

### For Users of Duo’s Software

Duo has released updates for the [Duo Network Gateway](https://duo.com/docs/dng) in **version 1.2.10**. If you use the DNG as a SAML Service Provider and are not at version 1.2.10 or higher (at the time of writing this, 1.2.10 is the latest version), we recommend upgrading.

Learn more in [Duo’s Product Security Advisory (PSA)](https://duo.com/labs/psa/duo-psa-2017-003) for this vulnerability.

### If You Run or Maintain an Identity Provider or Service Provider

The best remediation is to ensure your SAML processing libraries are not affected by this issue. We identified several SAML libraries that either leveraged these unintuitive XML APIs or did faulty manual text extraction, but I'm sure there are more libraries out there that don't handle comments in XML nodes well.

Another possible remediation could be defaulting to a canonicalization algorithm such as `http://www.w3.org/2001/10/xml-exc-c14n#WithComments` which does not omit comments during canonicalization. This canonicalization algorithm would cause comments added by an attacker to invalidate the signature, but the canonicalization algorithm identifier itself must not be subject to tampering. This modification, however, would require IdP and SP support, which may not be universal.

Additionally, if your SAML Service Provider enforces [two-factor authentication](https://duo.com/resources/glossary/two-factor-authentication), that helps a lot because this vulnerability would only allow a bypass of a user’s first factor of authentication. Note that if your IdP is responsible for both first factor and second factor authentication, it’s likely that this vulnerability bypasses both!

### If You Maintain a SAML Processing Library

The most obvious remediation here is ensuring your SAML library is extracting the full text of a given XML element when comments are present. Most SAML libraries I found had some form of unit tests, and it was fairly easy to update the tests which extracted properties like `NameID`s and just add comments to pre-signed documents. If the tests continue to pass, great! Otherwise, you may be vulnerable.

Another possible remediation is updating libraries to use the canonicalized XML document after signature validation for any processing such as text extraction. This could prevent this vulnerability as well as other vulnerabilities that could be introduced by XML canonicalization issues.

### If You Maintain an XML Parsing Library

Personally, I think the number of libraries affected by this vulnerability suggest that many users also seem to assume XML inner text APIs are not affected by comments, so that could be a motivating factor to change an API’s behavior. However, I don't think there is a clear right answer for XML library authors, and a very reasonable action may be keeping the APIs as they are and improving documentation surrounding this behavior.

Another possible remediation path is improving the XML standards. Through my research, I did not identify any standards that specified the correct behavior, and it may be worth specifying how these related standards should interoperate.

## Disclosure Timeline

Our disclosure policy can be found here <https://www.duo.com/labs/disclosure>. In this case, due to the vulnerability impacting multiple vendors, we decided to work with CERT/CC to coordinate disclosure. The following is a high-level disclosure timeline:

| Date | Activity |
| --- | --- |
| 2017-12-18 | CERT/CC contacted and provided vulnerability information. |
| 2017-12-20 | CERT/CC follows up with questions about the issue. |
| 2017-12-22 | Response to questions from CERT/CC. |
| 2018-01-02 to 2018-01-09 | Additional email discussion with CERT/CC about the issue. |
| 2018-01-24 | CERT/CC completes internal analysis and contacts impacted vendors. |
| 2018-01-25 | Vendors acknowledge CERT/CC report. Additional communication with CERT/CC and vendors to further explain the issue and other attack vectors. |
| 2018-01-29 | Additional vendor that is potentially impacted identified and contacted by CERT/CC. |
| 2018-02-01 | Duo Labs reserves CVE #s for each impacted vendor. |
| 2018-02-06 | Draft of CERT/CC vulnerability technical note reviewed and approved by Duo. |
| 2018-02-20 | Final confirmation that all impacted vendors are ready for disclosure date. |
| 2018-02-27 | Disclosure. |

We would like to thank CERT/CC for helping us disclose this vulnerability and we appreciate all of the efforts put forth by each and everyone who was contacted by CERT/CC to quickly respond to this issue.

### Tags

* [Saml Vulnerability](/blog/tags/saml-vulnerability)
* [Two Factor Authentication](/blog/tags/two-factor-authentication)
* [Labs](/blog/tags/labs)

### Authors

* [![Kelby Ludwig, Appsec Engineer](/img/asset/aW1nL2F2YXRhcnMva2x1ZHdpZy5qcGc=?w=240&h=240&fit=crop&s=4837df07fb03d3ccbf39c552d060886b)](/blog/post-author/kludwig)
  [###### Kelby Ludwig

  ###### AppSec Engineer](/blog/post-author/kludwig)
  [###### @kelbyludwig](https://x.com/kelbyludwig)

### Related

* ###### [PRODUCT & ENGINEERING](/blog/category/product-and-engineering)

  ##### [Opening the Black Box of Risk-Based Authentication](/blog/opening-the-black-box-of-risk-based-authentication)
* ###### [INDUSTRY NEWS](/blog/category/industry-news)

  ##### [Understanding the Silver SAML Vulnerability & How Duo SSO Can Help](/blog/understanding-silver-saml-vulnerability-how-duo-sso-can-help)
* ###### [PRODUCT & ENGINEERING](/blog/category/product-and-engineering)

  ##### [T-Minus 365 and Counting! Deploy Universal Prompt to Strengthen Security While Improving User Experience](/blog/deploy-universal-prompt-strengthen-security-improve-user-experience)

![Duo Security logo](/assets/img/duoLogo-web-white.png)

Search

### International Resources:

* Select Language
  Français
  Deutsch
  Español
  日本語

  Select Language
* [Français](/fr-ca)
  [Deutsch](/de/duo-overview)
  [Español](/es/duo-overview)
  [日本語](/ja-jp)

### Support

* #### Duo Support
* [Duo Support](/support)
* [System Status](https://status.duo.com/)

* #### Support for End Users
* [End User Guides](https://guide.duo.com/)
* [Duo Mobile FAQ](https://help.duo.com/s/topic/0TO70000000LIT2GAO/duo-mobile?language=en_US&tabset-5ba34=2)

* [Get Duo Mobile iOS](https://apps.apple.com/us/app/duo-mobile/id422663827?mt=8)
* [Get Duo Mobile Android](https://play.google.com/store/apps/details?id=com.duosecurity.duomobile&hl=en)

* #### Support for Admins
* [Knowledge Base](https://help.duo.com/s/?language=en_US)
* [Community Forum](https://community.cisco.com/t5/duo-security/ct-p/duo-security)

### Products

* #### [Key Capabilities](/product)
* [Duo Passport](/product/passport)
* [Cisco Identity Intelligence](/product/cisco-identity-intelligence)
* [Mobile App](/product/multi-factor-authentication-mfa/duo-mobile-app)
* [MFA](/product/multi-factor-authentication-mfa)
* [What is MFA](/product/multi-factor-authentication-mfa/what-is-mfa)
* [2FA](/product/multi-factor-authentication-mfa/two-factor-authentication-2fa)
* [Remote Access](/product/remote-access)
* [Device Trust](/product/device-trust)
* [Single Sign-On](/product/single-sign-on-sso)
* [Passwordless](/solutions/passwordless)
* [Zero Trust](/solutions/zero-trust-security)
* [Adaptive Access Policies](/product/adaptive-access-policies)
* #### [Duo Use Cases](/product)
* [State & Local Government](/product/state-and-local-government)
* [Federal Government](/product/federal-government)
* [Enterprise](/product/enterprise)
* [Small to Medium Business](/product/small-to-medium-business)

### Solutions

* #### [All Solutions](/solutions)
* [Continuous Identity Security](/solutions/continuous-identity-security)
* [Access Management](/solutions/access-management)
* [Zero Trust Security](/solutions/zero-trust-security)
* [Passwordless](/solutions/passwordless)
* [Phishing Prevention](/solutions/phishing-prevention)
* [Risk-Based Authentication](/solutions/risk-based-authentication)

### Editions & Partners

* #### [Editions](/editions-and-pricing)
* [Duo Editions](/editions-and-pricing)
* [Duo Free](/editions-and-pricing/duo-free)
* [Duo Essentials](/editions-and-pricing/duo-essentials)
* [Duo Advantage](/editions-and-pricing/duo-advantage)
* [Duo Premier](/editions-and-pricing/duo-premier)
* [Ready to Buy Now?](/editions-and-pricing/ready-to-buy-now)
* #### [Partner with Duo](/partnerships)
* [Partnership Program](/partnerships)
* [Technology Partner Program](/partnerships/technology-partners)
* [Managed Service Provider](/partnerships/managed-service-providers)
* [Security Solutions Provider](/partnerships/security-solution-providers)

### Resources & Docs

* #### [Resources](/resources)
* [About Duo](/about)
* [Careers](/careers)
* [News & Press](/resources/news-and-press)
* [Events & Webinars](/resources/events)
* [Ebooks](/resources/ebooks)
* [Duo Videos](/resources/videos)
* [Interactive Demos](/demos)
* [InfoSec Glossary](/resources/glossary)
* #### [Docs](/docs)
* [Getting Started with Duo](/docs/getting-started)
* [Free Trial Onboarding Guide](/support/free-trial-onboarding-guide)
* [Admin Overview](/docs/administration)
* [End User Guide](https://guide.duo.com/)
* [Docs for Duo Editions](/docs)
* [Docs for Duo Integrations](/docs)

**© 2025 Duo**

* [Terms of Service](/legal/terms)
* [Privacy Statement](/legal/cisco-online-privacy-statement)
* [Duo Privacy Data Sheet](https://trustportal.cisco.com/c/dam/r/ctp/docs/privacydatasheet/security/cisco-duo-privacy-data-sheet.pdf)
* [Copyright Dispute Policy](https://www.cisco.com/c/en/us/about/legal/terms-conditions.html)
* [Service Level Agreement](/legal/sla)
* [Security Response](/support/security-and-reliability/security-response)
* [Cookies](#privacy-manager "Cisco Cookie Consent Manager")

[Top](#top)


