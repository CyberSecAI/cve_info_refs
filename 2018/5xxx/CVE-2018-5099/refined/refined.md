```
{
  "CVE-2018-5099": {
    "description": "A use-after-free vulnerability can occur when the widget listener is holding strong references to browser objects that have previously been freed, resulting in a potentially exploitable crash when these references are used.",
    "vulnerability": {
      "root cause": "A use-after-free vulnerability due to the widget listener holding strong references to freed browser objects.",
      "weaknesses": [
        "Use-after-free"
      ],
      "impact": "Potentially exploitable crash.",
       "attack vectors": [
        "By manipulating window resize events and closing the window with a javascript event handler"
      ],
      "attacker capabilities": "An attacker needs to find a way to put the malicious code into the proper memory region right after nsWebBrowser / nsWebShellWindow gets free'd."
    },
    "affected_products": [
      "Firefox ESR 52",
       "Firefox 58",
       "Firefox 59",
       "Thunderbird 52.6",
      "Red Hat Enterprise Linux 6",
      "Red Hat Enterprise Linux 7"
    ],
     "patch_details": "The fix involves moving the nsIWidgetListener implementation off of nsWebShellWindow onto a separate object. That object would take a ref on the stack to the nsWebShellWindow before calling into it from WindowResized. A strong reference is held to ensure the window objects are not released before the resize event is finished being handled."
  }
}
```