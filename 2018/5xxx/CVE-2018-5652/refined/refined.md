The provided content details a Stored Cross-Site Scripting (XSS) vulnerability found in the "dark-mode" WordPress plugin.

**Root cause of vulnerability:**
The plugin fails to properly sanitize user-supplied input for the `dark_mode_start` and `dark_mode_end` parameters within the user profile settings.

**Weaknesses/vulnerabilities present:**
- Stored XSS: Malicious JavaScript code injected through the vulnerable parameters is stored in the database and executed when the affected pages are rendered.
- Insufficient input sanitization: The plugin does not sanitize the input for `dark_mode_start` and `dark_mode_end` before storing it in the database.

**Impact of exploitation:**
- Cookie theft: An attacker can steal cookies of users who view the profile page.
- Arbitrary JavaScript execution: An attacker can execute arbitrary JavaScript code in the context of the victim's browser.
- Account takeover:  By stealing cookies, an attacker could gain unauthorized access to user accounts.
- Other malicious actions: The attacker can perform other malicious actions based on the user's privileges, such as modifying content, redirecting users, or performing actions on behalf of the user.

**Attack vectors:**
- The vulnerability is triggered when a user with the contributor role inputs the malicious payload into the `dark_mode_start` and `dark_mode_end` fields within their user profile.
- When another user, such as a manager, edits the profile page of the user who injected the payload, the stored XSS payload is executed.

**Required attacker capabilities/position:**
- The attacker needs to have a contributor role to inject the payload through the user profile settings.
- The attacker needs a victim to view the profile page, causing the stored XSS to be executed. This can be a manager or another user with sufficient permissions to view the affected user's profile page.