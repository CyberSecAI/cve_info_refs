The provided content details Stored XSS and CSRF vulnerabilities in the Wordpress Booking Calendar plugin, version 1.8.4.

**Root Cause of Vulnerability:**

*   **Stored XSS:** Insufficient input sanitization/validation when processing data from the 'Extras', 'Themes', and 'Forms' sections of the plugin's admin panel.
*   **CSRF:** Lack of CSRF protection for POST requests to the plugin's admin pages.

**Weaknesses/Vulnerabilities Present:**

*   **Stored XSS:** Malicious scripts can be injected through specific parameters when editing plugin settings. These scripts are then stored in the database and executed when other users (including admins) view the affected pages.
    *   Specifically identified parameters:
        *   `extra_field1[items][field_item1][price_percent]` in the "Extras" section
        *    `sale_conditions[count][]` in the "Themes" section
        *   `form_field5[label]` in the "Forms" section
*   **CSRF:**  An attacker can craft a malicious HTML page that, when visited by an authenticated admin user, will cause the user's browser to send a crafted request to the vulnerable plugin, leading to unintended changes to the plugin's settings (e.g., injecting malicious javascript through stored XSS).

**Impact of Exploitation:**

*   **Stored XSS:**
    *   Session hijacking: Attacker can steal cookies of other users who view the affected pages (including admin users), thus gaining unauthorized access.
    *   Malicious actions: Attacker can perform arbitrary actions on behalf of the victim user (e.g., change website content, install backdoors).
*   **CSRF:**
    *   Unauthorized modifications:  Attacker can modify plugin configurations, potentially leading to further compromises or disruptions (in combination with the XSS).

**Attack Vectors:**

*   **Stored XSS:**
    1.  An attacker with editor or admin privileges crafts malicious input by manipulating specific parameters in the 'Extras', 'Themes', or 'Forms' settings.
    2.  The malicious input is saved to the database.
    3.  When any other user (including an admin) views these settings, the stored XSS payload is executed in their browser.
*   **CSRF:**
    1.  An attacker crafts a malicious HTML page containing a form that submits data to the vulnerable plugin's admin page (e.g., modifying forms).
    2.  The attacker tricks an authenticated user (e.g., an admin) into visiting the malicious HTML page.
    3.  The victim user's browser sends the forged request, exploiting the lack of CSRF protection, leading to unauthorized changes.

**Required Attacker Capabilities/Position:**

*   **Stored XSS:**
    *   Low privilege access is required, such as an editor user, to access the vulnerable plugin settings.
    *   Ability to modify plugin settings
*   **CSRF:**
    *   Ability to host malicious HTML page.
    *   Ability to trick an authenticated user (admin) into visiting the malicious page.

The content provides more detail than a typical CVE description by providing specific vulnerable parameters and a PoC for the CSRF vulnerability.