```
{
  "vulnerability": {
    "CVE": "CVE-2018-17057",
    "description": "A security vulnerability in TCPDF allows a logged in back end user to implant arbitrary code which is executed when an article is exported as PDF in the front end, by using a manipulated image file. This is due to a phar deserialization vulnerability.",
    "root_cause": "The vulnerability stems from insecure handling of the phar:// wrapper in TCPDF when processing HTML content. This allows for the deserialization of a malicious PHP object when a crafted phar archive is referenced in a 'link' tag within the HTML, leading to arbitrary code execution.",
    "weaknesses": [
      "Insecure deserialization of user-controlled data",
      "Lack of sanitization of input passed to file inclusion mechanisms",
      "Improper handling of file stream wrappers"
    ],
    "impact": "Arbitrary code execution. An attacker can execute arbitrary code on the server, potentially leading to full system compromise, data breaches, and other malicious activities.",
    "attack_vectors": [
      "Maliciously crafted HTML content, specifically a 'link' tag referencing a phar archive using the phar:// wrapper.",
      "Injection of malicious HTML via Cross-Site Scripting (XSS) or Code Injection vulnerabilities in the web application using TCPDF."
    ],
    "required_capabilities": [
      "Ability to inject arbitrary HTML content into a web application using TCPDF.",
      "Ability to upload a malicious phar archive to a location accessible to the web server."
    ],
    "additional_details": "The vulnerability is triggered when the `writeHTML()` function in TCPDF is used to process the malicious HTML content. The issue was initially fixed in TCPDF version 6.2.22 but was later reintroduced and then patched again in subsequent versions.",
   "affected_versions": "TCPDF versions 6.2.19 and earlier are known to be vulnerable. Contao versions 3.* up to 3.5.35, 4.1, 4.2, 4.3, 4.4 up to 4.4.34, 4.5, and 4.6 up to 4.6.3 are also affected because they use vulnerable TCPDF versions. LimeSurvey versions prior to 3.16 are also vulnerable."
  }
}
```