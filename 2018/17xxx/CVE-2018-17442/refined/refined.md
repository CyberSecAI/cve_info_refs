```
Root cause of vulnerability:
- Unrestricted file upload vulnerability via the `onUploadLogPic` endpoint.

Weaknesses/vulnerabilities present:
- Unrestricted file upload of a .rar file containing a malicious PHP file.
-  The uploaded .rar file is decompressed and stored in the `/web/captivalportal` directory within a timestamp-named folder.
- The application does not properly validate the file type or contents.

Impact of exploitation:
- Remote code execution with the privileges of the web application.
- Attackers can upload and execute arbitrary PHP code on the server.

Attack vectors:
- The attacker must be an authenticated user of the web application.
- The attacker uploads a specially crafted .rar file containing a malicious PHP file via the `onUploadLogPic` endpoint.
- The attacker needs to determine the server time to access the uploaded file through the web application. This is done by requesting the server date and time.
- The attacker calculates the expected directory path and requests the uploaded PHP file.

Required attacker capabilities/position:
- Attacker needs to have valid credentials to log in to the web application.
- Network access to the vulnerable server.
```