Based on the provided content, here's an analysis of CVE-2018-17156:

**Root Cause of Vulnerability:**

*   The vulnerability lies in the `icmp_error` routine within the FreeBSD kernel.
*   The routine allocates memory (either an mbuf or a cluster) to store data to be quoted in an ICMP reply.
*   The calculation for the required buffer size failed to account for additional padding on 64-bit platforms. This occurs when a non-default value for `net.inet.icmp.quotelen` sysctl variable is set.

**Weaknesses/Vulnerabilities Present:**

*   **Buffer Underwrite:** When the `net.inet.icmp.quotelen` is set to a non-default value, the incorrect buffer size calculation leads to a buffer underwrite condition. This means the code attempts to write data before the beginning of the allocated buffer, potentially overwriting adjacent memory.

**Impact of Exploitation:**

*   **Memory Corruption:** The underwrite condition leads to memory corruption.
*   The advisory does not specify the exact impact of memory corruption, but it typically leads to a variety of issues, including system instability, crashes, and potentially arbitrary code execution if the corrupted memory is controlled by the attacker.

**Attack Vectors:**

*   The vulnerability is triggered by sending crafted ICMP packets to a vulnerable system.
*   Specifically, ICMP packets that trigger the `icmp_error` routine, which then tries to quote the relevant packet data and runs into the buffer underwrite due to incorrect size calculation.

**Required Attacker Capabilities/Position:**

*   **Network Access:** An attacker needs the ability to send network packets to the vulnerable system.
*   **Knowledge of System Configuration:** The attacker needs knowledge about the system's configuration such as `net.inet.icmp.quotelen` not being at default value.