=== Content from github.com_d03b53be_20250125_015407.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitcoin%2Fbitcoin%2Fblob%2Fv0.16.2%2Fdoc%2Frelease-notes.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitcoin%2Fbitcoin%2Fblob%2Fv0.16.2%2Fdoc%2Frelease-notes.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=bitcoin%2Fbitcoin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bitcoin](/bitcoin)
/
**[bitcoin](/bitcoin/bitcoin)**
Public

* [Notifications](/login?return_to=%2Fbitcoin%2Fbitcoin) You must be signed in to change notification settings
* [Fork
  36.6k](/login?return_to=%2Fbitcoin%2Fbitcoin)
* [Star
   81.6k](/login?return_to=%2Fbitcoin%2Fbitcoin)

* [Code](/bitcoin/bitcoin/tree/v0.16.2)
* [Issues
  382](/bitcoin/bitcoin/issues)
* [Pull requests
  306](/bitcoin/bitcoin/pulls)
* [Actions](/bitcoin/bitcoin/actions)
* [Projects
  5](/bitcoin/bitcoin/projects)
* [Security](/bitcoin/bitcoin/security)
* [Insights](/bitcoin/bitcoin/pulse)

Additional navigation options

* [Code](/bitcoin/bitcoin/tree/v0.16.2)
* [Issues](/bitcoin/bitcoin/issues)
* [Pull requests](/bitcoin/bitcoin/pulls)
* [Actions](/bitcoin/bitcoin/actions)
* [Projects](/bitcoin/bitcoin/projects)
* [Security](/bitcoin/bitcoin/security)
* [Insights](/bitcoin/bitcoin/pulse)

## Files

 v0.16.2
## Breadcrumbs

1. [bitcoin](/bitcoin/bitcoin/tree/v0.16.2)
2. /[doc](/bitcoin/bitcoin/tree/v0.16.2/doc)
/
# release-notes.md

Copy path Blame  Blame
## Latest commit

## History

[History](/bitcoin/bitcoin/commits/v0.16.2/doc/release-notes.md)116 lines (88 loc) · 4.23 KB v0.16.2
## Breadcrumbs

1. [bitcoin](/bitcoin/bitcoin/tree/v0.16.2)
2. /[doc](/bitcoin/bitcoin/tree/v0.16.2/doc)
/
# release-notes.md

Top
## File metadata and controls

* Preview
* Code
* Blame

116 lines (88 loc) · 4.23 KB[Raw](https://github.com/bitcoin/bitcoin/raw/refs/tags/v0.16.2/doc/release-notes.md)

Bitcoin Core version 0.16.2 is now available from:

<https://bitcoincore.org/bin/bitcoin-core-0.16.2/>

This is a new minor version release, with various bugfixes
as well as updated translations.

Please report bugs using the issue tracker at GitHub:

<https://github.com/bitcoin/bitcoin/issues>

To receive security and update notifications, please subscribe to:

<https://bitcoincore.org/en/list/announcements/join/>

# How to Upgrade

If you are running an older version, shut it down. Wait until it has completely
shut down (which might take a few minutes for older versions), then run the
installer (on Windows) or just copy over `/Applications/Bitcoin-Qt` (on Mac)
or `bitcoind`/`bitcoin-qt` (on Linux).

The first time you run version 0.15.0 or newer, your chainstate database will be converted to a
new format, which will take anywhere from a few minutes to half an hour,
depending on the speed of your machine.

Note that the block database format also changed in version 0.8.0 and there is no
automatic upgrade code from before version 0.8 to version 0.15.0 or higher. Upgrading
directly from 0.7.x and earlier without re-downloading the blockchain is not supported.
However, as usual, old wallet versions are still supported.

## Downgrading warning

Wallets created in 0.16 and later are not compatible with versions prior to 0.16
and will not work if you try to use newly created wallets in older versions. Existing
wallets that were created with older versions are not affected by this.

# Compatibility

Bitcoin Core is extensively tested on multiple operating systems using
the Linux kernel, macOS 10.8+, and Windows Vista and later. Windows XP is not supported.

Bitcoin Core should also work on most other Unix-like systems but is not
frequently tested on them.

## 0.16.2 change log

### Wallet

* #13622 `c04a4a5` Remove mapRequest tracking that just effects Qt display. (TheBlueMatt)
* #12905 `cfc6f74` [rpcwallet] Clamp walletpassphrase value at 100M seconds (sdaftuar)
* #13437 `ed82e71` wallet: Erase wtxOrderd wtx pointer on removeprunedfunds (MarcoFalke)

### RPC and other APIs

* #13451 `cbd2f70` rpc: expose CBlockIndex::nTx in getblock(header) (instagibbs)
* #13507 `f7401c8` RPC: Fix parameter count check for importpubkey (kristapsk)
* #13452 `6b9dc8c` rpc: have verifytxoutproof check the number of txns in proof structure (instagibbs)
* #12837 `bf1f150` rpc: fix type mistmatch in `listreceivedbyaddress` (joemphilips)
* #12743 `657dfc5` Fix csBestBlock/cvBlockChange waiting in rpc/mining (sipa)

### GUI

* #12432 `f78e7f6` [qt] send: Clear All also resets coin control options (Sjors)
* #12617 `21dd512` gui: Show messages as text not html (laanwj)
* #12793 `cf6feb7` qt: Avoid reseting on resetguisettigs=0 (MarcoFalke)

### Build system

* #13544 `9fd3e00` depends: Update Qt download url (fanquake)
* #12573 `88d1a64` Fix compilation when compiler do not support `__builtin_clz*` (532479301)

### Tests and QA

* #13061 `170b309` Make tests pass after 2020 (bmwiedemann)
* #13192 `79c4fff` [tests] Fixed intermittent failure in `p2p_sendheaders.py` (lmanners)
* #13300 `d9c5630` qa: Initialize lockstack to prevent null pointer deref (MarcoFalke)
* #13545 `e15e3a9` tests: Fix test case `streams_serializedata_xor` Remove Boost dependency. (practicalswift)
* #13304 `cbdabef` qa: Fix `wallet_listreceivedby` race (MarcoFalke)

### Miscellaneous

* #12887 `2291774` Add newlines to end of log messages (jnewbery)
* #12859 `18b0c69` Bugfix: Include for `std::unique_ptr` (luke-jr)
* #13131 `ce8aa54` Add Windows shutdown handler (ken2812221)
* #13652 `20461fc` rpc: Fix that CWallet::AbandonTransaction would leave the grandchildren, etc. active (Empact)

# Credits

Thanks to everyone who directly contributed to this release:

* 532479301
* Ben Woosley
* Bernhard M. Wiedemann
* Chun Kuan Lee
* Cory Fields
* fanquake
* Gregory Sanders
* joemphilips
* John Newbery
* Kristaps Kaupe
* lmanners
* Luke Dashjr
* MarcoFalke
* Matt Corallo
* Pieter Wuille
* practicalswift
* Sjors Provoost
* Suhas Daftuar
* Wladimir J. van der Laan

And to those that reported security issues:

* Braydon Fuller
* Himanshu Mehta

As well as everyone that helped translating on [Transifex](https://www.transifex.com/projects/p/bitcoin/).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b9e751de_20250126_051058.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftuxcanfly)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftuxcanfly)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@tuxcanfly](https://avatars.githubusercontent.com/u/132667?s=64&v=4)

**tuxcanfly**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Ftuxcanfly)

[Overview](/tuxcanfly)
[Repositories
198](/tuxcanfly?tab=repositories)
[Projects
0](/tuxcanfly?tab=projects)
[Packages
0](/tuxcanfly?tab=packages)
[Stars
5k+](/tuxcanfly?tab=stars)
[Sponsoring
2](/tuxcanfly?tab=sponsoring)

More

* [Overview](/tuxcanfly)
* [Repositories](/tuxcanfly?tab=repositories)
* [Projects](/tuxcanfly?tab=projects)
* [Packages](/tuxcanfly?tab=packages)
* [Stars](/tuxcanfly?tab=stars)
* [Sponsoring](/tuxcanfly?tab=sponsoring)

![@tuxcanfly](https://avatars.githubusercontent.com/u/132667?s=64&v=4)

**tuxcanfly**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Ftuxcanfly)

[![View tuxcanfly's full-sized avatar](https://avatars.githubusercontent.com/u/132667?v=4)](https://avatars.githubusercontent.com/u/132667?v=4)
🏠

Working from home

# Javed Khan tuxcanfly

🏠

Working from home

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Ftuxcanfly)

Core Developer
[986
followers](https://github.com/tuxcanfly?tab=followers) · [7k
following](https://github.com/tuxcanfly?tab=following)

* [@bcoin-org](https://github.com/bcoin-org) [@handshake-org](https://github.com/handshake-org)
* Remote
* <http://tuxcanfly.me/>
* X
  [@tuxcanfly](https://twitter.com/tuxcanfly)

## [Achievements](/tuxcanfly?tab=achievements)

[![Achievement: Pair Extraordinaire](https://github.githubassets.com/assets/pair-extraordinaire-default-579438a20e01.png)x3](/tuxcanfly?achievement=pair-extraordinaire&tab=achievements)[![Achievement: YOLO](https://github.githubassets.com/assets/yolo-default-be0bbff04951.png)](/tuxcanfly?achievement=yolo&tab=achievements)[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default--medium-0bdca502f5b4.png)](/tuxcanfly?achievement=quickdraw&tab=achievements)[![Achievement: Public Sponsor](https://github.githubassets.com/assets/public-sponsor-default-9fa68986b057.png)](/tuxcanfly?achievement=public-sponsor&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/tuxcanfly?achievement=arctic-code-vault-contributor&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x3](/tuxcanfly?achievement=pull-shark&tab=achievements)[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default--medium-2670f78c9f2f.png)](/tuxcanfly?achievement=starstruck&tab=achievements)
## [Achievements](/tuxcanfly?tab=achievements)

[![Achievement: Pair Extraordinaire](https://github.githubassets.com/assets/pair-extraordinaire-default-579438a20e01.png)x3](/tuxcanfly?achievement=pair-extraordinaire&tab=achievements)[![Achievement: YOLO](https://github.githubassets.com/assets/yolo-default-be0bbff04951.png)](/tuxcanfly?achievement=yolo&tab=achievements)[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default--medium-0bdca502f5b4.png)](/tuxcanfly?achievement=quickdraw&tab=achievements)[![Achievement: Public Sponsor](https://github.githubassets.com/assets/public-sponsor-default-9fa68986b057.png)](/tuxcanfly?achievement=public-sponsor&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/tuxcanfly?achievement=arctic-code-vault-contributor&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x3](/tuxcanfly?achievement=pull-shark&tab=achievements)[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default--medium-2670f78c9f2f.png)](/tuxcanfly?achievement=starstruck&tab=achievements)
## Organizations

[![@agiliq](https://avatars.githubusercontent.com/u/95932?s=64&v=4)](/agiliq) [![@bcoin-org](https://avatars.githubusercontent.com/u/17676391?s=64&v=4)](/bcoin-org)

Block or Report

# Block or report tuxcanfly

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user’s behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=tuxcanfly+%28user%29)

[Overview](/tuxcanfly)
[Repositories
198](/tuxcanfly?tab=repositories)
[Projects
0](/tuxcanfly?tab=projects)
[Packages
0](/tuxcanfly?tab=packages)
[Stars
5k+](/tuxcanfly?tab=stars)
[Sponsoring
2](/tuxcanfly?tab=sponsoring)

More

* [Overview](/tuxcanfly)
* [Repositories](/tuxcanfly?tab=repositories)
* [Projects](/tuxcanfly?tab=projects)
* [Packages](/tuxcanfly?tab=packages)
* [Stars](/tuxcanfly?tab=stars)
* [Sponsoring](/tuxcanfly?tab=sponsoring)

## Pinned Loading

1. [bcoin-org/bcoin](/bcoin-org/bcoin) bcoin-org/bcoin Public

   Javascript bitcoin library for node.js and browsers

   JavaScript

   [3k](/bcoin-org/bcoin/stargazers)
   [812](/bcoin-org/bcoin/forks)
2. [btcsuite/btcd](/btcsuite/btcd) btcsuite/btcd Public

   An alternative full node bitcoin implementation written in Go (golang)

   Go

   [6.3k](/btcsuite/btcd/stargazers)
   [2.4k](/btcsuite/btcd/forks)
3. [spesmilo/electrum](/spesmilo/electrum) spesmilo/electrum Public

   Electrum Bitcoin Wallet

   Python

   [7.7k](/spesmilo/electrum/stargazers)
   [3.2k](/spesmilo/electrum/forks)
4. [btcsuite/btcwallet](/btcsuite/btcwallet) btcsuite/btcwallet Public

   A secure bitcoin wallet daemon written in Go (golang)

   Go

   [1.2k](/btcsuite/btcwallet/stargazers)
   [602](/btcsuite/btcwallet/forks)
5. [btcsuite/btcsim](/btcsuite/btcsim) btcsuite/btcsim Public

   Go

   [37](/btcsuite/btcsim/stargazers)
   [31](/btcsuite/btcsim/forks)
6. [kpx](/tuxcanfly/kpx) kpx Public

   kpx is a keepassx client written in go

   Go

   [13](/tuxcanfly/kpx/stargazers)
   [2](/tuxcanfly/kpx/forks)

Something went wrong, please refresh the page to try again.

If the problem persists, check the [GitHub status page](https://www.githubstatus.com/)
or [contact support](/contact).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from invdos.net_a73d6da1_20250125_015409.html ===
CVE-2018-17145: Bitcoin Inventory
Out-of-Memory Denial-of-Service Attack

Braydon Fuller and Javed Khan

September 9th, 2020

Abstract

This paper describes an easily exploitable uncontrolled memory re-
source consumption denial-of-service vulnerability that existed in the peer-
to-peer network code of three implementations of Bitcoin and other blockchains
including Litecoin, Namecoin and Decred.

1 Attack Overview

There was an uncontrolled resource consumption and out-of-memory (OOM)
vulnerability that could have been easily exploited in a denial-of-service (DoS/D-
DoS) attack against many Bitcoin, Litecoin, Namecoin and Decred nodes by
any other network participant. The vulnerable versions include: Bitcoin Core
v0.16.0, Bitcoin Core v0.16.1, Bitcoin Knots v0.16.0, all beta versions of Bcoin
up to v1.0.0-pre, all versions of Btcd up to v0.20.1-beta, Litecoin Core v0.16.0,
Namecoin Core v0.16.1, and all versions of Dcrd up to v1.5.1.

The vulnerability has been patched in Bitcoin Core v0.16.2+, Bitcoin Knots
v0.16.2+, Bcoin v1.0.2+, Btcd v0.21.0-beta+, Litecoin Core v0.16.2+, Name-
coin v0.16.2+, and Dcrd v1.5.2+ releases. The issue does not aﬀect earlier
versions of Bitcoin Core and derivatives including v0.15 and earlier.

The vulnerability was discovered on Friday, June 22nd, 2018 by Braydon
Fuller of the Bcoin protocol team at Purse. At the time of the discovery this
represented more than 50% of publicly advertised Bitcoin nodes with inbound
traﬃc [1], and likely a majority of miners and exchanges. The vulnerability in
Bitcoin Core was introduced on November 15th, 2017 in pull request #10286
of Bitcoin Core and released in versions v0.16.0 and v0.16.1 of Bitcoin Core.
Disclosure was made on Monday, July 9th 2018 to Bitcoin Core and Litecoin
Core maintainers, and covertly patched on the following day in pull request
#13622. Many forks of Bitcoin Core are not aﬀected as they were forked earlier
or haven’t incorporated the updates. Projects such as Zcash, Bitcoin ABC,
Bitcoin Gold, Bitcoin Unlimited, Bitcoin XT did not include the vulnerable
code at the time of discovery.

On Friday, June 26th, 2020 it was discovered that the vulnerability also
existed in Btcd by Javed Khan. With additional research it was also found to

1

aﬀect Dcrd on Tuesday, July 7th, 2020. The vulnerability was reported to the
Decred Bug Bounty program. At the time of discovery this represented 100%
of the Decred nodes and 100% of nodes serving compact block ﬁlters to Bitcoin
Lightning wallets.

It could be possible to escalate the severity of the denial-of-service vulner-
ability to contribute to a loss of funds or revenue. This could be through a
loss of mining time or expenditure of electricity by shutting down nodes and
delaying blocks or causing the network to temporarily partition. It could also
be through disruption and delay of time sensitive contracts or prohibiting eco-
nomic activity. That could aﬀect commerce, exchanges, atomic swaps, escrows
and lightning network HTLC payment channels. There has not been a known
exploitation of this vulnerability in the wild.

2 Timeline

• 2018-Jun-22 - The DoS attack was discovered in Bcoin [2] by Braydon
Fuller. It was discovered during code review of how the code would handle
a large number of inventory messages and items. The Bcoin maintainers,
including Christopher Jeﬀrey and Javed Khan, were securely notiﬁed via
PGP email of the vulnerability with a patch included.

• 2018-Jul-02 - Before pushing ﬁxes to Bcoin other implementations were
tested for the attack and it was discovered to also DoS the latest Bitcoin
Core [3] release (v0.16.1) and development branch.

• 2018-Jul-02 to 2018-Jul-08 - The attack was researched further by
Braydon Fuller to evaluate the vulnerability in other versions and forks
of Bitcoin Core. In this process it was discovered to only aﬀect v0.16.1
and v0.16.0 of Bitcoin Core and Litecoin Core v0.16.0 and not previous
versions of Bitcoin Core and Litecoin Core [4] or other forks such as Zcash
or Bitcoin Cash, many others were tested and reviewed.

• 2018-Jul-09 - The description, patch and proof-of-concept of the vul-
nerability were timestamped in a Bitcoin block at height 531,241 in a
transaction with txid:

658d467097dc64e4e093d5bcb082139f34f570fe20bb71b57f098f5d6ebc3ce8

• 2018-Jul-09 - The description, patch and remedies were securely dis-
closed to Bitcoin Core and Litecoin Core maintainers, and later to several
exchanges and miners.

• 2018-Jul-10 - Bcoin v1.0.0 was released with the ﬁx, and the vulnerability
was ﬁxed in the master branch of Bitcoin Core from pull request #13622
by Matt Corallo.

• 2018-Jul-16 to 2018-Jul-17 - The patched version of Bitcoin Core

v0.16.2 was tagged as release candidates rc1 and rc2.

2

• 2018-Jul-23 - Litecoin Core v0.16.2 was tagged as release candidate rc1

with the patch.

• 2018-Jul-29 - Bitcoin Core v0.16.2 was released with builds.

• 2018-Jul-30 - Bitcoin Knots v0.16.2 was tagged and included the patch.

• 2018-Aug-06 - Namecoin Core 0.16.2 was tagged and included the patch.

• 2018-Sep-08 - Litecoin Core v0.16.2 builds were released.

• 2018-Sep-18 - A CVE ID was requested from https://cve.mitre.org by

Braydon Fuller.

• 2018-Sep-19 - The ID CVE-2018-17145 was given for the vulnerability.

• 2018-Sep-20 - A critical inﬂation vulnerability, CVE-2018-17144, was dis-
closed to the public. The vulnerable versions overlapped with releases also
vulnerable to CVE-2018-17145. Many nodes upgraded during this period
greatly reducing the number of nodes vulnerable to CVE-2018-17145.

• 2020-Jun-26 - Javed Khan in revisiting the attack discovered that it also
applied to Btcd [5], started further research and notiﬁed Braydon Fuller.

• 2020-Jul-01 - Btcd maintainer Olaoluwa Osuntokun was securely notiﬁed

via PGP email with details of vulnerability.

• 2020-Jul-03 - Btcd maintainer John C. Vernaleo and Olaoluwa Osun-
tokun were securely notiﬁed via PGP email with a patch to ﬁx the vul-
nerability from Javed Khan.

• 2020-Jul-07 - Javed Khan opens pull request #1599 to Btcd. During
further research discovers that a variant of the vulnerability also aﬀects
Dcrd [6] and reports the vulnerability to Decred Bug Bounty program.

• 2020-Jul-08 - Btcd pull request #1599 is merged and patched for the
vulnerability, see commit: 875b51c9fb83e5521ef5b4f8c9c522126baa2041.

• 2020-Jul-08 - Dcrd is patched in pull request #2253.

• 2020-Aug-07 - Decred Journal (July 2020) describes the behavior of the
vulnerability in reference to development for the vulnerability patch.

• 2020-Aug-27 - Dcrd v1.5.2 is released with the vulnerability patched.

• 2020-Aug-27 - Btcd v0.21.0-beta is released with the vulnerability patched.

3

3 Attack Technical Details

The attack can be performed by a peer rapidly sending multiple transaction inv
messages with random hashes, one below the max at 49,999 items and never
sending the corresponding tx data.

The attack can be accelerated with multiple peers, escalating into a DDoS,
and is limited by the bandwidth capabilities to the target nodes from attacker
nodes. With a 1Gbps (125 MB/s) connection it would be possible to send
around 83 inv messages with 49,999 items per second, giving a maximum rate
of 4,166,584 inv items per second. Memory will grow as fast as it’s possible to
send data to the node, until it crashes or locks up the machine in swap disk
usage in several minutes.

3.1 Bcoin Details

The issue was that a Map used for tracking inventory from peers could grow in
size without an upper-bound, aside from a time based limit that would ﬂush
the txMap if a peer is stalling and not responding. If enough inventory hashes
can be sent before that stall timeout check, the memory can grow past memory
space and crash the process.

The p2p network messages could grow the memory of txMap without limit
via this exposed code path handlePacket -> handleInv -> handleTXInv ->
ensureTX -> getTX:

getTX(peer, hashes) {

...
for (const hash of hashes) {
if (this.txMap.has(hash))

continue;

this.txMap.add(hash);
peer.txMap.set(hash, now);
...

}
...

}

The issue was resolved by adding a limit to the size of the peer
txMap and removing peers that exceed the limits. This was ﬁxed by Christopher
Jeﬀrey in commit: 05c38853d7f50fb4ad87e28fa7b46017f78e2955

3.2 Bitcoin Core Details

The issue in Bitcoin Core was more hidden as there appears to be code that lim-
its the growth of a similar map, see src/net processing.cpp in ProcessMessage:

if (vInv.size() > MAX_INV_SZ)
{

4

LOCK(cs_main);
Misbehaving(pfrom->GetId(), 20,

strprintf("message inv size() = %u",
vInv.size()));

return false;

}

However the actual behavior of the program was diﬀerent and behaved as if

there wasn’t a limit and the memory would endlessly grow.

The

GetMainSignals().Inventory(inv.hash)

issue was within an easy to overlook and unguarded call
to
of
src/net processing.cpp, that would grow the size of m callbacks pending
at a faster rate than it is processed in SingleThreadedSchedulerClient that
is used for tracking events. This is the code at the source of the vulnerability,
see src/validationinterface.cpp:

ProcessMessage

in

void CMainSignals::Inventory(const uint256 &hash) {

m internals->m schedulerClient.AddToProcessQueue([hash, this] {

m internals->Inventory(hash);

});

}

The issue was resolved by removing the vulnerable code as it was no-longer
needed in pull request #13622 by Matt Corallo, see details in commit:
beef7ec4be725beea870a2da510d2817487601ec

3.3 Btcd Details

The issue in Btcd takes more time to exploit compared to Bitcoin Core and
Bcoin and can be under 5 minutes to over 10 minutes from a single peer.

Btcd stores the received transaction inventory items in peer.knownInventory
(peer/peer.go) which is an MRU map (mruInventoryMap) that is supposed to
be limited by size (e.g. 1000). Unfortunately, the instance of peer.knownInventory
uses the MRU map in a way that exposes a bug which makes the map vulnerable
to memory leaks.

In detail, mruInventoryMap.Add takes a pointer to wire.InvVect which is

later modiﬁed by SyncManager.handleInvMsg. In netsync/manager.go:

if peer.IsWitnessEnabled() {

iv.Type = wire.InvTypeWitnessTx

}

When mruInventory.Add tries to evict the LRU item from invList, it no
longer matches the invMap key, since the object has been changed. The eviction
will always fail since lru.Type != iv.Type. Because of this the memory usage
keeps climbing. In peer/mruinvmap.go:

if uint(len(m.invMap))+1 > m.limit {

node := m.invList.Back()

5

lru := node.Value.(*wire.InvVect)

// Evict least recently used item.
delete(m.invMap, *lru)
...

}

In addition to mruInventoryMap, two other maps store received inventory
hashes as keys for peerSyncState: requestedTxns and requestedBlocks.
These maps should be bounded to prevent memory leaks.

The issue in Btcd was resolved by switching to a ﬁxed LRU implementa-
tion and switching the usage of the maps to use the updated version. This
was completed in pull request #1599 by Javed Khan on July 7th, see commit:
4b3f7f3c7a490151801c0aaf117befeae1c6bc1b.

3.4 Dcrd Details

Similar to the Btcd vulnerability, however it relates speciﬁcally with a subset of
the two unbounded maps in blockmanager.go.

Both peerSyncState properties requestedTxns and requestedBlocks are
unbounded and only cleared when the corresponding inventory item is resolved.
If the remote peer returns notfound for the inventory items, the hash is not
cleared from the maps’ keys. A malicious peer may spam non-existent inventory
items until the host runs out of memory.

Stall detection is not triggered in this case because the malicious peer never
stalls, as every getblocks is returned an inv and every getdata is returned a
notfound.

A very straightforward ﬁx is to simply bound the maps requestedTxns and
requestedBlocks in blockmanager.go. This issue in Dcrd has been resolved
in pull request #2253 by David Hill on July 8th, 2020, see commits:

• 0b3133113523972c3c2cc080058b2933b53e2609

• ef1530cfbc42e1b9583241923de16a2603bf5cdc

• 6187eebﬀ62006c4bd71866391603e37a7e1654b

• 347b0b9376a8ae68af75b890cfb162131cea568a

4 Acknowledgments

• Braydon Fuller for ﬁnding the vulnerability in Bcoin and Bitcoin Core and

doing the initial research.

• Matt Corallo, Wladimir J. van der Laan and maintainers for patching the

vulnerability in Bitcoin Core.

• Christopher Jeﬀrey for patching the vulnerability in Bcoin.

6

• Purse team: Andrew Lee and Buck Perley for assisting in disclosure.

• Luke Dashjr for patching Bitcoin Knots.

• Adrian Gallagher and maintainers for patching the vulnerability in Lite-

coin Core.

• Jeremy Rand, Daniel Kraft and maintainers for patching Namecoin Core.

• Javed Khan for researching and patching the vulnerability in Btcd and

Dcrd.

• Thejaswi Puthraya for helping debug the vulnerability in Btcd and Dcrd.

• John C. Vernaleo and maintainers for patching Btcd.

• David Hill, Dave Collins and maintainers for patching Dcrd.

5 References

1. https://bitnodes.io

2. https://bcoin.io

3. https://bitcoincore.org

4. https://litecoin.org

5. https://github.com/btcsuite/btcd

6. https://decred.org

7



=== Content from twitter.com_a05df06d_20250126_051059.html ===



=== Content from en.bitcoin.it_8ff87b49_20250125_015406.html ===


# Common Vulnerabilities and Exposures

From Bitcoin Wiki

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)

| CVE | Announced | Affects | Severity | Attack is... | Flaw | Net |
| --- | --- | --- | --- | --- | --- | --- |
| Pre-BIP protocol changes | n/a | All Bitcoin clients | Netsplit[[1]](#cite_note-Netsplit-1) | Implicit[[2]](#cite_note-hardfork-2) | [Various hardforks and softforks](/wiki/Consensus_versions "Consensus versions") | 100% |
| [CVE-2010-5137](#CVE-2010-5137) | 2010-07-28 | wxBitcoin and bitcoind | DoS[[3]](#cite_note-DoS-3) | Easy | OP\_LSHIFT crash | 100% |
| [CVE-2010-5141](#CVE-2010-5141) | 2010-07-28 | wxBitcoin and bitcoind | Theft[[4]](#cite_note-Theft-4) | Easy | OP\_RETURN could be used to spend any output. | 100% |
| [CVE-2010-5138](#CVE-2010-5138) | 2010-07-29 | wxBitcoin and bitcoind | DoS[[3]](#cite_note-DoS-3) | Easy | Unlimited SigOp DoS | 100% |
| **[CVE-2010-5139](/wiki/CVE-2010-5139 "CVE-2010-5139")** | 2010-08-15 | wxBitcoin and bitcoind | Inflation[[5]](#cite_note-inflation-5) | Easy | Combined output overflow | 100% |
| [CVE-2010-5140](#CVE-2010-5140) | 2010-09-29 | wxBitcoin and bitcoind | DoS[[3]](#cite_note-DoS-3) | Easy | Never confirming transactions | 100% |
| [CVE-2011-4447](#CVE-2011-4447) | 2011-11-11 | wxBitcoin and bitcoind | Exposure[[6]](#cite_note-Exposure-6) | Hard | Wallet non-encryption | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2011-4447.html) |
| [CVE-2012-1909](#CVE-2012-1909) | 2012-03-07 | Bitcoin protocol and all clients | Netsplit[[1]](#cite_note-Netsplit-1) | Very hard | Transaction overwriting | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-1909.html) |
| [CVE-2012-1910](#CVE-2012-1910) | 2012-03-17 | bitcoind & Bitcoin-Qt for Windows | Unknown[[7]](#cite_note-Unknown-7) | Hard | Non-thread safe MingW exceptions | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-1910.html) |
| [BIP 0016](#BIP-0016) | 2012-04-01 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: P2SH | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/BIP-0016.html) |
| [CVE-2012-2459](#CVE-2012-2459) | 2012-05-14 | bitcoind and Bitcoin-Qt | Netsplit[[1]](#cite_note-Netsplit-1) | Easy | Block hash collision (via merkle root) | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-2459.html) |
| **[CVE-2012-3789](/wiki/CVE-2012-3789 "CVE-2012-3789")** | 2012-06-20 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | (Lack of) orphan txn resource limits | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20123789) |
| [CVE-2012-4682](#CVE-2012-4682) |  | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) |  |  | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-4682.html) |
| **[CVE-2012-4683](/wiki/CVE-2012-4683 "CVE-2012-4683")** | 2012-08-23 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | Targeted DoS by CPU exhaustion using alerts | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-4683.html) |
| **[CVE-2012-4684](/wiki/CVE-2012-4684 "CVE-2012-4684")** | 2012-08-24 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | Network-wide DoS using malleable signatures in alerts | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20124684) |
| [CVE-2013-2272](#CVE-2013-2272) | 2013-01-11 | bitcoind and Bitcoin-Qt | Exposure[[6]](#cite_note-Exposure-6) | Easy | Remote discovery of node's wallet addresses | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20132272) |
| [CVE-2013-2273](#CVE-2013-2273) | 2013-01-30 | bitcoind and Bitcoin-Qt | Exposure[[6]](#cite_note-Exposure-6) | Easy | Predictable change output | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20132273) |
| [CVE-2013-2292](#CVE-2013-2292) | 2013-01-30 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Hard | A transaction that takes at least 3 minutes to verify | [0%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20132292) |
| **[CVE-2013-2293](/wiki/CVE-2013-2293 "CVE-2013-2293")** | 2013-02-14 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | Continuous hard disk seek | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20132293) |
| [CVE-2013-3219](#CVE-2013-3219) | 2013-03-11 | bitcoind and Bitcoin-Qt 0.8.0 | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Unenforced block protocol rule | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20133219) |
| [CVE-2013-3220](#CVE-2013-3220) | 2013-03-11 | bitcoind and Bitcoin-Qt | Netsplit[[1]](#cite_note-Netsplit-1) | Hard | Inconsistent BDB lock limit interactions | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20133220) |
| [BIP 0034](#BIP-0034) | 2013-03-25 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Height in coinbase | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/BIP-0034.html) |
| [BIP 0050](#BIP-0050) | 2013-05-15 | All Bitcoin clients | Netsplit[[1]](#cite_note-Netsplit-1) | Implicit[[2]](#cite_note-hardfork-2) | Hard fork to remove txid limit protocol rule | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?50) |
| [CVE-2013-4627](#CVE-2013-4627) | 2013-06-?? | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | Memory exhaustion with excess tx message data | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20134627) |
| [CVE-2013-4165](#CVE-2013-4165) | 2013-07-20 | bitcoind and Bitcoin-Qt | Theft[[10]](#cite_note-theft-local-timing-10) | Local | Timing leak in RPC authentication | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20134165) |
| [CVE-2013-5700](#CVE-2013-5700) | 2013-09-04 | bitcoind and Bitcoin-Qt 0.8.x | DoS[[3]](#cite_note-DoS-3) | Easy | Remote p2p crash via bloom filters | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20135700) |
| [CVE-2014-0160](#CVE-2014-0160) | 2014-04-07 | Anything using OpenSSL for TLS | Unknown[[7]](#cite_note-Unknown-7) | Easy | Remote memory leak via payment protocol | Unknown |
| [CVE-2015-3641](https://bitcoincore.org/en/2024/07/03/disclose_receive_buffer_oom/) | 2014-07-07 | bitcoind and Bitcoin-Qt prior to 0.10.2 | DoS[[3]](#cite_note-DoS-3) | Easy | OOM via p2p | [99.9%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20135700) |
| BIP 66 | 2015-02-13 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Strict DER signatures | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?66) |
| BIP 65 | 2015-11-12 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: OP\_CHECKLOCKTIMEVERIFY | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?65) |
| BIPs 68, 112 & 113 | 2016-04-11 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softforks: Rel locktime, CSV & MTP locktime | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?68) |
| CVE-2015-6031 | 2015-09-15 | MiniUPnPcBitcoin Core/Knots prior to 0.11.2 | Anything | LAN | Buffer overflow |
| BIPs 141, 143 & 147 | 2016-10-27 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Segwit | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?141) |
| [CVE-2016-8889](#CVE-2016-8889) | 2016-10-27 | Bitcoin Knots GUI 0.11.0 - 0.13.0 | Exposure | Hard | Debug console history storing sensitive info | 100% |
| CVE-2017-9230 | ? | Bitcoin | ? | ? | ASICBoost | 0% |
| BIP 148 | 2017-03-12 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Segwit UASF | ? |
| [CVE-2017-12842](#CVE-2017-12842) | 2018-06-09 |  |  |  | No commitment to block merkle tree depth |  |
| [CVE-2016-10724](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-July/016189.html) | 2018-07-02 | bitcoind and Bitcoin-Qt prior to 0.13.0 | DoS[[3]](#cite_note-DoS-3) | Keyholders[[11]](#cite_note-KeyholderEasy-11) | Alert memory exhaustion | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201610724) |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-header-spam/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.15.0 | DoS[[3]](#cite_note-DoS-3) | Easy | OOM via fake block headers |
| [CVE-2016-10725](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-July/016189.html) | 2018-07-02 | bitcoind and Bitcoin-Qt prior to 0.13.0 | DoS[[3]](#cite_note-DoS-3) | Keyholders[[11]](#cite_note-KeyholderEasy-11) | Final alert cancellation | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201610724) |
| [CVE-2018-17144](#CVE-2018-17144) | 2018-09-17 | bitcoind and Bitcoin-Qt prior to 0.16.3 | Inflation[[5]](#cite_note-inflation-5) | Miners[[9]](#cite_note-MinerEasy-9) | Missing check for duplicate inputs | [80%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201817144) |
| [CVE-2018-20587](https://medium.com/%40lukedashjr/cve-2018-20587-advisory-and-full-disclosure-a3105551e78b) | 2019-02-08 | Bitcoin Knots prior to 0.17.1, and all current Bitcoin Core releases | Theft[[10]](#cite_note-theft-local-timing-10) | Local | No alert for RPC service binding failure | [<1%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201820587) |
| [CVE-2017-18350](#CVE-2017-18350) | 2019-06-22 | bitcoind and Bitcoin-Qt prior to 0.15.1 | Unknown | Varies[[12]](#cite_note-12) | Buffer overflow from SOCKS proxy | [94%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201718350) |
| [CVE-2018-20586](#CVE-2018-20586) | 2019-06-22 | bitcoind and Bitcoin-Qt prior to 0.17.1 | Deception | RPC access | Debug log injection via unauthenticated RPC | [77%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201820586) |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-orphan-dos/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.18.0 | DoS | Easy | Orphan transaction CPU tieup |
| [CVE-2019-12998](https://lists.linuxfoundation.org/pipermail/lightning-dev/2019-September/002174.html) | 2019-08-30 | c-lightning prior to 0.7.1 | Theft | Easy | Missing check of channel funding UTXO |
| [CVE-2019-12999](https://lists.linuxfoundation.org/pipermail/lightning-dev/2019-September/002174.html) | 2019-08-30 | lnd prior to 0.7 | Theft | Easy | Missing check of channel funding UTXO amount |
| [CVE-2019-13000](https://lists.linuxfoundation.org/pipermail/lightning-dev/2019-September/002174.html) | 2019-08-30 | eclair prior to 0.3 | Theft | Easy | Missing check of channel funding UTXO |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-inv-buffer-blowup/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.20.0 | DoS | Easy | Network buffer OOM |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-getdata-cpu/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.20.0 | CPU usage | Easy | Infinite loop via p2p |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-bip70-crash/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.20.0 | DoS | Recipient[[13]](#cite_note-Recipient-13) | OOM via malicious BIP72 URI |
| [CVE-2020-14199](#CVE-2020-14199) | 2020-06-03 | Trezor and others | Theft | Social[[14]](#cite_note-14) | Double-signing can enable unintended fees |
| [CVE-2018-17145](https://invdos.net/) | 2020-09-09 | Bitcoin Core prior to 0.16.2Bitcoin Knots prior to 0.16.1Bcoin prior to 1.0.2Btcd prior to 0.21.0 | DoS[[3]](#cite_note-DoS-3) | Easy | p2p memory blow-up | [87%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201817145) |
| [CVE-2020-26895](#CVE-2020-26895) | 2020-10-08 | lnd prior to 0.10 | Theft | Easy | Missing low-S normalization for HTLC signatures |
| [CVE-2020-26896](#CVE-2020-26896) | 2020-10-08 | lnd prior to 0.11 | Theft | Varies[[15]](#cite_note-15) | Invoice preimage extraction via forwarded HTLC |
| [CVE-2020-14198](https://bitcoincore.org/en/2024/07/03/disclose-unbounded-banlist/) |  | Bitcoin Core 0.20.1 | DoS[[3]](#cite_note-DoS-3) | Easy | Remote DoS | [93%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?202014198) |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-timestamp-overflow/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.20.2 | Netsplit[[1]](#cite_note-Netsplit-1) | Varies | Adjusted time manipulation |
| [CVE-2021-3401](#CVE-2021-3401) | 2021-02-01 | Bitcoin Core GUI prior to 0.19.0Bitcoin Knots GUI prior to 0.18.1 | Theft | Hard | Qt5 remote execution | [64%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20213401) |
| [TBD](https://bitcoincore.org/en/2024/07/31/disclose-upnp-oom/) | 2024-07-31 | Bitcoin Core/Knots prior to 22.0 with UPnP enabled | DoS | Local | OOM via LAN spam |
| [TBD](https://bitcoincore.org/en/2024/07/31/disclose-addrman-int-overflow/) | 2024-07-31 | Bitcoin Core/Knots prior to 22.0 | DoS | Easy | OOM via p2p spam |
| [CVE-2021-31876](#CVE-2021-31876) | 2021-05-06 | Various wallets |  |  |  |
| CVE-2021-41591 | 2021-10-04 | Lightning software |  |  |  |
| CVE-2021-41592 | 2021-10-04 | Lightning software |  |  |  |
| CVE-2021-41593 | 2021-10-04 | Lightning software |  |  |  |
| BIPs 341-343 | 2021-11-13 | All Bitcoin nodes | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Taproot | [57%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?343) |
| [CVE-2022-31246](https://github.com/spesmilo/electrum/security/advisories/GHSA-4fh4-hx35-r355) | 2022-06-07 | Electrum 2.1 until before 4.2.2 | Theft | Social |  |
| [CVE-2023-50428](#CVE-2023-50428) | 2023 | All Bitcoin nodes | DoS[[3]](#cite_note-DoS-3) | Easy | Bypass of datacarriersize limit using OP\_FALSE,OP\_IF |  |
| [CVE-2024-34149](#CVE-2024-34149) | 2024-03-30 | Bitcoin Core 0.21.1 and newer (not fixed)Bitcoin Knots 0.21.1 - 0.23.0 | DoS[[3]](#cite_note-DoS-3) | Easy | Script size limit not enforced for Tapscript |  |

1. ↑ [1.0](#cite_ref-Netsplit_1-0) [1.1](#cite_ref-Netsplit_1-1) [1.2](#cite_ref-Netsplit_1-2) [1.3](#cite_ref-Netsplit_1-3) [1.4](#cite_ref-Netsplit_1-4) [1.5](#cite_ref-Netsplit_1-5) Attacker can create multiple views of the network, enabling [double-spending](/wiki/Double-spending "Double-spending") with over 1 confirmation
2. ↑ [2.0](#cite_ref-hardfork_2-0) [2.1](#cite_ref-hardfork_2-1) This is a protocol "hard-fork" that old clients will reject as invalid and must therefore not be used.
3. ↑ [3.00](#cite_ref-DoS_3-0) [3.01](#cite_ref-DoS_3-1) [3.02](#cite_ref-DoS_3-2) [3.03](#cite_ref-DoS_3-3) [3.04](#cite_ref-DoS_3-4) [3.05](#cite_ref-DoS_3-5) [3.06](#cite_ref-DoS_3-6) [3.07](#cite_ref-DoS_3-7) [3.08](#cite_ref-DoS_3-8) [3.09](#cite_ref-DoS_3-9) [3.10](#cite_ref-DoS_3-10) [3.11](#cite_ref-DoS_3-11) [3.12](#cite_ref-DoS_3-12) [3.13](#cite_ref-DoS_3-13) [3.14](#cite_ref-DoS_3-14) [3.15](#cite_ref-DoS_3-15) [3.16](#cite_ref-DoS_3-16) [3.17](#cite_ref-DoS_3-17) [3.18](#cite_ref-DoS_3-18) Attacker can disable some functionality, for example by crashing clients
4. [↑](#cite_ref-Theft_4-0) Attacker can take coins outside known network rules
5. ↑ [5.0](#cite_ref-inflation_5-0) [5.1](#cite_ref-inflation_5-1) Attacker can create coins outside known network rules
6. ↑ [6.0](#cite_ref-Exposure_6-0) [6.1](#cite_ref-Exposure_6-1) [6.2](#cite_ref-Exposure_6-2) Attacker can access user data outside known acceptable methods
7. ↑ [7.0](#cite_ref-Unknown_7-0) [7.1](#cite_ref-Unknown_7-1) Extent of possible abuse is unknown
8. ↑ [8.0](#cite_ref-FakeConf_8-0) [8.1](#cite_ref-FakeConf_8-1) [8.2](#cite_ref-FakeConf_8-2) [8.3](#cite_ref-FakeConf_8-3) [8.4](#cite_ref-FakeConf_8-4) [8.5](#cite_ref-FakeConf_8-5) [8.6](#cite_ref-FakeConf_8-6) [8.7](#cite_ref-FakeConf_8-7) [8.8](#cite_ref-FakeConf_8-8) Attacker can double-spend with 1 confirmation
9. ↑ [9.00](#cite_ref-MinerEasy_9-0) [9.01](#cite_ref-MinerEasy_9-1) [9.02](#cite_ref-MinerEasy_9-2) [9.03](#cite_ref-MinerEasy_9-3) [9.04](#cite_ref-MinerEasy_9-4) [9.05](#cite_ref-MinerEasy_9-5) [9.06](#cite_ref-MinerEasy_9-6) [9.07](#cite_ref-MinerEasy_9-7) [9.08](#cite_ref-MinerEasy_9-8) [9.09](#cite_ref-MinerEasy_9-9) Attacking requires mining block(s)
10. ↑ [10.0](#cite_ref-theft-local-timing_10-0) [10.1](#cite_ref-theft-local-timing_10-1) Local attacker could potentially determine the RPC passphrase via a timing sidechannel.
11. ↑ [11.0](#cite_ref-KeyholderEasy_11-0) [11.1](#cite_ref-KeyholderEasy_11-1) Attacking requires signing with the publicly-disclosed alert key
12. [↑](#cite_ref-12) Depends on software configuration
13. [↑](#cite_ref-Recipient_13-0) Can only be exploited by the recipient the victim intends to pay
14. [↑](#cite_ref-14) User must be tricked into cooperating (social engineering)
15. [↑](#cite_ref-15) Depends on node configuration, only affects routable merchants, requires external knowledge of receiver's invoices and/or luck to identify receiver, only works against single-shot HTLCs (legacy or MPP)

## CVE-2010-5137

```
Date: 2010-07-28
Summary: OP_LSHIFT crash
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.4 | 0.3.5 |

On July 28 2010, two bugs were discovered and demonstrated on the test network. One caused bitcoin to crash on some machines when processing a transaction containing an OP\_LSHIFT. This was never exploited on the main network, and was fixed by Bitcoin version 0.3.5.

After these bugs were discovered, many currently-unused script words were disabled for safety.

### References

* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5137)

## CVE-2010-5141

```
Date: 2010-07-28
Summary: ?
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.4 | 0.3.5 |

On July 28 2010, two bugs were discovered and demonstrated on the test network. One exploited a bug in the transaction handling code and allowed an attacker to spend coins that they did not own. This was never exploited on the main network, and was fixed by Bitcoin version 0.3.5.

After these bugs were discovered, many currently-unused script words were disabled for safety.

### References

* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5141)

## CVE-2010-5138

```
Date: 2010-07-29
Summary: Unlimited SigOp DoS
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.? | 0.3.? |

On July 29 2010, it was discovered that block [71036](http://blockexplorer.com/block/00000000000997f9fd2fe1ee376293ef8c42ad09193a5d2086dddf8e5c426b56) contained several transactions with a ton of OP\_CHECKSIG commands. There should only ever be one such command. This caused every node to do extra unnecessary work, and it could have been used as a denial-of-service attack. A new version of Bitcoin was quickly released. The new version did not cause a fork on the main network, though it did cause one on the test network (where someone had played around with the attack more).

### References

* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5138)

## CVE-2010-5139

*Main article: [CVE-2010-5139](/wiki/CVE-2010-5139 "CVE-2010-5139")*
```
Date: 2010-08-15
Summary: Combined output overflow
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.10 | 0.3.11 |

On August 15 2010, it was [discovered](http://bitcointalk.org/index.php?topic=822.0) that block 74638 contained a transaction that created over 184 billion bitcoins for two different addresses. This was possible because the code used for checking transactions before including them in a block didn't account for the case of outputs so large that they overflowed when summed. A new version was published within a few hours of the discovery. The block chain had to be forked. Although many unpatched nodes continued to build on the "bad" block chain, the "good" block chain overtook it at a block height of 74691. The bad transaction no longer exists for people using the longest chain.

The block and transaction:

```
CBlock(hash=0000000000790ab3, ver=1, hashPrevBlock=0000000000606865, hashMerkleRoot=618eba,
nTime=1281891957, nBits=1c00800e, nNonce=28192719, vtx=2)
  CTransaction(hash=012cd8, ver=1, vin.size=1, vout.size=1, nLockTime=0)
    CTxIn(COutPoint(000000, -1), coinbase 040e80001c028f00)
    CTxOut(nValue=50.51000000, scriptPubKey=0x4F4BA55D1580F8C3A8A2C7)
  CTransaction(hash=1d5e51, ver=1, vin.size=1, vout.size=2, nLockTime=0)
    CTxIn(COutPoint(237fe8, 0), scriptSig=0xA87C02384E1F184B79C6AC)
    CTxOut(nValue=92233720368.54275808, scriptPubKey=OP_DUP OP_HASH160 0xB7A7)
    CTxOut(nValue=92233720368.54275808, scriptPubKey=OP_DUP OP_HASH160 0x1512)
  vMerkleTree: 012cd8 1d5e51 618eba

Block hash: 0000000000790ab3f22ec756ad43b6ab569abf0bddeb97c67a6f7b1470a7ec1c
Transaction hash: 1d5e512a9723cbef373b970eb52f1e9598ad67e7408077a82fdac194b65333c9
```
### References

* [Discovery](https://bitcointalk.org/index.php?topic=822.0)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5139)

## CVE-2010-5140

```
Date: 2010-09-29
Summary: Never confirming transactions
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.12 | 0.3.13 |

Around September 29, 2010, people started [reporting](https://bitcointalk.org/index.php?topic=1306.0) that their sent transactions would not confirm. This happened because people modified Bitcoin to send sub-0.01 transactions without any fees. A 0.01 fee was at that time required by the network for such transactions (essentially prohibiting them), so the transactions remained at 0 confirmations forever. This became a more serious issue because Bitcoin would send transactions using bitcoins gotten from transactions with 0 confirmations, and these resulting transactions would also never confirm. Because Bitcoin tends to prefer sending smaller coins, these invalid transactions quickly multiplied, contaminating the wallets of everyone who received them.

Bitcoin was changed to only select coins with at least 1 confirmation. The remaining sub-0.01 transactions were cleared by generators who modified their version of Bitcoin to not require the micropayment fee. It took a while for everything to get cleared, though, because many of the intermediate transactions had been forgotten by the network by this point and had to be rebroadcast by the original senders.

### References

* [Initial reports](https://bitcointalk.org/index.php?topic=1306.0)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5140)

## CVE-2011-4447

```
Date: 2011-11-11
Summary: Wallet non-encryption
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | 0.4.0 - 0.4.1rc6 | 0.4.10.5.0 |

### References

* [Announcement](https://bitcointalk.org/index.php?topic=51604.0)
* [Finding](https://bitcointalk.org/index.php?topic=51474.0)
* [0.5.0](http://bitcoin.org/releases/2011/11/21/v0.5.0.html)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2011-4447)

## CVE-2012-1909

```
Date: 2012-03-07
Summary: Transaction overwriting
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin protocol | Before March 15th, 2012 | BIP 30 |
| Bitcoin-Qtbitcoind | \* - 0.4.4rc20.5.0rc1 - 0.5.0.4rc20.5.1rc1 - 0.5.3rc20.6.0rc1 - 0.6.0rc2 | 0.4.40.5.0.40.5.30.6.0rc3 |
| wxBitcoin | ALL | NONE |

### References

* [Announcement](https://bitcointalk.org/index.php?topic=67738.0)
* [Fix](https://en.bitcoin.it/wiki/BIP_0030)
* [Gentoo bug tracker](https://bugs.gentoo.org/show_bug.cgi?id=407793)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-1909)

## CVE-2012-1910

```
Date: 2012-03-17
Summary: Non-thread safe MingW exceptions
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoind for WindowsBitcoin-Qt for Windows | 0.5.0rc1 - 0.5.0.40.5.1rc1 - 0.5.3.00.6.0rc1 - 0.6.0rc3 | 0.5.0.50.5.3.10.5.40.6.0rc4 |

### References

* [Announcement](https://bitcointalk.org/index.php?topic=69120.0)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-1910)
* [Full disclosure](http://gavintech.blogspot.com/2012/03/full-disclosure-bitcoin-qt-on-windows.html)

## BIP-0016

```
Date: 2012-04-01
Summary: Mandatory P2SH protocol update
Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.40.5.0rc1 - 0.5.0.50.5.1rc1 - 0.5.30.6.0rc1 | 0.4.50.5.0.60.5.4rc10.6.0rc2 |
| wxBitcoin | ALL | NONE |

### References

* [BIP 0016](/wiki/BIP_0016 "BIP 0016")

## CVE-2012-2459

```
Date: 2012-05-14
Summary: Block hash collision (via merkle tree)
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.6rc10.5.0rc1 - 0.5.5rc10.6.0rc1 - 0.6.0.7rc10.6.1rc1 - 0.6.1rc1 | 0.4.60.5.50.6.0.70.6.1rc2 |

Block hash collisions can easily be made by duplicating transactions in the merkle tree.
Such a collision is invalid, but if recorded (as Bitcoin-Qt and bitcoind prior to 0.6.1 did) would prevent acceptance of the legitimate block with the same hash.
This could be used to fork the blockchain, including deep double-spend attacks.

### References

* [Announcement](https://bitcointalk.org/?topic=81749)
* [Gentoo bug tracker](https://bugs.gentoo.org/show_bug.cgi?id=415973)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-2459)
* [Full Disclosure](https://bitcointalk.org/?topic=102395)

## CVE-2012-3789

*Main article: [CVE-2012-3789](/wiki/CVE-2012-3789 "CVE-2012-3789")*
```
Date: 2012-06-20
Summary: (Lack of) orphan txn resource limits
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.7rc20.5.0rc1 - 0.5.6rc20.6.0rc1 - 0.6.0.8rc20.6.1rc1 - 0.6.2.2 | 0.4.7rc30.5.6rc30.6.0.9rc10.6.3rc1 |

### References

* [CVE-2012-3789](/wiki/CVE-2012-3789 "CVE-2012-3789")
* [0.6.3rc1 Announcement](https://bitcointalk.org/?topic=88734)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-3789)

## CVE-2012-4682

```
Date:
Summary:
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.7rc20.5.0rc1 - 0.5.6rc20.6.0rc1 - 0.6.0.8rc20.6.1rc1 - 0.6.2.2 | 0.4.7rc30.5.6rc30.6.0.9rc10.6.3rc1 |

### References

* [CVE-2012-4682](/w/index.php?title=CVE-2012-4682&action=edit&redlink=1 "CVE-2012-4682 (page does not exist)")
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=435216)

## CVE-2012-4683

*Main article: [CVE-2012-4683](/wiki/CVE-2012-4683 "CVE-2012-4683")*
```
Date: 2012-08-23
Summary: Targeted DoS by CPU exhaustion using alerts
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.7rc20.5.0rc1 - 0.5.6rc20.6.0rc1 - 0.6.0.8rc20.6.1rc1 - 0.6.2.2 | 0.7.0 |

### References

* [CVE-2012-4683](/wiki/CVE-2012-4683 "CVE-2012-4683")
* [Announcement](https://bitcointalk.org/index.php?topic=148038.0)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=435216)

## CVE-2012-4684

*Main article: [CVE-2012-4684](/wiki/CVE-2012-4684 "CVE-2012-4684")*
```
Date: 2012-08-24
Summary: Network-wide DoS using malleable signatures in alerts
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.7rc20.5.0rc1 - 0.5.6rc20.6.0rc1 - 0.6.0.8rc20.6.1rc1 - 0.6.2.2 - 0.6.3rc1 | 0.7.0 |

### References

* [CVE-2012-4684](/wiki/CVE-2012-4684 "CVE-2012-4684")
* [Announcement](https://bitcointalk.org/index.php?topic=148109.0)

## CVE-2013-2272

```
Date: 2013-01-11
Summary: Remote discovery of node's wallet addresses
Fix Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.8rc40.5.0rc1 - 0.5.70.6.0rc1 - 0.6.0.10rc40.6.1rc1 - 0.6.4rc40.7.0rc1 - 0.7.2 | 0.4.9rc10.5.8rc10.6.0.11rc10.6.5rc10.7.3rc1 |

### References

* [Announcement](https://bitcointalk.org/?topic=135856)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=462046)

## CVE-2013-2273

```
Date: 2013-01-30
Summary: Predictable change output
Fix Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.8rc40.5.0rc1 - 0.5.70.6.0rc1 - 0.6.0.10rc40.6.1rc1 - 0.6.4rc40.7.0rc1 - 0.7.2 | 0.4.9rc10.5.8rc10.6.0.11rc10.6.5rc10.7.3rc1 |

### References

* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=462046)

## CVE-2013-2292

```
Date: 2013-01-30
Summary: A transaction that takes at least 3 minutes to verify
Fix Deployment: 0%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | All versions | No fix yet |

### References

* [CVE-2013-2292](/w/index.php?title=CVE-2013-2292&action=edit&redlink=1 "CVE-2013-2292 (page does not exist)")
* [Announcement](https://bitcointalk.org/?topic=140078)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=462046)

## CVE-2013-2293

*Main article: [CVE-2013-2293](/wiki/CVE-2013-2293 "CVE-2013-2293")*
```
Date: 2013-02-14
Summary: Continuous hard disk seek
Fix Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.7.3rc1 | No fix yet (0.8.0 unaffected) |

### References

* [CVE-2013-2293](/wiki/CVE-2013-2293 "CVE-2013-2293")
* [Announcement](https://bitcointalk.org/?topic=144122)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=462046)

## CVE-2013-3219

```
Date: 2013-03-11
Summary: Unenforced block protocol rule
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.8.0rc1 - 0.8.0 | 0.8.1 |

### References

* [BIP 50](/wiki/BIP_0050 "BIP 0050")

## CVE-2013-3220

```
Date: 2013-03-11
Summary: Inconsistent BDB lock limit interactions
Fix Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.9rc10.5.0rc1 - 0.5.8rc10.6.0rc1 - 0.6.5rc10.7.0rc1 - 0.7.3rc1 | 0.4.9rc20.5.8rc20.6.5rc20.7.3rc2 |
| wxBitcoin | ALL | NONE |

### References

* [BIP 50](/wiki/BIP_0050 "BIP 0050")

## BIP-0034

```
Date: 2013-03-25
Summary: Mandatory block protocol update
Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.70.5.0rc1 - 0.5.70.6.0rc1 - 0.6.0.90.6.1rc1 - 0.6.3 | 0.4.8rc10.5.7rc10.6.0.10rc10.6.4rc1 |
| wxBitcoin | ALL | NONE |

### References

* [BIP 0034](/wiki/BIP_0034 "BIP 0034")

## BIP-0050

```
Date: 2013-05-15
Summary: Hard fork to remove txid limit protocol rule
Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.9rc10.5.0rc1 - 0.5.8rc10.6.0rc1 - 0.6.5rc10.7.0rc1 - 0.7.3rc1 | 0.4.9rc20.5.8rc20.6.5rc20.7.3rc2 |
| wxBitcoin | ALL | NONE |

### References

* [BIP 0050](/wiki/BIP_0050 "BIP 0050")

## CVE-2013-4627

```
Date: 2013-06-??
Summary: Memory exhaustion with excess tx message data
Fix Deployment: 99.9%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.9rc30.5.0rc1 - 0.5.8rc30.6.0rc1 - 0.6.5rc30.7.0rc1 - 0.7.3rc30.8.0rc1 - 0.8.3 | 0.4.9rc40.5.8rc40.6.5rc40.7.3rc40.8.4 |
| wxBitcoin | ALL | NONE |

### References

## CVE-2013-4165

```
Date: 2013-07-20
Summary: Timing leak in RPC authentication
Fix Deployment: 99.9%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.9rc30.5.0rc1 - 0.5.8rc30.6.0rc1 - 0.6.5rc30.7.0rc1 - 0.7.3rc30.8.0rc1 - 0.8.3 | 0.4.9rc40.5.8rc40.6.5rc40.7.3rc40.8.4rc1 |
| wxBitcoin | ALL | NONE |

### References

* [Bitcoin-Qt 0.8.4 release notes](https://bitcointalk.org/index.php?topic=287351)
* [The initial bug report](https://github.com/bitcoin/bitcoin/issues/2838)

## CVE-2013-5700

```
Date: 2013-09-04
Summary: Remote p2p crash via bloom filters
Fix Deployment: 99.9%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.8.0rc1 - 0.8.3 | 0.8.4rc1 |

### References

* [Bitcoin-Qt 0.8.4 release notes](https://bitcointalk.org/index.php?topic=287351)
* [The fix](https://github.com/bitcoin/bitcoin/commit/37c6389c5a0ca63ae3573440ecdfe95d28ad8f07)
* [An added test](https://github.com/bitcoin/bitcoin/pull/18515)

## CVE-2016-8889

```
Date: 2016-10-27
Summary: Debug console history storing sensitive info
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin Knots GUI | 0.11.0 - 0.13.0 | 0.13.1 |

### References

* [Bitcoin Knots 0.16.1.knots20161027 release notes](https://github.com/bitcoinknots/bitcoin/blob/v0.13.1.knots20161027/doc/release-notes.md)
* [US-CERT/NIST](https://nvd.nist.gov/vuln/detail/CVE-2016-8889)

## CVE-2017-12842

```
Date: 2018-06-09
Summary: No commitment to block merkle tree depth

```
### References

* [Explanation by Sergio Demian Lerner](https://bitslog.wordpress.com/2018/06/09/leaf-node-weakness-in-bitcoin-merkle-tree-design/)
* [Further elaboration by Suhas Daftuar](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2019-February/016697.html)

## CVE-2017-18350

```
Date: 2019-06-22
Summary: Buffer overflow from SOCKS proxy

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.7.0rc1 - 0.15.0 | 0.15.1rc1 |

### References

* [Disclosure of details](https://medium.com/%40lukedashjr/cve-2017-18350-disclosure-fe6d695f45d5)

## CVE-2018-17144

```
Date: 2018-09-17
Summary: Missing check for duplicate inputs
Fix Deployment: 31%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.14.0rc1 - 0.14.20.15.0rc1 - 0.15.10.16.0rc1 - 0.16.2 | 0.14.30.15.20.16.3 |

### References

* [Full disclosure by Bitcoin Core](https://bitcoincore.org/en/2018/09/20/notice/)
* [Bitcoin Core 0.16.3 release notes](https://bitcoincore.org/en/2018/09/18/release-0.16.3/)
* [Bitcoin Knots 0.16.3.knots20180918 release notes](https://github.com/bitcoinknots/bitcoin/blob/v0.16.3.knots20180918/doc/release-notes.md)
* [US-CERT/NIST](https://nvd.nist.gov/vuln/detail/CVE-2018-17144)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=666669)

## CVE-2018-20586

```
Date: 2019-06-22
Summary: Debug log injection via unauthenticated RPC

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.12.0rc1 - 0.17.0 | 0.17.1rc1 |

## CVE-2020-14199

```
Date: 2020-06-03
Summary: Double-signing can enable unintended fees

```

| Affected | | Fix |
| --- | --- | --- |
| Trezor One |  | 1.9.1 |
| Trezor Model T |  | 2.3.1 |
| ??? |

### References

* [Disclosure of details by Trezor team](https://blog.trezor.io/details-of-firmware-updates-for-trezor-one-version-1-9-1-and-trezor-model-t-version-2-3-1-1eba8f60f2dd)

## CVE-2020-26895

```
Date: 2020-10-08
Summary: Missing low-S normalization for HTLC signatures.

```

| Affected | | Fix |
| --- | --- | --- |
| lnd |  | 0.10.0 |

### References

* [CVE-2020-26895: LND Low-S Tx-Relay Standardness](https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002858.html)
* [Full Disclosure: Full Disclosure: CVE-2020-26895 LND "Hodl my Shitsig"](https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002856.html)

## CVE-2020-26896

```
Date: 2020-10-08
Summary: Invoice preimage extraction via forwarded HTLC.

```

| Affected | | Fix |
| --- | --- | --- |
| lnd |  | 0.11.0 |

### References

* [CVE-2020-26896: LND Invoice Preimage Extraction](https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002857.html)
* [Full Disclosure: CVE-2020-26896 LND "The (un)covert channel"](https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002855.html)

## CVE-2021-3401

```
Date: 2021-02-01
Summary: Qt5 remote execution

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin Core GUI |  | 0.19.0 |
| Bitcoin Knots GUI |  | 0.18.1 |

## CVE-2021-31876

```
Date: 2021-05-06

```
### References

* [Full Disclosure: CVE-2021-31876 Defect in Bitcoin Core's bip125 logic](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-May/018893.html)

### References

* [URI Argument Injection Vulnerability in Bitcoin Core 0.18 and Earlier](https://achow101.com/2021/02/0.18-uri-vuln)

## CVE-2023-50428

```
Date: 2023
Summary: Bypass of datacarriersize limit using OP_FALSE,OP_IF

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin Core | 0.9 and later | NOT FIXED |
| Bitcoin Knots | 0.9 - 23.0 | 25.1.knots20231115 |
| btcd | ? | NOT FIXED |
| libbitcoin | ? | NOT FIXED |

## CVE-2024-34149

```
Date: 2024-03-30
Summary: Script size limit not enforced for Tapscript

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin Core | 0.21.1 and later | NOT FIXED |
| Bitcoin Knots | 0.21.1 - 23.0 | 25.1.knots20231115 |
| btcd | ? | ? |
| libbitcoin | ? | ? |

## Definitions

A critical vulnerability is one that will have disastrous consequences if it is exploited. A serious vulnerability is one that will have serious consequences if it is exploited[[1]](#cite_note-16).

## See Also

* [Changelog](/wiki/Changelog "Changelog")
* <https://blog.bitmex.com/bitcoins-consensus-forks/>

## References

1. [↑](#cite_ref-16) <http://bitcointalk.org/index.php?topic=88892.0>

| | [Bitcoin Core](/wiki/Bitcoin_Core "Bitcoin Core") documentation | | | --- | --- | |  | | User documentation | [Alert system](/wiki/Alert_system "Alert system") • [Bitcoin Core compatible devices](/wiki/Bitcoin_Core_compatible_devices "Bitcoin Core compatible devices") • [Data directory](/wiki/Data_directory "Data directory") • [Fallback Nodes](/wiki/Fallback_Nodes "Fallback Nodes") • [How to import private keys in Bitcoin Core 0.7+](/wiki/Help%3AHow_to_import_private_keys_in_Bitcoin_Core_0.7%2B "Help:How to import private keys in Bitcoin Core 0.7+") • [Installing Bitcoin Core](/wiki/Help%3AInstalling_Bitcoin_Core "Help:Installing Bitcoin Core") • [Running Bitcoin](/wiki/Running_Bitcoin "Running Bitcoin") • [Transaction fees](/wiki/Transaction_fees "Transaction fees") • [Vocabulary](/wiki/Vocabulary "Vocabulary") | |  | | Developer documentation | [Accounts explained](/wiki/Help%3AAccounts_explained "Help:Accounts explained") • [API calls list](/wiki/Original_Bitcoin_client/API_calls_list "Original Bitcoin client/API calls list") • [API reference (JSON-RPC)](/wiki/API_reference_%28JSON-RPC%29 "API reference (JSON-RPC)") • [Block chain download](/wiki/Block_chain_download "Block chain download") • [Dump format](/wiki/Dump_format "Dump format") • [getblocktemplate](/wiki/Getblocktemplate "Getblocktemplate") • [List of address prefixes](/wiki/List_of_address_prefixes "List of address prefixes") • [Protocol documentation](/wiki/Protocol_documentation "Protocol documentation") • [Script](/wiki/Script "Script") • [Technical background of version 1 Bitcoin addresses](/wiki/Technical_background_of_version_1_Bitcoin_addresses "Technical background of version 1 Bitcoin addresses") • [Testnet](/wiki/Testnet "Testnet") • [Transaction Malleability](/wiki/Transaction_Malleability "Transaction Malleability") • [Wallet import format](/wiki/Wallet_import_format "Wallet import format") | |  | | History & theory | Common Vulnerabilities and Exposures • [DOS/STONED incident](/wiki/DOS/STONED_incident "DOS/STONED incident") • [Economic majority](/wiki/Economic_majority "Economic majority") • [Full node](/wiki/Full_node "Full node") • [Original Bitcoin client](/wiki/Original_Bitcoin_client "Original Bitcoin client") • [Value overflow incident](/wiki/Value_overflow_incident "Value overflow incident") | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

Retrieved from "<https://en.bitcoin.it/w/index.php?title=Common_Vulnerabilities_and_Exposures&oldid=70310>"
[Categories](/wiki/Special%3ACategories "Special:Categories"):

* [Security](/wiki/Category%3ASecurity "Category:Security")
* [Bitcoin Core documentation](/wiki/Category%3ABitcoin_Core_documentation "Category:Bitcoin Core documentation")

## Navigation menu

### Personal tools

* [Create account](/w/index.php?title=Special:CreateAccount&returnto=Common+Vulnerabilities+and+Exposures "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/w/index.php?title=Special:UserLogin&returnto=Common+Vulnerabilities+and+Exposures "You are encouraged to log in; however, it is not mandatory [o]")

### Namespaces

* [Page](/wiki/Common_Vulnerabilities_and_Exposures "View the content page [c]")
* [Discussion](/wiki/Talk%3ACommon_Vulnerabilities_and_Exposures "Discussion about the content page [t]")

English

### Views

* [Read](/wiki/Common_Vulnerabilities_and_Exposures)
* [View source](/w/index.php?title=Common_Vulnerabilities_and_Exposures&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/w/index.php?title=Common_Vulnerabilities_and_Exposures&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/wiki/Main_Page "Visit the main page [z]")
* [Bitcoin FAQ](/wiki/Help%3AFAQ)
* [Editing help](/wiki/Bitcoin_Wiki%3AHelp)
* [Forums](/wiki/Forums)
* [Chatrooms](/wiki/IRC_channels)
* [Recent changes](/wiki/Special%3ARecentChanges)
* [Page index](/wiki/Special%3AAllPages)

### Tools

* [What links here](/wiki/Special%3AWhatLinksHere/Common_Vulnerabilities_and_Exposures "A list of all wiki pages that link here [j]")
* [Related changes](/wiki/Special%3ARecentChangesLinked/Common_Vulnerabilities_and_Exposures "Recent changes in pages linked from this page [k]")
* [Special pages](/wiki/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/w/index.php?title=Common_Vulnerabilities_and_Exposures&oldid=70310 "Permanent link to this revision of this page")
* [Page information](/w/index.php?title=Common_Vulnerabilities_and_Exposures&action=info "More information about this page")

### Sister projects

* [Essays](/wiki/Bitcoin_Wiki%3AEssay_main_page)
* [Source](/wiki/Bitcoin_Wiki%3ASource_main_page)

* This page was last edited on 31 July 2024, at 17:40.
* Content is available under [Creative Commons Attribution 3.0](http://creativecommons.org/licenses/by/3.0/) unless otherwise noted.

* [Privacy policy](/wiki/Bitcoin_Wiki%3APrivacy_policy)
* [About Bitcoin Wiki](/wiki/Bitcoin_Wiki%3AAbout)
* [Disclaimers](/wiki/Bitcoin_Wiki%3AGeneral_disclaimer)

* [![Powered by MediaWiki](/w/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from invdos.net_95e994c7_20250125_015408.html ===

![INVDoS](assets/invdos.png)
# Bitcoin Inventory Out-of-Memory Denial-of-Service Attack

CVE-2018-17145

[Q&A](#qa "INVDoS Q&A") |
[Paper](#paper "INVDoS Paper")

---

There was an easily exploitable uncontrolled memory resource consumption denial-of-service vulnerability that existed in the peer-to-peer network code of three implementations of Bitcoin and several alternative chains.

## Q&A

**What Bitcoin implementations were affected?**

[Bitcoin Core](https://bitcoincore.org/ "bitcoincore.org"), [Bcoin](https://bcoin.io "bcoin.io") and [Btcd](https://github.com/btcsuite/btcd "GitHub - btcsuite/btcd").

**Were there any alternative chains affected?**

Yes. To our knowledge both [Litecoin](https://en.wikipedia.org/wiki/Litecoin "Litecoin - Wikipedia") and [Namecoin](https://en.wikipedia.org/wiki/Namecoin "Namecoin - Wikipedia") follow Bitcoin Core code closely and had pulled in the vulnerable code. [Decred](https://decred.org/ "decred.org") is based on Btcd which was also vulnerable. [Bitcoin Cash](https://en.wikipedia.org/wiki/Bitcoin_Cash "Bitcoin Cash - Wikipedia") was also briefly affected with vulnerable versions of [Bitcoin ABC](https://www.bitcoinabc.org/ "bitcoinabc.org"); they had pulled in vulnerable code after it was fixed from Bitcoin Core. We have done our best to check as many implementations as possible.

**Am I vulnerable to the attack?**

Probably not, the vulnerability has been patched in Bitcoin Core for over two years. However, you are vulnerable to denial-of-service if you're running older software such as:

* Bitcoin Core v0.16.0 or v0.16.1
* Bitcoin Knots v0.16.0
* Bcoin v1.0.0-pre and earlier
* Btcd v0.20.1-beta and earlier
* Litecoin Core v0.16.0
* Namecoin Core v0.16.1
* Dcrd v1.5.1 and earlier
* Bitcoin ABC v0.19.8 or v0.19.9

**How can I protect myself?**

You are likely already protected. Otherwise, make sure to upgrade:

* Bitcoin Core v0.16.2 and later
* Bitcoin Knots v0.16.2 and later
* Bcoin v1.0.2 and later
* Btcd v0.21.0-beta and later
* Litecoin Core v0.16.2 and later
* Namecoin v0.16.2 and later
* Dcrd v1.5.2 and later
* Bitcoin ABC v0.19.10 and later

**Who is capable of mounting this attack?**

Anyone with an internet and peer-to-peer connection.

**How is the attack performed?**

A hostile peer floods another peer with many [inv messages](https://en.bitcoin.it/wiki/Protocol_documentation#inv "Protocol documentation") for non-existent transactions using random hashes.

**What is the result of the attack?**

A hostile peer can cause another peer to be unable to function, this is known as a [denial-of-service](https://en.wikipedia.org/wiki/Denial-of-service_attack "Denial-of-service attack - Wikipedia"). This attack causes the memory of the process to grow endlessly. This will crash the process or freeze the process and computer until the process is terminated.

**Could this attack shutdown an entire network?**

Yes if 100% of nodes in the network were vulnerable and there were no alternative versions or implementations available that did not have the vulnerability. A fixed version would need to be released to restore the network functionality. For the Bitcoin network there have only been two vulnerabilities ([1](https://en.bitcoin.it/wiki/Value_overflow_incident "Value overflow incident (CVE-2010-5139)"), [2](https://github.com/bitcoin/bips/blob/master/bip-0050.mediawiki "BIP-0050 (CVE-2013-3220)")) that have lead to such downtime events, and there hasn't been one since 2013.

**Can this vulnerability be used to steal bitcoin?**

Not likely, however it's possible that [Lightning Network](https://en.wikipedia.org/wiki/Lightning_Network "Lightning Network - Wikipedia") funds could be at risk if a watchtower or node fails due to a denial-of-service attack. There could then be a failure to counter, within time, a hostile Lightning peer closing a channel.

**Can this vulnerability affect consensus?**

Not likely, however in some exceptional situations it could influence consensus. The attack could be used to give an advantage to one side of a chain fork or mining hash war. Nodes could be attacked in an attempt to partition the network, in such a case there could be deep chain reorganizations as miners have difficulty propagating blocks across the network. This could cause issues for commerce and trade as block confirmation counts would need to be increased to prevent double-spends.

**Is prohibiting inbound connections protection for the attack?**

No. An inbound connection is not required for a node to be attacked, only a peer connection. A node's outbound peers can also initiate the attack. The attacker could have an otherwise normal operating full node or network of nodes that peers could connect. The attacker could [Sybil attack](https://en.wikipedia.org/wiki/Sybil_attack "Sybil attack - Wikipedia") the network and announce with [addr messages](https://en.bitcoin.it/wiki/Protocol_documentation#addr "Protocol documentation") many IP addresses to gain more connections.

**Is running a non-public internal node protection for the attack?**

No. The attack is not prevented by running a node that is isolated from the public internet and only connecting to edge nodes that have connection to the public network. The nodes that are on the public internet, edge nodes, can be attacked and the internal node would lose connection to the network and would not receive or send new blocks or transactions.

**Has this been exploited in the wild?**

Not as far as we know.

**Who is behind this research?**

Braydon Fuller ([Github](https://github.com/braydonf "Braydon Fuller - GitHub")) and
Javed Khan ([Github](https://github.com/tuxcanfly "Javed Khan - GitHub"), [Twitter](https://twitter.com/tuxcanfly "Javed Khan - Twitter")).

## Paper

[![Thumbnail - Page 1](paper/CVE-2018-17145-1.png)](paper/CVE-2018-17145.pdf "CVE-2018-17145: Bitcoin Inventory Out-of-Memory Denial-of-Service Attack (PDF)")
[![Thumbnail - Page 2](paper/CVE-2018-17145-2.png)](paper/CVE-2018-17145.pdf "CVE-2018-17145: Bitcoin Inventory Out-of-Memory Denial-of-Service Attack (PDF)")
[![Thumbnail - Page 3](paper/CVE-2018-17145-3.png)](paper/CVE-2018-17145.pdf "CVE-2018-17145: Bitcoin Inventory Out-of-Memory Denial-of-Service Attack (PDF)")
[![Thumbnail - Page 4](paper/CVE-2018-17145-4.png)](paper/CVE-2018-17145.pdf "CVE-2018-17145: Bitcoin Inventory Out-of-Memory Denial-of-Service Attack (PDF)")
[![Thumbnail - Page 5](paper/CVE-2018-17145-5.png)](paper/CVE-2018-17145.pdf "CVE-2018-17145: Bitcoin Inventory Out-of-Memory Denial-of-Service Attack (PDF)")
[![Thumbnail - Page 6](paper/CVE-2018-17145-6.png)](paper/CVE-2018-17145.pdf "CVE-2018-17145: Bitcoin Inventory Out-of-Memory Denial-of-Service Attack (PDF)")
[![Thumbnail - Page 7](paper/CVE-2018-17145-7.png)](paper/CVE-2018-17145.pdf "CVE-2018-17145: Bitcoin Inventory Out-of-Memory Denial-of-Service Attack (PDF)")

[Download "CVE-2018-17145: Bitcoin Inventory Out-of-Memory
Denial-of-Service Attack" (PDF)](paper/CVE-2018-17145.pdf "CVE-2018-17145: Bitcoin Inventory Out-of-Memory Denial-of-Service Attack (PDF)")


=== Content from invdos.net_049863e1_20250126_051058.html ===

![INVDoS](assets/invdos.png)
# Bitcoin Inventory Out-of-Memory Denial-of-Service Attack

CVE-2018-17145

[Q&A](#qa "INVDoS Q&A") |
[Paper](#paper "INVDoS Paper")

---

There was an easily exploitable uncontrolled memory resource consumption denial-of-service vulnerability that existed in the peer-to-peer network code of three implementations of Bitcoin and several alternative chains.

## Q&A

**What Bitcoin implementations were affected?**

[Bitcoin Core](https://bitcoincore.org/ "bitcoincore.org"), [Bcoin](https://bcoin.io "bcoin.io") and [Btcd](https://github.com/btcsuite/btcd "GitHub - btcsuite/btcd").

**Were there any alternative chains affected?**

Yes. To our knowledge both [Litecoin](https://en.wikipedia.org/wiki/Litecoin "Litecoin - Wikipedia") and [Namecoin](https://en.wikipedia.org/wiki/Namecoin "Namecoin - Wikipedia") follow Bitcoin Core code closely and had pulled in the vulnerable code. [Decred](https://decred.org/ "decred.org") is based on Btcd which was also vulnerable. [Bitcoin Cash](https://en.wikipedia.org/wiki/Bitcoin_Cash "Bitcoin Cash - Wikipedia") was also briefly affected with vulnerable versions of [Bitcoin ABC](https://www.bitcoinabc.org/ "bitcoinabc.org"); they had pulled in vulnerable code after it was fixed from Bitcoin Core. We have done our best to check as many implementations as possible.

**Am I vulnerable to the attack?**

Probably not, the vulnerability has been patched in Bitcoin Core for over two years. However, you are vulnerable to denial-of-service if you're running older software such as:

* Bitcoin Core v0.16.0 or v0.16.1
* Bitcoin Knots v0.16.0
* Bcoin v1.0.0-pre and earlier
* Btcd v0.20.1-beta and earlier
* Litecoin Core v0.16.0
* Namecoin Core v0.16.1
* Dcrd v1.5.1 and earlier
* Bitcoin ABC v0.19.8 or v0.19.9

**How can I protect myself?**

You are likely already protected. Otherwise, make sure to upgrade:

* Bitcoin Core v0.16.2 and later
* Bitcoin Knots v0.16.2 and later
* Bcoin v1.0.2 and later
* Btcd v0.21.0-beta and later
* Litecoin Core v0.16.2 and later
* Namecoin v0.16.2 and later
* Dcrd v1.5.2 and later
* Bitcoin ABC v0.19.10 and later

**Who is capable of mounting this attack?**

Anyone with an internet and peer-to-peer connection.

**How is the attack performed?**

A hostile peer floods another peer with many [inv messages](https://en.bitcoin.it/wiki/Protocol_documentation#inv "Protocol documentation") for non-existent transactions using random hashes.

**What is the result of the attack?**

A hostile peer can cause another peer to be unable to function, this is known as a [denial-of-service](https://en.wikipedia.org/wiki/Denial-of-service_attack "Denial-of-service attack - Wikipedia"). This attack causes the memory of the process to grow endlessly. This will crash the process or freeze the process and computer until the process is terminated.

**Could this attack shutdown an entire network?**

Yes if 100% of nodes in the network were vulnerable and there were no alternative versions or implementations available that did not have the vulnerability. A fixed version would need to be released to restore the network functionality. For the Bitcoin network there have only been two vulnerabilities ([1](https://en.bitcoin.it/wiki/Value_overflow_incident "Value overflow incident (CVE-2010-5139)"), [2](https://github.com/bitcoin/bips/blob/master/bip-0050.mediawiki "BIP-0050 (CVE-2013-3220)")) that have lead to such downtime events, and there hasn't been one since 2013.

**Can this vulnerability be used to steal bitcoin?**

Not likely, however it's possible that [Lightning Network](https://en.wikipedia.org/wiki/Lightning_Network "Lightning Network - Wikipedia") funds could be at risk if a watchtower or node fails due to a denial-of-service attack. There could then be a failure to counter, within time, a hostile Lightning peer closing a channel.

**Can this vulnerability affect consensus?**

Not likely, however in some exceptional situations it could influence consensus. The attack could be used to give an advantage to one side of a chain fork or mining hash war. Nodes could be attacked in an attempt to partition the network, in such a case there could be deep chain reorganizations as miners have difficulty propagating blocks across the network. This could cause issues for commerce and trade as block confirmation counts would need to be increased to prevent double-spends.

**Is prohibiting inbound connections protection for the attack?**

No. An inbound connection is not required for a node to be attacked, only a peer connection. A node's outbound peers can also initiate the attack. The attacker could have an otherwise normal operating full node or network of nodes that peers could connect. The attacker could [Sybil attack](https://en.wikipedia.org/wiki/Sybil_attack "Sybil attack - Wikipedia") the network and announce with [addr messages](https://en.bitcoin.it/wiki/Protocol_documentation#addr "Protocol documentation") many IP addresses to gain more connections.

**Is running a non-public internal node protection for the attack?**

No. The attack is not prevented by running a node that is isolated from the public internet and only connecting to edge nodes that have connection to the public network. The nodes that are on the public internet, edge nodes, can be attacked and the internal node would lose connection to the network and would not receive or send new blocks or transactions.

**Has this been exploited in the wild?**

Not as far as we know.

**Who is behind this research?**

Braydon Fuller ([Github](https://github.com/braydonf "Braydon Fuller - GitHub")) and
Javed Khan ([Github](https://github.com/tuxcanfly "Javed Khan - GitHub"), [Twitter](https://twitter.com/tuxcanfly "Javed Khan - Twitter")).

## Paper

[![Thumbnail - Page 1](paper/CVE-2018-17145-1.png)](paper/CVE-2018-17145.pdf "CVE-2018-17145: Bitcoin Inventory Out-of-Memory Denial-of-Service Attack (PDF)")
[![Thumbnail - Page 2](paper/CVE-2018-17145-2.png)](paper/CVE-2018-17145.pdf "CVE-2018-17145: Bitcoin Inventory Out-of-Memory Denial-of-Service Attack (PDF)")
[![Thumbnail - Page 3](paper/CVE-2018-17145-3.png)](paper/CVE-2018-17145.pdf "CVE-2018-17145: Bitcoin Inventory Out-of-Memory Denial-of-Service Attack (PDF)")
[![Thumbnail - Page 4](paper/CVE-2018-17145-4.png)](paper/CVE-2018-17145.pdf "CVE-2018-17145: Bitcoin Inventory Out-of-Memory Denial-of-Service Attack (PDF)")
[![Thumbnail - Page 5](paper/CVE-2018-17145-5.png)](paper/CVE-2018-17145.pdf "CVE-2018-17145: Bitcoin Inventory Out-of-Memory Denial-of-Service Attack (PDF)")
[![Thumbnail - Page 6](paper/CVE-2018-17145-6.png)](paper/CVE-2018-17145.pdf "CVE-2018-17145: Bitcoin Inventory Out-of-Memory Denial-of-Service Attack (PDF)")
[![Thumbnail - Page 7](paper/CVE-2018-17145-7.png)](paper/CVE-2018-17145.pdf "CVE-2018-17145: Bitcoin Inventory Out-of-Memory Denial-of-Service Attack (PDF)")

[Download "CVE-2018-17145: Bitcoin Inventory Out-of-Memory
Denial-of-Service Attack" (PDF)](paper/CVE-2018-17145.pdf "CVE-2018-17145: Bitcoin Inventory Out-of-Memory Denial-of-Service Attack (PDF)")

