- **Root cause of vulnerability**: The CUJO Smart Firewall's safe browsing function incorrectly parses HTTP requests, specifically the "Host" header. The firewall inspects individual TCP packets, not the complete stream.
- **Weaknesses/vulnerabilities present**: The vulnerability is due to a flaw in the way the firewall extracts the "Host" header from HTTP requests. The regular expression used to extract the header only looks for the header in a single packet and not across multiple TCP packets. This allows for HTTP request smuggling, specifically an inconsistent interpretation of HTTP requests.
- **Impact of exploitation**: An attacker can bypass the firewall's safe browsing feature and visit malicious websites that would otherwise be blocked.
- **Attack vectors**: The attacker sends an HTTP request with an overlong path in the GET request, causing the HTTP message to span multiple TCP packets.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to a device behind the CUJO Smart Firewall. This can be done from any device on the monitored network.