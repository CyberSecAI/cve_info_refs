```
{
  "cve": "CVE-2018-4360",
  "affected_products": [
    "iOS 12",
    "iCloud for Windows 7.7",
    "Safari 12",
    "tvOS 12",
    "iTunes 12.9 for Windows"
  ],
  "vulnerability_details": {
    "root_cause": "The vulnerability is caused by an error in the `DOMMatrix::invertSelf()` function within WebKit. When the matrix inversion fails, the code attempts to access the value of an uninitialized optional, leading to memory corruption.",
    "weaknesses": [
      "Memory corruption due to access of an uninitialized optional value",
       "Use after free issue (indirectly)"
    ],
    "impact": "Processing maliciously crafted web content can lead to arbitrary code execution. This can allow an attacker to execute arbitrary code within the context of the affected application/browser.",
    "attack_vectors": [
      "Malicious websites",
      "Maliciously crafted web content"
    ],
     "required_attacker_capabilities": "The attacker needs to be able to get the victim to load a web page that triggers the vulnerability. This can be done by tricking the user to visit a malicious site, or via other means like ads.",
      "additional_details": "The vulnerability arises when a DOMMatrix cannot be inverted. The `inverse()` method may return a nullopt, and the subsequent attempt to access `inverse.value()` results in undefined behavior (access of uninitialized memory) if the inverse was not possible, since the `value()` method does not check if the optional contains a value. This allows reading uninitialized stack memory and potentially leads to RCE. The change to WTFâ€™s internal std::optional caused a crash instead of using an uninitialized value, making this exploitable."
  },
  "technical_details": {
    "code_location": "Source/WebCore/css/DOMMatrix.cpp#L229",
    "vulnerable_code_snippet": "Ref<DOMMatrix> DOMMatrix::invertSelf()\n{\n    auto inverse = m_matrix.inverse();\n    if (!inverse) {\n        m_matrix.setMatrix(\n            std::numeric_limits<double>::quiet_NaN(), std::numeric_limits<double>::quiet_NaN(), std::numeric_limits<double>::quiet_NaN(), std::numeric_limits<double>::quiet_NaN(),\n            std::numeric_limits<double>::quiet_NaN(), std::numeric_limits<double>::quiet_NaN(), std::numeric_limits<double>::quiet_NaN(), std::numeric_limits<double>::quiet_NaN(),\n            std::numeric_limits<double>::quiet_NaN(), std::numeric_limits<double>::quiet_NaN(), std::numeric_limits<double>::quiet_NaN(), std::numeric_limits<double>::quiet_NaN(),\n            std::numeric_limits<double>::quiet_NaN(), std::numeric_limits<double>::quiet_NaN(), std::numeric_limits<double>::quiet_NaN(), std::numeric_limits<double>::quiet_NaN()\n        );\n        m_is2D = false;\n    }\n    m_matrix = inverse.value();\n    return Ref<DOMMatrix> { *this };\n}",
   "poc": "console.log(new DOMMatrix([0, 0, 0, 0, 0, 0]).invertSelf())"
  },
   "remediation": "The vulnerability was addressed with improved memory handling and by correctly checking the return value of the optional before accessing its value."
}
```