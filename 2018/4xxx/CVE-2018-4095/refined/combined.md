=== Content from blog.zimperium.com_f71e2af8_20250125_151943.html ===


[![Zimperium](data:image/svg+xml...)![Zimperium](https://www.zimperium.com/wp-content/uploads/2024/08/ZIMPERIUM-logo_orangeZ_white.png)
![Zimperium](data:image/svg+xml...)![Zimperium](https://www.zimperium.com/wp-content/uploads/2024/08/ZIMPERIUM-logo_orangeZ_white.png)](https://www.zimperium.com)

Search for:

* [Platform](https://www.zimperium.com/platform/)
* Products
  + MOBILE ENDPOINT SECURITY
    - [Zimperium MTD](https://www.zimperium.com/mtd/)
    - [Zimperium MTD for Chromebooks](https://www.zimperium.com/chromebooks/)
    - [z3A Application Vetting](https://www.zimperium.com/z3a-advanced-app-analysis/)
    - [zSecure Resident Safety](https://www.zimperium.com/zsecure/)
  + MOBILE APPLICATION SECURITY
    - [MAPS Mobile Application Protection Suite](https://www.zimperium.com/mobile-app-protection/)
    - [zScan Application Security Testing](https://www.zimperium.com/zscan/)
    - [zKeyBox Cryptographic Key Protection](https://www.zimperium.com/zkeybox/)
    - [zShield Application Shielding](https://www.zimperium.com/zshield/)
    - [zDefend Runtime Application Self-Protection](https://www.zimperium.com/zdefend/)
  + THREAT INTELLIGENCE
    - [Advanced Mobile Threat Insights](https://www.zimperium.com/support-advancedthreatinsights/)
    - [Mobile Threat Defense Maturity](https://www.zimperium.com/mtd-maturity-model/)
* Use Cases
  + [Combatting Mobile Banking Malware](https://www.zimperium.com/mobile-banking-malware/)
  + [Implementing Mobile Zero Trust](https://www.zimperium.com/zerotrust/)
  + [Securing Mobile O365](https://www.zimperium.com/secureoffice365/)
  + [Phishing Protection](https://www.zimperium.com/mobile-phishing-protection/)
  + [Ensuring Security Compliance](https://www.zimperium.com/industry/compliance/)
    - [MAS Regulations](/industry/compliance/regulations-mas/)
    - [PSD2 Regulation](https://www.zimperium.com/industry/compliance/psd2-regulation/)
    - [RMiT Regulation](https://www.zimperium.com/industry/compliance/rmit-regulation/)
  + [Neobank Security](https://www.zimperium.com/neobanks/)
  + [Protecting Mobile Payments](https://www.zimperium.com/mobile-payments/)
  + [SoftPOS Certification](https://www.zimperium.com/softpos-providers-secure-with-zimperium/)
  + [Mobile Threat Defense](https://www.zimperium.com/mobile-threat-defense/)
  + [Connected Medical Devices and Apps](https://www.zimperium.com/industry/healthcare/connected-medical-devices-and-apps/)
* [Industries](https://www.zimperium.com/industry/)
  + [Automotive](https://www.zimperium.com/industry/automotive/)
  + [Banking](/industry/banking/)
  + [Education](https://www.zimperium.com/industry/education/)
  + [Government](https://www.zimperium.com/industry/government/)
  + [State & Local Government](https://www.zimperium.com/state-local-government/)
  + [Healthcare](https://www.zimperium.com/industry/healthcare/)
  + [Insurance](https://www.zimperium.com/industry/insurance/)
  + [Legal](https://www.zimperium.com/?page_id=1284)
  + [Pharmaceutical](https://www.zimperium.com/industry/pharmaceutical/)
  + [Retail & Mobile E-Commerce](https://www.zimperium.com/industry/retail/)
  + [Media and Entertainment](https://www.zimperium.com/ott-app-security-for-media-and-entertainment/)
* Partners
  + [zPartners](https://www.zimperium.com/partners/)
  + [Become a Partner](https://www.zimperium.com/partner-contact/)
* [Company](https://www.zimperium.com/company/)
  + [About Zimperium](https://www.zimperium.com/company/)
  + [News](https://www.zimperium.com/resources/press-releases/)
  + [Careers](https://www.zimperium.com/careers/)
  + [Awards](https://www.zimperium.com/company/awards/)
  + [Contact Zimperium](https://www.zimperium.com/contact-us/)
* [Resources](https://www.zimperium.com/resources/)
  + [Resources](https://www.zimperium.com/resources/)
  + [Events](https://www.zimperium.com/events/)
  + [FAQs](https://www.zimperium.com/faq/)
  + [Glossary](https://www.zimperium.com/glossary/)
  + [Threat Research](https://www.zimperium.com/zlabs/)
* [Blog](/blog/)

Search for:

[Zimperium](https://www.zimperium.com "Go to Zimperium.") > [Blogs](https://www.zimperium.com/blog/ "Go to Blogs.") > [Threat Research](https://www.zimperium.com/blog-category/threat-research/ "Go to the Threat Research Format archives.") > CVE-2018-4087 PoC: Escaping the sandbox by misleading bluetoothd

# CVE-2018-4087 PoC: Escaping the sandbox by misleading bluetoothd

   February 27, 2018
[Rani Idan](https://www.zimperium.com/author/rani/ "Posts by Rani Idan")

Share this blog

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/02/CVE_1_1200x628px-300x157.png)](/wp-content/uploads/2018/02/CVE_1_1200x628px.png)Following my previous blog post titled “[New Crucial Vulnerabilities in Apple’s bluetoothd daemon](/new-crucial-vulnerabilities-apples-bluetoothd-daemon/)”, I am releasing the vulnerability PoC.

*The PoC is released for educational purposes and evaluation by IT Administrators and Pentesters alike, and should not be used in any unintended way. Furthermore, this PoC and any other related material, is published only after responsibly disclosing it to Apple and Apple has fixed the issues.*

As part of my work in the zLabs platform research team at Zimperium, I investigated the iOS mach message IPC from within the default app sandbox with the goal of ultimately gaining escalation to escape the sandbox.

To start the project, I mapped which mach ports are accessible from within the sandbox. I used sbtool by Jonathan Levin ([@Morpheus\_\_\_\_\_\_](https://twitter.com/Morpheus______)) from his \*OS Internals Volume III book.

With this blog post, I intend to reveal the full PoC of the vulnerability for your own study.

Both of the vulnerabilities were addressed in the latest OS releases by Apple: iOS – 11.2.5, watchOS – 4.2.2, tvOS – 11.2.5. Apple assigned 2 CVEs for each of the vulnerabilities:

1. CVE-2018-4087: Rani Idan (@raniXCH) of Zimperium zLabs Team
2. CVE-2018-4095: Rani Idan (@raniXCH) of Zimperium zLabs Team

Apple Releases:

* <https://support.apple.com/en-il/HT208462> – tvOS 11.2.5
* <https://support.apple.com/en-il/HT208463> – iOS 11.2.5
* <https://support.apple.com/en-il/HT208464> – watchOS 4.2.2

The PoC source code is available [here](https://github.com/rani-i/bluetoothdPoC)

## bluetoothd

Different sandboxed processes can communicate with different daemons such as mediaserverd, bluetoothd, and others using IPC to use the daemon features. In our case, we will focus on mach message communication with bluetoothd.

bluetoothd is initiating “com.apple.server.bluetooth” port and queueing received mach messages on that port.

[![](https://www.zimperium.com/wp-content/uploads/2018/02/unnamed-1024x97.png)](/wp-content/uploads/2018/02/unnamed.png)

Mach message is a form of IPC in \*OS; its usage is not well encouraged or documented by Apple in order to make space for higher IPC frameworks.

Now, the function *apple\_bluetoothd\_mig\_server* will receive every mach message being sent to *com.apple.server.bluetooth*and handling it by the mach message id.

In our case and to simplify the process, a sandboxed process is asking launchd for a mach port to a service that registered its port with *bootstrap\_check\_in*. Afterwards, the process can communicate with the service using the mach port it retrieved from launchd.

Let’s have a look at *apple\_bluetoothd\_mig\_server:*

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/02/Screen-Shot-2018-02-24-at-21.10.42-1024x350.png)](/wp-content/uploads/2018/02/Screen-Shot-2018-02-24-at-21.10.42.png)

 You can see the function handling the mach message is subtracting a value of *0xFA300* from the msgh\_id of the message sent to bluetoothd and then gets the matching callback to finally call it with the input message.

Moreover, you can see that the function checks if the message id is below or equal 0x83 – that means we have *0x84* available callbacks.

Because the binary is without symbols, I developed a small tool to parse that struct using more information that I am gaining from different library images. This made it possible to create the full list of the available callbacks.

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/02/pasted-image-0.png)](/wp-content/uploads/2018/02/pasted-image-0.png)

\* The *“machUnderfined\_handler”* functions are undefined because the image I used here is iPod touch and some of the features do not exist.

In our case, we will focus on mach\_\_BTLocalDeviceAddCallbacks; this callback is the handler for message with the mach message id 3.

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/02/Screen-Shot-2018-02-24-at-21.06.35.png)](/wp-content/uploads/2018/02/Screen-Shot-2018-02-24-at-21.06.35.png)

The function mach\_\_BTLocalDeviceAddCallbacks\_3 is checking if the mach message is the size of 0x48 and it is not a complex mach message.

Afterwards, it will try to add the callback to the matching session using the session\_token.

When a legitimate client is creating a session with bluetoothd, it will create a session token to bluetoothd, and using that token the client is identified by bluetoothd.

Here is where the plot thickens – what is this session token? Wrongfully, Apple used that session\_token as the port name between the client and bluetoothd. It is exactly the same port (literally the port name) used for the communication.

That is a huge problem because mach port has specific struct that makes it **really** easy to bruteforce.  The session\_token is of type *mach\_port\_t*.

In my PoC, I received a port from launchd to bluetoothd in order to communicate directly with bluetoothd. Using that port, I bruteforced the session\_token (mach port struct) and could finally register new callbacks to bluetoothd clients by hijacking the session between bluetoothd and its clients.

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/02/ssejWT5oyIVea_xwFYIQKyw.png)](/wp-content/uploads/2018/02/ssejWT5oyIVea_xwFYIQKyw.png)

The attack process:

1. bluetoothd’s clients are attaching to it and getting a session token that the client will need to use on the mach communication in order to identify itself to bluetoothd.
2. The malicious app (sandboxed app) can bruteforce that session token because the session token consists of the communication mach port and is made of mach\_port\_t struct.
3. After successfully bruteforcing the token, the malicious app can register a new callback **on the client process** that will be invoked when messages are sent to the client.

It is important to keep in mind that it means a malicious app running from a sandboxed context managed to add callback on clients of bluetoothd which have different sandbox contexts.

List of all bluetoothd clients whom I managed to hijack (bluetoothd is also registered as client):

* SpringBoard
* mDNSResponder
* aggregated
* wifid
* Preferences
* CommCenter
* iaptransportd
* findmydeviced
* routined
* UserEventAgent
* carkitd
* mediaserverd
* bluetoothd
* coreduetd

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/02/Thread-crash.png)](/wp-content/uploads/2018/02/Thread-crash.png)

wifid registers state after running the PoC

## What’s next, How can it be exploited?

This vulnerability can be used to leak mach ports of every client and it will reveal enormous attack surface on each of the clients!

Leaking the mach ports of the clients can be done by jumping to a suitable gadget and sending the port back to the sandboxed app.

## Apple’s fix

I reported the issue to Apple, Indeed, they fixed the issue however I think the solution could be designed better.

The fix still does not make sure that the session will not be hijacked. Apple changed the session token from being the actual mach port to a randomized token.

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2018/02/v4.png)](/wp-content/uploads/2018/02/v4.png)

Apple’s fix

## Disclosure timeline

10/11/2017 – First bug discovered

14/11/2017 – Shared the bugs with Apple

05/12/2017 – Apple confirmed the bugs

25/01/2018 – Apple distributed patches

## Credits

I would like to thank Apple for their professional response, Nikias Bassen ([@pimskeks](https://twitter.com/pimskeks)) and the rest of Zimperium team

 ![Avatar photo](https://secure.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=90)
##### Author: [Rani Idan](https://www.zimperium.com/author/rani/ "Rani Idan")

## Post navigation

[Previous Blog](https://www.zimperium.com/blog/liberios-electra-ios-11-jailbreaks-easily-detected-zimperium-z9/)[Next Blog](https://www.zimperium.com/blog/fake-bbc-news-app-analysis/)

##### Recommended Reading

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2022/10/stagefrightExploit2-400x250.png)
##### The Latest on Stagefright: CVE-2015-1538 Exploit is Now Available for Testing Purposes](https://www.zimperium.com/blog/the-latest-on-stagefright-cve-2015-1538-exploit-is-now-available-for-testing-purposes/ "The Latest on Stagefright: CVE-2015-1538 Exploit is Now Available for Testing Purposes")

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2022/10/android_vulner_1a_1280x720px-400x250.jpg)
##### CVE-2018-9539: Use-after-free vulnerability in privileged Android service](https://www.zimperium.com/blog/cve-2018-9539-use-free-vulnerability-privileged-android-service/ "CVE-2018-9539: Use-after-free vulnerability in privileged Android service")

[![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2022/10/services_1a_1280x720px-400x250.jpg)
##### CVE-2018-9411: New critical vulnerability in multiple high-privileged Android services](https://www.zimperium.com/blog/cve-2018-9411-new-critical-vulnerability-multiple-high-privileged-android-services/ "CVE-2018-9411: New critical vulnerability in multiple high-privileged Android services")

 ![](data:image/svg+xml...)![](https://www.zimperium.com/wp-content/uploads/2024/08/ZIMPERIUM-logo_orangeZ_white-300x46.png)

4055 Valley View Suite 300

Dallas, TX 75244

**US Toll Free:**  844-601-6760

**International:**  +1.415.992.8922

**General:** info@zimperium.com

**Press:** pr@zimperium.com

**[Compliance Hotline](https://my.compliancehotline.com/report/zimperium)**

**[Modern Slavery Act Statement](https://www.zimperium.com/modern-slavery-act-statement/)**

##### Learn More

* [FAQ](https://www.zimperium.com/faq/)
* [Support](https://www.zimperium.com/support/)
* [Blog](https://www.zimperium.com/blog/)
* [Threat Research](https://www.zimperium.com/zlabs/)
* [Glossary](https://www.zimperium.com/glossary/)
* [Responsible Disclosure Policy](https://lp.zimperium.com/hubfs/Zimperium/Zimperium%20Vulnerability%20Disclosure%20Policy%20%281%29.pdf)

##### Our Focus

* [Mobile Threat Defense](https://www.zimperium.com/mobile-threat-defense/)
* [Mobile Application Security](https://www.zimperium.com/mobile-app-security/)
* [Enterprise Mobile Security](https://www.zimperium.com/enterprise-mobile-security/)
* [Mobile Phishing Protection](https://www.zimperium.com/mobile-phishing-protection/)
* [Mobile EDR](https://www.zimperium.com/mobile-edr/)

Copyright © 2010-2024 Zimperium.  All Rights Reserved.[Privacy Policy](https://www.zimperium.com/privacy-policy/)  | Privacy Settings



=== Content from support.apple.com_52056346_20250126_095030.html ===


* [Apple](https://www.apple.com/il/)
* + [Mac](https://www.apple.com/il/mac/)
  + [iPad](https://www.apple.com/il/ipad/)
  + [iPhone](https://www.apple.com/il/iphone/)
  + [Watch](https://www.apple.com/il/watch/)
  + [Support](https://support.apple.com/en-il/?cid=gn-ols-home-hp-tab)
  + [Where to Buy](https://www.apple.com/il/buy/)

# About the security content of iOS 11.2.5

This document describes the security content of iOS 11.2.5.

## About Apple security updates

For our customers' protection, Apple doesn't disclose, discuss, or confirm security issues until an investigation has occurred and patches or releases are available. Recent releases are listed on the [Apple security updates](https://support.apple.com/kb/HT201222) page.

For more information about security, see the [Apple Product Security](https://support.apple.com/kb/HT201220) page. You can encrypt communications with Apple using the [Apple Product Security PGP Key](https://support.apple.com/kb/HT201601).

Apple security documents reference vulnerabilities by [CVE-ID](http://cve.mitre.org/about/) when possible.

## iOS 11.2.5

Released January 23, 2018

**Audio**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: Processing a maliciously crafted audio file may lead to arbitrary code execution

Description: A memory corruption issue was addressed with improved input validation.

CVE-2018-4094: Mingi Cho, Seoyoung Kim, Young-Ho Lee, MinSik Shin and Taekyoung Kwon of the Information Security Lab, Yonsei University

Entry updated November 16, 2018

**Core Bluetooth**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: An application may be able to execute arbitrary code with system privileges

Description: A memory corruption issue was addressed with improved memory handling.

CVE-2018-4087: Rani Idan (@raniXCH) of Zimperium zLabs Team

CVE-2018-4095: Rani Idan (@raniXCH) of Zimperium zLabs Team

**Graphics Driver**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: An application may be able to execute arbitrary code with kernel privileges

Description: A memory corruption issue was addressed with improved memory handling.

CVE-2018-4109: Adam Donenfeld (@doadam) of the Zimperium zLabs Team

Entry added February 8, 2018

**Kernel**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: An application may be able to read restricted memory

Description: A memory initialization issue was addressed with improved memory handling.

CVE-2018-4090: Jann Horn of Google Project Zero

Entry updated November 16, 2018

**Kernel**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: An application may be able to read restricted memory

Description: A race condition was addressed with improved locking.

CVE-2018-4092: Stefan Esser of Antid0te UG

Entry updated November 16, 2018

**Kernel**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: A malicious application may be able to execute arbitrary code with kernel privileges

Description: A memory corruption issue was addressed with improved input validation.

CVE-2018-4082: Russ Cox of Google

Entry updated November 16, 2018

**Kernel**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: An application may be able to read restricted memory

Description: A validation issue was addressed with improved input sanitization.

CVE-2018-4093: Jann Horn of Google Project Zero

**Kernel**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: An application may be able to execute arbitrary code with kernel privileges

Description: A memory corruption issue was addressed with improved memory handling.

CVE-2018-4189: an anonymous researcher

Entry added May 2, 2018

**LinkPresentation**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: Processing a maliciously crafted text message may lead to application denial of service

Description: A resource exhaustion issue was addressed with improved input validation.

CVE-2018-4100: Abraham Masri @cheesecakeufo

Entry updated November 16, 2018

**QuartzCore**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: A memory corruption issue existed in the processing of web content. This issue was addressed with improved input validation.

CVE-2018-4085: Ret2 Systems Inc. working with Trend Micro's Zero Day Initiative

Entry updated November 16, 2018

**Security**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: A certificate may have name constraints applied incorrectly

Description: A certificate evaluation issue existed in the handling of name constraints. This issue was addressed with improved trust evaluation of certificates.

CVE-2018-4086: Ian Haken of Netflix

Entry updated November 16, 2018

**WebKit**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed with improved memory handling.

CVE-2018-4088: Jeonghoon Shin of Theori

CVE-2018-4089: Ivan Fratric of Google Project Zero

CVE-2018-4096: found by OSS-Fuzz

**WebKit**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed with improved memory handling.

CVE-2018-4147: found by OSS-Fuzz

Entry added October 18, 2018

**WebKit Page Loading**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed with improved memory handling.

CVE-2017-7830: Jun Kokatsu (@shhnjk)

Entry added October 18, 2018

Information about products not manufactured by Apple, or independent websites not controlled or tested by Apple, is provided without recommendation or endorsement. Apple assumes no responsibility with regard to the selection, performance, or use of third-party websites or products. Apple makes no representations regarding third-party website accuracy or reliability. [Contact the vendor](https://support.apple.com/103190) for additional information.

Published Date: November 03, 2023

Helpful?

Yes

No

Character limit:
250

Maximum character limit is 250.

Please don’t include any personal information in your comment.
Submit

Thanks for your feedback.

## Apple Footer

[
Apple](https://www.apple.com/il)

1. [Support](https://support.apple.com/en-il)
2. About the security content of iOS 11.2.5

[Israel](https://support.apple.com/en-il/103685/localeselector "Choose your country or region")

Copyright © 2025 Apple Inc. All rights reserved.
[Terms of Use](https://www.apple.com/legal/)
[Site Map](https://www.apple.com/il/sitemap/)



=== Content from support.apple.com_5a43e83a_20250125_151946.html ===


* [Apple](https://www.apple.com/)
* + [Store](https://www.apple.com/us/shop/goto/store)
  + [Mac](https://www.apple.com/mac/)
  + [iPad](https://www.apple.com/ipad/)
  + [iPhone](https://www.apple.com/iphone/)
  + [Watch](https://www.apple.com/watch/)
  + [Vision](https://www.apple.com/apple-vision-pro/)
  + [AirPods](https://www.apple.com/airpods/)
  + [TV & Home](https://www.apple.com/tv-home/)
  + [Entertainment](https://www.apple.com/entertainment/)
  + [Accessories](https://www.apple.com/us/shop/goto/buy_accessories)
  + [Support](https://support.apple.com/?cid=gn-ols-home-hp-tab)
* 0+

# About the security content of iOS 11.2.5

This document describes the security content of iOS 11.2.5.

## About Apple security updates

For our customers' protection, Apple doesn't disclose, discuss, or confirm security issues until an investigation has occurred and patches or releases are available. Recent releases are listed on the [Apple security updates](https://support.apple.com/kb/HT201222) page.

For more information about security, see the [Apple Product Security](https://support.apple.com/kb/HT201220) page. You can encrypt communications with Apple using the [Apple Product Security PGP Key](https://support.apple.com/kb/HT201601).

Apple security documents reference vulnerabilities by [CVE-ID](http://cve.mitre.org/about/) when possible.

## iOS 11.2.5

Released January 23, 2018

**Audio**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: Processing a maliciously crafted audio file may lead to arbitrary code execution

Description: A memory corruption issue was addressed with improved input validation.

CVE-2018-4094: Mingi Cho, Seoyoung Kim, Young-Ho Lee, MinSik Shin and Taekyoung Kwon of the Information Security Lab, Yonsei University

Entry updated November 16, 2018

**Core Bluetooth**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: An application may be able to execute arbitrary code with system privileges

Description: A memory corruption issue was addressed with improved memory handling.

CVE-2018-4087: Rani Idan (@raniXCH) of Zimperium zLabs Team

CVE-2018-4095: Rani Idan (@raniXCH) of Zimperium zLabs Team

**Graphics Driver**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: An application may be able to execute arbitrary code with kernel privileges

Description: A memory corruption issue was addressed with improved memory handling.

CVE-2018-4109: Adam Donenfeld (@doadam) of the Zimperium zLabs Team

Entry added February 8, 2018

**Kernel**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: An application may be able to read restricted memory

Description: A memory initialization issue was addressed with improved memory handling.

CVE-2018-4090: Jann Horn of Google Project Zero

Entry updated November 16, 2018

**Kernel**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: An application may be able to read restricted memory

Description: A race condition was addressed with improved locking.

CVE-2018-4092: Stefan Esser of Antid0te UG

Entry updated November 16, 2018

**Kernel**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: A malicious application may be able to execute arbitrary code with kernel privileges

Description: A memory corruption issue was addressed with improved input validation.

CVE-2018-4082: Russ Cox of Google

Entry updated November 16, 2018

**Kernel**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: An application may be able to read restricted memory

Description: A validation issue was addressed with improved input sanitization.

CVE-2018-4093: Jann Horn of Google Project Zero

**Kernel**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: An application may be able to execute arbitrary code with kernel privileges

Description: A memory corruption issue was addressed with improved memory handling.

CVE-2018-4189: an anonymous researcher

Entry added May 2, 2018

**LinkPresentation**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: Processing a maliciously crafted text message may lead to application denial of service

Description: A resource exhaustion issue was addressed with improved input validation.

CVE-2018-4100: Abraham Masri @cheesecakeufo

Entry updated November 16, 2018

**QuartzCore**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: A memory corruption issue existed in the processing of web content. This issue was addressed with improved input validation.

CVE-2018-4085: Ret2 Systems Inc. working with Trend Micro's Zero Day Initiative

Entry updated November 16, 2018

**Security**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: A certificate may have name constraints applied incorrectly

Description: A certificate evaluation issue existed in the handling of name constraints. This issue was addressed with improved trust evaluation of certificates.

CVE-2018-4086: Ian Haken of Netflix

Entry updated November 16, 2018

**WebKit**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed with improved memory handling.

CVE-2018-4088: Jeonghoon Shin of Theori

CVE-2018-4089: Ivan Fratric of Google Project Zero

CVE-2018-4096: found by OSS-Fuzz

**WebKit**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed with improved memory handling.

CVE-2018-4147: found by OSS-Fuzz

Entry added October 18, 2018

**WebKit Page Loading**

Available for: iPhone 5s and later, iPad Air and later, and iPod touch 6th generation

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed with improved memory handling.

CVE-2017-7830: Jun Kokatsu (@shhnjk)

Entry added October 18, 2018

Information about products not manufactured by Apple, or independent websites not controlled or tested by Apple, is provided without recommendation or endorsement. Apple assumes no responsibility with regard to the selection, performance, or use of third-party websites or products. Apple makes no representations regarding third-party website accuracy or reliability. [Contact the vendor](https://support.apple.com/103190) for additional information.

Published Date: November 03, 2023

Helpful?

Yes

No

Character limit:
250

Maximum character limit is 250.

Please don’t include any personal information in your comment.
Submit

Thanks for your feedback.

## Apple Footer

[
Apple](https://www.apple.com)

1. [Support](https://support.apple.com)
2. About the security content of iOS 11.2.5

[United States](https://support.apple.com/en-us/103685/localeselector "Choose your country or region")

Copyright © 2025 Apple Inc. All rights reserved.
 [Privacy Policy](https://www.apple.com/legal/privacy/en-ww/) [Terms of Use](https://www.apple.com/legal/internet-services/terms/site.html) [Sales and Refunds](https://www.apple.com/shop/goto/help/sales_refunds) [Site Map](https://www.apple.com/sitemap/)



=== Content from support.apple.com_a62df0fe_20250126_095041.html ===


* [Apple](https://www.apple.com/il/)
* + [Mac](https://www.apple.com/il/mac/)
  + [iPad](https://www.apple.com/il/ipad/)
  + [iPhone](https://www.apple.com/il/iphone/)
  + [Watch](https://www.apple.com/il/watch/)
  + [Support](https://support.apple.com/en-il/?cid=gn-ols-home-hp-tab)
  + [Where to Buy](https://www.apple.com/il/buy/)

# About the security content of tvOS 11.2.5

This document describes the security content of tvOS 11.2.5.

## About Apple security updates

For our customers' protection, Apple doesn't disclose, discuss, or confirm security issues until an investigation has occurred and patches or releases are available. Recent releases are listed on the [Apple security updates](https://support.apple.com/kb/HT201222) page.

For more information about security, see the [Apple Product Security](https://support.apple.com/kb/HT201220) page. You can encrypt communications with Apple using the [Apple Product Security PGP Key](https://support.apple.com/kb/HT201601).

Apple security documents reference vulnerabilities by [CVE-ID](http://cve.mitre.org/about/) when possible.

## tvOS 11.2.5

Released January 23, 2018

**Audio**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: Processing a maliciously crafted audio file may lead to arbitrary code execution

Description: A memory corruption issue was addressed with improved input validation.

CVE-2018-4094: Mingi Cho, Seoyoung Kim, Young-Ho Lee, MinSik Shin and Taekyoung Kwon of the Information Security Lab, Yonsei University

Entry updated November 16, 2018

**Core Bluetooth**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: An application may be able to execute arbitrary code with system privileges

Description: A memory corruption issue was addressed with improved memory handling.

CVE-2018-4087: Rani Idan (@raniXCH) of Zimperium zLabs Team

CVE-2018-4095: Rani Idan (@raniXCH) of Zimperium zLabs Team

**Graphics Driver**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: An application may be able to execute arbitrary code with kernel privileges

Description: A memory corruption issue was addressed with improved memory handling.

CVE-2018-4109: Adam Donenfeld (@doadam) of the Zimperium zLabs Team

Entry added February 8, 2018

**Kernel**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: An application may be able to read restricted memory

Description: A memory initialization issue was addressed with improved memory handling.

CVE-2018-4090: Jann Horn of Google Project Zero

Entry updated November 16, 2018

**Kernel**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: An application may be able to read restricted memory

Description: A race condition was addressed with improved locking.

CVE-2018-4092: Stefan Esser of Antid0te UG

Entry updated November 16, 2018

**Kernel**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: A malicious application may be able to execute arbitrary code with kernel privileges

Description: A memory corruption issue was addressed with improved input validation.

CVE-2018-4082: Russ Cox of Google

Entry updated November 16, 2018

**Kernel**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: An application may be able to read restricted memory

Description: A validation issue was addressed with improved input sanitization.

CVE-2018-4093: Jann Horn of Google Project Zero

**Kernel**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: An application may be able to execute arbitrary code with kernel privileges

Description: A memory corruption issue was addressed with improved memory handling.

CVE-2018-4189: an anonymous researcher

Entry added May 2, 2018

**QuartzCore**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: A memory corruption issue existed in the processing of web content. This issue was addressed with improved input validation.

CVE-2018-4085: Ret2 Systems Inc. working with Trend Micro's Zero Day Initiative

Entry updated November 16, 2018

**Security**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: A certificate may have name constraints applied incorrectly

Description: A certificate evaluation issue existed in the handling of name constraints. This issue was addressed with improved trust evaluation of certificates.

CVE-2018-4086: Ian Haken of Netflix

Entry updated November 16, 2018

**WebKit**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed with improved memory handling.

CVE-2018-4088: Jeonghoon Shin of Theori

CVE-2018-4089: Ivan Fratric of Google Project Zero

CVE-2018-4096: found by OSS-Fuzz

**WebKit**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed with improved memory handling.

CVE-2018-4147: found by OSS-Fuzz

Entry added October 18, 2018

**WebKit Page Loading**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed with improved memory handling.

CVE-2017-7830: Jun Kokatsu (@shhnjk)

Entry added October 18, 2018

Information about products not manufactured by Apple, or independent websites not controlled or tested by Apple, is provided without recommendation or endorsement. Apple assumes no responsibility with regard to the selection, performance, or use of third-party websites or products. Apple makes no representations regarding third-party website accuracy or reliability. [Contact the vendor](https://support.apple.com/103190) for additional information.

Published Date: November 03, 2023

Helpful?

Yes

No

Character limit:
250

Maximum character limit is 250.

Please don’t include any personal information in your comment.
Submit

Thanks for your feedback.

## Apple Footer

[
Apple](https://www.apple.com/il)

1. [Support](https://support.apple.com/en-il)
2. About the security content of tvOS 11.2.5

[Israel](https://support.apple.com/en-il/103684/localeselector "Choose your country or region")

Copyright © 2025 Apple Inc. All rights reserved.
[Terms of Use](https://www.apple.com/legal/)
[Site Map](https://www.apple.com/il/sitemap/)



=== Content from support.apple.com_fbd0dba5_20250125_151945.html ===


* [Apple](https://www.apple.com/)
* + [Store](https://www.apple.com/us/shop/goto/store)
  + [Mac](https://www.apple.com/mac/)
  + [iPad](https://www.apple.com/ipad/)
  + [iPhone](https://www.apple.com/iphone/)
  + [Watch](https://www.apple.com/watch/)
  + [Vision](https://www.apple.com/apple-vision-pro/)
  + [AirPods](https://www.apple.com/airpods/)
  + [TV & Home](https://www.apple.com/tv-home/)
  + [Entertainment](https://www.apple.com/entertainment/)
  + [Accessories](https://www.apple.com/us/shop/goto/buy_accessories)
  + [Support](https://support.apple.com/?cid=gn-ols-home-hp-tab)
* 0+

# About the security content of tvOS 11.2.5

This document describes the security content of tvOS 11.2.5.

## About Apple security updates

For our customers' protection, Apple doesn't disclose, discuss, or confirm security issues until an investigation has occurred and patches or releases are available. Recent releases are listed on the [Apple security updates](https://support.apple.com/kb/HT201222) page.

For more information about security, see the [Apple Product Security](https://support.apple.com/kb/HT201220) page. You can encrypt communications with Apple using the [Apple Product Security PGP Key](https://support.apple.com/kb/HT201601).

Apple security documents reference vulnerabilities by [CVE-ID](http://cve.mitre.org/about/) when possible.

## tvOS 11.2.5

Released January 23, 2018

**Audio**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: Processing a maliciously crafted audio file may lead to arbitrary code execution

Description: A memory corruption issue was addressed with improved input validation.

CVE-2018-4094: Mingi Cho, Seoyoung Kim, Young-Ho Lee, MinSik Shin and Taekyoung Kwon of the Information Security Lab, Yonsei University

Entry updated November 16, 2018

**Core Bluetooth**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: An application may be able to execute arbitrary code with system privileges

Description: A memory corruption issue was addressed with improved memory handling.

CVE-2018-4087: Rani Idan (@raniXCH) of Zimperium zLabs Team

CVE-2018-4095: Rani Idan (@raniXCH) of Zimperium zLabs Team

**Graphics Driver**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: An application may be able to execute arbitrary code with kernel privileges

Description: A memory corruption issue was addressed with improved memory handling.

CVE-2018-4109: Adam Donenfeld (@doadam) of the Zimperium zLabs Team

Entry added February 8, 2018

**Kernel**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: An application may be able to read restricted memory

Description: A memory initialization issue was addressed with improved memory handling.

CVE-2018-4090: Jann Horn of Google Project Zero

Entry updated November 16, 2018

**Kernel**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: An application may be able to read restricted memory

Description: A race condition was addressed with improved locking.

CVE-2018-4092: Stefan Esser of Antid0te UG

Entry updated November 16, 2018

**Kernel**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: A malicious application may be able to execute arbitrary code with kernel privileges

Description: A memory corruption issue was addressed with improved input validation.

CVE-2018-4082: Russ Cox of Google

Entry updated November 16, 2018

**Kernel**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: An application may be able to read restricted memory

Description: A validation issue was addressed with improved input sanitization.

CVE-2018-4093: Jann Horn of Google Project Zero

**Kernel**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: An application may be able to execute arbitrary code with kernel privileges

Description: A memory corruption issue was addressed with improved memory handling.

CVE-2018-4189: an anonymous researcher

Entry added May 2, 2018

**QuartzCore**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: A memory corruption issue existed in the processing of web content. This issue was addressed with improved input validation.

CVE-2018-4085: Ret2 Systems Inc. working with Trend Micro's Zero Day Initiative

Entry updated November 16, 2018

**Security**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: A certificate may have name constraints applied incorrectly

Description: A certificate evaluation issue existed in the handling of name constraints. This issue was addressed with improved trust evaluation of certificates.

CVE-2018-4086: Ian Haken of Netflix

Entry updated November 16, 2018

**WebKit**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed with improved memory handling.

CVE-2018-4088: Jeonghoon Shin of Theori

CVE-2018-4089: Ivan Fratric of Google Project Zero

CVE-2018-4096: found by OSS-Fuzz

**WebKit**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed with improved memory handling.

CVE-2018-4147: found by OSS-Fuzz

Entry added October 18, 2018

**WebKit Page Loading**

Available for: Apple TV 4K and Apple TV (4th generation)

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed with improved memory handling.

CVE-2017-7830: Jun Kokatsu (@shhnjk)

Entry added October 18, 2018

Information about products not manufactured by Apple, or independent websites not controlled or tested by Apple, is provided without recommendation or endorsement. Apple assumes no responsibility with regard to the selection, performance, or use of third-party websites or products. Apple makes no representations regarding third-party website accuracy or reliability. [Contact the vendor](https://support.apple.com/103190) for additional information.

Published Date: November 03, 2023

Helpful?

Yes

No

Character limit:
250

Maximum character limit is 250.

Please don’t include any personal information in your comment.
Submit

Thanks for your feedback.

## Apple Footer

[
Apple](https://www.apple.com)

1. [Support](https://support.apple.com)
2. About the security content of tvOS 11.2.5

[United States](https://support.apple.com/en-us/103684/localeselector "Choose your country or region")

Copyright © 2025 Apple Inc. All rights reserved.
 [Privacy Policy](https://www.apple.com/legal/privacy/en-ww/) [Terms of Use](https://www.apple.com/legal/internet-services/terms/site.html) [Sales and Refunds](https://www.apple.com/shop/goto/help/sales_refunds) [Site Map](https://www.apple.com/sitemap/)



=== Content from support.apple.com_59b4c1ea_20250125_151948.html ===


* [Apple](https://www.apple.com/)
* + [Store](https://www.apple.com/us/shop/goto/store)
  + [Mac](https://www.apple.com/mac/)
  + [iPad](https://www.apple.com/ipad/)
  + [iPhone](https://www.apple.com/iphone/)
  + [Watch](https://www.apple.com/watch/)
  + [Vision](https://www.apple.com/apple-vision-pro/)
  + [AirPods](https://www.apple.com/airpods/)
  + [TV & Home](https://www.apple.com/tv-home/)
  + [Entertainment](https://www.apple.com/entertainment/)
  + [Accessories](https://www.apple.com/us/shop/goto/buy_accessories)
  + [Support](https://support.apple.com/?cid=gn-ols-home-hp-tab)
* 0+

# About the security content of watchOS 4.2.2

This document describes the security content of watchOS 4.2.2.

## About Apple security updates

For our customers' protection, Apple doesn't disclose, discuss, or confirm security issues until an investigation has occurred and patches or releases are available. Recent releases are listed on the [Apple security updates](https://support.apple.com/kb/HT201222) page.

For more information about security, see the [Apple Product Security](https://support.apple.com/kb/HT201220) page. You can encrypt communications with Apple using the [Apple Product Security PGP Key](https://support.apple.com/kb/HT201601).

Apple security documents reference vulnerabilities by [CVE-ID](http://cve.mitre.org/about/) when possible.

## watchOS 4.2.2

Released January 23, 2018

**Audio**

Available for: All Apple Watch models

Impact: Processing a maliciously crafted audio file may lead to arbitrary code execution

Description: A memory corruption issue was addressed with improved input validation.

CVE-2018-4094: Mingi Cho, Seoyoung Kim, Young-Ho Lee, MinSik Shin and Taekyoung Kwon of the Information Security Lab, Yonsei University

Entry added November 16, 2018

**Core Bluetooth**

Available for: All Apple Watch models

Impact: An application may be able to execute arbitrary code with system privileges

Description: A memory corruption issue was addressed with improved memory handling.

CVE-2018-4087: Rani Idan (@raniXCH) of Zimperium zLabs Team

CVE-2018-4095: Rani Idan (@raniXCH) of Zimperium zLabs Team

**Graphics Driver**

Available for: All Apple Watch models

Impact: An application may be able to execute arbitrary code with kernel privileges

Description: A memory corruption issue was addressed with improved memory handling.

CVE-2018-4109: Adam Donenfeld (@doadam) of the Zimperium zLabs Team

Entry added February 8, 2018

**Kernel**

Available for: All Apple Watch models

Impact: An application may be able to read restricted memory

Description: A memory initialization issue was addressed with improved memory handling.

CVE-2018-4090: Jann Horn of Google Project Zero

Entry updated November 16, 2018

**Kernel**

Available for: All Apple Watch models

Impact: An application may be able to read restricted memory

Description: A race condition was addressed with improved locking.

CVE-2018-4092: Stefan Esser of Antid0te UG

Entry updated November 16, 2018

**Kernel**

Available for: All Apple Watch models

Impact: A malicious application may be able to execute arbitrary code with kernel privileges

Description: A memory corruption issue was addressed with improved input validation.

CVE-2018-4082: Russ Cox of Google

Entry updated November 16, 2018

**Kernel**

Available for: All Apple Watch models

Impact: An application may be able to read restricted memory

Description: A validation issue was addressed with improved input sanitization.

CVE-2018-4093: Jann Horn of Google Project Zero

**Kernel**

Available for: All Apple Watch models

Impact: An application may be able to execute arbitrary code with kernel privileges

Description: A memory corruption issue was addressed with improved memory handling.

CVE-2018-4189: an anonymous researcher

Entry added May 2, 2018

**LinkPresentation**

Available for: All Apple Watch models

Impact: Processing a maliciously crafted text message may lead to application denial of service

Description: A resource exhaustion issue was addressed with improved input validation.

CVE-2018-4100: Abraham Masri @cheesecakeufo

Entry updated November 16, 2018

**QuartzCore**

Available for: All Apple Watch models

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: A memory corruption issue existed in the processing of web content. This issue was addressed with improved input validation.

CVE-2018-4085: Ret2 Systems Inc. working with Trend Micro's Zero Day Initiative

Entry updated November 16, 2018

**Security**

Available for: All Apple Watch models

Impact: A certificate may have name constraints applied incorrectly

Description: A certificate evaluation issue existed in the handling of name constraints. This issue was addressed with improved trust evaluation of certificates.

CVE-2018-4086: Ian Haken of Netflix

Entry updated November 16, 2018

**WebKit**

Available for: All Apple Watch models

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed with improved memory handling.

CVE-2018-4088: Jeonghoon Shin of Theori

CVE-2018-4096: found by OSS-Fuzz

**WebKit**

Available for: All Apple Watch models

Impact: Processing maliciously crafted web content may lead to arbitrary code execution

Description: Multiple memory corruption issues were addressed with improved memory handling.

CVE-2018-4147: found by OSS-Fuzz

Entry added October 1, 2018

Information about products not manufactured by Apple, or independent websites not controlled or tested by Apple, is provided without recommendation or endorsement. Apple assumes no responsibility with regard to the selection, performance, or use of third-party websites or products. Apple makes no representations regarding third-party website accuracy or reliability. [Contact the vendor](https://support.apple.com/103190) for additional information.

Published Date: November 03, 2023

Helpful?

Yes

No

Character limit:
250

Maximum character limit is 250.

Please don’t include any personal information in your comment.
Submit

Thanks for your feedback.

## Apple Footer

[
Apple](https://www.apple.com)

1. [Support](https://support.apple.com)
2. About the security content of watchOS 4.2.2

[United States](https://support.apple.com/en-us/103686/localeselector "Choose your country or region")

Copyright © 2025 Apple Inc. All rights reserved.
 [Privacy Policy](https://www.apple.com/legal/privacy/en-ww/) [Terms of Use](https://www.apple.com/legal/internet-services/terms/site.html) [Sales and Refunds](https://www.apple.com/shop/goto/help/sales_refunds) [Site Map](https://www.apple.com/sitemap/)


