- **Root cause of vulnerability:** The vulnerability stems from an incorrect dereference within the `XML_GetRawEncJpg` function. The function attempts to dereference the `PostDataLen` field, which is meant to be a size value, as if it were a pointer.
- **Weaknesses/vulnerabilities present:** The primary vulnerability is a memory dereference of an invalid address, caused by treating a size argument as a pointer. This is likely a result of a prototype mismatch or leftover code from a previous firmware version.
- **Impact of exploitation:** Exploitation leads to a denial-of-service condition, causing the device to reboot due to the memory access violation.
- **Attack vectors:** The attack vector is sending a specially crafted HTTP request to the deviceâ€™s web server on port 80. This involves utilizing the `XML_GetRawEncJpg` command with an arbitrary value for `PostDataLen`.
- **Required attacker capabilities/position:** The attacker must be on the same network as the device, connected to the "Roav_A1_" Wi-Fi network, and able to send HTTP requests to the device's IP address. The attacker doesn't need authentication to trigger the vulnerability.