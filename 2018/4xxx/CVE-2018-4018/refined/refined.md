- **Root cause of vulnerability**: The HTTP server running on the Novatek NT9665X chipset mounts the root of the SD card, allowing arbitrary file uploads through HTTP PUT requests. The device then automatically attempts to flash a firmware file named "FW96658A.bin" upon reboot, without proper signature or validation checks.
- **Weaknesses/vulnerabilities present**:
    - Unauthenticated HTTP server: The web server running on port 80 does not require authentication.
    - Arbitrary file upload: The server allows arbitrary files to be uploaded to the root directory of the SD card via HTTP PUT requests.
    - Insecure firmware update process: The device automatically attempts to flash the firmware from a file named "FW96658A.bin" located at the root of the SD card upon reboot without proper signature validation or integrity checks.
    - Lack of input sanitization: There appears to be no sanitization of the uploaded file name to prevent arbitrary file writes.
- **Impact of exploitation**: An attacker can upload a malicious firmware file named "FW96658A.bin" to the SD card. On the next reboot, the device will flash the malicious firmware, potentially leading to complete compromise of the device, denial of service, or other malicious activity.
- **Attack vectors**: The vulnerability can be exploited by sending an HTTP PUT request to the device's web server, typically running on port 80, to upload a malicious firmware file named "FW96658A.bin".
- **Required attacker capabilities/position**:
    - The attacker must be on the same network as the target device or have the ability to send HTTP requests to the device's IP address (192.168.1.254 by default).
    - The attacker needs to know the default SSID ("Roav_A1_") and password ("goroavcam") for the Wi-Fi AP of the device to gain network access to the device or have pre-existing network access to the device.
    - The attacker must have the knowledge or tools to create a custom firmware file that will run on the target device.