- **Root cause of vulnerability**: Integer underflow when parsing SRV records in an mDNS packet. The "RDLENGTH" value is decremented by 6 without proper bounds checking.
- **Weaknesses/vulnerabilities**:
  - Integer underflow (CWE-191): Subtracting 6 from `rdlength` without validating if `rdlength` is greater than or equal to 6.
  - Out-of-bounds read/write: An overly large `rdlength` is used in the `collect_strings` function to allocate memory, and then subsequently to copy data, which results in accessing memory out-of-bounds.
- **Impact of exploitation**: Denial of service (crash) of the `mdnscap` process.
- **Attack vectors**: Sending a crafted mDNS message with a SRV record and a `rdlength` value less than 6 (specifically 5).
- **Required attacker capabilities/position**: The attacker needs to be able to send UDP packets on port 5353 to the CUJO Smart Firewall. No authentication is required.