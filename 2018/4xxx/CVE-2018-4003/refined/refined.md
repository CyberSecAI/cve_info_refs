- **Root cause of vulnerability:** Incorrect handling of string lengths when parsing character strings in mDNS resource records, specifically within the `collect_strings` function. The vulnerability arises because the code doesn't properly account for the cumulative length of multiple character strings, allowing a heap-based buffer overflow.

- **Weaknesses/vulnerabilities present:** Heap-based buffer overflow (CWE-122). The `collect_strings` function allocates a buffer based on the declared RDLENGTH, but doesn't check if the combined length of the individual strings within RDATA and their separators exceeds this buffer. This leads to a buffer overflow during the string concatenation process.

- **Impact of exploitation:** Arbitrary code execution in the context of the `mdnscap` process. The attacker could escape the chroot environment and elevate privileges to fully compromise the device.

- **Attack vectors:** Sending a crafted mDNS message to the CUJO Smart Firewall on UDP port 5353. The malicious mDNS message must include an answer, authority, or additional section with a TXT, HINFO or SRV resource record, where the RDATA field contains multiple character strings with lengths that, combined with separators, exceed the declared RDLENGTH.

- **Required attacker capabilities/position:** The attacker needs to be able to send UDP packets to the CUJO device on port 5353. No authentication is required.