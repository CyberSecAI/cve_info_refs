- **Root cause of vulnerability**: Improper input validation in the `removePackageWithID` function of the Clean My Mac X helper service. The function uses the `pkgutil` utility with the `--forget` command to remove package receipt information without validating the calling application.
- **Weaknesses/vulnerabilities present**: Privilege escalation due to the lack of validation on the calling application. The privileged helper service runs as root, allowing any application to call the vulnerable function.
- **Impact of exploitation**: An attacker with local access can modify the file system as root by deleting privileged information about a package. This could potentially lead to further system compromise or denial of service by disrupting package management.
- **Attack vectors**: A local attacker can exploit the vulnerability by calling the `removePackageWithID` function through the helper protocol.
- **Required attacker capabilities/position**: The attacker needs local access to the vulnerable system, and no specific user privileges are required to trigger the vulnerability.