=== Content from www.scip.ch_30e68e72_20250126_002336.html ===


* ![scip](/_thm/scip.svg)
* [«](?labs)
* [Company](?about)
  + [About Us](?about)
  + [News](?news)
  + [Talks](?about#talks)
  + [Interviews](?about#interviews)
  + [History](?about#history)
  + [Data Privacy Notice](?dataprivacy)
* [Services](?services)
  + [![Red Team](/_thm/scip_bear_icon.gif)Offense](?offense)
  + [![Blue Team](/_thm/scip_owl_icon.gif)Defense](?defense)
  + [![Titanium Team](/_thm/scip_octopus_icon.gif)Research](?research)
* [Contact](?contact)
  + [Contact us](?contact)
  + [Locations](?contact#map)
* [Blog](?labs)
* [Blog](?labs)
  + [Overview](?labs)
  + [Archive (2003-2025)](?labs.archive)
  + [Books](?about#books)
* [Contact](?contact)
  + [Contact](?contact)
  + [Locations](?contact#map)
![Graphical User Interface Security – The Real Risk of Race Conditions](/_img/1920x1080/laptop_programming_code_css_bright.jpg)
# Graphical User Interface Security

## The Real Risk of Race Conditions

[![Marc Ruef](/_img/team/medium/maru.jpg "Marc Ruef")](?team.maru)by Marc Ruef time to read: 6 minutes

[Source code analyses](?labs.20140424) are used to identify vulnerabilities in software. The traditional approach here is to concentrate on sequential procedures initiated by specific user input. But this ignores the logic of the *graphical user interface* (GUI), which means that vulnerabilities can easily be overlooked.

# 0-day Vulnerability in iPad App

On August 31, 2017, we discovered a [vulnerability](https://vuldb.com/?id.106056) in Mirmay’s popular [Secure Private Browser](https://itunes.apple.com/us/app/secure-private-browser-file-manager/id625458492) app. We alerted the developer team straight away.

The app can be used to run a *secure browser*. It functions as a dedicated app which can be secured with authentication (PIN or Touch ID), but as soon as the user exits the app, all open pages are closed. This means that when the app is re-opened, the user has to complete the local authentication process on the device once again before they can access content. Even when the app is shown in the preview of the multitasking switcher, only the login screen is visible. This means that once the user closes the app, third parties can no longer see the last site accessed – a feature already widespread in mobile banking apps.

A *race condition* opens up the possibility of inadvertently creating a situation in which this automatic lock fails to function properly.

## The Exploit

The following steps are required to exploit this vulnerability:

1. Open the *Secure Private Browser* app
2. Authenticate within the app
3. Play a video (e.g. on YouTube)
4. Minimize the video
5. Close the *Secure Private Browser* app (video now plays in minimized format)
6. Maximize the video
7. Cancel the iOS authentication
8. Close the *Secure Private Browser* app
9. Open the multitasking switcher by double-clicking on the home button ⇒ video appears in preview (vulnerability 1)
10. Cancel the authentication ⇒ video can be played (vulnerability 2)

A few criteria must be met for this vulnerability to occur and be exploited. Basically, a certain degree of *incorrect use* is required. Still, it is possible to inadvertently create this situation and thus nullify the core security function of the app.

## Technical Background

Without access to the code, it is difficult to reconstruct the technical conditions behind this vulnerability with complete accuracy.

However, there is an indication that the app doesn’t correctly follow the sequence of actions at this specific point. When the video minimizes and the app opens again, [LocalAuthentication](https://developer.apple.com/documentation/localauthentication) should be used to close the video or display an [overlay](http://pinkstone.co.uk/how-to-control-the-preview-screenshot-in-the-ios-multitasking-switcher/) before the initial authentication. Only then should the modal dialog box for authentication be displayed.

```
let myContext = LAContext()
let myLocalizedReasonString = <#String explaining why app needs authentication#>

var authError: NSError? = nil
if #available(iOS 8.0, OSX 10.12, *) {
    if myContext.canEvaluatePolicy(LAPolicy.DeviceOwnerAuthenticationWithBiometrics, error: &authError) {
        myContext.evaluatePolicy(LAPolicy.DeviceOwnerAuthenticationWithBiometrics, localizedReason: myLocalizedReasonString) { (success, evaluateError) in
            if (success) {
                // User authenticated successfully, take appropriate action
            } else {
                // User did not authenticate successfully, look at error and take appropriate action
            }
        }
    } else {
        // Could not evaluate policy; look at authError and present an appropriate message to user
    }
} else {
    // Fallback on earlier versions
}
```
# Conclusion

Developing secure software is not easy, especially when *parallelization*, *multi-threading* and *multi-tasking* are involved. In concrete terms, this is due to a deviation from purely sequential executions, which introduces the problem of complex race conditions. Discovering, analyzing and correcting this class of vulnerability is difficult and, therefore, highly unpopular (this may well be why the manufacturer has not responded at all since we notified them of the vulnerability).

Yet this is precisely why intensive, focused examination of software at this level is so important. With modern GUIs there are numerous different events which can be executed through the various controls. Anyone who wishes to develop secure software with GUIs must have a handle on all of this. And that is certainly no easy task.

## About the Author

[![Marc Ruef](/_img/team/medium/maru.jpg "Marc Ruef")](?team.maru)

*Marc Ruef* has been working in information security since the late 1990s. He is well-known for his many *publications* and *books*. The last one called *The Art of Penetration Testing* is discussing security testing in detail. He is a *lecturer* at several faculties, like ETH, HWZ, HSLU and IKF. ([ORCID 0000-0002-1328-6357](https://orcid.org/0000-0002-1328-6357))

## Links

* <http://pinkstone.co.uk/how-to-control-the-preview-screenshot-in-the-ios-multitasking-switcher/>
* <https://developer.apple.com/documentation/localauthentication>
* <https://itunes.apple.com/us/app/secure-private-browser-file-manager/id625458492>
* <https://vuldb.com/?id.106056>

## Tags

[0-day](https://www.google.com/search?q=site:scip.ch+0-day) [Bank](https://www.google.com/search?q=site:scip.ch+Bank) [Browser](https://www.google.com/search?q=site:scip.ch+Browser) [Exploit](https://www.google.com/search?q=site:scip.ch+Exploit) [HTTP](https://www.google.com/search?q=site:scip.ch+HTTP) [iOS](https://www.google.com/search?q=site:scip.ch+iOS) [iPad](https://www.google.com/search?q=site:scip.ch+iPad) [PIN](https://www.google.com/search?q=site:scip.ch+PIN) [Policy](https://www.google.com/search?q=site:scip.ch+Policy) [Race Condition](https://www.google.com/search?q=site:scip.ch+%22Race+Condition%22) [Risk](https://www.google.com/search?q=site:scip.ch+Risk) [Source Code](https://www.google.com/search?q=site:scip.ch+%22Source+Code%22) [Video](https://www.google.com/search?q=site:scip.ch+Video) [VulDB](https://www.google.com/search?q=site:scip.ch+VulDB) [YouTube](https://www.google.com/search?q=site:scip.ch+YouTube)

# Are you interested in a Penetration Test?

Our experts will get in contact with you!

×[![scip Cybersecurity Forecast](/_img/160x144/space_telescope.jpg)
# scip Cybersecurity Forecast

Marc Ruef](?labs.20241218)[![Specific Criticism of CVSS4](/_img/160x144/sculpture_man_head_bronze.jpg)
# Specific Criticism of CVSS4

Marc Ruef](?labs.20240314)[![scip Cybersecurity Forecast](/_img/160x144/space_telescope.jpg)
# scip Cybersecurity Forecast

Marc Ruef](?labs.20231221)[![Voice Authentication](/_img/160x144/wooden_bridge_forest_green.jpg)
# Voice Authentication

Marc Ruef](?labs.20231012)[# You want more?

Further articles available here](?labs.archive)
# You need support in such a project?

Our experts will get in contact with you!

emailphone[# You want more?

Further articles available here](?labs.archive)
# Contact

[scip AG, Badenerstrasse 623, 8048 Zürich, Switzerland](https://goo.gl/maps/Yk2zgvWzs4x)

[info@scip.ch](?contact)
+41 44 404 13 13

[Data Privacy Notice](?dataprivacy) | [Media Inquiries](?mediainquiries) | [Vulnerability Disclosure](?vulndisclosure) | [Bug Bounty](?bugbounty)

# Sections

[Company](?about) | [Offense](?offense) | [Defense](?defense) | [Research](?research)

[News](?news) | [Articles](?labs) | [Magazine](?smss)

[RSS News](?rss.news) | [RSS Blog](?rss.labs) | [Alexa Flash Briefing](https://www.amazon.de/dp/B07BTJZ95N/)

# Languages

[German](/?labs.20180201)

English

# Links

[Vulnerability Database](https://vuldb.com/) | [Titanium Report](https://titaniumreport.com) | [Interdisciplinary Artificial Intelligence Quotient Scale](http://www.iaiqs.org/) | [Secure Transfer Server](https://transfer.scip.ch)

© 2002-2025 by [scip AG](?about)


