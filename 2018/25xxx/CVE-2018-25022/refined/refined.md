```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability is caused by the Onion module of Toxcore erroneously allowing to onion-route any data, any Tox packets, without a restriction. The Tox protocol specification intends that only specific packets are allowed to be onion routed.",
    "weaknesses": [
      "Inadequate restriction of packet types allowed in onion routing."
    ],
    "impact": "An attacker can learn the IP address of a target user by knowing their Tox ID, without being a friend/contact of the target user.",
    "attack_vectors": [
      "The attacker announces themselves to nodes, one of which is the target. This gives the attacker the target's public key.",
      "The attacker sends a NAT Ping Request packet, intended to circumvent NAT, back to the target via onion routing.",
      "The target unknowingly relays this NAT ping request to the attacker, revealing their IP."
    ],
   "attacker_capabilities": "The attacker needs to know the Tox ID of the target user and be able to generate a DHT key close enough to the target's long-term public key to receive the announce request. The attacker also needs to be able to send onion routed packets."
  },
  "cve": "CVE-2018-25022",
    "additional_notes": "The vulnerability affects only the UDP mode of operation. TCP-only mode is not affected. The patch works by making all nodes in the onion path check if the payload of the onion-routed response is a packet kind that shouldnâ€™t be routed through the onion, and if so drop it."
}
```