=== Content from github.com_8edd3d7c_20250125_110709.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgreenbone%2Fgsa%2Freleases%2Ftag%2Fv7.0.3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgreenbone%2Fgsa%2Freleases%2Ftag%2Fv7.0.3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=greenbone%2Fgsa)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[greenbone](/greenbone)
/
**[gsa](/greenbone/gsa)**
Public

* [Notifications](/login?return_to=%2Fgreenbone%2Fgsa) You must be signed in to change notification settings
* [Fork
  99](/login?return_to=%2Fgreenbone%2Fgsa)
* [Star
   228](/login?return_to=%2Fgreenbone%2Fgsa)

* [Code](/greenbone/gsa/tree/v7.0.3)
* [Issues
  12](/greenbone/gsa/issues)
* [Pull requests
  1](/greenbone/gsa/pulls)
* [Actions](/greenbone/gsa/actions)
* [Security](/greenbone/gsa/security)
* [Insights](/greenbone/gsa/pulse)

Additional navigation options

* [Code](/greenbone/gsa/tree/v7.0.3)
* [Issues](/greenbone/gsa/issues)
* [Pull requests](/greenbone/gsa/pulls)
* [Actions](/greenbone/gsa/actions)
* [Security](/greenbone/gsa/security)
* [Insights](/greenbone/gsa/pulse)

1. [Releases](/greenbone/gsa/releases)
2. [v7.0.3](/greenbone/gsa/releases/tag/v7.0.3)

# Greenbone Security Assistant (GSA) 7.0.3

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/greenbone/gsa/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v7.0.3)

 Loading

[View all tags](/greenbone/gsa/tags)

![@jjnicola](https://avatars.githubusercontent.com/u/3997449?s=40&v=4)
[jjnicola](/jjnicola)
released this
29 Mar 11:06

[v7.0.3](/greenbone/gsa/tree/v7.0.3)

[`9fbbb91`](/greenbone/gsa/commit/9fbbb911353c08c077784e97173a1c8ca4445431)

For detailed code changes, please visit

<https://github.com/greenbone/gsa/commits/gsa-7.0>

or get the entire source code repository and view log history:

$ git clone <https://github.com/greenbone/gsa.git>

$ cd gsa && git checkout gsa-7.0 && git log

This is the third maintenance release of the Greenbone Security

Assistant (GSA) 7.0 module for the Open Vulnerability Assessment System

release 9 (OpenVAS-9). It is the web client that makes the full feature

set of OpenVAS Manager available in a web browser.

Many thanks to everyone who has contributed to this release:

Timo Pollmeier, Matthew Mundell, Hani Behabiles, Bjoern Ricks, Michael

Wiegand.

Main changes compared to 7.0.2:

* An issue which caused saving a scan config to fail under certain

  circumstances has been addressed.
* An issue which caused the users language setting to be reset under

  certain circumstances has been addressed.
* A log message is now written for every successful login.
* A number of minor interface issues have been addressed.
* The limit on the target host input field has been removed.
* Support for responding to a request for 'robots.txt' has been added.
* An issue which caused performance problems when deleting overrides

  has been addressed.
* An issue which caused the refresh function to interrupt the access to

  any gsa menu has been addressed.
* An option to resume uncompleted scheduled tasks has been added.
* SMB alerts have been added.
* Cancelling the loading of a page, dialog, dashboard etc. in GSA can

  now also cancel the corresponding request to manger, improving

  performance.
* An issue which caused an internal error getting performance info of an

  unconnected slave has been addressed.
* German translations have been updated.
* Arabic translations have been updated.
* French translations have been updated.
* Chinese translations have been updated.
* An issue which caused problems where pages reverted to a built in

  filter has been addressed.
* The group selection for users now only shows groups which the

  current user has permission to add users to.
* The HTTP header "Host" now has to be validated against a list of

  IP addresses and hostnames, which includes localhost and local

  interface addresses by default.
* The new TippingPoint alert method has been added.
* Status details to certain error dialogs have been added.
* New error message for invalid Host header has been added.
* Date pickers in the schedule dialogs now allow setting dates

  in the past.
* Documentation and help have been updated.
* An issue with file upload form elements has been fixed.
* The performance of the result details has been improved by

  requesting manager to skip counting the results.

 Assets
4

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from avatars.githubusercontent.com_0527cee2_20250126_080840.html ===
�PNG

   
IHDR  �  �   �.�b  �IDATx������0F�LD,)ԅ�� ���h���s���g�s���~� p��H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A����^:�u�[�9ƾz-����H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A�������� �\_��9Wox+�c�c�'���X A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; a[=�g9ƾz�7��Z=��p� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�g�y�K��yx�c�7���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H��9Wo�)�q���}��WO�\v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�gιz���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���  ���%���"    IEND�B`�

=== Content from github.com_64c03d31_20250125_110707.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgreenbone%2Fgsa%2Fpull%2F318)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgreenbone%2Fgsa%2Fpull%2F318)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=greenbone%2Fgsa)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[greenbone](/greenbone)
/
**[gsa](/greenbone/gsa)**
Public

* [Notifications](/login?return_to=%2Fgreenbone%2Fgsa) You must be signed in to change notification settings
* [Fork
  99](/login?return_to=%2Fgreenbone%2Fgsa)
* [Star
   228](/login?return_to=%2Fgreenbone%2Fgsa)

* [Code](/greenbone/gsa)
* [Issues
  12](/greenbone/gsa/issues)
* [Pull requests
  1](/greenbone/gsa/pulls)
* [Actions](/greenbone/gsa/actions)
* [Security](/greenbone/gsa/security)
* [Insights](/greenbone/gsa/pulse)

Additional navigation options

* [Code](/greenbone/gsa)
* [Issues](/greenbone/gsa/issues)
* [Pull requests](/greenbone/gsa/pulls)
* [Actions](/greenbone/gsa/actions)
* [Security](/greenbone/gsa/security)
* [Insights](/greenbone/gsa/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fgreenbone%2Fgsa%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fgreenbone%2Fgsa%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Add test for HTTP header Host in redirects #318

 Merged

[bjoernricks](/bjoernricks)
merged 4 commits into
[greenbone:gsa-7.0](/greenbone/gsa/tree/gsa-7.0 "greenbone/gsa:gsa-7.0")
from
[timopollmeier:check-host-header-7.0](/timopollmeier/gsa/tree/check-host-header-7.0 "timopollmeier/gsa:check-host-header-7.0")

Feb 5, 2018

 Merged

# [Add test for HTTP header Host in redirects](#top) #318

[bjoernricks](/bjoernricks)
merged 4 commits into
[greenbone:gsa-7.0](/greenbone/gsa/tree/gsa-7.0 "greenbone/gsa:gsa-7.0")
from
[timopollmeier:check-host-header-7.0](/timopollmeier/gsa/tree/check-host-header-7.0 "timopollmeier/gsa:check-host-header-7.0")

Feb 5, 2018

[Conversation
14](/greenbone/gsa/pull/318)
[Commits
4](/greenbone/gsa/pull/318/commits)
[Checks
0](/greenbone/gsa/pull/318/checks)
[Files changed](/greenbone/gsa/pull/318/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![timopollmeier](https://avatars.githubusercontent.com/u/32763925?s=60&v=4)](/timopollmeier)

Copy link

Member

### @timopollmeier **[timopollmeier](/timopollmeier)** commented [Jan 31, 2018](#issue-293211302)

The "Host" HTTP header used in redirects now has to refer to a known

host name or address, which by default includes 127.0.0.1, ::1,

localhost and either all addresses given by the --listen option or

all local interface addresses.

Additional host names or addresses can be given with the new command

line option --allow-header-host.

Sorry, something went wrong.

All reactions

[![@timopollmeier](https://avatars.githubusercontent.com/u/32763925?s=40&v=4)](/timopollmeier)

`[Add test for HTTP header Host in redirects](/greenbone/gsa/pull/318/commits/06e8305404b1d8b2a3d4ab4508c42db2e1679490 "Add test for HTTP header Host in redirects

The \"Host\" HTTP header used in redirects now has to refer to a known
host name or address, which by default includes 127.0.0.1, ::1,
localhost and either all addresses given by the --listen option or
all local interface addresses.
Additional host names or addresses can be given with the new command
line option --allow-header-host.")`
 …

`[06e8305](/greenbone/gsa/pull/318/commits/06e8305404b1d8b2a3d4ab4508c42db2e1679490)`

```
The "Host" HTTP header used in redirects now has to refer to a known
host name or address, which by default includes 127.0.0.1, ::1,
localhost and either all addresses given by the --listen option or
all local interface addresses.
Additional host names or addresses can be given with the new command
line option --allow-header-host.
```

 [![@timopollmeier](https://avatars.githubusercontent.com/u/32763925?s=40&v=4)](/timopollmeier)
[timopollmeier](/timopollmeier)
requested a review
from [bjoernricks](/bjoernricks)
[January 31, 2018 15:56](#event-1451061369)

[![cfi-gb](https://avatars.githubusercontent.com/u/34644702?s=60&v=4)](/cfi-gb)

**[cfi-gb](/cfi-gb)**
reviewed
[Feb 1, 2018](#pullrequestreview-93178827)

 [View reviewed changes](/greenbone/gsa/pull/318/files/06e8305404b1d8b2a3d4ab4508c42db2e1679490)

[src/gsad.c](/greenbone/gsa/pull/318/files/06e8305404b1d8b2a3d4ab4508c42db2e1679490#diff-45699750a6f2dc54f9292b29ab9d3880e1ecacc93659aa34e94ee31c5e2a19e9)
Outdated

|  |  | case 2: |
| --- | --- | --- |
|  |  | default: |
|  |  | // Otherwise invalid |
|  |  | send\_response (connection, BAD\_REQUEST\_PAGE, MHD\_HTTP\_NOT\_ACCEPTABLE, |

Copy link

Member

### @cfi-gb **[cfi-gb](/cfi-gb)** [Feb 1, 2018](#discussion_r165270301) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

For improved UX i wouldn't throw a bad request around if the user just accessed the system via a wrong Hostname/IP. If the accepted host headers are just misconfigured the user will never know directly why he gets a bad request when accessing the system.

A way better approach would be to throw a 403 / Forbidden in the case if a valid but not allowed Hostname/IP is used and include a short note in the returned HTML document explaining how to configure the system in a way to be able to access it.

Sorry, something went wrong.

All reactions

[![bjoernricks](https://avatars.githubusercontent.com/u/897575?s=60&v=4)](/bjoernricks)

**[bjoernricks](/bjoernricks)**
requested changes
[Feb 1, 2018](#pullrequestreview-93195563)

 [View reviewed changes](/greenbone/gsa/pull/318/files/06e8305404b1d8b2a3d4ab4508c42db2e1679490)

Copy link

Contributor

### @bjoernricks **[bjoernricks](/bjoernricks)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

The big gsad.c is still a mess to review...

Your code looks valid overall. But I would like to get some stuff extracted into separate functions.

Sorry, something went wrong.

All reactions

[src/gsad.c](/greenbone/gsa/pull/318/files/06e8305404b1d8b2a3d4ab4508c42db2e1679490#diff-45699750a6f2dc54f9292b29ab9d3880e1ecacc93659aa34e94ee31c5e2a19e9)
Outdated

|  |  | else if (g\_utf8\_validate (host\_header, -1, NULL) == FALSE) |
| --- | --- | --- |
|  |  | return 1; |
|  |  |  |
|  |  | bracket\_index = -1; |

Copy link

Contributor

### @bjoernricks **[bjoernricks](/bjoernricks)** [Feb 1, 2018](#discussion_r165284439)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I don't really understand this code in the for loop. Maybe it would be better to extract it into a function or at least at a comment.

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @bjoernricks **[bjoernricks](/bjoernricks)** [Feb 2, 2018](#discussion_r165680127)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks!!!

Sorry, something went wrong.

All reactions

[src/gsad.c](/greenbone/gsa/pull/318/files/06e8305404b1d8b2a3d4ab4508c42db2e1679490#diff-45699750a6f2dc54f9292b29ab9d3880e1ecacc93659aa34e94ee31c5e2a19e9)
Outdated

|  |  |  |
| --- | --- | --- |
|  |  | bracket\_index = -1; |
|  |  | colon\_index = -1; |
|  |  | for (char\_index = strlen (host\_header) - 1; |

Copy link

Contributor

### @bjoernricks **[bjoernricks](/bjoernricks)** [Feb 1, 2018](#discussion_r165286799)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I don't really understand this code. Maybe you can extract it into another function or at least add some comment.

Sorry, something went wrong.

All reactions

[src/gsad.c](/greenbone/gsa/pull/318/files/06e8305404b1d8b2a3d4ab4508c42db2e1679490#diff-45699750a6f2dc54f9292b29ab9d3880e1ecacc93659aa34e94ee31c5e2a19e9)

|  |  | @@ -3828,6 +3833,120 @@ gsad\_add\_content\_type\_header (struct MHD\_Response \*response, | |
| --- | --- | --- | --- |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @brief Add all local IP addresses to a GHashTable. |

Copy link

Contributor

### @bjoernricks **[bjoernricks](/bjoernricks)** [Feb 1, 2018](#discussion_r165287202)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

This doesn't include localhost, 127.x.x.x and the ipv6 local addresses right? So the description is a bit confusing.

Maybe move adding the localhost addresses to the hashmap also into this function.

Sorry, something went wrong.

All reactions

[src/gsad.c](/greenbone/gsa/pull/318/files/06e8305404b1d8b2a3d4ab4508c42db2e1679490#diff-45699750a6f2dc54f9292b29ab9d3880e1ecacc93659aa34e94ee31c5e2a19e9)

|  |  | @@ -6402,6 +6538,14 @@ main (int argc, char \*\*argv) | |
| --- | --- | --- | --- |
|  |  | exit (EXIT\_FAILURE); |
|  |  | } |
|  |  |  |
|  |  | /\* Initialize addresses and accepted host headers for HTTP header \*/ |

Copy link

Contributor

### @bjoernricks **[bjoernricks](/bjoernricks)** [Feb 1, 2018](#discussion_r165287545)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Adding the localhost addresses should be moved into a function.

Sorry, something went wrong.

All reactions

 [timopollmeier](/timopollmeier)
added 3 commits
[February 2, 2018 12:28](#commits-pushed-82b5f74)

[![@timopollmeier](https://avatars.githubusercontent.com/u/32763925?s=40&v=4)](/timopollmeier)

`[Add loopback addresses in add_local_addresses.](/greenbone/gsa/pull/318/commits/82b5f74e6283aad9ab2d75cab4d00b9c440b01ef "Add loopback addresses in add_local_addresses.

The default loopback addresses localhost, 127.0.0.1 and ::1 are now
added in add_local_addresses, which now also has an option not to add
the other interface addresses.
Also, add_local_addresses is now a separate step from gsad_address_init,
which only adds the explicit host addresses to the ones allowed in
the Host header.")`
 …

`[82b5f74](/greenbone/gsa/pull/318/commits/82b5f74e6283aad9ab2d75cab4d00b9c440b01ef)`

```
The default loopback addresses localhost, 127.0.0.1 and ::1 are now
added in add_local_addresses, which now also has an option not to add
the other interface addresses.
Also, add_local_addresses is now a separate step from gsad_address_init,
which only adds the explicit host addresses to the ones allowed in
the Host header.
```

[![@timopollmeier](https://avatars.githubusercontent.com/u/32763925?s=40&v=4)](/timopollmeier)

`[Clarify getting address in validate_host_header.](/greenbone/gsa/pull/318/commits/d3f6534a2544d7ed7360441b7b13a003d17c4df9 "Clarify getting address in validate_host_header.

In validate_host_header comments have been added to explain the cases in
extracting the host address or name from the header value and some of
the conditions have been made clearer.")`
 …

`[d3f6534](/greenbone/gsa/pull/318/commits/d3f6534a2544d7ed7360441b7b13a003d17c4df9)`

```
In validate_host_header comments have been added to explain the cases in
extracting the host address or name from the header value and some of
the conditions have been made clearer.
```

[![@timopollmeier](https://avatars.githubusercontent.com/u/32763925?s=40&v=4)](/timopollmeier)

`[New error message for invalid Host header](/greenbone/gsa/pull/318/commits/b60e098f3e335cb5203894a70769cb1c27e5462a "New error message for invalid Host header

If an invalid or unknown Host header is detected, respond with a more
specific error message.")`
 …

`[b60e098](/greenbone/gsa/pull/318/commits/b60e098f3e335cb5203894a70769cb1c27e5462a)`

```
If an invalid or unknown Host header is detected, respond with a more
specific error message.
```

[![bjoernricks](https://avatars.githubusercontent.com/u/897575?s=60&v=4)](/bjoernricks)

**[bjoernricks](/bjoernricks)**
approved these changes
[Feb 2, 2018](#pullrequestreview-93662492)

 [View reviewed changes](/greenbone/gsa/pull/318/files/06e8305404b1d8b2a3d4ab4508c42db2e1679490)

Copy link

Contributor

### @bjoernricks **[bjoernricks](/bjoernricks)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Nice! Thanks a lot. It's much easier to understand now.

Sorry, something went wrong.

All reactions

[src/gsad.c](/greenbone/gsa/pull/318/files/06e8305404b1d8b2a3d4ab4508c42db2e1679490#diff-45699750a6f2dc54f9292b29ab9d3880e1ecacc93659aa34e94ee31c5e2a19e9)
Outdated

|  |  | else if (g\_utf8\_validate (host\_header, -1, NULL) == FALSE) |
| --- | --- | --- |
|  |  | return 1; |
|  |  |  |
|  |  | bracket\_index = -1; |

Copy link

Contributor

### @bjoernricks **[bjoernricks](/bjoernricks)** [Feb 2, 2018](#discussion_r165680127)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks!!!

Sorry, something went wrong.

All reactions

[![@bjoernricks](https://avatars.githubusercontent.com/u/897575?s=80&u=fc0d370320be552240168deabe4deb2abede7893&v=4)](/bjoernricks)

Copy link

Contributor

### **[bjoernricks](/bjoernricks)** commented [Feb 2, 2018](#issuecomment-362623598)

| If [@cfi-gb](https://github.com/cfi-gb) is fine with the additional changes I would merge it instantly. |
| --- |

All reactions

Sorry, something went wrong.

[![@cfi-gb](https://avatars.githubusercontent.com/u/34644702?s=80&v=4)](/cfi-gb)

Copy link

Member

### **[cfi-gb](/cfi-gb)** commented [Feb 2, 2018](#issuecomment-362702312) • edited Loading

| [@bjoernricks](https://github.com/bjoernricks) I'm still unsure about the `MHD_HTTP_BAD_REQUEST` vs. `MHD_HTTP_FORBIDDEN` in the case where the GSA is misconfigured / doesn't have the expected allowed header configured. Because in this case the client isn't doing a "Bad Request" but just not allowed to access the GSA.  The text / html is IMHO fine for now. It might be linked to the online documentation in the future but i think that is out of the scope of this PR. |
| --- |

All reactions

Sorry, something went wrong.

[![@bjoernricks](https://avatars.githubusercontent.com/u/897575?s=80&u=fc0d370320be552240168deabe4deb2abede7893&v=4)](/bjoernricks)

Copy link

Contributor

### **[bjoernricks](/bjoernricks)** commented [Feb 5, 2018](#issuecomment-363018665)

| [@cfi-gb](https://github.com/cfi-gb) choosing the http status code is difficult indeed. I would got for bad request because it is technically correct. |
| --- |

All reactions

Sorry, something went wrong.

[![@bjoernricks](https://avatars.githubusercontent.com/u/897575?s=40&u=fc0d370320be552240168deabe4deb2abede7893&v=4)](/bjoernricks)
[bjoernricks](/bjoernricks)
merged commit [`fff55ca`](/greenbone/gsa/commit/fff55cae13946fb3ebfe14eba70245472e460baa)
into
greenbone:gsa-7.0

[Feb 5, 2018](https://github.com/greenbone/gsa/pull/318#event-1457440693)

 [![@timopollmeier](https://avatars.githubusercontent.com/u/32763925?s=40&v=4)](/timopollmeier)
[timopollmeier](/timopollmeier)
deleted the
check-host-header-7.0

branch
[February 8, 2018 17:02](#event-1465025884)

This was referenced Apr 5, 2018

[Invalid Request
#505](/greenbone/gsa/issues/505)

Closed

[Access to WEB-console GSA via hostname
#524](/greenbone/gsa/issues/524)

Closed

[![@bjoernricks](https://avatars.githubusercontent.com/u/897575?s=80&u=fc0d370320be552240168deabe4deb2abede7893&v=4)](/bjoernricks)

Copy link

Contributor

### **[bjoernricks](/bjoernricks)** commented [Apr 11, 2018](#issuecomment-380340018)

| Next time we should ensure that such a PR is mentioned in the release notes explicitly. A lot of people are not aware of it like <http://lists.wald.intevation.org/pipermail/openvas-discuss/2018-April/011929.html> |
| --- |

All reactions

Sorry, something went wrong.

[![@bjoernricks](https://avatars.githubusercontent.com/u/897575?s=80&u=fc0d370320be552240168deabe4deb2abede7893&v=4)](/bjoernricks)

Copy link

Contributor

### **[bjoernricks](/bjoernricks)** commented [Apr 11, 2018](#issuecomment-380341093)

| For some background about this PR see   * <https://docs.djangoproject.com/en/2.0/topics/security/#host-headers-virtual-hosting> * <https://www.skeletonscribe.net/2013/05/practical-http-host-header-attacks.html> |
| --- |

All reactions

Sorry, something went wrong.

[![@rassie](https://avatars.githubusercontent.com/u/23448?s=40&v=4)](/rassie)
[rassie](/rassie)
mentioned this pull request
[Apr 16, 2018](#ref-issue-314661955)

[No way to set --allow-header-host
mikesplain/openvas-docker#168](/mikesplain/openvas-docker/issues/168)

Closed

[![@cfi-gb](https://avatars.githubusercontent.com/u/34644702?s=80&v=4)](/cfi-gb)

Copy link

Member

### **[cfi-gb](/cfi-gb)** commented [Jul 1, 2021](#issuecomment-871951469) • edited Loading

| It seems [CVE-2018-25016](https://nvd.nist.gov/vuln/detail/CVE-2018-25016) has been assigned to this recently. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fgreenbone%2Fgsa%2Fpull%2F318)

Reviewers

[![@cfi-gb](https://avatars.githubusercontent.com/u/34644702?s=40&v=4)](/cfi-gb) [cfi-gb](/cfi-gb)

cfi-gb left review comments

[![@bjoernricks](https://avatars.githubusercontent.com/u/897575?s=40&v=4)](/bjoernricks) [bjoernricks](/bjoernricks)

bjoernricks approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@timopollmeier](https://avatars.githubusercontent.com/u/32763925?s=52&v=4)](/timopollmeier) [![@bjoernricks](https://avatars.githubusercontent.com/u/897575?s=52&v=4)](/bjoernricks) [![@cfi-gb](https://avatars.githubusercontent.com/u/34644702?s=52&v=4)](/cfi-gb)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


