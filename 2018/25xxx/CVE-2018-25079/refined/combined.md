=== Content from github.com_d64aebee_20250124_131529.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsegmentio%2Fis-url%2Freleases%2Ftag%2Fv1.2.3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsegmentio%2Fis-url%2Freleases%2Ftag%2Fv1.2.3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=segmentio%2Fis-url)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[segmentio](/segmentio)
/
**[is-url](/segmentio/is-url)**
Public

* [Notifications](/login?return_to=%2Fsegmentio%2Fis-url) You must be signed in to change notification settings
* [Fork
  40](/login?return_to=%2Fsegmentio%2Fis-url)
* [Star
   166](/login?return_to=%2Fsegmentio%2Fis-url)

* [Code](/segmentio/is-url/tree/v1.2.3)
* [Issues
  9](/segmentio/is-url/issues)
* [Pull requests
  2](/segmentio/is-url/pulls)
* [Actions](/segmentio/is-url/actions)
* [Projects
  0](/segmentio/is-url/projects)
* [Security](/segmentio/is-url/security)
* [Insights](/segmentio/is-url/pulse)

Additional navigation options

* [Code](/segmentio/is-url/tree/v1.2.3)
* [Issues](/segmentio/is-url/issues)
* [Pull requests](/segmentio/is-url/pulls)
* [Actions](/segmentio/is-url/actions)
* [Projects](/segmentio/is-url/projects)
* [Security](/segmentio/is-url/security)
* [Insights](/segmentio/is-url/pulse)

[Releases](/segmentio/is-url/releases)
[Tags](/segmentio/is-url/tags)

# v1.2.3

* [v1.2.3](/segmentio/is-url/tree/v1.2.3)
* [`f1c83cf`](/segmentio/is-url/commit/f1c83cf119d696f2268dbec18ecfaae433665cb2)
* Compare

  Choose a tag to compare

  Could not load tags

  Nothing to show

  [{{ refName }}
  default](/segmentio/is-url/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.2.3)

   Loading

  [View all tags](/segmentio/is-url/tags)

[v1.2.3](/segmentio/is-url/releases/tag/v1.2.3)

* [v1.2.3](/segmentio/is-url/tree/v1.2.3)
* [`f1c83cf`](/segmentio/is-url/commit/f1c83cf119d696f2268dbec18ecfaae433665cb2)
* Compare

  Choose a tag to compare

  Could not load tags

  Nothing to show

  [{{ refName }}
  default](/segmentio/is-url/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.2.3)

   Loading

  [View all tags](/segmentio/is-url/tags)

![@zeke](https://avatars.githubusercontent.com/u/2289?s=40&v=4)
[zeke](/zeke)
tagged this
20 Mar 23:21

```
1.2.3
```

 Assets
2

 Loading

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_9140f506_20250124_131528.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsegmentio%2Fis-url%2Fcommit%2F149550935c63a98c11f27f694a7c4a9479e53794)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsegmentio%2Fis-url%2Fcommit%2F149550935c63a98c11f27f694a7c4a9479e53794)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=segmentio%2Fis-url)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[segmentio](/segmentio)
/
**[is-url](/segmentio/is-url)**
Public

* [Notifications](/login?return_to=%2Fsegmentio%2Fis-url) You must be signed in to change notification settings
* [Fork
  40](/login?return_to=%2Fsegmentio%2Fis-url)
* [Star
   166](/login?return_to=%2Fsegmentio%2Fis-url)

* [Code](/segmentio/is-url)
* [Issues
  9](/segmentio/is-url/issues)
* [Pull requests
  2](/segmentio/is-url/pulls)
* [Actions](/segmentio/is-url/actions)
* [Projects
  0](/segmentio/is-url/projects)
* [Security](/segmentio/is-url/security)
* [Insights](/segmentio/is-url/pulse)

Additional navigation options

* [Code](/segmentio/is-url)
* [Issues](/segmentio/is-url/issues)
* [Pull requests](/segmentio/is-url/pulls)
* [Actions](/segmentio/is-url/actions)
* [Projects](/segmentio/is-url/projects)
* [Security](/segmentio/is-url/security)
* [Insights](/segmentio/is-url/pulse)

## Commit

[Permalink](/segmentio/is-url/commit/149550935c63a98c11f27f694a7c4a9479e53794)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

security: Fix REDOS vulnerability

[Browse files](/segmentio/is-url/tree/149550935c63a98c11f27f694a7c4a9479e53794)
Browse the repository at this point in the history

```
Problem:
As disclosed by email, the regex in this module was vulnerable to
catastrophic backtracking.
This could be used as a REDOS vector for Node.js servers that use
this module.

Solution:
Use a two-step validation process.
Split the vulnerable regex into three safe ones.
```

* Loading branch information

[![@davisjam](https://avatars.githubusercontent.com/u/22822319?s=40&v=4)](/davisjam)

[davisjam](/segmentio/is-url/commits?author=davisjam "View all commits by davisjam")
committed
Mar 19, 2018

1 parent
[1498b0d](/segmentio/is-url/commit/1498b0da8e7b5084de523aada49f4bfc0ca7b391)

commit 1495509

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**34 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* index.js
  [index.js](#diff-e727e4bdf3657fd1d798edcd6b099d6e092f8573cba266154583a746bba0f346)
* test

  + test/index.js
    [index.js](#diff-5bb8db779819ddef5956a5d9d5949c05ef7445237656ca37bf2f02720271440b)

## There are no files selected for viewing

26 changes: 23 additions & 3 deletions

26
[index.js](#diff-e727e4bdf3657fd1d798edcd6b099d6e092f8573cba266154583a746bba0f346 "index.js")

Show comments

[View file](/segmentio/is-url/blob/149550935c63a98c11f27f694a7c4a9479e53794/index.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,10 +6,15 @@ |
|  |  | module.exports = isUrl; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Matcher. |
|  |  | \* RegExps. |
|  |  | \* A URL must match #1 and then at least one of #2/#3. |
|  |  | \* Use two levels of REs to avoid REDOS. |
|  |  | \*/ |
|  |  |  |
|  |  | var matcher = /^(?:\w+:)?\/\/([^\s\.]+\.\S{2}|localhost[\:?\d]\*)\S\*$/; |
|  |  | var protocolAndDomainRE = /^(?:\w+:)?\/\/(\S+)$/; |
|  |  |  |
|  |  | var localhostDomainRE = /^localhost[\:?\d]\*(?:[^\:?\d]\S\*)?$/ |
|  |  | var nonLocalhostDomainRE = /^[^\s\.]+\.\S{2,}$/; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Loosely validate a URL `string`. |
| Expand All | | @@ -19,5 +24,20 @@ var matcher = /^(?:\w+:)?\/\/([^\s\.]+\.\S{2}|localhost[\:?\d]\*)\S\*$/; |
|  |  | \*/ |
|  |  |  |
|  |  | function isUrl(string){ |
|  |  | return matcher.test(string); |
|  |  | var match = string.match(protocolAndDomainRE); |
|  |  | if (!match) { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | var everythingAfterProtocol = match[1]; |
|  |  | if (!everythingAfterProtocol) { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | if (localhostDomainRE.test(everythingAfterProtocol) || |
|  |  | nonLocalhostDomainRE.test(everythingAfterProtocol)) { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | return false; |
|  |  | } |

11 changes: 11 additions & 0 deletions

11
[test/index.js](#diff-5bb8db779819ddef5956a5d9d5949c05ef7445237656ca37bf2f02720271440b "test/index.js")

Show comments

[View file](/segmentio/is-url/blob/149550935c63a98c11f27f694a7c4a9479e53794/test/index.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -119,4 +119,15 @@ describe('is-url', function () { |
|  |  | assert(!url('google.com')); |
|  |  | }); |
|  |  | }); |
|  |  |  |
|  |  | describe('redos', function () { |
|  |  | it('redos exploit', function () { |
|  |  | // Invalid. This should be discovered in under 1 second. |
|  |  | var attackString = 'a://localhost' + '9'.repeat(100000) + '\t'; |
|  |  | var before = process.hrtime(); |
|  |  | assert(!url(attackString), 'attackString was valid'); |
|  |  | var elapsed = process.hrtime(before); |
|  |  | assert(elapsed[0] < 1, 'attackString took ' + elapsed[0] + ' > 1 seconds'); |
|  |  | }); |
|  |  | }); |
|  |  | }); |

Toggle all file notes
Toggle all file annotations

### 1 comment on commit `1495509`

[![@cadente-nd](https://avatars.githubusercontent.com/u/3876200?s=80&v=4)](/cadente-nd)

Copy link

### @cadente-nd **[cadente-nd](/cadente-nd)** commented on `[1495509](/segmentio/is-url/commit/149550935c63a98c11f27f694a7c4a9479e53794)` [Mar 23, 2018](#commitcomment-28232744)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

This update cause an error in `isUrl` function if `string` is undefined.

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsegmentio%2Fis-url%2Fcommit%2F149550935c63a98c11f27f694a7c4a9479e53794) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_34364af1_20250124_131529.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsegmentio%2Fis-url%2Fpull%2F18)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsegmentio%2Fis-url%2Fpull%2F18)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=segmentio%2Fis-url)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[segmentio](/segmentio)
/
**[is-url](/segmentio/is-url)**
Public

* [Notifications](/login?return_to=%2Fsegmentio%2Fis-url) You must be signed in to change notification settings
* [Fork
  40](/login?return_to=%2Fsegmentio%2Fis-url)
* [Star
   166](/login?return_to=%2Fsegmentio%2Fis-url)

* [Code](/segmentio/is-url)
* [Issues
  9](/segmentio/is-url/issues)
* [Pull requests
  2](/segmentio/is-url/pulls)
* [Actions](/segmentio/is-url/actions)
* [Projects
  0](/segmentio/is-url/projects)
* [Security](/segmentio/is-url/security)
* [Insights](/segmentio/is-url/pulse)

Additional navigation options

* [Code](/segmentio/is-url)
* [Issues](/segmentio/is-url/issues)
* [Pull requests](/segmentio/is-url/pulls)
* [Actions](/segmentio/is-url/actions)
* [Projects](/segmentio/is-url/projects)
* [Security](/segmentio/is-url/security)
* [Insights](/segmentio/is-url/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fsegmentio%2Fis-url%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fsegmentio%2Fis-url%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# security: Fix REDOS vulnerability #18

 Merged

[zeke](/zeke)
merged 1 commit into
[segmentio:master](/segmentio/is-url/tree/master "segmentio/is-url:master")
from
[davisjam:FixREDOS](/davisjam/is-url/tree/FixREDOS "davisjam/is-url:FixREDOS")

Mar 20, 2018

 Merged

# [security: Fix REDOS vulnerability](#top) #18

[zeke](/zeke)
merged 1 commit into
[segmentio:master](/segmentio/is-url/tree/master "segmentio/is-url:master")
from
[davisjam:FixREDOS](/davisjam/is-url/tree/FixREDOS "davisjam/is-url:FixREDOS")

Mar 20, 2018

+34

−3

[Conversation
11](/segmentio/is-url/pull/18)
[Commits
1](/segmentio/is-url/pull/18/commits)
[Checks
0](/segmentio/is-url/pull/18/checks)
[Files changed
2](/segmentio/is-url/pull/18/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![davisjam](https://avatars.githubusercontent.com/u/22822319?s=60&v=4)](/davisjam)

Copy link

Contributor

### @davisjam **[davisjam](/davisjam)** commented [Mar 19, 2018](#issue-306636360)

Problem:

As disclosed by email, the regex in this module was vulnerable to

catastrophic backtracking.

This could be used as a REDOS vector for Node.js servers that use

this module.

Solution:

Use a two-step validation process.

Split the vulnerable regex into three safe ones.

Sorry, something went wrong.

All reactions

[![@davisjam](https://avatars.githubusercontent.com/u/22822319?s=40&v=4)](/davisjam)

`[security: Fix REDOS vulnerability](/segmentio/is-url/pull/18/commits/149550935c63a98c11f27f694a7c4a9479e53794 "security: Fix REDOS vulnerability

Problem:
As disclosed by email, the regex in this module was vulnerable to
catastrophic backtracking.
This could be used as a REDOS vector for Node.js servers that use
this module.

Solution:
Use a two-step validation process.
Split the vulnerable regex into three safe ones.")`
 …

`[1495509](/segmentio/is-url/pull/18/commits/149550935c63a98c11f27f694a7c4a9479e53794)`

```
Problem:
As disclosed by email, the regex in this module was vulnerable to
catastrophic backtracking.
This could be used as a REDOS vector for Node.js servers that use
this module.

Solution:
Use a two-step validation process.
Split the vulnerable regex into three safe ones.
```

[![@davisjam](https://avatars.githubusercontent.com/u/22822319?s=80&u=6a5cb8838c91ddc275aa6ed4a65a4e85077d91ca&v=4)](/davisjam)

Copy link

Contributor

Author

### **[davisjam](/davisjam)** commented [Mar 19, 2018](#issuecomment-374378399)

| Credit to [@josdejong](https://github.com/josdejong) for spotting this. |
| --- |

All reactions

Sorry, something went wrong.

[![@josdejong](https://avatars.githubusercontent.com/u/568626?s=80&u=0f46ef5804412b5d201bf835bd561c5ef12dfc26&v=4)](/josdejong)

Copy link

### **[josdejong](/josdejong)** commented [Mar 19, 2018](#issuecomment-374384023)

| 👍 |
| --- |

All reactions

Sorry, something went wrong.

[![@zeke](https://avatars.githubusercontent.com/u/2289?s=80&u=44388f54fc197913555d9672cf748aa6cba34bfd&v=4)](/zeke)

Copy link

Contributor

### **[zeke](/zeke)** commented [Mar 19, 2018](#issuecomment-374425798)

| From Travis:  Could not find .travis.yml, using standard configuration.  Default config is for a ruby project. I wonder how Travis ever worked on this repo... 🤔  This project is using a special combination of `make test` and an abandoned project called [component](https://ghub.io/component)... But if you just run `mocha`, all the tests are passing on this PR, so this change looks good to me.  To be on the safe side, I would recommend doing a major version bump to avoid breaking any existing users. However that means users won't get this security fix unless they explicitly upgrade to the new major.  We could `npm deprecate` all the older versions after publishing, so people would see a warning when they installed any pre 2.0.0 version. What do folks think of this?  cc [@ianstormtaylor](https://github.com/ianstormtaylor) |
| --- |

All reactions

Sorry, something went wrong.

[![@davisjam](https://avatars.githubusercontent.com/u/22822319?s=80&u=6a5cb8838c91ddc275aa6ed4a65a4e85077d91ca&v=4)](/davisjam)

Copy link

Contributor

Author

### **[davisjam](/davisjam)** commented [Mar 20, 2018](#issuecomment-374450900)

| I tested by running mocha by hand, yep. No regressions, and the REDOS test I added passes with my change and fails without it.  I don't think a semver-major bump is necessary. I believe my version accepts precisely the same language as the previous unsafe regex did, but I welcome a second pair of eyes on it.  This is what I did. I took the unsafe regex and broke it into two steps for clarity, then tested each of the two domain options separately. But I used what I think are semantically equivalent regexes. The localDomain is slightly modified so that it is safe.  On an unrelated note, given the popularity of this project, it might be nice to set up Travis and Mocha so they work properly. Are there issues open for that? |
| --- |

All reactions

Sorry, something went wrong.

[![@davisjam](https://avatars.githubusercontent.com/u/22822319?s=40&u=6a5cb8838c91ddc275aa6ed4a65a4e85077d91ca&v=4)](/davisjam)
[davisjam](/davisjam)
mentioned this pull request
[Mar 20, 2018](#ref-pullrequest-300196660)

[Expose matcher regex
#17](/segmentio/is-url/pull/17)
 Closed

[![@davisjam](https://avatars.githubusercontent.com/u/22822319?s=80&u=6a5cb8838c91ddc275aa6ed4a65a4e85077d91ca&v=4)](/davisjam)

Copy link

Contributor

Author

### **[davisjam](/davisjam)** commented [Mar 20, 2018](#issuecomment-374652613) • edited Loading

| This PR is publicizing the possibility of REDOS via this popular npm module. Should I take it down until the maintainers are ready to review it? |
| --- |

All reactions

Sorry, something went wrong.

[![jacktuck](https://avatars.githubusercontent.com/u/8209433?s=60&v=4)](/jacktuck)

**[jacktuck](/jacktuck)**
approved these changes
[Mar 20, 2018](#pullrequestreview-105443887)

 [View reviewed changes](/segmentio/is-url/pull/18/files/149550935c63a98c11f27f694a7c4a9479e53794)

Copy link

### @jacktuck **[jacktuck](/jacktuck)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM

Sorry, something went wrong.

All reactions

[![@zeke](https://avatars.githubusercontent.com/u/2289?s=80&u=44388f54fc197913555d9672cf748aa6cba34bfd&v=4)](/zeke)

Copy link

Contributor

### **[zeke](/zeke)** commented [Mar 20, 2018](#issuecomment-374729909)

| I believe my version accepts precisely the same language as the previous unsafe regex did  Yeah not worried about your changes here being a breaking change so much as wanting to avoid publishing a new version that's missing something indirectly like a browser-friendly build artifact or something. I say this because I think this module is not actively maintained any more. |
| --- |

All reactions

Sorry, something went wrong.

[![@zeke](https://avatars.githubusercontent.com/u/2289?s=80&u=44388f54fc197913555d9672cf748aa6cba34bfd&v=4)](/zeke)

Copy link

Contributor

### **[zeke](/zeke)** commented [Mar 20, 2018](#issuecomment-374730189)

| That said, I do have npm publish rights, so we could just say #yolo, publish it as a patch, and deal with any possible fallout after. |
| --- |

All reactions

Sorry, something went wrong.

[![@davisjam](https://avatars.githubusercontent.com/u/22822319?s=80&u=6a5cb8838c91ddc275aa6ed4a65a4e85077d91ca&v=4)](/davisjam)

Copy link

Contributor

Author

### **[davisjam](/davisjam)** commented [Mar 20, 2018](#issuecomment-374780115)

| publish it as a patch, and deal with any possible fallout after  Seems reasonable to me. If there aren't active maintainers who can tell us the details on publishing, the choices seem to be:   1. Deprecate package. 2. Patch with possible mistakes.   Since this is a popular package I think deprecating is not a good route. I vote #yolo.  On a related note, perhaps updating the README with a "looking for a maintainer" advertisement would be good. |
| --- |

All reactions

Sorry, something went wrong.

[![@zeke](https://avatars.githubusercontent.com/u/2289?s=40&u=44388f54fc197913555d9672cf748aa6cba34bfd&v=4)](/zeke)
[zeke](/zeke)
merged commit [`55ee8ee`](/segmentio/is-url/commit/55ee8ee9dcadccb82746288cd8c36958228a7b70)
into
segmentio:master

[Mar 20, 2018](https://github.com/segmentio/is-url/pull/18#event-1532198700)

[![@zeke](https://avatars.githubusercontent.com/u/2289?s=80&u=44388f54fc197913555d9672cf748aa6cba34bfd&v=4)](/zeke)

Copy link

Contributor

### **[zeke](/zeke)** commented [Mar 20, 2018](#issuecomment-374790661)

| ``` $ np patch --yolo   ✔ Prerequisite check  ✔ Git  ✔ Bumping version using npm  ✔ Publishing package  ✔ Pushing tags   is-url 1.2.3 published 🎉  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@zeke](https://avatars.githubusercontent.com/u/2289?s=80&u=44388f54fc197913555d9672cf748aa6cba34bfd&v=4)](/zeke)

Copy link

Contributor

### **[zeke](/zeke)** commented [Mar 20, 2018](#issuecomment-374790925)

| A perfect opportunity to use [np](https://ghub.io/np)'s `--yolo` flag. Thanks, [@sindresorhus](https://github.com/sindresorhus) 👍 |
| --- |

 👍
1
 davisjam reacted with thumbs up emoji
 😄
1
 jacktuck reacted with laugh emoji

All reactions

* 👍
  1 reaction
* 😄
  1 reaction

Sorry, something went wrong.

[![@dependabot-preview](https://avatars.githubusercontent.com/in/2141?s=40&v=4)](/apps/dependabot-preview)
[dependabot-preview](/apps/dependabot-preview)
bot
mentioned this pull request
[Mar 21, 2018](#ref-pullrequest-307125279)

[Bump is-url from 1.2.2 to 1.2.3
injms/yaled#2](/injms/yaled/pull/2)
 Merged

[davisjam](/davisjam)
added a commit
to davisjam/is-url
that referenced
this pull request
[Mar 24, 2018](#ref-commit-cc099f4)
[![@davisjam](https://avatars.githubusercontent.com/u/22822319?s=40&u=6a5cb8838c91ddc275aa6ed4a65a4e85077d91ca&v=4)](/davisjam)

`[handle undefined string](/davisjam/is-url/commit/cc099f46e54928717859151ed5a7bc7374f31175 "handle undefined string

Problem:
PR #18 changed behavior on:
- undefined string
- non-strings

Solution:
Revert to pre-#18 behavior on non-strings: return false.

Test:
I added test cases to clarify this behavior.
It shouldn't happen again.")`
…

`[cc099f4](/davisjam/is-url/commit/cc099f46e54928717859151ed5a7bc7374f31175)`

```
Problem:
PR [segmentio#18](https://github.com/segmentio/is-url/pull/18) changed behavior on:
- undefined string
- non-strings

Solution:
Revert to pre-[segmentio#18](https://github.com/segmentio/is-url/pull/18) behavior on non-strings: return false.

Test:
I added test cases to clarify this behavior.
It shouldn't happen again.
```

[davisjam](/davisjam)
added a commit
to davisjam/is-url
that referenced
this pull request
[Mar 24, 2018](#ref-commit-c32a7d3)
[![@davisjam](https://avatars.githubusercontent.com/u/22822319?s=40&u=6a5cb8838c91ddc275aa6ed4a65a4e85077d91ca&v=4)](/davisjam)

`[handle undefined string](/davisjam/is-url/commit/c32a7d3108e37bc6986fe4f9d8cf34ba79afae3a "handle undefined string

Problem:
As reported in #19, PR #18 changed behavior on:
- undefined string
- non-strings

Solution:
Revert to pre-#18 behavior on non-strings: return false.

Test:
I added test cases to clarify this behavior.
It shouldn't happen again.")`
…

`[c32a7d3](/davisjam/is-url/commit/c32a7d3108e37bc6986fe4f9d8cf34ba79afae3a)`

```
Problem:
As reported in [segmentio#19](https://github.com/segmentio/is-url/issues/19), PR [segmentio#18](https://github.com/segmentio/is-url/pull/18) changed behavior on:
- undefined string
- non-strings

Solution:
Revert to pre-[segmentio#18](https://github.com/segmentio/is-url/pull/18) behavior on non-strings: return false.

Test:
I added test cases to clarify this behavior.
It shouldn't happen again.
```

This was referenced Mar 24, 2018

[handle undefined string
#20](/segmentio/is-url/pull/20)
 Merged

[latest patch version (1.2.3) changes behavior if string is undefined
#19](/segmentio/is-url/issues/19)

Closed

[davisjam](/davisjam)
added a commit
to davisjam/is-url
that referenced
this pull request
[Mar 26, 2018](#ref-commit-b33cac4)
[![@davisjam](https://avatars.githubusercontent.com/u/22822319?s=40&u=6a5cb8838c91ddc275aa6ed4a65a4e85077d91ca&v=4)](/davisjam)

`[handle undefined string](/davisjam/is-url/commit/b33cac4deaed1bdab8dae7e2dedc2744df55331b "handle undefined string

Problem:
As reported in #19, PR #18 changed behavior on:
- undefined string
- non-strings

Solution:
Revert to pre-#18 behavior on non-strings: return false.

Test:
I added test cases to clarify this behavior.
It shouldn't happen again.")`
…

`[b33cac4](/davisjam/is-url/commit/b33cac4deaed1bdab8dae7e2dedc2744df55331b)`

```
Problem:
As reported in [segmentio#19](https://github.com/segmentio/is-url/issues/19), PR [segmentio#18](https://github.com/segmentio/is-url/pull/18) changed behavior on:
- undefined string
- non-strings

Solution:
Revert to pre-[segmentio#18](https://github.com/segmentio/is-url/pull/18) behavior on non-strings: return false.

Test:
I added test cases to clarify this behavior.
It shouldn't happen again.
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fsegmentio%2Fis-url%2Fpull%2F18)

Reviewers

[![@jacktuck](https://avatars.githubusercontent.com/u/8209433?s=40&v=4)](/jacktuck) [jacktuck](/jacktuck)

jacktuck approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

5 participants

[![@davisjam](https://avatars.githubusercontent.com/u/22822319?s=52&v=4)](/davisjam) [![@josdejong](https://avatars.githubusercontent.com/u/568626?s=52&v=4)](/josdejong) [![@zeke](https://avatars.githubusercontent.com/u/2289?s=52&v=4)](/zeke) [![@cadente-nd](https://avatars.githubusercontent.com/u/3876200?s=52&v=4)](/cadente-nd) [![@jacktuck](https://avatars.githubusercontent.com/u/8209433?s=52&v=4)](/jacktuck)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


