The provided content is a commit diff from a GitHub repository. The commit message is "Sanitize HTML to avoid XSS attacks", and the changes show the usage of the `bleach` library to sanitize HTML before rendering.

Here's a breakdown of the relevant information:

**Root cause of vulnerability:**

- The code was previously vulnerable to Cross-Site Scripting (XSS) attacks by rendering user-supplied HTML without sanitization.

**Weaknesses/vulnerabilities present:**

- **XSS Vulnerability:** Before the commit, the `render_description` function was vulnerable to XSS, because HTML content was not properly sanitized before rendering it to the user.

**Impact of exploitation:**

- An attacker could inject malicious scripts into the rendered HTML, potentially leading to:
    - Cookie theft
    - Session hijacking
    - Defacement of the web page
    - Other client-side attacks.

**Attack vectors:**

-  An attacker could inject malicious HTML code via text input field/parameter which then used by `render_description` function and rendered by the web application.

**Required attacker capabilities/position:**

-  The attacker needs to have the ability to input and save malicious HTML code that is later rendered by vulnerable web application.
- No specific position in the network or system is required.

**Technical Details:**

- The vulnerability was addressed by implementing sanitization using the `bleach` library. The `bleach.clean()` function is used to remove any potentially dangerous tags or attributes.
-  Specifically, the `bleach.clean()` function was configured to allow a whitelist of tags (`print_tags + ['a', 'cite', 'pre']`), attributes (`print_attrs`), and styles (`all_styles`). This allows a specific set of HTML elements and attributes while preventing any unexpected or malicious input being rendered.

**Code Snippet:**

```diff
--- a/yolapi/pypi/metadata.py
+++ b/yolapi/pypi/metadata.py
@@ -144,4 +146,7 @@
         else:
             html = format_html('<pre>{}</pre>', text)
 
+        html = bleach.clean(
+            html, print_tags + ['a', 'cite', 'pre'], print_attrs, all_styles)
+
         return mark_safe(html)
```