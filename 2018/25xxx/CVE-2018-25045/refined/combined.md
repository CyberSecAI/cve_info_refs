=== Content from github.com_08e07326_20250124_131931.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fencode%2Fdjango-rest-framework%2Fpull%2F6330)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fencode%2Fdjango-rest-framework%2Fpull%2F6330)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=encode%2Fdjango-rest-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[encode](/encode)
/
**[django-rest-framework](/encode/django-rest-framework)**
Public

* [Notifications](/login?return_to=%2Fencode%2Fdjango-rest-framework) You must be signed in to change notification settings
* [Fork
  6.9k](/login?return_to=%2Fencode%2Fdjango-rest-framework)
* [Star
   28.7k](/login?return_to=%2Fencode%2Fdjango-rest-framework)

* [Code](/encode/django-rest-framework)
* [Issues
  59](/encode/django-rest-framework/issues)
* [Pull requests
  46](/encode/django-rest-framework/pulls)
* [Discussions](/encode/django-rest-framework/discussions)
* [Actions](/encode/django-rest-framework/actions)
* [Security](/encode/django-rest-framework/security)
* [Insights](/encode/django-rest-framework/pulse)

Additional navigation options

* [Code](/encode/django-rest-framework)
* [Issues](/encode/django-rest-framework/issues)
* [Pull requests](/encode/django-rest-framework/pulls)
* [Discussions](/encode/django-rest-framework/discussions)
* [Actions](/encode/django-rest-framework/actions)
* [Security](/encode/django-rest-framework/security)
* [Insights](/encode/django-rest-framework/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fencode%2Fdjango-rest-framework%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fencode%2Fdjango-rest-framework%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix XSS caused by disabled autoescaping in the default DRF Browsable API view templates #6330

 Merged

[tomchristie](/tomchristie)
merged 3 commits into
[encode:master](/encode/django-rest-framework/tree/master "encode/django-rest-framework:master")
from
moneymeets:moneymeets/html-escaping

Jan 16, 2019

 Merged

# [Fix XSS caused by disabled autoescaping in the default DRF Browsable API view templates](#top) #6330

[tomchristie](/tomchristie)
merged 3 commits into
[encode:master](/encode/django-rest-framework/tree/master "encode/django-rest-framework:master")
from
moneymeets:moneymeets/html-escaping

Jan 16, 2019

[Conversation
6](/encode/django-rest-framework/pull/6330)
[Commits
3](/encode/django-rest-framework/pull/6330/commits)
[Checks
0](/encode/django-rest-framework/pull/6330/checks)
[Files changed](/encode/django-rest-framework/pull/6330/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![zyv](https://avatars.githubusercontent.com/u/607401?s=60&v=4)](/zyv)

Copy link

Contributor

### @zyv **[zyv](/zyv)** commented [Nov 21, 2018](#issue-383177878)

As requested in [#6191](https://github.com/encode/django-rest-framework/pull/6191).

Sorry, something went wrong.

 üëç
1
 sloria reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

[![@xordoquy](https://avatars.githubusercontent.com/u/2340654?s=40&v=4)](/xordoquy)
[xordoquy](/xordoquy)
added this to the [3.9.1 Release](/encode/django-rest-framework/milestone/70) milestone
[Nov 21, 2018](#event-1980421097)

[![@xordoquy](https://avatars.githubusercontent.com/u/2340654?s=40&v=4)](/xordoquy)
[xordoquy](/xordoquy)
added
the
[Bug](/encode/django-rest-framework/labels/Bug)
label
[Nov 21, 2018](#event-1980421621)

[![@rpkilby](https://avatars.githubusercontent.com/u/2370209?s=80&v=4)](/rpkilby)

Copy link

Member

### **[rpkilby](/rpkilby)** commented [Nov 21, 2018](#issuecomment-440763083)

| Thanks for adding the test case [@zyv](https://github.com/zyv). |
| --- |

All reactions

Sorry, something went wrong.

[![@zyv](https://avatars.githubusercontent.com/u/607401?s=40&u=611cb9d1f6461fd6c8020edbdb2eac9265dcdf4c&v=4)](/zyv)
[zyv](/zyv)
mentioned this pull request
[Dec 1, 2018](#ref-pullrequest-361026953)

[Problem: autoescape not getting passed to urlize\_quoted\_links filter
#6191](/encode/django-rest-framework/pull/6191)
 Merged

[![@rpkilby](https://avatars.githubusercontent.com/u/2370209?s=80&v=4)](/rpkilby)

Copy link

Member

### **[rpkilby](/rpkilby)** commented [Dec 10, 2018](#issuecomment-445938526)

| Hi [@zyv](https://github.com/zyv). I need to dig in to this more fully, but I'm not 100% that the test demonstrates the correct behavior. Basically, this test ensures that `urlize_quoted_links` escapes by default, ignoring the autoescape context, which conflicts with the intent of [#6191](https://github.com/encode/django-rest-framework/pull/6191). However, I'm inclined to agree w/ [#6191](https://github.com/encode/django-rest-framework/pull/6191) that `urlize_quoted_links` should obey the `autoescape` tag/context, and I think that the issues lie with the base template instead (i.e., the base template may need more selective auto escaping).  I think what we need instead are tests for the browsable API templates. By default, the browsable API *should* escape links once. And from there, we would then need to fix the templates and how/when it autoescapes.  Again, I'm not 100% on what the correct answer here is - I'd need to look at the base template and `urlize_quoted_links` more thoroughly. |
| --- |

All reactions

Sorry, something went wrong.

 [zyv](/zyv)
added 3 commits
[December 14, 2018 17:49](#commits-pushed-be68c52)

[![@zyv](https://avatars.githubusercontent.com/u/607401?s=40&v=4)](/zyv)

`[Add test that verifies that HTML is correctly escaped in Browsable AP‚Ä¶](/encode/django-rest-framework/pull/6330/commits/be68c524a23498548849e0d95bf4ae19a9d28ad8 "Add test that verifies that HTML is correctly escaped in Browsable API views")`
 ‚Ä¶

`[be68c52](/encode/django-rest-framework/pull/6330/commits/be68c524a23498548849e0d95bf4ae19a9d28ad8)`

```
‚Ä¶I views
```

[![@zyv](https://avatars.githubusercontent.com/u/607401?s=40&v=4)](/zyv)

`[Fix urlize_quoted_links tag to avoid double escaping in autoescape ‚Ä¶](/encode/django-rest-framework/pull/6330/commits/343ce4a03cad02631752a5e9bde26218fd647c14 "Fix `urlize_quoted_links` tag to avoid double escaping in autoescape mode")`
 ‚Ä¶

`[343ce4a](/encode/django-rest-framework/pull/6330/commits/343ce4a03cad02631752a5e9bde26218fd647c14)`

```
‚Ä¶mode
```

[![@zyv](https://avatars.githubusercontent.com/u/607401?s=40&v=4)](/zyv)

`[Fix XSS in default DRF Browsable API template by re-enabling autoescape](/encode/django-rest-framework/pull/6330/commits/75a489150ae24c2f3c794104a8e98fa43e2c9ce9 "Fix XSS in default DRF Browsable API template by re-enabling autoescape")`

`[75a4891](/encode/django-rest-framework/pull/6330/commits/75a489150ae24c2f3c794104a8e98fa43e2c9ce9)`

[![@zyv](https://avatars.githubusercontent.com/u/607401?s=80&u=611cb9d1f6461fd6c8020edbdb2eac9265dcdf4c&v=4)](/zyv)

Copy link

Contributor

Author

### **[zyv](/zyv)** commented [Dec 14, 2018](#issuecomment-447417841)

| Hi [@rpkilby](https://github.com/rpkilby), you are right that my test doesn't demonstrate the correct expected behaviour of `urlize_quoted_links`, my goal was to prove the point that PR [#6191](https://github.com/encode/django-rest-framework/pull/6191) introduced an XSS into the default DRF Browsable API templates, and I was hoping that the commit will get reverted and a new release will ensue quickly to fix this vulnerability, if a proper solution cannot be found on short notice due to limited maintainer capacity.  Anyways, I've now finally managed to find some time to look into it, and have fixed the test, as well as (hopefully) found a solution to the problem. I would appreciate if you could have a look at my new commits. A more detailed explanation of what/why they do follows:  I believe that the initial author of `urlize_quoted_links` made a mistake by not marking the resulting string as safe and faced the double quoting problem if autoescaping was enabled. To work around this issue, autoescaping was disabled in the templates. The "fix" in PR [#6191](https://github.com/encode/django-rest-framework/pull/6191) tipped the delicate balance of two mistakes compensating each other by making the function conform to Django API, which lead to HTML not being escaped at all in the default DRF templates.  I have changed the function to correctly mark final string as safe and also got rid of the crazy escaping logic, so that hopefully it is now clearer what the function does (and what it does not). |
| --- |

All reactions

Sorry, something went wrong.

[![@zyv](https://avatars.githubusercontent.com/u/607401?s=40&u=611cb9d1f6461fd6c8020edbdb2eac9265dcdf4c&v=4)](/zyv)
[zyv](/zyv)
changed the title
~~Add test that verifies that HTML is correctly escaped in Browsable API views~~
Fix XSS caused by disabled autoescaping in the default DRF Browsable API view templates
[Dec 14, 2018](#event-2027538509)

[![@rpkilby](https://avatars.githubusercontent.com/u/2370209?s=80&v=4)](/rpkilby)

Copy link

Member

### **[rpkilby](/rpkilby)** commented [Dec 14, 2018](#issuecomment-447418521)

| üëå nice.  I'll take a look at this over the weekend. I really appreciate the effort you put into this. |
| --- |

 üëç
1
 nevelis reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@carltongibson](https://avatars.githubusercontent.com/u/64686?s=80&v=4)](/carltongibson)

Copy link

Collaborator

### **[carltongibson](/carltongibson)** commented [Dec 14, 2018](#issuecomment-447437019)

| Thanks for the work [@zyv](https://github.com/zyv)! I will be preparing 3.9.1 next week. A fix here will be part of that. Your efforts are greatly appreciated. |
| --- |

 üëç
3
 remychvn, jerdna-regeiz, and TauPan reacted with thumbs up emoji

All reactions

* üëç
  3 reactions

Sorry, something went wrong.

[![@tomchristie](https://avatars.githubusercontent.com/u/647359?s=80&u=afcdb67ec485900d025d18270a115085e3f0f909&v=4)](/tomchristie)

Copy link

Member

### **[tomchristie](/tomchristie)** commented [Jan 16, 2019](#issuecomment-454763925)

| Looks correct to me, yup. |
| --- |

All reactions

Sorry, something went wrong.

[![@tomchristie](https://avatars.githubusercontent.com/u/647359?s=40&u=afcdb67ec485900d025d18270a115085e3f0f909&v=4)](/tomchristie)
[tomchristie](/tomchristie)
merged commit [`4bb9a3c`](/encode/django-rest-framework/commit/4bb9a3c48427867ef1e46f7dee945a4c25a4f9b8)
into
encode:master

[Jan 16, 2019](https://github.com/encode/django-rest-framework/pull/6330#event-2077279912)

[openstack-gerrit](/openstack-gerrit)
pushed a commit
to recordsansible/ara-server
that referenced
this pull request
[Jan 17, 2019](#ref-commit-47dc0ad)
[![@apollo13](https://avatars.githubusercontent.com/u/81547?s=40&u=cd23aa5d8f216e8776f57b0cec9b9afe7ec52190&v=4)](/apollo13)

`[Fixed XSS issue from DRF.](/recordsansible/ara-server/commit/47dc0ad989ac42263f995afa4dd4470633160775 "Fixed XSS issue from DRF.

Details in https://github.com/encode/django-rest-framework/issues/6330

Change-Id: Icea25569b92c3559029ae1c93712e746684187f1")`
‚Ä¶

`[47dc0ad](/recordsansible/ara-server/commit/47dc0ad989ac42263f995afa4dd4470633160775)`

```
Details in [encode/django-rest-framework#6330](https://github.com/encode/django-rest-framework/pull/6330)

Change-Id: Icea25569b92c3559029ae1c93712e746684187f1
```

[martey](/martey)
added a commit
to pydata/conf\_site
that referenced
this pull request
[May 25, 2019](#ref-commit-d41e177)
[![@martey](https://avatars.githubusercontent.com/u/49076?s=40&v=4)](/martey)

`[Upgrade djangorestframework to latest version.](/pydata/conf_site/commit/d41e17795ba0874290c51bf125ac165271a6b1c7 "Upgrade djangorestframework to latest version.

This resolves a XSS vulnerability
(https://github.com/encode/django-rest-framework/pull/6330).")`
‚Ä¶

`[d41e177](/pydata/conf_site/commit/d41e17795ba0874290c51bf125ac165271a6b1c7)`

```
This resolves a XSS vulnerability
([encode/django-rest-framework#6330](https://github.com/encode/django-rest-framework/pull/6330)).
```

[![@martey](https://avatars.githubusercontent.com/u/49076?s=40&v=4)](/martey)
[martey](/martey)
mentioned this pull request
[May 25, 2019](#ref-pullrequest-448492549)

[Upgrade djangorestframework to latest version.
pydata/conf\_site#352](/pydata/conf_site/pull/352)
 Merged

[![@mend-bolt-for-github](https://avatars.githubusercontent.com/in/16809?s=40&v=4)](/apps/mend-bolt-for-github)
[mend-bolt-for-github](/apps/mend-bolt-for-github)
bot
mentioned this pull request
[Jul 2, 2019](#ref-issue-463040562)

[WS-2019-0037 (Medium) detected in djangorestframework-3.0.0.tar.gz
attesch/swapi#19](/attesch/swapi/issues/19)

Open

This was referenced Dec 20, 2019

[WS-2019-0037 (Medium) detected in djangorestframework-3.8.2-py2.py3-none-any.whl - autoclosed
mpulsemobile/doccano#50](/mpulsemobile/doccano/issues/50)

Closed

[WS-2019-0037 (Medium) detected in djangorestframework-3.8.2-py2.py3-none-any.whl
mpulsemobile/doccano#51](/mpulsemobile/doccano/issues/51)

Open

[![@mend-bolt-for-github](https://avatars.githubusercontent.com/in/16809?s=40&v=4)](/apps/mend-bolt-for-github)
[mend-bolt-for-github](/apps/mend-bolt-for-github)
bot
mentioned this pull request
[Jan 17, 2020](#ref-issue-551190217)

[WS-2019-0037 (Medium) detected in djangorestframework-3.7.7-py2.py3-none-any.whl - autoclosed
drakeg/tickets#13](/drakeg/tickets/issues/13)

Closed

[pchiquet](/pchiquet)
pushed a commit
to pchiquet/django-rest-framework
that referenced
this pull request
[Nov 17, 2020](#ref-commit-4772a5f)
[![@zyv](https://avatars.githubusercontent.com/u/607401?s=40&u=611cb9d1f6461fd6c8020edbdb2eac9265dcdf4c&v=4)](/zyv)

`[Fix XSS caused by disabled autoescaping in the default DRF Browsable ‚Ä¶](/pchiquet/django-rest-framework/commit/4772a5f7c6a51199026ef3eba19268d63ef60bee "Fix XSS caused by disabled autoescaping in the default DRF Browsable API view templates (#6330)

* Add test that verifies that HTML is correctly escaped in Browsable API views

* Fix `urlize_quoted_links` tag to avoid double escaping in autoescape mode

* Fix XSS in default DRF Browsable API template by re-enabling autoescape")`
‚Ä¶

`[4772a5f](/pchiquet/django-rest-framework/commit/4772a5f7c6a51199026ef3eba19268d63ef60bee)`

```
‚Ä¶API view templates ([encode#6330](https://github.com/encode/django-rest-framework/pull/6330))

* Add test that verifies that HTML is correctly escaped in Browsable API views

* Fix `urlize_quoted_links` tag to avoid double escaping in autoescape mode

* Fix XSS in default DRF Browsable API template by re-enabling autoescape
```

[![@mend-bolt-for-github](https://avatars.githubusercontent.com/in/16809?s=40&v=4)](/apps/mend-bolt-for-github)
[mend-bolt-for-github](/apps/mend-bolt-for-github)
bot
mentioned this pull request
[Apr 21, 2024](#ref-issue-2255269059)

[WS-2019-0037 (Medium) detected in djangorestframework-3.0.0.tar.gz
attesch/swapi#154](/attesch/swapi/issues/154)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fencode%2Fdjango-rest-framework%2Fpull%2F6330)

Reviewers

No reviews

Assignees

No one assigned

Labels

[Bug](/encode/django-rest-framework/labels/Bug)

Projects

None yet

Milestone

 [**3.9.1 Release**](/encode/django-rest-framework/milestone/70 "3.9.1 Release")

Development

Successfully merging this pull request may close these issues.

5 participants

[![@zyv](https://avatars.githubusercontent.com/u/607401?s=52&v=4)](/zyv) [![@rpkilby](https://avatars.githubusercontent.com/u/2370209?s=52&v=4)](/rpkilby) [![@carltongibson](https://avatars.githubusercontent.com/u/64686?s=52&v=4)](/carltongibson) [![@tomchristie](https://avatars.githubusercontent.com/u/647359?s=52&v=4)](/tomchristie) [![@xordoquy](https://avatars.githubusercontent.com/u/2340654?s=52&v=4)](/xordoquy)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_07d76e8e_20250124_131929.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fencode%2Fdjango-rest-framework%2Fpull%2F6191)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fencode%2Fdjango-rest-framework%2Fpull%2F6191)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=encode%2Fdjango-rest-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[encode](/encode)
/
**[django-rest-framework](/encode/django-rest-framework)**
Public

* [Notifications](/login?return_to=%2Fencode%2Fdjango-rest-framework) You must be signed in to change notification settings
* [Fork
  6.9k](/login?return_to=%2Fencode%2Fdjango-rest-framework)
* [Star
   28.7k](/login?return_to=%2Fencode%2Fdjango-rest-framework)

* [Code](/encode/django-rest-framework)
* [Issues
  59](/encode/django-rest-framework/issues)
* [Pull requests
  46](/encode/django-rest-framework/pulls)
* [Discussions](/encode/django-rest-framework/discussions)
* [Actions](/encode/django-rest-framework/actions)
* [Security](/encode/django-rest-framework/security)
* [Insights](/encode/django-rest-framework/pulse)

Additional navigation options

* [Code](/encode/django-rest-framework)
* [Issues](/encode/django-rest-framework/issues)
* [Pull requests](/encode/django-rest-framework/pulls)
* [Discussions](/encode/django-rest-framework/discussions)
* [Actions](/encode/django-rest-framework/actions)
* [Security](/encode/django-rest-framework/security)
* [Insights](/encode/django-rest-framework/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fencode%2Fdjango-rest-framework%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fencode%2Fdjango-rest-framework%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Problem: autoescape not getting passed to urlize\_quoted\_links filter #6191

 Merged

[carltongibson](/carltongibson)
merged 1 commit into
[encode:master](/encode/django-rest-framework/tree/master "encode/django-rest-framework:master")
from
[dkliban:fix\_urlize\_quoted\_links](/dkliban/django-rest-framework/tree/fix_urlize_quoted_links "dkliban/django-rest-framework:fix_urlize_quoted_links")

Oct 10, 2018

 Merged

# [Problem: autoescape not getting passed to urlize\_quoted\_links filter](#top) #6191

[carltongibson](/carltongibson)
merged 1 commit into
[encode:master](/encode/django-rest-framework/tree/master "encode/django-rest-framework:master")
from
[dkliban:fix\_urlize\_quoted\_links](/dkliban/django-rest-framework/tree/fix_urlize_quoted_links "dkliban/django-rest-framework:fix_urlize_quoted_links")

Oct 10, 2018

[Conversation
15](/encode/django-rest-framework/pull/6191)
[Commits
1](/encode/django-rest-framework/pull/6191/commits)
[Checks
0](/encode/django-rest-framework/pull/6191/checks)
[Files changed](/encode/django-rest-framework/pull/6191/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![dkliban](https://avatars.githubusercontent.com/u/294339?s=60&v=4)](/dkliban)

Copy link

Contributor

### @dkliban **[dkliban](/dkliban)** commented [Sep 17, 2018](#issue-361026953) ‚Ä¢ edited Loading

Solution: set needs\_autoescape=True when registering the filter

Without this patch, the disabling autoescape in the template does not work.

refs [#6201](https://github.com/encode/django-rest-framework/issues/6201)

Sorry, something went wrong.

All reactions

[![@dkliban](https://avatars.githubusercontent.com/u/294339?s=40&v=4)](/dkliban)
[dkliban](/dkliban)
mentioned this pull request
[Sep 21, 2018](#ref-issue-362674627)

[urlize\_quoted\_links filter is not registered correctly
#6201](/encode/django-rest-framework/issues/6201)

Closed

[![@carltongibson](https://avatars.githubusercontent.com/u/64686?s=80&v=4)](/carltongibson)

Copy link

Collaborator

### **[carltongibson](/carltongibson)** commented [Oct 2, 2018](#issuecomment-426163594)

| Hi [@dkliban](https://github.com/dkliban). Can you please add a failing test case (with your example from [#6201](https://github.com/encode/django-rest-framework/issues/6201)) to go with this change? Thanks. |
| --- |

All reactions

Sorry, something went wrong.

[![@dkliban](https://avatars.githubusercontent.com/u/294339?s=40&v=4)](/dkliban)

`[Problem: autoescape not getting passed to urlize_quoted_links filter](/encode/django-rest-framework/pull/6191/commits/3205d8ecbe4521b6472a7b38ca70a338704e748b "Problem: autoescape not getting passed to urlize_quoted_links filter

Solution: set needs_autoescape=True when registering the filter

Without this patch, the disabling autoescape in the template does not work.")`
 ‚Ä¶

`[3205d8e](/encode/django-rest-framework/pull/6191/commits/3205d8ecbe4521b6472a7b38ca70a338704e748b)`

```
Solution: set needs_autoescape=True when registering the filter

Without this patch, the disabling autoescape in the template does not work.
```

 [![@dkliban](https://avatars.githubusercontent.com/u/294339?s=40&v=4)](/dkliban)
[dkliban](/dkliban)
[force-pushed](/encode/django-rest-framework/compare/aaeea76f5c94d8f9a2562da61173ac0b8fdf71e9..3205d8ecbe4521b6472a7b38ca70a338704e748b)
the
fix\_urlize\_quoted\_links

branch
from
[`aaeea76`](/encode/django-rest-framework/commit/aaeea76f5c94d8f9a2562da61173ac0b8fdf71e9) to
[`3205d8e`](/encode/django-rest-framework/commit/3205d8ecbe4521b6472a7b38ca70a338704e748b)  [Compare](/encode/django-rest-framework/compare/aaeea76f5c94d8f9a2562da61173ac0b8fdf71e9..3205d8ecbe4521b6472a7b38ca70a338704e748b)
[October 2, 2018 18:26](#event-1880089278)

[![@dkliban](https://avatars.githubusercontent.com/u/294339?s=80&v=4)](/dkliban)

Copy link

Contributor

Author

### **[dkliban](/dkliban)** commented [Oct 2, 2018](#issuecomment-426383913)

| [@carltongibson](https://github.com/carltongibson) I've added a test. It fails when I remove my patch and passes with it. Can you think of a better name for the test? |
| --- |

All reactions

Sorry, something went wrong.

[![@encode](https://avatars.githubusercontent.com/u/19159390?s=40&v=4)](/encode)
[encode](/encode)
deleted a comment from
[codecov-io](/codecov-io)
[Oct 3, 2018](#event-1881602325)

[![@rpkilby](https://avatars.githubusercontent.com/u/2370209?s=40&v=4)](/rpkilby)
[rpkilby](/rpkilby)
added this to the [3.9 Release](/encode/django-rest-framework/milestone/66) milestone
[Oct 3, 2018](#event-1882840947)

[![rpkilby](https://avatars.githubusercontent.com/u/2370209?s=60&v=4)](/rpkilby)

**[rpkilby](/rpkilby)**
approved these changes
[Oct 3, 2018](#pullrequestreview-161329115)

 [View reviewed changes](/encode/django-rest-framework/pull/6191/files/3205d8ecbe4521b6472a7b38ca70a338704e748b)

Copy link

Member

### @rpkilby **[rpkilby](/rpkilby)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks [@dkliban](https://github.com/dkliban). Confirmed on my end that the test does fail without the fix.

Sorry, something went wrong.

All reactions

[![carltongibson](https://avatars.githubusercontent.com/u/64686?s=60&v=4)](/carltongibson)

**[carltongibson](/carltongibson)**
approved these changes
[Oct 10, 2018](#pullrequestreview-163240062)

 [View reviewed changes](/encode/django-rest-framework/pull/6191/files/3205d8ecbe4521b6472a7b38ca70a338704e748b)

Copy link

Collaborator

### @carltongibson **[carltongibson](/carltongibson)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Yep. Super. Thanks!

Sorry, something went wrong.

All reactions

[![@carltongibson](https://avatars.githubusercontent.com/u/64686?s=40&v=4)](/carltongibson)
[carltongibson](/carltongibson)
merged commit [`dd19a44`](/encode/django-rest-framework/commit/dd19a44583e30bdb325da23583f2a934399155e1)
into
encode:master

[Oct 10, 2018](https://github.com/encode/django-rest-framework/pull/6191#event-1894851889)

[![@zyv](https://avatars.githubusercontent.com/u/607401?s=80&u=611cb9d1f6461fd6c8020edbdb2eac9265dcdf4c&v=4)](/zyv)

Copy link

Contributor

### **[zyv](/zyv)** commented [Nov 21, 2018](#issuecomment-440687856)

| [@dkliban](https://github.com/dkliban) unfortunately, after your fix the browsable API became unusable if the response contains HTML, because it is now unescaped, as autoescape is off in `base.html`, but if autoescape is turned on in the template, then the content is escaped twice - first in the function, and then outside.  ``` class TestViewSet(GenericViewSet):     def list(self, request):         return Response({"a": "<h1>badmarker</h1> - https://www.google.com"})  ```  is now rendered like this (wrong)  ``` {     "a": "<h1>badmarker</h1> - <a href="https://www.google.com" rel="nofollow">https://www.google.com</a>" }  ```  instead of this (right)  ``` {     &quot;a&quot;: &quot;&lt;h1&gt;badmarker&lt;/h1&gt; - <a href="https://www.google.com" rel="nofollow">https://www.google.com</a>&quot; }  ```  I don't quite understand from your test, what was your motivation to change this function to respect autoescape behaviour? As the other test shows, before your change it was working correctly with browsable API...  /cc [@carltongibson](https://github.com/carltongibson) |
| --- |

 üëç
1
 sloria reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@carltongibson](https://avatars.githubusercontent.com/u/64686?s=80&v=4)](/carltongibson)

Copy link

Collaborator

### **[carltongibson](/carltongibson)** commented [Nov 21, 2018](#issuecomment-440703567)

| [@zyv](https://github.com/zyv) can you open a PR adding your test case? It may be we need to revert this, but let‚Äôs have a look at it. |
| --- |

All reactions

Sorry, something went wrong.

[![@dkliban](https://avatars.githubusercontent.com/u/294339?s=80&v=4)](/dkliban)

Copy link

Contributor

Author

### **[dkliban](/dkliban)** commented [Nov 21, 2018](#issuecomment-440709782)

| [@zyv](https://github.com/zyv) I added the patch because the filter was not adhering to the API. In my code[0] the filter is chained with other filters. The filter that processed the string after 'urlize\_quoted\_urls' was receiving data that was escaped when autoescape was supposed to be disabled.  [0] <https://github.com/pulp/pulp/blob/master/pulpcore/pulpcore/app/templates/rest_framework/api.html#L176> |
| --- |

All reactions

Sorry, something went wrong.

[![@xordoquy](https://avatars.githubusercontent.com/u/2340654?s=80&v=4)](/xordoquy)

Copy link

Collaborator

### **[xordoquy](/xordoquy)** commented [Nov 21, 2018](#issuecomment-440711082)

| [@dkliban](https://github.com/dkliban) thanks for the feedback. This fix may only highlight another issue. We'll have a closer look at it with a failing test case. |
| --- |

All reactions

Sorry, something went wrong.

[![@zyv](https://avatars.githubusercontent.com/u/607401?s=40&u=611cb9d1f6461fd6c8020edbdb2eac9265dcdf4c&v=4)](/zyv)
[zyv](/zyv)
mentioned this pull request
[Nov 21, 2018](#ref-pullrequest-383177878)

[Fix XSS caused by disabled autoescaping in the default DRF Browsable API view templates
#6330](/encode/django-rest-framework/pull/6330)
 Merged

[![@zyv](https://avatars.githubusercontent.com/u/607401?s=80&u=611cb9d1f6461fd6c8020edbdb2eac9265dcdf4c&v=4)](/zyv)

Copy link

Contributor

### **[zyv](/zyv)** commented [Nov 21, 2018](#issuecomment-440713098)

| [@dkliban](https://github.com/dkliban) thank you for the explanation! I currently believe that you were misled by the parameter name and it was never supposed to adhere to the API in the first place, it's just that the parameter name is confusing, but that's only my working theory. I will hopefully have a look into your case as time permits.  [@carltongibson](https://github.com/carltongibson) thanks for chiming in, I have opened a new PR with a test that demonstrates the issue. |
| --- |

All reactions

Sorry, something went wrong.

[![@sloria](https://avatars.githubusercontent.com/u/2379650?s=40&u=23c31d00581a9a82aba3862ab6b564522937d087&v=4)](/sloria)
[sloria](/sloria)
mentioned this pull request
[Nov 29, 2018](#ref-pullrequest-385876683)

[Downgrade DRF to 3.8.2
CenterForOpenScience/osf.io#8829](/CenterForOpenScience/osf.io/pull/8829)
 Merged

[![@sloria](https://avatars.githubusercontent.com/u/2379650?s=80&u=23c31d00581a9a82aba3862ab6b564522937d087&v=4)](/sloria)

Copy link

Contributor

### **[sloria](/sloria)** commented [Nov 29, 2018](#issuecomment-442952625)

| We ran into the issue [@zyv](https://github.com/zyv) described above (HTML getting rendered in the browseable API) and have to downgrade to 3.8.2. Perhaps this change should get reverted for now, until a proper fix for the OP is found. |
| --- |

All reactions

Sorry, something went wrong.

[![@zyv](https://avatars.githubusercontent.com/u/607401?s=80&u=611cb9d1f6461fd6c8020edbdb2eac9265dcdf4c&v=4)](/zyv)

Copy link

Contributor

### **[zyv](/zyv)** commented [Dec 1, 2018](#issuecomment-443462534)

| I'm a bit worried that there haven't been any visible progress on [#6330](https://github.com/encode/django-rest-framework/pull/6330) so far, given that it's a gaping XSS hole for anyone using Browsable API and returning user-entered data as a part of the response.  I second the opinion of [@sloria](https://github.com/sloria), that maybe if a proper fix has proved to be challenging, it would be great to merge [#6330](https://github.com/encode/django-rest-framework/pull/6330), revert [#6191](https://github.com/encode/django-rest-framework/pull/6191) and make a 3.9.1 bugfix release... Thanks! |
| --- |

All reactions

Sorry, something went wrong.

[![@carltongibson](https://avatars.githubusercontent.com/u/64686?s=80&v=4)](/carltongibson)

Copy link

Collaborator

### **[carltongibson](/carltongibson)** commented [Dec 2, 2018](#issuecomment-443488679)

| Thanks for your concern [@zyv](https://github.com/zyv). The issue is just time to examine it properly rather than it looking particularly difficult. Reverting is one option, but we need to make sure that‚Äôs the correct option before just rushing on. And that needs capacity, which can take a while in an open source project.  You‚Äôre welcome to take it on yourself if you like.  Or, if you‚Äôre in a desperate rush, you can momentarily fork and revert, and then deploy your fork, using Pip‚Äôs excellent VCS support.  Failing either of those, we‚Äôll get to it. |
| --- |

All reactions

Sorry, something went wrong.

[![@zyv](https://avatars.githubusercontent.com/u/607401?s=80&u=611cb9d1f6461fd6c8020edbdb2eac9265dcdf4c&v=4)](/zyv)

Copy link

Contributor

### **[zyv](/zyv)** commented [Dec 10, 2018](#issuecomment-445911729)

| Alright, since we've already started migration to 3.9.x, and the only thing holding us back is this XSS issue, I've decided to follow [@carltongibson](https://github.com/carltongibson) suggestion and made a custom unofficial DRF 3.9.0.post1 release with this commit reverted.  If anyone is interested, the pre-built wheel that we'll be using is available at <https://moneymeets.github.io/django/djangorestframework/> and the corresponding source at <https://github.com/moneymeets/django-rest-framework/tree/moneymeets/3.9.0.post1> , but, of course, keep in mind that I'm just a random guy on the Internet, this is no official DRF release and if something goes awry you keep the pieces... |
| --- |

All reactions

Sorry, something went wrong.

[![@rpkilby](https://avatars.githubusercontent.com/u/2370209?s=80&v=4)](/rpkilby)

Copy link

Member

### **[rpkilby](/rpkilby)** commented [Dec 10, 2018](#issuecomment-445938841)

| Ach - sorry for the long response time. I had started writing something out but then got distracted.  I've replied to the PR with some thoughts. |
| --- |

All reactions

Sorry, something went wrong.

[![@zyv](https://avatars.githubusercontent.com/u/607401?s=80&u=611cb9d1f6461fd6c8020edbdb2eac9265dcdf4c&v=4)](/zyv)

Copy link

Contributor

### **[zyv](/zyv)** commented [Dec 14, 2018](#issuecomment-447418577)

| I think I've found a correct solution to the problem in [#6330](https://github.com/encode/django-rest-framework/pull/6330) and I would appreciate your feedback [@sloria](https://github.com/sloria) [@dkliban](https://github.com/dkliban) . |
| --- |

 üëç
1
 rpkilby reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[pchiquet](/pchiquet)
pushed a commit
to pchiquet/django-rest-framework
that referenced
this pull request
[Nov 17, 2020](#ref-commit-5650ef8)
[![@dkliban](https://avatars.githubusercontent.com/u/294339?s=40&v=4)](/dkliban)

`[Problem: autoescape not getting passed to urlize_quoted_links filter (](/pchiquet/django-rest-framework/commit/5650ef870173a7587152b13f6e4b3741439dd7c6 "Problem: autoescape not getting passed to urlize_quoted_links filter (#6191)

Solution: set needs_autoescape=True when registering the filter

Without this patch, the disabling autoescape in the template does not work.")[e‚Ä¶](https://github.com/encode/django-rest-framework/pull/6191)`
‚Ä¶

`[5650ef8](/pchiquet/django-rest-framework/commit/5650ef870173a7587152b13f6e4b3741439dd7c6)`

```
[‚Ä¶ncode#6191](https://github.com/encode/django-rest-framework/pull/6191))

Solution: set needs_autoescape=True when registering the filter

Without this patch, the disabling autoescape in the template does not work.
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fencode%2Fdjango-rest-framework%2Fpull%2F6191)

Reviewers

[![@rpkilby](https://avatars.githubusercontent.com/u/2370209?s=40&v=4)](/rpkilby) [rpkilby](/rpkilby)

rpkilby approved these changes

[![@carltongibson](https://avatars.githubusercontent.com/u/64686?s=40&v=4)](/carltongibson) [carltongibson](/carltongibson)

carltongibson approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

 [**3.9.0 Release**](/encode/django-rest-framework/milestone/66 "3.9.0 Release")

Development

Successfully merging this pull request may close these issues.

6 participants

[![@dkliban](https://avatars.githubusercontent.com/u/294339?s=52&v=4)](/dkliban) [![@carltongibson](https://avatars.githubusercontent.com/u/64686?s=52&v=4)](/carltongibson) [![@zyv](https://avatars.githubusercontent.com/u/607401?s=52&v=4)](/zyv) [![@xordoquy](https://avatars.githubusercontent.com/u/2340654?s=52&v=4)](/xordoquy) [![@sloria](https://avatars.githubusercontent.com/u/2379650?s=52&v=4)](/sloria) [![@rpkilby](https://avatars.githubusercontent.com/u/2370209?s=52&v=4)](/rpkilby)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_a01daa35_20250124_131928.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fencode%2Fdjango-rest-framework%2Fcommit%2F4bb9a3c48427867ef1e46f7dee945a4c25a4f9b8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fencode%2Fdjango-rest-framework%2Fcommit%2F4bb9a3c48427867ef1e46f7dee945a4c25a4f9b8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=encode%2Fdjango-rest-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[encode](/encode)
/
**[django-rest-framework](/encode/django-rest-framework)**
Public

* [Notifications](/login?return_to=%2Fencode%2Fdjango-rest-framework) You must be signed in to change notification settings
* [Fork
  6.9k](/login?return_to=%2Fencode%2Fdjango-rest-framework)
* [Star
   28.7k](/login?return_to=%2Fencode%2Fdjango-rest-framework)

* [Code](/encode/django-rest-framework)
* [Issues
  59](/encode/django-rest-framework/issues)
* [Pull requests
  46](/encode/django-rest-framework/pulls)
* [Discussions](/encode/django-rest-framework/discussions)
* [Actions](/encode/django-rest-framework/actions)
* [Security](/encode/django-rest-framework/security)
* [Insights](/encode/django-rest-framework/pulse)

Additional navigation options

* [Code](/encode/django-rest-framework)
* [Issues](/encode/django-rest-framework/issues)
* [Pull requests](/encode/django-rest-framework/pulls)
* [Discussions](/encode/django-rest-framework/discussions)
* [Actions](/encode/django-rest-framework/actions)
* [Security](/encode/django-rest-framework/security)
* [Insights](/encode/django-rest-framework/pulse)

## Commit

[Permalink](/encode/django-rest-framework/commit/4bb9a3c48427867ef1e46f7dee945a4c25a4f9b8)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix XSS caused by disabled autoescaping in the default DRF Browsable ‚Ä¶

[Browse files](/encode/django-rest-framework/tree/4bb9a3c48427867ef1e46f7dee945a4c25a4f9b8)
Browse the repository at this point in the history

```
‚Ä¶API view templates ([#6330](https://github.com/encode/django-rest-framework/pull/6330))

* Add test that verifies that HTML is correctly escaped in Browsable API views

* Fix `urlize_quoted_links` tag to avoid double escaping in autoescape mode

* Fix XSS in default DRF Browsable API template by re-enabling autoescape
```

* Loading branch information

[![@zyv](https://avatars.githubusercontent.com/u/607401?s=40&v=4)](/zyv) [![@tomchristie](https://avatars.githubusercontent.com/u/647359?s=40&v=4)](/tomchristie)

[zyv](/encode/django-rest-framework/commits?author=zyv "View all commits by zyv")
authored and
[tomchristie](/encode/django-rest-framework/commits?author=tomchristie "View all commits by tomchristie")
committed
Jan 16, 2019

1 parent
[e3bd4b9](/encode/django-rest-framework/commit/e3bd4b90488bab756694ce271a9615460783f987)

commit 4bb9a3c

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**26 additions**
and
**17 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* rest\_framework

  + templates/rest\_framework

    - rest\_framework/templates/rest\_framework/base.html
      [base.html](#diff-13db0ee8da068801e9f73008394228e805c8f55d7398a31f4cd91f816cccd6c8)
  + templatetags

    - rest\_framework/templatetags/rest\_framework.py
      [rest\_framework.py](#diff-2eb437866f69699c30734f44fdc3552c3fa4f48b7da83fa31ef378cb96bc8849)
* tests

  + tests/test\_templatetags.py
    [test\_templatetags.py](#diff-adcf9fe4cc76d2f1a251e2ebda2d83aeb360d03c02a24b781d996d7d082aa631)

## There are no files selected for viewing

4 changes: 2 additions & 2 deletions

4
[rest\_framework/templates/rest\_framework/base.html](#diff-13db0ee8da068801e9f73008394228e805c8f55d7398a31f4cd91f816cccd6c8 "rest_framework/templates/rest_framework/base.html")

Show comments

[View file](/encode/django-rest-framework/blob/4bb9a3c48427867ef1e46f7dee945a4c25a4f9b8/rest_framework/templates/rest_framework/base.html)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -171,10 +171,10 @@ <h1>{{ name }}</h1> |
|  |  | </div> |
|  |  |  |
|  |  | <div class="response-info" aria-label="{% trans "response info" %}"> |
|  |  | <pre class="prettyprint"><span class="meta nocode"><b>HTTP {{ response.status\_code }} {{ response.status\_text }}</b>{% autoescape off %}{% for key, val in response\_headers|items %} |
|  |  | <pre class="prettyprint"><span class="meta nocode"><b>HTTP {{ response.status\_code }} {{ response.status\_text }}</b>{% for key, val in response\_headers|items %} |
|  |  | <b>{{ key }}:</b> <span class="lit">{{ val|break\_long\_headers|urlize\_quoted\_links }}</span>{% endfor %} |
|  |  |  |
|  |  | </span>{{ content|urlize\_quoted\_links }}</pre>{% endautoescape %} |
|  |  | </span>{{ content|urlize\_quoted\_links }}</pre> |
|  |  | </div> |
|  |  | </div> |
|  |  |  |
| Expand Down | |  |

26 changes: 13 additions & 13 deletions

26
[rest\_framework/templatetags/rest\_framework.py](#diff-2eb437866f69699c30734f44fdc3552c3fa4f48b7da83fa31ef378cb96bc8849 "rest_framework/templatetags/rest_framework.py")

Show comments

[View file](/encode/django-rest-framework/blob/4bb9a3c48427867ef1e46f7dee945a4c25a4f9b8/rest_framework/templatetags/rest_framework.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -336,6 +336,12 @@ def trim\_url(x, limit=trim\_url\_limit): |
|  |  | return limit is not None and (len(x) > limit and ('%s...' % x[:max(0, limit - 3)])) or x |
|  |  |  |
|  |  | safe\_input = isinstance(text, SafeData) |
|  |  |  |
|  |  | # Unfortunately, Django built-in cannot be used here, because escaping |
|  |  | # is to be performed on words, which have been forcibly coerced to text |
|  |  | def conditional\_escape(text): |
|  |  | return escape(text) if autoescape and not safe\_input else text |
|  |  |  |
|  |  | words = word\_split\_re.split(force\_text(text)) |
|  |  | for i, word in enumerate(words): |
|  |  | if '.' in word or '@' in word or ':' in word: |
| Expand Down  Expand Up | | @@ -376,21 +382,15 @@ def trim\_url(x, limit=trim\_url\_limit): |
|  |  | # Make link. |
|  |  | if url: |
|  |  | trimmed = trim\_url(middle) |
|  |  | if autoescape and not safe\_input: |
|  |  | lead, trail = escape(lead), escape(trail) |
|  |  | url, trimmed = escape(url), escape(trimmed) |
|  |  | lead, trail = conditional\_escape(lead), conditional\_escape(trail) |
|  |  | url, trimmed = conditional\_escape(url), conditional\_escape(trimmed) |
|  |  | middle = '<a href="%s"%s>%s</a>' % (url, nofollow\_attr, trimmed) |
|  |  | words[i] = mark\_safe('%s%s%s' % (lead, middle, trail)) |
|  |  | words[i] = '%s%s%s' % (lead, middle, trail) |
|  |  | else: |
|  |  | if safe\_input: |
|  |  | words[i] = mark\_safe(word) |
|  |  | elif autoescape: |
|  |  | words[i] = escape(word) |
|  |  | elif safe\_input: |
|  |  | words[i] = mark\_safe(word) |
|  |  | elif autoescape: |
|  |  | words[i] = escape(word) |
|  |  | return ''.join(words) |
|  |  | words[i] = conditional\_escape(word) |
|  |  | else: |
|  |  | words[i] = conditional\_escape(word) |
|  |  | return mark\_safe(''.join(words)) |
|  |  |  |
|  |  |  |
|  |  | @register.filter |
| Expand Down | |  |

13 changes: 11 additions & 2 deletions

13
[tests/test\_templatetags.py](#diff-adcf9fe4cc76d2f1a251e2ebda2d83aeb360d03c02a24b781d996d7d082aa631 "tests/test_templatetags.py")

Show comments

[View file](/encode/django-rest-framework/blob/4bb9a3c48427867ef1e46f7dee945a4c25a4f9b8/tests/test_templatetags.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -305,15 +305,24 @@ def test\_json\_with\_url(self): |
|  |  | '&quot;foo\_set&quot;: [\n &quot;<a href="http://api/foos/1/">http://api/foos/1/</a>&quot;\n], ' |
|  |  | self.\_urlize\_dict\_check(data) |
|  |  |  |
|  |  | def test\_template\_render\_with\_autoescape(self): |
|  |  | """ |
|  |  | Test that HTML is correctly escaped in Browsable API views. |
|  |  | """ |
|  |  | template = Template("{% load rest\_framework %}{{ content|urlize\_quoted\_links }}") |
|  |  | rendered = template.render(Context({'content': '<script>alert()</script> http://example.com'})) |
|  |  | assert rendered == '&lt;script&gt;alert()&lt;/script&gt;' \ |
|  |  | ' <a href="http://example.com" rel="nofollow">http://example.com</a>' |
|  |  |  |
|  |  | def test\_template\_render\_with\_noautoescape(self): |
|  |  | """ |
|  |  | Test if the autoescape value is getting passed to urlize\_quoted\_links filter. |
|  |  | """ |
|  |  | template = Template("{% load rest\_framework %}" |
|  |  | "{% autoescape off %}{{ content|urlize\_quoted\_links }}" |
|  |  | "{% endautoescape %}") |
|  |  | rendered = template.render(Context({'content': '"http://example.com"'})) |
|  |  | assert rendered == '"<a href="http://example.com" rel="nofollow">http://example.com</a>"' |
|  |  | rendered = template.render(Context({'content': '<b> "http://example.com" </b>'})) |
|  |  | assert rendered == '<b> "<a href="http://example.com" rel="nofollow">http://example.com</a>" </b>' |
|  |  |  |
|  |  |  |
|  |  | @unittest.skipUnless(coreapi, 'coreapi is not installed') |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `4bb9a3c`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fencode%2Fdjango-rest-framework%2Fcommit%2F4bb9a3c48427867ef1e46f7dee945a4c25a4f9b8) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


