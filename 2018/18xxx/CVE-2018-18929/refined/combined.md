=== Content from www.drewgreen.net_d3424166_20250125_141300.html ===

[Skip to content](#content "Skip to content")
[Drew Green](https://www.drewgreen.net/)

Pentester/Security Researcher/IT Pro | @agreenbhm

* [Home](https://www.drewgreen.net/)
* [About](https://www.drewgreen.net/about-2/)
* [Contact](https://www.drewgreen.net/contact/)

[Drew Green](https://www.drewgreen.net/)

Pentester/Security Researcher/IT Pro | @agreenbhm

Main Menu

* [About](https://www.drewgreen.net/about-2/)
* [Contact](https://www.drewgreen.net/contact/)

# Vulnerabilities in Tightrope Media Systems Carousel <=7.0.4.104 (and likely newer)

[1 Comment](https://www.drewgreen.net/vulnerabilities-in-tightrope-media-systems-carousel/#comments)
/ [Microsoft - General](https://www.drewgreen.net/category/microsoft-general/) / By  [drew](https://www.drewgreen.net/author/drew/ "View all posts by drew")

While on a recent penetration test, I discovered a digital signage system made by Tightrope Media Systems (TRMS). The client was using this software on an appliance provided by TRMS which was essentially an x86 Windows 10 PC. I was able to gain access into the web-interface of this system due to an unchanged default administrator password. I found references online to a vulnerability in the version of this system that allows for an arbitrary file read (LFI) on the system via the RenderingFetch API function (CVE-2018-14573). By reading the CVE and the API documentation, I was able to successfully read files on the system.

![](https://www.drewgreen.net/wp-content/uploads/2019/02/image-1024x541.png)

Local File Inclusion (LFI) via the RenderingFetch API

I attempted to read protected files, such as the SQL database of the application itself (expecting it to fail, as even if the user account did have read permission to this file, the file would have been locked). Eventually though, I found that the system included a handy database backup function which included the ability to email the backed up file to an arbitrary address. I emailed a copy of the database to myself, but found that due to a bug in the system, it did not include the actual db I wanted, just the secondary db that did not include any user authentication details.

After this disappointing result, I set out to find other ways to compromise the system. I explored the Carousel webui and found something interesting. This interface allows for the uploading of “bulletins”, or in other words, items to display on the digital signage screen.

![](https://www.drewgreen.net/wp-content/uploads/2019/02/image-1.png)

Carousel bulletin management page

I analyzed the bulletin import mechanism and found that it appeared to accept ZIP files for uploading. Upon attempting to upload a random file, however, it was rejected as not properly formatted. In order to identify the format of these files, I found that I could export an existing bulletin and then open this ZIP file up on my system to look at the structure. Inside of the file, there is a folder called “Pages”, with another folder within that named with a random GUID. I inserted two malicious .ASPX files and then attempted to upload the file.

![](https://www.drewgreen.net/wp-content/uploads/2019/02/image-2.png)

Malicious ASPX files inside of exported bulletin ZIP file

After this, I was able to successfully upload the ZIP file to the system. I identified the GUID of the newly created (via import) bulletin by looking at the URL attached to the preview image on the webui. To clarify, the GUID inside of the ZIP file is not the GUID once it’s imported into the system. I then attempted to navigate to the URL of the malicious ASPX files I had inserted into the ZIP, but they were not found.

Frustrated, I analyzed the original ZIP file via unzip on Linux, along with 7-Zip on Windows. It appeared that when inserting files into this ZIP archive, the path separator for files and directories was being set to the forward-slash character (“/”) rather than the backslash character (“\”). This caused the files I added to be discarded by the server upon upload. I was eventually able to see this clearly by opening the file in a hex editor.

![](https://www.drewgreen.net/wp-content/uploads/2019/02/image-3-1024x504.png)

 Bad ZIP file with improperly-formatted additional file

I decided to try to manually change the “/” to a “\” for the files I added to the archive with a hex editor. I just selected the wrong character, typed the right character, and then saved the file. “Surely this will not work”, I thought.

![](https://www.drewgreen.net/wp-content/uploads/2019/02/image-4-1024x770.png)

ZIP file after modifying the path-separator character of the newly added files with a hex editor

After modifying the ZIP file with the hex editing tool, I uploaded it to Carousel and found it listed in the main bulletin listing (as I had with my first attempt). I then selected the bulletin and inspected the URL of the preview image (to determine the GUID and full-path to the directory where my files had been imported).

![](https://www.drewgreen.net/wp-content/uploads/2019/02/image-5.png)

Malicious bulletin archive successfully imported

After identifying the path to the imported files, I attempted to navigate to my malicious ASPX files in that directory. Sure enough, they loaded! I was able to successfully execute commands on the system via a web shell. I first attempted a standard directory listing of the C:\ drive, and then ran `whoami`.

![](https://www.drewgreen.net/wp-content/uploads/2019/02/image-6.png)

Directory listing of C:\ drive

![](https://www.drewgreen.net/wp-content/uploads/2019/02/image-8.png)

`whoami` showing application being run in context of IIS AppPool\Carousel

Running commands via the web shell became a bit tiresome, so I decided to upload a Powershell file that would connect a remote interactive shell back to my attacking system.

![](https://www.drewgreen.net/wp-content/uploads/2019/02/image-9.png)

Downloading reverse shell to target system via Powershell

![](https://www.drewgreen.net/wp-content/uploads/2019/02/image-10.png)

Reverse shell successfully downloaded to target system

I started a listener on my attacking machine and executed the reverse shell Powershell script via the web shell, which caused the targeted system to connect back to me and provide a fully-interactive command prompt.

![](https://www.drewgreen.net/wp-content/uploads/2019/02/image-11.png)

With that, I had achieved arbitrary file upload and remote code execution on this system. This has been classified as CVE-2018-18930.

Despite having fully-interactive access to this system, I was still running in the context of a restricted account. I set out looking for a way to elevate my privileges. I noticed that the path that uploaded files are saved to was C:\TRMS\Web\Carousel\Media. This meant that the restricted IIS account had write-access to at least that folder. I navigated to the C:\TRMS directory and saw that it appeared an application (an installed application, as opposed to the web app) was running from another directory under the C:\TRMS folder. I issued a command to view the services running on the system and the user accounts they run under. I found two services with “Carousel” in the name running under the SYSTEM account.

![](https://www.drewgreen.net/wp-content/uploads/2019/02/image-12-1024x407.png)

Two Carousel services running as SYSTEM

After identifying these services, I issued another command to identify the path at which the executables these services used were located.

![](https://www.drewgreen.net/wp-content/uploads/2019/02/image-13-1024x91.png)

Paths of the Carousel services

I then executed a command to show the permissions (ACL) of service executables, trying to identify if we had the ability to modify these files. Sure enough, the “NT Authority\Authenticated Users” group had “Modify” permissions to the service exe file.

![](https://www.drewgreen.net/wp-content/uploads/2019/02/image-14.png)

“NT Authority\Authenticated Users” with “Modify” permissions to Carousel.Service.exe

I built a small exe file in C# that would execute various commands I compiled into the application, such as a command to create a user account. I moved the original exe file and uploaded my malicious exe to the location the service exe resides.

![](https://www.drewgreen.net/wp-content/uploads/2019/02/image-15.png)

Malicous exe (Carousel.Service.exe) uploaded, after renaming original

I now needed to restart the service. Unfortunately, the user account I was running under did not have permission to restart services on this system. I found that it did, however, have the ability to restart the server. I ran a command to reboot, knowing that this would achieve the same thing as restarting the service (albeit with slightly higher risk, as the entire system would go down temporarily). After the system came back up, I ran a command to view the local users and administrators on the system and found that my account had been created and was now a local admin!

![](https://www.drewgreen.net/wp-content/uploads/2019/02/image-16.png)

Rebooting system to restart service

![](https://www.drewgreen.net/wp-content/uploads/2019/02/image-17.png)

User account “gfsec” created an a member of the local admins group

Now armed with a local user account belonging to the admin group, I attempted to connect remotely directly to SMB. I found, however, that the configuration of this machine did not allow for connections to essentially anything except 80 and 443. Turning off the firewall didn’t seem to help. I ended up uploading Ngrok to the system. Ngrok is a free application/service that allows for bypassing NAT and firewalls, generally used for web development when developers do not have the ability to open up holes in their firewall and forward ports. The application runs on the target system and connects to a local port of your choosing that you wish to connect to from remotely. Then, you are given a randomly generated URL and port number for which you can connect to your target system from anywhere in the world. I ran this on the Carousel system and pointed it at the local SMB port of 445.

![](https://www.drewgreen.net/wp-content/uploads/2019/02/image-18.png)

Ngrok running, attached to local port 445

After making the SMB port available to remote systems, I was able to authenticate via SMB with Metasploit and have full control over the system conveniently. This privilege-escalation vulnerability has been assigned CVE-2018-18931.

While exploring the system, I eventually uncovered the remnants of a system image deployment. When Windows systems are imaged, administrators can use an Unattend.xml file to control various settings on the new system. This includes local accounts and passwords. I found that the Unattend.xml file left on the system included the creation of a local admin account (along with the password). This default password has been assigned CVE-2018-18929.

Tightrope Media Systems was notified of these vulnerabilities on in early November 2018. They responded back on 11/13/2018 stating that they believed these bugs were fixed and requested the contact info of my client to ensure they were on the latest version. They have not followed-up with me to discuss with them the specifics of these vulnerabilities. Now that approximately 90 days have elapsed since original disclosure, this information is being made publicly available.

UPDATE (2/7/19): Tightrope Media Systems has reached out to me regarding this post and the vulnerabilities discussed. They apologized for the way that the situation was handled on their end and have stated their intention to review how they triage reported security issues. The CEO personally thanked me for my contribution to their security and committed to improving their internal processes. This is a lot better than being threatened with litigation, as has happened to me in the past from other vendors, so I applaud TRMS for their response after this came to their attention (again). If you are a customer, they have [released a bulletin](https://www.carouselsignage.com/knowledgebase/security-announcement-february-4-2019) regarding the CVEs along with a workaround to mitigate some of the disclosed issues. They are planning to release a patch on 2/8/19.

Post navigation
[← Previous Post](https://www.drewgreen.net/converting-a-cheap-2-st-link-v2-clone-into-a-hardware-gpg-key/ "Converting a Cheap ($2) ST-Link v2 Clone into a Hardware GPG Key")[Next Post →](https://www.drewgreen.net/ios-13-mdm-dep-bypass-using-checkra1n-jailbreak/ "iOS 13 MDM/DEP Bypass (using Checkra1n jailbreak)")

### 1 thought on “Vulnerabilities in Tightrope Media Systems Carousel <=7.0.4.104 (and likely newer)”

1. ![](https://secure.gravatar.com/avatar/81fbc56c09226ba7a697bd23ff9b2b50?s=50&d=mm&r=g)
   **Amy** [March 18, 2019 at 8:38 am](https://www.drewgreen.net/vulnerabilities-in-tightrope-media-systems-carousel/#comment-580)

   My facility was not using the default password and we were still hit.

   [Reply](https://www.drewgreen.net/vulnerabilities-in-tightrope-media-systems-carousel/?replytocom=580#respond)

### Leave a Comment [Cancel Reply](/vulnerabilities-in-tightrope-media-systems-carousel/#respond)

Your email address will not be published. Required fields are marked \*

Type here..

Name\*

Email\*

Website

 Notify me of follow-up comments by email.

 Notify me of new posts by email.

Δ

## Categories

* [Apple](https://www.drewgreen.net/category/apple/) (1)
* [Bitcoin](https://www.drewgreen.net/category/bitcoin/) (1)
* [Debugging](https://www.drewgreen.net/category/debugging/) (1)
* [Exchange](https://www.drewgreen.net/category/exchange/) (3)
  + [2010](https://www.drewgreen.net/category/exchange/2010/) (1)
  + [Exchange 2010](https://www.drewgreen.net/category/exchange/exchange-2010/) (1)
* [GPG](https://www.drewgreen.net/category/gpg/) (1)
* [Hacking](https://www.drewgreen.net/category/hacking/) (2)
* [Hardware](https://www.drewgreen.net/category/hardware/) (2)
  + [Flipper Zero](https://www.drewgreen.net/category/hardware/flipper-zero/) (1)
* [Linux](https://www.drewgreen.net/category/linux/) (3)
  + [Ubuntu](https://www.drewgreen.net/category/linux/ubuntu/) (3)
* [Microsoft – General](https://www.drewgreen.net/category/microsoft-general/) (16)
  + [Microsoft Security Essentials](https://www.drewgreen.net/category/microsoft-general/microsoft-security-essentials/) (1)
  + [Windows Live Essentials](https://www.drewgreen.net/category/microsoft-general/windows-live-essentials/) (1)
* [Office](https://www.drewgreen.net/category/office/) (3)
  + [Office 2007](https://www.drewgreen.net/category/office/office2007/) (1)
  + [Office 2010](https://www.drewgreen.net/category/office/office2010/) (2)
* [Office 365](https://www.drewgreen.net/category/office-365/) (1)
* [Phones](https://www.drewgreen.net/category/phones/) (4)
  + [Android](https://www.drewgreen.net/category/phones/android/) (4)
* [Squid](https://www.drewgreen.net/category/squid/) (1)
* [Uncategorized](https://www.drewgreen.net/category/uncategorized/) (1)
* [VMware](https://www.drewgreen.net/category/vmware/) (6)
* [Windows](https://www.drewgreen.net/category/windows/) (14)
  + [Windows 7](https://www.drewgreen.net/category/windows/win7/) (12)
  + [Windows Vista](https://www.drewgreen.net/category/windows/winvista/) (1)
  + [Windows XP](https://www.drewgreen.net/category/windows/winxp/) (2)
* [Windows Server](https://www.drewgreen.net/category/windows-server/) (4)
  + [Server 2008](https://www.drewgreen.net/category/windows-server/server-2008/) (1)
  + [Server 2008 R2](https://www.drewgreen.net/category/windows-server/server-2008-r2/) (3)
* [Wordpress](https://www.drewgreen.net/category/wordpress/) (2)
* [XBMC](https://www.drewgreen.net/category/xbmc/) (1)

Copyright © 2025 Drew Green | Powered by [Astra WordPress Theme](https://wpastra.com/)


