- **Root cause of vulnerability:** Insecure use of `/tmp` during package build. The `Makefile` copies a binary to a temporary file in `/tmp` using a predictable name based on the user, then installs the temporary file and removes it.
- **Weaknesses/vulnerabilities present:** Race condition vulnerability. A malicious user can create a directory with the same name as the temporary file (e.g., `/tmp/xr-root` if the user is root) with mode 777 and then replace it with an arbitrary file after the cp command has copied to it, but before the install command.
- **Impact of exploitation:** Arbitrary binary injection into the build process, potentially leading to arbitrary code execution with the privileges of the user building the package.
- **Attack vectors:** Local access to the system during package building.
- **Required attacker capabilities/position:** The attacker needs to be able to create files in `/tmp` and monitor file system changes (using inotify) during the package building process. They must also know the predictable name of the temporary file used by the build process.