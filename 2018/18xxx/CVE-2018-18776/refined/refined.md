```
# Exploit Title: Cross Site Scripting in Microstrategy Web version 7
# Date: 29-10-2018
# Exploit Author: Rafael Pedrero
# Vendor Homepage: https://www.microstrategy.com
# Software Link: https://www.microstrategy.com
# Version: Microstrategy Web version 7
# Tested on: all
# CVE : CVE-2018-18776
# Category: webapps

1. Description

Microstrategy Web, version 7, does not sufficiently encode user-controlled
inputs, resulting in a Cross-Site Scripting (XSS) vulnerability via the
admin.asp ShowAll parameter.

2. Proof of Concept

http://X.X.X.X/microstrategy7/admin/admin.asp?ShowAll=
"><script>alert("XSS")</script><"&ShowAllServers=show

3. Solution:

The product is discontinued. Update to last version this product.
Patch:
https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet#XSS_Prevention_Rules
```

- **Root cause of vulnerability**: Insufficient encoding of user-controlled input.
- **Weaknesses/vulnerabilities present**: Cross-Site Scripting (XSS).
- **Impact of exploitation**: An attacker can inject malicious scripts into the web page, potentially leading to session hijacking, defacement, or phishing attacks against users of the application.
- **Attack vectors**: The vulnerability can be exploited by crafting a URL with a malicious script within the `ShowAll` parameter of the `admin.asp` page.
- **Required attacker capabilities/position**: The attacker needs to be able to craft a malicious URL and entice a user to access it. The attacker does not need any authentication.