- **Root cause of vulnerability**: The Kubernetes integration in GitLab's Pod Logs feature follows redirects when fetching logs from a specified API URL. This allows an attacker to redirect the log request to an arbitrary internal service using a crafted redirect response.
- **Weaknesses/vulnerabilities present**: Unrestricted URL redirection, lack of proper input sanitization for the API URL, and trusting the server's response headers.
- **Impact of exploitation**: An attacker can potentially access sensitive information from internal services by redirecting the Kubernetes API request to internal endpoints, like metadata services.
- **Attack vectors**: The attacker needs to create a malicious server that responds with a redirect to an internal resource. This malicious server's URL is then used as the Kubernetes API URL in GitLab.
- **Required attacker capabilities/position**: The attacker needs to have a GitLab Ultimate plan to access the Pod Logs feature, be able to create a project and an environment, and control a server that responds to HTTP requests. They also need to know the internal service endpoint they wish to target.