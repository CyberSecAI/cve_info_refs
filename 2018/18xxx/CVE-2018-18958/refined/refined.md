Based on the provided content, here's an analysis of CVE-2018-18958:

**Root Cause of Vulnerability:**

The vulnerability stems from an unenforced "deny config write" privilege in OPNsense. This means that a user or group could be configured with the "deny config write" privilege, but the system failed to properly prevent them from making configuration changes.

**Weaknesses/Vulnerabilities Present:**

*   **Insufficient Privilege Enforcement:** The core issue is the lack of proper enforcement of the "deny config write" privilege. This allowed users with this privilege, who should have been read-only, to still modify the system configuration.
*   **Combinatorial Vulnerability:** The vulnerability was specifically exploitable when the "deny config write" privilege was combined with admin or user and group manager rights.
*   **Read-Only Bypass:** The vulnerability allowed users to bypass the intended read-only restrictions.

**Impact of Exploitation:**

*   **Unauthorized Configuration Changes:** Attackers, with the vulnerable privilege combination, could alter the OPNsense system configuration despite being configured as read-only users. This could potentially lead to a wide range of impacts, depending on the attacker's goals.
*   **Privilege Escalation**: The ability to modify the system configuration may lead to further privilege escalation and potentially full control over the system.

**Attack Vectors:**

*   **Web Interface:** The vulnerability was accessible through the OPNsense web interface.
*   **User/Group Management:** The vulnerability was specifically tied to the user and group management features.

**Required Attacker Capabilities/Position:**

*   **Access to OPNsense Web Interface**: The attacker would need to have access to the OPNsense web interface.
*   **User or Group Manager Rights:** The attacker would need an account with admin or user and group manager rights.
*   **"Deny Config Write" privilege:** The attacker's user/group would need the "deny config write" privilege configured for the vulnerability to be triggered.

**Additional Information:**

*   The vulnerability was reported by brainrecursion.
*   The fix involved preventing configuration restoration, manipulation via history and default pages and preventing methods to strip read-only privileges.
*   The "deny config write" privilege was intended for role-based access to non-system services, such as captive portals and not intended to be used with system services or admin rights.
*   The advisory recommends refraining from using the "deny config write" privilege with system service access or full admin rights until a more robust solution is implemented.