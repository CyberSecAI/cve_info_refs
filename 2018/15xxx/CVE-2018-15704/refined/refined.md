### CVE-2018-15704

**Root cause of vulnerability:** A stack buffer overflow exists due to a lack of input validation when processing the `sv` parameter in `BwOpcBs.exe`. The value of this parameter is used to dynamically construct a command line, which is then passed to the `RemoteWinExec` function and subsequently used as an argument when launching `BwOpcBs.exe`.

**Weaknesses/vulnerabilities present:**
- Stack buffer overflow: The program does not validate the size of the input provided via the `sv` parameter before using it in a command line argument to `BwOpcBs.exe`.

**Impact of exploitation:**
- A successful exploit allows a remote, authenticated attacker to overwrite the instruction pointer, resulting in arbitrary code execution.

**Attack vectors:**
- The vulnerability is reachable via a crafted HTTP request to `/broadweb/system/opcImg.asp`.
- The attacker needs to know the values for the parameters `proj` and `node`. These values can be discovered by inspecting the application, as described in the advisory.

**Required attacker capabilities/position:**
- The attacker needs to be authenticated to the Advantech WebAccess application.
- The attacker must craft a malicious URL and send it to a WebAccess administrator.
- The attacker needs to know the values for parameters `proj` and `node`, which can be discovered through the web interface of the application by following the steps described in the advisory.