=== Content from research.digitalinterruption.com_bca11449_20250124_125900.html ===

[![](/assets/img/logo.png)
![](/assets/img/cropped-di-security-logo1-small-72x72.png)](/)

* [Blog](/)
   -
* [Talks](/talks/)
   -
* [White Papers](/whitepapers/)
   -
* [RSS Feed](/feed.xml "Follow RSS feed")
* [GitHub](https://github.com/DigitalInterruption "Follow on GitHub")
* [LinkedIn](https://www.linkedin.com/company/digitalinterruption/ "Follow on LinkedIn")
* [Twitter](https://twitter.com/di_security "Follow on Twitter")

# Multiple Vulnerabilities Found in Mobile Device Management Software

January 31, 2019

A few months ago during a penetration test, we stumbled upon a Windows based mobile device management [MDM] system named SureMDM. MDM systems aim to provide an efficient means of managing a large number of mobile devices, ensuring that they are all configured to the same standard and kept secure.

The customers section of the vendor’s website boasts quite the impressive list, including organisations such as AT&T, Facebook and Siemens, to name a few. With a wide user base, it was presumed the system would be quite extensive and have a larger attack surface to explore.

Initially, there was not a great deal presented to us. Pretty much the entire system required authentication and we had no credentials. However, there were two dangerous misconfigurations that allowed cross-origin requests; which were the first of several vulnerabilities, that when combined with other issues that were found, could lead to a severe compromise.

### Weak CORS Configuration: CVE-2018-15655

The first of the misconfiguration issues was in the CORS policy. The CORS policy would allow requests to be made from any origin. As a result of this, if an attacker was able to lure a user to a website that they either control or have compromised in some way, they could effectively carry out any action as the victim and exfiltrate sensitive data.

To confirm this, we hosted a small proof of concept on one of our servers, the markup for which can be found below:

```
<html>
<head>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>
  <pre class="remote-content">
  </pre>

  <script type="text/javascript">
    var url = (location.search.split('url=')[1] || '').split('&')[0]
    $.get(url, null, function (data) {
      $('.remote-content').text(data)
    }, 'text')
  </script>
</body>
</html>

```

This page will attempt to load the address provided to the `url` query string parameter, and display the data on screen. If a URL is requested from a website with a secure CORS policy, it will result in an error, as can be seen in the below screenshot when requesting a resource from Google:

![](/assets/img/2019-01-31-multiple-vulnerabilities-found-in-mobile-device-management-software/secure-cors.png)

However, when changing the URL to one being served by the SureMDM system, the request is successful and the content available to be processed:

![](/assets/img/2019-01-31-multiple-vulnerabilities-found-in-mobile-device-management-software/insecure-cors.png)

### Weak Silverlight Access Policy: CVE-2018-15659

Much like the weak CORS policy, the weak Silverlight access policy meant that a request could be made from any origin via a Silverlight application. To test this, we used [This PoC from NCC Group](https://github.com/nccgroup/CrossSiteContentHijacking).

When a resource served by SureMDM was specified as the target page, the Silverlight application could successfully access the resource from a different origin:

![](/assets/img/2019-01-31-multiple-vulnerabilities-found-in-mobile-device-management-software/silverlight-poc.png)

### Incorrect Access Control: CVE-2018-15658

After discovering the cross-origin issues, we were left with only theoretical scenarios to present to the client as we weren’t sure of what could be achieved from the web UI; then we came across `/console/ConsolePage/Master.html`.

As one would expect from a page that requires authentication, when we tried to access this, we were redirected back to the login page - something was not quite right though. When reviewing our request history - there was no sign of any responses with a [3xx code](https://en.wikipedia.org/wiki/List_of_HTTP_status_codes#3xx_Redirection).

This prompted us to take a look at the request being made to `Master.html` and revealed that the session validation and redirection was being carried out in the JavaScript as the page is loaded. The result of this? We were able to see the markup that would be presented to an authenticated user:

![](/assets/img/2019-01-31-multiple-vulnerabilities-found-in-mobile-device-management-software/console-markup.png)

Upon examining the markup, we were able to gather links to unprotected resources which when pooled together revealed over 100 different API endpoints. These endpoints included functions to carry out a number of highly sensitive actions, such as:

* Retrieve call logs from a managed device
* Retrieve SMS logs from a managed device
* Manipulate device blacklists / whitelists
* Retrieve and manipulate user account data

With so many API functions available, the CSRF vulnerabilities that were previously identified were of a much higher severity, putting the mobile devices being managed by SureMDM and the MDM system itself at risk of compromise.

### Unauthenticated Information Exposure: CVE-2018-15656

At this point, we had several highly sensitive resources as well as two vulnerabilities that could be used to reliably carry out cross-site request forgery attacks. To add to this, we were able to identify an API endpoint which did not require authentication and would confirm whether a specified e-mail address is registered against a user account within the SureMDM system.

By making a `GET` request to `/api/register/$1`, where `$1` is a base64 encoded e-mail address, the web server will respond with either `true` or `false` in the response body, indicating that the e-mail is in use or not.

In addition to specifying the e-mail address, it was also required that a `ApiKey` header be declared with the value `apiKey`. For example, to verify whether `jenny@8675309.ext` exists in the system, the below request would have to be made:

```
GET /api/register/amVubnlAODY3NTMwOS5leHQ= HTTP/1.1
Host: 127.0.0.1
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:65.0) Gecko/20100101 Firefox/65.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://127.0.0.1/console/?16.0
Content-Type: application/json; charset=utf-8
X-Requested-With: XMLHttpRequest
Content-Length: 0
Connection: close
ApiKey: apiKey

```

By utilising this information exposure, it further increases the chances of a successful phishing campaign paired up with the CSRF vulnerabilities.

### Server Side Request Forgery: CVE-2018-15657

Lastly, we were able to identify another unauthenticated endpoint which posed a more significant issue than the one documented in CVE-2018-15656. The resource we identified can be found at `/api/DownloadUrlResponse.ashx` and accepts user input via a query string parameter named `url`.

The URL provided in the `url` parameter will subsequently be requested by the web server and the content output in the response to the user. This opens up the possibility of cross-site scripting attacks, with complete evasion of the default protections in several browsers, as no markup is being passed via the URL; but rather the address of the resource to load:

![](/assets/img/2019-01-31-multiple-vulnerabilities-found-in-mobile-device-management-software/rfi.png)

In addition to being able to serve remote files from the SureMDM host, it was also possible to use this SSRF vulnerability to serve files from the local filesystem of the server. As the URI schema is not validated, `file://` URIs can be passed in the `url` parameter, such as `file://C:/WINDOWS/System32/drivers/etc/hosts`:

![](/assets/img/2019-01-31-multiple-vulnerabilities-found-in-mobile-device-management-software/lfi-hosts.png)

After enumerating some older documentation of SureMDM that we were able to find online, we identified the default install path of the IIS application, and confirmed that the vulnerability can be used to recover the SQL server credentials and other sensitive pieces of information within the `Web.config` and `webConnection.config` files:

![](/assets/img/2019-01-31-multiple-vulnerabilities-found-in-mobile-device-management-software/lfi-connections.png)

### Disclosure Timeline

* **2018-08-21**: Contact vendor to request contact information of an appropriate member of staff to disclose vulnerability information to.
* **2018-09-06**: Contact vendor again due to no response to initial e-mail.
* **2018-09-24**: Contact vendor again due to no response to any previous e-mails.
* **2018-09-25**: Response from vendor and disclosure of all vulnerabilities along with suggested remediation steps.
* **2018-11-27**: Vendor issued patch and began reaching out to their customers to push the patch on to their systems.
* **2019-02-01**: Disclosure made public

[#android](/tags#android)
[#ios](/tags#ios)
[#mdm](/tags#mdm)
[#hacking](/tags#hacking)
[#websec](/tags#websec)
[#CVE-2018-15655](/tags#CVE-2018-15655)
[#CVE-2018-15656](/tags#CVE-2018-15656)
[#CVE-2018-15657](/tags#CVE-2018-15657)
[#CVE-2018-15658](/tags#CVE-2018-15658)
[#CVE-2018-15659](/tags#CVE-2018-15659)

Copyright 2019 [Digital Interruption](https://www.digitalinterruption.com/)



=== Content from www.digitalinterruption.com_5e040a3e_20250126_011431.html ===


[Skip to content](#content)
[![Digital Interruption](https://www.digitalinterruption.com/wp-content/uploads/2019/01/digialInterruption-final-logo-edit.png)](https://www.digitalinterruption.com/ "Digital Interruption")

* [Services](https://www.digitalinterruption.com/)
  + [Penetration Testing](https://www.digitalinterruption.com/testing-2)
  + [Vulnerability Scanning](https://www.digitalinterruption.com/vulnerability-scanning)
  + [Cyber Essentials](https://www.digitalinterruption.com/cyber-essentials)
  + [Consultancy](https://www.digitalinterruption.com/consultancy-2)
  + [Training](https://www.digitalinterruption.com/training-2)
  + [Tooling](https://www.digitalinterruption.com/toolin)
* [Research](https://www.digitalinterruption.com/)
  + [Blog](https://www.digitalinterruption.com/di-blog)
  + [WhitePapers](https://research.digitalinterruption.com/whitepapers)
  + [CVEs](https://www.digitalinterruption.com/cves)
  + [Talks](https://research.digitalinterruption.com/talks)
  + [Technical Blog](https://research.digitalinterruption.com/)
* [FAQ](https://www.digitalinterruption.com/faq)
* [About Us](https://www.digitalinterruption.com/about)
* [Contact Us](https://www.digitalinterruption.com/contact-us)
* [REX](https://rexscan.com)
* [Pterodactyl](https://www.digitalinterruption.com/pterodactyl)

![](//www.digitalinterruption.com/wp-content/uploads/2020/04/Testing-scaled.jpg)![](//www.digitalinterruption.com/wp-content/uploads/2020/04/47695637821_3279ccc8fe_o-3-scaled.jpg)![](//www.digitalinterruption.com/wp-content/uploads/2020/04/arif-riyanto-G1N9kDHqBrQ-unsplash-scaled.jpg)![](//www.digitalinterruption.com/wp-content/uploads/2020/04/45168758494_ab8ec3c451_o-scaled.jpg)![](//www.digitalinterruption.com/wp-content/uploads/2020/04/Research.jpeg)
Testing![Image is not available](//www.digitalinterruption.com/wp-content/uploads/2020/04/Website-Landing-Page-V.5.006.png)We understand that you want the best protection for your business and your customers.

That’s why we offer a range of mobile, web and network penetration testing, using industry standard methodologies such as OWASP Top Ten, OSSTMM and NIST 800-15 as well as vulnerability scanning and Cyber Essentials.

[READ MORE](https://www.digitalinterruption.com/testing-2)Consultancy![Image is not available](//www.digitalinterruption.com/wp-content/uploads/2020/04/Website-Landing-Page-V.5.007.png)At Digital Interruption we offer more than just a penetration test, our Virtual SME Service puts us at the heart of your pipeline.

From threat modelling, to DevSecOps and everything in between, our diverse team of experts work with you and your teams; offering advice and guidance when you need it the most.

From threat modelling, to DevSecOps and everything in between, our diverse team of experts work with you and your teams; offering advice and guidance when you need it the most.

From threat modelling, to DevSecOps and everything in between, our diverse team of experts work with you and your teams; offering advice and guidance when you need it the most.

[READ MORE](https://www.digitalinterruption.com/consultancy-2)Tooling![Image is not available](//www.digitalinterruption.com/wp-content/uploads/2020/04/Website-Landing-Page-V.5.008.png)Hacker tools are made for hackers right? Wrong. Ours are made for developers and customers.

Whether it’s tools to help you run your own security tests, integrate security in to your pipeline, or help you understand your threats better, we have tools that can help.

Whether it’s tools to help you run your own security tests, integrate security in to your pipeline, or help you understand your threats better, we have tools that can help.

Whether it’s tools to help you run your own security tests, integrate security in to your pipeline, or help you understand your threats better, we have tools that can help.

[READ MORE](https://www.digitalinterruption.com/tooling-2)Training![Image is not available](//www.digitalinterruption.com/wp-content/uploads/2020/04/Website-Landing-Page-V.5.009.png)Since we started Digital Interruption we've trained hundreds of people in security.

Training technical teams on security can save you both time and money. From secure coding to offensive hacking, our consultants deliver training to organisations, conferences and universities all over the world.

Training technical teams on security can save you both time and money. From secure coding to offensive hacking, our consultants deliver training to organisations, conferences and universities all over the world.

Training technical teams on security can save you both time and money. From secure coding to offensive hacking, our consultants deliver training to organisations, conferences and universities all over the world.

[READ MORE](https://www.digitalinterruption.com/training-2)Research![Image is not available](//www.digitalinterruption.com/wp-content/uploads/2020/04/Website-Landing-Page-V.5.010.png)Our research is at the core of what we do, our consultants were some of the first to find vulnerabilities in VR applications and Android Wear.

We release regular blogs and white papers on secure application development, hardware hacking, how to embed security and compliance and have numerous CVEs.

We release regular blogs and white papers on secure application development, hardware hacking, how to embed security and compliance and have numerous CVEs.

We release regular blogs and white papers on secure application development, hardware hacking, how to embed security and compliance and have numerous CVEs.

[READ MORE](https://www.digitalinterruption.com/di-blog)

![previous arrow](data:image/svg+xml;base64...)![previous arrow](data:image/svg+xml;base64...)![next arrow](data:image/svg+xml;base64...)![next arrow](data:image/svg+xml;base64...)
![Digital Interruption](https://www.digitalinterruption.com/wp-content/uploads/2020/03/cropped-aswin-mahesh-4_LGBLe6VZA-unsplash-1-scaled-1.jpg "Digital Interruption")

### [Penetration Testing](https://www.digitalinterruption.com/testing-2)

Our range of penetration testing and vulnerability scanning services help to protect both your business and your customers.

### [Vulnerability Scanning](https://www.digitalinterruption.com/vulnerability-scanning)

We can scan your networks and applications for you, giving you actionable reports that are easy to understand.

### [Security Consultancy](https://www.digitalinterruption.com/consultancy-2)

Our diverse team of experts work with you and your teams; offering advice and guidance when you need it the most.

### [Security Integration](https://www.digitalinterruption.com/tooling-2)

Whether you want to run your own in-house security testing or just start to understand your threats better, our tools can help.

### [Security Training](https://www.digitalinterruption.com/training-2)

From secure coding to offensive hacking, we deliver training to organisations and conferences all over the world.

## Security Tools

You can intergrate security in to your pipeline, but for it to work well it needs to be the right fit for your comapany.

Whether you’re looking to test your own products,  train staff, or develop new processes to embed security in to your culture, we can provide the tools to help.

CONTACT US

## Security Designed for SMEs

Small or large, we all need security. That’s why we’ve tailored our services to SMEs and Startups.

Our years of experiece with big banks make us ideal for fintech and our regualtory knowledege can protect your tech-for-good products.

CONTACT US

## Remote Security Services

From our Virtual AppSec SME to off site penetration testing, all our services are designed to be offered remote. Even our training and worhops can be delivered virtually.

This saves you money and time, and limits the disruption to your business.

CONTACT US

## Conferences and Events

We speak about all aspects of ethical hacking and Cybersecurity. Our consultants give talks and workshops  at conferences and events world wide.

To book one of our specialists for a talk or workshop please get in touch.

CONTACT US

### About us

Digital Interruption is a Manchester based CyberSecurity Consultancy founded by Jahmel Harris and Saskia Coplans in 2017.

We believe that security should be universal which means it should be accessible to everyone. That’s why we offer a range of testing, scanning and consultancy services all available remotely.

We’ve designed our services to meet the needs of organisations who need it the most.

READ MORE

![](https://www.digitalinterruption.com/wp-content/uploads/2020/04/Consultancy-1024x776.jpg)

### What our clients say

> As a developer, I’ve often seen pen testing as little more than a checkbox exercise, where senior management bring in a big name who run some automated scans and give you a certificate at the end. Digital Interruption were different, they understood the domain and the architecture of the app which allowed them to test in a more thorough way which gave us a lot of confidence when talking to clients about the security of the app.

Chris Northwood; Lead Developer and author of The Full Stack Developer

> Reports were especially useful for our management to understand their business risks and for developers to quickly remediate the discovered vulnerabilities. Needless to say, our team was very thankful to have had the opportunity to work with Jahmel!

Senior Security Engineer; Company Name under NDA

> We really enjoyed working with Jahmel and the team on the pen test. They were extremely professional and diligent in their work, and their report was extensively detailed. Their knowledge of all matters security was second to none, and their advice proved invaluable to our business.

Kieran Innes; Co-founder and CTO at Tootoot | Forbes 30 under 30

## CONTACT

### [Phone](https://www.digitalinterruption.com/contact-us)

0161 820 3056

### [Email](https://www.digitalinterruption.com/contact-us)

contact@digitalinterruption.com

### [Message](https://www.digitalinterruption.com/contact-us#form)

Contact us

[Twitter](https://twitter.com/di_security)

[Linkedin](https://www.linkedin.com/company/digitalinterruption/)

**Digital Interruption**

Colony, 5 Piccadilly Place, Manchester, M1 3BR

+44 (0) 161 820 3056

contact@digitalinterruption.com

![](https://www.digitalinterruption.com/wp-content/uploads/2020/04/digialInterruption-final-logo-block-colour-white-text-300x79.png)

Digital Interruption Limited is a company registered in England and Wales with company number 10629757

ICO Registration Number: ZA446620

VAT Number: 279 2798 36

**[Privacy Notice](https://www.digitalinterruption.com/privacy-notice)** | **[Cookie Policy](https://www.digitalinterruption.com/cookie-policy)**

![](https://www.digitalinterruption.com/wp-content/uploads/2018/12/Cyber-Essentials-Badge-Large-72dpi-1-230x194.png)


