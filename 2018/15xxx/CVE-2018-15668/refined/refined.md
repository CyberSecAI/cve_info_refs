The provided content relates to CVE-2018-15668.

**Root cause of vulnerability:**
The "send" command in the `airmail://` URL scheme allows an external application to send arbitrary emails from an active account.  The vulnerability arises because the `attachment_` prefixed URL parameters, intended for specifying attachments, allow the use of file paths. This enables an attacker to specify a local file to be attached to an email.

**Weaknesses/vulnerabilities present:**
- Lack of proper input validation for attachment parameters.
- Exposure of local file system through the attachment parameter by not validating file paths and accepting relative paths.
- The handler doesn't prompt the user before sending emails, resulting in silent attachment and sending of emails.

**Impact of exploitation:**
- Information Disclosure: An attacker can gain access to the content of files on the victim's machine by attaching them to an email sent through the victim's Airmail account. This includes any file the user has read access to.
- Arbitrary Email Sending: The attacker can send emails from the victim's account, which could be used for phishing, spam, or other malicious purposes.

**Attack vectors:**
- Malicious URL: An attacker can craft a malicious `airmail://` URL.
- The malicious URL can be delivered via a hyperlink in an email or any other method that invokes the URL handler.

**Required attacker capabilities/position:**
- The attacker needs to be able to deliver a malicious link to the victim.
- The victim must have Airmail 3 for Mac installed and configured with an active email account.
- The attacker must know the file path of the target file on the victim's machine, or rely on the use of relative paths which might disclose common local files.