=== Content from www.seebug.org_024a1254_20250124_234236.html ===

![Seebug](/static/dist2/images/weixin-share-sm.jpg)

[![Knownsec-logo](/static/dist2/images/knownsec-logo.png)](https://www.knownsec.com?from=seebug_logo)
![](/static/dist2/images/line.png)
[![Seebug-logo](/static/dist2/images/seebug-logo2023.png?v=2)](/)

* [Index](/)
* [Submit Vulnerability](/contribute/vul)
* [Rank](/hackers)
* Market
  + [Exchange](/exchange/goods)
  + [Newest PoC](/vuldb/vulnerabilities?has_poc=true)
* [Search](/search/)* Community
    + [Pocsuite](http://pocsuite.org/)
    + [Ceye.io](http://ceye.io/)
    + [Paper](http://paper.seebug.org/)
    + [KCon](http://kcon.knownsec.com/)
    + [ZoomEye](https://www.zoomeye.org/)
  * About
    + [Data Statistics](/stat)
    + [Vul Market](/help/about)
    + [Develop Document](https://pocsuite.org/guide/what-is-pocsuite3.html)
    + [Guideline](/help/user_level)
    + [Feedback](/help/feedback)
    + [Help](/help/reward)

* [Login](/accounts/login/?next=/vuldb/ssvid-96205)
* [Register](/accounts/register?next=/vuldb/ssvid-96205)

Toggle navigation

* [Login](/accounts/login/?next=/vuldb/ssvid-96205)
* [Index](/)
* Reward and Rank
  + [Detail Reward List](/vuldb/reward/detail)
  + [PoC Reward List](/vuldb/reward/poc)
  + [Exchange](/exchange/goods)
  + [Rank](/hackers)
  + [Submit New Vulnerability](/contribute/vul)
* Vulnerability Database
  + [Vulnerability List](/vuldb/vulnerabilities)
  + [Component Categories](/appdir/)
  + [Vulnerability Category](/category/)
* [Search](/search/)
* [Data Statistics](/stat)
* [Paper](http://paper.seebug.org/)

# ASPCMS最新版V2.5.6权限提升漏洞

 Follow
0

### Basic Fields

SSV ID:
[SSV-96205](/help/vul#ssv)

Find Time:
2015-01-19

Submit Time:
2015-01-19

Level:

Category:
[其他类型](/category/other)

Component:
[ASPCMS](/appdir/ASPCMS)

Author:
云天河

Submitter:
[Knownsec](/accounts/profile/admin)

CVE-ID：
Add

CNNVD-ID：
Add

CNVD-ID：
Add

ZoomEye Dork：
Add

### Source

<http://wooyun.org/bugs/wooyun-2015-091831>

### Detail

Contributor
[Knownsec](/accounts/profile/admin)
Got  0KB

### 简要描述：
ASPCMS最新版V2.5.6存在权限提升漏洞，注册普通用户的时候可以直接注册成超级管理员。
### 详细说明：
ASPCMS最新版V2.5.6下载地址：
http://www.aspcms.com/aspcms-2179839-1-1.html
该版本存在insert注入，在注册用户的时候没有判断性别参数Gender是否为数字，插入数据库的时候没有用引号引起来，导致过滤函数不起作用。利用Access 16%截断技巧注释掉后面的语句，可以直接注册GroupID为1的超级管理员组用户。
/member/reg.asp
```
Sub addUser
'dim UserID,GroupID,LanguageID,SceneID,LoginName,Password,PswQuestion,PswAnswer,UserStatus,RegTime,RegIP,LastLoginIP,LastLoginTime,LoginCount,TrueName,Gender,Birthday,Country,Province,City,Address,PostCode,Phone,Mobile,Email,QQ,MSN,Permissions,AdminDesc
Dim LoginName,Password,verifyPass,Email,Mobile,Address,PostCode,Gender,QQ,UserStatus,RegTime,RegIP,LastLoginIP,LastLoginTime,Birthday,Exp1,Exp2,Exp3,GroupID,TrueName,Phone
if getForm("code","post")<>Session("Code") then alertMsgAndGo "验证码不正确","-1"
LoginName=filterPara(getForm("LoginName","post"))
Password=filterPara(getForm("userPass","post"))
verifyPass=filterPara(getForm("verifyPass","post"))
Email=filterPara(getForm("Email","post"))
Mobile=filterPara(getForm("Mobile","post"))
Address=filterPara(getForm("Address","post"))
PostCode=filterPara(getForm("PostCode","post"))
Gender=1
Gender=filterPara(getForm("Gender","post"))
QQ=filterPara(getForm("QQ","post"))
Phone=filterPara(getForm("Phone","post"))
TrueName=filterPara(getForm("TrueName","post"))
UserStatus=1
RegTime=now()
RegIP=getip()
GroupID=3
if isnul(LoginName) then alertMsgAndGo "用户名不能为空","-1"
if Conn.Exec("select count(\*) from {prefix}User where LoginName='"&LoginName&"'","r1")(0) >0 then alertMsgAndGo "该用户名已被注册","-1"
if isnul(Password) then alertMsgAndGo "密码不能为空","-1"
if isnul(verifyPass) then alertMsgAndGo "确认密码不能为空","-1"
if Password<>verifyPass then alertMsgAndGo "两次输入密码不相同","-1"
if len(LoginName)>15 then alertMsgAndGo "用户名不能大于15个字符","-1"
if not IsSafeStr(LoginName) then alertMsgAndGo "您的用户名里包含了不安全字段，请重新输入","-1"
if not IsSafeStr(TrueName) then alertMsgAndGo "您的真是姓名里包含了不安全字段，请重新输入","-1"
if len(TrueName)>5 then alertMsgAndGo "真实姓名不能大于5个字符，如真实姓名超过5个字符的用户，请联系网站管理员！","-1"
if not isnul(Mobile) then
if not CheckMobile(Mobile) then alertMsgAndGo "您输入的手机号码格式不正确，请重新输入","-1"
end if
if not isnul(Phone) then
if not CheckTelPhone(Phone) then alertMsgAndGo "您输入的电话号码格式不正确，请重新输入","-1"
end if
if not isnul(Email) then
if not CheckEmail(Email) then alertMsgAndGo "您输入的邮箱格式不正确，请重新输入","-1"
end if
if not isnul(QQ) then
if not CheckQQnum(QQ) then alertMsgAndGo "您输入的QQ格式不正确，请重新输入","-1"
end if
if not isnul(Address) then
if not IsSafeStr(Address) then alertMsgAndGo "您输入的地址里面含有不安全字段，请检查并且重新输入","-1"
end if
if not isnul(PostCode) then
if not CheckCdoe(PostCode) then alertMsgAndGo "您输入的邮政编码格式不正确，请重新输入","-1"
end if
Password=md5(Password,16)
Conn.Exec"insert into {prefix}User(LoginName,[Password],Email,Mobile,Address,PostCode,Gender,QQ,UserStatus,RegIP,RegTime,GroupID,TrueName,Phone) values('"&LoginName&"','"&Password&"','"&Email&"','"&Mobile&"','"&Address&"','"&PostCode&"',"&Gender&",'"&QQ&"',"&UserStatus&",'"&RegIP&"','"&RegTime&"',"&GroupID&",'"&TrueName&"','"&Phone&"')","exe"
//插入数据库之前没有判断Gender字段是否为数字，插数据库的时候没有用引号引起来。管理员和用户使用同一个表，普通用户组GroupID为3，超级管理员组GroupID为1，因此可以利用Access 16%截断特性，直接注册成GroupID为1的超级管理员。
alertMsgAndGo "注册成功！",sitePath&setting.languagepath&"member/login.asp"
End Sub
```
### 漏洞证明：
注册普通用户的时候抓包，修改Gender参数的值（括号后面为%16 URL-decode后的字符）：
[<img src="https://images.seebug.org/upload/201501/1414393468b91dc5f6373b1ec7228e10208bb743.jpg" alt="1.jpg" width="600" onerror="javascript:errimg(this);">](https://images.seebug.org/upload/201501/1414393468b91dc5f6373b1ec7228e10208bb743.jpg)
成功登录管理后台：
[<img src="https://images.seebug.org/upload/201501/1414400279a43d266c36979a1ce71677846d8b53.jpg" alt="2.jpg" width="600" onerror="javascript:errimg(this);">](https://images.seebug.org/upload/201501/1414400279a43d266c36979a1ce71677846d8b53.jpg)

![Loading icon](/static/dist2/bower_components/loading/loading-bars.svg)

have 0  exchange

### PoC

Unavailable PoC

### Reference Linking

* <http://wooyun.org/bugs/wooyun-2015-091831>

### Solutions

**Temp Solutions**

Unavailable Temp Solutions

**Official Solution**

Unavailable Official solution

**Defense Solutions**

Unavailable Defense Solutions

Improve Solutions

BackSubmit

[![](/media/banner/2017/08/22/150338358279.png)](https://www.yunaq.com/)

[![](/media/banner/2020/05/26/159048249988.png)](https://www.yunaq.com/help/article?id=5ebcf0e3439fa500115a1326?from=seebugb00515)

[![](/media/banner/2017/08/09/150226089416.png)](https://scanv.yunaq.com/stcs/index.html?from=seebugb00526)

[![](/media/banner/2020/01/16/157914493733.png)](https://www.yunaq.com/dbzx?from=seebugb00115)

---

### Timeline

* 云天河

  2015-01-19
  发现/披露了漏洞

---

### Related Vuls

* [AspCMS V2.5.2 /aspcms252.asp 数据库泄露漏洞](/vuldb/ssvid-90501)
* [aspcms最新版逻辑错误导致后台地址泄露](/vuldb/ssvid-96211)
* [aspcms后台备份逻辑错误导致被注入一句话木马](/vuldb/ssvid-96210)
* [ASPCMS最新版V2.5.6权限提升漏洞](/vuldb/ssvid-96205)
* [ASPCMS信息泄漏包括管理员帐号](/vuldb/ssvid-96207)
* [ASPCMS最新版CSRF添加管理员及GetShell](/vuldb/ssvid-96206)
* [aspcms投票站后台登录漏洞](/vuldb/ssvid-96208)
* [ASPCMS存在SQL注入漏洞可获取敏感信息](/vuldb/ssvid-96201)
* [Aspcms静态生成Getshell](/vuldb/ssvid-96209)
* [ASPCMS 2.2.9 /inc/AspCms\_Visits.asp SQL注入漏洞](/vuldb/ssvid-62357)

 Follow
0

Popularity
5370

0

![](/static/images/anonymous.jpg)
##### Need to bind phone before comment. [Bind Now](https://sso.telnet404.com/accounts/bind_phone/)

Submit Comment

 anonymous reply

#### Unavailable Comments

※Any content provided by this site, only to learn the code and services, not for illegal purposes

captcha![]()

OK
Back

×
#### Hello,

您的会员可兑换次数还剩：
次

本次兑换将消耗 1 次

Vulnerabilities

* [Vulnerability List](/vuldb/vulnerabilities)
* [Component Categories](/appdir/)
* [Vulnerability Category](/category/)

More

* [Reward List](/vuldb/reward/poc)
* [Rank](/hackers)

Help

* [About](/help/about)
* [Relevant Instructions](/help/user_level)
* [Vulnerability Definition](/help/vul)
* [Reward Plan](/help/reward)

Contact

* 010-57076191
* s1@seebug.org
* 15th Floor, Unit A, Tower 3, Wangjing SOHO, Fu'an West Road, Chaoyang District, Beijing 100102, P.R.China

Public links

* [Knownsec](https://www.knownsec.com/#/)
* [yunaq](https://www.yunaq.com/cyd/?from=cj_cyd_sbug)
* [创宇蜜罐-诱捕溯源](https://mg.yunaq.com/#/?from=seebuglink)
* [ScanV](https://www.scanv.com/?from=seebug)
* [hackernews](http://hackernews.cc/)

Follow Us

[![](https://aqyzmedia.yunaq.com/labels/label_sm_90040.png)](https://v.yunaq.com/certificate?domain=www.seebug.org&from=label)

[![](/static/dist2/images/ksz-kcon-new.svg)](http://kcon.knownsec.com/)

[![](/static/dist2/images/seebug-logo2023.png)](/)

[![](/static/dist2/images/ksz-zoomeye.svg)](https://www.zoomeye.org/)

[![](/static/dist2/images/yunaq-logo.png)](https://www.yunaq.com/?from=sbg0702)

[京ICP备10040895号](https://beian.miit.gov.cn/)
[![](/static/dist2/images/beian.png)
京公网安备 11010502034610号](http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010502034610)
Copyright @ 404 Team from Knownsec.
[简体中文](/accounts/language/?l=zh-cn)

×
#### Hello,

please call the customer service hotline to recharge, thank you for your continued support Seebug!

 010-57076191


