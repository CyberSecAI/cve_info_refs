=== Content from xenbits.xen.org_93c5c0a2_20250126_000357.html ===

# Information

| Advisory | [XSA-269](advisory-269.html) |
| --- | --- |
| Public release | 2018-08-14 17:00 |
| Updated | 2023-12-15 15:35 |
| Version | 4 |
| CVE(s) | [CVE-2018-15468](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15468) |
| Title | x86: Incorrect MSR\_DEBUGCTL handling lets guests enable BTS |

# Files

<advisory-269.txt> (signed advisory file)

<xsa269.meta>

<xsa269.patch>

<xsa269-4.8.patch>

<xsa269-4.10.patch>

<xsa269-4.11.patch>
# Advisory

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2018-15468 / XSA-269
                               version 4

      x86: Incorrect MSR_DEBUGCTL handling lets guests enable BTS

UPDATES IN VERSION 4
====================

Normalize version tags

ISSUE DESCRIPTION
=================

The DEBUGCTL MSR contains several debugging features, some of which virtualise
cleanly, but some do not.  In particular, Branch Trace Store is not
virtualised by the processor, and software has to be careful to configure it
suitably not to lock up the core.  As a result, it must only be available to
fully trusted guests.

Unfortunately, in the case that vPMU is disabled, all value checking was
skipped, allowing the guest to chose any MSR_DEBUGCTL setting it likes.

IMPACT
======

A malicious or buggy guest administrator can lock up the entire host, causing
a Denial of Service.

VULNERABLE SYSTEMS
==================

Xen versions 4.6 and later are vulnerable.

Only systems using Intel CPUs are affected. ARM and AMD systems are
unaffected.

Only x86 HVM or PVH guests can exploit the vulnerability.  x86 PV guests
cannot exploit the vulnerability.

MITIGATION
==========

Running only x86 PV guests avoids the vulnerability.

CREDITS
=======

This issue was discovered by Andrew Cooper of Citrix.

RESOLUTION
==========

Applying the appropriate attached patch resolves this issue.

xsa269.patch           xen-unstable
xsa269-4.11.patch      Xen 4.11
xsa269-4.10.patch      Xen 4.10, 4.9
xsa269-4.8.patch       Xen 4.8, 4.7, 4.6

$ sha256sum xsa269*
[4733d09bb63523744ca2ee172e2fade0c39082c15d9a746144f279cf1359b723  xsa269.meta](xsa269.meta)
[5a5fe36f1f876a5029493e7fa191436fd021929aaba2d820636df17f4ed20113  xsa269.patch](xsa269.patch)
[ea11cef818050bca13d4eb89294627c97e4cdb830124f679e77d37a44a370286  xsa269-4.8.patch](xsa269-4.8.patch)
[45ba1823530f329dd73088b77098e686b32f5daac0bc5177b2afea09f8c3593a  xsa269-4.10.patch](xsa269-4.10.patch)
[e0ca060311fb9ba3247e2fe65bca4806a131644f8894fd08be374904904b1944  xsa269-4.11.patch](xsa269-4.11.patch)
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  <http://www.xenproject.org/security-policy.html>
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAmV8b/kMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZsNEIALcCn/17IJkyhzn43iA5CEZLkRQ0Gg45kWJkz2+j
bi+CreEjRPaoclycY38Dx+69d6RXcADBDYEW760QJlxPF4NGvKMwV9mPvoqrhffh
VhrpSoynsznI+HIK9wDrAcxn7NVQkjycDQ5bV3Jmj2eH4uKxAbOGipphrbub8C3A
zTkT8zGGtNuMANk15o/TUzPjXygbi00BTQLdGlgxYuwxFyTao4aA/KTEV7ovMYhJ
XWIj0E0zqyB1kTUYDf1oUVfc0Y+SujctWbXtmixZeNlJfplXn44XB8na76JZs6Ew
Up5y/7ZU+DhCI+2dFBn2gTUp4LS31LND1LZ6g0yXW2DrYpI=
=N5wf
-----END PGP SIGNATURE-----

```

---

Xenproject.org Security Team


=== Content from security.gentoo.org_81bd4b38_20250126_000357.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Xen: Multiple vulnerabilities — GLSA **201810-06**

Multiple vulnerabilities have been found in Xen, the worst of which
could cause a Denial of Service condition.

### Affected packages

| Package | **app-emulation/xen** on all architectures |
| --- | --- |
| Affected versions | < **4.10.1-r2** |
| Unaffected versions | >= **4.10.1-r2** |

| Package | **app-emulation/xen-tools** on all architectures |
| --- | --- |
| Affected versions | < **4.10.1-r2** |
| Unaffected versions | >= **4.10.1-r2** |

### Background

Xen is a bare-metal hypervisor.

### Description

Multiple vulnerabilities have been discovered in Xen. Please review the
referenced CVE identifiers for details.

### Impact

A local attacker could cause a Denial of Service condition or disclose
sensitive information.

### Workaround

There is no known workaround at this time.

### Resolution

All Xen users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/xen-4.10.1-r2"

```

All Xen tools users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=app-emulation/xen-tools-4.10.1-r2"

```
### References

* [CVE-2017-5715](https://nvd.nist.gov/vuln/detail/CVE-2017-5715)
* [CVE-2017-5753](https://nvd.nist.gov/vuln/detail/CVE-2017-5753)
* [CVE-2017-5754](https://nvd.nist.gov/vuln/detail/CVE-2017-5754)
* [CVE-2018-10471](https://nvd.nist.gov/vuln/detail/CVE-2018-10471)
* [CVE-2018-10472](https://nvd.nist.gov/vuln/detail/CVE-2018-10472)
* [CVE-2018-10981](https://nvd.nist.gov/vuln/detail/CVE-2018-10981)
* [CVE-2018-10982](https://nvd.nist.gov/vuln/detail/CVE-2018-10982)
* [CVE-2018-12891](https://nvd.nist.gov/vuln/detail/CVE-2018-12891)
* [CVE-2018-12892](https://nvd.nist.gov/vuln/detail/CVE-2018-12892)
* [CVE-2018-12893](https://nvd.nist.gov/vuln/detail/CVE-2018-12893)
* [CVE-2018-15468](https://nvd.nist.gov/vuln/detail/CVE-2018-15468)
* [CVE-2018-15469](https://nvd.nist.gov/vuln/detail/CVE-2018-15469)
* [CVE-2018-15470](https://nvd.nist.gov/vuln/detail/CVE-2018-15470)
* [CVE-2018-3620](https://nvd.nist.gov/vuln/detail/CVE-2018-3620)
* [CVE-2018-3646](https://nvd.nist.gov/vuln/detail/CVE-2018-3646)
* [CVE-2018-5244](https://nvd.nist.gov/vuln/detail/CVE-2018-5244)
* [CVE-2018-7540](https://nvd.nist.gov/vuln/detail/CVE-2018-7540)
* [CVE-2018-7541](https://nvd.nist.gov/vuln/detail/CVE-2018-7541)
* [CVE-2018-7542](https://nvd.nist.gov/vuln/detail/CVE-2018-7542)

**Release date**

October 30, 2018

**Latest revision**

October 30, 2018: 2

**Severity**

normal

**Exploitable**

local

**Bugzilla entries**

* [643350](https://bugs.gentoo.org/show_bug.cgi?id=643350)
* [655188](https://bugs.gentoo.org/show_bug.cgi?id=655188)
* [655544](https://bugs.gentoo.org/show_bug.cgi?id=655544)
* [659442](https://bugs.gentoo.org/show_bug.cgi?id=659442)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


