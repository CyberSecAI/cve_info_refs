=== Content from xenbits.xen.org_740b46ae_20250124_170820.html ===

# Information

| Advisory | [XSA-272](advisory-272.html) |
| --- | --- |
| Public release | 2018-08-14 17:00 |
| Updated | 2018-08-20 09:46 |
| Version | 3 |
| CVE(s) | [CVE-2018-15470](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15470) |
| Title | oxenstored does not apply quota-maxentity |

# Files

<advisory-272.txt> (signed advisory file)

<xsa272.meta>

<xsa272.patch>
# Advisory

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

            Xen Security Advisory CVE-2018-15470 / XSA-272
                              version 3

               oxenstored does not apply quota-maxentity

UPDATES IN VERSION 3
====================

CVE assigned.

ISSUE DESCRIPTION
=================

The logic in oxenstored for handling writes depended on the order of
evaluation of expressions making up a tuple.

As indicated in section 7.7.3 "Operations on data structures" of the
OCaml manual:

  <http://caml.inria.fr/pub/docs/manual-ocaml/expr.html>

the order of evaluation of subexpressions is not specified.  In
practice, different implementations behave differently.

IMPACT
======

oxenstored may not enforce the configured quota-maxentity.

This allows a malicious or buggy guest to write as many xenstore entries
as it wishes, causing unbounded memory usage in oxenstored.  This can
lead to a system-wide DoS.

VULNERABLE SYSTEMS
==================

Xen 4.1 and later are potentially vulnerable.

Only systems using the OCaml xenstored implementation are potentially
vulnerable.  Systems using the C xenstored implementation are not
vulnerable.

Whether the compiled oxenstored binary is vulnerable depends on which
compiler was used.  OCaml can be compiled either as bytecode (with
ocamlc) or as a native binary (with ocamlopt).

The following OCaml program demonstrates the issue, and identifies
whether the resulting oxenstored binary will skip the quota enforcement.

  $ cat order.ml
  let check () =
    let flag = ref false in
    let update _ = flag := true; () in
    List.iter update [1;2;3], !flag

  let main () =
    let _, flag = check () in
    if flag then
    print_endline "This code is not vulnerable!"
    else
    print_endline "This code is vulnerable!"

  let () = main ()

  $ ocamlc order.ml -o order.bytecode
  $ ./order.bytecode
  This code is vulnerable!
  $ ocamlopt order.ml -o order.native
  $ ./order.native
  This code is not vulnerable!

To confirm whether an OCaml binary is bytecode or native, use file.

  $ file order.bytecode
  order.bytecode: a /usr/bin/ocamlrun script executable (binary data)
  $ file order.native
  order.native: ELF 64-bit LSB executable, ...

NOTE: These results are applicable to OCaml 4.01.0-5 as distributed in
Debian Jessie.  These results are not representative of other versions
of OCaml, or of other OS distributions.

MITIGATION
==========

There are no mitigations available.

CREDITS
=======

This issue was discovered by Christian Lindig of Citrix.

RESOLUTION
==========

Applying the appropriate attached patch resolves this issue.

xsa272.patch           All versions of Xen

$ sha256sum xsa272*
[0da953ca48d0cf0688ecff6a074304a9d2217871809a76ef26b9addeb66ecb3e  xsa272.meta](xsa272.meta)
[6e0359d89bf65794f16d39198cc90f5c3137bce4eb850e54625ab00e2c568c2c  xsa272.patch](xsa272.patch)
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  <http://www.xenproject.org/security-policy.html>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBCAAGBQJbeo4OAAoJEIP+FMlX6CvZCO8H/Rj7Z+rFSuQAVEUKXvvV3lvJ
rytocZDTAIduyiBundcbdkcxfCuun6Tqw8ScPJXtml82P8YE+R/ix1hMLcQdYblt
tj3qftb6KtjFibctoc0sSLsfjhl2oJC2VjQR3HdixfMlSxEzLkCC3I21fteYs9fp
ahO7dByNHFTufbb9GpB+DANmIJ5hwMXxCinvts/L2MP/CCRfb4w5+aTARCQ3UHpX
3/r2wJxLnf4sNpBhHNsArROy8wS+ad0i4XC2fef/Bdye+NRbeICJNqof9fcGjWwE
fZRyeNVSk33DuuRz2HI4aoEKAQ/v3b3KLXnfVZY5F5z6Z8j9rie42RI8VDO8Mzc=
=Y10L
-----END PGP SIGNATURE-----

```

---

Xenproject.org Security Team


=== Content from security.gentoo.org_81bd4b38_20250124_170820.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Xen: Multiple vulnerabilities â€” GLSA **201810-06**

Multiple vulnerabilities have been found in Xen, the worst of which
could cause a Denial of Service condition.

### Affected packages

| Package | **app-emulation/xen** on all architectures |
| --- | --- |
| Affected versions | < **4.10.1-r2** |
| Unaffected versions | >= **4.10.1-r2** |

| Package | **app-emulation/xen-tools** on all architectures |
| --- | --- |
| Affected versions | < **4.10.1-r2** |
| Unaffected versions | >= **4.10.1-r2** |

### Background

Xen is a bare-metal hypervisor.

### Description

Multiple vulnerabilities have been discovered in Xen. Please review the
referenced CVE identifiers for details.

### Impact

A local attacker could cause a Denial of Service condition or disclose
sensitive information.

### Workaround

There is no known workaround at this time.

### Resolution

All Xen users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/xen-4.10.1-r2"

```

All Xen tools users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=app-emulation/xen-tools-4.10.1-r2"

```
### References

* [CVE-2017-5715](https://nvd.nist.gov/vuln/detail/CVE-2017-5715)
* [CVE-2017-5753](https://nvd.nist.gov/vuln/detail/CVE-2017-5753)
* [CVE-2017-5754](https://nvd.nist.gov/vuln/detail/CVE-2017-5754)
* [CVE-2018-10471](https://nvd.nist.gov/vuln/detail/CVE-2018-10471)
* [CVE-2018-10472](https://nvd.nist.gov/vuln/detail/CVE-2018-10472)
* [CVE-2018-10981](https://nvd.nist.gov/vuln/detail/CVE-2018-10981)
* [CVE-2018-10982](https://nvd.nist.gov/vuln/detail/CVE-2018-10982)
* [CVE-2018-12891](https://nvd.nist.gov/vuln/detail/CVE-2018-12891)
* [CVE-2018-12892](https://nvd.nist.gov/vuln/detail/CVE-2018-12892)
* [CVE-2018-12893](https://nvd.nist.gov/vuln/detail/CVE-2018-12893)
* [CVE-2018-15468](https://nvd.nist.gov/vuln/detail/CVE-2018-15468)
* [CVE-2018-15469](https://nvd.nist.gov/vuln/detail/CVE-2018-15469)
* [CVE-2018-15470](https://nvd.nist.gov/vuln/detail/CVE-2018-15470)
* [CVE-2018-3620](https://nvd.nist.gov/vuln/detail/CVE-2018-3620)
* [CVE-2018-3646](https://nvd.nist.gov/vuln/detail/CVE-2018-3646)
* [CVE-2018-5244](https://nvd.nist.gov/vuln/detail/CVE-2018-5244)
* [CVE-2018-7540](https://nvd.nist.gov/vuln/detail/CVE-2018-7540)
* [CVE-2018-7541](https://nvd.nist.gov/vuln/detail/CVE-2018-7541)
* [CVE-2018-7542](https://nvd.nist.gov/vuln/detail/CVE-2018-7542)

**Release date**

October 30, 2018

**Latest revision**

October 30, 2018: 2

**Severity**

normal

**Exploitable**

local

**Bugzilla entries**

* [643350](https://bugs.gentoo.org/show_bug.cgi?id=643350)
* [655188](https://bugs.gentoo.org/show_bug.cgi?id=655188)
* [655544](https://bugs.gentoo.org/show_bug.cgi?id=655544)
* [659442](https://bugs.gentoo.org/show_bug.cgi?id=659442)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**



=== Content from lists.debian.org_cdaededf_20250124_170820.html ===


---

[[Date Prev](msg00012.html)][[Date Next](msg00014.html)]
[[Thread Prev](msg00012.html)][[Thread Next](msg00014.html)]
[[Date Index](maillist.html#00013)]
[[Thread Index](threads.html#00013)]

# [SECURITY] [DLA 1577-1] xen security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1577-1] xen security update
* *From*: Felix Geyer <felix.geyer@credativ.de>
* *Date*: Mon, 12 Nov 2018 14:09:39 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/E1gMByF-0002Ge-A1%40naiad)Â [E1gMByF-0002Ge-A1@naiad](msg00013.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Package        : xen
Version        : 4.4.4lts4-0+deb8u1
CVE ID         : CVE-2018-7540 CVE-2018-7541 CVE-2018-8897 CVE-2018-12891
                 CVE-2018-12893 CVE-2018-15469 CVE-2018-15470

Multiple vulnerabilities have been discovered in the Xen hypervisor, which
could result in denial of service, informations leaks or privilege
escalation.

For Debian 8 "Jessie", these problems have been fixed in version
4.4.4lts4-0+deb8u1.

We recommend that you upgrade your xen packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEFkxwUS95KUdnZKtW/iLG/YMTXUUFAlvpcD4ACgkQ/iLG/YMT
XUXrMg//R4SkbB/ZXrwW12ZgU/1xejiOqC3PPc7Q9IW+UM6e6Oi3o9Grylj04JIh
3aCMZuvpG/V9VKgvqqS5doJHKqC0NLkOc2HMXiLYf0FAQip8JxMEhqztNH1zLIDE
vRj3bjeG2NECY5a/FGV6qSPxrE3tfijuQIfHYGTMobJFOj67aAx+G8zXtf4R0IcU
Cm0NwUzicW4T3NW7KEvpo93zozp+ppZLzDfIHUoCK59hZnVyKfgetBQ9k3bMGfJ4
W1EbsyAMHAsQU2uaViOH9zFFEyBp1g7TbDHk6Y33iOLfl4yFIUXU0wHhWnL4FNyk
32VuaYFS1UwSQQ/cWYhYkiw69jBsYVGv0nmwruxiAEXndW6hlZ7r4sAfIh1Fsy6J
0TCllPD5F+mbJjvKw63vpUPHUDrDSoNV8oQc0+aly9CankVwgX49t51d8xVKtzLv
+uUc4qAkZv4011QoZYmaXhvsqijGYeadLCJ6qU0LFtQhNQ4hX6IPOlhoN70YSYfR
ZPEJpO5mu8Gi/yHpfmh+d61e0vQOcoF4tIbneN/ZkhlGErQTn+JByHxlAL3Qdwup
x5OsluzU8XMFxMUgGmnGZUniNEBEyMOUcZ108omhAi9u26TCdI8LunngCiG1zI9o
/sbjussJTqbi67zd6Bv89qfnKDV5L/2jI94kVr4GKHlIaQ9R878=
=xHoU
-----END PGP SIGNATURE-----

```

---


