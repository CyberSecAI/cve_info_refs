=== Content from bugs.koha-community.org_145b48b9_20250124_204818.html ===


Bugzilla – Bug 19086
Multiple cross-site scripting vulnerabilities
Last modified: 2019-10-14 19:58:24 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.2/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=19086&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=19086&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 19086**](show_bug.cgi?id=19086)
- Multiple cross-site scripting vulnerabilities

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Multiple cross-site scripting vulnerabilities

| | [Status](page.cgi?id=fields.html#bug_status): | CLOSED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Koha | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Koha "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Architecture, internals, and plumbing ([show other bugs](buglist.cgi?component=Architecture%2C%20internals%2C%20and%20plumbing&product=Koha&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | P5 - low major | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Bugs List | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Marcel de Rooy | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | Duplicates (1): | [19362](show_bug.cgi?id=19362 "RESOLVED DUPLICATE")  ([view as bug list](buglist.cgi?bug_id=19362)) | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [14568](show_bug.cgi?id=14568 "CLOSED FIXED") | |  | Show dependency [tree](showdependencytree.cgi?id=19086&hide_resolved=1) / [graph](showdependencygraph.cgi?id=19086) | |  | | Reported: | 2017-08-11 10:57 UTC by Jiaky Ooi | | --- | --- | | Modified: | 2019-10-14 19:58 UTC ([History](show_activity.cgi?id=19086)) | | CC List: | 9 users (show)  amit.gupta amitddng135 fridolin.somers jonathan.druart kyle m.de.rooy mtj nick tomascohen | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Change sponsored?:](page.cgi?id=fields.html#cf_sponsorship "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Patch complexity:](page.cgi?id=fields.html#cf_patch_complexity "A custom Drop Down field in this installation of Bugzilla.") | Small patch | | [Documentation contact:](page.cgi?id=fields.html#cf_docs_contact "The person taking responsibility for documenting the change introduced in this bug.") |  | | [Documentation submission:](page.cgi?id=fields.html#cf_manual "gitlab merge request url for this documentation submission") |  | | [Text to go in the release notes:](page.cgi?id=fields.html#cf_release_notes "A custom Large Text Box field in this installation of Bugzilla.") |  | | [Version(s) released in:](page.cgi?id=fields.html#cf_release_version "A custom Large Text Box field in this installation of Bugzilla.") |  | | [Circulation function:](page.cgi?id=fields.html#cf_circulation_subcomponent "A custom Multiple-Selection Box field in this installation of Bugzilla.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**Bug 19086 XSS in members/member.pl**](attachment.cgi?id=65927 "View the content of the attachment") (1.65 KB, patch)  [2017-08-11 19:42 UTC](#attach_65927 "Go to the comment associated with the attachment"), Chris Cormack | [Details](attachment.cgi?id=65927&action=edit) | [Diff](attachment.cgi?id=65927&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=65927) | | [**Bug 19086 Stored XSS in circulation.pl**](attachment.cgi?id=65929 "View the content of the attachment") (1.77 KB, patch)  [2017-08-11 19:56 UTC](#attach_65929 "Go to the comment associated with the attachment"), Chris Cormack | [Details](attachment.cgi?id=65929&action=edit) | [Diff](attachment.cgi?id=65929&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=65929) | | [**Bug 19086 XSS in members/member.pl**](attachment.cgi?id=65958 "View the content of the attachment") (1.71 KB, patch)  [2017-08-14 16:09 UTC](#attach_65958 "Go to the comment associated with the attachment"), Amit Gupta | [Details](attachment.cgi?id=65958&action=edit) | [Diff](attachment.cgi?id=65958&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=65958) | | [**Bug 19086 Stored XSS in circulation.pl**](attachment.cgi?id=65960 "View the content of the attachment") (1.32 KB, patch)  [2017-08-14 16:22 UTC](#attach_65960 "Go to the comment associated with the attachment"), Amit Gupta | [Details](attachment.cgi?id=65960&action=edit) | [Diff](attachment.cgi?id=65960&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=65960) | | [**Bug 19086 Stored XSS in routing-lists.pl**](attachment.cgi?id=65965 "View the content of the attachment") (1.24 KB, patch)  [2017-08-14 16:54 UTC](#attach_65965 "Go to the comment associated with the attachment"), Amit Gupta | [Details](attachment.cgi?id=65965&action=edit) | [Diff](attachment.cgi?id=65965&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=65965) | | [**Bug 19086 Stored XSS in readingrec.pl**](attachment.cgi?id=65966 "View the content of the attachment") (1.39 KB, patch)  [2017-08-14 16:59 UTC](#attach_65966 "Go to the comment associated with the attachment"), Amit Gupta | [Details](attachment.cgi?id=65966&action=edit) | [Diff](attachment.cgi?id=65966&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=65966) | | [**Bug 19086 Stored XSS in notices.pl**](attachment.cgi?id=65967 "View the content of the attachment") (1.17 KB, patch)  [2017-08-14 17:02 UTC](#attach_65967 "Go to the comment associated with the attachment"), Amit Gupta | [Details](attachment.cgi?id=65967&action=edit) | [Diff](attachment.cgi?id=65967&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=65967) | | [**Bug 19086 Stored XSS in maninvoice.pl**](attachment.cgi?id=65968 "View the content of the attachment") (1.21 KB, patch)  [2017-08-14 17:08 UTC](#attach_65968 "Go to the comment associated with the attachment"), Amit Gupta | [Details](attachment.cgi?id=65968&action=edit) | [Diff](attachment.cgi?id=65968&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=65968) | | [**Bug 19086 Stored XSS in boraccount.pl**](attachment.cgi?id=65969 "View the content of the attachment") (1.19 KB, patch)  [2017-08-14 17:13 UTC](#attach_65969 "Go to the comment associated with the attachment"), Amit Gupta | [Details](attachment.cgi?id=65969&action=edit) | [Diff](attachment.cgi?id=65969&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=65969) | | [**Bug 19086 Stored XSS in mancredit.pl**](attachment.cgi?id=65970 "View the content of the attachment") (1.22 KB, patch)  [2017-08-14 17:16 UTC](#attach_65970 "Go to the comment associated with the attachment"), Amit Gupta | [Details](attachment.cgi?id=65970&action=edit) | [Diff](attachment.cgi?id=65970&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=65970) | | [**Bug 19086 Stored XSS in circulation.pl**](attachment.cgi?id=65972 "View the content of the attachment") (1.83 KB, patch)  [2017-08-14 19:24 UTC](#attach_65972 "Go to the comment associated with the attachment"), Amit Gupta | [Details](attachment.cgi?id=65972&action=edit) | [Diff](attachment.cgi?id=65972&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=65972) | | [**Bug 19086 Stored XSS in /cgi-bin/koha/acqui/supplier.pl?op=enter**](attachment.cgi?id=65984 "View the content of the attachment") (3.75 KB, patch)  [2017-08-14 21:10 UTC](#attach_65984 "Go to the comment associated with the attachment"), Amit Gupta | [Details](attachment.cgi?id=65984&action=edit) | [Diff](attachment.cgi?id=65984&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=65984) | | [**Bug 19086 Stored XSS in subscription-add.pl**](attachment.cgi?id=65985 "View the content of the attachment") (1.80 KB, patch)  [2017-08-14 21:21 UTC](#attach_65985 "Go to the comment associated with the attachment"), Amit Gupta | [Details](attachment.cgi?id=65985&action=edit) | [Diff](attachment.cgi?id=65985&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=65985) | | [**Bug 19086 Stored XSS in supplier.pl**](attachment.cgi?id=65986 "View the content of the attachment") (3.76 KB, patch)  [2017-08-14 21:30 UTC](#attach_65986 "Go to the comment associated with the attachment"), Amit Gupta | [Details](attachment.cgi?id=65986&action=edit) | [Diff](attachment.cgi?id=65986&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=65986) | | [**Bug 19086 Stored XSS in subscription-add.pl**](attachment.cgi?id=65987 "View the content of the attachment") (1.86 KB, patch)  [2017-08-14 21:33 UTC](#attach_65987 "Go to the comment associated with the attachment"), Amit Gupta | [Details](attachment.cgi?id=65987&action=edit) | [Diff](attachment.cgi?id=65987&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=65987) | | [**[SIGNED OFF] Bug 19086 XSS in members/member.pl**](attachment.cgi?id=66058 "View the content of the attachment") (1.78 KB, patch)  [2017-08-16 11:08 UTC](#attach_66058 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=66058&action=edit) | [Diff](attachment.cgi?id=66058&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=66058) | | [**[SIGNED OFF] Bug 19086 Stored XSS in circulation.pl**](attachment.cgi?id=66059 "View the content of the attachment") (1.90 KB, patch)  [2017-08-16 11:08 UTC](#attach_66059 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=66059&action=edit) | [Diff](attachment.cgi?id=66059&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=66059) | | [**[SIGNED OFF] Bug 19086 Stored XSS in supplier.pl**](attachment.cgi?id=66060 "View the content of the attachment") (3.83 KB, patch)  [2017-08-16 11:08 UTC](#attach_66060 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=66060&action=edit) | [Diff](attachment.cgi?id=66060&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=66060) | | [**[SIGNED OFF] Bug 19086 Stored XSS in subscription-add.pl**](attachment.cgi?id=66061 "View the content of the attachment") (1.94 KB, patch)  [2017-08-16 11:08 UTC](#attach_66061 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=66061&action=edit) | [Diff](attachment.cgi?id=66061&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=66061) | | [**Bug 19086 - Follow-up - XSS in supplier.tt**](attachment.cgi?id=66062 "View the content of the attachment") (3.20 KB, patch)  [2017-08-16 11:08 UTC](#attach_66062 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=66062&action=edit) | [Diff](attachment.cgi?id=66062&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=66062) | | [**Bug 19086 - Follow-up - subscription-detail.pl**](attachment.cgi?id=66063 "View the content of the attachment") (1.51 KB, patch)  [2017-08-16 11:08 UTC](#attach_66063 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=66063&action=edit) | [Diff](attachment.cgi?id=66063&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=66063) | | [**Bug 19086 XSS in members/member.pl**](attachment.cgi?id=66433 "View the content of the attachment") (1.86 KB, patch)  [2017-08-25 06:13 UTC](#attach_66433 "Go to the comment associated with the attachment"), Marcel de Rooy | [Details](attachment.cgi?id=66433&action=edit) | [Diff](attachment.cgi?id=66433&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=66433) | | [**Bug 19086 Stored XSS in circulation.pl**](attachment.cgi?id=66434 "View the content of the attachment") (1.98 KB, patch)  [2017-08-25 06:13 UTC](#attach_66434 "Go to the comment associated with the attachment"), Marcel de Rooy | [Details](attachment.cgi?id=66434&action=edit) | [Diff](attachment.cgi?id=66434&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=66434) | | [**Bug 19086 Stored XSS in supplier.pl**](attachment.cgi?id=66435 "View the content of the attachment") (3.91 KB, patch)  [2017-08-25 06:13 UTC](#attach_66435 "Go to the comment associated with the attachment"), Marcel de Rooy | [Details](attachment.cgi?id=66435&action=edit) | [Diff](attachment.cgi?id=66435&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=66435) | | [**Bug 19086 Stored XSS in subscription-add.pl**](attachment.cgi?id=66436 "View the content of the attachment") (2.02 KB, patch)  [2017-08-25 06:13 UTC](#attach_66436 "Go to the comment associated with the attachment"), Marcel de Rooy | [Details](attachment.cgi?id=66436&action=edit) | [Diff](attachment.cgi?id=66436&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=66436) | | [**Bug 19086 - Follow-up - XSS in supplier.tt**](attachment.cgi?id=66437 "View the content of the attachment") (3.30 KB, patch)  [2017-08-25 06:13 UTC](#attach_66437 "Go to the comment associated with the attachment"), Marcel de Rooy | [Details](attachment.cgi?id=66437&action=edit) | [Diff](attachment.cgi?id=66437&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=66437) | | [**Bug 19086 - Follow-up - subscription-detail.pl**](attachment.cgi?id=66438 "View the content of the attachment") (1.61 KB, patch)  [2017-08-25 06:13 UTC](#attach_66438 "Go to the comment associated with the attachment"), Marcel de Rooy | [Details](attachment.cgi?id=66438&action=edit) | [Diff](attachment.cgi?id=66438&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=19086&attachment=66438) | | [Show Obsolete](#a0) (21) [View All](attachment.cgi?bugid=19086&action=viewall&hide_obsolete=1)  [Add an attachment](attachment.cgi?bugid=19086&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=19086&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=19086#c0)  Jiaky Ooi    2017-08-11 10:57:53 UTC  ``` The following issues were identified, Koha was installed on ubuntu 16.04 and mySQL with default configuration:  Vulnerability Type: Reflected Cross Site Scripting Affected Product: koha library system Tested Version: 17.05.02 Discovered by: Jiaky Ooi Affected URL: /cgi-bin/koha/members/member.pl Affected Parameter: searchmember   Proof of Concept: Full link for PoC : /cgi-bin/koha/members/member.pl?&searchmember=<script>alert('XSS Payload')</script>   Vulnerability Type: Stored Cross Site Scripting Affected Product: koha library system Tested Version: 17.05.02 Discovered by: Jiaky Ooi Affected URL: 1) /cgi-bin/koha/acqui/supplier.pl?op=enter               2) /cgi-bin/koha/circ/circulation.pl?borrowernumber=[number]               3) /cgi-bin/koha/serials/subscription-add.pl Affected Parameter: 1) company_postal, physical, company_fax, accountnumber, contactposition, contact_fax, contact_notes, notes                     2) borrower_message                     3) Internalnotes, notes   Please be aware that we will publish these vulnerability on the disclosure date when agreed.  Please reserve CVE number for this vulnerability by contacting Mitre. Further information can be found at <https://cve.mitre.org/cve/request_id.html>   I will be happy to provide further information on this vulnerability, including the mechanisms by which it was identified, and any pertinent technical information if required.  Many thanks  _________________________________________________________  Jiaky Ooi | Consultant  Oxford        +44 (0)1865 877 830 Dubai          +971 (0)4 427 0428   London       +44 (0)203 5983740 New York    +1 646-781-7580  E-Mail        jiaky.ooi@dionach.com  Web          www.dionach.com   ® ```  [Comment 1](show_bug.cgi?id=19086#c1)  Chris Cormack    2017-08-11 19:42:29 UTC  ``` Created [attachment 65927](attachment.cgi?id=65927&action=diff "Bug 19086 XSS in members/member.pl") [[details]](attachment.cgi?id=65927&action=edit "Bug 19086 XSS in members/member.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=65927) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") XSS in members/member.pl  To test 1/ hit /cgi-bin/koha/members/member.pl?&searchmember=<script>alert('XSS Payload')</script> 2/ Notice js is executed 3/ Apply patch, reload 4/ js is now escaped ```  [Comment 2](show_bug.cgi?id=19086#c2)  Chris Cormack    2017-08-11 19:56:36 UTC  ``` Created [attachment 65929](attachment.cgi?id=65929&action=diff "Bug 19086 Stored XSS in circulation.pl") [[details]](attachment.cgi?id=65929&action=edit "Bug 19086 Stored XSS in circulation.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=65929) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in circulation.pl  1/ To test add a message to a borrower that contains js 2/ hit /cgi-bin/koha/circ/circulation.pl?borrowernumber=[number]   where number is the borrowernumber of the borrower you set the message   for 3/ Notice js is execute 4/ Apply patch, reload, js is escaped ```  [Comment 3](show_bug.cgi?id=19086#c3)  Chris Cormack    2017-08-11 20:03:14 UTC  ``` 2 left to go,  /cgi-bin/koha/acqui/supplier.pl?op=enter  and  /cgi-bin/koha/serials/subscription-add.pl  I have to go out now tho, so hopefully someone else will grab those ```  [Comment 4](show_bug.cgi?id=19086#c4)  Amit Gupta    2017-08-14 16:09:44 UTC  ``` Created [attachment 65958](attachment.cgi?id=65958&action=diff "Bug 19086 XSS in members/member.pl") [[details]](attachment.cgi?id=65958&action=edit "Bug 19086 XSS in members/member.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=65958) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") XSS in members/member.pl  Tested and work OK. ```  [Comment 5](show_bug.cgi?id=19086#c5)  Amit Gupta    2017-08-14 16:11:46 UTC  ``` Hi Chris,  I am able to execute the java script after applying the patch also. (circulation.pl) ```  [Comment 6](show_bug.cgi?id=19086#c6)  Amit Gupta    2017-08-14 16:17:23 UTC  ``` If we are using HTML::Entities wil able to escape the js. ```  [Comment 7](show_bug.cgi?id=19086#c7)  Amit Gupta    2017-08-14 16:22:33 UTC  ``` Created [attachment 65960](attachment.cgi?id=65960&action=diff "Bug 19086 Stored XSS in circulation.pl") [[details]](attachment.cgi?id=65960&action=edit "Bug 19086 Stored XSS in circulation.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=65960) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in circulation.pl  Used HTML::Entities - Encode or decode strings with HTML entities. ******************************************************************** 1. Hit /cgi-bin/koha/circ/circulation.pl?borrowernumber=xx<script>alert('amit')</script>.    xx - is a borrowernumber 2. Notice the java script is executed. 4. Apply patch. 5. Reload page, and hit the page again /cgi-bin/koha/circ/circulation.pl?borrowernumber=xx<script>alert('amit')</script>.    xx - is a borrowernumber. 6. Notice it is no longer executed. ```  [Comment 8](show_bug.cgi?id=19086#c8)  Amit Gupta    2017-08-14 16:30:23 UTC  ``` Fixed: /cgi-bin/koha/acqui/supplier.pl (Please see bug: [Bug 19089](show_bug.cgi?id=19089 "CLOSED FIXED - XSS issue in supplier.pl page"))  I didn't find any vulnerability in: /cgi-bin/koha/serials/subscription-add.pl  Can you please provide us some screen shots. ```  [Comment 9](show_bug.cgi?id=19086#c9)  Amit Gupta    2017-08-14 16:54:00 UTC  ``` Created [attachment 65965](attachment.cgi?id=65965&action=diff "Bug 19086 Stored XSS in routing-lists.pl") [[details]](attachment.cgi?id=65965&action=edit "Bug 19086 Stored XSS in routing-lists.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=65965) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in routing-lists.pl  1. Hit /cgi-bin/koha/members/routing-lists.pl?borrowernumber=xx<script>alert('XSS Payload')</script>    xx is a borrowernumber 2. Notice java script is execute. 3. Apply patch. 3. Reload page, and hit the page again /cgi-bin/koha/members/routing-lists.pl?borrowernumber=xx<script>alert('XSS Payload')</script>    xx is a borrowernumber 4. Notice it is no longer executed. ```  [Comment 10](show_bug.cgi?id=19086#c10)  Amit Gupta    2017-08-14 16:59:25 UTC  ``` Created [attachment 65966](attachment.cgi?id=65966&action=diff "Bug 19086 Stored XSS in readingrec.pl") [[details]](attachment.cgi?id=65966&action=edit "Bug 19086 Stored XSS in readingrec.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=65966) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in readingrec.pl  1. Hit /cgi-bin/koha/members/readingrec.pl?borrowernumber=xx<script>alert('XSS Payload')</script>    xx is a borrowernumber 2. Notice java script is execute. 3. Apply patch. 4. Reload page, and hit the page again /cgi-bin/koha/members/readingrec.pl?borrowernumber=xx<script>alert('XSS Payload')</script>    xx is a borrowernumber 5. Notice it is no longer executed. ```  [Comment 11](show_bug.cgi?id=19086#c11)  Amit Gupta    2017-08-14 17:02:45 UTC  ``` Created [attachment 65967](attachment.cgi?id=65967&action=diff "Bug 19086 Stored XSS in notices.pl") [[details]](attachment.cgi?id=65967&action=edit "Bug 19086 Stored XSS in notices.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=65967) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in notices.pl  1. Hit /cgi-bin/koha/members/notices.pl?borrowernumber=xx<script>alert('XSS Payload')</script>    xx is a borrowernumber 2. Notice java script is execute. 3. Apply patch. 4. Reload page, and hit the page again /cgi-bin/koha/members/notices.pl?borrowernumber=xx<script>alert('XSS Payload')</script>    xx is a borrowernumber 5. Notice it is no longer executed. ```  [Comment 12](show_bug.cgi?id=19086#c12)  Amit Gupta    2017-08-14 17:08:57 UTC  ``` Created [attachment 65968](attachment.cgi?id=65968&action=diff "Bug 19086 Stored XSS in maninvoice.pl") [[details]](attachment.cgi?id=65968&action=edit "Bug 19086 Stored XSS in maninvoice.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=65968) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in maninvoice.pl  1. Hit /cgi-bin/koha/members/maninvoice.pl?borrowernumber=xx<script>alert('XSS Payload')</script>    xx is a borrowernumber 2. Notice java script is execute. 3. Apply patch. 4. Reload page, and hit the page again /cgi-bin/koha/members/maninvoice.pl?borrowernumber=xx<script>alert('XSS Payload')</script>    xx is a borrowernumber 5. Notice it is no longer executed. ```  [Comment 13](show_bug.cgi?id=19086#c13)  Amit Gupta    2017-08-14 17:13:18 UTC  ``` Created [attachment 65969](attachment.cgi?id=65969&action=diff "Bug 19086 Stored XSS in boraccount.pl") [[details]](attachment.cgi?id=65969&action=edit "Bug 19086 Stored XSS in boraccount.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=65969) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in boraccount.pl  1. Hit /cgi-bin/koha/members/boraccount.pl?borrowernumber=xx<script>alert('XSS Payload')</script>    xx is a borrowernumber 2. Notice java script is execute. 3. Apply patch. 4. Reload page, and hit the page again /cgi-bin/koha/members/boraccount.pl?borrowernumber=xx<script>alert('XSS Payload')</script>    xx is a borrowernumber 5. Notice it is no longer executed. ```  [Comment 14](show_bug.cgi?id=19086#c14)  Amit Gupta    2017-08-14 17:16:20 UTC  ``` Created [attachment 65970](attachment.cgi?id=65970&action=diff "Bug 19086 Stored XSS in mancredit.pl") [[details]](attachment.cgi?id=65970&action=edit "Bug 19086 Stored XSS in mancredit.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=65970) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in mancredit.pl  1. Hit /cgi-bin/koha/members/mancredit.pl?borrowernumber=xx<script>alert('XSS Payload')</script>    xx is a borrowernumber 2. Notice java script is execute. 3. Apply patch. 4. Reload page, and hit the page again /cgi-bin/koha/members/mancredit.pl?borrowernumber=xx<script>alert('XSS Payload')</script>    xx is a borrowernumber 5. Notice it is no longer executed. ```  [Comment 15](show_bug.cgi?id=19086#c15)  Chris Cormack    2017-08-14 18:25:19 UTC  ``` Amit the stored ones involve adding js to the database, if you see the test plan it is to do with adding js to a note then hitting the field. Different to passing js as a parameter. ```  [Comment 16](show_bug.cgi?id=19086#c16)  Amit Gupta    2017-08-14 19:24:09 UTC  ``` Created [attachment 65972](attachment.cgi?id=65972&action=diff "Bug 19086 Stored XSS in circulation.pl") [[details]](attachment.cgi?id=65972&action=edit "Bug 19086 Stored XSS in circulation.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=65972) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in circulation.pl  Test and work OK.  I am moving others patches in new bug ```  [Comment 17](show_bug.cgi?id=19086#c17)  Amit Gupta    2017-08-14 19:35:50 UTC  ``` Need to fix 2 more. ```  [Comment 18](show_bug.cgi?id=19086#c18)  Jiaky Ooi    2017-08-14 20:43:15 UTC  ``` (In reply to Amit Gupta from [comment #8](show_bug.cgi?id=19086#c8)) > Fixed: /cgi-bin/koha/acqui/supplier.pl (Please see bug: [Bug 19089](show_bug.cgi?id=19089 "CLOSED FIXED - XSS issue in supplier.pl page")) >  > I didn't find any vulnerability in: /cgi-bin/koha/serials/subscription-add.pl >  > Can you please provide us some screen shots.  Hi Amit,  Apologies I am trying to reproduce this at the moment but my resources are at a different office.  Please allow me up to 24 hours to provide you with an update.  Best regards, Jiaky ```  [Comment 19](show_bug.cgi?id=19086#c19)  Amit Gupta    2017-08-14 21:10:07 UTC  ``` Created [attachment 65984](attachment.cgi?id=65984&action=diff "Bug 19086 Stored XSS in /cgi-bin/koha/acqui/supplier.pl?op=enter") [[details]](attachment.cgi?id=65984&action=edit "Bug 19086 Stored XSS in /cgi-bin/koha/acqui/supplier.pl?op=enter") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=65984) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in /cgi-bin/koha/acqui/supplier.pl?op=enter  1. To test - add a text in the field company_postal, physical, company_fax,    accountnumber, contactposition, contact_fax, contact_notes, notes that contains java script 2. Save the page. 3. Notice js is execute 4. Apply patch and reload the js is escaped ```  [Comment 20](show_bug.cgi?id=19086#c20)  Amit Gupta    2017-08-14 21:21:23 UTC  ``` Created [attachment 65985](attachment.cgi?id=65985&action=diff "Bug 19086 Stored XSS in subscription-add.pl") [[details]](attachment.cgi?id=65985&action=edit "Bug 19086 Stored XSS in subscription-add.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=65985) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in subscription-add.pl  1. To test - add a text in the field Public note and Nonpublic note    that contains js (Internalnotes, notes) 2. Save the page. 3. Notice js is execute 4. Apply patch and reload, the js is escaped ```  [Comment 21](show_bug.cgi?id=19086#c21)  Amit Gupta    2017-08-14 21:21:53 UTC  ``` (In reply to jiakyooi95 from [comment #18](show_bug.cgi?id=19086#c18)) > (In reply to Amit Gupta from [comment #8](show_bug.cgi?id=19086#c8)) > > Fixed: /cgi-bin/koha/acqui/supplier.pl (Please see bug: [Bug 19089](show_bug.cgi?id=19089 "CLOSED FIXED - XSS issue in supplier.pl page")) > >  > > I didn't find any vulnerability in: /cgi-bin/koha/serials/subscription-add.pl > >  > > Can you please provide us some screen shots. >  > Hi Amit, >  > Apologies I am trying to reproduce this at the moment but my resources are > at a different office. >  > Please allow me up to 24 hours to provide you with an update. >  > Best regards, > Jiaky  I have fixed the remaining 2. ```  [Comment 22](show_bug.cgi?id=19086#c22)  Amit Gupta    2017-08-14 21:30:47 UTC  ``` Created [attachment 65986](attachment.cgi?id=65986&action=diff "Bug 19086 Stored XSS in supplier.pl") [[details]](attachment.cgi?id=65986&action=edit "Bug 19086 Stored XSS in supplier.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=65986) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in supplier.pl  Some changes in test case. ***************************** 1. Hit the page /cgi-bin/koha/acqui/supplier.pl?op=enter 2. Add a text in the field company_postal, physical, company_fax,    accountnumber, contactposition, contact_fax, contact_notes, notes that contains java script 3. Save the page. 4. Notice js is execute 5. Apply patch and reload the js is escaped ```  [Comment 23](show_bug.cgi?id=19086#c23)  Amit Gupta    2017-08-14 21:33:27 UTC  ``` Created [attachment 65987](attachment.cgi?id=65987&action=diff "Bug 19086 Stored XSS in subscription-add.pl") [[details]](attachment.cgi?id=65987&action=edit "Bug 19086 Stored XSS in subscription-add.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=65987) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in subscription-add.pl  To Test 1. Hit the page /cgi-bin/koha/serials/subscription-add.pl 2. Add a text in the field Public note and Nonpublic note    that contains js (Internalnotes, notes) 2. Save the page. 3. Notice js is execute 4. Apply patch and reload, the js is escaped ```  [Comment 24](show_bug.cgi?id=19086#c24)  Katrin Fischer    2017-08-16 11:04:47 UTC  ``` For subscription-detail I am not sure - people might have added html to the note fields on purpose to highlight some things in the OPAC more. With the html filter, this won't be permitted. ```  [Comment 25](show_bug.cgi?id=19086#c25)  Katrin Fischer    2017-08-16 11:08:23 UTC  ``` Created [attachment 66058](attachment.cgi?id=66058&action=diff "[SIGNED OFF] Bug 19086 XSS in members/member.pl") [[details]](attachment.cgi?id=66058&action=edit "[SIGNED OFF] Bug 19086 XSS in members/member.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=66058) [SIGNED OFF] [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") XSS in members/member.pl  To test 1/ hit /cgi-bin/koha/members/member.pl?&searchmember=<script>alert('XSS Payload')</script> 2/ Notice js is executed 3/ Apply patch, reload 4/ js is now escaped  Signed-off-by: Amit Gupta <amit.gupta@informaticsglobal.com>  Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de> ```  [Comment 26](show_bug.cgi?id=19086#c26)  Katrin Fischer    2017-08-16 11:08:27 UTC  ``` Created [attachment 66059](attachment.cgi?id=66059&action=diff "[SIGNED OFF] Bug 19086 Stored XSS in circulation.pl") [[details]](attachment.cgi?id=66059&action=edit "[SIGNED OFF] Bug 19086 Stored XSS in circulation.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=66059) [SIGNED OFF] [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in circulation.pl  1/ To test add a message to a borrower that contains js 2/ hit /cgi-bin/koha/circ/circulation.pl?borrowernumber=[number]   where number is the borrowernumber of the borrower you set the message   for 3/ Notice js is execute 4/ Apply patch, reload, js is escaped  Signed-off-by: Amit Gupta <amit.gupta@informaticsglobal.com>  Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de> ```  [Comment 27](show_bug.cgi?id=19086#c27)  Katrin Fischer    2017-08-16 11:08:30 UTC  ``` Created [attachment 66060](attachment.cgi?id=66060&action=diff "[SIGNED OFF] Bug 19086 Stored XSS in supplier.pl") [[details]](attachment.cgi?id=66060&action=edit "[SIGNED OFF] Bug 19086 Stored XSS in supplier.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=66060) [SIGNED OFF] [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in supplier.pl  1. Hit the page /cgi-bin/koha/acqui/supplier.pl?op=enter 2. Add a text in the field company_postal, physical, company_fax,    accountnumber, contactposition, contact_fax, contact_notes, notes that contains java script 3. Save the page. 4. Notice js is execute 5. Apply patch and reload the js is escaped  Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de> ```  [Comment 28](show_bug.cgi?id=19086#c28)  Katrin Fischer    2017-08-16 11:08:34 UTC  ``` Created [attachment 66061](attachment.cgi?id=66061&action=diff "[SIGNED OFF] Bug 19086 Stored XSS in subscription-add.pl") [[details]](attachment.cgi?id=66061&action=edit "[SIGNED OFF] Bug 19086 Stored XSS in subscription-add.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=66061) [SIGNED OFF] [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in subscription-add.pl  To Test 1. Hit the page /cgi-bin/koha/serials/subscription-add.pl 2. Add a text in the field Public note and Nonpublic note    that contains js (Internalnotes, notes) 2. Save the page. 3. Notice js is execute 4. Apply patch and reload, the js is escaped  Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de> ```  [Comment 29](show_bug.cgi?id=19086#c29)  Katrin Fischer    2017-08-16 11:08:37 UTC  ``` Created [attachment 66062](attachment.cgi?id=66062&action=diff "Bug 19086 - Follow-up - XSS in supplier.tt") [[details]](attachment.cgi?id=66062&action=edit "Bug 19086 - Follow-up - XSS in supplier.tt") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=66062) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") - Follow-up - XSS in supplier.tt  In preparation: Make sure you enter <script>alert("sth")</script> in all fields of a new vendor that are not validated and save.  1) Access vendor summary page. 2) Verify scripts are executed 3) Apply patch 4) Verify scripts are on longer executed  This works in combination with the other patches for XSS on this bug. ```  [Comment 30](show_bug.cgi?id=19086#c30)  Katrin Fischer    2017-08-16 11:08:40 UTC  ``` Created [attachment 66063](attachment.cgi?id=66063&action=diff "Bug 19086 - Follow-up - subscription-detail.pl") [[details]](attachment.cgi?id=66063&action=edit "Bug 19086 - Follow-up - subscription-detail.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=66063) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") - Follow-up - subscription-detail.pl  Add script to the callnumber field on adding a subscription.  Verify script is executed without this patch, but not with it. ```  [Comment 31](show_bug.cgi?id=19086#c31)  Marcel de Rooy    2017-08-25 06:12:33 UTC  ``` koha-tmpl/intranet-tmpl/prog/en/modules/acqui/supplier.tt [% name |html %]</a> &rsaquo; Update: [% name %] Forgot the second one here? ```  [Comment 32](show_bug.cgi?id=19086#c32)  Marcel de Rooy    2017-08-25 06:13:04 UTC  ``` Created [attachment 66433](attachment.cgi?id=66433&action=diff "Bug 19086 XSS in members/member.pl") [[details]](attachment.cgi?id=66433&action=edit "Bug 19086 XSS in members/member.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=66433) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") XSS in members/member.pl  To test 1/ hit /cgi-bin/koha/members/member.pl?&searchmember=<script>alert('XSS Payload')</script> 2/ Notice js is executed 3/ Apply patch, reload 4/ js is now escaped  Signed-off-by: Amit Gupta <amit.gupta@informaticsglobal.com>  Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>  Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl> ```  [Comment 33](show_bug.cgi?id=19086#c33)  Marcel de Rooy    2017-08-25 06:13:09 UTC  ``` Created [attachment 66434](attachment.cgi?id=66434&action=diff "Bug 19086 Stored XSS in circulation.pl") [[details]](attachment.cgi?id=66434&action=edit "Bug 19086 Stored XSS in circulation.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=66434) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in circulation.pl  1/ To test add a message to a borrower that contains js 2/ hit /cgi-bin/koha/circ/circulation.pl?borrowernumber=[number]   where number is the borrowernumber of the borrower you set the message   for 3/ Notice js is execute 4/ Apply patch, reload, js is escaped  Signed-off-by: Amit Gupta <amit.gupta@informaticsglobal.com>  Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>  Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl> ```  [Comment 34](show_bug.cgi?id=19086#c34)  Marcel de Rooy    2017-08-25 06:13:13 UTC  ``` Created [attachment 66435](attachment.cgi?id=66435&action=diff "Bug 19086 Stored XSS in supplier.pl") [[details]](attachment.cgi?id=66435&action=edit "Bug 19086 Stored XSS in supplier.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=66435) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in supplier.pl  1. Hit the page /cgi-bin/koha/acqui/supplier.pl?op=enter 2. Add a text in the field company_postal, physical, company_fax,    accountnumber, contactposition, contact_fax, contact_notes, notes that contains java script 3. Save the page. 4. Notice js is execute 5. Apply patch and reload the js is escaped  Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>  Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl> ```  [Comment 35](show_bug.cgi?id=19086#c35)  Marcel de Rooy    2017-08-25 06:13:18 UTC  ``` Created [attachment 66436](attachment.cgi?id=66436&action=diff "Bug 19086 Stored XSS in subscription-add.pl") [[details]](attachment.cgi?id=66436&action=edit "Bug 19086 Stored XSS in subscription-add.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=66436) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") Stored XSS in subscription-add.pl  To Test 1. Hit the page /cgi-bin/koha/serials/subscription-add.pl 2. Add a text in the field Public note and Nonpublic note    that contains js (Internalnotes, notes) 2. Save the page. 3. Notice js is execute 4. Apply patch and reload, the js is escaped  Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de>  Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl> ```  [Comment 36](show_bug.cgi?id=19086#c36)  Marcel de Rooy    2017-08-25 06:13:23 UTC  ``` Created [attachment 66437](attachment.cgi?id=66437&action=diff "Bug 19086 - Follow-up - XSS in supplier.tt") [[details]](attachment.cgi?id=66437&action=edit "Bug 19086 - Follow-up - XSS in supplier.tt") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=66437) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") - Follow-up - XSS in supplier.tt  In preparation: Make sure you enter <script>alert("sth")</script> in all fields of a new vendor that are not validated and save.  1) Access vendor summary page. 2) Verify scripts are executed 3) Apply patch 4) Verify scripts are on longer executed  This works in combination with the other patches for XSS on this bug.  Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl> ```  [Comment 37](show_bug.cgi?id=19086#c37)  Marcel de Rooy    2017-08-25 06:13:28 UTC  ``` Created [attachment 66438](attachment.cgi?id=66438&action=diff "Bug 19086 - Follow-up - subscription-detail.pl") [[details]](attachment.cgi?id=66438&action=edit "Bug 19086 - Follow-up - subscription-detail.pl") [[review]](page.cgi?id=splinter.html&bug=19086&attachment=66438) [Bug 19086](show_bug.cgi?id=19086 "CLOSED FIXED - Multiple cross-site scripting vulnerabilities") - Follow-up - subscription-detail.pl  Add script to the callnumber field on adding a subscription.  Verify script is executed without this patch, but not with it.  Signed-off-by: Marcel de Rooy <m.de.rooy@rijksmuseum.nl> ```  [Comment 38](show_bug.cgi?id=19086#c38)  Jiaky Ooi    2017-09-04 15:21:45 UTC  ``` Hello,  Just a quick question please.  As the last comment made on this thread was on the 25th August, and this has been marked as Passed QA, will there be a CVE number assigned to this vulnerability please?  Best regards, Jiaky ```  [Comment 39](show_bug.cgi?id=19086#c39)  Jonathan Druart    2017-09-04 15:40:47 UTC  ``` (In reply to Jiaky Ooi from [comment #38](show_bug.cgi?id=19086#c38)) > As the last comment made on this thread was on the 25th August, and this has > been marked as Passed QA, will there be a CVE number assigned to this > vulnerability please?  Hello Jiaky,  No, no CVE number will be assigned.  The patch is going to be pushed to master and stable branches simultaneously around September 22th. ```  [Comment 40](show_bug.cgi?id=19086#c40)  Katrin Fischer    2017-09-19 20:59:57 UTC  ``` These patches have been pushed to 16.11.x and will be in 16.11.12. ```  [Comment 41](show_bug.cgi?id=19086#c41)  Fridolin Somers    2017-09-22 15:05:29 UTC  ``` These patches have been pushed to 17.05.x and are in 17.05.04. ```  [Comment 42](show_bug.cgi?id=19086#c42)  Amit Gupta    2017-09-25 04:21:15 UTC  ``` *** [Bug 19362](show_bug.cgi?id=19362 "RESOLVED DUPLICATE") has been marked as a duplicate of this bug. *** ```  [Comment 43](show_bug.cgi?id=19086#c43)  Jonathan Druart    2017-09-29 15:46:11 UTC  ``` Pushed to master for 17.11, thanks to everybody involved! ```  [Comment 44](show_bug.cgi?id=19086#c44)  Mason James    2017-11-23 22:02:41 UTC  ``` Pushed to 16.05.x, for 16.05.17 release ```  [Comment 45](show_bug.cgi?id=19086#c45)  Jonathan Druart    2018-06-19 20:42:07 UTC  ``` Interesting thing: on [bug 13618](show_bug.cgi?id=13618 "CLOSED FIXED - Add additional template filter methods and a filter presence test to Koha") it was decided to not escape the patron's messages. So maybe this will be be considered as a bug by some libraries. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=19086)
* - [XML](show_bug.cgi?ctype=xml&id=19086)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=19086)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.2/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=19086&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=19086&GoAheadAndLogIn=1#forgot)
    Login:

    [x]


