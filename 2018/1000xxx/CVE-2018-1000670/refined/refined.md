The provided content describes multiple cross-site scripting (XSS) vulnerabilities in the Koha library system.

**Root cause of vulnerability:**
The root cause is the lack of proper input sanitization and output encoding of user-supplied data in several areas of the Koha application. This allows attackers to inject malicious JavaScript code that is then executed by users who access the affected pages.

**Weaknesses/vulnerabilities present:**
The following XSS vulnerabilities are present:

*   **Reflected XSS:** In the `/cgi-bin/koha/members/member.pl` script, the `searchmember` parameter is vulnerable to reflected XSS.
*   **Stored XSS:** Multiple scripts are vulnerable to stored XSS, including:
    *   `/cgi-bin/koha/acqui/supplier.pl?op=enter` - Multiple parameters like `company_postal`, `physical`, `company_fax`, `accountnumber`, `contactposition`, `contact_fax`, `contact_notes`, and `notes` are vulnerable.
    *   `/cgi-bin/koha/circ/circulation.pl` - The `borrower_message` parameter is vulnerable.
    *   `/cgi-bin/koha/serials/subscription-add.pl` - The `Internalnotes` and `notes` parameters are vulnerable.
    *   `/cgi-bin/koha/members/routing-lists.pl`
    *   `/cgi-bin/koha/members/readingrec.pl`
    *   `/cgi-bin/koha/members/notices.pl`
    *   `/cgi-bin/koha/members/maninvoice.pl`
    *   `/cgi-bin/koha/members/boraccount.pl`
    *   `/cgi-bin/koha/members/mancredit.pl`
    *   `supplier.tt`
    *   `subscription-detail.pl`

**Impact of exploitation:**
Successful exploitation of these vulnerabilities could allow an attacker to:

*   Execute arbitrary JavaScript code in the context of a user's browser session.
*   Steal session cookies or other sensitive information.
*   Perform actions on behalf of the victim user.
*   Deface the application
*   Potentially gain unauthorized access to the system

**Attack vectors:**
The attack vectors for these vulnerabilities are:

*   **Reflected XSS:**  The attacker crafts a malicious URL containing JavaScript code in the `searchmember` parameter and tricks a user into clicking on it.
*   **Stored XSS:** The attacker injects malicious JavaScript code into a vulnerable field that is stored in the database (e.g., when creating a supplier, adding a borrower message, creating a subscription, etc). When a user views the page containing this stored data, the malicious script will be executed.

**Required attacker capabilities/position:**
*   For reflected XSS, the attacker needs to be able to craft a malicious URL and get a user to click on it.
*   For stored XSS, the attacker needs to be able to add content to the application through the vulnerable input fields. This may require an authenticated user account with sufficient privileges to access the affected forms/features.

The vulnerability is addressed by encoding user inputs using `HTML::Entities` to prevent the browser from interpreting injected scripts.