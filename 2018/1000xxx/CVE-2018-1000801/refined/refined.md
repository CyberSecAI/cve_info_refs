```
{
  "CVE-2018-1000801": {
    "description": "The Okular document viewer was susceptible to directory traversal via malformed .okular files (annotated document archives), which could result in the creation of arbitrary files.",
    "root_cause": "The `unpackDocumentArchive()` function in `core/document.cpp` extracts the file extension using `indexOf(QLatin1Char('.'))` which searches for the first dot character. By crafting a malformed .okular file with a `DocumentFileName` containing directory traversal sequences (e.g., `aaa.aaa/../../testXXXXXX.txt`), the temporary file path would become `/tmp/okular_XXXXXX.aaa/../../testXXXXXX.txt`, allowing the attacker to write outside the intended temporary directory.",
    "vulnerabilities": [
      "Directory Traversal"
    ],
    "impact": "A remote attacker could entice a user to open a specially crafted Okular archive, allowing the creation of arbitrary files with the privileges of the process.",
    "attack_vectors": [
      "Maliciously crafted .okular file"
    ],
     "required_capabilities": [
      "Attacker needs to create a malicious .okular file",
      "Victim must open the malicious file with Okular"
     ],
     "additional_information": [
        "The vulnerability is located in the `unpackDocumentArchive()` function within `core/document.cpp`",
        "The temporary file name is created using user-controlled input from the archive leading to the path traversal",
        "The file is created in the temporary folder, unless the filename is crafted maliciously. Temporary files are supposed to be deleted after closing the application, but a crash could prevent the deletion phase.",
        "The fix involves ensuring that the file name does not contain any folders by using `lastIndexOf` instead of `indexOf` when determining the file extension, preventing directory traversal."

      ]
  }
}
```