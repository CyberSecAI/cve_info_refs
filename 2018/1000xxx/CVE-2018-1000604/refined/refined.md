Based on the provided information, here's an analysis of CVE-2018-1000604:

**Root Cause of Vulnerability:**
The Badge Plugin stored and displayed user-provided HTML for badges and summaries without proper sanitization.

**Weaknesses/Vulnerabilities Present:**
- Persisted Cross-Site Scripting (XSS) vulnerability. The plugin allowed users to store malicious HTML in badge content, which would then be displayed within the Jenkins UI without being properly sanitized.

**Impact of Exploitation:**
- An attacker could inject malicious scripts that would execute in the context of other users' browsers when they view the build pages containing the crafted badges or summaries. This could potentially allow the attacker to perform actions on behalf of the victim user, steal session cookies, or perform other malicious activities.

**Attack Vectors:**
- An attacker with the ability to control badge content (which typically involves having permission to configure jobs) can inject malicious HTML into the text or summary fields of a badge through the plugin's interface.

**Required Attacker Capabilities/Position:**
- The attacker needs to have the ability to configure jobs or otherwise control the content of badges or summaries within Jenkins. This typically means having at least "Job/Configure" permissions, or equivalent access to modify the badge content.
- The attacker also needs to have the ability to access the Jenkins instance to inject malicious HTML into the badge content.
- A victim user has to view the build page with the malicious badge content for the XSS payload to execute.

**Additional details:**
- This vulnerability is fixed in version 1.5 of the Badge Plugin by sanitizing the provided HTML using Jenkins Markup Formatter.
- The advisory notes that prior versions (up to and including 1.4) are affected by this vulnerability.
- The description clearly indicates that the vulnerability is a stored/persisted XSS and that the malicious HTML gets executed in the browser when a user accesses a build page with the malicious badge.
- The provided text also gives context on how the plugin works, allowing for custom badges or summaries to be added to a build.