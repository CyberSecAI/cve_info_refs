Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

The vulnerability stems from a lack of proper validation on file extensions when copying files within the CMS Made Simple file manager. Specifically, when a file is copied, the application allows users to specify a destination file name with an arbitrary extension, without checking if the target file type is allowed. This allows an attacker to rename an arbitrary file (e.g., a text file containing malicious php code) to a php file, which would be executed by the server.

**Weaknesses/Vulnerabilities:**

*   **Insufficient File Extension Validation:** The core weakness is the lack of proper input validation on the file extension during file copy operations.
*   **Arbitrary File Copy:** The file manager allows an authenticated user to copy arbitrary file content into a file with an arbitrary extension.

**Impact of Exploitation:**

*   **Remote Code Execution (RCE):** By uploading a file with malicious PHP code (e.g., a webshell), renaming it to a `.php` file, an attacker can execute arbitrary code on the server.
*   **Full System Compromise:** Successful code execution can lead to a complete compromise of the web server and potentially the underlying system, allowing attackers to further escalate privileges, steal data, or install malware.

**Attack Vectors:**

*   **File Manager:** The attack is performed via the CMS Made Simple file manager, which can be accessed by authenticated administrators.
*   **File Upload:** The attacker must first upload a file containing malicious PHP code to the server, e.g. in a .txt format, which avoids extension checks on upload.
*   **File Copy:**  The attacker then copies this uploaded file and renames it to a `.php` file using the file manager's copy functionality.
*   **Web Request:** The attacker then accesses the newly created php file to trigger the execution of the payload and gain code execution.

**Required Attacker Capabilities/Position:**

*   **Authenticated Access:** The attacker needs valid administrator credentials to access the CMS Made Simple admin panel and file manager.
*   **Web Access:** The attacker needs web access to the target CMS Made Simple instance.
*   **Malicious PHP Code:** The attacker needs to prepare a php payload to be uploaded to the server.

**Additional Notes:**

*   The exploit script provided demonstrates how to automate the process, including authentication, uploading the malicious file, copying it to a PHP file, and accessing the resulting shell.
* The CMS Made Simple developers consider this issue as "Won't Fix" arguing that only trusted admins should have file system access. It is their opinion that security should be addressed by the sysadmin via server configuration, and .htaccess rules to block php execution in the uploads folder are provided in the default installation.