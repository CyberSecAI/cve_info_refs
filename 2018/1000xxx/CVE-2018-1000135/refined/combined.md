=== Content from bugzilla.suse.com_224c2019_20250126_064914.html ===


| Bugzilla – Bug 1086263 | VUL-1: CVE-2018-1000135: NetworkManager: Full-tunnel VPN misconfigures DNS servers, leaks private information | Last modified: 2024-05-09 11:06:01 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1086263)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 1086263**](show_bug.cgi?id=1086263)
(CVE-2018-1000135)
- VUL-1: CVE-2018-1000135: NetworkManager: Full-tunnel VPN misconfigures DNS servers, leaks private information

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-1: CVE-2018-1000135: NetworkManager: Full-tunnel VPN misconfigures DNS se...

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2018-1000135 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P4 - Low **Severity**: Minor | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Security Team bot | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://smash.suse.de/issue/202265/> | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | CVSSv3:SUSE:CVE-2018-1000135:5.3:(AV:... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2018-03-21 14:50 UTC by Karol Babioch | | --- | --- | | Modified: | 2024-05-09 11:06 UTC ([History](show_activity.cgi?id=1086263)) | | CC List: | 4 users (show)  abergmann camila.matos smash\_bz songchuan.kang | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | Security Response Team | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=1086263) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=1086263&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=1086263&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1086263#c0)  Karol Babioch   2018-03-21 14:50:54 UTC  ``` rh#1553634  GNOME NetworkManager version 1.10.2 and earlier contains a Information Exposure (CWE-200) vulnerability in DNS resolver that can result in Private DNS queries leaked to local network's DNS servers, while on VPN. This vulnerability appears to have been fixed in Some Ubuntu 16.04 packages were fixed, but later updates removed the fix. cf. [https://bugs.launchpad.net/ubuntu/+bug/1754671](https://bugs.launchpad.net/ubuntu/%2Bbug/1754671) an upstream fix does not appear to be available at this time.  References: <https://bugzilla.redhat.com/show_bug.cgi?id=1558238> <https://bugzilla.redhat.com/show_bug.cgi?id=1553634> <http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2018-1000135> <http://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-1000135.html> <https://bugzilla.gnome.org/show_bug.cgi?id=746422> [https://bugs.launchpad.net/ubuntu/+source/network-manager/+bug/1754671](https://bugs.launchpad.net/ubuntu/%2Bsource/network-manager/%2Bbug/1754671) ``` [Comment 2](show_bug.cgi?id=1086263#c2)  Jonathan Kang   2019-04-26 06:58:04 UTC  ``` Fix has been backported[1] to SUSE:SLE-15:Update/NetworkManager. We ship 1.0.12 in SLE 12, which is many versions behind 1.10, and I don't think there is a way of backporting it to 1.0.x.  *[1] <https://build.suse.de/request/show/191389> ``` [Comment 3](show_bug.cgi?id=1086263#c3)  Swamp Workflow Management   2019-05-28 19:11:15 UTC  ``` SUSE-SU-2019:1369-1: An update that fixes one vulnerability is now available.  Category: security (moderate) Bug References: 1086263 CVE References: CVE-2018-1000135 Sources used: SUSE Linux Enterprise Workstation Extension 15 (src):    NetworkManager-1.10.6-5.6.1 SUSE Linux Enterprise Module for Open Buildservice Development Tools 15 (src):    NetworkManager-1.10.6-5.6.1 SUSE Linux Enterprise Module for Desktop Applications 15 (src):    NetworkManager-1.10.6-5.6.1 SUSE Linux Enterprise Module for Basesystem 15 (src):    NetworkManager-1.10.6-5.6.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 4](show_bug.cgi?id=1086263#c4)  Swamp Workflow Management   2019-06-03 10:17:45 UTC  ``` openSUSE-SU-2019:1494-1: An update that fixes one vulnerability is now available.  Category: security (moderate) Bug References: 1086263 CVE References: CVE-2018-1000135 Sources used: openSUSE Leap 15.0 (src):    NetworkManager-1.10.6-lp150.4.6.1 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=1086263)
* - [XML](show_bug.cgi?ctype=xml&id=1086263)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=1086263)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1086263)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from bugs.launchpad.net_cf48e17e_20250125_064706.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[network-manager package](https://launchpad.net/ubuntu/%2Bsource/network-manager)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/network-manager)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/network-manager)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/network-manager)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/network-manager)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/network-manager)

# Full-tunnel VPN DNS leakage regression

Bug #1754671 reported by
[dwmw2](https://launchpad.net/~dwmw2)
on 2018-03-09

[562](/%2Bhelp-bugs/bug-heat.html)

This bug affects 157 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [NetworkManager](https://bugs.launchpad.net/network-manager) | Expired | Medium | [auto-bugzilla.gnome.org #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422) |  |
|  | [network-manager (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/network-manager "Latest release: 1.50.0-1ubuntu3, uploaded to main on 2025-01-22 14:09:10.558552+00:00 by Lukas Märdian (slyon), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | High | Unassigned |  |
|  | [Xenial](https://bugs.launchpad.net/ubuntu/xenial/%2Bsource/network-manager) | Won't Fix | Undecided | Unassigned |  |
|  | [Bionic](https://bugs.launchpad.net/ubuntu/bionic/%2Bsource/network-manager) | Fix Released | High | [Till Kamppeter](https://launchpad.net/~till-kamppeter) |  |
|  | [Cosmic](https://bugs.launchpad.net/ubuntu/cosmic/%2Bsource/network-manager) | Fix Released | High | Unassigned |  |
|  | [systemd (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/systemd "Latest release: 257.1-7ubuntu1, uploaded to main on 2025-01-07 17:05:11.304679+00:00 by Nick Rosbrook (enr0n), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | High | Unassigned |  |
|  | [Xenial](https://bugs.launchpad.net/ubuntu/xenial/%2Bsource/systemd) | Won't Fix | Undecided | Unassigned |  |
|  | [Bionic](https://bugs.launchpad.net/ubuntu/bionic/%2Bsource/systemd) | Fix Released | High | [Dan Streetman](https://launchpad.net/~ddstreet) |  |
|  | [Cosmic](https://bugs.launchpad.net/ubuntu/cosmic/%2Bsource/systemd) | Fix Released | High | [Dan Streetman](https://launchpad.net/~ddstreet) |  |

### Bug Description

[Impact]

When using a VPN the DNS requests might still be sent to a DNS server outside the VPN when they should not

[Test case]

1) Set up a VPN with split tunneling:

  a) Configure VPN normally (set up remote host, any ports and options needed for the VPN to work)

  b) Under the IPv4 tab: enable "Use this connection only for the resources on its network".

  c) Under the IPv6 tab: enable "Use this connection only for the resources on its network".

2) Connect to the VPN.

3) Run 'systemd-resolve --status'; note the DNS servers configured:

  a) For the VPN; under a separate link (probably tun0), note down the IP of the DNS server(s). Also note the name of the interface (link).

  b) For the "main" connection; under the link for your ethernet or wireless devices (wl\*, en\*, whatever it may be), note down the IP of the DNS server(s). Also note the name of the interface (link).

4) In a separate terminal, run 'sudo tcpdump -ni <the main interface> port 53'; let it run.

5) In a separate terminal, run 'sudo tcpdump -ni <the VPN interface> port 53'; let it run.

6) In yet another terminal, issue name resolution requests using dig:

  a) For a name known to be reachable via the public network:

     'dig www.yahoo.com'

  b) For a name known to be reachable only via the VPN:

     'dig <some DNS behind the VPN>'

7) Check the output of each terminal running tcpdump. When requesting the public name, traffic can go through either. When requesting the "private" name (behind the VPN), traffic should only be going through the interface for the VPN. Additionally, ensure the IP receiving the requests for the VPN name is indeed the IP address noted above for the VPN's DNS server.

If you see no traffic showing in tcpdump output when requesting a name, it may be because it is cached by systemd-resolved. Use a different name you have not tried before.

[Regression potential]

The code change the handling of DNS servers when using a VPN, we should check that name resolution still work whne using a VPN in different configurations

-----------------

In 16.04 the NetworkManager package used to carry this patch:

[http://bazaar.launchpad.net/~network-manager/network-manager/ubuntu/view/head:/debian/patches/Filter-DNS-servers-to-add-to-dnsmasq-based-on-availa.patch](http://bazaar.launchpad.net/~network-manager/network-manager/ubuntu/view/head%3A/debian/patches/Filter-DNS-servers-to-add-to-dnsmasq-based-on-availa.patch)

It fixed the DNS setup so that when I'm on the VPN, I am not sending unencrypted DNS queries to the (potentially hostile) local nameservers.

This patch disappeared in an update. I think it was present in 1.2.2-0ubuntu0.16.04.4 but was dropped some time later.

This security bug exists upstream too: <https://bugzilla.gnome.org/show_bug.cgi?id=746422>

It's not a \*regression\* there though, as they didn't fix it yet (unfortunately!)

See [original description](comments/0)

Tags:

[regression-update](/ubuntu/%2Bsource/network-manager/%2Bbugs?field.tag=regression-update)
[verification-done-bionic](/ubuntu/%2Bsource/network-manager/%2Bbugs?field.tag=verification-done-bionic)
[verification-done](/ubuntu/%2Bsource/network-manager/%2Bbugs?field.tag=verification-done)
[xenial](/ubuntu/%2Bsource/network-manager/%2Bbugs?field.tag=xenial)

## CVE References

* [2018-1000135](/bugs/cve/2018-1000135 "GNOME NetworkManager version 1.10.2 a...")

[dwmw2 (dwmw2)](https://launchpad.net/~dwmw2)
on 2018-03-09

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mathieu Trudel-Lapierre (cyphermox)](https://launchpad.net/~cyphermox) wrote on 2018-03-09: |  |  | [#1](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/1) |
| --- | --- | --- | --- |

Confirming this is broken. Dropping the patch 0001-dns-use-DBus-to-make-dnsmasq-nameserver-changes.patch in network-manager (1.2.4-0ubuntu0.16.04.1) was done, but it looks like not all the code in that patch was actually upstream.

Confirming this is broken. Dropping the patch 0001-dns-use-DBus-to-make-dnsmasq-nameserver-changes.patch in network-manager (1.2.4-0ubuntu0.16.04.1) was done, but it looks like not all the code in that patch was actually upstream.

| Changed in network-manager (Ubuntu): | |
| --- | --- |
| **status**: | New → Confirmed |
| **importance**: | Undecided → High |
| **tags**: | added: regression-update |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2018-03-20: |  |  | [#2](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/2) |
| --- | --- | --- | --- |

This is CVE-2018-1000135. For some reason the 'Link to CVE' option above doesn't seem to work.

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1000135>

This is CVE-2018-1000135. For some reason the 'Link to CVE' option above doesn't seem to work.
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1000135

[Will Cooke (willcooke)](https://launchpad.net/~willcooke)
on 2018-03-26

| **tags**: | added: incoming rs-bb- |
| --- | --- |
| **tags**: | added: rls-bb-incomingremoved: incoming rs-bb- |

[Sebastien Bacher (seb128)](https://launchpad.net/~seb128)
on 2018-03-27

| Changed in network-manager (Ubuntu): | |
| --- | --- |
| **assignee**: | nobody → Olivier Tilloy (osomon) |
| **tags**: | removed: rls-bb-incoming |

[Bug Watch Updater (bug-watch-updater)](https://launchpad.net/~bug-watch-updater)
on 2018-03-27

| Changed in network-manager: | |
| --- | --- |
| **importance**: | Unknown → Medium |
| **status**: | Unknown → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Olivier Tilloy (osomon)](https://launchpad.net/~osomon) wrote on 2018-04-10: |  |  | [#3](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/3) |
| --- | --- | --- | --- |

There's active work going on upstream (see <https://bugzilla.gnome.org/show_bug.cgi?id=746422> and <https://cgit.freedesktop.org/NetworkManager/NetworkManager/log/?h=bg/dns-bgo746422>) to fix the issue.

<https://bugzilla.gnome.org/show_bug.cgi?id=746422#c36> explains how.

Once in master, it would probably be doable to backport those changes (including <https://cgit.freedesktop.org/NetworkManager/NetworkManager/commit/?id=b2f306ac3d84283fdebb225079f354afb8c2a752>) to the 1.10 branch, which is what's in bionic (1.10.6-2ubuntu1). Backporting to xenial (currently 1.2.6-0ubuntu0.16.04.2) would likely be an entirely different story.

There's active work going on upstream (see https://bugzilla.gnome.org/show\_bug.cgi?id=746422 and https://cgit.freedesktop.org/NetworkManager/NetworkManager/log/?h=bg/dns-bgo746422) to fix the issue.
https://bugzilla.gnome.org/show\_bug.cgi?id=746422#c36 explains how.
Once in master, it would probably be doable to backport those changes (including https://cgit.freedesktop.org/NetworkManager/NetworkManager/commit/?id=b2f306ac3d84283fdebb225079f354afb8c2a752) to the 1.10 branch, which is what's in bionic (1.10.6-2ubuntu1). Backporting to xenial (currently 1.2.6-0ubuntu0.16.04.2) would likely be an entirely different story.

| 108 comments hidden Loading more comments | [view all 151 comments](?comments=all) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [Lubomir Rintel (lkundrak)](https://launchpad.net/~lkundrak) wrote on 2018-05-14: |  |  | [#112](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/112) |
| --- | --- | --- | --- |

bg/dns-domains-bgo746422 LGTM

bg/dns-domains-bgo746422 LGTM

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [Lubomir Rintel (lkundrak)](https://launchpad.net/~lkundrak) wrote on 2018-05-14: |  |  | [#113](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/113) |
| --- | --- | --- | --- |

That is, bg/dns-bgo746422 LGTM

That is, bg/dns-bgo746422 LGTM

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [Bgalvani (bgalvani)](https://launchpad.net/~bgalvani) wrote on 2018-05-14: |  |  | [#114](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/114) |
| --- | --- | --- | --- |

Merged to master:

<https://cgit.freedesktop.org/NetworkManager/NetworkManager/commit/?id=d9782589248e61c0cb5aec90e3eb62612891116b>

Merged to master:
https://cgit.freedesktop.org/NetworkManager/NetworkManager/commit/?id=d9782589248e61c0cb5aec90e3eb62612891116b

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2018-05-14: |  |  | [#115](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/115) |
| --- | --- | --- | --- |

FWIW the original situation appears to be fairly broken regardless of the security situation. I've lost count of the number of times in my recent travels that the DNS servers of the airport/hotel/etc. in which I find myself are \*not\* directly on the local subnet. And thus aren't accessible as soon as I join the VPN.

If that situation is going to be allowed to persist in any form (especially if it's the default and we have to take special action to give the VPN nameservers top priority), then we should fix that by explicitly adding routes to them, as I've been having to do manually:

$ ip route

default dev vpn0 proto static scope link metric 50

default via 10.246.8.1 dev wlp2s0 proto static metric 600

8.8.4.4 via 10.246.8.1 dev wlp2s0

8.8.8.8 via 10.246.8.1 dev wlp2s0

FWIW the original situation appears to be fairly broken regardless of the security situation. I've lost count of the number of times in my recent travels that the DNS servers of the airport/hotel/etc. in which I find myself are \*not\* directly on the local subnet. And thus aren't accessible as soon as I join the VPN.
If that situation is going to be allowed to persist in any form (especially if it's the default and we have to take special action to give the VPN nameservers top priority), then we should fix that by explicitly adding routes to them, as I've been having to do manually:
$ ip route
default dev vpn0 proto static scope link metric 50
default via 10.246.8.1 dev wlp2s0 proto static metric 600
8.8.4.4 via 10.246.8.1 dev wlp2s0
8.8.8.8 via 10.246.8.1 dev wlp2s0

| 110 comments hidden Loading more comments | [view all 151 comments](?comments=all) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Olivier Tilloy (osomon)](https://launchpad.net/~osomon) wrote on 2018-05-14: |  |  | [#4](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/4) |
| --- | --- | --- | --- |

A fix was merged to the upstream master branch: <https://cgit.freedesktop.org/NetworkManager/NetworkManager/commit/?id=d9782589248e61c0cb5aec90e3eb62612891116b>

A fix was merged to the upstream master branch: https://cgit.freedesktop.org/NetworkManager/NetworkManager/commit/?id=d9782589248e61c0cb5aec90e3eb62612891116b

[Bug Watch Updater (bug-watch-updater)](https://launchpad.net/~bug-watch-updater)
on 2018-05-16

| Changed in network-manager: | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

| 111 comments hidden Loading more comments | [view all 151 comments](?comments=all) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [Olivier Tilloy (osomon)](https://launchpad.net/~osomon) wrote on 2018-10-15: |  |  | [#116](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/116) |
| --- | --- | --- | --- |

(In reply to Beniamino Galvani from comment #45)

> (In reply to Michael Biebl from comment #42)

> > Will those changes be pulled into the nm-1-10 branch as well?

>

> Let's wait until the branch is merged to master and see if there are

> any issues. If there are no complaints, we can think about backporting

> it to a stable branch.

Now that this has been in master and 1.12 for a few months, is this something you would consider backporting to 1.10 ?

(In reply to Beniamino Galvani from comment #45)
> (In reply to Michael Biebl from comment #42)
> > Will those changes be pulled into the nm-1-10 branch as well?
>
> Let's wait until the branch is merged to master and see if there are
> any issues. If there are no complaints, we can think about backporting
> it to a stable branch.
Now that this has been in master and 1.12 for a few months, is this something you would consider backporting to 1.10 ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [Thomas Haller (thaller-1)](https://launchpad.net/~thaller-1) wrote on 2018-10-15: |  |  | [#117](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/117) |
| --- | --- | --- | --- |

(In reply to Olivier Tilloy from comment #51)

> (In reply to Beniamino Galvani from comment #45)

> > (In reply to Michael Biebl from comment #42)

> > > Will those changes be pulled into the nm-1-10 branch as well?

> >

> > Let's wait until the branch is merged to master and see if there are

> > any issues. If there are no complaints, we can think about backporting

> > it to a stable branch.

>

> Now that this has been in master and 1.12 for a few months, is this

> something you would consider backporting to 1.10 ?

Can you describe who would pick up the upstream patches if they get backported?

Would 1.10 branch be far enough?

Would you then rebase to a minor 1.10.z release, or would you just cherry-pick the patches?

(In reply to Olivier Tilloy from comment #51)
> (In reply to Beniamino Galvani from comment #45)
> > (In reply to Michael Biebl from comment #42)
> > > Will those changes be pulled into the nm-1-10 branch as well?
> >
> > Let's wait until the branch is merged to master and see if there are
> > any issues. If there are no complaints, we can think about backporting
> > it to a stable branch.
>
> Now that this has been in master and 1.12 for a few months, is this
> something you would consider backporting to 1.10 ?
Can you describe who would pick up the upstream patches if they get backported?
Would 1.10 branch be far enough?
Would you then rebase to a minor 1.10.z release, or would you just cherry-pick the patches?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2018-10-15: |  |  | [#118](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/118) |
| --- | --- | --- | --- |

I'd like to see them in a Fedora release, which is preferably via a 1.10.z release rather than just cherry-picking the patches.

Also Ubuntu but they basically never fix anything so I suppose that's unlikely. I'd still like it in a 1.10.z release so they don't have any \*excuse\* though.

I'd like to see them in a Fedora release, which is preferably via a 1.10.z release rather than just cherry-picking the patches.
Also Ubuntu but they basically never fix anything so I suppose that's unlikely. I'd still like it in a 1.10.z release so they don't have any \*excuse\* though.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [Sebastien Bacher (seb128)](https://launchpad.net/~seb128) wrote on 2018-10-16: |  |  | [#119](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/119) |
| --- | --- | --- | --- |

@David, I don't think that comment is either constructive or true. We have somewhat limited resources and struggle a bit sometime to keep up with network-manager bugfixes/update but we would backport a fix for this bug to our stable serie if there is one landing in the 1.10 vcs.

@David, I don't think that comment is either constructive or true. We have somewhat limited resources and struggle a bit sometime to keep up with network-manager bugfixes/update but we would backport a fix for this bug to our stable serie if there is one landing in the 1.10 vcs.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [Bgalvani (bgalvani)](https://launchpad.net/~bgalvani) wrote on 2018-10-17: |  |  | [#120](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/120) |
| --- | --- | --- | --- |

The backport is quite complicated due to several changes that made the

DNS code in nm-1-12 diverge from nm-1-10. The th/policy-and-mdns

branch [1] alone changed:

src/dns/nm-dns-dnsmasq.c | 330 +++++++++++++--------------------

 src/dns/nm-dns-manager.c | 581 +++++++++++++++++++++++++++++++++-------------------------

 src/dns/nm-dns-systemd-resolved.c | 219 ++++++++++++++--------

so, unless we decide to also backport that branch, the backport of the

fix requires reimplementing several non-trivial patches on top of

1.10, with the high risk of breaking things.

If we also backport the th/policy-and-mdns branch, we would need to

backport a total of 30+ commits, including mDNS support and related

libnm API.

Any opinions? This latter approach seems doable, but it is a big

change for a minor release.

[1] <https://cgit.freedesktop.org/NetworkManager/NetworkManager/log/?qt=range&q=5eea9be983bd95f5a482e483a438a100b80c716f>

The backport is quite complicated due to several changes that made the
DNS code in nm-1-12 diverge from nm-1-10. The th/policy-and-mdns
branch [1] alone changed:
src/dns/nm-dns-dnsmasq.c | 330 +++++++++++++--------------------
src/dns/nm-dns-manager.c | 581 +++++++++++++++++++++++++++++++++-------------------------
src/dns/nm-dns-systemd-resolved.c | 219 ++++++++++++++--------
so, unless we decide to also backport that branch, the backport of the
fix requires reimplementing several non-trivial patches on top of
1.10, with the high risk of breaking things.
If we also backport the th/policy-and-mdns branch, we would need to
backport a total of 30+ commits, including mDNS support and related
libnm API.
Any opinions? This latter approach seems doable, but it is a big
change for a minor release.
[1] https://cgit.freedesktop.org/NetworkManager/NetworkManager/log/?qt=range&q=5eea9be983bd95f5a482e483a438a100b80c716f

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [Thomas Haller (thaller-1)](https://launchpad.net/~thaller-1) wrote on 2018-10-17: |  |  | [#121](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/121) |
| --- | --- | --- | --- |

(In reply to Beniamino Galvani from comment #55)

>

> Any opinions? This latter approach seems doable, but it is a big

> change for a minor release.

Backporting th/policy-and-mdns too, seems favourable to me. As long, as the cherry-picks are trivial, the result will all be code which is on master and tested for a while already. I'd rather cherry-pick more patches just to make them apply, instead of reimplementing them. YMMV.

(In reply to Beniamino Galvani from comment #55)
>
> Any opinions? This latter approach seems doable, but it is a big
> change for a minor release.
Backporting th/policy-and-mdns too, seems favourable to me. As long, as the cherry-picks are trivial, the result will all be code which is on master and tested for a while already. I'd rather cherry-pick more patches just to make them apply, instead of reimplementing them. YMMV.

| 115 comments hidden Loading more comments | [view all 151 comments](?comments=all) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Gijs Molenaar (gijzelaar)](https://launchpad.net/~gijzelaar) wrote on 2018-10-29: |  |  | [#5](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/5) |
| --- | --- | --- | --- |

Is it possible to upload a fixed package to bionic backports?

Is it possible to upload a fixed package to bionic backports?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [fessmage (fessmage)](https://launchpad.net/~fessmage) wrote on 2018-11-02: |  |  | [#6](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/6) |
| --- | --- | --- | --- |

Same question, will it be backported to Ubuntu 18.04 ?

Same question, will it be backported to Ubuntu 18.04 ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Olivier Tilloy (osomon)](https://launchpad.net/~osomon) wrote on 2018-11-07: |  |  | [#7](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/7) |
| --- | --- | --- | --- |

See the discussion in the upstream bug report. The fix is in the master branch and needs to be backported to the 1.10 series so that we can pick it up in bionic.

See the discussion in the upstream bug report. The fix is in the master branch and needs to be backported to the 1.10 series so that we can pick it up in bionic.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Olivier Tilloy (osomon)](https://launchpad.net/~osomon) wrote on 2018-11-07: |  |  | [#8](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/8) |
| --- | --- | --- | --- |

This is fixed in the 1.12 series of network-manager (1.12.0 release), so cosmic and dingo are not affected.

This is fixed in the 1.12 series of network-manager (1.12.0 release), so cosmic and dingo are not affected.

| Changed in network-manager (Ubuntu): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |
| **assignee**: | Olivier Tilloy (osomon) → nobody |

| 113 comments hidden Loading more comments | [view all 151 comments](?comments=all) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [Olivier Tilloy (osomon)](https://launchpad.net/~osomon) wrote on 2018-11-16: |  |  | [#122](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/122) |
| --- | --- | --- | --- |

I confirm that the Ubuntu desktop team would be interested in picking up the update if this fix and related branches were to be backported to the 1.10 branch.

Is this something we can reasonably expect?

I confirm that the Ubuntu desktop team would be interested in picking up the update if this fix and related branches were to be backported to the 1.10 branch.
Is this something we can reasonably expect?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [Thomas Haller (thaller-1)](https://launchpad.net/~thaller-1) wrote on 2018-11-16: |  |  | [#123](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/123) |
| --- | --- | --- | --- |

it's backported to nm-1-10 branch: <https://cgit.freedesktop.org/NetworkManager/NetworkManager/commit/?id=1e486a721de1fec76c81bfc461671a7fbdae531b>

it's backported to nm-1-10 branch: https://cgit.freedesktop.org/NetworkManager/NetworkManager/commit/?id=1e486a721de1fec76c81bfc461671a7fbdae531b

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [Olivier Tilloy (osomon)](https://launchpad.net/~osomon) wrote on 2018-11-19: |  |  | [#124](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/124) |
| --- | --- | --- | --- |

Excellent, thank you Thomas!

Excellent, thank you Thomas!

| 114 comments hidden Loading more comments | [view all 151 comments](?comments=all) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Olivier Tilloy (osomon)](https://launchpad.net/~osomon) wrote on 2018-11-19: |  |  | [#9](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/9) |
| --- | --- | --- | --- |

The fix was backported to the upstream 1.10 series.

The fix was backported to the upstream 1.10 series.

| 115 comments hidden Loading more comments | [view all 151 comments](?comments=all) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [Bgalvani (bgalvani)](https://launchpad.net/~bgalvani) wrote on 2018-11-20: |  |  | [#125](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/125) |
| --- | --- | --- | --- |

The fix is included also in the 1.10.14 release.

The fix is included also in the 1.10.14 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [Olivier Tilloy (osomon)](https://launchpad.net/~osomon) wrote on 2018-11-20: |  |  | [#126](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/126) |
| --- | --- | --- | --- |

That's handy. The backport to Ubuntu 18.04 is being tracked by [https://bugs.launchpad.net/ubuntu/+source/network-manager/+bug/1754671](https://bugs.launchpad.net/ubuntu/%2Bsource/network-manager/%2Bbug/1754671).

That's handy. The backport to Ubuntu 18.04 is being tracked by https://bugs.launchpad.net/ubuntu/+source/network-manager/+bug/1754671.

| 115 comments hidden Loading more comments | [view all 151 comments](?comments=all) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sebastien Bacher (seb128)](https://launchpad.net/~seb128) wrote on 2018-12-19: |  |  | [#10](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/10) |
| --- | --- | --- | --- |

I've updated the description for the SRU but if someone had a better description of a testcase that would be welcome

I've updated the description for the SRU but if someone had a better description of a testcase that would be welcome

| **description**: | updated |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Brian Murray (brian-murray)](https://launchpad.net/~brian-murray) wrote on 2018-12-21:  [**Please test proposed package**](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/11) |  |  | [#11](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/11) |
| --- | --- | --- | --- |

Hello dwmw2, or anyone else affected,

Accepted network-manager into bionic-proposed. The package will build now and be available at [https://launchpad.net/ubuntu/+source/network-manager/1.10.14-0ubuntu1](https://launchpad.net/ubuntu/%2Bsource/network-manager/1.10.14-0ubuntu1) in a few hours, and then in the -proposed repository.

Please help us by testing this new package. See <https://wiki.ubuntu.com/Testing/EnableProposed> for documentation on how to enable and use -proposed. Your feedback will aid us getting this update out to other Ubuntu users.

If this package fixes the bug for you, please add a comment to this bug, mentioning the version of the package you tested and change the tag from verification-needed-bionic to verification-done-bionic. If it does not fix the bug for you, please add a comment stating that, and change the tag to verification-failed-bionic. In either case, without details of your testing we will not be able to proceed.

Further information regarding the verification process can be found at <https://wiki.ubuntu.com/QATeam/PerformingSRUVerification> . Thank you in advance for helping!

N.B. The updated package will be released to -updates after the bug(s) fixed by this package have been verified and the package has been in -proposed for a minimum of 7 days.

Hello dwmw2, or anyone else affected,
Accepted network-manager into bionic-proposed. The package will build now and be available at https://launchpad.net/ubuntu/+source/network-manager/1.10.14-0ubuntu1 in a few hours, and then in the -proposed repository.
Please help us by testing this new package. See https://wiki.ubuntu.com/Testing/EnableProposed for documentation on how to enable and use -proposed. Your feedback will aid us getting this update out to other Ubuntu users.
If this package fixes the bug for you, please add a comment to this bug, mentioning the version of the package you tested and change the tag from verification-needed-bionic to verification-done-bionic. If it does not fix the bug for you, please add a comment stating that, and change the tag to verification-failed-bionic. In either case, without details of your testing we will not be able to proceed.
Further information regarding the verification process can be found at https://wiki.ubuntu.com/QATeam/PerformingSRUVerification . Thank you in advance for helping!
N.B. The updated package will be released to -updates after the bug(s) fixed by this package have been verified and the package has been in -proposed for a minimum of 7 days.

| Changed in network-manager (Ubuntu Bionic): | |
| --- | --- |
| **status**: | Confirmed → Fix Committed |
| **tags**: | added: verification-needed verification-needed-bionic |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Olivier Tilloy (osomon)](https://launchpad.net/~osomon) wrote on 2018-12-21: |  |  | [#12](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/12) |
| --- | --- | --- | --- |

Please test and share your feedback on this new version here, but refrain from changing the verification-needed-bionic tag for now. This new version includes many changes and we want to give it an extended testing period to ensure no regressions sneak in, before it is published to bionic-updates. Thanks!

Please test and share your feedback on this new version here, but refrain from changing the verification-needed-bionic tag for now. This new version includes many changes and we want to give it an extended testing period to ensure no regressions sneak in, before it is published to bionic-updates. Thanks!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Steve Langasek (vorlon)](https://launchpad.net/~vorlon) wrote on 2018-12-21: |  |  | [#13](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/13) |
| --- | --- | --- | --- |

How does this proposed change relate to LP: [#1726124](/bugs/1726124)? Are users who are currently relying on correct split DNS handling by network-manager+systemd-resolved in bionic going to see this regress and have all DNS requests now sent over the VPN when they aren't supposed to?

How does this proposed change relate to LP: #1726124? Are users who are currently relying on correct split DNS handling by network-manager+systemd-resolved in bionic going to see this regress and have all DNS requests now sent over the VPN when they aren't supposed to?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [fessmage (fessmage)](https://launchpad.net/~fessmage) wrote on 2018-12-24: |  |  | [#14](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/14) |
| --- | --- | --- | --- |

I installed package of network-manager 1.10.14-0ubuntu1 from bionic-proposed, and can confirm that version fixed dns leak: now when vpn connection established it gets `DNS Domain: ~.` in systemd-resolve automatically, so no more needed to manually apply command `systemd-resolve -i tun0 --set-domain=~.`. This positively fix dns leakage, verified by dnsleaktest.com

I installed package of network-manager 1.10.14-0ubuntu1 from bionic-proposed, and can confirm that version fixed dns leak: now when vpn connection established it gets `DNS Domain: ~.` in systemd-resolve automatically, so no more needed to manually apply command `systemd-resolve -i tun0 --set-domain=~.`. This positively fix dns leakage, verified by dnsleaktest.com

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Olivier Tilloy (osomon)](https://launchpad.net/~osomon) wrote on 2019-01-08: |  |  | [#15](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/15) |
| --- | --- | --- | --- |

@Steve (sorry for the late reply): not sure how that relates to [bug #1726124](/bugs/1726124), but in my limited understanding of the changes, they shouldn't regress the split-DNS use case.

Some relevant pointers to better understand the fixes and their context:

- <https://bugzilla.gnome.org/show_bug.cgi?id=746422> (particularly comments 8 and 26)

- <https://wiki.gnome.org/Projects/NetworkManager/DNS>

- <https://gitlab.freedesktop.org/NetworkManager/NetworkManager/blob/nm-1-10/NEWS>

@Steve (sorry for the late reply): not sure how that relates to bug #1726124, but in my limited understanding of the changes, they shouldn't regress the split-DNS use case.
Some relevant pointers to better understand the fixes and their context:
- https://bugzilla.gnome.org/show\_bug.cgi?id=746422 (particularly comments 8 and 26)
- https://wiki.gnome.org/Projects/NetworkManager/DNS
- https://gitlab.freedesktop.org/NetworkManager/NetworkManager/blob/nm-1-10/NEWS

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2019-02-04: |  |  | [#16](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/16) |
| --- | --- | --- | --- |

network-manager-1.10.14-0ubuntu1 does seem to fix the DNS problem here; thanks.

network-manager-1.10.14-0ubuntu1 does seem to fix the DNS problem here; thanks.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2019-02-04: |  |  | [#17](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/17) |
| --- | --- | --- | --- |

Hm, that didn't last long. Now it isn't looking up \*anything\* in the VPN domains. It's all going to the local VPN server. I don't know what changed.

Hm, that didn't last long. Now it isn't looking up \*anything\* in the VPN domains. It's all going to the local VPN server. I don't know what changed.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2019-02-04: |  |  | [#18](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/18) |
| --- | --- | --- | --- |

Not sure what happened there. It was looking up \*some\* names in the $COMPANY.com domain on the VPN, but others not, consistently. I couldn't see a pattern.

I have manually set ipv4.dns-search="~." and ipv4.dns-priority=-1 and now it does seem to be behaving. However, this shouldn't be necessary. This VPN has non-split routing and shouldn't it have non-split DNS too, by default? I shouldn't have to change the configuration, just to get back to the secure behaviour which used to work.

Not sure what happened there. It was looking up \*some\* names in the $COMPANY.com domain on the VPN, but others not, consistently. I couldn't see a pattern.
I have manually set ipv4.dns-search="~." and ipv4.dns-priority=-1 and now it does seem to be behaving. However, this shouldn't be necessary. This VPN has non-split routing and shouldn't it have non-split DNS too, by default? I shouldn't have to change the configuration, just to get back to the secure behaviour which used to work.

| 108 comments hidden Loading more comments | [view all 151 comments](?comments=all) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2019-02-04: |  |  | [#127](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/127) |
| --- | --- | --- | --- |

I've finally managed to test the Ubuntu 18.04 backport; apologies for the delay.

At first it seemed to work. I tried an internal domain which isn't the main $COMPANY.com and isn't in the default search domains for the VPN, and it worked after the upgrade.

Some hours later, I was unable to get a Kerberos ticket because various other DNS lookups, even within the main $COMPANY.com domain, were being done on the local network and not the VPN.

I manually set ipv4.dns-priority=-1 and ipv4.dns-search=~. but this is a full-tunnel VPN; surely I shouldn't have needed to do that part manually?

(Sebastian, apologies for the somewhat grumpy comment earlier. I am very happy to be proved wrong.)

I've finally managed to test the Ubuntu 18.04 backport; apologies for the delay.
At first it seemed to work. I tried an internal domain which isn't the main $COMPANY.com and isn't in the default search domains for the VPN, and it worked after the upgrade.
Some hours later, I was unable to get a Kerberos ticket because various other DNS lookups, even within the main $COMPANY.com domain, were being done on the local network and not the VPN.
I manually set ipv4.dns-priority=-1 and ipv4.dns-search=~. but this is a full-tunnel VPN; surely I shouldn't have needed to do that part manually?
(Sebastian, apologies for the somewhat grumpy comment earlier. I am very happy to be proved wrong.)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2019-02-04: |  |  | [#128](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/128) |
| --- | --- | --- | --- |

Gr, and apologies too for spelling your name wrong, Sebastien.

Gr, and apologies too for spelling your name wrong, Sebastien.

| 108 comments hidden Loading more comments | [view all 151 comments](?comments=all) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [fessmage (fessmage)](https://launchpad.net/~fessmage) wrote on 2019-02-05: |  |  | [#19](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/19) |
| --- | --- | --- | --- |

@dwmw2, as far as i understand, you should configuring DNS through systemd-resolve only. Try remove your edits from `/etc/NetworkManager/system-connections`, or even delete your connections from NetworkManager interface, and create new. After that, establish vpn connection and see at `systemd-resolve --status`, you should get something like this:

```

Link 3 (tun0)

      Current Scopes: DNS

       LLMNR setting: yes

MulticastDNS setting: no

      DNSSEC setting: no

    DNSSEC supported: no

         DNS Servers: xx.xx.xx.xx

                      xx.xx.xx.xx

          DNS Domain: ~.

Link 2 (enp3s0)

      Current Scopes: DNS

       LLMNR setting: yes

MulticastDNS setting: no

      DNSSEC setting: no

    DNSSEC supported: no

         DNS Servers: 192.168.1.1

          DNS Domain: local.domain

```

Where local.domain was received from DHCP server in local network. In that case you will send DNS requests in local.domain to local DNS server, and all other DNS requests - over VPN. That is expected behaviour. If you get this, but you have needs for redirecting DNS requests for some domain through other route (let's say, requests to local2.domain2, without VPN), you can do this with next command: `systemd-resolve -i enp3s0 --set-domain=local2.domain2`

@dwmw2, as far as i understand, you should configuring DNS through systemd-resolve only. Try remove your edits from `/etc/NetworkManager/system-connections`, or even delete your connections from NetworkManager interface, and create new. After that, establish vpn connection and see at `systemd-resolve --status`, you should get something like this:
```
Link 3 (tun0)
Current Scopes: DNS
LLMNR setting: yes
MulticastDNS setting: no
DNSSEC setting: no
DNSSEC supported: no
DNS Servers: xx.xx.xx.xx
xx.xx.xx.xx
DNS Domain: ~.
Link 2 (enp3s0)
Current Scopes: DNS
LLMNR setting: yes
MulticastDNS setting: no
DNSSEC setting: no
DNSSEC supported: no
DNS Servers: 192.168.1.1
DNS Domain: local.domain
```
Where local.domain was received from DHCP server in local network. In that case you will send DNS requests in local.domain to local DNS server, and all other DNS requests - over VPN. That is expected behaviour. If you get this, but you have needs for redirecting DNS requests for some domain through other route (let's say, requests to local2.domain2, without VPN), you can do this with next command: `systemd-resolve -i enp3s0 --set-domain=local2.domain2`

| 109 comments hidden Loading more comments | [view all 151 comments](?comments=all) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [Bgalvani (bgalvani)](https://launchpad.net/~bgalvani) wrote on 2019-02-05: |  |  | [#129](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/129) |
| --- | --- | --- | --- |

Hi,

can you please attach the log file generated in this way:

# nmcli general logging level trace

 # journalctl -u NetworkManager -f > dns-log.txt &

 # killall -HUP NetworkManager

 # kill %1

when the DNS is wrongly configured? Thanks.

Hi,
can you please attach the log file generated in this way:
# nmcli general logging level trace
# journalctl -u NetworkManager -f > dns-log.txt &
# killall -HUP NetworkManager
# kill %1
when the DNS is wrongly configured? Thanks.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2019-02-05: |  |  | [#130](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/130) |
| --- | --- | --- | --- |

Before I do that, do we agree that I shouldn't have needed to manually set dns-priority and dns-search as described in comment 62, for a VPN connection which is full-tunnel?

Before I do that, do we agree that I shouldn't have needed to manually set dns-priority and dns-search as described in comment 62, for a VPN connection which is full-tunnel?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [Bgalvani (bgalvani)](https://launchpad.net/~bgalvani) wrote on 2019-02-05: |  |  | [#131](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/131) |
| --- | --- | --- | --- |

(In reply to David Woodhouse from comment #65)

> Before I do that, do we agree that I shouldn't have needed to manually set

> dns-priority and dns-search as described in comment 62, for a VPN connection

> which is full-tunnel?

Yes, the full-tunnel VPN should have higher priority.

We have an automated CI test to check this scenario:

<https://github.com/NetworkManager/NetworkManager-ci/blob/master/nmcli/features/dns.feature#L403>

and it seems to be working well.

(In reply to David Woodhouse from comment #65)
> Before I do that, do we agree that I shouldn't have needed to manually set
> dns-priority and dns-search as described in comment 62, for a VPN connection
> which is full-tunnel?
Yes, the full-tunnel VPN should have higher priority.
We have an automated CI test to check this scenario:
https://github.com/NetworkManager/NetworkManager-ci/blob/master/nmcli/features/dns.feature#L403
and it seems to be working well.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2019-02-05: |  |  | [#132](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/132) |
| --- | --- | --- | --- |

Ack, then I will remove those settings and test again. With dnsmasq, OK? This can never work with plain resolv.conf anyway.

Thanks.

Ack, then I will remove those settings and test again. With dnsmasq, OK? This can never work with plain resolv.conf anyway.
Thanks.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [Bgalvani (bgalvani)](https://launchpad.net/~bgalvani) wrote on 2019-02-05: |  |  | [#133](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/133) |
| --- | --- | --- | --- |

(In reply to David Woodhouse from comment #67)

> Ack, then I will remove those settings and test again. With dnsmasq, OK?

Yes, thanks.

(In reply to David Woodhouse from comment #67)
> Ack, then I will remove those settings and test again. With dnsmasq, OK?
Yes, thanks.

| 112 comments hidden Loading more comments | [view all 151 comments](?comments=all) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Taylor Raack (track16)](https://launchpad.net/~track16) wrote on 2019-02-09: |  |  | [#20](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/20) |
| --- | --- | --- | --- |

I can also confirm that the network-manager package version 1.10.14-0ubuntu1 from bionic-proposed fixes the issue.

I can also confirm that the network-manager package version 1.10.14-0ubuntu1 from bionic-proposed fixes the issue.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2019-03-08: |  |  | [#21](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/21) |
| --- | --- | --- | --- |

Is there a 16.04 package? This was a regression there caused by an earlier update.

I have users reporting the same bizarre behaviour I wasn't able to clearly describe before — essentially, DNS being sent out seemingly random interfaces (sometimes VPN, sometimes local). My advice to just install this package \*and\* manually set dns-priority=-1,dns-search=~. and get on with life even though you really shouldn't have to manually set the latter, doesn't work for the 16.04 users...

And yes, when other things stop being on fire I need to undo those settings and try to work out what's going wrong. We aren't using systemd-resolve here because historically it also hasn't worked right while dnsmasq did.

Is there a 16.04 package? This was a regression there caused by an earlier update.
I have users reporting the same bizarre behaviour I wasn't able to clearly describe before — essentially, DNS being sent out seemingly random interfaces (sometimes VPN, sometimes local). My advice to just install this package \*and\* manually set dns-priority=-1,dns-search=~. and get on with life even though you really shouldn't have to manually set the latter, doesn't work for the 16.04 users...
And yes, when other things stop being on fire I need to undo those settings and try to work out what's going wrong. We aren't using systemd-resolve here because historically it also hasn't worked right while dnsmasq did.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sebastien Bacher (seb128)](https://launchpad.net/~seb128) wrote on 2019-03-11: |  |  | [#22](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/22) |
| --- | --- | --- | --- |

@dwmw2, 'This was a regression there caused by an earlier update.' would give some details ont that? you should probably open another report specifically about that if there was a regression in a xenial update

@dwmw2, 'This was a regression there caused by an earlier update.' would give some details ont that? you should probably open another report specifically about that if there was a regression in a xenial update

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2019-03-11: |  |  | [#23](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/23) |
| --- | --- | --- | --- |

@seb128 please see "In 16.04 the NetworkManager package used to carry this patch..." in the bug description above.

@seb128 please see "In 16.04 the NetworkManager package used to carry this patch..." in the bug description above.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mathew Hodson (mhodson)](https://launchpad.net/~mhodson) wrote on 2019-04-01: |  |  | [#24](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/24) |
| --- | --- | --- | --- |

Looking at the upstream bug, it looks like the fix relies on reworking large parts of the code and wouldn't be easy to SRU to Xenial.

Looking at the upstream bug, it looks like the fix relies on reworking large parts of the code and wouldn't be easy to SRU to Xenial.

[Mathew Hodson (mhodson)](https://launchpad.net/~mhodson)
on 2019-04-13

| **tags**: | added: verification-done-bionicremoved: verification-needed verification-needed-bionic |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Steve Langasek (vorlon)](https://launchpad.net/~vorlon) wrote on 2019-04-13: |  |  | [#25](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/25) |
| --- | --- | --- | --- |

Based on comment #12 I am not sure that this is considered "verification-done" by the relevant developers and there was no comment given when the tags were changed. Resetting.

I also think there should be an affirmative test as part of this SRU that the use case I described in comment #13 has not been regressed.

Based on comment #12 I am not sure that this is considered "verification-done" by the relevant developers and there was no comment given when the tags were changed. Resetting.
I also think there should be an affirmative test as part of this SRU that the use case I described in comment #13 has not been regressed.

| **tags**: | added: verification-needed verification-needed-bionicremoved: verification-done-bionic |
| --- | --- |

[Mathieu Trudel-Lapierre (cyphermox)](https://launchpad.net/~cyphermox)
on 2019-05-02

| **description**: | updated |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Till Kamppeter (till-kamppeter)](https://launchpad.net/~till-kamppeter) wrote on 2019-05-08: |  |  | [#26](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/26) |
| --- | --- | --- | --- |

I have now done the test under [Test Case] in the initial description of this bug report.

I have a completely updated (including -proposed) Bionic machine (real iron, a Lenovo X1 Carbon 2nd gen from 2015) with network-manager 1.10.14-0ubuntu1

I have configured the Canonical VPN, both UK and US. I have turned on only the UK one. It is configured to be used only for the internal destinations on both IPv4 and IPv6.

The system in this configuration I have rebooted to be assure that all processes including the kernel are using the newest software.

Then I have followed the instructions of the test case.

When running "dig <a Canonical-internal host name>" I get immediately an answer with exit code 0 ("echo $?"), so the request was successful.

When I look into the "tcpdump" terminals, the host name gets polled through both interfaces, but naturally the answer only comes from the DNS of the VPN.

So to my understanding the bug is not fixed as the private host name gets also sent to the public DNS.

"systemd-resolve --status" lists the VPN DNS first, as link 4 and afterwards the public DNS as link3.

I have now done the test under [Test Case] in the initial description of this bug report.
I have a completely updated (including -proposed) Bionic machine (real iron, a Lenovo X1 Carbon 2nd gen from 2015) with network-manager 1.10.14-0ubuntu1
I have configured the Canonical VPN, both UK and US. I have turned on only the UK one. It is configured to be used only for the internal destinations on both IPv4 and IPv6.
The system in this configuration I have rebooted to be assure that all processes including the kernel are using the newest software.
Then I have followed the instructions of the test case.
When running "dig <a Canonical-internal host name>" I get immediately an answer with exit code 0 ("echo $?"), so the request was successful.
When I look into the "tcpdump" terminals, the host name gets polled through both interfaces, but naturally the answer only comes from the DNS of the VPN.
So to my understanding the bug is not fixed as the private host name gets also sent to the public DNS.
"systemd-resolve --status" lists the VPN DNS first, as link 4 and afterwards the public DNS as link3.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Till Kamppeter (till-kamppeter)](https://launchpad.net/~till-kamppeter) wrote on 2019-05-09: |  |  | [#27](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/27) |
| --- | --- | --- | --- |

* [systemd\_237-3ubuntu10.21\_237-3ubuntu10.22.debdiff](https://bugs.launchpad.net/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/%2Battachment/5262723/%2Bfiles/systemd_237-3ubuntu10.21_237-3ubuntu10.22.debdiff)
  [Edit](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/%2Battachment/5262723)
  (6.3 KiB,
  text/plain)

Good news, the network-manager SRU is not broken or wrong, but an additional SRU, on systemd, is needed to actually fix this bug.

I got a hint from Iain Lane (Laney, thank you very much) to the following fix in systemd upstream:

<https://github.com/systemd/systemd/commit/a97a3b256>

and backported it to Bionic's systemd package (debdiff attached). With the network-manager SRU from -proposed attached plus the patched systemd package installed the problem goes away. If I repeat the test of [Test Case] (after a reboot) the DNS requests to any of the VPN's domains go actually only to the VPN's DNS.

Good news, the network-manager SRU is not broken or wrong, but an additional SRU, on systemd, is needed to actually fix this bug.
I got a hint from Iain Lane (Laney, thank you very much) to the following fix in systemd upstream:
https://github.com/systemd/systemd/commit/a97a3b256
and backported it to Bionic's systemd package (debdiff attached). With the network-manager SRU from -proposed attached plus the patched systemd package installed the problem goes away. If I repeat the test of [Test Case] (after a reboot) the DNS requests to any of the VPN's domains go actually only to the VPN's DNS.

| Changed in systemd (Ubuntu): | |
| --- | --- |
| **status**: | New → Fix Released |
| Changed in systemd (Ubuntu Bionic): | |
| **status**: | New → Triaged |
| Changed in systemd (Ubuntu): | |
| **importance**: | Undecided → High |
| Changed in systemd (Ubuntu Bionic): | |
| **importance**: | Undecided → High |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Timo Aaltonen (tjaalton)](https://launchpad.net/~tjaalton) wrote on 2019-05-10: |  |  | [#28](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/28) |
| --- | --- | --- | --- |

Hello dwmw2, or anyone else affected,

Accepted network-manager into bionic-proposed. The package will build now and be available at [https://launchpad.net/ubuntu/+source/network-manager/1.10.14-0ubuntu2](https://launchpad.net/ubuntu/%2Bsource/network-manager/1.10.14-0ubuntu2) in a few hours, and then in the -proposed repository.

Please help us by testing this new package. See <https://wiki.ubuntu.com/Testing/EnableProposed> for documentation on how to enable and use -proposed. Your feedback will aid us getting this update out to other Ubuntu users.

If this package fixes the bug for you, please add a comment to this bug, mentioning the version of the package you tested and change the tag from verification-needed-bionic to verification-done-bionic. If it does not fix the bug for you, please add a comment stating that, and change the tag to verification-failed-bionic. In either case, without details of your testing we will not be able to proceed.

Further information regarding the verification process can be found at <https://wiki.ubuntu.com/QATeam/PerformingSRUVerification> . Thank you in advance for helping!

N.B. The updated package will be released to -updates after the bug(s) fixed by this package have been verified and the package has been in -proposed for a minimum of 7 days.

Hello dwmw2, or anyone else affected,
Accepted network-manager into bionic-proposed. The package will build now and be available at https://launchpad.net/ubuntu/+source/network-manager/1.10.14-0ubuntu2 in a few hours, and then in the -proposed repository.
Please help us by testing this new package. See https://wiki.ubuntu.com/Testing/EnableProposed for documentation on how to enable and use -proposed. Your feedback will aid us getting this update out to other Ubuntu users.
If this package fixes the bug for you, please add a comment to this bug, mentioning the version of the package you tested and change the tag from verification-needed-bionic to verification-done-bionic. If it does not fix the bug for you, please add a comment stating that, and change the tag to verification-failed-bionic. In either case, without details of your testing we will not be able to proceed.
Further information regarding the verification process can be found at https://wiki.ubuntu.com/QATeam/PerformingSRUVerification . Thank you in advance for helping!
N.B. The updated package will be released to -updates after the bug(s) fixed by this package have been verified and the package has been in -proposed for a minimum of 7 days.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Łukasz Zemczak (sil2100)](https://launchpad.net/~sil2100) wrote on 2019-05-13: |  |  | [#29](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/29) |
| --- | --- | --- | --- |

Will be releasing network-manager without the systemd part for now as it poses no threat to the user.

Will be releasing network-manager without the systemd part for now as it poses no threat to the user.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2019-05-13: |  |  | [#30](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/30) |
| --- | --- | --- | --- |

This bug was fixed in the package network-manager - 1.10.14-0ubuntu2

---------------

network-manager (1.10.14-0ubuntu2) bionic; urgency=medium

[ Till Kamppeter ]

  \* debian/tests/nm: Add gi.require\_version() calls for NetworkManager

    and NMClient to avoid stderr output which fails the test.

[ Iain Lane ]

  \* debian/tests/control: The nm tests need dnsmasq-base and isc-dhcp-client

    too.

network-manager (1.10.14-0ubuntu1) bionic; urgency=medium

\* New stable version (LP: [#1809132](/bugs/1809132)), including:

    - Support private keys encrypted with AES-{192,256}-CBC in libnm

      (LP: [#942856](/bugs/942856))

    - Fix leak of DNS queries to local name servers when connecting to a

      full-tunnel VPN (CVE-2018-1000135) (LP: [#1754671](/bugs/1754671))

  \* Dropped patch applied upstream:

    - debian/patches/CVE-2018-15688.patch

    - debian/patches/e91f1a7d2a6b8400b6b331d5b72287dcb5164a39.patch

  \* Refreshed patches:

    - debian/patches/Don-t-make-NetworkManager-D-Bus-activatable.patch

    - debian/patches/Force-online-state-with-unmanaged-devices.patch

    - debian/patches/Read-system-connections-from-run.patch

    - debian/patches/Update-dnsmasq-parameters.patch

    - debian/patches/libnm-register-empty-NMClient-and-NetworkManager-when-loa.patch

-- Till Kamppeter <email address hidden> Fri, 10 May 2019 13:34:00 +0200

This bug was fixed in the package network-manager - 1.10.14-0ubuntu2
---------------
network-manager (1.10.14-0ubuntu2) bionic; urgency=medium
[ Till Kamppeter ]
\* debian/tests/nm: Add gi.require\_version() calls for NetworkManager
and NMClient to avoid stderr output which fails the test.
[ Iain Lane ]
\* debian/tests/control: The nm tests need dnsmasq-base and isc-dhcp-client
too.
network-manager (1.10.14-0ubuntu1) bionic; urgency=medium
\* New stable version (LP: #1809132), including:
- Support private keys encrypted with AES-{192,256}-CBC in libnm
(LP: #942856)
- Fix leak of DNS queries to local name servers when connecting to a
full-tunnel VPN (CVE-2018-1000135) (LP: #1754671)
\* Dropped patch applied upstream:
- debian/patches/CVE-2018-15688.patch
- debian/patches/e91f1a7d2a6b8400b6b331d5b72287dcb5164a39.patch
\* Refreshed patches:
- debian/patches/Don-t-make-NetworkManager-D-Bus-activatable.patch
- debian/patches/Force-online-state-with-unmanaged-devices.patch
- debian/patches/Read-system-connections-from-run.patch
- debian/patches/Update-dnsmasq-parameters.patch
- debian/patches/libnm-register-empty-NMClient-and-NetworkManager-when-loa.patch
-- Till Kamppeter <till.kamppeter@gmail.com> Fri, 10 May 2019 13:34:00 +0200

| Changed in network-manager (Ubuntu Bionic): | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Adam Conrad (adconrad)](https://launchpad.net/~adconrad) wrote on 2019-05-13: |  |  | [#31](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/31) |
| --- | --- | --- | --- |

The original bug report was about a regression in 16.04 with the dnsmasq integration. While I'm glad this got the ball rolling on the bionic networkd integration, let's not forget that we broke xenial? Added a xenial task for network-manager accordingly.

The original bug report was about a regression in 16.04 with the dnsmasq integration. While I'm glad this got the ball rolling on the bionic networkd integration, let's not forget that we broke xenial? Added a xenial task for network-manager accordingly.

| Changed in systemd (Ubuntu Xenial): | |
| --- | --- |
| **status**: | New → Invalid |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2019-05-15: |  |  | [#32](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/32) |
| --- | --- | --- | --- |

I am receiving reports that it isn't fixed in 18.04 either. Users are still seeing DNS lookups on the local network, until they manually edit the VPN config to include:

[ipv4]

dns-priority=-1

dns-search=~.;

I thought that wasn't going to be necessary?

I am receiving reports that it isn't fixed in 18.04 either. Users are still seeing DNS lookups on the local network, until they manually edit the VPN config to include:
[ipv4]
dns-priority=-1
dns-search=~.;
I thought that wasn't going to be necessary?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Till Kamppeter (till-kamppeter)](https://launchpad.net/~till-kamppeter) wrote on 2019-05-15: |  |  | [#33](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/33) |
| --- | --- | --- | --- |

dwmw2, did you apply the systemd fix from comment #27? For this bug to be fixed you need BOTRH the fixed packages of network-manager and systemd.

dwmw2, did you apply the systemd fix from comment #27? For this bug to be fixed you need BOTRH the fixed packages of network-manager and systemd.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2019-05-15: |  |  | [#34](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/34) |
| --- | --- | --- | --- |

These systems are using dnsmasq not systemd-resolver. This was done for historical reasons; I'm not sure of the specific bug which caused that choice.

These systems are using dnsmasq not systemd-resolver. This was done for historical reasons; I'm not sure of the specific bug which caused that choice.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Till Kamppeter (till-kamppeter)](https://launchpad.net/~till-kamppeter) wrote on 2019-05-22: |  |  | [#35](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/35) |
| --- | --- | --- | --- |

Unfortunately, the SRU for systemd did not yet get processed. Therefore I have now uploaded this version of systemd to my PPA so that you can already test/get your problem solved. Please tell here whether it actually fixes the bug.

Here is my PPA:

[https://launchpad.net/~till-kamppeter/+archive/ubuntu/ppa](https://launchpad.net/~till-kamppeter/%2Barchive/ubuntu/ppa)

Please follow this link, follow the instructions in the section "Adding this PPA to your system", then update your system with the command

sudo apt dist-upgrade

This will update only systemd as I did not upload any other package for Bionic to my PPA.

Make also sure you have the update of network-manager (1.10.14-0ubuntu2) installed. Reboot and check whether everything works correctly now.

Unfortunately, the SRU for systemd did not yet get processed. Therefore I have now uploaded this version of systemd to my PPA so that you can already test/get your problem solved. Please tell here whether it actually fixes the bug.
Here is my PPA:
https://launchpad.net/~till-kamppeter/+archive/ubuntu/ppa
Please follow this link, follow the instructions in the section "Adding this PPA to your system", then update your system with the command
sudo apt dist-upgrade
This will update only systemd as I did not upload any other package for Bionic to my PPA.
Make also sure you have the update of network-manager (1.10.14-0ubuntu2) installed. Reboot and check whether everything works correctly now.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2019-05-22: |  |  | [#36](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/36) |
| --- | --- | --- | --- |

We aren't using systemd-resolver for various historical reasons; we are using dnsmasq which should be expected to work. It isn't, but we have manually added the dns-priority=-1;dns-search=~. settings which make it work, as an emergency deployment when the latest NM update broke things for everyone.

We aren't using systemd-resolver for various historical reasons; we are using dnsmasq which should be expected to work. It isn't, but we have manually added the dns-priority=-1;dns-search=~. settings which make it work, as an emergency deployment when the latest NM update broke things for everyone.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Till Kamppeter (till-kamppeter)](https://launchpad.net/~till-kamppeter) wrote on 2019-05-22: |  |  | [#37](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/37) |
| --- | --- | --- | --- |

dwmw2, the systemd fix was mainly meant for people with standard configuration where this fix is actually needed and solve the problem.

You are writing that adding "dns-priority=-1;dns-search=~." solves the problem for you. Where/to which file did you add this? Do you need this already with the original network-manager version of Bionic (1.10.6) or do you only need ot after the update (1.10.14)?

dwmw2, the systemd fix was mainly meant for people with standard configuration where this fix is actually needed and solve the problem.
You are writing that adding "dns-priority=-1;dns-search=~." solves the problem for you. Where/to which file did you add this? Do you need this already with the original network-manager version of Bionic (1.10.6) or do you only need ot after the update (1.10.14)?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2019-05-22: |  |  | [#38](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/38) |
| --- | --- | --- | --- |

This is Bionic.

After last week's update to 1.10.14-0ubuntu2 all my VPN users (who are using dnsmasq) reported that DNS supported working for them while they were on the VPN. Some internal names were looked up correctly, others weren't.

I resolved it for them as follows:

$ sudo nmcli con modify "$COMPANY VPN" ipv4.dns-priority -1 ipv4.dns-search ~.

This matches the observations I made in comment #18 on 2019-02-04.

I believe that with 1.10.6 all $company.com DNS did get sent to the VPN and it was lookups outside the company search domains which were leaked. So it was mostly functional, but insecure. Since 1.10.14 it got worse and many (but not all) of the $company.com lookups are being leaked too. Which is a functional problem.

(For Xenial, my advice to users has been the same since March 2018 when this ticket was first filed: tell apt to hold network-manager\_1.2.2-0ubuntu0.16.04.4\_amd64.deb and don't let it get updated until/unless the regression is fixed.)

This is Bionic.
After last week's update to 1.10.14-0ubuntu2 all my VPN users (who are using dnsmasq) reported that DNS supported working for them while they were on the VPN. Some internal names were looked up correctly, others weren't.
I resolved it for them as follows:
$ sudo nmcli con modify "$COMPANY VPN" ipv4.dns-priority -1 ipv4.dns-search ~.
This matches the observations I made in comment #18 on 2019-02-04.
I believe that with 1.10.6 all $company.com DNS did get sent to the VPN and it was lookups outside the company search domains which were leaked. So it was mostly functional, but insecure. Since 1.10.14 it got worse and many (but not all) of the $company.com lookups are being leaked too. Which is a functional problem.
(For Xenial, my advice to users has been the same since March 2018 when this ticket was first filed: tell apt to hold network-manager\_1.2.2-0ubuntu0.16.04.4\_amd64.deb and don't let it get updated until/unless the regression is fixed.)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Steve Langasek (vorlon)](https://launchpad.net/~vorlon) wrote on 2019-05-22: |  |  | [#39](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/39) |
| --- | --- | --- | --- |

> These systems are using dnsmasq not systemd-resolver.

> This was done for historical reasons; I'm not sure of

> the specific bug which caused that choice.

NetworkManager in Ubuntu 16.04 and earlier defaulted to integrating with dnsmasq. But on 18.04 and later, this integration has been deliberately replaced with integration with systemd-resolved. If you are overriding this default integration to force the use of dnsmasq instead of systemd-resolved, that is likely not a supportable configuration.

In contrast, any bug in the systemd-resolved integration in 18.04 that would force you to work around it by switching to dnsmasq is almost certainly an SRUable bug. If you can find the information about why you switched to dnsmasq, please report this as a bug against systemd (with 'ubuntu-bug systemd') and provide a link to the bug here.

> These systems are using dnsmasq not systemd-resolver.
> This was done for historical reasons; I'm not sure of
> the specific bug which caused that choice.
NetworkManager in Ubuntu 16.04 and earlier defaulted to integrating with dnsmasq. But on 18.04 and later, this integration has been deliberately replaced with integration with systemd-resolved. If you are overriding this default integration to force the use of dnsmasq instead of systemd-resolved, that is likely not a supportable configuration.
In contrast, any bug in the systemd-resolved integration in 18.04 that would force you to work around it by switching to dnsmasq is almost certainly an SRUable bug. If you can find the information about why you switched to dnsmasq, please report this as a bug against systemd (with 'ubuntu-bug systemd') and provide a link to the bug here.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Steve Langasek (vorlon)](https://launchpad.net/~vorlon) wrote on 2019-05-22: |  |  | [#40](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/40) |
| --- | --- | --- | --- |

Due to the SRU regressions reported in LP: [#1829838](/bugs/1829838) and LP: [#1829566](/bugs/1829566), I have reverted this SRU for the moment, restoring network-manager 1.10.6-2ubuntu1.1 to bionic-updates. I am marking this bug verification-failed pending resolution of the reported regressions.

Due to the SRU regressions reported in LP: #1829838 and LP: #1829566, I have reverted this SRU for the moment, restoring network-manager 1.10.6-2ubuntu1.1 to bionic-updates. I am marking this bug verification-failed pending resolution of the reported regressions.

| Changed in network-manager (Ubuntu Bionic): | |
| --- | --- |
| **status**: | Fix Released → In Progress |
| **tags**: | added: verification-failed verification-failed-bionicremoved: verification-needed verification-needed-bionic |

[Dan Streetman (ddstreet)](https://launchpad.net/~ddstreet)
on 2019-05-29

| Changed in systemd (Ubuntu Cosmic): | |
| --- | --- |
| **assignee**: | nobody → Dan Streetman (ddstreet) |
| Changed in systemd (Ubuntu Bionic): | |
| **assignee**: | nobody → Dan Streetman (ddstreet) |
| Changed in systemd (Ubuntu Xenial): | |
| **assignee**: | nobody → Dan Streetman (ddstreet) |
| **assignee**: | Dan Streetman (ddstreet) → nobody |
| Changed in systemd (Ubuntu Cosmic): | |
| **importance**: | Undecided → High |
| **status**: | New → In Progress |
| Changed in systemd (Ubuntu Bionic): | |
| **status**: | Triaged → In Progress |

[Dan Streetman (ddstreet)](https://launchpad.net/~ddstreet)
on 2019-05-29

| **tags**: | added: ddstreet-next |
| --- | --- |

[Timo Aaltonen (tjaalton)](https://launchpad.net/~tjaalton)
on 2019-05-31

| **tags**: | added: verification-needed verification-needed-bionic verification-needed-cosmicremoved: verification-failed verification-failed-bionic |
| --- | --- |
| Changed in systemd (Ubuntu Cosmic): | |
| **status**: | In Progress → Fix Committed |
| Changed in systemd (Ubuntu Bionic): | |
| **status**: | In Progress → Fix Committed |

[Sebastien Bacher (seb128)](https://launchpad.net/~seb128)
on 2019-06-04

| Changed in network-manager (Ubuntu Bionic): | |
| --- | --- |
| **assignee**: | Olivier Tilloy (osomon) → Till Kamppeter (till-kamppeter) |
| Changed in network-manager (Ubuntu Cosmic): | |
| **status**: | New → Won't Fix |

[Till Kamppeter (till-kamppeter)](https://launchpad.net/~till-kamppeter)
on 2019-06-06

| **tags**: | added: verification-done verification-done-bionicremoved: verification-needed verification-needed-bionic verification-needed-cosmic |
| --- | --- |

[Dan Streetman (ddstreet)](https://launchpad.net/~ddstreet)
on 2019-06-10

| Changed in systemd (Ubuntu Bionic): | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |
| Changed in systemd (Ubuntu Cosmic): | |
| **status**: | Fix Committed → Fix Released |
| **tags**: | removed: ddstreet-next |

[Launchpad Janitor (janitor)](https://launchpad.net/~janitor)
on 2019-07-18

| Changed in network-manager (Ubuntu Xenial): | |
| --- | --- |
| **status**: | New → Confirmed |

| 93 comments hidden Loading more comments | [view all 151 comments](?comments=all) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2019-08-21: |  |  | [#134](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/134) |
| --- | --- | --- | --- |

Without the ipv4.dns-priority and ipv4.dns-search settings being manually set, I see the wired device still being used for its own search domain. This is what causes the problem.

It seems to work for me if I set \*only\* ipv4.dns-priority=-1 though.

My biggest practical problem here was that we had set ipv4.dns-priority and ipv4.dns-search options in an emergency deployment to our users after Ubuntu shipped the 1.10.14 update to 18.04 to fix this... and then when they \*pulled\* the update, new installations got the new config but older NM, and that didn't work correctly either.

I'm going to experiment with \*just\* setting ipv4.dns-priority=-1 and not ipv4.dns-search. Do we expect that to work for everyone, whether they have the updated package or not?

We should be setting ipv4.dns-priority=1 by default for full-tunnel VPNs, but at least if I can find a way to work around it that works for everyone, that'll be an improvement.

Without the ipv4.dns-priority and ipv4.dns-search settings being manually set, I see the wired device still being used for its own search domain. This is what causes the problem.
It seems to work for me if I set \*only\* ipv4.dns-priority=-1 though.
My biggest practical problem here was that we had set ipv4.dns-priority and ipv4.dns-search options in an emergency deployment to our users after Ubuntu shipped the 1.10.14 update to 18.04 to fix this... and then when they \*pulled\* the update, new installations got the new config but older NM, and that didn't work correctly either.
I'm going to experiment with \*just\* setting ipv4.dns-priority=-1 and not ipv4.dns-search. Do we expect that to work for everyone, whether they have the updated package or not?
We should be setting ipv4.dns-priority=1 by default for full-tunnel VPNs, but at least if I can find a way to work around it that works for everyone, that'll be an improvement.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2019-08-21: |  |  | [#135](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/135) |
| --- | --- | --- | --- |

No, ipv4.dns-priority=-1 breaks older NM because there, there's no default routing domain ~. and not even any way to set it. So lookups outside the VPN domains are just refused instead of being leaked to the local nameservers as they were before.

As it happens, we configure our DHCP client to always override the discovered search domains to our corporate AD domain dom.company.com, so I can work around NM's failure to automatically set ipv4.dns-priority=-1 a different way — by manually configuring the VPN with ipv4.dns-domains=dom.company.com;company.com;. That works for both old and new NetworkManager.

No, ipv4.dns-priority=-1 breaks older NM because there, there's no default routing domain ~. and not even any way to set it. So lookups outside the VPN domains are just refused instead of being leaked to the local nameservers as they were before.
As it happens, we configure our DHCP client to always override the discovered search domains to our corporate AD domain dom.company.com, so I can work around NM's failure to automatically set ipv4.dns-priority=-1 a different way — by manually configuring the VPN with ipv4.dns-domains=dom.company.com;company.com;. That works for both old and new NetworkManager.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [Bgalvani (bgalvani)](https://launchpad.net/~bgalvani) wrote on 2019-08-22: |  |  | [#136](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/136) |
| --- | --- | --- | --- |

> My biggest practical problem here was that we had set

> ipv4.dns-priority and ipv4.dns-search options in an emergency

> deployment to our users after Ubuntu shipped the 1.10.14 update to

> 18.04 to fix this... and then when they \*pulled\* the update, new

> installations got the new config but older NM, and that didn't work

> correctly either.

> I'm going to experiment with \*just\* setting ipv4.dns-priority=-1 and

> not ipv4.dns-search. Do we expect that to work for everyone, whether

> they have the updated package or not?

Yes, this should work the same on 1.10.14 and 1.12+ releases.

> We should be setting ipv4.dns-priority=1 by default for full-tunnel

> VPNs, but at least if I can find a way to work around it that works

> for everyone, that'll be an improvement.

Do you mean -1? Why? This will cause an opposite problem: local

queries leaked to the VPN, i.e. I look up nas.myhome and the query

goes through the VPN.

> No, ipv4.dns-priority=-1 breaks older NM because there, there's no default routing domain ~. and not even any way to set it

Which version is 'older'?

> My biggest practical problem here was that we had set
> ipv4.dns-priority and ipv4.dns-search options in an emergency
> deployment to our users after Ubuntu shipped the 1.10.14 update to
> 18.04 to fix this... and then when they \*pulled\* the update, new
> installations got the new config but older NM, and that didn't work
> correctly either.
> I'm going to experiment with \*just\* setting ipv4.dns-priority=-1 and
> not ipv4.dns-search. Do we expect that to work for everyone, whether
> they have the updated package or not?
Yes, this should work the same on 1.10.14 and 1.12+ releases.
> We should be setting ipv4.dns-priority=1 by default for full-tunnel
> VPNs, but at least if I can find a way to work around it that works
> for everyone, that'll be an improvement.
Do you mean -1? Why? This will cause an opposite problem: local
queries leaked to the VPN, i.e. I look up nas.myhome and the query
goes through the VPN.
> No, ipv4.dns-priority=-1 breaks older NM because there, there's no default routing domain ~. and not even any way to set it
Which version is 'older'?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [dwmw2 (dwmw2)](https://launchpad.net/~dwmw2) wrote on 2019-08-22: |  |  | [#137](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/137) |
| --- | --- | --- | --- |

In my case, 'older' is 1.10.6. At this point I'm just trying to get things working for my users on Ubuntu 18.04. So I'm comparing 1.10.6 (the current Ubuntu package) with 1.10.14 (the update, that was briefly shipped in 18.04 updates and then withdrawn).

When the 1.10.14 update went out, it broke our users because lookups for the dom.company.com AD domain were now always going to the local network (because of our dhclient config override). We immediately rolled out a manual setting of ipv4.dns-priority=-1 (yes, not =1) to fix it.

Then the Ubuntu 1.10.14 update was withdrawn, and new installations got 1.10.6 which \*doesn't\* work with ipv4.dns-priority=-1, because there's no ~. routing domain and thus lookups outside the VPN domains don't work at all.

(We don't care about local lookups not working. In fact we'd prefer local lookups \*not\* to work, which might be part of the reason we've overridden the search domain obtained by DHCP. If we could stop \*routing\* to the local network from working, we would. It's an open feature request, I believe.)

But \*because\* I know the search domain on the local physical network will always be just 'dom.company.com', adding that explicitly in the VPN config is enough and I don't need ipv4.dns-priority=-1. Now I have a config that works with both 1.10.6 and 1.10.14. So I can wait for the regressions that caused the 1.10.14 update to be pulled, to get fixed and then maybe later I can set ipv4.dns-priority=-1 again.

Anyway, we now know that the reason my initial testing of the Ubuntu 1.10.14 backport was unsuccessful, was because of the search domain on the \*local\* network. I've been able to work around that, and things are now working OK.

In my case, 'older' is 1.10.6. At this point I'm just trying to get things working for my users on Ubuntu 18.04. So I'm comparing 1.10.6 (the current Ubuntu package) with 1.10.14 (the update, that was briefly shipped in 18.04 updates and then withdrawn).
When the 1.10.14 update went out, it broke our users because lookups for the dom.company.com AD domain were now always going to the local network (because of our dhclient config override). We immediately rolled out a manual setting of ipv4.dns-priority=-1 (yes, not =1) to fix it.
Then the Ubuntu 1.10.14 update was withdrawn, and new installations got 1.10.6 which \*doesn't\* work with ipv4.dns-priority=-1, because there's no ~. routing domain and thus lookups outside the VPN domains don't work at all.
(We don't care about local lookups not working. In fact we'd prefer local lookups \*not\* to work, which might be part of the reason we've overridden the search domain obtained by DHCP. If we could stop \*routing\* to the local network from working, we would. It's an open feature request, I believe.)
But \*because\* I know the search domain on the local physical network will always be just 'dom.company.com', adding that explicitly in the VPN config is enough and I don't need ipv4.dns-priority=-1. Now I have a config that works with both 1.10.6 and 1.10.14. So I can wait for the regressions that caused the 1.10.14 update to be pulled, to get fixed and then maybe later I can set ipv4.dns-priority=-1 again.
Anyway, we now know that the reason my initial testing of the Ubuntu 1.10.14 backport was unsuccessful, was because of the search domain on the \*local\* network. I've been able to work around that, and things are now working OK.

[Bug Watch Updater (bug-watch-updater)](https://launchpad.net/~bug-watch-updater)
on 2019-09-02

| Changed in network-manager: | |
| --- | --- |
| **status**: | Fix Released → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dariusz Gadomski (dgadomski)](https://launchpad.net/~dgadomski) wrote on 2019-10-10: |  |  | [#138](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/138) |
| --- | --- | --- | --- |

* [bionic\_network-manager\_1.10.6-2ubuntu1.2.debdiff](https://bugs.launchpad.net/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/%2Battachment/5296236/%2Bfiles/bionic_network-manager_1.10.6-2ubuntu1.2.debdiff)
  [Edit](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/%2Battachment/5296236)
  (133.0 KiB,
  text/plain)

I have backported what was listed as nm-1-10 fix for the bug in the upstream bugzilla [1].

I have also applied fixes for [bug #1825946](/bugs/1825946) and [bug #1790098](/bugs/1790098) to it.

[1] <https://cgit.freedesktop.org/NetworkManager/NetworkManager/commit/?id=1e486a721de1fec76c81bfc461671a7fbdae531b>

After testing this build for some time (available at ppa:dgadomski/network-manager) I haven't found any problems.

@Till I'd appreciate you having a look at it. Thanks!

I have backported what was listed as nm-1-10 fix for the bug in the upstream bugzilla [1].
I have also applied fixes for bug #1825946 and bug #1790098 to it.
[1] https://cgit.freedesktop.org/NetworkManager/NetworkManager/commit/?id=1e486a721de1fec76c81bfc461671a7fbdae531b
After testing this build for some time (available at ppa:dgadomski/network-manager) I haven't found any problems.
@Till I'd appreciate you having a look at it. Thanks!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Till Kamppeter (till-kamppeter)](https://launchpad.net/~till-kamppeter) wrote on 2019-10-10: |  |  | [#139](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/139) |
| --- | --- | --- | --- |

Great work, thank you very much!

It will need some testing of which I can only test the reproducer in the initial description of this bug report, not any regressions which the first attempt of upstream-update-based SRU, as I could not reproduce these by myself.

So I would say to take this as a new proposed SRU and also ask the reporters of the regressions whether this version does not cause them.

Great work, thank you very much!
It will need some testing of which I can only test the reproducer in the initial description of this bug report, not any regressions which the first attempt of upstream-update-based SRU, as I could not reproduce these by myself.
So I would say to take this as a new proposed SRU and also ask the reporters of the regressions whether this version does not cause them.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mathew Hodson (mhodson)](https://launchpad.net/~mhodson) wrote on 2019-10-12: |  |  | [#140](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/140) |
| --- | --- | --- | --- |

This fix was first included in upstream 1.12.0, so this was actually fixed in Cosmic with network-manager 1.12.2-0ubuntu3

This fix was first included in upstream 1.12.0, so this was actually fixed in Cosmic with network-manager 1.12.2-0ubuntu3

| Changed in network-manager (Ubuntu Cosmic): | |
| --- | --- |
| **importance**: | Undecided → High |
| **status**: | Won't Fix → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Till Kamppeter (till-kamppeter)](https://launchpad.net/~till-kamppeter) wrote on 2019-10-22: |  |  | [#141](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/141) |
| --- | --- | --- | --- |

Sorry for the late reply, I was on a conference last week.

I installed the PPA now and tested with the reproducer of the initial posting. This works for me. Also the machine in general seems to work OK with this version of network-manager.

Thank you very much Dariusz for packaging this version.

So now the 1.10.14 should be removed from -proposed (to avoid need of an epoch), and the version from the PPA of Dariusz should get uploaded into -proposed, and then the reporters of the regressions in the 1.10.14 SRU informed (by comments in their bug reports) for the new SRU being verified.

Could someone from the release team initiate the process by removing 1.10.14 from -proposed? Thanks.

Sorry for the late reply, I was on a conference last week.
I installed the PPA now and tested with the reproducer of the initial posting. This works for me. Also the machine in general seems to work OK with this version of network-manager.
Thank you very much Dariusz for packaging this version.
So now the 1.10.14 should be removed from -proposed (to avoid need of an epoch), and the version from the PPA of Dariusz should get uploaded into -proposed, and then the reporters of the regressions in the 1.10.14 SRU informed (by comments in their bug reports) for the new SRU being verified.
Could someone from the release team initiate the process by removing 1.10.14 from -proposed? Thanks.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Timo Aaltonen (tjaalton)](https://launchpad.net/~tjaalton) wrote on 2019-10-25:  [**Please test proposed package**](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/142) |  |  | [#142](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/142) |
| --- | --- | --- | --- |

Hello dwmw2, or anyone else affected,

Accepted network-manager into bionic-proposed. The package will build now and be available at [https://launchpad.net/ubuntu/+source/network-manager/1.10.6-2ubuntu1.2](https://launchpad.net/ubuntu/%2Bsource/network-manager/1.10.6-2ubuntu1.2) in a few hours, and then in the -proposed repository.

Please help us by testing this new package. See <https://wiki.ubuntu.com/Testing/EnableProposed> for documentation on how to enable and use -proposed. Your feedback will aid us getting this update out to other Ubuntu users.

If this package fixes the bug for you, please add a comment to this bug, mentioning the version of the package you tested and change the tag from verification-needed-bionic to verification-done-bionic. If it does not fix the bug for you, please add a comment stating that, and change the tag to verification-failed-bionic. In either case, without details of your testing we will not be able to proceed.

Further information regarding the verification process can be found at <https://wiki.ubuntu.com/QATeam/PerformingSRUVerification> . Thank you in advance for helping!

N.B. The updated package will be released to -updates after the bug(s) fixed by this package have been verified and the package has been in -proposed for a minimum of 7 days.

Hello dwmw2, or anyone else affected,
Accepted network-manager into bionic-proposed. The package will build now and be available at https://launchpad.net/ubuntu/+source/network-manager/1.10.6-2ubuntu1.2 in a few hours, and then in the -proposed repository.
Please help us by testing this new package. See https://wiki.ubuntu.com/Testing/EnableProposed for documentation on how to enable and use -proposed. Your feedback will aid us getting this update out to other Ubuntu users.
If this package fixes the bug for you, please add a comment to this bug, mentioning the version of the package you tested and change the tag from verification-needed-bionic to verification-done-bionic. If it does not fix the bug for you, please add a comment stating that, and change the tag to verification-failed-bionic. In either case, without details of your testing we will not be able to proceed.
Further information regarding the verification process can be found at https://wiki.ubuntu.com/QATeam/PerformingSRUVerification . Thank you in advance for helping!
N.B. The updated package will be released to -updates after the bug(s) fixed by this package have been verified and the package has been in -proposed for a minimum of 7 days.

| Changed in network-manager (Ubuntu Bionic): | |
| --- | --- |
| **status**: | In Progress → Fix Committed |
| **tags**: | added: verification-needed verification-needed-bionicremoved: verification-done verification-done-bionic |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Ubuntu SRU Bot (ubuntu-sru-bot)](https://launchpad.net/~ubuntu-sru-bot) wrote on 2019-10-25:  [**Autopkgtest regression report (network-manager/1.10.6-2ubuntu1.2)**](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/143) |  |  | [#143](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/143) |
| --- | --- | --- | --- |

All autopkgtests for the newly accepted network-manager (1.10.6-2ubuntu1.2) for bionic have finished running.

The following regressions have been reported in tests triggered by the package:

network-manager/1.10.6-2ubuntu1.2 (amd64, arm64, i386, ppc64el)

systemd/237-3ubuntu10.31 (i386, ppc64el)

netplan.io/0.98-0ubuntu1~18.04.1 (arm64)

Please visit the excuses page listed below and investigate the failures, proceeding afterwards as per the StableReleaseUpdates policy regarding autopkgtest regressions [1].

<https://people.canonical.com/~ubuntu-archive/proposed-migration/bionic/update_excuses.html#network-manager>

[1] <https://wiki.ubuntu.com/StableReleaseUpdates#Autopkgtest_Regressions>

Thank you!

All autopkgtests for the newly accepted network-manager (1.10.6-2ubuntu1.2) for bionic have finished running.
The following regressions have been reported in tests triggered by the package:
network-manager/1.10.6-2ubuntu1.2 (amd64, arm64, i386, ppc64el)
systemd/237-3ubuntu10.31 (i386, ppc64el)
netplan.io/0.98-0ubuntu1~18.04.1 (arm64)
Please visit the excuses page listed below and investigate the failures, proceeding afterwards as per the StableReleaseUpdates policy regarding autopkgtest regressions [1].
https://people.canonical.com/~ubuntu-archive/proposed-migration/bionic/update\_excuses.html#network-manager
[1] https://wiki.ubuntu.com/StableReleaseUpdates#Autopkgtest\_Regressions
Thank you!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Eric Desrochers (slashd)](https://launchpad.net/~slashd) wrote on 2019-10-26: |  |  | [#144](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/144) |
| --- | --- | --- | --- |

The netplan.io (arm64) autopkgtest failure (due to timeout) has been retried today, it passed:

<http://autopkgtest.ubuntu.com/packages/n/netplan.io/bionic/arm64>

No more failure reported in pending sru page.

- Eric

The netplan.io (arm64) autopkgtest failure (due to timeout) has been retried today, it passed:
http://autopkgtest.ubuntu.com/packages/n/netplan.io/bionic/arm64
No more failure reported in pending sru page.
- Eric

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Till Kamppeter (till-kamppeter)](https://launchpad.net/~till-kamppeter) wrote on 2019-10-28: |  |  | [#145](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/145) |
| --- | --- | --- | --- |

Now network-manager is hanging on (all autopkg tests passed):

Not touching package due to block request by freeze (contact #ubuntu-release if update is needed)

Which freeze do we currently have on Bionic?

Now network-manager is hanging on (all autopkg tests passed):
Not touching package due to block request by freeze (contact #ubuntu-release if update is needed)
Which freeze do we currently have on Bionic?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Till Kamppeter (till-kamppeter)](https://launchpad.net/~till-kamppeter) wrote on 2019-10-28: |  |  | [#146](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/146) |
| --- | --- | --- | --- |

No worries about my previous comment, it is solved.

No worries about my previous comment, it is solved.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dariusz Gadomski (dgadomski)](https://launchpad.net/~dgadomski) wrote on 2019-10-31: |  |  | [#147](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/147) |
| --- | --- | --- | --- |

I have just run the test case from this bug description on the bionic-proposed version 1.10.6-2ubuntu1.2.

tcpdump does not show any leak of the VPN-specific queries. I have not observed other issues in my tests.

I have just run the test case from this bug description on the bionic-proposed version 1.10.6-2ubuntu1.2.
tcpdump does not show any leak of the VPN-specific queries. I have not observed other issues in my tests.

| **tags**: | added: verification-done verification-done-bionicremoved: verification-needed verification-needed-bionic |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2019-11-04: |  |  | [#148](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/148) |
| --- | --- | --- | --- |

This bug was fixed in the package network-manager - 1.10.6-2ubuntu1.2

---------------

network-manager (1.10.6-2ubuntu1.2) bionic; urgency=medium

[ Till Kamppeter ]

  \* debian/tests/nm: Add gi.require\_version() calls for NetworkManager

    and NMClient to avoid stderr output which fails the test. (LP: [#1825946](/bugs/1825946))

[ Dariusz Gadomski ]

  \* d/p/fix-dns-leak-lp1754671.patch: backport of DNS leak fix. (LP: [#1754671](/bugs/1754671))

  \* d/p/lp1790098.patch: retry activating devices when the parent becomes

    managed. (LP: [#1790098](/bugs/1790098))

-- Dariusz Gadomski <email address hidden> Sat, 07 Sep 2019 16:10:59 +0200

This bug was fixed in the package network-manager - 1.10.6-2ubuntu1.2
---------------
network-manager (1.10.6-2ubuntu1.2) bionic; urgency=medium
[ Till Kamppeter ]
\* debian/tests/nm: Add gi.require\_version() calls for NetworkManager
and NMClient to avoid stderr output which fails the test. (LP: #1825946)
[ Dariusz Gadomski ]
\* d/p/fix-dns-leak-lp1754671.patch: backport of DNS leak fix. (LP: #1754671)
\* d/p/lp1790098.patch: retry activating devices when the parent becomes
managed. (LP: #1790098)
-- Dariusz Gadomski <dariusz.gadomski@canonical.com> Sat, 07 Sep 2019 16:10:59 +0200

| Changed in network-manager (Ubuntu Bionic): | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Łukasz Zemczak (sil2100)](https://launchpad.net/~sil2100) wrote on 2019-11-04:  [**Update Released**](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/149) |  |  | [#149](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/149) |
| --- | --- | --- | --- |

The verification of the Stable Release Update for network-manager has completed successfully and the package is now being released to -updates. Subsequently, the Ubuntu Stable Release Updates Team is being unsubscribed and will not receive messages about this bug report. In the event that you encounter a regression using the package from -updates please report a new bug using ubuntu-bug and tag the bug report regression-update so we can easily find any regressions.

The verification of the Stable Release Update for network-manager has completed successfully and the package is now being released to -updates. Subsequently, the Ubuntu Stable Release Updates Team is being unsubscribed and will not receive messages about this bug report. In the event that you encounter a regression using the package from -updates please report a new bug using ubuntu-bug and tag the bug report regression-update so we can easily find any regressions.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Joe Hohertz (jhohertz)](https://launchpad.net/~jhohertz) wrote on 2019-11-05: |  |  | [#150](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/150) |
| --- | --- | --- | --- |

1.10.6-2ubuntu1.2 has cause a regression in functionality.

Anyone using a "split" VPN, where there is no default route, AND wish to have DNS services supplied by the server to be honoured, via use of the ipv4.dns-priority parameter, will have this broken. This is a bit of a sore point considering the hoops one has to jump through to make this work at all.

Reverting to previous version restores functionality.

1.10.6-2ubuntu1.2 has cause a regression in functionality.
Anyone using a "split" VPN, where there is no default route, AND wish to have DNS services supplied by the server to be honoured, via use of the ipv4.dns-priority parameter, will have this broken. This is a bit of a sore point considering the hoops one has to jump through to make this work at all.
Reverting to previous version restores functionality.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| In [bugzilla.gnome.org/ #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422), [Andre Klapper (a9016009)](https://launchpad.net/~a9016009) wrote on 2020-11-12: |  |  | [#151](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/comments/151) |
| --- | --- | --- | --- |

bugzilla.gnome.org is being shut down in favor of a GitLab instance.

We are closing all old bug reports and feature requests in GNOME Bugzilla which have not seen updates for a long time.

If you still use NetworkManager and if you still see this bug / want this feature in a recent and supported version of NetworkManager, then please feel free to report it at <https://gitlab.freedesktop.org/NetworkManager/NetworkManager/-/issues/>

Thank you for creating this report and we are sorry it could not be implemented (workforce and time is unfortunately limited).

bugzilla.gnome.org is being shut down in favor of a GitLab instance.
We are closing all old bug reports and feature requests in GNOME Bugzilla which have not seen updates for a long time.
If you still use NetworkManager and if you still see this bug / want this feature in a recent and supported version of NetworkManager, then please feel free to report it at https://gitlab.freedesktop.org/NetworkManager/NetworkManager/-/issues/
Thank you for creating this report and we are sorry it could not be implemented (workforce and time is unfortunately limited).

[Bug Watch Updater (bug-watch-updater)](https://launchpad.net/~bug-watch-updater)
on 2020-11-15

| Changed in network-manager: | |
| --- | --- |
| **status**: | Confirmed → Expired |

[Mathew Hodson (mhodson)](https://launchpad.net/~mhodson)
on 2020-11-15

| Changed in network-manager (Ubuntu Xenial): | |
| --- | --- |
| **status**: | Confirmed → Won't Fix |
| Changed in systemd (Ubuntu Xenial): | |
| **status**: | Invalid → Won't Fix |

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/%2Bactivity)

Displaying first 40
and last 40
comments.
[View all 151
comments](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671?comments=all) or [add a comment](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671?comments=all).

* [Report a bug](/ubuntu/%2Bsource/network-manager/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

## Duplicates of this bug

* [Bug #1634689](https://bugs.launchpad.net/bugs/1634689 "DNS leak after upgrade to 16.10")
* [Bug #1652525](https://bugs.launchpad.net/bugs/1652525 "DNS leak in ubuntu 16.10")
* [Bug #1671606](https://bugs.launchpad.net/ubuntu/%2Bsource/network-manager/%2Bbug/1671606 "DNS server from vpn connection is not being used after network-manager upgrade to 1.2.6-0ubuntu0.16.04.1")
* [Bug #1672491](https://bugs.launchpad.net/ubuntu/%2Bsource/network-manager/%2Bbug/1672491 "New NetworkManager breaks VPN DNS.")
* [Bug #1682227](https://bugs.launchpad.net/bugs/1682227 "dnsmasq, network manager *still* not able to relay DNS queries or respond to DNS requests after VPN connection failure / die off")
* [Bug #1685391](https://bugs.launchpad.net/bugs/1685391 "DNS leak in Xubuntu 17.04")
* [Bug #1688018](https://bugs.launchpad.net/ubuntu/%2Bsource/network-manager/%2Bbug/1688018 "DNS server from vpn connection is not being used after network-manager upgrade to 1.2.6")
* [Bug #1690860](https://bugs.launchpad.net/bugs/1690860 "systemd-resolved does not use DNS servers from DHCP")
* [Bug #1704288](https://bugs.launchpad.net/bugs/1704288 "Ubuntu 16.04 VPN : DNS information leaking  through dnsmasq")
* [Bug #1796648](https://bugs.launchpad.net/ubuntu/%2Bsource/network-manager/%2Bbug/1796648 "network-manager-openvpn leaks DNS information on Ubuntu 18.04")

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [systemd\_237-3ubuntu10.21\_237-3ubuntu10.22.debdiff](https://bugs.launchpad.net/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/%2Battachment/5262723/%2Bfiles/systemd_237-3ubuntu10.21_237-3ubuntu10.22.debdiff)
  [Edit](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/%2Battachment/5262723 "Change patch details")
* [bionic\_network-manager\_1.10.6-2ubuntu1.2.debdiff](https://bugs.launchpad.net/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/%2Battachment/5296236/%2Bfiles/bionic_network-manager_1.10.6-2ubuntu1.2.debdiff)
  [Edit](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/%2Battachment/5296236 "Change patch details")

* [Add patch](/ubuntu/%2Bsource/network-manager/%2Bbug/1754671/%2Baddcomment?field.patch=on)

## Remote bug watches

* [redhat-bugs #1553634](https://bugzilla.redhat.com/show_bug.cgi?id=1553634)

  [CLOSED CURRENTRELEASE]
  [Edit](/bugs/1754671/%2Bwatch/134421 "Change watch details")
* [auto-bugzilla.gnome.org #746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422)

  [RESOLVED OBSOLETE]
  [Edit](/bugs/1754671/%2Bwatch/128442 "Change watch details")

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugzilla.redhat.com_565c403b_20250125_064710.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1553634)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1553634)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1553634)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1553634

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1553634**](show_bug.cgi?id=1553634)
- [CVE-2018-1000135](https://access.redhat.com/security/cve/CVE-2018-1000135) Full-tunnel VPN misconfigures DNS servers, leaks private information

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2018-1000135 Full-tunnel VPN misconfigures DNS servers, leaks private inf...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED CURRENTRELEASE | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Fedora | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Fedora | | [Component:](describecomponents.cgi?product=Fedora "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | NetworkManager | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 27 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | unspecified | | [Severity:](page.cgi?id=fields.html#bug_severity) | unspecified | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Lubomir Rintel | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Fedora Extras Quality Assurance | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=1553634&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1553634&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2018-03-09 08:51 UTC by David Woodhouse | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2020-01-26 08:45 UTC ([History](show_activity.cgi?id=1553634)) | | [CC List:](page.cgi?id=fields.html#cclist) | 11 users (show)  alexl bgalvani dcbw fgiudici john.j5live lkundrak mclasen rharwood rhughes sandmann thaller | | Fixed In Version: |  | | | Doc Type: | If docs needed, set a value | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2020-01-26 08:45:16 UTC | | | Type: | Bug | | | Embargoed: |  | | | [Dependent Products:](page.cgi?id=fields.html#dependent_products "Other Products that are affected by this bug.") | Ember-CSI Red Hat Enterprise Virtualization Manager Red Hat OpenStack Service Telemetry Framework | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | GNOME Bugzilla | [746422](https://bugzilla.gnome.org/show_bug.cgi?id=746422) | 0 | Normal | RESOLVED | [CVE-2018-1000135] Unencrypted DNS queries leaked outside full-tunnel VPN | 2020-11-20 16:10:20 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1553634#c0)  David Woodhouse    2018-03-09 08:51:18 UTC  ``` My employer requires me to run a full-tunnel VPN. This is fairly common practice; I am required to use the VPN for *all* IP traffic, as if it was the 20th century and I had dialled into the corporate modem bank.  Policy requires that I don't even have routes to my local network. Since <https://bugzilla.gnome.org/show_bug.cgi?id=767288> is not yet implemented in NM, they achieve that with a NM dispatcher script to update the routing tables. (This is background information; this part is working OK although it would be *nice* to have it properly supported without the hackish script.)  However, NetworkManager is misconfiguring the DNS. Even when it's on a full-tunnel VPN it's still attempting to talk to the local nameservers on the physical network for some lookups. Once on the full-tunnel VPN, it should never use them at all.  This is both a functional problem, and a security problem.  It's a functional problem because some domains get *different* results when looked up internally. This split-horizon "schizo-DNS" is a heinous crime, but unfortunately common. And it's not just "company.com" which is actually in my default "append to failing queries and try this before eventually failing" search domain for the VPN, but all kinds of other subsidiary names and "company-corp.com".  I also want to get the *correct* GeoDNS results for the place my traffic is going to emerge onto the Internet, not a local GeoDNS result leads to worse routing.  It's a security problem because when I'm on a full-tunnel VPN I should *never* leak information about what I'm looking up, to potentially hostile local DNS servers. This is supposed to be like dial-up directly into the company network. That is the expectation, and to do otherwise is very wrong.   ```  [Comment 1](show_bug.cgi?id=1553634#c1)  David Woodhouse    2018-03-09 08:58:30 UTC  ``` Reading that back, I'm not sure why I even mentioned the routing trick to stop access to the local network. That's just how I *noticed* this problem, of course, because those insecure attempts to reach the local network were rightly prevented.   ```  [Comment 2](show_bug.cgi?id=1553634#c2)  David Woodhouse    2018-03-09 09:06:29 UTC  ``` Ubuntu used to have a patch which fixed this, but dropped it: [http://bazaar.launchpad.net/~network-manager/network-manager/ubuntu/view/head:/debian/patches/Filter-DNS-servers-to-add-to-dnsmasq-based-on-availa.patch](http://bazaar.launchpad.net/~network-manager/network-manager/ubuntu/view/head%3A/debian/patches/Filter-DNS-servers-to-add-to-dnsmasq-based-on-availa.patch)   ```  [Comment 3](show_bug.cgi?id=1553634#c3)  Beniamino Galvani    2018-03-21 15:45:06 UTC  ``` On Fedora the default configuration is dns=default, which means that NM updates resolv.conf directly. With this configuration, if you connect to a full-tunnel VPN, resolv.conf will be updated to have the VPN name server as first entry and the local name server after. This guarantees that DNS queries go through the VPN; only when the VPN name server is not reachable the local server is contacted. Since this can be harmful in some situations (but there are cases when this is useful), it is possible to set ipv4.dns-priority=-1 for the VPN so that only the VPN name server get added to resolv.conf.  With this configuration there is no leak of DNS queries to local servers.  If you change the default configuration and set dns=dnsmasq, then NM enables split-dns and uses the VPN name server only for the domains in the VPN search list, even if the VPN gets the default route. This is suboptimal and probably can be fixed introducing a new variable (perhaps "dns.lookup-priority" ?), that indicates which connections should be used for DNS queries not matching any lookup domain. The default value (0, "auto"), should prioritize first full-tunnel VPNs and then non-VPN connections. But I'll send a more detailed explanation on the upstream bugzilla.   ```  [Comment 4](show_bug.cgi?id=1553634#c4)  Ben Cotton    2018-11-27 16:32:03 UTC  ``` This message is a reminder that Fedora 27 is nearing its end of life. On 2018-Nov-30  Fedora will stop maintaining and issuing updates for Fedora 27. It is Fedora's policy to close all bug reports from releases that are no longer maintained. At that time this bug will be closed as EOL if it remains open with a Fedora  'version' of '27'.  Package Maintainer: If you wish for this bug to remain open because you plan to fix it in a currently maintained version, simply change the 'version'  to a later Fedora version.  Thank you for reporting this issue and we are sorry that we were not  able to fix it before Fedora 27 is end of life. If you would still like  to see this bug fixed and are able to reproduce it against a later version  of Fedora, you are encouraged  change the 'version' to a later Fedora  version prior this bug is closed as described in the policy above.  Although we aim to fix as many bugs as possible during every release's  lifetime, sometimes those efforts are overtaken by events. Often a  more recent Fedora release includes newer upstream software that fixes  bugs or makes them obsolete.   ```  [Comment 5](show_bug.cgi?id=1553634#c5)  Robbie Harwood    2020-01-24 20:36:36 UTC  ``` Hi, was this ever fixed?   ```  [Comment 6](show_bug.cgi?id=1553634#c6)  Beniamino Galvani    2020-01-26 08:45:16 UTC  ``` Yes, this was fixed in NM 1.12 (Fedora 29).   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1553634&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from launchpad.net_0bc92a78_20250126_064859.html ===

[Log in / Register](https://launchpad.net/~dwmw2/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~dwmw2)

## [dwmw2](https://launchpad.net/~dwmw2)

* Overview
* [Code](https://code.launchpad.net/~dwmw2)
* [Bugs](https://bugs.launchpad.net/~dwmw2)
* [Blueprints](https://blueprints.launchpad.net/~dwmw2)
* [Translations](https://translations.launchpad.net/~dwmw2)
* [Answers](https://answers.launchpad.net/~dwmw2)

* [Related packages](https://launchpad.net/~dwmw2/%2Brelated-packages)
* [Related projects](https://launchpad.net/~dwmw2/%2Brelated-projects)

## User information

Launchpad Id:
dwmw2

Email:
[Log in](%2Blogin) for email information.

Member since:
2007-06-13

Signed Ubuntu Code of Conduct:
Yes

Languages:

English

OpenPGP keys:

BE07D9FD54809AB2C4B0FF5F63762CDA67E2F359,
314B08ACD0DE481133A5F2869BE980FD0AC01544

SSH keys:

[dwmw@uc8d3ff76b9bc5848a9cc](%2Bsshkeys)

Time zone:

UTC
(UTC+0000)

Karma:
[0](https://launchpad.net/~dwmw2/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

## Personal package archives

| [openconnect](/~dwmw2/%2Barchive/ubuntu/openconnect) |
| --- |
| [pidgin-chime](/~dwmw2/%2Barchive/ubuntu/pidgin-chime) |

## Latest memberships

dwmw2 is not an
active member of any Launchpad teams.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_441c15c7_20250126_064900.html ===

[Log in / Register](https://launchpad.net/~willcooke/%2Blogin)

[![](https://launchpadlibrarian.net/216376688/hackergotchi64x64.png)](https://launchpad.net/~willcooke)

## [Will Cooke](https://launchpad.net/~willcooke)

* Overview
* [Code](https://code.launchpad.net/~willcooke)
* [Bugs](https://bugs.launchpad.net/~willcooke)
* [Blueprints](https://blueprints.launchpad.net/~willcooke)
* [Translations](https://translations.launchpad.net/~willcooke)
* [Answers](https://answers.launchpad.net/~willcooke)

Bloke

Blog: http://www.whizzy.org

* [Related packages](https://launchpad.net/~willcooke/%2Brelated-packages)
* [Related projects](https://launchpad.net/~willcooke/%2Brelated-projects)

## User information

Launchpad Id:
willcooke

Email:
[Log in](%2Blogin) for email information.

Member since:
2005-10-14

[![Icon of Ubuntu Amateur Radio](https://launchpadlibrarian.net/37961768/ubuntu-hams_14.png "Member of Ubuntu Amateur Radio")](/~ubuntu-hams)
[![Icon of Ubuntu Local Community Teams](https://launchpadlibrarian.net/162222905/locoteams-icon.png "Member of Ubuntu Local Community Teams")](/~locoteams)
[![Icon of Ubuntu UK](https://launchpadlibrarian.net/73823469/uuklogosquare14.png "Member of Ubuntu UK")](/~ubuntu-uk)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English

Time zone:

Europe/London
(UTC+0000)

Karma:
[0](https://launchpad.net/~willcooke/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**willcooke**
 on
**irc.freenode.net**

## Personal package archives

| [gdm-nobluetoothaudio](/~willcooke/%2Barchive/ubuntu/gdm-nobluetoothaudio) |
| --- |
| [Will's PPA for testing things](/~willcooke/%2Barchive/ubuntu/ppa) |

## [All memberships](https://launchpad.net/~willcooke/%2Bparticipation) Latest memberships

| [Ubuntu SSO 2-factor testers](/~sso-2f-testers)  Joined on 2019-10-25 | |
| --- | --- |
| [Ubuntu Amateur Radio](/~ubuntu-hams)  Joined on 2012-04-20 | |
| [Ubuntu TV Interest Group](/~ubuntu-tv)  Joined on 2011-11-16 | |
| [Ubuntu UK](/~ubuntu-uk)  Joined on 2011-09-02 | |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.suse.com_dce7c143_20250126_064914.html ===

![](/assets/img/1px-transparent.gif)
![](/assets/img/1px-transparent.gif)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)
![SUSE Federal Logo](https://www.suse.com/assets/img/fed_logo.png)](https://www.suse.com)
Exit SUSE Federal  >

[Customer Center](https://scc.suse.com/home)

Account

Hello
[Update Your Account](https://www.suse.com/account/update/)
[Log Out](https://www.suse.com/saml2/logout/)

[Login](https://www.suse.com/saml2/login/)
[Create Account](https://www.suse.com/account/create/)
[Update Your Account](https://www.suse.com/account/update/)

English

Language
[Deutsch](https://www.suse.com/de-de/security/cve/CVE-2018-1000135.html)
[English](https://www.suse.com/security/cve/CVE-2018-1000135.html)
[EspaÃ±ol](https://www.suse.com/es-es/security/cve/CVE-2018-1000135.html)
[FranÃ§ais](https://www.suse.com/fr-fr/security/cve/CVE-2018-1000135.html)
[ä¸­æ(ç®ä½)](https://www.suse.com/zh-cn/security/cve/CVE-2018-1000135.html)
[æ¥æ¬èª](https://www.suse.com/ja-jp/security/cve/CVE-2018-1000135.html)
[íêµ­ì´](https://www.suse.com/ko-kr/security/cve/CVE-2018-1000135.html)
[PortuguÃªs (Brasil)](https://www.suse.com/pt-br/security/cve/CVE-2018-1000135.html)

[Shop](https://www.suse.com/shop/)

[View Cart](https://buy.suse.com/store?Action=DisplayPage&Env=BASE&SiteID=suse&id=ThreePgCheckoutShoppingCartPage)

[![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)](https://www.suse.com)
Exit SUSE Federal  >

[Shop](https://www.suse.com/shop/)
[SUSECON 25](https://www.suse.com/susecon/)
[Customer](https://scc.suse.com/home)

Federal Solutions

Products

Solutions

Support

Partners

Communities

About

[Contact Us](https://www.suse.com/contact/)

[Free Downloads](https://www.suse.com/products/)

 Back

 Back
[![Icon](https://www.suse.com/assets/img/icons/Linux-one-color.svg)
Linux](https://www.suse.com/solutions/business-critical-linux/ "Linux")

* [SUSE Linux Enterprise Server](https://www.suse.com/products/server/)
* [SUSE Linux Enterprise Server

  for SAP Applications](https://www.suse.com/products/sles-for-sap/)
* [SUSE Linux Micro](https://www.suse.com/products/micro/)
* [SUSE Multi-Linux Support](https://www.suse.com/products/multi-linux-support/)
* [SUSE Multi-Linux Manager](https://www.suse.com/products/multi-linux-manager/)

[![Icon](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)
Cloud Native](https://www.suse.com/solutions/enterprise-container-management/ "Cloud Native")

* [SUSE Rancher Prime](https://www.suse.com/products/rancher/)
* [Virtualization (Harvester)](https://www.suse.com/products/rancher/virtualization/)
* [Storage (Longhorn)](https://www.suse.com/products/rancher/storage/)
* [Security (NeuVector)](https://www.suse.com/products/rancher/security/)
* [Observability](https://www.suse.com/solutions/observability/)
* [SUSE Cloud Observability](https://www.suse.com/products/cloud/observability/)

[![Icon](https://www.suse.com/assets/img/icons/Edge-one-color.svg)
Edge](https://www.suse.com/solutions/edge-computing/ "Edge")

* [SUSE Edge](https://www.suse.com/products/edge/)
* [SUSE Edge for Telco](https://www.suse.com/products/edge-for-telco/)

[![Icon](https://www.suse.com/assets/img/icons/AI-one-color.svg)
AI](https://www.suse.com/solutions/edge-computing/ "AI")

* [SUSE AI](https://www.suse.com/products/ai/)

[All Products](https://www.suse.com/products/)

 Back
Foundational

* [![Linux](https://www.suse.com/assets/img/icons/Linux-one-color.svg)](https://www.suse.com/solutions/linux/)
* [![Cloud Native](https://www.suse.com/assets/img/icons/Cloud-native-one-color.svg)](https://www.suse.com/solutions/cloud-native/)
* [![Edge](https://www.suse.com/assets/img/icons/Edge-one-color.svg)](https://www.suse.com/solutions/edge/)
* [![AI](https://www.suse.com/assets/img/icons/AI-one-color.svg)](https://www.suse.com/solutions/ai/)

Solutions

* [Run SAP

  Run & secure cloud and on-prem workloads](https://www.suse.com/solutions/run-sap-solutions/)
* [Public Cloud

  Accelerate and innovate across your cloud environment](https://www.suse.com/solutions/public-cloud/)
* [Observability

  Rapid, full-stack visibility in under 5 minutes](https://www.suse.com/solutions/observability/)
* [Security

  Secure your digital enterprise](https://www.suse.com/solutions/security/)

Industries

* [Automotive](https://www.suse.com/sector/automotive/)
* [Telecom](https://www.suse.com/sector/telco/)
* [Banking and Financial Systems](https://www.suse.com/sector/banking-financial-services/)
* [Healthcare](https://www.suse.com/sector/healthcare/)
* [Manufacturing](https://www.suse.com/sector/manufacturing/)
* [Retail](https://www.suse.com/sector/retail/)
* [Technology & Software](https://www.suse.com/sector/technology/)
* [Federal](https://www.ranchergovernment.com/)
* [Pharma](https://www.suse.com/sector/pharma/)
* [Energy](https://www.suse.com/sector/energy/)

 Back
Support

* [Product Support

  SUSE Customer Center](https://scc.suse.com/home)
* [Premium Support Services

  Dedicated support services from a premium team](https://www.suse.com/services/premium/)
* [Long Term Services Support

  Stay on your existing product version](https://www.suse.com/products/long-term-service-pack-support/)
* [Renew Your Support Subscription

  Partners with cloud providers](https://www.suse.com/renewals/)
* [![AWS](https://www.suse.com/assets/img/icons/320px-Amazon3.svg)](https://aws.amazon.com/marketplace/search/results?searchTerms=suse)
* [![Microsoft Azure](https://www.suse.com/assets/img/icons/Microsoft_Azure3.svg)](https://azure.microsoft.com/solutions/linux-on-azure/suse/)
* [![Google](https://www.suse.com/assets/img/icons/lockup_GoogleCloud_FullColor_rgb_139x24px 1.svg)](https://console.cloud.google.com/marketplace/browse?q=SUSE)

Services

* [Consulting Services](https://www.suse.com/services/)
* [Training & Certification](https://www.suse.com/training/)
* [Premium Technical Advisory Services](https://www.suse.com/services/premium-technical-advisory/)

Resources

* [SUSE Support User Guide](https://www.suse.com/support/handbook/)
* [Patches & Updates](https://download.suse.com/patch/finder/)
* [Product Documentation](https://documentation.suse.com/)
* [Knowledgebase](https://www.suse.com/support/kb/)
* [Product Support Life Cycle](https://www.suse.com/lifecycle/)
* [Package Hub

  Community packages for SUSE Linux Enterprise Server](https://packagehub.suse.com/)
* [Driver Search](https://drivers.suse.com/)
* [Support Forums](https://forums.suse.com/forum.php)
* [Developer Services](https://www.suse.com/services/support-offerings/developer-services/)
* [Beta Program](https://www.suse.com/betaprogram/)
* [Security](https://www.suse.com/support/security/)

 Back
Partners

* [Partner Program](https://www.suse.com/partners/)
* [Find a Partner](https://www.suse.com/partners/find-partner/)
* [Become a Partner](https://www.suse.com/partners/become-partner/)
* [Login to the SUSE Partner Portal](https://partner.suse.com/)

 Back
Communities

* [Blog](https://www.suse.com/c/blog/)
* [Forum](https://forums.suse.com/forum.php)
* [Open Source Projects](http://opensource.suse.com/)
* [openSUSE.org](https://www.opensuse.org/)

 Back
About

* [About](https://www.suse.com/company/about/)
* [Leadership](https://www.suse.com/leadership/)
* [Careers](https://jobs.suse.com/)
* [Newsroom](https://www.suse.com/news/)
* [Success Stories](https://www.suse.com/success/)
* [Investor Relations](https://ir.suse.com/)
* [Social Impact](https://www.suse.com/esg/)
* [SUSE Logo and Brand](https://brand.suse.com/)
* [Events](https://www.suse.com/events/)
* [Merchandise Store](https://www.susemerchandise.com/)

# CVE-2018-1000135

## Common Vulnerabilities and Exposures

[[Previous]](CVE-2018-1000132.html) [[Index]](index.html) [[Next]](CVE-2018-1000140.html)

### Upstream information

[CVE-2018-1000135 at MITRE](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1000135)

#### Description

GNOME NetworkManager version 1.10.2 and earlier contains a Information Exposure (CWE-200) vulnerability in DNS resolver that can result in Private DNS queries leaked to local network's DNS servers, while on VPN. This vulnerability appears to have been fixed in Some Ubuntu 16.04 packages were fixed, but later updates removed the fix. cf. https://bugs.launchpad.net/ubuntu/+bug/1754671 an upstream fix does not appear to be available at this time.

---

### [SUSE information](https://www.suse.com/c/cve-pages-self-help-security-issues-suse-linux-enterprise/)

Overall state of this security issue: Resolved

This issue is currently rated as having [moderate](https://www.suse.com/support/security/rating/) severity.

[CVSS v2 Scores](https://nvd.nist.gov/cvss.cfm)
|  | National Vulnerability Database |
| Base Score | 5 |
| Vector | AV:N/AC:L/Au:N/C:P/I:N/A:N |
| Access Vector | Network |
| Access Complexity | Low |
| Authentication | None |
| Confidentiality Impact | Partial |
| Integrity Impact | None |
| Availability Impact | None |

[CVSS v3 Scores](https://nvd.nist.gov/cvss.cfm)
|  | National Vulnerability Database | SUSE |
| Base Score | 7.5 | 5.3 |
| Vector | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N |
| Attack Vector | Network | Network |
| Attack Complexity | Low | Low |
| Privileges Required | None | None |
| User Interaction | None | None |
| Scope | Unchanged | Unchanged |
| Confidentiality Impact | High | Low |
| Integrity Impact | None | None |
| Availability Impact | None | None |
| CVSSv3 Version | 3 | 3 |

SUSE Bugzilla entry: [1086263](https://bugzilla.suse.com/show_bug.cgi?id=1086263) [RESOLVED / FIXED]
### SUSE Security Advisories:

* [SUSE-SU-2019:1369-1](https://lists.suse.com/pipermail/sle-security-updates/2019-May/005511.html), published Tue May 28 13:11:08 MDT 2019
* [openSUSE-SU-2019:1494-1](https://lists.opensuse.org/archives/list/security-announce%40lists.opensuse.org/thread/C5HHHP6HRC27GJXSH33SJTDNWTSVTWFT/#C5HHHP6HRC27GJXSH33SJTDNWTSVTWFT), published Fri Dec 8 15:48:42 2023

### List of released packages

| Product(s) | Fixed package version(s) | References |
| --- | --- | --- |
| Image SLES15-OCI-BYOS Image SLES15-SAP-Azure-LI-BYOS-Production Image SLES15-SAP-Azure-VLI-BYOS-Production Image SLES15-SAP-OCI-BYOS Image SLES15-SP1-Azure-BYOS Image SLES15-SP1-Azure-HPC-BYOS Image SLES15-SP1-GCE-BYOS Image SLES15-SP1-Manager-4-0-Azure-BYOS-Proxy Image SLES15-SP1-Manager-4-0-Azure-BYOS-Server Image SLES15-SP1-Manager-4-0-EC2-HVM-BYOS-Proxy Image SLES15-SP1-Manager-4-0-EC2-HVM-BYOS-Server Image SLES15-SP1-Manager-4-0-GCE-BYOS-Proxy Image SLES15-SP1-Manager-4-0-GCE-BYOS-Server Image SLES15-SP1-OCI-BYOS Image SLES15-SP1-SAP-Azure Image SLES15-SP1-SAP-Azure-BYOS Image SLES15-SP1-SAP-Azure-LI-BYOS-Production Image SLES15-SP1-SAP-Azure-VLI-BYOS-Production Image SLES15-SP1-SAP-GCE Image SLES15-SP1-SAP-GCE-BYOS Image SLES15-SP1-SAP-OCI-BYOS Image SLES15-SP1-SAPCAL-Azure Image SLES15-SP1-SAPCAL-EC2-HVM Image SLES15-SP1-SAPCAL-GCE | * `libnm0 >= 1.10.6-5.6.1` * `typelib-1_0-NM-1_0 >= 1.10.6-5.6.1` |  |
| SUSE Enterprise Storage 7.1 SUSE Linux Enterprise High Performance Computing 15 SP3 SUSE Manager Proxy 4.2 SUSE Manager Retail Branch Server 4.2 SUSE Manager Server 4.2 | * `NetworkManager >= 1.22.10-3.7.1` * `libnm0 >= 1.22.10-3.7.1` * `typelib-1_0-NM-1_0 >= 1.22.10-3.7.1` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP3 GA libnm0-1.22.10-3.7.1SUSE Linux Enterprise Module for Desktop Applications 15 SP3 GA NetworkManager-1.22.10-3.7.1 |
| SUSE Enterprise Storage 7 SUSE Linux Enterprise High Performance Computing 15 SP2 SUSE Manager Proxy 4.1 SUSE Manager Retail Branch Server 4.1 SUSE Manager Server 4.1 | * `NetworkManager >= 1.22.6-1.36` * `NetworkManager-devel >= 1.22.6-1.36` * `libnm0 >= 1.22.6-1.36` * `typelib-1_0-NM-1_0 >= 1.22.6-1.36` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP2 GA libnm0-1.22.6-1.36SUSE Linux Enterprise Module for Desktop Applications 15 SP2 GA NetworkManager-1.22.6-1.36 |
| SUSE Linux Enterprise Desktop 15 SP2 SUSE Linux Enterprise Server 15 SP2 SUSE Linux Enterprise Server for SAP Applications 15 SP2 | * `NetworkManager >= 1.22.6-1.36` * `NetworkManager-devel >= 1.22.6-1.36` * `NetworkManager-lang >= 1.22.6-1.36` * `libnm0 >= 1.22.6-1.36` * `typelib-1_0-NM-1_0 >= 1.22.6-1.36` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP2 GA libnm0-1.22.6-1.36SUSE Linux Enterprise Module for Desktop Applications 15 SP2 GA NetworkManager-1.22.6-1.36SUSE Linux Enterprise Workstation Extension 15 SP2 GA NetworkManager-lang-1.22.6-1.36 |
| SUSE Linux Enterprise Desktop 15 SP3 SUSE Linux Enterprise Server 15 SP3 SUSE Linux Enterprise Server for SAP Applications 15 SP3 | * `NetworkManager >= 1.22.10-3.7.1` * `NetworkManager-devel >= 1.22.10-3.7.1` * `NetworkManager-lang >= 1.22.10-3.7.1` * `libnm0 >= 1.22.10-3.7.1` * `typelib-1_0-NM-1_0 >= 1.22.10-3.7.1` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP3 GA libnm0-1.22.10-3.7.1SUSE Linux Enterprise Module for Desktop Applications 15 SP3 GA NetworkManager-1.22.10-3.7.1SUSE Linux Enterprise Workstation Extension 15 SP3 GA NetworkManager-devel-1.22.10-3.7.1 |
| SUSE Linux Enterprise Desktop 15 SP4 SUSE Linux Enterprise Server 15 SP4 SUSE Linux Enterprise Server for SAP Applications 15 SP4 | * `NetworkManager >= 1.32.12-150400.1.11` * `NetworkManager-devel >= 1.32.12-150400.1.11` * `NetworkManager-lang >= 1.32.12-150400.1.11` * `libnm0 >= 1.32.12-150400.1.11` * `typelib-1_0-NM-1_0 >= 1.32.12-150400.1.11` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP4 GA libnm0-1.32.12-150400.1.11SUSE Linux Enterprise Module for Desktop Applications 15 SP4 GA NetworkManager-1.32.12-150400.1.11SUSE Linux Enterprise Workstation Extension 15 SP4 GA NetworkManager-devel-1.32.12-150400.1.11 |
| SUSE Linux Enterprise Desktop 15 SP5 SUSE Linux Enterprise High Performance Computing 15 SP5 SUSE Linux Enterprise Server 15 SP5 SUSE Linux Enterprise Server for SAP Applications 15 SP5 | * `NetworkManager >= 1.38.6-150500.1.2` * `libnm0 >= 1.38.6-150500.1.2` * `typelib-1_0-NM-1_0 >= 1.38.6-150500.1.2` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP5 GA libnm0-1.38.6-150500.1.2SUSE Linux Enterprise Module for Desktop Applications 15 SP5 GA NetworkManager-1.38.6-150500.1.2 |
| SUSE Linux Enterprise Desktop 15 SP6 SUSE Linux Enterprise High Performance Computing 15 SP6 SUSE Linux Enterprise Server 15 SP6 SUSE Linux Enterprise Server for SAP Applications 15 SP6 | * `NetworkManager >= 1.44.2-150600.1.7` * `libnm0 >= 1.44.2-150600.1.7` * `typelib-1_0-NM-1_0 >= 1.44.2-150600.1.7` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP6 GA libnm0-1.44.2-150600.1.7SUSE Linux Enterprise Module for Desktop Applications 15 SP6 GA NetworkManager-1.44.2-150600.1.7 |
| SUSE Linux Enterprise Desktop 15 SUSE Linux Enterprise Server 15 SUSE Linux Enterprise Server for SAP Applications 15 | * `NetworkManager >= 1.10.6-5.6.1` * `NetworkManager-devel >= 1.10.6-5.6.1` * `NetworkManager-lang >= 1.10.6-5.6.1` * `libnm-glib-vpn1 >= 1.10.6-5.6.1` * `libnm-glib4 >= 1.10.6-5.6.1` * `libnm-util2 >= 1.10.6-5.6.1` * `libnm0 >= 1.10.6-5.6.1` * `typelib-1_0-NM-1_0 >= 1.10.6-5.6.1` * `typelib-1_0-NMClient-1_0 >= 1.10.6-5.6.1` * `typelib-1_0-NetworkManager-1_0 >= 1.10.6-5.6.1` | Patchnames: SUSE-SLE-Module-Basesystem-15-2019-1369SUSE-SLE-Module-Desktop-Applications-15-2019-1369SUSE-SLE-Product-WE-15-2019-1369 |
| SUSE Linux Enterprise High Performance Computing 15 SP4 SUSE Manager Proxy 4.3 SUSE Manager Retail Branch Server 4.3 SUSE Manager Server 4.3 | * `NetworkManager >= 1.32.12-150400.1.11` * `libnm0 >= 1.32.12-150400.1.11` * `typelib-1_0-NM-1_0 >= 1.32.12-150400.1.11` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP4 GA libnm0-1.32.12-150400.1.11SUSE Linux Enterprise Module for Desktop Applications 15 SP4 GA NetworkManager-1.32.12-150400.1.11 |
| SUSE Linux Enterprise High Performance Computing 15 | * `NetworkManager >= 1.10.6-5.6.1` * `NetworkManager-devel >= 1.10.6-5.6.1` * `libnm-glib-vpn1 >= 1.10.6-5.6.1` * `libnm-glib4 >= 1.10.6-5.6.1` * `libnm-util2 >= 1.10.6-5.6.1` * `libnm0 >= 1.10.6-5.6.1` * `typelib-1_0-NM-1_0 >= 1.10.6-5.6.1` * `typelib-1_0-NMClient-1_0 >= 1.10.6-5.6.1` * `typelib-1_0-NetworkManager-1_0 >= 1.10.6-5.6.1` | Patchnames: SUSE-SLE-Module-Basesystem-15-2019-1369SUSE-SLE-Module-Desktop-Applications-15-2019-1369 |
| SUSE Linux Enterprise Micro 5.0 | * `libnm0 >= 1.22.10-3.3.4` * `typelib-1_0-NM-1_0 >= 1.22.10-3.3.4` | Patchnames: SUSE Linux Enterprise Micro 5.0 GA libnm0-1.22.10-3.3.4 |
| SUSE Linux Enterprise Micro 5.1 | * `libnm0 >= 1.22.10-3.7.1` * `typelib-1_0-NM-1_0 >= 1.22.10-3.7.1` | Patchnames: SUSE Linux Enterprise Micro 5.1 GA libnm0-1.22.10-3.7.1 |
| SUSE Linux Enterprise Micro 5.2 | * `libnm0 >= 1.22.10-3.10.1` * `typelib-1_0-NM-1_0 >= 1.22.10-3.10.1` | Patchnames: SUSE Linux Enterprise Micro 5.2 GA libnm0-1.22.10-3.10.1 |
| SUSE Linux Enterprise Micro 5.3 | * `NetworkManager >= 1.38.2-150400.1.2` * `libnm0 >= 1.38.2-150400.1.2` * `typelib-1_0-NM-1_0 >= 1.38.2-150400.1.2` | Patchnames: SUSE Linux Enterprise Micro 5.3 GA NetworkManager-1.38.2-150400.1.2 |
| SUSE Linux Enterprise Micro 5.4 | * `NetworkManager >= 1.38.2-150400.1.3` * `NetworkManager-bluetooth >= 1.38.2-150400.1.3` * `NetworkManager-cloud-setup >= 1.38.2-150400.1.3` * `NetworkManager-pppoe >= 1.38.2-150400.1.3` * `NetworkManager-tui >= 1.38.2-150400.1.3` * `NetworkManager-wwan >= 1.38.2-150400.1.3` * `libnm0 >= 1.38.2-150400.1.3` * `typelib-1_0-NM-1_0 >= 1.38.2-150400.1.3` | Patchnames: SUSE Linux Enterprise Micro 5.4 GA NetworkManager-1.38.2-150400.1.3 |
| SUSE Linux Enterprise Module for Basesystem 15 SP2 | * `libnm0 >= 1.22.6-1.36` * `typelib-1_0-NM-1_0 >= 1.22.6-1.36` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP2 GA libnm0-1.22.6-1.36 |
| SUSE Linux Enterprise Module for Basesystem 15 SP3 | * `libnm0 >= 1.22.10-3.7.1` * `typelib-1_0-NM-1_0 >= 1.22.10-3.7.1` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP3 GA libnm0-1.22.10-3.7.1 |
| SUSE Linux Enterprise Module for Basesystem 15 SP4 | * `libnm0 >= 1.32.12-150400.1.11` * `typelib-1_0-NM-1_0 >= 1.32.12-150400.1.11` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP4 GA libnm0-1.32.12-150400.1.11 |
| SUSE Linux Enterprise Module for Basesystem 15 SP5 | * `libnm0 >= 1.38.6-150500.1.2` * `typelib-1_0-NM-1_0 >= 1.38.6-150500.1.2` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP5 GA libnm0-1.38.6-150500.1.2 |
| SUSE Linux Enterprise Module for Basesystem 15 SP6 | * `libnm0 >= 1.44.2-150600.1.7` * `typelib-1_0-NM-1_0 >= 1.44.2-150600.1.7` | Patchnames: SUSE Linux Enterprise Module for Basesystem 15 SP6 GA libnm0-1.44.2-150600.1.7 |
| SUSE Linux Enterprise Module for Basesystem 15 | * `libnm0 >= 1.10.6-5.6.1` * `typelib-1_0-NM-1_0 >= 1.10.6-5.6.1` | Patchnames: SUSE-SLE-Module-Basesystem-15-2019-1369 |
| SUSE Linux Enterprise Module for Desktop Applications 15 SP2 | * `NetworkManager >= 1.22.6-1.36` * `NetworkManager-devel >= 1.22.6-1.36` | Patchnames: SUSE Linux Enterprise Module for Desktop Applications 15 SP2 GA NetworkManager-1.22.6-1.36 |
| SUSE Linux Enterprise Module for Desktop Applications 15 SP3 | * `NetworkManager >= 1.22.10-3.7.1` | Patchnames: SUSE Linux Enterprise Module for Desktop Applications 15 SP3 GA NetworkManager-1.22.10-3.7.1 |
| SUSE Linux Enterprise Module for Desktop Applications 15 SP4 | * `NetworkManager >= 1.32.12-150400.1.11` | Patchnames: SUSE Linux Enterprise Module for Desktop Applications 15 SP4 GA NetworkManager-1.32.12-150400.1.11 |
| SUSE Linux Enterprise Module for Desktop Applications 15 SP5 | * `NetworkManager >= 1.38.6-150500.1.2` | Patchnames: SUSE Linux Enterprise Module for Desktop Applications 15 SP5 GA NetworkManager-1.38.6-150500.1.2 |
| SUSE Linux Enterprise Module for Desktop Applications 15 SP6 | * `NetworkManager >= 1.44.2-150600.1.7` | Patchnames: SUSE Linux Enterprise Module for Desktop Applications 15 SP6 GA NetworkManager-1.44.2-150600.1.7 |
| SUSE Linux Enterprise Module for Desktop Applications 15 | * `NetworkManager >= 1.10.6-5.6.1` * `NetworkManager-devel >= 1.10.6-5.6.1` * `libnm-glib-vpn1 >= 1.10.6-5.6.1` * `libnm-glib4 >= 1.10.6-5.6.1` * `libnm-util2 >= 1.10.6-5.6.1` * `typelib-1_0-NMClient-1_0 >= 1.10.6-5.6.1` * `typelib-1_0-NetworkManager-1_0 >= 1.10.6-5.6.1` | Patchnames: SUSE-SLE-Module-Desktop-Applications-15-2019-1369 |
| SUSE Linux Enterprise Workstation Extension 15 SP2 | * `NetworkManager-lang >= 1.22.6-1.36` | Patchnames: SUSE Linux Enterprise Workstation Extension 15 SP2 GA NetworkManager-lang-1.22.6-1.36 |
| SUSE Linux Enterprise Workstation Extension 15 SP3 | * `NetworkManager-devel >= 1.22.10-3.7.1` * `NetworkManager-lang >= 1.22.10-3.7.1` | Patchnames: SUSE Linux Enterprise Workstation Extension 15 SP3 GA NetworkManager-devel-1.22.10-3.7.1 |
| SUSE Linux Enterprise Workstation Extension 15 SP4 | * `NetworkManager-devel >= 1.32.12-150400.1.11` * `NetworkManager-lang >= 1.32.12-150400.1.11` | Patchnames: SUSE Linux Enterprise Workstation Extension 15 SP4 GA NetworkManager-devel-1.32.12-150400.1.11 |
| SUSE Linux Enterprise Workstation Extension 15 | * `NetworkManager-lang >= 1.10.6-5.6.1` | Patchnames: SUSE-SLE-Product-WE-15-2019-1369 |
| SUSE Linux Micro 6.0 | * `NetworkManager >= 1.42.6-5.14` * `NetworkManager-bluetooth >= 1.42.6-5.14` * `NetworkManager-cloud-setup >= 1.42.6-5.14` * `NetworkManager-pppoe >= 1.42.6-5.14` * `NetworkManager-tui >= 1.42.6-5.14` * `NetworkManager-wwan >= 1.42.6-5.14` * `libnm0 >= 1.42.6-5.14` * `typelib-1_0-NM-1_0 >= 1.42.6-5.14` | Patchnames: SUSE Linux Micro 6.0 GA NetworkManager-1.42.6-5.14 |
| SUSE Linux Micro 6.1 | * `NetworkManager >= 1.42.6-slfo.1.1_1.2` * `NetworkManager-bluetooth >= 1.42.6-slfo.1.1_1.2` * `NetworkManager-cloud-setup >= 1.42.6-slfo.1.1_1.2` * `NetworkManager-pppoe >= 1.42.6-slfo.1.1_1.2` * `NetworkManager-tui >= 1.42.6-slfo.1.1_1.2` * `NetworkManager-wwan >= 1.42.6-slfo.1.1_1.2` * `libnm0 >= 1.42.6-slfo.1.1_1.2` * `typelib-1_0-NM-1_0 >= 1.42.6-slfo.1.1_1.2` | Patchnames: SUSE Linux Micro 6.1 GA NetworkManager-1.42.6-slfo.1.1\_1.2 |
| openSUSE Leap 15.0 | * `NetworkManager >= 1.10.6-lp150.4.6.1` * `NetworkManager-branding-upstream >= 1.10.6-lp150.4.6.1` * `NetworkManager-devel >= 1.10.6-lp150.4.6.1` * `NetworkManager-devel-32bit >= 1.10.6-lp150.4.6.1` * `NetworkManager-lang >= 1.10.6-lp150.4.6.1` * `libnm-glib-vpn1 >= 1.10.6-lp150.4.6.1` * `libnm-glib-vpn1-32bit >= 1.10.6-lp150.4.6.1` * `libnm-glib4 >= 1.10.6-lp150.4.6.1` * `libnm-glib4-32bit >= 1.10.6-lp150.4.6.1` * `libnm-util2 >= 1.10.6-lp150.4.6.1` * `libnm-util2-32bit >= 1.10.6-lp150.4.6.1` * `libnm0 >= 1.10.6-lp150.4.6.1` * `typelib-1_0-NM-1_0 >= 1.10.6-lp150.4.6.1` * `typelib-1_0-NMClient-1_0 >= 1.10.6-lp150.4.6.1` * `typelib-1_0-NetworkManager-1_0 >= 1.10.6-lp150.4.6.1` | Patchnames: openSUSE-2019-1494 |
| openSUSE Leap 15.2 | * `NetworkManager >= 1.22.6-lp152.1.6` * `NetworkManager-lang >= 1.22.6-lp152.1.6` * `libnm0 >= 1.22.6-lp152.1.6` * `typelib-1_0-NM-1_0 >= 1.22.6-lp152.1.6` | Patchnames: openSUSE Leap 15.2 GA NetworkManager-1.22.6-lp152.1.2 |
| openSUSE Leap 15.3 | * `NetworkManager >= 1.22.10-3.7.1` * `NetworkManager-lang >= 1.22.10-3.7.1` * `libnm0 >= 1.22.10-3.7.1` * `typelib-1_0-NM-1_0 >= 1.22.10-3.7.1` | Patchnames: openSUSE Leap 15.3 GA NetworkManager-1.22.10-3.7.1 |
| openSUSE Leap 15.4 | * `NetworkManager >= 1.32.12-150400.1.11` * `NetworkManager-lang >= 1.32.12-150400.1.11` * `libnm0 >= 1.32.12-150400.1.11` * `typelib-1_0-NM-1_0 >= 1.32.12-150400.1.11` | Patchnames: openSUSE Leap 15.4 GA NetworkManager-1.32.12-150400.1.11 |
| openSUSE Tumbleweed | * `NetworkManager >= 1.32.10-2.1` * `NetworkManager-branding-upstream >= 1.32.10-2.1` * `NetworkManager-devel >= 1.32.10-2.1` * `NetworkManager-devel-32bit >= 1.32.10-2.1` * `NetworkManager-lang >= 1.32.10-2.1` * `libnm0 >= 1.32.10-2.1` * `libnm0-32bit >= 1.32.10-2.1` * `typelib-1_0-NM-1_0 >= 1.32.10-2.1` | Patchnames: openSUSE-Tumbleweed-2024-10602 |

---

### First public cloud image revisions this CVE is fixed in:

* [amazon/suse-manager-4-2-proxy-byos-v20210924-hvm-ssd-x86\_64](https://publiccloudimagechangeinfo.suse.com/amazon/suse-manager-4-2-proxy-byos-v20210924-hvm-ssd-x86_64)
* [amazon/suse-manager-4-2-server-byos-v20210924-hvm-ssd-x86\_64](https://publiccloudimagechangeinfo.suse.com/amazon/suse-manager-4-2-server-byos-v20210924-hvm-ssd-x86_64)
* [amazon/suse-sles-15-sp3-v20210924-ecs-hvm-ssd-x86\_64](https://publiccloudimagechangeinfo.suse.com/amazon/suse-sles-15-sp3-v20210924-ecs-hvm-ssd-x86_64)
* [amazon/suse-sles-sap-15-sp3-byos-v20210924-hvm-ssd-x86\_64](https://publiccloudimagechangeinfo.suse.com/amazon/suse-sles-sap-15-sp3-byos-v20210924-hvm-ssd-x86_64)
* [google/sles-15-sp3-sap-byos-v20210812](https://publiccloudimagechangeinfo.suse.com/google/sles-15-sp3-sap-byos-v20210812)
* [google/sles-15-sp3-sap-v20210812](https://publiccloudimagechangeinfo.suse.com/google/sles-15-sp3-sap-v20210812)
* [google/sles-15-sp3-sapcal-v20210812](https://publiccloudimagechangeinfo.suse.com/google/sles-15-sp3-sapcal-v20210812)
* [google/sles-15-sp3-v20210812](https://publiccloudimagechangeinfo.suse.com/google/sles-15-sp3-v20210812)
* [google/suse-manager-4-2-proxy-byos-v20210812](https://publiccloudimagechangeinfo.suse.com/google/suse-manager-4-2-proxy-byos-v20210812)
* [google/suse-manager-4-2-server-byos-v20210812](https://publiccloudimagechangeinfo.suse.com/google/suse-manager-4-2-server-byos-v20210812)
* [microsoft/suse-manager-4-2-proxy-byos-v20210924](https://publiccloudimagechangeinfo.suse.com/microsoft/suse-manager-4-2-proxy-byos-v20210924)
* [microsoft/suse-manager-4-2-server-byos-v20210924](https://publiccloudimagechangeinfo.suse.com/microsoft/suse-manager-4-2-server-byos-v20210924)
* [microsoft/suse-sles-15-sp3-hpc-v20210924](https://publiccloudimagechangeinfo.suse.com/microsoft/suse-sles-15-sp3-hpc-v20210924)
* [microsoft/suse-sles-15-sp3-sapcal-v20220120](https://publiccloudimagechangeinfo.suse.com/microsoft/suse-sles-15-sp3-sapcal-v20220120)
* [microsoft/suse-sles-sap-15-sp3-byos-v20210924](https://publiccloudimagechangeinfo.suse.com/microsoft/suse-sles-sap-15-sp3-byos-v20210924)
* [microsoft/suse-sles-sap-15-sp3-v20210924](https://publiccloudimagechangeinfo.suse.com/microsoft/suse-sles-sap-15-sp3-v20210924)

---

### Status of this issue by product and package

Please note that this evaluation state might be work in progress, incomplete or outdated. Also information for service packs in the LTSS phase is only included for issues meeting the LTSS criteria. If in doubt, feel free to contact us for clarification. The updates are grouped by state of their lifecycle. SUSE product lifecycles are documented [on the lifecycle page](https://www.suse.com/lifecycle/).

| Product(s) | Source package | State |
| --- | --- | --- |
| Products under general support and receiving all security fixes. | | |
| SUSE Linux Enterprise Micro 5.1 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Micro 5.2 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Micro 5.3 | NetworkManager | Released |
| SUSE Linux Enterprise Micro 5.4 | NetworkManager | Released |
| SUSE Linux Enterprise Micro 5.5 | NetworkManager | Affected |
| SUSE Linux Micro 6.0 | NetworkManager | Affected |
| SUSE Manager Proxy 4.3 | NetworkManager | Released |
| SUSE Manager Retail Branch Server 4.3 | NetworkManager | Released |
| SUSE Manager Server 4.3 | NetworkManager | Released |
| Products under Long Term Service Pack support and receiving important and critical security fixes. | | |
| SUSE Linux Enterprise High Performance Computing 12 SP5 | NetworkManager | Not affected |
| SUSE Linux Enterprise High Performance Computing 15 SP3 | NetworkManager | Already fixed |
| SUSE Linux Enterprise High Performance Computing 15 SP3-ESPOS | NetworkManager | Already fixed |
| SUSE Linux Enterprise High Performance Computing 15 SP3-LTSS | NetworkManager | Already fixed |
| SUSE Linux Enterprise High Performance Computing 15 SP4 | NetworkManager | Released |
| SUSE Linux Enterprise High Performance Computing 15 SP4-LTSS | NetworkManager | Released |
| SUSE Linux Enterprise High Performance Computing 15 SP5 | NetworkManager | Released |
| SUSE Linux Enterprise High Performance Computing 15 SP5-ESPOS | NetworkManager | Affected |
| SUSE Linux Enterprise High Performance Computing 15 SP5-LTSS | NetworkManager | Released |
| SUSE Linux Enterprise Module for Basesystem 15 SP3 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Module for Basesystem 15 SP4 | NetworkManager | Released |
| SUSE Linux Enterprise Module for Basesystem 15 SP5 | NetworkManager | Released |
| SUSE Linux Enterprise Module for Desktop Applications 15 SP3 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Module for Desktop Applications 15 SP4 | NetworkManager | Released |
| SUSE Linux Enterprise Module for Desktop Applications 15 SP5 | NetworkManager | Released |
| SUSE Linux Enterprise Server 12 SP5 | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 12 SP5-LTSS | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 15 SP3 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Server 15 SP3-LTSS | NetworkManager | Already fixed |
| SUSE Linux Enterprise Server 15 SP4 | NetworkManager | Released |
| SUSE Linux Enterprise Server 15 SP4-LTSS | NetworkManager | Released |
| SUSE Linux Enterprise Server 15 SP5 | NetworkManager | Released |
| SUSE Linux Enterprise Server 15 SP5-LTSS | NetworkManager | Released |
| SUSE Linux Enterprise Server 15-ESPOS | NetworkManager | Released |
| SUSE Linux Enterprise Server Business Critical Linux 15 SP1 | NetworkManager | Released |
| SUSE Linux Enterprise Server Business Critical Linux 15 SP2 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Server Business Critical Linux 15 SP3 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Server LTSS Extended Security 12 SP5 | NetworkManager | Not affected |
| SUSE Linux Enterprise Server for SAP Applications 12 SP5 | NetworkManager | Not affected |
| SUSE Linux Enterprise Server for SAP Applications 15 SP3 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Server for SAP Applications 15 SP4 | NetworkManager | Released |
| SUSE Linux Enterprise Server for SAP Applications 15 SP5 | NetworkManager | Released |
| Products past their end of life and not receiving proactive updates anymore. | | |
| HPE Helion OpenStack 8 | NetworkManager | Not affected |
| SUSE CaaS Platform 4.0 | NetworkManager | Released |
| SUSE CaaS Platform 4.5 | NetworkManager | Already fixed |
| SUSE Enterprise Storage 6 | NetworkManager | Released |
| SUSE Enterprise Storage 7 | NetworkManager | Already fixed |
| SUSE Enterprise Storage 7.1 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Desktop 11 SP2 | NetworkManager | Not affected |
| SUSE Linux Enterprise Desktop 11 SP3 | NetworkManager | Not affected |
| SUSE Linux Enterprise Desktop 11 SP4 | NetworkManager | Not affected |
| SUSE Linux Enterprise Desktop 12 SP2 | NetworkManager | Not affected |
| SUSE Linux Enterprise Desktop 12 SP3 | NetworkManager | Not affected |
| SUSE Linux Enterprise Desktop 12 SP4 | NetworkManager | Not affected |
| SUSE Linux Enterprise Desktop 15 | NetworkManager | Released |
| SUSE Linux Enterprise Desktop 15 SP1 | NetworkManager | Released |
| SUSE Linux Enterprise Desktop 15 SP2 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Desktop 15 SP3 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Desktop 15 SP4 | NetworkManager | Released |
| SUSE Linux Enterprise Desktop 15 SP5 | NetworkManager | Released |
| SUSE Linux Enterprise High Performance Computing 15 | NetworkManager | Released |
| SUSE Linux Enterprise High Performance Computing 15 SP1 | NetworkManager | Released |
| SUSE Linux Enterprise High Performance Computing 15 SP1-ESPOS | NetworkManager | Released |
| SUSE Linux Enterprise High Performance Computing 15 SP1-LTSS | NetworkManager | Released |
| SUSE Linux Enterprise High Performance Computing 15 SP2 | NetworkManager | Already fixed |
| SUSE Linux Enterprise High Performance Computing 15 SP2-ESPOS | NetworkManager | Already fixed |
| SUSE Linux Enterprise High Performance Computing 15 SP2-LTSS | NetworkManager | Already fixed |
| SUSE Linux Enterprise High Performance Computing 15 SP4-ESPOS | NetworkManager | Affected |
| SUSE Linux Enterprise High Performance Computing 15-ESPOS | NetworkManager | Affected |
| SUSE Linux Enterprise High Performance Computing 15-LTSS | NetworkManager | Released |
| SUSE Linux Enterprise Micro 5.0 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Module for Basesystem 15 | NetworkManager | Released |
| SUSE Linux Enterprise Module for Basesystem 15 SP1 | NetworkManager | Released |
| SUSE Linux Enterprise Module for Basesystem 15 SP2 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Module for Desktop Applications 15 | NetworkManager | Released |
| SUSE Linux Enterprise Module for Desktop Applications 15 SP1 | NetworkManager | Released |
| SUSE Linux Enterprise Module for Desktop Applications 15 SP2 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Point of Sale 11 SP3 | NetworkManager | Not affected |
| SUSE Linux Enterprise Point of Sale 12 SP2-CLIENT | NetworkManager | Not affected |
| SUSE Linux Enterprise Real Time 15 SP2 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Real Time 15 SP3 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Real Time 15 SP4 | NetworkManager | Affected |
| SUSE Linux Enterprise Server 11 SP1 | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 11 SP1-LTSS | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 11 SP2 | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 11 SP2-LTSS | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 11 SP3 | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 11 SP3 LTSS | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 11 SP3-LTSS | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 11 SP4 | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 11 SP4-LTSS | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 12 SP2 | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 12 SP2-BCL | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 12 SP2-ESPOS | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 12 SP2-LTSS | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 12 SP3 | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 12 SP3-BCL | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 12 SP3-ESPOS | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 12 SP3-LTSS | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 12 SP4 | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 12 SP4-ESPOS | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 12 SP4-LTSS | NetworkManager | Not affected |
| SUSE Linux Enterprise Server 15 | NetworkManager | Released |
| SUSE Linux Enterprise Server 15 SP1 | NetworkManager | Released |
| SUSE Linux Enterprise Server 15 SP1-BCL | NetworkManager | Affected |
| SUSE Linux Enterprise Server 15 SP1-LTSS | NetworkManager | Released |
| SUSE Linux Enterprise Server 15 SP2 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Server 15 SP2-BCL | NetworkManager | Already fixed |
| SUSE Linux Enterprise Server 15 SP2-LTSS | NetworkManager | Already fixed |
| SUSE Linux Enterprise Server 15 SP3-BCL | NetworkManager | Already fixed |
| SUSE Linux Enterprise Server 15-LTSS | NetworkManager | Released |
| SUSE Linux Enterprise Server for Raspberry Pi 12 SP2 | NetworkManager | Not affected |
| SUSE Linux Enterprise Server for SAP Applications 11 SP2 | NetworkManager | Not affected |
| SUSE Linux Enterprise Server for SAP Applications 11 SP3 | NetworkManager | Not affected |
| SUSE Linux Enterprise Server for SAP Applications 11 SP4 | NetworkManager | Not affected |
| SUSE Linux Enterprise Server for SAP Applications 12 SP2 | NetworkManager | Not affected |
| SUSE Linux Enterprise Server for SAP Applications 12 SP3 | NetworkManager | Not affected |
| SUSE Linux Enterprise Server for SAP Applications 12 SP4 | NetworkManager | Not affected |
| SUSE Linux Enterprise Server for SAP Applications 15 | NetworkManager | Released |
| SUSE Linux Enterprise Server for SAP Applications 15 SP1 | NetworkManager | Released |
| SUSE Linux Enterprise Server for SAP Applications 15 SP2 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Software Development Kit 11 SP2 | NetworkManager | Not affected |
| SUSE Linux Enterprise Software Development Kit 11 SP3 | NetworkManager | Not affected |
| SUSE Linux Enterprise Software Development Kit 11 SP4 | NetworkManager | Not affected |
| SUSE Linux Enterprise Software Development Kit 12 SP2 | NetworkManager | Not affected |
| SUSE Linux Enterprise Software Development Kit 12 SP3 | NetworkManager | Not affected |
| SUSE Linux Enterprise Software Development Kit 12 SP4 | NetworkManager | Not affected |
| SUSE Linux Enterprise Software Development Kit 12 SP5 | NetworkManager | Not affected |
| SUSE Linux Enterprise Workstation Extension 12 SP2 | NetworkManager | Not affected |
| SUSE Linux Enterprise Workstation Extension 12 SP3 | NetworkManager | Not affected |
| SUSE Linux Enterprise Workstation Extension 12 SP4 | NetworkManager | Not affected |
| SUSE Linux Enterprise Workstation Extension 12 SP5 | NetworkManager | Not affected |
| SUSE Linux Enterprise Workstation Extension 15 | NetworkManager | Released |
| SUSE Linux Enterprise Workstation Extension 15 SP1 | NetworkManager | Released |
| SUSE Linux Enterprise Workstation Extension 15 SP2 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Workstation Extension 15 SP3 | NetworkManager | Already fixed |
| SUSE Linux Enterprise Workstation Extension 15 SP4 | NetworkManager | Released |
| SUSE Linux Enterprise Workstation Extension 15 SP5 | NetworkManager | Released |
| SUSE Manager Proxy 4.0 | NetworkManager | Released |
| SUSE Manager Proxy 4.1 | NetworkManager | Already fixed |
| SUSE Manager Proxy 4.2 | NetworkManager | Already fixed |
| SUSE Manager Retail Branch Server 4.0 | NetworkManager | Released |
| SUSE Manager Retail Branch Server 4.1 | NetworkManager | Already fixed |
| SUSE Manager Retail Branch Server 4.2 | NetworkManager | Already fixed |
| SUSE Manager Server 4.0 | NetworkManager | Released |
| SUSE Manager Server 4.1 | NetworkManager | Already fixed |
| SUSE Manager Server 4.2 | NetworkManager | Already fixed |
| SUSE OpenStack Cloud 7 | NetworkManager | Not affected |
| SUSE OpenStack Cloud 8 | NetworkManager | Not affected |
| SUSE OpenStack Cloud 9 | NetworkManager | Not affected |
| SUSE OpenStack Cloud Crowbar 8 | NetworkManager | Not affected |
| SUSE OpenStack Cloud Crowbar 9 | NetworkManager | Not affected |
| openSUSE Leap 15.3 | NetworkManager | Already fixed |
| openSUSE Leap 15.4 | NetworkManager | Affected |
| openSUSE Leap 15.5 | NetworkManager | Affected |
| openSUSE Leap Micro 5.2 | NetworkManager | Already fixed |
| openSUSE Leap Micro 5.3 | NetworkManager | Affected |
| openSUSE Leap Micro 5.4 | NetworkManager | Affected |
| openSUSE Leap Micro 5.5 | NetworkManager | Affected |
| Container Status | | |
| rancher/elemental-teal-rt/5.4 rancher/elemental-teal/5.4 suse/hpc/warewulf4-x86\_64/sle-hpc-node suse/sle-micro-rancher/5.3 suse/sle-micro-rancher/5.4 suse/sle-micro/5.5 suse/sle-micro/base-5.5 suse/sle-micro/kvm-5.5 suse/sle-micro/rt-5.5 | NetworkManager | In progress |

---

### SUSE Timeline for this CVE

CVE page created: Tue Mar 20 15:49:07 2018

CVE page last modified: Wed Jan 22 11:48:21 2025

![SUSE Logo](https://www.suse.com/assets/img/suse-white-logo-green.svg)

* [Careers](https://jobs.suse.com/ "Careers")
* [Legal](https://www.suse.com/company/legal/ "Legal")
* [Anti-Slavery Statement](https://links.imagerelay.com/cdn/3404/ql/811b4f2364b94ff18eb15e315b3e263d/suse_anti_slavery_statement.pdf "Anti-Slavery Statement")
* [Anti-slavery](https://www.suse.com/legal/anti-slavery/ "Anti-slavery")
* [About](https://www.suse.com/company/about/ "About")
* [Communications Preferences](https://www.suse.com/company/subscribe/ "Communications Preferences")
* [Contact Us](https://www.suse.com/contact/ "Contact Us")
* [Let's Chat](#footer-chat-now "Let's Chat")

* [![](https://www.suse.com/assets/img/youtube.png)](https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA%20)
* [![](https://www.suse.com/assets/img/fn-fbook-ico-white.png)](https://www.facebook.com/SUSEWorldwide)
* [![](https://www.suse.com/assets/img/logo-black.png)](https://www.twitter.com/SUSE)
* [![](https://www.suse.com/assets/img/fn-link-ico-white.png)](https://www.linkedin.com/company/suse)
* ![WeChat](https://www.suse.com/assets/img/icons/WeChat.png)
* [![](https://www.suse.com/assets/img/icons/bsky-icon.png)](https://bsky.app/profile/suse.com)

![WeChat QR](https://www.suse.com/assets/img/icons/qrcode_for_gh_91d12717ed53_430.jpg)

Support: [Open a Support Case](https://www.suse.com/support/handbook/#open)

©  ©SUSE, All Rights Reserved

Cookie Settings

[Privacy Policy](https://www.suse.com/company/legal/) and
[Cookie Policy](https://www.suse.com/company/legal/cookies-policy/)

X

×



=== Content from gitlab.freedesktop.org_53083159_20250126_064912.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.



=== Content from github.com_087db2af_20250126_064913.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftomboy-notes%2Ftomboy%2Fissues)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftomboy-notes%2Ftomboy%2Fissues)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fissues%2Findex&source=header-repo&source_repo=tomboy-notes%2Ftomboy)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[tomboy-notes](/tomboy-notes)
/
**[tomboy](/tomboy-notes/tomboy)**
Public

* [Notifications](/login?return_to=%2Ftomboy-notes%2Ftomboy) You must be signed in to change notification settings
* [Fork
  25](/login?return_to=%2Ftomboy-notes%2Ftomboy)
* [Star
   126](/login?return_to=%2Ftomboy-notes%2Ftomboy)

* [Code](/tomboy-notes/tomboy)
* [Issues
  64](/tomboy-notes/tomboy/issues)
* [Pull requests
  3](/tomboy-notes/tomboy/pulls)
* [Actions](/tomboy-notes/tomboy/actions)
* [Projects
  0](/tomboy-notes/tomboy/projects)
* [Security](/tomboy-notes/tomboy/security)
* [Insights](/tomboy-notes/tomboy/pulse)

Additional navigation options

* [Code](/tomboy-notes/tomboy)
* [Issues](/tomboy-notes/tomboy/issues)
* [Pull requests](/tomboy-notes/tomboy/pulls)
* [Actions](/tomboy-notes/tomboy/actions)
* [Projects](/tomboy-notes/tomboy/projects)
* [Security](/tomboy-notes/tomboy/security)
* [Insights](/tomboy-notes/tomboy/pulse)

Preview
# Issues

Search Issuesis:issue state:openSearch

[Labels](labels)[Milestones](milestones)[New issue](/login?return_to=)
## Search results

OpenClosedAuthorLabelsProjectsMilestonesAssigneesTypesNewest

* ### [Is there a Chrome Extension for Tomboy?](/tomboy-notes/tomboy/issues/116)

  Status: Open.#116 In tomboy-notes/tomboy;· [sureshvv](/tomboy-notes/tomboy/issues?q=is%3Aissue%20state%3Aopen%20author%3Asureshvv)  opened on Aug 18, 2021
* ### [how about an option to make specific notes into sticky notes for desktop](/tomboy-notes/tomboy/issues/115)

  Status: Open.#115 In tomboy-notes/tomboy;· [pickybl2020](/tomboy-notes/tomboy/issues?q=is%3Aissue%20state%3Aopen%20author%3Apickybl2020)  opened on Aug 13, 2020
* ### [feature: autoclose notes after X minutes of inactivity](/tomboy-notes/tomboy/issues/114)

  Status: Open.#114 In tomboy-notes/tomboy;· [monperrus](/tomboy-notes/tomboy/issues?q=is%3Aissue%20state%3Aopen%20author%3Amonperrus)  opened on Feb 15, 2020
* ### [Timestamp Ctrl-D no longer working in Mint 19.3](/tomboy-notes/tomboy/issues/113)

  Status: Open.#113 In tomboy-notes/tomboy;· [LaughingFox](/tomboy-notes/tomboy/issues?q=is%3Aissue%20state%3Aopen%20author%3ALaughingFox)  opened on Feb 12, 2020
* ### [tomboy highlighter for text search does not work when the text found has capital letters](/tomboy-notes/tomboy/issues/112)

  Status: Open.#112 In tomboy-notes/tomboy;· [AshishGSharma](/tomboy-notes/tomboy/issues?q=is%3Aissue%20state%3Aopen%20author%3AAshishGSharma)  opened on Oct 4, 2019
* ### [Failure to install Tomboy 1.6.0.msi on Windows 10](/tomboy-notes/tomboy/issues/111)

  Status: Open.#111 In tomboy-notes/tomboy;· [Blogodorio](/tomboy-notes/tomboy/issues?q=is%3Aissue%20state%3Aopen%20author%3ABlogodorio)  opened on Aug 12, 2019
* ### [Notes lock for synchronisation even when writing them](/tomboy-notes/tomboy/issues/110)

  Status: Open.#110 In tomboy-notes/tomboy;· [muelli](/tomboy-notes/tomboy/issues?q=is%3Aissue%20state%3Aopen%20author%3Amuelli)  opened on Jun 17, 2019
* ### [Backlink-AddOn works like a search](/tomboy-notes/tomboy/issues/109)

  Status: Open.#109 In tomboy-notes/tomboy;· [V-H](/tomboy-notes/tomboy/issues?q=is%3Aissue%20state%3Aopen%20author%3AV-H)  opened on Mar 11, 2019
* ### [Special Chars in Notes title](/tomboy-notes/tomboy/issues/108)

  Status: Open.#108 In tomboy-notes/tomboy;· [V-H](/tomboy-notes/tomboy/issues?q=is%3Aissue%20state%3Aopen%20author%3AV-H)  opened on Mar 11, 2019
* ### [Feature Request: Dark Theme or Settings: Change Background Color](/tomboy-notes/tomboy/issues/106)

  Status: Open.#106 In tomboy-notes/tomboy;· [washere](/tomboy-notes/tomboy/issues?q=is%3Aissue%20state%3Aopen%20author%3Awashere)  opened on Dec 31, 2018
* ### [Fails to launch > System.Exception: Unable to open the system message bus. ---> System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---> System.MethodAccessException: Method `DBus.BusObject:.ctor ()' is inaccessible from method` org.freedesktop.DBus.IBusProxy:.ctor ()'](/tomboy-notes/tomboy/issues/105)

  Status: Open.#105 In tomboy-notes/tomboy;· [shiznix](/tomboy-notes/tomboy/issues?q=is%3Aissue%20state%3Aopen%20author%3Ashiznix)  opened on Dec 11, 2018
* ### [Dual Monitor](/tomboy-notes/tomboy/issues/103)

  Status: Open.#103 In tomboy-notes/tomboy;· [caltrop2075](/tomboy-notes/tomboy/issues?q=is%3Aissue%20state%3Aopen%20author%3Acaltrop2075)  opened on Sep 30, 2018

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugzilla.gnome.org_0ee774c7_20250126_064911.html ===


| GNOME Bugzilla â BugÂ 746422 | [CVE-2018-1000135] Unencrypted DNS queries leaked outside full-tunnel VPN | Last modified: 2020-11-12 14:31:19 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)

After an [evaluation](https://wiki.gnome.org/Initiatives/DevelopmentInfrastructure), GNOME has moved from Bugzilla to [GitLab](https://gitlab.gnome.org/). [Learn more about GitLab](https://wiki.gnome.org/GitLab).
**No new issues can be reported in GNOME Bugzilla anymore.**

**To report an issue in a GNOME project, [go to GNOME GitLab](https://gitlab.gnome.org/GNOME)**.
Do **not** go to GNOME Gitlab for: [Bluefish](https://sourceforge.net/p/bluefish/tickets), [Doxygen](https://github.com/doxygen/doxygen/issues), [GnuCash](https://bugs.gnucash.org/), [GStreamer](https://gitlab.freedesktop.org/gstreamer/), [java-gnome](https://github.com/afcowie/java-gnome/issues), [LDTP](https://github.com/ldtp/ldtp2/issues), [NetworkManager](https://gitlab.freedesktop.org/NetworkManager/NetworkManager/issues), [Tomboy](https://github.com/tomboy-notes/tomboy/issues).

[**BugÂ 746422**](show_bug.cgi?id=746422) -
(CVE-2018-1000135)
[CVE-2018-1000135] Unencrypted DNS queries leaked outside full-tunnel VPN

| (CVE-2018-1000135) | |
| --- | --- |
| [Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.") | [CVE-2018-1000135] Unencrypted DNS queries leaked outside full-tunnel VPN |

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED OBSOLETE | | --- | --- | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | NetworkManager | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Platform | | [Component:](describecomponents.cgi?product=NetworkManager "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | IP and DNS config | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal normal | | [TargetÂ Milestone](page.cgi?id=fields.html#target_milestone): | --- | | [Assigned To](page.cgi?id=fields.html#assigned_to): | NetworkManager maintainer(s) | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | NetworkManager maintainer(s) | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | |  | | | Duplicates: | [780913](show_bug.cgi?id=780913 "RESOLVED DUPLICATE - full-tunnel VPN DNS breakage")  ([view as bug list](buglist.cgi?bug_id=780913)) | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [nm-review](show_bug.cgi?id=728406 "RESOLVED OBSOLETE - tracker bug for all bug reviews") | | Â | | Â | | Reported: | 2015-03-18 22:30 UTC by Dan Williams | | --- | --- | | Modified: | 2020-11-12 14:31 UTC | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [GNOME target:](page.cgi?id=fields.html#cf_gnome_target "A custom Drop Down field in this installation of GNOME Bugzilla.") | --- | | | [GNOME version:](page.cgi?id=fields.html#cf_gnome_version "A custom Drop Down field in this installation of GNOME Bugzilla.") | --- | | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

|  |  |
| --- | --- |

| [Description](show_bug.cgi?id=746422#c0)  Dan Williams    2015-03-18 22:30:03 UTC  ``` If the VPN routes all traffic (eg, its ipv4.never-default=false) that usually indicates that the VPN's nameservers should be used instead of the parent interface's nameservers, since the parent interface's nameservers would be accessed over the VPN anyway (since it's routing all traffic).  But with dns=dnsmasq, the dnsmasq plugin always does split DNS regardless of the never-default value of the VPN's IPv4 config:  	/* Use split DNS for VPN configs */ 	for (iter = (GSList *) vpn_configs; iter; iter = g_slist_next (iter)) { 		if (NM_IS_IP4_CONFIG (iter->data)) 			add_ip4_config (conf, NM_IP4_CONFIG (iter->data), TRUE); 		else if (NM_IS_IP6_CONFIG (iter->data)) 			add_ip6_config (conf, NM_IP6_CONFIG (iter->data), TRUE); 	}  instead I think that each config should be added with split DNS only if ipv4.never-default=true for that config.  That would ensure that when the VPN was routing all traffic, split DNS was not used, but when the VPN was not routing all traffic, split DNS was used.  If the user really does want to use the parent interface's nameservers even though they will be contacted over the VPN, they can either add custom dnsmasq options to /etc/NetworkManager/dnsmasq.d or enter them manually for the connection.  ISTR that the behavior I'm suggesting was always intended, but apparently we changed that behavior a long time ago and possibly didn't realize it? ``` [Comment 1](show_bug.cgi?id=746422#c1)  Pavel Simerda    2015-03-19 11:15:43 UTC  ``` In my opinion it is useful to use split DNS view in all cases and only use never-default setting to decide the global DNS.  Rationale: There is no such think as sending all traffic across VPN, only default route traffic, i.e. traffic for which there's no specific route over a specific interface. As specific routes (as found in the routing table) are still used even with default route over VPN, I believe that specific zones (as found in per-connection lists of domains) should be maintained as well. ``` [Comment 2](show_bug.cgi?id=746422#c2)  John 'Warthog9' Hawley    2015-03-20 07:58:02 UTC  ``` Pavel, I'll admit to not 100% following what you've suggested, so please excuse me if I've horribly miss-understood.  I disagree with the assertion that "There is no such think as sending all traffic across VPN".  The parent interface's adapter will have a local route mainly so you can get to the gateway, as well as a route for vpn endpoint you need to push traffic at however, there are some mitigating circumstances that forcing split-dns, so that the DNS on the VPN is ONLY serving the search spaces pushed, is actually exactly the opposite of what a user likely wants and/or causes some rather broken behavior.  - VPNs can, and often do, have IP space overlap issues.  So if the parent interface's network you are on happens to be in the 10.0.0.0/255.255.252.0 (gateway 10.0.0.1, DNS server 10.0.0.2 & 10.0.0.3) ip range, and the VPN uses 10.0.1.0/255.255.255.0, you can end up in some very screwed up situation.  This is actually taken from a real world scenario (which is why I learned of the change to default to split DNS at all).  If you are routing all traffic over the VPN you now have lost access to the two parent interface's DNS servers, and with split DNS you now have *NO* DNS access at all.  As it currently stands the only way to fix this is to either manually edit /etc/resolv.conf or to restart NM without dnsmasq.  - DNS is not equal at all locations, which your assumption about split DNS I think assumes.  DNS zones mean that something that resolves externally one way, may resolve completely differently (and potentially).  example.com, to an external resolver may go to a coloed and public instance, while the same dns entry from an internal dns server may not.  Assuming the VPN only pushes a search of internal.example.com, but doesn't push a search for example.com (making the assumption that people will just type it), the internal site is now unreachable.  Keeping in mind I'm talking about VPNs, and those are typically used in more corporate environments where you are dealing with corporate IT departments.  - In a more casual environment, lets say a hotel, part of the reasons to use a VPN is because the user EXPLICITLY doesn't trust anything about the network they are on, up to and including the DNS servers.  The user, if they are routing everything, is pretty likely to trust the DNS servers on the far side of the VPN.  There's actually plenty of security concerns there, and I for one would have assumed that if I'm routing all my traffic over the VPN, my DNS traffic was as well (meaning I wouldn't have been relying on, or trusting, DNS servers I don't trust).  These are the three issues I'm most concerned about keeping split-dns as the default without choice.  There are situations where I want split-dns, it's great and it's a fantastic feature, but in the case of a vpn that's intending to route all traffic, I'd argue the expected case is that all traffic, including all DNS queries, go over the vpn and it is not split. ``` [Comment 3](show_bug.cgi?id=746422#c3)  Alexander E. Patrakov    2015-11-28 17:37:01 UTC  ``` There is one more interesting use case currently unsupported by NetworkManager.  SafeDNS Inc. (a company that provides a filtered DNS server for parental control, with configurable filter settings) currently runs private beta testing of their VPN service, based on OpenVPN, with mobile phones and tablets being the primary target.  Their VPN is a split-tunnel setup, i.e. the pushed config explicitly routes their subnet (which contains their DNS server and various types of the "site is blocked" page) through the VPN, and nothing else. Their DNS server uses the fact that the queries come through the VPN in order to reliably identify the user and to apply his/her personal filtering settings.  For the filter to work, it is crucial that there are no other DNS servers used in the system. That's how OpenVPN Connect on both Android and iOS behaves, but, unfortunately, not how NetworkManager works.  So, in summary, they absolutely need all other DNS servers to be forgotten by the client, even though they don't want to route all traffic through their VPN servers.   For the record, here is what their ovpn file looks like:  client remote vpn.safedns.com 1194 udp nobind dev tun persist-tun persist-key verify-x509-name vpn.safedns.com name remote-cert-tls server cipher AES-128-CBC  <ca> -----BEGIN CERTIFICATE----- ...snip... -----END CERTIFICATE----- -----BEGIN CERTIFICATE----- ...snip... -----END CERTIFICATE----- </ca> <cert> ...snip... -----END CERTIFICATE----- </cert> <key> -----BEGIN PRIVATE KEY----- ...snip... -----END PRIVATE KEY----- </key>  They push routes to 195.46.39.0/29 and 195.46.39.39, and push 195.46.39.39 as the DNS server. ``` [Comment 4](show_bug.cgi?id=746422#c4)  Dan Williams    2015-12-03 18:21:04 UTC  ``` Thanks for the data point Alexander.  We probably need another option on the IP4 and IP6 settings for all connections indicating whether or not split DNS should be used if it is available for that connection.  There would be a default value that would preserve existing behavior.  For Pavel's case (with a VPN grabbing all default-route traffic, but where some routes/devices are not routed over the VPN) that property would indicate that split DNS should be used.  For the SafeDNS case (where grabs all default-route traffic, but no other DNS should be used) that property would indicate that no split DNS should be used, and the DNS manager would merge/ignore DNS based on connection priority (since we will very soon support multiple VPN connections).  If the property was left as default, then ipX.never-default would control whether split DNS was used or not. ``` [Comment 5](show_bug.cgi?id=746422#c5)  Thomas Haller    2016-05-25 16:03:01 UTC  ``` (In reply to Alexander E. Patrakov from [comment #3](show_bug.cgi?id=746422#c3))  > So, in summary, they absolutely need all other DNS servers to be forgotten > by the client, even though they don't want to route all traffic through > their VPN servers.  For the record, this is now possible by [bug 758772](show_bug.cgi?id=758772 "RESOLVED FIXED - NetworkManager openVPN connection causes DNS leak") <https://cgit.freedesktop.org/NetworkManager/NetworkManager/commit/?id=8da3e658f7313f56928d22cfe13f9ab78cc1dd3c> ``` [Comment 6](show_bug.cgi?id=746422#c6)  David Woodhouse    2017-04-05 08:51:56 UTC  ``` *** [Bug 780913](show_bug.cgi?id=780913 "RESOLVED DUPLICATE - full-tunnel VPN DNS breakage") has been marked as a duplicate of this bug. *** ``` [Comment 7](show_bug.cgi?id=746422#c7)  David Woodhouse    2017-04-05 08:56:08 UTC  ``` If a VPN connection is set to take all traffic then we should definitely be using its DNS servers for all lookups. We might not even be able to *reach* the DNS server advertised by the "local" network. We *might* if it's physically on the local subnet, but almost certainly not further afield.  Note also that if you *wanted* to do split DNS, you have no idea which domains to do split DNS *FOR*. You have a list of default search domains, but that is a DIFFERENT THING. A search domain of example.com means "if the user looks up foo and it doesn't exist, then also look for foo.example.com before failing". It doesn't mean any more than that. In particular, there can be domains which exist in a VPN (such as example.internal) which are *not* added to the search domains.  If you want to add an option for doing split-DNS, it can't be a boolean and abuse the search domains. It has to be an explicit list of the domains for which you want to use that DNS service. Unless we have a separate list of "domains which exist here" for each connection, which is *distinct* from the search domains? ``` [Comment 8](show_bug.cgi?id=746422#c8)  Beniamino Galvani    2017-04-11 08:24:45 UTC  ``` (In reply to David Woodhouse from [comment #7](show_bug.cgi?id=746422#c7)) > Note also that if you *wanted* to do split DNS, you have no idea which > domains to do split DNS *FOR*. You have a list of default search domains, > but that is a DIFFERENT THING. A search domain of example.com means "if the > user looks up foo and it doesn't exist, then also look for foo.example.com > before failing". It doesn't mean any more than that.  It also means that foo.example.com should be queried over the interface that has it the search list. I don't think it makes any sense that interface X specifies domain D in the search list but we try to resolve it on interface Y.  > In particular, there > can be domains which exist in a VPN (such as example.internal) which are > *not* added to the search domains.  Yes, basically the search list is only a subset of the domains for which we want to do split DNS.  > If you want to add an option for doing split-DNS, it can't be a boolean and > abuse the search domains. It has to be an explicit list of the domains for > which you want to use that DNS service. Unless we have a separate list of > "domains which exist here" for each connection, which is *distinct* from the > search domains?  I looked at systemd-resolved documentation and it introduces the concept of "routing-only" domains, which are those domains only used for deciding the output interface, as opposed to "search" domains that are used for both completing unqualified names and for routing:   <https://www.freedesktop.org/software/systemd/man/systemd.network.html#Domains>=  and I think we could do something similar. For example, interpret domains starting with a tilde in ipvX.dns-search as routing-only. All other domains automatically obtained from DHCP/VPN/... would still be considered as standard search domains.  When the DNS backend supports split DNS (i.e. dnsmasq or systemd-resolved) I think we should always use split-DNS for the domains in the search list; and with always I mean also for non-VPN connections. In this way, queries for a domain in the search list will be forwarded only to the interface that specified it. Then, of course, we need to add wildcard rules to forward non-matching queries to all interfaces.  Borrowing another concept from systemd-resolved, we could support the wildcard routing domain "~." that means "send all all queries that don't match specific search domains to this interface". To keep backwards compatibility, if no connection provides a wildcard routing domain, we would forward all non-matching queries to all interfaces, except to VPNs that provides a search list. In this way:  - we still do split DNS for VPNs by default  - this [https://bugzilla.gnome.org/show_bug.cgi?id=766769](show_bug.cgi?id=766769 "RESOLVED FIXED - vpn with ipv6 support breaks DNS resolution completely") (VPNs that    don't push any domains should get all queries) keeps working as is  In case of a full-tunnel VPN, one could set ipv4.dns-search to "~*" on the VPN connection to direct all to the VPN DNS server. Queries for a domain provided by a local connection would still go on through local interface.  Any opinions about this idea? I pushed a draft implementation to branch bg/dns-domains-bgo746422 and it seems that it should cover all the use cases mentioned in this bz. ``` [Comment 9](show_bug.cgi?id=746422#c9)  David Woodhouse    2017-04-11 09:22:08 UTC  ``` (In reply to Beniamino Galvani from [comment #8](show_bug.cgi?id=746422#c8)) >  - we still do split DNS for VPNs by default >  - this [https://bugzilla.gnome.org/show_bug.cgi?id=766769](show_bug.cgi?id=766769 "RESOLVED FIXED - vpn with ipv6 support breaks DNS resolution completely") (VPNs that >    don't push any domains should get all queries) keeps working as is  VPNs which don't push any *routing* domains should get all queries. So that's *all* existing VPN configs. From the automatic configuration of VPNs we only ever get *search* domains.  > In case of a full-tunnel VPN, one could set ipv4.dns-search to "~*" on > the VPN connection to direct all to the VPN DNS server.  This needs to be the default, surely?  > Queries for a domain provided by a local connection would still go on  > through local interface.  Doesn't that leave me with the same problem, that it's trying to perform DNS queries to the "local" DNS server which is actually upstream (e.g. 4.2.2.1), and I can't even *route* to that IP address because all my traffic is going to the VPN?  At the very least, this logic would need to be based on whether the VPN takes the default route or not, wouldn't it? If a VPN takes the default route, it *definitely* needs all DNS traffic. If it doesn't, it probably still should unless explicitly configured otherwise. ``` [Comment 10](show_bug.cgi?id=746422#c10)  Beniamino Galvani    2017-04-11 12:47:02 UTC  ``` (In reply to David Woodhouse from [comment #9](show_bug.cgi?id=746422#c9)) > (In reply to Beniamino Galvani from [comment #8](show_bug.cgi?id=746422#c8)) > >  - we still do split DNS for VPNs by default > >  - this [https://bugzilla.gnome.org/show_bug.cgi?id=766769](show_bug.cgi?id=766769 "RESOLVED FIXED - vpn with ipv6 support breaks DNS resolution completely") (VPNs that > >    don't push any domains should get all queries) keeps working as is > > VPNs which don't push any *routing* domains should get all queries. So > that's *all* existing VPN configs. From the automatic configuration of VPNs > we only ever get *search* domains.  I think a search domain should also be implicitly used for routing, and thus VPNs do push routing domains.  IOW, if a connection provides search domain X, queries for names ending in X should only go through that connection, no?  > > In case of a full-tunnel VPN, one could set ipv4.dns-search to "~*" on > > the VPN connection to direct all to the VPN DNS server. > > This needs to be the default, surely?  See below.  > > Queries for a domain provided by a local connection would still go on > > through local interface. > > Doesn't that leave me with the same problem, that it's trying to perform DNS > queries to the "local" DNS server which is actually upstream (e.g. 4.2.2.1), > and I can't even *route* to that IP address because all my traffic is going > to the VPN?  The scenario I'm referring to is: I'm connected to a VPN getting the default route. I configure "~." as search domain on it to perform all queries through the VPN. At the same time, the DHCP server on LAN network announces a local DNS server with domain "local.foobar.com". I want that every query ending in this domains is resolved locally, not using the VPN DNS server.  If the DNS server announced by DHCP is not on LAN, I don't expect any search domain to be present for the LAN connection and so every DNS query will go through the VPN.  > At the very least, this logic would need to be based on whether the VPN > takes the default route or not, wouldn't it? If a VPN takes the default > route, it *definitely* needs all DNS traffic.  First, if we start to decide DNS policy based on routing, this would be a change in behavior and will possibly break users' configurations. If we restrict the change only to VPNs with default routes, probably it's less of a problem, and I think we can do it.  > If it doesn't, it probably still should unless explicitly configured > otherwise.  I think many people using split tunnel VPNs would complain about this change in behavior because suddenly (and possibly, without knowing it) they would start sending all DNS queries to the VPN, which can have bad privacy implications (e.g. when it's a corporate VPN). ``` [Comment 11](show_bug.cgi?id=746422#c11)  Beniamino Galvani    2017-06-26 13:39:06 UTC  ``` I've reworked a bit the branch. The main change is a new ipv{4,6}.dns-default property that replaces the "~." domain of the previous version.  I've also written a short description of the changes at:  <https://wiki.gnome.org/Projects/NetworkManager/DNS>  Please have a look at branch bg/dns-domains-bgo746422. ``` [Comment 12](show_bug.cgi?id=746422#c12)  Thomas Haller    2017-06-27 11:20:06 UTC  ``` >> dns: introduce routing domains       +         if (domain[0] == '~' && search_only) +              continue;  +         if (domain[0] == '~') { +              if (search_only) +                   continue; +         }   I don't mind which, but let's make it consistent.    >> libnm-core,cli: add support for DNS default property  +     * name servers specified by this connection. When set to %FALSE, such +     * queries are sent through all connections, excluding VPNs that provide +     * a search list.  this is not clear to me. Instead of "When set to %FALSE,...", should it be: "when no currently active connections have this property set to %TRUE, ..."     >> dns: add 'default' attribute to exported DNS entries       +         /* Add default */ +         g_variant_builder_add (&entry_builder, +                                "{sv}", +                                "default", +                                g_variant_new_boolean (is_default));  maybe only add the "default" key, if the value is actually TRUE. A missing value already means FALSE. The reason would be, not to teach users to rely on "default" being present.   minor fixup commits pushed.   the rest lgtm ``` [Comment 13](show_bug.cgi?id=746422#c13)  David Woodhouse    2017-06-27 11:40:42 UTC  ``` (In reply to Beniamino Galvani from [comment #11](show_bug.cgi?id=746422#c11)) > I've reworked a bit the branch. The main change is a new > ipv{4,6}.dns-default property that replaces the "~." domain of the > previous version.  I'm still really unhappy with this. DNS is *not* a per-protocol thing. It doesn't make sense to have separate ipv4 vs. ipv6 dns defaults, any more than it does to have defaults for different IP ranges (i.e. DNS for 10.x.x.x vs. for 11.x.x.x). (Sure we have those for reverse-DNS but not like this.)  I understand that we have inherited this to a certain extent but I'd really like to avoid entrenching it further. ``` [Comment 14](show_bug.cgi?id=746422#c14)  Thomas Haller    2017-06-29 08:13:01 UTC  ``` (In reply to David Woodhouse from [comment #13](show_bug.cgi?id=746422#c13)) > (In reply to Beniamino Galvani from [comment #11](show_bug.cgi?id=746422#c11)) > > I've reworked a bit the branch. The main change is a new > > ipv{4,6}.dns-default property that replaces the "~." domain of the > > previous version. >  > I'm still really unhappy with this. DNS is *not* a per-protocol thing. It > doesn't make sense to have separate ipv4 vs. ipv6 dns defaults, any more > than it does to have defaults for different IP ranges (i.e. DNS for 10.x.x.x > vs. for 11.x.x.x). (Sure we have those for reverse-DNS but not like this.) >  > I understand that we have inherited this to a certain extent but I'd really > like to avoid entrenching it further.  that is true.  but we cannot change API, so, all we could do is deprecate the current properties and add a new one. But the old one still has to be supported. It's not clear that this is cleaner in the result.  As for adding new DNS related settings, it probably makes sense to instead add a new "ip" section and place it there. One day, we might deprecated ipv4.dns and ipv6.dns in favor of a ip.dns. So let's do ^^? ``` [Comment 15](show_bug.cgi?id=746422#c15)  Thomas Haller    2017-06-29 08:14:20 UTC  ``` Or  [network] dns-default=...   like, [Network] in `man systemd.network` ``` [Comment 16](show_bug.cgi?id=746422#c16)  Beniamino Galvani    2017-06-29 08:46:52 UTC  ``` (In reply to Thomas Haller from [comment #14](show_bug.cgi?id=746422#c14)) > but we cannot change API, so, all we could do is deprecate the current > properties and add a new one. But the old one still has to be supported. > It's not clear that this is cleaner in the result. >  > As for adding new DNS related settings, it probably makes sense to instead > add a new "ip" section and place it there. One day, we might deprecated > ipv4.dns and ipv6.dns in favor of a ip.dns.  Or maybe DNS parameters should have their own "DNS" setting as:   dns.servers  dns.domains  dns.options  dns.priority  dns.is-default  The old properties would be copied to the new setting when the connection is normalized, to provide backwards compatibility.  An "IP" setting would instead make sense if there are other protocol-agnostic IP properties we plan to add (but I can't imagine which ones now). ``` [Comment 17](show_bug.cgi?id=746422#c17)  Thomas Haller    2017-06-29 09:23:36 UTC  ``` proxy...  Each setting instance has a large implementation over-head. We could have instead  [network] proxy-*= dns-*=   arguably,    `nmcli connection modify $NAME dns.*` is much nicer then   `nmcli connection modify $NAME network.dns-*`  (while nmcli is not required to expose nm-settings exactly the same way as they are in libnm and on D-Bus, it makes sense to do that).   tl;dr: +1 for a "dns" section. ``` [Comment 18](show_bug.cgi?id=746422#c18)  Beniamino Galvani    2018-01-10 14:01:10 UTC  ``` (In reply to Thomas Haller from [comment #17](show_bug.cgi?id=746422#c17)) > tl;dr: +1 for a "dns" section.  Ok, I'll add the new 'default' property to a 'dns' setting and I'll also move the existing connection.mdns property there, since we haven't done any official release that includes it.  I pushed some preliminary patches to branch bg/dns-domains-pt1-bgo746422, please review. ``` [Comment 19](show_bug.cgi?id=746422#c19)  Thomas Haller    2018-01-11 12:55:39 UTC  ``` (In reply to Beniamino Galvani from [comment #18](show_bug.cgi?id=746422#c18)) > (In reply to Thomas Haller from [comment #17](show_bug.cgi?id=746422#c17)) > > tl;dr: +1 for a "dns" section. >  > Ok, I'll add the new 'default' property to a 'dns' setting and I'll also > move the existing connection.mdns property there, since we haven't done any > official release that includes it.  I agree.  > I pushed some preliminary patches to branch bg/dns-domains-pt1-bgo746422, > please review.  +         if (search_only && domain_is_routing_only (str)) +              continue;  it's a bit confusing that the parameter is called "search_only", while it compares it with "routing_only". Could you rename "search_only"? Also, the inverse naming is confusing to me:    add_dns_domains (array, ip_config, FALSE, FALSE);  has search_only=FALSE, the double-inverse will result in ~all~. Could we rename "search_only" to "with_routing_only" (and inverse meaning)?     +              if (!domain_is_valid (str, FALSE)) +                   continue;  @str has possible a leading tilde. Shouldn't you strip it with "nm_utils_parse_dns_domain (str, NULL)" ?    -    /* If this link is never the default (e.g. only used for resources on this -     * network) add a routing domain. */ -    route_only =   addr_family == AF_INET -                 ? !nm_ip4_config_best_default_route_get (NM_IP4_CONFIG (config)) -                 : !nm_ip6_config_best_default_route_get (NM_IP6_CONFIG (config)); -  this behaviour came originally from <https://cgit.freedesktop.org/NetworkManager/NetworkManager/commit/?id=c4864ba63f4a13e9938a978787490005f5ba48fb>. But despite the commit message, I don't understand why we would set routing-only if nm_ip4_config_get_never_default(). I guess, this new behavior makes much more sense to me.    pushed one fixup. ``` [Comment 20](show_bug.cgi?id=746422#c20)  Beniamino Galvani    2018-01-11 14:55:32 UTC  ``` (In reply to Thomas Haller from [comment #19](show_bug.cgi?id=746422#c19)) > (In reply to Beniamino Galvani from [comment #18](show_bug.cgi?id=746422#c18)) > > (In reply to Thomas Haller from [comment #17](show_bug.cgi?id=746422#c17)) > > > tl;dr: +1 for a "dns" section. > >  > > Ok, I'll add the new 'default' property to a 'dns' setting and I'll also > > move the existing connection.mdns property there, since we haven't done any > > official release that includes it. >  > I agree. >  > > I pushed some preliminary patches to branch bg/dns-domains-pt1-bgo746422, > > please review. >  > +         if (search_only && domain_is_routing_only (str)) > +              continue; >  > it's a bit confusing that the parameter is called "search_only", while it > compares it with "routing_only". Could you rename "search_only"? > Also, the inverse naming is confusing to me: >  >   add_dns_domains (array, ip_config, FALSE, FALSE); > > has search_only=FALSE, the double-inverse will result in ~all~. Could we > rename "search_only" to "with_routing_only" (and inverse meaning)?  Changed.   > +              if (!domain_is_valid (str, FALSE)) > +                   continue; >  > @str has possible a leading tilde. Shouldn't you strip it with > "nm_utils_parse_dns_domain (str, NULL)" ?  Good catch, fixed.  > -    /* If this link is never the default (e.g. only used for resources on > this > -     * network) add a routing domain. */ > -    route_only =   addr_family == AF_INET > -                 ? !nm_ip4_config_best_default_route_get (NM_IP4_CONFIG > (config)) > -                 : !nm_ip6_config_best_default_route_get (NM_IP6_CONFIG > (config)); > - >  > this behaviour came originally from > <https://cgit.freedesktop.org/NetworkManager/NetworkManager/commit/> > ?id=c4864ba63f4a13e9938a978787490005f5ba48fb. But despite the commit > message, I don't understand why we would set routing-only if > nm_ip4_config_get_never_default(). I guess, this new behavior makes much > more sense to me.  The original behavior didn't make much sense and caused troubles (as in [bug 783024](show_bug.cgi?id=783024 "RESOLVED DUPLICATE - OpenVPN Does Not Set DNS Search Domain") and [bug 782469](show_bug.cgi?id=782469 "RESOLVED OBSOLETE - Search domains are not considered for split-tunnelling connections")). I think it's better if we add domain as search-domains by default. ``` [Comment 21](show_bug.cgi?id=746422#c21)  Thomas Haller    2018-01-11 15:53:26 UTC  ``` bg/dns-domains-pt1-bgo746422 lgtm ``` [Comment 22](show_bug.cgi?id=746422#c22)  Beniamino Galvani    2018-01-12 12:46:56 UTC  ``` First part merged to master:  <https://cgit.freedesktop.org/NetworkManager/NetworkManager/commit/?id=b2f306ac3d84283fdebb225079f354afb8c2a752> ``` [Comment 23](show_bug.cgi?id=746422#c23)  David Woodhouse    2018-03-08 21:24:21 UTC  ``` So... a VPN configuration which wants *all* DNS queries to go to the VPN's nameservers would add '~.' to the dns search list? Or just '~'? ``` [Comment 24](show_bug.cgi?id=746422#c24)  Beniamino Galvani    2018-03-09 08:41:44 UTC  ``` (In reply to David Woodhouse from [comment #23](show_bug.cgi?id=746422#c23)) > So... a VPN configuration which wants *all* DNS queries to go to the VPN's > nameservers would add '~.' to the dns search list? Or just '~'?  Yes, that is the plan ('~.') for part 2 (not implemented yet). ``` [Comment 25](show_bug.cgi?id=746422#c25)  David Woodhouse    2018-03-09 09:25:41 UTC  ``` Per discussion on IRC, I really don't like this very much. There is too much confusion already.  We should have a *clear* separation of two entirely different fields.   â¢ Search list  This is the list of domains that will be appended to failing lookups and tried again, before eventually failing. So if my search list contains "company.com, company.internal" and I attempt to look up "foo", then I get to wait while all these lookups are done in turn:     foo.    foo.company.com.    foo.company.internal.  Note that this is an *ordered* list. And it should be kept as short as possible because we don't *want* to wait for all those extra lookups. And it might not be set at all, because we might want people to use fully qualified domain names in hyperlinks and other places, without relying on this auto-completion.   â¢ Lookup list  This is the list of domains for which this connection's nameserver should be used. For a large company which has merged with lots of others, there may be *many* domains which are only visible internally, or which have schizo-DNS presenting a different view to the internal network. This may contain all of the elements in the search list, but would *also* contain others like "some-company-we-bought.com", "Â£company-corp.com", etc.  This is an unordered list. And for full-tunnel VPNs we should use the VPN DNS for *everything*, which is the subject of this bug. This is quite a serious security bug, as described in <https://bugzilla.redhat.com/show_bug.cgi?id=1553634> ``` [Comment 26](show_bug.cgi?id=746422#c26)  David Woodhouse    2018-03-09 10:07:05 UTC  ``` Some further notes:   â¢ I can make NetworkManager-openconnect provide both 'search domains' and    'split dns domain' in separate config items. Right now we mache them all    into the search domains because we know NM abuses that field for both,    but we should fix that too.   â¢ We might perhaps take this opportunity to kill the weirdness that we have    redundant DNS information in *both* IPv4 and IPv6 configs. That was always    wrong, and a clean break to make it sane might be better than letting it    persist for ever.   â¢ For a split-tunnel VPN, it's OK to have the split-dns lookup list default    to the same as the search list (plus all the reverse domains which we do    already get right, I believe). It should be possible to *add* entries to    the split-dns lookup list that aren't in the search list, both manually    in the config, and automatically from the VPN plugin (see first point above).   â¢ for a full-tunnel VPN, the split-dns lookup list should cover everything.    There *might* be an exception list â for example IF we allow routing to    the local network (cf. [bug 767288](show_bug.cgi?id=767288 "RESOLVED OBSOLETE - RFE: Route *everything* to VPN (block access to local network)") which asks for an option not to) then    the reverse lookup ranges in .ip6.arpa and the split-dns domain list of    the local network would be the only thing that's permitted *not* to go    to the VPN's nameservers.   In the general case, DNS lookups for reverse ranges in .ip6.arpa and .in-addr.arpa should go to the nameservers of the connection to which we are routing those addresses. We *mostly* get that right, except for full-tunnel VPN right now.  Forward DNS lookups by default should go to the DNS servers of the connection which has the default route. Again, we don't get that right for full-tunnel VPN right now.  Forward DNS lookups for domains which are listed in some connection's "split-dns domains list" (which I called the 'lookup list' above), could go to that connection's DNS server UNLESS there's a reason not to (like a full tunnel VPN wanting to disable *all* local access as discussed in [bug 767288](show_bug.cgi?id=767288 "RESOLVED OBSOLETE - RFE: Route *everything* to VPN (block access to local network)")). ``` [Comment 27](show_bug.cgi?id=746422#c27)  David Woodhouse    2018-03-12 12:27:26 UTC  ``` Hm... since commit [db9b7e10a](https://git.gnome.org/browse/NetworkManager/commit/?id=db9b7e10a) for [bug 707617](show_bug.cgi?id=707617 "RESOLVED FIXED - [review thaller/IP6Config_replace] core: update existing IP6Config of device instead of replacing it"), NMIP4Config already *has* separate fields for 'domains' vs. 'searches'.  Surely the "domains" list is already intended to be "routing domains", i.e. "domains for which we should do the DNS lookup to this connection's nameservers"?  While "searches" is purely the auto-completion one?   However, we seem to process them all the same. Perhaps we should stop doing that, then we don't need the '~' prefix hack... ``` [Comment 28](show_bug.cgi?id=746422#c28)  Beniamino Galvani    2018-03-22 08:44:56 UTC  ``` What is currently missing in my opinion is a flexible way to decide which connections are used for default DNS queries (those not matching any lookup domain).  A possible way to do this is to choose connections that have the highest value of a new 'dns.default-priority' property. Since we want to have default values that work for most users, the default value of the property would be 'auto' (0), which means:   * 1000 for full-tunnel VPNs  *  500 for non-VPN connections  *   -1 for split-tunnel VPNs. -1 means that the connection is never         used for default DNS lookups  For example, if you have a full-tunnel VPN with search domain 'example.com' and a local connection with search domain 'local.com', the following entries would be added to dnsmasq:  /example.com/VPN-nameserver /local.com/local-nameserver VPN-nameserver                 # default  But if the VPN is split-tunnel (doesn't get the default route):  /example.com/VPN-nameserver /local.com/local-nameserver local-nameserver               # default  If you want that all queries go through the full-tunnel VPN with no exceptions, also set ipvx.dns-priority -1 for the VPN and dnsmasq will be configured with:  /example.com/VPN-nameserver VPN-nameserver                 # default  BTW, for ipvx.dns-priority we consider lower values with higher priority while for dns.default-priority it's the other way around. I believe doing ipvx.dns-priority that way was a mistake because it is counterintuitive.  Users can also set custom value for dns.default-priority to tweak the configuration to their needs.  What do you think? Any other ideas? ``` [Comment 29](show_bug.cgi?id=746422#c29)  Beniamino Galvani    2018-03-22 08:56:40 UTC  ``` (In reply to David Woodhouse from [comment #26](show_bug.cgi?id=746422#c26)) > Some further notes: >  >  â¢ I can make NetworkManager-openconnect provide both 'search domains' and >    'split dns domain' in separate config items. Right now we mache them all >    into the search domains because we know NM abuses that field for both, >    but we should fix that too.  You can put them all in the NM_VPN_PLUGIN_IP4_CONFIG_DOMAINS key and prefix routing-only domains with a '~'.   >  â¢ We might perhaps take this opportunity to kill the weirdness that we have >    redundant DNS information in *both* IPv4 and IPv6 configs. That was always >    wrong, and a clean break to make it sane might be better than letting it >    persist for ever.  Changing this is a huge pain for users, and developers too (but this probably doesn't matter much). I can't think of a way to achieve a smooth transition from the separate DNS properties into a new common setting. ``` [Comment 30](show_bug.cgi?id=746422#c30)  David Woodhouse    2018-03-22 09:11:45 UTC  ``` > For example, if you have a full-tunnel VPN with search domain > 'example.com' and a local connection with search domain 'local.com', > the following entries would be added to dnsmasq:  Please let's not talk about search domains. Those are completely different things, not related to what we're talking about here.  Search domains are purely a way to enable users to be lazy. I can type 'intranet" into my browser and it gets autocompleted to "intranet.company.com", for example.  They (should) have *nothing* to do with the choice of which DNS lookups get sent out on which connection. (Apart from the fact that we're doing this horrid thing with mixing them all together and prefixing one with ~, which is a technical detail.)  A full-tunnel VPN should end up with a *LOOKUP* domain of "" or "*" or "." or however you want to represent the default (currently there's no way for me to specify that even manually to work around this issue, I think).   I think that implementing the "~." support as suggested in [comment 24](show_bug.cgi?id=746422#c24) and then making full-tunnel VPNs automatically add that, would go a long way to dealing with this problem.  I'm not sure I understand the benefit of adding 'dns.default-priority' too. Is that *purely* a special case of ipvx.dns-priority, except for the "~." lookup domain alone? Does it need special-casing? Can't *all* the lookup domains of a given connection have the same priority, whether they're "~." or "~company.com." ? ``` [Comment 31](show_bug.cgi?id=746422#c31)  David Woodhouse    2018-03-22 09:19:31 UTC  ``` (In reply to Beniamino Galvani from [comment #29](show_bug.cgi?id=746422#c29)) > >  â¢ We might perhaps take this opportunity to kill the weirdness that we have > >    redundant DNS information in *both* IPv4 and IPv6 configs. That was always > >    wrong, and a clean break to make it sane might be better than letting it > >    persist for ever. >  > Changing this is a huge pain for users, and developers too (but this > probably doesn't matter much). I can't think of a way to achieve a smooth > transition from the separate DNS properties into a new common setting.  It's a short-term pain, which will eventually go away.  Can't we start by shadowing the ipv?.dns-* options into a generic dns.* option set so that they're identical? We can give people a long time to start using the new location, before eventually taking away the old ones.  We definitely shouldn't be making the problem *worse* by doing things like the ~ prefix hack or adding any *more* fields to ipv?.dns-*. Can't we at least add that as dns.lookup-domain even if it's all by itself in the "DNS" settings for now? ``` [Comment 32](show_bug.cgi?id=746422#c32)  David Woodhouse    2018-03-22 09:37:09 UTC  ``` I think this can work without a new default-priority field, and just a simple set of lookup domains per connection in conjunction with the existing dns-priority.  You have a set of { domain, connection, priority } tuples. (Where all lookup domains of a given connection have the *same* priority right now; there's no real need to make them individually configurable I think).  Where multiple lookup rules exist for a given domain, the highest priority (numerically lowest) one wins. And when a given rule is for a domain which is a *subdomain* of another domain with a negative dns-priority, that subdomain also loses (and is dropped).  So your first example in [comment 28](show_bug.cgi?id=746422#c28) would look like this:  { "example.com", vpn0, 50 } { local.com, eth0, 100 } { ".", vpn0, 50 } { ".", eth0, 100 }  # This one gets dropped due to the previous one  Your second example looks like this (because a split tunnel VPN doesn't add the "~." lookup domain:  { "example.com", vpn0, 50 } { "local.com", eth0, 100 } { ".", eth0, 100 }  And your final example looks like this, because the user has set dns-priority=-1:   { "example.com", vpn0, -1 } { local.com, eth0, 100 } # This one gets dropped due to the next one { ".", vpn0, -1 } { ".", eth0, 100 }  # This one gets dropped due to the previous one ``` [Comment 33](show_bug.cgi?id=746422#c33)  David Woodhouse    2018-03-22 09:39:05 UTC  ``` The idea is that VPNs would automatically have the "~." default lookup domain added, according to the never-default flag. ``` [Comment 34](show_bug.cgi?id=746422#c34)  Beniamino Galvani    2018-03-22 10:22:04 UTC  ``` (In reply to David Woodhouse from [comment #31](show_bug.cgi?id=746422#c31)) > (In reply to Beniamino Galvani from [comment #29](show_bug.cgi?id=746422#c29)) > > >  â¢ We might perhaps take this opportunity to kill the weirdness that we have > > >    redundant DNS information in *both* IPv4 and IPv6 configs. That was always > > >    wrong, and a clean break to make it sane might be better than letting it > > >    persist for ever. > >  > > Changing this is a huge pain for users, and developers too (but this > > probably doesn't matter much). I can't think of a way to achieve a smooth > > transition from the separate DNS properties into a new common setting. >  > It's a short-term pain, which will eventually go away.  Maybe, but existing properties are part of the API and so they will never be dropped because we don't break API between releases. We'll have to maintain them, together with the new properties and the code to sync them forever.  > Can't we start by shadowing the ipv?.dns-* options into a generic dns.* > option set so that they're identical? We can give people a long time to > start using the new location, before eventually taking away the old ones.  If you mean that ipv4.dns-*, ipv6.dns-* and dns.* should be all identical, that is a change in behavior and would badly break users.  If by shadowing you mean keeping them is sync (with the dns.* as the union of ipv4.dns-* and ipv6.dns-*), that is possible but would create some other problems in my opinion.    > We definitely shouldn't be making the problem *worse* by doing things like > the ~ prefix hack or adding any *more* fields to ipv?.dns-*. Can't we at > least add that as dns.lookup-domain even if it's all by itself in the "DNS" > settings for now?  Ok, we aren't going to add any new properties to ipvx.dns-*. Yes, I think we can add a dns.lookup-domain property. ``` [Comment 35](show_bug.cgi?id=746422#c35)  David Woodhouse    2018-03-22 12:16:25 UTC  ``` Right, the idea was the dns.* properties would be the union of the ipv4.dns-* and ipv6.dns-* (which right now are treated identically and just appended to each other, I believe?).   Note: it's "lookup domains" we should be using for the proxy setup we poke into PacRunner, not "search domains". Can we fix that too please? ``` [Comment 36](show_bug.cgi?id=746422#c36)  Beniamino Galvani    2018-03-26 16:40:20 UTC  ``` I pushed branch bg/dns-bgo746422. I think it should solve the leaks in case of full-tunnel VPNS when using dnsmasq or systemd-resolved. It basically:   - allows users to specify that connections get the default lookup    domain through the special entry "~."   - automatically adds "~." to connections with the default route   - applies rules from [comment 32](show_bug.cgi?id=746422#c32) to decide which domains are used    based on DNS priority.  Other things that I didn't do, but can be done later (if necessary) are:   - as noticed by Thomas, you can't override the NM decision of    automatically adding "~." to connections with default route.    Actually, you can add "~." to another connection with a lower    priority value, and it will override the "~." added by NM on the    first connection. Perhaps this is enough. Otherwise we could    introduce another special domain.   - I haven't added a new dns setting with duplicates of the existing    ipvx properties. I think it's really a different issue and should    be solved separately.   - Also I didn't add the dns.lookup-domain property, as the "~."    domain is sufficient and it is just another case of the    routing-only domains we already support.  What do you think? ``` [Comment 37](show_bug.cgi?id=746422#c37)  Thomas Haller    2018-03-26 17:21:21 UTC  ``` > dns: dnsmasq: fix adding multiple domains  can you add a "Fixes" comment?   > core: allow '~.' domain in ip4 and ip6 configs      +    if (!nm_streq (search, "~.")) {           len = strlen (search);           if (search[len - 1] == '.')                search[len - 1] = 0; +    }  this seems wrong, for example if "search" is "~..". Either, do a full normalization and drop such entires (or clean up the duplicate dots). Or: normalize "~." to "~" too. It's odd that the special domain is treated entirely different regardingt the trailing dot.   > dns: use dns-priority to provide a preprocessed domain list to plugins            _LOGD ("update-dns: updating plugin %s", plugin_name); +         rebuild_domain_lists (self);           if (!nm_dns_plugin_update (plugin,  do we need to rebuild the list every time? We know when an update changes something. Can we cache the result, generate it when needed, and clear it when something changes?   +    struct { +         const char **search; +         char **reverse; +    } domains;  } NMDnsIPConfigData;   I think these are leaked.   > dns: dnsmasq: honor dns-priority      +    int addr_family, i, j, num;  let's use guint for index variables of arrays? Also matches    num = nm_ip_config_get_num_nameservers (ip_config);    > dns: sd-resolved: honor dns-priority      -         NMIPConfig *ip_config = elem->data; +         NMDnsIPConfigData *data = elem->data; +         NMIPConfig *ip_config = data->ip_config;  this seems wrong.    Overall, lgtm ``` [Comment 38](show_bug.cgi?id=746422#c38)  Beniamino Galvani    2018-03-28 12:29:49 UTC  ``` (In reply to Thomas Haller from [comment #37](show_bug.cgi?id=746422#c37)) > > dns: dnsmasq: fix adding multiple domains >  > can you add a "Fixes" comment?  Done.  > > core: allow '~.' domain in ip4 and ip6 configs >      > +    if (!nm_streq (search, "~.")) { >           len = strlen (search); >           if (search[len - 1] == '.') >                search[len - 1] = 0; > +    } >  > this seems wrong, for example if "search" is "~..". > Either, do a full normalization and drop such entires (or clean up the > duplicate dots). Or: normalize "~." to "~" too. It's odd that the special > domain is treated entirely different regardingt the trailing dot.  What do you mean by "full normalization"?   We can convert 'domain.' into 'domain' because it's equivalent, but 'domain..' or 'my..domain' are invalid and they should be dropped. I think this would be the best approach.  If we normalize '~.' to '~', once we strip the ~ prefix the domain would become empty, which is not desirable in my opinion.  > > dns: use dns-priority to provide a preprocessed domain list to plugins >  >           _LOGD ("update-dns: updating plugin %s", plugin_name); > +         rebuild_domain_lists (self); >           if (!nm_dns_plugin_update (plugin, >  > do we need to rebuild the list every time? We know when an update changes > something. Can we cache the result, generate it when needed, and clear it > when something changes?  If nothing changes, the DNS configuration hash will be the same and update_dns() won't be called at all by nm_dns_manager_end_updates().  Ok, nm_dns_manager_set_hostname() calls update_dns() without checking the hash, but do we need another caching mechanism different from the existing one just for this case?  > +    struct { > +         const char **search; > +         char **reverse; > +    } domains; >  } NMDnsIPConfigData; > > I think these are leaked.  Ops, fixed.  > > dns: dnsmasq: honor dns-priority >      > +    int addr_family, i, j, num; >  > let's use guint for index variables of arrays? Also matches  >   num = nm_ip_config_get_num_nameservers (ip_config);  Ok.  > > dns: sd-resolved: honor dns-priority >      > -         NMIPConfig *ip_config = elem->data; > +         NMDnsIPConfigData *data = elem->data; > +         NMIPConfig *ip_config = data->ip_config; >  > this seems wrong.  Why? Looks fine to me. ``` [Comment 39](show_bug.cgi?id=746422#c39)  Thomas Haller    2018-03-28 12:50:01 UTC  ``` (In reply to Beniamino Galvani from [comment #38](show_bug.cgi?id=746422#c38)) > (In reply to Thomas Haller from [comment #37](show_bug.cgi?id=746422#c37))  > What do you mean by "full normalization"?  >  > We can convert 'domain.' into 'domain' because it's equivalent, but > 'domain..' or 'my..domain' are invalid and they should be dropped. I > think this would be the best approach.  I mean, to handle "my..domain". Either normalize the double . away, or verify it and drop it as invalid. If you don't do either, then "~.." will end up being treated like "~." which is wrong.  > If we normalize '~.' to '~', once we strip the ~ prefix the domain > would become empty, which is not desirable in my opinion.  Yes, after dropping the default domain becomes "". It's not that you currently use the domain "." as-is. You do:    nm_streq (domain, ".") ? NULL : domain)  that could also be:    nm_streq (domain, "") ? NULL : domain)  or  #define DEFAULT_DOMAIN ""   nm_streq (domain, DEFAULT_DOMAIN) ? NULL : domain)  (maybe a define is in order either way).   > > > dns: use dns-priority to provide a preprocessed domain list to plugins > >  > >           _LOGD ("update-dns: updating plugin %s", plugin_name); > > +         rebuild_domain_lists (self); > >           if (!nm_dns_plugin_update (plugin, > >  > > do we need to rebuild the list every time? We know when an update changes > > something. Can we cache the result, generate it when needed, and clear it > > when something changes? >  > If nothing changes, the DNS configuration hash will be the same and > update_dns() won't be called at all by nm_dns_manager_end_updates(). >  > Ok, nm_dns_manager_set_hostname() calls update_dns() without checking > the hash, but do we need another caching mechanism different from the > existing one just for this case?  Maybe the hashing mechanism is anyway ugly, and should be dropped (in a future commit). Instead of implementing a SHA-hashing of ~some~ parameters, implement a cmp() function. It's more efficient, and easier to get right.   > > > dns: sd-resolved: honor dns-priority > >      > > -         NMIPConfig *ip_config = elem->data; > > +         NMDnsIPConfigData *data = elem->data; > > +         NMIPConfig *ip_config = data->ip_config; > >  > > this seems wrong. >  > Why? Looks fine to me.  you are right. ``` [Comment 40](show_bug.cgi?id=746422#c40)  Beniamino Galvani    2018-04-08 09:09:45 UTC  ``` (In reply to Thomas Haller from [comment #39](show_bug.cgi?id=746422#c39)) > (In reply to Beniamino Galvani from [comment #38](show_bug.cgi?id=746422#c38)) > > (In reply to Thomas Haller from [comment #37](show_bug.cgi?id=746422#c37)) >  > > What do you mean by "full normalization"?  > >  > > We can convert 'domain.' into 'domain' because it's equivalent, but > > 'domain..' or 'my..domain' are invalid and they should be dropped. I > > think this would be the best approach. >  > I mean, to handle "my..domain". Either normalize the double . away, or > verify it and drop it as invalid. If you don't do either, then "~.." will > end up being treated like "~." which is wrong. >  > > If we normalize '~.' to '~', once we strip the ~ prefix the domain > > would become empty, which is not desirable in my opinion. >  > Yes, after dropping the default domain becomes "". It's not that you > currently use the domain "." as-is. You do: >  >   nm_streq (domain, ".") ? NULL : domain) >  > that could also be: >  >   nm_streq (domain, "") ? NULL : domain) >  > or >  > #define DEFAULT_DOMAIN "" >   nm_streq (domain, DEFAULT_DOMAIN) ? NULL : domain) >  > (maybe a define is in order either way).  Yeah, considering "" internally as the wildcard domain simplifies things a bit. I've updated the branch.  > Maybe the hashing mechanism is anyway ugly, and should be dropped (in a > future commit). Instead of implementing a SHA-hashing of ~some~ parameters, > implement a cmp() function. It's more efficient, and easier to get right.  A agree, this could be an improvement (for the future). ``` [Comment 41](show_bug.cgi?id=746422#c41)  Thomas Haller    2018-04-13 11:45:05 UTC  ``` > core: allow '~.' domain in ip4 and ip6 configs  commit [bebafff7844228d018d17f0d11c5d6035dbf6a91](https://git.gnome.org/browse/NetworkManager/commit/?id=bebafff7844228d018d17f0d11c5d6035dbf6a91), lgtm, but the commit message no longer seams to match, does it?   > dns: use dns-priority to provide a preprocessed domain list to plugins  +    c_list_for_each_entry (ip_data, _ip_config_lst_head (self), ip_config_lst) {  the list head is accessed on every iteration. Could we pre-cache the value like:      CList *ip_config_lst_head;      ip_config_lst_head = _ip_config_lst_head (self);      c_list_for_each_entry (ip_data, ip_config_lst_head, ip_config_lst) {      (and below again)   +         int i, n, n_domains = 0;  these variables are used to iterate over a number of guint values. Like    n = nm_ip_config_get_num_searches (ip_config);  where get_num_searches() returns a guint. Could we consistently use the correct type? (yes, I know that C might optimize signed for loops better, because it assumes that signed cannot overflow. But IMO consistent use of types is more important than what the compiler might do).   +         priority = nm_ip_config_get_dns_priority (ip_config); +         nm_assert (priority != 0);  this invariant is not enforced by NMIPxConfig, so, you basically assert that all callers that create an NMIPxConfig properly initialize priority to a non-zero value. It asserts something that is two layers of code away. That is non-obvious. Not sure what to do about this. Ok, fine as is :)   add the wilcard domain to all non-VPN         ^^^^^^^   +    parent_priority = GPOINTER_TO_INT (g_hash_table_lookup (ht, ".")); +    if (parent_priority < 0 && parent_priority < priority) { +         *out_parent = "."; +         *out_parent_priority = parent_priority;  is "." still right? Should this be "" to mean the wildcard domain?     could you add a    nm_assert (!g_hash_table_contains (ht, domain)); to domain_is_shadowed() -- because that one is already checked before calling domain_is_shadowed().             g_free (ip_data->domains.search);  I always like avoiding unnecessary copies. But in this case, "search" array will point inside strings owned by NMIPxConfig. That seems quite fragile to me. Should we not clone them? In practice it's not necessary, but it feels fragile. What can we do about that?    Â»Â·Â·Â·/* Free the array and return NULL if the only element was the ending NULL */ Â»Â·Â·Â·strv = (char **) g_ptr_array_free (domains, (domains->len == 1));  Â»Â·Â·Â·return _nm_utils_strv_cleanup (strv, FALSE, FALSE, TRUE);  skip_repeated=TRUE likely won't help much, because duplicated domains are probably not sorted after each other. Maybe sort them first? Maybe by cherry-picking "shared: add nm_utils_strv_sort() helper" from <https://github.com/NetworkManager/NetworkManager/pull/91> ``` [Comment 42](show_bug.cgi?id=746422#c42)  Michael Biebl    2018-04-14 11:11:17 UTC  ``` Will those changes be pulled into the nm-1-10 branch as well? ``` [Comment 43](show_bug.cgi?id=746422#c43)  Beniamino Galvani    2018-04-30 12:32:23 UTC  ``` (In reply to Thomas Haller from [comment #41](show_bug.cgi?id=746422#c41)) > > core: allow '~.' domain in ip4 and ip6 configs >  > commit [bebafff7844228d018d17f0d11c5d6035dbf6a91](https://git.gnome.org/browse/NetworkManager/commit/?id=bebafff7844228d018d17f0d11c5d6035dbf6a91), > lgtm, but the commit message no longer seams to match, does it?  > the list head is accessed on every iteration. Could we pre-cache the value > like:  > +         int i, n, n_domains = 0; >  > these variables are used to iterate over a number of guint values. Like >  >   n = nm_ip_config_get_num_searches (ip_config); >  > where get_num_searches() returns a guint. Could we consistently use the > correct type?  > add the wilcard domain to all non-VPN  > is "." still right? Should this be "" to mean the wildcard domain?  > could you add a >    nm_assert (!g_hash_table_contains (ht, domain)); > to domain_is_shadowed() -- because that one is already checked before > calling domain_is_shadowed().  Fixed all the above.   > I always like avoiding unnecessary copies. But in this case, "search" array > will point inside strings owned by NMIPxConfig. That seems quite fragile to > me. Should we not clone them? In practice it's not necessary, but it feels > fragile. What can we do about that?  Now the list is cleared just after nm_dns_plugin_update() returns to ensure that elements in the list don't become stale. What do you think?  > Â»Â·Â·Â·/* Free the array and return NULL if the only element was the ending > NULL */ > Â»Â·Â·Â·strv = (char **) g_ptr_array_free (domains, (domains->len == 1)); >  > Â»Â·Â·Â·return _nm_utils_strv_cleanup (strv, FALSE, FALSE, TRUE); >  > skip_repeated=TRUE likely won't help much, because duplicated domains are > probably not sorted after each other. Maybe sort them first? Maybe by > cherry-picking "shared: add nm_utils_strv_sort() helper" from > <https://github.com/NetworkManager/NetworkManager/pull/91>  I don't understand, duplicate domains don't have to be consecutive with current _nm_utils_strv_cleanup() implementation. ``` [Comment 44](show_bug.cgi?id=746422#c44)  Beniamino Galvani    2018-04-30 12:33:39 UTC  ``` I've added some NM-CI tests to ensure the behavior is the one we expect:  <https://github.com/NetworkManager/NetworkManager-ci/pull/180> ``` [Comment 45](show_bug.cgi?id=746422#c45)  Beniamino Galvani    2018-04-30 12:42:40 UTC  ``` (In reply to Michael Biebl from [comment #42](show_bug.cgi?id=746422#c42)) > Will those changes be pulled into the nm-1-10 branch as well?  Let's wait until the branch is merged to master and see if there are any issues. If there are no complaints, we can think about backporting it to a stable branch. ``` [Comment 46](show_bug.cgi?id=746422#c46)  Thomas Haller    2018-04-30 13:18:56 UTC  ``` > I don't understand, duplicate domains don't have to be consecutive with > current _nm_utils_strv_cleanup() implementation.  How do you mean?  calling "_nm_utils_strv_cleanup (strv, FALSE, FALSE, TRUE);" with skip_repeated=TRUE will remove "consecutive duplicates". That doesn't seem useful, because most of the time (given how the array is constructed), duplicates are not consecutive. so either: do not drop any duplicates and do skip_repeated=FALSE or: drop all duplicates, by sorting the array first, followed by skip_repeated=TRUE. ``` [Comment 47](show_bug.cgi?id=746422#c47)  Lubomir Rintel    2018-05-14 07:36:41 UTC  ``` bg/dns-domains-bgo746422 LGTM ``` [Comment 48](show_bug.cgi?id=746422#c48)  Lubomir Rintel    2018-05-14 07:59:27 UTC  ``` That is, bg/dns-bgo746422 LGTM ``` [Comment 49](show_bug.cgi?id=746422#c49)  Beniamino Galvani    2018-05-14 13:32:11 UTC  ``` Merged to master:  <https://cgit.freedesktop.org/NetworkManager/NetworkManager/commit/?id=d9782589248e61c0cb5aec90e3eb62612891116b> ``` [Comment 50](show_bug.cgi?id=746422#c50)  David Woodhouse    2018-05-14 14:44:19 UTC  ``` FWIW the original situation appears to be fairly broken regardless of the security situation. I've lost count of the number of times in my recent travels that the DNS servers of the airport/hotel/etc. in which I find myself are *not* directly on the local subnet. And thus aren't accessible as soon as I join the VPN.  If that situation is going to be allowed to persist in any form (especially if it's the default and we have to take special action to give the VPN nameservers top priority), then we should fix that by explicitly adding routes to them, as I've been having to do manually:   $ ip route default dev vpn0  proto static  scope link  metric 50  default via 10.246.8.1 dev wlp2s0  proto static  metric 600  8.8.4.4 via 10.246.8.1 dev wlp2s0  8.8.8.8 via 10.246.8.1 dev wlp2s0 ``` [Comment 51](show_bug.cgi?id=746422#c51)  Olivier Tilloy    2018-10-15 15:02:19 UTC  ``` (In reply to Beniamino Galvani from [comment #45](show_bug.cgi?id=746422#c45)) > (In reply to Michael Biebl from [comment #42](show_bug.cgi?id=746422#c42)) > > Will those changes be pulled into the nm-1-10 branch as well? >  > Let's wait until the branch is merged to master and see if there are > any issues. If there are no complaints, we can think about backporting > it to a stable branch.  Now that this has been in master and 1.12 for a few months, is this something you would consider backporting to 1.10 ? ``` [Comment 52](show_bug.cgi?id=746422#c52)  Thomas Haller    2018-10-15 18:35:16 UTC  ``` (In reply to Olivier Tilloy from [comment #51](show_bug.cgi?id=746422#c51)) > (In reply to Beniamino Galvani from [comment #45](show_bug.cgi?id=746422#c45)) > > (In reply to Michael Biebl from [comment #42](show_bug.cgi?id=746422#c42)) > > > Will those changes be pulled into the nm-1-10 branch as well? > >  > > Let's wait until the branch is merged to master and see if there are > > any issues. If there are no complaints, we can think about backporting > > it to a stable branch. >  > Now that this has been in master and 1.12 for a few months, is this > something you would consider backporting to 1.10 ?  Can you describe who would pick up the upstream patches if they get backported?  Would 1.10 branch be far enough?  Would you then rebase to a minor 1.10.z release, or would you just cherry-pick the patches? ``` [Comment 53](show_bug.cgi?id=746422#c53)  David Woodhouse    2018-10-15 21:03:59 UTC  ``` I'd like to see them in a Fedora release, which is preferably via a 1.10.z release rather than just cherry-picking the patches.  Also Ubuntu but they basically never fix anything so I suppose that's unlikely. I'd still like it in a 1.10.z release so they don't have any *excuse* though. ``` [Comment 54](show_bug.cgi?id=746422#c54)  Sebastien Bacher    2018-10-16 08:39:10 UTC  ``` @David, I don't think that comment is either constructive or true. We have somewhat limited resources and struggle a bit sometime to keep up with network-manager bugfixes/update but we would backport a fix for this bug to our stable serie if there is one landing in the 1.10 vcs. ``` [Comment 55](show_bug.cgi?id=746422#c55)  Beniamino Galvani    2018-10-17 15:46:55 UTC  ``` The backport is quite complicated due to several changes that made the DNS code in nm-1-12 diverge from nm-1-10. The th/policy-and-mdns branch [1] alone changed:   src/dns/nm-dns-dnsmasq.c           | 330 +++++++++++++--------------------  src/dns/nm-dns-manager.c           | 581 +++++++++++++++++++++++++++++++++-------------------------  src/dns/nm-dns-systemd-resolved.c  | 219 ++++++++++++++--------  so, unless we decide to also backport that branch, the backport of the fix requires reimplementing several non-trivial patches on top of 1.10, with the high risk of breaking things.  If we also backport the th/policy-and-mdns branch, we would need to backport a total of 30+ commits, including mDNS support and related libnm API.  Any opinions? This latter approach seems doable, but it is a big change for a minor release.  [1] <https://cgit.freedesktop.org/NetworkManager/NetworkManager/log/?qt=range&q=5eea9be983bd95f5a482e483a438a100b80c716f> ``` [Comment 56](show_bug.cgi?id=746422#c56)  Thomas Haller    2018-10-17 16:27:36 UTC  ``` (In reply to Beniamino Galvani from [comment #55](show_bug.cgi?id=746422#c55)) > > Any opinions? This latter approach seems doable, but it is a big > change for a minor release.  Backporting th/policy-and-mdns too, seems favourable to me. As long, as the cherry-picks are trivial, the result will all be code which is on master and tested for a while already. I'd rather cherry-pick more patches just to make them apply, instead of reimplementing them. YMMV. ``` [Comment 57](show_bug.cgi?id=746422#c57)  Olivier Tilloy    2018-11-16 18:48:22 UTC  ``` IÂ confirm that the Ubuntu desktop team would be interested in picking up the update if this fix and related branches were to be backported to the 1.10 branch.  Is this something we can reasonably expect? ``` [Comment 58](show_bug.cgi?id=746422#c58)  Thomas Haller    2018-11-16 20:23:00 UTC  ``` it's backported to nm-1-10 branch: <https://cgit.freedesktop.org/NetworkManager/NetworkManager/commit/?id=1e486a721de1fec76c81bfc461671a7fbdae531b> ``` [Comment 59](show_bug.cgi?id=746422#c59)  Olivier Tilloy    2018-11-19 21:51:26 UTC  ``` Excellent, thank you Thomas! ``` [Comment 60](show_bug.cgi?id=746422#c60)  Beniamino Galvani    2018-11-20 10:58:33 UTC  ``` The fix is included also in the 1.10.14 release. ``` [Comment 61](show_bug.cgi?id=746422#c61)  Olivier Tilloy    2018-11-20 21:25:17 UTC  ``` That's handy. The backport to Ubuntu 18.04 is being tracked by [https://bugs.launchpad.net/ubuntu/+source/network-manager/+bug/1754671](https://bugs.launchpad.net/ubuntu/%2Bsource/network-manager/%2Bbug/1754671). ``` [Comment 62](show_bug.cgi?id=746422#c62)  David Woodhouse    2019-02-04 22:37:35 UTC  ``` I've finally managed to test the Ubuntu 18.04 backport; apologies for the delay.  At first it seemed to work. I tried an internal domain which isn't the main $COMPANY.com and isn't in the default search domains for the VPN, and it worked after the upgrade.  Some hours later, I was unable to get a Kerberos ticket because various other DNS lookups, even within the main $COMPANY.com domain, were being done on the local network and not the VPN.  I manually set ipv4.dns-priority=-1 and ipv4.dns-search=~. but this is a full-tunnel VPN; surely I shouldn't have needed to do that part manually?  (Sebastian, apologies for the somewhat grumpy comment earlier. I am very happy to be proved wrong.) ``` [Comment 63](show_bug.cgi?id=746422#c63)  David Woodhouse    2019-02-04 22:38:28 UTC  ``` Gr, and apologies too for spelling your name wrong, Sebastien. ``` [Comment 64](show_bug.cgi?id=746422#c64)  Beniamino Galvani    2019-02-05 08:18:22 UTC  ``` Hi,  can you please attach the log file generated in this way:   # nmcli general logging level trace  # journalctl -u NetworkManager -f > dns-log.txt &  # killall -HUP NetworkManager  # kill %1  when the DNS is wrongly configured? Thanks. ``` [Comment 65](show_bug.cgi?id=746422#c65)  David Woodhouse    2019-02-05 09:44:20 UTC  ``` Before I do that, do we agree that I shouldn't have needed to manually set dns-priority and dns-search as described in [comment 62](show_bug.cgi?id=746422#c62), for a VPN connection which is full-tunnel? ``` [Comment 66](show_bug.cgi?id=746422#c66)  Beniamino Galvani    2019-02-05 10:00:35 UTC  ``` (In reply to David Woodhouse from [comment #65](show_bug.cgi?id=746422#c65)) > Before I do that, do we agree that I shouldn't have needed to manually set > dns-priority and dns-search as described in [comment 62](show_bug.cgi?id=746422#c62), for a VPN connection > which is full-tunnel?  Yes, the full-tunnel VPN should have higher priority.  We have an automated CI test to check this scenario:   <https://github.com/NetworkManager/NetworkManager-ci/blob/master/nmcli/features/dns.feature#L403>  and it seems to be working well. ``` [Comment 67](show_bug.cgi?id=746422#c67)  David Woodhouse    2019-02-05 11:37:09 UTC  ``` Ack, then I will remove those settings and test again. With dnsmasq, OK? This can never work with plain resolv.conf anyway.  Thanks. ``` [Comment 68](show_bug.cgi?id=746422#c68)  Beniamino Galvani    2019-02-05 11:50:56 UTC  ``` (In reply to David Woodhouse from [comment #67](show_bug.cgi?id=746422#c67)) > Ack, then I will remove those settings and test again. With dnsmasq, OK?  Yes, thanks. ``` [Comment 69](show_bug.cgi?id=746422#c69)  David Woodhouse    2019-08-21 09:03:43 UTC  ``` Without the ipv4.dns-priority and ipv4.dns-search settings being manually set, I see the wired device still being used for its own search domain. This is what causes the problem.  It seems to work for me if I set *only* ipv4.dns-priority=-1 though.  My biggest practical problem here was that we had set ipv4.dns-priority and ipv4.dns-search options in an emergency deployment to our users after Ubuntu shipped the 1.10.14 update to 18.04 to fix this... and then when they *pulled* the update, new installations got the new config but older NM, and that didn't work correctly either.  I'm going to experiment with *just* setting ipv4.dns-priority=-1 and not ipv4.dns-search. Do we expect that to work for everyone, whether they have the updated package or not?   We should be setting ipv4.dns-priority=1 by default for full-tunnel VPNs, but at least if I can find a way to work around it that works for everyone, that'll be an improvement. ``` [Comment 70](show_bug.cgi?id=746422#c70)  David Woodhouse    2019-08-21 11:33:44 UTC  ``` No, ipv4.dns-priority=-1 breaks older NM because there, there's no default routing domain ~. and not even any way to set it. So lookups outside the VPN domains are just refused instead of being leaked to the local nameservers as they were before.  As it happens, we configure our DHCP client to always override the discovered search domains to our corporate AD domain dom.company.com, so I can work around NM's failure to automatically set ipv4.dns-priority=-1 a different way â by manually configuring the VPN with ipv4.dns-domains=dom.company.com;company.com;. That works for both old and new NetworkManager. ``` [Comment 71](show_bug.cgi?id=746422#c71)  Beniamino Galvani    2019-08-22 07:51:33 UTC  ``` > My biggest practical problem here was that we had set > ipv4.dns-priority and ipv4.dns-search options in an emergency > deployment to our users after Ubuntu shipped the 1.10.14 update to > 18.04 to fix this... and then when they *pulled* the update, new > installations got the new config but older NM, and that didn't work > correctly either.  > I'm going to experiment with *just* setting ipv4.dns-priority=-1 and > not ipv4.dns-search. Do we expect that to work for everyone, whether > they have the updated package or not?  Yes, this should work the same on 1.10.14 and 1.12+ releases.  > We should be setting ipv4.dns-priority=1 by default for full-tunnel > VPNs, but at least if I can find a way to work around it that works > for everyone, that'll be an improvement.  Do you mean -1? Why? This will cause an opposite problem: local queries leaked to the VPN, i.e. I look up nas.myhome and the query goes through the VPN.  > No, ipv4.dns-priority=-1 breaks older NM because there, there's no default routing domain ~. and not even any way to set it  Which version is 'older'? ``` [Comment 72](show_bug.cgi?id=746422#c72)  David Woodhouse    2019-08-22 10:25:44 UTC  ``` In my case, 'older' is 1.10.6. At this point I'm just trying to get things working for my users on Ubuntu 18.04. So I'm comparing 1.10.6 (the current Ubuntu package) with 1.10.14 (the update, that was briefly shipped in 18.04 updates and then withdrawn).  When the 1.10.14 update went out, it broke our users because lookups for the dom.company.com AD domain were now always going to the local network (because of our dhclient config override). We immediately rolled out a manual setting of ipv4.dns-priority=-1 (yes, not =1) to fix it.  Then the Ubuntu 1.10.14 update was withdrawn, and new installations got 1.10.6 which *doesn't* work with ipv4.dns-priority=-1, because there's no ~. routing domain and thus lookups outside the VPN domains don't work at all.  (We don't care about local lookups not working. In fact we'd prefer local lookups *not* to work, which might be part of the reason we've overridden the search domain obtained by DHCP. If we could stop *routing* to the local network from working, we would. It's an open feature request, I believe.)  But *because* I know the search domain on the local physical network will always be just 'dom.company.com', adding that explicitly in the VPN config is enough and I don't need ipv4.dns-priority=-1. Now I have a config that works with both 1.10.6 and 1.10.14. So I can wait for the regressions that caused the 1.10.14 update to be pulled, to get fixed and then maybe later I can set ipv4.dns-priority=-1 again.    Anyway, we now know that the reason my initial testing of the Ubuntu 1.10.14 backport was unsuccessful, was because of the search domain on the *local* network. I've been able to work around that, and things are now working OK. ``` [Comment 73](show_bug.cgi?id=746422#c73)  AndrÃ© Klapper    2020-11-12 14:31:19 UTC  ``` bugzilla.gnome.org is being shut down in favor of a GitLab instance.  We are closing all old bug reports and feature requests in GNOME Bugzilla which have not seen updates for a long time.  If you still use NetworkManager and if you still see this bug / want this feature in a recent and supported version of NetworkManager, then please feel free to report it at <https://gitlab.freedesktop.org/NetworkManager/NetworkManager/-/issues/>  Thank you for creating this report and we are sorry it could not be implemented (workforce and time is unfortunately limited). ``` |  |
| --- | --- |

---

---

* + [Home](./)
  + | New
  + | [Browse](page.cgi?id=browse.html&product=NetworkManager)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](page.cgi?id=reports.html)
  + |
    [Help](http://www.bugzilla.org/docs/4.4/en/html/bug_page.html)
  + |
    [Log In](show_bug.cgi?id=746422&GoAheadAndLogIn=1)

    Remember

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=746422&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from lists.opensuse.org_22300236_20250125_064705.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/C5HHHP6HRC27GJXSH33SJTDNWTSVTWFT/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/C5HHHP6HRC27GJXSH33SJTDNWTSVTWFT/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/C5HHHP6HRC27GJXSH33SJTDNWTSVTWFT/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/C5HHHP6HRC27GJXSH33SJTDNWTSVTWFT/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/C5HHHP6HRC27GJXSH33SJTDNWTSVTWFT/#C5HHHP6HRC27GJXSH33SJTDNWTSVTWFT)

# [security-announce] openSUSE-SU-2019:1494-1: moderate: Security update for NetworkManager

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

3 Jun
2019

3 Jun
'19

10:17

openSUSE Security Update: Security update for NetworkManager
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2019:1494-1
Rating: moderate
References: #1086263
Cross-References: CVE-2018-1000135
Affected Products:
openSUSE Leap 15.0
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes one vulnerability is now available.
Description:
This update for NetworkManager fixes the following issues:
Following security issue was fixed:
- CVE-2018-1000135: A potential leak of private DNS queries to other DNS
servers could happen while on VPN (bsc#1086263, bgo#746422).
This update was imported from the SUSE:SLE-15:Update update project.
Patch Instructions:
To install this openSUSE Security Update use the SUSE recommended installation methods
like YaST online\_update or "zypper patch".
Alternatively you can run the command listed for your product:
- openSUSE Leap 15.0:
zypper in -t patch openSUSE-2019-1494=1
Package List:
- openSUSE Leap 15.0 (i586 x86\_64):
NetworkManager-1.10.6-lp150.4.6.1
NetworkManager-debuginfo-1.10.6-lp150.4.6.1
NetworkManager-debugsource-1.10.6-lp150.4.6.1
NetworkManager-devel-1.10.6-lp150.4.6.1
libnm-glib-vpn1-1.10.6-lp150.4.6.1
libnm-glib-vpn1-debuginfo-1.10.6-lp150.4.6.1
libnm-glib4-1.10.6-lp150.4.6.1
libnm-glib4-debuginfo-1.10.6-lp150.4.6.1
libnm-util2-1.10.6-lp150.4.6.1
libnm-util2-debuginfo-1.10.6-lp150.4.6.1
libnm0-1.10.6-lp150.4.6.1
libnm0-debuginfo-1.10.6-lp150.4.6.1
typelib-1\_0-NM-1\_0-1.10.6-lp150.4.6.1
typelib-1\_0-NMClient-1\_0-1.10.6-lp150.4.6.1
typelib-1\_0-NetworkManager-1\_0-1.10.6-lp150.4.6.1
- openSUSE Leap 15.0 (x86\_64):
NetworkManager-devel-32bit-1.10.6-lp150.4.6.1
libnm-glib-vpn1-32bit-1.10.6-lp150.4.6.1
libnm-glib-vpn1-32bit-debuginfo-1.10.6-lp150.4.6.1
libnm-glib4-32bit-1.10.6-lp150.4.6.1
libnm-glib4-32bit-debuginfo-1.10.6-lp150.4.6.1
libnm-util2-32bit-1.10.6-lp150.4.6.1
libnm-util2-32bit-debuginfo-1.10.6-lp150.4.6.1
- openSUSE Leap 15.0 (noarch):
NetworkManager-branding-upstream-1.10.6-lp150.4.6.1
NetworkManager-lang-1.10.6-lp150.4.6.1
References:
<https://www.suse.com/security/cve/CVE-2018-1000135.html>
<https://bugzilla.suse.com/1086263>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/C5HHHP6HRC27GJXSH33SJTDNWTSVTWFT/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/C5HHHP6HRC27GJXSH33SJTDNWTSVTWFT/#C5HHHP6HRC27GJXSH33SJTDNWTSVTWFT)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from access.redhat.com_a1c92bdd_20250126_064911.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)


