Based on the provided content, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**
- The vulnerability is caused by a lack of input sanitization of the `$_GET['registration']` variable in the `registration-sub-menu.php` file. This allows an attacker to inject malicious code directly into the HTML output.

**Weaknesses/vulnerabilities present:**
- **Reflected Cross-Site Scripting (XSS):** The primary weakness is that user-supplied input (the `registration` GET parameter) is directly included in the HTML output without any sanitization or encoding.

**Impact of exploitation:**
- **Execution of arbitrary JavaScript:** An attacker can inject JavaScript code that will execute in the victim's browser. This can lead to:
    - Unauthorized actions being performed on behalf of the user.
    - Unauthorized access to sensitive data.
    - Stealing of session cookies/information.
    - Denial of service (by injecting code that crashes the page/browser).

**Attack vectors:**
- **Malicious URL:** An attacker crafts a malicious URL containing the XSS payload in the `registration` parameter.
- **Social Engineering:** The attacker needs to trick a user into clicking the crafted malicious link or visiting the page with the injected payload.

**Required attacker capabilities/position:**
- The attacker needs the ability to create and disseminate a malicious link containing the XSS payload.
- The attacker must be able to persuade the victim to click on the malicious link or visit a crafted URL.

**Additional details from the content:**
- The vulnerable code snippet is located in `FlightAirMap/registration-sub-menu.php` on line 18, specifically within the `<a>` tag's `href` attribute.
- A sample XSS payload is provided: `"><img src=x onerror=alert(1)>`
- The vulnerability was reported on July 19, 2018, and resolved on July 20, 2018.