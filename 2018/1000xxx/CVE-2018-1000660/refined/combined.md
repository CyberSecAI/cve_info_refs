=== Content from github.com_edc7d5b1_20250124_200622.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftock%2Ftock%2Fissues%2F1147)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftock%2Ftock%2Fissues%2F1147)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=tock%2Ftock)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[tock](/tock)
/
**[tock](/tock/tock)**
Public

* [Notifications](/login?return_to=%2Ftock%2Ftock) You must be signed in to change notification settings
* [Fork
  714](/login?return_to=%2Ftock%2Ftock)
* [Star
   5.6k](/login?return_to=%2Ftock%2Ftock)

* [Code](/tock/tock)
* [Issues
  108](/tock/tock/issues)
* [Pull requests
  37](/tock/tock/pulls)
* [Discussions](/tock/tock/discussions)
* [Actions](/tock/tock/actions)
* [Projects
  0](/tock/tock/projects)
* [Wiki](/tock/tock/wiki)
* [Security](/tock/tock/security)
* [Insights](/tock/tock/pulse)

Additional navigation options

* [Code](/tock/tock)
* [Issues](/tock/tock/issues)
* [Pull requests](/tock/tock/pulls)
* [Discussions](/tock/tock/discussions)
* [Actions](/tock/tock/actions)
* [Projects](/tock/tock/projects)
* [Wiki](/tock/tock/wiki)
* [Security](/tock/tock/security)
* [Insights](/tock/tock/pulse)

# Package name can potentially access all flash and ram #1147

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Package name can potentially access all flash and ram](#top)#1147Copy linkLabels[bug](https://github.com/tock/tock/issues?q=state%3Aopen%20label%3A%22bug%22)[![@itf](https://avatars.githubusercontent.com/u/6120993?u=6157ab9ce515078114178d61af3c430136a06342&v=4&size=80)](/itf)
## Description

[![@itf](https://avatars.githubusercontent.com/u/6120993?u=6157ab9ce515078114178d61af3c430136a06342&v=4&size=48)](/itf)[itf](https://github.com/itf)opened [on Aug 7, 2018](https://github.com/tock/tock/issues/1147#issue-348436367)

I haven't written code that exploits the bug yet, so it is just a theoretical bug.

## Summary

If you are using a TBF version 1, there is no check on the length of the package name, so it could be as large as all the flash memory available.

Since the package name is public, every capsule could have unrestricted read access to all memory, using only safe code.

## Exploiting the bug

There are two ways of exploiting the bug:

One could create a User process using a TbfHeaderV1 with an arbitrary large package name length, and later on a Capsule could use its package name to read arbitrary memory.

Or, a capsule could call the safe function "get\_package\_name" with a raw pointer that points to a fake TBF version 1 header and use it to read the data anywhere by using the package name offset and length.

## Code:

Inside process.rs lines 267

```
/// Name of the app. Public so that IPC can use it.
pub package_name: &'static str,
```

Now lines 590, and 704 inside the function create:

```
let package_name = tbf_header.get_package_name(app_flash_address);
[...]
process.package_name = package_name;
```

And at last, inside the function  `tbf_header.get_package_name`

```
crate fn get_package_name(&self, flash_start_addr: *const u8) -> &'static str {
        match *self {
            TbfHeader::TbfHeaderV1(hd) => unsafe {
                let package_name_byte_array = slice::from_raw_parts(
                    flash_start_addr.offset(hd.pkg_name_offset as isize),
                    hd.pkg_name_size as usize,
                );
                let mut app_name_str = "";
                let _ = str::from_utf8(package_name_byte_array).map(|name_str| {
                    app_name_str = name_str;
                });
                app_name_str
            },
```

There are no checks for either pkg\_name\_offset nor pkg\_name\_size.

## Proposed solutions

First the `get_package_name` should probably be made unsafe, and then either some package name size check should be placed (either in the get package name function, or in the parse\_and\_validate\_tbf\_header function) or the support for V1 header should be dropped.

## Metadata

### Assignees

No one assigned

### Labels

[bug](https://github.com/tock/tock/issues?q=state%3Aopen%20label%3A%22bug%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


