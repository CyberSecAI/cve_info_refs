=== Content from jenkins.io_afa785c5_20250125_100605.html ===


[Jenkins Security Home](/security/)

**For Administrators**

* [Overview](/security/for-administrators/)
* [Security Advisories](/security/advisories/)
* [Security Issues](/security/issues/)
* [Advisory Schedule](/security/scheduling/)
* [Vulnerabilities in Plugins](/security/plugins/)
* [How We Fix Security Issues](/security/fixing/)

**For Reporters**

* [Reporting Vulnerabilities](/security/reporting/)
* [Jenkins CNA](/security/cna/)

**For Maintainers**

* [Overview](/security/for-maintainers/)
* [Vulnerabilities in Plugins](/security/plugins/)

**Jenkins Security Team**

* [About](/security/team/)
* [Contributions](/security/improvements/)

# Jenkins Security Advisory 2018-03-26

This advisory announces vulnerabilities in the following Jenkins deliverables:

* [Ansible
  Plugin](https://plugins.jenkins.io/ansible)
* Copy To Slave
  Plugin
* [Cucumber Living Documentation
  Plugin](https://plugins.jenkins.io/cucumber-living-documentation)
* [GitHub Pull Request Builder
  Plugin](https://plugins.jenkins.io/ghprb)
* [Liquibase Runner
  Plugin](https://plugins.jenkins.io/liquibase-runner)
* [Mailer
  Plugin](https://plugins.jenkins.io/mailer)
* Perforce
  Plugin
* [Reverse Proxy Auth
  Plugin](https://plugins.jenkins.io/reverse-proxy-auth-plugin)
* [vSphere
  Plugin](https://plugins.jenkins.io/vsphere-cloud)

## Descriptions

### GitHub Pull Request Builder Plugin stores GitHub access tokens in build.xml

**SECURITY-261
/
CVE-2018-1000142**

**Severity (CVSS):**
[medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)

**Affected plugin:
[`ghprb`](https://plugins.jenkins.io/ghprb)**

**Description:**

GitHub Pull Request Builder Plugin stored serialized objects in `build.xml` files that contained the credential used to poll Jenkins.
This can be used by users with Jenkins controller file system access to obtain GitHub credentials.

Since 1.40.0, the plugin no longer stores serialized objects containing the credential on disk.

Builds started before the plugin was updated to 1.40.0 will retain the encoded credentials on disk.
We strongly recommend revoking old GitHub credentials used in Jenkins.
We’re providing [a script for use in the Script Console that will attempt to remove old stored credentials from build.xml files](https://github.com/jenkinsci-cert/SECURITY-261).

### GitHub Pull Request Builder Plugin stores webhook secret in plain text

**SECURITY-262
/
CVE-2018-1000143**

**Severity (CVSS):**
[low](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N)

**Affected plugin:**

**Description:**

GitHub Pull Request Builder Plugin stored the webhook secret shared between Jenkins and GitHub in plain text.

This allowed users with Jenkins controller local file system access and Jenkins administrators to retrieve the stored password.
The latter could result in exposure of the passwords through browser extensions, cross-site scripting vulnerabilities, and similar situations.

GitHub Pull Request Builder Plugin 1.32.1 and newer stores the webhook secret encrypted on disk.

### Cucumber Living Documentation Plugin disabled Content-Security-Policy for archived and workspace files

**SECURITY-308
/
CVE-2018-1000144**

**Severity (CVSS):**
[medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:N)

**Affected plugin:
[`cucumber-living-documentation`](https://plugins.jenkins.io/cucumber-living-documentation)**

**Description:**

Jenkins 1.641 and 1.625.3 introduced `Content-Security-Policy` HTTP headers as protection against Cross-Site Scripting attacks using workspace files and archived artifacts served using `DirectoryBrowserSupport` ([SECURITY-95](/security/advisory/2015-12-09/)).

Cucumber Living Documentation Plugin disabled this XSS protection until Jenkins was restarted whenever a Cucumber Report was viewed by any user to work around the `Content-Security-Policy` limitations.

While disabling this protection mechanism temporarily may be necessary to make plugins work that haven’t been adapted to work with the Content-Security-Policy restriction, this should only be done by administrators, as doing so may result in a security issue (see [Configuring Content Security Policy](/doc/book/security/configuring-content-security-policy)).

This has been addressed in version 1.1.0 of the plugin, and it will now request that users change the Content-Security-Policy option in Jenkins.

### Perforce Plugin uses ineffective credentials encryption

**SECURITY-373
/
CVE-2018-1000145**

**Severity (CVSS):**
[medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**Affected plugin:
[`perforce`](https://plugins.jenkins.io/perforce)**

**Description:**

Perforce Plugin encrypts its credentials using DES and an encryption key stored in its public source code, so it only serves as basic obfuscation.
This allowed users with Jenkins controller local file system access and Jenkins administrators to retrieve the stored password.
The latter could result in exposure of the passwords through browser extensions, cross-site scripting vulnerabilities, and similar situations.

As of publication of this advisory, there is no fix.
The plugin has been removed from publication at the request of its former maintainers.
We recommend that users of Perforce Plugin use the [P4 Plugin](https://plugins.jenkins.io/p4) instead.

### vSphere Plugin does not validate SSL/TLS certificates

**SECURITY-504
/
CVE-2018-1000151**

**Severity (CVSS):**
[medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L)

**Affected plugin:
[`vsphere-cloud`](https://plugins.jenkins.io/vsphere-cloud)**

**Description:**

vSphere Plugin disabled SSL/TLS certificate validation unconditionally, allowing potential man-in-the-middle attacks.

vSphere Plugin 2.17 now has SSL/TLS certificate validation enabled by default.

### CSRF vulnerability and missing permission checks in vSphere Plugin form validation allowed enumerating credentials IDs, capturing credentials, and denial of service

**SECURITY-745
/
CVE-2018-1000152 and CVE-2018-1000153**

**Severity (CVSS):**
[medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L)

**Affected plugin:
[`vsphere-cloud`](https://plugins.jenkins.io/vsphere-cloud)**

**Description:**

vSphere Plugin did not perform permission checks on methods implementing form validation.
This allowed users with Overall/Read access to Jenkins to perform various actions such as:

* Connect to an attacker-specified vSphere server using attacker-specified credentials IDs obtained through another method, capturing credentials stored in Jenkins
* Connect to configured vSphere servers and looking up information, potentially resulting in denial of service

Additionally, these form validation methods did not require POST requests, resulting in a CSRF vulnerability.

These form validation methods now require POST requests and appropriate user permissions.

### Liquibase Runner Plugin allows users to load arbitrary Java code into controller JVM

**SECURITY-519
/
CVE-2018-1000146**

**Severity (CVSS):**
[high](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**Affected plugin:
[`liquibase-runner`](https://plugins.jenkins.io/liquibase-runner)**

**Description:**

Liquibase Runner Plugin allows users with Job/Configure permission to configure its build step in a way that loads arbitrary class files into the Jenkins controller JVM, resulting in arbitrary code execution.

As of publication of this advisory, there is no fix.

### Perforce Plugin credentials can be obtained by users with Job/Extended Read permission

**SECURITY-536
/
CVE-2018-1000147**

**Severity (CVSS):**
[medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**Affected plugin:
[`perforce`](https://plugins.jenkins.io/perforce)**

**Description:**

Jenkins prevents users with Extended Read permission from obtaining secrets such as credentials stored in job configurations.

Perforce Plugin implements its own credential encryption using DES and an encryption key stored in its public source code.
This is not considered a secret by Jenkins, resulting in potential exposure of Perforce credentials stored in job configurations to users with Extended Read permission.
While these are encrypted, this can only be considered basic obfuscation due to the hard-coded public encryption key used.

As of publication of this advisory, there is no fix.
The plugin has been removed from publication at the request of its maintainers.
We recommend that users of Perforce Plugin use the [P4 Plugin](https://plugins.jenkins.io/p4) instead.

### Copy To Slave Plugin allows access to arbitrary files on the Jenkins controller file system

**SECURITY-545
/
CVE-2018-1000148**

**Severity (CVSS):**
[medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N)

**Affected plugin:
[`copy-to-slave`](https://plugins.jenkins.io/copy-to-slave)**

**Description:**

Copy To Slave Plugin allows users with Job/Configure permissions to configure it in such a way that it allows obtaining arbitrary files accessible to the Jenkins controller process from the Jenkins controller file system.

As of publication of this advisory, there is no fix.

### Ansible Plugin disabled host key verification by default

**SECURITY-630
/
CVE-2018-1000149**

**Severity (CVSS):**
[medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L)

**Affected plugin:
[`ansible`](https://plugins.jenkins.io/ansible)**

**Description:**

Ansible Plugin disabled host key verification by default, having it only as an opt-in option.

Ansible Plugin 1.0 now enables host key verification by default, adding options allowing users to opt out.

Existing configurations that previously did not opt into host key verification will have host key verification enabled after update, possibly resulting in failures.

### Reverse Proxy Auth persisted authorities cache on disk

**SECURITY-736
/
CVE-2018-1000150**

**Severity (CVSS):**
[low](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**Affected plugin:
[`reverse-proxy-auth-plugin`](https://plugins.jenkins.io/reverse-proxy-auth-plugin)**

**Description:**

Reverse Proxy Auth Plugin persisted a cache of granted authorities (group memberships) on disk.

This could allow users with local Jenkins controller file system access to obtain group membership information of Jenkins users.

Reverse Proxy Auth Plugin 1.6.0 and newer no longer store the cache of granted authorities on disk.

### Mailer Plugin allowed unauthorized users to send test emails

**SECURITY-774
/
CVE-2018-8718**

**Severity (CVSS):**
[medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L)

**Affected plugin:
[`mailer`](https://plugins.jenkins.io/mailer)**

**Description:**

A missing permission check in Mailer Plugin allowed users with Overall/Read access to Jenkins to have it connect to a user-specified mail server with user-specified credentials to send a test email to a user-specified email address.
The email subject and body could not be changed.
This could result in DoS if, for example, specifying a valid mail server but invalid credentials.

As the same URL did not require POST to be used, it also was vulnerable to cross-site request forgery.

The URL handling test emails now requires POST to protect from CSRF, and performs an Overall/Administer permission check.

## Severity

* SECURITY-261:
  [medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)
* SECURITY-262:
  [low](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N)
* SECURITY-308:
  [medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:N)
* SECURITY-373:
  [medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)
* SECURITY-504:
  [medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L)
* SECURITY-519:
  [high](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)
* SECURITY-536:
  [medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)
* SECURITY-545:
  [medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N)
* SECURITY-630:
  [medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L)
* SECURITY-736:
  [low](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)
* SECURITY-745:
  [medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L)
* SECURITY-774:
  [medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L)

## Affected Versions

* **Ansible
  Plugin**
  up to and including
  0.8
* **Copy To Slave
  Plugin**
  up to and including
  1.4.4
* **Cucumber Living Documentation
  Plugin**
  up to and including
  1.0.12
* **GitHub Pull Request Builder
  Plugin**
  up to and including
  1.39.0
* **Liquibase Runner
  Plugin**
  up to and including
  1.3.0
* **Mailer
  Plugin**
  up to and including
  1.20
* **Perforce
  Plugin**
  up to and including
  1.3.36
* **Reverse Proxy Auth
  Plugin**
  up to and including
  1.5
* **vSphere
  Plugin**
  up to and including
  2.16

## Fix

* **Ansible
  Plugin**
  should be updated to version
  1.0
* **Cucumber Living Documentation
  Plugin**
  should be updated to version
  1.1.0
* **GitHub Pull Request Builder
  Plugin**
  should be updated to version
  1.40.0
* **Mailer
  Plugin**
  should be updated to version
  1.21
* **Reverse Proxy Auth
  Plugin**
  should be updated to version
  1.6.0
* **vSphere
  Plugin**
  should be updated to version
  2.17

These versions include fixes to the vulnerabilities described above. All prior versions are considered to be affected by these vulnerabilities unless otherwise indicated.

As of publication of this advisory, no fixes are available for the following plugins:

* Copy To Slave
  Plugin
* Liquibase Runner
  Plugin
* Perforce
  Plugin

[Learn why we announce these issues.](/security/plugins/#unresolved)

## Credit

The Jenkins project would like to thank the reporters for discovering and
[reporting](/security/#reporting-vulnerabilities)
these vulnerabilities:

* **Daniel Beck, CloudBees, Inc.**
  for
  SECURITY-308, SECURITY-630, SECURITY-745
* **Hyoungwook Jang, SKinfosec, Inc.**
  for
  SECURITY-774
* **Jesse Glick, CloudBees, Inc.**
  for
  SECURITY-545
* **Oleg Nenashev, CloudBees, Inc.**
  for
  SECURITY-536, SECURITY-736
* **Peter Adkins**
  for
  SECURITY-504
* **Steve Marlowe <smarlowe@cisco.com> of Cisco ASIG**
  for
  SECURITY-261, SECURITY-262, SECURITY-373
* **Yoann Dubreuil, CloudBees, Inc.**
  for
  SECURITY-519



=== Content from plugins.jenkins.io_9b717755_20250126_075623.html ===

# Ansible

How to install**This plugin is up for adoption!** We are looking for new maintainers. Visit our [Adopt a Plugin](https://jenkins.io/doc/developer/plugin-governance/adopt-a-plugin/) initiative for more information.

* [Documentation](/ansible/)
* [Releases](/ansible/releases/)
* [Issues](/ansible/issues/)
* [Dependencies](/ansible/dependencies/)
* [Health Score](/ansible/healthscore/)

[![Build](https://camo.githubusercontent.com/9078b900a62f8208666b238574f9c2160c6f2cf0209ec845353243ac0ef6cf5b/68747470733a2f2f63692e6a656e6b696e732e696f2f6a6f622f506c7567696e732f6a6f622f616e7369626c652d706c7567696e2f6a6f622f6d61696e2f62616467652f69636f6e)](https://camo.githubusercontent.com/9078b900a62f8208666b238574f9c2160c6f2cf0209ec845353243ac0ef6cf5b/68747470733a2f2f63692e6a656e6b696e732e696f2f6a6f622f506c7567696e732f6a6f622f616e7369626c652d706c7567696e2f6a6f622f6d61696e2f62616467652f69636f6e) [![Coverage](https://camo.githubusercontent.com/7ad8aa9d7a006ece99e9bee0c07a40178b7f0435f968ef9a1db521195ed9bf22/68747470733a2f2f63692e6a656e6b696e732e696f2f6a6f622f506c7567696e732f6a6f622f616e7369626c652d706c7567696e2f6a6f622f6d61696e2f62616467652f69636f6e3f7374617475733d24253742696e737472756374696f6e436f766572616765253744267375626a6563743d636f76657261676526636f6c6f723d24253742636f6c6f72496e737472756374696f6e436f766572616765253744)](https://ci.jenkins.io/job/Plugins/job/ansible-plugin/job/main) [![LOC](https://camo.githubusercontent.com/3309da624c1bbcdf61d9e92e2556b913db9aba0cd06200647d2b6bafefcd765d/68747470733a2f2f63692e6a656e6b696e732e696f2f6a6f622f506c7567696e732f6a6f622f616e7369626c652d706c7567696e2f6a6f622f6d61696e2f62616467652f69636f6e3f6a6f623d74657374267374617475733d242537426c696e654f66436f6465253744267375626a6563743d6c696e652532306f66253230636f646526636f6c6f723d626c7565)](https://ci.jenkins.io/job/Plugins/job/ansible-plugin/job/main) [![Contributors](https://camo.githubusercontent.com/a5d155da515cd1f1219f4f0ab3d0be1724664c2e7134c5bda43c915f89c89028/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f636f6e7472696275746f72732f6a656e6b696e7363692f616e7369626c652d706c7567696e2e7376673f636f6c6f723d626c7565)](https://camo.githubusercontent.com/a5d155da515cd1f1219f4f0ab3d0be1724664c2e7134c5bda43c915f89c89028/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f636f6e7472696275746f72732f6a656e6b696e7363692f616e7369626c652d706c7567696e2e7376673f636f6c6f723d626c7565) [![GitHub release](https://camo.githubusercontent.com/c4da2a3522cb659704c7aa2de6fc056c73bb10c44028051737642d4ebc8670a6/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f72656c656173652f6a656e6b696e7363692f616e7369626c652d706c7567696e2e7376673f6c6162656c3d6368616e67656c6f67)](https://github.com/jenkinsci/ansible-plugin/releases/latest) [![Jenkins Plugin Installs](https://camo.githubusercontent.com/a58ff6f9bbc084c7439b3b9e715b841d301e7a7d61715c46e266e2124ccb1fb2/68747470733a2f2f696d672e736869656c64732e696f2f6a656e6b696e732f706c7567696e2f692f616e7369626c652e7376673f636f6c6f723d626c7565)](https://plugins.jenkins.io/ansible) [![GitHub license](https://camo.githubusercontent.com/ce6b66d5333d9d526cd89f535b35b1dc7664cca8d6fb4a3f90c2cd72cb1cd980/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f6a656e6b696e7363692f616e7369626c652d706c7567696e)](https://github.com/jenkinsci/ansible-plugin/blob/main/LICENSE.md)

This plugin allows to execute [Ansible](http://www.ansible.com/) tasks as a job build step.

## Global Configuration

Ansible needs to be on the PATH for the build job in order to be used. This can be done through either Jenkins Global Tool Configuration or including Ansible on the OS User PATH variable.

### Global Tool Configuration

Configuring Ansible through the Global Tool Configuration in Jenkins (Jenkins → Manage Jenkins → Global Tool Configuration) allows for multiple Ansible installations to be present and used by different Jenkins jobs.

1. Click "Add Ansible"
2. Configure the name and path

   | Field name | Description |
   | --- | --- |
   | Name | Symbolic name used to identify a specific Ansible installation when multiple installations are configured |
   | Path to ansible executables directory | Directory containing the *ansible,* *ansible-playbook*, and *ansible-vault* binaries |
3. Repeat for any additional desired installations

There is no automatic ansible installation possible using Global Tools.

### OS User PATH

Ansible can also be added to the PATH user used by the Jenkins executor instead of configured through Global Tool Configuration. This is done through normal OS tools outside of Jenkins and is not covered by this guide.

---

## Supported versions

The plugin is tested against supported ansible-core versions (<https://endoflife.date/ansible-core>). It might work with older versions, but this is not guaranteed.

See `PipelineTest.java`

```
private static Stream<String> ansibleVersions() {
    return Stream.of("2.16.14", "2.17.7", "2.18.1");
}
```

## Adhoc

[Adhoc commands](http://docs.ansible.com/ansible/latest/intro_adhoc.html) allow for simple operations to be done without writing a full playbook. This allows for a convenient way of doing quick tasks with Ansible.

### Examples

#### Scripted

**Jenkinsfile**

```
ansibleAdhoc credentialsId: 'private_key', inventory: 'inventories/a/hosts', hosts: 'hosts_pattern', moduleArguments: 'module_arguments'
```

#### Declarative

**Jenkinsfile**

```
ansibleAdhoc(credentialsId: 'private_key', inventory: 'inventories/a/hosts', hosts: 'hosts_pattern', moduleArguments: 'module_arguments')
```

### Arguments

See also [jenkins.io](https://jenkins.io/doc/pipeline/steps/ansible/) documentation.

| Freestyle Name | Pipeline Name | Description |
| --- | --- | --- |
| Ansible installation | installation | Ansible installation to use for the playbook invocation |
| Host pattern | hosts | The host pattern to manage. See Ansible Patterns for details. |
| Module | module | CLI arg: `-m` |
| Module arguments or command to execute | moduleArguments | CLI arg: `-a` |
| Inventory file or host list | inventory | CLI arg: `-i`: See the Inventory section for additional details. |
| Inventory inline content | inventoryContent | CLI arg: `-i`: See the Inventory section for additional details. |
| Credentials | credentialsId | The Jenkins credential to use for the SSH connection. See the Authentication section for additional details. |
| Vault Credentials | vaultCredentialsId | CLI arg: `--vault-password-file`: The Jenkins credential to use as the vault credential. See the Vault Credentials section for additional details. |
| Vault temp path | vaultTmpPath | Path where to store temporary vault secrets files, ssh key files, etc... Default is in workspace. |
| sudo | become | CLI arg: `-s` |
| sudo user | becomeUser | CLI arg: `-U` |
| Number of parallel processes | forks | CLI arg: `-f` |
| Check host SSH key | hostKeyChecking | Toggle checking of the host key. Sets the environment variable `ANSIBLE_HOST_KEY_CHECKING`, similar to the recommendations for running with Vagrant. |
| Unbuffered stdout |  | Toggle buffering of standard out. Sets the environment variable `PYTHONUNBUFFERED`, similar to the recommendations for running with Vagrant. |
| Colorized stdout | colorized | Toggle color codes in console text. See Colorized Output section for example usage. Sets the environment variable `ANSIBLE_FORCE_COLOR`, similar to the recommendations for running with Vagrant. |
| Extra Variables | extraVars | CLI arg: `-e` |
| Additional parameters | extras | String passed to the Ansible Command Line invocation as-is. |

## Playbook

[Ansible playbook](http://docs.ansible.com/ansible/latest/playbooks.html) operations can be run with the plugin. The plugin provides several conveniences such as easily using credentials from the Jenkins credential store, unbuffered color output in the log, etc.

### Examples

#### Scripted

**Jenkinsfile**

```
ansiblePlaybook credentialsId: 'private_key', inventory: 'inventories/a/hosts', playbook: 'my_playbook.yml'
```

#### Declarative

**Jenkinsfile**

```
ansiblePlaybook(credentialsId: 'private_key', inventory: 'inventories/a/hosts', playbook: 'my_playbook.yml')
```

Additional scripted and declarative pipeline examples can be found on the plugin's [GitHub readme](https://github.com/jenkinsci/ansible-plugin).

### Arguments

Refer to [jenkins.io](https://jenkins.io/doc/pipeline/steps/ansible/) for documentation extracted from the online help of the plugin.

| Freestyle Name | Pipeline Name | Description |
| --- | --- | --- |
| Ansible installation | installation | Ansible installation to use for the playbook invocation |
| Playbook path | playbook | Mandatory. The name of the playbook to run |
| Inventory file or host list | inventory | CLI arg: `-i`: See the inventory section for details. |
| Inventory inline content | inventoryContent | CLI arg: `-i`: See the inventory section for details. |
| Credentials | credentialsId | The Jenkins credential to use for the SSH connection. See the Authentication section for additional details |
| Vault Credentials | vaultCredentialsId | The Jenkins credential to use as the vault credential. See the Vault Credentials section for more details |
| Vault temp path | vaultTmpPath | Path where to store temporary vault secrets files, ssh key files, etc... rkspace. |
| sudo | sudo | CLI arg: `-s` |
| sudo user | sudoUser | CLI arg: `-U` |
| Host subset | limit | CLI arg: `-l` |
| Tags to run | tags | CLI arg: `-t` |
| Tags to skip | skippedTags | CLI arg: `--skip-tags` |
| Task to start at | startAtTask | CLI arg: `--start-at-task` |
| Number of parallel processes | forks | CLI arg: `-f` |
| Check host SSH key | hostKeyChecking | Toggle checking of the host key. Sets the environment variable ANSIBLE\_HOST\_KEY\_CHECKING, similar to the recommendations for running with Vagrant. |
| Colorized stdout | colorized | Toggle color codes in console text. See Colorized Output section for example usage. Sets the environment variable ANSIBLE\_FORCE\_COLOR, similar to the recommendations for running with Vagrant. |
| Additional parameters | extras | String passed to the Ansible Command Line invocation as-is |
| Extra Variables | extraVars | CLI arg: `-e` |

Refer to the ansible-playbook manual page for details on how each command line argument is interpreted.

### Authentication

#### SSH Keys

[SSH keys](https://help.ubuntu.com/community/SSH/OpenSSH/Keys) are the recommended authentication method for SSH connections. The plugin supports the credential type "SSH Username with private key" configured in the Jenkins credential store through the [SSH crendentials plugin](https://plugins.jenkins.io/ssh-credentials).

#### Password

Even if using SSH keys is recommended authentication method, password authentication may sometimes be required. The plugin has supported password based authentication since 0.3.0. When using password based authentication, the [sshpass](http://sourceforge.net/projects/sshpass/) binary is expected to be on the PATH. The plugin supports the credential type "Username with password" configured in the Jenkins credential store through the [SSH crendentials plugin](https://plugins.jenkins.io/ssh-credentials).

### Vault Credentials

Vault credentials can be setup in the Jenkins credential store as either a "Secret text" or a "Secret file".

### Colorized Output

The [AnsiColor plugin](https://plugins.jenkins.io/ansicolor) is needed for colorized console output. Once installed, colorized output can be enabled with the argument "colorized: true".

**Jenkinsfile**

```
ansiColor('xterm') {
    ansiblePlaybook(
        playbook: 'path/to/playbook.yml',
        inventory: 'path/to/inventory.ini',
        credentialsId: 'sample-ssh-key',
        colorized: true)
}
```

[![](https://cdn.jsdelivr.net/gh/jenkinsci/ansible-plugin@main/docs/images/jenkins-deploy-ansible-console.png)](https://github.com/jenkinsci/ansible-plugin/blob/main/docs/images/jenkins-deploy-ansible-console.png)

### Extra Parameters

Extra parameters is a string passed to the Ansible Command Line invocation as-is and can be useful for arguments occasionally added to an invocation at runtime, such as tags and host limits.

### Inventory

#### File

A string path to the inventory file to use with the playbook invocation.

#### Inline

The provided content is used as the content of the inventory file for the playbook invocation.

### Using Jenkins Environment Variables

Jenkins environment variables can be accessed from within an Ansible playbook. The Jenkins variables are injected as environment variables making them available through the Ansible [lookup plugin](http://docs.ansible.com/ansible/latest/playbooks_lookups.html).

The following Ansible playbook accesses the Jenkins BUILD\_TAG variable:

**playbook.yml**

```
---
- hosts: example
  tasks:
    - debug: msg="{{ lookup('env','BUILD_TAG') }}"
```

---

## Vault

Most [Ansible Vault](https://docs.ansible.com/ansible/latest/vault.html) operations can be performed with the plugin. Interactive operations such as create, edit, and view are not supported through the plugin. One use case for this enabling developers to encrypt secret values while keeping the vault password a secret.

### Examples

#### Scripted

**Encrypts a File**

```
ansibleVault action: 'encrypt', input: 'vars/secrets.yml', vaultCredentialsId: 'ansible_vault_credentials'
```

**Encrypts a String**

```
ansibleVault action: 'encrypt_string', content: 'secret_content', vaultCredentialsId: 'ansible_vault_credentials'
```

#### Declarative

**Jenkinsfile**

```
ansibleVault(action: 'encrypt', input: 'vars/secrets.yml', vaultCredentialsId: 'ansible_vault_credentials')
```

**Jenkinsfile**

```
ansibleVault(action: 'encrypt_string', content: 'secret_content', vaultCredentialsId: 'ansible_vault_password')
```

### Arguments

See also [jenkins.io Pipeline step](https://jenkins.io/doc/pipeline/steps/ansible/) documentation.

| Freestyle Name | Pipeline Name | Description |
| --- | --- | --- |
| Ansible installation | installation | Ansible installation to use for the playbook invocation |
| Action | action | Mandatory. The name of the action to use. Interactive operations such as create, edit, and view are not supported. |
| Vault Credentials | vaultCredentialsId | CLI arg: `--vault-password-file`. The Jenkins credential to use as the vault credential. See the Vault Credentials section for more details |
| New Vault Credentials | newVaultCredentialsId | CLI arg: `--new-vault-password-file`. The Jenkins credential to use as the vault credential. See the Vault Credentials section for more details |
| Vault temp path | vaultTmpPath | Path where to store temporary vault secrets files, ssh key files, etc... Default is in workspace. |
| Content | content | The content to encrypt with the 'encrypt\_string' action. |
| Input | input | The file to encrypt with the encrypt actions. |
| Output | output | CLI arg: `--output` |

### Vault Credentials

Vault credentials can be setup in the Jenkins credential store as either a "Secret text" or a "Secret file".

---

## Changelog

Changelog is now published on GitHub release.

## Using Jenkins Build and Environment Variables

It is possible to access build and environment variables in ansible playbooks. These variables are injected as environment variables within the ansible process. For example, use this code in an ansible playbook to access Jenkins `BUILD_TAG` variable.

```
---
- hosts: example
  tasks:
    - debug: msg="{{ lookup('env','BUILD_TAG') }}"
```

## Job DSL support

```
steps {
    ansiblePlaybook(String playbook) {
        inventoryPath(String path)
        inventoryContent(String content, boolean dynamic = false)
        ansibleName(String name)
        limit(String limit)
        tags(String tags)
        skippedTags(String tags)
        startAtTask(String task)
        credentialsId(String id)
        checkMode(boolean checkMode = false)
        become(boolean become = true)
        becomeUser(String user = 'root')
        sudo(boolean sudo = true)
        sudoUser(String user = 'root')
        forks(int forks = 5)
        unbufferedOutput(boolean unbufferedOutput = true)
        colorizedOutput(boolean colorizedOutput = false)
        hostKeyChecking(boolean hostKeyChecking = false)
        additionalParameters(String params)
        extraVars {
            extraVar(String key, String value, boolean hidden)
        }
    }

    ansibleAdHoc(String module, String command) {
        ansibleName(String name)
        inventoryPath(String path)
        inventoryContent(String content, boolean dynamic = false)
        credentialsId(String id)
        hostPattern(String pattern)
        become(boolean become = true)
        becomeUser(String user = 'root')
        sudo(boolean sudo = true)
        sudoUser(String user = 'root')
        forks(int forks = 5)
        unbufferedOutput(boolean unbufferedOutput = true)
        colorizedOutput(boolean colorizedOutput = false)
        hostKeyChecking(boolean hostKeyChecking = false)
        additionalParameters(String params)
        extraVars {
            extraVar(String key, String value, boolean hidden)
        }
    }
}
```

### Example

```
steps {
    ansiblePlaybook('path/playbook.yml') {
        inventoryPath('hosts.ini')
        ansibleName('1.9.4')
        tags('one,two')
        credentialsId('credsid')
        become(true)
        becomeUser("user")
        checkMode(false)
        extraVars {
            extraVar("key1", "value1", false)
            extraVar("key2", "value2", true)
        }
    }
}
```

```
steps {
    ansiblePlaybookBuilder {
        playbook('path/playbook.yml')
        inventory {
            inventoryDoNotSpecify()
        }
        unbufferedOutput(true)
        extraVars {
            extraVar {
                key('key1')
                secretValue(hudson.util.Secret.fromString('value1'))
                hidden(false)
            }
            extraVar {
                key('key2')
                secretValue(hudson.util.Secret.fromString('value2'))
                hidden(true)
            }
        }
    }
}
```

## Pipeline support

Ansible playbooks can be executed from workflow scripts. Only the `playbook` parameter is mandatory.

### Example

```
node {
    ansiblePlaybook(
        playbook: 'path/to/playbook.yml',
        inventory: 'path/to/inventory.ini',
        credentialsId: 'sample-ssh-key',
        extras: '-e parameter="some value"')
}
```

### Extra Variables

Extra variables can be passed to ansible by using a map in the pipeline script. Supported value types are: `String`, `Boolean`, `Number`. By default the value will be considered potentially sensitive and masked in the logs. To override this give a map with keys `value` and `hidden`.

```
node {
    ansiblePlaybook(
        inventory: 'local_inventory/hosts.cfg',
        playbook: 'cloud_playbooks/create-aws.yml',
        extraVars: [
            login: 'mylogin',
            toggle: true,
            forks: 8,
            not_secret: [value: 'I want to see this in the logs', hidden: false]
        ])
}
```

### Colorized Console Log

You need to install the [AnsiColor plugin](https://plugins.jenkins.io/ansicolor/) to output a colorized Ansible log.

```
node {
    wrap([$class: 'AnsiColorBuildWrapper', colorMapName: "xterm"]) {
        ansiblePlaybook(
            playbook: 'path/to/playbook.yml',
            inventory: 'path/to/inventory.ini',
            credentialsId: 'sample-ssh-key',
            colorized: true)
    }
}
```

## Contributing

Refer to our [contribution guidelines](https://github.com/jenkinsci/.github/blob/master/CONTRIBUTING.md)

## LICENSE

Licensed under MIT, see [LICENSE](https://github.com/jenkinsci/ansible-plugin/blob/main/LICENSE.md)

##### Version: 500.v7564a\_db\_8feec

Released: 3 days agoRequires Jenkins 2.479.1ID: ansible
##### Installed on 7.07% of controllers

[View detailed version information](https://old.stats.jenkins.io/pluginversions/ansible.html)
##### Links

[GitHub](https://github.com/jenkinsci/ansible-plugin)[Open issues (Github)](https://github.com/jenkinsci/ansible-plugin/issues)[Report an issue (Github)](https://github.com/jenkinsci/ansible-plugin/issues/new/choose)[Pipeline Step Reference](https://www.jenkins.io/doc/pipeline/steps/ansible)[Javadoc](https://javadoc.jenkins.io/plugin/ansible)
##### Labels

[adopt-this-plugin](/ui/search/?labels=adopt-this-plugin)[Build Tools](/ui/search/?labels=builder)[Deployment](/ui/search/?labels=deployment)[DevOps](/ui/search/?labels=devops)[External Site/Tool Integrations](/ui/search/?labels=external)[pipeline](/ui/search/?labels=pipeline)
##### Maintainers

[Jean-Christophe Sirot](/ui/search/?query=sirot)[Emilio Escobar](/ui/search/?query=escoem)
##### Help us improve this page!

To propose a change submit a pull request to [the plugin page](https://github.com/jenkinsci/ansible-plugin) on GitHub.
##### Previous Security Warnings

* ###### [Host key verification disabled by default](https://jenkins.io/security/advisory/2018-03-26/#SECURITY-630)

  + Affects version 0.8 and earlier
* ###### [Missing permission checks allow enumerating credentials IDs](https://www.jenkins.io/security/advisory/2020-11-04/#SECURITY-1943)

  + Affects version 1.0 and earlier
* ###### [Secrets stored and displayed in plain text](https://www.jenkins.io/security/advisory/2023-05-16/#SECURITY-3017)

  + Affects version 204.v8191fd551eb\_f and earlier
![tracker](https://jenkins-matomo.do.g4v.dev/piwik.php?idsite=1&rec=1&url=https://plugins.jenkins.io//ansible/)


