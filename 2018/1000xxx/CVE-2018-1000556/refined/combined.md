=== Content from www.pluginvulnerabilities.com_a2a949e5_20250124_115635.html ===

[Login](https://www.pluginvulnerabilities.com/my-account/ "Login / Register")
[# Plugin Vulnerabilities

## A service to protect your site against vulnerabilities in WordPress plugins.](https://www.pluginvulnerabilities.com/ "A service to protect your site against vulnerabilities in WordPress plugins.")

* [Sign Up](https://www.pluginvulnerabilities.com/product/subscription/)
  + [Set Up](https://www.pluginvulnerabilities.com/set-up/)
* [Why Plugin Vulnerabilities?](https://www.pluginvulnerabilities.com/why-plugin-vulnerabilities/)
  + [We Provide Fixes for Vulnerabilities](https://www.pluginvulnerabilities.com/we-provide-fixes-for-wordpress-plugin-vulnerabilities/)
  + [We Provide Accurate Vulnerability Information](https://www.pluginvulnerabilities.com/we-provide-accurate-information-on-the-affected-versions-of-vulnerable-wordpress-plugins/)
  + [Insightful Blocked Exploit Attempt Reporting](https://www.pluginvulnerabilities.com/insightful-blocked-exploit-attempt-reporting-from-a-wordpress-firewall-plugin/)
  + [How We Are Improving the Security of WordPress Plugins](https://www.pluginvulnerabilities.com/how-we-are-improving-the-security-of-wordpress-plugins/)
  + [Proactive Monitoring for Vulnerabilities in New Versions of WordPress Plugins](https://www.pluginvulnerabilities.com/proactive-monitoring-for-vulnerabilities-in-new-versions-of-wordpress-plugins/)
  + [Select Plugins to Receive Security Reviews](https://www.pluginvulnerabilities.com/wordpress-plugin-security-reviews/)
* Our Plugins
  + [Plugin Vulnerabilities Firewall](https://www.pluginvulnerabilities.com/plugin-vulnerabilities-firewall/)
  + [Lockdown Mode Plugin for WordPress](https://www.pluginvulnerabilities.com/lockdown-mode-plugin/)
  + [2FA for WooCommerce](https://www.pluginvulnerabilities.com/two-factor-authentication-2fa-for-woocommerce-plugin/)
* Other Services
  + [Plugin Security Review](https://www.pluginvulnerabilities.com/wordpress-plugin-security-review-service/)
  + [Continuous Plugin Security Review Service](https://www.pluginvulnerabilities.com/continuous-wordpress-plugin-security-review-service/)
  + [Theme Security Review](https://www.pluginvulnerabilities.com/wordpress-theme-security-review-service/)
  + [Hacked WordPress Website Cleanup](https://www.whitefirdesign.com/services/hacked-wordpress-website-cleanup.html)
  + [Abandoned WordPress Plugin Maintenance Service](https://www.whitefirdesign.com/services/abandoned-wordpress-plugin-maintenance.html)
  + [Blue Hat Hacking Service for WordPress Plugins/Websites](https://www.pluginvulnerabilities.com/blue-hat-hacking-service-for-wordpress-plugins-websites/)
  + [Plugin Vulnerabilities Subscription for ClassicPress](https://www.pluginvulnerabilities.com/product/plugin-vulnerabilities-subscription-for-classicpress/)
  + [Plugin Vulnerabilities Daily Newsletter](https://www.pluginvulnerabilities.com/product/plugin-vulnerabilities-daily-newsletter/)
  + [Solutions for Web Hosts](https://www.pluginvulnerabilities.com/solutions-for-web-hosts/)
  + [Solutions for Security Providers](https://www.pluginvulnerabilities.com/solutions-for-security-providers/)
* [Plugin Search](https://www.pluginvulnerabilities.com/plugin-search/)
  + [Search WooCommerce Plugins](https://www.pluginvulnerabilities.com/plugin-search/?woocommerce=)
  + [Search Elementor Plugins](https://www.pluginvulnerabilities.com/plugin-search/?elementor=)
* [Research](https://www.pluginvulnerabilities.com/blog/)
  + [Unfixed Security Issues in WordPress](https://www.pluginvulnerabilities.com/unfixed-security-issues-in-wordpress/)
  + [Latest WordPress News](https://www.pluginvulnerabilities.com/latest-wordpress-news/)
  + [Latest ClassicPress News](https://www.pluginvulnerabilities.com/latest-classicpress-news/)
  + [What WordPress Plugins Are No Longer Receiving Updates Through the WordPress Plugin Directory?](https://www.pluginvulnerabilities.com/2024/10/22/what-wordpress-plugins-are-no-longer-receiving-updates-through-the-wordpress-plugin-directory/)
  + [WordPress Firewall Plugin Protection Comparison](https://www.pluginvulnerabilities.com/wordpress-firewall-plugin-protection-comparison/)
  + [Security Advisories on WordPress Plugin Developers](https://www.pluginvulnerabilities.com/security-advisories-on-wordpress-plugin-developers/)
  + [Send us a Tip](https://www.pluginvulnerabilities.com/news-tip/)
* [About](https://www.pluginvulnerabilities.com/about/)
  + [WordPress Plugin Zero-Day Vulnerability Exploitation Info Sharing Partnership](https://www.pluginvulnerabilities.com/wordpress-plugin-zero-day-vulnerability-exploitation-info-sharing-partnership/)
  + [Get Free Help Fixing A Security Vulnerability In Your WordPress Plugin](https://www.pluginvulnerabilities.com/get-free-help-fixing-a-security-vulnerability-in-your-wordpress-plugin/)
  + [Contact Us](https://www.pluginvulnerabilities.com/contact/)
  + [Feedback](https://www.pluginvulnerabilities.com/feedback/)
  + [Report a WordPress Plugin Vulnerability We Are Missing](https://www.pluginvulnerabilities.com/report-a-vulnerability/)

28
Apr
2017

# Reflected Cross-Site Scripting (XSS) Vulnerability in WP Statistics

A couple of days ago we started to look into a series of releases (12.0.2-12.0.5) of the plugin [WP Statistics](https://wordpress.org/plugins/wp-statistics/) that were indicated to have fixed cross-site scripting (XSS) vulnerabilities. While there were a couple of advisories put out related to this, those didn’t include the details needed to confirm that vulnerabilities had existed and had been fixed. When we started testing things out to figure out exactly what was going on, we accidentally ran across yet another XSS vulnerability, this time a reflected XSS vulnerability.

While that is a minor vulnerability, it probably isn’t the best sign of the security of that plugin that we could stumble on to yet another vulnerability. Considering that this is a plugin with 300,000+ active installs according to wordpress.org, it also isn’t a good sign as to the security of WordPress plugins in general.

The issue started in the file /includes/log/page-statistics.php where the value of the GET input “page-uri” is set to the variable $pageuri without being sanitized:

| ``` 7  ``` | ``` if( array_key_exists( 'page-uri', $_GET ) ) { $pageuri = $_GET['page-uri']; } else { $pageuri = null; } ``` |
| --- | --- |

if( array\_key\_exists( 'page-uri', $\_GET ) ) { $pageuri = $\_GET['page-uri']; } else { $pageuri = null; }

That variable is then added to the variable $urlfields:

| ``` 20  ``` | ``` if( $pageuri ) { $urlfields .= "&page-uri={$pageuri}"; } ``` |
| --- | --- |

if( $pageuri ) { $urlfields .= "&page-uri={$pageuri}"; }

And the second variable is passed to the function wp\_statistics\_date\_range\_selector():

| ``` 29  ``` | ``` wp_statistics_date_range_selector( WP_STATISTICS_PAGES_PAGE, $daysToDisplay, null, null, $urlfields ); ``` |
| --- | --- |

wp\_statistics\_date\_range\_selector( WP\_STATISTICS\_PAGES\_PAGE, $daysToDisplay, null, null, $urlfields );

From there in the file /includes/functions/functions.php the value was output unescaped on line 972:

```
echo 'href="?page=' . $page . '&hitdays=' . $range[$i] . $extrafields . '">' . $desc[$i] . '';
```

And on line 988:

```
echo '<input type="hidden" name="' . $key . '" value="' . $value . '">';
```

In version 12.0.6 both of those instances where it is output now pass the value through the escaping function [esc\_url()](https://developer.wordpress.org/reference/functions/esc_url/):

```
echo 'href="?page=' . $page . '&hitdays=' . $range[$i] . esc_url($extrafields) . '">' . $desc[$i] . '</a></li>';
```
```
echo '<input type="hidden" name="' . $key . '" value="' . esc_url($value) . '">';
```
## Proof of Concept

The following proof of concept will cause any available cookies to be shown in alert box. Major web browsers other than Firefox provide XSS filtering, so this proof of concept will not work in those web browsers.

Make sure to replace “[path to WordPress]” with the location of WordPress.

```
http://[path to WordPress]/wp-admin/admin.php?page=wps_pages_page&page-uri=%3F%22%3E%3Cscript%3Ealert%28document.cookie%29%3B%3C%2Fscript%3E
```
## Timeline

* April 26, 2017 – Developer notified.
* April 26, 2017 – Developer responds.
* April 28, 2017 – Version 12.0.6 released, which fixes vulnerabilities.

No related posts.

---

### Concerned About The Security of the Plugins You Use?

When you are a paying customer of our service, [you can suggest/vote for the WordPress plugins you use to receive a security review from us](https://www.pluginvulnerabilities.com/wordpress-plugin-security-reviews/). You can start using the service for free when you sign up now. We also offer [security reviews of WordPress plugins as a separate service](https://www.pluginvulnerabilities.com/wordpress-plugin-security-review-service/).
[Plugin Vulnerabilities](https://www.pluginvulnerabilities.com)
Posted in [Vulnerability Report](https://www.pluginvulnerabilities.com/category/vulnerability-report/)
[Reflected Cross-Site Scripting (XSS)](https://www.pluginvulnerabilities.com/tag/reflected-cross-site-scripting-xss/), [Vulnerability Report](https://www.pluginvulnerabilities.com/tag/vulnerability-report/), [WP Statistics](https://www.pluginvulnerabilities.com/tag/wp-statistics/)
[Leave a comment](https://www.pluginvulnerabilities.com/2017/04/28/reflected-cross-site-scripting-xss-vulnerability-in-wp-statistics/#respond)

# Post navigation

### Leave a Reply [Cancel reply](/2017/04/28/reflected-cross-site-scripting-xss-vulnerability-in-wp-statistics/#respond)

Your email address will not be published. Required fields are marked \*

Comment

Name \*

Email \*

Website

In order to pass the CAPTCHA please enable JavaScript

### What WordPress Security issue do you need help with today?

Protecting Your WordPress Websites

Cleaning Up Hacked WordPress Websites

Ensuring WordPress Websites are Secure

Fixing a Vulnerable WP Plugin You Use

Ensuring a WordPress Plugin is Secure

Maintenance for Abandoned WP Plugin

Ensuring a WordPress Theme is Secure

Protecting Your Customers’ Websites

Fixing a Vulnerable Plugin You Develop

How Many Websites Do You Have?
1
2-10
11+

How Critical is it That Your Website Remain Secure?
Low
Medium
High

or

### Latest WordPress Plugin Security Scorecard Grades

* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/link-library)[Link Library](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=link-library)     D+
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/kadence-blocks)[Kadence Blocks](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=kadence-blocks)     F
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/propertyhive)[Property Hive](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=propertyhive)     C
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/ninjafirewall)[NinjaFirewall (WP Editio...](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=ninjafirewall)     D
* ![](/wp-content/plugins/pv-plugin-security-scorecard/plugin-icon/suredash)[SureDash [Alpha]](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?slug=suredash)     F
* [See More Recent Grades](https://www.pluginvulnerabilities.com/plugin-security-scorecard/?results=recent)
* [Check Another Plugin](https://www.pluginvulnerabilities.com/plugin-security-scorecard/)
* [Anti-Malware Security and Brute-Force Firewall vs Login Lockdown](/plugin-security-scorecard/?slug=gotmls&vs=login-lockdown)
### Latest News

* [New Plugins From Awesome Motive and Brainstorm Force Continue Developers’ Failure to Implement Basic Security](https://www.pluginvulnerabilities.com/2025/01/23/new-plugins-from-awesome-motive-and-brainstorm-force-continue-developers-failure-to-implement-basic-security/)
* [Plugin That Patchstack Is Claimed to Ensure Is Secure Contains an Additional Outdated Known Insecure Library](https://www.pluginvulnerabilities.com/2025/01/22/plugin-that-patchstack-is-claimed-to-ensure-is-secure-contains-an-additional-outdated-known-insecure-library/)
* [WordPress Plugins Can Include a Lot of Software That the Plugin’s Developer Doesn’t Have Any Connection To](https://www.pluginvulnerabilities.com/2025/01/22/wordpress-plugins-can-include-a-lot-of-software-that-the-plugins-developer-doesnt-have-any-connection-to/)
### Follow Us

* [Google News](https://news.google.com/publications/CAAqBwgKMNaxwAsw6MzXAw)
* [Bluesky](https://bsky.app/profile/pluginvulns.bsky.social)
* [RSS](https://www.pluginvulnerabilities.com/category/news/feed/)
### Latest Plugin Security Reviews

* [WordPress Plugin Security Review: WP API Privacy](https://www.pluginvulnerabilities.com/2024/11/18/wordpress-plugin-security-review-wp-api-privacy/)
* [WordPress Plugin Security Review: Two Factor](https://www.pluginvulnerabilities.com/2024/09/17/wordpress-plugin-security-review-two-factor/)
* [WordPress Plugin Security Review: Download Monitor](https://www.pluginvulnerabilities.com/2024/09/06/wordpress-plugin-security-review-download-monitor/)

Powered by WordPress and WooCommerce

© 2016-2025 [White Fir Design LLC](http://www.whitefirdesign.com/) | [Privacy Policy](/privacy-policy/)
 Fruitful theme by [fruitfulcode](http://fruitfulcode.com)

[↑](#top "Back to top")

![](https://www.pluginvulnerabilities.com/piwik/piwik.php?idsite=1&rec=1)


