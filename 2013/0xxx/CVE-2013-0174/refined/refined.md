```
{
  "vulnerability": {
    "cveID": "CVE-2013-0174",
    "description": "The external node classifier (ENC) API in Foreman was accessible to any remote host and the output would contain the hashed root psasword (used for unattended installation). Authentication and authorization features were added to the ENC API to secure this data.",
    "related_github_commits": [
      {
        "repo": "theforeman/foreman",
        "sha": "2e734b4ef3e690a7186175db5deac1a9d7083f0b",
        "message": "fixes #2121, #2069 - restrict importers and ENC to puppetmasters and users\n\nCVE-2013-0171: report and fact importers parse YAML directly from the remote\nhost without authentication.  Untrusted YAML can instantiate objects and be\nused to exploit Foreman.\n\nCVE-2013-0174: external nodes (ENC) output is available to any source and\ncould contain sensitive information, e.g. root password.\n\nThe restrict_registered_puppetmasters setting (default: on) now only permits\naccess to the three routes if the remote host has a smart proxy registered\nwith the Puppet feature.\n\nThe require_ssl_puppetmasters setting (default: on) requires a client SSL\ncertificate on HTTPS requests.  The CN is checked against known smart proxies\nas above.  :require_ssl in settings.yaml is recommended to disable HTTP.\n\nEnsure ENC (node.rb) and report (foreman.rb) scripts are updated to supply\nclient SSL certificates."
      },
      {
        "repo": "theforeman/puppet-foreman",
        "sha": "f130631b5a4480e9fa21f7ff98dcb1f8b6e06edb",
         "message": "fixes #2121, #2069 - authenticate to Foreman with SSL certificate\n\nCVE-2013-0171 and CVE-2013-0174 were resolved by verifying client SSL\ncertificates on Foreman interfaces used by puppetmasters.  This change updates\nthe ENC and report processors to provide and verify certificates by default."
      }
    ],
    "root_cause": "The Foreman external node classifier (ENC) API was publicly accessible, exposing hashed root passwords in its output.",
    "weaknesses": [
      "Lack of authentication on the ENC API endpoint",
       "Exposure of sensitive data (hashed root passwords)"
    ],
    "impact": "Exposure of hashed root passwords to unauthenticated remote users.",
    "attack_vectors": [
      "Direct access to the unprotected ENC API endpoint."
    ],
    "required_attacker_capabilities": [
      "Ability to make HTTP requests to the Foreman server"
     ],
     "position": "Remote, unauthenticated attacker"
  }
}
```