=== Content from bugs.debian.org_e03a07af_20250124_211153.html ===

# Debian Bug report logs - #700608 pigz creates temp files with too wide permissions (CVE-2013-0296)

[![version graph](version.cgi?collapse=1;width=2;absolute=0;fixed=pigz%2F2.2.4-2;fixed=pigz%2F2.1.6-1%2Bsqueeze1;height=2;package=pigz;found=pigz%2F2.2.4-1;found=pigz%2F2.1.6-1)](version.cgi?collapse=1;absolute=0;fixed=pigz%2F2.2.4-2;fixed=pigz%2F2.1.6-1%2Bsqueeze1;found=pigz%2F2.2.4-1;found=pigz%2F2.1.6-1;package=pigz;info=1)

Package:
[pigz](pkgreport.cgi?package=pigz);
Maintainer for [pigz](pkgreport.cgi?package=pigz) is [Eduard Bloch <blade@debian.org>](pkgreport.cgi?maint=blade%40debian.org); Source for [pigz](pkgreport.cgi?package=pigz) is [src:pigz](pkgreport.cgi?src=pigz) ([PTS](https://tracker.debian.org/pkg/pigz), [buildd](https://buildd.debian.org/pigz), [popcon](https://qa.debian.org/popcon.php?package=pigz)).

Reported by: [Michael Tokarev <mjt@tls.msk.ru>](pkgreport.cgi?submitter=mjt%40tls.msk.ru)

Date: Fri, 15 Feb 2013 08:33:01 UTC

Severity: *serious*

Tags: patch, security

Found in versions pigz/2.2.4-1, pigz/2.1.6-1

Fixed in versions pigz/2.2.4-2, pigz/2.1.6-1+squeeze1

**Done:** Eduard Bloch <blade@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=700608;mbox=yes), [status mbox](bugreport.cgi?bug=700608;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=700608;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Eduard Bloch <blade@debian.org>`:

`Bug#700608`; Package `pigz`.
(Fri, 15 Feb 2013 08:33:04 GMT) ([full text](bugreport.cgi?bug=700608;msg=2), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Michael Tokarev <mjt@tls.msk.ru>`:

New Bug report received and forwarded. Copy sent to `team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Eduard Bloch <blade@debian.org>`.
(Fri, 15 Feb 2013 08:33:04 GMT) ([full text](bugreport.cgi?bug=700608;msg=4), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=700608;msg=5), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=mjt%40tls.msk.ru)
From: Michael Tokarev <mjt@tls.msk.ru>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: pigz creates temp files with too wide permissions
Date: Fri, 15 Feb 2013 12:30:09 +0400
```
Package: pigz
Version: 2.2.4-1
Severity: serious
Tags: security

When asked to compress a file with restricted permissions (like
mode 0600), the .gz file pigz creates while doing this has
usual mode derived from umask (like 0644).  If the file is
large enough (and why we would use pigz instead of gzip for
small files), this results in the original content being
readable for everyone until the compression finishes.

Here's the deal:

$ fallocate -l 1G foo
$ chmod 0600 foo
$ pigz foo &
$ ls -l foo foo.gz
-rw------- 1 mjt mjt 1073741824 Фев 15 12:27 foo
-rw-rw-r-- 1 mjt mjt     502516 Фев 15 12:27 foo.gz

When it finishes, it correctly applies original file permissions
to the newly created file, but it is already waaay too late.

Other one-file archivers (gzip, xz, bzip2, ...) usually create
the temp file with very strict permissions first, and change it
to the right perms only when done, so only the current user can
read it.

It looks like this bug deserves a CVE#.

Thanks,

/mjt

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Eduard Bloch <blade@debian.org>`:

`Bug#700608`; Package `pigz`.
(Sat, 16 Feb 2013 07:18:03 GMT) ([full text](bugreport.cgi?bug=700608;msg=7), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Eduard Bloch <blade@debian.org>`.
(Sat, 16 Feb 2013 07:18:03 GMT) ([full text](bugreport.cgi?bug=700608;msg=9), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 700608@bugs.debian.org ([full text](bugreport.cgi?bug=700608;msg=10), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Michael Tokarev <mjt@tls.msk.ru>, 700608@bugs.debian.org
Subject: Re: Bug#700608: pigz creates temp files with too wide permissions
Date: Sat, 16 Feb 2013 08:14:17 +0100
```
Control: retitle -1 [CVE-2013-0296](https://security-tracker.debian.org/tracker/CVE-2013-0296): pigz creates temp files with too wide permissions

Hi

On Fri, Feb 15, 2013 at 12:30:09PM +0400, Michael Tokarev wrote:
> When asked to compress a file with restricted permissions (like
> mode 0600), the .gz file pigz creates while doing this has
> usual mode derived from umask (like 0644).  If the file is
> large enough (and why we would use pigz instead of gzip for
> small files), this results in the original content being
> readable for everyone until the compression finishes.
>
> Here's the deal:
>
> $ fallocate -l 1G foo
> $ chmod 0600 foo
> $ pigz foo &
> $ ls -l foo foo.gz
> -rw------- 1 mjt mjt 1073741824 ?????? 15 12:27 foo
> -rw-rw-r-- 1 mjt mjt     502516 ?????? 15 12:27 foo.gz
>
> When it finishes, it correctly applies original file permissions
> to the newly created file, but it is already waaay too late.
>
> Other one-file archivers (gzip, xz, bzip2, ...) usually create
> the temp file with very strict permissions first, and change it
> to the right perms only when done, so only the current user can
> read it.
>
> It looks like this bug deserves a CVE#.

A CVE was assigned to this now[1]: [CVE-2013-0296](https://security-tracker.debian.org/tracker/CVE-2013-0296). Could you please
include the CVE in your changelog when fixing the issue?

 [1]: <http://marc.info/?l=oss-security&m=136099644815551&w=2>

Regards,
Salvatore

```

---

**Changed Bug title to 'CVE-2013-0296: pigz creates temp files with too wide permissions' from 'pigz creates temp files with too wide permissions'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `700608-submit@bugs.debian.org`.
(Sat, 16 Feb 2013 07:18:04 GMT) ([full text](bugreport.cgi?bug=700608;msg=12), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=12), [link](#11)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Eduard Bloch <blade@debian.org>`:

`Bug#700608`; Package `pigz`.
(Sat, 16 Feb 2013 07:21:03 GMT) ([full text](bugreport.cgi?bug=700608;msg=14), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=14), [link](#13)).

---

**Acknowledgement sent**
to `Michael Tokarev <mjt@tls.msk.ru>`:

Extra info received and forwarded to list. Copy sent to `Eduard Bloch <blade@debian.org>`.
(Sat, 16 Feb 2013 07:21:04 GMT) ([full text](bugreport.cgi?bug=700608;msg=16), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=16), [link](#15)).

---

[Message #17](#17) received at 700608@bugs.debian.org ([full text](bugreport.cgi?bug=700608;msg=17), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=17), reply):

![](/cgi-bin/libravatar.cgi?email=mjt%40tls.msk.ru)
From: Michael Tokarev <mjt@tls.msk.ru>
To: 700608@bugs.debian.org
Subject: Re: Bug#700608: pigz creates temp files with too wide permissions
Date: Sat, 16 Feb 2013 11:17:46 +0400
```
Control: retitle -1 pigz creates temp files with too wide permissions ([CVE-2013-0296](https://security-tracker.debian.org/tracker/CVE-2013-0296))

This issue has been assigned [CVE-2013-0296](https://security-tracker.debian.org/tracker/CVE-2013-0296).

Thanks,

/mjt

```

---

**Changed Bug title to 'pigz creates temp files with too wide permissions (CVE-2013-0296)' from 'CVE-2013-0296: pigz creates temp files with too wide permissions'**
Request was from `Michael Tokarev <mjt@tls.msk.ru>`
to `700608-submit@bugs.debian.org`.
(Sat, 16 Feb 2013 07:21:04 GMT) ([full text](bugreport.cgi?bug=700608;msg=19), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=19), [link](#18)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Eduard Bloch <blade@debian.org>`:

`Bug#700608`; Package `pigz`.
(Sat, 16 Feb 2013 08:21:02 GMT) ([full text](bugreport.cgi?bug=700608;msg=21), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=21), [link](#20)).

---

**Acknowledgement sent**
to `Michael Tokarev <mjt@tls.msk.ru>`:

Extra info received and forwarded to list. Copy sent to `Eduard Bloch <blade@debian.org>`.
(Sat, 16 Feb 2013 08:21:02 GMT) ([full text](bugreport.cgi?bug=700608;msg=23), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=23), [link](#22)).

---

[Message #24](#24) received at 700608@bugs.debian.org ([full text](bugreport.cgi?bug=700608;msg=24), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=24), reply):

![](/cgi-bin/libravatar.cgi?email=mjt%40tls.msk.ru)
From: Michael Tokarev <mjt@tls.msk.ru>
To: Salvatore Bonaccorso <carnil@debian.org>
Cc: 700608@bugs.debian.org, Mark Adler <madler@alumni.caltech.edu>
Subject: Re: Bug#700608: CVE-2013-0296: pigz creates temp files with too wide
permissions
Date: Sat, 16 Feb 2013 12:18:35 +0400
```
[[Message part 1](bugreport.cgi?att=0;bug=700608;msg=24) (text/plain, inline)]
```
```
Control: tag -1 + patch

The attached patch fixes the issue.  It uses st.st_mode as a base
when creating a new file (falling back to usual 0666 when dealing
with stdin).  It also uses the same stat attributes as used when
creating the file.

One more thing which is good to have here (it is also potential
security issue) is to use fchmod/fchown/etc instead of chmod/chown/etc,
due to possible symlink tricks, but this might be a bit more changes
than needed for the main fix.

Thanks,

/mjt

```
```
[[pigz-CVE-2013-0296.diff](bugreport.cgi?att=1;bug=700608;filename=pigz-CVE-2013-0296.diff;msg=24) (text/x-patch, attachment)]
```

---

**Added tag(s) patch.**
Request was from `Michael Tokarev <mjt@tls.msk.ru>`
to `700608-submit@bugs.debian.org`.
(Sat, 16 Feb 2013 08:21:03 GMT) ([full text](bugreport.cgi?bug=700608;msg=26), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=26), [link](#25)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Eduard Bloch <blade@debian.org>`:

`Bug#700608`; Package `pigz`.
(Sat, 16 Feb 2013 08:27:03 GMT) ([full text](bugreport.cgi?bug=700608;msg=28), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=28), [link](#27)).

---

**Acknowledgement sent**
to `Michael Tokarev <mjt@tls.msk.ru>`:

Extra info received and forwarded to list. Copy sent to `Eduard Bloch <blade@debian.org>`.
(Sat, 16 Feb 2013 08:27:03 GMT) ([full text](bugreport.cgi?bug=700608;msg=30), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=30), [link](#29)).

---

[Message #31](#31) received at 700608@bugs.debian.org ([full text](bugreport.cgi?bug=700608;msg=31), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=31), reply):

![](/cgi-bin/libravatar.cgi?email=mjt%40tls.msk.ru)
From: Michael Tokarev <mjt@tls.msk.ru>
To: 700608@bugs.debian.org
Cc: Mark Adler <madler@alumni.caltech.edu>
Subject: Re: Bug#700608: CVE-2013-0296: pigz creates temp files with too wide
permissions
Date: Sat, 16 Feb 2013 12:22:31 +0400
```
[[Message part 1](bugreport.cgi?att=0;bug=700608;msg=31) (text/plain, inline)]
```
```
16.02.2013 12:18, Michael Tokarev wrote:
> Control: tag -1 + patch
>
> The attached patch fixes the issue.  It uses st.st_mode as a base
> when creating a new file (falling back to usual 0666 when dealing
> with stdin).  It also uses the same stat attributes as used when
> creating the file.

And attached is a really minimal fix, which does not touch copymeta(),
but uses the same st.st_mode "trick" isntead of using 0666 directly.

For reference: this is all about <http://bugs.debian.org/700608> aka
[CVE-2013-0296](https://security-tracker.debian.org/tracker/CVE-2013-0296).

Thanks,

/mjt

```
```
[[pigz-CVE-2013-0296-mini.diff](bugreport.cgi?att=1;bug=700608;filename=pigz-CVE-2013-0296-mini.diff;msg=31) (text/x-patch, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Eduard Bloch <blade@debian.org>`:

`Bug#700608`; Package `pigz`.
(Sun, 17 Feb 2013 10:42:03 GMT) ([full text](bugreport.cgi?bug=700608;msg=33), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=33), [link](#32)).

---

**Acknowledgement sent**
to `Ivo De Decker <ivo.dedecker@ugent.be>`:

Extra info received and forwarded to list. Copy sent to `Eduard Bloch <blade@debian.org>`.
(Sun, 17 Feb 2013 10:42:03 GMT) ([full text](bugreport.cgi?bug=700608;msg=35), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=35), [link](#34)).

---

[Message #36](#36) received at 700608@bugs.debian.org ([full text](bugreport.cgi?bug=700608;msg=36), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=36), reply):

![](/cgi-bin/libravatar.cgi?email=ivo.dedecker%40ugent.be)
From: Ivo De Decker <ivo.dedecker@ugent.be>
To: 700608@bugs.debian.org
Subject: CVE-2013-0296 also in squeeze
Date: Sun, 17 Feb 2013 11:38:57 +0100
```
Control: found -1 2.1.6-1

Hi,

This issue also exists in squeeze.

Cheers,

Ivo

```

---

**Marked as found in versions pigz/2.1.6-1.**
Request was from `Ivo De Decker <ivo.dedecker@ugent.be>`
to `700608-submit@bugs.debian.org`.
(Sun, 17 Feb 2013 10:42:04 GMT) ([full text](bugreport.cgi?bug=700608;msg=38), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=38), [link](#37)).

---

**Reply sent**
to `Eduard Bloch <blade@debian.org>`:

You have taken responsibility.
(Sat, 23 Feb 2013 20:51:04 GMT) ([full text](bugreport.cgi?bug=700608;msg=40), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=40), [link](#39)).

---

**Notification sent**
to `Michael Tokarev <mjt@tls.msk.ru>`:

Bug acknowledged by developer.
(Sat, 23 Feb 2013 20:51:04 GMT) ([full text](bugreport.cgi?bug=700608;msg=42), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=42), [link](#41)).

---

[Message #43](#43) received at 700608-close@bugs.debian.org ([full text](bugreport.cgi?bug=700608;msg=43), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=43), reply):

![](/cgi-bin/libravatar.cgi?email=blade%40debian.org)
From: Eduard Bloch <blade@debian.org>
To: 700608-close@bugs.debian.org
Subject: Bug#700608: fixed in pigz 2.2.4-2
Date: Sat, 23 Feb 2013 20:47:36 +0000
```
Source: pigz
Source-Version: 2.2.4-2

We believe that the bug you reported is fixed in the latest version of
pigz, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 700608@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Eduard Bloch <blade@debian.org> (supplier of updated pigz package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Sat, 23 Feb 2013 13:44:42 +0100
Source: pigz
Binary: pigz
Architecture: source amd64
Version: 2.2.4-2
Distribution: unstable
Urgency: high
Maintainer: Eduard Bloch <blade@debian.org>
Changed-By: Eduard Bloch <blade@debian.org>
Description:
 pigz       - Parallel Implementation of GZip
Closes: [700608](bugreport.cgi?bug=700608)
Changes:
 pigz (2.2.4-2) unstable; urgency=high
 .
   * Use 600 permissions for unfinished output files ([CVE-2013-0296](https://security-tracker.debian.org/tracker/CVE-2013-0296),
     closes: #[700608](bugreport.cgi?bug=700608))
   * started applying Debian hardening flags
Checksums-Sha1:
 e45f3818f029a5b067b06f0f6c7a95d94e5e891a 1012 pigz_2.2.4-2.dsc
 0744f48ff7bc4d15741ce2f8a1716694d62c0f8f 2888 pigz_2.2.4-2.debian.tar.xz
 8f69e0d472d866aa695492440167a02f7876fc7c 34908 pigz_2.2.4-2_amd64.deb
Checksums-Sha256:
 ae471af43db6eb7d76cd5aca11b1a7c0c22bbfc54b4ebd5144b12634192302da 1012 pigz_2.2.4-2.dsc
 677cdbdf4148cdc89ff512d2bfee0a6616f725a4a757d53a8d8f54a35b0ef99d 2888 pigz_2.2.4-2.debian.tar.xz
 5c3677e819caf7ef14f352a45c5f1441649b8440dfc02f7f47af9beaa65c8605 34908 pigz_2.2.4-2_amd64.deb
Files:
 40600b6811d234d8d6453e29019bc2cd 1012 utils extra pigz_2.2.4-2.dsc
 7aab96c9299529e925e00bb83b2e49bc 2888 utils extra pigz_2.2.4-2.debian.tar.xz
 1aa0bf2546afda6364edebd3a717a599 34908 utils extra pigz_2.2.4-2_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iD8DBQFRKL9Y4QZIHu3wCMURApY+AJkB9Qzyux79we+hynQkikdz+oQoFACcDgsl
eAtzkMSSs6rtfJePgweFAtE=
=/1A1
-----END PGP SIGNATURE-----

```

---

**Reply sent**
to `Eduard Bloch <blade@debian.org>`:

You have taken responsibility.
(Fri, 12 Apr 2013 18:06:05 GMT) ([full text](bugreport.cgi?bug=700608;msg=45), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=45), [link](#44)).

---

**Notification sent**
to `Michael Tokarev <mjt@tls.msk.ru>`:

Bug acknowledged by developer.
(Fri, 12 Apr 2013 18:06:05 GMT) ([full text](bugreport.cgi?bug=700608;msg=47), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=47), [link](#46)).

---

[Message #48](#48) received at 700608-close@bugs.debian.org ([full text](bugreport.cgi?bug=700608;msg=48), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=48), reply):

![](/cgi-bin/libravatar.cgi?email=blade%40debian.org)
From: Eduard Bloch <blade@debian.org>
To: 700608-close@bugs.debian.org
Subject: Bug#700608: fixed in pigz 2.1.6-1+squeeze1
Date: Fri, 12 Apr 2013 18:02:04 +0000
```
Source: pigz
Source-Version: 2.1.6-1+squeeze1

We believe that the bug you reported is fixed in the latest version of
pigz, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 700608@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Eduard Bloch <blade@debian.org> (supplier of updated pigz package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Sat, 23 Feb 2013 21:46:31 +0100
Source: pigz
Binary: pigz
Architecture: source amd64
Version: 2.1.6-1+squeeze1
Distribution: stable
Urgency: high
Maintainer: Eduard Bloch <blade@debian.org>
Changed-By: Eduard Bloch <blade@debian.org>
Description:
 pigz       - Parallel Implementation of GZip
Closes: [700608](bugreport.cgi?bug=700608)
Changes:
 pigz (2.1.6-1+squeeze1) stable; urgency=high
 .
   * Use 600 permissions for unfinished output files ([CVE-2013-0296](https://security-tracker.debian.org/tracker/CVE-2013-0296),
     closes: #[700608](bugreport.cgi?bug=700608))
Checksums-Sha1:
 947f55875a684d0d5e450783d3e9a0bd20d77500 985 pigz_2.1.6-1+squeeze1.dsc
 4f7595f9b80b0b5f8429eab837c8591fb1b85d48 3275 pigz_2.1.6-1+squeeze1.diff.gz
 1445f01f9a30833dc71e7246cd905e2b996622d3 34468 pigz_2.1.6-1+squeeze1_amd64.deb
Checksums-Sha256:
 6c3a123700b06a1dc972f5897e545f098c7129585042305b143218cac71b90b8 985 pigz_2.1.6-1+squeeze1.dsc
 a533946ae359f57b56fcb9240960439b5d5b11a00ea5bb53d2cfd64fc4b25449 3275 pigz_2.1.6-1+squeeze1.diff.gz
 2957b43b6b013788c0b8907d96872a12a2f1d92772c1cbe67f8524e8b47c4e8f 34468 pigz_2.1.6-1+squeeze1_amd64.deb
Files:
 afa5fd8e9a2f4a5a8692c21ec46da4a3 985 utils extra pigz_2.1.6-1+squeeze1.dsc
 c24010228559a5a58c994e8fae6cdf10 3275 utils extra pigz_2.1.6-1+squeeze1.diff.gz
 31083fea056b474e8e7f87385f5ea0c8 34468 utils extra pigz_2.1.6-1+squeeze1_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iD8DBQFRTuTr4QZIHu3wCMURArFEAJ9vq7UetGLUF+/rzKzpv/L/waZkRQCfW8tL
joM7meUOKnFtMFGehJH5LpM=
=yOZ5
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 02 Jun 2013 07:32:45 GMT) ([full text](bugreport.cgi?bug=700608;msg=50), [mbox](bugreport.cgi?bug=700608;mbox=yes;msg=50), [link](#49)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=700608).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 21:11:53 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from www.openwall.com_40db5405_20250124_211149.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[thread-next>]](7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <511DF2DA.7010706@msgid.tls.msk.ru>
Date: Fri, 15 Feb 2013 12:33:30 +0400
From: Michael Tokarev <mjt@....msk.ru>
To: oss-security@...ts.openwall.com
Subject: CVE# request: pigz creates temp file with insecure permissions

I think this one well deserves a CVE#.  I just submitted the following
bug #700608 to Debian BTS:

When asked to compress a file with restricted permissions (like
mode 0600), the .gz file pigz creates while doing this has
usual mode derived from umask (like 0644).  If the file is
large enough (and why we would use pigz instead of gzip for
small files), this results in the original content being
readable for everyone until the compression finishes.

Here's the deal:

$ fallocate -l 1G foo
$ chmod 0600 foo
$ pigz foo &
$ ls -l foo foo.gz
-rw------- 1 mjt mjt 1073741824 Feb 15 12:27 foo
-rw-rw-r-- 1 mjt mjt     502516 Feb 15 12:27 foo.gz

When it finishes, it correctly applies original file permissions
to the newly created file, but it is already waaay too late.

Other one-file archivers (gzip, xz, bzip2, ...) usually create
the temp file with very strict permissions first, and change it
to the right perms only when done, so only the current user can
read it.

Thanks!

/mjt

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_c76cd944_20250124_211149.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](2) [[thread-next>]](../../../2013/02/27/40) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <511F284F.2050304@redhat.com>
Date: Fri, 15 Feb 2013 23:33:51 -0700
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Michael Tokarev <mjt@....msk.ru>
Subject: Re: CVE# request: pigz creates temp file with insecure
 permissions

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 02/15/2013 01:33 AM, Michael Tokarev wrote:
> I think this one well deserves a CVE#.  I just submitted the
> following bug #700608 to Debian BTS:
>
> When asked to compress a file with restricted permissions (like
> mode 0600), the .gz file pigz creates while doing this has usual
> mode derived from umask (like 0644).  If the file is large enough
> (and why we would use pigz instead of gzip for small files), this
> results in the original content being readable for everyone until
> the compression finishes.
>
> Here's the deal:
>
> $ fallocate -l 1G foo $ chmod 0600 foo $ pigz foo & $ ls -l foo
> foo.gz -rw------- 1 mjt mjt 1073741824 Feb 15 12:27 foo -rw-rw-r--
> 1 mjt mjt     502516 Feb 15 12:27 foo.gz
>
> When it finishes, it correctly applies original file permissions to
> the newly created file, but it is already waaay too late.
>
> Other one-file archivers (gzip, xz, bzip2, ...) usually create the
> temp file with very strict permissions first, and change it to the
> right perms only when done, so only the current user can read it.

Apologies for my first misreading of this. Please use CVE-2013-0296
for this issue.

>
> Thanks!
>
> /mjt
>

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)

iQIcBAEBAgAGBQJRHyhPAAoJEBYNRVNeJnmT/58QANpX3fNSN/DV2k2h6/TMreid
gnqYXxndMTo6D63+4jWkKyMb+XsJjNJ52jvN3wAYwKGVk7MtrDzKydDFn5qFMBJ0
4Ysp+cVsD5HE4QRc6cJPkBNaoKA6t+cj0fInu/hqkXMTAZpUDEPn9p4FUjB0OSrJ
nOFz4PWbAPX8KItMNUmMCu/r2OnOQ7vhJDHk37GIXhEwvZE9Hf2m2mNtBfBHHrlw
7x8fO0lEmYi3aOhkvm+ka0U/YplmNWxWXjF0xoxzwQgEeJV+xSiCgk7Wk4YzYLTm
i4TPI/RHvvuXgKs2mzHXE6qu5F0ADif0Vhl2iEasl8X3Zjeb6nZ7i6r+eTAMmsXf
pJvDbC28PnPGSC+u9J4oibDbugu7FJXyYDWtDz6ylQTFDJZ6nXPKGfUUbq2i/7vn
G84r/1LsrF8PxBFu8fFCD/+tZtyoCMU8qosfiTFHi4sgVF/4jGBVmICkyn6IE+3e
VL/bcutjWd9gGg9S8MaAO+TDnEmaJbvluPlBandKNdZIV18e7bDed6fsGwXiyJ12
XGIC5A9IgxioG4yFguwB1LutVaBMW80UxjMZQDOoeTOLWLS6dLqFuLbWz3DK0b3a
aqh+tH1OvYNHgpu9UFDFFVvGCMziXL8k95dPb/8BbHF0YB4GGP9K0V77BEvRBJkC
jAPHv+UOIAjW2xXDwTyK
=OByZ
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from lists.opensuse.org_bffc092a_20250124_211147.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/I7EWO3DCIM576CGSIU6PK6YZJJBETV7O/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/I7EWO3DCIM576CGSIU6PK6YZJJBETV7O/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/I7EWO3DCIM576CGSIU6PK6YZJJBETV7O/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/I7EWO3DCIM576CGSIU6PK6YZJJBETV7O/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/I7EWO3DCIM576CGSIU6PK6YZJJBETV7O/#I7EWO3DCIM576CGSIU6PK6YZJJBETV7O)

# openSUSE-SU-2013:0540-1: moderate: pigz: fixed unpacking permissions

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

26 Mar
2013

26 Mar
'13

17:04

openSUSE Security Update: pigz: fixed unpacking permissions
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2013:0540-1
Rating: moderate
References: #803933
Cross-References: CVE-2013-0296
Affected Products:
openSUSE 12.3
openSUSE 12.2
openSUSE 12.1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes one vulnerability is now available.
Description:
pigz incorrectly used world writeable permissions during
unpacking (CVE-2013-0296).
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.3:
zypper in -t patch openSUSE-2013-258
- openSUSE 12.2:
zypper in -t patch openSUSE-2013-258
- openSUSE 12.1:
zypper in -t patch openSUSE-2013-258
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.3 (i586 x86\_64):
pigz-2.2.5-2.4.1
pigz-debuginfo-2.2.5-2.4.1
pigz-debugsource-2.2.5-2.4.1
- openSUSE 12.2 (i586 x86\_64):
pigz-2.1.6-9.4.1
pigz-debuginfo-2.1.6-9.4.1
pigz-debugsource-2.1.6-9.4.1
- openSUSE 12.1 (i586 x86\_64):
pigz-2.1.6-5.4.1
pigz-debuginfo-2.1.6-5.4.1
pigz-debugsource-2.1.6-5.4.1
References:
<http://support.novell.com/security/cve/CVE-2013-0296.html>
<https://bugzilla.novell.com/803933>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/I7EWO3DCIM576CGSIU6PK6YZJJBETV7O/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/I7EWO3DCIM576CGSIU6PK6YZJJBETV7O/#I7EWO3DCIM576CGSIU6PK6YZJJBETV7O)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from bugzilla.novell.com_772bece7_20250126_033317.html ===




=== Content from security-tracker.debian.org_012ccf55_20250126_033309.html ===

# CVE-2013-0296

| **Name** | CVE-2013-0296 |
| --- | --- |
| **Description** | Race condition in pigz before 2.2.5 uses permissions derived from the umask when compressing a file before setting that file's permissions to match those of the original file, which might allow local users to bypass intended access permissions while compression is occurring. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2013-0296) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2013-0296); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2013-0296), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2013-0296), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2013-0296), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2013-0296), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-0296), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2013-0296), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2013-0296), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2013-0296)/[CVE](https://www.suse.com/security/cve/CVE-2013-0296/), GitHub [advisories](https://github.com/advisories?query=CVE-2013-0296)/[code](https://github.com/search?type=Code&q=%22CVE-2013-0296%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2013-0296%22), [web search](https://duckduckgo.com/html?q=%22CVE-2013-0296%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [700608](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=700608) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [pigz](/tracker/source-package/pigz) ([PTS](https://tracker.debian.org/pkg/pigz)) | bookworm, bullseye | 2.6-1 | fixed |
|  | sid, trixie | 2.8-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [pigz](/tracker/source-package/pigz) | source | squeeze | 2.1.6-1+squeeze1 |  |  |  |
| [pigz](/tracker/source-package/pigz) | source | (unstable) | 2.2.4-2 | low |  | [700608](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=700608) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from mail.zlib.net_85440036_20250124_211148.html ===

# [pigz-announce] pigz version 2.2.5 released

**Mark Adler**
madler at alumni.caltech.edu

*Sat Jul 28 16:56:02 EDT 2012*

* Previous message (by thread): [[pigz-announce] Parallel decompression in pigz](000005.html)
* **Messages sorted by:**
  [[ date ]](date.html#6)
  [[ thread ]](thread.html#6)
  [[ subject ]](subject.html#6)
  [[ author ]](author.html#6)

---

```
pigz users,

pigz version 2.2.5 has been released and is now available at <http://zlib.net/pigz/> .  The main changes since 2.2.4 are:

- Change suffix to .tar when decompressing or listing .tgz.
- Print name of executable in error messages.
- Show help properly when the name is unpigz or gunzip.
- Fix permissions security problem before output is closed.

The security hole in 2.2.4 was due to the output file temporarily having more liberal access permissions (group and other read) that possibly the input file (e.g. only user read).  Once the write was complete however, the output file was set to the correct permissions.  With 2.2.5, the output file is readable only by the user while being written.  You should upgrade immediately to 2.2.5 to avoid the potential security issue.

Mark

```

---

* Previous message (by thread): [[pigz-announce] Parallel decompression in pigz](000005.html)
* **Messages sorted by:**
  [[ date ]](date.html#6)
  [[ thread ]](thread.html#6)
  [[ subject ]](subject.html#6)
  [[ author ]](author.html#6)

---

[More information about the pigz-announce
mailing list](http://zlib.net/mailman/listinfo/pigz-announce_zlib.net)


