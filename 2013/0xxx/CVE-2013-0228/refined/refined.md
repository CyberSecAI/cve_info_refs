```
{
  "cveId": "CVE-2013-0228",
  "related": true,
  "content": "The xen_iret function in arch/x86/xen/xen-asm_32.S in the Linux kernel before 3.7.9 on 32-bit Xen paravirt_ops platforms does not properly handle an invalid value in the DS segment register, which allows guest OS users to gain guest OS privileges via a crafted application.\n\nRoot cause of vulnerability: The `xen_iret` function, used when returning from a Xen hypervisor call on 32-bit PV guests, incorrectly assumes that the DS (Data Segment) register is valid. \n\nWeaknesses/vulnerabilities present: The vulnerability lies in the `xen_iret` function's reliance on the DS register, which can be manipulated by user-level code in the guest OS. Specifically, the LDT (Local Descriptor Table) can be modified by a guest user to invalidate the DS register (e.g., setting it to NULL). When `xen_iret` tries to use the invalid DS to access per-CPU data, it results in a general protection fault.\n\nImpact of exploitation: An unprivileged guest user can cause a denial of service (guest OS crash) or gain guest OS privileges.\n\nAttack vectors: A malicious or buggy unprivileged guest OS user can craft an application to modify the LDT and corrupt the DS register, leading to a kernel crash or privilege escalation by triggering the general protection fault in `xen_iret`.\n\nRequired attacker capabilities/position: The attacker must be an unprivileged user within a 32-bit PV Xen guest OS. They need to be able to modify the LDT. Classic-Xen kernels, all 64bit PV guests and all HVM guests are not vulnerable."
}
```