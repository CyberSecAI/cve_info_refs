```
{
  "cve": "CVE-2013-0197",
  "description": "Jakub Galczyk discovered a cross site scripting (XSS) vulnerability in MantisBT 1.2.12 and earlier versions that allows a malicious person to trick the browser of a target user into executing arbitrary JavaScript via the URL: search.php?match_type=\"><script...\". This vulnerability is particularly wide reaching due to search.php being usable by anonymous users on public facing installations of MantisBT (no user account required).",
  "vulnerability_details": {
    "root_cause": "The `match_type` parameter in `search.php` is not properly sanitized before being used in HTML output.",
    "weaknesses": [
      "Cross-Site Scripting (XSS)"
    ],
    "impact": "An attacker can inject arbitrary JavaScript code into a user's browser, potentially leading to session hijacking, data theft, or other malicious actions.",
    "attack_vector": "By crafting a URL with a malicious payload in the `match_type` parameter.",
    "attacker_capabilities": "The attacker needs to be able to craft a URL and send it to a user or trick the user into accessing it.",
    "affected_versions": [
      "MantisBT 1.2.12 and earlier versions"
    ],
        "additional_details": "The vulnerability is present in `search.php` and can be exploited by anonymous users. The `match_type` parameter was not being sanitized before use in the HTML output."
  },
  "fixes": [
    {
      "commit_id": "f5ac454eb63fde102347a021a2af0c535033d572",
      "description": "The value of the `match_type` filter parameter is now correctly sanitized using `string_attribute()` prior to use in the HTML output.",
         "file_changes": [
            {
               "file": "core/filter_api.php",
              "change": "Replaced  `<input type=\"hidden\" name=\"match_type\" value=\"<?php echo $t_filter[FILTER_PROPERTY_MATCH_TYPE]?>\"/>` with `<input type=\"hidden\" name=\"match_type\" value=\"<?php echo string_attribute( $t_filter[FILTER_PROPERTY_MATCH_TYPE] )?>\"/>`"
            }
          ]
    },
      {
      "commit_id": "610da6ecda08239187bc12bf9bf35ba4d27f1920",
      "description": "The `match_type` parameter is now treated as an integer value using `gpc_get_int` instead of `gpc_get_string`, which mitigates the vulnerability.",
           "file_changes": [
              {
                 "file": "core/filter_api.php",
                 "change": "Replaced `<input type=\"hidden\" name=\"match_type\" value=\"<?php echo string_attribute( $t_filter[FILTER_PROPERTY_MATCH_TYPE] )?>\"/>` with  `<input type=\"hidden\" name=\"match_type\" value=\"<?php echo $t_filter[FILTER_PROPERTY_MATCH_TYPE] ?>\"/>`"
                },
                {
                  "file": "view_all_set.php",
                  "change": "Replaced `$f_match_type = gpc_get_string ( FILTER_PROPERTY_MATCH_TYPE, FILTER_MATCH_ALL );` with `$f_match_type = gpc_get_int( FILTER_PROPERTY_MATCH_TYPE, FILTER_MATCH_ALL );`"
                }
          ]
    },
     {
      "commit_id": "bbc6b4f3ea8d0a53ae8c44e4218df6675a4e5fdf",
      "description": "The value of the `match_type` filter parameter is now correctly sanitized prior to use in the HTML output displaying the current filter settings.",
        "file_changes": [
            {
               "file": "core/filter_api.php",
              "change": "Replaced  `<input type=\"hidden\" name=\"match_type\" value=\"<?php echo $t_filter[FILTER_PROPERTY_MATCH_TYPE]?>\"/>` with `<input type=\"hidden\" name=\"match_type\" value=\"<?php echo string_attribute( $t_filter[FILTER_PROPERTY_MATCH_TYPE] )?>\"/>`"
            }
          ]
    },
      {
      "commit_id": "45f9e746fb9a42e74b668211372d9e45db3e7b6c",
      "description": "The `match_type` parameter is now treated as an integer value using `gpc_get_int` instead of `gpc_get_string`, which mitigates the vulnerability.",
           "file_changes": [
              {
                 "file": "core/filter_api.php",
                 "change": "Replaced `<input type=\"hidden\" name=\"match_type\" value=\"<?php echo string_attribute( $t_filter[FILTER_PROPERTY_MATCH_TYPE] )?>\"/>` with  `<input type=\"hidden\" name=\"match_type\" value=\"<?php echo $t_filter[FILTER_PROPERTY_MATCH_TYPE] ?>\"/>`"
                },
                {
                  "file": "view_all_set.php",
                  "change": "Replaced `$f_match_type = gpc_get_string ( FILTER_PROPERTY_MATCH_TYPE, FILTER_MATCH_ALL );` with `$f_match_type = gpc_get_int( FILTER_PROPERTY_MATCH_TYPE, FILTER_MATCH_ALL );`"
                }
          ]
    }
  ]
}
```