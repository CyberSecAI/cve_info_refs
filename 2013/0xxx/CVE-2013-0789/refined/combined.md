=== Content from bugzilla.mozilla.org_797fff2c_20250125_151437.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/842300)
* [XML](/show_bug.cgi?ctype=xml&id=842300)

Closed
[Bug 842300](/show_bug.cgi?id=842300)

Opened 12 years ago
Closed 12 years ago

# IonMonkey: Crash [@ js::GetObjectClass] with invalid read

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

IonMonkey: Crash [@ js::GetObjectClass] with invalid read

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla22

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox19 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix) |
| firefox20 | [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed) |
| firefox21 | [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed) |
| firefox22 | [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=fixed) |
| firefox-esr17 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected) |
| b2g18 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox19 |  | wontfix |
| firefox20 | + | fixed |
| firefox21 | + | fixed |
| firefox22 | + | fixed |
| firefox-esr17 |  | unaffected |
| b2g18 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: decoder, Assigned: dvander)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [dvander](/user_profile?user_id=309316)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/55857f92ded07119259dc6c1dd386205?d=mm&size=40)  [general](/user_profile?user_id=4729)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/b29b83d12aba827b8ff68296e473bec5?d=mm&size=40)  [decoder](/user_profile?user_id=395101)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

17 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[IonFuzz](/show_bug.cgi?id=724444 "RESOLVED FIXED - [meta] IonMonkey fuzz bugs"), [845340](/show_bug.cgi?id=845340 "RESOLVED WORKSFORME - Shumway Box2d example stops working")

Dependency [tree](/showdependencytree.cgi?id=842300&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=842300)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [jsbugmon:update][adv-main20+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[jsbugmon:update][adv-main20+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c14 "12 years ago") | ? |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | ? |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ js::GetObjectClass ]](https://crash-stats.mozilla.org/signature/?signature=js%3A%3AGetObjectClass)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [fix](/attachment.cgi?id=718684)  [12 years ago](#c6)  [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)   8.26 KB, patch | nbp : [review+](#c9 "12 years ago")  bajaj : [approval-mozilla-aurora+](#a2009105_448925 "12 years ago")  bajaj : [approval-mozilla-beta+](#a2009105_448925 "12 years ago")  abillings : [sec-approval+](#a1326479_280903 "12 years ago") | [Details](/attachment.cgi?id=718684&action=edit) | [Diff](/attachment.cgi?id=718684&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=842300&attachment=718684) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=842300#c0)• 12 years ago |
|  | |

The following testcase crashes on mozilla-central revision 0acbd06d48a9 (run with --ion-eager):
evaluate("\
var x = function g() {\
return g.toString();\
};\
x('y')\
", { noScriptRval : true });
evaluate("\
x('y')\
", { noScriptRval : true });

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=842300#c1)• 12 years ago |
|  | |

Debug trace:
Program received signal SIGSEGV, Segmentation fault.
0x00000000004050bb in js::GetObjectClass (obj=(js::RawObject) 0x7ffff602d381 Cannot access memory at address 0x5000007ffff603b6) at ../../jsfriendapi.h:366
366 return reinterpret\_cast<const shadow::Object\*>(obj)->type->clasp;
(gdb) bt 8
#0 0x00000000004050bb in js::GetObjectClass (obj=(js::RawObject) 0x7ffff602d381 Cannot access memory at address 0x5000007ffff603b6) at ../../jsfriendapi.h:366
#1 0x0000000000405337 in js::IsProxy (obj=(js::RawObject) 0x7ffff602d381 Cannot access memory at address 0x5000007ffff603b6) at ../../jsproxy.h:239
#2 0x0000000000409c4e in JSObject::isProxy (this=(const JSObject \* const) 0x7ffff602d381 Cannot access memory at address 0x5000007ffff603b6) at ../../jsobjinlines.h:1296
#3 0x0000000000c69b7f in IsCacheableListBase (obj=(JSObject \*) 0x7ffff602d381 Cannot access memory at address 0x5000007ffff603b6) at /srv/repos/mozilla-central/js/src/ion/IonCaches.cpp:89
#4 0x0000000000c6f029 in TryAttachNativeGetPropStub (cx=0x13bae90, ion=0x1449e10, cache=..., obj=(JSObject \* const) 0x7ffff602d381 Cannot access memory at address 0x5000007ffff603b6, name="toString", safepointIndex=
0x1449fd0, returnAddr=0x7ffff7fed873, isCacheable=0x7fffffff510f) at /srv/repos/mozilla-central/js/src/ion/IonCaches.cpp:855
#5 0x0000000000c6fbf7 in js::ion::GetPropertyCache (cx=0x13bae90, cacheIndex=0, obj=(JSObject \* const) 0x7ffff602d381 Cannot access memory at address 0x5000007ffff603b6, vp=JSVAL\_VOID)
at /srv/repos/mozilla-central/js/src/ion/IonCaches.cpp:964
#6 0x00007ffff7fe9e84 in ?? ()
#7 0x00007fffffff51b0 in ?? ()
(More stack frames follow...)
(gdb) x /i $pc
=> 0x4050bb <js::GetObjectClass(JSObject\*)+16>: mov (%rax),%rax
(gdb) info reg rax
rax 0x13d76 81270
(gdb) l
363 inline js::Class \*
364 GetObjectClass(RawObject obj)
365 {
366 return reinterpret\_cast<const shadow::Object\*>(obj)->type->clasp;
367 }
Corrupted obj pointer, marking sec-critical.Blocks: [IonFuzz](/show_bug.cgi?id=724444 "RESOLVED FIXED - [meta] IonMonkey fuzz bugs")Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)Summary: Crash [@ js::GetObjectClass] with invalid read → IonMonkey: Crash [@ js::GetObjectClass] with invalid readWhiteboard: [jsbugmon:update,bisect]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842300#a32621_395101)• 12 years ago |

Whiteboard: [jsbugmon:update,bisect] → [jsbugmon:update]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=842300#c2)• 12 years ago |
|  | |

JSBugMon: Bisection requested, result:
autoBisect shows this is probably related to the following changeset:
The first bad revision is:
changeset: 121830:507316db9c59
user: David Anderson
date: Wed Feb 13 17:24:50 2013 -0800
summary: Implement JSOP\_CALLEE in JM ([bug 794427](/show_bug.cgi?id=794427 "RESOLVED WORKSFORME - Calling function expression by name via .call() method hits stack limit"), r=bhackett).
This iteration took 123.461 seconds to run.

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=842300#c3)• 12 years ago |
|  | |

Needinfo from dvander based on [comment 2](/show_bug.cgi?id=842300#c2 "VERIFIED FIXED - IonMonkey: Crash [@ js::GetObjectClass] with invalid read") :)Flags: needinfo?(dvander)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=842300#c4)• 12 years ago |
|  | |

Simpler test for the testsuite:
var x = function g() {
return g.toString();
};
for ( var i = 0; i < 3; i++ )
x(i)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842300#a109768_309316)• 12 years ago |

Assignee: general → dvanderStatus: NEW → ASSIGNED

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842300#a109779_309316)• 12 years ago |

Flags: needinfo?(dvander)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842300#a281253_1689)• 12 years ago |

Blocks: [794427](/show_bug.cgi?id=794427 "RESOLVED WORKSFORME - Calling function expression by name via .call() method hits stack limit")
[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=unaffected)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected)
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected)
[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B)
[tracking-firefox22](/buglist.cgi?f1=cf_tracking_firefox22&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B)Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=842300#c5)• 12 years ago |
|  | |

This was actually a pre-existing bug in IonMonkey, exposed much easier now that JM can compile JSOP\_CALLEE.No longer blocks: [794427](/show_bug.cgi?id=794427 "RESOLVED WORKSFORME - Calling function expression by name via .call() method hits stack limit")

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=842300#c6)• 12 years ago |
|  | |

Attached patch

[fix](attachment.cgi?id=718684&action=diff)
— [Details](attachment.cgi?id=718684&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=842300&attachment=718684)

Easy fix, when inlining make sure we read the innermost callee instead of the outermost.
[Attachment #718684](/attachment.cgi?id=718684&action=edit "fix") -
Flags: review?(nicolas.b.pierron)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842300#a806991_309316)• 12 years ago |

Blocks: [845340](/show_bug.cgi?id=845340 "RESOLVED WORKSFORME - Shumway Box2d example stops working")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=842300#c7)• 12 years ago |
|  | |

Updating tracking flags based on [comment 5](/show_bug.cgi?id=842300#c5 "VERIFIED FIXED - IonMonkey: Crash [@ js::GetObjectClass] with invalid read") (that this is a preexisting Ionmonkey bug, so 17 and b2g are unaffected).
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=842300#c8)• 12 years ago |
|  | |

Would be nice to land in Beta too if the patch is low risk.
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%3F)

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842300#a977702_272375)• 12 years ago |

[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B)

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=842300#c9)• 12 years ago |
|  | |

Comment on [attachment 718684](/attachment.cgi?id=718684 "fix") [[details]](/attachment.cgi?id=718684&action=edit "fix") [[diff]](/attachment.cgi?id=718684&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=842300&attachment=718684)
fix
Review of [attachment 718684](/attachment.cgi?id=718684 "fix") [[details]](/attachment.cgi?id=718684&action=edit "fix") [[diff]](/attachment.cgi?id=718684&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=842300&attachment=718684):
-----------------------------------------------------------------
sounds good to me.
[Attachment #718684](/attachment.cgi?id=718684&action=edit "fix") -
Flags: review?(nicolas.b.pierron) → review+

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=842300#c10)• 12 years ago |
|  | |

Comment on [attachment 718684](/attachment.cgi?id=718684 "fix") [[details]](/attachment.cgi?id=718684&action=edit "fix") [[diff]](/attachment.cgi?id=718684&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=842300&attachment=718684)
fix
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Not easily.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
No.
Which older supported branches are affected by this flaw?
19 through 22.
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
This patch should apply.
How likely is this patch to cause regressions; how much testing does it need?
Unlikely; tbpl+awfy is fine.
[Attachment #718684](/attachment.cgi?id=718684&action=edit "fix") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842300#a1326479_280903)• 12 years ago |

[Attachment #718684](/attachment.cgi?id=718684&action=edit "fix") -
Flags: sec-approval? → sec-approval+

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=842300#c11)• 12 years ago |
|  | |

This needs to land and then get nominated for uplift before Tues Mar 12th when we go to build on beta 5.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842300#a1586961_132034)• 12 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=842300#c12)• 12 years ago |
|  | |

This doesn't apply cleanly to inbound. Please rebase.Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=842300#c13)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/4db85af71a2c>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=842300#c14)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/4db85af71a2c>Status: ASSIGNED → RESOLVEDClosed: 12 years ago
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=fixed)Flags: in-testsuite?Resolution: --- → FIXEDTarget Milestone: --- → mozilla22

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842300#a1804557_395101)• 12 years ago |

Status: RESOLVED → VERIFIED

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=842300#c15)• 12 years ago |
|  | |

JSBugMon: This bug has been automatically verified fixed.

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=842300#c16)• 12 years ago |
|  | |

Comment on [attachment 718684](/attachment.cgi?id=718684 "fix") [[details]](/attachment.cgi?id=718684&action=edit "fix") [[diff]](/attachment.cgi?id=718684&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=842300&attachment=718684)
fix
[Approval Request Comment]
Bug caused by (feature/regressing bug #): IonMonkey
User impact if declined: potential sg:crit
Testing completed (on m-c, etc.): Yes
Risk to taking this patch (and alternatives if risky): None
String or UUID changes made by this patch: None
[Attachment #718684](/attachment.cgi?id=718684&action=edit "fix") -
Flags: approval-mozilla-beta?
[Attachment #718684](/attachment.cgi?id=718684&action=edit "fix") -
Flags: approval-mozilla-aurora?

|  | [bhavana bajaj [:bajaj]](/user_profile?user_id=448925) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842300#a2009105_448925)• 12 years ago |

[Attachment #718684](/attachment.cgi?id=718684&action=edit "fix") -
Flags: approval-mozilla-beta?
[Attachment #718684](/attachment.cgi?id=718684&action=edit "fix") -
Flags: approval-mozilla-beta+
[Attachment #718684](/attachment.cgi?id=718684&action=edit "fix") -
Flags: approval-mozilla-aurora?
[Attachment #718684](/attachment.cgi?id=718684&action=edit "fix") -
Flags: approval-mozilla-aurora+

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=842300#c17)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/333a93611b4a>
<https://hg.mozilla.org/releases/mozilla-beta/rev/fc49b18945ae>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842300#a2025739_75935)• 12 years ago |

[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842300#a3043492_280903)• 12 years ago |

Whiteboard: [jsbugmon:update] → [jsbugmon:update][adv-main20+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842300#a24214477_1689)• 11 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=842300&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from lists.opensuse.org_fc11f13a_20250125_151417.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/Q746FRUOIY6EBDYKZW5PMBQINRYTN3NT/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/Q746FRUOIY6EBDYKZW5PMBQINRYTN3NT/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/Q746FRUOIY6EBDYKZW5PMBQINRYTN3NT/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/Q746FRUOIY6EBDYKZW5PMBQINRYTN3NT/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/Q746FRUOIY6EBDYKZW5PMBQINRYTN3NT/#Q746FRUOIY6EBDYKZW5PMBQINRYTN3NT)

# openSUSE-SU-2013:0875-1: moderate: seamonkey: 2.17 update

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

10 Jun
2013

10 Jun
'13

15:05

openSUSE Security Update: seamonkey: 2.17 update
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2013:0875-1
Rating: moderate
References: #813026 #814101
Cross-References: CVE-2013-0788 CVE-2013-0789 CVE-2013-0792
CVE-2013-0793 CVE-2013-0794 CVE-2013-0795
CVE-2013-0796 CVE-2013-0800
Affected Products:
openSUSE 12.3
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes 8 vulnerabilities is now available.
Description:
Seamonkey was updated to the 2.17 release, fixing bugs and
security issues:
- update to SeaMonkey 2.17 (bnc#813026)
\* requires NSPR 4.9.5 and NSS 3.14.3
\* mozilla-webrtc-ppc.patch included upstream
\* MFSA 2013-30/CVE-2013-0788/CVE-2013-0789 Miscellaneous
memory safety hazards
\* MFSA 2013-31/CVE-2013-0800 (bmo#825721) Out-of-bounds
write in Cairo library
\* MFSA 2013-35/CVE-2013-0796 (bmo#827106) WebGL crash
with Mesa graphics driver on Linux
\* MFSA 2013-36/CVE-2013-0795 (bmo#825697) Bypass of SOW
protections allows cloning of protected nodes
\* MFSA 2013-37/CVE-2013-0794 (bmo#626775) Bypass of
tab-modal dialog origin disclosure
\* MFSA 2013-38/CVE-2013-0793 (bmo#803870) Cross-site
scripting (XSS) using timed history navigations
\* MFSA 2013-39/CVE-2013-0792 (bmo#722831) Memory
corruption while rendering grayscale PNG images
- use GStreamer 1.0 starting with 12.3
(mozilla-gstreamer-1.patch)
- revert to use GStreamer 0.10 on 12.3 (bnc#814101) (remove
mozilla-gstreamer-1.patch)
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.3:
zypper in -t patch openSUSE-2013-400
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.3 (i586 x86\_64):
seamonkey-2.17-1.8.4
seamonkey-debuginfo-2.17-1.8.4
seamonkey-debugsource-2.17-1.8.4
seamonkey-dom-inspector-2.17-1.8.4
seamonkey-irc-2.17-1.8.4
seamonkey-translations-common-2.17-1.8.4
seamonkey-translations-other-2.17-1.8.4
seamonkey-venkman-2.17-1.8.4
References:
<http://support.novell.com/security/cve/CVE-2013-0788.html>
<http://support.novell.com/security/cve/CVE-2013-0789.html>
<http://support.novell.com/security/cve/CVE-2013-0792.html>
<http://support.novell.com/security/cve/CVE-2013-0793.html>
<http://support.novell.com/security/cve/CVE-2013-0794.html>
<http://support.novell.com/security/cve/CVE-2013-0795.html>
<http://support.novell.com/security/cve/CVE-2013-0796.html>
<http://support.novell.com/security/cve/CVE-2013-0800.html>
<https://bugzilla.novell.com/813026>
<https://bugzilla.novell.com/814101>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/Q746FRUOIY6EBDYKZW5PMBQINRYTN3NT/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/Q746FRUOIY6EBDYKZW5PMBQINRYTN3NT/#Q746FRUOIY6EBDYKZW5PMBQINRYTN3NT)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from bugzilla.mozilla.org_401661e7_20250125_151431.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/831055)
* [XML](/show_bug.cgi?ctype=xml&id=831055)

Closed
[Bug 831055](/show_bug.cgi?id=831055)

Opened 12 years ago
Closed 12 years ago

# "Assertion failure: [infer failure] Missing type in object [0x241d1f0] lastIndex: float,"

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

"Assertion failure: [infer failure] Missing type in object [0x241d1f0] lastIndex: float,"

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

Windows 7

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox20 | [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed) |
| firefox21 | [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed) |
| firefox-esr17 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected) |
| b2g18 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox20 | + | fixed |
| firefox21 | + | fixed |
| firefox-esr17 |  | unaffected |
| b2g18 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: gkw, Unassigned)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

*Unassigned*

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/55857f92ded07119259dc6c1dd386205?d=mm&size=40)  [general](/user_profile?user_id=4729)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [gkw](/user_profile?user_id=132034)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

9 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[826588](/show_bug.cgi?id=826588 "RESOLVED FIXED - Differential Testing: Getting different output on 64-bit Windows js shells involving lastIndex")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[808245](/show_bug.cgi?id=808245 "RESOLVED FIXED - Use YARR's new MatchOnly JIT mode")

Dependency [tree](/showdependencytree.cgi?id=831055&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=831055)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [jsbugmon:][adv-main20+] YARR bug on Win64)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[jsbugmon:][adv-main20+] YARR bug on Win64

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [gkw](/user_profile?user_id=132034) | [in-testsuite](#c6 "12 years ago") | ? |
| --- | --- | --- |
| [gkw](/user_profile?user_id=132034) | in-testsuite | ? |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [stack](/attachment.cgi?id=702566)  [12 years ago](#c0)  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)   7.62 KB, text/plain |  | [Details](/attachment.cgi?id=702566&action=edit) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=831055#c0)• 12 years ago |
|  | |

Attached file
[stack](attachment.cgi?id=702566)
— [Details](attachment.cgi?id=702566&action=edit)

r = RegExp("(?!})()?", "g");
r.test();
r.lastIndex;
asserts js debug shell on m-c changeset 56ff556e74d9 with -a at Assertion failure: [infer failure] Missing type in object [0x241d1f0] lastIndex: float,
Tested on 64-bit. s-s because this is an inference failure.
autoBisect shows this is probably related to the following changeset:
The first bad revision is:
changeset: 116119:b7e2ba73b2ff
user: Sean Stangl
date: Wed Dec 12 18:11:28 2012 -0800
summary: [Bug 808245](/show_bug.cgi?id=808245 "RESOLVED FIXED - Use YARR's new MatchOnly JIT mode"), Part 6/6 - Add MatchOnly mode and lazify RegExpStatics.
r=dvander

|  | [Sean Stangl [:sstangl]](/user_profile?user_id=383201) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=831055#c1)• 12 years ago |
|  | |

This is probably another instance of [Bug 826581](/show_bug.cgi?id=826581 "VERIFIED FIXED - Crash [@ js::RegExpShared::compile]"). Anything involving search(), test(), or replace() will have random behavior on Win64 until that bug is fixed.

|  | [Sean Stangl [:sstangl]](/user_profile?user_id=383201) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=831055#c2)• 12 years ago |
|  | |

That should read "[Bug 826588](/show_bug.cgi?id=826588 "RESOLVED FIXED - Differential Testing: Getting different output on 64-bit Windows js shells involving lastIndex")".

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=831055#a1479_395101)• 12 years ago |

Whiteboard: [jsbugmon:update] → [jsbugmon:]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=831055#c3)• 12 years ago |
|  | |

JSBugMon: Cannot process bug: Unable to automatically reproduce, please track manually.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=831055#a1645_132034)• 12 years ago |

Depends on: [826588](/show_bug.cgi?id=826588 "RESOLVED FIXED - Differential Testing: Getting different output on 64-bit Windows js shells involving lastIndex")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=831055#c4)• 12 years ago |
|  | |

Marking as moderate because it is probably Win64 only.Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)Whiteboard: [jsbugmon:] → [jsbugmon:] YARR bug on Win64

|  | [Sean Stangl [:sstangl]](/user_profile?user_id=383201) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=831055#c5)• 12 years ago |
|  | |

Gary, this also should have been fixed by Makoto's recent patch in [Bug 830676](/show_bug.cgi?id=830676 "RESOLVED FIXED - YarrJIT is broken on Win64 after landing bug 820124").Flags: needinfo?(gary)

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=831055#c6)• 12 years ago |
|  | |

I verify that the assertion no longer occurs with the testcase. Setting in-testsuite? and assuming fixed by [bug 830676](/show_bug.cgi?id=830676 "RESOLVED FIXED - YarrJIT is broken on Win64 after landing bug 820124").Status: NEW → RESOLVEDClosed: 12 years agoFlags: needinfo?(gary) → in-testsuite?Resolution: --- → FIXED

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=831055#a1895963_132034)• 12 years ago |

[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=831055#c7)• 12 years ago |
|  | |

Can we land 830676 on Aurora? This bug occurs on at least Firefox 20 based on when it was filed.
[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected)
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B)
[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B)Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) → [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=831055#c8)• 12 years ago |
|  | |

of course [bug 830676](/show_bug.cgi?id=830676 "RESOLVED FIXED - YarrJIT is broken on Win64 after landing bug 820124") claims it's fixing a regression in Firefox 21 so it's not clear how it fixed this older bug. Maybe there's a part of it to back-port?

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=831055#c9)• 12 years ago |
|  | |

Sean, does the patch in [bug 830676](/show_bug.cgi?id=830676 "RESOLVED FIXED - YarrJIT is broken on Win64 after landing bug 820124") need to be backported to Aurora?
I marked this bug as affecting 20 but [bug 830676](/show_bug.cgi?id=830676 "RESOLVED FIXED - YarrJIT is broken on Win64 after landing bug 820124") (which fixes this bug) is set as not affecting 20.Flags: needinfo?(sstangl)

|  | [Sean Stangl [:sstangl]](/user_profile?user_id=383201) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=831055#c10)• 12 years ago |
|  | |

(In reply to Gary Kwong [:gkw] (intermittent Feb 8 - Feb 19) from [comment #9](/show_bug.cgi?id=831055#c9 "RESOLVED FIXED - \"Assertion failure: [infer failure] Missing type in object [0x241d1f0] lastIndex: float,\""))
> Sean, does the patch in [bug 830676](/show_bug.cgi?id=830676 "RESOLVED FIXED - YarrJIT is broken on Win64 after landing bug 820124") need to be backported to Aurora?
>
> I marked this bug as affecting 20 but [bug 830676](/show_bug.cgi?id=830676 "RESOLVED FIXED - YarrJIT is broken on Win64 after landing bug 820124") (which fixes this bug) is
> set as not affecting 20.
Aurora is affected by [Bug 830676](/show_bug.cgi?id=830676 "RESOLVED FIXED - YarrJIT is broken on Win64 after landing bug 820124"). I'll set the bits.Flags: needinfo?(sstangl)

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=831055#c11)• 12 years ago |
|  | |

[Bug 830676](/show_bug.cgi?id=830676 "RESOLVED FIXED - YarrJIT is broken on Win64 after landing bug 820124") got uplifted and marked fixed on FF 20 - is there anything left here to do for FF 20?

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=831055#c12)• 12 years ago |
|  | |

(In reply to Lukas Blakk [:lsblakk] from [comment #11](/show_bug.cgi?id=831055#c11 "RESOLVED FIXED - \"Assertion failure: [infer failure] Missing type in object [0x241d1f0] lastIndex: float,\""))
> [Bug 830676](/show_bug.cgi?id=830676 "RESOLVED FIXED - YarrJIT is broken on Win64 after landing bug 820124") got uplifted and marked fixed on FF 20 - is there anything left
> here to do for FF 20?
Nope. I verified that it has been fixed for FF 20 (mozilla-beta now).
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=831055#a5949292_280903)• 12 years ago |

Whiteboard: [jsbugmon:] YARR bug on Win64 → [jsbugmon:][adv-main20+] YARR bug on Win64

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=831055#a27121356_1689)• 11 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=831055&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_ba2d7910_20250126_094836.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Sun Jan 26 2025 01:48:36 PST

* **Bug ID:**
  808736,
  830595,
  817841,
  824643,
  824856,
  831055,
  849014,
  827596,
  835499,
  837714,
  839209,
  842300,
  815315

---

13 bugs found.

| [ID](/buglist.cgi?bug_id=808736%2C830595%2C817841%2C824643%2C824856%2C831055%2C849014%2C827596%2C835499%2C837714%2C839209%2C842300%2C815315&query_format=advanced&order=bug_id%20DESC&query_based_on=) | [Type](/buglist.cgi?bug_id=808736%2C830595%2C817841%2C824643%2C824856%2C831055%2C849014%2C827596%2C835499%2C837714%2C839209%2C842300%2C815315&query_format=advanced&order=bug_type%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Summary](/buglist.cgi?bug_id=808736%2C830595%2C817841%2C824643%2C824856%2C831055%2C849014%2C827596%2C835499%2C837714%2C839209%2C842300%2C815315&query_format=advanced&order=short_desc%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Product](/buglist.cgi?bug_id=808736%2C830595%2C817841%2C824643%2C824856%2C831055%2C849014%2C827596%2C835499%2C837714%2C839209%2C842300%2C815315&query_format=advanced&order=product%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Comp](/buglist.cgi?bug_id=808736%2C830595%2C817841%2C824643%2C824856%2C831055%2C849014%2C827596%2C835499%2C837714%2C839209%2C842300%2C815315&query_format=advanced&order=component%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Assignee▲](/buglist.cgi?bug_id=808736%2C830595%2C817841%2C824643%2C824856%2C831055%2C849014%2C827596%2C835499%2C837714%2C839209%2C842300%2C815315&query_format=advanced&order=assigned_to%20DESC%2Cbug_status%2Cpriority%2Cbug_id&query_based_on=) | [Status▲](/buglist.cgi?bug_id=808736%2C830595%2C817841%2C824643%2C824856%2C831055%2C849014%2C827596%2C835499%2C837714%2C839209%2C842300%2C815315&query_format=advanced&order=bug_status%20DESC%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Resolution](/buglist.cgi?bug_id=808736%2C830595%2C817841%2C824643%2C824856%2C831055%2C849014%2C827596%2C835499%2C837714%2C839209%2C842300%2C815315&query_format=advanced&order=resolution%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Updated](/buglist.cgi?bug_id=808736%2C830595%2C817841%2C824643%2C824856%2C831055%2C849014%2C827596%2C835499%2C837714%2C839209%2C842300%2C815315&query_format=advanced&order=changeddate%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [827596](/show_bug.cgi?id=827596 "RESOLVED FIXED - Assigning the same pointer value to an nsAutoPtr shouldn't crash exploitably") |  | [Assigning the same pointer value to an nsAutoPtr shouldn't crash exploitably](/show_bug.cgi?id=827596) | Core | XPCOM | benjamin | RESO | FIXE | 2013-03-28 |
| [830595](/show_bug.cgi?id=830595 "RESOLVED FIXED - compartment mismatch in nsJSContext::ExecuteScript (with Babylon toolbar and Free Download Manager?)") |  | [compartment mismatch in nsJSContext::ExecuteScript (with Babylon toolbar and Free Download Manager?)](/show_bug.cgi?id=830595) | Core | DOM: Core & HTML | continuation | RESO | FIXE | 2019-09-06 |
| [831055](/show_bug.cgi?id=831055 "RESOLVED FIXED - \"Assertion failure: [infer failure] Missing type in object [0x241d1f0] lastIndex: float,\"") |  | ["Assertion failure: [infer failure] Missing type in object [0x241d1f0] lastIndex: float,"](/show_bug.cgi?id=831055) | Core | JavaScript Engine | general | RESO | FIXE | 2013-11-25 |
| [815315](/show_bug.cgi?id=815315 "RESOLVED FIXED - nsTableFrame doesn't deal with row-group continuations very well") |  | [nsTableFrame doesn't deal with row-group continuations very well](/show_bug.cgi?id=815315) | Core | Layout: Tables | MatsPalmgren\_bugz | RESO | FIXE | 2019-08-20 |
| [824643](/show_bug.cgi?id=824643 "RESOLVED FIXED - heap-use-after-free in nsTreeBodyFrame::UpdateScrollbars") |  | [heap-use-after-free in nsTreeBodyFrame::UpdateScrollbars](/show_bug.cgi?id=824643) | Core | XUL | MatsPalmgren\_bugz | RESO | FIXE | 2017-05-09 |
| [808736](/show_bug.cgi?id=808736 "RESOLVED WORKSFORME - sJSGCThingRootCount maybe can in theory be abused to trigger nsLayoutStatics::Shutdown()") |  | [sJSGCThingRootCount maybe can in theory be abused to trigger nsLayoutStatics::Shutdown()](/show_bug.cgi?id=808736) | Core | DOM: Core & HTML | nobody | RESO | WORK | 2019-03-13 |
| [817841](/show_bug.cgi?id=817841 "RESOLVED FIXED - Race condition deleting nsDOMMediaStream via proxying to MainThread") |  | [Race condition deleting nsDOMMediaStream via proxying to MainThread](/show_bug.cgi?id=817841) | Core | WebRTC: Audio/Video | rjesup | RESO | FIXE | 2014-11-19 |
| [824856](/show_bug.cgi?id=824856 "VERIFIED FIXED - Crash [@ QuoteString] or [@ js_NewStringCopyN] or \"Assertion failure: limit >= start,\"") |  | [Crash [@ QuoteString] or [@ js\_NewStringCopyN] or "Assertion failure: limit >= start,"](/show_bug.cgi?id=824856) | Core | JavaScript Engine | dvander | VERI | FIXE | 2013-11-25 |
| [837714](/show_bug.cgi?id=837714 "VERIFIED FIXED - Assertion failure: allocated(), at ../../gc/Heap.h:472 or Opt-Crash [@ js::GCMarker::drainMarkStack]") |  | [Assertion failure: allocated(), at ../../gc/Heap.h:472 or Opt-Crash [@ js::GCMarker::drainMarkStack]](/show_bug.cgi?id=837714) | Core | JavaScript Engine | dvander | VERI | FIXE | 2013-11-25 |
| [842300](/show_bug.cgi?id=842300 "VERIFIED FIXED - IonMonkey: Crash [@ js::GetObjectClass] with invalid read") |  | [IonMonkey: Crash [@ js::GetObjectClass] with invalid read](/show_bug.cgi?id=842300) | Core | JavaScript Engine | dvander | VERI | FIXE | 2013-11-25 |
| [835499](/show_bug.cgi?id=835499 "VERIFIED FIXED - Crash [@ js::ion::IonFrameIterator::ionScript] or [@ js::ion::GetPcScript] or Assertion failure: type() == IonFrame_OptimizedJS, at ion/IonFrames.cpp:855") |  | [Crash [@ js::ion::IonFrameIterator::ionScript] or [@ js::ion::GetPcScript] or Assertion failure: type() == IonFrame\_OptimizedJS, at ion/IonFrames.cpp:855](/show_bug.cgi?id=835499) | Core | JavaScript Engine | nicolas.b.pierron | VERI | FIXE | 2013-11-25 |
| [849014](/show_bug.cgi?id=849014 "VERIFIED FIXED - IonMonkey: Crash [@ js::RegExpGuard::operator*] or \"Assertion failure: isRegExp(),\"") |  | [IonMonkey: Crash [@ js::RegExpGuard::operator\*] or "Assertion failure: isRegExp(),"](/show_bug.cgi?id=849014) | Core | JavaScript Engine | nicolas.b.pierron | VERI | FIXE | 2013-11-25 |
| [839209](/show_bug.cgi?id=839209 "VERIFIED FIXED - Assertion failure: kind == GetGCThingTraceKind(*thingp), at gc/Marking.cpp:353") |  | [Assertion failure: kind == GetGCThingTraceKind(\*thingp), at gc/Marking.cpp:353](/show_bug.cgi?id=839209) | Core | JavaScript Engine | nihsanullah | VERI | FIXE | 2013-11-25 |

13 bugs found.

|  |  | [REST](/rest/bug?include_fields=id,summary,status&bug_id=808736%2C830595%2C817841%2C824643%2C824856%2C831055%2C849014%2C827596%2C835499%2C837714%2C839209%2C842300%2C815315 "Query as a REST API request") | [CSV](/buglist.cgi?bug_id=808736%2C830595%2C817841%2C824643%2C824856%2C831055%2C849014%2C827596%2C835499%2C837714%2C839209%2C842300%2C815315&query_format=advanced&ctype=csv&human=1) | [Feed](/buglist.cgi?bug_id=808736%2C830595%2C817841%2C824643%2C824856%2C831055%2C849014%2C827596%2C835499%2C837714%2C839209%2C842300%2C815315&query_format=advanced&title=Bug%20List&ctype=atom) | [iCalendar](/buglist.cgi?bug_id=808736%2C830595%2C817841%2C824643%2C824856%2C831055%2C849014%2C827596%2C835499%2C837714%2C839209%2C842300%2C815315&query_format=advanced&ctype=ics)  [Change Columns](/colchange.cgi?bug_id=808736%2C830595%2C817841%2C824643%2C824856%2C831055%2C849014%2C827596%2C835499%2C837714%2C839209%2C842300%2C815315&query_format=advanced&query_based_on=) | [Edit Search](/query.cgi?bug_id=808736%2C830595%2C817841%2C824643%2C824856%2C831055%2C849014%2C827596%2C835499%2C837714%2C839209%2C842300%2C815315&query_format=advanced) |  | as |
| --- | --- | --- | --- | --- | --- |

[File
a new bug
in the "Core" product](/enter_bug.cgi?product=Core)



=== Content from bugzilla.mozilla.org_976d16d7_20250125_151429.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/830595)
* [XML](/show_bug.cgi?ctype=xml&id=830595)

Closed
[Bug 830595](/show_bug.cgi?id=830595)

Opened 12 years ago
Closed 12 years ago

# compartment mismatch in nsJSContext::ExecuteScript (with Babylon toolbar and Free Download Manager?)

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

compartment mismatch in nsJSContext::ExecuteScript (with Babylon toolbar and Free Download Manager?)

## Categories

### (Core :: DOM: Core & HTML, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML#DOM%3A%20Core%20%26%20HTML)

DOM: Core & HTML
▾

Core :: DOM: Core & HTML
Issues in DOM tree [https://dom.spec.whatwg.org](https://dom.spec.whatwg.org/) & HTML [https://html.spec.whatwg.org](https://html.spec.whatwg.org/) that do not fit into any other DOM or HTML component or which span multiple DOM or HTML components.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla21

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox18 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=wontfix) |
| firefox19 | [-](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix) |
| firefox20 | [-](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=-) | [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed) |
| firefox21 | [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed) |
| firefox-esr10 | --- | [wontfix](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=wontfix) |
| firefox-esr17 | [-](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=wontfix) |
| b2g18 | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=wontfix) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox18 |  | wontfix |
| firefox19 | - | wontfix |
| firefox20 | - | fixed |
| firefox21 | + | fixed |
| firefox-esr10 |  | wontfix |
| firefox-esr17 | - | wontfix |
| b2g18 |  | wontfix |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: mccr8, Assigned: mccr8)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=40)  [mccr8](/user_profile?user_id=406194)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=40)  [mccr8](/user_profile?user_id=406194)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/5111b810214a00377104f5ad3efefa26?d=mm&size=40)  [sefeng](/user_profile?user_id=625922)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[compartment-mismatch](/show_bug.cgi?id=821733 "RESOLVED WORKSFORME - [meta] crash in js::CompartmentChecker::fail")

Dependency [tree](/showdependencytree.cgi?id=830595&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=830595)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: crash, csectype-dos, sec-low, Whiteboard: [adv-main20+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-dos](/buglist.cgi?keywords=csectype-dos&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main20+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ JS\_ExecuteScript(JSContext\*, JSObject\*, JSScript\*, JS::Value\*) ]](https://crash-stats.mozilla.org/signature/?signature=JS_ExecuteScript%28JSContext%2A%2C%20JSObject%2A%2C%20JSScript%2A%2C%20JS%3A%3AValue%2A%29)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [enter the compartment](/attachment.cgi?id=702957)  [12 years ago](#c1)  [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)   1.11 KB, patch | bzbarsky : [review+](#c14 "12 years ago")  lsblakk : [approval-mozilla-aurora+](#c22 "12 years ago")  lsblakk : [approval-mozilla-beta-](#c22 "12 years ago")  abillings : [sec-approval+](#c16 "12 years ago") | [Details](/attachment.cgi?id=702957&action=edit) | [Diff](/attachment.cgi?id=702957&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=830595&attachment=702957) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=830595#c0)• 12 years ago |
|  | |

This function does an autorequest, but does not enter the compartment it is about to start executing in. bholley suggested the fix is to just enter the compartment there.
This seems to cause badness when nsXULDocument::OnStreamComplete calls into nsXULDocument::ExecuteScript:
<https://crash-stats.mozilla.com/report/index/54ae0c21-948c-4cb9-8e9b-b1b692130106>
<https://crash-stats.mozilla.com/report/index/88677c28-4597-4d7d-9b16-50b502130112>
This is similar, though the stack looks junky:
<https://crash-stats.mozilla.com/report/index/34337f2a-e82d-4c86-8a40-61ea72130113>

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=830595#a146850_406194)• 12 years ago |

Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=830595#c1)• 12 years ago |
|  | |

Attached patch

[enter the compartment](attachment.cgi?id=702957&action=diff)
— [Details](attachment.cgi?id=702957&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=830595&attachment=702957)

I'm not sure how to make a test case for this. I guess I'll investigate the stream listener stuff.Assignee: nobody → continuation

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=830595#c2)• 12 years ago |
|  | |

All 3 of these crashes have Babylon Toolbar and Free Download Manager.Summary: compartment mismatch in nsJSContext::ExecuteScript → compartment mismatch in nsJSContext::ExecuteScript (with Babylon toolbar and Free Download Manager?)

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=830595#c3)• 12 years ago |
|  | |

<https://www.youtube.com/watch?v=s-t9Drkd1CE>

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=830595#c4)• 12 years ago |
|  | |

Try run looked okay: <https://tbpl.mozilla.org/?tree=Try&rev=4411b77b1b4d>
More stacks, now that the compartment checker has propagated to Aurora:
<https://crash-stats.mozilla.com/report/index/9380ab36-54ed-4162-8e59-22d9e2130116>
<https://crash-stats.mozilla.com/report/index/629ef0c2-0b43-4302-a0cb-39b972130116>
<https://crash-stats.mozilla.com/report/index/cb7aa21e-fb6c-4108-a729-80eac2130115>
<https://crash-stats.mozilla.com/report/index/90d338dc-f33e-4e53-aceb-26be22130112>
<https://crash-stats.mozilla.com/report/index/d9fdfa7e-b7e3-47c9-b6a7-35e1b2130112>
These look similar. All but 1 have Babylon and FDM.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=830595#c5)• 12 years ago |
|  | |

Comment on [attachment 702957](/attachment.cgi?id=702957 "enter the compartment") [[details]](/attachment.cgi?id=702957&action=edit "enter the compartment") [[diff]](/attachment.cgi?id=702957&action=diff "enter the compartment") [[review]](/page.cgi?id=splinter.html&ignore=&bug=830595&attachment=702957)
enter the compartment
Suggestions on how to test this would be appreciated. The trick of using Xrays doesn't seem to help on this one.
[Attachment #702957](/attachment.cgi?id=702957&action=edit "enter the compartment") -
Flags: review?(bzbarsky)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=830595#c6)• 12 years ago |
|  | |

Are we guaranteed that aScopeObject and aScriptObject are in the same compartment?

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=830595#c7)• 12 years ago |
|  | |

For the rest, all you need is for aContext to not match the compartment of mScriptGlobalObject. For example, having a JS-implemented protocol handler (which is what seems to be going on here) that's running on the cx but is in some random compartment, would do it...

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=830595#c8)• 12 years ago |
|  | |

Comment on [attachment 702957](/attachment.cgi?id=702957 "enter the compartment") [[details]](/attachment.cgi?id=702957&action=edit "enter the compartment") [[diff]](/attachment.cgi?id=702957&action=diff "enter the compartment") [[review]](/page.cgi?id=splinter.html&ignore=&bug=830595&attachment=702957)
enter the compartment
> Are we guaranteed that aScopeObject and aScriptObject are in the same compartment?
Oh, good point! No, we aren't. For instance, if you pass in NULL aScopeObject, aScopeObject ends up being the global of mContext, so we're not getting anything out of it. I think I recall some other execute script thing checking if various compartments are equal or not, and doing different things based on that, so I'll try figuring out what we should do here, and try to throw together a test case. Thanks.
[Attachment #702957](/attachment.cgi?id=702957&action=edit "enter the compartment") -
Flags: review?(bzbarsky)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=830595#c9)• 12 years ago |
|  | |

Okay, so now I remember where I saw that script compartment checking thing: JS\_ExecuteScript (which nsJSContext::ExecuteScript calls) actually checks to see if the script isn't in the same compartment as the scope, and if it does, it clones the script into the scope compartment. So it should be okay to completely not worry about the compartment of aScriptObject here.
I've been digging into Free Download Manager, and it looks like its onStopRequest includes a call into a DLL, which I could imagine being problematic.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=830595#c10)• 12 years ago |
|  | |

Hilariously I just noticed that this isn't technically a security problem, because in [bug 746036](/show_bug.cgi?id=746036 "RESOLVED FIXED - crash in js::GetNameFromBytecode or js::ContextStack::currentScriptWithDiagnostics mainly with Trusteer Rapport & Yahoo Toolbar or Browser For Change") dmandelin added a dynamic check that crashes when it detects precisely this compartment mismatch:
assertSameCompartment(cx, obj);
if (cx->compartment != obj->compartment())
\*(volatile int \*) 0 = 0xf0;
These show up as the signature JS\_ExecuteScript: [https://crash-stats.mozilla.com/report/list?range\_value=7&range\_unit=days&date=2013-01-17&signature=JS\_ExecuteScript%28JSContext\*%2C%20JSObject\*%2C%20JSScript\*%2C%20JS%3A%3AValue\*%29&version=Firefox%3A19.0b1](https://crash-stats.mozilla.com/report/list?range_value=7&range_unit=days&date=2013-01-17&signature=JS_ExecuteScript%28JSContext*%2C%20JSObject*%2C%20JSScript*%2C%20JS%3A%3AValue*%29&version=Firefox%3A19.0b1)
This is currently the #45 top crasher on Fx19, so it would be good to fix anyways.
I'll leave this closed for now until more of its sibling bugs are fixed.Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---) → [csec-dos](/buglist.cgi?keywords=csec-dos&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=830595#c11)• 12 years ago |
|  | |

Comment on [attachment 702957](/attachment.cgi?id=702957 "enter the compartment") [[details]](/attachment.cgi?id=702957&action=edit "enter the compartment") [[diff]](/attachment.cgi?id=702957&action=diff "enter the compartment") [[review]](/page.cgi?id=splinter.html&ignore=&bug=830595&attachment=702957)
enter the compartment
Re-requesting review in light of [comment 9](/show_bug.cgi?id=830595#c9 "RESOLVED FIXED - compartment mismatch in nsJSContext::ExecuteScript (with Babylon toolbar and Free Download Manager?)").
[Attachment #702957](/attachment.cgi?id=702957&action=edit "enter the compartment") -
Flags: review?(bzbarsky)

|  | [Robert Kaiser](/user_profile?user_id=5189) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=830595#c12)• 12 years ago |
|  | |

mccr8, should we add that signature to this bug then (and add the crash keyword), so it gets linked with this?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=830595#c13)• 12 years ago |
|  | |

Sure.Crash Signature: [@ JS\_ExecuteScript(JSContext\*, JSObject\*, JSScript\*, JS::Value\*)]Keywords: [crash](/buglist.cgi?keywords=crash&resolution=---)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=830595#c14)• 12 years ago |
|  | |

Comment on [attachment 702957](/attachment.cgi?id=702957 "enter the compartment") [[details]](/attachment.cgi?id=702957&action=edit "enter the compartment") [[diff]](/attachment.cgi?id=702957&action=diff "enter the compartment") [[review]](/page.cgi?id=splinter.html&ignore=&bug=830595&attachment=702957)
enter the compartment
r=me
[Attachment #702957](/attachment.cgi?id=702957&action=edit "enter the compartment") -
Flags: review?(bzbarsky) → review+

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=830595#c15)• 12 years ago |
|  | |

Comment on [attachment 702957](/attachment.cgi?id=702957 "enter the compartment") [[details]](/attachment.cgi?id=702957&action=edit "enter the compartment") [[diff]](/attachment.cgi?id=702957&action=diff "enter the compartment") [[review]](/page.cgi?id=splinter.html&ignore=&bug=830595&attachment=702957)
enter the compartment
[Security approval request comment]
How easily could an exploit be constructed based on the patch? Probably not that easily, plus it seems to require certain addons.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem? no.
Which older supported branches are affected by this flaw? Probably all of them.
If not all supported branches, which bug introduced the flaw?
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be? Should be easy.
How likely is this patch to cause regressions; how much testing does it need? Doesn't seem that dangerous.
[Attachment #702957](/attachment.cgi?id=702957&action=edit "enter the compartment") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=830595#a668753_280903)• 12 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=affected)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected)
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected)
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%3F)
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%3F)
[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B)
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=%3F)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=830595#c16)• 12 years ago |
|  | |

Comment on [attachment 702957](/attachment.cgi?id=702957 "enter the compartment") [[details]](/attachment.cgi?id=702957&action=edit "enter the compartment") [[diff]](/attachment.cgi?id=702957&action=diff "enter the compartment") [[review]](/page.cgi?id=splinter.html&ignore=&bug=830595&attachment=702957)
enter the compartment
sec-approving this. Since it is sec-low, we may not take it elsewhere.
[Attachment #702957](/attachment.cgi?id=702957&action=edit "enter the compartment") -
Flags: sec-approval? → sec-approval+

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=830595#c17)• 12 years ago |
|  | |

You are right, this is only worth backporting as a crash fix. (#45 on 19 when I looked before.)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=830595#c18)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/fa7dc7b5ca52>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=830595#c19)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/fa7dc7b5ca52>Status: NEW → RESOLVEDClosed: 12 years ago
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla21

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=830595#c20)• 12 years ago |
|  | |

Comment on [attachment 702957](/attachment.cgi?id=702957 "enter the compartment") [[details]](/attachment.cgi?id=702957&action=edit "enter the compartment") [[diff]](/attachment.cgi?id=702957&action=diff "enter the compartment") [[review]](/page.cgi?id=splinter.html&ignore=&bug=830595&attachment=702957)
enter the compartment
[Approval Request Comment]
Bug caused by (feature/regressing bug #): old
User impact if declined: non-security-sensitive crashes (#77 crash on 18, #27 on 19) with various addons.
Testing completed (on m-c, etc.): m-c
Risk to taking this patch (and alternatives if risky): low
String or UUID changes made by this patch: none
We've lived with this for a few release cycles, so not getting it in more places isn't the end of the world, but it would be nice to get it out faster. I could easily land it on esr17 and b2g18, but it doesn't show up in the top crashes list for esr17, and it seems addon related, so it probably doesn't matter either way for b2g18.
[Attachment #702957](/attachment.cgi?id=702957&action=edit "enter the compartment") -
Flags: approval-mozilla-beta?
[Attachment #702957](/attachment.cgi?id=702957&action=edit "enter the compartment") -
Flags: approval-mozilla-aurora?

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=830595#c21)• 12 years ago |
|  | |

We can take this on aurora since it's low risk, not tracking though as it's a sec-low we aren't very concerned about and it doesn't meet ESR criteria.
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=wontfix)
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=-)
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=-)
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=-)

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=830595#c22)• 12 years ago |
|  | |

Comment on [attachment 702957](/attachment.cgi?id=702957 "enter the compartment") [[details]](/attachment.cgi?id=702957&action=edit "enter the compartment") [[diff]](/attachment.cgi?id=702957&action=diff "enter the compartment") [[review]](/page.cgi?id=splinter.html&ignore=&bug=830595&attachment=702957)
enter the compartment
Please go ahead with aurora uplift.
[Attachment #702957](/attachment.cgi?id=702957&action=edit "enter the compartment") -
Flags: approval-mozilla-beta?
[Attachment #702957](/attachment.cgi?id=702957&action=edit "enter the compartment") -
Flags: approval-mozilla-beta-
[Attachment #702957](/attachment.cgi?id=702957&action=edit "enter the compartment") -
Flags: approval-mozilla-aurora?
[Attachment #702957](/attachment.cgi?id=702957&action=edit "enter the compartment") -
Flags: approval-mozilla-aurora+

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=830595#c23)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/5b565584a2fd>
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=830595#a861130_1689)• 12 years ago |

[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=wontfix)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=wontfix)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=830595#a6028929_280903)• 12 years ago |

Whiteboard: [adv-main20+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=830595#a58240855_1689)• 10 years ago |

Group: core-security

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=830595#a194270739_1)• 6 years ago |

Component: DOM → DOM: Core & HTML

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=830595#a209587577_75935)• 5 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=wontfix)
You need to [log in](/show_bug.cgi?id=830595&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_469e9e1c_20250125_151439.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/849014)
* [XML](/show_bug.cgi?ctype=xml&id=849014)

Closed
[Bug 849014](/show_bug.cgi?id=849014)

Opened 12 years ago
Closed 12 years ago

# IonMonkey: Crash [@ js::RegExpGuard::operator\*] or "Assertion failure: isRegExp(),"

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

IonMonkey: Crash [@ js::RegExpGuard::operator\*] or "Assertion failure: isRegExp(),"

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox20 | [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed) |
| firefox21 | [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed) |
| firefox22 | [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=fixed) |
| firefox-esr17 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected) |
| b2g18 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox20 | + | fixed |
| firefox21 | + | fixed |
| firefox22 | + | fixed |
| firefox-esr17 |  | unaffected |
| b2g18 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: gkw, Assigned: nbp)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/f78625fe5901300b4689355a8e507ea2?d=mm&size=40)  [nbp](/user_profile?user_id=422187)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/55857f92ded07119259dc6c1dd386205?d=mm&size=40)  [general](/user_profile?user_id=4729)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [gkw](/user_profile?user_id=132034)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

17 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[832360](/show_bug.cgi?id=832360 "RESOLVED FIXED - Make an object's type determine its class")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[IonFuzz](/show_bug.cgi?id=724444 "RESOLVED FIXED - [meta] IonMonkey fuzz bugs"), [792220](/show_bug.cgi?id=792220 "VERIFIED FIXED - IonMonkey: Assertion failure: !cx->compartment->activeAnalysis, at jsinterp.cpp:337 or Crash [@ js::types::CompilerOutput::isValid]")

Dependency [tree](/showdependencytree.cgi?id=849014&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=849014)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (5 keywords, Whiteboard: [jsbugmon:update][adv-main20+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[crash](/buglist.cgi?keywords=crash&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[jsbugmon:update][adv-main20+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ js::RegExpGuard::operator\* ]](https://crash-stats.mozilla.org/signature/?signature=js%3A%3ARegExpGuard%3A%3Aoperator%2A)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 2 obsolete files)

| [stack](/attachment.cgi?id=722504)  [12 years ago](#c0)  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)   18.89 KB, text/plain |  | [Details](/attachment.cgi?id=722504&action=edit) |
| --- | --- | --- |
| [Check type inference before optimizing regexp calls.](/attachment.cgi?id=724225)  [12 years ago](#c3)  [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)   1.25 KB, patch | sstangl : [review+](#c4 "12 years ago")  lsblakk : [approval-mozilla-aurora+](#a1014491_272375 "12 years ago")  abillings : [sec-approval+](#a519864_280903 "12 years ago") | [Details](/attachment.cgi?id=724225&action=edit) | [Diff](/attachment.cgi?id=724225&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=724225) |
| [[aurora / beta] Same patch.](/attachment.cgi?id=725082)  [12 years ago](#c11)  [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)   1.15 KB, patch |  | [Details](/attachment.cgi?id=725082&action=edit) | [Diff](/attachment.cgi?id=725082&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=725082) |
| [[aurora/beta] Check regexp object before evaluating regexp.](/attachment.cgi?id=725144)  [12 years ago](#c18)  [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)   3.25 KB, patch | sstangl : [review+](#c20 "12 years ago")  gkw : [feedback-](#c27 "12 years ago")  gkw : [feedback-](#c27 "12 years ago")  lsblakk : [approval-mozilla-beta-](#c35 "12 years ago") | [Details](/attachment.cgi?id=725144&action=edit) | [Diff](/attachment.cgi?id=725144&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=725144) |
| [[beta] Check regexp object before evaluating regexp.](/attachment.cgi?id=726355)  [12 years ago](#c30)  [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)   1.69 KB, patch | nbp : [review+](#c30 "12 years ago")  decoder : [feedback+](#c40 "12 years ago")  gkw : [feedback+](#c37 "12 years ago")  lsblakk : [approval-mozilla-beta+](#c34 "12 years ago") | [Details](/attachment.cgi?id=726355&action=edit) | [Diff](/attachment.cgi?id=726355&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=726355) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=849014#c0)• 12 years ago |
|  | |

Attached file
[stack](attachment.cgi?id=722504)
— [Details](attachment.cgi?id=722504&action=edit)

Map.prototype.has = /x/.test
x = [false]
y = Map()
Array.prototype.forEach.call(x, (function() {
y.has('')
}))
asserts js debug shell on m-c changeset 71395a927025 with --ion-eager at Assertion failure: isRegExp(), and crashes js opt shell at a weird memory address with js::RegExpGuard::operator\* on the stack. Another weird memory address 0x00000001006942bb is also on the stack.
Locking s-s pending further security analysis, assuming sec-critical since a weird memory address is on the stack.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=849014#c1)• 12 years ago |
|  | |

autoBisect shows this is probably related to the following changeset:
The first bad revision is:
changeset: 109162:d41ca12d2527
user: Nicolas B. Pierron
date: Wed Oct 03 15:13:40 2012 -0700
summary: [Bug 792220](/show_bug.cgi?id=792220 "VERIFIED FIXED - IonMonkey: Assertion failure: !cx->compartment->activeAnalysis, at jsinterp.cpp:337 or Crash [@ js::types::CompilerOutput::isValid]") - Remove lookupProperty to prevent interpreter reentrance. r=jandemBlocks: [792220](/show_bug.cgi?id=792220 "VERIFIED FIXED - IonMonkey: Assertion failure: !cx->compartment->activeAnalysis, at jsinterp.cpp:337 or Crash [@ js::types::CompilerOutput::isValid]")

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=849014#c2)• 12 years ago |
|  | |

nbp, is [bug 792220](/show_bug.cgi?id=792220 "VERIFIED FIXED - IonMonkey: Assertion failure: !cx->compartment->activeAnalysis, at jsinterp.cpp:337 or Crash [@ js::types::CompilerOutput::isValid]") a possible regressor?Flags: needinfo?(nicolas.b.pierron)

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=849014#c3)• 12 years ago |
|  | |

Attached patch

[Check type inference before optimizing regexp calls.](attachment.cgi?id=724225&action=diff)
— [Details](attachment.cgi?id=724225&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=724225)

js::regexp\_test\_raw assume that the object given as argument is a RegExp object, as the assertion hit in debug mode illustrate. This function is only used by IonMonkey which inline calls to regexp\_test & regexp\_exec.
The only detail is that this optimization did not check for the class attach with the known object. This patch check if there is a common class to all objects listed in the Type Object and ensure that all are RegExp objects before optimizing the call site.
This means that call-site with a different kind of object will not inline the regexp\_test function call, and it will fallback on a fallible JS native call which will throw an exception when it got executed.Assignee: general → nicolas.b.pierronStatus: NEW → ASSIGNED
[Attachment #724225](/attachment.cgi?id=724225&action=edit "Check type inference before optimizing regexp calls.") -
Flags: review?(sstangl)Flags: needinfo?(nicolas.b.pierron)

|  | [Sean Stangl [:sstangl]](/user_profile?user_id=383201) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=849014#c4)• 12 years ago |
|  | |

Comment on [attachment 724225](/attachment.cgi?id=724225 "Check type inference before optimizing regexp calls.") [[details]](/attachment.cgi?id=724225&action=edit "Check type inference before optimizing regexp calls.") [[diff]](/attachment.cgi?id=724225&action=diff "Check type inference before optimizing regexp calls.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=724225)
Check type inference before optimizing regexp calls.
Review of [attachment 724225](/attachment.cgi?id=724225 "Check type inference before optimizing regexp calls.") [[details]](/attachment.cgi?id=724225&action=edit "Check type inference before optimizing regexp calls.") [[diff]](/attachment.cgi?id=724225&action=diff "Check type inference before optimizing regexp calls.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=724225):
-----------------------------------------------------------------
Great! Thank you for fixing this.
[Attachment #724225](/attachment.cgi?id=724225&action=edit "Check type inference before optimizing regexp calls.") -
Flags: review?(sstangl) → review+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=849014#c5)• 12 years ago |
|  | |

This needs a security rating and sec-approval on the patch before any checkin here.
Gary, when you pin down a regression to a specific timeframe, please mark the status flags for affected versions if you can.
[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected)
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected)
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected)

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=849014#c6)• 12 years ago |
|  | |

The regressing bug did not land on 17. Guessing at wontfix for 19.
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected)

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=849014#c7)• 12 years ago |
|  | |

Set as sec-critical as any private data of an object can be interpreted as a RegExp object, and decision such as compiling can be taken based on injected data. So I think there is a \*complex\* vector of attack hidden behind the lack of this check.Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=849014#c8)• 12 years ago |
|  | |

Comment on [attachment 724225](/attachment.cgi?id=724225 "Check type inference before optimizing regexp calls.") [[details]](/attachment.cgi?id=724225&action=edit "Check type inference before optimizing regexp calls.") [[diff]](/attachment.cgi?id=724225&action=diff "Check type inference before optimizing regexp calls.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=724225)
Check type inference before optimizing regexp calls.
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
- Find that this is only related to a few functions calls from Ion.
- Look what happen when something is not a regexp flow into these functions. [make it crash]
- Find which fields are set by other structure which might be read as a RegExp and change the behaviour in an unexpected way.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
- Just the code by it-self.
Which older supported branches are affected by this flaw?
- All branches with IonMonkey enabled.
If not all supported branches, which bug introduced the flaw?
- Landing IonMonkey, on Sep 12.
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
- Not yet, should be easy to make if there is any issue.
How likely is this patch to cause regressions; how much testing does it need?
- The patch is unlikely to cause any regressions as it add another condition to enable the optimization, and the default will fallback to a slower call mechanism which is already well tested.
- The patch use the type info which is already known and used, and it add a check for the known class of a StackTypeSet and handle all its possible outputs correctly.
[Attachment #724225](/attachment.cgi?id=724225&action=edit "Check type inference before optimizing regexp calls.") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=849014#a519864_280903)• 12 years ago |

[Attachment #724225](/attachment.cgi?id=724225&action=edit "Check type inference before optimizing regexp calls.") -
Flags: sec-approval? → sec-approval+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=849014#c9)• 12 years ago |
|  | |

Please create branch patches and nominate them since this is a sec-critical issue.
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%3F)
[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%3F)
[tracking-firefox22](/buglist.cgi?f1=cf_tracking_firefox22&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B)

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=849014#c10)• 12 years ago |
|  | |

Critsmash requests a landing for this since sec-approval+ has been given, thanks.Flags: needinfo?(nicolas.b.pierron)

|  | [bhavana bajaj [:bajaj]](/user_profile?user_id=448925) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=849014#a595622_448925)• 12 years ago |

[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B)

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=849014#c11)• 12 years ago |
|  | |

Attached patch

[[aurora / beta] Same patch.](attachment.cgi?id=725082&action=diff) (obsolete)
— [Details](attachment.cgi?id=725082&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=725082)

Same patch as [attachment 724225](/attachment.cgi?id=724225 "Check type inference before optimizing regexp calls.") [[details]](/attachment.cgi?id=724225&action=edit "Check type inference before optimizing regexp calls.") [[diff]](/attachment.cgi?id=724225&action=diff "Check type inference before optimizing regexp calls.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=724225), backported to aurora and beta branches.
[Approval Request Comment]
Bug caused by (feature/regressing bug #): Landing IonMonkey (Sep 12, fx 18)
User impact if declined: crash, potential injection of bad values into the regexp execution / compiler ?!
Testing completed (on m-c, etc.): Not yet.
Risk to taking this patch (and alternatives if risky): extremely low (see [comment 8](/show_bug.cgi?id=849014#c8 "VERIFIED FIXED - IonMonkey: Crash [@ js::RegExpGuard::operator*] or \"Assertion failure: isRegExp(),\""))
String or UUID changes made by this patch: N/A
[Attachment #725082](/attachment.cgi?id=725082&action=edit "[aurora / beta] Same patch.") -
Flags: approval-mozilla-beta?
[Attachment #725082](/attachment.cgi?id=725082&action=edit "[aurora / beta] Same patch.") -
Flags: approval-mozilla-aurora?Flags: needinfo?(nicolas.b.pierron)

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=849014#c12)• 12 years ago |
|  | |

(In reply to Gary Kwong [:gkw] [:nth10sd] from [comment #10](/show_bug.cgi?id=849014#c10 "VERIFIED FIXED - IonMonkey: Crash [@ js::RegExpGuard::operator*] or \"Assertion failure: isRegExp(),\""))
> Critsmash requests a landing for this since sec-approval+ has been given,
> thanks.
Tell me when this is best to land knowing the security issue involved in this Bug.
As 19 is not considered, I think it is best to wait until the next train shift.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=849014#c13)• 12 years ago |
|  | |

(In reply to Nicolas B. Pierron [:nbp] from [comment #12](/show_bug.cgi?id=849014#c12 "VERIFIED FIXED - IonMonkey: Crash [@ js::RegExpGuard::operator*] or \"Assertion failure: isRegExp(),\""))
> (In reply to Gary Kwong [:gkw] [:nth10sd] from [comment #10](/show_bug.cgi?id=849014#c10 "VERIFIED FIXED - IonMonkey: Crash [@ js::RegExpGuard::operator*] or \"Assertion failure: isRegExp(),\""))
> > Critsmash requests a landing for this since sec-approval+ has been given,
> > thanks.
>
> Tell me when this is best to land knowing the security issue involved in
> this Bug.
> As 19 is not considered, I think it is best to wait until the next train
> shift.
We should have green on inbound, then on central, then at least a day later will the approvals for branches usually be granted.

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=849014#c14)• 12 years ago |
|  | |

Comment on [attachment 725082](/attachment.cgi?id=725082 "[aurora / beta] Same patch.") [[details]](/attachment.cgi?id=725082&action=edit "[aurora / beta] Same patch.") [[diff]](/attachment.cgi?id=725082&action=diff "[aurora / beta] Same patch.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=725082)
[aurora / beta] Same patch.
This patch does not compile because getKnownClass does not exists. If think we can inline it if needed, unless I can find a substitute for it.
[Attachment #725082](/attachment.cgi?id=725082&action=edit "[aurora / beta] Same patch.") -
Attachment is obsolete: true
[Attachment #725082](/attachment.cgi?id=725082&action=edit "[aurora / beta] Same patch.") -
Flags: approval-mozilla-beta?
[Attachment #725082](/attachment.cgi?id=725082&action=edit "[aurora / beta] Same patch.") -
Flags: approval-mozilla-aurora?

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=849014#c15)• 12 years ago |
|  | |

getKnownClass has been added as part of [Bug 832360](/show_bug.cgi?id=832360 "RESOLVED FIXED - Make an object's type determine its class"), I am looking for a substitute for it.Depends on: [832360](/show_bug.cgi?id=832360 "RESOLVED FIXED - Make an object's type determine its class")

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=849014#c16)• 12 years ago |
|  | |

(In reply to Nicolas B. Pierron [:nbp] from [comment #12](/show_bug.cgi?id=849014#c12 "VERIFIED FIXED - IonMonkey: Crash [@ js::RegExpGuard::operator*] or \"Assertion failure: isRegExp(),\""))
> (In reply to Gary Kwong [:gkw] [:nth10sd] from [comment #10](/show_bug.cgi?id=849014#c10 "VERIFIED FIXED - IonMonkey: Crash [@ js::RegExpGuard::operator*] or \"Assertion failure: isRegExp(),\""))
> > Critsmash requests a landing for this since sec-approval+ has been given,
> > thanks.
>
> Tell me when this is best to land knowing the security issue involved in
> this Bug.
> As 19 is not considered, I think it is best to wait until the next train
> shift.
Once sec-approval+ is given, that is the sign that it is time to land on trunk unless some caveats are given (such as "Don't check this in until date X"). That's why we have sec-approval in the first place.

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=849014#c17)• 12 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #16](/show_bug.cgi?id=849014#c16 "VERIFIED FIXED - IonMonkey: Crash [@ js::RegExpGuard::operator*] or \"Assertion failure: isRegExp(),\""))
> (In reply to Nicolas B. Pierron [:nbp] from [comment #12](/show_bug.cgi?id=849014#c12 "VERIFIED FIXED - IonMonkey: Crash [@ js::RegExpGuard::operator*] or \"Assertion failure: isRegExp(),\""))
> > (In reply to Gary Kwong [:gkw] [:nth10sd] from [comment #10](/show_bug.cgi?id=849014#c10 "VERIFIED FIXED - IonMonkey: Crash [@ js::RegExpGuard::operator*] or \"Assertion failure: isRegExp(),\""))
> > > Critsmash requests a landing for this since sec-approval+ has been given,
> > > thanks.
> >
> > Tell me when this is best to land knowing the security issue involved in
> > this Bug.
> > As 19 is not considered, I think it is best to wait until the next train
> > shift.
>
> Once sec-approval+ is given, that is the sign that it is time to land on
> trunk unless some caveats are given (such as "Don't check this in until date
> X"). That's why we have sec-approval in the first place.
Ok, I am still working on the backport version first, as the backported version will be different.

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=849014#c18)• 12 years ago |
|  | |

Attached patch

[[aurora/beta] Check regexp object before evaluating regexp.](attachment.cgi?id=725144&action=diff) (obsolete)
— [Details](attachment.cgi?id=725144&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=725144)

This patch differ from the previous one as the getKnownClass function is not yet introduced in aurora and beta branches.
Instead of checking ahead of time if the class of the function is correct or not, we just check at run-time if the object we got is really a RegExp or not. If this is not a regexp then we fall back to the usual path to generate an exception.
Sadly the generated exception is not identical to what is expected or seen usually, but this is still better than crashing the browser. I not sure if there is any safe way to recover the correct "test" JSFunction, instead of the NullValue. So in the mean time I kept the NullValue as a low-risk approach.
[Attachment #725144](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") -
Flags: review?(sstangl)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=849014#c19)• 12 years ago |
|  | |

This needs to land on central no later than Monday, and Aurora/Beta on Tuesday in order to be considered for FF20.
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B)

|  | [Sean Stangl [:sstangl]](/user_profile?user_id=383201) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=849014#c20)• 12 years ago |
|  | |

Comment on [attachment 725144](/attachment.cgi?id=725144 "[aurora/beta] Check regexp object before evaluating regexp.") [[details]](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") [[diff]](/attachment.cgi?id=725144&action=diff "[aurora/beta] Check regexp object before evaluating regexp.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=725144)
[aurora/beta] Check regexp object before evaluating regexp.
Review of [attachment 725144](/attachment.cgi?id=725144 "[aurora/beta] Check regexp object before evaluating regexp.") [[details]](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") [[diff]](/attachment.cgi?id=725144&action=diff "[aurora/beta] Check regexp object before evaluating regexp.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=725144):
-----------------------------------------------------------------
::: js/src/builtin/RegExp.cpp
@@ +679,5 @@
> +
> + Value vp[3];
> + AutoArrayRooter rooter(cx, 3, vp);
> + JS::CallArgs args = JS::CallArgsFromVp(1, vp);
> + args.setCallee(NullValue()); // will cause a different error message.
Use "incorrect" instead of "different", but it should still be fine.
@@ +683,5 @@
> + args.setCallee(NullValue()); // will cause a different error message.
> + args.setThis(ObjectValue(\*regexp));
> + args[0] = StringValue(input);
> +
> + JSBool res = js::regexp\_test(cx, 3, vp);
Add comment noting that this is called so that it throws.
[Attachment #725144](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") -
Flags: review?(sstangl) → review+

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=849014#c21)• 12 years ago |
|  | |

Comment on [attachment 725144](/attachment.cgi?id=725144 "[aurora/beta] Check regexp object before evaluating regexp.") [[details]](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") [[diff]](/attachment.cgi?id=725144&action=diff "[aurora/beta] Check regexp object before evaluating regexp.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=725144)
[aurora/beta] Check regexp object before evaluating regexp.
[Approval Request Comment]
Bug caused by (feature/regressing bug #): Landing IonMonkey (Sep 12, fx 18)
User impact if declined: crash, potential injection of bad values into the regexp execution / compiler ?!
Testing completed (on m-c, etc.): No testing on mc as the patch is totally different.
Risk to taking this patch (and alternatives if risky):
- This patch is a bit risky, but instead of preventing any bad inputs flowing into the bad function, it check the input inside the called function and emulate a call to the default function.
- [decoder] This patch introduce a \*differential testing\* bug by returning
“TypeError: null is not a function” instead of “TypeError: test method called on incompatible \*”
String or UUID changes made by this patch: N/A
[Attachment #725144](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") -
Flags: approval-mozilla-beta?
[Attachment #725144](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") -
Flags: approval-mozilla-aurora?

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=849014#c22)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/730fbb35edd5>

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=849014#a855640_395101)• 12 years ago |

Whiteboard: [jsbugmon:update] → [jsbugmon:update,ignore]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=849014#c23)• 12 years ago |
|  | |

JSBugMon: The testcase found in this bug no longer reproduces (tried revision 09f72f45a0b7).

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=849014#c24)• 12 years ago |
|  | |

Fix should have landed:
<http://hg.mozilla.org/mozilla-central/rev/730fbb35edd5>Status: ASSIGNED → RESOLVEDClosed: 12 years agoResolution: --- → FIXEDWhiteboard: [jsbugmon:update,ignore] → [jsbugmon:update]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=849014#a880707_395101)• 12 years ago |

Status: RESOLVED → VERIFIED

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=849014#c25)• 12 years ago |
|  | |

JSBugMon: This bug has been automatically verified fixed.

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=849014#c26)• 12 years ago |
|  | |

Comment on [attachment 725144](/attachment.cgi?id=725144 "[aurora/beta] Check regexp object before evaluating regexp.") [[details]](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") [[diff]](/attachment.cgi?id=725144&action=diff "[aurora/beta] Check regexp object before evaluating regexp.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=725144)
[aurora/beta] Check regexp object before evaluating regexp.
gkw, decoder: I am confident about this patch, but as this patch does not apply on central can you fuzz this patch for beta, to ensure there is no additional errors in this patch.
[Attachment #725144](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") -
Flags: feedback?(gary)
[Attachment #725144](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") -
Flags: feedback?(choller)

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=849014#c27)• 12 years ago |
|  | |

Comment on [attachment 725144](/attachment.cgi?id=725144 "[aurora/beta] Check regexp object before evaluating regexp.") [[details]](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") [[diff]](/attachment.cgi?id=725144&action=diff "[aurora/beta] Check regexp object before evaluating regexp.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=725144)
[aurora/beta] Check regexp object before evaluating regexp.
This doesn't apply cleanly on mozilla-beta - I've verified this with Nicolas beside me.
[Attachment #725144](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") -
Flags: feedback?(gary)
[Attachment #725144](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") -
Flags: feedback?(choller)
[Attachment #725144](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") -
Flags: feedback-

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=849014#c28)• 12 years ago |
|  | |

Do we need an updated patch for aurora/beta uplift here? We're going to build with our fifth week beta tomorrow and this should really get into that build. Please update/provide options for getting this code in.Flags: needinfo?(nicolas.b.pierron)

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=849014#c29)• 12 years ago |
|  | |

(In reply to Lukas Blakk [:lsblakk] from [comment #28](/show_bug.cgi?id=849014#c28 "VERIFIED FIXED - IonMonkey: Crash [@ js::RegExpGuard::operator*] or \"Assertion failure: isRegExp(),\""))
> Do we need an updated patch for aurora/beta uplift here? We're going to
> build with our fifth week beta tomorrow and this should really get into that
> build. Please update/provide options for getting this code in.
Apparently my trees were not up to date :(
Checking with recent trees, verified against tbpl. Aurora can use [attachment 724225](/attachment.cgi?id=724225 "Check type inference before optimizing regexp calls.") [[details]](/attachment.cgi?id=724225&action=edit "Check type inference before optimizing regexp calls.") [[diff]](/attachment.cgi?id=724225&action=diff "Check type inference before optimizing regexp calls.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=724225), and Beta will need slightly modified version of [attachment 725144](/attachment.cgi?id=725144 "[aurora/beta] Check regexp object before evaluating regexp.") [[details]](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") [[diff]](/attachment.cgi?id=725144&action=diff "[aurora/beta] Check regexp object before evaluating regexp.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=725144). I am working on it.
[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected) → ---
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix) → ---
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected) → ---
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected) → ---
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected) → ---
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected) → ---
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B) → ---
[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B) → ---
[tracking-firefox22](/buglist.cgi?f1=cf_tracking_firefox22&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B) → ---Flags: needinfo?(nicolas.b.pierron)

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=849014#c30)• 12 years ago |
|  | |

Attached patch

[[beta] Check regexp object before evaluating regexp.](attachment.cgi?id=726355&action=diff)
— [Details](attachment.cgi?id=726355&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=726355)

Keep the review from [attachment 725144](/attachment.cgi?id=725144 "[aurora/beta] Check regexp object before evaluating regexp.") [[details]](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") [[diff]](/attachment.cgi?id=725144&action=diff "[aurora/beta] Check regexp object before evaluating regexp.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=725144), as this is identical except that it reuse regexp\_test\_raw which has been added instead of adding it, but getKnownClass is still not backported to beta, so [attachment 724225](/attachment.cgi?id=724225 "Check type inference before optimizing regexp calls.") [[details]](/attachment.cgi?id=724225&action=edit "Check type inference before optimizing regexp calls.") [[diff]](/attachment.cgi?id=724225&action=diff "Check type inference before optimizing regexp calls.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=724225) will not work.
gkw, decoder: This patch should apply fine on beta. Can you check with this one instead. I verified that the test case is fixed by this patch.
[Attachment #726355](/attachment.cgi?id=726355&action=edit "[beta] Check regexp object before evaluating regexp.") -
Flags: review+
[Attachment #726355](/attachment.cgi?id=726355&action=edit "[beta] Check regexp object before evaluating regexp.") -
Flags: feedback?(gary)
[Attachment #726355](/attachment.cgi?id=726355&action=edit "[beta] Check regexp object before evaluating regexp.") -
Flags: feedback?(choller)
[Attachment #726355](/attachment.cgi?id=726355&action=edit "[beta] Check regexp object before evaluating regexp.") -
Flags: approval-mozilla-beta?

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=849014#c31)• 12 years ago |
|  | |

Comment on [attachment 724225](/attachment.cgi?id=724225 "Check type inference before optimizing regexp calls.") [[details]](/attachment.cgi?id=724225&action=edit "Check type inference before optimizing regexp calls.") [[diff]](/attachment.cgi?id=724225&action=diff "Check type inference before optimizing regexp calls.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=724225)
Check type inference before optimizing regexp calls.
[Approval Request Comment]
see [comment 11](/show_bug.cgi?id=849014#c11 "VERIFIED FIXED - IonMonkey: Crash [@ js::RegExpGuard::operator*] or \"Assertion failure: isRegExp(),\"")
[Attachment #724225](/attachment.cgi?id=724225&action=edit "Check type inference before optimizing regexp calls.") -
Flags: approval-mozilla-aurora?

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=849014#c32)• 12 years ago |
|  | |

Resetting the flags that were wiped in [comment 29](/show_bug.cgi?id=849014#c29 "VERIFIED FIXED - IonMonkey: Crash [@ js::RegExpGuard::operator*] or \"Assertion failure: isRegExp(),\"")
[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected)
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=fixed)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected)
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B)
[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B)
[tracking-firefox22](/buglist.cgi?f1=cf_tracking_firefox22&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=849014#c33)• 12 years ago |
|  | |

I'm testing this on beta now, with special focus on RegExp. So far nothing found.

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=849014#a1014491_272375)• 12 years ago |

[Attachment #724225](/attachment.cgi?id=724225&action=edit "Check type inference before optimizing regexp calls.") -
Flags: approval-mozilla-aurora? → approval-mozilla-aurora+

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=849014#c34)• 12 years ago |
|  | |

Comment on [attachment 726355](/attachment.cgi?id=726355 "[beta] Check regexp object before evaluating regexp.") [[details]](/attachment.cgi?id=726355&action=edit "[beta] Check regexp object before evaluating regexp.") [[diff]](/attachment.cgi?id=726355&action=diff "[beta] Check regexp object before evaluating regexp.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=726355)
[beta] Check regexp object before evaluating regexp.
Given nothing found yet - let's get this on beta now so we know it will be in our fifth week's beta going to build later today.
[Attachment #726355](/attachment.cgi?id=726355&action=edit "[beta] Check regexp object before evaluating regexp.") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=849014#c35)• 12 years ago |
|  | |

Comment on [attachment 725144](/attachment.cgi?id=725144 "[aurora/beta] Check regexp object before evaluating regexp.") [[details]](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") [[diff]](/attachment.cgi?id=725144&action=diff "[aurora/beta] Check regexp object before evaluating regexp.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=725144)
[aurora/beta] Check regexp object before evaluating regexp.
Correct me if I'm reading this bug wrong, but I believe this patch needs only aurora approval (applies cleanly) and the other patch I approved covers the beta branch.
[Attachment #725144](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") -
Flags: approval-mozilla-beta?
[Attachment #725144](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") -
Flags: approval-mozilla-beta-
[Attachment #725144](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") -
Flags: approval-mozilla-aurora?
[Attachment #725144](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") -
Flags: approval-mozilla-aurora+

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=849014#c36)• 12 years ago |
|  | |

Comment on [attachment 725144](/attachment.cgi?id=725144 "[aurora/beta] Check regexp object before evaluating regexp.") [[details]](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") [[diff]](/attachment.cgi?id=725144&action=diff "[aurora/beta] Check regexp object before evaluating regexp.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=725144)
[aurora/beta] Check regexp object before evaluating regexp.
(In reply to Lukas Blakk [:lsblakk] from [comment #35](/show_bug.cgi?id=849014#c35 "VERIFIED FIXED - IonMonkey: Crash [@ js::RegExpGuard::operator*] or \"Assertion failure: isRegExp(),\""))
> Comment on [attachment 725144](/attachment.cgi?id=725144 "[aurora/beta] Check regexp object before evaluating regexp.") [[details]](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") [[diff]](/attachment.cgi?id=725144&action=diff "[aurora/beta] Check regexp object before evaluating regexp.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=725144)
> [aurora/beta] Check regexp object before evaluating regexp.
>
> Correct me if I'm reading this bug wrong, but I believe this patch needs
> only aurora approval (applies cleanly) and the other patch I approved covers
> the beta branch.
Sorry, I forgot to mark this patch as obsolete, as described in [comment 29](/show_bug.cgi?id=849014#c29 "VERIFIED FIXED - IonMonkey: Crash [@ js::RegExpGuard::operator*] or \"Assertion failure: isRegExp(),\"").
[Attachment 726355](/attachment.cgi?id=726355 "[beta] Check regexp object before evaluating regexp.") [[details]](/attachment.cgi?id=726355&action=edit "[beta] Check regexp object before evaluating regexp.") [[diff]](/attachment.cgi?id=726355&action=diff "[beta] Check regexp object before evaluating regexp.") contains the modified version of this patch.
I reset the aurora approval as this patch is obsolete.
[Attachment #725144](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") -
Attachment is obsolete: true
[Attachment #725144](/attachment.cgi?id=725144&action=edit "[aurora/beta] Check regexp object before evaluating regexp.") -
Flags: approval-mozilla-aurora+

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=849014#c37)• 12 years ago |
|  | |

Comment on [attachment 726355](/attachment.cgi?id=726355 "[beta] Check regexp object before evaluating regexp.") [[details]](/attachment.cgi?id=726355&action=edit "[beta] Check regexp object before evaluating regexp.") [[diff]](/attachment.cgi?id=726355&action=diff "[beta] Check regexp object before evaluating regexp.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=726355)
[beta] Check regexp object before evaluating regexp.
I have not found anything after a round of overnight fuzzing on beta. feedback+
[Attachment #726355](/attachment.cgi?id=726355&action=edit "[beta] Check regexp object before evaluating regexp.") -
Flags: feedback?(gary) → feedback+

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=849014#c38)• 12 years ago |
|  | |

Comment on [attachment 724225](/attachment.cgi?id=724225 "Check type inference before optimizing regexp calls.") [[details]](/attachment.cgi?id=724225&action=edit "Check type inference before optimizing regexp calls.") [[diff]](/attachment.cgi?id=724225&action=diff "Check type inference before optimizing regexp calls.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=724225)
Check type inference before optimizing regexp calls.
<https://hg.mozilla.org/releases/mozilla-aurora/rev/bd540c741136>

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=849014#c39)• 12 years ago |
|  | |

Comment on [attachment 726355](/attachment.cgi?id=726355 "[beta] Check regexp object before evaluating regexp.") [[details]](/attachment.cgi?id=726355&action=edit "[beta] Check regexp object before evaluating regexp.") [[diff]](/attachment.cgi?id=726355&action=diff "[beta] Check regexp object before evaluating regexp.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=726355)
[beta] Check regexp object before evaluating regexp.
<https://hg.mozilla.org/releases/mozilla-beta/rev/e1633ced70b0>

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=849014#a1019197_422187)• 12 years ago |

[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=849014#c40)• 12 years ago |
|  | |

Comment on [attachment 726355](/attachment.cgi?id=726355 "[beta] Check regexp object before evaluating regexp.") [[details]](/attachment.cgi?id=726355&action=edit "[beta] Check regexp object before evaluating regexp.") [[diff]](/attachment.cgi?id=726355&action=diff "[beta] Check regexp object before evaluating regexp.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=849014&attachment=726355)
[beta] Check regexp object before evaluating regexp.
No issues found over night.
[Attachment #726355](/attachment.cgi?id=726355&action=edit "[beta] Check regexp object before evaluating regexp.") -
Flags: feedback?(choller) → feedback+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=849014#a1547439_280903)• 12 years ago |

Whiteboard: [jsbugmon:update] → [jsbugmon:update][adv-main20+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=849014#a22717838_1689)• 11 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=849014&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_7a69bbdd_20250125_151418.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2013-30

## Miscellaneous memory safety hazards (rv:20.0 / rv:17.0.5)

Announced
April 2, 2013
Reporter
Mozilla Developers
Impact
Critical
Products
Firefox, Firefox ESR, SeaMonkey, Thunderbird, Thunderbird ESR
Fixed in

* Firefox 20
* Firefox ESR 17.0.5
* SeaMonkey 2.17
* Thunderbird 17.0.5
* Thunderbird ESR 17.0.5

### Description

Mozilla developers identified and fixed several memory safety bugs in the
browser engine used in Firefox and other Mozilla-based products. Some of these
bugs showed evidence of memory corruption under certain circumstances, and we
presume that with enough effort at least some of these could be exploited to run
arbitrary code.

In general these flaws cannot be exploited through email in the
Thunderbird and SeaMonkey products because scripting is disabled, but are
potentially a risk in browser or browser-like contexts in those products.

### References

Olli Pettay, Jesse Ruderman, Boris Zbarsky, Christian Holler, Milan
Sreckovic, and Joe Drew reported memory safety problems and crashes that affect
Firefox ESR 17, and Firefox 19.

* [Memory safety bugs fixed in Firefox 17.0.5 and Firefox 20.0](https://bugzilla.mozilla.org/buglist.cgi?bug_id=635852,771942,784730,813442,827870,834240,839621,840263,840353,852923) ([CVE-2013-0788](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0788))

Andrew McCreight, Randell Jesup, Gary Kwong, Jesse Ruderman, Christian
Holler, and Mats Palmgren reported memory safety problems and crashes that
affect Firefox 19.

* [Memory safety bugs fixed in Firefox 20.0](https://bugzilla.mozilla.org/buglist.cgi?bug_id=808736,830595,817841,824643,824856,831055,849014,827596,835499,837714,839209,842300,815315) ([CVE-2013-0789](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0789))

Jim Chen reported a memory safety problem that affects Firefox for Android
19.

* [Stack corruption in plug-in code](https://bugzilla.mozilla.org/show_bug.cgi?id=842687)
  ([CVE-2013-0790](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0790))

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_cc72c8fa_20250125_151424.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/824643)
* [XML](/show_bug.cgi?ctype=xml&id=824643)

Closed
[Bug 824643](/show_bug.cgi?id=824643)

Opened 12 years ago
Closed 12 years ago

# heap-use-after-free in nsTreeBodyFrame::UpdateScrollbars

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

heap-use-after-free in nsTreeBodyFrame::UpdateScrollbars

## Categories

### (Core :: XUL, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=XUL#XUL)

XUL
▾

Core :: XUL

For bugs in the [XUL
language](http://www.mozilla.org/xpfe/xptoolkit/xulintro.html). (XUL is an XML-based language which specifies Mozilla's user interface.)

If you're not actually writing XUL code, this is probably not the right place for your bug.

Examples of appropriate bugs: Duplicate window ID causes infinite loop; or Scrollbars disappear after loading XUL document

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=XUL&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=XUL&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=XUL)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla20

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox19 | --- | [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected) |
| firefox20 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed) |
| firefox21 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed) |
| firefox-esr17 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=wontfix) |
| b2g18 | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=wontfix) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox19 |  | affected |
| firefox20 |  | fixed |
| firefox21 |  | fixed |
| firefox-esr17 |  | wontfix |
| b2g18 |  | wontfix |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: MatsPalmgren\_bugz, Assigned: MatsPalmgren\_bugz)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/e7ca93d447a86b3e78cdf42d361b4d3a?d=mm&size=40)  [MatsPalmgren\_bugz](/user_profile?user_id=5168)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/e7ca93d447a86b3e78cdf42d361b4d3a?d=mm&size=40)  [MatsPalmgren\_bugz](/user_profile?user_id=5168)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/c9e62c36c6c16218485bdb90fe88d63e?d=mm&size=40)  [enndeakin](/user_profile?user_id=6102)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-framepoisoning, csectype-uaf, sec-other, Whiteboard: [adv-main20+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[csectype-framepoisoning](/buglist.cgi?keywords=csectype-framepoisoning&resolution=---),
[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[sec-other](/buglist.cgi?keywords=sec-other&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main20+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [fix](/attachment.cgi?id=695668)  [12 years ago](#c1)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   1.28 KB, patch | roc : [review+](#a15833_5038 "12 years ago") | [Details](/attachment.cgi?id=695668&action=edit) | [Diff](/attachment.cgi?id=695668&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=824643&attachment=695668) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=824643#c0)• 12 years ago |
|  | |

STR: load layout/xul/base/src/tree/src/409807-1.xul in an ASan build compiled
with -DDEBUG\_TRACEMALLOC\_PRESARENA
871 nsTreeBodyFrame::UpdateScrollbars(const ScrollParts& aParts)
872 {
873 nscoord rowHeightAsPixels = nsPresContext::AppUnitsToIntCSSPixels(mRowHeight);
874
875 if (aParts.mVScrollbar) {
876 nsAutoString curPos;
877 curPos.AppendInt(mTopRowIndex\*rowHeightAsPixels);
878 aParts.mVScrollbarContent->
879 SetAttr(kNameSpaceID\_None, nsGkAtoms::curpos, curPos, true);
880 }
881
882 if (aParts.mHScrollbar) {
883 nsAutoString curPos;
884 curPos.AppendInt(mHorzPosition);
885 aParts.mHScrollbarContent->
886 SetAttr(kNameSpaceID\_None, nsGkAtoms::curpos, curPos, true);
887 }
888 }
The SetAttr causes the frame to be destroyed, so we'll read some poisoned
value for this->mHorzPosition on line 884. aParts.mHScrollbarContent
is a strong ref. It looks harmless at first glance, but filing the
bug as Security-Sensitive just in case.

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=824643#c1)• 12 years ago |
|  | |

Attached patch

[fix](attachment.cgi?id=695668&action=diff)
— [Details](attachment.cgi?id=695668&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=824643&attachment=695668)

<https://tbpl.mozilla.org/?tree=Try&rev=58eeb5c8c0d0>
[Attachment #695668](/attachment.cgi?id=695668&action=edit "fix") -
Flags: review?(roc)

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824643#a15833_5038)• 12 years ago |

[Attachment #695668](/attachment.cgi?id=695668&action=edit "fix") -
Flags: review?(roc) → review+

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824643#a87269_406194)• 12 years ago |

Keywords: [sec-audit](/buglist.cgi?keywords=sec-audit&resolution=---)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=824643#c2)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/4ab11d8ed73b>

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=824643#c3)• 12 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/4ab11d8ed73b>
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed)Target Milestone: --- → mozilla20

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824643#a318404_5168)• 12 years ago |

Status: NEW → RESOLVEDClosed: 12 years agoResolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=824643#c4)• 12 years ago |
|  | |

is this a frame-poisoned DoS or should we try to get this fix on older branches as well?
[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=affected)
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected)

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=824643#c5)• 12 years ago |
|  | |

I believe it's frame-poisoned.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824643#a2431254_1689)• 12 years ago |

Keywords: [sec-audit](/buglist.cgi?keywords=sec-audit&resolution=---) → [csec-framepoisoning](/buglist.cgi?keywords=csec-framepoisoning&resolution=---),
[sec-other](/buglist.cgi?keywords=sec-other&resolution=---)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824643#a2602475_425645)• 12 years ago |

[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=wontfix)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=wontfix)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824643#a7770034_280903)• 12 years ago |

Whiteboard: [adv-main20+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824643#a59983135_1689)• 10 years ago |

Group: core-security

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824643#a137882943_1689)• 8 years ago |

Keywords: [csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---)
You need to [log in](/show_bug.cgi?id=824643&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Mats Palmgren (inactive)](/user_profile?user_id=5168)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_016bcf58_20250125_151432.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/835499)
* [XML](/show_bug.cgi?ctype=xml&id=835499)

Closed
[Bug 835499](/show_bug.cgi?id=835499)

Opened 12 years ago
Closed 12 years ago

# Crash [@ js::ion::IonFrameIterator::ionScript] or [@ js::ion::GetPcScript] or Assertion failure: type() == IonFrame\_OptimizedJS, at ion/IonFrames.cpp:855

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Crash [@ js::ion::IonFrameIterator::ionScript] or [@ js::ion::GetPcScript] or Assertion failure: type() == IonFrame\_OptimizedJS, at ion/IonFrames.cpp:855

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla21

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox18 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=wontfix) |
| firefox19 | [-](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=-) | [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected) |
| firefox20 | [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed) |
| firefox21 | [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed) |
| firefox-esr17 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected) |
| b2g18 | --- | [disabled](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=disabled) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox18 |  | wontfix |
| firefox19 | - | affected |
| firefox20 | + | fixed |
| firefox21 | + | fixed |
| firefox-esr17 |  | unaffected |
| b2g18 |  | disabled |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: decoder, Assigned: nbp)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/f78625fe5901300b4689355a8e507ea2?d=mm&size=40)  [nbp](/user_profile?user_id=422187)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/55857f92ded07119259dc6c1dd386205?d=mm&size=40)  [general](/user_profile?user_id=4729)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/b29b83d12aba827b8ff68296e473bec5?d=mm&size=40)  [decoder](/user_profile?user_id=395101)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[825379](/show_bug.cgi?id=825379 "RESOLVED FIXED - IonMonkey: Differential Testing: Getting different output w/without --ion-eager with forEach")

Dependency [tree](/showdependencytree.cgi?id=835499&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=835499)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[835792](/show_bug.cgi?id=835792 "RESOLVED DUPLICATE - Assertion failure during ReflowTypeInfo after bailout: JS_ASSERT(type() == IonFrame_OptimizedJS);")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [jsbugmon:update][adv-main20+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[jsbugmon:update][adv-main20+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ js::ion::IonFrameIterator::ionScript ]](https://crash-stats.mozilla.org/signature/?signature=js%3A%3Aion%3A%3AIonFrameIterator%3A%3AionScript)

[[@ js::ion::GetPcScript ]](https://crash-stats.mozilla.org/signature/?signature=js%3A%3Aion%3A%3AGetPcScript)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Remove the runningInIon flag at the end of convertFrame.](/attachment.cgi?id=708726)  [12 years ago](#c8)  [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)   1.78 KB, patch | dvander : [review+](#a283364_309316 "12 years ago")  nmatsakis : [feedback+](#a2303842_427103 "12 years ago")  bajaj : [approval-mozilla-aurora+](#a951568_448925 "12 years ago")  dveditz : [sec-approval+](#c11 "12 years ago") | [Details](/attachment.cgi?id=708726&action=edit) | [Diff](/attachment.cgi?id=708726&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=835499&attachment=708726) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=835499#c0)• 12 years ago |
|  | |

The following testcase asserts on mozilla-central revision 80fed51ae074 (run with --ion-eager):
new Function("\
actual = Array.indexOf([]);\
actual = [].indexOf();\
actual += Array.indexOf(actual);\
")();

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=835499#c1)• 12 years ago |
|  | |

Crash Trace:
==2306== Invalid read of size 4
==2306== at 0x7339E3: js::ion::IonFrameIterator::ionScript() const (IonFrames.cpp:69)
==2306== by 0x7343AA: \_ZN2js3ion16SnapshotIteratorC2ERKNS0\_16IonFrameIteratorE.constprop.140 (IonFrames.cpp:736)
==2306== by 0x735E48: js::ion::GetPcScript(JSContext\*, JSScript\*\*, unsigned char\*\*) (IonFrames.cpp:892)
==2306== by 0x41AE78: \_ZNK2js12ContextStack13currentScriptEPPhNS0\_26MaybeAllowCrossCompartmentE.constprop.461 (Stack-inl.h:564)
==2306== by 0x423653: JS::CompileOptions::CompileOptions(JSContext\*) (jscntxtinlines.h:466)
==2306== by 0x525258: js::CloneScript(JSContext\*, JS::Handle<JSObject\*>, JS::Handle<JSFunction\*>, JS::Handle<JSScript\*>) (jsscript.cpp:2267)
==2306== by 0x61365E: JSRuntime::cloneSelfHostedFunctionScript(JSContext\*, JS::Handle<js::PropertyName\*>, JS::Handle<JSFunction\*>) (SelfHosting.cpp:371)
==2306== by 0x47A47F: JSFunction::initializeLazyScript(JSContext\*) (jsfun.cpp:1055)
==2306== by 0x4A278A: TypeConstraintPropagateThis::newType(JSContext\*, js::types::TypeSet\*, js::types::Type) (jsfun.h:205)
==2306== by 0x4914EB: js::types::TypeSet::addType(JSContext\*, js::types::Type) (jsinferinlines.h:1150)
==2306== by 0x495D25: js::types::TypeMonitorResult(JSContext\*, JSScript\*, unsigned char\*, JS::Value const&) (jsinfer.cpp:5637)
==2306== by 0x6F21C1: js::ion::ReflowTypeInfo(unsigned int) (jsinferinlines.h:931)
==2306== Address 0xfffffffffffffffc is not stack'd, malloc'd or (recently) free'd
The crash seems to be near null, but using a negative offset. Marking S-s so this can be investigated first.Whiteboard: [jsbugmon:update,bisect]

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=835499#c2)• 12 years ago |
|  | |

The first bad revision is:
changeset: 119958:b0f81f058496
user: Jan de Mooij
date: Sat Jan 26 16:40:06 2013 +0100
summary: [Bug 825379](/show_bug.cgi?id=825379 "RESOLVED FIXED - IonMonkey: Differential Testing: Getting different output w/without --ion-eager with forEach") - Fix JSContext::findVersion to work with Ion frames. r=dvander

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=835499#c3)• 12 years ago |
|  | |

jandem, is [bug 825379](/show_bug.cgi?id=825379 "RESOLVED FIXED - IonMonkey: Differential Testing: Getting different output w/without --ion-eager with forEach") possibly related?Blocks: [825379](/show_bug.cgi?id=825379 "RESOLVED FIXED - IonMonkey: Differential Testing: Getting different output w/without --ion-eager with forEach")Flags: needinfo?(jdemooij)Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=835499#c4)• 12 years ago |
|  | |

Jan, could you take a look at this? I'm not sure if [bug 825379](/show_bug.cgi?id=825379 "RESOLVED FIXED - IonMonkey: Differential Testing: Getting different output w/without --ion-eager with forEach") exposed a pre-existing bug or if this is new. It looks like we're entering the VM from within a post-bailout update (i.e. ReflowTypeInfo), which does not have an exit frame, and therefore we skip the OptimizedJS frame.Assignee: general → jdemooijStatus: NEW → ASSIGNEDFlags: needinfo?(jdemooij)

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=835499#a221897_422187)• 12 years ago |

Assignee: jdemooij → nicolas.b.pierron

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=835499#a240685_395101)• 12 years ago |

Whiteboard: [jsbugmon:update,bisect] → [jsbugmon:update]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=835499#c6)• 12 years ago |
|  | |

JSBugMon: Bisection requested, result:
autoBisect shows this is probably related to the following changeset:
The first bad revision is:
changeset: 119958:b0f81f058496
user: Jan de Mooij
date: Sat Jan 26 16:40:06 2013 +0100
summary: [Bug 825379](/show_bug.cgi?id=825379 "RESOLVED FIXED - IonMonkey: Differential Testing: Getting different output w/without --ion-eager with forEach") - Fix JSContext::findVersion to work with Ion frames. r=dvander
This iteration took 12.481 seconds to run.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=835499#a255169_132034)• 12 years ago |

Crash Signature: [@ js::ion::IonFrameIterator::ionScript]
[@ js::ion::GetPcScript]Summary: Assertion failure: type() == IonFrame\_OptimizedJS, at ion/IonFrames.cpp:855 Crash [@ js::ion::IonFrameIterator::ionScript] → Crash [@ js::ion::IonFrameIterator::ionScript] or [@ js::ion::GetPcScript] or Assertion failure: type() == IonFrame\_OptimizedJS, at ion/IonFrames.cpp:855

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=835499#c7)• 12 years ago |
|  | |

The problem is that we bail the first JS frame and we look for the script while it is still marked as running in Ion.
I guess a simple fix would be to clear the runningInIon flag from the bailed frame after the bailout instead of doing so in the ThunkToInterpreter function.

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=835499#c8)• 12 years ago |
|  | |

Attached patch

[Remove the runningInIon flag at the end of convertFrame.](attachment.cgi?id=708726&action=diff)
— [Details](attachment.cgi?id=708726&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=835499&attachment=708726)

Niko: can you confirm that this fix the bug you had on your branch?
[Attachment #708726](/attachment.cgi?id=708726&action=edit "Remove the runningInIon flag at the end of convertFrame.") -
Flags: review?(dvander)
[Attachment #708726](/attachment.cgi?id=708726&action=edit "Remove the runningInIon flag at the end of convertFrame.") -
Flags: feedback?(nmatsakis)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=835499#a283364_309316)• 12 years ago |

[Attachment #708726](/attachment.cgi?id=708726&action=edit "Remove the runningInIon flag at the end of convertFrame.") -
Flags: review?(dvander) → review+

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=835499#c9)• 12 years ago |
|  | |

Comment on [attachment 708726](/attachment.cgi?id=708726 "Remove the runningInIon flag at the end of convertFrame.") [[details]](/attachment.cgi?id=708726&action=edit "Remove the runningInIon flag at the end of convertFrame.") [[diff]](/attachment.cgi?id=708726&action=diff "Remove the runningInIon flag at the end of convertFrame.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=835499&attachment=708726)
Remove the runningInIon flag at the end of convertFrame.
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Moving the line show that the problem was in-between, and that it is related to stack iteration as the flag is only used during stack iterations. It does not pin-point which function, but this can be found statically by looking at a call graph of functions used in generateBailoutTail.
Then I don't know how easy it is to use this to determine which JS function should be used to reproduce a similar bug.
This assertion protects against bad frame read. And the information read out of it might cause TI to register some type information at the wrong place.
So at-least random memory read, and potentially generating bad TI info.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
Nothing except the patch it-self, but this would still be difficult for me.
Which older supported branches are affected by this flaw?
aurora, beta, 18.
not b2g18 (does not use IonMonkey)
If not all supported branches, which bug introduced the flaw?
[Bug 825379](/show_bug.cgi?id=825379 "RESOLVED FIXED - IonMonkey: Differential Testing: Getting different output w/without --ion-eager with forEach") exhibit one show case. In practice it could be present since IonMonkey & Self-hosted landing.
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
The patch should be identical on all branches (not tested)
How likely is this patch to cause regressions; how much testing does it need?
Regressions are unlikely, except in case of OOM, where this might not be well defined.
[Attachment #708726](/attachment.cgi?id=708726&action=edit "Remove the runningInIon flag at the end of convertFrame.") -
Flags: sec-approval?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=835499#c10)• 12 years ago |
|  | |

Since we didn't notice the problem until [bug 825379](/show_bug.cgi?id=825379 "RESOLVED FIXED - IonMonkey: Differential Testing: Getting different output w/without --ion-eager with forEach") exposed it (made the conditions more likely?) we should be safe enough not trying to ram this into Firefox 19 Beta right at the end.
[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
--- → [disabled](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=disabled)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=wontfix)
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected)
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
--- → [-](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=-)
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B)
[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B)Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=835499#c11)• 12 years ago |
|  | |

Comment on [attachment 708726](/attachment.cgi?id=708726 "Remove the runningInIon flag at the end of convertFrame.") [[details]](/attachment.cgi?id=708726&action=edit "Remove the runningInIon flag at the end of convertFrame.") [[diff]](/attachment.cgi?id=708726&action=diff "Remove the runningInIon flag at the end of convertFrame.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=835499&attachment=708726)
Remove the runningInIon flag at the end of convertFrame.
sec-approval = dveditz
[Attachment #708726](/attachment.cgi?id=708726&action=edit "Remove the runningInIon flag at the end of convertFrame.") -
Flags: sec-approval? → sec-approval+

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=835499#c12)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/979de88d617d>

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=835499#c13)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/979de88d617d>Status: ASSIGNED → RESOLVEDClosed: 12 years ago
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla21

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=835499#a921206_395101)• 12 years ago |

Status: RESOLVED → VERIFIEDCrash Signature: [@ js::ion::IonFrameIterator::ionScript]
[@ js::ion::GetPcScript] → [@ js::ion::IonFrameIterator::ionScript]
[@ js::ion::GetPcScript]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=835499#c14)• 12 years ago |
|  | |

JSBugMon: This bug has been automatically verified fixed.

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=835499#c15)• 12 years ago |
|  | |

Comment on [attachment 708726](/attachment.cgi?id=708726 "Remove the runningInIon flag at the end of convertFrame.") [[details]](/attachment.cgi?id=708726&action=edit "Remove the runningInIon flag at the end of convertFrame.") [[diff]](/attachment.cgi?id=708726&action=diff "Remove the runningInIon flag at the end of convertFrame.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=835499&attachment=708726)
Remove the runningInIon flag at the end of convertFrame.
[Approval Request Comment]
Bug caused by (feature/regressing bug #): IonMonkey & self-hosted
User impact if declined: Potential random memory reads in self-hosted jitted functions.
Testing completed (on m-c, etc.): in m-c since 5h ([comment 13](/show_bug.cgi?id=835499#c13 "VERIFIED FIXED - Crash [@ js::ion::IonFrameIterator::ionScript] or [@ js::ion::GetPcScript] or Assertion failure: type() == IonFrame_OptimizedJS, at ion/IonFrames.cpp:855")).
Risk to taking this patch (and alternatives if risky): low
String or UUID changes made by this patch: N/A
[Attachment #708726](/attachment.cgi?id=708726&action=edit "Remove the runningInIon flag at the end of convertFrame.") -
Flags: approval-mozilla-aurora?

|  | [bhavana bajaj [:bajaj]](/user_profile?user_id=448925) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=835499#a951568_448925)• 12 years ago |

[Attachment #708726](/attachment.cgi?id=708726&action=edit "Remove the runningInIon flag at the end of convertFrame.") -
Flags: approval-mozilla-aurora? → approval-mozilla-aurora+

|  | [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=835499#c16)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/741f0584eb8a>Crash Signature: [@ js::ion::IonFrameIterator::ionScript]
[@ js::ion::GetPcScript] → [@ js::ion::IonFrameIterator::ionScript]
[@ js::ion::GetPcScript]
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed)

|  | [Niko Matsakis [:nmatsakis]](/user_profile?user_id=427103) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=835499#a2303842_427103)• 12 years ago |

[Attachment #708726](/attachment.cgi?id=708726&action=edit "Remove the runningInIon flag at the end of convertFrame.") -
Flags: feedback?(nmatsakis) → feedback+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=835499#a4839544_280903)• 12 years ago |

Whiteboard: [jsbugmon:update] → [jsbugmon:update][adv-main20+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=835499#a26011194_1689)• 11 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=835499&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Nicolas B. Pierron [:nbp]](/user_profile?user_id=422187)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_532bcd27_20250125_151421.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/815315)
* [XML](/show_bug.cgi?ctype=xml&id=815315)

Closed
[Bug 815315](/show_bug.cgi?id=815315)

Opened 12 years ago
Closed 12 years ago

# nsTableFrame doesn't deal with row-group continuations very well

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

nsTableFrame doesn't deal with row-group continuations very well

## Categories

### (Core :: Layout: Tables, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Layout%3A%20Tables#Layout%3A%20Tables)

Layout: Tables
▾

Core :: Layout: Tables

Issues with table layout and rendering.

Example bugs:

* border-style: groove not applied for tables with border-collapse: collapse
* incorrect width for table cells with padding, box-sizing: border-box, and table-layout: fixed

Specifications covered:

* CSS 2.2 (§ Tables)

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Layout%3A%20Tables&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Layout%3A%20Tables&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Layout%3A%20Tables)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla20

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox19 | --- | [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected) |
| firefox20 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed) |
| firefox-esr10 | --- | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |
| firefox-esr17 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected) |
| b2g18 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox19 |  | affected |
| firefox20 |  | fixed |
| firefox-esr10 |  | unaffected |
| firefox-esr17 |  | unaffected |
| b2g18 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: MatsPalmgren\_bugz, Assigned: MatsPalmgren\_bugz)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/e7ca93d447a86b3e78cdf42d361b4d3a?d=mm&size=40)  [MatsPalmgren\_bugz](/user_profile?user_id=5168)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/e7ca93d447a86b3e78cdf42d361b4d3a?d=mm&size=40)  [MatsPalmgren\_bugz](/user_profile?user_id=5168)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/cd9b85b2e112bd7941b21ad03f42604e?d=mm&size=40)  [dholbert](/user_profile?user_id=278074)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-other, testcase, Whiteboard: [adv-main20+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[sec-other](/buglist.cgi?keywords=sec-other&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main20+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c9 "12 years ago") | ? |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | ? |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Avoid crashing if the last row-group child frame was removed](/attachment.cgi?id=685910)  [12 years ago](#c2)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   940 bytes, patch | bzbarsky : [review+](#c4 "12 years ago") | [Details](/attachment.cgi?id=685910&action=edit) | [Diff](/attachment.cgi?id=685910&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=815315&attachment=685910) |
| --- | --- | --- |
| [Make nsTableFrame::RemoveFrame remove all continuations of the removed child frame too](/attachment.cgi?id=685911)  [12 years ago](#c3)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   4.31 KB, patch | bzbarsky : [review+](#c5 "12 years ago") | [Details](/attachment.cgi?id=685911&action=edit) | [Diff](/attachment.cgi?id=685911&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=815315&attachment=685911) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=815315#c0)• 12 years ago |
|  | |

From [bug 812879](/show_bug.cgi?id=812879 "RESOLVED FIXED - Various things go wrong with page-break-inside: avoid (along with table, huge margins, float, overflow)"):
ASSERTION: invalid col index: 'Error', file layout/tables/nsTableFrame.cpp
ASSERTION: column frames out of sync with cell map: 'Error', file layout/tables/BasicTableLayoutStrategy.cpp
A related testcase triggers:
ASSERTION: overflow list w/o frames: 'mFrames.NotEmpty()', file layout/generic/nsContainerFrame.cpp
Assertion failure: i < Length() (invalid array index),

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=815315#c1)• 12 years ago |
|  | |

The assertions above are for the testcases in [bug 812879](/show_bug.cgi?id=812879 "RESOLVED FIXED - Various things go wrong with page-break-inside: avoid (along with table, huge margins, float, overflow)"). I'll attach a low-risk
patch there to avoid the underlying issues of the assertions. I'll use this bug to
fix them properly.Assignee: nobody → matspal

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=815315#c2)• 12 years ago |
|  | |

Attached patch

[Avoid crashing if the last row-group child frame was removed](attachment.cgi?id=685910&action=diff)
— [Details](attachment.cgi?id=685910&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=815315&attachment=685910)

This caused the "Assertion failure: i < Length() (invalid array index)"
for "maps.ElementAt(mapIndex)" with mapIndex==-1 in the code below.
Maybe we shouldn't call RemoveFrame with the last row-group child in
the first place, but better safe than sorry.
[Attachment #685910](/attachment.cgi?id=685910&action=edit "Avoid crashing if the last row-group child frame was removed") -
Flags: review?(bzbarsky)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=815315#c3)• 12 years ago |
|  | |

Attached patch

[Make nsTableFrame::RemoveFrame remove all continuations of the removed child frame too](attachment.cgi?id=685911&action=diff)
— [Details](attachment.cgi?id=685911&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=815315&attachment=685911)

A few notes:
1. make nsTableFrame::RemoveFrame remove all continuations for the
given child frame too (as nsContainerFrame/BlockFrame does)
2. call DrainSelfOverflowList() for each new parent so that we'll
use the correct list in DoRemoveFrame
3. 1+2 makes us call MatchCellMapToColCache on each removed
row-group frame
1+2 is what caused "ASSERTION: overflow list w/o frames" since
we left a row-group on the overflow list.
3 is what caused "ASSERTION: invalid col index" and "ASSERTION:
column frames out of sync with cell map" because the table cellmap
was updated when we removed a row-group, but we left a remaining
row-group continuation in a table having a mismatching number of
frames in mColFrames.
<https://tbpl.mozilla.org/?tree=Try&rev=b0f460c804e9>
[Attachment #685911](/attachment.cgi?id=685911&action=edit "Make nsTableFrame::RemoveFrame remove all continuations of the removed child frame too") -
Flags: review?(bzbarsky)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=815315#c4)• 12 years ago |
|  | |

Comment on [attachment 685910](/attachment.cgi?id=685910 "Avoid crashing if the last row-group child frame was removed") [[details]](/attachment.cgi?id=685910&action=edit "Avoid crashing if the last row-group child frame was removed") [[diff]](/attachment.cgi?id=685910&action=diff "Avoid crashing if the last row-group child frame was removed") [[review]](/page.cgi?id=splinter.html&ignore=&bug=815315&attachment=685910)
Avoid crashing if the last row-group child frame was removed
r=me
[Attachment #685910](/attachment.cgi?id=685910&action=edit "Avoid crashing if the last row-group child frame was removed") -
Flags: review?(bzbarsky) → review+

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=815315#c5)• 12 years ago |
|  | |

Comment on [attachment 685911](/attachment.cgi?id=685911 "Make nsTableFrame::RemoveFrame remove all continuations of the removed child frame too") [[details]](/attachment.cgi?id=685911&action=edit "Make nsTableFrame::RemoveFrame remove all continuations of the removed child frame too") [[diff]](/attachment.cgi?id=685911&action=diff "Make nsTableFrame::RemoveFrame remove all continuations of the removed child frame too") [[review]](/page.cgi?id=splinter.html&ignore=&bug=815315&attachment=685911)
Make nsTableFrame::RemoveFrame remove all continuations of the removed child frame too
r=me, but does this make the cellmap sync stuff O(N^2)?
[Attachment #685911](/attachment.cgi?id=685911&action=edit "Make nsTableFrame::RemoveFrame remove all continuations of the removed child frame too") -
Flags: review?(bzbarsky) → review+

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=815315#c6)• 12 years ago |
|  | |

(In reply to Boris Zbarsky (:bz) from [comment #5](/show_bug.cgi?id=815315#c5 "RESOLVED FIXED - nsTableFrame doesn't deal with row-group continuations very well"))
> Comment on [attachment 685911](/attachment.cgi?id=685911 "Make nsTableFrame::RemoveFrame remove all continuations of the removed child frame too") [[details]](/attachment.cgi?id=685911&action=edit "Make nsTableFrame::RemoveFrame remove all continuations of the removed child frame too") [[diff]](/attachment.cgi?id=685911&action=diff "Make nsTableFrame::RemoveFrame remove all continuations of the removed child frame too") [[review]](/page.cgi?id=splinter.html&ignore=&bug=815315&attachment=685911)
> Make nsTableFrame::RemoveFrame remove all continuations of the removed child
> frame too
>
> r=me, but does this make the cellmap sync stuff O(N^2)?
Yeah, I suspect the block containing "cellMap->Synchronize" can be done once
for each table parent, rather than for each row-group continuation. Part of it
can perhaps be done just once, since there is only one nsTableCellMap for all
table continuations. I think table continuations in general are quite rare though
(only in Print mode so far) so let's do optimizations as a follow-up bug.
It'd be good to have a few days of baking this to make sure it's correct so far.

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=815315#c7)• 12 years ago |
|  | |

sec-other, since this bug is only hidden to not reveal details about [bug 812879](/show_bug.cgi?id=812879 "RESOLVED FIXED - Various things go wrong with page-break-inside: avoid (along with table, huge margins, float, overflow)"),
which fixed the root cause of the security issue. I don't think we need these
patches on branches.Whiteboard: sec-other

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=815315#c8)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/6e5da7fd6740>
<https://hg.mozilla.org/integration/mozilla-inbound/rev/aabc7c735fb0>
Filed [bug 817205](/show_bug.cgi?id=817205 "NEW - optimize nsTableFrame::DoRemoveFrame") to follow-up on optimizing this a bit.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=815315#c9)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/6e5da7fd6740>
<https://hg.mozilla.org/mozilla-central/rev/aabc7c735fb0>Status: NEW → RESOLVEDClosed: 12 years ago
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed)Flags: in-testsuite?Resolution: --- → FIXEDTarget Milestone: --- → mozilla20

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=815315#a875298_425645)• 12 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=815315#a875309_425645)• 12 years ago |

Keywords: [sec-other](/buglist.cgi?keywords=sec-other&resolution=---)Whiteboard: sec-other

|  | [bhavana bajaj [:bajaj]](/user_profile?user_id=448925) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=815315#a4933406_448925)• 12 years ago |

[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=815315#c10)• 12 years ago |
|  | |

[bug 812879](/show_bug.cgi?id=812879 "RESOLVED FIXED - Various things go wrong with page-break-inside: avoid (along with table, huge margins, float, overflow)") was 19 affected. Can I assume that this bug affected the shipped 19?

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=815315#c11)• 12 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #10](/show_bug.cgi?id=815315#c10 "RESOLVED FIXED - nsTableFrame doesn't deal with row-group continuations very well"))
> [bug 812879](/show_bug.cgi?id=812879 "RESOLVED FIXED - Various things go wrong with page-break-inside: avoid (along with table, huge margins, float, overflow)") was 19 affected. Can I assume that this bug affected the shipped
> 19?
Yes.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=815315#a10291104_280903)• 12 years ago |

[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected)Whiteboard: [adv-main20+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=815315#a31450446_1689)• 11 years ago |

Group: core-security

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=815315#c14)• 5 years ago |
|  | |

[Bugbug](https://github.com/mozilla/bugbug/) thinks this bug is a regression, but please revert this change in case of error.

Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=815315#a212344580_546716)• 5 years ago |

Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)
You need to [log in](/show_bug.cgi?id=815315&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Mats Palmgren (inactive)](/user_profile?user_id=5168)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from lists.opensuse.org_7a5daf11_20250125_151416.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/EFRUKBJDYC6NR5YPFWNJI2GTX2SUOQ22/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/EFRUKBJDYC6NR5YPFWNJI2GTX2SUOQ22/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/EFRUKBJDYC6NR5YPFWNJI2GTX2SUOQ22/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/EFRUKBJDYC6NR5YPFWNJI2GTX2SUOQ22/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/EFRUKBJDYC6NR5YPFWNJI2GTX2SUOQ22/#EFRUKBJDYC6NR5YPFWNJI2GTX2SUOQ22)

# [security-announce] openSUSE-SU-2013:0631-1: important: Mozilla Firefox and others: Update to 20.0/17.0.5 releases

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

5 Apr
2013

5 Apr
'13

16:06

openSUSE Security Update: Mozilla Firefox and others: Update to 20.0/17.0.5 releases
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2013:0631-1
Rating: important
References: #813026
Cross-References: CVE-2013-0788 CVE-2013-0789 CVE-2013-0792
CVE-2013-0793 CVE-2013-0794 CVE-2013-0795
CVE-2013-0796 CVE-2013-0800
Affected Products:
openSUSE 11.4
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes 8 vulnerabilities is now available.
Description:
The Mozilla suite received security and bugfix updates:
Firefox was updated to version 20.0. Thunderbird was
updated to version 17.0.5. Seamonkey was updated to version
2.17 mozilla-nss was updated to version 3.14.3.
mozilla-nspr was updated to version 4.9.6.
mozilla-nspr was updated to version 4.9.6:
\* aarch64 support
\* added PL\_SizeOfArenaPoolExcludingPool function
(bmo#807883)
\* Auto detect android api version for x86 (bmo#782214)
\* Initialize Windows CRITICAL\_SECTIONs without debug info
and with nonzero spin count (bmo#812085) Previous update
to version 4.9.5
\* bmo#634793: define NSPR's exact-width integer types
PRInt{N} and PRUint{N} types to match the <stdint.h>
exact-width integer types int{N}\_t and uint{N}\_t.
\* bmo#782815: passing 'int \*' to parameter of type
'unsigned int \*' in setsockopt().
\* bmo#822932: Port bmo#802527 (NDK r8b support for x86) to
NSPR.
\* bmo#824742: NSPR shouldn't require librt on Android.
\* bmo#831793: data race on lib->refCount in
PR\_UnloadLibrary.
mozilla-nss was updated to version 3.14.3:
\* disable tests with expired certificates
\* add SEC\_PKCS7VerifyDetachedSignatureAtTime using patch
from mozilla tree to fulfill Firefox 21 requirements
\* No new major functionality is introduced in this release.
This release is a patch release to address CVE-2013-1620
(bmo#822365)
\* "certutil -a" was not correctly producing ASCII output as
requested. (bmo#840714)
\* NSS 3.14.2 broke compilation with older versions of
sqlite that lacked the SQLITE\_FCNTL\_TEMPFILENAME file
control. NSS 3.14.3 now properly compiles when used with
older versions of sqlite (bmo#837799) - remove
system-sqlite.patch
\* add aarch64 support
\* added system-sqlite.patch (bmo#837799)
\* do not depend on latest sqlite just for a #define
\* enable system sqlite usage again
\* update to 3.14.2
\* required for Firefox >= 20
\* removed obsolete nssckbi update patch
\* MFSA 2013-40/CVE-2013-0791 (bmo#629816) Out-of-bounds
array read in CERT\_DecodeCertPackage
\* disable system sqlite usage since we depend on 3.7.15
which is not provided in any openSUSE distribution
\* add nss-sqlitename.patch to avoid any name clash
Changes in MozillaFirefox:
- update to Firefox 20.0 (bnc#813026)
\* requires NSPR 4.9.5 and NSS 3.14.3
\* MFSA 2013-30/CVE-2013-0788/CVE-2013-0789 Miscellaneous
memory safety hazards
\* MFSA 2013-31/CVE-2013-0800 (bmo#825721) Out-of-bounds
write in Cairo library
\* MFSA 2013-35/CVE-2013-0796 (bmo#827106) WebGL crash
with Mesa graphics driver on Linux
\* MFSA 2013-36/CVE-2013-0795 (bmo#825697) Bypass of SOW
protections allows cloning of protected nodes
\* MFSA 2013-37/CVE-2013-0794 (bmo#626775) Bypass of
tab-modal dialog origin disclosure
\* MFSA 2013-38/CVE-2013-0793 (bmo#803870) Cross-site
scripting (XSS) using timed history navigations
\* MFSA 2013-39/CVE-2013-0792 (bmo#722831) Memory
corruption while rendering grayscale PNG images
- use GStreamer 1.0 starting with 12.3
(mozilla-gstreamer-1.patch)
- build fixes for armv7hl:
\* disable debug build as armv7hl does not have enough
memory
\* disable webrtc on armv7hl as it is non-compiling
Changes in MozillaThunderbird:
- update to Thunderbird 17.0.5 (bnc#813026)
\* requires NSPR 4.9.5 and NSS 3.14.3
\* MFSA 2013-30/CVE-2013-0788/CVE-2013-0789 Miscellaneous
memory safety hazards
\* MFSA 2013-31/CVE-2013-0800 (bmo#825721) Out-of-bounds
write in Cairo library
\* MFSA 2013-35/CVE-2013-0796 (bmo#827106) WebGL crash
with Mesa graphics driver on Linux
\* MFSA 2013-36/CVE-2013-0795 (bmo#825697) Bypass of SOW
protections allows cloning of protected nodes
\* MFSA 2013-38/CVE-2013-0793 (bmo#803870) Cross-site
scripting (XSS) using timed history navigations
Changes in seamonkey:
- update to SeaMonkey 2.17 (bnc#813026)
\* requires NSPR 4.9.5 and NSS 3.14.3
\* MFSA 2013-30/CVE-2013-0788/CVE-2013-0789 Miscellaneous
memory safety hazards
\* MFSA 2013-31/CVE-2013-0800 (bmo#825721) Out-of-bounds
write in Cairo library
\* MFSA 2013-35/CVE-2013-0796 (bmo#827106) WebGL crash
with Mesa graphics driver on Linux
\* MFSA 2013-36/CVE-2013-0795 (bmo#825697) Bypass of SOW
protections allows cloning of protected nodes
\* MFSA 2013-37/CVE-2013-0794 (bmo#626775) Bypass of
tab-modal dialog origin disclosure
\* MFSA 2013-38/CVE-2013-0793 (bmo#803870) Cross-site
scripting (XSS) using timed history navigations
\* MFSA 2013-39/CVE-2013-0792 (bmo#722831) Memory
corruption while rendering grayscale PNG images
- use GStreamer 1.0 starting with 12.3
(mozilla-gstreamer-1.patch)
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 11.4:
zypper in -t patch 2013-58
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 11.4 (i586 x86\_64):
MozillaFirefox-20.0-69.1
MozillaFirefox-branding-upstream-20.0-69.1
MozillaFirefox-buildsymbols-20.0-69.1
MozillaFirefox-debuginfo-20.0-69.1
MozillaFirefox-debugsource-20.0-69.1
MozillaFirefox-devel-20.0-69.1
MozillaFirefox-translations-common-20.0-69.1
MozillaFirefox-translations-other-20.0-69.1
MozillaThunderbird-17.0.5-57.1
MozillaThunderbird-buildsymbols-17.0.5-57.1
MozillaThunderbird-debuginfo-17.0.5-57.1
MozillaThunderbird-debugsource-17.0.5-57.1
MozillaThunderbird-devel-17.0.5-57.1
MozillaThunderbird-devel-debuginfo-17.0.5-57.1
MozillaThunderbird-translations-common-17.0.5-57.1
MozillaThunderbird-translations-other-17.0.5-57.1
enigmail-1.5.1+17.0.5-57.1
enigmail-debuginfo-1.5.1+17.0.5-57.1
libfreebl3-3.14.3-58.1
libfreebl3-debuginfo-3.14.3-58.1
libsoftokn3-3.14.3-58.1
libsoftokn3-debuginfo-3.14.3-58.1
mozilla-nspr-4.9.6-24.1
mozilla-nspr-debuginfo-4.9.6-24.1
mozilla-nspr-debugsource-4.9.6-24.1
mozilla-nspr-devel-4.9.6-24.1
mozilla-nss-3.14.3-58.1
mozilla-nss-certs-3.14.3-58.1
mozilla-nss-certs-debuginfo-3.14.3-58.1
mozilla-nss-debuginfo-3.14.3-58.1
mozilla-nss-debugsource-3.14.3-58.1
mozilla-nss-devel-3.14.3-58.1
mozilla-nss-sysinit-3.14.3-58.1
mozilla-nss-sysinit-debuginfo-3.14.3-58.1
mozilla-nss-tools-3.14.3-58.1
mozilla-nss-tools-debuginfo-3.14.3-58.1
seamonkey-2.17-61.1
seamonkey-debuginfo-2.17-61.1
seamonkey-debugsource-2.17-61.1
seamonkey-dom-inspector-2.17-61.1
seamonkey-irc-2.17-61.1
seamonkey-translations-common-2.17-61.1
seamonkey-translations-other-2.17-61.1
seamonkey-venkman-2.17-61.1
- openSUSE 11.4 (x86\_64):
libfreebl3-32bit-3.14.3-58.1
libfreebl3-debuginfo-32bit-3.14.3-58.1
libsoftokn3-32bit-3.14.3-58.1
libsoftokn3-debuginfo-32bit-3.14.3-58.1
mozilla-nspr-32bit-4.9.6-24.1
mozilla-nspr-debuginfo-32bit-4.9.6-24.1
mozilla-nss-32bit-3.14.3-58.1
mozilla-nss-certs-32bit-3.14.3-58.1
mozilla-nss-certs-debuginfo-32bit-3.14.3-58.1
mozilla-nss-debuginfo-32bit-3.14.3-58.1
mozilla-nss-sysinit-32bit-3.14.3-58.1
mozilla-nss-sysinit-debuginfo-32bit-3.14.3-58.1
- openSUSE 11.4 (ia64):
libfreebl3-debuginfo-x86-3.14.3-58.1
libfreebl3-x86-3.14.3-58.1
libsoftokn3-debuginfo-x86-3.14.3-58.1
libsoftokn3-x86-3.14.3-58.1
mozilla-nspr-debuginfo-x86-4.9.6-24.1
mozilla-nspr-x86-4.9.6-24.1
mozilla-nss-certs-debuginfo-x86-3.14.3-58.1
mozilla-nss-certs-x86-3.14.3-58.1
mozilla-nss-debuginfo-x86-3.14.3-58.1
mozilla-nss-sysinit-debuginfo-x86-3.14.3-58.1
mozilla-nss-sysinit-x86-3.14.3-58.1
mozilla-nss-x86-3.14.3-58.1
References:
<http://support.novell.com/security/cve/CVE-2013-0788.html>
<http://support.novell.com/security/cve/CVE-2013-0789.html>
<http://support.novell.com/security/cve/CVE-2013-0792.html>
<http://support.novell.com/security/cve/CVE-2013-0793.html>
<http://support.novell.com/security/cve/CVE-2013-0794.html>
<http://support.novell.com/security/cve/CVE-2013-0795.html>
<http://support.novell.com/security/cve/CVE-2013-0796.html>
<http://support.novell.com/security/cve/CVE-2013-0800.html>
<https://bugzilla.novell.com/813026>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/EFRUKBJDYC6NR5YPFWNJI2GTX2SUOQ22/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/EFRUKBJDYC6NR5YPFWNJI2GTX2SUOQ22/#EFRUKBJDYC6NR5YPFWNJI2GTX2SUOQ22)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from bugzilla.mozilla.org_164508ed_20250125_151420.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/808736)
* [XML](/show_bug.cgi?ctype=xml&id=808736)

Closed
[Bug 808736](/show_bug.cgi?id=808736)

Opened 12 years ago
Closed 12 years ago

# sJSGCThingRootCount maybe can in theory be abused to trigger nsLayoutStatics::Shutdown()

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

sJSGCThingRootCount maybe can in theory be abused to trigger nsLayoutStatics::Shutdown()

## Categories

### (Core :: DOM: Core & HTML, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML#DOM%3A%20Core%20%26%20HTML)

DOM: Core & HTML
▾

Core :: DOM: Core & HTML
Issues in DOM tree [https://dom.spec.whatwg.org](https://dom.spec.whatwg.org/) & HTML [https://html.spec.whatwg.org](https://html.spec.whatwg.org/) that do not fit into any other DOM or HTML component or which span multiple DOM or HTML components.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
WORKSFORME

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

WORKSFORME

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox17 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=wontfix) |
| firefox18 | --- | [affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected) |
| firefox19 | --- | [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected) |
| firefox20 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed) |
| firefox-esr10 | --- | [wontfix](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=wontfix) |
| firefox-esr17 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=wontfix) |
| b2g18 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=fixed) |
| b2g18-v1.0.0 | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g18_1_0_0&o1=equals&v1=wontfix) |
| b2g18-v1.0.1 | --- | [fixed](/buglist.cgi?f1=cf_status_b2g18_1_0_1&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox17 |  | wontfix |
| firefox18 |  | affected |
| firefox19 |  | affected |
| firefox20 |  | fixed |
| firefox-esr10 |  | wontfix |
| firefox-esr17 |  | wontfix |
| b2g18 |  | fixed |
| b2g18-v1.0.0 |  | wontfix |
| b2g18-v1.0.1 |  | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: mccr8, Unassigned)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

*Unassigned*

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=40)  [mccr8](/user_profile?user_id=406194)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/5111b810214a00377104f5ad3efefa26?d=mm&size=40)  [sefeng](/user_profile?user_id=625922)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[811206](/show_bug.cgi?id=811206 "RESOLVED FIXED - Fix sJSGCThingRootCount")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=808736&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=808736)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-low, Whiteboard: [fixed by bug 811206][adv-main20+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[fixed by bug 811206][adv-main20+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=808736#c0)• 12 years ago |
|  | |

Whenever we call nsContentUtils::HoldJSObjects, we increment sJSGCThingRootCount, and call nsLayoutStatics::AddRef() if the count was initially 0. Whenever we call nsContentUtils::DropJSObjects, we decrement the count, and call nsLayoutStatics::Release() if the count ends up at 0.
If the static release hits 0, then a bunch of shutdown stuff gets triggered.
The problem here is that there's no checking that the number of calls to HOLD is actually balanced with the number of DROP calls. I noticed that with AudioContext (and probably any other wrapper cached object that also have JS objects) we can end up calling DROP multiple times for a single object, once if the object is preserved, for the wrapper, and once for the extra JS stuff I guess.
Thus, by creating and destroying an AudioContext, we can cause sJSGCThingRootCount to decrease. If we do this enough, eventually the count will be 0, and we'll call nsLayoutStatics::Release(). This is probably not a huge deal is isolation, because at worst it will slightly mess up shutdown. But we can try to do this repeatedly to cause it to happen otherwise.
Note that we have to do this without calling nsContentUtils::HoldJSObjects when the refcount is 0, because that will just cause nsLayoutStatics::AddRef() to trigger again, thwarting us.
But, once it is dropping past zero, we can just keep going, then the count will underflow and up at a large value. Thus for every 4.3 billion AudioContexts we create and destroy, we can cause the static count to drop. They aren't alive at the same time (though you'd want to have a bunch alive at the same time to reduce the chance we call HOLD when the count is exactly zero).
This doesn't seem like a practical attack to me, but I have see the count underflow, so there's some kind of issue here we should fix.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=808736#c1)• 12 years ago |
|  | |

I'm going to mark this as sec-low, because even if we can generate and destroy 100,000 audiocontexts a second, it would still take 12 hours to trigger the second nsLayoutStatics::Release()...Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=808736#a935912_406194)• 12 years ago |

Depends on: [811206](/show_bug.cgi?id=811206 "RESOLVED FIXED - Fix sJSGCThingRootCount")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=808736#a1964498_406194)• 12 years ago |

Status: NEW → RESOLVEDClosed: 12 years agoResolution: --- → WORKSFORMEWhiteboard: [fixed by bug 811206]

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=808736#a1964547_406194)• 12 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=wontfix)
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=wontfix)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected)
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=808736#a10556339_425645)• 12 years ago |

[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=wontfix)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=808736#a10556468_406194)• 12 years ago |

[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=fixed)
[status-b2g18-v1.0.0](/buglist.cgi?f1=cf_status_b2g18_1_0_0&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_b2g18_1_0_0&o1=equals&v1=wontfix)
[status-b2g18-v1.0.1](/buglist.cgi?f1=cf_status_b2g18_1_0_1&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_b2g18_1_0_1&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=808736#a11848608_280903)• 12 years ago |

Whiteboard: [fixed by bug 811206] → [fixed by bug 811206][adv-main20+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=808736#a12372826_1689)• 12 years ago |

Group: core-security

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=808736#a200335368_1)• 6 years ago |

Component: DOM → DOM: Core & HTML
You need to [log in](/show_bug.cgi?id=808736&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑



=== Content from bugzilla.mozilla.org_54d2435d_20250125_151422.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/817841)
* [XML](/show_bug.cgi?ctype=xml&id=817841)

Closed
[Bug 817841](/show_bug.cgi?id=817841)

Opened 12 years ago
Closed 12 years ago

# Race condition deleting nsDOMMediaStream via proxying to MainThread

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Race condition deleting nsDOMMediaStream via proxying to MainThread

## Categories

### (Core :: WebRTC: Audio/Video, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=WebRTC%3A%20Audio%2FVideo#WebRTC%3A%20Audio%2FVideo)

WebRTC: Audio/Video
▾

Core :: WebRTC: Audio/Video
Bugs in WebRTC audio and video capture, handling, echo cancellation, encoding, and playback
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC%3A%20Audio%2FVideo&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC%3A%20Audio%2FVideo&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=WebRTC%3A%20Audio%2FVideo)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla20

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox18 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=unaffected) |
| firefox19 | --- | [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected) |
| firefox20 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed) |
| firefox-esr10 | --- | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |
| firefox-esr17 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox18 |  | unaffected |
| firefox19 |  | affected |
| firefox20 |  | fixed |
| firefox-esr10 |  | unaffected |
| firefox-esr17 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jesup, Assigned: jesup)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=40)  [jesup](/user_profile?user_id=11539)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/fba16ea71cd5ef27991fcea651e8cd56?d=mm&size=40)  [jsmith](/user_profile?user_id=432443)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=40)  [jesup](/user_profile?user_id=11539)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/9362a14d9b87a3935eb16cfc834ed51f?d=mm&size=40)  [jib](/user_profile?user_id=456498)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[817976](/show_bug.cgi?id=817976 "RESOLVED DUPLICATE - crash in mozilla::MediaOperationRunnable::~MediaOperationRunnable with abort message: \"Main-thread-only object used off the main thread\"")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: crash, csectype-race, sec-high, Whiteboard: [qa-][adv-main20+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-race](/buglist.cgi?keywords=csectype-race&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[qa-][adv-main20+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [jsmith](/user_profile?user_id=432443) | [in-testsuite](#c8 "12 years ago") | - |
| --- | --- | --- |
| [jsmith](/user_profile?user_id=432443) | in-testsuite | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Proxy deletion of nsDOMMediaStreams with NS\_ProxyRelease()](/attachment.cgi?id=688006)  [12 years ago](#c1)  [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)   3.72 KB, patch | roc : [review+](#a6049_5038 "12 years ago") | [Details](/attachment.cgi?id=688006&action=edit) | [Diff](/attachment.cgi?id=688006&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=817841&attachment=688006) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=817841#c0)• 12 years ago |
|  | |

We have a number of hard-to-reproduce reports of crashes due to a Release off-main-thread in ~MediaOperationRunnable(), which deletes a nsDOMMediaStream (which is a cycle-collected object, and thus main-thread only).
It tries to proxy to mainthread by resending itself there and letting the post-Run release kill it, but if MainThread runs \*before\* the off-main-thread Run() exists, it gets deleted off-main-thread (boom).
A better solution (though it means allocating) is to proxy to main thread just the Release() via NS\_ProxyRelease(). This code isn't a performance hotspot so the alloc is not a big deal.

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=817841#c1)• 12 years ago |
|  | |

Attached patch

[Proxy deletion of nsDOMMediaStreams with NS\_ProxyRelease()](attachment.cgi?id=688006&action=diff)
— [Details](attachment.cgi?id=688006&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=817841&attachment=688006)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=817841#c2)• 12 years ago |
|  | |

Comment on [attachment 688006](/attachment.cgi?id=688006 "Proxy deletion of nsDOMMediaStreams with NS_ProxyRelease()") [[details]](/attachment.cgi?id=688006&action=edit "Proxy deletion of nsDOMMediaStreams with NS_ProxyRelease()") [[diff]](/attachment.cgi?id=688006&action=diff "Proxy deletion of nsDOMMediaStreams with NS_ProxyRelease()") [[review]](/page.cgi?id=splinter.html&ignore=&bug=817841&attachment=688006)
Proxy deletion of nsDOMMediaStreams with NS\_ProxyRelease()
Seems to work fine for me; I don't have a working reproducible case (though p.franc does I think) so I can't verify it fixes the problem directly.
[Attachment #688006](/attachment.cgi?id=688006&action=edit "Proxy deletion of nsDOMMediaStreams with NS_ProxyRelease()") -
Flags: review?(roc)

|  | [Robert O'Callahan (:roc) (email my personal email if necessary)](/user_profile?user_id=5038) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=817841#a6049_5038)• 12 years ago |

[Attachment #688006](/attachment.cgi?id=688006&action=edit "Proxy deletion of nsDOMMediaStreams with NS_ProxyRelease()") -
Flags: review?(roc) → review+

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=817841#c3)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/d9bcbec33260>
Once baked we should consider uplift to Aurora
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=unaffected)
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected)Target Milestone: --- → mozilla20

|  | [Jason Duell](/user_profile?user_id=334931) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=817841#c4)• 12 years ago |
|  | |

backed out (f88a7f4b3792) for compiler error (warning->error: comma at end of enum list) and relanded: (I hope that's acceptable procedure: wanted to make sure we don't repeat same problem on aurora/beta if we copy patch to them)
<https://hg.mozilla.org/integration/mozilla-inbound/rev/857e8fdd2d5d>

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=817841#c5)• 12 years ago |
|  | |

As per IRC: thanks

|  | [Henrik Skupin [:whimboo][⌚️UTC+2]](/user_profile?user_id=76551) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=817841#c6)• 12 years ago |
|  | |

Looks like [bug 817976](/show_bug.cgi?id=817976 "RESOLVED DUPLICATE - crash in mozilla::MediaOperationRunnable::~MediaOperationRunnable with abort message: \"Main-thread-only object used off the main thread\"") is a dupe, right?

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=817841#c7)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/857e8fdd2d5d>Status: ASSIGNED → RESOLVEDClosed: 12 years ago
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [Jason Smith [:jsmith]](/user_profile?user_id=432443) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=817841#c8)• 12 years ago |
|  | |

[comment 2](/show_bug.cgi?id=817841#c2 "RESOLVED FIXED - Race condition deleting nsDOMMediaStream via proxying to MainThread") implies there isn't a reproducible test case. If there is one, feel free to comment to explain it.Flags: in-testsuite-Whiteboard: [qa-]

|  | [Henrik Skupin [:whimboo][⌚️UTC+2]](/user_profile?user_id=76551) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=817841#c10)• 12 years ago |
|  | |

Test cases from crash reports are:
<http://mozilla.github.com/webrtc-landing/gum_test.html>
<http://alexandre.alapetite.fr/doc-alex/html5-webcam/>
<https://apprtc.appspot.com/>
<http://mozilla.github.com/webrtc-landing/pc_test.html>

|  | [Jason Smith [:jsmith]](/user_profile?user_id=432443) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=817841#c11)• 12 years ago |
|  | |

Sounds like the best course of action here is probably then is to only reopen if we reproduce this crash again. It looks like the URLs in [comment 10](/show_bug.cgi?id=817841#c10 "RESOLVED FIXED - Race condition deleting nsDOMMediaStream via proxying to MainThread") imply that general gum usage could reproduce this.

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=817841#a262549_425645)• 12 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected)

|  | [Pavel Franc - Mozilla.cz](/user_profile?user_id=48948) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=817841#c12)• 12 years ago |
|  | |

I can not reproduce this particular crash anymore with current nightly.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=817841#a9660096_280903)• 12 years ago |

Whiteboard: [qa-] → [qa-][adv-main20+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=817841#a9944728_1689)• 12 years ago |

Keywords: [crash](/buglist.cgi?keywords=crash&resolution=---),
[csec-race](/buglist.cgi?keywords=csec-race&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase-wanted](/buglist.cgi?keywords=testcase-wanted&resolution=---)

|  | [Jason Smith [:jsmith]](/user_profile?user_id=432443) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=817841#c13)• 12 years ago |
|  | |

Already fixed at this point, no need to get a reduced test case here.Keywords: [testcase-wanted](/buglist.cgi?keywords=testcase-wanted&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=817841#a61877473_1689)• 10 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=817841&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_5ccce010_20250126_094838.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/842687)
* [XML](/show_bug.cgi?ctype=xml&id=842687)

Closed
[Bug 842687](/show_bug.cgi?id=842687)

Opened 12 years ago
Closed 12 years ago

# Stack corruption in plug-in code caused by PRBool to bool switch

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Stack corruption in plug-in code caused by PRBool to bool switch

## Categories

### (Core Graveyard :: Plug-ins, defect, P1)

[Product:](/describecomponents.cgi?product=Core%20Graveyard)

Core Graveyard
▾

Core Graveyard
Old, retired Core components
[See Open Bugs in This Product](/buglist.cgi?product=Core%20Graveyard&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core%20Graveyard)
Watch This Product

[Component:](/describecomponents.cgi?product=Core%20Graveyard&component=Plug-ins#Plug-ins)

Plug-ins
▾

Core Graveyard :: Plug-ins
Bugs in core Mozilla code that supports registering and using plug-ins. For bugs in specific plugins, please file those bugs under External Software Affecting Firefox.
[See Open Bugs in This Component](/buglist.cgi?product=Core%20Graveyard&component=Plug-ins&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core%20Graveyard&component=Plug-ins&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core%20Graveyard&component=Plug-ins)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

ARM

Android

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

## Tracking

### (firefox19+ affected, firefox20+ fixed, firefox21+ fixed, firefox22+ fixed, firefox-esr17- unaffected, b2g18 unaffected, b2g18-v1.0.0 affected, b2g18-v1.0.1 affected, relnote-firefox -)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla22

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox19 | [+](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%2B) | [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected) |
| firefox20 | [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed) |
| firefox21 | [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed) |
| firefox22 | [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=fixed) |
| firefox-esr17 | [-](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=-) | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected) |
| b2g18 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected) |
| b2g18-v1.0.0 | --- | [affected](/buglist.cgi?f1=cf_status_b2g18_1_0_0&o1=equals&v1=affected) |
| b2g18-v1.0.1 | --- | [affected](/buglist.cgi?f1=cf_status_b2g18_1_0_1&o1=equals&v1=affected) |
| relnote-firefox | --- | [-](/buglist.cgi?f1=cf_tracking_firefox_relnote&o1=equals&v1=-) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox19 | + | affected |
| firefox20 | + | fixed |
| firefox21 | + | fixed |
| firefox22 | + | fixed |
| firefox-esr17 | - | unaffected |
| b2g18 |  | unaffected |
| b2g18-v1.0.0 |  | affected |
| b2g18-v1.0.1 |  | affected |
| relnote-firefox |  | - |

## People

### (Reporter: jchen, Assigned: jchen)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/bc062869d013a3c67a222cdf27b430bc?d=mm&size=40)  [jchen](/user_profile?user_id=281508)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/bc062869d013a3c67a222cdf27b430bc?d=mm&size=40)  [jchen](/user_profile?user_id=281508)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](extensions/Gravatar/web/default.jpg)  [jimm](/user_profile?user_id=279663)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[675553](/show_bug.cgi?id=675553 "RESOLVED FIXED - Switch from PRBool to bool"), [827171](/show_bug.cgi?id=827171 "RESOLVED FIXED - crash in nsPluginStreamListenerPeer::OnStartRequest")

Dependency [tree](/showdependencytree.cgi?id=842687&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=842687)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-critical, Whiteboard: [Android only][adv-main20+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[Android only][adv-main20+]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [jchen](/user_profile?user_id=281508) | [in-testsuite](#c15 "12 years ago") | + |
| --- | --- | --- |
| [jchen](/user_profile?user_id=281508) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Use uint32 instead of bool for certain plug-in values (v1)](/attachment.cgi?id=716111)  [12 years ago](#c12)  [(inactive) Jim Chen [:jchen] [:darchons]](/user_profile?user_id=281508)   2.87 KB, patch | benjamin : [review+](#a85427_7044 "12 years ago")  bajaj : [approval-mozilla-aurora+](#c25 "12 years ago")  bajaj : [approval-mozilla-beta+](#c25 "12 years ago") | [Details](/attachment.cgi?id=716111&action=edit) | [Diff](/attachment.cgi?id=716111&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=842687&attachment=716111) |
| --- | --- | --- |
| [Use 4-byte writes for outgoing bool values in NPP\_GetValues](/attachment.cgi?id=716140)  [12 years ago](#c14)  [Georg Fritzsche [:gfritzsche]](/user_profile?user_id=439671)   1.27 KB, patch | benjamin : [review+](#a85445_7044 "12 years ago")  bajaj : [approval-mozilla-aurora+](#a515015_448925 "12 years ago")  bajaj : [approval-mozilla-beta+](#a515015_448925 "12 years ago") | [Details](/attachment.cgi?id=716140&action=edit) | [Diff](/attachment.cgi?id=716140&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=842687&attachment=716140) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [(inactive) Jim Chen [:jchen] [:darchons]](/user_profile?user_id=281508)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=842687#c0)• 12 years ago |
|  | |

Filed as security bug because "stack corruption" == security in my head :)
This is the cause of Fennec crash, [bug 827171](/show_bug.cgi?id=827171 "RESOLVED FIXED - crash in nsPluginStreamListenerPeer::OnStartRequest"). Basically PRBool is 4-bytes and bool is 1-byte, but as part of the PRBool-to-bool conversion, we are passing 1-byte bools to plugins that still expect 4-byte PRBools. Depending on ordering and packing of variables, this could end up corrupting another variable which is the case in [Bug 827171](/show_bug.cgi?id=827171 "RESOLVED FIXED - crash in nsPluginStreamListenerPeer::OnStartRequest").
I see at least two cases of this in nsPluginStreamListenerPeer,
[1] <http://mxr.mozilla.org/mozilla-central/source/dom/plugins/base/nsPluginStreamListenerPeer.cpp#129>
[2] <http://mxr.mozilla.org/mozilla-central/source/dom/plugins/base/nsPluginStreamListenerPeer.cpp#479>
But there could be more instances.

|  | [John Schoenick [:johns]](/user_profile?user_id=429621) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=842687#c1)• 12 years ago |
|  | |

We'll that's... bad
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%3F)
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%3F)
[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%3F)
[tracking-firefox22](/buglist.cgi?f1=cf_tracking_firefox22&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%3F)
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=%3F)

|  | [James Willcox (:snorp) (jwillcox@mozilla.com) (he/him)](/user_profile?user_id=227322) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=842687#c2)• 12 years ago |
|  | |

There are some other names for NPP\_GetValue that return bool, but looks like we don't use these. I agree that changing bool back to PRBool or some other 32 bit type should fix things.

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=842687#c3)• 12 years ago |
|  | |

Strange. I would have thought this stuff in NPAPI would be represented by a NPBool, which in npapi.h is:
typedef unsigned char NPBool;
which I understand is binary-equivalent to bool with most/all compilers we care about these days. Is it at all possible our underlying plugin stuff is using PRBool where it should have used NPBool?

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=842687#c4)• 12 years ago |
|  | |

Dammit, again! We have explicit code to avoid this in the OOPP codepath, see e.g. <http://mxr.mozilla.org/mozilla-central/source/dom/plugins/ipc/PluginInstanceChild.cpp#604>
I'm going to mark this critical (for Android only) even though in practice it would be extremely difficult to construct an exploit. It doesn't affect desktop because we use OOPP by default there and get the behavior correct.Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)Priority: -- → P1

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=842687#c5)• 12 years ago |
|  | |

Oh, and note that even though the NPAPI officially should use 1-byte type, plugins do all sorts of weird shit and we should expect a 4-byte write at the address.

|  | [James Willcox (:snorp) (jwillcox@mozilla.com) (he/him)](/user_profile?user_id=227322) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=842687#c6)• 12 years ago |
|  | |

(In reply to Jeff Walden [:Waldo] (remove +bmo to email) from [comment #3](/show_bug.cgi?id=842687#c3 "RESOLVED FIXED - Stack corruption in plug-in code caused by PRBool to bool switch"))
> Strange. I would have thought this stuff in NPAPI would be represented by a
> NPBool, which in npapi.h is:
>
> typedef unsigned char NPBool;
>
> which I understand is binary-equivalent to bool with most/all compilers we
> care about these days. Is it at all possible our underlying plugin stuff is
> using PRBool where it should have used NPBool?
This call goes straight into the plugin, so it depends entirely on the plugin behavior. Apparently Flash on Android expects a 32 bit value.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842687#a3715_406194)• 12 years ago |

[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=affected)
[status-b2g18-v1.0.0](/buglist.cgi?f1=cf_status_b2g18_1_0_0&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g18_1_0_0&o1=equals&v1=affected)
[status-b2g18-v1.0.1](/buglist.cgi?f1=cf_status_b2g18_1_0_1&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g18_1_0_1&o1=equals&v1=affected)
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected)
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected)OS: Mac OS X → AndroidHardware: x86 → ARM

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842687#a3758_406194)• 12 years ago |

Whiteboard: [Android only]

|  | [Georg Fritzsche [:gfritzsche]](/user_profile?user_id=439671) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=842687#c7)• 12 years ago |
|  | |

I only found two more places that need fixing:
<http://dxr.mozilla.org/mozilla-central/dom/plugins/ipc/PluginInstanceChild.cpp#l1265>
<http://dxr.mozilla.org/mozilla-central/dom/plugins/ipc/PluginModuleParent.cpp#l1414>
... using this query:
<http://dxr.mozilla.org/search?tree=mozilla-central&q=path%3Adom%2Fplugins%2F+getvalue&redirect=true>
I can't see another affected NPP function, but maybe i'm missing something.
AFAIR we do have regular test runs on ASAN-enabled builds? If so, we could just make the test-plugin do a 4-byte write where-ever this can happen and have it caught by the ASAN builds if regressed.

|  | [Georg Fritzsche [:gfritzsche]](/user_profile?user_id=439671) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=842687#c8)• 12 years ago |
|  | |

(In reply to Georg Fritzsche [:gfritzsche] from [comment #7](/show_bug.cgi?id=842687#c7 "RESOLVED FIXED - Stack corruption in plug-in code caused by PRBool to bool switch"))
> I only found two more places that need fixing:
> <http://dxr.mozilla.org/mozilla-central/dom/plugins/ipc/PluginInstanceChild>.
> cpp#l1265
> <http://dxr.mozilla.org/mozilla-central/dom/plugins/ipc/PluginModuleParent>.
> cpp#l1414
Nevermind, those are covered or irrelevant.

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=842687#c9)• 12 years ago |
|  | |

Tracking for all upcoming releases, but this is unlikely to be taken in FF19 or a FF19 chemspill (unless there are extreme circumstances here such as visibility or being a recent regression).
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%2B)
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B)
[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B)
[tracking-firefox22](/buglist.cgi?f1=cf_tracking_firefox22&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B)

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=842687#c10)• 12 years ago |
|  | |

The only reason to put this up the trains is because it is a topcrash. Actually constructing an exploit for this is probably impossible.

|  | [Georg Fritzsche [:gfritzsche]](/user_profile?user_id=439671) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=842687#c11)• 12 years ago |
|  | |

(In reply to Georg Fritzsche [:gfritzsche] from [comment #7](/show_bug.cgi?id=842687#c7 "RESOLVED FIXED - Stack corruption in plug-in code caused by PRBool to bool switch"))
> AFAIR we do have regular test runs on ASAN-enabled builds? If so, we could
> just make the test-plugin do a 4-byte write where-ever this can happen and
> have it caught by the ASAN builds if regressed.
Confirmed this, decoder is currently running them daily on try until releng has this integrated in an automated fashion.

|  | [(inactive) Jim Chen [:jchen] [:darchons]](/user_profile?user_id=281508)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=842687#c12)• 12 years ago |
|  | |

Attached patch

[Use uint32 instead of bool for certain plug-in values (v1)](attachment.cgi?id=716111&action=diff)
— [Details](attachment.cgi?id=716111&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=842687&attachment=716111)

This patch changes bool to uint32\_t, which matches the OOPP codepath
[Attachment #716111](/attachment.cgi?id=716111&action=edit "Use uint32 instead of bool for certain plug-in values (v1)") -
Flags: review?(benjamin)

|  | [(inactive) Jim Chen [:jchen] [:darchons]](/user_profile?user_id=281508)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=842687#c13)• 12 years ago |
|  | |

(In reply to Georg Fritzsche [:gfritzsche] from [comment #11](/show_bug.cgi?id=842687#c11 "RESOLVED FIXED - Stack corruption in plug-in code caused by PRBool to bool switch"))
> (In reply to Georg Fritzsche [:gfritzsche] from [comment #7](/show_bug.cgi?id=842687#c7 "RESOLVED FIXED - Stack corruption in plug-in code caused by PRBool to bool switch"))
> > AFAIR we do have regular test runs on ASAN-enabled builds? If so, we could
> > just make the test-plugin do a 4-byte write where-ever this can happen and
> > have it caught by the ASAN builds if regressed.
>
> Confirmed this, decoder is currently running them daily on try until releng
> has this integrated in an automated fashion.
I'm not familiar with ASAN or the test plugin. Can you file a bug for adding the test?Assignee: nobody → nchenStatus: NEW → ASSIGNED

|  | [Georg Fritzsche [:gfritzsche]](/user_profile?user_id=439671) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=842687#c14)• 12 years ago |
|  | |

Attached patch

[Use 4-byte writes for outgoing bool values in NPP\_GetValues](attachment.cgi?id=716140&action=diff)
— [Details](attachment.cgi?id=716140&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=842687&attachment=716140)

Just putting the minor test modification up here if that's alright.
[Attachment #716140](/attachment.cgi?id=716140&action=edit "Use 4-byte writes for outgoing bool values in NPP_GetValues") -
Flags: review?(benjamin)

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842687#a85427_7044)• 12 years ago |

[Attachment #716111](/attachment.cgi?id=716111&action=edit "Use uint32 instead of bool for certain plug-in values (v1)") -
Flags: review?(benjamin) → review+

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842687#a85445_7044)• 12 years ago |

[Attachment #716140](/attachment.cgi?id=716140&action=edit "Use 4-byte writes for outgoing bool values in NPP_GetValues") -
Flags: review?(benjamin) → review+

|  | [(inactive) Jim Chen [:jchen] [:darchons]](/user_profile?user_id=281508)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=842687#c15)• 12 years ago |
|  | |

Commit: <https://hg.mozilla.org/integration/mozilla-inbound/rev/b12d2ab1a3e2>
Test: <https://hg.mozilla.org/integration/mozilla-inbound/rev/1641778f1619>
Thanks for writing the test, Georg!Flags: in-testsuite+Target Milestone: --- → mozilla22

|  | [Mark Finkle (:mfinkle) (use needinfo?)](/user_profile?user_id=252194) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=842687#c16)• 12 years ago |
|  | |

With this crash affecting all the way to Fx19, what's the likelihood of uplifting?

|  | [Mark Finkle (:mfinkle) (use needinfo?)](/user_profile?user_id=252194) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=842687#c17)• 12 years ago |
|  | |

Benjamin told me on IRC that we might be OK with uplifting these patches to Aurora and Beta.
Jim and Georg - What's the risk? If you think it's OK could you request approval?

|  | [(inactive) Jim Chen [:jchen] [:darchons]](/user_profile?user_id=281508)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=842687#c18)• 12 years ago |
|  | |

(In reply to Mark Finkle (:mfinkle) from [comment #17](/show_bug.cgi?id=842687#c17 "RESOLVED FIXED - Stack corruption in plug-in code caused by PRBool to bool switch"))
> Benjamin told me on IRC that we might be OK with uplifting these patches to
> Aurora and Beta.
>
> Jim and Georg - What's the risk? If you think it's OK could you request
> approval?
I think Aurora and Beta sound good. This was the #1 topcrash for Aurora, now Beta.
There is no risk for this, but since we're early in the cycle, I was thinking about waiting a few days and first confirming we stop getting more crashes on Nightly.

|  | [Georg Fritzsche [:gfritzsche]](/user_profile?user_id=439671) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=842687#c19)• 12 years ago |
|  | |

(In reply to Jim Chen [:jchen :nchen] from [comment #18](/show_bug.cgi?id=842687#c18 "RESOLVED FIXED - Stack corruption in plug-in code caused by PRBool to bool switch"))
> There is no risk for this
+1, i don't think this really needs to wait long.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=842687#c20)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/b12d2ab1a3e2>
<https://hg.mozilla.org/mozilla-central/rev/1641778f1619>Status: ASSIGNED → RESOLVEDClosed: 12 years ago
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=842687#c21)• 12 years ago |
|  | |

We're not shipping an Android ESR so Firefox 17 ESR Desktop versions should not need this fix per [comment 4](/show_bug.cgi?id=842687#c4 "RESOLVED FIXED - Stack corruption in plug-in code caused by PRBool to bool switch").
b2g18 doesn't support plugins and also should not need this fix.
[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected)
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=-)

|  | [(inactive) Jim Chen [:jchen] [:darchons]](/user_profile?user_id=281508)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=842687#c22)• 12 years ago |
|  | |

Comment on [attachment 716111](/attachment.cgi?id=716111 "Use uint32 instead of bool for certain plug-in values (v1)") [[details]](/attachment.cgi?id=716111&action=edit "Use uint32 instead of bool for certain plug-in values (v1)") [[diff]](/attachment.cgi?id=716111&action=diff "Use uint32 instead of bool for certain plug-in values (v1)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=842687&attachment=716111)
Use uint32 instead of bool for certain plug-in values (v1)
Only crashes over last 7 days are before this landed; so requesting uplift. Should I request to uplift the test too?
[Approval Request Comment]
Bug caused by (feature/regressing bug #): N/A
User impact if declined: Random stack corruption / crash when using Flash on Android
Testing completed (on m-c, etc.): m-c
Risk to taking this patch (and alternatives if risky): No risk; patch only fixes crash and does not impact functionality in any way.
String or UUID changes made by this patch: None
[Attachment #716111](/attachment.cgi?id=716111&action=edit "Use uint32 instead of bool for certain plug-in values (v1)") -
Flags: approval-mozilla-beta?
[Attachment #716111](/attachment.cgi?id=716111&action=edit "Use uint32 instead of bool for certain plug-in values (v1)") -
Flags: approval-mozilla-aurora?

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=842687#c23)• 12 years ago |
|  | |

Uplift the test assuming it applies, yes.

|  | [Georg Fritzsche [:gfritzsche]](/user_profile?user_id=439671) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=842687#c24)• 12 years ago |
|  | |

Comment on [attachment 716140](/attachment.cgi?id=716140 "Use 4-byte writes for outgoing bool values in NPP_GetValues") [[details]](/attachment.cgi?id=716140&action=edit "Use 4-byte writes for outgoing bool values in NPP_GetValues") [[diff]](/attachment.cgi?id=716140&action=diff "Use 4-byte writes for outgoing bool values in NPP_GetValues") [[review]](/page.cgi?id=splinter.html&ignore=&bug=842687&attachment=716140)
Use 4-byte writes for outgoing bool values in NPP\_GetValues
[Approval Request Comment]
Bug caused by (feature/regressing bug #): See [comment 22](/show_bug.cgi?id=842687#c22 "RESOLVED FIXED - Stack corruption in plug-in code caused by PRBool to bool switch").
User impact if declined: n/a, this patch only provides test-coverage for the issue.
Testing completed (on m-c, etc.): See [comment 22](/show_bug.cgi?id=842687#c22 "RESOLVED FIXED - Stack corruption in plug-in code caused by PRBool to bool switch").
Risk to taking this patch (and alternatives if risky): None.
String or UUID changes made by this patch: None.
[Attachment #716140](/attachment.cgi?id=716140&action=edit "Use 4-byte writes for outgoing bool values in NPP_GetValues") -
Flags: approval-mozilla-beta?
[Attachment #716140](/attachment.cgi?id=716140&action=edit "Use 4-byte writes for outgoing bool values in NPP_GetValues") -
Flags: approval-mozilla-aurora?

|  | [bhavana bajaj [:bajaj]](/user_profile?user_id=448925) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=842687#c25)• 12 years ago |
|  | |

Comment on [attachment 716111](/attachment.cgi?id=716111 "Use uint32 instead of bool for certain plug-in values (v1)") [[details]](/attachment.cgi?id=716111&action=edit "Use uint32 instead of bool for certain plug-in values (v1)") [[diff]](/attachment.cgi?id=716111&action=diff "Use uint32 instead of bool for certain plug-in values (v1)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=842687&attachment=716111)
Use uint32 instead of bool for certain plug-in values (v1)
low risk patch helps fixing a top-crasher . Approving for uplift on aurora/beta
[Attachment #716111](/attachment.cgi?id=716111&action=edit "Use uint32 instead of bool for certain plug-in values (v1)") -
Flags: approval-mozilla-beta?
[Attachment #716111](/attachment.cgi?id=716111&action=edit "Use uint32 instead of bool for certain plug-in values (v1)") -
Flags: approval-mozilla-beta+
[Attachment #716111](/attachment.cgi?id=716111&action=edit "Use uint32 instead of bool for certain plug-in values (v1)") -
Flags: approval-mozilla-aurora?
[Attachment #716111](/attachment.cgi?id=716111&action=edit "Use uint32 instead of bool for certain plug-in values (v1)") -
Flags: approval-mozilla-aurora+

|  | [bhavana bajaj [:bajaj]](/user_profile?user_id=448925) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842687#a515015_448925)• 12 years ago |

[Attachment #716140](/attachment.cgi?id=716140&action=edit "Use 4-byte writes for outgoing bool values in NPP_GetValues") -
Flags: approval-mozilla-beta?
[Attachment #716140](/attachment.cgi?id=716140&action=edit "Use 4-byte writes for outgoing bool values in NPP_GetValues") -
Flags: approval-mozilla-beta+
[Attachment #716140](/attachment.cgi?id=716140&action=edit "Use 4-byte writes for outgoing bool values in NPP_GetValues") -
Flags: approval-mozilla-aurora?
[Attachment #716140](/attachment.cgi?id=716140&action=edit "Use 4-byte writes for outgoing bool values in NPP_GetValues") -
Flags: approval-mozilla-aurora+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=842687#c26)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/22d26a3e75e3>
<https://hg.mozilla.org/releases/mozilla-aurora/rev/3dbdde25f5f5>
<https://hg.mozilla.org/releases/mozilla-beta/rev/ed89526b7d3f>
<https://hg.mozilla.org/releases/mozilla-beta/rev/9d5f767079ec>
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842687#a2941201_280903)• 12 years ago |

Whiteboard: [Android only] → [Android only][adv-main20+]

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=842687#c27)• 12 years ago |
|  | |

Worth relnoting this? I think this made Flash a bit more stable on Android.
[relnote-firefox](/buglist.cgi?f1=cf_tracking_firefox_relnote&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_relnote&o1=equals&v1=%3F)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=842687#c28)• 12 years ago |
|  | |

(In reply to Kevin Brosnan [:kbrosnan] from [comment #27](/show_bug.cgi?id=842687#c27 "RESOLVED FIXED - Stack corruption in plug-in code caused by PRBool to bool switch"))
> Worth relnoting this? I think this made Flash a bit more stable on Android.
Likely won't, since it would mean implying that improving our current stability situation is worth noting (we're already pretty good).
[relnote-firefox](/buglist.cgi?f1=cf_tracking_firefox_relnote&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_relnote&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox_relnote&o1=equals&v1=-)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842687#a24111933_1689)• 11 years ago |

Group: core-security

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=842687#a291427804_546015)• 3 years ago |

Product: Core → Core Graveyard
You need to [log in](/show_bug.cgi?id=842687&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [(inactive) Jim Chen [:jchen] [:darchons]](/user_profile?user_id=281508)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_b72a8947_20250125_151426.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/824856)
* [XML](/show_bug.cgi?ctype=xml&id=824856)

Closed
[Bug 824856](/show_bug.cgi?id=824856)

Opened 12 years ago
Closed 12 years ago

# Crash [@ QuoteString] or [@ js\_NewStringCopyN] or "Assertion failure: limit >= start,"

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Crash [@ QuoteString] or [@ js\_NewStringCopyN] or "Assertion failure: limit >= start,"

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

macOS

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla22

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox17 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=unaffected) |
| firefox18 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=unaffected) |
| firefox19 | [+](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix) |
| firefox20 | [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed) |
| firefox21 | [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed) |
| firefox22 | [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=fixed) |
| firefox-esr10 | --- | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |
| firefox-esr17 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected) |
| b2g18 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox17 |  | unaffected |
| firefox18 |  | unaffected |
| firefox19 | + | wontfix |
| firefox20 | + | fixed |
| firefox21 | + | fixed |
| firefox22 | + | fixed |
| firefox-esr10 |  | unaffected |
| firefox-esr17 |  | unaffected |
| b2g18 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: gkw, Assigned: dvander)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [dvander](/user_profile?user_id=309316)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/55857f92ded07119259dc6c1dd386205?d=mm&size=40)  [general](/user_profile?user_id=4729)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [gkw](/user_profile?user_id=132034)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[808478](/show_bug.cgi?id=808478 "RESOLVED FIXED - \"Assertion failure: (&term - term.atom.parenthesesWidth)->inputPosition == term.inputPosition,\"")

Dependency [tree](/showdependencytree.cgi?id=824856&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=824856)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (5 keywords, Whiteboard: [jsbugmon:][adv-main20+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[crash](/buglist.cgi?keywords=crash&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[jsbugmon:][adv-main20+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [gkw](/user_profile?user_id=132034) | [in-testsuite](#c21 "12 years ago") | + |
| --- | --- | --- |
| [gkw](/user_profile?user_id=132034) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ QuoteString ]](https://crash-stats.mozilla.org/signature/?signature=QuoteString)

[[@ js\_NewStringCopyN ]](https://crash-stats.mozilla.org/signature/?signature=js_NewStringCopyN)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [stack](/attachment.cgi?id=695866)  [12 years ago](#c0)  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)   4.20 KB, text/plain |  | [Details](/attachment.cgi?id=695866&action=edit) |
| --- | --- | --- |
| [stack for testcase in comment 1](/attachment.cgi?id=696775)  [12 years ago](#c2)  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)   10.81 KB, text/plain |  | [Details](/attachment.cgi?id=696775&action=edit) |
| [stack for testcase in comment 3](/attachment.cgi?id=697286)  [12 years ago](#c4)  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)   3.86 KB, text/plain |  | [Details](/attachment.cgi?id=697286&action=edit) |
| [patch](/attachment.cgi?id=706247)  [12 years ago](#c12)  [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)   3.63 KB, patch |  | [Details](/attachment.cgi?id=706247&action=edit) | [Diff](/attachment.cgi?id=706247&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=824856&attachment=706247) |
| [fix](/attachment.cgi?id=714659)  [12 years ago](#c16)  [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)   1.39 KB, patch | sstangl : [review+](#a4407688_383201 "12 years ago")  lsblakk : [approval-mozilla-aurora+](#a6453371_272375 "12 years ago")  lsblakk : [approval-mozilla-beta+](#a6453371_272375 "12 years ago")  abillings : [sec-approval+](#c18 "12 years ago") | [Details](/attachment.cgi?id=714659&action=edit) | [Diff](/attachment.cgi?id=714659&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=824856&attachment=714659) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=824856#c0)• 12 years ago |
|  | |

Attached file
[stack](attachment.cgi?id=695866)
— [Details](attachment.cgi?id=695866&action=edit)

"xy".match(/((x)??){2}y/)
asserts js debug shell on m-c changeset f5ed2691d901 without any CLI arguments at Assertion failure: limit >= start,
autoBisect shows this is probably related to the following changeset:
The first bad revision is:
changeset: 116360:cd2eb9705765
user: Gary Kwong
date: Mon Dec 17 16:57:48 2012 -0800
summary: Workaround YARR assert ([bug 808478](/show_bug.cgi?id=808478 "RESOLVED FIXED - \"Assertion failure: (&term - term.atom.parenthesesWidth)->inputPosition == term.inputPosition,\""), r=sstangl).
I forgot to set the actual patch author when I was helping to land the patch in [bug 808478](/show_bug.cgi?id=808478 "RESOLVED FIXED - \"Assertion failure: (&term - term.atom.parenthesesWidth)->inputPosition == term.inputPosition,\""). :-/ The original patch author was dvander.
Prior to that changeset, the testcase was asserting at Assertion failure: (&term - term.atom.parenthesesWidth)->inputPosition == term.inputPosition, which [bug 808478](/show_bug.cgi?id=808478 "RESOLVED FIXED - \"Assertion failure: (&term - term.atom.parenthesesWidth)->inputPosition == term.inputPosition,\"") worked around.
This seems to be asserting in our regex code instead of YARR code. The original assert was added in [bug 673188](/show_bug.cgi?id=673188 "RESOLVED FIXED - Compile regexps lazily"). I'm not sure though.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=824856#c1)• 12 years ago |
|  | |

"2\"".match("(((2)??)+\")")()
crashes js opt shell on m-c changeset 0d771761b9b3 without any CLI arguments at QuoteString. Turning s-s and setting sec-critical because it seems to be accessing a weird memory address.
The incriminating changeset landed only in 20, but that was a workaround, and the original purported regression (upgrading YARR) landed in 19, so setting flags accordingly.Group: core-security
[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected)
[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected)
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=unaffected)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=unaffected)
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected)
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%3F)
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%3F)Keywords: [crash](/buglist.cgi?keywords=crash&resolution=---)Hardware: x86\_64 → AllSummary: "Assertion failure: limit >= start," → Crash [@ QuoteString] or "Assertion failure: limit >= start,"

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=824856#c2)• 12 years ago |
|  | |

Attached file
[stack for testcase in comment 1](attachment.cgi?id=696775)
— [Details](attachment.cgi?id=696775&action=edit)

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824856#a599700_132034)• 12 years ago |

Flags: needinfo?(dvander)

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=824856#c3)• 12 years ago |
|  | |

"\u66d6J".split(/((\u66d6)??){7}J/)
is another testcase that crashes js opt shell at memmove$VARIANT$sse42 with js\_NewStringCopyN on the stack on m-c changeset dec6aa71da64.Crash Signature: [@ QuoteString]
[@ js\_NewStringCopyN]Summary: Crash [@ QuoteString] or "Assertion failure: limit >= start," → Crash [@ QuoteString] or [@ js\_NewStringCopyN] or "Assertion failure: limit >= start,"

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=824856#c4)• 12 years ago |
|  | |

Attached file
[stack for testcase in comment 3](attachment.cgi?id=697286)
— [Details](attachment.cgi?id=697286&action=edit)

The testcase in [comment 3](/show_bug.cgi?id=824856#c3 "VERIFIED FIXED - Crash [@ QuoteString] or [@ js_NewStringCopyN] or \"Assertion failure: limit >= start,\"") also has the same assertion, and also seems to be accessing a weird memory address 0xfffa5a00.

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=824856#c5)• 12 years ago |
|  | |

(In reply to Gary Kwong [:gkw] from [comment #1](/show_bug.cgi?id=824856#c1 "VERIFIED FIXED - Crash [@ QuoteString] or [@ js_NewStringCopyN] or \"Assertion failure: limit >= start,\""))
> "2\"".match("(((2)??)+\")")()
>
> crashes js opt shell on m-c changeset 0d771761b9b3 without any CLI arguments
> at QuoteString. Turning s-s and setting sec-critical because it seems to be
> accessing a weird memory address.
>
> The incriminating changeset landed only in 20, but that was a workaround,
> and the original purported regression (upgrading YARR) landed in 19, so
> setting flags accordingly.
Can we mark this bug with sg:crit or sg:high prior to tracking? It's not clear how we're rating this internally.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=824856#c6)• 12 years ago |
|  | |

> Can we mark this bug with sg:crit or sg:high prior to tracking? It's not
> clear how we're rating this internally.
> crashes js opt shell on m-c changeset 0d771761b9b3 without any CLI arguments
> at QuoteString. Turning s-s and setting sec-critical because it seems to be
> accessing a weird memory address.
Oops, I missed out setting the sec-critical keyword. Added it now.Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [bhavana bajaj [:bajaj]](/user_profile?user_id=448925) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824856#a776319_448925)• 12 years ago |

[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%2B)
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=824856#c7)• 12 years ago |
|  | |

David - this is an sg:crit JS regression in FF19. Can you help find an owner?Assignee: general → dvander

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824856#a1068951_132034)• 12 years ago |

[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected)
[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%3F)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=824856#c8)• 12 years ago |
|  | |

This was introduced with the Yarr import, which I did, so I'll take it.Status: NEW → ASSIGNEDFlags: needinfo?(dvander)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824856#a1286075_1689)• 12 years ago |

[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=824856#c9)• 12 years ago |
|  | |

(In reply to David Anderson [:dvander] from [comment #8](/show_bug.cgi?id=824856#c8 "VERIFIED FIXED - Crash [@ QuoteString] or [@ js_NewStringCopyN] or \"Assertion failure: limit >= start,\""))
> This was introduced with the Yarr import, which I did, so I'll take it.
Any updates? We're now coming up on beta 4, and this is a FF19 regression. We don't have much time to resolve.

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824856#a2417506_395101)• 12 years ago |

Crash Signature: [@ QuoteString]
[@ js\_NewStringCopyN] → [@ QuoteString]
[@ js\_NewStringCopyN]Whiteboard: [jsbugmon:update] → [jsbugmon:]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=824856#c10)• 12 years ago |
|  | |

JSBugMon: Cannot process bug: Unknown exception (check manually)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=824856#c11)• 12 years ago |
|  | |

Initial analysis is that this was introduced in <https://bugs.webkit.org/show_bug.cgi?id=73728> (rev 108858). There are some subtraction expressions that were casually swapped, and this causes problems for certain inputs (i.e. 0 - -1 == 1, instead of -1 - 0 == -1).
I have no idea what the right fix for this is. I don't have access to the WebKit bug that made these changes, so maybe there was another underlying security issue. We could (1) revert the expressions back to what was in Firefox 18, since we don't know of any outstanding problems there. We could (2) revert just the ones causing this particular bug. We could (3) make these regular expressions throw a JavaScript exception, but that might break the web.
I'll try-run a patch for (2) and see what happens.
Filed WebKit bug @ <https://bugs.webkit.org/show_bug.cgi?id=107898>Crash Signature: [@ QuoteString]
[@ js\_NewStringCopyN] → [@ QuoteString]
[@ js\_NewStringCopyN]

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=824856#c12)• 12 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=706247&action=diff) (obsolete)
— [Details](attachment.cgi?id=706247&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=824856&attachment=706247)

verified to fix the test cases in this bug

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=824856#c13)• 12 years ago |
|  | |

Update: that idea totally failed on tbpl. Back to the drawing board.

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=824856#c14)• 12 years ago |
|  | |

Gary, I think we should backout the original patch, and disable the assert. Any thoughts on this? It doesn't seem like there is a security issue when the assert fires - for all we know it could be bogus, and fuzzing opt builds will tell us if/when there is a serious problem.

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=824856#c15)• 12 years ago |
|  | |

(In reply to David Anderson [:dvander] from [comment #14](/show_bug.cgi?id=824856#c14 "VERIFIED FIXED - Crash [@ QuoteString] or [@ js_NewStringCopyN] or \"Assertion failure: limit >= start,\""))
> Gary, I think we should backout the original patch, and disable the assert.
> Any thoughts on this? It doesn't seem like there is a security issue when
> the assert fires - for all we know it could be bogus, and fuzzing opt builds
> will tell us if/when there is a serious problem.
Sure, let's try that. Shall we also add the testcases in this bug while we're at it?

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=824856#c16)• 12 years ago |
|  | |

Attached patch

[fix](attachment.cgi?id=714659&action=diff)
— [Details](attachment.cgi?id=714659&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=824856&attachment=714659)

This reverts the previous patch, but leaves the ASSERT disabled.
[Attachment #706247](/attachment.cgi?id=706247&action=edit "patch") -
Attachment is obsolete: true
[Attachment #714659](/attachment.cgi?id=714659&action=edit "fix") -
Flags: review?(sstangl)

|  | [Sean Stangl [:sstangl]](/user_profile?user_id=383201) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824856#a4407688_383201)• 12 years ago |

[Attachment #714659](/attachment.cgi?id=714659&action=edit "fix") -
Flags: review?(sstangl) → review+

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=824856#c17)• 12 years ago |
|  | |

Comment on [attachment 714659](/attachment.cgi?id=714659 "fix") [[details]](/attachment.cgi?id=714659&action=edit "fix") [[diff]](/attachment.cgi?id=714659&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=824856&attachment=714659)
fix
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Not easily.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
No.
Which older supported branches are affected by this flaw?
If not all supported branches, which bug introduced the flaw?
Regressing cset landed on m-c on Dec 17 and no prior branches.
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
This patch will apply.
How likely is this patch to cause regressions; how much testing does it need?
Unlikely.
[Attachment #714659](/attachment.cgi?id=714659&action=edit "fix") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=824856#c18)• 12 years ago |
|  | |

Comment on [attachment 714659](/attachment.cgi?id=714659 "fix") [[details]](/attachment.cgi?id=714659&action=edit "fix") [[diff]](/attachment.cgi?id=714659&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=824856&attachment=714659)
fix
Sec-approval+. It would have been nice to have gotten this into 19 since then we would never have shipped this issue.
[Attachment #714659](/attachment.cgi?id=714659&action=edit "fix") -
Flags: sec-approval? → sec-approval+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824856#a4756710_280903)• 12 years ago |

[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected)
[tracking-firefox22](/buglist.cgi?f1=cf_tracking_firefox22&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B)

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=824856#c19)• 12 years ago |
|  | |

I have verified that the patch here fixes the testcase in [bug 828019](/show_bug.cgi?id=828019 "RESOLVED FIXED - \"Assertion failure: matchBegin <= matchEnd,\"") as well.

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=824856#c20)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/4e5f82315a79>

|  | [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=824856#c21)• 12 years ago |
|  | |

This was landed.
<http://hg.mozilla.org/mozilla-central/rev/4e5f82315a79>Status: ASSIGNED → RESOLVEDClosed: 12 years ago
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=fixed)Flags: in-testsuite+Resolution: --- → FIXEDTarget Milestone: --- → mozilla22

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824856#a5112895_395101)• 12 years ago |

Status: RESOLVED → VERIFIEDCrash Signature: [@ QuoteString]
[@ js\_NewStringCopyN] → [@ QuoteString]
[@ js\_NewStringCopyN]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=824856#c22)• 12 years ago |
|  | |

JSBugMon: This bug has been automatically verified fixed.

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=824856#c23)• 12 years ago |
|  | |

Let's get this nominated for uplift in that case, with a risk assessment, if we're going to take this in FF20 we really would want to have it landed before Tuesday's go to build on beta5.Crash Signature: [@ QuoteString]
[@ js\_NewStringCopyN] → [@ QuoteString]
[@ js\_NewStringCopyN]

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=824856#c24)• 12 years ago |
|  | |

Comment on [attachment 714659](/attachment.cgi?id=714659 "fix") [[details]](/attachment.cgi?id=714659&action=edit "fix") [[diff]](/attachment.cgi?id=714659&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=824856&attachment=714659)
fix
[Approval Request Comment]
Bug caused by (feature/regressing bug #): [bug 808478](/show_bug.cgi?id=808478 "RESOLVED FIXED - \"Assertion failure: (&term - term.atom.parenthesesWidth)->inputPosition == term.inputPosition,\"")
User impact if declined: possible sg:crit
Testing completed (on m-c, etc.): yes
Risk to taking this patch (and alternatives if risky): none
String or UUID changes made by this patch: none
[Attachment #714659](/attachment.cgi?id=714659&action=edit "fix") -
Flags: approval-mozilla-beta?
[Attachment #714659](/attachment.cgi?id=714659&action=edit "fix") -
Flags: approval-mozilla-aurora?

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824856#a6453371_272375)• 12 years ago |

[Attachment #714659](/attachment.cgi?id=714659&action=edit "fix") -
Flags: approval-mozilla-beta?
[Attachment #714659](/attachment.cgi?id=714659&action=edit "fix") -
Flags: approval-mozilla-beta+
[Attachment #714659](/attachment.cgi?id=714659&action=edit "fix") -
Flags: approval-mozilla-aurora?
[Attachment #714659](/attachment.cgi?id=714659&action=edit "fix") -
Flags: approval-mozilla-aurora+

|  | [bhavana bajaj [:bajaj]](/user_profile?user_id=448925) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=824856#c25)• 12 years ago |
|  | |

Comment on [attachment 714659](/attachment.cgi?id=714659 "fix") [[details]](/attachment.cgi?id=714659&action=edit "fix") [[diff]](/attachment.cgi?id=714659&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=824856&attachment=714659)
fix
low risk sec-crit regression, approving for uplift.
Please land by tonight(3/11) or early morning PT to get it into our next beta.

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=824856#c26)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/173181c18cf0>
<https://hg.mozilla.org/releases/mozilla-beta/rev/9ec0e2243b0a>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824856#a6453932_75935)• 12 years ago |

[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824856#a7674191_280903)• 12 years ago |

Whiteboard: [jsbugmon:] → [jsbugmon:][adv-main20+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=824856#a28847201_1689)• 11 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=824856&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Gary Kwong [:gkw] [:nth10sd] (NOT official MoCo now)](/user_profile?user_id=132034)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from lists.opensuse.org_11471c55_20250125_151417.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/ZAHS3QMX2M3YZLIZBDTEH2G2I3HQ22TO/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/ZAHS3QMX2M3YZLIZBDTEH2G2I3HQ22TO/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/ZAHS3QMX2M3YZLIZBDTEH2G2I3HQ22TO/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/ZAHS3QMX2M3YZLIZBDTEH2G2I3HQ22TO/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/ZAHS3QMX2M3YZLIZBDTEH2G2I3HQ22TO/#ZAHS3QMX2M3YZLIZBDTEH2G2I3HQ22TO)

# [security-announce] SUSE-SU-2013:0645-1: important: Security update for Mozilla Firefox

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

8 Apr
2013

8 Apr
'13

19:04

SUSE Security Update: Security update for Mozilla Firefox
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: SUSE-SU-2013:0645-1
Rating: important
References: #813026
Cross-References: CVE-2013-0788 CVE-2013-0789 CVE-2013-0790
CVE-2013-0791 CVE-2013-0792 CVE-2013-0794
CVE-2013-0795 CVE-2013-0796 CVE-2013-0797
CVE-2013-0798 CVE-2013-0799 CVE-2013-0800
Affected Products:
SUSE Linux Enterprise Software Development Kit 11 SP2
SUSE Linux Enterprise Server 11 SP2 for VMware
SUSE Linux Enterprise Server 11 SP2
SUSE Linux Enterprise Server 10 SP4
SUSE Linux Enterprise Desktop 11 SP2
SUSE Linux Enterprise Desktop 10 SP4
SLE SDK 10 SP4
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes 12 vulnerabilities is now available.
It includes four new package versions.
Description:
MozillaFirefox has been updated to the 17.0.5ESR release
fixing bugs and security issues.
Also Mozilla NSS has been updated to version 3.14.3 and
Mozilla NSPR to 4.9.6.
\*
MFSA 2013-30: Mozilla developers identified and fixed
several memory safety bugs in the browser engine used in
Firefox and other Mozilla-based products. Some of these
bugs showed evidence of memory corruption under certain
circumstances, and we presume that with enough effort at
least some of these could be exploited to run arbitrary
code.
Olli Pettay, Jesse Ruderman, Boris Zbarsky, Christian
Holler, Milan Sreckovic, and Joe Drew reported memory
safety problems and crashes that affect Firefox ESR 17, and
Firefox 19. (CVE-2013-0788)
Andrew McCreight, Randell Jesup, Gary Kwong, Jesse
Ruderman, Christian Holler, and Mats Palmgren reported
memory safety problems and crashes that affect Firefox 19.
(CVE-2013-0789)
Jim Chen reported a memory safety problem that
affects Firefox for Android
\*
(CVE-2013-0790)
\*
MFSA 2013-31 / CVE-2013-0800: Security researcher
Abhishek Arya (Inferno) of the Google Chrome Security Team
used the Address Sanitizer tool to discover an
out-of-bounds write in Cairo graphics library. When certain
values are passed to it during rendering, Cairo attempts to
use negative boundaries or sizes for boxes, leading to a
potentially exploitable crash in some instances.
\*
MFSA 2013-32 / CVE-2013-0799: Security researcher
Frederic Hoguin discovered that the Mozilla Maintenance
Service on Windows was vulnerable to a buffer overflow.
This system is used to update software without invoking the
User Account Control (UAC) prompt. The Mozilla Maintenance
Service is configured to allow unprivileged users to start
it with arbitrary arguments. By manipulating the data
passed in these arguments, an attacker can execute
arbitrary code with the system privileges used by the
service. This issue requires local file system access to be
exploitable.
\*
MFSA 2013-33 / CVE-2013-0798: Security researcher
Shuichiro Suzuki of the Fourteenforty Research Institute
reported the app\_tmp directory is set to be world readable
and writeable by Firefox for Android. This potentially
allows for third party applications to replace or alter
Firefox add-ons when downloaded because they are
temporarily stored in the app\_tmp directory before
installation.
This vulnerability only affects Firefox for Android.
\*
MFSA 2013-34 / CVE-2013-0797: Security researcher Ash
reported an issue with the Mozilla Updater. The Mozilla
Updater can be made to load a malicious local DLL file in a
privileged context through either the Mozilla Maintenance
Service or independently on systems that do not use the
service. This occurs when the DLL file is placed in a
specific location on the local system before the Mozilla
Updater is run. Local file system access is necessary in
order for this issue to be exploitable.
\*
MFSA 2013-35 / CVE-2013-0796: Security researcher
miaubiz used the Address Sanitizer tool to discover a crash
in WebGL rendering when memory is freed that has not
previously been allocated. This issue only affects Linux
users who have Intel Mesa graphics drivers. The resulting
crash could be potentially exploitable.
\*
MFSA 2013-36 / CVE-2013-0795: Security researcher
Cody Crews reported a mechanism to use the cloneNode method
to bypass System Only Wrappers (SOW) and clone a protected
node. This allows violation of the browser's same origin
policy and could also lead to privilege escalation and the
execution of arbitrary code.
\*
MFSA 2013-37 / CVE-2013-0794: Security researcher
shutdown reported a method for removing the origin
indication on tab-modal dialog boxes in combination with
browser navigation. This could allow an attacker's dialog
to overlay a page and show another site's content. This can
be used for phishing by allowing users to enter data into a
modal prompt dialog on an attacking, site while appearing
to be from the displayed site.
\*
MFSA 2013-38 / CVE-2013-079: Security researcher
Mariusz Mlynski reported a method to use browser
navigations through history to load an arbitrary website
with that page's baseURI property pointing to another site
instead of the seemingly loaded one. The user will continue
to see the incorrect site in the addressbar of the browser.
This allows for a cross-site scripting (XSS) attack or the
theft of data through a phishing attack.
\*
MFSA 2013-39 / CVE-2013-0792: Mozilla community
member Tobias Schula reported that if
gfx.color\_management.enablev4 preference is enabled
manually in about:config, some grayscale PNG images will be
rendered incorrectly and cause memory corruption during PNG
decoding when certain color profiles are in use. A crafted
PNG image could use this flaw to leak data through rendered
images drawing from random memory. By default, this
preference is not enabled.
\*
MFSA 2013-40 / CVE-2013-0791: Mozilla community
member Ambroz Bizjak reported an out-of-bounds array read
in the CERT\_DecodeCertPackage function of the Network
Security Services (NSS) libary when decoding a certificate.
When this occurs, it will lead to memory corruption and a
non-exploitable crash.
Security Issue references:
\* CVE-2013-0788
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0788>

...

\* CVE-2013-0789
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0789>

...

\* CVE-2013-0790
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0790>

...

\* CVE-2013-0791
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0791>

...

\* CVE-2013-0792
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0792>

...

\* CVE-2013-0794
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0794>

...

\* CVE-2013-0795
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0795>

...

\* CVE-2013-0796
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0796>

...

\* CVE-2013-0797
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0797>

...

\* CVE-2013-0798
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0798>

...

\* CVE-2013-0799
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0799>

...

\* CVE-2013-0800
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0800>

...

Patch Instructions:
To install this SUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- SUSE Linux Enterprise Software Development Kit 11 SP2:
zypper in -t patch sdksp2-firefox-20130404-7599
- SUSE Linux Enterprise Server 11 SP2 for VMware:
zypper in -t patch slessp2-firefox-20130404-7599
- SUSE Linux Enterprise Server 11 SP2:
zypper in -t patch slessp2-firefox-20130404-7599
- SUSE Linux Enterprise Desktop 11 SP2:
zypper in -t patch sledsp2-firefox-20130404-7599
To bring your system up-to-date, use "zypper patch".
Package List:
- SUSE Linux Enterprise Software Development Kit 11 SP2 (i586 ia64 ppc64 s390x x86\_64) [New Version: 3.14.3 and 4.9.6]:
mozilla-nspr-devel-4.9.6-0.3.1
mozilla-nss-devel-3.14.3-0.4.3.1
- SUSE Linux Enterprise Server 11 SP2 for VMware (i586 x86\_64) [New Version: 17.0.5esr,3.14.3 and 4.9.6]:
MozillaFirefox-17.0.5esr-0.4.1
MozillaFirefox-translations-17.0.5esr-0.4.1
libfreebl3-3.14.3-0.4.3.1
mozilla-nspr-4.9.6-0.3.1
mozilla-nss-3.14.3-0.4.3.1
mozilla-nss-tools-3.14.3-0.4.3.1
- SUSE Linux Enterprise Server 11 SP2 for VMware (x86\_64) [New Version: 3.14.3 and 4.9.6]:
libfreebl3-32bit-3.14.3-0.4.3.1
mozilla-nspr-32bit-4.9.6-0.3.1
mozilla-nss-32bit-3.14.3-0.4.3.1
- SUSE Linux Enterprise Server 11 SP2 (i586 ia64 ppc64 s390x x86\_64) [New Version: 17.0.5esr,3.14.3 and 4.9.6]:
MozillaFirefox-17.0.5esr-0.4.1
MozillaFirefox-branding-SLED-7-0.6.9.17
MozillaFirefox-translations-17.0.5esr-0.4.1
libfreebl3-3.14.3-0.4.3.1
mozilla-nspr-4.9.6-0.3.1
mozilla-nss-3.14.3-0.4.3.1
mozilla-nss-tools-3.14.3-0.4.3.1
- SUSE Linux Enterprise Server 11 SP2 (ppc64 s390x x86\_64) [New Version: 3.14.3 and 4.9.6]:
libfreebl3-32bit-3.14.3-0.4.3.1
mozilla-nspr-32bit-4.9.6-0.3.1
mozilla-nss-32bit-3.14.3-0.4.3.1
- SUSE Linux Enterprise Server 11 SP2 (ia64) [New Version: 3.14.3 and 4.9.6]:
libfreebl3-x86-3.14.3-0.4.3.1
mozilla-nspr-x86-4.9.6-0.3.1
mozilla-nss-x86-3.14.3-0.4.3.1
- SUSE Linux Enterprise Server 10 SP4 (i586 ia64 ppc s390x x86\_64) [New Version: 3.14.3 and 4.9.6]:
mozilla-nspr-4.9.6-0.5.1
mozilla-nspr-devel-4.9.6-0.5.1
mozilla-nss-3.14.3-0.5.1
mozilla-nss-devel-3.14.3-0.5.1
mozilla-nss-tools-3.14.3-0.5.1
- SUSE Linux Enterprise Server 10 SP4 (i586 ia64 ppc s390x) [New Version: 17.0.5esr and 7]:
MozillaFirefox-17.0.5esr-0.8.1
MozillaFirefox-branding-SLED-7-0.10.11
MozillaFirefox-translations-17.0.5esr-0.8.1
- SUSE Linux Enterprise Server 10 SP4 (s390x x86\_64) [New Version: 3.14.3 and 4.9.6]:
mozilla-nspr-32bit-4.9.6-0.5.1
mozilla-nss-32bit-3.14.3-0.5.1
- SUSE Linux Enterprise Server 10 SP4 (ia64) [New Version: 3.14.3 and 4.9.6]:
mozilla-nspr-x86-4.9.6-0.5.1
mozilla-nss-x86-3.14.3-0.5.1
- SUSE Linux Enterprise Server 10 SP4 (ppc) [New Version: 3.14.3 and 4.9.6]:
mozilla-nspr-64bit-4.9.6-0.5.1
mozilla-nss-64bit-3.14.3-0.5.1
- SUSE Linux Enterprise Desktop 11 SP2 (i586 x86\_64) [New Version: 17.0.5esr,3.14.3 and 4.9.6]:
MozillaFirefox-17.0.5esr-0.4.1
MozillaFirefox-branding-SLED-7-0.6.9.17
MozillaFirefox-translations-17.0.5esr-0.4.1
libfreebl3-3.14.3-0.4.3.1
mozilla-nspr-4.9.6-0.3.1
mozilla-nss-3.14.3-0.4.3.1
mozilla-nss-tools-3.14.3-0.4.3.1
- SUSE Linux Enterprise Desktop 11 SP2 (x86\_64) [New Version: 3.14.3 and 4.9.6]:
libfreebl3-32bit-3.14.3-0.4.3.1
mozilla-nspr-32bit-4.9.6-0.3.1
mozilla-nss-32bit-3.14.3-0.4.3.1
- SUSE Linux Enterprise Desktop 10 SP4 (i586 x86\_64) [New Version: 3.14.3 and 4.9.6]:
mozilla-nspr-4.9.6-0.5.1
mozilla-nspr-devel-4.9.6-0.5.1
mozilla-nss-3.14.3-0.5.1
mozilla-nss-devel-3.14.3-0.5.1
mozilla-nss-tools-3.14.3-0.5.1
- SUSE Linux Enterprise Desktop 10 SP4 (x86\_64) [New Version: 3.14.3 and 4.9.6]:
mozilla-nspr-32bit-4.9.6-0.5.1
mozilla-nss-32bit-3.14.3-0.5.1
- SUSE Linux Enterprise Desktop 10 SP4 (i586) [New Version: 17.0.5esr and 7]:
MozillaFirefox-17.0.5esr-0.8.1
MozillaFirefox-branding-SLED-7-0.10.11
MozillaFirefox-translations-17.0.5esr-0.8.1
- SLE SDK 10 SP4 (i586 ia64 ppc s390x x86\_64) [New Version: 3.14.3]:
mozilla-nss-tools-3.14.3-0.5.1
- SLE SDK 10 SP4 (i586 ia64 ppc s390x):
MozillaFirefox-branding-upstream-17.0.5esr-0.8.1
References:
<http://support.novell.com/security/cve/CVE-2013-0788.html>
<http://support.novell.com/security/cve/CVE-2013-0789.html>
<http://support.novell.com/security/cve/CVE-2013-0790.html>
<http://support.novell.com/security/cve/CVE-2013-0791.html>
<http://support.novell.com/security/cve/CVE-2013-0792.html>
<http://support.novell.com/security/cve/CVE-2013-0794.html>
<http://support.novell.com/security/cve/CVE-2013-0795.html>
<http://support.novell.com/security/cve/CVE-2013-0796.html>
<http://support.novell.com/security/cve/CVE-2013-0797.html>
<http://support.novell.com/security/cve/CVE-2013-0798.html>
<http://support.novell.com/security/cve/CVE-2013-0799.html>
<http://support.novell.com/security/cve/CVE-2013-0800.html>
<https://bugzilla.novell.com/813026>
[http://download.novell.com/patch/finder/?keywords=bb37c4e63c825ec7312dcfd261...](http://download.novell.com/patch/finder/?keywords=bb37c4e63c825ec7312dcfd2614bcab2)
[http://download.novell.com/patch/finder/?keywords=c2b6f5f84d016484ab6f637f9b...](http://download.novell.com/patch/finder/?keywords=c2b6f5f84d016484ab6f637f9b3ed49e)
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/ZAHS3QMX2M3YZLIZBDTEH2G2I3HQ22TO/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/ZAHS3QMX2M3YZLIZBDTEH2G2I3HQ22TO/#ZAHS3QMX2M3YZLIZBDTEH2G2I3HQ22TO)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from bugzilla.mozilla.org_aef6aa38_20250125_151428.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/827596)
* [XML](/show_bug.cgi?ctype=xml&id=827596)

Closed
[Bug 827596](/show_bug.cgi?id=827596)

Opened 12 years ago
Closed 12 years ago

# Assigning the same pointer value to an nsAutoPtr shouldn't crash exploitably

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Assigning the same pointer value to an nsAutoPtr shouldn't crash exploitably

## Categories

### (Core :: XPCOM, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=XPCOM#XPCOM)

XPCOM
▾

Core :: XPCOM
This is the basis of our component technology; this covers the mozilla/xpcom source directory and includes the "repository". Unlikely a tester would be able to tell there was an XPCOM problem specifically.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=XPCOM&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=XPCOM&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=XPCOM)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla21

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox18 | --- | [affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected) |
| firefox19 | [-](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix) |
| firefox20 | [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed) |
| firefox21 | [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed) |
| firefox-esr17 | [-](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=wontfix) |
| b2g18 | --- | [wontfix](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=wontfix) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox18 |  | affected |
| firefox19 | - | wontfix |
| firefox20 | + | fixed |
| firefox21 | + | fixed |
| firefox-esr17 | - | wontfix |
| b2g18 |  | wontfix |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jruderman, Assigned: benjamin)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/3301a62f3707d6bcef9542d316fb587f?d=mm&size=40)  [benjamin](/user_profile?user_id=7044)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d2dc9227eafcd0ec5ba3712ee4f19b75?d=mm&size=40)  [jruderman](/user_profile?user_id=11608)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/fcf93a5a624020bf2256443c69e08b51?d=mm&size=40)  [nika](/user_profile?user_id=534482)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-want, Whiteboard: [adv-main20+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[sec-want](/buglist.cgi?keywords=sec-want&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main20+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [benjamin](/user_profile?user_id=7044) | [in-testsuite](#c9 "12 years ago") | - |
| --- | --- | --- |
| [benjamin](/user_profile?user_id=7044) | in-testsuite | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [runtime abort instead, rev. 1](/attachment.cgi?id=703539)  [12 years ago](#c4)  [Benjamin Smedberg](/user_profile?user_id=7044)   1015 bytes, patch | dbaron : [review+](#c5 "12 years ago") | [Details](/attachment.cgi?id=703539&action=edit) | [Diff](/attachment.cgi?id=703539&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=827596&attachment=703539) |
| --- | --- | --- |
| [runtime abort instead, rev. 1.1](/attachment.cgi?id=705342)  [12 years ago](#c6)  [Benjamin Smedberg](/user_profile?user_id=7044)   1.06 KB, patch | abillings : [sec-approval+](#a1383313_280903 "12 years ago") | [Details](/attachment.cgi?id=705342&action=edit) | [Diff](/attachment.cgi?id=705342&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=827596&attachment=705342) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jesse Ruderman](/user_profile?user_id=11608)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=827596#c0)• 12 years ago |
|  | |

nsAutoPtr prematurely frees its pointer if you assign "x = y;" when x is already equal to y.
Recently we've had some security bugs due to this behavior ([bug 723446](/show_bug.cgi?id=723446 "VERIFIED FIXED - Access to a keyframe's cssText after dynamic modification always crashes Gecko") and [bug 827591](/show_bug.cgi?id=827591 "RESOLVED FIXED - Abort when CSSOM modifies an @page rule, due to reassigning an nsAutoPtr")). [Bug 723446](/show_bug.cgi?id=723446 "VERIFIED FIXED - Access to a keyframe's cssText after dynamic modification always crashes Gecko") added a debug-only assertion to notice when this happens, and there was some discussion in that bug about changing the behavior.
"Smart" pointer classes shouldn't be such bad footguns, IMO.

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=827596#c1)• 12 years ago |
|  | |

So if you're assigning something to an nsAutoPtr you're asserting that you, uniquely, own that object, and are transferring that ownership to the nsAutoPtr. If the nsAutoPtr already owns that object, how could you possibly make such an assertion...unless you know for sure you're not changing anything, in which case why bother with the assignment?
I guess I'd be ok with making the behavior safer... but I'd be pretty uncomfortable removing the assertion.

|  | [(no longer active)](/user_profile?user_id=251051) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=827596#c2)• 12 years ago |
|  | |

Hmm, the branch mentioned in [bug 723446 comment 22](/show_bug.cgi?id=723446#c22 "VERIFIED FIXED - Access to a keyframe's cssText after dynamic modification always crashes Gecko") should be a well-predicted one, right?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=827596#a248627_1689)• 12 years ago |

Group: core-security

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=827596#c3)• 12 years ago |
|  | |

Why would we remove the assertion? if anything we should change it to an abort unless we make it safe. If we make the operation safe we could leave the assertion as a warning that you're doing something unexpected.Assignee: nobody → benjamin

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=827596#a248781_1689)• 12 years ago |

[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B)

|  | [Benjamin Smedberg](/user_profile?user_id=7044)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=827596#c4)• 12 years ago |
|  | |

Attached patch

[runtime abort instead, rev. 1](attachment.cgi?id=703539&action=diff)
— [Details](attachment.cgi?id=703539&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=827596&attachment=703539)

[Attachment #703539](/attachment.cgi?id=703539&action=edit "runtime abort instead, rev. 1") -
Flags: review?(dbaron)

|  | [David Baron :dbaron: (⌚️UTC-4, no longer working on Mozilla)](/user_profile?user_id=3881) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=827596#c5)• 12 years ago |
|  | |

Comment on [attachment 703539](/attachment.cgi?id=703539 "runtime abort instead, rev. 1") [[details]](/attachment.cgi?id=703539&action=edit "runtime abort instead, rev. 1") [[diff]](/attachment.cgi?id=703539&action=diff "runtime abort instead, rev. 1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=827596&attachment=703539)
runtime abort instead, rev. 1
If you make this compile by moving it below the declaration of oldPtr, then r=dbaron
(Though the branch might be better predicted if you swap the order around the &&; I'm not sure, though.)
[Attachment #703539](/attachment.cgi?id=703539&action=edit "runtime abort instead, rev. 1") -
Flags: review?(dbaron) → review+

|  | [Benjamin Smedberg](/user_profile?user_id=7044)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=827596#c6)• 12 years ago |
|  | |

Attached patch

[runtime abort instead, rev. 1.1](attachment.cgi?id=705342&action=diff)
— [Details](attachment.cgi?id=705342&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=827596&attachment=705342)

How easily could an exploit be constructed based on the patch?: As a defensive measure, there is only evidence that somewhere we've had problems with same-pointer assignment. [Bug 723446](/show_bug.cgi?id=723446 "VERIFIED FIXED - Access to a keyframe's cssText after dynamic modification always crashes Gecko") has already been made public and [bug 827591](/show_bug.cgi?id=827591 "RESOLVED FIXED - Abort when CSSOM modifies an @page rule, due to reassigning an nsAutoPtr") has already landed in beta.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem? Not any more than the patch itself does.
Which older supported branches are affected by this flaw? As a defensive measure, we don't \*have\* to apply it to any older branches, but it should also be safe to do so if we want.
Do you have backports for the affected branches? This patch will probably apply directly to all the branches we care about.
How likely is this patch to cause regressions; how much testing does it need? This patch is unlikely to cause any regressions. It is vaguely possible for it to cause a peformance regression, but I consider that very unlikely.
[Attachment #705342](/attachment.cgi?id=705342&action=edit "runtime abort instead, rev. 1.1") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=827596#a1383294_280903)• 12 years ago |

[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected)
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected)
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%3F)
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%3F)
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=%3F)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=827596#a1383313_280903)• 12 years ago |

[Attachment #705342](/attachment.cgi?id=705342&action=edit "runtime abort instead, rev. 1.1") -
Flags: sec-approval? → sec-approval+

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=827596#c7)• 12 years ago |
|  | |

Based on [comment 6](/show_bug.cgi?id=827596#c6 "RESOLVED FIXED - Assigning the same pointer value to an nsAutoPtr shouldn't crash exploitably") there's no rush to take this for Beta (19) but we could take an uplift to Aurora (20). This doesn't meet ESR landing criteria so unless the user base is clamouring for this fix we won't take it there.
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=wontfix)
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=-)
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B)
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=-)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=827596#c8)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/70c64112a171>
Is it possible to test this?Status: NEW → RESOLVEDClosed: 12 years ago
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed)Flags: in-testsuite?Resolution: --- → FIXEDTarget Milestone: --- → mozilla21

|  | [Benjamin Smedberg](/user_profile?user_id=7044)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=827596#c9)• 12 years ago |
|  | |

It would not be worthwhile, I think. We'd have to do a binary-code test, and we're testing a condition that is a programming error anyway.Flags: in-testsuite? → in-testsuite-

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=827596#a3283918_1689)• 12 years ago |

[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=wontfix)

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=827596#c10)• 12 years ago |
|  | |

If this fix is low-risk enough please nominate for Beta approval so it can land in the first couple of FF20 beta builds.

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=827596#c11)• 12 years ago |
|  | |

Bsmedberg - can we uplift this on Monday and ship it in the FF 20 beta 2?Flags: needinfo?(benjamin)

|  | [Benjamin Smedberg](/user_profile?user_id=7044)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=827596#c12)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/b25ab04a5813>
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed)Flags: needinfo?(benjamin)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=827596#a6637837_280903)• 12 years ago |

Whiteboard: [adv-main20+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=827596#a6917367_1689)• 12 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=827596&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Benjamin Smedberg](/user_profile?user_id=7044)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from lists.opensuse.org_0becf6c5_20250125_151416.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/FBHKMFM42NXR6PIC6SAOED5F2MBDVJJL/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/FBHKMFM42NXR6PIC6SAOED5F2MBDVJJL/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/FBHKMFM42NXR6PIC6SAOED5F2MBDVJJL/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/FBHKMFM42NXR6PIC6SAOED5F2MBDVJJL/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/FBHKMFM42NXR6PIC6SAOED5F2MBDVJJL/#FBHKMFM42NXR6PIC6SAOED5F2MBDVJJL)

# [security-announce] openSUSE-SU-2013:0630-1: important: Mozilla Firefox and others: Update to Firefox 20.0 release

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

5 Apr
2013

5 Apr
'13

13:06

openSUSE Security Update: Mozilla Firefox and others: Update to Firefox 20.0 release
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2013:0630-1
Rating: important
References: #813026
Cross-References: CVE-2013-0788 CVE-2013-0789 CVE-2013-0791
CVE-2013-0792 CVE-2013-0793 CVE-2013-0794
CVE-2013-0795 CVE-2013-0796 CVE-2013-0800
CVE-2013-1620
Affected Products:
openSUSE 12.3
openSUSE 12.2
openSUSE 12.1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes 10 vulnerabilities is now available.
Description:
The Mozilla suite received security and bugfix updates:
Mozilla Firefox was updated to version 20.0. Mozilla
Thunderbird was updated to version 17.0.5. Mozilla
Seamonkey was updated to version 17.0.5. Mozilla XULRunner
was updated to version 17.0.5. mozilla-nss was updated to
version 3.14.3. mozilla-nspr was updated to version 4.9.6.
mozilla-nspr was updated to version 4.9.6:
\* aarch64 support
\* added PL\_SizeOfArenaPoolExcludingPool function
(bmo#807883)
\* Auto detect android api version for x86 (bmo#782214)
\* Initialize Windows CRITICAL\_SECTIONs without debug info
and with nonzero spin count (bmo#812085) Previous update
to version 4.9.5
\* bmo#634793: define NSPR's exact-width integer types
PRInt{N} and PRUint{N} types to match the <stdint.h>
exact-width integer types int{N}\_t and uint{N}\_t.
\* bmo#782815: passing 'int \*' to parameter of type
'unsigned int \*' in setsockopt().
\* bmo#822932: Port bmo#802527 (NDK r8b support for x86) to
NSPR.
\* bmo#824742: NSPR shouldn't require librt on Android.
\* bmo#831793: data race on lib->refCount in
PR\_UnloadLibrary.
mozilla-nss was updated to version 3.14.3:
\* disable tests with expired certificates
\* add SEC\_PKCS7VerifyDetachedSignatureAtTime using patch
from mozilla tree to fulfill Firefox 21 requirements
\* No new major functionality is introduced in this release.
This release is a patch release to address CVE-2013-1620
(bmo#822365)
\* "certutil -a" was not correctly producing ASCII output as
requested. (bmo#840714)
\* NSS 3.14.2 broke compilation with older versions of
sqlite that lacked the SQLITE\_FCNTL\_TEMPFILENAME file
control. NSS 3.14.3 now properly compiles when used with
older versions of sqlite (bmo#837799) - remove
system-sqlite.patch
\* add arm aarch64 support
\* added system-sqlite.patch (bmo#837799)
\* do not depend on latest sqlite just for a #define
\* enable system sqlite usage again
\* update to 3.14.2
\* required for Firefox >= 20
\* removed obsolete nssckbi update patch
\* MFSA 2013-40/CVE-2013-0791 (bmo#629816) Out-of-bounds
array read in CERT\_DecodeCertPackage
\* disable system sqlite usage since we depend on 3.7.15
which is not provided in any openSUSE distribution
\* add nss-sqlitename.patch to avoid any name clash
Changes in MozillaFirefox:
- update to Firefox 20.0 (bnc#813026)
\* requires NSPR 4.9.5 and NSS 3.14.3
\* MFSA 2013-30/CVE-2013-0788/CVE-2013-0789 Miscellaneous
memory safety hazards
\* MFSA 2013-31/CVE-2013-0800 (bmo#825721) Out-of-bounds
write in Cairo library
\* MFSA 2013-35/CVE-2013-0796 (bmo#827106) WebGL crash
with Mesa graphics driver on Linux
\* MFSA 2013-36/CVE-2013-0795 (bmo#825697) Bypass of SOW
protections allows cloning of protected nodes
\* MFSA 2013-37/CVE-2013-0794 (bmo#626775) Bypass of
tab-modal dialog origin disclosure
\* MFSA 2013-38/CVE-2013-0793 (bmo#803870) Cross-site
scripting (XSS) using timed history navigations
\* MFSA 2013-39/CVE-2013-0792 (bmo#722831) Memory
corruption while rendering grayscale PNG images
- use GStreamer 1.0 starting with 12.3
(mozilla-gstreamer-1.patch)
- build fixes for armv7hl:
\* disable debug build as armv7hl does not have enough
memory
\* disable webrtc on armv7hl as it is non-compiling
Changes in MozillaThunderbird:
- update to Thunderbird 17.0.5 (bnc#813026)
\* requires NSPR 4.9.5 and NSS 3.14.3
\* MFSA 2013-30/CVE-2013-0788/CVE-2013-0789 Miscellaneous
memory safety hazards
\* MFSA 2013-31/CVE-2013-0800 (bmo#825721) Out-of-bounds
write in Cairo library
\* MFSA 2013-35/CVE-2013-0796 (bmo#827106) WebGL crash
with Mesa graphics driver on Linux
\* MFSA 2013-36/CVE-2013-0795 (bmo#825697) Bypass of SOW
protections allows cloning of protected nodes
\* MFSA 2013-38/CVE-2013-0793 (bmo#803870) Cross-site
scripting (XSS) using timed history navigations
Changes in seamonkey:
- update to SeaMonkey 2.17 (bnc#813026)
\* requires NSPR 4.9.5 and NSS 3.14.3
\* MFSA 2013-30/CVE-2013-0788/CVE-2013-0789 Miscellaneous
memory safety hazards
\* MFSA 2013-31/CVE-2013-0800 (bmo#825721) Out-of-bounds
write in Cairo library
\* MFSA 2013-35/CVE-2013-0796 (bmo#827106) WebGL crash
with Mesa graphics driver on Linux
\* MFSA 2013-36/CVE-2013-0795 (bmo#825697) Bypass of SOW
protections allows cloning of protected nodes
\* MFSA 2013-37/CVE-2013-0794 (bmo#626775) Bypass of
tab-modal dialog origin disclosure
\* MFSA 2013-38/CVE-2013-0793 (bmo#803870) Cross-site
scripting (XSS) using timed history navigations
\* MFSA 2013-39/CVE-2013-0792 (bmo#722831) Memory
corruption while rendering grayscale PNG images
- use GStreamer 1.0 starting with 12.3
(mozilla-gstreamer-1.patch)
Changes in xulrunner:
- update to 17.0.5esr (bnc#813026)
\* requires NSPR 4.9.5 and NSS 3.14.3
\* MFSA 2013-30/CVE-2013-0788 Miscellaneous memory safety
hazards
\* MFSA 2013-31/CVE-2013-0800 (bmo#825721) Out-of-bounds
write in Cairo library
\* MFSA 2013-35/CVE-2013-0796 (bmo#827106) WebGL crash
with Mesa graphics driver on Linux
\* MFSA 2013-36/CVE-2013-0795 (bmo#825697) Bypass of SOW
protections allows cloning of protected nodes
\* MFSA 2013-37/CVE-2013-0794 (bmo#626775) Bypass of
tab-modal dialog origin disclosure
\* MFSA 2013-38/CVE-2013-0793 (bmo#803870) Cross-site
scripting (XSS) using timed history navigations
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.3:
zypper in -t patch openSUSE-2013-309
- openSUSE 12.2:
zypper in -t patch openSUSE-2013-309
- openSUSE 12.1:
zypper in -t patch openSUSE-2013-309
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.3 (i586 x86\_64):
MozillaFirefox-20.0-1.8.3
MozillaFirefox-branding-upstream-20.0-1.8.3
MozillaFirefox-buildsymbols-20.0-1.8.3
MozillaFirefox-debuginfo-20.0-1.8.3
MozillaFirefox-debugsource-20.0-1.8.3
MozillaFirefox-devel-20.0-1.8.3
MozillaFirefox-translations-common-20.0-1.8.3
MozillaFirefox-translations-other-20.0-1.8.3
MozillaThunderbird-17.0.5-61.9.4
MozillaThunderbird-buildsymbols-17.0.5-61.9.4
MozillaThunderbird-debuginfo-17.0.5-61.9.4
MozillaThunderbird-debugsource-17.0.5-61.9.4
MozillaThunderbird-devel-17.0.5-61.9.4
MozillaThunderbird-devel-debuginfo-17.0.5-61.9.4
MozillaThunderbird-translations-common-17.0.5-61.9.4
MozillaThunderbird-translations-other-17.0.5-61.9.4
enigmail-1.5.1+17.0.5-61.9.4
enigmail-debuginfo-1.5.1+17.0.5-61.9.4
libfreebl3-3.14.3-1.8.1
libfreebl3-debuginfo-3.14.3-1.8.1
libsoftokn3-3.14.3-1.8.1
libsoftokn3-debuginfo-3.14.3-1.8.1
mozilla-js-17.0.5-1.8.3
mozilla-js-debuginfo-17.0.5-1.8.3
mozilla-nspr-4.9.6-1.4.1
mozilla-nspr-debuginfo-4.9.6-1.4.1
mozilla-nspr-debugsource-4.9.6-1.4.1
mozilla-nspr-devel-4.9.6-1.4.1
mozilla-nss-3.14.3-1.8.1
mozilla-nss-certs-3.14.3-1.8.1
mozilla-nss-certs-debuginfo-3.14.3-1.8.1
mozilla-nss-debuginfo-3.14.3-1.8.1
mozilla-nss-debugsource-3.14.3-1.8.1
mozilla-nss-devel-3.14.3-1.8.1
mozilla-nss-sysinit-3.14.3-1.8.1
mozilla-nss-sysinit-debuginfo-3.14.3-1.8.1
mozilla-nss-tools-3.14.3-1.8.1
mozilla-nss-tools-debuginfo-3.14.3-1.8.1
xulrunner-17.0.5-1.8.3
xulrunner-buildsymbols-17.0.5-1.8.3
xulrunner-debuginfo-17.0.5-1.8.3
xulrunner-debugsource-17.0.5-1.8.3
xulrunner-devel-17.0.5-1.8.3
xulrunner-devel-debuginfo-17.0.5-1.8.3
- openSUSE 12.3 (x86\_64):
libfreebl3-32bit-3.14.3-1.8.1
libfreebl3-debuginfo-32bit-3.14.3-1.8.1
libsoftokn3-32bit-3.14.3-1.8.1
libsoftokn3-debuginfo-32bit-3.14.3-1.8.1
mozilla-js-32bit-17.0.5-1.8.3
mozilla-js-debuginfo-32bit-17.0.5-1.8.3
mozilla-nspr-32bit-4.9.6-1.4.1
mozilla-nspr-debuginfo-32bit-4.9.6-1.4.1
mozilla-nss-32bit-3.14.3-1.8.1
mozilla-nss-certs-32bit-3.14.3-1.8.1
mozilla-nss-certs-debuginfo-32bit-3.14.3-1.8.1
mozilla-nss-debuginfo-32bit-3.14.3-1.8.1
mozilla-nss-sysinit-32bit-3.14.3-1.8.1
mozilla-nss-sysinit-debuginfo-32bit-3.14.3-1.8.1
xulrunner-32bit-17.0.5-1.8.3
xulrunner-debuginfo-32bit-17.0.5-1.8.3
- openSUSE 12.2 (i586 x86\_64):
MozillaFirefox-20.0-2.41.3
MozillaFirefox-branding-upstream-20.0-2.41.3
MozillaFirefox-buildsymbols-20.0-2.41.3
MozillaFirefox-debuginfo-20.0-2.41.3
MozillaFirefox-debugsource-20.0-2.41.3
MozillaFirefox-devel-20.0-2.41.3
MozillaFirefox-translations-common-20.0-2.41.3
MozillaFirefox-translations-other-20.0-2.41.3
MozillaThunderbird-17.0.5-49.39.3
MozillaThunderbird-buildsymbols-17.0.5-49.39.3
MozillaThunderbird-debuginfo-17.0.5-49.39.3
MozillaThunderbird-debugsource-17.0.5-49.39.3
MozillaThunderbird-devel-17.0.5-49.39.3
MozillaThunderbird-devel-debuginfo-17.0.5-49.39.3
MozillaThunderbird-translations-common-17.0.5-49.39.3
MozillaThunderbird-translations-other-17.0.5-49.39.3
enigmail-1.5.1+17.0.5-49.39.3
enigmail-debuginfo-1.5.1+17.0.5-49.39.3
libfreebl3-3.14.3-2.19.2
libfreebl3-debuginfo-3.14.3-2.19.2
libsoftokn3-3.14.3-2.19.2
libsoftokn3-debuginfo-3.14.3-2.19.2
mozilla-js-17.0.5-2.38.2
mozilla-js-debuginfo-17.0.5-2.38.2
mozilla-nspr-4.9.6-1.12.1
mozilla-nspr-debuginfo-4.9.6-1.12.1
mozilla-nspr-debugsource-4.9.6-1.12.1
mozilla-nspr-devel-4.9.6-1.12.1
mozilla-nss-3.14.3-2.19.2
mozilla-nss-certs-3.14.3-2.19.2
mozilla-nss-certs-debuginfo-3.14.3-2.19.2
mozilla-nss-debuginfo-3.14.3-2.19.2
mozilla-nss-debugsource-3.14.3-2.19.2
mozilla-nss-devel-3.14.3-2.19.2
mozilla-nss-sysinit-3.14.3-2.19.2
mozilla-nss-sysinit-debuginfo-3.14.3-2.19.2
mozilla-nss-tools-3.14.3-2.19.2
mozilla-nss-tools-debuginfo-3.14.3-2.19.2
xulrunner-17.0.5-2.38.2
xulrunner-buildsymbols-17.0.5-2.38.2
xulrunner-debuginfo-17.0.5-2.38.2
xulrunner-debugsource-17.0.5-2.38.2
xulrunner-devel-17.0.5-2.38.2
xulrunner-devel-debuginfo-17.0.5-2.38.2
- openSUSE 12.2 (x86\_64):
libfreebl3-32bit-3.14.3-2.19.2
libfreebl3-debuginfo-32bit-3.14.3-2.19.2
libsoftokn3-32bit-3.14.3-2.19.2
libsoftokn3-debuginfo-32bit-3.14.3-2.19.2
mozilla-js-32bit-17.0.5-2.38.2
mozilla-js-debuginfo-32bit-17.0.5-2.38.2
mozilla-nspr-32bit-4.9.6-1.12.1
mozilla-nspr-debuginfo-32bit-4.9.6-1.12.1
mozilla-nss-32bit-3.14.3-2.19.2
mozilla-nss-certs-32bit-3.14.3-2.19.2
mozilla-nss-certs-debuginfo-32bit-3.14.3-2.19.2
mozilla-nss-debuginfo-32bit-3.14.3-2.19.2
mozilla-nss-sysinit-32bit-3.14.3-2.19.2
mozilla-nss-sysinit-debuginfo-32bit-3.14.3-2.19.2
xulrunner-32bit-17.0.5-2.38.2
xulrunner-debuginfo-32bit-17.0.5-2.38.2
- openSUSE 12.1 (i586 x86\_64):
MozillaFirefox-20.0-2.70.3
MozillaFirefox-branding-upstream-20.0-2.70.3
MozillaFirefox-buildsymbols-20.0-2.70.3
MozillaFirefox-debuginfo-20.0-2.70.3
MozillaFirefox-debugsource-20.0-2.70.3
MozillaFirefox-devel-20.0-2.70.3
MozillaFirefox-translations-common-20.0-2.70.3
MozillaFirefox-translations-other-20.0-2.70.3
MozillaThunderbird-17.0.5-33.59.3
MozillaThunderbird-buildsymbols-17.0.5-33.59.3
MozillaThunderbird-debuginfo-17.0.5-33.59.3
MozillaThunderbird-debugsource-17.0.5-33.59.3
MozillaThunderbird-devel-17.0.5-33.59.3
MozillaThunderbird-devel-debuginfo-17.0.5-33.59.3
MozillaThunderbird-translations-common-17.0.5-33.59.3
MozillaThunderbird-translations-other-17.0.5-33.59.3
enigmail-1.5.1+17.0.5-33.59.3
enigmail-debuginfo-1.5.1+17.0.5-33.59.3
libfreebl3-3.14.3-9.29.2
libfreebl3-debuginfo-3.14.3-9.29.2
libsoftokn3-3.14.3-9.29.2
libsoftokn3-debuginfo-3.14.3-9.29.2
mozilla-js-17.0.5-2.65.2
mozilla-js-debuginfo-17.0.5-2.65.2
mozilla-nspr-4.9.6-3.15.1
mozilla-nspr-debuginfo-4.9.6-3.15.1
mozilla-nspr-debugsource-4.9.6-3.15.1
mozilla-nspr-devel-4.9.6-3.15.1
mozilla-nss-3.14.3-9.29.2
mozilla-nss-certs-3.14.3-9.29.2
mozilla-nss-certs-debuginfo-3.14.3-9.29.2
mozilla-nss-debuginfo-3.14.3-9.29.2
mozilla-nss-debugsource-3.14.3-9.29.2
mozilla-nss-devel-3.14.3-9.29.2
mozilla-nss-sysinit-3.14.3-9.29.2
mozilla-nss-sysinit-debuginfo-3.14.3-9.29.2
mozilla-nss-tools-3.14.3-9.29.2
mozilla-nss-tools-debuginfo-3.14.3-9.29.2
seamonkey-2.17-2.61.2
seamonkey-debuginfo-2.17-2.61.2
seamonkey-debugsource-2.17-2.61.2
seamonkey-dom-inspector-2.17-2.61.2
seamonkey-irc-2.17-2.61.2
seamonkey-translations-common-2.17-2.61.2
seamonkey-translations-other-2.17-2.61.2
seamonkey-venkman-2.17-2.61.2
xulrunner-17.0.5-2.65.2
xulrunner-buildsymbols-17.0.5-2.65.2
xulrunner-debuginfo-17.0.5-2.65.2
xulrunner-debugsource-17.0.5-2.65.2
xulrunner-devel-17.0.5-2.65.2
xulrunner-devel-debuginfo-17.0.5-2.65.2
- openSUSE 12.1 (x86\_64):
libfreebl3-32bit-3.14.3-9.29.2
libfreebl3-debuginfo-32bit-3.14.3-9.29.2
libsoftokn3-32bit-3.14.3-9.29.2
libsoftokn3-debuginfo-32bit-3.14.3-9.29.2
mozilla-js-32bit-17.0.5-2.65.2
mozilla-js-debuginfo-32bit-17.0.5-2.65.2
mozilla-nspr-32bit-4.9.6-3.15.1
mozilla-nspr-debuginfo-32bit-4.9.6-3.15.1
mozilla-nss-32bit-3.14.3-9.29.2
mozilla-nss-certs-32bit-3.14.3-9.29.2
mozilla-nss-certs-debuginfo-32bit-3.14.3-9.29.2
mozilla-nss-debuginfo-32bit-3.14.3-9.29.2
mozilla-nss-sysinit-32bit-3.14.3-9.29.2
mozilla-nss-sysinit-debuginfo-32bit-3.14.3-9.29.2
xulrunner-32bit-17.0.5-2.65.2
xulrunner-debuginfo-32bit-17.0.5-2.65.2
- openSUSE 12.1 (ia64):
libfreebl3-debuginfo-x86-3.14.3-9.29.2
libfreebl3-x86-3.14.3-9.29.2
libsoftokn3-debuginfo-x86-3.14.3-9.29.2
libsoftokn3-x86-3.14.3-9.29.2
mozilla-js-debuginfo-x86-17.0.5-2.65.2
mozilla-js-x86-17.0.5-2.65.2
mozilla-nspr-debuginfo-x86-4.9.6-3.15.1
mozilla-nspr-x86-4.9.6-3.15.1
mozilla-nss-certs-debuginfo-x86-3.14.3-9.29.2
mozilla-nss-certs-x86-3.14.3-9.29.2
mozilla-nss-debuginfo-x86-3.14.3-9.29.2
mozilla-nss-sysinit-debuginfo-x86-3.14.3-9.29.2
mozilla-nss-sysinit-x86-3.14.3-9.29.2
mozilla-nss-x86-3.14.3-9.29.2
xulrunner-debuginfo-x86-17.0.5-2.65.2
xulrunner-x86-17.0.5-2.65.2
References:
<http://support.novell.com/security/cve/CVE-2013-0788.html>
<http://support.novell.com/security/cve/CVE-2013-0789.html>
<http://support.novell.com/security/cve/CVE-2013-0791.html>
<http://support.novell.com/security/cve/CVE-2013-0792.html>
<http://support.novell.com/security/cve/CVE-2013-0793.html>
<http://support.novell.com/security/cve/CVE-2013-0794.html>
<http://support.novell.com/security/cve/CVE-2013-0795.html>
<http://support.novell.com/security/cve/CVE-2013-0796.html>
<http://support.novell.com/security/cve/CVE-2013-0800.html>
<http://support.novell.com/security/cve/CVE-2013-1620.html>
<https://bugzilla.novell.com/813026>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/FBHKMFM42NXR6PIC6SAOED5F2MBDVJJL/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/FBHKMFM42NXR6PIC6SAOED5F2MBDVJJL/#FBHKMFM42NXR6PIC6SAOED5F2MBDVJJL)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from bugzilla.mozilla.org_d4adbbde_20250125_151434.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/837714)
* [XML](/show_bug.cgi?ctype=xml&id=837714)

Closed
[Bug 837714](/show_bug.cgi?id=837714)

Opened 12 years ago
Closed 12 years ago

# Assertion failure: allocated(), at ../../gc/Heap.h:472 or Opt-Crash [@ js::GCMarker::drainMarkStack]

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Assertion failure: allocated(), at ../../gc/Heap.h:472 or Opt-Crash [@ js::GCMarker::drainMarkStack]

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla22

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox19 | [-](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix) |
| firefox20 | [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=verified) |
| firefox21 | [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed) |
| firefox22 | [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=fixed) |
| firefox-esr17 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected) |
| b2g18 | --- | [disabled](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=disabled) |
| b2g18-v1.0.0 | --- | [disabled](/buglist.cgi?f1=cf_status_b2g18_1_0_0&o1=equals&v1=disabled) |
| b2g18-v1.0.1 | --- | [disabled](/buglist.cgi?f1=cf_status_b2g18_1_0_1&o1=equals&v1=disabled) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox19 | - | wontfix |
| firefox20 | + | verified |
| firefox21 | + | fixed |
| firefox22 | + | fixed |
| firefox-esr17 |  | unaffected |
| b2g18 |  | disabled |
| b2g18-v1.0.0 |  | disabled |
| b2g18-v1.0.1 |  | disabled |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: decoder, Assigned: dvander)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [dvander](/user_profile?user_id=309316)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/55857f92ded07119259dc6c1dd386205?d=mm&size=40)  [general](/user_profile?user_id=4729)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/b29b83d12aba827b8ff68296e473bec5?d=mm&size=40)  [decoder](/user_profile?user_id=395101)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

19 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (5 keywords, Whiteboard: [jsbugmon:update,ignore][adv-main20+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[jsbugmon:update,ignore][adv-main20+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ js::GCMarker::drainMarkStack ]](https://crash-stats.mozilla.org/signature/?signature=js%3A%3AGCMarker%3A%3AdrainMarkStack)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 1 obsolete file)

| [Testcase for shell](/attachment.cgi?id=709731)  [12 years ago](#c0)  [Christian Holler (:decoder)](/user_profile?user_id=395101)   2.16 KB, application/javascript |  | [Details](/attachment.cgi?id=709731&action=edit) |
| --- | --- | --- |
| [fix](/attachment.cgi?id=710471)  [12 years ago](#c5)  [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)   7.44 KB, patch | bhackett1024 : [review+](#c7 "12 years ago") | [Details](/attachment.cgi?id=710471&action=edit) | [Diff](/attachment.cgi?id=710471&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=837714&attachment=710471) |
| [fix v2](/attachment.cgi?id=715709)  [12 years ago](#c11)  [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)   782 bytes, patch | bhackett1024 : [review+](#a1320202_346231 "12 years ago")  bajaj : [approval-mozilla-aurora+](#c26 "12 years ago")  bajaj : [approval-mozilla-beta+](#c26 "12 years ago")  abillings : [sec-approval+](#a1329520_280903 "12 years ago") | [Details](/attachment.cgi?id=715709&action=edit) | [Diff](/attachment.cgi?id=715709&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=837714&attachment=715709) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=837714#c0)• 12 years ago |
|  | |

Attached file
[Testcase for shell](attachment.cgi?id=709731)
— [Details](attachment.cgi?id=709731&action=edit)

The attached testcase asserts on mozilla-central revision 847e28c7ba67 (run with --ion-eager).

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=837714#c1)• 12 years ago |
|  | |

Debug backtrace of assertion:
Program received signal SIGSEGV, Segmentation fault.
0x0804d5df in js::gc::ArenaHeader::getAllocKind (this=0xf742d000) at ../../gc/Heap.h:472
472 JS\_ASSERT(allocated());
(gdb) bt
#0 0x0804d5df in js::gc::ArenaHeader::getAllocKind (this=0xf742d000) at ../../gc/Heap.h:472
#1 0x08071615 in js::gc::Cell::getAllocKind (this=0xf742d010) at ../gc/Heap.h:960
#2 0x08116d6f in js::gc::GetGCThingTraceKind (thing=0xf742d010) at ../jsgcinlines.h:59
#3 0x083ab6e2 in js::gc::MarkKind (trc=0xffffb328, thingp=0xffffb21c, kind=JSTRACE\_OBJECT) at /srv/repos/mozilla-central/js/src/gc/Marking.cpp:353
#4 0x083abd38 in MarkValueInternal (trc=0xffffb328, v=0xf7434028) at /srv/repos/mozilla-central/js/src/gc/Marking.cpp:473
#5 0x083ac525 in js::gc::MarkObjectSlots (trc=0xffffb328, obj=(JSObject \*) 0xf7434010 [object Object], start=0, nslots=2) at /srv/repos/mozilla-central/js/src/gc/Marking.cpp:620
#6 0x082e24ae in js::ObjectImpl::markChildren (this=0xf7434010, trc=0xffffb328) at /srv/repos/mozilla-central/js/src/vm/ObjectImpl.cpp:308
#7 0x083ad679 in js::gc::MarkChildren (trc=0xffffb328, obj=(JSObject \*) 0xf7434010 [object Object]) at /srv/repos/mozilla-central/js/src/gc/Marking.cpp:943
#8 0x083aefe6 in js::TraceChildren (trc=0xffffb328, thing=0xf7434010, kind=JSTRACE\_OBJECT) at /srv/repos/mozilla-central/js/src/gc/Marking.cpp:1454
#9 0x08090364 in JS\_TraceChildren (trc=0xffffb328, thing=0xf7434010, kind=JSTRACE\_OBJECT) at /srv/repos/mozilla-central/js/src/jsapi.cpp:2442
#10 0x0812e4c7 in CheckForCompartmentMismatches (rt=0x891fd30) at /srv/repos/mozilla-central/js/src/jsgc.cpp:2653
#11 0x0812e54a in BeginMarkPhase (rt=0x891fd30) at /srv/repos/mozilla-central/js/src/jsgc.cpp:2666
#12 0x08132d01 in IncrementalCollectSlice (rt=0x891fd30, budget=-2, reason=JS::gcreason::DEBUG\_GC, gckind=js::GC\_NORMAL) at /srv/repos/mozilla-central/js/src/jsgc.cpp:4152
#13 0x08133455 in GCCycle (rt=0x891fd30, incremental=true, budget=-2, gckind=js::GC\_NORMAL, reason=JS::gcreason::DEBUG\_GC) at /srv/repos/mozilla-central/js/src/jsgc.cpp:4339
#14 0x08133906 in Collect (rt=0x891fd30, incremental=true, budget=-2, gckind=js::GC\_NORMAL, reason=JS::gcreason::DEBUG\_GC) at /srv/repos/mozilla-central/js/src/jsgc.cpp:4464
#15 0x08134026 in js::gc::RunDebugGC (cx=0x8946e18) at /srv/repos/mozilla-central/js/src/jsgc.cpp:4638
#16 0x080c430f in js::gc::NewGCThing<JSObject, (js::AllowGC)1> (cx=0x8946e18, kind=js::gc::FINALIZE\_OBJECT4\_BACKGROUND, thingSize=48) at ../jsgcinlines.h:501
#17 0x0858cdb4 in js::ion::NewGCThing (cx=0x8946e18, allocKind=js::gc::FINALIZE\_OBJECT4\_BACKGROUND, thingSize=48) at /srv/repos/mozilla-central/js/src/ion/VMFunctions.cpp:119
#18 0xf7fcad37 in ?? ()
Opt-crash trace:
==29044== Invalid read of size 4
==29044== at 0x82673C0: js::GCMarker::drainMarkStack(js::SliceBudget&) (Heap.h:671)
==29044== by 0x80CECF4: IncrementalCollectSlice(JSRuntime\*, long long, JS::gcreason::Reason, js::JSGCInvocationKind) (jsgc.cpp:3717)
==29044== by 0x80D0BB4: GCCycle(JSRuntime\*, bool, long long, js::JSGCInvocationKind, JS::gcreason::Reason) (jsgc.cpp:4339)
==29044== by 0x80D0FB9: \_ZL7CollectP9JSRuntimebxN2js18JSGCInvocationKindEN2JS8gcreason6ReasonE.part.284 (jsgc.cpp:4464)
==29044== by 0x80D1C31: js::gc::RunDebugGC(JSContext\*) (jsgc.cpp:4383)
==29044== by 0x8327E49: js::ion::IonCode::New(JSContext\*, unsigned char\*, unsigned int, JSC::ExecutablePool\*) (jsgcinlines.h:501)
==29044== by 0x835C8CB: \_ZN2js3ion6Linker7newCodeEP9JSContextPNS0\_14IonCompartmentE.constprop.408 (IonLinker.h:52)
==29044== by 0x835D03D: js::ion::IonCacheGetProperty::attachReadSlot(JSContext\*, js::ion::IonScript\*, JSObject\*, JSObject\*, JS::Handle<js::Shape\*>) (IonLinker.h:70)
==29044== by 0x8363DAE: js::ion::GetPropertyCache(JSContext\*, unsigned int, JS::Handle<JSObject\*>, JS::MutableHandle<JS::Value>) (IonCaches.cpp:925)
==29044== by 0x5549E1F: ???
==29044== Address 0xfc0b0 is not stack'd, malloc'd or (recently) free'd
Marking s-s based on opt-crash and GC involved.Crash Signature: [@ js::GCMarker::drainMarkStack]Keywords: [crash](/buglist.cgi?keywords=crash&resolution=---)Whiteboard: [jsbugmon:update,bisect]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=837714#a1887_395101)• 12 years ago |

Whiteboard: [jsbugmon:update,bisect] → [jsbugmon:update]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=837714#c2)• 12 years ago |
|  | |

JSBugMon: Bisection requested, result:
Due to skipped revisions, the first bad revision could be any of:
changeset: 106581:23a84dbb258f
user: Alex Crichton
date: Wed Jul 18 23:55:55 2012 -0700
summary: [Bug 775782](/show_bug.cgi?id=775782 "RESOLVED FIXED - IonMonkey: Instrument pro/epilogue for the SPS profiler") - Instrument pro/epilogue of functions for the SPS profiler in ionmonkey. r=pierron,dvander
changeset: 106582:b82fb4d04f60
parent: 106581:23a84dbb258f
parent: 100107:d78729026fb9
user: David Anderson
date: Mon Jul 23 12:37:49 2012 -0700
summary: Merge from [mozilla-central.
changeset: 106583:50e28df7ff8f](https://hg.mozilla.org/mozilla-central./rev/50e28df7ff8f)
parent: 106582:b82fb4d04f60
parent: 100276:5598b8c4f271
user: David Anderson
date: Tue Jul 24 16:32:08 2012 -0700
summary: Merge from [mozilla-central.
changeset: 106584:7f0f1fdfa5e2](https://hg.mozilla.org/mozilla-central./rev/7f0f1fdfa5e2)
user: Nicolas B. Pierron
date: Tue Jul 24 17:24:08 2012 -0700
summary: [Bug 767349](/show_bug.cgi?id=767349 "RESOLVED FIXED - IonMonkey: All generated snapshots should be bailout friendly.") - Simulate hidden instructions when the target is hidden. r=luke
changeset: 106585:2af804d84437
user: Nicolas Pierron
date: Tue Jul 24 17:24:07 2012 -0700
summary: [Bug 767349](/show_bug.cgi?id=767349 "RESOLVED FIXED - IonMonkey: All generated snapshots should be bailout friendly.") - Track bad resume points when snapshots are encoded. r=dvander
changeset: 106586:eef915d5a18f
user: Nicolas B. Pierron
date: Tue Jul 24 17:48:47 2012 -0700
summary: [Bug 776748](/show_bug.cgi?id=776748 "RESOLVED FIXED - IonMonkey: \"Assertion failure: refcount_,\"") - Do not invalidate ionScript when JM is invalidated. r=dvander
changeset: 106587:41f66d0e46b3
user: David Anderson
date: Wed Jul 25 02:08:41 2012 -0700
summary: Backed out changeset eef915d5a18f
changeset: 106588:d80fbd8493f1
parent: 106587:41f66d0e46b3
parent: 100401:d03aed049b7b
user: David Anderson
date: Wed Jul 25 14:30:08 2012 -0700
summary: Merge from [mozilla-central.
changeset: 106589:81146d7c9f51](https://hg.mozilla.org/mozilla-central./rev/81146d7c9f51)
user: Sean Stangl
date: Wed Jul 25 17:10:20 2012 -0700
summary: [Bug 777570](/show_bug.cgi?id=777570 "RESOLVED FIXED - IonMonkey: visitMathFunctionD() should be isCall().") - visitMathFunctionD() should be isCall(). r=dvander
changeset: 106590:02f44534f7f5
user: Nicolas B. Pierron
date: Thu Jul 26 11:17:31 2012 -0700
summary: [Bug 776748](/show_bug.cgi?id=776748 "RESOLVED FIXED - IonMonkey: \"Assertion failure: refcount_,\"") - Do not invalidate ionScript when JM is invalidated. r=dvander
changeset: 106591:31f9c38e4cb9
parent: 106590:02f44534f7f5
parent: 100585:f528e021ceb1
user: David Anderson
date: Thu Jul 26 18:19:02 2012 -0700
summary: Merge from [mozilla-central.
changeset: 106592:1274d6819bae](https://hg.mozilla.org/mozilla-central./rev/1274d6819bae)
user: Jan de Mooij
date: Fri Jul 27 13:08:24 2012 -0700
summary: Fix hasLazyType assertion ([bug 777647](/show_bug.cgi?id=777647 "RESOLVED FIXED - IonMonkey: Four jit-tests assert: !hasLazyType()"), r=dvander).
changeset: 106593:ee40f69169e9
user: Jan de Mooij
date: Fri Jul 27 13:12:30 2012 -0700
summary: Don't go through GetPcScript to monitor AddValue edge cases ([bug 776022](/show_bug.cgi?id=776022 "RESOLVED FIXED - IonMonkey: Concatenating String objects is slow"), r=dvander).
changeset: 106594:ba811ef4de1c
user: David Anderson
date: Fri Jul 27 14:57:07 2012 -0700
summary: Fix typo in recent merge.
changeset: 106595:a21e8bf3531f
user: David Anderson
date: Fri Jul 27 16:13:02 2012 -0700
summary: Include loop entry types when determining OSR types ([bug 774644](/show_bug.cgi?id=774644 "RESOLVED FIXED - IonMonkey: Differential Testing: Missing ReferenceError with ion."), r=jandem).
changeset: 106596:a9addbf7e526
user: Jan de Mooij
date: Tue Jul 24 16:39:17 2012 +0200
summary: [mq]: heur
changeset: 106597:db83474903a5
user: David Anderson
date: Fri Jul 27 17:16:35 2012 -0700
summary: Backed out changeset a9addbf7e526
changeset: 106598:ae339e63d268
user: David Anderson
date: Fri Jul 27 17:17:26 2012 -0700
summary: Backout due to orange.
changeset: 106599:83c83b185199
user: Jan de Mooij
date: Tue Jul 24 16:39:17 2012 +0200
summary: Implement JSOP\_MOD for doubles ([bug 716694](/show_bug.cgi?id=716694 "RESOLVED FIXED - IonMonkey: Extend JSOP_MOD to work with float arguments"), r=dvander).
changeset: 106600:7a13838698ed
user: Shu-yu Guo
date: Sun Jul 29 11:52:45 2012 -0700
summary: Refactor |Compile| to be templated and not use fp ([bug 773339](/show_bug.cgi?id=773339 "RESOLVED FIXED - IonMonkey: Refactor Compile in Ion.cpp to be templated and not use fp"), r=dvander).
changeset: 106601:75f02a17f7cd
user: Jan de Mooij
date: Mon Jul 30 20:37:14 2012 +0200
summary: [Bug 776880](/show_bug.cgi?id=776880 "RESOLVED FIXED - IonMonkey: Assertion failure: addr % Cell::CellSize == 0, at ../../gc/Heap.h:826") - Fix dropArguments call in CallConstructor to include |this|. r=dvander
changeset: 106602:54f9ee5403f0
user: Jan de Mooij
date: Mon Jul 30 20:43:44 2012 +0200
summary: No bug - Add Compile to js::ion namespace to fix Clang build. r=dvander
changeset: 106603:08187a7ea897
parent: 106602:54f9ee5403f0
parent: 100846:4ca1d7d1d2da
user: David Anderson
date: Mon Jul 30 13:15:39 2012 -0700
summary: Merge from mozilla-central.
This iteration took 83.998 seconds to run.

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=837714#c3)• 12 years ago |
|  | |

Ccing IonMonkey/GC devs to figure out what's going on here :)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=837714#c4)• 12 years ago |
|  | |

This was not a failure I would have expected, so CC'ing the baseline compiler folks in case anything similar might affect them.
(1) Build a SetProp IC, needsBarrier() is false, so no write barriers are generated.
(2) -> Call Linker::newCode(cx) for the IC. GC turns needsBarrier=true.
(3) -> Attached ICs are purged.
(4) Unattached IC from (1) is then attached, violating GC invariants.
So we have to watch out for cases where allocating a code object changes barrier state. It looks like sstangl had to fix this in CodeGenerator already.
Brian suggests just suppressing GC when allocating the IC code object and that seems reasonable, patch soon.Assignee: general → dvanderGroup: core-securityStatus: NEW → ASSIGNED

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=837714#a123261_309316)• 12 years ago |

Group: core-security

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=837714#c5)• 12 years ago |
|  | |

Attached patch

[fix](attachment.cgi?id=710471&action=diff) (obsolete)
— [Details](attachment.cgi?id=710471&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=837714&attachment=710471)

[Attachment #710471](/attachment.cgi?id=710471&action=edit "fix") -
Flags: review?(bhackett1024)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=837714#c6)• 12 years ago |
|  | |

For anyone debugging horrible GC stuff in the future, this was sort of the workflow:
(1) Find the address that is faulting. In this case obj1 in |obj2.obj1| was finalized, but still accessible.
(2) Log when |obj1| gets allocated or finalized in jsgc.
(3) Log when MarkRuntime() gets called.
(\*) obj1 was getting finalized after a MarkRuntime() for incremental GC.
-> guessing missing write barrier
(4) Turn off GC validator which confused debugging
(5) Add hw watchpoint for &obj2.obj1
(\*) obj2.obj1 is set in C++, and write barrier is triggered.
-> likely the missing barrier is elsewhere and kills a whole graph of objects
(6) Use find/w <heap>, obj and add write barriers all over the place
(7) Repeat (6) for each containing object until something useful comes up
(\*) land on JIT code that is clearly missing a barrier
-> hw watchpoint on JIT code to see when it's created

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=837714#a148043_406194)• 12 years ago |

Keywords: [csec-uaf](/buglist.cgi?keywords=csec-uaf&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=837714#c7)• 12 years ago |
|  | |

Comment on [attachment 710471](/attachment.cgi?id=710471 "fix") [[details]](/attachment.cgi?id=710471&action=edit "fix") [[diff]](/attachment.cgi?id=710471&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=837714&attachment=710471)
fix
Review of [attachment 710471](/attachment.cgi?id=710471 "fix") [[details]](/attachment.cgi?id=710471&action=edit "fix") [[diff]](/attachment.cgi?id=710471&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=837714&attachment=710471):
-----------------------------------------------------------------
I think it would be simpler if the AutoSuppressGC was in newCode() and newIC() was removed. When we allocate the IonCode for a finished script compilation we are in an AutoEnterAnalysis, and as of [bug 772820](/show_bug.cgi?id=772820 "RESOLVED FIXED - Don't GC when analysis/inference/compilation is active") (landed for Fx 21) AutoEnterAnalysis will also suppress GC. So there is no difference between newIC and newCode, at least on Nightly.
[Attachment #710471](/attachment.cgi?id=710471&action=edit "fix") -
Flags: review?(bhackett1024) → review+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=837714#a277860_1689)• 12 years ago |

[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=affected)
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected)
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%3F)
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B)
[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=837714#c8)• 12 years ago |
|  | |

wontfixing for FF19 given where we are in the cycle, let's make sure to get sec-approval here before landing on m-c.
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix)
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=-)

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=837714#a730131_395101)• 12 years ago |

Whiteboard: [jsbugmon:update] → [jsbugmon:update,ignore]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=837714#c9)• 12 years ago |
|  | |

JSBugMon: The testcase found in this bug no longer reproduces (tried revision 84cb7aa96a52).

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=837714#c10)• 12 years ago |
|  | |

Batch edit: Bugs marked status-b2g18: affected after 2/13 branching of v1.0.1 are now also status-b2g18-v1.0.1: affected
[status-b2g18-v1.0.1](/buglist.cgi?f1=cf_status_b2g18_1_0_1&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_b2g18_1_0_1&o1=equals&v1=affected)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=837714#c11)• 12 years ago |
|  | |

Attached patch

[fix v2](attachment.cgi?id=715709&action=diff)
— [Details](attachment.cgi?id=715709&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=837714&attachment=715709)

Patch w/ suggestion
[Attachment #710471](/attachment.cgi?id=710471&action=edit "fix") -
Attachment is obsolete: true
[Attachment #715709](/attachment.cgi?id=715709&action=edit "fix v2") -
Flags: review?(bhackett1024)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=837714#c12)• 12 years ago |
|  | |

(In reply to Lukas Blakk [:lsblakk] from [comment #10](/show_bug.cgi?id=837714#c10 "VERIFIED FIXED - Assertion failure: allocated(), at ../../gc/Heap.h:472 or Opt-Crash [@ js::GCMarker::drainMarkStack]"))
> Batch edit: Bugs marked status-b2g18: affected after 2/13 branching of
> v1.0.1 are now also status-b2g18-v1.0.1: affected
If IonMonkey is still disabled on b2g18, it should be unaffected.

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=837714#a1320202_346231)• 12 years ago |

[Attachment #715709](/attachment.cgi?id=715709&action=edit "fix v2") -
Flags: review?(bhackett1024) → review+

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=837714#a1320487_406194)• 12 years ago |

[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=affected) → [disabled](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=disabled)
[status-b2g18-v1.0.0](/buglist.cgi?f1=cf_status_b2g18_1_0_0&o1=isnotempty):
--- → [disabled](/buglist.cgi?f1=cf_status_b2g18_1_0_0&o1=equals&v1=disabled)
[status-b2g18-v1.0.1](/buglist.cgi?f1=cf_status_b2g18_1_0_1&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_b2g18_1_0_1&o1=equals&v1=affected) → [disabled](/buglist.cgi?f1=cf_status_b2g18_1_0_1&o1=equals&v1=disabled)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=837714#a1320513_406194)• 12 years ago |

[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected)
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=837714#c13)• 12 years ago |
|  | |

Comment on [attachment 715709](/attachment.cgi?id=715709 "fix v2") [[details]](/attachment.cgi?id=715709&action=edit "fix v2") [[diff]](/attachment.cgi?id=715709&action=diff "fix v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=837714&attachment=715709)
fix v2
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Not easily.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
No.
Which older supported branches are affected by this flaw?
All.
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
The oldest branch might not have AutoSuppressGC, if that's the case we'll need an alternate fix. I haven't given that much thought yet but there are low-risk solutions.
How likely is this patch to cause regressions; how much testing does it need?
Very unlikely, just perf testing from awfy.
[Attachment #715709](/attachment.cgi?id=715709&action=edit "fix v2") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=837714#a1329520_280903)• 12 years ago |

[Attachment #715709](/attachment.cgi?id=715709&action=edit "fix v2") -
Flags: sec-approval? → sec-approval+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=837714#a1329556_280903)• 12 years ago |

[tracking-firefox22](/buglist.cgi?f1=cf_tracking_firefox22&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B)
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=%3F)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=837714#c14)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/b831500ca4be>

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=837714#c15)• 12 years ago |
|  | |

backed out: <https://hg.mozilla.org/integration/mozilla-inbound/rev/b831500ca4be>

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=837714#c16)• 12 years ago |
|  | |

err, <https://hg.mozilla.org/integration/mozilla-inbound/rev/6c126d076b0d>

|  | [bhavana bajaj [:bajaj]](/user_profile?user_id=448925) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=837714#a1497644_448925)• 12 years ago |

[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=%3F) → [20+](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=20%2B)

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=837714#c17)• 12 years ago |
|  | |

David: do you have a new patch to try out here?
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
[20+](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=20%2B) → [?](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=%3F)Flags: needinfo?(dvander)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=837714#c18)• 12 years ago |
|  | |

Whoops, sorry, forgot about this. It bounced for build bustage, will land a proper patch shortly.Flags: needinfo?(dvander)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=837714#c19)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/e6c86595edba>

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=837714#c20)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/e6c86595edba>Status: ASSIGNED → RESOLVEDClosed: 12 years ago
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla22

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=837714#a1980051_395101)• 12 years ago |

Status: RESOLVED → VERIFIED

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=837714#c21)• 12 years ago |
|  | |

JSBugMon: This bug has been automatically verified fixed.

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=837714#c22)• 12 years ago |
|  | |

Please prepare patches for all branches, including the ESR, now that this has stuck on m-c and is verified. Thanks!
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=%3F) → [20+](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=20%2B)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=837714#c23)• 12 years ago |
|  | |

Comment on [attachment 715709](/attachment.cgi?id=715709 "fix v2") [[details]](/attachment.cgi?id=715709&action=edit "fix v2") [[diff]](/attachment.cgi?id=715709&action=diff "fix v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=837714&attachment=715709)
fix v2
[Approval Request Comment]
Bug caused by (feature/regressing bug #):
User impact if declined:
Testing completed (on m-c, etc.):
Risk to taking this patch (and alternatives if risky):
String or UUID changes made by this patch:
[Approval Request Comment]
Bug caused by (feature/regressing bug #):
User impact if declined:
Testing completed (on m-c, etc.):
Risk to taking this patch (and alternatives if risky):
String or UUID changes made by this patch:
[Approval Request Comment]
Regression caused by (bug #):
User impact if declined:
Testing completed (on m-c, etc.):
Risk to taking this patch (and alternatives if risky):
[Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration:
User impact if declined:
Fix Landed on Version:
Risk to taking this patch (and alternatives if risky):
String or UUID changes made by this patch:
See <https://wiki.mozilla.org/Release_Management/ESR_Landing_Process> for more info.
[Attachment #715709](/attachment.cgi?id=715709&action=edit "fix v2") -
Flags: approval-mozilla-esr17?
[Attachment #715709](/attachment.cgi?id=715709&action=edit "fix v2") -
Flags: approval-mozilla-beta?
[Attachment #715709](/attachment.cgi?id=715709&action=edit "fix v2") -
Flags: approval-mozilla-aurora?

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=837714#c24)• 12 years ago |
|  | |

Whoops, missed the questionnaire
Bug caused by: IonMonkey
User impact if declined: Possible sg:crit
Testing completed: Yes
Risk to taking this patch: Very little
String or UUID changes made by this patch: None

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=837714#c25)• 12 years ago |
|  | |

Comment on [attachment 715709](/attachment.cgi?id=715709 "fix v2") [[details]](/attachment.cgi?id=715709&action=edit "fix v2") [[diff]](/attachment.cgi?id=715709&action=diff "fix v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=837714&attachment=715709)
fix v2
Actually IonMonkey is 18 so this doesn't need ESR17 landing.
[Attachment #715709](/attachment.cgi?id=715709&action=edit "fix v2") -
Flags: approval-mozilla-esr17?

|  | [bhavana bajaj [:bajaj]](/user_profile?user_id=448925) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=837714#c26)• 12 years ago |
|  | |

Comment on [attachment 715709](/attachment.cgi?id=715709 "fix v2") [[details]](/attachment.cgi?id=715709&action=edit "fix v2") [[diff]](/attachment.cgi?id=715709&action=diff "fix v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=837714&attachment=715709)
fix v2
Please make sure to land before tomorrow(3/5) to make this into FX20 beta3 going to build tomorrow.
[Attachment #715709](/attachment.cgi?id=715709&action=edit "fix v2") -
Flags: approval-mozilla-beta?
[Attachment #715709](/attachment.cgi?id=715709&action=edit "fix v2") -
Flags: approval-mozilla-beta+
[Attachment #715709](/attachment.cgi?id=715709&action=edit "fix v2") -
Flags: approval-mozilla-aurora?
[Attachment #715709](/attachment.cgi?id=715709&action=edit "fix v2") -
Flags: approval-mozilla-aurora+

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=837714#c27)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/c0633e54e6ff>

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=837714#c28)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/f2321dba96fd>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=837714#a2499679_75935)• 12 years ago |

[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed)

|  | [Ioana (away)](/user_profile?user_id=422957) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=837714#c29)• 12 years ago |
|  | |

Verified as fixed on Firefox 20 beta (03/06 mozilla-beta repo).
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=verified)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=837714#c30)• 12 years ago |
|  | |

(In reply to David Anderson [:dvander] from [comment #25](/show_bug.cgi?id=837714#c25 "VERIFIED FIXED - Assertion failure: allocated(), at ../../gc/Heap.h:472 or Opt-Crash [@ js::GCMarker::drainMarkStack]"))
> Comment on [attachment 715709](/attachment.cgi?id=715709 "fix v2") [[details]](/attachment.cgi?id=715709&action=edit "fix v2") [[diff]](/attachment.cgi?id=715709&action=diff "fix v2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=837714&attachment=715709)
> fix v2
>
> Actually IonMonkey is 18 so this doesn't need ESR17 landing.
Given that, marking ESR17's status accordingly.
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected)
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
[20+](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=20%2B) → ---

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=837714#a4248839_280903)• 12 years ago |

Whiteboard: [jsbugmon:update,ignore] → [jsbugmon:update,ignore][adv-main20+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=837714#a25420127_1689)• 11 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=837714&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Christian Holler (:decoder)](/user_profile?user_id=395101)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_3a3b27d5_20250125_151435.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/839209)
* [XML](/show_bug.cgi?ctype=xml&id=839209)

Closed
[Bug 839209](/show_bug.cgi?id=839209)

Opened 12 years ago
Closed 12 years ago

# Assertion failure: kind == GetGCThingTraceKind(\*thingp), at gc/Marking.cpp:353

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Assertion failure: kind == GetGCThingTraceKind(\*thingp), at gc/Marking.cpp:353

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla22

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox18 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=unaffected) |
| firefox19 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix) |
| firefox20 | [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed) |
| firefox21 | [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed) |
| firefox22 | [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=fixed) |
| firefox-esr17 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected) |
| b2g18 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox18 |  | unaffected |
| firefox19 |  | wontfix |
| firefox20 | + | fixed |
| firefox21 | + | fixed |
| firefox22 | + | fixed |
| firefox-esr17 |  | unaffected |
| b2g18 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: decoder, Assigned: nihsanullah)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/704c0ff8acf47109e799096e386c051b?d=mm&size=40)  [nihsanullah](/user_profile?user_id=441971)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/55857f92ded07119259dc6c1dd386205?d=mm&size=40)  [general](/user_profile?user_id=4729)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/b29b83d12aba827b8ff68296e473bec5?d=mm&size=40)  [decoder](/user_profile?user_id=395101)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [consider backing out bug 781657] [jsbugmon:update,ignore][adv-main20+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[consider backing out bug 781657] [jsbugmon:update,ignore][adv-main20+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c25 "12 years ago") | ? |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | ? |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [patch](/attachment.cgi?id=726704)  [12 years ago](#c14)  [Brian Hackett [Laid off!]](/user_profile?user_id=346231)   1002 bytes, patch | dvander : [review+](#a3450430_309316 "12 years ago")  lsblakk : [approval-mozilla-aurora+](#c24 "12 years ago")  lsblakk : [approval-mozilla-beta+](#c24 "12 years ago")  abillings : [sec-approval+](#c17 "12 years ago") | [Details](/attachment.cgi?id=726704&action=edit) | [Diff](/attachment.cgi?id=726704&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=839209&attachment=726704) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=839209#c0)• 12 years ago |
|  | |

The following testcase asserts on mozilla-central revision d55669a02834 (no options required):
var N = 100\*1000;
function build(N) {
var chainTop = null;
for (var i = 0; i != N; ++i) {
var f = Function('some\_arg'+i, ' return /test/;');
var re = f();
(f) = chainTop;
}
}
var chainTop = build(N);

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=839209#c1)• 12 years ago |
|  | |

S-s due to GC-related assertion.Whiteboard: [jsbugmon:update,bisect]

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=839209#c2)• 12 years ago |
|  | |

I think the assertion is in gc::MarkKind. Marking something incorrectly sounds possibly quite bad.Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Bill McCloskey [inactive unless it's an emergency] (:billm)](/user_profile?user_id=389993) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=839209#c3)• 12 years ago |
|  | |

Is the bisect robot not working? I tried bisecting myself, but for some reason I can't build old revisions anymore because of a python error.
Traceback (most recent call last):
File "../config/pythonpath.py", line 56, in <module>
main(sys.argv[1:])
File "../config/pythonpath.py", line 48, in main
execfile(script, frozenglobals)
File "../config/expandlibs\_exec.py", line 26, in <module>
from expandlibs import ExpandArgs, relativize, isObject, ensureParentDir, ExpandLibsDeps
File "/home/billm/mozilla/in4/js/src/config/expandlibs.py", line 31, in <module>
import expandlibs\_config as conf
File "/home/billm/mozilla/in4/js/src/config/expandlibs\_config.py", line 5, in <module>
def normalize\_suffix(suffix):
ImportError: No module named buildconfig

|  | [Jesse Ruderman](/user_profile?user_id=11608) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=839209#c4)• 12 years ago |
|  | |

> for some reason I can't build old revisions anymore because of a python error
> ImportError: No module named buildconfig
Try blowing away all \*.pyc files each time you update.

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=839209#a582418_395101)• 12 years ago |

Whiteboard: [jsbugmon:update,bisect] → [jsbugmon:update]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=839209#c5)• 12 years ago |
|  | |

JSBugMon: Bisection requested, result:
autoBisect shows this is probably related to the following changeset:
The first bad revision is:
changeset: 111162:9a5191dfae8d
user: Brian Hackett
date: Tue Oct 23 09:20:56 2012 -0700
summary: Keep the interpreter stack synced for GC scanning, [bug 781657](/show_bug.cgi?id=781657 "RESOLVED FIXED - Investigate requiring JM+TI to keep a fully synced interpreter stack"). r=billm
This iteration took 92.237 seconds to run.

|  | [David Bolter [:davidb] (NeedInfo me for attention)](/user_profile?user_id=152868) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=839209#c6)• 12 years ago |
|  | |

I'm guessing Brian can own this? (cc+ dvander)Assignee: general → bhackett1024

|  | [David Bolter [:davidb] (NeedInfo me for attention)](/user_profile?user_id=152868) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=839209#c7)• 12 years ago |
|  | |

(meant to cc Naveed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=839209#a607468_1689)• 12 years ago |

[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=unaffected)
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected)
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B)
[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=839209#a1816897_1689)• 12 years ago |

[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected)
[tracking-firefox22](/buglist.cgi?f1=cf_tracking_firefox22&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=839209#c8)• 12 years ago |
|  | |

Naveed - this is a recent sec-critical regression with an actionable testcase and a known regressing bug. Should we consider backing out [bug 781657](/show_bug.cgi?id=781657 "RESOLVED FIXED - Investigate requiring JM+TI to keep a fully synced interpreter stack").Assignee: bhackett1024 → nihsanullahKeywords: [regression](/buglist.cgi?keywords=regression&resolution=---)Whiteboard: [jsbugmon:update] → [jsbugmon:update][consider backing out bug 781657]

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=839209#c9)• 12 years ago |
|  | |

WFM on tip. Lots of stuff depends on [bug 785167](/show_bug.cgi?id=785167 "RESOLVED FIXED - ctypes gives out relocatable pointers to ArrayBuffer data") and it can't be backed out. Having more information about the original failure would be good; there were a couple regressions from [bug 781657](/show_bug.cgi?id=781657 "RESOLVED FIXED - Investigate requiring JM+TI to keep a fully synced interpreter stack") that only manifested as null dereferences, and may have fixed this.

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=839209#a3380101_395101)• 12 years ago |

Whiteboard: [jsbugmon:update][consider backing out bug 781657] → [jsbugmon:update,reconfirm][consider backing out bug 781657]

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=839209#c10)• 12 years ago |
|  | |

(In reply to Brian Hackett (:bhackett) from [comment #9](/show_bug.cgi?id=839209#c9 "VERIFIED FIXED - Assertion failure: kind == GetGCThingTraceKind(*thingp), at gc/Marking.cpp:353"))
> WFM on tip. Lots of stuff depends on [bug 785167](/show_bug.cgi?id=785167 "RESOLVED FIXED - ctypes gives out relocatable pointers to ArrayBuffer data") and it can't be backed out.
> Having more information about the original failure would be good; there were
> a couple regressions from [bug 781657](/show_bug.cgi?id=781657 "RESOLVED FIXED - Investigate requiring JM+TI to keep a fully synced interpreter stack") that only manifested as null
> dereferences, and may have fixed this.
What's the discoverability/exploitability of this bug? We're trying to determine whether this should still be made a priority ahead of release.
If so, we can loop in Matt Wobensmith (security QA) and others to find the fix range.Whiteboard: [jsbugmon:update,reconfirm][consider backing out bug 781657] → [jsbugmon:update,reconfirm]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=839209#a3380521_395101)• 12 years ago |

Whiteboard: [jsbugmon:update,reconfirm] → [consider backing out bug 781657] [jsbugmon:update,reconfirm,ignore]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=839209#c11)• 12 years ago |
|  | |

JSBugMon: This bug has been automatically confirmed to be still valid (reproduced on revision e23e43a2c14e).

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=839209#c12)• 12 years ago |
|  | |

Brian, as [comment 11](/show_bug.cgi?id=839209#c11 "VERIFIED FIXED - Assertion failure: kind == GetGCThingTraceKind(*thingp), at gc/Marking.cpp:353") shows this bug still repros on tip. What architecture did you try?Flags: needinfo?(bhackett1024)Whiteboard: [consider backing out bug 781657] [jsbugmon:update,reconfirm,ignore] → [consider backing out bug 781657] [jsbugmon:update]

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=839209#c13)• 12 years ago |
|  | |

I still can't reproduce. I've tried x64/linux, x64/darwin, and x86/darwin.Flags: needinfo?(bhackett1024)

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=839209#c14)• 12 years ago |
|  | |

Attached patch

[patch](attachment.cgi?id=726704&action=diff)
— [Details](attachment.cgi?id=726704&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=839209&attachment=726704)

OK, was able to reproduce with help from decoder. The problem is an interaction of a couple things:
- JM does not guarantee a correctly synced payload for dead values that can only be seen by the GC, in cases where the value's type is not traceable and should be ignored by the GC.
- Due to a quirk with how Value operations are implemented on x64, values with a null type tag but a non-null payload are treated by the GC as traceable, and will be traced as if they are strings. These values will not be treated as traceable on x86.
Fixing the quirk might be nice, but doing that just to placate JM's torn values doesn't seem right. This patch just forces JM to keep null values fully synced.
[Attachment #726704](/attachment.cgi?id=726704&action=edit "patch") -
Flags: review?(dvander)

|  | [David Anderson [:dvander] - inactive, e-mail if emergency](/user_profile?user_id=309316) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=839209#a3450430_309316)• 12 years ago |

[Attachment #726704](/attachment.cgi?id=726704&action=edit "patch") -
Flags: review?(dvander) → review+

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=839209#c15)• 12 years ago |
|  | |

Comment on [attachment 726704](/attachment.cgi?id=726704 "patch") [[details]](/attachment.cgi?id=726704&action=edit "patch") [[diff]](/attachment.cgi?id=726704&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=839209&attachment=726704)
patch
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
very hard
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
no
Which older supported branches are affected by this flaw?
19+
If not all supported branches, which bug introduced the flaw?
[bug 781657](/show_bug.cgi?id=781657 "RESOLVED FIXED - Investigate requiring JM+TI to keep a fully synced interpreter stack")
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
trivial
How likely is this patch to cause regressions; how much testing does it need?
none
[Attachment #726704](/attachment.cgi?id=726704&action=edit "patch") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=839209#c16)• 12 years ago |
|  | |

Adding Release Management to discuss when we want to give sec-approval and take this. I do see that it is a pretty tiny patch.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=839209#c17)• 12 years ago |
|  | |

Comment on [attachment 726704](/attachment.cgi?id=726704 "patch") [[details]](/attachment.cgi?id=726704&action=edit "patch") [[diff]](/attachment.cgi?id=726704&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=839209&attachment=726704)
patch
Sec-approval+. Please prepare patches for Aurora and Beta too and nominate them ASAP so maybe we can release this fix.
[Attachment #726704](/attachment.cgi?id=726704&action=edit "patch") -
Flags: sec-approval? → sec-approval+

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=839209#c18)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/4bb793ac828d>

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=839209#c19)• 12 years ago |
|  | |

Comment on [attachment 726704](/attachment.cgi?id=726704 "patch") [[details]](/attachment.cgi?id=726704&action=edit "patch") [[diff]](/attachment.cgi?id=726704&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=839209&attachment=726704)
patch
[Approval Request Comment]
Bug caused by (feature/regressing bug #): 781657
User impact if declined: potential exploit
Testing completed (on m-c, etc.): on m-i
Risk to taking this patch (and alternatives if risky): none
[Attachment #726704](/attachment.cgi?id=726704&action=edit "patch") -
Flags: approval-mozilla-beta?
[Attachment #726704](/attachment.cgi?id=726704&action=edit "patch") -
Flags: approval-mozilla-aurora?

|  | [Brian Hackett [Laid off!]](/user_profile?user_id=346231) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=839209#c20)• 12 years ago |
|  | |

This looks like it will apply clean to aurora/beta.

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=839209#a3514099_395101)• 12 years ago |

Whiteboard: [consider backing out bug 781657] [jsbugmon:update] → [consider backing out bug 781657] [jsbugmon:update,ignore]

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=839209#c21)• 12 years ago |
|  | |

JSBugMon: The testcase found in this bug no longer reproduces (tried revision 1d6fe70c79c5).

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=839209#c22)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/4bb793ac828d>Status: NEW → RESOLVEDClosed: 12 years ago
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla22

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=839209#a3519073_395101)• 12 years ago |

Status: RESOLVED → VERIFIED

|  | [Christian Holler (:decoder)](/user_profile?user_id=395101)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=839209#c23)• 12 years ago |
|  | |

JSBugMon: This bug has been automatically verified fixed.

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=839209#c24)• 12 years ago |
|  | |

Comment on [attachment 726704](/attachment.cgi?id=726704 "patch") [[details]](/attachment.cgi?id=726704&action=edit "patch") [[diff]](/attachment.cgi?id=726704&action=diff "patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=839209&attachment=726704)
patch
Low/no risk, verified, let's get this into our final FF20 beta.
[Attachment #726704](/attachment.cgi?id=726704&action=edit "patch") -
Flags: approval-mozilla-beta?
[Attachment #726704](/attachment.cgi?id=726704&action=edit "patch") -
Flags: approval-mozilla-beta+
[Attachment #726704](/attachment.cgi?id=726704&action=edit "patch") -
Flags: approval-mozilla-aurora?
[Attachment #726704](/attachment.cgi?id=726704&action=edit "patch") -
Flags: approval-mozilla-aurora+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=839209#c25)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/0145d8911247>
<https://hg.mozilla.org/releases/mozilla-beta/rev/3ed701c01eb2>
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=fixed)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed)Flags: in-testsuite?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=839209#a3974159_280903)• 12 years ago |

Whiteboard: [consider backing out bug 781657] [jsbugmon:update,ignore] → [consider backing out bug 781657] [jsbugmon:update,ignore][adv-main20+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=839209#a25145418_1689)• 11 years ago |

Group: core-security
You need to [log in](/show_bug.cgi?id=839209&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Brian Hackett [Laid off!]](/user_profile?user_id=346231)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


