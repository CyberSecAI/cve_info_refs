=== Content from access.redhat.com_eedbe949_20250126_080148.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.openwall.com_ba43c6bf_20250125_103317.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <50F9AAB8.5060303@redhat.com>
Date: Fri, 18 Jan 2013 13:04:08 -0700
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Jan Lieskovsky <jlieskov@...hat.com>,
        "Steven M. Christey" <coley@...us.mitre.org>,
        Tomas Hozza <thozza@...hat.com>, Josh Stone <jistone@...hat.com>
Subject: Re: CVE Request -- dnsmasq: Incomplete fix for the
 CVE-2012-3411 issue

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 01/18/2013 06:31 AM, Jan Lieskovsky wrote:
> Hello Kurt, Steve, vendors,
>
> the CVE-2012-3411 identifier has been originally assigned to the
> following issue:
>
> When dnsmasq is used in conjunctions with certain configurations of
> libvirtd, network packets from prohibited networks (e.g. packets
> that should not be passed in) may be sent to the dnsmasq
> application and processed. This can result in DNS amplification
> attacks for example. [1]
> <http://www.openwall.com/lists/oss-security/2012/07/12/5>
>
> Later it was found: [2]
> <https://bugzilla.redhat.com/show_bug.cgi?id=894486> [3]
> <https://bugzilla.redhat.com/show_bug.cgi?id=894486#c3>
>
> the upstream patch for CVE-2012-3411 it not to be working
> properly, as it still allowed (from [3]):
>
> * replies to remote TCP-protocol based DNS queries (UDP protocol
> ones were corrected, but TCP ones not) from prohibited networks,
> when the --bind-dynamic option was used,
>
> * when --except-interface lo option was used dnsmasq didn't answer
> local or remote UDP DNS queries, but still allowed TCP protocol
> based DNS queries,
>
> * when --except-interface lo option was not used local / remote TCP
> DNS queries were also still answered by dnsmasq.
>
> Could you allocate a new CVE identifier for this? (as an incomplete
> fix for CVE-2012-3411 issue)
>
> Thank you && Regards, Jan. -- Jan iankko Lieskovsky / Red Hat
> Security Response Team

Please use CVE-2013-0198 for this issue.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQIcBAEBAgAGBQJQ+aq3AAoJEBYNRVNeJnmTRxUP/2Qrpz52gOOcAk5Pdc50kue4
nP8i7VOVsV+0rjmJ3U8xbbnERQkzvoNtuTel/wsjg4qT9EY3XUQ4N8qJyYPpJD3U
Gsy4BrBeVT9ZpUXiRtKfYxP0E9G6OPGu5tMTK1baYuFRS9czObTBk4JamPnapv9Z
t+48GmilchuYlyn0yxRp77aG7nrSt/YCgX7MTdEyAOWP8q+wYPc2/jBkNERcRp1U
VMqnTgOWH9IjUXhLWKwmCoJKescbVjRH8snGHeShDx1l+fzwKVEcFt2s5sEX/fll
aLoRUOZ9qxAP3wYo0vkeoWEJZr/TxqqAraHi95gkCxtcPCIJ1w+qh1Zg9cOZ8Rnl
KfmGbNaiqo3zQo/3lBqCZmTn/DovppQv992b0HMGsGyaRpw1Btylr5txGqWHldcG
y31L8Ij5SuKmh4vnqTpZb1ax18OgxUCD91Id7RNk5ofTv676zr3xaSqbk0+nqYqe
KRKrfoD7ShlAWqO1J0QYVCY63hzS+YdvwrT9C1QMa7yvgpsaIeVgPnhrfQEaGazd
QXJFd76oD6V6+/AlTMFCdY6VgsFy8rLhDXj0RDC/3u+ZZnxl9RXZ9x/gwXYv/EnO
TvSNJluKAjWcebuJbZzPn25IWnGVXyjppOoy9ZjOEFoz78N2y2qE8oJeALL6RlXe
fnjNc4y3IkmdWllKnzPM
=H+Cc
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from access.redhat.com_2e2df0a0_20250126_080147.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.mandriva.com_9331f9cb_20250125_103317.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from bugzilla.redhat.com_2258c626_20250125_103319.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D894486)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D894486)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D894486)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 894486

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 894486**](show_bug.cgi?id=894486)
(CVE-2013-0198)
- [CVE-2013-0198](https://access.redhat.com/security/cve/CVE-2013-0198) dnsmasq: Incomplete fix for the [CVE-2012-3411](https://access.redhat.com/security/cve/CVE-2012-3411) issue

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2013-0198 dnsmasq: Incomplete fix for the CVE-2012-3411 issue

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2013-0198 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [886663](show_bug.cgi?id=886663 "CLOSED CURRENTRELEASE - libvirt-launched dnsmasq listens on localhost when it shouldn't") [901555](show_bug.cgi?id=901555 "CLOSED ERRATA - CVE-2013-0198 dnsmasq: Incomplete fix for the CVE-2012-3411 issue [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [838539](show_bug.cgi?id=838539) | | TreeView+ | [depends on](buglist.cgi?bug_id=894486&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=894486&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2013-01-11 21:03 UTC by Josh Stone | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-17 08:11 UTC ([History](show_activity.cgi?id=894486)) | | [CC List:](page.cgi?id=fields.html#cclist) | 15 users (show)  aquini berrange clalancette eblake itamar jforbes jlieskov jrusnack jyang laine libvirt-maint simon thozza veillard virt-maint | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2013-02-27 10:11:30 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**Proposed patch from upstream**](attachment.cgi?id=682464 "View the content of the attachment") (1.33 KB, patch)  [2013-01-18 14:57 UTC](#attach_682464 "Go to the comment associated with the attachment"), Tomáš Hozza | *no flags* | [Details](attachment.cgi?id=682464&action=edit) | [Diff](attachment.cgi?id=682464&action=diff) | | [View All](attachment.cgi?bugid=894486&action=viewall) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=894486#c0)  Josh Stone    2013-01-11 21:03:31 UTC  ``` Description of problem: On my workstation, as a virtual machine host, I have NetworkManager's dnsmasq configured to forward DNS queries for a local domain to 192.168.122.1, so I can resolve those to virtual machine DHCP hostnames.  Recently this stopped working.  With manual dig commands, I found that TCP queries still work, but UDP doesn't.  For example, in libvirt I have a statically defined name "vhost" to 192.168.122.1 itself.  From the host, the command "dig +short +tcp @192.168.122.1 vhost" resolves that just fine.  But "dig +short +notcp @192.168.122.1 vhost" says "connection timed out; no servers could be reached".  From a guest, +tcp and +notcp both work fine.  Version-Release number of selected component (if applicable): libvirt-0.9.11.8-2.fc17.x86_64, dnsmasq-2.63-1.fc17.x86_64 I also tried dnsmasq-2.65-1.fc17.x86_64 from updates-testing  How reproducible: 100%  Steps to Reproduce: 1. From the virtual machine host, try to query the libvirt dnsmasq.    Actual results: $ dig +short +tcp @192.168.122.1 vhost 192.168.122.1 $ dig +short +notcp @192.168.122.1 vhost ;; connection timed out; no servers could be reached  Expected results: A positive answer from both TCP and UDP queries.  Additional info: I suspect this is related to the fixes for [CVE-2012-3411](https://access.redhat.com/security/cve/CVE-2012-3411), but it seems weird that UDP and TCP would be treated differently.   ```  [Comment 1](show_bug.cgi?id=894486#c1)  Josh Stone    2013-01-17 19:30:07 UTC  ``` This is still a problem on F18, but I've reproduced it with dnsmasq alone, so I'm retitling and reassigning this bug.  Using dnsmasq-2.65-1.fc18.x86_64, the difference is demonstrated between --bind-dynamic and the old --bind-interfaces.  A local query to dnsmasq --bind-dynamic works in TCP, but times out in UDP: # dnsmasq --no-daemon --conf-file= --bind-dynamic --interface em1 --except-interface lo  $ dig +tcp +short @192.168.1.203 localhost 127.0.0.1 $ dig +notcp +short @192.168.1.203 localhost ;; connection timed out; no servers could be reached   The same query with --bind-interfaces works fine either way: # dnsmasq --no-daemon --conf-file= --bind-interfaces --interface em1 --except-interface lo  $ dig +tcp +short @192.168.1.203 localhost 127.0.0.1 $ dig +notcp +short @192.168.1.203 localhost 127.0.0.1   ```  [Comment 2](show_bug.cgi?id=894486#c2)  Jan Lieskovsky    2013-01-18 13:09:54 UTC  ``` Thank you for your report, Josh. I am going to steal this bug to be a security response product one (the issue is a security flaw). More details to come.   ```  [Comment 3](show_bug.cgi?id=894486#c3)  Jan Lieskovsky    2013-01-18 13:25:10 UTC  ``` Old issue #1 - Originally, Common Vulnerabilities and Exposures assigned an identifier [CVE-2012-3411](https://access.redhat.com/security/cve/CVE-2012-3411) to the following vulnerability:  When dnsmasq is used in conjunctions with certain configurations of libvirtd, network packets from prohibited networks (e.g. packets that should not be passed in) may be sent to the dnsmasq application and processed. This can result in DNS amplification attacks for example.  <http://www.openwall.com/lists/oss-security/2012/07/12/5>  --  New issue #2 - Later it was found that after the upstream patch for [CVE-2012-3411](https://access.redhat.com/security/cve/CVE-2012-3411) issue was applied, dnsmasq still:  * replied to remote TCP-protocol based DNS queries (UDP protocol ones were corrected, but TCP ones not) from prohibited networks, when the --bind-dynamic option was used,  * when --except-interface lo option was used dnsmasq didn't answer local or remote UDP DNS queries, but still allowed TCP protocol based DNS queries,  * when --except-interface lo option was not used local / remote TCP DNS queries were also still answered by dnsmasq.   ```  [Comment 4](show_bug.cgi?id=894486#c4)  Jan Lieskovsky    2013-01-18 13:33:36 UTC  ``` CVE request:   <http://www.openwall.com/lists/oss-security/2013/01/18/2>   ```  [Comment 5](show_bug.cgi?id=894486#c5)  Tomáš Hozza    2013-01-18 13:46:44 UTC  ``` I contacted upstream to discuss possible fix.   ```  [Comment 6](show_bug.cgi?id=894486#c6)  Jan Lieskovsky    2013-01-18 13:51:07 UTC  ``` This issue did NOT affect the version of the dnsmasq package, as shipped with Red Hat Enterprise Linux 5 as the fix for the original [CVE-2012-3411](https://access.redhat.com/security/cve/CVE-2012-3411) issue has not been applied yet to version of dnsmasq as shipped with Red Hat Enterprise Linux 5.  --  This issue did NOT affect the version of the dnsmasq package, as shipped with Red Hat Enterprise Linux 6. The fix in Red Hat Enterprise Linux 6 is based on different logic and as such is immune to the incomplete fix behaviour.  --  This issue affects the versions of the dnsmasq package, as shipped with Fedora release of 17 and 18. Please schedule an update (once there is final upstream patch available).   ```  [Comment 7](show_bug.cgi?id=894486#c7)  Jan Lieskovsky    2013-01-18 13:51:52 UTC  ``` Created dnsmasq tracking bugs for this issue  Affects: fedora-all [[bug 901555](show_bug.cgi?id=901555 "CLOSED ERRATA - CVE-2013-0198 dnsmasq: Incomplete fix for the CVE-2012-3411 issue [fedora-all]")]   ```  [Comment 9](show_bug.cgi?id=894486#c9)  Jan Lieskovsky    2013-01-18 14:09:21 UTC  ```  Statement:  Not vulnerable. This issue did not affect the versions of dnsmasq as shipped with Red Hat Enterprise Linux 5 and 6.   ```  [Comment 11](show_bug.cgi?id=894486#c11)  Tomáš Hozza    2013-01-18 14:57:15 UTC  ``` Created [attachment 682464](attachment.cgi?id=682464&action=diff "Proposed patch from upstream") [[details]](attachment.cgi?id=682464&action=edit "Proposed patch from upstream") Proposed patch from upstream  Proposed patch. I'll do some testing.   ```  [Comment 13](show_bug.cgi?id=894486#c13)  Vincent Danen    2013-01-19 18:26:44 UTC  ``` [CVE-2013-0198](https://access.redhat.com/security/cve/CVE-2013-0198) assigned:  <http://www.openwall.com/lists/oss-security/2013/01/18/7>   ```  [Comment 15](show_bug.cgi?id=894486#c15)  Tomáš Hozza    2013-01-21 19:08:04 UTC  ``` There is one more thing for you Josh. Once we will fix this CVE it will not fix the issue you have described in the original Bug description. After the fix dnsmasq will not answer UDP nor TCP local DNS queries.  The only solution how to get things working as before, libvirt would have to run dnsmasq instances WITHOUT "--except-interface lo" option. I'm not sure what is the reason for using this option in libvirt's case.  So you will have to file a new Bug on libvirt once this issue is fixed if you want dnsmasq behave the same way as you were used to. Maybe they can add some way how to configure if the --except-interface option is used.  Sorry for this.   ```  [Comment 16](show_bug.cgi?id=894486#c16)  Eric Blake    2013-01-21 20:27:37 UTC  ``` (In reply to [comment #15](show_bug.cgi?id=894486#c15)) > There is one more thing for you Josh. Once we will fix this CVE it will not > fix the issue you have described in the original Bug description. After the > fix dnsmasq will not answer UDP nor TCP local DNS queries. >  > The only solution how to get things working as before, libvirt would have to > run dnsmasq instances WITHOUT "--except-interface lo" option. I'm not sure > what is the reason for using this option in libvirt's case. >  > So you will have to file a new Bug on libvirt once this issue is fixed if > you want dnsmasq behave the same way as you were used to. Maybe they can add > some way how to configure if the --except-interface option is used. >  > Sorry for this.  Libvirt is set up to parse dnsmasq capabilities from --help and --version output.  But we'd need a distinct string that we can find from newer dnsmasq (where --except-interface lo must NOT be used) in contrast to earlier dnsmasq (where it should probably still be used, to avoid a repeat of [bug 886663](show_bug.cgi?id=886663 "CLOSED CURRENTRELEASE - libvirt-launched dnsmasq listens on localhost when it shouldn't")).   ```  [Comment 17](show_bug.cgi?id=894486#c17)  Tomáš Hozza    2013-01-21 20:46:02 UTC  ``` (In reply to [comment #16](show_bug.cgi?id=894486#c16)) > Libvirt is set up to parse dnsmasq capabilities from --help and --version > output.  But we'd need a distinct string that we can find from newer dnsmasq > (where --except-interface lo must NOT be used) in contrast to earlier > dnsmasq (where it should probably still be used, to avoid a repeat of bug > 886663).  I see it won't be that easy. [Bug #886663](show_bug.cgi?id=886663 "CLOSED CURRENTRELEASE - libvirt-launched dnsmasq listens on localhost when it shouldn't") would happen also after fixing this CVE. I will investigate if and how it could be fixed.  Thank you for pointing this out.   ```  [Comment 18](show_bug.cgi?id=894486#c18)  Josh Stone    2013-01-21 21:05:37 UTC  ``` (In reply to [comment #15](show_bug.cgi?id=894486#c15)) > There is one more thing for you Josh. Once we will fix this CVE it will not > fix the issue you have described in the original Bug description. After the > fix dnsmasq will not answer UDP nor TCP local DNS queries.  Indeed, I reported that the glass was half full, and you decided it should be empty... :P  > The only solution how to get things working as before, libvirt would have to > run dnsmasq instances WITHOUT "--except-interface lo" option. I'm not sure > what is the reason for using this option in libvirt's case.  At least with dnsmasq-2.65-1.fc18, if you don't specify the exception, it will still bind to 127.0.0.1 and [::1], which it shouldn't per [bug #886663](show_bug.cgi?id=886663 "CLOSED CURRENTRELEASE - libvirt-launched dnsmasq listens on localhost when it shouldn't").  (In reply to [comment #16](show_bug.cgi?id=894486#c16)) > Libvirt is set up to parse dnsmasq capabilities from --help and --version > output.  But we'd need a distinct string that we can find from newer dnsmasq > (where --except-interface lo must NOT be used) in contrast to earlier > dnsmasq (where it should probably still be used, to avoid a repeat of bug > 886663).  Is there yet any version which can do what I'm hoping for?  I couldn't find any combination of options to make it work.  In short, I'd like DNS to answer on 192.168.122.1 either through virbr0 or locally.  It should not listen to localhost addresses (per 886663) nor any other interfaces (per these CVEs).  Perhaps this should be duped into a separate bug as a feature request?   ```  [Comment 19](show_bug.cgi?id=894486#c19)  Tomáš Hozza    2013-01-22 11:51:31 UTC  ``` (In reply to [comment #18](show_bug.cgi?id=894486#c18)) > Indeed, I reported that the glass was half full, and you decided it should > be empty... :P  True :) The current behaviour is not very secure.   > At least with dnsmasq-2.65-1.fc18, if you don't specify the exception, it > will still bind to 127.0.0.1 and [::1], which it shouldn't per [bug #886663](show_bug.cgi?id=886663 "CLOSED CURRENTRELEASE - libvirt-launched dnsmasq listens on localhost when it shouldn't").  The combination of options used when running dnsmasq is controlled by libvirt.  > Is there yet any version which can do what I'm hoping for?  I couldn't find > any combination of options to make it work.  You have to look for changes in libvirt. Regarding to libvirt's changelog you would want to use version 0.9.11.8-1, but unfortunately it was deleted.   > In short, I'd like DNS to answer on 192.168.122.1 either through virbr0 or > locally.  It should not listen to localhost addresses (per 886663) nor any > other interfaces (per these CVEs). Perhaps this should be duped into a > separate bug as a feature request?  New bug would be better to track your issue.   ```  [Comment 20](show_bug.cgi?id=894486#c20)  Tomáš Hozza    2013-01-22 14:15:15 UTC  ``` Upstream commit fixing this CVE:  <http://www.thekelleys.org.uk/gitweb/?p=dnsmasq.git;a=commit;h=22ce550e5346947a12a781ed0959a7b1165d0dc6>   ```  [Comment 21](show_bug.cgi?id=894486#c21)  Josh Stone    2013-01-23 23:59:05 UTC  ``` (In reply to [comment #19](show_bug.cgi?id=894486#c19)) > (In reply to [comment #18](show_bug.cgi?id=894486#c18)) > > At least with dnsmasq-2.65-1.fc18, if you don't specify the exception, it > > will still bind to 127.0.0.1 and [::1], which it shouldn't per [bug #886663](show_bug.cgi?id=886663 "CLOSED CURRENTRELEASE - libvirt-launched dnsmasq listens on localhost when it shouldn't"). >  > The combination of options used when running dnsmasq is controlled by > libvirt.  Right, but I was trying to find what manual dnsmasq options would fully do the right thing, as a prerequisite before I can ask libvirt to make changes.   ```  [Comment 22](show_bug.cgi?id=894486#c22)  Laine Stump    2013-01-24 18:09:10 UTC  ``` (In reply to [comment #21](show_bug.cgi?id=894486#c21))  > Right, but I was trying to find what manual dnsmasq options would fully do > the right thing, as a prerequisite before I can ask libvirt to make changes.  All libvirt dnsmasq instances would need to remove "--except-interface lo" from their options. However, once this is done, it is no longer to start up any dnsmasq instance that has "--bind-interfaces" without *that* dnsmasq also having --except-interface lo; in particular, you won't be able to start a dnsmasq that is listening for queries on 127.0.0.1/lo.  Note that it *is* possible for another dnsmasq with "--bind-dynamic --listen-address 127.0.0.1" to be started, but that's not what's being done. Again, you can get details on that from [Bug 886663](show_bug.cgi?id=886663 "CLOSED CURRENTRELEASE - libvirt-launched dnsmasq listens on localhost when it shouldn't").   ```  [Comment 23](show_bug.cgi?id=894486#c23)  Josh Stone    2013-01-24 18:31:15 UTC  ``` (In reply to [comment #22](show_bug.cgi?id=894486#c22)) > (In reply to [comment #21](show_bug.cgi?id=894486#c21)) >  > > Right, but I was trying to find what manual dnsmasq options would fully do > > the right thing, as a prerequisite before I can ask libvirt to make changes. >  > All libvirt dnsmasq instances would need to remove "--except-interface lo" > from their options. However, once this is done, it is no longer to start up > any dnsmasq instance that has "--bind-interfaces" without *that* dnsmasq > also having --except-interface lo; in particular, you won't be able to start > a dnsmasq that is listening for queries on 127.0.0.1/lo. >  > Note that it *is* possible for another dnsmasq with "--bind-dynamic > --listen-address 127.0.0.1" to be started, but that's not what's being done. > Again, you can get details on that from [Bug 886663](show_bug.cgi?id=886663 "CLOSED CURRENTRELEASE - libvirt-launched dnsmasq listens on localhost when it shouldn't").  I would like NM's dnsmasq to answer 127.0.0.1 (by nature lo), and libvirt's to answer 192.168.122.1 on virbr0 or lo.  The fact that NM's can still start by using --bind-dynamic doesn't mean it will be the one responding, as your [bug 886663 comment 6](show_bug.cgi?id=886663#c6 "CLOSED CURRENTRELEASE - libvirt-launched dnsmasq listens on localhost when it shouldn't") indicates.  It seems you'd have a startup race for whoever really grabbed 127.0.0.1 first, and that's not ok.  I'll file a separate bug later today to stop polluting this CVE, and from there hopefully it can be hashed out who among dnsmasq, libvirt, and/or NetworkManager can change their options to make this work, if it is possible at all.   ```  [Comment 24](show_bug.cgi?id=894486#c24)  Tomáš Hozza    2013-01-25 07:47:44 UTC  ``` (In reply to [comment #23](show_bug.cgi?id=894486#c23)) > I would like NM's dnsmasq to answer 127.0.0.1 (by nature lo), and libvirt's > to answer 192.168.122.1 on virbr0 or lo.  The fact that NM's can still start > by using --bind-dynamic doesn't mean it will be the one responding, as your > [bug 886663 comment 6](show_bug.cgi?id=886663#c6 "CLOSED CURRENTRELEASE - libvirt-launched dnsmasq listens on localhost when it shouldn't") indicates.  It seems you'd have a startup race for > whoever really grabbed 127.0.0.1 first, and that's not ok.  dnsmasq with --except-interface lo will *NOT* bind to the loopback interface this means the 127.0.0.1 will be available. Since [CVE-2012-3411](https://access.redhat.com/security/cve/CVE-2012-3411) and [CVE-2013-0198](https://access.redhat.com/security/cve/CVE-2013-0198) were fixed, libvirt's dnsmasq will *NOT* answer any DNS Queries coming on another interface that virbrX.  Answering DNS Queries coming through lo with --except-interface lo used was an error.  > I'll file a separate bug later today to stop polluting this CVE, and from > there hopefully it can be hashed out who among dnsmasq, libvirt, and/or > NetworkManager can change their options to make this work, if it is possible > at all.  This could be resolved by implementing new option for dnsmasq, to enable local DNS Queries (without binding to lo). It would need to be used by libvirt. Please create the new Bug for dnsmasq.  As a workaround you could use --bind-interfaces instead of --bind-dynamic for libvirt's dnsmasq instances, but *BE AWARE* that:  1. Using this you will be vulnerable to [CVE-2012-3411](https://access.redhat.com/security/cve/CVE-2012-3411) and CVE-2013-0198! 2. If libvrt's dnsmasq binds to a *PUBLIC IP* then *DON'T DO THIS*! 3. USE THIS WORKAROUND ON YOUR OWN RISK, YOU HAVE BEEN ADVISED!   ```  [Comment 25](show_bug.cgi?id=894486#c25)  Tomáš Hozza    2013-01-28 08:44:33 UTC  ``` Josh, I created [Bug #904940](show_bug.cgi?id=904940 "CLOSED ERRATA - RFE: libvirt's dnsmasq instances should answer LOCAL DNS Queries") to track the original issue.   ```  [Comment 26](show_bug.cgi?id=894486#c26)  Fedora Update System    2013-02-12 04:58:28 UTC  ``` dnsmasq-2.65-4.fc18 has been pushed to the Fedora 18 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 27](show_bug.cgi?id=894486#c27)  Fedora Update System    2013-02-18 07:05:16 UTC  ``` dnsmasq-2.65-4.fc17 has been pushed to the Fedora 17 stable repository.  If problems still persist, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=894486&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.openwall.com_9a5e1f47_20250125_103317.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[thread-next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <628080642.11882035.1358515894069.JavaMail.root@redhat.com>
Date: Fri, 18 Jan 2013 08:31:34 -0500 (EST)
From: Jan Lieskovsky <jlieskov@...hat.com>
To: oss-security@...ts.openwall.com
Cc: "Steven M. Christey" <coley@...us.mitre.org>,
        Tomas Hozza <thozza@...hat.com>, Josh Stone <jistone@...hat.com>
Subject: CVE Request -- dnsmasq: Incomplete fix for the CVE-2012-3411 issue

Hello Kurt, Steve, vendors,

  the CVE-2012-3411 identifier has been originally assigned to the
following issue:

When dnsmasq is used in conjunctions with certain configurations of libvirtd, network packets from prohibited networks (e.g. packets that should not be passed in) may be sent to the dnsmasq application and processed. This can result in DNS amplification attacks for example.
[1] <http://www.openwall.com/lists/oss-security/2012/07/12/5>

Later it was found:
[2] <https://bugzilla.redhat.com/show_bug.cgi?id=894486>
[3] <https://bugzilla.redhat.com/show_bug.cgi?id=894486#c3>

the upstream patch for CVE-2012-3411 it not to be working properly,
as it still allowed (from [3]):

* replies to remote TCP-protocol based DNS queries
(UDP protocol ones were corrected, but TCP ones not)
from prohibited networks, when the --bind-dynamic option was used,

* when --except-interface lo option was used dnsmasq didn't
answer local or remote UDP DNS queries, but still allowed
TCP protocol based DNS queries,

* when --except-interface lo option was not used local / remote
TCP DNS queries were also still answered by dnsmasq.

Could you allocate a new CVE identifier for this? (as an
incomplete fix for CVE-2012-3411 issue)

Thank you && Regards, Jan.
--
Jan iankko Lieskovsky / Red Hat Security Response Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


