=== Content from nmap.org_9ba698e9_20250126_040317.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[Download](/download.html)
[Reference Guide](/book/man.html)
[Book](/book/)
[Docs](/docs.html)
[Zenmap GUI](/zenmap/)
[In the Movies](/movies/)

[Get Nmap 7.95 here](/download)
## News

* Nmap.org has been redesigned! Our new mobile-friendly layout is also on [Npcap.com](https://npcap.com),
  [Seclists.org](https://seclists.org),
  [Insecure.org](https://insecure.org), and
  [Sectools.org](https://sectools.org).* Nmap 7.90 has been released with Npcap 1.00 along with dozens of other performance improvements, bug fixes, and feature enhancements! [[Release Announcement](https://seclists.org/nmap-announce/2020/1) | [Download page](https://nmap.org/download.html)]* After more than 7 years of development and 170 public pre-releases, we're delighted to announce Npcap version 1.00! [[Release Announcement](https://seclists.org/nmap-announce/2020/0) | [Download page](https://nmap.org/npcap/)]* Nmap 7.80 was released for DEFCON 27! [[release notes](https://seclists.org/nmap-announce/2019/0) | [download](https://nmap.org/download.html)]* Nmap turned 20 years old on September 1, 2017! Celebrate by reading [the original Phrack #51 article](/p51-11.html). [#Nmap20](https://twitter.com/hashtag/Nmap20)!* Nmap 7.50 is now available! [[release notes](https://seclists.org/nmap-announce/2017/3) | [download](https://nmap.org/download.html)]* Nmap 7 is now available! [[release notes](/7/) | [download](https://nmap.org/download.html)]* We're pleased to release our new and Improved [Icons of the Web](/favicon/) project—a 5-gigapixel interactive collage of the top million sites on the Internet!* Nmap has been discovered in two new movies! It's used to [hack Matt Damon's brain in Elysium](movies/#elysium) and also to [launch nuclear missiles in G.I. Joe: Retaliation](movies/#gijoe)!* We're delighted to announce Nmap 6.40 with 14 new [NSE scripts](/book/nse.html), hundreds of new [OS](/book/osdetect.html) and [version detection](/book/vscan.html) signatures, and many great new features! [[Announcement/Details](https://seclists.org/nmap-announce/2013/1)], [[Download Site](https://nmap.org/download.html)]* We just released Nmap 6.25 with 85 new NSE scripts, performance improvements, better OS/version detection, and more! [[Announcement/Details](https://seclists.org/nmap-hackers/2012/4)], [[Download Site](https://nmap.org/download.html)]* Any release as big as Nmap 6 is bound to uncover a few bugs. We've now fixed them with [Nmap 6.01](https://seclists.org/nmap-hackers/2012/3)!* Nmap 6 is now available! [[release notes](/6/) | [download](https://nmap.org/download.html)]* The security community has spoken! 3,000 of you shared favorite security tools for our relaunched [SecTools.Org](https://sectools.org). It is sort of like Yelp for security tools. Are you familiar with all of the [49 new tools](https://sectools.org/tag/new/) in this edition?* [Nmap 5.50 Released](https://seclists.org/nmap-hackers/2011/0): Now with Gopher protocol support! Our first stable release in a year includes 177 NSE scripts, 2,982 OS fingerprints, and 7,319 version detection signatures. Release focuses were the Nmap Scripting Engine, performance, Zenmap GUI, and the Nping packet analysis tool. [[Download page](https://nmap.org/download) | [Release notes](https://seclists.org/nmap-hackers/2011/0)]* Those who missed Defcon can now watch Fyodor and David Fifield demonstrate the power of the Nmap Scripting Engine. They give an overview of NSE, use it to explore Microsoft's global network, write an NSE script from scratch, and hack a webcam--all in 38 minutes! ([Presentation video](/presentations/BHDC10/))* *Icons of the Web*: explore favicons for the top million web sites with our [new poster and online viewer](/favicon).* We're delighted to announce the immediate, free availability of the [Nmap Security Scanner version 5.00](/5/). Don't miss the [top 5 improvements in Nmap 5](/5/#5changes).* After years of effort, we are delighted to release [Nmap Network Scanning: The Official Nmap Project Guide to Network Discovery and Security Scanning](/book/)!* We now have an active Nmap [Facebook page](http://facebook.com/nmap) and [Twitter feed](http://twitter.com/nmap/) to augment the [mailing lists](#lists). All of these options offer RSS feeds as well.

# Nmap: Discover your network

Nmap ("Network Mapper") is a
[free and open source](/npsl/) utility for
network discovery and security auditing. Many systems and network
administrators also find it useful for tasks such as network
inventory, managing service upgrade schedules, and monitoring host or
service uptime. Nmap uses raw IP packets in novel ways to determine
what hosts are available on the network, what services (application
name and version) those hosts are offering, what operating systems
(and OS versions) they are running, what type of packet
filters/firewalls are in use, and dozens of other characteristics. It
was designed to rapidly scan large networks, but works fine against
single hosts. Nmap runs on all major computer operating systems, and
official binary packages are available for Linux, Windows, and Mac OS
X. In addition to the classic command-line Nmap executable, the Nmap
suite includes an advanced GUI and results viewer
([Zenmap](/zenmap/)), a flexible data
transfer, redirection, and debugging tool
([Ncat](/ncat/)), a utility for
comparing scan results ([Ndiff](/ndiff/)), and a packet generation and response analysis tool ([Nping](/nping/)).

Nmap was named “Security Product of the Year” by Linux
Journal, Info World, LinuxQuestions.Org, and Codetalker Digest. It
was even featured in [twelve
movies](/movies/), including
[The Matrix Reloaded](/movies/#matrix),
[Die Hard 4](/movies/#diehard4),
[Girl With the Dragon Tattoo](/movies/#gwtdt),
and
[The Bourne Ultimatum](/movies/#bourne).

Nmap is ...

* Nmap
  Security
  Port Scanner
* **Flexible**: Supports dozens of advanced techniques for
  mapping out networks filled with IP filters, firewalls, routers, and
  other obstacles. This includes many [port scanning](/book/man-port-scanning-techniques.html) mechanisms (both TCP &
  UDP), [OS
  detection](/book/osdetect.html), [version detection](/book/vscan.html), ping sweeps, and more. See the [documentation page](/docs.html).* **Powerful**: Nmap has been used to scan huge networks of
    literally hundreds of thousands of machines.* **Portable**: Most operating systems are supported, including
      Linux,
      Microsoft Windows,
      FreeBSD,
      OpenBSD,
      Solaris,
      IRIX,
      Mac OS X,
      HP-UX,
      NetBSD,
      Sun OS,
      Amiga,
      and more.* **Easy**: While Nmap offers a rich set of advanced features for
        power users, you can start out as simply as "nmap -v -A *targethost*". Both traditional command line and graphical (GUI)
        versions are available to suit your preference. Binaries are
        available for those who do not wish to compile Nmap from source.* **Free**: The primary goals of the Nmap Project is to help make
          the Internet a little more secure and to provide
          administrators/auditors/hackers with an advanced tool for exploring
          their networks. Nmap is available for [free download](https://nmap.org/download.html), and also comes with full
          source code that you may modify and redistribute under the terms of
          the [license](data/COPYING).* **Well Documented**: Significant effort has been put into
            comprehensive and up-to-date man pages, whitepapers, tutorials, and
            even a whole book! Find them in multiple
            languages [here](/docs.html).* **Supported**: While Nmap comes with no warranty, it is well supported by a vibrant community of developers and users. Most of this interaction occurs on the [Nmap mailing lists](#lists). Most bug reports and questions should be sent to the [nmap-dev list](https://seclists.org/nmap-dev), but only after you read the [guidelines](/book/man-bugs.html). We recommend that all users subscribe to the low-traffic [nmap-hackers](https://seclists.org/nmap-hackers) announcement list. You can also find Nmap on [Facebook](http://facebook.com/nmap) and [Twitter](http://twitter.com/nmap). For real-time chat, join the #nmap channel on [Freenode](http://freenode.net/) or [EFNet](http://www.efnet.org/).* **Acclaimed**: Nmap has won numerous awards, including
                "Information Security Product of the Year" by Linux Journal, Info
                World and Codetalker Digest. It has been featured in hundreds of
                magazine articles, several movies, dozens of books, and one comic book
                series. Visit the [press page](nmap_inthenews.html)
                for further details.* **Popular**: Thousands of people download Nmap every day, and
                  it is included with many operating systems (Redhat Linux, Debian
                  Linux, Gentoo, FreeBSD, OpenBSD, etc). It is among the top ten (out of
                  30,000) programs at the Freshmeat.Net repository. This is important
                  because it lends Nmap its vibrant development and user support
                  communities.

## Communication

Nmap users are encouraged to subscribe to the *Nmap-hackers*
mailing list. It is a low volume (6 posts in 2017), moderated list
for the most important announcements about Nmap, Insecure.org, and
related projects. You can join more than 128,000 current subscribers
by submitting your email address here:

(or subscribe with custom options from the [Nmap-hackers list info page](https://nmap.org/mailman/listinfo/announce))

We also have a development list for more hardcore members
(especially programmers) who are interested in helping the project by
helping with coding, testing, feature ideas, etc. New (test/beta)
versions of Nmap are sometimes released here prior to general
availability for QA purposes. You can subscribe at the [Nmap-dev list
info page](https://nmap.org/mailman/listinfo/dev).

Both lists are archived (along with many other security lists) at [Seclists.org](https://seclists.org).

Though it isn't nearly as active as the mailing lists, the official IRC channel is #nmap on [Freenode](http://freenode.net/) (irc.freenode.net).

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_4d7863cd_20250124_222122.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](416)
[By Date](date.html#417)
[![Next](/images/right-icon-16x16.png)](418)

[![Previous](/images/left-icon-16x16.png)](416)
[By Thread](index.html#417)
[![Next](/images/right-icon-16x16.png)](418)

![](/shared/images/nst-icons.svg#search)

# CVE-2013-0350 for pktstat: writes content from TCP streams to public readable file /tmp/smtp.log

---

*From*: Kurt Seifried <kseifried () redhat com>

*Date*: Fri, 22 Feb 2013 23:14:41 -0700

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Please use CVE-2013-0350 for this issue:

<http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=701211>

pktstat: writes content from TCP streams to public readable file
/tmp/smtp.log

Sven Hartge <sven () svenhartge de> reports:

Package: pktstat
Version: 1.8.5-2
Severity: normal
Tags: security

Hi!

I noticed pktstat creates a file with a fixed name in /tmp and writes
debugging
info gathered from the sniffed TCP streams into it:

redacted:/tmp# ls -al smtp.log
- -rw-r--r-- 1 root root 236726 Feb 22 21:30 smtp.log

Content is something like this:

- -----------8<---------------------
smpt_line [EHLO mail.example.com]
normalized to [EHLO mail.example.com]
set desc to: [EHLO mail.example.com]
smpt_line [STARTTLS]
normalized to [STARTTLS]
set desc to: [STARTTLS]
smpt_line [EHLO mail.example.com]
normalized to [EHLO mail.example.com]
set desc to: [EHLO mail.example.com]
smpt_line [STARTTLS]
normalized to [STARTTLS]
set desc to: [STARTTLS]
smpt_line [EHLO mail.example.com]
normalized to [EHLO mail.example.com]
set desc to: [EHLO mail.example.com]
- -----------8<---------------------

This is troublesome on several levels in my opinion:

a) the filename is always the same. Since pktstat is normally run as
root, this
   can be used for a symlink attack, at least to overwrite important
files with
   garbage

b) the file is normally world readable, depending on root's umask and
may contain
   sensitive information.

c) if pktstat is left running for some time on a busier network
interface, this
   logfile can get quite big and possibly fill /tmp or /.

The code responsible is in tmp_smtp.c:

oweh@hostname:~/apt/pktstat-1.8.5$ grep log *
tcp_smtp.c:FILE*log;
tcp_smtp.c:if ((log = fopen("/tmp/smtp.log", "a")))
tcp_smtp.c:   fprintf(log, "smpt_line [%s]\n", line);
tcp_smtp.c:if (log)fprintf(log, "normalized to [%s]\n", line);
tcp_smtp.c:if (log)fprintf(log, "from_addr = [%s]\n", state->from_addr);
tcp_smtp.c:if (log)fprintf(log, "to_addr = [%s]\n", state->to_addr);
tcp_smtp.c:if (log)fprintf(log, "set desc to: [%s]\n", f->desc);
tcp_smtp.c:if (log)fclose(log);

```
> ```
> From the indention and formatting of said code I gather it is
>
> ```

```
leftover debug
code, never intended to be released.

Just removing all of the above lines is sufficient to close this bug.

Gr￼￟e,
Sven.

- -- System Information:
Debian Release: 7.0
  APT prefers unstable
  APT policy: (600, 'unstable'), (500, 'experimental'), (400, 'testing')
Architecture: i386 (x86_64)
Foreign Architectures: amd64

Kernel: Linux 3.7-trunk-amd64 (SMP w/12 CPU cores)
Locale: LANG=de_DE.utf8, LC_CTYPE=de_DE.utf8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash

Versions of packages pktstat depends on:
ii  libc6        2.13-38
ii  libncurses5  5.9-10
ii  libpcap0.8   1.3.0-1
ii  libtinfo5    5.9-10

pktstat recommends no packages.

pktstat suggests no packages.

- -- no debconf information

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)

iQIcBAEBAgAGBQJRKF5RAAoJEBYNRVNeJnmTpNUQAKtUGX1w05EW68y7njFx4HH/
jco1g4gSRvUD0SZmG3FkElfj9O9YnIcTuzTUskQgNn23WS+aS4K9LpGPo5lPdS0q
5X5Gd+/oYtOKn0q2DqIDtTPte75xPGhGpx3miLA/MBYultEbrugKBo/UVRgoP5YI
fHvwzQFMQKM32wHepE0FRaF3iH9XwhSrqebPtj5MzxOM+ioNaoMUqe3nM++7+ypI
fmCgqHh3ov4ZzL+ukS6cJSdNmMPgKrbnJ6d6DjfwU0peHQd2iHqcMDaha1ycc+Gx
KcuL5+JFvMo8b1ut/SVR8nsTl9jucXyL/y5O/wttzP0pfEznWC7RaV9SUZ15Gh+x
I65gkzCOeaCUdr7SxQjp9i1ntbWT0xv68LOWeqsCUm7Vup4lkcTHKpkf70E0pJx1
g+IEyjqYjTBecQoYtNKx6hvg7Gm41ROJJumX/8a7t2XTziPC8NNpUTFnJqQWf/iT
ZPqdJjW07oBsiSUcTcNksH8163cAfZQcSWwR5jCEW0NwAyLOW5JQEsI9BWYzKeW+
GdljKOA4971BYjrXSlepkWj7FY+PqWr2lgG5ymNHAYkVY4nNknIvqLahknilDDB6
yamM2yHhWcqSpX6aLzAjS57g8qqVD55EERQBy6E+oNNVyr6Co/OxVNSt0qZh1yv8
iN+YJAvs4L5pN8s6OahR
=5Z7R
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](416)
[By Date](date.html#417)
[![Next](/images/right-icon-16x16.png)](418)

[![Previous](/images/left-icon-16x16.png)](416)
[By Thread](index.html#417)
[![Next](/images/right-icon-16x16.png)](418)

### Current thread:

* **CVE-2013-0350 for pktstat: writes content from TCP streams to public readable file /tmp/smtp.log** *Kurt Seifried (Feb 22)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from bugs.debian.org_8a5c5967_20250124_222124.html ===

# Debian Bug report logs - #701211 pktstat: CVE-2013-0350: writes content from TCP streams to public readable file /tmp/smtp.log

[![version graph](version.cgi?fixed=pktstat%2F1.8.5-3;absolute=0;collapse=1;found=pktstat%2F1.8.5-2;height=2;package=pktstat;width=2)](version.cgi?collapse=1;found=pktstat%2F1.8.5-2;fixed=pktstat%2F1.8.5-3;absolute=0;package=pktstat;info=1)

Package:
[pktstat](pkgreport.cgi?package=pktstat);
Maintainer for [pktstat](pkgreport.cgi?package=pktstat) is [Debian QA Group <packages@qa.debian.org>](pkgreport.cgi?maint=packages%40qa.debian.org); Source for [pktstat](pkgreport.cgi?package=pktstat) is [src:pktstat](pkgreport.cgi?src=pktstat) ([PTS](https://tracker.debian.org/pkg/pktstat), [buildd](https://buildd.debian.org/pktstat), [popcon](https://qa.debian.org/popcon.php?package=pktstat)).

Reported by: [Sven Hartge <sven@svenhartge.de>](pkgreport.cgi?submitter=sven%40svenhartge.de)

Date: Fri, 22 Feb 2013 21:09:01 UTC

Severity: *grave*

Tags: security

Found in version pktstat/1.8.5-2

Fixed in version pktstat/1.8.5-3

**Done:** Jari Aalto <jari.aalto@cante.net>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=701211;mbox=yes), [status mbox](bugreport.cgi?bug=701211;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=701211;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Jari Aalto <jari.aalto@cante.net>`:

`Bug#701211`; Package `pktstat`.
(Fri, 22 Feb 2013 21:09:04 GMT) ([full text](bugreport.cgi?bug=701211;msg=2), [mbox](bugreport.cgi?bug=701211;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Sven Hartge <sven@svenhartge.de>`:

New Bug report received and forwarded. Copy sent to `team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Jari Aalto <jari.aalto@cante.net>`.
(Fri, 22 Feb 2013 21:09:04 GMT) ([full text](bugreport.cgi?bug=701211;msg=4), [mbox](bugreport.cgi?bug=701211;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=701211;msg=5), [mbox](bugreport.cgi?bug=701211;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=sven%40svenhartge.de)
From: Sven Hartge <sven@svenhartge.de>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: pktstat: writes content from TCP streams to public readable file
/tmp/smtp.log
Date: Fri, 22 Feb 2013 21:47:45 +0100
```
Package: pktstat
Version: 1.8.5-2
Severity: normal
Tags: security

Hi!

I noticed pktstat creates a file with a fixed name in /tmp and writes debugging
info gathered from the sniffed TCP streams into it:

redacted:/tmp# ls -al smtp.log
-rw-r--r-- 1 root root 236726 Feb 22 21:30 smtp.log

Content is something like this:

-----------8<---------------------
smpt_line [EHLO mail.example.com]
normalized to [EHLO mail.example.com]
set desc to: [EHLO mail.example.com]
smpt_line [STARTTLS]
normalized to [STARTTLS]
set desc to: [STARTTLS]
smpt_line [EHLO mail.example.com]
normalized to [EHLO mail.example.com]
set desc to: [EHLO mail.example.com]
smpt_line [STARTTLS]
normalized to [STARTTLS]
set desc to: [STARTTLS]
smpt_line [EHLO mail.example.com]
normalized to [EHLO mail.example.com]
set desc to: [EHLO mail.example.com]
-----------8<---------------------

This is troublesome on several levels in my opinion:

a) the filename is always the same. Since pktstat is normally run as root, this
   can be used for a symlink attack, at least to overwrite important files with
   garbage

b) the file is normally world readable, depending on root's umask and may contain
   sensitive information.

c) if pktstat is left running for some time on a busier network interface, this
   logfile can get quite big and possibly fill /tmp or /.

The code responsible is in tmp_smtp.c:

oweh@hostname:~/apt/pktstat-1.8.5$ grep log *
tcp_smtp.c:FILE*log;
tcp_smtp.c:if ((log = fopen("/tmp/smtp.log", "a")))
tcp_smtp.c:   fprintf(log, "smpt_line [%s]\n", line);
tcp_smtp.c:if (log)fprintf(log, "normalized to [%s]\n", line);
tcp_smtp.c:if (log)fprintf(log, "from_addr = [%s]\n", state->from_addr);
tcp_smtp.c:if (log)fprintf(log, "to_addr = [%s]\n", state->to_addr);
tcp_smtp.c:if (log)fprintf(log, "set desc to: [%s]\n", f->desc);
tcp_smtp.c:if (log)fclose(log);

>From the indention and formatting of said code I gather it is leftover debug
code, never intended to be released.

Just removing all of the above lines is sufficient to close this bug.

Grüße,
Sven.

-- System Information:
Debian Release: 7.0
  APT prefers unstable
  APT policy: (600, 'unstable'), (500, 'experimental'), (400, 'testing')
Architecture: i386 (x86_64)
Foreign Architectures: amd64

Kernel: Linux 3.7-trunk-amd64 (SMP w/12 CPU cores)
Locale: LANG=de_DE.utf8, LC_CTYPE=de_DE.utf8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash

Versions of packages pktstat depends on:
ii  libc6        2.13-38
ii  libncurses5  5.9-10
ii  libpcap0.8   1.3.0-1
ii  libtinfo5    5.9-10

pktstat recommends no packages.

pktstat suggests no packages.

-- no debconf information

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Jari Aalto <jari.aalto@cante.net>`:

`Bug#701211`; Package `pktstat`.
(Sat, 23 Feb 2013 07:03:03 GMT) ([full text](bugreport.cgi?bug=701211;msg=7), [mbox](bugreport.cgi?bug=701211;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Jari Aalto <jari.aalto@cante.net>`.
(Sat, 23 Feb 2013 07:03:03 GMT) ([full text](bugreport.cgi?bug=701211;msg=9), [mbox](bugreport.cgi?bug=701211;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 701211@bugs.debian.org ([full text](bugreport.cgi?bug=701211;msg=10), [mbox](bugreport.cgi?bug=701211;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Sven Hartge <sven@svenhartge.de>, 701211@bugs.debian.org
Subject: Re: Bug#701211: pktstat: writes content from TCP streams to public
readable file /tmp/smtp.log
Date: Sat, 23 Feb 2013 07:59:12 +0100
```
Control: retitle -1 pktstat: [CVE-2013-0350](https://security-tracker.debian.org/tracker/CVE-2013-0350): writes content from TCP streams to public readable file /tmp/smtp.log

Hi

On Fri, Feb 22, 2013 at 09:47:45PM +0100, Sven Hartge wrote:
> Package: pktstat
> Version: 1.8.5-2
> Severity: normal
> Tags: security
>
> Hi!
>
> I noticed pktstat creates a file with a fixed name in /tmp and writes debugging
> info gathered from the sniffed TCP streams into it:
>
> redacted:/tmp# ls -al smtp.log
> -rw-r--r-- 1 root root 236726 Feb 22 21:30 smtp.log

On oss-sec list [CVE-2013-0350](https://security-tracker.debian.org/tracker/CVE-2013-0350) was assigned to this.

Regards,
Salvatore

```

---

**Changed Bug title to 'pktstat: CVE-2013-0350: writes content from TCP streams to public readable file /tmp/smtp.log' from 'pktstat: writes content from TCP streams to public readable file /tmp/smtp.log'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `701211-submit@bugs.debian.org`.
(Sat, 23 Feb 2013 07:03:03 GMT) ([full text](bugreport.cgi?bug=701211;msg=12), [mbox](bugreport.cgi?bug=701211;mbox=yes;msg=12), [link](#11)).

---

**Added tag(s) pending.**
Request was from `Jari Aalto <jari.aalto@cante.net>`
to `control@bugs.debian.org`.
(Sat, 23 Feb 2013 07:39:03 GMT) ([full text](bugreport.cgi?bug=701211;msg=14), [mbox](bugreport.cgi?bug=701211;mbox=yes;msg=14), [link](#13)).

---

**Reply sent**
to `Jari Aalto <jari.aalto@cante.net>`:

You have taken responsibility.
(Sat, 23 Feb 2013 17:51:15 GMT) ([full text](bugreport.cgi?bug=701211;msg=16), [mbox](bugreport.cgi?bug=701211;mbox=yes;msg=16), [link](#15)).

---

**Notification sent**
to `Sven Hartge <sven@svenhartge.de>`:

Bug acknowledged by developer.
(Sat, 23 Feb 2013 17:51:15 GMT) ([full text](bugreport.cgi?bug=701211;msg=18), [mbox](bugreport.cgi?bug=701211;mbox=yes;msg=18), [link](#17)).

---

[Message #19](#19) received at 701211-close@bugs.debian.org ([full text](bugreport.cgi?bug=701211;msg=19), [mbox](bugreport.cgi?bug=701211;mbox=yes;msg=19), reply):

![](/cgi-bin/libravatar.cgi?email=jari.aalto%40cante.net)
From: Jari Aalto <jari.aalto@cante.net>
To: 701211-close@bugs.debian.org
Subject: Bug#701211: fixed in pktstat 1.8.5-3
Date: Sat, 23 Feb 2013 17:48:59 +0000
```
Source: pktstat
Source-Version: 1.8.5-3

We believe that the bug you reported is fixed in the latest version of
pktstat, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 701211@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Jari Aalto <jari.aalto@cante.net> (supplier of updated pktstat package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Sat, 23 Feb 2013 09:27:29 +0200
Source: pktstat
Binary: pktstat
Architecture: source amd64
Version: 1.8.5-3
Distribution: unstable
Urgency: low
Maintainer: Jari Aalto <jari.aalto@cante.net>
Changed-By: Jari Aalto <jari.aalto@cante.net>
Description:
 pktstat    - top-like utility for network connections usage
Closes: [701211](bugreport.cgi?bug=701211)
Changes:
 pktstat (1.8.5-3) unstable; urgency=low
 .
   * debian/control
     - (Standards-Version): Update to 3.9.4
   * debian/copyright
     - Update year.
   * debian/patches
     - (10): New. Do now write log to /tmp ([CVE-2013-0350](https://security-tracker.debian.org/tracker/CVE-2013-0350); Closes: #[701211](bugreport.cgi?bug=701211)).
Checksums-Sha1:
 ae83a225db4244419648a6e952977ecc44ee5e8d 1850 pktstat_1.8.5-3.dsc
 61d04f58c7b84a480ccdd9b19181f5edd3951b9e 3948 pktstat_1.8.5-3.debian.tar.gz
 4c881b35a1051e2be5883b51254afe9048fceb19 41158 pktstat_1.8.5-3_amd64.deb
Checksums-Sha256:
 069f135e3f71f9d1369a405edf5357f14beace8d4828c6ea6eee660026d873c7 1850 pktstat_1.8.5-3.dsc
 1fece9d52f0a55d1d48fcbbe7f28b28dbaa34a78a48a0e3a332a31b21aaeb891 3948 pktstat_1.8.5-3.debian.tar.gz
 bd3189e5f0a334a83b6fa283dff095b103a933f5d8359cd9eb8f6be5070e7a9c 41158 pktstat_1.8.5-3_amd64.deb
Files:
 f97983a87e918cb762944dc6165fe9f6 1850 net optional pktstat_1.8.5-3.dsc
 0e56c2f12c8c3e30b4277157f08ce450 3948 net optional pktstat_1.8.5-3.debian.tar.gz
 3d8e200736377156acdbb18c35785fc2 41158 net optional pktstat_1.8.5-3_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQIcBAEBAgAGBQJRKP0rAAoJECHSBYmXSz6WwgsP/0LFM42zPPwuvOSWRlSFSWgf
OagCdrlMSyObSyJ5i3NeLXC8LzRkGRIEVlrFyQEOpqUaGcKyQNwa2gu2H9L2zCQj
zJHCOVt79FDTA/CHwiKrVErhE6hTmt1uk+6cT0mTEs8ldFz/lb7jZlvTVp5UxM5y
kZlrYaXfij49kN0oslom2wUCV0coU6uS3Ur/4onFnLIGVjEJmewnGb/eIWwiVZYA
gK+PiA1Jb8qdnTF94vESJAN+rg+S9GceJuLNRPnnfw68BgB9W315hDi0jlhg0Daj
ovwnIkaKmD6g74xbU6SMZDstuaqpwh/2LmnwmIgBhsNINgCGmBCkoqRZTJ4V+8DW
xqHNivA7CEeePr5BL8eDJksaqP9uCo9eKWN+9v5IIgzkJ3splDTIslGYARhlVphk
iqonCBI8j3538pPCBURSoV1YgODGfQTFEuwviR7DQkaaRFM6QJWWXreP33BSdShQ
7NaI14JfFt/3vMTGHC9dQ+nem0o5vefh54pWzIOIcswCHE2hntPYfm6CQ43pPTYG
uUMdNCDtYymXAgmqqk8uuvMJ8x8LKV44H21J03HN7WzU6uiwEfyG4LIl8Llyf+hd
OXAojKz4DpHCNoAKVuAgzSEbP7AdcQHwTYFmXbQDvP7AGeTx7jTwRtd3g4auubeH
+LgvVELVQ6607PihN2rz
=EwLr
-----END PGP SIGNATURE-----

```

---

**Severity set to 'grave' from 'normal'**
Request was from `Thijs Kinkhorst <thijs@debian.org>`
to `control@bugs.debian.org`.
(Mon, 25 Feb 2013 08:39:09 GMT) ([full text](bugreport.cgi?bug=701211;msg=21), [mbox](bugreport.cgi?bug=701211;mbox=yes;msg=21), [link](#20)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Thu, 28 Mar 2013 07:26:08 GMT) ([full text](bugreport.cgi?bug=701211;msg=23), [mbox](bugreport.cgi?bug=701211;mbox=yes;msg=23), [link](#22)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=701211).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 22:21:24 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from security-tracker.debian.org_36e92ab8_20250126_040318.html ===

# CVE-2013-0350

| **Name** | CVE-2013-0350 |
| --- | --- |
| **Description** | tmp\_smtp.c in pktstat 1.8.5 allows local users to overwrite arbitrary files via a symlink attack on /tmp/smtp.log. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2013-0350) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2013-0350); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2013-0350), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2013-0350), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2013-0350), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2013-0350), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-0350), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2013-0350), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2013-0350), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2013-0350)/[CVE](https://www.suse.com/security/cve/CVE-2013-0350/), GitHub [advisories](https://github.com/advisories?query=CVE-2013-0350)/[code](https://github.com/search?type=Code&q=%22CVE-2013-0350%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2013-0350%22), [web search](https://duckduckgo.com/html?q=%22CVE-2013-0350%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [701211](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=701211) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [pktstat](/tracker/source-package/pktstat) ([PTS](https://tracker.debian.org/pkg/pktstat)) | bullseye | 1.8.5-6 | fixed |
|  | bookworm, sid, trixie | 1.8.5-8 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [pktstat](/tracker/source-package/pktstat) | source | squeeze | (not affected) |  |  |  |
| [pktstat](/tracker/source-package/pktstat) | source | (unstable) | 1.8.5-3 |  |  | [701211](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=701211) |

## Notes

```
[squeeze] - pktstat <not-affected> (Vulnerable code not present)

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)


