=== Content from www.openwall.com_b544e637_20250125_020802.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](7) [[next>]](9) [[<thread-prev]](../../../2013/02/19/1) [[thread-next>]](9) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <5125C5EE.3050000@redhat.com>
Date: Wed, 20 Feb 2013 23:59:58 -0700
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Salvatore Bonaccorso <carnil@...ian.org>
Subject: Re: CVE request: zoneminder: local file inclusion
 vulnerability

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 02/19/2013 02:47 AM, Salvatore Bonaccorso wrote:
> Hi
>
> In zoneminder forum the following announce was done already in
> 2011:
>
> <http://www.zoneminder.com/forums/viewtopic.php?f=1&t=17979>

Stupid Q, is there like an official security page? POsting stuff to a
forum is not exactly the easiest place to find things, can they setup
like zoneminder.com/security/ and at least list all the security
issues and link to them there so people don't have to dig through the
forums?

I say this because this is the first cve request I've ever seen for
zoneminder since I started assigning, and indeed, since 2008, so I'm
guessing there's a few more missing ones......

If someone wants to big through the forums to find them and post them
here that would probably be helpful (seriously, wanna pad your resume
and get a reference from me? first person to make 100 good CVE
requests wins).

> where zoneminder is prone to a local file inclusion vulnerability.
> From upstream versions prior to 1.24.4 are affected and the issue
> was fixed in 1.24.4 and 1.25.0.
>
> SVN commits fixing this issue for the 1.24.x versions are r3483
> and r3488, and patches:
>
> <http://www.zoneminder.com/downloads/lfi-patch.txt>
> <http://www.zoneminder.com/downloads/lfi-patch2.txt>
>
> I haven't found a CVE assigned to this already. In case I did not
> miss something, could you allocate a CVE for this issue?
>
> Debian Bug: <http://bugs.debian.org/700912>

Please use CVE-2013-0332 for this issue.

> Regards, Salvatore

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)

iQIcBAEBAgAGBQJRJcXuAAoJEBYNRVNeJnmTxIAP/RppcXyl48K0o/7PRBeLBc5J
ShUjF0h2tZc5RDNcjDDyeESkcHCeT9iI1IGdXe0xN4sLIGnUcwEV8TsRVHiwP0lw
FYr1hDKn/OII2bwokCcvg60HN4BOzU0ZGyL/EhBMlv+eU+HsGEtZeKUqaEWTr3FS
39zXzkfFHd0SRfqye1FSVA4magi7f4bY58gu74dhd/uchu7+Hf8+NEyRsN2Nw8aM
bSEENydNsVS4xuihsmsPr6FD+FGPSI8D+HXAHyzYkp+WS9sSx+Sv1nsDQ/T4N1Tn
DYB/U+3x8QO2naf43uKh9GEtseTWtZTfCMghm6Bjh2ocbNDKHvhzF5jGa7/I9Yie
KQGLzPxvJkN45qJ/b8Lse0jPe6aQjJfFifzYQG0tNxGFF97A9hMynTGyRIPW+nNA
Jxnc4fKwPvGbqGbixEpHAUsmnR6IBFWOBzBbv8sUgiwYAzAPzuj/+97LMjD5cchJ
a/Et6jrbn2c/4n6241YjKsOe/TY/sK/NT/HtnksqM5A0RaElnelEbkSPt/9jZi0+
ncqAJ0Ta8HbptZCcuuI/xSGIHiANucQQfIFJp+w9Gb8yXfNRIP7GOvlgvryf9ZFR
wJN/+KPklkEPO/Xdpsp6bnilVN8gVKfZnf5o6WucBQGXKsiKLpEjIdWjn//6wXrH
2b8Gicemt1WgV6/F0tKV
=axec
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.debian.org_af1d781c_20250125_020802.html ===


---

[[Date Prev](msg00049.html)][[Date Next](msg00051.html)]
[[Thread Prev](msg00049.html)][[Thread Next](msg00051.html)]
[[Date Index](maillist.html#00050)]
[[Thread Index](threads.html#00050)]

# [SECURITY] [DSA 2640-1] zoneminder security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2640-1] zoneminder security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Thu, 14 Mar 2013 19:04:52 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20130314180452.GA5273%40pisco.westfalen.local)Â [20130314180452.GA5273@pisco.westfalen.local](msg00050.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2640-1                   security@debian.org
<http://www.debian.org/security/>                      Salvatore Bonaccorso
March 14, 2013                         <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : zoneminder
Vulnerability  : several issues
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-2013-0232 CVE-2013-0332
Debian Bug     : 698910 700912

Multiple vulnerabilities were discovered in zoneminder, a Linux video
camera security and surveillance solution. The Common Vulnerabilities
and Exposures project identifies the following problems:

CVE-2013-0232

    Brendan Coles discovered that zoneminder is prone to an arbitrary
    command execution vulnerability. Remote (authenticated) attackers
    could execute arbitrary commands as the web server user.

CVE-2013-0332

    zoneminder is prone to a local file inclusion vulnerability. Remote
    attackers could examine files on the system running zoneminder.

For the stable distribution (squeeze), these problems have been fixed in
version 1.24.2-8+squeeze1.

For the testing distribution (wheezy), these problems have been fixed in
version 1.25.0-4.

For the unstable distribution (sid), these problems have been fixed in
version 1.25.0-4.

We recommend that you upgrade your zoneminder packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iEYEARECAAYFAlFCERAACgkQXm3vHE4uylqVCQCg0iXjoGGmBmhknkn2UMsTh+iF
crcAnjC/D4FwozZkfPHdilBd+wen14t9
=638X
-----END PGP SIGNATURE-----

```

---



=== Content from security-tracker.debian.org_6e32e1a1_20250126_051529.html ===

# CVE-2013-0332

| **Name** | CVE-2013-0332 |
| --- | --- |
| **Description** | Multiple directory traversal vulnerabilities in ZoneMinder 1.24.x before 1.24.4 allow remote attackers to read arbitrary files via a .. (dot dot) in the (1) view, (2) request, or (3) action parameter. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2013-0332) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2013-0332); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2013-0332), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2013-0332), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2013-0332), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2013-0332), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-0332), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2013-0332), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2013-0332), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2013-0332)/[CVE](https://www.suse.com/security/cve/CVE-2013-0332/), GitHub [advisories](https://github.com/advisories?query=CVE-2013-0332)/[code](https://github.com/search?type=Code&q=%22CVE-2013-0332%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2013-0332%22), [web search](https://duckduckgo.com/html?q=%22CVE-2013-0332%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DSA-2640-1](/tracker/DSA-2640-1) |
| **Debian Bugs** | [700912](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=700912) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [zoneminder](/tracker/source-package/zoneminder) ([PTS](https://tracker.debian.org/pkg/zoneminder)) | bullseye | 1.34.23-1 | fixed |
|  | sid, bookworm | 1.36.33+dfsg1-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [zoneminder](/tracker/source-package/zoneminder) | source | squeeze | 1.24.2-8+squeeze1 |  | [DSA-2640-1](/tracker/DSA-2640-1) |  |
| [zoneminder](/tracker/source-package/zoneminder) | source | (unstable) | 1.25.0-1 |  |  | [700912](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=700912) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from security-tracker.debian.org_e61ac027_20250126_051518.html ===

# Security Bug Tracker

The data in this tracker comes solely from the bug database maintained
by Debian's security team located in the security-tracker Git [repository](https://salsa.debian.org/security-tracker-team/security-tracker/tree/master/data). The data represented here is derived from: [DSAs](https://www.debian.org/security/#DSAS) issued by the Security Team; issues tracked in the [CVE database](https://www.cve.org/), issues tracked in the [National Vulnerability Database](https://nvd.nist.gov/) (NVD), maintained by NIST; and security issues
discovered in Debian packages as reported in the BTS.

All external data (including Debian bug reports and official Debian
security advisories) must be added to this database before it appears
here. Please help us keep this information up-to-date by [reporting](/tracker/data/report) any discrepancies or change of status that you are
aware of and/or help us improve the quality of this information by [participating](/tracker/data/report).

* [Vulnerable packages in the unstable suite](/tracker/status/release/unstable)
* [Vulnerable packages in the testing suite](/tracker/status/release/testing)
* [Vulnerable packages in the stable suite](/tracker/status/release/stable)
* [Vulnerable packages in backports for stable](/tracker/status/release/stable-backports)
* [Vulnerable packages in the oldstable suite](/tracker/status/release/oldstable)
* [Vulnerable packages in backports for oldstable](/tracker/status/release/oldstable-backports)
* [Candidates for DTSAs](/tracker/status/dtsa-candidates)
* [TODO items](/tracker/status/todo)
* [Packages that may be vulnerable but need to be checked (undetermined issues)](/tracker/status/undetermined)
* [Packages that have open unimportant issues](/tracker/status/unimportant)
* [ITPs with potential security issues](/tracker/status/itp)
* [Open vulnerabilities without filed Debian bugs](/tracker/status/unreported)
* [Packages names not found in the archive](/tracker/data/unknown-packages)
* [Tracked issues without a CVE name](/tracker/data/fake-names)
* [Package versions which might lack an epoch](/tracker/data/missing-epochs)
* [Packages which are latently vulnerable in unstable](/tracker/data/latently-vulnerable)
* [Packages with strange version numbers](/tracker/data/funny-versions)
* [Covered Debian releases and architectures](/tracker/data/releases)
* [All information in JSON format](/tracker/data/json)
Search for package or bug name:  [Reporting problems](/tracker/data/report)

(You can enter CVE names, Debian bug numbers and package
names in the search forms.)

### External interfaces

If you want to automatically open a relevant web page for
some object, use the `/tracker/redirect/object` URL. If no information is contained in this database,
the browser is automatically redirected to the corresponding external
data source.

---



=== Content from bugs.debian.org_e565ddfb_20250125_020800.html ===

# Debian Bug report logs - #700912 zoneminder: CVE-2013-0332: local file inclusion vulnerability

[![version graph](version.cgi?package=zoneminder;collapse=1;fixed=zoneminder%2F1.25.0-1;fixed=zoneminder%2F1.24.2-8%2Bsqueeze1;absolute=0;width=2;height=2;found=zoneminder%2F1.24.2-8)](version.cgi?absolute=0;found=zoneminder%2F1.24.2-8;fixed=zoneminder%2F1.25.0-1;fixed=zoneminder%2F1.24.2-8%2Bsqueeze1;info=1;collapse=1;package=zoneminder)

Package:
[zoneminder](pkgreport.cgi?package=zoneminder);
Maintainer for [zoneminder](pkgreport.cgi?package=zoneminder) is [Dmitry Smirnov <onlyjob@debian.org>](pkgreport.cgi?maint=onlyjob%40debian.org); Source for [zoneminder](pkgreport.cgi?package=zoneminder) is [src:zoneminder](pkgreport.cgi?src=zoneminder) ([PTS](https://tracker.debian.org/pkg/zoneminder), [buildd](https://buildd.debian.org/zoneminder), [popcon](https://qa.debian.org/popcon.php?package=zoneminder)).

Reported by: [Salvatore Bonaccorso <carnil@debian.org>](pkgreport.cgi?submitter=carnil%40debian.org)

Date: Tue, 19 Feb 2013 08:57:01 UTC

Severity: *grave*

Tags: patch, security

Found in version zoneminder/1.24.2-8

Fixed in versions zoneminder/1.25.0-1, zoneminder/1.24.2-8+squeeze1

**Done:** Vagrant Cascadian <vagrant@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=700912;mbox=yes), [status mbox](bugreport.cgi?bug=700912;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=700912;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, carnil@debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Peter Howard <pjh@northern-ridge.com.au>`:

`Bug#700912`; Package `zoneminder`.
(Tue, 19 Feb 2013 08:57:04 GMT) ([full text](bugreport.cgi?bug=700912;msg=2), [mbox](bugreport.cgi?bug=700912;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

New Bug report received and forwarded. Copy sent to `carnil@debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Peter Howard <pjh@northern-ridge.com.au>`.
(Tue, 19 Feb 2013 08:57:04 GMT) ([full text](bugreport.cgi?bug=700912;msg=4), [mbox](bugreport.cgi?bug=700912;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=700912;msg=5), [mbox](bugreport.cgi?bug=700912;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: zoneminder: local file inclusion vulnerability
Date: Tue, 19 Feb 2013 09:53:37 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=700912;msg=5) (text/plain, inline)]
```
```
Package: zoneminder
Version: 1.24.2-8
Severity: grave
Tags: security patch
Justification: user security hole
Control: fixed -1 1.25.0-1

Hi

In zoneminder forum there is the following security patch announce:

 <http://www.zoneminder.com/forums/viewtopic.php?f=1&t=17979>

1.24.2-8 is affected by this file inclusion vulnerability.

Attached are the patches from svn, r3483 and r3488.

Note: upstream 1.25.0 has a sligthly modified detaint function:

function detaintPath( $path )
{
    // Remove any absolute paths, or relative ones that want to go up
    $path = preg_replace( '/\.(?:\.+[\\/][\\/]*)+/', '', $path );
    $path = preg_replace( '/^[\\/]+/', '', $path );
    return( $path );
}

Regards
Salvatore

```
```
[[zoneminder_r3483.patch](bugreport.cgi?att=1;bug=700912;filename=zoneminder_r3483.patch;msg=5) (text/x-diff, attachment)]
```
```
[[zoneminder_r3488.patch](bugreport.cgi?att=2;bug=700912;filename=zoneminder_r3488.patch;msg=5) (text/x-diff, attachment)]
```

---

**Marked as fixed in versions zoneminder/1.25.0-1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `submit@bugs.debian.org`.
(Tue, 19 Feb 2013 08:57:04 GMT) ([full text](bugreport.cgi?bug=700912;msg=7), [mbox](bugreport.cgi?bug=700912;mbox=yes;msg=7), [link](#6)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Peter Howard <pjh@northern-ridge.com.au>`:

`Bug#700912`; Package `zoneminder`.
(Thu, 21 Feb 2013 08:27:03 GMT) ([full text](bugreport.cgi?bug=700912;msg=9), [mbox](bugreport.cgi?bug=700912;mbox=yes;msg=9), [link](#8)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Peter Howard <pjh@northern-ridge.com.au>`.
(Thu, 21 Feb 2013 08:27:03 GMT) ([full text](bugreport.cgi?bug=700912;msg=11), [mbox](bugreport.cgi?bug=700912;mbox=yes;msg=11), [link](#10)).

---

[Message #12](#12) received at 700912@bugs.debian.org ([full text](bugreport.cgi?bug=700912;msg=12), [mbox](bugreport.cgi?bug=700912;mbox=yes;msg=12), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: 700912@bugs.debian.org
Subject: Re: Bug#700912: zoneminder: local file inclusion vulnerability
Date: Thu, 21 Feb 2013 09:23:02 +0100
```
Control: retitle -1 zoneminder: [CVE-2013-0332](https://security-tracker.debian.org/tracker/CVE-2013-0332): local file inclusion vulnerability

Hi

A CVE was assigned now to this issue: [CVE-2013-0332](https://security-tracker.debian.org/tracker/CVE-2013-0332).

Regards,
Salvatore

```

---

**Changed Bug title to 'zoneminder: CVE-2013-0332: local file inclusion vulnerability' from 'zoneminder: local file inclusion vulnerability'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `700912-submit@bugs.debian.org`.
(Thu, 21 Feb 2013 08:27:03 GMT) ([full text](bugreport.cgi?bug=700912;msg=14), [mbox](bugreport.cgi?bug=700912;mbox=yes;msg=14), [link](#13)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Peter Howard <pjh@northern-ridge.com.au>`:

`Bug#700912`; Package `zoneminder`.
(Mon, 25 Feb 2013 11:33:04 GMT) ([full text](bugreport.cgi?bug=700912;msg=16), [mbox](bugreport.cgi?bug=700912;mbox=yes;msg=16), [link](#15)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Peter Howard <pjh@northern-ridge.com.au>`.
(Mon, 25 Feb 2013 11:33:05 GMT) ([full text](bugreport.cgi?bug=700912;msg=18), [mbox](bugreport.cgi?bug=700912;mbox=yes;msg=18), [link](#17)).

---

[Message #19](#19) received at 700912@bugs.debian.org ([full text](bugreport.cgi?bug=700912;msg=19), [mbox](bugreport.cgi?bug=700912;mbox=yes;msg=19), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Vagrant Cascadian <vagrant@debian.org>, 698910@bugs.debian.org
Cc: Moritz MÃƒÂ¼hlenhoff <jmm@inutil.org>,
team@security.debian.org, Peter Howard <pjh@northern-ridge.com.au>,
700912@bugs.debian.org
Subject: Re: Bug#698910: zoneminder: arbitrary command execution
vulnerability
Date: Mon, 25 Feb 2013 12:28:33 +0100
```
Hi Vagrant and Peter

On Thu, Feb 14, 2013 at 11:35:31AM -0800, Vagrant Cascadian wrote:
> Anything more needed for the security team? Which queue should it be
> uploaded to?

Apologies for the delay. Could you also adress #700912 ([CVE-2013-0332](https://security-tracker.debian.org/tracker/CVE-2013-0332))
for the stable-security update.

I think we can proceed afterwards.

Thank you for preparing updated packages!

Regards,
Salvatore

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Peter Howard <pjh@northern-ridge.com.au>`:

`Bug#700912`; Package `zoneminder`.
(Wed, 27 Feb 2013 01:45:05 GMT) ([full text](bugreport.cgi?bug=700912;msg=21), [mbox](bugreport.cgi?bug=700912;mbox=yes;msg=21), [link](#20)).

---

**Acknowledgement sent**
to `Vagrant Cascadian <vagrant@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Peter Howard <pjh@northern-ridge.com.au>`.
(Wed, 27 Feb 2013 01:45:05 GMT) ([full text](bugreport.cgi?bug=700912;msg=23), [mbox](bugreport.cgi?bug=700912;mbox=yes;msg=23), [link](#22)).

---

[Message #24](#24) received at 700912@bugs.debian.org ([full text](bugreport.cgi?bug=700912;msg=24), [mbox](bugreport.cgi?bug=700912;mbox=yes;msg=24), reply):

![](/cgi-bin/libravatar.cgi?email=vagrant%40debian.org)
From: Vagrant Cascadian <vagrant@debian.org>
To: Salvatore Bonaccorso <carnil@debian.org>
Cc: 698910@bugs.debian.org,
Moritz MÃƒÂ¼hlenhoff <jmm@inutil.org>,
team@security.debian.org, Peter Howard <pjh@northern-ridge.com.au>,
700912@bugs.debian.org
Subject: Re: Bug#698910: zoneminder: arbitrary command execution
vulnerability
Date: Tue, 26 Feb 2013 17:41:52 -0800
```
On Mon, Feb 25, 2013 at 12:28:33PM +0100, Salvatore Bonaccorso wrote:
> On Thu, Feb 14, 2013 at 11:35:31AM -0800, Vagrant Cascadian wrote:
> > Anything more needed for the security team? Which queue should it be
> > uploaded to?
>
> Apologies for the delay. Could you also adress #700912 ([CVE-2013-0332](https://security-tracker.debian.org/tracker/CVE-2013-0332))
> for the stable-security update.
>
> I think we can proceed afterwards.

I've prepared an upload in the "squeeze" branch of the hg repository, which
required a little backporting of the patches, but haven't yet tested it... hope
to test tomorrow, or I may not get to it till the following week...

  <http://anonscm.debian.org/hg/collab-maint/zoneminder/>

or a debdiff:

diff -Nru zoneminder-1.24.2/debian/changelog zoneminder-1.24.2/debian/changelog
--- zoneminder-1.24.2/debian/changelog  2011-01-15 19:40:08.000000000 -0800
+++ zoneminder-1.24.2/debian/changelog  2013-02-26 17:20:05.000000000 -0800
@@ -1,3 +1,15 @@
+zoneminder (1.24.2-8+squeeze1) UNRELEASED; urgency=high
+
+  * Add [CVE-2013-0232](https://security-tracker.debian.org/tracker/CVE-2013-0232) patch
+    [SECURITY] [CVE-2013-0232](https://security-tracker.debian.org/tracker/CVE-2013-0232): Shell escape commands with untrusted content.
+    Thanks to James McCoy <jamessan@debian.org> (Closes: #[698910](bugreport.cgi?bug=698910))
+    Thanks also to Salvatore Bonaccorso <carnil@debian.org>
+  * Add [CVE-2013-0332](https://security-tracker.debian.org/tracker/CVE-2013-0332) patch
+    [SECURITY] [CVE-2013-0332](https://security-tracker.debian.org/tracker/CVE-2013-0332): local file inclusion (Closes: #[700912](bugreport.cgi?bug=700912)).
+    Thanks to Salvatore Bonaccorso <carnil@debian.org> for the patch.
+
+ -- Vagrant Cascadian <vagrant@debian.org>  Tue, 26 Feb 2013 17:20:02 -0800
+
 zoneminder (1.24.2-8) unstable; urgency=medium

   [ Vagrant Cascadian ]
diff -Nru zoneminder-1.24.2/debian/patches/cve-2013-0232 zoneminder-1.24.2/debian/patches/cve-2013-0232
--- zoneminder-1.24.2/debian/patches/cve-2013-0232      1969-12-31 16:00:00.000000000 -0800
+++ zoneminder-1.24.2/debian/patches/cve-2013-0232      2013-02-26 16:55:03.000000000 -0800
@@ -0,0 +1,24 @@
+From: James McCoy <jamessan@debian.org>
+Bug-Debian: <http://bugs.debian.org/698910>
+Subject: shell escape commands with untrusted content
+--- a/web/includes/functions.php
++++ b/web/includes/functions.php
+@@ -905,7 +905,7 @@
+
+ function packageControl( $command )
+ {
+-    $string = ZM_PATH_BIN."/zmpkg.pl $command";
++    $string = ZM_PATH_BIN."/zmpkg.pl ".escapeshellarg( $command );
+     $string .= " 2>/dev/null >&- <&- >/dev/null";
+     exec( $string );
+ }
+@@ -2145,7 +2145,8 @@
+     else
+     {
+         // Can't connect so use script
+-        $command = ZM_PATH_BIN."/zmx10.pl --command $status --unit-code $key";
++        $command = ZM_PATH_BIN.'/zmx10.pl --command '.escapeshellarg( $status );
++        $command .= ' --unit-code '.escapeshellarg( $key );
+         //$command .= " 2>/dev/null >&- <&- >/dev/null";
+         $x10Response = exec( $command );
+     }
diff -Nru zoneminder-1.24.2/debian/patches/cve-2013-0332 zoneminder-1.24.2/debian/patches/cve-2013-0332
--- zoneminder-1.24.2/debian/patches/cve-2013-0332      1969-12-31 16:00:00.000000000 -0800
+++ zoneminder-1.24.2/debian/patches/cve-2013-0332      2013-02-26 17:18:18.000000000 -0800
@@ -0,0 +1,71 @@
+From: Salvatore Bonaccorso <carnil@debian.org>
+Bug-Debian: <http://bugs.debian.org/700912>
+Subject: [CVE-2013-0332](https://security-tracker.debian.org/tracker/CVE-2013-0332): local file inclusion vulnerability
+Bug-Upstream: <http://www.zoneminder.com/forums/viewtopic.php?f=1&t=17979>
+
+Backported r3483 and r3488 from upstream svn to fix [CVE-2013-0332](https://security-tracker.debian.org/tracker/CVE-2013-0332).
+
+Index: zoneminder/web/includes/functions.php
+===================================================================
+--- zoneminder.orig/web/includes/functions.php 2013-02-26 17:07:02.000000000 -0800
++++ zoneminder/web/includes/functions.php      2013-02-26 17:08:10.806977380 -0800
+@@ -2231,13 +2231,21 @@
+     return( rand( 1, 999999 ) );
+ }
+
++function detaintPath( $path )
++{
++    // Remove any absolute paths, or relative ones that want to go up
++    $path = preg_replace( '/\.\.+\/\/*/', '', $path );
++    $path = preg_replace( '/^\/\/*/', '', $path );
++    return( $path );
++}
++
+ function getSkinFile( $file )
+ {
+     global $skinBase;
+     $skinFile = false;
+     foreach ( $skinBase as $skin )
+     {
+-        $tempSkinFile = 'skins'.'/'.$skin.'/'.$file;
++        $tempSkinFile = detaintPath( 'skins'.'/'.$skin.'/'.$file );
+         if ( file_exists( $tempSkinFile ) )
+             $skinFile = $tempSkinFile;
+     }
+@@ -2250,7 +2258,7 @@
+     $skinFile = false;
+     foreach ( $skinBase as $skin )
+     {
+-        $tempSkinFile = 'skins'.'/'.$skin.'/'.$file;
++        $tempSkinFile = detaintPath( 'skins'.'/'.$skin.'/'.$file );
+         if ( file_exists( $tempSkinFile ) )
+             $skinFile = $tempSkinFile;
+     }
+Index: zoneminder/web/index.php
+===================================================================
+--- zoneminder.orig/web/index.php      2013-02-26 16:55:04.000000000 -0800
++++ zoneminder/web/index.php   2013-02-26 17:13:03.376428137 -0800
+@@ -96,10 +96,13 @@
+ require_once( 'includes/functions.php' );
+
+ if ( isset($_REQUEST['view']) )
+-    $view = validHtmlStr($_REQUEST['view']);
++    $view = detaintPath($_REQUEST['view']);
++
++if ( isset($_REQUEST['request']) )
++    $request = detaintPath($_REQUEST['request']);
+
+ if ( isset($_REQUEST['action']) )
+-    $action = validHtmlStr($_REQUEST['action']);
++    $action = detaintPath($_REQUEST['action']);
+
+ require_once( 'includes/actions.php' );
+
+@@ -108,7 +111,6 @@
+
+ if ( isset( $_REQUEST['request'] ) )
+ {
+-    $request = validHtmlStr($_REQUEST['request']);
+     foreach ( getSkinIncludes( 'ajax/'.$request.'.php', true, true ) as $includeFile )
+     {
+         if ( !file_exists( $includeFile ) )
diff -Nru zoneminder-1.24.2/debian/patches/series zoneminder-1.24.2/debian/patches/series
--- zoneminder-1.24.2/debian/patches/series     2011-01-14 12:01:53.000000000 -0800
+++ zoneminder-1.24.2/debian/patches/series     2013-02-26 16:56:45.000000000 -0800
@@ -7,3 +7,5 @@
 suppported-typo
 use_libjs-mootools
 fix_v4l2_cameras_without_crop
+cve-2013-0232
+cve-2013-0332

live well,
  vagrant

```

---

**Reply sent**
to `Vagrant Cascadian <vagrant@debian.org>`:

You have taken responsibility.
(Sun, 17 Mar 2013 00:51:15 GMT) ([full text](bugreport.cgi?bug=700912;msg=26), [mbox](bugreport.cgi?bug=700912;mbox=yes;msg=26), [link](#25)).

---

**Notification sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Bug acknowledged by developer.
(Sun, 17 Mar 2013 00:51:15 GMT) ([full text](bugreport.cgi?bug=700912;msg=28), [mbox](bugreport.cgi?bug=700912;mbox=yes;msg=28), [link](#27)).

---

[Message #29](#29) received at 700912-close@bugs.debian.org ([full text](bugreport.cgi?bug=700912;msg=29), [mbox](bugreport.cgi?bug=700912;mbox=yes;msg=29), reply):

![](/cgi-bin/libravatar.cgi?email=vagrant%40debian.org)
From: Vagrant Cascadian <vagrant@debian.org>
To: 700912-close@bugs.debian.org
Subject: Bug#700912: fixed in zoneminder 1.24.2-8+squeeze1
Date: Sun, 17 Mar 2013 00:47:39 +0000
```
Source: zoneminder
Source-Version: 1.24.2-8+squeeze1

We believe that the bug you reported is fixed in the latest version of
zoneminder, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 700912@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Vagrant Cascadian <vagrant@debian.org> (supplier of updated zoneminder package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Tue, 05 Mar 2013 11:29:20 -0800
Source: zoneminder
Binary: zoneminder
Architecture: source i386
Version: 1.24.2-8+squeeze1
Distribution: stable-security
Urgency: high
Maintainer: Peter Howard <pjh@northern-ridge.com.au>
Changed-By: Vagrant Cascadian <vagrant@debian.org>
Description:
 zoneminder - Linux video camera security and surveillance solution
Closes: [698910](bugreport.cgi?bug=698910) [700912](bugreport.cgi?bug=700912)
Changes:
 zoneminder (1.24.2-8+squeeze1) stable-security; urgency=high
 .
   * Add [CVE-2013-0232](https://security-tracker.debian.org/tracker/CVE-2013-0232) patch
     [SECURITY] [CVE-2013-0232](https://security-tracker.debian.org/tracker/CVE-2013-0232): Shell escape commands with untrusted content.
     Thanks to James McCoy <jamessan@debian.org> (Closes: #[698910](bugreport.cgi?bug=698910))
     Thanks also to Salvatore Bonaccorso <carnil@debian.org>
   * Add [CVE-2013-0332](https://security-tracker.debian.org/tracker/CVE-2013-0332) patch
     [SECURITY] [CVE-2013-0332](https://security-tracker.debian.org/tracker/CVE-2013-0332): local file inclusion (Closes: #[700912](bugreport.cgi?bug=700912)).
     Thanks to Salvatore Bonaccorso <carnil@debian.org> for the patch.
Checksums-Sha1:
 ae8f0f4b6efe78716884bc1e7c90d7540e953160 2163 zoneminder_1.24.2-8+squeeze1.dsc
 ea854c941b83374a352d7d794a4462e279fea487 965521 zoneminder_1.24.2.orig.tar.gz
 e48447bcbc7dff2fc0298df6bc945c228a2a3f02 16354 zoneminder_1.24.2-8+squeeze1.debian.tar.gz
 52df39684bdf4a824093307f08e4feb0f6089634 1452144 zoneminder_1.24.2-8+squeeze1_i386.deb
Checksums-Sha256:
 fcf53e1f74a319e01b5ebc27bac5fbd6206361a1009bb71b838408375bd6a30a 2163 zoneminder_1.24.2-8+squeeze1.dsc
 fd8475138ccee8870534f1210a3d1e3e1990e963dd73146a6d310dc71c463dca 965521 zoneminder_1.24.2.orig.tar.gz
 49dc4eca5d00d895a66d69429624dbf1c6bcd292a24869ea198a1ac49a07113b 16354 zoneminder_1.24.2-8+squeeze1.debian.tar.gz
 076ea52707b213172ddde42420d27dc0de7d5c0d865651700d50d48af589a1f8 1452144 zoneminder_1.24.2-8+squeeze1_i386.deb
Files:
 5948f712a603d4ea59dff82b3c0cd13d 2163 net optional zoneminder_1.24.2-8+squeeze1.dsc
 550d2f8f08852134028c3b1cf8fa437f 965521 net optional zoneminder_1.24.2.orig.tar.gz
 65fc0a8d14f672dd3c6cf8586abdf086 16354 net optional zoneminder_1.24.2-8+squeeze1.debian.tar.gz
 df954eec140564bac3f36dcb5c8e4fc9 1452144 net optional zoneminder_1.24.2-8+squeeze1_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQIcBAEBCgAGBQJRNlGIAAoJELeLgtSBS5G2j2UP/20Y4yz7on6jQvEZhh6AS7I0
rzGODYx9YZj/EJcUwlXR9g8dmrRnbFi8tpOOA+0EXUVqeJwOj3wq+ch+7aPYuzgK
/WKT3tp+H/qxcqXcKHD1+vDvDKds2qjRIBQHLev4pWqaqY+s8ocvne63oRqRKb9q
u3zdo3wn7nJoiPbQKvCB0SlQWxV5fGyOJ0YQ0CYOF2qjYViUEge0XUhCWi9IhudL
ukuQR+KSuAS4N2i8Z/+32edCBdOgBL9uYCsMJ5LUSi4A0m8g08O5Jghg6foClLAh
ur3JDAfmamBEHMvTw1+qfw1Ek3xwUjqjKXjlGpxOilvgCfOAVml3KY3JZ3rTE+5g
xA570W2oDEuFO7ZHxxzg5EMCI5gGlyJWDhs6u1gJbk8bbBz7bKCyvqduC+tK5www
XglushHPUGtOPuhFcbG5nHYklJL01S0nIPoFEXxAzjiPBp+URql7+EYMJGVfibHc
wTKFs1ks7TjjDrmQkyc0XJrZWvg3QQgGy5E2cxt8amBfuBEzR9pHTTzK95iO18cc
mKNE1vqc5q/cyjp+5IlIl9Pmjyg1UDrgz1exICbJTIZq/3XrNZCzlGHM367eOXeY
lVEOx7oJkwMZ5L0zQVwgn0bj8ui9A5w6FHiy9t6YEufhi+5BVAqSPJqQ4032tMv4
njXHyQV4scz8PdHjrcTF
=ZGx8
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 02 Jun 2013 07:36:02 GMT) ([full text](bugreport.cgi?bug=700912;msg=31), [mbox](bugreport.cgi?bug=700912;mbox=yes;msg=31), [link](#30)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=700912).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 02:08:00 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from www.openwall.com_8972ef33_20250125_020802.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](8) [[next>]](10) [[<thread-prev]](8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20130221082823.GA11718@elende>
Date: Thu, 21 Feb 2013 09:28:23 +0100
From: Salvatore Bonaccorso <carnil@...ian.org>
To: Kurt Seifried <kseifried@...hat.com>
Cc: oss-security@...ts.openwall.com
Subject: Re: CVE request: zoneminder: local file inclusion
 vulnerability

Hi Kurt

Thank you for the CVE assignment!

On Wed, Feb 20, 2013 at 11:59:58PM -0700, Kurt Seifried wrote:
> > Hi
> >
> > In zoneminder forum the following announce was done already in
> > 2011:
> >
> > <http://www.zoneminder.com/forums/viewtopic.php?f=1&t=17979>
>
> Stupid Q, is there like an official security page? POsting stuff to a
> forum is not exactly the easiest place to find things, can they setup
> like zoneminder.com/security/ and at least list all the security
> issues and link to them there so people don't have to dig through the
> forums?
>
> I say this because this is the first cve request I've ever seen for
> zoneminder since I started assigning, and indeed, since 2008, so I'm
> guessing there's a few more missing ones......

I further know about the wikipage with the ChangeLog, but there is no
patch referenced (thus the forum post). It's here:

 [1] <http://www.zoneminder.com/wiki/index.php/Change_History>

But I have not read trough yet, to see if there are more changes
indicating some security implication. For the one of my request there
was only

FIX - Fixed Local File Inclusion (LFI) vulnerability. Please note a
patch for this is also available for 1.24.4 which the 1.24.4 tarball
also contains for recent downloads.

> If someone wants to big through the forums to find them and post them
> here that would probably be helpful (seriously, wanna pad your resume
> and get a reference from me? first person to make 100 good CVE
> requests wins).

I can check indeed if I find more. The the forum post for
CVE-2013-0232 there is still no answer from upstream[2]

 [2]: <http://www.zoneminder.com/forums/viewtopic.php?f=29&t=20771>

Regards,
Salvatore

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


