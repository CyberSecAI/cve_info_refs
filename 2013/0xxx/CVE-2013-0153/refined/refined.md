```
{
  "cve_id": "CVE-2013-0153",
  "description": "The Xen AMD IOMMU code by default chooses to use a single interrupt remapping table for the whole system. This sharing implies that any guest with a passed through PCI device that is bus mastering capable can inject interrupts into other guests, including domain 0. Furthermore, regardless of whether a shared interrupt remapping table is in use, old entries are not always cleared, providing opportunities for guests to inject interrupts into other guests, again including domain 0.",
  "vulnerability_details": {
    "root_cause": "The Xen AMD IOMMU code, by default, uses a single interrupt remapping table for the whole system. Also, old entries in the interrupt remapping table are not always cleared.",
    "weaknesses": [
      "Sharing of interrupt remapping table",
      "Failure to clear old entries in the interrupt remapping table"
    ],
    "impact": "A malicious guest with a passed through bus mastering capable PCI device can inject interrupts into other guests, including domain 0, resulting in a denial of service affecting the whole system. This could also cause a crash of the hypervisor.",
    "attack_vectors": [
      "A guest with a passed-through PCI device that is bus mastering capable can inject interrupts into other guests."
     ],
    "required_capabilities": "The attacker needs to have a guest domain with access to a physical PCI device that is bus mastering capable. The guest must be able to write to the interrupt remapping table."
  },
  "affected_systems": [
    "Xen versions 3.3 onwards.",
	"Red Hat Enterprise Linux 5 kernel-xen package.",
    "OpenSUSE 11.4, 12.1, 12.2",
    "Gentoo Xen versions prior to 4.2.2-r1"
  ],
  "mitigations": [
    "Avoid assigning PCI devices to untrusted guests.",
    "In Xen versions 4.1.3 and above, use the command line option 'iommu=amd-iommu-perdev-intremap' to avoid sharing the interrupt remapping table."
  ],
  "patches": [
     "xsa36-unstable.patch (Xen unstable)",
     "xsa36-4.2.patch (Xen 4.2.x)",
     "xsa36-4.1.patch (Xen 4.1.x)"
  ]
}
```