=== Content from bitcointalk.org_3497b8ea_20250125_162010.html ===


| Bitcoin Forum |  |
| --- | --- |

| January 25, 2025, 04:20:10 PM * |
| --- |
| | Welcome, **Guest**. Please [login](https://bitcointalk.org/index.php?action=login) or [register](https://bitcointalk.org/index.php?action=register). | | | --- | --- | | |

| **News**: [Community Awards voting is open](https://bitcointalk.org/index.php?topic=5525252.0) |  |
| --- | --- |

|  |  | [Home](https://bitcointalk.org/index.php) |  | [Help](https://bitcointalk.org/index.php?action=help) | [Search](https://bitcointalk.org/index.php?action=search) | [Login](https://bitcointalk.org/index.php?action=login) | [Register](https://bitcointalk.org/index.php?action=register) | [More](/more.php) |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

**[Bitcoin Forum](https://bitcointalk.org/index.php)** > **[Bitcoin](https://bitcointalk.org/index.php#1)** > **[Development & Technical Discussion](https://bitcointalk.org/index.php?board=6.0)** > **[New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.0)**

| Pages: [**1**] | [« previous topic](https://bitcointalk.org/index.php?topic=140078.0;prev_next=prev#new) [next topic »](https://bitcointalk.org/index.php?topic=140078.0;prev_next=next#new)  |  | [Print](https://bitcointalk.org/index.php?action=printpage;topic=140078.0) |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- |

|  | Author | Topic: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify  (Read 17571 times) |
| --- | --- | --- |

| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1491085#msg1491085) January 30, 2013, 08:16:52 PMLast edit: January 30, 2013, 09:06:56 PM by Sergio\_Demian\_Lerner*Merited by [LoyceV](/index.php?action=profile;u=459836) (8), [BlackHatCoiner](/index.php?action=profile;u=2775483) (8), [ABCbits](/index.php?action=profile;u=359716) (3), [vapourminer](/index.php?action=profile;u=33156) (2), [darosior](/index.php?action=profile;u=1804392) (2)* | [#1](https://bitcointalk.org/index.php?topic=140078.msg1491085#msg1491085) | | --- | --- | --- |  ---   **New Bitcoin vulnerability: A transaction that takes at least 3 minutes to be verified by a peer**What is the most CPU consuming transaction an attacker can create? (\*)Don't keep reading. Take a minute to think about it.........Most people will immediately look for a transaction that verifies as many signatures as possible. One can achieve this by trying to spend many previous outputs that you own, with a single signature verification for each.But it turns out that that attack is quite expensive: given that each TxIn requires at least 100 bytes to hold a signature, a 1Mb transaction would only hold 10K signatures. Assuming each signature verification takes 2 msec, processing the transactionwould take 20 seconds. But even then we would need 10K previns ready to be spent, which would be quite hard to achieve.If the attacker is a miner, he can create a transaction that exposes 10K outputs (TxPrep), and follow it by the transaction that consumes them (TxAttack). But TxPrep would require an  additional 340 Kbytes, so TxAttack would be shorter than expected.**Repeated SHA-256 hashing**There is a another way of forcing clients to do expensive computations with less resources, and that is by forcing clients to hashthe transaction many times: by design each time a signature is verified, the whole transaction is hashed, with some minor modifications.(check  <https://en.bitcoin.it/wiki/OP_CHECKSIG> and the beautiful accompanying graph made by Etotheipi)Using this fact, a miner can construct a transaction take takes more than 3 minutes to be verified (assuming 100 MiB/sec of SHA-256 hashing speed).First the attacker creates a a transaction that sends 1 satoshi to 100 outputs. Each output is not a standard scriptPub, but special scriptPub that consist of the opcodes: OP\_CHECKSIG (200 times) OP\_TRUEThis script constains no more than 200 sigops, so is a valid script (200 is the limit).TxPrep takes aproximately 21 Kbytes from the 1M block.Then the attacker builds the transaction TxAttack which uses all these TxPrep outputs. To make the transaction valid, each scriptSig is:  OP\_0 (201 times)The previn part of the Txattack transaction takes aproximately 24 Kbytes.The rest of the TxAttack transaction (upto 1Mb is filled) is made of a few outputs with long scripts (or a lot of outputs with short scripts). This part of the transaction is almost 955 Kbytes long. (\*\*)Now, to verify a single script (scriptSig+ScriptPub) the client tries to verify 200 signatures. Obviously each of those verification return false, since 0x00 is neither a valid ECDSA public key nor a valid ECDSA signature.But the client has to rehash the 955 Kbytes of data 200 times.The total size hashed is 100\*200\*955000=19 100 000 000 bytesAssuming that OpenSSL code performance of SHA-256 hashing is 100 MiB/sec, then the hashing takes 191 seconds.The proposed attack requires that miners includes both TxPrep and TxAttack in blocks (but I may be different blocks).This could be achieved by any user by adding some BTC as fees (I think 1 BTC will do).Nevertheless, another attack can be constructed by using a standard transaction, that is relied normally from peer to peer.The attacker can use a standard multisignature transaction to try to pack more verifications in less space ( 1-in-3 OP\_CHECKMULTISIG ).This attack is much more difficult, since it requires the attacker to prepare more than 6000 outputs to be used.**How this vulnerability could be used to perform an attack?**1. A miner that can mine one of these block every 10 blocks (having 10% of the network hashing power) can force the blockchain verification  process to be a lot slower. Verifying a year of the blockchain would take more than 10 days of CPU time.2. A miner could use this attack combined by other idea gets a greater probability of finding a block the next block.3. A peer wants to DoS attack another peer. (but the penny-flooding protection must be bypassed somehow)4. If miners do not prevent these transactions from being included in their blocks, an attacker can create a TxPrep/TxAttack pair transaction for every block mined, and send the pair every 10 minutes, with a 1 BTC fee, to be included in the next block. Validating the blockchain would take almost half the time it takes to generate it, then the coin price would collapse, the attack becomes cheaper, ... dooms day. Obviously miners will stop including such transactions and nothing horrible really happens. But miners should have to reject tasty fees, and I don't know how the incentives will play for them. **Not a Solution (without hard-forking)**Create a Transaction hash cache to temporarily store the last used hash during the evaluation of a script. Note that the attack can still be executed by using independent outputs. (TxPrep creates 20K outputs, using 200 Kbytes, then TxAttack consumes these 20K outputs, and requires 152 seconds to be verified)**Quite good Solution (without hard-forking)**Verify that the ECDSA signature and the ECDSA public key are well-formed before hashing the transaction.(this reduces the maximum CPU time to about 30 seconds, since now TxAttack wastes more bytes in signatures)**My Solution proposals**1. Soft-forking: Reduce the maximum transaction size to 100 Kbytes. (AGAIN Sergio !?!)   2. Hard-forking: For script evaluation purposes Define    Hash(Tx,previn-index) = Hash ( Hash(outputs) || Hash (Inputs-with-script-cleared) || <previn-index> )   (for SIGHASH\_ALL)   This way the values "Hash(outputs)" and "Hash(Inputs-with-script-cleared)" can be cached and reused.Best regards, Sergio.(\*) Note that I have excluded the hard-disk resource on purpose, since that's another story I'll be telling you in some time(\*\*) I've not created and tested the transaction, but it seems to me that there is nothing in the protocol that stops it. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | | **[Gavin Andresen](https://bitcointalk.org/index.php?action=profile;u=224 "View the profile of Gavin Andresen")** Legendary * qt Offline Offline Activity: 1652 Merit: 2317  Chief Scientist   [View Profile](https://bitcointalk.org/index.php?action=profile;u=224) [WWW](http://gavinthink.blogspot.com/?CC9873 "My blog") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1491378#msg1491378) January 30, 2013, 09:50:11 PM*Merited by [ABCbits](/index.php?action=profile;u=359716) (1)* | [#2](https://bitcointalk.org/index.php?topic=140078.msg1491378#msg1491378) | | --- | --- | --- |  ---   Thanks Sergio!So:  if the attacker creates a block with a transaction that takes 3 minutes to verify, and then broadcasts it, it will take a very long time for it to propagate across the network (because peers verify blocks before relaying them).And since this attack requires non-standard transactions, mining a block is the only way an attacker will be able to pull off this attack. So I don't think this is a practical attack on the production network: by the time the 3-minute-to-verify block got to 50% of the network the other half of the network will probably have produced a block (sure, the attacker could try to Sybil the network and send its block to a super-majority of mining nodes, but I bet all of the big mining pools are hiding their block-creating and share-accepting nodes behind multiple "front-end bitcoinds" by now to mitigate DDoS attacks).Fixing the OP\_\*SIG opcodes so they "look before they hash" is a good idea. We're actually moving towards that; see fStrictEncodings and the IsCanonicalSignature/IsCanonicalPubKey in the latest script.cpp code. The intent is to eventually roll out a 'soft-fork' that requires signatures and public keys be well-formed and canonical.Also, a nit: using OP\_0 for the scriptSig wouldn't work for this attack (see if (vchSig.empty()) return false; in CheckSig()). | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   How often do you get the chance to work on a potentially world-changing project? | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494005#msg1494005) January 31, 2013, 07:37:21 PM*Merited by [ABCbits](/index.php?action=profile;u=359716) (3)* | [#3](https://bitcointalk.org/index.php?topic=140078.msg1494005#msg1494005) | | --- | --- | --- |  ---   I realized that the "Quite Good" solution only does not work alone. It's not enough to verify that the arguments are well-formed.A complete solution requires that the last hash digest of the transaction is cached and reused in the following verifications of the same prevout.Here is a modified attack that verifies 19932 well-formed signatures against a well-formed public key.I use 151 inputs. Each input requires 132 verifications. That's 19932 verifications in total.**ScriptSig:**OP\_PUSHDATA1<sig-size><signature>OP\_PUSHDATA1<pubkey-size><pubkey>{ repeat the following part 66 timesOP\_2DUPOP\_CHECKSIGOP\_DROP}>> stack after execution  of ScriptSig:    [bottom] <signature> <pubkey-size> [top]**ScriptPub:**{ repeat the following part 66 timesOP\_2DUPOP\_CHECKSIGOP\_DROP}OP\_DROPOP\_DROPOP\_TRUE>> stack after execution  of ScriptPub:    [bottom] <1> [top]The part that does not contribute to hashing is 76 Kbytes long, so the remaining 924500 bytes are hashed.The transaction takes at least **184 seconds** to verify.Without the signature cache, it would take an additional 40 seconds.If the last hash of the transaction used while evaluation a script is cached, then only the first hash of each prevout is computed, and that will require only 151 evaluations (not 19932)Best regards! Sergio. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494025#msg1494025) January 31, 2013, 07:49:29 PM | [#4](https://bitcointalk.org/index.php?topic=140078.msg1494025#msg1494025) | | --- | --- | --- |  ---   [Quote from: Gavin Andresen on January 30, 2013, 09:50:11 PM](https://bitcointalk.org/index.php?topic=140078.msg1491378#msg1491378)And since this attack requires non-standard transactions, mining a block is the only way an attacker will be able to pull off this attack. There is at least one mining pool that accepts direct connections to be used to send non-standard transactions. So the attack could in theory be done by anyone willing to pay some fees (that, right now, are very cheap). | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[DeathAndTaxes](https://bitcointalk.org/index.php?action=profile;u=41048 "View the profile of DeathAndTaxes")** Donator Legendary * Offline Offline Activity: 1218 Merit: 1086  Gerald Davis   [View Profile](https://bitcointalk.org/index.php?action=profile;u=41048) | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494061#msg1494061) January 31, 2013, 08:10:26 PM | [#5](https://bitcointalk.org/index.php?topic=140078.msg1494061#msg1494061) | | --- | --- | --- |  ---   [Quote from: Sergio\_Demian\_Lerner on January 31, 2013, 07:49:29 PM](https://bitcointalk.org/index.php?topic=140078.msg1494025#msg1494025)[Quote from: Gavin Andresen on January 30, 2013, 09:50:11 PM](https://bitcointalk.org/index.php?topic=140078.msg1491378#msg1491378)And since this attack requires non-standard transactions, mining a block is the only way an attacker will be able to pull off this attack. There is at least one mining pool that accepts direct connections to be used to send non-standard transactions. So the attack could in theory be done by anyone willing to pay some fees (that, right now, are very cheap).Well the nice things is there is an economic cost to the miner.  If the miner starts to notice their orphan rate skyrocket then they may wish to investigate why their blocks are taking so long.  Not sure how much it would increase the orphan rate but I would imagine a 3 minute (or even 30 second) verification time would destroy the pools competitiveness.  Earn a lot of fees and lose the block worth 25 BTC isn't really worth it.  When miners are willing to change pools over a 1% difference in orphan rates it shows how economically sensitive they are to anything which disrupts earnings. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Luke-Jr](https://bitcointalk.org/index.php?action=profile;u=3318 "View the profile of Luke-Jr")** Legendary * expert Offline Offline Activity: 2576 Merit: 1186   [View Profile](https://bitcointalk.org/index.php?action=profile;u=3318) | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494449#msg1494449) January 31, 2013, 11:00:39 PM | [#6](https://bitcointalk.org/index.php?topic=140078.msg1494449#msg1494449) | | --- | --- | --- |  ---   [Quote from: Sergio\_Demian\_Lerner on January 31, 2013, 07:49:29 PM](https://bitcointalk.org/index.php?topic=140078.msg1494025#msg1494025)[Quote from: Gavin Andresen on January 30, 2013, 09:50:11 PM](https://bitcointalk.org/index.php?topic=140078.msg1491378#msg1491378)And since this attack requires non-standard transactions, mining a block is the only way an attacker will be able to pull off this attack. There is at least one mining pool that accepts direct connections to be used to send non-standard transactions. So the attack could in theory be done by anyone willing to pay some fees (that, right now, are very cheap).I presume you're referring to Eligius here. We can just disable non-standard transactions until I come up with a good long-term solution...Wouldn't this also be fixed by simply caching the transaction hash for the first OP\_CHECKSIG ? | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   Donate: (PM me)My projects: [Bitcoin Knots](http://bitcoinknots.org/), [Bitcoin Core](https://bitcoincore.org/), [BFGMiner](https://bitcointalk.org/?topic=626361), [Eloipool (pool software)](https://bitcointalk.org/index.php?topic=61731.0), [Tonal Bitcoin](https://en.bitcoin.it/wiki/Tonal_Bitcoin), and [BitGit (Bitcoin code directory)](http://luke.dashjr.org/programs/bitcoin/) | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494507#msg1494507) January 31, 2013, 11:32:52 PMLast edit: February 01, 2013, 04:21:53 AM by Sergio\_Demian\_Lerner | [#7](https://bitcointalk.org/index.php?topic=140078.msg1494507#msg1494507) | | --- | --- | --- |  ---   I have good news ~~and bad news~~.The good news (as I already said) is that it can be patched by caching the last tx hash AND checking the key/pubkey format before hashing (or at least check that the size of the arguments is correct)~~The bad news is that I came across a new attack that can DESTROY the credibility of the network in a few days. **So please Eligius, you better stop allowing non-standard transactions for a while until everybody upgrades or every miner in earth conforms to reject non-standard transactions.**~~~~The idea is to make the splitting of TxPrep/TxAttack in such a way that the TxPrep part is non-standard, but it´s also small and will be included in blocks like the ones mined by Eligius.Then TxAttack is made standard, so IT WILL BE FORWARDED by nodes.An attacker can send many TxPrep(i) during a preparation phase (and also during the attack) interlaced with TxAttack(i). So the attacker can, at any time and for any amount of time, pose an enormous amount of work to the network for very little cost.The scripts look like this:**TxPrep:** NON-STANDARD100 outputs:scriptPub:OP\_0 { 199 times}OP\_CHECKSIG {198 times}OP\_DROP<pubKey> OP\_CHECKSIG{leaves the stack as: [BOTTOM] <pubKey> [TOP]}Size: 46 Kbytes. **TxAttack:** STANDARD100 inputs:scriptSig: <sig>Size of inputs: 10 Kbytes.Size of outputs: 990 Kbytes.Size of transaction: 1Mb Time to verify: 990 Kbytes \* 20000 / 100000000 = 198 secsTime to send the tx: 20 seconds. (at 50 Kbytes/sec)So imagine an attacker prepares the attack for a few days, by storing into the blockchain a hundred TxPrep(i), and the suddenly releases all of the TxAttack(i).I nobody finds a good reason not to, I will be changing the title of this thread to reflect the change in impact of the attack.~~Best regards, Sergio. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Peter Todd](https://bitcointalk.org/index.php?action=profile;u=2546 "View the profile of Peter Todd")** Legendary * expert Offline Offline Activity: 1120 Merit: 1168  [View Profile](https://bitcointalk.org/index.php?action=profile;u=2546) | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494563#msg1494563) February 01, 2013, 12:04:41 AMLast edit: February 01, 2013, 12:25:00 AM by retep | [#8](https://bitcointalk.org/index.php?topic=140078.msg1494563#msg1494563) | | --- | --- | --- |  ---   Has anyone tried this on testnet yet?EDIT: and while we're at it, you realize how you're going direct to disclosing this in public, right at a time when Avalon ASIC boxes are being shipped that can mine a block every 2 days on average? Frankly I think this is rather irresponsible of you. I did the whole [responsible disclosure](https://en.wikipedia.org/wiki/Responsible_disclosure) process for the silly little nLockTime oversight I found, and here you are putting everything in public for a problem that's potentially far more serious. The dev team could have easily snuck a fix into the upcoming 0.8 release. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   BTC: [1FCYd7j4CThTMzts78rh6iQJLBRGPW9fWv](http://0bin.net/paste/wZ9ybXwCXlXcIQo5#sENvcsLbkOXIYSWsIVxqyOVIXJeoLv5uqEg-lHtsrrH)  PGP: [7FAB114267E4FA04](http://pool.sks-keyservers.net:11371/pks/lookup?op=vindex&search=0x37EC7D7B0A217CDB4B4E007E7FAB114267E4FA04) | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494654#msg1494654) February 01, 2013, 12:47:00 AM | [#9](https://bitcointalk.org/index.php?topic=140078.msg1494654#msg1494654) | | --- | --- | --- |  ---   Retep:First, when I first published the vulnerability, I thought I wasn't critical. Almost each time I do responsible disclosing (and I did it more than 5 times), the core devs disregard the issues, so I really thought it was another minor vuln. The fact that Gavin disregarded it in this thread means that I would have published it anyway, even after going through the undocumented process of responsible disclosing.Second, after I published the first details, the extension to standard tx would be pretty obvious to anybody willing to think about it a minute.So the best I could do was to tell the truth and protect the network from attackers telling miners to prepare from such attack.Third, anyone willing to invest 100K USD in ASIC will always be able to disrupt the network, so it's no difference before and after this vuln was disclosed.Protecting the network is very easy: don't include non-standard transactions in blocks.My final word is that the **attack is not critical**, nothing to start shouting everywhere, but it's real.Best regards, Sergio. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Gavin Andresen](https://bitcointalk.org/index.php?action=profile;u=224 "View the profile of Gavin Andresen")** Legendary * qt Offline Offline Activity: 1652 Merit: 2317  Chief Scientist   [View Profile](https://bitcointalk.org/index.php?action=profile;u=224) [WWW](http://gavinthink.blogspot.com/?CC9873 "My blog") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494724#msg1494724) February 01, 2013, 01:26:27 AMLast edit: February 01, 2013, 02:14:54 AM by Gavin Andresen | [#10](https://bitcointalk.org/index.php?topic=140078.msg1494724#msg1494724) | | --- | --- | --- |  ---   Sergio:It **would** be more helpful if you either took a little bit more time and actually wrote a little bit of code to make sure the attack works, and started the conversation privately with "here's code that demonstrates a very expensive-to-verify transaction and a few suggestions on how you might fix it..."I created a simulation of TxPrep/TxAttack by adding them to src/test/data/script\_valid.json and then running through the script\_tests.cpp unit test in the debugger, and with the particular TxPrep you propose there is no problem with current code.Also, TxAttack is not standard with the latest code; see CTransaction::AreInputsStandard(), which checks the scriptPubKeys being spent.RE:  undocumented process of responsible disclosing :  good point.  Where would you expect to find the process documented?  We can fix that... | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   How often do you get the chance to work on a potentially world-changing project? | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Luke-Jr](https://bitcointalk.org/index.php?action=profile;u=3318 "View the profile of Luke-Jr")** Legendary * expert Offline Offline Activity: 2576 Merit: 1186   [View Profile](https://bitcointalk.org/index.php?action=profile;u=3318) | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494788#msg1494788) February 01, 2013, 02:02:54 AM | [#11](https://bitcointalk.org/index.php?topic=140078.msg1494788#msg1494788) | | --- | --- | --- |  ---   [Quote from: Sergio\_Demian\_Lerner on February 01, 2013, 12:47:00 AM](https://bitcointalk.org/index.php?topic=140078.msg1494654#msg1494654)Protecting the network is very easy: don't include non-standard transactions in blocks.An attack like this just requires a hostile party to mine 1 block.That's still within reach of most people, even after ASIC hits on full.Blocking out "non-standard" transactions in general just harms potential innovation. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   Donate: (PM me)My projects: [Bitcoin Knots](http://bitcoinknots.org/), [Bitcoin Core](https://bitcoincore.org/), [BFGMiner](https://bitcointalk.org/?topic=626361), [Eloipool (pool software)](https://bitcointalk.org/index.php?topic=61731.0), [Tonal Bitcoin](https://en.bitcoin.it/wiki/Tonal_Bitcoin), and [BitGit (Bitcoin code directory)](http://luke.dashjr.org/programs/bitcoin/) | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494853#msg1494853) February 01, 2013, 03:55:03 AM | [#12](https://bitcointalk.org/index.php?topic=140078.msg1494853#msg1494853) | | --- | --- | --- |  ---   [Quote from: Luke-Jr on February 01, 2013, 02:02:54 AM](https://bitcointalk.org/index.php?topic=140078.msg1494788#msg1494788)[Quote from: Sergio\_Demian\_Lerner on February 01, 2013, 12:47:00 AM](https://bitcointalk.org/index.php?topic=140078.msg1494654#msg1494654)Protecting the network is very easy: don't include non-standard transactions in blocks.An attack like this just requires a hostile party to mine 1 block.That's still within reach of most people, even after ASIC hits on full.Blocking out "non-standard" transactions in general just harms potential innovation.Even if a block containing a 3min tx is ever mined and buried into the blockchain, the 0.9 version of the Satoshi client could just check for the tx hash and, as an exception, set the transaction as verified without actually doing any verifications.As we already have good prevention measures in 0.8, as Gavin said, I really dubt that during the update process a 3min transaction will be mined. The time window is short and the attackers benefit, almost none (for a single tx mined). The real problem starts is if a hundred 3min transactions are mined, not just one.I would say miners have at least a month to upgrade. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494863#msg1494863) February 01, 2013, 04:00:03 AM | [#13](https://bitcointalk.org/index.php?topic=140078.msg1494863#msg1494863) | | --- | --- | --- |  ---   [Quote from: Gavin Andresen on February 01, 2013, 01:26:27 AM](https://bitcointalk.org/index.php?topic=140078.msg1494724#msg1494724)Sergio:It **would** be more helpful if you either took a little bit more time and actually wrote a little bit of code to make sure the attack worksI respect very much all the hard work all the core devs do designing and writing code. I have no time to code, so my contribution is to think. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494878#msg1494878) February 01, 2013, 04:10:01 AM | [#14](https://bitcointalk.org/index.php?topic=140078.msg1494878#msg1494878) | | --- | --- | --- |  ---   [Quote from: Gavin Andresen on February 01, 2013, 01:26:27 AM](https://bitcointalk.org/index.php?topic=140078.msg1494724#msg1494724)Also, TxAttack is not standard with the latest code; see CTransaction::AreInputsStandard(), which checks the scriptPubKeys being spent.Great! So, to clear this issue: Gavin stated there is NO WAY OF MAKING TxAttack STANDARD.That's relieving. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Peter Todd](https://bitcointalk.org/index.php?action=profile;u=2546 "View the profile of Peter Todd")** Legendary * expert Offline Offline Activity: 1120 Merit: 1168  [View Profile](https://bitcointalk.org/index.php?action=profile;u=2546) | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1497510#msg1497510) February 02, 2013, 07:10:02 AM | [#15](https://bitcointalk.org/index.php?topic=140078.msg1497510#msg1497510) | | --- | --- | --- |  ---   [Quote from: Sergio\_Demian\_Lerner on February 01, 2013, 04:00:03 AM](https://bitcointalk.org/index.php?topic=140078.msg1494863#msg1494863)I respect very much all the hard work all the core devs do designing and writing code. I have no time to code, so my contribution is to think.Often coding actually takes less time to solve a problem than just thinking, because by coding you let the computer help you find out if you are wrong much faster than trying to use reason to determine if you are wrong. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   BTC: [1FCYd7j4CThTMzts78rh6iQJLBRGPW9fWv](http://0bin.net/paste/wZ9ybXwCXlXcIQo5#sENvcsLbkOXIYSWsIVxqyOVIXJeoLv5uqEg-lHtsrrH)  PGP: [7FAB114267E4FA04](http://pool.sks-keyservers.net:11371/pks/lookup?op=vindex&search=0x37EC7D7B0A217CDB4B4E007E7FAB114267E4FA04) | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Luke-Jr](https://bitcointalk.org/index.php?action=profile;u=3318 "View the profile of Luke-Jr")** Legendary * expert Offline Offline Activity: 2576 Merit: 1186   [View Profile](https://bitcointalk.org/index.php?action=profile;u=3318) | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1566880#msg1566880) February 28, 2013, 06:36:06 AM | [#16](https://bitcointalk.org/index.php?topic=140078.msg1566880#msg1566880) | | --- | --- | --- |  ---   For reference, this is assigned CVE-2013-2292 | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   Donate: (PM me)My projects: [Bitcoin Knots](http://bitcoinknots.org/), [Bitcoin Core](https://bitcoincore.org/), [BFGMiner](https://bitcointalk.org/?topic=626361), [Eloipool (pool software)](https://bitcointalk.org/index.php?topic=61731.0), [Tonal Bitcoin](https://en.bitcoin.it/wiki/Tonal_Bitcoin), and [BitGit (Bitcoin code directory)](http://luke.dashjr.org/programs/bitcoin/) | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
|  |

| Pages: [**1**] | |  | [Print](https://bitcointalk.org/index.php?action=printpage;topic=140078.0) |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- |

| **[Bitcoin Forum](https://bitcointalk.org/index.php)** > **[Bitcoin](https://bitcointalk.org/index.php#1)** > **[Development & Technical Discussion](https://bitcointalk.org/index.php?board=6.0)** > **[New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.0)** | [« previous topic](https://bitcointalk.org/index.php?topic=140078.0;prev_next=prev#new) [next topic »](https://bitcointalk.org/index.php?topic=140078.0;prev_next=next#new) |
| --- | --- |

|  |
| --- |

Jump to:
Please select a destination:
-----------------------------
Bitcoin
-----------------------------
 => Bitcoin Discussion
 ===> Legal
 ===> Press
 ===> Meetups
 ===> Important Announcements
 => Development & Technical Discussion
 ===> Wallet software
 =====> Electrum
 =====> Bitcoin Wallet for Android
 =====> BitcoinJ
 =====> Armory
 =====> Mycelium
 =====> Hardware wallets
 => Mining
 ===> Mining support
 ===> Pools
 ===> Mining software (miners)
 ===> Hardware
 =====> Group buys
 ===> Mining speculation
 => Bitcoin Technical Support
 => Project Development
-----------------------------
Economy
-----------------------------
 => Economics
 ===> Speculation
 => Marketplace
 ===> Goods
 =====> Computer hardware
 =====> Digital goods
 =======> Invites & Accounts
 =====> Collectibles
 ===> Services
 ===> Currency exchange
 ===> Gambling
 =====> Games and rounds
 =====> Investor-based games
 =====> Gambling discussion
 ===> Lending
 =====> Long-term offers
 ===> Securities
 ===> Auctions
 ===> Service Announcements
 =====> Micro Earnings
 ===> Service Discussion
 =====> Web Wallets
 =====> Exchanges
 => Trading Discussion
 ===> Scam Accusations
 ===> Reputation
-----------------------------
Other
-----------------------------
 => Meta
 ===> New forum software
 ===> Bitcoin Wiki
 => Politics & Society
 => Beginners & Help
 => Off-topic
 => Serious discussion
 ===> Ivory Tower
 => Archival
 ===> Корзина
 ===> CPU/GPU Bitcoin mining hardware
 ===> Chinese students
 ===> Obsolete (buying)
 ===> Obsolete (selling)
 ===> MultiBit
-----------------------------
Alternate cryptocurrencies
-----------------------------
 => Altcoin Discussion
 => Announcements (Altcoins)
 ===> Tokens (Altcoins)
 => Mining (Altcoins)
 ===> Pools (Altcoins)
 => Marketplace (Altcoins)
 ===> Service Announcements (Altcoins)
 ===> Service Discussion (Altcoins)
 ===> Bounties (Altcoins)
 => Speculation (Altcoins)
-----------------------------
Local
-----------------------------
 => العربية (Arabic)
 ===> العملات البديلة (Altcoins)
 =====> النقاشات
 ===> إستفسارات و أسئلة المبتدئين
 ===> التعدين
 ===> النقاشات الأخرى
 ===> منصات التبادل
 => Bahasa Indonesia (Indonesian)
 ===> Marketplace (Bahasa Indonesia)
 ===> Mining (Bahasa Indonesia)
 ===> Altcoins (Bahasa Indonesia)
 ===> Trading dan Spekulasi
 ===> Ekonomi, Politik, dan Budaya
 ===> Topik Lainnya
 => Español (Spanish)
 ===> Mercado y Economía
 =====> Servicios
 =====> Trading y especulación
 ===> Hardware y Minería
 ===> Esquina Libre
 ===> Mercadillo
 =====> Mexico
 =====> Argentina
 =====> España
 =====> Centroamerica y Caribe
 ===> Primeros pasos y ayuda
 ===> Altcoins (criptomonedas alternativas)
 =====> Minería de altcoins
 =====> Servicios
 =====> Tokens (Español)
 => 中文 (Chinese)
 ===> 跳蚤市场
 ===> 山寨币
 ===> 媒体
 ===> 挖矿
 ===> 离题万里
 => Hrvatski (Croatian)
 ===> Trgovina
 ===> Altcoins (Hrvatski)
 =====> Announcements (Hrvatski)
 ===> Off-topic (Hrvatski)
 => Deutsch (German)
 ===> Anfänger und Hilfe
 ===> Mining (Deutsch)
 ===> Trading und Spekulation
 ===> Projektentwicklung
 ===> Off-Topic (Deutsch)
 ===> Treffen
 ===> Presse
 ===> Altcoins (Deutsch)
 =====> Announcements (Deutsch)
 ===> Marktplatz
 =====> Auktionen
 =====> Suche
 =====> Biete
 => Ελληνικά (Greek)
 ===> Αγορά
 ===> Mining Discussion (Ελληνικά)
 ===> Altcoins (Ελληνικά)
 =====> Altcoin Announcements (Ελληνικά)
 =====> Altcoin Mining (Ελληνικά)
 => עברית (Hebrew)
 => Français
 ===> Actualité et News
 ===> Débutants
 ===> Discussions générales et utilisation du Bitcoin
 ===> Mining et Hardware
 ===> Économie et spéculation
 ===> Place de marché
 =====> Échanges
 =====> Produits et services
 =====> Petites annonces
 ===> Le Bitcoin et la loi
 ===> Wiki, documentation et traduction
 ===> Développement et technique
 ===> Vos sites et projets
 ===> Hors-sujet
 ===> Altcoins (Français)
 =====> Annonces
 => India
 ===> Mining (India)
 ===> Marketplace (India)
 ===> Regional Languages (India)
 ===> Press & News from India
 ===> Alt Coins (India)
 ===> Buyer/ Seller Reputations (India)
 ===> Off-Topic (India)
 => Italiano (Italian)
 ===> Guide (Italiano)
 ===> Progetti
 ===> Discussioni avanzate e sviluppo
 ===> Trading, analisi e speculazione
 ===> Mercato
 =====> Mercato valute
 =====> Beni
 =====> Servizi
 =====> Esercizi commerciali
 =====> Hardware/Mining (Italiano)
 =====> Gambling (Italiano)
 ===> Accuse scam/truffe
 ===> Mining (Italiano)
 ===> Alt-Currencies (Italiano)
 =====> Annunci
 ===> Raduni/Meeting (Italiano)
 ===> Crittografia e decentralizzazione
 ===> Off-Topic (Italiano)
 => 日本語 (Japanese)
 ===> アルトコイン
 => Nederlands (Dutch)
 ===> Markt
 ===> Gokken/lotterijen
 ===> Mining (Nederlands)
 ===> Beurzen
 ===> Alt Coins (Nederlands)
 ===> Off-topic (Nederlands)
 ===> Meetings (Nederlands)
 => Nigeria (Naija)
 ===> Politics and society (Naija)
 ===> Off-topic (Naija)
 => 한국어 (Korean)
 ===> 대체코인 Alt Coins (한국어)
 => Pilipinas
 ===> Altcoins (Pilipinas)
 =====> Altcoin Announcements (Pilipinas)
 ===> Pamilihan
 ===> Others (Pilipinas)
 => Polski
 ===> Tablica ogłoszeń
 ===> Alternatywne kryptowaluty
 =====> Nowe kryptowaluty i tokeny
 =====> Tablica ogłoszeń (altcoiny)
 => Português (Portuguese)
 ===> Primeiros Passos (Iniciantes)
 ===> Economia & Mercado
 ===> Mineração em Geral
 ===> Desenvolvimento & Discussões Técnicas
 ===> Criptomoedas Alternativas
 ===> Brasil
 ===> Portugal
 => Русский (Russian)
 ===> Новички
 ===> Бизнес
 =====> Барахолка
 =====> Обменники
 ===> Идеи
 ===> Кодеры
 ===> Майнеры
 ===> Политика
 ===> Трейдеры
 ===> Альтернативные криптовалюты
 =====> Токены
 =====> Бayнти и aиpдpoпы
 ===> Хайпы
 ===> Работа
 ===> Разное
 ===> Oбcyждeниe Bitcoin
 =====> Новости
 =====> Юристы
 => Română (Romanian)
 ===> Anunturi importante
 ===> Offtopic
 ===> Market
 =====> Discutii Servicii
 ===> Minerit
 ===> Tutoriale
 ===> Bine ai venit!
 ===> Presa
 ===> Altcoins (Monede Alternative)
 =====> Anunturi Monede Alternative
 => Skandinavisk
 => Türkçe (Turkish)
 ===> Bitcoin Haberleri
 ===> Pazar Alanı
 ===> Madencilik
 ===> Ekonomi
 ===> Servisler
 =====> Fonlar
 ===> Proje Geliştirme
 ===> Alternatif Kripto-Paralar
 =====> Madencilik (Alternatif Kripto-Paralar)
 =====> Duyurular (Alternatif Kripto-Paralar)
 ===> Konu Dışı
 ===> Yeni Başlayanlar & Yardım
 ===> Buluşmalar
 => Other languages/locations

| [Powered by MySQL](http://www.mysql.com/) [Powered by PHP](http://www.php.net/) | [Powered by SMF 1.1.19](http://www.simplemachines.org/ "Simple Machines Forum") | [SMF © 2006-2009, Simple Machines](http://www.simplemachines.org/about/copyright.php "Free Forum Software") | [Valid XHTML 1.0!](http://validator.w3.org/check/referer) [Valid CSS!](http://jigsaw.w3.org/css-validator/check/referer) |
| --- | --- | --- |

Loading...


=== Content from en.bitcoin.it_e03c88c2_20250125_162011.html ===


# Common Vulnerabilities and Exposures

From Bitcoin Wiki
(Redirected from [CVEs](/w/index.php?title=CVEs&redirect=no "CVEs"))

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)

| CVE | Announced | Affects | Severity | Attack is... | Flaw | Net |
| --- | --- | --- | --- | --- | --- | --- |
| Pre-BIP protocol changes | n/a | All Bitcoin clients | Netsplit[[1]](#cite_note-Netsplit-1) | Implicit[[2]](#cite_note-hardfork-2) | [Various hardforks and softforks](/wiki/Consensus_versions "Consensus versions") | 100% |
| [CVE-2010-5137](#CVE-2010-5137) | 2010-07-28 | wxBitcoin and bitcoind | DoS[[3]](#cite_note-DoS-3) | Easy | OP\_LSHIFT crash | 100% |
| [CVE-2010-5141](#CVE-2010-5141) | 2010-07-28 | wxBitcoin and bitcoind | Theft[[4]](#cite_note-Theft-4) | Easy | OP\_RETURN could be used to spend any output. | 100% |
| [CVE-2010-5138](#CVE-2010-5138) | 2010-07-29 | wxBitcoin and bitcoind | DoS[[3]](#cite_note-DoS-3) | Easy | Unlimited SigOp DoS | 100% |
| **[CVE-2010-5139](/wiki/CVE-2010-5139 "CVE-2010-5139")** | 2010-08-15 | wxBitcoin and bitcoind | Inflation[[5]](#cite_note-inflation-5) | Easy | Combined output overflow | 100% |
| [CVE-2010-5140](#CVE-2010-5140) | 2010-09-29 | wxBitcoin and bitcoind | DoS[[3]](#cite_note-DoS-3) | Easy | Never confirming transactions | 100% |
| [CVE-2011-4447](#CVE-2011-4447) | 2011-11-11 | wxBitcoin and bitcoind | Exposure[[6]](#cite_note-Exposure-6) | Hard | Wallet non-encryption | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2011-4447.html) |
| [CVE-2012-1909](#CVE-2012-1909) | 2012-03-07 | Bitcoin protocol and all clients | Netsplit[[1]](#cite_note-Netsplit-1) | Very hard | Transaction overwriting | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-1909.html) |
| [CVE-2012-1910](#CVE-2012-1910) | 2012-03-17 | bitcoind & Bitcoin-Qt for Windows | Unknown[[7]](#cite_note-Unknown-7) | Hard | Non-thread safe MingW exceptions | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-1910.html) |
| [BIP 0016](#BIP-0016) | 2012-04-01 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: P2SH | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/BIP-0016.html) |
| [CVE-2012-2459](#CVE-2012-2459) | 2012-05-14 | bitcoind and Bitcoin-Qt | Netsplit[[1]](#cite_note-Netsplit-1) | Easy | Block hash collision (via merkle root) | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-2459.html) |
| **[CVE-2012-3789](/wiki/CVE-2012-3789 "CVE-2012-3789")** | 2012-06-20 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | (Lack of) orphan txn resource limits | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20123789) |
| [CVE-2012-4682](#CVE-2012-4682) |  | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) |  |  | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-4682.html) |
| **[CVE-2012-4683](/wiki/CVE-2012-4683 "CVE-2012-4683")** | 2012-08-23 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | Targeted DoS by CPU exhaustion using alerts | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-4683.html) |
| **[CVE-2012-4684](/wiki/CVE-2012-4684 "CVE-2012-4684")** | 2012-08-24 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | Network-wide DoS using malleable signatures in alerts | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20124684) |
| [CVE-2013-2272](#CVE-2013-2272) | 2013-01-11 | bitcoind and Bitcoin-Qt | Exposure[[6]](#cite_note-Exposure-6) | Easy | Remote discovery of node's wallet addresses | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20132272) |
| [CVE-2013-2273](#CVE-2013-2273) | 2013-01-30 | bitcoind and Bitcoin-Qt | Exposure[[6]](#cite_note-Exposure-6) | Easy | Predictable change output | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20132273) |
| [CVE-2013-2292](#CVE-2013-2292) | 2013-01-30 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Hard | A transaction that takes at least 3 minutes to verify | [0%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20132292) |
| **[CVE-2013-2293](/wiki/CVE-2013-2293 "CVE-2013-2293")** | 2013-02-14 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | Continuous hard disk seek | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20132293) |
| [CVE-2013-3219](#CVE-2013-3219) | 2013-03-11 | bitcoind and Bitcoin-Qt 0.8.0 | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Unenforced block protocol rule | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20133219) |
| [CVE-2013-3220](#CVE-2013-3220) | 2013-03-11 | bitcoind and Bitcoin-Qt | Netsplit[[1]](#cite_note-Netsplit-1) | Hard | Inconsistent BDB lock limit interactions | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20133220) |
| [BIP 0034](#BIP-0034) | 2013-03-25 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Height in coinbase | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/BIP-0034.html) |
| [BIP 0050](#BIP-0050) | 2013-05-15 | All Bitcoin clients | Netsplit[[1]](#cite_note-Netsplit-1) | Implicit[[2]](#cite_note-hardfork-2) | Hard fork to remove txid limit protocol rule | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?50) |
| [CVE-2013-4627](#CVE-2013-4627) | 2013-06-?? | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | Memory exhaustion with excess tx message data | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20134627) |
| [CVE-2013-4165](#CVE-2013-4165) | 2013-07-20 | bitcoind and Bitcoin-Qt | Theft[[10]](#cite_note-theft-local-timing-10) | Local | Timing leak in RPC authentication | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20134165) |
| [CVE-2013-5700](#CVE-2013-5700) | 2013-09-04 | bitcoind and Bitcoin-Qt 0.8.x | DoS[[3]](#cite_note-DoS-3) | Easy | Remote p2p crash via bloom filters | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20135700) |
| [CVE-2014-0160](#CVE-2014-0160) | 2014-04-07 | Anything using OpenSSL for TLS | Unknown[[7]](#cite_note-Unknown-7) | Easy | Remote memory leak via payment protocol | Unknown |
| [CVE-2015-3641](https://bitcoincore.org/en/2024/07/03/disclose_receive_buffer_oom/) | 2014-07-07 | bitcoind and Bitcoin-Qt prior to 0.10.2 | DoS[[3]](#cite_note-DoS-3) | Easy | OOM via p2p | [99.9%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20135700) |
| BIP 66 | 2015-02-13 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Strict DER signatures | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?66) |
| BIP 65 | 2015-11-12 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: OP\_CHECKLOCKTIMEVERIFY | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?65) |
| BIPs 68, 112 & 113 | 2016-04-11 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softforks: Rel locktime, CSV & MTP locktime | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?68) |
| CVE-2015-6031 | 2015-09-15 | MiniUPnPcBitcoin Core/Knots prior to 0.11.2 | Anything | LAN | Buffer overflow |
| BIPs 141, 143 & 147 | 2016-10-27 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Segwit | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?141) |
| [CVE-2016-8889](#CVE-2016-8889) | 2016-10-27 | Bitcoin Knots GUI 0.11.0 - 0.13.0 | Exposure | Hard | Debug console history storing sensitive info | 100% |
| CVE-2017-9230 | ? | Bitcoin | ? | ? | ASICBoost | 0% |
| BIP 148 | 2017-03-12 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Segwit UASF | ? |
| [CVE-2017-12842](#CVE-2017-12842) | 2018-06-09 |  |  |  | No commitment to block merkle tree depth |  |
| [CVE-2016-10724](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-July/016189.html) | 2018-07-02 | bitcoind and Bitcoin-Qt prior to 0.13.0 | DoS[[3]](#cite_note-DoS-3) | Keyholders[[11]](#cite_note-KeyholderEasy-11) | Alert memory exhaustion | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201610724) |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-header-spam/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.15.0 | DoS[[3]](#cite_note-DoS-3) | Easy | OOM via fake block headers |
| [CVE-2016-10725](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-July/016189.html) | 2018-07-02 | bitcoind and Bitcoin-Qt prior to 0.13.0 | DoS[[3]](#cite_note-DoS-3) | Keyholders[[11]](#cite_note-KeyholderEasy-11) | Final alert cancellation | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201610724) |
| [CVE-2018-17144](#CVE-2018-17144) | 2018-09-17 | bitcoind and Bitcoin-Qt prior to 0.16.3 | Inflation[[5]](#cite_note-inflation-5) | Miners[[9]](#cite_note-MinerEasy-9) | Missing check for duplicate inputs | [80%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201817144) |
| [CVE-2018-20587](https://medium.com/%40lukedashjr/cve-2018-20587-advisory-and-full-disclosure-a3105551e78b) | 2019-02-08 | Bitcoin Knots prior to 0.17.1, and all current Bitcoin Core releases | Theft[[10]](#cite_note-theft-local-timing-10) | Local | No alert for RPC service binding failure | [<1%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201820587) |
| [CVE-2017-18350](#CVE-2017-18350) | 2019-06-22 | bitcoind and Bitcoin-Qt prior to 0.15.1 | Unknown | Varies[[12]](#cite_note-12) | Buffer overflow from SOCKS proxy | [94%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201718350) |
| [CVE-2018-20586](#CVE-2018-20586) | 2019-06-22 | bitcoind and Bitcoin-Qt prior to 0.17.1 | Deception | RPC access | Debug log injection via unauthenticated RPC | [77%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201820586) |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-orphan-dos/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.18.0 | DoS | Easy | Orphan transaction CPU tieup |
| [CVE-2019-12998](https://lists.linuxfoundation.org/pipermail/lightning-dev/2019-September/002174.html) | 2019-08-30 | c-lightning prior to 0.7.1 | Theft | Easy | Missing check of channel funding UTXO |
| [CVE-2019-12999](https://lists.linuxfoundation.org/pipermail/lightning-dev/2019-September/002174.html) | 2019-08-30 | lnd prior to 0.7 | Theft | Easy | Missing check of channel funding UTXO amount |
| [CVE-2019-13000](https://lists.linuxfoundation.org/pipermail/lightning-dev/2019-September/002174.html) | 2019-08-30 | eclair prior to 0.3 | Theft | Easy | Missing check of channel funding UTXO |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-inv-buffer-blowup/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.20.0 | DoS | Easy | Network buffer OOM |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-getdata-cpu/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.20.0 | CPU usage | Easy | Infinite loop via p2p |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-bip70-crash/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.20.0 | DoS | Recipient[[13]](#cite_note-Recipient-13) | OOM via malicious BIP72 URI |
| [CVE-2020-14199](#CVE-2020-14199) | 2020-06-03 | Trezor and others | Theft | Social[[14]](#cite_note-14) | Double-signing can enable unintended fees |
| [CVE-2018-17145](https://invdos.net/) | 2020-09-09 | Bitcoin Core prior to 0.16.2Bitcoin Knots prior to 0.16.1Bcoin prior to 1.0.2Btcd prior to 0.21.0 | DoS[[3]](#cite_note-DoS-3) | Easy | p2p memory blow-up | [87%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201817145) |
| [CVE-2020-26895](#CVE-2020-26895) | 2020-10-08 | lnd prior to 0.10 | Theft | Easy | Missing low-S normalization for HTLC signatures |
| [CVE-2020-26896](#CVE-2020-26896) | 2020-10-08 | lnd prior to 0.11 | Theft | Varies[[15]](#cite_note-15) | Invoice preimage extraction via forwarded HTLC |
| [CVE-2020-14198](https://bitcoincore.org/en/2024/07/03/disclose-unbounded-banlist/) |  | Bitcoin Core 0.20.1 | DoS[[3]](#cite_note-DoS-3) | Easy | Remote DoS | [93%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?202014198) |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-timestamp-overflow/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.20.2 | Netsplit[[1]](#cite_note-Netsplit-1) | Varies | Adjusted time manipulation |
| [CVE-2021-3401](#CVE-2021-3401) | 2021-02-01 | Bitcoin Core GUI prior to 0.19.0Bitcoin Knots GUI prior to 0.18.1 | Theft | Hard | Qt5 remote execution | [64%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20213401) |
| [TBD](https://bitcoincore.org/en/2024/07/31/disclose-upnp-oom/) | 2024-07-31 | Bitcoin Core/Knots prior to 22.0 with UPnP enabled | DoS | Local | OOM via LAN spam |
| [TBD](https://bitcoincore.org/en/2024/07/31/disclose-addrman-int-overflow/) | 2024-07-31 | Bitcoin Core/Knots prior to 22.0 | DoS | Easy | OOM via p2p spam |
| [CVE-2021-31876](#CVE-2021-31876) | 2021-05-06 | Various wallets |  |  |  |
| CVE-2021-41591 | 2021-10-04 | Lightning software |  |  |  |
| CVE-2021-41592 | 2021-10-04 | Lightning software |  |  |  |
| CVE-2021-41593 | 2021-10-04 | Lightning software |  |  |  |
| BIPs 341-343 | 2021-11-13 | All Bitcoin nodes | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Taproot | [57%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?343) |
| [CVE-2022-31246](https://github.com/spesmilo/electrum/security/advisories/GHSA-4fh4-hx35-r355) | 2022-06-07 | Electrum 2.1 until before 4.2.2 | Theft | Social |  |
| [CVE-2023-50428](#CVE-2023-50428) | 2023 | All Bitcoin nodes | DoS[[3]](#cite_note-DoS-3) | Easy | Bypass of datacarriersize limit using OP\_FALSE,OP\_IF |  |
| [CVE-2024-34149](#CVE-2024-34149) | 2024-03-30 | Bitcoin Core 0.21.1 and newer (not fixed)Bitcoin Knots 0.21.1 - 0.23.0 | DoS[[3]](#cite_note-DoS-3) | Easy | Script size limit not enforced for Tapscript |  |

1. ↑ [1.0](#cite_ref-Netsplit_1-0) [1.1](#cite_ref-Netsplit_1-1) [1.2](#cite_ref-Netsplit_1-2) [1.3](#cite_ref-Netsplit_1-3) [1.4](#cite_ref-Netsplit_1-4) [1.5](#cite_ref-Netsplit_1-5) Attacker can create multiple views of the network, enabling [double-spending](/wiki/Double-spending "Double-spending") with over 1 confirmation
2. ↑ [2.0](#cite_ref-hardfork_2-0) [2.1](#cite_ref-hardfork_2-1) This is a protocol "hard-fork" that old clients will reject as invalid and must therefore not be used.
3. ↑ [3.00](#cite_ref-DoS_3-0) [3.01](#cite_ref-DoS_3-1) [3.02](#cite_ref-DoS_3-2) [3.03](#cite_ref-DoS_3-3) [3.04](#cite_ref-DoS_3-4) [3.05](#cite_ref-DoS_3-5) [3.06](#cite_ref-DoS_3-6) [3.07](#cite_ref-DoS_3-7) [3.08](#cite_ref-DoS_3-8) [3.09](#cite_ref-DoS_3-9) [3.10](#cite_ref-DoS_3-10) [3.11](#cite_ref-DoS_3-11) [3.12](#cite_ref-DoS_3-12) [3.13](#cite_ref-DoS_3-13) [3.14](#cite_ref-DoS_3-14) [3.15](#cite_ref-DoS_3-15) [3.16](#cite_ref-DoS_3-16) [3.17](#cite_ref-DoS_3-17) [3.18](#cite_ref-DoS_3-18) Attacker can disable some functionality, for example by crashing clients
4. [↑](#cite_ref-Theft_4-0) Attacker can take coins outside known network rules
5. ↑ [5.0](#cite_ref-inflation_5-0) [5.1](#cite_ref-inflation_5-1) Attacker can create coins outside known network rules
6. ↑ [6.0](#cite_ref-Exposure_6-0) [6.1](#cite_ref-Exposure_6-1) [6.2](#cite_ref-Exposure_6-2) Attacker can access user data outside known acceptable methods
7. ↑ [7.0](#cite_ref-Unknown_7-0) [7.1](#cite_ref-Unknown_7-1) Extent of possible abuse is unknown
8. ↑ [8.0](#cite_ref-FakeConf_8-0) [8.1](#cite_ref-FakeConf_8-1) [8.2](#cite_ref-FakeConf_8-2) [8.3](#cite_ref-FakeConf_8-3) [8.4](#cite_ref-FakeConf_8-4) [8.5](#cite_ref-FakeConf_8-5) [8.6](#cite_ref-FakeConf_8-6) [8.7](#cite_ref-FakeConf_8-7) [8.8](#cite_ref-FakeConf_8-8) Attacker can double-spend with 1 confirmation
9. ↑ [9.00](#cite_ref-MinerEasy_9-0) [9.01](#cite_ref-MinerEasy_9-1) [9.02](#cite_ref-MinerEasy_9-2) [9.03](#cite_ref-MinerEasy_9-3) [9.04](#cite_ref-MinerEasy_9-4) [9.05](#cite_ref-MinerEasy_9-5) [9.06](#cite_ref-MinerEasy_9-6) [9.07](#cite_ref-MinerEasy_9-7) [9.08](#cite_ref-MinerEasy_9-8) [9.09](#cite_ref-MinerEasy_9-9) Attacking requires mining block(s)
10. ↑ [10.0](#cite_ref-theft-local-timing_10-0) [10.1](#cite_ref-theft-local-timing_10-1) Local attacker could potentially determine the RPC passphrase via a timing sidechannel.
11. ↑ [11.0](#cite_ref-KeyholderEasy_11-0) [11.1](#cite_ref-KeyholderEasy_11-1) Attacking requires signing with the publicly-disclosed alert key
12. [↑](#cite_ref-12) Depends on software configuration
13. [↑](#cite_ref-Recipient_13-0) Can only be exploited by the recipient the victim intends to pay
14. [↑](#cite_ref-14) User must be tricked into cooperating (social engineering)
15. [↑](#cite_ref-15) Depends on node configuration, only affects routable merchants, requires external knowledge of receiver's invoices and/or luck to identify receiver, only works against single-shot HTLCs (legacy or MPP)

## CVE-2010-5137

```
Date: 2010-07-28
Summary: OP_LSHIFT crash
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.4 | 0.3.5 |

On July 28 2010, two bugs were discovered and demonstrated on the test network. One caused bitcoin to crash on some machines when processing a transaction containing an OP\_LSHIFT. This was never exploited on the main network, and was fixed by Bitcoin version 0.3.5.

After these bugs were discovered, many currently-unused script words were disabled for safety.

### References

* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5137)

## CVE-2010-5141

```
Date: 2010-07-28
Summary: ?
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.4 | 0.3.5 |

On July 28 2010, two bugs were discovered and demonstrated on the test network. One exploited a bug in the transaction handling code and allowed an attacker to spend coins that they did not own. This was never exploited on the main network, and was fixed by Bitcoin version 0.3.5.

After these bugs were discovered, many currently-unused script words were disabled for safety.

### References

* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5141)

## CVE-2010-5138

```
Date: 2010-07-29
Summary: Unlimited SigOp DoS
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.? | 0.3.? |

On July 29 2010, it was discovered that block [71036](http://blockexplorer.com/block/00000000000997f9fd2fe1ee376293ef8c42ad09193a5d2086dddf8e5c426b56) contained several transactions with a ton of OP\_CHECKSIG commands. There should only ever be one such command. This caused every node to do extra unnecessary work, and it could have been used as a denial-of-service attack. A new version of Bitcoin was quickly released. The new version did not cause a fork on the main network, though it did cause one on the test network (where someone had played around with the attack more).

### References

* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5138)

## CVE-2010-5139

*Main article: [CVE-2010-5139](/wiki/CVE-2010-5139 "CVE-2010-5139")*
```
Date: 2010-08-15
Summary: Combined output overflow
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.10 | 0.3.11 |

On August 15 2010, it was [discovered](http://bitcointalk.org/index.php?topic=822.0) that block 74638 contained a transaction that created over 184 billion bitcoins for two different addresses. This was possible because the code used for checking transactions before including them in a block didn't account for the case of outputs so large that they overflowed when summed. A new version was published within a few hours of the discovery. The block chain had to be forked. Although many unpatched nodes continued to build on the "bad" block chain, the "good" block chain overtook it at a block height of 74691. The bad transaction no longer exists for people using the longest chain.

The block and transaction:

```
CBlock(hash=0000000000790ab3, ver=1, hashPrevBlock=0000000000606865, hashMerkleRoot=618eba,
nTime=1281891957, nBits=1c00800e, nNonce=28192719, vtx=2)
  CTransaction(hash=012cd8, ver=1, vin.size=1, vout.size=1, nLockTime=0)
    CTxIn(COutPoint(000000, -1), coinbase 040e80001c028f00)
    CTxOut(nValue=50.51000000, scriptPubKey=0x4F4BA55D1580F8C3A8A2C7)
  CTransaction(hash=1d5e51, ver=1, vin.size=1, vout.size=2, nLockTime=0)
    CTxIn(COutPoint(237fe8, 0), scriptSig=0xA87C02384E1F184B79C6AC)
    CTxOut(nValue=92233720368.54275808, scriptPubKey=OP_DUP OP_HASH160 0xB7A7)
    CTxOut(nValue=92233720368.54275808, scriptPubKey=OP_DUP OP_HASH160 0x1512)
  vMerkleTree: 012cd8 1d5e51 618eba

Block hash: 0000000000790ab3f22ec756ad43b6ab569abf0bddeb97c67a6f7b1470a7ec1c
Transaction hash: 1d5e512a9723cbef373b970eb52f1e9598ad67e7408077a82fdac194b65333c9
```
### References

* [Discovery](https://bitcointalk.org/index.php?topic=822.0)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5139)

## CVE-2010-5140

```
Date: 2010-09-29
Summary: Never confirming transactions
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.12 | 0.3.13 |

Around September 29, 2010, people started [reporting](https://bitcointalk.org/index.php?topic=1306.0) that their sent transactions would not confirm. This happened because people modified Bitcoin to send sub-0.01 transactions without any fees. A 0.01 fee was at that time required by the network for such transactions (essentially prohibiting them), so the transactions remained at 0 confirmations forever. This became a more serious issue because Bitcoin would send transactions using bitcoins gotten from transactions with 0 confirmations, and these resulting transactions would also never confirm. Because Bitcoin tends to prefer sending smaller coins, these invalid transactions quickly multiplied, contaminating the wallets of everyone who received them.

Bitcoin was changed to only select coins with at least 1 confirmation. The remaining sub-0.01 transactions were cleared by generators who modified their version of Bitcoin to not require the micropayment fee. It took a while for everything to get cleared, though, because many of the intermediate transactions had been forgotten by the network by this point and had to be rebroadcast by the original senders.

### References

* [Initial reports](https://bitcointalk.org/index.php?topic=1306.0)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5140)

## CVE-2011-4447

```
Date: 2011-11-11
Summary: Wallet non-encryption
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | 0.4.0 - 0.4.1rc6 | 0.4.10.5.0 |

### References

* [Announcement](https://bitcointalk.org/index.php?topic=51604.0)
* [Finding](https://bitcointalk.org/index.php?topic=51474.0)
* [0.5.0](http://bitcoin.org/releases/2011/11/21/v0.5.0.html)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2011-4447)

## CVE-2012-1909

```
Date: 2012-03-07
Summary: Transaction overwriting
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin protocol | Before March 15th, 2012 | BIP 30 |
| Bitcoin-Qtbitcoind | \* - 0.4.4rc20.5.0rc1 - 0.5.0.4rc20.5.1rc1 - 0.5.3rc20.6.0rc1 - 0.6.0rc2 | 0.4.40.5.0.40.5.30.6.0rc3 |
| wxBitcoin | ALL | NONE |

### References

* [Announcement](https://bitcointalk.org/index.php?topic=67738.0)
* [Fix](https://en.bitcoin.it/wiki/BIP_0030)
* [Gentoo bug tracker](https://bugs.gentoo.org/show_bug.cgi?id=407793)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-1909)

## CVE-2012-1910

```
Date: 2012-03-17
Summary: Non-thread safe MingW exceptions
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoind for WindowsBitcoin-Qt for Windows | 0.5.0rc1 - 0.5.0.40.5.1rc1 - 0.5.3.00.6.0rc1 - 0.6.0rc3 | 0.5.0.50.5.3.10.5.40.6.0rc4 |

### References

* [Announcement](https://bitcointalk.org/index.php?topic=69120.0)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-1910)
* [Full disclosure](http://gavintech.blogspot.com/2012/03/full-disclosure-bitcoin-qt-on-windows.html)

## BIP-0016

```
Date: 2012-04-01
Summary: Mandatory P2SH protocol update
Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.40.5.0rc1 - 0.5.0.50.5.1rc1 - 0.5.30.6.0rc1 | 0.4.50.5.0.60.5.4rc10.6.0rc2 |
| wxBitcoin | ALL | NONE |

### References

* [BIP 0016](/wiki/BIP_0016 "BIP 0016")

## CVE-2012-2459

```
Date: 2012-05-14
Summary: Block hash collision (via merkle tree)
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.6rc10.5.0rc1 - 0.5.5rc10.6.0rc1 - 0.6.0.7rc10.6.1rc1 - 0.6.1rc1 | 0.4.60.5.50.6.0.70.6.1rc2 |

Block hash collisions can easily be made by duplicating transactions in the merkle tree.
Such a collision is invalid, but if recorded (as Bitcoin-Qt and bitcoind prior to 0.6.1 did) would prevent acceptance of the legitimate block with the same hash.
This could be used to fork the blockchain, including deep double-spend attacks.

### References

* [Announcement](https://bitcointalk.org/?topic=81749)
* [Gentoo bug tracker](https://bugs.gentoo.org/show_bug.cgi?id=415973)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-2459)
* [Full Disclosure](https://bitcointalk.org/?topic=102395)

## CVE-2012-3789

*Main article: [CVE-2012-3789](/wiki/CVE-2012-3789 "CVE-2012-3789")*
```
Date: 2012-06-20
Summary: (Lack of) orphan txn resource limits
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.7rc20.5.0rc1 - 0.5.6rc20.6.0rc1 - 0.6.0.8rc20.6.1rc1 - 0.6.2.2 | 0.4.7rc30.5.6rc30.6.0.9rc10.6.3rc1 |

### References

* [CVE-2012-3789](/wiki/CVE-2012-3789 "CVE-2012-3789")
* [0.6.3rc1 Announcement](https://bitcointalk.org/?topic=88734)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-3789)

## CVE-2012-4682

```
Date:
Summary:
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.7rc20.5.0rc1 - 0.5.6rc20.6.0rc1 - 0.6.0.8rc20.6.1rc1 - 0.6.2.2 | 0.4.7rc30.5.6rc30.6.0.9rc10.6.3rc1 |

### References

* [CVE-2012-4682](/w/index.php?title=CVE-2012-4682&action=edit&redlink=1 "CVE-2012-4682 (page does not exist)")
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=435216)

## CVE-2012-4683

*Main article: [CVE-2012-4683](/wiki/CVE-2012-4683 "CVE-2012-4683")*
```
Date: 2012-08-23
Summary: Targeted DoS by CPU exhaustion using alerts
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.7rc20.5.0rc1 - 0.5.6rc20.6.0rc1 - 0.6.0.8rc20.6.1rc1 - 0.6.2.2 | 0.7.0 |

### References

* [CVE-2012-4683](/wiki/CVE-2012-4683 "CVE-2012-4683")
* [Announcement](https://bitcointalk.org/index.php?topic=148038.0)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=435216)

## CVE-2012-4684

*Main article: [CVE-2012-4684](/wiki/CVE-2012-4684 "CVE-2012-4684")*
```
Date: 2012-08-24
Summary: Network-wide DoS using malleable signatures in alerts
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.7rc20.5.0rc1 - 0.5.6rc20.6.0rc1 - 0.6.0.8rc20.6.1rc1 - 0.6.2.2 - 0.6.3rc1 | 0.7.0 |

### References

* [CVE-2012-4684](/wiki/CVE-2012-4684 "CVE-2012-4684")
* [Announcement](https://bitcointalk.org/index.php?topic=148109.0)

## CVE-2013-2272

```
Date: 2013-01-11
Summary: Remote discovery of node's wallet addresses
Fix Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.8rc40.5.0rc1 - 0.5.70.6.0rc1 - 0.6.0.10rc40.6.1rc1 - 0.6.4rc40.7.0rc1 - 0.7.2 | 0.4.9rc10.5.8rc10.6.0.11rc10.6.5rc10.7.3rc1 |

### References

* [Announcement](https://bitcointalk.org/?topic=135856)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=462046)

## CVE-2013-2273

```
Date: 2013-01-30
Summary: Predictable change output
Fix Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.8rc40.5.0rc1 - 0.5.70.6.0rc1 - 0.6.0.10rc40.6.1rc1 - 0.6.4rc40.7.0rc1 - 0.7.2 | 0.4.9rc10.5.8rc10.6.0.11rc10.6.5rc10.7.3rc1 |

### References

* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=462046)

## CVE-2013-2292

```
Date: 2013-01-30
Summary: A transaction that takes at least 3 minutes to verify
Fix Deployment: 0%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | All versions | No fix yet |

### References

* [CVE-2013-2292](/w/index.php?title=CVE-2013-2292&action=edit&redlink=1 "CVE-2013-2292 (page does not exist)")
* [Announcement](https://bitcointalk.org/?topic=140078)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=462046)

## CVE-2013-2293

*Main article: [CVE-2013-2293](/wiki/CVE-2013-2293 "CVE-2013-2293")*
```
Date: 2013-02-14
Summary: Continuous hard disk seek
Fix Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.7.3rc1 | No fix yet (0.8.0 unaffected) |

### References

* [CVE-2013-2293](/wiki/CVE-2013-2293 "CVE-2013-2293")
* [Announcement](https://bitcointalk.org/?topic=144122)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=462046)

## CVE-2013-3219

```
Date: 2013-03-11
Summary: Unenforced block protocol rule
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.8.0rc1 - 0.8.0 | 0.8.1 |

### References

* [BIP 50](/wiki/BIP_0050 "BIP 0050")

## CVE-2013-3220

```
Date: 2013-03-11
Summary: Inconsistent BDB lock limit interactions
Fix Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.9rc10.5.0rc1 - 0.5.8rc10.6.0rc1 - 0.6.5rc10.7.0rc1 - 0.7.3rc1 | 0.4.9rc20.5.8rc20.6.5rc20.7.3rc2 |
| wxBitcoin | ALL | NONE |

### References

* [BIP 50](/wiki/BIP_0050 "BIP 0050")

## BIP-0034

```
Date: 2013-03-25
Summary: Mandatory block protocol update
Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.70.5.0rc1 - 0.5.70.6.0rc1 - 0.6.0.90.6.1rc1 - 0.6.3 | 0.4.8rc10.5.7rc10.6.0.10rc10.6.4rc1 |
| wxBitcoin | ALL | NONE |

### References

* [BIP 0034](/wiki/BIP_0034 "BIP 0034")

## BIP-0050

```
Date: 2013-05-15
Summary: Hard fork to remove txid limit protocol rule
Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.9rc10.5.0rc1 - 0.5.8rc10.6.0rc1 - 0.6.5rc10.7.0rc1 - 0.7.3rc1 | 0.4.9rc20.5.8rc20.6.5rc20.7.3rc2 |
| wxBitcoin | ALL | NONE |

### References

* [BIP 0050](/wiki/BIP_0050 "BIP 0050")

## CVE-2013-4627

```
Date: 2013-06-??
Summary: Memory exhaustion with excess tx message data
Fix Deployment: 99.9%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.9rc30.5.0rc1 - 0.5.8rc30.6.0rc1 - 0.6.5rc30.7.0rc1 - 0.7.3rc30.8.0rc1 - 0.8.3 | 0.4.9rc40.5.8rc40.6.5rc40.7.3rc40.8.4 |
| wxBitcoin | ALL | NONE |

### References

## CVE-2013-4165

```
Date: 2013-07-20
Summary: Timing leak in RPC authentication
Fix Deployment: 99.9%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.9rc30.5.0rc1 - 0.5.8rc30.6.0rc1 - 0.6.5rc30.7.0rc1 - 0.7.3rc30.8.0rc1 - 0.8.3 | 0.4.9rc40.5.8rc40.6.5rc40.7.3rc40.8.4rc1 |
| wxBitcoin | ALL | NONE |

### References

* [Bitcoin-Qt 0.8.4 release notes](https://bitcointalk.org/index.php?topic=287351)
* [The initial bug report](https://github.com/bitcoin/bitcoin/issues/2838)

## CVE-2013-5700

```
Date: 2013-09-04
Summary: Remote p2p crash via bloom filters
Fix Deployment: 99.9%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.8.0rc1 - 0.8.3 | 0.8.4rc1 |

### References

* [Bitcoin-Qt 0.8.4 release notes](https://bitcointalk.org/index.php?topic=287351)
* [The fix](https://github.com/bitcoin/bitcoin/commit/37c6389c5a0ca63ae3573440ecdfe95d28ad8f07)
* [An added test](https://github.com/bitcoin/bitcoin/pull/18515)

## CVE-2016-8889

```
Date: 2016-10-27
Summary: Debug console history storing sensitive info
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin Knots GUI | 0.11.0 - 0.13.0 | 0.13.1 |

### References

* [Bitcoin Knots 0.16.1.knots20161027 release notes](https://github.com/bitcoinknots/bitcoin/blob/v0.13.1.knots20161027/doc/release-notes.md)
* [US-CERT/NIST](https://nvd.nist.gov/vuln/detail/CVE-2016-8889)

## CVE-2017-12842

```
Date: 2018-06-09
Summary: No commitment to block merkle tree depth

```
### References

* [Explanation by Sergio Demian Lerner](https://bitslog.wordpress.com/2018/06/09/leaf-node-weakness-in-bitcoin-merkle-tree-design/)
* [Further elaboration by Suhas Daftuar](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2019-February/016697.html)

## CVE-2017-18350

```
Date: 2019-06-22
Summary: Buffer overflow from SOCKS proxy

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.7.0rc1 - 0.15.0 | 0.15.1rc1 |

### References

* [Disclosure of details](https://medium.com/%40lukedashjr/cve-2017-18350-disclosure-fe6d695f45d5)

## CVE-2018-17144

```
Date: 2018-09-17
Summary: Missing check for duplicate inputs
Fix Deployment: 31%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.14.0rc1 - 0.14.20.15.0rc1 - 0.15.10.16.0rc1 - 0.16.2 | 0.14.30.15.20.16.3 |

### References

* [Full disclosure by Bitcoin Core](https://bitcoincore.org/en/2018/09/20/notice/)
* [Bitcoin Core 0.16.3 release notes](https://bitcoincore.org/en/2018/09/18/release-0.16.3/)
* [Bitcoin Knots 0.16.3.knots20180918 release notes](https://github.com/bitcoinknots/bitcoin/blob/v0.16.3.knots20180918/doc/release-notes.md)
* [US-CERT/NIST](https://nvd.nist.gov/vuln/detail/CVE-2018-17144)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=666669)

## CVE-2018-20586

```
Date: 2019-06-22
Summary: Debug log injection via unauthenticated RPC

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.12.0rc1 - 0.17.0 | 0.17.1rc1 |

## CVE-2020-14199

```
Date: 2020-06-03
Summary: Double-signing can enable unintended fees

```

| Affected | | Fix |
| --- | --- | --- |
| Trezor One |  | 1.9.1 |
| Trezor Model T |  | 2.3.1 |
| ??? |

### References

* [Disclosure of details by Trezor team](https://blog.trezor.io/details-of-firmware-updates-for-trezor-one-version-1-9-1-and-trezor-model-t-version-2-3-1-1eba8f60f2dd)

## CVE-2020-26895

```
Date: 2020-10-08
Summary: Missing low-S normalization for HTLC signatures.

```

| Affected | | Fix |
| --- | --- | --- |
| lnd |  | 0.10.0 |

### References

* [CVE-2020-26895: LND Low-S Tx-Relay Standardness](https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002858.html)
* [Full Disclosure: Full Disclosure: CVE-2020-26895 LND "Hodl my Shitsig"](https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002856.html)

## CVE-2020-26896

```
Date: 2020-10-08
Summary: Invoice preimage extraction via forwarded HTLC.

```

| Affected | | Fix |
| --- | --- | --- |
| lnd |  | 0.11.0 |

### References

* [CVE-2020-26896: LND Invoice Preimage Extraction](https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002857.html)
* [Full Disclosure: CVE-2020-26896 LND "The (un)covert channel"](https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002855.html)

## CVE-2021-3401

```
Date: 2021-02-01
Summary: Qt5 remote execution

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin Core GUI |  | 0.19.0 |
| Bitcoin Knots GUI |  | 0.18.1 |

## CVE-2021-31876

```
Date: 2021-05-06

```
### References

* [Full Disclosure: CVE-2021-31876 Defect in Bitcoin Core's bip125 logic](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-May/018893.html)

### References

* [URI Argument Injection Vulnerability in Bitcoin Core 0.18 and Earlier](https://achow101.com/2021/02/0.18-uri-vuln)

## CVE-2023-50428

```
Date: 2023
Summary: Bypass of datacarriersize limit using OP_FALSE,OP_IF

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin Core | 0.9 and later | NOT FIXED |
| Bitcoin Knots | 0.9 - 23.0 | 25.1.knots20231115 |
| btcd | ? | NOT FIXED |
| libbitcoin | ? | NOT FIXED |

## CVE-2024-34149

```
Date: 2024-03-30
Summary: Script size limit not enforced for Tapscript

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin Core | 0.21.1 and later | NOT FIXED |
| Bitcoin Knots | 0.21.1 - 23.0 | 25.1.knots20231115 |
| btcd | ? | ? |
| libbitcoin | ? | ? |

## Definitions

A critical vulnerability is one that will have disastrous consequences if it is exploited. A serious vulnerability is one that will have serious consequences if it is exploited[[1]](#cite_note-16).

## See Also

* [Changelog](/wiki/Changelog "Changelog")
* <https://blog.bitmex.com/bitcoins-consensus-forks/>

## References

1. [↑](#cite_ref-16) <http://bitcointalk.org/index.php?topic=88892.0>

| | [Bitcoin Core](/wiki/Bitcoin_Core "Bitcoin Core") documentation | | | --- | --- | |  | | User documentation | [Alert system](/wiki/Alert_system "Alert system") • [Bitcoin Core compatible devices](/wiki/Bitcoin_Core_compatible_devices "Bitcoin Core compatible devices") • [Data directory](/wiki/Data_directory "Data directory") • [Fallback Nodes](/wiki/Fallback_Nodes "Fallback Nodes") • [How to import private keys in Bitcoin Core 0.7+](/wiki/Help%3AHow_to_import_private_keys_in_Bitcoin_Core_0.7%2B "Help:How to import private keys in Bitcoin Core 0.7+") • [Installing Bitcoin Core](/wiki/Help%3AInstalling_Bitcoin_Core "Help:Installing Bitcoin Core") • [Running Bitcoin](/wiki/Running_Bitcoin "Running Bitcoin") • [Transaction fees](/wiki/Transaction_fees "Transaction fees") • [Vocabulary](/wiki/Vocabulary "Vocabulary") | |  | | Developer documentation | [Accounts explained](/wiki/Help%3AAccounts_explained "Help:Accounts explained") • [API calls list](/wiki/Original_Bitcoin_client/API_calls_list "Original Bitcoin client/API calls list") • [API reference (JSON-RPC)](/wiki/API_reference_%28JSON-RPC%29 "API reference (JSON-RPC)") • [Block chain download](/wiki/Block_chain_download "Block chain download") • [Dump format](/wiki/Dump_format "Dump format") • [getblocktemplate](/wiki/Getblocktemplate "Getblocktemplate") • [List of address prefixes](/wiki/List_of_address_prefixes "List of address prefixes") • [Protocol documentation](/wiki/Protocol_documentation "Protocol documentation") • [Script](/wiki/Script "Script") • [Technical background of version 1 Bitcoin addresses](/wiki/Technical_background_of_version_1_Bitcoin_addresses "Technical background of version 1 Bitcoin addresses") • [Testnet](/wiki/Testnet "Testnet") • [Transaction Malleability](/wiki/Transaction_Malleability "Transaction Malleability") • [Wallet import format](/wiki/Wallet_import_format "Wallet import format") | |  | | History & theory | Common Vulnerabilities and Exposures • [DOS/STONED incident](/wiki/DOS/STONED_incident "DOS/STONED incident") • [Economic majority](/wiki/Economic_majority "Economic majority") • [Full node](/wiki/Full_node "Full node") • [Original Bitcoin client](/wiki/Original_Bitcoin_client "Original Bitcoin client") • [Value overflow incident](/wiki/Value_overflow_incident "Value overflow incident") | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

Retrieved from "<https://en.bitcoin.it/w/index.php?title=Common_Vulnerabilities_and_Exposures&oldid=70310>"
[Categories](/wiki/Special%3ACategories "Special:Categories"):

* [Security](/wiki/Category%3ASecurity "Category:Security")
* [Bitcoin Core documentation](/wiki/Category%3ABitcoin_Core_documentation "Category:Bitcoin Core documentation")

## Navigation menu

### Personal tools

* [Create account](/w/index.php?title=Special:CreateAccount&returnto=Common+Vulnerabilities+and+Exposures "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/w/index.php?title=Special:UserLogin&returnto=Common+Vulnerabilities+and+Exposures "You are encouraged to log in; however, it is not mandatory [o]")

### Namespaces

* [Page](/wiki/Common_Vulnerabilities_and_Exposures "View the content page [c]")
* [Discussion](/wiki/Talk%3ACommon_Vulnerabilities_and_Exposures "Discussion about the content page [t]")

English

### Views

* [Read](/wiki/Common_Vulnerabilities_and_Exposures)
* [View source](/w/index.php?title=Common_Vulnerabilities_and_Exposures&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/w/index.php?title=Common_Vulnerabilities_and_Exposures&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/wiki/Main_Page "Visit the main page [z]")
* [Bitcoin FAQ](/wiki/Help%3AFAQ)
* [Editing help](/wiki/Bitcoin_Wiki%3AHelp)
* [Forums](/wiki/Forums)
* [Chatrooms](/wiki/IRC_channels)
* [Recent changes](/wiki/Special%3ARecentChanges)
* [Page index](/wiki/Special%3AAllPages)

### Tools

* [What links here](/wiki/Special%3AWhatLinksHere/Common_Vulnerabilities_and_Exposures "A list of all wiki pages that link here [j]")
* [Related changes](/wiki/Special%3ARecentChangesLinked/Common_Vulnerabilities_and_Exposures "Recent changes in pages linked from this page [k]")
* [Special pages](/wiki/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/w/index.php?title=Common_Vulnerabilities_and_Exposures&oldid=70310 "Permanent link to this revision of this page")
* [Page information](/w/index.php?title=Common_Vulnerabilities_and_Exposures&action=info "More information about this page")

### Sister projects

* [Essays](/wiki/Bitcoin_Wiki%3AEssay_main_page)
* [Source](/wiki/Bitcoin_Wiki%3ASource_main_page)

* This page was last edited on 31 July 2024, at 17:40.
* Content is available under [Creative Commons Attribution 3.0](http://creativecommons.org/licenses/by/3.0/) unless otherwise noted.

* [Privacy policy](/wiki/Bitcoin_Wiki%3APrivacy_policy)
* [About Bitcoin Wiki](/wiki/Bitcoin_Wiki%3AAbout)
* [Disclaimers](/wiki/Bitcoin_Wiki%3AGeneral_disclaimer)

* [![Powered by MediaWiki](/w/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugs.gentoo.org_66f4e455_20250126_101359.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 462046
<net-p2p/bitcoind-0.8.0rc1, net-p2p/bitcoin-qt-0.8.0rc1: multiple vulnerabilities (CVE-2013-{2272,2273,2292,2293})
Last modified: 2016-03-18 07:37:59 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=462046&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=462046&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 462046**](show_bug.cgi?id=462046)
(CVE-2013-2273)
- <net-p2p/bitcoind-0.8.0rc1, net-p2p/bitcoin-qt-0.8.0rc1: multiple vulnerabilities (CVE-2013-{2272,2273,2292,2293})

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
<net-p2p/bitcoind-0.8.0rc1, net-p2p/bitcoin-qt-0.8.0rc1: multiple vulnerabili...

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2013-2273 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal minor | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B3 [noglsa] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [462598](show_bug.cgi?id=462598 "RESOLVED FIXED - net-p2p/bitcoind-0.8.1 version bump") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | Show dependency [tree](showdependencytree.cgi?id=462046&hide_resolved=1) | |  | | Reported: | 2013-03-17 14:13 UTC by Agostino Sarubbo | | --- | --- | | Modified: | 2016-03-18 07:37 UTC ([History](show_activity.cgi?id=462046)) | | CC List: | 7 users (show)  alexander blueness flow jaak luke-jr+gentoobugs proxy-maint ted | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=462046&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=462046&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Agostino Sarubbo   gentoo-dev  2013-03-17 14:13:10 UTC  ``` CVE-2013-2273 <http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-2273> :  bitcoind and Bitcoin-Qt before 0.4.9rc1, 0.5.x before 0.5.8rc1, 0.6.0 before 0.6.0.11rc1, 0.6.1 through 0.6.5 before 0.6.5rc1, and 0.7.x before 0.7.3rc1 make it easier for remote attackers to obtain potentially sensitive information about returned change by leveraging certain predictability in the outputs of a Bitcoin transaction.   CVE-2013-2292 <http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-2292> :  bitcoind and Bitcoin-Qt 0.8.0 and earlier allow remote attackers to cause a denial of service (electricity consumption) by mining a block to create a nonstandard Bitcoin transaction containing multiple OP_CHECKSIG script opcodes.   CVE-2013-2293 <http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-2293> :  The CTransaction::FetchInputs method in bitcoind and Bitcoin-Qt before 0.8.0rc1 copies transactions from disk to memory without incrementally checking for spent prevouts, which allows remote attackers to cause a denial of service (disk I/O consumption) via a Bitcoin transaction with many inputs corresponding to many different parts of the stored block chain. ```  [Comment 1](#c1)  Luke-Jr    2013-03-17 15:39:37 UTC  ``` CVE-2013-2292 should get another bug, as it is still unresolved. ```  [Comment 2](#c2)  GLSAMaker/CVETool Bot   gentoo-dev  2013-03-19 20:26:55 UTC  ``` CVE-2013-2293 (<http://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-2293>):   The CTransaction::FetchInputs method in bitcoind and Bitcoin-Qt before   0.8.0rc1 copies transactions from disk to memory without incrementally   checking for spent prevouts, which allows remote attackers to cause a denial   of service (disk I/O consumption) via a Bitcoin transaction with many inputs   corresponding to many different parts of the stored block chain.  CVE-2013-2292 (<http://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-2292>):   bitcoind and Bitcoin-Qt 0.8.0 and earlier allow remote attackers to cause a   denial of service (electricity consumption) by mining a block to create a   nonstandard Bitcoin transaction containing multiple OP_CHECKSIG script   opcodes.  CVE-2013-2273 (<http://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-2273>):   bitcoind and Bitcoin-Qt before 0.4.9rc1, 0.5.x before 0.5.8rc1, 0.6.0 before   0.6.0.11rc1, 0.6.1 through 0.6.5 before 0.6.5rc1, and 0.7.x before 0.7.3rc1   make it easier for remote attackers to obtain potentially sensitive   information about returned change by leveraging certain predictability in   the outputs of a Bitcoin transaction.  CVE-2013-2272 (<http://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-2272>):   The penny-flooding protection mechanism in the CTxMemPool::accept method in   bitcoind and Bitcoin-Qt before 0.4.9rc1, 0.5.x before 0.5.8rc1, 0.6.0 before   0.6.0.11rc1, 0.6.1 through 0.6.5 before 0.6.5rc1, and 0.7.x before 0.7.3rc1   allows remote attackers to determine associations between wallet addresses   and IP addresses via a series of large Bitcoin transactions with   insufficient fees. ```  [Comment 3](#c3)  Anthony Basile   gentoo-dev  2013-03-19 21:46:19 UTC  ``` Luke can you identify which ones we should keep on the tree and which ones we should drop? ```  [Comment 4](#c4)  Anthony Basile   gentoo-dev  2013-03-27 23:57:59 UTC  ``` net-p2p/bitcoind, net-p2p/bitcoin-qt 0.8.1 are now in the tree. ```  [Comment 5](#c5)  Luke-Jr    2013-03-28 00:44:16 UTC  ``` (In reply to [comment #4](show_bug.cgi?id=462046#c4)) > net-p2p/bitcoind, net-p2p/bitcoin-qt 0.8.1 are now in the tree.  Note that 0.8.1 did not fix any of the vulnerabilities in this bug... ```  [Comment 6](#c6)  Anthony Basile   gentoo-dev  2013-03-28 00:46:03 UTC  ``` (In reply to [comment #5](show_bug.cgi?id=462046#c5)) > (In reply to [comment #4](show_bug.cgi?id=462046#c4)) > > net-p2p/bitcoind, net-p2p/bitcoin-qt 0.8.1 are now in the tree. >  > Note that 0.8.1 did not fix any of the vulnerabilities in this bug...  Thanks wasn't certain, hence [comment #3](show_bug.cgi?id=462046#c3) ```  [Comment 7](#c7)  Chris Reffett (RETIRED)   gentoo-dev Security  2013-08-30 00:52:03 UTC  ``` @maintainers: ping, does 0.8.3 fix these issues? ```  [Comment 8](#c8)  Luke-Jr    2013-08-30 01:17:19 UTC  ``` <https://en.bitcoin.it/wiki/CVEs> ```  [Comment 9](#c9)  Luke-Jr    2015-02-23 23:04:05 UTC  ``` This should be closed. ```  [Comment 10](#c10)  Anthony Basile   gentoo-dev  2015-02-23 23:09:20 UTC  ``` @security team.  go ahead and vote on glsa. we're done. ```  [Comment 11](#c11)  Aaron Bauman (RETIRED)   gentoo-dev  2016-03-18 07:37:59 UTC  ``` Vulnerable packages have been gone for over 2 years so no GLSA. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=462046)
* - [XML](show_bug.cgi?ctype=xml&id=462046)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=462046)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=462046&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=462046&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=462046&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from bitcointalk.org_3497b8ea_20250126_101359.html ===


| Bitcoin Forum |  |
| --- | --- |

| January 26, 2025, 10:13:59 AM * |
| --- |
| | Welcome, **Guest**. Please [login](https://bitcointalk.org/index.php?action=login) or [register](https://bitcointalk.org/index.php?action=register). | | | --- | --- | | |

| **News**: Latest Bitcoin Core release: [28.0](https://bitcoincore.org/en/download/) [[Torrent](https://bitcointalk.org/bitcoin-28.0.torrent)] |  |
| --- | --- |

|  |  | [Home](https://bitcointalk.org/index.php) |  | [Help](https://bitcointalk.org/index.php?action=help) | [Search](https://bitcointalk.org/index.php?action=search) | [Login](https://bitcointalk.org/index.php?action=login) | [Register](https://bitcointalk.org/index.php?action=register) | [More](/more.php) |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

**[Bitcoin Forum](https://bitcointalk.org/index.php)** > **[Bitcoin](https://bitcointalk.org/index.php#1)** > **[Development & Technical Discussion](https://bitcointalk.org/index.php?board=6.0)** > **[New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.0)**

| Pages: [**1**] | [« previous topic](https://bitcointalk.org/index.php?topic=140078.0;prev_next=prev#new) [next topic »](https://bitcointalk.org/index.php?topic=140078.0;prev_next=next#new)  |  | [Print](https://bitcointalk.org/index.php?action=printpage;topic=140078.0) |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- |

|  | Author | Topic: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify  (Read 17571 times) |
| --- | --- | --- |

| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1491085#msg1491085) January 30, 2013, 08:16:52 PMLast edit: January 30, 2013, 09:06:56 PM by Sergio\_Demian\_Lerner*Merited by [LoyceV](/index.php?action=profile;u=459836) (8), [BlackHatCoiner](/index.php?action=profile;u=2775483) (8), [ABCbits](/index.php?action=profile;u=359716) (3), [vapourminer](/index.php?action=profile;u=33156) (2), [darosior](/index.php?action=profile;u=1804392) (2)* | [#1](https://bitcointalk.org/index.php?topic=140078.msg1491085#msg1491085) | | --- | --- | --- |  ---   **New Bitcoin vulnerability: A transaction that takes at least 3 minutes to be verified by a peer**What is the most CPU consuming transaction an attacker can create? (\*)Don't keep reading. Take a minute to think about it.........Most people will immediately look for a transaction that verifies as many signatures as possible. One can achieve this by trying to spend many previous outputs that you own, with a single signature verification for each.But it turns out that that attack is quite expensive: given that each TxIn requires at least 100 bytes to hold a signature, a 1Mb transaction would only hold 10K signatures. Assuming each signature verification takes 2 msec, processing the transactionwould take 20 seconds. But even then we would need 10K previns ready to be spent, which would be quite hard to achieve.If the attacker is a miner, he can create a transaction that exposes 10K outputs (TxPrep), and follow it by the transaction that consumes them (TxAttack). But TxPrep would require an  additional 340 Kbytes, so TxAttack would be shorter than expected.**Repeated SHA-256 hashing**There is a another way of forcing clients to do expensive computations with less resources, and that is by forcing clients to hashthe transaction many times: by design each time a signature is verified, the whole transaction is hashed, with some minor modifications.(check  <https://en.bitcoin.it/wiki/OP_CHECKSIG> and the beautiful accompanying graph made by Etotheipi)Using this fact, a miner can construct a transaction take takes more than 3 minutes to be verified (assuming 100 MiB/sec of SHA-256 hashing speed).First the attacker creates a a transaction that sends 1 satoshi to 100 outputs. Each output is not a standard scriptPub, but special scriptPub that consist of the opcodes: OP\_CHECKSIG (200 times) OP\_TRUEThis script constains no more than 200 sigops, so is a valid script (200 is the limit).TxPrep takes aproximately 21 Kbytes from the 1M block.Then the attacker builds the transaction TxAttack which uses all these TxPrep outputs. To make the transaction valid, each scriptSig is:  OP\_0 (201 times)The previn part of the Txattack transaction takes aproximately 24 Kbytes.The rest of the TxAttack transaction (upto 1Mb is filled) is made of a few outputs with long scripts (or a lot of outputs with short scripts). This part of the transaction is almost 955 Kbytes long. (\*\*)Now, to verify a single script (scriptSig+ScriptPub) the client tries to verify 200 signatures. Obviously each of those verification return false, since 0x00 is neither a valid ECDSA public key nor a valid ECDSA signature.But the client has to rehash the 955 Kbytes of data 200 times.The total size hashed is 100\*200\*955000=19 100 000 000 bytesAssuming that OpenSSL code performance of SHA-256 hashing is 100 MiB/sec, then the hashing takes 191 seconds.The proposed attack requires that miners includes both TxPrep and TxAttack in blocks (but I may be different blocks).This could be achieved by any user by adding some BTC as fees (I think 1 BTC will do).Nevertheless, another attack can be constructed by using a standard transaction, that is relied normally from peer to peer.The attacker can use a standard multisignature transaction to try to pack more verifications in less space ( 1-in-3 OP\_CHECKMULTISIG ).This attack is much more difficult, since it requires the attacker to prepare more than 6000 outputs to be used.**How this vulnerability could be used to perform an attack?**1. A miner that can mine one of these block every 10 blocks (having 10% of the network hashing power) can force the blockchain verification  process to be a lot slower. Verifying a year of the blockchain would take more than 10 days of CPU time.2. A miner could use this attack combined by other idea gets a greater probability of finding a block the next block.3. A peer wants to DoS attack another peer. (but the penny-flooding protection must be bypassed somehow)4. If miners do not prevent these transactions from being included in their blocks, an attacker can create a TxPrep/TxAttack pair transaction for every block mined, and send the pair every 10 minutes, with a 1 BTC fee, to be included in the next block. Validating the blockchain would take almost half the time it takes to generate it, then the coin price would collapse, the attack becomes cheaper, ... dooms day. Obviously miners will stop including such transactions and nothing horrible really happens. But miners should have to reject tasty fees, and I don't know how the incentives will play for them. **Not a Solution (without hard-forking)**Create a Transaction hash cache to temporarily store the last used hash during the evaluation of a script. Note that the attack can still be executed by using independent outputs. (TxPrep creates 20K outputs, using 200 Kbytes, then TxAttack consumes these 20K outputs, and requires 152 seconds to be verified)**Quite good Solution (without hard-forking)**Verify that the ECDSA signature and the ECDSA public key are well-formed before hashing the transaction.(this reduces the maximum CPU time to about 30 seconds, since now TxAttack wastes more bytes in signatures)**My Solution proposals**1. Soft-forking: Reduce the maximum transaction size to 100 Kbytes. (AGAIN Sergio !?!)   2. Hard-forking: For script evaluation purposes Define    Hash(Tx,previn-index) = Hash ( Hash(outputs) || Hash (Inputs-with-script-cleared) || <previn-index> )   (for SIGHASH\_ALL)   This way the values "Hash(outputs)" and "Hash(Inputs-with-script-cleared)" can be cached and reused.Best regards, Sergio.(\*) Note that I have excluded the hard-disk resource on purpose, since that's another story I'll be telling you in some time(\*\*) I've not created and tested the transaction, but it seems to me that there is nothing in the protocol that stops it. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | | **[Gavin Andresen](https://bitcointalk.org/index.php?action=profile;u=224 "View the profile of Gavin Andresen")** Legendary * qt Offline Offline Activity: 1652 Merit: 2317  Chief Scientist   [View Profile](https://bitcointalk.org/index.php?action=profile;u=224) [WWW](http://gavinthink.blogspot.com/?CC9873 "My blog") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1491378#msg1491378) January 30, 2013, 09:50:11 PM*Merited by [ABCbits](/index.php?action=profile;u=359716) (1)* | [#2](https://bitcointalk.org/index.php?topic=140078.msg1491378#msg1491378) | | --- | --- | --- |  ---   Thanks Sergio!So:  if the attacker creates a block with a transaction that takes 3 minutes to verify, and then broadcasts it, it will take a very long time for it to propagate across the network (because peers verify blocks before relaying them).And since this attack requires non-standard transactions, mining a block is the only way an attacker will be able to pull off this attack. So I don't think this is a practical attack on the production network: by the time the 3-minute-to-verify block got to 50% of the network the other half of the network will probably have produced a block (sure, the attacker could try to Sybil the network and send its block to a super-majority of mining nodes, but I bet all of the big mining pools are hiding their block-creating and share-accepting nodes behind multiple "front-end bitcoinds" by now to mitigate DDoS attacks).Fixing the OP\_\*SIG opcodes so they "look before they hash" is a good idea. We're actually moving towards that; see fStrictEncodings and the IsCanonicalSignature/IsCanonicalPubKey in the latest script.cpp code. The intent is to eventually roll out a 'soft-fork' that requires signatures and public keys be well-formed and canonical.Also, a nit: using OP\_0 for the scriptSig wouldn't work for this attack (see if (vchSig.empty()) return false; in CheckSig()). | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   How often do you get the chance to work on a potentially world-changing project? | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494005#msg1494005) January 31, 2013, 07:37:21 PM*Merited by [ABCbits](/index.php?action=profile;u=359716) (3)* | [#3](https://bitcointalk.org/index.php?topic=140078.msg1494005#msg1494005) | | --- | --- | --- |  ---   I realized that the "Quite Good" solution only does not work alone. It's not enough to verify that the arguments are well-formed.A complete solution requires that the last hash digest of the transaction is cached and reused in the following verifications of the same prevout.Here is a modified attack that verifies 19932 well-formed signatures against a well-formed public key.I use 151 inputs. Each input requires 132 verifications. That's 19932 verifications in total.**ScriptSig:**OP\_PUSHDATA1<sig-size><signature>OP\_PUSHDATA1<pubkey-size><pubkey>{ repeat the following part 66 timesOP\_2DUPOP\_CHECKSIGOP\_DROP}>> stack after execution  of ScriptSig:    [bottom] <signature> <pubkey-size> [top]**ScriptPub:**{ repeat the following part 66 timesOP\_2DUPOP\_CHECKSIGOP\_DROP}OP\_DROPOP\_DROPOP\_TRUE>> stack after execution  of ScriptPub:    [bottom] <1> [top]The part that does not contribute to hashing is 76 Kbytes long, so the remaining 924500 bytes are hashed.The transaction takes at least **184 seconds** to verify.Without the signature cache, it would take an additional 40 seconds.If the last hash of the transaction used while evaluation a script is cached, then only the first hash of each prevout is computed, and that will require only 151 evaluations (not 19932)Best regards! Sergio. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494025#msg1494025) January 31, 2013, 07:49:29 PM | [#4](https://bitcointalk.org/index.php?topic=140078.msg1494025#msg1494025) | | --- | --- | --- |  ---   [Quote from: Gavin Andresen on January 30, 2013, 09:50:11 PM](https://bitcointalk.org/index.php?topic=140078.msg1491378#msg1491378)And since this attack requires non-standard transactions, mining a block is the only way an attacker will be able to pull off this attack. There is at least one mining pool that accepts direct connections to be used to send non-standard transactions. So the attack could in theory be done by anyone willing to pay some fees (that, right now, are very cheap). | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[DeathAndTaxes](https://bitcointalk.org/index.php?action=profile;u=41048 "View the profile of DeathAndTaxes")** Donator Legendary * Offline Offline Activity: 1218 Merit: 1086  Gerald Davis   [View Profile](https://bitcointalk.org/index.php?action=profile;u=41048) | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494061#msg1494061) January 31, 2013, 08:10:26 PM | [#5](https://bitcointalk.org/index.php?topic=140078.msg1494061#msg1494061) | | --- | --- | --- |  ---   [Quote from: Sergio\_Demian\_Lerner on January 31, 2013, 07:49:29 PM](https://bitcointalk.org/index.php?topic=140078.msg1494025#msg1494025)[Quote from: Gavin Andresen on January 30, 2013, 09:50:11 PM](https://bitcointalk.org/index.php?topic=140078.msg1491378#msg1491378)And since this attack requires non-standard transactions, mining a block is the only way an attacker will be able to pull off this attack. There is at least one mining pool that accepts direct connections to be used to send non-standard transactions. So the attack could in theory be done by anyone willing to pay some fees (that, right now, are very cheap).Well the nice things is there is an economic cost to the miner.  If the miner starts to notice their orphan rate skyrocket then they may wish to investigate why their blocks are taking so long.  Not sure how much it would increase the orphan rate but I would imagine a 3 minute (or even 30 second) verification time would destroy the pools competitiveness.  Earn a lot of fees and lose the block worth 25 BTC isn't really worth it.  When miners are willing to change pools over a 1% difference in orphan rates it shows how economically sensitive they are to anything which disrupts earnings. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Luke-Jr](https://bitcointalk.org/index.php?action=profile;u=3318 "View the profile of Luke-Jr")** Legendary * expert Offline Offline Activity: 2576 Merit: 1186   [View Profile](https://bitcointalk.org/index.php?action=profile;u=3318) | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494449#msg1494449) January 31, 2013, 11:00:39 PM | [#6](https://bitcointalk.org/index.php?topic=140078.msg1494449#msg1494449) | | --- | --- | --- |  ---   [Quote from: Sergio\_Demian\_Lerner on January 31, 2013, 07:49:29 PM](https://bitcointalk.org/index.php?topic=140078.msg1494025#msg1494025)[Quote from: Gavin Andresen on January 30, 2013, 09:50:11 PM](https://bitcointalk.org/index.php?topic=140078.msg1491378#msg1491378)And since this attack requires non-standard transactions, mining a block is the only way an attacker will be able to pull off this attack. There is at least one mining pool that accepts direct connections to be used to send non-standard transactions. So the attack could in theory be done by anyone willing to pay some fees (that, right now, are very cheap).I presume you're referring to Eligius here. We can just disable non-standard transactions until I come up with a good long-term solution...Wouldn't this also be fixed by simply caching the transaction hash for the first OP\_CHECKSIG ? | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   Donate: (PM me)My projects: [Bitcoin Knots](http://bitcoinknots.org/), [Bitcoin Core](https://bitcoincore.org/), [BFGMiner](https://bitcointalk.org/?topic=626361), [Eloipool (pool software)](https://bitcointalk.org/index.php?topic=61731.0), [Tonal Bitcoin](https://en.bitcoin.it/wiki/Tonal_Bitcoin), and [BitGit (Bitcoin code directory)](http://luke.dashjr.org/programs/bitcoin/) | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494507#msg1494507) January 31, 2013, 11:32:52 PMLast edit: February 01, 2013, 04:21:53 AM by Sergio\_Demian\_Lerner | [#7](https://bitcointalk.org/index.php?topic=140078.msg1494507#msg1494507) | | --- | --- | --- |  ---   I have good news ~~and bad news~~.The good news (as I already said) is that it can be patched by caching the last tx hash AND checking the key/pubkey format before hashing (or at least check that the size of the arguments is correct)~~The bad news is that I came across a new attack that can DESTROY the credibility of the network in a few days. **So please Eligius, you better stop allowing non-standard transactions for a while until everybody upgrades or every miner in earth conforms to reject non-standard transactions.**~~~~The idea is to make the splitting of TxPrep/TxAttack in such a way that the TxPrep part is non-standard, but it´s also small and will be included in blocks like the ones mined by Eligius.Then TxAttack is made standard, so IT WILL BE FORWARDED by nodes.An attacker can send many TxPrep(i) during a preparation phase (and also during the attack) interlaced with TxAttack(i). So the attacker can, at any time and for any amount of time, pose an enormous amount of work to the network for very little cost.The scripts look like this:**TxPrep:** NON-STANDARD100 outputs:scriptPub:OP\_0 { 199 times}OP\_CHECKSIG {198 times}OP\_DROP<pubKey> OP\_CHECKSIG{leaves the stack as: [BOTTOM] <pubKey> [TOP]}Size: 46 Kbytes. **TxAttack:** STANDARD100 inputs:scriptSig: <sig>Size of inputs: 10 Kbytes.Size of outputs: 990 Kbytes.Size of transaction: 1Mb Time to verify: 990 Kbytes \* 20000 / 100000000 = 198 secsTime to send the tx: 20 seconds. (at 50 Kbytes/sec)So imagine an attacker prepares the attack for a few days, by storing into the blockchain a hundred TxPrep(i), and the suddenly releases all of the TxAttack(i).I nobody finds a good reason not to, I will be changing the title of this thread to reflect the change in impact of the attack.~~Best regards, Sergio. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Peter Todd](https://bitcointalk.org/index.php?action=profile;u=2546 "View the profile of Peter Todd")** Legendary * expert Offline Offline Activity: 1120 Merit: 1168  [View Profile](https://bitcointalk.org/index.php?action=profile;u=2546) | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494563#msg1494563) February 01, 2013, 12:04:41 AMLast edit: February 01, 2013, 12:25:00 AM by retep | [#8](https://bitcointalk.org/index.php?topic=140078.msg1494563#msg1494563) | | --- | --- | --- |  ---   Has anyone tried this on testnet yet?EDIT: and while we're at it, you realize how you're going direct to disclosing this in public, right at a time when Avalon ASIC boxes are being shipped that can mine a block every 2 days on average? Frankly I think this is rather irresponsible of you. I did the whole [responsible disclosure](https://en.wikipedia.org/wiki/Responsible_disclosure) process for the silly little nLockTime oversight I found, and here you are putting everything in public for a problem that's potentially far more serious. The dev team could have easily snuck a fix into the upcoming 0.8 release. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   BTC: [1FCYd7j4CThTMzts78rh6iQJLBRGPW9fWv](http://0bin.net/paste/wZ9ybXwCXlXcIQo5#sENvcsLbkOXIYSWsIVxqyOVIXJeoLv5uqEg-lHtsrrH)  PGP: [7FAB114267E4FA04](http://pool.sks-keyservers.net:11371/pks/lookup?op=vindex&search=0x37EC7D7B0A217CDB4B4E007E7FAB114267E4FA04) | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494654#msg1494654) February 01, 2013, 12:47:00 AM | [#9](https://bitcointalk.org/index.php?topic=140078.msg1494654#msg1494654) | | --- | --- | --- |  ---   Retep:First, when I first published the vulnerability, I thought I wasn't critical. Almost each time I do responsible disclosing (and I did it more than 5 times), the core devs disregard the issues, so I really thought it was another minor vuln. The fact that Gavin disregarded it in this thread means that I would have published it anyway, even after going through the undocumented process of responsible disclosing.Second, after I published the first details, the extension to standard tx would be pretty obvious to anybody willing to think about it a minute.So the best I could do was to tell the truth and protect the network from attackers telling miners to prepare from such attack.Third, anyone willing to invest 100K USD in ASIC will always be able to disrupt the network, so it's no difference before and after this vuln was disclosed.Protecting the network is very easy: don't include non-standard transactions in blocks.My final word is that the **attack is not critical**, nothing to start shouting everywhere, but it's real.Best regards, Sergio. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Gavin Andresen](https://bitcointalk.org/index.php?action=profile;u=224 "View the profile of Gavin Andresen")** Legendary * qt Offline Offline Activity: 1652 Merit: 2317  Chief Scientist   [View Profile](https://bitcointalk.org/index.php?action=profile;u=224) [WWW](http://gavinthink.blogspot.com/?CC9873 "My blog") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494724#msg1494724) February 01, 2013, 01:26:27 AMLast edit: February 01, 2013, 02:14:54 AM by Gavin Andresen | [#10](https://bitcointalk.org/index.php?topic=140078.msg1494724#msg1494724) | | --- | --- | --- |  ---   Sergio:It **would** be more helpful if you either took a little bit more time and actually wrote a little bit of code to make sure the attack works, and started the conversation privately with "here's code that demonstrates a very expensive-to-verify transaction and a few suggestions on how you might fix it..."I created a simulation of TxPrep/TxAttack by adding them to src/test/data/script\_valid.json and then running through the script\_tests.cpp unit test in the debugger, and with the particular TxPrep you propose there is no problem with current code.Also, TxAttack is not standard with the latest code; see CTransaction::AreInputsStandard(), which checks the scriptPubKeys being spent.RE:  undocumented process of responsible disclosing :  good point.  Where would you expect to find the process documented?  We can fix that... | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   How often do you get the chance to work on a potentially world-changing project? | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Luke-Jr](https://bitcointalk.org/index.php?action=profile;u=3318 "View the profile of Luke-Jr")** Legendary * expert Offline Offline Activity: 2576 Merit: 1186   [View Profile](https://bitcointalk.org/index.php?action=profile;u=3318) | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494788#msg1494788) February 01, 2013, 02:02:54 AM | [#11](https://bitcointalk.org/index.php?topic=140078.msg1494788#msg1494788) | | --- | --- | --- |  ---   [Quote from: Sergio\_Demian\_Lerner on February 01, 2013, 12:47:00 AM](https://bitcointalk.org/index.php?topic=140078.msg1494654#msg1494654)Protecting the network is very easy: don't include non-standard transactions in blocks.An attack like this just requires a hostile party to mine 1 block.That's still within reach of most people, even after ASIC hits on full.Blocking out "non-standard" transactions in general just harms potential innovation. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   Donate: (PM me)My projects: [Bitcoin Knots](http://bitcoinknots.org/), [Bitcoin Core](https://bitcoincore.org/), [BFGMiner](https://bitcointalk.org/?topic=626361), [Eloipool (pool software)](https://bitcointalk.org/index.php?topic=61731.0), [Tonal Bitcoin](https://en.bitcoin.it/wiki/Tonal_Bitcoin), and [BitGit (Bitcoin code directory)](http://luke.dashjr.org/programs/bitcoin/) | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494853#msg1494853) February 01, 2013, 03:55:03 AM | [#12](https://bitcointalk.org/index.php?topic=140078.msg1494853#msg1494853) | | --- | --- | --- |  ---   [Quote from: Luke-Jr on February 01, 2013, 02:02:54 AM](https://bitcointalk.org/index.php?topic=140078.msg1494788#msg1494788)[Quote from: Sergio\_Demian\_Lerner on February 01, 2013, 12:47:00 AM](https://bitcointalk.org/index.php?topic=140078.msg1494654#msg1494654)Protecting the network is very easy: don't include non-standard transactions in blocks.An attack like this just requires a hostile party to mine 1 block.That's still within reach of most people, even after ASIC hits on full.Blocking out "non-standard" transactions in general just harms potential innovation.Even if a block containing a 3min tx is ever mined and buried into the blockchain, the 0.9 version of the Satoshi client could just check for the tx hash and, as an exception, set the transaction as verified without actually doing any verifications.As we already have good prevention measures in 0.8, as Gavin said, I really dubt that during the update process a 3min transaction will be mined. The time window is short and the attackers benefit, almost none (for a single tx mined). The real problem starts is if a hundred 3min transactions are mined, not just one.I would say miners have at least a month to upgrade. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494863#msg1494863) February 01, 2013, 04:00:03 AM | [#13](https://bitcointalk.org/index.php?topic=140078.msg1494863#msg1494863) | | --- | --- | --- |  ---   [Quote from: Gavin Andresen on February 01, 2013, 01:26:27 AM](https://bitcointalk.org/index.php?topic=140078.msg1494724#msg1494724)Sergio:It **would** be more helpful if you either took a little bit more time and actually wrote a little bit of code to make sure the attack worksI respect very much all the hard work all the core devs do designing and writing code. I have no time to code, so my contribution is to think. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494878#msg1494878) February 01, 2013, 04:10:01 AM | [#14](https://bitcointalk.org/index.php?topic=140078.msg1494878#msg1494878) | | --- | --- | --- |  ---   [Quote from: Gavin Andresen on February 01, 2013, 01:26:27 AM](https://bitcointalk.org/index.php?topic=140078.msg1494724#msg1494724)Also, TxAttack is not standard with the latest code; see CTransaction::AreInputsStandard(), which checks the scriptPubKeys being spent.Great! So, to clear this issue: Gavin stated there is NO WAY OF MAKING TxAttack STANDARD.That's relieving. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Peter Todd](https://bitcointalk.org/index.php?action=profile;u=2546 "View the profile of Peter Todd")** Legendary * expert Offline Offline Activity: 1120 Merit: 1168  [View Profile](https://bitcointalk.org/index.php?action=profile;u=2546) | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1497510#msg1497510) February 02, 2013, 07:10:02 AM | [#15](https://bitcointalk.org/index.php?topic=140078.msg1497510#msg1497510) | | --- | --- | --- |  ---   [Quote from: Sergio\_Demian\_Lerner on February 01, 2013, 04:00:03 AM](https://bitcointalk.org/index.php?topic=140078.msg1494863#msg1494863)I respect very much all the hard work all the core devs do designing and writing code. I have no time to code, so my contribution is to think.Often coding actually takes less time to solve a problem than just thinking, because by coding you let the computer help you find out if you are wrong much faster than trying to use reason to determine if you are wrong. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   BTC: [1FCYd7j4CThTMzts78rh6iQJLBRGPW9fWv](http://0bin.net/paste/wZ9ybXwCXlXcIQo5#sENvcsLbkOXIYSWsIVxqyOVIXJeoLv5uqEg-lHtsrrH)  PGP: [7FAB114267E4FA04](http://pool.sks-keyservers.net:11371/pks/lookup?op=vindex&search=0x37EC7D7B0A217CDB4B4E007E7FAB114267E4FA04) | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Luke-Jr](https://bitcointalk.org/index.php?action=profile;u=3318 "View the profile of Luke-Jr")** Legendary * expert Offline Offline Activity: 2576 Merit: 1186   [View Profile](https://bitcointalk.org/index.php?action=profile;u=3318) | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1566880#msg1566880) February 28, 2013, 06:36:06 AM | [#16](https://bitcointalk.org/index.php?topic=140078.msg1566880#msg1566880) | | --- | --- | --- |  ---   For reference, this is assigned CVE-2013-2292 | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   Donate: (PM me)My projects: [Bitcoin Knots](http://bitcoinknots.org/), [Bitcoin Core](https://bitcoincore.org/), [BFGMiner](https://bitcointalk.org/?topic=626361), [Eloipool (pool software)](https://bitcointalk.org/index.php?topic=61731.0), [Tonal Bitcoin](https://en.bitcoin.it/wiki/Tonal_Bitcoin), and [BitGit (Bitcoin code directory)](http://luke.dashjr.org/programs/bitcoin/) | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
|  |

| Pages: [**1**] | |  | [Print](https://bitcointalk.org/index.php?action=printpage;topic=140078.0) |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- |

| **[Bitcoin Forum](https://bitcointalk.org/index.php)** > **[Bitcoin](https://bitcointalk.org/index.php#1)** > **[Development & Technical Discussion](https://bitcointalk.org/index.php?board=6.0)** > **[New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.0)** | [« previous topic](https://bitcointalk.org/index.php?topic=140078.0;prev_next=prev#new) [next topic »](https://bitcointalk.org/index.php?topic=140078.0;prev_next=next#new) |
| --- | --- |

|  |
| --- |

Jump to:
Please select a destination:
-----------------------------
Bitcoin
-----------------------------
 => Bitcoin Discussion
 ===> Legal
 ===> Press
 ===> Meetups
 ===> Important Announcements
 => Development & Technical Discussion
 ===> Wallet software
 =====> Electrum
 =====> Bitcoin Wallet for Android
 =====> BitcoinJ
 =====> Armory
 =====> Mycelium
 =====> Hardware wallets
 => Mining
 ===> Mining support
 ===> Pools
 ===> Mining software (miners)
 ===> Hardware
 =====> Group buys
 ===> Mining speculation
 => Bitcoin Technical Support
 => Project Development
-----------------------------
Economy
-----------------------------
 => Economics
 ===> Speculation
 => Marketplace
 ===> Goods
 =====> Computer hardware
 =====> Digital goods
 =======> Invites & Accounts
 =====> Collectibles
 ===> Services
 ===> Currency exchange
 ===> Gambling
 =====> Games and rounds
 =====> Investor-based games
 =====> Gambling discussion
 ===> Lending
 =====> Long-term offers
 ===> Securities
 ===> Auctions
 ===> Service Announcements
 =====> Micro Earnings
 ===> Service Discussion
 =====> Web Wallets
 =====> Exchanges
 => Trading Discussion
 ===> Scam Accusations
 ===> Reputation
-----------------------------
Other
-----------------------------
 => Meta
 ===> New forum software
 ===> Bitcoin Wiki
 => Politics & Society
 => Beginners & Help
 => Off-topic
 => Serious discussion
 ===> Ivory Tower
 => Archival
 ===> Корзина
 ===> CPU/GPU Bitcoin mining hardware
 ===> Chinese students
 ===> Obsolete (buying)
 ===> Obsolete (selling)
 ===> MultiBit
-----------------------------
Alternate cryptocurrencies
-----------------------------
 => Altcoin Discussion
 => Announcements (Altcoins)
 ===> Tokens (Altcoins)
 => Mining (Altcoins)
 ===> Pools (Altcoins)
 => Marketplace (Altcoins)
 ===> Service Announcements (Altcoins)
 ===> Service Discussion (Altcoins)
 ===> Bounties (Altcoins)
 => Speculation (Altcoins)
-----------------------------
Local
-----------------------------
 => العربية (Arabic)
 ===> العملات البديلة (Altcoins)
 =====> النقاشات
 ===> إستفسارات و أسئلة المبتدئين
 ===> التعدين
 ===> النقاشات الأخرى
 ===> منصات التبادل
 => Bahasa Indonesia (Indonesian)
 ===> Marketplace (Bahasa Indonesia)
 ===> Mining (Bahasa Indonesia)
 ===> Altcoins (Bahasa Indonesia)
 ===> Trading dan Spekulasi
 ===> Ekonomi, Politik, dan Budaya
 ===> Topik Lainnya
 => Español (Spanish)
 ===> Mercado y Economía
 =====> Servicios
 =====> Trading y especulación
 ===> Hardware y Minería
 ===> Esquina Libre
 ===> Mercadillo
 =====> Mexico
 =====> Argentina
 =====> España
 =====> Centroamerica y Caribe
 ===> Primeros pasos y ayuda
 ===> Altcoins (criptomonedas alternativas)
 =====> Minería de altcoins
 =====> Servicios
 =====> Tokens (Español)
 => 中文 (Chinese)
 ===> 跳蚤市场
 ===> 山寨币
 ===> 媒体
 ===> 挖矿
 ===> 离题万里
 => Hrvatski (Croatian)
 ===> Trgovina
 ===> Altcoins (Hrvatski)
 =====> Announcements (Hrvatski)
 ===> Off-topic (Hrvatski)
 => Deutsch (German)
 ===> Anfänger und Hilfe
 ===> Mining (Deutsch)
 ===> Trading und Spekulation
 ===> Projektentwicklung
 ===> Off-Topic (Deutsch)
 ===> Treffen
 ===> Presse
 ===> Altcoins (Deutsch)
 =====> Announcements (Deutsch)
 ===> Marktplatz
 =====> Auktionen
 =====> Suche
 =====> Biete
 => Ελληνικά (Greek)
 ===> Αγορά
 ===> Mining Discussion (Ελληνικά)
 ===> Altcoins (Ελληνικά)
 =====> Altcoin Announcements (Ελληνικά)
 =====> Altcoin Mining (Ελληνικά)
 => עברית (Hebrew)
 => Français
 ===> Actualité et News
 ===> Débutants
 ===> Discussions générales et utilisation du Bitcoin
 ===> Mining et Hardware
 ===> Économie et spéculation
 ===> Place de marché
 =====> Échanges
 =====> Produits et services
 =====> Petites annonces
 ===> Le Bitcoin et la loi
 ===> Wiki, documentation et traduction
 ===> Développement et technique
 ===> Vos sites et projets
 ===> Hors-sujet
 ===> Altcoins (Français)
 =====> Annonces
 => India
 ===> Mining (India)
 ===> Marketplace (India)
 ===> Regional Languages (India)
 ===> Press & News from India
 ===> Alt Coins (India)
 ===> Buyer/ Seller Reputations (India)
 ===> Off-Topic (India)
 => Italiano (Italian)
 ===> Guide (Italiano)
 ===> Progetti
 ===> Discussioni avanzate e sviluppo
 ===> Trading, analisi e speculazione
 ===> Mercato
 =====> Mercato valute
 =====> Beni
 =====> Servizi
 =====> Esercizi commerciali
 =====> Hardware/Mining (Italiano)
 =====> Gambling (Italiano)
 ===> Accuse scam/truffe
 ===> Mining (Italiano)
 ===> Alt-Currencies (Italiano)
 =====> Annunci
 ===> Raduni/Meeting (Italiano)
 ===> Crittografia e decentralizzazione
 ===> Off-Topic (Italiano)
 => 日本語 (Japanese)
 ===> アルトコイン
 => Nederlands (Dutch)
 ===> Markt
 ===> Gokken/lotterijen
 ===> Mining (Nederlands)
 ===> Beurzen
 ===> Alt Coins (Nederlands)
 ===> Off-topic (Nederlands)
 ===> Meetings (Nederlands)
 => Nigeria (Naija)
 ===> Politics and society (Naija)
 ===> Off-topic (Naija)
 => 한국어 (Korean)
 ===> 대체코인 Alt Coins (한국어)
 => Pilipinas
 ===> Altcoins (Pilipinas)
 =====> Altcoin Announcements (Pilipinas)
 ===> Pamilihan
 ===> Others (Pilipinas)
 => Polski
 ===> Tablica ogłoszeń
 ===> Alternatywne kryptowaluty
 =====> Nowe kryptowaluty i tokeny
 =====> Tablica ogłoszeń (altcoiny)
 => Português (Portuguese)
 ===> Primeiros Passos (Iniciantes)
 ===> Economia & Mercado
 ===> Mineração em Geral
 ===> Desenvolvimento & Discussões Técnicas
 ===> Criptomoedas Alternativas
 ===> Brasil
 ===> Portugal
 => Русский (Russian)
 ===> Новички
 ===> Бизнес
 =====> Барахолка
 =====> Обменники
 ===> Идеи
 ===> Кодеры
 ===> Майнеры
 ===> Политика
 ===> Трейдеры
 ===> Альтернативные криптовалюты
 =====> Токены
 =====> Бayнти и aиpдpoпы
 ===> Хайпы
 ===> Работа
 ===> Разное
 ===> Oбcyждeниe Bitcoin
 =====> Новости
 =====> Юристы
 => Română (Romanian)
 ===> Anunturi importante
 ===> Offtopic
 ===> Market
 =====> Discutii Servicii
 ===> Minerit
 ===> Tutoriale
 ===> Bine ai venit!
 ===> Presa
 ===> Altcoins (Monede Alternative)
 =====> Anunturi Monede Alternative
 => Skandinavisk
 => Türkçe (Turkish)
 ===> Bitcoin Haberleri
 ===> Pazar Alanı
 ===> Madencilik
 ===> Ekonomi
 ===> Servisler
 =====> Fonlar
 ===> Proje Geliştirme
 ===> Alternatif Kripto-Paralar
 =====> Madencilik (Alternatif Kripto-Paralar)
 =====> Duyurular (Alternatif Kripto-Paralar)
 ===> Konu Dışı
 ===> Yeni Başlayanlar & Yardım
 ===> Buluşmalar
 => Other languages/locations

| [Powered by MySQL](http://www.mysql.com/) [Powered by PHP](http://www.php.net/) | [Powered by SMF 1.1.19](http://www.simplemachines.org/ "Simple Machines Forum") | [SMF © 2006-2009, Simple Machines](http://www.simplemachines.org/about/copyright.php "Free Forum Software") | [Valid XHTML 1.0!](http://validator.w3.org/check/referer) [Valid CSS!](http://jigsaw.w3.org/css-validator/check/referer) |
| --- | --- | --- |

Loading...


=== Content from bitcointalk.org_1e5fd080_20250126_101358.html ===


| Bitcoin Forum |  |
| --- | --- |

| January 26, 2025, 10:13:57 AM * |
| --- |
| | Welcome, **Guest**. Please [login](https://bitcointalk.org/index.php?action=login) or [register](https://bitcointalk.org/index.php?action=register). | | | --- | --- | | |

| **News**: Latest Bitcoin Core release: [28.0](https://bitcoincore.org/en/download/) [[Torrent](https://bitcointalk.org/bitcoin-28.0.torrent)] |  |
| --- | --- |

|  |  | [Home](https://bitcointalk.org/index.php) |  | [Help](https://bitcointalk.org/index.php?action=help) | [Search](https://bitcointalk.org/index.php?action=search) | [Login](https://bitcointalk.org/index.php?action=login) | [Register](https://bitcointalk.org/index.php?action=register) | [More](/more.php) |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

**[Bitcoin Forum](https://bitcointalk.org/index.php)** > **[Bitcoin](https://bitcointalk.org/index.php#1)** > **[Development & Technical Discussion](https://bitcointalk.org/index.php?board=6.0)** > **[New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.0)**

| Pages: [**1**] | [« previous topic](https://bitcointalk.org/index.php?topic=140078.0;prev_next=prev#new) [next topic »](https://bitcointalk.org/index.php?topic=140078.0;prev_next=next#new)  |  | [Print](https://bitcointalk.org/index.php?action=printpage;topic=140078.0) |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- |

|  | Author | Topic: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify  (Read 17571 times) |
| --- | --- | --- |

| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1491085#msg1491085) January 30, 2013, 08:16:52 PMLast edit: January 30, 2013, 09:06:56 PM by Sergio\_Demian\_Lerner*Merited by [LoyceV](/index.php?action=profile;u=459836) (8), [BlackHatCoiner](/index.php?action=profile;u=2775483) (8), [ABCbits](/index.php?action=profile;u=359716) (3), [vapourminer](/index.php?action=profile;u=33156) (2), [darosior](/index.php?action=profile;u=1804392) (2)* | [#1](https://bitcointalk.org/index.php?topic=140078.msg1491085#msg1491085) | | --- | --- | --- |  ---   **New Bitcoin vulnerability: A transaction that takes at least 3 minutes to be verified by a peer**What is the most CPU consuming transaction an attacker can create? (\*)Don't keep reading. Take a minute to think about it.........Most people will immediately look for a transaction that verifies as many signatures as possible. One can achieve this by trying to spend many previous outputs that you own, with a single signature verification for each.But it turns out that that attack is quite expensive: given that each TxIn requires at least 100 bytes to hold a signature, a 1Mb transaction would only hold 10K signatures. Assuming each signature verification takes 2 msec, processing the transactionwould take 20 seconds. But even then we would need 10K previns ready to be spent, which would be quite hard to achieve.If the attacker is a miner, he can create a transaction that exposes 10K outputs (TxPrep), and follow it by the transaction that consumes them (TxAttack). But TxPrep would require an  additional 340 Kbytes, so TxAttack would be shorter than expected.**Repeated SHA-256 hashing**There is a another way of forcing clients to do expensive computations with less resources, and that is by forcing clients to hashthe transaction many times: by design each time a signature is verified, the whole transaction is hashed, with some minor modifications.(check  <https://en.bitcoin.it/wiki/OP_CHECKSIG> and the beautiful accompanying graph made by Etotheipi)Using this fact, a miner can construct a transaction take takes more than 3 minutes to be verified (assuming 100 MiB/sec of SHA-256 hashing speed).First the attacker creates a a transaction that sends 1 satoshi to 100 outputs. Each output is not a standard scriptPub, but special scriptPub that consist of the opcodes: OP\_CHECKSIG (200 times) OP\_TRUEThis script constains no more than 200 sigops, so is a valid script (200 is the limit).TxPrep takes aproximately 21 Kbytes from the 1M block.Then the attacker builds the transaction TxAttack which uses all these TxPrep outputs. To make the transaction valid, each scriptSig is:  OP\_0 (201 times)The previn part of the Txattack transaction takes aproximately 24 Kbytes.The rest of the TxAttack transaction (upto 1Mb is filled) is made of a few outputs with long scripts (or a lot of outputs with short scripts). This part of the transaction is almost 955 Kbytes long. (\*\*)Now, to verify a single script (scriptSig+ScriptPub) the client tries to verify 200 signatures. Obviously each of those verification return false, since 0x00 is neither a valid ECDSA public key nor a valid ECDSA signature.But the client has to rehash the 955 Kbytes of data 200 times.The total size hashed is 100\*200\*955000=19 100 000 000 bytesAssuming that OpenSSL code performance of SHA-256 hashing is 100 MiB/sec, then the hashing takes 191 seconds.The proposed attack requires that miners includes both TxPrep and TxAttack in blocks (but I may be different blocks).This could be achieved by any user by adding some BTC as fees (I think 1 BTC will do).Nevertheless, another attack can be constructed by using a standard transaction, that is relied normally from peer to peer.The attacker can use a standard multisignature transaction to try to pack more verifications in less space ( 1-in-3 OP\_CHECKMULTISIG ).This attack is much more difficult, since it requires the attacker to prepare more than 6000 outputs to be used.**How this vulnerability could be used to perform an attack?**1. A miner that can mine one of these block every 10 blocks (having 10% of the network hashing power) can force the blockchain verification  process to be a lot slower. Verifying a year of the blockchain would take more than 10 days of CPU time.2. A miner could use this attack combined by other idea gets a greater probability of finding a block the next block.3. A peer wants to DoS attack another peer. (but the penny-flooding protection must be bypassed somehow)4. If miners do not prevent these transactions from being included in their blocks, an attacker can create a TxPrep/TxAttack pair transaction for every block mined, and send the pair every 10 minutes, with a 1 BTC fee, to be included in the next block. Validating the blockchain would take almost half the time it takes to generate it, then the coin price would collapse, the attack becomes cheaper, ... dooms day. Obviously miners will stop including such transactions and nothing horrible really happens. But miners should have to reject tasty fees, and I don't know how the incentives will play for them. **Not a Solution (without hard-forking)**Create a Transaction hash cache to temporarily store the last used hash during the evaluation of a script. Note that the attack can still be executed by using independent outputs. (TxPrep creates 20K outputs, using 200 Kbytes, then TxAttack consumes these 20K outputs, and requires 152 seconds to be verified)**Quite good Solution (without hard-forking)**Verify that the ECDSA signature and the ECDSA public key are well-formed before hashing the transaction.(this reduces the maximum CPU time to about 30 seconds, since now TxAttack wastes more bytes in signatures)**My Solution proposals**1. Soft-forking: Reduce the maximum transaction size to 100 Kbytes. (AGAIN Sergio !?!)   2. Hard-forking: For script evaluation purposes Define    Hash(Tx,previn-index) = Hash ( Hash(outputs) || Hash (Inputs-with-script-cleared) || <previn-index> )   (for SIGHASH\_ALL)   This way the values "Hash(outputs)" and "Hash(Inputs-with-script-cleared)" can be cached and reused.Best regards, Sergio.(\*) Note that I have excluded the hard-disk resource on purpose, since that's another story I'll be telling you in some time(\*\*) I've not created and tested the transaction, but it seems to me that there is nothing in the protocol that stops it. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | | **[Gavin Andresen](https://bitcointalk.org/index.php?action=profile;u=224 "View the profile of Gavin Andresen")** Legendary * qt Offline Offline Activity: 1652 Merit: 2317  Chief Scientist   [View Profile](https://bitcointalk.org/index.php?action=profile;u=224) [WWW](http://gavinthink.blogspot.com/?CC9873 "My blog") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1491378#msg1491378) January 30, 2013, 09:50:11 PM*Merited by [ABCbits](/index.php?action=profile;u=359716) (1)* | [#2](https://bitcointalk.org/index.php?topic=140078.msg1491378#msg1491378) | | --- | --- | --- |  ---   Thanks Sergio!So:  if the attacker creates a block with a transaction that takes 3 minutes to verify, and then broadcasts it, it will take a very long time for it to propagate across the network (because peers verify blocks before relaying them).And since this attack requires non-standard transactions, mining a block is the only way an attacker will be able to pull off this attack. So I don't think this is a practical attack on the production network: by the time the 3-minute-to-verify block got to 50% of the network the other half of the network will probably have produced a block (sure, the attacker could try to Sybil the network and send its block to a super-majority of mining nodes, but I bet all of the big mining pools are hiding their block-creating and share-accepting nodes behind multiple "front-end bitcoinds" by now to mitigate DDoS attacks).Fixing the OP\_\*SIG opcodes so they "look before they hash" is a good idea. We're actually moving towards that; see fStrictEncodings and the IsCanonicalSignature/IsCanonicalPubKey in the latest script.cpp code. The intent is to eventually roll out a 'soft-fork' that requires signatures and public keys be well-formed and canonical.Also, a nit: using OP\_0 for the scriptSig wouldn't work for this attack (see if (vchSig.empty()) return false; in CheckSig()). | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   How often do you get the chance to work on a potentially world-changing project? | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494005#msg1494005) January 31, 2013, 07:37:21 PM*Merited by [ABCbits](/index.php?action=profile;u=359716) (3)* | [#3](https://bitcointalk.org/index.php?topic=140078.msg1494005#msg1494005) | | --- | --- | --- |  ---   I realized that the "Quite Good" solution only does not work alone. It's not enough to verify that the arguments are well-formed.A complete solution requires that the last hash digest of the transaction is cached and reused in the following verifications of the same prevout.Here is a modified attack that verifies 19932 well-formed signatures against a well-formed public key.I use 151 inputs. Each input requires 132 verifications. That's 19932 verifications in total.**ScriptSig:**OP\_PUSHDATA1<sig-size><signature>OP\_PUSHDATA1<pubkey-size><pubkey>{ repeat the following part 66 timesOP\_2DUPOP\_CHECKSIGOP\_DROP}>> stack after execution  of ScriptSig:    [bottom] <signature> <pubkey-size> [top]**ScriptPub:**{ repeat the following part 66 timesOP\_2DUPOP\_CHECKSIGOP\_DROP}OP\_DROPOP\_DROPOP\_TRUE>> stack after execution  of ScriptPub:    [bottom] <1> [top]The part that does not contribute to hashing is 76 Kbytes long, so the remaining 924500 bytes are hashed.The transaction takes at least **184 seconds** to verify.Without the signature cache, it would take an additional 40 seconds.If the last hash of the transaction used while evaluation a script is cached, then only the first hash of each prevout is computed, and that will require only 151 evaluations (not 19932)Best regards! Sergio. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494025#msg1494025) January 31, 2013, 07:49:29 PM | [#4](https://bitcointalk.org/index.php?topic=140078.msg1494025#msg1494025) | | --- | --- | --- |  ---   [Quote from: Gavin Andresen on January 30, 2013, 09:50:11 PM](https://bitcointalk.org/index.php?topic=140078.msg1491378#msg1491378)And since this attack requires non-standard transactions, mining a block is the only way an attacker will be able to pull off this attack. There is at least one mining pool that accepts direct connections to be used to send non-standard transactions. So the attack could in theory be done by anyone willing to pay some fees (that, right now, are very cheap). | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[DeathAndTaxes](https://bitcointalk.org/index.php?action=profile;u=41048 "View the profile of DeathAndTaxes")** Donator Legendary * Offline Offline Activity: 1218 Merit: 1086  Gerald Davis   [View Profile](https://bitcointalk.org/index.php?action=profile;u=41048) | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494061#msg1494061) January 31, 2013, 08:10:26 PM | [#5](https://bitcointalk.org/index.php?topic=140078.msg1494061#msg1494061) | | --- | --- | --- |  ---   [Quote from: Sergio\_Demian\_Lerner on January 31, 2013, 07:49:29 PM](https://bitcointalk.org/index.php?topic=140078.msg1494025#msg1494025)[Quote from: Gavin Andresen on January 30, 2013, 09:50:11 PM](https://bitcointalk.org/index.php?topic=140078.msg1491378#msg1491378)And since this attack requires non-standard transactions, mining a block is the only way an attacker will be able to pull off this attack. There is at least one mining pool that accepts direct connections to be used to send non-standard transactions. So the attack could in theory be done by anyone willing to pay some fees (that, right now, are very cheap).Well the nice things is there is an economic cost to the miner.  If the miner starts to notice their orphan rate skyrocket then they may wish to investigate why their blocks are taking so long.  Not sure how much it would increase the orphan rate but I would imagine a 3 minute (or even 30 second) verification time would destroy the pools competitiveness.  Earn a lot of fees and lose the block worth 25 BTC isn't really worth it.  When miners are willing to change pools over a 1% difference in orphan rates it shows how economically sensitive they are to anything which disrupts earnings. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Luke-Jr](https://bitcointalk.org/index.php?action=profile;u=3318 "View the profile of Luke-Jr")** Legendary * expert Offline Offline Activity: 2576 Merit: 1186   [View Profile](https://bitcointalk.org/index.php?action=profile;u=3318) | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494449#msg1494449) January 31, 2013, 11:00:39 PM | [#6](https://bitcointalk.org/index.php?topic=140078.msg1494449#msg1494449) | | --- | --- | --- |  ---   [Quote from: Sergio\_Demian\_Lerner on January 31, 2013, 07:49:29 PM](https://bitcointalk.org/index.php?topic=140078.msg1494025#msg1494025)[Quote from: Gavin Andresen on January 30, 2013, 09:50:11 PM](https://bitcointalk.org/index.php?topic=140078.msg1491378#msg1491378)And since this attack requires non-standard transactions, mining a block is the only way an attacker will be able to pull off this attack. There is at least one mining pool that accepts direct connections to be used to send non-standard transactions. So the attack could in theory be done by anyone willing to pay some fees (that, right now, are very cheap).I presume you're referring to Eligius here. We can just disable non-standard transactions until I come up with a good long-term solution...Wouldn't this also be fixed by simply caching the transaction hash for the first OP\_CHECKSIG ? | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   Donate: (PM me)My projects: [Bitcoin Knots](http://bitcoinknots.org/), [Bitcoin Core](https://bitcoincore.org/), [BFGMiner](https://bitcointalk.org/?topic=626361), [Eloipool (pool software)](https://bitcointalk.org/index.php?topic=61731.0), [Tonal Bitcoin](https://en.bitcoin.it/wiki/Tonal_Bitcoin), and [BitGit (Bitcoin code directory)](http://luke.dashjr.org/programs/bitcoin/) | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494507#msg1494507) January 31, 2013, 11:32:52 PMLast edit: February 01, 2013, 04:21:53 AM by Sergio\_Demian\_Lerner | [#7](https://bitcointalk.org/index.php?topic=140078.msg1494507#msg1494507) | | --- | --- | --- |  ---   I have good news ~~and bad news~~.The good news (as I already said) is that it can be patched by caching the last tx hash AND checking the key/pubkey format before hashing (or at least check that the size of the arguments is correct)~~The bad news is that I came across a new attack that can DESTROY the credibility of the network in a few days. **So please Eligius, you better stop allowing non-standard transactions for a while until everybody upgrades or every miner in earth conforms to reject non-standard transactions.**~~~~The idea is to make the splitting of TxPrep/TxAttack in such a way that the TxPrep part is non-standard, but it´s also small and will be included in blocks like the ones mined by Eligius.Then TxAttack is made standard, so IT WILL BE FORWARDED by nodes.An attacker can send many TxPrep(i) during a preparation phase (and also during the attack) interlaced with TxAttack(i). So the attacker can, at any time and for any amount of time, pose an enormous amount of work to the network for very little cost.The scripts look like this:**TxPrep:** NON-STANDARD100 outputs:scriptPub:OP\_0 { 199 times}OP\_CHECKSIG {198 times}OP\_DROP<pubKey> OP\_CHECKSIG{leaves the stack as: [BOTTOM] <pubKey> [TOP]}Size: 46 Kbytes. **TxAttack:** STANDARD100 inputs:scriptSig: <sig>Size of inputs: 10 Kbytes.Size of outputs: 990 Kbytes.Size of transaction: 1Mb Time to verify: 990 Kbytes \* 20000 / 100000000 = 198 secsTime to send the tx: 20 seconds. (at 50 Kbytes/sec)So imagine an attacker prepares the attack for a few days, by storing into the blockchain a hundred TxPrep(i), and the suddenly releases all of the TxAttack(i).I nobody finds a good reason not to, I will be changing the title of this thread to reflect the change in impact of the attack.~~Best regards, Sergio. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Peter Todd](https://bitcointalk.org/index.php?action=profile;u=2546 "View the profile of Peter Todd")** Legendary * expert Offline Offline Activity: 1120 Merit: 1168  [View Profile](https://bitcointalk.org/index.php?action=profile;u=2546) | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494563#msg1494563) February 01, 2013, 12:04:41 AMLast edit: February 01, 2013, 12:25:00 AM by retep | [#8](https://bitcointalk.org/index.php?topic=140078.msg1494563#msg1494563) | | --- | --- | --- |  ---   Has anyone tried this on testnet yet?EDIT: and while we're at it, you realize how you're going direct to disclosing this in public, right at a time when Avalon ASIC boxes are being shipped that can mine a block every 2 days on average? Frankly I think this is rather irresponsible of you. I did the whole [responsible disclosure](https://en.wikipedia.org/wiki/Responsible_disclosure) process for the silly little nLockTime oversight I found, and here you are putting everything in public for a problem that's potentially far more serious. The dev team could have easily snuck a fix into the upcoming 0.8 release. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   BTC: [1FCYd7j4CThTMzts78rh6iQJLBRGPW9fWv](http://0bin.net/paste/wZ9ybXwCXlXcIQo5#sENvcsLbkOXIYSWsIVxqyOVIXJeoLv5uqEg-lHtsrrH)  PGP: [7FAB114267E4FA04](http://pool.sks-keyservers.net:11371/pks/lookup?op=vindex&search=0x37EC7D7B0A217CDB4B4E007E7FAB114267E4FA04) | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494654#msg1494654) February 01, 2013, 12:47:00 AM | [#9](https://bitcointalk.org/index.php?topic=140078.msg1494654#msg1494654) | | --- | --- | --- |  ---   Retep:First, when I first published the vulnerability, I thought I wasn't critical. Almost each time I do responsible disclosing (and I did it more than 5 times), the core devs disregard the issues, so I really thought it was another minor vuln. The fact that Gavin disregarded it in this thread means that I would have published it anyway, even after going through the undocumented process of responsible disclosing.Second, after I published the first details, the extension to standard tx would be pretty obvious to anybody willing to think about it a minute.So the best I could do was to tell the truth and protect the network from attackers telling miners to prepare from such attack.Third, anyone willing to invest 100K USD in ASIC will always be able to disrupt the network, so it's no difference before and after this vuln was disclosed.Protecting the network is very easy: don't include non-standard transactions in blocks.My final word is that the **attack is not critical**, nothing to start shouting everywhere, but it's real.Best regards, Sergio. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Gavin Andresen](https://bitcointalk.org/index.php?action=profile;u=224 "View the profile of Gavin Andresen")** Legendary * qt Offline Offline Activity: 1652 Merit: 2317  Chief Scientist   [View Profile](https://bitcointalk.org/index.php?action=profile;u=224) [WWW](http://gavinthink.blogspot.com/?CC9873 "My blog") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494724#msg1494724) February 01, 2013, 01:26:27 AMLast edit: February 01, 2013, 02:14:54 AM by Gavin Andresen | [#10](https://bitcointalk.org/index.php?topic=140078.msg1494724#msg1494724) | | --- | --- | --- |  ---   Sergio:It **would** be more helpful if you either took a little bit more time and actually wrote a little bit of code to make sure the attack works, and started the conversation privately with "here's code that demonstrates a very expensive-to-verify transaction and a few suggestions on how you might fix it..."I created a simulation of TxPrep/TxAttack by adding them to src/test/data/script\_valid.json and then running through the script\_tests.cpp unit test in the debugger, and with the particular TxPrep you propose there is no problem with current code.Also, TxAttack is not standard with the latest code; see CTransaction::AreInputsStandard(), which checks the scriptPubKeys being spent.RE:  undocumented process of responsible disclosing :  good point.  Where would you expect to find the process documented?  We can fix that... | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   How often do you get the chance to work on a potentially world-changing project? | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Luke-Jr](https://bitcointalk.org/index.php?action=profile;u=3318 "View the profile of Luke-Jr")** Legendary * expert Offline Offline Activity: 2576 Merit: 1186   [View Profile](https://bitcointalk.org/index.php?action=profile;u=3318) | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494788#msg1494788) February 01, 2013, 02:02:54 AM | [#11](https://bitcointalk.org/index.php?topic=140078.msg1494788#msg1494788) | | --- | --- | --- |  ---   [Quote from: Sergio\_Demian\_Lerner on February 01, 2013, 12:47:00 AM](https://bitcointalk.org/index.php?topic=140078.msg1494654#msg1494654)Protecting the network is very easy: don't include non-standard transactions in blocks.An attack like this just requires a hostile party to mine 1 block.That's still within reach of most people, even after ASIC hits on full.Blocking out "non-standard" transactions in general just harms potential innovation. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   Donate: (PM me)My projects: [Bitcoin Knots](http://bitcoinknots.org/), [Bitcoin Core](https://bitcoincore.org/), [BFGMiner](https://bitcointalk.org/?topic=626361), [Eloipool (pool software)](https://bitcointalk.org/index.php?topic=61731.0), [Tonal Bitcoin](https://en.bitcoin.it/wiki/Tonal_Bitcoin), and [BitGit (Bitcoin code directory)](http://luke.dashjr.org/programs/bitcoin/) | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494853#msg1494853) February 01, 2013, 03:55:03 AM | [#12](https://bitcointalk.org/index.php?topic=140078.msg1494853#msg1494853) | | --- | --- | --- |  ---   [Quote from: Luke-Jr on February 01, 2013, 02:02:54 AM](https://bitcointalk.org/index.php?topic=140078.msg1494788#msg1494788)[Quote from: Sergio\_Demian\_Lerner on February 01, 2013, 12:47:00 AM](https://bitcointalk.org/index.php?topic=140078.msg1494654#msg1494654)Protecting the network is very easy: don't include non-standard transactions in blocks.An attack like this just requires a hostile party to mine 1 block.That's still within reach of most people, even after ASIC hits on full.Blocking out "non-standard" transactions in general just harms potential innovation.Even if a block containing a 3min tx is ever mined and buried into the blockchain, the 0.9 version of the Satoshi client could just check for the tx hash and, as an exception, set the transaction as verified without actually doing any verifications.As we already have good prevention measures in 0.8, as Gavin said, I really dubt that during the update process a 3min transaction will be mined. The time window is short and the attackers benefit, almost none (for a single tx mined). The real problem starts is if a hundred 3min transactions are mined, not just one.I would say miners have at least a month to upgrade. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494863#msg1494863) February 01, 2013, 04:00:03 AM | [#13](https://bitcointalk.org/index.php?topic=140078.msg1494863#msg1494863) | | --- | --- | --- |  ---   [Quote from: Gavin Andresen on February 01, 2013, 01:26:27 AM](https://bitcointalk.org/index.php?topic=140078.msg1494724#msg1494724)Sergio:It **would** be more helpful if you either took a little bit more time and actually wrote a little bit of code to make sure the attack worksI respect very much all the hard work all the core devs do designing and writing code. I have no time to code, so my contribution is to think. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Sergio\_Demian\_Lerner](https://bitcointalk.org/index.php?action=profile;u=24826 "View the profile of Sergio_Demian_Lerner")** (OP) Hero Member ***** expert Offline Offline Activity: 555 Merit: 654  [View Profile](https://bitcointalk.org/index.php?action=profile;u=24826) [WWW](http://www.certimix.com "Certimix.com") | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1494878#msg1494878) February 01, 2013, 04:10:01 AM | [#14](https://bitcointalk.org/index.php?topic=140078.msg1494878#msg1494878) | | --- | --- | --- |  ---   [Quote from: Gavin Andresen on February 01, 2013, 01:26:27 AM](https://bitcointalk.org/index.php?topic=140078.msg1494724#msg1494724)Also, TxAttack is not standard with the latest code; see CTransaction::AreInputsStandard(), which checks the scriptPubKeys being spent.Great! So, to clear this issue: Gavin stated there is NO WAY OF MAKING TxAttack STANDARD.That's relieving. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Peter Todd](https://bitcointalk.org/index.php?action=profile;u=2546 "View the profile of Peter Todd")** Legendary * expert Offline Offline Activity: 1120 Merit: 1168  [View Profile](https://bitcointalk.org/index.php?action=profile;u=2546) | |  | [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1497510#msg1497510) February 02, 2013, 07:10:02 AM | [#15](https://bitcointalk.org/index.php?topic=140078.msg1497510#msg1497510) | | --- | --- | --- |  ---   [Quote from: Sergio\_Demian\_Lerner on February 01, 2013, 04:00:03 AM](https://bitcointalk.org/index.php?topic=140078.msg1494863#msg1494863)I respect very much all the hard work all the core devs do designing and writing code. I have no time to code, so my contribution is to think.Often coding actually takes less time to solve a problem than just thinking, because by coding you let the computer help you find out if you are wrong much faster than trying to use reason to determine if you are wrong. | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   BTC: [1FCYd7j4CThTMzts78rh6iQJLBRGPW9fWv](http://0bin.net/paste/wZ9ybXwCXlXcIQo5#sENvcsLbkOXIYSWsIVxqyOVIXJeoLv5uqEg-lHtsrrH)  PGP: [7FAB114267E4FA04](http://pool.sks-keyservers.net:11371/pks/lookup?op=vindex&search=0x37EC7D7B0A217CDB4B4E007E7FAB114267E4FA04) | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
| | | **[Luke-Jr](https://bitcointalk.org/index.php?action=profile;u=3318 "View the profile of Luke-Jr")** Legendary * expert Offline Offline Activity: 2576 Merit: 1186   [View Profile](https://bitcointalk.org/index.php?action=profile;u=3318) | |  | ⇾ [Re: New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.msg1566880#msg1566880) February 28, 2013, 06:36:06 AM | [#16](https://bitcointalk.org/index.php?topic=140078.msg1566880#msg1566880) | | --- | --- | --- |  ---   For reference, this is assigned CVE-2013-2292 | | --- | --- | --- | --- | --- | | |  | | | --- | --- | |  |  |  ---   Donate: (PM me)My projects: [Bitcoin Knots](http://bitcoinknots.org/), [Bitcoin Core](https://bitcoincore.org/), [BFGMiner](https://bitcointalk.org/?topic=626361), [Eloipool (pool software)](https://bitcointalk.org/index.php?topic=61731.0), [Tonal Bitcoin](https://en.bitcoin.it/wiki/Tonal_Bitcoin), and [BitGit (Bitcoin code directory)](http://luke.dashjr.org/programs/bitcoin/) | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |
|  |

| Pages: [**1**] | |  | [Print](https://bitcointalk.org/index.php?action=printpage;topic=140078.0) |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- |

| **[Bitcoin Forum](https://bitcointalk.org/index.php)** > **[Bitcoin](https://bitcointalk.org/index.php#1)** > **[Development & Technical Discussion](https://bitcointalk.org/index.php?board=6.0)** > **[New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/index.php?topic=140078.0)** | [« previous topic](https://bitcointalk.org/index.php?topic=140078.0;prev_next=prev#new) [next topic »](https://bitcointalk.org/index.php?topic=140078.0;prev_next=next#new) |
| --- | --- |

|  |
| --- |

Jump to:
Please select a destination:
-----------------------------
Bitcoin
-----------------------------
 => Bitcoin Discussion
 ===> Legal
 ===> Press
 ===> Meetups
 ===> Important Announcements
 => Development & Technical Discussion
 ===> Wallet software
 =====> Electrum
 =====> Bitcoin Wallet for Android
 =====> BitcoinJ
 =====> Armory
 =====> Mycelium
 =====> Hardware wallets
 => Mining
 ===> Mining support
 ===> Pools
 ===> Mining software (miners)
 ===> Hardware
 =====> Group buys
 ===> Mining speculation
 => Bitcoin Technical Support
 => Project Development
-----------------------------
Economy
-----------------------------
 => Economics
 ===> Speculation
 => Marketplace
 ===> Goods
 =====> Computer hardware
 =====> Digital goods
 =======> Invites & Accounts
 =====> Collectibles
 ===> Services
 ===> Currency exchange
 ===> Gambling
 =====> Games and rounds
 =====> Investor-based games
 =====> Gambling discussion
 ===> Lending
 =====> Long-term offers
 ===> Securities
 ===> Auctions
 ===> Service Announcements
 =====> Micro Earnings
 ===> Service Discussion
 =====> Web Wallets
 =====> Exchanges
 => Trading Discussion
 ===> Scam Accusations
 ===> Reputation
-----------------------------
Other
-----------------------------
 => Meta
 ===> New forum software
 ===> Bitcoin Wiki
 => Politics & Society
 => Beginners & Help
 => Off-topic
 => Serious discussion
 ===> Ivory Tower
 => Archival
 ===> Корзина
 ===> CPU/GPU Bitcoin mining hardware
 ===> Chinese students
 ===> Obsolete (buying)
 ===> Obsolete (selling)
 ===> MultiBit
-----------------------------
Alternate cryptocurrencies
-----------------------------
 => Altcoin Discussion
 => Announcements (Altcoins)
 ===> Tokens (Altcoins)
 => Mining (Altcoins)
 ===> Pools (Altcoins)
 => Marketplace (Altcoins)
 ===> Service Announcements (Altcoins)
 ===> Service Discussion (Altcoins)
 ===> Bounties (Altcoins)
 => Speculation (Altcoins)
-----------------------------
Local
-----------------------------
 => العربية (Arabic)
 ===> العملات البديلة (Altcoins)
 =====> النقاشات
 ===> إستفسارات و أسئلة المبتدئين
 ===> التعدين
 ===> النقاشات الأخرى
 ===> منصات التبادل
 => Bahasa Indonesia (Indonesian)
 ===> Marketplace (Bahasa Indonesia)
 ===> Mining (Bahasa Indonesia)
 ===> Altcoins (Bahasa Indonesia)
 ===> Trading dan Spekulasi
 ===> Ekonomi, Politik, dan Budaya
 ===> Topik Lainnya
 => Español (Spanish)
 ===> Mercado y Economía
 =====> Servicios
 =====> Trading y especulación
 ===> Hardware y Minería
 ===> Esquina Libre
 ===> Mercadillo
 =====> Mexico
 =====> Argentina
 =====> España
 =====> Centroamerica y Caribe
 ===> Primeros pasos y ayuda
 ===> Altcoins (criptomonedas alternativas)
 =====> Minería de altcoins
 =====> Servicios
 =====> Tokens (Español)
 => 中文 (Chinese)
 ===> 跳蚤市场
 ===> 山寨币
 ===> 媒体
 ===> 挖矿
 ===> 离题万里
 => Hrvatski (Croatian)
 ===> Trgovina
 ===> Altcoins (Hrvatski)
 =====> Announcements (Hrvatski)
 ===> Off-topic (Hrvatski)
 => Deutsch (German)
 ===> Anfänger und Hilfe
 ===> Mining (Deutsch)
 ===> Trading und Spekulation
 ===> Projektentwicklung
 ===> Off-Topic (Deutsch)
 ===> Treffen
 ===> Presse
 ===> Altcoins (Deutsch)
 =====> Announcements (Deutsch)
 ===> Marktplatz
 =====> Auktionen
 =====> Suche
 =====> Biete
 => Ελληνικά (Greek)
 ===> Αγορά
 ===> Mining Discussion (Ελληνικά)
 ===> Altcoins (Ελληνικά)
 =====> Altcoin Announcements (Ελληνικά)
 =====> Altcoin Mining (Ελληνικά)
 => עברית (Hebrew)
 => Français
 ===> Actualité et News
 ===> Débutants
 ===> Discussions générales et utilisation du Bitcoin
 ===> Mining et Hardware
 ===> Économie et spéculation
 ===> Place de marché
 =====> Échanges
 =====> Produits et services
 =====> Petites annonces
 ===> Le Bitcoin et la loi
 ===> Wiki, documentation et traduction
 ===> Développement et technique
 ===> Vos sites et projets
 ===> Hors-sujet
 ===> Altcoins (Français)
 =====> Annonces
 => India
 ===> Mining (India)
 ===> Marketplace (India)
 ===> Regional Languages (India)
 ===> Press & News from India
 ===> Alt Coins (India)
 ===> Buyer/ Seller Reputations (India)
 ===> Off-Topic (India)
 => Italiano (Italian)
 ===> Guide (Italiano)
 ===> Progetti
 ===> Discussioni avanzate e sviluppo
 ===> Trading, analisi e speculazione
 ===> Mercato
 =====> Mercato valute
 =====> Beni
 =====> Servizi
 =====> Esercizi commerciali
 =====> Hardware/Mining (Italiano)
 =====> Gambling (Italiano)
 ===> Accuse scam/truffe
 ===> Mining (Italiano)
 ===> Alt-Currencies (Italiano)
 =====> Annunci
 ===> Raduni/Meeting (Italiano)
 ===> Crittografia e decentralizzazione
 ===> Off-Topic (Italiano)
 => 日本語 (Japanese)
 ===> アルトコイン
 => Nederlands (Dutch)
 ===> Markt
 ===> Gokken/lotterijen
 ===> Mining (Nederlands)
 ===> Beurzen
 ===> Alt Coins (Nederlands)
 ===> Off-topic (Nederlands)
 ===> Meetings (Nederlands)
 => Nigeria (Naija)
 ===> Politics and society (Naija)
 ===> Off-topic (Naija)
 => 한국어 (Korean)
 ===> 대체코인 Alt Coins (한국어)
 => Pilipinas
 ===> Altcoins (Pilipinas)
 =====> Altcoin Announcements (Pilipinas)
 ===> Pamilihan
 ===> Others (Pilipinas)
 => Polski
 ===> Tablica ogłoszeń
 ===> Alternatywne kryptowaluty
 =====> Nowe kryptowaluty i tokeny
 =====> Tablica ogłoszeń (altcoiny)
 => Português (Portuguese)
 ===> Primeiros Passos (Iniciantes)
 ===> Economia & Mercado
 ===> Mineração em Geral
 ===> Desenvolvimento & Discussões Técnicas
 ===> Criptomoedas Alternativas
 ===> Brasil
 ===> Portugal
 => Русский (Russian)
 ===> Новички
 ===> Бизнес
 =====> Барахолка
 =====> Обменники
 ===> Идеи
 ===> Кодеры
 ===> Майнеры
 ===> Политика
 ===> Трейдеры
 ===> Альтернативные криптовалюты
 =====> Токены
 =====> Бayнти и aиpдpoпы
 ===> Хайпы
 ===> Работа
 ===> Разное
 ===> Oбcyждeниe Bitcoin
 =====> Новости
 =====> Юристы
 => Română (Romanian)
 ===> Anunturi importante
 ===> Offtopic
 ===> Market
 =====> Discutii Servicii
 ===> Minerit
 ===> Tutoriale
 ===> Bine ai venit!
 ===> Presa
 ===> Altcoins (Monede Alternative)
 =====> Anunturi Monede Alternative
 => Skandinavisk
 => Türkçe (Turkish)
 ===> Bitcoin Haberleri
 ===> Pazar Alanı
 ===> Madencilik
 ===> Ekonomi
 ===> Servisler
 =====> Fonlar
 ===> Proje Geliştirme
 ===> Alternatif Kripto-Paralar
 =====> Madencilik (Alternatif Kripto-Paralar)
 =====> Duyurular (Alternatif Kripto-Paralar)
 ===> Konu Dışı
 ===> Yeni Başlayanlar & Yardım
 ===> Buluşmalar
 => Other languages/locations

| [Powered by MySQL](http://www.mysql.com/) [Powered by PHP](http://www.php.net/) | [Powered by SMF 1.1.19](http://www.simplemachines.org/ "Simple Machines Forum") | [SMF © 2006-2009, Simple Machines](http://www.simplemachines.org/about/copyright.php "Free Forum Software") | [Valid XHTML 1.0!](http://validator.w3.org/check/referer) [Valid CSS!](http://jigsaw.w3.org/css-validator/check/referer) |
| --- | --- | --- |

Loading...


=== Content from bitcoincore.org_ea265122_20250126_101358.html ===


[![bitcoin core logo](/assets/images/bitcoin_core_logo_colored_reversed.png)](/)

* [About](/en/about/)
* [Download](/en/download)
* [blog](/en/blog/)
* [releases](/en/releases/)
* Development
  + [contribute](/en/contribute/)
  + [contributing code](/en/faq/contributing-code/)
  + [meetings](/en/meetings/)
  + [Lifecycle](/en/lifecycle)
  + [Security Advisories](/en/security-advisories/)
  + [RPC Docs](/en/doc/)
    - [28.0.0](/en/doc/28.0.0/)
    - [27.0.0](/en/doc/27.0.0/)
    - [26.0.0](/en/doc/26.0.0/)
    - [25.0.0](/en/doc/25.0.0/)
    - [24.0.0](/en/doc/24.0.0/)
    - [23.0.0](/en/doc/23.0.0/)
    - [22.0.0](/en/doc/22.0.0/)
    - [0.21.0](/en/doc/0.21.0/)
    - [0.20.0](/en/doc/0.20.0/)
    - [0.19.0](/en/doc/0.19.0/)
    - [0.18.0](/en/doc/0.18.0/)
    - [0.17.0](/en/doc/0.17.0/)
    - [0.16.3](/en/doc/0.16.3/)
    - [0.16.2](/en/doc/0.16.2/)
    - [0.16.1](/en/doc/0.16.1/)
    - [0.16.0](/en/doc/0.16.0/)
* Contact
  + [Contact Us](/en/contact/)
  + [Announcements](/en/list/announcements/join/)
  + [Twitter impersonation](/en/twitter-impersonation)
* English
  EspaÃ±ol
  æ¥æ¬èª
  ç®ä½ä¸­æ
  ç¹é«ä¸­æ

### [Recent Posts](/en/blog/)

## [Bitcoin Core 28.1 released](/en/2025/01/09/release-28.1/ "Bitcoin Core 28.1 released")

Bitcoin Core 28.1 is now available.

Published on January 09, 2025

## [Disclosure of hindered block propagation due to stalling peers](/en/2024/11/05/cb-stall-hindering-propagation/ "Disclosure of hindered block propagation due to stalling peers")

A peer could hinder block propagation by announcing blocks first and then simply withholding the block.

Published on November 05, 2024

## [Bitcoin Core 27.2 released](/en/2024/11/04/release-27.2/ "Bitcoin Core 27.2 released")

Bitcoin Core 27.2 is now available.

Published on November 04, 2024

## [Disclosure of CVE-2024-35202](/en/2024/10/08/disclose-blocktxn-crash/ "Disclosure of CVE-2024-35202")

An attacker could remotely crash a Bitcoin Core node by triggering an assertion in the blocktxn message handling logic.

Published on October 08, 2024

## [Disclosure of DoS due to inv-to-send sets growing too large](/en/2024/10/08/disclose-large-inv-to-send/ "Disclosure of DoS due to inv-to-send sets growing too large")

The inv-to-send sets could grow too large to a point where the time spent sorting the sets would affect the nodeâs ability to communicate with its peers.

Published on October 08, 2024

[Twitter](https://twitter.com/bitcoincoreorg)

[Legal](/en/legal/) | [Privacy Policy](/en/legal/privacy) | [RSS ![rss feeds](/assets/images/rss-24x24.png)](/en/rss/)

![bitcoin core logo](/assets/images/bitcoin_core_logo.png)

© 2025 Bitcoin Core


