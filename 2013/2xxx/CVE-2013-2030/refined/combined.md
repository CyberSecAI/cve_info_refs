=== Content from access.redhat.com_f8978915_20250126_055646.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.openwall.com_71f2dc34_20250125_042159.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <518BBDA0.7040008@openstack.org>
Date: Thu, 09 May 2013 17:15:44 +0200
From: Thierry Carrez <thierry@...nstack.org>
To: "openstack@...ts.launchpad.net" <openstack@...ts.launchpad.net>,
 oss-security@...ts.openwall.com, openstack-announce@...ts.openstack.org
Subject: [OSSA 2013-010] Nova uses insecure keystone middleware tmpdir by
 default (CVE-2013-2030)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

OpenStack Security Advisory: 2013-010
CVE: CVE-2013-2030
Date: May 9, 2013
Title: Nova uses insecure keystone middleware tmpdir by default
Reporter: Grant Murphy (Red Hat), Anton Lundin
Products: Nova
Affects: Folsom, Grizzly

Description:
Grant Murphy from Red Hat and Anton Lundin both independently reported a
vulnerability in Nova's default location for the Keystone middleware
signing directory (signing_dir). By previously setting up a malicious
directory structure, an attacker with local shell access on the Nova
node could potentially issue forged tokens that would be accepted by the
middleware. Only setups that use the default value for signing_dir are
affected. Note that future versions of the Keystone middleware will
issue a warning if an insecure signing directory is used.

Havana (development branch) fix:
<https://review.openstack.org/#/c/28568/>

Grizzly fix:
<https://review.openstack.org/#/c/28569/>

Folsom fix:
<https://review.openstack.org/#/c/28570/>

References:
[https://bugs.launchpad.net/nova/+bug/1174608](https://bugs.launchpad.net/nova/%2Bbug/1174608)
<http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2013-2030>

- --
Thierry Carrez (ttx)
OpenStack Vulnerability Management Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
Comment: Using GnuPG with undefined - <http://www.enigmail.net/>

iQIcBAEBCAAGBQJRi72dAAoJEFB6+JAlsQQjJZAQAJ5w/+BoBD4em8YklBsxU6wU
Bn1wWu3W5ngCNuHwr4ydWzC3U1TT1zWtogWJpv/+87m2KPESWhs7YGCkTIE9tLpA
sNOniOG9hGUsWwRgtUqjA8/8QzLgbNJ/PDJx0lrNPNkvMbHwP/jxotx353edhelQ
QAPJwVPBqu0vn2VZOeFWYNO/AnWNcjTXE0po92qaFvw3HWL3ykMd30w4Ejxv9clC
VjBjaNkReSkmcd/BaArtr1IenyYyVqM7nv/VWl5O5Up02+uvAozDmy6Cyc1O5VOW
6m9nRH2WKE/bFXcTEG4rpH+/BZxG2RuyklUBvVtSaEAQOWYFSwQKzjxGM3rItsWt
iuQYrakl6H69tRS3HS9pAXWdxSikSb8CqmVJauf3RG1/EQ7GtCO0kXVPi8fYBaTX
GpLmpY8bj6o2iY1Kh1bozZ2oYVLgPrhP2R4oj+4iaSN++gy2qs0d3AvIK0BzBKT+
fd7wAUpdxltM9eZS82VEQxIaOGUDqnGompEu3nPRv9KD5kZqgz/L/jp5I+PR3y1D
Uaj8W+FfF/AZtMRLJHl3I0kUHRhfuIusir5zja7UCoR6UEeipLvBzbi/DSGfBCRY
/VbBv9ZZBeQ+Kw4EwS4/7G5nw1RX4/bKGSi0zcwwmD2unB7Plm9MjI65yR4oFidl
uOpCYFwNk6PqCFED/mCz
=wjZ/
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugs.launchpad.net_e5d00fcc_20250125_042200.html ===

[Log in / Register](https://bugs.launchpad.net/nova/%2Bbug/1174608/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* [Translations](https://translations.launchpad.net/nova)
* [Answers](https://answers.launchpad.net/nova)

# [OSSA 2013-010] Insecure directory creation for signing

Bug #1174608 reported by
[Kurt Seifried](https://launchpad.net/~kseifried)
on 2013-04-30

[278](/%2Bhelp-bugs/bug-heat.html)

This bug affects 2 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Compute (nova)](https://bugs.launchpad.net/nova) | Fix Released | High | [Russell Bryant](https://launchpad.net/~russellb) | [OpenStack Compute (nova) 2013.2 "havana"](https://launchpad.net/nova/%2Bmilestone/2013.2) |
|  | [Grizzly](https://bugs.launchpad.net/nova/grizzly) | Fix Released | High | [Russell Bryant](https://launchpad.net/~russellb) | [OpenStack Compute (nova) 2013.1.1](https://launchpad.net/nova/%2Bmilestone/2013.1.1) |
|  | [OpenStack Identity (keystone)](https://bugs.launchpad.net/keystone) | Invalid | Undecided | Unassigned |  |
|  | [Folsom](https://bugs.launchpad.net/keystone/folsom) | Fix Released | Medium | [Alan Pevec](https://launchpad.net/~apevec) |  |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | Undecided | [Thierry Carrez](https://launchpad.net/~ttx) |  |
|  | [python-keystoneclient](https://bugs.launchpad.net/python-keystoneclient) | Fix Released | Medium | [Dolph Mathews](https://launchpad.net/~dolph) | [python-keystoneclient 0.2.4](https://launchpad.net/python-keystoneclient/%2Bmilestone/0.2.4) |

### Bug Description

Originally found by Grant Murphy (<email address hidden>):

The signing directory is used to store the signing certificates

and the default location for this directory is:

signing\_dir = /tmp/keystone-signing-nova

In the file:

keystone/middleware/auth\_token.py

During the initialization of the AuthMiddleware the following operations are made for the signing directory:

IF the directory exists but cannot be written to a configuration error is raised.

    ELSE IF the directory doesn't exist, create it.

    NEXT chmod permisions(stat.S\_IRWXU) to the signing\_directory

AFAICT The signing certificates used in validation will only be fetched from the keystone if the cms\_verify action raises an exception because the certificate file is missing from the signing directory.

This means that if an attacker populated the /tmp/keystone-signing-nova

with the appropriate files for signautre verification they could potentially

issue forged tokens which would be validated by the middleware. As:

    - The directory location deterministic. (default for glance, nova)

    - \*If the directory already exists it is reused\*

Tags:

[security](/nova/%2Bbugs?field.tag=security)

## CVE References

* [2013-2030](/bugs/cve/2013-2030 "keystone/middleware/auth_token.py in ...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alan Pevec (apevec)](https://launchpad.net/~apevec) wrote on 2013-04-30: |  |  | [#1](/nova/%2Bbug/1174608/comments/1) |
| --- | --- | --- | --- |

> and the default location for this directory is:

> signing\_dir = /tmp/keystone-signing-nova

It is not, that happens to be default in Fedora's nova.conf

  <http://pkgs.fedoraproject.org/cgit/openstack-nova.git/tree/nova.conf#n27>

Default in authtoken middleware code (now located in python-keystoneclient) is ~/keystone-signing and normally homedir of the user account running the application (where authtoken m/w is inserted) should not be world-writable.

> and the default location for this directory is:
> signing\_dir = /tmp/keystone-signing-nova
It is not, that happens to be default in Fedora's nova.conf
http://pkgs.fedoraproject.org/cgit/openstack-nova.git/tree/nova.conf#n27
Default in authtoken middleware code (now located in python-keystoneclient) is ~/keystone-signing and normally homedir of the user account running the application (where authtoken m/w is inserted) should not be world-writable.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Alan Pevec (apevec)](https://launchpad.net/~apevec) wrote on 2013-04-30: |  |  | [#2](/nova/%2Bbug/1174608/comments/2) |
| --- | --- | --- | --- |

ok, it's also in sample nova api-paste.ini

<https://github.com/openstack/nova/blob/master/etc/nova/api-paste.ini#L107>

That line should be removed so that default in code applies.

ok, it's also in sample nova api-paste.ini
https://github.com/openstack/nova/blob/master/etc/nova/api-paste.ini#L107
That line should be removed so that default in code applies.

| **affects**: | keystone → nova |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-04-30: |  |  | [#3](/nova/%2Bbug/1174608/comments/3) |
| --- | --- | --- | --- |

Ew. One would think that everyone knows that naming stuff under /tmp is bad, by now.

Adding Dolph and Russell for further discussion.

On upgrade, removing the default value will not make those who copied api-paste.ini magically secure, so I'd rather (or in addition) fix the temporary directory creation.

Ew. One would think that everyone knows that naming stuff under /tmp is bad, by now.
Adding Dolph and Russell for further discussion.
On upgrade, removing the default value will not make those who copied api-paste.ini magically secure, so I'd rather (or in addition) fix the temporary directory creation.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-04-30: |  |  | [#4](/nova/%2Bbug/1174608/comments/4) |
| --- | --- | --- | --- |

(i.e. not just check that you can write to it, but check that you actually own it)

(i.e. not just check that you can write to it, but check that you actually own it)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-04-30: |  |  | [#5](/nova/%2Bbug/1174608/comments/5) |
| --- | --- | --- | --- |

FTR

cinder: signing\_dir = /var/lib/cinder

quantum: signing\_dir = /var/lib/quantum/keystone-signing

Everyone else doesn't seem to have that option.

FTR
cinder: signing\_dir = /var/lib/cinder
quantum: signing\_dir = /var/lib/quantum/keystone-signing
Everyone else doesn't seem to have that option.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Russell Bryant (russellb)](https://launchpad.net/~russellb) wrote on 2013-05-01: |  |  | [#8](/nova/%2Bbug/1174608/comments/8) |
| --- | --- | --- | --- |

* [0001-Remove-insecure-default-for-signing\_dir-option.patch](https://bugs.launchpad.net/nova/%2Bbug/1174608/%2Battachment/3661488/%2Bfiles/0001-Remove-insecure-default-for-signing_dir-option.patch)
  [Edit](/nova/%2Bbug/1174608/%2Battachment/3661488)
  (1.3 KiB,
  text/plain)

Attached a patch for the nova side of this that we can push at the same time as the authtoken middleware changes discussed here.

Attached a patch for the nova side of this that we can push at the same time as the authtoken middleware changes discussed here.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dolph Mathews (dolph)](https://launchpad.net/~dolph) wrote on 2013-05-01: |  |  | [#9](/nova/%2Bbug/1174608/comments/9) |
| --- | --- | --- | --- |

* [bug-1174608-v1](https://bugs.launchpad.net/nova/%2Bbug/1174608/%2Battachment/3661730/%2Bfiles/bug-1174608-v1)
  [Edit](/nova/%2Bbug/1174608/%2Battachment/3661730)
  (1.8 KiB,
  text/plain)

Two additional issues with the signing\_dir code in keystoneclient:

- there's a race condition when a new signing dir is created with default permissions before they're set to 0700

- even if an existing directory is owned by the executing user, it may be globally writable before keystoneclient chmods it

The attached patch fixes these issues (including ttx's suggestion) but fails unit testing because they use a signing\_dir w/ 0755. Feedback/review on the fix itself appreciated in the mean time.

I also think this should move to oslo.fileutils eventually.

Two additional issues with the signing\_dir code in keystoneclient:
- there's a race condition when a new signing dir is created with default permissions before they're set to 0700
- even if an existing directory is owned by the executing user, it may be globally writable before keystoneclient chmods it
The attached patch fixes these issues (including ttx's suggestion) but fails unit testing because they use a signing\_dir w/ 0755. Feedback/review on the fix itself appreciated in the mean time.
I also think this should move to oslo.fileutils eventually.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kurt Seifried (kseifried)](https://launchpad.net/~kseifried) wrote on 2013-05-02: |  |  | [#10](/nova/%2Bbug/1174608/comments/10) |
| --- | --- | --- | --- |

So no patch yet, do we have an ETA on one?

So no patch yet, do we have an ETA on one?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-05-02: |  |  | [#11](/nova/%2Bbug/1174608/comments/11) |
| --- | --- | --- | --- |

Kurt: I am not sure we nailed the correct way to fix that yet.

Dolph: I see two issues with the proposed patch

(1) it can break existing setups on upgrade (for people using an open directory)

(2) there is still a TOCTOU race that make it still potentially exploitable (even if unlikely)

The trick with creating directories in code in areas specified by the user and wanting to enforce permissions on that location is that it's actually quite difficult to do :) Alternatives include:

\* use a subdirectory of a directory that is assumed safe (/var/lib/nova)

\* rely on the packaging / deployer to create the directory they specify, with the right permissions (you can still issue a warning if they got the permissions wrong)

\* pure (but unpredictable) /tmp directory atomic creation using Python tempfile module

Kurt: any suggestion on how to do this right ?

Kurt: I am not sure we nailed the correct way to fix that yet.
Dolph: I see two issues with the proposed patch
(1) it can break existing setups on upgrade (for people using an open directory)
(2) there is still a TOCTOU race that make it still potentially exploitable (even if unlikely)
The trick with creating directories in code in areas specified by the user and wanting to enforce permissions on that location is that it's actually quite difficult to do :) Alternatives include:
\* use a subdirectory of a directory that is assumed safe (/var/lib/nova)
\* rely on the packaging / deployer to create the directory they specify, with the right permissions (you can still issue a warning if they got the permissions wrong)
\* pure (but unpredictable) /tmp directory atomic creation using Python tempfile module
Kurt: any suggestion on how to do this right ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-05-02: |  |  | [#12](/nova/%2Bbug/1174608/comments/12) |
| --- | --- | --- | --- |

Adding Rob Clark for suggestions

Adding Rob Clark for suggestions

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Clark (robert-clark)](https://launchpad.net/~robert-clark) wrote on 2013-05-02: |  |  | [#13](/nova/%2Bbug/1174608/comments/13) |
| --- | --- | --- | --- |

I think ttx describes the the issue with the fix quite well, TOCTOU is tricky.

I'd be inclined to go with either the first option, subdir in a known-safe location - where known safe really seems to mean: 'if this is screwed, everything screwed anyway'.

Or go with the second option, putting this in the hands of deployers. If the second option was preferable I'd be happy to cut an OSSN for the issue.

I think ttx describes the the issue with the fix quite well, TOCTOU is tricky.
I'd be inclined to go with either the first option, subdir in a known-safe location - where known safe really seems to mean: 'if this is screwed, everything screwed anyway'.
Or go with the second option, putting this in the hands of deployers. If the second option was preferable I'd be happy to cut an OSSN for the issue.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dolph Mathews (dolph)](https://launchpad.net/~dolph) wrote on 2013-05-02: |  |  | [#14](/nova/%2Bbug/1174608/comments/14) |
| --- | --- | --- | --- |

* [bug-1174608-v2](https://bugs.launchpad.net/nova/%2Bbug/1174608/%2Battachment/3662715/%2Bfiles/bug-1174608-v2)
  [Edit](/nova/%2Bbug/1174608/%2Battachment/3662715)
  (1.8 KiB,
  text/plain)

With Russel's patch to nova and defaulting signing\_dir to ~/keystone-signing in keystoneclient, I think ttx's first suggestion is covered.

Changing the keystoneclient patch to simply log warnings if the signing\_dir's owner or permissions have unexpected values satisfies the second suggestion (see attached, which no longer needs any update to the test framework).

With Russel's patch to nova and defaulting signing\_dir to ~/keystone-signing in keystoneclient, I think ttx's first suggestion is covered.
Changing the keystoneclient patch to simply log warnings if the signing\_dir's owner or permissions have unexpected values satisfies the second suggestion (see attached, which no longer needs any update to the test framework).

| Changed in python-keystoneclient: | |
| --- | --- |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-05-02: |  |  | [#15](/nova/%2Bbug/1174608/comments/15) |
| --- | --- | --- | --- |

I think that's the right trade-off. Changing the default will fix it for new users, printing the warning in the log will alert existing vulnerable users but won't break them on upgrade, and we suppose that the parameter given is a correctly-owned directory.

Even the TOCTOU race seems closed since os.makedirs fails if the directory exists.

I think that's the right trade-off. Changing the default will fix it for new users, printing the warning in the log will alert existing vulnerable users but won't break them on upgrade, and we suppose that the parameter given is a correctly-owned directory.
Even the TOCTOU race seems closed since os.makedirs fails if the directory exists.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-05-03: |  |  | [#16](/nova/%2Bbug/1174608/comments/16) |
| --- | --- | --- | --- |

Adding Keystone core and Nova core...

Please review proposed patches (comment #8 for Nova and comment #14 for python-keystoneclient) and +1 them on the bug if you're happy with them.

Adding Keystone core and Nova core...
Please review proposed patches (comment #8 for Nova and comment #14 for python-keystoneclient) and +1 them on the bug if you're happy with them.

| Changed in python-keystoneclient: | |
| --- | --- |
| **importance**: | Undecided → Medium |
| Changed in nova: | |
| **status**: | New → Confirmed |
| **importance**: | Undecided → High |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-05-03: |  |  | [#17](/nova/%2Bbug/1174608/comments/17) |
| --- | --- | --- | --- |

I'd tend to consider this is a vulnerability in Nova, and the python-keystoneclient fix is more a strengthening thing (warn when the configuration is insecure)

I'd tend to consider this is a vulnerability in Nova, and the python-keystoneclient fix is more a strengthening thing (warn when the configuration is insecure)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Michael Still (mikal)](https://launchpad.net/~mikal) wrote on 2013-05-03: |  |  | [#18](/nova/%2Bbug/1174608/comments/18) |
| --- | --- | --- | --- |

nova patch looks good to me.

nova patch looks good to me.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-05-06: |  |  | [#19](/nova/%2Bbug/1174608/comments/19) |
| --- | --- | --- | --- |

Please review proposed impact description:

========================

Title: Nova uses insecure keystone middleware tmpdir by default

Reporter: Grant Murphy (Red Hat)

Products: Nova

Affects: All versions

Description:

Grant Murphy from Red Hat reported a vulnerability in Nova default location for the Keystone middleware signing directory (signing\_dir). By previously setting up a malicious directory structure, an attacker with local shell access on the Nova node could potentially issue forged tokens that would be accepted by the middleware. Only setups that use the default value for signing\_dir are affected. Note that future versions of the Keystone middleware will issue a warning if an insecure signing directory is used.

=========================

Please review proposed impact description:
========================
Title: Nova uses insecure keystone middleware tmpdir by default
Reporter: Grant Murphy (Red Hat)
Products: Nova
Affects: All versions
Description:
Grant Murphy from Red Hat reported a vulnerability in Nova default location for the Keystone middleware signing directory (signing\_dir). By previously setting up a malicious directory structure, an attacker with local shell access on the Nova node could potentially issue forged tokens that would be accepted by the middleware. Only setups that use the default value for signing\_dir are affected. Note that future versions of the Keystone middleware will issue a warning if an insecure signing directory is used.
=========================

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Michael Still (mikal)](https://launchpad.net/~mikal) wrote on 2013-05-07: |  |  | [#20](/nova/%2Bbug/1174608/comments/20) |
| --- | --- | --- | --- |

Looks good to me.

Looks good to me.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kurt Seifried (kseifried)](https://launchpad.net/~kseifried) wrote on 2013-05-07: |  |  | [#21](/nova/%2Bbug/1174608/comments/21) |
| --- | --- | --- | --- |

What do we want to set the embargo to on this one? Say May 13, 2013, 15:00 UTC?

What do we want to set the embargo to on this one? Say May 13, 2013, 15:00 UTC?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dolph Mathews (dolph)](https://launchpad.net/~dolph) wrote on 2013-05-07: |  |  | [#22](/nova/%2Bbug/1174608/comments/22) |
| --- | --- | --- | --- |

description lgtm

description lgtm

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-05-08: |  |  | [#23](/nova/%2Bbug/1174608/comments/23) |
| --- | --- | --- | --- |

Hmm, looks like it was independently reported publicly at [bug 1177681](/bugs/1177681)

I propose we open this bug, push the patches publicly, and issue the OSSA as soon as possible. I'll send an early notice to downstream stakeholders today. Let me know if that worls for you all.

Hmm, looks like it was independently reported publicly at bug 1177681
I propose we open this bug, push the patches publicly, and issue the OSSA as soon as possible. I'll send an early notice to downstream stakeholders today. Let me know if that worls for you all.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-05-08: |  |  | [#24](/nova/%2Bbug/1174608/comments/24) |
| --- | --- | --- | --- |

@glance-acc: Do you want to be credited for co-discovery ? Which name (and optionally company) would you want us to add to the advisory (see draft in comment #19)

@glance-acc: Do you want to be credited for co-discovery ? Which name (and optionally company) would you want us to add to the advisory (see draft in comment #19)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [glance (glance-acc)](https://launchpad.net/~glance-acc) wrote on 2013-05-08: |  |  | [#25](/nova/%2Bbug/1174608/comments/25) |
| --- | --- | --- | --- |

My name is Anton Lundin and this work was done independently. Credits are always nice.

Sorry for not clicking the "Security" button when reporting. I thought it was quite minor as access to nova hosts ain't that common for non-admin users anyway.

My name is Anton Lundin and this work was done independently. Credits are always nice.
Sorry for not clicking the "Security" button when reporting. I thought it was quite minor as access to nova hosts ain't that common for non-admin users anyway.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-05-08: |  |  | [#26](/nova/%2Bbug/1174608/comments/26) |
| --- | --- | --- | --- |

OK, will add credit. FTR the issue was introduced in the Folsom cycle, so this doesn't affect Essex

OK, will add credit. FTR the issue was introduced in the Folsom cycle, so this doesn't affect Essex

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-05-08

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-05-08:  [**Fix proposed to nova (master)**](/nova/%2Bbug/1174608/comments/27) |  |  | [#27](/nova/%2Bbug/1174608/comments/27) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/28568>

Fix proposed to branch: master
Review: https://review.openstack.org/28568

| Changed in nova: | |
| --- | --- |
| **assignee**: | nobody → Russell Bryant (russellb) |
| **status**: | Confirmed → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-05-08:  [**Fix proposed to nova (stable/grizzly)**](/nova/%2Bbug/1174608/comments/28) |  |  | [#28](/nova/%2Bbug/1174608/comments/28) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/grizzly

Review: <https://review.openstack.org/28569>

Fix proposed to branch: stable/grizzly
Review: https://review.openstack.org/28569

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-05-08:  [**Fix proposed to nova (stable/folsom)**](/nova/%2Bbug/1174608/comments/29) |  |  | [#29](/nova/%2Bbug/1174608/comments/29) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/folsom

Review: <https://review.openstack.org/28570>

Fix proposed to branch: stable/folsom
Review: https://review.openstack.org/28570

| Changed in python-keystoneclient: | |
| --- | --- |
| **assignee**: | nobody → Dolph Mathews (dolph) |
| **status**: | Confirmed → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-05-08:  [**Fix proposed to python-keystoneclient (master)**](/nova/%2Bbug/1174608/comments/30) |  |  | [#30](/nova/%2Bbug/1174608/comments/30) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/28572>

Fix proposed to branch: master
Review: https://review.openstack.org/28572

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-05-08:  [**Re: Insecure directory creation for signing**](/nova/%2Bbug/1174608/comments/31) |  |  | [#31](/nova/%2Bbug/1174608/comments/31) |
| --- | --- | --- | --- |

Will push the OSSA tomorrow

Will push the OSSA tomorrow

[Alan Pevec (apevec)](https://launchpad.net/~apevec)
on 2013-05-08

| Changed in keystone: | |
| --- | --- |
| **status**: | New → Invalid |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-05-08:  [**Fix proposed to keystone (stable/folsom)**](/nova/%2Bbug/1174608/comments/32) |  |  | [#32](/nova/%2Bbug/1174608/comments/32) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/folsom

Review: <https://review.openstack.org/28577>

Fix proposed to branch: stable/folsom
Review: https://review.openstack.org/28577

| Changed in python-keystoneclient: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-05-08:  [**Fix merged to python-keystoneclient (master)**](/nova/%2Bbug/1174608/comments/33) |  |  | [#33](/nova/%2Bbug/1174608/comments/33) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/28572>

Committed: <http://github.com/openstack/python-keystoneclient/commit/1736e2ffb12f70eeebed019448bc14def48aa036>

Submitter: Jenkins

Branch: master

commit 1736e2ffb12f70eeebed019448bc14def48aa036

Author: Dolph Mathews <email address hidden>

Date: Wed May 8 10:49:20 2013 -0500

Securely create signing\_dir ([bug 1174608](/bugs/1174608))

Also verifies the security of an existing signing\_dir.

Change-Id: I0685b4274a94ad3974a2b2a7ab3f45830d3934bb

Reviewed: https://review.openstack.org/28572
Committed: http://github.com/openstack/python-keystoneclient/commit/1736e2ffb12f70eeebed019448bc14def48aa036
Submitter: Jenkins
Branch: master
commit 1736e2ffb12f70eeebed019448bc14def48aa036
Author: Dolph Mathews <dolph.mathews@gmail.com>
Date: Wed May 8 10:49:20 2013 -0500
Securely create signing\_dir (bug 1174608)
Also verifies the security of an existing signing\_dir.
Change-Id: I0685b4274a94ad3974a2b2a7ab3f45830d3934bb

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-05-08:  [**Fix merged to nova (stable/folsom)**](/nova/%2Bbug/1174608/comments/34) |  |  | [#34](/nova/%2Bbug/1174608/comments/34) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/28570>

Committed: <http://github.com/openstack/nova/commit/74aa04e2ca7942cb1e1a86dcbaffeb72d260ccd7>

Submitter: Jenkins

Branch: stable/folsom

commit 74aa04e2ca7942cb1e1a86dcbaffeb72d260ccd7

Author: Russell Bryant <email address hidden>

Date: Wed May 1 09:41:57 2013 -0400

Remove insecure default for signing\_dir option.

The sample api-paste.ini file included an insecure value for the

    signing\_dir option for the keystone authtoken middleware. Comment out

    the option so that we just rely on the default behavior by default.

Fix [bug 1174608](/bugs/1174608).

Conflicts:

     etc/nova/api-paste.ini

Change-Id: I6189788953d789c34456bbe150b8ed6ce6f68403

    (cherry picked from commit 58d6879b1caaa750c39c8e452a0634c24ffef2ce)

Reviewed: https://review.openstack.org/28570
Committed: http://github.com/openstack/nova/commit/74aa04e2ca7942cb1e1a86dcbaffeb72d260ccd7
Submitter: Jenkins
Branch: stable/folsom
commit 74aa04e2ca7942cb1e1a86dcbaffeb72d260ccd7
Author: Russell Bryant <rbryant@redhat.com>
Date: Wed May 1 09:41:57 2013 -0400
Remove insecure default for signing\_dir option.
The sample api-paste.ini file included an insecure value for the
signing\_dir option for the keystone authtoken middleware. Comment out
the option so that we just rely on the default behavior by default.
Fix bug 1174608.
Conflicts:
etc/nova/api-paste.ini
Change-Id: I6189788953d789c34456bbe150b8ed6ce6f68403
(cherry picked from commit 58d6879b1caaa750c39c8e452a0634c24ffef2ce)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-05-08:  [**Fix merged to nova (master)**](/nova/%2Bbug/1174608/comments/35) |  |  | [#35](/nova/%2Bbug/1174608/comments/35) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/28568>

Committed: <http://github.com/openstack/nova/commit/58d6879b1caaa750c39c8e452a0634c24ffef2ce>

Submitter: Jenkins

Branch: master

commit 58d6879b1caaa750c39c8e452a0634c24ffef2ce

Author: Russell Bryant <email address hidden>

Date: Wed May 1 09:41:57 2013 -0400

Remove insecure default for signing\_dir option.

The sample api-paste.ini file included an insecure value for the

    signing\_dir option for the keystone authtoken middleware. Comment out

    the option so that we just rely on the default behavior by default.

Fix [bug 1174608](/bugs/1174608).

Change-Id: I6189788953d789c34456bbe150b8ed6ce6f68403

Reviewed: https://review.openstack.org/28568
Committed: http://github.com/openstack/nova/commit/58d6879b1caaa750c39c8e452a0634c24ffef2ce
Submitter: Jenkins
Branch: master
commit 58d6879b1caaa750c39c8e452a0634c24ffef2ce
Author: Russell Bryant <rbryant@redhat.com>
Date: Wed May 1 09:41:57 2013 -0400
Remove insecure default for signing\_dir option.
The sample api-paste.ini file included an insecure value for the
signing\_dir option for the keystone authtoken middleware. Comment out
the option so that we just rely on the default behavior by default.
Fix bug 1174608.
Change-Id: I6189788953d789c34456bbe150b8ed6ce6f68403

| Changed in nova: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-05-09:  [**Fix merged to nova (stable/grizzly)**](/nova/%2Bbug/1174608/comments/36) |  |  | [#36](/nova/%2Bbug/1174608/comments/36) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/28569>

Committed: <http://github.com/openstack/nova/commit/7bf3e8d3e254d817ff5ae7ef1f2884b10410ca60>

Submitter: Jenkins

Branch: stable/grizzly

commit 7bf3e8d3e254d817ff5ae7ef1f2884b10410ca60

Author: Russell Bryant <email address hidden>

Date: Wed May 1 09:41:57 2013 -0400

Remove insecure default for signing\_dir option.

The sample api-paste.ini file included an insecure value for the

    signing\_dir option for the keystone authtoken middleware. Comment out

    the option so that we just rely on the default behavior by default.

Fix [bug 1174608](/bugs/1174608).

Change-Id: I6189788953d789c34456bbe150b8ed6ce6f68403

    (cherry picked from commit 58d6879b1caaa750c39c8e452a0634c24ffef2ce)

Reviewed: https://review.openstack.org/28569
Committed: http://github.com/openstack/nova/commit/7bf3e8d3e254d817ff5ae7ef1f2884b10410ca60
Submitter: Jenkins
Branch: stable/grizzly
commit 7bf3e8d3e254d817ff5ae7ef1f2884b10410ca60
Author: Russell Bryant <rbryant@redhat.com>
Date: Wed May 1 09:41:57 2013 -0400
Remove insecure default for signing\_dir option.
The sample api-paste.ini file included an insecure value for the
signing\_dir option for the keystone authtoken middleware. Comment out
the option so that we just rely on the default behavior by default.
Fix bug 1174608.
Change-Id: I6189788953d789c34456bbe150b8ed6ce6f68403
(cherry picked from commit 58d6879b1caaa750c39c8e452a0634c24ffef2ce)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thomas Goirand (thomas-goirand)](https://launchpad.net/~thomas-goirand) wrote on 2013-05-09:  [**Re: Insecure directory creation for signing**](/nova/%2Bbug/1174608/comments/37) |  |  | [#37](/nova/%2Bbug/1174608/comments/37) |
| --- | --- | --- | --- |

Hi,

Is there a backport for Essex prepared by the Ubuntu security team? Or should I work on the backport myself?

Thomas

Hi,
Is there a backport for Essex prepared by the Ubuntu security team? Or should I work on the backport myself?
Thomas

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-05-09: |  |  | [#38](/nova/%2Bbug/1174608/comments/38) |
| --- | --- | --- | --- |

This does NOT affect Essex.

This does NOT affect Essex.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-05-09: |  |  | [#39](/nova/%2Bbug/1174608/comments/39) |
| --- | --- | --- | --- |

OSSA-2013-010

OSSA-2013-010

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-05-09:  [**Fix merged to keystone (stable/folsom)**](/nova/%2Bbug/1174608/comments/40) |  |  | [#40](/nova/%2Bbug/1174608/comments/40) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/28577>

Committed: <http://github.com/openstack/keystone/commit/24c25b38ed6fc95ed919ab34463cdb10bdcc57fd>

Submitter: Jenkins

Branch: stable/folsom

commit 24c25b38ed6fc95ed919ab34463cdb10bdcc57fd

Author: Dolph Mathews <email address hidden>

Date: Wed May 8 10:49:20 2013 -0500

Securely create signing\_dir ([bug 1174608](/bugs/1174608))

Also verifies the security of an existing signing\_dir.

Change-Id: I0685b4274a94ad3974a2b2a7ab3f45830d3934bb

    (cherry picked from python-keystoneclient 1736e2ffb12f70eeebed019448bc14def48aa036)

Reviewed: https://review.openstack.org/28577
Committed: http://github.com/openstack/keystone/commit/24c25b38ed6fc95ed919ab34463cdb10bdcc57fd
Submitter: Jenkins
Branch: stable/folsom
commit 24c25b38ed6fc95ed919ab34463cdb10bdcc57fd
Author: Dolph Mathews <dolph.mathews@gmail.com>
Date: Wed May 8 10:49:20 2013 -0500
Securely create signing\_dir (bug 1174608)
Also verifies the security of an existing signing\_dir.
Change-Id: I0685b4274a94ad3974a2b2a7ab3f45830d3934bb
(cherry picked from python-keystoneclient 1736e2ffb12f70eeebed019448bc14def48aa036)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Bernhard M. Wiedemann (ubuntubmw)](https://launchpad.net/~ubuntubmw) wrote on 2013-05-17:  [**Re: Insecure directory creation for signing**](/nova/%2Bbug/1174608/comments/41) |  |  | [#41](/nova/%2Bbug/1174608/comments/41) |
| --- | --- | --- | --- |

note regression introduced by the nova change: [bug 1181157](/bugs/1181157)

note regression introduced by the nova change: bug 1181157

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-05-24

| **summary**: | - Insecure directory creation for signing+ [OSSA 2013-010] Insecure directory creation for signing |
| --- | --- |
| Changed in ossa: | |
| **assignee**: | nobody → Thierry Carrez (ttx) |
| **status**: | New → Fix Released |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-05-29

| Changed in nova: | |
| --- | --- |
| **milestone**: | none → havana-1 |
| **status**: | Fix Committed → Fix Released |

[Dolph Mathews (dolph)](https://launchpad.net/~dolph)
on 2013-05-29

| Changed in python-keystoneclient: | |
| --- | --- |
| **milestone**: | none → 0.2.4 |
| **status**: | Fix Committed → Fix Released |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-10-17

| Changed in nova: | |
| --- | --- |
| **milestone**: | havana-1 → 2013.2 |

[Sean Dague (sdague)](https://launchpad.net/~sdague)
on 2014-09-19

| **no longer affects**: | nova/folsom |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/nova/%2Bbug/1174608/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/nova/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

## Duplicates of this bug

* [Bug #1177681](https://bugs.launchpad.net/nova/%2Bbug/1177681 "keystone-signing-nova in tmp")

You are
[not directly subscribed to this bug's notifications.](/nova/%2Bbug/1174608/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/nova/%2Bbug/1174608/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/nova/%2Bbug/1174608/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [0001-Remove-insecure-default-for-signing\_dir-option.patch](https://bugs.launchpad.net/nova/%2Bbug/1174608/%2Battachment/3661488/%2Bfiles/0001-Remove-insecure-default-for-signing_dir-option.patch)
  [Edit](/nova/%2Bbug/1174608/%2Battachment/3661488 "Change patch details")
* [bug-1174608-v1](https://bugs.launchpad.net/nova/%2Bbug/1174608/%2Battachment/3661730/%2Bfiles/bug-1174608-v1)
  [Edit](/nova/%2Bbug/1174608/%2Battachment/3661730 "Change patch details")
* [bug-1174608-v2](https://bugs.launchpad.net/nova/%2Bbug/1174608/%2Battachment/3662715/%2Bfiles/bug-1174608-v2)
  [Edit](/nova/%2Bbug/1174608/%2Battachment/3662715 "Change patch details")

* [Add patch](/nova/%2Bbug/1174608/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from lists.openstack.org_4ecea788_20250125_042158.html ===

# [Open Stack](/)

* [Home](http://openstack.org/ "Go to the Home page")
* [Projects](http://openstack.org/projects/ "Go to the OpenStack Projects page")
* [User Stories](http://openstack.org/user-stories/ "Go to the User Stories page")
* [Community](http://openstack.org/community/ "Go to the Community page")
* [Blog](http://openstack.org/blog/ "Go to the OpenStack Blog")
* [Wiki](http://wiki.openstack.org/ "Go to the OpenStack Wiki")
* [Documentation](http://docs.openstack.org/ "Go to OpenStack Documentation")

# [openstack-announce] [OSSA 2013-010] Nova uses insecure keystone middleware tmpdir by default (CVE-2013-2030)

**Thierry Carrez**
thierry at openstack.org

*Thu May 9 15:15:44 UTC 2013*

* Previous message: [[openstack-announce] OpenStack Grizzly documentation released 4/30/13](000097.html)
* Next message: [[openstack-announce] [OSSA 2013-011] Keystone tokens not immediately invalidated when user is deleted (CVE-2013-2059)](000099.html)
* **Messages sorted by:**
  [[ date ]](date.html#98)
  [[ thread ]](thread.html#98)
  [[ subject ]](subject.html#98)
  [[ author ]](author.html#98)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

OpenStack Security Advisory: 2013-010
CVE: CVE-2013-2030
Date: May 9, 2013
Title: Nova uses insecure keystone middleware tmpdir by default
Reporter: Grant Murphy (Red Hat), Anton Lundin
Products: Nova
Affects: Folsom, Grizzly

Description:
Grant Murphy from Red Hat and Anton Lundin both independently reported a
vulnerability in Nova's default location for the Keystone middleware
signing directory (signing_dir). By previously setting up a malicious
directory structure, an attacker with local shell access on the Nova
node could potentially issue forged tokens that would be accepted by the
middleware. Only setups that use the default value for signing_dir are
affected. Note that future versions of the Keystone middleware will
issue a warning if an insecure signing directory is used.

Havana (development branch) fix:
<https://review.openstack.org/#/c/28568/>

Grizzly fix:
<https://review.openstack.org/#/c/28569/>

Folsom fix:
<https://review.openstack.org/#/c/28570/>

References:
[https://bugs.launchpad.net/nova/+bug/1174608](https://bugs.launchpad.net/nova/%2Bbug/1174608)
<http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2013-2030>

- --
Thierry Carrez (ttx)
OpenStack Vulnerability Management Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
Comment: Using GnuPG with undefined - <http://www.enigmail.net/>

iQIcBAEBCAAGBQJRi72dAAoJEFB6+JAlsQQjJZAQAJ5w/+BoBD4em8YklBsxU6wU
Bn1wWu3W5ngCNuHwr4ydWzC3U1TT1zWtogWJpv/+87m2KPESWhs7YGCkTIE9tLpA
sNOniOG9hGUsWwRgtUqjA8/8QzLgbNJ/PDJx0lrNPNkvMbHwP/jxotx353edhelQ
QAPJwVPBqu0vn2VZOeFWYNO/AnWNcjTXE0po92qaFvw3HWL3ykMd30w4Ejxv9clC
VjBjaNkReSkmcd/BaArtr1IenyYyVqM7nv/VWl5O5Up02+uvAozDmy6Cyc1O5VOW
6m9nRH2WKE/bFXcTEG4rpH+/BZxG2RuyklUBvVtSaEAQOWYFSwQKzjxGM3rItsWt
iuQYrakl6H69tRS3HS9pAXWdxSikSb8CqmVJauf3RG1/EQ7GtCO0kXVPi8fYBaTX
GpLmpY8bj6o2iY1Kh1bozZ2oYVLgPrhP2R4oj+4iaSN++gy2qs0d3AvIK0BzBKT+
fd7wAUpdxltM9eZS82VEQxIaOGUDqnGompEu3nPRv9KD5kZqgz/L/jp5I+PR3y1D
Uaj8W+FfF/AZtMRLJHl3I0kUHRhfuIusir5zja7UCoR6UEeipLvBzbi/DSGfBCRY
/VbBv9ZZBeQ+Kw4EwS4/7G5nw1RX4/bKGSi0zcwwmD2unB7Plm9MjI65yR4oFidl
uOpCYFwNk6PqCFED/mCz
=wjZ/
-----END PGP SIGNATURE-----

```

---

* Previous message: [[openstack-announce] OpenStack Grizzly documentation released 4/30/13](000097.html)
* Next message: [[openstack-announce] [OSSA 2013-011] Keystone tokens not immediately invalidated when user is deleted (CVE-2013-2059)](000099.html)
* **Messages sorted by:**
  [[ date ]](date.html#98)
  [[ thread ]](thread.html#98)
  [[ subject ]](subject.html#98)
  [[ author ]](author.html#98)

---

[More information about the OpenStack-announce
mailing list](http://lists.openstack.org/cgi-bin/mailman/listinfo/openstack-announce)

---

### OpenStack

* [Projects](http://openstack.org/projects/)
* [OpenStack Security](http://openstack.org/openstack-security/)
* [Common Questions](http://openstack.org/projects/openstack-faq/)
* [Blog](http://openstack.org/blog/)

### Community

* [User Groups](http://openstack.org/community/)
* [Events](http://openstack.org/events/)
* [Jobs](http://openstack.org/jobs/)
* [Companies](http://openstack.org/companies/)
* [Contribute](http://wiki.openstack.org/HowToContribute)

### Documentation

* [OpenStack Manuals](http://docs.openstack.org/)
* [Getting Started](http://docs.openstack.org/diablo/openstack-compute/starter/content/)
* [Wiki](http://wiki.openstack.org/)

### Branding & Legal

* [Logos & Guidelines](http://openstack.org/brand/)
* [Trademark Policy](http://openstack.org/brand/openstack-trademark-policy/)
* [Privacy Policy](http://openstack.org/privacy/)
* [OpenStack CLA](http://wiki.openstack.org/CLA)

---



=== Content from bugzilla.redhat.com_dba11093_20250125_042202.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D958285)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D958285)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D958285)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 958285

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 958285**](show_bug.cgi?id=958285)
(CVE-2013-2030)
- [CVE-2013-2030](https://access.redhat.com/security/cve/CVE-2013-2030) OpenStack nova: insecure directory creation for signing

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2013-2030 OpenStack nova: insecure directory creation for signing

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED CURRENTRELEASE | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2013-2030 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [957485](show_bug.cgi?id=957485) [958287](show_bug.cgi?id=958287) [961733](show_bug.cgi?id=961733 "CLOSED ERRATA - CVE-2013-2030 OpenStack nova: insecure directory creation for signing [fedora-all]") [961736](show_bug.cgi?id=961736 "CLOSED WONTFIX - CVE-2013-2030 OpenStack nova: insecure directory creation for signing [epel-6]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [958289](show_bug.cgi?id=958289) | | TreeView+ | [depends on](buglist.cgi?bug_id=958285&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=958285&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2013-04-30 20:11 UTC by Kurt Seifried | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 13:03 UTC ([History](show_activity.cgi?id=958285)) | | [CC List:](page.cgi?id=fields.html#cclist) | 14 users (show)  abaron aortega apevec ayoung chrisw cpelland dallan jkt jlieskov markmc ndipanov rbryant security-response-team xqueralt | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2013-10-02 09:24:00 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Gentoo | [469272](https://bugs.gentoo.org/show_bug.cgi?id=469272) | 0 | None | None | None | Never | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=958285#c0)  Kurt Seifried    2013-04-30 20:11:40 UTC  ```  Originally reported by Grant Murphy (gmurphy):  The signing directory is used to store the signing certificates and the default location for this directory is:      signing_dir = /tmp/keystone-signing-nova  In the file:     keystone/middleware/auth_token.py  During the initialization of the AuthMiddleware the following operations are made for the signing directory:      IF the directory exists but cannot be written to a configuration error is raised.     ELSE IF the directory doesn't exist, create it.     NEXT chmod permisions(stat.S_IRWXU) to the signing_directory  AFAICT The signing certificates used in validation will only be fetched from the keystone if the cms_verify action raises an exception because the certificate file is missing from the signing directory.  This means that if an attacker populated the /tmp/keystone-signing-nova with the appropriate files for signautre verification they could potentially issue forged tokens which would be validated by the middleware. As:     - The directory location deterministic. (default for glance, nova)     - *If the directory already exists it is reused*   ```  [Comment 2](show_bug.cgi?id=958285#c2)  Jan Lieskovsky    2013-05-10 10:55:37 UTC  ``` References:   <http://www.openwall.com/lists/oss-security/2013/05/09/2>   [https://bugs.launchpad.net/nova/+bug/1174608](https://bugs.launchpad.net/nova/%2Bbug/1174608)   <http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2013-2030>  Upstream patches:   <https://review.openstack.org/#/c/28568/> (Havana branch)   <https://review.openstack.org/#/c/28569/> (Grizzly branch)   <https://review.openstack.org/#/c/28570/> (Folsom branch)   ```  [Comment 3](show_bug.cgi?id=958285#c3)  Jan Lieskovsky    2013-05-10 10:57:06 UTC  ``` Created openstack-nova tracking bugs for this issue  Affects: fedora-all [[bug 961733](show_bug.cgi?id=961733 "CLOSED ERRATA - CVE-2013-2030 OpenStack nova: insecure directory creation for signing [fedora-all]")] Affects: epel-6 [[bug 961736](show_bug.cgi?id=961736 "CLOSED WONTFIX - CVE-2013-2030 OpenStack nova: insecure directory creation for signing [epel-6]")]   ```  [Comment 4](show_bug.cgi?id=958285#c4)  Fedora Update System    2013-05-22 01:29:01 UTC  ``` openstack-keystone-2012.2.4-3.fc18 has been pushed to the Fedora 18 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 5](show_bug.cgi?id=958285#c5)  Kurt Seifried    2013-05-25 07:52:18 UTC  ``` This was fixed upstream:  <http://lists.openstack.org/pipermail/openstack-announce/2013-May/000098.html>  OpenStack Security Advisory: 2013-010 CVE: [CVE-2013-2030](https://access.redhat.com/security/cve/CVE-2013-2030) Date: May 9, 2013 Title: Nova uses insecure keystone middleware tmpdir by default Reporter: Grant Murphy (Red Hat), Anton Lundin Products: Nova Affects: Folsom, Grizzly  Description: Grant Murphy from Red Hat and Anton Lundin both independently reported a vulnerability in Nova's default location for the Keystone middleware signing directory (signing_dir). By previously setting up a malicious directory structure, an attacker with local shell access on the Nova node could potentially issue forged tokens that would be accepted by the middleware. Only setups that use the default value for signing_dir are affected. Note that future versions of the Keystone middleware will issue a warning if an insecure signing directory is used.  Havana (development branch) fix: <https://review.openstack.org/#/c/28568/>  Grizzly fix: <https://review.openstack.org/#/c/28569/>  Folsom fix: <https://review.openstack.org/#/c/28570/>  References: [https://bugs.launchpad.net/nova/+bug/1174608](https://bugs.launchpad.net/nova/%2Bbug/1174608) <http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2013-2030>  - --  Thierry Carrez (ttx) OpenStack Vulnerability Management Team   ```  [Comment 6](show_bug.cgi?id=958285#c6)  Xavier Queralt    2013-10-02 09:24:00 UTC  ``` The fix for this issue is already included in the current havana and grizzly RDO packages.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=958285&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)


