- **Root cause of vulnerability:** A buffer overflow vulnerability exists in the `atodn()` function within strongSwan when handling DNS TXT records during Opportunistic Encryption (OE) setup. The function incorrectly parses DNS TXT records and attempts ASN.1 parsing if an '=' character is present, even though DNS TXT records do not contain ASN.1 representations. This leads to a buffer overflow because DNS TXT records can be larger than what the ASN.1 parsing code expects. The buffer overflow can overwrite the `kernel_ops` struct which contains function pointers
- **Weaknesses/vulnerabilities present:** Buffer overflow in `atodn()` due to insufficient size checks when parsing DNS TXT records containing a specific character leading to ASN.1 parsing.
- **Impact of exploitation:** Remote code execution by overwriting function pointers in the `kernel_ops` struct.
- **Attack vectors:** A remote attacker can exploit this vulnerability by controlling the reverse DNS entry for the IP address of the target host. The attacker needs to create a malicious DNS TXT record containing a specially crafted FQDN with an "=" symbol, that will overflow the buffer during parsing. The target host must be configured to use Opportunistic Encryption and resolve reverse DNS entries when connecting to an IP address.
- **Required attacker capabilities/position:** The attacker needs to control the reverse DNS for the target's IP address and the target must be configured for OE, an uncommon configuration.