=== Content from issues.asterisk.org_35f6d448_20250125_125056.html ===

[[Home](/)]

| Summary: | ASTERISK-20967: Security Vulnerability: DoS attack possible due to fix for CVE-2012-5976 | | |
| --- | --- | --- | --- |
| Reporter: | Matt Jordan (mjordan) | Labels: |  |
| Date Opened: | 2013-01-21 14:31:44.000-0600 | Date Closed: | 2013-03-27 14:23:36 |
| Priority: | Major | Regression? | Yes |
| Status: | Closed/Complete | Components: | Core/HTTP |
| Versions: | 1.8.19.1 1.8.20.0 10.11.1 10.11.1-digiumphones 10.12.0 10.12.0-digiumphones 11.1.2 11.2.0 | Frequency ofOccurrence |  |
| RelatedIssues: | | must be completed before resolving | [ASTERISK-21004](/ASTERISK-21004) Open Blockers for 1.8.21.0 | | --- | --- | | must be completed before resolving | [ASTERISK-21005](/ASTERISK-21005) Open Blockers for 11.3.0 | | | |
| Environment: |  | Attachments: | ( 0) [AST-2013-002-1.8.diff](../attachments/20/ASTERISK-20967/00-AST-2013-002-1.8.diff)( 1) [AST-2013-002-10.diff](../attachments/20/ASTERISK-20967/01-AST-2013-002-10.diff)( 2) [AST-2013-002-11.diff](../attachments/20/ASTERISK-20967/02-AST-2013-002-11.diff)( 3) [issueA20967\_file\_leak\_and\_unused\_wkspace.patch](../attachments/20/ASTERISK-20967/03-issueA20967_file_leak_and_unused_wkspace.patch) |
| Description: | {quote}   When researching CVE-2012-5976 in HTTP, I came across a DoS possible on the patched versions of Asterisk.  It is based on the user-controlled malloc(), which replaced the alloca() in http.c.  An attacker can use the Content-length: header to control the amount of heap allocated and exhaust the memory available to Asterisk.   I have attached our disclosure and a PoC for your convenience.  The PoC uses a number of concurrent connections but with a bit more effort could probably use a probing scheme and then get away with one or very few connections.  Also, note that filling up the memory is not necessary to effect a temporary DoS i.e. an attack would be possible over a low-bandwidth connection.  The PoC does fill the buffer to demonstrate that the server process will be terminated by the OS in this case.   Christoph Hebeisen  {quote} | | |
| Comments: | By: Walter Doekes (wdoekes) 2013-03-10 09:45:12.547-0500If we're in the vicinity, might as well tackle these issues in issueA20967\_file\_leak\_and\_unused\_wkspace.patch  ---   By: Matt Jordan (mjordan) 2013-03-25 15:08:33.159-0500I'm okay committing that immediately after the patches go in for the security vulnerability, but if it's okay I'll probably keep it separate from the actual vulnerability fix.  --- | | |



=== Content from downloads.asterisk.org_5e290a70_20250125_125049.html ===


Asterisk
Project Security Advisory - AST-2013-002

| **Product** | Asterisk |
| **Summary** | Denial of Service in HTTP server |
| **Nature of Advisory** | Denial of Service |
| **Susceptibility** | Remote Unauthenticated Sessions |
| **Severity** | Major |
| **Exploits Known** | None |
| **Reported On** | January 21, 2013 |
| **Reported By** | Christoph Hebeisen, TELUS Security Labs |
| **Posted On** | March 27, 2013 |
| **Last Updated On** | March 27, 2013 |
| **Advisory Contact** | Mark Michelson <mmichelson AT digium DOT com> |
| **CVE Name** | CVE-2013-2686 |

| **Description** | AST-2012-014 [1], fixed in January of this year, contained a fix for Asterisk's HTTP server since it was susceptible to a remotely-triggered crash.    The fix put in place fixed the possibility for the crash to be triggered, but a possible denial of service still exists if an attacker sends one or more HTTP POST requests with very large Content-Length values.    [1] http://downloads.asterisk.org/pub/security/AST-2012-014.html |

| **Resolution** | Content-Length is now capped at a maximum value of 1024 bytes. Any attempt to send an HTTP POST with content-length greater than this cap will not result in any memory allocated. The POST will be responded to with an HTTP 413 âRequest Entity Too Largeâ response. |

| **Affected Versions** | | |
| **Product** | **Release Series** |  |
| Asterisk Open Source | 1.8.x | 1.8.19.1, 1.8.20.0, 1.8.20.1 |
| Asterisk Open Source | 10.x | 10.11.1, 10.12.0, 10.12.1 |
| Asterisk Open Source | 11.x | 11.1.2, 11.2.0, 11.2.1 |
| Certified Asterisk | 1.8.15 | 1.8.15-cert1 |
| Asterisk Digiumphones | 10.x-digiumphones | 10.11.1-digiumphones, 10.12.0-digiumphones, 10.12.1-digiumphones |

| **Corrected In** | |
| **Product** | **Release** |
| Asterisk Open Source | 1.8.20.2, 10.12.2, 11.2.2 |
| Certified Asterisk | 1.8.15-cert2 |
| Asterisk Digiumphones | 10.12.2-digiumphones |

| **Patches** | |
| **SVN URL** | **Revision** |
| http://downloads.asterisk.org/pub/security/AST-2013-002-1.8.diff | Asterisk 1.8 |
| http://downloads.asterisk.org/pub/security/AST-2013-002-10.diff | Asterisk 10 |
| http://downloads.asterisk.org/pub/security/AST-2013-002-11.diff | Asterisk 11 |
| http://downloads.asterisk.org/pub/security/AST-2013-002-1.8.15-cert.diff | Certified Asterisk 1.8.15 |

| **Links** | https://issues.asterisk.org/jira/browse/ASTERISK-20967 |
|  | <http://telussecuritylabs.com/threats/show/TSL20130327-01> |

| Asterisk Project Security Advisories are posted at <http://www.asterisk.org/security>  This document may be superseded by later versions; if so, the latest version will be posted at http://downloads.digium.com/pub/security/AST-2013-002.pdf and http://downloads.digium.com/pub/security/AST-2013-002.html |

| **Revision History** | | |
| **Date** | **Editor** | **Revisions Made** |
| February 12, 2013 | Mark Michelson | Initial Draft |
| March 27, 2013 | Matt Jordan | Updated CVE |
| March 27, 2013 | Matt Jordan | Updated with correct links to patches |

Asterisk
Project Security Advisory - AST-2013-002
Copyright
Â© 2013
Digium, Inc. All Rights Reserved.
Permission is hereby granted
to distribute and publish this advisory in its original, unaltered
form.



=== Content from telussecuritylabs.com_36a7c94a_20250125_125055.html ===

# Telus Security Labs - Cybersecurity & Hacking News

Discover latest news, trends and tutorials about hacking, cybersecurity, computing, various tips & tricks of computers tweaking, web development advices and much more!

Take a look back later where you will be able to find tons of educational hacking tutorials of all kinds, such as social media accounts hack-tricks, hacking tools and apps collection, for both desktop and mobile operating systems.

Subscribe to our feed to get informed about new posts and updates.


