=== Content from c22blog.wordpress.com_a4c58ea8_20250126_101251.html ===


* [Home](http://blog.c22.cc/)
* [About me](https://c22blog.wordpress.com/about/)
  + [About me](https://c22blog.wordpress.com/about/)
  + [Speed Blogging](https://c22blog.wordpress.com/about/speed-blogging/)
  + [Twitter (@ChrisJohnRiley)](http://www.twitter.com/ChrisJohnRiley)
  + [Twitter (@catch22insec)](http://twitter.com/catch22insec)
  + [Eurotrash Security Podcast](http://www.eurotrashsecurity.eu)
  + [Twitter (@eurotrashsec)](http://twitter.com/eurotrashsec)
  + [PGP Public Key](https://c22blog.wordpress.com/pgp-public-key/)
* [Shared Items](http://feed.c22.cc)
  + [Shared Items](http://feed.c22.cc)
  + [Shared Items (RSS)](http://feeds.feedburner.com/C22SharedItems)
  + [Shared Items (Google Reader archive)](http://www.google.com/reader/shared/ChrisJohnRiley)
* [Tools / Scripts](https://c22blog.wordpress.com/toolsscripts/)
  + [Tools / Scripts](https://c22blog.wordpress.com/toolsscripts/)
  + [Scythe Framework](http://blog.c22.cc/2012/10/03/scythe-framework/)
  + [Apache Log Extractor [Alpha]](https://c22blog.wordpress.com/toolsscripts/apache-log-extractor-alpha/)
  + [UA-Tester](https://c22blog.wordpress.com/toolsscripts/ua-tester/)
  + [Metasploit Modules](https://c22blog.wordpress.com/toolsscripts/metasploit-modules/)
  + [PRN-2-ME](https://c22blog.wordpress.com/toolsscripts/prn-2-me/)
  + [[PoC] scr.im.tessercap (CAPTCHA OCR)](https://c22blog.wordpress.com/toolsscripts/poc-scr-im-tessercap-captcha-ocr/)
  + [[PoC] scr.im-jim](https://c22blog.wordpress.com/toolsscripts/poc-scr-im-jim/)
  + [Typo3 Default Encryption Keys](https://c22blog.wordpress.com/toolsscripts/typ3defenctool/)
* [Media](https://c22blog.wordpress.com/media/)
* [Advisories](https://c22blog.wordpress.com/advisories/)
  + [Advisories](https://c22blog.wordpress.com/advisories/)
  + [CVE-2013-5113/5114 â€“ LastPass Android container PIN and auto-wipe security feature bypass](https://c22blog.wordpress.com/advisories/cve-2013-51135114-lastpass-android-container-pin-and-auto-wipe-security-feature-bypass/)
  + [CVE-2013-2503 â€“ Privoxy Proxy Authentication Credential Exposure](https://c22blog.wordpress.com/advisories/cve-2013-2503-privoxy-proxy-authentication-credential-exposure/)
  + [TYPO3-EXT-SA-2012-003 â€“ t3extplorer](https://c22blog.wordpress.com/advisories/typo3-ext-sa-2012-003-t3extplorer/)
  + [SurveyMonkey: IP Spoofing](http://wp.me/p6I7X-Jh)
  + [SAP Management Console](http://blog.c22.cc/2011/01/09/metasploit-sap-management-console-aux-modules/)
  + [scr.im Captcha Bypass](http://blog.c22.cc/2009/10/07/the-secrets-of-scr-im/)
  + [TYPO3-SA-2010-009 â€“ sr\_feuser\_register](https://c22blog.wordpress.com/advisories/typo3-sa-2010-009-sr_feuser_register/)
  + [TYPO3-SA-2009-001 â€“ Insecure Randomness](https://c22blog.wordpress.com/advisories/typo3-sa-2009-001/)
  + [TYPO3-SA-2009-016 â€“ Install Tool](https://c22blog.wordpress.com/advisories/typo3-sa-2009-016-install-tool/)
  + [TYPO3-SA-2009-016 â€“ felogin](https://c22blog.wordpress.com/advisories/typo3-sa-2009-016-felogin/)
* [Bookshelf](https://c22blog.wordpress.com/books/)

# [CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](https://c22blog.wordpress.com/)

Because we're damned if we do, and we're damned if we don't!

[Home](https://c22blog.wordpress.com/)
## Privoxy Proxy Authentication Credential Exposure â€“Â CVE-2013-2503

[1 Comment](https://c22blog.wordpress.com/2013/03/11/privoxy-proxy-authentication-credential-exposure-cve-2013-2503/#respond)
Posted by [ChrisJohnRiley](https://c22blog.wordpress.com/author/catchtwotwo/ "Posts by ChrisJohnRiley") on March 11, 2013

## **Privoxy Proxy Authentication Credential Exposure**

**Product**: Privoxy

**Project Homepage**: [privoxy.org](http://privoxy.org)

**Advisory ID**: c22-2013-01

**Vulnerable Version(s)**: 3.0.20 (and possibly prior)

**Tested Version**: 3.0.20-1 (tested using Debian Sid)

**Vendor Notification**: March 6, 2013

**Public Disclosure**: March 11, 2013

**Vulnerability Type**: Insufficiently Protected Credentials [CWE-522]

**CVE Reference**: CVE-2013-2503

**Risk Level**: Medium

**CVSSv2 Base Score**: 4.3 (AV:N/AC:M/Au:N/C:P/I:N/A:N)

**Discovery**: Chris John Riley ( <http://blog.c22.cc> )

### Advisory Details:

During research into browser and proxy server handling of HTTPÂ Response Codes, an issue with the way that Privoxy handles HTTPÂ Response code 407 â€œProxy Authentication Requiredâ€ was discovered.Â Privoxy in versions 3.0.20 (and possibly prior) ignores the presence ofÂ â€œProxy-Authenticateâ€ and â€œProxy-Authorizationâ€ headers and allows theseÂ values to be passed to and from a remote server without modification.Â *******The resulting behavior could allow a malicious websites to spoof a***************Proxy-Authentication response appearing to originate from the Privoxy*****************service. The Privoxy user will then be prompted for a username and*******************password that appears to originate from the Privoxy software.**********

#### Scenario*:*

1. A Privoxy user visits a website using a browser of their choice
2. The remote website responds to the request with a 407 â€œProxyÂ Authentication Requiredâ€ HTTP response code and the appropriateÂ â€œProxy-Authenticate: Basicâ€ HTTP response header
3. This response is passed through the Privoxy service withoutÂ modification to the users browser
4. **As the browser is configured to use a proxy server, the browser*********believes that the upstream proxy (Privoxy) has requested***************authentication and prompts the user for a username and password. This*****************prompt states that the proxy server at â€œ127.0.0.1:8118â€ requires*******************authentication (this prompt may vary if Privoxy is running on a*********************machine other than localhost and/or on a non-default port number)***********
5. ************If the user enters a username and password, the browser will send*************************a request through Privoxy to the remote website with a***************************â€œProxy-Authorization: XXXXXXXXâ€ HTTP request header (where XXXXXXX is*****************************a base64 encoded version of the username and password the user*******************************entered at the browsers proxy authentication prompt)****************
6. *****************The remote website receives this header and can store or re-use***********************************these captured credentials******************

#### Proof of Concept:

<http://c22.cc/POC/c22-2013-01.php>

*The above URL will respond with a â€œProxy-Authenticate: basicâ€ header***when a request is received that does no contain a*****â€œProxy-Authorizationâ€ header. This will prompt the users browser to*******request a username/password from the user. If you enter a value in the*********username/password box and click ok, it will send a Base64 encoded***********version to the remote website (the server will display the response*************headers at the bottom of the resulting page under request headers (one***************of the values will be â€œProxy-Authorizationâ€ with a base64 encoded*****************version of the entered username/password). For a full walkthrough it*******************is suggested to capture this in yourÂ favouriteÂ packet capture program*********************and walk through the requests to view the entire process.***********

**Note* â€“> The above POC does not store any data sent to the server,***however it is suggested to use bogus credentials if testing this proof of*****concept.***

#### Solution:

The following solution was suggested and implemented in Privoxy 3.0.21 stable.

> *Proxy authentication headers are removed unless the new directive***enable-proxy-authentication-forwarding is used. Forwarding the headers*****potentionally allows malicious sites to trick the user into providing*******it with login information.****

**References**:

Privoxy 3.0.21 ChangeLog â€“> <http://ijbswa.cvs.sourceforge.net/viewvc/ijbswa/current/ChangeLog?revision=1.188&view=markup>

#### Vulnerability Timeline:

March 5, 2013 20:00 â€“ Initial discovery of vulnerability

March 6, 2013 14:48 > Emailed Privoxy developer list to request a security contact

March 6, 2013 15:26 < Received response with dedicated security contact information

March 6, 2013 16:01 > Emailed details of the vulnerability to security contact

March 6, 2013 17:19 < Received response acknowledging issue. Fix indicated in upcoming release

March 6, 2013 18:38 > Acknowledged receipt of email and advised of updated CVSSv2 score

March 7, 2013 15:50 < Received response detailing proposed fix, including link to CVS check-in of new code

March 7, 2013 18:48 > Acknowledged receipt of email

March 9, 2013 16:54 > Emailed CVE number to security contact and requested information on release plans

March 10, 2013 14:28 < Received confirmation of release timeline

March 10, 2013 14:58 â€“ Release of Privoxy 3.0.21 stable

March 11, 2013 07:30 â€“ Release of advisory

### Rate this:

### Share this:

* [Twitter](https://c22blog.wordpress.com/2013/03/11/privoxy-proxy-authentication-credential-exposure-cve-2013-2503/?share=twitter "Click to share on Twitter")
* [Facebook](https://c22blog.wordpress.com/2013/03/11/privoxy-proxy-authentication-credential-exposure-cve-2013-2503/?share=facebook "Click to share on Facebook")
* [LinkedIn](https://c22blog.wordpress.com/2013/03/11/privoxy-proxy-authentication-credential-exposure-cve-2013-2503/?share=linkedin "Click to share on LinkedIn")
* [Tumblr](https://c22blog.wordpress.com/2013/03/11/privoxy-proxy-authentication-credential-exposure-cve-2013-2503/?share=tumblr "Click to share on Tumblr")
* [Reddit](https://c22blog.wordpress.com/2013/03/11/privoxy-proxy-authentication-credential-exposure-cve-2013-2503/?share=reddit "Click to share on Reddit")
Like Loading...
### *Related*

[Security](https://c22blog.wordpress.com/category/security/)
[privoxy](https://c22blog.wordpress.com/tag/privoxy/), [proxy authentication](https://c22blog.wordpress.com/tag/proxy-authentication/), [Response Codes](https://c22blog.wordpress.com/tag/response-codes/)

[â† {QuickPost} Research Teaser â€“ HTTP ResponseÂ Codes](https://c22blog.wordpress.com/2013/02/19/quickpost-research-teaser-http-response-codes/) [BSidesLondon 2013 â†’](https://c22blog.wordpress.com/2013/04/19/bsideslondon-2/)

### One response to â€œ*Privoxy Proxy Authentication Credential Exposure â€“Â CVE-2013-2503*â€

1. Pingback: [Defense by Numbers: Making problems for script kiddies and scanner monkies | CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](http://blog.c22.cc/2013/04/24/defense-by-numbers-making-problems-for-script-kiddies-and-scanner-monkies/)

[RSS feed](https://c22blog.wordpress.com/feed/)
### Recent Posts

* [[DeepSec 2015]50 Shades ofÂ WAF](https://c22blog.wordpress.com/2015/11/19/deepsec-201550-shades-of-waf/)
* [[DeepSec 2015] File Format Fuzzing in Android â€“ Giving a Stagefright to the AndroidÂ Installer](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-file-format-fuzzing-in-android-giving-a-stagefright-to-the-android-installer/)
* [[DeepSec 2015]How to Break XML Encryption â€“Â Automatically](https://c22blog.wordpress.com/2015/11/19/deepsec-2015how-to-break-xml-encryption-automatically/)
* [[DeepSec 2015] Hacking Cookies in Modern Web Applications andÂ Browsers](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-hacking-cookies-in-modern-web-applications-and-browsers/)
* [[DeepSec 2015] Can societies manage the SIGINTÂ monster?](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-can-societies-manage-the-sigint-monster/)
* [[LHS Microcast] DeepSecÂ 2015](https://c22blog.wordpress.com/2015/10/19/lhs-microcase-deepsec-2015/)
* [[LHS Microcast] Interview w/ JenÂ Ellis](https://c22blog.wordpress.com/2015/10/02/lhs-microcast-interview-w-jen-ellis/)
* [Taking out theÂ Eurotrash](https://c22blog.wordpress.com/2014/12/23/taking-out-the-eurotrash/)
* [All good things must come to anÂ end](https://c22blog.wordpress.com/2014/12/22/all-good-things-must-come-to-an-end/)
* [[DeepSec 2014] Advanced Powershell Threat: Lethal Client Side Attacks usingÂ Powershell](https://c22blog.wordpress.com/2014/11/21/deepsec-2014-advanced-powershell-threat-lethal-client-side-attacks-using-powershell/)
[![](http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png)](http://creativecommons.org/licenses/by-nc-sa/3.0/)
### Archives

Archives
Select Month
 November 2015 Â (5)
 October 2015 Â (2)
 December 2014 Â (2)
 November 2014 Â (5)
 October 2014 Â (1)
 September 2014 Â (1)
 August 2014 Â (1)
 July 2014 Â (1)
 April 2014 Â (1)
 January 2014 Â (1)
 December 2013 Â (2)
 October 2013 Â (1)
 September 2013 Â (1)
 August 2013 Â (2)
 July 2013 Â (1)
 June 2013 Â (1)
 May 2013 Â (1)
 April 2013 Â (2)
 March 2013 Â (1)
 February 2013 Â (1)
 December 2012 Â (4)
 November 2012 Â (2)
 October 2012 Â (2)
 September 2012 Â (2)
 August 2012 Â (1)
 July 2012 Â (2)
 June 2012 Â (3)
 May 2012 Â (3)
 April 2012 Â (3)
 March 2012 Â (8)
 February 2012 Â (7)
 January 2012 Â (7)
 December 2011 Â (11)
 November 2011 Â (17)
 October 2011 Â (6)
 September 2011 Â (9)
 August 2011 Â (6)
 July 2011 Â (10)
 June 2011 Â (5)
 May 2011 Â (3)
 April 2011 Â (9)
 March 2011 Â (5)
 February 2011 Â (1)
 January 2011 Â (11)
 December 2010 Â (3)
 November 2010 Â (12)
 October 2010 Â (6)
 September 2010 Â (11)
 August 2010 Â (9)
 July 2010 Â (21)
 June 2010 Â (8)
 May 2010 Â (7)
 April 2010 Â (13)
 March 2010 Â (7)
 February 2010 Â (1)
 January 2010 Â (3)
 December 2009 Â (17)
 November 2009 Â (6)
 October 2009 Â (6)
 September 2009 Â (21)
 August 2009 Â (15)
 July 2009 Â (9)
 June 2009 Â (5)
 May 2009 Â (3)
 April 2009 Â (5)
 March 2009 Â (4)
 February 2009 Â (5)
 January 2009 Â (4)
 December 2008 Â (18)
 November 2008 Â (6)
 October 2008 Â (5)
 September 2008 Â (10)
 August 2008 Â (7)
 July 2008 Â (7)
 June 2008 Â (1)
 March 2008 Â (3)
 February 2008 Â (4)
 January 2008 Â (4)
 December 2007 Â (5)
 November 2007 Â (8)
 October 2007 Â (6)
 September 2007 Â (8)
 August 2007 Â (6)

[![ChrisJohnRiley on Twitter](http://twittercounter.com/counter/?username=ChrisJohnRiley)](http://twitter.com/ChrisJohnRiley)

### [@ChrisJohnRiley](http://twitter.com/ChrisJohnRiley)

[Tweets by ChrisJohnRiley](https://twitter.com/ChrisJohnRiley)
###

[![Computer History Museum (Mountain View, CA)](https://live.staticflickr.com/7642/16171126653_504b9e28d2_s.jpg "Computer History Museum (Mountain View, CA)")](https://www.flickr.com/photos/c22/16171126653/)[![Hmmâ€¦ no tanks. Why did nobody tell me earlier!](https://live.staticflickr.com/7518/15658163086_92a02df283_s.jpg "Hmmâ€¦ no tanks. Why did nobody tell me earlier!")](https://www.flickr.com/photos/c22/15658163086/)[![Huge Organâ€¦ #firstcon14](https://live.staticflickr.com/5591/14322110059_07bec335c6_s.jpg "Huge Organâ€¦ #firstcon14")](https://www.flickr.com/photos/c22/14322110059/)[![The Internet @ the MIT Museumâ€¦ #firstcon14](https://live.staticflickr.com/3867/14479643812_ef9aa76deb_s.jpg "The Internet @ the MIT Museumâ€¦ #firstcon14")](https://www.flickr.com/photos/c22/14479643812/)
[More Photos](https://www.flickr.com/photos/c22/)

### Disclaimer

The contents of this personal blog are solely my own opinions and comments, as such they do not reflect the opinions of my employer(s) past, present or future. No legal liability is accepted for anything you do, think, or consider fact as the basis of articles and links posted on this blog.

"Three to one...two...one...probability factor of one to one...we have normality, I repeat we have normality. Anything you still canâ€™t cope with is therefore your own problem."

Note: A large portion of content I post on my blog comes from "live blogging" of security conferences. These posts are in notes form and are written live during a talk. As such errors and emissions are expected. I'm only human after all!

[â†‘ Top](#wrapper)
[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* Reblog
* Subscribe
  Subscribed

  + [![](https://secure.gravatar.com/blavatar/770e6edec9ad46dc256a0b6e899831fffce8cefdfab8133d02c4f1a8365cab33?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png) CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](https://c22blog.wordpress.com)

  Join 3,178 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fc22blog.wordpress.com%2F2013%2F03%2F11%2Fprivoxy-proxy-authentication-credential-exposure-cve-2013-2503%2F&signup_flow=account)
* Privacy
* + [![](https://secure.gravatar.com/blavatar/770e6edec9ad46dc256a0b6e899831fffce8cefdfab8133d02c4f1a8365cab33?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png) CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](https://c22blog.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fc22blog.wordpress.com%2F2013%2F03%2F11%2Fprivoxy-proxy-authentication-credential-exposure-cve-2013-2503%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/p6I7X-1aB)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://c22blog.wordpress.com/2013/03/11/privoxy-proxy-authentication-credential-exposure-cve-2013-2503/)
  + [View post in Reader](https://wordpress.com/read/blogs/1599597/posts/4501)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from c22blog.wordpress.com_0424384c_20250126_101250.html ===


* [Home](http://blog.c22.cc/)
* [About me](https://c22blog.wordpress.com/about/)
  + [About me](https://c22blog.wordpress.com/about/)
  + [Speed Blogging](https://c22blog.wordpress.com/about/speed-blogging/)
  + [Twitter (@ChrisJohnRiley)](http://www.twitter.com/ChrisJohnRiley)
  + [Twitter (@catch22insec)](http://twitter.com/catch22insec)
  + [Eurotrash Security Podcast](http://www.eurotrashsecurity.eu)
  + [Twitter (@eurotrashsec)](http://twitter.com/eurotrashsec)
  + [PGP Public Key](https://c22blog.wordpress.com/pgp-public-key/)
* [Shared Items](http://feed.c22.cc)
  + [Shared Items](http://feed.c22.cc)
  + [Shared Items (RSS)](http://feeds.feedburner.com/C22SharedItems)
  + [Shared Items (Google Reader archive)](http://www.google.com/reader/shared/ChrisJohnRiley)
* [Tools / Scripts](https://c22blog.wordpress.com/toolsscripts/)
  + [Tools / Scripts](https://c22blog.wordpress.com/toolsscripts/)
  + [Scythe Framework](http://blog.c22.cc/2012/10/03/scythe-framework/)
  + [Apache Log Extractor [Alpha]](https://c22blog.wordpress.com/toolsscripts/apache-log-extractor-alpha/)
  + [UA-Tester](https://c22blog.wordpress.com/toolsscripts/ua-tester/)
  + [Metasploit Modules](https://c22blog.wordpress.com/toolsscripts/metasploit-modules/)
  + [PRN-2-ME](https://c22blog.wordpress.com/toolsscripts/prn-2-me/)
  + [[PoC] scr.im.tessercap (CAPTCHA OCR)](https://c22blog.wordpress.com/toolsscripts/poc-scr-im-tessercap-captcha-ocr/)
  + [[PoC] scr.im-jim](https://c22blog.wordpress.com/toolsscripts/poc-scr-im-jim/)
  + [Typo3 Default Encryption Keys](https://c22blog.wordpress.com/toolsscripts/typ3defenctool/)
* [Media](https://c22blog.wordpress.com/media/)
* [Advisories](https://c22blog.wordpress.com/advisories/)
  + [Advisories](https://c22blog.wordpress.com/advisories/)
  + [CVE-2013-5113/5114 â€“ LastPass Android container PIN and auto-wipe security feature bypass](https://c22blog.wordpress.com/advisories/cve-2013-51135114-lastpass-android-container-pin-and-auto-wipe-security-feature-bypass/)
  + [CVE-2013-2503 â€“ Privoxy Proxy Authentication Credential Exposure](https://c22blog.wordpress.com/advisories/cve-2013-2503-privoxy-proxy-authentication-credential-exposure/)
  + [TYPO3-EXT-SA-2012-003 â€“ t3extplorer](https://c22blog.wordpress.com/advisories/typo3-ext-sa-2012-003-t3extplorer/)
  + [SurveyMonkey: IP Spoofing](http://wp.me/p6I7X-Jh)
  + [SAP Management Console](http://blog.c22.cc/2011/01/09/metasploit-sap-management-console-aux-modules/)
  + [scr.im Captcha Bypass](http://blog.c22.cc/2009/10/07/the-secrets-of-scr-im/)
  + [TYPO3-SA-2010-009 â€“ sr\_feuser\_register](https://c22blog.wordpress.com/advisories/typo3-sa-2010-009-sr_feuser_register/)
  + [TYPO3-SA-2009-001 â€“ Insecure Randomness](https://c22blog.wordpress.com/advisories/typo3-sa-2009-001/)
  + [TYPO3-SA-2009-016 â€“ Install Tool](https://c22blog.wordpress.com/advisories/typo3-sa-2009-016-install-tool/)
  + [TYPO3-SA-2009-016 â€“ felogin](https://c22blog.wordpress.com/advisories/typo3-sa-2009-016-felogin/)
* [Bookshelf](https://c22blog.wordpress.com/books/)

# [CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](https://c22blog.wordpress.com/)

Because we're damned if we do, and we're damned if we don't!

[Home](https://c22blog.wordpress.com/)
## BSidesLondon 2013

[Leave a comment](https://c22blog.wordpress.com/2013/04/19/bsideslondon-2/#respond)
Posted by [ChrisJohnRiley](https://c22blog.wordpress.com/author/catchtwotwo/ "Posts by ChrisJohnRiley") on April 19, 2013

Itâ€™s been a while since Iâ€™ve had the chance to update the blog, and that makes me a sad pandaâ€¦ still, sometimes life gets in the way of the really important stuff. Plus, nobody really reads this crap anyway right!

![](https://i0.wp.com/securityroots.com/assets/dradispro/logo_bsides_2013-36da2abef6f8dbd61a9772737fa509d8.png)Still,Â pleasantriesÂ aside, next week is [BSidesLondon](http://www.securitybsides.org.uk/) (*and a couple of events that run alongside it, such as [44cafe](http://44con.com/44cafe), and that small $vendor thing called [InfoSec Europe](http://www.infosec.co.uk/)*). I was lucky enough to get selected as one of the speakers for this years event, and despite not dressing up like a gay biker, I hope the talk will be interesting. So, if you like number, weird edge cases, or innovative ways to protect web applications, come along to my talk and let me know what you think!

* ### Defense by numbers: Making problems for script kiddies and scanner monkeys

Chris John Riley

Track One 12:45 â€“ 13:30

> On the surface most common browsers (user agents) all look the same, function the same, and deliver web content to the user in a relatively uniformed fashion. Under the surface however, the way specific user agents handle traffic varies in a number of interesting ways. This variation allows for intelligent and skilled defenders to play with attackers and scripted attacks in a way that most normal users will never even see.
>
> This talk will attempt to show that differences in how user agents handle web server responses can be used to improve the defensive posture of a website. Further examples will be given that show specially crafted responses can disrupt common automated attack methods and cause issues for casual attackers and wide scale scanning of websites

Just to warn those brave souls to plan to attendâ€¦ I have LOTS of slidesâ€¦ it could get messy ğŸ˜‰ Iâ€™ll try to put my slides up on [Slideshare](http://www.slideshare.net/ChrisJohnRiley) prior to the talk so people can follow along if they want.

Anyway, as part of the build-up to the conference I wanted to list a few of the talks Iâ€™m really looking forward to seeing (time permitting).

* ### Pentesting like a Grandmaster

Abraham Aranguren

Track One 10:15 â€“ 11:15

> Chess is a complex game: The number of permutations is just too great to compute the best possible move during a game. This is similar to pen testing in that we also have too many vulnerabilities to find and choose from not only on a 1 by 1 basis but also how we would chain them together like a real attacker.Â Chess players must analyse efficiently to beat time constraints like pentesters but unlike pentesters they have been doing this for a long time.

Abrahamâ€™s talks are always interesting, and I expect nothing less from his latest talk. He seems to have a unique way of looking at things and from a sneak peek at his slides, I think this one is going to be another interesting talk point.

* ### Going Stealth: Staying off the Anti-Virus RADAR

Alex Polychronopoulos

Track One 17:00 â€“ 18:00

> Anti-Virus software is often the first line of defence in host based intrusion prevention. For years both black-hats and ethical hackers have researched how to avoid detection â€“ some to compromise hosts reliably and others to improve detection. Executable packers are a popular technique used by virus and malware writers. They â€œpackâ€ their malicious payload by compressing and/or encrypting it and they distribute it with enough clear-text instructions to â€œunpackâ€ it. In particular, weâ€™ll look at basic AV detection concepts and the basic design principles for packers. Weâ€™ll also touch on advanced techniques like polymorphism and metamorphism. Youâ€™ll leave marvelling that your AV ever catches anything at all.

Sometimes AV is the only standing between a good penetration tester and total dominationâ€¦ Anything we can do to test the limits of AV and maybe get that elusive shell is certainly worth the time to learn. Hoping for a few hints and tips here that might help in those situations.

* ### How to build a personal security brand that will stop the hackers, save the world and get you the girl

Javvad Malik

Track Two 11:30 â€“ 12:30

> Youâ€™re a security professional, but even your boss doesnâ€™t remember your name. Your brilliant ideas arenâ€™t listened to, youâ€™re never invited to speak at conferences and not even your mother visits your blog.Â In this talk I will take you down a journey of self-discovery that took me 3 years and went from another faceless security dude, to someone in control of my personal security brand. What worked, what didnâ€™t work and all the behind-the-curtain magic exposed.Â If youâ€™re into building your personal brand, making your voice heard amongst the 100â€™s of security â€˜rockstarsâ€™ and dinosaurs who get all the attention â€“ this is the talk for you to attend.

Fuck rockstarsâ€¦ no really, in this industry we need solutions, not primadonas with a god complex. Still, that said, having a brand and a platform to shout from is something we need. Plus Javvad is wicked funny and Iâ€™m sure heâ€™ll CISSP mofo everybody in the crowd at LEAST once!

* ### Dissecting Targeted Attacks â€“ Separating Myths from Facts

Candid Wuest

Track Two 14:30 â€“ 15:30

> A lot of media do report on targeted attacks or so-called APTs, but how sophisticated or those attacks really? Flamer & co. are only the tip of the iceberg and even they had flaws. Most of the attacks are not so smart at all, but nevertheless successful. I will elaborate on the common methods of targeted infection & exfiltration, happening every day around the globe. Explaining the methods and tools used by the attackers with real life examples. I will show why they successfully bypass most security tools and analyse where these attacks differ from the common malware flood.

Learn your APT from your elbowâ€¦ not everything is OMGtargetedStateSponsoredBBQ Malware from China with love!

**â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-**

Well, those are my picksâ€¦ so much cool stuff, so little time! Before I sign-off however, I wanted to remind all attendees that itâ€™s your JOB (*yep, attendees also have a job to do*) to give **feedback** to speakers. Even if itâ€™s a single point, an idea, or a pat on the back and â€œthat was coolâ€ commentâ€¦ be part of making the conference betterâ€¦ give feedback or the kitten gets it!

Read my thoughts on â€œGiving feedbackâ€ â€“> [HERE](http://blog.c22.cc/2012/09/24/giving-feedback/)

Hope to see you all in London. Please come up and say hi if youâ€™re aboutâ€¦ I only bite when provoked!

### Rate this:

### Share this:

* [Twitter](https://c22blog.wordpress.com/2013/04/19/bsideslondon-2/?share=twitter "Click to share on Twitter")
* [Facebook](https://c22blog.wordpress.com/2013/04/19/bsideslondon-2/?share=facebook "Click to share on Facebook")
* [LinkedIn](https://c22blog.wordpress.com/2013/04/19/bsideslondon-2/?share=linkedin "Click to share on LinkedIn")
* [Tumblr](https://c22blog.wordpress.com/2013/04/19/bsideslondon-2/?share=tumblr "Click to share on Tumblr")
* [Reddit](https://c22blog.wordpress.com/2013/04/19/bsideslondon-2/?share=reddit "Click to share on Reddit")
Like Loading...
### *Related*

[Conference](https://c22blog.wordpress.com/category/conference/), [Security](https://c22blog.wordpress.com/category/security/)
[BSidesLondon](https://c22blog.wordpress.com/tag/bsideslondon/), [Conference](https://c22blog.wordpress.com/tag/conference/), [presentation](https://c22blog.wordpress.com/tag/presentation/)

[â† Privoxy Proxy Authentication Credential Exposure â€“Â CVE-2013-2503](https://c22blog.wordpress.com/2013/03/11/privoxy-proxy-authentication-credential-exposure-cve-2013-2503/) [Defense by Numbers: Making problems for script kiddies and scannerÂ monkies â†’](https://c22blog.wordpress.com/2013/04/24/defense-by-numbers-making-problems-for-script-kiddies-and-scanner-monkies/)

Comments are closed.

[RSS feed](https://c22blog.wordpress.com/feed/)
### Recent Posts

* [[DeepSec 2015]50 Shades ofÂ WAF](https://c22blog.wordpress.com/2015/11/19/deepsec-201550-shades-of-waf/)
* [[DeepSec 2015] File Format Fuzzing in Android â€“ Giving a Stagefright to the AndroidÂ Installer](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-file-format-fuzzing-in-android-giving-a-stagefright-to-the-android-installer/)
* [[DeepSec 2015]How to Break XML Encryption â€“Â Automatically](https://c22blog.wordpress.com/2015/11/19/deepsec-2015how-to-break-xml-encryption-automatically/)
* [[DeepSec 2015] Hacking Cookies in Modern Web Applications andÂ Browsers](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-hacking-cookies-in-modern-web-applications-and-browsers/)
* [[DeepSec 2015] Can societies manage the SIGINTÂ monster?](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-can-societies-manage-the-sigint-monster/)
* [[LHS Microcast] DeepSecÂ 2015](https://c22blog.wordpress.com/2015/10/19/lhs-microcase-deepsec-2015/)
* [[LHS Microcast] Interview w/ JenÂ Ellis](https://c22blog.wordpress.com/2015/10/02/lhs-microcast-interview-w-jen-ellis/)
* [Taking out theÂ Eurotrash](https://c22blog.wordpress.com/2014/12/23/taking-out-the-eurotrash/)
* [All good things must come to anÂ end](https://c22blog.wordpress.com/2014/12/22/all-good-things-must-come-to-an-end/)
* [[DeepSec 2014] Advanced Powershell Threat: Lethal Client Side Attacks usingÂ Powershell](https://c22blog.wordpress.com/2014/11/21/deepsec-2014-advanced-powershell-threat-lethal-client-side-attacks-using-powershell/)
[![](http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png)](http://creativecommons.org/licenses/by-nc-sa/3.0/)
### Archives

Archives
Select Month
 November 2015 Â (5)
 October 2015 Â (2)
 December 2014 Â (2)
 November 2014 Â (5)
 October 2014 Â (1)
 September 2014 Â (1)
 August 2014 Â (1)
 July 2014 Â (1)
 April 2014 Â (1)
 January 2014 Â (1)
 December 2013 Â (2)
 October 2013 Â (1)
 September 2013 Â (1)
 August 2013 Â (2)
 July 2013 Â (1)
 June 2013 Â (1)
 May 2013 Â (1)
 April 2013 Â (2)
 March 2013 Â (1)
 February 2013 Â (1)
 December 2012 Â (4)
 November 2012 Â (2)
 October 2012 Â (2)
 September 2012 Â (2)
 August 2012 Â (1)
 July 2012 Â (2)
 June 2012 Â (3)
 May 2012 Â (3)
 April 2012 Â (3)
 March 2012 Â (8)
 February 2012 Â (7)
 January 2012 Â (7)
 December 2011 Â (11)
 November 2011 Â (17)
 October 2011 Â (6)
 September 2011 Â (9)
 August 2011 Â (6)
 July 2011 Â (10)
 June 2011 Â (5)
 May 2011 Â (3)
 April 2011 Â (9)
 March 2011 Â (5)
 February 2011 Â (1)
 January 2011 Â (11)
 December 2010 Â (3)
 November 2010 Â (12)
 October 2010 Â (6)
 September 2010 Â (11)
 August 2010 Â (9)
 July 2010 Â (21)
 June 2010 Â (8)
 May 2010 Â (7)
 April 2010 Â (13)
 March 2010 Â (7)
 February 2010 Â (1)
 January 2010 Â (3)
 December 2009 Â (17)
 November 2009 Â (6)
 October 2009 Â (6)
 September 2009 Â (21)
 August 2009 Â (15)
 July 2009 Â (9)
 June 2009 Â (5)
 May 2009 Â (3)
 April 2009 Â (5)
 March 2009 Â (4)
 February 2009 Â (5)
 January 2009 Â (4)
 December 2008 Â (18)
 November 2008 Â (6)
 October 2008 Â (5)
 September 2008 Â (10)
 August 2008 Â (7)
 July 2008 Â (7)
 June 2008 Â (1)
 March 2008 Â (3)
 February 2008 Â (4)
 January 2008 Â (4)
 December 2007 Â (5)
 November 2007 Â (8)
 October 2007 Â (6)
 September 2007 Â (8)
 August 2007 Â (6)

[![ChrisJohnRiley on Twitter](http://twittercounter.com/counter/?username=ChrisJohnRiley)](http://twitter.com/ChrisJohnRiley)

### [@ChrisJohnRiley](http://twitter.com/ChrisJohnRiley)

[Tweets by ChrisJohnRiley](https://twitter.com/ChrisJohnRiley)
###

[![Computer History Museum (Mountain View, CA)](https://live.staticflickr.com/7642/16171126653_504b9e28d2_s.jpg "Computer History Museum (Mountain View, CA)")](https://www.flickr.com/photos/c22/16171126653/)[![Hmmâ€¦ no tanks. Why did nobody tell me earlier!](https://live.staticflickr.com/7518/15658163086_92a02df283_s.jpg "Hmmâ€¦ no tanks. Why did nobody tell me earlier!")](https://www.flickr.com/photos/c22/15658163086/)[![Huge Organâ€¦ #firstcon14](https://live.staticflickr.com/5591/14322110059_07bec335c6_s.jpg "Huge Organâ€¦ #firstcon14")](https://www.flickr.com/photos/c22/14322110059/)[![The Internet @ the MIT Museumâ€¦ #firstcon14](https://live.staticflickr.com/3867/14479643812_ef9aa76deb_s.jpg "The Internet @ the MIT Museumâ€¦ #firstcon14")](https://www.flickr.com/photos/c22/14479643812/)
[More Photos](https://www.flickr.com/photos/c22/)

### Disclaimer

The contents of this personal blog are solely my own opinions and comments, as such they do not reflect the opinions of my employer(s) past, present or future. No legal liability is accepted for anything you do, think, or consider fact as the basis of articles and links posted on this blog.

"Three to one...two...one...probability factor of one to one...we have normality, I repeat we have normality. Anything you still canâ€™t cope with is therefore your own problem."

Note: A large portion of content I post on my blog comes from "live blogging" of security conferences. These posts are in notes form and are written live during a talk. As such errors and emissions are expected. I'm only human after all!

[â†‘ Top](#wrapper)
[Create a free website or blog at WordPress.com.](https://wordpress.com/?ref=footer_website)

* Reblog
* Subscribe
  Subscribed

  + [![](https://secure.gravatar.com/blavatar/770e6edec9ad46dc256a0b6e899831fffce8cefdfab8133d02c4f1a8365cab33?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png) CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](https://c22blog.wordpress.com)

  Join 3,178 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fc22blog.wordpress.com%2F2013%2F04%2F19%2Fbsideslondon-2%2F&signup_flow=account)
* Privacy
* + [![](https://secure.gravatar.com/blavatar/770e6edec9ad46dc256a0b6e899831fffce8cefdfab8133d02c4f1a8365cab33?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png) CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](https://c22blog.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fc22blog.wordpress.com%2F2013%2F04%2F19%2Fbsideslondon-2%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/p6I7X-1bI)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://c22blog.wordpress.com/2013/04/19/bsideslondon-2/)
  + [View post in Reader](https://wordpress.com/read/blogs/1599597/posts/4570)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from c22blog.wordpress.com_89e9f352_20250126_101249.html ===


* [Home](http://blog.c22.cc/)
* [About me](https://c22blog.wordpress.com/about/)
  + [About me](https://c22blog.wordpress.com/about/)
  + [Speed Blogging](https://c22blog.wordpress.com/about/speed-blogging/)
  + [Twitter (@ChrisJohnRiley)](http://www.twitter.com/ChrisJohnRiley)
  + [Twitter (@catch22insec)](http://twitter.com/catch22insec)
  + [Eurotrash Security Podcast](http://www.eurotrashsecurity.eu)
  + [Twitter (@eurotrashsec)](http://twitter.com/eurotrashsec)
  + [PGP Public Key](https://c22blog.wordpress.com/pgp-public-key/)
* [Shared Items](http://feed.c22.cc)
  + [Shared Items](http://feed.c22.cc)
  + [Shared Items (RSS)](http://feeds.feedburner.com/C22SharedItems)
  + [Shared Items (Google Reader archive)](http://www.google.com/reader/shared/ChrisJohnRiley)
* [Tools / Scripts](https://c22blog.wordpress.com/toolsscripts/)
  + [Tools / Scripts](https://c22blog.wordpress.com/toolsscripts/)
  + [Scythe Framework](http://blog.c22.cc/2012/10/03/scythe-framework/)
  + [Apache Log Extractor [Alpha]](https://c22blog.wordpress.com/toolsscripts/apache-log-extractor-alpha/)
  + [UA-Tester](https://c22blog.wordpress.com/toolsscripts/ua-tester/)
  + [Metasploit Modules](https://c22blog.wordpress.com/toolsscripts/metasploit-modules/)
  + [PRN-2-ME](https://c22blog.wordpress.com/toolsscripts/prn-2-me/)
  + [[PoC] scr.im.tessercap (CAPTCHA OCR)](https://c22blog.wordpress.com/toolsscripts/poc-scr-im-tessercap-captcha-ocr/)
  + [[PoC] scr.im-jim](https://c22blog.wordpress.com/toolsscripts/poc-scr-im-jim/)
  + [Typo3 Default Encryption Keys](https://c22blog.wordpress.com/toolsscripts/typ3defenctool/)
* [Media](https://c22blog.wordpress.com/media/)
* [Advisories](https://c22blog.wordpress.com/advisories/)
  + [Advisories](https://c22blog.wordpress.com/advisories/)
  + [CVE-2013-5113/5114 â€“ LastPass Android container PIN and auto-wipe security feature bypass](https://c22blog.wordpress.com/advisories/cve-2013-51135114-lastpass-android-container-pin-and-auto-wipe-security-feature-bypass/)
  + [CVE-2013-2503 â€“ Privoxy Proxy Authentication Credential Exposure](https://c22blog.wordpress.com/advisories/cve-2013-2503-privoxy-proxy-authentication-credential-exposure/)
  + [TYPO3-EXT-SA-2012-003 â€“ t3extplorer](https://c22blog.wordpress.com/advisories/typo3-ext-sa-2012-003-t3extplorer/)
  + [SurveyMonkey: IP Spoofing](http://wp.me/p6I7X-Jh)
  + [SAP Management Console](http://blog.c22.cc/2011/01/09/metasploit-sap-management-console-aux-modules/)
  + [scr.im Captcha Bypass](http://blog.c22.cc/2009/10/07/the-secrets-of-scr-im/)
  + [TYPO3-SA-2010-009 â€“ sr\_feuser\_register](https://c22blog.wordpress.com/advisories/typo3-sa-2010-009-sr_feuser_register/)
  + [TYPO3-SA-2009-001 â€“ Insecure Randomness](https://c22blog.wordpress.com/advisories/typo3-sa-2009-001/)
  + [TYPO3-SA-2009-016 â€“ Install Tool](https://c22blog.wordpress.com/advisories/typo3-sa-2009-016-install-tool/)
  + [TYPO3-SA-2009-016 â€“ felogin](https://c22blog.wordpress.com/advisories/typo3-sa-2009-016-felogin/)
* [Bookshelf](https://c22blog.wordpress.com/books/)

# [CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](https://c22blog.wordpress.com/)

Because we're damned if we do, and we're damned if we don't!

[Home](https://c22blog.wordpress.com/)
## CVE-2013-2503 â€“ Privoxy Proxy Authentication CredentialÂ Exposure

[Leave a comment](https://c22blog.wordpress.com/advisories/cve-2013-2503-privoxy-proxy-authentication-credential-exposure/#respond)

## **Privoxy Proxy Authentication Credential Exposure**

**Product**: Privoxy

**Project Homepage**: [privoxy.org](http://privoxy.org)

**Advisory ID**: c22-2013-01

**Vulnerable Version(s)**: 3.0.20 (and possibly prior)

**Tested Version**: 3.0.20-1 (tested using Debian Sid)

**Vendor Notification**: March 6, 2013

**Public Disclosure**: March 11, 2013

**Vulnerability Type**: Insufficiently Protected Credentials [CWE-522]

**CVE Reference**: CVE-2013-2503

**Risk Level**: Medium

**CVSSv2 Base Score**: 4.3 (AV:N/AC:M/Au:N/C:P/I:N/A:N)

**Discovery**: Chris John Riley ( <http://blog.c22.cc> )

### Advisory Details:

During research into browser and proxy server handling of HTTP Response Codes, an issue with the way that Privoxy handles HTTP Response code 407 â€œProxy Authentication Requiredâ€ was discovered. Privoxy in versions 3.0.20 (and possibly prior) ignores the presence of â€œProxy-Authenticateâ€ and â€œProxy-Authorizationâ€ headers and allows these values to be passed to and from a remote server without modification. *******The resulting behavior could allow a malicious websites to spoof a******* ********Proxy-Authentication response appearing to originate from the Privoxy******** *********service. The Privoxy user will then be prompted for a username and********* **********password that appears to originate from the Privoxy software.**********

#### Scenario*:*

1. A Privoxy user visits a website using a browser of their choice
2. The remote website responds to the request with a 407 â€œProxy Authentication Requiredâ€ HTTP response code and the appropriate â€œProxy-Authenticate: Basicâ€ HTTP response header
3. This response is passed through the Privoxy service without modification to the users browser
4. **As the browser is configured to use a proxy server, the browser** *******believes that the upstream proxy (Privoxy) has requested******* ********authentication and prompts the user for a username and password. This******** *********prompt states that the proxy server at â€œ127.0.0.1:8118â€ requires********* **********authentication (this prompt may vary if Privoxy is running on a********** ***********machine other than localhost and/or on a non-default port number)***********
5. ************If the user enters a username and password, the browser will send************ *************a request through Privoxy to the remote website with a************* **************â€œProxy-Authorization: XXXXXXXXâ€ HTTP request header (where XXXXXXX is************** ***************a base64 encoded version of the username and password the user*************** ****************entered at the browsers proxy authentication prompt)****************
6. *****************The remote website receives this header and can store or re-use***************** ******************these captured credentials******************

#### Proof of Concept:

<http://c22.cc/POC/c22-2013-01.php>

*The above URL will respond with a â€œProxy-Authenticate: basicâ€ header* **when a request is received that does no contain a** ***â€œProxy-Authorizationâ€ header. This will prompt the users browser to*** ****request a username/password from the user. If you enter a value in the**** *****username/password box and click ok, it will send a Base64 encoded***** ******version to the remote website (the server will display the response****** *******headers at the bottom of the resulting page under request headers (one******* ********of the values will be â€œProxy-Authorizationâ€ with a base64 encoded******** *********version of the entered username/password). For a full walkthrough it********* **********is suggested to capture this in your favourite packet capture program********** ***********and walk through the requests to view the entire process.***********

**Note* â€“> The above POC does not store any data sent to the server,* **however it is suggested to use bogus credentials if testing this proof of** ***concept.***

#### Solution:

The following solution was suggested and implemented in Privoxy 3.0.21 stable.

> *Proxy authentication headers are removed unless the new directive* **enable-proxy-authentication-forwarding is used. Forwarding the headers** ***potentionally allows malicious sites to trick the user into providing*** ****it with login information.****

**References**:

Privoxy 3.0.21 ChangeLog â€“> <http://ijbswa.cvs.sourceforge.net/viewvc/ijbswa/current/ChangeLog?revision=1.188&view=markup>

#### Vulnerability Timeline:

March 5, 2013 20:00 â€“ Initial discovery of vulnerability

March 6, 2013 14:48 > Emailed Privoxy developer list to request a security contact

March 6, 2013 15:26 < Received response with dedicated security contact information

March 6, 2013 16:01 > Emailed details of the vulnerability to security contact

March 6, 2013 17:19 < Received response acknowledging issue. Fix indicated in upcoming release

March 6, 2013 18:38 > Acknowledged receipt of email and advised of updated CVSSv2 score

March 7, 2013 15:50 < Received response detailing proposed fix, including link to CVS check-in of new code

March 7, 2013 18:48 > Acknowledged receipt of email

March 9, 2013 16:54 > Emailed CVE number to security contact and requested information on release plans

March 10, 2013 14:28 < Received confirmation of release timeline

March 10, 2013 14:58 â€“ Release of Privoxy 3.0.21 stable

March 11, 2013 07:30 â€“ Release of advisory

### Share this:

* [Twitter](https://c22blog.wordpress.com/advisories/cve-2013-2503-privoxy-proxy-authentication-credential-exposure/?share=twitter "Click to share on Twitter")
* [Facebook](https://c22blog.wordpress.com/advisories/cve-2013-2503-privoxy-proxy-authentication-credential-exposure/?share=facebook "Click to share on Facebook")
* [LinkedIn](https://c22blog.wordpress.com/advisories/cve-2013-2503-privoxy-proxy-authentication-credential-exposure/?share=linkedin "Click to share on LinkedIn")
* [Tumblr](https://c22blog.wordpress.com/advisories/cve-2013-2503-privoxy-proxy-authentication-credential-exposure/?share=tumblr "Click to share on Tumblr")
* [Reddit](https://c22blog.wordpress.com/advisories/cve-2013-2503-privoxy-proxy-authentication-credential-exposure/?share=reddit "Click to share on Reddit")
Like Loading...

### Leave a comment

Î”

[RSS feed](https://c22blog.wordpress.com/feed/)
### Recent Posts

* [[DeepSec 2015]50 Shades ofÂ WAF](https://c22blog.wordpress.com/2015/11/19/deepsec-201550-shades-of-waf/)
* [[DeepSec 2015] File Format Fuzzing in Android â€“ Giving a Stagefright to the AndroidÂ Installer](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-file-format-fuzzing-in-android-giving-a-stagefright-to-the-android-installer/)
* [[DeepSec 2015]How to Break XML Encryption â€“Â Automatically](https://c22blog.wordpress.com/2015/11/19/deepsec-2015how-to-break-xml-encryption-automatically/)
* [[DeepSec 2015] Hacking Cookies in Modern Web Applications andÂ Browsers](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-hacking-cookies-in-modern-web-applications-and-browsers/)
* [[DeepSec 2015] Can societies manage the SIGINTÂ monster?](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-can-societies-manage-the-sigint-monster/)
* [[LHS Microcast] DeepSecÂ 2015](https://c22blog.wordpress.com/2015/10/19/lhs-microcase-deepsec-2015/)
* [[LHS Microcast] Interview w/ JenÂ Ellis](https://c22blog.wordpress.com/2015/10/02/lhs-microcast-interview-w-jen-ellis/)
* [Taking out theÂ Eurotrash](https://c22blog.wordpress.com/2014/12/23/taking-out-the-eurotrash/)
* [All good things must come to anÂ end](https://c22blog.wordpress.com/2014/12/22/all-good-things-must-come-to-an-end/)
* [[DeepSec 2014] Advanced Powershell Threat: Lethal Client Side Attacks usingÂ Powershell](https://c22blog.wordpress.com/2014/11/21/deepsec-2014-advanced-powershell-threat-lethal-client-side-attacks-using-powershell/)
[![](http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png)](http://creativecommons.org/licenses/by-nc-sa/3.0/)
### Archives

Archives
Select Month
 November 2015 Â (5)
 October 2015 Â (2)
 December 2014 Â (2)
 November 2014 Â (5)
 October 2014 Â (1)
 September 2014 Â (1)
 August 2014 Â (1)
 July 2014 Â (1)
 April 2014 Â (1)
 January 2014 Â (1)
 December 2013 Â (2)
 October 2013 Â (1)
 September 2013 Â (1)
 August 2013 Â (2)
 July 2013 Â (1)
 June 2013 Â (1)
 May 2013 Â (1)
 April 2013 Â (2)
 March 2013 Â (1)
 February 2013 Â (1)
 December 2012 Â (4)
 November 2012 Â (2)
 October 2012 Â (2)
 September 2012 Â (2)
 August 2012 Â (1)
 July 2012 Â (2)
 June 2012 Â (3)
 May 2012 Â (3)
 April 2012 Â (3)
 March 2012 Â (8)
 February 2012 Â (7)
 January 2012 Â (7)
 December 2011 Â (11)
 November 2011 Â (17)
 October 2011 Â (6)
 September 2011 Â (9)
 August 2011 Â (6)
 July 2011 Â (10)
 June 2011 Â (5)
 May 2011 Â (3)
 April 2011 Â (9)
 March 2011 Â (5)
 February 2011 Â (1)
 January 2011 Â (11)
 December 2010 Â (3)
 November 2010 Â (12)
 October 2010 Â (6)
 September 2010 Â (11)
 August 2010 Â (9)
 July 2010 Â (21)
 June 2010 Â (8)
 May 2010 Â (7)
 April 2010 Â (13)
 March 2010 Â (7)
 February 2010 Â (1)
 January 2010 Â (3)
 December 2009 Â (17)
 November 2009 Â (6)
 October 2009 Â (6)
 September 2009 Â (21)
 August 2009 Â (15)
 July 2009 Â (9)
 June 2009 Â (5)
 May 2009 Â (3)
 April 2009 Â (5)
 March 2009 Â (4)
 February 2009 Â (5)
 January 2009 Â (4)
 December 2008 Â (18)
 November 2008 Â (6)
 October 2008 Â (5)
 September 2008 Â (10)
 August 2008 Â (7)
 July 2008 Â (7)
 June 2008 Â (1)
 March 2008 Â (3)
 February 2008 Â (4)
 January 2008 Â (4)
 December 2007 Â (5)
 November 2007 Â (8)
 October 2007 Â (6)
 September 2007 Â (8)
 August 2007 Â (6)

[![ChrisJohnRiley on Twitter](http://twittercounter.com/counter/?username=ChrisJohnRiley)](http://twitter.com/ChrisJohnRiley)

### [@ChrisJohnRiley](http://twitter.com/ChrisJohnRiley)

[Tweets by ChrisJohnRiley](https://twitter.com/ChrisJohnRiley)
###

[![Computer History Museum (Mountain View, CA)](https://live.staticflickr.com/7642/16171126653_504b9e28d2_s.jpg "Computer History Museum (Mountain View, CA)")](https://www.flickr.com/photos/c22/16171126653/)[![Hmmâ€¦ no tanks. Why did nobody tell me earlier!](https://live.staticflickr.com/7518/15658163086_92a02df283_s.jpg "Hmmâ€¦ no tanks. Why did nobody tell me earlier!")](https://www.flickr.com/photos/c22/15658163086/)[![Huge Organâ€¦ #firstcon14](https://live.staticflickr.com/5591/14322110059_07bec335c6_s.jpg "Huge Organâ€¦ #firstcon14")](https://www.flickr.com/photos/c22/14322110059/)[![The Internet @ the MIT Museumâ€¦ #firstcon14](https://live.staticflickr.com/3867/14479643812_ef9aa76deb_s.jpg "The Internet @ the MIT Museumâ€¦ #firstcon14")](https://www.flickr.com/photos/c22/14479643812/)
[More Photos](https://www.flickr.com/photos/c22/)

### Disclaimer

The contents of this personal blog are solely my own opinions and comments, as such they do not reflect the opinions of my employer(s) past, present or future. No legal liability is accepted for anything you do, think, or consider fact as the basis of articles and links posted on this blog.

"Three to one...two...one...probability factor of one to one...we have normality, I repeat we have normality. Anything you still canâ€™t cope with is therefore your own problem."

Note: A large portion of content I post on my blog comes from "live blogging" of security conferences. These posts are in notes form and are written live during a talk. As such errors and emissions are expected. I'm only human after all!

[â†‘ Top](#wrapper)
[Create a free website or blog at WordPress.com.](https://wordpress.com/?ref=footer_website)

* Subscribe
  Subscribed

  + [![](https://secure.gravatar.com/blavatar/770e6edec9ad46dc256a0b6e899831fffce8cefdfab8133d02c4f1a8365cab33?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png) CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](https://c22blog.wordpress.com)

  Join 3,178 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fc22blog.wordpress.com%2Fadvisories%2Fcve-2013-2503-privoxy-proxy-authentication-credential-exposure%2F&signup_flow=account)
* Privacy
* + [![](https://secure.gravatar.com/blavatar/770e6edec9ad46dc256a0b6e899831fffce8cefdfab8133d02c4f1a8365cab33?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png) CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](https://c22blog.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fc22blog.wordpress.com%2Fadvisories%2Fcve-2013-2503-privoxy-proxy-authentication-credential-exposure%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/P6I7X-1Ox)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://c22blog.wordpress.com/advisories/cve-2013-2503-privoxy-proxy-authentication-credential-exposure/)
  + [View post in Reader](https://wordpress.com/read/blogs/1599597/posts/6977)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from lists.opensuse.org_3f78416e_20250125_161607.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/GJHWTAFJLBO75NNMATSXBNYEIZAKRMKR/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/GJHWTAFJLBO75NNMATSXBNYEIZAKRMKR/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/GJHWTAFJLBO75NNMATSXBNYEIZAKRMKR/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/GJHWTAFJLBO75NNMATSXBNYEIZAKRMKR/)

Ã—
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/GJHWTAFJLBO75NNMATSXBNYEIZAKRMKR/#GJHWTAFJLBO75NNMATSXBNYEIZAKRMKR)

# openSUSE-SU-2013:0564-1: moderate: privoxy: update to 3.0.21 to fix security issues and bugs

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-securityï¼ opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-securityï¼ opensuse.org")

31 Mar
2013

31 Mar
'13

01:04

openSUSE Security Update: privoxy: update to 3.0.21 to fix security issues and bugs
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2013:0564-1
Rating: moderate
References: #809123
Cross-References: CVE-2013-2503
Affected Products:
openSUSE 11.4
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes one vulnerability is now available.
Description:
privoxy was updated to 3.0.21 stable fo fix CVE-2013-2503
(bnc#809123)
- changes in 3.0.21
\* On POSIX-like platforms, network sockets with file
descriptor values above FD\_SETSIZE are properly
rejected. Previously they could cause memory corruption
in configurations that allowed the limit to be reached.
\* Proxy authentication headers are removed unless the new
directive enable-proxy-authentication-forwarding is
used. Forwarding the headers potentionally allows
malicious sites to trick the user into providing them
with login information. Reported by Chris John Riley.
\* Compiles on OS/2 again now that unistd.h is only
included on platforms that have it.
\* The show-status page shows the
FEATURE\_STRPTIME\_SANITY\_CHECKS status.
\* A couple of assert()s that could theoretically
dereference NULL pointers in debug builds have been
relocated.
\* Added an LSB info block to the generic start script.
Based on a patch from Natxo Asenjo.
\* The max-client-connections default has been changed to
128 which should be more than enough for most setups.
\* Block rover.ebay./ar.\*\&adtype= instead of
"/.\*\&adtype=" which caused too man false positives.
Reported by u302320 in #360284, additional feedback from
Adam Piggott.
\* Unblock '.advrider.com/' and '/.\*ADVrider'. Anonymously
reported in #3603636.
\* Stop blocking '/js/slider\.js'. Reported by Adam Piggott
in #3606635 and \_lvm in #2791160.
\* Added an iframes filter.
\* The whole GPLv2 text is included in the user manual now,
so Privoxy can serve it itself and the user can read it
without having to wade through GPLv3 ads first.
\* Properly numbered and underlined a couple of section
titles in the config that where previously overlooked
due to a flaw in the conversion script. Reported by Ralf
Jungblut.
\* Improved the support instruction to hopefully make it
harder to unintentionally provide insufficient
information when requesting support. Previously it
wasn't obvious that the information we need in bug
reports is usually also required in support requests.
\* Removed documentation about packages that haven't been
provided in years.
\* Only log the test number when not running in verbose
mode The position of the test is rarely relevant and it
previously
- for full list of changes see ChangeLog file shipped
together with this package
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 11.4:
zypper in -t patch 2013-51
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 11.4 (i586 x86\_64):
privoxy-3.0.21-7.1
privoxy-debuginfo-3.0.21-7.1
privoxy-debugsource-3.0.21-7.1
privoxy-doc-3.0.21-7.1
References:
<http://support.novell.com/security/cve/CVE-2013-2503.html>
<https://bugzilla.novell.com/809123>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/GJHWTAFJLBO75NNMATSXBNYEIZAKRMKR/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/GJHWTAFJLBO75NNMATSXBNYEIZAKRMKR/#GJHWTAFJLBO75NNMATSXBNYEIZAKRMKR)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from c22blog.wordpress.com_64a92170_20250126_101249.html ===


* [Home](http://blog.c22.cc/)
* [About me](https://c22blog.wordpress.com/about/)
  + [About me](https://c22blog.wordpress.com/about/)
  + [Speed Blogging](https://c22blog.wordpress.com/about/speed-blogging/)
  + [Twitter (@ChrisJohnRiley)](http://www.twitter.com/ChrisJohnRiley)
  + [Twitter (@catch22insec)](http://twitter.com/catch22insec)
  + [Eurotrash Security Podcast](http://www.eurotrashsecurity.eu)
  + [Twitter (@eurotrashsec)](http://twitter.com/eurotrashsec)
  + [PGP Public Key](https://c22blog.wordpress.com/pgp-public-key/)
* [Shared Items](http://feed.c22.cc)
  + [Shared Items](http://feed.c22.cc)
  + [Shared Items (RSS)](http://feeds.feedburner.com/C22SharedItems)
  + [Shared Items (Google Reader archive)](http://www.google.com/reader/shared/ChrisJohnRiley)
* [Tools / Scripts](https://c22blog.wordpress.com/toolsscripts/)
  + [Tools / Scripts](https://c22blog.wordpress.com/toolsscripts/)
  + [Scythe Framework](http://blog.c22.cc/2012/10/03/scythe-framework/)
  + [Apache Log Extractor [Alpha]](https://c22blog.wordpress.com/toolsscripts/apache-log-extractor-alpha/)
  + [UA-Tester](https://c22blog.wordpress.com/toolsscripts/ua-tester/)
  + [Metasploit Modules](https://c22blog.wordpress.com/toolsscripts/metasploit-modules/)
  + [PRN-2-ME](https://c22blog.wordpress.com/toolsscripts/prn-2-me/)
  + [[PoC] scr.im.tessercap (CAPTCHA OCR)](https://c22blog.wordpress.com/toolsscripts/poc-scr-im-tessercap-captcha-ocr/)
  + [[PoC] scr.im-jim](https://c22blog.wordpress.com/toolsscripts/poc-scr-im-jim/)
  + [Typo3 Default Encryption Keys](https://c22blog.wordpress.com/toolsscripts/typ3defenctool/)
* [Media](https://c22blog.wordpress.com/media/)
* [Advisories](https://c22blog.wordpress.com/advisories/)
  + [Advisories](https://c22blog.wordpress.com/advisories/)
  + [CVE-2013-5113/5114 â€“ LastPass Android container PIN and auto-wipe security feature bypass](https://c22blog.wordpress.com/advisories/cve-2013-51135114-lastpass-android-container-pin-and-auto-wipe-security-feature-bypass/)
  + [CVE-2013-2503 â€“ Privoxy Proxy Authentication Credential Exposure](https://c22blog.wordpress.com/advisories/cve-2013-2503-privoxy-proxy-authentication-credential-exposure/)
  + [TYPO3-EXT-SA-2012-003 â€“ t3extplorer](https://c22blog.wordpress.com/advisories/typo3-ext-sa-2012-003-t3extplorer/)
  + [SurveyMonkey: IP Spoofing](http://wp.me/p6I7X-Jh)
  + [SAP Management Console](http://blog.c22.cc/2011/01/09/metasploit-sap-management-console-aux-modules/)
  + [scr.im Captcha Bypass](http://blog.c22.cc/2009/10/07/the-secrets-of-scr-im/)
  + [TYPO3-SA-2010-009 â€“ sr\_feuser\_register](https://c22blog.wordpress.com/advisories/typo3-sa-2010-009-sr_feuser_register/)
  + [TYPO3-SA-2009-001 â€“ Insecure Randomness](https://c22blog.wordpress.com/advisories/typo3-sa-2009-001/)
  + [TYPO3-SA-2009-016 â€“ Install Tool](https://c22blog.wordpress.com/advisories/typo3-sa-2009-016-install-tool/)
  + [TYPO3-SA-2009-016 â€“ felogin](https://c22blog.wordpress.com/advisories/typo3-sa-2009-016-felogin/)
* [Bookshelf](https://c22blog.wordpress.com/books/)

# [CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](https://c22blog.wordpress.com/)

Because we're damned if we do, and we're damned if we don't!

[Home](https://c22blog.wordpress.com/)
## [[DeepSec 2015]50 Shades ofÂ WAF](https://c22blog.wordpress.com/2015/11/19/deepsec-201550-shades-of-waf/)

Comments Off on [DeepSec 2015]50 Shades ofÂ WAF
Posted by [ChrisJohnRiley](https://c22blog.wordpress.com/author/catchtwotwo/ "Posts by ChrisJohnRiley") on November 19, 2015

[Mastodon](https://infosec.exchange/%40ChrisJohnRiley)

[![DeepSecLogo](https://c22blog.wordpress.com/wp-content/uploads/2014/11/deepseclogo.png?w=630)](https://c22blog.wordpress.com/wp-content/uploads/2014/11/deepseclogo.png)

[50 Shades of WAF â€“ Exemplified at Barracuda & Sucuri](https://deepsec.net/speaker.html#PSLOT213)

Ashar Javed (Hyundai AutoEver Europe GmbH)

> This talk will present 50 (25\*2) bypasses of Barracuda and Sucuriâ€™s WAF default signatures that deal with Cross-Site Scripting (XSS). 150,000 organizations worldwide including Fortune 1000 companies are using Barracuda while around 10,000 web applications are behind Sucuriâ€™s cloud-based WAF. The XSS bypasses we will present in this talk are also applicable to other WAFs. All bypasses were responsibly reported to the vendors and most of them were fixed. Further, we will show XSS in Barracudaâ€™s admin interface and in their web application. Finally, we will present one unfixed bypass of Barracuda and Sucuri and will see how quickly vendors will react to fix it, given it will make thousands of sites vulnerable.

### Barracuda

150,000 organizations use Barracuda Networks technology.

Over 10 monthsÂ during 2014/2015 Barracuda had 7 updates of their ruleset, none of which included XSS. 6 months after that, they released 5 updates and 1 firmware patch that included fixes for XSS issues. Updating is hard, meaning there are a lot of WAFs out there that are letting XSS attacks through.

How to detect Barracudaâ€¦ if you see this message, then youâ€™re looking at Barracuda:

> The specified URL cannot be found

After testing the regular expressions used to detect XSS, their was a number of XSS discovered.

#### Event Handlers

4 separate regexes handling event handlers.

Large number of event handlers missing, and the ones in the regex are hard-coded (for logging and tracking purposes).

* ontoggle
* onsearch
* onlaungaugechange
* oncuechange
* ondragexit
* â€¦

Moving to a more generic event handler detection e.g. on(.\*) would catch these.

However, even if the event handler was detected it was bypassable. However the logic didnâ€™t allow for backtick (`) which is supported in some browsers. It was also possible to bypass by injecting a newline between the equals and quotes (onclick=%0Aâ€stuffâ€). This was due to the use of â€œ.â€ in the regex, which matches anything except a newline.

meta tags where also treated differently, resulting in a number of ways of bypassing the filters. The same issues existed in a number of html tags.

Some other issues that cause bypasses:

* Tags < 10 chars
* Tags alphanumeric
* Tags are closed properly
* Data URI JS injection (resulted in multiple issues)
* expression

All these Regexes work together to detect issues. However these are not always turned on. They need to activated, and whitelisting specific checks may have a knock-on effect in other areas where mutliple regexes are needed for detection.

Constant tweaks to the payload and complexity of the regexes results in false positives. The knock-on effect of this is disabling of protections, which lowers overall the level of security.

Some of the bypasses effected the BarracudaNetworks.com login page and stored XSS in their main admin interface.

***Takeaway***: Updated to 1.102 version and apply the firmware patch 8.0.1

### Sucuri

Cloud-based WAFâ€¦ priced cheaper than a takeaway pizza.

Sucuri offers a bug bounty (through [HackerOne](https://hackerone.com/sucuri)) on bypasses.

A large number of bypasses using encoding, backticks, unclosed tags, VBscriptâ€¦

Blocked all onmouse\*, onkey\*, and many many more. Blacklists are a zero sum game.

Blocking of script tags appeared work well, however <script%2fsrc was a workable bypass technique. Thereâ€™s always new bypasses, and almost an endless way to bypass the protections given enough time.

### Conclusion

WAFs are not the only protection layer. It can be an extra layer, but not the only defense.

**Links:**

* Presentation [Abstract](https://deepsec.net/speaker.html#PSLOT213)
* Ashar JavedÂ [Twitter](%40soaj1664ashar)

[Conference](https://c22blog.wordpress.com/category/conference/), [Security](https://c22blog.wordpress.com/category/security/) [deepsec](https://c22blog.wordpress.com/tag/deepsec/)

## [[DeepSec 2015] File Format Fuzzing in Android â€“ Giving a Stagefright to the AndroidÂ Installer](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-file-format-fuzzing-in-android-giving-a-stagefright-to-the-android-installer/)

Comments Off on [DeepSec 2015] File Format Fuzzing in Android â€“ Giving a Stagefright to the AndroidÂ Installer
Posted by [ChrisJohnRiley](https://c22blog.wordpress.com/author/catchtwotwo/ "Posts by ChrisJohnRiley") on November 19, 2015

[![DeepSecLogo](https://c22blog.wordpress.com/wp-content/uploads/2014/11/deepseclogo.png?w=630)](https://c22blog.wordpress.com/wp-content/uploads/2014/11/deepseclogo.png)

[File Format Fuzzing in Android â€“ Giving a Stagefright to the Android Installer](https://deepsec.net/speaker.html#PSLOT199)

*Alexandru Blanda (Intel Corporation)*

> The presentation focuses on revealing a fuzzing approach that can beÂ used to uncover different types of vulnerabilities inside multiple coreÂ system components of the Android OS. The session will be targeted onÂ exposing the general idea behind this approach and how it applies toÂ several real-life targets from the Android OS, with examples of actualÂ discovered vulnerabilities. These vulnerabilities affect criticalÂ components of the Android OS and the audience will have the opportunityÂ to learn about the way they were discovered and possible exploitÂ scenarios. The most important targets that will be included in the talk: the Android APK installer and the Stagefright media framework.

###

An approach that can be used for file-format fuzzing on Android

### File Format Fuzzing

First steps in file format fuzzing:

* Data Generation
* Log process (Execute Tests)
* Triage mechanism
* Analyze and Debug crashes

If the fuzzing is successful, triage and categorization of the issues is an important step to avoid being overwhelmed by responses.

*Data Generation*

Mutational vs. generational Fuzzing

Maintain the structural validity of the file being processed. The target needs to accept that the file is valid otherwise it wonâ€™t run.

Tools use for test-case generation:

* Basic Fuzzing Framework (BFF)
* FuzzBox
* Radamsa
* American Fuzzy Lop (AFL)

*Log Process*

To find out whatâ€™s happening with the test-cases we send to the Android device, we need to check the logs. This can be read out using the logcat on the device. This can be done by looking for Fatal messages and seeding the logcat before and after the run to identify the test case details and information required to reproduce.

```
adb shell logcat -v time *:F
```

*Triage Mechanism*

Each time a crash occurs a tombstone file is created under /data/tombstones and /data/system/dropbox. This data is important to have for triaging the issues and tracking the various crashes.

By looking at the value where the crash occurs you can collect a unique list of crashes without duplicates.

1. Parse logcat for input that causes crashes
2. Execute input to cause the crash again
3. Grab the Tombstone data to check against existing know issues

*Analyze and Debug Crashes*

After triage maybe you have 2 or 3 interesting crashes to investigate. Using the Tombstone data can give a good indication of the severity and location of where the crash occurs. Dmesg also gives a good source of information.

Using gdbserver you can debug crashes on the device. gdb can then be used to start a remote debugging session (make sure you set the Android debugging symbols).

addr2line can be useful in getting the information on where the call took place (example: where libstagefright called libc.so)

### Fuzzing the Stagefright Media Framework

Media files are interesting attack vectors as the contain complex data and result in a large attack surface (audio, video, images, etcâ€¦). Media files are also seen as innocuous to users, and can be played through various sources without the users consent (MMS etc..).

Easiest way to test was the build the stagefright CLI toolÂ (frameworks/av/cmds/stagefright) and calling it from the Android command line for testing.

Initially started fuzzing in early 2014â€¦ thousands of crashes (needed a triage mechanism to cope). First severe issues reported to Google in September 2014.

### Fuzzing the Android application installer

The application installer is an attractive target (runs with high system privileges). If an attacker can exploit this, the impact will be high. The installer also allows for unprivileged users to send input to system components.

The process of application installation differs between ART and Dalvik (Lollipop and KitKat respectively).

Extract the APK, fuzz the components to be tested, repack

ART is easier as alterations can be made without extraction.

Modifications to the APK will result in anÂ application signature mismatch. This means that the APK will need to be re-signed before testing.

### Fuzzing with AFL in Android

Android port of the tool developed by Adrian Denkiewicz of Intel

Using alongsideÂ [MFFA](https://github.com/fuzzing/MFFA)Â to discover issues. In some cases, AFL reported crashes that could not be confirmed when running the test case singularly.

This method of testing showed some results that were not seen in other tests (1 high RCE issue, and several low severity issues).

**Links:**

* Presentation [Abstract](https://deepsec.net/speaker.html#PSLOT199)
* PresentationÂ [Paper](https://www.blackhat.com/docs/eu-15/materials/eu-15-Blanda-Fuzzing-Android-A-Recipe-For-Uncovering-Vulnerabilities-Inside-System-Components-In-Android-wp.pdf)
* Alexandru Blanda [Twitter](%40bigdinrock)

[Conference](https://c22blog.wordpress.com/category/conference/), [Security](https://c22blog.wordpress.com/category/security/) [deepsec](https://c22blog.wordpress.com/tag/deepsec/)

## [[DeepSec 2015]How to Break XML Encryption â€“Â Automatically](https://c22blog.wordpress.com/2015/11/19/deepsec-2015how-to-break-xml-encryption-automatically/)

Comments Off on [DeepSec 2015]How to Break XML Encryption â€“Â Automatically
Posted by [ChrisJohnRiley](https://c22blog.wordpress.com/author/catchtwotwo/ "Posts by ChrisJohnRiley") on November 19, 2015

[![DeepSecLogo](https://c22blog.wordpress.com/wp-content/uploads/2014/11/deepseclogo.png?w=630)](https://c22blog.wordpress.com/wp-content/uploads/2014/11/deepseclogo.png)

[How to Break XML Encryption â€“ Automatically](https://deepsec.net/speaker.html#PSLOT198)

*Juraj Somorovsky (Ruhr University Bochum)*

> In recent years, XML Encryption became a target of several new attacks. These attacks belong to the family of adaptive chosen-ciphertext attacks, and allow an adversary to decrypt symmetric and asymmetric XML ciphertexts, without knowing the secret keys. In order toprotect XML Encryption implementations, the World Wide Web Consortium (W3C) published an updated version of the standard.
>
> Unfortunately, most of the current XML Encryption implementations do not support the newest standard and offer different XML Security configurations to protect confidentiality of the exchanged messages. Resulting from the attack and specification complexity, evaluation of the security configuration correctness becomes tedious and error prone.
>
> In this talk, we will first give an overview on Web Service specific attacks. Afterwards, we present attacks on XML Encryption and how to evaluate security of XML Encryption interfaces automatically. Our algorithm can detect a vulnerability and exploit it to retrieve a plaintext from an encrypted message. To assess practicability of our approach, we implemented an open source attack plugin for Web Service attacking tool called WS-Attacker. With the plugin, we discovered new security problems in four out of five analyzed Web Service implementations, including IBM Datapower or Apache CXF.

### What is a WebService and XML Security

SOAP WebService are a standard that allows you to execute a function on the server and receive a response (remote procedure calls). This range from simple to very complex requests.

There are many ways to secure this communication. SSL/TLS can be used to secure the tunnel between the client and server (transport communication). The broker however (the server in this case) can see the data. To stops this from happening, you need to encrypt the data within the SOAP request using something like XML Security.

XML Security consists of 2 standards (XML Signature and XML Encryption). This can be used to protect to the entire document, or sections individually.

### XML Signature Wrapping

One of the problems of XML Security is XML Signature wrapping. As the XML signature should protect against alteration to the document, by allowing validation of specific elements.

An attacker can howeverÂ relocate the signed element, maintaining the valid signature. Then an attacker can add additional data to the request that are understood by the application layer. As the verification and application logic are separate, the verification will pass due to the presence of a valid signature. The application will then accept the attackers data as validated when it hasnâ€™t been confirmed at the validation layer.

This problem was seen in 2011 in Amazon Web Services by bypassing signed SOAP requests. This resulted in the ability for an active attacker to alter the SOAP data and start instances without permission.

Further attacks against SAML were performed, where <10 out of 22 systems tested were vulnerable to signature wrapping attacks.

### Attacks on XML encryption

In most cases XML Encryption uses a hybrid encryption scheme (Asymmetric and symmetric keys). Published attacks (2011/2012) exist for both portions of the encryption (adapted chosen-ciphertext attacks) using the server as an oracle.

XML is a text-based data format. Therefore it must be parsed to be understood (usually ASCII encoded). Certain ASCII characters are not parseable or can be excluded. This reduces the understood character set and makes the attack easier.

*Validity oracle*

1. Content Decryption
2. XML parsing
3. XML Evaluation

Be using this oracle and checking the error type returned, itâ€™s possible to see if the failure occurs at the decryption of parsing phase.

This attack is made possible as an attacker can flip bits in the request. Cipher Block Chaining Mode has been discussed previously in several padding oracle attacks.

Performance (against Symmetric encryption): 14 queries / pain-text byte

### How to analyze WebServices Automatically

WS-Attacker tool â€“Â https://github.com/RUB-NDS/WS-Attacker

Automated tool to validate attacks against WebServices, implementing XML Signature wrapping and sending requests to the oracle to validate if the system is vulnerable.

If the oracle can be identified, the attack is performed.

Examples of vulnerable systems discovered in testing:

* Apache Axis2
* Apache CXF
* Axway Gateway
* IBM DataPower
* Microsoft WCF

###

Countermeasures that were in place for Apache CXF were found to be incorrectly implemented, resulting it being vulnerable to attack.

### Conclusion

XML is very complicated, so application of XML Encryption should be validated using tools like WS-Attacker to ensure that itâ€™s not vulnerable.

This attack is also applies to other scenarios like SAML, JSON, Web Crypto

Prefer authentication encryption (AES-GCM instead of AES-CBC)

**Links:**

* Presentation [Abstract](https://deepsec.net/speaker.html#PSLOT198)
* Juraj Somorovsky [Twitter](%40jurajsomorovsky)
* WS-Attacker â€“Â [Github](https://github.com/RUB-NDS/WS-Attacker)Â â€“Â [Blogpost](http://web-in-security.blogspot.co.at/2015/04/introduction-to-ws-attacker-xml.html)
* How to Break XML Encryption â€“ AutomaticallyÂ [Paper](https://www.usenix.org/system/files/conference/woot15/woot15-paper-kupser.pdf)

[Conference](https://c22blog.wordpress.com/category/conference/), [Security](https://c22blog.wordpress.com/category/security/) [deepsec](https://c22blog.wordpress.com/tag/deepsec/)

## [[DeepSec 2015] Hacking Cookies in Modern Web Applications andÂ Browsers](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-hacking-cookies-in-modern-web-applications-and-browsers/)

Comments Off on [DeepSec 2015] Hacking Cookies in Modern Web Applications andÂ Browsers
Posted by [ChrisJohnRiley](https://c22blog.wordpress.com/author/catchtwotwo/ "Posts by ChrisJohnRiley") on November 19, 2015

[![DeepSecLogo](https://c22blog.wordpress.com/wp-content/uploads/2014/11/deepseclogo.png?w=630)](https://c22blog.wordpress.com/wp-content/uploads/2014/11/deepseclogo.png)

[Hacking Cookies in Modern Web Applications and Browsers](https://deepsec.net/speaker.html#PSLOT196)

*Dawid Czagan (Silesia Security Lab)*

> Since cookies store sensitive data (session ID, CSRF token, etc.) they are interesting from an attackerâ€™s point of view. As it turns out, quite many web applications (including sensitive ones like bitcoin platforms) have cookie related vulnerabilities, that lead, for example, to user impersonation, remote cookie tampering, XSS and more.
>
> Developers tend to forget that multi-factor authentication does not help if cookies are insecurely processed. Security evaluators underestimate cookie related problems. Moreover, there are problems with the secure processing of cookies in modern browsers. And browser dependent exploitation can be used to launch more powerful attacks.
>
> Thatâ€™s why secure cookie processing (from the perspective of web application and browser) is a subject worth discussing. The following topics will be presented:
>
> â€“ cookie related vulnerabilities in web applications
>
> â€“ insecure processing of secure flag in modern browsers
>
> â€“ bypassing HttpOnly flag in Safari
>
> â€“ problems with Domain attribute in Internet Explorer
>
> â€“ cookie tampering in Safari
>
> â€“ underestimated XSS via cookie
>
> â€“ HTTP Strict Transport Security (HSTS)
>
> â€“ importance of regeneration
>
> â€“ and more

Why are we interested in Cookiesâ€¦

Even when an application enforced 2 Factor Authentication, an attacker can gain access by getting the cookies. Security is always measured at the least protected part. If Cookies arenâ€™t correctly protected, then even a 2FA system can be bypassed.

Many testers underestimate the security issues caused by mis-configured Cookie protections. Exploitation of Cookie related issues is not limited to local attacks.

Browsers also have issues dealing with secure Cookie processing. These kind of issues can be combined with application issues to make attacks on cookies more impactful.

What are the consequences of insecure Cookie processing?

* SQL injection
* XSS
* User impersonation
* â€¦

### Web Application

#### Secure flag and HSTS

Setting â€œSecureâ€ on Cookies protects the confidentiality of the cookies by making sure that they are only send over secure connections.

RFC6265 prevents this cookie being sent over unencrypted HTTP, however it specifically allows an attacker to overwrite a cookie in the browser. This allows an attacker to inject a cookie (new or overwriting an existing cookie) that will be used in the HTTPS protected sessions.

HSTS to the rescueâ€¦ even if a Cookie is not marked as â€œSecureâ€ an HSTS header will tell the browser to only communicate over HTTPS. Therefore itâ€™s not required to set â€œSecureâ€ rightâ€¦ wrong!

Although HSTS works fine, as long as itâ€™s supported by all major browsers. This is not the case with HSTS, as Internet Explorer 10 doesnâ€™t support it.

Setting both â€œSecureâ€ and HSTS is the safest mechanism hereâ€¦ to ensure maximum security.

#### Importance of regeneration

IfÂ session IDs are regenerated after a session change (logon, logout, etcâ€¦) then this may allow an attacker access (session fixation).

An attacker who can learn the value of the Cookie prior to the user authenticating, can re-use this knowledge once the Cookie is authenticated.

All Cookies with sensitive data or used within the application should be regenerated on a state change (include CSRF tokens etcâ€¦)

#### Server-side invalidation

Just because the session cookie is deleted by the users browser, doesnâ€™t mean that itâ€™s invalidated on the server. This can lead to issues where the session remains open, however the server still has a valid session.

#### HttpOnly Flag

Assigning this flag prevents a non-HTTP API (e.g JavaScript) from reading out the session Cookieâ€¦ the theory being, that it can be used to protect against XSS attacks stealing the session Cookies.

Problems here are that RFC6265 talks about â€œreadingâ€ the cookie. However non-HTTP API can still write or overwrite depending on how the RFC is understood and implemented.

Specific browsers (e.g. Safari 9) will allow you to overwrite the cookie. This means that an XSS vulnerability can overwrite the Cookie and switch the user into an attacker controlled account. If the user can then be prompted to enter private data into this session, it is exposed to the attacker.

Combining this with the previously seen session fixation issue (Cookie value not changed after state change). This would allow an attacker to set a known Cookie and use it to gain access to a userâ€™s session once they authenticate.

#### Domain Attribute

RFC6265 says â€“ When a domain attribute is not specified, then it should only be sent to the domain where it originated.

However Internet Explorer 11 sends this Cookie to all subdomains of this domain.

This can be a real issue where a cookie is set on example.com where a sensitive application lives under example.com/wallet. The cookie is set without the domain attribute, according to the RFC. In Internet Explorer 11 this means that the user will also send this Cookie to sub-domains that are less sensitive, meaning an XSS in test.example.com can read out the Cookie value.

This kind of leakage can happen to externally hosted domains. As the rules only take effect on the Domain name, the fact that the site is hosted externally is incidental, however may expose sensitive data to a 3rd party vendor.

#### Cookie Tampering

Safari 9 allows comma-separated lists of Cookies (taken from the obsoleted RFC2109)

Example:

```
/index.php?lang=de,%20PHPSESSID=abc
```

As this is taken from the request and put into the Set-Cookie header, it allows an attacker fully remotely to tamper with the Cookie jar of the user. This allows changing the users account, as discussed previously.

Itâ€™s also possible to perform XSS via Cookie without locally setting a Cookie.

#### Underestimated XS via Cookie

Commonly this issue has a low assigned risk as the Cookie value has to be set locally. However if you can gain access to a low sensitive website on a subdomain like x.example.com, you can set a Cookie for y.example.com in order to exploit the user without local access to the browser.

Response splitting also allows exploitation of this issue, by allowing an attacker to set a Cookie by injecting a Set-Cookie header to place the XSS into the browserâ€™s Cookie Jar.

###

### Conclusions

* Educate development teams about the risks of Cookies
* Discuss/improve RFC 6265
* Cooperate with Browser vendors

**Links:**

* Presentation [Abstract](https://deepsec.net/speaker.html#PSLOT196)
* Dawid Czagan [Twitter](%40dawidczagan)
* RFC [6265](https://tools.ietf.org/html/rfc6265)

[Conference](https://c22blog.wordpress.com/category/conference/), [Security](https://c22blog.wordpress.com/category/security/) [deepsec](https://c22blog.wordpress.com/tag/deepsec/)

[â† Older posts](https://c22blog.wordpress.com/page/2/)

[RSS feed](https://c22blog.wordpress.com/feed/)
### Recent Posts

* [[DeepSec 2015]50 Shades ofÂ WAF](https://c22blog.wordpress.com/2015/11/19/deepsec-201550-shades-of-waf/)
* [[DeepSec 2015] File Format Fuzzing in Android â€“ Giving a Stagefright to the AndroidÂ Installer](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-file-format-fuzzing-in-android-giving-a-stagefright-to-the-android-installer/)
* [[DeepSec 2015]How to Break XML Encryption â€“Â Automatically](https://c22blog.wordpress.com/2015/11/19/deepsec-2015how-to-break-xml-encryption-automatically/)
* [[DeepSec 2015] Hacking Cookies in Modern Web Applications andÂ Browsers](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-hacking-cookies-in-modern-web-applications-and-browsers/)
* [[DeepSec 2015] Can societies manage the SIGINTÂ monster?](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-can-societies-manage-the-sigint-monster/)
* [[LHS Microcast] DeepSecÂ 2015](https://c22blog.wordpress.com/2015/10/19/lhs-microcase-deepsec-2015/)
* [[LHS Microcast] Interview w/ JenÂ Ellis](https://c22blog.wordpress.com/2015/10/02/lhs-microcast-interview-w-jen-ellis/)
* [Taking out theÂ Eurotrash](https://c22blog.wordpress.com/2014/12/23/taking-out-the-eurotrash/)
* [All good things must come to anÂ end](https://c22blog.wordpress.com/2014/12/22/all-good-things-must-come-to-an-end/)
* [[DeepSec 2014] Advanced Powershell Threat: Lethal Client Side Attacks usingÂ Powershell](https://c22blog.wordpress.com/2014/11/21/deepsec-2014-advanced-powershell-threat-lethal-client-side-attacks-using-powershell/)
[![](http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png)](http://creativecommons.org/licenses/by-nc-sa/3.0/)
### Archives

Archives
Select Month
 November 2015 Â (5)
 October 2015 Â (2)
 December 2014 Â (2)
 November 2014 Â (5)
 October 2014 Â (1)
 September 2014 Â (1)
 August 2014 Â (1)
 July 2014 Â (1)
 April 2014 Â (1)
 January 2014 Â (1)
 December 2013 Â (2)
 October 2013 Â (1)
 September 2013 Â (1)
 August 2013 Â (2)
 July 2013 Â (1)
 June 2013 Â (1)
 May 2013 Â (1)
 April 2013 Â (2)
 March 2013 Â (1)
 February 2013 Â (1)
 December 2012 Â (4)
 November 2012 Â (2)
 October 2012 Â (2)
 September 2012 Â (2)
 August 2012 Â (1)
 July 2012 Â (2)
 June 2012 Â (3)
 May 2012 Â (3)
 April 2012 Â (3)
 March 2012 Â (8)
 February 2012 Â (7)
 January 2012 Â (7)
 December 2011 Â (11)
 November 2011 Â (17)
 October 2011 Â (6)
 September 2011 Â (9)
 August 2011 Â (6)
 July 2011 Â (10)
 June 2011 Â (5)
 May 2011 Â (3)
 April 2011 Â (9)
 March 2011 Â (5)
 February 2011 Â (1)
 January 2011 Â (11)
 December 2010 Â (3)
 November 2010 Â (12)
 October 2010 Â (6)
 September 2010 Â (11)
 August 2010 Â (9)
 July 2010 Â (21)
 June 2010 Â (8)
 May 2010 Â (7)
 April 2010 Â (13)
 March 2010 Â (7)
 February 2010 Â (1)
 January 2010 Â (3)
 December 2009 Â (17)
 November 2009 Â (6)
 October 2009 Â (6)
 September 2009 Â (21)
 August 2009 Â (15)
 July 2009 Â (9)
 June 2009 Â (5)
 May 2009 Â (3)
 April 2009 Â (5)
 March 2009 Â (4)
 February 2009 Â (5)
 January 2009 Â (4)
 December 2008 Â (18)
 November 2008 Â (6)
 October 2008 Â (5)
 September 2008 Â (10)
 August 2008 Â (7)
 July 2008 Â (7)
 June 2008 Â (1)
 March 2008 Â (3)
 February 2008 Â (4)
 January 2008 Â (4)
 December 2007 Â (5)
 November 2007 Â (8)
 October 2007 Â (6)
 September 2007 Â (8)
 August 2007 Â (6)

[![ChrisJohnRiley on Twitter](http://twittercounter.com/counter/?username=ChrisJohnRiley)](http://twitter.com/ChrisJohnRiley)

### [@ChrisJohnRiley](http://twitter.com/ChrisJohnRiley)

[Tweets by ChrisJohnRiley](https://twitter.com/ChrisJohnRiley)
###

[![Computer History Museum (Mountain View, CA)](https://live.staticflickr.com/7642/16171126653_504b9e28d2_s.jpg "Computer History Museum (Mountain View, CA)")](https://www.flickr.com/photos/c22/16171126653/)[![Hmmâ€¦ no tanks. Why did nobody tell me earlier!](https://live.staticflickr.com/7518/15658163086_92a02df283_s.jpg "Hmmâ€¦ no tanks. Why did nobody tell me earlier!")](https://www.flickr.com/photos/c22/15658163086/)[![Huge Organâ€¦ #firstcon14](https://live.staticflickr.com/5591/14322110059_07bec335c6_s.jpg "Huge Organâ€¦ #firstcon14")](https://www.flickr.com/photos/c22/14322110059/)[![The Internet @ the MIT Museumâ€¦ #firstcon14](https://live.staticflickr.com/3867/14479643812_ef9aa76deb_s.jpg "The Internet @ the MIT Museumâ€¦ #firstcon14")](https://www.flickr.com/photos/c22/14479643812/)
[More Photos](https://www.flickr.com/photos/c22/)

### Disclaimer

The contents of this personal blog are solely my own opinions and comments, as such they do not reflect the opinions of my employer(s) past, present or future. No legal liability is accepted for anything you do, think, or consider fact as the basis of articles and links posted on this blog.

"Three to one...two...one...probability factor of one to one...we have normality, I repeat we have normality. Anything you still canâ€™t cope with is therefore your own problem."

Note: A large portion of content I post on my blog comes from "live blogging" of security conferences. These posts are in notes form and are written live during a talk. As such errors and emissions are expected. I'm only human after all!

[â†‘ Top](#wrapper)
[Create a free website or blog at WordPress.com.](https://wordpress.com/?ref=footer_website)

* Subscribe
  Subscribed

  + [![](https://secure.gravatar.com/blavatar/770e6edec9ad46dc256a0b6e899831fffce8cefdfab8133d02c4f1a8365cab33?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png) CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](https://c22blog.wordpress.com)

  Join 3,178 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fc22blog.wordpress.com%2F2015%2F11%2F19%2Fdeepsec-201550-shades-of-waf%2F&signup_flow=account)
* Privacy
* + [![](https://secure.gravatar.com/blavatar/770e6edec9ad46dc256a0b6e899831fffce8cefdfab8133d02c4f1a8365cab33?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png) CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](https://c22blog.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fc22blog.wordpress.com%2F2015%2F11%2F19%2Fdeepsec-201550-shades-of-waf%2F&signup_flow=account)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://c22blog.wordpress.com)
  + [View site in Reader](https://wordpress.com/read/feeds/164766308)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

![](https://pixel.wp.com/b.gif?v=noscript)


=== Content from c22blog.wordpress.com_74e5030d_20250126_101250.html ===


* [Home](http://blog.c22.cc/)
* [About me](https://c22blog.wordpress.com/about/)
  + [About me](https://c22blog.wordpress.com/about/)
  + [Speed Blogging](https://c22blog.wordpress.com/about/speed-blogging/)
  + [Twitter (@ChrisJohnRiley)](http://www.twitter.com/ChrisJohnRiley)
  + [Twitter (@catch22insec)](http://twitter.com/catch22insec)
  + [Eurotrash Security Podcast](http://www.eurotrashsecurity.eu)
  + [Twitter (@eurotrashsec)](http://twitter.com/eurotrashsec)
  + [PGP Public Key](https://c22blog.wordpress.com/pgp-public-key/)
* [Shared Items](http://feed.c22.cc)
  + [Shared Items](http://feed.c22.cc)
  + [Shared Items (RSS)](http://feeds.feedburner.com/C22SharedItems)
  + [Shared Items (Google Reader archive)](http://www.google.com/reader/shared/ChrisJohnRiley)
* [Tools / Scripts](https://c22blog.wordpress.com/toolsscripts/)
  + [Tools / Scripts](https://c22blog.wordpress.com/toolsscripts/)
  + [Scythe Framework](http://blog.c22.cc/2012/10/03/scythe-framework/)
  + [Apache Log Extractor [Alpha]](https://c22blog.wordpress.com/toolsscripts/apache-log-extractor-alpha/)
  + [UA-Tester](https://c22blog.wordpress.com/toolsscripts/ua-tester/)
  + [Metasploit Modules](https://c22blog.wordpress.com/toolsscripts/metasploit-modules/)
  + [PRN-2-ME](https://c22blog.wordpress.com/toolsscripts/prn-2-me/)
  + [[PoC] scr.im.tessercap (CAPTCHA OCR)](https://c22blog.wordpress.com/toolsscripts/poc-scr-im-tessercap-captcha-ocr/)
  + [[PoC] scr.im-jim](https://c22blog.wordpress.com/toolsscripts/poc-scr-im-jim/)
  + [Typo3 Default Encryption Keys](https://c22blog.wordpress.com/toolsscripts/typ3defenctool/)
* [Media](https://c22blog.wordpress.com/media/)
* [Advisories](https://c22blog.wordpress.com/advisories/)
  + [Advisories](https://c22blog.wordpress.com/advisories/)
  + [CVE-2013-5113/5114 â€“ LastPass Android container PIN and auto-wipe security feature bypass](https://c22blog.wordpress.com/advisories/cve-2013-51135114-lastpass-android-container-pin-and-auto-wipe-security-feature-bypass/)
  + [CVE-2013-2503 â€“ Privoxy Proxy Authentication Credential Exposure](https://c22blog.wordpress.com/advisories/cve-2013-2503-privoxy-proxy-authentication-credential-exposure/)
  + [TYPO3-EXT-SA-2012-003 â€“ t3extplorer](https://c22blog.wordpress.com/advisories/typo3-ext-sa-2012-003-t3extplorer/)
  + [SurveyMonkey: IP Spoofing](http://wp.me/p6I7X-Jh)
  + [SAP Management Console](http://blog.c22.cc/2011/01/09/metasploit-sap-management-console-aux-modules/)
  + [scr.im Captcha Bypass](http://blog.c22.cc/2009/10/07/the-secrets-of-scr-im/)
  + [TYPO3-SA-2010-009 â€“ sr\_feuser\_register](https://c22blog.wordpress.com/advisories/typo3-sa-2010-009-sr_feuser_register/)
  + [TYPO3-SA-2009-001 â€“ Insecure Randomness](https://c22blog.wordpress.com/advisories/typo3-sa-2009-001/)
  + [TYPO3-SA-2009-016 â€“ Install Tool](https://c22blog.wordpress.com/advisories/typo3-sa-2009-016-install-tool/)
  + [TYPO3-SA-2009-016 â€“ felogin](https://c22blog.wordpress.com/advisories/typo3-sa-2009-016-felogin/)
* [Bookshelf](https://c22blog.wordpress.com/books/)

# [CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](https://c22blog.wordpress.com/)

Because we're damned if we do, and we're damned if we don't!

[Home](https://c22blog.wordpress.com/)
## CVE-2013-5113/5114 â€“ LastPass Android container PIN and auto-wipe security featureÂ bypass

[Leave a comment](https://c22blog.wordpress.com/advisories/cve-2013-51135114-lastpass-android-container-pin-and-auto-wipe-security-feature-bypass/#respond)

LastPass Android container PIN and auto-wipe security feature bypass

Product: LastPass (Android)

Project Homepage: lastpass.com

Internal Advisory ID: c22-2013-02

Vulnerable Version(s): Android version 2.0.4 (and prior)

Tested Version: Android 2.0.4 (Android 4.2/4.3)

Vendor Notification: Aug 13, 2013

Public Disclosure: November 13, 2013

Vulnerability Type: Authentication Bypass Issues [CWE-592]

CVE Reference: CVE-2013-5113, CVE-2013-5114

Issue Severity: Important impact

CVSSv2 Base Score: 6.6 (AV:L/AC:L/AU:N/C:C/I:C/A:N)

Discovery: Chris John Riley ( <http://blog.c22.cc> )

Advisory Details:

Effected versions of LastPass on the Android platform allow

for users with limited access via the ADB (Android Debug Bridge)

interface of an Android device (USB debugging enabled, no root access

required) to perform backup and restore of applications and application

data. The ADB backup functionality requires an Android device running

the Ice-Cream Sandwich version of Android (4.x) or above.

LastPass on Android allows the user to store the lastpass.com username

and password within the Android container, and set a PIN to prevent

unauthorized access in the event the device is lost or stolen. This

PIN protection also sets an auto-wipe feature that will delete

application data after 10 false logons.

Due to the way recent versions of Android implements the backup and

restore process, both the implemented PIN protection and the enforced

auto-wipe can be avoided and entirely bypassed to allow attackers the

ability to clear or recover the PIN from application settings data

stored in LPandroid.xml.

Using a simple process, it is possible for an attacker with physical

access to a device to backup the LastPass Android container and remove

any PIN protections present on the application. It is also possible to

restore the LastPass Android container to a secondary device and

maintain live access to changes made by the user either via the

lastpass.com web interface or the original deviceâ€™s LastPass Android

application. This exposes not only cached username and password data

stored within the LastPass Android container acquired by an attacker, but

also any changes made after the fact.

Impact:

Attackers can extract and possibly maintain access to a user?s LastPass

data from a lost or stolen device. This effectively allows an attacker

the ability to use the recovered credentials from LastPass to perform

account takeover using the LastPass data.

Process:

1) Gain physical access to an Android device containing the LastPass

application

2) Enable USB debugging (if not already enabled)

3) Perform backup of the LastPass application using ADB

(adb backup com.lastpass.lpandroid)

4) Extract the resulting Android Backup file (using for example the

ab\_unpacker.py tool available here â€“>

<https://github.com/ChrisJohnRiley/Random_Code/tree/master/android%20backup>

5) Edit the extracted LPandroid.xml file to remove the following values

passwordrepromptonactive

pincodeforreprompt

requirepin

6) Repack the directory structure (using for example the

ab\_upacker.py tool available here â€“>

<https://github.com/ChrisJohnRiley/Random_Code/tree/master/android%20backup>

7) Restore to either the original device or a secondary attacker

controlled Android device using ADB (adb restore edited\_backup.ab)

Solution:

LastPass have released a new version to the Google Play store that

corrects these issue by disabling the ability to perform an ADB backup

of the LastPass container. It has been confirmed that the version

2.5.1 is no longer directly susceptible to this attack method.

References:

At this time LastPass have not provided an advisory discussing the issue

> [A sneak peek into Android â€œSecureâ€ Containers](https://blog.c22.cc/2013/09/05/a-sneak-peak-into-android-secure-containers-2/)

> [BSidesLV: Android Backup [un]packerÂ release](https://blog.c22.cc/2013/08/01/bsideslv-android-backup-unpacker-release/)

Vulnerability Timeline:

May, 2013 â€“ Initial discovery of vulnerability

Aug 13, 2013 â€“ LastPass contacted with request for secure communications

Aug 13, 2013 â€“ Response from LastPass setting up secure communications

Aug 13, 2013 â€“ Details reported to LastPass

Aug 13, 2013 â€“ Clarification of issue

Aug 13, 2013 â€“ Response from LastPass that allowBackup:false is now set

in all new releases (change already implemented in testing prior to

the report being received)

Aug 16, 2013 â€“ CVE numbers sent to LastPass

Aug 28, 2013 â€“ Name added to LastPass acknowledgements page

Sept 05, 2013 â€“ Response that issues resolved to LastPassâ€™s satisfaction

Sept 05, 2013 â€“ Re-Tested and advised of new bypass

Sept 05, 2013 â€“ Blog post released demonstrating process

Sept 06, 2013 â€“ Acceptance of risk associated with new Bypass (low risk)

Nov 13, 2013 â€“ Advisory released (delayed)

### Share this:

* [Twitter](https://c22blog.wordpress.com/advisories/cve-2013-51135114-lastpass-android-container-pin-and-auto-wipe-security-feature-bypass/?share=twitter "Click to share on Twitter")
* [Facebook](https://c22blog.wordpress.com/advisories/cve-2013-51135114-lastpass-android-container-pin-and-auto-wipe-security-feature-bypass/?share=facebook "Click to share on Facebook")
* [LinkedIn](https://c22blog.wordpress.com/advisories/cve-2013-51135114-lastpass-android-container-pin-and-auto-wipe-security-feature-bypass/?share=linkedin "Click to share on LinkedIn")
* [Tumblr](https://c22blog.wordpress.com/advisories/cve-2013-51135114-lastpass-android-container-pin-and-auto-wipe-security-feature-bypass/?share=tumblr "Click to share on Tumblr")
* [Reddit](https://c22blog.wordpress.com/advisories/cve-2013-51135114-lastpass-android-container-pin-and-auto-wipe-security-feature-bypass/?share=reddit "Click to share on Reddit")
Like Loading...

### Leave a comment

Î”

[RSS feed](https://c22blog.wordpress.com/feed/)
### Recent Posts

* [[DeepSec 2015]50 Shades ofÂ WAF](https://c22blog.wordpress.com/2015/11/19/deepsec-201550-shades-of-waf/)
* [[DeepSec 2015] File Format Fuzzing in Android â€“ Giving a Stagefright to the AndroidÂ Installer](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-file-format-fuzzing-in-android-giving-a-stagefright-to-the-android-installer/)
* [[DeepSec 2015]How to Break XML Encryption â€“Â Automatically](https://c22blog.wordpress.com/2015/11/19/deepsec-2015how-to-break-xml-encryption-automatically/)
* [[DeepSec 2015] Hacking Cookies in Modern Web Applications andÂ Browsers](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-hacking-cookies-in-modern-web-applications-and-browsers/)
* [[DeepSec 2015] Can societies manage the SIGINTÂ monster?](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-can-societies-manage-the-sigint-monster/)
* [[LHS Microcast] DeepSecÂ 2015](https://c22blog.wordpress.com/2015/10/19/lhs-microcase-deepsec-2015/)
* [[LHS Microcast] Interview w/ JenÂ Ellis](https://c22blog.wordpress.com/2015/10/02/lhs-microcast-interview-w-jen-ellis/)
* [Taking out theÂ Eurotrash](https://c22blog.wordpress.com/2014/12/23/taking-out-the-eurotrash/)
* [All good things must come to anÂ end](https://c22blog.wordpress.com/2014/12/22/all-good-things-must-come-to-an-end/)
* [[DeepSec 2014] Advanced Powershell Threat: Lethal Client Side Attacks usingÂ Powershell](https://c22blog.wordpress.com/2014/11/21/deepsec-2014-advanced-powershell-threat-lethal-client-side-attacks-using-powershell/)
[![](http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png)](http://creativecommons.org/licenses/by-nc-sa/3.0/)
### Archives

Archives
Select Month
 November 2015 Â (5)
 October 2015 Â (2)
 December 2014 Â (2)
 November 2014 Â (5)
 October 2014 Â (1)
 September 2014 Â (1)
 August 2014 Â (1)
 July 2014 Â (1)
 April 2014 Â (1)
 January 2014 Â (1)
 December 2013 Â (2)
 October 2013 Â (1)
 September 2013 Â (1)
 August 2013 Â (2)
 July 2013 Â (1)
 June 2013 Â (1)
 May 2013 Â (1)
 April 2013 Â (2)
 March 2013 Â (1)
 February 2013 Â (1)
 December 2012 Â (4)
 November 2012 Â (2)
 October 2012 Â (2)
 September 2012 Â (2)
 August 2012 Â (1)
 July 2012 Â (2)
 June 2012 Â (3)
 May 2012 Â (3)
 April 2012 Â (3)
 March 2012 Â (8)
 February 2012 Â (7)
 January 2012 Â (7)
 December 2011 Â (11)
 November 2011 Â (17)
 October 2011 Â (6)
 September 2011 Â (9)
 August 2011 Â (6)
 July 2011 Â (10)
 June 2011 Â (5)
 May 2011 Â (3)
 April 2011 Â (9)
 March 2011 Â (5)
 February 2011 Â (1)
 January 2011 Â (11)
 December 2010 Â (3)
 November 2010 Â (12)
 October 2010 Â (6)
 September 2010 Â (11)
 August 2010 Â (9)
 July 2010 Â (21)
 June 2010 Â (8)
 May 2010 Â (7)
 April 2010 Â (13)
 March 2010 Â (7)
 February 2010 Â (1)
 January 2010 Â (3)
 December 2009 Â (17)
 November 2009 Â (6)
 October 2009 Â (6)
 September 2009 Â (21)
 August 2009 Â (15)
 July 2009 Â (9)
 June 2009 Â (5)
 May 2009 Â (3)
 April 2009 Â (5)
 March 2009 Â (4)
 February 2009 Â (5)
 January 2009 Â (4)
 December 2008 Â (18)
 November 2008 Â (6)
 October 2008 Â (5)
 September 2008 Â (10)
 August 2008 Â (7)
 July 2008 Â (7)
 June 2008 Â (1)
 March 2008 Â (3)
 February 2008 Â (4)
 January 2008 Â (4)
 December 2007 Â (5)
 November 2007 Â (8)
 October 2007 Â (6)
 September 2007 Â (8)
 August 2007 Â (6)

[![ChrisJohnRiley on Twitter](http://twittercounter.com/counter/?username=ChrisJohnRiley)](http://twitter.com/ChrisJohnRiley)

### [@ChrisJohnRiley](http://twitter.com/ChrisJohnRiley)

[Tweets by ChrisJohnRiley](https://twitter.com/ChrisJohnRiley)
###

[![Computer History Museum (Mountain View, CA)](https://live.staticflickr.com/7642/16171126653_504b9e28d2_s.jpg "Computer History Museum (Mountain View, CA)")](https://www.flickr.com/photos/c22/16171126653/)[![Hmmâ€¦ no tanks. Why did nobody tell me earlier!](https://live.staticflickr.com/7518/15658163086_92a02df283_s.jpg "Hmmâ€¦ no tanks. Why did nobody tell me earlier!")](https://www.flickr.com/photos/c22/15658163086/)[![Huge Organâ€¦ #firstcon14](https://live.staticflickr.com/5591/14322110059_07bec335c6_s.jpg "Huge Organâ€¦ #firstcon14")](https://www.flickr.com/photos/c22/14322110059/)[![The Internet @ the MIT Museumâ€¦ #firstcon14](https://live.staticflickr.com/3867/14479643812_ef9aa76deb_s.jpg "The Internet @ the MIT Museumâ€¦ #firstcon14")](https://www.flickr.com/photos/c22/14479643812/)
[More Photos](https://www.flickr.com/photos/c22/)

### Disclaimer

The contents of this personal blog are solely my own opinions and comments, as such they do not reflect the opinions of my employer(s) past, present or future. No legal liability is accepted for anything you do, think, or consider fact as the basis of articles and links posted on this blog.

"Three to one...two...one...probability factor of one to one...we have normality, I repeat we have normality. Anything you still canâ€™t cope with is therefore your own problem."

Note: A large portion of content I post on my blog comes from "live blogging" of security conferences. These posts are in notes form and are written live during a talk. As such errors and emissions are expected. I'm only human after all!

[â†‘ Top](#wrapper)
[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* Subscribe
  Subscribed

  + [![](https://secure.gravatar.com/blavatar/770e6edec9ad46dc256a0b6e899831fffce8cefdfab8133d02c4f1a8365cab33?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png) CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](https://c22blog.wordpress.com)

  Join 3,178 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fc22blog.wordpress.com%2Fadvisories%2Fcve-2013-51135114-lastpass-android-container-pin-and-auto-wipe-security-feature-bypass%2F&signup_flow=account)
* Privacy
* + [![](https://secure.gravatar.com/blavatar/770e6edec9ad46dc256a0b6e899831fffce8cefdfab8133d02c4f1a8365cab33?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png) CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](https://c22blog.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fc22blog.wordpress.com%2Fadvisories%2Fcve-2013-51135114-lastpass-android-container-pin-and-auto-wipe-security-feature-bypass%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/P6I7X-1Oq)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://c22blog.wordpress.com/advisories/cve-2013-51135114-lastpass-android-container-pin-and-auto-wipe-security-feature-bypass/)
  + [View post in Reader](https://wordpress.com/read/blogs/1599597/posts/6970)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from blog.c22.cc_ec7bb494_20250125_161606.html ===


* [Home](http://blog.c22.cc/)
* [About me](https://c22blog.wordpress.com/about/)
  + [About me](https://c22blog.wordpress.com/about/)
  + [Speed Blogging](https://c22blog.wordpress.com/about/speed-blogging/)
  + [Twitter (@ChrisJohnRiley)](http://www.twitter.com/ChrisJohnRiley)
  + [Twitter (@catch22insec)](http://twitter.com/catch22insec)
  + [Eurotrash Security Podcast](http://www.eurotrashsecurity.eu)
  + [Twitter (@eurotrashsec)](http://twitter.com/eurotrashsec)
  + [PGP Public Key](https://c22blog.wordpress.com/pgp-public-key/)
* [Shared Items](http://feed.c22.cc)
  + [Shared Items](http://feed.c22.cc)
  + [Shared Items (RSS)](http://feeds.feedburner.com/C22SharedItems)
  + [Shared Items (Google Reader archive)](http://www.google.com/reader/shared/ChrisJohnRiley)
* [Tools / Scripts](https://c22blog.wordpress.com/toolsscripts/)
  + [Tools / Scripts](https://c22blog.wordpress.com/toolsscripts/)
  + [Scythe Framework](http://blog.c22.cc/2012/10/03/scythe-framework/)
  + [Apache Log Extractor [Alpha]](https://c22blog.wordpress.com/toolsscripts/apache-log-extractor-alpha/)
  + [UA-Tester](https://c22blog.wordpress.com/toolsscripts/ua-tester/)
  + [Metasploit Modules](https://c22blog.wordpress.com/toolsscripts/metasploit-modules/)
  + [PRN-2-ME](https://c22blog.wordpress.com/toolsscripts/prn-2-me/)
  + [[PoC] scr.im.tessercap (CAPTCHA OCR)](https://c22blog.wordpress.com/toolsscripts/poc-scr-im-tessercap-captcha-ocr/)
  + [[PoC] scr.im-jim](https://c22blog.wordpress.com/toolsscripts/poc-scr-im-jim/)
  + [Typo3 Default Encryption Keys](https://c22blog.wordpress.com/toolsscripts/typ3defenctool/)
* [Media](https://c22blog.wordpress.com/media/)
* [Advisories](https://c22blog.wordpress.com/advisories/)
  + [Advisories](https://c22blog.wordpress.com/advisories/)
  + [CVE-2013-5113/5114 â€“ LastPass Android container PIN and auto-wipe security feature bypass](https://c22blog.wordpress.com/advisories/cve-2013-51135114-lastpass-android-container-pin-and-auto-wipe-security-feature-bypass/)
  + [CVE-2013-2503 â€“ Privoxy Proxy Authentication Credential Exposure](https://c22blog.wordpress.com/advisories/cve-2013-2503-privoxy-proxy-authentication-credential-exposure/)
  + [TYPO3-EXT-SA-2012-003 â€“ t3extplorer](https://c22blog.wordpress.com/advisories/typo3-ext-sa-2012-003-t3extplorer/)
  + [SurveyMonkey: IP Spoofing](http://wp.me/p6I7X-Jh)
  + [SAP Management Console](http://blog.c22.cc/2011/01/09/metasploit-sap-management-console-aux-modules/)
  + [scr.im Captcha Bypass](http://blog.c22.cc/2009/10/07/the-secrets-of-scr-im/)
  + [TYPO3-SA-2010-009 â€“ sr\_feuser\_register](https://c22blog.wordpress.com/advisories/typo3-sa-2010-009-sr_feuser_register/)
  + [TYPO3-SA-2009-001 â€“ Insecure Randomness](https://c22blog.wordpress.com/advisories/typo3-sa-2009-001/)
  + [TYPO3-SA-2009-016 â€“ Install Tool](https://c22blog.wordpress.com/advisories/typo3-sa-2009-016-install-tool/)
  + [TYPO3-SA-2009-016 â€“ felogin](https://c22blog.wordpress.com/advisories/typo3-sa-2009-016-felogin/)
* [Bookshelf](https://c22blog.wordpress.com/books/)

# [CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](https://c22blog.wordpress.com/)

Because we're damned if we do, and we're damned if we don't!

[Home](https://c22blog.wordpress.com/)
## Privoxy Proxy Authentication Credential Exposure â€“Â CVE-2013-2503

[1 Comment](https://c22blog.wordpress.com/2013/03/11/privoxy-proxy-authentication-credential-exposure-cve-2013-2503/#respond)
Posted by [ChrisJohnRiley](https://c22blog.wordpress.com/author/catchtwotwo/ "Posts by ChrisJohnRiley") on March 11, 2013

## **Privoxy Proxy Authentication Credential Exposure**

**Product**: Privoxy

**Project Homepage**: [privoxy.org](http://privoxy.org)

**Advisory ID**: c22-2013-01

**Vulnerable Version(s)**: 3.0.20 (and possibly prior)

**Tested Version**: 3.0.20-1 (tested using Debian Sid)

**Vendor Notification**: March 6, 2013

**Public Disclosure**: March 11, 2013

**Vulnerability Type**: Insufficiently Protected Credentials [CWE-522]

**CVE Reference**: CVE-2013-2503

**Risk Level**: Medium

**CVSSv2 Base Score**: 4.3 (AV:N/AC:M/Au:N/C:P/I:N/A:N)

**Discovery**: Chris John Riley ( <http://blog.c22.cc> )

### Advisory Details:

During research into browser and proxy server handling of HTTPÂ Response Codes, an issue with the way that Privoxy handles HTTPÂ Response code 407 â€œProxy Authentication Requiredâ€ was discovered.Â Privoxy in versions 3.0.20 (and possibly prior) ignores the presence ofÂ â€œProxy-Authenticateâ€ and â€œProxy-Authorizationâ€ headers and allows theseÂ values to be passed to and from a remote server without modification.Â *******The resulting behavior could allow a malicious websites to spoof a***************Proxy-Authentication response appearing to originate from the Privoxy*****************service. The Privoxy user will then be prompted for a username and*******************password that appears to originate from the Privoxy software.**********

#### Scenario*:*

1. A Privoxy user visits a website using a browser of their choice
2. The remote website responds to the request with a 407 â€œProxyÂ Authentication Requiredâ€ HTTP response code and the appropriateÂ â€œProxy-Authenticate: Basicâ€ HTTP response header
3. This response is passed through the Privoxy service withoutÂ modification to the users browser
4. **As the browser is configured to use a proxy server, the browser*********believes that the upstream proxy (Privoxy) has requested***************authentication and prompts the user for a username and password. This*****************prompt states that the proxy server at â€œ127.0.0.1:8118â€ requires*******************authentication (this prompt may vary if Privoxy is running on a*********************machine other than localhost and/or on a non-default port number)***********
5. ************If the user enters a username and password, the browser will send*************************a request through Privoxy to the remote website with a***************************â€œProxy-Authorization: XXXXXXXXâ€ HTTP request header (where XXXXXXX is*****************************a base64 encoded version of the username and password the user*******************************entered at the browsers proxy authentication prompt)****************
6. *****************The remote website receives this header and can store or re-use***********************************these captured credentials******************

#### Proof of Concept:

<http://c22.cc/POC/c22-2013-01.php>

*The above URL will respond with a â€œProxy-Authenticate: basicâ€ header***when a request is received that does no contain a*****â€œProxy-Authorizationâ€ header. This will prompt the users browser to*******request a username/password from the user. If you enter a value in the*********username/password box and click ok, it will send a Base64 encoded***********version to the remote website (the server will display the response*************headers at the bottom of the resulting page under request headers (one***************of the values will be â€œProxy-Authorizationâ€ with a base64 encoded*****************version of the entered username/password). For a full walkthrough it*******************is suggested to capture this in yourÂ favouriteÂ packet capture program*********************and walk through the requests to view the entire process.***********

**Note* â€“> The above POC does not store any data sent to the server,***however it is suggested to use bogus credentials if testing this proof of*****concept.***

#### Solution:

The following solution was suggested and implemented in Privoxy 3.0.21 stable.

> *Proxy authentication headers are removed unless the new directive***enable-proxy-authentication-forwarding is used. Forwarding the headers*****potentionally allows malicious sites to trick the user into providing*******it with login information.****

**References**:

Privoxy 3.0.21 ChangeLog â€“> <http://ijbswa.cvs.sourceforge.net/viewvc/ijbswa/current/ChangeLog?revision=1.188&view=markup>

#### Vulnerability Timeline:

March 5, 2013 20:00 â€“ Initial discovery of vulnerability

March 6, 2013 14:48 > Emailed Privoxy developer list to request a security contact

March 6, 2013 15:26 < Received response with dedicated security contact information

March 6, 2013 16:01 > Emailed details of the vulnerability to security contact

March 6, 2013 17:19 < Received response acknowledging issue. Fix indicated in upcoming release

March 6, 2013 18:38 > Acknowledged receipt of email and advised of updated CVSSv2 score

March 7, 2013 15:50 < Received response detailing proposed fix, including link to CVS check-in of new code

March 7, 2013 18:48 > Acknowledged receipt of email

March 9, 2013 16:54 > Emailed CVE number to security contact and requested information on release plans

March 10, 2013 14:28 < Received confirmation of release timeline

March 10, 2013 14:58 â€“ Release of Privoxy 3.0.21 stable

March 11, 2013 07:30 â€“ Release of advisory

### Rate this:

### Share this:

* [Twitter](https://c22blog.wordpress.com/2013/03/11/privoxy-proxy-authentication-credential-exposure-cve-2013-2503/?share=twitter "Click to share on Twitter")
* [Facebook](https://c22blog.wordpress.com/2013/03/11/privoxy-proxy-authentication-credential-exposure-cve-2013-2503/?share=facebook "Click to share on Facebook")
* [LinkedIn](https://c22blog.wordpress.com/2013/03/11/privoxy-proxy-authentication-credential-exposure-cve-2013-2503/?share=linkedin "Click to share on LinkedIn")
* [Tumblr](https://c22blog.wordpress.com/2013/03/11/privoxy-proxy-authentication-credential-exposure-cve-2013-2503/?share=tumblr "Click to share on Tumblr")
* [Reddit](https://c22blog.wordpress.com/2013/03/11/privoxy-proxy-authentication-credential-exposure-cve-2013-2503/?share=reddit "Click to share on Reddit")
Like Loading...
### *Related*

[Security](https://c22blog.wordpress.com/category/security/)
[privoxy](https://c22blog.wordpress.com/tag/privoxy/), [proxy authentication](https://c22blog.wordpress.com/tag/proxy-authentication/), [Response Codes](https://c22blog.wordpress.com/tag/response-codes/)

[â† {QuickPost} Research Teaser â€“ HTTP ResponseÂ Codes](https://c22blog.wordpress.com/2013/02/19/quickpost-research-teaser-http-response-codes/) [BSidesLondon 2013 â†’](https://c22blog.wordpress.com/2013/04/19/bsideslondon-2/)

### One response to â€œ*Privoxy Proxy Authentication Credential Exposure â€“Â CVE-2013-2503*â€

1. Pingback: [Defense by Numbers: Making problems for script kiddies and scanner monkies | CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](http://blog.c22.cc/2013/04/24/defense-by-numbers-making-problems-for-script-kiddies-and-scanner-monkies/)

[RSS feed](https://c22blog.wordpress.com/feed/)
### Recent Posts

* [[DeepSec 2015]50 Shades ofÂ WAF](https://c22blog.wordpress.com/2015/11/19/deepsec-201550-shades-of-waf/)
* [[DeepSec 2015] File Format Fuzzing in Android â€“ Giving a Stagefright to the AndroidÂ Installer](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-file-format-fuzzing-in-android-giving-a-stagefright-to-the-android-installer/)
* [[DeepSec 2015]How to Break XML Encryption â€“Â Automatically](https://c22blog.wordpress.com/2015/11/19/deepsec-2015how-to-break-xml-encryption-automatically/)
* [[DeepSec 2015] Hacking Cookies in Modern Web Applications andÂ Browsers](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-hacking-cookies-in-modern-web-applications-and-browsers/)
* [[DeepSec 2015] Can societies manage the SIGINTÂ monster?](https://c22blog.wordpress.com/2015/11/19/deepsec-2015-can-societies-manage-the-sigint-monster/)
* [[LHS Microcast] DeepSecÂ 2015](https://c22blog.wordpress.com/2015/10/19/lhs-microcase-deepsec-2015/)
* [[LHS Microcast] Interview w/ JenÂ Ellis](https://c22blog.wordpress.com/2015/10/02/lhs-microcast-interview-w-jen-ellis/)
* [Taking out theÂ Eurotrash](https://c22blog.wordpress.com/2014/12/23/taking-out-the-eurotrash/)
* [All good things must come to anÂ end](https://c22blog.wordpress.com/2014/12/22/all-good-things-must-come-to-an-end/)
* [[DeepSec 2014] Advanced Powershell Threat: Lethal Client Side Attacks usingÂ Powershell](https://c22blog.wordpress.com/2014/11/21/deepsec-2014-advanced-powershell-threat-lethal-client-side-attacks-using-powershell/)
[![](http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png)](http://creativecommons.org/licenses/by-nc-sa/3.0/)
### Archives

Archives
Select Month
 November 2015 Â (5)
 October 2015 Â (2)
 December 2014 Â (2)
 November 2014 Â (5)
 October 2014 Â (1)
 September 2014 Â (1)
 August 2014 Â (1)
 July 2014 Â (1)
 April 2014 Â (1)
 January 2014 Â (1)
 December 2013 Â (2)
 October 2013 Â (1)
 September 2013 Â (1)
 August 2013 Â (2)
 July 2013 Â (1)
 June 2013 Â (1)
 May 2013 Â (1)
 April 2013 Â (2)
 March 2013 Â (1)
 February 2013 Â (1)
 December 2012 Â (4)
 November 2012 Â (2)
 October 2012 Â (2)
 September 2012 Â (2)
 August 2012 Â (1)
 July 2012 Â (2)
 June 2012 Â (3)
 May 2012 Â (3)
 April 2012 Â (3)
 March 2012 Â (8)
 February 2012 Â (7)
 January 2012 Â (7)
 December 2011 Â (11)
 November 2011 Â (17)
 October 2011 Â (6)
 September 2011 Â (9)
 August 2011 Â (6)
 July 2011 Â (10)
 June 2011 Â (5)
 May 2011 Â (3)
 April 2011 Â (9)
 March 2011 Â (5)
 February 2011 Â (1)
 January 2011 Â (11)
 December 2010 Â (3)
 November 2010 Â (12)
 October 2010 Â (6)
 September 2010 Â (11)
 August 2010 Â (9)
 July 2010 Â (21)
 June 2010 Â (8)
 May 2010 Â (7)
 April 2010 Â (13)
 March 2010 Â (7)
 February 2010 Â (1)
 January 2010 Â (3)
 December 2009 Â (17)
 November 2009 Â (6)
 October 2009 Â (6)
 September 2009 Â (21)
 August 2009 Â (15)
 July 2009 Â (9)
 June 2009 Â (5)
 May 2009 Â (3)
 April 2009 Â (5)
 March 2009 Â (4)
 February 2009 Â (5)
 January 2009 Â (4)
 December 2008 Â (18)
 November 2008 Â (6)
 October 2008 Â (5)
 September 2008 Â (10)
 August 2008 Â (7)
 July 2008 Â (7)
 June 2008 Â (1)
 March 2008 Â (3)
 February 2008 Â (4)
 January 2008 Â (4)
 December 2007 Â (5)
 November 2007 Â (8)
 October 2007 Â (6)
 September 2007 Â (8)
 August 2007 Â (6)

[![ChrisJohnRiley on Twitter](http://twittercounter.com/counter/?username=ChrisJohnRiley)](http://twitter.com/ChrisJohnRiley)

### [@ChrisJohnRiley](http://twitter.com/ChrisJohnRiley)

[Tweets by ChrisJohnRiley](https://twitter.com/ChrisJohnRiley)
###

[![Computer History Museum (Mountain View, CA)](https://live.staticflickr.com/7642/16171126653_504b9e28d2_s.jpg "Computer History Museum (Mountain View, CA)")](https://www.flickr.com/photos/c22/16171126653/)[![Hmmâ€¦ no tanks. Why did nobody tell me earlier!](https://live.staticflickr.com/7518/15658163086_92a02df283_s.jpg "Hmmâ€¦ no tanks. Why did nobody tell me earlier!")](https://www.flickr.com/photos/c22/15658163086/)[![Huge Organâ€¦ #firstcon14](https://live.staticflickr.com/5591/14322110059_07bec335c6_s.jpg "Huge Organâ€¦ #firstcon14")](https://www.flickr.com/photos/c22/14322110059/)[![The Internet @ the MIT Museumâ€¦ #firstcon14](https://live.staticflickr.com/3867/14479643812_ef9aa76deb_s.jpg "The Internet @ the MIT Museumâ€¦ #firstcon14")](https://www.flickr.com/photos/c22/14479643812/)
[More Photos](https://www.flickr.com/photos/c22/)

### Disclaimer

The contents of this personal blog are solely my own opinions and comments, as such they do not reflect the opinions of my employer(s) past, present or future. No legal liability is accepted for anything you do, think, or consider fact as the basis of articles and links posted on this blog.

"Three to one...two...one...probability factor of one to one...we have normality, I repeat we have normality. Anything you still canâ€™t cope with is therefore your own problem."

Note: A large portion of content I post on my blog comes from "live blogging" of security conferences. These posts are in notes form and are written live during a talk. As such errors and emissions are expected. I'm only human after all!

[â†‘ Top](#wrapper)
[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* Reblog
* Subscribe
  Subscribed

  + [![](https://secure.gravatar.com/blavatar/770e6edec9ad46dc256a0b6e899831fffce8cefdfab8133d02c4f1a8365cab33?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png) CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](https://c22blog.wordpress.com)

  Join 3,178 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fc22blog.wordpress.com%2F2013%2F03%2F11%2Fprivoxy-proxy-authentication-credential-exposure-cve-2013-2503%2F&signup_flow=account)
* Privacy
* + [![](https://secure.gravatar.com/blavatar/770e6edec9ad46dc256a0b6e899831fffce8cefdfab8133d02c4f1a8365cab33?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png) CĞ°Ñ‚ÑĞ½Â²Â² (in)sĞµÑuÑitÑƒ / ChrisJohnRiley](https://c22blog.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fc22blog.wordpress.com%2F2013%2F03%2F11%2Fprivoxy-proxy-authentication-credential-exposure-cve-2013-2503%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/p6I7X-1aB)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://c22blog.wordpress.com/2013/03/11/privoxy-proxy-authentication-credential-exposure-cve-2013-2503/)
  + [View post in Reader](https://wordpress.com/read/blogs/1599597/posts/4501)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)

