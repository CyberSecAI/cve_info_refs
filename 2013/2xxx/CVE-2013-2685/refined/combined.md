=== Content from issues.asterisk.org_c5baac96_20250125_204448.html ===

[[Home](/)]

| Summary: | ASTERISK-20901: Security Vulnerability: Possible stack corruption in when parsing H.264 format attributes | | |
| --- | --- | --- | --- |
| Reporter: | Matt Jordan (mjordan) | Labels: |  |
| Date Opened: | 2013-01-07 16:05:02.000-0600 | Date Closed: | 2013-03-27 10:53:57 |
| Priority: | Critical | Regression? | No |
| Status: | Closed/Complete | Components: | Resources/res\_format\_attr\_h264 |
| Versions: | 11.1.2 | Frequency ofOccurrence |  |
| RelatedIssues: | | must be completed before resolving | [ASTERISK-21005](/ASTERISK-21005) Open Blockers for 11.3.0 | | --- | --- | | | |
| Environment: |  | Attachments: | ( 0) [AST-2013-001-11.diff](../attachments/20/ASTERISK-20901/00-AST-2013-001-11.diff)( 1) [h264\_overflow\_security\_patch.diff](../attachments/20/ASTERISK-20901/01-h264_overflow_security_patch.diff) |
| Description: | {quote}   Hi,   I just saw this in res/res\_format\_attr\_h264.c in Asterisk 11.1.2:   {code}  char sps[H264\_MAX\_SPS\_PPS\_SIZE], pps[H264\_MAX\_SPS\_PPS\_SIZE];   if (sscanf(attrib, "profile-level-id=%lx", &val2) == 1) {     format\_attr->format\_attr[H264\_ATTR\_KEY\_PROFILE\_IDC] = ((val2 >> 16) & 0xFF);     format\_attr->format\_attr[H264\_ATTR\_KEY\_PROFILE\_IOP] = ((val2 >> 8) & 0xFF);     format\_attr->format\_attr[H264\_ATTR\_KEY\_LEVEL] = (val2 & 0xFF);  } else if (sscanf(attrib, "sprop-parameter-sets=%[^','],%s", sps, pps) == 2) {  {code}   I suspect there might be a potential buffer overflow here with a long "sprop-parameter-sets" string, but I don't really know the involved protocols well enough to check this.. What do you think?   // Ulf HÃ¤rnhammar   {quote}   Confirmed. When using sscanf, we need to length limit the strings to the length of the buffers on the stack - 1. | | |
| Comments: |  | | |



=== Content from downloads.asterisk.org_1e073085_20250125_204445.html ===


Asterisk
Project Security Advisory - AST-2013-001

| **Product** | Asterisk |
| **Summary** | Buffer Overflow Exploit Through SIP SDP Header |
| **Nature of Advisory** | Exploitable Stack Buffer Overflow |
| **Susceptibility** | Remote Unauthenticated Sessions |
| **Severity** | Major |
| **Exploits Known** | No |
| **Reported On** | 6 January, 2013 |
| **Reported By** | Ulf HÃ¤rnhammar |
| **Posted On** | 27 March, 2013 |
| **Last Updated On** | March 27, 2013 |
| **Advisory Contact** | Jonathan Rose <jrose AT digium DOT com> |
| **CVE Name** | CVE-2013-2685 |

| **Description** | The format attribute resource for h264 video performs an unsafe read against a media attribute when parsing the SDP. The vulnerable parameter can be received as strings of an arbitrary length and Asterisk attempts to read them into limited buffer spaces without applying a limit to the number of characters read. If a message is formed improperly, this could lead to an attacker being able to execute arbitrary code remotely. |

| **Resolution** | Attempts to read string data into the buffers noted are now explicitly limited by the size of the buffers. |

| **Affected Versions** | | |
| **Product** | **Release Series** |  |
| Asterisk Open Source | 11.x | All Versions |

| **Corrected In** | |
| **Product** | **Release** |
| Asterisk Open Source | 11.2.2 |

| **Patches** | |
| **SVN URL** | **Revision** |
| [Http://downloads.asterisk.org/pub/security/AST-2013-001-11.diff](http://downloads.asterisk.org/pub/security/AST-2013-001-11.diff) | Asterisk 11 |

| **Links** | <https://issues.asterisk.org/jira/browse/ASTERISK-20901> |

| Asterisk Project Security Advisories are posted at <http://www.asterisk.org/security>  This document may be superseded by later versions; if so, the latest version will be posted at http://downloads.digium.com/pub/security/AST-2013-001.pdf and http://downloads.digium.com/pub/security/AST-2013-001.html |

| **Revision History** | | |
| **Date** | **Editor** | **Revisions Made** |
| February 11, 2013 | Jonathan Rose | Initial Draft |
| March 27, 2013 | Matt Jordan | CVE Added |

Asterisk
Project Security Advisory - AST-2013-001
Copyright
Â© 2013
Digium, Inc. All Rights Reserved.
Permission is hereby granted
to distribute and publish this advisory in its original, unaltered
form.


