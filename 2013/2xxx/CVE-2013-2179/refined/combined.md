=== Content from bugs.mageia.org_0127c614_20250125_054543.html ===


Mageia Bugzilla – Bug 10682
xdm new security issue CVE-2013-2179
Last modified: 2013-07-09 22:24:12 CEST

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=10682&GoAheadAndLogIn=1)

  [x]
* |
  [New Account](https://identity.mageia.org/register)
* |
  [Forgot Password](https://identity.mageia.org/forgot_password)

[**Bug 10682**](show_bug.cgi?id=10682)
- xdm new security issue CVE-2013-2179

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
xdm new security issue CVE-2013-2179

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED INVALID | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Mageia | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Mageia "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Security ([show other bugs](buglist.cgi?component=Security&product=Mageia&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 3 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | i586 Linux | |  | | | [Priority:](page.cgi?id=fields.html#priority "Engineers prioritize their bugs using this field.") | Normal [Severity](page.cgi?id=fields.html#bug_severity "How severe the bug is, or whether it's an enhancement."): normal | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | QA Team | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Sec team | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <http://lwn.net/Vulnerabilities/557263/> | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | feedback | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2013-07-03 00:18 CEST by David Walser | | --- | --- | | Modified: | 2013-07-09 22:24 CEST ([History](show_activity.cgi?id=10682)) | | CC List: | 2 users (show)  sysadmin-bugs tmb | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Source RPM:](page.cgi?id=fields.html#cf_rpmpkg "When you type \"rpm -qif /path/to/the/application\", this is the value of the line named \"Source RPM\"") | xdm-1.1.11-8.mga3.src.rpm | | [CVE:](page.cgi?id=fields.html#cf_cve "Common Vulnerabilities and Exposures") |  | | [Status comment:](page.cgi?id=fields.html#cf_statuscomment "A short comment explaining the current state of the bug report. Especially useful for release blockers or bugs with lots of comments.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=10682&action=enter) (proposed patch, testcase, etc.) | | |  |
| --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=10682#c0)  David Walser    2013-07-03 00:18:11 CEST  ``` OpenSuSE has issued an advisory today (July 2): <http://lists.opensuse.org/opensuse-updates/2013-07/msg00002.html>  Only Mageia 3 and Cauldron are affected as they have glibc 2.17.  Patched packages uploaded for Mageia 3 and Cauldron.  Note to QA: there are more details in the OpenSuSE bug, including how to potentially reproduce this issue.  Given what the first sentence of the advisory below says, we may not be vulnerable to this, as our configure call during the xdm build has "--with-pam" so we should test for this.  If we are not vulnerable, we can just close this as INVALID. <https://bugzilla.novell.com/show_bug.cgi?id=824884>  Advisory: ========================  Updated xdm package fixes security vulnerability:  If xdm is built to use raw crypt() authentication, instead of a higher level system such as PAM or BSD Auth, and that crypt() function can return a NULL pointer, as it can under certain circumstances with glibc 2.17, then attempting to login to such an account via xdm can crash the xdm daemon.  For some setups, this may be a denial of service for other users of the machine (CVE-2013-2179).  References: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2179> <http://lists.opensuse.org/opensuse-updates/2013-07/msg00002.html> ========================  Updated packages in core/updates_testing: ======================== xdm-1.1.11-8.1.mga3  from xdm-1.1.11-8.1.mga3.src.rpm  Reproducible:   Steps to Reproduce: ```  [Comment 1](show_bug.cgi?id=10682#c1)  claire robinson    2013-07-03 16:14:17 CEST  ``` Confirmed that we're not vulnerable.  Set to use XDM and locked a user account. Trying to log in with that account just gave the message that the login was incorrect rather than causing a crash.  Adding sysadmin, could somebody please remove xdm-1.1.11-8.1.mga3.src.rpm from 3 core/updates_testing. The bug can then be closed as invalid.  Thanks. ```  ---   CC: (none) => sysadmin-bugs  [Comment 2](show_bug.cgi?id=10682#c2)  claire robinson    2013-07-04 14:54:27 CEST  ``` Adding feedback marker til it's done ```  ---   Whiteboard: (none) => feedback  [Comment 3](show_bug.cgi?id=10682#c3)  Thomas Backlund    2013-07-09 22:24:12 CEST  ```  xdm removed ```  ---   Status: NEW => RESOLVEDCC: (none) => tmbResolution: (none) => INVALID |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=10682&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=10682)
* - [XML](show_bug.cgi?ctype=xml&id=10682)
* - [Clone ThisBug](enter_bug.cgi?cloned_bug_id=10682&normal=1)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=10682&GoAheadAndLogIn=1)

    [x]
  + |
    [New Account](https://identity.mageia.org/register)
  + |
    [Forgot Password](https://identity.mageia.org/forgot_password)



=== Content from lists.opensuse.org_ef95940f_20250125_054541.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/LZTMIV66JUXJHWSU4LFXHD2XJRLHVEKX/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/LZTMIV66JUXJHWSU4LFXHD2XJRLHVEKX/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/LZTMIV66JUXJHWSU4LFXHD2XJRLHVEKX/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/LZTMIV66JUXJHWSU4LFXHD2XJRLHVEKX/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/LZTMIV66JUXJHWSU4LFXHD2XJRLHVEKX/#LZTMIV66JUXJHWSU4LFXHD2XJRLHVEKX)

# openSUSE-SU-2013:1117-1: moderate: xdm: fixed NULL pointer crash

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

2 Jul
2013

2 Jul
'13

10:04

openSUSE Security Update: xdm: fixed NULL pointer crash
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2013:1117-1
Rating: moderate
References: #824884
Cross-References: CVE-2013-2179
Affected Products:
openSUSE 12.3
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes one vulnerability is now available.
Description:
xdm was updated on crypt() NULL pointer crashes:
\* Starting with glibc 2.17 (eglibc 2.17), crypt() fails
with EINVAL (w/ NULL return) if the salt violates
specifications. Additionally, on FIPS-140 enabled Linux
systems, DES/MD5-encrypted passwords passed to crypt()
fail with EPERM (w/ NULL return). If using glibc's
crypt(), check return value to avoid a possible NULL
pointer dereference. (bnc#824884) (CVE-2013-2179)
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.3:
zypper in -t patch openSUSE-2013-547
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.3 (i586 x86\_64):
xdm-1.1.10-14.10.1
xdm-debuginfo-1.1.10-14.10.1
xdm-debugsource-1.1.10-14.10.1
References:
<http://support.novell.com/security/cve/CVE-2013-2179.html>
<https://bugzilla.novell.com/824884>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/LZTMIV66JUXJHWSU4LFXHD2XJRLHVEKX/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/LZTMIV66JUXJHWSU4LFXHD2XJRLHVEKX/#LZTMIV66JUXJHWSU4LFXHD2XJRLHVEKX)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from www.openwall.com_9a659623_20250125_054541.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](7) [[next>]](9) [[<thread-prev]](../../../2013/06/11/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <51BA5C53.6000407@redhat.com>
Date: Thu, 13 Jun 2013 17:57:07 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Alan Coopersmith <alan.coopersmith@...cle.com>,
        "X.Org Security Team" <xorg-security@...ts.x.org>, mancha1@...h.com,
        "X.Org Development" <xorg-devel@...ts.x.org>
Subject: Re: CVE request for possible NULL ptr deref in XDM
 when using crypt() from glibc 2.17+

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 06/11/2013 05:47 PM, Alan Coopersmith wrote:
> It's been suggested we get a CVE id assigned for this recent fix to
> the xdm display/login manager from X.Org:
>
> <http://cgit.freedesktop.org/xorg/app/xdm/commit/?id=8d1eb5c74413e4c9a21f689fc106949b121c0117>
>
>  Without this fix, if xdm is built to use raw crypt()
> authentication, instead of a higher level system such as PAM or BSD
> Auth, and that crypt() function can return a NULL pointer (as glibc
> 2.17+ does for invalid input, such as when an account is locked by
> prepending a "!" to the password field), then attempting to login
> to such an account via xdm can crash the xdm daemon.
>
> For single user console machines, this generally just means you get
> the text console login prompt instead.   For machines set up to
> support multiple seats, remote XDMCP access, or X terminals (such
> as LTSP setups using xdm), this may be a denial of service for
> users on those other seats/terminals /devices.
>

Please use CVE-2013-2179 for this issue.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)

iQIcBAEBAgAGBQJRulxTAAoJEBYNRVNeJnmTI9wP/1LWPFOfR+/Z/1mM77kBbt+K
WqXL20xy5rXRKSYUCDAIE2QLwK+FFwoEP8kB0SzYAp2KQ/Tnq99HWN8Xdb0lT3+A
sxQF5Dy8DCYr5ME5lvYraYxRyFOqal3mx3TGY9dGvzBGB4iOsJ24xPrPzz4uA0iv
IGnltkD1dHiHbVfIsYqrFrdXqN8q1NyRJHWV+L2mLW/iGfIIpw1W289x/8xjBd8Y
ZEfckYr8aLpq5kkf8KT3ua+C0Y99U0n7+TFcxgFPmCkgE57U4dzpFdbAV6iJ69hw
ahyB62MQT6WFtSvUqnl0VP+CclgKZyDvkxzyPkWFBFIuQqTyDOMqyzPXrF9v9C1p
idVxpEHK3w1bdWGrJswYtTqWHE+4PEjeiMYJSDIw/pnINT99z349wlK2tLixCt+z
CGEMelGZvAIgL8pvEnnKfrip0nRbjIFvJGMrdC6uLHNsQvkosMDx7zSOteq60L+d
/yZxOFGjH2+BxFJfSobAlY28E8XTUvG+8o0SEBGq82oPbbAL5KBbbEw9XGcERTT8
rQ0f8xd8Cvdw9fLaVg0FWDircqqtVNhFGwy1tAUE9NokFZlN94ljV5+F7Bhi1OHA
MuRP5doyWSD+4EsGBG1HhIKAj4spszGp/nl4PTu+aAVx0+209RUMmWCH06h2LbIj
4YqMWveDHUo7h+FXZu9z
=VM3h
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from identity.mageia.org_d8261ffa_20250126_062604.html ===

# Your Mageia user account

* [FAQ](https://wiki.mageia.org/en/FAQ%3AAccounts "Frequently Asked Questions")
* [Privacy](http://www.mageia.org/en/about/policies/privacy/)

## Register

### Username

Username

Allowed characters: lower case letters and numbers

### Personal Information

First name

Surname

### Email

Email address

Confirm Email address

### Captcha

Some characters are turned around.
The following characters can be used:
2 3 4 5 6 7 8 9 A B C D E F G H J K L M P R S T U V W X Y Z

![](/register/captcha)

Enter text

Register

2010-2017 [Mageia.org](http://www.mageia.org/)
| [Privacy policy](http://www.mageia.org/en/about/policies/privacy/)
| [Mageia user accounts FAQ](https://wiki.mageia.org/en/FAQ%3AAccounts)



=== Content from identity.mageia.org_e8f6916c_20250126_062604.html ===

# Your Mageia user account

* [FAQ](https://wiki.mageia.org/en/FAQ%3AAccounts "Frequently Asked Questions")
* [Privacy](http://www.mageia.org/en/about/policies/privacy/)

# Forgot your password?

| Email address |  |
| --- | --- |
|  | |

2010-2017 [Mageia.org](http://www.mageia.org/)
| [Privacy policy](http://www.mageia.org/en/about/policies/privacy/)
| [Mageia user accounts FAQ](https://wiki.mageia.org/en/FAQ%3AAccounts)



=== Content from bugzilla.novell.com_895d1fd0_20250126_062609.html ===




=== Content from cgit.freedesktop.org_9ab52ea6_20250125_054540.html ===


| [cgit logo](/) | [index](/) : [xorg/app/xdm](/xorg/app/xdm/) | 4-xdm-uses-arc4random-and-setproctitle-without-proper-includes CYGWIN DAMAGE-XFIXES IPv6-REVIEW XACE-SELINUX XEVIE XINERAMA\_2 XORG-6\_8-branch XORG-CURRENT XORG-RELEASE-1 XORG-RELEASE-1-STSF XORG-RELEASE-1-TM XORG-STABLE XPRINT lg3d-dev-0-6-1-1 lg3d-dev-0-6-2 lg3d-dev-0-7-0 lg3d-dev-0-7-1 lg3d-master master sco\_port\_update xdm-1-0-2 xdm-1\_0-branch |
| --- | --- | --- |
| X Display Manager / XDMCP server (mirrored from https://gitlab.freedesktop.org/xorg/app/xdm) | alanc |

| [summary](/xorg/app/xdm/)[refs](/xorg/app/xdm/refs/?id=8d1eb5c74413e4c9a21f689fc106949b121c0117)[log](/xorg/app/xdm/log/)[tree](/xorg/app/xdm/tree/?id=8d1eb5c74413e4c9a21f689fc106949b121c0117)[commit](/xorg/app/xdm/commit/?id=8d1eb5c74413e4c9a21f689fc106949b121c0117)[diff](/xorg/app/xdm/diff/?id=8d1eb5c74413e4c9a21f689fc106949b121c0117) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | mancha <mancha1@hush.com> | 2013-05-22 07:20:26 -0700 |
| --- | --- | --- |
| committer | Alan Coopersmith <alan.coopersmith@oracle.com> | 2013-06-07 16:26:46 -0700 |
| commit | [8d1eb5c74413e4c9a21f689fc106949b121c0117](/xorg/app/xdm/commit/?id=8d1eb5c74413e4c9a21f689fc106949b121c0117) ([patch](/xorg/app/xdm/patch/?id=8d1eb5c74413e4c9a21f689fc106949b121c0117)) | |
| tree | [79ddad90b9da1b4983271975d734b2b349ba4c27](/xorg/app/xdm/tree/?id=8d1eb5c74413e4c9a21f689fc106949b121c0117) | |
| parent | [642d73c50ae19a55975919c84191da15b31608a4](/xorg/app/xdm/commit/?id=642d73c50ae19a55975919c84191da15b31608a4) ([diff](/xorg/app/xdm/diff/?id=8d1eb5c74413e4c9a21f689fc106949b121c0117&id2=642d73c50ae19a55975919c84191da15b31608a4)) | |

Handle NULL returns from glibc 2.17+ crypt().Starting with glibc 2.17 (eglibc 2.17), crypt() fails with EINVAL
(w/ NULL return) if the salt violates specifications. Additionally,
on FIPS-140 enabled Linux systems, DES/MD5-encrypted passwords
passed to crypt() fail with EPERM (w/ NULL return).
If using glibc's crypt(), check return value to avoid a possible
NULL pointer dereference.
Reviewed-by: Matthieu Herrb <matthieu@herrb.eu>
Signed-off-by: Alan Coopersmith <alan.coopersmith@oracle.com>
NotesFixes CVE-2013-2179
[Diffstat](/xorg/app/xdm/diff/?id=8d1eb5c74413e4c9a21f689fc106949b121c0117)

| -rw-r--r-- | [greeter/verify.c](/xorg/app/xdm/diff/greeter/verify.c?id=8d1eb5c74413e4c9a21f689fc106949b121c0117) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 1 deletions

| diff --git a/greeter/verify.c b/greeter/verify.cindex db3cb7d..b009e2b 100644--- a/[greeter/verify.c](/xorg/app/xdm/tree/greeter/verify.c?id=642d73c50ae19a55975919c84191da15b31608a4)+++ b/[greeter/verify.c](/xorg/app/xdm/tree/greeter/verify.c?id=8d1eb5c74413e4c9a21f689fc106949b121c0117)@@ -329,6 +329,7 @@ Verify (struct display \*d, struct greet\_info \*greet, struct verify\_info \*verify) struct spwd \*sp; # endif char \*user\_pass = NULL;+ char \*crypted\_pass = NULL; # endif # ifdef \_\_OpenBSD\_\_ char \*s;@@ -464,7 +465,9 @@ Verify (struct display \*d, struct greet\_info \*greet, struct verify\_info \*verify) # if defined(ultrix) || defined(\_\_ultrix\_\_) if (authenticate\_user(p, greet->password, NULL) < 0) # else- if (strcmp (crypt (greet->password, user\_pass), user\_pass))+ crypted\_pass = crypt (greet->password, user\_pass);+ if ((crypted\_pass == NULL)+ || (strcmp (crypted\_pass, user\_pass))) # endif { if(!greet->allow\_null\_passwd || strlen(p->pw\_passwd) > 0) { |
| --- |

generated by [cgit v1.2.3](https://git.zx2c4.com/cgit/about/) ([git 2.39.1](https://git-scm.com/)) at 2025-01-25 05:45:40 +0000


