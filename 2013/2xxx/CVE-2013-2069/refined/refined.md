```
Message-ID: <20130523141714.GY27789@lister.brianlane.com>
Date: Thu, 23 May 2013 07:17:14 -0700
From: "Brian C. Lane" <bcl@...hat.com>
To: oss-security@...ts.openwall.com
Subject: CVE-2013-2069 livecd-tools: improper handling of passwords

<https://bugzilla.redhat.com/show_bug.cgi?id=964299>

The livecd-tools package provides support for reading and executing
Kickstart files in order to create a system image. It was discovered
that livecd-tools gave the root user an empty password rather than
leaving the password locked in situations where no 'rootpw' directive
was used or when the 'rootpw --lock' directive was used within the
Kickstart file, which could allow local users to gain access to the
root account. (CVE-2013-2069)
```
**Root cause of vulnerability:** The `livecd-tools` package, when processing Kickstart files for system image creation, incorrectly handles the absence or presence of the `rootpw` directive or the use of `rootpw --lock`. Instead of locking the root account or leaving it locked, it assigns an empty password.

**Weaknesses/vulnerabilities present:** Improper handling of password setting during system image creation, leading to an unlocked root account.

**Impact of exploitation:** A local user could gain unauthorized root access to the system using the empty password.

**Attack vectors:** Local access to the system where the image built with affected livecd-tools is deployed.

**Required attacker capabilities/position:** The attacker must have local access to a system using an image built with the vulnerable `livecd-tools`, and be able to log in as root with no password.

```
Red Hat provides a Red Hat Enterprise Linux 6.4 KVM Guest Image for
cloud instances. This image is provided as a minimally configured system
image which is available for use as-is or for configuration and
customization as required by end users.

The Red Hat Enterprise Linux 6.4 KVM Guest Image for cloud instances had an
empty root password by default. To address this, Red Hat has created an
updated image that locks the root password by default. This updated image
is now available on RHN.

To correct existing Red Hat Enterprise Linux 6.4 KVM Guest Images, any
images or systems built using this Red Hat Enterprise Linux 6.4 KVM Guest
Image, or any currently running Red Hat Enterprise Linux instances
instantiated from this image, users can lock the root password by issuing,
as root, the command:

passwd -l root

Note: The default OpenSSH configuration disallows password logins when
the password is empty, preventing a remote attacker from logging in
without a password.

Root Cause

Kickstart can be used to automate operating system installations. A
Kickstart file specifies settings for an installation. Once the
installation system boots, it can read a Kickstart file and carry out the
installation process without any further input from a user. Kickstart is
used as part of the process of creating Images of Red Hat Enterprise Linux
for cloud providers.

It was discovered that when no 'rootpw' command was specified in a
Kickstart file, the image creator tools gave the root user an empty
password rather than leaving the password locked, which could allow a local
user to gain access to the root account (CVE-2013-2069).
```
This confirms the information above. It also includes information that the default OpenSSH configuration disallows password logins when the password is empty, preventing remote access using the empty password.
```
  livecd-tools were fixed versions 19.3, 18.16, 17.17, and 13.4.4
```
This identifies fixed versions of the livecd-tools package.
```
  It was discovered that when used to create images, livecd-tools gave the root user an empty password rather than leaving the password locked in situations where no 'rootpw' directive was used or when the 'rootpw --lock' directive was used within the Kickstart file, which could allow local users to gain access to the root account.
```
This provides more context.