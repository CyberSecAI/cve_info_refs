=== Content from svn.ec-cube.net_21e3efd0_20250124_173644.html ===

[![EC-CUBE](/open_trac/raw-attachment/wiki/WikiStart/trac.jpg)](http://svn.ec-cube.net/open_trac/)

Search:

* [Login](/open_trac/login)
* [Help/Guide](/open_trac/wiki/TracGuide)
* [About Trac](/open_trac/about)
* [Preferences](/open_trac/prefs)

* [Wiki](/open_trac/wiki)
* [Browse Source](/open_trac/browser)
* [View Tickets](/open_trac/report)
* [Search](/open_trac/search)
* [Timeline](/open_trac/timeline)
* [Roadmap](/open_trac/roadmap)

## Context Navigation

* ← [Previous Changeset](/open_trac/changeset/22579 "Changeset 22579")
* [Next Changeset](/open_trac/changeset/22581 "Changeset 22581") →

---

# Changeset 22580

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
2013/02/22 14:28:41
([12 years](/open_trac/timeline?from=2013-02-22T14%3A28%3A41%2B09%3A00&precision=second "2013-02-22T14:28:41+09:00 in Timeline") ago)

Author:
habu
Message:

[#2159](/open_trac/ticket/2159 "改善提案: 意味が無いLIKE (closed: 修正済)") 意味が無いLIKE

File:

1 edited

* [branches/version-2\_12-dev/data/class/pages/forgot/LC\_Page\_Forgot.php](/open_trac/browser/branches/version-2_12-dev/data/class/pages/forgot/LC_Page_Forgot.php?rev=22580 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [branches/version-2\_12-dev/data/class/pages/forgot/LC\_Page\_Forgot.php](/open_trac/changeset/22580/branches/version-2_12-dev/data/class/pages/forgot/LC_Page_Forgot.php "Show the changeset 22580 restricted to branches/version-2_12-dev/data/class/pages/forgot/LC_Page_Forgot.php")

  | [r22567](/open_trac/browser/branches/version-2_12-dev/data/class/pages/forgot/LC_Page_Forgot.php?rev=22567#L155 "Show revision 22567 of this file in browser") | [r22580](/open_trac/browser/branches/version-2_12-dev/data/class/pages/forgot/LC_Page_Forgot.php?rev=22580#L155 "Show revision 22580 of this file in browser") |  |
  | --- | --- | --- |
  | 155 | 155 | $errmsg = NULL; |
  | 156 | 156 | $objQuery =& SC\_Query\_Ex::getSingletonInstance(); |
  | 157 |  | $where = '(email ~~Like ? OR email\_mobile Like ?) AND name01 Like ? AND name02 Like~~ ? AND del\_flg = 0'; |
  |  | 157 | $where = '(email = ? OR email\_mobile = ?) AND name01 = ? AND name02 = ? AND del\_flg = 0'; |
  | 158 | 158 | $arrVal = array($arrForm['email'], $arrForm['email'], $arrForm['name01'], $arrForm['name02']); |
  | 159 | 159 | $result = $objQuery->select('reminder, status', 'dtb\_customer', $where, $arrVal); |
  | […](/open_trac/browser/branches/version-2_12-dev/data/class/pages/forgot/LC_Page_Forgot.php?rev=22567#L205) | […](/open_trac/browser/branches/version-2_12-dev/data/class/pages/forgot/LC_Page_Forgot.php?rev=22580#L205) |  |
  | 205 | 205 | $cols = 'customer\_id, reminder, reminder\_answer, salt'; |
  | 206 | 206 | $table = 'dtb\_customer'; |
  | 207 |  | $where = '(email ~~Like ? OR email\_mobile Like~~ ?)' |
  | 208 |  | . ' AND name01 ~~Like ? AND name02 Like~~ ?' |
  |  | 207 | $where = '(email = ? OR email\_mobile = ?)' |
  |  | 208 | . ' AND name01 = ? AND name02 = ?' |
  | 209 | 209 | . ' AND status = 2 AND del\_flg = 0'; |
  | 210 | 210 | $arrVal = array($arrForm['email'], $arrForm['email'], |

**Note:** See [TracChangeset](/open_trac/wiki/TracChangeset)
for help on using the changeset viewer.

### Download in other formats:

* [Unified Diff](?format=diff&new=22580)
* [Zip Archive](?format=zip&new=22580)

---

[![Trac Powered](/open_trac_common/htdocs/common/trac_logo_mini.png)](http://trac.edgewall.org/)

Powered by [**Trac 0.12.ja1**](/open_trac/about)

By [Edgewall Software](http://www.edgewall.org/).

Re-distributed by [インタアクト株式会社](http://www.i-act.co.jp/)

Visit the Trac open source project at
<http://trac.edgewall.org/>



=== Content from jvn.jp_b76d9ee7_20250124_173640.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2013/05/23  Last Updated:2013/05/23
# JVN#39699406 EC-CUBE vulnerable to information disclosure as a result of improper input checking

## Overview

EC-CUBE contains an issue with checking input values, which may result in information disclosure.

## Products Affected

* EC-CUBE 2.11.0
* EC-CUBE 2.11.1
* EC-CUBE 2.11.2
* EC-CUBE 2.11.3
* EC-CUBE 2.11.4
* EC-CUBE 2.11.5
* EC-CUBE 2.12.0
* EC-CUBE 2.12.1
* EC-CUBE 2.12.2
* EC-CUBE 2.12.3
* EC-CUBE 2.12.3en
* EC-CUBE 2.12.3enP1
* EC-CUBE 2.12.3enP2

## Description

EC-CUBE from LOCKON CO.,LTD. is an open source system for creating shopping websites. EC-CUBE contains an issue with checking input values, which may result in information disclosure.

## Impact

A remote, unauthenticated attacker may obtain information stored in the product.

## Solution

**Apply the update or patch**
Apply the update or patch according to the information provided by the developer.

## Vendor Status

| Vendor | Link |
| --- | --- |
| LOCKON CO.,LTD. | [Improper input validation in password reminder function (in Japanese)](http://www.ec-cube.net/info/weakness/weakness.php?id=43) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

**Analyzed on 2013.05.23**

| Measures | Conditions | Severity |
| Access Required | can be attacked over the Internet using packets | * High |
| Authentication | anonymous or no authentication (IP addresses do not count) | * High |
| User Interaction Required | the vulnerability can be exploited without an honest user taking any action | * High |
| Exploit Complexity | some expertise and/or luck required (most buffer overflows, guessing correctly in small space, expertise in Windows function calls) | * Mid-High |

[Description of each analysis measures](http://jvn.jp/en/nav/jvnhelp.html#analysys)

## Credit

LOCKON CO.,LTD. reported this vulnerability to IPA.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2013-2315](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2315) |
| JVN iPedia | [JVNDB-2013-000044](http://jvndb.jvn.jp/jvndb/JVNDB-2013-000044) |

* JVN
* HOME
* What is JVN ?
* Instructions
* List of Vulnerability Report
* [VN\_JP](http://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](http://jvn.jp/en/adj/index.html)
* [VN\_VU](http://jvn.jp/en/vu/index.html)
* [TA](http://jvn.jp/en/ta/index.html)
* TRnotes
* JVN iPedia
* MyJVN
* JVNJS/RSS
* Vendor List
* List of unreachable developers
* Contact

Copyright (c) 2000-2013 JPCERT/CC and IPA. All rights reserved.



=== Content from www.ec-cube.net_e44e62f5_20250124_173645.html ===


JavaScript を有効にしてご利用下さい.

# [EC-CUBE®](/)

* [選ばれる理由](/reason/)
* [機能](/functions/)
* [決済](/alliance/)
* [導入事例](/cases/)
* [セキュリティ](/security/)
* [ストア](https://www.ec-cube.net/owners/)

[まずは相談する](/advisor/)

[ご利用中の方のお問い合わせはこちら](/support/)

* [資料請求](/document/)
* [ダウンロード](/download/)

# 脆弱性

## パスワードリマインド機能における不適切な入力確認の脆弱性

* 情報公開日：2013年 05月 22日
* 危険度：高
* 対象：Ver 2.11.0以降(2.11.0 ～2.12.3)

```
-------------------------------------------------------------------
■脆弱性の種類
-------------------------------------------------------------------
パスワードリマインド機能における不適切な入力確認の脆弱性

-------------------------------------------------------------------
■不具合が存在するEC-CUBEのバージョン
-------------------------------------------------------------------
EC-CUBE　2.11.0 以降 (2011年3月23日公開～)

-------------------------------------------------------------------
■修正方法について(以下は Ver2.12.3 の修正となっております。)
-------------------------------------------------------------------
/data/class/pages/forgot/LC_Page_Forgot.php::lfCheckForgotMail
/data/class/pages/forgot/LC_Page_Forgot.php::lfCheckForgotSecret
に以下の変更を加えます。

※修正ファイルの詳細はこちらをご確認ください
http://www.ec-cube.net/info/weakness/20130522/index.php

▽LC_Page_Forgot.php
157行目付近
-----------------------------------------------------------------------------------------------------------------
 変更前
-----------------------------------------------------------------------------------------------------------------
errmsg = NULL;
$objQuery =& SC_Query_Ex::getSingletonInstance();
$where = '(email Like ? OR email_mobile Like ?) AND name01 Like ? AND name02 Like ? AND del_flg = 0';
-----------------------------------------------------------------------------------------------------------------

-----------------------------------------------------------------------------------------------------------------
 変更後
-----------------------------------------------------------------------------------------------------------------
errmsg = NULL;
$objQuery =& SC_Query_Ex::getSingletonInstance();
$where = '(email = ? OR email_mobile = ?) AND name01 = ? AND name02 = ? AND del_flg = 0';
-----------------------------------------------------------------------------------------------------------------

▽LC_Page_Forgot.php
207行目付近
-----------------------------------------------------------------------------------------------------------------
 変更前
-----------------------------------------------------------------------------------------------------------------
$table = 'dtb_customer';
$where = '(email Like ? OR email_mobile Like ?)'
        . ' AND name01 Like ? AND name02 Like ?'
-----------------------------------------------------------------------------------------------------------------

-----------------------------------------------------------------------------------------------------------------
 変更後
-----------------------------------------------------------------------------------------------------------------
$table = 'dtb_customer';
$where = '(email = ? OR email_mobile = ?)'
        . ' AND name01 = ? AND name02 = ?'
-----------------------------------------------------------------------------------------------------------------

下記のリビジョンで修正
http://svn.ec-cube.net/open_trac/changeset/22580
```

1. [ホーム](/)
3. 脆弱性

 [PageTop](#wrap)

## EC-CUBE公式アドバイザーご相談窓口

* 他社のASPやパッケージとの違いを知りたい
* BtoCのサイトにBtoB機能を追加したい
* 何から手をつければよいかわからない
* オープンソースならではの注意事項を知りたい
* 自社にマッチした制作会社を探したい
* サイト制作だけでなく運営もサポートしてほしい

新規構築・リニューアル・取引先向けのWeb受発注システム（BtoB）や事業の拡大など、
今抱えている課題を解決する最適な業者探しを、アドバイザーがお手伝いします。

* [まずは相談する](/advisor/)
* [資料請求する](/document/)
* [ご利用中の方のお問い合わせはこちら](/support/)

* ## EC-CUBE導入をお考えの方

  + [選ばれる理由](/reason/)
  + [導入事例](/cases/)
  + [デモサイト](/demo/)
  + [機能一覧](/functions/)
  + [マニュアル](https://www.ec-cube.net/manual/ec-cube4/)
  + [ライセンス](/license/)
  + [メールマガジン登録](https://www.ec-cube.net/mail/)
  + [EC開業・運営ノウハウ](/know-how/)
* ## EC-CUBEをインストールしたい

  + [最新版ダウンロード](/download/)
  + [機能一覧](/functions/)
  + [開発情報](/developers/)
  + [レンタルサーバ](/server/)
* ## EC-CUBEをご利用中の方

  + [EC-CUBEメンバー登録](https://www.ec-cube.net/entry/)
  + [メンバーページログイン](https://www.ec-cube.net/mypage/login.php)
  + [オーナーズストア](https://www.ec-cube.net/owners/)
  + [セキュリティ対策](/security/)
  + [開発コミュニティ](https://xoops.ec-cube.net/)
* ## お問い合わせ

  + [サポート](/support/)
  + [よくあるご質問](https://support.ec-cube.net/hc/ja)
  + [お問い合わせ](https://www.ec-cube.net/contact/)
  + [ec-cube.coに関するお問い合わせ](https://www.ec-cube.net/product/co/support.php)
* ## ニュース・イベント

  + [ニュースリリース](https://www.ec-cube.net/newsrelease/)
  + [イベント](https://www.ec-cube.net/event/)
  + [X（旧Twitter）](https://x.com/EC_CUBE)
  + [Facebook](https://www.facebook.com/eccube/)
* ## パートナーについて

  + [パートナー登録（無料）](https://www.ec-cube.net/entry/partner.php)
  + [パートナーページログイン](https://www.ec-cube.net/partnerpage/login.php)
  + [パートナー制度のご案内](https://www.ec-cube.net/partnerpage/top.php)
  + [インテグレートパートナー 一覧](https://www.ec-cube.net/integrate/partner/)
  + [エバンジェリスト紹介](/evangelist/)
  + [EC-CUBEのロゴ](/brand-assets/)
* ## 決済サービス

  + [決済サービス一覧](/alliance/)
  + [EC-CUBEペイメントPlus](/lp/payment/)
  + [EC-CUBEペイメントPlus・BtoB向けプラン](/lp/epsilon-btob/)
  + [Amazon Pay](https://www.ec-cube.net/products/detail.php?product_id=2490)
* ## その他サービス

  + [基幹システム](/lp/core-system/)
  + [物流サービス一覧](/logistics/)
  + [サイトマップ](/sitemap/)

## [EC-CUBE®](/)

* [X](https://x.com/EC_CUBE)
* [Facebook](https://www.facebook.com/eccube/)
* [Wantedly](https://www.wantedly.com/companies/ec-cube)

* [個人情報の取扱いについて](/policy/)
* [個人情報保護方針](/policy/privacy/)
* [Cookieによる情報収集について](/policy/cookie/)
* [外的環境の把握](/policy/foreign-corporation/)
* [情報セキュリティ方針](/policy/security-policy/)

* [サイトマップ](/sitemap/)
* [運営会社](https://www.ec-cube.co.jp/)

© EC-CUBE CO.,LTD.

![](https://www.facebook.com/tr?id=736682659717992&ev=NoScript)



=== Content from jvndb.jvn.jp_067af777_20250124_173643.html ===


![JVN iPedia](/en/common/img/en_logo.gif)
Last Updated:2013/05/23

| [[Japanese]](/ja/contents/2013/JVNDB-2013-000044.html) | |
| --- | --- |
| JVNDB-2013-000044 | |
| EC-CUBE vulnerable to information disclosure as a result of improper input checking | |
| Overview | |
| EC-CUBE from LOCKON CO.,LTD. is an open source system for creating shopping websites. EC-CUBE contains an issue with checking input values, which may result in information disclosure. | |
| CVSS Severity ([What is CVSS?](/en/nav/jvndbhelp.html#jvndb3)) | |
| **CVSS V2 Severity:Base Metrics [5.0](/cvss/en/v2.html#AV:N/AC:L/Au:N/C:P/I:N/A:N) (Medium) [IPA Score]**  * Access Vector: Network * Access Complexity: Low * Authentication: None * Confidentiality Impact: Partial * Integrity Impact: None * Availability Impact: None | |
| Affected Products | |
|  | |
| LOCKON CO.,LTD  * EC-CUBE 2.11.0 * EC-CUBE 2.11.1 * EC-CUBE 2.11.2 * EC-CUBE 2.11.3 * EC-CUBE 2.11.4 * EC-CUBE 2.11.5 * EC-CUBE 2.12.0 * EC-CUBE 2.12.1 * EC-CUBE 2.12.2 * EC-CUBE 2.12.3 * EC-CUBE 2.12.3en * EC-CUBE 2.12.3enP1 * EC-CUBE 2.12.3enP2 | |
|  | |
| Impact | |
| A remote, unauthenticated attacker may obtain information stored in the product. | |
| Solution | |
| [Apply the update or patch] | |
| Vendor Information | |
| LOCKON CO.,LTD  * LOCKON CO.,LTD : [Improper input validation in password reminder function](http://www.ec-cube.net/info/weakness/weakness.php?id=43) (in Japanese) | |
| CWE ([What is CWE?](http://www.ipa.go.jp/security/english/vuln/CWE_en.html)) | |
| 1. [Improper Input Validation](http://www.ipa.go.jp/security/english/vuln/CWE_en.html#CWE20)(CWE-20) [IPA Evaluation] | |
| CVE ([What is CVE?](http://www.ipa.go.jp/security/english/vuln/CVE_en.html)) | |
| 1. [CVE-2013-2315](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2315) | |
| References | |
| 1. JVN : [JVN#39699406](http://jvn.jp/en/jp/JVN39699406/index.html) 2. National Vulnerability Database (NVD) : [CVE-2013-2315](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-2315) | |
| Revision History | |
| * [2013/05/23] | |

| --- | |
| --- | --- |
| Date Public | 2013/05/23 |
| Date First Published | 2013/05/23 |
| Date Last Updated | 2013/05/23 |
| --- | |

* JVN
* [HOME](http://jvn.jp/en/)
* [What is JVN ?](http://jvn.jp/en/nav/jvn.html)
* [Instructions](http://jvn.jp/en/nav/jvnhelp.html)
* [List of Vulnerability Report](http://jvn.jp/en/report/index.html)
* [VN\_JP](http://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](http://jvn.jp/en/adj/index.html)
* [VN\_VU](http://jvn.jp/en/vu/index.html)
* [TA](http://jvn.jp/en/ta/index.html)
* [TRnotes](http://jvn.jp/en/tr/index.html)
* [JVN iPedia](/en/)
* [Search](/search/index.php?mode=_vulnerability_search_IA_VulnSearch&lang=en)
* [What is JVN iPedia?](/en/nav/jvndb.html)
* [How to Use?](/en/nav/jvndbhelp.html)
* [MyJVN](/en/apis/myjvn/index.html)
* [JVNJS/RSS](http://jvn.jp/en/rss/index.html)
* [Vendor List](http://jvn.jp/en/nav/index.html)
* [List of unreachable developers](http://jvn.jp/en/reply/index.html)
* [Contact](http://jvn.jp/en/contact/index.html)

![Copyright © 2007- IPA. All rights reserved.](/common/img/copyright.png)


