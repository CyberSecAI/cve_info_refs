=== Content from tobtu.com_1fde070f_20250125_225137.html ===


* [TobTu](/)
* [Blog](/blog/)
* [News](/news.php)
* [Cracker](/cracker.php)
* [Leaderboard](/leaderboard.php)
* [Tools](/tools.php)
* [Beta](/beta.php)
* [Donate](/donate.php)
* [About](/about.php)

# DecryptoCat

TLDR: If you used group chat in Cryptocat from October 17th, 2011 to June 15th, 2013 assume your messages were compromised.
DSA is probably broken in one-to-one chat over OTR.
ECDSA is probably broken in group chat.
You must update Cryptocat to at least 2.1.12 to be safe from known problems... As soon as it comes out.
Here is the [old post](decryptocat-old.php) where I was less nice (it is a longer read with a little more detail).

A lot of the dates are misunderstood:

[October 17th, 2011](https://github.com/cryptocat/cryptocat/commit/3998d0183076ab09589e694eaa07558ae4955e42#js-cat-js-P14) Diffie-Hellman private keys were reduced to crackable.

[May 7th, 2012](https://github.com/cryptocat/cryptocat/commit/0e3085f0f4efcb89908b7b7112ec6d56ecd25e94#src-client-chrome-plugin-js-cat-js-P65) ECDH introduced and is broken with DecryptoCat.

[April 19th, 2013](https://github.com/cryptocat/cryptocat/commit/f199fcbe4b5c5deb8d7d7ff13f92ee5090d149ed#src-chrome-js-multiparty-js-P4) ECDH is no longer easy to break, but still crackable by governments and large companies.

[June 3rd, 2013](https://github.com/cryptocat/cryptocat/commit/5c69cb7d8543184d2f33944cb4129605d050ecad#src-core-js-lib-multiparty-js-P4) I patched ECDH now private keys are uncrackable.

June 15th, 2013 FireFox approves first 2.x version of Cryptocat that is not using short ECDH private keys.

[July 4th, 2013](https://twitter.com/Sc00bzT/status/352688381647527936) s hits the f.

DecryptoCat v0.1 cracks the group chat ECDH public keys generated by [Cryptocat](https://crypto.cat) versions 1.1.147 through 2.0.41.
Cryptocat version 2.0.42 was released Feb 19, 2013 which increased the key space from 2^54.15 to 2^106.3.
Decryptocat takes advantage of a meet-in-the-middle attack called baby-step giant-step you can effectively square root the key space.
So 2^54.15 turns into 2^27.08 and 2^106.3 to 2^53.15.
For Cryptocat versions before 2.0.42, doing a split of 2\*10^9 and 10^7 it takes about a day to calculate data needed to crack any key in few minutes.
This only requires tens of gigabytes to store.
Doing a 2\*10^8 and 10^8 split it will take an hour to generate and half an hour to crack any private key with that data.
I suggest doing a 2\*10^8 and 10^8 split unless you actually have a bunch of captured conversations or you want to test if the people you are talking to have upgraded.
If there is a next version I'll probably "steal" some code from [curve25519-donna](https://code.google.com/p/curve25519-donna/) and add support for GPUs.

Yes this is scary but I believe everything is/was over https.
So this just means that it was host based security.
Meaning we have to trust that Cryptocat didn't store/transfer encrypted messages or leak their SSL private key.
They have generated a new private key, to prevent someone from breaking into their server and stealing it.
Which might let them decrypt old captured messages.

I found three bugs small private keys for group chat, bad random generation, and improper use of random (this is in a library they use called BigInt).
When I looked at their commit history I found that the small private key bug was worse because the key was a decimal string masquerading as an array of 17, 15 bit integers.
The masquerading bug was added [May 7th, 2012](https://github.com/cryptocat/cryptocat/commit/0e3085f0f4efcb89908b7b7112ec6d56ecd25e94#src-client-chrome-plugin-js-cat-js-P65) when they switched to ECDH and fixed [April 19th, 2013](https://github.com/cryptocat/cryptocat/commit/f199fcbe4b5c5deb8d7d7ff13f92ee5090d149ed#src-chrome-js-multiparty-js-P4).
This caused keys to be super easy to crack (2^27.1 time and memory).
The bug I found and fixed on [June 3rd, 2013](https://github.com/cryptocat/cryptocat/commit/5c69cb7d8543184d2f33944cb4129605d050ecad#src-core-js-lib-multiparty-js-P4) was the private key only being 10^32 instead of 256^32.
A private key that is 10^32 can be broken with 10^16 (2^53.2) time and memory.
Which is roughly 1500 computer-years and 40 petabytes.
So doable but hard.

The bad random generation was a slight bias towards zero when they converted good random data into ASCII characters 0 through 9.
Well I didn't really look at the good random data part but let's assume it's good.
Zero had a 26/251 chance and all the others had a 25/251 chance.
Some people with limited math background might think it is odd to drop random data not in a range, but this is actually correct.
Such as in this case dropping 6 out of 256 values.
The probability of a loop that goes through more than 24 values is 1 in 2^129.1 ((6 / 250) ^ 24).
The heat death of the Universe will happen before then.
Crazy as it might seem dropping 56 out 256 values to get two decimal digits per byte is actually faster.
The expected amount of decimal digits per byte is 1.5625 (2 \* (1 - 56 / 256)) vs 0.9766 (1 \* (1 - 6 / 256)).
Which is exactly 60% faster.
Anyways this really doesn't not hurt security that much... I think.
Oops forgot to mention, there is a timing attack possibility here, but if it is a good PRNG then knowing any part of its output will not let you determine any other part of its output.

The bug in the BigInt library affects DSA in OTR and ECDSA in group chat.
Every 15th bit in the generated random numbers are zero.
This bug is not specific to Cryptocat.
They just happened to use a library with a bug.
Good news is DSA in OTR was [patched](https://github.com/arlolra/otr/commit/8a1c8fa845f3120669c1177b34d61edd0a7194c0) on June 15th, 2013 and ECDSA in group chat was [patched](https://github.com/cryptocat/cryptocat/commit/3e835f4b4aeb2ecaabb297ae60741c5440262d8d#src-core-js-lib-bigint-js-P4) on July 4th, 2013.
As of July 7th, 2013 the official [BigInt](http://leemon.com/crypto/BigInt.html) library is still not patched.
I sent them him an email on July 4th.
Now the bad news, the variable "k" in DSA was generated like this.
And if you know how to Google like I do you'll find [this](http://rdist.root.org/2010/11/19/dsa-requirements-for-random-k-value/).
If any bit is predicable in "k" you can break DSA.
It might take a few signatures, but it should be possible.
You should update Cryptocat to at least 2.1.6 for one-to-one messages.
I believe ECDSA has the same problem with "k" as DSA has.
So ECDSA is also broken, but there has not been a release yet.
I'm not that familiar with DSA and ECDSA but this is just from what I gather from searching.

Cryptocat tried PBKDF2, RSA, Diffie-Hellman, and ECC and managed to mess them all up because they used iterations or key sizes less than the minimums.

Here's the short version with basic changes to the hardness to crack group chat private keys:

| Date introduced | Days in Git | Difficulty rating |
| --- | --- | --- |
| Jul 9, 2011 | 58 | Passwords so probably broken |
| Sep 5, 2011 | 6 | \*\*\* Medium |
| Sep 11, 2011 | 36 | \*\*\*\* Hard |
| Oct 15, 2011 | 2 | \*\*\*\*\* "Impossible" |
| Oct 17, 2011 | 12 | \*\*\* Medium |
| Oct 29, 2011 | 191 | \*\* Easy |
| May 7, 2012 | 347 | \* Encraption |
| Apr 19, 2013 | 45 | \*\*\* Medium |
| Jun 3, 2013 | 30+ | \*\*\*\*\* "Impossible" |

Encraption

Easy

Medium

Hard

"Impossible"
A bored individual could break it

Hard for an individual with a shoestring budget

Governments would have enough resources to break it

Governments would might have enough resources to break it

Secure unless/until there are quantum computers, around a century of Moore's law, or better algorithms.

Here's the long version that describes each change:

| Date introduced | Days in Git | Description |
| --- | --- | --- |
| [Jul 9, 2011](https://github.com/cryptocat/cryptocat/commit/e4ae2afb880297cc9a240564746e0627f08318ca#index-php-P585) | 49 | Passwords: PBKDF2-HMAC-SHA1 with 1000 iterations |
| [Aug 27, 2011](https://github.com/cryptocat/cryptocat/commit/440a10784a93e0b02393a0cabfad07b37c00b204#js-cat-js-P13) | 9 | Passwords: PBKDF2-HMAC-SHA1 with 600 iterations |
| [Sep 5, 2011](https://github.com/cryptocat/cryptocat/commit/98d0e7faef7b11cfbce517bcf0cab78f89502e3e#js-cat-js-P392) | 1 | 768 bit RSA (largest publicly factored key size) |
| [Sep 6, 2011](https://github.com/cryptocat/cryptocat/commit/40d33887da8909b4e80c2e03c46dac1e8267af6e#js-cat-js-P186) | 2 | 512 bit RSA |
| [Sep 8, 2011](https://github.com/cryptocat/cryptocat/commit/bfcb10f1969ac3e9ab171c52b0864db6fcfe76f3#js-cat-js-P31) | 3 | 600 bit RSA ([640 bit takes 5 months on 80 2.2 GHz AMD Opteron CPUs](https://en.wikipedia.org/wiki/RSA_numbers#RSA-640)) |
| [Sep 11, 2011](https://github.com/cryptocat/cryptocat/commit/bc7dd8ecd82b1f953a6f736e18bbc5422ae54b7f#js-rsagen-js-P37) | 0 | 1280 bit RSA |
| [Sep 11, 2011](https://github.com/cryptocat/cryptocat/commit/4530ee3dd5ebd03afce1d016e937758200ef37d5#js-rsagen-js-P4) | 1 | 1024 bit RSA |
| [Sep 12, 2011](https://github.com/cryptocat/cryptocat/commit/f0b8e45548a5d9b793c3b16cf8b9f84c36890234#js-rsagen-js-P4) | 19 | 1048 bit RSA |
| [Oct 1, 2011](https://github.com/cryptocat/cryptocat/commit/7f840479c211daacee702f6a12e008b2aaf9dd2c#js-rsagen-js-P4) | 9 | 1536/1152 bit RSA (Chrome/other) |
| [Oct 10, 2011](https://github.com/cryptocat/cryptocat/commit/22647716e1814e96918d9215ad767b663efd840b#js-rsagen-js-P4) | 5 | 1536/1024 bit RSA (Chrome/other) |
| [Oct 15, 2011](https://github.com/cryptocat/cryptocat/commit/7cfd59d6901059476a4608fe6d5b89edc436791e#js-cat-js-P278) | 2 | "3072 bit" D-H ( 10^64 = 2^212.6 [106.3 bits of security]) |
| [Oct 17, 2011](https://github.com/cryptocat/cryptocat/commit/3998d0183076ab09589e694eaa07558ae4955e42#js-cat-js-P14) | 0 | "3072 bit" D-H (9\*10^31 = 2^106.1 [ 53.1 bits of security]) |
| [Oct 17, 2011](https://github.com/cryptocat/cryptocat/commit/aa200e43878b6bfdbb683f09f8f79bfb90330da5#js-cat-js-P43) | 12 | "4096 bit" D-H ( 10^32 = 2^106.3 [ 53.2 bits of security]) |
| [Oct 29, 2011](https://github.com/cryptocat/cryptocat/commit/dd6b140758c7a32aedae52778eb9f94283916e30#js-cat-js-P14) | 63 | "4096 bit" D-H (9\*10^25 = 2^ 86.2 [ 43.1 bits of security]) |
| [Dec 31, 2011](https://github.com/cryptocat/cryptocat/commit/2b73aa6a20500212e7d8840d60fccb464d334c05#js-cat-js-P4) | 128 | "4096 bit" D-H (9\*10^23 = 2^ 79.6 [ 39.8 bits of security]) |
| [May 7, 2012](https://github.com/cryptocat/cryptocat/commit/0e3085f0f4efcb89908b7b7112ec6d56ecd25e94#src-client-chrome-plugin-js-cat-js-P65) | 347 | ECDH Curve25519 (2\*10^16 = 2^ 54.2 [ 27.1 bits of security]) |
| Sep 22, 2012 (I think) |  | Plug-in is now mandatory. Everything before now could have been compromised by Cryptocat injecting JS. |
| [Apr 19, 2013](https://github.com/cryptocat/cryptocat/commit/f199fcbe4b5c5deb8d7d7ff13f92ee5090d149ed#src-chrome-js-multiparty-js-P4) | 45 | ECDH Curve25519 ( 10^32/8 = 2^103.3 [ 51.7 bits of security]) |
| [Jun 3, 2013](https://github.com/cryptocat/cryptocat/commit/5c69cb7d8543184d2f33944cb4129605d050ecad#src-core-js-lib-multiparty-js-P4) | 0 | ECDH Curve25519 ( 16^64/32 = 2^251.0 [125.5 bits of security]) |
| [Jun 3, 2013](https://github.com/cryptocat/cryptocat/commit/a17bb1599463e0c079137d8200eb32002ac1afc7#src-core-js-lib-multiparty-js-P4) | 30+ | ECDH Curve25519 ( 10^64/8 = 2^209.6 [104.8 bits of security]) |

Copyright © 2025 Steve Thomas



=== Content from www.openwall.com_e4c9375c_20250125_225139.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](14) [[next>]](16) [[<thread-prev]](10) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <51DDBBC6.1070401@redhat.com>
Date: Wed, 10 Jul 2013 13:53:42 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: security curmudgeon <jericho@...rition.org>
Subject: Re: Re: Re: Re: cryptocat/decryptocat - needs a cve?

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 07/10/2013 11:36 AM, security curmudgeon wrote:
>
>
> In reference to Kurt's post:
> <http://seclists.org/oss-sec/2013/q3/66>
>
> I went through the CryptoCat changelog, as well as the audit report
> from 2012 and broke out all the issues as I saw them. They are all
> live on OSVDB, which may help on CVE assignments:
>
> <http://direct.osvdb.org/search?search%5Bvuln_title%5D=cryptocat&search%5Btext_type%5D=titles>
>
>
>

You rock, thanks. Owe you a beer.

Please use (same titles as OSVDB):

CVE-2013-2257 Cryptocat Group Chat ECC Private Key Generation Brute
Force Weakness
CVE-2013-2258 Cryptocat Crafted Nickname User Impersonation Spoofing
CVE-2013-2259 Cryptocat on Firefox Conversation Overview Nickname
Arbitrary Code Execution
CVE-2013-2260 Cryptocat Cryptocat.random() Function Array Key Entropy
Weakness
CVE-2013-2261 Cryptocat for Chrome manifest.json img/keygen.gif
Software Detection Weakness
CVE-2013-2262 Cryptocat strophe.js XMPP Request ID Prediction OTR Chat
Activity Remote Disclosure
CVE-2013-4100 Cryptocat Crafted Username Chat Remote DoS
CVE-2013-4101 Cryptocat Link Markup Decorator addLinks() Function HTML
Handling Weakness
CVE-2013-4102 Cryptocat strophe.js Math.random() Function Random
Number Generator (RNG) Weakness
CVE-2013-4103 Cryptocat Crafted Data URI Remote Script Injection
CVE-2013-4104 Cryptocat OTR Socialist Millionnaire Protocol Key
Exchange Poisoning Weakness
CVE-2013-4105 Cryptocat Multiparty Encryption Scheme AES-CTR Nonce
Re-use Plaintext Traffic Disclosure
CVE-2013-4106 Cryptocat Conversation Overview Nickname XSS
CVE-2013-4107 Cryptocat cryptocat.js handlePresence() Function
Nickname Change XSS
CVE-2013-4108 Cryptocat Multiple Unspecified Minor Issues
CVE-2013-4109 Cryptocat Message Handling Unspecified XSS
CVE-2013-4110 Cryptocat Unspecified Chat Participant User List Disclosure

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)

iQIcBAEBAgAGBQJR3bvFAAoJEBYNRVNeJnmT1ksQAL/C09I0kmpMEB9J8kSF19x+
iQZYNmyK9Cslxl9pdG/HLeLGieFdhGMAJ9CgBMfW82Vil6VAU8AwGn+rG8RUZtdk
cdhh6bGBvj3uLjgz+sabBZdCRSsu/LL6Y5INcQIVkvO5iIBF/HKqMRGBlmGygjdp
fJfLQigoPFcZ1IfIABFv40mMZxr8v6ZMlqukmOVeTyjnDPjNgYzimCqe3kBQzBwE
YA90sISausX5a68Tk3mkRMtsRfEQY7CXG666c/FO2sH+61CbQb8PhfuJ33TRWFog
wDqaphzHgWbBoW11VSlmTcEjGsaL/oxCGrwSqFE4hdg1vWgmxpMNZq6LodVvxTh4
REZaPQtrlJiIJjxFOwHiYUIig+BShgw74iQ4SmTse5PqQ/Z76VQlutQzXqGKdZ/V
xrl7AJvrUiEOHpmfkeS1x9feF85IY+MmDSIqVmRYr/wvClzTOHgFRNiBH4+FHUA1
axl+sLM8dlu4dFJdkPgf/HssQ26LDcLA7AmQxh1Fkb7NdvwGiGQ8F6fBz0JbyTMN
VQ7R/cx2GDagsEaoMmYp3hTMKrJbBpN04OEr/YmE0XWlz3s9dPLswwLdDgI7JDgJ
IGa+hfJCz58KK2JY1ztV0SyD75gcxhPpMxoblQnqlsDnV5lLbNrBLquKze9iXgxc
YCpcKrjSVUT4q5OA5Rob
=s1DF
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


