Based on the provided content, here's a breakdown of the vulnerability related to CVE-2013-2031:

**Root Cause:**

- The vulnerability stems from inconsistencies in how MediaWiki and web browsers interpret character encodings within SVG files. Specifically, MediaWiki's parser could be tricked into interpreting a file as one encoding (e.g. UTF-7) while browsers would interpret the same file as another (e.g., UTF-8).

**Weaknesses/Vulnerabilities:**

- **Character Encoding Mismatch:** MediaWiki's SVG filtering mechanism incorrectly handles UTF-7 encoded sequences, allowing them to bypass the intended JavaScript sanitization.
- **Inadequate Input Validation:** MediaWiki's XML parser, which uses the expat library, did not allow to force an encoding, leading to automatic detection.
- **Bypassed Script Filtering:** By using UTF-7 or other encodings not correctly handled, malicious JavaScript could be embedded within SVG files in a way that is not detected by MediaWiki's server-side checks but is executed by browsers.
- **Use of CDATA sections**: The use of CDATA sections with specific encodings was used to hide script parts from the MediaWiki parser, but rendered as a valid tag by browsers.

**Impact of Exploitation:**

- **Cross-Site Scripting (XSS):** Attackers can inject and execute arbitrary JavaScript code within the context of a user's browser session when a user views a malicious SVG file. This could allow attackers to steal session cookies, perform actions on behalf of the user, or deface the website.
- **Potential for broader attacks:** Although the provided text mentions that larger wikis with separate image origins are probably not affected, smaller wikis without this separation are exposed to the XSS risk.

**Attack Vectors:**

- **SVG File Upload:** The primary attack vector involves uploading a specially crafted SVG file containing the malicious JavaScript code disguised via a character encoding mismatch.
- **User Interaction:** The attack is triggered when a user views the uploaded SVG file through a web browser.

**Required Attacker Capabilities/Position:**

- **Ability to upload files:** An attacker needs to have the ability to upload files to a MediaWiki instance.
- **Knowledge of encoding discrepancies:** The attacker must be aware of the character encoding differences in MediaWiki parsing and how browsers will interpret the SVG file.
- **Basic JavaScript understanding:** The attacker needs to include malicious JavaScript within the SVG to cause an impact.

**Additional Details:**

- The issue was reported by Jan Schejbal from Hatforce.com.
- The vulnerability was tested with Chrome and Firefox, and the vulnerability was fixed in the MediaWiki versions 1.20.5 and 1.19.6.
- The fix involved a whitelist approach of acceptable encodings in order to avoid similar issues using other character encodings.
- Chromium decided not to fix the underlying issue on the browser side.
- The vulnerable code was located in MediaWiki's SVG sanitization routines.