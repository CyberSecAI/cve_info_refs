=== Content from www.vapidlabs.com_43532b25_20250125_225227.html ===


| Advisory #: 36 |
| --- |
| **Title:** Fileutils 0.7 Ruby Gem remote command execution and insecure file handling in /tmp |
| **Author:** Larry W. Cashdollar, @\_larry0 |
| **Date:** 2013-02-24 |
| **CVE-ID:**[[CVE-2013-2516](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2516)] |
| **CWE:** |
| **Download Site:** <http://rubygems.org/gems/fileutils> |
| **Vendor:** Stefaan Colman |
| **Vendor Notified:**  2013-02-24 |
| **Vendor Contact:** slicertje@gmail.com |
| **Advisory:** <http://www.vapid.dhs.org/advisories/file_utils_ruby_gem.html> |
| **Description:** A set of utility classes to extract meta data from different file types. |
| **Vulnerability:**Handles files insecurely in /tmp, a directory is created for that file extension say 'zip' and files are maniplated there. This directory can be hijacked and the contents manipulated by a malicious user. in ./lib/file\_utils.rb 15 def zip (target, \*sources) 16 targetdir = "{FileUtils::Config.tmp\_dir}/zip" 17 id = 1 18 while File.exists?(targetdir) 19 targetdir = "{FileUtils::Config.tmp\_dir}/zip#{id}" 20 id += 1 21 end 22 FileUtils.mkdir(targetdir) where Config.tmp\_dir = /tmp in ./lib/file\_utils/config.rb 5 def self.tmp\_dir 6 @tmp\_dir ||= '/tmp' 7 end Remote command execution: From file\_utils.rb, doesn't sanitize input on URLs passed to CutyCapt for execution. If a URL contains shell characters say a ';' followed by a command a remote attacker execute a command on the clients system if they are enticed to click an encoded url like: need to test URL encoding not sure if this is valid. http://bla.net.org;id>/tmp/o; -> http://tinyurl.com/a5scxzz 7 def capture (url, target) 8 command = FileUtils::Config::Xvfb.command(File.dirname(\_\_FILE\_\_) + "/../bin/CutyCapt --min-width=1024 --min-height=768 --url={url} --out={target}") 9 `#{command}` 10 end partial PoC if client is tricked into using malicious URL: irb(main):001:0> `xvfb-run --server-args="-screen 0,1024x768x24" ./CutyCapt --url=http://www.example.org;id>/tmp/foo; --out=/tmp/tempf` xvfb-run: error: Xvfb failed to start sh: 1: --out=/tmp/tempf: not found => "" irb(main):002:0> root@ubuntu:~/CutyCapt/cutycapt/CutyCapt ls -l /tmp/foo -rw-r--r-- 1 root root 39 Feb 27 02:56 /tmp/foo root@ubuntu:~/CutyCapt/cutycapt/CutyCapt cat /tmp/foo uid=0(root) gid=0(root) groups=0(root) root@ubuntu:~/CutyCapt/cutycapt/CutyCapt# Michael Scherer of Redhat.com found other issues during a discussion about the above issues I found: 1.) In fact, there is the same similar problem in another file : result = `#{FileUtils::Config::OpenOffice.python} #{command} #{source} #{target} #{FileUtils::Config::OpenOffice.port}` I quickly checked using irb ( a quick command line to type ruby snippet, and yes, using funky chars result in funky results. 2.) There is another issue in # Generates a temp filepath for the given extension def temp (extension) path = "{FileUtils::Config.tmp\_dir}/tmp.{extension}" id = 1 while File.exists?(path) path = "{FileUtils::Config.tmp\_dir}/tmp.{id}.#{extension}" id += 1 end since someone could just create the file at the last moment, and make a link so the script would overwrite an arbitrary file. Details for above vulnererabilites: on (1) file\_utils.rb the /tmp file issue is between lines 86 - 92. in file 86 def temp (extension) 87 path = "{FileUtils::Config.tmp\_dir}/tmp.{extension}" 88 id = 1 89 while File.exists?(path) 90 path = "{FileUtils::Config.tmp\_dir}/tmp.{id}.#{extension}" 91 id += 1 92 end And on (2) the file name is ./lib/file\_utils/open\_office.rb on line 27, if the filename being converted contains characters like ; a command can be injected as well. 27 result = `#{FileUtils::Config::OpenOffice.python} #{command} #{source} #{target} #{FileUtils::Config::OpenOffice.port}` |
| **Export:** [JSON](export_mitre_v4.py?id=36) [TEXT](txt.php?v=36) [XML](xml.php?s=36) |
| **Exploit Code:** ```     ``` |
| **Screen Shots:** |
| **Notes:** ``` 90717 ``` |



=== Content from rubygems.org_c7e5484a_20250125_225227.html ===


[⬢
RubyGems](/ "RubyGems") Navigation menu

Search Gems…

[Releases](https://rubygems.org/releases)
[Blog](https://blog.rubygems.org)
[Gems](/gems)
[Guides](https://guides.rubygems.org)
[Sign in](/sign_in)
[Sign up](/sign_up)

# [fileutils](/gems/fileutils) *1.7.3*

Several file utility methods for copying, moving, removing, etc.

## Gemfile: =

## install: =

### Versions:

1. [1.7.3](/gems/fileutils/versions/1.7.3)
   November 01, 2024
   (21.5 KB)
2. [1.7.2](/gems/fileutils/versions/1.7.2)
   November 07, 2023
   (21 KB)
3. [1.7.1](/gems/fileutils/versions/1.7.1)
   April 03, 2023
   (21 KB)
4. [1.7.0](/gems/fileutils/versions/1.7.0)
   December 05, 2022
   (21 KB)
5. [1.6.0](/gems/fileutils/versions/1.6.0)
   October 21, 2021
   (17 KB)

[Show all versions (23 total)](https://rubygems.org/gems/fileutils/versions)

### Owners:

[![](/users/1196/avatar.jpeg?size=48&theme=light)](/profiles/jeremyevans "jeremyevans")[![](/users/15145/avatar.jpeg?size=48&theme=light)](/profiles/a_matsuda "a_matsuda")[![](/users/27848/avatar.jpeg?size=48&theme=light)](/profiles/naruse "naruse")[![](/users/36956/avatar.jpeg?size=48&theme=light)](/profiles/hsbt "hsbt")[![](/users/42780/avatar.jpeg?size=48&theme=light)](/profiles/nobu "nobu")
### Pushed by:

![GitHub](/assets/github_icon-5a736ac0.png "GitHub Actions ruby/fileutils @ .github/workflows/push_gem.yml")
### Authors:

* Minero Aoki

### SHA 256 checksum:

=

[← Previous version](/gems/fileutils/versions/1.7.2)

## Total downloads 12,537,656

## For this version 726,831

## Version Released: November 1, 2024 5:05am

## Licenses: Ruby, BSD-2-Clause

## Required Ruby Version: *>= 2.5.0*

### Links:

[Homepage](https://github.com/ruby/fileutils)
[Download](/downloads/fileutils-1.7.3.gem)
[Review changes](https://my.diffend.io/gems/fileutils/prev/1.7.3)
[Badge](https://badge.fury.io/rb/fileutils/install)
[Subscribe](/sign_in)
[RSS](/gems/fileutils/versions.atom)
Report abuse
[Reverse dependencies](/gems/fileutils/reverse_dependencies)

[Status](https://status.rubygems.org)
[Uptime](https://uptime.rubygems.org)
[Code](https://github.com/rubygems/rubygems.org)
[Data](/pages/data)
[Discuss](https://groups.google.com/group/rubygems-org)
[Stats](/stats)
[Contribute](https://guides.rubygems.org/contributing/)
[About](/pages/about)
Help
[API](https://guides.rubygems.org/rubygems-org-api)
[Security](/pages/security)

RubyGems.org is the Ruby community’s gem hosting service. Instantly [publish your gems](https://guides.rubygems.org/publishing/) and then [install them](https://guides.rubygems.org/command-reference/#gem-install). Use [the API](https://guides.rubygems.org/rubygems-org-api/) to find out more about [available gems](/gems). [Become a contributor](https://guides.rubygems.org/contributing/) and improve the site yourself.

RubyGems.org is made possible through a partnership with the greater Ruby community. [Fastly](https://www.fastly.com/) provides bandwidth and CDN support, [Ruby Central](https://www.rubycentral.org/) covers infrastructure costs, and funds ongoing development and ops work. [Learn more about our sponsors and how they work together](/pages/sponsors).

We need your help to fund the developer time that keeps RubyGems.org running smoothly for everyone. [Join Ruby Central today](https://rubycentral.org/#/portal/signup).

[Supported by
Ruby Central](https://rubycentral.org/)
[Designed by
DockYard](https://dockyard.com/ruby-on-rails-consulting)
[Resolved with
DNSimple](https://dnsimple.link/resolving-rubygems)
[Monitored by
Datadog](https://www.datadoghq.com/)
[Gems served by
Fastly](https://www.fastly.com/)
[Monitored by
Honeybadger](https://www.honeybadger.io/)
[Verified by
Domainr](https://domainr.com/)
[Secured by
Whitesource](https://mend.io/)

[English](/gems/fileutils?locale=en)

[Nederlands](/gems/fileutils?locale=nl)

[简体中文](/gems/fileutils?locale=zh-CN)

[正體中文](/gems/fileutils?locale=zh-TW)

[Português do Brasil](/gems/fileutils?locale=pt-BR)

[Français](/gems/fileutils?locale=fr)

[Español](/gems/fileutils?locale=es)

[Deutsch](/gems/fileutils?locale=de)

[日本語](/gems/fileutils?locale=ja)


