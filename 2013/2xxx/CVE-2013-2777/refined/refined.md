```
{
  "CVE-2013-2777": {
    "Metadata": {
      "CWE": "CWE-269",
      "Description": "sudo before 1.7.10p5 and 1.8.x before 1.8.6p6, when the tty_tickets option is enabled, does not properly validate the controlling terminal device, which allows local users with sudo permissions to hijack the authorization of another terminal via vectors related to a session without a controlling terminal device and connecting to a standard input, output, and error file descriptors of another terminal.",
      "Source": "NIST"
    },
    "Analysis": {
      "Root cause of vulnerability": "The vulnerability exists because sudo does not properly validate the controlling terminal device when the tty_tickets option is enabled. It relies on the ttyname() function to determine the terminal device, which can be manipulated by a malicious user controlling the standard input, output, and error file descriptors.",
      "Weaknesses/vulnerabilities present": [
        "Improper validation of the controlling terminal device.",
        "Reliance on the ttyname() function, which can be manipulated."
      ],
      "Impact of exploitation": "A local user with sudo permissions can bypass the tty_tickets constraint and gain unauthorized access to another user's sudo authorization, allowing them to run commands as that user without knowing their password.",
       "Attack vectors": "A local user with sudo permissions can create a new session without a controlling tty before executing sudo. By manipulating the standard input, output, and error file descriptors (0-2), the user can cause sudo to use ttyname() to resolve the terminal which may result in accessing the timestamp of another user on a different terminal.",
      "Required attacker capabilities/position": "The attacker needs to be a local user with sudo permissions on the target system and have access to a terminal where another user has recently used sudo to obtain an active timestamp."
    },
    "Additional Information": {
      "Affected versions": "Sudo versions before 1.7.10p5 and 1.8.x before 1.8.6p6 with the \"tty_tickets\" option enabled.",
      "Fix information": "The vulnerability is fixed in sudo versions 1.7.10p6 and 1.8.6p7. The fix includes storing the POSIX session ID in the time stamp file and comparing it with the current session ID."
    }
  }
}
```