=== Content from github.com_9aa74007_20250126_013344.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fowncloud-archive%2Fbookmarks%2Fcommit%2F582c3ed)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fowncloud-archive%2Fbookmarks%2Fcommit%2F582c3ed)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=owncloud-archive%2Fbookmarks)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[owncloud-archive](/owncloud-archive)
/
**[bookmarks](/owncloud-archive/bookmarks)**
Public

forked from [nextcloud/bookmarks](/nextcloud/bookmarks)

* [Notifications](/login?return_to=%2Fowncloud-archive%2Fbookmarks) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Fowncloud-archive%2Fbookmarks)
* [Star
   13](/login?return_to=%2Fowncloud-archive%2Fbookmarks)

* [Code](/owncloud-archive/bookmarks)
* [Pull requests
  0](/owncloud-archive/bookmarks/pulls)
* [Actions](/owncloud-archive/bookmarks/actions)
* [Projects
  0](/owncloud-archive/bookmarks/projects)
* [Security](/owncloud-archive/bookmarks/security)
* [Insights](/owncloud-archive/bookmarks/pulse)

Additional navigation options

* [Code](/owncloud-archive/bookmarks)
* [Pull requests](/owncloud-archive/bookmarks/pulls)
* [Actions](/owncloud-archive/bookmarks/actions)
* [Projects](/owncloud-archive/bookmarks/projects)
* [Security](/owncloud-archive/bookmarks/security)
* [Insights](/owncloud-archive/bookmarks/pulse)

## Commit

[Permalink](/owncloud-archive/bookmarks/commit/582c3ed245bdd0a31d9eae9b9c0ff7ee776724c9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Validate $sqlSortColumn

[Browse files](/owncloud-archive/bookmarks/tree/582c3ed245bdd0a31d9eae9b9c0ff7ee776724c9)
Browse the repository at this point in the history

* Loading branch information

[![@eMerzh](https://avatars.githubusercontent.com/u/177003?s=40&v=4)](/eMerzh) [![@LukasReschke](https://avatars.githubusercontent.com/u/878997?s=40&v=4)](/LukasReschke)

[eMerzh](/owncloud-archive/bookmarks/commits?author=eMerzh "View all commits by eMerzh")
authored and
[LukasReschke](/owncloud-archive/bookmarks/commits?author=LukasReschke "View all commits by LukasReschke")
committed
Apr 24, 2013

1 parent
[76b8714](/owncloud-archive/bookmarks/commit/76b871463db12097a29ab52f191874090f996e1e)

commit 582c3ed

Showing
**1 changed file**
with
**9 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

14 changes: 9 additions & 5 deletions

14
[lib/bookmarks.php](#diff-c10c730b0d74204a3bb46724f61d9e098a50c601768c5912704f3a7869720097 "lib/bookmarks.php")

Show comments

[View file](/owncloud-archive/bookmarks/blob/582c3ed245bdd0a31d9eae9b9c0ff7ee776724c9/lib/bookmarks.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -36,7 +36,11 @@ class OC\_Bookmarks\_Bookmarks{ |
|  |  | public static function findBookmarks($offset, $sqlSortColumn, $filter, $filterTagOnly) { |
|  |  | //OCP\Util::writeLog('bookmarks', 'findBookmarks ' .$offset. ' '.$sqlSortColumn.' '. $filter.' '. $filterTagOnly ,OCP\Util::DEBUG); |
|  |  | $CONFIG\_DBTYPE = OCP\Config::getSystemValue( 'dbtype', 'sqlite' ); |
|  |  |  |
|  |  |  |
|  |  | if(!in\_array($sqlSortColumn, array('id', 'url', 'title', 'user\_id', 'description', 'public', 'added', 'lastmodified','clickcount',))) { |
|  |  | $sqlSortColumn = 'bookmarks\_sorting\_recent'; |
|  |  | } |
|  |  |  |
|  |  | $params=array(OCP\USER::getUser()); |
|  |  |  |
|  |  | if( $CONFIG\_DBTYPE == 'sqlite' or $CONFIG\_DBTYPE == 'sqlite3' ) { |
| Expand Down  Expand Up | | @@ -131,17 +135,17 @@ public static function deleteUrl($id) |
|  |  |  |
|  |  | $query = OCP\DB::prepare(" |
|  |  | DELETE FROM `\*PREFIX\*bookmarks` |
|  |  | WHERE `id` = $id |
|  |  | WHERE `id` = ? |
|  |  | "); |
|  |  |  |
|  |  | $result = $query->execute(); |
|  |  | $result = $query->execute(array($id)); |
|  |  |  |
|  |  | $query = OCP\DB::prepare(" |
|  |  | DELETE FROM `\*PREFIX\*bookmarks\_tags` |
|  |  | WHERE `bookmark\_id` = $id |
|  |  | WHERE `bookmark\_id` = ? |
|  |  | "); |
|  |  |  |
|  |  | $result = $query->execute(); |
|  |  | $result = $query->execute(array($id)); |
|  |  | return true; |
|  |  | } |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `582c3ed`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fowncloud-archive%2Fbookmarks%2Fcommit%2F582c3ed) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f16f3327_20250126_013343.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fowncloud%2Fcore%2Fcommit%2F3e8beddfe357e334bc382135fe6cba0f346492e8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fowncloud%2Fcore%2Fcommit%2F3e8beddfe357e334bc382135fe6cba0f346492e8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=owncloud%2Fcore)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[owncloud](/owncloud)
/
**[core](/owncloud/core)**
Public

* [Notifications](/login?return_to=%2Fowncloud%2Fcore) You must be signed in to change notification settings
* [Fork
  2.1k](/login?return_to=%2Fowncloud%2Fcore)
* [Star
   8.4k](/login?return_to=%2Fowncloud%2Fcore)

* [Code](/owncloud/core)
* [Issues
  275](/owncloud/core/issues)
* [Pull requests
  16](/owncloud/core/pulls)
* [Actions](/owncloud/core/actions)
* [Projects
  0](/owncloud/core/projects)
* [Wiki](/owncloud/core/wiki)
* [Security](/owncloud/core/security)
* [Insights](/owncloud/core/pulse)

Additional navigation options

* [Code](/owncloud/core)
* [Issues](/owncloud/core/issues)
* [Pull requests](/owncloud/core/pulls)
* [Actions](/owncloud/core/actions)
* [Projects](/owncloud/core/projects)
* [Wiki](/owncloud/core/wiki)
* [Security](/owncloud/core/security)
* [Insights](/owncloud/core/pulse)

## Commit

[Permalink](/owncloud/core/commit/3e8beddfe357e334bc382135fe6cba0f346492e8)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Backport [#2567](https://github.com/owncloud/core/pull/2567)

[Browse files](/owncloud/core/tree/3e8beddfe357e334bc382135fe6cba0f346492e8)
Browse the repository at this point in the history

* Loading branch information

[![@tanghus](https://avatars.githubusercontent.com/u/533222?s=40&v=4)](/tanghus)

[tanghus](/owncloud/core/commits?author=tanghus "View all commits by tanghus")
committed
Apr 22, 2013

1 parent
[18d5154](/owncloud/core/commit/18d515450a8ef2d10f6ad3b30a8cc13957e072ee)

commit 3e8bedd

Showing
**1 changed file**
with
**16 additions**
and
**15 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

31 changes: 16 additions & 15 deletions

31
[lib/db.php](#diff-7b4fdcedfa8e6a16d52359da3702392548cce47747aecfc115c6c385b0948863 "lib/db.php")

Show comments

[View file](/owncloud/core/blob/3e8beddfe357e334bc382135fe6cba0f346492e8/lib/db.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -633,18 +633,20 @@ public static function insertIfNotExist($table, $input) { |
|  |  | $type = self::$type; |
|  |  |  |
|  |  | $query = ''; |
|  |  | $inserts = array\_values($input); |
|  |  | // differences in escaping of table names ('`' for mysql) and getting the current timestamp |
|  |  | if( $type == 'sqlite' || $type == 'sqlite3' ) { |
|  |  | // NOTE: For SQLite we have to use this clumsy approach |
|  |  | // otherwise all fieldnames used must have a unique key. |
|  |  | $query = 'SELECT \* FROM "' . $table . '" WHERE '; |
|  |  | $query = 'SELECT \* FROM `' . $table . '` WHERE '; |
|  |  | foreach($input as $key => $value) { |
|  |  | $query .= $key . " = '" . $value . '\' AND '; |
|  |  | $query .= '`' . $key . '` = ? AND '; |
| This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fowncloud%2Fcore%2Fcommit%2F3e8beddfe357e334bc382135fe6cba0f346492e8)       Sorry, something went wrong.           Copy link    Quote reply     @Nowaker **[Nowaker](/Nowaker)** [Nov 1, 2013](#r4493189)  Is it really safe now? In my opinion it should be `? = ?`. The first parameter should be bound with [bindColumn](http://php.net/manual/pl/pdostatement.bindcolumn.php). Of course column name should be constant (there is no reason users were to provide table names), but one single hole in one single module can make the whole application vulnerable. Therefore, you should take additional step of binding column names as well.      All reactions | | |
|  |  | } |
|  |  | $query = substr($query, 0, strlen($query) - 5); |
|  |  | try { |
|  |  | $stmt = self::prepare($query); |
|  |  | $result = $stmt->execute(); |
|  |  | $result = $stmt->execute($inserts); |
|  |  |  |
|  |  | } catch(PDOException $e) { |
|  |  | $entry = 'DB Error: "'.$e->getMessage() . '"<br />'; |
|  |  | $entry .= 'Offending command was: ' . $query . '<br />'; |
| Expand All | | @@ -653,28 +655,27 @@ public static function insertIfNotExist($table, $input) { |
|  |  | OC\_Template::printErrorPage( $entry ); |
|  |  | } |
|  |  |  |
|  |  | if($result->numRows() == 0) { |
|  |  | $query = 'INSERT INTO "' . $table . '" ("' |
|  |  | . implode('","', array\_keys($input)) . '") VALUES("' |
|  |  | . implode('","', array\_values($input)) . '")'; |
|  |  | if((int)$result->numRows() === 0) { |
|  |  | $query = 'INSERT INTO `' . $table . '` (`' |
|  |  | . implode('`,`', array\_keys($input)) . '`) VALUES(' |
|  |  | . str\_repeat('?,', count($input)-1).'? ' . ')'; |
|  |  | } else { |
|  |  | return true; |
|  |  | } |
|  |  | } elseif( $type == 'pgsql' || $type == 'oci' || $type == 'mysql' || $type == 'mssql') { |
|  |  | $query = 'INSERT INTO `' .$table . '` (' |
|  |  | . implode(',', array\_keys($input)) . ') SELECT \'' |
|  |  | . implode('\',\'', array\_values($input)) . '\' FROM ' . $table . ' WHERE '; |
|  |  | $query = 'INSERT INTO `' .$table . '` (`' |
|  |  | . implode('`,`', array\_keys($input)) . '`) SELECT ' |
|  |  | . str\_repeat('?,', count($input)-1).'? ' // Is there a prettier alternative? |
|  |  | . 'FROM `' . $table . '` WHERE '; |
|  |  |  |
|  |  | foreach($input as $key => $value) { |
|  |  | $query .= $key . " = '" . $value . '\' AND '; |
|  |  | $query .= '`' . $key . '` = ? AND '; |
|  |  | } |
|  |  | $query = substr($query, 0, strlen($query) - 5); |
|  |  | $query .= ' HAVING COUNT(\*) = 0'; |
|  |  | $inserts = array\_merge($inserts, $inserts); |
|  |  | } |
|  |  |  |
|  |  | // TODO: oci should be use " (quote) instead of ` (backtick). |
|  |  | //OC\_Log::write('core', \_\_METHOD\_\_ . ', type: ' . $type . ', query: ' . $query, OC\_Log::DEBUG); |
|  |  |  |
|  |  | try { |
|  |  | $result = self::prepare($query); |
|  |  | } catch(PDOException $e) { |
| Expand All | | @@ -685,7 +686,7 @@ public static function insertIfNotExist($table, $input) { |
|  |  | OC\_Template::printErrorPage( $entry ); |
|  |  | } |
|  |  |  |
|  |  | return $result->execute(); |
|  |  | return $result->execute($inserts); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `3e8bedd`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fowncloud%2Fcore%2Fcommit%2F3e8beddfe357e334bc382135fe6cba0f346492e8) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from seclists.org_29a8e235_20250124_143014.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](323)
[By Date](date.html#324)
[![Next](/images/right-icon-16x16.png)](325)

[![Previous](/images/left-icon-16x16.png)](339)
[By Thread](index.html#324)
[![Next](/images/right-icon-16x16.png)](326)

![](/shared/images/nst-icons.svg#search)

# ownCloud Security Advisories oC-SA-0{19-27}

---

*From*: Lukas Reschke <lukas () owncloud org>

*Date*: Tue, 14 May 2013 18:02:12 +0200

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

# Multiple SQL Injections (oC-SA-2013-019)
Web: <http://owncloud.org/about/security/advisories/oC-SA-2013-019/>

## AFFECTED SOFTWARE
- ownCloud Server < 5.0.6 (CVE-2013-2045)
- ownCloud Server < 4.5.11 (CVE-2013-2046)

## CVE IDENTIFIERS
- CVE-2013-2045
- CVE-2013-2046

## RISK
- Critical

## Commits
### CVE-2013-2045
- stable5: [e8bedd](<https://github.com/owncloud/core/commit/3e8beddfe357e334bc382135fe6cba0f346492e8>)
### CVE-2013-2046
- stable45: [582c3ed](<https://github.com/owncloud/bookmarks/commit/582c3ed>)

## DESCRIPTION
ownCloud before 5.0.6 does not neutralize special elements that are
passed to the SQL query in lib/db.php which therefore allows an
authenticated attacker to execute arbitrary SQL commands.
(CVE-2013-2045)

ownCloud before 5.0.6 and 4.5.11 does not neutralize special elements
that are passed to the SQL query in lib/bookmarks.php which therefore
allows an authenticated attacker to execute arbitrary SQL commands.
(CVE-2013-2046)

## Credits
The ownCloud Team would like to thank Mateusz Goik (aliantsoft.pl /
CVE-2013-2045) for discovering this vulnerability.

## RESOLUTION
Update to ownCloud Server 5.0.6 or 4.5.11
<http://download.owncloud.org/community/owncloud-5.0.6.tar.bz2>
<http://download.owncloud.org/community/owncloud-4.5.11.tar.bz2>

---------------

# Multiple directory traversals (oC-SA-2013-020)
Web: <http://owncloud.org/about/security/advisories/oC-SA-2013-020/>

## AFFECTED SOFTWARE
- ownCloud Server < 5.0.6 (CVE-2013-2039, CVE-2013-2085)
- ownCloud Server < 4.5.11 (CVE-2013-2039)
- ownCloud Server < 4.0.15 (CVE-2013-2039)

## RISK
- Critical

## COMMITS
### CVE-2013-2039
- stable5: [a7f1269](<https://github.com/owncloud/core/commit/a7f1269>)
- stable45: [6be497c](<https://github.com/owncloud/core/commit/6be497c>)
- stable4: [d38c7a1](<https://github.com/owncloud/core/commit/d38c7a1>)

### CVE-2013-2085
- stable5: [1dfb757](<https://github.com/owncloud/core/commit/1dfb757>)

## DESCRIPTION
Multiple directory traversal vulnerabilities in (1)
apps/files_trashbin/index.php via the "dir" GET parameter and (2)
lib/files/view.php via undefined vectors in all ownCloud versions
prior to 5.0.6 and other versions before 4.0.15, allow authenticated
remote attackers to get access to arbitrary local files.

## Credits
The ownCloud Team would like to thank Mateusz Goik (aliantsoft.pl) for
discovering this vulnerabilities.

## RESOLUTION
Update to ownCloud Server 5.0.6, 4.5.11 or 4.0.15
<http://download.owncloud.org/community/owncloud-5.0.6.tar.bz2>
<http://download.owncloud.org/community/owncloud-4.5.11.tar.bz2>
<http://download.owncloud.org/community/owncloud-4.0.15.tar.bz2>

---------------

# Multiple XSS vulnerabilities (oC-SA-2013-021)
Web: <http://owncloud.org/about/security/advisories/oC-SA-2013-021/>

## AFFECTED SOFTWARE
- ownCloud Server < 5.0.6 (CVE-2013-2040, CVE-2013-2041, CVE-2013-2042)
- ownCloud Server < 4.5.11 (CVE-2013-2040, CVE-2013-2042)
- ownCloud Server < 4.0.15 (CVE-2013-2040, CVE-2013-2042)

## RISK
- Medium

## COMMITS
### CVE-2013-2040
- stable5: [8e61602](<https://github.com/owncloud/apps/commit/8e61602>)
- stable45: [f9aeaa6](<https://github.com/owncloud/apps/commit/f9aeaa6>)
- stable4: [1fb796c](<https://github.com/owncloud/apps/commit/1fb796c>)
### CVE-2013-2041
- stable5: [b38a1adf](<https://github.com/owncloud/core/commit/b38a1adf>),
[95b45a2](<https://github.com/owncloud/bookmarks/commit/95b45a2>)
### CVE-2013-2042
- stable5: [a22cb98](<https://github.com/owncloud/bookmarks/commit/a22cb98>)
- stable45: [f1fdeb2](<https://github.com/owncloud/bookmarks/commit/f1fdeb2>)
- stable4: [df54cd](<https://github.com/owncloud/core/commit/df54cd5d47951098aa208a01d884d79aa5c0e333>)

## DESCRIPTION
Cross-site scripting (XSS) vulnerabilities in multiple files inside
the media application via multiple unspecified vectors in all ownCloud
versions prior to 5.0.6 and other versions before 4.0.15 allows
authenticated remote attackers to inject arbitrary web script or HTML.
(CVE-2013-2040)

Cross-site scripting (XSS) vulnerabilities in (1)
apps/bookmarks/ajax/editBookmark.php via the "tag" GET parameter
(CVE-2013-2041) and in (2) apps/files/js/files.js via the "dir" GET
parameter to apps/files/ajax/newfile.php (CVE-2013-2041) in ownCloud
5.0.x before 5.0.6 allows authenticated remote attackers to inject
arbitrary web script or HTML.

Cross-site scripting (XSS) vulnerabilities in (1)
apps/bookmarks/ajax/addBookmark.php via the "url" GET parameter and in
(2) apps/bookmarks/ajax/editBookmark.php via the "url" POST parameter
in ownCloud 5.0.x before 5.0.6 allows authenticated remote attackers
to inject arbitrary web script or HTML. (CVE-2013-2042)

## Credits
The ownCloud Team would like to thank Mateusz Goik (aliantsoft.pl /
CVE-2013-2040 / CVE-2013-2041) and Kacper R. (<http://devilteam.pl> /
CVE-2013-2042) for discovering this vulnerabilities.

## RESOLUTION
Update to ownCloud Server 5.0.6, 4.5.11 or 4.0.15
<http://download.owncloud.org/community/owncloud-5.0.6.tar.bz2>
<http://download.owncloud.org/community/owncloud-4.5.11.tar.bz2>
<http://download.owncloud.org/community/owncloud-4.0.15.tar.bz2>

---------------

# Open redirector (oC-SA-2013-022)
Web: <http://owncloud.org/about/security/advisories/oC-SA-2013-022/>

## AFFECTED SOFTWARE
- ownCloud Server < 5.0.6

## RISK
- Low

# CVE
- CVE-2013-2044

## COMMITS
- stable5: [bb3d39f](<https://github.com/owncloud/core/commit/bb3d39f>)

## DESCRIPTION
Open redirect vulnerability in index.php (aka the Login Page) in
ownCloud before 5.0.6 allows remote attackers to redirect users to
arbitrary web sites and conduct phishing attacks via a URL in the
redirect_url parameter.

## Credits
The ownCloud Team would like to thank Mateusz Goik (aliantsoft.pl /
CVE-2013-2044) for discovering this vulnerability.

## RESOLUTION
Update to ownCloud Server 5.0.6
<http://download.owncloud.org/community/owncloud-5.0.6.tar.bz2>

---------------

# Password autocompletion (oC-SA-2013-023)
Web: <http://owncloud.org/about/security/advisories/oC-SA-2013-023/>

## AFFECTED SOFTWARE
- ownCloud Server < 5.0.6

## RISK
- Low

# CVE
- CVE-2013-2047

## COMMITS
- stable5: [2030037](<https://github.com/owncloud/core/commit/2030037>),
[794ed99](<https://github.com/owncloud/core/commit/794ed99>)

## DESCRIPTION
Index.php (aka the login page) contains a form that does not disable
the autocomplete setting for the password parameter, which makes it
easier for local users or physically proximate attackers to obtain the
password from web browsers that support autocomplete.

## RESOLUTION
Update to ownCloud Server 5.0.6
<http://download.owncloud.org/community/owncloud-5.0.6.tar.bz2>

---------------

# Privilege escalation in the calendar application (oC-SA-2013-024)
Web: <http://owncloud.org/about/security/advisories/oC-SA-2013-024/>

## AFFECTED SOFTWARE
- ownCloud Server < 5.0.6
- ownCloud Server < 4.5.11

## RISK
- High

# CVE
- CVE-2013-2043

## COMMITS
- stable5: [7223754](<https://github.com/owncloud/calendar/commit/7223754>)
- stable45: [68daff4](<https://github.com/owncloud/calendar/commit/68daff4>)

## DESCRIPTION
Due to not properly checking the ownership of an calendar, an
authenticated attacker is able to download calendars of other users
via the "calendar_id" GET parameter to /apps/calendar/ajax/events.php

Note: Successful exploitation of this privilege escalation requires
the "calendar" app to be enabled (enabled by default).

## Credits
The ownCloud Team would like to thank Mateusz Goik (aliantsoft.pl) for
discovering this vulnerability.

## RESOLUTION
Update to ownCloud Server 5.0.6 or 4.5.11
<http://download.owncloud.org/community/owncloud-5.0.6.tar.bz2>
<http://download.owncloud.org/community/owncloud-4.5.11.tar.bz2>

---------------

# Privilege escalation and CSRF in the API (oC-SA-2013-025)
Web: <http://owncloud.org/about/security/advisories/oC-SA-2013-025/>

## AFFECTED SOFTWARE
- ownCloud Server < 5.0.6

## RISK
- High

# CVE
- CVE-2013-2048

## COMMITS
- stable5: [3bcd10a](<https://github.com/owncloud/calendar/commit/3bcd10a>)

## DESCRIPTION
Due to an insufficient permission check, an authenticated attacker is
able to execute API commands as administrator. Additionally, an
unauthenticated attacker could abuse this flaw as a cross-site request
forgery vulnerability.

## RESOLUTION
Update to ownCloud Server 5.0.6
<http://download.owncloud.org/community/owncloud-5.0.6.tar.bz2>

---------------

# Incomplete blacklist vulnerability (oC-SA-2013-026)
Web: <http://owncloud.org/about/security/advisories/oC-SA-2013-026/>

## AFFECTED SOFTWARE
- ownCloud Server < 5.0.6 (running under Apache)

## CVE IDENTIFIERS
- TBD (already requested)

## RISK
- Critical

## COMMITS
- stable5: [35b1f40](<https://github.com/owncloud/core/commit/35b1f40>)

## DESCRIPTION
Incomplete blacklist vulnerability in ownCloud before 5.0.6 allows
authenticated remote attackers to execute arbitrary PHP code by
uploading a crafted file and accessing an uploaded PHP file.

Note: Successful exploitation requires that the /data/ directory is
stored inside the webroot and a webserver that interprets .htaccess
files (e.g. Apache)

## RESOLUTION
Update to ownCloud Server 5.0.6
<http://download.owncloud.org/community/owncloud-5.0.6.tar.bz2>

---------------

# CSRF token leakage (oC-SA-2013-027)
Web: <http://owncloud.org/about/security/advisories/oC-SA-2013-027/>

## AFFECTED SOFTWARE
- ownCloud Server < 5.0.6

## CVE IDENTIFIERS
- CVE-2013-2086

## RISK
- Medium

## COMMITS
- stable5: [9a53d50](<https://github.com/owncloud/core/commit/9a53d50>)

## DESCRIPTION
The configuration loader in ownCloud 5.0.x before 5.0.6 includes
private data such as CSRF tokens in a JavaScript file, which allows
remote attackers to obtain sensitive information.

## RESOLUTION
Update to ownCloud Server 5.0.6
<http://download.owncloud.org/community/owncloud-5.0.6.tar.bz2>

--
ownCloud
Your Cloud, Your Data, Your Way!

GPG: 0xEB32B77BA406BE99
-----BEGIN PGP SIGNATURE-----

wsFcBAEBAgAQBQJRkl/cCRDrMrd7pAa+mQAA3YYQAL6dExigxrE4GA+IZVeK
6mdFBtsOfzoOHKKaBfN2l0s7cG93BQ2kF8LRvJ5OEG81AuCzsvnGA1thE0om
z2vj8GLEFcP+OPVEDOaXBCe+kVdBN5X2+2Yrs74vCU6xwmbxIOu7F51c5LYp
j3IZnMmflfNu4+TjKmpvkxSkG4gpouc0AG6Yi5wehxpHCezPVLxW4hkYaD7D
I/pwnpY8qPwgCG/Vifr3bxA13U+fBibZHO1Rv4mz0GQi1UoMVQ4pHMOgg0+S
SA6Gq1qnLdoRyujs2kJ4N/1KZueIb1SklKwj8hwfRcD3U9e1U3jcYOEQnwE2
nBriUB2dCHokWn6rHLgJ4AMGXeME0wZFgN8SPfGL1F1CU0RJi4vvMKZyPJ+/
89S5UqV0h7w2UB6VV60NQ3pDadBFW89ggW6E67qV3ejTn99PYgyd/3xsw/zd
ulGUhl/O1lgcOroPaHlRRNj22gx/xn49M0aWoYnCayNLO6RzwIEoInivK8PE
Y2PLKakhat6MgZo5Wq8Wf/KzU17tDKaZYvUwYOwWZIFyy73w+bhIYfSQzuib
FA9lwL8Yygl5nMK3V0u9n1MIdoiQ4UvWcqxRfcOxqrn91FA3R7Gwm3FBW0ct
s/1Rpv0HWSxrlMQSz2dv77UIldWy+ExqPM+wVlVk3EzKaVs2rfue8rW4m9wX
48Bh
=93V1
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](323)
[By Date](date.html#324)
[![Next](/images/right-icon-16x16.png)](325)

[![Previous](/images/left-icon-16x16.png)](339)
[By Thread](index.html#324)
[![Next](/images/right-icon-16x16.png)](326)

### Current thread:

* **ownCloud Security Advisories oC-SA-0{19-27}** *Lukas Reschke (May 14)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from github.com_1a192012_20250126_013342.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fowncloud%2Fcore%2Fcommit%2F3e8beddfe357e334bc382135fe6cba0f346)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fowncloud%2Fcore%2Fcommit%2F3e8beddfe357e334bc382135fe6cba0f346)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=owncloud%2Fcore)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[owncloud](/owncloud)
/
**[core](/owncloud/core)**
Public

* [Notifications](/login?return_to=%2Fowncloud%2Fcore) You must be signed in to change notification settings
* [Fork
  2.1k](/login?return_to=%2Fowncloud%2Fcore)
* [Star
   8.4k](/login?return_to=%2Fowncloud%2Fcore)

* [Code](/owncloud/core)
* [Issues
  275](/owncloud/core/issues)
* [Pull requests
  16](/owncloud/core/pulls)
* [Actions](/owncloud/core/actions)
* [Projects
  0](/owncloud/core/projects)
* [Wiki](/owncloud/core/wiki)
* [Security](/owncloud/core/security)
* [Insights](/owncloud/core/pulse)

Additional navigation options

* [Code](/owncloud/core)
* [Issues](/owncloud/core/issues)
* [Pull requests](/owncloud/core/pulls)
* [Actions](/owncloud/core/actions)
* [Projects](/owncloud/core/projects)
* [Wiki](/owncloud/core/wiki)
* [Security](/owncloud/core/security)
* [Insights](/owncloud/core/pulse)

## Commit

[Permalink](/owncloud/core/commit/3e8beddfe357e334bc382135fe6cba0f346492e8)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Backport [#2567](https://github.com/owncloud/core/pull/2567)

[Browse files](/owncloud/core/tree/3e8beddfe357e334bc382135fe6cba0f346492e8)
Browse the repository at this point in the history

* Loading branch information

[![@tanghus](https://avatars.githubusercontent.com/u/533222?s=40&v=4)](/tanghus)

[tanghus](/owncloud/core/commits?author=tanghus "View all commits by tanghus")
committed
Apr 22, 2013

1 parent
[18d5154](/owncloud/core/commit/18d515450a8ef2d10f6ad3b30a8cc13957e072ee)

commit 3e8bedd

Showing
**1 changed file**
with
**16 additions**
and
**15 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

31 changes: 16 additions & 15 deletions

31
[lib/db.php](#diff-7b4fdcedfa8e6a16d52359da3702392548cce47747aecfc115c6c385b0948863 "lib/db.php")

Show comments

[View file](/owncloud/core/blob/3e8beddfe357e334bc382135fe6cba0f346492e8/lib/db.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -633,18 +633,20 @@ public static function insertIfNotExist($table, $input) { |
|  |  | $type = self::$type; |
|  |  |  |
|  |  | $query = ''; |
|  |  | $inserts = array\_values($input); |
|  |  | // differences in escaping of table names ('`' for mysql) and getting the current timestamp |
|  |  | if( $type == 'sqlite' || $type == 'sqlite3' ) { |
|  |  | // NOTE: For SQLite we have to use this clumsy approach |
|  |  | // otherwise all fieldnames used must have a unique key. |
|  |  | $query = 'SELECT \* FROM "' . $table . '" WHERE '; |
|  |  | $query = 'SELECT \* FROM `' . $table . '` WHERE '; |
|  |  | foreach($input as $key => $value) { |
|  |  | $query .= $key . " = '" . $value . '\' AND '; |
|  |  | $query .= '`' . $key . '` = ? AND '; |
| This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fowncloud%2Fcore%2Fcommit%2F3e8beddfe357e334bc382135fe6cba0f346)       Sorry, something went wrong.           Copy link    Quote reply     @Nowaker **[Nowaker](/Nowaker)** [Nov 1, 2013](#r4493189)  Is it really safe now? In my opinion it should be `? = ?`. The first parameter should be bound with [bindColumn](http://php.net/manual/pl/pdostatement.bindcolumn.php). Of course column name should be constant (there is no reason users were to provide table names), but one single hole in one single module can make the whole application vulnerable. Therefore, you should take additional step of binding column names as well.      All reactions | | |
|  |  | } |
|  |  | $query = substr($query, 0, strlen($query) - 5); |
|  |  | try { |
|  |  | $stmt = self::prepare($query); |
|  |  | $result = $stmt->execute(); |
|  |  | $result = $stmt->execute($inserts); |
|  |  |  |
|  |  | } catch(PDOException $e) { |
|  |  | $entry = 'DB Error: "'.$e->getMessage() . '"<br />'; |
|  |  | $entry .= 'Offending command was: ' . $query . '<br />'; |
| Expand All | | @@ -653,28 +655,27 @@ public static function insertIfNotExist($table, $input) { |
|  |  | OC\_Template::printErrorPage( $entry ); |
|  |  | } |
|  |  |  |
|  |  | if($result->numRows() == 0) { |
|  |  | $query = 'INSERT INTO "' . $table . '" ("' |
|  |  | . implode('","', array\_keys($input)) . '") VALUES("' |
|  |  | . implode('","', array\_values($input)) . '")'; |
|  |  | if((int)$result->numRows() === 0) { |
|  |  | $query = 'INSERT INTO `' . $table . '` (`' |
|  |  | . implode('`,`', array\_keys($input)) . '`) VALUES(' |
|  |  | . str\_repeat('?,', count($input)-1).'? ' . ')'; |
|  |  | } else { |
|  |  | return true; |
|  |  | } |
|  |  | } elseif( $type == 'pgsql' || $type == 'oci' || $type == 'mysql' || $type == 'mssql') { |
|  |  | $query = 'INSERT INTO `' .$table . '` (' |
|  |  | . implode(',', array\_keys($input)) . ') SELECT \'' |
|  |  | . implode('\',\'', array\_values($input)) . '\' FROM ' . $table . ' WHERE '; |
|  |  | $query = 'INSERT INTO `' .$table . '` (`' |
|  |  | . implode('`,`', array\_keys($input)) . '`) SELECT ' |
|  |  | . str\_repeat('?,', count($input)-1).'? ' // Is there a prettier alternative? |
|  |  | . 'FROM `' . $table . '` WHERE '; |
|  |  |  |
|  |  | foreach($input as $key => $value) { |
|  |  | $query .= $key . " = '" . $value . '\' AND '; |
|  |  | $query .= '`' . $key . '` = ? AND '; |
|  |  | } |
|  |  | $query = substr($query, 0, strlen($query) - 5); |
|  |  | $query .= ' HAVING COUNT(\*) = 0'; |
|  |  | $inserts = array\_merge($inserts, $inserts); |
|  |  | } |
|  |  |  |
|  |  | // TODO: oci should be use " (quote) instead of ` (backtick). |
|  |  | //OC\_Log::write('core', \_\_METHOD\_\_ . ', type: ' . $type . ', query: ' . $query, OC\_Log::DEBUG); |
|  |  |  |
|  |  | try { |
|  |  | $result = self::prepare($query); |
|  |  | } catch(PDOException $e) { |
| Expand All | | @@ -685,7 +686,7 @@ public static function insertIfNotExist($table, $input) { |
|  |  | OC\_Template::printErrorPage( $entry ); |
|  |  | } |
|  |  |  |
|  |  | return $result->execute(); |
|  |  | return $result->execute($inserts); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `3e8bedd`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fowncloud%2Fcore%2Fcommit%2F3e8beddfe357e334bc382135fe6cba0f346) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


