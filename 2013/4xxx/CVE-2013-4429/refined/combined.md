=== Content from bugs.launchpad.net_38a97a74_20250126_060801.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1233500/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Not checking ownership of blocks before editing them

Bug #1233500 reported by
[Aaron Wells](https://launchpad.net/~u-aaronw)
on 2013-10-01

[256](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | High | [Son Nguyen](https://launchpad.net/~ngson2000) | [Mahara 1.8.0](https://launchpad.net/mahara/%2Bmilestone/1.8.0) |
|  | [1.5](https://bugs.launchpad.net/mahara/1.5) | Fix Released | Undecided | Unassigned | [Mahara 1.5.12](https://launchpad.net/mahara/%2Bmilestone/1.5.12) |
|  | [1.6](https://bugs.launchpad.net/mahara/1.6) | Fix Released | Undecided | Unassigned | [Mahara 1.6.7](https://launchpad.net/mahara/%2Bmilestone/1.6.7) |
|  | [1.7](https://bugs.launchpad.net/mahara/1.7) | Fix Released | Undecided | Unassigned | [Mahara 1.7.3](https://launchpad.net/mahara/%2Bmilestone/1.7.3) |
|  | [mahara (Debian)](https://bugs.launchpad.net/debian/%2Bsource/mahara "Latest release: 1.0.4-4+lenny11, uploaded to main on 2012-03-10 15:14:46.784227+00:00 by Mahara Debian Packaging Team (pkg-debian), maintained by Mahara Debian Packaging Team (pkg-debian)") | Fix Released | Unknown | [debbugs #727552](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=727552) |  |

### Bug Description

While working on issue [https://bugs.launchpad.net/mahara/+bug/1211758](https://bugs.launchpad.net/mahara/%2Bbug/1211758) , I noticed that I could spoof the ID of the block that I wanted to edit, and by doing this I could edit other users' blocks. I used the "Burp Suite" tool to edit HTTP requests between my browser and my web server.

Steps:

1. Create a Mahara site with two users, A and B

2. User A creates a page with a text block that has ID 35

3. User B creates a page with a text block that has ID 105

4. User B edits their text block, ID 105

5. User B doctors the HTTP request so that the block ID in it is "35" instead of "105"

Result: User A's block 35 has all of its contents overwritten by the settings for block 105.

This attack could be done either by serially guessing IDs, or possibly by getting the ID by looking at a page that the user has view access to.

## CVE References

* [2013-4431](/bugs/cve/2013-4431 "Mahara before 1.5.12, 1.6.x before 1....")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-10-01: |  |  | [#1](/mahara/%2Bbug/1233500/comments/1) |
| --- | --- | --- | --- |

There are several different places in the code where it might be appropriate to check for Block ownership. BlockInstance->instance\_config\_store() is one possibility (though it could be overridden by child blocks).

We check View ownership in blocks.php, so it might make sense to check the block ownership there as well.

Or, in View->process\_changes(), before we set $this->blockinstance\_currently\_being\_configured, it might make sense to verify at that point that the block ID is a block that actually belongs to this view.

There are several different places in the code where it might be appropriate to check for Block ownership. BlockInstance->instance\_config\_store() is one possibility (though it could be overridden by child blocks).
We check View ownership in blocks.php, so it might make sense to check the block ownership there as well.
Or, in View->process\_changes(), before we set $this->blockinstance\_currently\_being\_configured, it might make sense to verify at that point that the block ID is a block that actually belongs to this view.

| Changed in mahara: | |
| --- | --- |
| **assignee**: | nobody → Robert Lyon (robertl-9) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-10-01: |  |  | [#2](/mahara/%2Bbug/1233500/comments/2) |
| --- | --- | --- | --- |

Similarly, you can also delete another user's block. And I suspect you can probably move one as well.

The most appropriate place to check for block ownership before deleting or moving, because of how they pass through View->process\_changes(), is probably in the functions View->moveblockinstance() and View->removeblockinstance().

Similarly, you can also delete another user's block. And I suspect you can probably move one as well.
The most appropriate place to check for block ownership before deleting or moving, because of how they pass through View->process\_changes(), is probably in the functions View->moveblockinstance() and View->removeblockinstance().

[Son Nguyen (ngson2000)](https://launchpad.net/~ngson2000)
on 2013-10-01

| Changed in mahara: | |
| --- | --- |
| **assignee**: | Robert Lyon (robertl-9) → Son Nguyen (ngson2000) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-10-01: |  |  | [#3](/mahara/%2Bbug/1233500/comments/3) |
| --- | --- | --- | --- |

Son posted this patch for the issue: <https://reviews.mahara.org/#/c/2563>

Son posted this patch for the issue: https://reviews.mahara.org/#/c/2563

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-10-02: |  |  | [#4](/mahara/%2Bbug/1233500/comments/4) |
| --- | --- | --- | --- |

Hi Son,

I approved and merged your commit 2563. Can you please backport it to 1.5 - 1.7 ?

Cheers,

Aaron

Hi Son,
I approved and merged your commit 2563. Can you please backport it to 1.5 - 1.7 ?
Cheers,
Aaron

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2013-10-03

| **information type**: | Private Security → Public Security |
| --- | --- |

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2013-10-24

| **no longer affects**: | mahara/1.8 |
| --- | --- |
| Changed in mahara: | |
| **status**: | Fix Committed → Fix Released |

[Salvatore Bonaccorso (carnil)](https://launchpad.net/~carnil)
on 2013-10-24

| **affects**: | debian → mahara (Debian) |
| --- | --- |

[Bug Watch Updater (bug-watch-updater)](https://launchpad.net/~bug-watch-updater)
on 2013-10-24

| Changed in mahara (Debian): | |
| --- | --- |
| **status**: | Unknown → Confirmed |

[Bug Watch Updater (bug-watch-updater)](https://launchpad.net/~bug-watch-updater)
on 2013-12-03

| Changed in mahara (Debian): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1233500/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1233500/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1233500/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1233500/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

* [debbugs #727552](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=727552)

  [done grave fixed-upstream patch security upstream]
  [Edit](/bugs/1233500/%2Bwatch/107745 "Change watch details")

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_9c18bfde_20250125_045841.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1211758/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Arbitrary image download

Bug #1211758 reported by
[Tom](https://launchpad.net/~orf)
on 2013-08-13

[260](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | High | [Robert Lyon](https://launchpad.net/~robertl-9) | [Mahara 1.8.0](https://launchpad.net/mahara/%2Bmilestone/1.8.0) |
|  | [1.5](https://bugs.launchpad.net/mahara/1.5) | Fix Released | High | Unassigned | [Mahara 1.5.12](https://launchpad.net/mahara/%2Bmilestone/1.5.12) |
|  | [1.6](https://bugs.launchpad.net/mahara/1.6) | Fix Released | High | Unassigned | [Mahara 1.6.7](https://launchpad.net/mahara/%2Bmilestone/1.6.7) |
|  | [1.7](https://bugs.launchpad.net/mahara/1.7) | Fix Released | High | Unassigned | [Mahara 1.7.3](https://launchpad.net/mahara/%2Bmilestone/1.7.3) |
|  | [mahara (Debian)](https://bugs.launchpad.net/debian/%2Bsource/mahara "Latest release: 1.0.4-4+lenny11, uploaded to main on 2012-03-10 15:14:46.784227+00:00 by Mahara Debian Packaging Team (pkg-debian), maintained by Mahara Debian Packaging Team (pkg-debian)") | Fix Released | Unknown | [debbugs #727545](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=727545) |  |

### Bug Description

I've discovered a few vulnerabilities within Mahara that allow any user to view private images + blog posts of other users. Disclosure: I know nothing about Mahara and have only used it for the last 2-3 hours, please forgive me if I am wrong in my assumptions about the architecture/functionality.

#1: Upload permissions are not properly checked when creating a journal

When creating a journal entry a user can attach any arbitrary object by ID. From what I can tell every object (file, journal, picture etc) are the same object (artifact?), or at least all have a unique ID. This means that if use the file browser to select a file that you can view, then modify the ID (using Chromes developer tools or in-flight using Burp) to an ID of a folder, journal entry or image then that object will be attached to the journal entry.

Here is a screenshot of the issue: <http://i.imgur.com/Lwpm808.png>

In that image Picture1.png, maxresdefaults.jpg and "tok123tok123's Journal" belong to other users (and give permission errors if you attempt to view them).

#2: Object permissions and types are not correctly checked when embedding content within a page

It is possible to embed private objects belonging to other users within a page. In this screenshot <http://i.imgur.com/SShOalI.png> I have created a page and attached it to a collection. None of the objects in those blocks belong to the current user (and hence are un-viewable), and all are private (the journal entry to the right is unpublished).

You can also select an image file to be embedded as a HTML file (under the 'Some HTML' heading) and get the file contents. You can select a folder, but this causes a 500 error.

When editing a block and selecting an upload the page sends a instconf\_artefactid\_selected[ID] parameter to the server. Simply manipulating the ID in the brackets and the value will let you embed any object.

#3: Export function allows arbitrary file download

Using the technique above you can get a 1024x1024 'thumbnail' of any users arbitrary file. Simply use the export function on a page like the one above where other users images are embedded. Make sure the embedded images max-size is set to 1024 and it will appear within /files/extra.

I know these are not serious issues, but I'm sure there are other permission related issues to be found. I concentrated mainly on the journal and collection features.

See [original description](comments/0)

## CVE References

* [2013-4429](/bugs/cve/2013-4429 "Mahara before 1.5.12, 1.6.x before 1....")

[Tom (orf)](https://launchpad.net/~orf)
on 2013-08-13

| **description**: | updated |
| --- | --- |
| **description**: | updated |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tom (orf)](https://launchpad.net/~orf) wrote on 2013-08-27: |  |  | [#1](/mahara/%2Bbug/1211758/comments/1) |
| --- | --- | --- | --- |

Nobody seemed interested so I made it public. Its not exactly a 0day anyway.

Nobody seemed interested so I made it public. Its not exactly a 0day anyway.

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2013-08-27: |  |  | [#2](/mahara/%2Bbug/1211758/comments/2) |
| --- | --- | --- | --- |

Hello Tom,

Thank you very much for your report.

I'm sorry that nobody had yet responded to your report. I was only recently added to the security group, but only after you had sent your report. We take security seriously at Mahara and do try to respond to any reports very quickly. Unfortunately, this had slipped our attention.

One of our developers will look into this and get back to you as soon as possible.

As it does concern permissions that could be exploited, I reverted the report back to "Private Security".

Thank you again for your report.

Cheers

Kristina

Hello Tom,
Thank you very much for your report.
I'm sorry that nobody had yet responded to your report. I was only recently added to the security group, but only after you had sent your report. We take security seriously at Mahara and do try to respond to any reports very quickly. Unfortunately, this had slipped our attention.
One of our developers will look into this and get back to you as soon as possible.
As it does concern permissions that could be exploited, I reverted the report back to "Private Security".
Thank you again for your report.
Cheers
Kristina

| **information type**: | Public Security → Private Security |
| --- | --- |
| Changed in mahara: | |
| **assignee**: | nobody → Aaron Wells (u-aaronw) |
| **status**: | New → Triaged |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-08-27: |  |  | [#3](/mahara/%2Bbug/1211758/comments/3) |
| --- | --- | --- | --- |

Hi all,

Yeah, sorry about not responding. It appears that our security team wasn't getting subscribed to new security bugs. So, I'm looking into that as well.

Cheers,

Aaron

Hi all,
Yeah, sorry about not responding. It appears that our security team wasn't getting subscribed to new security bugs. So, I'm looking into that as well.
Cheers,
Aaron

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2013-08-28

| Changed in mahara: | |
| --- | --- |
| **importance**: | Undecided → High |

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2013-09-08

| Changed in mahara: | |
| --- | --- |
| **assignee**: | Aaron Wells (u-aaronw) → nobody |
| **assignee**: | nobody → Robert Lyon (robertl-9) |

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2013-09-09

| Changed in mahara: | |
| --- | --- |
| **status**: | Triaged → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-09-12: |  |  | [#4](/mahara/%2Bbug/1211758/comments/4) |
| --- | --- | --- | --- |

Hi Robert,

While working on the Page Skins feature, I had an idea relating to this. One way we can help verify that all attached File artefacts are ones that the user is allowed to use, is that we could put it in the Pieform filebrowser element. Normally, the best function to put it in would probably be the pieform\_element\_{$type}\_set\_attributes() function, but in the case of filebrowser it hacks the normal control flow for Pieforms and does the upload in pieform\_element\_filebrowser\_get\_value(). So we'd have to place it in there somewhere if we were to do this.

If the other artefact selectors are using Pieform elements, we may be able to use something similar for them.

Cheers,

Aaron

Hi Robert,
While working on the Page Skins feature, I had an idea relating to this. One way we can help verify that all attached File artefacts are ones that the user is allowed to use, is that we could put it in the Pieform filebrowser element. Normally, the best function to put it in would probably be the pieform\_element\_{$type}\_set\_attributes() function, but in the case of filebrowser it hacks the normal control flow for Pieforms and does the upload in pieform\_element\_filebrowser\_get\_value(). So we'd have to place it in there somewhere if we were to do this.
If the other artefact selectors are using Pieform elements, we may be able to use something similar for them.
Cheers,
Aaron

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9) wrote on 2013-09-17: |  |  | [#5](/mahara/%2Bbug/1211758/comments/5) |
| --- | --- | --- | --- |

Hi Aaron,

The problem is the site looks to save bad values without actually calling the pieform\_element\_filebrowser\_get\_value()

When I save valid data the function is called but if I do the hack and save bad data the function is not called.

the only consistent joy I can get (so far) is checking the function instance\_config\_store(Pieform $form, $values)

and am able to check there if the artefactids are valid

Hi Aaron,
The problem is the site looks to save bad values without actually calling the pieform\_element\_filebrowser\_get\_value()
When I save valid data the function is called but if I do the hack and save bad data the function is not called.
the only consistent joy I can get (so far) is checking the function instance\_config\_store(Pieform $form, $values)
and am able to check there if the artefactids are valid

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-10-01: |  |  | [#6](/mahara/%2Bbug/1211758/comments/6) |
| --- | --- | --- | --- |

Robert posted a patch for this: <https://reviews.mahara.org/#/c/2487/>

Robert posted a patch for this: https://reviews.mahara.org/#/c/2487/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-10-02: |  |  | [#7](/mahara/%2Bbug/1211758/comments/7) |
| --- | --- | --- | --- |

Okay, the patch has been reviewed and approved. The final merge patches:

1.5: <https://reviews.mahara.org/#/c/2568/>

1.6: <https://reviews.mahara.org/#/c/2569/>

1.7: <https://reviews.mahara.org/#/c/2570/>

1.8: <https://reviews.mahara.org/#/c/2567/>

Okay, the patch has been reviewed and approved. The final merge patches:
1.5: https://reviews.mahara.org/#/c/2568/
1.6: https://reviews.mahara.org/#/c/2569/
1.7: https://reviews.mahara.org/#/c/2570/
1.8: https://reviews.mahara.org/#/c/2567/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-10-02: |  |  | [#8](/mahara/%2Bbug/1211758/comments/8) |
| --- | --- | --- | --- |

Hi Tom,

I just wanted to say thanks again for this report. Looking through the code to resolve this issue, it appears that the Mahara code base is pretty thorough about checking that the user always has the correct permissions for Pages that they want to manipulate, but it was not as thorough about Artefacts. (As you noted, all content in Mahara is stored as an abstract "artefact").

We've developed a patch which covers all the loopholes we could find, and we'll release that shortly in our next minor release. I'm sure there may be some spots that we've missed, so please do let us know if you find any others.

By the way, do you want to be listed on the Mahara security contributors page? <https://wiki.mahara.org/index.php/Contributors#Security_researchers>

Cheers,

Aaron

Hi Tom,
I just wanted to say thanks again for this report. Looking through the code to resolve this issue, it appears that the Mahara code base is pretty thorough about checking that the user always has the correct permissions for Pages that they want to manipulate, but it was not as thorough about Artefacts. (As you noted, all content in Mahara is stored as an abstract "artefact").
We've developed a patch which covers all the loopholes we could find, and we'll release that shortly in our next minor release. I'm sure there may be some spots that we've missed, so please do let us know if you find any others.
By the way, do you want to be listed on the Mahara security contributors page? https://wiki.mahara.org/index.php/Contributors#Security\_researchers
Cheers,
Aaron

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2013-10-03

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-10-03: |  |  | [#9](/mahara/%2Bbug/1211758/comments/9) |
| --- | --- | --- | --- |

We had difficulty implementing a fix for issue #3 in this bug's description: the export of pages that already include links to other users' artefacts. So since preventing the linking to other users' artefacts mitigates the risk of that vulnerability somewhat, I've gone ahead and spun that out into a separate bug: [https://bugs.launchpad.net/mahara/+bug/1234615](https://bugs.launchpad.net/mahara/%2Bbug/1234615)

We had difficulty implementing a fix for issue #3 in this bug's description: the export of pages that already include links to other users' artefacts. So since preventing the linking to other users' artefacts mitigates the risk of that vulnerability somewhat, I've gone ahead and spun that out into a separate bug: https://bugs.launchpad.net/mahara/+bug/1234615

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2013-10-24

| **no longer affects**: | mahara/1.8 |
| --- | --- |
| Changed in mahara: | |
| **status**: | Fix Committed → Fix Released |

[Bug Watch Updater (bug-watch-updater)](https://launchpad.net/~bug-watch-updater)
on 2013-10-24

| Changed in mahara (Debian): | |
| --- | --- |
| **status**: | Unknown → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tom (orf)](https://launchpad.net/~orf) wrote on 2013-10-24: |  |  | [#10](/mahara/%2Bbug/1211758/comments/10) |
| --- | --- | --- | --- |

Heya Aaron,

I would quite like to be listed on the security contributors page, could you link to my blog at <http://tomforb.es> ?

Thanks!

Heya Aaron,
I would quite like to be listed on the security contributors page, could you link to my blog at http://tomforb.es ?
Thanks!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-10-24: |  |  | [#11](/mahara/%2Bbug/1211758/comments/11) |
| --- | --- | --- | --- |

Hi Tom,

Sure thing: <https://wiki.mahara.org/index.php/Contributors#Security_researchers>

Cheers,

Aaron

Hi Tom,
Sure thing: https://wiki.mahara.org/index.php/Contributors#Security\_researchers
Cheers,
Aaron

[Bug Watch Updater (bug-watch-updater)](https://launchpad.net/~bug-watch-updater)
on 2013-12-02

| Changed in mahara (Debian): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1211758/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1211758/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1211758/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1211758/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

* [debbugs #727545](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=727545)

  [done grave patch security upstream]
  [Edit](/bugs/1211758/%2Bwatch/107748 "Change watch details")

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.openwall.com_a0b8d669_20250125_045838.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[thread-next>]](../../../2013/10/10/18) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAA7hUgFVYCP55JoCHdQGwNwe72f7RaJpDUWvLRMJaq+kUyxeVw@mail.gmail.com>
Date: Tue, 8 Oct 2013 12:16:02 +0200
From: Raphael Geissert <geissert@...ian.org>
To: oss-security@...ts.openwall.com
Cc: security@...ara.org
Subject: CVE request: mahara 1.7.3

Hi,

Multiple vulnerabilities have been discovered and fixed in the 1.7.3
release of Mahara:

>From [1]
> * Bug #1211758 Arbitrary image download
> * Bug #1175446 user supplied $_SERVER['HTTP_HOST'] can be used for injections
> * Bug #1233500 Not checking ownership of blocks before editing them

1st and 3rd issues are described at:
<https://mahara.org/interaction/forum/topic.php?id=5753>

2nd issue is described at:
<https://mahara.org/interaction/forum/topic.php?id=5754>

Could CVE ids be assigned please?

To Hugh and the other mahara security people: please chime in if you
have already requested ids to somebody else.

[1] <https://launchpad.net/mahara/1.7/1.7.3#release-notes>

Thanks,
--
Raphael Geissert - Debian Developer
www.debian.org - get.debian.net

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugs.launchpad.net_e12bfddd_20250126_060800.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1211758/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Arbitrary image download

Bug #1211758 reported by
[Tom](https://launchpad.net/~orf)
on 2013-08-13

[260](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | High | [Robert Lyon](https://launchpad.net/~robertl-9) | [Mahara 1.8.0](https://launchpad.net/mahara/%2Bmilestone/1.8.0) |
|  | [1.5](https://bugs.launchpad.net/mahara/1.5) | Fix Released | High | Unassigned | [Mahara 1.5.12](https://launchpad.net/mahara/%2Bmilestone/1.5.12) |
|  | [1.6](https://bugs.launchpad.net/mahara/1.6) | Fix Released | High | Unassigned | [Mahara 1.6.7](https://launchpad.net/mahara/%2Bmilestone/1.6.7) |
|  | [1.7](https://bugs.launchpad.net/mahara/1.7) | Fix Released | High | Unassigned | [Mahara 1.7.3](https://launchpad.net/mahara/%2Bmilestone/1.7.3) |
|  | [mahara (Debian)](https://bugs.launchpad.net/debian/%2Bsource/mahara "Latest release: 1.0.4-4+lenny11, uploaded to main on 2012-03-10 15:14:46.784227+00:00 by Mahara Debian Packaging Team (pkg-debian), maintained by Mahara Debian Packaging Team (pkg-debian)") | Fix Released | Unknown | [debbugs #727545](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=727545) |  |

### Bug Description

I've discovered a few vulnerabilities within Mahara that allow any user to view private images + blog posts of other users. Disclosure: I know nothing about Mahara and have only used it for the last 2-3 hours, please forgive me if I am wrong in my assumptions about the architecture/functionality.

#1: Upload permissions are not properly checked when creating a journal

When creating a journal entry a user can attach any arbitrary object by ID. From what I can tell every object (file, journal, picture etc) are the same object (artifact?), or at least all have a unique ID. This means that if use the file browser to select a file that you can view, then modify the ID (using Chromes developer tools or in-flight using Burp) to an ID of a folder, journal entry or image then that object will be attached to the journal entry.

Here is a screenshot of the issue: <http://i.imgur.com/Lwpm808.png>

In that image Picture1.png, maxresdefaults.jpg and "tok123tok123's Journal" belong to other users (and give permission errors if you attempt to view them).

#2: Object permissions and types are not correctly checked when embedding content within a page

It is possible to embed private objects belonging to other users within a page. In this screenshot <http://i.imgur.com/SShOalI.png> I have created a page and attached it to a collection. None of the objects in those blocks belong to the current user (and hence are un-viewable), and all are private (the journal entry to the right is unpublished).

You can also select an image file to be embedded as a HTML file (under the 'Some HTML' heading) and get the file contents. You can select a folder, but this causes a 500 error.

When editing a block and selecting an upload the page sends a instconf\_artefactid\_selected[ID] parameter to the server. Simply manipulating the ID in the brackets and the value will let you embed any object.

#3: Export function allows arbitrary file download

Using the technique above you can get a 1024x1024 'thumbnail' of any users arbitrary file. Simply use the export function on a page like the one above where other users images are embedded. Make sure the embedded images max-size is set to 1024 and it will appear within /files/extra.

I know these are not serious issues, but I'm sure there are other permission related issues to be found. I concentrated mainly on the journal and collection features.

See [original description](comments/0)

## CVE References

* [2013-4429](/bugs/cve/2013-4429 "Mahara before 1.5.12, 1.6.x before 1....")

[Tom (orf)](https://launchpad.net/~orf)
on 2013-08-13

| **description**: | updated |
| --- | --- |
| **description**: | updated |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tom (orf)](https://launchpad.net/~orf) wrote on 2013-08-27: |  |  | [#1](/mahara/%2Bbug/1211758/comments/1) |
| --- | --- | --- | --- |

Nobody seemed interested so I made it public. Its not exactly a 0day anyway.

Nobody seemed interested so I made it public. Its not exactly a 0day anyway.

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2013-08-27: |  |  | [#2](/mahara/%2Bbug/1211758/comments/2) |
| --- | --- | --- | --- |

Hello Tom,

Thank you very much for your report.

I'm sorry that nobody had yet responded to your report. I was only recently added to the security group, but only after you had sent your report. We take security seriously at Mahara and do try to respond to any reports very quickly. Unfortunately, this had slipped our attention.

One of our developers will look into this and get back to you as soon as possible.

As it does concern permissions that could be exploited, I reverted the report back to "Private Security".

Thank you again for your report.

Cheers

Kristina

Hello Tom,
Thank you very much for your report.
I'm sorry that nobody had yet responded to your report. I was only recently added to the security group, but only after you had sent your report. We take security seriously at Mahara and do try to respond to any reports very quickly. Unfortunately, this had slipped our attention.
One of our developers will look into this and get back to you as soon as possible.
As it does concern permissions that could be exploited, I reverted the report back to "Private Security".
Thank you again for your report.
Cheers
Kristina

| **information type**: | Public Security → Private Security |
| --- | --- |
| Changed in mahara: | |
| **assignee**: | nobody → Aaron Wells (u-aaronw) |
| **status**: | New → Triaged |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-08-27: |  |  | [#3](/mahara/%2Bbug/1211758/comments/3) |
| --- | --- | --- | --- |

Hi all,

Yeah, sorry about not responding. It appears that our security team wasn't getting subscribed to new security bugs. So, I'm looking into that as well.

Cheers,

Aaron

Hi all,
Yeah, sorry about not responding. It appears that our security team wasn't getting subscribed to new security bugs. So, I'm looking into that as well.
Cheers,
Aaron

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2013-08-28

| Changed in mahara: | |
| --- | --- |
| **importance**: | Undecided → High |

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2013-09-08

| Changed in mahara: | |
| --- | --- |
| **assignee**: | Aaron Wells (u-aaronw) → nobody |
| **assignee**: | nobody → Robert Lyon (robertl-9) |

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2013-09-09

| Changed in mahara: | |
| --- | --- |
| **status**: | Triaged → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-09-12: |  |  | [#4](/mahara/%2Bbug/1211758/comments/4) |
| --- | --- | --- | --- |

Hi Robert,

While working on the Page Skins feature, I had an idea relating to this. One way we can help verify that all attached File artefacts are ones that the user is allowed to use, is that we could put it in the Pieform filebrowser element. Normally, the best function to put it in would probably be the pieform\_element\_{$type}\_set\_attributes() function, but in the case of filebrowser it hacks the normal control flow for Pieforms and does the upload in pieform\_element\_filebrowser\_get\_value(). So we'd have to place it in there somewhere if we were to do this.

If the other artefact selectors are using Pieform elements, we may be able to use something similar for them.

Cheers,

Aaron

Hi Robert,
While working on the Page Skins feature, I had an idea relating to this. One way we can help verify that all attached File artefacts are ones that the user is allowed to use, is that we could put it in the Pieform filebrowser element. Normally, the best function to put it in would probably be the pieform\_element\_{$type}\_set\_attributes() function, but in the case of filebrowser it hacks the normal control flow for Pieforms and does the upload in pieform\_element\_filebrowser\_get\_value(). So we'd have to place it in there somewhere if we were to do this.
If the other artefact selectors are using Pieform elements, we may be able to use something similar for them.
Cheers,
Aaron

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9) wrote on 2013-09-17: |  |  | [#5](/mahara/%2Bbug/1211758/comments/5) |
| --- | --- | --- | --- |

Hi Aaron,

The problem is the site looks to save bad values without actually calling the pieform\_element\_filebrowser\_get\_value()

When I save valid data the function is called but if I do the hack and save bad data the function is not called.

the only consistent joy I can get (so far) is checking the function instance\_config\_store(Pieform $form, $values)

and am able to check there if the artefactids are valid

Hi Aaron,
The problem is the site looks to save bad values without actually calling the pieform\_element\_filebrowser\_get\_value()
When I save valid data the function is called but if I do the hack and save bad data the function is not called.
the only consistent joy I can get (so far) is checking the function instance\_config\_store(Pieform $form, $values)
and am able to check there if the artefactids are valid

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-10-01: |  |  | [#6](/mahara/%2Bbug/1211758/comments/6) |
| --- | --- | --- | --- |

Robert posted a patch for this: <https://reviews.mahara.org/#/c/2487/>

Robert posted a patch for this: https://reviews.mahara.org/#/c/2487/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-10-02: |  |  | [#7](/mahara/%2Bbug/1211758/comments/7) |
| --- | --- | --- | --- |

Okay, the patch has been reviewed and approved. The final merge patches:

1.5: <https://reviews.mahara.org/#/c/2568/>

1.6: <https://reviews.mahara.org/#/c/2569/>

1.7: <https://reviews.mahara.org/#/c/2570/>

1.8: <https://reviews.mahara.org/#/c/2567/>

Okay, the patch has been reviewed and approved. The final merge patches:
1.5: https://reviews.mahara.org/#/c/2568/
1.6: https://reviews.mahara.org/#/c/2569/
1.7: https://reviews.mahara.org/#/c/2570/
1.8: https://reviews.mahara.org/#/c/2567/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-10-02: |  |  | [#8](/mahara/%2Bbug/1211758/comments/8) |
| --- | --- | --- | --- |

Hi Tom,

I just wanted to say thanks again for this report. Looking through the code to resolve this issue, it appears that the Mahara code base is pretty thorough about checking that the user always has the correct permissions for Pages that they want to manipulate, but it was not as thorough about Artefacts. (As you noted, all content in Mahara is stored as an abstract "artefact").

We've developed a patch which covers all the loopholes we could find, and we'll release that shortly in our next minor release. I'm sure there may be some spots that we've missed, so please do let us know if you find any others.

By the way, do you want to be listed on the Mahara security contributors page? <https://wiki.mahara.org/index.php/Contributors#Security_researchers>

Cheers,

Aaron

Hi Tom,
I just wanted to say thanks again for this report. Looking through the code to resolve this issue, it appears that the Mahara code base is pretty thorough about checking that the user always has the correct permissions for Pages that they want to manipulate, but it was not as thorough about Artefacts. (As you noted, all content in Mahara is stored as an abstract "artefact").
We've developed a patch which covers all the loopholes we could find, and we'll release that shortly in our next minor release. I'm sure there may be some spots that we've missed, so please do let us know if you find any others.
By the way, do you want to be listed on the Mahara security contributors page? https://wiki.mahara.org/index.php/Contributors#Security\_researchers
Cheers,
Aaron

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2013-10-03

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-10-03: |  |  | [#9](/mahara/%2Bbug/1211758/comments/9) |
| --- | --- | --- | --- |

We had difficulty implementing a fix for issue #3 in this bug's description: the export of pages that already include links to other users' artefacts. So since preventing the linking to other users' artefacts mitigates the risk of that vulnerability somewhat, I've gone ahead and spun that out into a separate bug: [https://bugs.launchpad.net/mahara/+bug/1234615](https://bugs.launchpad.net/mahara/%2Bbug/1234615)

We had difficulty implementing a fix for issue #3 in this bug's description: the export of pages that already include links to other users' artefacts. So since preventing the linking to other users' artefacts mitigates the risk of that vulnerability somewhat, I've gone ahead and spun that out into a separate bug: https://bugs.launchpad.net/mahara/+bug/1234615

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2013-10-24

| **no longer affects**: | mahara/1.8 |
| --- | --- |
| Changed in mahara: | |
| **status**: | Fix Committed → Fix Released |

[Bug Watch Updater (bug-watch-updater)](https://launchpad.net/~bug-watch-updater)
on 2013-10-24

| Changed in mahara (Debian): | |
| --- | --- |
| **status**: | Unknown → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tom (orf)](https://launchpad.net/~orf) wrote on 2013-10-24: |  |  | [#10](/mahara/%2Bbug/1211758/comments/10) |
| --- | --- | --- | --- |

Heya Aaron,

I would quite like to be listed on the security contributors page, could you link to my blog at <http://tomforb.es> ?

Thanks!

Heya Aaron,
I would quite like to be listed on the security contributors page, could you link to my blog at http://tomforb.es ?
Thanks!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-10-24: |  |  | [#11](/mahara/%2Bbug/1211758/comments/11) |
| --- | --- | --- | --- |

Hi Tom,

Sure thing: <https://wiki.mahara.org/index.php/Contributors#Security_researchers>

Cheers,

Aaron

Hi Tom,
Sure thing: https://wiki.mahara.org/index.php/Contributors#Security\_researchers
Cheers,
Aaron

[Bug Watch Updater (bug-watch-updater)](https://launchpad.net/~bug-watch-updater)
on 2013-12-02

| Changed in mahara (Debian): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1211758/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1211758/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1211758/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1211758/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

* [debbugs #727545](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=727545)

  [done grave patch security upstream]
  [Edit](/bugs/1211758/%2Bwatch/107748 "Change watch details")

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from mahara.org_5c7a5e43_20250125_045842.html ===

[Skip to main content](#header-main)

* [Login](https://mahara.org/?login)

Show search

SearchGo

[![Mahara ePortfolio System](https://mahara.org/theme/mahara-org/images/site-logo.svg?v=4171)](https://mahara.org/)
[![Mahara ePortfolio System](https://mahara.org/theme/raw/images/site-logo-small.svg?v=4171)](https://mahara.org/)
Show main menu

* [Home](https://mahara.org/)
* [Subscription](https://mahara.org/subscription)
* [Demo](https://mahara.org/demo)
* About

  + [About Mahara](https://mahara.org/about)
  + [About open source](https://mahara.org/about/opensource)
  + [Features](https://mahara.org/features)
  + [What is an ePortfolio?](https://mahara.org/about/eportfolios)
  + [Who is using Mahara?](https://mahara.org/showcase)
  + [News and announcements](https://mahara.org/news)
  + [Newsletter](https://mahara.org/newsletter)
  + [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* Community

  + [Community](https://mahara.org/community)
  + [Forums](https://mahara.org/forums)
  + [Mahara manual](https://mahara.org/documentation)
  + [Wiki](https://mahara.org/wiki)
  + [Bug / feature tracker](https://mahara.org/tracker)
  + [Release notes](https://mahara.org/releasenotes)
  + [Security](https://mahara.org/security)
  + [Contributors](https://mahara.org/community/contributors)
  + [Branding](https://mahara.org/branding)
  + [Events](https://mahara.org/events)
* Partners

  + [Partners](https://mahara.org/partners)
  + [Business Partners](https://mahara.org/business-partners)
  + [Supporters](https://mahara.org/supporters)

# Portfolios for your learning community

SearchGo

[Try out Mahara](http://demo.mahara.org/)

![Continuous single line drawing of a puhutukawa tree with a tui on the branches](https://mahara.org/theme/mahara-org/images/dashboard-tree-desktop-full.svg)

![Continuous single line drawing of a person working on a laptop](https://mahara.org/theme/mahara-org/images/dashboard-person-desktop.svg)

## Create portfolios

Using Mahara, students and staff create their personal learning stories by uploading evidence of activities they have participated in, and embedding publicly accessible content they have previously put online. They can write reflections on their experiences that frame this evidence, map it to competencies or registration requirements, and provide necessary context.

Mahara can be used for many different portfolio purposes, such as study, professional development, work-integrated learning, assessment, showcase and presentation, and employability.

[Learn about the portfolio options](https://mahara.org/view/view.php?id=137010)

## Share work

Mahara allows portfolios to be shared flexibly with one person, a specific group of people, or the entire world. Access can be further restricted to a particular time frame or just within an assessment task.

[Find out about sharing portfolios](https://mahara.org/view/view.php?id=137011)

![Continuous single line drawing of a paper plane in flight](https://mahara.org/theme/mahara-org/images/dashboard-paperplane-desktop.svg)

![Continuous single line drawing of a group of people sitting around a laptop in discussion](https://mahara.org/theme/mahara-org/images/dashboard-group-desktop.svg)

## Engage with others

Mahara makes it easy to comment and give feedback. Portfolios can also be submitted to learning management systems via LTI (Learning Tools Interoperability) for marking.

Groups in Mahara allow people to create portfolios collaboratively and engage in forum discussions.

[Learn about collaborating in Mahara](https://mahara.org/view/view.php?id=137012)

## Listen to portfolio stories

In our podcast 'Create. Share. Engage.' portfolio practitioners, researchers, learning designers, and portfolio authors share their journey. Learn how they navigate the many different facets of portfolios in general, and Mahara specifically.

[Listen on the podcast website or in your favourite app](https://podcast.mahara.org/)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-desktop.svg)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-logo.svg)

Mahara Community

* [About
  (tab)](https://mahara.org/group/mahara-community)
* [Members
  (tab)](https://mahara.org/group/members.php?id=1)
* [Forums
  (tab selected)](https://mahara.org/interaction/forum/index.php?group=1)
* [Portfolios
  (tab)](https://mahara.org/view/groupviews.php?group=1)

# Forums | Mahara Community

## [Security Announcements](https://mahara.org/interaction/forum/view.php?id=43) / Multiple Access Control Vulnerabilities in <1.5.12, <1.6.7, <1.7.3

---

This topic is closed. Only moderators and the group administrators can post new replies.

![Aaron Wells's profile picture](https://mahara.org/thumb.php?type=profileiconbyid&maxwidth=40&maxheight=40&id=252459)
[Aaron Wells](https://mahara.org/user/aaronw)

Posts: 896

03 October 2013, 22:49

Multiple Access Control Vulnerabilities in <1.5.12, <1.6.7, <1.7.3

Category:     Access Control
Severity:     High
Versions affected:  <1.5.12, <1.6.7, <1.7.3
Reported by:     Tom, Aaron Wells
Bug reports: [1211758](https://bugs.launchpad.net/mahara/%2Bbug/1211758), [1233500](https://bugs.launchpad.net/mahara/%2Bbug/1233500)
CVE references: [CVE-2013-4429](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2013-4429), [CVE-2013-4431](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2013-4431)

Access control vulnerabilities were reported which allow a logged-in attacker to access and manipulate other users' Artefacts and Blocks. These vulnerabilities have been fixed by the Mahara core developers.

As these vulnerabilities affect the privacy and data integrity of all Mahara users, we strongly recommend that all Mahara administrators upgrade to the latest version: 1.5.12, 1.6.7, or 1.7.3.

Download links for fixed versions:

* <https://launchpad.net/mahara/1.5/1.5.12>
* <https://launchpad.net/mahara/1.6/1.6.7>
* <https://launchpad.net/mahara/1.7/1.7.3>

(Update was for adding CVE numbers)

### Edits to this post:

* [![Kristina Hoeppner's profile picture](https://mahara.org/thumb.php?type=profileiconbyid&maxwidth=20&maxheight=20&id=438257)
  Kristina Hoeppner](https://mahara.org/user/anitsirk) -
  10 November 2014, 8:11

1 result

## Subscribe to our monthly newsletter

Do you want to stay updated on the latest news from Mahara and wider portfolio community? Subscribe to the monthly Mahara newsletter from Catalyst, the maintainers of Mahara.

[Sign up for the newsletter](https://zcu.nz/wpPM)

Create. Share. Engage.
[Try out Mahara](http://demo.mahara.org/)
[Support Mahara](https://mahara.org/subscription)

#### [Support](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Mahara manual](https://mahara.org/documentation)
* [Wiki](https://mahara.org/wiki)
* [Bug / feature tracker](https://mahara.org/tracker)
* [Extended security support](https://mahara.org/extended-security-support)

#### [Get involved](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Code repository](https://mahara.org/repository)
* [Contribute](https://mahara.org/contribute)
* [Release notes](https://mahara.org/releasenotes)
* [Events](https://mahara.org/events)

#### [About](https://mahara.org/about)

* [News and announcements](https://mahara.org/news)
* [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* [Contributors](https://mahara.org/community/contributors)
* [Security](https://mahara.org/security)
* [Accessibility](https://mahara.org/accessibility)

#### [Home](https://mahara.org/)

#### [Partners](https://mahara.org/partners)

#### [Subscription](https://mahara.org/subscription)

#### [Demo site](https://mahara.org/demo)

[![Powered by Mahara](https://mahara.org/theme/mahara-org/images/powered_by_mahara.svg?v=4171)](https://mahara.org/)

* [Legal](https://mahara.org/legal.php)
* [Contact us](https://mahara.org/contact.php)
* [Help](https://manual.mahara.org/en/24.04/)

[![Developed and maintained by Catalyst](https://mahara.org/theme/mahara-org/images/maintained-by-catalyst.png)](https://catalyst.net.nz/)

[Follow us on LinkedIn](https://www.linkedin.com/company/1845966)

[Find us on Mastodon](https://mastodon.nzoss.nz/%40mahara)



=== Content from www.openwall.com_23596e69_20250125_045838.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2013/10/14/3) [[next>]](2) [[<thread-prev]](../../../2013/10/11/2) [[thread-next>]](../../../2013/10/16/7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAA7hUgH2+YdcjJ7z5Gc+Pb2F6KpohSjX120H98TXWBG4cHcbGQ@mail.gmail.com>
Date: Tue, 15 Oct 2013 14:18:48 +0200
From: Raphael Geissert <geissert@...ian.org>
To: oss-security@...ts.openwall.com
Subject: Re: CVE request: mahara 1.7.3

So, the commits...

On 8 October 2013 12:16, Raphael Geissert <geissert@...ian.org> wrote:
> Hi,
>
> Multiple vulnerabilities have been discovered and fixed in the 1.7.3
> release of Mahara:
>
> From [1]
>> * Bug #1211758 Arbitrary image download

<https://bazaar.launchpad.net/~mahara-release/mahara/1.7_STABLE/revision/5833>

>> * Bug #1175446 user supplied $_SERVER['HTTP_HOST'] can be used for injections

<https://bazaar.launchpad.net/~mahara-release/mahara/1.7_STABLE/revision/5830>

>> * Bug #1233500 Not checking ownership of blocks before editing them

<https://bazaar.launchpad.net/~mahara-release/mahara/1.7_STABLE/revision/5832>

And while at I found the following:

[https://bugs.launchpad.net/mahara/+bug/1034180](https://bugs.launchpad.net/mahara/%2Bbug/1034180)
<https://bazaar.launchpad.net/~mahara-release/mahara/1.7_STABLE/revision/5831>

Which doesn't appear to be mentioned in the changelog, but the bug
report clearly states it was meant to be handled as a security issue.

Cheers,
--
Raphael Geissert - Debian Developer
www.debian.org - get.debian.net

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_4bd6beb4_20250125_045839.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](../../../2013/10/15/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <525E2937.8090902@redhat.com>
Date: Tue, 15 Oct 2013 23:50:47 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
Subject: Re: Re: CVE request: mahara 1.7.3

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 10/15/2013 06:18 AM, Raphael Geissert wrote:
> So, the commits...
>
> On 8 October 2013 12:16, Raphael Geissert <geissert@...ian.org>
> wrote:
>> Hi,
>>
>> Multiple vulnerabilities have been discovered and fixed in the
>> 1.7.3 release of Mahara:
>>
>> From [1]
>>> * Bug #1211758 Arbitrary image download
>
> <https://bazaar.launchpad.net/~mahara-release/mahara/1.7_STABLE/revision/5833>
>
>
>>> * Bug #1175446 user supplied $_SERVER['HTTP_HOST'] can be used
>>> for injections
>
> <https://bazaar.launchpad.net/~mahara-release/mahara/1.7_STABLE/revision/5830>
>
>
>>> * Bug #1233500 Not checking ownership of blocks before editing
>>> them
>
> <https://bazaar.launchpad.net/~mahara-release/mahara/1.7_STABLE/revision/5832>
>
>
>
> And while at I found the following:
>
> [https://bugs.launchpad.net/mahara/+bug/1034180](https://bugs.launchpad.net/mahara/%2Bbug/1034180)
> <https://bazaar.launchpad.net/~mahara-release/mahara/1.7_STABLE/revision/5831>
>
>  Which doesn't appear to be mentioned in the changelog, but the
> bug report clearly states it was meant to be handled as a security
> issue.
>
> Cheers,
>

Please use:

CVE-2013-4429 Mahara Bug #1211758 Arbitrary image download

CVE-2013-4430 Mahara Bug #1175446 user supplied $_SERVER['HTTP_HOST']
can be used for injections

CVE-2013-4431 Mahara Bug #1233500 Not checking ownership of blocks
before editing them

CVE-2013-4432 Mahara A group member with no access rights to folder
can still view it - [https://bugs.launchpad.net/mahara/+bug/1034180](https://bugs.launchpad.net/mahara/%2Bbug/1034180)

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.15 (GNU/Linux)

iQIcBAEBAgAGBQJSXik3AAoJEBYNRVNeJnmTSCcQAJ4j2ICSEgsXCLb+SM8XOpxh
1JoZtR+D9pGNgDJszJh6MtMapqUQcXoMxBkzoUEqKwCQ+EfW6PhKtruWMsN/EFIL
/HkLm309Qsp/40g1UUyuXnAtq0rproLI4cCD0dKtfzXnRsNVI5DY70nvohLDk04j
VPNJNDcBWewCY9QFQZgXDlawTUSj+cW/sjJnqSQ6WuiJ67xOgAafzFKdfossKjCc
hmvIOe+92f4d8fAg4g4YDMz0hcM1jkVeqSZ0wBTq0ENtGt5OjMMuW2WA53KdfgVF
utKKH38U3/AGUK5AArYxD3748Q6qxsm9Nw2qBjUcTCHruSbZnC3BXjjXa+YPMR3v
oooJcG1ImIdq2Lyc3gW7rLA1JCQBOX/BAAs5OyVjRmQpBCdUHXiB1e9nSt3WkPrc
+blYpSFmR/61dQkHwsJAqLBVMkD1RPKTRBKx2Gge8A2z7KmgOMoP/biON//IyIdt
xteDCOhLnJ/Y4IFa0prhWynnC/DUWMK86HWS5Ev3B4/6tqpIShn0hQD4OaHLp4SO
FQNLSV0dVkZB9qaxZCdqAGMITx2fxxQmYSLk1ITrUNXxjtxNd9Iw5yHUKMZYvvw3
W8wi+RAi623qcuH5icEr9/i5jdWxvKNleiMn5HlIZ+nM6MJrEoPfYq0NlRHJESG0
YPvzE13gCzPdXFPEOeCo
=QBLt
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


