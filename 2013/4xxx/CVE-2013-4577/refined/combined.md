=== Content from bugs.debian.org_50e2a5a2_20250124_224741.html ===

# Debian Bug report logs - #632598 grub-mkconfig: CVE-2013-4577: should set safer permissions even when hashed passwords are found

[![version graph](version.cgi?found=grub2%2F1.99-6;package=grub-common;fixed=grub2%2F2.00-20;height=2;absolute=0;collapse=1;width=2)](version.cgi?package=grub-common;found=grub2%2F1.99-6;info=1;absolute=0;fixed=grub2%2F2.00-20;collapse=1)

Package:
[grub-common](pkgreport.cgi?package=grub-common);
Maintainer for [grub-common](pkgreport.cgi?package=grub-common) is [GRUB Maintainers <pkg-grub-devel@alioth-lists.debian.net>](pkgreport.cgi?maint=pkg-grub-devel%40alioth-lists.debian.net); Source for [grub-common](pkgreport.cgi?package=grub-common) is [src:grub2](pkgreport.cgi?src=grub2) ([PTS](https://tracker.debian.org/pkg/grub2), [buildd](https://buildd.debian.org/grub2), [popcon](https://qa.debian.org/popcon.php?package=grub2)).

Reported by: ["Francesco Poli \(wintermute\)" <invernomuto@paranoici.org>](pkgreport.cgi?submitter=invernomuto%40paranoici.org)

Date: Sun, 3 Jul 2011 22:06:02 UTC

Severity: normal

Tags: patch, security

Found in version grub2/1.99-6

Fixed in version grub2/2.00-20

**Done:** Colin Watson <cjwatson@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=632598;mbox=yes), [status mbox](bugreport.cgi?bug=632598;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=632598;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, GRUB Maintainers <pkg-grub-devel@lists.alioth.debian.org>`:

`Bug#632598`; Package `grub-common`.
(Sun, 03 Jul 2011 22:06:05 GMT) ([full text](bugreport.cgi?bug=632598;msg=2), [mbox](bugreport.cgi?bug=632598;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `"Francesco Poli \(wintermute\)" <invernomuto@paranoici.org>`:

New Bug report received and forwarded. Copy sent to `GRUB Maintainers <pkg-grub-devel@lists.alioth.debian.org>`.
(Sun, 03 Jul 2011 22:06:05 GMT) ([full text](bugreport.cgi?bug=632598;msg=4), [mbox](bugreport.cgi?bug=632598;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=632598;msg=5), [mbox](bugreport.cgi?bug=632598;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=invernomuto%40paranoici.org)
From: "Francesco Poli \(wintermute\)" <invernomuto@paranoici.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: grub-mkconfig: should set safer permissions even when hashed passwords are
found
Date: Sun, 03 Jul 2011 23:33:21 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=632598;msg=5) (text/plain, inline)]
```
```
Package: grub-common
Version: 1.99-6
Severity: normal
Tags: patch, security

Hi!

The following code in grub-mkconfig makes sure that the grub.cfg
configuration file is given read-permissions for non-root users, only
when it does *not* include clear-text passwords:

  if [ "x${grub_cfg}" != "x" ] && ! grep -q "^password " ${grub_cfg}.new ; then
    chmod 444 ${grub_cfg}.new || true
  fi

This is good, since having clear-text passwords in a world-readable
file is not safe.

However, when the configuration file includes hashed passwords (as
in the password_pbkdf2 directive), but no clear-text passwords, it
will end up being world-readable.

I would feel safer, if grub.cfg were left with its stricter permissions
(only readable by root), whenever it includes passwords of any type
(clear-text or hashed).

The attached patch (which is too trivial to be convered by copyright)
should achieve this result.

Please apply and/or forward to upstream, as appropriate.

Thanks for your attention!

-- System Information:
Debian Release: wheezy/sid
  APT prefers testing
  APT policy: (800, 'testing'), (500, 'unstable')
Architecture: amd64 (x86_64)

Kernel: Linux 2.6.39-2-amd64 (SMP w/2 CPU cores)
Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/bash

Versions of packages grub-common depends on:
ii  gettext-base            0.18.1.1-3       GNU Internationalization utilities
ii  libc6                   2.13-7           Embedded GNU C Library: Shared lib
ii  libdevmapper1.02.1      2:1.02.63-3      The Linux Kernel Device Mapper use
ii  libfreetype6            2.4.4-2          FreeType 2 font engine, shared lib
ii  libfuse2                2.8.5-3          Filesystem in Userspace (library)
ii  zlib1g                  1:1.2.3.4.dfsg-3 compression library - runtime

Versions of packages grub-common recommends:
pn  os-prober                     <none>     (no description available)

Versions of packages grub-common suggests:
ii  desktop-base                  6.0.6      common files for the Debian Deskto
pn  grub-emu                      <none>     (no description available)
pn  multiboot-doc                 <none>     (no description available)
pn  xorriso                       <none>     (no description available)

-- Configuration Files:
/etc/grub.d/40_custom [Errno 13] Permission denied: u'/etc/grub.d/40_custom'

-- no debconf information

```
```
[[safer_grub_cfg_perms.diff.gz](bugreport.cgi?att=1;bug=632598;filename=safer_grub_cfg_perms.diff.gz;msg=5) (application/x-gzip, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, GRUB Maintainers <pkg-grub-devel@lists.alioth.debian.org>`:

`Bug#632598`; Package `grub-common`.
(Sun, 03 Jul 2011 22:48:02 GMT) ([full text](bugreport.cgi?bug=632598;msg=7), [mbox](bugreport.cgi?bug=632598;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Vladimir 'φ-coder/phcoder' Serbinenko <phcoder@gmail.com>`:

Extra info received and forwarded to list. Copy sent to `GRUB Maintainers <pkg-grub-devel@lists.alioth.debian.org>`.
(Sun, 03 Jul 2011 22:48:03 GMT) ([full text](bugreport.cgi?bug=632598;msg=9), [mbox](bugreport.cgi?bug=632598;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 632598@bugs.debian.org ([full text](bugreport.cgi?bug=632598;msg=10), [mbox](bugreport.cgi?bug=632598;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=phcoder%40gmail.com)
From: Vladimir 'φ-coder/phcoder' Serbinenko
<phcoder@gmail.com>
To: "Francesco Poli (wintermute)" <invernomuto@paranoici.org>,
632598@bugs.debian.org
Subject: Re: Bug#632598: grub-mkconfig: should set safer permissions even
when hashed passwords are found
Date: Mon, 04 Jul 2011 00:44:12 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=632598;msg=10) (text/plain, inline)]
```
```
On 03.07.2011 23:33, Francesco Poli (wintermute) wrote:
> Please apply and/or forward to upstream, as appropriate.
Upstream always uses stricter permissions independently of its contents.
I would recommend simply dropping debian patch

--
Regards
Vladimir 'φ-coder/phcoder' Serbinenko

```
```
[[signature.asc](bugreport.cgi?att=1;bug=632598;filename=signature.asc;msg=10) (application/pgp-signature, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, GRUB Maintainers <pkg-grub-devel@lists.alioth.debian.org>`:

`Bug#632598`; Package `grub-common`.
(Tue, 05 Jul 2011 17:09:06 GMT) ([full text](bugreport.cgi?bug=632598;msg=12), [mbox](bugreport.cgi?bug=632598;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Francesco Poli <invernomuto@paranoici.org>`:

Extra info received and forwarded to list. Copy sent to `GRUB Maintainers <pkg-grub-devel@lists.alioth.debian.org>`.
(Tue, 05 Jul 2011 17:09:06 GMT) ([full text](bugreport.cgi?bug=632598;msg=14), [mbox](bugreport.cgi?bug=632598;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 632598@bugs.debian.org ([full text](bugreport.cgi?bug=632598;msg=15), [mbox](bugreport.cgi?bug=632598;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=invernomuto%40paranoici.org)
From: Francesco Poli <invernomuto@paranoici.org>
To: Vladimir 'φ-coder/phcoder' Serbinenko
<phcoder@gmail.com>
Cc: 632598@bugs.debian.org
Subject: Re: Bug#632598: grub-mkconfig: should set safer permissions even
when hashed passwords are found
Date: Tue, 5 Jul 2011 18:44:41 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=632598;msg=15) (text/plain, inline)]
```
```
On Mon, 04 Jul 2011 00:44:12 +0200 Vladimir 'φ-coder/phcoder' Serbinenko wrote:

> On 03.07.2011 23:33, Francesco Poli (wintermute) wrote:
> > Please apply and/or forward to upstream, as appropriate.
> Upstream always uses stricter permissions independently of its contents.
> I would recommend simply dropping debian patch

Or maybe amending the Debian patch with my patch...

--
 <http://www.inventati.org/frx/frx-gpg-key-transition-2010.txt>
 New GnuPG key, see the transition document!
..................................................... Francesco Poli .
 GnuPG key fpr == CA01 1147 9CD2 EFDF FB82  3925 3E1C 27E1 1F69 BFFE

```
```
[[Message part 2](bugreport.cgi?att=1;bug=632598;msg=15) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, GRUB Maintainers <pkg-grub-devel@lists.alioth.debian.org>`:

`Bug#632598`; Package `grub-common`.
(Sun, 24 Feb 2013 16:45:03 GMT) ([full text](bugreport.cgi?bug=632598;msg=17), [mbox](bugreport.cgi?bug=632598;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent**
to `Francesco Poli <invernomuto@paranoici.org>`:

Extra info received and forwarded to list. Copy sent to `GRUB Maintainers <pkg-grub-devel@lists.alioth.debian.org>`.
(Sun, 24 Feb 2013 16:45:03 GMT) ([full text](bugreport.cgi?bug=632598;msg=19), [mbox](bugreport.cgi?bug=632598;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 632598@bugs.debian.org ([full text](bugreport.cgi?bug=632598;msg=20), [mbox](bugreport.cgi?bug=632598;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=invernomuto%40paranoici.org)
From: Francesco Poli <invernomuto@paranoici.org>
To: Vladimir 'φ-coder/phcoder' Serbinenko
<phcoder@gmail.com>
Cc: 632598@bugs.debian.org
Subject: Re: Bug#632598: grub-mkconfig: should set safer permissions even
when hashed passwords are found
Date: Sun, 24 Feb 2013 17:40:39 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=632598;msg=20) (text/plain, inline)]
```
```
On Tue, 5 Jul 2011 18:44:41 +0200 Francesco Poli wrote:

> On Mon, 04 Jul 2011 00:44:12 +0200 Vladimir 'φ-coder/phcoder' Serbinenko wrote:
>
> > On 03.07.2011 23:33, Francesco Poli (wintermute) wrote:
> > > Please apply and/or forward to upstream, as appropriate.
> > Upstream always uses stricter permissions independently of its contents.
> > I would recommend simply dropping debian patch
>
> Or maybe amending the Debian patch with my patch...

Hello, is there any progress on this bug (#632598)?

There seems to be no visible progress in a long time.
And the bug is still reproducible.

Since this is a security problem, I consider this as somewhat urgent.

Please apply my patch or, anyway, fix the issue.
Thanks for your time.

--
 <http://www.inventati.org/frx/frx-gpg-key-transition-2010.txt>
 New GnuPG key, see the transition document!
..................................................... Francesco Poli .
 GnuPG key fpr == CA01 1147 9CD2 EFDF FB82  3925 3E1C 27E1 1F69 BFFE

```
```
[[Message part 2](bugreport.cgi?att=1;bug=632598;msg=20) (application/pgp-signature, inline)]
```

---

**Reply sent**
to `Colin Watson <cjwatson@debian.org>`:

You have taken responsibility.
(Thu, 14 Nov 2013 11:51:05 GMT) ([full text](bugreport.cgi?bug=632598;msg=22), [mbox](bugreport.cgi?bug=632598;mbox=yes;msg=22), [link](#21)).

---

**Notification sent**
to `"Francesco Poli \(wintermute\)" <invernomuto@paranoici.org>`:

Bug acknowledged by developer.
(Thu, 14 Nov 2013 11:51:05 GMT) ([full text](bugreport.cgi?bug=632598;msg=24), [mbox](bugreport.cgi?bug=632598;mbox=yes;msg=24), [link](#23)).

---

[Message #25](#25) received at 632598-close@bugs.debian.org ([full text](bugreport.cgi?bug=632598;msg=25), [mbox](bugreport.cgi?bug=632598;mbox=yes;msg=25), reply):

![](/cgi-bin/libravatar.cgi?email=cjwatson%40debian.org)
From: Colin Watson <cjwatson@debian.org>
To: 632598-close@bugs.debian.org
Subject: Bug#632598: fixed in grub2 2.00-20
Date: Thu, 14 Nov 2013 11:49:12 +0000
```
Source: grub2
Source-Version: 2.00-20

We believe that the bug you reported is fixed in the latest version of
grub2, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 632598@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Colin Watson <cjwatson@debian.org> (supplier of updated grub2 package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Thu, 14 Nov 2013 10:49:31 +0000
Source: grub2
Binary: grub2 grub-linuxbios grub-efi grub-common grub2-common grub-emu grub-emu-dbg grub-pc-bin grub-pc-dbg grub-pc grub-rescue-pc grub-coreboot-bin grub-coreboot-dbg grub-coreboot grub-efi-ia32-bin grub-efi-ia32-dbg grub-efi-ia32 grub-efi-amd64-bin grub-efi-amd64-dbg grub-efi-amd64 grub-efi-ia64-bin grub-efi-ia64-dbg grub-efi-ia64 grub-ieee1275-bin grub-ieee1275-dbg grub-ieee1275 grub-firmware-qemu grub-yeeloong-bin grub-yeeloong-dbg grub-yeeloong grub-theme-starfield grub-mount-udeb
Architecture: source i386
Version: 2.00-20
Distribution: unstable
Urgency: low
Maintainer: GRUB Maintainers <pkg-grub-devel@lists.alioth.debian.org>
Changed-By: Colin Watson <cjwatson@debian.org>
Description:
 grub-common - GRand Unified Bootloader (common files)
 grub-coreboot - GRand Unified Bootloader, version 2 (Coreboot version)
 grub-coreboot-bin - GRand Unified Bootloader, version 2 (Coreboot binaries)
 grub-coreboot-dbg - GRand Unified Bootloader, version 2 (Coreboot debug files)
 grub-efi   - GRand Unified Bootloader, version 2 (dummy package)
 grub-efi-amd64 - GRand Unified Bootloader, version 2 (EFI-AMD64 version)
 grub-efi-amd64-bin - GRand Unified Bootloader, version 2 (EFI-AMD64 binaries)
 grub-efi-amd64-dbg - GRand Unified Bootloader, version 2 (EFI-AMD64 debug files)
 grub-efi-ia32 - GRand Unified Bootloader, version 2 (EFI-IA32 version)
 grub-efi-ia32-bin - GRand Unified Bootloader, version 2 (EFI-IA32 binaries)
 grub-efi-ia32-dbg - GRand Unified Bootloader, version 2 (EFI-IA32 debug files)
 grub-efi-ia64 - GRand Unified Bootloader, version 2 (IA64 version)
 grub-efi-ia64-bin - GRand Unified Bootloader, version 2 (IA64 binaries)
 grub-efi-ia64-dbg - GRand Unified Bootloader, version 2 (IA64 debug files)
 grub-emu   - GRand Unified Bootloader, version 2 (emulated version)
 grub-emu-dbg - GRand Unified Bootloader, version 2 (emulated debug files)
 grub-firmware-qemu - GRUB firmware image for QEMU
 grub-ieee1275 - GRand Unified Bootloader, version 2 (Open Firmware version)
 grub-ieee1275-bin - GRand Unified Bootloader, version 2 (Open Firmware binaries)
 grub-ieee1275-dbg - GRand Unified Bootloader, version 2 (Open Firmware debug files)
 grub-linuxbios - GRand Unified Bootloader, version 2 (dummy package)
 grub-mount-udeb - export GRUB filesystems using FUSE (udeb)
 grub-pc    - GRand Unified Bootloader, version 2 (PC/BIOS version)
 grub-pc-bin - GRand Unified Bootloader, version 2 (PC/BIOS binaries)
 grub-pc-dbg - GRand Unified Bootloader, version 2 (PC/BIOS debug files)
 grub-rescue-pc - GRUB bootable rescue images, version 2 (PC/BIOS version)
 grub-theme-starfield - GRand Unified Bootloader, version 2 (starfield theme)
 grub-yeeloong - GRand Unified Bootloader, version 2 (Yeeloong version)
 grub-yeeloong-bin - GRand Unified Bootloader, version 2 (Yeeloong binaries)
 grub-yeeloong-dbg - GRand Unified Bootloader, version 2 (Yeeloong debug files)
 grub2      - GRand Unified Bootloader, version 2 (dummy package)
 grub2-common - GRand Unified Bootloader (common files for version 2)
Closes: [632598](bugreport.cgi?bug=632598) [725451](bugreport.cgi?bug=725451)
Changes:
 grub2 (2.00-20) unstable; urgency=low
 .
   * Backport from upstream:
     - Sort gnumach kernels in version order (closes: #[725451](bugreport.cgi?bug=725451)).
   * Move packaging to git, following upstream.  Adjust Vcs-* fields.
   * Remove obsolete DM-Upload-Allowed field.
   * Merge (completely!) from Ubuntu:
     - Handle probing striped DM-RAID devices (thanks, Robert Collins;
       LP: #803658).
     - Unconditionally create grub.cfg on our EFI boot partition in Secure
       Boot mode; GRUB always needs some configuration in this case to find
       /boot/grub, since we can't modify the signed image at install time
       (Steve Langasek, LP: #1236625).
     - If MokManager is present on the host system, copy it onto the EFI boot
       partition for use (Steve Langasek).
     - Adjust UEFI installation to cope with Kubuntu setting GRUB_DISTRIBUTOR
       (LP: #1242417).
     - If building for Ubuntu:
       + Bypass menu unless other OSes are installed or Shift is pressed.
       + Show the boot menu if the previous boot failed.
       + Set GRUB_GFXPAYLOAD_LINUX=keep unless it's known to be unsupported
         on the current hardware.
       + Set vt.handoff=7 for smooth handoff to kernel graphical mode.
       + In recovery mode, add nomodeset to the Linux kernel arguments, and
         remove the 'set gfxpayload=keep' command.
       + Set default timeout to 10 seconds.
       + Enable hidden timeout support by default.
     - Migrate timeout settings from menu.lst.
     - Probe FusionIO devices (LP: #1237519).
   * Make grub.cfg world-unreadable if even hashed passwords are in use
     (closes: #[632598](bugreport.cgi?bug=632598)).
Checksums-Sha1:
 210f60281e92b50d2da2c91f0930b3085bf5b28d 4420 grub2_2.00-20.dsc
 1b566b08c2483d1dadf65cb3e305df953430d56c 372057 grub2_2.00-20.debian.tar.gz
 b675e7986ee1792a939b5d3bdd8c49f337299fb1 2486 grub2_2.00-20_i386.deb
 b85b0d60237814c5525e3d394c264605e8a63ba4 2486 grub-linuxbios_2.00-20_i386.deb
 2ac3599a0cf9a0ae4dcadfeb4b5910b90aaa5bd3 2504 grub-efi_2.00-20_i386.deb
 59d14d61d41213816c3b8f06e2a641c513702700 2030318 grub-common_2.00-20_i386.deb
 d9719993db810c00c57419fb5bf947051a5819fd 116738 grub2-common_2.00-20_i386.deb
 e021a0823cfd26c81b46bbf4eeecc9ca778cdeff 2342722 grub-emu_2.00-20_i386.deb
 50f817256db54ae289ddc73f22faf7b1644db035 1776854 grub-emu-dbg_2.00-20_i386.deb
 8a605dd79ef475a5675a0edd0255c10d68c20544 801596 grub-pc-bin_2.00-20_i386.deb
 dae11f0dbe4c2e65dd921981df2dafb71a7df78e 2368844 grub-pc-dbg_2.00-20_i386.deb
 abfbfd14f99e35b93d2b9cf91f27e21f679829d0 172146 grub-pc_2.00-20_i386.deb
 ab8418ea6f2edb0a4c8b80ecf89bef7a70e61c6c 1010692 grub-rescue-pc_2.00-20_i386.deb
 23e31e3a8cfb9512e0087603138acbf232196b91 522354 grub-coreboot-bin_2.00-20_i386.deb
 e59ce480d20c7e5b4f0f1d79c6cbca6e0f40fbb4 2185896 grub-coreboot-dbg_2.00-20_i386.deb
 54ddaa4853d073c5a7b9e1484f7f29b7d3b1dd2c 44464 grub-coreboot_2.00-20_i386.deb
 282afbedf8ca51e1833f80642fb827ca94a8f69a 531704 grub-efi-ia32-bin_2.00-20_i386.deb
 dbc231845c5a67bc7ac1b0fd0a156558cadebfdc 2260504 grub-efi-ia32-dbg_2.00-20_i386.deb
 71e9d255550f609367c48d7df6d9f42c8131398f 44498 grub-efi-ia32_2.00-20_i386.deb
 154b1d34596a127d6c1d3a5c58e7515a0f5c6f7e 548592 grub-efi-amd64-bin_2.00-20_i386.deb
 63a4120fe200510858a0952834928fc99de3a796 2338516 grub-efi-amd64-dbg_2.00-20_i386.deb
 071255118fa34ca988649b3d71c2ca740b05a3f5 44490 grub-efi-amd64_2.00-20_i386.deb
 2f2f529c1fb7961b87eaa5b1c7043a8cbcd340b9 518534 grub-ieee1275-bin_2.00-20_i386.deb
 754b30181ab93daf76ccf8b05449b4a1ee12b63f 2139742 grub-ieee1275-dbg_2.00-20_i386.deb
 673aa424e7fc8cbd393e6b59394472b220b0ead3 44462 grub-ieee1275_2.00-20_i386.deb
 afa8b56d469db54c8f4e93ecca01318226f19873 941232 grub-firmware-qemu_2.00-20_i386.deb
 16643dc8cbc0167527c9439a5782ffe8ac159ef0 2147336 grub-theme-starfield_2.00-20_i386.deb
 1a66cdf0e63ee3fb23ee7b4a3833e6caf4c1bf63 323892 grub-mount-udeb_2.00-20_i386.udeb
Checksums-Sha256:
 f39a2765618b7e30aa807226ba20513fa87b41e4dc9b17bf81756a0bc9ec6e59 4420 grub2_2.00-20.dsc
 1a3dffa52ee5e6aa1bebb9502cbdce351576773eeaf634e238af8a4cdd658b45 372057 grub2_2.00-20.debian.tar.gz
 5c1b5e4a175e378b6075a15c7f70ff8706575ae77456afa220a2bd448e40abaf 2486 grub2_2.00-20_i386.deb
 bdda72323a215b9b65ab68c6f1e828a24ce335874f567d3dac64985a1eecfe14 2486 grub-linuxbios_2.00-20_i386.deb
 b51340a093a60788233b9437b2e5c322559219c7ed1510bd8633f335c1cbff5b 2504 grub-efi_2.00-20_i386.deb
 22f09179d3990cfb6d6a5fa9219f4d3a01942b896d258d6d74064299b8776b0f 2030318 grub-common_2.00-20_i386.deb
 c2ad9f36d8e2fa16ad3a45039a8749d32ee7684ebdcc166eccd13f89d7aa860a 116738 grub2-common_2.00-20_i386.deb
 d7359de6d2f15813a380151588239285b42c874cbdd15ee3bc5e29d74f1ef71f 2342722 grub-emu_2.00-20_i386.deb
 bc069fbd7df578618a6d6dca4ba0b01688146293162abb450f5e6f97702c8f56 1776854 grub-emu-dbg_2.00-20_i386.deb
 a4844e1db227a0199584008402b51e02eb10f4cd67a502f4c547c62940349f84 801596 grub-pc-bin_2.00-20_i386.deb
 48b870f9cae4378982683f905939a534dceff3330e5c67f2584fcaf6ba04e465 2368844 grub-pc-dbg_2.00-20_i386.deb
 ff4139a301b535c90790122cda5f2b74063d8725d041e0ca4c15eab045bd7822 172146 grub-pc_2.00-20_i386.deb
 2c3eee1c3d275b8c51c47701f4196ac9a8ad8328a432b2321d7651f8696ebe22 1010692 grub-rescue-pc_2.00-20_i386.deb
 7b42466f44ae60da36ad5dd9bf00afd36e5f708b4735a50c64227bbbecbf44e6 522354 grub-coreboot-bin_2.00-20_i386.deb
 0eee0513e664df08abea6cee7b338212e6df59643e72fc80d79d777b36e554f1 2185896 grub-coreboot-dbg_2.00-20_i386.deb
 24fdcdb306032d481ce37d09f806a4d9ee81b2b56ded0c154e672b6e206f2932 44464 grub-coreboot_2.00-20_i386.deb
 c8a40454936b36d4abb592c6e10e0d97244a0d259424a4108be28bd501ed987c 531704 grub-efi-ia32-bin_2.00-20_i386.deb
 aab333451013cda8c5843a6042b2cc1793c6ef94b705e334689a93446bd62cf8 2260504 grub-efi-ia32-dbg_2.00-20_i386.deb
 456855093d5e34d36053a56669d10dc11bfa0a51937fbffcdeb54661500a96f2 44498 grub-efi-ia32_2.00-20_i386.deb
 ebdd281e58ba256189c49c0fb8db7bd620b624fdf05a8ac06a0ee1cfb5ddcaa0 548592 grub-efi-amd64-bin_2.00-20_i386.deb
 39c08d15b9c60d9efd48655cb68958054ec0734bd741331df3c405f634ba71bb 2338516 grub-efi-amd64-dbg_2.00-20_i386.deb
 c833aec7f6edcce47f7fa0342033174323d4784030ccb14e0211806e263ace0c 44490 grub-efi-amd64_2.00-20_i386.deb
 6348002746cb6ba4e1bf8d3b6da28e83741f9eb7993acfa03bdee9049ffae8f6 518534 grub-ieee1275-bin_2.00-20_i386.deb
 7b4f191e3913fcceac1da3a642d2a33f99100abd9b9c803ee3496f1c12e58d7c 2139742 grub-ieee1275-dbg_2.00-20_i386.deb
 05d253959748ab5b5c7452b1da4ac726eb182aaef0d934ca439c1a5635d37034 44462 grub-ieee1275_2.00-20_i386.deb
 219e32798c872ea00302a1973ac4c70a45b3076de5083ffd068fba6fe5d511ee 941232 grub-firmware-qemu_2.00-20_i386.deb
 31ddd65fd9355a3180e9573141c29872099243011e4da4a127c2f7a1e4aed4b2 2147336 grub-theme-starfield_2.00-20_i386.deb
 f21bd7198f18ea55f230401ae4514b89194ca843a4daf031d623025819bb7c75 323892 grub-mount-udeb_2.00-20_i386.udeb
Files:
 4715f225d75913e5f8745f399a9d7135 4420 admin extra grub2_2.00-20.dsc
 b58e4c561cb2dd2022c1b8bdb8280b69 372057 admin extra grub2_2.00-20.debian.tar.gz
 7476a4183f832cf585a741b589d9acfa 2486 oldlibs extra grub2_2.00-20_i386.deb
 3bb39d5c5bc9e5f9feccdf169f40a258 2486 oldlibs extra grub-linuxbios_2.00-20_i386.deb
 99307944e731cb327522eee670f33d1f 2504 oldlibs extra grub-efi_2.00-20_i386.deb
 8d2371e821ab00eef3fbf83ef335a9f5 2030318 admin optional grub-common_2.00-20_i386.deb
 0f470eaf6895d8bea0fc4d882157b332 116738 admin optional grub2-common_2.00-20_i386.deb
 4f3c9002aad54169de37f79427ec1678 2342722 admin extra grub-emu_2.00-20_i386.deb
 342a89289920cdbf18be58c2bd26c40a 1776854 debug extra grub-emu-dbg_2.00-20_i386.deb
 4c0ba41d94b5d69e97b7d8b15bd2abcc 801596 admin optional grub-pc-bin_2.00-20_i386.deb
 506597ff94f180738db231c55e5486ea 2368844 debug extra grub-pc-dbg_2.00-20_i386.deb
 47c1200baa7f98338c57ac5fc471c1c1 172146 admin optional grub-pc_2.00-20_i386.deb
 d201ce0b511e2a2a0013e9d6b1d91612 1010692 admin extra grub-rescue-pc_2.00-20_i386.deb
 47ee92e53550b4235e7b391fc898e185 522354 admin extra grub-coreboot-bin_2.00-20_i386.deb
 2e58e52789b95c8baf2f93cc47f8c4eb 2185896 debug extra grub-coreboot-dbg_2.00-20_i386.deb
 145a50834d23392fa6868705a9e1486f 44464 admin extra grub-coreboot_2.00-20_i386.deb
 a84308fd0bc96126595fb564ef8ea28c 531704 admin extra grub-efi-ia32-bin_2.00-20_i386.deb
 7991cbb9138aee60d957dfc5cec74462 2260504 debug extra grub-efi-ia32-dbg_2.00-20_i386.deb
 96b7ed4f18d7c157550140944b70d762 44498 admin extra grub-efi-ia32_2.00-20_i386.deb
 b2293d68be7b2be53a345da6185505a8 548592 admin extra grub-efi-amd64-bin_2.00-20_i386.deb
 ed9828b2519fd17e5460df3554c2a18f 2338516 debug extra grub-efi-amd64-dbg_2.00-20_i386.deb
 25834e74ef15f7b00eeacb8c2b7df748 44490 admin extra grub-efi-amd64_2.00-20_i386.deb
 556ad5543ccd8beb4cec5c115ea74236 518534 admin extra grub-ieee1275-bin_2.00-20_i386.deb
 0d8e9a4eaa0498f76f7f43a77ca25cb4 2139742 debug extra grub-ieee1275-dbg_2.00-20_i386.deb
 17a94490bbced63ab4624d94414914a9 44462 admin extra grub-ieee1275_2.00-20_i386.deb
 52c0ac9225a292eb2b991b2a411c9f1b 941232 admin extra grub-firmware-qemu_2.00-20_i386.deb
 f33f5a94872f99d49811196c2fc07f41 2147336 admin extra grub-theme-starfield_2.00-20_i386.deb
 e1bc6d4f069660266d757634d4104364 323892 debian-installer extra grub-mount-udeb_2.00-20_i386.udeb
Package-Type: udeb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.15 (GNU/Linux)
Comment: Colin Watson <cjwatson@debian.org> -- Debian developer

iQIVAwUBUoS1Vjk1h9l9hlALAQiTaA//Qog8Xz8bLvz40stT/x3b/GI+ywiNJsTP
SSQaDSYJ31S5vF3OPbaoIjWC7XdlU44tEoYrGLk2Xindz1ojWj4ygnYGwCoyu+6A
b89SryD9XfH83dba3JLWEkr2+pTYCQcLy7HAeQtrFa4us0HaRyVLBCImymC690Fy
soD17kWykAMfEZIrvl4xkUUXZC3xEEcuaeJVDMDOUWyUdWrWvvb2OwzUJ5xj7ie7
cJa5QqfskoIk/BDKonwYRgmtfTgM3E1DxbGB7eSkaTv1f5IjWPggbcqVmm8sbkAX
scf5p4QJVScdm/oHBG7LYyaSeMJ0U3EQeJOuWRG+VOX6LGLQt5dLv5G8njG2hS79
+FoDo+aMaSs0s2g99wy1eWPFFWVVa00sKx9+AERjn0l8zupDv0qpoTM9w0uElFSe
Xi/8qMn0dJXpAAk4uVplPtshqAsFiXubH9eyANMKr8jWfxZHgFYR12raYXUVLjYt
XMQ/utoQslrZSqbJvtamNNAMRErEVjuWAQHnNwprOYAW5r5bk3NiOj8+dgrDBEGY
KU6tfidBEZtQDQDHr/uEC35LkADfvLh9wHwjLAtBCSWISODARwQHiyVjFlwLn45V
f3/W1v8yzaL4TANUD93zuG20pO5FJEGYXLbJYAeMhj5pkYRNJGuy9TPGuZpcMton
ImMmRfDRogA=
=Sm4N
-----END PGP SIGNATURE-----

```

---

**Changed Bug title to 'grub-mkconfig: CVE-2013-4577: should set safer permissions even when hashed passwords are found' from 'grub-mkconfig: should set safer permissions even when hashed passwords are found'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Fri, 15 Nov 2013 06:42:04 GMT) ([full text](bugreport.cgi?bug=632598;msg=27), [mbox](bugreport.cgi?bug=632598;mbox=yes;msg=27), [link](#26)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Wed, 15 Jan 2014 07:38:43 GMT) ([full text](bugreport.cgi?bug=632598;msg=29), [mbox](bugreport.cgi?bug=632598;mbox=yes;msg=29), [link](#28)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=632598).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 22:47:41 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from seclists.org_3a91eab2_20250124_224735.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](290)
[By Date](date.html#291)
[![Next](/images/right-icon-16x16.png)](292)

[![Previous](/images/left-icon-16x16.png)](293)
[By Thread](index.html#291)
[![Next](/images/right-icon-16x16.png)](292)

![](/shared/images/nst-icons.svg#search)

# CVE Request: grub-mkconfig

---

*From*: Seth Arnold <seth.arnold () canonical com>

*Date*: Thu, 14 Nov 2013 16:04:31 -0800

---

```
Hello Kurt, all,

Please assign a CVE for grub-mkconfig.

grub-mkconfig on Debian and derivatives sets mode 444 on grub.cfg
configuration files if there are no plaintext passwords in the
configuration file. However, the permissions are still set world readable
if the password_pbkdf2 directive includes a hashed password.

The original bug report and proposed patch is by Francesco Poli:

<http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=632598>

Original compressed patch:

<http://bugs.debian.org/cgi-bin/bugreport.cgi?msg=5;filename=safer_grub_cfg_perms.diff.gz;att=1;bug=632598>

Patch, uncompressed and inlined:

diff -ruN a/grub-mkconfig b/grub-mkconfig
--- a/grub-mkconfig     2011-05-31 11:33:31.000000000 +0200
+++ b/grub-mkconfig     2011-07-03 21:15:53.000000000 +0200
@@ -293,7 +293,7 @@
   esac
 done

-if [ "x${grub_cfg}" != "x" ] && ! grep -q "^password " ${grub_cfg}.new ; then
+if [ "x${grub_cfg}" != "x" ] && ! grep -q "^password" ${grub_cfg}.new ; then
   chmod 444 ${grub_cfg}.new || true
 fi

Thanks

```

**Attachment:
[signature.asc](att-291/signature_asc.bin)**

*Description:* Digital signature

---

[![Previous](/images/left-icon-16x16.png)](290)
[By Date](date.html#291)
[![Next](/images/right-icon-16x16.png)](292)

[![Previous](/images/left-icon-16x16.png)](293)
[By Thread](index.html#291)
[![Next](/images/right-icon-16x16.png)](292)

### Current thread:

* **CVE Request: grub-mkconfig** *Seth Arnold (Nov 14)*
  + [Re: CVE Request: grub-mkconfig](292) *Kurt Seifried (Nov 14)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.openwall.com_27d60a9f_20250124_224737.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](../../../2024/01/16/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <36df55b7-dae7-4ea3-a986-92446a6441dc@gmail.com>
Date: Tue, 16 Jan 2024 01:52:16 +0300
From: Maxim Suhanov <dfirblog@...il.com>
To: oss-security@...ts.openwall.com
Subject: CVE-2023-4001: a password bypass vulnerability in the downstream GRUB
 boot manager

References:

<https://dfir.ru/2024/01/15/cve-2023-4001-a-vulnerability-in-the-downstream-grub-boot-manager/>
<https://access.redhat.com/security/cve/cve-2023-4001>

Plain-text details taken from the first reference:

One can set a password to protect the boot menu entries and the
command-line shell of the GRUB boot manager (see the official manual and
the Red Hat manual). This is an additional security measure to be used
along with a BIOS/UEFI password (e.g., to protect corporate computers
from unprivileged users trying to leverage their physical access to boot
another operating system or to escalate the privileges in an installed
operating system).

Under the hood, this feature is implemented as two GRUB commands:
“password” and “password_pbkdf2“. When one of these commands is issued
with a proper set of arguments, a user with a specified password (or its
hash) is created. And only those users listed in the “superusers”
environment variable (when it’s set by issuing the “set” command) are
allowed to edit boot menu entries and execute commands in the GRUB
shell. (A physically-present user is required to authenticate as a
superuser when trying to edit a menu entry or trying to enter the GRUB
shell.)

In most cases, commands to set the “superusers” variable and to create
corresponding users are stored in the GRUB configuration file,
“grub.cfg” (which is more like a script, not a pure configuration file).

There were some vulnerabilities affecting the GRUB password protection
feature, like weak permissions for the GRUB configuration file that
allowed unprivileged users to obtain plain-text passwords and/or
password hashes (for example: CVE-2012-2314, CVE-2013-4577, and
CVE-2021-3981), an integer underflow (CVE-2015-8370), and even an
improper string comparison (CVE-2009-4128).

Now, there is one more: CVE-2023-4001.

This vulnerability allows unprivileged users with physical access to a
computer to bypass the password protection feature of the GRUB boot
manager on many (but not all) UEFI-based computers. In some uncommon
setups, no unprivileged access is required (so, physical access without
an ability to log in into an operating system is enough).

In theory, commands required to properly enable the password protection
feature (i.e., to create a user and to set a list of superusers) of the
GRUB boot manager can be stored in two locations: in the configuration
file embedded in the GRUB image (which is an EFI executable) and in the
“external” configuration file (which is most likely named “grub.cfg“).

In the UEFI Secure Boot world, GRUB images are signed, so they can’t
contain anything other than a hard-coded (vendor-defined) password or
its hash (and, hopefully, there are none). So, the corresponding
commands have to be stored in the “external” configuration file, “grub.cfg“.

Originally, on BIOS-based systems, this configuration was stored as a
single file in the same directory with the GRUB files.

But on UEFI computers this configuration became split between two files:
the first one in the EFI System Partition volume
(“/boot/efi/EFI/<vendor>/grub.cfg“; it’s usually a FAT12/16/32 file
system) and the second one in the “/boot” volume (“/boot/grub/grub.cfg”
or “/boot/grub2/grub.cfg“; it’s usually a file system not supported by
the UEFI firmware: e.g., Ext2/4 or XFS). The latter will called “the
main configuration file” here.

A thorough explanation of this new scheme can be found here:
<https://fedoraproject.org/wiki/Changes/UnifyGrubConfig>.

When the GRUB password is set (e.g., using the “grub2-set-password”
tool), it’s written to the main configuration file. And the first
configuration file is just a simple script to locate and execute the
main configuration file (as shown on the screenshot below).

<screenshot>

A configuration file found in the EFI System Partition (CentOS Stream 9)

If the password-related commands were stored in the first configuration
file, there would be no issue described in this post. But they are
stored in the main configuration file, which is found and then executed
by the first configuration file.

What if the main configuration file isn’t found? The GRUB boot manager
will spawn its shell.

Interestingly, we can force the main configuration file to “disappear”
(at least on some systems) when the first configuration file is
executed. So, there would be no password prompt (because no
password-related commands are ever executed after the power-on event)
and the GRUB shell will be immediately available to a physically-present
user.

The UUID is the key! The main configuration file is located using a
predefined path: “<device>/grub2/grub.cfg” (as shown on the screenshot
above). Here, “<device>” is a volume found by its file system UUID using
the “search” command.

And duplicate file system UUIDs pose a security problem…

If there are two file systems sharing the same UUID, one of them is the
real “/boot” volume and another one is an empty volume, the GRUB boot
manager could, under some circumstances, pick a wrong device as
containing the main configuration file. And if there is no main
configuration file stored (that empty volume case), the GRUB shell is
spawned.

Internally, the “search” command tries every partition on every block
device until a specified signature (a file system UUID in this case, but
the command also supports searching by a volume label and by a file) is
found.

All block devices are tried in the same order as returned when
enumerating their EFI handles (“hd0”, “hd1”, “hd2” and so on, “hd0”
corresponds to the first EFI handle returned when enumerating EFI block
devices). Some UEFI implementations enumerate non-removable drives
before removable ones, while others do exactly the opposite (e.g., my
Lenovo laptop exposed this behavior; the UEFI implementation of
VirtualBox with USB3 support enabled enumerates USB sticks before
internal drives too).

So, if an attached removable drive (like a USB stick) becomes “hd0” in
the GRUB boot manager (and the computer’s internal drive is “hd1” in
that case), it’s possible to bypass the GRUB password protection feature
by placing an empty file system with the same UUID as the real “/boot”
volume onto that removable drive and attaching it to the computer before
the boot. During the boot, the GRUB boot manager will simply spawn its
shell, without even asking for a password (and without changing the boot
order, of course).

Unprivileged users can learn the UUID value of the “/boot” volume using
the “lsblk” tool (because file system UUIDs are exposed to unprivileged
users).

Here is a video demonstrating the attack:
<https://drive.google.com/file/d/1mMlEIgfnUKIgaOEBNmtWuRo7RUAqjDrT/view?usp=sharing>.

It should be noted that some Linux distributions provide enough debug
output in a separate console, so a necessary UUID can be obtained from
there (and no unprivileged access to the operating system is required in
this case).

Timeline

  2023-04-03: the vulnerability was discovered by me.
  2023-07-17: the vulnerability was reported by me to Red Hat.
  2023-10-17: an initial fix is available for testing.
  2023-10-18: an issue was discovered by me in that fix (an attacker
could bypass an additional check implemented by the patch by attaching
10 removable drives to the computer, if that number of removable drives
is supported by the firmware).
  2023-10-30: a new fix is available for testing.
  2023-10-31: two issues were discovered in that fix (one issue is a
“huge” heap overflow introduced when working with strings in the patched
code, another issue is a minor out-of-bounds write of a null byte).
  2023-10-31: a final fix is available.
  2023-11-23: the disclosure date is agreed upon — 2024-01-15.
  2024-01-12: the vulnerability is disclosed by Red Hat.
  2024-01-15: this post has arrived.

Fix

A fix proposed by Red Hat implements a new argument to the “search”
command, which restricts the UUID scan to the block device used to
launch the GRUB boot manager. This means that the “/boot” volume must
reside on the same drive as the EFI System Partition.

An alternative (but not implemented) approach would be to use something
that isn’t exposed to unprivileged users as a signature to locate the
“/boot” volume. This could be a file with a random name residing in a
directory with restricted permissions.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


