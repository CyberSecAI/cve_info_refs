- **Root cause of vulnerability**: The TinyMCE editor used in PrestaShop does not properly filter certain HTML events, allowing for the injection of malicious JavaScript code. Specifically, the `onmouseover` event is not blocked.
- **Weaknesses/vulnerabilities present**:
    - **Persistent XSS (Cross-Site Scripting):**  Malicious HTML, including JavaScript, can be injected via the TinyMCE editor and stored in the system (CMS page). This code will then execute when a user views the content, allowing for persistent attacks.
    - **CSRF (Cross-Site Request Forgery):** The logout action is performed using a GET request without token protection, making it susceptible to CSRF attacks.
- **Impact of exploitation**:
    - **Account takeover:** By injecting malicious code, an attacker could potentially spread malware or grab user credentials.
    - **Admin logout:**  The provided proof-of-concept demonstrates how an attacker can force an administrator to logout of the admin panel by simply hovering over a malicious image.
- **Attack vectors**:
    - **XSS:**  A low-level user (e.g., logistician, translator) with access to edit content using TinyMCE can inject malicious HTML code.
    - **CSRF:** An attacker could trick a logged-in user into executing a logout request by embedding a malicious link or image on a website they visit.
- **Required attacker capabilities/position:**
    - **XSS:** Requires a user with content editing privileges (e.g., logistician, translator).
    - **CSRF:** Requires the victim to be logged into the PrestaShop admin panel or user account and to visit a page controlled by the attacker (or where the attacker can inject malicious content).