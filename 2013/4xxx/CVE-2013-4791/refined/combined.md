=== Content from davidsopaslabs.blogspot.com_967694bd_20250125_062815.html ===


# [David Sopas - hacking web apps](http://davidsopaslabs.blogspot.com/)

## Monday, July 8, 2013

### Prestashop persistent XSS and CSRF vulnerability

Continuing to [test Prestashop security](http://labs.davidsopas.com/2012/11/prestashop-151-persistent-xss.html) I just found out a vulnerability on the latest version (and maybe prior versions).

Logistician, translators and other low level profiles/accounts could inject a persistent XSS vector on [TinyMCE](http://www.tinymce.com/) to affect users and even admins.

This is possible due to a flaw on TinyMCE which doesn't filter some events (blocks only a couple of them) on HTML.

Proof-of-concept on a combined CSRF attack (logged in as logistician):
> On a CMS page, enter the following HTML in TinyMCE (on HTML mode) <img onmouseover="window.location.href = 'http://www.website-example.pt/loja/admin9050/index.php?logout'" src="x" alt="" />

When the admin hover the image, he will automatically logout from the admin panel.

With a little imagination this issue can be used to spread malware or grab users credentials (popping up a screen to login) to visitors, authenticated users or even admins. (CVE-2013-4791)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiiCn4cgvU7VeOKiJ7ax0LyZR_ZbL5dpV43RRDiKJfjjLFMFAJWWxm70hDOyQd_zIYwsLZ4-rY0gVshSmSAKS3kvtzfLiMY5u0uIj3rhfiLjxVmCENKTMKrf0R13136TMKjwdVrYAuG-gKt/s320/step1.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiiCn4cgvU7VeOKiJ7ax0LyZR_ZbL5dpV43RRDiKJfjjLFMFAJWWxm70hDOyQd_zIYwsLZ4-rY0gVshSmSAKS3kvtzfLiMY5u0uIj3rhfiLjxVmCENKTMKrf0R13136TMKjwdVrYAuG-gKt/s1600/step1.jpg)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhlc_ePJST7UIykA-LnGIoqGk9c8R5PqMbd5Y7l5D58pnsjFA4oWF4vw6SsU1DF23wcOwFTdyvVq-eYPWifecQWBWngYKdMpxlv1W_ZKAfvtgw1aScMPpk-D69YlM6t3a-kyZraaf2kkdF3/s320/step2.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhlc_ePJST7UIykA-LnGIoqGk9c8R5PqMbd5Y7l5D58pnsjFA4oWF4vw6SsU1DF23wcOwFTdyvVq-eYPWifecQWBWngYKdMpxlv1W_ZKAfvtgw1aScMPpk-D69YlM6t3a-kyZraaf2kkdF3/s1600/step2.jpg)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiHjkEaVJhIFdW_mKF26XJMsWdV5K_YIb_RXZZawUiSBLBVz8-PdX8_dz3wAB1O2qDiVJCp1LPJDrJ1zKgJ6j9CTmerq9Pq2-K-6_axHWHfKcorPJH7ozYWq4dput7G19-8V3DhrSwyW9jB/s320/step3.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiHjkEaVJhIFdW_mKF26XJMsWdV5K_YIb_RXZZawUiSBLBVz8-PdX8_dz3wAB1O2qDiVJCp1LPJDrJ1zKgJ6j9CTmerq9Pq2-K-6_axHWHfKcorPJH7ozYWq4dput7G19-8V3DhrSwyW9jB/s1600/step3.jpg)

Also logout GET request should also have a token protection. Just to prevent CSRF attacks. (CVE-2013-4792)

Keep in mind that the latest version of TinyMCE it's patched against this issue.

By the way I tested under PrestaShop 1.5.4.1.

[Prestashop developing team](http://www.prestashop.com/) replied:
> We have fixed this problem in our 1.4.11 release, and we will also put this patch in our next 1.5 release before the end of July.

Timeline:

05 Jun 2013: Reported to Prestashop

11 Jun 2013: Replied that their team were working on it

02 Jul 2013: Prestashop released a fix to this issue

08 Jul 2013: Full disclosure

Posted by
David

at

[6:34 AM](http://davidsopaslabs.blogspot.com/2013/07/prestashop-persistent-xss-and-csrf.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=8069146616044966238&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8069146616044966238&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8069146616044966238&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8069146616044966238&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8069146616044966238&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8069146616044966238&target=pinterest "Share to Pinterest")

Labels:
[csrf](http://davidsopaslabs.blogspot.com/search/label/csrf),
[CVE-2013-4791](http://davidsopaslabs.blogspot.com/search/label/CVE-2013-4791),
[CVE-2013-4792](http://davidsopaslabs.blogspot.com/search/label/CVE-2013-4792),
[persistent xss](http://davidsopaslabs.blogspot.com/search/label/persistent%20xss),
[prestashop](http://davidsopaslabs.blogspot.com/search/label/prestashop),
[tinymce](http://davidsopaslabs.blogspot.com/search/label/tinymce)

#### 4 comments:

1. ![](//resources.blogblog.com/img/blank.gif)Anonymous[August 13, 2014 at 2:23 AM](http://davidsopaslabs.blogspot.com/2013/07/prestashop-persistent-xss-and-csrf.html?showComment=1407921803049#c2695006127071258058)

   Hi David,
   Thanks for sharing. I just wondering, according to your experience, which shopping cart is most secure? I'm not saying unbreakable, but which one is less hackable?
   Thanks,
   John

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=4083252652650482806&postID=2695006127071258058)Replies
   - ![](//www.blogger.com/img/blogger_logo_round_35.png)[David](https://www.blogger.com/profile/05034789163906615094)[August 13, 2014 at 2:33 AM](http://davidsopaslabs.blogspot.com/2013/07/prestashop-persistent-xss-and-csrf.html?showComment=1407922407753#c6159457655995709849)

     Hi John,

     Well it all depends on your needs. I like Prestashop. They really care about security. They've a good team and fast support.

     Shopify for example, they just discarted a few security issues I found. In my opinion that shows me that they don't care about clients security.

     Keep in mind that you must also secure your host and apply good security practises.

     Regards,
     David

     [Delete](https://www.blogger.com/delete-comment.g?blogID=4083252652650482806&postID=6159457655995709849)Replies
     Reply
   Reply
2. ![](//resources.blogblog.com/img/blank.gif)Anonymous[August 13, 2014 at 8:34 AM](http://davidsopaslabs.blogspot.com/2013/07/prestashop-persistent-xss-and-csrf.html?showComment=1407944088621#c2511829978499743838)

   Hi David,
   Thank you for your kindly. I am looking for a cart. There are some that I would like to try. But at this point, I just look at Prestashop and CS-Cart. Do you ever see the CS-Cart security hole? Sorry to ask you one more time.

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=4083252652650482806&postID=2511829978499743838)Replies
   - ![](//www.blogger.com/img/blogger_logo_round_35.png)[David](https://www.blogger.com/profile/05034789163906615094)[August 13, 2014 at 8:43 AM](http://davidsopaslabs.blogspot.com/2013/07/prestashop-persistent-xss-and-csrf.html?showComment=1407944593306#c4457532509182474034)

     I don't think I tested CS-Cart. Maybe in the future!
     Usually I test only what my clients use.

     [Delete](https://www.blogger.com/delete-comment.g?blogID=4083252652650482806&postID=4457532509182474034)Replies
     Reply
   Reply

Add commentLoad more...

[Newer Post](http://davidsopaslabs.blogspot.com/2013/07/dowjonescom-dom-xss.html "Newer Post")

[Older Post](http://davidsopaslabs.blogspot.com/2013/07/issuu-dom-xss.html "Older Post")

[Home](http://davidsopaslabs.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](http://davidsopaslabs.blogspot.com/feeds/8069146616044966238/comments/default)

## About me

My name is David Sopas. I'm a portuguese web security researcher.

## Donations

Some companies returned the favor by offering me the following:

## Labels

[dom xss](http://davidsopaslabs.blogspot.com/search/label/dom%20xss)

[xss](http://davidsopaslabs.blogspot.com/search/label/xss)

[antivirus](http://davidsopaslabs.blogspot.com/search/label/antivirus)

[csrf](http://davidsopaslabs.blogspot.com/search/label/csrf)

[google](http://davidsopaslabs.blogspot.com/search/label/google)

[persistent xss](http://davidsopaslabs.blogspot.com/search/label/persistent%20xss)

[malware](http://davidsopaslabs.blogspot.com/search/label/malware)

[prestashop](http://davidsopaslabs.blogspot.com/search/label/prestashop)

[ebay](http://davidsopaslabs.blogspot.com/search/label/ebay)

[google vulnerability reward program](http://davidsopaslabs.blogspot.com/search/label/google%20vulnerability%20reward%20program)

[jwplayer](http://davidsopaslabs.blogspot.com/search/label/jwplayer)

[self-xss](http://davidsopaslabs.blogspot.com/search/label/self-xss)

[CVE-2013-4791](http://davidsopaslabs.blogspot.com/search/label/CVE-2013-4791)

[CVE-2013-4792](http://davidsopaslabs.blogspot.com/search/label/CVE-2013-4792)

[CVE-2013-6295](http://davidsopaslabs.blogspot.com/search/label/CVE-2013-6295)

[CVE-2014-2916](http://davidsopaslabs.blogspot.com/search/label/CVE-2014-2916)

[ad\_iframe.html](http://davidsopaslabs.blogspot.com/search/label/ad_iframe.html)

[alexa](http://davidsopaslabs.blogspot.com/search/label/alexa)

[amazon](http://davidsopaslabs.blogspot.com/search/label/amazon)

[anythingslider](http://davidsopaslabs.blogspot.com/search/label/anythingslider)

[avg](http://davidsopaslabs.blogspot.com/search/label/avg)

[backdoors](http://davidsopaslabs.blogspot.com/search/label/backdoors)

[blogger](http://davidsopaslabs.blogspot.com/search/label/blogger)

[booking](http://davidsopaslabs.blogspot.com/search/label/booking)

[bounty](http://davidsopaslabs.blogspot.com/search/label/bounty)

[ccs](http://davidsopaslabs.blogspot.com/search/label/ccs)

[ckeditor](http://davidsopaslabs.blogspot.com/search/label/ckeditor)

[deadspin](http://davidsopaslabs.blogspot.com/search/label/deadspin)

[deface](http://davidsopaslabs.blogspot.com/search/label/deface)

[dod](http://davidsopaslabs.blogspot.com/search/label/dod)

[dow jones](http://davidsopaslabs.blogspot.com/search/label/dow%20jones)

[easter egg](http://davidsopaslabs.blogspot.com/search/label/easter%20egg)

[ensighten](http://davidsopaslabs.blogspot.com/search/label/ensighten)

[eset](http://davidsopaslabs.blogspot.com/search/label/eset)

[fbi](http://davidsopaslabs.blogspot.com/search/label/fbi)

[fckeditor](http://davidsopaslabs.blogspot.com/search/label/fckeditor)

[file upload](http://davidsopaslabs.blogspot.com/search/label/file%20upload)

[gawker](http://davidsopaslabs.blogspot.com/search/label/gawker)

[giftcards](http://davidsopaslabs.blogspot.com/search/label/giftcards)

[gizmodo](http://davidsopaslabs.blogspot.com/search/label/gizmodo)

[google analytics](http://davidsopaslabs.blogspot.com/search/label/google%20analytics)

[google bots](http://davidsopaslabs.blogspot.com/search/label/google%20bots)

[hacker](http://davidsopaslabs.blogspot.com/search/label/hacker)

[helpouts](http://davidsopaslabs.blogspot.com/search/label/helpouts)

[hootsuite](http://davidsopaslabs.blogspot.com/search/label/hootsuite)

[hp](http://davidsopaslabs.blogspot.com/search/label/hp)

[html5](http://davidsopaslabs.blogspot.com/search/label/html5)

[idg now](http://davidsopaslabs.blogspot.com/search/label/idg%20now)

[io9](http://davidsopaslabs.blogspot.com/search/label/io9)

[issuu](http://davidsopaslabs.blogspot.com/search/label/issuu)

[jalopnik](http://davidsopaslabs.blogspot.com/search/label/jalopnik)

[jezebel](http://davidsopaslabs.blogspot.com/search/label/jezebel)

[jobs.cz](http://davidsopaslabs.blogspot.com/search/label/jobs.cz)

[kaspersky](http://davidsopaslabs.blogspot.com/search/label/kaspersky)

[kernel](http://davidsopaslabs.blogspot.com/search/label/kernel)

[kotaku](http://davidsopaslabs.blogspot.com/search/label/kotaku)

[lifehacker](http://davidsopaslabs.blogspot.com/search/label/lifehacker)

[macosx](http://davidsopaslabs.blogspot.com/search/label/macosx)

[magento](http://davidsopaslabs.blogspot.com/search/label/magento)

[mashable](http://davidsopaslabs.blogspot.com/search/label/mashable)

[mcafee](http://davidsopaslabs.blogspot.com/search/label/mcafee)

[microsoft](http://davidsopaslabs.blogspot.com/search/label/microsoft)

[modules](http://davidsopaslabs.blogspot.com/search/label/modules)

[neal poole](http://davidsopaslabs.blogspot.com/search/label/neal%20poole)

[olx](http://davidsopaslabs.blogspot.com/search/label/olx)

[open redirect](http://davidsopaslabs.blogspot.com/search/label/open%20redirect)

[orkut](http://davidsopaslabs.blogspot.com/search/label/orkut)

[owasp-dv-004](http://davidsopaslabs.blogspot.com/search/label/owasp-dv-004)

[panda](http://davidsopaslabs.blogspot.com/search/label/panda)

[phishing](http://davidsopaslabs.blogspot.com/search/label/phishing)

[phpbb](http://davidsopaslabs.blogspot.com/search/label/phpbb)

[phplist](http://davidsopaslabs.blogspot.com/search/label/phplist)

[phpmyadmin](http://davidsopaslabs.blogspot.com/search/label/phpmyadmin)

[proxy](http://davidsopaslabs.blogspot.com/search/label/proxy)

[referrer](http://davidsopaslabs.blogspot.com/search/label/referrer)

[root](http://davidsopaslabs.blogspot.com/search/label/root)

[runkeeper](http://davidsopaslabs.blogspot.com/search/label/runkeeper)

[slow dos](http://davidsopaslabs.blogspot.com/search/label/slow%20dos)

[sql injection](http://davidsopaslabs.blogspot.com/search/label/sql%20injection)

[symantec](http://davidsopaslabs.blogspot.com/search/label/symantec)

[timing attacks](http://davidsopaslabs.blogspot.com/search/label/timing%20attacks)

[tinymce](http://davidsopaslabs.blogspot.com/search/label/tinymce)

[tor](http://davidsopaslabs.blogspot.com/search/label/tor)

[tshirt](http://davidsopaslabs.blogspot.com/search/label/tshirt)

[tumblr](http://davidsopaslabs.blogspot.com/search/label/tumblr)

[user-agent](http://davidsopaslabs.blogspot.com/search/label/user-agent)

[weekend reading](http://davidsopaslabs.blogspot.com/search/label/weekend%20reading)

[wordpress](http://davidsopaslabs.blogspot.com/search/label/wordpress)

[xss worm](http://davidsopaslabs.blogspot.com/search/label/xss%20worm)

[yahoo](http://davidsopaslabs.blogspot.com/search/label/yahoo)

## Blogroll

* [Egor Homakov](http://homakov.blogspot.com/)
* [Neal Poole](https://nealpoole.com/blog/)
* [Ben Hayak](http://www.benhayak.com/)
* [Nils Junemann](http://www.nilsjuenemann.de/)
* [Nir Goldshlager](http://www.nirgoldshlager.com/)

## Blog Archive

* ►
  [2014](http://davidsopaslabs.blogspot.com/2014/)
  (3)
  + ►
    [April](http://davidsopaslabs.blogspot.com/2014/04/)
    (1)
  + ►
    [March](http://davidsopaslabs.blogspot.com/2014/03/)
    (1)
  + ►
    [January](http://davidsopaslabs.blogspot.com/2014/01/)
    (1)

* ▼
  [2013](http://davidsopaslabs.blogspot.com/2013/)
  (27)
  + ►
    [November](http://davidsopaslabs.blogspot.com/2013/11/)
    (3)
  + ►
    [October](http://davidsopaslabs.blogspot.com/2013/10/)
    (2)
  + ►
    [September](http://davidsopaslabs.blogspot.com/2013/09/)
    (4)
  + ►
    [August](http://davidsopaslabs.blogspot.com/2013/08/)
    (2)
  + ▼
    [July](http://davidsopaslabs.blogspot.com/2013/07/)
    (3)
    - [Dowjones.com DOM XSS](http://davidsopaslabs.blogspot.com/2013/07/dowjonescom-dom-xss.html)
    - [Prestashop persistent XSS and CSRF vulnerability](http://davidsopaslabs.blogspot.com/2013/07/prestashop-persistent-xss-and-csrf.html)
    - [Issuu DOM XSS](http://davidsopaslabs.blogspot.com/2013/07/issuu-dom-xss.html)
  + ►
    [June](http://davidsopaslabs.blogspot.com/2013/06/)
    (2)
  + ►
    [April](http://davidsopaslabs.blogspot.com/2013/04/)
    (2)
  + ►
    [March](http://davidsopaslabs.blogspot.com/2013/03/)
    (2)
  + ►
    [February](http://davidsopaslabs.blogspot.com/2013/02/)
    (4)
  + ►
    [January](http://davidsopaslabs.blogspot.com/2013/01/)
    (3)

* ►
  [2012](http://davidsopaslabs.blogspot.com/2012/)
  (3)
  + ►
    [December](http://davidsopaslabs.blogspot.com/2012/12/)
    (1)
  + ►
    [November](http://davidsopaslabs.blogspot.com/2012/11/)
    (1)
  + ►
    [October](http://davidsopaslabs.blogspot.com/2012/10/)
    (1)

|  |  |
| --- | --- |

|  |  |
| --- | --- |

Simple theme. Powered by [Blogger](https://www.blogger.com).


