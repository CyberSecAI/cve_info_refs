```
{
  "cve": "CVE-2013-4535",
  "relevant_content": [
    {
      "source": "bugzilla.redhat.com_57b2cdeb_20250124_223120.html",
      "vulnerability": {
        "root_cause": "Insufficient validation of `num_sg` when mapping scatter/gather lists for virtio devices during migration or state loading.",
        "weaknesses": [
          "The `num_sg` value is taken directly from the savevm data or the wire during migration, and it is not properly validated.",
          "This allows writing to indices beyond `VIRTQUEUE_MAX_SIZE` in `virtqueue_map_sg()`."
        ],
        "impact": "Memory corruption in the QEMU process on the destination host, potentially leading to arbitrary code execution with the privileges of the QEMU process.",
        "attack_vectors": [
          "An attacker can modify savevm data on disk or over the wire during migration.",
             "The user needs to be able to alter the savevm data (either on the disk or over the wire during migration) to trigger this flaw."
        ],
         "required_attacker_capabilities": "Ability to modify the savevm data either on the disk or over the wire during migration."
      }
    },
      {
      "source": "lists.nongnu.org_da7a0c35_20250124_223118.html",
      "vulnerability": {
        "root_cause": "Improper validation of num_sg when mapping memory regions for virtio devices.",
         "weaknesses": [
           "The vulnerability is caused by a lack of validation of the `num_sg` value during virtio device configuration.",
            "This lack of validation allows for mapping of more memory than allocated, which can result in memory corruption"
         ],
        "impact": "Memory corruption during migration or state loading. This could lead to arbitrary code execution on the host.",
        "attack_vectors": [
          "Attacker can use a malformed savevm file during migration."
        ],
        "required_attacker_capabilities": "Attacker needs to control the savevm data."
      }
    },
    {
      "source": "rhn.redhat.com_db0e140f_20250124_223119.html",
      "vulnerability": {
       "root_cause": "The flaw exists due to insufficient validation of the 'num_sg' parameter in the virtio drivers of QEMU, specifically during state loading after migration.",
       "weaknesses": [
        "The 'num_sg' value which controls the scatter/gather mapping is taken from the savevm data without proper validation, allowing writing to indices beyond the allocated size",
        "Virtio drivers fail to check the validity of the 'num_sg' value when mapping buffers leading to an out-of-bounds write"
      ],
        "impact": "A user able to alter savevm data during migration could trigger memory corruption, potentially leading to arbitrary code execution.",
        "attack_vectors": [
          "An attacker alters the savevm data, which is used during migration or state loading.",
          "The attack involves modifying the savevm data either on disk or over the network, during migration, to set an invalid 'num_sg' value."
        ],
        "required_attacker_capabilities": "An attacker needs to be able to alter the savevm data."
      }
    },
        {
      "source": "rhn.redhat.com_5a940d4f_20250124_223118.html",
      "vulnerability": {
        "root_cause": "The vulnerability lies in how QEMU's virtio drivers handle state loading after migration, specifically with insufficient validation of the num_sg parameter.",
        "weaknesses": [
            "The num_sg value, taken directly from the savevm data, is not validated adequately.",
             "This results in the potential for writes to memory locations outside of the allocated buffer in the virtqueue_map_sg() function, causing memory corruption."
        ],
        "impact": "An attacker able to alter the savevm data during migration could exploit this flaw to corrupt QEMU process memory and potentially execute arbitrary code with QEMU's privileges.",
        "attack_vectors": [
            "The attack involves an attacker modifying savevm data during migration, either on disk or over the network.",
             "This allows control over the num_sg value."
        ],
           "required_attacker_capabilities": "The attacker must have the capability to alter the savevm data during migration."
      }
    }
  ],
  "unrelated_content": [
    "access.redhat.com_45eb4f8e_20250126_040855.html",
    "access.redhat.com_f7c72c13_20250126_040855.html",
    "www.redhat.com_c7092301_20250126_040905.html",
    "www.redhat.com_74b42869_20250126_040903.html",
    "www.redhat.com_2ba13d34_20250126_040903.html",
    "www.redhat.com_61c4dd1e_20250126_040905.html",
    "git.qemu.org_349d6ffb_20250124_223116.html",
    "www.redhat.com_ed5f5cb4_20250126_040905.html",
        "bugzilla.redhat.com_3ee7ff57_20250126_040904.html"
  ]
}
```