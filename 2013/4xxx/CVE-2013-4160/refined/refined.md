```
Message-ID: <20130718124055.GA26243@suse.de>
Date: Thu, 18 Jul 2013 14:40:55 +0200
From: Marcus Meissner <meissner@...e.de>
To: OSS Security List <oss-security@...ts.openwall.com>
Subject: CVE Request: OpenJDK and lcms2 2.5 release fixes various denial of
	service issues in lcms2

Hi,

The lcms2 2.4 -> 2.5 version upgrade fixes various crashes that could be used
by attackers to crash (NULL ptr deref) programs using lcms2, like e.g. OpenJDK 7

This was found in the embedded copy within OpenJDK7 first, then merged to lcms2.

<http://mail.openjdk.java.net/pipermail/distro-pkg-dev/2013-July/023895.html>

lcms2 related issues in there:
 * S8007925: Improve cmsStageAllocLabV2ToV4curves
 * S8007926: Improve cmsPipelineDup
 * S8007927: Improve cmsAllocProfileSequenceDescription
 * S8007929: Improve CurvesAlloc
 * S8009654: Improve stability of cmsnamed

All covered by lcms2 in this commit (I think):
<https://github.com/mm2/Little-CMS/commit/91c2db7f2559be504211b283bc3a2c631d6f06d9>

These probably can get just 1 CVE, although I do not know the OpenJDK IcedTea side
of the story.

<https://bugzilla.novell.com/show_bug.cgi?id=826097#c9> has the research into
more of these stability commits in lcms2 by my colleague Stanislav Brabec.
Not sure if they should get seperate CVEs or not.

Ciao, Marcus
```

```
Message-ID: <51ECECB4.4060200@redhat.com>
Date: Mon, 22 Jul 2013 02:26:28 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Marcus Meissner <meissner@...e.de>
Subject: Re: CVE Request: OpenJDK and lcms2 2.5 release fixes
 various denial of service issues in lcms2

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 07/18/2013 06:40 AM, Marcus Meissner wrote:
> Hi,
>
> The lcms2 2.4 -> 2.5 version upgrade fixes various crashes that
> could be used by attackers to crash (NULL ptr deref) programs using
> lcms2, like e.g. OpenJDK 7
>
> This was found in the embedded copy within OpenJDK7 first, then
> merged to lcms2.
>
> <http://mail.openjdk.java.net/pipermail/distro-pkg-dev/2013-July/023895.html>
>
>  lcms2 related issues in there: * S8007925: Improve
> cmsStageAllocLabV2ToV4curves * S8007926: Improve cmsPipelineDup *
> S8007927: Improve cmsAllocProfileSequenceDescription * S8007929:
> Improve CurvesAlloc * S8009654: Improve stability of cmsnamed
>
> All covered by lcms2 in this commit (I think):
> <https://github.com/mm2/Little-CMS/commit/91c2db7f2559be504211b283bc3a2c631d6f06d9>
>
>  These probably can get just 1 CVE, although I do not know the
> OpenJDK IcedTea side of the story.
>
> <https://bugzilla.novell.com/show_bug.cgi?id=826097#c9> has the
> research into more of these stability commits in lcms2 by my
> colleague Stanislav Brabec. Not sure if they should get seperate
> CVEs or not.
>
> Ciao, Marcus

Please use CVE-2013-4160 for this issue.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)

iQIcBAEBAgAGBQJR7Oy0AAoJEBYNRVNeJnmTI3UP/ilQRQCahbiqxisBhukMHQ2B
aV7tM+nHl5gA91hugA8uPn3HJ6NSRG1J2KDRCn066ZsRxHwy8WAerTM7xzq2sMyB
MPH5svDq+xcu4FlbdI+dz7/2DB0RBxsNZjQIr86GzdhucpTQeLch85rN8wrj/phu
P1O7/UpmF5iaq+SJJLqsWlzZLp3C2RD6o/SoNwh2J2AXdro5owpkgrK26+QBL0Bs
3vtpH9tWpe0qROLVV7Q18lco9G4XLbQufXLKRIDI+r76UfySOgR9qi4Pl6b6Jz76
5jWbUinbPXCBHX4icDedK+qjqUkt79ydpTqDhJX5lGaZfoKmTitGUhItoqstfyxp
Wx04wDYzIHHCsJSBNVTySmY/XJYKfGTK6mivSfsrDJbeAVbQ6qTFfDEaeUktWkA4
ivSxh/7LzqwKv+BOdIAOJgKwixEa8m4zv0zi8pslb0W9lkHLZJPy0iQr7FTytgh9
pXJ5hN3aFRiqKtrNIOD8dMaO+wP3SgM/QaIOAPLgHcK14tJxS23jdogPeKJFXAWi
c2KxYG8U5P/kHxnwu/VTtUYUHIO9g3meVhizRaNGZIkCnjxjjH9Q4kpGObLTn3+M
a9o13wPtU78ESyC3AaJmFSpcGJUIE2KmMiHqCdzfCZeKvNJPeaBY/ZJnOQubnH3b
MuqH4HxRmnfYgYPaUMmO
=8u9n
-----END PGP SIGNATURE-----
```

```
The IcedTea project provides a harness to build the source code from
OpenJDK using Free Software build tools, along with additional
features such as a PulseAudio sound driver and support for alternative
virtual machines.

This release updates our OpenJDK 7 support to include the latest
security updates. As mentioned in the notes for the 2.4.0 release,
we also continue to track the upcoming u40 release upstream and
this update synchronises IcedTea with 7u40 b31.

The security fixes are as follows:

...
 * S8007925: Improve cmsStageAllocLabV2ToV4curves
 * S8007926: Improve cmsPipelineDup
 * S8007927: Improve cmsAllocProfileSequenceDescription
 * S8007929: Improve CurvesAlloc
 * S8009654: Improve stability of cmsnamed
...

IcedTea includes the usual IcedTea patches to allow builds against
system libraries and to support more esoteric architectures. In these
releases, use of the system version of LCMS is disabled by default to
ensure the most secure version is used. Before using the system
version, please ensure it is version 2.5 or above, or it has the
S8007925, S8007926, S8007927, S8007929 and S8009654 updates listed
above.
```

```
commit 91c2db7
Non happy-path fixes
mm2 committed on Jun 25, 2013

...

Showing
3 changed files
with
18 additions
and
5 deletions.

* ChangeLog
* src
    * src/cmsnamed.c
    * src/cmsopt.c

```
```
# USN-1911-1: Little CMS vulnerability

29 July 2013

Little CMS could be made to crash if it opened a specially crafted file.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 13.04](/security/notices?release=raring)
* [Ubuntu 12.10](/security/notices?release=quantal)
* [Ubuntu 12.04](/security/notices?release=precise)

## Packages

* [lcms2](/security/cves?package=lcms2) - Little CMS 2 color management library

## Details

It was discovered that Little CMS did not properly verify certain memory

allocations. If a user or automated system using Little CMS were tricked

into opening a specially crafted file, an attacker could cause Little CMS

to crash.
```
- **Root cause of vulnerability**: Insufficient checks on memory allocations within Little CMS (lcms2). Specifically, several issues related to memory management were identified and fixed, which could lead to crashes.
- **Weaknesses/vulnerabilities present**:
  - NULL pointer dereference due to improper memory allocation handling.
  - Insufficient checks on allocated memory size, leading to potential buffer overflows.
  - Lack of validation of input data, leading to unexpected behavior.
- **Impact of exploitation**: An attacker could cause a denial-of-service (DoS) by crashing applications using the Little CMS library. This could be achieved by tricking a user or automated system into opening a specially crafted file.
- **Attack vectors**: Opening a specially crafted file designed to exploit the memory allocation vulnerabilities within Little CMS.
- **Required attacker capabilities/position**: An attacker needs the ability to provide a specially crafted file to be processed by a system using Little CMS. The user or automated system must then attempt to use Little CMS to open or process the malicious file.