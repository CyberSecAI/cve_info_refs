=== Content from github.com_f58e624e_20250126_094930.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitcoin%2Fbitcoin%2Fissues%2F2838)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitcoin%2Fbitcoin%2Fissues%2F2838)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=bitcoin%2Fbitcoin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bitcoin](/bitcoin)
/
**[bitcoin](/bitcoin/bitcoin)**
Public

* [Notifications](/login?return_to=%2Fbitcoin%2Fbitcoin) You must be signed in to change notification settings
* [Fork
  36.6k](/login?return_to=%2Fbitcoin%2Fbitcoin)
* [Star
   81.6k](/login?return_to=%2Fbitcoin%2Fbitcoin)

* [Code](/bitcoin/bitcoin)
* [Issues
  384](/bitcoin/bitcoin/issues)
* [Pull requests
  308](/bitcoin/bitcoin/pulls)
* [Actions](/bitcoin/bitcoin/actions)
* [Projects
  5](/bitcoin/bitcoin/projects)
* [Security](/bitcoin/bitcoin/security)
* [Insights](/bitcoin/bitcoin/pulse)

Additional navigation options

* [Code](/bitcoin/bitcoin)
* [Issues](/bitcoin/bitcoin/issues)
* [Pull requests](/bitcoin/bitcoin/pulls)
* [Actions](/bitcoin/bitcoin/actions)
* [Projects](/bitcoin/bitcoin/projects)
* [Security](/bitcoin/bitcoin/security)
* [Insights](/bitcoin/bitcoin/pulse)

# Timing leak in RPC authentication #2838

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Timing leak in RPC authentication](#top)#2838Copy linkLabels[Bug](https://github.com/bitcoin/bitcoin/issues?q=state%3Aopen%20label%3A%22Bug%22)[![@pakt](https://avatars.githubusercontent.com/u/873464?v=4&size=80)](/pakt)
## Description

[![@pakt](https://avatars.githubusercontent.com/u/873464?v=4&size=48)](/pakt)[pakt](https://github.com/pakt)opened [on Jul 20, 2013](https://github.com/bitcoin/bitcoin/issues/2838#issue-17005259)

`bitcoinrpc.cpp`

```
bool HTTPAuthorized(map<string, string>& mapHeaders)
{
    string strAuth = mapHeaders["authorization"];
    if (strAuth.substr(0,6) != "Basic ")
        return false;
    string strUserPass64 = strAuth.substr(6); boost::trim(strUserPass64);
    string strUserPass = DecodeBase64(strUserPass64);
    return strUserPass == strRPCUserColonPass;
}
```

Last string comparision `strUserPass == strRPCUserColonPass` gets compiled to:

```
    do
    {
      if ( !len )
        break;
      less = *(_BYTE *)strUserPass < *(_BYTE *)strRPCUserColonPass;
      eq = *(_BYTE *)strUserPass++ == *(_BYTE *)strRPCUserColonPass++;
      --len;
    }
    while ( eq );

```

which is a byte-by-byte compare. Attacker with precise clock (being in the same LAN, for example) might learn the RPC password letter by letter, by trying passwords like 'a...", "b...", "c..." and observing which took the longest time to verify.

This code in `bitcoinrpc.cpp`:

```
            if (mapArgs["-rpcpassword"].size() < 20)
                MilliSleep(250);
```

protects from bruteforce for short password. Unfortunately, when run, bitcoind suggest a 32 chars password. Paradoxically short passwords are safer to use than longer ones, wrt to the timing leak.

Here's an example of time independent array comparison: <http://rdist.root.org/2010/01/07/timing-independent-array-comparison/>

## Metadata

### Assignees

No one assigned

### Labels

[Bug](https://github.com/bitcoin/bitcoin/issues?q=state%3Aopen%20label%3A%22Bug%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from openwall.com_43d1f2e2_20250125_151732.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[<thread-prev]](../../../2013/07/24/7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <51F0E5DA.50009@redhat.com>
Date: Thu, 25 Jul 2013 02:46:18 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Paul <pawlkt@...il.com>
Subject: Re: CVE request: timing leak in bitcoind

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 07/24/2013 10:16 AM, Paul wrote:
> Low risk issue in RPC auth. code, described here:
> <https://github.com/bitcoin/bitcoin/issues/2838>

Please use CVE-2013-4165  for this issue.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)

iQIcBAEBAgAGBQJR8OXaAAoJEBYNRVNeJnmTZJwP/1WTYcAm9h91upY8dHoxq5UV
KFpeVtv/m1/3gHk12oCkieCFAp0D0MLw6KlqfGuwPpNM2GUAjuSoTgUD8i+aO7Zr
tmzkxl3qGAzZnGdhzMIh2UiuH5NUzaagVQpt1N56ivPs2VMH4QVYmjxLYXh2CeSf
T9rnDBFq37fJ7nfbQHHeAynMlYy/Uab/kis2ff0k2ryYqTuCkrC6rlTxm89dqN64
nRTyKwK5DCsobRQPykgcrPgOBwYdauE+8YVtxTvm96ihCBK2JJAyNhfXK2opQI2F
1cG1iLzmzsN0P0/X4OXfZzbiWZwrzckHmpTi1rrEN4zVDK9zp86y6b/ussrdDIUY
kLJxJ5i6Xdw29+QRWrVdKz2PVh+IYye2RZ8dhDYuzFKN8C12BK9sl00VMiuR0/pT
u1VA07h+jKB/rnnKS9IrxzLmHKTHqZ+znzPV3i2wOzLmYcFaPX8aKlMi2ybu3wAB
he58iQGS206aZm8uJkDXvedOOzYfCiX4qsraFryLGdJzSIp3UPiD7ZVea+sjXElS
rpgcxYC2HIujNGyC3zeUlykc5FCKxbRBESATTS94eYXlFWX4Z57cCBsIyK3kcCeS
0eGR1RtJNBZ7tj4MCuaSJQldLFdqFYV/qdNTWKb4BCFAm58+2u3zxgpexaiWL+6X
fsSMIhlQcP4NsRtZMhcs
=G2hb
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_4b401949_20250125_151736.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitcoin%2Fbitcoin%2Fpull%2F2845)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitcoin%2Fbitcoin%2Fpull%2F2845)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=bitcoin%2Fbitcoin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bitcoin](/bitcoin)
/
**[bitcoin](/bitcoin/bitcoin)**
Public

* [Notifications](/login?return_to=%2Fbitcoin%2Fbitcoin) You must be signed in to change notification settings
* [Fork
  36.6k](/login?return_to=%2Fbitcoin%2Fbitcoin)
* [Star
   81.6k](/login?return_to=%2Fbitcoin%2Fbitcoin)

* [Code](/bitcoin/bitcoin)
* [Issues
  382](/bitcoin/bitcoin/issues)
* [Pull requests
  307](/bitcoin/bitcoin/pulls)
* [Actions](/bitcoin/bitcoin/actions)
* [Projects
  5](/bitcoin/bitcoin/projects)
* [Security](/bitcoin/bitcoin/security)
* [Insights](/bitcoin/bitcoin/pulse)

Additional navigation options

* [Code](/bitcoin/bitcoin)
* [Issues](/bitcoin/bitcoin/issues)
* [Pull requests](/bitcoin/bitcoin/pulls)
* [Actions](/bitcoin/bitcoin/actions)
* [Projects](/bitcoin/bitcoin/projects)
* [Security](/bitcoin/bitcoin/security)
* [Insights](/bitcoin/bitcoin/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fbitcoin%2Fbitcoin%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fbitcoin%2Fbitcoin%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Mitigate Timing Attacks On Basic RPC Authorization #2845

 Closed

[grayleonard](/grayleonard)
wants to merge
3
commits into
[bitcoin:master](/bitcoin/bitcoin/tree/master "bitcoin/bitcoin:master")
from
[grayleonard:patch-1](/grayleonard/bitcoin/tree/patch-1 "grayleonard/bitcoin:patch-1")

 Closed

# [Mitigate Timing Attacks On Basic RPC Authorization](#top) #2845

[grayleonard](/grayleonard)
wants to merge
3
commits into
[bitcoin:master](/bitcoin/bitcoin/tree/master "bitcoin/bitcoin:master")
from
[grayleonard:patch-1](/grayleonard/bitcoin/tree/patch-1 "grayleonard/bitcoin:patch-1")

[Conversation
17](/bitcoin/bitcoin/pull/2845)
[Commits
3](/bitcoin/bitcoin/pull/2845/commits)
[Checks
0](/bitcoin/bitcoin/pull/2845/checks)
[Files changed](/bitcoin/bitcoin/pull/2845/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![grayleonard](https://avatars.githubusercontent.com/u/3433280?s=60&v=4)](/grayleonard)

Copy link

### @grayleonard **[grayleonard](/grayleonard)** commented [Jul 23, 2013](#issue-17078577)

As per [#2838](https://github.com/bitcoin/bitcoin/issues/2838) . Eliminates the possibility of timing attacks by changing the way the two passwords are compared.

It iterates through each char in the strings, and if the two chars it is comparing aren't the same, then it adds 1 to nReturn and the function, once it's done comparing all the chars, will return false. Previously, the function would return false on the first char that didn't match, allowing a possible attacker to run a timing attack.

See <http://rdist.root.org/2010/01/07/timing-independent-array-comparison/> for reference.

Sorry, something went wrong.

All reactions

[![@grayleonard](https://avatars.githubusercontent.com/u/3433280?s=40&v=4)](/grayleonard)

`[Mitigate Timing Attacks On Basic RPC Authorization](/bitcoin/bitcoin/pull/2845/commits/5d3228217c6d2159b2155ef1d17e9462e651c497 "Mitigate Timing Attacks On Basic RPC Authorization

As per #2838 . Eliminates the possibility of timing attacks by changing the way the two passwords are compared. See http://rdist.root.org/2010/01/07/timing-independent-array-comparison/ for reference.

It iterates through each char in the strings, and if the two chars it is comparing aren't the same, then it adds 1 to nReturn and the function returns false. Previously, the function would return false on the first char that didn't match, allowing a possible attacker to run a timing attack.")`
 …

`[5d32282](/bitcoin/bitcoin/pull/2845/commits/5d3228217c6d2159b2155ef1d17e9462e651c497)`

```
As per [bitcoin#2838](https://github.com/bitcoin/bitcoin/issues/2838) . Eliminates the possibility of timing attacks by changing the way the two passwords are compared. See <http://rdist.root.org/2010/01/07/timing-independent-array-comparison/> for reference.

It iterates through each char in the strings, and if the two chars it is comparing aren't the same, then it adds 1 to nReturn and the function returns false. Previously, the function would return false on the first char that didn't match, allowing a possible attacker to run a timing attack.
```

[![@gmaxwell](https://avatars.githubusercontent.com/u/858454?s=80&u=63e5c438c242094837a9deeda775d77988b508bf&v=4)](/gmaxwell)

Copy link

Contributor

### **[gmaxwell](/gmaxwell)** commented [Jul 23, 2013](#issuecomment-21386657)

| Can you also make the short password delay into an unconditional delay on failure?  Your current code timing-leaks the length, but I don't know if I care. You could avoid this by only comparing the input number of characters every single time, with a min() on the offset (take care to avoid a fence post error) on the actual password. Then compare the lengths. |
| --- |

All reactions

Sorry, something went wrong.

[![@grayleonard](https://avatars.githubusercontent.com/u/3433280?s=40&u=b119a5d06f1811bacfde9eb05c7ae9a6e3536570&v=4)](/grayleonard)
[grayleonard](/grayleonard)
closed this
[Jul 23, 2013](#event-57593904)

[![@grayleonard](https://avatars.githubusercontent.com/u/3433280?s=40&u=b119a5d06f1811bacfde9eb05c7ae9a6e3536570&v=4)](/grayleonard)
[grayleonard](/grayleonard)
reopened this
[Jul 23, 2013](#event-57593971)

[![@grayleonard](https://avatars.githubusercontent.com/u/3433280?s=80&u=b119a5d06f1811bacfde9eb05c7ae9a6e3536570&v=4)](/grayleonard)

Copy link

Author

### **[grayleonard](/grayleonard)** commented [Jul 23, 2013](#issuecomment-21387068)

| Woops, didn't mean to close it. And I was thinking along the same lines, but with something a little simpler. If the lengths don't match, you can just compare the actual password with itself (to get the timing right), but add 1 to nReturn also so it returns false. |
| --- |

All reactions

Sorry, something went wrong.

[![@gmaxwell](https://avatars.githubusercontent.com/u/858454?s=80&u=63e5c438c242094837a9deeda775d77988b508bf&v=4)](/gmaxwell)

Copy link

Contributor

### **[gmaxwell](/gmaxwell)** commented [Jul 23, 2013](#issuecomment-21387134)

| The only reservation I have with that is that, depending on how you write it, it is code that the optimizer is very likely to optimize out. E.g. if it were if(len1==len2){} else {selfcompare} that will quite probably get optimized. |
| --- |

All reactions

Sorry, something went wrong.

![sipa](https://avatars.githubusercontent.com/u/548488?s=60&v=4)

 **[sipa](/sipa)**
reviewed
[Jul 23, 2013](#discussion-diff-5335327)
 [View reviewed changes](/bitcoin/bitcoin/pull/2845/files/5d3228217c6d2159b2155ef1d17e9462e651c497#diff-47b5a4d3a943832323440dffa54ab3b97c47167677de07d7461f990cd435f2d0)

[src/bitcoinrpc.cpp](/bitcoin/bitcoin/pull/2845/files#diff-47b5a4d3a943832323440dffa54ab3b97c47167677de07d7461f990cd435f2d0)

|  |  | return strUserPass == strRPCUserColonPass; |
| --- | --- | --- |
|  |  |  |
|  |  | //Begin constant-time comparison |
|  |  | if (strUserPass.length() != strRPCUserColonPass.length()) |

Copy link

Member

### @sipa **[sipa](/sipa)** [Jul 23, 2013](#discussion_r5335327)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

This means (theoretically) exposing the password length. If you go as far as making the comparison constant-time, maybe go all the way? Something like comparing x.at(i % x.size) ^ y.at(i % y.size). (not a perfect solution, as it will match in case one is a repetition of the other).

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @gmaxwell **[gmaxwell](/gmaxwell)** [Jul 23, 2013](#discussion_r5335369)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

The % test (I would have just min()) is fine if you just add a |= len==len at the end.

Sorry, something went wrong.

All reactions

[![@grayleonard](https://avatars.githubusercontent.com/u/3433280?s=40&v=4)](/grayleonard)

`[Updated pull](/bitcoin/bitcoin/pull/2845/commits/bd8420dda743c36940d3986fb7e81a2f195495f8 "Updated pull

Fix to the timing-leak for the length of the password.")`
 …

`[bd8420d](/bitcoin/bitcoin/pull/2845/commits/bd8420dda743c36940d3986fb7e81a2f195495f8)`

```
Fix to the timing-leak for the length of the password.
```

[![@grayleonard](https://avatars.githubusercontent.com/u/3433280?s=80&u=b119a5d06f1811bacfde9eb05c7ae9a6e3536570&v=4)](/grayleonard)

Copy link

Author

### **[grayleonard](/grayleonard)** commented [Jul 23, 2013](#issuecomment-21387464)

| I updated it to fix the length-leaking, seems like the simplest way to do it. |
| --- |

All reactions

Sorry, something went wrong.

[![@gmaxwell](https://avatars.githubusercontent.com/u/858454?s=80&u=63e5c438c242094837a9deeda775d77988b508bf&v=4)](/gmaxwell)

Copy link

Contributor

### **[gmaxwell](/gmaxwell)** commented [Jul 23, 2013](#issuecomment-21389160)

| [@grayleonard](https://github.com/grayleonard) The extra loop with the "return ++nResult == 0;" is ... a little perplexing. The % that sipa proposed (or the min) should actually result in simpler looking code. Just move the length check to the end, and use the % to make sure that both only access valid indexes. Care to give it a shot? |
| --- |

All reactions

Sorry, something went wrong.

[![@theuni](https://avatars.githubusercontent.com/u/417043?s=80&v=4)](/theuni)

Copy link

Member

### **[theuni](/theuni)** commented [Jul 23, 2013](#issuecomment-21389330)

| There's no telling what compilers will do to this. If you're that concerned about timing attacks, why not just do something like this pseudocode?  ``` const minwait = 50; //msec timeBefore = GetCurrentTime(); result = val1 == val2; sleep(minwait - (GetCurrentTime() - timeBefore)); return result;  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@BitcoinPullTester](https://avatars.githubusercontent.com/u/2110907?s=80&v=4)](/BitcoinPullTester)

Copy link

### **[BitcoinPullTester](/BitcoinPullTester)** commented [Jul 23, 2013](#issuecomment-21389344)

| Automatic sanity-testing: PASSED, see <http://jenkins.bluematt.me/pull-tester/bd8420dda743c36940d3986fb7e81a2f195495f8> for binaries and test log. This test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly. If you are waiting on a test, please check timestamps to verify that the test.log is moving at <http://jenkins.bluematt.me/pull-tester/current/> Contact BlueMatt on freenode if something looks broken. |
| --- |

All reactions

Sorry, something went wrong.

[![@gmaxwell](https://avatars.githubusercontent.com/u/858454?s=80&u=63e5c438c242094837a9deeda775d77988b508bf&v=4)](/gmaxwell)

Copy link

Contributor

### **[gmaxwell](/gmaxwell)** commented [Jul 23, 2013](#issuecomment-21389421)

| Jeff argues that we should probably just drop basic auth entirely and require digest auth, which would solve this as a side effect. |
| --- |

All reactions

Sorry, something went wrong.

[![@gmaxwell](https://avatars.githubusercontent.com/u/858454?s=80&u=63e5c438c242094837a9deeda775d77988b508bf&v=4)](/gmaxwell)

Copy link

Contributor

### **[gmaxwell](/gmaxwell)** commented [Jul 23, 2013](#issuecomment-21389784)

| [@theuni](https://github.com/theuni) we're deep in pedantry land, but expecting very high accuracy sleeps results in sadness. It's perfectly possible to leak data through a sleep like that. |
| --- |

All reactions

Sorry, something went wrong.

[![@theuni](https://avatars.githubusercontent.com/u/417043?s=80&v=4)](/theuni)

Copy link

Member

### **[theuni](/theuni)** commented [Jul 23, 2013](#issuecomment-21389930)

| [@gmaxwell](https://github.com/gmaxwell) fair point on pedantry, but if you're on a system with <50msec sleep precision, i'd guess you'd have bigger concerns. In this case, it'd likely even spoil the very attack the evildoer is attempting. |
| --- |

All reactions

Sorry, something went wrong.

[![@jgarzik](https://avatars.githubusercontent.com/u/494411?s=80&u=14809aa2254dccbb15c654c1f4b857dc224f0011&v=4)](/jgarzik)

Copy link

Contributor

### **[jgarzik](/jgarzik)** commented [Jul 23, 2013](#issuecomment-21390005)

| Also -1 on convoluted schemes that the compiler might try to micro-optimize, or might impact the authentication result.  Heck, even unconditionally sleeping for a random interval would be better. Remove the 'if' check on password size.  But yes, approaching 1.0 it is reasonable just to require Digest auth. |
| --- |

All reactions

Sorry, something went wrong.

[![@grayleonard](https://avatars.githubusercontent.com/u/3433280?s=80&u=b119a5d06f1811bacfde9eb05c7ae9a6e3536570&v=4)](/grayleonard)

Copy link

Author

### **[grayleonard](/grayleonard)** commented [Jul 23, 2013](#issuecomment-21394416)

| [@theuni](https://github.com/theuni) From what I've read it seems like there are two ways to mitigate timing attacks - one can hold all responses with a constant delay, say 50ms. The other returns faster, I've seen ~10ms in this instance from tests I've run, with a constant-time comparison algorithm. Either one works.  I'm not sure how soon 1.0 is going to be available, but if we are treating this as a vulnerability instead of a bug it's important we get it out as soon as possible, regardless of the technique we use. |
| --- |

All reactions

Sorry, something went wrong.

[![@grayleonard](https://avatars.githubusercontent.com/u/3433280?s=40&v=4)](/grayleonard)

`[(Hopefully) the last update to this pull request](/bitcoin/bitcoin/pull/2845/commits/351229cfc0d0f6c54af8e4d7ac7426c16e776fb1 "(Hopefully) the last update to this pull request

Simplified time-leaking solution, using min() to make sure only valid indexes are called.")`
 …

`[351229c](/bitcoin/bitcoin/pull/2845/commits/351229cfc0d0f6c54af8e4d7ac7426c16e776fb1)`

```
Simplified time-leaking solution, using min() to make sure only valid indexes are called.
```

[![@BitcoinPullTester](https://avatars.githubusercontent.com/u/2110907?s=80&v=4)](/BitcoinPullTester)

Copy link

### **[BitcoinPullTester](/BitcoinPullTester)** commented [Jul 23, 2013](#issuecomment-21421606)

| Automatic sanity-testing: PASSED, see <http://jenkins.bluematt.me/pull-tester/351229cfc0d0f6c54af8e4d7ac7426c16e776fb1> for binaries and test log. This test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly. If you are waiting on a test, please check timestamps to verify that the test.log is moving at <http://jenkins.bluematt.me/pull-tester/current/> Contact BlueMatt on freenode if something looks broken. |
| --- |

All reactions

Sorry, something went wrong.

![gavinandresen](https://avatars.githubusercontent.com/u/331997?s=60&v=4)

 **[gavinandresen](/gavinandresen)**
reviewed
[Aug 5, 2013](#discussion-diff-5574831)
 [View reviewed changes](/bitcoin/bitcoin/pull/2845/files/351229cfc0d0f6c54af8e4d7ac7426c16e776fb1#diff-47b5a4d3a943832323440dffa54ab3b97c47167677de07d7461f990cd435f2d0)

[src/bitcoinrpc.cpp](/bitcoin/bitcoin/pull/2845/files#diff-47b5a4d3a943832323440dffa54ab3b97c47167677de07d7461f990cd435f2d0)

|  |  | return strUserPass == strRPCUserColonPass; |
| --- | --- | --- |
|  |  |  |
|  |  | //Begin constant-time comparison |
|  |  | //XOR chars in each password together, and then adds either 0 or 1 (0 if they match) to nResult |

Copy link

Contributor

### @gavinandresen **[gavinandresen](/gavinandresen)** [Aug 5, 2013](#discussion_r5574831)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

comment incorrect now? Adds 1 if they do not match, does not add 0 if they do.

Maybe:

nResult += (length == length ? 1 : 2)

... and

return nResult == 1;

... to get really-and-truly-ought-to-be-constant-time...

Also, commits need to be squashed into one.

Also style nitpick, space after for/if: for (size\_t ...) and if (strUser...)

Sorry, something went wrong.

All reactions

[![@sipa](https://avatars.githubusercontent.com/u/548488?s=80&u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4)](/sipa)

Copy link

Member

### **[sipa](/sipa)** commented [Aug 15, 2013](#issuecomment-22734102)

| Superceded by [#2886](https://github.com/bitcoin/bitcoin/pull/2886) |
| --- |

All reactions

Sorry, something went wrong.

[![@sipa](https://avatars.githubusercontent.com/u/548488?s=40&u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4)](/sipa)
[sipa](/sipa)
closed this
[Aug 15, 2013](#event-61079745)

[IntegralTeam](/IntegralTeam)
pushed a commit
to IntegralTeam/bitcoin
that referenced
this pull request
[Jun 4, 2019](#ref-commit-1ba8694)
[![@UdjinM6](https://avatars.githubusercontent.com/u/1935069?s=40&u=fb809c025b01317af0f295e0743b9a51e6faa327&v=4)](/UdjinM6)

`[Various fixes for RemoveInvalidVotes() (](/IntegralTeam/bitcoin/commit/1ba8694cd748ee4f4cef15aec6c5503b95647eae "Various fixes for RemoveInvalidVotes() (#2845)

* Fix crash in RemoveInvalidVotes()

Caused by lock not being held while accessing lastMNListForVotingKeys when RemoveInvalidVotes() is called from DoMaintenance() and UpdatedBlockTip() at the same time.

* No need to call RemoveInvalidVotes() from DoMaintenance()

MN list only changes on new blocks and we already call RemoveInvalidVotes() from UpdatedBlockTip()

* No need to call RemoveInvalidVotes() until we are fully synced")[bitcoin#2845](https://github.com/bitcoin/bitcoin/pull/2845)[)](/IntegralTeam/bitcoin/commit/1ba8694cd748ee4f4cef15aec6c5503b95647eae "Various fixes for RemoveInvalidVotes() (#2845)

* Fix crash in RemoveInvalidVotes()

Caused by lock not being held while accessing lastMNListForVotingKeys when RemoveInvalidVotes() is called from DoMaintenance() and UpdatedBlockTip() at the same time.

* No need to call RemoveInvalidVotes() from DoMaintenance()

MN list only changes on new blocks and we already call RemoveInvalidVotes() from UpdatedBlockTip()

* No need to call RemoveInvalidVotes() until we are fully synced")`
…

`[1ba8694](/IntegralTeam/bitcoin/commit/1ba8694cd748ee4f4cef15aec6c5503b95647eae)`

```
* Fix crash in RemoveInvalidVotes()

Caused by lock not being held while accessing lastMNListForVotingKeys when RemoveInvalidVotes() is called from DoMaintenance() and UpdatedBlockTip() at the same time.

* No need to call RemoveInvalidVotes() from DoMaintenance()

MN list only changes on new blocks and we already call RemoveInvalidVotes() from UpdatedBlockTip()

* No need to call RemoveInvalidVotes() until we are fully synced
```

[![@bitcoin](https://avatars.githubusercontent.com/u/528860?s=40&v=4)](/bitcoin)
[bitcoin](/bitcoin)
locked as **resolved** and limited conversation to collaborators
[Sep 8, 2021](#event-5271349306)

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitcoin%2Fbitcoin%2Fpull%2F2845).

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

7 participants

[![@grayleonard](https://avatars.githubusercontent.com/u/3433280?s=52&v=4)](/grayleonard) [![@gmaxwell](https://avatars.githubusercontent.com/u/858454?s=52&v=4)](/gmaxwell) [![@theuni](https://avatars.githubusercontent.com/u/417043?s=52&v=4)](/theuni) [![@BitcoinPullTester](https://avatars.githubusercontent.com/u/2110907?s=52&v=4)](/BitcoinPullTester) [![@jgarzik](https://avatars.githubusercontent.com/u/494411?s=52&v=4)](/jgarzik) [![@sipa](https://avatars.githubusercontent.com/u/548488?s=52&v=4)](/sipa) [![@gavinandresen](https://avatars.githubusercontent.com/u/331997?s=52&v=4)](/gavinandresen)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


