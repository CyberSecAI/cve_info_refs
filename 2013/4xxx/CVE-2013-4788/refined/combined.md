=== Content from seclists.org_792bea3e_20250125_003436.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](17)
[By Date](date.html#23)
[![Next](/images/right-icon-16x16.png)](24)

[![Previous](/images/left-icon-16x16.png)](17)
[By Thread](index.html#23)
[![Next](/images/right-icon-16x16.png)](24)

![](/shared/images/nst-icons.svg#search)

# Glibc Pointer guarding weakness

---

*From*: Hector Marco-Gisbert <hecmargi () upv es>

*Date*: Sat, 5 Sep 2015 18:49:15 +0200

---

```

Hello,

```
A weakness in the dynamic loader have been found, Glibc prior to 2.22.90
are affected. The issue is that the LD\_POINTER\_GUARD in the environment
is not sanitized allowing local attackers easily to bypass the pointer
guarding protection on set-user-ID and set-group-ID programs.
```

Details and PoC at:
<http://hmarco.org/bugs/glibc_ptr_mangle_weakness.html>

```
A patch is already sent to Glibc maintainers. This issue is similar to
<http://hmarco.org/bugs/CVE-2013-4788.html> but now affect to dynamic
linked applications.
```

--
Hector Marco-Gisbert @ <http://hmarco.org/>
Cyber Security Researcher @ <http://cybersecurity.upv.es>
Universitat Politècnica de València (Spain)

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](17)
[By Date](date.html#23)
[![Next](/images/right-icon-16x16.png)](24)

[![Previous](/images/left-icon-16x16.png)](17)
[By Thread](index.html#23)
[![Next](/images/right-icon-16x16.png)](24)

### Current thread:

* **Glibc Pointer guarding weakness** *Hector Marco-Gisbert (Sep 07)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.mandriva.com_83e9d117_20250125_003440.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from www.mandriva.com_7f4d7d3c_20250125_003438.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from security.gentoo.org_d2926965_20250125_003441.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# GNU C Library: Multiple vulnerabilities — GLSA **201503-04**

Multiple vulnerabilities have been found in GNU C Library, the
worst of which allowing a local attacker to execute arbitrary code or cause
a Denial of Service .

### Affected packages

| Package | **sys-libs/glibc** on all architectures |
| --- | --- |
| Affected versions | < **2.19-r1** |
| Unaffected versions | >= **2.19-r1** |

### Background

The GNU C library is the standard C library used by Gentoo Linux
systems.

### Description

Multiple vulnerabilities have been discovered in the GNU C Library.
Please review the CVE identifiers referenced below for details.

### Impact

A local attacker may be able to execute arbitrary code or cause a Denial
of Service condition,.

### Workaround

There is no known workaround at this time.

### Resolution

All glibc users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=sys-libs/glibc-2.19-r1"

```
### References

* [CVE-2012-3404](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2012-3404)
* [CVE-2012-3405](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2012-3405)
* [CVE-2012-3406](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2012-3406)
* [CVE-2012-3480](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2012-3480)
* [CVE-2012-4412](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2012-4412)
* [CVE-2012-4424](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2012-4424)
* [CVE-2012-6656](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2012-6656)
* [CVE-2013-0242](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-0242)
* [CVE-2013-1914](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-1914)
* [CVE-2013-2207](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-2207)
* [CVE-2013-4237](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-4237)
* [CVE-2013-4332](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-4332)
* [CVE-2013-4458](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-4458)
* [CVE-2013-4788](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-4788)
* [CVE-2014-4043](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-4043)
* [CVE-2015-0235](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-0235)

**Release date**

March 08, 2015

**Latest revision**

March 08, 2015: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [431218](https://bugs.gentoo.org/show_bug.cgi?id=431218)
* [434408](https://bugs.gentoo.org/show_bug.cgi?id=434408)
* [454862](https://bugs.gentoo.org/show_bug.cgi?id=454862)
* [464634](https://bugs.gentoo.org/show_bug.cgi?id=464634)
* [477330](https://bugs.gentoo.org/show_bug.cgi?id=477330)
* [480734](https://bugs.gentoo.org/show_bug.cgi?id=480734)
* [484646](https://bugs.gentoo.org/show_bug.cgi?id=484646)
* [488084](https://bugs.gentoo.org/show_bug.cgi?id=488084)
* [489234](https://bugs.gentoo.org/show_bug.cgi?id=489234)
* [501196](https://bugs.gentoo.org/show_bug.cgi?id=501196)
* [513090](https://bugs.gentoo.org/show_bug.cgi?id=513090)
* [521930](https://bugs.gentoo.org/show_bug.cgi?id=521930)
* [537990](https://bugs.gentoo.org/show_bug.cgi?id=537990)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from hmarco.org_77a63207_20250125_003434.html ===

# CVE-2013-4788 - Eglibc PTR MANGLE vulnerability ---

| Authors: | [Hector Marco](http://hmarco.org) & [Ismael Ripoll](http://personales.upv.es/~iripoll/) |
| --- | --- |
| CVE: | CVE-2013-4788 |
| Dates: | March 2013 - Discovered the vulnerability |

## Description

This vulnerability was discovered in March 2013 while we were developing the RAF SSP technique.
The glibc vulnerability makes it easy to take advantage of common errors such as buffer overflows
allows in these cases redirect the execution flow and potentially execute arbitrary
code.
## Impact

All statically linked applications compiled with glibc and eglibc are affected,
independent of the operating system distribution. Note that this problem is not solved by
only patching the eglibc, but it is also necessary to recompile all static executables.

As far I know there are a lot of routers, embedded systems etc., which use static linked
applications. Since the vulnerability is from the beginning of the PTR\_MANGLE implementations
(years 2005-2006) there are a ton of vulnerable devices.
## Vulnerable packages

The vulnerability has been propagated to all the static code compiled with all versions, on all
architectures, of glibc from 2.4 (06-Mar-2006) to 2.17 (Current version).
## Vulnerability

The vulnerability is caused due to the non initialization to a random value (it is
always zero) of the "pointer guard" by the glibc only when generating static compiled
executables. Dynamic executables are not affected.
Pointer guard is used to mangle the content of sensible pointers (longjmp, signal
handlers, etc.), if the pointer guard value is zero (non-initialized) then it is not
effective.

An example:

Library functions like "setjmp()" or "longjmp()" use PTR\_MANGLE and
PTR\_DEMANGLE. These macros are used to protect structures like jmp\_buf. Basically
consist on XOR-ing the pointer value with a random 32/64-bit value. Since the
pointer guard (random value) is 0x0 the attacker can easily calculate off-line the
value of a target address. By overwriting the "env" structure with the pre-computed
address the vulnerability is triggered when longjmp() is called and the execution
flow is redirected to attacker address.

## Exploit

The vulnerability was tested with Debian 7.1 and Ubunu 12.04 LTS and 13.04).
I already created a proof of concept to exploit this vulnerability for
32 and 64 bits x86 architectures as well as ARM.

The proof of concept  [poc-bug-mangle.c](../cyber-security/exploits/poc-bug-mangle.c) redirect the execution flow to a
function which prompt a shell. This exploit can be compiled for i386,
x86\_64 and ARM architectures. More architectures can be added easily by adding the
correspondent defines.

Compilation for i386:
```
$ gcc poc-bug-mangle.c -o poc-bug-mangle -static
```
Compilation for x86\_64:
```
$ gcc poc-bug-mangle.c -o poc-bug-mangle_32 -static -m32
$ gcc poc-bug-mangle.c -o poc-bug-mangle_64 -static -m64
```
Execution output:
```
$ ./poc-bug-mangle_32
[+] Exploiting ...
[+] hacked !!
$
```
Compilation for ARM on x86:
```
$ arm-linux-gnueabi-gcc poc-bug-mangle.c -o poc-bug-mangle_arm -static
```
Execution output on non-native ARM:
```
$ qemu-arm ./poc-bug-mangle_arm
[+] Exploiting ...
[+] hacked !!
$

```
**Note: Pointer mangling is not yet supported on ARM for eglibc <= 2.17**
## FIX

Note that the bug can not be fixed only by patching the eglibc. It is necessary
to recompile all static executables. I have created a non official patch for eglibc-2.17.

Patch for eglibc 2.17:
```
diff -rupN glibc-2.17/csu/libc-start.c glibc-2.17-mangle-fix/csu/libc-start.c
--- glibc-2.17/csu/libc-start.c 2012-12-25 04:02:13.000000000 +0100
+++ glibc-2.17-mangle-fix/csu/libc-start.c      2013-07-10 00:13:48.000000000 +0200
@@ -38,6 +38,12 @@ extern void __pthread_initialize_minimal
    in thread local area.  */
 uintptr_t __stack_chk_guard attribute_relro;
 # endif
+
+# ifndef  THREAD_SET_POINTER_GUARD
+uintptr_t __pointer_chk_guard_local
+     attribute_relro attribute_hidden __attribute__ ((nocommon));
+# endif
+
 #endif

 #ifdef HAVE_PTR_NTHREADS
@@ -184,6 +190,14 @@ LIBC_START_MAIN (int (*main) (int, char
 # else
   __stack_chk_guard = stack_chk_guard;
 # endif
+    uintptr_t pointer_chk_guard = _dl_setup_pointer_guard (_dl_random,
+                          stack_chk_guard);
+# ifdef THREAD_SET_POINTER_GUARD
+      THREAD_SET_POINTER_GUARD (pointer_chk_guard);
+# else
+      __pointer_chk_guard_local = pointer_chk_guard;
+# endif
+
 #endif

   /* Register the destructor of the dynamic linker if there is any.  */

```
[[ ptr\_mangle-eglibc-2.17.patch ]](patches/ptr_mangle-eglibc-2.17.patch)

Patching eglibc-2.17:
```

$ wget http://hmarco.org/bugs/patches/ptr_mangle-eglibc-2.17.patch
$ cd glibc-2.17
$ patch -p1 < ../ptr_mangle-eglibc-2.17.patch

```
## Discussion

Although this vulnerability is not exploitable by itself, the truth is that the PTR
Mangle encryption is useless. The goal of the protection technique is
not achieved.

This can be seen as the canary stack is set to 0x0, although is not exploitable
by itself is clearly an issue. What about whether the canary has been set to
zero from 2006 to today ? This is what happened with the pointers protected
with this mechanism.

According to [Ulrich Drepper](http://udrepper.livejournal.com/13393.html)
to use "encryption pointers (instead of canaries) to protect structures
like jmp\_buf is at least as secure and in addition faster". Following the
above and since the protection mechanism is useless from the first implementation,
the number of potentially affected systems could be huge.

---

Hector Marco - <http://hmarco.org>



=== Content from www.openwall.com_dbe17b25_20250125_003440.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](8) [[next>]](10) [[<thread-prev]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <51E47470.1050806@upv.es>
Date: Tue, 16 Jul 2013 00:15:12 +0200
From: Hector Marco <hecmargi@....es>
To: bugtraq@...urityfocus.com, full-disclosure@...ts.grok.org.uk,
        oss-security@...ts.openwall.com
Subject: Re: CVE-2013-4788 - Eglibc PTR MANGLE bug

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Due to I signed the mail without care with
the line length the mail is not very readable.

In my personal website you can find a
better format.

<http://hmarco.org/bugs/CVE-2013-4788.html>

Hector Marco.

On 15/07/13 20:21, Hector Marco wrote:
>
> Hi guys,
>
> The following is a bug that we found while we were working around
> stack smashing protection techniques.
>
>
> Title: CVE-2013-4788 - Eglibc PTR MANGLE bug
>
>
> 0.- Description
>
> This bug was discovered in March 2013 while we were developing the RAF SSP
> technique. The glibc bug makes it easy to take advantage of common
> errors such
> as buffer overflows allows in these cases redirect the execution flow and
> potentially execute arbitrary code.
>
>
> 1.- Impact
>
> All statically linked applications compiled with glibc and eglibc are
> affected,
> independent of the operating system distribution. Note that this problem
> is not
> solved by only patching the eglibc, but it is also necessary to
> recompile all
> static executables.  As far I know there are a lot of routers, embedded
> systems
> etc., which use static linked applications. Since the bug is from the
> beginning
> of the PTR_MANGLE implementations (years 2005-2006) there are a ton of
> vulnerable devices.
>
>
> 2.- Vulnerable packages
>
> The bug has been propagated to all the static code compiled with all
> versions,
> on all architectures, of glibc from 2.4 (06-Mar-2006) to 2.17 (Current
> version).
>
>
> 3.- Vulnerability
>
> The vulnerability is caused due to the non initialization to a random
> value (it
> is always zero) of the "pointer guard" by the glibc only when generating
> static
> compiled executables. Dynamic executables are not affected. Pointer
guard is
> used to mangle the content of sensible pointers (longjmp, signal handlers,
> etc.), if the pointer guard value is zero (non-initialized) then it is not
> effective.   An example:  Library functions like "setjmp()" or
> "longjmp()" use
> PTR_MANGLE and PTR_DEMANGLE. These macros are used to protect structures
> like
> jmp_buf. Basically consist on XOR-ing the pointer value with a random
> 32/64-bit
> value. Since the pointer guard (random value) is 0x0 the attacker can
easily
> calculate off-line the value of a target address. By overwriting the "env"
> structure with the pre-computed address the vulnerability is triggered
when
> longjmp() is called and the execution flow is redirected to attacker
> address.
>
> 4.- Exploit
>
> The bug was tested with Debian 7.1 and Ubunu 12.04 LTS and 13.04). I
already
> created a proof of concept to exploit this vulnerability for both 32
and 64
> bits x86 architectures.   The proof of concept poc-bug-mangle.c
redirect the
> execution flow to a function which prompt a shell. This exploit can be
> compiled
> for both i386 and x86_64 architectures. More architectures can be added
> easily
> by adding the correspondent defines.
>
> Compilation for i386:
>    gcc poc-bug-mangle.c -o poc-bug-mangle -static
>
> Compilation for x86_64:
>    gcc poc-bug-mangle.c -o poc-bug-mangle_32 -static -m32
>    gcc poc-bug-mangle.c -o poc-bug-mangle_64 -static -m64
>
> Execution output:
>    box@....upv.es:~$ ./poc-bug-mangle
>    [+] Exploiting ...
>    [+] hacked !!
>    $
>
>
>
> 5.- FIX
>
> Note that the bug is not solved by only patching the eglibc, but it is
also
> necessary to recompile all static executables. I have created a non
official
> patch ptr_mangle-eglibc-2.17.patch for the gblic-2.17.
>
> Patching glibc-2.17:
>    wget <http://hmarco.org/bugs/patches/ptr_mangle-eglibc-2.17.patch>
>    cd glibc-2.17
>    patch -p1 < ../ptr_mangle-eglibc-2.17.patch
>
>
> 6.- Discussion
>
> Although this bug is not exploitable by itself, the truth is that the PTR
> Mangle encryption is useless. The goal of the protection technique is not
> achieved.  This can be seen as the canary stack is set to 0x0, although
> is not
> exploitable by itself is clearly an issue. What about whether the
canary has
> been set to zero from 2006 to today ? This is what happened with the
> pointers
> protected with this mechanism.   According to Ulrich_Drepper to use
> "encryption
> pointers (instead of canaries) to protect structures like jmp_buf is at
> least
> as secure and in addition faster". Following the above and since the
> protection
> mechanism is useless from the first implementation, the number of
> potentially
> affected systems could be huge.
>
> Patch and exploit source code:
>
> <http://hmarco.org/bugs/CVE-2013-4788.html>
>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with undefined - <http://www.enigmail.net/>

iQIcBAEBAgAGBQJR5HRrAAoJEI9kAsYMQl6imCgP/2rT+FZEASHfyB2yDmX3fe8d
EZAa/cATKZscYwZv4dsHt1qrykO0Pe6ksiaBeDyRwsbKtzT6qmxG69P4SEIE04i/
/vle5z60ywFZZGMRpzu+lcI79roVbOndrUcAXWPL66xgHG/zL/WNnSvrN0ehoRWx
VV9biXXXdPB9tmi00EKrn1iy6+CcBGGWZJ8rtxvq27wUsOkIYOzEpUH8fhgbpubs
1NsvFMpWpOjI05YsfT/9xRzJoPbbYpuQo6MgZYYgeVdY3zyxojAAq/64dUJ09UCe
CuxAgB2PSuG5FObHiI5lUBT8baXIBCOSVkz55xwkpLJ/qrqFyT3ULEn7Z331/i3q
cZ/kPldR32esuU+2su5euXlqRcegLx6Bx6zLahVo2EmsFMHB4dUHF7x8fDJFjOCv
5wZgqv5y3dglQAR/zhsvcLpJyKoJc45QuQEry++62nJABajmt5tJSwJHUcKbVP0D
i06AEiAbUI1KJvwZjpvt7aQfkBckA18YoGucUpV9e7nsxcy/Q3Q3cF5svl2jCB61
1hAPZiiLq3oRCQIcDwRjrjM2Ne+Ba5tw1EUQYAMccw+f9BdZrcA8HGCoIce9VQLY
7NSOi4RgAAgmIR0Hcu5CBKQG8GYPcEv0bBDHYrf3epO2L+8qQ1F5KASntrr45siX
Ju8aueJxxsX4knpdCIiQ
=degQ
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


