=== Content from security-tracker.debian.org_1a7978af_20250126_105648.html ===

# CVE-2013-4443

| **Name** | CVE-2013-4443 |
| --- | --- |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2013-4443) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2013-4443); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2013-4443), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2013-4443), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2013-4443), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2013-4443), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-4443), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2013-4443), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2013-4443), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2013-4443)/[CVE](https://www.suse.com/security/cve/CVE-2013-4443/), GitHub [advisories](https://github.com/advisories?query=CVE-2013-4443)/[code](https://github.com/search?type=Code&q=%22CVE-2013-4443%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2013-4443%22), [web search](https://duckduckgo.com/html?q=%22CVE-2013-4443%22), [more](https://oss-security.openwall.org/wiki/vendors)) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from security-tracker.debian.org_c75f79c4_20250126_105647.html ===

# CVE-2013-4440

| **Name** | CVE-2013-4440 |
| --- | --- |
| **Description** | Password Generator (aka Pwgen) before 2.07 generates weak non-tty passwords, which makes it easier for context-dependent attackers to guess the password via a brute-force attack. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2013-4440) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2013-4440); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2013-4440), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2013-4440), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2013-4440), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2013-4440), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-4440), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2013-4440), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2013-4440), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2013-4440)/[CVE](https://www.suse.com/security/cve/CVE-2013-4440/), GitHub [advisories](https://github.com/advisories?query=CVE-2013-4440)/[code](https://github.com/search?type=Code&q=%22CVE-2013-4440%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2013-4440%22), [web search](https://duckduckgo.com/html?q=%22CVE-2013-4440%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [725507](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=725507) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [pwgen](/tracker/source-package/pwgen) ([PTS](https://tracker.debian.org/pkg/pwgen)) | sid, trixie, bookworm, bullseye | 2.08-2 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [pwgen](/tracker/source-package/pwgen) | source | (unstable) | 2.07-1 | unimportant |  | [725507](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=725507) |

## Notes

```
Documented shortcoming

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from www.openwall.com_e24f5e4f_20250125_181539.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](../../../2012/01/23/1) [[<thread-prev]](../../../2012/01/20/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20120122224855.GA16947@openwall.com>
Date: Mon, 23 Jan 2012 02:48:55 +0400
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com, bugtraq@...urityfocus.com
Cc: tytso@....edu
Subject: Re: pwgen: non-uniform distribution of passwords

On Thu, Jan 19, 2012 at 11:34:12PM +0400, Solar Designer wrote:
> $ ./pwgen -1cn 8 1000000000 | dd obs=10M > 1g
...
> $ time ~/john/john-1.7.9-jumbo-5/run/unique -v -mem=25 1gu < 1g
> Total lines read 1000000000 Unique lines written 697066573

Here's some further analysis of the 1 billion sample used as a training
set along with a separate 1 million sample used as a test set:

Applying the 697 million unique passwords (from the 1 billion sample
above) as a wordlist (6 GB file size) to crack another 1 million of
pwgen'ed passwords cracks 418168 of them (41.8%).  For a uniform
distribution (which is not the case), this would correspond to total
keyspace size of about 1.67 billion passwords (between 30 and 31 bits).

Focusing on more frequent pwgen'ed passwords only:

The most common passwords in my 1 billion sample happen to be, prefixed
by number of occurrences:

    127 Ooquoo0e
    125 ooghai0E
    123 eiThie7e
    123 aiShie8o
    122 eiQuei9u
    122 Aighah4u
    121 eichae1I
    121 Oophai4o
    121 Oochoh5u
    121 Iephee6e

the next one is seen 120 times.  Overall, there are 3452 unique
passwords with 100 occurrences or more (in 1 billion generated).

Taking these 3452 as a wordlist cracks 284 passwords in the separate
1 million sample.  This is 0.0284%.  However, 3452 is only %0.0002 of
the 1.67 billion estimate for the keyspace size that we arrived at
above.  Hence, the distribution is non-uniform, and our speedup from
exploiting this property is at least 137x on this test.  (284 / 2 is
obviously 142, but I used more precise numbers here.)

Checking this another way, the keyspace size estimate assuming uniform
distribution would be only 12 million based on the test above - a lot
lower than the previous estimate.  This similarly confirms that the
distribution is non-uniform.

Top 1 million unique passwords from my 1 billion training set cracks
37149 in the test set (3.7%).  The corresponding uniform keyspace size
estimate is 27 million.

Top 10 million unique passwords cracks 145179 (14.5%).  The keyspace
size estimate is 69 million.

Top 100 million unique passwords cracks 262693 (26.3%).  The keyspace
size estimate is 381 million.

Finally, only 115339574 unique passwords are seen in the 1 billion
sample more than once.  (This is less than 1000-697 = 303 million
because many passwords are seen more than 2 times each.)  Using them as
a wordlist cracks 276382 (27.6%).  The keyspace size estimate is 417
million.

Chances are that I won't spend further time on this, although a possible
project would be to create a program that would output all or top N of
pwgen'ed passwords using exact probabilities (based on analysis of
pwgen's source code or/and behavior of pwgen with non-random inputs
rather than based on normal pwgen invocations like I did so far, which
only provides estimates).  This would result in more efficient attacks
(more passwords in the test set cracked per candidate passwords tested).

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from security-tracker.debian.org_1c595cb8_20250126_105632.html ===

# CVE-2013-4441

| **Name** | CVE-2013-4441 |
| --- | --- |
| **Description** | The Phonemes mode in Pwgen 2.06 generates predictable passwords, which makes it easier for context-dependent attackers to guess the password via a brute-force attack. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2013-4441) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2013-4441); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2013-4441), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2013-4441), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2013-4441), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2013-4441), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-4441), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2013-4441), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2013-4441), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2013-4441)/[CVE](https://www.suse.com/security/cve/CVE-2013-4441/), GitHub [advisories](https://github.com/advisories?query=CVE-2013-4441)/[code](https://github.com/search?type=Code&q=%22CVE-2013-4441%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2013-4441%22), [web search](https://duckduckgo.com/html?q=%22CVE-2013-4441%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [726578](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=726578) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [pwgen](/tracker/source-package/pwgen) ([PTS](https://tracker.debian.org/pkg/pwgen)) | sid, trixie, bookworm, bullseye | 2.08-2 | vulnerable |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [pwgen](/tracker/source-package/pwgen) | source | (unstable) | (unfixed) | unimportant |  | [726578](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=726578) |

## Notes

```
pwgen is documented to generate memorable passwords, so this is by design

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from bugs.debian.org_16200ce0_20250125_181539.html ===

# Debian Bug report logs - #726578 pwgen: Multiple vulnerabilities in passwords generation

Package:
[pwgen](pkgreport.cgi?package=pwgen);
Maintainer for [pwgen](pkgreport.cgi?package=pwgen) is [Theodore Y. Ts'o <tytso@mit.edu>](pkgreport.cgi?maint=tytso%40mit.edu); Source for [pwgen](pkgreport.cgi?package=pwgen) is [src:pwgen](pkgreport.cgi?src=pwgen) ([PTS](https://tracker.debian.org/pkg/pwgen), [buildd](https://buildd.debian.org/pwgen), [popcon](https://qa.debian.org/popcon.php?package=pwgen)).

Reported by: [Yves-Alexis Perez <corsac@debian.org>](pkgreport.cgi?submitter=corsac%40debian.org)

Date: Wed, 16 Oct 2013 20:06:02 UTC

Severity: important

Tags: security

Reply or subscribe to this bug.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=726578;mbox=yes), [status mbox](bugreport.cgi?bug=726578;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=726578;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Theodore Y. Ts'o <tytso@mit.edu>`:

`Bug#726578`; Package `pwgen`.
(Wed, 16 Oct 2013 20:06:06 GMT) ([full text](bugreport.cgi?bug=726578;msg=2), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Yves-Alexis Perez <corsac@debian.org>`:

New Bug report received and forwarded. Copy sent to `team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Theodore Y. Ts'o <tytso@mit.edu>`.
(Wed, 16 Oct 2013 20:06:06 GMT) ([full text](bugreport.cgi?bug=726578;msg=4), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=726578;msg=5), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=corsac%40debian.org)
From: Yves-Alexis Perez <corsac@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: pwgen: Multiple vulnerabilities in passwords generation
Date: Wed, 16 Oct 2013 22:03:35 +0200
```
Package: pwgen
Severity: grave
Tags: security
Justification: user security hole

Hi Theodore,

multiple CVEs were just assigned to pwgen, following the analysis by
Solar Designer and other people (see thread at
<http://marc.info/?l=oss-security&m=138015793928431&w=2>)

[CVE-2013-4440](https://security-tracker.debian.org/tracker/CVE-2013-4440) non-tty passwords are trivially weak by default
[CVE-2013-4441](https://security-tracker.debian.org/tracker/CVE-2013-4441) Phonemes mode has heavy bias and is enabled by default
[CVE-2013-4442](https://security-tracker.debian.org/tracker/CVE-2013-4442) Silent fallback to insecure entropy
[CVE-2013-4443](https://security-tracker.debian.org/tracker/CVE-2013-4443) Secure mode has bias towards numbers and uppercase letters

I'm not too sure how to handle that, especially for stable releases,
since it seems major refactoring might be needed to get rid of the
weaknesses and bias.

Regards,
--
Yves-Alexis Perez
Debian Security

-- System Information:
Debian Release: jessie/sid
  APT prefers unstable
  APT policy: (500, 'unstable'), (500, 'testing'), (500, 'stable'), (450, 'experimental')
Architecture: amd64 (x86_64)

Kernel: Linux 3.10-3-amd64 (SMP w/4 CPU cores)
Locale: LANG=en_US.utf8, LC_CTYPE=en_US.utf8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Theodore Y. Ts'o <tytso@mit.edu>`:

`Bug#726578`; Package `pwgen`.
(Thu, 17 Oct 2013 08:27:04 GMT) ([full text](bugreport.cgi?bug=726578;msg=7), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Raphael Geissert <geissert@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Theodore Y. Ts'o <tytso@mit.edu>`.
(Thu, 17 Oct 2013 08:27:04 GMT) ([full text](bugreport.cgi?bug=726578;msg=9), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 726578@bugs.debian.org ([full text](bugreport.cgi?bug=726578;msg=10), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=geissert%40debian.org)
From: Raphael Geissert <geissert@debian.org>
To: Yves-Alexis Perez <corsac@debian.org>, 726578@bugs.debian.org
Subject: Re: Bug#726578: pwgen: Multiple vulnerabilities in passwords generation
Date: Thu, 17 Oct 2013 10:21:53 +0200
```
Hi,

On 16 October 2013 22:03, Yves-Alexis Perez <corsac@debian.org> wrote:
> I'm not too sure how to handle that, especially for stable releases,
> since it seems major refactoring might be needed to get rid of the
> weaknesses and bias.

I think it's best to write a script that uses makepasswd and is
command-line and output-compatible with pwgen.
Basically changing everything under the hood without letting others know.

Cheers,
--
Raphael Geissert - Debian Developer
www.debian.org - get.debian.net

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Theodore Y. Ts'o <tytso@mit.edu>`:

`Bug#726578`; Package `pwgen`.
(Thu, 17 Oct 2013 10:18:04 GMT) ([full text](bugreport.cgi?bug=726578;msg=12), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Steven Chamberlain <steven@pyro.eu.org>`:

Extra info received and forwarded to list. Copy sent to `Theodore Y. Ts'o <tytso@mit.edu>`.
(Thu, 17 Oct 2013 10:18:04 GMT) ([full text](bugreport.cgi?bug=726578;msg=14), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 726578@bugs.debian.org ([full text](bugreport.cgi?bug=726578;msg=15), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=steven%40pyro.eu.org)
From: Steven Chamberlain <steven@pyro.eu.org>
To: 726578@bugs.debian.org
Subject: Re: Bug#726578: pwgen: Multiple vulnerabilities in passwords generation
Date: Thu, 17 Oct 2013 11:14:23 +0100
```
Hi,

I don't see that any major refactoring is needed, but rather the default
assumed flags are unsafe, although changing them might be incompatible
with some scripts/applications using pwgen.

[CVE-2013-4440](https://security-tracker.debian.org/tracker/CVE-2013-4440) non-tty passwords are trivially weak by default

should ideally stop using -0A by default in non-tty mode, but could
maybe warn/fail if the caller doesn't override with -nc, which has been
recommended in the man page until now.

[CVE-2013-4441](https://security-tracker.debian.org/tracker/CVE-2013-4441) Phonemes mode has heavy bias and is enabled by default

assume -s by default?  I think it uses the same character set but with
more entropy, so only a human user should notice any difference at all.
 As long as the -s flag is set *before* parsing command line flags, it
does not conflict with -0 -A -B or -v.

[CVE-2013-4442](https://security-tracker.debian.org/tracker/CVE-2013-4442) Silent fallback to insecure entropy

consider using /dev/random instead of /dev/urandom? (Debian bug #672241)
and in any case fail if it cannot be read

[CVE-2013-4443](https://security-tracker.debian.org/tracker/CVE-2013-4443) Secure mode has bias towards numbers and uppercase letters

probably the least serious issue;  -n guarantees at least one numeral,
-c guarantees at least one capital, instead of being a completely random
selection.  Sometimes necessary if the password consumer enforces such a
rule.

Regards,
--
Steven Chamberlain
steven@pyro.eu.org

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Theodore Y. Ts'o <tytso@mit.edu>`:

`Bug#726578`; Package `pwgen`.
(Wed, 23 Oct 2013 04:27:09 GMT) ([full text](bugreport.cgi?bug=726578;msg=17), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Theodore Y. Ts'o <tytso@mit.edu>`.
(Wed, 23 Oct 2013 04:27:09 GMT) ([full text](bugreport.cgi?bug=726578;msg=19), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 726578@bugs.debian.org ([full text](bugreport.cgi?bug=726578;msg=20), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: 726578@bugs.debian.org
Subject: Re: Bug#726578: pwgen: Multiple vulnerabilities in passwords
generation
Date: Wed, 23 Oct 2013 06:22:55 +0200
```
Hi

Small updates on the assigned CVE's:

On Thu, Oct 17, 2013 at 11:14:23AM +0100, Steven Chamberlain wrote:
> [CVE-2013-4443](https://security-tracker.debian.org/tracker/CVE-2013-4443) Secure mode has bias towards numbers and uppercase letters
>
> probably the least serious issue;  -n guarantees at least one numeral,
> -c guarantees at least one capital, instead of being a completely random
> selection.  Sometimes necessary if the password consumer enforces such a
> rule.

This indeed was rejected, see [1] and [2].

 [1] <http://marc.info/?l=oss-security&m=138247862202393&w=2>
 [2] <http://marc.info/?l=oss-security&m=138249250706253&w=2>

Regards,
Salvatore

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Theodore Y. Ts'o <tytso@mit.edu>`:

`Bug#726578`; Package `pwgen`.
(Sun, 12 Jan 2014 20:51:17 GMT) ([full text](bugreport.cgi?bug=726578;msg=22), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=22), [link](#21)).

---

**Acknowledgement sent**
to `Arne Wichmann <aw@anhrefn.saar.de>`:

Extra info received and forwarded to list. Copy sent to `Theodore Y. Ts'o <tytso@mit.edu>`.
(Sun, 12 Jan 2014 20:51:17 GMT) ([full text](bugreport.cgi?bug=726578;msg=24), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=24), [link](#23)).

---

[Message #25](#25) received at 726578@bugs.debian.org ([full text](bugreport.cgi?bug=726578;msg=25), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=25), reply):

![](/cgi-bin/libravatar.cgi?email=aw%40anhrefn.saar.de)
From: Arne Wichmann <aw@anhrefn.saar.de>
To: 726578@bugs.debian.org
Subject: Ping: pwgen: Multiple vulnerabilities in passwords generation
Date: Sun, 12 Jan 2014 21:27:14 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=726578;msg=25) (text/plain, inline)]
```
```
Hi!

This grave problem is now open for more than two months. Is there any plan
to resolve this?

cu

AW
--
[...] If you don't want to be restricted, don't agree to it. If you are
coerced, comply as much as you must to protect yourself, just don't support
it. Noone can free you but yourself. (crag, on Debian Planet)
Arne Wichmann (aw@linux.de)

```
```
[[signature.asc](bugreport.cgi?att=1;bug=726578;filename=signature.asc;msg=25) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Theodore Y. Ts'o <tytso@mit.edu>`:

`Bug#726578`; Package `pwgen`.
(Sun, 12 Jan 2014 23:48:10 GMT) ([full text](bugreport.cgi?bug=726578;msg=27), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=27), [link](#26)).

---

**Acknowledgement sent**
to `Theodore Ts'o <tytso@mit.edu>`:

Extra info received and forwarded to list. Copy sent to `Theodore Y. Ts'o <tytso@mit.edu>`.
(Sun, 12 Jan 2014 23:48:10 GMT) ([full text](bugreport.cgi?bug=726578;msg=29), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=29), [link](#28)).

---

[Message #30](#30) received at 726578@bugs.debian.org ([full text](bugreport.cgi?bug=726578;msg=30), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=30), reply):

![](/cgi-bin/libravatar.cgi?email=tytso%40mit.edu)
From: Theodore Ts'o <tytso@mit.edu>
To: Arne Wichmann <aw@anhrefn.saar.de>, 726578@bugs.debian.org
Subject: Re: Bug#726578: Ping: pwgen: Multiple vulnerabilities in passwords
generation
Date: Sun, 12 Jan 2014 18:45:00 -0500
```
On Sun, Jan 12, 2014 at 09:27:14PM +0100, Arne Wichmann wrote:
>
> This grave problem is now open for more than two months. Is there any plan
> to resolve this?

First, the CVE about having the unavailability of /dev/random fail
hard -- sure, that should be a separate bug since that's a fix that I
think is reasonable at this point.  We can now guarantee that
/dev/random exists everywhere.  (And by that same token, if an
attacker can cause /dev/random not to be present, they probably have
root, so you're probably toast anyway.  So I don't think it's going to
really improve things to remove the drand() fallback, but I don't have
strong feelings about that.)

Secondly, I'll note that one of the CVE's were rejected as not a
vulnerability.  (In general it would have been better to have opened
seperate bugs for each CVE.)

Finally, whether you think the other two CVE's justify this to be
serious, let alone "grave" bug really depends on what you think the
goals of pwgen are.  To quote from the manual page:

    The  pwgen  program generates passwords which are designed to be easily
    memorized by humans, while being as secure  as  possible.   Human-memo‐
    rable  passwords  are  never  going  to be as secure as completely com‐
    pletely random passwords.  In particular, passwords generated by  pwgen
    without  the  -s option should not be used in places where the password
    could be attacked via an off-line brute-force attack.    On  the  other
    hand,  completely  randomly  generated  passwords have a tendency to be
    written down, and are subject to being compromised in that fashion.

So we could change the defaults to be "pwgen -csy 20", in which case
you would get passwords like tihs:

L}U@lc_~i^>n|ro!4uI- 1`;yXlYVMW%?E9)3A&7G **}6BoBu=!~3)y?3v]Or
>=>:PC;H?E7*+6$c&-QH URGgjUNG[\dSw\>p7F-] _AXZ~(HYd8Q#%b>!]'u:
~)0<I-{)}_Ya*Q2nlWN; ^#t~1/'sf@*xz9GOhBuv e_[-_Fe{CD#]DY8&@M^a

I'm not sure that would be an improvement, as simply no one would use
them.

OK, how about this?  (Generated using pwgen -s).

vQ6uwkMk lSswO2MB tA8dYPpl KU1pQ2Xh 2XfxRyrC Za2xKx7h psPwHZ0c dOsC0JBX
JY3udA9c t6LzoiUq M0jR3AoS GOHkNE7G TeThsZz1 6cVi4ayY Poe4hPj7 o2a7OpPC
Xh24cRLO 1chQyseV 6c2k0O3B OkdgRxy4 K6Vc4JY2 ylO3IE9B gVvNxw6B 7wjcOXwF

Again, this will make the professional paranoids happy (although
perhaps not as happy as ">=>:PC;H?E7*+6$c&-QH"), but its not clear that
real users would be any less likely to write "ylO3IE9B" on a sticky
note which is pasted to their monitor, or just in a "passwords" file
in their home directory.

So ultimately, a lot of this is about an argument over defaults, and I
think the higher level problem is that no matter what password policy
you use, passwords are doomed as a technology.  Anything which is
secure against a brute force attack is impossible for a user to use,
unless they share passwords across multiple sites so they only have to
remember one password such as "ylO3IE9B" --- at which point they get
toast once some web site screws up in some way and gets penetrated by
bad guys.

					- Ted

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Theodore Y. Ts'o <tytso@mit.edu>`:

`Bug#726578`; Package `pwgen`.
(Tue, 14 Jan 2014 11:12:04 GMT) ([full text](bugreport.cgi?bug=726578;msg=32), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=32), [link](#31)).

---

**Acknowledgement sent**
to `Arne Wichmann <aw@anhrefn.saar.de>`:

Extra info received and forwarded to list. Copy sent to `Theodore Y. Ts'o <tytso@mit.edu>`.
(Tue, 14 Jan 2014 11:12:04 GMT) ([full text](bugreport.cgi?bug=726578;msg=34), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=34), [link](#33)).

---

[Message #35](#35) received at 726578@bugs.debian.org ([full text](bugreport.cgi?bug=726578;msg=35), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=35), reply):

![](/cgi-bin/libravatar.cgi?email=aw%40anhrefn.saar.de)
From: Arne Wichmann <aw@anhrefn.saar.de>
To: Theodore Ts'o <tytso@mit.edu>
Cc: 726578@bugs.debian.org
Subject: Re: Bug#726578: Ping: pwgen: Multiple vulnerabilities in passwords
generation
Date: Tue, 14 Jan 2014 12:08:11 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=726578;msg=35) (text/plain, inline)]
```
```
Thank you for reacting quickly!

begin  quotation  from Theodore Ts'o (in <20140112234500.GA15640@thunk.org>):
> On Sun, Jan 12, 2014 at 09:27:14PM +0100, Arne Wichmann wrote:
> > This grave problem is now open for more than two months. Is there any plan
> > to resolve this?
>
> First, the CVE about having the unavailability of /dev/random fail
> hard -- sure, that should be a separate bug since that's a fix that I
> think is reasonable at this point.  We can now guarantee that
> /dev/random exists everywhere.  (And by that same token, if an
> attacker can cause /dev/random not to be present, they probably have
> root, so you're probably toast anyway.  So I don't think it's going to
> really improve things to remove the drand() fallback, but I don't have
> strong feelings about that.)

So you might clone a new bug for this...

> Secondly, I'll note that one of the CVE's were rejected as not a
> vulnerability.  (In general it would have been better to have opened
> seperate bugs for each CVE.)

Different maintainers have different preferences here - I will note that
you want seperate bugs (as we do for a number of other packages).

> Finally, whether you think the other two CVE's justify this to be
> serious, let alone "grave" bug really depends on what you think the
> goals of pwgen are.  To quote from the manual page:

This is your decision - we try to use a fitting severity for every problem,
but sometimes the cases are not so clear.

>     The  pwgen  program generates passwords which are designed to be easily
>     memorized by humans, while being as secure  as  possible.   Human-memo???
>     rable  passwords  are  never  going  to be as secure as completely com???
>     pletely random passwords.  In particular, passwords generated by  pwgen
>     without  the  -s option should not be used in places where the password
>     could be attacked via an off-line brute-force attack.    On  the  other
>     hand,  completely  randomly  generated  passwords have a tendency to be
>     written down, and are subject to being compromised in that fashion.
>
> So we could change the defaults to be "pwgen -csy 20", in which case
> you would get passwords like tihs:
>
> L}U@lc_~i^>n|ro!4uI- 1`;yXlYVMW%?E9)3A&7G **}6BoBu=!~3)y?3v]Or
> >=>:PC;H?E7*+6$c&-QH URGgjUNG[\dSw\>p7F-] _AXZ~(HYd8Q#%b>!]'u:
> ~)0<I-{)}_Ya*Q2nlWN; ^#t~1/'sf@*xz9GOhBuv e_[-_Fe{CD#]DY8&@M^a
>
> I'm not sure that would be an improvement, as simply no one would use
> them.
>
> OK, how about this?  (Generated using pwgen -s).
>
> vQ6uwkMk lSswO2MB tA8dYPpl KU1pQ2Xh 2XfxRyrC Za2xKx7h psPwHZ0c dOsC0JBX
> JY3udA9c t6LzoiUq M0jR3AoS GOHkNE7G TeThsZz1 6cVi4ayY Poe4hPj7 o2a7OpPC
> Xh24cRLO 1chQyseV 6c2k0O3B OkdgRxy4 K6Vc4JY2 ylO3IE9B gVvNxw6B 7wjcOXwF
>
> Again, this will make the professional paranoids happy (although
> perhaps not as happy as ">=>:PC;H?E7*+6$c&-QH"), but its not clear that
> real users would be any less likely to write "ylO3IE9B" on a sticky
> note which is pasted to their monitor, or just in a "passwords" file
> in their home directory.

I do not have a really good idea on how to handle this. Some ideas come to
mind, mostly inspired by [1]:
- Improve the algorithm to be less biased. Though I see that would not be
  easy.
- Warn about the bias
- Use -s as default

[2] suggests, that there is a patch out there, but I have not yet looked at
it.

> So ultimately, a lot of this is about an argument over defaults, and I
> think the higher level problem is that no matter what password policy
> you use, passwords are doomed as a technology.  Anything which is
> secure against a brute force attack is impossible for a user to use,
> unless they share passwords across multiple sites so they only have to
> remember one password such as "ylO3IE9B" --- at which point they get
> toast once some web site screws up in some way and gets penetrated by
> bad guys.

I see the point, but that does not make the problem go away, and in many
cases you do not have so much of a choice, so the program does still have
its points.

[CVE-2013-4440](https://security-tracker.debian.org/tracker/CVE-2013-4440) has an easy fix, isn't it?

[1] <http://www.openwall.com/lists/oss-security/2012/01/19/24>
[2] <http://marc.info/?l=oss-security&m=138015793928431&w=2>

cu

AW
--
[...] If you don't want to be restricted, don't agree to it. If you are
coerced, comply as much as you must to protect yourself, just don't support
it. Noone can free you but yourself. (crag, on Debian Planet)
Arne Wichmann (aw@linux.de)

```
```
[[signature.asc](bugreport.cgi?att=1;bug=726578;filename=signature.asc;msg=35) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Theodore Y. Ts'o <tytso@mit.edu>`:

`Bug#726578`; Package `pwgen`.
(Tue, 21 Oct 2014 10:00:05 GMT) ([full text](bugreport.cgi?bug=726578;msg=37), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=37), [link](#36)).

---

**Acknowledgement sent**
to `Adam Borowski <kilobyte@angband.pl>`:

Extra info received and forwarded to list. Copy sent to `Theodore Y. Ts'o <tytso@mit.edu>`.
(Tue, 21 Oct 2014 10:00:05 GMT) ([full text](bugreport.cgi?bug=726578;msg=39), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=39), [link](#38)).

---

[Message #40](#40) received at 726578@bugs.debian.org ([full text](bugreport.cgi?bug=726578;msg=40), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=40), reply):

![](/cgi-bin/libravatar.cgi?email=kilobyte%40angband.pl)
From: Adam Borowski <kilobyte@angband.pl>
To: 726578@bugs.debian.org
Subject: please tell me how is this a vulnerability
Date: Tue, 21 Oct 2014 11:57:52 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=726578;msg=40) (text/plain, inline)]
```
```
Control: tags -1 +patch

So... how exactly are these vulnerabilities?

2. is what this program is supposed to do: produce _pronounceable_ passwords
instead of pure line noise.  Sure, these do have less entropy than pure line
noise for the same length, but the point is to make something that's
possible to remember.  If I wanted fully random unbiased ASCII characters,
I'd use a perl one-liner instead of a complex generator like pwgen.

As for 4., as Steven remarked, this is done intentionally to placate
"password quality checkers".  Also, while allowing an all-lowercase password
2^-8 of the time does have negligibly more resilience against an exhaustive
attack, it is massively worse against attacks prevalent in the real world.
Thus, paying this small amount of entropy is well worth it.

And as for 3., please read <http://www.2uo.de/myths-about-urandom/>
Heck, FreeBSD doesn't even _have_ /dev/random in Linux's sense -- and no one
is calling it insecure.

So these three points are complete non-issues.

I do agree with 1., though, so here's a patch to fix it.

Let's have pwgen in jessie!

--
// If you believe in so-called "intellectual property", please immediately
// cease using counterfeit alphabets.  Instead, contact the nearest temple
// of Amon, whose priests will provide you with scribal services for all
// your writing needs, for Reasonable and Non-Discriminatory prices.

```
```
[[pwgen-notty.patch](bugreport.cgi?att=1;bug=726578;filename=pwgen-notty.patch;msg=40) (text/x-diff, attachment)]
```

---

**Added tag(s) patch.**
Request was from `Adam Borowski <kilobyte@angband.pl>`
to `726578-submit@bugs.debian.org`.
(Tue, 21 Oct 2014 10:00:05 GMT) ([full text](bugreport.cgi?bug=726578;msg=42), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=42), [link](#41)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Theodore Y. Ts'o <tytso@mit.edu>`:

`Bug#726578`; Package `pwgen`.
(Mon, 27 Oct 2014 15:39:17 GMT) ([full text](bugreport.cgi?bug=726578;msg=44), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=44), [link](#43)).

---

**Acknowledgement sent**
to `Adam Borowski <kilobyte@angband.pl>`:

Extra info received and forwarded to list. Copy sent to `Theodore Y. Ts'o <tytso@mit.edu>`.
(Mon, 27 Oct 2014 15:39:17 GMT) ([full text](bugreport.cgi?bug=726578;msg=46), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=46), [link](#45)).

---

[Message #47](#47) received at 726578@bugs.debian.org ([full text](bugreport.cgi?bug=726578;msg=47), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=47), reply):

![](/cgi-bin/libravatar.cgi?email=kilobyte%40angband.pl)
From: Adam Borowski <kilobyte@angband.pl>
To: 726578@bugs.debian.org
Subject: CVE-2013-4442 is not about /dev/random vs /dev/urandom
Date: Mon, 27 Oct 2014 16:34:59 +0100
```
It looks like this bug does mischaracterize [CVE-2013-4442](https://security-tracker.debian.org/tracker/CVE-2013-4442).  Unlike what's
said here, using /dev/urandom instead of /dev/random (which contrary to
popular wisdom is not an issue) but that, if opening of these two devices
fail, pwgen falls back to using pids and time.

On BSD and Linux/GNU, /dev/urandom is guaranteed so this might trigger if:
* someone exhausts the system-wide descriptor limit
* a chroot lacks the /dev entries
* the admin writes a pathologically bad selinux policy

Let's track this as a separate bug.  I'd say that this is only a minor
vulnerability, thus let's have it at "important" severity.  pwgen has at
least one RC issue, so it wouldn't be bad to fix for jessie but I don't find
it as a must.

--
// If you believe in so-called "intellectual property", please immediately
// cease using counterfeit alphabets.  Instead, contact the nearest temple
// of Amon, whose priests will provide you with scribal services for all
// your writing needs, for Reasonable and Non-Discriminatory prices.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Theodore Y. Ts'o <tytso@mit.edu>`:

`Bug#726578`; Package `pwgen`.
(Mon, 27 Oct 2014 16:03:05 GMT) ([full text](bugreport.cgi?bug=726578;msg=49), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=49), [link](#48)).

---

**Acknowledgement sent**
to `Adam Borowski <kilobyte@angband.pl>`:

Extra info received and forwarded to list. Copy sent to `Theodore Y. Ts'o <tytso@mit.edu>`.
(Mon, 27 Oct 2014 16:03:05 GMT) ([full text](bugreport.cgi?bug=726578;msg=51), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=51), [link](#50)).

---

[Message #52](#52) received at 726578@bugs.debian.org ([full text](bugreport.cgi?bug=726578;msg=52), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=52), reply):

![](/cgi-bin/libravatar.cgi?email=kilobyte%40angband.pl)
From: Adam Borowski <kilobyte@angband.pl>
To: 726578@bugs.debian.org
Subject: remaining issues are non-bugs
Date: Mon, 27 Oct 2014 17:00:05 +0100
```
Control: severity -1 important

I have split two parts into separate bugs, I think the remainder are ok:

[CVE-2013-4440](https://security-tracker.debian.org/tracker/CVE-2013-4440) non-tty passwords are trivially weak by default
* #725507, my assessment: grave
[CVE-2013-4441](https://security-tracker.debian.org/tracker/CVE-2013-4441) Phonemes mode has heavy bias and is enabled by default
* works as designed
[CVE-2013-4442](https://security-tracker.debian.org/tracker/CVE-2013-4442) Silent fallback to insecure entropy
* #767008, my assessment: important
[CVE-2013-4443](https://security-tracker.debian.org/tracker/CVE-2013-4443) Secure mode has bias towards numbers and uppercase letters
* REJECTED, actually improves security!

[CVE-2013-4443](https://security-tracker.debian.org/tracker/CVE-2013-4443) has been rejected from the CVE database.

So let's discuss [CVE-2013-4441](https://security-tracker.debian.org/tracker/CVE-2013-4441).  Such a bias means the program does what
it's designed to do: it produces pronounceable passwords rather than a pure
line noise.  These are not necessarily less secure -- you just need a longer
length than on line noise.  Recently this has been popularized as the
"correct horse battery staple" issue: long passwords are far, far easier to
memorize for a human than shorter but more complex ones, while being capable
of providing as much or more entropy.

What remains is that pwgen's default length, 8 characters, might been
adequate when the program was written, but is insecure today.  But let's
discuss that elsewhere.

So I think this bug should be closed.  Being not a security expert myself,
I'm merely degrading it to "important" for now, until someone else can
confirm and close.

I'll bump #725507 to grave after the next britney run.

--
// If you believe in so-called "intellectual property", please immediately
// cease using counterfeit alphabets.  Instead, contact the nearest temple
// of Amon, whose priests will provide you with scribal services for all
// your writing needs, for Reasonable and Non-Discriminatory prices.

```

---

**Severity set to 'important' from 'grave'**
Request was from `Adam Borowski <kilobyte@angband.pl>`
to `726578-submit@bugs.debian.org`.
(Mon, 27 Oct 2014 16:03:05 GMT) ([full text](bugreport.cgi?bug=726578;msg=54), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=54), [link](#53)).

---

**Removed tag(s) patch.**
Request was from `Adam Borowski <kilobyte@angband.pl>`
to `725507-submit@bugs.debian.org`.
(Mon, 27 Oct 2014 18:21:07 GMT) ([full text](bugreport.cgi?bug=726578;msg=56), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=56), [link](#55)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Theodore Y. Ts'o <tytso@mit.edu>`:

`Bug#726578`; Package `pwgen`.
(Fri, 30 Oct 2015 20:18:04 GMT) ([full text](bugreport.cgi?bug=726578;msg=58), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=58), [link](#57)).

---

**Acknowledgement sent**
to `"Interfax" <incoming@interfax.net>`:

Extra info received and forwarded to list. Copy sent to `Theodore Y. Ts'o <tytso@mit.edu>`.
(Fri, 30 Oct 2015 20:18:04 GMT) ([full text](bugreport.cgi?bug=726578;msg=60), [mbox](bugreport.cgi?bug=726578;mbox=yes;msg=60), [link](#59)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=726578).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 18:15:38 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from www.openwall.com_2ac8ed48_20250125_181537.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2013/06/05/27) [[next>]](2) [[<thread-prev]](../../../2013/05/28/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CACYkhxjNX0Kk7pzWV9BAtHQZC9h85yBSbxkqh9BA+8HnGhojdw@mail.gmail.com>
Date: Thu, 6 Jun 2013 14:19:50 +1000
From: Michael Samuel <mik@...net.net>
To: Solar Designer <solar@...nwall.com>
Cc: oss-security@...ts.openwall.com
Subject: Re: CVE Request: pwgen

I've done some further analysis of the program after reading the previous
thread, and I think there needs to be CVEs and fixes for:

- When used from a non-tty passwords are trivially weak by default (first
reported by Solar Designer)
- Phonemes mode has heavy bias and is enabled by default (first reported by
Solar Designer)
- Silent fallback to insecure entropy (first reported by Jean-Michel
Vourgère) (Debian bug #672241 - tagged as "wishlist")
- Secure mode has bias towards numbers and uppercase letters

I've attached a patch that fixes most issues - it doesn't solve the bias
towards numbers, because it's caused by requiring at-least one number per
password - so in an 8 character password there'd have to be 0.1 numbers to
avoid bias.  There's an argument to be made for removing the at-least-one
rule, but if the system that password is being used with has those rules,
it doesn't fix the problem anyway.  Perhaps a separate flag for that?

The changes are:

- Print a message and abort() of there's trouble opening or reading
/dev/urandom (So apport should pick up any packages that have been using
insecure entropy)
- Make "-s" the default
- Add an argument --insecure-phonemes (or -P)
- Non-tty passwords are now as secure as tty
- Require lower-case characters be present to even out some bias
- Pull in passwdqc as a Suggests on the debian package - pwqgen can
generate sane random passphrases

I can't imagine any reasonable use-case for the non-tty defaults (except
maybe combining with espeak as an enhanced interrogation technique), and
you can be certain that there's some people out there with it embedded in a
script that's generating useless passwords.

For phonemes mode in general, the bias is extreme, there are a limited
number of possible combinations and it is generally not suitable for
security purposes.  I have some fairly detailed analysis of it, but I
believe this list has a no-exploits policy...

Regards,
  Michael

On 28 May 2013 11:47, Solar Designer <solar@...nwall.com> wrote:

> On Tue, May 28, 2013 at 01:33:48AM +0000, Michael Samuel wrote:
> > The default mode of this program generates extremely low entropy
> passwords -
> > It is probably worth changing the default to "secure" mode and removing
> > phonemes mode, to avoid putting users at risk.
>
> Yes.  You have seen the thread on pwgen from last year, right? -
>
> <http://www.openwall.com/lists/oss-security/2012/01/22/6>
>
> (Use the "thread-prev" link for more messages from that thread.)
>
> Alexander
>

Content of type "text/html" skipped

Download attachment "[pwgen-security.patch](1/1)" of type "application/octet-stream" (6141 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_33d569e7_20250125_181537.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](14) [[next>]](16) [[<thread-prev]](../../../2013/10/12/2) [[thread-next>]](../../../2013/10/18/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <525E2B5F.9050904@redhat.com>
Date: Tue, 15 Oct 2013 23:59:59 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
Subject: Re: RESEND: CVE Request: pwgen

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 10/11/2013 09:34 PM, Solar Designer wrote:
> Kurt, Steve, all -
>
> On Thu, Oct 10, 2013 at 03:35:09PM +0200, Marcus Meissner wrote:
>> It might just not be that CVE worthy. But I saw no replies...
>
> I now think it is CVE worthy.
>
>> (CVE worthyness: It does not fully meet the security expectations
>> of generating a non-weak password by default.... )
>>
>> Solar? Kurt?
>
> Kurt was "sitting on the fence for this one":
>
> <http://www.openwall.com/lists/oss-security/2012/01/17/12>
>
> At the time, I replied that it was too early for the CVE aspect, as
> I was still figuring out the magnitude of the problem:
>
> <http://www.openwall.com/lists/oss-security/2012/01/17/14>
>
> Steve replied that having an insecure feature documented does not
> always preclude from CVE assignment:
>
> <http://www.openwall.com/lists/oss-security/2012/01/17/15>
>
> To this, I can add that although the phoneme mode is documented as
> being less secure, the magnitude and ways in which it is less
> secure are unclear from the documentation.  Specifically, there's
> no mention that the distribution of generated passwords is highly
> non-uniform, and indeed this is not clear from merely looking at a
> handful of passwords. (I guess this non-uniformity was not expected
> by the author, and thus it is a bug.)
>
> Also, without looking at the documentation, it is not even
> immediately clear (to a new user of the program) that phonemes are
> being used. At first glance, the passwords look like they could
> potentially use the full 62^8 keyspace - but this is actually not
> the case, by far.  So the program's default behavior is
> misleading.
>
> The thread ended here, with some figures showing just how bad the
> problem is:
>
> <http://www.openwall.com/lists/oss-security/2012/01/22/6>
>
> The CVE aspect was not revisited.
>
> Here are the figures for pwgen's defaults with output to tty:
>
> Top 1 million of unique passwords from my 1 billion training set
> cracks 3.7% of passwords in the test set.
>
> Top 10 million cracks 14.5%.
>
> Top 44 million cracks 21%.  (I chose this as an optimal wordlist
> size.)
>
> Top 100 million cracks 26.3%.
>
> With pwgen's defaults with output to non-tty:
>
> Top 45.5 million cracks 75%.  (Ouch!)
>
> These results can be improved a little bit (slightly higher
> percentages cracked per same wordlist size) by using a larger
> training set (beyond 1 billion) or by considering all of the
> phoneme probabilities, etc. and creating a program that would
> output pwgen's possible passwords in an optimal order (this proves
> to be a non-trivial task so far, yet someone may do it).
>
> Alexander
>
>> On Thu, Sep 26, 2013 at 11:11:59AM +1000, Michael Samuel wrote:
>>> Hi,
>>>
>>> No CVEs have been assigned for this, and as far as I can tell
>>> no distributions have patched.
>>>
>>> On 6 June 2013 14:19, Michael Samuel <mik@...net.net> wrote:
>>>
>>>> I've done some further analysis of the program after reading
>>>> the previous thread, and I think there needs to be CVEs and
>>>> fixes for:
>>>>
>>>> - When used from a non-tty passwords are trivially weak by
>>>> default (first reported by Solar Designer) - Phonemes mode
>>>> has heavy bias and is enabled by default (first reported by
>>>> Solar Designer) - Silent fallback to insecure entropy (first
>>>> reported by Jean-Michel Vourg?re) (Debian bug #672241 -
>>>> tagged as "wishlist") - Secure mode has bias towards numbers
>>>> and uppercase letters
>>>>
>>>> I've attached a patch that fixes most issues - it doesn't
>>>> solve the bias towards numbers, because it's caused by
>>>> requiring at-least one number per password - so in an 8
>>>> character password there'd have to be 0.1 numbers to avoid
>>>> bias.  There's an argument to be made for removing the
>>>> at-least-one rule, but if the system that password is being
>>>> used with has those rules, it doesn't fix the problem anyway.
>>>> Perhaps a separate flag for that?
>>>>
>>>> The changes are:
>>>>
>>>> - Print a message and abort() of there's trouble opening or
>>>> reading /dev/urandom (So apport should pick up any packages
>>>> that have been using insecure entropy) - Make "-s" the
>>>> default - Add an argument --insecure-phonemes (or -P) -
>>>> Non-tty passwords are now as secure as tty - Require
>>>> lower-case characters be present to even out some bias - Pull
>>>> in passwdqc as a Suggests on the debian package - pwqgen can
>>>> generate sane random passphrases
>>>>
>>>> I can't imagine any reasonable use-case for the non-tty
>>>> defaults (except maybe combining with espeak as an enhanced
>>>> interrogation technique), and you can be certain that there's
>>>> some people out there with it embedded in a script that's
>>>> generating useless passwords.
>>>>
>>>> For phonemes mode in general, the bias is extreme, there are
>>>> a limited number of possible combinations and it is generally
>>>> not suitable for security purposes.  I have some fairly
>>>> detailed analysis of it, but I believe this list has a
>>>> no-exploits policy...
>>>>
>>>> Regards, Michael

Welp I can't argue with data (well I could, but that would be silly).

Please use:

CVE-2013-4440 pwgen non-tty passwords are trivially weak by default

CVE-2013-4441 pwgen Phonemes mode has heavy bias and is enabled by default

CVE-2013-4442 pwgen Silent fallback to insecure entropy

CVE-2013-4443 pwgen Secure mode has bias towards numbers and uppercase
letters

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.15 (GNU/Linux)

iQIcBAEBAgAGBQJSXiteAAoJEBYNRVNeJnmTDn0P/2uUVFMCYJcJ8L5vWWAlrSG5
n10+s7NqviQ/qrRh+zkgM1kYpFropXrRJgjqschANmP04DbUoo1j4dYFAkO4EwFQ
FYgic/DmOO/XD6KNkd6NLl4HQIp0ceTabO0uubBWheL0uCH+GFP4MhGBPMmGeyOs
JKLCM5EK7KfzZY8bIEfkoU0qiPZGqPNTnjxW+wFVVY9cgnkuQ7yrmZVjN3uc0jfK
MEOsZQ2dLCru4Sh+AS+2xlkNO6DxgxpuH0uHONm88hEbm0Uvg7pb8oiLQpooNUKt
BCetRvr2nZqxVysjUzzs9OL0IDdnqP/ItAT4a1Bi2s+GVhlfWPMr6zbjo/47sP4X
IFeGUnb0XCA06l4lSxyqm/NDIxxx/vO13kCIeVmjj7lUn28qu/A2Mj/e/xEN38QU
joC1h3CLsRfCr8c0ZVBos4yH4vt4Ex1aMNBtghb64mB5oG0WHzjov3HmODieqVIk
YkvAbLeX88rQFNkoO6VuQzIG1v95Gn0XR/MU/wIf+zMLbgCGkWI6gGLk1Rgg2ARJ
VejHsrXjOIcJRaHQ9AfE5Ye54efVvfmZrHA9IXmdZB/VgI6DdGLzIlZSgqGHP0E2
C/nTvaHBNlOPtFyL8Dep4h83JSvlmWNPoLMfDwbPMQVQ3mt4F/HZH/ST2vzdnlLt
C3eVQaCGgtX/+eNGHJUR
=dq17
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


