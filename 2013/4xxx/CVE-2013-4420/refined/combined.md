=== Content from bugs.debian.org_17e0cd2b_20250124_184818.html ===

# Debian Bug report logs - #731860 libtar: CVE-2013-4420: directory traversal when extracting archives

[![version graph](version.cgi?width=2;absolute=0;collapse=1;fixed=libtar%2F1.2.20-2;fixed=libtar%2F1.2.16-1%2Bdeb7u2;fixed=libtar%2F1.2.11-6%2Bdeb6u2;package=src%3Alibtar;height=2)](version.cgi?fixed=libtar%2F1.2.20-2;fixed=libtar%2F1.2.16-1%2Bdeb7u2;fixed=libtar%2F1.2.11-6%2Bdeb6u2;package=src%3Alibtar;info=1;collapse=1;absolute=0)

Package:
[src:libtar](pkgreport.cgi?src=libtar);
Maintainer for [src:libtar](pkgreport.cgi?src=libtar) is [Magnus Holmgren <holmgren@debian.org>](pkgreport.cgi?maint=holmgren%40debian.org);

Reported by: [Raphael Geissert <geissert@debian.org>](pkgreport.cgi?submitter=geissert%40debian.org)

Date: Tue, 10 Dec 2013 15:30:02 UTC

Severity: *grave*

Tags: patch, security

Fixed in versions libtar/1.2.20-2, libtar/1.2.16-1+deb7u2, libtar/1.2.11-6+deb6u2

**Done:** Magnus Holmgren <holmgren@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=731860;mbox=yes), [status mbox](bugreport.cgi?bug=731860;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=731860;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Magnus Holmgren <holmgren@debian.org>`:

`Bug#731860`; Package `src:libtar`.
(Tue, 10 Dec 2013 15:30:06 GMT) ([full text](bugreport.cgi?bug=731860;msg=2), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Raphael Geissert <geissert@debian.org>`:

New Bug report received and forwarded. Copy sent to `Magnus Holmgren <holmgren@debian.org>`.
(Tue, 10 Dec 2013 15:30:06 GMT) ([full text](bugreport.cgi?bug=731860;msg=4), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=731860;msg=5), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=geissert%40debian.org)
From: Raphael Geissert <geissert@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: libtar: CVE-2013-4420: directory traversal when extracting archives
Date: Tue, 10 Dec 2013 16:27:32 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=731860;msg=5) (text/plain, inline)]
```
```
Source: libtar
Severity: grave
Tags: security

Hi,
the following vulnerability was published for libtar.

[CVE-2013-4420](https://security-tracker.debian.org/tracker/CVE-2013-4420)[0]:
tar_extract_glob and tar_extract_all path prefix directory traversal

If you fix the vulnerability please also make sure to include the
CVE (Common Vulnerabilities & Exposures) id in your changelog entry.

For further information see:

[0] <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-4420>
    <http://security-tracker.debian.org/tracker/CVE-2013-4420>

Attached is a proposed patch that makes libtar work similarly to tar.

Cheers,
--
Raphael Geissert - Debian Developer
www.debian.org - get.debian.net

```
```
[[CVE-2013-4420.patch](bugreport.cgi?att=1;bug=731860;filename=CVE-2013-4420.patch;msg=5) (text/x-patch, attachment)]
```

---

**Added tag(s) patch.**
Request was from `Petter Reinholdtsen <pere@hungry.com>`
to `control@bugs.debian.org`.
(Sat, 01 Feb 2014 18:21:04 GMT) ([full text](bugreport.cgi?bug=731860;msg=7), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=7), [link](#6)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Magnus Holmgren <holmgren@debian.org>`:

`Bug#731860`; Package `src:libtar`.
(Sun, 09 Feb 2014 21:36:30 GMT) ([full text](bugreport.cgi?bug=731860;msg=9), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=9), [link](#8)).

---

**Acknowledgement sent**
to `Magnus Holmgren <magnus@kibibyte.se>`:

Extra info received and forwarded to list. Copy sent to `Magnus Holmgren <holmgren@debian.org>`.
(Sun, 09 Feb 2014 21:36:30 GMT) ([full text](bugreport.cgi?bug=731860;msg=11), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=11), [link](#10)).

---

[Message #12](#12) received at 731860@bugs.debian.org ([full text](bugreport.cgi?bug=731860;msg=12), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=12), reply):

![](/cgi-bin/libravatar.cgi?email=magnus%40kibibyte.se)
From: Magnus Holmgren <magnus@kibibyte.se>
To: Raphael Geissert <geissert@debian.org>, 731860@bugs.debian.org
Subject: Re: Bug#731860: libtar: CVE-2013-4420: directory traversal when extracting archives
Date: Sun, 09 Feb 2014 22:08:10 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=731860;msg=12) (text/plain, inline)]
```
```
tisdagen den 10 december 2013 16.27.32 skrev du:
> [CVE-2013-4420](https://security-tracker.debian.org/tracker/CVE-2013-4420)[0]:
> tar_extract_glob and tar_extract_all path prefix directory traversal
>
> Attached is a proposed patch that makes libtar work similarly to tar.

The first "if" should be a "while", shouldn't it? Otherwise we'll only skip
over the first "../" if file_name starts with "../../", if I'm not mistaken.

--
Magnus Holmgren        holmgren@debian.org
Debian Developer
```
```
[[signature.asc](bugreport.cgi?att=1;bug=731860;filename=signature.asc;msg=12) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Magnus Holmgren <holmgren@debian.org>`:

`Bug#731860`; Package `src:libtar`.
(Tue, 11 Feb 2014 10:30:05 GMT) ([full text](bugreport.cgi?bug=731860;msg=14), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=14), [link](#13)).

---

**Acknowledgement sent**
to `Raphael Geissert <geissert@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Magnus Holmgren <holmgren@debian.org>`.
(Tue, 11 Feb 2014 10:30:05 GMT) ([full text](bugreport.cgi?bug=731860;msg=16), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=16), [link](#15)).

---

[Message #17](#17) received at 731860@bugs.debian.org ([full text](bugreport.cgi?bug=731860;msg=17), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=17), reply):

![](/cgi-bin/libravatar.cgi?email=geissert%40debian.org)
From: Raphael Geissert <geissert@debian.org>
To: Magnus Holmgren <magnus@kibibyte.se>
Cc: 731860@bugs.debian.org
Subject: Re: Bug#731860: libtar: CVE-2013-4420: directory traversal when
extracting archives
Date: Tue, 11 Feb 2014 11:26:15 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=731860;msg=17) (text/plain, inline)]
```
```
Hi,

On 9 February 2014 22:08, Magnus Holmgren <magnus@kibibyte.se> wrote:
> The first "if" should be a "while", shouldn't it? Otherwise we'll only skip
> over the first "../" if file_name starts with "../../", if I'm not mistaken.

That's handled by the while loop right after the if. Attached test
case contains an entry called ../../../empty-file
tar tf should print a warning message and list the full path, while
libtar should simply print it as 'empty-file'.

Cheers,
--
Raphael Geissert - Debian Developer
www.debian.org - get.debian.net

```
```
[[triple-double-dot.tar](bugreport.cgi?att=1;bug=731860;filename=triple-double-dot.tar;msg=17) (application/x-tar, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#731860`; Package `src:libtar`.
(Thu, 13 Feb 2014 18:51:11 GMT) ([full text](bugreport.cgi?bug=731860;msg=19), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=19), [link](#18)).

---

**Acknowledgement sent**
to `Magnus Holmgren <holmgren@debian.org>`:

Extra info received and forwarded to list.
(Thu, 13 Feb 2014 18:51:11 GMT) ([full text](bugreport.cgi?bug=731860;msg=21), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=21), [link](#20)).

---

[Message #22](#22) received at 731860@bugs.debian.org ([full text](bugreport.cgi?bug=731860;msg=22), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=22), reply):

![](/cgi-bin/libravatar.cgi?email=holmgren%40debian.org)
From: Magnus Holmgren <holmgren@debian.org>
To: Raphael Geissert <geissert@debian.org>, 731860@bugs.debian.org
Subject: Re: Bug#731860: libtar: CVE-2013-4420: directory traversal when extracting archives
Date: Thu, 13 Feb 2014 19:23:19 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=731860;msg=22) (text/plain, inline)]
```
```
tisdagen den 11 februari 2014 11.26.15 skrev du:
> On 9 February 2014 22:08, Magnus Holmgren <magnus@kibibyte.se> wrote:
> > The first "if" should be a "while", shouldn't it? Otherwise we'll only
> > skip
> > over the first "../" if file_name starts with "../../", if I'm not
> > mistaken.
> That's handled by the while loop right after the if. Attached test
> case contains an entry called ../../../empty-file
> tar tf should print a warning message and list the full path, while
> libtar should simply print it as 'empty-file'.

Yes, an odd number of ".." will yield the desired result, but the even ".."s
will be missed. We should also strip any leading slashes to be of any use, so
I'll add that too.

--
Magnus Holmgren        holmgren@debian.org
Debian Developer
```
```
[[signature.asc](bugreport.cgi?att=1;bug=731860;filename=signature.asc;msg=22) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Magnus Holmgren <holmgren@debian.org>`:

`Bug#731860`; Package `src:libtar`.
(Fri, 14 Feb 2014 15:15:04 GMT) ([full text](bugreport.cgi?bug=731860;msg=24), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=24), [link](#23)).

---

**Acknowledgement sent**
to `Raphael Geissert <geissert@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Magnus Holmgren <holmgren@debian.org>`.
(Fri, 14 Feb 2014 15:15:04 GMT) ([full text](bugreport.cgi?bug=731860;msg=26), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=26), [link](#25)).

---

[Message #27](#27) received at 731860@bugs.debian.org ([full text](bugreport.cgi?bug=731860;msg=27), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=27), reply):

![](/cgi-bin/libravatar.cgi?email=geissert%40debian.org)
From: Raphael Geissert <geissert@debian.org>
To: Magnus Holmgren <holmgren@debian.org>
Cc: 731860@bugs.debian.org
Subject: Re: Bug#731860: libtar: CVE-2013-4420: directory traversal when
extracting archives
Date: Fri, 14 Feb 2014 16:10:32 +0100
```
On 13 February 2014 19:23, Magnus Holmgren <holmgren@debian.org> wrote:
> tisdagen den 11 februari 2014 11.26.15 skrev du:
>> On 9 February 2014 22:08, Magnus Holmgren <magnus@kibibyte.se> wrote:
>> > The first "if" should be a "while", shouldn't it? Otherwise we'll only
>> > skip
>> > over the first "../" if file_name starts with "../../", if I'm not
>> > mistaken.
>> That's handled by the while loop right after the if. Attached test
>> case contains an entry called ../../../empty-file
>> tar tf should print a warning message and list the full path, while
>> libtar should simply print it as 'empty-file'.
>
> Yes, an odd number of ".." will yield the desired result, but the even ".."s
> will be missed.

Ah, yes, indeed. Nice catch.

Cheers,
--
Raphael Geissert - Debian Developer
www.debian.org - get.debian.net

```

---

**Reply sent**
to `Magnus Holmgren <holmgren@debian.org>`:

You have taken responsibility.
(Sat, 15 Feb 2014 21:24:13 GMT) ([full text](bugreport.cgi?bug=731860;msg=29), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=29), [link](#28)).

---

**Notification sent**
to `Raphael Geissert <geissert@debian.org>`:

Bug acknowledged by developer.
(Sat, 15 Feb 2014 21:24:13 GMT) ([full text](bugreport.cgi?bug=731860;msg=31), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=31), [link](#30)).

---

[Message #32](#32) received at 731860-close@bugs.debian.org ([full text](bugreport.cgi?bug=731860;msg=32), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=32), reply):

![](/cgi-bin/libravatar.cgi?email=holmgren%40debian.org)
From: Magnus Holmgren <holmgren@debian.org>
To: 731860-close@bugs.debian.org
Subject: Bug#731860: fixed in libtar 1.2.20-2
Date: Sat, 15 Feb 2014 21:20:56 +0000
```
Source: libtar
Source-Version: 1.2.20-2

We believe that the bug you reported is fixed in the latest version of
libtar, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 731860@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Magnus Holmgren <holmgren@debian.org> (supplier of updated libtar package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Sat, 15 Feb 2014 21:49:37 +0100
Source: libtar
Binary: libtar-dev libtar0
Architecture: source amd64
Version: 1.2.20-2
Distribution: unstable
Urgency: low
Maintainer: Magnus Holmgren <holmgren@debian.org>
Changed-By: Magnus Holmgren <holmgren@debian.org>
Description:
 libtar-dev - C library for manipulating tar archives (development files)
 libtar0    - C library for manipulating tar archives
Closes: [657116](bugreport.cgi?bug=657116) [731860](bugreport.cgi?bug=731860)
Changes:
 libtar (1.2.20-2) unstable; urgency=low
 .
   * no_static_buffers.patch: avoid using a static buffer in
     th_get_pathname(). Taken from upstream. Needed for no_maxpathlen.patch.
   * maxpathlen.patch: Fix FTBFS on Hurd by dynamically allocating path
     names (Closes: #[657116](bugreport.cgi?bug=657116)). Thanks to Svante Signell and Petter
     Reinholdtsen.
   * [SECURITY] [CVE-2013-4420](https://security-tracker.debian.org/tracker/CVE-2013-4420).patch: Strip out leading slashes and any
     pathname prefix containing ".." components (Closes: #[731860](bugreport.cgi?bug=731860)). This is
     done in th_get_pathname() (as well as to symlink targets when
     extracting symlinks), not merely when extracting files, which means
     applications calling that function will not see the stored
     filename. There is no way to disable this behaviour, but it can be
     expected that one will be provided when the issue is solved upstream.
   * Bump Standards-Version to 3.9.5.
Checksums-Sha1:
 d8a14e21ae8bbd2f1d95f1280d80791680f83beb 1223 libtar_1.2.20-2.dsc
 92e353b7d07f71c75e34f6f1ac87b4b803eb2f1c 8716 libtar_1.2.20-2.debian.tar.xz
 1cdb02634deb09ab9655640adc055fdf864ffa22 41914 libtar-dev_1.2.20-2_amd64.deb
 c0714924c81c94a433d1dcf7a51e41aab210ae66 22316 libtar0_1.2.20-2_amd64.deb
Checksums-Sha256:
 3676db500b4a5cdb252a06303e9e8538243e00465227abc83c149b32f6d0d37f 1223 libtar_1.2.20-2.dsc
 5ea31fcaf5c5ba6a1332ef4159c6e52ed54c311881aa72251f36034995fbd816 8716 libtar_1.2.20-2.debian.tar.xz
 ba371e469520f1cadcd60eafd0db0f18c82deeea0ea23099353b4cbcc6d5c727 41914 libtar-dev_1.2.20-2_amd64.deb
 db241179e88f0022eca8244cc51dcb27aedc6efc8f0d569a50261329ffeeca49 22316 libtar0_1.2.20-2_amd64.deb
Files:
 348c774fef2bb4eb3b249867a340f970 1223 libs optional libtar_1.2.20-2.dsc
 7bde420892804a86c9f4c3ac3e945902 8716 libs optional libtar_1.2.20-2.debian.tar.xz
 064ce167bbc62a997a68a38d55c2fbba 41914 libdevel optional libtar-dev_1.2.20-2_amd64.deb
 26ce4fdde5392135373285ac13d67e7b 22316 libs optional libtar0_1.2.20-2_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iEYEAREIAAYFAlL/1BcACgkQk7mRNn1h4+bTGwCfbWMxnN0+iRjfzdLNfE6IJvo/
FoEAnRjXkIJaTH89HhrtmidEkNeErBgh
=pXuc
-----END PGP SIGNATURE-----

```

---

**Reply sent**
to `Magnus Holmgren <holmgren@debian.org>`:

You have taken responsibility.
(Mon, 24 Feb 2014 21:51:11 GMT) ([full text](bugreport.cgi?bug=731860;msg=34), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=34), [link](#33)).

---

**Notification sent**
to `Raphael Geissert <geissert@debian.org>`:

Bug acknowledged by developer.
(Mon, 24 Feb 2014 21:51:11 GMT) ([full text](bugreport.cgi?bug=731860;msg=36), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=36), [link](#35)).

---

[Message #37](#37) received at 731860-close@bugs.debian.org ([full text](bugreport.cgi?bug=731860;msg=37), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=37), reply):

![](/cgi-bin/libravatar.cgi?email=holmgren%40debian.org)
From: Magnus Holmgren <holmgren@debian.org>
To: 731860-close@bugs.debian.org
Subject: Bug#731860: fixed in libtar 1.2.16-1+deb7u2
Date: Mon, 24 Feb 2014 21:47:17 +0000
```
Source: libtar
Source-Version: 1.2.16-1+deb7u2

We believe that the bug you reported is fixed in the latest version of
libtar, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 731860@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Magnus Holmgren <holmgren@debian.org> (supplier of updated libtar package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Sun, 16 Feb 2014 19:12:18 +0100
Source: libtar
Binary: libtar-dev libtar0
Architecture: source amd64
Version: 1.2.16-1+deb7u2
Distribution: wheezy-security
Urgency: low
Maintainer: Magnus Holmgren <holmgren@debian.org>
Changed-By: Magnus Holmgren <holmgren@debian.org>
Description:
 libtar-dev - C library for manipulating tar archives (development files)
 libtar0    - C library for manipulating tar archives
Closes: [731860](bugreport.cgi?bug=731860)
Changes:
 libtar (1.2.16-1+deb7u2) wheezy-security; urgency=low
 .
   * [SECURITY] [CVE-2013-4420](https://security-tracker.debian.org/tracker/CVE-2013-4420).patch: Strip out leading slashes and any
     pathname prefix containing ".." components (Closes: #[731860](bugreport.cgi?bug=731860)). This is
     done in th_get_pathname() (as well as to symlink targets when
     extracting symlinks), not merely when extracting files, which means
     applications calling that function will not see the stored
     filename. There is no way to disable this behaviour, but it can be
     expected that one will be provided when the issue is solved upstream.
   * th_get_size-unsigned-int.patch: Make the th_get_size() macro cast the
     result from oct_to_int() to unsigned int. This is the right fix for
     bug #725938 on 64-bit systems, where a specially crafted tar file
     would not cause an integer overflow, but a memory allocation of almost
     16 exbibytes, which would certainly fail outright without harm.
Checksums-Sha1:
 802ffdebb5f65af2e74f65f9b5a503b5e0d53855 1251 libtar_1.2.16-1+deb7u2.dsc
 18afc654c0f8a212d5b958e4b7875919ba642d45 7707 libtar_1.2.16-1+deb7u2.debian.tar.gz
 c169e3aa47d06f244db8c2c779efcad9c6ce33dd 46670 libtar-dev_1.2.16-1+deb7u2_amd64.deb
 05594ff225883b61b75a4aa065336c36487dfbc5 25210 libtar0_1.2.16-1+deb7u2_amd64.deb
Checksums-Sha256:
 b63c5e990dccc47c6e969849cbe151510516459e3ba975135c3f6ed4f6816ace 1251 libtar_1.2.16-1+deb7u2.dsc
 1cfa13f3a03db741ad8caf21cd28ba171cab26f0edf7f1d3227d0661ab47d572 7707 libtar_1.2.16-1+deb7u2.debian.tar.gz
 6ab5b85bb870d5b728904898620306e03dcbac2feeb61965ddca22fb9d6dafb8 46670 libtar-dev_1.2.16-1+deb7u2_amd64.deb
 2af1b13ed40acbc856e1430c4a1cf90832efe814aae51d9f8522bd7e943fdbec 25210 libtar0_1.2.16-1+deb7u2_amd64.deb
Files:
 dee0c9ae99dcd5c12a887ede6e50f645 1251 libs optional libtar_1.2.16-1+deb7u2.dsc
 fe4bd92a58df28f61b943fcaf8b439f5 7707 libs optional libtar_1.2.16-1+deb7u2.debian.tar.gz
 c35289858ccbeded669071349793b833 46670 libdevel optional libtar-dev_1.2.16-1+deb7u2_amd64.deb
 50ffe04c880ae9319c6c4f05aedeeabd 25210 libs optional libtar0_1.2.16-1+deb7u2_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iEYEAREIAAYFAlMBCYYACgkQk7mRNn1h4+bhUACeIzUS2mmZ429Jzs3z4jo0m8nr
whcAmgJEDIxrnHYNmgjX7vWSd3ypSLcL
=zEq8
-----END PGP SIGNATURE-----

```

---

**Reply sent**
to `Magnus Holmgren <holmgren@debian.org>`:

You have taken responsibility.
(Mon, 24 Feb 2014 21:51:15 GMT) ([full text](bugreport.cgi?bug=731860;msg=39), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=39), [link](#38)).

---

**Notification sent**
to `Raphael Geissert <geissert@debian.org>`:

Bug acknowledged by developer.
(Mon, 24 Feb 2014 21:51:15 GMT) ([full text](bugreport.cgi?bug=731860;msg=41), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=41), [link](#40)).

---

[Message #42](#42) received at 731860-close@bugs.debian.org ([full text](bugreport.cgi?bug=731860;msg=42), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=42), reply):

![](/cgi-bin/libravatar.cgi?email=holmgren%40debian.org)
From: Magnus Holmgren <holmgren@debian.org>
To: 731860-close@bugs.debian.org
Subject: Bug#731860: fixed in libtar 1.2.11-6+deb6u2
Date: Mon, 24 Feb 2014 21:47:47 +0000
```
Source: libtar
Source-Version: 1.2.11-6+deb6u2

We believe that the bug you reported is fixed in the latest version of
libtar, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 731860@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Magnus Holmgren <holmgren@debian.org> (supplier of updated libtar package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Sun, 16 Feb 2014 19:44:16 +0100
Source: libtar
Binary: libtar-dev libtar
Architecture: source amd64
Version: 1.2.11-6+deb6u2
Distribution: squeeze-security
Urgency: low
Maintainer: Julien Danjou <acid@debian.org>
Changed-By: Magnus Holmgren <holmgren@debian.org>
Description:
 libtar     - C library for manipulating tar archives
 libtar-dev - C library for manipulating tar archives
Closes: [731860](bugreport.cgi?bug=731860)
Changes:
 libtar (1.2.11-6+deb6u2) squeeze-security; urgency=low
 .
   * [SECURITY] [CVE-2013-4420](https://security-tracker.debian.org/tracker/CVE-2013-4420): Strip out leading slashes and any
     pathname prefix containing ".." components (Closes: #[731860](bugreport.cgi?bug=731860)). This is
     done in th_get_pathname() (as well as to symlink targets when
     extracting symlinks), not merely when extracting files, which means
     applications calling that function will not see the stored
     filename. There is no way to disable this behaviour, but it can be
     expected that one will be provided when the issue is solved upstream.
   * Make the th_get_size() macro cast the result from oct_to_int() to
     unsigned int. This is the right fix for bug #725938 on 64-bit systems,
     where a specially crafted tar file would not cause an integer
     overflow, but a memory allocation of almost 16 exbibytes, which would
     certainly fail outright without harm.
Checksums-Sha1:
 0e62e21f544aa5328c0343a16b0804cfe2eee6a9 993 libtar_1.2.11-6+deb6u2.dsc
 e88a7588de51d6801f718f39174e49f6b138d966 255994 libtar_1.2.11-6+deb6u2.diff.gz
 ca9a8af73d5d9b23724efd7b18e32f0f00775203 43842 libtar-dev_1.2.11-6+deb6u2_amd64.deb
 cf11a974e638479f39e1896677ece6736787ff7d 22528 libtar_1.2.11-6+deb6u2_amd64.deb
Checksums-Sha256:
 d2da6cf7d6eb5f46106cbd3bf7827f6ad165fb9abd8ecdc0d9a624cf522b83a6 993 libtar_1.2.11-6+deb6u2.dsc
 6b1062f74f7ac9312e78547975c6af0cfcc6dfce8bd0abf3b84652f0d5ddb4c6 255994 libtar_1.2.11-6+deb6u2.diff.gz
 25e5258a01ce26ee5bdf27133463a9fe462a040708673d485ae11d898daea5e3 43842 libtar-dev_1.2.11-6+deb6u2_amd64.deb
 46eb6cd01ec6c3596e754409f0e0a1b307760f2cbfe87c4c116b6071cb5a9cea 22528 libtar_1.2.11-6+deb6u2_amd64.deb
Files:
 992791ab99bc37e4cd287f8e6cf1887a 993 libs optional libtar_1.2.11-6+deb6u2.dsc
 510f0207b558d6fb4f33b21e698bc506 255994 libs optional libtar_1.2.11-6+deb6u2.diff.gz
 13b1b12dc47bd95bdca8dab4e714fdb7 43842 libdevel optional libtar-dev_1.2.11-6+deb6u2_amd64.deb
 4a07935413607502a32fca4241f7221a 22528 libs optional libtar_1.2.11-6+deb6u2_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iEYEAREIAAYFAlMDov0ACgkQk7mRNn1h4+Zj9wCffn1DOV8ICwEZQ/Kq8V/UA4m/
0PYAn2QntrBgaWO5Im21dbX8+XA6upOh
=wvG+
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 27 Apr 2014 07:34:15 GMT) ([full text](bugreport.cgi?bug=731860;msg=44), [mbox](bugreport.cgi?bug=731860;mbox=yes;msg=44), [link](#43)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=731860).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 18:48:17 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from www.debian.org_0e82d229_20250124_184816.html ===


---

[[Date Prev](msg00033.html)][[Date Next](msg00035.html)]
[[Thread Prev](msg00033.html)][[Thread Next](msg00035.html)]
[[Date Index](maillist.html#00034)]
[[Thread Index](threads.html#00034)]

# [SECURITY] [DSA 2863-1] libtar security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2863-1] libtar security update
* *From*: Luciano Bello <luciano@debian.org>
* *Date*: Tue, 18 Feb 2014 23:13:08 +0100
* *Message-id*: <[[🔎]](/msgid-search/2361923.PIvVWQteCL%40mybox) [2361923.PIvVWQteCL@mybox](msg00034.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2863-1                   security@debian.org
<http://www.debian.org/security/>                             Luciano Bello
February 18, 2014                      <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : libtar
Vulnerability  : directory traversal
CVE ID         : CVE-2013-4420
Debian Bug     : 731860

A directory traversal attack was reported against libtar, a C library for
manipulating tar archives. The application does not validate the
filenames inside the tar archive, allowing to extract files in arbitrary
path. An attacker can craft a tar file to override files beyond the
tar_extract_glob and tar_extract_all prefix parameter.

For the oldstable distribution (squeeze), this problem has been fixed in
version 1.2.11-6+deb6u2.

For the stable distribution (wheezy), this problem has been fixed in
version 1.2.16-1+deb7u2.

For the unstable distribution (sid), this problem has been fixed in
version 1.2.20-2.

We recommend that you upgrade your libtar packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iEYEARECAAYFAlMD2k4ACgkQQWTRs4lLtHkipgCfYa2NgP/BZLJLKcVKHWV37FQt
Vu4AoKKS7cw7dBZXm1X/3nVvpBxyv1fA
=5swt
-----END PGP SIGNATURE-----

```

---



=== Content from security-tracker.debian.org_a496ccea_20250126_025303.html ===

# CVE-2013-4420

| **Name** | CVE-2013-4420 |
| --- | --- |
| **Description** | Multiple directory traversal vulnerabilities in the (1) tar\_extract\_glob and (2) tar\_extract\_all functions in libtar 1.2.20 and earlier allow remote attackers to overwrite arbitrary files via a .. (dot dot) in a crafted tar file. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2013-4420) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2013-4420); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2013-4420), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2013-4420), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2013-4420), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2013-4420), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-4420), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2013-4420), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2013-4420), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2013-4420)/[CVE](https://www.suse.com/security/cve/CVE-2013-4420/), GitHub [advisories](https://github.com/advisories?query=CVE-2013-4420)/[code](https://github.com/search?type=Code&q=%22CVE-2013-4420%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2013-4420%22), [web search](https://duckduckgo.com/html?q=%22CVE-2013-4420%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DSA-2863-1](/tracker/DSA-2863-1) |
| **Debian Bugs** | [731860](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=731860) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [libtar](/tracker/source-package/libtar) ([PTS](https://tracker.debian.org/pkg/libtar)) | bookworm, bullseye | 1.2.20-8 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [libtar](/tracker/source-package/libtar) | source | squeeze | 1.2.11-6+deb6u2 |  | [DSA-2863-1](/tracker/DSA-2863-1) |  |
| [libtar](/tracker/source-package/libtar) | source | wheezy | 1.2.16-1+deb7u2 |  | [DSA-2863-1](/tracker/DSA-2863-1) |  |
| [libtar](/tracker/source-package/libtar) | source | (unstable) | 1.2.20-2 |  |  | [731860](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=731860) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)


