=== Content from secunia.com_8ee86f6b_20250124_184047.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from wordpress.org_d8cac145_20250124_184050.html ===

[Skip to content](#content)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Forums](https://wordpress.org/support/forums/)

* [Welcome to Support](https://wordpress.org/support/welcome/)
* [Guidelines](https://wordpress.org/support/guidelines/)
* [Get involved](https://make.wordpress.org/support/handbook/contributing-to-the-wordpress-forums/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fsupport%2Ftopic%2Fsecurity-issue-web-application-cross-site-scripting&locale=en_US)

* [Welcome to Support](https://wordpress.org/support/welcome/)
* [Guidelines](https://wordpress.org/support/guidelines/)
* [Get involved](https://make.wordpress.org/support/handbook/contributing-to-the-wordpress-forums/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fsupport%2Ftopic%2Fsecurity-issue-web-application-cross-site-scripting&locale=en_US)

[Skip to content](#main)

[Home](https://wordpress.org/support/forums/) / Plugin: [Registration Forms – User Registration Forms, Invitation-Based Registrations, Front-end User Profile, Login Form & Content Restriction](https://wordpress.org/support/plugin/pie-register/) / Security Issue: Web Application Cross Site Scripting

Search for:

Search forums

# Security Issue: Web Application Cross Site Scripting

* Resolved
  [![](https://secure.gravatar.com/avatar/a1f952dcb9af683b5f66f5b92c508d04f53eb290a8c1023ebb48bb8e3e78451d?s=100&d=retro&r=g)gravitylover](https://wordpress.org/support/users/gravitylover/ "View gravitylover's profile")

  (@gravitylover)

  [11 years, 6 months ago](https://wordpress.org/support/topic/security-issue-web-application-cross-site-scripting/ "July 10, 2013 at 12:46 pm")

  Input is not santized before being output on the screen:

  <?php echo $\_POST[‘pass1’];?>

  <?php echo $\_POST[‘pass2’];?>

  Should be:

  <?php echo htmlspecialchars($\_POST[‘pass1’]);?>

  <?php echo htmlspecialchars($\_POST[‘pass2’]);?>

  <http://wordpress.org/extend/plugins/pie-register/>

Viewing 4 replies - 1 through 4 (of 4 total)

* Plugin Contributor
  [![](https://secure.gravatar.com/avatar/12d23844e79744b137ac8dca1dcd4d342243f83e85df6ff43b1af6fbc8d5c333?s=100&d=retro&r=g)genetech](https://wordpress.org/support/users/genetech/ "View genetech's profile")

  (@genetech)

  [11 years, 6 months ago](https://wordpress.org/support/topic/security-issue-web-application-cross-site-scripting/#post-3918044 "July 11, 2013 at 1:22 am")

  no needed, since we are already sanitizing before inserting into the database.

  Thread Starter
  [![](https://secure.gravatar.com/avatar/a1f952dcb9af683b5f66f5b92c508d04f53eb290a8c1023ebb48bb8e3e78451d?s=100&d=retro&r=g)gravitylover](https://wordpress.org/support/users/gravitylover/ "View gravitylover's profile")

  (@gravitylover)

  [11 years, 6 months ago](https://wordpress.org/support/topic/security-issue-web-application-cross-site-scripting/#post-3918056 "July 11, 2013 at 8:27 am")

  It still allows the user to output an iframe onto the page and other malicious code

  Thread Starter
  [![](https://secure.gravatar.com/avatar/a1f952dcb9af683b5f66f5b92c508d04f53eb290a8c1023ebb48bb8e3e78451d?s=100&d=retro&r=g)gravitylover](https://wordpress.org/support/users/gravitylover/ "View gravitylover's profile")

  (@gravitylover)

  [11 years, 6 months ago](https://wordpress.org/support/topic/security-issue-web-application-cross-site-scripting/#post-3918057 "July 11, 2013 at 8:28 am")

  Send a demo wp link and I will illustrate the vulnerability

  Plugin Contributor
  [![](https://secure.gravatar.com/avatar/12d23844e79744b137ac8dca1dcd4d342243f83e85df6ff43b1af6fbc8d5c333?s=100&d=retro&r=g)genetech](https://wordpress.org/support/users/genetech/ "View genetech's profile")

  (@genetech)

  [11 years, 6 months ago](https://wordpress.org/support/topic/security-issue-web-application-cross-site-scripting/#post-3918121 "July 15, 2013 at 10:17 am")

  It has been fixed now! Please upgrade to the latest version of plugin.

Viewing 4 replies - 1 through 4 (of 4 total)

* The topic ‘Security Issue: Web Application Cross Site Scripting’ is closed to new replies.

* ![](https://ps.w.org/pie-register/assets/icon-256x256.png?rev=2467686)
* [Registration Forms – User Registration Forms, Invitation-Based Registrations, Front-end User Profile, Login Form & Content Restriction](https://wordpress.org/plugins/pie-register/)
* [Frequently Asked Questions](https://wordpress.org/plugins/pie-register/#faq)
* [Support Threads](https://wordpress.org/support/plugin/pie-register/)
* [Active Topics](https://wordpress.org/support/plugin/pie-register/active/)
* [Unresolved Topics](https://wordpress.org/support/plugin/pie-register/unresolved/)
* [Reviews](https://wordpress.org/support/plugin/pie-register/reviews/)

* In: [Plugins](https://wordpress.org/support/forum/plugins-and-hacks/)
* 4 replies
* 2 participants
* Last reply from: [genetech](https://wordpress.org/support/users/genetech/ "View genetech's profile")
* Last activity: [11 years, 6 months ago](https://wordpress.org/support/topic/security-issue-web-application-cross-site-scripting/#post-3918121 "July 15, 2013 at 10:17 am")
* Status: resolved

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_bd51ae5e_20250124_184047.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D740249%2540pie-register%26old%3D740249%2540pie-register)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/740247/pie-register "Changeset 740247 for pie-register")
* [Next Change](/changeset/740250/pie-register "Changeset 740250 for pie-register") →

---

# Changeset [740249](/changeset/740249 "Show full changeset") for [pie-register](/browser/pie-register?rev=740249 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
07/13/2013 10:34:12 AM
([12 years](/timeline?from=2013-07-13T10%3A34%3A12Z&precision=second "See timeline at 07/13/2013 10:34:12 AM") ago)

Author:
genetech
Message:

version 1.31

Location:
[pie-register/trunk](/browser/pie-register/trunk?rev=740249)
Files:

5 edited

* [menus/pieregisterSettings.php](/browser/pie-register/trunk/menus/pieregisterSettings.php?rev=740249 "Show entry in browser")
  (modified)
  ([5 diffs](#file0 "Show differences"))
* [pie-register.php](/browser/pie-register/trunk/pie-register.php?rev=740249 "Show entry in browser")
  (modified)
  ([38 diffs](#file1 "Show differences"))
* [piewpnun.php](/browser/pie-register/trunk/piewpnun.php?rev=740249 "Show entry in browser")
  (modified)
  ([2 diffs](#file2 "Show differences"))
* [readme.txt](/browser/pie-register/trunk/readme.txt?rev=740249 "Show entry in browser")
  (modified)
  ([3 diffs](#file3 "Show differences"))
* [recaptchalib.php](/browser/pie-register/trunk/recaptchalib.php?rev=740249 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [pie-register/trunk/menus/pieregisterSettings.php](/changeset/740249/pie-register/trunk/menus/pieregisterSettings.php "Show the changeset 740249 restricted to pie-register/trunk/menus/pieregisterSettings.php")

  | [r738939](/browser/pie-register/trunk/menus/pieregisterSettings.php?rev=738939#L287 "Show revision 738939 of this file in browser") | [r740249](/browser/pie-register/trunk/menus/pieregisterSettings.php?rev=740249#L287 "Show revision 740249 of this file in browser") |  |
  | --- | --- | --- |
  | 287 | 287 | <?php \_e('Disclaimer Title','piereg');?> |
  | 288 | 288 | </label> |
  | 289 |  | <input type="text" name="piereg\_disclaimer\_title" id="disclaimer\_title" value="<?php echo ~~$piereg['disclaimer\_title']~~;?>" /> |
  |  | 289 | <input type="text" name="piereg\_disclaimer\_title" id="disclaimer\_title" value="<?php echo html\_entity\_decode($piereg['disclaimer\_title']);?>" /> |
  | 290 | 290 | <br /> |
  | 291 | 291 | <label for="disclaimer\_content"> |
  | […](/browser/pie-register/trunk/menus/pieregisterSettings.php?rev=738939#L293) | […](/browser/pie-register/trunk/menus/pieregisterSettings.php?rev=740249#L293) |  |
  | 293 | 293 | </label> |
  | 294 | 294 | <br /> |
  | 295 |  | <textarea name="piereg\_disclaimer\_content" id="disclaimer\_content" cols="25" rows="10" style="width:80%;height:300px;display:block;"><?php echo ~~stripslashes~~($piereg['disclaimer\_content']);?></textarea> |
  |  | 295 | <textarea name="piereg\_disclaimer\_content" id="disclaimer\_content" cols="25" rows="10" style="width:80%;height:300px;display:block;"><?php echo html\_entity\_decode($piereg['disclaimer\_content']);?></textarea> |
  | 296 | 296 | <br /> |
  | 297 | 297 | <label for="disclaimer\_agree"> |
  | 298 | 298 | <?php \_e('Agreement Text','piereg');?> |
  | 299 | 299 | </label> |
  | 300 |  | <input type="text" name="piereg\_disclaimer\_agree" id="disclaimer\_agree" value="<?php echo ~~$piereg['disclaimer\_agree']~~;?>" /> |
  |  | 300 | <input type="text" name="piereg\_disclaimer\_agree" id="disclaimer\_agree" value="<?php echo ($piereg['disclaimer\_agree']);?>" /> |
  | 301 | 301 | </div></td> |
  | 302 | 302 | </tr> |
  | […](/browser/pie-register/trunk/menus/pieregisterSettings.php?rev=738939#L313) | […](/browser/pie-register/trunk/menus/pieregisterSettings.php?rev=740249#L313) |  |
  | 313 | 313 | <?php \_e('License Title','piereg');?> |
  | 314 | 314 | </label> |
  | 315 |  | <input type="text" name="piereg\_license\_title" id="license\_title" value="<?php echo ~~$piereg['license\_title']~~;?>" /> |
  |  | 315 | <input type="text" name="piereg\_license\_title" id="license\_title" value="<?php echo ($piereg['license\_title']);?>" /> |
  | 316 | 316 | <br /> |
  | 317 | 317 | <label for="license\_content"> |
  | […](/browser/pie-register/trunk/menus/pieregisterSettings.php?rev=738939#L319) | […](/browser/pie-register/trunk/menus/pieregisterSettings.php?rev=740249#L319) |  |
  | 319 | 319 | </label> |
  | 320 | 320 | <br /> |
  | 321 |  | <textarea name="piereg\_license\_content" id="license\_content" cols="25" rows="10" style="width:80%;height:300px;display:block;"><?php echo ~~stripslashes~~($piereg['license\_content']);?></textarea> |
  |  | 321 | <textarea name="piereg\_license\_content" id="license\_content" cols="25" rows="10" style="width:80%;height:300px;display:block;"><?php echo html\_entity\_decode($piereg['license\_content']);?></textarea> |
  | 322 | 322 | <br /> |
  | 323 | 323 | <label for="license\_agree"> |
  | 324 | 324 | <?php \_e('Agreement Text','piereg');?> |
  | 325 | 325 | </label> |
  | 326 |  | <input type="text" name="piereg\_license\_agree" id="license\_agree" value="<?php echo ~~$piereg['license\_agree']~~;?>" /> |
  |  | 326 | <input type="text" name="piereg\_license\_agree" id="license\_agree" value="<?php echo ($piereg['license\_agree']);?>" /> |
  | 327 | 327 | </div></td> |
  | 328 | 328 | </tr> |
  | […](/browser/pie-register/trunk/menus/pieregisterSettings.php?rev=738939#L345) | […](/browser/pie-register/trunk/menus/pieregisterSettings.php?rev=740249#L345) |  |
  | 345 | 345 | </label> |
  | 346 | 346 | <br /> |
  | 347 |  | <textarea name="piereg\_privacy\_content" id="privacy\_content" cols="25" rows="10" style="width:80%;height:300px;display:block;"><?php echo ~~stripslashes~~($piereg['privacy\_content']);?></textarea> |
  |  | 347 | <textarea name="piereg\_privacy\_content" id="privacy\_content" cols="25" rows="10" style="width:80%;height:300px;display:block;"><?php echo html\_entity\_decode($piereg['privacy\_content']);?></textarea> |
  | 348 | 348 | <br /> |
  | 349 | 349 | <label for="privacy\_agree"> |
* ## [pie-register/trunk/pie-register.php](/changeset/740249/pie-register/trunk/pie-register.php "Show the changeset 740249 restricted to pie-register/trunk/pie-register.php")

  | [r738939](/browser/pie-register/trunk/pie-register.php?rev=738939#L7 "Show revision 738939 of this file in browser") | [r740249](/browser/pie-register/trunk/pie-register.php?rev=740249#L7 "Show revision 740249 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 |  |
  | 8 | 8 | Author: Genetech |
  | 9 |  | Version: 1.3~~0~~ |
  |  | 9 | Version: 1.31 |
  | 10 | 10 | Author URI: http://www.genetechsolutions.com/ |
  | 11 | 11 |  |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L37) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L37) |  |
  | 37 | 37 | private $ipn\_debug; |
  | 38 | 38 | var $holdmsg = ''; |
  |  | 39 | public $headmsg=''; |
  |  | 40 | public $bodymsg=''; |
  | 39 | 41 | /\*\* |
  | 40 | 42 | \* Constructor |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L94) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L96) |  |
  | 94 | 96 | array\_walk\_recursive($\_REQUEST, array(&$this,'disable\_magic\_quotes\_gpc')); |
  | 95 | 97 | } |
  |  | 98 |  |
  | 96 | 99 | if( ($this->ref == $this->admin\_edit\_profile\_page) || ($this->ref == $this->admin\_own\_profile\_page) ){ |
  | 97 | 100 | add\_action( 'admin\_head', array($this, 'ProfilesHead') ); |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L601) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L604) |  |
  | 601 | 604 | if(isset($\_POST['email\_notification\_page'])){ |
  | 602 | 605 |  |
  | 603 |  | $update['html'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_html']~~); |
  | 604 |  | $update['from'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_from']~~); |
  | 605 |  | $update['fromname'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_fromname']~~); |
  | 606 |  | $update['subject'] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_subject']~~)); |
  | 607 |  | $update['custom\_msg'] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_custom\_msg']~~)); |
  |  | 606 | $update['html'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_html'],'HTML-ENTITIES','utf-8')); |
  |  | 607 | $update['from'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_from'],'HTML-ENTITIES','utf-8')); |
  |  | 608 | $update['fromname'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_fromname'],'HTML-ENTITIES','utf-8')); |
  |  | 609 | $update['subject'] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_subject'],'HTML-ENTITIES','utf-8'))); |
  |  | 610 | $update['custom\_msg'] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_custom\_msg'],'HTML-ENTITIES','utf-8'))); |
  | 608 | 611 | $update['user\_nl2br'] = $this->disable\_magic\_quotes\_gpc(htmlentities($\_POST['piereg\_user\_nl2br'])); |
  | 609 | 612 | $update['user\_nl2br'] = $this->disable\_magic\_quotes\_gpc(htmlentities($\_POST['piereg\_emailvmsguser\_nl2br'])); |
  | 610 | 613 | $update['user\_nl2br'] = $this->disable\_magic\_quotes\_gpc(htmlentities($\_POST['piereg\_adminvmsguser\_nl2br'])); |
  | 611 |  | $update['msg'] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_msg']~~)); |
  | 612 |  | $update['adminvmsg'] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_adminvmsg']~~)); |
  | 613 |  | $update['emailvmsg'] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_emailvmsg']~~)); |
  |  | 614 | $update['msg'] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_msg'],'HTML-ENTITIES','utf-8'))); |
  |  | 615 | $update['adminvmsg'] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_adminvmsg'],'HTML-ENTITIES','utf-8'))); |
  |  | 616 | $update['emailvmsg'] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_emailvmsg'],'HTML-ENTITIES','utf-8'))); |
  | 614 | 617 | $update['disable\_admin'] = $this->disable\_magic\_quotes\_gpc(htmlentities($\_POST['piereg\_disable\_admin'])); |
  | 615 | 618 | $update['adminhtml'] = $this->disable\_magic\_quotes\_gpc(htmlentities($\_POST['piereg\_adminhtml'])); |
  | 616 |  | $update['adminfrom'] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_adminfrom']~~)); |
  | 617 |  | $update['adminfromname'] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_adminfromname']~~)); |
  | 618 |  | $update['adminsubject'] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_adminsubject']~~)); |
  | 619 |  | $update['custom\_adminmsg'] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_custom\_adminmsg']~~)); |
  |  | 619 | $update['adminfrom'] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_adminfrom'],'HTML-ENTITIES','utf-8'))); |
  |  | 620 | $update['adminfromname'] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_adminfromname'],'HTML-ENTITIES','utf-8'))); |
  |  | 621 | $update['adminsubject'] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_adminsubject'],'HTML-ENTITIES','utf-8'))); |
  |  | 622 | $update['custom\_adminmsg'] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_custom\_adminmsg'],'HTML-ENTITIES','utf-8'))); |
  | 620 | 623 | $update['admin\_nl2br'] = $this->disable\_magic\_quotes\_gpc(htmlentities($\_POST['piereg\_admin\_nl2br'])); |
  | 621 |  | $update['adminmsg'] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_adminmsg']~~)); |
  |  | 624 | $update['adminmsg'] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_adminmsg'],'HTML-ENTITIES','utf-8'))); |
  | 622 | 625 | } |
  | 623 | 626 | if(isset($\_POST['presentation\_page'])){ |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L630) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L633) |  |
  | 630 | 633 | $update["password"] = $this->disable\_magic\_quotes\_gpc($\_POST['piereg\_password']); |
  | 631 | 634 | $update["password\_meter"] = $this->disable\_magic\_quotes\_gpc($\_POST['piereg\_password\_meter']); |
  | 632 |  | $update["short"] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_short']~~); |
  | 633 |  | $update["bad"] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_bad']~~); |
  | 634 |  | $update["good"] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_good']~~); |
  | 635 |  | $update["strong"] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_strong']~~); |
  | 636 |  | $update["mismatch"] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_mismatch']~~); |
  | 637 |  | $update["code"] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_code']~~); |
  |  | 635 | $update["short"] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_short'],'HTML-ENTITIES','utf-8')); |
  |  | 636 | $update["bad"] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_bad'],'HTML-ENTITIES','utf-8')); |
  |  | 637 | $update["good"] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_good'],'HTML-ENTITIES','utf-8')); |
  |  | 638 | $update["strong"] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_strong'],'HTML-ENTITIES','utf-8')); |
  |  | 639 | $update["mismatch"] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_mismatch'],'HTML-ENTITIES','utf-8')); |
  |  | 640 | $update["code"] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_code'],'HTML-ENTITIES','utf-8')); |
  | 638 | 641 | $update["custom\_logo\_url"] = $this->disable\_magic\_quotes\_gpc($\_POST['custom\_logo\_url']); |
  | 639 | 642 |  |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L642) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L645) |  |
  | 642 | 645 | } |
  | 643 | 646 | $update["code\_auto\_del"] = $this->disable\_magic\_quotes\_gpc($\_POST['piereg\_code\_auto\_del']); |
  | 644 |  | $update["codename"] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_codename']~~); |
  |  | 647 | $update["codename"] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($$\_POST['piereg\_codename'],'HTML-ENTITIES','utf-8')); |
  | 645 | 648 | if( isset($\_POST['piereg\_code']) ) { |
  | 646 | 649 | $update["codepass"] = $\_POST['piereg\_codepass']; |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L657) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L660) |  |
  | 657 | 660 | } |
  | 658 | 661 | $update["captcha"] = $this->disable\_magic\_quotes\_gpc($\_POST['piereg\_captcha']); |
  | 659 |  | $update["disclaimer"] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_disclaimer']~~)); |
  | 660 |  | $update["disclaimer\_title"] = $this->disable\_magic\_quotes\_gpc(~~htmlentities($\_POST['piereg\_disclaimer\_title']~~)); |
  | 661 |  | $update["disclaimer\_content"] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_disclaimer\_content']~~)); |
  | 662 |  | $update["disclaimer\_agree"] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_disclaimer\_agree']~~)); |
  | 663 |  | $update["license"] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_license']~~)); |
  | 664 |  | $update["license\_title"] = $this->disable\_magic\_quotes\_gpc(~~htmlentities($\_POST['piereg\_license\_title']~~)); |
  | 665 |  | $update["license\_content"] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_license\_content']~~)); |
  | 666 |  | $update["license\_agree"] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_license\_agree']~~)); |
  | 667 |  | $update["privacy"] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_privacy']~~)); |
  | 668 |  | $update["privacy\_title"] = $this->disable\_magic\_quotes\_gpc(~~htmlentities($\_POST['piereg\_privacy\_title']~~)); |
  | 669 |  | $update["privacy\_content"] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_privacy\_content']~~)); |
  | 670 |  | $update["privacy\_agree"] = $this->disable\_magic\_quotes\_gpc(htmlentities(~~$\_POST['piereg\_privacy\_agree']~~)); |
  |  | 662 | $update["disclaimer"] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_disclaimer'],'HTML-ENTITIES','utf-8'))); |
  |  | 663 | $update["disclaimer\_title"] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_disclaimer\_title'],'HTML-ENTITIES','utf-8')); |
  |  | 664 | $update["disclaimer\_content"] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_disclaimer\_content'],'HTML-ENTITIES','utf-8'))); |
  |  | 665 | $update["disclaimer\_agree"] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_disclaimer\_agree'],'HTML-ENTITIES','utf-8'))); |
  |  | 666 | $update["license"] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_license'],'HTML-ENTITIES','utf-8'))); |
  |  | 667 | $update["license\_title"] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_license\_title'],'HTML-ENTITIES','utf-8')); |
  |  | 668 | $update["license\_content"] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_license\_content'],'HTML-ENTITIES','utf-8'))); |
  |  | 669 | $update["license\_agree"] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_license\_agree'],'HTML-ENTITIES','utf-8'))); |
  |  | 670 | $update["privacy"] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_privacy'],'HTML-ENTITIES','utf-8'))); |
  |  | 671 | $update["privacy\_title"] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_privacy\_title'],'HTML-ENTITIES','utf-8')); |
  |  | 672 | $update["privacy\_content"] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_privacy\_content'],'HTML-ENTITIES','utf-8'))); |
  |  | 673 | $update["privacy\_agree"] = $this->disable\_magic\_quotes\_gpc(htmlentities(mb\_convert\_encoding($\_POST['piereg\_privacy\_agree'],'HTML-ENTITIES','utf-8'))); |
  | 671 | 674 | $update["email\_exists"] = $this->disable\_magic\_quotes\_gpc($\_POST['piereg\_email\_exists']); |
  | 672 | 675 | $update["firstname"] = $this->disable\_magic\_quotes\_gpc($\_POST['piereg\_firstname']); |
  | 673 | 676 | $update["lastname"] = $this->disable\_magic\_quotes\_gpc($\_POST['piereg\_lastname']); |
  | 674 | 677 | $update["website"] = $this->disable\_magic\_quotes\_gpc(htmlentities($\_POST['piereg\_website'])); |
  | 675 |  | $update["aim"] = $this->disable\_magic\_quotes\_gpc(~~htmlentities($\_POST['piereg\_aim'])~~); |
  | 676 |  | $update["yahoo"] = $this->disable\_magic\_quotes\_gpc(~~htmlentities($\_POST['piereg\_yahoo'])~~); |
  | 677 |  | $update["jabber"] = $this->disable\_magic\_quotes\_gpc(~~htmlentities($\_POST['piereg\_jabber'])~~); |
  | 678 |  | $update["phone"] = $this->disable\_magic\_quotes\_gpc(~~htmlentities($\_POST['piereg\_phone'])~~); |
  | 679 |  | $update["about"] = $this->disable\_magic\_quotes\_gpc(~~htmlentities($\_POST['piereg\_about'])~~); |
  |  | 678 | $update["aim"] = $this->disable\_magic\_quotes\_gpc($\_POST['piereg\_aim']); |
  |  | 679 | $update["yahoo"] = $this->disable\_magic\_quotes\_gpc($\_POST['piereg\_yahoo']); |
  |  | 680 | $update["jabber"] = $this->disable\_magic\_quotes\_gpc($\_POST['piereg\_jabber']); |
  |  | 681 | $update["phone"] = $this->disable\_magic\_quotes\_gpc($\_POST['piereg\_phone']); |
  |  | 682 | $update["about"] = $this->disable\_magic\_quotes\_gpc($\_POST['piereg\_about']); |
  | 680 | 683 | $update["profile\_req"] = $this->disable\_magic\_quotes\_gpc($\_POST['piereg\_profile\_req']); |
  | 681 | 684 | $update["require\_style"] = $this->disable\_magic\_quotes\_gpc(($\_POST['piereg\_require\_style'])); |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L706) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L709) |  |
  | 706 | 709 | } |
  | 707 | 710 | if(isset($\_POST['customised\_messages\_page'])){ |
  | 708 |  | $update['\_admin\_message\_1'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_1']~~); |
  | 709 |  | $update['\_admin\_message\_2'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_2']~~); |
  | 710 |  | $update['\_admin\_message\_3'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_3']~~); |
  | 711 |  | $update['\_admin\_message\_4'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_4']~~); |
  | 712 |  | $update['\_admin\_message\_5'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_5']~~); |
  | 713 |  | $update['\_admin\_message\_6'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_6']~~); |
  | 714 |  | $update['\_admin\_message\_7'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_7']~~); |
  | 715 |  | $update['\_admin\_message\_8'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_8']~~); |
  | 716 |  | $update['\_admin\_message\_9'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_9']~~); |
  | 717 |  | $update['\_admin\_message\_10'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_10']~~); |
  | 718 |  | $update['\_admin\_message\_12'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_12']~~); |
  | 719 |  | $update['\_admin\_message\_13'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_13']~~); |
  | 720 |  | $update['\_admin\_message\_14'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_14']~~); |
  | 721 |  | $update['\_admin\_message\_15'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_15']~~); |
  | 722 |  | $update['\_admin\_message\_16'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_16']~~); |
  | 723 |  | $update['\_admin\_message\_17'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_17']~~); |
  | 724 |  | $update['\_admin\_message\_18'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_18']~~); |
  | 725 |  | $update['\_admin\_message\_19'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_19']~~); |
  | 726 |  | $update['\_admin\_message\_20'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_20']~~); |
  | 727 |  | $update['\_admin\_message\_21'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_21']~~); |
  | 728 |  | $update['\_admin\_message\_22'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_22']~~); |
  | 729 |  | $update['\_admin\_message\_23'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_23']~~); |
  | 730 |  | $update['\_admin\_message\_24'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_24']~~); |
  | 731 |  | $update['\_admin\_message\_25'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_25']~~); |
  | 732 |  | $update['\_admin\_message\_26'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_26']~~); |
  | 733 |  | $update['\_admin\_message\_27'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_27']~~); |
  | 734 |  | $update['\_admin\_message\_28'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_28']~~); |
  | 735 |  | $update['\_admin\_message\_29'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_29']~~); |
  | 736 |  | $update['\_admin\_message\_30'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_30']~~); |
  | 737 |  | $update['\_admin\_message\_31'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_31']~~); |
  | 738 |  | $update['\_admin\_message\_32'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_32']~~); |
  | 739 |  | $update['\_admin\_message\_33'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_33']~~); |
  | 740 |  | $update['\_admin\_message\_34'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_34']~~); |
  | 741 |  | $update['\_admin\_message\_35'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_35']~~); |
  | 742 |  | $update['\_admin\_message\_36'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_36']~~); |
  | 743 |  | $update['\_admin\_message\_37'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_37']~~); |
  | 744 |  | $update['\_admin\_message\_38'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_38']~~); |
  | 745 |  | $update['\_admin\_message\_39'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_39']~~); |
  | 746 |  | $update['\_admin\_message\_40'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_40']~~); |
  | 747 |  | $update['\_admin\_message\_41'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_41']~~); |
  | 748 |  | $update['\_admin\_message\_42'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_42']~~); |
  | 749 |  | $update['\_admin\_message\_43'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_43']~~); |
  | 750 |  | $update['\_admin\_message\_44'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_44']~~); |
  | 751 |  | $update['\_admin\_message\_45'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_45']~~); |
  | 752 |  | $update['\_admin\_message\_46'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_46']~~); |
  | 753 |  | $update['\_admin\_message\_47'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_47']~~); |
  | 754 |  | $update['\_admin\_message\_48'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_48']~~); |
  | 755 |  | $update['\_admin\_message\_49'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_49']~~); |
  | 756 |  | $update['\_admin\_message\_50'] = $this->disable\_magic\_quotes\_gpc(~~$\_POST['piereg\_\_admin\_message\_50']~~); |
  |  | 711 | $update['\_admin\_message\_1'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_1'],'HTML-ENTITIES','utf-8')); |
  |  | 712 | $update['\_admin\_message\_2'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_2'],'HTML-ENTITIES','utf-8')); |
  |  | 713 | $update['\_admin\_message\_3'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_3'],'HTML-ENTITIES','utf-8')); |
  |  | 714 | $update['\_admin\_message\_4'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_4'],'HTML-ENTITIES','utf-8')); |
  |  | 715 | $update['\_admin\_message\_5'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_5'],'HTML-ENTITIES','utf-8')); |
  |  | 716 | $update['\_admin\_message\_6'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_6'],'HTML-ENTITIES','utf-8')); |
  |  | 717 | $update['\_admin\_message\_7'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_7'],'HTML-ENTITIES','utf-8')); |
  |  | 718 | $update['\_admin\_message\_8'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_8'],'HTML-ENTITIES','utf-8')); |
  |  | 719 | $update['\_admin\_message\_9'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_9'],'HTML-ENTITIES','utf-8')); |
  |  | 720 | $update['\_admin\_message\_10'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_10'],'HTML-ENTITIES','utf-8')); |
  |  | 721 | $update['\_admin\_message\_12'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_12'],'HTML-ENTITIES','utf-8')); |
  |  | 722 | $update['\_admin\_message\_13'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_13'],'HTML-ENTITIES','utf-8')); |
  |  | 723 | $update['\_admin\_message\_14'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_14'],'HTML-ENTITIES','utf-8')); |
  |  | 724 | $update['\_admin\_message\_15'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_15'],'HTML-ENTITIES','utf-8')); |
  |  | 725 | $update['\_admin\_message\_16'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_16'],'HTML-ENTITIES','utf-8')); |
  |  | 726 | $update['\_admin\_message\_17'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_17'],'HTML-ENTITIES','utf-8')); |
  |  | 727 | $update['\_admin\_message\_18'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_18'],'HTML-ENTITIES','utf-8')); |
  |  | 728 | $update['\_admin\_message\_19'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_19'],'HTML-ENTITIES','utf-8')); |
  |  | 729 | $update['\_admin\_message\_20'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_20'],'HTML-ENTITIES','utf-8')); |
  |  | 730 | $update['\_admin\_message\_21'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_21'],'HTML-ENTITIES','utf-8')); |
  |  | 731 | $update['\_admin\_message\_22'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_22'],'HTML-ENTITIES','utf-8')); |
  |  | 732 | $update['\_admin\_message\_23'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_23'],'HTML-ENTITIES','utf-8')); |
  |  | 733 | $update['\_admin\_message\_24'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_24'],'HTML-ENTITIES','utf-8')); |
  |  | 734 | $update['\_admin\_message\_25'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_25'],'HTML-ENTITIES','utf-8')); |
  |  | 735 | $update['\_admin\_message\_26'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_26'],'HTML-ENTITIES','utf-8')); |
  |  | 736 | $update['\_admin\_message\_27'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_27'],'HTML-ENTITIES','utf-8')); |
  |  | 737 | $update['\_admin\_message\_28'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_28'],'HTML-ENTITIES','utf-8')); |
  |  | 738 | $update['\_admin\_message\_29'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_29'],'HTML-ENTITIES','utf-8')); |
  |  | 739 | $update['\_admin\_message\_30'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_30'],'HTML-ENTITIES','utf-8')); |
  |  | 740 | $update['\_admin\_message\_31'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_31'],'HTML-ENTITIES','utf-8')); |
  |  | 741 | $update['\_admin\_message\_32'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_32'],'HTML-ENTITIES','utf-8')); |
  |  | 742 | $update['\_admin\_message\_33'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_33'],'HTML-ENTITIES','utf-8')); |
  |  | 743 | $update['\_admin\_message\_34'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_34'],'HTML-ENTITIES','utf-8')); |
  |  | 744 | $update['\_admin\_message\_35'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_35'],'HTML-ENTITIES','utf-8')); |
  |  | 745 | $update['\_admin\_message\_36'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_36'],'HTML-ENTITIES','utf-8')); |
  |  | 746 | $update['\_admin\_message\_37'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_37'],'HTML-ENTITIES','utf-8')); |
  |  | 747 | $update['\_admin\_message\_38'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_38'],'HTML-ENTITIES','utf-8')); |
  |  | 748 | $update['\_admin\_message\_39'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_39'],'HTML-ENTITIES','utf-8')); |
  |  | 749 | $update['\_admin\_message\_40'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_40'],'HTML-ENTITIES','utf-8')); |
  |  | 750 | $update['\_admin\_message\_41'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_41'],'HTML-ENTITIES','utf-8')); |
  |  | 751 | $update['\_admin\_message\_42'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_42'],'HTML-ENTITIES','utf-8')); |
  |  | 752 | $update['\_admin\_message\_43'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_43'],'HTML-ENTITIES','utf-8')); |
  |  | 753 | $update['\_admin\_message\_44'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_44'],'HTML-ENTITIES','utf-8')); |
  |  | 754 | $update['\_admin\_message\_45'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_45'],'HTML-ENTITIES','utf-8')); |
  |  | 755 | $update['\_admin\_message\_46'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_46'],'HTML-ENTITIES','utf-8')); |
  |  | 756 | $update['\_admin\_message\_47'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_47'],'HTML-ENTITIES','utf-8')); |
  |  | 757 | $update['\_admin\_message\_48'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_48'],'HTML-ENTITIES','utf-8')); |
  |  | 758 | $update['\_admin\_message\_49'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_49'],'HTML-ENTITIES','utf-8')); |
  |  | 759 | $update['\_admin\_message\_50'] = $this->disable\_magic\_quotes\_gpc(mb\_convert\_encoding($\_POST['piereg\_\_admin\_message\_50'],'HTML-ENTITIES','utf-8')); |
  | 757 | 760 | } |
  | 758 | 761 |  |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1005) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1008) |  |
  | 1005 | 1008 | $piereg = get\_option('pie\_register'); |
  | 1006 | 1009 |  |
  | 1007 |  | $user = $wpdb->get\_row("SELECT user\_login, user\_email FROM $wpdb->users WHERE ID='$user\_id'"); |
  |  | 1010 | //$user = $wpdb->get\_row("SELECT user\_login, user\_email FROM $wpdb->users WHERE ID='$user\_id'"); |
  |  | 1011 | $user = get\_user\_by('id', $user\_id); |
  | 1008 | 1012 | $message = \_\_($piereg['\_admin\_message\_17']) . "\r\n"; |
  | 1009 | 1013 | $message .= sprintf(\_\_('Username: %s', 'piereg'), $user->user\_login) . "\r\n"; |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1225) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1229) |  |
  | 1225 | 1229 | foreach( $piereg\_custom as $k=>$v ){ |
  | 1226 | 1230 | if( $v['required'] && $v['reg'] ){ |
  | 1227 |  | $id = ~~$this->Label\_ID($v['label']~~); |
  |  | 1231 | $id = str\_replace('.','\_',$this->Label\_ID($v['label'])); |
  | 1228 | 1232 | if(empty($\_POST[$id]) || $\_POST[$id] == ''){ |
  | 1229 | 1233 | $errors->add('empty\_' . $id, \_\_('<strong>ERROR</strong>: Please enter your ' . $v['label'] . '.', 'piereg')); |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1262) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1266) |  |
  | 1262 | 1266 | require\_once('recaptchalib.php'); |
  | 1263 | 1267 | $privatekey = $piereg['reCAP\_private\_key']; |
  | 1264 |  | $resp = r~~p\_r~~ecaptcha\_check\_answer ($privatekey, |
  |  | 1268 | $resp = recaptcha\_check\_answer ($privatekey, |
  | 1265 | 1269 |  |
  | 1266 | 1270 | $\_SERVER["REMOTE\_ADDR"], |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1303) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1307) |  |
  | 1303 | 1307 | $CeRror=1; |
  | 1304 | 1308 | }elseif( ($Cexpiry > 0) && $this->SelectCode($\_POST['regcode']) == $Cexpiry ){ |
  | 1305 |  | $this->UpdateCode($\_POST['regcode']); |
  |  | 1309 | //$this->UpdateCode($\_POST['regcode']); |
  | 1306 | 1310 | $errors->add('expired\_regcode', \_\_('<strong>ERROR</strong>: Your '.$piereg['codename'].' '.$piereg['\_admin\_message\_35'], 'piereg')); |
  | 1307 | 1311 | $CeRror=1; |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1345) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1349) |  |
  | 1345 | 1349 | ?> |
  | 1346 | 1350 | <p><label for="firstname"><?php \_e('First Name:', 'piereg');?><br /> |
  | 1347 |  | <input ~~autocomplete="off" name="firstname" id="firstname" size="25" value="<?php echo $\_POST['firstname']~~;?>" type="text" /></label> |
  |  | 1351 | <input name="firstname" id="firstname" size="25" value="<?php echo sanitize\_text\_field($\_POST['firstname']);?>" type="text" /></label> |
  | 1348 | 1352 | </p> |
  | 1349 | 1353 | <?php |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1353) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1357) |  |
  | 1353 | 1357 | ?> |
  | 1354 | 1358 | <p><label for="lastname"><?php \_e('Last Name:', 'piereg');?><br /> |
  | 1355 |  | <input ~~autocomplete="off" name="lastname" id="lastname" size="25" value="<?php echo $\_POST['lastname']~~;?>" type="text" /></label></p> |
  |  | 1359 | <input name="lastname" id="lastname" size="25" value="<?php echo sanitize\_text\_field($\_POST['lastname']);?>" type="text" /></label></p> |
  | 1356 | 1360 | <?php |
  | 1357 | 1361 | } |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1360) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1364) |  |
  | 1360 | 1364 | ?> |
  | 1361 | 1365 | <p><label for="password"><?php \_e('Password:', 'piereg');?><br /> |
  | 1362 |  | <input autocomplete="off" name="pass1" id="pass1" size="25" value="<?php echo ~~$\_POST['pass1']~~;?>" type="password" /></label> |
  |  | 1366 | <input autocomplete="off" name="pass1" id="pass1" size="25" value="<?php echo sanitize\_text\_field($\_POST['pass1']);?>" type="password" /></label> |
  | 1363 | 1367 | <br /> <label><?php \_e('Confirm Password:', 'piereg');?><br /> |
  | 1364 |  | <input autocomplete="off" name="pass2" id="pass2" size="25" value="<?php echo ~~$\_POST['pass2']~~;?>" type="password" /></label> |
  |  | 1368 | <input autocomplete="off" name="pass2" id="pass2" size="25" value="<?php echo sanitize\_text\_field($\_POST['pass2']);?>" type="password" /></label> |
  | 1365 | 1369 | <?php if( $piereg['password\_meter'] ){ ?> |
  | 1366 | 1370 | <br /> <span id="pass-strength-result"><?php echo $piereg['short'];?></span> |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1379) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1383) |  |
  | 1379 | 1383 | <?php if( $v['fieldtype'] == 'text' ){ ?> |
  | 1380 | 1384 | <p><label for="<?php echo $id;?>"><?php echo $v['label'];?>:<br /> |
  | 1381 |  | <input ~~autocomplete="off" class="custom\_field" name="<?php echo $id;?>" id="<?php echo $id;?>" size="25" value="<?php echo $\_POST[$id]~~;?>" type="text" /></label></p> |
  |  | 1385 | <input class="custom\_field" name="<?php echo $id;?>" id="<?php echo $id;?>" size="25" value="<?php echo sanitize\_text\_field($\_POST[$id]);?>" type="text" /></label></p> |
  | 1382 | 1386 |  |
  | 1383 |  | <?php } else if( $v['fieldtype'] == 'date' ){ ?> |
  |  | 1387 | <?php } else if( $v['fieldtype'] == 'date' ){ |
  |  | 1388 | /\*$test\_arr  = explode('/', $\_POST[$id]); |
  |  | 1389 | if (count($test\_arr) == 3) { |
  |  | 1390 | //date is valid |
  |  | 1391 | $sanitized\_date=intval($test\_arr[0]).'/'.intval($test\_arr[1]).'/'.intval($test\_arr[2]); |
  |  | 1392 | } else { |
  |  | 1393 | // problem with input ... |
  |  | 1394 | $sanitized\_date = ''; |
  |  | 1395 | }\*/ |
  |  | 1396 |  |
  |  | 1397 | ?> |
  | 1384 | 1398 | <p><label for="<?php echo $id;?>"><?php echo $v['label'];?>:<br /> |
  | 1385 |  | <input ~~autocomplete="off"~~ class="custom\_field date-pick" name="<?php echo $id;?>" id="<?php echo $id;?>" size="25" value="<?php echo $\_POST[$id];?>" type="text" /></label></p> |
  |  | 1399 | <input class="custom\_field date-pick" name="<?php echo $id;?>" id="<?php echo $id;?>" size="25" value="<?php echo $\_POST[$id];?>" type="text" /></label></p> |
  | 1386 | 1400 |  |
  | 1387 | 1401 | <?php } else if( $v['fieldtype'] == 'select' ){ |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1390) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1404) |  |
  | 1390 | 1404 | foreach( $ops as $op ){ |
  | 1391 | 1405 | $options .= '<option value="'.$op.'" '; |
  | 1392 |  | if( $\_POST[$id] == $op ) $options .= 'selected="selected"'; |
  |  | 1406 | if( $\_POST[$id] == $op ) $options .= 'selected="selected" '; |
  | 1393 | 1407 | $options .= '>' . $op . '</option>'; |
  | 1394 | 1408 | } |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1405) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1419) |  |
  | 1405 | 1419 | $check .= '<label><input type="checkbox" class="custom\_checkbox" name="'.$id.'[]" id="'.$id.'" '; |
  | 1406 | 1420 | //if( in\_array($op, $\_POST[$id]) ) $check .= 'checked="checked" '; |
  |  | 1421 | if( $\_POST[$id] == $op ) $check .= 'checked="checked" '; |
  | 1407 | 1422 | $check .= 'value="'.$op.'" /> '.$op.'</label> '; |
  | 1408 | 1423 | } |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1415) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1430) |  |
  | 1415 | 1430 | $radio = ''; |
  | 1416 | 1431 | foreach( $ops as $op ){ |
  | 1417 |  | $radio .= '<label for="'.$id.'~~"><input type="radio" class="custom\_radio" name="'.$id.'" id="'.$id~~.'" '; |
  |  | 1432 | $radio .= '<label for="'.$id.'-'.$op.'"><input type="radio" class="custom\_radio" name="'.$id.'" id="'.$id.'-'.$op.'" '; |
  | 1418 | 1433 | //if( in\_array($op, $\_POST[$id]) ) $radio .= 'checked="checked" '; |
  |  | 1434 | if( $\_POST[$id] == $op ) $radio .= 'checked="checked" '; |
  | 1419 | 1435 | $radio .= 'value="'.$op.'" /> '.$op.'</label> '; |
  | 1420 | 1436 | } |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1425) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1441) |  |
  | 1425 | 1441 | } else if( $v['fieldtype'] == 'textarea' ){ ?> |
  | 1426 | 1442 | <p><label for="<?php echo $id;?>"><?php echo $v['label'];?>:<br /> |
  | 1427 |  | <textarea name="<?php echo $id;?>" cols="25" rows="5" id="<?php echo $id;?>" class="custom\_textarea"><?php echo ~~$\_POST[$id]~~;?></textarea></label></p> |
  |  | 1443 | <textarea name="<?php echo $id;?>" cols="25" rows="5" id="<?php echo $id;?>" class="custom\_textarea"><?php echo sanitize\_text\_field($\_POST[$id]);?></textarea></label></p> |
  | 1428 | 1444 |  |
  | 1429 | 1445 | <?php } else if( $v['fieldtype'] == 'hidden' ){ ?><p> |
  | 1430 |  | <input class="custom\_field" name="<?php echo $id;?>" value="<?php echo ~~$\_POST[$id]~~;?>" type="hidden" />  </p> |
  |  | 1446 | <input class="custom\_field" name="<?php echo $id;?>" value="<?php echo sanitize\_text\_field($\_POST[$id]);?>" type="hidden" />  </p> |
  | 1431 | 1447 | <?php } ?> |
  | 1432 | 1448 |  |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1437) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1453) |  |
  | 1437 | 1453 | ?> |
  | 1438 | 1454 | <p><label for="website"><?php \_e('Website:', 'piereg');?><br /> |
  | 1439 |  | <input ~~autocomplete="off" name="website" id="website" size="25" value="<?php echo $\_POST['website']~~;?>" type="text" /></label></p> |
  |  | 1455 | <input name="website" id="website" size="25" value="<?php echo sanitize\_text\_field($\_POST['website']);?>" type="text" /></label></p> |
  | 1440 | 1456 | <?php |
  | 1441 | 1457 | } |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1444) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1460) |  |
  | 1444 | 1460 | ?> |
  | 1445 | 1461 | <p><label for="aim"><?php \_e('AIM:', 'piereg');?><br /> |
  | 1446 |  | <input ~~autocomplete="off" name="aim" id="aim" size="25" value="<?php echo $\_POST['aim']~~;?>" type="text" /></label></p> |
  |  | 1462 | <input name="aim" id="aim" size="25" value="<?php echo sanitize\_text\_field($\_POST['aim']);?>" type="text" /></label></p> |
  | 1447 | 1463 | <?php |
  | 1448 | 1464 | } |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1451) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1467) |  |
  | 1451 | 1467 | ?> |
  | 1452 | 1468 | <p><label for="yahoo"><?php \_e('Yahoo IM:', 'piereg');?><br /> |
  | 1453 |  | <input ~~autocomplete="off" name="yahoo" id="yahoo" size="25" value="<?php echo $\_POST['yahoo']~~;?>" type="text" /></label></p> |
  |  | 1469 | <input name="yahoo" id="yahoo" size="25" value="<?php echo sanitize\_text\_field($\_POST['yahoo']);?>" type="text" /></label></p> |
  | 1454 | 1470 | <?php |
  | 1455 | 1471 | } |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1458) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1474) |  |
  | 1458 | 1474 | ?> |
  | 1459 | 1475 | <p><label for="jabber"><?php \_e('Jabber / Google Talk:', 'piereg');?><br /> |
  | 1460 |  | <input ~~autocomplete="off" name="jabber" id="jabber" size="25" value="<?php echo $\_POST['jabber']~~;?>" type="text" /></label></p> |
  |  | 1476 | <input name="jabber" id="jabber" size="25" value="<?php echo sanitize\_text\_field($\_POST['jabber']);?>" type="text" /></label></p> |
  | 1461 | 1477 | <?php |
  | 1462 | 1478 | } |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1465) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1481) |  |
  | 1465 | 1481 | ?> |
  | 1466 | 1482 | <p><label for="phone"><?php \_e('Phone # / Mobile #:', 'piereg');?><br /> |
  | 1467 |  | <input ~~autocomplete="off" name="phone" id="phone" size="25" value="<?php echo $\_POST['phone']~~;?>" type="text" /></label></p> |
  |  | 1483 | <input name="phone" id="phone" size="25" value="<?php echo sanitize\_text\_field($\_POST['phone']);?>" type="text" /></label></p> |
  | 1468 | 1484 | <?php |
  | 1469 | 1485 | } |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1472) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1488) |  |
  | 1472 | 1488 | ?> |
  | 1473 | 1489 | <p><label for="about"><?php \_e('About Yourself:', 'piereg');?><br /> |
  | 1474 |  | <textarea ~~autocomplete="off" name="about" id="about" cols="25" rows="5"><?php echo stripslashes($\_POST['about']~~);?></textarea></label> |
  |  | 1490 | <textarea name="about" id="about" cols="25" rows="5"><?php echo stripslashes(sanitize\_text\_field($\_POST['about']));?></textarea></label> |
  | 1475 | 1491 | <small><?php \_e('Share a little biographical information to fill out your profile. This may be shown publicly.', 'piereg');?></small> |
  | 1476 | 1492 | </p> |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1484) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1500) |  |
  | 1484 | 1500 | ?> |
  | 1485 | 1501 | <p><label for="code"><?php \_e($piereg['codename'].' Code:', 'piereg');?><br /> |
  | 1486 |  | <input name="regcode" id="regcode" size="25" value="<?php echo ~~$\_POST['regcode']~~;?>" type="text" /></label> |
  |  | 1502 | <input name="regcode" id="regcode" size="25" value="<?php echo sanitize\_text\_field($\_POST['regcode']);?>" type="text" /></label> |
  | 1487 | 1503 | <?php if ($piereg['code\_req']) {?> |
  | 1488 | 1504 | <p><small><?php \_e(str\_replace('[prcodename]',$piereg['codename'],$piereg['\_admin\_message\_38']), 'piereg');?></small></p> |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1533) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1549) |  |
  | 1533 | 1549 | $publickey = $piereg['reCAP\_public\_key']; |
  | 1534 | 1550 | echo '<div id="reCAPTCHA">'; |
  | 1535 |  | echo r~~p\_r~~ecaptcha\_get\_html($publickey); |
  |  | 1551 | echo recaptcha\_get\_html($publickey); |
  | 1536 | 1552 | echo '</div>'; |
  | 1537 | 1553 | } |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1783) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1799) |  |
  | 1783 | 1799 | $piereg = get\_option( 'pie\_register' ); |
  | 1784 | 1800 | $username = $\_COOKIE['session\_secure\_id']; |
  | 1785 |  | $user\_id = $wpdb->get\_var( "SELECT ID FROM $wpdb->users WHERE `user\_login` = '".$username."'"); |
  |  | 1801 | //$user\_id = $wpdb->get\_var( "SELECT ID FROM $wpdb->users WHERE `user\_login` = '".$username."'"); |
  |  | 1802 | $user = get\_user\_by('login', $username); |
  |  | 1803 | $user\_id = $user->ID; |
  | 1786 | 1804 | //var\_dump($username,$user\_id); |
  | 1787 | 1805 | $admin\_verified\_user = get\_user\_meta($user\_id,'admin\_verified\_user',true); |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1901) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1919) |  |
  | 1901 | 1919 | break; |
  | 1902 | 1920 | case "date" : |
  | 1903 |  | $outfield = '<input ~~autocomplete="off"~~ class="custom\_field date-pick" tabindex="36" name="' . $id . '" id="' . $id . '" value="' . $value . '"  />'; |
  |  | 1921 | $outfield = '<input class="custom\_field date-pick" tabindex="36" name="' . $id . '" id="' . $id . '" value="' . $value . '"  />'; |
  | 1904 | 1922 | break; |
  | 1905 | 1923 | } |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1972) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L1990) |  |
  | 1972 | 1990 | $paypalcode.="?cmd=\_s-xclick&custom=".$user\_id."&hosted\_button\_id=".$piereg['paypal\_butt\_id']."'><img src='https://www.paypal.com/en\_US/i/btn/btn\_subscribe\_LG.gif' alt='PayPal - The safer, easier way to pay online' border='0' /></a>"; |
  | 1973 | 1991 | $msg = '<p style="margin-bottom:10px;">' . sprintf(\_\_('Hello <strong>%s</strong>, '.$piereg['\_admin\_message\_44'], 'piereg'), $login ) . '</p>'.$paypalcode; |
  | 1974 |  | $func3 = function() use ($msg){ echo $msg; }; |
  | 1975 |  | add\_action('login\_form', $func3); |
  |  | 1992 | //$func3 = function() use ($msg){ echo $msg; }; |
  |  | 1993 | $this->bodymsg = $msg; |
  |  | 1994 | add\_action('login\_form', array(&$this,'pie\_login\_form\_body\_msg')); |
  | 1976 | 1995 |  |
  | 1977 | 1996 | $message = \_\_($piereg['\_admin\_message\_43'], 'piereg'); |
  | 1978 |  | $func = function($ms) use ($message){ return $message; }; |
  | 1979 |  | add\_filter('login\_messages', $func); |
  |  | 1997 | //$func = function($ms) use ($message){ return $message; }; |
  |  | 1998 | $this->headmsg = $message; |
  |  | 1999 | add\_filter('login\_messages', array(&$this,'pie\_login\_head\_message')); |
  | 1980 | 2000 | return true; |
  | 1981 | 2001 | }else{ |
  | 1982 | 2002 | ///die($username); |
  | 1983 |  | $user\_id = $wpdb->get\_var( "SELECT ID FROM $wpdb->users WHERE `user\_login` = '".$username."'"); |
  |  | 2003 | //$user\_id = $wpdb->get\_var( "SELECT ID FROM $wpdb->users WHERE `user\_login` = '".$username."'"); |
  |  | 2004 | $user = get\_user\_by('login', $username); |
  |  | 2005 | $user\_id = $user->ID; |
  | 1984 | 2006 | if($user\_id){ |
  | 1985 | 2007 | $admin\_verified\_user = get\_user\_meta($user\_id,'admin\_verified\_user',true); |
  | 1986 | 2008 | if($admin\_verified\_user){ |
  | 1987 | 2009 | $message = \_\_($piereg['\_admin\_message\_17'], 'piereg'); |
  | 1988 |  | $func = function($ms) use ($message){ return $message; }; |
  | 1989 |  | add\_filter('login\_messages', $func); |
  |  | 2010 | //$func = function($ms) use ($message){ return $message; }; |
  |  | 2011 | $this->headmsg = $message; |
  |  | 2012 | add\_filter('login\_messages', array(&$this,'pie\_login\_head\_message')); |
  | 1990 | 2013 | } |
  | 1991 | 2014 | } |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L1993) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L2016) |  |
  | 1993 | 2016 | }elseif( $piereg['admin\_verify']){ |
  | 1994 | 2017 | $message = \_\_($piereg['\_admin\_message\_41'], 'piereg'); |
  | 1995 |  | $func = function() use ($message){ return $message; }; |
  | 1996 |  | add\_filter('login\_messages', $func); |
  |  | 2018 | //$func = function() use ($message){ return $message; }; |
  |  | 2019 | $this->headmsg = $message; |
  |  | 2020 | add\_filter('login\_messages', array(&$this,'pie\_login\_head\_message')); |
  | 1997 | 2021 | return true; |
  | 1998 | 2022 | }elseif($piereg['email\_verify']){ |
  | 1999 | 2023 | $message = \_\_($piereg['\_admin\_message\_42'], 'piereg'); |
  | 2000 |  | $func = function() use ($message){ return $message; }; |
  | 2001 |  | add\_filter('login\_messages', $func); |
  |  | 2024 | //$func = function() use ($message){ return $message; }; |
  |  | 2025 | //die(\_\_($piereg['\_admin\_message\_42'], 'piereg')); |
  |  | 2026 | $this->headmsg = $message; |
  |  | 2027 | //$session[] = $message; |
  |  | 2028 | add\_filter('login\_messages', array(&$this,'pie\_login\_head\_message')); |
  | 2002 | 2029 | return true; |
  | 2003 | 2030 | } |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L2008) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L2035) |  |
  | 2008 | 2035 | if($user\_id > 0){ |
  | 2009 | 2036 | $login = get\_user\_meta($user\_id, 'email\_verify\_user',true); |
  |  | 2037 | if(!$login){ |
  |  | 2038 | $user = get\_user\_by("id",$user\_id); |
  |  | 2039 | $login = $user->user\_login; |
  |  | 2040 | } |
  | 2010 | 2041 | //var\_dump($login); |
  | 2011 | 2042 | update\_user\_meta( $user\_id, 'is\_email\_verified', 'yes' ); |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L2022) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L2053) |  |
  | 2022 | 2053 |  |
  | 2023 | 2054 | $msg = '<p style="margin-bottom:10px;">' . sprintf(\_\_('Thank you <strong>%s</strong>, '.$piereg['\_admin\_message\_46'], 'piereg'), $login ) . '</p>'; |
  | 2024 |  | $func3 = function() use ($msg){ echo $msg; }; |
  | 2025 |  | add\_action('login\_form', $func3); |
  |  | 2055 | //$func3 = function() use ($msg){ echo $msg; }; |
  |  | 2056 | $this->bodymsg = $msg; |
  |  | 2057 | add\_action('login\_form', array(&$this,'pie\_login\_form\_body\_msg')); |
  | 2026 | 2058 | } |
  | 2027 | 2059 | else{ |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L2035) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L2067) |  |
  | 2035 | 2067 | $paypalcode.="?cmd=\_s-xclick&custom=".$user\_id."&hosted\_button\_id=".$piereg['paypal\_butt\_id']."'><img src='https://www.paypal.com/en\_US/i/btn/btn\_subscribe\_LG.gif' alt='PayPal - The safer, easier way to pay online' border='0' /></a>"; |
  | 2036 | 2068 | $msg = '<p style="margin-bottom:10px;">' . sprintf(\_\_('Hello <strong>%s</strong>, '.$piereg['\_admin\_message\_45'], 'piereg'), $login ) . '</p>'.$paypalcode; |
  | 2037 |  | $func3 = function() use ($msg){ echo $msg; }; |
  | 2038 |  | add\_action('login\_form', $func3); |
  |  | 2069 | //$func3 = function() use ($msg){ echo $msg; }; |
  |  | 2070 | $this->bodymsg = $msg; |
  |  | 2071 | add\_action('login\_form', array(&$this,'pie\_login\_form\_body\_msg')); |
  | 2039 | 2072 |  |
  | 2040 | 2073 | }else{ |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L2047) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L2080) |  |
  | 2047 | 2080 |  |
  | 2048 | 2081 | $msg = '<p style="margin-bottom:10px;">' . sprintf(\_\_('Thank you <strong>%s</strong>, '.$piereg['\_admin\_message\_46'], 'piereg'), $login ) . '</p>'; |
  | 2049 |  | $func3 = function() use ($msg){ echo $msg; }; |
  | 2050 |  | add\_action('login\_form', $func3); |
  |  | 2082 | //$func3 = function() use ($msg){ echo $msg; }; |
  |  | 2083 | $this->bodymsg = $msg; |
  |  | 2084 | add\_action('login\_form', array(&$this,'pie\_login\_form\_body\_msg')); |
  | 2051 | 2085 | } |
  | 2052 | 2086 | } |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L2241) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L2275) |  |
  | 2241 | 2275 | } |
  | 2242 | 2276 | }elseif($\_GET['action'] == 'payment\_cancel'){ |
  | 2243 |  | echo '<p style="text-align:center;">' . \_\_($piereg['\_admin\_message\_49'], 'piereg') . '</p>'; |
  |  | 2277 | //die('true'); |
  |  | 2278 | //$this->headmsg = \_\_($piereg['\_admin\_message\_49'], 'piereg'); |
  |  | 2279 | add\_filter('login\_message', array(&$this,'payment\_error\_msg')); |
  | 2244 | 2280 | }else{ |
  | 2245 | 2281 | return false; |
  | […](/browser/pie-register/trunk/pie-register.php?rev=738939#L2284) | […](/browser/pie-register/trunk/pie-register.php?rev=740249#L2320) |  |
  | 2284 | 2320 |  |
  | 2285 | 2321 | function override\_warning(){ |
  |  | 2322 | $reflFunc = new ReflectionFunction('wp\_new\_user\_notification'); |
  |  | 2323 | print $reflFunc->getFileName() . ':' . $reflFunc->getStartLine(); |
  | 2286 | 2324 | //if( current\_user\_can('activate\_plugins') &&  $\_GET['page'] == 'pie-register' ) |
  | 2287 | 2325 | echo "<div id='piereg-warning' class='updated fade-ff0000'><p><strong>".\_\_('You have another plugin installed that is conflicting with Pie Register.  This other plugin is overriding the user notification emails.  Please contact <a href="http://www.genetechsolutions.com/support.html" target="\_blank">support</a> with the list of your installed plugins and theme information.', 'piereg') . "</strong></p></div>"; |
  |  | 2326 | } |
  |  | 2327 | /\* |
  |  | 2328 | Backward Compatibility Issue fix |
  |  | 2329 | \*/ |
  |  | 2330 | //Callback functions |
  |  | 2331 | function pie\_login\_head\_message(){ |
  |  | 2332 | return $this->headmsg; |
  |  | 2333 | } |
  |  | 2334 | //Callback functions |
  |  | 2335 | function pie\_login\_form\_body\_msg(){ |
  |  | 2336 | echo $this->bodymsg; |
  | 2288 | 2337 | } |
  | 2289 | 2338 | } |
* ## [pie-register/trunk/piewpnun.php](/changeset/740249/pie-register/trunk/piewpnun.php "Show the changeset 740249 restricted to pie-register/trunk/piewpnun.php")

  | [r738939](/browser/pie-register/trunk/piewpnun.php?rev=738939#L1 "Show revision 738939 of this file in browser") | [r740249](/browser/pie-register/trunk/piewpnun.php?rev=740249#L1 "Show revision 740249 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 |  |  |
  | 3 |  | if ( function\_exists('wp\_new\_user\_notification') ) |
  | 4 |  |  |
  | 5 |  | add\_action('admin\_notices', array($pie\_register, 'override\_warning')); |
  | 6 |  |  |
  | 7 |  |  |
  |  | 2 | /\*Deprecated Function\*/ |
  |  | 3 | /\*if ( function\_exists('wp\_new\_user\_notification') ) |
  |  | 4 | add\_action('admin\_notices', array($pie\_register, 'override\_warning'));\*/ |
  | 8 | 5 |  |
  | 9 | 6 | # Override set user password and send email to User # |
  | […](/browser/pie-register/trunk/piewpnun.php?rev=738939#L497) | […](/browser/pie-register/trunk/piewpnun.php?rev=740249#L494) |  |
  | 497 | 494 | } |
  | 498 | 495 |  |
  |  | 496 | }else{ |
  |  | 497 | add\_action('user\_register','pie\_register\_user\_notification'); |
  | 499 | 498 | } |
  | 500 |  |  |
  |  | 499 | function pie\_register\_user\_notification($user\_id){ |
  |  | 500 |  |
  |  | 501 |  |
  |  | 502 | $user = new WP\_User($user\_id); |
  |  | 503 |  |
  |  | 504 |  |
  |  | 505 |  |
  |  | 506 | #-- PIE REGESTER --# |
  |  | 507 |  |
  |  | 508 | global $wpdb, $pie\_register; |
  |  | 509 |  |
  |  | 510 | $piereg = get\_option( 'pie\_register' ); |
  |  | 511 |  |
  |  | 512 | $piereg\_custom = get\_option( 'pie\_register\_custom' ); |
  |  | 513 |  |
  |  | 514 | $ref = explode( '?', $\_SERVER['HTTP\_REFERER']); |
  |  | 515 |  |
  |  | 516 | $ref = $ref[0]; |
  |  | 517 |  |
  |  | 518 | $admin = trailingslashit( get\_option('siteurl') ) . 'wp-admin/user-new.php'; |
  |  | 519 |  |
  |  | 520 | if( !is\_array( $piereg\_custom ) ) $piereg\_custom = array(); |
  |  | 521 |  |
  |  | 522 | if( $piereg['password'] && !empty($\_POST['user\_pw'])){ |
  |  | 523 | $plaintext\_pass = $\_POST['user\_pw']; |
  |  | 524 | }else{ |
  |  | 525 | // otherwise use the supplied password |
  |  | 526 | $plaintext\_pass = $pie\_register->RanPass(6); |
  |  | 527 | } |
  |  | 528 |  |
  |  | 529 |  |
  |  | 530 |  |
  |  | 531 | if( $piereg['firstname'] && $\_POST['firstname'] ) |
  |  | 532 |  |
  |  | 533 | update\_usermeta( $user\_id, 'first\_name', $\_POST['firstname']); |
  |  | 534 |  |
  |  | 535 | if( $piereg['lastname'] && $\_POST['lastname'] ) |
  |  | 536 |  |
  |  | 537 | update\_usermeta( $user\_id, 'last\_name', $\_POST['lastname']); |
  |  | 538 |  |
  |  | 539 | if( $piereg['website'] && $\_POST['website'] ) |
  |  | 540 |  |
  |  | 541 | update\_usermeta( $user\_id, 'user\_url', $\_POST['website']); |
  |  | 542 |  |
  |  | 543 | if( $piereg['aim'] && $\_POST['aim'] ) |
  |  | 544 |  |
  |  | 545 | update\_usermeta( $user\_id, 'aim', $\_POST['aim']); |
  |  | 546 |  |
  |  | 547 | if( $piereg['yahoo'] && $\_POST['yahoo'] ) |
  |  | 548 |  |
  |  | 549 | update\_usermeta( $user\_id, 'yim', $\_POST['yahoo']); |
  |  | 550 |  |
  |  | 551 | if( $piereg['jabber'] && $\_POST['jabber'] ) |
  |  | 552 |  |
  |  | 553 | update\_usermeta( $user\_id, 'jabber', $\_POST['jabber']); |
  |  | 554 |  |
  |  | 555 | if( $piereg['phone'] && $\_POST['phone'] ) |
  |  | 556 |  |
  |  | 557 | update\_usermeta( $user\_id, 'phone', $\_POST['phone']); |
  |  | 558 |  |
  |  | 559 | if( $piereg['about'] && $\_POST['about'] ) |
  |  | 560 |  |
  |  | 561 | update\_usermeta( $user\_id, 'description',$\_POST['about']); |
  |  | 562 |  |
  |  | 563 | if( $piereg['code'] && $\_POST['regcode'] ) |
  |  | 564 |  |
  |  | 565 | update\_usermeta( $user\_id, 'invite\_code', $\_POST['regcode']); |
  |  | 566 |  |
  |  | 567 | if( $ref != $admin && $piereg['admin\_verify'] ){ |
  |  | 568 |  |
  |  | 569 | update\_usermeta( $user\_id, 'admin\_verify\_user', $user->user\_login ); |
  |  | 570 |  |
  |  | 571 | update\_usermeta( $user\_id, 'email\_verify\_user\_pwd', $user->user\_pass ); |
  |  | 572 |  |
  |  | 573 | update\_usermeta( $user\_id, 'email\_verify\_email', $user->user\_email ); |
  |  | 574 |  |
  |  | 575 | $temp\_id = 'unverified\_\_' . $pie\_register->RanPass(7); |
  |  | 576 |  |
  |  | 577 | $notice = \_\_('Your account requires activation by an administrator before you will be able to login.', 'piereg') . "\r\n"; |
  |  | 578 |  |
  |  | 579 | }else if( $ref != $admin && $piereg['email\_verify'] ){ |
  |  | 580 |  |
  |  | 581 | $code = $pie\_register->RanPass(25); |
  |  | 582 |  |
  |  | 583 | update\_usermeta( $user\_id, 'email\_verify', $code ); |
  |  | 584 |  |
  |  | 585 | update\_usermeta( $user\_id, 'email\_verify\_date', date('Ymd') ); |
  |  | 586 |  |
  |  | 587 | update\_usermeta( $user\_id, 'email\_verify\_user', $user->user\_login ); |
  |  | 588 |  |
  |  | 589 | update\_usermeta( $user\_id, 'email\_verify\_user\_pwd', $user->user\_pass ); |
  |  | 590 |  |
  |  | 591 | update\_usermeta( $user\_id, 'email\_verify\_email', $user->user\_email ); |
  |  | 592 |  |
  |  | 593 | $email\_code = '?piereg\_verification=' . $code.'&'; |
  |  | 594 |  |
  |  | 595 | $prelink = \_\_('Verification URL: ', 'piereg'); |
  |  | 596 |  |
  |  | 597 | $notice = \_\_('Please use the link above to verify and activate your account', 'piereg') . "\r\n"; |
  |  | 598 |  |
  |  | 599 | $temp\_id = 'unverified\_\_' . $pie\_register->RanPass(7); |
  |  | 600 |  |
  |  | 601 | delete\_user\_setting('default\_password\_nag', $user\_id); |
  |  | 602 |  |
  |  | 603 | update\_user\_option($user\_id, 'default\_password\_nag', false, true); |
  |  | 604 |  |
  |  | 605 | }else if( $ref != $admin && $piereg['paypal\_option']){ |
  |  | 606 |  |
  |  | 607 | $code = $pie\_register->RanPass(25); |
  |  | 608 |  |
  |  | 609 | update\_usermeta( $user\_id, 'email\_verify', $code ); |
  |  | 610 |  |
  |  | 611 | update\_usermeta( $user\_id, 'pending\_payment', 'yes' ); |
  |  | 612 |  |
  |  | 613 | update\_usermeta( $user\_id, 'email\_verify\_user', $user->user\_login ); |
  |  | 614 |  |
  |  | 615 | update\_usermeta( $user\_id, 'email\_verify\_user\_pwd', $user->user\_pass ); |
  |  | 616 |  |
  |  | 617 | update\_usermeta( $user\_id, 'email\_verify\_email', $user->user\_email ); |
  |  | 618 |  |
  |  | 619 | $temp\_id = 'unverified\_\_' . $pie\_register->RanPass(7); |
  |  | 620 |  |
  |  | 621 | $email\_code = '?piereg\_verification=' . $code.'&'; |
  |  | 622 |  |
  |  | 623 |  |
  |  | 624 |  |
  |  | 625 | $prelink = \_\_('Verification URL: ', 'piereg'); |
  |  | 626 |  |
  |  | 627 | $notice = \_\_('Please click on the above link to verify your email', 'piereg') . "\r\n"; |
  |  | 628 |  |
  |  | 629 | } |
  |  | 630 |  |
  |  | 631 | if (!empty($piereg\_custom)) { |
  |  | 632 |  |
  |  | 633 | foreach( $piereg\_custom as $k=>$v ){ |
  |  | 634 |  |
  |  | 635 | $id = $pie\_register->Label\_ID($v['label']); |
  |  | 636 |  |
  |  | 637 | if( $v['reg'] && $\_POST[$id] ){ |
  |  | 638 |  |
  |  | 639 | if( is\_array( $\_POST[$id] ) ) $\_POST[$id] = implode(', ', $\_POST[$id]); |
  |  | 640 |  |
  |  | 641 | update\_usermeta( $user\_id, $id, $\_POST[$id]); |
  |  | 642 |  |
  |  | 643 | } |
  |  | 644 |  |
  |  | 645 | } |
  |  | 646 |  |
  |  | 647 | } |
  |  | 648 |  |
  |  | 649 | #-- END Pie Rgister --# |
  |  | 650 |  |
  |  | 651 |  |
  |  | 652 |  |
  |  | 653 | wp\_set\_password($plaintext\_pass, $user\_id); |
  |  | 654 |  |
  |  | 655 | $user\_login = stripslashes($user->user\_login); |
  |  | 656 |  |
  |  | 657 | $user\_email = stripslashes($user->user\_email); |
  |  | 658 |  |
  |  | 659 |  |
  |  | 660 |  |
  |  | 661 | #-- Pie-Register --# |
  |  | 662 |  |
  |  | 663 | if( !$piereg['custom\_adminmsg'] && !$piereg['disable\_admin'] ){ |
  |  | 664 |  |
  |  | 665 | #-- END Pie-Register --# |
  |  | 666 |  |
  |  | 667 |  |
  |  | 668 |  |
  |  | 669 | $message  = sprintf(\_\_('New user Register on your blog %s:', 'piereg'), get\_option('blogname')) . "\r\n\r\n"; |
  |  | 670 |  |
  |  | 671 | $message .= sprintf(\_\_('Username: %s', 'piereg'), $user\_login) . "\r\n\r\n"; |
  |  | 672 |  |
  |  | 673 | $message .= sprintf(\_\_('E-mail: %s', 'piereg'), $user\_email) . "\r\n"; |
  |  | 674 |  |
  |  | 675 |  |
  |  | 676 |  |
  |  | 677 | @wp\_mail(get\_option('admin\_email'), sprintf(\_\_('[%s] New User Register', 'piereg'), get\_option('blogname')), $message); |
  |  | 678 |  |
  |  | 679 |  |
  |  | 680 |  |
  |  | 681 | #-- Pie-Register --# |
  |  | 682 |  |
  |  | 683 | }else if( !$piereg['disable\_admin'] ){ |
  |  | 684 |  |
  |  | 685 | if( $piereg['adminhtml'] ){ |
  |  | 686 |  |
  |  | 687 | $headers  = 'MIME-Version: 1.0' . "\r\n"; |
  |  | 688 |  |
  |  | 689 | $headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n"; |
  |  | 690 |  |
  |  | 691 | } |
  |  | 692 |  |
  |  | 693 | //$headers .= 'From: ' . $piereg['adminfrom'] . "\r\n" . 'Reply-To: ' . $piereg['adminfrom'] . "\r\n"; |
  |  | 694 |  |
  |  | 695 | add\_filter('wp\_mail\_from', array($pie\_register, 'adminfrom')); |
  |  | 696 |  |
  |  | 697 | add\_filter('wp\_mail\_from\_name', array($pie\_register, 'adminfromname')); |
  |  | 698 |  |
  |  | 699 | $subject = $piereg['adminsubject']; |
  |  | 700 |  |
  |  | 701 | $message = str\_replace('%user\_login%', $user\_login, $piereg['adminmsg']); |
  |  | 702 |  |
  |  | 703 | $message = str\_replace('%user\_email%', $user\_email, $message); |
  |  | 704 |  |
  |  | 705 | $message = str\_replace('%blogname%', get\_option('blogname'), $message); |
  |  | 706 |  |
  |  | 707 | $message = str\_replace('%user\_ip%', $\_SERVER['REMOTE\_ADDR'], $message); |
  |  | 708 |  |
  |  | 709 | $message = str\_replace('%user\_host%', gethostbyaddr($\_SERVER['REMOTE\_ADDR']), $message); |
  |  | 710 |  |
  |  | 711 | $message = str\_replace('%user\_ref%', $\_SERVER['HTTP\_REFERER'], $message); |
  |  | 712 |  |
  |  | 713 | $message = str\_replace('%user\_agent%', $\_SERVER['HTTP\_USER\_AGENT'], $message); |
  |  | 714 |  |
  |  | 715 | if( $piereg['firstname'] ) $message = str\_replace('%firstname%', $\_POST['firstname'], $message); |
  |  | 716 |  |
  |  | 717 | if( $piereg['lastname'] ) $message = str\_replace('%lastname%', $\_POST['lastname'], $message); |
  |  | 718 |  |
  |  | 719 | if( $piereg['website'] ) $message = str\_replace('%website%', $\_POST['website'], $message); |
  |  | 720 |  |
  |  | 721 | if( $piereg['aim'] ) $message = str\_replace('%aim%', $\_POST['aim'], $message); |
  |  | 722 |  |
  |  | 723 | if( $piereg['yahoo'] ) $message = str\_replace('%yahoo%', $\_POST['yahoo'], $message); |
  |  | 724 |  |
  |  | 725 | if( $piereg['jabber'] ) $message = str\_replace('%jabber%', $\_POST['jabber'], $message); |
  |  | 726 |  |
  |  | 727 | if( $piereg['phone'] ) $message = str\_replace('%phone%', $\_POST['phone'], $message); |
  |  | 728 |  |
  |  | 729 | if( $piereg['about'] ) $message = str\_replace('%about%', $\_POST['about'], $message); |
  |  | 730 |  |
  |  | 731 | if( $piereg['code'] ) $message = str\_replace('%'.$piereg['codename'].'code%', $\_POST['regcode'], $message); |
  |  | 732 |  |
  |  | 733 |  |
  |  | 734 |  |
  |  | 735 | if( !is\_array( $piereg\_custom ) ) $piereg\_custom = array(); |
  |  | 736 |  |
  |  | 737 | if (!empty($piereg\_custom)) { |
  |  | 738 |  |
  |  | 739 | foreach( $piereg\_custom as $k=>$v ){ |
  |  | 740 |  |
  |  | 741 | $meta = $pie\_register->Label\_ID($v['label']); |
  |  | 742 |  |
  |  | 743 | $value = get\_user\_meta( $user\_id, $meta ,true); |
  |  | 744 |  |
  |  | 745 | $message = str\_replace('%'.$meta.'%', $value, $message); |
  |  | 746 |  |
  |  | 747 | } |
  |  | 748 |  |
  |  | 749 | } |
  |  | 750 |  |
  |  | 751 | $siteurl = get\_option('siteurl'); |
  |  | 752 |  |
  |  | 753 | $message = str\_replace('%siteurl%', $siteurl, $message); |
  |  | 754 |  |
  |  | 755 |  |
  |  | 756 |  |
  |  | 757 | if( $piereg['adminhtml'] && $piereg['admin\_nl2br'] ) |
  |  | 758 |  |
  |  | 759 | $message = nl2br($message); |
  |  | 760 |  |
  |  | 761 |  |
  |  | 762 |  |
  |  | 763 | wp\_mail(get\_option('admin\_email'), $subject, $message, $headers); |
  |  | 764 |  |
  |  | 765 | } |
  |  | 766 |  |
  |  | 767 | #-- END Pie-Register --# |
  |  | 768 |  |
  |  | 769 |  |
  |  | 770 |  |
  |  | 771 | if ( empty($plaintext\_pass) ) |
  |  | 772 |  |
  |  | 773 | return; |
  |  | 774 |  |
  |  | 775 |  |
  |  | 776 |  |
  |  | 777 | #-- Pie-Register --# |
  |  | 778 |  |
  |  | 779 | if( !$piereg['custom\_msg'] ){ |
  |  | 780 |  |
  |  | 781 | #-- END Pie-Register --# |
  |  | 782 |  |
  |  | 783 |  |
  |  | 784 |  |
  |  | 785 | $message  = sprintf(\_\_('Username: %s', 'piereg'), $user\_login) . "\r\n"; |
  |  | 786 |  |
  |  | 787 | $message .= sprintf(\_\_('Password: %s', 'piereg'), $plaintext\_pass) . "\r\n"; |
  |  | 788 |  |
  |  | 789 | //$message .= get\_option('siteurl') . "/wp-login.php"; |
  |  | 790 |  |
  |  | 791 |  |
  |  | 792 |  |
  |  | 793 | #-- Pie-Register --# |
  |  | 794 |  |
  |  | 795 | $message .= $email\_code?$prelink . get\_option('siteurl') . "/wp-login.php" . $email\_code . "\r\n":"-xxx-"; |
  |  | 796 |  |
  |  | 797 | $message .= $notice; |
  |  | 798 |  |
  |  | 799 | #-- END Pie-Register --# |
  |  | 800 |  |
  |  | 801 |  |
  |  | 802 |  |
  |  | 803 | wp\_mail($user\_email, sprintf(\_\_('[%s] Your username and password', 'piereg'), get\_option('blogname')), $message); |
  |  | 804 |  |
  |  | 805 |  |
  |  | 806 |  |
  |  | 807 | #-- Pie-Register --# |
  |  | 808 |  |
  |  | 809 | } |
  |  | 810 |  |
  |  | 811 | else{ |
  |  | 812 |  |
  |  | 813 | $unvemailcheck=get\_user\_meta($user\_id,'email\_verify\_email',true); |
  |  | 814 |  |
  |  | 815 |  |
  |  | 816 |  |
  |  | 817 | if( ($unvemailcheck && $piereg['emailvmsghtml']) || ($unvemailcheck && $piereg['adminvmsghtml']) || (!$unvemailcheck && $piereg['html'])){ |
  |  | 818 |  |
  |  | 819 | $headers  = 'MIME-Version: 1.0' . "\r\n"; |
  |  | 820 |  |
  |  | 821 | $headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n"; |
  |  | 822 |  |
  |  | 823 | } |
  |  | 824 |  |
  |  | 825 | //$headers .= 'From: ' . $piereg['from'] . "\r\n" . 'Reply-To: ' . $piereg['from'] . "\r\n"; |
  |  | 826 |  |
  |  | 827 | add\_filter('wp\_mail\_from', array($pie\_register, 'userfrom')); |
  |  | 828 |  |
  |  | 829 | add\_filter('wp\_mail\_from\_name', array($pie\_register, 'userfromname')); |
  |  | 830 |  |
  |  | 831 | $subject = $piereg['subject']; |
  |  | 832 |  |
  |  | 833 | //Here we need to put the PENDING VERIFICATION EMAIL |
  |  | 834 |  |
  |  | 835 | //Email Verification |
  |  | 836 |  |
  |  | 837 | if( ($unvemailcheck) && ($piereg['email\_verify']) ){ |
  |  | 838 |  |
  |  | 839 | $message = str\_replace('%user\_pass%', $plaintext\_pass, $piereg['emailvmsg']); |
  |  | 840 |  |
  |  | 841 | }else if( ($unvemailcheck) && ($piereg['admin\_verify']) ){ |
  |  | 842 |  |
  |  | 843 | //Admin Verification |
  |  | 844 |  |
  |  | 845 | $message = str\_replace('%user\_pass%', $plaintext\_pass, $piereg['adminvmsg']); |
  |  | 846 |  |
  |  | 847 | }else{ |
  |  | 848 |  |
  |  | 849 | //Confirmed User Message |
  |  | 850 |  |
  |  | 851 | $message = str\_replace('%user\_pass%', $plaintext\_pass, $piereg['msg']); |
  |  | 852 |  |
  |  | 853 | } |
  |  | 854 |  |
  |  | 855 | $message = str\_replace('%user\_login%', $user\_login, $message); |
  |  | 856 |  |
  |  | 857 | $message = str\_replace('%user\_email%', $user\_email, $message); |
  |  | 858 |  |
  |  | 859 | $message = str\_replace('%blogname%', get\_option('blogname'), $message); |
  |  | 860 |  |
  |  | 861 | $message = str\_replace('%user\_ip%', $\_SERVER['REMOTE\_ADDR'], $message); |
  |  | 862 |  |
  |  | 863 | $message = str\_replace('%user\_host%', gethostbyaddr($\_SERVER['REMOTE\_ADDR']), $message); |
  |  | 864 |  |
  |  | 865 | $message = str\_replace('%user\_ref%', $\_SERVER['HTTP\_REFERER'], $message); |
  |  | 866 |  |
  |  | 867 | $message = str\_replace('%user\_agent%', $\_SERVER['HTTP\_USER\_AGENT'], $message); |
  |  | 868 |  |
  |  | 869 | if( $piereg['firstname'] ) $message = str\_replace('%firstname%', $\_POST['firstname'], $message); |
  |  | 870 |  |
  |  | 871 | if( $piereg['lastname'] ) $message = str\_replace('%lastname%', $\_POST['lastname'], $message); |
  |  | 872 |  |
  |  | 873 | if( $piereg['website'] ) $message = str\_replace('%website%', $\_POST['website'], $message); |
  |  | 874 |  |
  |  | 875 | if( $piereg['aim'] ) $message = str\_replace('%aim%', $\_POST['aim'], $message); |
  |  | 876 |  |
  |  | 877 | if( $piereg['yahoo'] ) $message = str\_replace('%yahoo%', $\_POST['yahoo'], $message); |
  |  | 878 |  |
  |  | 879 | if( $piereg['jabber'] ) $message = str\_replace('%jabber%', $\_POST['jabber'], $message); |
  |  | 880 |  |
  |  | 881 | if( $piereg['phone'] ) $message = str\_replace('%phone%', $\_POST['phone'], $message); |
  |  | 882 |  |
  |  | 883 | if( $piereg['about'] ) $message = str\_replace('%about%', $\_POST['about'], $message); |
  |  | 884 |  |
  |  | 885 | if( $piereg['code'] ) $message = str\_replace('%'.$piereg['codename'].'code%', $\_POST['regcode'], $message); |
  |  | 886 |  |
  |  | 887 |  |
  |  | 888 |  |
  |  | 889 | if( !is\_array( $piereg\_custom ) ) $piereg\_custom = array(); |
  |  | 890 |  |
  |  | 891 | if (!empty($piereg\_custom)) { |
  |  | 892 |  |
  |  | 893 | foreach( $piereg\_custom as $k=>$v ){ |
  |  | 894 |  |
  |  | 895 | $meta = $pie\_register->Label\_ID($v['label']); |
  |  | 896 |  |
  |  | 897 | $value = get\_user\_meta( $user\_id, $meta ,true); |
  |  | 898 |  |
  |  | 899 | $message = str\_replace('%'.$meta.'%', $value, $message); |
  |  | 900 |  |
  |  | 901 | } |
  |  | 902 |  |
  |  | 903 | } |
  |  | 904 |  |
  |  | 905 |  |
  |  | 906 |  |
  |  | 907 | $redirect = 'redirect\_to=' . $piereg['login\_redirect']; |
  |  | 908 |  |
  |  | 909 | if( $piereg['email\_verify'] &&  !$piereg['paypal\_option']) |
  |  | 910 |  |
  |  | 911 | $siteurl = get\_option('siteurl') . "/wp-login.php" . $email\_code . $redirect; |
  |  | 912 |  |
  |  | 913 |  |
  |  | 914 |  |
  |  | 915 | else if($piereg['paypal\_option']) |
  |  | 916 |  |
  |  | 917 | $siteurl = get\_option('siteurl') . "/wp-login.php" . $email\_code; |
  |  | 918 |  |
  |  | 919 |  |
  |  | 920 |  |
  |  | 921 | else |
  |  | 922 |  |
  |  | 923 | $siteurl = get\_option('siteurl') . "/wp-login.php?" . $redirect; |
  |  | 924 |  |
  |  | 925 |  |
  |  | 926 |  |
  |  | 927 | $message = str\_replace('%siteurl%', $siteurl, $message); |
  |  | 928 |  |
  |  | 929 |  |
  |  | 930 |  |
  |  | 931 | //Email Verification |
  |  | 932 |  |
  |  | 933 | if( ($unvemailcheck) && ($piereg['email\_verify']) &&  $piereg['emailvhtml'] && $piereg['emailvuser\_nl2br'] ){ |
  |  | 934 |  |
  |  | 935 | $message = nl2br($message); |
  |  | 936 |  |
  |  | 937 | }else if( ($unvemailcheck) && ($piereg['admin\_verify']) &&  $piereg['adminvhtml'] && $piereg['adminvuser\_nl2br'] ){ |
  |  | 938 |  |
  |  | 939 | $message = nl2br($message); |
  |  | 940 |  |
  |  | 941 | }else if( $piereg['html'] && $piereg['user\_nl2br'] ){ |
  |  | 942 |  |
  |  | 943 | $message = nl2br($message); |
  |  | 944 |  |
  |  | 945 | } |
  |  | 946 |  |
  |  | 947 |  |
  |  | 948 |  |
  |  | 949 | wp\_mail($user\_email, $subject, $message, $headers); |
  |  | 950 |  |
  |  | 951 | } |
  |  | 952 |  |
  |  | 953 | if( $ref != $admin && ( $piereg['email\_verify'] || $piereg['admin\_verify'] ) ) { |
  |  | 954 |  |
  |  | 955 | $temp\_user = $wpdb->query( "UPDATE $wpdb->users SET user\_login = '$temp\_id' WHERE ID = '$user\_id'" ); |
  |  | 956 |  |
  |  | 957 | }else if( $ref != $admin && ($piereg['paypal\_option']) ) { |
  |  | 958 |  |
  |  | 959 |  |
  |  | 960 |  |
  |  | 961 | $temp\_user = $wpdb->query( "UPDATE $wpdb->users SET user\_login = '$temp\_id' WHERE ID = '$user\_id'" ); |
  |  | 962 |  |
  |  | 963 | $temp\_email = $wpdb->query( "UPDATE $wpdb->users SET user\_email = '$temp\_id\_".$user\_email."' WHERE ID = '$user\_id'" ); |
  |  | 964 |  |
  |  | 965 | //$wpdb->query( "UPDATE $wpdb->users SET user\_email = '$user\_email\_$temp\_id' WHERE ID = '$user\_id'" ); |
  |  | 966 |  |
  |  | 967 | } |
  |  | 968 |  |
  |  | 969 |  |
  |  | 970 |  |
  |  | 971 | if ( ! is\_admin() ) { |
  |  | 972 | wp\_safe\_redirect( 'wp-login.php?checkemail=registered' ); |
  |  | 973 | exit(); |
  |  | 974 | } |
  |  | 975 | return $user\_id; |
  |  | 976 | } |
  | 501 | 977 | ?> |
* ## [pie-register/trunk/readme.txt](/changeset/740249/pie-register/trunk/readme.txt "Show the changeset 740249 restricted to pie-register/trunk/readme.txt")

  | [r738939](/browser/pie-register/trunk/readme.txt?rev=738939#L11 "Show revision 738939 of this file in browser") | [r740249](/browser/pie-register/trunk/readme.txt?rev=740249#L11 "Show revision 740249 of this file in browser") |  |
  | --- | --- | --- |
  | 11 | 11 | == Description == |
  | 12 | 12 |  |
  | 13 |  | Welcome to Pie-Register by Genetech Solutions. |
  | 14 |  | So you want to have users register and login to your site before they interact with it? You need user registration and you don’t have to build it from scratch. With Pie-Register you can use your logo and color scheme to brand your registration pages to your liking.  Use this plugin to quickly add custom user registration to your WordPress based blog or site. |
  | 15 |  | Want your customers to pay for the service you provide? The plugin allows you to charge the users when they register with PayPal integration. |
  | 16 |  | And there is more, you can: |
  | 17 |  |  |
  |  | 13 | Welcome to Pie-Register by Genetech Solutions. |
  |  | 14 | So you want to have users register and login to your site before they interact with it? You need user registration and you don't have to build it from scratch. With Pie-Register you can use your logo and color scheme to brand your registration pages to your liking.  Use this plugin to quickly add custom user registration to your WordPress based blog or site. |
  |  | 15 | Want your customers to pay for the service you provide? The plugin allows you to charge the users when they register with PayPal integration. |
  |  | 16 | And there is more, you can: |
  | 18 | 17 | \*Send Invitation Codes |
  | 19 | 18 | \*Use CAPTCHA |
  | 20 |  | \*Email Validation |
  |  | 19 | \*Email Validation |
  | 21 | 20 | \*User Profile Moderation |
  | 22 | 21 | \*User Defined Fields |
  | 23 | 22 |  |
  |  | 23 | Use the free Pie-Register plugin to easily add features like these to your service; they help you go above and beyond your competitors. |
  |  | 24 | There are more features to come in the weeks ahead. |
  |  | 25 | See the plugin features section for complete details. |
  | 24 | 26 |  |
  | 25 |  | Use the free Pie-Register plugin to easily add features like these to your service; they help you go above and beyond your competitors. |
  | 26 |  | There are more features to come in the weeks ahead. |
  | 27 |  | See the plugin features section for complete details. |
  |  | 27 | Features |
  |  | 28 | -------- |
  |  | 29 | Pie-Register has great features which you can’t find in any other free plugin. |
  |  | 30 | \*Custom Logo and Color Scheme\* Use your own logo and color scheme and get your brand in the spotlight. |
  |  | 31 | Password Field Hate those forgettable auto-generated passwords? Allow your users to set their own passwords during registration.  The plugin includes that sweet Password Strength Meter. |
  |  | 32 | \*Invitation Codes\* Is your blog super exclusive? If so, you better require an invite to join your high end crew. Setup multiple codes and track where your new users are coming from with the optional Invitation Tracking Dashboard Widget. |
  |  | 33 | \*Disclaimers\* Worried about legal liabilities? Setup a general disclaimer, license agreement and/or privacy policy for new users to agree to during registration. |
  |  | 34 | \*CAPTCHA Validation\* If you don’t want those spam bots registering use CAPTCHA protection. The plugin includes a simple Captcha easy enough for real humans to read as well as the ability to add a re-CAPTCHA. |
  |  | 35 | \*Email Validation\* Ensure your users are registering with valid email accounts by forcing them to click a validation link that’s sent out with their registration email.  Email validation initially sets the username to a random generated string (something like: ‘unverified\_\_h439herld3′). The user can’t login until they click on that validation link sent in the email. This will put their real username in place allowing them to login. |
  |  | 36 | \*Unverified registrations\* have a defined grace period. They are automatically deleted after a specified period of time so you don’t get clogged up with those fakes. (Manage under Users > Unverified Users) |
  | 28 | 37 |  |
  | 29 |  |  |
  | 30 |  | =Features= |
  | 31 |  |  |
  | 32 |  | Pie-Register has great features which you can't find in any other free plugin. |
  | 33 |  |  |
  | 34 |  | \*\*Custom Logo and Color Scheme\*\* Use your own logo and color scheme and get your brand in the spotlight. |
  | 35 |  |  |
  | 36 |  | \*\*Password Field\*\* Hate those forgettable auto-generated passwords? Allow your users to set their own passwords during registration.  The plugin includes that sweet Password Strength Meter. |
  | 37 |  |  |
  | 38 |  | \*\*Invitation Codes\*\* Is your blog super exclusive? If so, you better require an invite to join your high end crew. Setup multiple codes and track where your new users are coming from with the optional Invitation Tracking Dashboard Widget. |
  | 39 |  |  |
  | 40 |  | \*\*Disclaimers\*\* Worried about legal liabilities? Setup a general disclaimer, license agreement and/or privacy policy for new users to agree to during registration. |
  | 41 |  |  |
  | 42 |  | \*\*CAPTCHA Validation\*\* If you don’t want those spam bots registering use CAPTCHA protection. The plugin includes a simple Captcha easy enough for real humans to read as well as the ability to add a re-CAPTCHA. |
  | 43 |  |  |
  | 44 |  | \*\*Email Validation\*\* Ensure your users are registering with valid email accounts by forcing them to click a validation link that’s sent out with their registration email.  <MORE> |
  | 45 |  |  |
  | 46 |  | \*\*User Moderation\*\* Want absolute control? Check out every new user yourself and hand pick who can stay and who gets the boot before they are able to login to your site. (Manage under Users > Unverified Users) |
  | 47 |  |  |
  | 48 |  | \*\*Profile Fields\*\* Have new users fill out there entire profile or just some fields. Make fields optional or required as needed. |
  | 49 |  |  |
  | 50 |  | \*\*User Defined Fields\*\* Add your own defined fields to the registration page for users to fill out. Includes ability to add date, selection, checkbox, radio and text area fields! |
  | 51 |  |  |
  | 52 |  | \*\*Duplicate Email Registration\*\* Got multiple users using the same email address? Easily solve this predicament without forcing them to sign up with unneeded email accounts.  This is also useful for administrators to create another account with one email address. |
  | 53 |  |  |
  | 54 |  | \*\*Customized Admin & User Registration Email\*\* Tired of the same old emails when someone new registers? Spice it up with your own From/Reply-To address, customized subject and customize the entire message! You can even disable those tiresome Admin notifications for new registrations. |
  | 55 |  |  |
  | 56 |  | \*\*Membership Fee\*\* Charge your users for membership via Pie-Register’s built-in PayPal integration. |
  | 57 |  |  |
  |  | 38 | \*User Moderation\* Want absolute control? Check out every new user yourself and hand pick who can stay and who gets the boot before they are able to login to your site. (Manage under Users > Unverified Users) |
  |  | 39 | \*Profile Fields\* Have new users fill out there entire profile or just some fields. Make fields optional or required as needed. |
  |  | 40 | \*User Defined Fields\* Add your own defined fields to the registration page for users to fill out. Includes ability to add date, selection, checkbox, radio and text area fields! |
  |  | 41 | \*Duplicate Email Registration\* Got multiple users using the same email address? Easily solve this predicament without forcing them to sign up with unneeded email accounts.  This is also useful for administrators to create another account with one email address. |
  |  | 42 | \*Customized Admin & User Registration Email\* Tired of the same old emails when someone new registers? Spice it up with your own From/Reply-To address, customized subject and customize the entire message! You can even disable those tiresome Admin notifications for new registrations. |
  |  | 43 | \*Membership Fee\* Charge your users for membership via Pie-Register’s built-in PayPal integration. |
  | 58 | 44 |  |
  | 59 | 45 | == Installation == |
  | […](/browser/pie-register/trunk/readme.txt?rev=738939#L62) | […](/browser/pie-register/trunk/readme.txt?rev=740249#L48) |  |
  | 62 | 48 | 1. Upload the `pie-register` directory to the `/wp-content/plugins/` directory |
  | 63 | 49 | 2. Activate the plugin through the 'Plugins' menu in WordPress |
  | 64 |  | 3. Set the options in the ~~Plugins Page~~ |
  |  | 50 | 3. Set the options in the Settings Panel |
  | 65 | 51 |  |
  | 66 | 52 |  |
  | […](/browser/pie-register/trunk/readme.txt?rev=738939#L72) | […](/browser/pie-register/trunk/readme.txt?rev=740249#L58) |  |
  | 72 | 58 |  |
  | 73 | 59 | == CHANGELOG == |
  |  | 60 | =v1.31 July 13 2013= |
  |  | 61 | \*\*Backward Compatibility Issues fixed.\*\* |
  |  | 62 | \*\*Plugin Conflict Issue fixed.\*\* |
  |  | 63 | \*\*Input has been sanitized.\*\* |
  |  | 64 | \*\*UTF-8 characters are now supported by necessary text fields.\*\* |
  |  | 65 | \*\*reCaptcha Library has been upgraded.\*\* |
  |  | 66 |  |
  |  | 67 |  |
  | 74 | 68 | =v1.30 July 11 2013= |
  | 75 | 69 | \*\*New Features:\*\* |
* ## [pie-register/trunk/recaptchalib.php](/changeset/740249/pie-register/trunk/recaptchalib.php "Show the changeset 740249 restricted to pie-register/trunk/recaptchalib.php")

  | [r738939](/browser/pie-register/trunk/recaptchalib.php?rev=738939#L1 "Show revision 738939 of this file in browser") | [r740249](/browser/pie-register/trunk/recaptchalib.php?rev=740249#L1 "Show revision 740249 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 |  |  |
  | 3 | 2 | /\* |
  | 4 |  |  |
  | 5 | 3 | \* This is a PHP library that handles calling reCAPTCHA. |
  | 6 |  |  |
  | 7 | 4 | \*    - Documentation and latest version |
  | 8 |  |  |
  | 9 | 5 | \*          http://recaptcha.net/plugins/php/ |
  | 10 |  |  |
  | 11 | 6 | \*    - Get a reCAPTCHA API Key |
  | 12 |  |  |
  | 13 |  | \*          http://recaptcha.net/api/getkey |
  | 14 |  |  |
  |  | 7 | \*          https://www.google.com/recaptcha/admin/create |
  | 15 | 8 | \*    - Discussion group |
  | 16 |  |  |
  | 17 | 9 | \*          http://groups.google.com/group/recaptcha |
  | 18 |  |  |
  | 19 |  | \* |
  | 20 |  |  |
  |  | 10 | \* |
  | 21 | 11 | \* Copyright (c) 2007 reCAPTCHA -- http://recaptcha.net |
  | 22 |  |  |
  | 23 | 12 | \* AUTHORS: |
  | 24 |  |  |
  | 25 | 13 | \*   Mike Crawford |
  | 26 |  |  |
  | 27 | 14 | \*   Ben Maurer |
  | 28 |  |  |
  | 29 |  | \* |
  | 30 |  |  |
  |  | 15 | \* |
  | 31 | 16 | \* Permission is hereby granted, free of charge, to any person obtaining a copy |
  | 32 |  |  |
  | 33 | 17 | \* of this software and associated documentation files (the "Software"), to deal |
  | 34 |  |  |
  | 35 | 18 | \* in the Software without restriction, including without limitation the rights |
  | 36 |  |  |
  | 37 | 19 | \* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell |
  | 38 |  |  |
  | 39 | 20 | \* copies of the Software, and to permit persons to whom the Software is |
  | 40 |  |  |
  | 41 | 21 | \* furnished to do so, subject to the following conditions: |
  | 42 |  |  |
  | 43 |  | \* |
  | 44 |  |  |
  |  | 22 | \* |
  | 45 | 23 | \* The above copyright notice and this permission notice shall be included in |
  | 46 |  |  |
  | 47 | 24 | \* all copies or substantial portions of the Software. |
  | 48 |  |  |
  | 49 |  | \* |
  | 50 |  |  |
  |  | 25 | \* |
  | 51 | 26 | \* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR |
  | 52 |  |  |
  | 53 | 27 | \* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, |
  | 54 |  |  |
  | 55 | 28 | \* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE |
  | 56 |  |  |
  | 57 | 29 | \* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER |
  | 58 |  |  |
  | 59 | 30 | \* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, |
  | 60 |  |  |
  | 61 | 31 | \* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN |
  | 62 |  |  |
  | 63 | 32 | \* THE SOFTWARE. |
  | 64 |  |  |
  | 65 |  | \*/ |
  | 66 |  |  |
  | 67 |  |  |
  | 68 |  |  |
  | 69 |  | /\*\* |
  | 70 |  |  |
  |  | 33 | \*/ |
  |  | 34 |  |
  |  | 35 | /\*\* |
  | 71 | 36 | \* The reCAPTCHA server URL's |
  | 72 |  |  |
  | 73 |  | \*/ |
  | 74 |  |  |
  | 75 |  | define("RECAPTCHA\_API\_SERVER", "http://api.recaptcha.net"); |
  | 76 |  |  |
  | 77 |  | define("RECAPTCHA\_API\_SECURE\_SERVER", "https://api-secure.recaptcha.net"); |
  | 78 |  |  |
  | 79 |  | define("RECAPTCHA\_VERIFY\_SERVER", "api-verify.recaptcha.net"); |
  | 80 |  |  |
  | 81 |  |  |
  | 82 |  |  |
  | 83 |  | /\*\* |
  | 84 |  |  |
  |  | 37 | \*/ |
  |  | 38 | if(!defined("RECAPTCHA\_API\_SERVER")) |
  |  | 39 | define("RECAPTCHA\_API\_SERVER", "http://www.google.com/recaptcha/api"); |
  |  | 40 | if(!defined("RECAPTCHA\_API\_SECURE\_SERVER")) |
  |  | 41 | define("RECAPTCHA\_API\_SECURE\_SERVER", "https://www.google.com/recaptcha/api"); |
  |  | 42 | if(!defined("RECAPTCHA\_VERIFY\_SERVER")) |
  |  | 43 | define("RECAPTCHA\_VERIFY\_SERVER", "www.google.com"); |
  |  | 44 |  |
  |  | 45 | /\*\* |
  | 85 | 46 | \* Encodes the given data into a query string format |
  | 86 |  |  |
  | 87 | 47 | \* @param $data - array of string elements to be encoded |
  | 88 |  |  |
  | 89 | 48 | \* @return string - encoded request |
  | 90 |  |  |
  | 91 |  | \*/ |
  | 92 |  |  |
  | 93 |  | function \_rp\_recaptcha\_qsencode ($data) { |
  | 94 |  |  |
  | 95 |  | $req = ""; |
  | 96 |  |  |
  | 97 |  | foreach ( $data as $key => $value ) |
  | 98 |  |  |
  | 99 |  | $req .= $key . '=' . urlencode( stripslashes($value) ) . '&'; |
  | 100 |  |  |
  | 101 |  |  |
  | 102 |  |  |
  | 103 |  | // Cut the last '&' |
  | 104 |  |  |
  | 105 |  | $req=substr($req,0,strlen($req)-1); |
  | 106 |  |  |
  | 107 |  | return $req; |
  | 108 |  |  |
  | 109 |  | } |
  | 110 |  |  |
  | 111 |  |  |
  | 112 |  |  |
  | 113 |  |  |
  | 114 |  |  |
  | 115 |  |  |
  | 116 |  |  |
  | 117 |  | /\*\* |
  | 118 |  |  |
  |  | 49 | \*/ |
  |  | 50 |  |
  |  | 51 | if(!function\_exists('\_recaptcha\_qsencode')){ |
  |  | 52 | function \_recaptcha\_qsencode ($data) { |
  |  | 53 | $req = ""; |
  |  | 54 | foreach ( $data as $key => $value ) |
  |  | 55 | $req .= $key . '=' . urlencode( stripslashes($value) ) . '&'; |
  |  | 56 |  |
  |  | 57 | // Cut the last '&' |
  |  | 58 | $req=substr($req,0,strlen($req)-1); |
  |  | 59 | return $req; |
  |  | 60 | } |
  |  | 61 | } |
  |  | 62 |  |
  |  | 63 |  |
  |  | 64 |  |
  |  | 65 | /\*\* |
  | 119 | 66 | \* Submits an HTTP POST to a reCAPTCHA server |
  | 120 |  |  |
  | 121 | 67 | \* @param string $host |
  | 122 |  |  |
  | 123 | 68 | \* @param string $path |
  | 124 |  |  |
  | 125 | 69 | \* @param array $data |
  | 126 |  |  |
  | 127 | 70 | \* @param int port |
  | 128 |  |  |
  | 129 | 71 | \* @return array response |
  | 130 |  |  |
  | 131 |  | \*/ |
  | 132 |  |  |
  | 133 |  | function \_rp\_recaptcha\_http\_post($host, $path, $data, $port = 80) { |
  | 134 |  |  |
  | 135 |  |  |
  | 136 |  |  |
  | 137 |  | $req = \_rp\_recaptcha\_qsencode ($data); |
  | 138 |  |  |
  | 139 |  |  |
  | 140 |  |  |
  | 141 |  | $http\_request  = "POST $path HTTP/1.0\r\n"; |
  | 142 |  |  |
  | 143 |  | $http\_request .= "Host: $host\r\n"; |
  | 144 |  |  |
  | 145 |  | $http\_request .= "Content-Type: application/x-www-form-urlencoded;\r\n"; |
  | 146 |  |  |
  | 147 |  | $http\_request .= "Content-Length: " . strlen($req) . "\r\n"; |
  | 148 |  |  |
  | 149 |  | $http\_request .= "User-Agent: reCAPTCHA/PHP\r\n"; |
  | 150 |  |  |
  | 151 |  | $http\_request .= "\r\n"; |
  | 152 |  |  |
  | 153 |  | $http\_request .= $req; |
  | 154 |  |  |
  | 155 |  |  |
  | 156 |  |  |
  | 157 |  | $response = ''; |
  | 158 |  |  |
  | 159 |  | if( false == ( $fs = @fsockopen($host, $port, $errno, $errstr, 10) ) ) { |
  | 160 |  |  |
  | 161 |  | die ('Could not open socket'); |
  | 162 |  |  |
  | 163 |  | } |
  | 164 |  |  |
  | 165 |  |  |
  | 166 |  |  |
  | 167 |  | fwrite($fs, $http\_request); |
  | 168 |  |  |
  | 169 |  |  |
  | 170 |  |  |
  | 171 |  | while ( !feof($fs) ) |
  | 172 |  |  |
  | 173 |  | $response .= fgets($fs, 1160); // One TCP-IP packet |
  | 174 |  |  |
  | 175 |  | fclose($fs); |
  | 176 |  |  |
  | 177 |  | $response = explode("\r\n\r\n", $response, 2); |
  | 178 |  |  |
  | 179 |  |  |
  | 180 |  |  |
  | 181 |  | return $response; |
  | 182 |  |  |
  | 183 |  | } |
  | 184 |  |  |
  | 185 |  |  |
  | 186 |  |  |
  | 187 |  |  |
  | 188 |  |  |
  | 189 |  |  |
  | 190 |  |  |
  | 191 |  | /\*\* |
  | 192 |  |  |
  |  | 72 | \*/ |
  |  | 73 | if(!function\_exists('\_recaptcha\_http\_post')){ |
  |  | 74 | function \_recaptcha\_http\_post($host, $path, $data, $port = 80) { |
  |  | 75 |  |
  |  | 76 | $req = \_recaptcha\_qsencode ($data); |
  |  | 77 |  |
  |  | 78 | $http\_request  = "POST $path HTTP/1.0\r\n"; |
  |  | 79 | $http\_request .= "Host: $host\r\n"; |
  |  | 80 | $http\_request .= "Content-Type: application/x-www-form-urlencoded;\r\n"; |
  |  | 81 | $http\_request .= "Content-Length: " . strlen($req) . "\r\n"; |
  |  | 82 | $http\_request .= "User-Agent: reCAPTCHA/PHP\r\n"; |
  |  | 83 | $http\_request .= "\r\n"; |
  |  | 84 | $http\_request .= $req; |
  |  | 85 |  |
  |  | 86 | $response = ''; |
  |  | 87 | if( false == ( $fs = @fsockopen($host, $port, $errno, $errstr, 10) ) ) { |
  |  | 88 | die ('Could not open socket'); |
  |  | 89 | } |
  |  | 90 |  |
  |  | 91 | fwrite($fs, $http\_request); |
  |  | 92 |  |
  |  | 93 | while ( !feof($fs) ) |
  |  | 94 | $response .= fgets($fs, 1160); // One TCP-IP packet |
  |  | 95 | fclose($fs); |
  |  | 96 | $response = explode("\r\n\r\n", $response, 2); |
  |  | 97 |  |
  |  | 98 | return $response; |
  |  | 99 | } |
  |  | 100 | } |
  |  | 101 |  |
  |  | 102 |  |
  |  | 103 | /\*\* |
  | 193 | 104 | \* Gets the challenge HTML (javascript and non-javascript version). |
  | 194 |  |  |
  | 195 | 105 | \* This is called from the browser, and the resulting reCAPTCHA HTML widget |
  | 196 |  |  |
  | 197 | 106 | \* is embedded within the HTML form it was called from. |
  | 198 |  |  |
  | 199 | 107 | \* @param string $pubkey A public key for reCAPTCHA |
  | 200 |  |  |
  | 201 | 108 | \* @param string $error The error given by reCAPTCHA (optional, default is null) |
  | 202 |  |  |
  | 203 | 109 | \* @param boolean $use\_ssl Should the request be made over ssl? (optional, default is false) |
  | 204 | 110 |  |
  | 205 |  |  |
  | 206 |  |  |
  | 207 | 111 | \* @return string - The HTML to be embedded in the user's form. |
  | 208 |  |  |
  | 209 |  | \*/ |
  | 210 |  |  |
  | 211 |  | function rp\_recaptcha\_get\_html ($pubkey, $error = null, $use\_ssl = false) |
  | 212 |  |  |
  | 213 |  | { |
  | 214 |  |  |
  | 215 |  | if ($pubkey == null || $pubkey == '') { |
  | 216 |  |  |
  | 217 |  | die ("To use reCAPTCHA you must get an API key from <a href='http://recaptcha.net/api/getkey'>http://recaptcha.net/api/getkey</a>"); |
  | 218 |  |  |
  | 219 |  | } |
  | 220 |  |  |
  | 221 |  |  |
  | 222 |  |  |
  | 223 |  | if ($use\_ssl) { |
  | 224 |  |  |
  | 225 |  | $server = RECAPTCHA\_API\_SECURE\_SERVER; |
  | 226 |  |  |
  | 227 |  | } else { |
  | 228 |  |  |
  | 229 |  | $server = RECAPTCHA\_API\_SERVER; |
  | 230 |  |  |
  | 231 |  | } |
  | 232 |  |  |
  | 233 |  |  |
  | 234 |  |  |
  | 235 |  | $errorpart = ""; |
  | 236 |  |  |
  | 237 |  | if ($error) { |
  | 238 |  |  |
  | 239 |  | $errorpart = "&amp;error=" . $error; |
  | 240 |  |  |
  | 241 |  | } |
  | 242 |  |  |
  | 243 |  | return '<script type="text/javascript" src="'. $server . '/challenge?k=' . $pubkey . $errorpart . '"></script> |
  | 244 |  |  |
  | 245 |  |  |
  | 246 |  |  |
  | 247 |  | <noscript> |
  | 248 |  |  |
  | 249 |  | <iframe src="'. $server . '/noscript?k=' . $pubkey . $errorpart . '" height="300" width="500" frameborder="0"></iframe><br/> |
  | 250 |  |  |
  | 251 |  | <textarea name="recaptcha\_challenge\_field" rows="3" cols="40"></textarea> |
  | 252 |  |  |
  | 253 |  | <input type="hidden" name="recaptcha\_response\_field" value="manual\_challenge"/> |
  | 254 |  |  |
  | 255 |  | </noscript>'; |
  | 256 |  |  |
  | 257 |  | } |
  | 258 |  |  |
  | 259 |  |  |
  | 260 |  |  |
  | 261 |  |  |
  | 262 |  |  |
  | 263 |  |  |
  | 264 |  |  |
  | 265 |  |  |
  | 266 |  |  |
  | 267 |  | /\*\* |
  | 268 |  |  |
  |  | 112 | \*/ |
  |  | 113 | if(!function\_exists('recaptcha\_get\_html')){ |
  |  | 114 | function recaptcha\_get\_html ($pubkey, $error = null, $use\_ssl = false) |
  |  | 115 | { |
  |  | 116 | if ($pubkey == null || $pubkey == '') { |
  |  | 117 | die ("To use reCAPTCHA you must get an API key from <a href='https://www.google.com/recaptcha/admin/create'>https://www.google.com/recaptcha/admin/create</a>"); |
  |  | 118 | } |
  |  | 119 |  |
  |  | 120 | if ($use\_ssl) { |
  |  | 121 | $server = RECAPTCHA\_API\_SECURE\_SERVER; |
  |  | 122 | } else { |
  |  | 123 | $server = RECAPTCHA\_API\_SERVER; |
  |  | 124 | } |
  |  | 125 |  |
  |  | 126 | $errorpart = ""; |
  |  | 127 | if ($error) { |
  |  | 128 | $errorpart = "&amp;error=" . $error; |
  |  | 129 | } |
  |  | 130 | return '<script type="text/javascript" src="'. $server . '/challenge?k=' . $pubkey . $errorpart . '"></script> |
  |  | 131 |  |
  |  | 132 | <noscript> |
  |  | 133 | <iframe src="'. $server . '/noscript?k=' . $pubkey . $errorpart . '" height="300" width="500" frameborder="0"></iframe><br/> |
  |  | 134 | <textarea name="recaptcha\_challenge\_field" rows="3" cols="40"></textarea> |
  |  | 135 | <input type="hidden" name="recaptcha\_response\_field" value="manual\_challenge"/> |
  |  | 136 | </noscript>'; |
  |  | 137 | } |
  |  | 138 | } |
  |  | 139 |  |
  |  | 140 |  |
  |  | 141 |  |
  |  | 142 | /\*\* |
  | 269 | 143 | \* A ReCaptchaResponse is returned from recaptcha\_check\_answer() |
  | 270 |  |  |
  | 271 |  | \*/ |
  | 272 |  |  |
  | 273 |  | class RP\_ReCaptchaResponse { |
  | 274 |  |  |
  | 275 |  | var $is\_valid; |
  | 276 |  |  |
  | 277 |  | var $error; |
  | 278 |  |  |
  | 279 |  | } |
  | 280 |  |  |
  | 281 |  |  |
  | 282 |  |  |
  | 283 |  |  |
  | 284 |  |  |
  | 285 |  | /\*\* |
  | 286 |  |  |
  |  | 144 | \*/ |
  |  | 145 |  |
  |  | 146 | if(!class\_exists('ReCaptchaResponse')){ |
  |  | 147 | class ReCaptchaResponse { |
  |  | 148 | var $is\_valid; |
  |  | 149 | var $error; |
  |  | 150 | } |
  |  | 151 | } |
  |  | 152 |  |
  |  | 153 |  |
  |  | 154 | /\*\* |
  | 287 | 155 | \* Calls an HTTP POST function to verify if the user's guess was correct |
  | 288 |  |  |
  | 289 | 156 | \* @param string $privkey |
  | 290 |  |  |
  | 291 | 157 | \* @param string $remoteip |
  | 292 |  |  |
  | 293 | 158 | \* @param string $challenge |
  | 294 |  |  |
  | 295 | 159 | \* @param string $response |
  | 296 |  |  |
  | 297 | 160 | \* @param array $extra\_params an array of extra variables to post to the server |
  | 298 |  |  |
  | 299 | 161 | \* @return ReCaptchaResponse |
  | 300 |  |  |
  | 301 | 162 | \*/ |
  | 302 |  |  |
  | 303 |  | function rp\_recaptcha\_check\_answer ($privkey, $remoteip, $challenge, $response, $extra\_params = array()) |
  | 304 |  |  |
  | 305 |  | { |
  | 306 |  |  |
  | 307 |  | if ($privkey == null || $privkey == '') { |
  | 308 |  |  |
  | 309 |  | die ("To use reCAPTCHA you must get an API key from <a href='http://recaptcha.net/api/getkey'>http://recaptcha.net/api/getkey</a>"); |
  | 310 |  |  |
  | 311 |  | } |
  | 312 |  |  |
  | 313 |  |  |
  | 314 |  |  |
  | 315 |  | if ($remoteip == null || $remoteip == '') { |
  | 316 |  |  |
  | 317 |  | die ("For security reasons, you must pass the remote ip to reCAPTCHA"); |
  | 318 |  |  |
  | 319 |  | } |
  | 320 |  |  |
  | 321 |  |  |
  | 322 |  |  |
  | 323 |  |  |
  | 324 |  |  |
  | 325 |  |  |
  | 326 |  |  |
  | 327 |  | //discard spam submissions |
  | 328 |  |  |
  | 329 |  | if ($challenge == null || strlen($challenge) == 0 || $response == null || strlen($response) == 0) { |
  | 330 |  |  |
  | 331 |  | $recaptcha\_response = new RP\_ReCaptchaResponse(); |
  | 332 |  |  |
  | 333 |  | $recaptcha\_response->is\_valid = false; |
  | 334 |  |  |
  | 335 |  | $recaptcha\_response->error = 'incorrect-captcha-sol'; |
  | 336 |  |  |
  | 337 |  | return $recaptcha\_response; |
  | 338 |  |  |
  | 339 |  | } |
  | 340 |  |  |
  | 341 |  |  |
  | 342 |  |  |
  | 343 |  | $response = \_rp\_recaptcha\_http\_post (RECAPTCHA\_VERIFY\_SERVER, "/verify", |
  | 344 |  |  |
  | 345 |  | array ( |
  | 346 |  |  |
  | 347 |  | 'privatekey' => $privkey, |
  | 348 |  |  |
  | 349 |  | 'remoteip' => $remoteip, |
  | 350 |  |  |
  | 351 |  | 'challenge' => $challenge, |
  | 352 |  |  |
  | 353 |  | 'response' => $response |
  | 354 |  |  |
  | 355 |  | ) + $extra\_params |
  | 356 |  |  |
  | 357 |  | ); |
  | 358 |  |  |
  | 359 |  |  |
  | 360 |  |  |
  | 361 |  | $answers = explode ("\n", $response [1]); |
  | 362 |  |  |
  | 363 |  | $recaptcha\_response = new RP\_ReCaptchaResponse(); |
  | 364 |  |  |
  | 365 |  |  |
  | 366 |  |  |
  | 367 |  | if (trim ($answers [0]) == 'true') { |
  | 368 |  |  |
  | 369 |  | $recaptcha\_response->is\_valid = true; |
  | 370 |  |  |
  | 371 |  | } |
  | 372 |  |  |
  | 373 |  | else { |
  | 374 |  |  |
  | 375 |  | $recaptcha\_response->is\_valid = false; |
  | 376 |  |  |
  | 377 |  | $recaptcha\_response->error = $answers [1]; |
  | 378 |  |  |
  | 379 |  | } |
  | 380 |  |  |
  | 381 |  | return $recaptcha\_response; |
  | 382 |  |  |
  | 383 |  |  |
  | 384 |  |  |
  | 385 |  | } |
  | 386 |  |  |
  | 387 |  |  |
  | 388 |  |  |
  | 389 |  | /\*\* |
  | 390 |  |  |
  |  | 163 | if(!function\_exists('recaptcha\_check\_answer')){ |
  |  | 164 | function recaptcha\_check\_answer ($privkey, $remoteip, $challenge, $response, $extra\_params = array()) |
  |  | 165 | { |
  |  | 166 | if ($privkey == null || $privkey == '') { |
  |  | 167 | die ("To use reCAPTCHA you must get an API key from <a href='https://www.google.com/recaptcha/admin/create'>https://www.google.com/recaptcha/admin/create</a>"); |
  |  | 168 | } |
  |  | 169 |  |
  |  | 170 | if ($remoteip == null || $remoteip == '') { |
  |  | 171 | die ("For security reasons, you must pass the remote ip to reCAPTCHA"); |
  |  | 172 | } |
  |  | 173 |  |
  |  | 174 |  |
  |  | 175 |  |
  |  | 176 | //discard spam submissions |
  |  | 177 | if ($challenge == null || strlen($challenge) == 0 || $response == null || strlen($response) == 0) { |
  |  | 178 | $recaptcha\_response = new ReCaptchaResponse(); |
  |  | 179 | $recaptcha\_response->is\_valid = false; |
  |  | 180 | $recaptcha\_response->error = 'incorrect-captcha-sol'; |
  |  | 181 | return $recaptcha\_response; |
  |  | 182 | } |
  |  | 183 |  |
  |  | 184 | $response = \_recaptcha\_http\_post (RECAPTCHA\_VERIFY\_SERVER, "/recaptcha/api/verify", |
  |  | 185 | array ( |
  |  | 186 | 'privatekey' => $privkey, |
  |  | 187 | 'remoteip' => $remoteip, |
  |  | 188 | 'challenge' => $challenge, |
  |  | 189 | 'response' => $response |
  |  | 190 | ) + $extra\_params |
  |  | 191 | ); |
  |  | 192 |  |
  |  | 193 | $answers = explode ("\n", $response [1]); |
  |  | 194 | $recaptcha\_response = new ReCaptchaResponse(); |
  |  | 195 |  |
  |  | 196 | if (trim ($answers [0]) == 'true') { |
  |  | 197 | $recaptcha\_response->is\_valid = true; |
  |  | 198 | } |
  |  | 199 | else { |
  |  | 200 | $recaptcha\_response->is\_valid = false; |
  |  | 201 | $recaptcha\_response->error = $answers [1]; |
  |  | 202 | } |
  |  | 203 | return $recaptcha\_response; |
  |  | 204 |  |
  |  | 205 | } |
  |  | 206 | } |
  |  | 207 | /\*\* |
  | 391 | 208 | \* gets a URL where the user can sign up for reCAPTCHA. If your application |
  | 392 |  |  |
  | 393 | 209 | \* has a configuration page where you enter a key, you should provide a link |
  | 394 |  |  |
  | 395 | 210 | \* using this function. |
  | 396 |  |  |
  | 397 | 211 | \* @param string $domain The domain where the page is hosted |
  | 398 |  |  |
  | 399 | 212 | \* @param string $appname The name of your application |
  | 400 |  |  |
  | 401 |  | \*/ |
  | 402 |  |  |
  | 403 |  | function rp\_recaptcha\_get\_signup\_url ($domain = null, $appname = null) { |
  | 404 |  |  |
  | 405 |  | return "http://recaptcha.net/api/getkey?" .  \_rp\_recaptcha\_qsencode (array ('domain' => $domain, 'app' => $appname)); |
  | 406 |  |  |
  | 407 |  | } |
  | 408 |  |  |
  | 409 |  |  |
  | 410 |  |  |
  | 411 |  | function \_rp\_recaptcha\_aes\_pad($val) { |
  | 412 |  |  |
  | 413 |  | $block\_size = 16; |
  | 414 |  |  |
  | 415 |  | $numpad = $block\_size - (strlen ($val) % $block\_size); |
  | 416 |  |  |
  | 417 |  | return str\_pad($val, strlen ($val) + $numpad, chr($numpad)); |
  | 418 |  |  |
  | 419 |  | } |
  | 420 |  |  |
  | 421 |  |  |
  |  | 213 | \*/ |
  |  | 214 | if(!function\_exists('recaptcha\_get\_signup\_url')){ |
  |  | 215 | function recaptcha\_get\_signup\_url ($domain = null, $appname = null) { |
  |  | 216 | return "https://www.google.com/recaptcha/admin/create?" .  \_recaptcha\_qsencode (array ('domains' => $domain, 'app' => $appname)); |
  |  | 217 | } |
  |  | 218 | } |
  |  | 219 |  |
  |  | 220 | if(!function\_exists('\_recaptcha\_aes\_pad')){ |
  |  | 221 | function \_recaptcha\_aes\_pad($val) { |
  |  | 222 | $block\_size = 16; |
  |  | 223 | $numpad = $block\_size - (strlen ($val) % $block\_size); |
  |  | 224 | return str\_pad($val, strlen ($val) + $numpad, chr($numpad)); |
  |  | 225 | } |
  |  | 226 | } |
  | 422 | 227 |  |
  | 423 | 228 | /\* Mailhide related code \*/ |
  | 424 | 229 |  |
  | 425 |  |  |
  | 426 |  |  |
  | 427 |  | function \_rp\_recaptcha\_aes\_encrypt($val,$ky) { |
  | 428 |  |  |
  | 429 |  | if (! function\_exists ("mcrypt\_encrypt")) { |
  | 430 |  |  |
  | 431 |  | die ("To use reCAPTCHA Mailhide, you need to have the mcrypt php module installed."); |
  | 432 |  |  |
  | 433 |  | } |
  | 434 |  |  |
  | 435 |  | $mode=MCRYPT\_MODE\_CBC; |
  | 436 |  |  |
  | 437 |  | $enc=MCRYPT\_RIJNDAEL\_128; |
  | 438 |  |  |
  | 439 |  | $val=\_rp\_recaptcha\_aes\_pad($val); |
  | 440 |  |  |
  | 441 |  | return mcrypt\_encrypt($enc, $ky, $val, $mode, "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"); |
  | 442 |  |  |
  | 443 |  | } |
  | 444 |  |  |
  | 445 |  |  |
  | 446 |  |  |
  | 447 |  |  |
  | 448 |  |  |
  | 449 |  | function \_rp\_recaptcha\_mailhide\_urlbase64 ($x) { |
  | 450 |  |  |
  | 451 |  | return strtr(base64\_encode ($x), '+/', '-\_'); |
  | 452 |  |  |
  | 453 |  | } |
  | 454 |  |  |
  | 455 |  |  |
  | 456 |  |  |
  |  | 230 | if(!function\_exists('\_recaptcha\_aes\_encrypt')){ |
  |  | 231 | function \_recaptcha\_aes\_encrypt($val,$ky) { |
  |  | 232 | if (! function\_exists ("mcrypt\_encrypt")) { |
  |  | 233 | die ("To use reCAPTCHA Mailhide, you need to have the mcrypt php module installed."); |
  |  | 234 | } |
  |  | 235 | $mode=MCRYPT\_MODE\_CBC; |
  |  | 236 | $enc=MCRYPT\_RIJNDAEL\_128; |
  |  | 237 | $val=\_recaptcha\_aes\_pad($val); |
  |  | 238 | return mcrypt\_encrypt($enc, $ky, $val, $mode, "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"); |
  |  | 239 | } |
  |  | 240 | } |
  |  | 241 |  |
  |  | 242 | if(!function\_exists('\_recaptcha\_mailhide\_urlbase64')){ |
  |  | 243 | function \_recaptcha\_mailhide\_urlbase64 ($x) { |
  |  | 244 | return strtr(base64\_encode ($x), '+/', '-\_'); |
  |  | 245 | } |
  |  | 246 | } |
  |  | 247 |  |
  |  | 248 | if(!function\_exists('recaptcha\_mailhide\_url')){ |
  | 457 | 249 | /\* gets the reCAPTCHA Mailhide url for a given email, public key and private key \*/ |
  | 458 |  |  |
  | 459 |  | function rp\_recaptcha\_mailhide\_url($pubkey, $privkey, $email) { |
  | 460 |  |  |
  | 461 |  | if ($pubkey == '' || $pubkey == null || $privkey == "" || $privkey == null) { |
  | 462 |  |  |
  | 463 |  | die ("To use reCAPTCHA Mailhide, you have to sign up for a public and private key, " . |
  | 464 |  |  |
  | 465 |  | "you can do so at <a href='http://mailhide.recaptcha.net/apikey'>http://mailhide.recaptcha.net/apikey</a>"); |
  | 466 |  |  |
  | 467 |  | } |
  | 468 |  |  |
  | 469 |  |  |
  | 470 |  |  |
  | 471 |  |  |
  | 472 |  |  |
  | 473 |  | $ky = pack('H\*', $privkey); |
  | 474 |  |  |
  | 475 |  | $cryptmail = \_rp\_recaptcha\_aes\_encrypt ($email, $ky); |
  | 476 |  |  |
  | 477 |  |  |
  | 478 |  |  |
  | 479 |  | return "http://mailhide.recaptcha.net/d?k=" . $pubkey . "&c=" . \_rp\_recaptcha\_mailhide\_urlbase64 ($cryptmail); |
  | 480 |  |  |
  | 481 |  | } |
  | 482 |  |  |
  | 483 |  |  |
  | 484 |  |  |
  | 485 |  | /\*\* |
  | 486 |  |  |
  |  | 250 | function recaptcha\_mailhide\_url($pubkey, $privkey, $email) { |
  |  | 251 | if ($pubkey == '' || $pubkey == null || $privkey == "" || $privkey == null) { |
  |  | 252 | die ("To use reCAPTCHA Mailhide, you have to sign up for a public and private key, " . |
  |  | 253 | "you can do so at <a href='http://www.google.com/recaptcha/mailhide/apikey'>http://www.google.com/recaptcha/mailhide/apikey</a>"); |
  |  | 254 | } |
  |  | 255 |  |
  |  | 256 |  |
  |  | 257 | $ky = pack('H\*', $privkey); |
  |  | 258 | $cryptmail = \_recaptcha\_aes\_encrypt ($email, $ky); |
  |  | 259 |  |
  |  | 260 | return "http://www.google.com/recaptcha/mailhide/d?k=" . $pubkey . "&c=" . \_recaptcha\_mailhide\_urlbase64 ($cryptmail); |
  |  | 261 | } |
  |  | 262 | } |
  |  | 263 |  |
  |  | 264 | /\*\* |
  | 487 | 265 | \* gets the parts of the email to expose to the user. |
  | 488 |  |  |
  | 489 | 266 | \* eg, given johndoe@example,com return ["john", "example.com"]. |
  | 490 |  |  |
  | 491 | 267 | \* the email is then displayed as john...@example.com |
  | 492 |  |  |
  | 493 |  | \*/ |
  | 494 |  |  |
  | 495 |  | function \_rp\_recaptcha\_mailhide\_email\_parts ($email) { |
  | 496 |  |  |
  | 497 |  | $arr = preg\_split("/@/", $email ); |
  | 498 |  |  |
  | 499 |  |  |
  | 500 |  |  |
  | 501 |  | if (strlen ($arr[0]) <= 4) { |
  | 502 |  |  |
  | 503 |  | $arr[0] = substr ($arr[0], 0, 1); |
  | 504 |  |  |
  | 505 |  | } else if (strlen ($arr[0]) <= 6) { |
  | 506 |  |  |
  | 507 |  | $arr[0] = substr ($arr[0], 0, 3); |
  | 508 |  |  |
  | 509 |  | } else { |
  | 510 |  |  |
  | 511 |  | $arr[0] = substr ($arr[0], 0, 4); |
  | 512 |  |  |
  | 513 |  | } |
  | 514 |  |  |
  | 515 |  | return $arr; |
  | 516 |  |  |
  | 517 |  | } |
  | 518 |  |  |
  | 519 |  |  |
  | 520 |  |  |
  | 521 |  | /\*\* |
  | 522 |  |  |
  |  | 268 | \*/ |
  |  | 269 | if(!function\_exists('\_recaptcha\_mailhide\_email\_parts')){ |
  |  | 270 | function \_recaptcha\_mailhide\_email\_parts ($email) { |
  |  | 271 | $arr = preg\_split("/@/", $email ); |
  |  | 272 |  |
  |  | 273 | if (strlen ($arr[0]) <= 4) { |
  |  | 274 | $arr[0] = substr ($arr[0], 0, 1); |
  |  | 275 | } else if (strlen ($arr[0]) <= 6) { |
  |  | 276 | $arr[0] = substr ($arr[0], 0, 3); |
  |  | 277 | } else { |
  |  | 278 | $arr[0] = substr ($arr[0], 0, 4); |
  |  | 279 | } |
  |  | 280 | return $arr; |
  |  | 281 | } |
  |  | 282 | } |
  |  | 283 |  |
  |  | 284 | /\*\* |
  | 523 | 285 | \* Gets html to display an email address given a public an private key. |
  | 524 |  |  |
  | 525 | 286 | \* to get a key, go to: |
  | 526 |  |  |
  | 527 |  | \* |
  | 528 |  |  |
  | 529 |  | \* http://mailhide.recaptcha.net/apikey |
  | 530 |  |  |
  | 531 |  | \*/ |
  | 532 |  |  |
  | 533 |  | function rp\_recaptcha\_mailhide\_html($pubkey, $privkey, $email) { |
  | 534 |  |  |
  | 535 |  | $emailparts = \_rp\_recaptcha\_mailhide\_email\_parts ($email); |
  | 536 |  |  |
  | 537 |  | $url = rp\_recaptcha\_mailhide\_url ($pubkey, $privkey, $email); |
  | 538 |  |  |
  | 539 |  |  |
  | 540 |  |  |
  | 541 |  | return htmlentities($emailparts[0]) . "<a href='" . htmlentities ($url) . |
  | 542 |  |  |
  | 543 |  | "' onclick=\"window.open('" . htmlentities ($url) . "', '', 'toolbar=0,scrollbars=0,location=0,statusbar=0,menubar=0,resizable=0,width=500,height=300'); return false;\" title=\"Reveal this e-mail address\">...</a>@" . htmlentities ($emailparts [1]); |
  | 544 |  |  |
  | 545 |  |  |
  | 546 |  |  |
  | 547 |  | } |
  | 548 |  |  |
  | 549 |  |  |
  | 550 |  |  |
  | 551 |  |  |
  |  | 287 | \* |
  |  | 288 | \* http://www.google.com/recaptcha/mailhide/apikey |
  |  | 289 | \*/ |
  |  | 290 | if(!function\_exists('recaptcha\_mailhide\_html')){ |
  |  | 291 | function recaptcha\_mailhide\_html($pubkey, $privkey, $email) { |
  |  | 292 | $emailparts = \_recaptcha\_mailhide\_email\_parts ($email); |
  |  | 293 | $url = recaptcha\_mailhide\_url ($pubkey, $privkey, $email); |
  |  | 294 |  |
  |  | 295 | return htmlentities($emailparts[0]) . "<a href='" . htmlentities ($url) . |
  |  | 296 | "' onclick=\"window.open('" . htmlentities ($url) . "', '', 'toolbar=0,scrollbars=0,location=0,statusbar=0,menubar=0,resizable=0,width=500,height=300'); return false;\" title=\"Reveal this e-mail address\">...</a>@" . htmlentities ($emailparts [1]); |
  |  | 297 |  |
  |  | 298 | } |
  |  | 299 | } |
  | 552 | 300 |  |
  | 553 | 301 | ?> |
  | 554 |  |  |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=740249)
* [Zip Archive](?format=zip&new=740249)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from wordpress.org_ffbc68c1_20250124_184049.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Registration Forms – User Registration Forms, Invitation-Based Registrations, Front-end User Profile, Login Form & Content Restriction

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fpie-register&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fpie-register&locale=en_US)

Search plugins

![](https://ps.w.org/pie-register/assets/banner-772x250.jpg?rev=2858772)
![](https://ps.w.org/pie-register/assets/icon-256x256.png?rev=2467686)
# Registration Forms – User Registration Forms, Invitation-Based Registrations, Front-end User Profile, Login Form & Content Restriction

By [Pie Register](https://pieregister.com/)

[Download](https://downloads.wordpress.org/plugin/pie-register.3.8.3.9.zip)

* [Details](https://wordpress.org/plugins/pie-register/#description)
* [Reviews](https://wordpress.org/plugins/pie-register/#reviews)
* [Development](https://wordpress.org/plugins/pie-register/#developers)

[Support](https://wordpress.org/support/plugin/pie-register/)

## Description

*Create customized registration forms, Invite through email, Email Notification, User Roles assignment, and more.* Pie Register is a [User Registration plugin](https://pieregister.com/features/?utm_source=plugin-freeversion&utm_medium=wordpressorg&utm_campaign=go_pro&utm_content=website) to help you create custom Login and Registration forms in minutes, with no coding skills required. You can customize the registration process and build advance registration flows using the various form fields. The plugin also comes with some additional security features to keep your website spam-free. Restrict content for exclusive Membership-based websites based on different user roles with Pie Register’s visibility restriction feature. You can create dynamic forms by giving your forms a personalized touch with Conditional Logic. Pie Register accepts payments using multiple payment gateways and restricts user registration based on invitations. Pie Register has extensive documentation and video tutorials to help you get started. It has an active support system that responds to your queries within 24 hours. **The Best Part** Pie Register offers **perpetual licensing – purchase once and use for a lifetime!**  = FREE KEY FEATURES: = \* Drag and Drop Form Builder \* Front-end User Profiles \* Front-end User Registration \* Front-end user Login \* PasswordLess Registration \* Advanced Fields \* Set Redirection after Sign-up and Login \* Verify and Moderate User Registration \* Spam Protection \* PayPal Standard – Payment Gateway \* User Emails Templates and Automation \* Invite-Based Registration \* Auto-generate Password \* Content Restriction \* Data Import/Export \* Custom User Roles \* Profile Picture \* ReCaptcha \* Admin Helper Application \* Shortcodes \* Community Support \* Developer friendly with dozens of actions and filters = KEY FEATURES AVAILABLE IN FREE AND PRO VERSIONS WITH BASIC AND ADVANCED OPTIONS: = \* File Upload \* Verify and Moderate User Registration \* Spam Protection \* Custom User Roles \* Invite-based Registration for Exclusive Websites \* User and Admin Email Notification Templates \* Data Import/Export \* Content Restriction \* Frontend User Login and forgot password forms = PREMIUM KEY FEATURES: = \* Unlimited Registration Forms \* Advanced Fields \* Role-based Redirection \* Invite through emails \* Multiple Payment Gateways \* Customizable Login Security \* Timed-form submission (Define time in seconds to lock-out the bots) \* Auto-login after Registration \* Custom User Roles \* User and Admin Email Notification Templates and Automation \* Data Import/Export \* Global Content Restriction \* Restrict Widgets \* Allow and Block users \* Limit Form Entries Per Device \* hCaptcha \* Honeypot \* Conditional Logic \* Ticket-based Support [Complete Feature List](https://pieregister.com/features/?utm_source=plugin-freeversion&utm_medium=wordpressorg&utm_campaign=go_pro&utm_content=website) = Invitation-based Registration: = \* Generate invitation codes \* Auto Generate invitation codes \* Invite Users through Email \* Allow Users to Invite Other Users \* Track user Invitations = Make Your Forms More Advanced With Our Premium Add-ons = **[PayPal Subscriptions (Payment Gateway) Add-on](https://pieregister.com/addons/paypal-recurring-payments-add-on/?utm_source=plugin-freeversion&utm_medium=wordpressorg&utm_campaign=go_pro&utm_content=addons)** Allow users to make recurring payments and view subscription using the PayPal Subscriptions add-on. **[Stripe Recurring (Payment Gateway) Add-on](https://pieregister.com/addons/stripe-recurring-addon/?utm_source=plugin-freeversion&utm_medium=wordpressorg&utm_campaign=go_pro&utm_content=addons)** Allow users to make recurring payments and view active subscriptions using the Stripe recurring payment add-on. **[Stripe One-Time (Payment Gateway) Add-on](https://pieregister.com/addons/stripe-payment-addon/?utm_source=plugin-freeversion&utm_medium=wordpressorg&utm_campaign=go_pro&utm_content=addons)** Process membership payments using Pie Register’s Stripe Add-on. **[Authroize.net (Payment Gateway ) Add-on](https://pieregister.com/addons/authorize-net-payment-addon/?utm_source=plugin-freeversion&utm_medium=wordpressorg&utm_campaign=go_pro&utm_content=addons)** Use Authorize.net Add-on to collect membership payments on Pie Register. **[Social Login Add-on](https://pieregister.com/addons/social-login-addon/?utm_source=plugin-freeversion&utm_medium=wordpressorg&utm_campaign=go_pro&utm_content=addons)** Let users log in via their social handles, i-e, Facebook, Twitter, Google, LinkedIn, Yahoo, and WordPress accounts, to make the registration process quick and hassle-free. **[MailChimp Add-on](https://pieregister.com/addons/mailchimp-addon/?utm_source=plugin-freeversion&utm_medium=wordpressorg&utm_campaign=go_pro&utm_content=addons)** Export site users into MailChimp lists to send communication, sales, and marketing emails using the admin dashboard. **[Twilio - Two-step Authentication (SMS) Add-on](https://pieregister.com/addons/two-step-authentication-addon/?utm_source=plugin-freeversion&utm_medium=wordpressorg&utm_campaign=go_pro&utm_content=addons)** Want to have a super-secure site? No Problem. With Pie Register and TWILIO, you can verify registration via SMS/Text messages sent to their cell phones. The admin can get notified when new users register. **[Profile Search Add-on](https://pieregister.com/addons/profile-search-addon/?utm_source=plugin-freeversion&utm_medium=wordpressorg&utm_campaign=go_pro&utm_content=addons)** Allow users to search/filter to display user data with the Profile Search tool. User information displayed in the filtered/search results can be limited based on the admin’s choice. **[Geo Location Add-on](https://pieregister.com/addons/geolocation/?utm_source=plugin-freeversion&utm_medium=wordpressorg&utm_campaign=go_pro&utm_content=addons)** It lets you collect user Geolocation data and provides information like country, city, zip code, latitude/longitude, and location map for registered users. **[Bulk Email Add-on](https://pieregister.com/addons/bulk-email-addon/?utm_source=plugin-freeversion&utm_medium=wordpressorg&utm_campaign=go_pro&utm_content=addons)** Send emails in bulk to all the registered users at once. Select the form name, and all the users registered through that form and send emails in one go! **[Field visibility Add-on](https://pieregister.com/addons/field-visibility-addon/?utm_source=plugin-freeversion&utm_medium=wordpressorg&utm_campaign=go_pro&utm_content=addons)** Allows you to show or hide specific fields on the front-end registration form or the user’s profile page. **[WooCommerce Add-on](https://pieregister.com/addons/woocommerce-addon/?utm_source=plugin-freeversion&utm_medium=wordpressorg&utm_campaign=go_pro&utm_content=addons)** Hide or display specific Pie Register fields on the WooCommerce checkout page. Also, you can add billing and shipping fields to your registration form. Replace the default WooCommerce login and registration forms with Pie Register login and registration forms, and send a free gift product upon registration. **[bbPress Add-on](https://pieregister.com/addons/bbpress-addon/?utm_source=plugin-freeversion&utm_medium=wordpressorg&utm_campaign=go_pro&utm_content=addons)** Show the Pie Register fields on your bbPress User profile, and let your users edit the profile directly from bbPress. [Add-ons Details](https://pieregister.com/addons/?utm_source=plugin-freeversion&utm_medium=wordpressorg&utm_campaign=go_pro&utm_content=website) = INTEGRATIONS WITH THIRD-PARTY APPLICATIONS = 1. [Paypal](https://www.paypal.com/pk/home) 2. [Stripe](https://stripe.com/) 3. [Authorize.net](https://www.authorize.net/) 4. [Twilio SMS](https://www.twilio.com/sms) 5. [Mailchimp](https://mailchimp.com/) 6. [Elementor](https://elementor.com/) 7. [WPBakery Page Builder](https://wpbakery.com/) 8. [Divi](https://www.elegantthemes.com/) 9. [WooCommerce](https://woocommerce.com/) = Useful Resources: = Community forum: <https://wordpress.org/support/plugin/pie-register/> Blog: <https://pieregister.com/blog/> Contact Us: <https://pieregister.com/contact-us/> Get Started: <https://pieregister.com/documentation/> Video Tutorials: <https://www.youtube.com/channel/UCuLxfC2jcyAS5ns4ZT_7jcQ> Give Pie Register a try! And you will know how amazing it is! ***Unlock more features? Upgrade to our [PRO version](https://pieregister.com/plan-and-pricing/?utm_source=plugin-freeversion&utm_medium=wordpressorg&utm_campaign=go_pro&utm_content=website)*** = SHORTCODES: = Here are some basic form shortcodes that you can embed: \* For login form use: **[pie\_register\_login]** \* For Registration form use: **[pie\_register\_form]** \* For forgot password form use: **[pie\_register\_forgot\_password]** \* For profile page use: **[pie\_register\_profile]** **What’s Next?** Liked Pie Register? Do check out our other projects. [Pie Forms](https://pieforms.com/?utm_source=pieregister&utm_medium=repo&utm_campaign=detailtab): Pie Forms is your custom Drag and Drop Form Builder with a user-friendly interface, built-in ready-to-use templates, and various Form Field options to Create Advanced Forms without a single line of code. Apart from simple registration, it lets you create all forms, including contact forms, surveys, job applications, appointments, etc. [PB addons for WPBakery](https://pagebuilderaddons.com/?utm_source=pieregister&utm_medium=repo&utm_campaign=detailtab): Build your website with premium quality Web and WooCommerce elements for WPBakery Page Builder.

## Screenshots

* [![](https://ps.w.org/pie-register/assets/screenshot-1.jpg?rev=2196371)](https://ps.w.org/pie-register/assets/screenshot-1.jpg?rev=2196371)

  Registration Form Builder
* [![](https://ps.w.org/pie-register/assets/screenshot-2.jpg?rev=2196371)](https://ps.w.org/pie-register/assets/screenshot-2.jpg?rev=2196371)

  Notifications
* [![](https://ps.w.org/pie-register/assets/screenshot-3.jpg?rev=2196371)](https://ps.w.org/pie-register/assets/screenshot-3.jpg?rev=2196371)

  Payment Gateways
* [![](https://ps.w.org/pie-register/assets/screenshot-4.jpg?rev=2196371)](https://ps.w.org/pie-register/assets/screenshot-4.jpg?rev=2196371)

  Settings
* [![](https://ps.w.org/pie-register/assets/screenshot-5.jpg?rev=2196371)](https://ps.w.org/pie-register/assets/screenshot-5.jpg?rev=2196371)

  Attachments (Available in Premium)
* [![](https://ps.w.org/pie-register/assets/screenshot-6.jpg?rev=2196371)](https://ps.w.org/pie-register/assets/screenshot-6.jpg?rev=2196371)

  Invitation Codes
* [![](https://ps.w.org/pie-register/assets/screenshot-7.jpg?rev=2196371)](https://ps.w.org/pie-register/assets/screenshot-7.jpg?rev=2196371)

  Invitation Codes – Auto Generate Codes (Available in Premium version)
* [![](https://ps.w.org/pie-register/assets/screenshot-8.jpg?rev=2196371)](https://ps.w.org/pie-register/assets/screenshot-8.jpg?rev=2196371)

  Invitation Codes – Invite through email (Available in Premium version)
* [![](https://ps.w.org/pie-register/assets/screenshot-9.jpg?rev=2196371)](https://ps.w.org/pie-register/assets/screenshot-9.jpg?rev=2196371)

  Block Users (Available in Premium version)
* [![](https://ps.w.org/pie-register/assets/screenshot-10.jpg?rev=2196371)](https://ps.w.org/pie-register/assets/screenshot-10.jpg?rev=2196371)

  Import/Export

## Blocks

This plugin provides 1 block.

* Form Selector

## FAQ

### Who should use Pie Register?

Pie Register is perfect for membership websites for independent consultants, freelancers, and businesses alike. If you want to create a custom registration form for your WordPress site, you need to use Pie Register.

### Do I need coding skills to use Pie Register?

Absolutely not. You can create and manage forms without any coding knowledge. Simply drag and drop the fields onto the form to quickly create full-featured registration forms. Our easy-to-use features help you create complex registration forms within minutes.

### How can I be protected from spammers?

Pie Register has built-in support for reCaptcha that prevents bots or spammers from getting registered. There are numerous other anti-spamming features in Pie Register that help keep your registration process secure and spam-free.

### I don’t want my blog/website to be overcrowded? What to do?

You can use the Invitation Codes feature to block unwanted registrations.

### How can I prevent fake email addresses from registering?

You can enable the Email Validation feature from the Pie Register Settings page to send an email with a unique verification link every time a user gets registered.

### How can I embed the Login/Forgot Password/Registration forms on my Custom Page(s) or sidebar?

With the use of Shortcodes ([pie\_register\_login], [pie\_register\_forgot\_password] & [pie\_register\_form]) and built-in widgets, Pie Register allows you to place your forms anywhere you want on the website.

### How do I set up the Profile pages?

Pie-Register provides you with a shortcode ([pie\_register\_profile]) to display the front-end profile page, allowing your users to edit their profiles. Enjoy the liberty to insert the shortcode on any page or even on custom post types.

### How do I embed Forgot password login into the theme or in custom pages?

You can embed Forgot password login into your theme and custom pages by inserting a simple shortcode ([pie\_register\_forgot\_password]).

### How to accept payments via Pie Register?

Pie Register allows you to accept payments via Paypal, Stripe (paid add-on), and Authorize.net (paid add-on) by simply adding a membership field to your forms and synchronizing the details of the payment gateway with it.

### Can I send/receive email alerts using Pie Register?

Yes, the admin can receive email alerts on the registration of a new user or when a user updates his profile. They can also send email alerts to users when their account is ready or activated, for email verification, and more. Pie Register offers 15 default templates for user notifications.

### How can I moderate registrations in Pie Register?

You can verify and moderate registrations by choosing a method for verification from the Security Tab under the Settings option. Pie Register gives you three options to select from:

Admin Approval

Verify Email Address

Admin Approval AND Verify Email Address **(Premium)**

### Can we customize the custom login form?

You can change/remove the label field and add a placeholder text to your custom login form in Pie Register. It adds in the functionality of verifying registrations and lets you block users too.

### What if I do not want to use the custom login form?

Verifications and block user functionality won’t work if you do not want to use the custom login form by Pie Register.

### How to add styles to your Pie Register forms?

To make your forms more interactive, you can simply add custom CSS in the stylesheet of your current theme.

### How to make registrations PasswordLess with Pie Register?

Remove the password field from your forms and send an automated email on registrations by adding the auto-generated password in the email body using the replacement key.

## Reviews

![](https://secure.gravatar.com/avatar/6d7359ec2de61c777ec3293b4d7af5044311cdfe4055d5b53220b7351568d37b?s=60&d=retro&r=g)
### [Fulfills our needs for member registration](https://wordpress.org/support/topic/fulfills-our-needs-for-member-registration/)

[danhansen](https://profiles.wordpress.org/danhansen/ "Posts by danhansen")
October 25, 2024

It’s does what is must and then some.
For us it was a need for a simple way og getting our members to register and then giving them access to the member areas for volunteers.

![](https://secure.gravatar.com/avatar/0523e6ebd04e45fab19abae64b1de8c3098b497d7f95e4a5ad10df4e48d761a0?s=60&d=retro&r=g)
### [Not Bad, but not really good](https://wordpress.org/support/topic/not-bad-but-not-really-good/)

[ernstwg](https://profiles.wordpress.org/ernstwg/ "Posts by ernstwg")
September 21, 2024

Overall there’s no huge effect. And some features seem to be performed though they were not activated.
Thanks

![](https://secure.gravatar.com/avatar/b5b6e8a275184b6409d753f60b4423574d26e8c2da80e8ae72648f91cc8b7ebe?s=60&d=retro&r=g)
### [Amazing Plugin with necessary features in free version](https://wordpress.org/support/topic/amazing-plugin-with-necessary-features-in-free-version/)

[Atta Ur Rehman](https://profiles.wordpress.org/atta-ur-rehman/ "Posts by Atta Ur Rehman")
May 17, 2024

I love this plugin becuase they proivded necessary features in free version and very easy to manage.

![](https://secure.gravatar.com/avatar/107e08b642c85ee2eb5ad2765460db1905428561144f65cbc957211a71d13a5d?s=60&d=retro&r=g)
### [Excellent support](https://wordpress.org/support/topic/excellent-support-2205/)

[julien59000](https://profiles.wordpress.org/julien59000/ "Posts by julien59000")
March 25, 2024

It says it all. Top notch support and strong plugin.

![](https://secure.gravatar.com/avatar/c4083b6ddb8499b0ef8a5ccff7abbca44bda1ff6d4cddf8a42b446dfec18c2a0?s=60&d=retro&r=g)
### [Useful plugin](https://wordpress.org/support/topic/useful-plugin-987/)

[cesii](https://profiles.wordpress.org/cesii/ "Posts by cesii")
October 29, 2023

It works well, and the support team they’re really helpful even when you’re using the free version of it

![](https://secure.gravatar.com/avatar/b97209566c085a038a343fbb5f93fee7cacc15d8d63635dfa5119350b43ea962?s=60&d=retro&r=g)
### [Plugin is good, support could be better](https://wordpress.org/support/topic/plugin-is-good-support-could-be-better/)

[Arber Braja](https://profiles.wordpress.org/arberbr/ "Posts by Arber Braja")
June 7, 2023

So, the plugin is pretty good actually. Does what it says it does and does them well. Tested it initially on a local environment, worked for all I wanted to do, had no trouble during installation or license activation.
Then decided to use the plugin on the live site since it passed the test. Run into trouble with license activation.
Had to open a support ticket so they could help me with that and they did help me with that.
However I did run into trouble with the license activation. -1 star for this.
The other thing I noticed is that the support is kind of slow. I mean I payed a decent amount of money, and support answered back very slowly. -1 star for this.
Conclusion:
The plugin itself is pretty good. I liked the capabilities it offers and it helps A LOT. However, if you run into problems with license activation, or any other possible problems (I haven’t run into any other problems so far) you might have to wait a bit for support team to reply.

[Read all 220 reviews](https://wordpress.org/support/plugin/pie-register/reviews/)
## Contributors & Developers

“Registration Forms – User Registration Forms, Invitation-Based Registrations, Front-end User Profile, Login Form & Content Restriction” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/48943dce2ab18a08efbe839278faef5b2a710701382a8abd0eeb4a1ec7842804?s=32&d=mm&r=g) [Pie Register](https://profiles.wordpress.org/pieregister/)
* ![](https://secure.gravatar.com/avatar/12d23844e79744b137ac8dca1dcd4d342243f83e85df6ff43b1af6fbc8d5c333?s=32&d=mm&r=g) [Genetech Solutions](https://profiles.wordpress.org/genetech/)
* ![](https://secure.gravatar.com/avatar/e43d88c30223d293601af1a31476aaa57e014e85a4d006d3ba280c02070ff206?s=32&d=mm&r=g) [Genetech Products](https://profiles.wordpress.org/genetechproducts/)

“Registration Forms – User Registration Forms, Invitation-Based Registrations, Front-end User Profile, Login Form & Content Restriction” has been translated into 1 locale. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/pie-register/contributors) for their contributions.

[Translate “Registration Forms – User Registration Forms, Invitation-Based Registrations, Front-end User Profile, Login Form & Content Restriction” into your language.](https://translate.wordpress.org/projects/wp-plugins/pie-register)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/pie-register/), check out the [SVN repository](https://plugins.svn.wordpress.org/pie-register/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/pie-register/) by [RSS](https://plugins.trac.wordpress.org/log/pie-register/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

### 3.8.3.9

*Released Date 22nd Novemeber 2024*

* Fixed: Addressed issues related to escaping, text domain consistency, and placeholders in translatable strings.
* Updated: Compatible with WordPress 6.7.

### 3.8.3.8

*Released Date 6th Novemeber 2024*

* Fixed: Minor Issues.

### 3.8.3.7

*Released Date 12th September 2024*

* Fixed: Removed deprecated Functions.
* Fixed: Capability issues.

### 3.8.3.6

*Released Date 23th July 2024*

* Fixed: Security vulnerability issues.
* Added: Capability checks.

### 3.8.3.5

*Released Date 11th July 2024*

* Fixed: Security vulnerability issues.
* Fixed: Restriction conflict issue.
* Fixed: Decimal value payment.

### 3.8.3.4

*Released Date 28th May 2024*

* Fixed: Removed deprecated Dynamic Properties issues.
* Fixed: Removed deprecated Functions.

### 3.8.3.3

*Released Date 18th March 2024*

* Fixed: File type and extension validations to the file upload field.

### 3.8.3.2

*Released Date 8th March 2024*

* Fixed: File type and extension validations to the file upload field.

### 3.8.3.1

*Released Date 18th December 2023*

* Fixed: PHP warnings.
* Fixed: Profile search results grid in the profile search addon.

### 3.8.3

*Released Date 16th August 2023*

* Fixed: UI fixes.

### 3.8.2.8

*Released Date 26th July 2023*

* Updated: UI changes.
* Fixed: CSS issues.

### 3.8.2.7

*Released Date 21st June 2023*

* Fixed: Errors in the console have been resolved.
* Fixed: PHP errors have been fixed.

### 3.8.2.6

*Released Date 6th April 2023*

* Updated: If invitation codes are imported, previous codes should not be deleted. Instead, a new one should be added. (Premium)
* Fixed: WooCommerce assign gift product functionality. (Premium)
* Fixed: Sizes for Previous and next button images.
* Fixed: PHP errors.
* Fixed: UI Issues.

### 3.8.2.5

*Released Date 13th March 2023*

* Updated: If a user does not have any attachments, they will not be listed in attachments section. (Premium)
* Updated: Removed the reply restriction section for BbPress Replies.
* Fixed: Replacement keys for email notifications.
* Fixed: Redirect to last visited page after login not working with BbPress.
* Fixed: The maximum number of file uploads should not accept 0. (Premium)
* Fixed: PHP errors.

### 3.8.2.4

*Released Date 1st March 2023*

* Fixed: The user should not be able to use a blocked email address when updating their profile. (Premium)
* Fixed: Multiselect/Dropdown for country list.
* Fixed: The validation for the website field is not working.
* Fixed: Users cannot be imported via Import/Export section.
* Fixed: The redirect to the PayPal one-time payment URL does not work.
* Fixed: Warning errors areÂ generated if the last name field on the form is hidden.
* Added: Filter hook ‘piereg\_filter\_profile\_front\_table’ to show additional data on profile front page.
* Added: Filter hook ‘piereg\_check\_temp\_saved\_file\_option’. (Premium)
* Added: Action hook ‘piereg\_after\_temp\_saving\_file’. (Premium)

### 3.8.2.3

*Released Date 2nd February 2023*

* Added: Option to redirect user to the last page they visited.
* Added: Admin can now include a reason for rejecting user verification in the email template.
* Added: Action hook ‘piereg\_after\_update\_profile\_event’ that triggers after the user profile is updated.
* Fixed: License keys activation for Stripe Recurring Payments add-on.
* Fixed: License keys activation for PayPal Subscriptions add-on.
* Fixed: Security vulnerability issues.

### 3.8.2.2

*Released Date 25th January 2023*

* Fixed: The form is not submitted if the minimum password strength is not set to weak.
* Fixed: UI issues.

### 3.8.2.1

*Released Date 4th January 2023*

* Fixed: UI issues.
* Fixed: Characterset encoding in email templates.

### 3.8.2

*Released Date 20th December 2022*

* Updated: Fonts and styling have been removed from front-end forms.
* Updated: Major UI changes.
* Added: guide links on each feature.
* Fixed: Pie Register Membership field not working on the WooCoomerce My Account Page. (Premium)
* Fixed: Several PHP warnings.

### 3.8.1.4

*Released Date 7th December 2022*

* Updated: Only administrators can delete invitation codes. (Premium)
* Updated: font-awesome to 6.2.1 version.
* Updated: jQuery.ui to 1.13.2 version.
* Updated: CKeditor to 4.20.1 version.
* Updated: Dropzone to 5.9.3 version. (Premium)
* Fixed: Logout URL in widgets.
* Fixed: Incorrect labeling on the profile search results grid.
* Fixed: Pie Register section on the WooCommerce Checkout form.

### 3.8.1.3

*Released Date 22nd November 2022*

* Fixed: PHP error when saving settings for invite users. (Premium)
* Fixed: Security vulnerability issues.
* Added: Filter hook ‘piereg\_set\_redirect\_uri’ to modify the redirect URL after login.

### 3.8.1.2

*Released Date 2nd Novemeber 2022*

* Added: Use the woocommerce addon to provide users with a free gift product upon registration.
* Updated: Any field (not just email/username) can now be set as the primary searchable field in the profile search addon.
* Fixed: CSS issues in the profile search addon.
* Fixed: When the plugin is translated, the default country does not work.

### 3.8.1.1

Released Date 11th October 2022

* Added: Settings to replace default WooCommerce login and registration forms with pieregister’s login and registration forms. (Premium)
* Updated: The tabs for manage forms have been renamed to Standard, Advanced, and Legacy.
* Fixed: Conditional logics for time field. (Premium)

### 3.8.1

*Released Date 21st September 2022*

* Added: Display user data from pieregister fields on the woocommerce checkout page. (Premium)
* Fixed: Errors and warnings in Import/Export section. (Premium)
* Fixed: Conditional logic conflicting with required settings. (Premium)
* Fixed: Conditional logic not working on upload field. (Premium)
* Fixed: Several PHP warnings.

### 3.8.0.2

*Released Date 1st September 2022*

* Added: An option to remove invitation code capability from certain users. (Premium)
* Fixed: Search functionality on the invitation code grid.
* Fixed: Invitation codes are not visible in the raw grid.
* Fixed: Several bugs in the invitation codes feature.
* Fixed: Section break and HTML fields with conditional logic settings. (Premium)
* Fixed: HTML field not visible on the edit profile page.
* Fixed: BBPress add-on displaying incorrect user information in the additional information section.

### 3.8.0.1

*Released Date 20th July 2022*

* Added: Allow website users to send email invitations to other users. (Premium)
* Added: Restriction on the number of email invites a user can send. (Premium)
* Added: Allow specific users to invite other users. (Premium)
* Added: To send invitation codes via email, a replacement key for “Invite Sent By” is added to the custom email template. (Premium)
* Updated: If the logged-in user is not an administrator, the option to disable or delete the invitation code has been removed from the invitation codes grid. (Premium)
* Updated: ‘Sent Through Email’ column in user tracker grid. (Premium)
* Fixed: CSS for terms and conditions field.

### 3.8

*Released Date 30th June 2022*

* Added: Option to allow users to invite other users. (Premium)
* Fixed: Bulk export for invitation codes. (Premium)
* Fixed: More than ten codes cannot be autogenerated at once. (Premium)
* Fixed: Popup for ‘sent through email’. (Premium)
* Fixed: PHP errors due to Honeypot Field.
* Fixed: Role names should be displayed rather than role keys.
* Fixed: Conflict issue with Flatsome Theme.

### 3.7.5.1

*Released Date 13th June 2022*

* Updated: Icon for Divi Builder Module
* Fixed: Autologin after registration with passwordless registration. (Premium)
* Fixed: Calendar Icon on Date Picker Field (User Edit Profile).
* Fixed: User verification by admin through URL with passwordless registration. (Premium)
* Fixed: Success message on Passwordless Registration. (Premium)
* Fixed: Website Field value in User’s Menu > Edit User. (Premium)
* Fixed: Eye image for Password Fields.
* Fixed: Used Code filter for codes with unlimited usage.
* Fixed: CSS issues.
* Fixed: Page speed optimization. (Premium)
* Fixed: Several PHP warnings.

### 3.7.5

*Released Date 26th May 2022*

* Added: Template for Verification Rejected by Admin in User Notifications. (Premium)
* Added: Built-in form templates. (Premium)
* Updated: UI for Pie Register Forms.
* Updated: Themes in advanced UX settings. (Premium)
* Updated: Replacement Key text for Terms & Conditions Field.
* Fixed: Lockout User with Captcha on Login Form. (Premium)
* Fixed: Error in Restrict Widgets. (Premium)
* Fixed: Calendar Icon on Date Picker Field.
* Fixed: Conditional logic conflicting with required settings for Invitation Code Field. (Premium)
* Fixed: Conditional logic for Radio Button Field. (Premium)
* Fixed: Acceptance of expired invitation code on the current date. (Premium)
* Fixed: Passwordless registration with email verification.
* Fixed: List field on edit profile page.
* Fixed: Escaping issues.
* Fixed: Several PHP warnings/notices.

### 3.7.4.6

*Released Date 9th May 2022*

* Fixed: Timed Form Submission. (Premium)
* Fixed: Lockout User for Forgot Password form. (Premium)
* Fixed: Form Preview.
* Fixed: Show in Profile for About Yourself Field.
* Fixed: Missing image in List field.
* Fixed: Pie Register Elementor Widget.
* Fixed: CSS issues for fileupload field. (Premium)
* Fixed: Individual form settings for admin notifications for particular user role and new admin notification template. (Premium)
* Fixed: Escaping issues.
* Fixed: Several PHP warnings/notices.

### 3.7.4.5

*Released Date 25th April 2022*

* Updated: Admin Email Notifications for particular User Role. (Premium)
* Added: Terms & Conditions field data to User Profile.
* Fixed: Registration date not visible in Users’ menu, when Geolocation add-on is activated.
* Fixed: Escaping and Sanitization issues.
* Fixed: Nonce check for ajax accessible functions.

### 3.7.4.4

*Released Date 30th March 2022*

* Updated: Nonce check for ajax accessible functions.
* Fixed: Sanitization issues.

### 3.7.4.3

*Released Date 24th March 2022*

* Added: Option to remove file in the File Upload field for admin when editing User Profile.
* Added: Progress bar for File Upload. (Premium)
* Added: Filter hook ‘piereg\_invitation\_code\_char\_check’ to modify the Invitation Code Character check regex.
* Added: Filter hook ‘piereg\_invitation\_code\_char\_verification’ to modify the Invitation Code Character verification regex.
* Fixed: DropZone library issue when two forms with Upload File field are added on the same page. (Premium)
* Fixed: Stopped Profile update for required Upload File field, if empty.
* Fixed: Required error when Upload File field is Read-Only (Field Visibility Addon).
* Fixed: Limit number of file uploads. (Premium)
* Fixed: Registration form Captcha(reCaptcha, hCaptcha, and math captcha) issue when added to the page and widget.
* Fixed: JS validations for reCaptcha, hCaptcha (Premium), and Math Captcha for Registration, Forgot Password, and Login Form.

### 3.7.4.2

* Fixed: Invitation code usage issue for global verification settings.

### 3.7.4.1

* Updated: Compatible with WP 5.9.
* Updated: jQuery plugin Slick Slider to 1.8.1 version.
* Updated: jQuery plugin Wload
* Updated: jQuery.alphanum to 1.0.26 version.
* Fixed: Pie-Register WordPress menu CSS issue.
* Fixed: Several PHP and notice errors.
* Fixed: Update users on import.
* Fixed: Field visibility add-on settings on file upload. (Premium)
* Fixed: Role based redirect after login.
* Fixed: Restricted user verification if Invitation Code usage is completed.

### 3.7.4

* Added: Filter hook ‘piereg\_before\_visibility\_restrictions\_metabox’ before adding the Pie Register – Page Restriction settings to each page/post.
* Added: Display member directories in Profile Search Addon (Premium).
* Added: Option to hide Form Name on the frontend.
* Added: Option to hide the Last Name field.
* Added: Option to hide Confirm Password field.
* Updated: Sortable Registration Date column in WP Users’ menu (Premium)
* Updated: Image(s) for Payment Gateway(s) on Registration form.
* Updated: Added column for verified/unverified users in CSV file when users are exported.
* Updated: Option for disabling verification in manage forms.
* Updated: On importing users through CSV, unverified users are added to the unverified users’ list.
* Fixed: Removed attachments of unverified users from PR Menu > Attachments (Premium).
* Fixed: Maximum file upload option accepts zero as input (Premium).
* Fixed: Invitation code usage count for unverified users.
* Fixed: In the date field, the number of days is not in accordance with months.
* Fixed: Several issues related to the File Upload field.
* Fixed: List Field in User’s Menu > Edit User.
* Fixed: No Role given to users when Role is not assigned in invitation codes (Premium).
* Fixed: Several UI issues.
* Fixed: Profile Update message when the profile is not updated (Premium).
* Fixed: Email Notification on Profile Update.
* Fixed: Several PHP warnings.

### 3.7.3.2

* Added: Action hook ‘piereg\_before\_deleting\_user\_unverified\_list’ before deleting users from the Unverified Users’ list.
* Fixed: Database errors

### 3.7.3.1

* Added: Invitation Code Description.
* Added: Option to control Invitation Code Length in Auto Generate Codes’ section. (Premium)
* Added: Export user data per Invitation code. (Premium)
* Added: Bulk export user data for all invitation codes. (Premium)
* Added: Assign a user role to an Invitation Code. (Premium)
* Updated: Options added to Invitation Codes Search filter – Used, Unused, Expired, Created Date and User Role. (Premium)
* Fixed: Enable/Disable Registration Forms
* Fixed: Pop Up for Sent Through Email Column in Invitation Codes’ grid. (Premium)
* Fixed: Registration Form Names in Email Notifications’ Replacement Key dropdown. (Premium)
* Fixed: Page speed optimization. (Premium)
* Fixed: Pie Register Form Filter in Users Menu. (Premium)

### 3.7.3.0

* Added: Option to add multiple files via File Upload field. (Premium)
* Added: Notification email to admin on user profile modification.
* Updated: Conditional logics added for List, Math Captcha, HTML Script and Section break field. (Premium)
* Fixed: Several bug fixes and PHP warnings.
* Fixed: Page break issue in unverified users list.

### 3.7.2.6

* Fixed: Warnings on user profile page.
* Fixed: Page speed optimization in admin area.

### 3.7.2.5

* Added: Option to remove password field from registration form.
* Fixed: Lockout user after invalid login attempts feature not working.
* Fixed: Redirection issue on post/page restriction.
* Fixed: Page speed optimization.

### 3.7.2.4

* Updated: nonce check added for logout urls.

### 3.7.2.3

* Fixed: Vulnerability in Redirect URLs.

### 3.7.2.2

* Fixed: Bug Fixes.

### 3.7.2.1

* Added: Multiple selection option for individual post/page content visibility restrictions.
* Added: Multiple selection option for post/page content visibility restrictions in ‘Global Visibility Restrictions’ settings. (Premium)
* Added: Page break on Profile page.
* Added: Registration Date column in Users grid.
* Added: Notice for activation of License Key. (Premium)
* Added: Note for change of domain on License Page. (Premium)
* Fixed: Removed ‘?’ in the URL on successful page redirection.
* Fixed: More than one Registration Form can be added on a single page.
* Fixed: Conditional logic in widgets. (Premium)
* Fixed: Page speed optimization.

### 3.7.2

* Updated: Submit button behaviour on registration form submission.
* Fixed: Changes in APP api request.
* Fixed: Several UI issues.
* Fixed: WP Twenty-Twenty-One theme UI issue.

### 3.7.1.7

* Fixed: Page speed optimization.
* Fixed: login authentication APP api request.

### 3.7.1.6

* Fixed: SQL injection issue.

### 3.7.1.5

* Fixed: Sanitization and other Security issues.

### 3.7.1.4

* Added: Filter hook ‘piereg\_check\_email\_allowed\_to\_send’ before sending notifications to Admin.
* Fixed: Notice UI issue.

### 3.7.1.3

* Updated: Show future 10 years in the Date Dropdown.
* Fixed: Buttons visibility issues when using Page Break.
* Fixed: Several UI issues.

### 3.7.1.2

* Updated: Increased date picker’s selection year by 10 years
* Fixed: Math Captcha issue for iPhone users.
* Fixed: Warning error in widgets menu.
* Fixed: Several UI issues.

### 3.7.1.1

* Fixed: Label issue in reCaptcha v3
* Fixed: Enable Invitation Code settings
* Fixed: Global Restriction issue with incorrect url (Premium)

### 3.7.1.0

* Updated: Custom User Role field added for conditional verification method in form settings. (Premium)
* Updated: Plugin files will load when required (Page Speed)
* Added: reCaptcha v3
* Added: Conditional Logic on Multiple Terms and Condition fields. (Premium)
* Added: Pie Register Module added in Divi Theme Builder.
* Fixed: Math Captcha cookie issue.
* Fixed: Terms & Conditions validation message.
* Fixed: Overwriting of Global Post Restrictions with Global Category Restrictions. (Premium)

### 3.7.0.6

* Fixed: Error on invalid user login.
* Fixed: Invalid verificaition key error on resetting the password.

### 3.7.0.5

* Updated: ckEditor to 4.16.1 version.
* Updated: jQuery plugin custom scrollbar to 3.1.5 version.
* Updated: jQuery plugin Mousewheel to 3.1.13 version.
* Updated: Sanitization and other Security issues fixes.

### 3.7.0.4

* Added: Pie Register Block added in WPBakery Page Builder.
* Added: Global settings for content resticition by restrict post, page and category. (Premium)
* Added: Filters hook after validation on registration and edit form.

### 3.7.0.3

* Updated: First Name and Last Name to be saved in Camel Case.
* Updated: Replaced file\_get\_contents() with wp\_remote\_get().
* Added: Single and bulk deletion of Attachments. (Premium)
* Fixed: Conflict with Oxygen Builder.
* Fixed: Section Break label on Edit Profile page.
* Fixed: New User Verification Settings.

### 3.7.0.2

* Added: Eye icon in Password Field for Login, Registration, and Forgot Password Forms.
* Added: Hide and make Email Field readonly on the Profile page with Field Visibility addon.
* Fixed: Several UI issues.

### 3.7.0.1

* Fixed: Security vulnerability issues.

### 3.7.0.0

* Updated: Conditional Logic with AND and OR conditions. (Premium)
* Added: hCaptcha support, see Pie Register > Security – Basic (Premium)
* Added: Filter hook ‘piereg\_after\_profile\_printed’ to PR Profile section.
* Added: Italian Language files.
* Fixed: Captcha Label alignment in Login and Forgot Password Form.
* Fixed: Website field validation.

### 3.6.17

* Added: Added default option to Form’s Conditional Logic settings. (Premium)
* Fixed: Warning error in User Notification section.
* Fixed: Text changes in warning messages.
* Updated: Language file(s) updated.

### 3.6.16

* Added: Pie Register Block added in Gutenberg Block Editor.
* Fixed: Warning error in comments on posts.

### 3.6.15

* Added: Admin Email Notifications for individual form (Premium)
* Fixed: Tooltip issue with WP post editor.

### 3.6.14

* Added: Edit user option in Unverified Users list.
* Added: Case-sensitive email address on registration and login forms.
* Fixed: Allowed Users can login with case-sensitive Email Addresses. (Premium)
* Fixed: Email address update on edit profile.
* Fixed: User’s profile picture issue.
* Fixed: Previous button image on Page Breaks.
* Fixed: Several PHP warnings.

### 3.6.13

* Added: French (Canadian), German (Austria), Spanish (Latin America) and German (Switzerland) language option in Google recaptcha.
* Added: Pie Register Block added in Elementor Page Builder.
* Fixed: Warning errors in Elementor widgets.

### 3.6.12

* Fixed: Compatibility issues with PHP 8.0 version
* Fixed: Several UI issues.

### 3.6.11

* Added: Portuguese (Brazil, Portugal) language option in Google recaptcha.
* Fixed: Invitation Codes’ dropdown in Invite Through Email section.

### 3.6.10

* Fixed: Major issue on plugin activation.

### 3.6.9

* Updated: Following tags : Site Admin Email, Site Name, Site URL, Page Title, Page URL, Page ID, Form Name and User IP Address added in the Hidden Field settings.
* Updated: Pie Register Menu added to the Admin Bar.
* Updated: Allowed Language Special Charecters in the From Name Field in Admin Notifications section.
* Added: Limit Form Submissions from a device for a day under Advanced Security Settings. (Premium)
* Fixed: Select Fields option fixed under User Enteries, Import/Export section.

### 3.6.8

* Updated: Character length restriction in the name field settings
* Updated: Messages and language files.

### 3.6.7

* Updated: Section break on Profile Page
* Updated: Restrict unverified and blocked users (Premium) to login through default WP Login form
* Fixed: Several PHP warnings
* Fixed: WordPress 5.6 Compatibility issues.

### 3.6.6

* Updated: Changed error and success message on Forgot Password Form.
* Fixed: Changed PHP function in menu visibility file.
* Fixed: Invalid Invitation Code error on Registration Form.
* Fixed: Several PHP warnings and bug fixes.

### 3.6.5

* Added: Arabic, Turkish, Chinese (Hong Kong, Simplified, Traditional) language option in Google recaptcha.
* Added: Option to select specfic invitation codes in registration form builder.
* Fixed: Removed used codes from Invitation codes dropdown in Invite through email section. (Premium)

### 3.6.4

* Added: Role key added in custom user roles grid.
* Added: conditionl logic added in checkbox, multiselect, radio, address, date, time, file upload, profile picture and custom user role fields. (Premium).
* Updated: Bulk actions added in custom user roles grid.
* Fixed: Major bugs fixes in conditionl logic fields. (Premium).

### 3.6.3

* Added: Shortcode for user profile picture.
* Fixed: Menu visibility option saving issue with custom user roles.
* Fixed: inivite code email template issue (Premium).

### 3.6.2

* Fixed: Settings revert on plugin update.
* Fixed: Number appears on registration form.

### 3.6.1

* Added: Mailchimp Addon hooks.
* Added: Dropdown Search filter (Premium).
* Fixed: Several PHP warnings and bug fixes.

### 3.6

* Fixed: Invitation code widget on Admin dashboard.
* Updated: Major code changes.

### 3.5.11

* Fixed: validation messages on profile edit page.
* Fixed: several PHP warnings.

### 3.5.10

* Fixed: removed deprecated functions.
* Fixed: bug fixes.

### 3.5.9

* Fixed: Edit button issue on form builder.
* Added: Placeholder in Phone field.

### 3.5.8

* Fixed: WordPress 5.5 Compatibility issues.
* Fixed: Android APP API

### 3.5.7

* Fixed: Line breaks issue on send invite email.
* Fixed: Invitation code validation message.
* Fixed: UX issues on forms.
* Fixed: Access to edit user profile when user role have edit\_users capaility.
* Fixed: Attachments not showing for user roles other than subscriber. (Premium)

### 3.5.6

* Fixed: Filter added to redirect after login on current page.
* Fixed: Extra line breaks in notification emails.
* Fixed: Edit profile link issue.
* Fixed: Error messages on login form.

### 3.5.5

* Fixed: Replacement keys in notification emails for PR WooCommerce addon fields.
* Updated: Same as billing checkbox for PR WooCommerce addon fields.
* Updated: Save billing first/last name as user first/last name for PR WooCommerce addon.
* Added: Feedback form for Admin Helper App.

### 3.5.4

* Fixed: PHP warnings in User Control settings. (Premium)
* Added: Polish language option in Google recaptcha.
* Added: User Roles section to create custom user roles. (Premium)
* Added: Search users by invitation code in Users grid.
* Updated: Send invitation codes to email address imported by CSV.

### 3.5.3

* Fixed: Messages ipdated and Type errors

### 3.5.2

* Fixed: countires list updated.
* Fixed: PR registration, forgot password and login forms on same page issue.
* Added: Admin verification method – Verify link in email.
* Added: Option to duplicate PR registration form.
* Updated: Conditional logic on User role dropdown. (PRO)
* Updated: Messages and language files.

### 3.5.1

* Fixed: sql error in inivitation code grid class.
* Added: filter hook for terms and confition field label.

### 3.5

* Fixed: Issue in name field.
* Added: Invitation codes count for invite sent through email.
* Updated: Messages and language files.
* Updated: Major code changes.

### 3.4.7

* Fixed: Allowed Spanish, German, Chinese and Russian letters in name field.
* Fixed: Text changes in several sections.
* Added: User roles dropdown based on user selection in Registration form builder.
* Added: Allow user by username, domain specific under user control section. (PRO)
* Added: Blogname replacement key added in Send Invite email template. (PRO)
* Updated: Block User menu is changed to User Control. (PRO)

### 3.4.6

* Fixed: “A variable mismatch has been detected” issue resolved.
* Fixed: PR metabox UI breaks on edit post page.
* Fixed: Several PHP warnings.
* Added: Search filters added in unverified users list.
* Added: Replacement keys available in email notifications subject field.

### 3.4.5

* Fixed: Pie Register forms preview issue.
* Fixed: Allow German letters in name field.
* Fixed: International phone format validation on phone field.
* Fixed: Removed warnings from invitation codes settings.
* Fixed: Duplicate invitation codes issue.
* Fixed: Remove conflict error on BBPress profile page.
* Fixed: Several typo errors.
* Updated: Invite through email – encrypted invitation codes in invitation link. (PRO)
* Updated: Invite through email – email address attached in invitation link. (PRO)
* Updated: Language file(s) updated.

### 3.4.4

* Added: Generate password option in Registration form, Profile page
* Fixed: After login redirect issue for “Too many redirects”
* Fixed: Invalid Return-Path in wp\_mail() header.
* Fixed: Visibility restriction settings remove on Quick Edit.
* Updated: Login form Validation message.
* Removed: Visibility restriction settings on WP media gallery.

### 3.4.3

* Fixed: Notifications line breaks issue.
* Fixed: Page resriction issue with custom roles.
* Fixed: Other warnings and typo errors.

### 3.4.2

* Fixed: UI issues in “List” type field.
* Fixed: Error when label is empty in “Terms and Conditions” field type.
* Fixed: Errors and warnings in Import/Export section.
* Fixed: Other warnings and errors issues.

### 3.4.1

* Fixed: Replacement keys issue in Notifications.

### 3.4.0

* Fixed: Several warnings and errors issues.
* Fixed: Compatibility issues.

### 3.3.4

* Fixed: Errors on GDPR export data page.
* Fixed: Invalid invitation code validation message.
* Fixed: Errors in “list” field type on WP user page.
* Fixed: Empty default PR forms pages in PR Settings.
* Fixed: Reset Password form UI issue.

### 3.3.3

* Fixed: Empty Invitation codes grid.
* Fixed: Not inserting invitation codes.

### 3.3.2

* Fixed: Admin notification email message reverting on update.
* Fixed: Duplicate Pie Register pages on update.
* Fixed: After Login page setting issue when selecting URL.

### 3.3.1

* Added: Invitation codes: Invite through email. (PRO)
* Fixed: Login/Registration/Forgot Password forms pages preview.
* Fixed: Several minor issues.
* Updated: Enable/Disable option for User nofification email.
* Updated: Ui for user notifications settings page.

### 3.3.0

* Added: Expiry date option in Invitation Codes. (PRO)
* Added: Auto generate Invitation Codes option. (PRO)
* Added: Import CSV option under import/export for invitation codes. (PRO)
* Fixed: Removed several warnings in Profile edit form.
* Fixed: Removed wrongly activated error message in WP admin area.
* Fixed: Username field validation.
* Updated: UI updated Invitation Codes Settings.
* Updated: Language files updated.

### 3.2.5

* Fixed: Errors on plugin installation.
* Fixed: Strength indicator meter.
* Fixed: Paypal IPN log issue.
* Fixed: Conditionalo logic fields on Profile page. (PRO)
* Updated: Language file(s) updated.

### 3.2.4

* Updated: Replaced deprecated eregi() function with preg\_match().

### 3.2.3

* Added: Russian language option in Google recaptcha.
* Added: Filter added to set character length for password field.
* Fixed: Required validation issue on address field.
* Fixed: Users data issue on plugin upgrade form version 2.x.x series.
* Fixed: Allowed Russian letters in Name field.
* Fixed: Varous issues fixed in Attachments listing. (PRO)

### 3.2.2

* Added: Users can be connected to selected Registration form. (PRO)
* Added: Label added with Section break field.
* Updated: Small bugs fixed.
* Updated: Language file(s) updated.

### 3.2.1

* Fixed: Upload field on edit form.
* Fixed: Attachement pagination (PRO)
* Removed: PHP warnings on edit form.

### 3.2.0

* Updated unverified users list.
* Added terms and conditions field.
* Fixed issues in file upload field.

### 3.1.4

* Fixed issues on Attachment page.

### 3.1.3

* Content restriction added on CPT UI (Custom Post Types).
* File size restriction option added in file upload field. (PRO)
* Administrator can view uploaded files (via file upload field) in admin dashboard and download files in bulk. (PRO)
* Other small bugs.

### 3.1.2

* Removed SQL injection issue.

### 3.1.1

* Fixed restriction issue with custom user roles.
* Fixed PR forms page with elementor page builder.\*
* Updated Profile page UI.
* Removed several PHP warning.

### 3.1

* Added languages for Google Captcha.
* updated language files (.po) with new text domain.
* Added validation rule for alphabetic letters only.
* Added remove profile picture option on edit.
* Fixed several bugs.

### 3.0.21

* Fixed warnings on plugin activation.
* Fixed something went wrong issue on Login form.
* Fixed auto delete unverified users after grace period.
* Added css class on field container.
* Added replacement keys on notification subject field.
* Added view users by PR forms. (PRO)
* Added multiple admin email option on admin notification.

### 3.0.20

* Updated front-end forms UI.
* Fixed several UI issues.
* Updated English Language Pack (PO Files).
* Fixed email verificaition issue.

### 3.0.19

* Fixed wp\_mail conflict issue.
* Fixed dropdown field validation issue.
* Added placeholders for name, confirm email & confirm password fields.
* Fixed undefined index error on login form.

### 3.0.18

* Fixed vulnerability issue.
* readme.txt updated.

### 3.0.17

* Fixed several bugs.

### 3.0.16

* Fixed login form security issue.
* Fixed several typos.

### 3.0.15

* Search field in invitation codes grid added.
* Meta login link redirect issue fixed.
* Error on uninstalling plugin issue fixed.

### 3.0.14

* Removed warnings messages.
* Fixed widget messages issues.

### 3.0.13

* Removed warnings on Pie Register pages.

### 3.0.12

* Fixed dump data on edit profile page.

### 3.0.11

* Fixed iframe issue in HTML field.
* Fixed PR reCaptcha load if enabled in settings or forms.
* Fixed Registration Form not loading in Form settings without title issue.
* Fixed page/post redirection issue.
* Other issue and PHP warnings issues.

### 3.0.10

* Fixed sql vulnerability issue in invitation codes grid.

### 3.0.9

* Fixed reCaptcha conflict issue.
* Fixed WP menu issue.
* Notify unverified user email template updated.
* Other small issues and PHP standard fixes.

### 3.0.8

* Fixed tooltip issue on WP post editor.
* Fixed UTF-8 charachter issue in Import Users.
* Updated English Language Pack (PO Files).
* Fixed Profile picture as Avatar.
* Other small fixes.

### 3.0.7

* Fixed Pro features issues.

### 3.0.6

* Fixed HTML Script field issue.
* Fixed jQuery conflict issue.

### 3.0.5

* Fixed several typos.
* Fixed HTML Script field issue.
* Fixed page visibility restriction issue for administrator role.

### 3.0.4

* Fixed email address edit verification issue.
* Fixed rest password issue.

### 3.0.2

* Fixed “Visual editor” issue.
* User Account Delete Issue.
* Email Address Capitalization Error Issue.
* Small changes and fixes.

### 3.0.1

* Fixed “Visual editor” issue.

### 3.0

* …

## Meta

* Version **3.8.3.9**
* Last updated **2 months ago**
* Active installations **2,000+**
* WordPress version **4.0 or higher**
* Tested up to **6.7.1**
* PHP version **5.6 or higher**
* Languages
  See all 2

  Close

  [English (US)](https://wordpress.org/plugins/pie-register/) and [German](https://de.wordpress.org/plugins/pie-register/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/pie-register)
* Tags [login form](https://wordpress.org/plugins/tags/login-form/)[membership form](https://wordpress.org/plugins/tags/membership-form/)[registration form](https://wordpress.org/plugins/tags/registration-form/)[user profile](https://wordpress.org/plugins/tags/user-profile/)[User Registration](https://wordpress.org/plugins/tags/user-registration/)
* [Advanced View](https://wordpress.org/plugins/pie-register/advanced/)

## Ratings

4.3 out of 5 stars.

* [164 5-star reviews
  5 stars

  164](https://wordpress.org/support/plugin/pie-register/reviews/?filter=5)
* [14 4-star reviews
  4 stars

  14](https://wordpress.org/support/plugin/pie-register/reviews/?filter=4)
* [7 3-star reviews
  3 stars

  7](https://wordpress.org/support/plugin/pie-register/reviews/?filter=3)
* [7 2-star reviews
  2 stars

  7](https://wordpress.org/support/plugin/pie-register/reviews/?filter=2)
* [28 1-star reviews
  1 star

  28](https://wordpress.org/support/plugin/pie-register/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/pie-register/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/pie-register/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/48943dce2ab18a08efbe839278faef5b2a710701382a8abd0eeb4a1ec7842804?s=32&d=mm&r=g) [Pie Register](https://profiles.wordpress.org/pieregister/)
* ![](https://secure.gravatar.com/avatar/12d23844e79744b137ac8dca1dcd4d342243f83e85df6ff43b1af6fbc8d5c333?s=32&d=mm&r=g) [Genetech Solutions](https://profiles.wordpress.org/genetech/)
* ![](https://secure.gravatar.com/avatar/e43d88c30223d293601af1a31476aaa57e014e85a4d006d3ba280c02070ff206?s=32&d=mm&r=g) [Genetech Products](https://profiles.wordpress.org/genetechproducts/)
## Support

Issues resolved in last two months:

2 out of 2

[View support forum](https://wordpress.org/support/plugin/pie-register/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


