```
{
  "vulnerability": {
    "root_cause": "Ansible, when encountering errors during a run, saves the failed results to a file in `/var/tmp/ansible/$script_name.yml`, where `$script_name` is the name of the playbook. The vulnerability lies in the fact that `/var/tmp` is world-writable, and there are no checks on file or directory permissions. This allows an attacker to potentially manipulate or create the directory and symlinks within, leading to arbitrary file writes or deletions.",
    "weaknesses": [
      "Use of a world-writable directory (`/var/tmp`) without proper permission checks.",
      "Predictable filename generation based on script name.",
        "Lack of checks for existing directory permissions and ownership."
    ],
    "impact": "An attacker could potentially overwrite or delete arbitrary files by manipulating the `/var/tmp/ansible/$script_name.yml` directory or creating symbolic links within it. This could result in data loss or other security issues.",
    "attack_vectors": [
      "Creating a directory /var/tmp/ansible with specific permissions and a symbolic link to a file owned by another user to overwrite that file",
      "Manipulating the file before Ansible writes the results due to the race condition."
    ],
    "required_capabilities": "An attacker needs to be able to create files/directories in /var/tmp, which is world writable. They also would need to trigger an error in an Ansible run.",
     "additional_details": "The issue is located in the ansible playbook initialization code. A patch was created to mitigate the issue by changing the location and performing permission checks. Upstream was notified of this issue and a fix was implemented in version 1.2.3"
  }
}
```