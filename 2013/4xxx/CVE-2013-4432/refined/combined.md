=== Content from mahara.org_19106bb8_20250124_231528.html ===

[Skip to main content](#header-main)

* [Login](https://mahara.org/?login)

Show search

SearchGo

[![Mahara ePortfolio System](https://mahara.org/theme/mahara-org/images/site-logo.svg?v=4171)](https://mahara.org/)
[![Mahara ePortfolio System](https://mahara.org/theme/raw/images/site-logo-small.svg?v=4171)](https://mahara.org/)
Show main menu

* [Home](https://mahara.org/)
* [Subscription](https://mahara.org/subscription)
* [Demo](https://mahara.org/demo)
* About

  + [About Mahara](https://mahara.org/about)
  + [About open source](https://mahara.org/about/opensource)
  + [Features](https://mahara.org/features)
  + [What is an ePortfolio?](https://mahara.org/about/eportfolios)
  + [Who is using Mahara?](https://mahara.org/showcase)
  + [News and announcements](https://mahara.org/news)
  + [Newsletter](https://mahara.org/newsletter)
  + [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* Community

  + [Community](https://mahara.org/community)
  + [Forums](https://mahara.org/forums)
  + [Mahara manual](https://mahara.org/documentation)
  + [Wiki](https://mahara.org/wiki)
  + [Bug / feature tracker](https://mahara.org/tracker)
  + [Release notes](https://mahara.org/releasenotes)
  + [Security](https://mahara.org/security)
  + [Contributors](https://mahara.org/community/contributors)
  + [Branding](https://mahara.org/branding)
  + [Events](https://mahara.org/events)
* Partners

  + [Partners](https://mahara.org/partners)
  + [Business Partners](https://mahara.org/business-partners)
  + [Supporters](https://mahara.org/supporters)

# Portfolios for your learning community

SearchGo

[Try out Mahara](http://demo.mahara.org/)

![Continuous single line drawing of a puhutukawa tree with a tui on the branches](https://mahara.org/theme/mahara-org/images/dashboard-tree-desktop-full.svg)

![Continuous single line drawing of a person working on a laptop](https://mahara.org/theme/mahara-org/images/dashboard-person-desktop.svg)

## Create portfolios

Using Mahara, students and staff create their personal learning stories by uploading evidence of activities they have participated in, and embedding publicly accessible content they have previously put online. They can write reflections on their experiences that frame this evidence, map it to competencies or registration requirements, and provide necessary context.

Mahara can be used for many different portfolio purposes, such as study, professional development, work-integrated learning, assessment, showcase and presentation, and employability.

[Learn about the portfolio options](https://mahara.org/view/view.php?id=137010)

## Share work

Mahara allows portfolios to be shared flexibly with one person, a specific group of people, or the entire world. Access can be further restricted to a particular time frame or just within an assessment task.

[Find out about sharing portfolios](https://mahara.org/view/view.php?id=137011)

![Continuous single line drawing of a paper plane in flight](https://mahara.org/theme/mahara-org/images/dashboard-paperplane-desktop.svg)

![Continuous single line drawing of a group of people sitting around a laptop in discussion](https://mahara.org/theme/mahara-org/images/dashboard-group-desktop.svg)

## Engage with others

Mahara makes it easy to comment and give feedback. Portfolios can also be submitted to learning management systems via LTI (Learning Tools Interoperability) for marking.

Groups in Mahara allow people to create portfolios collaboratively and engage in forum discussions.

[Learn about collaborating in Mahara](https://mahara.org/view/view.php?id=137012)

## Listen to portfolio stories

In our podcast 'Create. Share. Engage.' portfolio practitioners, researchers, learning designers, and portfolio authors share their journey. Learn how they navigate the many different facets of portfolios in general, and Mahara specifically.

[Listen on the podcast website or in your favourite app](https://podcast.mahara.org/)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-desktop.svg)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-logo.svg)

Mahara Community

* [About
  (tab)](https://mahara.org/group/mahara-community)
* [Members
  (tab)](https://mahara.org/group/members.php?id=1)
* [Forums
  (tab selected)](https://mahara.org/interaction/forum/index.php?group=1)
* [Portfolios
  (tab)](https://mahara.org/view/groupviews.php?group=1)

# Forums | Mahara Community

## [Security Announcements](https://mahara.org/interaction/forum/view.php?id=43) / Access Folder Artefact Vulnerabilities in <1.5.13, <1.6.8, <1.7.4

---

This topic is closed. Only moderators and the group administrators can post new replies.

![Son Nguyen's profile picture](https://mahara.org/theme/raw/images/no_userphoto40.png)
[Son Nguyen](https://mahara.org/user/sonn)

Posts: 28

31 October 2013, 16:32

Unauthorized access to a folder by group members

Category:     Access Control
Severity:     High
Versions affected:  <1.5.13, <1.6.8, <1.7.4
Reported by:     [Hugh Davenport](https://launchpad.net/~hugh-davenport)
Bug reports: [Bug #1034180](https://bugs.launchpad.net/mahara/%2Bbug/1034180)
CVE reference: [CVE-2013-4432](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2013-4432)

As these vulnerabilities affect the privacy and data integrity of all Mahara users, we strongly recommend that all Mahara administrators upgrade to the latest version: 1.5.13, 1.6.8, or 1.7.4.

Download links for fixed versions:

* <https://launchpad.net/mahara/1.5/1.5.13>
* <https://launchpad.net/mahara/1.6/1.6.8>
* <https://launchpad.net/mahara/1.7/1.7.4>

### Edits to this post:

* [![Kristina Hoeppner's profile picture](https://mahara.org/thumb.php?type=profileiconbyid&maxwidth=20&maxheight=20&id=438257)
  Kristina Hoeppner](https://mahara.org/user/anitsirk) -
  10 November 2014, 8:13

1 result

## Subscribe to our monthly newsletter

Do you want to stay updated on the latest news from Mahara and wider portfolio community? Subscribe to the monthly Mahara newsletter from Catalyst, the maintainers of Mahara.

[Sign up for the newsletter](https://zcu.nz/wpPM)

Create. Share. Engage.
[Try out Mahara](http://demo.mahara.org/)
[Support Mahara](https://mahara.org/subscription)

#### [Support](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Mahara manual](https://mahara.org/documentation)
* [Wiki](https://mahara.org/wiki)
* [Bug / feature tracker](https://mahara.org/tracker)
* [Extended security support](https://mahara.org/extended-security-support)

#### [Get involved](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Code repository](https://mahara.org/repository)
* [Contribute](https://mahara.org/contribute)
* [Release notes](https://mahara.org/releasenotes)
* [Events](https://mahara.org/events)

#### [About](https://mahara.org/about)

* [News and announcements](https://mahara.org/news)
* [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* [Contributors](https://mahara.org/community/contributors)
* [Security](https://mahara.org/security)
* [Accessibility](https://mahara.org/accessibility)

#### [Home](https://mahara.org/)

#### [Partners](https://mahara.org/partners)

#### [Subscription](https://mahara.org/subscription)

#### [Demo site](https://mahara.org/demo)

[![Powered by Mahara](https://mahara.org/theme/mahara-org/images/powered_by_mahara.svg?v=4171)](https://mahara.org/)

* [Legal](https://mahara.org/legal.php)
* [Contact us](https://mahara.org/contact.php)
* [Help](https://manual.mahara.org/en/24.04/)

[![Developed and maintained by Catalyst](https://mahara.org/theme/mahara-org/images/maintained-by-catalyst.png)](https://catalyst.net.nz/)

[Follow us on LinkedIn](https://www.linkedin.com/company/1845966)

[Find us on Mastodon](https://mastodon.nzoss.nz/%40mahara)



=== Content from launchpad.net_e84eb9c8_20250126_042300.html ===

[Log in / Register](https://launchpad.net/~hugh-davenport/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~hugh-davenport)

## [Hugh Davenport](https://launchpad.net/~hugh-davenport)

* Overview
* [Code](https://code.launchpad.net/~hugh-davenport)
* [Bugs](https://bugs.launchpad.net/~hugh-davenport)
* [Blueprints](https://blueprints.launchpad.net/~hugh-davenport)
* [Translations](https://translations.launchpad.net/~hugh-davenport)
* [Answers](https://answers.launchpad.net/~hugh-davenport)

* [Related packages](https://launchpad.net/~hugh-davenport/%2Brelated-packages)
* [Related projects](https://launchpad.net/~hugh-davenport/%2Brelated-projects)

## User information

Launchpad Id:
hugh-davenport

Email:
[Log in](%2Blogin) for email information.

Member since:
2011-04-28

Signed Ubuntu Code of Conduct:
Yes

Languages:

English

OpenPGP keys:

7BDB20C1883A0DDC9D787825D5022257A9C47E3D

SSH keys:

[hugh@hugh-desktop](%2Bsshkeys)

Time zone:

UTC
(UTC+0000)

Karma:
[0](https://launchpad.net/~hugh-davenport/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**aquaman**
 on
**irc.freenode.net**

## Latest memberships

Hugh Davenport is not an
active member of any Launchpad teams.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.openwall.com_23596e69_20250124_231525.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2013/10/14/3) [[next>]](2) [[<thread-prev]](../../../2013/10/11/2) [[thread-next>]](../../../2013/10/16/7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAA7hUgH2+YdcjJ7z5Gc+Pb2F6KpohSjX120H98TXWBG4cHcbGQ@mail.gmail.com>
Date: Tue, 15 Oct 2013 14:18:48 +0200
From: Raphael Geissert <geissert@...ian.org>
To: oss-security@...ts.openwall.com
Subject: Re: CVE request: mahara 1.7.3

So, the commits...

On 8 October 2013 12:16, Raphael Geissert <geissert@...ian.org> wrote:
> Hi,
>
> Multiple vulnerabilities have been discovered and fixed in the 1.7.3
> release of Mahara:
>
> From [1]
>> * Bug #1211758 Arbitrary image download

<https://bazaar.launchpad.net/~mahara-release/mahara/1.7_STABLE/revision/5833>

>> * Bug #1175446 user supplied $_SERVER['HTTP_HOST'] can be used for injections

<https://bazaar.launchpad.net/~mahara-release/mahara/1.7_STABLE/revision/5830>

>> * Bug #1233500 Not checking ownership of blocks before editing them

<https://bazaar.launchpad.net/~mahara-release/mahara/1.7_STABLE/revision/5832>

And while at I found the following:

[https://bugs.launchpad.net/mahara/+bug/1034180](https://bugs.launchpad.net/mahara/%2Bbug/1034180)
<https://bazaar.launchpad.net/~mahara-release/mahara/1.7_STABLE/revision/5831>

Which doesn't appear to be mentioned in the changelog, but the bug
report clearly states it was meant to be handled as a security issue.

Cheers,
--
Raphael Geissert - Debian Developer
www.debian.org - get.debian.net

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugs.launchpad.net_d145990b_20250126_042302.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# A group member with no access rights to folder can still view it (if smart :D)

Bug #1034180 reported by
[Hugh Davenport](https://launchpad.net/~hugh-davenport)
on 2012-08-07

[268](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | High | [Son Nguyen](https://launchpad.net/~ngson2000) | [Mahara 1.8.0](https://launchpad.net/mahara/%2Bmilestone/1.8.0) |
|  | [1.5](https://bugs.launchpad.net/mahara/1.5) | Fix Released | High | Unassigned | [Mahara 1.5.13](https://launchpad.net/mahara/%2Bmilestone/1.5.13) |
|  | [1.6](https://bugs.launchpad.net/mahara/1.6) | Fix Released | High | Unassigned | [Mahara 1.6.8](https://launchpad.net/mahara/%2Bmilestone/1.6.8) |
|  | [1.7](https://bugs.launchpad.net/mahara/1.7) | Fix Released | High | Unassigned | [Mahara 1.7.4](https://launchpad.net/mahara/%2Bmilestone/1.7.4) |
|  | [mahara (Debian)](https://bugs.launchpad.net/debian/%2Bsource/mahara "Latest release: 1.0.4-4+lenny11, uploaded to main on 2012-03-10 15:14:46.784227+00:00 by Mahara Debian Packaging Team (pkg-debian), maintained by Mahara Debian Packaging Team (pkg-debian)") | Fix Released | Unknown | [debbugs #727539](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=727539) |  |

### Bug Description

If i create a folder in group files area, open a tab as a normal member, and then as group admin remove all rights to that folder for members, then as the member, click on the folder. The contents of the folder is then displayed (with the following warnings)

[WAR] 0a (artefact/lib.php:864) Undefined index: member

 Call stack (most recent first):

 log\_message("Undefined index: member", 8, true, true, "/var/www/mahara-dev/htdocs/artefact/lib.php", 864) at /var/www/mahara-dev/htdocs/lib/errors.php:446

 error(8, "Undefined index: member", "/var/www/mahara-dev/htdocs/artefact/lib.php", 864, array(size 2)) at /var/www/mahara-dev/htdocs/artefact/lib.php:864

 ArtefactType->role\_has\_permission("member", "edit") at /var/www/mahara-dev/htdocs/auth/user.php:960

 User->can\_edit\_artefact(object(ArtefactTypeFolder)) at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:1221

 pieform\_element\_filebrowser\_edit\_group\_folder("1", "5") at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:1308

 pieform\_element\_filebrowser\_changefolder(object(Pieform), array(size 11), "5") at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:696

 pieform\_element\_filebrowser\_doupdate(object(Pieform), array(size 11)) at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:362

 pieform\_element\_filebrowser\_get\_value(object(Pieform), array(size 11)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:802

 Pieform->get\_value(array(size 11)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:1253

 Pieform->get\_submitted\_values() at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:490

 Pieform->\_\_construct(array(size 12)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:161

 Pieform::process(array(size 12)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:71

 pieform(array(size 12)) at /var/www/mahara-dev/htdocs/artefact/file/groupfiles.php:49

 [WAR] 0a (artefact/lib.php:864) Trying to get property of non-object

 Call stack (most recent first):

 log\_message("Trying to get property of non-object", 8, true, true, "/var/www/mahara-dev/htdocs/artefact/lib.php", 864) at /var/www/mahara-dev/htdocs/lib/errors.php:446

 error(8, "Trying to get property of non-object", "/var/www/mahara-dev/htdocs/artefact/lib.php", 864, array(size 2)) at /var/www/mahara-dev/htdocs/artefact/lib.php:864

 ArtefactType->role\_has\_permission("member", "edit") at /var/www/mahara-dev/htdocs/auth/user.php:960

 User->can\_edit\_artefact(object(ArtefactTypeFolder)) at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:1221

 pieform\_element\_filebrowser\_edit\_group\_folder("1", "5") at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:1308

 pieform\_element\_filebrowser\_changefolder(object(Pieform), array(size 11), "5") at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:696

 pieform\_element\_filebrowser\_doupdate(object(Pieform), array(size 11)) at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:362

 pieform\_element\_filebrowser\_get\_value(object(Pieform), array(size 11)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:802

 Pieform->get\_value(array(size 11)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:1253

 Pieform->get\_submitted\_values() at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:490

 Pieform->\_\_construct(array(size 12)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:161

 Pieform::process(array(size 12)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:71

 pieform(array(size 12)) at /var/www/mahara-dev/htdocs/artefact/file/groupfiles.php:49

On a refresh, the home folder is shown, and the folder is not displayed, so can't click on it again.

Although, the member can still access the folder directly, by going to the url /artefact/file/groupfiles.php?group=1&folder=5 (or whatever id's), with the following warnings

[WAR] 81 (artefact/lib.php:864) Undefined index: member

 Call stack (most recent first):

 log\_message("Undefined index: member", 8, true, true, "/var/www/mahara-dev/htdocs/artefact/lib.php", 864) at /var/www/mahara-dev/htdocs/lib/errors.php:446

 error(8, "Undefined index: member", "/var/www/mahara-dev/htdocs/artefact/lib.php", 864, array(size 2)) at /var/www/mahara-dev/htdocs/artefact/lib.php:864

 ArtefactType->role\_has\_permission("member", "edit") at /var/www/mahara-dev/htdocs/auth/user.php:960

 User->can\_edit\_artefact(object(ArtefactTypeFolder)) at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:1221

 pieform\_element\_filebrowser\_edit\_group\_folder("1", 5) at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:126

 pieform\_element\_filebrowser(object(Pieform), array(size 13)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:1378

 Pieform->build\_element\_html(array(size 13)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:659

 Pieform->build() at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:162

 Pieform::process(array(size 12)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:71

 pieform(array(size 12)) at /var/www/mahara-dev/htdocs/artefact/file/groupfiles.php:49

 [WAR] 81 (artefact/lib.php:864) Trying to get property of non-object

 Call stack (most recent first):

 log\_message("Trying to get property of non-object", 8, true, true, "/var/www/mahara-dev/htdocs/artefact/lib.php", 864) at /var/www/mahara-dev/htdocs/lib/errors.php:446

 error(8, "Trying to get property of non-object", "/var/www/mahara-dev/htdocs/artefact/lib.php", 864, array(size 2)) at /var/www/mahara-dev/htdocs/artefact/lib.php:864

 ArtefactType->role\_has\_permission("member", "edit") at /var/www/mahara-dev/htdocs/auth/user.php:960

 User->can\_edit\_artefact(object(ArtefactTypeFolder)) at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:1221

 pieform\_element\_filebrowser\_edit\_group\_folder("1", 5) at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:126

 pieform\_element\_filebrowser(object(Pieform), array(size 13)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:1378

 Pieform->build\_element\_html(array(size 13)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:659

 Pieform->build() at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:162

 Pieform::process(array(size 12)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:71

 pieform(array(size 12)) at /var/www/mahara-dev/htdocs/artefact/file/groupfiles.php:49

The second way of accessing also gives a box saying "You do not have permission to add content to this folder", while the first does not, and infact shows the upload file and create folder boxes (though you can't add files)

Both of these ways allow the user to access the files within the folders, or by the url /artefact/file/download.php?file=14

This bug will have to probably change the way permissions work, and backtrack through all the parent folders making sure the user has access

## CVE References

* [2013-4432](/bugs/cve/2013-4432 "Mahara before 1.5.13, 1.6.x before 1....")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-08-07: |  |  | [#1](/mahara/%2Bbug/1034180/comments/1) |
| --- | --- | --- | --- |

I should note that when using the 1st method to access the folder, and trying to upload files or make new folders, the same error message is shown, so fixing that may lead to being able to upload files/folders

I should note that when using the 1st method to access the folder, and trying to upload files or make new folders, the same error message is shown, so fixing that may lead to being able to upload files/folders

[Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport)
on 2012-08-13

| Changed in mahara: | |
| --- | --- |
| **milestone**: | none → 1.6.0 |

[Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport)
on 2012-08-13

| Changed in mahara: | |
| --- | --- |
| **assignee**: | nobody → Hugh Davenport (hugh-catalyst) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-08-15: |  |  | [#2](/mahara/%2Bbug/1034180/comments/2) |
| --- | --- | --- | --- |

* [bug-1034180.patch](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Battachment/3261466/%2Bfiles/bug-1034180.patch)
  [Edit](/mahara/%2Bbug/1034180/%2Battachment/3261466)
  (8.0 KiB,
  text/plain)

Fix permissions of group area ([Bug #1034180](/bugs/1034180))

A user should not be able to view/publish an artefact if

    - they don't have view/publish permission of that artefact

    - they don't have view permission of all parents of that artefact

A user should not be able to edit an artefact if

    - they don't have edit permission of that artefact

    - they don't have edit permission of the immediate parent of that artefact

    - they don't have view permission of any parents below the immediate

This is similar to the UNIX permissions, you shouldn't be able to view

    a directory unless all directories below have read (r) and executeable (x)

    bits set. The same for editing, you need write (w) permissions of the

    immediate parent, and rx for all parents.

In Mahara, there are no executeable bits, but it can be assumed

    that view is basically the same as rw for container artefacts, and the same

    as r for non container artefacts.

 Fix permissions of group area (Bug #1034180)
A user should not be able to view/publish an artefact if
- they don't have view/publish permission of that artefact
- they don't have view permission of all parents of that artefact
A user should not be able to edit an artefact if
- they don't have edit permission of that artefact
- they don't have edit permission of the immediate parent of that artefact
- they don't have view permission of any parents below the immediate
This is similar to the UNIX permissions, you shouldn't be able to view
a directory unless all directories below have read (r) and executeable (x)
bits set. The same for editing, you need write (w) permissions of the
immediate parent, and rx for all parents.
In Mahara, there are no executeable bits, but it can be assumed
that view is basically the same as rw for container artefacts, and the same
as r for non container artefacts.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-08-15: |  |  | [#3](/mahara/%2Bbug/1034180/comments/3) |
| --- | --- | --- | --- |

* [bug-1034180-14.patch](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Battachment/3261477/%2Bfiles/bug-1034180-14.patch)
  [Edit](/mahara/%2Bbug/1034180/%2Battachment/3261477)
  (7.6 KiB,
  text/plain)

version for 1.4

version for 1.4

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-08-15: |  |  | [#5](/mahara/%2Bbug/1034180/comments/5) |
| --- | --- | --- | --- |

1.2 also needs to be able to run on whatever version of php lucid is stuck on

1.2 also needs to be able to run on whatever version of php lucid is stuck on

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-08-15: |  |  | [#6](/mahara/%2Bbug/1034180/comments/6) |
| --- | --- | --- | --- |

* [bug-1034180-12.patch](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Battachment/3261488/%2Bfiles/bug-1034180-12.patch)
  [Edit](/mahara/%2Bbug/1034180/%2Battachment/3261488)
  (7.2 KiB,
  text/plain)

actual version for 1.2 xD

actual version for 1.2 xD

| Changed in mahara: | |
| --- | --- |
| **status**: | Confirmed → In Progress |

[Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport)
on 2012-09-11

| Changed in mahara: | |
| --- | --- |
| **milestone**: | 1.6.0 → 1.7.0 |

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2013-04-19

| Changed in mahara: | |
| --- | --- |
| **importance**: | Medium → High |
| **importance**: | High → Critical |
| **milestone**: | 1.7.0 → 1.8.0 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-08-20: |  |  | [#7](/mahara/%2Bbug/1034180/comments/7) |
| --- | --- | --- | --- |

Whoops, accidentally pushed it as a normal patch instead of a security patch. :( Oh well.

<https://reviews.mahara.org/2417>

Whoops, accidentally pushed it as a normal patch instead of a security patch. :( Oh well.
https://reviews.mahara.org/2417

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-08-20: |  |  | [#8](/mahara/%2Bbug/1034180/comments/8) |
| --- | --- | --- | --- |

One side note about this, we'll probably need to adjust elasticsearch to take this new inheritable permission system into account as well... That may pose a problem. In consulting with Matt C, he pointed out that the main thing you want to make sure of in your permissions system is that the whole thing can be expressed as a single SQL statement. Currently ours can, but if we start having hierarchical permissions (like the permissions descending into folders) it'll be easy to create a system where it can't all be expressed in a standard SQL statement. One way to avoid that problem, is to make sure to add a "path" column to items that are subject to hierarchical permissions -- that makes it possible to look for parents/ancestors with standard SQL "like" clauses.

One side note about this, we'll probably need to adjust elasticsearch to take this new inheritable permission system into account as well... That may pose a problem. In consulting with Matt C, he pointed out that the main thing you want to make sure of in your permissions system is that the whole thing can be expressed as a single SQL statement. Currently ours can, but if we start having hierarchical permissions (like the permissions descending into folders) it'll be easy to create a system where it can't all be expressed in a standard SQL statement. One way to avoid that problem, is to make sure to add a "path" column to items that are subject to hierarchical permissions -- that makes it possible to look for parents/ancestors with standard SQL "like" clauses.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-08-21: |  |  | [#9](/mahara/%2Bbug/1034180/comments/9) |
| --- | --- | --- | --- |

The patch has been merged.

The patch has been merged.

| **information type**: | Private Security → Public Security |
| --- | --- |
| Changed in mahara: | |
| **status**: | In Progress → Fix Committed |
| **importance**: | Critical → High |

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2013-09-30

| Changed in mahara: | |
| --- | --- |
| **milestone**: | 1.8rc1 → 1.8.0 |

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2013-10-01

| Changed in mahara: | |
| --- | --- |
| **assignee**: | Hugh Davenport (hugh-davenport) → Son Nguyen (ngson2000) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2013-10-01:  [**A change has been merged**](/mahara/%2Bbug/1034180/comments/10) |  |  | [#10](/mahara/%2Bbug/1034180/comments/10) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/2555>

Committed: <http://gitorious.org/mahara/mahara/commit/f5cebdef3477c346d98959090937a8d49361fa84>

Submitter: Son Nguyen (<email address hidden>)

Branch: 1.6\_STABLE

commit f5cebdef3477c346d98959090937a8d49361fa84

Author: Hugh Davenport <email address hidden>

Date: Wed Aug 15 12:07:58 2012 +1200

Fix permissions of group area ([Bug #1034180](/bugs/1034180))

A user should not be able to view/publish an artefact if

- they don't have view/publish permission of that artefact

- they don't have view permission of all parents of that artefact

A user should not be able to edit an artefact if

- they don't have edit permission of that artefact

- they don't have edit permission of the immediate parent of that artefact

- they don't have view permission of any parents below the immediate

This is similar to the UNIX permissions, you shouldn't be able to view

a directory unless all directories below have read (r) and executeable (x)

bits set. The same for editing, you need write (w) permissions of the

immediate parent, and rx for all parents.

In Mahara, there are no executeable bits, but it can be assumed

that view is basically the same as rw for container artefacts, and the same

as r for non container artefacts.

Change-Id: I4f84aca05dd08d02b05fbe084e4724f78c8681a0

Signed-off-by: Hugh Davenport <email address hidden>

Reviewed: https://reviews.mahara.org/2555
Committed: http://gitorious.org/mahara/mahara/commit/f5cebdef3477c346d98959090937a8d49361fa84
Submitter: Son Nguyen (son.nguyen@catalyst.net.nz)
Branch: 1.6\_STABLE
commit f5cebdef3477c346d98959090937a8d49361fa84
Author: Hugh Davenport <hugh@catalyst.net.nz>
Date: Wed Aug 15 12:07:58 2012 +1200
Fix permissions of group area (Bug #1034180)
A user should not be able to view/publish an artefact if
- they don't have view/publish permission of that artefact
- they don't have view permission of all parents of that artefact
A user should not be able to edit an artefact if
- they don't have edit permission of that artefact
- they don't have edit permission of the immediate parent of that artefact
- they don't have view permission of any parents below the immediate
This is similar to the UNIX permissions, you shouldn't be able to view
a directory unless all directories below have read (r) and executeable (x)
bits set. The same for editing, you need write (w) permissions of the
immediate parent, and rx for all parents.
In Mahara, there are no executeable bits, but it can be assumed
that view is basically the same as rw for container artefacts, and the same
as r for non container artefacts.
Change-Id: I4f84aca05dd08d02b05fbe084e4724f78c8681a0
Signed-off-by: Hugh Davenport <hugh@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2013-10-01: |  |  | [#11](/mahara/%2Bbug/1034180/comments/11) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/2556>

Committed: <http://gitorious.org/mahara/mahara/commit/79a810210bfdf89a466876fdf8ac54354f73b73b>

Submitter: Son Nguyen (<email address hidden>)

Branch: 1.7\_STABLE

commit 79a810210bfdf89a466876fdf8ac54354f73b73b

Author: Hugh Davenport <email address hidden>

Date: Wed Aug 15 12:07:58 2012 +1200

Fix permissions of group area ([Bug #1034180](/bugs/1034180))

A user should not be able to view/publish an artefact if

- they don't have view/publish permission of that artefact

- they don't have view permission of all parents of that artefact

A user should not be able to edit an artefact if

- they don't have edit permission of that artefact

- they don't have edit permission of the immediate parent of that artefact

- they don't have view permission of any parents below the immediate

This is similar to the UNIX permissions, you shouldn't be able to view

a directory unless all directories below have read (r) and executeable (x)

bits set. The same for editing, you need write (w) permissions of the

immediate parent, and rx for all parents.

In Mahara, there are no executeable bits, but it can be assumed

that view is basically the same as rw for container artefacts, and the same

as r for non container artefacts.

Change-Id: I4f84aca05dd08d02b05fbe084e4724f78c8681a0

Signed-off-by: Hugh Davenport <email address hidden>

Reviewed: https://reviews.mahara.org/2556
Committed: http://gitorious.org/mahara/mahara/commit/79a810210bfdf89a466876fdf8ac54354f73b73b
Submitter: Son Nguyen (son.nguyen@catalyst.net.nz)
Branch: 1.7\_STABLE
commit 79a810210bfdf89a466876fdf8ac54354f73b73b
Author: Hugh Davenport <hugh@catalyst.net.nz>
Date: Wed Aug 15 12:07:58 2012 +1200
Fix permissions of group area (Bug #1034180)
A user should not be able to view/publish an artefact if
- they don't have view/publish permission of that artefact
- they don't have view permission of all parents of that artefact
A user should not be able to edit an artefact if
- they don't have edit permission of that artefact
- they don't have edit permission of the immediate parent of that artefact
- they don't have view permission of any parents below the immediate
This is similar to the UNIX permissions, you shouldn't be able to view
a directory unless all directories below have read (r) and executeable (x)
bits set. The same for editing, you need write (w) permissions of the
immediate parent, and rx for all parents.
In Mahara, there are no executeable bits, but it can be assumed
that view is basically the same as rw for container artefacts, and the same
as r for non container artefacts.
Change-Id: I4f84aca05dd08d02b05fbe084e4724f78c8681a0
Signed-off-by: Hugh Davenport <hugh@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2013-10-01: |  |  | [#12](/mahara/%2Bbug/1034180/comments/12) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/2554>

Committed: <http://gitorious.org/mahara/mahara/commit/0b4952e063f50c001e4c2dfc5749f55258bff952>

Submitter: Son Nguyen (<email address hidden>)

Branch: 1.5\_STABLE

commit 0b4952e063f50c001e4c2dfc5749f55258bff952

Author: Hugh Davenport <email address hidden>

Date: Wed Aug 15 12:07:58 2012 +1200

Fix permissions of group area ([Bug #1034180](/bugs/1034180))

A user should not be able to view/publish an artefact if

- they don't have view/publish permission of that artefact

- they don't have view permission of all parents of that artefact

A user should not be able to edit an artefact if

- they don't have edit permission of that artefact

- they don't have edit permission of the immediate parent of that artefact

- they don't have view permission of any parents below the immediate

This is similar to the UNIX permissions, you shouldn't be able to view

a directory unless all directories below have read (r) and executeable (x)

bits set. The same for editing, you need write (w) permissions of the

immediate parent, and rx for all parents.

In Mahara, there are no executeable bits, but it can be assumed

that view is basically the same as rw for container artefacts, and the same

as r for non container artefacts.

Change-Id: I4f84aca05dd08d02b05fbe084e4724f78c8681a0

Signed-off-by: Hugh Davenport <email address hidden>

Reviewed: https://reviews.mahara.org/2554
Committed: http://gitorious.org/mahara/mahara/commit/0b4952e063f50c001e4c2dfc5749f55258bff952
Submitter: Son Nguyen (son.nguyen@catalyst.net.nz)
Branch: 1.5\_STABLE
commit 0b4952e063f50c001e4c2dfc5749f55258bff952
Author: Hugh Davenport <hugh@catalyst.net.nz>
Date: Wed Aug 15 12:07:58 2012 +1200
Fix permissions of group area (Bug #1034180)
A user should not be able to view/publish an artefact if
- they don't have view/publish permission of that artefact
- they don't have view permission of all parents of that artefact
A user should not be able to edit an artefact if
- they don't have edit permission of that artefact
- they don't have edit permission of the immediate parent of that artefact
- they don't have view permission of any parents below the immediate
This is similar to the UNIX permissions, you shouldn't be able to view
a directory unless all directories below have read (r) and executeable (x)
bits set. The same for editing, you need write (w) permissions of the
immediate parent, and rx for all parents.
In Mahara, there are no executeable bits, but it can be assumed
that view is basically the same as rw for container artefacts, and the same
as r for non container artefacts.
Change-Id: I4f84aca05dd08d02b05fbe084e4724f78c8681a0
Signed-off-by: Hugh Davenport <hugh@catalyst.net.nz>

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2013-10-24

| Changed in mahara: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

[Bug Watch Updater (bug-watch-updater)](https://launchpad.net/~bug-watch-updater)
on 2013-10-24

| Changed in mahara (Debian): | |
| --- | --- |
| **status**: | Unknown → Confirmed |

[Bug Watch Updater (bug-watch-updater)](https://launchpad.net/~bug-watch-updater)
on 2013-12-03

| Changed in mahara (Debian): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

## Duplicates of this bug

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1034180/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [bug-1034180.patch](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Battachment/3261466/%2Bfiles/bug-1034180.patch)
  [Edit](/mahara/%2Bbug/1034180/%2Battachment/3261466 "Change patch details")
* [bug-1034180-14.patch](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Battachment/3261477/%2Bfiles/bug-1034180-14.patch)
  [Edit](/mahara/%2Bbug/1034180/%2Battachment/3261477 "Change patch details")
* [bug-1034180-12.patch](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Battachment/3261478/%2Bfiles/bug-1034180-12.patch)
  [Edit](/mahara/%2Bbug/1034180/%2Battachment/3261478 "Change patch details")
* [bug-1034180-12.patch](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Battachment/3261488/%2Bfiles/bug-1034180-12.patch)
  [Edit](/mahara/%2Bbug/1034180/%2Battachment/3261488 "Change patch details")

* [Add patch](/mahara/%2Bbug/1034180/%2Baddcomment?field.patch=on)

## Remote bug watches

* [debbugs #727539](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=727539)

  [done grave fixed-upstream patch security upstream]
  [Edit](/bugs/1034180/%2Bwatch/107746 "Change watch details")

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_e9dd6641_20250126_042300.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# A group member with no access rights to folder can still view it (if smart :D)

Bug #1034180 reported by
[Hugh Davenport](https://launchpad.net/~hugh-davenport)
on 2012-08-07

[268](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | High | [Son Nguyen](https://launchpad.net/~ngson2000) | [Mahara 1.8.0](https://launchpad.net/mahara/%2Bmilestone/1.8.0) |
|  | [1.5](https://bugs.launchpad.net/mahara/1.5) | Fix Released | High | Unassigned | [Mahara 1.5.13](https://launchpad.net/mahara/%2Bmilestone/1.5.13) |
|  | [1.6](https://bugs.launchpad.net/mahara/1.6) | Fix Released | High | Unassigned | [Mahara 1.6.8](https://launchpad.net/mahara/%2Bmilestone/1.6.8) |
|  | [1.7](https://bugs.launchpad.net/mahara/1.7) | Fix Released | High | Unassigned | [Mahara 1.7.4](https://launchpad.net/mahara/%2Bmilestone/1.7.4) |
|  | [mahara (Debian)](https://bugs.launchpad.net/debian/%2Bsource/mahara "Latest release: 1.0.4-4+lenny11, uploaded to main on 2012-03-10 15:14:46.784227+00:00 by Mahara Debian Packaging Team (pkg-debian), maintained by Mahara Debian Packaging Team (pkg-debian)") | Fix Released | Unknown | [debbugs #727539](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=727539) |  |

### Bug Description

If i create a folder in group files area, open a tab as a normal member, and then as group admin remove all rights to that folder for members, then as the member, click on the folder. The contents of the folder is then displayed (with the following warnings)

[WAR] 0a (artefact/lib.php:864) Undefined index: member

 Call stack (most recent first):

 log\_message("Undefined index: member", 8, true, true, "/var/www/mahara-dev/htdocs/artefact/lib.php", 864) at /var/www/mahara-dev/htdocs/lib/errors.php:446

 error(8, "Undefined index: member", "/var/www/mahara-dev/htdocs/artefact/lib.php", 864, array(size 2)) at /var/www/mahara-dev/htdocs/artefact/lib.php:864

 ArtefactType->role\_has\_permission("member", "edit") at /var/www/mahara-dev/htdocs/auth/user.php:960

 User->can\_edit\_artefact(object(ArtefactTypeFolder)) at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:1221

 pieform\_element\_filebrowser\_edit\_group\_folder("1", "5") at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:1308

 pieform\_element\_filebrowser\_changefolder(object(Pieform), array(size 11), "5") at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:696

 pieform\_element\_filebrowser\_doupdate(object(Pieform), array(size 11)) at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:362

 pieform\_element\_filebrowser\_get\_value(object(Pieform), array(size 11)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:802

 Pieform->get\_value(array(size 11)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:1253

 Pieform->get\_submitted\_values() at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:490

 Pieform->\_\_construct(array(size 12)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:161

 Pieform::process(array(size 12)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:71

 pieform(array(size 12)) at /var/www/mahara-dev/htdocs/artefact/file/groupfiles.php:49

 [WAR] 0a (artefact/lib.php:864) Trying to get property of non-object

 Call stack (most recent first):

 log\_message("Trying to get property of non-object", 8, true, true, "/var/www/mahara-dev/htdocs/artefact/lib.php", 864) at /var/www/mahara-dev/htdocs/lib/errors.php:446

 error(8, "Trying to get property of non-object", "/var/www/mahara-dev/htdocs/artefact/lib.php", 864, array(size 2)) at /var/www/mahara-dev/htdocs/artefact/lib.php:864

 ArtefactType->role\_has\_permission("member", "edit") at /var/www/mahara-dev/htdocs/auth/user.php:960

 User->can\_edit\_artefact(object(ArtefactTypeFolder)) at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:1221

 pieform\_element\_filebrowser\_edit\_group\_folder("1", "5") at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:1308

 pieform\_element\_filebrowser\_changefolder(object(Pieform), array(size 11), "5") at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:696

 pieform\_element\_filebrowser\_doupdate(object(Pieform), array(size 11)) at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:362

 pieform\_element\_filebrowser\_get\_value(object(Pieform), array(size 11)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:802

 Pieform->get\_value(array(size 11)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:1253

 Pieform->get\_submitted\_values() at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:490

 Pieform->\_\_construct(array(size 12)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:161

 Pieform::process(array(size 12)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:71

 pieform(array(size 12)) at /var/www/mahara-dev/htdocs/artefact/file/groupfiles.php:49

On a refresh, the home folder is shown, and the folder is not displayed, so can't click on it again.

Although, the member can still access the folder directly, by going to the url /artefact/file/groupfiles.php?group=1&folder=5 (or whatever id's), with the following warnings

[WAR] 81 (artefact/lib.php:864) Undefined index: member

 Call stack (most recent first):

 log\_message("Undefined index: member", 8, true, true, "/var/www/mahara-dev/htdocs/artefact/lib.php", 864) at /var/www/mahara-dev/htdocs/lib/errors.php:446

 error(8, "Undefined index: member", "/var/www/mahara-dev/htdocs/artefact/lib.php", 864, array(size 2)) at /var/www/mahara-dev/htdocs/artefact/lib.php:864

 ArtefactType->role\_has\_permission("member", "edit") at /var/www/mahara-dev/htdocs/auth/user.php:960

 User->can\_edit\_artefact(object(ArtefactTypeFolder)) at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:1221

 pieform\_element\_filebrowser\_edit\_group\_folder("1", 5) at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:126

 pieform\_element\_filebrowser(object(Pieform), array(size 13)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:1378

 Pieform->build\_element\_html(array(size 13)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:659

 Pieform->build() at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:162

 Pieform::process(array(size 12)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:71

 pieform(array(size 12)) at /var/www/mahara-dev/htdocs/artefact/file/groupfiles.php:49

 [WAR] 81 (artefact/lib.php:864) Trying to get property of non-object

 Call stack (most recent first):

 log\_message("Trying to get property of non-object", 8, true, true, "/var/www/mahara-dev/htdocs/artefact/lib.php", 864) at /var/www/mahara-dev/htdocs/lib/errors.php:446

 error(8, "Trying to get property of non-object", "/var/www/mahara-dev/htdocs/artefact/lib.php", 864, array(size 2)) at /var/www/mahara-dev/htdocs/artefact/lib.php:864

 ArtefactType->role\_has\_permission("member", "edit") at /var/www/mahara-dev/htdocs/auth/user.php:960

 User->can\_edit\_artefact(object(ArtefactTypeFolder)) at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:1221

 pieform\_element\_filebrowser\_edit\_group\_folder("1", 5) at /var/www/mahara-dev/htdocs/artefact/file/form/elements/filebrowser.php:126

 pieform\_element\_filebrowser(object(Pieform), array(size 13)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:1378

 Pieform->build\_element\_html(array(size 13)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:659

 Pieform->build() at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:162

 Pieform::process(array(size 12)) at /var/www/mahara-dev/htdocs/lib/pieforms/pieform.php:71

 pieform(array(size 12)) at /var/www/mahara-dev/htdocs/artefact/file/groupfiles.php:49

The second way of accessing also gives a box saying "You do not have permission to add content to this folder", while the first does not, and infact shows the upload file and create folder boxes (though you can't add files)

Both of these ways allow the user to access the files within the folders, or by the url /artefact/file/download.php?file=14

This bug will have to probably change the way permissions work, and backtrack through all the parent folders making sure the user has access

## CVE References

* [2013-4432](/bugs/cve/2013-4432 "Mahara before 1.5.13, 1.6.x before 1....")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-08-07: |  |  | [#1](/mahara/%2Bbug/1034180/comments/1) |
| --- | --- | --- | --- |

I should note that when using the 1st method to access the folder, and trying to upload files or make new folders, the same error message is shown, so fixing that may lead to being able to upload files/folders

I should note that when using the 1st method to access the folder, and trying to upload files or make new folders, the same error message is shown, so fixing that may lead to being able to upload files/folders

[Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport)
on 2012-08-13

| Changed in mahara: | |
| --- | --- |
| **milestone**: | none → 1.6.0 |

[Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport)
on 2012-08-13

| Changed in mahara: | |
| --- | --- |
| **assignee**: | nobody → Hugh Davenport (hugh-catalyst) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-08-15: |  |  | [#2](/mahara/%2Bbug/1034180/comments/2) |
| --- | --- | --- | --- |

* [bug-1034180.patch](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Battachment/3261466/%2Bfiles/bug-1034180.patch)
  [Edit](/mahara/%2Bbug/1034180/%2Battachment/3261466)
  (8.0 KiB,
  text/plain)

Fix permissions of group area ([Bug #1034180](/bugs/1034180))

A user should not be able to view/publish an artefact if

    - they don't have view/publish permission of that artefact

    - they don't have view permission of all parents of that artefact

A user should not be able to edit an artefact if

    - they don't have edit permission of that artefact

    - they don't have edit permission of the immediate parent of that artefact

    - they don't have view permission of any parents below the immediate

This is similar to the UNIX permissions, you shouldn't be able to view

    a directory unless all directories below have read (r) and executeable (x)

    bits set. The same for editing, you need write (w) permissions of the

    immediate parent, and rx for all parents.

In Mahara, there are no executeable bits, but it can be assumed

    that view is basically the same as rw for container artefacts, and the same

    as r for non container artefacts.

 Fix permissions of group area (Bug #1034180)
A user should not be able to view/publish an artefact if
- they don't have view/publish permission of that artefact
- they don't have view permission of all parents of that artefact
A user should not be able to edit an artefact if
- they don't have edit permission of that artefact
- they don't have edit permission of the immediate parent of that artefact
- they don't have view permission of any parents below the immediate
This is similar to the UNIX permissions, you shouldn't be able to view
a directory unless all directories below have read (r) and executeable (x)
bits set. The same for editing, you need write (w) permissions of the
immediate parent, and rx for all parents.
In Mahara, there are no executeable bits, but it can be assumed
that view is basically the same as rw for container artefacts, and the same
as r for non container artefacts.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-08-15: |  |  | [#3](/mahara/%2Bbug/1034180/comments/3) |
| --- | --- | --- | --- |

* [bug-1034180-14.patch](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Battachment/3261477/%2Bfiles/bug-1034180-14.patch)
  [Edit](/mahara/%2Bbug/1034180/%2Battachment/3261477)
  (7.6 KiB,
  text/plain)

version for 1.4

version for 1.4

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-08-15: |  |  | [#5](/mahara/%2Bbug/1034180/comments/5) |
| --- | --- | --- | --- |

1.2 also needs to be able to run on whatever version of php lucid is stuck on

1.2 also needs to be able to run on whatever version of php lucid is stuck on

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport) wrote on 2012-08-15: |  |  | [#6](/mahara/%2Bbug/1034180/comments/6) |
| --- | --- | --- | --- |

* [bug-1034180-12.patch](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Battachment/3261488/%2Bfiles/bug-1034180-12.patch)
  [Edit](/mahara/%2Bbug/1034180/%2Battachment/3261488)
  (7.2 KiB,
  text/plain)

actual version for 1.2 xD

actual version for 1.2 xD

| Changed in mahara: | |
| --- | --- |
| **status**: | Confirmed → In Progress |

[Hugh Davenport (hugh-davenport)](https://launchpad.net/~hugh-davenport)
on 2012-09-11

| Changed in mahara: | |
| --- | --- |
| **milestone**: | 1.6.0 → 1.7.0 |

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2013-04-19

| Changed in mahara: | |
| --- | --- |
| **importance**: | Medium → High |
| **importance**: | High → Critical |
| **milestone**: | 1.7.0 → 1.8.0 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-08-20: |  |  | [#7](/mahara/%2Bbug/1034180/comments/7) |
| --- | --- | --- | --- |

Whoops, accidentally pushed it as a normal patch instead of a security patch. :( Oh well.

<https://reviews.mahara.org/2417>

Whoops, accidentally pushed it as a normal patch instead of a security patch. :( Oh well.
https://reviews.mahara.org/2417

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-08-20: |  |  | [#8](/mahara/%2Bbug/1034180/comments/8) |
| --- | --- | --- | --- |

One side note about this, we'll probably need to adjust elasticsearch to take this new inheritable permission system into account as well... That may pose a problem. In consulting with Matt C, he pointed out that the main thing you want to make sure of in your permissions system is that the whole thing can be expressed as a single SQL statement. Currently ours can, but if we start having hierarchical permissions (like the permissions descending into folders) it'll be easy to create a system where it can't all be expressed in a standard SQL statement. One way to avoid that problem, is to make sure to add a "path" column to items that are subject to hierarchical permissions -- that makes it possible to look for parents/ancestors with standard SQL "like" clauses.

One side note about this, we'll probably need to adjust elasticsearch to take this new inheritable permission system into account as well... That may pose a problem. In consulting with Matt C, he pointed out that the main thing you want to make sure of in your permissions system is that the whole thing can be expressed as a single SQL statement. Currently ours can, but if we start having hierarchical permissions (like the permissions descending into folders) it'll be easy to create a system where it can't all be expressed in a standard SQL statement. One way to avoid that problem, is to make sure to add a "path" column to items that are subject to hierarchical permissions -- that makes it possible to look for parents/ancestors with standard SQL "like" clauses.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw) wrote on 2013-08-21: |  |  | [#9](/mahara/%2Bbug/1034180/comments/9) |
| --- | --- | --- | --- |

The patch has been merged.

The patch has been merged.

| **information type**: | Private Security → Public Security |
| --- | --- |
| Changed in mahara: | |
| **status**: | In Progress → Fix Committed |
| **importance**: | Critical → High |

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2013-09-30

| Changed in mahara: | |
| --- | --- |
| **milestone**: | 1.8rc1 → 1.8.0 |

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2013-10-01

| Changed in mahara: | |
| --- | --- |
| **assignee**: | Hugh Davenport (hugh-davenport) → Son Nguyen (ngson2000) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2013-10-01:  [**A change has been merged**](/mahara/%2Bbug/1034180/comments/10) |  |  | [#10](/mahara/%2Bbug/1034180/comments/10) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/2555>

Committed: <http://gitorious.org/mahara/mahara/commit/f5cebdef3477c346d98959090937a8d49361fa84>

Submitter: Son Nguyen (<email address hidden>)

Branch: 1.6\_STABLE

commit f5cebdef3477c346d98959090937a8d49361fa84

Author: Hugh Davenport <email address hidden>

Date: Wed Aug 15 12:07:58 2012 +1200

Fix permissions of group area ([Bug #1034180](/bugs/1034180))

A user should not be able to view/publish an artefact if

- they don't have view/publish permission of that artefact

- they don't have view permission of all parents of that artefact

A user should not be able to edit an artefact if

- they don't have edit permission of that artefact

- they don't have edit permission of the immediate parent of that artefact

- they don't have view permission of any parents below the immediate

This is similar to the UNIX permissions, you shouldn't be able to view

a directory unless all directories below have read (r) and executeable (x)

bits set. The same for editing, you need write (w) permissions of the

immediate parent, and rx for all parents.

In Mahara, there are no executeable bits, but it can be assumed

that view is basically the same as rw for container artefacts, and the same

as r for non container artefacts.

Change-Id: I4f84aca05dd08d02b05fbe084e4724f78c8681a0

Signed-off-by: Hugh Davenport <email address hidden>

Reviewed: https://reviews.mahara.org/2555
Committed: http://gitorious.org/mahara/mahara/commit/f5cebdef3477c346d98959090937a8d49361fa84
Submitter: Son Nguyen (son.nguyen@catalyst.net.nz)
Branch: 1.6\_STABLE
commit f5cebdef3477c346d98959090937a8d49361fa84
Author: Hugh Davenport <hugh@catalyst.net.nz>
Date: Wed Aug 15 12:07:58 2012 +1200
Fix permissions of group area (Bug #1034180)
A user should not be able to view/publish an artefact if
- they don't have view/publish permission of that artefact
- they don't have view permission of all parents of that artefact
A user should not be able to edit an artefact if
- they don't have edit permission of that artefact
- they don't have edit permission of the immediate parent of that artefact
- they don't have view permission of any parents below the immediate
This is similar to the UNIX permissions, you shouldn't be able to view
a directory unless all directories below have read (r) and executeable (x)
bits set. The same for editing, you need write (w) permissions of the
immediate parent, and rx for all parents.
In Mahara, there are no executeable bits, but it can be assumed
that view is basically the same as rw for container artefacts, and the same
as r for non container artefacts.
Change-Id: I4f84aca05dd08d02b05fbe084e4724f78c8681a0
Signed-off-by: Hugh Davenport <hugh@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2013-10-01: |  |  | [#11](/mahara/%2Bbug/1034180/comments/11) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/2556>

Committed: <http://gitorious.org/mahara/mahara/commit/79a810210bfdf89a466876fdf8ac54354f73b73b>

Submitter: Son Nguyen (<email address hidden>)

Branch: 1.7\_STABLE

commit 79a810210bfdf89a466876fdf8ac54354f73b73b

Author: Hugh Davenport <email address hidden>

Date: Wed Aug 15 12:07:58 2012 +1200

Fix permissions of group area ([Bug #1034180](/bugs/1034180))

A user should not be able to view/publish an artefact if

- they don't have view/publish permission of that artefact

- they don't have view permission of all parents of that artefact

A user should not be able to edit an artefact if

- they don't have edit permission of that artefact

- they don't have edit permission of the immediate parent of that artefact

- they don't have view permission of any parents below the immediate

This is similar to the UNIX permissions, you shouldn't be able to view

a directory unless all directories below have read (r) and executeable (x)

bits set. The same for editing, you need write (w) permissions of the

immediate parent, and rx for all parents.

In Mahara, there are no executeable bits, but it can be assumed

that view is basically the same as rw for container artefacts, and the same

as r for non container artefacts.

Change-Id: I4f84aca05dd08d02b05fbe084e4724f78c8681a0

Signed-off-by: Hugh Davenport <email address hidden>

Reviewed: https://reviews.mahara.org/2556
Committed: http://gitorious.org/mahara/mahara/commit/79a810210bfdf89a466876fdf8ac54354f73b73b
Submitter: Son Nguyen (son.nguyen@catalyst.net.nz)
Branch: 1.7\_STABLE
commit 79a810210bfdf89a466876fdf8ac54354f73b73b
Author: Hugh Davenport <hugh@catalyst.net.nz>
Date: Wed Aug 15 12:07:58 2012 +1200
Fix permissions of group area (Bug #1034180)
A user should not be able to view/publish an artefact if
- they don't have view/publish permission of that artefact
- they don't have view permission of all parents of that artefact
A user should not be able to edit an artefact if
- they don't have edit permission of that artefact
- they don't have edit permission of the immediate parent of that artefact
- they don't have view permission of any parents below the immediate
This is similar to the UNIX permissions, you shouldn't be able to view
a directory unless all directories below have read (r) and executeable (x)
bits set. The same for editing, you need write (w) permissions of the
immediate parent, and rx for all parents.
In Mahara, there are no executeable bits, but it can be assumed
that view is basically the same as rw for container artefacts, and the same
as r for non container artefacts.
Change-Id: I4f84aca05dd08d02b05fbe084e4724f78c8681a0
Signed-off-by: Hugh Davenport <hugh@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2013-10-01: |  |  | [#12](/mahara/%2Bbug/1034180/comments/12) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/2554>

Committed: <http://gitorious.org/mahara/mahara/commit/0b4952e063f50c001e4c2dfc5749f55258bff952>

Submitter: Son Nguyen (<email address hidden>)

Branch: 1.5\_STABLE

commit 0b4952e063f50c001e4c2dfc5749f55258bff952

Author: Hugh Davenport <email address hidden>

Date: Wed Aug 15 12:07:58 2012 +1200

Fix permissions of group area ([Bug #1034180](/bugs/1034180))

A user should not be able to view/publish an artefact if

- they don't have view/publish permission of that artefact

- they don't have view permission of all parents of that artefact

A user should not be able to edit an artefact if

- they don't have edit permission of that artefact

- they don't have edit permission of the immediate parent of that artefact

- they don't have view permission of any parents below the immediate

This is similar to the UNIX permissions, you shouldn't be able to view

a directory unless all directories below have read (r) and executeable (x)

bits set. The same for editing, you need write (w) permissions of the

immediate parent, and rx for all parents.

In Mahara, there are no executeable bits, but it can be assumed

that view is basically the same as rw for container artefacts, and the same

as r for non container artefacts.

Change-Id: I4f84aca05dd08d02b05fbe084e4724f78c8681a0

Signed-off-by: Hugh Davenport <email address hidden>

Reviewed: https://reviews.mahara.org/2554
Committed: http://gitorious.org/mahara/mahara/commit/0b4952e063f50c001e4c2dfc5749f55258bff952
Submitter: Son Nguyen (son.nguyen@catalyst.net.nz)
Branch: 1.5\_STABLE
commit 0b4952e063f50c001e4c2dfc5749f55258bff952
Author: Hugh Davenport <hugh@catalyst.net.nz>
Date: Wed Aug 15 12:07:58 2012 +1200
Fix permissions of group area (Bug #1034180)
A user should not be able to view/publish an artefact if
- they don't have view/publish permission of that artefact
- they don't have view permission of all parents of that artefact
A user should not be able to edit an artefact if
- they don't have edit permission of that artefact
- they don't have edit permission of the immediate parent of that artefact
- they don't have view permission of any parents below the immediate
This is similar to the UNIX permissions, you shouldn't be able to view
a directory unless all directories below have read (r) and executeable (x)
bits set. The same for editing, you need write (w) permissions of the
immediate parent, and rx for all parents.
In Mahara, there are no executeable bits, but it can be assumed
that view is basically the same as rw for container artefacts, and the same
as r for non container artefacts.
Change-Id: I4f84aca05dd08d02b05fbe084e4724f78c8681a0
Signed-off-by: Hugh Davenport <hugh@catalyst.net.nz>

[Aaron Wells (u-aaronw)](https://launchpad.net/~u-aaronw)
on 2013-10-24

| Changed in mahara: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

[Bug Watch Updater (bug-watch-updater)](https://launchpad.net/~bug-watch-updater)
on 2013-10-24

| Changed in mahara (Debian): | |
| --- | --- |
| **status**: | Unknown → Confirmed |

[Bug Watch Updater (bug-watch-updater)](https://launchpad.net/~bug-watch-updater)
on 2013-12-03

| Changed in mahara (Debian): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

## Duplicates of this bug

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1034180/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [bug-1034180.patch](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Battachment/3261466/%2Bfiles/bug-1034180.patch)
  [Edit](/mahara/%2Bbug/1034180/%2Battachment/3261466 "Change patch details")
* [bug-1034180-14.patch](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Battachment/3261477/%2Bfiles/bug-1034180-14.patch)
  [Edit](/mahara/%2Bbug/1034180/%2Battachment/3261477 "Change patch details")
* [bug-1034180-12.patch](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Battachment/3261478/%2Bfiles/bug-1034180-12.patch)
  [Edit](/mahara/%2Bbug/1034180/%2Battachment/3261478 "Change patch details")
* [bug-1034180-12.patch](https://bugs.launchpad.net/mahara/%2Bbug/1034180/%2Battachment/3261488/%2Bfiles/bug-1034180-12.patch)
  [Edit](/mahara/%2Bbug/1034180/%2Battachment/3261488 "Change patch details")

* [Add patch](/mahara/%2Bbug/1034180/%2Baddcomment?field.patch=on)

## Remote bug watches

* [debbugs #727539](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=727539)

  [done grave fixed-upstream patch security upstream]
  [Edit](/bugs/1034180/%2Bwatch/107746 "Change watch details")

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.openwall.com_4bd6beb4_20250124_231525.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](../../../2013/10/15/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <525E2937.8090902@redhat.com>
Date: Tue, 15 Oct 2013 23:50:47 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
Subject: Re: Re: CVE request: mahara 1.7.3

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 10/15/2013 06:18 AM, Raphael Geissert wrote:
> So, the commits...
>
> On 8 October 2013 12:16, Raphael Geissert <geissert@...ian.org>
> wrote:
>> Hi,
>>
>> Multiple vulnerabilities have been discovered and fixed in the
>> 1.7.3 release of Mahara:
>>
>> From [1]
>>> * Bug #1211758 Arbitrary image download
>
> <https://bazaar.launchpad.net/~mahara-release/mahara/1.7_STABLE/revision/5833>
>
>
>>> * Bug #1175446 user supplied $_SERVER['HTTP_HOST'] can be used
>>> for injections
>
> <https://bazaar.launchpad.net/~mahara-release/mahara/1.7_STABLE/revision/5830>
>
>
>>> * Bug #1233500 Not checking ownership of blocks before editing
>>> them
>
> <https://bazaar.launchpad.net/~mahara-release/mahara/1.7_STABLE/revision/5832>
>
>
>
> And while at I found the following:
>
> [https://bugs.launchpad.net/mahara/+bug/1034180](https://bugs.launchpad.net/mahara/%2Bbug/1034180)
> <https://bazaar.launchpad.net/~mahara-release/mahara/1.7_STABLE/revision/5831>
>
>  Which doesn't appear to be mentioned in the changelog, but the
> bug report clearly states it was meant to be handled as a security
> issue.
>
> Cheers,
>

Please use:

CVE-2013-4429 Mahara Bug #1211758 Arbitrary image download

CVE-2013-4430 Mahara Bug #1175446 user supplied $_SERVER['HTTP_HOST']
can be used for injections

CVE-2013-4431 Mahara Bug #1233500 Not checking ownership of blocks
before editing them

CVE-2013-4432 Mahara A group member with no access rights to folder
can still view it - [https://bugs.launchpad.net/mahara/+bug/1034180](https://bugs.launchpad.net/mahara/%2Bbug/1034180)

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.15 (GNU/Linux)

iQIcBAEBAgAGBQJSXik3AAoJEBYNRVNeJnmTSCcQAJ4j2ICSEgsXCLb+SM8XOpxh
1JoZtR+D9pGNgDJszJh6MtMapqUQcXoMxBkzoUEqKwCQ+EfW6PhKtruWMsN/EFIL
/HkLm309Qsp/40g1UUyuXnAtq0rproLI4cCD0dKtfzXnRsNVI5DY70nvohLDk04j
VPNJNDcBWewCY9QFQZgXDlawTUSj+cW/sjJnqSQ6WuiJ67xOgAafzFKdfossKjCc
hmvIOe+92f4d8fAg4g4YDMz0hcM1jkVeqSZ0wBTq0ENtGt5OjMMuW2WA53KdfgVF
utKKH38U3/AGUK5AArYxD3748Q6qxsm9Nw2qBjUcTCHruSbZnC3BXjjXa+YPMR3v
oooJcG1ImIdq2Lyc3gW7rLA1JCQBOX/BAAs5OyVjRmQpBCdUHXiB1e9nSt3WkPrc
+blYpSFmR/61dQkHwsJAqLBVMkD1RPKTRBKx2Gge8A2z7KmgOMoP/biON//IyIdt
xteDCOhLnJ/Y4IFa0prhWynnC/DUWMK86HWS5Ev3B4/6tqpIShn0hQD4OaHLp4SO
FQNLSV0dVkZB9qaxZCdqAGMITx2fxxQmYSLk1ITrUNXxjtxNd9Iw5yHUKMZYvvw3
W8wi+RAi623qcuH5icEr9/i5jdWxvKNleiMn5HlIZ+nM6MJrEoPfYq0NlRHJESG0
YPvzE13gCzPdXFPEOeCo
=QBLt
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_a0b8d669_20250124_231525.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[thread-next>]](../../../2013/10/10/18) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAA7hUgFVYCP55JoCHdQGwNwe72f7RaJpDUWvLRMJaq+kUyxeVw@mail.gmail.com>
Date: Tue, 8 Oct 2013 12:16:02 +0200
From: Raphael Geissert <geissert@...ian.org>
To: oss-security@...ts.openwall.com
Cc: security@...ara.org
Subject: CVE request: mahara 1.7.3

Hi,

Multiple vulnerabilities have been discovered and fixed in the 1.7.3
release of Mahara:

>From [1]
> * Bug #1211758 Arbitrary image download
> * Bug #1175446 user supplied $_SERVER['HTTP_HOST'] can be used for injections
> * Bug #1233500 Not checking ownership of blocks before editing them

1st and 3rd issues are described at:
<https://mahara.org/interaction/forum/topic.php?id=5753>

2nd issue is described at:
<https://mahara.org/interaction/forum/topic.php?id=5754>

Could CVE ids be assigned please?

To Hugh and the other mahara security people: please chime in if you
have already requested ids to somebody else.

[1] <https://launchpad.net/mahara/1.7/1.7.3#release-notes>

Thanks,
--
Raphael Geissert - Debian Developer
www.debian.org - get.debian.net

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


