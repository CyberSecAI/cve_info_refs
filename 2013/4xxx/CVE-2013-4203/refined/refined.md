- **Root cause of vulnerability:** The `rgpg` Ruby gem does not sanitize user-supplied input before passing it to the `system()` function, which leads to command injection.
- **Weaknesses/vulnerabilities present:** The code in `lib/rgpg/gpg_helper.rb` at line 70 directly incorporates unsanitized user input into a shell command executed via `system()`.
- **Impact of exploitation:** An attacker can inject arbitrary shell commands through user-supplied input, leading to potential remote code execution on the server running the application.
- **Attack vectors:** By providing shell meta-characters (e.g., `;`, `&`) within the user input to the API of the `rgpg` gem in a vulnerable application.
- **Required attacker capabilities/position:** The attacker needs the ability to supply user input that's passed to the vulnerable code. This typically happens when the `rgpg` gem is used within a web application where user-controlled data is used in the `command/line`.