=== Content from jvndb.jvn.jp_b07d61cf_20250125_031017.html ===


![JVN iPedia](/en/common/img/en_logo.gif)
Last Updated:2013/09/02

| [[Japanese]](/ja/contents/2013/JVNDB-2013-000081.html) | |
| --- | --- |
| JVNDB-2013-000081 | |
| EC-CUBE vulnerable to directory traversal when used in Windows | |
| Overview | |
| EC-CUBE from LOCKON CO.,LTD. is an open source system for creating shopping websites. EC-CUBE contains a directory traversal vulnerability when used in Windows. | |
| CVSS Severity ([What is CVSS?](/en/nav/jvndbhelp.html#jvndb3)) | |
| **CVSS V2 Severity:Base Metrics [5.0](/cvss/en/v2.html#AV:N/AC:L/Au:N/C:P/I:N/A:N) (Medium) [IPA Score]**  * Access Vector: Network * Access Complexity: Low * Authentication: None * Confidentiality Impact: Partial * Integrity Impact: None * Availability Impact: None | |
| Affected Products | |
| Versions listed below are vulnerable when used in Windows. | |
| LOCKON CO.,LTD  * EC-CUBE 2.12.0 * EC-CUBE 2.12.1 * EC-CUBE 2.12.2 * EC-CUBE 2.12.3 * EC-CUBE 2.12.3en * EC-CUBE 2.12.3enP1 * EC-CUBE 2.12.3enP2 * EC-CUBE 2.12.4 * EC-CUBE 2.12.4en * EC-CUBE 2.12.5 * EC-CUBE 2.12.5en | |
|  | |
| Impact | |
| A remote attacker may obtain arbitrary files on the server. | |
| Solution | |
| [Apply the update or patch] | |
| Vendor Information | |
| LOCKON CO.,LTD  * LOCKON CO.,LTD : [Directory traversal vulnerability when used in Windows](http://www.ec-cube.net/info/weakness/weakness.php?id=50) (in Japanese) * LOCKON CO.,LTD : [Changeset 22891](http://svn.ec-cube.net/open_trac/changeset/22891) (in Japanese) * LOCKON CO.,LTD : [Information of EC-CUBE vulnerability](http://www.ec-cube.net/info/weakness/20130829/index.php) (in Japanese) | |
| CWE ([What is CWE?](http://www.ipa.go.jp/security/english/vuln/CWE_en.html)) | |
| 1. [Path Traversal](http://www.ipa.go.jp/security/english/vuln/CWE_en.html#CWE22)(CWE-22) [IPA Evaluation] | |
| CVE ([What is CVE?](http://www.ipa.go.jp/security/english/vuln/CVE_en.html)) | |
| 1. [CVE-2013-4702](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-4702) | |
| References | |
| 1. JVN : [JVN#15973066](http://jvn.jp/en/jp/JVN15973066/index.html) 2. National Vulnerability Database (NVD) : [CVE-2013-4702](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-4702) | |
| Revision History | |
| * [2013/08/30] | |

| --- | |
| --- | --- |
| Date Public | 2013/08/30 |
| Date First Published | 2013/08/30 |
| Date Last Updated | 2013/09/02 |
| --- | |

* JVN
* [HOME](http://jvn.jp/en/)
* [What is JVN ?](http://jvn.jp/en/nav/jvn.html)
* [Instructions](http://jvn.jp/en/nav/jvnhelp.html)
* [List of Vulnerability Report](http://jvn.jp/en/report/index.html)
* [VN\_JP](http://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](http://jvn.jp/en/adj/index.html)
* [VN\_VU](http://jvn.jp/en/vu/index.html)
* [TA](http://jvn.jp/en/ta/index.html)
* [TRnotes](http://jvn.jp/en/tr/index.html)
* [JVN iPedia](/en/)
* [Search](/search/index.php?mode=_vulnerability_search_IA_VulnSearch&lang=en)
* [What is JVN iPedia?](/en/nav/jvndb.html)
* [How to Use?](/en/nav/jvndbhelp.html)
* [MyJVN](/en/apis/myjvn/index.html)
* [JVNJS/RSS](http://jvn.jp/en/rss/index.html)
* [Vendor List](http://jvn.jp/en/nav/index.html)
* [List of unreachable developers](http://jvn.jp/en/reply/index.html)
* [Contact](http://jvn.jp/en/contact/index.html)

![Copyright © 2007- IPA. All rights reserved.](/common/img/copyright.png)



=== Content from www.ec-cube.net_bbd59d09_20250125_031021.html ===


JavaScript を有効にしてご利用下さい.

# [EC-CUBE®](/)

* [選ばれる理由](/reason/)
* [機能](/functions/)
* [決済](/alliance/)
* [導入事例](/cases/)
* [セキュリティ](/security/)
* [ストア](https://www.ec-cube.net/owners/)

[まずは相談する](/advisor/)

[ご利用中の方のお問い合わせはこちら](/support/)

* [資料請求](/document/)
* [ダウンロード](/download/)

# 脆弱性

## Windowsサーバー環境における、ディレクトリトラバーサルの脆弱性

* 情報公開日：2013年 08月 29日
* 危険度：高
* 対象：Ver 2.12.0以降(2.12.0 ～2.12.5)

```
-------------------------------------------------------------------
■脆弱性の種類
-------------------------------------------------------------------
ディレクトリトラバーサルに関する脆弱性

-------------------------------------------------------------------
■不具合が発生する環境
-------------------------------------------------------------------
Windowsサーバーを利用している環境

-------------------------------------------------------------------
■不具合が存在するEC-CUBEのバージョン
-------------------------------------------------------------------
EC-CUBE　2.12.0 以降
	 2.12.0
	 2.12.1
	 2.12.2
	 2.12.3
	 2.12.3en.p1
	 2.12.3en.p2
	 2.12.4
	 2.12.4en
	 2.12.5
	 2.12.5en

-------------------------------------------------------------------
■修正方法について(以下は Ver2.12.5 の修正となっております。)
-------------------------------------------------------------------

data/class/api/SC_Api_Operation.php::doApiAction
に以下の変更を加えます。

※修正ファイルの詳細はこちらをご確認ください
http://www.ec-cube.net/info/weakness/20130829/index.php

▽SC_Api_Operation.php
関数追加
-----------------------------------------------------------------------------------------------------------------
 追加
-----------------------------------------------------------------------------------------------------------------
/**
 * APIのリクエスト基本パラメーターのチェック
 *
 * @param object $objFormParam
 * @return array $arrErr
 */
protected function checkParam($objFormParam)
{
    $arrErr = $objFormParam->checkError();
    if (!preg_match("/^[a-zA-Z0-9\-\_]+$/", $objFormParam->getValue('Operation')) && !SC_Utils::isBlank($objFormParam->getValue('Operation'))) {
        $arrErr['ECCUBE.Operation.ParamError'] = 'Operationの値が不正です。';
    }
    if (!preg_match("/^[a-zA-Z0-9\-\_]+$/", $objFormParam->getValue('Service')) && !SC_Utils::isBlank($objFormParam->getValue('Service'))) {
        $arrErr['ECCUBE.Service.ParamError'] = 'Serviceの値が不正です。';
    }
    if (!preg_match("/^[a-zA-Z0-9\-\_]+$/", $objFormParam->getValue('Style')) && !SC_Utils::isBlank($objFormParam->getValue('Style'))) {
        $arrErr['ECCUBE.Style.ParamError'] = 'Styleの値が不正です。';
    }
    if (!preg_match("/^[a-zA-Z0-9\-\_]+$/", $objFormParam->getValue('Validate')) && !SC_Utils::isBlank($objFormParam->getValue('Validate'))) {
        $arrErr['ECCUBE.Validate.ParamError'] = 'Validateの値が不正です。';
    }
    if (!preg_match("/^[a-zA-Z0-9\-\_\.]+$/", $objFormParam->getValue('Version')) && !SC_Utils::isBlank($objFormParam->getValue('Version'))) {
        $arrErr['ECCUBE.Version.ParamError'] = 'Versionの値が不正です。';
    }
    return $arrErr;
}
=================================================================================================================

下記のリビジョンで修正
http://svn.ec-cube.net/open_trac/changeset/22891
```

1. [ホーム](/)
3. 脆弱性

 [PageTop](#wrap)

## EC-CUBE公式アドバイザーご相談窓口

* 他社のASPやパッケージとの違いを知りたい
* BtoCのサイトにBtoB機能を追加したい
* 何から手をつければよいかわからない
* オープンソースならではの注意事項を知りたい
* 自社にマッチした制作会社を探したい
* サイト制作だけでなく運営もサポートしてほしい

新規構築・リニューアル・取引先向けのWeb受発注システム（BtoB）や事業の拡大など、
今抱えている課題を解決する最適な業者探しを、アドバイザーがお手伝いします。

* [まずは相談する](/advisor/)
* [資料請求する](/document/)
* [ご利用中の方のお問い合わせはこちら](/support/)

* ## EC-CUBE導入をお考えの方

  + [選ばれる理由](/reason/)
  + [導入事例](/cases/)
  + [デモサイト](/demo/)
  + [機能一覧](/functions/)
  + [マニュアル](https://www.ec-cube.net/manual/ec-cube4/)
  + [ライセンス](/license/)
  + [メールマガジン登録](https://www.ec-cube.net/mail/)
  + [EC開業・運営ノウハウ](/know-how/)
* ## EC-CUBEをインストールしたい

  + [最新版ダウンロード](/download/)
  + [機能一覧](/functions/)
  + [開発情報](/developers/)
  + [レンタルサーバ](/server/)
* ## EC-CUBEをご利用中の方

  + [EC-CUBEメンバー登録](https://www.ec-cube.net/entry/)
  + [メンバーページログイン](https://www.ec-cube.net/mypage/login.php)
  + [オーナーズストア](https://www.ec-cube.net/owners/)
  + [セキュリティ対策](/security/)
  + [開発コミュニティ](https://xoops.ec-cube.net/)
* ## お問い合わせ

  + [サポート](/support/)
  + [よくあるご質問](https://support.ec-cube.net/hc/ja)
  + [お問い合わせ](https://www.ec-cube.net/contact/)
  + [ec-cube.coに関するお問い合わせ](https://www.ec-cube.net/product/co/support.php)
* ## ニュース・イベント

  + [ニュースリリース](https://www.ec-cube.net/newsrelease/)
  + [イベント](https://www.ec-cube.net/event/)
  + [X（旧Twitter）](https://x.com/EC_CUBE)
  + [Facebook](https://www.facebook.com/eccube/)
* ## パートナーについて

  + [パートナー登録（無料）](https://www.ec-cube.net/entry/partner.php)
  + [パートナーページログイン](https://www.ec-cube.net/partnerpage/login.php)
  + [パートナー制度のご案内](https://www.ec-cube.net/partnerpage/top.php)
  + [インテグレートパートナー 一覧](https://www.ec-cube.net/integrate/partner/)
  + [エバンジェリスト紹介](/evangelist/)
  + [EC-CUBEのロゴ](/brand-assets/)
* ## 決済サービス

  + [決済サービス一覧](/alliance/)
  + [EC-CUBEペイメントPlus](/lp/payment/)
  + [EC-CUBEペイメントPlus・BtoB向けプラン](/lp/epsilon-btob/)
  + [Amazon Pay](https://www.ec-cube.net/products/detail.php?product_id=2490)
* ## その他サービス

  + [基幹システム](/lp/core-system/)
  + [物流サービス一覧](/logistics/)
  + [サイトマップ](/sitemap/)

## [EC-CUBE®](/)

* [X](https://x.com/EC_CUBE)
* [Facebook](https://www.facebook.com/eccube/)
* [Wantedly](https://www.wantedly.com/companies/ec-cube)

* [個人情報の取扱いについて](/policy/)
* [個人情報保護方針](/policy/privacy/)
* [Cookieによる情報収集について](/policy/cookie/)
* [外的環境の把握](/policy/foreign-corporation/)
* [情報セキュリティ方針](/policy/security-policy/)

* [サイトマップ](/sitemap/)
* [運営会社](https://www.ec-cube.co.jp/)

© EC-CUBE CO.,LTD.

![](https://www.facebook.com/tr?id=736682659717992&ev=NoScript)



=== Content from jvn.jp_79e9e4d4_20250125_031013.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2013/08/30  Last Updated:2013/08/30
# JVN#15973066 EC-CUBE vulnerable to directory traversal when used in Windows

## Overview

EC-CUBE contains a directory traversal vulnerability when used in Windows.

## Products Affected

Versions listed below are vulnerable when used in Windows.

* EC-CUBE 2.12.0
* EC-CUBE 2.12.1
* EC-CUBE 2.12.2
* EC-CUBE 2.12.3
* EC-CUBE 2.12.3en
* EC-CUBE 2.12.3enP1
* EC-CUBE 2.12.3enP2
* EC-CUBE 2.12.4
* EC-CUBE 2.12.4en
* EC-CUBE 2.12.5
* EC-CUBE 2.12.5en

## Description

EC-CUBE from LOCKON CO.,LTD. is an open source system for creating shopping websites. EC-CUBE contains a directory traversal vulnerability when used in Windows.

## Impact

A remote attacker may obtain arbitrary files on the server.

## Solution

**Apply the update or patch**
Apply the update or patch according to the information provided by the developer.

## Vendor Status

| Vendor | Link |
| --- | --- |
| LOCKON CO.,LTD. | [Directory traversal vulnerability when used in Windows](http://www.ec-cube.net/info/weakness/weakness.php?id=50) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

**Analyzed on 2013.08.30**

| Measures | Conditions | Severity |
| Access Required | can be attacked over the Internet using packets | * High |
| Authentication | anonymous or no authentication (IP addresses do not count) | * High |
| User Interaction Required | the vulnerability can be exploited without an honest user taking any action | * High |
| Exploit Complexity | some expertise and/or luck required (most buffer overflows, guessing correctly in small space, expertise in Windows function calls) | * Mid-High |

[Description of each analysis measures](http://jvn.jp/en/nav/jvnhelp.html#analysys)

## Credit

Gen Sato reported this vulnerability to IPA.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2013-4702](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-4702) |
| JVN iPedia | [JVNDB-2013-000081](http://jvndb.jvn.jp/jvndb/JVNDB-2013-000081) |

* JVN
* HOME
* What is JVN ?
* Instructions
* List of Vulnerability Report
* [VN\_JP](http://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](http://jvn.jp/en/adj/index.html)
* [VN\_VU](http://jvn.jp/en/vu/index.html)
* [TA](http://jvn.jp/en/ta/index.html)
* TRnotes
* JVN iPedia
* MyJVN
* JVNJS/RSS
* Vendor List
* List of unreachable developers
* Contact

Copyright (c) 2000-2013 JPCERT/CC and IPA. All rights reserved.



=== Content from svn.ec-cube.net_adc12684_20250125_031019.html ===

[![EC-CUBE](/open_trac/raw-attachment/wiki/WikiStart/trac.jpg)](http://svn.ec-cube.net/open_trac/)

Search:

* [Login](/open_trac/login)
* [Help/Guide](/open_trac/wiki/TracGuide)
* [About Trac](/open_trac/about)
* [Preferences](/open_trac/prefs)

* [Wiki](/open_trac/wiki)
* [Browse Source](/open_trac/browser)
* [View Tickets](/open_trac/report)
* [Search](/open_trac/search)
* [Timeline](/open_trac/timeline)
* [Roadmap](/open_trac/roadmap)

## Context Navigation

* ← [Previous Changeset](/open_trac/changeset/22890 "Changeset 22890")
* [Next Changeset](/open_trac/changeset/22892 "Changeset 22892") →

---

# Changeset 22891

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
2013/06/25 15:11:17
([12 years](/open_trac/timeline?from=2013-06-25T15%3A11%3A17%2B09%3A00&precision=second "2013-06-25T15:11:17+09:00 in Timeline") ago)

Author:
m\_uehara
Message:

[#2277](/open_trac/ticket/2277 "バグ指摘: エラーチェックのチェック処理の見直し (closed: 修正済)") 入力チェック処理修正

Location:
[branches/version-2\_12-dev/data/class](/open_trac/browser/branches/version-2_12-dev/data/class?rev=22891)
Files:

2 edited

* [SC\_CheckError.php](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22891 "Show entry in browser")
  (modified)
  ([9 diffs](#file0 "Show differences"))
* [SC\_FormParam.php](/open_trac/browser/branches/version-2_12-dev/data/class/SC_FormParam.php?rev=22891 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [branches/version-2\_12-dev/data/class/SC\_CheckError.php](/open_trac/changeset/22891/branches/version-2_12-dev/data/class/SC_CheckError.php "Show the changeset 22891 restricted to branches/version-2_12-dev/data/class/SC_CheckError.php")

  | [r22876](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22876#L104 "Show revision 22876 of this file in browser") | [r22891](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22891#L104 "Show revision 22891 of this file in browser") |  |
  | --- | --- | --- |
  | 104 | 104 | return; |
  | 105 | 105 | } |
  | 106 |  | $this->createParam($value); |
  |  | 106 | // $this->createParam($value); |
  | 107 | 107 | if (strlen($this->arrParam[$value[0]]) == 0) { |
  | 108 | 108 | $this->arrErr[$value[0]] = '※ ' . $value[0] . 'が入力されていません。<br />'; |
  | […](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22876#L183) | […](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22891#L183) |  |
  | 183 | 183 | return; |
  | 184 | 184 | } |
  | 185 |  | $this->createParam($value); |
  |  | 185 | // $this->createParam($value); |
  | 186 | 186 | // 文字数の取得 |
  | 187 | 187 | if ($this->arrParam[$value[2]] !== $this->arrParam[$value[3]]) { |
  | […](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22876#L201) | […](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22891#L201) |  |
  | 201 | 201 | return; |
  | 202 | 202 | } |
  | 203 |  | $this->createParam($value); |
  |  | 203 | // $this->createParam($value); |
  | 204 | 204 | // 文字数の取得 |
  | 205 | 205 | if ($this->arrParam[$value[2]] == $this->arrParam[$value[3]]) { |
  | […](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22876#L219) | […](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22891#L219) |  |
  | 219 | 219 | return; |
  | 220 | 220 | } |
  | 221 |  | $this->createParam($value); |
  |  | 221 | // $this->createParam($value); |
  | 222 | 222 | // 文字数の取得 |
  | 223 | 223 | if ($this->arrParam[$value[2]] != '' && $this->arrParam[$value[3]] != '' && ($this->arrParam[$value[2]] > $this->arrParam[$value[3]])) { |
  | […](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22876#L930) | […](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22891#L930) |  |
  | 930 | 930 | return; |
  | 931 | 931 | } |
  | 932 |  | $this->createParam($value); |
  |  | 932 | // $this->createParam($value); |
  | 933 | 933 | if ((strlen($this->arrParam[$value[2]]) > 0 || strlen($this->arrParam[$value[3]]) > 0 || strlen($this->arrParam[$value[4]]) > 0) && ! checkdate($this->arrParam[$value[3]], $this->arrParam[$value[4]], $this->arrParam[$value[2]])) { |
  | 934 | 934 | $this->arrErr[$value[2]] = '※ ' . $value[0] . 'を正しく指定してください。<br />'; |
  | […](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22876#L980) | […](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22891#L980) |  |
  | 980 | 980 | return; |
  | 981 | 981 | } |
  | 982 |  | $this->createParam($value); |
  |  | 982 | // $this->createParam($value); |
  | 983 | 983 | if ((strlen($this->arrParam[$value[2]]) > 0 || strlen($this->arrParam[$value[3]]) > 0 || strlen($this->arrParam[$value[4]]) > 0 || strlen($this->arrParam[$value[5]]) > 0) && ! checkdate($this->arrParam[$value[3]], $this->arrParam[$value[4]], $this->arrParam[$value[2]])) { |
  | 984 | 984 | $this->arrErr[$value[2]] = '※ ' . $value[0] . 'を正しく指定してください。<br />'; |
  | […](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22876#L1023) | […](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22891#L1023) |  |
  | 1023 | 1023 | return; |
  | 1024 | 1024 | } |
  | 1025 |  | $this->createParam($value); |
  |  | 1025 | // $this->createParam($value); |
  | 1026 | 1026 | if ((strlen($this->arrParam[$value[2]]) > 0 || strlen($this->arrParam[$value[3]]) > 0) && ! checkdate($this->arrParam[$value[3]], 1, $this->arrParam[$value[2]])) { |
  | 1027 | 1027 | $this->arrErr[$value[2]] = '※ ' . $value[0] . 'を正しく指定してください。<br />'; |
  | […](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22876#L1135) | […](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22891#L1135) |  |
  | 1135 | 1135 | return; |
  | 1136 | 1136 | } |
  | 1137 |  | $this->createParam($value); |
  |  | 1137 | // $this->createParam($value); |
  | 1138 | 1138 | if ($this->evalCheck($value[1]) === false) { |
  | 1139 | 1139 | $this->arrErr[$value[0]] = '※ ' . $value[0] . ' の形式が不正です。<br />'; |
  | […](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22876#L1164) | […](/open_trac/browser/branches/version-2_12-dev/data/class/SC_CheckError.php?rev=22891#L1164) |  |
  | 1164 | 1164 | \*/ |
  | 1165 | 1165 | function createParam($value) { |
  | 1166 |  | foreach ($value as $key) { |
  | 1167 |  | if (is\_string($key) || is\_int($key)) { |
  | 1168 |  | if (!isset($this->arrParam[$key]))  $this->arrParam[$key] = ''; |
  | 1169 |  | } |
  | 1170 |  | } |
  |  | 1166 | foreach ($value as $val\_key => $key) { |
  |  | 1167 | if ($val\_key != 0 && (is\_string($key) || is\_int($key))) { |
  |  | 1168 | if (!is\_numeric($key) && preg\_match('/^[a-z0-9\_]+$/i', $key)) { |
  |  | 1169 | if (!isset($this->arrParam[$key])) $this->arrParam[$key] = ''; |
  |  | 1170 | if (strlen($this->arrParam[$key]) > 0 |
  |  | 1171 | && (preg\_match('/^[[:alnum:]\-\\_]\*[\.\/\\\\]\*\.\.(\/|\\\\)/',$this->arrParam[$key]) || !preg\_match('/\A[^\x00-\x08\x0b\x0c\x0e-\x1f\x7f]+\z/u', $this->arrParam[$key]))) |
  |  | 1172 | ) { |
  |  | 1173 | $this->arrErr[$value[1]] = '※ ' . $value[0] . 'に禁止された記号の並びまたは制御文字が入っています。<br />'; |
  |  | 1174 | } |
  |  | 1175 | } else if (preg\_match('/[^a-z0-9\_]/i', $key)) { |
  |  | 1176 | trigger\_error('', E\_USER\_ERROR); |
  |  | 1177 | } |
  |  | 1178 | } |
  |  | 1179 | } |
  | 1171 | 1180 | } |
  | 1172 | 1181 |  |
* ## [branches/version-2\_12-dev/data/class/SC\_FormParam.php](/open_trac/changeset/22891/branches/version-2_12-dev/data/class/SC_FormParam.php "Show the changeset 22891 restricted to branches/version-2_12-dev/data/class/SC_FormParam.php")

  | [r22796](/open_trac/browser/branches/version-2_12-dev/data/class/SC_FormParam.php?rev=22796#L277 "Show revision 22796 of this file in browser") | [r22891](/open_trac/browser/branches/version-2_12-dev/data/class/SC_FormParam.php?rev=22891#L277 "Show revision 22891 of this file in browser") |  |
  | --- | --- | --- |
  | 277 | 277 | } |
  | 278 | 278 | } else { |
  | 279 |  | $objErr = new SC\_CheckError\_Ex(array(~~0~~ => $value)); |
  | 280 |  | $objErr->doFunc(array($disp\_name, ~~0~~, $length), array($func)); |
  |  | 279 | $objErr = new SC\_CheckError\_Ex(array(($error\_last\_key ? $error\_last\_key : $error\_key) => $value)); |
  |  | 280 | $objErr->doFunc(array($disp\_name, ($error\_last\_key ? $error\_last\_key : $error\_key), $length), array($func)); |
  | 281 | 281 | if (!SC\_Utils\_Ex::isBlank($objErr->arrErr)) { |
  | 282 | 282 | foreach ($objErr->arrErr as $message) { |

**Note:** See [TracChangeset](/open_trac/wiki/TracChangeset)
for help on using the changeset viewer.

### Download in other formats:

* [Unified Diff](?format=diff&new=22891)
* [Zip Archive](?format=zip&new=22891)

---

[![Trac Powered](/open_trac_common/htdocs/common/trac_logo_mini.png)](http://trac.edgewall.org/)

Powered by [**Trac 0.12.ja1**](/open_trac/about)

By [Edgewall Software](http://www.edgewall.org/).

Re-distributed by [インタアクト株式会社](http://www.i-act.co.jp/)

Visit the Trac open source project at
<http://trac.edgewall.org/>



=== Content from www.ec-cube.net_17d7292d_20250125_031020.html ===


| | 1件の脆弱性に関しまして(2013年8月29日) | | --- |  |  | | EC-CUBE 脆弱性に関するお知らせ | | いつもEC-CUBEをご利用いただきまして、誠にありがとうございます。  Windowsサーバー環境下で動作している**EC-CUBE（2.12系）**に1件の脆弱性があることが判明いたしました。 （本脆弱性における被害報告は現在ございません。）  脆弱性そのものは該当ファイルのソースコード修正、またはファイルの上書きにより、すぐに解決するものです。  皆様にはお手数おかけしまして誠に申し訳ございませんが、対策を早急に講じていただきますよう、どうかよろしくお願い申し上げます。 | |  | | 修正方法につきまして | | 1.修正ファイルをダウンロードしてください。  ・ [修正ファイル](./eccube212x_update_files.zip)   md5：d7cd382da6b18af94289c1693cb06dc7 2.修正する該当ファイル、もしくはEC-CUBEファイル全体のバックアップをとってください。 3.ダウンロードしたファイルを解凍し、該当ファイルを既存ファイルへ上書きしてください。   ※ディレクトリ付きファイルですので、ルートディレクトリからそのままファイルの上書きが可能です。   （EC-CUBEデフォルトのディレクトリ構造以外で使用されている場合、ファイルの上書きができない可能性がございますのでご注意ください）   ※既存ファイルをカスタマイズしている場合、以下個別の修正方法をご参考に修正をお願いします。  4.動作確認をしてください。 以上となります。 開発環境がある場合は、まず開発環境でお試しください。 | |  |  | | 本不具合に対する対応方法 | | --- | | ```  ----------------------------------------------------------------------------------------------------------------- ■不具合が存在する環境 -----------------------------------------------------------------------------------------------------------------  [【危険度：高】Windowsサーバー環境における、ディレクトリトラバーサルの脆弱性](#01)  ▼対象環境    Windowsサーバーを利用している環境  ▼対象バージョン  - EC-CUBE　2.12.0  - EC-CUBE　2.12.1  - EC-CUBE　2.12.2  - EC-CUBE　2.12.3  - EC-CUBE　2.12.3en  - EC-CUBE　2.12.3enP1  - EC-CUBE　2.12.3enP2  - EC-CUBE　2.12.4  - EC-CUBE　2.12.4en  - EC-CUBE  2.12.5  - EC-CUBE  2.12.5en  ``` ```  ----------------------------------------------------------------------------------------------------------------- ■個別の脆弱性情報に関しまして -----------------------------------------------------------------------------------------------------------------  ``` ```  以下、個別の脆弱性情報を記載いたします。 該当ファイルをカスタマイズしている場合は以下をご参考いだだき個別で修正をお願いいたします。  /data/class/api/SC_Api_Operation.php::doApiAction  ※行数はバージョン・カスタマイズの内容によって異なりますので、ご注意下さい。  ``` | |  | |  | | ```  ================================================================================================================= ▼Windowsサーバー環境における、ディレクトリトラバーサルの脆弱性 ----------------------------------------------------------------------------------------------------------------- 【危険度】 高  【修正方法について】 data/class/api/SC_Api_Operation.php::doApiAction に以下の変更を加えます。  【修正後の確認方法について】 API機能が正常に動作する事をご確認ください。  ▽SC_Api_Operation.php 303行目付近 -------------------------------------------------------------------  変更前 ------------------------------------------------------------------- $objFormParam->convParam();  $arrErr = $objFormParam->checkError(); if (SC_Utils_Ex::isBlank($arrErr)) { -------------------------------------------------------------------  -------------------------------------------------------------------  変更後 ------------------------------------------------------------------- $objFormParam->convParam();  $arrErr = SC_Api_Operation_Ex::checkParam($objFormParam); if (SC_Utils_Ex::isBlank($arrErr)) { =================================================================================================================  ▽SC_Api_Operation.php 関数追加 -----------------------------------------------------------------------------------------------------------------  追加 ----------------------------------------------------------------------------------------------------------------- /**  * APIのリクエスト基本パラメーターのチェック  *  * @param object $objFormParam  * @return array $arrErr  */ protected function checkParam($objFormParam) {     $arrErr = $objFormParam->checkError();     if (!preg_match("/^[a-zA-Z0-9\-\_]+$/", $objFormParam->getValue('Operation')) && !SC_Utils::isBlank($objFormParam->getValue('Operation'))) {         $arrErr['ECCUBE.Operation.ParamError'] = 'Operationの値が不正です。';     }     if (!preg_match("/^[a-zA-Z0-9\-\_]+$/", $objFormParam->getValue('Service')) && !SC_Utils::isBlank($objFormParam->getValue('Service'))) {         $arrErr['ECCUBE.Service.ParamError'] = 'Serviceの値が不正です。';     }     if (!preg_match("/^[a-zA-Z0-9\-\_]+$/", $objFormParam->getValue('Style')) && !SC_Utils::isBlank($objFormParam->getValue('Style'))) {         $arrErr['ECCUBE.Style.ParamError'] = 'Styleの値が不正です。';     }     if (!preg_match("/^[a-zA-Z0-9\-\_]+$/", $objFormParam->getValue('Validate')) && !SC_Utils::isBlank($objFormParam->getValue('Validate'))) {         $arrErr['ECCUBE.Validate.ParamError'] = 'Validateの値が不正です。';     }     if (!preg_match("/^[a-zA-Z0-9\-\_\.]+$/", $objFormParam->getValue('Version')) && !SC_Utils::isBlank($objFormParam->getValue('Version'))) {         $arrErr['ECCUBE.Version.ParamError'] = 'Versionの値が不正です。';     }     return $arrErr; } =================================================================================================================  ``` | | | --- | --- | --- | --- | --- | --- |  |  | | --- |  |  | | --- | | FAQ | | **Q. 私のサイトは大丈夫か？** A. まずは対象環境・対象バージョンをお確かめください。 Windowsサーバー環境にて脆弱性対象バージョンのEC-CUBEをお使いの場合、対象ファイルを確認下さい。 修正がされていない場合、修正方法に沿って修正の対応をお願い致します。 [オフィシャルホスティングパートナー](http://www.ec-cube.net/partner/search.php)をご利用の場合・[インテグレートパートナー](http://www.ec-cube.net/integrate/partner/place.php)が構築した場合、既に対策されている場合がございます。  この度は、お手数をおかけいたしますことを深くお詫び申し上げます。 |  |  | | --- | | 謝辞 | | 本情報は、EC-CUBEオフィシャルサイトへお問い合わせ頂きました開発者さまよりご提供頂きました。この場をお借りして、厚く御礼申し上げます。 | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |


