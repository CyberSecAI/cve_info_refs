=== Content from launchpad.net_3c411298_20250126_130739.html ===

[Log in / Register](https://launchpad.net/~cyberang3l/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~cyberang3l)

## [Vangelis Tasoulas](https://launchpad.net/~cyberang3l)

* Overview
* [Code](https://code.launchpad.net/~cyberang3l)
* [Bugs](https://bugs.launchpad.net/~cyberang3l)
* [Blueprints](https://blueprints.launchpad.net/~cyberang3l)
* [Translations](https://translations.launchpad.net/~cyberang3l)
* [Answers](https://answers.launchpad.net/~cyberang3l)

* [Related packages](https://launchpad.net/~cyberang3l/%2Brelated-packages)
* [Related projects](https://launchpad.net/~cyberang3l/%2Brelated-projects)

## User information

Launchpad Id:
cyberang3l

Email:
[Log in](%2Blogin) for email information.

Member since:
2005-10-04

[![Icon of Kubuntu Testers](https://launchpadlibrarian.net/6610937/kubuntu-testers-small.png "Member of Kubuntu Testers")](/~kubuntu-testers)
[![Icon of Kubuntu Users](https://launchpadlibrarian.net/44410180/kubuntu-circle-small.png "Member of Kubuntu Users")](/~kubuntu-users)
[![Icon of Nova](https://launchpadlibrarian.net/52560219/os14.png "Member of Nova")](/~nova)
[![Icon of OpenStack Team](https://launchpadlibrarian.net/52313052/os14.png "Member of OpenStack Team")](/~openstack)
[![Icon of Ubuntu Photographers](https://launchpadlibrarian.net/17657022/camera-photo.png "Member of Ubuntu Photographers")](/~ubuntu-photographers)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English, Greek

OpenPGP keys:

DFD13EC46ADDA93B67251F7316E6E1DB52D8B4AF

Time zone:

UTC
(UTC+0000)

Karma:
[0](https://launchpad.net/~cyberang3l/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

## [All memberships](https://launchpad.net/~cyberang3l/%2Bparticipation) Latest memberships

| [Ubuntu Wiki Editors](/~ubuntu-wiki-editors)  Joined on 2016-09-21 | |
| --- | --- |
| [Neutron Developers](/~neutron)  Joined on 2013-06-12 | |
| [Horizon Developers](/~horizon)  Joined on 2013-06-12 | |
| [Cinder](/~cinder)  Joined on 2013-06-12 | |
| [Nova](/~nova)  Joined on 2013-06-12 | |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_6c3b298b_20250126_130743.html ===

[Log in / Register](https://bugs.launchpad.net/nova/%2Bbug/1202266/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* [Translations](https://translations.launchpad.net/nova)
* [Answers](https://answers.launchpad.net/nova)

# [OSSA 2013-030] xenapi: secgroups are not in place after live-migration (CVE-2013-4497)

Bug #1202266 reported by
[Vangelis Tasoulas](https://launchpad.net/~cyberang3l)
on 2013-07-17

[272](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Compute (nova)](https://bugs.launchpad.net/nova) | Fix Released | High | [John Garbutt](https://launchpad.net/~johngarbutt) | [OpenStack Compute (nova) 2013.2 "havana"](https://launchpad.net/nova/%2Bmilestone/2013.2) |
|  | [Grizzly](https://bugs.launchpad.net/nova/grizzly) | Fix Released | High | [John Garbutt](https://launchpad.net/~johngarbutt) | [OpenStack Compute (nova) 2013.1.5](https://launchpad.net/nova/%2Bmilestone/2013.1.5) |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | High | [Jeremy Stanley](https://launchpad.net/~fungi) |  |

### Bug Description

Distributed Setup with:

2x Compute nodes with Debian Wheezy + XCP installed from repositories (Kronos). The VM controlling XCP is installed on Ubuntu Precise.

1x Controller node with Keystone and Nova (except Network and Compute) on Ubuntu Precise with OpenStack Grizzly installed from cloud archive.

1x Network node running Nova network with FlatDHCP (no quantum is used because it is not supported for XCP yet - I think it will starting with Havana release). The network node has 3 interfaces. 1x Public, 1x Management, 1x Tenant.

1x Storage node running Cinder, Glance and NFSv3 for shared storage to support live migration

I experiment with XCP and live migration these days so after I configured everything else, I tried to configure floating IP addresses as well. The configuration of the floating IP's was trivial but when I booted a VM, I instantly migrated it (that's what I am mostly testing) and then assigned a floating IP. Then I tried to ping it and connect to it using ssh and everything worked fine.

I boot a second VM and this time I do not migrate it. I assign a floating IP address and no ping or ssh connection is possible to be made on this one even though the iptables have been setup correctly (the SNAT and DNAT). I migrate the VM and then I can connect to it using SSH without any problems.

In the beginning I thought it is a bug and for some reason when you boot even though you should be able to connect, you cannot. After looking in the documentation I found this: <http://docs.openstack.org/essex/openstack-compute/admin/content/configuring-openstack-compute-basics.html#enabling-access-to-vms-on-the-compute-node>

What I understood from this is that it is the other way around and I should NOT be able to ping or connect to the VMs using SSH by default if I don't explicitly add the secgroup rules to allow such actions.

After adding these two rules everything works fine (I can access any vm, migrated or non-migrated):

$ nova secgroup-add-rule default icmp -1 -1 0.0.0.0/0

$ nova secgroup-add-rule default tcp 22 22 0.0.0.0/0

After removing them again, I cannot access the non-migrated VM's (correct) but I can still access those that they were migrated once.

Even when I migrate them back to the hypervisor originally booted on, the secgroups still do not apply and I can access those VM's.

Tags:

[xenserver](/nova/%2Bbugs?field.tag=xenserver)

## CVE References

* [2013-4497](/bugs/cve/2013-4497 "The XenAPI backend in OpenStack Compu...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-07-18: |  |  | [#1](/nova/%2Bbug/1202266/comments/1) |
| --- | --- | --- | --- |

Adding Nova PTL for sanity check

Adding Nova PTL for sanity check

| Changed in ossa: | |
| --- | --- |
| **status**: | New → Incomplete |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Vangelis Tasoulas (cyberang3l)](https://launchpad.net/~cyberang3l) wrote on 2013-07-18: |  |  | [#2](/nova/%2Bbug/1202266/comments/2) |
| --- | --- | --- | --- |

Just to mention as well that I am using XenAPI pools and shared storage for the live migrations as described here: <http://docs.openstack.org/trunk/openstack-compute/admin/content/configuring-migrations.html#configuring-migrations-xenserver-shared-storage>

More information on my setup here:

[https://answers.launchpad.net/nova/+question/232484](https://answers.launchpad.net/nova/%2Bquestion/232484)

Just to mention as well that I am using XenAPI pools and shared storage for the live migrations as described here: http://docs.openstack.org/trunk/openstack-compute/admin/content/configuring-migrations.html#configuring-migrations-xenserver-shared-storage
More information on my setup here:
https://answers.launchpad.net/nova/+question/232484

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Russell Bryant (russellb)](https://launchpad.net/~russellb) wrote on 2013-07-18: |  |  | [#3](/nova/%2Bbug/1202266/comments/3) |
| --- | --- | --- | --- |

I think the first thing I'd like to do here is try to replicate this behavior on another setup. I'm adding John Garbutt, nova-core and xenapi driver expert, to this bug to see if he can help try this out.

I think the first thing I'd like to do here is try to replicate this behavior on another setup. I'm adding John Garbutt, nova-core and xenapi driver expert, to this bug to see if he can help try this out.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-07-18: |  |  | [#4](/nova/%2Bbug/1202266/comments/4) |
| --- | --- | --- | --- |

I thought this sounded familiar:

[https://bugs.launchpad.net/nova/+bug/1073306](https://bugs.launchpad.net/nova/%2Bbug/1073306)

But I agree, this is a security issue, for those using Security Groups.

I thought this sounded familiar:
https://bugs.launchpad.net/nova/+bug/1073306
But I agree, this is a security issue, for those using Security Groups.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-07-18: |  |  | [#5](/nova/%2Bbug/1202266/comments/5) |
| --- | --- | --- | --- |

On re-reading, this might be a new case.

The old bug covers migration not live-migration. But its likely the cause.

On re-reading, this might be a new case.
The old bug covers migration not live-migration. But its likely the cause.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-07-19: |  |  | [#6](/nova/%2Bbug/1202266/comments/6) |
| --- | --- | --- | --- |

So this is Xen-specific ?

I think it would qualify as a vulnerability because people would expect port filtering (at least default DROP/REJECT rules) to be reapplied ?

So this is Xen-specific ?
I think it would qualify as a vulnerability because people would expect port filtering (at least default DROP/REJECT rules) to be reapplied ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-07-24: |  |  | [#7](/nova/%2Bbug/1202266/comments/7) |
| --- | --- | --- | --- |

Sorry, lost the email notification, but this is XenServer specific, its in the XenAPI driver code.

There is quite a bit of work to fix up this feature around:

\* resize, migrate, live-migrate

Basically, the security groups is currently totally untested, in many respects. However, I don't think this has really been communicated at all well (if at all).

There are deeper issues here too, because the feature was written for linux bridge, but XenServer now uses OVS by default, so the iptables rules are not good enough. Will need some digging around neutron vs nova here too. I know BobBall at Citrix was talking a look at the above deeper issues, its probably worth brining him in here.

Sorry, lost the email notification, but this is XenServer specific, its in the XenAPI driver code.
There is quite a bit of work to fix up this feature around:
\* resize, migrate, live-migrate
Basically, the security groups is currently totally untested, in many respects. However, I don't think this has really been communicated at all well (if at all).
There are deeper issues here too, because the feature was written for linux bridge, but XenServer now uses OVS by default, so the iptables rules are not good enough. Will need some digging around neutron vs nova here too. I know BobBall at Citrix was talking a look at the above deeper issues, its probably worth brining him in here.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-07-24: |  |  | [#8](/nova/%2Bbug/1202266/comments/8) |
| --- | --- | --- | --- |

Just to confirm, my code inspection confirms that this bug happens with XenAPI.

I have not checked if this bug is present in any other drivers.

I am also, not sure we have tests for this in tempest, as I heard XenAPI is very close to passing full tempest (on volume related test currently failing).

Just to confirm, my code inspection confirms that this bug happens with XenAPI.
I have not checked if this bug is present in any other drivers.
I am also, not sure we have tests for this in tempest, as I heard XenAPI is very close to passing full tempest (on volume related test currently failing).

[Russell Bryant (russellb)](https://launchpad.net/~russellb)
on 2013-07-26

| **tags**: | added: xenserver |
| --- | --- |

[John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt)
on 2013-07-29

| Changed in nova: | |
| --- | --- |
| **importance**: | Undecided → High |
| **status**: | New → Confirmed |
| **summary**: | - Secgroups are not in place after migration!+ xenapi: secgroups are not in place after live-migration |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-07-29:  [**Re: xenapi: secgroups are not in place after live-migration**](/nova/%2Bbug/1202266/comments/9) |  |  | [#9](/nova/%2Bbug/1202266/comments/9) |
| --- | --- | --- | --- |

My take is that we'll need to issue an OSSA on this one.

My take is that we'll need to issue an OSSA on this one.

| Changed in ossa: | |
| --- | --- |
| **status**: | Incomplete → Confirmed |
| **importance**: | Undecided → High |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Michael Still (mikal)](https://launchpad.net/~mikal) wrote on 2013-07-29: |  |  | [#10](/nova/%2Bbug/1202266/comments/10) |
| --- | --- | --- | --- |

@Gabe -- do you have a resource who might be able to help out with this one?

@Gabe -- do you have a resource who might be able to help out with this one?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Dietz (cerberus)](https://launchpad.net/~cerberus) wrote on 2013-07-29: |  |  | [#11](/nova/%2Bbug/1202266/comments/11) |
| --- | --- | --- | --- |

John: so in essence, we're talking about applying new flows once the VM has moved to the destination, correct?

As you point out, OVS is the default behavior here, and to my knowledge, no real implementation exists for applying OVS flows today. The implementation in Neutron (last I checked) was only a basic OVS pass, and actually utilized IPTables rules in addition. OVS was there more as a proof of concept than actual useful implementation. Ensuring that resize et al also attempt to apply security groups is insufficient since there's nothing (again, to the best of my knowledge) capable of applying those flows.

John: so in essence, we're talking about applying new flows once the VM has moved to the destination, correct?
As you point out, OVS is the default behavior here, and to my knowledge, no real implementation exists for applying OVS flows today. The implementation in Neutron (last I checked) was only a basic OVS pass, and actually utilized IPTables rules in addition. OVS was there more as a proof of concept than actual useful implementation. Ensuring that resize et al also attempt to apply security groups is insufficient since there's nothing (again, to the best of my knowledge) capable of applying those flows.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-07-30: |  |  | [#12](/nova/%2Bbug/1202266/comments/12) |
| --- | --- | --- | --- |

So, not sure the best way to fix this stuff, advice needed.

I almost want to say we should just issue an advisory to clarify the state of the security groups feature as "experimental" with more work required before it is production ready, and the work around is not to rely on security groups. But that doesn't feel like the right response. However a proper fix will require this feature to (effectively) be implemented.

So lets try summarize the issues:

\* nova has missing calls to the firewall driver (there are open public bugs on this one, and there are fixes in progress, in the public, which is probably bad) - I am happy to look into getting this fixed, but do we need to backport these? Will need a networking expert to check the fixes.

\* the firewall driver in nova doesn't work with OVS - I could do with a hand fixing that

\* I don't know the state of the various neutron drivers and how they interact, we don't yet have the equivalent VIF drivers for XenAPI, but that might not matter - again, not something I really know how to fix

\* MAC and IP address spoofing should also be checked

Going into the firewall driver issues, it was written when XenServer used bridge networking, back in 5.6. The OVS case has always been avoided, because until recently, the version of OVS shipping with XenServer (apparently) did not have the bit masking operation that would allow you to avoid some of the worst bits of rule explosion in the number of rules. You need to take care, because there is a massive OVS slowdown once the rules don't fit in your processors L2/L3 cache, or something like that, which would give users a sort of DoS attach on the other VMs the host their VM is present.

So, not sure the best way to fix this stuff, advice needed.
I almost want to say we should just issue an advisory to clarify the state of the security groups feature as "experimental" with more work required before it is production ready, and the work around is not to rely on security groups. But that doesn't feel like the right response. However a proper fix will require this feature to (effectively) be implemented.
So lets try summarize the issues:
\* nova has missing calls to the firewall driver (there are open public bugs on this one, and there are fixes in progress, in the public, which is probably bad) - I am happy to look into getting this fixed, but do we need to backport these? Will need a networking expert to check the fixes.
\* the firewall driver in nova doesn't work with OVS - I could do with a hand fixing that
\* I don't know the state of the various neutron drivers and how they interact, we don't yet have the equivalent VIF drivers for XenAPI, but that might not matter - again, not something I really know how to fix
\* MAC and IP address spoofing should also be checked
Going into the firewall driver issues, it was written when XenServer used bridge networking, back in 5.6. The OVS case has always been avoided, because until recently, the version of OVS shipping with XenServer (apparently) did not have the bit masking operation that would allow you to avoid some of the worst bits of rule explosion in the number of rules. You need to take care, because there is a massive OVS slowdown once the rules don't fit in your processors L2/L3 cache, or something like that, which would give users a sort of DoS attach on the other VMs the host their VM is present.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-08-01: |  |  | [#13](/nova/%2Bbug/1202266/comments/13) |
| --- | --- | --- | --- |

@John: if "fixing" it for stable/grizzly amounts to implementing the full feature there, then I would agree that we should issue a security note about it being non-usable and move on. The issue is, it looks implemented enough so that people would trust it... in particular, security groups seem to work properly until you do a migration ?

Sitting on the fence on this one.

@John: if "fixing" it for stable/grizzly amounts to implementing the full feature there, then I would agree that we should issue a security note about it being non-usable and move on. The issue is, it looks implemented enough so that people would trust it... in particular, security groups seem to work properly until you do a migration ?
Sitting on the fence on this one.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-08-08: |  |  | [#14](/nova/%2Bbug/1202266/comments/14) |
| --- | --- | --- | --- |

@John: what would it take to plug the security hole (people run with security groups and they kinda work, migrate and expect them to be restored but poof they are gone) ? We don't necessarily need to fix all security group bugs :)

@John: what would it take to plug the security hole (people run with security groups and they kinda work, migrate and expect them to be restored but poof they are gone) ? We don't necessarily need to fix all security group bugs :)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-08-20: |  |  | [#15](/nova/%2Bbug/1202266/comments/15) |
| --- | --- | --- | --- |

@Thierry, sorry for the delay, screwed up my email filters, and just back from holiday.

I agree, its probably best to fix this up.

Not sure of the best way to phase this, but it would be good to alert people to the fact this

A quick fix for non-live migration is probably just a cut and paste of this code:

<https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L444>

<https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L462>

And put it either side of the boot command here (for migration):

<https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L311>

In terms of the public bug, around migration not setting up security groups, you can see my attempt at a "proper" fix here:

<https://review.openstack.org/#/c/38455/>

I am not really sure how to fix it for live-migration, need someone with more neutron skills than me really.

The problem is the VM domain and networking is created on the destination by XenAPI, auto-magically, in a single live-migrate operation:

<https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L1881>

We could add a "post\_live\_migration\_at\_destination", that does the firewall setup, but that would be after the VM has become active on the destination, so there is likely to be a small period when the traffic is not filtered, unless we can some how block all the traffic during that time (which I think might happen when you have an OVS controller present, but I am not sure). The missing code that would go in post\_live\_migration, must be something like this:

<https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L444>

<https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L462>

In libvirt, I think the VIFs are plugged before the live-migrate happens, so its covered by this method call:

<https://github.com/openstack/nova/blob/master/nova/compute/manager.py#L3794>

XenAPI has a rather dodgy implementation of that:

<https://github.com/openstack/nova/blob/master/nova/virt/xenapi/driver.py#L418>

I see familar code in the libvirt driver, but I don't think that will work when the VIFs have not been created, and the VIFs are not created in time:

<https://github.com/openstack/nova/blob/master/nova/virt/libvirt/driver.py#L3332>

As far as getting a networking guru, I know Salvatore Orlando worked on this first implementation of these bits, maybe he would be a good person to cast his eye across the above ideas. But there might be someone on the security team who can help out, not sure who is on the list.

@Thierry, sorry for the delay, screwed up my email filters, and just back from holiday.
I agree, its probably best to fix this up.
Not sure of the best way to phase this, but it would be good to alert people to the fact this
A quick fix for non-live migration is probably just a cut and paste of this code:
https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L444
https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L462
And put it either side of the boot command here (for migration):
https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L311
In terms of the public bug, around migration not setting up security groups, you can see my attempt at a "proper" fix here:
https://review.openstack.org/#/c/38455/
I am not really sure how to fix it for live-migration, need someone with more neutron skills than me really.
The problem is the VM domain and networking is created on the destination by XenAPI, auto-magically, in a single live-migrate operation:
https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L1881
We could add a "post\_live\_migration\_at\_destination", that does the firewall setup, but that would be after the VM has become active on the destination, so there is likely to be a small period when the traffic is not filtered, unless we can some how block all the traffic during that time (which I think might happen when you have an OVS controller present, but I am not sure). The missing code that would go in post\_live\_migration, must be something like this:
https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L444
https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L462
In libvirt, I think the VIFs are plugged before the live-migrate happens, so its covered by this method call:
https://github.com/openstack/nova/blob/master/nova/compute/manager.py#L3794
XenAPI has a rather dodgy implementation of that:
https://github.com/openstack/nova/blob/master/nova/virt/xenapi/driver.py#L418
I see familar code in the libvirt driver, but I don't think that will work when the VIFs have not been created, and the VIFs are not created in time:
https://github.com/openstack/nova/blob/master/nova/virt/libvirt/driver.py#L3332
As far as getting a networking guru, I know Salvatore Orlando worked on this first implementation of these bits, maybe he would be a good person to cast his eye across the above ideas. But there might be someone on the security team who can help out, not sure who is on the list.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-08-20: |  |  | [#16](/nova/%2Bbug/1202266/comments/16) |
| --- | --- | --- | --- |

I see no point in keeping this private, since the live migration case is mentioned on the public bug. Unless someone complains, I'll open this up, which should facilitate the fixing, since this is actually non-trivial.

I see no point in keeping this private, since the live migration case is mentioned on the public bug. Unless someone complains, I'll open this up, which should facilitate the fixing, since this is actually non-trivial.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-08-20: |  |  | [#17](/nova/%2Bbug/1202266/comments/17) |
| --- | --- | --- | --- |

CCing Salvatore: we might need your help around here.

CCing Salvatore: we might need your help around here.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-08-20: |  |  | [#18](/nova/%2Bbug/1202266/comments/18) |
| --- | --- | --- | --- |

Agreed, with [bug 1073306](/bugs/1073306) already mentioning that xenapi migrations don't apply security group filters and that it also affects live migration, this is now public knowledge. Opening it up the discussion to the wider developer community will hopefully also get us a fix sooner.

Agreed, with bug 1073306 already mentioning that xenapi migrations don't apply security group filters and that it also affects live migration, this is now public knowledge. Opening it up the discussion to the wider developer community will hopefully also get us a fix sooner.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-08-21: |  |  | [#19](/nova/%2Bbug/1202266/comments/19) |
| --- | --- | --- | --- |

Shall be a common OSSA with 1073306

Shall be a common OSSA with 1073306

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Bob Ball (bob-ball)](https://launchpad.net/~bob-ball) wrote on 2013-08-21: |  |  | [#20](/nova/%2Bbug/1202266/comments/20) |
| --- | --- | --- | --- |

Potentially making this a little wider, my current understanding of the OVS is that the OVS does not call the netfilter code when it is forwarding traffic to VMs. In summary my belief is that only bridge-based systems support security groups, and if you configure a host to use libvirt and OVS (which I believe is possible?) then that would suffer from the same issue.

Agreed that there is a question about how to handle the live migration case with XAPI doing most of the work. There is a hook we can use in XAPI - but I'm not sure this is the best solution. I'd prefer to create the VM with fully blocked ports and then apply the correct security groups.

Potentially making this a little wider, my current understanding of the OVS is that the OVS does not call the netfilter code when it is forwarding traffic to VMs. In summary my belief is that only bridge-based systems support security groups, and if you configure a host to use libvirt and OVS (which I believe is possible?) then that would suffer from the same issue.
Agreed that there is a question about how to handle the live migration case with XAPI doing most of the work. There is a hook we can use in XAPI - but I'm not sure this is the best solution. I'd prefer to create the VM with fully blocked ports and then apply the correct security groups.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-08-30: |  |  | [#21](/nova/%2Bbug/1202266/comments/21) |
| --- | --- | --- | --- |

Bob, seems like a good option. Can you take on fixing the live migrate issue?

Bob, seems like a good option. Can you take on fixing the live migrate issue?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-09-09: |  |  | [#22](/nova/%2Bbug/1202266/comments/22) |
| --- | --- | --- | --- |

In response to Thierry's comment #19, I'm unsure how we'll be able to issue a common OSSA if the proposed fix for [bug 1073306](/bugs/1073306) does not address this issue. Should we hold the advisory until such time as fixes for both are ready, or do they need to diverge?

In response to Thierry's comment #19, I'm unsure how we'll be able to issue a common OSSA if the proposed fix for bug 1073306 does not address this issue. Should we hold the advisory until such time as fixes for both are ready, or do they need to diverge?

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-09-10

| Changed in nova: | |
| --- | --- |
| **milestone**: | none → havana-rc1 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-09-12: |  |  | [#23](/nova/%2Bbug/1202266/comments/23) |
| --- | --- | --- | --- |

I have a suggested partial fix for this issue.

I have split the issue to include some additional work in this bug:

[https://bugs.launchpad.net/nova/+bug/1224587](https://bugs.launchpad.net/nova/%2Bbug/1224587)

I have a suggested partial fix for this issue.
I have split the issue to include some additional work in this bug:
https://bugs.launchpad.net/nova/+bug/1224587

| Changed in nova: | |
| --- | --- |
| **assignee**: | nobody → John Garbutt (johngarbutt) |
| **status**: | Confirmed → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-09-12: |  |  | [#24](/nova/%2Bbug/1202266/comments/24) |
| --- | --- | --- | --- |

@Vangelis I would really appreciate help testing this, if you still have a setup you can check this on. The fix is still a little work in progress, but I wanted to get peoples opinions, on if this would be an acceptable way forward, in the short term.

@Vangelis I would really appreciate help testing this, if you still have a setup you can check this on. The fix is still a little work in progress, but I wanted to get peoples opinions, on if this would be an acceptable way forward, in the short term.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-09-12:  [**Fix proposed to nova (master)**](/nova/%2Bbug/1202266/comments/25) |  |  | [#25](/nova/%2Bbug/1202266/comments/25) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/46313>

Fix proposed to branch: master
Review: https://review.openstack.org/46313

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Vangelis Tasoulas (cyberang3l)](https://launchpad.net/~cyberang3l) wrote on 2013-09-12:  [**Re: xenapi: secgroups are not in place after live-migration**](/nova/%2Bbug/1202266/comments/26) |  |  | [#26](/nova/%2Bbug/1202266/comments/26) |
| --- | --- | --- | --- |

John, I still have the setup so definitely I can help on testing. I'll report back early next week as I'm away at the moment.

John, I still have the setup so definitely I can help on testing. I'll report back early next week as I'm away at the moment.

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2013-09-17

| Changed in ossa: | |
| --- | --- |
| **assignee**: | nobody → Jeremy Stanley (fungi) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-09-17: |  |  | [#27](/nova/%2Bbug/1202266/comments/27) |
| --- | --- | --- | --- |

Vangelis, did you have a chance to confirm whether John's patch above mitigates the issue on your setup?

Vangelis, did you have a chance to confirm whether John's patch above mitigates the issue on your setup?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Vangelis Tasoulas (cyberang3l)](https://launchpad.net/~cyberang3l) wrote on 2013-09-18: |  |  | [#28](/nova/%2Bbug/1202266/comments/28) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/nova/%2Bbug/1202266/comments/28/%2Bdownload) (3.6 KiB)

I just and it's not working for me.

However, I get the following error in the nova-compute.log:

2013-09-18 14:46:10.972 INFO nova.compute.manager [req-629ff9d2-fb6c-4c83-a672-e5aecd36cb20 8ca2f0ccd55f4d9ba53847755f2e0b18 10c16ce5ffb54c56925152b7d331a8d2] [instance: f521d7f2-d27f-40ff-81da-d1a25a5b69ac] Post operation of migration started

2013-09-18 14:46:12.221 ERROR nova.openstack.common.rpc.amqp [req-629ff9d2-fb6c-4c83-a672-e5aecd36cb20 8ca2f0ccd55f4d9ba53847755f2e0b18 10c16ce5ffb54c56925152b7d331a8d2] Exception during message handling

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp File "/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py", line 430, in \_process\_data

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp rval = self.proxy.dispatch(ctxt, version, method, \*\*args)

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp File "/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/dispatcher.py", line 133, in dispatch

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp return getattr(proxyobj, method)(ctxt, \*\*kwargs)

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp File "/usr/lib/python2.7/dist-packages/nova/compute/manager.py", line 3273, in post\_live\_migration\_at\_destination

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp block\_migration, block\_device\_info)

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp File "/usr/lib/python2.7/dist-packages/nova/virt/xenapi/driver.py", line 521, in post\_live\_migration\_at\_destination

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp self.\_vmops.post\_live\_migration\_at\_destination(ctxt, instance\_ref,

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp AttributeError: 'VMOps' object has no attribute 'post\_live\_migration\_at\_destination'

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp

2013-09-18 14:46:12.230 ERROR nova.openstack.common.rpc.common [req-629ff9d2-fb6c-4c83-a672-e5aecd36cb20 8ca2f0ccd55f4d9ba53847755f2e0b18 10c16ce5ffb54c56925152b7d331a8d2] Returning exception 'VMOps' object has no attribute 'post\_live\_migration\_at\_destination' to caller

2013-09-18 14:46:12.230 ERROR nova.openstack.common.rpc.common [req-629ff9d2-fb6c-4c83-a672-e5aecd36cb20 8ca2f0ccd55f4d9ba53847755f2e0b18 10c16ce5ffb54c56925152b7d331a8d2] ['Traceback (most recent call last):\n', ' File "/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py", line 430, in \_process\_data\n rval = self.proxy.dispatch(ctxt, version, method, \*\*args)\n', ' File "/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/dispatcher.py", line 133, in dispatch\n return getattr(proxyobj, method)(ctxt, \*\*kwargs)\n', ' File "/usr/lib/python2.7/dist-packages/nova/compute/manager.py", line 3273, in post\_live\_migration\_at\_destination\n block\_migration, block\_device\_info)\n', ' File "/usr/lib/python2.7/dist-packages/nova/virt/xenapi/driver.py", line 521, in post\_live\_migration\_at\_destination\n self.\_vmops.post\_live\_migration\_a...

[Read more...](/nova/%2Bbug/1202266/comments/28)

I just and it's not working for me.
However, I get the following error in the nova-compute.log:
2013-09-18 14:46:10.972 INFO nova.compute.manager [req-629ff9d2-fb6c-4c83-a672-e5aecd36cb20 8ca2f0ccd55f4d9ba53847755f2e0b18 10c16ce5ffb54c56925152b7d331a8d2] [instance: f521d7f2-d27f-40ff-81da-d1a25a5b69ac] Post operation of migration started
2013-09-18 14:46:12.221 ERROR nova.openstack.common.rpc.amqp [req-629ff9d2-fb6c-4c83-a672-e5aecd36cb20 8ca2f0ccd55f4d9ba53847755f2e0b18 10c16ce5ffb54c56925152b7d331a8d2] Exception during message handling
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp File "/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py", line 430, in \_process\_data
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp rval = self.proxy.dispatch(ctxt, version, method, \*\*args)
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp File "/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/dispatcher.py", line 133, in dispatch
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp return getattr(proxyobj, method)(ctxt, \*\*kwargs)
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp File "/usr/lib/python2.7/dist-packages/nova/compute/manager.py", line 3273, in post\_live\_migration\_at\_destination
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp block\_migration, block\_device\_info)
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp File "/usr/lib/python2.7/dist-packages/nova/virt/xenapi/driver.py", line 521, in post\_live\_migration\_at\_destination
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp self.\_vmops.post\_live\_migration\_at\_destination(ctxt, instance\_ref,
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp AttributeError: 'VMOps' object has no attribute 'post\_live\_migration\_at\_destination'
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp
2013-09-18 14:46:12.230 ERROR nova.openstack.common.rpc.common [req-629ff9d2-fb6c-4c83-a672-e5aecd36cb20 8ca2f0ccd55f4d9ba53847755f2e0b18 10c16ce5ffb54c56925152b7d331a8d2] Returning exception 'VMOps' object has no attribute 'post\_live\_migration\_at\_destination' to caller
2013-09-18 14:46:12.230 ERROR nova.openstack.common.rpc.common [req-629ff9d2-fb6c-4c83-a672-e5aecd36cb20 8ca2f0ccd55f4d9ba53847755f2e0b18 10c16ce5ffb54c56925152b7d331a8d2] ['Traceback (most recent call last):\n', ' File "/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py", line 430, in \_process\_data\n rval = self.proxy.dispatch(ctxt, version, method, \*\*args)\n', ' File "/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/dispatcher.py", line 133, in dispatch\n return getattr(proxyobj, method)(ctxt, \*\*kwargs)\n', ' File "/usr/lib/python2.7/dist-packages/nova/compute/manager.py", line 3273, in post\_live\_migration\_at\_destination\n block\_migration, block\_device\_info)\n', ' File "/usr/lib/python2.7/dist-packages/nova/virt/xenapi/driver.py", line 521, in post\_live\_migration\_at\_destination\n self.\_vmops.post\_live\_migration\_at\_destination(ctxt, instance\_ref,\n', "AttributeError: 'VMOps' object has no attribute 'post\_live\_migration\_at\_destination'\n"]
I have tried to patch the files "nova/virt/xenapi/driver.py" and "nova/virt/xenapi/vmops.py" according to John's commit in the openstack nova compute XCP virtual machines in both nodes participating in the live migration.
Am I doing anything wrong? Maybe I need to patch something more since I am on Grizzly and not trunk?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-09-20: |  |  | [#29](/nova/%2Bbug/1202266/comments/29) |
| --- | --- | --- | --- |

@Vangelis sorry, it will need to be against trunk, a lot of that code has changed recently :(

I could try a backport to grizzly.

@Vangelis sorry, it will need to be against trunk, a lot of that code has changed recently :(
I could try a backport to grizzly.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-09-23: |  |  | [#30](/nova/%2Bbug/1202266/comments/30) |
| --- | --- | --- | --- |

@John Garbutt: Which other versions are affected ? Looks like Grizzly is ? What about Folsom ?

@John Garbutt: Which other versions are affected ? Looks like Grizzly is ? What about Folsom ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-09-27:  [**Fix merged to nova (master)**](/nova/%2Bbug/1202266/comments/31) |  |  | [#31](/nova/%2Bbug/1202266/comments/31) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/46313>

Committed: <http://github.com/openstack/nova/commit/5cced7a6dd32d231c606e25dbf762d199bf9cca7>

Submitter: Jenkins

Branch: master

commit 5cced7a6dd32d231c606e25dbf762d199bf9cca7

Author: John Garbutt <email address hidden>

Date: Thu Sep 12 18:11:49 2013 +0100

xenapi: enforce filters after live-migration

Currently and network filters, including security groups, are

    lost after a server has been live-migrated.

This partially fixes the issue by ensuring that security groups are

    re-applied to the VM once it reached the destination, and been started.

This leaves a small amount of time during the live-migrate where the VM

    is not protected. There is a further bug raised to close the rest of

    this whole, but this helps keep the VM protected for the majority of the

    time.

Fixes [bug 1202266](/bugs/1202266)

Change-Id: I84fdb6e2a8ee38d75f243aadbe79945af1d6849d

Reviewed: https://review.openstack.org/46313
Committed: http://github.com/openstack/nova/commit/5cced7a6dd32d231c606e25dbf762d199bf9cca7
Submitter: Jenkins
Branch: master
commit 5cced7a6dd32d231c606e25dbf762d199bf9cca7
Author: John Garbutt <john.garbutt@rackspace.com>
Date: Thu Sep 12 18:11:49 2013 +0100
xenapi: enforce filters after live-migration
Currently and network filters, including security groups, are
lost after a server has been live-migrated.
This partially fixes the issue by ensuring that security groups are
re-applied to the VM once it reached the destination, and been started.
This leaves a small amount of time during the live-migrate where the VM
is not protected. There is a further bug raised to close the rest of
this whole, but this helps keep the VM protected for the majority of the
time.
Fixes bug 1202266
Change-Id: I84fdb6e2a8ee38d75f243aadbe79945af1d6849d

| Changed in nova: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-09-27:  [**Re: xenapi: secgroups are not in place after live-migration**](/nova/%2Bbug/1202266/comments/32) |  |  | [#32](/nova/%2Bbug/1202266/comments/32) |
| --- | --- | --- | --- |

Can we have backports to nova's stable/grizzly branch (and stable/folsom if affected similarly)?

Can we have backports to nova's stable/grizzly branch (and stable/folsom if affected similarly)?

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-10-03

| Changed in nova: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-10-09: |  |  | [#33](/nova/%2Bbug/1202266/comments/33) |
| --- | --- | --- | --- |

Any information on which stable release branches are/were affected by this (if any)? We'll want bug tasks and backports for them as far back as folsom if possible.

Any information on which stable release branches are/were affected by this (if any)? We'll want bug tasks and backports for them as far back as folsom if possible.

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-10-17

| Changed in nova: | |
| --- | --- |
| **milestone**: | havana-rc1 → 2013.2 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-10-21: |  |  | [#34](/nova/%2Bbug/1202266/comments/34) |
| --- | --- | --- | --- |

This one is since folsom, when live-migrate landed, totally my bad:

[https://blueprints.launchpad.net/nova/+spec/xenapi-live-migration](https://blueprints.launchpad.net/nova/%2Bspec/xenapi-live-migration)

The backport should be more straight forward for this one, although there has been quite a lot of rework around live-migrate recently, it shouldn't fundamentally change things.

Sorry for the delay, seem to have lost the updates on this in the regular email soup.

This one is since folsom, when live-migrate landed, totally my bad:
https://blueprints.launchpad.net/nova/+spec/xenapi-live-migration
The backport should be more straight forward for this one, although there has been quite a lot of rework around live-migrate recently, it shouldn't fundamentally change things.
Sorry for the delay, seem to have lost the updates on this in the regular email soup.

| **tags**: | added: folsom-backport-potential grizzly-backport-potential |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-10-21: |  |  | [#35](/nova/%2Bbug/1202266/comments/35) |
| --- | --- | --- | --- |

Great--thanks! I'll work on the combined impact description in [bug 1073306](/bugs/1073306) for now.

Great--thanks! I'll work on the combined impact description in bug 1073306 for now.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-10-21: |  |  | [#36](/nova/%2Bbug/1202266/comments/36) |
| --- | --- | --- | --- |

I have a first attempt at some backports here:

<https://review.openstack.org/#/c/52987/>

<https://review.openstack.org/#/c/52989/>

I have a first attempt at some backports here:
https://review.openstack.org/#/c/52987/
https://review.openstack.org/#/c/52989/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-10-21: |  |  | [#37](/nova/%2Bbug/1202266/comments/37) |
| --- | --- | --- | --- |

Vangelis: do you have an affiliation with any employer you want mentioned as part of your reporter credit on the security advisory for this issue?

Vangelis: do you have an affiliation with any employer you want mentioned as part of your reporter credit on the security advisory for this issue?

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2013-10-21

| Changed in ossa: | |
| --- | --- |
| **status**: | Confirmed → Triaged |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Vangelis Tasoulas (cyberang3l)](https://launchpad.net/~cyberang3l) wrote on 2013-10-22: |  |  | [#38](/nova/%2Bbug/1202266/comments/38) |
| --- | --- | --- | --- |

Jeremy: No employer needs to be mentioned, thanks :)

Jeremy: No employer needs to be mentioned, thanks :)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-10-31:  [**Fix merged to nova (stable/grizzly)**](/nova/%2Bbug/1202266/comments/39) |  |  | [#39](/nova/%2Bbug/1202266/comments/39) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/52987>

Committed: <http://github.com/openstack/nova/commit/df2ea2e3acdede21b40d47b7adbeac04213d031b>

Submitter: Jenkins

Branch: stable/grizzly

commit df2ea2e3acdede21b40d47b7adbeac04213d031b

Author: John Garbutt <email address hidden>

Date: Thu Sep 12 18:11:49 2013 +0100

xenapi: enforce filters after live-migration

Currently and network filters, including security groups, are

    lost after a server has been live-migrated.

This partially fixes the issue by ensuring that security groups are

    re-applied to the VM once it reached the destination, and been started.

This leaves a small amount of time during the live-migrate where the VM

    is not protected. There is a further bug raised to close the rest of

    this whole, but this helps keep the VM protected for the majority of the

    time.

Fixes [bug 1202266](/bugs/1202266)

(Cherry picked from commit: 5cced7a6dd32d231c606e25dbf762d199bf9cca7)

Change-Id: I66bc7af1c6da74e18dce47180af0cb6020ba2c1a

Reviewed: https://review.openstack.org/52987
Committed: http://github.com/openstack/nova/commit/df2ea2e3acdede21b40d47b7adbeac04213d031b
Submitter: Jenkins
Branch: stable/grizzly
commit df2ea2e3acdede21b40d47b7adbeac04213d031b
Author: John Garbutt <john.garbutt@rackspace.com>
Date: Thu Sep 12 18:11:49 2013 +0100
xenapi: enforce filters after live-migration
Currently and network filters, including security groups, are
lost after a server has been live-migrated.
This partially fixes the issue by ensuring that security groups are
re-applied to the VM once it reached the destination, and been started.
This leaves a small amount of time during the live-migrate where the VM
is not protected. There is a further bug raised to close the rest of
this whole, but this helps keep the VM protected for the majority of the
time.
Fixes bug 1202266
(Cherry picked from commit: 5cced7a6dd32d231c606e25dbf762d199bf9cca7)
Change-Id: I66bc7af1c6da74e18dce47180af0cb6020ba2c1a

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2013-11-03

| Changed in ossa: | |
| --- | --- |
| **status**: | Triaged → In Progress |

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2013-11-03

| **summary**: | - xenapi: secgroups are not in place after live-migration+ xenapi: secgroups are not in place after live-migration (CVE-2013-4497) |
| --- | --- |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-11-13

| **no longer affects**: | nova/folsom |
| --- | --- |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-11-14

| Changed in ossa: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-11-15: |  |  | [#40](/nova/%2Bbug/1202266/comments/40) |
| --- | --- | --- | --- |

[OSSA 2013-030]

[OSSA 2013-030]

| **summary**: | - xenapi: secgroups are not in place after live-migration (CVE-2013-4497)+ [OSSA 2013-030] xenapi: secgroups are not in place after live-migration+ (CVE-2013-4497) |
| --- | --- |
| Changed in ossa: | |
| **status**: | Fix Committed → Fix Released |

[Alan Pevec (apevec)](https://launchpad.net/~apevec)
on 2014-03-20

| **tags**: | removed: folsom-backport-potential grizzly-backport-potential |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/nova/%2Bbug/1202266/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/nova/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/nova/%2Bbug/1202266/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/nova/%2Bbug/1202266/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/nova/%2Bbug/1202266/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_6966a5e8_20250126_130745.html ===

[Log in / Register](https://launchpad.net/~cbehrens/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~cbehrens)

## [Chris Behrens](https://launchpad.net/~cbehrens)

* Overview
* [Code](https://code.launchpad.net/~cbehrens)
* [Bugs](https://bugs.launchpad.net/~cbehrens)
* [Blueprints](https://blueprints.launchpad.net/~cbehrens)
* [Translations](https://translations.launchpad.net/~cbehrens)
* [Answers](https://answers.launchpad.net/~cbehrens)

* [Related packages](https://launchpad.net/~cbehrens/%2Brelated-packages)
* [Related projects](https://launchpad.net/~cbehrens/%2Brelated-projects)

## User information

Launchpad Id:
cbehrens

Email:
[Log in](%2Blogin) for email information.

Member since:
2010-04-16

[![Icon of Burrow](https://launchpadlibrarian.net/67728214/os14.png "Member of Burrow")](/~burrow)
[![Icon of Nova](https://launchpadlibrarian.net/52560219/os14.png "Member of Nova")](/~nova)
[![Icon of OpenStack Team](https://launchpadlibrarian.net/52313052/os14.png "Member of OpenStack Team")](/~openstack)
[![Icon of Swift](https://launchpadlibrarian.net/52560230/os14.png "Member of Swift")](/~swift)

Languages:

English

SSH keys:

[chris.behrens@chunk](%2Bsshkeys)

[cbehrens@xs-centos54](%2Bsshkeys)

[cbehrens@lilsilver](%2Bsshkeys)

[cbehrens@karma.local](%2Bsshkeys)

[cbehrens@vmw-ubuntu1](%2Bsshkeys)

Time zone:

America/Los\_Angeles
(UTC-0800)

Karma:
[0](https://launchpad.net/~cbehrens/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**comstud**
 on
**All**

## [All assigned blueprints](/~cbehrens/%2Bspecs?role=assignee) Assigned blueprints

| **[Direct MySQLdb implementation](https://blueprints.launchpad.net/nova/%2Bspec/db-mysqldb-impl "db-mysqldb-impl")** for **OpenStack Compute (nova)**  With the move of all DB calls for nova-compute going to nova-conductor, it becomes important to have efficient DB calls that do not block the whole python process. It's been found that: 1) sqlalchemy calls are tremendously slower than using direct calls with mysqldb. Even when using more low level sqlalchemy call... | |
| --- | --- |

## [All memberships](https://launchpad.net/~cbehrens/%2Bparticipation) Latest memberships

| [OpenStack Team](/~openstack)  Joined on 2012-02-23 | |
| --- | --- |
| [OpenStack Contributors](/~openstack-cla)  Joined on 2012-01-05 | |
| [Nova Orchestration Team](/~nova-orchestration)  Joined on 2011-10-18 | |
| [Nova Scaling Team](/~nova-scaling)  Joined on 2011-10-17 | |
| [Burrow Core Team](/~burrow-core)  Joined on 2011-08-31 | |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_1d0b4763_20250126_130746.html ===

[Log in / Register](https://launchpad.net/~ttx/%2Blogin)

[![](https://launchpadlibrarian.net/116816327/ttx64.jpg)](https://launchpad.net/~ttx)

## [Thierry Carrez](https://launchpad.net/~ttx)

* Overview
* [Code](https://code.launchpad.net/~ttx)
* [Bugs](https://bugs.launchpad.net/~ttx)
* [Blueprints](https://blueprints.launchpad.net/~ttx)
* [Translations](https://translations.launchpad.net/~ttx)
* [Answers](https://answers.launchpad.net/~ttx)

Chair of the Technical Committee and Release Manager for OpenStack.

Python Software Foundation member.

Ubuntu core developer.

* [Related packages](https://launchpad.net/~ttx/%2Brelated-packages)
* [Related projects](https://launchpad.net/~ttx/%2Brelated-projects)

## User information

Launchpad Id:
ttx

Email:
[Log in](%2Blogin) for email information.

Member since:
2008-05-12

[![Icon of Cassandra Ubuntu Packaging](https://launchpadlibrarian.net/59580596/cassandra-ubuntu-icon.png "Member of Cassandra Ubuntu Packaging")](/~cassandra-ubuntu)
[![Icon of (deprecated) OpenStack PPA maintainers](https://launchpadlibrarian.net/87891894/ppa.gif "Member of (deprecated) OpenStack PPA maintainers")](/~openstack-ppa)
[![Icon of Designate Drivers](https://launchpadlibrarian.net/360468067/designate_14.jpg "Member of Designate Drivers")](/~designate-drivers)
[![Icon of Launchpad Beta Testers](https://launchpadlibrarian.net/600856498/Canonical_Launchpad_icon_14px.png "Member of Launchpad Beta Testers")](/~launchpad-beta-testers)
[![Icon of Martin Pitt's fan](https://launchpadlibrarian.net/16410730/immaginexz0.png "Member of Martin Pitt's fan")](/~we-love-pitti)
[![Icon of Nova](https://launchpadlibrarian.net/52560219/os14.png "Member of Nova")](/~nova)
[![Icon of OpenStack release team](https://launchpadlibrarian.net/73211233/openstack-release.png "Member of OpenStack release team")](/~openstack-release)
[![Icon of OpenStack Security SIG](https://launchpadlibrarian.net/203991792/os14.png "Member of OpenStack Security SIG")](/~openstack-ossg)
[![Icon of OpenStack Team](https://launchpadlibrarian.net/52313052/os14.png "Member of OpenStack Team")](/~openstack)
[![Icon of Python OpenStack Client Drivers](https://launchpadlibrarian.net/697274978/osc-icon.png "Member of Python OpenStack Client Drivers")](/~python-openstackclient-drivers)
[![Icon of Python OpenStack Client](https://launchpadlibrarian.net/697274843/osc-icon.png "Member of Python OpenStack Client")](/~python-openstackclient)
[![Icon of Soren's Target Audience](https://launchpadlibrarian.net/20548684/golf.png "Member of Soren's Target Audience")](/~sorens-target-audience)
[![Icon of Ubuntu Contributing Developers](https://launchpadlibrarian.net/17290192/wrench_emblem-trans.png "Member of Ubuntu Contributing Developers")](/~ubuntu-developer-members)
[![Icon of Ubuntu Members](https://launchpadlibrarian.net/606495581/CoF%2014px.png "Member of Ubuntu Members")](/~ubuntumembers)
[![Icon of Ubuntu Server papercutters](https://launchpadlibrarian.net/38078797/14.png "Member of Ubuntu Server papercutters")](/~server-papercutters)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English, French

OpenPGP keys:

22A7943050DB1E67EC2B641A507AF89025B10423

SSH keys:

[ttx@stardust](%2Bsshkeys)

[ttx@mercury](%2Bsshkeys)

Time zone:

Europe/Paris
(UTC+0100)

Karma:
[0](https://launchpad.net/~ttx/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**ttx**
 on
**FreeNode**

## [All bugs in progress](https://launchpad.net/~ttx/%2Bassignedbugs?search=Search&field.status=In+Progress) Assigned bugs

||  | #1473369 [new mock release broke a bunch of unit tests](https://bugs.launchpad.net/python-muranoclient/kilo/%2Bbug/1473369) |  |
| --- | --- | --- |
| in [python-muranoclient](/python-muranoclient), [Glance](/glance), [glance\_store](/glance-store), [Murano](/murano), [neutron](/neutron), [OpenStack Object Storage (swift)](/swift) | | |

| --- | --- | --- | --- | --- | --- |

## Personal package archives

| [Test Openstack 2011.3](/~ttx/%2Barchive/ubuntu/2011.3) |
| --- |
| [Extra packages](/~ttx/%2Barchive/ubuntu/extras) |
| [Bexar update candidates](/~ttx/%2Barchive/ubuntu/nova-bexar-updates) |
| [Junk PPA](/~ttx/%2Barchive/ubuntu/ppa) |
| [Terracotta stack](/~ttx/%2Barchive/ubuntu/terracotta) |

## [All memberships](https://launchpad.net/~ttx/%2Bparticipation) Latest memberships

| [kata-containers](/~kata-containers)  Joined on 2018-10-09 | |
| --- | --- |
| [OpenStack Folsom Stable Maintainers](/~openstack-folsom-maint)  Joined on 2013-04-11 | |
| [OpenStack Python3 Migration Team](/~openstack-py3-team)  Joined on 2013-03-20 | |
| [OpenStack Security SIG](/~openstack-ossg)  Joined on 2012-05-25 | |
| [Swift Drivers](/~swift-drivers)  Joined on 2012-04-06 | |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from answers.launchpad.net_c6f997e5_20250126_130759.html ===

[Log in / Register](https://answers.launchpad.net/nova/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* [Translations](https://translations.launchpad.net/nova)
* Answers

# Questions for OpenStack Compute (nova)

**Launchpad does not know where
OpenStack Compute (nova)
tracks support requests.**

OpenStack Compute (nova) questions are
tracked in:
[nova in Ubuntu](/ubuntu/%2Bsource/nova),
[python-openstack-compute in Ubuntu](/ubuntu/%2Bsource/python-openstack-compute).

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_fc6b9153_20250126_003015.html ===

[Log in / Register](https://bugs.launchpad.net/nova/%2Bbug/1202266/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* [Translations](https://translations.launchpad.net/nova)
* [Answers](https://answers.launchpad.net/nova)

# [OSSA 2013-030] xenapi: secgroups are not in place after live-migration (CVE-2013-4497)

Bug #1202266 reported by
[Vangelis Tasoulas](https://launchpad.net/~cyberang3l)
on 2013-07-17

[272](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Compute (nova)](https://bugs.launchpad.net/nova) | Fix Released | High | [John Garbutt](https://launchpad.net/~johngarbutt) | [OpenStack Compute (nova) 2013.2 "havana"](https://launchpad.net/nova/%2Bmilestone/2013.2) |
|  | [Grizzly](https://bugs.launchpad.net/nova/grizzly) | Fix Released | High | [John Garbutt](https://launchpad.net/~johngarbutt) | [OpenStack Compute (nova) 2013.1.5](https://launchpad.net/nova/%2Bmilestone/2013.1.5) |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | High | [Jeremy Stanley](https://launchpad.net/~fungi) |  |

### Bug Description

Distributed Setup with:

2x Compute nodes with Debian Wheezy + XCP installed from repositories (Kronos). The VM controlling XCP is installed on Ubuntu Precise.

1x Controller node with Keystone and Nova (except Network and Compute) on Ubuntu Precise with OpenStack Grizzly installed from cloud archive.

1x Network node running Nova network with FlatDHCP (no quantum is used because it is not supported for XCP yet - I think it will starting with Havana release). The network node has 3 interfaces. 1x Public, 1x Management, 1x Tenant.

1x Storage node running Cinder, Glance and NFSv3 for shared storage to support live migration

I experiment with XCP and live migration these days so after I configured everything else, I tried to configure floating IP addresses as well. The configuration of the floating IP's was trivial but when I booted a VM, I instantly migrated it (that's what I am mostly testing) and then assigned a floating IP. Then I tried to ping it and connect to it using ssh and everything worked fine.

I boot a second VM and this time I do not migrate it. I assign a floating IP address and no ping or ssh connection is possible to be made on this one even though the iptables have been setup correctly (the SNAT and DNAT). I migrate the VM and then I can connect to it using SSH without any problems.

In the beginning I thought it is a bug and for some reason when you boot even though you should be able to connect, you cannot. After looking in the documentation I found this: <http://docs.openstack.org/essex/openstack-compute/admin/content/configuring-openstack-compute-basics.html#enabling-access-to-vms-on-the-compute-node>

What I understood from this is that it is the other way around and I should NOT be able to ping or connect to the VMs using SSH by default if I don't explicitly add the secgroup rules to allow such actions.

After adding these two rules everything works fine (I can access any vm, migrated or non-migrated):

$ nova secgroup-add-rule default icmp -1 -1 0.0.0.0/0

$ nova secgroup-add-rule default tcp 22 22 0.0.0.0/0

After removing them again, I cannot access the non-migrated VM's (correct) but I can still access those that they were migrated once.

Even when I migrate them back to the hypervisor originally booted on, the secgroups still do not apply and I can access those VM's.

Tags:

[xenserver](/nova/%2Bbugs?field.tag=xenserver)

## CVE References

* [2013-4497](/bugs/cve/2013-4497 "The XenAPI backend in OpenStack Compu...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-07-18: |  |  | [#1](/nova/%2Bbug/1202266/comments/1) |
| --- | --- | --- | --- |

Adding Nova PTL for sanity check

Adding Nova PTL for sanity check

| Changed in ossa: | |
| --- | --- |
| **status**: | New → Incomplete |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Vangelis Tasoulas (cyberang3l)](https://launchpad.net/~cyberang3l) wrote on 2013-07-18: |  |  | [#2](/nova/%2Bbug/1202266/comments/2) |
| --- | --- | --- | --- |

Just to mention as well that I am using XenAPI pools and shared storage for the live migrations as described here: <http://docs.openstack.org/trunk/openstack-compute/admin/content/configuring-migrations.html#configuring-migrations-xenserver-shared-storage>

More information on my setup here:

[https://answers.launchpad.net/nova/+question/232484](https://answers.launchpad.net/nova/%2Bquestion/232484)

Just to mention as well that I am using XenAPI pools and shared storage for the live migrations as described here: http://docs.openstack.org/trunk/openstack-compute/admin/content/configuring-migrations.html#configuring-migrations-xenserver-shared-storage
More information on my setup here:
https://answers.launchpad.net/nova/+question/232484

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Russell Bryant (russellb)](https://launchpad.net/~russellb) wrote on 2013-07-18: |  |  | [#3](/nova/%2Bbug/1202266/comments/3) |
| --- | --- | --- | --- |

I think the first thing I'd like to do here is try to replicate this behavior on another setup. I'm adding John Garbutt, nova-core and xenapi driver expert, to this bug to see if he can help try this out.

I think the first thing I'd like to do here is try to replicate this behavior on another setup. I'm adding John Garbutt, nova-core and xenapi driver expert, to this bug to see if he can help try this out.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-07-18: |  |  | [#4](/nova/%2Bbug/1202266/comments/4) |
| --- | --- | --- | --- |

I thought this sounded familiar:

[https://bugs.launchpad.net/nova/+bug/1073306](https://bugs.launchpad.net/nova/%2Bbug/1073306)

But I agree, this is a security issue, for those using Security Groups.

I thought this sounded familiar:
https://bugs.launchpad.net/nova/+bug/1073306
But I agree, this is a security issue, for those using Security Groups.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-07-18: |  |  | [#5](/nova/%2Bbug/1202266/comments/5) |
| --- | --- | --- | --- |

On re-reading, this might be a new case.

The old bug covers migration not live-migration. But its likely the cause.

On re-reading, this might be a new case.
The old bug covers migration not live-migration. But its likely the cause.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-07-19: |  |  | [#6](/nova/%2Bbug/1202266/comments/6) |
| --- | --- | --- | --- |

So this is Xen-specific ?

I think it would qualify as a vulnerability because people would expect port filtering (at least default DROP/REJECT rules) to be reapplied ?

So this is Xen-specific ?
I think it would qualify as a vulnerability because people would expect port filtering (at least default DROP/REJECT rules) to be reapplied ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-07-24: |  |  | [#7](/nova/%2Bbug/1202266/comments/7) |
| --- | --- | --- | --- |

Sorry, lost the email notification, but this is XenServer specific, its in the XenAPI driver code.

There is quite a bit of work to fix up this feature around:

\* resize, migrate, live-migrate

Basically, the security groups is currently totally untested, in many respects. However, I don't think this has really been communicated at all well (if at all).

There are deeper issues here too, because the feature was written for linux bridge, but XenServer now uses OVS by default, so the iptables rules are not good enough. Will need some digging around neutron vs nova here too. I know BobBall at Citrix was talking a look at the above deeper issues, its probably worth brining him in here.

Sorry, lost the email notification, but this is XenServer specific, its in the XenAPI driver code.
There is quite a bit of work to fix up this feature around:
\* resize, migrate, live-migrate
Basically, the security groups is currently totally untested, in many respects. However, I don't think this has really been communicated at all well (if at all).
There are deeper issues here too, because the feature was written for linux bridge, but XenServer now uses OVS by default, so the iptables rules are not good enough. Will need some digging around neutron vs nova here too. I know BobBall at Citrix was talking a look at the above deeper issues, its probably worth brining him in here.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-07-24: |  |  | [#8](/nova/%2Bbug/1202266/comments/8) |
| --- | --- | --- | --- |

Just to confirm, my code inspection confirms that this bug happens with XenAPI.

I have not checked if this bug is present in any other drivers.

I am also, not sure we have tests for this in tempest, as I heard XenAPI is very close to passing full tempest (on volume related test currently failing).

Just to confirm, my code inspection confirms that this bug happens with XenAPI.
I have not checked if this bug is present in any other drivers.
I am also, not sure we have tests for this in tempest, as I heard XenAPI is very close to passing full tempest (on volume related test currently failing).

[Russell Bryant (russellb)](https://launchpad.net/~russellb)
on 2013-07-26

| **tags**: | added: xenserver |
| --- | --- |

[John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt)
on 2013-07-29

| Changed in nova: | |
| --- | --- |
| **importance**: | Undecided → High |
| **status**: | New → Confirmed |
| **summary**: | - Secgroups are not in place after migration!+ xenapi: secgroups are not in place after live-migration |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-07-29:  [**Re: xenapi: secgroups are not in place after live-migration**](/nova/%2Bbug/1202266/comments/9) |  |  | [#9](/nova/%2Bbug/1202266/comments/9) |
| --- | --- | --- | --- |

My take is that we'll need to issue an OSSA on this one.

My take is that we'll need to issue an OSSA on this one.

| Changed in ossa: | |
| --- | --- |
| **status**: | Incomplete → Confirmed |
| **importance**: | Undecided → High |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Michael Still (mikal)](https://launchpad.net/~mikal) wrote on 2013-07-29: |  |  | [#10](/nova/%2Bbug/1202266/comments/10) |
| --- | --- | --- | --- |

@Gabe -- do you have a resource who might be able to help out with this one?

@Gabe -- do you have a resource who might be able to help out with this one?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Matt Dietz (cerberus)](https://launchpad.net/~cerberus) wrote on 2013-07-29: |  |  | [#11](/nova/%2Bbug/1202266/comments/11) |
| --- | --- | --- | --- |

John: so in essence, we're talking about applying new flows once the VM has moved to the destination, correct?

As you point out, OVS is the default behavior here, and to my knowledge, no real implementation exists for applying OVS flows today. The implementation in Neutron (last I checked) was only a basic OVS pass, and actually utilized IPTables rules in addition. OVS was there more as a proof of concept than actual useful implementation. Ensuring that resize et al also attempt to apply security groups is insufficient since there's nothing (again, to the best of my knowledge) capable of applying those flows.

John: so in essence, we're talking about applying new flows once the VM has moved to the destination, correct?
As you point out, OVS is the default behavior here, and to my knowledge, no real implementation exists for applying OVS flows today. The implementation in Neutron (last I checked) was only a basic OVS pass, and actually utilized IPTables rules in addition. OVS was there more as a proof of concept than actual useful implementation. Ensuring that resize et al also attempt to apply security groups is insufficient since there's nothing (again, to the best of my knowledge) capable of applying those flows.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-07-30: |  |  | [#12](/nova/%2Bbug/1202266/comments/12) |
| --- | --- | --- | --- |

So, not sure the best way to fix this stuff, advice needed.

I almost want to say we should just issue an advisory to clarify the state of the security groups feature as "experimental" with more work required before it is production ready, and the work around is not to rely on security groups. But that doesn't feel like the right response. However a proper fix will require this feature to (effectively) be implemented.

So lets try summarize the issues:

\* nova has missing calls to the firewall driver (there are open public bugs on this one, and there are fixes in progress, in the public, which is probably bad) - I am happy to look into getting this fixed, but do we need to backport these? Will need a networking expert to check the fixes.

\* the firewall driver in nova doesn't work with OVS - I could do with a hand fixing that

\* I don't know the state of the various neutron drivers and how they interact, we don't yet have the equivalent VIF drivers for XenAPI, but that might not matter - again, not something I really know how to fix

\* MAC and IP address spoofing should also be checked

Going into the firewall driver issues, it was written when XenServer used bridge networking, back in 5.6. The OVS case has always been avoided, because until recently, the version of OVS shipping with XenServer (apparently) did not have the bit masking operation that would allow you to avoid some of the worst bits of rule explosion in the number of rules. You need to take care, because there is a massive OVS slowdown once the rules don't fit in your processors L2/L3 cache, or something like that, which would give users a sort of DoS attach on the other VMs the host their VM is present.

So, not sure the best way to fix this stuff, advice needed.
I almost want to say we should just issue an advisory to clarify the state of the security groups feature as "experimental" with more work required before it is production ready, and the work around is not to rely on security groups. But that doesn't feel like the right response. However a proper fix will require this feature to (effectively) be implemented.
So lets try summarize the issues:
\* nova has missing calls to the firewall driver (there are open public bugs on this one, and there are fixes in progress, in the public, which is probably bad) - I am happy to look into getting this fixed, but do we need to backport these? Will need a networking expert to check the fixes.
\* the firewall driver in nova doesn't work with OVS - I could do with a hand fixing that
\* I don't know the state of the various neutron drivers and how they interact, we don't yet have the equivalent VIF drivers for XenAPI, but that might not matter - again, not something I really know how to fix
\* MAC and IP address spoofing should also be checked
Going into the firewall driver issues, it was written when XenServer used bridge networking, back in 5.6. The OVS case has always been avoided, because until recently, the version of OVS shipping with XenServer (apparently) did not have the bit masking operation that would allow you to avoid some of the worst bits of rule explosion in the number of rules. You need to take care, because there is a massive OVS slowdown once the rules don't fit in your processors L2/L3 cache, or something like that, which would give users a sort of DoS attach on the other VMs the host their VM is present.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-08-01: |  |  | [#13](/nova/%2Bbug/1202266/comments/13) |
| --- | --- | --- | --- |

@John: if "fixing" it for stable/grizzly amounts to implementing the full feature there, then I would agree that we should issue a security note about it being non-usable and move on. The issue is, it looks implemented enough so that people would trust it... in particular, security groups seem to work properly until you do a migration ?

Sitting on the fence on this one.

@John: if "fixing" it for stable/grizzly amounts to implementing the full feature there, then I would agree that we should issue a security note about it being non-usable and move on. The issue is, it looks implemented enough so that people would trust it... in particular, security groups seem to work properly until you do a migration ?
Sitting on the fence on this one.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-08-08: |  |  | [#14](/nova/%2Bbug/1202266/comments/14) |
| --- | --- | --- | --- |

@John: what would it take to plug the security hole (people run with security groups and they kinda work, migrate and expect them to be restored but poof they are gone) ? We don't necessarily need to fix all security group bugs :)

@John: what would it take to plug the security hole (people run with security groups and they kinda work, migrate and expect them to be restored but poof they are gone) ? We don't necessarily need to fix all security group bugs :)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-08-20: |  |  | [#15](/nova/%2Bbug/1202266/comments/15) |
| --- | --- | --- | --- |

@Thierry, sorry for the delay, screwed up my email filters, and just back from holiday.

I agree, its probably best to fix this up.

Not sure of the best way to phase this, but it would be good to alert people to the fact this

A quick fix for non-live migration is probably just a cut and paste of this code:

<https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L444>

<https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L462>

And put it either side of the boot command here (for migration):

<https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L311>

In terms of the public bug, around migration not setting up security groups, you can see my attempt at a "proper" fix here:

<https://review.openstack.org/#/c/38455/>

I am not really sure how to fix it for live-migration, need someone with more neutron skills than me really.

The problem is the VM domain and networking is created on the destination by XenAPI, auto-magically, in a single live-migrate operation:

<https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L1881>

We could add a "post\_live\_migration\_at\_destination", that does the firewall setup, but that would be after the VM has become active on the destination, so there is likely to be a small period when the traffic is not filtered, unless we can some how block all the traffic during that time (which I think might happen when you have an OVS controller present, but I am not sure). The missing code that would go in post\_live\_migration, must be something like this:

<https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L444>

<https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L462>

In libvirt, I think the VIFs are plugged before the live-migrate happens, so its covered by this method call:

<https://github.com/openstack/nova/blob/master/nova/compute/manager.py#L3794>

XenAPI has a rather dodgy implementation of that:

<https://github.com/openstack/nova/blob/master/nova/virt/xenapi/driver.py#L418>

I see familar code in the libvirt driver, but I don't think that will work when the VIFs have not been created, and the VIFs are not created in time:

<https://github.com/openstack/nova/blob/master/nova/virt/libvirt/driver.py#L3332>

As far as getting a networking guru, I know Salvatore Orlando worked on this first implementation of these bits, maybe he would be a good person to cast his eye across the above ideas. But there might be someone on the security team who can help out, not sure who is on the list.

@Thierry, sorry for the delay, screwed up my email filters, and just back from holiday.
I agree, its probably best to fix this up.
Not sure of the best way to phase this, but it would be good to alert people to the fact this
A quick fix for non-live migration is probably just a cut and paste of this code:
https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L444
https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L462
And put it either side of the boot command here (for migration):
https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L311
In terms of the public bug, around migration not setting up security groups, you can see my attempt at a "proper" fix here:
https://review.openstack.org/#/c/38455/
I am not really sure how to fix it for live-migration, need someone with more neutron skills than me really.
The problem is the VM domain and networking is created on the destination by XenAPI, auto-magically, in a single live-migrate operation:
https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L1881
We could add a "post\_live\_migration\_at\_destination", that does the firewall setup, but that would be after the VM has become active on the destination, so there is likely to be a small period when the traffic is not filtered, unless we can some how block all the traffic during that time (which I think might happen when you have an OVS controller present, but I am not sure). The missing code that would go in post\_live\_migration, must be something like this:
https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L444
https://github.com/openstack/nova/blob/master/nova/virt/xenapi/vmops.py#L462
In libvirt, I think the VIFs are plugged before the live-migrate happens, so its covered by this method call:
https://github.com/openstack/nova/blob/master/nova/compute/manager.py#L3794
XenAPI has a rather dodgy implementation of that:
https://github.com/openstack/nova/blob/master/nova/virt/xenapi/driver.py#L418
I see familar code in the libvirt driver, but I don't think that will work when the VIFs have not been created, and the VIFs are not created in time:
https://github.com/openstack/nova/blob/master/nova/virt/libvirt/driver.py#L3332
As far as getting a networking guru, I know Salvatore Orlando worked on this first implementation of these bits, maybe he would be a good person to cast his eye across the above ideas. But there might be someone on the security team who can help out, not sure who is on the list.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-08-20: |  |  | [#16](/nova/%2Bbug/1202266/comments/16) |
| --- | --- | --- | --- |

I see no point in keeping this private, since the live migration case is mentioned on the public bug. Unless someone complains, I'll open this up, which should facilitate the fixing, since this is actually non-trivial.

I see no point in keeping this private, since the live migration case is mentioned on the public bug. Unless someone complains, I'll open this up, which should facilitate the fixing, since this is actually non-trivial.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-08-20: |  |  | [#17](/nova/%2Bbug/1202266/comments/17) |
| --- | --- | --- | --- |

CCing Salvatore: we might need your help around here.

CCing Salvatore: we might need your help around here.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-08-20: |  |  | [#18](/nova/%2Bbug/1202266/comments/18) |
| --- | --- | --- | --- |

Agreed, with [bug 1073306](/bugs/1073306) already mentioning that xenapi migrations don't apply security group filters and that it also affects live migration, this is now public knowledge. Opening it up the discussion to the wider developer community will hopefully also get us a fix sooner.

Agreed, with bug 1073306 already mentioning that xenapi migrations don't apply security group filters and that it also affects live migration, this is now public knowledge. Opening it up the discussion to the wider developer community will hopefully also get us a fix sooner.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-08-21: |  |  | [#19](/nova/%2Bbug/1202266/comments/19) |
| --- | --- | --- | --- |

Shall be a common OSSA with 1073306

Shall be a common OSSA with 1073306

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Bob Ball (bob-ball)](https://launchpad.net/~bob-ball) wrote on 2013-08-21: |  |  | [#20](/nova/%2Bbug/1202266/comments/20) |
| --- | --- | --- | --- |

Potentially making this a little wider, my current understanding of the OVS is that the OVS does not call the netfilter code when it is forwarding traffic to VMs. In summary my belief is that only bridge-based systems support security groups, and if you configure a host to use libvirt and OVS (which I believe is possible?) then that would suffer from the same issue.

Agreed that there is a question about how to handle the live migration case with XAPI doing most of the work. There is a hook we can use in XAPI - but I'm not sure this is the best solution. I'd prefer to create the VM with fully blocked ports and then apply the correct security groups.

Potentially making this a little wider, my current understanding of the OVS is that the OVS does not call the netfilter code when it is forwarding traffic to VMs. In summary my belief is that only bridge-based systems support security groups, and if you configure a host to use libvirt and OVS (which I believe is possible?) then that would suffer from the same issue.
Agreed that there is a question about how to handle the live migration case with XAPI doing most of the work. There is a hook we can use in XAPI - but I'm not sure this is the best solution. I'd prefer to create the VM with fully blocked ports and then apply the correct security groups.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-08-30: |  |  | [#21](/nova/%2Bbug/1202266/comments/21) |
| --- | --- | --- | --- |

Bob, seems like a good option. Can you take on fixing the live migrate issue?

Bob, seems like a good option. Can you take on fixing the live migrate issue?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-09-09: |  |  | [#22](/nova/%2Bbug/1202266/comments/22) |
| --- | --- | --- | --- |

In response to Thierry's comment #19, I'm unsure how we'll be able to issue a common OSSA if the proposed fix for [bug 1073306](/bugs/1073306) does not address this issue. Should we hold the advisory until such time as fixes for both are ready, or do they need to diverge?

In response to Thierry's comment #19, I'm unsure how we'll be able to issue a common OSSA if the proposed fix for bug 1073306 does not address this issue. Should we hold the advisory until such time as fixes for both are ready, or do they need to diverge?

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-09-10

| Changed in nova: | |
| --- | --- |
| **milestone**: | none → havana-rc1 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-09-12: |  |  | [#23](/nova/%2Bbug/1202266/comments/23) |
| --- | --- | --- | --- |

I have a suggested partial fix for this issue.

I have split the issue to include some additional work in this bug:

[https://bugs.launchpad.net/nova/+bug/1224587](https://bugs.launchpad.net/nova/%2Bbug/1224587)

I have a suggested partial fix for this issue.
I have split the issue to include some additional work in this bug:
https://bugs.launchpad.net/nova/+bug/1224587

| Changed in nova: | |
| --- | --- |
| **assignee**: | nobody → John Garbutt (johngarbutt) |
| **status**: | Confirmed → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-09-12: |  |  | [#24](/nova/%2Bbug/1202266/comments/24) |
| --- | --- | --- | --- |

@Vangelis I would really appreciate help testing this, if you still have a setup you can check this on. The fix is still a little work in progress, but I wanted to get peoples opinions, on if this would be an acceptable way forward, in the short term.

@Vangelis I would really appreciate help testing this, if you still have a setup you can check this on. The fix is still a little work in progress, but I wanted to get peoples opinions, on if this would be an acceptable way forward, in the short term.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-09-12:  [**Fix proposed to nova (master)**](/nova/%2Bbug/1202266/comments/25) |  |  | [#25](/nova/%2Bbug/1202266/comments/25) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/46313>

Fix proposed to branch: master
Review: https://review.openstack.org/46313

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Vangelis Tasoulas (cyberang3l)](https://launchpad.net/~cyberang3l) wrote on 2013-09-12:  [**Re: xenapi: secgroups are not in place after live-migration**](/nova/%2Bbug/1202266/comments/26) |  |  | [#26](/nova/%2Bbug/1202266/comments/26) |
| --- | --- | --- | --- |

John, I still have the setup so definitely I can help on testing. I'll report back early next week as I'm away at the moment.

John, I still have the setup so definitely I can help on testing. I'll report back early next week as I'm away at the moment.

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2013-09-17

| Changed in ossa: | |
| --- | --- |
| **assignee**: | nobody → Jeremy Stanley (fungi) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-09-17: |  |  | [#27](/nova/%2Bbug/1202266/comments/27) |
| --- | --- | --- | --- |

Vangelis, did you have a chance to confirm whether John's patch above mitigates the issue on your setup?

Vangelis, did you have a chance to confirm whether John's patch above mitigates the issue on your setup?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Vangelis Tasoulas (cyberang3l)](https://launchpad.net/~cyberang3l) wrote on 2013-09-18: |  |  | [#28](/nova/%2Bbug/1202266/comments/28) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/nova/%2Bbug/1202266/comments/28/%2Bdownload) (3.6 KiB)

I just and it's not working for me.

However, I get the following error in the nova-compute.log:

2013-09-18 14:46:10.972 INFO nova.compute.manager [req-629ff9d2-fb6c-4c83-a672-e5aecd36cb20 8ca2f0ccd55f4d9ba53847755f2e0b18 10c16ce5ffb54c56925152b7d331a8d2] [instance: f521d7f2-d27f-40ff-81da-d1a25a5b69ac] Post operation of migration started

2013-09-18 14:46:12.221 ERROR nova.openstack.common.rpc.amqp [req-629ff9d2-fb6c-4c83-a672-e5aecd36cb20 8ca2f0ccd55f4d9ba53847755f2e0b18 10c16ce5ffb54c56925152b7d331a8d2] Exception during message handling

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp File "/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py", line 430, in \_process\_data

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp rval = self.proxy.dispatch(ctxt, version, method, \*\*args)

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp File "/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/dispatcher.py", line 133, in dispatch

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp return getattr(proxyobj, method)(ctxt, \*\*kwargs)

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp File "/usr/lib/python2.7/dist-packages/nova/compute/manager.py", line 3273, in post\_live\_migration\_at\_destination

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp block\_migration, block\_device\_info)

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp File "/usr/lib/python2.7/dist-packages/nova/virt/xenapi/driver.py", line 521, in post\_live\_migration\_at\_destination

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp self.\_vmops.post\_live\_migration\_at\_destination(ctxt, instance\_ref,

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp AttributeError: 'VMOps' object has no attribute 'post\_live\_migration\_at\_destination'

2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp

2013-09-18 14:46:12.230 ERROR nova.openstack.common.rpc.common [req-629ff9d2-fb6c-4c83-a672-e5aecd36cb20 8ca2f0ccd55f4d9ba53847755f2e0b18 10c16ce5ffb54c56925152b7d331a8d2] Returning exception 'VMOps' object has no attribute 'post\_live\_migration\_at\_destination' to caller

2013-09-18 14:46:12.230 ERROR nova.openstack.common.rpc.common [req-629ff9d2-fb6c-4c83-a672-e5aecd36cb20 8ca2f0ccd55f4d9ba53847755f2e0b18 10c16ce5ffb54c56925152b7d331a8d2] ['Traceback (most recent call last):\n', ' File "/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py", line 430, in \_process\_data\n rval = self.proxy.dispatch(ctxt, version, method, \*\*args)\n', ' File "/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/dispatcher.py", line 133, in dispatch\n return getattr(proxyobj, method)(ctxt, \*\*kwargs)\n', ' File "/usr/lib/python2.7/dist-packages/nova/compute/manager.py", line 3273, in post\_live\_migration\_at\_destination\n block\_migration, block\_device\_info)\n', ' File "/usr/lib/python2.7/dist-packages/nova/virt/xenapi/driver.py", line 521, in post\_live\_migration\_at\_destination\n self.\_vmops.post\_live\_migration\_a...

[Read more...](/nova/%2Bbug/1202266/comments/28)

I just and it's not working for me.
However, I get the following error in the nova-compute.log:
2013-09-18 14:46:10.972 INFO nova.compute.manager [req-629ff9d2-fb6c-4c83-a672-e5aecd36cb20 8ca2f0ccd55f4d9ba53847755f2e0b18 10c16ce5ffb54c56925152b7d331a8d2] [instance: f521d7f2-d27f-40ff-81da-d1a25a5b69ac] Post operation of migration started
2013-09-18 14:46:12.221 ERROR nova.openstack.common.rpc.amqp [req-629ff9d2-fb6c-4c83-a672-e5aecd36cb20 8ca2f0ccd55f4d9ba53847755f2e0b18 10c16ce5ffb54c56925152b7d331a8d2] Exception during message handling
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp File "/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py", line 430, in \_process\_data
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp rval = self.proxy.dispatch(ctxt, version, method, \*\*args)
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp File "/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/dispatcher.py", line 133, in dispatch
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp return getattr(proxyobj, method)(ctxt, \*\*kwargs)
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp File "/usr/lib/python2.7/dist-packages/nova/compute/manager.py", line 3273, in post\_live\_migration\_at\_destination
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp block\_migration, block\_device\_info)
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp File "/usr/lib/python2.7/dist-packages/nova/virt/xenapi/driver.py", line 521, in post\_live\_migration\_at\_destination
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp self.\_vmops.post\_live\_migration\_at\_destination(ctxt, instance\_ref,
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp AttributeError: 'VMOps' object has no attribute 'post\_live\_migration\_at\_destination'
2013-09-18 14:46:12.221 1418 TRACE nova.openstack.common.rpc.amqp
2013-09-18 14:46:12.230 ERROR nova.openstack.common.rpc.common [req-629ff9d2-fb6c-4c83-a672-e5aecd36cb20 8ca2f0ccd55f4d9ba53847755f2e0b18 10c16ce5ffb54c56925152b7d331a8d2] Returning exception 'VMOps' object has no attribute 'post\_live\_migration\_at\_destination' to caller
2013-09-18 14:46:12.230 ERROR nova.openstack.common.rpc.common [req-629ff9d2-fb6c-4c83-a672-e5aecd36cb20 8ca2f0ccd55f4d9ba53847755f2e0b18 10c16ce5ffb54c56925152b7d331a8d2] ['Traceback (most recent call last):\n', ' File "/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py", line 430, in \_process\_data\n rval = self.proxy.dispatch(ctxt, version, method, \*\*args)\n', ' File "/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/dispatcher.py", line 133, in dispatch\n return getattr(proxyobj, method)(ctxt, \*\*kwargs)\n', ' File "/usr/lib/python2.7/dist-packages/nova/compute/manager.py", line 3273, in post\_live\_migration\_at\_destination\n block\_migration, block\_device\_info)\n', ' File "/usr/lib/python2.7/dist-packages/nova/virt/xenapi/driver.py", line 521, in post\_live\_migration\_at\_destination\n self.\_vmops.post\_live\_migration\_at\_destination(ctxt, instance\_ref,\n', "AttributeError: 'VMOps' object has no attribute 'post\_live\_migration\_at\_destination'\n"]
I have tried to patch the files "nova/virt/xenapi/driver.py" and "nova/virt/xenapi/vmops.py" according to John's commit in the openstack nova compute XCP virtual machines in both nodes participating in the live migration.
Am I doing anything wrong? Maybe I need to patch something more since I am on Grizzly and not trunk?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-09-20: |  |  | [#29](/nova/%2Bbug/1202266/comments/29) |
| --- | --- | --- | --- |

@Vangelis sorry, it will need to be against trunk, a lot of that code has changed recently :(

I could try a backport to grizzly.

@Vangelis sorry, it will need to be against trunk, a lot of that code has changed recently :(
I could try a backport to grizzly.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-09-23: |  |  | [#30](/nova/%2Bbug/1202266/comments/30) |
| --- | --- | --- | --- |

@John Garbutt: Which other versions are affected ? Looks like Grizzly is ? What about Folsom ?

@John Garbutt: Which other versions are affected ? Looks like Grizzly is ? What about Folsom ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-09-27:  [**Fix merged to nova (master)**](/nova/%2Bbug/1202266/comments/31) |  |  | [#31](/nova/%2Bbug/1202266/comments/31) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/46313>

Committed: <http://github.com/openstack/nova/commit/5cced7a6dd32d231c606e25dbf762d199bf9cca7>

Submitter: Jenkins

Branch: master

commit 5cced7a6dd32d231c606e25dbf762d199bf9cca7

Author: John Garbutt <email address hidden>

Date: Thu Sep 12 18:11:49 2013 +0100

xenapi: enforce filters after live-migration

Currently and network filters, including security groups, are

    lost after a server has been live-migrated.

This partially fixes the issue by ensuring that security groups are

    re-applied to the VM once it reached the destination, and been started.

This leaves a small amount of time during the live-migrate where the VM

    is not protected. There is a further bug raised to close the rest of

    this whole, but this helps keep the VM protected for the majority of the

    time.

Fixes [bug 1202266](/bugs/1202266)

Change-Id: I84fdb6e2a8ee38d75f243aadbe79945af1d6849d

Reviewed: https://review.openstack.org/46313
Committed: http://github.com/openstack/nova/commit/5cced7a6dd32d231c606e25dbf762d199bf9cca7
Submitter: Jenkins
Branch: master
commit 5cced7a6dd32d231c606e25dbf762d199bf9cca7
Author: John Garbutt <john.garbutt@rackspace.com>
Date: Thu Sep 12 18:11:49 2013 +0100
xenapi: enforce filters after live-migration
Currently and network filters, including security groups, are
lost after a server has been live-migrated.
This partially fixes the issue by ensuring that security groups are
re-applied to the VM once it reached the destination, and been started.
This leaves a small amount of time during the live-migrate where the VM
is not protected. There is a further bug raised to close the rest of
this whole, but this helps keep the VM protected for the majority of the
time.
Fixes bug 1202266
Change-Id: I84fdb6e2a8ee38d75f243aadbe79945af1d6849d

| Changed in nova: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-09-27:  [**Re: xenapi: secgroups are not in place after live-migration**](/nova/%2Bbug/1202266/comments/32) |  |  | [#32](/nova/%2Bbug/1202266/comments/32) |
| --- | --- | --- | --- |

Can we have backports to nova's stable/grizzly branch (and stable/folsom if affected similarly)?

Can we have backports to nova's stable/grizzly branch (and stable/folsom if affected similarly)?

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-10-03

| Changed in nova: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-10-09: |  |  | [#33](/nova/%2Bbug/1202266/comments/33) |
| --- | --- | --- | --- |

Any information on which stable release branches are/were affected by this (if any)? We'll want bug tasks and backports for them as far back as folsom if possible.

Any information on which stable release branches are/were affected by this (if any)? We'll want bug tasks and backports for them as far back as folsom if possible.

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-10-17

| Changed in nova: | |
| --- | --- |
| **milestone**: | havana-rc1 → 2013.2 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-10-21: |  |  | [#34](/nova/%2Bbug/1202266/comments/34) |
| --- | --- | --- | --- |

This one is since folsom, when live-migrate landed, totally my bad:

[https://blueprints.launchpad.net/nova/+spec/xenapi-live-migration](https://blueprints.launchpad.net/nova/%2Bspec/xenapi-live-migration)

The backport should be more straight forward for this one, although there has been quite a lot of rework around live-migrate recently, it shouldn't fundamentally change things.

Sorry for the delay, seem to have lost the updates on this in the regular email soup.

This one is since folsom, when live-migrate landed, totally my bad:
https://blueprints.launchpad.net/nova/+spec/xenapi-live-migration
The backport should be more straight forward for this one, although there has been quite a lot of rework around live-migrate recently, it shouldn't fundamentally change things.
Sorry for the delay, seem to have lost the updates on this in the regular email soup.

| **tags**: | added: folsom-backport-potential grizzly-backport-potential |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-10-21: |  |  | [#35](/nova/%2Bbug/1202266/comments/35) |
| --- | --- | --- | --- |

Great--thanks! I'll work on the combined impact description in [bug 1073306](/bugs/1073306) for now.

Great--thanks! I'll work on the combined impact description in bug 1073306 for now.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-10-21: |  |  | [#36](/nova/%2Bbug/1202266/comments/36) |
| --- | --- | --- | --- |

I have a first attempt at some backports here:

<https://review.openstack.org/#/c/52987/>

<https://review.openstack.org/#/c/52989/>

I have a first attempt at some backports here:
https://review.openstack.org/#/c/52987/
https://review.openstack.org/#/c/52989/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-10-21: |  |  | [#37](/nova/%2Bbug/1202266/comments/37) |
| --- | --- | --- | --- |

Vangelis: do you have an affiliation with any employer you want mentioned as part of your reporter credit on the security advisory for this issue?

Vangelis: do you have an affiliation with any employer you want mentioned as part of your reporter credit on the security advisory for this issue?

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2013-10-21

| Changed in ossa: | |
| --- | --- |
| **status**: | Confirmed → Triaged |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Vangelis Tasoulas (cyberang3l)](https://launchpad.net/~cyberang3l) wrote on 2013-10-22: |  |  | [#38](/nova/%2Bbug/1202266/comments/38) |
| --- | --- | --- | --- |

Jeremy: No employer needs to be mentioned, thanks :)

Jeremy: No employer needs to be mentioned, thanks :)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-10-31:  [**Fix merged to nova (stable/grizzly)**](/nova/%2Bbug/1202266/comments/39) |  |  | [#39](/nova/%2Bbug/1202266/comments/39) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/52987>

Committed: <http://github.com/openstack/nova/commit/df2ea2e3acdede21b40d47b7adbeac04213d031b>

Submitter: Jenkins

Branch: stable/grizzly

commit df2ea2e3acdede21b40d47b7adbeac04213d031b

Author: John Garbutt <email address hidden>

Date: Thu Sep 12 18:11:49 2013 +0100

xenapi: enforce filters after live-migration

Currently and network filters, including security groups, are

    lost after a server has been live-migrated.

This partially fixes the issue by ensuring that security groups are

    re-applied to the VM once it reached the destination, and been started.

This leaves a small amount of time during the live-migrate where the VM

    is not protected. There is a further bug raised to close the rest of

    this whole, but this helps keep the VM protected for the majority of the

    time.

Fixes [bug 1202266](/bugs/1202266)

(Cherry picked from commit: 5cced7a6dd32d231c606e25dbf762d199bf9cca7)

Change-Id: I66bc7af1c6da74e18dce47180af0cb6020ba2c1a

Reviewed: https://review.openstack.org/52987
Committed: http://github.com/openstack/nova/commit/df2ea2e3acdede21b40d47b7adbeac04213d031b
Submitter: Jenkins
Branch: stable/grizzly
commit df2ea2e3acdede21b40d47b7adbeac04213d031b
Author: John Garbutt <john.garbutt@rackspace.com>
Date: Thu Sep 12 18:11:49 2013 +0100
xenapi: enforce filters after live-migration
Currently and network filters, including security groups, are
lost after a server has been live-migrated.
This partially fixes the issue by ensuring that security groups are
re-applied to the VM once it reached the destination, and been started.
This leaves a small amount of time during the live-migrate where the VM
is not protected. There is a further bug raised to close the rest of
this whole, but this helps keep the VM protected for the majority of the
time.
Fixes bug 1202266
(Cherry picked from commit: 5cced7a6dd32d231c606e25dbf762d199bf9cca7)
Change-Id: I66bc7af1c6da74e18dce47180af0cb6020ba2c1a

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2013-11-03

| Changed in ossa: | |
| --- | --- |
| **status**: | Triaged → In Progress |

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2013-11-03

| **summary**: | - xenapi: secgroups are not in place after live-migration+ xenapi: secgroups are not in place after live-migration (CVE-2013-4497) |
| --- | --- |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-11-13

| **no longer affects**: | nova/folsom |
| --- | --- |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-11-14

| Changed in ossa: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-11-15: |  |  | [#40](/nova/%2Bbug/1202266/comments/40) |
| --- | --- | --- | --- |

[OSSA 2013-030]

[OSSA 2013-030]

| **summary**: | - xenapi: secgroups are not in place after live-migration (CVE-2013-4497)+ [OSSA 2013-030] xenapi: secgroups are not in place after live-migration+ (CVE-2013-4497) |
| --- | --- |
| Changed in ossa: | |
| **status**: | Fix Committed → Fix Released |

[Alan Pevec (apevec)](https://launchpad.net/~apevec)
on 2014-03-20

| **tags**: | removed: folsom-backport-potential grizzly-backport-potential |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/nova/%2Bbug/1202266/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/nova/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/nova/%2Bbug/1202266/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/nova/%2Bbug/1202266/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/nova/%2Bbug/1202266/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.openwall.com_219bac87_20250126_003012.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[thread-next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20131103160706.GC2305@openstack.org>
Date: Sun, 3 Nov 2013 16:07:06 +0000
From: Jeremy Stanley <jeremy@...nstack.org>
To: oss-security@...ts.openwall.com
Subject: CVE request for a vulnerability in OpenStack Nova

A vulnerability was discovered in OpenStack (see below). In order to
ensure full traceability, we need a CVE number assigned that we can
attach to further notifications. This issue is already public,
although an advisory was not sent yet.

Title: XenAPI security groups not kept through migrate or resize
Reporter: Chris Behrens (Rackspace) and Vangelis Tasoulas
Products: Nova
Affects: Folsom, Grizzly

Description:
Chris Behrens with Rackspace and Vangelis Tasoulas reported a set of
vulnerabilities in OpenStack Nova. When migrating or resizing an
instance, including live migration, existing security groups may not
be reapplied after the operation completes. This can lead to
unintentional network exposure for virtual machines. Only setups
using the XenAPI backend are affected.

References:
<https://launchpad.net/bugs/1073306>
<https://launchpad.net/bugs/1202266>

Thanks in advance,

--
Jeremy Stanley
OpenStack Vulnerability Management Team

Download attachment "[signature.asc](2/1)" of type "application/pgp-signature" (967 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from launchpad.net_22884c23_20250126_130746.html ===

[Log in / Register](https://launchpad.net/~fungi/%2Blogin)

[![](https://launchpadlibrarian.net/112681987/gnome-gmush-64.png)](https://launchpad.net/~fungi)

## [Jeremy Stanley](https://launchpad.net/~fungi)

* Overview
* [Code](https://code.launchpad.net/~fungi)
* [Bugs](https://bugs.launchpad.net/~fungi)
* [Blueprints](https://blueprints.launchpad.net/~fungi)
* [Translations](https://translations.launchpad.net/~fungi)
* [Answers](https://answers.launchpad.net/~fungi)

<http://fungi.yuggoth.org/>

* [Related packages](https://launchpad.net/~fungi/%2Brelated-packages)
* [Related projects](https://launchpad.net/~fungi/%2Brelated-projects)

## User information

Launchpad Id:
fungi

Email:
[Log in](%2Blogin) for email information.

Member since:
2006-06-16

[![Icon of Nova Bug Team](https://launchpadlibrarian.net/108832444/bug.gif "Member of Nova Bug Team")](/~nova-bugs)
[![Icon of Nova](https://launchpadlibrarian.net/52560219/os14.png "Member of Nova")](/~nova)
[![Icon of OpenStack Security SIG](https://launchpadlibrarian.net/203991792/os14.png "Member of OpenStack Security SIG")](/~openstack-ossg)
[![Icon of OpenStack Team](https://launchpadlibrarian.net/52313052/os14.png "Member of OpenStack Team")](/~openstack)
[![Icon of OpenStack Vulnerability Management team](https://launchpadlibrarian.net/83816787/icon.png "Member of OpenStack Vulnerability Management team")](/~openstack-vuln-mgmt)
[![Icon of Python OpenStack Client Bugs](https://launchpadlibrarian.net/697274771/osc-icon.png "Member of Python OpenStack Client Bugs")](/~python-openstackclient-bugs)
[![Icon of Python OpenStack Client](https://launchpadlibrarian.net/697274843/osc-icon.png "Member of Python OpenStack Client")](/~python-openstackclient)
[![Icon of Swift](https://launchpadlibrarian.net/52560230/os14.png "Member of Swift")](/~swift)

Languages:

English

OpenPGP keys:

97AE496FC02DEC9FC353B2E748F9961143495829

SSH keys:

[fungi@yuggoth.org](%2Bsshkeys)

Time zone:

UTC
(UTC+0000)

Karma:
[309](https://launchpad.net/~fungi/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**fungi**
 on
**irc.libera.chat**

![IRC](/@@/social-irc "IRC")
**fungi**
 on
**irc.oftc.net**

## [All bugs in progress](https://launchpad.net/~fungi/%2Bassignedbugs?search=Search&field.status=In+Progress) Assigned bugs

||  | #1354829 [Booting from stale snapshots in rax-dfw leads to miscellaneous failures](https://bugs.launchpad.net/openstack-ci/%2Bbug/1354829) |  |
| --- | --- | --- |
| in [OpenStack Core Infrastructure](/openstack-ci), [OpenStack Dashboard (Horizon)](/horizon), [neutron](/neutron), [tempest](/tempest) | | |

| --- | --- | --- | --- | --- | --- |

## [All memberships](https://launchpad.net/~fungi/%2Bparticipation) Latest memberships

| [Oslo Core security contacts](/~oslo-coresec)  Joined on 2023-10-02 | |
| --- | --- |
| [Glance Release](/~glance-release)  Joined on 2021-07-27 | |
| [Ubuntu SSO 2-factor testers](/~sso-2f-testers)  Joined on 2020-11-12 | |
| [OpenDev Two-Factor Authentication](/~opendev-2fa)  Joined on 2020-11-05 | |
| [Trove Drivers](/~trove-drivers)  Joined on 2020-06-22 | |

## [Recent activities](https://launchpad.net/~fungi/%2Bkarma) Most active in

| [OpenStack Security Advisory](/ossa) |  |  |
| --- | --- | --- |
| [OpenStack Compute (nova)](/nova) |  |  |
| [Ubuntu](/ubuntu) |  |  |
| [OpenStack Security Notes](/ossn) |  |  |
| [Ubuntu Cloud Archive](/cloud-archive) |  |  |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_774ad727_20250126_130741.html ===

[Log in / Register](https://bugs.launchpad.net/nova/%2Bbug/1073306/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* [Translations](https://translations.launchpad.net/nova)
* [Answers](https://answers.launchpad.net/nova)

# [OSSA 2013-030] xenapi migrations don't apply security group filters (CVE-2013-4497)

Bug #1073306 reported by
[Chris Behrens](https://launchpad.net/~cbehrens)
on 2012-10-30

[258](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Compute (nova)](https://bugs.launchpad.net/nova) | Fix Released | High | [John Garbutt](https://launchpad.net/~johngarbutt) | [OpenStack Compute (nova) 2013.2 "havana"](https://launchpad.net/nova/%2Bmilestone/2013.2) |
|  | [Grizzly](https://bugs.launchpad.net/nova/grizzly) | Fix Released | High | [John Garbutt](https://launchpad.net/~johngarbutt) | [OpenStack Compute (nova) 2013.1.5](https://launchpad.net/nova/%2Bmilestone/2013.1.5) |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | High | [Jeremy Stanley](https://launchpad.net/~fungi) |  |

### Bug Description

xenapi's finish\_migration() is missing code to apply security group rules, etc. There's code in spawn() that appears we need to also use in finish\_migration().

(Somewhat related, see: <https://bugs.launchpad.net/bugs/1073303>)

Tags:

[xenserver](/nova/%2Bbugs?field.tag=xenserver)

## CVE References

* [2013-4497](/bugs/cve/2013-4497 "The XenAPI backend in OpenStack Compu...")

[Chris Behrens (cbehrens)](https://launchpad.net/~cbehrens)
on 2012-10-30

| Changed in nova: | |
| --- | --- |
| **importance**: | Undecided → Medium |
| **status**: | New → Triaged |

[John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt)
on 2013-05-22

| **tags**: | added: xenserver |
| --- | --- |

[Euan Harris (euanh)](https://launchpad.net/~euanh)
on 2013-06-24

| Changed in nova: | |
| --- | --- |
| **assignee**: | nobody → Euan Harris (euanh) |

[Euan Harris (euanh)](https://launchpad.net/~euanh)
on 2013-07-15

| Changed in nova: | |
| --- | --- |
| **status**: | Triaged → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-07-24: |  |  | [#1](/nova/%2Bbug/1073306/comments/1) |
| --- | --- | --- | --- |

This seems to have got fixed by the work on:

[https://bugs.launchpad.net/nova/+bug/1073303](https://bugs.launchpad.net/nova/%2Bbug/1073303)

Sorry for the clash, but would really appreciate you checking I have made the same changes.

This seems to have got fixed by the work on:
https://bugs.launchpad.net/nova/+bug/1073303
Sorry for the clash, but would really appreciate you checking I have made the same changes.

[OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack)
on 2013-07-24

| Changed in nova: | |
| --- | --- |
| **assignee**: | Euan Harris (euanh) → John Garbutt (johngarbutt) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Euan Harris (euanh)](https://launchpad.net/~euanh) wrote on 2013-07-24: |  |  | [#2](/nova/%2Bbug/1073306/comments/2) |
| --- | --- | --- | --- |

No problem.

This bug also affects live migration, and that's what I had been working on. Does your patch fix the problem for live migration too?

No problem.
This bug also affects live migration, and that's what I had been working on. Does your patch fix the problem for live migration too?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-08-21: |  |  | [#3](/nova/%2Bbug/1073306/comments/3) |
| --- | --- | --- | --- |

The bug tracking live migration is [bug 1202266](/bugs/1202266)

The bug tracking live migration is bug 1202266

| **information type**: | Public → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-08-21: |  |  | [#4](/nova/%2Bbug/1073306/comments/4) |
| --- | --- | --- | --- |

Shall be a common OSSA with 1202266

Shall be a common OSSA with 1202266

| Changed in ossa: | |
| --- | --- |
| **importance**: | Undecided → High |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Bob Ball (bob-ball)](https://launchpad.net/~bob-ball) wrote on 2013-08-21: |  |  | [#5](/nova/%2Bbug/1073306/comments/5) |
| --- | --- | --- | --- |

John/Euan, can you confirm that <https://review.openstack.org/#/c/38455/> will fix this once it is merged?

If so, we should merge the defects and update the flags to ensure that [https://bugs.launchpad.net/nova/+bug/1073303](https://bugs.launchpad.net/nova/%2Bbug/1073303) is high priority.

John/Euan, can you confirm that https://review.openstack.org/#/c/38455/ will fix this once it is merged?
If so, we should merge the defects and update the flags to ensure that https://bugs.launchpad.net/nova/+bug/1073303 is high priority.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-08-30: |  |  | [#6](/nova/%2Bbug/1073306/comments/6) |
| --- | --- | --- | --- |

<https://review.openstack.org/#/c/38455/>

As mentioned in the commit, will fix both this and:

[https://bugs.launchpad.net/nova/+bug/1073303](https://bugs.launchpad.net/nova/%2Bbug/1073303)

They are quite different bugs, fixed by the same tidy up (sharing more code between spawn and finish\_migrate).

It will not fix:

[https://bugs.launchpad.net/nova/+bug/1202266](https://bugs.launchpad.net/nova/%2Bbug/1202266)

I didn't consider this high, because it is a side feature, but that is debatable I guess.

https://review.openstack.org/#/c/38455/
As mentioned in the commit, will fix both this and:
https://bugs.launchpad.net/nova/+bug/1073303
They are quite different bugs, fixed by the same tidy up (sharing more code between spawn and finish\_migrate).
It will not fix:
https://bugs.launchpad.net/nova/+bug/1202266
I didn't consider this high, because it is a side feature, but that is debatable I guess.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-09-09: |  |  | [#7](/nova/%2Bbug/1073306/comments/7) |
| --- | --- | --- | --- |

In response to Thierry's comment #4, I'm unsure how we'll be able to issue a common OSSA if the proposed fix does not address [bug 1202266](/bugs/1202266). Should we hold the advisory until such time as fixes for both are ready, or do they need to diverge?

In response to Thierry's comment #4, I'm unsure how we'll be able to issue a common OSSA if the proposed fix does not address bug 1202266. Should we hold the advisory until such time as fixes for both are ready, or do they need to diverge?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-09-10: |  |  | [#8](/nova/%2Bbug/1073306/comments/8) |
| --- | --- | --- | --- |

@Jeremy: given that this is public, if one is really ready before the other, then they probably need to diverge. Maybe we should mention the live-migration issue in the migration CVE so that people know the workaround (reapply security groups after live migration).

@Jeremy: given that this is public, if one is really ready before the other, then they probably need to diverge. Maybe we should mention the live-migration issue in the migration CVE so that people know the workaround (reapply security groups after live migration).

| Changed in nova: | |
| --- | --- |
| **milestone**: | none → havana-rc1 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-09-10: |  |  | [#9](/nova/%2Bbug/1073306/comments/9) |
| --- | --- | --- | --- |

+1

I will try get someone to look at the live-migrate issue in the XAPI meeting, if not in progress before that.

+1
I will try get someone to look at the live-migrate issue in the XAPI meeting, if not in progress before that.

| Changed in nova: | |
| --- | --- |
| **importance**: | Medium → High |

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2013-09-17

| Changed in ossa: | |
| --- | --- |
| **assignee**: | nobody → Jeremy Stanley (fungi) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-09-17: |  |  | [#10](/nova/%2Bbug/1073306/comments/10) |
| --- | --- | --- | --- |

The proposedfix for this vulnerability is last in a series of 6 relatively substantial changes for nova, none of which currently have any core reviews on them whatsoever. Are all these patches granted a freeze exception, or would it be possible to divorce this fix from some/all of the other changes in that series to expedite resolution so we can publish an advisory?

The proposedfix for this vulnerability is last in a series of 6 relatively substantial changes for nova, none of which currently have any core reviews on them whatsoever. Are all these patches granted a freeze exception, or would it be possible to divorce this fix from some/all of the other changes in that series to expedite resolution so we can publish an advisory?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-09-20:  [**Fix merged to nova (master)**](/nova/%2Bbug/1073306/comments/11) |  |  | [#11](/nova/%2Bbug/1073306/comments/11) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/38455>

Committed: <http://github.com/openstack/nova/commit/ba0d007fb78bd1182c3c0b808dbd7ccc84640e80>

Submitter: Jenkins

Branch: master

commit ba0d007fb78bd1182c3c0b808dbd7ccc84640e80

Author: John Garbutt <email address hidden>

Date: Wed Jul 24 13:15:03 2013 +0100

xenapi: ensure finish\_migration cleans on errors

This change makes finish\_migration share code with spawn.

This fixes some inconsistencies, such as applying the security

    group filters during finish\_migration.

Fixes [bug 1073303](/bugs/1073303)

    Fixes [bug 1073306](/bugs/1073306)

Change-Id: Ib4f2a96618692c141708535f9463c856f3395922

Reviewed: https://review.openstack.org/38455
Committed: http://github.com/openstack/nova/commit/ba0d007fb78bd1182c3c0b808dbd7ccc84640e80
Submitter: Jenkins
Branch: master
commit ba0d007fb78bd1182c3c0b808dbd7ccc84640e80
Author: John Garbutt <john.garbutt@rackspace.com>
Date: Wed Jul 24 13:15:03 2013 +0100
xenapi: ensure finish\_migration cleans on errors
This change makes finish\_migration share code with spawn.
This fixes some inconsistencies, such as applying the security
group filters during finish\_migration.
Fixes bug 1073303
Fixes bug 1073306
Change-Id: Ib4f2a96618692c141708535f9463c856f3395922

| Changed in nova: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-09-20:  [**Re: xenapi migrations don't apply security group filters**](/nova/%2Bbug/1073306/comments/12) |  |  | [#12](/nova/%2Bbug/1073306/comments/12) |
| --- | --- | --- | --- |

Great! Does this also effect Grizzly? Folsom? (Need backports for those if so.) Also if it affects Essex or earlier, that will incluence the wording in the impact description somewhat as well.

Great! Does this also effect Grizzly? Folsom? (Need backports for those if so.) Also if it affects Essex or earlier, that will incluence the wording in the impact description somewhat as well.

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-10-03

| Changed in nova: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-10-09: |  |  | [#13](/nova/%2Bbug/1073306/comments/13) |
| --- | --- | --- | --- |

Any information on which stable release branches are/were affected by this (if any)? We'll want bug tasks and backports for them as far back as folsom if possible.

Any information on which stable release branches are/were affected by this (if any)? We'll want bug tasks and backports for them as far back as folsom if possible.

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-10-17

| Changed in nova: | |
| --- | --- |
| **milestone**: | havana-rc1 → 2013.2 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-10-21: |  |  | [#14](/nova/%2Bbug/1073306/comments/14) |
| --- | --- | --- | --- |

So, I think this has been an issue since essex, when security groups and migration were both present:

[https://blueprints.launchpad.net/nova/+spec/xenapi-security-groups](https://blueprints.launchpad.net/nova/%2Bspec/xenapi-security-groups)

It hasn't really been tested much since then mind :(

We will need a simpler fix to backport, but its really just a cut and paste from the spawn code to the finish\_migrate (which is the issue I fixed with my patch).

So, I think this has been an issue since essex, when security groups and migration were both present:
https://blueprints.launchpad.net/nova/+spec/xenapi-security-groups
It hasn't really been tested much since then mind :(
We will need a simpler fix to backport, but its really just a cut and paste from the spawn code to the finish\_migrate (which is the issue I fixed with my patch).

[John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt)
on 2013-10-21

| **tags**: | added: folsom-backport-potential grizzly-backport-potential |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-10-21: |  |  | [#15](/nova/%2Bbug/1073306/comments/15) |
| --- | --- | --- | --- |

@ Jeremy Stanley (fungi) this also applies to resizes, so a resize would also drop the firewall rules.

@ Jeremy Stanley (fungi) this also applies to resizes, so a resize would also drop the firewall rules.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-10-21: |  |  | [#16](/nova/%2Bbug/1073306/comments/16) |
| --- | --- | --- | --- |

This is a pain to backport given the changes, gone for a possible minimal fix:

<https://review.openstack.org/#/c/52991/>

<https://review.openstack.org/#/c/52992/>

This is a pain to backport given the changes, gone for a possible minimal fix:
https://review.openstack.org/#/c/52991/
https://review.openstack.org/#/c/52992/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-10-21: |  |  | [#17](/nova/%2Bbug/1073306/comments/17) |
| --- | --- | --- | --- |

Proposed impact description (covers this bug and [bug 1202266](/bugs/1202266)):

----

Title: XenAPI security groups not kept through migrate or resize

Reporter: Chris Behrens (Rackspace) and Vangelis Tasoulas

Products: Nova

Affects: all releases

Description:

Chris Behrens with Rackspace and Vangelis Tasoulas reported a set of vulnerabilities in OpenStack Nova. When migrating or resizing a virtual machine, security groups may not be applied after the operation completes. Only setups using the XenAPI backend are affected. This issue also affects live migrations, introduced in the Folsom (2012.2) release.

Proposed impact description (covers this bug and bug 1202266):
----
Title: XenAPI security groups not kept through migrate or resize
Reporter: Chris Behrens (Rackspace) and Vangelis Tasoulas
Products: Nova
Affects: all releases
Description:
Chris Behrens with Rackspace and Vangelis Tasoulas reported a set of vulnerabilities in OpenStack Nova. When migrating or resizing a virtual machine, security groups may not be applied after the operation completes. Only setups using the XenAPI backend are affected. This issue also affects live migrations, introduced in the Folsom (2012.2) release.

| Changed in ossa: | |
| --- | --- |
| **status**: | Confirmed → Triaged |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-10-22: |  |  | [#18](/nova/%2Bbug/1073306/comments/18) |
| --- | --- | --- | --- |

I would say "affects: Folsom, Grizzly" and precise that Havana is not affected.

also maybe "existing security groups may not be reapplied"

I would also add a sentence about impact (instances not as protected as one may think)

I would say "affects: Folsom, Grizzly" and precise that Havana is not affected.
also maybe "existing security groups may not be reapplied"
I would also add a sentence about impact (instances not as protected as one may think)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-10-24: |  |  | [#19](/nova/%2Bbug/1073306/comments/19) |
| --- | --- | --- | --- |

Updated impact description (covers this bug and [bug 1202266](/bugs/1202266)):

----

Title: XenAPI security groups not kept through migrate or resize

Reporter: Chris Behrens (Rackspace) and Vangelis Tasoulas

Products: Nova

Affects: Folsom, Grizzly

Description:

Chris Behrens with Rackspace and Vangelis Tasoulas reported a set of vulnerabilities in OpenStack Nova. When migrating or resizing an instance, including live migration, existing security groups may not be reapplied after the operation completes. This can lead to unintentional network exposure for virtual machines. Only setups using the XenAPI backend are affected.

Updated impact description (covers this bug and bug 1202266):
----
Title: XenAPI security groups not kept through migrate or resize
Reporter: Chris Behrens (Rackspace) and Vangelis Tasoulas
Products: Nova
Affects: Folsom, Grizzly
Description:
Chris Behrens with Rackspace and Vangelis Tasoulas reported a set of vulnerabilities in OpenStack Nova. When migrating or resizing an instance, including live migration, existing security groups may not be reapplied after the operation completes. This can lead to unintentional network exposure for virtual machines. Only setups using the XenAPI backend are affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-10-24: |  |  | [#20](/nova/%2Bbug/1073306/comments/20) |
| --- | --- | --- | --- |

Impact desc looks good to me.

Impact desc looks good to me.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-10-31:  [**Fix merged to nova (stable/grizzly)**](/nova/%2Bbug/1073306/comments/21) |  |  | [#21](/nova/%2Bbug/1073306/comments/21) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/52991>

Committed: <http://github.com/openstack/nova/commit/01de658210fd65171bfbf5450c93673b5ce0bd9e>

Submitter: Jenkins

Branch: stable/grizzly

commit 01de658210fd65171bfbf5450c93673b5ce0bd9e

Author: John Garbutt <email address hidden>

Date: Mon Oct 21 19:34:43 2013 +0100

xenapi: apply firewall rules in finish\_migrate

When security groups were added, the rules were not re-applied to

    servers that have been migrated to a new hypervisor.

This change ensures the firewall rules are applied as part of creating

    the new VM in finish\_migrate. This code follows a very similar pattern

    to the code in spawn, and that is where the cut and paste code comes

    from. This code duplication was removed in Havana.

Fixes [bug 1073306](/bugs/1073306)

Change-Id: I6295a782df328a759e358fb82b76dd3f7bd4b39e

Reviewed: https://review.openstack.org/52991
Committed: http://github.com/openstack/nova/commit/01de658210fd65171bfbf5450c93673b5ce0bd9e
Submitter: Jenkins
Branch: stable/grizzly
commit 01de658210fd65171bfbf5450c93673b5ce0bd9e
Author: John Garbutt <john.garbutt@rackspace.com>
Date: Mon Oct 21 19:34:43 2013 +0100
xenapi: apply firewall rules in finish\_migrate
When security groups were added, the rules were not re-applied to
servers that have been migrated to a new hypervisor.
This change ensures the firewall rules are applied as part of creating
the new VM in finish\_migrate. This code follows a very similar pattern
to the code in spawn, and that is where the cut and paste code comes
from. This code duplication was removed in Havana.
Fixes bug 1073306
Change-Id: I6295a782df328a759e358fb82b76dd3f7bd4b39e

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2013-11-03

| Changed in ossa: | |
| --- | --- |
| **status**: | Triaged → In Progress |

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2013-11-03

| **summary**: | - xenapi migrations don't apply security group filters+ xenapi migrations don't apply security group filters (CVE-2013-4497) |
| --- | --- |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-11-13

| **no longer affects**: | nova/folsom |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-11-13:  [**Re: xenapi migrations don't apply security group filters (CVE-2013-4497)**](/nova/%2Bbug/1073306/comments/22) |  |  | [#22](/nova/%2Bbug/1073306/comments/22) |
| --- | --- | --- | --- |

Finalized impact description being used in advisory (also covers [bug 1202266](/bugs/1202266)):

----

Title: XenAPI security groups not kept through migrate or resize

Reporter: Chris Behrens (Rackspace) and Vangelis Tasoulas

Products: Nova

Affects: All supported versions prior to Havana

Description:

Chris Behrens with Rackspace and Vangelis Tasoulas reported a set of vulnerabilities in OpenStack Nova's XenAPI hypervisor backend. When migrating or resizing an instance, including live migration, existing security groups may not be reapplied after the operation completes. This can lead to unintentional network exposure for virtual machines. Only setups using the XenAPI backend are affected.

Finalized impact description being used in advisory (also covers bug 1202266):
----
Title: XenAPI security groups not kept through migrate or resize
Reporter: Chris Behrens (Rackspace) and Vangelis Tasoulas
Products: Nova
Affects: All supported versions prior to Havana
Description:
Chris Behrens with Rackspace and Vangelis Tasoulas reported a set of vulnerabilities in OpenStack Nova's XenAPI hypervisor backend. When migrating or resizing an instance, including live migration, existing security groups may not be reapplied after the operation completes. This can lead to unintentional network exposure for virtual machines. Only setups using the XenAPI backend are affected.

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-11-14

| Changed in ossa: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-11-15: |  |  | [#23](/nova/%2Bbug/1073306/comments/23) |
| --- | --- | --- | --- |

[OSSA 2013-030]

[OSSA 2013-030]

| Changed in ossa: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |
| **summary**: | - xenapi migrations don't apply security group filters (CVE-2013-4497)+ [OSSA 2013-030] xenapi migrations don't apply security group filters+ (CVE-2013-4497) |

[Alan Pevec (apevec)](https://launchpad.net/~apevec)
on 2014-03-20

| **tags**: | removed: folsom-backport-potential grizzly-backport-potential |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/nova/%2Bbug/1073306/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/nova/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/nova/%2Bbug/1073306/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/nova/%2Bbug/1073306/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/nova/%2Bbug/1073306/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.openwall.com_0da1ea76_20250126_003013.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <527677FE.2020804@redhat.com>
Date: Sun, 03 Nov 2013 09:21:18 -0700
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
Subject: Re: CVE request for a vulnerability in OpenStack Nova

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 11/03/2013 09:07 AM, Jeremy Stanley wrote:
> A vulnerability was discovered in OpenStack (see below). In order
> to ensure full traceability, we need a CVE number assigned that we
> can attach to further notifications. This issue is already public,
> although an advisory was not sent yet.
>
> Title: XenAPI security groups not kept through migrate or resize
> Reporter: Chris Behrens (Rackspace) and Vangelis Tasoulas Products:
> Nova Affects: Folsom, Grizzly
>
> Description: Chris Behrens with Rackspace and Vangelis Tasoulas
> reported a set of vulnerabilities in OpenStack Nova. When migrating
> or resizing an instance, including live migration, existing
> security groups may not be reapplied after the operation completes.
> This can lead to unintentional network exposure for virtual
> machines. Only setups using the XenAPI backend are affected.
>
> References: <https://launchpad.net/bugs/1073306>
> <https://launchpad.net/bugs/1202266>
>
> Thanks in advance,
>

Please use CVE-2013-4497 for this issue.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.15 (GNU/Linux)

iQIcBAEBAgAGBQJSdnf+AAoJEBYNRVNeJnmTZEQQAItK3aWfzjV392UCszk6P5hX
73dNS59bP4hGTQh3cSYPENl6ZkncFxj1FRQEmmHrp0TtGJaFPfOROReCHxGr0YOX
ZjIDS7jhnDLxxxwon2LqjkV/69PXfTesNDjOm/bObkXhDgM6zJrL8ba6cmHF2GJv
Ne2JAZKMXJyU9uj/0KFYltH6DZRD/CxxTdm264pd64iH0UkXb+OQg44cGcN+XyFs
y/JDluc1WiILmEC65/rP9Dv4cN0/Pt4r2KhExY0cCJ10Mhq/qIHivHviNFdcVjpu
5CBgqX6WVT+4JAPtgpXYtFbaxwQ6roAoQ+MPEgjoDOHIX0FDWlpTephzbJhVmdHi
60/5MY+tIuATSEBQW8PuqiV6gJi3UckHJmhPSze/E4JOuXeMTwjB5whEUVfy/5g6
2HMMirjwCD97dzB93NaA88h1GmBf80vfCrKnLihuO09/61HboAa7N8vh+wEFlglj
+yKFDPsGahvq0oZ4ZRvDH0GcaP/zxQw2qH2ewR0gBumT8chytQ8kRRyPU0ROSe1m
XO5BfDJi9BE8M5tChZ8LTYcLa3HMlP7VqTIbygpKfQv8fGKzIrvWfC2noTyhPo0E
8lJVOSxno8+DeyLBcP45jp+pMTTyomfo5aJzRIh8lNVccZrFV36c2uycpEOK9UVb
ElykQSGedXNXatPHFfA5
=EkPq
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from translations.launchpad.net_13b83fdf_20250126_130748.html ===

[Log in / Register](https://translations.launchpad.net/nova/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* Translations
* [Answers](https://answers.launchpad.net/nova)

# Translation overview

[Help for translations](https://help.launchpad.net/Translations)

### Translation details

Launchpad currently recommends translating
[OpenStack Compute (nova) trunk series](/nova/trunk).

To see all the translation files that are waiting to be
imported, please look at
[OpenStack Compute (nova) import queue](/nova/%2Bimports).

### Permissions

[OpenStack Compute (nova)](https://launchpad.net/nova) is translated
with [Open](/%2Bhelp-translations/permissions-policies.html)
permissions.

### All translatable series

* [OpenStack Compute (nova) trunk series](/nova/trunk/%2Btranslations)
* [OpenStack Compute (nova) bexar series](/nova/bexar/%2Btranslations)
* [OpenStack Compute (nova) cactus series](/nova/cactus/%2Btranslations)

### All translatable distribution packages

* [nova source package in Plucky](/ubuntu/plucky/%2Bsources/nova/%2Btranslations)
* [nova source package in Oracular](/ubuntu/oracular/%2Bsources/nova/%2Btranslations)
* [nova source package in Noble](/ubuntu/noble/%2Bsources/nova/%2Btranslations)
* [nova source package in Mantic](/ubuntu/mantic/%2Bsources/nova/%2Btranslations)
* [nova source package in Lunar](/ubuntu/lunar/%2Bsources/nova/%2Btranslations)
* [nova source package in Kinetic](/ubuntu/kinetic/%2Bsources/nova/%2Btranslations)
* [nova source package in Jammy](/ubuntu/jammy/%2Bsources/nova/%2Btranslations)
* [nova source package in Impish](/ubuntu/impish/%2Bsources/nova/%2Btranslations)
* [nova source package in Hirsute](/ubuntu/hirsute/%2Bsources/nova/%2Btranslations)
* [nova source package in Groovy](/ubuntu/groovy/%2Bsources/nova/%2Btranslations)
* [nova source package in Focal](/ubuntu/focal/%2Bsources/nova/%2Btranslations)
* [nova source package in Eoan](/ubuntu/eoan/%2Bsources/nova/%2Btranslations)
* [nova source package in Disco](/ubuntu/disco/%2Bsources/nova/%2Btranslations)
* [nova source package in Cosmic](/ubuntu/cosmic/%2Bsources/nova/%2Btranslations)
* [nova source package in Bionic](/ubuntu/bionic/%2Bsources/nova/%2Btranslations)
* [nova source package in Artful](/ubuntu/artful/%2Bsources/nova/%2Btranslations)
* [nova source package in Zesty](/ubuntu/zesty/%2Bsources/nova/%2Btranslations)
* [nova source package in Yakkety](/ubuntu/yakkety/%2Bsources/nova/%2Btranslations)
* [nova source package in Xenial](/ubuntu/xenial/%2Bsources/nova/%2Btranslations)
* [nova source package in Wily](/ubuntu/wily/%2Bsources/nova/%2Btranslations)
* [nova source package in Vivid](/ubuntu/vivid/%2Bsources/nova/%2Btranslations)
* [nova source package in Utopic](/ubuntu/utopic/%2Bsources/nova/%2Btranslations)
* [nova source package in Trusty](/ubuntu/trusty/%2Bsources/nova/%2Btranslations)
* [nova source package in Saucy](/ubuntu/saucy/%2Bsources/nova/%2Btranslations)
* [nova source package in Raring](/ubuntu/raring/%2Bsources/nova/%2Btranslations)
* [nova source package in Quantal](/ubuntu/quantal/%2Bsources/nova/%2Btranslations)
* [nova source package in Precise](/ubuntu/precise/%2Bsources/nova/%2Btranslations)

## Translation for trunk

| Language | Status | Untranslated | Needs review | Last Changed |
| --- | --- | --- | --- | --- |
| [Afrikaans](/nova/trunk/%2Bpots/nova/af/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/af/%2Btranslate?show=untranslated) | 254 [254](/nova/trunk/%2Bpots/nova/af/%2Btranslate?show=new_suggestions) | 2022-09-12 03:14:23 UTC 2022-09-12 |
| [Albanian](/nova/trunk/%2Bpots/nova/sq/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/sq/%2Btranslate?show=untranslated) | 0 0 | 2014-04-02 15:56:19 UTC 2014-04-02 |
| [Arabic](/nova/trunk/%2Bpots/nova/ar/%2Btranslate) | 13 099.14  0.8563899868247694% translated  99.14361001317523% untranslated | 1505 [1505](/nova/trunk/%2Bpots/nova/ar/%2Btranslate?show=untranslated) | 0 0 | 2013-02-16 21:33:39 UTC 2013-02-16 |
| [Asturian](/nova/trunk/%2Bpots/nova/ast/%2Btranslate) | 2 099.87  0.13175230566534915% translated  99.86824769433466% untranslated | 1516 [1516](/nova/trunk/%2Bpots/nova/ast/%2Btranslate?show=untranslated) | 0 0 | 2011-01-12 19:50:20 UTC 2011-01-12 |
| [Azerbaijani](/nova/trunk/%2Bpots/nova/az/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/az/%2Btranslate?show=untranslated) | 5 [5](/nova/trunk/%2Bpots/nova/az/%2Btranslate?show=new_suggestions) | 2013-04-03 14:46:02 UTC 2013-04-03 |
| [Basque](/nova/trunk/%2Bpots/nova/eu/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/eu/%2Btranslate?show=untranslated) | 0 0 | 2013-12-05 23:09:27 UTC 2013-12-05 |
| [Belarusian](/nova/trunk/%2Bpots/nova/be/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/be/%2Btranslate?show=untranslated) | 1 [1](/nova/trunk/%2Bpots/nova/be/%2Btranslate?show=new_suggestions) | 2020-05-03 16:45:18 UTC 2020-05-03 |
| [Bosnian](/nova/trunk/%2Bpots/nova/bs/%2Btranslate) | 2 099.87  0.13175230566534915% translated  99.86824769433466% untranslated | 1516 [1516](/nova/trunk/%2Bpots/nova/bs/%2Btranslate?show=untranslated) | 914 [914](/nova/trunk/%2Bpots/nova/bs/%2Btranslate?show=new_suggestions) | 2012-01-19 20:22:10 UTC 2012-01-19 |
| [Brazilian Portuguese](/nova/trunk/%2Bpots/nova/pt_BR/%2Btranslate) | 815 046.31  53.689064558629774% translated  46.31093544137022% untranslated | 703 [703](/nova/trunk/%2Bpots/nova/pt_BR/%2Btranslate?show=untranslated) | 84 [84](/nova/trunk/%2Bpots/nova/pt_BR/%2Btranslate?show=new_suggestions) | 2013-02-06 03:43:42 UTC 2013-02-06 |
| [Catalan](/nova/trunk/%2Bpots/nova/ca/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/ca/%2Btranslate?show=untranslated) | 0 0 | 2013-06-07 09:16:32 UTC 2013-06-07 |
| [Chechen](/nova/trunk/%2Bpots/nova/ce/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/ce/%2Btranslate?show=untranslated) | 0 0 | 2014-08-13 08:13:14 UTC 2014-08-13 |
| [Chinese (Hong Kong)](/nova/trunk/%2Bpots/nova/zh_HK/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/zh_HK/%2Btranslate?show=untranslated) | 0 0 | 2013-06-07 09:16:31 UTC 2013-06-07 |
| [Chinese (Simplified)](/nova/trunk/%2Bpots/nova/zh_CN/%2Btranslate) | 1518 000.00  100.0% translated | 0 0 | 106 [106](/nova/trunk/%2Bpots/nova/zh_CN/%2Btranslate?show=new_suggestions) | 2013-06-05 09:20:38 UTC 2013-06-05 |
| [Chinese (Traditional)](/nova/trunk/%2Bpots/nova/zh_TW/%2Btranslate) | 294 080.63  19.367588932806324% translated  80.63241106719367% untranslated | 1224 [1224](/nova/trunk/%2Bpots/nova/zh_TW/%2Btranslate?show=untranslated) | 30 [30](/nova/trunk/%2Bpots/nova/zh_TW/%2Btranslate?show=new_suggestions) | 2012-08-15 07:46:05 UTC 2012-08-15 |
| [Croatian](/nova/trunk/%2Bpots/nova/hr/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/hr/%2Btranslate?show=untranslated) | 0 0 | 2013-06-07 09:16:33 UTC 2013-06-07 |
| [Czech](/nova/trunk/%2Bpots/nova/cs/%2Btranslate) | 1518 000.00  100.0% translated | 0 0 | 4 [4](/nova/trunk/%2Bpots/nova/cs/%2Btranslate?show=new_suggestions) | 2013-05-12 21:44:53 UTC 2013-05-12 |
| [Danish](/nova/trunk/%2Bpots/nova/da/%2Btranslate) | 2 099.87  0.13175230566534915% translated  99.86824769433466% untranslated | 1516 [1516](/nova/trunk/%2Bpots/nova/da/%2Btranslate?show=untranslated) | 2 [2](/nova/trunk/%2Bpots/nova/da/%2Btranslate?show=new_suggestions) | 2011-01-15 21:46:58 UTC 2011-01-15 |
| [English (Australia)](/nova/trunk/%2Bpots/nova/en_AU/%2Btranslate) | 350 076.94  23.056653491436098% translated  76.9433465085639% untranslated | 1168 [1168](/nova/trunk/%2Bpots/nova/en_AU/%2Btranslate?show=untranslated) | 1166 [1166](/nova/trunk/%2Bpots/nova/en_AU/%2Btranslate?show=new_suggestions) | 2012-06-17 06:35:56 UTC 2012-06-17 |
| [English (Canada)](/nova/trunk/%2Bpots/nova/en_CA/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/en_CA/%2Btranslate?show=untranslated) | 0 0 | 2013-09-10 14:44:32 UTC 2013-09-10 |
| [English (United Kingdom)](/nova/trunk/%2Bpots/nova/en_GB/%2Btranslate) | 1518 000.00  100.0% translated | 0 0 | 10 [10](/nova/trunk/%2Bpots/nova/en_GB/%2Btranslate?show=new_suggestions) | 2013-06-04 15:36:12 UTC 2013-06-04 |
| [Filipino](/nova/trunk/%2Bpots/nova/fil/%2Btranslate) | 30 098.02  1.9762845849802373% translated  98.02371541501977% untranslated | 1488 [1488](/nova/trunk/%2Bpots/nova/fil/%2Btranslate?show=untranslated) | 0 0 | 2012-07-20 05:07:53 UTC 2012-07-20 |
| [French](/nova/trunk/%2Bpots/nova/fr/%2Btranslate) | 641 057.77  42.226613965744406% translated  57.7733860342556% untranslated | 877 [877](/nova/trunk/%2Bpots/nova/fr/%2Btranslate?show=untranslated) | 139 [139](/nova/trunk/%2Bpots/nova/fr/%2Btranslate?show=new_suggestions) | 2013-03-04 16:32:33 UTC 2013-03-04 |
| [Galician](/nova/trunk/%2Bpots/nova/gl/%2Btranslate) | 97 093.61  6.389986824769434% translated  93.61001317523056% untranslated | 1421 [1421](/nova/trunk/%2Bpots/nova/gl/%2Btranslate?show=untranslated) | 5 [5](/nova/trunk/%2Bpots/nova/gl/%2Btranslate?show=new_suggestions) | 2013-07-10 23:58:13 UTC 2013-07-10 |
| [German](/nova/trunk/%2Bpots/nova/de/%2Btranslate) | 1094 027.93  72.06851119894598% translated  27.931488801054016% untranslated | 424 [424](/nova/trunk/%2Bpots/nova/de/%2Btranslate?show=untranslated) | 31 [31](/nova/trunk/%2Bpots/nova/de/%2Btranslate?show=new_suggestions) | 2013-07-10 09:57:58 UTC 2013-07-10 |
| [Greek](/nova/trunk/%2Bpots/nova/el/%2Btranslate) | 2 099.87  0.13175230566534915% translated  99.86824769433466% untranslated | 1516 [1516](/nova/trunk/%2Bpots/nova/el/%2Btranslate?show=untranslated) | 0 0 | 2014-04-02 15:56:24 UTC 2014-04-02 |
| [Hebrew](/nova/trunk/%2Bpots/nova/he/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/he/%2Btranslate?show=untranslated) | 0 0 | 2014-03-07 06:39:29 UTC 2014-03-07 |
| [Hindi](/nova/trunk/%2Bpots/nova/hi/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/hi/%2Btranslate?show=untranslated) | 0 0 | 2013-09-09 20:15:29 UTC 2013-09-09 |
| [Hungarian](/nova/trunk/%2Bpots/nova/hu/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/hu/%2Btranslate?show=untranslated) | 0 0 | 2013-06-07 09:16:34 UTC 2013-06-07 |
| [Indonesian](/nova/trunk/%2Bpots/nova/id/%2Btranslate) | 1166 023.19  76.81159420289855% translated  23.18840579710145% untranslated | 352 [352](/nova/trunk/%2Bpots/nova/id/%2Btranslate?show=untranslated) | 4 [4](/nova/trunk/%2Bpots/nova/id/%2Btranslate?show=new_suggestions) | 2013-06-12 06:23:30 UTC 2013-06-12 |
| [Italian](/nova/trunk/%2Bpots/nova/it/%2Btranslate) | 399 073.72  26.284584980237153% translated  73.71541501976284% untranslated | 1119 [1119](/nova/trunk/%2Bpots/nova/it/%2Btranslate?show=untranslated) | 3 [3](/nova/trunk/%2Bpots/nova/it/%2Btranslate?show=new_suggestions) | 2013-04-12 14:24:26 UTC 2013-04-12 |
| [Japanese](/nova/trunk/%2Bpots/nova/ja/%2Btranslate) | 526 065.35  34.65085638998682% translated  65.34914361001317% untranslated | 992 [992](/nova/trunk/%2Bpots/nova/ja/%2Btranslate?show=untranslated) | 4 [4](/nova/trunk/%2Bpots/nova/ja/%2Btranslate?show=new_suggestions) | 2012-06-17 06:26:26 UTC 2012-06-17 |
| [Kabyle](/nova/trunk/%2Bpots/nova/kab/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/kab/%2Btranslate?show=untranslated) | 0 0 | 2020-09-26 09:29:19 UTC 2020-09-26 |
| [Kannada](/nova/trunk/%2Bpots/nova/kn/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/kn/%2Btranslate?show=untranslated) | 0 0 | 2013-10-03 20:33:34 UTC 2013-10-03 |
| [Khmer](/nova/trunk/%2Bpots/nova/km/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/km/%2Btranslate?show=untranslated) | 12 [12](/nova/trunk/%2Bpots/nova/km/%2Btranslate?show=new_suggestions) | 2013-12-05 23:09:30 UTC 2013-12-05 |
| [Korean](/nova/trunk/%2Bpots/nova/ko/%2Btranslate) | 133 091.24  8.761528326745719% translated  91.23847167325428% untranslated | 1385 [1385](/nova/trunk/%2Bpots/nova/ko/%2Btranslate?show=untranslated) | 0 0 | 2012-08-18 04:14:44 UTC 2012-08-18 |
| [Latgalian](/nova/trunk/%2Bpots/nova/ltg/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/ltg/%2Btranslate?show=untranslated) | 1 [1](/nova/trunk/%2Bpots/nova/ltg/%2Btranslate?show=new_suggestions) | 2013-12-03 08:45:58 UTC 2013-12-03 |
| [Latvian](/nova/trunk/%2Bpots/nova/lv/%2Btranslate) | 5 099.67  0.32938076416337286% translated  99.67061923583663% untranslated | 1513 [1513](/nova/trunk/%2Bpots/nova/lv/%2Btranslate?show=untranslated) | 0 0 | 2013-03-07 16:14:28 UTC 2013-03-07 |
| [Malay](/nova/trunk/%2Bpots/nova/ms/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/ms/%2Btranslate?show=untranslated) | 406 [406](/nova/trunk/%2Bpots/nova/ms/%2Btranslate?show=new_suggestions) | 2012-06-13 09:15:03 UTC 2012-06-13 |
| [Mari (Meadow)](/nova/trunk/%2Bpots/nova/mhr/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/mhr/%2Btranslate?show=untranslated) | 3 [3](/nova/trunk/%2Bpots/nova/mhr/%2Btranslate?show=new_suggestions) | 2013-11-05 08:44:17 UTC 2013-11-05 |
| [Nepali](/nova/trunk/%2Bpots/nova/ne/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/ne/%2Btranslate?show=untranslated) | 0 0 | 2013-10-03 20:33:29 UTC 2013-10-03 |
| [Norwegian Bokmal](/nova/trunk/%2Bpots/nova/nb/%2Btranslate) | 74 095.13  4.874835309617918% translated  95.12516469038208% untranslated | 1444 [1444](/nova/trunk/%2Bpots/nova/nb/%2Btranslate?show=untranslated) | 0 0 | 2012-03-13 11:36:56 UTC 2012-03-13 |
| [Occitan (post 1500)](/nova/trunk/%2Bpots/nova/oc/%2Btranslate) | 16 098.95  1.0540184453227932% translated  98.9459815546772% untranslated | 1502 [1502](/nova/trunk/%2Bpots/nova/oc/%2Btranslate?show=untranslated) | 394 [394](/nova/trunk/%2Bpots/nova/oc/%2Btranslate?show=new_suggestions) | 2011-11-17 07:23:06 UTC 2011-11-17 |
| [Persian](/nova/trunk/%2Bpots/nova/fa/%2Btranslate) | 14 099.08  0.922266139657444% translated  99.07773386034255% untranslated | 1504 [1504](/nova/trunk/%2Bpots/nova/fa/%2Btranslate?show=untranslated) | 0 0 | 2012-09-18 11:44:07 UTC 2012-09-18 |
| [Polish](/nova/trunk/%2Bpots/nova/pl/%2Btranslate) | 2 099.87  0.13175230566534915% translated  99.86824769433466% untranslated | 1516 [1516](/nova/trunk/%2Bpots/nova/pl/%2Btranslate?show=untranslated) | 0 0 | 2012-09-04 20:24:42 UTC 2012-09-04 |
| [Portuguese](/nova/trunk/%2Bpots/nova/pt/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/pt/%2Btranslate?show=untranslated) | 8 [8](/nova/trunk/%2Bpots/nova/pt/%2Btranslate?show=new_suggestions) | 2013-06-07 09:16:30 UTC 2013-06-07 |
| [Romanian](/nova/trunk/%2Bpots/nova/ro/%2Btranslate) | 2 099.87  0.13175230566534915% translated  99.86824769433466% untranslated | 1516 [1516](/nova/trunk/%2Bpots/nova/ro/%2Btranslate?show=untranslated) | 4 [4](/nova/trunk/%2Bpots/nova/ro/%2Btranslate?show=new_suggestions) | 2013-03-03 09:38:48 UTC 2013-03-03 |
| [Russian](/nova/trunk/%2Bpots/nova/ru/%2Btranslate) | 1307 013.90  86.10013175230566% translated  13.899868247694336% untranslated | 211 [211](/nova/trunk/%2Bpots/nova/ru/%2Btranslate?show=untranslated) | 15 [15](/nova/trunk/%2Bpots/nova/ru/%2Btranslate?show=new_suggestions) | 2013-05-21 06:50:11 UTC 2013-05-21 |
| [Serbian](/nova/trunk/%2Bpots/nova/sr/%2Btranslate) | 1 099.93  0.06587615283267458% translated  99.93412384716733% untranslated | 1517 [1517](/nova/trunk/%2Bpots/nova/sr/%2Btranslate?show=untranslated) | 0 0 | 2014-04-02 15:56:24 UTC 2014-04-02 |
| [Slovak](/nova/trunk/%2Bpots/nova/sk/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/sk/%2Btranslate?show=untranslated) | 6 [6](/nova/trunk/%2Bpots/nova/sk/%2Btranslate?show=new_suggestions) | 2013-09-09 20:15:25 UTC 2013-09-09 |
| [Spanish](/nova/trunk/%2Bpots/nova/es/%2Btranslate) | 1517 000.07  99.93412384716733% translated  0.06587615283267458% untranslated | 1 [1](/nova/trunk/%2Bpots/nova/es/%2Btranslate?show=untranslated) | 80 [80](/nova/trunk/%2Bpots/nova/es/%2Btranslate?show=new_suggestions) | 2013-07-09 23:15:49 UTC 2013-07-09 |
| [Swedish](/nova/trunk/%2Bpots/nova/sv/%2Btranslate) | 20 098.68  1.3175230566534915% translated  98.68247694334651% untranslated | 1498 [1498](/nova/trunk/%2Bpots/nova/sv/%2Btranslate?show=untranslated) | 1 [1](/nova/trunk/%2Bpots/nova/sv/%2Btranslate?show=new_suggestions) | 2013-01-15 20:08:01 UTC 2013-01-15 |
| [Tagalog](/nova/trunk/%2Bpots/nova/tl/%2Btranslate) | 6 099.60  0.3952569169960474% translated  99.60474308300395% untranslated | 1512 [1512](/nova/trunk/%2Bpots/nova/tl/%2Btranslate?show=untranslated) | 0 0 | 2011-08-23 11:21:43 UTC 2011-08-23 |
| [Tajik](/nova/trunk/%2Bpots/nova/tg/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/tg/%2Btranslate?show=untranslated) | 0 0 | 2020-07-23 06:12:18 UTC 2020-07-23 |
| [Tamil](/nova/trunk/%2Bpots/nova/ta/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/ta/%2Btranslate?show=untranslated) | 0 0 | 2014-04-02 15:56:25 UTC 2014-04-02 |
| [Thai](/nova/trunk/%2Bpots/nova/th/%2Btranslate) | 5 099.67  0.32938076416337286% translated  99.67061923583663% untranslated | 1513 [1513](/nova/trunk/%2Bpots/nova/th/%2Btranslate?show=untranslated) | 0 0 | 2012-05-27 00:06:52 UTC 2012-05-27 |
| [Tibetan](/nova/trunk/%2Bpots/nova/bo/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/bo/%2Btranslate?show=untranslated) | 0 0 | 2019-12-12 01:59:05 UTC 2019-12-12 |
| [Turkish](/nova/trunk/%2Bpots/nova/tr/%2Btranslate) | 28 098.16  1.844532279314888% translated  98.15546772068511% untranslated | 1490 [1490](/nova/trunk/%2Bpots/nova/tr/%2Btranslate?show=untranslated) | 43 [43](/nova/trunk/%2Bpots/nova/tr/%2Btranslate?show=new_suggestions) | 2013-03-14 06:55:20 UTC 2013-03-14 |
| [Ukrainian](/nova/trunk/%2Bpots/nova/uk/%2Btranslate) | 19 098.75  1.251646903820817% translated  98.74835309617919% untranslated | 1499 [1499](/nova/trunk/%2Bpots/nova/uk/%2Btranslate?show=untranslated) | 391 [391](/nova/trunk/%2Bpots/nova/uk/%2Btranslate?show=new_suggestions) | 2011-08-23 11:21:35 UTC 2011-08-23 |
| [Urdu](/nova/trunk/%2Bpots/nova/ur/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/ur/%2Btranslate?show=untranslated) | 0 0 | 2013-12-05 23:09:34 UTC 2013-12-05 |
| [Uyghur](/nova/trunk/%2Bpots/nova/ug/%2Btranslate) | 0 100.00  100.0% untranslated | 1518 [1518](/nova/trunk/%2Bpots/nova/ug/%2Btranslate?show=untranslated) | 1 [1](/nova/trunk/%2Bpots/nova/ug/%2Btranslate?show=new_suggestions) | 2012-03-18 09:35:05 UTC 2012-03-18 |

[ [Change your preferred languages...](/%2Beditmylanguages)
—
View all languages
]

![Key to this table: “Unchanged” means](/@@/green-bar)
Translated

![and “untranslated” means just that,](/@@/red-bar)
Untranslated

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_6a612297_20250126_130744.html ===

[Log in / Register](https://launchpad.net/~apevec/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~apevec)

## [Alan Pevec](https://launchpad.net/~apevec)

* Overview
* [Code](https://code.launchpad.net/~apevec)
* [Bugs](https://bugs.launchpad.net/~apevec)
* [Blueprints](https://blueprints.launchpad.net/~apevec)
* [Translations](https://translations.launchpad.net/~apevec)
* [Answers](https://answers.launchpad.net/~apevec)

* [Related packages](https://launchpad.net/~apevec/%2Brelated-packages)
* [Related projects](https://launchpad.net/~apevec/%2Brelated-projects)

## User information

Launchpad Id:
apevec

Email:
[Log in](%2Blogin) for email information.

Member since:
2011-10-24

[![Icon of OpenStack Team](https://launchpadlibrarian.net/52313052/os14.png "Member of OpenStack Team")](/~openstack)

Languages:

English

Time zone:

UTC
(UTC+0000)

Karma:
[0](https://launchpad.net/~apevec/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**apevec**
 on
**irc.freenode.net**

## [All memberships](https://launchpad.net/~apevec/%2Bparticipation) Latest memberships

| [TripleO Drivers](/~tripleo-drivers)  Joined on 2018-01-05 | |
| --- | --- |
| [rpm packaging for OpenStack](/~rpm-packaging)  Joined on 2015-07-09 | |
| [OpenStack Folsom Stable Maintainers](/~openstack-folsom-maint)  Joined on 2013-04-11 | |
| [Packstack Core](/~packstack-core)  Joined on 2013-01-14 | |
| [Neutron Bugs](/~neutron-bugs)  Joined on 2012-10-29 | |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_3ac15b4b_20250126_003014.html ===

[Log in / Register](https://bugs.launchpad.net/nova/%2Bbug/1073306/%2Blogin)

[![](https://launchpadlibrarian.net/324577028/nova64.png)](https://launchpad.net/nova)

## [OpenStack Compute (nova)](https://launchpad.net/nova)

* [Overview](https://launchpad.net/nova)
* [Code](https://code.launchpad.net/nova)
* [Bugs](https://bugs.launchpad.net/nova)
* [Blueprints](https://blueprints.launchpad.net/nova)
* [Translations](https://translations.launchpad.net/nova)
* [Answers](https://answers.launchpad.net/nova)

# [OSSA 2013-030] xenapi migrations don't apply security group filters (CVE-2013-4497)

Bug #1073306 reported by
[Chris Behrens](https://launchpad.net/~cbehrens)
on 2012-10-30

[258](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Compute (nova)](https://bugs.launchpad.net/nova) | Fix Released | High | [John Garbutt](https://launchpad.net/~johngarbutt) | [OpenStack Compute (nova) 2013.2 "havana"](https://launchpad.net/nova/%2Bmilestone/2013.2) |
|  | [Grizzly](https://bugs.launchpad.net/nova/grizzly) | Fix Released | High | [John Garbutt](https://launchpad.net/~johngarbutt) | [OpenStack Compute (nova) 2013.1.5](https://launchpad.net/nova/%2Bmilestone/2013.1.5) |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | High | [Jeremy Stanley](https://launchpad.net/~fungi) |  |

### Bug Description

xenapi's finish\_migration() is missing code to apply security group rules, etc. There's code in spawn() that appears we need to also use in finish\_migration().

(Somewhat related, see: <https://bugs.launchpad.net/bugs/1073303>)

Tags:

[xenserver](/nova/%2Bbugs?field.tag=xenserver)

## CVE References

* [2013-4497](/bugs/cve/2013-4497 "The XenAPI backend in OpenStack Compu...")

[Chris Behrens (cbehrens)](https://launchpad.net/~cbehrens)
on 2012-10-30

| Changed in nova: | |
| --- | --- |
| **importance**: | Undecided → Medium |
| **status**: | New → Triaged |

[John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt)
on 2013-05-22

| **tags**: | added: xenserver |
| --- | --- |

[Euan Harris (euanh)](https://launchpad.net/~euanh)
on 2013-06-24

| Changed in nova: | |
| --- | --- |
| **assignee**: | nobody → Euan Harris (euanh) |

[Euan Harris (euanh)](https://launchpad.net/~euanh)
on 2013-07-15

| Changed in nova: | |
| --- | --- |
| **status**: | Triaged → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-07-24: |  |  | [#1](/nova/%2Bbug/1073306/comments/1) |
| --- | --- | --- | --- |

This seems to have got fixed by the work on:

[https://bugs.launchpad.net/nova/+bug/1073303](https://bugs.launchpad.net/nova/%2Bbug/1073303)

Sorry for the clash, but would really appreciate you checking I have made the same changes.

This seems to have got fixed by the work on:
https://bugs.launchpad.net/nova/+bug/1073303
Sorry for the clash, but would really appreciate you checking I have made the same changes.

[OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack)
on 2013-07-24

| Changed in nova: | |
| --- | --- |
| **assignee**: | Euan Harris (euanh) → John Garbutt (johngarbutt) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Euan Harris (euanh)](https://launchpad.net/~euanh) wrote on 2013-07-24: |  |  | [#2](/nova/%2Bbug/1073306/comments/2) |
| --- | --- | --- | --- |

No problem.

This bug also affects live migration, and that's what I had been working on. Does your patch fix the problem for live migration too?

No problem.
This bug also affects live migration, and that's what I had been working on. Does your patch fix the problem for live migration too?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-08-21: |  |  | [#3](/nova/%2Bbug/1073306/comments/3) |
| --- | --- | --- | --- |

The bug tracking live migration is [bug 1202266](/bugs/1202266)

The bug tracking live migration is bug 1202266

| **information type**: | Public → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-08-21: |  |  | [#4](/nova/%2Bbug/1073306/comments/4) |
| --- | --- | --- | --- |

Shall be a common OSSA with 1202266

Shall be a common OSSA with 1202266

| Changed in ossa: | |
| --- | --- |
| **importance**: | Undecided → High |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Bob Ball (bob-ball)](https://launchpad.net/~bob-ball) wrote on 2013-08-21: |  |  | [#5](/nova/%2Bbug/1073306/comments/5) |
| --- | --- | --- | --- |

John/Euan, can you confirm that <https://review.openstack.org/#/c/38455/> will fix this once it is merged?

If so, we should merge the defects and update the flags to ensure that [https://bugs.launchpad.net/nova/+bug/1073303](https://bugs.launchpad.net/nova/%2Bbug/1073303) is high priority.

John/Euan, can you confirm that https://review.openstack.org/#/c/38455/ will fix this once it is merged?
If so, we should merge the defects and update the flags to ensure that https://bugs.launchpad.net/nova/+bug/1073303 is high priority.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-08-30: |  |  | [#6](/nova/%2Bbug/1073306/comments/6) |
| --- | --- | --- | --- |

<https://review.openstack.org/#/c/38455/>

As mentioned in the commit, will fix both this and:

[https://bugs.launchpad.net/nova/+bug/1073303](https://bugs.launchpad.net/nova/%2Bbug/1073303)

They are quite different bugs, fixed by the same tidy up (sharing more code between spawn and finish\_migrate).

It will not fix:

[https://bugs.launchpad.net/nova/+bug/1202266](https://bugs.launchpad.net/nova/%2Bbug/1202266)

I didn't consider this high, because it is a side feature, but that is debatable I guess.

https://review.openstack.org/#/c/38455/
As mentioned in the commit, will fix both this and:
https://bugs.launchpad.net/nova/+bug/1073303
They are quite different bugs, fixed by the same tidy up (sharing more code between spawn and finish\_migrate).
It will not fix:
https://bugs.launchpad.net/nova/+bug/1202266
I didn't consider this high, because it is a side feature, but that is debatable I guess.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-09-09: |  |  | [#7](/nova/%2Bbug/1073306/comments/7) |
| --- | --- | --- | --- |

In response to Thierry's comment #4, I'm unsure how we'll be able to issue a common OSSA if the proposed fix does not address [bug 1202266](/bugs/1202266). Should we hold the advisory until such time as fixes for both are ready, or do they need to diverge?

In response to Thierry's comment #4, I'm unsure how we'll be able to issue a common OSSA if the proposed fix does not address bug 1202266. Should we hold the advisory until such time as fixes for both are ready, or do they need to diverge?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-09-10: |  |  | [#8](/nova/%2Bbug/1073306/comments/8) |
| --- | --- | --- | --- |

@Jeremy: given that this is public, if one is really ready before the other, then they probably need to diverge. Maybe we should mention the live-migration issue in the migration CVE so that people know the workaround (reapply security groups after live migration).

@Jeremy: given that this is public, if one is really ready before the other, then they probably need to diverge. Maybe we should mention the live-migration issue in the migration CVE so that people know the workaround (reapply security groups after live migration).

| Changed in nova: | |
| --- | --- |
| **milestone**: | none → havana-rc1 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-09-10: |  |  | [#9](/nova/%2Bbug/1073306/comments/9) |
| --- | --- | --- | --- |

+1

I will try get someone to look at the live-migrate issue in the XAPI meeting, if not in progress before that.

+1
I will try get someone to look at the live-migrate issue in the XAPI meeting, if not in progress before that.

| Changed in nova: | |
| --- | --- |
| **importance**: | Medium → High |

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2013-09-17

| Changed in ossa: | |
| --- | --- |
| **assignee**: | nobody → Jeremy Stanley (fungi) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-09-17: |  |  | [#10](/nova/%2Bbug/1073306/comments/10) |
| --- | --- | --- | --- |

The proposedfix for this vulnerability is last in a series of 6 relatively substantial changes for nova, none of which currently have any core reviews on them whatsoever. Are all these patches granted a freeze exception, or would it be possible to divorce this fix from some/all of the other changes in that series to expedite resolution so we can publish an advisory?

The proposedfix for this vulnerability is last in a series of 6 relatively substantial changes for nova, none of which currently have any core reviews on them whatsoever. Are all these patches granted a freeze exception, or would it be possible to divorce this fix from some/all of the other changes in that series to expedite resolution so we can publish an advisory?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-09-20:  [**Fix merged to nova (master)**](/nova/%2Bbug/1073306/comments/11) |  |  | [#11](/nova/%2Bbug/1073306/comments/11) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/38455>

Committed: <http://github.com/openstack/nova/commit/ba0d007fb78bd1182c3c0b808dbd7ccc84640e80>

Submitter: Jenkins

Branch: master

commit ba0d007fb78bd1182c3c0b808dbd7ccc84640e80

Author: John Garbutt <email address hidden>

Date: Wed Jul 24 13:15:03 2013 +0100

xenapi: ensure finish\_migration cleans on errors

This change makes finish\_migration share code with spawn.

This fixes some inconsistencies, such as applying the security

    group filters during finish\_migration.

Fixes [bug 1073303](/bugs/1073303)

    Fixes [bug 1073306](/bugs/1073306)

Change-Id: Ib4f2a96618692c141708535f9463c856f3395922

Reviewed: https://review.openstack.org/38455
Committed: http://github.com/openstack/nova/commit/ba0d007fb78bd1182c3c0b808dbd7ccc84640e80
Submitter: Jenkins
Branch: master
commit ba0d007fb78bd1182c3c0b808dbd7ccc84640e80
Author: John Garbutt <john.garbutt@rackspace.com>
Date: Wed Jul 24 13:15:03 2013 +0100
xenapi: ensure finish\_migration cleans on errors
This change makes finish\_migration share code with spawn.
This fixes some inconsistencies, such as applying the security
group filters during finish\_migration.
Fixes bug 1073303
Fixes bug 1073306
Change-Id: Ib4f2a96618692c141708535f9463c856f3395922

| Changed in nova: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-09-20:  [**Re: xenapi migrations don't apply security group filters**](/nova/%2Bbug/1073306/comments/12) |  |  | [#12](/nova/%2Bbug/1073306/comments/12) |
| --- | --- | --- | --- |

Great! Does this also effect Grizzly? Folsom? (Need backports for those if so.) Also if it affects Essex or earlier, that will incluence the wording in the impact description somewhat as well.

Great! Does this also effect Grizzly? Folsom? (Need backports for those if so.) Also if it affects Essex or earlier, that will incluence the wording in the impact description somewhat as well.

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-10-03

| Changed in nova: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-10-09: |  |  | [#13](/nova/%2Bbug/1073306/comments/13) |
| --- | --- | --- | --- |

Any information on which stable release branches are/were affected by this (if any)? We'll want bug tasks and backports for them as far back as folsom if possible.

Any information on which stable release branches are/were affected by this (if any)? We'll want bug tasks and backports for them as far back as folsom if possible.

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-10-17

| Changed in nova: | |
| --- | --- |
| **milestone**: | havana-rc1 → 2013.2 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-10-21: |  |  | [#14](/nova/%2Bbug/1073306/comments/14) |
| --- | --- | --- | --- |

So, I think this has been an issue since essex, when security groups and migration were both present:

[https://blueprints.launchpad.net/nova/+spec/xenapi-security-groups](https://blueprints.launchpad.net/nova/%2Bspec/xenapi-security-groups)

It hasn't really been tested much since then mind :(

We will need a simpler fix to backport, but its really just a cut and paste from the spawn code to the finish\_migrate (which is the issue I fixed with my patch).

So, I think this has been an issue since essex, when security groups and migration were both present:
https://blueprints.launchpad.net/nova/+spec/xenapi-security-groups
It hasn't really been tested much since then mind :(
We will need a simpler fix to backport, but its really just a cut and paste from the spawn code to the finish\_migrate (which is the issue I fixed with my patch).

[John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt)
on 2013-10-21

| **tags**: | added: folsom-backport-potential grizzly-backport-potential |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-10-21: |  |  | [#15](/nova/%2Bbug/1073306/comments/15) |
| --- | --- | --- | --- |

@ Jeremy Stanley (fungi) this also applies to resizes, so a resize would also drop the firewall rules.

@ Jeremy Stanley (fungi) this also applies to resizes, so a resize would also drop the firewall rules.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [John Garbutt (johngarbutt)](https://launchpad.net/~johngarbutt) wrote on 2013-10-21: |  |  | [#16](/nova/%2Bbug/1073306/comments/16) |
| --- | --- | --- | --- |

This is a pain to backport given the changes, gone for a possible minimal fix:

<https://review.openstack.org/#/c/52991/>

<https://review.openstack.org/#/c/52992/>

This is a pain to backport given the changes, gone for a possible minimal fix:
https://review.openstack.org/#/c/52991/
https://review.openstack.org/#/c/52992/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-10-21: |  |  | [#17](/nova/%2Bbug/1073306/comments/17) |
| --- | --- | --- | --- |

Proposed impact description (covers this bug and [bug 1202266](/bugs/1202266)):

----

Title: XenAPI security groups not kept through migrate or resize

Reporter: Chris Behrens (Rackspace) and Vangelis Tasoulas

Products: Nova

Affects: all releases

Description:

Chris Behrens with Rackspace and Vangelis Tasoulas reported a set of vulnerabilities in OpenStack Nova. When migrating or resizing a virtual machine, security groups may not be applied after the operation completes. Only setups using the XenAPI backend are affected. This issue also affects live migrations, introduced in the Folsom (2012.2) release.

Proposed impact description (covers this bug and bug 1202266):
----
Title: XenAPI security groups not kept through migrate or resize
Reporter: Chris Behrens (Rackspace) and Vangelis Tasoulas
Products: Nova
Affects: all releases
Description:
Chris Behrens with Rackspace and Vangelis Tasoulas reported a set of vulnerabilities in OpenStack Nova. When migrating or resizing a virtual machine, security groups may not be applied after the operation completes. Only setups using the XenAPI backend are affected. This issue also affects live migrations, introduced in the Folsom (2012.2) release.

| Changed in ossa: | |
| --- | --- |
| **status**: | Confirmed → Triaged |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-10-22: |  |  | [#18](/nova/%2Bbug/1073306/comments/18) |
| --- | --- | --- | --- |

I would say "affects: Folsom, Grizzly" and precise that Havana is not affected.

also maybe "existing security groups may not be reapplied"

I would also add a sentence about impact (instances not as protected as one may think)

I would say "affects: Folsom, Grizzly" and precise that Havana is not affected.
also maybe "existing security groups may not be reapplied"
I would also add a sentence about impact (instances not as protected as one may think)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-10-24: |  |  | [#19](/nova/%2Bbug/1073306/comments/19) |
| --- | --- | --- | --- |

Updated impact description (covers this bug and [bug 1202266](/bugs/1202266)):

----

Title: XenAPI security groups not kept through migrate or resize

Reporter: Chris Behrens (Rackspace) and Vangelis Tasoulas

Products: Nova

Affects: Folsom, Grizzly

Description:

Chris Behrens with Rackspace and Vangelis Tasoulas reported a set of vulnerabilities in OpenStack Nova. When migrating or resizing an instance, including live migration, existing security groups may not be reapplied after the operation completes. This can lead to unintentional network exposure for virtual machines. Only setups using the XenAPI backend are affected.

Updated impact description (covers this bug and bug 1202266):
----
Title: XenAPI security groups not kept through migrate or resize
Reporter: Chris Behrens (Rackspace) and Vangelis Tasoulas
Products: Nova
Affects: Folsom, Grizzly
Description:
Chris Behrens with Rackspace and Vangelis Tasoulas reported a set of vulnerabilities in OpenStack Nova. When migrating or resizing an instance, including live migration, existing security groups may not be reapplied after the operation completes. This can lead to unintentional network exposure for virtual machines. Only setups using the XenAPI backend are affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-10-24: |  |  | [#20](/nova/%2Bbug/1073306/comments/20) |
| --- | --- | --- | --- |

Impact desc looks good to me.

Impact desc looks good to me.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2013-10-31:  [**Fix merged to nova (stable/grizzly)**](/nova/%2Bbug/1073306/comments/21) |  |  | [#21](/nova/%2Bbug/1073306/comments/21) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/52991>

Committed: <http://github.com/openstack/nova/commit/01de658210fd65171bfbf5450c93673b5ce0bd9e>

Submitter: Jenkins

Branch: stable/grizzly

commit 01de658210fd65171bfbf5450c93673b5ce0bd9e

Author: John Garbutt <email address hidden>

Date: Mon Oct 21 19:34:43 2013 +0100

xenapi: apply firewall rules in finish\_migrate

When security groups were added, the rules were not re-applied to

    servers that have been migrated to a new hypervisor.

This change ensures the firewall rules are applied as part of creating

    the new VM in finish\_migrate. This code follows a very similar pattern

    to the code in spawn, and that is where the cut and paste code comes

    from. This code duplication was removed in Havana.

Fixes [bug 1073306](/bugs/1073306)

Change-Id: I6295a782df328a759e358fb82b76dd3f7bd4b39e

Reviewed: https://review.openstack.org/52991
Committed: http://github.com/openstack/nova/commit/01de658210fd65171bfbf5450c93673b5ce0bd9e
Submitter: Jenkins
Branch: stable/grizzly
commit 01de658210fd65171bfbf5450c93673b5ce0bd9e
Author: John Garbutt <john.garbutt@rackspace.com>
Date: Mon Oct 21 19:34:43 2013 +0100
xenapi: apply firewall rules in finish\_migrate
When security groups were added, the rules were not re-applied to
servers that have been migrated to a new hypervisor.
This change ensures the firewall rules are applied as part of creating
the new VM in finish\_migrate. This code follows a very similar pattern
to the code in spawn, and that is where the cut and paste code comes
from. This code duplication was removed in Havana.
Fixes bug 1073306
Change-Id: I6295a782df328a759e358fb82b76dd3f7bd4b39e

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2013-11-03

| Changed in ossa: | |
| --- | --- |
| **status**: | Triaged → In Progress |

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2013-11-03

| **summary**: | - xenapi migrations don't apply security group filters+ xenapi migrations don't apply security group filters (CVE-2013-4497) |
| --- | --- |

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-11-13

| **no longer affects**: | nova/folsom |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2013-11-13:  [**Re: xenapi migrations don't apply security group filters (CVE-2013-4497)**](/nova/%2Bbug/1073306/comments/22) |  |  | [#22](/nova/%2Bbug/1073306/comments/22) |
| --- | --- | --- | --- |

Finalized impact description being used in advisory (also covers [bug 1202266](/bugs/1202266)):

----

Title: XenAPI security groups not kept through migrate or resize

Reporter: Chris Behrens (Rackspace) and Vangelis Tasoulas

Products: Nova

Affects: All supported versions prior to Havana

Description:

Chris Behrens with Rackspace and Vangelis Tasoulas reported a set of vulnerabilities in OpenStack Nova's XenAPI hypervisor backend. When migrating or resizing an instance, including live migration, existing security groups may not be reapplied after the operation completes. This can lead to unintentional network exposure for virtual machines. Only setups using the XenAPI backend are affected.

Finalized impact description being used in advisory (also covers bug 1202266):
----
Title: XenAPI security groups not kept through migrate or resize
Reporter: Chris Behrens (Rackspace) and Vangelis Tasoulas
Products: Nova
Affects: All supported versions prior to Havana
Description:
Chris Behrens with Rackspace and Vangelis Tasoulas reported a set of vulnerabilities in OpenStack Nova's XenAPI hypervisor backend. When migrating or resizing an instance, including live migration, existing security groups may not be reapplied after the operation completes. This can lead to unintentional network exposure for virtual machines. Only setups using the XenAPI backend are affected.

[Thierry Carrez (ttx)](https://launchpad.net/~ttx)
on 2013-11-14

| Changed in ossa: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2013-11-15: |  |  | [#23](/nova/%2Bbug/1073306/comments/23) |
| --- | --- | --- | --- |

[OSSA 2013-030]

[OSSA 2013-030]

| Changed in ossa: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |
| **summary**: | - xenapi migrations don't apply security group filters (CVE-2013-4497)+ [OSSA 2013-030] xenapi migrations don't apply security group filters+ (CVE-2013-4497) |

[Alan Pevec (apevec)](https://launchpad.net/~apevec)
on 2014-03-20

| **tags**: | removed: folsom-backport-potential grizzly-backport-potential |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/nova/%2Bbug/1073306/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/nova/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/nova/%2Bbug/1073306/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/nova/%2Bbug/1073306/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/nova/%2Bbug/1073306/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))


