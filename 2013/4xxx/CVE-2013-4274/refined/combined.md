=== Content from www.madirish.net_548c5caa_20250125_174651.html ===


# [Mad Irish . net](https://www.madirish.net)

* [about](https://www.madirish.net/about "About me")
* contact
* [rss](https://www.madirish.net/rss.php "RSS feed")
* [github](https://github.com/madirish "Work")
* [LAMPSecurity](https://sourceforge.net/projects/lampsecurity/ "CTF")

# Drupal 6/7 Password Policy Module XSS Vulnerability

[disclosure](/tag/disclosure) [javascript](/tag/javascript) [xss](/tag/xss)
15 August 2013

Vulnerability Report

Author: Justin C. Klein Keane

Reported: 9 August, 2013

#### Description of Vulnerability:

Drupal (http://drupal.org) is a robust content management system (CMS) written in PHP and MySQL. The Password Policy module (https://drupal.org/project/password\_policy) " provides a way to specify a certain level of password complexity (aka. "password hardening") for user passwords on a system by defining a password policy." The Password Policy module suffers from a persistent (stored) cross site scripting (XSS or arbitrary script injection) vulnerability because it fails to sanitize expiration warning messages before display.

#### Systems affected:

Password Policy 7.x-1.4 on Drupal 7.22 was tested and shown vulnerable. The Drupal 6 version is also vulnerable.

#### Impact:

Attackers can inject arbitrary HTML (including JavaScript) in order to attack site administrators. This could lead to account compromise, which could in turn lead to web server compromise, or expose administrative users to client side malware attacks.

#### Mitigating factors:

In order to inject arbitrary script malicious attackers must have the access to an account with the 'Administer policies' permission.

#### Proof of Concept Exploits:

1. Install and enable the Password Policy module
2. Navigate to the new policy page at ?q=admin/config/people/password\_policy/add
3. Fill in the "Password Expiration Warning " field with the value "<script>alert('xss');</script>"
4. Complete the "Name" and "Roles" sections with arbitrary values and click the "Create" button at the bottom of the page.
5. Click the 'view' link on the policy list page (?q=admin/config/people/password\_policy/list) for the new policy
6. The XSS will manifest on the policy page at ?q=admin/config/people/password\_policy/X where X is the policy id

#### Patch:

The following patch mitigates this vulnerability:

```

--- password_policy/password_policy.admin.inc	2013-08-09 11:58:49.237205999 -0400
+++ password_policy/password_policy.admin.inc	2013-08-09 11:59:23.423205888 -0400
@@ -267,7 +267,7 @@ function password_policy_admin_view($pol
     $rows[] = array(t('Expiration'), $policy['expiration']);
   }
   if (!empty($policy['warning'])) {
-    $rows[] = array(t('Warning'), $policy['warning']);
+    $rows[] = array(t('Warning'), check_plain($policy['warning']));
   }

   foreach ($policy['policy'] as $key => $val) {
@@ -391,6 +391,9 @@ function password_policy_admin_form_vali
   if (empty($roles)) {
     form_set_error('roles', t('You must select at least one role for a policy to apply to.'));
   }
+  if (! preg_match("[d, ]", $form_state['values']['warning'])) {
+  	form_set_error('warning', t('Warning must only contain digits or commas'));
+  }
 }

 /**

```

#### Vendor Response

[SA-CONTRIB-2013-069](https://drupal.org/node/2065387)

### Tags

* [apple](/tag/apple)
* [arbitrary\_code\_execution](/tag/arbitrary_code_execution)
* [blue\_team](/tag/blue_team)
* [disclosure](/tag/disclosure)
* [drupal](/tag/drupal)
* [editorial](/tag/editorial)
* [encryption](/tag/encryption)
* [exploit](/tag/exploit)
* [feature](/tag/feature)
* [how\_to](/tag/how_to)
* [html5](/tag/html5)
* [ios](/tag/ios)
* [iot](/tag/iot)
* [javascript](/tag/javascript)
* [linux](/tag/linux)
* [malware](/tag/malware)
* [mysql](/tag/mysql)
* [network](/tag/network)
* [osx](/tag/osx)
* [pen\_test](/tag/pen_test)
* [php](/tag/php)
* [privacy](/tag/privacy)
* [purple\_team](/tag/purple_team)
* [random](/tag/random)
* [raspberry\_pi](/tag/raspberry_pi)
* [research](/tag/research)
* [review](/tag/review)
* [sql](/tag/sql)
* [sql\_injection](/tag/sql_injection)
* [threat\_intel](/tag/threat_intel)
* [tools](/tag/tools)
* [tutorial](/tag/tutorial)
* [vuln](/tag/vuln)
* [web\_application](/tag/web_application)
* [windows](/tag/windows)
* [xss](/tag/xss)

[Copyright](http://www.madirish.net/copyright "My copyright statement") © Justin C. Klein Keane. Unauthorized reproduction is a violation of US and international law.



=== Content from www.openwall.com_ba893483_20250125_174651.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](../../../2013/08/21/21) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <5215AD7A.9030303@redhat.com>
Date: Thu, 22 Aug 2013 00:19:38 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Forest Monsen <forest.monsen@...il.com>
Subject: Re: CVE request for Drupal contributed modules

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 08/21/2013 05:45 PM, Forest Monsen wrote:
> Hi there,
>
> I'd like to request CVE identifiers for...
>
> SA-CONTRIB-2013-067 - BOTCHA - Information Disclosure (potential
> Privilege Escalation) <https://drupal.org/node/2065057>
>
> SA-CONTRIB-2013-068 - Entity API - Access Bypass
> <https://drupal.org/node/2065207>
>
> SA-CONTRIB-2013-069 - Password Policy - XSS
> <https://drupal.org/node/2065387>
>
> SA-CONTRIB-2013-070 - Zen - Cross Site Scripting
> <https://drupal.org/node/2071157>
>
> Thanks!
>
> Best, Forest
>

CVE-2013-4272 Drupal SA-CONTRIB-2013-067 - BOTCHA - Information
Disclosure (potential Privilege Escalation)

CVE-2013-4273 Drupal SA-CONTRIB-2013-068 - Entity API - Access Bypass

CVE-2013-4274 Drupal SA-CONTRIB-2013-069 - Password Policy - XSS

CVE-2013-4275 Drupal SA-CONTRIB-2013-070 - Zen - Cross Site Scripting

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (GNU/Linux)

iQIcBAEBAgAGBQJSFa16AAoJEBYNRVNeJnmTtoYQAJ+ORNMfzoSVG97NuUVQ0bh6
+RqN8r2ntquC/QQEI8DRD50E0Z5hciWOvKJt7oXyhqAhqCzw9Dr0z95hSw5TmmCz
vJ6nyiUXxLf+ohHk9Q+Ar9MukxjBY/SUhVtb8F98DM49tekI9BcCd42LcRgsKAsq
fvB3aNZBHA8mvHyOqgZCT7ChcseMXGBYCXY8M0Nqai0Tm3Oakj+88wdZdxeJdICs
wqDiwIjo2CMH94dchraq+f7/qCG4S/9M75whWP/BBDBLItZbEBfDfCnIFPCjza73
QFUG0Bx5EkfqB6bJC6lMCBds2pLltCSGAd3/xz/BmBO6drUaV15hlLf/AjOoVCwQ
uis34vny+5Y0knKvFYPhDWTyUO/k1uIz/NTLHdyRevcSca8m7fQ5X4m+Z4m9oYN3
kTPf2H3G2TF/L9aQgKhnzLYfk3GY1kJYpdtNNnZmp9PEmu2ZipMHR04gJDMCQ7Xj
y64cMfoNnbV9uc4CNSpHmR6eJYruYN3eRi+ZVz+Bqurass8kWWCQeVilzXBMW1Q7
wGox7BI+t8Fv3mCOhCWcuyBjRWJqEjQ/s4CWlWgYrRHJG3rhbwoHX1V5SQllG3f9
BJNA/jcfTfP0lrWJq65guaCaZyBvOb/ZXIMqapn+JyA8u2ojg3teX1JbQOavNvuu
ici312vXQs4ii8q2F4LP
=BchA
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


