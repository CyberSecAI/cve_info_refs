=== Content from core.trac.wordpress.org_6610a372_20250125_133640.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ‚ÜóÔ∏é](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ‚ÜóÔ∏é](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ‚ÜóÔ∏é](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ‚ÜóÔ∏é](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Make WordPress Core](https://make.wordpress.org/core/)

* [Blog](https://make.wordpress.org/core/)
* [Handbook](https://make.wordpress.org/core/handbook/)
* [Tickets](https://make.wordpress.org/core/reports/)
* [Components](https://make.wordpress.org/core/components/)
* [Browse Source](https://core.trac.wordpress.org/browser "Browse Source")
* [Trac Timeline](https://core.trac.wordpress.org/timeline "Trac Timeline")
* [Create a New Ticket](https://login.wordpress.org/?redirect_to=https://core.trac.wordpress.org/newticket "Create a New Ticket")

Search:

* [Login](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fcore.trac.wordpress.org%2Fchangeset%2F25323)
* [Notifications](https://make.wordpress.org/core/notifications/)

## Context Navigation

* ‚Üê [Previous Changeset](/changeset/25322 "Changeset 25322")
* [Next Changeset](/changeset/25324 "Changeset 25324") ‚Üí

---

# Changeset 25323

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
09/10/2013 06:42:32 PM
([11 years](/timeline?from=2013-09-10T18%3A42%3A32Z&precision=second "See timeline at 09/10/2013 06:42:32 PM") ago)

Author:
nacin
Message:

Validate referrers to prevent off-domain redirects. Merges [[25318]](/changeset/25318 "Validate referrers to prevent off-domain redirects.
") to 3.6.

Location:
[branches/3.6](/browser/branches/3.6?rev=25323)
Files:

3 edited

* [.](/browser/branches/3.6?rev=25323 "Show entry in browser")
  (modified)
  ([1 prop](#file0 "Show differences"))
* [wp-includes/functions.php](/browser/branches/3.6/wp-includes/functions.php?rev=25323 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [wp-includes/pluggable.php](/browser/branches/3.6/wp-includes/pluggable.php?rev=25323 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [branches/3.6](/changeset/25323/branches/3.6 "Show the changeset 25323 restricted to branches/3.6")

  + Property **svn:mergeinfo** changed

    | [/trunk/src](/browser/trunk/src?rev=25323 "View merge source") | merged: [25318](/changeset/25318/trunk/src "25318") |  |  |  |
    | --- | --- | --- | --- | --- |
* ## [branches/3.6/wp-includes/functions.php](/changeset/25323/branches/3.6/wp-includes/functions.php "Show the changeset 25323 restricted to branches/3.6/wp-includes/functions.php")

  | [r25322](/browser/branches/3.6/wp-includes/functions.php?rev=25322#L1284 "Show revision 25322 of this file in browser") | [r25323](/browser/branches/3.6/wp-includes/functions.php?rev=25323#L1284 "Show revision 25323 of this file in browser") |  |
  | --- | --- | --- |
  | 1284 | 1284 |  |
  | 1285 | 1285 | if ( $ref && $ref !== wp\_unslash( $\_SERVER['REQUEST\_URI'] ) ) |
  | 1286 |  | return wp\_~~unslash( $ref~~ ); |
  |  | 1286 | return wp\_validate\_redirect( $ref, false ); |
  | 1287 | 1287 | return false; |
  | 1288 | 1288 | } |
  | [‚Ä¶](/browser/branches/3.6/wp-includes/functions.php?rev=25322#L1299) | [‚Ä¶](/browser/branches/3.6/wp-includes/functions.php?rev=25323#L1299) |  |
  | 1299 | 1299 | function wp\_get\_original\_referer() { |
  | 1300 | 1300 | if ( !empty( $\_REQUEST['\_wp\_original\_http\_referer'] ) ) |
  | 1301 |  | return wp\_~~unslash( $\_REQUEST['\_wp\_original\_http\_referer']~~ ); |
  |  | 1301 | return wp\_validate\_redirect( wp\_unslash( $\_REQUEST['\_wp\_original\_http\_referer'] ), false ); |
  | 1302 | 1302 | return false; |
  | 1303 | 1303 | } |
* ## [branches/3.6/wp-includes/pluggable.php](/changeset/25323/branches/3.6/wp-includes/pluggable.php "Show the changeset 25323 restricted to branches/3.6/wp-includes/pluggable.php")

  | [r24649](/browser/trunk/wp-includes/pluggable.php?rev=24649#L943 "Show revision 24649 of this file in browser") | [r25323](/browser/branches/3.6/wp-includes/pluggable.php?rev=25323#L943 "Show revision 25323 of this file in browser") |  |
  | --- | --- | --- |
  | 943 | 943 | \*\*/ |
  | 944 | 944 | function wp\_validate\_redirect($location, $default = '') { |
  |  | 945 | $location = trim( $location ); |
  | 945 | 946 | // browsers will assume 'http' is your protocol, and will obey a redirect to a URL starting with '//' |
  | 946 | 947 | if ( substr($location, 0, 2) == '//' ) |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=25323)
* [Zip Archive](?format=zip&new=25323)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ‚Üó](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ‚Üó](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ‚Üó](https://wordpress.com/?ref=wporg-footer)
* [Matt ‚Üó](https://ma.tt/)
* [bbPress ‚Üó](https://bbpress.org/)
* [BuddyPress ‚Üó](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from seclists.org_5dffbc7c_20250125_133643.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](173)
[By Date](date.html#174)
[![Next](/images/right-icon-16x16.png)](175)

[![Previous](/images/left-icon-16x16.png)](173)
[By Thread](index.html#174)
[![Next](/images/right-icon-16x16.png)](175)

![](/shared/images/nst-icons.svg#search)

# URL Redirector Abuse and XSS vulnerabilities in WordPress

---

*From*: "MustLive" <mustlive () websecurity com ua>

*Date*: Thu, 19 Dec 2013 23:41:01 +0200

---

```

Hello list!

As I've announced earlier (<http://seclists.org/fulldisclosure/2013/Nov/219>),
I conducted a Day of bugs in WordPress 3. At 30.11.2013 I disclosed many new
vulnerabilities in WordPress. I've disclosed 10 holes (they were placed at
my site for your attention). And this is translation of the third part of
these holes.

These are URL Redirector Abuse and Cross-Site Scripting vulnerabilities in
WordPress. These are just few from multiple such holes in WP.

I informed WordPress developers about the first two redirector holes in 2007
(and proposed a fix, which I released in my MustLive Security Pack), but
they at first ignored them and then hiddenly fixed them in WP 2.3. After my
informing about redirectors in 2007 (two ones) and in 2012 (in
wp-comments-post.php and Akismet plugin, which is bundled with WP), thus I
made a hint that there are a lot of such holes in WP, the developers fixed
the first two vulnerabilities in 2007 and vulnerabilities in Akismet and
below-mentioned vulnerabilities were fixed only in WP 3.6.1 (at 11.09.2013),
when they made "global fix" for all redirectors in engine.

-------------------------
Affected products:
-------------------------

Vulnerable are WordPress 3.6 and previous versions (for one Redirector
vulnerable are only versions 3.0 - 3.6).

----------
Details:
----------

Redirector (URL Redirector Abuse) (WASC-38):

<http://site/wp-admin/edit-tags.php?action=delete&_wp_http_referer=http://websecurity.com.ua/?edit-tags.php>

XSS (WASC-08):

<http://site/wp-admin/edit-tags.php?action=delete&_wp_http_referer=data:text/html;edit-tags.php;base64,PHNjcmlwdD5hbGVydChkb2N1bWVudC5jb29raWUpPC9zY3JpcHQ%2B>

Redirector (URL Redirector Abuse) (WASC-38):

Only Redirector is possible, but not XSS (due to filtration of important
characters). For the attack it's needed to know value of _wpnonce.

<http://site/wp-admin/edit-tags.php?action=add-tag&_wpnonce=096ea8dbbd&_wp_original_http_referer=http://websecurity.com.ua/?edit-tags.php>

For this Redirector vulnerable are WordPress 3.0 - 3.6. And for these two
vulnerable are WordPress 3.6 and previous versions:

<http://site/wp-admin/edit-tags.php?action=bulk-delete&_wpnonce=ebee6d0330&_wp_http_referer=http://websecurity.com.ua/?edit-tags.php>

<http://site/wp-admin/media.php?action=editattachment&_wpnonce=2fa131c992&_wp_original_http_referer=http://websecurity.com.ua/?upload.php>

------------
Timeline:

```
------------
```

2013.11.30 - disclosed at my site (<http://websecurity.com.ua/6907/>).

Best wishes & regards,
MustLive
Administrator of Websecurity web site
<http://websecurity.com.ua>

_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>

```

---

[![Previous](/images/left-icon-16x16.png)](173)
[By Date](date.html#174)
[![Next](/images/right-icon-16x16.png)](175)

[![Previous](/images/left-icon-16x16.png)](173)
[By Thread](index.html#174)
[![Next](/images/right-icon-16x16.png)](175)

### Current thread:

* **URL Redirector Abuse and XSS vulnerabilities in WordPress** *MustLive (Dec 19)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.debian.org_8f3112f3_20250125_133645.html ===


---

[[Date Prev](msg00167.html)][[Date Next](msg00169.html)]
[[Thread Prev](msg00167.html)][[Thread Next](msg00169.html)]
[[Date Index](maillist.html#00168)]
[[Thread Index](threads.html#00168)]

# [SECURITY] [DSA 2757-1] wordpress security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2757-1] wordpress security update
* *From*: Yves-Alexis Perez <corsac@debian.org>
* *Date*: Sat, 14 Sep 2013 11:13:38 +0200
* *Message-id*: <[[üîé]](/msgid-search/20130914091333.GA14774%40scapa.corsac.net)¬†[20130914091333.GA14774@scapa.corsac.net](msg00168.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2757-1                   security@debian.org
<http://www.debian.org/security/>                         Yves-Alexis Perez
September 14, 2013                     <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : wordpress
Vulnerability  : several
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-2013-4338 CVE-2013-4339 CVE-2013-4340 CVE-2013-5738
                 CVE-2013-5739
Debian Bug     : 722537

Several vulnerabilities were identified in Wordpress, a web blogging
tool. As the CVEs were allocated from releases announcements and specific
fixes are usually not identified, it has been decided to upgrade the
Wordpress package to the latest upstream version instead of backporting
the patches.

This means extra care should be taken when upgrading, especially when
using third-party plugins or themes, since compatibility may have been
impacted along the way.  We recommend that users check their install
before doing the upgrade.

CVE-2013-4338

    Unsafe PHP unserialization in wp-includes/functions.php could cause
    arbitrary code execution.

CVE-2013-4339

    Insufficient input validation could result in redirecting or leading
    a user to another website.

CVE-2013-4340

    Privilege escalation allowing an user with an author role to create
    an entry appearing as written by another user.

CVE-2013-5738

    Insufficient capabilities were required for uploading .html/.html
    files, making it easier for authenticated users to conduct cross-site
    scripting attacks (XSS) using crafted html file uploads.

CVE-2013-5739

    Default Wordpress configuration allowed file upload for .swf/.exe
    files, making it easier for authenticated users to conduct cross-site
    scripting attacks (XSS).

For the oldstable distribution (squeeze), these problems have been fixed in
version 3.6.1+dfsg-1~deb6u1.

For the stable distribution (wheezy), these problems have been fixed in
version 3.6.1+dfsg-1~deb7u1.

For the testing distribution (jessie), these problems have been fixed in
version 3.6.1+dfsg-1.

For the unstable distribution (sid), these problems have been fixed in
version 3.6.1+dfsg-1.

We recommend that you upgrade your wordpress packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.21 (GNU/Linux)

iQEcBAEBCgAGBQJSNCi5AAoJEG3bU/KmdcCl3mgH/0jQvSeOoHHastL2/ELArLoh
ZZs99SSj7fqU3DC36EyEW0m+Pe81OlML793RlRxjAcYgv2VxIvFgFuUpMUZ+y1eC
ZnJgxyI6mU6qrZ+2sCRp72Rp+6M9X2Hp8wkfgozrBIYhaQikeJTpy/Z9LZmUnQXh
pdTqNCIBHfXfUcXxkHT002RuRdK9m4ROI7sh7qMFJfS1YoKM+dW9ys0mPIXQ07Qd
kZjDOb7Arn7c5QxcpEEJTgVYettJyXvupll4JkhLPvePYTkYnE4scn3P58GfGNAp
PXLi1c4ed9/KZIOSLWE0qmXARjIBvw28Etc1vudX5pFNvEJQmboSfomZzy8t7VE=
=gyM6
-----END PGP SIGNATURE-----

```

---



=== Content from core.trac.wordpress.org_e2fdffb8_20250125_133641.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ‚ÜóÔ∏é](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ‚ÜóÔ∏é](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ‚ÜóÔ∏é](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ‚ÜóÔ∏é](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Make WordPress Core](https://make.wordpress.org/core/)

* [Blog](https://make.wordpress.org/core/)
* [Handbook](https://make.wordpress.org/core/handbook/)
* [Tickets](https://make.wordpress.org/core/reports/)
* [Components](https://make.wordpress.org/core/components/)
* [Browse Source](https://core.trac.wordpress.org/browser "Browse Source")
* [Trac Timeline](https://core.trac.wordpress.org/timeline "Trac Timeline")
* [Create a New Ticket](https://login.wordpress.org/?redirect_to=https://core.trac.wordpress.org/newticket "Create a New Ticket")

Search:

* [Login](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fcore.trac.wordpress.org%2Fchangeset%2F25324)
* [Notifications](https://make.wordpress.org/core/notifications/)

## Context Navigation

* ‚Üê [Previous Changeset](/changeset/25323 "Changeset 25323")
* [Next Changeset](/changeset/25325 "Changeset 25325") ‚Üí

---

# Changeset 25324

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
09/10/2013 06:43:16 PM
([11 years](/timeline?from=2013-09-10T18%3A43%3A16Z&precision=second "See timeline at 09/10/2013 06:43:16 PM") ago)

Author:
nacin
Message:

Better protocol validation in set\_url\_scheme(). Merges [[25319]](/changeset/25319 "Better protocol validation in set_url_scheme().
") to 3.6.

Location:
[branches/3.6](/browser/branches/3.6?rev=25324)
Files:

2 edited

* [.](/browser/branches/3.6?rev=25324 "Show entry in browser")
  (modified)
  ([1 prop](#file0 "Show differences"))
* [wp-includes/link-template.php](/browser/branches/3.6/wp-includes/link-template.php?rev=25324 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [branches/3.6](/changeset/25324/branches/3.6 "Show the changeset 25324 restricted to branches/3.6")

  + Property **svn:mergeinfo** changed

    | [/trunk/src](/browser/trunk/src?rev=25324 "View merge source") | merged: [25319](/changeset/25319/trunk/src "25319") |  |  |  |
    | --- | --- | --- | --- | --- |
* ## [branches/3.6/wp-includes/link-template.php](/changeset/25324/branches/3.6/wp-includes/link-template.php "Show the changeset 25324 restricted to branches/3.6/wp-includes/link-template.php")

  | [r24941](/browser/branches/3.6/wp-includes/link-template.php?rev=24941#L2239 "Show revision 24941 of this file in browser") | [r25324](/browser/branches/3.6/wp-includes/link-template.php?rev=25324#L2239 "Show revision 25324 of this file in browser") |  |
  | --- | --- | --- |
  | 2239 | 2239 | } |
  | 2240 | 2240 |  |
  | 2241 |  | if ( 'relative' == $scheme ) |
  | 2242 |  | $url = preg\_replace( '#^.+://[^/]\*#', '', $url ); |
  | 2243 |  | else |
  | 2244 |  | $url = preg\_replace( '#^.+://#', $scheme . '://', $url ); |
  |  | 2241 | $url = trim( $url ); |
  |  | 2242 | if ( $url[0] === '/' && $url[1] === '/' ) |
  |  | 2243 | $url = 'http:' . $url; |
  |  | 2244 |  |
  |  | 2245 | if ( 'relative' == $scheme ) { |
  |  | 2246 | $url = ltrim( preg\_replace( '#^\w+://[^/]\*#', '', $url ) ); |
  |  | 2247 | if ( $url[0] === '/' ) |
  |  | 2248 | $url = '/' . ltrim($url , "/ \t\n\r\0\x0B" ); |
  |  | 2249 | } else { |
  |  | 2250 | $url = preg\_replace( '#^\w+://#', $scheme . '://', $url ); |
  |  | 2251 | } |
  | 2245 | 2252 |  |
  | 2246 | 2253 | return apply\_filters( 'set\_url\_scheme', $url, $scheme, $orig\_scheme ); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=25324)
* [Zip Archive](?format=zip&new=25324)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ‚Üó](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ‚Üó](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ‚Üó](https://wordpress.com/?ref=wporg-footer)
* [Matt ‚Üó](https://ma.tt/)
* [bbPress ‚Üó](https://bbpress.org/)
* [BuddyPress ‚Üó](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from codex.wordpress.org_29bae0f1_20250125_133639.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ‚ÜóÔ∏é](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ‚ÜóÔ∏é](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ‚ÜóÔ∏é](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ‚ÜóÔ∏é](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Documentation](https://wordpress.org/documentation)

Version 3.6.1

* [WordPress Overview](https://wordpress.org/documentation/overview/)
* [Technical Guides](https://wordpress.org/documentation/technical-guides/)
* [Support Guides](https://wordpress.org/documentation/support-guides/)
* [Customization](https://wordpress.org/documentation/customization/)
* [Get Involved](https://make.wordpress.org/docs/)

* [WordPress Overview](https://wordpress.org/documentation/overview/)
* [Technical Guides](https://wordpress.org/documentation/technical-guides/)
* [Support Guides](https://wordpress.org/documentation/support-guides/)
* [Customization](https://wordpress.org/documentation/customization/)
* [Get Involved](https://make.wordpress.org/docs/)

[Home](https://wordpress.org/documentation)Version 3.6.1

Search documentation

# Version 3.6.1

## In this article

Table of Contents

* [Installation/Update Information](#installation-update-information)
* [Summary](#summary)
* [List of Files Revised](#list-of-files-revised)

[‚Üë Back to top](#wp--skip-link--target)

On September 11, 2013, WordPress 3.6.1 was released to the public. This is a maintenance and security update.

## [Installation/Update Information](#installation-update-information)

To download WordPress 3.6.1, update automatically from the Dashboard > Updates menu in your site‚Äôs admin area or visit <https://wordpress.org/download/release-archive/>.

For step-by-step instructions on installing and updating WordPress:

* [Updating WordPress](https://wordpress.org/documentation/article/updating-wordpress/)

If you are new to WordPress, we recommend that you begin with the following:

* [New To WordPress ‚Äì Where to Start](/support/article/new_to_wordpress_-_where_to_start/)
* [First Steps With WordPress](/support/article/first-steps-with-wordpress/) or [Upgrading WordPress Extended](https://wordpress.org/documentation/article/upgrading-wordpress-extended-instructions/)
* [WordPress Lessons](/support/article/wordpress-lessons/)

## [Summary](#summary)

From the¬†[announcement post](https://wordpress.org/news/2013/09/wordpress-3-6-1/), this maintenance release addresses 13 bugs with version 3.6.

Additionally: Version 3.6.1 fixes three security issues:

* Remote Code Execution: Block unsafe PHP de-serialization that could occur in limited situations and setups, which can lead to remote code execution. Reported by Tom Van Goethem. CVE-2013-4338.
* Link Injection / Open Redirect: Fix insufficient input validation that could result in redirecting or leading a user to another website. Reported by Dave Cummo, a Northrup Grumman subcontractor for the U.S. Centers for Disease Control and Prevention. CVE-2013-4339.
* Privilege Escalation: Prevent a user with an Author role, using a specially crafted request, from being able to create a post ‚Äúwritten by‚Äù another user. Reported by Anakorn Kyavatanakij. CVE-2013-4340.

Additional security hardening:

* Updated security restrictions around file uploads to mitigate the potential for cross-site scripting. The extensions .swf and .exe are no longer allowed by default, and .htm and .html are only allowed if the user has the ability to use unfiltered HTML.

A full log of the changes made for 3.6.1 can be found at¬†<https://core.trac.wordpress.org/log/branches/3.6?stop_rev=24972&rev=25345>.

## [List of Files Revised](#list-of-files-revised)

```
readme.html
wp-admin/about.php
wp-admin/nav-menus.php
wp-admin/includes/post.php
wp-admin/includes/update-core.php
wp-admin/includes/template.php
wp-admin/network/upgrade.php
wp-admin/js/common.js
wp-includes/pluggable.php
wp-includes/comment-template.php
wp-includes/post-template.php
wp-includes/version.php
wp-includes/theme.php
wp-includes/functions.php
wp-includes/ms-functions.php
wp-includes/link-template.php
wp-includes/class-http.php
wp-includes/js/jquery/jquery.js
wp-includes/js/tinymce/plugins/wordpress/editor_plugin.js
wp-includes/js/tinymce/plugins/wordpress/editor_plugin_src.js
wp-includes/js/tinymce/wp-tinymce.js.gz
```

First published

January 5, 2019

Last updated

## Get more help

[Support forums](https://wordpress.org/support/forums/)

Ask questions in the support forums.

[Developers](https://developer.wordpress.org/)

Check out the developer documentation.

[Content suggestions](https://github.com/WordPress/Documentation-Issue-Tracker/issues)

Report an error or change in the documentation issue tracker.

[Get involved](https://make.wordpress.org/docs/)

Learn about the Documentation Team and how to contribute.

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ‚Üó](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ‚Üó](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ‚Üó](https://wordpress.com/?ref=wporg-footer)
* [Matt ‚Üó](https://ma.tt/)
* [bbPress ‚Üó](https://bbpress.org/)
* [BuddyPress ‚Üó](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from wordpress.org_1e9215e6_20250125_133644.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ‚ÜóÔ∏é](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ‚ÜóÔ∏é](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ‚ÜóÔ∏é](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ‚ÜóÔ∏é](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[News](https://wordpress.org/news)

WordPress 3.6.1 Maintenance and Security Release

All posts

Search results

* Categories
  + [All Posts](https://wordpress.org/news/all-posts/)
  + [Awards](https://wordpress.org/news/category/awards/)
  + [Community](https://wordpress.org/news/category/community/)
  + [Design](https://wordpress.org/news/category/design/)
  + [Development](https://wordpress.org/news/category/development/)
  + [Documentation](https://wordpress.org/news/category/documentation/)
  + [Events](https://wordpress.org/news/category/events/)
  + [Features](https://wordpress.org/news/category/features/)
  + [General](https://wordpress.org/news/category/general/)
  + [Interviews](https://wordpress.org/news/category/interviews/)
  + [Meta](https://wordpress.org/news/category/meta/)
  + [Month in WordPress](https://wordpress.org/news/category/month-in-wordpress/)
  + [Performance](https://wordpress.org/news/category/performance/)
  + [Podcast](https://wordpress.org/news/podcast/)
  + [Releases](https://wordpress.org/news/category/releases/)
  + [Security](https://wordpress.org/news/category/security/)
  + [Store](https://wordpress.org/news/category/store/)
  + [Testing](https://wordpress.org/news/category/testing/)
  + [Updates](https://wordpress.org/news/category/updates/)
  + [WordCamp](https://wordpress.org/news/category/wordcamp/)

* Categories
  + [All Posts](https://wordpress.org/news/all-posts/)
  + [Awards](https://wordpress.org/news/category/awards/)
  + [Community](https://wordpress.org/news/category/community/)
  + [Design](https://wordpress.org/news/category/design/)
  + [Development](https://wordpress.org/news/category/development/)
  + [Documentation](https://wordpress.org/news/category/documentation/)
  + [Events](https://wordpress.org/news/category/events/)
  + [Features](https://wordpress.org/news/category/features/)
  + [General](https://wordpress.org/news/category/general/)
  + [Interviews](https://wordpress.org/news/category/interviews/)
  + [Meta](https://wordpress.org/news/category/meta/)
  + [Month in WordPress](https://wordpress.org/news/category/month-in-wordpress/)
  + [Performance](https://wordpress.org/news/category/performance/)
  + [Podcast](https://wordpress.org/news/podcast/)
  + [Releases](https://wordpress.org/news/category/releases/)
  + [Security](https://wordpress.org/news/category/security/)
  + [Store](https://wordpress.org/news/category/store/)
  + [Testing](https://wordpress.org/news/category/testing/)
  + [Updates](https://wordpress.org/news/category/updates/)
  + [WordCamp](https://wordpress.org/news/category/wordcamp/)

September 11, 2013
By [Andrew Nacin](https://profiles.wordpress.org/nacin/)
in [Releases](https://wordpress.org/news/category/releases/), [Security](https://wordpress.org/news/category/security/)
# WordPress 3.6.1 Maintenance and Security Release

---

After [nearly 7 million downloads](https://wordpress.org/download/counter/) of WordPress 3.6, we are pleased to announce the availability of version 3.6.1. This maintenance release [fixes 13 bugs](https://core.trac.wordpress.org/query?status=closed&group=resolution&milestone=3.6.1) in version 3.6, which was a very smooth release.

**WordPress 3.6.1 is also a security release for all previous WordPress versions** and we strongly encourage you to update your sites immediately. It addresses three issues fixed by the WordPress security team:

* Block unsafe PHP unserialization that could occur in limited situations and setups, which can lead to remote code execution. Reported by [Tom Van Goethem](http://vagosec.org/).
* Prevent a user with an Author role, using a specially crafted request, from being able to create a post ‚Äúwritten by‚Äù another user. Reported by [Anakorn Kyavatanakij](http://anakornk.wordpress.com/).
* Fix insufficient input validation that could result in redirecting or leading a user to another website. Reported by Dave Cummo, a Northrup Grumman subcontractor for the [U.S. Centers for Disease Control and Prevention](http://www.cdc.gov/).

Additionally, we‚Äôve adjusted security restrictions around file uploads to mitigate the potential for cross-site scripting.

We appreciated [responsible disclosure](https://codex.wordpress.org/FAQ_Security) of these issues directly to our security team. For more information on the changes, see the [release notes](https://codex.wordpress.org/Version_3.6.1) or consult [the list of changes](https://core.trac.wordpress.org/log/branches/3.6?stop_rev=24972&rev=25345).

[Download WordPress 3.6.1](https://wordpress.org/wordpress-3.6.1.zip) or update now from the Dashboard ‚Üí Updates menu in your site‚Äôs admin area.

Share this:

* [Threads](https://wordpress.org/news/2013/09/wordpress-3-6-1/?share=threads&nb=1)
* [Mastodon](https://wordpress.org/news/2013/09/wordpress-3-6-1/?share=mastodon&nb=1)
* [Bluesky](https://wordpress.org/news/2013/09/wordpress-3-6-1/?share=bluesky&nb=1)
* [X](https://wordpress.org/news/2013/09/wordpress-3-6-1/?share=x&nb=1)
* [Facebook](https://wordpress.org/news/2013/09/wordpress-3-6-1/?share=facebook&nb=1)
* [LinkedIn](https://wordpress.org/news/2013/09/wordpress-3-6-1/?share=linkedin&nb=1)

---

[Previous WordPress 3.6 ‚ÄúOscar‚Äù](https://wordpress.org/news/2013/08/oscar/)
[Next WordPress 3.7 Beta 1](https://wordpress.org/news/2013/09/wordpress-3-7-beta-1/)

## Get the Latest Updates

### Subscribe to WordPress News

Email Address

Subscribe

Join 18.7K other subscribers

### WP Briefing ‚Äî The WordPress Podcast

Learn about where WordPress is going and how you can get involved.

* [Apple Podcasts](https://podcasts.apple.com/us/podcast/wp-briefing/id1551691710)
* [Pocket Casts](https://pca.st/uqvvmt8t)
* [RSS](https://wordpress.org/news/feed/podcast)
* [Spotify](https://open.spotify.com/show/6BxgmE9Qg2TZA8EKZLJ4zS)
* [Stitcher](https://www.stitcher.com/show/wp-briefing)

[Listen to all episodes](https://wordpress.org/news/podcast/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ‚Üó](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ‚Üó](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ‚Üó](https://wordpress.com/?ref=wporg-footer)
* [Matt ‚Üó](https://ma.tt/)
* [bbPress ‚Üó](https://bbpress.org/)
* [BuddyPress ‚Üó](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


