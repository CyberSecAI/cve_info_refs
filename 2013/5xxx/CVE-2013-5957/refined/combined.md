=== Content from civicrm.org_ebbbc22a_20250125_082134.html ===

[Skip to main content](#main-content)
## User account menu

* [Log in](/user/login)

Toggle navigation

[![Home](/sites/civicrm.org/files/CiviCRM-logo-2019-F2-200px.png)](/ "Home")

## Top Navigation

* [Explore CiviCRM](https://civicrm.com)
* [Engage](https://civicrm.org/get-involved)
  + [Get Involved](/get-involved)
  + [Read the Blog](/blog)
  + [All Events](/events)
  + [Subscribe to Newsletters](/civicrm/mailing/subscribe?reset=1)
  + [Support CiviCRM](/support-us)
  + [Make It Happen](/make-it-happen)
  + [Make a One-Time Gift](https://civicrm.org/civicrm/contribute/transact?reset=1&id=47)
  + [CiviCRM Jobs](/jobs)
  + [Report a Bug](https://civicrm.org/bug-reporting)
  + [Report a Security Issue](/security)
  + [Find an Expert](/partners-contributors)
* [Find Support](/help)
  + [Read the Documentation](https://docs.civicrm.org/)
  + [Chat with the Community](https://chat.civicrm.org)
  + [Ask a Question](https://civicrm.stackexchange.com)
  + [Read the Release Notes](https://civicrm.org/blog/tags/release)
  + [Explore the Issue Queue](/issue-queue)
  + [Security Announcements](https://civicrm.org/advisory)
  + [Find an Expert](/civicrm/experts)
* [Extend](/extensions)
* [Download](/download)

## Top Navigation

* [Explore CiviCRM](https://civicrm.com)
* [Engage](https://civicrm.org/get-involved)
* [Find Support](/help)
* [Extend](/extensions)
* [Download](/download)

1. [Home](/)
2. [Security Advisories](/advisory)

# CIVI-SA-2013-009 - SQL Injection Vulnerability

Published
2013-10-02 05:43

Written by
[colemanw](/users/colemanw "View user profile.")

```

SQL injection vulnerability, multiple vectors.
```

Security Risk
Highly Critical

Vulnerability
SQL Injection

Affected Versions

All previously released versions of CiviCRM

Fixed Versions

4.2.12, 4.3.7, 4.4.beta4

Solutions

Any ONE of the following solutions will provide protection:

* Upgrade to 4.2.12, 4.3.7, 4.4.beta4 or later
* Apply this patch: <https://github.com/civicrm/civicrm-core/pull/1708.diff>

Credits

* Tristan Leiter
* Jonathan Borgeaud
* Donald Lobo
* Tim Otten

CVE
CVE-2013-5957

## WORK WITH A TRUSTED EXPERT TO SETUP YOUR CIVICRM

Make your next CiviCRM implementation a Success.
[Find an Expert](/civicrm/experts)
![](/sites/civicrm.org/themes/civi8/images/logo-civi-approved.png)

## Primary menu

* [Explore](https://civicrm.com)
  + [Try a Demo](https://civicrm.com/demo)
  + [Testing Sandboxes](/testing-sandboxes)
  + [Case Studies](https://civicrm.com/case-studies)
  + [Extend](/extensions)
  + [Download](/download)
* [Features](/features)
  + [Contact Management](https://civicrm.com/features/contact-management/)
  + [Contributions](https://civicrm.com/features/contribution-pages/)
  + [Events](https://civicrm.com/features/events/)
  + [Memberships](https://civicrm.com/features/membership-management/)
  + [Email Marketing](https://civicrm.com/features/mailings/)
  + [Reports](https://civicrm.com/features/detailed-reporting/)
  + [Configurable & Customizable](https://civicrm.com/features/powerful-utilities/)
  + [Case Management](https://civicrm.com/features/case-management/)
  + [Peer-to-Peer Fundraisers](https://civicrm.com/features/peer-to-peer-fundraising/)
* [Engage](/get-involved)
  + [Get Involved](/get-involved)
  + [Read the Blog](/blog)
  + [All Events](/civicrm-events)
  + [Subscribe to Newsletters](/update-my-mailing-preference)
  + [Support CiviCRM](/support-us)
  + [Make It Happen](/make-it-happen)
  + [Make a One-Time Gift](https://civicrm.org/civicrm/contribute/transact?reset=1&id=47)
  + [CiviCRM Jobs](/jobs)
  + [Report a Bug](/bug-reporting)
  + [Report a Security Issue](/security)
  + [Find an Expert](/experts)
* [Find Support](/help)
  + [Read the Documentation](https://docs.civicrm.org/)
  + [Chat with the Community](https://chat.civicrm.org)
  + [Ask a Question](https://civicrm.stackexchange.com)
  + [Read the Release Notes](https://civicrm.org/blog/tags/release)
  + [Explore the Issue Queue](/issue-queue)
  + [Security Announcements](/advisory)
  + [Find an Expert](/experts)
* [About](/about)
  + [License](/about/license)
  + [Roadmap](/about/roadmap)
  + [Trademark](/trademark)
  + [Community Council](/community-council)
  + [Privacy Policy](/about/privacy-policy)
  + [Code of Conduct](/code-of-conduct)

## Languages

* [English](/advisory/civi-sa-2013-009-sql-injection-vulnerability)
* [Catalan](/ca/node/2253)
* [Nederlands](/nl/node/2253)
* [Français](/fr/node/2253)
* [Magyar](/hu/node/2253)
* [Italiano](/it/node/2253)
* [Deutsch](/de/node/2253)
* [Polski](/pl/node/2253)
* [Español](/es/node/2253)

We are in the process of translating the civicrm.org website. Translations may not be available in all languages. [Read more and participate](https://lab.civicrm.org/marketing/civicrm-website/-/wikis/website-translation).

© 2005 - 2025, CIVICRM LLC. All rights reserved.

[D10]



=== Content from github.com_2df1fee7_20250126_073256.html ===
diff --git a/CRM/Utils/Rule.php b/CRM/Utils/Rule.php
index b6b6e8d4fb48..cadc93dc786b 100644
--- a/CRM/Utils/Rule.php
+++ b/CRM/Utils/Rule.php
@@ -34,6 +34,7 @@
\*/
require\_once 'HTML/QuickForm/Rule/Email.php';
+
class CRM\_Utils\_Rule {
static function title($str, $maxLength = 127) {
@@ -272,17 +273,26 @@ static function integer($value) {
return TRUE;
}
- if (($value < 0)) {
+ // CRM-13460
+ // ensure number passed is always a string numeral
+ if (!is\_numeric($value)) {
+ return FALSE;
+ }
+
+ // note that is\_int matches only integer type
+ // and not strings which are only integers
+ // hence we do this here
+ if (preg\_match('/^\d+$/', $value)) {
+ return TRUE;
+ }
+
+ if ($value < 0) {
$negValue = -1 \* $value;
if (is\_int($negValue)) {
return TRUE;
}
}
- if (is\_numeric($value) && preg\_match('/^\d+$/', $value)) {
- return TRUE;
- }
-
return FALSE;
}
@@ -291,7 +301,13 @@ static function positiveInteger($value) {
return ($value < 0) ? FALSE : TRUE;
}
- if (is\_numeric($value) && preg\_match('/^\d+$/', $value)) {
+ // CRM-13460
+ // ensure number passed is always a string numeral
+ if (!is\_numeric($value)) {
+ return FALSE;
+ }
+
+ if (preg\_match('/^\d+$/', $value)) {
return TRUE;
}
@@ -299,6 +315,11 @@ static function positiveInteger($value) {
}
static function numeric($value) {
+ // lets use a php gatekeeper to ensure this is numeric
+ if (!is\_numeric($value)) {
+ return FALSE;
+ }
+
return preg\_match('/(^-?\d\d\*\.\d\*$)|(^-?\d\d\*$)|(^-?\.\d\d\*$)/', $value) ? TRUE : FALSE;
}
diff --git a/tests/phpunit/CRM/Utils/RuleTest.php b/tests/phpunit/CRM/Utils/RuleTest.php
new file mode 100644
index 000000000000..22071172cbae
--- /dev/null
+++ b/tests/phpunit/CRM/Utils/RuleTest.php
@@ -0,0 +1,74 @@
+php
+
+require\_once 'CiviTest/CiviUnitTestCase.php';
+
+class CRM\_Utils\_RuleTest extends CiviUnitTestCase {
+
+ function get\_info() {
+ return array(
+ 'name' = 'Rule Test',
+ 'description' => 'Test the validation rules',
+ 'group' => 'CiviCRM BAO Tests',
+ );
+ }
+
+ function setUp() {
+ parent::setUp();
+ }
+
+ /\*\*
+ \* @dataProvider integerDataProvider
+ \*/
+ function testInteger($inputData, $expectedResult) {
+ $this->assertEquals($expectedResult, CRM\_Utils\_Rule::integer($inputData));
+ }
+
+ function integerDataProvider() {
+ return array(
+ array(10, true),
+ array('145E+3', false),
+ array('10', true),
+ array(-10, true),
+ array('-10', true),
+ array('-10foo', false),
+ );
+ }
+
+ /\*\*
+ \* @dataProvider positiveDataProvider
+ \*/
+ function testPositive($inputData, $expectedResult) {
+ $this->assertEquals($expectedResult, CRM\_Utils\_Rule::positiveInteger($inputData, $inputType));
+ }
+
+ function positiveDataProvider() {
+ return array(
+ array(10, true),
+ array('145.0E+3', false),
+ array('10', true),
+ array(-10, false),
+ array('-10', false),
+ array('-10foo', false),
+ );
+ }
+
+ /\*\*
+ \* @dataProvider numericDataProvider
+ \*/
+ function testNumeric($inputData, $expectedResult) {
+ $this->assertEquals($expectedResult, CRM\_Utils\_Rule::numeric($inputData, $inputType));
+ }
+
+ function numericDataProvider() {
+ return array(
+ array(10, true),
+ array('145.0E+3', false),
+ array('10', true),
+ array(-10, true),
+ array('-10', true),
+ array('-10foo', false),
+ );
+ }
+
+
+}
diff --git a/tests/phpunit/CRM/Utils/TypeTest.php b/tests/phpunit/CRM/Utils/TypeTest.php
new file mode 100644
index 000000000000..e0a2a9f7d439
--- /dev/null
+++ b/tests/phpunit/CRM/Utils/TypeTest.php
@@ -0,0 +1,42 @@
+php
+
+require\_once 'CiviTest/CiviUnitTestCase.php';
+
+class CRM\_Utils\_TypeTest extends CiviUnitTestCase {
+
+ function get\_info() {
+ return array(
+ 'name' = 'Type Test',
+ 'description' => 'Test the validate function',
+ 'group' => 'CiviCRM BAO Tests',
+ );
+ }
+
+ function setUp() {
+ parent::setUp();
+ }
+
+ /\*\*
+ \* @dataProvider validateDataProvider
+ \*/
+ function testValidate($inputData, $inputType, $expectedResult) {
+ $this->assertEquals($expectedResult, CRM\_Utils\_Type::validate($inputData, $inputType, FALSE));
+ }
+
+ function validateDataProvider() {
+ return array(
+ array(10, 'Int', 10),
+ array('145E+3', 'Int', NULL),
+ array('10', 'Integer', 10),
+ array(-10, 'Int', -10),
+ array('-10', 'Integer', -10),
+ array('-10foo', 'Int', NULL),
+ array(10, 'Positive', 10),
+ array('145.0E+3', 'Positive', NULL),
+ array('10', 'Positive', 10),
+ array(-10, 'Positive', NULL),
+ array('-10', 'Positive', NULL),
+ array('-10foo', 'Positive', NULL),
+ );
+ }
+}


=== Content from www.navixia.com_d563adab_20250125_082138.html ===

Menu
[![](https://navixia.com/themes/navixia/assets/images/logo-white.svg)
![](https://navixia.com/themes/navixia/assets/images/logo.svg)](https://navixia.com/en)

* [Solutions & Services](https://navixia.com/en/solutions-services "Solutions & Services")
* [Security Assessments](https://navixia.com/en/security-assessments "Security Assessments")
* [Awareness & Training](https://navixia.com/en/awareness-training "Awareness & Training")

* Company
  + [Profile](https://navixia.com/en/company-profile "Profile")
  + [News & Events](https://navixia.com/en/news "News & Events")
  + [Blog](https://navixia.com/en/blog "Blog")
  + [Partners](https://navixia.com/en/partners "Partners")
  + [Careers](https://navixia.com/en/careers "Careers")
* En
  + English
  + [Français](https://navixia.com/fr)

* [Solutions & Services](https://navixia.com/en/solutions-services "Solutions & Services")
* [Security Assessments](https://navixia.com/en/security-assessments "Security Assessments")
* [Awareness & Training](https://navixia.com/en/awareness-training "Awareness & Training")
* + Company
    - [Profile](https://navixia.com/en/company-profile "Profile")
    - [News & Events](https://navixia.com/en/news "News & Events")
    - [Blog](https://navixia.com/en/blog "Blog")
    - [Partners](https://navixia.com/en/partners "Partners")
    - [Careers](https://navixia.com/en/careers "Careers")

Search

![](/storage/app/media/header_images/home/home_11.jpg)

# Information Security Global and Pragmatic Approach

[Do you need a Security Assessment?](/en/security-assessments)

## Latest news

[All news](/news)

19.11.2024

### [Quiz: Help Santa detect cyber risks](https://navixia.com/en/article/quiz-cyberrisks-christmas)

Can you help Santa avoid the hackers' traps and complete his mission in time for Christmas Eve? Take our quiz!

01.11.2024

### [Navixia celebrates its 19th anniversary !](https://navixia.com/en/article/navixia-19)

19 years at your service in IT security. Another milestone, of which we are very proud.

30.06.2024

### [Join our team, we're hiring!](https://navixia.com/en/article/navixia-recrute-sas)

If you are an IT Security Engineer and want to give your career a more sales-oriented focus, this is the job for you! Come and put your talents to good use in a stimulating environment!

## IT Security Awareness

Your users are central to your company's IT security. DiagnoPhish trains them to recognise IT risks!

[How? Watch the video](https://navixia.com/storage/app/media/videos/DiagnoPhish_E.mp4)
[Try it with a test account!](https://www.diagnophish.ch)

[Download the Diagnophish datasheet](/storage/app/media/uploaded-files/datasheet_diagnophish2_e.pdf)

![Managed Canary Service](https://navixia.com/storage/app/media/home/header_canary_service_2023.png)
## Managed Canary Service

Detect attackers before they harm your systems with our hassle-free and affordable service.

[Discover](https://navixia.com/en/article/managed-canary-service-navixia)

## Latest blog post

[All blog posts](/blog)

19.11.2024

### [Cyber risks at Christmas](https://navixia.com/en/article/navixia-quiz-2024)

Can you help Santa avoid the hackers' traps and complete his mission in time for Christmas Eve? Take our quiz!

12.12.2021

### [[CRITICAL] Apache log4j vulnerability (CVE-2021-44228)](https://navixia.com/en/article/critical-remote-code-execution-apache-log4j-cve-2021-44228)

On Friday December 10th 2021, Log4Shell (CVE-2021-44228) was made public and this seems to be the most critical vulnerability seen in at least a decade.

06.10.2021

### [Vulnérabilité critique Apache CVE-2021-41773](https://navixia.com/en/article/cve-2021-41773)

Un peu de contexte concernant cette vulnérabilité de la version 2.4.49.

Sign up

Receive Navixia SecurityWatch, our bimonthly newsletter.

## About us

As a leading Swiss IT security specialist, Navixia offers a global and pragmatic approach to information security.

[More information](/company-profile)

## Navixia SA

Route du Bois 1
1024 Ecublens
Switzerland

Ph. +41 21 324 32 00
Fax. +41 21 324 32 01

## Need info? Contact us.

Name

Company

Email

Request

Anti-spam, don't fill this field

Sign up

Receive Navixia SecurityWatch, our bimonthly newsletter.
[See past examples](https://navixia.com/en/newsletters-list)

© 2025 Navixia SA - Switzerland

* [Credits](https://navixia.com/en/credits "Credits")
* [Use of your personal data](https://navixia.com/en/use-personal-data "Use of your personal data")



=== Content from www.navixia.com_daa3bd5a_20250125_082136.html ===

Menu
[![](https://navixia.com/themes/navixia/assets/images/logo-white.svg)
![](https://navixia.com/themes/navixia/assets/images/logo.svg)](https://navixia.com/en)

* [Solutions & Services](https://navixia.com/en/solutions-services "Solutions & Services")
* [Security Assessments](https://navixia.com/en/security-assessments "Security Assessments")
* [Awareness & Training](https://navixia.com/en/awareness-training "Awareness & Training")

* Company
  + [Profile](https://navixia.com/en/company-profile "Profile")
  + [News & Events](https://navixia.com/en/news "News & Events")
  + [Blog](https://navixia.com/en/blog "Blog")
  + [Partners](https://navixia.com/en/partners "Partners")
  + [Careers](https://navixia.com/en/careers "Careers")
* En
  + English
  + [Français](https://navixia.com/fr)

* [Solutions & Services](https://navixia.com/en/solutions-services "Solutions & Services")
* [Security Assessments](https://navixia.com/en/security-assessments "Security Assessments")
* [Awareness & Training](https://navixia.com/en/awareness-training "Awareness & Training")
* + Company
    - [Profile](https://navixia.com/en/company-profile "Profile")
    - [News & Events](https://navixia.com/en/news "News & Events")
    - [Blog](https://navixia.com/en/blog "Blog")
    - [Partners](https://navixia.com/en/partners "Partners")
    - [Careers](https://navixia.com/en/careers "Careers")

Search

![](/storage/app/media/header_images/home/home_26.jpg)

# Information Security Global and Pragmatic Approach

[Do you need a Security Assessment?](/en/security-assessments)

## Latest news

[All news](/news)

19.11.2024

### [Quiz: Help Santa detect cyber risks](https://navixia.com/en/article/quiz-cyberrisks-christmas)

Can you help Santa avoid the hackers' traps and complete his mission in time for Christmas Eve? Take our quiz!

01.11.2024

### [Navixia celebrates its 19th anniversary !](https://navixia.com/en/article/navixia-19)

19 years at your service in IT security. Another milestone, of which we are very proud.

30.06.2024

### [Join our team, we're hiring!](https://navixia.com/en/article/navixia-recrute-sas)

If you are an IT Security Engineer and want to give your career a more sales-oriented focus, this is the job for you! Come and put your talents to good use in a stimulating environment!

## IT Security Awareness

Your users are central to your company's IT security. DiagnoPhish trains them to recognise IT risks!

[How? Watch the video](https://navixia.com/storage/app/media/videos/DiagnoPhish_E.mp4)
[Try it with a test account!](https://www.diagnophish.ch)

[Download the Diagnophish datasheet](/storage/app/media/uploaded-files/datasheet_diagnophish2_e.pdf)

![Managed Canary Service](https://navixia.com/storage/app/media/home/header_canary_service_2023.png)
## Managed Canary Service

Detect attackers before they harm your systems with our hassle-free and affordable service.

[Discover](https://navixia.com/en/article/managed-canary-service-navixia)

## Latest blog post

[All blog posts](/blog)

19.11.2024

### [Cyber risks at Christmas](https://navixia.com/en/article/navixia-quiz-2024)

Can you help Santa avoid the hackers' traps and complete his mission in time for Christmas Eve? Take our quiz!

12.12.2021

### [[CRITICAL] Apache log4j vulnerability (CVE-2021-44228)](https://navixia.com/en/article/critical-remote-code-execution-apache-log4j-cve-2021-44228)

On Friday December 10th 2021, Log4Shell (CVE-2021-44228) was made public and this seems to be the most critical vulnerability seen in at least a decade.

06.10.2021

### [Vulnérabilité critique Apache CVE-2021-41773](https://navixia.com/en/article/cve-2021-41773)

Un peu de contexte concernant cette vulnérabilité de la version 2.4.49.

Sign up

Receive Navixia SecurityWatch, our bimonthly newsletter.

## About us

As a leading Swiss IT security specialist, Navixia offers a global and pragmatic approach to information security.

[More information](/company-profile)

## Navixia SA

Route du Bois 1
1024 Ecublens
Switzerland

Ph. +41 21 324 32 00
Fax. +41 21 324 32 01

## Need info? Contact us.

Name

Company

Email

Request

Anti-spam, don't fill this field

Sign up

Receive Navixia SecurityWatch, our bimonthly newsletter.
[See past examples](https://navixia.com/en/newsletters-list)

© 2025 Navixia SA - Switzerland

* [Credits](https://navixia.com/en/credits "Credits")
* [Use of your personal data](https://navixia.com/en/use-personal-data "Use of your personal data")


