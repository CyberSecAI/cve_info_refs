=== Content from www.freebsd.org_534ad7f7_20250125_203250.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
=============================================================================
FreeBSD-SA-13:10.sctp Security Advisory
The FreeBSD Project
Topic: Kernel memory disclosure in sctp(4)
Category: core
Module: sctp
Announced: 2013-08-22
Credits: Julian Seward, Michael Tuexen
Affects: All supported versions of FreeBSD.
Corrected: 2013-08-15 04:25:16 UTC (stable/9, 9.2-PRERELEASE)
2013-08-15 05:14:20 UTC (releng/9.2, 9.2-RC1-p1)
2013-08-15 05:14:20 UTC (releng/9.2, 9.2-RC2)
2013-08-22 00:51:48 UTC (releng/9.1, 9.1-RELEASE-p6)
2013-08-15 04:35:25 UTC (stable/8, 8.4-STABLE)
2013-08-22 00:51:56 UTC (releng/8.4, 8.4-RELEASE-p3)
2013-08-22 00:51:56 UTC (releng/8.3, 8.3-RELEASE-p10)
CVE Name: CVE-2013-5209
For general information regarding FreeBSD Security Advisories,
including descriptions of the fields above, security branches, and the
following sections, please visit .
0. Revision History
v1.0 2013-08-22 Initial release.
v1.1 2013-09-07 Binary patch released for 9.2-RC1.
I. Background
The SCTP protocol provides reliable, flow-controlled, two-way transmission
of data. It is a message oriented protocol and can support the SOCK\_STREAM
and SOCK\_SEQPACKET abstractions.
The SCTP protocol checks the integrity of messages by validating the state
cookie information that is returned from the peer.
II. Problem Description
When initializing the SCTP state cookie being sent in INIT-ACK chunks,
a buffer allocated from the kernel stack is not completely initialized.
III. Impact
Fragments of kernel memory may be included in SCTP packets and
transmitted over the network. For each SCTP session, there are two
separate instances in which a 4-byte fragment may be transmitted.
This memory might contain sensitive information, such as portions of the
file cache or terminal buffers. This information might be directly
useful, or it might be leveraged to obtain elevated privileges in
some way. For example, a terminal buffer might include a user-entered
password.
IV. Workaround
No workaround is available, but systems not using the SCTP protocol
are not vulnerable.
V. Solution
Perform one of the following:
1) Upgrade your vulnerable system to a supported FreeBSD stable or
release / security branch (releng) dated after the correction date.
2) To update your vulnerable system via a source code patch:
The following patches have been verified to apply to the applicable
FreeBSD release branches.
a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.
# fetch http://security.FreeBSD.org/patches/SA-13:10/sctp.patch
# fetch http://security.FreeBSD.org/patches/SA-13:10/sctp.patch.asc
# gpg --verify sctp.patch.asc
b) Apply the patch.
# cd /usr/src
# patch < /path/to/patch
c) Recompile your kernel as described in
 and reboot the
system.
3) To update your vulnerable system via a binary patch:
Systems running a RELEASE version of FreeBSD on the i386 or amd64
platforms can be updated via the freebsd-update(8) utility:
# freebsd-update fetch
# freebsd-update install
VI. Correction details
The following list contains the correction revision numbers for each
affected branch.
Branch/path Revision
- -------------------------------------------------------------------------
stable/8/ r254354
releng/8.3/ r254632
releng/8.4/ r254632
stable/9/ r254352
releng/9.1/ r254631
releng/9.2/ r254355
- -------------------------------------------------------------------------
To see which files were modified by a particular revision, run the
following command, replacing NNNNNN with the revision number, on a
machine with Subversion installed:
# svn diff -cNNNNNN --summarize svn://svn.freebsd.org/base
Or visit the following URL, replacing NNNNNN with the revision number:
VII. References
The latest revision of this advisory is available at
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (FreeBSD)
iEYEARECAAYFAlIu+g8ACgkQFdaIBMps37JBjgCgkRdb24STra3EjItZymFqU0S8
6rQAn0EQeP1D8BUCIbzR5uNYrrNv9Eo6
=2Ot5
-----END PGP SIGNATURE-----


=== Content from bugzilla.mozilla.org_ba0e8311_20250125_203251.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/905080)
* [XML](/show_bug.cgi?ctype=xml&id=905080)

Closed
[Bug 905080](/show_bug.cgi?id=905080)

Opened 11 years ago
Closed 11 years ago

# Uninitialised value use relating to sctp\_send\_initiate\_ack

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Uninitialised value use relating to sctp\_send\_initiate\_ack

## Categories

### (Core :: WebRTC: Networking, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=WebRTC%3A%20Networking#WebRTC%3A%20Networking)

WebRTC: Networking
▾

Core :: WebRTC: Networking
Bugs in the networking portions of WebRTC (PeerConnection dataChannels, SCTP, DTLS, SRTP, ICE, TURN, STUN, etc)
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC%3A%20Networking&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC%3A%20Networking&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=WebRTC%3A%20Networking)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

Linux

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla30

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr24 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr24&o1=equals&v1=wontfix) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr24 |  | wontfix |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jseward, Assigned: tuexen)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/b89290f020f52eaa4f6f9cb02d4658b7?d=mm&size=40)  [tuexen](/user_profile?user_id=459963)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/5edb95922c89f29d92b7febcba5669de?d=mm&size=40)  [jseward](/user_profile?user_id=346453)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/3e201149abea356acc9bb6f0eea8b5a0?d=mm&size=40)  [bwc](/user_profile?user_id=478411)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

9 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-low, Whiteboard: [webrtc])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[webrtc]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [bug905080c4.diff](/attachment.cgi?id=790211)  [11 years ago](#c4)  [Julian Seward [:jseward]](/user_profile?user_id=346453)   612 bytes, patch |  | [Details](/attachment.cgi?id=790211&action=edit) | [Diff](/attachment.cgi?id=790211&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=905080&attachment=790211) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Julian Seward [:jseward]](/user_profile?user_id=346453)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=905080#c0)• 11 years ago |
|  | |

TEST\_PATH=dom/media/tests/mochitest/test\_dataChannel\_basicAudio.html
It appears that sctp\_send\_initiate\_ack is creating uninitialised
values which are then copied to various different places, and result
in multiple Memcheck error reports.
Thread 3:
Use of uninitialised value of size 8
at 0x58422C9: sctp\_calculate\_cksum (sctp\_crc32.c:555)
by 0x585F821: sctp\_lowlevel\_chunk\_output (sctp\_output.c:4808)
by 0x586B084: sctp\_send\_initiate\_ack (sctp\_output.c:6295)
by 0x584BE38: sctp\_handle\_init (sctp\_input.c:217)
by 0x5851BA8: sctp\_process\_control (sctp\_input.c:4887)
by 0x5855EE9: sctp\_common\_input\_processing (sctp\_input.c:5907)
by 0x5891E30: usrsctp\_conninput (user\_socket.c:3189)
by 0x58929E6: mozilla::DataChannelConnection::SctpDtlsInput(mozilla::TransportFlow\*, unsigned char const\*, unsigned long) (DataChannel.cpp:654)
by 0x5891FC7: sigslot::\_connection3<mozilla::MediaPipeline, mozilla::TransportLayer\*, unsigned char const\*, unsigned long, sigslot::single\_threaded>::emit(mozilla::TransportLayer\*, unsigned char const\*, unsigned long) (sigslot.h:1944)
by 0x700FCD7: mozilla::TransportFlow::PacketReceived(mozilla::TransportLayer\*, unsigned char const\*, unsigned long) (sigslot.h:2477)
by 0x5891FC7: sigslot::\_connection3<mozilla::MediaPipeline, mozilla::TransportLayer\*, unsigned char const\*, unsigned long, sigslot::single\_threaded>::emit(mozilla::TransportLayer\*, unsigned char const\*, unsigned long) (sigslot.h:1944)
by 0x70185CD: sigslot::signal3<mozilla::TransportLayer\*, unsigned char const\*, unsigned long, sigslot::single\_threaded>::operator()(mozilla::TransportLayer\*, unsigned char const\*, unsigned long) (sigslot.h:2477)
Use of uninitialised value of size 8
at 0x58422D8: sctp\_calculate\_cksum (sctp\_crc32.c:558)
by 0x585F821: sctp\_lowlevel\_chunk\_output (sctp\_output.c:4808)
by 0x586B084: sctp\_send\_initiate\_ack (sctp\_output.c:6295)
by 0x584BE38: sctp\_handle\_init (sctp\_input.c:217)
by 0x5851BA8: sctp\_process\_control (sctp\_input.c:4887)
by 0x5855EE9: sctp\_common\_input\_processing (sctp\_input.c:5907)
by 0x5891E30: usrsctp\_conninput (user\_socket.c:3189)
by 0x58929E6: mozilla::DataChannelConnection::SctpDtlsInput(mozilla::TransportFlow\*, unsigned char const\*, unsigned long) (DataChannel.cpp:654)
by 0x5891FC7: sigslot::\_connection3<mozilla::MediaPipeline, mozilla::TransportLayer\*, unsigned char const\*, unsigned long, sigslot::single\_threaded>::emit(mozilla::TransportLayer\*, unsigned char const\*, unsigned long) (sigslot.h:1944)
by 0x700FCD7: mozilla::TransportFlow::PacketReceived(mozilla::TransportLayer\*, unsigned char const\*, unsigned long) (sigslot.h:2477)
by 0x5891FC7: sigslot::\_connection3<mozilla::MediaPipeline, mozilla::TransportLayer\*, unsigned char const\*, unsigned long, sigslot::single\_threaded>::emit(mozilla::TransportLayer\*, unsigned char const\*, unsigned long) (sigslot.h:1944)
by 0x70185CD: sigslot::signal3<mozilla::TransportLayer\*, unsigned char const\*, unsigned long, sigslot::single\_threaded>::operator()(mozilla::TransportLayer\*, unsigned char const\*, unsigned long) (sigslot.h:2477)
Uninitialised value was created by a stack allocation
at 0x586A486: sctp\_send\_initiate\_ack (sctp\_output.c:5652)
(and a whole bunch more of the above, followed by a bunch of the following)
Use of uninitialised value of size 8
at 0x115788E4: rijndael\_encryptBlock128 (rijndael.c:577)
by 0x11579458: rijndael\_encryptCBC (rijndael.c:875)
by 0x11579F13: AES\_Encrypt (rijndael.c:1237)
by 0x17B1269A: NSC\_EncryptUpdate (pkcs11c.c:1000)
by 0x4CD04C9: PK11\_CipherOp (pk11cxt.c:700)
by 0x4DDE1D8: ssl3\_CompressMACEncryptRecord (ssl3con.c:2424)
by 0x4DDAD82: dtls\_CompressMACEncryptRecord (dtlscon.c:803)
by 0x4DDE590: ssl3\_SendRecord (ssl3con.c:2635)
by 0x4DDE956: ssl3\_SendApplicationData (ssl3con.c:2775)
by 0x4DEE1C2: ssl\_SecureSend (sslsecur.c:1304)
by 0x4DF0BB1: ssl\_Send (sslsock.c:2139)
by 0x4C49868: PR\_Send (priometh.c:194)
Uninitialised value was created by a stack allocation
at 0x586A486: sctp\_send\_initiate\_ack (sctp\_output.c:5652)

|  | [Michael Tüxen](/user_profile?user_id=459963)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=905080#c1)• 11 years ago |
|  | |

Any idea where the 8 bytes belong to? From looking at the code, we allocate
struct sctp\_state\_cookie stc on the stack. Some bytes are left uninitialized,
since they are not used. That shouldn't be a problem. To test this, you can
add at the beginning of sctp\_send\_initiate\_ack() the following line:
memset(&stc, 0, sizeof(struct sctp\_state\_cookie));
If that suppresses the warning, fine. However, it should not be an issue.
Are you able to test the above change?
Best regards
Michael

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=905080#c2)• 11 years ago |
|  | |

stc is copied into m; if stc has uninitialized bytes then m will, and the crc for m (the packet) is now calculated across uninitiated bytes which causes the triggers. This will trigger valgrind and valgrind-like tools, and is also in theory a potential information leak (albeit small) since these parts of stc are sent to a peer. This is a minor privacy/sec issue. (perhaps I'm being overly paranoid, in which case we can re-open it.)
memset should do nicely (or my preference: memset(&stc, 0, sizeof(stc)) - habit, rely on the compiler to know what the size/type of something is. Avoids silly mistakes like memset(&ptr, 0, sizeof(thing\_pointed\_to)) and memset(foo, 0, sizeof(type\_foo\_used\_to\_be)). You still have to be careful to use memset(ptr, 0, sizeof(\*ptr)); the rule is & on the first, OR \* on the second. But this is a personal style thing. But I've seen a lot of those first two errors over time.Assignee: nobody → tuexenGroup: media-core-securityKeywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)OS: Linux → AllHardware: x86\_64 → AllWhiteboard: [webrtc]

|  | [Michael Tüxen](/user_profile?user_id=459963)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=905080#c3)• 11 years ago |
|  | |

... I do see that we leave some stuff uninitialized in stc. I just wanted to make
sure that we know that it is stc. I'm currently looking into which fields are left
uninitialized in which case. Just wanted to be sure that it is actually stc, not
another stack variable... How can I check?
I do see some bytes uninitialized, but not 8 consecutive ones...OS: All → LinuxHardware: All → x86\_64

|  | [Julian Seward [:jseward]](/user_profile?user_id=346453)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=905080#c4)• 11 years ago |
|  | |

Attached patch

[bug905080c4.diff](attachment.cgi?id=790211&action=diff)
— [Details](attachment.cgi?id=790211&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=905080&attachment=790211)

One-liner: memset(&stc, 0, sizeof(stc));
makes all the Memcheck warnings go away.

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=905080#c5)• 11 years ago |
|  | |

Aha. Size 8 would indicate an x64 pointer or integer, but in this case it may mean that one or more bits/bytes in the 8-byte value loaded was uninitialized

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=905080#c6)• 11 years ago |
|  | |

(In reply to Julian Seward from [comment #4](/show_bug.cgi?id=905080#c4 "RESOLVED FIXED - Uninitialised value use relating to sctp_send_initiate_ack"))
> Created [attachment 790211](/attachment.cgi?id=790211 "bug905080c4.diff") [[details]](/attachment.cgi?id=790211&action=edit "bug905080c4.diff") [[diff]](/attachment.cgi?id=790211&action=diff "bug905080c4.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=905080&attachment=790211)
> [bug905080](/show_bug.cgi?id=905080 "RESOLVED FIXED - Uninitialised value use relating to sctp_send_initiate_ack")c4.diff
>
> One-liner: memset(&stc, 0, sizeof(stc));
> makes all the Memcheck warnings go away.
Sounds good! We can take it locally and when it goes in upstream just let that erase our local fix.

|  | [Julian Seward [:jseward]](/user_profile?user_id=346453)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=905080#c7)• 11 years ago |
|  | |

(In reply to Randell Jesup [:jesup] from [comment #5](/show_bug.cgi?id=905080#c5 "RESOLVED FIXED - Uninitialised value use relating to sctp_send_initiate_ack"))
> Aha. Size 8 would indicate an x64 pointer or integer, but in this case it
> may mean that one or more bits/bytes in the 8-byte value loaded was
> uninitialized
Ah, sorry. I just realised that the "uninitialised value of size 8" message
might have been confusing. What this really means is that a memory address
(for a load or store instruction) was found to contain at least on undefined
bit. As you say, it doesn't imply that the undefined part of the struct was
8 bytes long.

|  | [Michael Tüxen](/user_profile?user_id=459963)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=905080#c8)• 11 years ago |
|  | |

(In reply to Julian Seward from [comment #4](/show_bug.cgi?id=905080#c4 "RESOLVED FIXED - Uninitialised value use relating to sctp_send_initiate_ack"))
> Created [attachment 790211](/attachment.cgi?id=790211 "bug905080c4.diff") [[details]](/attachment.cgi?id=790211&action=edit "bug905080c4.diff") [[diff]](/attachment.cgi?id=790211&action=diff "bug905080c4.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=905080&attachment=790211)
> [bug905080](/show_bug.cgi?id=905080 "RESOLVED FIXED - Uninitialised value use relating to sctp_send_initiate_ack")c4.diff
>
> One-liner: memset(&stc, 0, sizeof(stc));
> makes all the Memcheck warnings go away.
Great, thanks for the information. This means that I'm focusing on the right code
to fix.

|  | [Michael Tüxen](/user_profile?user_id=459963)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=905080#c9)• 11 years ago |
|  | |

(In reply to Randell Jesup [:jesup] from [comment #6](/show_bug.cgi?id=905080#c6 "RESOLVED FIXED - Uninitialised value use relating to sctp_send_initiate_ack"))
> (In reply to Julian Seward from [comment #4](/show_bug.cgi?id=905080#c4 "RESOLVED FIXED - Uninitialised value use relating to sctp_send_initiate_ack"))
> > Created [attachment 790211](/attachment.cgi?id=790211 "bug905080c4.diff") [[details]](/attachment.cgi?id=790211&action=edit "bug905080c4.diff") [[diff]](/attachment.cgi?id=790211&action=diff "bug905080c4.diff") [[review]](/page.cgi?id=splinter.html&ignore=&bug=905080&attachment=790211)
> > [bug905080](/show_bug.cgi?id=905080 "RESOLVED FIXED - Uninitialised value use relating to sctp_send_initiate_ack")c4.diff
> >
> > One-liner: memset(&stc, 0, sizeof(stc));
> > makes all the Memcheck warnings go away.
>
> Sounds good! We can take it locally and when it goes in upstream just let
> that erase our local fix.
Whatever you prefer. I guess I'll check in a fix (initializing the missing
components instead of zeroing everything) later today. I'll let you know.

|  | [Michael Tüxen](/user_profile?user_id=459963)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=905080#c10)• 11 years ago |
|  | |

Fixed upstream in
<http://code.google.com/p/sctp-refimpl/source/detail?r=8563>
I have added code to explicitly set all components and also
zero out the whole structure since we currently fill the
identification buffer not completely and the time stamp
component contains some padding on all platforms.
Thanks a lot for reporting the issue!
Best regards
Michael

|  | [Michael Tüxen](/user_profile?user_id=459963)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=905080#c11)• 11 years ago |
|  | |

On the FreeBSD kernel stack (which also uses the same code base for SCTP)
there are two times 4 bytes of kernel memory leaked by this bug.
A corresponding fix has been committed there and will make it into
the upcoming FreeBSD 9.2.
The FreeBSD project is preparing a Security Advisory regarding this.
Who should be listed in credits? Julian Seward (jseward@acm.org) or
the Mozilla project or anyone else?
Best regards
Michael

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=905080#c12)• 11 years ago |
|  | |

See Michael's question about who should be listed in FreeBSD's advisoryFlags: needinfo?(jseward)Flags: needinfo?(dveditz)

|  | [Julian Seward [:jseward]](/user_profile?user_id=346453)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=905080#c13)• 11 years ago |
|  | |

I am happy to be listed in the advisory if that's the convention, but
actually I have no idea what the conventions are in this kind of case.
Maybe dveditz can advise.Flags: needinfo?(jseward)

|  | [Michael Tüxen](/user_profile?user_id=459963)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=905080#c14)• 11 years ago |
|  | |

The FreeBSD sec team will finalize the advisory on Monday, so if there
is no additional information until that point of time,
Julian Seward and myself will be listed in the 'Credits'.
If that is not OK, let me know soon...

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=905080#c15)• 11 years ago |
|  | |

This should be fixed by the sctp library update landed in [bug 916427](/show_bug.cgi?id=916427 "RESOLVED FIXED - Update SCTP from upstream")Status: NEW → RESOLVEDClosed: 11 years agoResolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=905080#a21178356_75935)• 11 years ago |

Target Milestone: --- → mozilla30

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=905080#a22232488_1689)• 11 years ago |

Group: media-core-security → core-security

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=905080#c16)• 11 years ago |
|  | |

(In reply to Randell Jesup [:jesup] from [comment #15](/show_bug.cgi?id=905080#c15 "RESOLVED FIXED - Uninitialised value use relating to sctp_send_initiate_ack"))
> This should be fixed by the sctp library update landed in [bug 916427](/show_bug.cgi?id=916427 "RESOLVED FIXED - Update SCTP from upstream")
Are we going to land this anywhere else?

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=905080#a27874612_272375)• 11 years ago |

[status-firefox-esr24](/buglist.cgi?f1=cf_status_firefox_esr24&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr24&o1=equals&v1=wontfix)

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=905080#a64703201_546015)• 9 years ago |

Group: core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=905080#a88605735_1689)• 9 years ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=905080#a131181777_1689)• 7 years ago |

Flags: needinfo?(dveditz)
You need to [log in](/show_bug.cgi?id=905080&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Julian Seward [:jseward]](/user_profile?user_id=346453)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from svnweb.freebsd.org_79a71709_20250125_203249.html ===


| **</>[[base]](/base/)** |  |
| --- | --- |

![ViewVC logotype](/*docroot*/images/viewvc-logo.png)
# Revision 254338

---

| Jump to revision: | [Previous](/base?view=revision&revision=254337 "Previous Revision") [Next](/base?view=revision&revision=254339 "Next Revision") |
| --- | --- |
| Author: | tuexen |
| Date: | Wed Aug 14 21:51:32 2013 UTC *(11 years, 4 months ago)* |
| Changed paths: | **1** |
| Log Message: | ``` Don't send uninitialized memory (two instances of 4 bytes) in every cookie on the wire. This bug was reported in <https://bugzilla.mozilla.org/show_bug.cgi?id=905080>  MFC after: 3 days   ``` |

---

## Changed paths

| Path | Details |
| --- | --- |
| [Directoryhead/sys/netinet/sctp\_output.c](/base/head/sys/netinet/sctp_output.c?view=markup&pathrev=254338 "View File Contents") | [modified](/base/head/sys/netinet/sctp_output.c?view=log&pathrev=254338 "View Log") , [text changed](/base/head/sys/netinet/sctp_output.c?r1=254338&r2=254337&pathrev=254338 "View Diff") |

---

|  | **[ViewVC Help](/%2Adocroot%2A/help_rootview.html)** |
| --- | --- |
| Powered by [ViewVC 1.1.27](http://viewvc.org/) |  |


