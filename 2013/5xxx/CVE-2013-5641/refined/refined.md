Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:**

- A crash vulnerability exists in the SIP channel driver of Asterisk.
- The vulnerability occurs when an ACK (acknowledgement) message containing SDP (Session Description Protocol) is received after the associated SIP channel has been terminated.
- The code handling the ACK with SDP incorrectly assumes that the channel is always present, leading to a null pointer dereference when trying to access the channel data.

**Weaknesses/Vulnerabilities:**

- **Incorrect Channel State Assumption**: The code doesn't verify if the SIP channel still exists when processing an ACK with SDP after termination.
- **Null Pointer Dereference:** Accessing the channel object after it has been freed leads to a crash due to dereferencing a null pointer.
- **Direct Media Handling**: The issue is triggered when direct media is negotiated and SDP is included in an ACK message.

**Impact of Exploitation:**

- **Denial of Service (DoS):** A remote attacker can cause Asterisk to crash, interrupting VoIP services.
- **Service Disruption:** The crash leads to the termination of active calls and unavailability of the PBX system.

**Attack Vectors:**

- **Remote Unauthenticated Sessions:** The attacker does not need to be authenticated to exploit this vulnerability.
- **Specifically Crafted SIP Messages**: The attacker sends a SIP ACK message with SDP after the channel has been terminated.
- **Timing-Sensitive:** The attack relies on the ACK arriving after the channel is terminated. This timing can be manipulated by the attacker to reliably trigger the crash.

**Required Attacker Capabilities/Position:**

- **Network Access:** The attacker needs to be able to send SIP messages to the Asterisk server.
- **SIP Protocol Knowledge**: The attacker should have knowledge of the SIP protocol to construct the malicious ACK message with SDP.
- **Control over SIP Messaging**: The attacker needs to manipulate the timing of SIP messages (particularly the ACK) to trigger the vulnerability.

**Additional Details:**

- The vulnerability is triggered by the code added to handle SDP in ACK messages that was introduced in SVN revision 371337.
- The fix involves adding a check to ensure the Asterisk channel is still present before parsing the SDP information in the ACK.
- The issue is related to the interaction between direct media negotiation and how Asterisk handles SDP updates.
- The vulnerability affects multiple versions of Asterisk, including open source and certified versions, as noted in the advisory.
- The issue was identified by Colin Cuthbertson, with the fix provided by Walter Doekes.