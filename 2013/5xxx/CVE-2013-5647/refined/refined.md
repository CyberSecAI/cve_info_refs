- **Root cause of vulnerability**: The `sounder` gem's `play` method uses `system` to execute the `afplay` command with a filename obtained from user input without proper sanitization. This allows for command injection.
- **Weaknesses/vulnerabilities present**: Command injection vulnerability due to unsanitized user-controlled input passed to the `system` command.
- **Impact of exploitation**: Arbitrary commands can be executed on the system with the privileges of the user running the Ruby application. In the provided example, the attacker is able to execute the `id` command and redirect the output to a file.
- **Attack vectors**: By crafting a malicious filename containing shell metacharacters, an attacker can inject arbitrary commands into the `system` call.
- **Required attacker capabilities/position**: The attacker needs to be able to control the filename passed to the `play` method.