=== Content from www.vapid.dhs.org_74c2c3cc_20250125_062015.html ===


TITLE:  **Remote Command Injection in fog-dragonfly-0.8.2 Ruby Gem**

Credit: Larry W. Cashdollar, @\_larry0

Date: 8/16/2013

CVE: 2013-5671

Download: https://rubygems.org/gems/fog-dragonfly

Description:

"Dragonfly is an on-the-fly Rack-based image handling framework. It is suitable for use with Rails, Sinatra and other web frameworks. Although it's mainly used for images, it can handle any content type."

Unescaped user supplied input is passed to the command line for shell execution:

```
from fog-dragonfly-0.8.2/lib/dragonfly/imagemagickutils.rb:

20     def convert(tempobject, args='', format=nil)
 21       tempfile = newtempfile(format)
 22       run "#{convertcommand} #{args} #{tempobject.path} #{tempfile.path}"
 23       tempfile
 24     end
.
.
.

61     def run(command)
 62       log.debug("Running command: #{command}") if ImageMagickUtils.log_commands
 63       begin
 64         result = #{command}

Vendor Notified: 8/16/2013
```


=== Content from seclists.org_adb56625_20250125_062013.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](17)
[By Date](date.html#18)
[![Next](/images/right-icon-16x16.png)](19)

[![Previous](/images/left-icon-16x16.png)](16)
[By Thread](index.html#18)
[![Next](/images/right-icon-16x16.png)](20)

![](/shared/images/nst-icons.svg#search)

# Remote Command Injection in fog-dragonfly-0.8.2 Ruby Gem

---

*From*: "Larry W. Cashdollar" <larry0 () me com>

*Date*: Tue, 03 Sep 2013 03:42:08 +0000 (GMT)

---

```

TITLE: Remote Command Injection in fog-dragonfly-0.8.2 Ruby Gem

Credit: Larry W. Cashdollar, @_larry0

Date: 8/16/2013

CVE: 2013-5671

Download: <https://rubygems.org/gems/fog-dragonfly>

Description:
"Dragonfly is an on-the-fly Rack-based image handling framework. It is suitable for use with Rails, Sinatra and other web
frameworks. Although it's mainly used for images, it can handle any content type."
Unescaped user supplied input is passed to the command line for shell execution:
from fog-dragonfly-0.8.2/lib/dragonfly/imagemagickutils.rb:

20     def convert(tempobject, args='', format=nil)
21       tempfile = newtempfile(format)
22       run "#{convertcommand} #{args} #{tempobject.path} #{tempfile.path}"
23       tempfile
24     end
.
.
.

61     def run(command)
62       log.debug("Running command: #{command}") if ImageMagickUtils.log_commands
63       begin
64         result = #{command}

Vendor Notified: 8/16/2013
```
```
_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>
```

---

[![Previous](/images/left-icon-16x16.png)](17)
[By Date](date.html#18)
[![Next](/images/right-icon-16x16.png)](19)

[![Previous](/images/left-icon-16x16.png)](16)
[By Thread](index.html#18)
[![Next](/images/right-icon-16x16.png)](20)

### Current thread:

* **Remote Command Injection in fog-dragonfly-0.8.2 Ruby Gem** *Larry W. Cashdollar (Sep 02)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_18fd4238_20250125_062014.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](525)
[By Date](date.html#526)
[![Next](/images/right-icon-16x16.png)](527)

[![Previous](/images/left-icon-16x16.png)](527)
[By Thread](index.html#526)
[![Next](/images/right-icon-16x16.png)](528)

![](/shared/images/nst-icons.svg#search)

# Remote Command Injection in fog-dragonfly-0.8.2 Ruby Gem

---

*From*: "Larry W. Cashdollar" <larry0 () me com>

*Date*: Sun, 01 Sep 2013 05:11:05 +0000 (GMT)

---

```

Hi Can I have a CVE for the following please?

TITLE: Remote Command Injection in fog-dragonfly-0.8.2 Ruby Gem

Credit: Larry W. Cashdollar, @_larry0

Date: 8/16/2013

CVE: TBD

Download: <https://rubygems.org/gems/fog-dragonfly>

Description:
"Dragonfly is an on-the-fly Rack-based image handling framework. It is suitable for use with Rails, Sinatra and other web
frameworks. Although it's mainly used for images, it can handle any content type."
Unescaped user supplied input is passed to the command line for shell execution:
from fog-dragonfly-0.8.2/lib/dragonfly/imagemagickutils.rb:

20     def convert(tempobject, args='', format=nil)
21       tempfile = newtempfile(format)
22       run "#{convertcommand} #{args} #{tempobject.path} #{tempfile.path}"
23       tempfile
24     end
.
.
.

61     def run(command)
62       log.debug("Running command: #{command}") if ImageMagickUtils.log_commands
63       begin
64         result = #{command}

Vendor Notified: 8/16/2013
```

---

[![Previous](/images/left-icon-16x16.png)](525)
[By Date](date.html#526)
[![Next](/images/right-icon-16x16.png)](527)

[![Previous](/images/left-icon-16x16.png)](527)
[By Thread](index.html#526)
[![Next](/images/right-icon-16x16.png)](528)

### Current thread:

* **Remote Command Injection in fog-dragonfly-0.8.2 Ruby Gem** *Larry W. Cashdollar (Aug 31)*
  + [Re: Remote Command Injection in fog-dragonfly-0.8.2 Ruby Gem](528) *cve-assign (Sep 01)*
    - [Re: Remote Command Injection in fog-dragonfly-0.8.2 Ruby Gem](529) *Larry Cashdollar (Sep 01)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_a3f24654_20250125_062015.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](527)
[By Date](date.html#528)
[![Next](/images/right-icon-16x16.png)](529)

[![Previous](/images/left-icon-16x16.png)](526)
[By Thread](index.html#528)
[![Next](/images/right-icon-16x16.png)](529)

![](/shared/images/nst-icons.svg#search)

# Re: Remote Command Injection in fog-dragonfly-0.8.2 Ruby Gem

---

*From*: cve-assign () mitre org

*Date*: Sun, 1 Sep 2013 12:25:17 -0400 (EDT)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

```
> ```
> Remote Command Injection in fog-dragonfly-0.8.2 Ruby Gem
> Download: <https://rubygems.org/gems/fog-dragonfly>
>
> "Dragonfly is an on-the-fly Rack-based image handling framework. It is
> suitable for use with Rails, Sinatra and other web frameworks.
>
> Unescaped user supplied input is passed to the command line for shell
> execution
>
> fog-dragonfly-0.8.2/lib/dragonfly/imagemagickutils.rb:
>
> 20     def convert(tempobject, args='', format=nil)
> 21       tempfile = newtempfile(format)
> 22       run "#{convertcommand} #{args} #{tempobject.path} #{tempfile.path}"
> 23       tempfile
> 24     end
>
>
> 61     def run(command)
> 62       log.debug("Running command: #{command}") if ImageMagickUtils.log_commands
> 63       begin
> 64         result = #{command}
>
> ```

```

Use CVE-2013-5671 for this vulnerability in the fog-dragonfly gem. As
far as we can tell, this is a vulnerability in the fog-dragonfly gem,
not a vulnerability in Dragonfly. We found these possibly related
fixes in Dragonfly:

<https://github.com/markevans/dragonfly/commit/ff141bb1d921fff506084b62a562f7a83d5e01fe#lib/dragonfly/image_magick/utils.rb>

  <https://github.com/markevans/dragonfly/commit/47f95bd6b8af11fb0a44d6ab1c6f7d00d880cb68>

If the unpatched Dragonfly code has a vulnerability in a common use
case, this would require a separate CVE ID.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJSI2XoAAoJEGvefgSNfHMdv0oH/j0G7m0PMSwn1FvIcVpR39EP
yKTuTfa9I5MSr2DXejQQ+5lhJN7eTJwjOTPETpGOu0BkDgMkRvcuw81PqgVwkWXc
bT8DfNM/cO4vM3UjTJiTKYinVRMl3xsjGVzkwxV0E1mYhjbjrKGNUMgzjNPsSnja
eNYC26v2UDLn3Jw8K7qXTk+ytgFqOE+MiA/KDXBvm6fB1SBOoeeaMGU7NNdCw8A9
95TdYNzYE3JL7V0zz/5oidqkg0hlznK21KR01hUJK0s/U60rdzgA/73O+g8XSP4q
vyqN0ykgSDodfAt6JsONR/5wzaXTmc25ZXaB3wMGG9yUxFZiORzVGSsWJ7mlad0=
=SUlN
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](527)
[By Date](date.html#528)
[![Next](/images/right-icon-16x16.png)](529)

[![Previous](/images/left-icon-16x16.png)](526)
[By Thread](index.html#528)
[![Next](/images/right-icon-16x16.png)](529)

### Current thread:

* [Remote Command Injection in fog-dragonfly-0.8.2 Ruby Gem](526) *Larry W. Cashdollar (Aug 31)*
  + **Re: Remote Command Injection in fog-dragonfly-0.8.2 Ruby Gem** *cve-assign (Sep 01)*
    - [Re: Remote Command Injection in fog-dragonfly-0.8.2 Ruby Gem](529) *Larry Cashdollar (Sep 01)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


