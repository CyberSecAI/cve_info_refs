- **Root cause of vulnerability:** The DrayTek Vigor 2700 ADSL router stores discovered SSIDs in the `sWlessSurvey` variable within `variables.js`. This file is used by the web administration console. By including JavaScript code in the SSID of a malicious access point, an attacker can inject commands when the router adds the SSID to `variables.js`.
- **Weaknesses/vulnerabilities present:** Command injection vulnerability (CWE-77) due to improper neutralization of special elements used in a command.
- **Impact of exploitation:** An attacker can corrupt the `variables.js` file, leading to the execution of external scripts, unauthorized changes to settings (including DNS cache poisoning), and denial of service by sending JavaScript alert messages to the web console, preventing router administration.
- **Attack vectors:** The attacker sets up a malicious access point with a crafted SSID containing malicious JavaScript code. The router, upon scanning for SSIDs, adds the malicious SSID to its `variables.js`, triggering the command injection when the web interface is accessed.
- **Required attacker capabilities/position:** The attacker must be within range of the DrayTek Vigor ADSL router to set up a malicious access point. The victim must also either manually scan for SSIDs from the web administration page or the device must be powered on to automatically scan for SSIDs in range.