=== Content from www.ioactive.com_c2e14d5e_20250125_114529.html ===
IOActive Security Advisory

Title

Severity

Belkin WeMo Home Automation Vulnerabilities

Critical

Discovered by

Mike Davis

Affected Products

•  Belkin WeMo products

•  Devices built on the WeMo firmware

Impact

Belkin has recently produced a line of home-automation products under the WeMo name. For more information, see:

http://www.belkin.com/us/Products/home-automation/c/wemo-home-automation

These products feature iPhone and Android applications that:

•  Monitor onboard sensors, such as motion sensors and streaming audio

•  Actuate controls, such as relays and LEDs

While researchers have reported some security issues relating to these products, their cloud features are secure when used on
the local network. For more information, see:

http://www.youtube.com/watch?v=BcW2q0aHOFo

IOActive examined the WeMo “Light Switch” firmware and uncovered a series of issues. When combined, these issues produce
a variety of vulnerabilities:

•  Remote control of attached devices over the internet

Copyright ©2014. All Rights Reserved.  [1]

•  Malicious firmware updates

•

•

In some cases, remote monitoring

Internal LAN access

The WeMo devices connect to the Internet using the STUN/TURN protocol. This gives users remote control of the devices and
allows them to perform firmware updates from anywhere in the world. A generated GUID is the primary source of access control.

WeMo also uses a GPG-based, encrypted firmware distribution scheme to maintain device integrity during updates.
Unfortunately, attackers can easily bypass most of these features due to the way they are currently implemented in the WeMo
product line. The command for performing firmware updates is initiated over the Internet from a paired device. Also, firmware
update notices are delivered through an RSS-like mechanism to the paired device, rather than the WeMo device itself, which is
distributed over a non-encrypted channel. As a result, attackers can easily push firmware updates to WeMo users by spoofing
the RSS feed with a correctly signed firmware.

The firmware updates are encrypted using GPG, which is intended to prevent this issue. Unfortunately, Belkin misuses the GPG
asymmetric encryption functionality, forcing it to distribute the firmware-signing key within the WeMo firmware image. Most likely,
Belkin intended to use the symmetric encryption with a signature and a shared public key ring. Attackers could leverage the
current implementation to easily sign firmware images.

Belkin uses STUN/TURN and an exposed firmware signing key. IOActive discovered an unfortunate configuration relating to this.
A lack of entropy on the device results on less-than-random GUIDs. IOActive also discovered that the WeMo restful service
endpoint is vulnerable to attack. We reported to Belkin an arbitrary file download flaw relating to this.

Copyright ©2014. All Rights Reserved.  [2]

Signing Arbitrary Firmware:

(Canopy 64bit) phar@aiken ~/wemo$ echo "signeded firmwares" | gpg -u DCEB4E79 --clearsign | tee | gpg

You need a passphrase to unlock the secret key for
user: "Plug-Ins (Belkin) <customerservice@belkin.com>"
1024-bit DSA key, ID DCEB4E79, created 2011-07-10

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: GPGTools - http://gpgtools.org

iEYEARECAAYFAlJOfewACgkQHBPU5dzrTnm2TACfZKZ2VACK8XTjAF5K44/KC6I2
CDEAnjz01bGZoXqSEFDfIbmHb72TzMA9
=5f37
-----END PGP SIGNATURE-----
gpg: Signature made Fri 04 Oct 2013 01:37:00 AM PDT using DSA key ID DCEB4E79
gpg: Good signature from "Plug-Ins (Belkin) <customerservice@belkin.com>"
gpg: WARNING: This key is not certified with a trusted signature!
gpg:          There is no indication that the signature belongs to the owner.
Primary key fingerprint: 7A83 F0EF D7F8 7AEF BAA3  AE76 1C13 D4E5 DCEB 4E79

Copyright ©2014. All Rights Reserved.  [3]

Validating Key

The firmware-signing key is the validating key, as shown here:

(Canopy 64bit) phar@aiken:~/wemo$ curl https://fw.xbcs.net/plugin/device/firmware.txt | grep gpg
http://fw.xbcs.net/wemo/switchsensor/us/WeMo_US_2.00.2769.PVT_SNS.bin.gpg

(Canopy 64bit) phar@aiken:~/wemo$ wget
http://fw.xbcs.net/wemo/switchsensor/us/WeMo_US_2.00.2769.PVT_SNS.bin.gpg

100%[==================================================================================================
============================================================================================>]
5,129,010    572K/s   in 8.8s

2013-10-04 01:41:30 (566 KB/s) - `WeMo_US_2.00.2769.PVT_SNS.bin.gpg' saved [5129010/5129010]

(Canopy 64bit) phar@aiken:~/wemo$ gpg -d -oWeMo_US_2.00.2769.PVT_SNS.bin
WeMo_US_2.00.2769.PVT_SNS.bin.gpg

You need a passphrase to unlock the secret key for
user: "Plug-Ins (Belkin) <customerservice@belkin.com>"
1024-bit ELG-E key, ID B6C5CB2D, created 2011-07-10 (main key ID DCEB4E79)

gpg: encrypted with 1024-bit ELG-E key, ID B6C5CB2D, created 2011-07-10
      "Plug-Ins (Belkin) <customerservice@belkin.com>"

 (Canopy 64bit) phar@aiken:~/wemo$ hexdump -C WeMo_US_2.00.2769.PVT_SNS.bin | head
00000000  e9 45 20 4e 0e 47 4d 54  4b 50 6c 75 67 49 6e 73  |.E N.GMTKPlugIns|
00000010  30 30 58 27 05 19 56 fd  bc be fb 51 c4 02 2a 00  |00X'..V....Q..*.|
00000020  0c 77 f7 80 00 00 00 80  25 50 00 48 3d cb 42 05  |.w......%P.H=.B.|
00000030  05 02 03 4c 69 6e 75 78  20 4b 65 72 6e 65 6c 20  |...Linux Kernel |
00000040  49 6d 61 67 65 00 00 00  00 00 00 00 00 00 00 00  |Image...........|
00000050  00 00 00 5d 00 00 00 02  ec fb 26 00 00 00 00 00  |...]......&.....|
00000060  00 00 6f fd ff ff a3 b7  7f 62 2d 9c c6 5f 6c 10  |..o......b-.._l.|
00000070  7d 36 27 40 3f 77 b9 af  25 1c 5a 3c ed 4b 4a d1  |}6'@?w..%.Z<.KJ.|
00000080  98 b0 b5 92 4b 88 17 aa  b5 59 c5 0a e6 3f cf da  |....K....Y...?..|
00000090  56 7a 41 12 1c 1d e4 d9  ba 22 fb 22 1b 47 03 ea  |VzA......".".G..|

Copyright ©2014. All Rights Reserved.  [4]

Solution

Because Belkin has not produced fixes for the issues discussed in this advisory, as a solution, IOActive recommends unplugging
all affected devices from the WeMo products.

Copyright ©2014. All Rights Reserved.  [5]



=== Content from www.kb.cert.org_b5cc3361_20250125_114530.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#656302

## Belkin Wemo Home Automation devices contain multiple vulnerabilities

#### Vulnerability Note VU#656302

Original Release Date: 2014-02-18 | Last Revised: 2014-07-29

---

### Overview

Belkin Wemo Home Automation devices contain multiple vulnerabilities.

### Description

| **CWE-321: Use of Hard-coded Cryptographic Key -** **CVE-2013-6952**  Belkin Wemo Home Automation firmware contains a hard-coded cryptographic key and password. An attacker may be able to extract the key and password to sign a malicious firmware update.**CWE-494: Download of Code Without Integrity Check -** **CVE-2013-6951**Belkin Wemo Home Automation devices do not have a local Certificate store to verify the integrity of SSL connections.**CWE-319: Cleartext Transmission of Sensitive Information -** **CVE-2013-6950**Belkin Wemo Home Automation firmware distribution feed does not use SSL encryption.**CWE-441: Unintended Proxy or Intermediary ('Confused Deputy') -** **CVE-2013-6949**Belkin Wemo Home Automation devices use STUN & TURN protocols. An attacker with control of one Wemo device may be able to use the STUN & TURN protocols to relay connections to any other Wemo device.**CWE-611: Improper Restriction of XML External Entity Reference ('XXE****'****) -** **CVE-2013-6948**Belkin Wemo Home Automation API server contains a XML injection vulnerability. The peerAddresses API can be attacked through XML injection, which may reveal the contents of system files.Additional details may be found in the [IOActive advisory](http://www.ioactive.com/pdfs/IOActive_Belkin-advisory-lite.pdf). |
| --- |

### Impact

| A remote unauthenticated attacker may be able to sign malicious firmware, relay malicious connections, or access device system files to potentially gain complete access to the device. |
| --- |

### Solution

| **Update Apps and Firmware**Users with the most recent firmware release (version 3949) are not at risk for malicious firmware attacks or remote control or monitoring of WeMo devices from unauthorized devices. Belkin urges such users to download the latest app from the App Store (version 1.4.1) or Google Play Store (version 1.1.2) and then upgrade the firmware version through the app.Specific fixes Belkin has issued include:1) An update to the WeMo API server on November 5, 2013 that prevents an XML injection attack from gaining access to other WeMo devices.2) An update to the WeMo firmware, published on January 24, 2014, that adds SSL encryption and validation to the WeMo firmware distribution feed, eliminates storage of the signing key on the device, and password protects the serial port interface to prevent a malicious firmware attack3) An update to the WeMo app for both iOS (published on January 24, 2014) and Android (published on February 10, 2014) that contains the most recent firmware update. |
| --- |

### Vendor Information

656302
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23656302/) to view vendors.**
### [Belkin, Inc.](#BLUU-9CSSZ3) Affected

Notified:  October 24, 2013  Updated: February 20, 2014

### Status

Affected

### Vendor Statement

Belkin has corrected the list of five potential vulnerabilities affecting the WeMo line of home automation solutions that was published in a CERT advisory on February 18. Belkin was in contact with the security researchers prior to the publication of the advisory, and, as of February 18, had already issued fixes for each of the noted potential vulnerabilities via in-app notifications and updates. Users with the most recent firmware release (version 3949) are not at risk for malicious firmware attacks or remote control or monitoring of WeMo devices from unauthorized devices. Belkin urges such users to download the latest app from the App Store (version 1.4.1) or Google Play Store (version 1.1.2) and then upgrade the firmware version through the app.

Specific fixes Belkin has issued include:

1) An update to the WeMo API server on November 5, 2013 that prevents an XML injection attack from gaining access to other WeMo devices.

2) An update to the WeMo firmware, published on January 24, 2014, that adds SSL encryption and validation to the WeMo firmware distribution feed, eliminates storage of the signing key on the device, and password protects the serial port interface to prevent a malicious firmware attack

3) An update to the WeMo app for both iOS (published on January 24, 2014) and Android (published on February 10, 2014) that contains the most recent firmware update

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 7.8 | AV:N/AC:M/Au:N/C:P/I:C/A:N |
| Temporal | 5.8 | E:POC/RL:OF/RC:UR |
| Environmental | 1.5 | CDP:ND/TD:L/CR:ND/IR:ND/AR:ND |

### References

* <http://www.ioactive.com/pdfs/IOActive_Belkin-advisory-lite.pdf>
* <http://cwe.mitre.org/data/definitions/611.html>
* <http://cwe.mitre.org/data/definitions/321.html>
* <http://cwe.mitre.org/data/definitions/494.html>
* <http://cwe.mitre.org/data/definitions/441.html>
* <http://cwe.mitre.org/data/definitions/319.html>
* <http://www.belkin.com/us/Products/home-automation/c/wemo-home-automation>
### Acknowledgements

Thanks to Mike Davis of IOActive for reporting these vulnerabilities.

This document was written by Jared Allar.

### Other Information

| **CVE IDs:** | [CVE-2013-6948](http://web.nvd.nist.gov/vuln/detail/CVE-2013-6948), [CVE-2013-6949](http://web.nvd.nist.gov/vuln/detail/CVE-2013-6949), [CVE-2013-6950](http://web.nvd.nist.gov/vuln/detail/CVE-2013-6950), [CVE-2013-6951](http://web.nvd.nist.gov/vuln/detail/CVE-2013-6951), [CVE-2013-6952](http://web.nvd.nist.gov/vuln/detail/CVE-2013-6952) |
| --- | --- |
| **Date Public:** | 2013-12-09 |
| **Date First Published:** | 2014-02-18 |
| **Date Last Updated:** | 2014-07-29 22:25 UTC |
| **Document Revision:** | 50 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


