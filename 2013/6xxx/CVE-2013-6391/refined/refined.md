Based on the provided information, here's a breakdown of the vulnerability described in CVE-2013-6391:

**Root Cause of Vulnerability:**

The vulnerability stems from how OpenStack Keystone handles trusts in conjunction with the ec2tokens API. When a trustee uses a trust-scoped token to generate EC2 credentials, the resulting EC2 token is not scoped to the trust. This is because the trust information is not properly propagated when creating the EC2 token.

**Weaknesses/Vulnerabilities Present:**

*   **Improper Trust Scope Enforcement:** The ec2tokens API does not maintain the trust scope when generating tokens, allowing a trustee to obtain a token with elevated privileges.
*   **Missing Trust Context:** The ec2tokens API token generation process lacked awareness of the trust relationship, leading to the generation of tokens with the trustor's full permissions, instead of only the delegated roles.

**Impact of Exploitation:**

*   **Privilege Escalation:** A trustee, intended to have limited access through a trust, could elevate their privileges to all roles held by the trustor.
*   **Circumvention of Role Delegation:** The vulnerability allows a trustee to bypass the role delegation mechanism provided by trusts.

**Attack Vectors:**

*   An attacker needs to be a trustee with a token scoped to a trust.
*   The attacker creates an EC2 keypair using the trust-scoped token.
*   The attacker uses the generated keypair to request a new token via the ec2tokens API.

**Required Attacker Capabilities/Position:**

*   The attacker needs to have a valid user account on the OpenStack deployment.
*   The attacker's account must be the "trustee" in an existing trust relationship.
*  The OpenStack deployment must have EC2-style authentication enabled.

**Additional Details from the Content:**

*   The vulnerability affected OpenStack Keystone deployments from the Grizzly release and later, but was only exploitable in Havana and later due to a bug in Grizzly that prevented impersonation.
*   The fix involved storing the trust ID associated with the EC2 keypair and using this information when generating new tokens via the ec2tokens API.
*   The fix was applied in the master and stable/havana branches. For Grizzly, the fix involved disabling EC2 credentials for trust-scoped tokens due to the complexity of backporting the required changes.
* A client side fix (python-keystoneclient 0.4.1 or later) was also required to fully resolve the issue.
* There was some discussion of a related blueprint to enable the generation of ec2 credentials directly from tokens which was made obsolete by this fix.

In summary, CVE-2013-6391 describes a privilege escalation vulnerability in OpenStack Keystone's ec2tokens API where a trustee could gain elevated access by exploiting a lack of trust scope enforcement during EC2 token creation.