- **Root cause of vulnerability**: The `unpack_zip()` function in `sprout-0.7.246/lib/sprout/archive_unpacker.rb` uses the `%x()` system call to execute a shell command for unzipping files. This command is constructed using string interpolation, which includes user-controlled inputs (`zip_dir`, `zip_name`, and `output`) without proper sanitization.
- **Weaknesses/vulnerabilities present**: Command injection vulnerability. By controlling the `zip_dir`, `zip_name`, or `output` variables, an attacker can inject shell meta-characters that will be interpreted by the shell, leading to arbitrary command execution.
- **Impact of exploitation**: Arbitrary shell command execution on the server, leading to potential full compromise of the system.
- **Attack vectors**: The attacker needs to provide a crafted zip file name or directory that contains shell meta characters. For example, a crafted filename like `filename;id;.zip` would allow execution of the `id` command.
- **Required attacker capabilities/position**: The attacker must be able to control either the zip file name, the directory where the file is located, or the output path. This would likely involve a user-controlled file upload or input mechanism that is not properly sanitized.