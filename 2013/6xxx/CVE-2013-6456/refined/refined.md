```
{
  "CVE-2013-6456": {
    "Description": "The LXC driver (lxc/lxc_driver.c) in libvirt 1.0.1 through 1.2.1 allows local users to (1) delete arbitrary host devices via the virDomainDeviceDettach API and a symlink attack on /dev in the container; (2) create arbitrary nodes (mknod) via the virDomainDeviceAttach API and a symlink attack on /dev in the container; and cause a denial of service (shutdown or reboot host OS) via the (3) virDomainShutdown or (4) virDomainReboot API and a symlink attack on /dev/initctl in the container, related to \"paths under /proc/$PID/root\" and the virInitctlSetRunLevel function.",
    "Root cause of vulnerability": "The LXC driver opens paths under /proc/$PID/root for operations on running guests without proper validation of symlinks, allowing a malicious guest to manipulate files on the host system through symlink attacks.",
    "Weaknesses": [
      "Unsafe usage of paths under /proc/$PID/root",
      "Lack of proper validation of symlinks",
      "Insecure file manipulation using virDomainShutdown, virDomainReboot, virDomainDeviceAttach, and virDomainDeviceDettach APIs"
    ],
    "Impact": "A malicious guest can cause a denial of service (host OS shutdown or reboot), delete arbitrary host devices, or create arbitrary nodes (mknod) on the host system.",
    "Attack vectors": [
      "Symlink attack on /dev in the container for arbitrary host device deletion or node creation using  virDomainDeviceDettach and virDomainDeviceAttach APIs",
       "Symlink attack on /dev/initctl in the container to trigger host OS shutdown or reboot using the virDomainShutdown or virDomainReboot APIs"
    ],
    "Required attacker capabilities": "The attacker must be able to control a guest virtual machine and create symlinks within its filesystem. This can be achieved by a malicious guest user/process.",
    "Additional Information": "The vulnerability exists because libvirt directly opens paths under /proc/$PID/root based on what the container has, if a path component is a symlink controlled by container, then the administrator can be tricked to access arbitrary host directories/files. For the virDomainShutdown and virDomainReboot APIs, it will use this to access the /dev/initctl path in the container. For the virDomainDeviceAttach / virDomainDeviceDettach APIs, it will use this to create device nodes in the container's /dev filesystem."
  }
}
```