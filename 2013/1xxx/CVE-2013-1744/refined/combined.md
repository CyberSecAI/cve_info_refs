=== Content from infosecabsurdity.wordpress.com_9c6c3a78_20250124_173109.html ===

# [infosec absurdity](https://infosecabsurdity.wordpress.com/ "Home")

[![RSS](https://s2.wp.com/wp-content/themes/pub/structure/images/rss_icon.png "RSS feed")](https://infosecabsurdity.wordpress.com/feed/)

* [Home](https://infosecabsurdity.wordpress.com/)
* [About](https://infosecabsurdity.wordpress.com/about/)
* [Privacy Policy](https://infosecabsurdity.wordpress.com/privacy-policy/)
* [Research](https://infosecabsurdity.wordpress.com/research/)
  + [isa-2013-001](https://infosecabsurdity.wordpress.com/research/isa-2013-001/)
    - [PoC – ISA-2013-001](https://infosecabsurdity.wordpress.com/research/isa-2013-001/poc-isa-2013-001/)
  + [isa-2013-002](https://infosecabsurdity.wordpress.com/research/isa-2013-002/)
    - [PoC – ISA-2013-002](https://infosecabsurdity.wordpress.com/research/isa-2013-002/poc-isa-2013-002/)

### isa-2013-002

### I Read It Somewhere (IRIS) <= v1.3 Remote Command Execution Vulnerability

### Vendor:

<http://ireaditsomewhere.googlecode.com>

### Affected versions:

1.3 and below.

### Vulnerability Analysis:

Lines 40 – 43 of index.php set the $page variable to a controlled value.

```

if (isset($_GET['p']))
{
    $page = $_GET['p'];
}

```

Lines 55 – 60 of index.php ensure that our page value is either add/edit/account/logout or meta fields (if we are exploiting this bug with a user login).

```

$loginReq = array('add', 'edit', 'config', 'account', 'logout', 'metafields');
$adminReq = array('config');
if (!$user->loggedIn() && in_array($page, $loginReq))
{
    $page = 'summary';
}

```

Lines 82 – 105 of index.php uses a simple switch statement and executes the code from the relative page. If we set the page value to “add” or “edit” then they will execute the code from pages/add.php.

```

switch($page)
{
    case 'bibtex':
        require('pages/bibtex.php');
        $smarty->display('bibtex.tpl');
        return;
    break;

    case 'projects':
        require('pages/projects.php');
        $smarty->assign('template', 'projects');
        $smarty->assign('page_name', 'Projects');
    break;

    case 'add':
        require('pages/add.php');
        $smarty->assign('template', 'add');
        $smarty->assign('page_name', 'Add Reference');
    break;

    case 'edit':
        require('pages/add.php');
        $smarty->assign('template', 'add');
        $smarty->assign('page_name', 'Edit Reference');

```

As you can see on lines 348 – 379 of pages/add.php, there is a check for an import parameter and switches this value. If then set the “import” parameter to “spnro”, then we can control the “code” parameter via $\_GET. This value is used to construct the $url variable which is passed to the downloadPDF() function.

```

   if (isset($_GET['import'])) {
       switch ($_GET['import']) {

           case 'scholarsportal':
               $url = 'http://scholarsportal.info/cgi-bin/sciserv.pl?form=refer&collection='.$_GET['collection'].'&journal='.$_GET['journal'].'&issue='.$_GET
               ['issue'].'&article='.$_GET['article'];
               $smarty->assign('bibImport', downloadCitation($url));
               $url = 'http://scholarsportal.info/cgi-bin/sciserv.pl?collection='.$_GET['collection'].'&journal='.$_GET['journal'].'&issue='.$_GET['issue'].'&article='.
               $_GET['article'].'&form=pdf&file=file.pdf';
               downloadPDF($url);
               break;

           case 'jneurosci':
               $url = 'http://www.jneurosci.org/cgi/citmgr?type=bibtex&gca=jneuro;'.$_GET['code'];
               $smarty->assign('bibImport', downloadCitation($url));
               $url = 'http://www.jneurosci.org/cgi/reprint/'.$_GET['code'].'.pdf';
               downloadPDF($url);
               break;

           case 'jneurophys':
               $url = 'http://jn.physiology.org/cgi/citmgr?type=bibtex&gca=jn;'.$_GET['code'];
               $smarty->assign('bibImport', downloadCitation($url));
               $url = 'http:/jn.physiology.org/cgi/reprint/'.$_GET['code'].'.pdf';
               downloadPDF($url);
               break;

            case 'spnro':
                $url = 'http://online.sagepub.com/cgi/citmgr?type=endnote&gca=spnro;'.$_GET['code'];
                $smarty->assign('bibImport', downloadCitation($url));
                $url = 'http://spnro.sagepub.com/cgi/reprint/'.$_GET['code'].'.pdf';
                downloadPDF($url);
                break;
        }
    }

```

On lines 326 – 334 of pages/add.php, we can see the downloadPDF function. A command is constructed and the $url parameter is used to partly construct the command. The command is then fully trusted and executed.

```

    function downloadPDF($url) {                            // controlled signature
       global $tmpdir;
       $tmpFileName = $tmpdir.'/'.md5($url.rand(0,1000));
       $_SESSION['tmpfile'] = $tmpFileName;
       $_SESSION['tmpfile_name'] = 'imported.pdf';
       $wget = 'wget -O "'.$tmpFileName.'" "'.$url.'"';     // dirty...
       shell_exec($wget);                                   // bingo.
    }

```

Resulting in, you guessed it, blind remote command execution !

### Disclosure date:

[02/11/2013] – Public disclosure.

### Solution:

No solution.

### CVE Reference:

The Common Vulnerabilities and Exposures project ([cve.mitre.org](http://cve.mitre.org/))

has assigned the name [CVE-2013-1744](http://cve.mitre.org/cgi-bin/cvename.cgi?name=2013-1744) to this vulnerability.

### Credits:

This vulnerability was discovered by Aeon Flux.

### Proof of Concept:

[![iris](https://infosecabsurdity.wordpress.com/wp-content/uploads/2013/02/iris.png?w=150&h=45)](https://infosecabsurdity.wordpress.com/wp-content/uploads/2013/02/iris.png)

[isa-2013-002-poc.py](https://infosecabsurdity.wordpress.com/research/isa-2013-001/poc-isa-2013-002/)

* Copyright © 2013 Aeon Flux [Privacy Policy](https://infosecabsurdity.wordpress.com/privacy-policy/)

[infosec absurdity](https://infosecabsurdity.wordpress.com/ "Home") · because insecurity is logical

[Create a free website or blog at WordPress.com.](https://wordpress.com/?ref=footer_website)

* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) infosec absurdity](https://infosecabsurdity.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Finfosecabsurdity.wordpress.com%2Fresearch%2Fisa-2013-002%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) infosec absurdity](https://infosecabsurdity.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Finfosecabsurdity.wordpress.com%2Fresearch%2Fisa-2013-002%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/P2SWIw-6h)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://infosecabsurdity.wordpress.com/research/isa-2013-002/)
  + [View post in Reader](https://wordpress.com/read/blogs/42648096/posts/389)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email

Name

Website

###

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)

