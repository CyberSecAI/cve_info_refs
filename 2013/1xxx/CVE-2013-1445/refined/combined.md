=== Content from www.openwall.com_dd357355_20250125_223256.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux ¬† *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper ¬† *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists ¬† *for password cracking*](/wordlists/)+ [passwdqc ¬† *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt ¬† *KDF & password hashing*](/yescrypt/)+ [yespower ¬† *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish ¬† *password hashing*](/crypt/)+ [phpass ¬† *ditto in PHP*](/phpass/)+ [tcb ¬† *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd ¬† *port scan detector*](/scanlogd/)+ [popa3d ¬† *tiny POP3 daemon*](/popa3d/)+ [blists ¬† *web interface to mailing lists*](/blists/)+ [msulogin ¬† *single user mode login*](/msulogin/)+ [php\_mt\_seed ¬† *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20131017162841.GA22758@rivest.dlitz.net>
Date: Thu, 17 Oct 2013 09:28:41 -0700
From: Dwayne Litzenberger <dlitz@...tz.net>
To: pycrypto@...ts.dlitz.net, python-crypto@...hon.org,
	oss-security@...ts.openwall.com
Subject: CVE-2013-1445 python-crypto: PRNG not correctly reseeded in some
 situations

In PyCrypto before v2.6.1, the Crypto.Random pseudo-random number
generator (PRNG) exhibits a race condition that may cause it to generate
the same 'random' output in multiple processes that are forked from each
other.  Depending on the application, this could reveal sensitive
information or cryptographic keys to remote attackers.

An application may be affected if, within 100 milliseconds, it performs
the following steps (which may be summarized as "read-fork-read-read"):

1. Read from the Crypto.Random PRNG, causing an internal reseed;
2. Fork the process and invoke Crypto.Random.atfork() in the child;
3. Read from the Crypto.Random PRNG again, in at least two different
     processes (parent and child, or multiple children).

Only applications that invoke Crypto.Random.atfork() and perform the
above steps are affected by this issue.  Other applications are
unaffected.

Note: Some PyCrypto functions, such as key generation and PKCS#1-related
functions, implicitly read from the Crypto.Random PRNG.

== Technical details ==

Crypto.Random uses Fortuna[1] to generate random numbers.  The flow of
entropy looks something like this:

      /dev/urandom  -\
                      +-> "accumulator" --> "generator" --> output
      other sources -/   (entropy pools)     (AES-CTR)

- The "accumulator" maintains several pools that collect entropy from
    the environment.

- The "generator" is a deterministic PRNG that is reseeded by the
    accumulator.  Reseeding normally occurs during each request for random
    numbers, but never more than once every 100 ms (the "minimum reseed
    interval").

When a process is forked, the parent's state is duplicated in the child.
In order to continue using the PRNG, the child process must invoke
Crypto.Random.atfork(), which collects new entropy from /dev/urandom and
adds it to the accumulator.  When new PRNG output is subsequently
requested, some of the new entropy in the accumulator is used to reseed
the generator, causing the output of the child to diverge from its
parent.

However, in previous versions of PyCrypto, Crypto.Random.atfork() did
not explicitly reset the child's rate-limiter, so if the child requested
PRNG output before the minimum reseed interval of 100 ms had elapsed, it
would generate its output using state inherited from its parent.

This created a race condition between the parent process and its forked
children that could cause them to produce identical PRNG output for the
duration of the 100 ms minimum reseed interval.

== Demonstration ==

Here is some sample code that illustrates the problem:

      from binascii import hexlify
      import multiprocessing, pprint, time
      import Crypto.Random

      def task_main(arg):
          a = Crypto.Random.get_random_bytes(8)
          time.sleep(0.1)
          b = Crypto.Random.get_random_bytes(8)
          rdy, ack = arg
          rdy.set()
          ack.wait()
          return "%s,%s" % (hexlify(a).decode(),
                            hexlify(b).decode())

      n_procs = 4
      manager = multiprocessing.Manager()
      rdys = [manager.Event() for i in range(n_procs)]
      acks = [manager.Event() for i in range(n_procs)]
      Crypto.Random.get_random_bytes(1)
      pool = multiprocessing.Pool(processes=n_procs,
                                  initializer=Crypto.Random.atfork)
      res_async = pool.map_async(task_main, zip(rdys, acks))
      pool.close()
      [rdy.wait() for rdy in rdys]
      [ack.set() for ack in acks]
      res = res_async.get()
      pprint.pprint(sorted(res))
      pool.join()

The output should be random, but it looked like this:

      ['c607803ae01aa8c0,2e4de6457a304b34',
       'c607803ae01aa8c0,af80d08942b4c987',
       'c607803ae01aa8c0,b0e4c0853de927c4',
       'c607803ae01aa8c0,f0362585b3fceba4']

== Solution ==

The solution is to upgrade to PyCrypto v2.6.1 or later, which properly
resets the rate-limiter when Crypto.Random.atfork() is invoked in the
child.

== Files ==

PyCrypto v2.6.1 may be downloaded from the PyCrypto website[2], from
PyPI, or using your operating system's package manager or ports tree.

The official tarball has the following SHA256 sums:

f2ce1e989b272cfcb677616763e0a2e7ec659effa67a88aa92b3a65528f60a3c *pycrypto-2.6.1.tar.gz
c2ab0516cc55321e6543ae75e2aa6f6e56e97432870f32a7799f3b89f467dc1b *pycrypto-2.6.1.tar.gz.asc

The git repository is here: <https://github.com/dlitz/pycrypto/>
The v2.6.1 tag id is: ebb470d3f0982702e3e9b7fb9ebdaeed95903aaf
The v2.6.1 commit id is: 7fd528d03b5eae58eef6fd219af5d9ac9c83fa50

For informational purposes, patches against pycrypto v2.6 and v2.1.0 are
attached.  Distributors patching older versions of the library, please
remember to run the test suite before releasing a modified package:

    # From the source tree
    python setup.py build test

    # After installation
    python -m Crypto.SelfTest.__init__

== Thanks ==

Thanks to Yves-Alexis Perez and Sebastian Ramacher for helping to
coordinate the release of this fix.

== References ==

[1] N. Ferguson and B. Schneier, _Practical Cryptography_,
      Indianapolis: Wiley, 2003, pp. 155-184.

[2] <https://www.dlitz.net/software/pycrypto/> or <http://www.pycrypto.org/>

--
Dwayne C. Litzenberger <dlitz@...tz.net>
    OpenPGP: 19E1 1FE8 B3CF F273 ED17  4A24 928C EC13 39C2 5CF7

View attachment "[CVE-2013-1445-pycrypto2.6.patch](3/1)" of type "text/x-diff" (13972 bytes)

View attachment "[CVE-2013-1445-pycrypto2.1.0.patch](3/2)" of type "text/x-diff" (10454 bytes)

Download attachment "[signature.asc](3/3)" of type "application/pgp-signature" (223 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_cbdf0630_20250126_122932.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-x377-f64p-hf5j)

**CVE-2013-1445**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-x377-f64p-hf5j)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2013-1445](/advisories/GHSA-x377-f64p-hf5j)

## PyCrypto does not properly reseed PRNG before allowing access

High severity

GitHub Reviewed

Published
May 17, 2022
to the GitHub Advisory Database
‚Ä¢
Updated Oct 21, 2024

[Vulnerability details](/advisories/GHSA-x377-f64p-hf5j)
[Dependabot alerts
0](/advisories/GHSA-x377-f64p-hf5j/dependabot)

## Package

pip

pycrypto
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

< 2.6.1

## Patched versions

2.6.1

## Description

The Crypto.Random.atfork function in PyCrypto before 2.6.1 does not properly reseed the pseudo-random number generator (PRNG) before allowing a child process to access it, which makes it easier for context-dependent attackers to obtain sensitive information by leveraging a race condition in which a child process is created and accesses the PRNG within the same rate-limit period as another process.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2013-1445>
* [pycrypto/pycrypto@19dcf7b](https://github.com/pycrypto/pycrypto/commit/19dcf7b15d61b7dc1a125a367151de40df6ef175)
* <http://www.debian.org/security/2013/dsa-2781>
* <http://www.openwall.com/lists/oss-security/2013/10/17/3>
* <https://github.com/pypa/advisory-database/tree/main/vulns/pycrypto/PYSEC-2013-29.yaml>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2013-1445)
Oct 26, 2013

Published to the GitHub Advisory Database
May 17, 2022

Reviewed
Apr 22, 2024

Last updated
Oct 21, 2024

### Severity

High

8.7

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector
Network

Attack Complexity
Low

Attack Requirements
None

Privileges Required
None

User interaction
None
##### Vulnerable System Impact Metrics

Confidentiality
High

Integrity
None

Availability
None
##### Subsequent System Impact Metrics

Confidentiality
None

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector:
This metric reflects the context by which vulnerability exploitation is possible. This metric value (and consequently the resulting severity) will be larger the more remote (logically, and physically) an attacker can be in order to exploit the vulnerable system. The assumption is that the number of potential attackers for a vulnerability that could be exploited from across a network is larger than the number of potential attackers that could exploit a vulnerability requiring physical access to a device, and therefore warrants a greater severity.

Attack Complexity:
This metric captures measurable actions that must be taken by the attacker to actively evade or circumvent existing built-in security-enhancing conditions in order to obtain a working exploit. These are conditions whose primary purpose is to increase security and/or increase exploit engineering complexity. A vulnerability exploitable without a target-specific variable has a lower complexity than a vulnerability that would require non-trivial customization. This metric is meant to capture security mechanisms utilized by the vulnerable system.

Attack Requirements:
This metric captures the prerequisite deployment and execution conditions or variables of the vulnerable system that enable the attack. These differ from security-enhancing techniques/technologies (ref Attack Complexity) as the primary purpose of these conditions is not to explicitly mitigate attacks, but rather, emerge naturally as a consequence of the deployment and execution of the vulnerable system.

Privileges Required:
This metric describes the level of privileges an attacker must possess prior to successfully exploiting the vulnerability. The method by which the attacker obtains privileged credentials prior to the attack (e.g., free trial accounts), is outside the scope of this metric. Generally, self-service provisioned accounts do not constitute a privilege requirement if the attacker can grant themselves privileges as part of the attack.

User interaction:
This metric captures the requirement for a human user, other than the attacker, to participate in the successful compromise of the vulnerable system. This metric determines whether the vulnerability can be exploited solely at the will of the attacker, or whether a separate user (or user-initiated process) must participate in some manner.
##### Vulnerable System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the VULNERABLE SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the VULNERABLE SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the VULNERABLE SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.
##### Subsequent System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the SUBSEQUENT SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the SUBSEQUENT SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the SUBSEQUENT SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.

 CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N

### EPSS score

0.136%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (50th percentile)

### Weaknesses

[CWE-332](/advisories?query=cwe%3A332)

### CVE ID

CVE-2013-1445

### GHSA ID

GHSA-x377-f64p-hf5j

### Source code

[pycrypto/pycrypto](https://github.com/pycrypto/pycrypto)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-x377-f64p-hf5j/improve).

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_42f055f2_20250125_223258.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpycrypto%2Fpycrypto%2Fcommit%2F19dcf7b15d61b7dc1a125a367151de40df6ef175)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpycrypto%2Fpycrypto%2Fcommit%2F19dcf7b15d61b7dc1a125a367151de40df6ef175)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=pycrypto%2Fpycrypto)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Jan 27, 2022. It is now read-only.

[pycrypto](/pycrypto)
/
**[pycrypto](/pycrypto/pycrypto)**
Public archive

* [Notifications](/login?return_to=%2Fpycrypto%2Fpycrypto) You must be signed in to change notification settings
* [Fork
  635](/login?return_to=%2Fpycrypto%2Fpycrypto)
* [Star
   2.5k](/login?return_to=%2Fpycrypto%2Fpycrypto)

* [Code](/pycrypto/pycrypto)
* [Issues
  152](/pycrypto/pycrypto/issues)
* [Pull requests
  60](/pycrypto/pycrypto/pulls)
* [Actions](/pycrypto/pycrypto/actions)
* [Projects
  0](/pycrypto/pycrypto/projects)
* [Security](/pycrypto/pycrypto/security)
* [Insights](/pycrypto/pycrypto/pulse)

Additional navigation options

* [Code](/pycrypto/pycrypto)
* [Issues](/pycrypto/pycrypto/issues)
* [Pull requests](/pycrypto/pycrypto/pulls)
* [Actions](/pycrypto/pycrypto/actions)
* [Projects](/pycrypto/pycrypto/projects)
* [Security](/pycrypto/pycrypto/security)
* [Insights](/pycrypto/pycrypto/pulse)

## Commit

[Permalink](/pycrypto/pycrypto/commit/19dcf7b15d61b7dc1a125a367151de40df6ef175)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Random: Make Crypto.Random.atfork() set last\_reseed=None ([CVE-2013-1445](https://github.com/advisories/GHSA-x377-f64p-hf5j "CVE-2013-1445"))

[Browse files](/pycrypto/pycrypto/tree/19dcf7b15d61b7dc1a125a367151de40df6ef175)
Browse the repository at this point in the history

```
== Summary ==

In PyCrypto before v2.6.1, the Crypto.Random pseudo-random number
generator (PRNG) exhibits a race condition that may cause it to generate
the same 'random' output in multiple processes that are forked from each
other.  Depending on the application, this could reveal sensitive
information or cryptographic keys to remote attackers.

An application may be affected if, within 100 milliseconds, it performs
the following steps (which may be summarized as "read-fork-read-read"):

1. Read from the Crypto.Random PRNG, causing an internal reseed;
2. Fork the process and invoke Crypto.Random.atfork() in the child;
3. Read from the Crypto.Random PRNG again, in at least two different
   processes (parent and child, or multiple children).

Only applications that invoke Crypto.Random.atfork() and perform the
above steps are affected by this issue.  Other applications are
unaffected.

Note: Some PyCrypto functions, such as key generation and PKCS#1-related
functions, implicitly read from the Crypto.Random PRNG.

== Technical details ==

Crypto.Random uses Fortuna[1] to generate random numbers.  The flow of
entropy looks something like this:

    /dev/urandom  -\
                    +-> "accumulator" --> "generator" --> output
    other sources -/   (entropy pools)     (AES-CTR)

- The "accumulator" maintains several pools that collect entropy from
  the environment.

- The "generator" is a deterministic PRNG that is reseeded by the
  accumulator.  Reseeding normally occurs during each request for random
  numbers, but never more than once every 100 ms (the "minimum reseed
  interval").

When a process is forked, the parent's state is duplicated in the child.
In order to continue using the PRNG, the child process must invoke
Crypto.Random.atfork(), which collects new entropy from /dev/urandom and
adds it to the accumulator.  When new PRNG output is subsequently
requested, some of the new entropy in the accumulator is used to reseed
the generator, causing the output of the child to diverge from its
parent.

However, in previous versions of PyCrypto, Crypto.Random.atfork() did
not explicitly reset the child's rate-limiter, so if the child requested
PRNG output before the minimum reseed interval of 100 ms had elapsed, it
would generate its output using state inherited from its parent.

This created a race condition between the parent process and its forked
children that could cause them to produce identical PRNG output for the
duration of the 100 ms minimum reseed interval.

== Demonstration ==

Here is some sample code that illustrates the problem:

    from binascii import hexlify
    import multiprocessing, pprint, time
    import Crypto.Random

    def task_main(arg):
        a = Crypto.Random.get_random_bytes(8)
        time.sleep(0.1)
        b = Crypto.Random.get_random_bytes(8)
        rdy, ack = arg
        rdy.set()
        ack.wait()
        return "%s,%s" % (hexlify(a).decode(),
                          hexlify(b).decode())

    n_procs = 4
    manager = multiprocessing.Manager()
    rdys = [manager.Event() for i in range(n_procs)]
    acks = [manager.Event() for i in range(n_procs)]
    Crypto.Random.get_random_bytes(1)
    pool = multiprocessing.Pool(processes=n_procs,
                                initializer=Crypto.Random.atfork)
    res_async = pool.map_async(task_main, zip(rdys, acks))
    pool.close()
    [rdy.wait() for rdy in rdys]
    [ack.set() for ack in acks]
    res = res_async.get()
    pprint.pprint(sorted(res))
    pool.join()

The output should be random, but it looked like this:

    ['c607803ae01aa8c0,2e4de6457a304b34',
     'c607803ae01aa8c0,af80d08942b4c987',
     'c607803ae01aa8c0,b0e4c0853de927c4',
     'c607803ae01aa8c0,f0362585b3fceba4']

== Solution ==

The solution is to upgrade to PyCrypto v2.6.1 or later, which properly
resets the rate-limiter when Crypto.Random.atfork() is invoked in the
child.

== References ==

[1] N. Ferguson and B. Schneier, _Practical Cryptography_,
    Indianapolis: Wiley, 2003, pp. 155-184.
```

* Loading branch information

[![@dlitz](https://avatars.githubusercontent.com/u/99377?s=40&v=4)](/dlitz)

[dlitz](/pycrypto/pycrypto/commits?author=dlitz "View all commits by dlitz")
committed
Oct 14, 2013

1 parent
[373ea76](/pycrypto/pycrypto/commit/373ea760f21701b162e8c4912a66928ee30d401a)

commit 19dcf7b

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**196 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* lib/Crypto

  + Random

    - Fortuna

      * lib/Crypto/Random/Fortuna/FortunaAccumulator.py
        [FortunaAccumulator.py](#diff-15e5537fe5809794ba9538d37a67c6ef135ab25898c7b778a947148ccd342c77)
    - lib/Crypto/Random/\_UserFriendlyRNG.py
      [\_UserFriendlyRNG.py](#diff-1446ea1508e8fd3ae9f82456729abc78d04ae8458239b646bf5e19df9ea80e34)
  + SelfTest/Random

    - lib/Crypto/SelfTest/Random/\_\_init\_\_.py
      [\_\_init\_\_.py](#diff-b809cc6c9e9d8b28433f37773f4728a80bb3ba2c604d8edcffa471b3ab28d5de)
    - lib/Crypto/SelfTest/Random/test\_\_UserFriendlyRNG.py
      [test\_\_UserFriendlyRNG.py](#diff-463dd73d6b072e707689ec2ec07fa422aec23ede2fd1a6ba7bc10c7cee1bb7ad)

## There are no files selected for viewing

9 changes: 9 additions & 0 deletions

9
[lib/Crypto/Random/Fortuna/FortunaAccumulator.py](#diff-15e5537fe5809794ba9538d37a67c6ef135ab25898c7b778a947148ccd342c77 "lib/Crypto/Random/Fortuna/FortunaAccumulator.py")

Show comments

[View file](/pycrypto/pycrypto/blob/19dcf7b15d61b7dc1a125a367151de40df6ef175/lib/Crypto/Random/Fortuna/FortunaAccumulator.py)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -109,6 +109,15 @@ def \_\_init\_\_(self): |
|  |  | self.pools = [FortunaPool() for i in range(32)] # 32 pools |
|  |  | assert(self.pools[0] is not self.pools[1]) |
|  |  |  |
|  |  | def \_forget\_last\_reseed(self): |
|  |  | # This is not part of the standard Fortuna definition, and using this |
|  |  | # function frequently can weaken Fortuna's ability to resist a state |
|  |  | # compromise extension attack, but we need this in order to properly |
|  |  | # implement Crypto.Random.atfork(). Otherwise, forked child processes |
|  |  | # might continue to use their parent's PRNG state for up to 100ms in |
|  |  | # some cases. (e.g. CVE-2013-1445) |
|  |  | self.last\_reseed = None |
|  |  |  |
|  |  | def random\_data(self, bytes): |
|  |  | current\_time = time.time() |
|  |  | if (self.last\_reseed is not None and self.last\_reseed > current\_time): # Avoid float comparison to None to make Py3k happy |
| Expand Down | |  |

15 changes: 15 additions & 0 deletions

15
[lib/Crypto/Random/\_UserFriendlyRNG.py](#diff-1446ea1508e8fd3ae9f82456729abc78d04ae8458239b646bf5e19df9ea80e34 "lib/Crypto/Random/_UserFriendlyRNG.py")

Show comments

[View file](/pycrypto/pycrypto/blob/19dcf7b15d61b7dc1a125a367151de40df6ef175/lib/Crypto/Random/_UserFriendlyRNG.py)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -90,9 +90,24 @@ def reinit(self): |
|  |  | """Initialize the random number generator and seed it with entropy from |
|  |  | the operating system. |
|  |  | """ |
|  |  |  |
|  |  | # Save the pid (helps ensure that Crypto.Random.atfork() gets called) |
|  |  | self.\_pid = os.getpid() |
|  |  |  |
|  |  | # Collect entropy from the operating system and feed it to |
|  |  | # FortunaAccumulator |
|  |  | self.\_ec.reinit() |
|  |  |  |
|  |  | # Override FortunaAccumulator's 100ms minimum re-seed interval. This |
|  |  | # is necessary to avoid a race condition between this function and |
|  |  | # self.read(), which that can otherwise cause forked child processes to |
|  |  | # produce identical output. (e.g. CVE-2013-1445) |
|  |  | # |
|  |  | # Note that if this function can be called frequently by an attacker, |
|  |  | # (and if the bits from OSRNG are insufficiently random) it will weaken |
|  |  | # Fortuna's ability to resist a state compromise extension attack. |
|  |  | self.\_fa.\_forget\_last\_reseed() |
|  |  |  |
|  |  | def close(self): |
|  |  | self.closed = True |
|  |  | self.\_osrng = None |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[lib/Crypto/SelfTest/Random/\_\_init\_\_.py](#diff-b809cc6c9e9d8b28433f37773f4728a80bb3ba2c604d8edcffa471b3ab28d5de "lib/Crypto/SelfTest/Random/__init__.py")

Show comments

[View file](/pycrypto/pycrypto/blob/19dcf7b15d61b7dc1a125a367151de40df6ef175/lib/Crypto/SelfTest/Random/__init__.py)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -32,6 +32,7 @@ def get\_tests(config={}): |
|  |  | from Crypto.SelfTest.Random import OSRNG; tests += OSRNG.get\_tests(config=config) |
|  |  | from Crypto.SelfTest.Random import test\_random; tests += test\_random.get\_tests(config=config) |
|  |  | from Crypto.SelfTest.Random import test\_rpoolcompat; tests += test\_rpoolcompat.get\_tests(config=config) |
|  |  | from Crypto.SelfTest.Random import test\_\_UserFriendlyRNG; tests += test\_\_UserFriendlyRNG.get\_tests(config=config) |
|  |  | return tests |
|  |  |  |
|  |  | if \_\_name\_\_ == '\_\_main\_\_': |
| Expand Down | |  |

171 changes: 171 additions & 0 deletions

171
[lib/Crypto/SelfTest/Random/test\_\_UserFriendlyRNG.py](#diff-463dd73d6b072e707689ec2ec07fa422aec23ede2fd1a6ba7bc10c7cee1bb7ad "lib/Crypto/SelfTest/Random/test__UserFriendlyRNG.py")

Show comments

[View file](/pycrypto/pycrypto/blob/19dcf7b15d61b7dc1a125a367151de40df6ef175/lib/Crypto/SelfTest/Random/test__UserFriendlyRNG.py)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,171 @@ |
|  |  | # -\*- coding: utf-8 -\*- |
|  |  | # Self-tests for the user-friendly Crypto.Random interface |
|  |  | # |
|  |  | # Written in 2013 by Dwayne C. Litzenberger <dlitz@dlitz.net> |
|  |  | # |
|  |  | # =================================================================== |
|  |  | # The contents of this file are dedicated to the public domain. To |
|  |  | # the extent that dedication to the public domain is not available, |
|  |  | # everyone is granted a worldwide, perpetual, royalty-free, |
|  |  | # non-exclusive license to exercise all rights associated with the |
|  |  | # contents of this file for any purpose whatsoever. |
|  |  | # No rights are reserved. |
|  |  | # |
|  |  | # THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, |
|  |  | # EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF |
|  |  | # MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND |
|  |  | # NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS |
|  |  | # BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN |
|  |  | # ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN |
|  |  | # CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE |
|  |  | # SOFTWARE. |
|  |  | # =================================================================== |
|  |  |  |
|  |  | """Self-test suite for generic Crypto.Random stuff """ |
|  |  |  |
|  |  | from \_\_future\_\_ import nested\_scopes |
|  |  |  |
|  |  | \_\_revision\_\_ = "$Id$" |
|  |  |  |
|  |  | import binascii |
|  |  | import pprint |
|  |  | import unittest |
|  |  | import os |
|  |  | import time |
|  |  | import sys |
|  |  | if sys.version\_info[0] == 2 and sys.version\_info[1] == 1: |
|  |  | from Crypto.Util.py21compat import \* |
|  |  | from Crypto.Util.py3compat import \* |
|  |  |  |
|  |  | try: |
|  |  | import multiprocessing |
|  |  | except ImportError: |
|  |  | multiprocessing = None |
|  |  |  |
|  |  | import Crypto.Random.\_UserFriendlyRNG |
|  |  | import Crypto.Random.random |
|  |  |  |
|  |  | class RNGForkTest(unittest.TestCase): |
|  |  |  |
|  |  | def \_get\_reseed\_count(self): |
|  |  | """ |
|  |  | Get `FortunaAccumulator.reseed\_count`, the global count of the |
|  |  | number of times that the PRNG has been reseeded. |
|  |  | """ |
|  |  | rng\_singleton = Crypto.Random.\_UserFriendlyRNG.\_get\_singleton() |
|  |  | rng\_singleton.\_lock.acquire() |
|  |  | try: |
|  |  | return rng\_singleton.\_fa.reseed\_count |
|  |  | finally: |
|  |  | rng\_singleton.\_lock.release() |
|  |  |  |
|  |  | def runTest(self): |
|  |  | # Regression test for CVE-2013-1445. We had a bug where, under the |
|  |  | # right conditions, two processes might see the same random sequence. |
|  |  |  |
|  |  | if sys.platform.startswith('win'): # windows can't fork |
|  |  | assert not hasattr(os, 'fork') # ... right? |
|  |  | return |
|  |  |  |
|  |  | # Wait 150 ms so that we don't trigger the rate-limit prematurely. |
|  |  | time.sleep(0.15) |
|  |  |  |
|  |  | reseed\_count\_before = self.\_get\_reseed\_count() |
|  |  |  |
|  |  | # One or both of these calls together should trigger a reseed right here. |
|  |  | Crypto.Random.\_UserFriendlyRNG.\_get\_singleton().reinit() |
|  |  | Crypto.Random.get\_random\_bytes(1) |
|  |  |  |
|  |  | reseed\_count\_after = self.\_get\_reseed\_count() |
|  |  | self.assertNotEqual(reseed\_count\_before, reseed\_count\_after) # sanity check: test should reseed parent before forking |
|  |  |  |
|  |  | rfiles = [] |
|  |  | for i in range(10): |
|  |  | rfd, wfd = os.pipe() |
|  |  | if os.fork() == 0: |
|  |  | # child |
|  |  | os.close(rfd) |
|  |  | f = os.fdopen(wfd, "wb") |
|  |  |  |
|  |  | Crypto.Random.atfork() |
|  |  |  |
|  |  | data = Crypto.Random.get\_random\_bytes(16) |
|  |  |  |
|  |  | f.write(data) |
|  |  | f.close() |
|  |  | os.\_exit(0) |
|  |  | # parent |
|  |  | os.close(wfd) |
|  |  | rfiles.append(os.fdopen(rfd, "rb")) |
|  |  |  |
|  |  | results = [] |
|  |  | results\_dict = {} |
|  |  | for f in rfiles: |
|  |  | data = binascii.hexlify(f.read()) |
|  |  | results.append(data) |
|  |  | results\_dict[data] = 1 |
|  |  | f.close() |
|  |  |  |
|  |  | if len(results) != len(results\_dict.keys()): |
|  |  | raise AssertionError("RNG output duplicated across fork():\n%s" % |
|  |  | (pprint.pformat(results))) |
|  |  |  |
|  |  |  |
|  |  | # For RNGMultiprocessingForkTest |
|  |  | def \_task\_main(q): |
|  |  | a = Crypto.Random.get\_random\_bytes(16) |
|  |  | time.sleep(0.1) # wait 100 ms |
|  |  | b = Crypto.Random.get\_random\_bytes(16) |
|  |  | q.put(binascii.b2a\_hex(a)) |
|  |  | q.put(binascii.b2a\_hex(b)) |
|  |  | q.put(None) # Wait for acknowledgment |
|  |  |  |
|  |  |  |
|  |  | class RNGMultiprocessingForkTest(unittest.TestCase): |
|  |  |  |
|  |  | def runTest(self): |
|  |  | # Another regression test for CVE-2013-1445. This is basically the |
|  |  | # same as RNGForkTest, but less compatible with old versions of Python, |
|  |  | # and a little easier to read. |
|  |  |  |
|  |  | n\_procs = 5 |
|  |  | manager = multiprocessing.Manager() |
|  |  | queues = [manager.Queue(1) for i in range(n\_procs)] |
|  |  |  |
|  |  | # Reseed the pool |
|  |  | time.sleep(0.15) |
|  |  | Crypto.Random.\_UserFriendlyRNG.\_get\_singleton().reinit() |
|  |  | Crypto.Random.get\_random\_bytes(1) |
|  |  |  |
|  |  | # Start the child processes |
|  |  | pool = multiprocessing.Pool(processes=n\_procs, initializer=Crypto.Random.atfork) |
|  |  | map\_result = pool.map\_async(\_task\_main, queues) |
|  |  |  |
|  |  | # Get the results, ensuring that no pool processes are reused. |
|  |  | aa = [queues[i].get(30) for i in range(n\_procs)] |
|  |  | bb = [queues[i].get(30) for i in range(n\_procs)] |
|  |  | res = list(zip(aa, bb)) |
|  |  |  |
|  |  | # Shut down the pool |
|  |  | map\_result.get(30) |
|  |  | pool.close() |
|  |  | pool.join() |
|  |  |  |
|  |  | # Check that the results are unique |
|  |  | if len(set(aa)) != len(aa) or len(set(res)) != len(res): |
|  |  | raise AssertionError("RNG output duplicated across fork():\n%s" % |
|  |  | (pprint.pformat(res),)) |
|  |  |  |
|  |  |  |
|  |  | def get\_tests(config={}): |
|  |  | tests = [] |
|  |  | tests += [RNGForkTest()] |
|  |  | if multiprocessing is not None: |
|  |  | tests += [RNGMultiprocessingForkTest()] |
|  |  | return tests |
|  |  |  |
|  |  | if \_\_name\_\_ == '\_\_main\_\_': |
|  |  | suite = lambda: unittest.TestSuite(get\_tests()) |
|  |  | unittest.main(defaultTest='suite') |
|  |  |  |
|  |  | # vim:set ts=4 sw=4 sts=4 expandtab: |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `19dcf7b`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpycrypto%2Fpycrypto%2Fcommit%2F19dcf7b15d61b7dc1a125a367151de40df6ef175) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from www.debian.org_46d8154a_20250125_223255.html ===


---

[[Date Prev](msg00191.html)][[Date Next](msg00193.html)]
[[Thread Prev](msg00191.html)][[Thread Next](msg00193.html)]
[[Date Index](maillist.html#00192)]
[[Thread Index](threads.html#00192)]

# [SECURITY] [DSA 2781-1] python-crypto security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2781-1] python-crypto security update
* *From*: Yves-Alexis Perez <corsac@debian.org>
* *Date*: Fri, 18 Oct 2013 21:40:25 +0200
* *Message-id*: <[[üîé]](/msgid-search/20131018194021.GA13676%40scapa.corsac.net)¬†[20131018194021.GA13676@scapa.corsac.net](msg00192.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2781-1                   security@debian.org
<http://www.debian.org/security/>                         Yves-Alexis Perez
October 18, 2013                       <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : python-crypto
Vulnerability  : PRNG not correctly reseeded in some situations
Problem type   : local
Debian-specific: no
CVE ID         : CVE-2013-1445
Debian Bug     :

A cryptographic vulnerability was discovered in the pseudo random number
generator in python-crypto.

In some situations, a race condition could prevent the reseeding of the
generator when multiple processes are forked from the same parent. This would
lead it to generate identical output on all processes, which might leak
sensitive values like cryptographic keys.

For the oldstable distribution (squeeze), this problem has been fixed in
version 2.1.0-2+squeeze2.

For the stable distribution (wheezy), this problem has been fixed in
version 2.6-4+deb7u3.

For the testing distribution (jessie), this problem has been fixed in
version 2.6.1-2.

For the unstable distribution (sid), this problem has been fixed in
version 2.6.1-1.

We recommend that you upgrade your python-crypto packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.22 (GNU/Linux)

iQEcBAEBCgAGBQJSYY6gAAoJEG3bU/KmdcClrR8H/jFkzhCqg52Qyg7jpvqVmCT2
7Xc5xbkfk9zB7DNKrFD16ORnI4NzaWrj56mVz7ZkG/R1yHD8xM7m0Xb2m//EKDMu
Of2YdHqmT0T4T1qZ85Se6uAlnzbwzgz3URdBsFQzKFJ59/2khzm4noZlw60OBc/J
1iWGbFu6fnMPjTrv4x3IrJohrXEK5wX8bCKx5XPHA3x7X5M1nUlHu87Oen6cFZYU
8IIc9+zj5R9j2QT4vb+UMxVkrDN6d54qQ8xYNRLpIySfasNDqStEq+8g8lLr/Jcr
l9IqgKPeqaRoEyHMAF8AMV/+JIzvejwNioWgOzTIv4JSuLLlPCXG05y5fhsY1ns=
=uR3G
-----END PGP SIGNATURE-----

```

---



=== Content from www.dlitz.net_07204396_20250126_122931.html ===

[skip navigation](#PageContent)
[![DLitz.net](/images/dlitz-carsstop-small.jpg "Back to home page")](https://www.dlitz.net/)
*PyCrypto*

[Home](https://www.pycrypto.org/)
| [GitHub](https://github.com/pycrypto/pycrypto)

---

# PyCrypto - The Python Cryptography Toolkit

## This software is no longer maintained.

**PyCrypto 2.x is unmaintained, obsolete, and contains security vulnerabilities.**

Please choose one of the following alternatives:

### [Cryptography](https://cryptography.io)

* Recommended for new applications.
* Newer API with fewer gotchas.
* [API docs](https://cryptography.io)
* [GitHub](https://github.com/pyca/cryptography)
* [PyPI](https://pypi.org/project/cryptography)

### [PyCryptodome](https://www.pycryptodome.org)

* Recommended for existing software that depends on PyCrypto.
* Fork of PyCrypto. Most applications should run unmodified.
* [API docs](https://www.pycryptodome.org)
* [GitHub](https://github.com/Legrandin/pycryptodome)
* [PyPI](https://pypi.org/project/pycryptodome)

---

### Historical links

‚ö†Ô∏è **PyCrypto 2.x is unmaintained. The following are provided for reference only.**

* [API docs](./api/) (epydoc output)
* [Overview of PyCrypto](./doc/) (built from [Doc/pycrypto.rst](https://github.com/pycrypto/pycrypto/blob/master/Doc/pycrypt.rst))
* [Source code repository (GitHub)](https://github.com/pycrypto/pycrypto)
* [Release tarballs](./pub/dlitz/crypto/pycrypto/)
* [Mailing list archive](https://lists.dlitz.net/pipermail/pycrypto/) ([Local snapshot](./pipermail/pycrypto/))
* [PyPI](https://pypi.org/project/pycrypto/)

[![[PyCrypto on GitHub]](/images/thirdparty/fork-me-on-github.png)](https://github.com/pycrypto/pycrypto)

---

```
Published with [GitHub Pages](https://pages.github.com/)
```


