=== Content from bugzilla.mozilla.org_6814a77d_20250126_081351.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/748764)
* [XML](/show_bug.cgi?ctype=xml&id=748764)

Closed
[Bug 748764](/show_bug.cgi?id=748764)
(CVE-2012-1942)

Opened 13 years ago
Closed 13 years ago

# Possible Arbitrary Code Execution by Update Service

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Possible Arbitrary Code Execution by Update Service

## Categories

### (Toolkit :: Application Update, defect)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Application%20Update#Application%20Update)

Application Update
▾

Toolkit :: Application Update
Application update for Firefox and Thunderbird.
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Application%20Update&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Application%20Update&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Application%20Update)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

12 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla15

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Install Update Workflow | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox12 | --- | [affected](/buglist.cgi?f1=cf_status_firefox12&o1=equals&v1=affected) |
| firefox13 | [+](/buglist.cgi?f1=cf_tracking_firefox13&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox13&o1=equals&v1=fixed) |
| firefox14 | [+](/buglist.cgi?f1=cf_tracking_firefox14&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox14&o1=equals&v1=fixed) |
| firefox15 | [+](/buglist.cgi?f1=cf_tracking_firefox15&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=fixed) |
| firefox-esr10 | --- | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox12 |  | affected |
| firefox13 | + | fixed |
| firefox14 | + | fixed |
| firefox15 | + | fixed |
| firefox-esr10 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: curtisk, Assigned: bbondy)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/47d8644c0ad8d89635fca422dd6d3ab5?d=mm&size=40)  [bbondy](/user_profile?user_id=407790)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [curtisk](/user_profile?user_id=406847)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/50e82ef70720dfcf1385f583e34f9ba9?d=mm&size=40)  [erchen](/user_profile?user_id=753852)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[757711](/show_bug.cgi?id=757711 "VERIFIED FIXED - Service does not get replaced for newer builds since bug 748764")

Dependency [tree](/showdependencytree.cgi?id=748764&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=748764)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: reporter-external, sec-critical, Whiteboard: [sg:critical][advisory-tracking+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2012-1942

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:critical][advisory-tracking+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [rforbes](/user_profile?user_id=411311) | [sec-bounty](#c31 "12 years ago") | + |
| --- | --- | --- |
| [rforbes](/user_profile?user_id=411311) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 2 obsolete files)

| [Patch v1.](/attachment.cgi?id=618330)  [13 years ago](#c1)  [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)   3.33 KB, patch | robert.strong.bugs : [review+](#c3 "13 years ago") | [Details](/attachment.cgi?id=618330&action=edit) | [Diff](/attachment.cgi?id=618330&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=748764&attachment=618330) |
| --- | --- | --- |
| [Patch v1. Race condition](/attachment.cgi?id=618401)  [13 years ago](#c14)  [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)   1.20 KB, patch |  | [Details](/attachment.cgi?id=618401&action=edit) | [Diff](/attachment.cgi?id=618401&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=748764&attachment=618401) |
| [Patch v2.](/attachment.cgi?id=619188)  [13 years ago](#c20)  [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)   2.39 KB, patch | robert.strong.bugs : [review+](#a461028_141755 "13 years ago")  akeybl : [approval-mozilla-aurora+](#c28 "13 years ago")  akeybl : [approval-mozilla-beta+](#c28 "13 years ago") | [Details](/attachment.cgi?id=619188&action=edit) | [Diff](/attachment.cgi?id=619188&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=748764&attachment=619188) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Curtis Koenig [:curtisk-use curtis.koenig+bzATgmail.com]]](/user_profile?user_id=406847)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=748764#c0)• 13 years ago |
|  | |

Hi,
I notice two security issues in the new Mozilla updater service which came with FF12 on Windows I would like to report.
a) The service path is not quoted which means you can end up with the potential for a planting attack (e.g. if you can create C:\Program.exe it will run it when starting the service).
b) The service itself can be tricked into loading a DLL into the process with SYSTEM privileges and it will run its DLLMain (meaning you can do anything you like). You call LoadLibrary instead of LoadLibraryEx on line 329 of workmonitor.cpp when checking that you have the correct resource string. It should be called to only load it as a resource.
The following C# code will run the service and will load a DLL as long as the files C:\sourcecode\exploitme.dll and C:\sourcecode\updater.exe are the same. The DLL can then in DllMain run something like CreateProcess.
using System;
using System.ServiceProcess;
namespace FFService
{
class Program
{
static void Main(string[] args)
{
try
{
ServiceController c = new ServiceController("MozillaMaintenance");
c.Start(new string[] { "aaa", "software-update", "C:\\sourcecode\\exploitme.dll", "aaaa", "c:\\sourcecode\\", "cccc" });
}
catch (Exception e)
{
Console.WriteLine(e);
}
}
}
}
I have only tested in XP Pro SP3 but I assume it will work on Win7 and Vista just the same.
If you need more information let me know.
James Forshaw
Principal Security Consultant
Context Information Security
Registered no: 3574635 | Certified to ISO/IEC 27001:2005 (BSI Certificate IS 553326) and ISO 9001:2008 (BSI Certificate FS 581360)
www.contextis.com | 30 Marsh Wall, London E14 9TP, UK | Mob: +44 (0)7827 248760 | Tel:Â 0207 537 7515 | Fax: 0207 537 1071
The information contained in this email and any attachments may be legally privileged and confidential.Â If you are not the intended recipient you are notified that disclosing, copying, distributing or taking any action in reliance on the contents of this information is strictly prohibited.Â If you are not the intended recipient please contact us immediately.Â Any views or opinions presented in this email are solely those of the author and do not necessarily represent those of the company.

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=748764#c1)• 13 years ago |
|  | |

Attached patch

[Patch v1.](attachment.cgi?id=618330&action=diff) (obsolete)
— [Details](attachment.cgi?id=618330&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=748764&attachment=618330)

Thanks for the report.Assignee: nobody → netzen
[Attachment #618330](/attachment.cgi?id=618330&action=edit "Patch v1.") -
Flags: review?(robert.bugzilla)

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=748764#c2)• 13 years ago |
|  | |

(Removed the WinUtils.cpp from my local patch by the way, that was accidentally included)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=748764#c3)• 13 years ago |
|  | |

Comment on [attachment 618330](/attachment.cgi?id=618330 "Patch v1.") [[details]](/attachment.cgi?id=618330&action=edit "Patch v1.") [[diff]](/attachment.cgi?id=618330&action=diff "Patch v1.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=748764&attachment=618330)
Patch v1.
Brian, do the other security measures prevent this from being exploitable?
[Attachment #618330](/attachment.cgi?id=618330&action=edit "Patch v1.") -
Flags: review?(robert.bugzilla) → review+

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=748764#c4)• 13 years ago |
|  | |

For a) no but the user would need write access into C:\ directly.
For b) yes we verify that the updater.exe is the same as the one in the installation directory before loading the library to make sure it is an actual updater.
So both attacks from what I understand require write access to elevated directories.

|  | [Curtis Koenig [:curtisk-use curtis.koenig+bzATgmail.com]]](/user_profile?user_id=406847)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=748764#c5)• 13 years ago |
|  | |

So anyone running as admin (which is just about anyone on windows) would have rights to these directories I think. On vista and 7 they should get warnings when trying to write to some directories as that may require a UAC decision depending on the settings the user has.

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=748764#c6)• 13 years ago |
|  | |

Agreed and I am fairly certain that anyone running as admin that is tricked into setting this up could as easily be tricked into just executing what this would accomplish with the same end result without jumping through as many hoops.

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=748764#c7)• 13 years ago |
|  | |

so I think the main worry is that an admin could execute code as the system account. But any admin can already do this very easily by simply creating a new service that runs as the system account and then starting it.

|  | [Curtis Koenig [:curtisk-use curtis.koenig+bzATgmail.com]]](/user_profile?user_id=406847)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=748764#c8)• 13 years ago |
|  | |

I thought users were default admin on XP/Vista/7 if there were the first and/or only user of the system? So this is still a large segment of our user population. I do not mean to discount [comment 6](/show_bug.cgi?id=748764#c6 "VERIFIED FIXED - Possible Arbitrary Code Execution by Update Service") but if users are default for admin rights we may be raising the stakes just a bit for attack surface no?

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=748764#c9)• 13 years ago |
|  | |

Just a note that on Windows XP the code in question does not execute.
Also if UAC is off the code does not execute.
So I believe that writing to those locations would always have a UAC prompt for every case that the code executes.

|  | [James Forshaw](/user_profile?user_id=440535) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=748764#c10)• 13 years ago |
|  | |

You do not need to write to c: all paths are attacker supplied and thus controlled I can provider a proper poc tomorrow or compile that c# and change the paths and see where it tries to go using procmon etc

|  | [James Forshaw](/user_profile?user_id=440535) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=748764#c11)• 13 years ago |
|  | |

Sorry I only meant b) for a) you would need to write to c: but I have seen machines configured to allow you

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=748764#c12)• 13 years ago |
|  | |

Ya for b) I see now.
The apply to directory is an argument that is supplied. We do verify that this is a Firefox installation directory but that is in the signature check which happens after this LoadLibrary call. The user would have to pass a command line argument to the apply to directory that has a copy of the dll they want to load named updater.exe.

|  | [James Forshaw](/user_profile?user_id=440535) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=748764#c13)• 13 years ago |
|  | |

That is correct. I also tested Uac admin on win7 with my poc and it works on there to. Of course even if you directly checked for updater.exe in program files you would still have a race condition where the attacker could change the user supplied file before loadlibrary.
I didn't look much further as I had other things but do you ensure that the file you signature check is the same file you exec? By for example copying to a secure location before verification? Or do you run the installed updater in the end? If not there might be a race there as well.

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=748764#c14)• 13 years ago |
|  | |

Attached patch

[Patch v1. Race condition](attachment.cgi?id=618401&action=diff) (obsolete)
— [Details](attachment.cgi?id=618401&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=748764&attachment=618401)

I think there is a potential for a race condition there, I added this patch to lock the file for write access before any of the checks happen.
[Attachment #618401](/attachment.cgi?id=618401&action=edit "Patch v1. Race condition") -
Flags: review?(robert.bugzilla)

|  | [James Forshaw](/user_profile?user_id=440535) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=748764#c15)• 13 years ago |
|  | |

Also worth pointing out that with a), while yes on a vanilla Windows box it should not be possible to write a file to either C:\ or C:\program files, few people have vanilla configurations. I have seen users, admins and OEMs break these security principles before now. You can only really be reasonably confident in the directories you yourself created, not anything else on the file system.
On a related note, if FF is installed to a non-standard directory does the updater service get installed to a secure directory elsewhere, or does it not get installed at all, or does it get installed along side?

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=748764#c16)• 13 years ago |
|  | |

If installed it will always be installed into program files. It will only be used if the user does not have write access into the apply to directory.

|  | [James Forshaw](/user_profile?user_id=440535) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=748764#c17)• 13 years ago |
|  | |

That fix for the race is not quite correct, for at least two reasons.
1) The attacker need not provide a path to a file system which honors the write locking. For example if he pointed it to a UNC path then he could change it on the remote server and Windows \*could\* return the new data at LoadLibrary time.
2) The semantics of LoadLibrary differ from CreateFile when it comes to paths. For example there is no checking done to make the path absolute so if you provide a relative path then LoadLibrary "could" search the path first (an unlikely condition). But probably more importantly, if you supply a filename with no extension then LoadLibrary always appends .DLL to the filename before loading, CreateFile will open the name as is.

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=748764#c18)• 13 years ago |
|  | |

I moved the discussion for [Comment 14](/show_bug.cgi?id=748764#c14 "VERIFIED FIXED - Possible Arbitrary Code Execution by Update Service") - [Comment 17](/show_bug.cgi?id=748764#c17 "VERIFIED FIXED - Possible Arbitrary Code Execution by Update Service") and the second patch to this new bug: [Bug 748948](/show_bug.cgi?id=748948 "RESOLVED FIXED - Possible race condition when launching updates from service after security checks")

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=748764#a24118_407790)• 13 years ago |

[Attachment #618401](/attachment.cgi?id=618401&action=edit "Patch v1. Race condition") -
Flags: review?(robert.bugzilla)

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=748764#a24136_407790)• 13 years ago |

[Attachment #618401](/attachment.cgi?id=618401&action=edit "Patch v1. Race condition") -
Attachment is obsolete: true

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=748764#a108372_1689)• 13 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected)
[status-firefox12](/buglist.cgi?f1=cf_status_firefox12&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox12&o1=equals&v1=affected)
[status-firefox13](/buglist.cgi?f1=cf_status_firefox13&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox13&o1=equals&v1=affected)
[status-firefox14](/buglist.cgi?f1=cf_status_firefox14&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox14&o1=equals&v1=affected)
[status-firefox15](/buglist.cgi?f1=cf_status_firefox15&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=affected)
[tracking-firefox13](/buglist.cgi?f1=cf_tracking_firefox13&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox13&o1=equals&v1=%2B)
[tracking-firefox14](/buglist.cgi?f1=cf_tracking_firefox14&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox14&o1=equals&v1=%2B)
[tracking-firefox15](/buglist.cgi?f1=cf_tracking_firefox15&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox15&o1=equals&v1=%2B)

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=748764#c20)• 13 years ago |
|  | |

Attached patch

[Patch v2.](attachment.cgi?id=619188&action=diff)
— [Details](attachment.cgi?id=619188&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=748764&attachment=619188)

Last was r+ but changed patch enough to be more simplified. It does the same thing overall.
[Attachment #618330](/attachment.cgi?id=618330&action=edit "Patch v1.") -
Attachment is obsolete: true
[Attachment #619188](/attachment.cgi?id=619188&action=edit "Patch v2.") -
Flags: review?(robert.bugzilla)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=748764#a461028_141755)• 13 years ago |

[Attachment #619188](/attachment.cgi?id=619188&action=edit "Patch v2.") -
Flags: review?(robert.bugzilla) → review+

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=748764#c21)• 13 years ago |
|  | |

<http://hg.mozilla.org/mozilla-central/rev/c9e68a3cb207>Status: NEW → RESOLVEDClosed: 13 years agoResolution: --- → FIXEDTarget Milestone: --- → mozilla15

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=748764#c22)• 13 years ago |
|  | |

Comment on [attachment 619188](/attachment.cgi?id=619188 "Patch v2.") [[details]](/attachment.cgi?id=619188&action=edit "Patch v2.") [[diff]](/attachment.cgi?id=619188&action=diff "Patch v2.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=748764&attachment=619188)
Patch v2.
[Approval Request Comment]
Regression caused by (bug #): 481815
User impact if declined: unelevated process can run code elevated
Testing completed (on m-c, etc.): I tested updates on elm, I will wait for 2 days on m-c to ensure updates are working there before pushing to aurora and beta.
Risk to taking this patch (and alternatives if risky): low
String changes made by this patch: none
[Attachment #619188](/attachment.cgi?id=619188&action=edit "Patch v2.") -
Flags: approval-mozilla-beta?
[Attachment #619188](/attachment.cgi?id=619188&action=edit "Patch v2.") -
Flags: approval-mozilla-aurora?

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=748764#c23)• 13 years ago |
|  | |

Thank you for the reports and help James

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=748764#c24)• 13 years ago |
|  | |

Is there a compiled PoC anywhere that can be used for this. How do use the code snippet in [comment 0](/show_bug.cgi?id=748764#c0 "VERIFIED FIXED - Possible Arbitrary Code Execution by Update Service") to see the bug isn't entirely clear to me since I need dlls to use from the C:\sourcecode directory (?), which are copied from somewhere? The updater?

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=748764#c25)• 13 years ago |
|  | |

You can just change the command line parameters to specify whichever directory you want. [Comment 0](/show_bug.cgi?id=748764#c0 "VERIFIED FIXED - Possible Arbitrary Code Execution by Update Service") shows a C# program that you would run to reproduce, you can create a Dll with code that runs in DllMain I believe to reproduce.

|  | [James Forshaw](/user_profile?user_id=440535) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=748764#c26)• 13 years ago |
|  | |

Attached file
[Compiled PoC](attachment.cgi?id=620992)
— [Details](attachment.cgi?id=620992&action=edit)

Extract the PoC and run it on the command line with the mozilla service installed. updater.exe is just a renamed DLL.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=748764#c27)• 13 years ago |
|  | |

Verified fixed in nightly trunk on XP SP3. Running with Firefox 12 and the compiled PoC, calc.exe is run when the PoC is invoked (and running as System). With the nightly, this no longer occurs.Status: RESOLVED → VERIFIED

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=748764#c28)• 13 years ago |
|  | |

Comment on [attachment 619188](/attachment.cgi?id=619188 "Patch v2.") [[details]](/attachment.cgi?id=619188&action=edit "Patch v2.") [[diff]](/attachment.cgi?id=619188&action=diff "Patch v2.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=748764&attachment=619188)
Patch v2.
[Triage Comment]
Looks good on m-c, approving this sg:crit for Aurora 14 and Beta 13.
[Attachment #619188](/attachment.cgi?id=619188&action=edit "Patch v2.") -
Flags: approval-mozilla-beta?
[Attachment #619188](/attachment.cgi?id=619188&action=edit "Patch v2.") -
Flags: approval-mozilla-beta+
[Attachment #619188](/attachment.cgi?id=619188&action=edit "Patch v2.") -
Flags: approval-mozilla-aurora?
[Attachment #619188](/attachment.cgi?id=619188&action=edit "Patch v2.") -
Flags: approval-mozilla-aurora+

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=748764#c29)• 13 years ago |
|  | |

<http://hg.mozilla.org/releases/mozilla-aurora/rev/43265ac8befd>
<http://hg.mozilla.org/releases/mozilla-beta/rev/b906d4ad6124>
[status-firefox13](/buglist.cgi?f1=cf_status_firefox13&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox13&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox13&o1=equals&v1=fixed)
[status-firefox14](/buglist.cgi?f1=cf_status_firefox14&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox14&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox14&o1=equals&v1=fixed)
[status-firefox15](/buglist.cgi?f1=cf_status_firefox15&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=748764#c30)• 13 years ago |
|  | |

I'm not entirely convinced this is "critical" for today's Firefox users, because as a practical matter if you've got something running locally that can create c:\Program.exe you can probably trick that user into approving a UAC prompt and then do what you want. But fear of this kind of bug is exactly why we cautiously have chosen not to use the service for users with a limited account. Had this not been reported it would become critical when we enable that in the future; we might as well treat it as such now.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=748764#a2366194_280903)• 13 years ago |

Whiteboard: [sg:critical] → [sg:critical][advisory-tracking+]

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=748764#a2381084_407790)• 13 years ago |

Blocks: [757711](/show_bug.cgi?id=757711 "VERIFIED FIXED - Service does not get replaced for newer builds since bug 748764")

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=748764#a3223212_280903)• 13 years ago |

Alias: CVE-2012-1942

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=748764#a4931177_1689)• 13 years ago |

Group: core-security

|  | [Raymond Forbes[:rforbes]](/user_profile?user_id=411311) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=748764#c31)• 12 years ago |
|  | |

rforbes-bugspam-for-setting-that-bounty-flag-20130719Flags: sec-bounty+

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=748764#a381660083_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=748764&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_42a924ce_20250126_081358.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/854088)
* [XML](/show_bug.cgi?ctype=xml&id=854088)

Closed
[Bug 854088](/show_bug.cgi?id=854088)
(CVE-2013-1673)

Opened 12 years ago
Closed 12 years ago

# old MozillaMaintenance Service registry entry not updated, leads to Trusted Path Privilege Escalation

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

old MozillaMaintenance Service registry entry not updated, leads to Trusted Path Privilege Escalation

## Categories

### (Toolkit :: Application Update, defect)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Application%20Update#Application%20Update)

Application Update
▾

Toolkit :: Application Update
Application update for Firefox and Thunderbird.
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Application%20Update&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Application%20Update&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Application%20Update)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

19 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

Windows 7

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla23

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| Install Update Workflow | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox19 | [-](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix) |
| firefox20 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=wontfix) |
| firefox21 | [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed) |
| firefox22 | [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=fixed) |
| firefox23 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=fixed) |
| firefox-esr17 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected) |
| b2g18 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected) |
| b2g18-v1.0.1 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g18_1_0_1&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox19 | - | wontfix |
| firefox20 |  | wontfix |
| firefox21 | + | fixed |
| firefox22 | + | fixed |
| firefox23 |  | fixed |
| firefox-esr17 |  | unaffected |
| b2g18 |  | unaffected |
| b2g18-v1.0.1 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: r.ch.kugler, Assigned: bbondy)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/47d8644c0ad8d89635fca422dd6d3ab5?d=mm&size=40)  [bbondy](/user_profile?user_id=407790)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/90578e24912193e23d5301af907ff18e?d=mm&size=40)  [r.ch.kugler](/user_profile?user_id=451614)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/50e82ef70720dfcf1385f583e34f9ba9?d=mm&size=40)  [erchen](/user_profile?user_id=753852)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[857397](/show_bug.cgi?id=857397 "RESOLVED FIXED - Oak branch nightly builds not working")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=854088&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=854088)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[869452](/show_bug.cgi?id=869452 "RESOLVED DUPLICATE - unquoted Path used for MozillaMaintenance Service")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-priv-escalation, reporter-external, sec-high, Whiteboard: [adv-main21+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2013-1673

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main21+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [abillings](/user_profile?user_id=280903) | [sec-bounty](#a816166_280903 "12 years ago") | + |
| --- | --- | --- |
| [abillings](/user_profile?user_id=280903) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [payload.zip](/attachment.cgi?id=728607)  [12 years ago](#c0)  [Robert Kugler](/user_profile?user_id=451614)   7.16 KB, application/java-archive |  | [Details](/attachment.cgi?id=728607&action=edit) |
| --- | --- | --- |
| [Patch v1.](/attachment.cgi?id=731874)  [12 years ago](#c23)  [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)   2.04 KB, patch | robert.strong.bugs : [review+](#c25 "12 years ago")  akeybl : [approval-mozilla-aurora+](#c31 "12 years ago")  bajaj : [approval-mozilla-beta+](#c34 "12 years ago")  akeybl : [approval-mozilla-esr17-](#c31 "12 years ago")  abillings : [sec-approval+](#a796727_280903 "12 years ago") | [Details](/attachment.cgi?id=731874&action=edit) | [Diff](/attachment.cgi?id=731874&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=854088&attachment=731874) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Robert Kugler](/user_profile?user_id=451614)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=854088#c0)• 12 years ago |
|  | |

Attached file
[payload.zip](attachment.cgi?id=728607)
— [Details](attachment.cgi?id=728607&action=edit)

User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:19.0) Gecko/20100101 Firefox/19.0
Build ID: 20130307023931
Steps to reproduce:
Steps to reproduce:
1. Copy calc.exe to C:\program.exe or C:\Program Files (x86)\mozilla.exe. You can also use my payload (attached).
2. Start MozillaMaintenance using the service manager or the command-line.
3. calc.exe (program.exe - mozilla.exe) will be run with SYSTEM privileges
Actual results:
The malicious executable was executed with SYSTEM privileges!
Expected results:
The service executable shouldn't run program.exe (C:\program.exe) or mozilla.exe (C:\Program Files (x86)\mozilla.exe). Although you need to be running as a high integrity process to create files in the root directory and its subfolders you could use this vulnerability to escalate your privileges or to automatically re-compromise the target in the future (with SYSTEM privileges)!

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=854088#c1)• 12 years ago |
|  | |

launching using non-absolute/non-quoted strings again?Component: Untriaged → Application UpdateProduct: Firefox → Toolkit

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=854088#a155030_1689)• 12 years ago |

[Attachment #728607](/attachment.cgi?id=728607&action=edit "payload.zip") -
Attachment mime type: application/octet-stream → application/java-archive

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=854088#a155053_1689)• 12 years ago |

Flags: sec-bounty?

|  | [Robert Kugler](/user_profile?user_id=451614)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=854088#c2)• 12 years ago |
|  | |

Today I tested this bug with another machine.
I installed Firefox with the latest installer.
Windows 7 64bit SP1 / Firefox 19.0.2 / Mozilla Maintenance Service 19.0.2 (x86 en-US)
[SC] QueryServiceConfig ERFOLG
SERVICE\_NAME: MozillaMaintenance
TYPE : 10 WIN32\_OWN\_PROCESS
START\_TYPE : 3 DEMAND\_START
ERROR\_CONTROL : 1 NORMAL
BINARY\_PATH\_NAME : "C:\Program Files (x86)\Mozilla Maintenance Service\maintenanceservice.exe"
LOAD\_ORDER\_GROUP :
TAG : 0
DISPLAY\_NAME : Mozilla Maintenance Service
DEPENDENCIES :
SERVICE\_START\_NAME : LocalSystem
This machine isn't exploitable...
It seems like the latest version isn't vulnerable, but then there's some mysterious behaviour on my first test machine!!
Windows 7 64bit SP1 / Firefox 19.0.2 / Mozilla Maintenance Service 19.0.2 (x86 en-US)
[SC] QueryServiceConfig ERFOLG
SERVICE\_NAME: MozillaMaintenance
TYPE : 10 WIN32\_OWN\_PROCESS
START\_TYPE : 3 DEMAND\_START
ERROR\_CONTROL : 1 NORMAL
BINARY\_PATH\_NAME : C:\Program Files (x86)\Mozilla Maintenance Service\maintenanceservice.exe
LOAD\_ORDER\_GROUP :
TAG : 0
DISPLAY\_NAME : Mozilla Maintenance Service
DEPENDENCIES :
SERVICE\_START\_NAME : LocalSystem
You see the "" are missing, this machine is exploitable!! Everything is up-to-date and patched the only differency is that I didn't do a fresh install with the latest installer.
Did you fix this vulnerability in the last months?! It's strange that my machine missed this patch isn't it??
Sorry that I opened a bug report for this curiosity!

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=854088#c3)• 12 years ago |
|  | |

hm... this sounds like [bug 748764](/show_bug.cgi?id=748764 "VERIFIED FIXED - Possible Arbitrary Code Execution by Update Service"), fixed in Firefox 13. Could your first installation have been installed between Firefox 10 and 12?. I guess that's why it sounded like an old problem coming back to haunt us.Summary: MozillaMaintenance Service Trusted Path Privilege Escalation → vulnerable MozillaMaintenance Service not updated, leads to Trusted Path Privilege Escalation

|  | [Curtis Koenig [:curtisk-use curtis.koenig+bzATgmail.com]]](/user_profile?user_id=406847) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=854088#c4)• 12 years ago |
|  | |

assigned to freddy for verificationAssignee: nobody → fbraunWhiteboard: [verif?]

|  | [Robert Kugler](/user_profile?user_id=451614)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=854088#c5)• 12 years ago |
|  | |

[Comment 3](/show_bug.cgi?id=854088#c3 "RESOLVED FIXED - old MozillaMaintenance Service registry entry not updated, leads to Trusted Path Privilege Escalation"):
This could be! But both installations are patched and up-to-date...
How can a user know if his installation is really secure or vulnerable?
Only new installations are not exploitabe but "old" ones are! So a long installed and updated Firefox is less secure than a fresh installation?

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=854088#c6)• 12 years ago |
|  | |

Could not reproduce. So the real issue is that we do not update the Mozilla Maintenance Service?

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=854088#a250967_428608)• 12 years ago |

Assignee: fbraun → nobodyWhiteboard: [verif?]

|  | [Robert Kugler](/user_profile?user_id=451614)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=854088#c7)• 12 years ago |
|  | |

[Comment 6](/show_bug.cgi?id=854088#c6 "RESOLVED FIXED - old MozillaMaintenance Service registry entry not updated, leads to Trusted Path Privilege Escalation"):
Yep, updating the Maintenance Service would solve this problem!
I don't know but I think the majority of the users is rather using the auto-update than reinstalling Firefox every time. They'll remain vulnerable to a fixed security issue!

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=854088#c8)• 12 years ago |
|  | |

Robert (Kugler): do you still have the vulnerable installation? If so you can check it's version using window explorer (right-click, pick Properties). I bet the service itself may be up to date (the updater can replace files) but possibly only the initial installer knows how to update the registry entry that needs the quotes.
Freddy: the way to reproduce (if my theory is correct) is to install a Firefox 12 version (which has [bug 748764](/show_bug.cgi?id=748764 "VERIFIED FIXED - Possible Arbitrary Code Execution by Update Service")) and then let it update to the latest. You may need to fully uninstall Firefox first to make sure you get rid of any currently-installed service (and I do mean uninstall so that registry clean-up is done, don't just nuke the files).
Robert (Strong): is this a known problem? If my theory is correct could we patch the maintenance service so that new versions know to check/fix their registry entries?Assignee: nobody → netzen

|  | [Robert Kugler](/user_profile?user_id=451614)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=854088#c9)• 12 years ago |
|  | |

Daniel Veditz: I checked its version: 19.0.2.4814. The service is up-to-date! I was able to reproduce this issue on Vista 32bit SP2. Your theory is correct, only the initial installer knows how to update the registry entry that needs the quotes.

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=854088#c10)• 12 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #8](/show_bug.cgi?id=854088#c8 "RESOLVED FIXED - old MozillaMaintenance Service registry entry not updated, leads to Trusted Path Privilege Escalation"))
>...
> Robert (Strong): is this a known problem? If my theory is correct could we
> patch the maintenance service so that new versions know to check/fix their
> registry entries?
Not known. The post update helper should fix the registry entries after an update and this appears to not be the case. I'll take a look.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=854088#c11)• 12 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #8](/show_bug.cgi?id=854088#c8 "RESOLVED FIXED - old MozillaMaintenance Service registry entry not updated, leads to Trusted Path Privilege Escalation"))
> Freddy: the way to reproduce (if my theory is correct) is to install a
> Firefox 12 version (which has [bug 748764](/show_bug.cgi?id=748764 "VERIFIED FIXED - Possible Arbitrary Code Execution by Update Service")) and then let it update to the
> latest. You may need to fully uninstall Firefox first to make sure you get
> rid of any currently-installed service (and I do mean uninstall so that
> registry clean-up is done, don't just nuke the files).
I uninstalled, installed Firefox 12 and performed an auto-update but couldn't reproduce.
This happened on a test vm, since I'm not really a windows user. Just to make sure, I performed a reboot between every step ;)

|  | [Robert Kugler](/user_profile?user_id=451614)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=854088#c12)• 12 years ago |
|  | |

mmh...that's odd! Same installer behaviour on Windows 7 SP1 64bit!
It's reproducible for me on Vista and Windows 7.
My steps to reproduce:
1. Downloading and installing Firefox 12 (<http://www.mozilla.org/de/download/?product=firefox-12.0&os=win&lang=de>)
2.Starting the browser to let it download the update.
3.Then exit and restart the browser to let it install the latest version.
4.Now check the version of the service. It should be up-to-date.
You'll see the quotes are missing!
5.Copy exploit.exe (payload.zip) to C:\program.exe and start the service:
sc start MozillaMaintenance
6.A new user is added to the Administrator group!

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=854088#c13)• 12 years ago |
|  | |

Just checked my own development machine and the maintenance service path is unquoted still after 6 releases worth of Nightly, Aurora, ESR, etc. updates. Pretty sure I must have run the installer since Fx13 (for ESR-17 if nothing else) so it looks like the installer doesn't fix up an old maint-svc reg entry either.
This attack requires local access so if the user is privileged then it's not adding any risk. The interesting case is when the user is \_not\_ privileged, but can still write to c:\ for some reason -- this then allows that user to elevate their privilege on the local machine. As argued in [bug 748764](/show_bug.cgi?id=748764 "VERIFIED FIXED - Possible Arbitrary Code Execution by Update Service") this does happen in some cases, although arguably any admin that allows that has already weakened the system's security.
I'm torn between sec-moderate and sec-high. We rated [bug 830134](/show_bug.cgi?id=830134 "VERIFIED FIXED - The updater.exe loads the cryptsp.dll from the update directory while perfoming an update.") as sec-high, though an attacker has more opportunity to inject using that bug (directory of their choosing).Assignee: netzen → robert.bugzillaStatus: UNCONFIRMED → NEWEver confirmed: trueKeywords: [csec-priv-escalation](/buglist.cgi?keywords=csec-priv-escalation&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)Summary: vulnerable MozillaMaintenance Service not updated, leads to Trusted Path Privilege Escalation → old MozillaMaintenance Service registry entry not updated, leads to Trusted Path Privilege Escalation

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=854088#a544089_1689)• 12 years ago |

[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected)
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=854088#c14)• 12 years ago |
|  | |

Dan, is your dev system a VM as well? Is your user account a member of the admin group?

|  | [Robert Kugler](/user_profile?user_id=451614)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=854088#c15)• 12 years ago |
|  | |

Enabling write access to C:\ is not the best idea to secure your
system, but unfortunately not every user knows what he is doing by
enabling write access!
As described here: <http://www.wipethedrive.com/WTD-detail.pdf> an attacker could gain
persistent access on a infected machine. The Maintenance Service
starts on demand so the attacker needs to wait 6 weeks until there is a new Firefox version to get his reverse shell or reinfection.
Robert Strong:
I could reproduce it without a VM. My user accounts are both members of the admin group.

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=854088#c16)• 12 years ago |
|  | |

I thought we were already handling the case to fixup old installs during that period but it seems like we are not. I think I was thinking of this function:
<http://dxr.mozilla.org/mozilla-central/toolkit/components/maintenanceservice/serviceinstall.cpp#l183>
To fix we can just tweak doesServiceHaveCorrectPath to be false when there are no quotes found in the string.
I would probably set this is sec-moderate because you need admin access to write to c:\ and so this can't be exploited widely. Also if you have a program named program.exe on your computer it will surely be run eventually by something on your machine as high integrity and which therefore implies as SYSTEM (since a high integrity account can create a service as system and run it). I agree someone can set c: as writable but this is probably very rare overall.

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=854088#c17)• 12 years ago |
|  | |

Have to do some other updater work so I might as well take this.Assignee: robert.bugzilla → netzen

|  | [Robert Kugler](/user_profile?user_id=451614)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=854088#c18)• 12 years ago |
|  | |

Brian R.Bondy:
This bug isn't widely exploitable, but there are some
scenarios where this vulnerability could be used by an attacker.
1. When you compromise an Administrative user with a client-side attack you'll have write
access to C:\. Create a mozilla.exe in Program Files and start the service.
Privilege escalation and a "stealth" persistence (every 6 weeks backdoor) are possible.
2. The user isn't a member of the Adminstrator group but has granted write
access to C:\.
Privilege escalation and persistence are possible.

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=854088#c19)• 12 years ago |
|  | |

For #1 do you mean physically on the machine?
If you are physically on the machine logged in as administrator yes you can copy a file to C: by hitting the UAC confirmation dialog. But you can also right click on anything you want and select run as administrator and you have complete access.
If you are malware running as an administrative user you will not be able to though because it requires the malware to elevate itself first. And if they are elevated malware they can simply run whatever code they want without the service at the same level. admin->system account is trivial in code.
I think #2 is valid but not #1, let me know if I missed something though.

|  | [Robert Kugler](/user_profile?user_id=451614)  Reporter |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=854088#c20)• 12 years ago |
|  | |

Brian R. Bondy:
When someone has physically access to your computer he doesn't need a Firefox privilege escalation vulnerability. He can simply boot a Linux live CD to copy sensitive data or he can manipulate the sticky key function and reboot.
Physical access is a security nightmare!
Scenario 1:
If the attacker compromised the local administrator account (disabled by default in Windows 7 and Vista) his malware is able to copy files to C:\ or C:\Program Files without any UAC prompt.
You're right it's too much effort when your malware is already elevated you can just create a service running with SYSTEM privileges and start it, although creating services isn't smart when you want to stay undetected.
Okay privilege escalation isn't absolutely necessary in this case but what about the "relative stealth" persistence or automacilly re-compromise? A mozilla.exe in C:\Program Files isn't as suspicious as a startup registry key with a random name! The attacker won't have the opportunity to gain access to the machine every day, but he can be sure that his mozilla.exe will connect back to his C&C server at least every 6 weeks.

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=854088#c21)• 12 years ago |
|  | |

(In reply to Robert Kugler from [comment #20](/show_bug.cgi?id=854088#c20 "RESOLVED FIXED - old MozillaMaintenance Service registry entry not updated, leads to Trusted Path Privilege Escalation"))
> Brian R. Bondy:
> When someone has physically access to your computer he doesn't need a
> Firefox privilege escalation vulnerability.
Yup I was also arguing the same conclusion.
>
> Scenario 1:
> If the attacker compromised the local administrator account (disabled by
> default in Windows 7 and Vista) his malware is able to copy files to C:\ or
> C:\Program Files without any UAC prompt.
Does the local administrator account which is disabled have UAC disabled by default?
> You're right it's too much effort when your malware is already elevated you
> can just create a service running with SYSTEM privileges and start it,
> although creating services isn't smart when you want to stay undetected.
That's just an example, you can modify an existing service's bin path or keep the bin path and replace an already existing service with your executable. You can have a driver that doesn't even show up in your services list etc.
> Okay privilege escalation isn't absolutely necessary in this case but what
> about the "relative stealth" persistence or automacilly re-compromise? A
> mozilla.exe in C:\Program Files isn't as suspicious as a startup registry
> key with a random name! The attacker won't have the opportunity to gain
> access to the machine every day, but he can be sure that his mozilla.exe
> will connect back to his C&C server at least every 6 weeks.
I'm confident that one time high elevation means you can have forever high elevation in a variety of ways. For example using an existing service with a modified binary or driver undetected.
---
I think this boils down to an attack for the people that make their c: writable without elevation. Still a great report though and thank you for posting it!

|  | [Robert Kugler](/user_profile?user_id=451614)  Reporter |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=854088#c22)• 12 years ago |
|  | |

Brian R. Bondy:
"Does the local administrator account which is disabled have UAC disabled by default?"
Exactly, the built-in Administrator account runs all applications with full administrative privilege (default).
I think it would be sec-moderate when there wouldn't be so much
users who are so careless to enable write access to C:\.
When you google "enable write access to C:\" you'll find
quite a lot forum posts!
"...on a vanilla Windows box it should not be possible to write a file to either C:\ or C:\program files, few people have vanilla configurations. I have seen users, admins and OEMs break these security principles before now. You can only really be reasonably confident in the directories you yourself created, not anything else on the file system."
James Forshaw ([bug 748764](/show_bug.cgi?id=748764 "VERIFIED FIXED - Possible Arbitrary Code Execution by Update Service"))
Although it isn't widely exploitable it's a dangerous security risk under special
circumstances!

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=854088#c23)• 12 years ago |
|  | |

Attached patch

[Patch v1.](attachment.cgi?id=731874&action=diff)
— [Details](attachment.cgi?id=731874&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=854088&attachment=731874)

[Attachment #731874](/attachment.cgi?id=731874&action=edit "Patch v1.") -
Flags: review?(robert.bugzilla)

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=854088#c24)• 12 years ago |
|  | |

Comment on [attachment 731874](/attachment.cgi?id=731874 "Patch v1.") [[details]](/attachment.cgi?id=731874&action=edit "Patch v1.") [[diff]](/attachment.cgi?id=731874&action=diff "Patch v1.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=854088&attachment=731874)
Patch v1.
Requesting approval for mozilla-central landing and pushing to try server.
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
- Flaw only affects people with writable C:\
- Flag only affects people who first installed with (I think these versions) Mozilla12 and Mozilla13.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
Yes.
Which older supported branches are affected by this flaw?
Only applicable if user first installed on (I think these versions) Mozilla12 or Mozilla13
If not all supported branches, which bug introduced the flaw?
The flaw is not fixing an old problem, but newer installs do not have the problem at all.
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
Same code for older/other branches can be applied.
How likely is this patch to cause regressions; how much testing does it need?
Low chance of regressions.
[Attachment #731874](/attachment.cgi?id=731874&action=edit "Patch v1.") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=854088#a796727_280903)• 12 years ago |

[Attachment #731874](/attachment.cgi?id=731874&action=edit "Patch v1.") -
Flags: sec-approval? → sec-approval+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=854088#a796801_280903)• 12 years ago |

[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected)
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
--- → [-](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=-)
[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%3F)
[tracking-firefox22](/buglist.cgi?f1=cf_tracking_firefox22&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B)
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=%3F)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=854088#c25)• 12 years ago |
|  | |

Comment on [attachment 731874](/attachment.cgi?id=731874 "Patch v1.") [[details]](/attachment.cgi?id=731874&action=edit "Patch v1.") [[diff]](/attachment.cgi?id=731874&action=diff "Patch v1.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=854088&attachment=731874)
Patch v1.
This should do it.
[Attachment #731874](/attachment.cgi?id=731874&action=edit "Patch v1.") -
Flags: review?(robert.bugzilla) → review+

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=854088#c26)• 12 years ago |
|  | |

Tested already by the way with a v12 installed with the unquoted path and doing a new local install fixes it. Upgrade process follows same logic. I'll test an upgrade though on oak before landing on m-c along with the other bug.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=854088#a816166_280903)• 12 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [bhavana bajaj [:bajaj]](/user_profile?user_id=448925) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=854088#a977913_448925)• 12 years ago |

[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B)
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=%3F) → [21+](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=21%2B)

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=854088#a1052631_407790)• 12 years ago |

Depends on: [857397](/show_bug.cgi?id=857397 "RESOLVED FIXED - Oak branch nightly builds not working")

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=854088#c28)• 12 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/9e6fe353c9b4>Target Milestone: --- → mozilla23

|  | [Phil Ringnalda (:philor)](/user_profile?user_id=135518) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=854088#c29)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/9e6fe353c9b4>Status: NEW → RESOLVEDClosed: 12 years agoResolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=854088#a1258836_75935)• 12 years ago |

[status-b2g18-v1.0.1](/buglist.cgi?f1=cf_status_b2g18_1_0_1&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g18_1_0_1&o1=equals&v1=unaffected)
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=wontfix)
[status-firefox23](/buglist.cgi?f1=cf_status_firefox23&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=fixed)

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=854088#c30)• 12 years ago |
|  | |

Comment on [attachment 731874](/attachment.cgi?id=731874 "Patch v1.") [[details]](/attachment.cgi?id=731874&action=edit "Patch v1.") [[diff]](/attachment.cgi?id=731874&action=diff "Patch v1.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=854088&attachment=731874)
Patch v1.
[Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration: It is sec-hig
User impact if declined:
If an admin of a computer has went out of his way to make his c: writable, and then a low integrity process is running, it can obtain high integrity access. That is if Firefox 12 (and 13?) was installed originally. Later versions of Firefox do not have this bug.
Fix Landed on Version:
v23
Risk to taking this patch (and alternatives if risky):
Low if we wait a couple days for Nightly builds.
String or UUID changes made by this patch:
None.
See <https://wiki.mozilla.org/Release_Management/ESR_Landing_Process> for more info.
[Attachment #731874](/attachment.cgi?id=731874&action=edit "Patch v1.") -
Flags: approval-mozilla-esr17?
[Attachment #731874](/attachment.cgi?id=731874&action=edit "Patch v1.") -
Flags: approval-mozilla-beta?
[Attachment #731874](/attachment.cgi?id=731874&action=edit "Patch v1.") -
Flags: approval-mozilla-aurora?

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=854088#c31)• 12 years ago |
|  | |

Comment on [attachment 731874](/attachment.cgi?id=731874 "Patch v1.") [[details]](/attachment.cgi?id=731874&action=edit "Patch v1.") [[diff]](/attachment.cgi?id=731874&action=diff "Patch v1.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=854088&attachment=731874)
Patch v1.
ESR 10->17 skipped over 12/13, so this only needs to go to Aurora/Beta. Since this impacts updates, we'll take our time uplifting.
[Attachment #731874](/attachment.cgi?id=731874&action=edit "Patch v1.") -
Flags: approval-mozilla-esr17?
[Attachment #731874](/attachment.cgi?id=731874&action=edit "Patch v1.") -
Flags: approval-mozilla-esr17-
[Attachment #731874](/attachment.cgi?id=731874&action=edit "Patch v1.") -
Flags: approval-mozilla-aurora?
[Attachment #731874](/attachment.cgi?id=731874&action=edit "Patch v1.") -
Flags: approval-mozilla-aurora+

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=854088#c32)• 12 years ago |
|  | |

By the way I got an email that this is tracked for ESR17, should tracking-firefox-esr17: 21+ be cleared?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=854088#c33)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/08a001d51ccc>
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=fixed)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=wontfix)

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=854088#a1479462_407790)• 12 years ago |

[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
[21+](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=21%2B) → ---

|  | [bhavana bajaj [:bajaj]](/user_profile?user_id=448925) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=854088#c34)• 12 years ago |
|  | |

Comment on [attachment 731874](/attachment.cgi?id=731874 "Patch v1.") [[details]](/attachment.cgi?id=731874&action=edit "Patch v1.") [[diff]](/attachment.cgi?id=731874&action=diff "Patch v1.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=854088&attachment=731874)
Patch v1.
Please land by Monday EOD PST to get this into Fx 21 Beta 4 .
[Attachment #731874](/attachment.cgi?id=731874&action=edit "Patch v1.") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=854088#c35)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/216376e201d5>
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=854088#c36)• 12 years ago |
|  | |

(In reply to Brian R. Bondy [:bbondy] from [comment #32](/show_bug.cgi?id=854088#c32 "RESOLVED FIXED - old MozillaMaintenance Service registry entry not updated, leads to Trusted Path Privilege Escalation"))
> By the way I got an email that this is tracked for ESR17, should
> tracking-firefox-esr17: 21+ be cleared?
Is ESR unaffected?Whiteboard: [adv-main21+]

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=854088#c37)• 12 years ago |
|  | |

I think as per [Comment 31](/show_bug.cgi?id=854088#c31 "RESOLVED FIXED - old MozillaMaintenance Service registry entry not updated, leads to Trusted Path Privilege Escalation"). I was asking because I got emailed after it was esr17-

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=854088#c38)• 12 years ago |
|  | |

Sure, I was just looking for explicit confirmation that ESR is unaffected.

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=854088#c39)• 12 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #38](/show_bug.cgi?id=854088#c38 "RESOLVED FIXED - old MozillaMaintenance Service registry entry not updated, leads to Trusted Path Privilege Escalation"))
> Sure, I was just looking for explicit confirmation that ESR is unaffected.
I haven't tried it explicitly, but from the best of my knowledge I agree with akeybl. The issue was only present in a couple versions, and those versions never landed inside ESR10/17.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=854088#a3579434_280903)• 12 years ago |

[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=wontfix) → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=854088#a3579943_280903)• 12 years ago |

Alias: CVE-2013-1673

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=854088#a21387847_1689)• 11 years ago |

Group: core-security

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=854088#a353042685_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=854088&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Robert Kugler](/user_profile?user_id=451614)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_73f8d6fa_20250126_081349.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from www.mozilla.org_56650795_20250125_113252.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2013-45

## Mozilla Updater fails to update some Windows Registry entries

Announced
May 14, 2013
Reporter
Robert Kugler
Impact
High
Products
Firefox
Fixed in

* Firefox 21

### Description

Security researcher **Robert Kugler** discovered that in some
instances the Mozilla Maintenance Service on Windows will be vulnerable to some
previously fixed privilege escalation attacks that allowed for local privilege
escalation. This was caused by the Mozilla Updater not updating Windows Registry
entries for the Mozilla Maintenance Service, which fixed the earlier issues
present if Firefox 12 had been installed. New installations of Firefox after
version 12 are not affected by this issue. Local file system access is necessary
in order for this issue to be exploitable and it cannot be triggered through web
content.

### References

* [old MozillaMaintenance Service registry entry not updated leading to
  Trusted Path Privilege Escalation](https://bugzilla.mozilla.org/show_bug.cgi?id=854088) ([CVE-2013-1673](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1673))
* [Possible Arbitrary Code Execution by Update Service](https://bugzilla.mozilla.org/show_bug.cgi?id=748764) ([CVE-2012-1942](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1942))

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


