=== Content from gitlab.freedesktop.org_6b4a91ee_20250126_091559.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

**Commit
4d7c422a**

authored
Mar 02, 2013
by
**[![Alan Coopersmith's avatar](/uploads/-/system/user/avatar/29/avatar.png?width=48 "Alan Coopersmith")](/alanc)
[Alan Coopersmith](/alanc)**

[Browse files](/xorg/lib/libx11/-/tree/4d7c422a37eb9617fb22f8e37527c2b34b105665)

### unvalidated index in \_XkbReadExplicitComponents() [CVE-2013-1997 9/15]

```

If the X server returns key indexes outside the range of the number of
keys it told us to allocate, out of bounds memory writes could occur.

Reported-by: ![default avatar](https://secure.gravatar.com/avatar/71f8d774cf66f37ef8d0817d482fa33569e9145ffa7a67ab10b143407ad8ed70?s=32&d=identicon)Ilja Van Sprundel <ivansprundel@ioactive.com>
Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/72a512422f19eeddf740cc354097e6a5acc2126988b8c743240b4f5e6c36f54f?s=32&d=identicon)Alan Coopersmith <alan.coopersmith@oracle.com>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/b0eb9f4d841c85eee40747be3b53a1df910abf7f98c1c97f15bbc4e7c7ea1c44?s=32&d=identicon)Matthieu Herrb <matthieu.herrb@laas.fr>
```

parent
[e56a2ada](/xorg/lib/libx11/-/commit/e56a2ada719c5cfac5ed61a52a80ade86c0f5957)

Loading

Loading

Loading

* [Changes
  1](/xorg/lib/libx11/-/commit/4d7c422a37eb9617fb22f8e37527c2b34b105665)

[Hide whitespace changes](/xorg/lib/libx11/-/commit/4d7c422a37eb9617fb22f8e37527c2b34b105665?action=show&controller=projects%2Fcommit&id=4d7c422a37eb9617fb22f8e37527c2b34b105665&namespace_id=xorg%2Flib&project_id=libx11&w=1)
[Inline](/xorg/lib/libx11/-/commit/4d7c422a37eb9617fb22f8e37527c2b34b105665?view=inline)
[Side-by-side](/xorg/lib/libx11/-/commit/4d7c422a37eb9617fb22f8e37527c2b34b105665?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from gitlab.freedesktop.org_503fee5e_20250126_091555.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

**Commit
e56a2ada**

authored
Mar 02, 2013
by
**[![Alan Coopersmith's avatar](/uploads/-/system/user/avatar/29/avatar.png?width=48 "Alan Coopersmith")](/alanc)
[Alan Coopersmith](/alanc)**

[Browse files](/xorg/lib/libx11/-/tree/e56a2ada719c5cfac5ed61a52a80ade86c0f5957)

### unvalidated index in \_XkbReadModifierMap() [CVE-2013-1997 8/15]

```

If the X server returns modifier map indexes outside the range of the number
of keys it told us to allocate, out of bounds memory writes could occur.

Reported-by: ![default avatar](https://secure.gravatar.com/avatar/71f8d774cf66f37ef8d0817d482fa33569e9145ffa7a67ab10b143407ad8ed70?s=32&d=identicon)Ilja Van Sprundel <ivansprundel@ioactive.com>
Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/72a512422f19eeddf740cc354097e6a5acc2126988b8c743240b4f5e6c36f54f?s=32&d=identicon)Alan Coopersmith <alan.coopersmith@oracle.com>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/b0eb9f4d841c85eee40747be3b53a1df910abf7f98c1c97f15bbc4e7c7ea1c44?s=32&d=identicon)Matthieu Herrb <matthieu.herrb@laas.fr>
```

parent
[06c086e8](/xorg/lib/libx11/-/commit/06c086e8a1d8374ea9a95ff989f053c96bb1bdca)

Loading

Loading

Loading

* [Changes
  1](/xorg/lib/libx11/-/commit/e56a2ada719c5cfac5ed61a52a80ade86c0f5957)

[Hide whitespace changes](/xorg/lib/libx11/-/commit/e56a2ada719c5cfac5ed61a52a80ade86c0f5957?action=show&controller=projects%2Fcommit&id=e56a2ada719c5cfac5ed61a52a80ade86c0f5957&namespace_id=xorg%2Flib&project_id=libx11&w=1)
[Inline](/xorg/lib/libx11/-/commit/e56a2ada719c5cfac5ed61a52a80ade86c0f5957?view=inline)
[Side-by-side](/xorg/lib/libx11/-/commit/e56a2ada719c5cfac5ed61a52a80ade86c0f5957?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from gitlab.freedesktop.org_e2f89b20_20250126_091602.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

**Commit
26dc2344**

authored
Apr 14, 2013
by
**[![Alan Coopersmith's avatar](/uploads/-/system/user/avatar/29/avatar.png?width=48 "Alan Coopersmith")](/alanc)
[Alan Coopersmith](/alanc)**

[Browse files](/xorg/lib/libfs/-/tree/26dc23446c2e7818fdebfb46e101bac4883df07e)

### Sign extension issue and integer overflow in FSOpenServer() [CVE-2013-1996]

```

>       altlen = (int) *ad++; <-- if char is 0xff, will sign extend to int (0xffffffff == -1)
>       alts[i].name = (char *) FSmalloc(altlen + 1); <-- -1 + 1 == 0
> ...
>       memmove(alts[i].name, ad, altlen); <-- memory corruption

Reported-by: ![default avatar](https://secure.gravatar.com/avatar/71f8d774cf66f37ef8d0817d482fa33569e9145ffa7a67ab10b143407ad8ed70?s=32&d=identicon)Ilja Van Sprundel <ivansprundel@ioactive.com>
Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/72a512422f19eeddf740cc354097e6a5acc2126988b8c743240b4f5e6c36f54f?s=32&d=identicon)Alan Coopersmith <alan.coopersmith@oracle.com>
```

parent
[f6030dd5](/xorg/lib/libfs/-/commit/f6030dd569094fb29720a4bf54aec784b1edcac5)

Loading

Loading

Loading

* [Changes
  1](/xorg/lib/libfs/-/commit/26dc23446c2e7818fdebfb46e101bac4883df07e)

[Hide whitespace changes](/xorg/lib/libfs/-/commit/26dc23446c2e7818fdebfb46e101bac4883df07e?action=show&controller=projects%2Fcommit&id=26dc23446c2e7818fdebfb46e101bac4883df07e&namespace_id=xorg%2Flib&project_id=libfs&w=1)
[Inline](/xorg/lib/libfs/-/commit/26dc23446c2e7818fdebfb46e101bac4883df07e?view=inline)
[Side-by-side](/xorg/lib/libfs/-/commit/26dc23446c2e7818fdebfb46e101bac4883df07e?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from gitlab.freedesktop.org_cf973a22_20250126_091600.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

**Commit
06c086e8**

authored
Mar 02, 2013
by
**[![Alan Coopersmith's avatar](/uploads/-/system/user/avatar/29/avatar.png?width=48 "Alan Coopersmith")](/alanc)
[Alan Coopersmith](/alanc)**

[Browse files](/xorg/lib/libx11/-/tree/06c086e8a1d8374ea9a95ff989f053c96bb1bdca)

### unvalidated index in \_XkbReadKeyBehaviors() [CVE-2013-1997 7/15]

```

If the X server returns key behavior indexes outside the range of the number
of keys it told us to allocate, out of bounds memory writes could occur.

Reported-by: ![default avatar](https://secure.gravatar.com/avatar/71f8d774cf66f37ef8d0817d482fa33569e9145ffa7a67ab10b143407ad8ed70?s=32&d=identicon)Ilja Van Sprundel <ivansprundel@ioactive.com>
Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/72a512422f19eeddf740cc354097e6a5acc2126988b8c743240b4f5e6c36f54f?s=32&d=identicon)Alan Coopersmith <alan.coopersmith@oracle.com>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/b0eb9f4d841c85eee40747be3b53a1df910abf7f98c1c97f15bbc4e7c7ea1c44?s=32&d=identicon)Matthieu Herrb <matthieu.herrb@laas.fr>
```

parent
[00626c38](/xorg/lib/libx11/-/commit/00626c3830b869259098985afa38933d77ccec72)

Loading

Loading

Loading

* [Changes
  1](/xorg/lib/libx11/-/commit/06c086e8a1d8374ea9a95ff989f053c96bb1bdca)

[Hide whitespace changes](/xorg/lib/libx11/-/commit/06c086e8a1d8374ea9a95ff989f053c96bb1bdca?action=show&controller=projects%2Fcommit&id=06c086e8a1d8374ea9a95ff989f053c96bb1bdca&namespace_id=xorg%2Flib&project_id=libx11&w=1)
[Inline](/xorg/lib/libx11/-/commit/06c086e8a1d8374ea9a95ff989f053c96bb1bdca?view=inline)
[Side-by-side](/xorg/lib/libx11/-/commit/06c086e8a1d8374ea9a95ff989f053c96bb1bdca?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from gitlab.freedesktop.org_9ebb345b_20250126_091608.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

**Commit
f293659d**

authored
Mar 01, 2013
by
**[![Alan Coopersmith's avatar](/uploads/-/system/user/avatar/29/avatar.png?width=48 "Alan Coopersmith")](/alanc)
[Alan Coopersmith](/alanc)**

[Browse files](/xorg/lib/libx11/-/tree/f293659d5a4024bda386305bb7ebeb4647c40934)

### unvalidated index in \_XkbReadGetDeviceInfoReply() [CVE-2013-1997 2/15]

```

If the X server returns more buttons than are allocated in the XKB
device info structures, out of bounds writes could occur.

Reported-by: ![default avatar](https://secure.gravatar.com/avatar/71f8d774cf66f37ef8d0817d482fa33569e9145ffa7a67ab10b143407ad8ed70?s=32&d=identicon)Ilja Van Sprundel <ivansprundel@ioactive.com>
Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/72a512422f19eeddf740cc354097e6a5acc2126988b8c743240b4f5e6c36f54f?s=32&d=identicon)Alan Coopersmith <alan.coopersmith@oracle.com>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/b0eb9f4d841c85eee40747be3b53a1df910abf7f98c1c97f15bbc4e7c7ea1c44?s=32&d=identicon)Matthieu Herrb <matthieu.herrb@laas.fr>
```

parent
[cddc4e7e](/xorg/lib/libx11/-/commit/cddc4e7e3cb4b9b7ad25f8591971a86901c249f2)

Loading

Loading

Loading

* [Changes
  1](/xorg/lib/libx11/-/commit/f293659d5a4024bda386305bb7ebeb4647c40934)

[Hide whitespace changes](/xorg/lib/libx11/-/commit/f293659d5a4024bda386305bb7ebeb4647c40934?action=show&controller=projects%2Fcommit&id=f293659d5a4024bda386305bb7ebeb4647c40934&namespace_id=xorg%2Flib&project_id=libx11&w=1)
[Inline](/xorg/lib/libx11/-/commit/f293659d5a4024bda386305bb7ebeb4647c40934?view=inline)
[Side-by-side](/xorg/lib/libx11/-/commit/f293659d5a4024bda386305bb7ebeb4647c40934?view=parallel)

Loading

* [Peter Hutterer](/whot)
  @whot

  mentioned in merge request [!237 (merged)](/xorg/lib/libx11/-/merge_requests/237 "Fix _XkbReadGetDeviceInfoReply for nButtons == dev->buttons")

  ·

  [Nov 30, 2023](#note_2187713)

  mentioned in merge request [!237 (merged)](/xorg/lib/libx11/-/merge_requests/237 "Fix _XkbReadGetDeviceInfoReply for nButtons == dev->buttons")

  mentioned in merge request !237

  Toggle commit list

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from gitlab.freedesktop.org_f5bd5ecc_20250126_091607.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

**Commit
2df882ee**

authored
Mar 02, 2013
by
**[![Alan Coopersmith's avatar](/uploads/-/system/user/avatar/29/avatar.png?width=48 "Alan Coopersmith")](/alanc)
[Alan Coopersmith](/alanc)**

[Browse files](/xorg/lib/libx11/-/tree/2df882eeb3a70256170127a746a9ba26376599a1)

### unvalidated index in \_XkbReadVirtualModMap() [CVE-2013-1997 10/15]

```

If the X server returns modifier map indexes outside the range of the number
of keys it told us to allocate, out of bounds memory writes could occur.

Reported-by: ![default avatar](https://secure.gravatar.com/avatar/71f8d774cf66f37ef8d0817d482fa33569e9145ffa7a67ab10b143407ad8ed70?s=32&d=identicon)Ilja Van Sprundel <ivansprundel@ioactive.com>
Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/72a512422f19eeddf740cc354097e6a5acc2126988b8c743240b4f5e6c36f54f?s=32&d=identicon)Alan Coopersmith <alan.coopersmith@oracle.com>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/b0eb9f4d841c85eee40747be3b53a1df910abf7f98c1c97f15bbc4e7c7ea1c44?s=32&d=identicon)Matthieu Herrb <matthieu.herrb@laas.fr>
```

parent
[4d7c422a](/xorg/lib/libx11/-/commit/4d7c422a37eb9617fb22f8e37527c2b34b105665)

Loading

Loading

Loading

* [Changes
  1](/xorg/lib/libx11/-/commit/2df882eeb3a70256170127a746a9ba26376599a1)

[Hide whitespace changes](/xorg/lib/libx11/-/commit/2df882eeb3a70256170127a746a9ba26376599a1?action=show&controller=projects%2Fcommit&id=2df882eeb3a70256170127a746a9ba26376599a1&namespace_id=xorg%2Flib&project_id=libx11&w=1)
[Inline](/xorg/lib/libx11/-/commit/2df882eeb3a70256170127a746a9ba26376599a1?view=inline)
[Side-by-side](/xorg/lib/libx11/-/commit/2df882eeb3a70256170127a746a9ba26376599a1?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from www.x.org_6c6d7261_20250125_140837.html ===

![](../../../logo.png)

[xorg](../../../)/
[Development](../../)/
[Security](../)/

X.Org Security Advisory: May 23, 2013

* [Edit](https://secure.freedesktop.org/write/xorg/ikiwiki.cgi?do=edit&page=Development%2FSecurity%2FAdvisory-2013-05-23)
* [Page History](https://cgit.freedesktop.org/wiki/xorg/log/Development/Security/Advisory-2013-05-23.mdwn)
* [Repo Info](https://cgit.freedesktop.org/wiki/xorg/)

# X.Org Security Advisory: May 23, 2013

## Protocol handling issues in X Window System client libraries

### Description

Ilja van Sprundel, a security researcher with IOActive, has discovered a large number of issues in the way various X client libraries handle the responses they receive from servers, and has worked with X.Org's security team to analyze, confirm, and fix these issues.

Most of these issues stem from the client libraries trusting the server to send correct protocol data, and not verifying that the values will not overflow or cause other damage. Most of the time X clients & servers are run by the same user, with the server more privileged from the clients, so this is not a problem, but there are scenarios in which a privileged client can be connected to an unprivileged server, for instance, connecting a setuid X client (such as a screen lock program) to a virtual X server (such as Xvfb or Xephyr) which the user has modified to return invalid data, potentially allowing the user to escalate their privileges.

The X.Org security team would like to take this opportunity to remind X client authors that current best practices suggest separating code that requires privileges from the GUI, to reduce the attack surface of issues like this.

The vulnerabilities include:

* **integer overflows calculating memory needs for replies**
  + *These calls do not check that their calculations for how much memory is needed to handle the returned data have not overflowed, so can result in allocating too little memory and then writing the returned data past the end of the allocated buffer.*
  + CVE-2013-1981: libX11 1.5.99.901 (1.6 RC1) and earlier
    - Affected functions: XQueryFont(), \_XF86BigfontQueryFont(), XListFontsWithInfo(), XGetMotionEvents(), XListHosts(), XGetModifierMapping(), XGetPointerMapping(), XGetKeyboardMapping(), XGetWindowProperty(), XGetImage()
  + CVE-2013-1982: libXext 1.3.1 and earlier
    - Affected functions: XcupGetReservedColormapEntries(), XcupStoreColors(), XdbeGetVisualInfo(), XeviGetVisualInfo(), XShapeGetRectangles(), XSyncListSystemCounters()
  + CVE-2013-1983: libXfixes 5.0 and earlier
    - Affected functions: XFixesGetCursorImage()
  + CVE-2013-1984: libXi 1.7.1 and earlier
    - Affected functions: XGetDeviceControl(), XGetFeedbackControl(), XGetDeviceDontPropagateList(), XGetDeviceMotionEvents(), XIGetProperty(), XIGetSelectedEvents(), XGetDeviceProperties(), XListInputDevices()
  + CVE-2013-1985: libXinerama 1.1.2 and earlier
    - Affected functions: XineramaQueryScreens()
  + CVE-2013-2062: libXp 1.0.1 and earlier
    - Affected functions: XpGetAttributes(), XpGetOneAttribute(), XpGetPrinterList(), XpQueryScreens()
  + CVE-2013-1986: libXrandr 1.4.0 and earlier
    - Affected functions: XRRQueryOutputProperty(), XRRQueryProviderProperty()
      [XRRQueryProviderProperty() was introduced in libXrandr 1.4.0 and is not found in 1.3.2 and older releases.]
  + CVE-2013-1987: libXrender 0.9.7 and earlier
    - Affected functions: XRenderQueryFilters(), XRenderQueryFormats(), XRenderQueryPictIndexValues()
  + CVE-2013-1988: libXRes 1.0.6 and earlier
    - Affected functions: XResQueryClients(), XResQueryClientResources()
  + CVE-2013-2063: libXtst 1.2.1 and earlier
    - Affected functions: XRecordGetContext()
  + CVE-2013-1989: libXv 1.0.7 and earlier
    - Affected functions: XvQueryPortAttributes(), XvListImageFormats(), XvCreateImage()
  + CVE-2013-1990: libXvMC 1.0.7 and earlier
    - Affected functions: XvMCListSurfaceTypes(), XvMCListSubpictureTypes()
  + CVE-2013-1991: libXxf86dga 1.1.3 and earlier
    - Affected functions: XDGAQueryModes(), XDGASetMode()
  + CVE-2013-1992: libdmx 1.1.2 and earlier
    - Affected functions: DMXGetScreenAttributes(), DMXGetWindowAttributes(), \* DMXGetInputAttributes()
  + CVE-2013-2064: libxcb 1.9 and earlier
    - Affected functions: read\_packet()
  + CVE-2013-1993: libGLX in Mesa 9.1.1 and earlier
    - Affected functions: XF86DRIOpenConnection(), XF86DRIGetClientDriverName()
  + CVE-2013-1994: libchromeXvMC & libchromeXvMCPro in openChrome 0.3.2 and earlier
    - Affected functions: uniDRIOpenConnection(), uniDRIGetClientDriverName()
* **sign extension issues calculating memory needs for replies**
  + *These calls do not check that their calculations for how much memory is needed to handle the returned data have not had sign extension issues when converting smaller integer types to larger ones, leading to negative numbers being used in memory size calculations that can result in allocating too little memory and then writing the returned data past the end of the allocated buffer.*
  + CVE-2013-1995: libXi 1.7.1 and earlier
    - Affected functions: XListInputDevices()
  + CVE-2013-1996: libFS 1.0.4 and earlier
    - Affected functions: FSOpenServer()
* **buffer overflows due to not validating length or offset values in replies**
  + *These calls do not check that the lengths and/or indexes returned by the server are within the bounds specified by the caller or the bounds of the memory allocated by the function, so could write past the bounds of allocated memory when storing the returned data.*
  + CVE-2013-1997: libX11 1.5.99.901 (1.6 RC1) and earlier
    - Affected functions: XAllocColorCells(), \_XkbReadGetDeviceInfoReply(), \_XkbReadGeomShapes(), \_XkbReadGetGeometryReply(), \_XkbReadKeySyms(), \_XkbReadKeyActions(), \_XkbReadKeyBehaviors(), \_XkbReadModifierMap(), \_XkbReadExplicitComponents(), \_XkbReadVirtualModMap(), \_XkbReadGetNamesReply(), \_XkbReadGetMapReply(), \_XimXGetReadData(), XListFonts(), XListExtensions(), XGetFontPath()
  + CVE-2013-1998: libXi 1.7.1 and earlier
    - Affected functions: XGetDeviceButtonMapping(), \_XIPassiveGrabDevice(), XQueryDeviceState()
  + CVE-2013-2066: libXv 1.0.7 and earlier
    - Affected functions: XvQueryPortAttributes()
  + CVE-2013-1999: libXvMC 1.0.7 and earlier
    - Affected functions: XvMCGetDRInfo()
  + CVE-2013-2000: libXxf86dga 1.1.3 and earlier
    - Affected functions: XDGAQueryModes(), XDGASetMode()
  + CVE-2013-2001: libXxf86vm 1.1.2 and earlier
    - Affected functions: XF86VidModeGetGammaRamp()
  + CVE-2013-2002: libXt 1.1.3 and earlier
    - Affected functions: \_XtResourceConfigurationEH()
* **integer overflows parsing user-specified files**
  + *These calls do not check that their calculations for how much memory is needed to handle the data being read have not overflowed, so can result in allocating too little memory and then writing the returned data past the end of the allocated buffer.*
  + CVE-2013-1981: libX11 1.5.99.901 (1.6 RC1) and earlier
    - Affected functions: LoadColornameDB(), XrmGetFileDatabase(), \_XimParseStringFile(), TransFileName()
  + CVE-2013-2003: libXcursor 1.1.13 and earlier
    - Affected functions: \_XcursorFileHeaderCreate()
* **unbounded recursion parsing user-specified files**
  + *These calls read in files and handle C-style '#include' directives to include other files, and have no limit for how many levels deep they will go, including allowing files to #include themselves, until the stack overflows from the recursive function calling patterns.*
  + CVE-2013-2004: libX11 1.5.99.901 (1.6 RC1) and earlier
    - Affected functions: GetDatabase(), \_XimParseStringFile()
* **memory corruption due to unchecked return values**
  + *These calls assume that pointers are properly initialized by the XGetWindowProperty() function and don't check for failure of the function to return a valid window property, which can lead to use of uninitialized pointers for reading, writing, or passing to functions such as free(). XGetWindowProperty() in libX11 1.5.99.901 (1.6RC1) and earlier did not ensure returned pointers were initialized to NULL when returning a failure (this is fixed in libX11 1.5.99.902 and later).*
  + CVE-2013-2005: libXt 1.1.3 and earlier
    - Affected functions: ReqCleanup(), HandleSelectionEvents(), ReqTimedOut(), HandleNormal(), HandleSelectionReplies()

### Affected Versions

X.Org believes all prior versions of these libraries contain these flaws, dating back to their introduction.

Versions of the X libraries built on top of the Xlib bridge to the XCB framework are vulnerable to fewer issues than those without, due to the added safety and consistency assertions in the XCB calls to read data from the network, but most of these vulnerabilities are not caught by those checks.

### Fixes

Fixes are available in these git commits:

*Note that many of these patches depend on being applied in the same order as they are in git, or on other non-CVE patches in git, and won't necessarily apply in the order listed here to previous tarball releases.*

* CVE-2013-1981: libX11 1.5.99.901 (1.6 RC1) and earlier
  + [6df8a63d34b7514077188e2062a13774f920c085 integer overflow in \_XQueryFont() on 32-bit platforms (CVE-2013-1981 1/13)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/6df8a63d34b7514077188e2062a13774f920c085)
  + [5669a220816b7d58fcaf0c302ead16fbe5c87817 integer overflow in \_XF86BigfontQueryFont() (CVE-2013-1981 2/13)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/5669a220816b7d58fcaf0c302ead16fbe5c87817)
  + [39515b7c3ba8cae9021bf6695e378ae19487082f integer overflow in XListFontsWithInfo() (CVE-2013-1981 3/13)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/39515b7c3ba8cae9021bf6695e378ae19487082f)
  + [1f6a3dbf699b85c0ea715ef21de7e7095a714e12 integer overflow in XGetMotionEvents() (CVE-2013-1981 4/13)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/1f6a3dbf699b85c0ea715ef21de7e7095a714e12)
  + [2cd62b5eb99ffbb2fce99f3c459455e630b35bf7 integer overflow in XListHosts() (CVE-2013-1981 5/13)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/2cd62b5eb99ffbb2fce99f3c459455e630b35bf7)
  + [90fd5abac2faca86f9f100353a3c9c7b89f31484 Integer overflows in stringSectionSize() cause buffer overflow in ReadColornameDB() (CVE-2013-1981 6/13)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/90fd5abac2faca86f9f100353a3c9c7b89f31484)
  + [076428918e6c35f66b9b55c3fa097ff06496d155 integer overflow in ReadInFile() in Xrm.c (CVE-2013-1981 7/13)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/076428918e6c35f66b9b55c3fa097ff06496d155)
  + [460e8a223b87d4fa0ea1e97823e998a770e0f2a2 integer truncation in \_XimParseStringFile() (CVE-2013-1981 8/13)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/460e8a223b87d4fa0ea1e97823e998a770e0f2a2)
  + [164bf4dfe839b1cc75cdeee378a243d04a8200e4 integer overflows in TransFileName() (CVE-2013-1981 9/13)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/164bf4dfe839b1cc75cdeee378a243d04a8200e4)
  + [79d8dc08eb98842173ce239b9dd60df0e9e9ae72 integer overflow in XGetWindowProperty() (CVE-2013-1981 10/13)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/79d8dc08eb98842173ce239b9dd60df0e9e9ae72)
  + [833f6b70bc789d33607f6dbfee9e0a4178ec4b59 integer overflow in XGetImage() (CVE-2013-1981 11/13)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/833f6b70bc789d33607f6dbfee9e0a4178ec4b59)
  + [a351b8103b2ba78882e1c309e85893ca3abe2073 integer overflow in XGetPointerMapping() & XGetKeyboardMapping() (CVE-2013-1981 12/13)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/a351b8103b2ba78882e1c309e85893ca3abe2073)
  + [0b0f5d4358c3de7563d6af03f0d2ce454702a06a integer overflow in XGetModifierMapping() (CVE-2013-1981 13/13)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/0b0f5d4358c3de7563d6af03f0d2ce454702a06a)
* CVE-2013-1982: libXext 1.3.1 and earlier
  + [d05f27a6f74cb419ad5a437f2e4690b17e7faee5 integer overflow in XcupGetReservedColormapEntries() (CVE-2013-1982 1/6)](https://gitlab.freedesktop.org/xorg/lib/libxext/-/commit/d05f27a6f74cb419ad5a437f2e4690b17e7faee5)
  + [082d70b19848059ba78c9d1c315114fb07e8c0ef integer overflow in XcupStoreColors() (CVE-2013-1982 2/6)](https://gitlab.freedesktop.org/xorg/lib/libxext/-/commit/082d70b19848059ba78c9d1c315114fb07e8c0ef)
  + [96d1da55a08c4cd52b763cb07bdce5cdcbec4da8 several integer overflows in XdbeGetVisualInfo() (CVE-2013-1982 3/6)](https://gitlab.freedesktop.org/xorg/lib/libxext/-/commit/96d1da55a08c4cd52b763cb07bdce5cdcbec4da8)
  + [67ecdcf7e29de9fa78b421122620525ed2c7db88 integer overflow in XeviGetVisualInfo() (CVE-2013-1982 4/6)](https://gitlab.freedesktop.org/xorg/lib/libxext/-/commit/67ecdcf7e29de9fa78b421122620525ed2c7db88)
  + [6ecd96e8be3c33e2ffad6631cea4aa0a030d93c2 integer overflow in XShapeGetRectangles() (CVE-2013-1982 5/6)](https://gitlab.freedesktop.org/xorg/lib/libxext/-/commit/6ecd96e8be3c33e2ffad6631cea4aa0a030d93c2)
  + [dfe6e1f3b8ede3d0bab7a5fa57f73513a09ec649 integer overflow in XSyncListSystemCounters() (CVE-2013-1982 6/6)](https://gitlab.freedesktop.org/xorg/lib/libxext/-/commit/dfe6e1f3b8ede3d0bab7a5fa57f73513a09ec649)
* CVE-2013-1983: libXfixes 5.0 and earlier
  + [c480fe3271873ec7471b0cbd680f4dac18ca8904 integer overflow in XFixesGetCursorImage() (CVE-2013-1983)](https://gitlab.freedesktop.org/xorg/lib/libxfixes/-/commit/c480fe3271873ec7471b0cbd680f4dac18ca8904)
* CVE-2013-1984: libXi 1.7.1 and earlier
  + [b0b13c12a8079a5a0e7f43b2b8983699057b2cec integer overflow in XGetDeviceControl() (CVE-2013-1984 1/8)](https://gitlab.freedesktop.org/xorg/lib/libxi/-/commit/b0b13c12a8079a5a0e7f43b2b8983699057b2cec)
  + [322ee3576789380222d4403366e4fd12fb24cb6a integer overflow in XGetFeedbackControl() (CVE-2013-1984 2/8)](https://gitlab.freedesktop.org/xorg/lib/libxi/-/commit/322ee3576789380222d4403366e4fd12fb24cb6a)
  + [6dd6dc51a2935c72774be81e5cc2ba2c30e9feff integer overflow in XGetDeviceDontPropagateList() (CVE-2013-1984 3/8)](https://gitlab.freedesktop.org/xorg/lib/libxi/-/commit/6dd6dc51a2935c72774be81e5cc2ba2c30e9feff)
  + [bb922ed4253b35590f0369f32a917ff89ade0830 integer overflow in XGetDeviceMotionEvents() (CVE-2013-1984 4/8)](https://gitlab.freedesktop.org/xorg/lib/libxi/-/commit/bb922ed4253b35590f0369f32a917ff89ade0830)
  + [242f92b490a695fbab244af5bad11b71f897c732 integer overflow in XIGetProperty() (CVE-2013-1984 5/8)](https://gitlab.freedesktop.org/xorg/lib/libxi/-/commit/242f92b490a695fbab244af5bad11b71f897c732)
  + [528419b9ef437e7eeafb41bf45e8ff7d818bd845 integer overflow in XIGetSelectedEvents() (CVE-2013-1984 6/8)](https://gitlab.freedesktop.org/xorg/lib/libxi/-/commit/528419b9ef437e7eeafb41bf45e8ff7d818bd845)
  + [17071c1c608247800b2ca03a35b1fcc9c4cabe6c Avoid integer overflow in XGetDeviceProperties() (CVE-2013-1984 7/8)](https://gitlab.freedesktop.org/xorg/lib/libxi/-/commit/17071c1c608247800b2ca03a35b1fcc9c4cabe6c)
  + [ef82512288d8ca36ac0beeb289f158195b0a8cae Avoid integer overflow in XListInputDevices() (CVE-2013-1984 8/8)](https://gitlab.freedesktop.org/xorg/lib/libxi/-/commit/ef82512288d8ca36ac0beeb289f158195b0a8cae)
* CVE-2013-1985: libXinerama 1.1.2 and earlier
  + [99c644fc8488657bdd106717df7446d606f9ef22 integer overflow in XineramaQueryScreens() (CVE-2013-1985)](https://gitlab.freedesktop.org/xorg/lib/libxinerama/-/commit/99c644fc8488657bdd106717df7446d606f9ef22)
* CVE-2013-2062: libXp 1.0.1 and earlier
  + [babb1fc823ab3be192c48fe115feeb0d57f74d05 integer overflow in XpGetAttributes & XpGetOneAttribute (CVE-2013-2062 1/3)](https://gitlab.freedesktop.org/xorg/lib/libxp/-/commit/babb1fc823ab3be192c48fe115feeb0d57f74d05)
  + [cc90f6be64bfd6973ae270b9bff494f577e1bda7 integer overflows in XpGetPrinterList() (CVE-2013-2062 2/3)](https://gitlab.freedesktop.org/xorg/lib/libxp/-/commit/cc90f6be64bfd6973ae270b9bff494f577e1bda7)
  + [e111065f6dd790c820fa67ea31055b18c68481e3 integer overflows in XpQueryScreens() (CVE-2013-2062 3/3)](https://gitlab.freedesktop.org/xorg/lib/libxp/-/commit/e111065f6dd790c820fa67ea31055b18c68481e3)
* CVE-2013-1986: libXrandr 1.4.0 and earlier
  + [0e79d96c36aef5889ae2e2a3fc2e96e93f30dc21 integer overflow in XRRQueryOutputProperty() (CVE-2013-1986 1/4)](https://gitlab.freedesktop.org/xorg/lib/libxrandr/-/commit/0e79d96c36aef5889ae2e2a3fc2e96e93f30dc21)
  + [1da5b838c2a8565d4d95a4e948f951ce6b466345 integer overflow in XRRQueryProviderProperty() (CVE-2013-1986 2/4)](https://gitlab.freedesktop.org/xorg/lib/libxrandr/-/commit/1da5b838c2a8565d4d95a4e948f951ce6b466345)
  + [289a1927949e6f278c18d115772e454837702e35 integer overflow in XRRGetOutputProperty() (CVE-2013-1986 3/4)](https://gitlab.freedesktop.org/xorg/lib/libxrandr/-/commit/289a1927949e6f278c18d115772e454837702e35)
  + [4254bf0ee4c7a8f9d03841cf0d8e16cbb201dfbd integer overflow in XRRGetProviderProperty() (CVE-2013-1986 4/4)](https://gitlab.freedesktop.org/xorg/lib/libxrandr/-/commit/4254bf0ee4c7a8f9d03841cf0d8e16cbb201dfbd)
* CVE-2013-1987: libXrender 0.9.7 and earlier
  + [e52853974664289fe42a92909667ed77cfa1cec5 integer overflow in XRenderQueryFilters() (CVE-2013-1987 1/3)](https://gitlab.freedesktop.org/xorg/lib/libxrender/-/commit/e52853974664289fe42a92909667ed77cfa1cec5)
  + [9e577d40322b9e3d8bdefec0eefa44d8ead451a4 integer overflow in XRenderQueryFormats() (CVE-2013-1987 2/3)](https://gitlab.freedesktop.org/xorg/lib/libxrender/-/commit/9e577d40322b9e3d8bdefec0eefa44d8ead451a4)
  + [786f78fd8df6d165ccbc81f306fd9f22b5c1551c integer overflow in XRenderQueryPictIndexValues() (CVE-2013-1987 3/3)](https://gitlab.freedesktop.org/xorg/lib/libxrender/-/commit/786f78fd8df6d165ccbc81f306fd9f22b5c1551c)
* CVE-2013-1988: libXRes 1.0.6 and earlier
  + [3ec2db9eeb9ba8fb561802b0c4b8bf79e321b7a2 integer overflow in XResQueryClients() (CVE-2013-1988 1/2)](https://gitlab.freedesktop.org/xorg/lib/libxres/-/commit/3ec2db9eeb9ba8fb561802b0c4b8bf79e321b7a2)
  + [ad156a716a324ee60362c8ba66a5ed8c835c219b integer overflow in XResQueryClientResources() (CVE-2013-1988 2/2)](https://gitlab.freedesktop.org/xorg/lib/libxres/-/commit/ad156a716a324ee60362c8ba66a5ed8c835c219b)
* CVE-2013-2063: libXtst 1.2.1 and earlier
  + [e7e04b7be3f018ad636aba3a36bfc1cd80b9906d integer overflow in XRecordGetContext() (CVE-2013-2063)](https://gitlab.freedesktop.org/xorg/lib/libxtst/-/commit/e7e04b7be3f018ad636aba3a36bfc1cd80b9906d)
* CVE-2013-1989: libXv 1.0.7 and earlier
  + [6e1b743a276651195be3cd68dff41e38426bf3ab integer overflow in XvQueryPortAttributes() (CVE-2013-1989 1/3)](https://gitlab.freedesktop.org/xorg/lib/libxv/-/commit/6e1b743a276651195be3cd68dff41e38426bf3ab)
  + [59301c1b5095f7dc6359d5b396dbbcdee7038270 integer overflow in XvListImageFormats() (CVE-2013-1989 2/3)](https://gitlab.freedesktop.org/xorg/lib/libxv/-/commit/59301c1b5095f7dc6359d5b396dbbcdee7038270)
  + [50fc4cb18069cb9450a02c13f80223ef23511409 integer overflow in XvCreateImage() (CVE-2013-1989 3/3)](https://gitlab.freedesktop.org/xorg/lib/libxv/-/commit/50fc4cb18069cb9450a02c13f80223ef23511409)
* CVE-2013-1990: libXvMC 1.0.7 and earlier
  + [2712383813b26475dc6713888414d842be57f8ca integer overflow in XvMCListSurfaceTypes() (CVE-2013-1990 1/2)](https://gitlab.freedesktop.org/xorg/lib/libxvmc/-/commit/2712383813b26475dc6713888414d842be57f8ca)
  + [478d4e5873eeee2ebdce6673e4e3469816ab63b8 integer overflow in XvMCListSubpictureTypes() (CVE-2013-1990 2/2)](https://gitlab.freedesktop.org/xorg/lib/libxvmc/-/commit/478d4e5873eeee2ebdce6673e4e3469816ab63b8)
* CVE-2013-1991: libXxf86dga 1.1.3 and earlier
  + [f4a8dd63af518640468d82948f450aad4b2b1e6a integer overflow in XDGAQueryModes() (CVE-2013-1991 1/2)](https://gitlab.freedesktop.org/xorg/lib/libxxf86dga/-/commit/f4a8dd63af518640468d82948f450aad4b2b1e6a)
  + [f89cf306a60facdf102696840bc05acebd7d1772 integer overflow & underflow in XDGASetMode() (CVE-2013-1991 2/2)](https://gitlab.freedesktop.org/xorg/lib/libxxf86dga/-/commit/f89cf306a60facdf102696840bc05acebd7d1772)
* CVE-2013-1992: libdmx 1.1.2 and earlier
  + [78e11efe70d00063c830475eaaaa42f19380755d integer overflow in DMXGetScreenAttributes() (CVE-2013-1992 1/3)](https://gitlab.freedesktop.org/xorg/lib/libdmx/-/commit/78e11efe70d00063c830475eaaaa42f19380755d)
  + [b6fe1a7af34ea620e002fc453f9c5eacf7db3969 integer overflow in DMXGetWindowAttributes() (CVE-2013-1992 2/3)](https://gitlab.freedesktop.org/xorg/lib/libdmx/-/commit/b6fe1a7af34ea620e002fc453f9c5eacf7db3969)
  + [5074d9d64192bd04519a438062b7d5bf216d06ee integer overflow in DMXGetInputAttributes() (CVE-2013-1992 3/3)](https://gitlab.freedesktop.org/xorg/lib/libdmx/-/commit/5074d9d64192bd04519a438062b7d5bf216d06ee)
* CVE-2013-2064: libxcb 1.9 and earlier
  + [1b33867fa996034deb50819ae54640be501f8d20 integer overflow in read\_packet() (CVE-2013-2064)](https://gitlab.freedesktop.org/xorg/lib/libxcb/-/commit/1b33867fa996034deb50819ae54640be501f8d20)
* CVE-2013-1993: libGLX in Mesa 9.1.1 and earlier
  + [integer overflow in XF86DRIOpenConnection() (CVE-2013-1993 1/2)](http://lists.freedesktop.org/archives/mesa-dev/2013-May/039720.html)
  + [integer overflow in XF86DRIGetClientDriverName() (CVE-2013-1993 2/2)](http://lists.freedesktop.org/archives/mesa-dev/2013-May/039722.html)
* CVE-2013-1994: libchromeXvMC & libchromeXvMCPro in openChrome 0.3.2 and earlier
  + [68bf50ce4903ec93da59cea78e063ed7c3882d3e integer overflow in uniDRIOpenConnection() in libchromeXvMC\* (CVE-2013-1994 1/2)](http://cgit.freedesktop.org/openchrome/xf86-video-openchrome/commit/?id=68bf50ce4903ec93da59cea78e063ed7c3882d3e)
  + [db309e3cd87a1279e8b592a692390755c528de4f integer overflow in uniDRIGetClientDriverName() in libchromeXvMC\* (CVE-2013-1994 2/2)](http://cgit.freedesktop.org/openchrome/xf86-video-openchrome/commit/?id=db309e3cd87a1279e8b592a692390755c528de4f)
* CVE-2013-1995: libXi 1.7.1 and earlier
  + [81b4df8ac6aa1520c41c3526961014a6f115cc46 sign extension issue in XListInputDevices() (CVE-2013-1995)](https://gitlab.freedesktop.org/xorg/lib/libxi/-/commit/81b4df8ac6aa1520c41c3526961014a6f115cc46)
* CVE-2013-1996: libFS 1.0.4 and earlier
  + [26dc23446c2e7818fdebfb46e101bac4883df07e Sign extension issue and integer overflow in FSOpenServer() (CVE-2013-1996)](https://gitlab.freedesktop.org/xorg/lib/libfs/-/commit/26dc23446c2e7818fdebfb46e101bac4883df07e)
* CVE-2013-1997: libX11 1.5.99.901 (1.6 RC1) and earlier
  + [cddc4e7e3cb4b9b7ad25f8591971a86901c249f2 unvalidated lengths in XAllocColorCells() (CVE-2013-1997 1/15)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/cddc4e7e3cb4b9b7ad25f8591971a86901c249f2)
  + [f293659d5a4024bda386305bb7ebeb4647c40934 unvalidated index in \_XkbReadGetDeviceInfoReply() (CVE-2013-1997 2/15)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/f293659d5a4024bda386305bb7ebeb4647c40934)
  + [bff938b9fe1629cbacb726509edfa2a3840b7207 unvalidated indexes in \_XkbReadGeomShapes() (CVE-2013-1997 3/15)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/bff938b9fe1629cbacb726509edfa2a3840b7207)
  + [59ae16a00d18588e98af57d26e442af8ea42b7aa unvalidated indexes in \_XkbReadGetGeometryReply() (CVE-2013-1997 4/15)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/59ae16a00d18588e98af57d26e442af8ea42b7aa)
  + [fd7d4956bc7a1c4b5c38661b12777ebee4d685d9 unvalidated index in \_XkbReadKeySyms() (CVE-2013-1997 5/15)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/fd7d4956bc7a1c4b5c38661b12777ebee4d685d9)
  + [00626c3830b869259098985afa38933d77ccec72 unvalidated index in \_XkbReadKeyActions() (CVE-2013-1997 6/15)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/00626c3830b869259098985afa38933d77ccec72)
  + [06c086e8a1d8374ea9a95ff989f053c96bb1bdca unvalidated index in \_XkbReadKeyBehaviors() (CVE-2013-1997 7/15)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/06c086e8a1d8374ea9a95ff989f053c96bb1bdca)
  + [e56a2ada719c5cfac5ed61a52a80ade86c0f5957 unvalidated index in \_XkbReadModifierMap() (CVE-2013-1997 8/15)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/e56a2ada719c5cfac5ed61a52a80ade86c0f5957)
  + [4d7c422a37eb9617fb22f8e37527c2b34b105665 unvalidated index in \_XkbReadExplicitComponents() (CVE-2013-1997 9/15)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/4d7c422a37eb9617fb22f8e37527c2b34b105665)
  + [2df882eeb3a70256170127a746a9ba26376599a1 unvalidated index in \_XkbReadVirtualModMap() (CVE-2013-1997 10/15)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/2df882eeb3a70256170127a746a9ba26376599a1)
  + [de2e6c322c4aca22856b380f67f8e488e7510015 unvalidated index/length in \_XkbReadGetNamesReply() (CVE-2013-1997 11/15)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/de2e6c322c4aca22856b380f67f8e488e7510015)
  + [b9ba832401734e1cbd30a930c0d11d850293f3f9 unvalidated length in \_XimXGetReadData() (CVE-2013-1997 12/15)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/b9ba832401734e1cbd30a930c0d11d850293f3f9)
  + [0c404db6a92dc2c198328bf586c02d8abbe02013 Avoid overflows in XListFonts() (CVE-2013-1997 13/15)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/0c404db6a92dc2c198328bf586c02d8abbe02013)
  + [8d5936594993921acdfec778dd8f41b555e2543a Avoid overflows in XGetFontPath() (CVE-2013-1997 14/15)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/8d5936594993921acdfec778dd8f41b555e2543a)
  + [db1b1c871da29aa0545182bf888df81627f165a5 Avoid overflows in XListExtensions() (CVE-2013-1997 15/15)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/db1b1c871da29aa0545182bf888df81627f165a5)
* CVE-2013-1998: libXi 1.7.1 and earlier
  + [f3e08e4fbe40016484ba795feecf1a742170ffc1 Stack buffer overflow in XGetDeviceButtonMapping() (CVE-2013-1998 1/3)](https://gitlab.freedesktop.org/xorg/lib/libxi/-/commit/f3e08e4fbe40016484ba795feecf1a742170ffc1)
  + [91434737f592e8f5cc1762383882a582b55fc03a memory corruption in \_XIPassiveGrabDevice() (CVE-2013-1998 2/3)](https://gitlab.freedesktop.org/xorg/lib/libxi/-/commit/91434737f592e8f5cc1762383882a582b55fc03a)
  + [5398ac0797f7516f2c9b8f2869a6c6d071437352 unvalidated lengths in XQueryDeviceState() (CVE-2013-1998 3/3)](https://gitlab.freedesktop.org/xorg/lib/libxi/-/commit/5398ac0797f7516f2c9b8f2869a6c6d071437352)
* CVE-2013-2066: libXv 1.0.7 and earlier
  + [15ab7dec17d686c38f2c82ac23a17cac5622322a buffer overflow in XvQueryPortAttributes() (CVE-2013-2066)](https://gitlab.freedesktop.org/xorg/lib/libxv/-/commit/15ab7dec17d686c38f2c82ac23a17cac5622322a)
* CVE-2013-1999: libXvMC 1.0.7 and earlier
  + [e9415ddef2ac81d4139bd32d5e9cda9394a60051 Multiple unvalidated assumptions in XvMCGetDRInfo() (CVE-2013-1999)](https://gitlab.freedesktop.org/xorg/lib/libxvmc/-/commit/e9415ddef2ac81d4139bd32d5e9cda9394a60051)
* CVE-2013-2000: libXxf86dga 1.1.3 and earlier
  + [5dcfa6a8cf2df39828da733e5945e730518c27b3 buffer overflow in XDGAQueryModes() (CVE-2013-2000 1/2)](https://gitlab.freedesktop.org/xorg/lib/libxxf86dga/-/commit/5dcfa6a8cf2df39828da733e5945e730518c27b3)
  + [b69d6d51a82b1d1e8c68a233360acb742c879375 buffer overflow in XDGASetMode() (CVE-2013-2000 2/2)](https://gitlab.freedesktop.org/xorg/lib/libxxf86dga/-/commit/b69d6d51a82b1d1e8c68a233360acb742c879375)
* CVE-2013-2001: libXxf86vm 1.1.2 and earlier
  + [47bb28ac0e6e49d3b6eb90c7c215f2fcf54f1a95 memory corruption in XF86VidModeGetGammaRamp() (CVE-2013-2001)](https://gitlab.freedesktop.org/xorg/lib/libxxf86vm/-/commit/47bb28ac0e6e49d3b6eb90c7c215f2fcf54f1a95)
* CVE-2013-2002: libXt 1.1.3 and earlier
  + [9264a21b688891dbdcee630ff72cf39aa75fc4e1 unvalidated length in \_XtResourceConfigurationEH (CVE-2013-2002)](https://gitlab.freedesktop.org/xorg/lib/libxt/-/commit/9264a21b688891dbdcee630ff72cf39aa75fc4e1)
* CVE-2013-2003: libXcursor 1.1.13 and earlier
  + [8f677eaea05290531d007d1fec2768119926088d signedness bug & integer overflow in \_XcursorFileHeaderCreate() (CVE-2013-2003)](https://gitlab.freedesktop.org/xorg/lib/libxcursor/-/commit/8f677eaea05290531d007d1fec2768119926088d)
* CVE-2013-2004: libX11 1.5.99.901 (1.6 RC1) and earlier
  + [236b603d235dc264d1c6250dca09c745458a9088 Unbounded recursion in GetDatabase() when parsing include files (CVE-2013-2004 1/2)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/236b603d235dc264d1c6250dca09c745458a9088)
  + [226622349a4b1e16064649d4444a34fb4be4f464 Unbounded recursion in \_XimParseStringFile() when parsing include files (CVE-2013-2004 2/2)](https://gitlab.freedesktop.org/xorg/lib/libx11/-/commit/226622349a4b1e16064649d4444a34fb4be4f464)
* CVE-2013-2005: libXt 1.1.3 and earlier
  + [eae57493feec958bcf733ad0d334715107029f8b Unchecked return values of XGetWindowProperty (CVE-2013-2005)](https://gitlab.freedesktop.org/xorg/lib/libxt/-/commit/eae57493feec958bcf733ad0d334715107029f8b)

Fixes are also included in these module releases from X.Org:

* [libX11 1.5.99.902 (1.6 RC2)](http://lists.x.org/archives/xorg-announce/2013-May/002221.html)
* [libXcursor 1.1.14](http://lists.x.org/archives/xorg-announce/2013-May/002229.html)
* [libXext 1.3.2](http://lists.x.org/archives/xorg-announce/2013-May/002240.html)
* [libXfixes 5.0.1](http://lists.x.org/archives/xorg-announce/2013-May/002227.html)
* [libXi 1.6.2.901 (1.6.3 RC1)](http://lists.x.org/archives/xorg-announce/2013-May/002222.html)
* [libXinerama 1.1.3](http://lists.x.org/archives/xorg-announce/2013-May/002231.html)
* [libXp 1.0.2](http://lists.x.org/archives/xorg-announce/2013-May/002232.html)
* [libXrandr 1.4.1](http://lists.x.org/archives/xorg-announce/2013-May/002241.html)
* [libXrender 0.9.8](http://lists.x.org/archives/xorg-announce/2013-June/002249.html)
* [libXRes 1.0.7](http://lists.x.org/archives/xorg-announce/2013-May/002233.html)
* [libXtst 1.2.2](http://lists.x.org/archives/xorg-announce/2013-May/002237.html)
* [libXv 1.0.8](http://lists.x.org/archives/xorg-announce/2013-May/002242.html)
* [libXvMC 1.0.8](http://lists.x.org/archives/xorg-announce/2013-June/002250.html)
* [libXxf86dga 1.1.4](http://lists.x.org/archives/xorg-announce/2013-May/002235.html)
* [libXxf86vm 1.1.3](http://lists.x.org/archives/xorg-announce/2013-May/002236.html)
* [libdmx 1.1.3](http://lists.x.org/archives/xorg-announce/2013-May/002225.html)
* [libxcb 1.9.1](http://lists.x.org/archives/xorg-announce/2013-May/002230.html)
* [libFS 1.0.5](http://lists.x.org/archives/xorg-announce/2013-May/002226.html)
* [libXt 1.1.4](http://lists.x.org/archives/xorg-announce/2013-May/002234.html)

or releases from our sister projects:

* [xf86-video-openchrome 0.3.3](http://lists.x.org/archives/xorg/2013-May/055718.html) - [OpenChrome project](http://www.openchrome.org/)
* Mesa TBD [Mesa3D project](http://www.mesa3d.org/)

### Thanks

X.Org thanks Ilja van Sprundel of IOActive for reporting these issues to our security team and assisting them in understanding them and evaluating our fixes, and [Alan Coopersmith](../../../AlanCoopersmith/) of Oracle for coordinating the X.Org response and developing the fixes for these issues.

Links:
[News](../../../News/)
[Security](../)

Last edited Mon Sep 30 02:11:54 2024



=== Content from www.ubuntu.com_0a154820_20250125_140836.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-1854-1: libx11 vulnerabilities

5 June 2013

Several security issues were fixed in libx11.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 13.04](/security/notices?release=raring)
* [Ubuntu 12.10](/security/notices?release=quantal)
* [Ubuntu 12.04](/security/notices?release=precise)
* [Ubuntu 10.04](/security/notices?release=lucid)

## Packages

* [libx11](/security/cves?package=libx11) - X11 client-side library

## Details

Ilja van Sprundel discovered multiple security issues in various X.org

libraries and components. An attacker could use these issues to cause

applications to crash, resulting in a denial of service, or possibly

execute arbitrary code.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 13.04

* [libx11-6](https://launchpad.net/ubuntu/%2Bsource/libx11)
  -
  [2:1.5.0-1ubuntu1.1](https://launchpad.net/ubuntu/%2Bsource/libx11/2%3A1.5.0-1ubuntu1.1)

##### Ubuntu 12.10

* [libx11-6](https://launchpad.net/ubuntu/%2Bsource/libx11)
  -
  [2:1.5.0-1ubuntu0.1](https://launchpad.net/ubuntu/%2Bsource/libx11/2%3A1.5.0-1ubuntu0.1)

##### Ubuntu 12.04

* [libx11-6](https://launchpad.net/ubuntu/%2Bsource/libx11)
  -
  [2:1.4.99.1-0ubuntu2.1](https://launchpad.net/ubuntu/%2Bsource/libx11/2%3A1.4.99.1-0ubuntu2.1)

##### Ubuntu 10.04

* [libx11-6](https://launchpad.net/ubuntu/%2Bsource/libx11)
  -
  [2:1.3.2-1ubuntu3.1](https://launchpad.net/ubuntu/%2Bsource/libx11/2%3A1.3.2-1ubuntu3.1)

After a standard system update you need to restart your session to make all

the necessary changes.

## References

* [CVE-2013-1981](/security/CVE-2013-1981)
* [CVE-2013-1997](/security/CVE-2013-1997)
* [CVE-2013-2004](/security/CVE-2013-2004)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from gitlab.freedesktop.org_7df045ad_20250126_091558.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

**Commit
00626c38**

authored
Mar 02, 2013
by
**[![Alan Coopersmith's avatar](/uploads/-/system/user/avatar/29/avatar.png?width=48 "Alan Coopersmith")](/alanc)
[Alan Coopersmith](/alanc)**

[Browse files](/xorg/lib/libx11/-/tree/00626c3830b869259098985afa38933d77ccec72)

### unvalidated index in \_XkbReadKeyActions() [CVE-2013-1997 6/15]

```

If the X server returns key action indexes outside the range of the number
of keys it told us to allocate, out of bounds memory access could occur.

Reported-by: ![default avatar](https://secure.gravatar.com/avatar/71f8d774cf66f37ef8d0817d482fa33569e9145ffa7a67ab10b143407ad8ed70?s=32&d=identicon)Ilja Van Sprundel <ivansprundel@ioactive.com>
Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/72a512422f19eeddf740cc354097e6a5acc2126988b8c743240b4f5e6c36f54f?s=32&d=identicon)Alan Coopersmith <alan.coopersmith@oracle.com>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/b0eb9f4d841c85eee40747be3b53a1df910abf7f98c1c97f15bbc4e7c7ea1c44?s=32&d=identicon)Matthieu Herrb <matthieu.herrb@laas.fr>
```

parent
[fd7d4956](/xorg/lib/libx11/-/commit/fd7d4956bc7a1c4b5c38661b12777ebee4d685d9)

Loading

Loading

Loading

* [Changes
  1](/xorg/lib/libx11/-/commit/00626c3830b869259098985afa38933d77ccec72)

[Hide whitespace changes](/xorg/lib/libx11/-/commit/00626c3830b869259098985afa38933d77ccec72?action=show&controller=projects%2Fcommit&id=00626c3830b869259098985afa38933d77ccec72&namespace_id=xorg%2Flib&project_id=libx11&w=1)
[Inline](/xorg/lib/libx11/-/commit/00626c3830b869259098985afa38933d77ccec72?view=inline)
[Side-by-side](/xorg/lib/libx11/-/commit/00626c3830b869259098985afa38933d77ccec72?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from gitlab.freedesktop.org_dbc6be3c_20250126_091603.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

**Commit
b9ba8324**

authored
Mar 02, 2013
by
**[![Alan Coopersmith's avatar](/uploads/-/system/user/avatar/29/avatar.png?width=48 "Alan Coopersmith")](/alanc)
[Alan Coopersmith](/alanc)**

[Browse files](/xorg/lib/libx11/-/tree/b9ba832401734e1cbd30a930c0d11d850293f3f9)

### unvalidated length in \_XimXGetReadData() [CVE-2013-1997 12/15]

```

Check the provided buffer size against the amount of data we're going to
write into it, not against the reported length from the ClientMessage.

Reported-by: ![default avatar](https://secure.gravatar.com/avatar/71f8d774cf66f37ef8d0817d482fa33569e9145ffa7a67ab10b143407ad8ed70?s=32&d=identicon)Ilja Van Sprundel <ivansprundel@ioactive.com>
Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/72a512422f19eeddf740cc354097e6a5acc2126988b8c743240b4f5e6c36f54f?s=32&d=identicon)Alan Coopersmith <alan.coopersmith@oracle.com>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/b0eb9f4d841c85eee40747be3b53a1df910abf7f98c1c97f15bbc4e7c7ea1c44?s=32&d=identicon)Matthieu Herrb <matthieu.herrb@laas.fr>
```

parent
[de2e6c32](/xorg/lib/libx11/-/commit/de2e6c322c4aca22856b380f67f8e488e7510015)

Loading

Loading

Loading

* [Changes
  1](/xorg/lib/libx11/-/commit/b9ba832401734e1cbd30a930c0d11d850293f3f9)

[Hide whitespace changes](/xorg/lib/libx11/-/commit/b9ba832401734e1cbd30a930c0d11d850293f3f9?action=show&controller=projects%2Fcommit&id=b9ba832401734e1cbd30a930c0d11d850293f3f9&namespace_id=xorg%2Flib&project_id=libx11&w=1)
[Inline](/xorg/lib/libx11/-/commit/b9ba832401734e1cbd30a930c0d11d850293f3f9?view=inline)
[Side-by-side](/xorg/lib/libx11/-/commit/b9ba832401734e1cbd30a930c0d11d850293f3f9?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from gitlab.freedesktop.org_b3b88cd7_20250126_091607.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

**Commit
fd7d4956**

authored
Mar 02, 2013
by
**[![Alan Coopersmith's avatar](/uploads/-/system/user/avatar/29/avatar.png?width=48 "Alan Coopersmith")](/alanc)
[Alan Coopersmith](/alanc)**

[Browse files](/xorg/lib/libx11/-/tree/fd7d4956bc7a1c4b5c38661b12777ebee4d685d9)

### unvalidated index in \_XkbReadKeySyms() [CVE-2013-1997 5/15]

```

If the X server returns keymap indexes outside the range of the number of
keys it told us to allocate, out of bounds memory access could occur.

Reported-by: ![default avatar](https://secure.gravatar.com/avatar/71f8d774cf66f37ef8d0817d482fa33569e9145ffa7a67ab10b143407ad8ed70?s=32&d=identicon)Ilja Van Sprundel <ivansprundel@ioactive.com>
Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/72a512422f19eeddf740cc354097e6a5acc2126988b8c743240b4f5e6c36f54f?s=32&d=identicon)Alan Coopersmith <alan.coopersmith@oracle.com>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/b0eb9f4d841c85eee40747be3b53a1df910abf7f98c1c97f15bbc4e7c7ea1c44?s=32&d=identicon)Matthieu Herrb <matthieu.herrb@laas.fr>
```

parent
[59ae16a0](/xorg/lib/libx11/-/commit/59ae16a00d18588e98af57d26e442af8ea42b7aa)

Loading

Loading

Loading

* [Changes
  1](/xorg/lib/libx11/-/commit/fd7d4956bc7a1c4b5c38661b12777ebee4d685d9)

[Hide whitespace changes](/xorg/lib/libx11/-/commit/fd7d4956bc7a1c4b5c38661b12777ebee4d685d9?action=show&controller=projects%2Fcommit&id=fd7d4956bc7a1c4b5c38661b12777ebee4d685d9&namespace_id=xorg%2Flib&project_id=libx11&w=1)
[Inline](/xorg/lib/libx11/-/commit/fd7d4956bc7a1c4b5c38661b12777ebee4d685d9?view=inline)
[Side-by-side](/xorg/lib/libx11/-/commit/fd7d4956bc7a1c4b5c38661b12777ebee4d685d9?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from www.openwall.com_c4174f25_20250125_140834.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <519E3180.8000804@oracle.com>
Date: Thu, 23 May 2013 08:10:56 -0700
From: Alan Coopersmith <alan.coopersmith@...cle.com>
To: oss-security@...ts.openwall.com
CC: Ilja Van Sprundel <ivansprundel@...ctive.com>
Subject: Fwd: [ANNOUNCE] X.Org Security Advisory: Protocol handling issues
 in X Window System client libraries

-------- Original Message --------
Subject: [ANNOUNCE] X.Org Security Advisory: Protocol handling issues in X
Window System client libraries
Date: Thu, 23 May 2013 08:05:22 -0700
From: Alan Coopersmith <alan.coopersmith@...cle.com>
To: xorg-announce@...ts.x.org
CC: xorg@...ts.x.org, xorg-devel@...ts.x.org

X.Org Security Advisory:  May 23, 2013
Protocol handling issues in X Window System client libraries
============================================================

Description:
============

Ilja van Sprundel, a security researcher with IOActive, has discovered
a large number of issues in the way various X client libraries handle
the responses they receive from servers, and has worked with X.Org's
security team to analyze, confirm, and fix these issues.

Most of these issues stem from the client libraries trusting the server
to send correct protocol data, and not verifying that the values will
not overflow or cause other damage.   Most of the time X clients & servers
are run by the same user, with the server more privileged from the clients,
so this is not a problem, but there are scenarios in which a privileged
client can be connected to an unprivileged server, for instance, connecting
a setuid X client (such as a screen lock program) to a virtual X server
(such as Xvfb or Xephyr) which the user has modified to return invalid
data, potentially allowing the user to escalate their privileges.

The X.Org security team would like to take this opportunity to remind
X client authors that current best practices suggest separating code
that requires privileges from the GUI, to reduce the attack surface of
issues like this.

The vulnerabilities include:

- integer overflows calculating memory needs for replies

     These calls do not check that their calculations for how much memory
     is needed to handle the returned data have not overflowed, so can
     result in allocating too little memory and then writing the returned
     data past the end of the allocated buffer.

     * CVE-2013-1981: libX11 1.5.99.901 (1.6 RC1) and earlier
       Affected functions:  XQueryFont(), _XF86BigfontQueryFont(),
           XListFontsWithInfo(), XGetMotionEvents(), XListHosts(),
           XGetModifierMapping(), XGetPointerMapping(), XGetKeyboardMapping(),
           XGetWindowProperty(), XGetImage()

     * CVE-2013-1982: libXext 1.3.1 and earlier
       Affected functions:  XcupGetReservedColormapEntries(),
           XcupStoreColors(), XdbeGetVisualInfo(), XeviGetVisualInfo(),
           XShapeGetRectangles(), XSyncListSystemCounters()

     * CVE-2013-1983: libXfixes 5.0 and earlier
       Affected functions:  XFixesGetCursorImage()

     * CVE-2013-1984: libXi 1.7.1 and earlier
       Affected functions:  XGetDeviceControl(), XGetFeedbackControl(),
           XGetDeviceDontPropagateList(), XGetDeviceMotionEvents(),
           XIGetProperty(), XIGetSelectedEvents(), XGetDeviceProperties(),
           XListInputDevices()

     * CVE-2013-1985: libXinerama 1.1.2 and earlier
       Affected functions:  XineramaQueryScreens()

     * CVE-2013-2062: libXp 1.0.1 and earlier
       Affected functions:  XpGetAttributes(), XpGetOneAttribute(),
           XpGetPrinterList(), XpQueryScreens()

     * CVE-2013-1986: libXrandr 1.4.0 and earlier
       Affected functions:  XRRQueryOutputProperty(), XRRQueryProviderProperty()
          [XRRQueryProviderProperty() was introduced in libXrandr 1.4.0 and is
           not found in 1.3.2 and older releases.]

     * CVE-2013-1987: libXrender 0.9.7 and earlier
       Affected functions:  XRenderQueryFilters(), XRenderQueryFormats(),
           XRenderQueryPictIndexValues()

     * CVE-2013-1988: libXRes 1.0.6 and earlier
       Affected functions:  XResQueryClients(), XResQueryClientResources()

     * CVE-2013-2063: libXtst 1.2.1 and earlier
       Affected functions:  XRecordGetContext()

     * CVE-2013-1989: libXv 1.0.7 and earlier
       Affected functions:  XvQueryPortAttributes(), XvListImageFormats(),
           XvCreateImage()

     * CVE-2013-1990: libXvMC 1.0.7 and earlier
       Affected functions:  XvMCListSurfaceTypes(), XvMCListSubpictureTypes()

     * CVE-2013-1991: libXxf86dga 1.1.3 and earlier
       Affected functions:  XDGAQueryModes(), XDGASetMode()

     * CVE-2013-1992: libdmx 1.1.2 and earlier
       Affected functions:  DMXGetScreenAttributes(), DMXGetWindowAttributes(),
           DMXGetInputAttributes()

     * CVE-2013-2064: libxcb 1.9 and earlier
       Affected functions:  read_packet()

     * CVE-2013-1993: libGLX in Mesa 9.1.1 and earlier
       Affected functions:  XF86DRIOpenConnection(), XF86DRIGetClientDriverName()

     * CVE-2013-1994: libchromeXvMC & libchromeXvMCPro in openChrome 0.3.2
       and earlier
       Affected functions:  uniDRIOpenConnection(), uniDRIGetClientDriverName()

- sign extension issues calculating memory needs for replies

     These calls do not check that their calculations for how much memory
     is needed to handle the returned data have not had sign extension
     issues when converting smaller integer types to larger ones, leading
     to negative numbers being used in memory size calculations that can
     result in allocating too little memory and then writing the returned
     data past the end of the allocated buffer.

     * CVE-2013-1995: libXi 1.7.1 and earlier
       Affected functions:  XListInputDevices()

     * CVE-2013-1996: libFS 1.0.4 and earlier
       Affected functions:  FSOpenServer()

- buffer overflows due to not validating length or offset values in replies

     These calls do not check that the lengths and/or indexes returned by the
     server are within the bounds specified by the caller or the bounds of the
     memory allocated by the function, so could write past the bounds of
     allocated memory when storing the returned data.

     * CVE-2013-1997: libX11 1.5.99.901 (1.6 RC1) and earlier
       Affected functions:  XAllocColorCells(), _XkbReadGetDeviceInfoReply(),
           _XkbReadGeomShapes(), _XkbReadGetGeometryReply(), _XkbReadKeySyms(),
           _XkbReadKeyActions(), _XkbReadKeyBehaviors(), _XkbReadModifierMap(),
           _XkbReadExplicitComponents(), _XkbReadVirtualModMap(),
           _XkbReadGetNamesReply(), _XkbReadGetMapReply(), _XimXGetReadData(),
           XListFonts(), XListExtensions(), XGetFontPath()

     * CVE-2013-1998: libXi 1.7.1 and earlier
       Affected functions:  XGetDeviceButtonMapping(), _XIPassiveGrabDevice(),
           XQueryDeviceState()

     * CVE-2013-2066: libXv 1.0.7 and earlier
       Affected functions:  XvQueryPortAttributes()

     * CVE-2013-1999: libXvMC 1.0.7 and earlier
       Affected functions:  XvMCGetDRInfo()

     * CVE-2013-2000: libXxf86dga 1.1.3 and earlier
       Affected functions:  XDGAQueryModes(), XDGASetMode()

     * CVE-2013-2001: libXxf86vm 1.1.2 and earlier
       Affected functions:  XF86VidModeGetGammaRamp()

     * CVE-2013-2002: libXt 1.1.3 and earlier
       Affected functions:  _XtResourceConfigurationEH()

- integer overflows parsing user-specified files

     These calls do not check that their calculations for how much memory
     is needed to handle the data being read have not overflowed, so can
     result in allocating too little memory and then writing the returned
     data past the end of the allocated buffer.

     * CVE-2013-1981: libX11 1.5.99.901 (1.6 RC1) and earlier
       Affected functions:  LoadColornameDB(), XrmGetFileDatabase(),
           _XimParseStringFile(), TransFileName()

     * CVE-2013-2003: libXcursor 1.1.13 and earlier
       Affected functions:  _XcursorFileHeaderCreate()

- unbounded recursion parsing user-specified files

     These calls read in files and handle C-style '#include' directives
     to include other files, and have no limit for how many levels deep
     they will go, including allowing files to #include themselves, until
     the stack overflows from the recursive function calling patterns.

     * CVE-2013-2004: libX11 1.5.99.901 (1.6 RC1) and earlier
       Affected functions:  GetDatabase(), _XimParseStringFile()

- memory corruption due to unchecked return values

     These calls assume that pointers are properly initialized by the
     XGetWindowProperty() function and don't check for failure of the
     function to return a valid window property, which can lead to
     use of uninitialized pointers for reading, writing, or passing to
     functions such as free().   XGetWindowProperty() in libX11 1.5.99.901
     (1.6RC1) and earlier did not ensure returned pointers were initialized
     to NULL when returning a failure (this is fixed in libX11 1.5.99.902
     and later).

     * CVE-2013-2005: libXt 1.1.3 and earlier
       Affected functions:  ReqCleanup(), HandleSelectionEvents(),
           ReqTimedOut(), HandleNormal(), HandleSelectionReplies()

Affected Versions
=================

X.Org believes all prior versions of these libraries contain these
flaws, dating back to their introduction.

Versions of the X libraries built on top of the Xlib bridge to the XCB
framework are vulnerable to fewer issues than those without, due to the
added safety and consistency assertions in the XCB calls to read data
from the network, but most of these vulnerabilities are not caught by
those checks.

Fixes
=====

Fixes are available in git commits and patches which will be listed
on <http://www.x.org/wiki/Development/Security/Advisory-2013-05-23>
when this advisory is released.

Fixes will also be included in these module releases from X.Org:

     libX11 1.5.99.902 (1.6 RC2)
     libXcursor 1.1.14
     libXext 1.3.2
     libXfixes 5.0.1
     libXi 1.7.2
     libXinerama 1.1.3
     libXp 1.0.2
     libXrandr 1.4.1
     libXrender 0.9.8
     libXRes 1.0.7
     libXv 1.0.8
     libXvMC 1.0.8
     libXxf86dga 1.1.4
     libXxf86vm 1.1.3
     libdmx 1.1.3
     libxcb 1.9.1
     libFS 1.0.5
     libXt 1.1.4

or releases to be determined from our sister projects:
     xf86-video-openchrome    OpenChrome project - <http://www.openchrome.org/>
     Mesa                     Mesa3D project - <http://www.mesa3d.org/>

Thanks
======

X.Org thanks Ilja van Sprundel of IOActive for reporting these issues to our
security team and assisting them in understanding them and evaluating our
fixes, and Alan Coopersmith of Oracle for coordinating the X.Org response and
developing the fixes for these issues.

--
	-Alan Coopersmith-              alan.coopersmith@...cle.com
	  X.Org Security Response Team - xorg-security@...ts.x.org

Download attachment "[Attached Message Part](3/1)" of type "application/pgp-signature" (833 bytes)

View attachment "[Attached Message Part](3/2)" of type "text/plain" (235 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from gitlab.freedesktop.org_0ade946b_20250126_091556.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

**Commit
bff938b9**

authored
Mar 02, 2013
by
**[![Alan Coopersmith's avatar](/uploads/-/system/user/avatar/29/avatar.png?width=48 "Alan Coopersmith")](/alanc)
[Alan Coopersmith](/alanc)**

[Browse files](/xorg/lib/libx11/-/tree/bff938b9fe1629cbacb726509edfa2a3840b7207)

### unvalidated indexes in \_XkbReadGeomShapes() [CVE-2013-1997 3/15]

```

If the X server returns shape indexes outside the range of the number
of shapes it told us to allocate, out of bounds memory access could occur.

Reported-by: ![default avatar](https://secure.gravatar.com/avatar/71f8d774cf66f37ef8d0817d482fa33569e9145ffa7a67ab10b143407ad8ed70?s=32&d=identicon)Ilja Van Sprundel <ivansprundel@ioactive.com>
Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/72a512422f19eeddf740cc354097e6a5acc2126988b8c743240b4f5e6c36f54f?s=32&d=identicon)Alan Coopersmith <alan.coopersmith@oracle.com>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/b0eb9f4d841c85eee40747be3b53a1df910abf7f98c1c97f15bbc4e7c7ea1c44?s=32&d=identicon)Matthieu Herrb <matthieu.herrb@laas.fr>
```

parent
[f293659d](/xorg/lib/libx11/-/commit/f293659d5a4024bda386305bb7ebeb4647c40934)

Loading

Loading

Loading

* [Changes
  1](/xorg/lib/libx11/-/commit/bff938b9fe1629cbacb726509edfa2a3840b7207)

[Hide whitespace changes](/xorg/lib/libx11/-/commit/bff938b9fe1629cbacb726509edfa2a3840b7207?action=show&controller=projects%2Fcommit&id=bff938b9fe1629cbacb726509edfa2a3840b7207&namespace_id=xorg%2Flib&project_id=libx11&w=1)
[Inline](/xorg/lib/libx11/-/commit/bff938b9fe1629cbacb726509edfa2a3840b7207?view=inline)
[Side-by-side](/xorg/lib/libx11/-/commit/bff938b9fe1629cbacb726509edfa2a3840b7207?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from gitlab.freedesktop.org_93aee4ea_20250126_091557.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

**Commit
db1b1c87**

authored
Mar 02, 2013
by
**[![Alan Coopersmith's avatar](/uploads/-/system/user/avatar/29/avatar.png?width=48 "Alan Coopersmith")](/alanc)
[Alan Coopersmith](/alanc)**

[Browse files](/xorg/lib/libx11/-/tree/db1b1c871da29aa0545182bf888df81627f165a5)

### Avoid overflows in XListExtensions() [CVE-2013-1997 15/15]

```

Ensure that when breaking the returned list into individual strings,
we don't walk past the end of allocated memory to write the '\0' bytes

Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/72a512422f19eeddf740cc354097e6a5acc2126988b8c743240b4f5e6c36f54f?s=32&d=identicon)Alan Coopersmith <alan.coopersmith@oracle.com>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/b0eb9f4d841c85eee40747be3b53a1df910abf7f98c1c97f15bbc4e7c7ea1c44?s=32&d=identicon)Matthieu Herrb <matthieu.herrb@laas.fr>
```

parent
[8d593659](/xorg/lib/libx11/-/commit/8d5936594993921acdfec778dd8f41b555e2543a)

Loading

Loading

Loading

* [Changes
  1](/xorg/lib/libx11/-/commit/db1b1c871da29aa0545182bf888df81627f165a5)

[Hide whitespace changes](/xorg/lib/libx11/-/commit/db1b1c871da29aa0545182bf888df81627f165a5?action=show&controller=projects%2Fcommit&id=db1b1c871da29aa0545182bf888df81627f165a5&namespace_id=xorg%2Flib&project_id=libx11&w=1)
[Inline](/xorg/lib/libx11/-/commit/db1b1c871da29aa0545182bf888df81627f165a5?view=inline)
[Side-by-side](/xorg/lib/libx11/-/commit/db1b1c871da29aa0545182bf888df81627f165a5?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from gitlab.freedesktop.org_d933b281_20250126_091604.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

**Commit
0c404db6**

authored
Mar 02, 2013
by
**[![Alan Coopersmith's avatar](/uploads/-/system/user/avatar/29/avatar.png?width=48 "Alan Coopersmith")](/alanc)
[Alan Coopersmith](/alanc)**

[Browse files](/xorg/lib/libx11/-/tree/0c404db6a92dc2c198328bf586c02d8abbe02013)

### Avoid overflows in XListFonts() [CVE-2013-1997 13/15]

```

Ensure that when breaking the returned list into individual strings,
we don't walk past the end of allocated memory to write the '\0' bytes

Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/72a512422f19eeddf740cc354097e6a5acc2126988b8c743240b4f5e6c36f54f?s=32&d=identicon)Alan Coopersmith <alan.coopersmith@oracle.com>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/b0eb9f4d841c85eee40747be3b53a1df910abf7f98c1c97f15bbc4e7c7ea1c44?s=32&d=identicon)Matthieu Herrb <matthieu.herrb@laas.fr>
```

parent
[0b0f5d43](/xorg/lib/libx11/-/commit/0b0f5d4358c3de7563d6af03f0d2ce454702a06a)

Loading

Loading

Loading

* [Changes
  1](/xorg/lib/libx11/-/commit/0c404db6a92dc2c198328bf586c02d8abbe02013)

[Hide whitespace changes](/xorg/lib/libx11/-/commit/0c404db6a92dc2c198328bf586c02d8abbe02013?action=show&controller=projects%2Fcommit&id=0c404db6a92dc2c198328bf586c02d8abbe02013&namespace_id=xorg%2Flib&project_id=libx11&w=1)
[Inline](/xorg/lib/libx11/-/commit/0c404db6a92dc2c198328bf586c02d8abbe02013?view=inline)
[Side-by-side](/xorg/lib/libx11/-/commit/0c404db6a92dc2c198328bf586c02d8abbe02013?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from lists.ubuntu.com_be8ed54b_20250126_091608.html ===


| **ubuntu-hardened -- Ubuntu security discussion** | |
| --- | --- |
|  | |
| **About ubuntu-hardened** | English (USA)   Chinese (Taiwan) |
| Discussion on Ubuntu security updates, development of new security technologies, and general "hardening" of the operating system.  A place to talk about MAC systems (SELinux, AppArmor, Smack) in Ubuntu, about both kernel-level and user-land security improvements and technologies, etc.  To see the collection of prior postings to the list, visit the [ubuntu-hardened Archives](https://lists.ubuntu.com/archives/ubuntu-hardened). | |
| **Using ubuntu-hardened** | |
| To post a message to all the list members, send email to ubuntu-hardened@lists.ubuntu.com. You can subscribe to the list, or change your existing subscription, in the sections below. | |
| **Subscribing to ubuntu-hardened** | |
| Subscribe to ubuntu-hardened by filling out the following form. You will be sent email requesting confirmation, to prevent others from gratuitously subscribing you. This is a hidden list, which means that the list of members is available only to the list administrator.    | Your email address: |  |  | | --- | --- | --- | | Your name (optional): |  |  | | You may enter a privacy password below. This provides only mild security, but should prevent others from messing with your subscription. **Do not use a valuable password** as it will occasionally be emailed back to you in cleartext. If you choose not to enter a password, one will be automatically generated for you, and it will be sent to you once you've confirmed your subscription. You can always request a mail-back of your password when you edit your personal options. | | | | Pick a password: |  |  | | Reenter password to confirm: |  |  | | Which language do you prefer to display your messages? | English (USA)   Chinese (Taiwan) |  | | Would you like to receive list mail batched in a daily digest? | No  Yes | |  | | | | |

| **ubuntu-hardened Subscribers** | |
| (*The subscribers list is only available to the list administrator.*) Enter your admin address and password to visit the subscribers list: Admin address: Password:  To unsubscribe from ubuntu-hardened, get a password reminder, or change your subscription options enter your subscription email address: If you leave the field blank, you will be prompted for your email address | |

---

[ubuntu-hardened](../listinfo/ubuntu-hardened) list run by jamie at ubuntu.com, mdeslaur at ubuntu.com, sbeattie at ubuntu.com, alex.murray at canonical.com
[ubuntu-hardened administrative interface](../admin/ubuntu-hardened) (requires authorization)
[Overview of all lists.ubuntu.com mailing lists](../listinfo)

| [Delivered by Mailmanversion 2.1.20](http://www.gnu.org/software/mailman/index.html) | [Python Powered](http://www.python.org/) | [GNU's Not Unix](http://www.gnu.org/) | [Debian Powered](http://www.debian.org/) |
| --- | --- | --- | --- |

[![](http://tuxedo-es.org/images/hardened_debian.png)](http://www.debian-hardened.org)



=== Content from gitlab.freedesktop.org_5ead9242_20250126_091605.html ===


## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

You need to sign in or sign up before continuing.

# freedesktop.org GitLab login

freedesktop.org is a community of open-source projects dedicated to advancing the open-source desktop ecosystem. If you would like to contribute code, bug reports, or ideas to our existing member projects, you can register or log in here and contribute to these projects.

**When creating a new account, you will be sent an email to confirm and validate your account. Please check your inbox (including spam) to ensure that you receive this message and follow the link to confirm your account. Once this is done, you will be able to report issues in existing projects. To fork projects, you will need to [request permissions](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home#how-can-i-contribute-to-an-existing-project-or-create-a-new-one)**

**When creating a new account, you will be sent an email to confirm and validate your account. Please check your inbox (including spam) to ensure that you receive this message and follow the link to confirm your account. Once this is done, your account will become active within 10-15 minutes.**

Please conduct yourself in a polite and respectful way when using these services, per our [Code of Conduct](https://www.freedesktop.org/wiki/CodeOfConduct). The information we collect and how we use it is also described in our [Privacy Policy](https://www.freedesktop.org/wiki/PrivacyPolicy).

![freedesktop.org GitLab login](data:image/gif;base64...)

Username or primary email

Password

[Forgot your password?](/users/password/new)

Remember me

Sign in

By signing in you accept the [Terms of Use and acknowledge the Privacy Statement and Cookie Policy](/-/users/terms).

Don't have an account yet?
[Register now](/users/sign_up)

---

or sign in with

---

![Google](data:image/gif;base64... "Sign in with Google")
Google

![GitHub](data:image/gif;base64... "Sign in with GitHub")
GitHub

![GitLab](data:image/gif;base64... "Sign in with GitLab")
GitLab

Remember me

---

[Explore](/explore)
[Help](/help)
[About GitLab](https://about.gitlab.com)
[Community forum](https://forum.gitlab.com)



=== Content from gitlab.freedesktop.org_4908d8fb_20250126_091553.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

**Commit
cddc4e7e**

authored
Mar 01, 2013
by
**[![Alan Coopersmith's avatar](/uploads/-/system/user/avatar/29/avatar.png?width=48 "Alan Coopersmith")](/alanc)
[Alan Coopersmith](/alanc)**

[Browse files](/xorg/lib/libx11/-/tree/cddc4e7e3cb4b9b7ad25f8591971a86901c249f2)

### unvalidated lengths in XAllocColorCells() [CVE-2013-1997 1/15]

```

If a broken server returned larger than requested values for nPixels or
nMasks, XAllocColorCells would happily overflow the buffers provided by
the caller to write the results into.

Reported-by: ![default avatar](https://secure.gravatar.com/avatar/71f8d774cf66f37ef8d0817d482fa33569e9145ffa7a67ab10b143407ad8ed70?s=32&d=identicon)Ilja Van Sprundel <ivansprundel@ioactive.com>
Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/72a512422f19eeddf740cc354097e6a5acc2126988b8c743240b4f5e6c36f54f?s=32&d=identicon)Alan Coopersmith <alan.coopersmith@oracle.com>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/b0eb9f4d841c85eee40747be3b53a1df910abf7f98c1c97f15bbc4e7c7ea1c44?s=32&d=identicon)Matthieu Herrb <matthieu.herrb@laas.fr>
```

parent
[2cd62b5e](/xorg/lib/libx11/-/commit/2cd62b5eb99ffbb2fce99f3c459455e630b35bf7)

Loading

Loading

Loading

* [Changes
  1](/xorg/lib/libx11/-/commit/cddc4e7e3cb4b9b7ad25f8591971a86901c249f2)

[Hide whitespace changes](/xorg/lib/libx11/-/commit/cddc4e7e3cb4b9b7ad25f8591971a86901c249f2?action=show&controller=projects%2Fcommit&id=cddc4e7e3cb4b9b7ad25f8591971a86901c249f2&namespace_id=xorg%2Flib&project_id=libx11&w=1)
[Inline](/xorg/lib/libx11/-/commit/cddc4e7e3cb4b9b7ad25f8591971a86901c249f2?view=inline)
[Side-by-side](/xorg/lib/libx11/-/commit/cddc4e7e3cb4b9b7ad25f8591971a86901c249f2?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from gitlab.freedesktop.org_b1b6c4ae_20250126_091601.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

**Commit
8d593659**

authored
Mar 02, 2013
by
**[![Alan Coopersmith's avatar](/uploads/-/system/user/avatar/29/avatar.png?width=48 "Alan Coopersmith")](/alanc)
[Alan Coopersmith](/alanc)**

[Browse files](/xorg/lib/libx11/-/tree/8d5936594993921acdfec778dd8f41b555e2543a)

### Avoid overflows in XGetFontPath() [CVE-2013-1997 14/15]

```

Ensure that when breaking the returned list into individual strings,
we don't walk past the end of allocated memory to write the '\0' bytes

Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/72a512422f19eeddf740cc354097e6a5acc2126988b8c743240b4f5e6c36f54f?s=32&d=identicon)Alan Coopersmith <alan.coopersmith@oracle.com>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/b0eb9f4d841c85eee40747be3b53a1df910abf7f98c1c97f15bbc4e7c7ea1c44?s=32&d=identicon)Matthieu Herrb <matthieu.herrb@laas.fr>
```

parent
[0c404db6](/xorg/lib/libx11/-/commit/0c404db6a92dc2c198328bf586c02d8abbe02013)

Loading

Loading

Loading

* [Changes
  1](/xorg/lib/libx11/-/commit/8d5936594993921acdfec778dd8f41b555e2543a)

[Hide whitespace changes](/xorg/lib/libx11/-/commit/8d5936594993921acdfec778dd8f41b555e2543a?action=show&controller=projects%2Fcommit&id=8d5936594993921acdfec778dd8f41b555e2543a&namespace_id=xorg%2Flib&project_id=libx11&w=1)
[Inline](/xorg/lib/libx11/-/commit/8d5936594993921acdfec778dd8f41b555e2543a?view=inline)
[Side-by-side](/xorg/lib/libx11/-/commit/8d5936594993921acdfec778dd8f41b555e2543a?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from www.debian.org_5ab02a8f_20250125_140833.html ===


---

[[Date Prev](msg00101.html)][[Date Next](msg00103.html)]
[[Thread Prev](msg00101.html)][[Thread Next](msg00103.html)]
[[Date Index](maillist.html#00102)]
[[Thread Index](threads.html#00102)]

# [SECURITY] [DSA 2693-1] libx11 security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2693-1] libx11 security update
* *From*: Raphael Geissert <geissert@debian.org>
* *Date*: Fri, 24 May 2013 23:27:21 +0200
* *Message-id*: <[[🔎]](/msgid-search/201305242327.31256.geissert%40debian.org) [201305242327.31256.geissert@debian.org](msg00102.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2693-1                   security@debian.org
<http://www.debian.org/security/>                          Raphael Geissert
May 24, 2013                           <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : libx11
Vulnerability  : several
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-2013-1981 CVE-2013-1997 CVE-2013-2004

Ilja van Sprundel of IOActive discovered several security issues in
multiple components of the X.org graphics stack and the related
libraries: Various integer overflows, sign handling errors in integer
conversions, buffer overflows, memory corruption and missing input
sanitising may lead to privilege escalation or denial of service.

For the oldstable distribution (squeeze), these problems have been fixed in
version 2:1.3.3-4+squeeze1.

For the stable distribution (wheezy), these problems have been fixed in
version 2:1.5.0-1+deb7u1.

For the unstable distribution (sid), these problems have been fixed in
version 2:1.5.0-1+deb7u1.

We recommend that you upgrade your libx11 packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iEYEARECAAYFAlGf2z0ACgkQYy49rUbZzlp1dQCdG/eMBfNb/kk1yXdBL2K3vEHM
KUMAnj0F1zDyLUwwyNfIg9KN+uVjUDri
=uKma
-----END PGP SIGNATURE-----

```

---



=== Content from gitlab.freedesktop.org_fb0bdfd1_20250126_091554.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

**Commit
de2e6c32**

authored
Mar 02, 2013
by
**[![Alan Coopersmith's avatar](/uploads/-/system/user/avatar/29/avatar.png?width=48 "Alan Coopersmith")](/alanc)
[Alan Coopersmith](/alanc)**

[Browse files](/xorg/lib/libx11/-/tree/de2e6c322c4aca22856b380f67f8e488e7510015)

### unvalidated index/length in \_XkbReadGetNamesReply() [CVE-2013-1997 11/15]

```

If the X server returns key name indexes outside the range of the number
of keys it told us to allocate, out of bounds memory writes could occur.

Reported-by: ![default avatar](https://secure.gravatar.com/avatar/71f8d774cf66f37ef8d0817d482fa33569e9145ffa7a67ab10b143407ad8ed70?s=32&d=identicon)Ilja Van Sprundel <ivansprundel@ioactive.com>
Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/72a512422f19eeddf740cc354097e6a5acc2126988b8c743240b4f5e6c36f54f?s=32&d=identicon)Alan Coopersmith <alan.coopersmith@oracle.com>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/b0eb9f4d841c85eee40747be3b53a1df910abf7f98c1c97f15bbc4e7c7ea1c44?s=32&d=identicon)Matthieu Herrb <matthieu.herrb@laas.fr>
```

parent
[2df882ee](/xorg/lib/libx11/-/commit/2df882eeb3a70256170127a746a9ba26376599a1)

Loading

Loading

Loading

* [Changes
  1](/xorg/lib/libx11/-/commit/de2e6c322c4aca22856b380f67f8e488e7510015)

[Hide whitespace changes](/xorg/lib/libx11/-/commit/de2e6c322c4aca22856b380f67f8e488e7510015?action=show&controller=projects%2Fcommit&id=de2e6c322c4aca22856b380f67f8e488e7510015&namespace_id=xorg%2Flib&project_id=libx11&w=1)
[Inline](/xorg/lib/libx11/-/commit/de2e6c322c4aca22856b380f67f8e488e7510015?view=inline)
[Side-by-side](/xorg/lib/libx11/-/commit/de2e6c322c4aca22856b380f67f8e488e7510015?view=parallel)

Loading

* [Alan Coopersmith](/alanc)
  @alanc

  mentioned in issue [#140 (closed)](/xorg/lib/libx11/-/issues/140 "unvalidated index in _XkbReadGetNamesReply() in XKBNames.c")

  ·

  [Sep 18, 2021](#note_1065341)

  mentioned in issue [#140 (closed)](/xorg/lib/libx11/-/issues/140 "unvalidated index in _XkbReadGetNamesReply() in XKBNames.c")

  mentioned in issue #140

  Toggle commit list

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from gitlab.freedesktop.org_ca5aaa3d_20250126_091606.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

**Commit
59ae16a0**

authored
Mar 02, 2013
by
**[![Alan Coopersmith's avatar](/uploads/-/system/user/avatar/29/avatar.png?width=48 "Alan Coopersmith")](/alanc)
[Alan Coopersmith](/alanc)**

[Browse files](/xorg/lib/libx11/-/tree/59ae16a00d18588e98af57d26e442af8ea42b7aa)

### unvalidated indexes in \_XkbReadGetGeometryReply() [CVE-2013-1997 4/15]

```

If the X server returns color indexes outside the range of the number of
colors it told us to allocate, out of bounds memory access could occur.

Reported-by: ![default avatar](https://secure.gravatar.com/avatar/71f8d774cf66f37ef8d0817d482fa33569e9145ffa7a67ab10b143407ad8ed70?s=32&d=identicon)Ilja Van Sprundel <ivansprundel@ioactive.com>
Signed-off-by: ![default avatar](https://secure.gravatar.com/avatar/72a512422f19eeddf740cc354097e6a5acc2126988b8c743240b4f5e6c36f54f?s=32&d=identicon)Alan Coopersmith <alan.coopersmith@oracle.com>
Reviewed-by: ![default avatar](https://secure.gravatar.com/avatar/b0eb9f4d841c85eee40747be3b53a1df910abf7f98c1c97f15bbc4e7c7ea1c44?s=32&d=identicon)Matthieu Herrb <matthieu.herrb@laas.fr>
```

parent
[bff938b9](/xorg/lib/libx11/-/commit/bff938b9fe1629cbacb726509edfa2a3840b7207)

Loading

Loading

Loading

* [Changes
  1](/xorg/lib/libx11/-/commit/59ae16a00d18588e98af57d26e442af8ea42b7aa)

[Hide whitespace changes](/xorg/lib/libx11/-/commit/59ae16a00d18588e98af57d26e442af8ea42b7aa?action=show&controller=projects%2Fcommit&id=59ae16a00d18588e98af57d26e442af8ea42b7aa&namespace_id=xorg%2Flib&project_id=libx11&w=1)
[Inline](/xorg/lib/libx11/-/commit/59ae16a00d18588e98af57d26e442af8ea42b7aa?view=inline)
[Side-by-side](/xorg/lib/libx11/-/commit/59ae16a00d18588e98af57d26e442af8ea42b7aa?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment


