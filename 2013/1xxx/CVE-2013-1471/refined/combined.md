=== Content from www.vulnerability-lab.com_ca53a3f3_20250125_120015.html ===
Document Title:
===============
Fortinet FortiMail 400 IBE - Multiple Web Vulnerabilities
References (Source):
====================
http://www.vulnerability-lab.com/get\_content.php?id=701
www.fortiguard.com/advisory/FG-IR-013-001.html
Video: http://www.youtube.com/watch?v=5d7cIaM80oY
Release Date:
=============
2013-01-22
Vulnerability Laboratory ID (VL-ID):
====================================
701
Common Vulnerability Scoring System:
====================================
7.1
Product & Service Introduction:
===============================
The FortiMail family of appliances is a proven, powerful messaging security platform for any size organization,
from small businesses to carriers, service providers, and large enterprises. Purpose-built for the most demanding
messaging systems, the FortiMail appliances utilize Fortinet’s years of experience in protecting networks against
spam, malware, and other message-borne threats.
You can prevent your messaging system from becoming a threat delivery system with FortiMail. Its inbound filtering
engine blocks spam and malware before it can clog your network and affect users. Its outbound inspection technology prevents
outbound spam or malware (including 3G mobile traffic) from causing other antispam gateways to blacklist your users.
Three deployment modes offer maximum versatility while minimizing infrastructure changes or service disruptions:
transparent mode for seamless integration into existing networks with no changes to your existing mail server,
gateway mode as a proxy MTA for existing messaging gateways, or full messaging server functionality for remote locations.
FortiMail provides Identity-Based Encryption (IBE), in addition to S/MIME and TLS, as email encryption option to enforce
policy-based encryption for secure content delivery. Furthermore, the FortiMail customizable and predefined dictionaries
prevent accidental or intentional loss of confidential and regulated data.
(Copy of the Vendor Homepage: http://www.fortinet.com/products/fortimail/ )
Abstract Advisory Information:
==============================
The Vulnerability Laboratory Research Team discovered multiple web vulnerabilities in Fortinets FortiMail IBE 400Appliance Application.
Vulnerability Disclosure Timeline:
==================================
2012-09-16: Researcher Notification & Coordination
2012-09-18: Vendor Notification
2012-10-08: Vendor Response/Feedback
2012-12-12: Vendor Fix/Patch (PSIRT)
2013-01-23: Public Disclosure
Discovery Status:
=================
Published
Affected Product(s):
====================
Fortinet
Product: FortiMail Appliance Series 400 IBE
Exploitation Technique:
=======================
Remote
Severity Level:
===============
High
Technical Details & Description:
================================
An exception-handling and input filter bypass vulnerability is detected in the Fortinets FortiMail IBE Appliance Application 200D,400C, VM2K, 2000B and 5002B.
The first vulnerability is located in the parse module with the bound vulnerable exception-handling and vulnerable effect on all input fields.
The vulnerability allows an attacker to bypass the input parse routine by an implement of 2 close tags, which results in the
execution of the second injected script code with a space between.
The second vulnerability is located in the import/upload certificate module with the bound vulnerable certificate name and information parameters.
An attacker can implement own certificates with script code in the malicious name and information values. After the upload the persistent code get
executed out of the certificate listing main module.
Successful exploitation of the vulnerabilities allows to hijack admin/customer sessions, can lead to information disclosure or result in stable
manipulation of web context (persistent & non-persistent).
Vulnerable Module(s):
[+] Invalid - Exception Handling
Vulnerable Parameter(s):
[+] ipmask
[+] username
[+] address
[+] url
Proof of Concept (PoC):
=======================
1.1
The exception handling and filter bypass vulnerability can be exploited by remote attackers and local low privileged user account.
For demonstration or reproduce ...
Module: IPAddressMask - ext-mb-text, ext-gen4185 & ext-gen7196
INJECT: https://127.0.0.1:1338/admin/FEAdmin.html#SysInterfaceCollection
Error:IPAddressMask( 2 ) , IPAddressMask.cpp:14, "Invalid mask:"
><[PERSISTENT
INJECTED SCRIPT CODE!]") <"><[PERSISTENT INJECTED SCRIPT CODE!]")
AFFECTED: https://127.0.0.1:1338/admin/FEAdmin.html#SysInterfaceCollection
Module: Whitelist & Blacklist - Address
URL: https://209.87.230.132:1443/admin/FEAdmin.html#PersonalBlackWhiteList
Invalid address: "><[PERSISTENT INJECTED SCRIPT CODE!];)" <="" -=""
"=""><[PERSISTENT INJECTED SCRIPT CODE!]") <
AFFECTED: https://209.87.230.132:1443/admin/FEAdmin.html#SystemBlackWhiteList
Module: Bounce Verification - Username
URL: https://209.87.230.132:1443/admin/FEAdmin.html#AsBounceverifyKeyCollection
Invalid user name: ""><[PERSISTENT INJECTED SCRIPT CODE!]") <"
1.2
The persistent vulnerability can be exploited by remote attackers with privileged application account and
low required user inter action. For demonstration or reproduce ...
Module: Upload or Import - Local Certificate - Certificate name
URL: https://209.87.230.132:1443/admin/FEAdmin.html#SysCertificateDetailCollection

| [PERSISTENT INJECTED SCRIPT CODE AS CERTIFICATE NAME!] | /[PERSISTENT INJECTED SCRIPT CODE AS CERTIFICATE VIA INFORMATION!] | OK | 0 |
| --- | --- | --- | --- |

| [PERSISTENT INJECTED SCRIPT CODE AS CERTIFICATE NAME!] | [PERSISTENT INJECTED SCRIPT CODE AS CERTIFICATE VIA INFORMATION!] | Default | 1 |
| --- | --- | --- | --- |

Solution - Fix & Patch:
=======================
1.1
The exception-handling vulnerability can be fixed by parsing the full content without excluding after a close tag. Restrict the input fields to allowed chars.
1.2
The persistent vulnerability in the certificate import/upload module can be patched by parsing the certificate name and info input field.
Do not forget to parse also the vulnerable output listing of the certificate name and cert information.
Security Risk:
==============
The security risk of the of the exception-handling and input filter bypass vulnerability is estimated as high(-).
Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@vulnerability-lab.com)
Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties,
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation
may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases
or trade with fraud/stolen material.
Domains: www.vulnerability-lab.com - www.vuln-lab.com - www.vulnerability-lab.com/register
Contact: admin@vulnerability-lab.com - support@vulnerability-lab.com - research@vulnerability-lab.com
Section: video.vulnerability-lab.com - forum.vulnerability-lab.com - news.vulnerability-lab.com
Social: twitter.com/#!/vuln\_lab - facebook.com/VulnerabilityLab - youtube.com/user/vulnerability0lab
Feeds: vulnerability-lab.com/rss/rss.php - vulnerability-lab.com/rss/rss\_upcoming.php - vulnerability-lab.com/rss/rss\_news.php
Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory.
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed),
modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.
Copyright © 2012 | Vulnerability Laboratory

