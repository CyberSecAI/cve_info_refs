```
{
  "vulnerability": {
    "root_cause": "Puppet agents incorrectly handle certain kick connections in a non-default configuration.",
    "weaknesses": [
      "The puppet agent is configured to listen for incoming connections (e.g. listen = true).",
      "The agent's auth.conf allows access to the `run` REST endpoint."
    ],
    "impact": "An authenticated client can construct an HTTP PUT request to execute arbitrary code on the agent.",
    "attack_vectors": [
      "HTTP PUT request to the `run` REST endpoint."
    ],
    "required_capabilities": [
      "Authenticated client.",
      "Puppet agent configured to listen for incoming connections",
       "Agent's auth.conf allows access to the `run` REST endpoint"
    ],
    "additional_information": "This issue is made worse by the fact that puppet agents typically run as root."
  }
}
```