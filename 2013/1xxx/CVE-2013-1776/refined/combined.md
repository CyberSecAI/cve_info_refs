=== Content from bugzilla.novell.com_19ba3ac9_20250126_113214.html ===




=== Content from www.redhat.com_c452edc8_20250126_113200.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.debian.org_743f746b_20250125_195546.html ===


---

[[Date Prev](msg00045.html)][[Date Next](msg00047.html)]
[[Thread Prev](msg00045.html)][[Thread Next](msg00047.html)]
[[Date Index](maillist.html#00046)]
[[Thread Index](threads.html#00046)]

# [SECURITY] [DSA 2642-1] sudo security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2642-1] sudo security update
* *From*: Michael Gilbert <mgilbert@debian.org>
* *Date*: Sat, 9 Mar 2013 09:35:30 +0100 (CET)
* *Message-id*: <[[🔎]](/msgid-search/20130309083530.C2AAC598A9%40kinkhorst.com) [20130309083530.C2AAC598A9@kinkhorst.com](msg00046.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2642-1                   security@debian.org
<http://www.debian.org/security/>                           Michael Gilbert
March 09, 2013                         <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : sudo
Vulnerability  : several issues
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-2013-1775 CVE-2013-1776
Debian Bug     : 701838 701839

Several vulnerabilities have been discovered in sudo, a program designed
to allow a sysadmin to give limited root privileges to users. The Common
Vulnerabilities and Exposures project identifies the following problems:

CVE-2013-1775

    Marco Schoepl discovered an authentication bypass when the clock is
    set to the UNIX epoch [00:00:00 UTC on 1 January 1970].

CVE-2013-1776

    Ryan Castellucci and James Ogden discovered aspects of an issue that
    would allow session id hijacking from another authorized tty.

For the stable distribution (squeeze), these problems have been fixed in
version 1.7.4p4-2.squeeze.4.

For the testing (wheezy) and unstable (sid) distributions, these problems
have been fixed in version 1.8.5p2-1+nmu1.

We recommend that you upgrade your sudo packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQEcBAEBAgAGBQJROvQlAAoJEFb2GnlAHawEXIcH/0cASxNsRL3Y9on8brvEnpah
0B9qQ1NY9pzEQLzdQjQ/rJpzb/wK46Cx3aI6XpTxy9AbDNiQPgjxujbcQDtNNWQU
OYsQl0O77qhPs42v2TAGEnNoVtrsdiWNSIAwV4YOz3H/gc/Q8z3awpsvx8DjT+Q3
mO23mQ1ukHivwfPam5l4FegCGM4sZhZjetiRb9zjVKtpDvZpD1SEUfGU+sb/CZ8s
622vJ7zGBGF1tbeY2ff2JPG7t7QWXx4KDNLup9yA4CqZzUYZEX6k8j7ATS8VvZQk
XhSiWDldVYgeO/uZlO1jRSZLB0XCJLp9UEqNxBxwKyjPVl5kIORzC1hljpJKeHY=
=Czjn
-----END PGP SIGNATURE-----

```

---



=== Content from bugzilla.redhat.com_dba203f6_20250125_195608.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D916365)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D916365)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D916365)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 916365

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 916365**](show_bug.cgi?id=916365)
(CVE-2013-1776)
- [CVE-2013-1776](https://access.redhat.com/security/cve/CVE-2013-1776) sudo: bypass of tty\_tickets constraints

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2013-1776 sudo: bypass of tty\_tickets constraints

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2013-1776 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [916367](show_bug.cgi?id=916367 "CLOSED ERRATA - CVE-2013-1775 CVE-2013-1776 sudo various flaws [fedora-all]") [968221](show_bug.cgi?id=968221) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [916366](show_bug.cgi?id=916366) [952520](show_bug.cgi?id=952520) | | TreeView+ | [depends on](buglist.cgi?bug_id=916365&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=916365&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2013-02-27 22:44 UTC by Vincent Danen | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-17 07:59 UTC ([History](show_activity.cgi?id=916365)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  dapospis dkopecek huzaifas kzak | | Fixed In Version: | sudo 1.8.5, sudo 1.7.10 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2013-10-01 04:59:23 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2013:1353](https://access.redhat.com/errata/RHSA-2013%3A1353) | 0 | normal | SHIPPED\_LIVE | Low: sudo security and bug fix update | 2013-10-01 00:31:10 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=916365#c0)  Vincent Danen    2013-02-27 22:44:01 UTC  ``` From the upstream advisory:  When a user successfully authenticates with sudo, a time stamp file is updated to allow that user to continue running sudo without requiring a password for a preset time period (five minutes by default). This time stamp file can either be common to all of a user's terminals, or it can be specific to the particular terminal the user authenticated themselves on. The terminal-specific time stamp file behavior can be controlled using the "tty_tickets" option in the sudoers file. This option has been enabled by default since sudo 1.7.4. Prior to sudo 1.7.4, the default was to use a single time stamp for all the user's sessions.  A vulnerability exists because the user can control which terminal the standard input, output and error file descriptors (0-2) refer to. A malicious user could use this to run commands via sudo without authenticating, so long as there exists a terminal the user has access to where a sudo command was successfully run by that same user within the password timeout period (usually five minutes).  The vulnerability does not permit a user to run commands other than those allowed by the sudoers policy.  This affects versions 1.3.5 through up to the fixed 1.7.10p6 version, and sudo 1.8.0 through to the fixed 1.8.7p7.  The fix for 1.7.x: <http://www.sudo.ws/repos/sudo/rev/0c0283d1fafa>  The fix for 1.8.x: <http://www.sudo.ws/repos/sudo/rev/049a12a5cc14>   External References:  <http://www.sudo.ws/sudo/alerts/tty_tickets.html>   ```  [Comment 1](show_bug.cgi?id=916365#c1)  Vincent Danen    2013-02-27 22:47:57 UTC  ``` Created sudo tracking bugs for this issue  Affects: fedora-all [[bug 916367](show_bug.cgi?id=916367 "CLOSED ERRATA - CVE-2013-1775 CVE-2013-1776 sudo various flaws [fedora-all]")]   ```  [Comment 3](show_bug.cgi?id=916365#c3)  Fedora Update System    2013-03-16 01:22:29 UTC  ``` sudo-1.8.6p7-1.fc18 has been pushed to the Fedora 18 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 5](show_bug.cgi?id=916365#c5)  Fedora Update System    2013-03-19 20:04:45 UTC  ``` sudo-1.8.6p7-1.fc17 has been pushed to the Fedora 17 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 6](show_bug.cgi?id=916365#c6)  Vincent Danen    2013-04-08 22:43:05 UTC  ``` Common Vulnerabilities and Exposures assigned an identifier [CVE-2013-1776](https://access.redhat.com/security/cve/CVE-2013-1776) to the following vulnerability:  Name: [CVE-2013-1776](https://access.redhat.com/security/cve/CVE-2013-1776) URL: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1776> Assigned: 20130219 Reference: <http://www.openwall.com/lists/oss-security/2013/02/27/31> Reference: <http://www.sudo.ws/repos/sudo/rev/632f8e028191> Reference: <http://www.sudo.ws/repos/sudo/rev/6b22be4d09f0> Reference: <http://www.sudo.ws/sudo/alerts/tty_tickets.html> Reference: <http://www.securityfocus.com/bid/58207>  sudo 1.3.5 through 1.7.10 and 1.8.0 through 1.8.5, when the tty_tickets option is enabled, does not properly validate the controlling terminal device, which allows local users with sudo permissions to hijack the authorization of another terminal via vectors related to connecting to a standard input, output, and error file descriptors of another terminal.  NOTE: this is one of three closely-related vulnerabilities that were originally assigned [CVE-2013-1776](https://access.redhat.com/security/cve/CVE-2013-1776), but they have been SPLIT because of different affected versions.  See [bug #949751](show_bug.cgi?id=949751 "CLOSED ERRATA - CVE-2013-2776 sudo: bypass of tty_tickets constraints") for [CVE-2013-2776](https://access.redhat.com/security/cve/CVE-2013-2776) and [bug #949753](show_bug.cgi?id=949753 "CLOSED ERRATA - CVE-2013-2777 sudo: bypass of tty_tickets constraints") for [CVE-2013-2777](https://access.redhat.com/security/cve/CVE-2013-2777)   ```  [Comment 14](show_bug.cgi?id=916365#c14)  Huzaifa S. Sidhpurwala    2013-09-30 03:46:57 UTC  ``` This issue has been addressed in following products:    Red Hat Enterprise Linux 6  Via RHBA-2013:0363 <https://rhn.redhat.com/errata/RHBA-2013-0363.html>   ```  [Comment 15](show_bug.cgi?id=916365#c15)  errata-xmlrpc    2013-10-01 00:29:34 UTC  ``` This issue has been addressed in following products:    Red Hat Enterprise Linux 5  Via RHSA-2013:1353 <https://rhn.redhat.com/errata/RHSA-2013-1353.html>   ```  [Comment 16](show_bug.cgi?id=916365#c16)  Huzaifa S. Sidhpurwala    2013-10-01 04:56:58 UTC  ``` This issue has been classified as low security impact, because of the following reasons.  1. A user already needs to have sudo access on the target machine.  2. Successful exploitation of this issue, only results in bypass of sudo cache credential timeout, it does not provide any additional privileges to the attacker.   ```  [Comment 17](show_bug.cgi?id=916365#c17)  Huzaifa S. Sidhpurwala    2013-10-01 04:59:23 UTC  ``` Statement:  (none)   ```  [Comment 18](show_bug.cgi?id=916365#c18)  Tomas Hoger    2013-10-09 21:06:07 UTC  ``` This CVE was assigned to the issue that allowed bypassing tty_tickets restriction by opening another terminal device and connecting it to stdin/stdout/stderr.  To address the bypass, sudo was modified to extract tty information from /proc.  The fix was implemented in sudo versions 1.8.5 and 1.7.10.  However, the fix could still allow fall back to use stdin/stdout/stderr check in certain cases.  Another way to bypass that check was discovered later and what [CVE-2013-2777](https://access.redhat.com/security/cve/CVE-2013-2777) ([bug 949753](show_bug.cgi?id=949753 "CLOSED ERRATA - CVE-2013-2777 sudo: bypass of tty_tickets constraints")) was assigned to.  This issue was already fixed in Red Hat Enterprise Linux 6 packages when they were rebased form 1.7.4p5 to 1.8.6p3 in RHBA-2013:0363 in Red Hat Enterprise Linux 6.4.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=916365&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from rhn.redhat.com_db28edb6_20250125_195538.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2013:1353 - Security Advisory

Issued:
2013-09-30
Updated:
2013-09-30
# RHSA-2013:1353 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Low: sudo security and bug fix update

## Type/Severity

Security Advisory: Low

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2013%3A1353)

## Topic

An updated sudo package that fixes multiple security issues and several
bugs is now available for Red Hat Enterprise Linux 5.

The Red Hat Security Response Team has rated this update as having low
security impact. Common Vulnerability Scoring System (CVSS) base scores,
which give detailed severity ratings, are available for each vulnerability
from the CVE links in the References section.

## Description

The sudo (superuser do) utility allows system administrators to give
certain users the ability to run commands as root.

A flaw was found in the way sudo handled time stamp files. An attacker able
to run code as a local user and with the ability to control the system
clock could possibly gain additional privileges by running commands that
the victim user was allowed to run via sudo, without knowing the victim's
password. (CVE-2013-1775)

It was found that sudo did not properly validate the controlling terminal
device when the tty\_tickets option was enabled in the /etc/sudoers file. An
attacker able to run code as a local user could possibly gain additional
privileges by running commands that the victim user was allowed to run via
sudo, without knowing the victim's password. (CVE-2013-1776, CVE-2013-2776)

This update also fixes the following bugs:

* Due to a bug in the cycle detection algorithm of the visudo utility,

visudo incorrectly evaluated certain alias definitions in the /etc/sudoers
file as cycles. Consequently, a warning message about undefined aliases
appeared. This bug has been fixed, /etc/sudoers is now parsed correctly by
visudo and the warning message no longer appears. (BZ#849679)

* Previously, the 'sudo -l' command did not parse the /etc/sudoers file

correctly if it contained an Active Directory (AD) group. The file was
parsed only up to the first AD group information and then the parsing
failed with the following message:

sudo: unable to cache group ADDOM\admingroup, already exists

With this update, the underlying code has been modified and 'sudo -l' now
parses /etc/sudoers containing AD groups correctly. (BZ#855836)

* Previously, the sudo utility did not escape the backslash characters

contained in user names properly. Consequently, if a system used sudo
integrated with LDAP or Active Directory (AD) as the primary authentication
mechanism, users were not able to authenticate on that system. With this
update, sudo has been modified to process LDAP and AD names correctly and
the authentication process now works as expected. (BZ#869287)

* Prior to this update, the 'visudo -s (strict)' command incorrectly parsed

certain alias definitions. Consequently, an error message was issued. The
bug has been fixed, and parsing errors no longer occur when using 'visudo

* s'. (BZ#905624)

All sudo users are advised to upgrade to this updated package, which
contains backported patches to correct these issues.

## Solution

Before applying this update, make sure all previously-released errata
relevant to your system have been applied.

This update is available via the Red Hat Network. Details on how to
use the Red Hat Network to apply this update are available at
<https://access.redhat.com/site/articles/11258>

## Affected Products

* Red Hat Enterprise Linux Server 5 x86\_64
* Red Hat Enterprise Linux Server 5 ia64
* Red Hat Enterprise Linux Server 5 i386
* Red Hat Enterprise Linux Workstation 5 x86\_64
* Red Hat Enterprise Linux Workstation 5 i386
* Red Hat Enterprise Linux Desktop 5 x86\_64
* Red Hat Enterprise Linux Desktop 5 i386
* Red Hat Enterprise Linux for IBM z Systems 5 s390x
* Red Hat Enterprise Linux for Power, big endian 5 ppc
* Red Hat Enterprise Linux Server from RHUI 5 x86\_64
* Red Hat Enterprise Linux Server from RHUI 5 i386

## Fixes

* [BZ - 853203](https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=853203)
  - Sudo -i isn't passing command arguments containing spaces properly as of sudo-1.7.2p1-14.el5\_8.3
* [BZ - 856902](https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=856902)
  - Defauts:!<user> syntax in sudoers doesn't seem to work as expected
* [BZ - 916363](https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=916363)
  - CVE-2013-1775 sudo: authentication bypass via reset system clock
* [BZ - 916365](https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=916365)
  - CVE-2013-1776 sudo: bypass of tty\_tickets constraints
* [BZ - 949751](https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=949751)
  - CVE-2013-2776 sudo: bypass of tty\_tickets constraints

## CVEs

* [CVE-2013-1776](https://www.redhat.com/security/data/cve/CVE-2013-1776.html)
* [CVE-2013-1775](https://www.redhat.com/security/data/cve/CVE-2013-1775.html)
* [CVE-2013-2776](https://www.redhat.com/security/data/cve/CVE-2013-2776.html)

## References

* <https://access.redhat.com/security/updates/classification/#low>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat Enterprise Linux Server 5

| SRPM | |
| --- | --- |
| sudo-1.7.2p1-28.el5.src.rpm | SHA-256: 9e550738fd1e22ead5a69f66bf0595b1812fcd19c724ece4b300dad2462ff4e7 |
| x86\_64 | |
| sudo-1.7.2p1-28.el5.x86\_64.rpm | SHA-256: 625935a0f06d7d0ec090f1a919fbd04f6c04b25ed74f60a5755a1fda37fe3675 |
| sudo-debuginfo-1.7.2p1-28.el5.x86\_64.rpm | SHA-256: 28fc010e00ab1b970c3357c24ee1404b9fb8c7b2bedc482ab7ce95c604aded7b |
| ia64 | |
| sudo-1.7.2p1-28.el5.ia64.rpm | SHA-256: 70fcd915363df15f8c89478a8e717d348f8196ccd67ab141b1db38de25c7a80f |
| sudo-debuginfo-1.7.2p1-28.el5.ia64.rpm | SHA-256: a5b31a570a40ab7bbf7b2b0ed87e1c9f2432ec6ca4966bae8506165487409963 |
| i386 | |
| sudo-1.7.2p1-28.el5.i386.rpm | SHA-256: b9336daf5b4f0918d9364d92f6b1cf09b93bb66da8d8e016d47612cc551db086 |
| sudo-debuginfo-1.7.2p1-28.el5.i386.rpm | SHA-256: 5250b1d922f337fb31d6d8fda4952843224990c57fe64cc01b555dd17748b6b7 |

## Red Hat Enterprise Linux Workstation 5

| SRPM | |
| --- | --- |
| sudo-1.7.2p1-28.el5.src.rpm | SHA-256: 9e550738fd1e22ead5a69f66bf0595b1812fcd19c724ece4b300dad2462ff4e7 |
| x86\_64 | |
| sudo-1.7.2p1-28.el5.x86\_64.rpm | SHA-256: 625935a0f06d7d0ec090f1a919fbd04f6c04b25ed74f60a5755a1fda37fe3675 |
| sudo-debuginfo-1.7.2p1-28.el5.x86\_64.rpm | SHA-256: 28fc010e00ab1b970c3357c24ee1404b9fb8c7b2bedc482ab7ce95c604aded7b |
| i386 | |
| sudo-1.7.2p1-28.el5.i386.rpm | SHA-256: b9336daf5b4f0918d9364d92f6b1cf09b93bb66da8d8e016d47612cc551db086 |
| sudo-debuginfo-1.7.2p1-28.el5.i386.rpm | SHA-256: 5250b1d922f337fb31d6d8fda4952843224990c57fe64cc01b555dd17748b6b7 |

## Red Hat Enterprise Linux Desktop 5

| SRPM | |
| --- | --- |
| sudo-1.7.2p1-28.el5.src.rpm | SHA-256: 9e550738fd1e22ead5a69f66bf0595b1812fcd19c724ece4b300dad2462ff4e7 |
| x86\_64 | |
| sudo-1.7.2p1-28.el5.x86\_64.rpm | SHA-256: 625935a0f06d7d0ec090f1a919fbd04f6c04b25ed74f60a5755a1fda37fe3675 |
| sudo-debuginfo-1.7.2p1-28.el5.x86\_64.rpm | SHA-256: 28fc010e00ab1b970c3357c24ee1404b9fb8c7b2bedc482ab7ce95c604aded7b |
| i386 | |
| sudo-1.7.2p1-28.el5.i386.rpm | SHA-256: b9336daf5b4f0918d9364d92f6b1cf09b93bb66da8d8e016d47612cc551db086 |
| sudo-debuginfo-1.7.2p1-28.el5.i386.rpm | SHA-256: 5250b1d922f337fb31d6d8fda4952843224990c57fe64cc01b555dd17748b6b7 |

## Red Hat Enterprise Linux for IBM z Systems 5

| SRPM | |
| --- | --- |
| sudo-1.7.2p1-28.el5.src.rpm | SHA-256: 9e550738fd1e22ead5a69f66bf0595b1812fcd19c724ece4b300dad2462ff4e7 |
| s390x | |
| sudo-1.7.2p1-28.el5.s390x.rpm | SHA-256: 70a776da1005f4d34dd60a8c31608a5394651f94a043df18eab09fbdcbf7a0de |
| sudo-debuginfo-1.7.2p1-28.el5.s390x.rpm | SHA-256: 5498eccbc3dc7b1e52991bc5454f13bcf3b4e3b53416caa5aa3e54bd5aa1b407 |

## Red Hat Enterprise Linux for Power, big endian 5

| SRPM | |
| --- | --- |
| sudo-1.7.2p1-28.el5.src.rpm | SHA-256: 9e550738fd1e22ead5a69f66bf0595b1812fcd19c724ece4b300dad2462ff4e7 |
| ppc | |
| sudo-1.7.2p1-28.el5.ppc.rpm | SHA-256: 04266f1bdeef2e6eeae0137fd54da9b1cf3ba94473c9b3e67d194c47350715ea |
| sudo-debuginfo-1.7.2p1-28.el5.ppc.rpm | SHA-256: fa91fa9fb389e5986fbaf6c0fd0277e816f9c9110b43727277296c1e855ae8ff |

## Red Hat Enterprise Linux Server from RHUI 5

| SRPM | |
| --- | --- |
| sudo-1.7.2p1-28.el5.src.rpm | SHA-256: 9e550738fd1e22ead5a69f66bf0595b1812fcd19c724ece4b300dad2462ff4e7 |
| x86\_64 | |
| sudo-1.7.2p1-28.el5.x86\_64.rpm | SHA-256: 625935a0f06d7d0ec090f1a919fbd04f6c04b25ed74f60a5755a1fda37fe3675 |
| sudo-debuginfo-1.7.2p1-28.el5.x86\_64.rpm | SHA-256: 28fc010e00ab1b970c3357c24ee1404b9fb8c7b2bedc482ab7ce95c604aded7b |
| i386 | |
| sudo-1.7.2p1-28.el5.i386.rpm | SHA-256: b9336daf5b4f0918d9364d92f6b1cf09b93bb66da8d8e016d47612cc551db086 |
| sudo-debuginfo-1.7.2p1-28.el5.i386.rpm | SHA-256: 5250b1d922f337fb31d6d8fda4952843224990c57fe64cc01b555dd17748b6b7 |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.redhat.com_4cb5ba21_20250126_113202.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from security-tracker.debian.org_129b8d99_20250126_113203.html ===

# CVE-2013-1776

| **Name** | CVE-2013-1776 |
| --- | --- |
| **Description** | sudo 1.3.5 through 1.7.10 and 1.8.0 through 1.8.5, when the tty\_tickets option is enabled, does not properly validate the controlling terminal device, which allows local users with sudo permissions to hijack the authorization of another terminal via vectors related to connecting to the standard input, output, and error file descriptors of another terminal. NOTE: this is one of three closely-related vulnerabilities that were originally assigned CVE-2013-1776, but they have been SPLIT because of different affected versions. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2013-1776) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2013-1776); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2013-1776), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2013-1776), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2013-1776), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2013-1776), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-1776), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2013-1776), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2013-1776), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2013-1776)/[CVE](https://www.suse.com/security/cve/CVE-2013-1776/), GitHub [advisories](https://github.com/advisories?query=CVE-2013-1776)/[code](https://github.com/search?type=Code&q=%22CVE-2013-1776%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2013-1776%22), [web search](https://duckduckgo.com/html?q=%22CVE-2013-1776%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DSA-2642-1](/tracker/DSA-2642-1) |
| **Debian Bugs** | [701839](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=701839) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [sudo](/tracker/source-package/sudo) ([PTS](https://tracker.debian.org/pkg/sudo)) | bullseye (security), bullseye | 1.9.5p2-3+deb11u1 | fixed |
|  | bookworm | 1.9.13p3-1+deb12u1 | fixed |
|  | sid, trixie | 1.9.16p1-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [sudo](/tracker/source-package/sudo) | source | squeeze | 1.7.4p4-2.squeeze.4 |  | [DSA-2642-1](/tracker/DSA-2642-1) |  |
| [sudo](/tracker/source-package/sudo) | source | (unstable) | 1.8.5p2-1+nmu1 |  |  | [701839](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=701839) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from www.sudo.ws_0319a532_20250125_195605.html ===


Open Navigation

Close Navigation

[Sudo](https://www.sudo.ws/)

[GitHub](https://github.com/sudo-project/sudo%20%20%20%20%20%20%20%20%20%20%20%20)

[Blog](/posts/%20%20%20%20%20%20%20%20%20%20%20%20)

Toggle Dark/Light/Auto mode

Toggle Dark/Light/Auto mode

Toggle Dark/Light/Auto mode

[Back to homepage](https://www.sudo.ws/)

Close Menu Bar

Open Menu Bar

[![Sudo Logo](/images/sudo-sandwich-logo-65.png)](/)

* About Sudo
  + [A Short Introduction](/about/intro/)
  + [A Brief History of Sudo](/about/history/)
  + [Contributors](/about/contributors/)
  + [Translations](/about/translations/)
  + [Sudo Plugins](/about/plugins/)
  + [Sudo License](/about/license/)
  + [Sudo Logo](/about/logo/)
  + [Export Controls](/about/export/)
* Releases
  + [Stable Release](/releases/stable/)
  + [Legacy Release](/releases/legacy/)
  + [Development Release](/releases/devel/)
  + [ChangeLog](/releases/changelog/)
* Getting Sudo
  + [Source Repo](/getting/repo/)
  + [Source Distribution](/getting/source/)
  + [Prebuilt Packages](/getting/packages/)
  + [Download Mirrors](/getting/download_mirrors/)
  + [Mirroring Sudo](/getting/mirror/)
* Documentation
  + Manual Pages (latest)

    - [Cvtsudoers Manual](/docs/man/cvtsudoers.man/)
    - [Sudo Configuration Manual](/docs/man/sudo.conf.man/)
    - [Sudo Log Client Manual](/docs/man/sudo_sendlog.man/)
    - [Sudo Log Server Configuration Manual](/docs/man/sudo_logsrvd.conf.man/)
    - [Sudo Log Server Manual](/docs/man/sudo_logsrvd.man/)
    - [Sudo Log Server Protocol Manual](/docs/man/sudo_logsrv.proto.man/)
    - [Sudo Manual](/docs/man/sudo.man/)
    - [Sudo Plugin API](/docs/man/sudo_plugin.man/)
    - [Sudo Python Plugin API](/docs/man/sudo_plugin_python.man/)
    - [Sudoers LDAP Manual](/docs/man/sudoers.ldap.man/)
    - [Sudoers Manual](/docs/man/sudoers.man/)
    - [Sudoers Time Stamp Manual](/docs/man/sudoers_timestamp.man/)
    - [Sudoreplay Manual](/docs/man/sudoreplay.man/)
    - [Visudo Manual](/docs/man/visudo.man/)
  + [Manual Pages (all versions)](/docs/man_all/)
  + README Files

    - [README](/docs/readme/readme/)
    - [README.LDAP](/docs/readme/readme_ldap/)
  + [Sudo Installation Notes](/docs/install/)
  + [Sudo Upgrade Notes](/docs/upgrade/)
  + [Contributing to Sudo](/docs/contributing/)
  + [Troubleshooting FAQ](/docs/troubleshooting/)
  + [Building Sudo Packages](/docs/packaging/)
  + [Other Documentation](/docs/other/)
  + [Sudo Alternatives](/docs/alternatives/)
* Security
  + [Security Advisories](/security/advisories/)
  + [Security Policy](/security/policy/)
  + [Static Analysis](/security/static_analysis/)
  + [Fuzzing Sudo](/security/fuzzing/)
  + [Sanitizers and Sudo](/security/sanitizers/)

* [Blog](/posts)
* [Bug Tracker](https://bugzilla.sudo.ws)
* [News](/news)
* [Mailing Lists](/lists)
* [GitHub Repo](https://github.com/sudo-project/sudo)
* [Mercurial Repo](https://www.sudo.ws/repos/sudo)
* [Mastodon](https://fosstodon.org/%40sudoproject)
* [Sudo Mastery Book](https://mwl.io/nonfiction/tools#sudo2)

# Potential bypass of tty\_tickets constraints

Feb 27, 2013

When a user successfully authenticates with sudo, a time stamp file
is updated to allow that user to continue running sudo without
requiring a password for a preset time period (five minutes by
default).

This time stamp file can either be common to all of a user’s
terminals, or it can be specific to the particular terminal the
user authenticated themselves on. The terminal-specific time stamp
file behavior can be controlled using the *tty\_tickets* option in
the sudoers file. This option has been enabled by default since
sudo 1.7.4. Prior to sudo 1.7.4, the default was to use a single
time stamp for all the user’s sessions.

A vulnerability exists because the user can control which terminal
the standard input, output and error file descriptors (0-2) refer
to. A malicious user could use this to run commands via sudo without
authenticating, so long as there exists a terminal the user has
access to where a sudo command was successfully run by that same
user within the password timeout period (usually five minutes).

The vulnerability does not permit a user to run commands other than
those allowed by the sudoers policy.

## Sudo versions affected:

Sudo 1.3.5 through 1.7.10p5 and sudo 1.8.0 through 1.8.6p6 inclusive
when the “tty\_tickets” option is enabled. This option is enabled
by default in sudo 1.7.4 and above.

## CVE ID:

This vulnerability has been assigned
[CVE-2013-1776](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1776)
in the [Common Vulnerabilities and Exposures](https://cve.mitre.org/) database.

## Details:

The vulnerability can be triggered when the standard input, output
and error file descriptors (0-2) of a process are closed and a
different terminal device is opened and connected to those descriptors.
When sudo tries to determine the terminal device via the `ttyname()`
function, it will get the name of the other terminal instead. The
core problem is that while `ttyname()` can be used to determine the
name of the terminal device connected to a specific file descriptor,
there is no portable way to determine the name of the terminal
associated with the session the process belongs to. However, on
many systems it is possible to determine this by using the `/proc` file
system or the `sysctl()` function.

Most operating systems that have the `/proc` file system provide a
way to determine the controlling terminal device number for a process;
this information is used by the ps command for example. On Linux, this
is the `tty_nr` field in `/proc/self/stat` (the seventh entry). On
systems with an SVR4-style `/proc`, this is the `pr_ttydev` member of
`struct psinfo`, which comes from `/proc/self/psinfo`. Most BSD systems
that support the `sysctl()` function also provide a way to get the
terminal device number via the `KERN_PROC_PID` sysctl. By mapping
this device number to a file name, it is possible to get the name
of the terminal file without resorting to `ttyname()`. Sudo began
using this method to determine the process’s terminal starting
with version 1.8.5 and 1.7.10.

However, sudo still used the `ttyname()` function as a fall back when
no controlling terminal was found via `/proc` or `sysctl()`. This
allowed a malicious process to cause sudo to use `ttyname()` simply
by creating a new session without a controlling tty before executing
sudo. In sudo 1.8.6p6 and 1.7.10p5, this fall back behavior was
removed. This fixed the vulnerability for systems where the process’s
controlling terminal could be determined via `/proc` or `sysctl()`.

Sudo 1.8.6p7 and 1.7.10p6 contain an additional fix for systems
without `/proc` or `sysctl()` that stores the POSIX session ID in the
time stamp file itself. The controlling terminal is specific to
the POSIX session it is associated with. It is not possible for
two processes in different sessions to have the same controlling
terminal. Sudo will now compare the current session ID with the
one in the time stamp file and ignore the time stamp file if the
session ID does not match. This has the additional benefit of
making it much less likely that a user will be able to reuse the
time stamp file after logging out and back in again on the same
terminal.

## Impact:

A (potentially malicious) program run by a user with sudo access
may be able to bypass the *tty\_tickets* constraints. In order for
this to succeed there must exist on the machine a terminal device
that the user has previously authenticated themselves on via sudo
within the last time stamp timeout (5 minutes by default).

This program may use sudo’s `-n` flag to “probe” the terminals in
question to see if there is an active time stamp file for the user.
Prior to sudo 1.8.6 and 1.7.10, if a password was required when the
-n flag was specified the failure would not be logged, allowing
the program to perform such probes without being detected. The
successful command (if any), would still be logged.

## Fix:

The bug is fixed in sudo 1.8.6p7 and 1.7.10p6.

## Credit:

Ryan Castellucci brought the initial `ttyname()` issue to my attention.
Subsequently, James Ogden discovered that using `setsid()` to create
a new session would cause sudo to fall back to using `ttyname()`.

Other shortcomings in sudo’s *tty\_tickets* functionality have been
known and discussed openly for some time. There is a long discussion
about them at [Ubuntu](https://bugs.launchpad.net/ubuntu/%2Bsource/sudo/%2Bbug/87023).

[IP addresses in sudoers with netmask may match additional hosts](/security/advisories/netmask/)
[Authentication bypass when clock is reset](/security/advisories/epoch_ticket/)



=== Content from www.sudo.ws_4f1bdbc9_20250125_195600.html ===

[![mercurial](/repos/sudo/static/hglogo.png)](https://mercurial-scm.org/)

* [log](/repos/sudo/shortlog/632f8e028191)
* [graph](/repos/sudo/graph/632f8e028191)
* [tags](/repos/sudo/tags)
* [bookmarks](/repos/sudo/bookmarks)
* [branches](/repos/sudo/branches)

* changeset
* [raw](/repos/sudo/raw-rev/632f8e028191)
* [browse](/repos/sudo/file/632f8e028191)

* [help](/repos/sudo/help)

## [Mercurial](/) > [repos](/repos) > [sudo](/repos/sudo)

### changeset 8119:[632f8e028191](/repos/sudo/rev/632f8e028191) 1.7

Find changesets by keywords (author, files, the commit message), revision
number or hash, or [revset expression](/repos/sudo/help/revsets).

Rototill code to determine the tty. For Linux, we now look up the
tty device in /proc/pid/stat instead of trying to open /proc/pid/fd/[0-2].
The sudo\_ttyname\_dev() function maps the given device number to a
string. On BSD, we can use devname(). On Solaris, \_ttyname\_dev()
does what we want. For others we do a breadth-first search of /dev.

| author | Todd C. Miller <Todd.Miller@courtesan.com> |
| --- | --- |
| date | Wed, 23 May 2012 12:46:39 -0400 |
| parents | [5e7f50737a16](/repos/sudo/rev/5e7f50737a16) |
| children | [30deccf57dba](/repos/sudo/rev/30deccf57dba) |
| files | [config.h.in](/repos/sudo/file/632f8e028191/config.h.in) [configure](/repos/sudo/file/632f8e028191/configure) [configure.in](/repos/sudo/file/632f8e028191/configure.in) [ttyname.c](/repos/sudo/file/632f8e028191/ttyname.c) |
| diffstat | 4 files changed, 529 insertions(+), 88 deletions(-) [+] [-]  | [config.h.in](#l1.1) | 20 |  | | --- | --- | --- | | [configure](#l2.1) | 205 |  | | [configure.in](#l3.1) | 10 |  | | [ttyname.c](#l4.1) | 382 |  | |

line wrap: on
 line diff
```

--- a/config.h.in	Wed May 23 11:24:19 2012 -0400
+++ b/config.h.in	Wed May 23 12:46:39 2012 -0400
@@ -389,6 +389,9 @@
 /* Define to 1 if you have the `posix_openpt' function. */
 #undef HAVE_POSIX_OPENPT

+/* Define to 1 if you have the <procfs.h> header file. */
+#undef HAVE_PROCFS_H
+
 /* Define to 1 if you have the <project.h> header file. */
 #undef HAVE_PROJECT_H

@@ -534,6 +537,9 @@
 /* Define to 1 if `p_tdev' is a member of `struct kinfo_proc'. */
 #undef HAVE_STRUCT_KINFO_PROC_P_TDEV

+/* Define to 1 if `pr_ttydev' is a member of `struct psinfo'. */
+#undef HAVE_STRUCT_PSINFO_PR_TTYDEV
+
 /* Define to 1 if the system has the type `struct timespec'. */
 #undef HAVE_STRUCT_TIMESPEC

@@ -563,6 +569,9 @@
    */
 #undef HAVE_SYS_NDIR_H

+/* Define to 1 if you have the <sys/procfs.h> header file. */
+#undef HAVE_SYS_PROCFS_H
+
 /* Define to 1 if you have the <sys/select.h> header file. */
 #undef HAVE_SYS_SELECT_H

@@ -630,6 +639,9 @@
 /* Define to 1 if you have the `_innetgr' function. */
 #undef HAVE__INNETGR

+/* Define to 1 if you have the `_ttyname_dev' function. */
+#undef HAVE__TTYNAME_DEV
+
 /* Define to 1 if your crt0.o defines the __progname symbol for you. */
 #undef HAVE___PROGNAME

@@ -664,6 +676,14 @@
 /* The user or email address that sudo mail is sent to. */
 #undef MAILTO

+/* Define to 1 if `major', `minor', and `makedev' are declared in <mkdev.h>.
+   */
+#undef MAJOR_IN_MKDEV
+
+/* Define to 1 if `major', `minor', and `makedev' are declared in
+   <sysmacros.h>. */
+#undef MAJOR_IN_SYSMACROS
+
 /* The max number of chars per log file line (for line wrapping). */
 #undef MAXLOGFILELEN

```
```

--- a/configure	Wed May 23 11:24:19 2012 -0400
+++ b/configure	Wed May 23 12:46:39 2012 -0400
@@ -2087,6 +2087,63 @@

 } # ac_fn_c_check_header_mongrel

+# ac_fn_c_check_member LINENO AGGR MEMBER VAR INCLUDES
+# ----------------------------------------------------
+# Tries to find if the field MEMBER exists in type AGGR, after including
+# INCLUDES, setting cache variable VAR accordingly.
+ac_fn_c_check_member ()
+{
+  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $2.$3" >&5
+$as_echo_n "checking for $2.$3... " >&6; }
+if eval \${$4+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$5
+int
+main ()
+{
+static $2 ac_aggr;
+if (ac_aggr.$3)
+return 0;
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  eval "$4=yes"
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$5
+int
+main ()
+{
+static $2 ac_aggr;
+if (sizeof ac_aggr.$3)
+return 0;
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  eval "$4=yes"
+else
+  eval "$4=no"
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+eval ac_res=\$$4
+	       { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
+$as_echo "$ac_res" >&6; }
+  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
+
+} # ac_fn_c_check_member
+
 # ac_fn_c_check_type LINENO TYPE VAR INCLUDES
 # -------------------------------------------
 # Tests whether TYPE exists after having included INCLUDES, setting cache
@@ -2319,63 +2376,6 @@

 } # ac_fn_c_compute_int

-# ac_fn_c_check_member LINENO AGGR MEMBER VAR INCLUDES
-# ----------------------------------------------------
-# Tries to find if the field MEMBER exists in type AGGR, after including
-# INCLUDES, setting cache variable VAR accordingly.
-ac_fn_c_check_member ()
-{
-  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $2.$3" >&5
-$as_echo_n "checking for $2.$3... " >&6; }
-if eval \${$4+:} false; then :
-  $as_echo_n "(cached) " >&6
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-$5
-int
-main ()
-{
-static $2 ac_aggr;
-if (ac_aggr.$3)
-return 0;
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  eval "$4=yes"
-else
-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
-/* end confdefs.h.  */
-$5
-int
-main ()
-{
-static $2 ac_aggr;
-if (sizeof ac_aggr.$3)
-return 0;
-  ;
-  return 0;
-}
-_ACEOF
-if ac_fn_c_try_compile "$LINENO"; then :
-  eval "$4=yes"
-else
-  eval "$4=no"
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-fi
-eval ac_res=\$$4
-	       { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
-$as_echo "$ac_res" >&6; }
-  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
-
-} # ac_fn_c_check_member
-
 # ac_fn_c_check_decl LINENO SYMBOL VAR INCLUDES
 # ---------------------------------------------
 # Tests whether SYMBOL is declared in INCLUDES, setting cache variable VAR
@@ -15161,6 +15161,56 @@

 fi

+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether sys/types.h defines makedev" >&5
+$as_echo_n "checking whether sys/types.h defines makedev... " >&6; }
+if ${ac_cv_header_sys_types_h_makedev+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <sys/types.h>
+int
+main ()
+{
+return makedev(0, 0);
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"; then :
+  ac_cv_header_sys_types_h_makedev=yes
+else
+  ac_cv_header_sys_types_h_makedev=no
+fi
+rm -f core conftest.err conftest.$ac_objext \
+    conftest$ac_exeext conftest.$ac_ext
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_header_sys_types_h_makedev" >&5
+$as_echo "$ac_cv_header_sys_types_h_makedev" >&6; }
+
+if test $ac_cv_header_sys_types_h_makedev = no; then
+ac_fn_c_check_header_mongrel "$LINENO" "sys/mkdev.h" "ac_cv_header_sys_mkdev_h" "$ac_includes_default"
+if test "x$ac_cv_header_sys_mkdev_h" = xyes; then :
+
+$as_echo "#define MAJOR_IN_MKDEV 1" >>confdefs.h
+
+fi
+
+
+
+  if test $ac_cv_header_sys_mkdev_h = no; then
+    ac_fn_c_check_header_mongrel "$LINENO" "sys/sysmacros.h" "ac_cv_header_sys_sysmacros_h" "$ac_includes_default"
+if test "x$ac_cv_header_sys_sysmacros_h" = xyes; then :
+
+$as_echo "#define MAJOR_IN_SYSMACROS 1" >>confdefs.h
+
+fi
+
+
+  fi
+fi
+
 for ac_header in malloc.h netgroup.h paths.h spawn.h utime.h sys/sockio.h sys/bsdtypes.h sys/select.h sys/stropts.h sys/sysmacros.h
 do :
   as_ac_Header=`$as_echo "ac_cv_header_$ac_header" | $as_tr_sh`
@@ -15174,6 +15224,47 @@

 done

+for ac_header in procfs.h sys/procfs.h
+do :
+  as_ac_Header=`$as_echo "ac_cv_header_$ac_header" | $as_tr_sh`
+ac_fn_c_check_header_mongrel "$LINENO" "$ac_header" "$as_ac_Header" "$ac_includes_default"
+if eval test \"x\$"$as_ac_Header"\" = x"yes"; then :
+  cat >>confdefs.h <<_ACEOF
+#define `$as_echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+ ac_fn_c_check_member "$LINENO" "struct psinfo" "pr_ttydev" "ac_cv_member_struct_psinfo_pr_ttydev" "$ac_includes_default
+#ifdef HAVE_PROCFS_H
+#include <procfs.h>
+#endif
+#ifdef HAVE_SYS_PROCFS_H
+#include <sys/procfs.h>
+#endif
+
+"
+if test "x$ac_cv_member_struct_psinfo_pr_ttydev" = xyes; then :
+
+cat >>confdefs.h <<_ACEOF
+#define HAVE_STRUCT_PSINFO_PR_TTYDEV 1
+_ACEOF
+
+for ac_func in _ttyname_dev
+do :
+  ac_fn_c_check_func "$LINENO" "_ttyname_dev" "ac_cv_func__ttyname_dev"
+if test "x$ac_cv_func__ttyname_dev" = xyes; then :
+  cat >>confdefs.h <<_ACEOF
+#define HAVE__TTYNAME_DEV 1
+_ACEOF
+
+fi
+done
+
+fi
+
+break
+fi
+
+done
+
 # Check whether --enable-largefile was given.
 if test "${enable_largefile+set}" = set; then :
   enableval=$enable_largefile;
```
```

--- a/configure.in	Wed May 23 11:24:19 2012 -0400
+++ b/configure.in	Wed May 23 12:46:39 2012 -0400
@@ -1941,7 +1941,17 @@
 AC_HEADER_STDC
 AC_HEADER_DIRENT
 AC_HEADER_TIME
+AC_HEADER_MAJOR
 AC_CHECK_HEADERS(malloc.h netgroup.h paths.h spawn.h utime.h sys/sockio.h sys/bsdtypes.h sys/select.h sys/stropts.h sys/sysmacros.h)
+AC_CHECK_HEADERS([procfs.h] [sys/procfs.h], [AC_CHECK_MEMBERS(struct psinfo.pr_ttydev, [AC_CHECK_FUNCS(_ttyname_dev)], [], [AC_INCLUDES_DEFAULT
+#ifdef HAVE_PROCFS_H
+#include <procfs.h>
+#endif
+#ifdef HAVE_SYS_PROCFS_H
+#include <sys/procfs.h>
+#endif
+])]
+break)
 dnl
 dnl Check for large file support.  HP-UX 11.23 has a broken sys/type.h
 dnl when large files support is enabled so work around it.
```
```

--- a/ttyname.c	Wed May 23 11:24:19 2012 -0400
+++ b/ttyname.c	Wed May 23 12:46:39 2012 -0400
@@ -16,9 +16,20 @@

 #include <config.h>

+/* Large files not supported by procfs.h */
+#if defined(HAVE_PROCFS_H) || defined(HAVE_SYS_PROCFS_H)
+# undef _FILE_OFFSET_BITS
+# undef _LARGE_FILES
+#endif
+
 #include <sys/types.h>
 #include <sys/param.h>
 #include <sys/stat.h>
+#if defined(MAJOR_IN_MKDEV)
+# include <sys/mkdev.h>
+#elif defined(MAJOR_IN_SYSMACROS)
+# include <sys/sysmacros.h>
+#endif
 #include <stdio.h>
 #ifdef STDC_HEADERS
 # include <stdlib.h>
@@ -42,12 +53,34 @@
 #endif /* HAVE_UNISTD_H */
 #include <errno.h>
 #include <fcntl.h>
+#include <limits.h>
+#ifdef HAVE_DIRENT_H
+# include <dirent.h>
+# define NAMLEN(dirent) strlen((dirent)->d_name)
+#else
+# define dirent direct
+# define NAMLEN(dirent) (dirent)->d_namlen
+# ifdef HAVE_SYS_NDIR_H
+#  include <sys/ndir.h>
+# endif
+# ifdef HAVE_SYS_DIR_H
+#  include <sys/dir.h>
+# endif
+# ifdef HAVE_NDIR_H
+#  include <ndir.h>
+# endif
+#endif
 #if defined(HAVE_STRUCT_KINFO_PROC_P_TDEV) || defined (HAVE_STRUCT_KINFO_PROC_KP_EPROC_E_TDEV) || defined(HAVE_STRUCT_KINFO_PROC2_P_TDEV)
 # include <sys/sysctl.h>
 #elif defined(HAVE_STRUCT_KINFO_PROC_KI_TDEV)
 # include <sys/sysctl.h>
 # include <sys/user.h>
 #endif
+#if defined(HAVE_PROCFS_H)
+# include <procfs.h>
+#elif defined(HAVE_SYS_PROCFS_H)
+# include <sys/procfs.h>
+#endif

 #include "sudo.h"

@@ -76,7 +109,227 @@
 # define sudo_kp_namelen	4
 #endif

-#ifdef sudo_kp_tdev
+#if defined(sudo_kp_tdev)
+/*
+ * Like ttyname() but uses a dev_t instead of an open fd.
+ * Caller is responsible for freeing the returned string.
+ * The BSD version uses devname()
+ */
+static char *
+sudo_ttyname_dev(dev_t tdev)
+{
+    char *dev, *tty = NULL;
+
+    /* Some versions of devname() return NULL on failure, others do not. */
+    dev = devname(tdev, S_IFCHR);
+    if (dev != NULL && *dev != '?' && *dev != '#') {
+	if (*dev != '/') {
+	    /* devname() doesn't use the /dev/ prefix, add one... */
+	    size_t len = sizeof(_PATH_DEV) + strlen(dev);
+	    tty = emalloc(len);
+	    strlcpy(tty, _PATH_DEV, len);
+	    strlcat(tty, dev, len);
+	} else {
+	    /* Should not happen but just in case... */
+	    tty = estrdup(dev);
+	}
+    }
+    return tty;
+}
+#elif defined(HAVE__TTYNAME_DEV)
+extern char *_ttyname_dev(dev_t rdev, char *buffer, size_t buflen);
+
+/*
+ * Like ttyname() but uses a dev_t instead of an open fd.
+ * Caller is responsible for freeing the returned string.
+ * This version is just a wrapper around _ttyname_dev().
+ */
+static char *
+sudo_ttyname_dev(dev_t tdev)
+{
+    char buf[TTYNAME_MAX], *tty;
+
+    tty = _ttyname_dev(tdev, buf, sizeof(buf));
+
+    return estrdup(tty);
+}
+#else
+/*
+ * Devices to search before doing a breadth-first scan.
+ */
+static char *search_devs[] = {
+    "/dev/console",
+    "/dev/wscons",
+    "/dev/pts/",
+    "/dev/vt/",
+    "/dev/term/",
+    "/dev/zcons/",
+    NULL
+};
+
+static char *ignore_devs[] = {
+    "/dev/fd/",
+    "/dev/stdin",
+    "/dev/stdout",
+    "/dev/stderr",
+    NULL
+};
+
+/*
+ * Do a breadth-first scan of dir looking for the specified device.
+ */
+static
+char *sudo_ttyname_scan(dir, rdev, builtin)
+    const char *dir;
+    dev_t rdev;
+    int builtin;
+{
+    DIR *d;
+    char pathbuf[PATH_MAX], **subdirs = NULL, *devname = NULL;
+    size_t sdlen, d_len, len, num_subdirs = 0, max_subdirs = 0;
+    struct dirent *dp;
+    struct stat sb;
+    int i;
+
+    if (dir[0] == '\0' || (d = opendir(dir)) == NULL)
+	goto done;
+
+    sdlen = strlen(dir);
+    if (dir[sdlen - 1] == '/')
+	sdlen--;
+    if (sdlen + 1 >= sizeof(pathbuf)) {
+	errno = ENAMETOOLONG;
+	warning("%.*s/", (int)sdlen, dir);
+	goto done;
+    }
+    memcpy(pathbuf, dir, sdlen);
+    pathbuf[sdlen++] = '/';
+    pathbuf[sdlen] = '\0';
+
+    while ((dp = readdir(d)) != NULL) {
+	/* Skip anything starting with "." */
+	if (dp->d_name[0] == '.')
+	    continue;
+
+	d_len = NAMLEN(dp);
+	if (sdlen + d_len >= sizeof(pathbuf))
+	    continue;
+	memcpy(&pathbuf[sdlen], dp->d_name, d_len + 1); /* copy NUL too */
+	d_len += sdlen;
+
+	for (i = 0; ignore_devs[i] != NULL; i++) {
+	    len = strlen(ignore_devs[i]);
+	    if (ignore_devs[i][len - 1] == '/')
+		len--;
+	    if (d_len == len && strncmp(pathbuf, ignore_devs[i], len) == 0)
+		break;
+	}
+	if (ignore_devs[i] != NULL)
+	    continue;
+	if (!builtin) {
+	    /* Skip entries in search_devs; we already checked them. */
+	    for (i = 0; search_devs[i] != NULL; i++) {
+		len = strlen(search_devs[i]);
+		if (search_devs[i][len - 1] == '/')
+		    len--;
+		if (d_len == len && strncmp(pathbuf, search_devs[i], len) == 0)
+		    break;
+	    }
+	    if (search_devs[i] != NULL)
+		continue;
+	}
+# if defined(HAVE_STRUCT_DIRENT_D_TYPE) && defined(DTTOIF)
+	/* Use d_type to avoid a stat() if possible. */
+	/* Convert d_type to stat-style type bits but follow links. */
+	if (dp->d_type != DT_LNK && dp->d_type != DT_CHR)
+	    sb.st_mode = DTTOIF(dp->d_type);
+	else
+# endif
+	if (stat(pathbuf, &sb) == -1)
+	    continue;
+	if (S_ISDIR(sb.st_mode)) {
+	    if (!builtin) {
+		/* Add to list of subdirs to search. */
+		if (num_subdirs + 1 > max_subdirs) {
+		    max_subdirs += 64;
+		    subdirs = erealloc3(subdirs, max_subdirs, sizeof(char *));
+		}
+		subdirs[num_subdirs++] = estrdup(pathbuf);
+	    }
+	    continue;
+	}
+	if (S_ISCHR(sb.st_mode) && sb.st_rdev == rdev) {
+	    devname = estrdup(pathbuf);
+	    break;
+	}
+    }
+    closedir(d);
+
+    /* Search subdirs if we didn't find it in the root level. */
+    for (i = 0; devname == NULL && i < num_subdirs; i++)
+	devname = sudo_ttyname_scan(subdirs[i], rdev, false);
+
+done:
+    for (i = 0; i < num_subdirs; i++)
+	efree(subdirs[i]);
+    efree(subdirs);
+    return devname;
+}
+
+/*
+ * Like ttyname() but uses a dev_t instead of an open fd.
+ * Caller is responsible for freeing the returned string.
+ * Generic version.
+ */
+static char *
+sudo_ttyname_dev(rdev)
+    dev_t rdev;
+{
+    struct stat sb;
+    size_t len;
+    char buf[PATH_MAX], **sd, *devname, *tty = NULL;
+
+    /*
+     * First check search_devs.
+     */
+    for (sd = search_devs; (devname = *sd) != NULL; sd++) {
+	len = strlen(devname);
+	if (devname[len - 1] == '/') {
+	    /* Special case /dev/pts */
+	    if (strcmp(devname, "/dev/pts/") == 0) {
+		(void)snprintf(buf, sizeof(buf), "%spts/%u", _PATH_DEV,
+		    (unsigned int)minor(rdev));
+		if (stat(buf, &sb) == 0) {
+		    if (S_ISCHR(sb.st_mode) && sb.st_rdev == rdev) {
+			tty = estrdup(buf);
+			break;
+		    }
+		}
+		continue;
+	    }
+	    /* Traverse directory */
+	    tty = sudo_ttyname_scan(devname, rdev, 1);
+	} else {
+	    if (stat(devname, &sb) == 0) {
+		if (S_ISCHR(sb.st_mode) && sb.st_rdev == rdev) {
+		    tty = estrdup(devname);
+		    break;
+		}
+	    }
+	}
+    }
+
+    /*
+     * Not found?  Do a breadth-first traversal of /dev/.
+     */
+    if (tty == NULL)
+	tty = sudo_ttyname_scan(_PATH_DEV, rdev, 0);
+
+    return tty;
+}
+#endif
+
+#if defined(sudo_kp_tdev)
 /*
  * Return a string from ttyname() containing the tty to which the process is
  * attached or NULL if there is no tty associated with the process (or its
@@ -108,19 +361,8 @@
 	    rc = sysctl(mib, sudo_kp_namelen, ki_proc, &size, NULL, 0);
 	} while (rc == -1 && errno == ENOMEM);
 	if (rc != -1) {
-	    char *dev = devname(ki_proc->sudo_kp_tdev, S_IFCHR);
-	    /* Some versions of devname() return NULL, others do not. */
-	    if (dev != NULL && *dev != '?' && *dev != '#') {
-		if (*dev != '/') {
-		    /* devname() doesn't use the /dev/ prefix, add one... */
-		    size_t len = sizeof(_PATH_DEV) + strlen(dev);
-		    tty = emalloc(len);
-		    strlcpy(tty, _PATH_DEV, len);
-		    strlcat(tty, dev, len);
-		} else {
-		    /* Should not happen but just in case... */
-		    tty = estrdup(dev);
-		}
+	    if (ki_proc->sudo_kp_tdev != (dev_t)-1) {
+		tty = sudo_ttyname_dev(ki_proc->sudo_kp_tdev);
 	    }
 	}
     }
@@ -136,36 +378,114 @@

     return tty;
 }
-#else
+#elif defined(HAVE_STRUCT_PSINFO_PR_TTYDEV)
 /*
  * Return a string from ttyname() containing the tty to which the process is
  * attached or NULL if there is no tty associated with the process (or its
- * parent).  First tries std{in,out,err} then falls back to the parent's /proc
- * entry.  We could try following the parent all the way to pid 1 but
- * /proc/%d/status is system-specific (text on Linux, a struct on Solaris).
+ * parent).  First tries /proc/pid/psinfo, then /proc/ppid/psinfo.
+ * Falls back on ttyname of std{in,out,err} if that fails.
  */
 char *
 get_process_ttyname()
 {
     char path[PATH_MAX], *tty = NULL;
-    pid_t ppid;
+    struct stat sb;
+    struct psinfo psinfo;
+    ssize_t nread;
     int i, fd;

-    if ((tty = ttyname(STDIN_FILENO)) == NULL &&
-	(tty = ttyname(STDOUT_FILENO)) == NULL &&
-	(tty = ttyname(STDERR_FILENO)) == NULL) {
-	/* No tty for child, check the parent via /proc. */
-	ppid = getppid();
-	for (i = STDIN_FILENO; i < STDERR_FILENO && tty == NULL; i++) {
-	    snprintf(path, sizeof(path), "/proc/%d/fd/%d", (int)ppid, i);
-	    fd = open(path, O_RDONLY|O_NOCTTY, 0);
-	    if (fd != -1) {
-		tty = ttyname(fd);
-		close(fd);
+    /* Try to determine the tty from pr_ttydev in /proc/pid/psinfo. */
+    for (i = 0; tty == NULL && i < 2; i++) {
+	(void)snprintf(path, sizeof(path), "/proc/%u/psinfo",
+	    i ? (unsigned int)getppid() : (unsigned int)getpid());
+	if ((fd = open(path, O_RDONLY, 0)) == -1)
+	    continue;
+	nread = read(fd, &psinfo, sizeof(psinfo));
+	close(fd);
+	if (nread == (ssize_t)sizeof(psinfo) && psinfo.pr_ttydev != (dev_t)-1) {
+	    tty = sudo_ttyname_dev(psinfo.pr_ttydev);
+	}
+    }
+
+    /* If all else fails, fall back on ttyname(). */
+    if (tty == NULL) {
+	if ((tty = ttyname(STDIN_FILENO)) != NULL ||
+	    (tty = ttyname(STDOUT_FILENO)) != NULL ||
+	    (tty = ttyname(STDERR_FILENO)) != NULL)
+	    tty = estrdup(tty);
+    }
+
+    return tty;
+}
+#elif defined(__linux__)
+/*
+ * Return a string from ttyname() containing the tty to which the process is
+ * attached or NULL if there is no tty associated with the process (or its
+ * parent).  First tries field 7 in /proc/pid/stat, then /proc/ppid/stat.
+ * Falls back on ttyname of std{in,out,err} if that fails.
+ */
+char *
+get_process_ttyname()
+{
+    char *line = NULL, *tty = NULL;
+    size_t linesize = 0;
+    ssize_t len;
+    int i;
+
+    /* Try to determine the tty from pr_ttydev in /proc/pid/psinfo. */
+    for (i = 0; tty == NULL && i < 2; i++) {
+	FILE *fp;
+	char path[PATH_MAX];
+	(void)snprintf(path, sizeof(path), "/proc/%u/stat",
+	    i ? (unsigned int)getppid() : (unsigned int)getpid());
+	if ((fp = fopen(path, "r")) == NULL)
+	    continue;
+	len = getline(&line, &linesize, fp);
+	fclose(fp);
+	if (len != -1) {
+	    /* Field 7 is the tty dev (0 if no tty) */
+	    char *cp = line;
+	    int field = 1;
+	    while (*cp != '\0') {
+		if (*cp++ == ' ') {
+		    if (++field == 7) {
+			dev_t tdev = (dev_t)atoi(cp);
+			if (tdev > 0)
+			    tty = sudo_ttyname_dev(tdev);
+			break;
+		    }
+		}
 	    }
 	}
     }
+    efree(line);
+
+    /* If all else fails, fall back on ttyname(). */
+    if (tty == NULL) {
+	if ((tty = ttyname(STDIN_FILENO)) != NULL ||
+	    (tty = ttyname(STDOUT_FILENO)) != NULL ||
+	    (tty = ttyname(STDERR_FILENO)) != NULL)
+	    tty = estrdup(tty);
+    }
+
+    return tty;
+}
+#else
+/*
+ * Return a string from ttyname() containing the tty to which the process is
+ * attached or NULL if there is no tty associated with the process.
+ * parent).
+ */
+char *
+get_process_ttyname()
+{
+    char *tty;
+
+    if ((tty = ttyname(STDIN_FILENO)) == NULL) {
+	if ((tty = ttyname(STDOUT_FILENO)) == NULL)
+	    tty = ttyname(STDERR_FILENO);
+    }

     return estrdup(tty);
 }
-#endif /* sudo_kp_tdev */
+#endif
```



=== Content from bugs.debian.org_f786bb31_20250125_195532.html ===

# Debian Bug report logs - #701839 sudo: CVE-2013-1776 potential bypass of sudo tty\_tickets constraints

[![version graph](version.cgi?width=2;fixed=sudo%2F1.8.5p2-1%2Bnmu1;fixed=sudo%2F1.7.4p4-2.squeeze.4;height=2;collapse=1;package=sudo;absolute=0)](version.cgi?absolute=0;fixed=sudo%2F1.8.5p2-1%2Bnmu1;fixed=sudo%2F1.7.4p4-2.squeeze.4;package=sudo;info=1;collapse=1)

Package:
[sudo](pkgreport.cgi?package=sudo);
Maintainer for [sudo](pkgreport.cgi?package=sudo) is [Sudo Maintainers <sudo@packages.debian.org>](pkgreport.cgi?maint=sudo%40packages.debian.org); Source for [sudo](pkgreport.cgi?package=sudo) is [src:sudo](pkgreport.cgi?src=sudo) ([PTS](https://tracker.debian.org/pkg/sudo), [buildd](https://buildd.debian.org/sudo), [popcon](https://qa.debian.org/popcon.php?package=sudo)).

Reported by: [Nico Golde <nion@debian.org>](pkgreport.cgi?submitter=nion%40debian.org)

Date: Wed, 27 Feb 2013 20:15:02 UTC

Severity: important

Tags: security

Fixed in versions sudo/1.8.5p2-1+nmu1, sudo/1.7.4p4-2.squeeze.4

**Done:** Michael Gilbert <mgilbert@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=701839;mbox=yes), [status mbox](bugreport.cgi?bug=701839;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=701839;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Bdale Garbee <bdale@gag.com>`:

`Bug#701839`; Package `sudo`.
(Wed, 27 Feb 2013 20:15:04 GMT) ([full text](bugreport.cgi?bug=701839;msg=2), [mbox](bugreport.cgi?bug=701839;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Nico Golde <nion@debian.org>`:

New Bug report received and forwarded. Copy sent to `Bdale Garbee <bdale@gag.com>`.
(Wed, 27 Feb 2013 20:15:04 GMT) ([full text](bugreport.cgi?bug=701839;msg=4), [mbox](bugreport.cgi?bug=701839;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=701839;msg=5), [mbox](bugreport.cgi?bug=701839;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: submit@bugs.debian.org
Subject: sudo: CVE-2013-1776 potential bypass of sudo tty\_tickets constraints
Date: Wed, 27 Feb 2013 21:11:49 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=701839;msg=5) (text/plain, inline)]
```
```
Package: sudo
Severity: important
Tags: security

Hi,
the following vulnerability was published for sudo.

[CVE-2013-1776](https://security-tracker.debian.org/tracker/CVE-2013-1776)[0]:
(from the upstream report)

Sudo 1.8.6p7 and 1.7.10p6 are now available which include a fix for
the following bug:

Potential bypass of sudo tty_tickets constraints

Summary:
    When a user successfully authenticates with sudo, a time stamp
    file is updated to allow that user to continue running sudo
    without requiring a password for a preset time period (five
    minutes by default).

    This time stamp file can either be common to all of a user's
    terminals, or it can be specific to the particular terminal the
    user authenticated themselves on.  The terminal-specific time
    stamp file behavior can be controlled using the "tty_tickets"
    option in the sudoers file.  This option has been enabled by
    default since sudo 1.7.4.  Prior to sudo 1.7.4, the default was
    to use a single time stamp for all the user's sessions.

    A vulnerability exists because the user can control which
    terminal the standard input, output and error file descriptors
    (0-2) refer to.  A malicious user could use this to run commands
    via sudo without authenticating, so long as there exists a
    terminal the user has access to where a sudo command was
    successfully run by that same user within the password timeout
    period (usually five minutes).

    The vulnerability does not permit a user to run commands other
    than those allowed by the sudoers policy.

Sudo versions affected:
    Sudo 1.3.5 through 1.7.10p6 and sudo 1.8.0 through 1.8.6p7 when
    the "tty_tickets" option is enabled.  This option is enabled
    by default in sudo 1.7.4 and above.

Details:
    The vulnerability can be triggered when the standard input,
    output and error file descriptors (0-2) of a process are closed
    and a different terminal device is opened and connected to those
    descriptors.  When sudo tries to determine the terminal device
    via the ttyname() function, it will get the name of the other
    terminal instead.  The core problem is that while ttyname() can
    be used to determine the name of the terminal device connected
    to a specific file descriptor, there is no portable way to
    determine the name of the terminal associated with the session
    the process belongs to.  However, on many systems it is possible
    to determine this by using the /proc file system or the sysctl()
    function.

    Most operating systems that have the /proc file system provide
    a way to determine the controlling terminal device number for
    a process; this information is used by the ps command for
    example.  On Linux, this is the tty_nr field in /proc/self/stat
    (the seventh entry).  On systems with an SVR4-style /proc, this
    is the pr_ttydev member of struct psinfo, which comes from
    /proc/self/psinfo.  Most BSD systems that support the sysctl()
    function also provide a way to get the terminal device number
    via the KERN_PROC_PID sysctl.  By mapping this device number
    to a file name, it is possible to get the name of the terminal
    file without resorting to ttyname().  Sudo began using this
    method to determine the process's terminal starting with version
    1.8.5 and 1.7.10.

    However, sudo still used the ttyname() function as a fall back
    when no controlling terminal was found via /proc or sysctl().
    This allowed a malicious process to cause sudo to use ttyname()
    simply by creating a new session without a controlling tty
    before executing sudo.  In sudo 1.8.6p6 and 1.7.10p5, this fall
    back behavior was removed.  This fixed the vulnerability for
    systems where the process's controlling terminal could be
    determined via /proc or sysctl().

    Sudo 1.8.6p7 and 1.7.10p6 contain an additional fix for systems
    without /proc or sysctl() that stores the POSIX session ID in
    the time stamp file itself.  The controlling terminal is specific
    to the POSIX session it is associated with.  It is not possible
    for two processes in different sessions to have the same
    controlling terminal.  Sudo will now compare the current session
    ID with the one in the time stamp file and ignore the time stamp
    file if the session ID does not match.  This has the additional
    benefit of making it much less likely that a user will be able
    to reuse the time stamp file after logging out and back in again
    on the same terminal.

Impact:
    A (potentially malicious) program run by a user with sudo access
    may be able to bypass the "tty_ticket" constraints.  In order
    for this to succeed there must exist on the machine a terminal
    device that the user has previously authenticated themselves
    on via sudo within the last time stamp timeout (5 minutes by
    default).

    This program may use sudo's -n flag to "probe" the terminals
    in question to see if there is an active time stamp file for
    the user.  Prior to sudo 1.8.6 and 1.7.10, if a password was
    required when the -n flag was specified the failure would not
    be logged, allowing the program to perform such probes without
    being detected.  The successful command (if any), would still
    be logged.

Fix:
    The bug is fixed in sudo 1.8.6p7 and 1.7.10p6.

Credit:
    Ryan Castellucci brought the initial ttyname() issue to my
    attention.  Subsequently, James Ogden discovered that using
    setsid() to create a new session would cause sudo to fall back
    to using ttyname().

    Other shortcomings in sudo's "tty_tickets" functionality have
    been known and discussed openly for some time.  There is a long
    discussion about them at:
	[https://bugs.launchpad.net/ubuntu/+source/sudo/+bug/87023](https://bugs.launchpad.net/ubuntu/%2Bsource/sudo/%2Bbug/87023)

If you fix the vulnerability please also make sure to include the
CVE (Common Vulnerabilities & Exposures) id in your changelog entry.

For further information see:

[0] <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1776>
    <http://security-tracker.debian.org/tracker/CVE-2013-1776>
Please adjust the affected versions in the BTS as needed.

--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0xA0A0AAAA

```
```
[[Message part 2](bugreport.cgi?att=1;bug=701839;msg=5) (application/pgp-signature, inline)]
```

---

**Reply sent**
to `Michael Gilbert <mgilbert@debian.org>`:

You have taken responsibility.
(Fri, 01 Mar 2013 05:36:05 GMT) ([full text](bugreport.cgi?bug=701839;msg=7), [mbox](bugreport.cgi?bug=701839;mbox=yes;msg=7), [link](#6)).

---

**Notification sent**
to `Nico Golde <nion@debian.org>`:

Bug acknowledged by developer.
(Fri, 01 Mar 2013 05:36:05 GMT) ([full text](bugreport.cgi?bug=701839;msg=9), [mbox](bugreport.cgi?bug=701839;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 701839-close@bugs.debian.org ([full text](bugreport.cgi?bug=701839;msg=10), [mbox](bugreport.cgi?bug=701839;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=mgilbert%40debian.org)
From: Michael Gilbert <mgilbert@debian.org>
To: 701839-close@bugs.debian.org
Subject: Bug#701839: fixed in sudo 1.8.5p2-1+nmu1
Date: Fri, 01 Mar 2013 05:32:53 +0000
```
Source: sudo
Source-Version: 1.8.5p2-1+nmu1

We believe that the bug you reported is fixed in the latest version of
sudo, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 701839@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Michael Gilbert <mgilbert@debian.org> (supplier of updated sudo package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Fri, 01 Mar 2013 03:26:37 +0000
Source: sudo
Binary: sudo sudo-ldap
Architecture: source amd64
Version: 1.8.5p2-1+nmu1
Distribution: unstable
Urgency: high
Maintainer: Bdale Garbee <bdale@gag.com>
Changed-By: Michael Gilbert <mgilbert@debian.org>
Description:
 sudo       - Provide limited super user privileges to specific users
 sudo-ldap  - Provide limited super user privileges to specific users
Closes: [701838](bugreport.cgi?bug=701838) [701839](bugreport.cgi?bug=701839)
Changes:
 sudo (1.8.5p2-1+nmu1) unstable; urgency=high
 .
   * Non-maintainer upload by the Security Team.
   * Fix cve-2013-1775: authentication bypass when the clock is set to the UNIX
     epoch [00:00:00 UTC on 1 January 1970] (closes: #[701838](bugreport.cgi?bug=701838)).
   * Fix cve-2013-1776: session id hijacking from another authorized tty
     (closes: #[701839](bugreport.cgi?bug=701839)).
Checksums-Sha1:
 05a116304df73e20148759ebfecee6f9dfe96725 2589 sudo_1.8.5p2-1+nmu1.dsc
 2052bd6151dc62d71715762e6a192df404a9235f 26822 sudo_1.8.5p2-1+nmu1.debian.tar.gz
 b47bb046d0fa4ce2c1743c1e45e9d42a6c5251c4 842220 sudo_1.8.5p2-1+nmu1_amd64.deb
 cd0baf39ba2dc417d3dd4bc97e95e4732d176607 863082 sudo-ldap_1.8.5p2-1+nmu1_amd64.deb
Checksums-Sha256:
 aefcde86fe6b74b5ce1affd52b057dc68c969ced29f1292ac3a937763d2380d8 2589 sudo_1.8.5p2-1+nmu1.dsc
 15b44cd8f4542352b20629d8fe786d14d47e3b35fd86a05648658ec390423835 26822 sudo_1.8.5p2-1+nmu1.debian.tar.gz
 557c3147b18d5f09bdb60a83ad6ce30a5243d903fbad714beca233cb856cb8b2 842220 sudo_1.8.5p2-1+nmu1_amd64.deb
 545bd3a0d15ceaa9d9c71edd61f196dee0262ea762750e61ea28df32fac40259 863082 sudo-ldap_1.8.5p2-1+nmu1_amd64.deb
Files:
 0d259053017092470a1d804503ee3a42 2589 admin optional sudo_1.8.5p2-1+nmu1.dsc
 149d2138846fc7121cfcd3ff4df7fea9 26822 admin optional sudo_1.8.5p2-1+nmu1.debian.tar.gz
 3df5acae3e544aba6916085f6a169181 842220 admin optional sudo_1.8.5p2-1+nmu1_amd64.deb
 f3d220876a4edde1a03ab41d609bfda4 863082 admin optional sudo-ldap_1.8.5p2-1+nmu1_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQQcBAEBCAAGBQJRMDsnAAoJELjWss0C1vRzsYEf/2aKdfhZH9f+IzeQ0il8q8Ax
9HgqOT0uD15LWPOoy5nNNYLHACtBeuYte6l72dfDbCoUz+o220PFbhQtOoXuwAjn
wj0joyPHmiHYW4+vvRYoJ5z56UC836Hyg2FlEVVnN2f16rSrAw0XQtfkvm8B2s9N
Coosf0ue6HElezXa0uznq0F49Spv9TJ324nneslEH8uBg/1yvPp14HQs6EA+a0/W
u7IV1rxWAY+W4PD5+j5sSbOI5EiibsMPidNrrrdZkLue4RNPL8PIRguwww8A+O3a
ZuUAS6PX/8TAr345GzqyR0Navj+hnyWre+XRhXrKhMfTbV2cPwGoduRhma4XtNdw
dvElLNPtAs9xQHjJoQp9K9HTKT8OJa6kQxX4Iv4qTdkutIpEeqZ4UcW4h9802Iom
EDsTAWo6rXOdOm8ccRaNxs2xswC0GiO0pX2XbsUIsJtN7lWhG3s1sVBO9kw506CA
f4VfuU+hnvHYtUQ5xizVs6OzWGF1hu4Z/rrjxzp6rfqJJb22OuLgp8K3ZIHjsacX
WDys1nPSDflIVz4Y0YlPSXCk3qYaFKC/XZEBYPOFHBTmro6nIJfa9aZpmDYgm0jE
9z3qtE1whV4O+7bEZcl/LyKHqQO2GsPZEZl0GWolSnAsIUXZDS7TYY7UVXmOIcFY
b0Lqtr+/Zkzi+sULl7vB1rrOzEGYhQ3Yb9qu+V7VoGGt1HhVwphzcvuiMmcGVswu
pAsgTUpvwRy4NKxxRwjRm27dyBtOLT8p8Xq66okF5EgGnRezbqiZFDUvO5VEQM/G
+YIB/brpKD4YkuQb2zdXAu31oPRNIKFy6Abs1R1aFMVNnY56cgy1G6zPezmdHgwu
irLLGKU7RB6VENJdncn28sdiXDgBFchFHRERinGutRqZCzPjSe2Omvsf9Q4CuqAx
s8WgLnFGYCCQG62a8cmqr+DcUuhu5+oaSUrMWJVsyJ2KmBbgHt7J4RcsaB7IuHId
QB4ebrNvIbs7+G0Z/AG3DURFjGJSBCBglMm6qZFIuBwitj7b3qCUhTi3Bdtf1bFF
eXNSqHoF5gbXWIp6vAjmKffc0mrZTdQBXOANtxxHWS8D7nhcf95dkn8C6tDjtGKi
pX2Ab4G8CEKGdUmRvnrCqG7GkNNNNI8exTzxtwRlFqTpZwFNKQVqojvkn4elfOsl
hKmwSJWQbMnnpsRB1l7tHDRfj000dgDtXAmNNmdsaLqdeYOZ+bMS1zKHrN8iVYIu
mhuc4TT7iRtkOAeSYY7MWIV47vBRhXlAWU8UGqXzQpH2mG/Jns6aBCCiKFJCUo5Q
DUlwrsSUb7jOrPvGd/as2gKmwushPLBE37KgsNv7SuVQVne7SAPkhOUrWN1cX2k=
=pgRW
-----END PGP SIGNATURE-----

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Bdale Garbee <bdale@gag.com>`:

`Bug#701839`; Package `sudo`.
(Fri, 01 Mar 2013 06:06:04 GMT) ([full text](bugreport.cgi?bug=701839;msg=12), [mbox](bugreport.cgi?bug=701839;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Michael Gilbert <mgilbert@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Bdale Garbee <bdale@gag.com>`.
(Fri, 01 Mar 2013 06:06:04 GMT) ([full text](bugreport.cgi?bug=701839;msg=14), [mbox](bugreport.cgi?bug=701839;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 701839@bugs.debian.org ([full text](bugreport.cgi?bug=701839;msg=15), [mbox](bugreport.cgi?bug=701839;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=mgilbert%40debian.org)
From: Michael Gilbert <mgilbert@debian.org>
To: 701838@bugs.debian.org, 701839@bugs.debian.org
Subject: nmu for security issues
Date: Fri, 1 Mar 2013 01:04:11 -0500
```
[[Message part 1](bugreport.cgi?att=0;bug=701839;msg=15) (text/plain, inline)]
```
```
Hi,

I uploaded an nmu fixing the recent security issues.  Please see attached patch.

Best wishes,
Mike

```
```
[[sudo.patch](bugreport.cgi?att=1;bug=701839;filename=sudo.patch;msg=15) (application/octet-stream, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#701839`; Package `sudo`.
(Fri, 01 Mar 2013 14:27:11 GMT) ([full text](bugreport.cgi?bug=701839;msg=17), [mbox](bugreport.cgi?bug=701839;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent**
to `Bdale Garbee <bdale@gag.com>`:

Extra info received and forwarded to list.
(Fri, 01 Mar 2013 14:27:11 GMT) ([full text](bugreport.cgi?bug=701839;msg=19), [mbox](bugreport.cgi?bug=701839;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 701839@bugs.debian.org ([full text](bugreport.cgi?bug=701839;msg=20), [mbox](bugreport.cgi?bug=701839;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=bdale%40gag.com)
From: Bdale Garbee <bdale@gag.com>
To: Michael Gilbert <mgilbert@debian.org>, 701838@bugs.debian.org, 701838@bugs.debian.org, 701839@bugs.debian.org
Subject: Re: Bug#701838: nmu for security issues
Date: Fri, 01 Mar 2013 07:22:27 -0700
```
[[Message part 1](bugreport.cgi?att=0;bug=701839;msg=20) (text/plain, inline)]
```
```
Michael Gilbert <mgilbert@debian.org> writes:

> I uploaded an nmu fixing the recent security issues.  Please see
> attached patch.

Thanks.

Bdale

```
```
[[Message part 2](bugreport.cgi?att=1;bug=701839;msg=20) (application/pgp-signature, inline)]
```

---

**Reply sent**
to `Michael Gilbert <mgilbert@debian.org>`:

You have taken responsibility.
(Sun, 10 Mar 2013 17:06:13 GMT) ([full text](bugreport.cgi?bug=701839;msg=22), [mbox](bugreport.cgi?bug=701839;mbox=yes;msg=22), [link](#21)).

---

**Notification sent**
to `Nico Golde <nion@debian.org>`:

Bug acknowledged by developer.
(Sun, 10 Mar 2013 17:06:14 GMT) ([full text](bugreport.cgi?bug=701839;msg=24), [mbox](bugreport.cgi?bug=701839;mbox=yes;msg=24), [link](#23)).

---

[Message #25](#25) received at 701839-close@bugs.debian.org ([full text](bugreport.cgi?bug=701839;msg=25), [mbox](bugreport.cgi?bug=701839;mbox=yes;msg=25), reply):

![](/cgi-bin/libravatar.cgi?email=mgilbert%40debian.org)
From: Michael Gilbert <mgilbert@debian.org>
To: 701839-close@bugs.debian.org
Subject: Bug#701839: fixed in sudo 1.7.4p4-2.squeeze.4
Date: Sun, 10 Mar 2013 17:02:21 +0000
```
Source: sudo
Source-Version: 1.7.4p4-2.squeeze.4

We believe that the bug you reported is fixed in the latest version of
sudo, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 701839@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Michael Gilbert <mgilbert@debian.org> (supplier of updated sudo package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Wed, 06 Mar 2013 18:41:15 +0000
Source: sudo
Binary: sudo sudo-ldap
Architecture: source amd64
Version: 1.7.4p4-2.squeeze.4
Distribution: stable-security
Urgency: high
Maintainer: Bdale Garbee <bdale@gag.com>
Changed-By: Michael Gilbert <mgilbert@debian.org>
Description:
 sudo       - Provide limited super user privileges to specific users
 sudo-ldap  - Provide limited super user privileges to specific users
Closes: [701838](bugreport.cgi?bug=701838) [701839](bugreport.cgi?bug=701839)
Changes:
 sudo (1.7.4p4-2.squeeze.4) stable-security; urgency=high
 .
   * Fix cve-2013-1775: authentication bypass when the clock is set to the UNIX
     epoch [00:00:00 UTC on 1 January 1970] (closes: #[701838](bugreport.cgi?bug=701838)).
   * Fix cve-2013-1776: session id hijacking from another authorized tty
     (closes: #[701839](bugreport.cgi?bug=701839)).
Checksums-Sha1:
 38d3ef0ea1632746b4cdba65c23f2bfbd8ee0741 2409 sudo_1.7.4p4-2.squeeze.4.dsc
 45b34139fb11e054c139e8cd490b66f1ab4310b3 26820 sudo_1.7.4p4-2.squeeze.4.debian.tar.gz
 2787aff0d629ca809a5c8379363e973c53ab4b86 610580 sudo_1.7.4p4-2.squeeze.4_amd64.deb
 7835c2b5dcac20992edc5f1a34e5770402f07052 636122 sudo-ldap_1.7.4p4-2.squeeze.4_amd64.deb
Checksums-Sha256:
 0c3296d2b60c8714c8ce05da7fe16cdd93fa9d1f8dfa77dac335eb50474742fd 2409 sudo_1.7.4p4-2.squeeze.4.dsc
 2f5ecd85e449c578358d08cfaf720a38a2a1a7d1b5b98588a4d37c806358eee9 26820 sudo_1.7.4p4-2.squeeze.4.debian.tar.gz
 897938338ce027885bfdd01bf1fe14b69fad88df9b06a6452ebd443a34d890b0 610580 sudo_1.7.4p4-2.squeeze.4_amd64.deb
 e29664e57d452a062b93b82c803176ec050a862ed346c5b59e09e92a37792dc8 636122 sudo-ldap_1.7.4p4-2.squeeze.4_amd64.deb
Files:
 8d68f623c42268605baabe3b56e5f0f9 2409 admin optional sudo_1.7.4p4-2.squeeze.4.dsc
 339ce612cd70937d3658c9e2b76f6424 26820 admin optional sudo_1.7.4p4-2.squeeze.4.debian.tar.gz
 07c29e218682def30096615f476f7ba2 610580 admin optional sudo_1.7.4p4-2.squeeze.4_amd64.deb
 80d0993d6602ea0469407f2a04959fc9 636122 admin optional sudo-ldap_1.7.4p4-2.squeeze.4_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iQQcBAEBAgAGBQJRN5U9AAoJELjWss0C1vRzBQYf/iy2W3WlxDrw3b5ulsdn6bpI
DBraaNIhGTdmQGHjcHnh02Rnnxz8Zsa7AYR2tAt01kDrRYZEW2D3ue+5+3baaS0k
pOUEmT+S7SNYUcIpL4sg2z/kRTZvbLZaFKcED7em8LiTp52FZbFBoGTB4jWqGe3s
MGfgdd5bR/HO/qk4rB5q6bW4NJNg6QJ4X7RkbXkfbeuUERh1ALJ4DJdejI7sS97f
NGD2wVtOdK6r0MiclBnihZfKcm/W4ahKR6JY02PRMiQiIMmb2IgJ+t2wW7L3QluL
/s7OLFEUZq51mfah85/IGvQJc1B7eC+Rq/Q+4d6i/1MXOia5dhVqVAP8SxBluTor
iAxITezIRJD6vM6nV2Hd+YjwhE7yb4OAuiaZqz5nQx7ppykOWvzUqT11KFuLTBw1
RfUC4aJbJwRK5CfKvBoWopXc/ujlGOhrPxHyEKbGzYLHsWVmPY1+Q0JoD9dp2hhB
HYHTdgvHFv3qr6OgtxnWcYk7MbiwjLd0lH8nhST8uDBk+jlV9+nTyRHN2Nbjg6DZ
0hLQ87pHRRt54cjpfhp2kVDFkEpAmeGsNo0hoC5+A9PWaen0Gfd2ALoDncfRtAWC
RFnRZ+HC/x8KG5sYfl8By1gvwvU+c69ba0iYTHN8/YY5ajUBdPc1X9oFbsSH8TMY
lG7wBdjjUu4mQkDM7RK7gbGHY8uH2+sA0z7osEPy7TPgvetD3v05GuuJPRwv7RxR
0X19QnIhK6uDcV7FI/NewEoq73Wdclpuxdjp0ODFlhpVPq2ZSI7V68stARhOEAaH
bv/IhFre8AJaRA2/9nIqySOm3bdWPeQ3DxECjheLtfCN6fcpSIxr/NrraCFytmY8
OKIFPJEaTxGSkVUBRq/WzxqXJ6t1jmYr1UaqezB2MnTeDyU69as1ZZqQ2F2OBoYz
/mCpuZ1RxDa90gDS5W6VsrO9NaT53kNAiHBd0Ck5aTrcbBmzdXjEMXR0NCeYSn2+
VZ25wmNvrgtrVmL/KKVr2doDFNMeiR119LFKXn7+6ZST0l5DuvSNIVtr51egDDn4
dh7qs3GHE00NCNfW2rMwLec21+LMihwj+65Hto6VV1J6Q5dsw8tpWFuxDl8YiuLr
Rmu1hi//JdCah62a9h9sKJkELqZHpR7yQt/Vu4/0j8LoUkEUds49hmd/e5fqeUY+
YZ4KMd13QexhaYE1kg26v91d9dbiiPv8n4OIIvkq3PKV5HoRJgvFLsRnnhTgTVyu
L3bHb4kfPu66j97EL7hAiKQq7H+BevwnqYbjy5C4gjBcoB1wP+HPJl6b8w+lLD8F
s8vxcmCyvJUHrwgiW0SvsI90CvjCYQx0I9Gc+EnIwiY2150cifJbKJQdTeYzFwk=
=bZxh
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Mon, 08 Apr 2013 07:26:16 GMT) ([full text](bugreport.cgi?bug=701839;msg=27), [mbox](bugreport.cgi?bug=701839;mbox=yes;msg=27), [link](#26)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=701839).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 19:55:31 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from bugzilla.redhat.com_2d22f93c_20250126_113157.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D916365)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D916365)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D916365)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 916365

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 916365**](show_bug.cgi?id=916365)
(CVE-2013-1776)
- [CVE-2013-1776](https://access.redhat.com/security/cve/CVE-2013-1776) sudo: bypass of tty\_tickets constraints

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2013-1776 sudo: bypass of tty\_tickets constraints

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2013-1776 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [916367](show_bug.cgi?id=916367 "CLOSED ERRATA - CVE-2013-1775 CVE-2013-1776 sudo various flaws [fedora-all]") [968221](show_bug.cgi?id=968221) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [916366](show_bug.cgi?id=916366) [952520](show_bug.cgi?id=952520) | | TreeView+ | [depends on](buglist.cgi?bug_id=916365&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=916365&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2013-02-27 22:44 UTC by Vincent Danen | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-17 07:59 UTC ([History](show_activity.cgi?id=916365)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  dapospis dkopecek huzaifas kzak | | Fixed In Version: | sudo 1.8.5, sudo 1.7.10 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2013-10-01 04:59:23 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2013:1353](https://access.redhat.com/errata/RHSA-2013%3A1353) | 0 | normal | SHIPPED\_LIVE | Low: sudo security and bug fix update | 2013-10-01 00:31:10 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=916365#c0)  Vincent Danen    2013-02-27 22:44:01 UTC  ``` From the upstream advisory:  When a user successfully authenticates with sudo, a time stamp file is updated to allow that user to continue running sudo without requiring a password for a preset time period (five minutes by default). This time stamp file can either be common to all of a user's terminals, or it can be specific to the particular terminal the user authenticated themselves on. The terminal-specific time stamp file behavior can be controlled using the "tty_tickets" option in the sudoers file. This option has been enabled by default since sudo 1.7.4. Prior to sudo 1.7.4, the default was to use a single time stamp for all the user's sessions.  A vulnerability exists because the user can control which terminal the standard input, output and error file descriptors (0-2) refer to. A malicious user could use this to run commands via sudo without authenticating, so long as there exists a terminal the user has access to where a sudo command was successfully run by that same user within the password timeout period (usually five minutes).  The vulnerability does not permit a user to run commands other than those allowed by the sudoers policy.  This affects versions 1.3.5 through up to the fixed 1.7.10p6 version, and sudo 1.8.0 through to the fixed 1.8.7p7.  The fix for 1.7.x: <http://www.sudo.ws/repos/sudo/rev/0c0283d1fafa>  The fix for 1.8.x: <http://www.sudo.ws/repos/sudo/rev/049a12a5cc14>   External References:  <http://www.sudo.ws/sudo/alerts/tty_tickets.html>   ```  [Comment 1](show_bug.cgi?id=916365#c1)  Vincent Danen    2013-02-27 22:47:57 UTC  ``` Created sudo tracking bugs for this issue  Affects: fedora-all [[bug 916367](show_bug.cgi?id=916367 "CLOSED ERRATA - CVE-2013-1775 CVE-2013-1776 sudo various flaws [fedora-all]")]   ```  [Comment 3](show_bug.cgi?id=916365#c3)  Fedora Update System    2013-03-16 01:22:29 UTC  ``` sudo-1.8.6p7-1.fc18 has been pushed to the Fedora 18 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 5](show_bug.cgi?id=916365#c5)  Fedora Update System    2013-03-19 20:04:45 UTC  ``` sudo-1.8.6p7-1.fc17 has been pushed to the Fedora 17 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 6](show_bug.cgi?id=916365#c6)  Vincent Danen    2013-04-08 22:43:05 UTC  ``` Common Vulnerabilities and Exposures assigned an identifier [CVE-2013-1776](https://access.redhat.com/security/cve/CVE-2013-1776) to the following vulnerability:  Name: [CVE-2013-1776](https://access.redhat.com/security/cve/CVE-2013-1776) URL: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1776> Assigned: 20130219 Reference: <http://www.openwall.com/lists/oss-security/2013/02/27/31> Reference: <http://www.sudo.ws/repos/sudo/rev/632f8e028191> Reference: <http://www.sudo.ws/repos/sudo/rev/6b22be4d09f0> Reference: <http://www.sudo.ws/sudo/alerts/tty_tickets.html> Reference: <http://www.securityfocus.com/bid/58207>  sudo 1.3.5 through 1.7.10 and 1.8.0 through 1.8.5, when the tty_tickets option is enabled, does not properly validate the controlling terminal device, which allows local users with sudo permissions to hijack the authorization of another terminal via vectors related to connecting to a standard input, output, and error file descriptors of another terminal.  NOTE: this is one of three closely-related vulnerabilities that were originally assigned [CVE-2013-1776](https://access.redhat.com/security/cve/CVE-2013-1776), but they have been SPLIT because of different affected versions.  See [bug #949751](show_bug.cgi?id=949751 "CLOSED ERRATA - CVE-2013-2776 sudo: bypass of tty_tickets constraints") for [CVE-2013-2776](https://access.redhat.com/security/cve/CVE-2013-2776) and [bug #949753](show_bug.cgi?id=949753 "CLOSED ERRATA - CVE-2013-2777 sudo: bypass of tty_tickets constraints") for [CVE-2013-2777](https://access.redhat.com/security/cve/CVE-2013-2777)   ```  [Comment 14](show_bug.cgi?id=916365#c14)  Huzaifa S. Sidhpurwala    2013-09-30 03:46:57 UTC  ``` This issue has been addressed in following products:    Red Hat Enterprise Linux 6  Via RHBA-2013:0363 <https://rhn.redhat.com/errata/RHBA-2013-0363.html>   ```  [Comment 15](show_bug.cgi?id=916365#c15)  errata-xmlrpc    2013-10-01 00:29:34 UTC  ``` This issue has been addressed in following products:    Red Hat Enterprise Linux 5  Via RHSA-2013:1353 <https://rhn.redhat.com/errata/RHSA-2013-1353.html>   ```  [Comment 16](show_bug.cgi?id=916365#c16)  Huzaifa S. Sidhpurwala    2013-10-01 04:56:58 UTC  ``` This issue has been classified as low security impact, because of the following reasons.  1. A user already needs to have sudo access on the target machine.  2. Successful exploitation of this issue, only results in bypass of sudo cache credential timeout, it does not provide any additional privileges to the attacker.   ```  [Comment 17](show_bug.cgi?id=916365#c17)  Huzaifa S. Sidhpurwala    2013-10-01 04:59:23 UTC  ``` Statement:  (none)   ```  [Comment 18](show_bug.cgi?id=916365#c18)  Tomas Hoger    2013-10-09 21:06:07 UTC  ``` This CVE was assigned to the issue that allowed bypassing tty_tickets restriction by opening another terminal device and connecting it to stdin/stdout/stderr.  To address the bypass, sudo was modified to extract tty information from /proc.  The fix was implemented in sudo versions 1.8.5 and 1.7.10.  However, the fix could still allow fall back to use stdin/stdout/stderr check in certain cases.  Another way to bypass that check was discovered later and what [CVE-2013-2777](https://access.redhat.com/security/cve/CVE-2013-2777) ([bug 949753](show_bug.cgi?id=949753 "CLOSED ERRATA - CVE-2013-2777 sudo: bypass of tty_tickets constraints")) was assigned to.  This issue was already fixed in Red Hat Enterprise Linux 6 packages when they were rebased form 1.7.4p5 to 1.8.6p3 in RHBA-2013:0363 in Red Hat Enterprise Linux 6.4.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=916365&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.oracle.com_e3db0c1b_20250125_195555.html ===


* [Skip to content](#maincontent)
* [Accessibility Policy](https://www.oracle.com/corporate/accessibility/)

Products
Industries
Resources
Customers
Partners
Developers
Company

Close Search

Search Oracle.com

* QUICK LINKS
* [Oracle Cloud Infrastructure](/cloud/)
* [Oracle Fusion Cloud Applications](/applications/)
* [Oracle Database](/database/technologies/)
* [Download Java](/java/technologies/downloads/)
* [Careers at Oracle](/careers/)

Search

[Country
![]()](/countries-list.html#countries)

View Accounts

Back
Cloud Account
[Sign in to Cloud](/cloud/sign-in.html)
[Sign Up for Free Cloud Tier](/cloud/free/)

Oracle Account

* [Sign-In](https://www.oracle.com/webapps/redirect/signon?nexturl=)
* [Create an Account](https://profile.oracle.com/myprofile/account/create-account.jspx)

* [Help](/corporate/contact/help.html)
* Sign Out

[Contact Sales](/corporate/contact/ "Contact Sales")

[Menu

Menu](/global-menu-v2/)

* [Security Alerts](/security-alerts/)

# Oracle VM Server for x86 Bulletin - July 2016

## Oracle VM Server for x86 Bulletin - July 2016

### Description

The Oracle VM Server for x86 Bulletin lists all CVEs that had been resolved and announced in Oracle VM Server for x86 Security Advisories (OVMSA) in the last one month prior to the release of the bulletin. Oracle VM Server for x86 Bulletins are published on the same day as Oracle Critical Patch Updates are released. These bulletins will also be updated for the following two months after their release (i.e., the two months between the normal quarterly Critical Patch Update publication dates) to cover all CVEs that had been resolved in those two months following the bulletin's publication. In addition, Oracle VM Server for x86 Bulletins may also be updated for vulnerability fixes deemed too critical to wait for the next scheduled bulletin publication date.

**Due to the threat posed by a successful attack, Oracle strongly recommends that customers apply Oracle VM Server for x86 Bulletin fixes as soon as possible.**

### Patch Availability

Please see ULN Advisory [http://linux.oracle.com/ovm-bulletin-pad](//linux.oracle.com/ovm-bulletin-pad)

### Oracle VM Server for x86 Bulletin Schedule

Oracle VM Server for x86 Bulletins are released on the Tuesday closest to the 17th day of January, April, July and October. The next four dates are:

* 18 October 2016
* 17 January 2017
* 18 April 2017
* 18 July 2017

### References

* Oracle Critical Patch Updates and Security Alerts main page  [ [Oracle Technology Network](/security-alerts/) ]
* CVRF XML version of the risk matrix   [ [Oracle Technology Network](//www.oracle.com/ocom/groups/public/%40otn/documents/webcontent/3090556.xml) ]
* Oracle Critical Patch Updates and Security Alerts - Frequently Asked Questions [ [CPU FAQ](/security-alerts/cpufaq.html) ]
* Risk Matrix definitions   [ [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html) ]
* Use of Common Vulnerability Scoring System (CVSS) by Oracle   [ [Oracle CVSS Scoring](/security-alerts/cvssscoringsystem.html) ]

### Modification History

| 2016-September-19 | Rev 3. New CVEs added. |
| --- | --- |
| 2016-August-19 | Rev 2. New CVEs added. |
| 2016-July-19 | Rev 1. Initial Release |

### Oracle VM Server for x86 Executive Summary

This Oracle VM Server for x86 Bulletin contains 125 new security fixes for the Oracle VM Server for x86. 86 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without the need for a username and password.

### Oracle VM Server for x86 Risk Matrix

#### Revision 3: Published on 2016-09-19

| CVE# | Product | Component | Remote Exploit without Auth.? | CVSS VERSION 2.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | Supported Versions Affected |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Access Vector | Access Complexity | Authen­tication | Confid­entiality | Inte­grity | Avail­ability |
| CVE-2016-7154 | Oracle VM Server for x86 | xen | No | 8.3 | Adjacent network | Low | None | Complete | Complete | Complete | 3.4 |
| CVE-2016-7092 | Oracle VM Server for x86 | xen | Yes | 0.0 | Network | Undefined | None | None | None | None | 3.2,3.3,3.4 |
| CVE-2016-7094 | Oracle VM Server for x86 | xen | Yes | 0.0 | Network | Undefined | None | None | None | None | 3.2,3.3,3.4 |

#### Revision 2: Published on 2016-08-19

| CVE# | Product | Component | Remote Exploit without Auth.? | CVSS VERSION 2.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | Supported Versions Affected |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Access Vector | Access Complexity | Authen­tication | Confid­entiality | Inte­grity | Avail­ability |
| CVE-2015-8550 | Oracle VM Server for x86 | xen | No | 7.4 | Adjacent network | Medium | Single | Complete | Complete | Complete | 3.3 |
| CVE-2016-4470 | Oracle VM Server for x86 | Unbreakable Enterprise kernel | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 3.3,3.4 |
| CVE-2015-7554 | Oracle VM Server for x86 | libtiff | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.3,3.4 |
| CVE-2015-8784 | Oracle VM Server for x86 | libtiff | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.3,3.4 |
| CVE-2016-3632 | Oracle VM Server for x86 | libtiff | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.3,3.4 |
| CVE-2016-3945 | Oracle VM Server for x86 | libtiff | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.3,3.4 |
| CVE-2016-3990 | Oracle VM Server for x86 | libtiff | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.3,3.4 |
| CVE-2016-3991 | Oracle VM Server for x86 | libtiff | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.3,3.4 |
| CVE-2016-5320 | Oracle VM Server for x86 | libtiff | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.3,3.4 |
| CVE-2016-3710 | Oracle VM Server for x86 | xen | No | 6.5 | Adjacent network | High | Single | Complete | Complete | Complete | 3.3,3.4 |
| CVE-2015-8660 | Oracle VM Server for x86 | Unbreakable Enterprise kernel | No | 6.0 | Local | High | Single | Complete | Complete | Complete | 3.4 |
| CVE-2016-4962 | Oracle VM Server for x86 | xen | No | 6.0 | Network | Medium | Single | Partial | Partial | Partial | 3.3,3.4 |
| CVE-2016-6258 | Oracle VM Server for x86 | xen | No | 6.0 | Network | Medium | Single | Partial | Partial | Partial | 3.2,3.3,3.4 |
| CVE-2016-5696 | Oracle VM Server for x86 | Unbreakable Enterprise kernel | Yes | 5.8 | Network | Medium | None | None | Partial | Partial | 3.3,3.4 |
| CVE-2014-9655 | Oracle VM Server for x86 | libtiff | Yes | 5.8 | Network | Medium | None | Partial | None | Partial | 3.3,3.4 |
| CVE-2015-1547 | Oracle VM Server for x86 | libtiff | Yes | 5.8 | Network | Medium | None | None | Partial | Partial | 3.3,3.4 |
| CVE-2016-3960 | Oracle VM Server for x86 | xen | No | 5.8 | Adjacent network | Medium | Single | None | Partial | Complete | 3.2,3.3,3.4 |
| CVE-2014-3672 | Oracle VM Server for x86 | xen | No | 5.2 | Adjacent network | Medium | Single | None | None | Complete | 3.2,3.3,3.4 |
| CVE-2016-2270 | Oracle VM Server for x86 | xen | No | 5.2 | Adjacent network | Medium | Single | None | None | Complete | 3.4 |
| CVE-2016-1000110 | Oracle VM Server for x86 | python | Yes | 5.0 | Network | Low | None | None | Partial | None | 3.3,3.4 |
| CVE-2016-6197 | Oracle VM Server for x86 | kernel-uek | No | 4.7 | Local | Medium | None | None | None | Complete | 3.4 |
| CVE-2016-6198 | Oracle VM Server for x86 | kernel-uek | No | 4.7 | Local | Medium | None | None | None | Complete | 3.4 |
| CVE-2014-9330 | Oracle VM Server for x86 | libtiff | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.3,3.4 |
| CVE-2015-8665 | Oracle VM Server for x86 | libtiff | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.3,3.4 |
| CVE-2015-8668 | Oracle VM Server for x86 | libtiff | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.3,3.4 |
| CVE-2015-8683 | Oracle VM Server for x86 | libtiff | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.3,3.4 |
| CVE-2015-8781 | Oracle VM Server for x86 | libtiff | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.3,3.4 |
| CVE-2015-8782 | Oracle VM Server for x86 | libtiff | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.3,3.4 |
| CVE-2015-8783 | Oracle VM Server for x86 | libtiff | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.3,3.4 |
| CVE-2016-4480 | Oracle VM Server for x86 | xen | No | 4.3 | Adjacent network | High | None | Partial | Partial | Partial | 3.2,3.3,3.4 |
| CVE-2016-3158 | Oracle VM Server for x86 | xen | No | 3.8 | Adjacent network | Medium | Single | Partial | Partial | None | 3.3,3.4 |
| CVE-2016-3159 | Oracle VM Server for x86 | xen | No | 3.8 | Adjacent network | Medium | Single | Partial | Partial | None | 3.3,3.4 |
| CVE-2016-3712 | Oracle VM Server for x86 | xen | No | 3.8 | Adjacent network | Medium | Single | Partial | None | Partial | 3.3,3.4 |
| CVE-2014-8127 | Oracle VM Server for x86 | libtiff | No | 3.6 | Local | Low | None | Partial | None | Partial | 3.3,3.4 |
| CVE-2014-8129 | Oracle VM Server for x86 | libtiff | No | 3.6 | Local | Low | None | Partial | None | Partial | 3.3,3.4 |
| CVE-2016-2117 | Oracle VM Server for x86 | kernel-uek | Yes | 2.6 | Network | High | None | Partial | None | None | 3.3,3.4 |
| CVE-2016-5403 | Oracle VM Server for x86 | qemu-kvm | No | 2.3 | Adjacent network | Medium | Single | None | None | Partial | 3.4 |
| CVE-2014-8130 | Oracle VM Server for x86 | libtiff | No | 2.1 | Local | Low | None | None | None | Partial | 3.3,3.4 |

#### Revision 1: Published on 2016-07-19

| CVE# | Product | Component | Remote Exploit without Auth.? | CVSS VERSION 2.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | Supported Versions Affected |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Access Vector | Access Complexity | Authen­tication | Confid­entiality | Inte­grity | Avail­ability |
| CVE-2013-6435 | Oracle VM Server for x86 | rpm | Yes | 7.6 | Network | High | None | Complete | Complete | Complete | 3.2 |
| CVE-2013-0292 | Oracle VM Server for x86 | dbus-glib | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 3.2 |
| CVE-2016-4565 | Oracle VM Server for x86 | kernel-uek | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 3.2 |
| CVE-2016-4565 | Oracle VM Server for x86 | kernel-uek | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 3.3,3.4 |
| CVE-2013-2174 | Oracle VM Server for x86 | curl | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.2 |
| CVE-2016-1834 | Oracle VM Server for x86 | libxml2 | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.3,3.4 |
| CVE-2013-5605 | Oracle VM Server for x86 | nspr | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.2 |
| CVE-2014-1544 | Oracle VM Server for x86 | nspr | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.2 |
| CVE-2015-7181 | Oracle VM Server for x86 | nspr | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.2 |
| CVE-2015-7182 | Oracle VM Server for x86 | nspr | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.2 |
| CVE-2015-7183 | Oracle VM Server for x86 | nspr | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.2 |
| CVE-2013-5605 | Oracle VM Server for x86 | nss | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.2 |
| CVE-2014-1544 | Oracle VM Server for x86 | nss | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.2 |
| CVE-2015-7181 | Oracle VM Server for x86 | nss | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.2 |
| CVE-2015-7182 | Oracle VM Server for x86 | nss | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.2 |
| CVE-2015-7183 | Oracle VM Server for x86 | nss | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.2 |
| CVE-2016-1950 | Oracle VM Server for x86 | nss | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.2 |
| CVE-2012-0060 | Oracle VM Server for x86 | rpm | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.2 |
| CVE-2012-0061 | Oracle VM Server for x86 | rpm | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.2 |
| CVE-2012-0815 | Oracle VM Server for x86 | rpm | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 3.2 |
| CVE-2014-0106 | Oracle VM Server for x86 | sudo | No | 6.6 | Local | Medium | Single | Complete | Complete | Complete | 3.2 |
| CVE-2015-7504 | Oracle VM Server for x86 | xen | No | 6.5 | Adjacent network | High | Single | Complete | Complete | Complete | 3.2 |
| CVE-2015-8554 | Oracle VM Server for x86 | xen | No | 6.5 | Adjacent network | High | Single | Complete | Complete | Complete | 3.2 |
| CVE-2016-3710 | Oracle VM Server for x86 | xen | No | 6.5 | Adjacent network | High | Single | Complete | Complete | Complete | 3.2 |
| CVE-2014-1568 | Oracle VM Server for x86 | nss | Yes | 5.8 | Network | Medium | None | Partial | Partial | None | 3.2 |
| CVE-2015-3197 | Oracle VM Server for x86 | openssl | Yes | 5.8 | Network | Medium | None | Partial | Partial | None | 3.2 |
| CVE-2016-0800 | Oracle VM Server for x86 | openssl | Yes | 5.8 | Network | Medium | None | Partial | Partial | None | 3.2 |
| CVE-2012-3440 | Oracle VM Server for x86 | sudo | No | 5.6 | Local | High | None | None | Complete | Complete | 3.2 |
| CVE-2015-5307 | Oracle VM Server for x86 | xen | No | 5.2 | Adjacent network | Medium | Single | None | None | Complete | 3.2 |
| CVE-2015-8104 | Oracle VM Server for x86 | xen | No | 5.2 | Adjacent network | Medium | Single | None | None | Complete | 3.2 |
| CVE-2016-2270 | Oracle VM Server for x86 | xen | No | 5.2 | Adjacent network | Medium | Single | None | None | Complete | 3.2 |
| CVE-2016-1840 | Oracle VM Server for x86 | libxml2 | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 3.3,3.4 |
| CVE-2016-4448 | Oracle VM Server for x86 | libxml2 | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 3.3,3.4 |
| CVE-2013-1620 | Oracle VM Server for x86 | nspr | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 3.2 |
| CVE-2016-1978 | Oracle VM Server for x86 | nspr | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 3.2 |
| CVE-2016-1979 | Oracle VM Server for x86 | nspr | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 3.2 |
| CVE-2013-1620 | Oracle VM Server for x86 | nss | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 3.2 |
| CVE-2014-1490 | Oracle VM Server for x86 | nss | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 3.2 |
| CVE-2014-1545 | Oracle VM Server for x86 | nss | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 3.2 |
| CVE-2015-2721 | Oracle VM Server for x86 | nss | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 3.2 |
| CVE-2016-1978 | Oracle VM Server for x86 | nss | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 3.2 |
| CVE-2016-1979 | Oracle VM Server for x86 | nss | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 3.2 |
| CVE-2016-2105 | Oracle VM Server for x86 | openssl | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 3.2 |
| CVE-2016-2106 | Oracle VM Server for x86 | openssl | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 3.2 |
| CVE-2012-5195 | Oracle VM Server for x86 | perl | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 3.2 |
| CVE-2012-6329 | Oracle VM Server for x86 | perl | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 3.2 |
| CVE-2012-5166 | Oracle VM Server for x86 | bind | Yes | 5.0 | Network | Low | None | None | None | Partial | 3.2 |
| CVE-2014-8500 | Oracle VM Server for x86 | bind | Yes | 5.0 | Network | Low | None | None | None | Partial | 3.2 |
| CVE-2015-5477 | Oracle VM Server for x86 | bind | Yes | 5.0 | Network | Low | None | None | None | Partial | 3.2 |
| CVE-2015-5722 | Oracle VM Server for x86 | bind | Yes | 5.0 | Network | Low | None | None | None | Partial | 3.2 |
| CVE-2016-1285 | Oracle VM Server for x86 | bind | Yes | 5.0 | Network | Low | None | None | None | Partial | 3.2 |
| CVE-2016-1286 | Oracle VM Server for x86 | bind | Yes | 5.0 | Network | Low | None | None | None | Partial | 3.2 |
| CVE-2015-6908 | Oracle VM Server for x86 | openldap | Yes | 5.0 | Network | Low | None | None | None | Partial | 3.2 |
| CVE-2013-1667 | Oracle VM Server for x86 | perl | Yes | 5.0 | Network | Low | None | None | None | Partial | 3.2 |
| CVE-2016-3115 | Oracle VM Server for x86 | openssh | No | 4.9 | Network | Medium | Single | Partial | Partial | None | 3.2 |
| CVE-2011-4339 | Oracle VM Server for x86 | OpenIPMI | No | 4.7 | Local | Medium | None | None | None | Complete | 3.2 |
| CVE-2015-8000 | Oracle VM Server for x86 | bind | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.2 |
| CVE-2013-1944 | Oracle VM Server for x86 | curl | Yes | 4.3 | Network | Medium | None | None | Partial | None | 3.2 |
| CVE-2014-3660 | Oracle VM Server for x86 | libxml2 | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.2 |
| CVE-2016-1762 | Oracle VM Server for x86 | libxml2 | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.3,3.4 |
| CVE-2016-1833 | Oracle VM Server for x86 | libxml2 | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.3,3.4 |
| CVE-2016-1835 | Oracle VM Server for x86 | libxml2 | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.3,3.4 |
| CVE-2016-1836 | Oracle VM Server for x86 | libxml2 | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.3,3.4 |
| CVE-2016-1837 | Oracle VM Server for x86 | libxml2 | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.3,3.4 |
| CVE-2016-1838 | Oracle VM Server for x86 | libxml2 | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.3,3.4 |
| CVE-2016-1839 | Oracle VM Server for x86 | libxml2 | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.3,3.4 |
| CVE-2016-3627 | Oracle VM Server for x86 | libxml2 | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.3,3.4 |
| CVE-2016-3705 | Oracle VM Server for x86 | libxml2 | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.3,3.4 |
| CVE-2016-4447 | Oracle VM Server for x86 | libxml2 | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.3,3.4 |
| CVE-2016-4449 | Oracle VM Server for x86 | libxml2 | Yes | 4.3 | Network | Medium | None | None | Partial | None | 3.3,3.4 |
| CVE-2012-0441 | Oracle VM Server for x86 | nspr | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.2 |
| CVE-2013-0791 | Oracle VM Server for x86 | nspr | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.2 |
| CVE-2013-1739 | Oracle VM Server for x86 | nspr | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.2 |
| CVE-2013-1741 | Oracle VM Server for x86 | nspr | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.2 |
| CVE-2013-5606 | Oracle VM Server for x86 | nspr | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.2 |
| CVE-2013-5607 | Oracle VM Server for x86 | nspr | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.2 |
| CVE-2012-0441 | Oracle VM Server for x86 | nss | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.2 |
| CVE-2013-0791 | Oracle VM Server for x86 | nss | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.2 |
| CVE-2013-1739 | Oracle VM Server for x86 | nss | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.2 |
| CVE-2013-1740 | Oracle VM Server for x86 | nss | Yes | 4.3 | Network | Medium | None | Partial | None | None | 3.2 |
| CVE-2013-1741 | Oracle VM Server for x86 | nss | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.2 |
| CVE-2013-5606 | Oracle VM Server for x86 | nss | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.2 |
| CVE-2013-5607 | Oracle VM Server for x86 | nss | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.2 |
| CVE-2014-1491 | Oracle VM Server for x86 | nss | Yes | 4.3 | Network | Medium | None | Partial | None | None | 3.2 |
| CVE-2015-2730 | Oracle VM Server for x86 | nss | Yes | 4.3 | Network | Medium | None | Partial | None | None | 3.2 |
| CVE-2013-4449 | Oracle VM Server for x86 | openldap | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.2 |
| CVE-2015-5600 | Oracle VM Server for x86 | openssh | Yes | 4.3 | Network | Medium | None | None | Partial | None | 3.2 |
| CVE-2015-3195 | Oracle VM Server for x86 | openssl | Yes | 4.3 | Network | Medium | None | Partial | None | None | 3.2 |
| CVE-2016-0797 | Oracle VM Server for x86 | openssl | Yes | 4.3 | Network | Medium | None | None | None | Partial | 3.2 |
| CVE-2013-1776 | Oracle VM Server for x86 | sudo | No | 3.6 | Local | Low | None | Partial | Partial | None | 3.2 |
| CVE-2013-2776 | Oracle VM Server for x86 | sudo | No | 3.6 | Local | Low | None | Partial | Partial | None | 3.2 |
| CVE-2015-8704 | Oracle VM Server for x86 | bind | No | 3.5 | Network | Medium | Single | None | None | Partial | 3.2 |
| CVE-2012-3571 | Oracle VM Server for x86 | dhcp | No | 3.3 | Adjacent network | Low | None | None | None | Partial | 3.2 |
| CVE-2014-1492 | Oracle VM Server for x86 | nss | Yes | 2.6 | Network | High | None | None | Partial | None | 3.2 |
| CVE-2016-0799 | Oracle VM Server for x86 | openssl | Yes | 2.6 | Network | High | None | None | None | Partial | 3.2 |
| CVE-2012-5526 | Oracle VM Server for x86 | perl | Yes | 2.6 | Network | High | None | None | Partial | None | 3.2 |
| CVE-2013-1775 | Oracle VM Server for x86 | sudo | No | 2.1 | Local | Low | None | None | Partial | None | 3.2 |
| CVE-2013-4242 | Oracle VM Server for x86 | libgcrypt | No | 1.9 | Local | Medium | None | Partial | None | None | 3.2 |
| CVE-2016-2109 | Oracle VM Server for x86 | openssl | No | 1.9 | Local | Medium | None | None | None | Partial | 3.2 |
| CVE-2012-2664 | Oracle VM Server for x86 | sos | No | 1.9 | Local | Medium | None | Partial | None | None | 3.2 |
| CVE-2015-8555 | Oracle VM Server for x86 | xen | No | 1.8 | Adjacent network | High | None | Partial | None | None | 3.2 |

Resources for

* [Careers](/careers/)
* [Developers](/developer/)
* [Investors](https://investor.oracle.com/home/default.aspx)
* [Partners](/partner/)
* [Researchers](/research/)
* [Students and Educators](https://academy.oracle.com/en/oa-web-overview.html)

Why Oracle

* [Analyst Reports](/corporate/analyst-reports/)
* [Best cloud-based
  ERP](/erp/what-is-erp/best-erp/)
* [Cloud Economics](/cloud/economics/)
* [Social Impact](/social-impact/)
* [Culture and Inclusion](/careers/diversity-inclusion/)
* [Security Practices](/corporate/security-practices/)

Learn

* [What is cloud
  computing?](/cloud/what-is-cloud-computing/)
* [What is CRM?](/cx/what-is-crm/)
* [What is
  Docker?](/cloud/cloud-native/container-registry/what-is-docker/)
* [What is
  Kubernetes?](/cloud/cloud-native/kubernetes-engine/what-is-kubernetes/)
* [What is
  Python?](/developer/what-is-python-for-developers/)
* [What is SaaS?](/applications/what-is-saas/)

News and Events

* [News](/news/)
* [Oracle CloudWorld](/cloudworld/)
* [Oracle CloudWorld Tour](/cloudworld-tour/)
* [Oracle Health Summit](/health/health-summit/)
* [Oracle Dev Tour](/developer/dev-tour/)
* [Search all events](https://search.oracle.com/events?q=&lang=english)

Contact Us

* US Sales: +1.800.633.0738
* [How can we help?](/corporate/contact/)
* [Subscribe to emails](https://go.oracle.com/subscribe/?l_code=en&src1=OW:O:FO)
* [Integrity Helpline](https://secure.ethicspoint.com/domain/media/en/gui/31053/index.html)
* [Accessibility](/corporate/accessibility/)

---

* [Country/Region](/universal-menu/#u10countrymenu)

* [© 2025 Oracle](/legal/copyright/)
* [Privacy](/legal/privacy/)/[Do Not Sell My
  Info](/legal/privacy/privacy-choices/)
* [Ad
  Choices](/legal/privacy/privacy-policy/#adchoices)
* [Careers](/corporate/careers/)



=== Content from www.redhat.com_43cb12fd_20250126_113157.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.openwall.com_0c2cb3b2_20250125_195552.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](30) [[next>]](32) [[<thread-prev]](23) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <512E4AC9.20707@redhat.com>
Date: Wed, 27 Feb 2013 11:04:57 -0700
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: "Todd C. Miller" <Todd.Miller@...rtesan.com>
Subject: Re: CVE request: potential bypass of sudo tty_tickets
 constraints

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 02/27/2013 09:23 AM, Todd C. Miller wrote:
> Sudo 1.8.6p7 and 1.7.10p6 are now available which include a fix
> for the following bug:
>
> Potential bypass of sudo tty_tickets constraints
>
> Summary: When a user successfully authenticates with sudo, a time
> stamp file is updated to allow that user to continue running sudo
> without requiring a password for a preset time period (five minutes
> by default).
>
> This time stamp file can either be common to all of a user's
> terminals, or it can be specific to the particular terminal the
> user authenticated themselves on.  The terminal-specific time stamp
> file behavior can be controlled using the "tty_tickets" option in
> the sudoers file.  This option has been enabled by default since
> sudo 1.7.4.  Prior to sudo 1.7.4, the default was to use a single
> time stamp for all the user's sessions.
>
> A vulnerability exists because the user can control which terminal
> the standard input, output and error file descriptors (0-2) refer
> to.  A malicious user could use this to run commands via sudo
> without authenticating, so long as there exists a terminal the user
> has access to where a sudo command was successfully run by that
> same user within the password timeout period (usually five
> minutes).
>
> The vulnerability does not permit a user to run commands other than
> those allowed by the sudoers policy.
>
> Sudo versions affected: Sudo 1.3.5 through 1.7.10p6 and sudo 1.8.0
> through 1.8.6p7 when the "tty_tickets" option is enabled.  This
> option is enabled by default in sudo 1.7.4 and above.
>
> Details: The vulnerability can be triggered when the standard
> input, output and error file descriptors (0-2) of a process are
> closed and a different terminal device is opened and connected to
> those descriptors.  When sudo tries to determine the terminal
> device via the ttyname() function, it will get the name of the
> other terminal instead.  The core problem is that while ttyname()
> can be used to determine the name of the terminal device connected
> to a specific file descriptor, there is no portable way to
> determine the name of the terminal associated with the session the
> process belongs to.  However, on many systems it is possible to
> determine this by using the /proc file system or the sysctl()
> function.
>
> Most operating systems that have the /proc file system provide a
> way to determine the controlling terminal device number for a
> process; this information is used by the ps command for example.
> On Linux, this is the tty_nr field in /proc/self/stat (the seventh
> entry).  On systems with an SVR4-style /proc, this is the pr_ttydev
> member of struct psinfo, which comes from /proc/self/psinfo.  Most
> BSD systems that support the sysctl() function also provide a way
> to get the terminal device number via the KERN_PROC_PID sysctl.  By
> mapping this device number to a file name, it is possible to get
> the name of the terminal file without resorting to ttyname().  Sudo
> began using this method to determine the process's terminal
> starting with version 1.8.5 and 1.7.10.
>
> However, sudo still used the ttyname() function as a fall back when
> no controlling terminal was found via /proc or sysctl(). This
> allowed a malicious process to cause sudo to use ttyname() simply
> by creating a new session without a controlling tty before
> executing sudo.  In sudo 1.8.6p6 and 1.7.10p5, this fall back
> behavior was removed.  This fixed the vulnerability for systems
> where the process's controlling terminal could be determined via
> /proc or sysctl().
>
> Sudo 1.8.6p7 and 1.7.10p6 contain an additional fix for systems
> without /proc or sysctl() that stores the POSIX session ID in the
> time stamp file itself.  The controlling terminal is specific to
> the POSIX session it is associated with.  It is not possible for
> two processes in different sessions to have the same controlling
> terminal.  Sudo will now compare the current session ID with the
> one in the time stamp file and ignore the time stamp file if the
> session ID does not match.  This has the additional benefit of
> making it much less likely that a user will be able to reuse the
> time stamp file after logging out and back in again on the same
> terminal.
>
> Impact: A (potentially malicious) program run by a user with sudo
> access may be able to bypass the "tty_ticket" constraints.  In
> order for this to succeed there must exist on the machine a
> terminal device that the user has previously authenticated
> themselves on via sudo within the last time stamp timeout (5
> minutes by default).
>
> This program may use sudo's -n flag to "probe" the terminals in
> question to see if there is an active time stamp file for the user.
> Prior to sudo 1.8.6 and 1.7.10, if a password was required when the
> -n flag was specified the failure would not be logged, allowing the
> program to perform such probes without being detected.  The
> successful command (if any), would still be logged.
>
> Fix: The bug is fixed in sudo 1.8.6p7 and 1.7.10p6.
>
> Credit: Ryan Castellucci brought the initial ttyname() issue to my
> attention.  Subsequently, James Ogden discovered that using
> setsid() to create a new session would cause sudo to fall back to
> using ttyname().
>
> Other shortcomings in sudo's "tty_tickets" functionality have been
> known and discussed openly for some time.  There is a long
> discussion about them at:
> [https://bugs.launchpad.net/ubuntu/+source/sudo/+bug/87023](https://bugs.launchpad.net/ubuntu/%2Bsource/sudo/%2Bbug/87023)
>

Please use CVE-2013-1776 for this issue.

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)

iQIcBAEBAgAGBQJRLkrJAAoJEBYNRVNeJnmTMZ0P/1MWqbRiIoSjVZnhY0d7D1WJ
wLEuWu0pGLXaM55m5CNZWP8tKO675JMI9wUekD7ea5GnJ1wIyX73+1S+j6wHvPOz
r2f3fcsV73rjfDAwqysY8RHn9YLoLbvZFGZXEOtE4S5zHcvrTqbiQDFKbA5wYSnD
61WCJOBj5flrvKXUZKCcNUnyI4g49KkZ+HCuCxpD0alfsz6krxH00aKzQLZwFvtN
5tYKoMY+m0ekVjV/fIkS0KcBvyp7nUa3blLlo/sI+RC9h8APwexpX78syngqCJmf
Y2mfl/ZgBp/td0OIWJuoUqwpaigPY0Xns2EQGF3NrkAdKOKxaBR83/c+Lmv1CiEm
WpniXQvBshs+ejkTxTTTAAZLZ9WlY/WHhHsxz/lYqgReU3P2eM2GoduAOFSIm7Hd
ciSRESdM+zz4jX/tF97YExf5oufAsvaCkATJs1oy9BHeVdJ0ebf4mLAAXXCeYjLI
djldhvm8rLEvSmMpTv/q1202Hg1+2M9Z6/gN0OQITbG7dpCsCfzBpokgsEVm0zS0
bLbj44F4UO6MgEo6fgUxQI4FA/FyrBAk1GzTCmamB0xMK+AChYlGHBZ6ccO2doXd
GzhugXIZS0NrH1Dof2gYYfTYbwd6TF/K0BTLZgsauBIbkWD2B/Lfckaaj/wI9IKn
X9OMaTqpq4SI2eEQySK0
=XUiR
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.redhat.com_b18d3238_20250126_113159.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D949751)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D949751)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D949751)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 949751

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 949751**](show_bug.cgi?id=949751)
(CVE-2013-2776)
- [CVE-2013-2776](https://access.redhat.com/security/cve/CVE-2013-2776) sudo: bypass of tty\_tickets constraints

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2013-2776 sudo: bypass of tty\_tickets constraints

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2013-2776 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [968221](show_bug.cgi?id=968221) [1015355](show_bug.cgi?id=1015355) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [916366](show_bug.cgi?id=916366) [952520](show_bug.cgi?id=952520) [974906](show_bug.cgi?id=974906) | | TreeView+ | [depends on](buglist.cgi?bug_id=949751&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=949751&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2013-04-08 22:35 UTC by Vincent Danen | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-17 07:51 UTC ([History](show_activity.cgi?id=949751)) | | [CC List:](page.cgi?id=fields.html#cclist) | 2 users (show)  dkopecek kzak | | Fixed In Version: | sudo 1.8.6p7, sudo 1.7.10p6 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2013-11-22 05:36:34 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2013:1353](https://access.redhat.com/errata/RHSA-2013%3A1353) | 0 | normal | SHIPPED\_LIVE | Low: sudo security and bug fix update | 2013-10-01 00:31:10 UTC | | Red Hat Product Errata | [RHSA-2013:1701](https://access.redhat.com/errata/RHSA-2013%3A1701) | 0 | normal | SHIPPED\_LIVE | Low: sudo security, bug fix and enhancement update | 2013-11-20 21:52:06 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=949751#c0)  Vincent Danen    2013-04-08 22:35:39 UTC  ``` Common Vulnerabilities and Exposures assigned an identifier [CVE-2013-2776](https://access.redhat.com/security/cve/CVE-2013-2776) to the following vulnerability:  Name: [CVE-2013-2776](https://access.redhat.com/security/cve/CVE-2013-2776) URL: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2776> Assigned: 20130408 Reference: <http://www.openwall.com/lists/oss-security/2013/02/27/31> Reference: [https://bugzilla.redhat.com/show_bug.cgi?id=916365](show_bug.cgi?id=916365 "CLOSED ERRATA - CVE-2013-1776 sudo: bypass of tty_tickets constraints") Reference: <http://www.sudo.ws/repos/sudo/rev/049a12a5cc14> Reference: <http://www.sudo.ws/repos/sudo/rev/0c0283d1fafa> Reference: <http://www.sudo.ws/sudo/alerts/tty_tickets.html> Reference: <http://www.securityfocus.com/bid/58207>  sudo 1.3.5 through 1.7.10p5 and 1.8.0 through 1.8.6p6, when running on systems without /proc or the sysctl function with the tty_tickets option enabled, does not properly validate the controlling terminal device, which allows local users with sudo permissions to hijack the authorization of another terminal via vectors related to connecting to a standard input, output, and error file descriptors of another terminal.  NOTE: this is one of three closely-related vulnerabilities that were originally assigned [CVE-2013-1776](https://access.redhat.com/security/cve/CVE-2013-1776), but they have been SPLIT because of different affected versions.   ```  [Comment 2](show_bug.cgi?id=949751#c2)  errata-xmlrpc    2013-10-01 00:29:41 UTC  ``` This issue has been addressed in following products:    Red Hat Enterprise Linux 5  Via RHSA-2013:1353 <https://rhn.redhat.com/errata/RHSA-2013-1353.html>   ```  [Comment 6](show_bug.cgi?id=949751#c6)  Tomas Hoger    2013-10-09 20:52:48 UTC  ``` This CVE split out of [CVE-2013-1776](https://access.redhat.com/security/cve/CVE-2013-1776) is for a sudo enhancement that makes sudo store session id in a ticket file to disallow use of the ticket by a process from a different session.   ```  [Comment 7](show_bug.cgi?id=949751#c7)  errata-xmlrpc    2013-11-21 23:12:47 UTC  ``` This issue has been addressed in following products:    Red Hat Enterprise Linux 6  Via RHSA-2013:1701 <https://rhn.redhat.com/errata/RHSA-2013-1701.html>   ```  [Comment 8](show_bug.cgi?id=949751#c8)  Huzaifa S. Sidhpurwala    2013-11-22 05:36:34 UTC  ``` Statement:  (none)   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=949751&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.slackware.com_09b1f08e_20250125_195557.html ===


| | | | **Slackware Security Advisories** | | --- | | | --- | --- | | | | [Slackware Logo](/index.html) | | --- | | | --- | --- | | | --- | --- | --- | --- | --- | --- | |  | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | | **[News](/index.php)** | | --- | | | --- | --- |  | | **[Security Advisories](/security/)** | | --- | | | --- | --- |  | | **[FAQ](/faq/) [Book](/book/) [General Info](/info/) [Get Slack](/getslack/) [Install Help](/install/) [Configuration](/config/) [Packages](/packages/) [ChangeLogs](/changelog/) [Propaganda](/~msimons/slackware/grfx/) [Ports](/ports/) [Other Sites](/links/) [Support](/support/) [Contact](/contact/) [Mailing Lists](/lists/) [About](/about/)** | | --- | | | --- | --- | |  | | | **From:** Slackware Security Team <security@slackware.com> | | --- | | | --- | --- |  | | ```  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1  [slackware-security]  sudo (SSA:2013-065-01)  New sudo packages are available for Slackware 12.1, 12.2, 13.0, 13.1, 13.37, 14.0, and -current to fix security issues.   Here are the details from the Slackware 14.0 ChangeLog: +--------------------------+ patches/packages/sudo-1.8.6p7-i486-1_slack14.0.txz:  Upgraded.   This update fixes security issues that could allow a user to run commands   without authenticating after the password timeout has already expired.   Note that the vulnerability did not permit a user to run commands other   than those allowed by the sudoers policy.   For more information, see:     http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1775     http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1776   (* Security fix *) +--------------------------+   Where to find the new packages: +-----------------------------+  Thanks to the friendly folks at the OSU Open Source Lab (http://osuosl.org) for donating FTP and rsync hosting to the Slackware project!  :-)  Also see the "Get Slack" section on http://slackware.com for additional mirror sites near you.  Updated package for Slackware 12.1: ftp://ftp.slackware.com/pub/slackware/slackware-12.1/patches/packages/sudo-1.7.10p7-i486-1_slack12.1.tgz  Updated package for Slackware 12.2: ftp://ftp.slackware.com/pub/slackware/slackware-12.2/patches/packages/sudo-1.7.10p7-i486-1_slack12.2.tgz  Updated package for Slackware 13.0: ftp://ftp.slackware.com/pub/slackware/slackware-13.0/patches/packages/sudo-1.7.10p7-i486-1_slack13.0.txz  Updated package for Slackware x86_64 13.0: ftp://ftp.slackware.com/pub/slackware/slackware64-13.0/patches/packages/sudo-1.7.10p7-x86_64-1_slack13.0.txz  Updated package for Slackware 13.1: ftp://ftp.slackware.com/pub/slackware/slackware-13.1/patches/packages/sudo-1.7.10p7-i486-1_slack13.1.txz  Updated package for Slackware x86_64 13.1: ftp://ftp.slackware.com/pub/slackware/slackware64-13.1/patches/packages/sudo-1.7.10p7-x86_64-1_slack13.1.txz  Updated package for Slackware 13.37: ftp://ftp.slackware.com/pub/slackware/slackware-13.37/patches/packages/sudo-1.7.10p7-i486-1_slack13.37.txz  Updated package for Slackware x86_64 13.37: ftp://ftp.slackware.com/pub/slackware/slackware64-13.37/patches/packages/sudo-1.7.10p7-x86_64-1_slack13.37.txz  Updated package for Slackware 14.0: ftp://ftp.slackware.com/pub/slackware/slackware-14.0/patches/packages/sudo-1.8.6p7-i486-1_slack14.0.txz  Updated package for Slackware x86_64 14.0: ftp://ftp.slackware.com/pub/slackware/slackware64-14.0/patches/packages/sudo-1.8.6p7-x86_64-1_slack14.0.txz  Updated package for Slackware -current: ftp://ftp.slackware.com/pub/slackware/slackware-current/slackware/ap/sudo-1.8.6p7-i486-1.txz  Updated package for Slackware x86_64 -current: ftp://ftp.slackware.com/pub/slackware/slackware64-current/slackware64/ap/sudo-1.8.6p7-x86_64-1.txz   MD5 signatures: +-------------+  Slackware 12.1 package: 16e47202f5cda7a372639fa6ef304974  sudo-1.7.10p7-i486-1_slack12.1.tgz  Slackware 12.2 package: 6428965e88cac3b36a84bd3b1ab361a2  sudo-1.7.10p7-i486-1_slack12.2.tgz  Slackware 13.0 package: 0251ce11992c06ba0e55a2a3f2e79d28  sudo-1.7.10p7-i486-1_slack13.0.txz  Slackware x86_64 13.0 package: 5352a19dbfdaad232573f4beb1b1237a  sudo-1.7.10p7-x86_64-1_slack13.0.txz  Slackware 13.1 package: 977a8fb54ae46ceaa037b52234f2bc2a  sudo-1.7.10p7-i486-1_slack13.1.txz  Slackware x86_64 13.1 package: 4182726dc8cb4ba5b69a46daed686d04  sudo-1.7.10p7-x86_64-1_slack13.1.txz  Slackware 13.37 package: 1af20762e5895338f38787e8f493d517  sudo-1.7.10p7-i486-1_slack13.37.txz  Slackware x86_64 13.37 package: 1af6f706de63704630087e1da3721ad7  sudo-1.7.10p7-x86_64-1_slack13.37.txz  Slackware 14.0 package: d611a1f15bb379d078e04646172a626c  sudo-1.8.6p7-i486-1_slack14.0.txz  Slackware x86_64 14.0 package: 580351ec41716ce1955468dbfaf95892  sudo-1.8.6p7-x86_64-1_slack14.0.txz  Slackware -current package: ffb4636d9f772f441925079c4312a1fc  ap/sudo-1.8.6p7-i486-1.txz  Slackware x86_64 -current package: 66fa0b6eefbd9937ce7b4ac5e8c133c6  ap/sudo-1.8.6p7-x86_64-1.txz   Installation instructions: +------------------------+  Upgrade the package as root: # upgradepkg sudo-1.8.6p7-i486-1_slack14.0.txz   +-----+  Slackware Linux Security Team http://slackware.com/gpg-key security@slackware.com  +------------------------------------------------------------------------+ | To leave the slackware-security mailing list:                          | +------------------------------------------------------------------------+ | Send an email to majordomo@slackware.com with this text in the body of | | the email message:                                                     | |                                                                        | |   unsubscribe slackware-security                                       | |                                                                        | | You will get a confirmation message back containing instructions to    | | complete the process.  Please do not reply to this email address.      | +------------------------------------------------------------------------+ -----BEGIN PGP SIGNATURE----- Version: GnuPG v1.4.12 (GNU/Linux)  iEYEARECAAYFAlE26hUACgkQakRjwEAQIjMMqQCfXKgTaYTEf59ERKeChnA+4qkX +DoAn1t4wKsy130/IMwE/24DadRmRu5q =2QeK -----END PGP SIGNATURE-----   ``` | | --- | | | --- | --- | |
|

 | | Slackware™ is a **[trademark](http://slackware.com/trademark/trademark.php)** of Patrick Volkerding. | | --- | | | --- | --- | | | |



=== Content from support.apple.com_3776f211_20250125_195610.html ===


* [Apple](https://www.apple.com/)
* + [Store](https://www.apple.com/us/shop/goto/store)
  + [Mac](https://www.apple.com/mac/)
  + [iPad](https://www.apple.com/ipad/)
  + [iPhone](https://www.apple.com/iphone/)
  + [Watch](https://www.apple.com/watch/)
  + [Vision](https://www.apple.com/apple-vision-pro/)
  + [AirPods](https://www.apple.com/airpods/)
  + [TV & Home](https://www.apple.com/tv-home/)
  + [Entertainment](https://www.apple.com/entertainment/)
  + [Accessories](https://www.apple.com/us/shop/goto/buy_accessories)
  + [Support](https://support.apple.com/?cid=gn-ols-home-hp-tab)
* 0+

# About the security content of OS X Yosemite v10.10.5 and Security Update 2015-006

This document describes the security content of OS X Yosemite v10.10.5 and Security Update 2015-006.

For the protection of our customers, Apple does not disclose, discuss, or confirm security issues until a full investigation has occurred and any necessary patches or releases are available. To learn more about Apple Product Security, see the [Apple Product Security](https://www.apple.com/support/security/) website.

For information about the Apple Product Security PGP Key, see [How to use the Apple Product Security PGP Key](https://support.apple.com/kb/HT201601).

Where possible, [CVE IDs](http://cve.mitre.org/about/) are used to reference the vulnerabilities for further information.

To learn about other security updates, see [Apple security updates](https://support.apple.com/kb/HT201222).

## OS X Yosemite v10.10.5 and Security Update 2015-006

* **apache**

  Available for: OS X Mavericks v10.9.5, OS X Yosemite v10.10 to v10.10.4

  Impact: Multiple vulnerabilities existed in Apache 2.4.16, the most serious of which may allow a remote attacker to cause a denial of service.

  Description: Multiple vulnerabilities existed in Apache versions prior to 2.4.16. These were addressed by updating Apache to version 2.4.16.

  CVE-ID

  CVE-2014-3581

  CVE-2014-3583

  CVE-2014-8109

  CVE-2015-0228

  CVE-2015-0253

  CVE-2015-3183

  CVE-2015-3185

* **apache\_mod\_php**

  Available for: OS X Mavericks v10.9.5, OS X Yosemite v10.10 to v10.10.4

  Impact: Multiple vulnerabilities existed in PHP 5.5.20, the most serious of which may lead to arbitrary code execution.

  Description: Multiple vulnerabilities existed in PHP versions prior to 5.5.20. These were addressed by updating Apache to version 5.5.27.

  CVE-ID

  CVE-2015-2783

  CVE-2015-2787

  CVE-2015-3307

  CVE-2015-3329

  CVE-2015-3330

  CVE-2015-4021

  CVE-2015-4022

  CVE-2015-4024

  CVE-2015-4025

  CVE-2015-4026

  CVE-2015-4147

  CVE-2015-4148

* **Apple ID OD Plug-in**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A malicious application may be able change the password of a local user

  Description: In some circumstances, a state management issue existed in password authentication. The issue was addressed through improved state management.

  CVE-ID

  CVE-2015-3799 : an anonymous researcher working with HP's Zero Day Initiative

* **AppleGraphicsControl**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A malicious application may be able to determine kernel memory layout

  Description: An issue existed in AppleGraphicsControl which could have led to the disclosure of kernel memory layout. This issue was addressed through improved bounds checking.

  CVE-ID

  CVE-2015-5768 : JieTao Yang of KeenTeam

* **Bluetooth**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A local user may be able to execute arbitrary code with system privileges

  Description: A memory corruption issue existed in IOBluetoothHCIController. This issue was addressed through improved memory handling.

  CVE-ID

  CVE-2015-3779 : Teddy Reed of Facebook Security

* **Bluetooth**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A malicious application may be able to determine kernel memory layout

  Description: A memory management issue could have led to the disclosure of kernel memory layout. This issue was addressed with improved memory management.

  CVE-ID

  CVE-2015-3780 : Roberto Paleari and Aristide Fattori of Emaze Networks

* **Bluetooth**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A malicious app may be able to access notifications from other iCloud devices

  Description: An issue existed where a malicious app could access a Bluetooth-paired Mac or iOS device's Notification Center notifications via the Apple Notification Center Service. The issue affected devices using Handoff and logged into the same iCloud account. This issue was resolved by revoking access to the Apple Notification Center Service.

  CVE-ID

  CVE-2015-3786 : Xiaolong Bai (Tsinghua University), Luyi Xing (System Security Lab of Indiana University), Tongxin Li (Peking University), XiaoFeng Wang (Indiana University)

* **Bluetooth**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: An attacker with privileged network position may be able to perform denial of service attack using malformed Bluetooth packets

  Description: An input validation issue existed in parsing of Bluetooth ACL packets. This issue was addressed through improved input validation.

  CVE-ID

  CVE-2015-3787 : moony li of Trend Micro

* **Bluetooth**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A local attacker may be able to cause unexpected application termination or arbitrary code execution

  Description: Multiple buffer overflow issues existed in blued's handling of XPC messages. These issues were addressed through improved bounds checking.

  CVE-ID

  CVE-2015-3777 : mitp0sh of [PDX]

* **bootp**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: An attacker may be able to determine Wi-Fi networks a device has previously accessed

  Description: Upon connecting to a Wi-Fi network, MAC addresses of previously accessed networks may have been broadcast. This issue was addressed by broadcasting only MAC addresses associated with the current SSID.

  CVE-ID

  CVE-2015-3778 : Piers O'Hanlon of Oxford Internet Institute, University of Oxford (on the EPSRC Being There project)

* **CloudKit**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A malicious application may be able to access the iCloud user record of a previously signed in user

  Description: A state inconsistency existed in CloudKit when signing out users. This issue was addressed through improved state handling.

  CVE-ID

  CVE-2015-3782 : Deepkanwal Plaha of University of Toronto

* **CoreMedia Playback**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: Memory corruption issues existed in CoreMedia Playback. These were addressed through improved memory handling.

  CVE-ID

  CVE-2015-5777 : Apple

  CVE-2015-5778 : Apple

* **CoreText**

  Available for: OS X Mountain Lion v10.8.5, OS X Mavericks v10.9.5, OS X Yosemite v10.10 to v10.10.4

  Impact: Processing a maliciously crafted font file may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue existed in the processing of font files. This issue was addressed through improved input validation.

  CVE-ID

  CVE-2015-5761 : John Villamil (@day6reak), Yahoo Pentest Team

* **CoreText**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Processing a maliciously crafted font file may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue existed in the processing of font files. This issue was addressed through improved input validation.

  CVE-ID

  CVE-2015-5755 : John Villamil (@day6reak), Yahoo Pentest Team

* **curl**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Multiple vulnerabilities in cURL and libcurl prior to 7.38.0, one of which may allow remote attackers to bypass the Same Origin Policy.

  Description: Multiple vulnerabilities existed in cURL and libcurl prior to 7.38.0. These issues were addressed by updating cURL to version 7.43.0.

  CVE-ID

  CVE-2014-3613

  CVE-2014-3620

  CVE-2014-3707

  CVE-2014-8150

  CVE-2014-8151

  CVE-2015-3143

  CVE-2015-3144

  CVE-2015-3145

  CVE-2015-3148

  CVE-2015-3153

* **Data Detectors Engine**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Processing a sequence of unicode characters can lead to an unexpected application termination or arbitrary code execution

  Description: Memory corruption issues existed in processing of Unicode characters. These issues were addressed through improved memory handling.

  CVE-ID

  CVE-2015-5750 : M1x7e1 of Safeye Team (www.safeye.org)

* **Date & Time pref pane**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Applications that rely on system time may have unexpected behavior

  Description: An authorization issue existed when modifying the system date and time preferences. This issue was addressed with additional authorization checks.

  CVE-ID

  CVE-2015-3757 : Mark S C Smith

* **Dictionary Application**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: An attacker with a privileged network position may be able to intercept users' Dictionary app queries

  Description: An issue existed in the Dictionary app, which did not properly secure user communications. This issue was addressed by moving Dictionary queries to HTTPS.

  CVE-ID

  CVE-2015-3774 : Jeffrey Paul of EEQJ, Jan Bee of the Google Security Team

* **DiskImages**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Processing a maliciously crafted DMG file may lead to an unexpected application termination or arbitrary code execution with system privileges

  Description: A memory corruption issue existed in parsing of malformed DMG images. This issue was addressed through improved memory handling.

  CVE-ID

  CVE-2015-3800 : Frank Graziano of the Yahoo Pentest Team

* **dyld**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A local user may be able to execute arbitrary code with system privileges

  Description: A path validation issue existed in dyld. This was addressed through improved environment sanitization.

  CVE-ID

  CVE-2015-3760 : beist of grayhash, Stefan Esser

* **FontParser**

  Available for: OS X Mountain Lion v10.8.5, OS X Mavericks v10.9.5, OS X Yosemite v10.10 to v10.10.4

  Impact: Processing a maliciously crafted font file may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue existed in the processing of font files. This issue was addressed through improved input validation.

  CVE-ID

  CVE-2015-3804 : Apple

  CVE-2015-5775 : Apple

* **FontParser**

  Available for: OS X Mountain Lion v10.8.5, OS X Mavericks v10.9.5, OS X Yosemite v10.10 to v10.10.4

  Impact: Processing a maliciously crafted font file may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue existed in the processing of font files. This issue was addressed through improved input validation.

  CVE-ID

  CVE-2015-5756 : John Villamil (@day6reak), Yahoo Pentest Team

* **groff**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Multiple issues in pdfroff

  Description: Multiple issues existed in pdfroff, the most serious of which may allow arbitrary filesystem modification. These issues were addressed by removing pdfroff.

  CVE-ID

  CVE-2009-5044

  CVE-2009-5078

* **ImageIO**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Processing a maliciously crafted TIFF image may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue existed in the processing of TIFF images. This issue was addressed through improved bounds checking.

  CVE-ID

  CVE-2015-5758 : Apple

* **ImageIO**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Visiting a maliciously crafted website may result in the disclosure of process memory

  Description: An uninitialized memory access issue existed in ImageIO's handling of PNG and TIFF images. Visiting a malicious website may result in sending data from process memory to the website. This issue is addressed through improved memory initialization and additional validation of PNG and TIFF images.

  CVE-ID

  CVE-2015-5781 : Michal Zalewski

  CVE-2015-5782 : Michal Zalewski

* **Install Framework Legacy**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A malicious application may be able to execute arbitrary code with root privileges

  Description: An issue existed in how Install.framework's 'runner' binary dropped privileges. This issue was addressed through improved privilege management.

  CVE-ID

  CVE-2015-5784 : Ian Beer of Google Project Zero

* **Install Framework Legacy**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A malicious application may be able to execute arbitrary code with system privileges

  Description: A race condition existed in Install.framework's 'runner' binary that resulted in privileges being incorrectly dropped. This issue was addressed through improved object locking.

  CVE-ID

  CVE-2015-5754 : Ian Beer of Google Project Zero

* **IOFireWireFamily**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A local user may be able to execute arbitrary code with system privileges

  Description: Memory corruption issues existed in IOFireWireFamily. These issues were addressed through additional type input validation.

  CVE-ID

  CVE-2015-3769 : Ilja van Sprundel

  CVE-2015-3771 : Ilja van Sprundel

  CVE-2015-3772 : Ilja van Sprundel

* **IOGraphics**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A malicious application may be able to execute arbitrary code with system privileges

  Description: A memory corruption issue existed in IOGraphics. This issue was addressed through additional type input validation.

  CVE-ID

  CVE-2015-3770 : Ilja van Sprundel

  CVE-2015-5783 : Ilja van Sprundel

* **IOHIDFamily**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A local user may be able to execute arbitrary code with system privileges

  Description: A buffer overflow issue existed in IOHIDFamily. This issue was addressed through improved memory handling.

  CVE-ID

  CVE-2015-5774 : TaiG Jailbreak Team

* **Kernel**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A malicious application may be able to determine kernel memory layout

  Description: An issue existed in the mach\_port\_space\_info interface, which could have led to the disclosure of kernel memory layout. This was addressed by disabling the mach\_port\_space\_info interface.

  CVE-ID

  CVE-2015-3766 : Cererdlong of Alibaba Mobile Security Team, @PanguTeam

* **Kernel**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A malicious application may be able to execute arbitrary code with system privileges

  Description: An integer overflow existed in the handling of IOKit functions. This issue was addressed through improved validation of IOKit API arguments.

  CVE-ID

  CVE-2015-3768 : Ilja van Sprundel

* **Kernel**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A local user may be able to cause a system denial of service

  Description: A resource exhaustion issue existed in the fasttrap driver. This was addressed through improved memory handling.

  CVE-ID

  CVE-2015-5747 : The Brainy Code Scanner (m00nbsd)

* **Kernel**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A local user may be able to cause a system denial of service

  Description: A validation issue existed in the mounting of HFS volumes. This was addressed by adding additional checks.

  CVE-ID

  CVE-2015-5748 : Maxime Villard of m00nbsd

* **Kernel**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A malicious application may be able to execute unsigned code

  Description: An issue existed that allowed unsigned code to be appended to signed code in a specially crafted executable file. This issue was addressed through improved code signature validation.

  CVE-ID

  CVE-2015-3806 : TaiG Jailbreak Team

* **Kernel**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A specially crafted executable file could allow unsigned, malicious code to execute

  Description: An issue existed in the way multi-architecture executable files were evaluated that could have allowed unsigned code to be executed. This issue was addressed through improved validation of executable files.

  CVE-ID

  CVE-2015-3803 : TaiG Jailbreak Team

* **Kernel**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A local user may be able to execute unsigned code

  Description: A validation issue existed in the handling of Mach-O files. This was addressed by adding additional checks.

  CVE-ID

  CVE-2015-3802 : TaiG Jailbreak Team

  CVE-2015-3805 : TaiG Jailbreak Team

* **Kernel**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Parsing a maliciously crafted plist may lead to an unexpected application termination or arbitrary code execution with system privileges

  Description: A memory corruption existed in processing of malformed plists. This issue was addressed through improved memory handling.

  CVE-ID

  CVE-2015-3776 : Teddy Reed of Facebook Security, Patrick Stein (@jollyjinx) of Jinx Germany

* **Kernel**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A local user may be able to execute arbitrary code with system privileges

  Description: A path validation issue existed. This was addressed through improved environment sanitization.

  CVE-ID

  CVE-2015-3761 : beist of grayish

* **Libc**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Processing a maliciously crafted regular expression may lead to an unexpected application termination or arbitrary code execution

  Description: Memory corruption issues existed in the TRE library. These were addressed through improved memory handling.

  CVE-ID

  CVE-2015-3796 : Ian Beer of Google Project Zero

  CVE-2015-3797 : Ian Beer of Google Project Zero

  CVE-2015-3798 : Ian Beer of Google Project Zero

* **Libinfo**

  Available for: OS X Mountain Lion v10.8.5, OS X Mavericks v10.9.5, OS X Yosemite v10.10 to v10.10.4

  Impact: A remote attacker may be able to cause unexpected application termination or arbitrary code execution

  Description: Memory corruption issues existed in handling AF\_INET6 sockets. These were addressed by improved memory handling.

  CVE-ID

  CVE-2015-5776 : Apple

* **libpthread**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A malicious application may be able to execute arbitrary code with system privileges

  Description: A memory corruption issue existed in handling syscalls. This issue was addressed through improved lock state checking.

  CVE-ID

  CVE-2015-5757 : Lufeng Li of Qihoo 360

* **libxml2**

  Available for: OS X Mountain Lion v10.8.5, OS X Mavericks v10.9.5, OS X Yosemite v10.10 to v10.10.4

  Impact: Multiple vulnerabilities existed in libxml2 versions prior to 2.9.2, the most serious of which may allow a remote attacker to cause a denial of service

  Description: Multiple vulnerabilities existed in libxml2 versions prior to 2.9.2. These were addressed by updating libxml2 to version 2.9.2.

  CVE-ID

  CVE-2014-0191 : Felix Groebert of Google

* **libxml2**

  Available for: OS X Mavericks v10.9.5, OS X Yosemite v10.10 to v10.10.4

  Impact: Parsing a maliciously crafted XML document may lead to disclosure of user information

  Description: A memory access issue existed in libxml2. This was addressed by improved memory handling

  CVE-ID

  CVE-2014-3660 : Felix Groebert of Google

* **libxml2**

  Available for: OS X Mountain Lion v10.8.5, OS X Mavericks v10.9.5, OS X Yosemite v10.10 to v10.10.4

  Impact: Parsing a maliciously crafted XML document may lead to disclosure of user information

  Description: A memory corruption issue existed in parsing of XML files. This issue was addressed through improved memory handling.

  CVE-ID

  CVE-2015-3807 : Apple

* **libxpc**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A malicious application may be able to execute arbitrary code with system privileges

  Description: A memory corruption issue existed in handling of malformed XPC messages. This issue was improved through improved bounds checking.

  CVE-ID

  CVE-2015-3795 : Mathew Rowley

* **mail\_cmds**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A local user may be able to execute arbitrary shell commands

  Description: A validation issue existed in the mailx parsing of email addresses. This was addressed by improved sanitization.

  CVE-ID

  CVE-2014-7844

* **Notification Center OSX**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A malicious application may be able to access all notifications previously displayed to users

  Description: An issue existed in Notification Center, which did not properly delete user notifications. This issue was addressed by correctly deleting notifications dismissed by users.

  CVE-ID

  CVE-2015-3764 : Jonathan Zdziarski

* **ntfs**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A local user may be able to execute arbitrary code with system privileges

  Description: A memory corruption issue existed in NTFS. This issue was addressed through improved memory handling.

  CVE-ID

  CVE-2015-5763 : Roberto Paleari and Aristide Fattori of Emaze Networks

* **OpenSSH**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Remote attackers may be able to circumvent a time delay for failed login attempts and conduct brute-force attacks

  Description: An issue existed when processing keyboard-interactive devices. This issue was addressed through improved authentication request validation.

  CVE-ID

  CVE-2015-5600

* **OpenSSL**

  Available for: OS X Mountain Lion v10.8.5, OS X Mavericks v10.9.5, OS X Yosemite v10.10 to v10.10.4

  Impact: Multiple vulnerabilities existed in OpenSSL versions prior to 0.9.8zg, the most serious of which may allow a remote attacker to cause a denial of service.

  Description: Multiple vulnerabilities existed in OpenSSL versions prior to 0.9.8zg. These were addressed by updating OpenSSL to version 0.9.8zg.

  CVE-ID

  CVE-2015-1788

  CVE-2015-1789

  CVE-2015-1790

  CVE-2015-1791

  CVE-2015-1792

* **perl**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Parsing a maliciously crafted regular expression may lead to disclosure of unexpected application termination or arbitrary code execution

  Description: An integer underflow issue existed in the way Perl parsed regular expressions. This issue was addressed through improved memory handling.

  CVE-ID

  CVE-2013-7422

* **PostgreSQL**

  Available for: OS X Mountain Lion v10.8.5, OS X Mavericks v10.9.5, OS X Yosemite v10.10 to v10.10.4

  Impact: An attacker may be able to cause unexpected application termination or gain access to data without proper authentication

  Description: Multiple issues existed in PostgreSQL 9.2.4. These issues were addressed by updating PostgreSQL to 9.2.13.

  CVE-ID

  CVE-2014-0067

  CVE-2014-8161

  CVE-2015-0241

  CVE-2015-0242

  CVE-2015-0243

  CVE-2015-0244

* **python**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Multiple vulnerabilities existed in Python 2.7.6, the most serious of which may lead to arbitrary code execution

  Description: Multiple vulnerabilities existed in Python versions prior to 2.7.6. These were addressed by updating Python to version 2.7.10.

  CVE-ID

  CVE-2013-7040

  CVE-2013-7338

  CVE-2014-1912

  CVE-2014-7185

  CVE-2014-9365

* **QL Office**

  Available for: OS X Mountain Lion v10.8.5, OS X Mavericks v10.9.5, OS X Yosemite v10.10 to v10.10.4

  Impact: Parsing a maliciously crafted Office document may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue existed in parsing of Office documents. This issue was addressed through improved memory handling.

  CVE-ID

  CVE-2015-5773 : Apple

* **QL Office**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Parsing a maliciously crafted XML file may lead to disclosure of user information

  Description: An external entity reference issue existed in XML file parsing. This issue was addressed through improved parsing.

  CVE-ID

  CVE-2015-3784 : Bruno Morisson of INTEGRITY S.A.

* **Quartz Composer Framework**

  Available for: OS X Mountain Lion v10.8.5, OS X Mavericks v10.9.5, OS X Yosemite v10.10 to v10.10.4

  Impact: Parsing a maliciously crafted QuickTime file may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue existed in parsing of QuickTime files. This issue was addressed through improved memory handling.

  CVE-ID

  CVE-2015-5771 : Apple

* **Quick Look**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Searching for a previously viewed website may launch the web browser and render that website

  Description: An issue existed where QuickLook had the capability to execute JavaScript. The issue was addressed by disallowing execution of JavaScript.

  CVE-ID

  CVE-2015-3781 : Andrew Pouliot of Facebook, Anto Loyola of Qubole

* **QuickTime 7**

  Available for: OS X Mountain Lion v10.8.5, OS X Mavericks v10.9.5, OS X Yosemite v10.10 to v10.10.4

  Impact: Processing a maliciously crafted file may lead to an unexpected application termination or arbitrary code execution

  Description: Multiple memory corruption issues existed in QuickTime. These issues were addressed through improved memory handling.

  CVE-ID

  CVE-2015-3779

  CVE-2015-5753 : Apple

  CVE-2015-5779 : Apple

* **QuickTime 7**

  Available for: OS X Mountain Lion v10.8.5, OS X Mavericks v10.9.5, OS X Yosemite v10.10 to v10.10.4

  Impact: Processing a maliciously crafted file may lead to an unexpected application termination or arbitrary code execution

  Description: Multiple memory corruption issues existed in QuickTime. These issues were addressed through improved memory handling.

  CVE-ID

  CVE-2015-3765 : Joe Burnett of Audio Poison

  CVE-2015-3788 : Ryan Pentney and Richard Johnson of Cisco Talos

  CVE-2015-3789 : Ryan Pentney and Richard Johnson of Cisco Talos

  CVE-2015-3790 : Ryan Pentney and Richard Johnson of Cisco Talos

  CVE-2015-3791 : Ryan Pentney and Richard Johnson of Cisco Talos

  CVE-2015-3792 : Ryan Pentney and Richard Johnson of Cisco Talos

  CVE-2015-5751 : WalkerFuz

* **SceneKit**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Viewing a maliciously crafted Collada file may lead to arbitrary code execution

  Description: A heap buffer overflow existed in SceneKit's handling of Collada files. This issue was addressed through improved input validation.

  CVE-ID

  CVE-2015-5772 : Apple

* **SceneKit**

  Available for: OS X Mountain Lion v10.8.5, OS X Mavericks v10.9.5, OS X Yosemite v10.10 to v10.10.4

  Impact: A remote attacker may be able to cause unexpected application termination or arbitrary code execution

  Description: A memory corruption issue existed in SceneKit. This issue was addressed through improved memory handling.

  CVE-ID

  CVE-2015-3783 : Haris Andrianakis of Google Security Team

* **Security**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A standard user may be able to gain access to admin privileges without proper authentication

  Description: An issue existed in handling of user authentication. This issue was addressed through improved authentication checks.

  CVE-ID

  CVE-2015-3775 : [Eldon Ahrold]

* **SMBClient**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: A remote attacker may be able to cause unexpected application termination or arbitrary code execution

  Description: A memory corruption issue existed in the SMB client. This issue was addressed through improved memory handling.

  CVE-ID

  CVE-2015-3773 : Ilja van Sprundel

* **Speech UI**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Parsing a maliciously crafted unicode string with speech alerts enabled may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue existed in handling of Unicode strings. This issue was addressed by improved memory handling.

  CVE-ID

  CVE-2015-3794 : Adam Greenbaum of Refinitive

* **sudo**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Multiple vulnerabilities existed in sudo versions prior to 1.7.10p9, the most serious of which may allow an attacker access to arbitrary files

  Description: Multiple vulnerabilities existed in sudo versions prior to 1.7.10p9. These were addressed by updating sudo to version 1.7.10p9.

  CVE-ID

  CVE-2013-1775

  CVE-2013-1776

  CVE-2013-2776

  CVE-2013-2777

  CVE-2014-0106

  CVE-2014-9680

* **tcpdump**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Multiple vulnerabilities existed in tcpdump 4.7.3, the most serious of which may allow a remote attacker to cause a denial of service.

  Description: Multiple vulnerabilities existed in tcpdump versions prior to 4.7.3. These were addressed by updating tcpdump to version 4.7.3.

  CVE-ID

  CVE-2014-8767

  CVE-2014-8769

  CVE-2014-9140

* **Text Formats**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Parsing a maliciously crafted text file may lead to disclosure of user information

  Description: An XML external entity reference issue existed with TextEdit parsing. This issue was addressed through improved parsing.

  CVE-ID

  CVE-2015-3762 : Xiaoyong Wu of the Evernote Security Team

* **udf**

  Available for: OS X Yosemite v10.10 to v10.10.4

  Impact: Processing a maliciously crafted DMG file may lead to an unexpected application termination or arbitrary code execution with system privileges

  Description: A memory corruption issue existed in parsing of malformed DMG images. This issue was addressed through improved memory handling.

  CVE-ID

  CVE-2015-3767 : beist of grayhash

OS X Yosemite v10.10.5 includes the security content of [Safari 8.0.8](https://support.apple.com/kb/HT205033).

Information about products not manufactured by Apple, or independent websites not controlled or tested by Apple, is provided without recommendation or endorsement. Apple assumes no responsibility with regard to the selection, performance, or use of third-party websites or products. Apple makes no representations regarding third-party website accuracy or reliability. [Contact the vendor](https://support.apple.com/103190) for additional information.

Published Date: November 03, 2023

Helpful?

Yes

No

Character limit:
250

Maximum character limit is 250.

Please don’t include any personal information in your comment.
Submit

Thanks for your feedback.

## Apple Footer

[
Apple](https://www.apple.com)

1. [Support](https://support.apple.com)
2. About the security content of OS X Yosemite v10.10.5 and Security Update 2015-006

[United States](https://support.apple.com/en-us/103491/localeselector "Choose your country or region")

Copyright © 2025 Apple Inc. All rights reserved.
 [Privacy Policy](https://www.apple.com/legal/privacy/en-ww/) [Terms of Use](https://www.apple.com/legal/internet-services/terms/site.html) [Sales and Refunds](https://www.apple.com/shop/goto/help/sales_refunds) [Site Map](https://www.apple.com/sitemap/)



=== Content from www.sudo.ws_76a1fcad_20250125_195603.html ===

[![mercurial](/repos/sudo/static/hglogo.png)](https://mercurial-scm.org/)

* [log](/repos/sudo/shortlog/6b22be4d09f0)
* [graph](/repos/sudo/graph/6b22be4d09f0)
* [tags](/repos/sudo/tags)
* [bookmarks](/repos/sudo/bookmarks)
* [branches](/repos/sudo/branches)

* changeset
* [raw](/repos/sudo/raw-rev/6b22be4d09f0)
* [browse](/repos/sudo/file/6b22be4d09f0)

* [help](/repos/sudo/help)

## [Mercurial](/) > [repos](/repos) > [sudo](/repos/sudo)

### changeset 7989:[6b22be4d09f0](/repos/sudo/rev/6b22be4d09f0)

Find changesets by keywords (author, files, the commit message), revision
number or hash, or [revset expression](/repos/sudo/help/revsets).

Rototill code to determine the tty. For Linux, we now look up the
tty device in /proc/pid/stat instead of trying to open /proc/pid/fd/[0-2].
The sudo\_ttyname\_dev() function maps the given device number to a
string. On BSD, we can use devname(). On Solaris, \_ttyname\_dev()
does what we want.
TODO: write /dev/ traversal code for the generic sudo\_ttyname\_dev().

| author | Todd C. Miller <Todd.Miller@courtesan.com> |
| --- | --- |
| date | Wed, 11 Apr 2012 14:48:08 -0400 |
| parents | [f17290e64559](/repos/sudo/rev/f17290e64559) |
| children | [a3b17298d4d0](/repos/sudo/rev/a3b17298d4d0) |
| files | [config.h.in](/repos/sudo/file/6b22be4d09f0/config.h.in) [configure](/repos/sudo/file/6b22be4d09f0/configure) [configure.in](/repos/sudo/file/6b22be4d09f0/configure.in) [src/ttyname.c](/repos/sudo/file/6b22be4d09f0/src/ttyname.c) |
| diffstat | 4 files changed, 192 insertions(+), 77 deletions(-) [+] [-]  | [config.h.in](#l1.1) | 3 |  | | --- | --- | --- | | [configure](#l2.1) | 28 |  | | [configure.in](#l3.1) | 4 |  | | [src/ttyname.c](#l4.1) | 234 |  | |

line wrap: on
 line diff
```

--- a/config.h.in	Tue Apr 10 16:12:08 2012 -0400
+++ b/config.h.in	Wed Apr 11 14:48:08 2012 -0400
@@ -666,6 +666,9 @@
 /* Define to 1 if you have the `_innetgr' function. */
 #undef HAVE__INNETGR

+/* Define to 1 if you have the `_ttyname_dev' function. */
+#undef HAVE__TTYNAME_DEV
+
 /* Define to 1 if the compiler supports the C99 __func__ variable. */
 #undef HAVE___FUNC__

```
```

--- a/configure	Tue Apr 10 16:12:08 2012 -0400
+++ b/configure	Wed Apr 11 14:48:08 2012 -0400
@@ -1,6 +1,6 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.68 for sudo 1.8.5.
+# Generated by GNU Autoconf 2.68 for sudo 1.8.5b8.
 #
 # Report bugs to <http://www.sudo.ws/bugs/>.
 #
@@ -570,8 +570,8 @@
 # Identity of this package.
 PACKAGE_NAME='sudo'
 PACKAGE_TARNAME='sudo'
-PACKAGE_VERSION='1.8.5'
-PACKAGE_STRING='sudo 1.8.5'
+PACKAGE_VERSION='1.8.5b8'
+PACKAGE_STRING='sudo 1.8.5b8'
 PACKAGE_BUGREPORT='http://www.sudo.ws/bugs/'
 PACKAGE_URL=''

@@ -1447,7 +1447,7 @@
   # Omit some internal or obsolete options to make the list less imposing.
   # This message is too long to be a string in the A/UX 3.1 sh.
   cat <<_ACEOF
-\`configure' configures sudo 1.8.5 to adapt to many kinds of systems.
+\`configure' configures sudo 1.8.5b8 to adapt to many kinds of systems.

 Usage: $0 [OPTION]... [VAR=VALUE]...

@@ -1512,7 +1512,7 @@

 if test -n "$ac_init_help"; then
   case $ac_init_help in
-     short | recursive ) echo "Configuration of sudo 1.8.5:";;
+     short | recursive ) echo "Configuration of sudo 1.8.5b8:";;
    esac
   cat <<\_ACEOF

@@ -1730,7 +1730,7 @@
 test -n "$ac_init_help" && exit $ac_status
 if $ac_init_version; then
   cat <<\_ACEOF
-sudo configure 1.8.5
+sudo configure 1.8.5b8
 generated by GNU Autoconf 2.68

 Copyright (C) 2010 Free Software Foundation, Inc.
@@ -2434,7 +2434,7 @@
 This file contains any messages produced by compilers while
 running configure, to aid debugging if configure makes a mistake.

-It was created by sudo $as_me 1.8.5, which was
+It was created by sudo $as_me 1.8.5b8, which was
 generated by GNU Autoconf 2.68.  Invocation command line was

   $ $0 $@
@@ -15271,6 +15271,16 @@
 #define HAVE_STRUCT_PSINFO_PR_TTYDEV 1
 _ACEOF

+for ac_func in _ttyname_dev
+do :
+  ac_fn_c_check_func "$LINENO" "_ttyname_dev" "ac_cv_func__ttyname_dev"
+if test "x$ac_cv_func__ttyname_dev" = xyes; then :
+  cat >>confdefs.h <<_ACEOF
+#define HAVE__TTYNAME_DEV 1
+_ACEOF
+
+fi
+done

 fi

@@ -20608,7 +20618,7 @@
 # report actual input values of CONFIG_FILES etc. instead of their
 # values after options handling.
 ac_log="
-This file was extended by sudo $as_me 1.8.5, which was
+This file was extended by sudo $as_me 1.8.5b8, which was
 generated by GNU Autoconf 2.68.  Invocation command line was

   CONFIG_FILES    = $CONFIG_FILES
@@ -20674,7 +20684,7 @@
 cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
 ac_cs_config="`$as_echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`"
 ac_cs_version="\\
-sudo config.status 1.8.5
+sudo config.status 1.8.5b8
 configured by $0, generated by GNU Autoconf 2.68,
   with options \\"\$ac_cs_config\\"

```
```

--- a/configure.in	Tue Apr 10 16:12:08 2012 -0400
+++ b/configure.in	Wed Apr 11 14:48:08 2012 -0400
@@ -3,7 +3,7 @@
 dnl
 dnl Copyright (c) 1994-1996,1998-2012 Todd C. Miller <Todd.Miller@courtesan.com>
 dnl
-AC_INIT([sudo], [1.8.5], [http://www.sudo.ws/bugs/], [sudo])
+AC_INIT([sudo], [1.8.5b8], [http://www.sudo.ws/bugs/], [sudo])
 AC_CONFIG_HEADER([config.h pathnames.h])
 dnl
 dnl Note: this must come after AC_INIT
@@ -2007,7 +2007,7 @@
 AC_HEADER_TIME
 AC_HEADER_STDBOOL
 AC_CHECK_HEADERS(malloc.h netgroup.h paths.h spawn.h utime.h utmpx.h sys/sockio.h sys/bsdtypes.h sys/select.h sys/stropts.h sys/sysmacros.h)
-AC_CHECK_HEADERS([procfs.h] [sys/procfs.h], [AC_CHECK_MEMBERS(struct psinfo.pr_ttydev, [], [], [AC_INCLUDES_DEFAULT
+AC_CHECK_HEADERS([procfs.h] [sys/procfs.h], [AC_CHECK_MEMBERS(struct psinfo.pr_ttydev, [AC_CHECK_FUNCS(_ttyname_dev)], [], [AC_INCLUDES_DEFAULT
 #ifdef HAVE_PROCFS_H
 #include <procfs.h>
 #endif
```
```

--- a/src/ttyname.c	Tue Apr 10 16:12:08 2012 -0400
+++ b/src/ttyname.c	Wed Apr 11 14:48:08 2012 -0400
@@ -51,6 +51,7 @@
 #endif /* HAVE_UNISTD_H */
 #include <errno.h>
 #include <fcntl.h>
+#include <limits.h>
 #if defined(HAVE_STRUCT_KINFO_PROC_P_TDEV) || defined (HAVE_STRUCT_KINFO_PROC_KP_EPROC_E_TDEV) || defined(HAVE_STRUCT_KINFO_PROC2_P_TDEV)
 # include <sys/sysctl.h>
 #elif defined(HAVE_STRUCT_KINFO_PROC_KI_TDEV)
@@ -92,6 +93,86 @@

 #if defined(sudo_kp_tdev)
 /*
+ * Like ttyname() but uses a dev_t instead of an open fd.
+ * Caller is responsible for freeing the returned string.
+ * The BSD version uses devname()
+ */
+static char *
+sudo_ttyname_dev(dev_t tdev)
+{
+    char *dev, *tty = NULL;
+    debug_decl(sudo_ttyname_dev, SUDO_DEBUG_UTIL)
+
+    /* Some versions of devname() return NULL on failure, others do not. */
+    dev = devname(tdev, S_IFCHR);
+    if (dev != NULL && *dev != '?' && *dev != '#') {
+	if (*dev != '/') {
+	    /* devname() doesn't use the /dev/ prefix, add one... */
+	    size_t len = sizeof(_PATH_DEV) + strlen(dev);
+	    tty = emalloc(len);
+	    strlcpy(tty, _PATH_DEV, len);
+	    strlcat(tty, dev, len);
+	} else {
+	    /* Should not happen but just in case... */
+	    tty = estrdup(dev);
+	}
+    }
+    debug_return_str(tty);
+}
+#elif defined(HAVE__TTYNAME_DEV)
+extern char *_ttyname_dev(dev_t rdev, char *buffer, size_t buflen);
+
+/*
+ * Like ttyname() but uses a dev_t instead of an open fd.
+ * Caller is responsible for freeing the returned string.
+ * This version is just a wrapper around _ttyname_dev().
+ */
+static char *
+sudo_ttyname_dev(dev_t tdev)
+{
+    char buf[TTYNAME_MAX], *tty;
+    struct stat sb;
+    debug_decl(sudo_ttyname_dev, SUDO_DEBUG_UTIL)
+
+    /* Check if it is a pseudo-tty slave, falling back on _ttyname_dev() */
+    (void)snprintf(buf, sizeof(buf), "%spts/%u", _PATH_DEV,
+	(unsigned int)minor(tdev));
+    if (stat(buf, &sb) == 0 && sb.st_rdev == tdev) {
+	tty = buf;
+    } else {
+	tty = _ttyname_dev(tdev, buf, sizeof(buf));
+    }
+
+    debug_return_str(estrdup(tty));
+}
+#else
+/*
+ * Like ttyname() but uses a dev_t instead of an open fd.
+ * Caller is responsible for freeing the returned string.
+ * Generic version.
+ */
+static char *
+sudo_ttyname_dev(dev_t tdev)
+{
+    char buf[PATH_MAX], *tty = NULL;
+    struct stat sb;
+    debug_decl(sudo_ttyname_dev, SUDO_DEBUG_UTIL)
+
+    /* First, check if it is a pseudo-tty slave. */
+    (void)snprintf(buf, sizeof(buf), "%spts/%u", _PATH_DEV,
+	(unsigned int)minor(tdev));
+    if (stat(buf, &sb) == 0 && sb.st_rdev == tdev) {
+	tty = buf;
+    } else {
+	/* XXX - fallback to scanning /dev/ */
+    }
+
+    debug_return_str(estrdup(tty));
+}
+#endif
+
+#if defined(sudo_kp_tdev)
+/*
  * Return a string from ttyname() containing the tty to which the process is
  * attached or NULL if there is no tty associated with the process (or its
  * parent).  First tries sysctl using the current pid, then the parent's pid.
@@ -123,21 +204,13 @@
 	    rc = sysctl(mib, sudo_kp_namelen, ki_proc, &size, NULL, 0);
 	} while (rc == -1 && errno == ENOMEM);
 	if (rc != -1) {
-	    char *dev = devname(ki_proc->sudo_kp_tdev, S_IFCHR);
-	    /* Some versions of devname() return NULL, others do not. */
-	    if (dev == NULL || *dev == '?' || *dev == '#') {
-		sudo_debug_printf(SUDO_DEBUG_WARN,
-		    "unable to map device number %u to name",
-		    ki_proc->sudo_kp_tdev);
-	    } else if (*dev != '/') {
-		/* devname() doesn't use the /dev/ prefix, add one... */
-		size_t len = sizeof(_PATH_DEV) + strlen(dev);
-		tty = emalloc(len);
-		strlcpy(tty, _PATH_DEV, len);
-		strlcat(tty, dev, len);
-	    } else {
-		/* Should not happen but just in case... */
-		tty = estrdup(dev);
+	    if (ki_proc->sudo_kp_tdev != (dev_t)-1) {
+		tty = sudo_ttyname_dev(ki_proc->sudo_kp_tdev);
+		if (tty == NULL) {
+		    sudo_debug_printf(SUDO_DEBUG_WARN,
+			"unable to map device number %u to name",
+			ki_proc->sudo_kp_tdev);
+		}
 	    }
 	} else {
 	    sudo_debug_printf(SUDO_DEBUG_WARN,
@@ -157,14 +230,11 @@
     debug_return_str(tty);
 }
 #elif defined(HAVE_STRUCT_PSINFO_PR_TTYDEV)
-# ifndef PRNODEV
-#  define PRNODEV	((dev_t)-1)
-# endif
 /*
  * Return a string from ttyname() containing the tty to which the process is
  * attached or NULL if there is no tty associated with the process (or its
- * parent).  First tries std{in,out,err} then falls back to our /proc entry,
- * or our parent's if that doesn't work.
+ * parent).  First tries /proc/pid/psinfo, then /proc/ppid/psinfo.
+ * Falls back on ttyname of std{in,out,err} if that fails.
  */
 char *
 get_process_ttyname(void)
@@ -176,68 +246,100 @@
     int i, fd;
     debug_decl(get_process_ttyname, SUDO_DEBUG_UTIL)

-    if ((tty = ttyname(STDIN_FILENO)) == NULL &&
-	(tty = ttyname(STDOUT_FILENO)) == NULL &&
-	(tty = ttyname(STDERR_FILENO)) == NULL) {
-	/*
-	 * No tty hooked up to std{in,out,err}, check /proc.
-	 * We try to map pr_ttydev in psinfo to /dev/pts/N
-	 */
-	for (i = 0; tty == NULL && i < 2; i++) {
-	    snprintf(path, sizeof(path), "/proc/%u/psinfo",
-		i ? (unsigned int)getppid() : (unsigned int)getpid());
-	    if ((fd = open(path, O_RDONLY, 0)) == -1)
-		continue;
-	    nread = read(fd, &psinfo, sizeof(psinfo));
-	    close(fd);
-	    if (nread != (ssize_t)sizeof(psinfo) || psinfo.pr_ttydev == PRNODEV)
-		continue;
-	    (void)snprintf(path, sizeof(path), "%spts/%u", _PATH_DEV,
-		(unsigned int)minor(psinfo.pr_ttydev));
-	    if (stat(path, &sb) == 0 && sb.st_rdev == psinfo.pr_ttydev) {
-		fd = open(path, O_RDONLY|O_NOCTTY|O_NONBLOCK, 0);
-		if (fd != -1) {
-		    tty = ttyname(fd);
-		    close(fd);
+    /* Try to determine the tty from pr_ttydev in /proc/pid/psinfo. */
+    for (i = 0; tty == NULL && i < 2; i++) {
+	(void)snprintf(path, sizeof(path), "/proc/%u/psinfo",
+	    i ? (unsigned int)getppid() : (unsigned int)getpid());
+	if ((fd = open(path, O_RDONLY, 0)) == -1)
+	    continue;
+	nread = read(fd, &psinfo, sizeof(psinfo));
+	close(fd);
+	if (nread == (ssize_t)sizeof(psinfo) && psinfo.pr_ttydev != (dev_t)-1) {
+	    tty = sudo_ttyname_dev(psinfo.pr_ttydev);
+	}
+    }
+
+    /* If all else fails, fall back on ttyname(). */
+    if (tty == NULL) {
+	if ((tty = ttyname(STDIN_FILENO)) != NULL ||
+	    (tty = ttyname(STDOUT_FILENO)) != NULL ||
+	    (tty = ttyname(STDERR_FILENO)) != NULL)
+	    tty = estrdup(tty);
+    }
+
+    debug_return_str(tty);
+}
+#elif defined(__linux__)
+/*
+ * Return a string from ttyname() containing the tty to which the process is
+ * attached or NULL if there is no tty associated with the process (or its
+ * parent).  First tries field 7 in /proc/pid/stat, then /proc/ppid/stat.
+ * Falls back on ttyname of std{in,out,err} if that fails.
+ */
+char *
+get_process_ttyname(void)
+{
+    char *line = NULL, *tty = NULL;
+    size_t linesize = 0;
+    ssize_t len;
+    int i;
+    debug_decl(get_process_ttyname, SUDO_DEBUG_UTIL)
+
+    /* Try to determine the tty from pr_ttydev in /proc/pid/psinfo. */
+    for (i = 0; tty == NULL && i < 2; i++) {
+	FILE *fp;
+	char path[PATH_MAX];
+	(void)snprintf(path, sizeof(path), "/proc/%u/stat",
+	    i ? (unsigned int)getppid() : (unsigned int)getpid());
+	if ((fp = fopen(path, "r")) == NULL)
+	    continue;
+	len = getline(&line, &linesize, fp);
+	fclose(fp);
+	if (len != -1) {
+	    /* Field 7 is the tty dev (0 if no tty) */
+	    char *cp = line;
+	    int field = 1;
+	    while (*cp != '\0') {
+		if (*cp++ == ' ') {
+		    if (++field == 7) {
+			dev_t tdev = (dev_t)atoi(cp);
+			if (tdev > 0)
+			    tty = sudo_ttyname_dev(tdev);
+			break;
+		    }
 		}
 	    }
 	}
     }
+    efree(line);

-    debug_return_str(estrdup(tty));
+    /* If all else fails, fall back on ttyname(). */
+    if (tty == NULL) {
+	if ((tty = ttyname(STDIN_FILENO)) != NULL ||
+	    (tty = ttyname(STDOUT_FILENO)) != NULL ||
+	    (tty = ttyname(STDERR_FILENO)) != NULL)
+	    tty = estrdup(tty);
+    }
+
+    debug_return_str(tty);
 }
 #else
 /*
  * Return a string from ttyname() containing the tty to which the process is
- * attached or NULL if there is no tty associated with the process (or its
- * parent).  First tries std{in,out,err} then falls back to our parent's /proc
- * entry.
+ * attached or NULL if there is no tty associated with the process.
+ * parent).
  */
 char *
 get_process_ttyname(void)
 {
-    char path[PATH_MAX], *tty = NULL;
-    struct stat sb;
-    pid_t ppid;
-    int i, fd;
+    char *tty;
     debug_decl(get_process_ttyname, SUDO_DEBUG_UTIL)

-    if ((tty = ttyname(STDIN_FILENO)) == NULL &&
-	(tty = ttyname(STDOUT_FILENO)) == NULL &&
-	(tty = ttyname(STDERR_FILENO)) == NULL) {
-	/* No tty for child, check the parent via /proc. */
-	ppid = getppid();
-	for (i = STDIN_FILENO; i <= STDERR_FILENO && tty == NULL; i++) {
-	    snprintf(path, sizeof(path), "/proc/%u/fd/%d",
-		(unsigned int)ppid, i);
-	    fd = open(path, O_RDONLY|O_NOCTTY|O_NONBLOCK, 0);
-	    if (fd != -1) {
-		tty = ttyname(fd);
-		close(fd);
-	    }
-	}
+    if ((tty = ttyname(STDIN_FILENO)) == NULL) {
+	if ((tty = ttyname(STDOUT_FILENO)) == NULL)
+	    tty = ttyname(STDERR_FILENO);
     }

     debug_return_str(estrdup(tty));
 }
-#endif /* !sudo_kp_tdev && !HAVE_STRUCT_PSINFO_PR_TTYDEV */
+#endif
```



=== Content from access.redhat.com_76e8e535_20250126_113153.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from lists.opensuse.org_ecea0702_20250125_195537.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/W5ND7EZIDNKIBQSDIPDCKUIDVFQM2VQO/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/W5ND7EZIDNKIBQSDIPDCKUIDVFQM2VQO/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/W5ND7EZIDNKIBQSDIPDCKUIDVFQM2VQO/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/W5ND7EZIDNKIBQSDIPDCKUIDVFQM2VQO/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/W5ND7EZIDNKIBQSDIPDCKUIDVFQM2VQO/#W5ND7EZIDNKIBQSDIPDCKUIDVFQM2VQO)

# openSUSE-SU-2013:0495-1: sudo: fixed two security issues

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

20 Mar
2013

20 Mar
'13

10:04

openSUSE Security Update: sudo: fixed two security issues
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2013:0495-1
Rating: low
References: #806919 #806921
Cross-References: CVE-2013-1775 CVE-2013-1776
Affected Products:
openSUSE 12.3
openSUSE 12.2
openSUSE 12.1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes two vulnerabilities is now available.
Description:
sudo was updated to fix two security issues, where
adjusting the time of the syste could be used to regain
access to sudo sessions if they onc were granted.
(CVE-2013-1775,CVE-2013-1776)
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.3:
zypper in -t patch openSUSE-2013-221
- openSUSE 12.2:
zypper in -t patch openSUSE-2013-221
- openSUSE 12.1:
zypper in -t patch openSUSE-2013-221
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.3 (i586 x86\_64):
sudo-1.8.6p3-3.5.1
sudo-debuginfo-1.8.6p3-3.5.1
sudo-debugsource-1.8.6p3-3.5.1
sudo-devel-1.8.6p3-3.5.1
- openSUSE 12.2 (i586 x86\_64):
sudo-1.8.5p2-2.4.1
sudo-debuginfo-1.8.5p2-2.4.1
sudo-debugsource-1.8.5p2-2.4.1
sudo-devel-1.8.5p2-2.4.1
- openSUSE 12.1 (i586 x86\_64):
sudo-1.8.2-2.14.1
sudo-debuginfo-1.8.2-2.14.1
sudo-debugsource-1.8.2-2.14.1
sudo-devel-1.8.2-2.14.1
References:
<http://support.novell.com/security/cve/CVE-2013-1775.html>
<http://support.novell.com/security/cve/CVE-2013-1776.html>
<https://bugzilla.novell.com/806919>
<https://bugzilla.novell.com/806921>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/W5ND7EZIDNKIBQSDIPDCKUIDVFQM2VQO/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/W5ND7EZIDNKIBQSDIPDCKUIDVFQM2VQO/#W5ND7EZIDNKIBQSDIPDCKUIDVFQM2VQO)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from bugzilla.novell.com_c7876d32_20250126_113209.html ===




=== Content from bugs.launchpad.net_461f27bb_20250126_113205.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/sudo/%2Bbug/87023/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[sudo package](https://launchpad.net/ubuntu/%2Bsource/sudo)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/sudo)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/sudo)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/sudo)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/sudo)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/sudo)

# sudo option "tty\_tickets" gives false sense of security due to reused pts numbers

Bug #87023 reported by
[kko](https://launchpad.net/~kko)
on 2007-02-22

[24](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [sudo (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/sudo "Latest release: 1.9.15p5-3ubuntu5, uploaded to main on 2024-04-08 14:55:52.105365+00:00 by Julian Andres Klode (juliank), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | Wishlist | Unassigned |  |

### Bug Description

Binary package hint: sudo

When we have the option "tty\_tickets" in '/etc/sudoers', for each new terminal (tty) or pseudo-terminal-slave (pts) where we use 'sudo', we get a sudo ticket in '/var/run/sudo/yourusername/'. These are named "tty1", "tty2" etc. for tty's, and "1", "2", "3", etc. for pts's.

Also, when we invoke a graphical instance of 'sudo' through e.g. 'kdesu', new pts's are reserved for this purpose. Applications started through 'kdesu' require \_two\_ pts's, and sudo tickets are assigned corresponding to the numbers of these pts's.

This report affects, as I understand it, both 'sudo' and 'kdesu'. I do not know what is the behaviour of 'gksudo' in relation to this bug, so I don't know if this report should also affect it.

Now, I will give three different scenarios in which 'sudo' or a graphical application requiring sudo capabilities can be run without a password, but when the user would \_not\_ expect to be able to do so.

N.B.: Before each scenario, we must be sure we have no active sudo tickets in the above mentioned directory. Doing 'sudo su', 'rm /var/run/sudo/yourusername/\*' and 'exit' in a terminal should be enough to ensure this. (I will start the examples from a clean desktop with e.g. no Konsole windows running. This is not completely necessary, as the \_absolute\_ numbers of pts's involved are not important to reproduce the behaviour.)

Useful commands for demonstrating what happens are:

'sudo ls --full-time /var/run/sudo/yourusername/'

'ps au' (to show which pts's are in use, and by what processes)

'tty' (run e.g. in Konsole to show which pts we are on)

Scenario 1:

- Open a Konsole (or Yakuake).

- Do 'sudo ls --full-time /var/run/sudo/yourusername', and give your password.

- Do 'tty'

- Do 'exit'. If you are in Konsole, this should close it completely -> now, start a new Konsole. If you are in Yakuake, it should do this automatically for you (spawn a new shell).

- \_Now\_, we have closed the console we used. It \_seems\_ reasonable to expect that after we closed the console where 'sudo' was used, the sudo capability would expire.

- Do 'sudo foo' or 'sudo ls --full-time /var/run/sudo/yourusername', and you can do this without giving your password.

- If we again do 'tty', we will see that we are re-using the previous pts number, which is the cause of this phenomenon.

Scenario 2:

- Open a Konsole (or Yakuake).

- Add a new terminal tab, and in this tab do 'sudo foo', giving your password. Do not close this tab.

- Add a third terminal tab, and in this tab do 'sudo foo', giving your password. Now we have three tabs open in Konsole or Yakuake.

- Close tabs two and three. (This will free two pts's.)

(- In the first tab, just to illustrate, run 'sudo ls --full-time /var/run/sudo/yourusername', again giving your password.)

- Run e.g. Adept or Synaptic, expecting to give your password. You should be able to do this without giving your password.

- If we again do 'sudo ls --full-time /var/run/sudo/yourusername' in the first terminal tab, we will notice that two of the timestamps have the same time. What happens is that 'kdesu' will utilise the first two free pts's, which we just freed, and which, incidentally, happened to have valid sudo timestamps.

Scenario 3:

(Optional: - Open a Konsole or Yakuake.)

- Run e.g. Adept or Synaptic, this time giving your password. Close it.

- Open two new Yakuake tabs or Konsole windows or tabs.

(- In the already opened terminal, do 'sudo ls --full-time /var/run/sudo/yourusername', which will give you the number of the valid sudo ticket.)

- In the second newly opened terminal, you should be able to run 'sudo foo' without giving your password. (IIRC, I have done this in the first new terminal instance sometime, possibly. It all depends on which pts number we are given. N.B. Normally 'kdesu' leaves behind only one valid sudo ticket, as in this scenario.)

(- You can do 'tty' to verify that this is the same terminal that we saw had the valid sudo ticket.)

I discovered this misbehaviour in sudo and applications that require sudo capabilities while investigating [bug #72545](/bugs/72545) (and [bug #50971](/bugs/50971)).

There are two separate issues here, as I understand it.

Issue 1. As implied by the title of this bug, this gives the user a false sense of security under some conditions.

Case 1.1: The user can (IMO rightly) expect that closing the terminal should \_remove sudo capabilities\_. It isn't intuitive to expect that a \_new\_ terminal instance should inherit previously affirmed sudo capabilities. When pts numbers get re-used and sudo tickets are not cleared, this is the resulting problem.

Case 1.2: The user can expect that launching a graphical application that requires sudo capability should \_always\_ ask for the password. (I won't go into separate password caching capabilities of these, I fear it may be an entirely separate can of worms.) As previously, it isn't intuitive to expect that this should inherit previously affirmed sudo capabilities. This case isn't \_necessarily\_ all that damaging, e.g. in the case of running Adept or Synaptic, \_but\_ wrong nonetheless; however, we can imagine a situation where a graphically launched application requiring sudo capabilities could harm the user's system, and would \_normally\_ alert the user's attention by requiring the user's password.

Case 1.3: Running a graphical application that requires sudo capability should \_not\_, in my opinion, leave behind a used sudo ticket that can be re-used in a terminal.

Issue 2. This is at least a theoretical vulnerability in the system, if this \_same\_ user's account can be exploited. As I understand it, pts numbers are assigned to remote connections as well, so by coincidence a remote connection could receive a used but recently freed pts that has a valid sudo tty\_ticket.

Case 2.0: If this user's account (in the "admin" group) and \_password\_ have been compromised, this is a \_non-issue\_. If the password is out, trying to exploit \_this\_ behaviour isn't necessary.

Case 2.1: If this user's account can be accessed otherwise, but the password isn't known, this would appear to be an issue. I don't think I can think of many scenarios where this could happen, but I imagine it is still at least a possibility. (Using 'tty\_tickets' is in this case of course more secure than the system would be without it.)

See [original description](comments/0)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [kko (kko)](https://launchpad.net/~kko) wrote on 2007-02-22: |  |  | [#1](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/1) |
| --- | --- | --- | --- |

As this issue seems somewhat hard to remedy completely, I decided to comment on possible remedies separately.

It would seem beneficial that unused tty\_tickets from '/var/run/sudo/yourusername' should be cleared. More specifically, the tickets for such tty's and pts's that \_are not in use\_ at any point in time should be cleared.

Now, what process could be responsible for doing this?

A. The kernel and "devpts", which is responsible for assigning new pts's at '/dev/pts/\*'. It could be argued that this would be the right place, to tackle the authorisation issue at a low level. It could also be argued the opposite, that authorisation issues do not belong here, that it is not the kernel's job to do things for sudo. This would mean that this should be handled in userspace.

B. A root level "sudo daemon" that would keep an eye on tty's and pts's on one hand and sudo's tty\_tickets on the other hand. Whenever a terminal or a pseudo-terminal is freed, the daemon would clear the appropriate sudo tty\_ticket for all users, and possibly make a note in a log. (The tty's probably would need to be handled differently than the pts's.)

C. For graphical applications requiring sudo access, the application that granted the access could also clear the ticket when the sudo capability isn't needed anymore. (E.g. 'kdesu' or 'kdesud'. It seems the 'kdesud' is used for caching the password given to 'kdesu'.)

D. A work-around is to use "timestamp\_timeout=0" in '/etc/sudoers', but this takes away a usability feature from sudo.

A couple non-working "solutions" follow:

E. "The command 'sudo' should be responsible for clearing the ticket." This can't be done, because sudo is not running when the terminal is freed.

F. "The terminal or 'bash' should be responsible." This can't be done because the terminal or the shell are not root-level processes, and so can't remove root-owned tty\_tickets.

As this issue seems somewhat hard to remedy completely, I decided to comment on possible remedies separately.
It would seem beneficial that unused tty\_tickets from '/var/run/sudo/yourusername' should be cleared. More specifically, the tickets for such tty's and pts's that \_are not in use\_ at any point in time should be cleared.
Now, what process could be responsible for doing this?
A. The kernel and "devpts", which is responsible for assigning new pts's at '/dev/pts/\*'. It could be argued that this would be the right place, to tackle the authorisation issue at a low level. It could also be argued the opposite, that authorisation issues do not belong here, that it is not the kernel's job to do things for sudo. This would mean that this should be handled in userspace.
B. A root level "sudo daemon" that would keep an eye on tty's and pts's on one hand and sudo's tty\_tickets on the other hand. Whenever a terminal or a pseudo-terminal is freed, the daemon would clear the appropriate sudo tty\_ticket for all users, and possibly make a note in a log. (The tty's probably would need to be handled differently than the pts's.)
C. For graphical applications requiring sudo access, the application that granted the access could also clear the ticket when the sudo capability isn't needed anymore. (E.g. 'kdesu' or 'kdesud'. It seems the 'kdesud' is used for caching the password given to 'kdesu'.)
D. A work-around is to use "timestamp\_timeout=0" in '/etc/sudoers', but this takes away a usability feature from sudo.
A couple non-working "solutions" follow:
E. "The command 'sudo' should be responsible for clearing the ticket." This can't be done, because sudo is not running when the terminal is freed.
F. "The terminal or 'bash' should be responsible." This can't be done because the terminal or the shell are not root-level processes, and so can't remove root-owned tty\_tickets.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [kko (kko)](https://launchpad.net/~kko) wrote on 2007-02-22: |  |  | [#2](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/2) |
| --- | --- | --- | --- |

One more possible solution / workaround:

G. For (primarily) \_non\_-graphical use-cases of sudo, and to clean-up after graphical applications that lack this functionality -> A new usage option for 'sudo' that is like 'sudo -K' but, instead of only operating on the ticket of the current terminal, cleans \_all\_ the tickets in '/var/run/sudo/yourusername/'.

The possible downside is that this requires that the user manually (or semi-manually) evokes it. The upside is the same as that stated in 'man sudo' for 'sudo -k' (and, implied, for 'sudo -K'): "This option does not require a password and was added to allow a user to revoke sudo permissions from a .logout file."

As demonstrated by this report and some others, it is quite easy and all the more common to have a number of terminals open, and to use 'sudo' in those or through graphical means. In view of this, I think the option presented here would often prove useful. I wouldn't actually mind if 'sudo -K' would operate on all of the current user's tickets by default.

One more possible solution / workaround:
G. For (primarily) \_non\_-graphical use-cases of sudo, and to clean-up after graphical applications that lack this functionality -> A new usage option for 'sudo' that is like 'sudo -K' but, instead of only operating on the ticket of the current terminal, cleans \_all\_ the tickets in '/var/run/sudo/yourusername/'.
The possible downside is that this requires that the user manually (or semi-manually) evokes it. The upside is the same as that stated in 'man sudo' for 'sudo -k' (and, implied, for 'sudo -K'): "This option does not require a password and was added to allow a user to revoke sudo permissions from a .logout file."
As demonstrated by this report and some others, it is quite easy and all the more common to have a number of terminals open, and to use 'sudo' in those or through graphical means. In view of this, I think the option presented here would often prove useful. I wouldn't actually mind if 'sudo -K' would operate on all of the current user's tickets by default.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kees Cook (kees)](https://launchpad.net/~kees) wrote on 2007-02-22: |  |  | [#3](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/3) |
| --- | --- | --- | --- |

Thanks for this well-described bug report! I wonder if some people would describe the "authenticated old tty" issue as a "feature"? I would tend to agree, though, that it is surprising to open a terminal and not get prompted. I find your "Issue 2" the most compelling -- this should not be allowed to happen.

As you've hinted, the "original" solution, in the design of sudo in general, was for users to add "sudo -K" to their ~/.bash\_logout file. However, I suspect that isn't a proper solution (especially for gksu/kdesu). I haven't checked, but if udev receives notifications about pts devices being removed, perhaps it could be responsible for running "sudo -K" (or something similar)? That might solve all three scenarios, though I'm curious about the double pts allocation with kdesu.

Thanks for this well-described bug report! I wonder if some people would describe the "authenticated old tty" issue as a "feature"? I would tend to agree, though, that it is surprising to open a terminal and not get prompted. I find your "Issue 2" the most compelling -- this should not be allowed to happen.
As you've hinted, the "original" solution, in the design of sudo in general, was for users to add "sudo -K" to their ~/.bash\_logout file. However, I suspect that isn't a proper solution (especially for gksu/kdesu). I haven't checked, but if udev receives notifications about pts devices being removed, perhaps it could be responsible for running "sudo -K" (or something similar)? That might solve all three scenarios, though I'm curious about the double pts allocation with kdesu.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [kko (kko)](https://launchpad.net/~kko) wrote on 2007-02-22: |  |  | [#4](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/4) |
| --- | --- | --- | --- |

The double pts requirement with 'kdesu' could (even) be by design to "circumvent" the issue of old tickets lying around (compare with the bugs referenced above), but this would be bad design. It seems more likely, though, that it is just a side effect of starting a process and then forking it into different parts that have different tasks.

The double pts requirement with 'kdesu' could (even) be by design to "circumvent" the issue of old tickets lying around (compare with the bugs referenced above), but this would be bad design. It seems more likely, though, that it is just a side effect of starting a process and then forking it into different parts that have different tasks.

| **description**: | updated |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [kko (kko)](https://launchpad.net/~kko) wrote on 2007-02-22: |  |  | [#5](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/5) |
| --- | --- | --- | --- |

Also, what is problematic with the cases under "Issue 1", is that these cross the border between graphical and command line sudo access, which is very unintuitive for the user. It's OK if 'kdesu' remembers that I've just given my password, \_if\_ I've accepted this in its options. However, having a sudo capable shell isn't really OK, if I've only given my password to 'kdesu'. And vice versa.

(As a parenthesis: A real-life case I can think of is wanting to try out and './install' some 3rd party software, which has its own installation method (be it text-based or graphical). This could even have the option to \_either\_ install globally (if given the permissions) or as a fall-back to install locally for the user only. A password prompt at this point is very indicative to the user about where exactly things will be installed, and missing the password prompt can lead, at best, to confusion.)

Also, what is problematic with the cases under "Issue 1", is that these cross the border between graphical and command line sudo access, which is very unintuitive for the user. It's OK if 'kdesu' remembers that I've just given my password, \_if\_ I've accepted this in its options. However, having a sudo capable shell isn't really OK, if I've only given my password to 'kdesu'. And vice versa.
(As a parenthesis: A real-life case I can think of is wanting to try out and './install' some 3rd party software, which has its own installation method (be it text-based or graphical). This could even have the option to \_either\_ install globally (if given the permissions) or as a fall-back to install locally for the user only. A password prompt at this point is very indicative to the user about where exactly things will be installed, and missing the password prompt can lead, at best, to confusion.)

[Kees Cook (kees)](https://launchpad.net/~kees)
on 2007-02-22

| Changed in sudo: | |
| --- | --- |
| **status**: | Unconfirmed → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kees Cook (kees)](https://launchpad.net/~kees) wrote on 2007-02-22: |  |  | [#6](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/6) |
| --- | --- | --- | --- |

After talking to gregkh and hpa, it seems there are no udev events for pts add/remove. :( To do this, the pts kernel could would need to be written to use kobjects.

After talking to gregkh and hpa, it seems there are no udev events for pts add/remove. :( To do this, the pts kernel could would need to be written to use kobjects.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kees Cook (kees)](https://launchpad.net/~kees) wrote on 2007-02-22: |  |  | [#7](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/7) |
| --- | --- | --- | --- |

That should read "the pts kernel code would need to be written to use kobjects."

That should read "the pts kernel code would need to be written to use kobjects."

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [kko (kko)](https://launchpad.net/~kko) wrote on 2007-02-26: |  |  | [#8](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/8) |
| --- | --- | --- | --- |

I'm wondering - should this report be marked as concerning also 'kdesu', i.e. "kdebase", due to it leaving behind a valid sudo ticket?

Also, I am curious to know - does 'gksudo' leave behind a valid sudo ticket, or is the ticket cleared afterwards? (And, consequently, if a ticket is left behind, should this report be marked as also concerning the package providing 'gksudo'?)

I'm wondering - should this report be marked as concerning also 'kdesu', i.e. "kdebase", due to it leaving behind a valid sudo ticket?
Also, I am curious to know - does 'gksudo' leave behind a valid sudo ticket, or is the ticket cleared afterwards? (And, consequently, if a ticket is left behind, should this report be marked as also concerning the package providing 'gksudo'?)

| **description**: | updated |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Martin Pitt (pitti)](https://launchpad.net/~pitti) wrote on 2007-02-27: |  |  | [#9](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/9) |
| --- | --- | --- | --- |

kko: No, this only affects sudo and perhaps udev -- things like kdesu that build on top of sudo do not have any particular privileges and cannot fiddle with tickets.

kko: No, this only affects sudo and perhaps udev -- things like kdesu that build on top of sudo do not have any particular privileges and cannot fiddle with tickets.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [kko (kko)](https://launchpad.net/~kko) wrote on 2007-02-27: |  |  | [#10](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/10) |
| --- | --- | --- | --- |

Thank you for the information. Taking a look at kdesu's permissions I see what you mean.

Thank you for the information. Taking a look at kdesu's permissions I see what you mean.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kees Cook (kees)](https://launchpad.net/~kees) wrote on 2007-02-27: |  |  | [#11](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/11) |
| --- | --- | --- | --- |

I see a few options for dealing with console log-outs:

1) Add "sudo -K" to /etc/skel/.bash\_logout via patch to bash pkg. (This doesn't catch upgrades, and doesn't handle people not using bash.)

2) Dig into pam's session management and write new module to be added as login and ssh required "session" modules. (Seems a bit sloppy.)

3) Using a recent patch to mainline, write a logout-watching daemon that cleans up after sudo when a pts goes away (this seems really like too heavy a solution)

4) Patch the pts code to use kobjects and hook up a listener to "remove" events. (This is a lot of work.)

As for the GUI apps, I think sudo (and the GUI su-ing apps) should be patched to add something like "--single-shot", where no tty-based ticket is left behind.

I see a few options for dealing with console log-outs:
1) Add "sudo -K" to /etc/skel/.bash\_logout via patch to bash pkg. (This doesn't catch upgrades, and doesn't handle people not using bash.)
2) Dig into pam's session management and write new module to be added as login and ssh required "session" modules. (Seems a bit sloppy.)
3) Using a recent patch to mainline, write a logout-watching daemon that cleans up after sudo when a pts goes away (this seems really like too heavy a solution)
4) Patch the pts code to use kobjects and hook up a listener to "remove" events. (This is a lot of work.)
As for the GUI apps, I think sudo (and the GUI su-ing apps) should be patched to add something like "--single-shot", where no tty-based ticket is left behind.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [kko (kko)](https://launchpad.net/~kko) wrote on 2007-02-28: |  |  | [#12](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/12) |
| --- | --- | --- | --- |

Incidentally, I was pondering this too, after my last comment, so I'll comment on these suggestions.

For GUI apps, I agree with you. It should be easy for 'kdesu' or 'gksudo' to:

- Obtain needed privileges and launch the app requiring sudo privileges.

- Immediately afterwards call 'sudo -K' on the appropriate pts.

This should take care of the GUI side of the problem - see further though.

I don't really understand how 'kdesud' is supposed to work. I suppose it just sits there for as long as kdesu is configured to remember the password given to it, and is supposed to catch further launches of 'kdesu'. (It doesn't for me, so I wonder \_why\_ it is launched at all, but it's a different issue.) I don't know if 'kdesud' needs the ticket at all - according to 'man kdesu' it wouldn't: "The passwords are NOT written to disk, but stored in memory using a special program, kdesud."

If the ticket isn't needed to implement the grace period (i.e. remembering the password for a set time) functionality in GUI sudo apps, the option "--single-shot" definitely sounds like a cleaner way to implement this.

For the CLI, I tend to agree that your suggestions 3 and 4 seem heavy, although number 4 would probably be a good solution. I can't really say anything about suggestion 2.

I came up with the same thought as your suggestion 1 also. Basically, I thought it would be useful, but while trying it out I found a serious drawback. Unfortunately, .bash\_logout is only handled for \_login\_ shells, i.e. it is not executed for inter-active shells from Konsole. (People can also remove '~/.bash\_logout', but then it's their choice. I also wondered about the case where the shell (e.g. hanged and) got terminated in an abnormal way and it couldn't execute the logout script - in this case a solution not dependent on the shell would be more reliable.)

Incidentally, I was pondering this too, after my last comment, so I'll comment on these suggestions.
For GUI apps, I agree with you. It should be easy for 'kdesu' or 'gksudo' to:
- Obtain needed privileges and launch the app requiring sudo privileges.
- Immediately afterwards call 'sudo -K' on the appropriate pts.
This should take care of the GUI side of the problem - see further though.
I don't really understand how 'kdesud' is supposed to work. I suppose it just sits there for as long as kdesu is configured to remember the password given to it, and is supposed to catch further launches of 'kdesu'. (It doesn't for me, so I wonder \_why\_ it is launched at all, but it's a different issue.) I don't know if 'kdesud' needs the ticket at all - according to 'man kdesu' it wouldn't: "The passwords are NOT written to disk, but stored in memory using a special program, kdesud."
If the ticket isn't needed to implement the grace period (i.e. remembering the password for a set time) functionality in GUI sudo apps, the option "--single-shot" definitely sounds like a cleaner way to implement this.
For the CLI, I tend to agree that your suggestions 3 and 4 seem heavy, although number 4 would probably be a good solution. I can't really say anything about suggestion 2.
I came up with the same thought as your suggestion 1 also. Basically, I thought it would be useful, but while trying it out I found a serious drawback. Unfortunately, .bash\_logout is only handled for \_login\_ shells, i.e. it is not executed for inter-active shells from Konsole. (People can also remove '~/.bash\_logout', but then it's their choice. I also wondered about the case where the shell (e.g. hanged and) got terminated in an abnormal way and it couldn't execute the logout script - in this case a solution not dependent on the shell would be more reliable.)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Laager (rlaager)](https://launchpad.net/~rlaager) wrote on 2008-07-16: |  |  | [#13](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/13) |
| --- | --- | --- | --- |

Calling sudo -K from a GUI sudo wrapper is a bad idea. It would invalidate any tickets for other terminals as well. Solutions #2 and #4 seem reasonable. I think #2 would be easier to do, but I'm not an expert on any of this.

Calling sudo -K from a GUI sudo wrapper is a bad idea. It would invalidate any tickets for other terminals as well. Solutions #2 and #4 seem reasonable. I think #2 would be easier to do, but I'm not an expert on any of this.

[Kees Cook (kees)](https://launchpad.net/~kees)
on 2009-04-16

| Changed in sudo (Ubuntu): | |
| --- | --- |
| **importance**: | Undecided → Wishlist |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Joshua Kwan (joshk)](https://launchpad.net/~joshk) wrote on 2009-07-09: |  |  | [#14](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/14) |
| --- | --- | --- | --- |

FYI, gksu (as of libgksu version 2.0.11) allocates a new pseudoterminal, runs sudo -v to acquire a token, then uses g\_spawn\_sync in the parent process once the authentication is successful. (This allows gksu to be executed with the 'Defaults requiretty' option, which is enabled by default on RHEL.) Obviously, this fix doesn't work properly with the tty\_tickets option. I'm going to write another patch to try and address this issue.

Until then, I wouldn't be using the new libgksu in Karmic!

FYI, gksu (as of libgksu version 2.0.11) allocates a new pseudoterminal, runs sudo -v to acquire a token, then uses g\_spawn\_sync in the parent process once the authentication is successful. (This allows gksu to be executed with the 'Defaults requiretty' option, which is enabled by default on RHEL.) Obviously, this fix doesn't work properly with the tty\_tickets option. I'm going to write another patch to try and address this issue.
Until then, I wouldn't be using the new libgksu in Karmic!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Leonid Evdokimov (darkk)](https://launchpad.net/~darkk) wrote on 2009-11-14: |  |  | [#15](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/15) |
| --- | --- | --- | --- |

I have part of idea of another workaround for pty (but not for tty).

Open console:

$ ls -l --full-time --time=ctime `tty`

crw------- 1 darkk tty 136, 2 2009-11-14 15:41:39.260720360 +0600 /dev/pts/2

Close console, open console again:

$ ls -l --full-time --time=ctime `tty`

crw------- 1 darkk tty 136, 2 2009-11-14 15:43:31.320713474 +0600 /dev/pts/2

So ticket may include ctime of pty.

On the other hand, malicious attacker can change ctime of the /dev/pts/2 and he may get correct ctime watching /dev/pts (he can't get ctime from ticket data). I don't know if it may be avoided using something like POSIX ACL's and I assume that POSIX ACL's are not supported by ptsfs. Maybe someone has better idea.

I have part of idea of another workaround for pty (but not for tty).
Open console:
$ ls -l --full-time --time=ctime `tty`
crw------- 1 darkk tty 136, 2 2009-11-14 15:41:39.260720360 +0600 /dev/pts/2
Close console, open console again:
$ ls -l --full-time --time=ctime `tty`
crw------- 1 darkk tty 136, 2 2009-11-14 15:43:31.320713474 +0600 /dev/pts/2
So ticket may include ctime of pty.
On the other hand, malicious attacker can change ctime of the /dev/pts/2 and he may get correct ctime watching /dev/pts (he can't get ctime from ticket data). I don't know if it may be avoided using something like POSIX ACL's and I assume that POSIX ACL's are not supported by ptsfs. Maybe someone has better idea.

[Kees Cook (kees)](https://launchpad.net/~kees)
on 2011-04-27

| **security vulnerability**: | yes → no |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Removed by request (removed3425744)](https://launchpad.net/~removed3425744) wrote on 2013-12-17: |  |  | [#16](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/16) |
| --- | --- | --- | --- |

This report is now a few years old and I'm seeing an interesting behavior of sudo:

1. First I'm Cleaning /var/lib/sudo/$USER as root with "rm -rf /var/lib/sudo/sworddragon/\*".

2. Then I'm opening a terminal with my user account.

3. Typing tty returns /dev/pts/2.

4. Then I'm typing "sudo true" and entering my correct password.

5. Typing "md5sum /var/lib/sudo/sworddragon/2" as root returns "6ec673eac24f4e2fc0c5fa149eebfcef /var/lib/sudo/sworddragon/2"

6. Then I'm closing the terminal on /dev/pts/2 and opening it again.

7. Typing tty returns /dev/pts/2.

8. On typing sudo true I'm asked again for my password.

9. Instead of typing my password I'm typing now as root again "md5sum /var/lib/sudo/sworddragon/2" which returns "6ec673eac24f4e2fc0c5fa149eebfcef /var/lib/sudo/sworddragon/2".

10. Typing "ls -a /var/lib/sudo/sworddragon" as root returns ". .. 2".

This means even on getting the same pts without expiring of /var/lib/sudo/sworddragon/2 sudo asks me for my password. Can somebody tell me where is hiding the security mechanism here? Also are the cases in this ticket still a problem or are they maybe already fixed?

This report is now a few years old and I'm seeing an interesting behavior of sudo:
1. First I'm Cleaning /var/lib/sudo/$USER as root with "rm -rf /var/lib/sudo/sworddragon/\*".
2. Then I'm opening a terminal with my user account.
3. Typing tty returns /dev/pts/2.
4. Then I'm typing "sudo true" and entering my correct password.
5. Typing "md5sum /var/lib/sudo/sworddragon/2" as root returns "6ec673eac24f4e2fc0c5fa149eebfcef /var/lib/sudo/sworddragon/2"
6. Then I'm closing the terminal on /dev/pts/2 and opening it again.
7. Typing tty returns /dev/pts/2.
8. On typing sudo true I'm asked again for my password.
9. Instead of typing my password I'm typing now as root again "md5sum /var/lib/sudo/sworddragon/2" which returns "6ec673eac24f4e2fc0c5fa149eebfcef /var/lib/sudo/sworddragon/2".
10. Typing "ls -a /var/lib/sudo/sworddragon" as root returns ". .. 2".
This means even on getting the same pts without expiring of /var/lib/sudo/sworddragon/2 sudo asks me for my password. Can somebody tell me where is hiding the security mechanism here? Also are the cases in this ticket still a problem or are they maybe already fixed?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2013-12-17: |  |  | [#17](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/17) |
| --- | --- | --- | --- |

Sworddragon, I believe this code from plugins/sudoers/check.c in check\_user() prevents the tty reuse problem:

/\* Stash the tty's ctime for tty ticket comparison. \*/

    if (def\_tty\_tickets && user\_ttypath && stat(user\_ttypath, &sb) == 0) {

        tty\_info.dev = sb.st\_dev;

        tty\_info.ino = sb.st\_ino;

        tty\_info.rdev = sb.st\_rdev;

        if (tty\_is\_devpts(user\_ttypath))

            ctim\_get(&sb, &tty\_info.ctime);

    }

if (build\_timestamp(&timestampdir, &timestampfile) == -1) {

        rval = -1;

        goto done;

    }

status = timestamp\_status(timestampdir, timestampfile, user\_name,

        TS\_MAKE\_DIRS);

if (status != TS\_CURRENT || ISSET(validated, FLAG\_CHECK\_USER)) {

        /\* Bail out if we are non-interactive and a password is required \*/

        if (ISSET(mode, MODE\_NONINTERACTIVE)) {

            warningx(\_("sorry, a password is required to run %s"), getprogname());

            rval = -1;

            goto done;

        }

/\* XXX - should not lecture if askpass helper is being used. \*/

        lecture(status);

/\* Expand any escapes in the prompt. \*/

        prompt = expand\_prompt(user\_prompt ? user\_prompt : def\_passprompt,

            user\_name, user\_shost);

rval = verify\_user(auth\_pw, prompt);

    }

    /\* Only update timestamp if user was validated. \*/

    if (rval == TRUE && ISSET(validated, VALIDATE\_OK) &&

        !ISSET(mode, MODE\_IGNORE\_TICKET) && status != TS\_ERROR)

        update\_timestamp(timestampdir, timestampfile);

Thanks

Sworddragon, I believe this code from plugins/sudoers/check.c in check\_user() prevents the tty reuse problem:
/\* Stash the tty's ctime for tty ticket comparison. \*/
if (def\_tty\_tickets && user\_ttypath && stat(user\_ttypath, &sb) == 0) {
tty\_info.dev = sb.st\_dev;
tty\_info.ino = sb.st\_ino;
tty\_info.rdev = sb.st\_rdev;
if (tty\_is\_devpts(user\_ttypath))
ctim\_get(&sb, &tty\_info.ctime);
}
if (build\_timestamp(&timestampdir, &timestampfile) == -1) {
rval = -1;
goto done;
}
status = timestamp\_status(timestampdir, timestampfile, user\_name,
TS\_MAKE\_DIRS);
if (status != TS\_CURRENT || ISSET(validated, FLAG\_CHECK\_USER)) {
/\* Bail out if we are non-interactive and a password is required \*/
if (ISSET(mode, MODE\_NONINTERACTIVE)) {
warningx(\_("sorry, a password is required to run %s"), getprogname());
rval = -1;
goto done;
}
/\* XXX - should not lecture if askpass helper is being used. \*/
lecture(status);
/\* Expand any escapes in the prompt. \*/
prompt = expand\_prompt(user\_prompt ? user\_prompt : def\_passprompt,
user\_name, user\_shost);
rval = verify\_user(auth\_pw, prompt);
}
/\* Only update timestamp if user was validated. \*/
if (rval == TRUE && ISSET(validated, VALIDATE\_OK) &&
!ISSET(mode, MODE\_IGNORE\_TICKET) && status != TS\_ERROR)
update\_timestamp(timestampdir, timestampfile);
Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Removed by request (removed3425744)](https://launchpad.net/~removed3425744) wrote on 2013-12-18: |  |  | [#18](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/18) |
| --- | --- | --- | --- |

Thanks for the answer. If I'm not wrong ctime has a nanosecond resolution. The only way to abuse this is if:

- The tty/pts gets closed.

- The time adjusts to the past (for example due to ntp).

- The next opened console/terminal gets the same number and is created exactly at the same time.

While this is theoretically possible it should only be seen as an extremely rare race-condition. Also normally while the user opens a terminal, types sudo and enters his password at least a few seconds will be gone. Normally the adjustment of ntp is only a few milliseconds. If I'm not wrong here too ntp refuses to adjust the time to a too far point.

So this is a very nice security mechanism of sudo (does gksudo build on sudo too and benefit from this?).

Thanks for the answer. If I'm not wrong ctime has a nanosecond resolution. The only way to abuse this is if:
- The tty/pts gets closed.
- The time adjusts to the past (for example due to ntp).
- The next opened console/terminal gets the same number and is created exactly at the same time.
While this is theoretically possible it should only be seen as an extremely rare race-condition. Also normally while the user opens a terminal, types sudo and enters his password at least a few seconds will be gone. Normally the adjustment of ntp is only a few milliseconds. If I'm not wrong here too ntp refuses to adjust the time to a too far point.
So this is a very nice security mechanism of sudo (does gksudo build on sudo too and benefit from this?).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Laager (rlaager)](https://launchpad.net/~rlaager) wrote on 2016-04-25: |  |  | [#19](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/19) |
| --- | --- | --- | --- |

I might be overstepping here, but I'm marking this as Fix Released. I can confirm, as with comment #16, that this is no longer an issue. I'm on Vivid.

I might be overstepping here, but I'm marking this as Fix Released. I can confirm, as with comment #16, that this is no longer an issue. I'm on Vivid.

| Changed in sudo (Ubuntu): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/sudo/%2Bbug/87023/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/sudo/%2Bfilebug)

This report contains
**Public**
information

Everyone can see this information.

## Duplicates of this bug

* [Bug #61059](https://bugs.launchpad.net/ubuntu/%2Bsource/sudo/%2Bbug/61059 "I managed to perform the command: \"sudo apt-get install\" without being asked for a password")

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/sudo/%2Bbug/87023/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/sudo/%2Bbug/87023/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/sudo/%2Bbug/87023/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_8d2fb512_20250126_113204.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/sudo/%2Bbug/87023/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[sudo package](https://launchpad.net/ubuntu/%2Bsource/sudo)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/sudo)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/sudo)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/sudo)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/sudo)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/sudo)

# sudo option "tty\_tickets" gives false sense of security due to reused pts numbers

Bug #87023 reported by
[kko](https://launchpad.net/~kko)
on 2007-02-22

[24](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [sudo (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/sudo "Latest release: 1.9.15p5-3ubuntu5, uploaded to main on 2024-04-08 14:55:52.105365+00:00 by Julian Andres Klode (juliank), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | Wishlist | Unassigned |  |

### Bug Description

Binary package hint: sudo

When we have the option "tty\_tickets" in '/etc/sudoers', for each new terminal (tty) or pseudo-terminal-slave (pts) where we use 'sudo', we get a sudo ticket in '/var/run/sudo/yourusername/'. These are named "tty1", "tty2" etc. for tty's, and "1", "2", "3", etc. for pts's.

Also, when we invoke a graphical instance of 'sudo' through e.g. 'kdesu', new pts's are reserved for this purpose. Applications started through 'kdesu' require \_two\_ pts's, and sudo tickets are assigned corresponding to the numbers of these pts's.

This report affects, as I understand it, both 'sudo' and 'kdesu'. I do not know what is the behaviour of 'gksudo' in relation to this bug, so I don't know if this report should also affect it.

Now, I will give three different scenarios in which 'sudo' or a graphical application requiring sudo capabilities can be run without a password, but when the user would \_not\_ expect to be able to do so.

N.B.: Before each scenario, we must be sure we have no active sudo tickets in the above mentioned directory. Doing 'sudo su', 'rm /var/run/sudo/yourusername/\*' and 'exit' in a terminal should be enough to ensure this. (I will start the examples from a clean desktop with e.g. no Konsole windows running. This is not completely necessary, as the \_absolute\_ numbers of pts's involved are not important to reproduce the behaviour.)

Useful commands for demonstrating what happens are:

'sudo ls --full-time /var/run/sudo/yourusername/'

'ps au' (to show which pts's are in use, and by what processes)

'tty' (run e.g. in Konsole to show which pts we are on)

Scenario 1:

- Open a Konsole (or Yakuake).

- Do 'sudo ls --full-time /var/run/sudo/yourusername', and give your password.

- Do 'tty'

- Do 'exit'. If you are in Konsole, this should close it completely -> now, start a new Konsole. If you are in Yakuake, it should do this automatically for you (spawn a new shell).

- \_Now\_, we have closed the console we used. It \_seems\_ reasonable to expect that after we closed the console where 'sudo' was used, the sudo capability would expire.

- Do 'sudo foo' or 'sudo ls --full-time /var/run/sudo/yourusername', and you can do this without giving your password.

- If we again do 'tty', we will see that we are re-using the previous pts number, which is the cause of this phenomenon.

Scenario 2:

- Open a Konsole (or Yakuake).

- Add a new terminal tab, and in this tab do 'sudo foo', giving your password. Do not close this tab.

- Add a third terminal tab, and in this tab do 'sudo foo', giving your password. Now we have three tabs open in Konsole or Yakuake.

- Close tabs two and three. (This will free two pts's.)

(- In the first tab, just to illustrate, run 'sudo ls --full-time /var/run/sudo/yourusername', again giving your password.)

- Run e.g. Adept or Synaptic, expecting to give your password. You should be able to do this without giving your password.

- If we again do 'sudo ls --full-time /var/run/sudo/yourusername' in the first terminal tab, we will notice that two of the timestamps have the same time. What happens is that 'kdesu' will utilise the first two free pts's, which we just freed, and which, incidentally, happened to have valid sudo timestamps.

Scenario 3:

(Optional: - Open a Konsole or Yakuake.)

- Run e.g. Adept or Synaptic, this time giving your password. Close it.

- Open two new Yakuake tabs or Konsole windows or tabs.

(- In the already opened terminal, do 'sudo ls --full-time /var/run/sudo/yourusername', which will give you the number of the valid sudo ticket.)

- In the second newly opened terminal, you should be able to run 'sudo foo' without giving your password. (IIRC, I have done this in the first new terminal instance sometime, possibly. It all depends on which pts number we are given. N.B. Normally 'kdesu' leaves behind only one valid sudo ticket, as in this scenario.)

(- You can do 'tty' to verify that this is the same terminal that we saw had the valid sudo ticket.)

I discovered this misbehaviour in sudo and applications that require sudo capabilities while investigating [bug #72545](/bugs/72545) (and [bug #50971](/bugs/50971)).

There are two separate issues here, as I understand it.

Issue 1. As implied by the title of this bug, this gives the user a false sense of security under some conditions.

Case 1.1: The user can (IMO rightly) expect that closing the terminal should \_remove sudo capabilities\_. It isn't intuitive to expect that a \_new\_ terminal instance should inherit previously affirmed sudo capabilities. When pts numbers get re-used and sudo tickets are not cleared, this is the resulting problem.

Case 1.2: The user can expect that launching a graphical application that requires sudo capability should \_always\_ ask for the password. (I won't go into separate password caching capabilities of these, I fear it may be an entirely separate can of worms.) As previously, it isn't intuitive to expect that this should inherit previously affirmed sudo capabilities. This case isn't \_necessarily\_ all that damaging, e.g. in the case of running Adept or Synaptic, \_but\_ wrong nonetheless; however, we can imagine a situation where a graphically launched application requiring sudo capabilities could harm the user's system, and would \_normally\_ alert the user's attention by requiring the user's password.

Case 1.3: Running a graphical application that requires sudo capability should \_not\_, in my opinion, leave behind a used sudo ticket that can be re-used in a terminal.

Issue 2. This is at least a theoretical vulnerability in the system, if this \_same\_ user's account can be exploited. As I understand it, pts numbers are assigned to remote connections as well, so by coincidence a remote connection could receive a used but recently freed pts that has a valid sudo tty\_ticket.

Case 2.0: If this user's account (in the "admin" group) and \_password\_ have been compromised, this is a \_non-issue\_. If the password is out, trying to exploit \_this\_ behaviour isn't necessary.

Case 2.1: If this user's account can be accessed otherwise, but the password isn't known, this would appear to be an issue. I don't think I can think of many scenarios where this could happen, but I imagine it is still at least a possibility. (Using 'tty\_tickets' is in this case of course more secure than the system would be without it.)

See [original description](comments/0)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [kko (kko)](https://launchpad.net/~kko) wrote on 2007-02-22: |  |  | [#1](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/1) |
| --- | --- | --- | --- |

As this issue seems somewhat hard to remedy completely, I decided to comment on possible remedies separately.

It would seem beneficial that unused tty\_tickets from '/var/run/sudo/yourusername' should be cleared. More specifically, the tickets for such tty's and pts's that \_are not in use\_ at any point in time should be cleared.

Now, what process could be responsible for doing this?

A. The kernel and "devpts", which is responsible for assigning new pts's at '/dev/pts/\*'. It could be argued that this would be the right place, to tackle the authorisation issue at a low level. It could also be argued the opposite, that authorisation issues do not belong here, that it is not the kernel's job to do things for sudo. This would mean that this should be handled in userspace.

B. A root level "sudo daemon" that would keep an eye on tty's and pts's on one hand and sudo's tty\_tickets on the other hand. Whenever a terminal or a pseudo-terminal is freed, the daemon would clear the appropriate sudo tty\_ticket for all users, and possibly make a note in a log. (The tty's probably would need to be handled differently than the pts's.)

C. For graphical applications requiring sudo access, the application that granted the access could also clear the ticket when the sudo capability isn't needed anymore. (E.g. 'kdesu' or 'kdesud'. It seems the 'kdesud' is used for caching the password given to 'kdesu'.)

D. A work-around is to use "timestamp\_timeout=0" in '/etc/sudoers', but this takes away a usability feature from sudo.

A couple non-working "solutions" follow:

E. "The command 'sudo' should be responsible for clearing the ticket." This can't be done, because sudo is not running when the terminal is freed.

F. "The terminal or 'bash' should be responsible." This can't be done because the terminal or the shell are not root-level processes, and so can't remove root-owned tty\_tickets.

As this issue seems somewhat hard to remedy completely, I decided to comment on possible remedies separately.
It would seem beneficial that unused tty\_tickets from '/var/run/sudo/yourusername' should be cleared. More specifically, the tickets for such tty's and pts's that \_are not in use\_ at any point in time should be cleared.
Now, what process could be responsible for doing this?
A. The kernel and "devpts", which is responsible for assigning new pts's at '/dev/pts/\*'. It could be argued that this would be the right place, to tackle the authorisation issue at a low level. It could also be argued the opposite, that authorisation issues do not belong here, that it is not the kernel's job to do things for sudo. This would mean that this should be handled in userspace.
B. A root level "sudo daemon" that would keep an eye on tty's and pts's on one hand and sudo's tty\_tickets on the other hand. Whenever a terminal or a pseudo-terminal is freed, the daemon would clear the appropriate sudo tty\_ticket for all users, and possibly make a note in a log. (The tty's probably would need to be handled differently than the pts's.)
C. For graphical applications requiring sudo access, the application that granted the access could also clear the ticket when the sudo capability isn't needed anymore. (E.g. 'kdesu' or 'kdesud'. It seems the 'kdesud' is used for caching the password given to 'kdesu'.)
D. A work-around is to use "timestamp\_timeout=0" in '/etc/sudoers', but this takes away a usability feature from sudo.
A couple non-working "solutions" follow:
E. "The command 'sudo' should be responsible for clearing the ticket." This can't be done, because sudo is not running when the terminal is freed.
F. "The terminal or 'bash' should be responsible." This can't be done because the terminal or the shell are not root-level processes, and so can't remove root-owned tty\_tickets.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [kko (kko)](https://launchpad.net/~kko) wrote on 2007-02-22: |  |  | [#2](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/2) |
| --- | --- | --- | --- |

One more possible solution / workaround:

G. For (primarily) \_non\_-graphical use-cases of sudo, and to clean-up after graphical applications that lack this functionality -> A new usage option for 'sudo' that is like 'sudo -K' but, instead of only operating on the ticket of the current terminal, cleans \_all\_ the tickets in '/var/run/sudo/yourusername/'.

The possible downside is that this requires that the user manually (or semi-manually) evokes it. The upside is the same as that stated in 'man sudo' for 'sudo -k' (and, implied, for 'sudo -K'): "This option does not require a password and was added to allow a user to revoke sudo permissions from a .logout file."

As demonstrated by this report and some others, it is quite easy and all the more common to have a number of terminals open, and to use 'sudo' in those or through graphical means. In view of this, I think the option presented here would often prove useful. I wouldn't actually mind if 'sudo -K' would operate on all of the current user's tickets by default.

One more possible solution / workaround:
G. For (primarily) \_non\_-graphical use-cases of sudo, and to clean-up after graphical applications that lack this functionality -> A new usage option for 'sudo' that is like 'sudo -K' but, instead of only operating on the ticket of the current terminal, cleans \_all\_ the tickets in '/var/run/sudo/yourusername/'.
The possible downside is that this requires that the user manually (or semi-manually) evokes it. The upside is the same as that stated in 'man sudo' for 'sudo -k' (and, implied, for 'sudo -K'): "This option does not require a password and was added to allow a user to revoke sudo permissions from a .logout file."
As demonstrated by this report and some others, it is quite easy and all the more common to have a number of terminals open, and to use 'sudo' in those or through graphical means. In view of this, I think the option presented here would often prove useful. I wouldn't actually mind if 'sudo -K' would operate on all of the current user's tickets by default.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kees Cook (kees)](https://launchpad.net/~kees) wrote on 2007-02-22: |  |  | [#3](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/3) |
| --- | --- | --- | --- |

Thanks for this well-described bug report! I wonder if some people would describe the "authenticated old tty" issue as a "feature"? I would tend to agree, though, that it is surprising to open a terminal and not get prompted. I find your "Issue 2" the most compelling -- this should not be allowed to happen.

As you've hinted, the "original" solution, in the design of sudo in general, was for users to add "sudo -K" to their ~/.bash\_logout file. However, I suspect that isn't a proper solution (especially for gksu/kdesu). I haven't checked, but if udev receives notifications about pts devices being removed, perhaps it could be responsible for running "sudo -K" (or something similar)? That might solve all three scenarios, though I'm curious about the double pts allocation with kdesu.

Thanks for this well-described bug report! I wonder if some people would describe the "authenticated old tty" issue as a "feature"? I would tend to agree, though, that it is surprising to open a terminal and not get prompted. I find your "Issue 2" the most compelling -- this should not be allowed to happen.
As you've hinted, the "original" solution, in the design of sudo in general, was for users to add "sudo -K" to their ~/.bash\_logout file. However, I suspect that isn't a proper solution (especially for gksu/kdesu). I haven't checked, but if udev receives notifications about pts devices being removed, perhaps it could be responsible for running "sudo -K" (or something similar)? That might solve all three scenarios, though I'm curious about the double pts allocation with kdesu.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [kko (kko)](https://launchpad.net/~kko) wrote on 2007-02-22: |  |  | [#4](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/4) |
| --- | --- | --- | --- |

The double pts requirement with 'kdesu' could (even) be by design to "circumvent" the issue of old tickets lying around (compare with the bugs referenced above), but this would be bad design. It seems more likely, though, that it is just a side effect of starting a process and then forking it into different parts that have different tasks.

The double pts requirement with 'kdesu' could (even) be by design to "circumvent" the issue of old tickets lying around (compare with the bugs referenced above), but this would be bad design. It seems more likely, though, that it is just a side effect of starting a process and then forking it into different parts that have different tasks.

| **description**: | updated |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [kko (kko)](https://launchpad.net/~kko) wrote on 2007-02-22: |  |  | [#5](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/5) |
| --- | --- | --- | --- |

Also, what is problematic with the cases under "Issue 1", is that these cross the border between graphical and command line sudo access, which is very unintuitive for the user. It's OK if 'kdesu' remembers that I've just given my password, \_if\_ I've accepted this in its options. However, having a sudo capable shell isn't really OK, if I've only given my password to 'kdesu'. And vice versa.

(As a parenthesis: A real-life case I can think of is wanting to try out and './install' some 3rd party software, which has its own installation method (be it text-based or graphical). This could even have the option to \_either\_ install globally (if given the permissions) or as a fall-back to install locally for the user only. A password prompt at this point is very indicative to the user about where exactly things will be installed, and missing the password prompt can lead, at best, to confusion.)

Also, what is problematic with the cases under "Issue 1", is that these cross the border between graphical and command line sudo access, which is very unintuitive for the user. It's OK if 'kdesu' remembers that I've just given my password, \_if\_ I've accepted this in its options. However, having a sudo capable shell isn't really OK, if I've only given my password to 'kdesu'. And vice versa.
(As a parenthesis: A real-life case I can think of is wanting to try out and './install' some 3rd party software, which has its own installation method (be it text-based or graphical). This could even have the option to \_either\_ install globally (if given the permissions) or as a fall-back to install locally for the user only. A password prompt at this point is very indicative to the user about where exactly things will be installed, and missing the password prompt can lead, at best, to confusion.)

[Kees Cook (kees)](https://launchpad.net/~kees)
on 2007-02-22

| Changed in sudo: | |
| --- | --- |
| **status**: | Unconfirmed → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kees Cook (kees)](https://launchpad.net/~kees) wrote on 2007-02-22: |  |  | [#6](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/6) |
| --- | --- | --- | --- |

After talking to gregkh and hpa, it seems there are no udev events for pts add/remove. :( To do this, the pts kernel could would need to be written to use kobjects.

After talking to gregkh and hpa, it seems there are no udev events for pts add/remove. :( To do this, the pts kernel could would need to be written to use kobjects.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kees Cook (kees)](https://launchpad.net/~kees) wrote on 2007-02-22: |  |  | [#7](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/7) |
| --- | --- | --- | --- |

That should read "the pts kernel code would need to be written to use kobjects."

That should read "the pts kernel code would need to be written to use kobjects."

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [kko (kko)](https://launchpad.net/~kko) wrote on 2007-02-26: |  |  | [#8](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/8) |
| --- | --- | --- | --- |

I'm wondering - should this report be marked as concerning also 'kdesu', i.e. "kdebase", due to it leaving behind a valid sudo ticket?

Also, I am curious to know - does 'gksudo' leave behind a valid sudo ticket, or is the ticket cleared afterwards? (And, consequently, if a ticket is left behind, should this report be marked as also concerning the package providing 'gksudo'?)

I'm wondering - should this report be marked as concerning also 'kdesu', i.e. "kdebase", due to it leaving behind a valid sudo ticket?
Also, I am curious to know - does 'gksudo' leave behind a valid sudo ticket, or is the ticket cleared afterwards? (And, consequently, if a ticket is left behind, should this report be marked as also concerning the package providing 'gksudo'?)

| **description**: | updated |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Martin Pitt (pitti)](https://launchpad.net/~pitti) wrote on 2007-02-27: |  |  | [#9](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/9) |
| --- | --- | --- | --- |

kko: No, this only affects sudo and perhaps udev -- things like kdesu that build on top of sudo do not have any particular privileges and cannot fiddle with tickets.

kko: No, this only affects sudo and perhaps udev -- things like kdesu that build on top of sudo do not have any particular privileges and cannot fiddle with tickets.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [kko (kko)](https://launchpad.net/~kko) wrote on 2007-02-27: |  |  | [#10](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/10) |
| --- | --- | --- | --- |

Thank you for the information. Taking a look at kdesu's permissions I see what you mean.

Thank you for the information. Taking a look at kdesu's permissions I see what you mean.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kees Cook (kees)](https://launchpad.net/~kees) wrote on 2007-02-27: |  |  | [#11](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/11) |
| --- | --- | --- | --- |

I see a few options for dealing with console log-outs:

1) Add "sudo -K" to /etc/skel/.bash\_logout via patch to bash pkg. (This doesn't catch upgrades, and doesn't handle people not using bash.)

2) Dig into pam's session management and write new module to be added as login and ssh required "session" modules. (Seems a bit sloppy.)

3) Using a recent patch to mainline, write a logout-watching daemon that cleans up after sudo when a pts goes away (this seems really like too heavy a solution)

4) Patch the pts code to use kobjects and hook up a listener to "remove" events. (This is a lot of work.)

As for the GUI apps, I think sudo (and the GUI su-ing apps) should be patched to add something like "--single-shot", where no tty-based ticket is left behind.

I see a few options for dealing with console log-outs:
1) Add "sudo -K" to /etc/skel/.bash\_logout via patch to bash pkg. (This doesn't catch upgrades, and doesn't handle people not using bash.)
2) Dig into pam's session management and write new module to be added as login and ssh required "session" modules. (Seems a bit sloppy.)
3) Using a recent patch to mainline, write a logout-watching daemon that cleans up after sudo when a pts goes away (this seems really like too heavy a solution)
4) Patch the pts code to use kobjects and hook up a listener to "remove" events. (This is a lot of work.)
As for the GUI apps, I think sudo (and the GUI su-ing apps) should be patched to add something like "--single-shot", where no tty-based ticket is left behind.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [kko (kko)](https://launchpad.net/~kko) wrote on 2007-02-28: |  |  | [#12](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/12) |
| --- | --- | --- | --- |

Incidentally, I was pondering this too, after my last comment, so I'll comment on these suggestions.

For GUI apps, I agree with you. It should be easy for 'kdesu' or 'gksudo' to:

- Obtain needed privileges and launch the app requiring sudo privileges.

- Immediately afterwards call 'sudo -K' on the appropriate pts.

This should take care of the GUI side of the problem - see further though.

I don't really understand how 'kdesud' is supposed to work. I suppose it just sits there for as long as kdesu is configured to remember the password given to it, and is supposed to catch further launches of 'kdesu'. (It doesn't for me, so I wonder \_why\_ it is launched at all, but it's a different issue.) I don't know if 'kdesud' needs the ticket at all - according to 'man kdesu' it wouldn't: "The passwords are NOT written to disk, but stored in memory using a special program, kdesud."

If the ticket isn't needed to implement the grace period (i.e. remembering the password for a set time) functionality in GUI sudo apps, the option "--single-shot" definitely sounds like a cleaner way to implement this.

For the CLI, I tend to agree that your suggestions 3 and 4 seem heavy, although number 4 would probably be a good solution. I can't really say anything about suggestion 2.

I came up with the same thought as your suggestion 1 also. Basically, I thought it would be useful, but while trying it out I found a serious drawback. Unfortunately, .bash\_logout is only handled for \_login\_ shells, i.e. it is not executed for inter-active shells from Konsole. (People can also remove '~/.bash\_logout', but then it's their choice. I also wondered about the case where the shell (e.g. hanged and) got terminated in an abnormal way and it couldn't execute the logout script - in this case a solution not dependent on the shell would be more reliable.)

Incidentally, I was pondering this too, after my last comment, so I'll comment on these suggestions.
For GUI apps, I agree with you. It should be easy for 'kdesu' or 'gksudo' to:
- Obtain needed privileges and launch the app requiring sudo privileges.
- Immediately afterwards call 'sudo -K' on the appropriate pts.
This should take care of the GUI side of the problem - see further though.
I don't really understand how 'kdesud' is supposed to work. I suppose it just sits there for as long as kdesu is configured to remember the password given to it, and is supposed to catch further launches of 'kdesu'. (It doesn't for me, so I wonder \_why\_ it is launched at all, but it's a different issue.) I don't know if 'kdesud' needs the ticket at all - according to 'man kdesu' it wouldn't: "The passwords are NOT written to disk, but stored in memory using a special program, kdesud."
If the ticket isn't needed to implement the grace period (i.e. remembering the password for a set time) functionality in GUI sudo apps, the option "--single-shot" definitely sounds like a cleaner way to implement this.
For the CLI, I tend to agree that your suggestions 3 and 4 seem heavy, although number 4 would probably be a good solution. I can't really say anything about suggestion 2.
I came up with the same thought as your suggestion 1 also. Basically, I thought it would be useful, but while trying it out I found a serious drawback. Unfortunately, .bash\_logout is only handled for \_login\_ shells, i.e. it is not executed for inter-active shells from Konsole. (People can also remove '~/.bash\_logout', but then it's their choice. I also wondered about the case where the shell (e.g. hanged and) got terminated in an abnormal way and it couldn't execute the logout script - in this case a solution not dependent on the shell would be more reliable.)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Laager (rlaager)](https://launchpad.net/~rlaager) wrote on 2008-07-16: |  |  | [#13](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/13) |
| --- | --- | --- | --- |

Calling sudo -K from a GUI sudo wrapper is a bad idea. It would invalidate any tickets for other terminals as well. Solutions #2 and #4 seem reasonable. I think #2 would be easier to do, but I'm not an expert on any of this.

Calling sudo -K from a GUI sudo wrapper is a bad idea. It would invalidate any tickets for other terminals as well. Solutions #2 and #4 seem reasonable. I think #2 would be easier to do, but I'm not an expert on any of this.

[Kees Cook (kees)](https://launchpad.net/~kees)
on 2009-04-16

| Changed in sudo (Ubuntu): | |
| --- | --- |
| **importance**: | Undecided → Wishlist |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Joshua Kwan (joshk)](https://launchpad.net/~joshk) wrote on 2009-07-09: |  |  | [#14](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/14) |
| --- | --- | --- | --- |

FYI, gksu (as of libgksu version 2.0.11) allocates a new pseudoterminal, runs sudo -v to acquire a token, then uses g\_spawn\_sync in the parent process once the authentication is successful. (This allows gksu to be executed with the 'Defaults requiretty' option, which is enabled by default on RHEL.) Obviously, this fix doesn't work properly with the tty\_tickets option. I'm going to write another patch to try and address this issue.

Until then, I wouldn't be using the new libgksu in Karmic!

FYI, gksu (as of libgksu version 2.0.11) allocates a new pseudoterminal, runs sudo -v to acquire a token, then uses g\_spawn\_sync in the parent process once the authentication is successful. (This allows gksu to be executed with the 'Defaults requiretty' option, which is enabled by default on RHEL.) Obviously, this fix doesn't work properly with the tty\_tickets option. I'm going to write another patch to try and address this issue.
Until then, I wouldn't be using the new libgksu in Karmic!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Leonid Evdokimov (darkk)](https://launchpad.net/~darkk) wrote on 2009-11-14: |  |  | [#15](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/15) |
| --- | --- | --- | --- |

I have part of idea of another workaround for pty (but not for tty).

Open console:

$ ls -l --full-time --time=ctime `tty`

crw------- 1 darkk tty 136, 2 2009-11-14 15:41:39.260720360 +0600 /dev/pts/2

Close console, open console again:

$ ls -l --full-time --time=ctime `tty`

crw------- 1 darkk tty 136, 2 2009-11-14 15:43:31.320713474 +0600 /dev/pts/2

So ticket may include ctime of pty.

On the other hand, malicious attacker can change ctime of the /dev/pts/2 and he may get correct ctime watching /dev/pts (he can't get ctime from ticket data). I don't know if it may be avoided using something like POSIX ACL's and I assume that POSIX ACL's are not supported by ptsfs. Maybe someone has better idea.

I have part of idea of another workaround for pty (but not for tty).
Open console:
$ ls -l --full-time --time=ctime `tty`
crw------- 1 darkk tty 136, 2 2009-11-14 15:41:39.260720360 +0600 /dev/pts/2
Close console, open console again:
$ ls -l --full-time --time=ctime `tty`
crw------- 1 darkk tty 136, 2 2009-11-14 15:43:31.320713474 +0600 /dev/pts/2
So ticket may include ctime of pty.
On the other hand, malicious attacker can change ctime of the /dev/pts/2 and he may get correct ctime watching /dev/pts (he can't get ctime from ticket data). I don't know if it may be avoided using something like POSIX ACL's and I assume that POSIX ACL's are not supported by ptsfs. Maybe someone has better idea.

[Kees Cook (kees)](https://launchpad.net/~kees)
on 2011-04-27

| **security vulnerability**: | yes → no |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Removed by request (removed3425744)](https://launchpad.net/~removed3425744) wrote on 2013-12-17: |  |  | [#16](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/16) |
| --- | --- | --- | --- |

This report is now a few years old and I'm seeing an interesting behavior of sudo:

1. First I'm Cleaning /var/lib/sudo/$USER as root with "rm -rf /var/lib/sudo/sworddragon/\*".

2. Then I'm opening a terminal with my user account.

3. Typing tty returns /dev/pts/2.

4. Then I'm typing "sudo true" and entering my correct password.

5. Typing "md5sum /var/lib/sudo/sworddragon/2" as root returns "6ec673eac24f4e2fc0c5fa149eebfcef /var/lib/sudo/sworddragon/2"

6. Then I'm closing the terminal on /dev/pts/2 and opening it again.

7. Typing tty returns /dev/pts/2.

8. On typing sudo true I'm asked again for my password.

9. Instead of typing my password I'm typing now as root again "md5sum /var/lib/sudo/sworddragon/2" which returns "6ec673eac24f4e2fc0c5fa149eebfcef /var/lib/sudo/sworddragon/2".

10. Typing "ls -a /var/lib/sudo/sworddragon" as root returns ". .. 2".

This means even on getting the same pts without expiring of /var/lib/sudo/sworddragon/2 sudo asks me for my password. Can somebody tell me where is hiding the security mechanism here? Also are the cases in this ticket still a problem or are they maybe already fixed?

This report is now a few years old and I'm seeing an interesting behavior of sudo:
1. First I'm Cleaning /var/lib/sudo/$USER as root with "rm -rf /var/lib/sudo/sworddragon/\*".
2. Then I'm opening a terminal with my user account.
3. Typing tty returns /dev/pts/2.
4. Then I'm typing "sudo true" and entering my correct password.
5. Typing "md5sum /var/lib/sudo/sworddragon/2" as root returns "6ec673eac24f4e2fc0c5fa149eebfcef /var/lib/sudo/sworddragon/2"
6. Then I'm closing the terminal on /dev/pts/2 and opening it again.
7. Typing tty returns /dev/pts/2.
8. On typing sudo true I'm asked again for my password.
9. Instead of typing my password I'm typing now as root again "md5sum /var/lib/sudo/sworddragon/2" which returns "6ec673eac24f4e2fc0c5fa149eebfcef /var/lib/sudo/sworddragon/2".
10. Typing "ls -a /var/lib/sudo/sworddragon" as root returns ". .. 2".
This means even on getting the same pts without expiring of /var/lib/sudo/sworddragon/2 sudo asks me for my password. Can somebody tell me where is hiding the security mechanism here? Also are the cases in this ticket still a problem or are they maybe already fixed?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2013-12-17: |  |  | [#17](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/17) |
| --- | --- | --- | --- |

Sworddragon, I believe this code from plugins/sudoers/check.c in check\_user() prevents the tty reuse problem:

/\* Stash the tty's ctime for tty ticket comparison. \*/

    if (def\_tty\_tickets && user\_ttypath && stat(user\_ttypath, &sb) == 0) {

        tty\_info.dev = sb.st\_dev;

        tty\_info.ino = sb.st\_ino;

        tty\_info.rdev = sb.st\_rdev;

        if (tty\_is\_devpts(user\_ttypath))

            ctim\_get(&sb, &tty\_info.ctime);

    }

if (build\_timestamp(&timestampdir, &timestampfile) == -1) {

        rval = -1;

        goto done;

    }

status = timestamp\_status(timestampdir, timestampfile, user\_name,

        TS\_MAKE\_DIRS);

if (status != TS\_CURRENT || ISSET(validated, FLAG\_CHECK\_USER)) {

        /\* Bail out if we are non-interactive and a password is required \*/

        if (ISSET(mode, MODE\_NONINTERACTIVE)) {

            warningx(\_("sorry, a password is required to run %s"), getprogname());

            rval = -1;

            goto done;

        }

/\* XXX - should not lecture if askpass helper is being used. \*/

        lecture(status);

/\* Expand any escapes in the prompt. \*/

        prompt = expand\_prompt(user\_prompt ? user\_prompt : def\_passprompt,

            user\_name, user\_shost);

rval = verify\_user(auth\_pw, prompt);

    }

    /\* Only update timestamp if user was validated. \*/

    if (rval == TRUE && ISSET(validated, VALIDATE\_OK) &&

        !ISSET(mode, MODE\_IGNORE\_TICKET) && status != TS\_ERROR)

        update\_timestamp(timestampdir, timestampfile);

Thanks

Sworddragon, I believe this code from plugins/sudoers/check.c in check\_user() prevents the tty reuse problem:
/\* Stash the tty's ctime for tty ticket comparison. \*/
if (def\_tty\_tickets && user\_ttypath && stat(user\_ttypath, &sb) == 0) {
tty\_info.dev = sb.st\_dev;
tty\_info.ino = sb.st\_ino;
tty\_info.rdev = sb.st\_rdev;
if (tty\_is\_devpts(user\_ttypath))
ctim\_get(&sb, &tty\_info.ctime);
}
if (build\_timestamp(&timestampdir, &timestampfile) == -1) {
rval = -1;
goto done;
}
status = timestamp\_status(timestampdir, timestampfile, user\_name,
TS\_MAKE\_DIRS);
if (status != TS\_CURRENT || ISSET(validated, FLAG\_CHECK\_USER)) {
/\* Bail out if we are non-interactive and a password is required \*/
if (ISSET(mode, MODE\_NONINTERACTIVE)) {
warningx(\_("sorry, a password is required to run %s"), getprogname());
rval = -1;
goto done;
}
/\* XXX - should not lecture if askpass helper is being used. \*/
lecture(status);
/\* Expand any escapes in the prompt. \*/
prompt = expand\_prompt(user\_prompt ? user\_prompt : def\_passprompt,
user\_name, user\_shost);
rval = verify\_user(auth\_pw, prompt);
}
/\* Only update timestamp if user was validated. \*/
if (rval == TRUE && ISSET(validated, VALIDATE\_OK) &&
!ISSET(mode, MODE\_IGNORE\_TICKET) && status != TS\_ERROR)
update\_timestamp(timestampdir, timestampfile);
Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Removed by request (removed3425744)](https://launchpad.net/~removed3425744) wrote on 2013-12-18: |  |  | [#18](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/18) |
| --- | --- | --- | --- |

Thanks for the answer. If I'm not wrong ctime has a nanosecond resolution. The only way to abuse this is if:

- The tty/pts gets closed.

- The time adjusts to the past (for example due to ntp).

- The next opened console/terminal gets the same number and is created exactly at the same time.

While this is theoretically possible it should only be seen as an extremely rare race-condition. Also normally while the user opens a terminal, types sudo and enters his password at least a few seconds will be gone. Normally the adjustment of ntp is only a few milliseconds. If I'm not wrong here too ntp refuses to adjust the time to a too far point.

So this is a very nice security mechanism of sudo (does gksudo build on sudo too and benefit from this?).

Thanks for the answer. If I'm not wrong ctime has a nanosecond resolution. The only way to abuse this is if:
- The tty/pts gets closed.
- The time adjusts to the past (for example due to ntp).
- The next opened console/terminal gets the same number and is created exactly at the same time.
While this is theoretically possible it should only be seen as an extremely rare race-condition. Also normally while the user opens a terminal, types sudo and enters his password at least a few seconds will be gone. Normally the adjustment of ntp is only a few milliseconds. If I'm not wrong here too ntp refuses to adjust the time to a too far point.
So this is a very nice security mechanism of sudo (does gksudo build on sudo too and benefit from this?).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Richard Laager (rlaager)](https://launchpad.net/~rlaager) wrote on 2016-04-25: |  |  | [#19](/ubuntu/%2Bsource/sudo/%2Bbug/87023/comments/19) |
| --- | --- | --- | --- |

I might be overstepping here, but I'm marking this as Fix Released. I can confirm, as with comment #16, that this is no longer an issue. I'm on Vivid.

I might be overstepping here, but I'm marking this as Fix Released. I can confirm, as with comment #16, that this is no longer an issue. I'm on Vivid.

| Changed in sudo (Ubuntu): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/sudo/%2Bbug/87023/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/sudo/%2Bfilebug)

This report contains
**Public**
information

Everyone can see this information.

## Duplicates of this bug

* [Bug #61059](https://bugs.launchpad.net/ubuntu/%2Bsource/sudo/%2Bbug/61059 "I managed to perform the command: \"sudo apt-get install\" without being asked for a password")

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/sudo/%2Bbug/87023/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/sudo/%2Bbug/87023/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/sudo/%2Bbug/87023/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))


