=== Content from foswiki.org_8fd9b3b6_20250124_130616.html ===


| [Powered by Foswiki, The Free and Open Source Wiki](http://foswiki.org/Home/WebHome) |  | * Default Български 正體中文 简体中文 Čeština Dansk Nederlands English Suomi Français Deutsch Italiano 日本語 한글 Ελληνικά Norsk Polski Português Português brasileiro Русский Español Svenska Türkçe Українська |
| --- | --- | --- |

* [About](http://foswiki.org/About/WebHome)
* [Blog](http://blog.foswiki.org)
* [Extensions](http://foswiki.org/Extensions/WebHome)
* [Documentation](http://foswiki.org/System/WebHome)
* [Community](http://foswiki.org/Community/WebHome)
* [Development](http://foswiki.org/Development/WebHome)
* [Tasks](http://foswiki.org/Tasks/WebHome)
* [Download](http://foswiki.org/Download/FoswikiRelease02x01x09)
* [Support](http://foswiki.org/Support/WebHome)
* [Sandbox](http://foswiki.org/Sandbox/WebHome)

You are here: [Foswiki](/)>[Support Web](/Support/WebHome)>[KnownIssuesOfFoswiki01x01](/Support/KnownIssuesOfFoswiki01x01)>[SecurityAlerts](/Support/SecurityAlerts)>[SecurityAlert-CVE-2013-1666](/Support/SecurityAlert-CVE-2013-1666 "Topic revision: 6 (01 Mar 2013 - 02:48:24)") (01 Mar 2013, [GeorgeClark](/Main/GeorgeClark))[Edit](/bin/edit/Support/SecurityAlert-CVE-2013-1666?t=1737723975 "Edit this topic text") Attach  [![txt](/pub/System/DocumentGraphics/txt.png) plain text](/Support/SecurityAlert-CVE-2013-1666?skin=plain;template=SecurityAlertTextView)
# Security Alert: Code injection vulnerability in MAKETEXT macro

 ![IDEA!](/pub/System/DocumentGraphics/tip.png "IDEA!") ***Get Alerted:*** *to get immediate alerts* of high priority security issues, please join the low-volume `foswiki-announce` list - details at [Mailing Lists](/Community/MailingLists) This advisory alerts you of a potential security issue with your Foswiki installation. A vulnerability has been reported against the core Perl module [CPAN:Locale::Maketext](https://metacpan.org/module/Locale%3A%3AMaketext "CPAN perl repository"), which Foswiki uses to provide translations when {UserInterfaceInternationalization} is enabled in the configuration. Because of this vulnerability it may be possible for a user to invoke arbitrary perl modules on the server through a crafted macro.The original fix for this issue reported in [SecurityAlert-CVE-2012-6329](/Support/SecurityAlert-CVE-2012-6329) failed to eliminate one possible attack vector. This CVE applies an additional fix for the original issue.The system is **not vulnerable** if `{UserInerfaceInternationalization}` is not enabled in your configuration, or if `Locale::Maketext` has been upgraded to version 1.23 as advised in [SecurityAlert-CVE-2012-6329](/Support/SecurityAlert-CVE-2012-6329).

* [Severity Level](#Severity_Level)
* [MITRE Name for this Vulnerability](#MITRE_Name_for_this_Vulnerability)
* [Vulnerable Software Versions](#Vulnerable_Software_Versions)
## Severity Level

Severity 1 issue: The web server can be compromisedThe severity level was assigned by the Foswiki [SecurityTaskTeam](/Community/SecurityTaskTeam) as documented in [SecurityAlertProcess](/Development/SecurityAlertProcess)
## MITRE Name for this Vulnerability

The Common Vulnerabilities and Exposures project has assigned the name [CVE-2013-1666](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1666) to this vulnerability.
## Vulnerable Software Versions

* [Foswiki 1.0.0](/Download/FoswikiRelease01x00x00), [Foswiki 1.0.0-beta1](/Download/FoswikiRelease01x00x00Beta1), [Foswiki 1.0.0-beta2](/Download/FoswikiRelease01x00x00Beta2), [Foswiki 1.0.0-beta3](/Download/FoswikiRelease01x00x00Beta3), [Foswiki 1.0.1](/Download/FoswikiRelease01x00x01), [Foswiki 1.0.2](/Download/FoswikiRelease01x00x02), [Foswiki 1.0.3](/Download/FoswikiRelease01x00x03), [Foswiki 1.0.4](/Download/FoswikiRelease01x00x04), [Foswiki 1.0.5](/Download/FoswikiRelease01x00x05), [Foswiki 1.0.6](/Download/FoswikiRelease01x00x06), [Foswiki 1.0.7](/Download/FoswikiRelease01x00x07), [Foswiki 1.0.8](/Download/FoswikiRelease01x00x08), [Foswiki 1.0.9](/Download/FoswikiRelease01x00x09), [Foswiki 1.0.9-rc1](/Download/FoswikiRelease01x00x09RC1), [Foswiki 1.0.9-RC2](/Download/FoswikiRelease01x00x09RC2), [Foswiki 1.0.10](/Download/FoswikiRelease01x00x10), [Foswiki 1.0.10-rc1](/Download/FoswikiRelease01x00x10rc01), [Foswiki 1.1.0](/Download/FoswikiRelease01x01x00), [Foswiki 1.1.0-beta1](/Download/FoswikiRelease01x01x00Beta1), [Foswiki 1.1.0-RC1](/Download/FoswikiRelease01x01x00RC1), [Foswiki 1.1.1](/Download/FoswikiRelease01x01x01), [Foswiki 1.1.2](/Download/FoswikiRelease01x01x02), [Foswiki 1.1.3](/Download/FoswikiRelease01x01x03), [Foswiki 1.1.3-RC1](/Download/FoswikiRelease01x01x03RC1), [Foswiki 1.1.4](/Download/FoswikiRelease01x01x04), [Foswiki 1.1.4-RC2](/Download/FoswikiRelease01x01x04RC2), [Foswiki 1.1.5](/Download/FoswikiRelease01x01x05), [Foswiki 1.1.6](/Download/FoswikiRelease01x01x06), [Foswiki 1.1.7](/Download/FoswikiRelease01x01x07)

Fixed in [Foswiki 1.1.8](/Download/FoswikiRelease01x01x08)
## Attack Vectors

Editing wiki pages and HTTP POST requests towards a Foswiki server with enabled localization (typically port 80/TCP). Typically, prior authentication is necessary. If your wiki allows commenting by users without first logging in, then it may be possible for such an anonymous user to exploit this vulnerability.The original report ( [SecurityAlert-CVE-2012-6329](/Support/SecurityAlert-CVE-2012-6329)) against Locale::Maketext also identified another vector, where a module name can be passed in to Maketext through the bracket notation. At the time we determined that Foswiki was not vulnerable to this vector, as Foswiki does not permit that syntax to be used. ***This was incorrect***. It is possible to pass bypass the checks by double-escaping the brackets.
## Impact

Arbitrary code execution on the server as the webserver user.
## Details

A crafted %MAKETEXT{}% macro can cause multiple issues: This CVE addresses an additional vector:

* ![NEW](/pub/System/DocumentGraphics/new.png "NEW") **Execute arbitrary perl modules by escaping brackets within MAKETEXT `~~[Some::Module,~~]` (CVE-2013-1666)**
* Execute arbitrary code on the server by passing unsanitized strings to Locale::Maketext. (CVE-2012-6329)
* Consume memory and swap space resulting in potential lockup or crash due to %MAKETEXT{}% not validating the parameter numbers supplied in the `[_nnn]` tokens. (CVE-2012-6330)
* Cause an exception within Foswiki, also due to invalid parameters in `[_nnn]` tokens

## Countermeasures

Apply one of these countermeasures:

* Apply hotfix (see patch below).
* Install [PatchItem12391Contrib](/Extensions/PatchItem12391Contrib)
* Disable `{UserInerfaceInternationalization}` in your `!LocalSite.cfg`
* Upgrade to Foswiki-1.1.8 once available.

In addition to the above, Locale::Maketext should be upgraded to version 1.23.You can verify that the patches are successful by using the following two lines in a test topic:
```

   * If a warning about MAKETEXT Rejected is displayed here, your system is patched for Item12285:  %MAKETEXT{"[_101]"}%
   * If ==[quant,4,singular,plural]== is displayed at the end of this line, your system is patched for Item12391: <b><tt>%MAKETEXT{" ~~[quant,4,singular,plural~~] "}%</tt></b>
```
Note: If the 2nd line displays `~[quant,4,singular,plural~]` (shows the ~ character) then your system is not patched, but is not vulnerable because Internationalization is disabled.
## Authors and Credits

* John Lightsey for disclosing the issue to the foswiki-security list.
* [CrawfordCurrie](/Main/CrawfordCurrie), [PaulHarvey](/Main/PaulHarvey) and [GeorgeClark](/Main/GeorgeClark) for contributing to the fix, the 1.1.8 release and advisory.
* Members of the Foswiki security team for discussions and for editing this security advice.

## Hotfix for Foswiki Production Release 1.1.0-1.1.7

The line numbers may vary between releases, but the two regular expressions should be changed as shown below:
```
--- lib/Foswiki/Macros/MAKETEXT.pm  2013-02-13 10:26:42.520780283 -0500
+++ lib/Foswiki/Macros/MAKETEXT.pm  2013-02-13 10:26:51.362682708 -0500
@@ -25,8 +25,8 @@
     $str =~ s/\]/~]/g;

     # restore already escaped stuff:
-    $str =~ s/~~\[/~[/g;
-    $str =~ s/~~\]/~]/g;
+    $str =~ s/~~+\[/~[/g;
+    $str =~ s/~~+\]/~]/g;

     $max         = 0;
     $min         = 1;

```
## Hotfix for Foswiki Production Release 1.0.0-1.0.10

Apply the above patch to Foswiki.pm, in the vicinity of line 4193
## Action Plan with Timeline

* 2013-02-12 - User discloses issue to foswiki security mailing list (John Lightsey)
* 2013-02-13 - Developer verifies issue (George Clark)
* 2013-02-13 - Security team triage the issue (George Clark, Crawford Currie, Paul Harvey)
* 2013-02-13 - Developer fixes code (George Clark)
* 2013-02-14 - Security team creates advisory with hotfix (George Clark)
* 2013-xx-xx - Release Manager builds patch release (name)
* 2013-02-14 - Send alert to foswiki-announce and foswiki-discuss mailing lists (George Clark)
* 2013-02-19 - Publish advisory in Support web and update all related topics (George Clark)
* 2013-02-19 - Reference to public advisory on Download page and Known Issues (George Clark)
* 2013-02-19 - Issue a public security advisory (vuln@secunia.com, cert@cert.org, bugs@securitytracker.com bugtraq@securityfocus.com full-disclosure@lists.grok.org.uk) (George Clark)

* #Set ALLOWTOPICVIEW = [SecurityGroup](/Main/SecurityGroup)
* Set ALLOWTOPICCHANGE = [SecurityGroup](/Main/SecurityGroup)

## Attachments ($count)

Show options
**Search:**

**Sort by:**
Name
Date
Author
Size
Type

**Results per page:**
6
12
24
48
all

**Display hidden:**

| More actions Create link(s) Embed Download Hide Unhide Move Delete | 0 attachment(s) |
| --- | --- |

Select all
Clear all

[Attachments](/bin/attach/Support/SecurityAlert-CVE-2013-1666) | [Print version](/Support/SecurityAlert-CVE-2013-1666?cover=print; "Printable version of this topic") | [History](/bin/oops/Support/SecurityAlert-CVE-2013-1666?template=oopshistory "View complete topic history"): r6 [<](/bin/compare/Support/SecurityAlert-CVE-2013-1666?rev1=5;rev2=6) [r5](/Support/SecurityAlert-CVE-2013-1666?rev=5) [<](/bin/compare/Support/SecurityAlert-CVE-2013-1666?rev1=4;rev2=5) [r4](/Support/SecurityAlert-CVE-2013-1666?rev=4) [<](/bin/compare/Support/SecurityAlert-CVE-2013-1666?rev1=3;rev2=4) [r3](/Support/SecurityAlert-CVE-2013-1666?rev=3) | [Backlinks](/Support/SecurityAlert-CVE-2013-1666?template=backlinksweb "Search the Support Web for topics that link to here") | [View wiki text](/Support/SecurityAlert-CVE-2013-1666?raw=on "View without formatting") | [Edit wiki text](/bin/edit/Support/SecurityAlert-CVE-2013-1666?t=1737723975;nowysiwyg=1 "Edit Wiki text") | [More topic actions](/Support/SecurityAlert-CVE-2013-1666?template=more&currrev=6 "Delete or rename this topic; set parent topic; view and compare revisions")

Topic revision: r6 - 01 Mar 2013, [GeorgeClark](/Main/GeorgeClark)

[Support](/Support/WebHome)

* ![key](/pub/System/FamFamFamSilkIcons/key.png)[Log In](/bin/login?foswiki_origin=GET%2cview%2c/Support/SecurityAlert-CVE-2013-1666)
* ![add](/pub/System/FamFamFamSilkIcons/add.png)[Register](/System/UserRegistration)
## Quick Links

* [Support questions](/Support/SupportQuestions)
* [FAQ's](/Support/FAQ)
* [Tips](/Support/BestPracticeTips)
* [Extensions support](/Support/Extensions)
* [Supplemental documents](/Support/SupplementalDocuments)
* [Wiki consultants](/Support/WikiConsultants)

## Tools

* [![newtopic](/pub/System/DocumentGraphics/newtopic.png) Create New Topic](/Support/WebCreateNewTopic?topicparent=SecurityAlert-CVE-2013-1666)
* [![index](/pub/System/DocumentGraphics/index.png) Index](/Support/WebTopicList)
* [![searchtopic](/pub/System/DocumentGraphics/searchtopic.png) Search](/Support/WebSearch)
* [![changes](/pub/System/DocumentGraphics/changes.png) Changes](/Support/WebChanges)
* [![notify](/pub/System/DocumentGraphics/notify.png) Notifications](/Support/WebNotify)
* [![feed](/pub/System/DocumentGraphics/feed.png) RSS Feed](/Support/WebRss)
* [![statistics](/pub/System/DocumentGraphics/statistics.png) Statistics](/Support/WebStatistics)
* [![wrench](/pub/System/DocumentGraphics/wrench.png) Preferences](/Support/WebPreferences)

The copyright of the content on this website is held by the contributing authors, except where stated elsewhere. See [Copyright Statement](/Community/CopyrightStatement). [![Creative Commons License](https://foswiki.org/pub/System/SiteGraphics/cc-by-sa-3.0-88x31.png)](http://creativecommons.org/licenses/by-sa/3.0/)    [Legal Imprint](/About/LegalImprint)    [Privacy Policy](/Community/PrivacyPolicy)



=== Content from www.openwall.com_bd580827_20250124_130616.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](19) [[next>]](21) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20150324181449.GA14661@kludge.henri.nerv.fi>
Date: Tue, 24 Mar 2015 20:14:49 +0200
From: Henri Salo <henri@...v.fi>
To: cve-assign@...re.org
Cc: oss-security@...ts.openwall.com
Subject: CVE-2013-1666 description still missing

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

For some reason CVE-2013-1666 description has not been updated according to:

  <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1666>
  <https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-1666>

Can Mitre update details, thanks? I found following references:

  <http://foswiki.org/Support/SecurityAlert-CVE-2013-1666>
  <http://www.securityfocus.com/archive/1/525733>

- --
Henri Salo
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBAgAGBQJVEamZAAoJECet96ROqnV0HtYP/3JryIg9KzI/mSQI8tF5+rq6
FQY1lRXoZ7yhzLxCBEFAFmw5f+SaB8FqRVgnQg1NtlAWvB7JVy1p/4uBXe4ierJm
u65I4+I5fE5HsB3JH48R3zC4XUG6bkYvX5sVYguJXywcNrFoCZSovkCVfyBMwXbx
m+kvdKuMKhbfOIkzZE83dgVXDsFIIIS3ceYGRA++pAdOCFLuLVqx1iQojS1YX+Zg
izpF0ue/IO6pJhrTQEnL2VUrkQmGg8joBDYtizTQCSSWJ2nZ4I2fCdTWKVGj0HmH
EmKq64jmDrsPOlOQf7I8k9RBRqPt0bJakBHBRp+9RF2+J3KA/RD2U5FGWtLFWTW/
FOFfF6G8xF2Jv++WrSMla6SAk8ARupBg1AzPPHlSyoRmfDbudyRf0PUAAuaK8IR5
SH2bsJs8mXyVfQ7mreEhMQvCEjbQLG7Ns4DIkwCBqczTw9HFslL8pIcluDqWvQHL
46eol4rb8bvgVnulTVjCH0jeNV64Gc3p1dwA6ujwyfUDAEws98KOE9155qp8wz7z
Z14eyytg+QCVnSSgbO3tNj1w2I9tvFH2a6HJB+pr6r659oZK6RB5ex4W0JlcMn/B
vw8PJ4+/SrAAqPGyQlnbqZEmFds/cuHoLtYke2S4EwfPeFwb1x1XaVAdgwUigMhW
2tmeOoQRl7jMjddsIm1x
=HYKp
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


