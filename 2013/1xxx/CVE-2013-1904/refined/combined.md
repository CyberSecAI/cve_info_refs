=== Content from lists.opensuse.org_97fa043a_20250125_234757.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/2VHHQEGJ3GV7XQPRKFUPJMJQSRFGGBYQ/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/2VHHQEGJ3GV7XQPRKFUPJMJQSRFGGBYQ/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/2VHHQEGJ3GV7XQPRKFUPJMJQSRFGGBYQ/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/2VHHQEGJ3GV7XQPRKFUPJMJQSRFGGBYQ/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/2VHHQEGJ3GV7XQPRKFUPJMJQSRFGGBYQ/#2VHHQEGJ3GV7XQPRKFUPJMJQSRFGGBYQ)

# openSUSE-SU-2013:0671-1: moderate: update for roundcubemail

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

12 Apr
2013

12 Apr
'13

07:04

openSUSE Security Update: update for roundcubemail
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2013:0671-1
Rating: moderate
References: #812568
Cross-References: CVE-2013-1904
Affected Products:
openSUSE 12.3
openSUSE 12.2
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes one vulnerability is now available.
Description:
- Update to version 0.8.6 (bnc#812568)
\* Fix security issue in save-pref command (CVE-2013-1904)
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.3:
zypper in -t patch openSUSE-2013-332
- openSUSE 12.2:
zypper in -t patch openSUSE-2013-332
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.3 (noarch):
roundcubemail-0.8.6-1.4.1
- openSUSE 12.2 (noarch):
roundcubemail-0.8.6-3.12.1
References:
<http://support.novell.com/security/cve/CVE-2013-1904.html>
<https://bugzilla.novell.com/812568>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/2VHHQEGJ3GV7XQPRKFUPJMJQSRFGGBYQ/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/2VHHQEGJ3GV7XQPRKFUPJMJQSRFGGBYQ/#2VHHQEGJ3GV7XQPRKFUPJMJQSRFGGBYQ)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from bugzilla.novell.com_02b6fb1b_20250126_125325.html ===




=== Content from habrahabr.ru_680d97fb_20250125_234756.html ===

[Habr](/en/)β[How to become an author](/en/sandbox/start/)[My feed](/en/feed/)[All streams](/en/articles/)[Development](/en/flows/develop/)[Admin](/en/flows/admin/)[Design](/en/flows/design/)[Management](/en/flows/management/)[Marketing](/en/flows/marketing/)[PopSci](/en/flows/popsci/)[Search](/en/search/)Write a publicationSettings[Login](https://habr.com/kek/v1/auth/habrahabr/?back=/en/articles/174423/&hl=en)Pull to refresh[![](https://assets.habr.com/habr-web/img/avatars/059.png)](/en/users/netguard/ "netguard")[netguard](/en/users/netguard/)  Mar 27 2013 at 16:30
# Уязвимость нулевого дня в roundcube

Reading time3 minViews36K[Information Security\*](/en/hubs/infosecurity/)[From sandbox](/en/sandbox/)Есть много разного полезного софта, который присутствует на большинстве хостингов. Например, стандартом de-facto является phpmyadmin, отсутствие которого пользователи не поймут и не оценят.

Для почты такое “приложение по умолчанию” — roundcube.

Сегодня мы поговорим о уязвимости zero-day, которая отдает в руки злоумышленнику всю почту ваших пользователей

Традиционно считается, что такие популярные скрипты не могут содержать сколько-нибудь значимых уязвимостей. Да, возможно XSS, может быть CSRF, это неприятно, но сложно эксплуатируется и к утечке серьезных данных в большинстве случаев не приводит.

Мы проектировали shared-hosting с полным пониманием того, что наши клиенты крайне чувствительны к любым нарушениям безопасности. Не должно быть ни явных ни потенциальных угроз. Тем не менее, с некоторых пор мы наблюдали статистически значимое увеличение жалоб на доступ посторонних лиц к FTP.

Было проверено всё — начиная с внутренней безопасности, заканчивая любыми вариантами утечек через биллинг, от самих пользователей и т.д.

В какой-то момент стало ясно, что утечка идёт из почтовой системы и скорее всего из её веб-части.

Паттерн эксплуатации крайне странный — взломщик получает пароль от базы roundcube, через phpmyadmin вытаскивает оттуда сессии, получает из сессий пароли к почте. Причем, сессии roundcube шифрует, а значит доступ есть и к ключу шифрования.

Найти уязвимость помогло частичное протоколирование POST-запросов:

`POST /?_task=settings&_action=save-pref&check_request=&_check_request= HTTP/1.1" 200 1133 "http://mail.ddos-guard.net/?_task=mail" "Mozilla/5.0 (Windows NT 5.1; rv:16.0) Gecko/20100101 Firefox/16.0" "_token=0f7c9ae8a387cb0bc5ce563fa09fe172&_session=generic_message_footer&_name=generic_message_footer&_value=config/db.inc.php`

Локальный include. Взломщик добавляет config/db.inc.php в футер письма и отправляет это письмо себе.

Осталось выяснить, как же так получается, что последняя стабильная версия roundcube делает такую мерзость.

Всё достаточно просто:

**index.php:**
```
else if ($RCMAIL->action == 'save-pref') {
 include INSTALL_PATH . 'program/steps/utils/save_pref.inc';
}

```

**program/steps/utils/save\_pref.inc:**
```
$name = get_input_value('_name', RCUBE_INPUT_POST);
$value = get_input_value('_value', RCUBE_INPUT_POST);

// save preference value
$RCMAIL->user->save_prefs(array($name => $value));

// update also session if requested
if ($sessname = get_input_value('_session', RCUBE_INPUT_POST)) {
    // Support multidimensional arrays...
    $vars = explode('/', $sessname);

    // ... up to 3 levels
    if (count($vars) == 1)
        $_SESSION[$vars[0]] = $value;
    else if (count($vars) == 2)
        $_SESSION[$vars[0]][$vars[1]] = $value;
    else if (count($vars) == 3)
        $_SESSION[$vars[0]][$vars[1]][$vars[2]] = $value;
}

$OUTPUT->reset();
$OUTPUT->send();

```

Атакующий может перезаписать **любую** переменную в конфигурации и получить любой файл, доступный для чтения пользователю под которым работает roundcube.

Уязвимость присутствует в самых последний версиях — roundcube 0.8.5 и 0.9-RC.

Патч для временного затыкания дыры:

```
diff --git a/index.php b/index.php
index 8de8ca0..6470295 100644
--- a/index.php
+++ b/index.php
@@ -258,7 +258,8 @@ if ($RCMAIL->action == 'keep-alive') {
  $OUTPUT->send();
}
else if ($RCMAIL->action == 'save-pref') {
-  include INSTALL_PATH . 'program/steps/utils/save_pref.inc';
+  echo "Oops";
+  die;
}

```

Остается заметить, что roundcube присутствует в CPanel, DirectAdmin и т.д. Фактически этой уязвимости подвержены большинство современных хостингов.

Счастья вам. Будьте бдительны.

**Update 28.03.2013**

[Патч от разработчиков](https://github.com/roundcube/roundcubemail/commit/648fcf570964ad512d18d6df7e07d5bcec2ae830)

Патчи для других версий — <http://sourceforge.net/news/?group_id=139281&id=310497>

Версия 0.8.6, исправляющая уязвимость — <http://roundcube.net/download>Tags:

* [roundcube](/en/search/?target_type=posts&order=relevance&q=[roundcube])
* [уязвимость](/en/search/?target_type=posts&order=relevance&q=[%D1%83%D1%8F%D0%B7%D0%B2%D0%B8%D0%BC%D0%BE%D1%81%D1%82%D1%8C])
Hubs:

* [Information Security](/en/hubs/infosecurity/)
Total votes 63: ↑63 and ↓0+63Add to bookmarks75[Comments26](/en/articles/174423/comments/)[![](https://assets.habr.com/habr-web/img/avatars/059.png)](/en/users/netguard/)12Karma0Rating [@netguard](/en/users/netguard/)

User

FollowSend message[Comments Comments 26](/en/articles/174423/comments/)
## Articles

Top of the daySimilar articles

Show the best of all time

Your account

* [Log in](/kek/v1/auth/habrahabr/?back=/en/articles/174423/&hl=en)
* [Sign up](/kek/v1/auth/habrahabr-register/?back=/en/articles/174423/&hl=en)

Sections

* [Articles](/en/articles/)
* [News](/en/news/)
* [Hubs](/en/hubs/)
* [Authors](/en/users/)
* [Sandbox](/en/sandbox/)

Information

* [How it works](/en/docs/help/)
* [For authors](/en/docs/authors/codex/)
* [For companies](/en/docs/companies/corpblogs/)
* [Documents](/en/docs/docs/transparency/)
* [Agreement](https://account.habr.com/info/agreement/?hl=en_US)
* [Confidential](https://account.habr.com/info/confidential/?hl=en_US)

Services

* [Corporate blogs](https://company.habr.com/en/corporate-blogs/)
* [Advertising](https://company.habr.com/en/advertising/)
* [Native advertising](https://company.habr.com/en/native-special/)
* [Education programs](https://company.habr.com/en/education-programs/)
* [Startups](https://company.habr.com/en/hello-startup/)
[Facebook](https://www.facebook.com/habr.eng)[Twitter](https://twitter.com/habr_eng)[Telegram](https://t.me/habr_eng) Language settings[Support](/en/feedback/)© 2006–2025, [Habr](https://company.habr.com/en/)

![](https://mc.yandex.ru/watch/24049213)



=== Content from www.openwall.com_15cfc52c_20250125_234759.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](7) [[next>]](9) [[<thread-prev]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <51548712.6000608@redhat.com>
Date: Thu, 28 Mar 2013 12:08:18 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: oss-security@...ts.openwall.com
CC: Jan Lieskovsky <jlieskov@...hat.com>,
        "Steven M. Christey" <coley@...us.mitre.org>
Subject: Re: CVE Request -- roundcubemail: Local file inclusion
 via web UI modification of certain config options

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 03/28/2013 08:47 AM, Jan Lieskovsky wrote:
> Hello Kurt, Steve, vendors,
>
> RoundCube Webmail upstream has released 0.8.6 and 0.7.3 versions to
> correct one security flaw:
>
> A local file inclusion flaw was found in the way RoundCube Webmail,
> a browser-based multilingual IMAP client, performed validation of
> the 'generic_message_footer' value provided via web user interface
> in certain circumstances. A remote attacker could issue a
> specially-crafted request that, when processed by RoundCube Webmail
> could allow an attacker to obtain arbitrary file on the system,
> accessible with the privileges of the user running RoundCube
> Webmail client.
>
> References: [1] <https://bugzilla.redhat.com/show_bug.cgi?id=928835>
> [2] <http://sourceforge.net/news/?group_id=139281&id=310497> [3]
> <http://lists.roundcube.net/pipermail/dev/2013-March/022328.html> [4]
> <https://bugs.gentoo.org/show_bug.cgi?id=463554>
>
> Upstream patches: [5] <http://ow.ly/jtQD0> [6] <http://ow.ly/jtQHM> [7]
> <http://ow.ly/jtQK0> [8] <http://ow.ly/jtQNd>
>
> Could you allocate a CVE id for this?

Please use CVE-2013-1904 for this issue.

> Than you && Regards, Jan. -- Jan iankko Lieskovsky / Red Hat
> Security Response Team
>

- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)

iQIcBAEBAgAGBQJRVIcSAAoJEBYNRVNeJnmT1OIQAKUfTbk8G9/EPpYq6Fb1Cnrh
6LSb9FJQtIwJBmC0PeId8HGOU3H1NSFwkbQT9bdXpA+EITHgtzyTlRME8uMvrz0A
82L7dlk1hJS9mhgcm5ED460Belue7AHSfolHZ8Ny7i+r2QK4f5kNdubBa9uPu7rg
hgWAkas2hpTB8MCslXOZR8BanqI3QRCpm2/T+/pP9f5GXTUL6BFEZD+ovyTeYvhQ
16QdTheiR6hMhL2FKZpZF94FmV/rBe7sFa6VbrmPH4Hbn5AqP+bxuhjf0sRPyj9X
ivkxc44s4i4MSz/N6iB2XCXKTUxhpD2ZysKP65CJCbMoEMvQPYohi7Bs9Ez+2iN2
1+18ll29z/IY4a4FyoTD6dsUXZqRiw69SRyZCYG+gqkffGF0pLsyG1U1YWAo0TBy
9lBu6dq/upUPI4+JzWJAVBewKxcGgf9W3+7rpK//qRDi8/2b1Ruq3NpFVTo8AxiY
YmUIt2tt0G6xwz9jk09La7T+4iYGAfkRwWO+eXQV6dopapsOxUCOPEell2kefeex
ozsAmQLY5ciLElj0YRXBNoKFZB0zoBhn6o4ZG4Svjuk7pH/MzR9SbQ0B15hCrK4U
Mlp5y+AxrrLdLKwltCLnT6mzXK8n1LL60R+8NpQn4JGVoKXh3ZWlN5EORqSD69ZP
wEbIKM9n8B+9LND0zZks
=HnvA
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


