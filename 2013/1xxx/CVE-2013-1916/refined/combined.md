=== Content from wordpress.org_2c9ed8f0_20250124_155307.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

User Photo

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fuser-photo&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fuser-photo&locale=en_US)

Search plugins

This plugin **hasn’t been tested with the latest 3 major releases of WordPress**. It may no longer be maintained or supported and may have compatibility issues when used with more recent versions of WordPress.

![](https://s.w.org/plugins/geopattern-icon/user-photo.svg)
# User Photo

By Weston Ruter

[Download](https://downloads.wordpress.org/plugin/user-photo.0.9.10.zip)

* [Details](https://wordpress.org/plugins/user-photo/#description)
* [Reviews](https://wordpress.org/plugins/user-photo/#reviews)
* [Development](https://wordpress.org/plugins/user-photo/#developers)

[Support](https://wordpress.org/support/plugin/user-photo/)

## Description

Allows a user to associate a profile photo with their account through their “Your Profile” page. Admins may

add a user profile photo by accessing the “Edit User” page. Uploaded images are resized to fit the dimensions specified

on the options page; a thumbnail image correspondingly is also generated.

User photos may be displayed within a post or a comment to

help identify the author. New template tags introduced are:

* `userphoto_the_author_photo()`
* `userphoto_the_author_thumbnail()`
* `userphoto_comment_author_photo()`
* `userphoto_comment_author_thumbnail()`

*Important: all of these “template tags” must appear inside of PHP script blocks (see examples below).*

The first two should be placed in the posts loop near `the_author()`, and the second two in the comments

loop near `comment_author()` (or their respective equivalents). Furthermore, `userphoto_the_author_photo()`

and `userphoto_the_author_thumbnail()` may be called anywhere (i.e. sidebar) if `$authordata` is set.

The output of these template tags may be modified by passing four parameters: `$before`, `$after`, `$attributes`, and `$default_src`,

as in: `userphoto_the_author_photo($before, $after, $attributes, $default_src)`.

If the user photo exists (or `$default_src` is supplied), then the text provided in the `$before` and `$after` parameters is respectively

prefixed and suffixed to the generated `img` tag (a common pattern in WordPress). If attributes are provided in the `$attributes`

parameter, then they are returned as attributes of the generated `img` element. For example: `userphoto_the_author_photo('', '', array(style => 'border:0'))`

Just added in 0.8.1 release are these two new template tags:

* `userphoto($user, $before = '', $after = '', $attributes = array(), $default_src = '')`
* `userphoto_thumbnail($user, $before = '', $after = '', $attributes = array(), $default_src = '')`

By using these, it is uneccessary to set the global `$authordata` to display a photo. Just pass `$authordata`, `$curauth` or

whatever variable you have which contains the user object, or (as of version 0.9), pass in a user ID or a user login name.

Here’s an example that shows a few ways of inserting a user’s photo into the post loop:

//this will display the user’s avatar if they don’t have a user photo,

```
<?php while (have_posts()) : the_post(); ?>
    <div class="post" id="post-<?php the_ID(); ?>">
        <h2><a href="<?php the_permalink() ?>"><?php the_title(); ?></a></h2>
        <div class="meta">
            <?php the_time('F jS, Y') ?>
            by <?php the_author() ?>

            <!-- displays the user's photo and then thumbnail -->
            <?php userphoto_the_author_photo() ?>
            <?php userphoto_the_author_thumbnail() ?>

            <!-- the following two do the same since $authordata populated -->
            <?php userphoto($authordata) ?>
            <?php userphoto_thumbnail($authordata) ?>

            <!-- and this is how to customize the output -->
            <?php userphoto_the_author_photo(
                '<b>Photo of me: ',
                '</b>',
                array('class' => 'photo'),
                get_template_directory_uri() . '/nophoto.jpg'
            ) ?>
        </div>
        <?php the_content('Read the rest of this entry &raquo;'); ?>
    </div>
<?php endwhile; ?>

```

If you want to display the user’s photo in the sidebar, just get the user ID or object and pass it into `userphoto()` or `userphoto_thumbnail()` like this:

```
<?php userphoto($posts[0]->post_author); ?>

```

If you want to display a user’s photo their author page, you may do this:

```
<?php userphoto($wp_query->get_queried_object()) ?>

```

In version 0.9 the boolean function `userphoto_exists($user)` has been introduced which returns true if the user has a photo and false if they do not.

Argument `$user` may be user object, ID, or login name. This function can be used along with avatars:

```
<?php
if(userphoto_exists($user))
    userphoto($user);
else
    echo get_avatar($user->ID, 96);
?>

```

Or if the new “Serve Avatar as Fallback” option is turned on, then the avatar will be served by any of the regular calls to display the user photo:

```
<?php
//this will display the user's avatar if they don't have a user photo,
//  and if "Serve Avatar as Fallback" is turned on
userphoto($user);
?>

```

Additionally, all of the regular function calls to display the user photo may be done away with alltogether if the new “Override Avatar with User Photo”

option is enabled:

```
<?php
//both will display the user photo if it exists
//  and if "Override Avatar with User Photo" is turned on
echo get_avatar($user_id);
echo get_avatar($user->user_email);
?>

```

Both options “Serve Avatar as Fallback” and “Override Avatar with User Photo” require that the ‘Avatar Display’ setting under Discussion be set to “Show”.

Uploaded images may be moderated by administrators via the “Edit User” page.

Localizations included for Spanish, German, Dutch, Polish, Russian, French, Hungarian, Brazilian Portuguese, Italian, and Catalan.

If you value this plugin, *please donate* to ensure that it may continue to be maintained and improved.

## Screenshots

* [![](https://ps.w.org/user-photo/trunk/screenshot-1.jpg?rev=1776705)](https://ps.w.org/user-photo/trunk/screenshot-1.jpg?rev=1776705)

  Admin section in User Profile page

## Reviews

![](https://secure.gravatar.com/avatar/87eba41341692e5c06e37db20973440558c809f3fe0faf6ead0851bc0d7b74af?s=60&d=retro&r=g)
### [Shortecodes](https://wordpress.org/support/topic/shortecodes/)

[mahdiasadi77](https://profiles.wordpress.org/mahdiasadi77/ "Posts by mahdiasadi77")
December 6, 2020

does it have any shortecode for displaying in pages?

![](https://secure.gravatar.com/avatar/10001bd487a0a3cae79c1d20f0c2c73d1d38a27d726f421823c162c8f7f5168c?s=60&d=retro&r=g)
### [Works with 4.7.6](https://wordpress.org/support/topic/works-with-4-7-6/)

[noticierodigital3](https://profiles.wordpress.org/noticierodigital3/ "Posts by noticierodigital3")
October 3, 2017

Works with 4.7.6

![](https://secure.gravatar.com/avatar/4295a5a4074eb61278a808430aebb43acf529368de3f6311b15f049c0579a7b9?s=60&d=retro&r=g)
### [Perfect](https://wordpress.org/support/topic/perfect-2451/)

[markusthayer](https://profiles.wordpress.org/markusthayer/ "Posts by markusthayer")
September 3, 2016

Works fine!

![](https://secure.gravatar.com/avatar/32da987831b95791b03be4b445cebd74335e95ed94e648c6ad20aa00b6346060?s=60&d=retro&r=g)
### [works fine for me](https://wordpress.org/support/topic/works-fine-for-me-38/)

[daneshva](https://profiles.wordpress.org/daneshva/ "Posts by daneshva")
February 8, 2017

Thank you!

[Read all 20 reviews](https://wordpress.org/support/plugin/user-photo/reviews/)
## Contributors & Developers

“User Photo” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/63b496ec3806485229b4f934b26643dad6e734ca6e6ef7b38c846205b01cd37f?s=32&d=mm&r=g) [Weston Ruter](https://profiles.wordpress.org/westonruter/)
* ![](https://secure.gravatar.com/avatar/344653ee76e4fc90cb406062cd8a6fc04977571f5eb09af7ae58736249d65f98?s=32&d=mm&r=g) [Ryan Hellyer](https://profiles.wordpress.org/ryanhellyer/)
* ![](https://secure.gravatar.com/avatar/d61b0835cb1286b4dcfe7bd45683bbbc13ee736e5d56efbda56ac9073a1c3310?s=32&d=mm&r=g) [Glen Scott](https://profiles.wordpress.org/glen_scott/)

“User Photo” has been translated into 1 locale. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/user-photo/contributors) for their contributions.

[Translate “User Photo” into your language.](https://translate.wordpress.org/projects/wp-plugins/user-photo)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/user-photo/), check out the [SVN repository](https://plugins.svn.wordpress.org/user-photo/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/user-photo/) by [RSS](https://plugins.trac.wordpress.org/log/user-photo/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 0.9.10

* Added recommendation to upgrade in wp-admin/plugins.php
* Provided option to never see the upgrade notice again

#### 0.9.9

* Removed deprecated mysql\_ function

#### 0.9.8

* Optimised retrieval of administrators for settings page

#### 0.9.7

* Fixed WordPress deprecated notices

#### 0.9.6

* Fixed PHP notice about deprecated argument
* Use semantic versioning for plugin files

#### 2012-05-08: 0.9.5.2

* Security issue (credit Ryan Hellyer).

#### 2011-02-17: 0.9.5

* Fixing major security issue (credit ADVtools SARL).

#### 2009-7-28

* Fixed a small bug relating to line 453 changing “home” to “siteurl”. Thanks Piotr!

#### 2009-02-13

* Added Catalan localization. Thanks Robert!
* 2009-02-28 =
* Added Italian localization. Thanks Federico!

#### 2009-02-17

* Added Brazilian Portuguese localization. Thanks gui!

#### 2009-01-07

* Added Hungarian localization. Thanks Csaba!

#### 2008-12-11

* Added French localization. Thanks Jean-Pierre!

#### 2008-11-14: 0.9.4

* Now displaying error message if `wp_upload_dir()` fails when trying to display a user photo.

#### 2008-11-14: 0.9.3

* Forcing the uploaded filename to lower-case

#### 2008-11-03: 0.9.2

* Updated error message to include results for `wp_upload_dir()`

#### 2008-09-22: 0.9.1

* Updated error messages to be more helpful (includes the paths in question). This will help debug some of the issues that have been raised on the forums lately.

#### 2008-09-22: 0.9

* First argument to `userphoto()` and `userphoto_thumbnail()` may now just be a user ID or user login name in addition to a user object.
* New “Serve Avatar as Fallback” option; this is disabled by default.
* New boolean function `userphoto_exists($user)` which returns true if the user has a photo and false if they do not. Argument `$user` may be user object, ID, or login name.
* New option “Override Avatar with User Photo”; disabled by default.
* Adding `class="photo"` by default if no class attribute is supplied
* Fixed issue where thumbnail (and associated usermeta) wasn’t being deleted along with the full-size photo (thanks Oliver).
* Now using `wp_upload_dir()` to get the basedir for where the userphoto directory will be located.

#### 2008-08-01: 0.8.2

* Verified that works in WP 2.6; added note explaining what the error message regarding what “image resizing not available” means… namely that the GD module is not installed.

#### 2008-05-29: 0.8.1

* Added localization for Russian (thanks Kyr!)

#### 2008-05-17: 0.8.1

* Finally updated the plugin for WP 2.5. Note that it still worked for 2.5, it’s just the admin interfaces needed to be updated. Also added `userphoto()` and `userphoto_thumbnail()` template tags.

#### 2008-04-23: 0.8.0.5

* Added localization for Polish (thanks Maciej!)

#### 2008-04-04: 0.8.0.4

* Fixed issue where incorrect path was being generated for default photo.

#### 2008-04-04: 0.8.0.3

* Using `wp_mail` instead of `mail` (Thanks again, Kyle.)

#### 2008-03-28: 0.8.0.2b

* Ensured that “unapproved” photos are not displayed. (Thanks Kyle.)

#### 2008-02-24: 0.8.0.2

* Made minor improvement to security.

#### 2008-02-13: 0.8.0.1

* Removed `print_r()` from being called when using `$default_src` (thanks David!)

#### 2008-02-04: 0.8

* Allow before and after text to be outputted when there is a user photo.
* Allow attributes to be passed into template tags, including a default SRC value to be used when there is no user photo.
* Added Dutch localization translated by Joep Stender (thanks!)

#### 2008-01-07: 0.7.4b

* Added German localization translated by Robert Harm (thanks!)

#### 2008-01-06: 0.7.4

* Added support for localization and added Spanish localization translated by Pakus (thanks!)

#### 2008-01-02: 0.7.3

* Fixed issue where the post author photo was inadvertently used for non-registered comment author photos.

#### 2007-12-28: 0.7.2

* Improved error message raised when unable to create ‘userphoto’ directory under /wp-content/uploads/. It now asks about whether write-permissions are set for the directory.
* Improved the plugin activation handler.
* All uploaded images are now explicitly set to chmod 666.

#### 2007-12-22: 0.7.1

* All functions (and template tags) now are prefixed with “userphoto\_”

#### 2007-12-18: 0.7.0.1

* Now using `siteurl` option instead of `home` option
* Fixed the inclusion of the stylesheet for the options page

#### Todo

1. When changing the authorization level, all previous users’ photos should be automatically approved if they meet the minimum user level
2. Include a get\_userphoto() and get\_userphoto\_thumbnail() ?
3. Add a management page to allow admins to quickly approve/reject user photos.
4. Add option so that when a photo is rejected, the user is notified.
5. Restrict image types acceptable?
6. Add an option to indicate a default photo to be used when none supplied.

## Meta

* Version **0.9.10**
* Last updated **7 years ago**
* Active installations **4,000+**
* WordPress version **3.0.5 or higher**
* Tested up to **4.6.29**
* Languages
  See all 2

  Close

  [English (US)](https://wordpress.org/plugins/user-photo/) and [French (France)](https://fr.wordpress.org/plugins/user-photo/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/user-photo)
* Tags [images](https://wordpress.org/plugins/tags/images/)[photos](https://wordpress.org/plugins/tags/photos/)[users](https://wordpress.org/plugins/tags/users/)
* [Advanced View](https://wordpress.org/plugins/user-photo/advanced/)

## Ratings

4.3 out of 5 stars.

* [13 5-star reviews
  5 stars

  13](https://wordpress.org/support/plugin/user-photo/reviews/?filter=5)
* [3 4-star reviews
  4 stars

  3](https://wordpress.org/support/plugin/user-photo/reviews/?filter=4)
* [2 3-star reviews
  3 stars

  2](https://wordpress.org/support/plugin/user-photo/reviews/?filter=3)
* [0 2-star reviews
  2 stars

  0](https://wordpress.org/support/plugin/user-photo/reviews/?filter=2)
* [2 1-star reviews
  1 star

  2](https://wordpress.org/support/plugin/user-photo/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/user-photo/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/user-photo/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/63b496ec3806485229b4f934b26643dad6e734ca6e6ef7b38c846205b01cd37f?s=32&d=mm&r=g) [Weston Ruter](https://profiles.wordpress.org/westonruter/)
* ![](https://secure.gravatar.com/avatar/344653ee76e4fc90cb406062cd8a6fc04977571f5eb09af7ae58736249d65f98?s=32&d=mm&r=g) [Ryan Hellyer](https://profiles.wordpress.org/ryanhellyer/)
* ![](https://secure.gravatar.com/avatar/d61b0835cb1286b4dcfe7bd45683bbbc13ee736e5d56efbda56ac9073a1c3310?s=32&d=mm&r=g) [Glen Scott](https://profiles.wordpress.org/glen_scott/)
## Support

Got something to say? Need help?

[View support forum](https://wordpress.org/support/plugin/user-photo/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.exploit-db.com_1556f9a0_20250124_155308.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# WordPress Plugin User Photo Component - Arbitrary File Upload

#### EDB-ID:

###### 16181

#### CVE:

###### [2013-1916](https://nvd.nist.gov/vuln/detail/CVE-2013-1916)

---

**EDB Verified:**

#### Author:

###### [ADVtools](/?author=3187)

#### Type:

###### [webapps](/?type=webapps)

---

#### Platform:

###### [PHP](/?platform=php)

#### Date:

###### 2011-02-17

---

**Vulnerable App:**

```
# Exploit Title: WordPress User Photo Component Remote File Upload Vulnerability
# Google Dork: inurl:"/wp-content/uploads/userphoto/"
# Date: 17/FEB/2011
# Author: ADVtools
# Software Link: http://wordpress.org/extend/plugins/user-photo/
# Version: 0.9.4
# Tested on: *nix , Windows

I. Product Description

User Photo is a WordPress component that allows a user to associate a photo with her account and for this photo to be displayed in  posts and comments.

II. Vulnerability description

When a photo is uploaded, it is only partially validated and it is possible to upload a backdoor on the server hosting WordPress. This backdoor can be called (executed) even if the photo has not been yet approved.

III. Analysis

1. Image type validation

When a file is uploaded, its type is validated. Only the following types are accepted:

       $userphoto_validtypes = array(
               "image/jpeg" => true,
               "image/pjpeg" => true,
               "image/gif" => true,
               "image/png" => true,
               "image/x-png" => true
       );

The type is validated by the following code:

       if(@!$userphoto_validtypes[$_FILES['userphoto_image_file']['type']])
               $error = sprintf(__("The uploaded file type &ldquo;%s&rdquo; is not allowed.", 'user-photo'), $_FILES['userphoto_image_file']['type']);

This code verifies the MIME type of the uploaded file. A navigator infers the MIME type from the file itself or from its extension but it is possible to intercept the HTTP request and change it (using a proxy such as WebScarab). This way, any file can be uploaded as if it were an image. The HTTP header to change is Content-type:

Content-type: image/gif

2. Image resizing

When a photo (an image) is uploaded, its size is checked. If it is too big, it is resized. To avoid this resizing, the uploaded file has to look like a small image. The verification of the size of the image is done with code such as:

       $imageinfo = getimagesize($tmppath);

In the case of GIF, this PHP function simply looks at the beginning of the GIF header and extracts the size of the image. A GIF header starts with:

Offset   Length   Contents
 0      3 bytes  "GIF"
 3      3 bytes  "87a" or "89a"
 6      2 bytes  <Logical screen width in little-endian byte order>
 8      2 bytes  <Logical screen height in little-endian byte order>

getimagesize ignores the remaining of the binary data. It is thus easy to create a file that looks like a small GIF image but that is in fact something else.

3. PHP file

A PHP file can contain binary data. This data are reflected on the output steam without interpretation. Only data between <?php and ?> are interpreted as PHP code (see http://www.php.net/manual/en/language.basic-syntax.phpmode.php). Using this characteristic and the previous point, it is thus possible to construct a file that looks like a small GIF image but that is in fact a PHP file. For example (in hexadecimal):

       47 49 46 38 39 61 14 00 14 00 3C 3F 70 68 70 20 70 68 70 69 6E 66 6F 28 29 3B 20 3F 3E

This file is recognized as a GIF image with a width and a height of 20 pixels and also as a PHP file containing a call to phpinfo(). Using the same technic, it is possible to upload a backdoor.

4. Uploading

Once uploaded, the PHP file is always located at the same place:

       wp-content/uploads/userphoto/alice.php

where alice is the login name (nickname) of the user uploading the file.

Important: This file is present even if it has not yet been approved by the moderator.

5. Limitation

Since the PHP file begins with a fake GIF header, this header will be output for every response. In practice, this is not really a problem: it can be simply ignored (in the case of a backdoor outputting HTML) or manually removed (in the case of the downloading of file). In some cases (for example when images are dynamically returned), a backdoor has to be slightly modified to avoid outputting two GIF headers.

6. Special case

In some installations, PHP files are interpreted as Unicode (16 bits). Since the beginning of the GIF header is 16-bit aligned, it is not an issue. The PHP code has to be written in Unicode.

7. Other concerns

This component contains also a XSS vulnerability located in the same lines of code.

IV. Versions affected

Version 0.9.4 (latest version as of January 2011).

Other versions were not tested.

V. Impact

The exact impact depends of the configuration of the web server and of the operating system:

- In the worst case, if Apache is running as root or as an Administrator, the server is compromised (owned).

- If the Apache server is running as a dedicated low privilege user, the backdoor will have limited access. Most of the time, the backdoor will have read access but no write access except in very specific places. To compromise the server, another vulnerability is necessary (escalation).

VI. Proof of concept / Exploit

See part III and attachment.

VII. Mitigation, Workaround and fix

The hardening of the web server will limit the impact.

VIII. Disclosure time-line

2010.07      First researches, vulnerability discovered
2011.01.24   Proof of concept
2011.01.27   Vendor notified
2011.02.17   Public disclosure

IX. References

Graphics Interchange Format
http://en.wikipedia.org/wiki/Graphics_Interchange_Format

GIF specification
http://www.w3.org/Graphics/GIF/spec-gif89a.txt

PHP Escaping from HTML
http://www.php.net/manual/en/language.basic-syntax.phpmode.php

Passing Malicious PHP Through getimagesize()
http://ha.ckers.org/blog/20070604/passing-malicious-php-through-getimagesize/

PHP Exploit Code in a GIF
http://isc2.sans.org/diary.html?storyid=2997

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from plugins.trac.wordpress.org_7785142a_20250124_155306.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F347137)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/347136 "Changeset 347136")
* [Next Changeset](/changeset/347138 "Changeset 347138") →

---

# Changeset 347137

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
02/18/2011 12:42:44 AM
([14 years](/timeline?from=2011-02-18T00%3A42%3A44Z&precision=second "See timeline at 02/18/2011 12:42:44 AM") ago)

Author:
westonruter
Message:

0.9.5 Fixing major security issue (credit ADVtools SARL)

Location:
[user-photo/trunk](/browser/user-photo/trunk?rev=347137)
Files:

2 edited

* [readme.txt](/browser/user-photo/trunk/readme.txt?rev=347137 "Show entry in browser")
  (modified)
  ([3 diffs](#file0 "Show differences"))
* [user-photo.php](/browser/user-photo/trunk/user-photo.php?rev=347137 "Show entry in browser")
  (modified)
  ([4 diffs](#file1 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [user-photo/trunk/readme.txt](/changeset/347137/user-photo/trunk/readme.txt "Show the changeset 347137 restricted to user-photo/trunk/readme.txt")

  | [r140615](/browser/user-photo/trunk/readme.txt?rev=140615#L2 "Show revision 140615 of this file in browser") | [r347137](/browser/user-photo/trunk/readme.txt?rev=347137#L2 "Show revision 347137 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | Contributors: cptnwinky, westonruter |
  | 3 | 3 | Tags: users, photos, images |
  | 4 |  | Tested up to: ~~2.7~~ |
  | 5 |  | Stable tag: 0.9.~~4~~ |
  |  | 4 | Tested up to: 3.0.5 |
  |  | 5 | Stable tag: 0.9.5 |
  | 6 | 6 |  |
  | 7 | 7 | Allows a user to associate a photo with their account and for this photo to be displayed in their posts and comments. |
  | 8 | 8 |  |
  | 9 | 9 | == Description == |
  |  | 10 |  |
  |  | 11 | \*\*\*Make sure you upgrade to version 0.9.5!\*\*\* |
  | 10 | 12 |  |
  | 11 | 13 | Allows a user to associate a profile photo with their account through their "Your Profile" page. Admins may |
  | […](/browser/user-photo/trunk/readme.txt?rev=140615#L114) | […](/browser/user-photo/trunk/readme.txt?rev=347137#L116) |  |
  | 114 | 116 | == Changelog == |
  | 115 | 117 |  |
  |  | 118 | = 2011-02-17: 0.9.5 = |
  |  | 119 |  |
  |  | 120 | \* Fixing major security issue (credit ADVtools SARL). |
  |  | 121 |  |
  | 116 | 122 | = 2009-7-28 = |
  | 117 | 123 |  |
  | […](/browser/user-photo/trunk/readme.txt?rev=140615#L122) | […](/browser/user-photo/trunk/readme.txt?rev=347137#L128) |  |
  | 122 | 128 | \* Added Catalan localization. Thanks Robert! |
  | 123 | 129 |  |
  | 124 |  | \*2009-02-28 = |
  |  | 130 | \* 2009-02-28 = |
  | 125 | 131 |  |
  | 126 | 132 | \* Added Italian localization. Thanks Federico! |
* ## [user-photo/trunk/user-photo.php](/changeset/347137/user-photo/trunk/user-photo.php "Show the changeset 347137 restricted to user-photo/trunk/user-photo.php")

  | [r140146](/browser/user-photo/trunk/user-photo.php?rev=140146#L4 "Show revision 140146 of this file in browser") | [r347137](/browser/user-photo/trunk/user-photo.php?rev=347137#L4 "Show revision 347137 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Plugin URI: http://wordpress.org/extend/plugins/user-photo/ |
  | 5 | 5 | Description: Allows users to associate photos with their accounts by accessing their "Your Profile" page. Uploaded images are resized to fit the dimensions specified on the options page; a thumbnail image is also generated. New template tags introduced are: <code>userphoto\_the\_author\_photo</code>, <code>userphoto\_the\_author\_thumbnail</code>, <code>userphoto\_comment\_author\_photo</code>, and <code>userphoto\_comment\_author\_thumbnail</code>. Uploaded images may be moderated by administrators. |
  | 6 |  | Version: 0.9.~~4~~ |
  |  | 6 | Version: 0.9.5 |
  | 7 | 7 | Author: <a href="http://weston.ruter.net/">Weston Ruter</a>, <a href="http://dev.dave-wagner.com/">Dave Wagner's Dev Site</a> |
  | 8 | 8 |  |
  | […](/browser/user-photo/trunk/user-photo.php?rev=140146#L48) | […](/browser/user-photo/trunk/user-photo.php?rev=347137#L48) |  |
  | 48 | 48 | "image/x-png" => true |
  | 49 | 49 | ); |
  |  | 50 | $userphoto\_validextensions = array('jpeg', 'jpg', 'gif', 'png'); |
  | 50 | 51 |  |
  | 51 | 52 | define('USERPHOTO\_PENDING', 0); |
  | […](/browser/user-photo/trunk/user-photo.php?rev=140146#L317) | […](/browser/user-photo/trunk/user-photo.php?rev=347137#L318) |  |
  | 317 | 318 | function userphoto\_profile\_update($userID){ |
  | 318 | 319 | global $userphoto\_validtypes; |
  |  | 320 | global $userphoto\_validextensions; |
  | 319 | 321 | global $current\_user; |
  | 320 | 322 |  |
  | […](/browser/user-photo/trunk/user-photo.php?rev=140146#L377) | […](/browser/user-photo/trunk/user-photo.php?rev=347137#L379) |  |
  | 377 | 379 | } |
  | 378 | 380 | } |
  | 379 |  | else if(~~!$\_FILES['userphoto\_image\_file']['size'])~~ |
  |  | 381 | else if( !$\_FILES['userphoto\_image\_file']['size'] ){ |
  | 380 | 382 | $error = sprintf(\_\_("The file &ldquo;%s&rdquo; was not uploaded. Did you provide the correct filename?", 'user-photo'), $\_FILES['userphoto\_image\_file']['name']); |
  | 381 |  | else if(@!$userphoto\_validtypes[$\_FILES['userphoto\_image\_file']['type']]) //!preg\_match("/\.(" . join('|', $userphoto\_validextensions) . ")$/i", $\_FILES['userphoto\_image\_file']['name'])) || |
  |  | 383 | } |
  |  | 384 | else if( !preg\_match("/\.(" . join('|', $userphoto\_validextensions) . ")$/i", $\_FILES['userphoto\_image\_file']['name']) ){ |
  |  | 385 | $error = sprintf(\_\_("The file extension &ldquo;%s&rdquo; is not allowed. Must be one of: %s.", 'user-photo'), preg\_replace('/.\*\./', '', $\_FILES['userphoto\_image\_file']['name']), join(', ', $userphoto\_validextensions)); |
  |  | 386 | } |
  |  | 387 | else if( @!$userphoto\_validtypes[$\_FILES['userphoto\_image\_file']['type']] ){ |
  | 382 | 388 | $error = sprintf(\_\_("The uploaded file type &ldquo;%s&rdquo; is not allowed.", 'user-photo'), $\_FILES['userphoto\_image\_file']['type']); |
  |  | 389 | } |
  | 383 | 390 |  |
  | 384 | 391 | $tmppath = $\_FILES['userphoto\_image\_file']['tmp\_name']; |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=347137)
* [Zip Archive](?format=zip&new=347137)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


