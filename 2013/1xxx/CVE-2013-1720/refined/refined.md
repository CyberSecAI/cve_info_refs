## CVE-2013-1720

Based on the provided information, here's an analysis of CVE-2013-1720:

**Description:** Improper state in HTML5 Tree Builder with templates

**Root Cause:** The HTML5 Tree Builder in Firefox, SeaMonkey, and Thunderbird does not properly store state when interacting with `template` elements. Specifically, the template insertion mode stack information is not saved in `TreeBuilderState`. This can lead to the template insertion mode stack being used when it is empty.

**Vulnerability:** Heap-buffer-overflow READ. Reading a stored tree builder mode from an array that represents the stack of modes that got remembered when handling `<template>` elements. The value is then used as the actual tree builder mode, which is the main state variable that the tree builder uses the switch statement on. The templateModePtr index is not a valid index of the current templateModeStack array, resulting in reading random numbers off the heap (index -1 of a heap allocated array).

**Impact:**
*   **Firefox/SeaMonkey:** Possibly leads to code execution in some circumstances. The parser may end up ignoring some tokens and outputting error messages, resulting in a DOM tree that does not match the markup.
*   **Thunderbird:**  The vulnerability is less likely to be exploited directly through email because scripting is disabled by default. However, it could be a risk in browser-like contexts within Thunderbird.
*   Denial of service.

**Attack Vector:** An attacker could exploit this flaw by tricking a user into opening a specially crafted HTML page containing `template` elements.

**Required Capabilities:** The attacker needs to be able to create or control the content of an HTML page that is opened by a vulnerable application (Firefox, SeaMonkey, or Thunderbird).

**Affected Products/Versions:**

*   Firefox 23 and earlier
*   SeaMonkey 2.21 and earlier
*   Thunderbird 24 and earlier
*   openSUSE 11.4, 12.2 and 12.3

**Fix:** The issue was fixed by saving the template insertion mode stack information in `TreeBuilderState`.

**Ubuntu:** The vulnerability is fixed in the following package versions:

*   Ubuntu 13.04: firefox 24.0+build1-0ubuntu0.13.04.1 and thunderbird 1:24.0+build1-0ubuntu0.13.04.1
*   Ubuntu 12.10: firefox 24.0+build1-0ubuntu0.12.10.1 and thunderbird 1:24.0+build1-0ubuntu0.12.10.1
*   Ubuntu 12.04: firefox 24.0+build1-0ubuntu0.12.04.1 and thunderbird 1:24.0+build1-0ubuntu0.12.04.1