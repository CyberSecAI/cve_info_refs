```
Message-ID: <51420B45.3090802@openstack.org>
Date: Thu, 14 Mar 2013 18:39:17 +0100
From: Thierry Carrez <thierry@...nstack.org>
To: "openstack@...ts.launchpad.net" <openstack@...ts.launchpad.net>,
 oss-security@...ts.openwall.com, openstack-announce@...ts.openstack.org
Subject: [OSSA 2013-008] Nova DoS by allocating all Fixed IPs (CVE-2013-1838)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

OpenStack Security Advisory: 2013-008
CVE: CVE-2013-1838
Date: March 14, 2013
Title: Nova DoS by allocating all Fixed IPs
Reporter: Vish Ishaya (Nebula)
Products: Nova
Affects: All versions

Description:
Vish Ishaya reported a vulnerability in Nova where there is no quota for
Fixed IPs. Previously the instance quota acted as a proxy for a Fixed IP
quota, but if your configuration allows an instance to consume more than
one Fixed IP via an extension such as multinic then this is no longer
true. Running out of Fixed IPs would result in not being able to spawn
new instances.

Grizzly (development branch) fix:
<https://review.openstack.org/#/c/24451/>

Folsom fix:
<https://review.openstack.org/#/c/24452/>

Essex fix:
<https://review.openstack.org/#/c/24453/>

References:
[https://bugs.launchpad.net/nova/+bug/1125468](https://bugs.launchpad.net/nova/%2Bbug/1125468)
<http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2013-1838>

- --
Thierry Carrez (ttx)
OpenStack Vulnerability Management Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with undefined - <http://www.enigmail.net/>

iQIcBAEBCAAGBQJRQgtEAAoJEFB6+JAlsQQjf6gP/0Ao3Hq5MSChlbwtjMiUPPlC
ralE6V5l3/V/jPJ/XiHrSJo2qbwgil4SSrwj6mDx00bwj3lLyYKV9KjRx9FJjwl0
YuUm/AY1R4/miED8HyjhhteC0xAisqciwZQLrN6DwAdP3YEDZZk0Cfxp3Xw6XxAM
SAb2Gp0Ranu0lc7jLBNsp0G4idZvF232kXRDEMgpAwcsjmxh1sl97IBUqq87UJax
RDnI2p/bpPahZXBZK4RPZR92IbdVZ4SE+piC0b4ITESdxAh9NadWfUBIkf4fOdvM
yVKWFvRMhIFqTFEnpaX/091mOzkHJ8bWRpKImrw3qSLvXzyzlBwuuT0NyL6qDTPQ
0cY9gkiyqOtlvsAxF7tNDHxnIlq/zy86Tvi3KVoyJcUenGPjZwWNINhyvvFWs03t
n0W58XQOnXPxYLSI3CG5gUcJUWTbJQKQAapkoMGUASc7kcVCNv334z45Ui4n51o4
5WUOQTzgWJRskqolull7wpScaNoZtQgnnSTHwtAXt4Pykum4N3FEOEo4C/gHa1uz
nW8YkZRgoHbGYNypNDDWE6UdPZT/WOO/+RbMQwRVitFJtHzG1FuLa1fNP6mKxDPn
vpHnp9jBZlW9OjBZgp7/YqFv586l/xrT1hG3i+I6fq2w5G7Gru5PeRhUElzq4qHF
k+FvT1+nkHkvTbMb8z1z
=gipy
-----END PGP SIGNATURE-----
```

```
# USN-1771-1: OpenStack Nova vulnerabilities

20 March 2013

Two security issues were fixed in Nova.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 12.10](/security/notices?release=quantal)
* [Ubuntu 12.04](/security/notices?release=precise)
* [Ubuntu 11.10](/security/notices?release=oneiric)

## Packages

* [nova](/security/cves?package=nova) - OpenStack Compute cloud infrastructure

## Details

Vish Ishaya discovered that Nova did not always enforce quotas on fixed

IPs. An authenticated attacker could exploit this to cause a denial of

service via resource consumption. Nova will now enforce a quota limit of

10 fixed IPs per instance, which is configurable via 'quota\_fixed\_ips'

in /etc/nova/nova.conf. ([CVE-2013-1838](/security/CVE-2013-1838))
```

```
[**Bug 919648**](show_bug.cgi?id=919648)
(CVE-2013-1838)
- [CVE-2013-1838](https://access.redhat.com/security/cve/CVE-2013-1838) Openstack Nova: DoS by allocating all Fixed IPs

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2013-1838 Openstack Nova: DoS by allocating all Fixed IPs
```

```
[Description](show_bug.cgi?id=919648#c0)  Kurt Seifried    2013-03-09 07:07:33 UTC  ```  Russel Bryant (rbryant) reports:   Title: DoS by allocating all Fixed IPs Impact: Medium Reporter: Vish Ishaya (Nebula) Products: Nova Affects: All versions  Description: Vish Ishaya reported a vulnerability in Nova where there is no quota for Fixed IPs. Previously the instance quota acted as a proxy for a Fixed IP quota, but if your configuration allows an instance to consume more than one Fixed IP via an extension such as multinic then this is no longer true. Running out of Fixed IPs would result in not being able to spawn new instances.  Proposed patches: See attached patches. Unless a flaw is discovered in them, these patches will be merged to Nova master (Grizzly), stable/folsom, and stable/essex branches on the public disclosure date.   ```
```

```
# [OSSA 2013-008] DOS by allocating all fixed ips

Bug #1125468 reported by
[Vish Ishaya](https://launchpad.net/~vishvananda)
on 2013-02-14

### Bug Description

When using FlatDHCP networking it is possible for a user to use up all of the fixed ips by repeatedly calling addFixedIp to an instance.

Repro case allocating 100 fixed ips:

nova boot --flavor=1 --image=<image> foo

for i in {1..100}; do

  nova add-fixed-ip foo

done

When all ips are exhausted it is impossible for anyone to boot a vm

Note this is possible in vlan mode, but it would only DOS a single tenant in this case.
```

```
### CVE-2013-1838

**Root cause:** The vulnerability arises from a lack of a specific quota for Fixed IPs in OpenStack Nova. The instance quota was previously used as an indirect control for Fixed IPs. However, this approach becomes insufficient when configurations allow an instance to use multiple Fixed IPs via extensions such as multinic.

**Weaknesses:**
- Absence of a dedicated quota for Fixed IPs.
- Reliance on instance quota as a proxy, which is bypassed by multinic.

**Impact of exploitation:**
- Denial of Service (DoS) by exhausting the pool of available Fixed IPs, preventing new instances from being spawned.

**Attack vectors:**
- An authenticated user can exploit this by repeatedly adding Fixed IPs to an instance.
-  `nova add-fixed-ip` command through the multinic extension

**Required attacker capabilities/position:**
- An authenticated user with the ability to use the `nova add-fixed-ip` command.
```