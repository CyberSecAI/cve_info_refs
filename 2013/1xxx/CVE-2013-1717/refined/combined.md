=== Content from www.mozilla.org_cc2e69b4_20250124_120738.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2013-75

## Local Java applets may read contents of local file system

Announced
August 6, 2013
Reporter
Georgi Guninski, John Schoenick
Impact
High
Products
Firefox, Firefox ESR, SeaMonkey, Thunderbird, Thunderbird ESR
Fixed in

* Firefox 23
* Firefox ESR 17.0.8
* SeaMonkey 2.20
* Thunderbird 17.0.8
* Thunderbird ESR 17.0.8

### Description

Security researcher **Georgi Guninski** reported an issue with
Java applets where in some circumstances the applet could access files on the
local system when loaded using the a `file:///` URI and violate file
origin policy due to interaction with the `codebase` parameter. This
affects applets running on the local file system. Mozilla developer **John
Schoenick** later discovered that fixes for this issue were inadequate
and allowed the invocation of Java applets to bypass security checks in
additional circumstances. This could lead to untrusted Java applets having
read-only access on the local files system if used in conjunction with a method
to download a file to a known or guessable path.

In general these flaws cannot be exploited through email in the
Thunderbird product because scripting is disabled, but are potentially a risk in
browser or browser-like contexts.

### References

* [local java applet may read arbitrary files under certain
  circumstances](https://bugzilla.mozilla.org/show_bug.cgi?id=406541) ([CVE-2013-1717](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1717))
* [Java applets may read arbitrary files on a user's system](https://bugzilla.mozilla.org/show_bug.cgi?id=738396)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_ef8238f3_20250126_010145.html ===


# BMO/UserGuide/Whiteboard

From MozillaWiki
< [BMO](/BMO "BMO")â€Ž | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)

Each bug has a free-form single line text entry box for adding tags and status information. This wiki page is dedicated to collect a comprehensive list of whiteboard tags used in the Mozilla project.

## Contents

* [1 Whiteboard considered harmful](#Whiteboard_considered_harmful)
* [2 Contributor mentoring](#Contributor_mentoring)
* [3 Automated Testing](#Automated_Testing)
* [4 Autonag](#Autonag)
* [5 Release Engineering](#Release_Engineering)
* [6 Sheriffing](#Sheriffing)
* [7 Firefox](#Firefox)
* [8 Community reported bugs](#Community_reported_bugs)
* [9 Firefox OS](#Firefox_OS)
* [10 Tor](#Tor)
* [11 Web Compatibility](#Web_Compatibility)
* [12 Scrum Development](#Scrum_Development)
* [13 What does this whiteboard keyword mean?](#What_does_this_whiteboard_keyword_mean?)
## Whiteboard considered harmful

It is recommended that you request alternative metadata instead of using whiteboard tagging.

* Updating whiteboards tags through the API is non-trivial
* There is no global auto-suggest for whiteboard tags
* There is no verification of whiteboard tags; typos will not be caught and prevented
* Renaming a whiteboard tag requires writing a script to update every bug with that tag, changing its last modified timestamp and generating bugmail; other solutions involve a simple change by administrators
* Whiteboard tags cannot be disabled; people might continue to provide them after they are no longer relevant thinking they still apply
* If desired it's possible to restrict who can set flags to particular values; it will never be possible to prevent accidental or other changes to the whiteboard from any user with editbugs or the bug's reporter

Consider using a keyword, a flag, or a status flag. You can request this on [Bugzilla](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).

## Contributor mentoring

For more information, see [Mentors](/Mentors "Mentors").

* `[lang=]`: The programming language involved for this bug.
* `[mentor-lang=]`: (human/natural) language other than English the mentor will be able to communicate to the contributor with.

## Automated Testing

* `[test disabled]`: Indicates an automated test has been disabled. Typically used in bugs filed for intermittent test failures, to indicate that the absence of new failures in the bug is due to the test being disabled - as well as remind module owners that the test needs fixing and re-enabling.

## Autonag

`[no-nag]`: Indicates that a bug should not be modified or commented in by our [Autonag](/Release_Management/autonag "Release Management/autonag") scripts.

## Release Engineering

* `[capacity]`: This bug will help increase (or free up) capacity for our automated build & test machines.

## Sheriffing

* `[leave open]`: This has [been deprecated](https://groups.google.com/forum/#!topic/mozilla.dev.platform/Ie9OXcWbTSs) in favour of the 'leave-open' keyword. Used to ensure that the bug updating tool mcMerge does not close the bug when commits referencing it are merged into mozilla-central.
* `[retriggered]`: Used by sheriffs when investigating Fresh Oranges [[1]](https://charts.mozilla.org/FreshOranges/index.html) to find where a failure started from, using backfills and retriggers

## Firefox

* `dupeme`, `dupme`, or `DUPEME`: we're pretty sure this bug report is a duplicate of another bug, but cannot recall which one or cannot find it.
* `[qa-]`: QE (Quality Engineering) verification not required - superseded by the qe-verify flag.
* `[adv-mainNN+]` (where `NN` is some number): a security advisory about this bug for the release `NN` will be (has been) written.
* `[MemShrink]`: [a project](/Performance/MemShrink "Performance/MemShrink") to reduce memory consumption.

## Community reported bugs

* `[nightly-community]`: This bug was reported by a member of the Firefox Nightly community. Used to triage community-reported bugs and measure the impact of our core community on product quality.
* `[mozfr-community]`: This bug was reported by a member of the MozFR French-speaking community. Used to evaluate the impact of the mozfr.org community on product quality.

## Firefox OS

[Template:Note: This project is no longer active, but we leave these definitions for bug tracker historian purposes](/index.php?title=Template:Note:_This_project_is_no_longer_active,_but_we_leave_these_definitions_for_bug_tracker_historian_purposes&action=edit&redlink=1 "Template:Note: This project is no longer active, but we leave these definitions for bug tracker historian purposes (page does not exist)")

* `[POVB]`: Part of vendor build; the fix of this bug is not in the Mozilla codebase, but it's in our interest to track it.
* `[priority]`: Indicates we are asked by a partner to address this issue with priority.
* `[tarako_only]`: Special pref or feature that only lands on branch for Tarako (low memory phone), i.e. 1.3T branch of Gaia and Gecko. To be picked up on future releases.
* `[p=]/[u=]/[c=]/[s=]`: See [Scrum Development](/BMO/Whiteboard#Scrum_Development "BMO/Whiteboard"). Firefox OS uses the u= tag as the milestone instead, see [Firefox OS Performance Triage](/FirefoxOS/Performance/Triage#Scrumbugs_Tags "FirefoxOS/Performance/Triage")
* `[ft:<name of the team>]`, `[systemsfe]`, etc: Bugs identified to be owned by a "functional team" within B2G engineering. Each team owns a specific set of Bugzilla components, and tags are used to denote owned bugs outside of these components.

## Tor

* `[tor ###]` Part of the [Tor uplift project](/Security/Tor_Uplift/Tracking "Security/Tor Uplift/Tracking"). For example, `[tor 16620]` indicates a corresponding ticket at <https://trac.torproject.org/16620>. See also <https://torpat.ch/uplift>

## Web Compatibility

[Our whiteboard keywords](/Compatibility/BugsGuide "Compatibility/BugsGuide") are already described.

## Scrum Development

The following flags are used by tools like [scrumbu.gs](https://scrumbu.gs/help/) for managing sprints using the scrum development framework:

* `[p=]`: A rough estimate from engineer on how long the bug is going to take.
* `[u=]`: The user (in the scrum sense) that this story affects
* `[c=]`: The component (in the scrum sense) that this story affects
* `[s=]`: An explicit sprint slug this bug should belong to.

If you are not managing a product, you probably don't have to set these.

## What does this whiteboard keyword mean?

If you know what one of the following whiteboard keywords means, please describe it and put it into one of the above categories above (or create a new one):

* `[2.0-FL-bug-bash]` (example: <https://bugzilla.mozilla.org/show_bug.cgi?id=1021384>)
* `[games]` (example: <https://bugzilla.mozilla.org/show_bug.cgi?id=1017892>)
* `[reserve-photon-structure]` ([examples](https://bugzilla.mozilla.org/buglist.cgi?list_id=14108939&status_whiteboard_type=substring&status_whiteboard=%5Breserve-photon-structure%5D&order=Bug%20Number&query_format=advanced))
* `[TCP]` (example: <https://bugzilla.mozilla.org/show_bug.cgi?id=920036>)
  + my guess: Tablet Contribution Program?

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/Whiteboard&oldid=1245932>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FWhiteboard "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/Whiteboard "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/Whiteboard&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/Whiteboard)
* [View source](/index.php?title=BMO/UserGuide/Whiteboard&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/Whiteboard&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/Whiteboard "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/Whiteboard "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/Whiteboard&oldid=1245932 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/Whiteboard&action=info "More information about this page")

* This page was last edited on 27 March 2023, at 15:08.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/Whiteboard&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from www.debian.org_d879e4b4_20250124_120737.html ===


---

[[Date Prev](msg00155.html)][[Date Next](msg00157.html)]
[[Thread Prev](msg00155.html)][[Thread Next](msg00157.html)]
[[Date Index](maillist.html#00156)]
[[Thread Index](threads.html#00156)]

# [SECURITY] [DSA 2746-1] icedove security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2746-1] icedove security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Thu, 29 Aug 2013 19:36:06 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20130829173606.GA6561%40pisco.westfalen.local)Â [20130829173606.GA6561@pisco.westfalen.local](msg00156.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2746-1                   security@debian.org
<http://www.debian.org/security/>                        Moritz Muehlenhoff
August 29, 2013                        <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : icedove
Vulnerability  : several
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-2013-1701 CVE-2013-1709 CVE-2013-1710 CVE-2013-1713
                 CVE-2013-1714 CVE-2013-1717

Multiple security issues have been found in Icedove, Debian's version of
the Mozilla Thunderbird mail and news client. Multiple memory safety
errors, missing permission checks and other implementation errors may
lead to the execution of arbitrary code or cross-site scripting.

The Icedove version in the oldstable distribution (squeeze) is no longer
supported with full security updates. However, it should be noted that
almost all security issues in Icedove stem from the included browser engine.
These security problems only affect Icedove if scripting and HTML mails
are enabled. If there are security issues specific to Icedove (e.g. a
hypothetical buffer overflow in the IMAP implementation) we'll make an
effort to backport such fixes to oldstable.

For the stable distribution (wheezy), these problems have been fixed in
version 17.0.8-1~deb7u1.

For the unstable distribution (sid), these problems have been fixed in
version 17.0.8-1.

We recommend that you upgrade your icedove packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (GNU/Linux)

iEYEARECAAYFAlIfhf8ACgkQXm3vHE4uylqF2QCeK7C4vEufIlumHBA/ElEt8/DK
WW8An0Q0dB0o6Q9xLtdKeDzbg7RB/J6c
=VAfs
-----END PGP SIGNATURE-----

```

---



=== Content from www.debian.org_7fccfaba_20250124_120737.html ===


---

[[Date Prev](msg00144.html)][[Date Next](msg00146.html)]
[[Thread Prev](msg00144.html)][[Thread Next](msg00146.html)]
[[Date Index](maillist.html#00145)]
[[Thread Index](threads.html#00145)]

# [SECURITY] [DSA 2735-1] iceweasel security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2735-1] iceweasel security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Wed, 7 Aug 2013 16:14:06 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20130807141406.GA7025%40pisco.westfalen.local)Â [20130807141406.GA7025@pisco.westfalen.local](msg00145.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2735-1                   security@debian.org
<http://www.debian.org/security/>                        Moritz Muehlenhoff
August 07, 2013                        <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : iceweasel
Vulnerability  : several
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-2013-1701 CVE-2013-1709 CVE-2013-1710 CVE-2013-1713
                 CVE-2013-1714 CVE-2013-1717

Multiple security issues have been found in Iceweasel, Debian's version
of the Mozilla Firefox web browser: Multiple memory safety errors,
missing permission checks and other implementation errors may lead to
the execution of arbitrary code, cross-site scripting, privilege
escalation, bypass of the same-origin policy or the installation of
malicious addons.

The Iceweasel version in the oldstable distribution (squeeze) is no
longer supported with security updates.

For the stable distribution (wheezy), these problems have been fixed in
version 17.0.8esr-1~deb7u1.

For the unstable distribution (sid), these problems have been fixed in
version 17.0.8esr-1.

We recommend that you upgrade your iceweasel packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (GNU/Linux)

iEYEARECAAYFAlICVeQACgkQXm3vHE4uylpxcwCg0aSZ2guURbRwOCvlMCEX8SLM
6d8AoJ+EWsZdjm/dtFxRNQ4QYgPrGC92
=tept
-----END PGP SIGNATURE-----

```

---



=== Content from wiki.mozilla.org_73f8d6fa_20250126_010146.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")â€Ž | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_52cae7ef_20250126_010145.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/738396)
* [XML](/show_bug.cgi?ctype=xml&id=738396)

Closed
[Bug 738396](/show_bug.cgi?id=738396)

Opened 13 years ago
Closed 12 years ago

# Java applets may read arbitrary files on a user's system

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Java applets may read arbitrary files on a user's system

## Categories

### (Core Graveyard :: Plug-ins, defect)

[Product:](/describecomponents.cgi?product=Core%20Graveyard)

Core Graveyard
â–¾

Core Graveyard
Old, retired Core components
[See Open Bugs in This Product](/buglist.cgi?product=Core%20Graveyard&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core%20Graveyard)
Watch This Product

[Component:](/describecomponents.cgi?product=Core%20Graveyard&component=Plug-ins#Plug-ins)

Plug-ins
â–¾

Core Graveyard :: Plug-ins
Bugs in core Mozilla code that supports registering and using plug-ins. For bugs in specific plugins, please file those bugs under External Software Affecting Firefox.
[See Open Bugs in This Component](/buglist.cgi?product=Core%20Graveyard&component=Plug-ins&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core%20Graveyard&component=Plug-ins&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core%20Graveyard&component=Plug-ins)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

## Tracking

### (firefox16- wontfix, firefox17+ wontfix, firefox18+ wontfix, firefox19 wontfix, firefox20 wontfix, firefox21+ wontfix, firefox22+ wontfix, firefox23+ verified, firefox24+ verified, firefox25 verified, firefox-esr10 wontfix, firefox-esr1723+ verified, b2g18 unaffected, b2g-v1.1hd unaffected)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla25

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox16 | [-](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix) |
| firefox17 | [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=wontfix) |
| firefox18 | [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=wontfix) |
| firefox19 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix) |
| firefox20 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=wontfix) |
| firefox21 | [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=wontfix) |
| firefox22 | [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=wontfix) |
| firefox23 | [+](/buglist.cgi?f1=cf_tracking_firefox23&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=verified) |
| firefox24 | [+](/buglist.cgi?f1=cf_tracking_firefox24&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=verified) |
| firefox25 | --- | [verified](/buglist.cgi?f1=cf_status_firefox25&o1=equals&v1=verified) |
| firefox-esr10 | --- | [wontfix](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=wontfix) |
| firefox-esr17 | [23+](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=23%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=verified) |
| b2g18 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected) |
| b2g-v1.1hd | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_1_1_hd&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox16 | - | wontfix |
| firefox17 | + | wontfix |
| firefox18 | + | wontfix |
| firefox19 |  | wontfix |
| firefox20 |  | wontfix |
| firefox21 | + | wontfix |
| firefox22 | + | wontfix |
| firefox23 | + | verified |
| firefox24 | + | verified |
| firefox25 |  | verified |
| firefox-esr10 |  | wontfix |
| firefox-esr17 | 23+ | verified |
| b2g18 |  | unaffected |
| b2g-v1.1hd |  | unaffected |

## People

### (Reporter: johns, Assigned: johns)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/e015aca8c2ea64974b5d4c29ae1ee603?d=mm&size=40)  [johns](/user_profile?user_id=429621)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/7bb698c4991c5af83adabe3c3b8ee8aa?d=mm&size=40)  [mwobensmith](/user_profile?user_id=452604)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/e015aca8c2ea64974b5d4c29ae1ee603?d=mm&size=40)  [johns](/user_profile?user_id=429621)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](extensions/Gravatar/web/default.jpg)  [jimm](/user_profile?user_id=279663)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

19 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[745030](/show_bug.cgi?id=745030 "RESOLVED FIXED - Refactor nsObjectLoadingContent"), [783059](/show_bug.cgi?id=783059 "RESOLVED FIXED - object/embed/applet tags need instantiation tests"), [888834](/show_bug.cgi?id=888834 "VERIFIED FIXED - Java won't load Runescape applet in Firefox Nightly 25.0a1(6-30), works in other browsers")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[CVE-2013-1717](/show_bug.cgi?id=406541 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances")

Dependency [tree](/showdependencytree.cgi?id=738396&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=738396)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-high, Whiteboard: [sg:high][adv-main23+][adv-esr1708+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sg:high][adv-main23+][adv-esr1708+]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [johns](/user_profile?user_id=429621) | [in-testsuite](#c64 "12 years ago") | + |
| --- | --- | --- |
| [johns](/user_profile?user_id=429621) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 5 obsolete files)

| [Construct codebase URI for Java plugins as java would](/attachment.cgi?id=731337)  [12 years ago](#c9)  [John Schoenick [:johns]](/user_profile?user_id=429621)   11.21 KB, patch | benjamin : [review+](#c20 "12 years ago")  jst : [superreview+](#c23 "12 years ago")  lsblakk : [approval-mozilla-aurora+](#c51 "12 years ago")  lsblakk : [approval-mozilla-beta+](#c51 "12 years ago")  lsblakk : [approval-mozilla-esr17+](#c51 "12 years ago")  abillings : [sec-approval+](#c42 "12 years ago")  johns : [checkin+](#c45 "12 years ago") | [Details](/attachment.cgi?id=731337&action=edit) | [Diff](/attachment.cgi?id=731337&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731337) |
| --- | --- | --- |
| [Only pass canonicalized codebase to Java](/attachment.cgi?id=731338)  [12 years ago](#c10)  [John Schoenick [:johns]](/user_profile?user_id=429621)   9.12 KB, patch | benjamin : [review+](#c21 "12 years ago")  jst : [superreview+](#c24 "12 years ago") | [Details](/attachment.cgi?id=731338&action=edit) | [Diff](/attachment.cgi?id=731338&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731338) |
| [[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches](/attachment.cgi?id=731339)  [12 years ago](#c11)  [John Schoenick [:johns]](/user_profile?user_id=429621)   5.90 KB, patch |  | [Details](/attachment.cgi?id=731339&action=edit) | [Diff](/attachment.cgi?id=731339&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731339) |
| [[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches](/attachment.cgi?id=731956)  [12 years ago](#c17)  [John Schoenick [:johns]](/user_profile?user_id=429621)   5.96 KB, patch | benjamin : [review+](#c22 "12 years ago") | [Details](/attachment.cgi?id=731956&action=edit) | [Diff](/attachment.cgi?id=731956&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731956) |
| [Only pass canonicalized codebase to Java. r=bsmedberg sr=jst](/attachment.cgi?id=740385)  [12 years ago](#c28)  [John Schoenick [:johns]](/user_profile?user_id=429621)   9.63 KB, patch | johns : [review+](#a34211513_429621 "12 years ago")  johns : [superreview+](#a34211513_429621 "12 years ago")  lsblakk : [approval-mozilla-aurora+](#a40530825_272375 "12 years ago")  lsblakk : [approval-mozilla-beta+](#a40530825_272375 "12 years ago")  lsblakk : [approval-mozilla-esr17+](#a40530825_272375 "12 years ago")  abillings : [sec-approval+](#c43 "12 years ago")  johns : [checkin+](#c46 "12 years ago") | [Details](/attachment.cgi?id=740385&action=edit) | [Diff](/attachment.cgi?id=740385&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=740385) |
| [Add nptest java plugin](/attachment.cgi?id=755508)  [12 years ago](#c31)  [John Schoenick [:johns]](/user_profile?user_id=429621)   13.72 KB, patch | benjamin : [review+](#a37833215_7044 "12 years ago") | [Details](/attachment.cgi?id=755508&action=edit) | [Diff](/attachment.cgi?id=755508&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=755508) |
| [Test](/attachment.cgi?id=755510)  [12 years ago](#c32)  [John Schoenick [:johns]](/user_profile?user_id=429621)   5.36 KB, patch | benjamin : [review+](#c44 "12 years ago") | [Details](/attachment.cgi?id=755510&action=edit) | [Diff](/attachment.cgi?id=755510&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=755510) |
| [Test. r=bsmedberg](/attachment.cgi?id=769872)  [12 years ago](#c48)  [John Schoenick [:johns]](/user_profile?user_id=429621)   5.66 KB, patch | johns : [review+](#a40273395_429621 "12 years ago") | [Details](/attachment.cgi?id=769872&action=edit) | [Diff](/attachment.cgi?id=769872&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=769872) |
| [Test case demonstrating this issue](/attachment.cgi?id=772768)  [12 years ago](#c55)  [John Schoenick [:johns]](/user_profile?user_id=429621)   1.95 KB, application/zip |  | [Details](/attachment.cgi?id=772768&action=edit) |
| [Test. r=bsmedberg](/attachment.cgi?id=8379263)  [11 years ago](#c59)  [John Schoenick [:johns]](/user_profile?user_id=429621)   7.06 KB, patch | johns : [review+](#c59 "11 years ago")  johns : [checkin+](#c60 "11 years ago") | [Details](/attachment.cgi?id=8379263&action=edit) | [Diff](/attachment.cgi?id=8379263&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=8379263) |

Show Obsolete

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=738396#c0)â€¢ 13 years ago |
|  | |

Investigating 736965 which is fallout from a related security issue 406541, I discovered the fixes in 406541 are woefully inadequate. There are numerous ways to invoke java plugins which bypass various security checks. I found at least three different issues in the loading code. All of the below issues apply to 3.6+ and probably older.
The most severe of these is <param> elements can override the <object> tag's codebase as seen by java. That means this will load from a non-file: context
> <applet width=500 height=500 codebase="." code="home.user.some.folder.object.class">
> <param name="codebase" value="file:///">
> </applet>
The security check will assume codebase "." is valid, but java will use the file:/// codebase, allowing read access to the full filesystem. There is no prompt when this applet loads.
For this to be successful, you must know the location of your applet on the user's machine - either through guessing a cache path, tricking the user into downloading it before hand, or possibly using something like flash to create a file with a more deterministic name.
Other issues in this code:
- <object> tags default codebase to the current directory, rather than domain-root, unlike <applet> tags. We need to emulate this quirk to avoid breakage like 736965
- <param> tags appear to be passed as raw html to java, leading to potential disagreements between parsers on malformed HTML.
- Some code checks for application/x-java-vm to trigger java quirks, but it is possible with <embed> to create a an applet with e.g. application/x-java-applet. The code that forces the MIME to x-java-vm only applies to <object> tags.
- nodePrinicpal()->GetURI() is returning NULL on object tags in one situation with <object> tags, causing security checks to be skipped.
- (probably non-issue) according to oracle docs, <applet> should follow HTML4 specs, which state "Values for [codebase] may only refer to subdirectories of the directory containing the current document". This is never enforced (except on file:/// URIs with the patch in 406541), and contradict's java's behavior of defaulting codebase to "/" for <applet>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a513520_1689)â€¢ 13 years ago |

Whiteboard: [sg:high]

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a1832114_429621)â€¢ 13 years ago |

Depends on: [745030](/show_bug.cgi?id=745030 "RESOLVED FIXED - Refactor nsObjectLoadingContent")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a3375353_1689)â€¢ 13 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a8903310_429621)â€¢ 13 years ago |

Blocks: [CVE-2013-1717](/show_bug.cgi?id=406541 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances")No longer depends on: [CVE-2013-1717](/show_bug.cgi?id=406541 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=738396#c1)â€¢ 12 years ago |
|  | |

Probably not reasonable to fix and uplift to Beta (16) at this point, but hopefully we can figure out a fix appropriate for 17.
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected)
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected)
[tracking-firefox16](/buglist.cgi?f1=cf_tracking_firefox16&o1=isnotempty):
--- â†’ [-](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=-)
[tracking-firefox17](/buglist.cgi?f1=cf_tracking_firefox17&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B)
[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B)

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=738396#c2)â€¢ 12 years ago |
|  | |

John, we're a little over a week away from moving 17 to the Beta audience - any work done on this yet and if not can you give an idea of when you'll be working on it?

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=738396#c3)â€¢ 12 years ago |
|  | |

I've been waiting on landing more followups to this code until [bug 783059](/show_bug.cgi?id=783059 "RESOLVED FIXED - object/embed/applet tags need instantiation tests") lands, as it's especially regression-prone (see original landing of [bug 406541](/show_bug.cgi?id=406541 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances")). I will try to have something ready before the uplift.Status: NEW â†’ ASSIGNEDDepends on: [783059](/show_bug.cgi?id=783059 "RESOLVED FIXED - object/embed/applet tags need instantiation tests")

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a16256870_429621)â€¢ 12 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=wontfix)
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=738396#c4)â€¢ 12 years ago |
|  | |

(In reply to John Schoenick [:johns] from [comment #3](/show_bug.cgi?id=738396#c3 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system"))
> I've been waiting on landing more followups to this code until [bug 783059](/show_bug.cgi?id=783059 "RESOLVED FIXED - object/embed/applet tags need instantiation tests")
> lands, as it's especially regression-prone (see original landing of bug
> 406541). I will try to have something ready before the uplift.
Any updates here John? Is there something low risk we can do to resolve this issue in the FF17 timeframe?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=738396#c5)â€¢ 12 years ago |
|  | |

I've emailed John about this.

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=738396#c6)â€¢ 12 years ago |
|  | |

Now that beta 5 has gone to build we're past taking speculative fixes. Wontfixing for 17.
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=wontfix)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a23509383_425645)â€¢ 12 years ago |

[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=wontfix)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=738396#c7)â€¢ 12 years ago |
|  | |

Is this still a current sec-high issue?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=738396#c8)â€¢ 12 years ago |
|  | |

John, what is the current status of this? This is the oldest open DOM sec-high or sec-critical goal. :PFlags: needinfo?(jschoenick)

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a31464455_12352)â€¢ 12 years ago |

Component: Security â†’ Plug-ins

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=738396#c9)â€¢ 12 years ago |
|  | |

Attached patch

[Construct codebase URI for Java plugins as java would](attachment.cgi?id=731337&action=diff)
â€” [Details](attachment.cgi?id=731337&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731337)

Flags: needinfo?(jschoenick)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=738396#c10)â€¢ 12 years ago |
|  | |

Attached patch

[Only pass canonicalized codebase to Java](attachment.cgi?id=731338&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=731338&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731338)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=738396#c11)â€¢ 12 years ago |
|  | |

Attached patch

[[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches](attachment.cgi?id=731339&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=731339&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731339)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=738396#c12)â€¢ 12 years ago |
|  | |

Comment on [attachment 731337](/attachment.cgi?id=731337 "Construct codebase URI for Java plugins as java would") [[details]](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") [[diff]](/attachment.cgi?id=731337&action=diff "Construct codebase URI for Java plugins as java would") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731337)
Construct codebase URI for Java plugins as java would
So this got hairy fast, but I think should be decently-safe in that most of the changes reside within an |if (isJava)| block, so worst-case scenario is we break java...
The problem is multi-fold:
- Java uses "codebase" as a special value for where it is allowed to run, e.g. |file:///|, and assumes the browser will security-check it (despite not parsing it the way any browser would...)
- Java honors the last "codebase" value it sees, either on in tag attributes \*or\* in <param> children
- nsPluginInstanceOwner has a good deal of quirks relating to how it passes parameters and attributes to plugins
- nsObjectLoadingContent just looks at the attribute, not params, and without any of these quirks.
- Java doesn't parse URIs like the rest of the universe. E.g. no-codebase means ".", codebase="" means "/", and codebase="file:" means "file:///"
I opened [Bug 853995](/show_bug.cgi?id=853995 "RESOLVED FIXED - Move plugin parameters array from nsPluginInstanceOwner to content") to move building the parameters we pass to the plugin to content (instead of having nsPluginInstanceOwner poke at the DOM), but that is non-trivial and wouldn't be suitable for branches. Instead, this patch basically copy-pastes a chunk of nsPluginInstanceOwner logic into nsObjectLoadingContent so they can arrive at the same codebase, with a patch for [bug 853995](/show_bug.cgi?id=853995 "RESOLVED FIXED - Move plugin parameters array from nsPluginInstanceOwner to content") in progress to remove the code duplication from trunk.
Another issue is that we now parse the URI differently if we end up with Java, but can look at the URI's file extension in some cases and change plugin type. For example |<embed src="file.class">| will build file.class as a normal URI, before seeing .class and switching to java. I sort-of-elegantly fixed this by having UpdateObjectParameters re-call itself with a aJavaURI parameter at this point to redo the URI building steps with |isJava = true|.
Finally, now that we made a reasonable attempt to build the same mBaseURI that java would use, I added a java-only CheckLoadURIWithPrincipal security check against mBaseURI.
So risk-wise this patch looks scary, but is largely known-good code from nsPluginInstanceOwner, and fallout would likely only affect java plugins.
[Attachment #731337](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") -
Flags: review?(benjamin)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=738396#c13)â€¢ 12 years ago |
|  | |

Comment on [attachment 731338](/attachment.cgi?id=731338 "Only pass canonicalized codebase to Java") [[details]](/attachment.cgi?id=731338&action=edit "Only pass canonicalized codebase to Java") [[diff]](/attachment.cgi?id=731338&action=diff "Only pass canonicalized codebase to Java") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731338)
Only pass canonicalized codebase to Java
This causes nsPluginInstanceOwner to get the parsed-and-canonicalized codebase from nsObjectLoadingContent, and pass only that as a "codebase" value in the case of java plugins.
This guarantees that other, undiscovered quirks in how java determines its codebase would simply result in us overriding the codebase to our interpretation, instead of security-checking a different codebase than java decides to use.
[Attachment #731338](/attachment.cgi?id=731338&action=edit "Only pass canonicalized codebase to Java") -
Flags: review?(benjamin)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=738396#c14)â€¢ 12 years ago |
|  | |

Comment on [attachment 731339](/attachment.cgi?id=731339 "[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches") [[details]](/attachment.cgi?id=731339&action=edit "[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches") [[diff]](/attachment.cgi?id=731339&action=diff "[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731339)
[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches
This would be folded against the canonicalize-codebase patch for branches only -- it moves the GetBaseURI() function to nsObjectLoadingContent.h and uses a nasty static-cast to get at it to avoid changing the nsIObjectLoadingContent IID on release branches.
[Attachment #731339](/attachment.cgi?id=731339&action=edit "[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches") -
Flags: review?(benjamin)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=738396#c15)â€¢ 12 years ago |
|  | |

This was previously tracked (and not fixed...), re-noming now that we have patches.
[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
--- â†’ [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected)
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected)
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected)
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%3F)
[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%3F)
[tracking-firefox22](/buglist.cgi?f1=cf_tracking_firefox22&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%3F)
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=%3F)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=738396#c16)â€¢ 12 years ago |
|  | |

Too late for 20 at this point.
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=wontfix)
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%3F) â†’ ---

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=738396#c17)â€¢ 12 years ago |
|  | |

Attached patch

[[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches](attachment.cgi?id=731956&action=diff)
â€” [Details](attachment.cgi?id=731956&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731956)

Inadvertently attached old version of this patch that doesn't compile...
[Attachment #731339](/attachment.cgi?id=731339&action=edit "[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches") -
Attachment is obsolete: true
[Attachment #731339](/attachment.cgi?id=731339&action=edit "[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches") -
Flags: review?(benjamin)
[Attachment #731956](/attachment.cgi?id=731956&action=edit "[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches") -
Flags: review?(benjamin)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=738396#c18)â€¢ 12 years ago |
|  | |

We'll track for the ESR once this is resolved. Since this is a sec-high and appears to carry some plugin risk, we'll want to land ASAP on branches and follow up with QA regression testing. Any guidance there would be very helpful.
If this isn't ready to land in time for our second or third beta, we should strongly consider sec-approving next cycle instead.
[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%3F) â†’ [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B)
[tracking-firefox22](/buglist.cgi?f1=cf_tracking_firefox22&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%3F) â†’ [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B)
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=%3F) â†’ ---Keywords: [qawanted](/buglist.cgi?keywords=qawanted&resolution=---),
[verifyme](/buglist.cgi?keywords=verifyme&resolution=---)QA Contact: mwobensmith

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=738396#c19)â€¢ 12 years ago |
|  | |

QA is ready to test when this gets landed. Basic concept is well-understood. Let me know if there are any other similar things to look for (param element vs object params, other types of paths, etc.).

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=738396#c20)â€¢ 12 years ago |
|  | |

Comment on [attachment 731337](/attachment.cgi?id=731337 "Construct codebase URI for Java plugins as java would") [[details]](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") [[diff]](/attachment.cgi?id=731337&action=diff "Construct codebase URI for Java plugins as java would") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731337)
Construct codebase URI for Java plugins as java would
I'd like a second review on these patches; tagging jst though he might redirect.
[Attachment #731337](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") -
Flags: superreview?(jst)
[Attachment #731337](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") -
Flags: review?(benjamin)
[Attachment #731337](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") -
Flags: review+

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=738396#c21)â€¢ 12 years ago |
|  | |

Comment on [attachment 731338](/attachment.cgi?id=731338 "Only pass canonicalized codebase to Java") [[details]](/attachment.cgi?id=731338&action=edit "Only pass canonicalized codebase to Java") [[diff]](/attachment.cgi?id=731338&action=diff "Only pass canonicalized codebase to Java") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731338)
Only pass canonicalized codebase to Java
How do we test this?
[Attachment #731338](/attachment.cgi?id=731338&action=edit "Only pass canonicalized codebase to Java") -
Flags: superreview?(jst)
[Attachment #731338](/attachment.cgi?id=731338&action=edit "Only pass canonicalized codebase to Java") -
Flags: review?(benjamin)
[Attachment #731338](/attachment.cgi?id=731338&action=edit "Only pass canonicalized codebase to Java") -
Flags: review+

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=738396#c22)â€¢ 12 years ago |
|  | |

Comment on [attachment 731956](/attachment.cgi?id=731956 "[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches") [[details]](/attachment.cgi?id=731956&action=edit "[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches") [[diff]](/attachment.cgi?id=731956&action=diff "[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731956)
[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches
Kinda hacky, but I think we're safe here since web content can't spoof nsIObjectLoadingContent.
[Attachment #731956](/attachment.cgi?id=731956&action=edit "[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches") -
Flags: review?(benjamin) â†’ review+

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=738396#c23)â€¢ 12 years ago |
|  | |

Comment on [attachment 731337](/attachment.cgi?id=731337 "Construct codebase URI for Java plugins as java would") [[details]](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") [[diff]](/attachment.cgi?id=731337&action=diff "Construct codebase URI for Java plugins as java would") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731337)
Construct codebase URI for Java plugins as java would
- In nsObjectLoadingContent::UpdateObjectParameters():
+ mydomElement->GetElementsByTagNameNS(xhtml\_ns, NS\_LITERAL\_STRING("param"),
+ getter\_AddRefs(allParams));
+ if (allParams) {
+ uint32\_t numAllParams;
+ allParams->GetLength(&numAllParams);
+ for (uint32\_t i = 0; i < numAllParams; i++) {
+ nsCOMPtr<nsIDOMNode> pnode;
+ allParams->Item(i, getter\_AddRefs(pnode));
+ nsCOMPtr<nsIDOMElement> domelement = do\_QueryInterface(pnode);
+ if (domelement) {
+ nsAutoString name;
+ domelement->GetAttribute(NS\_LITERAL\_STRING("name"), name);
+ name.Trim(" \n\r\t\b", true, true, false);
+ if (name.EqualsIgnoreCase("codebase")) {
+ // Find the first plugin element parent
+ nsCOMPtr<nsIDOMNode> parent;
+ nsCOMPtr<nsIDOMHTMLObjectElement> domobject;
+ nsCOMPtr<nsIDOMHTMLAppletElement> domapplet;
+ pnode->GetParentNode(getter\_AddRefs(parent));
+ while (!(domobject || domapplet) && parent) {
+ domobject = do\_QueryInterface(parent);
+ domapplet = do\_QueryInterface(parent);
+ nsCOMPtr<nsIDOMNode> temp;
+ parent->GetParentNode(getter\_AddRefs(temp));
+ parent = temp;
+ }
You could do all this with far less reference counting and QI calls if you used NS\_GetContentList() and the internal interfaces, but I'm not convinced it's worth rewriting this for that alone.
+ codebaseStr.AssignLiteral("/");
+ // XXX(johns): This doesn't cover the case of "https:" which java would
+ // interpret as "<https:///>" but weinterpret as this document's
Insert the missing space in weinterpret.
sr=jst
[Attachment #731337](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") -
Flags: superreview?(jst) â†’ superreview+

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=738396#c24)â€¢ 12 years ago |
|  | |

Comment on [attachment 731338](/attachment.cgi?id=731338 "Only pass canonicalized codebase to Java") [[details]](/attachment.cgi?id=731338&action=edit "Only pass canonicalized codebase to Java") [[diff]](/attachment.cgi?id=731338&action=diff "Only pass canonicalized codebase to Java") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731338)
Only pass canonicalized codebase to Java
- In nsPluginInstanceOwner::EnsureCachedAttrParamArrays():
+ // (Bug XXXXXX FIXME) java has quirks in its codebase parsing, pass the
+ // absolute codebase URI as content sees it.
Replace XXXXXX with a bug number there?
+ mCachedAttrParamNames [nextAttrParamIndex] = ToNewUTF8String(NS\_LITERAL\_STRING("codebase"));
+ mCachedAttrParamValues[nextAttrParamIndex] = ToNewUTF8String(NS\_ConvertUTF8toUTF16(codebaseStr));
Wow, that's a pretty wonky string copy pattern we've got going here. Maybe file a followup bug to replace the above patterns with strdup() in this whole file?
sr=jst
[Attachment #731338](/attachment.cgi?id=731338&action=edit "Only pass canonicalized codebase to Java") -
Flags: superreview?(jst) â†’ superreview+

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=738396#c25)â€¢ 12 years ago |
|  | |

(In reply to Johnny Stenback (:jst, jst@mozilla.com) from [comment #23](/show_bug.cgi?id=738396#c23 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system"))
> You could do all this with far less reference counting and QI calls if you
> used NS\_GetContentList() and the internal interfaces, but I'm not convinced
> it's worth rewriting this for that alone.
(In reply to Johnny Stenback (:jst, jst@mozilla.com) from [comment #24](/show_bug.cgi?id=738396#c24 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system"))
> Wow, that's a pretty wonky string copy pattern we've got going here. Maybe
> file a followup bug to replace the above patterns with strdup() in this
> whole file?
This is all just copy-pasted nsPluginInstanceOwner code -- I opened [bug 853995](/show_bug.cgi?id=853995 "RESOLVED FIXED - Move plugin parameters array from nsPluginInstanceOwner to content") to clean this up and de-duplicate it.

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=738396#c26)â€¢ 12 years ago |
|  | |

(In reply to John Schoenick [:johns] from [comment #25](/show_bug.cgi?id=738396#c25 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system"))
> (In reply to Johnny Stenback (:jst, jst@mozilla.com) from [comment #23](/show_bug.cgi?id=738396#c23 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system"))
> > You could do all this with far less reference counting and QI calls if you
> > used NS\_GetContentList() and the internal interfaces, but I'm not convinced
> > it's worth rewriting this for that alone.
>
> (In reply to Johnny Stenback (:jst, jst@mozilla.com) from [comment #24](/show_bug.cgi?id=738396#c24 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system"))
> > Wow, that's a pretty wonky string copy pattern we've got going here. Maybe
> > file a followup bug to replace the above patterns with strdup() in this
> > whole file?
>
> This is all just copy-pasted nsPluginInstanceOwner code -- I opened bug
> 853995 to clean this up and de-duplicate it.
Yup, didn't mean to suggest that this was your doing, it's all over this file from way long ago (and you did the right thing in following the existing coding patterns here)! Thanks for filing the followup!

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=738396#c27)â€¢ 12 years ago |
|  | |

Dropping qawanted but leaving verifyme. Matt is assigned to verify this once it lands.Keywords: [qawanted](/buglist.cgi?keywords=qawanted&resolution=---)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=738396#c28)â€¢ 12 years ago |
|  | |

Attached patch

[Only pass canonicalized codebase to Java. r=bsmedberg sr=jst](attachment.cgi?id=740385&action=diff)
â€” [Details](attachment.cgi?id=740385&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=740385)

Fix possible off-by-one, carrying over r
[Attachment #731338](/attachment.cgi?id=731338&action=edit "Only pass canonicalized codebase to Java") -
Attachment is obsolete: true

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a34211513_429621)â€¢ 12 years ago |

[Attachment #740385](/attachment.cgi?id=740385&action=edit "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") -
Flags: superreview+
[Attachment #740385](/attachment.cgi?id=740385&action=edit "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") -
Flags: review+

|  | [bhavana bajaj [:bajaj]](/user_profile?user_id=448925) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=738396#c29)â€¢ 12 years ago |
|  | |

Given [https://bugzilla.mozilla.org/show\_bug.cgi?id=738396#c18](/show_bug.cgi?id=738396#c18 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system") and considering we are just two beta's away for Fx21 wontfixng this for fx21 . This will be a better fit for next cycle .
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=wontfix)

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=738396#c30)â€¢ 12 years ago |
|  | |

Hello all - any movement here?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a36733124_406194)â€¢ 12 years ago |

Flags: needinfo?(jschoenick)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=738396#c31)â€¢ 12 years ago |
|  | |

Attached patch

[Add nptest java plugin](attachment.cgi?id=755508&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=755508&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=755508)

Flags: needinfo?(jschoenick)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=738396#c32)â€¢ 12 years ago |
|  | |

Attached patch

[Test](attachment.cgi?id=755510&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=755510&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=755510)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=738396#c33)â€¢ 12 years ago |
|  | |

Comment on [attachment 755508](/attachment.cgi?id=755508 "Add nptest java plugin") [[details]](/attachment.cgi?id=755508&action=edit "Add nptest java plugin") [[diff]](/attachment.cgi?id=755508&action=diff "Add nptest java plugin") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=755508)
Add nptest java plugin
Adds another target for nptest that claims x-java-test, and adds a getJavaCodebase function, so we can test that we're passing the intended codebase to java tags.
[Attachment #755508](/attachment.cgi?id=755508&action=edit "Add nptest java plugin") -
Flags: review?(benjamin)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=738396#c34)â€¢ 12 years ago |
|  | |

Comment on [attachment 755510](/attachment.cgi?id=755510 "Test") [[details]](/attachment.cgi?id=755510&action=edit "Test") [[diff]](/attachment.cgi?id=755510&action=diff "Test") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=755510)
Test
Uses the new java test plugin target to ensure we see the expected codebase in various situations.
[Attachment #755510](/attachment.cgi?id=755510&action=edit "Test") -
Flags: review?(benjamin)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=738396#c35)â€¢ 12 years ago |
|  | |

Comment on [attachment 731337](/attachment.cgi?id=731337 "Construct codebase URI for Java plugins as java would") [[details]](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") [[diff]](/attachment.cgi?id=731337&action=diff "Construct codebase URI for Java plugins as java would") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731337)
Construct codebase URI for Java plugins as java would
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Pretty clearly reveals we are mis-handling java codebase, if the linked bug is also a restricted bug, this would quickly give someone the information they need to figure out the issue.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
The code is pretty clear that we didn't audit java's codebase previously.
Which older supported branches are affected by this flaw?
All current branches. Irrelevant to b2g as we don't support plugins there.
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
Yes. Some of the riskier changes are replaced with simplier workarounds for branches only (the foldme patches)
How likely is this patch to cause regressions; how much testing does it need?
Low-to-moderate chance of introducing regressions, which would likely only affect certain configurations of java embedding.
[Attachment #731337](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") -
Flags: sec-approval?

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=738396#c36)â€¢ 12 years ago |
|  | |

Comment on [attachment 740385](/attachment.cgi?id=740385 "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") [[details]](/attachment.cgi?id=740385&action=edit "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") [[diff]](/attachment.cgi?id=740385&action=diff "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=740385)
Only pass canonicalized codebase to Java. r=bsmedberg sr=jst
[Security approval request comment]
(See above)
[Attachment #740385](/attachment.cgi?id=740385&action=edit "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") -
Flags: sec-approval?

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=738396#c37)â€¢ 12 years ago |
|  | |

Comment on [attachment 731956](/attachment.cgi?id=731956 "[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches") [[details]](/attachment.cgi?id=731956&action=edit "[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches") [[diff]](/attachment.cgi?id=731956&action=diff "[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731956)
[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches
[Security approval request comment]
See above. This just avoids changing the nsIObjectLoadingContent IID on branches.
[Attachment #731956](/attachment.cgi?id=731956&action=edit "[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches") -
Flags: sec-approval?

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a37418277_429621)â€¢ 12 years ago |

[status-firefox23](/buglist.cgi?f1=cf_status_firefox23&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=affected)
[status-firefox24](/buglist.cgi?f1=cf_status_firefox24&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=affected)
[tracking-firefox23](/buglist.cgi?f1=cf_tracking_firefox23&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox23&o1=equals&v1=%3F)
[tracking-firefox24](/buglist.cgi?f1=cf_tracking_firefox24&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox24&o1=equals&v1=%3F)
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=%3F)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=738396#c38)â€¢ 12 years ago |
|  | |

(In reply to John Schoenick [:johns] from [comment #35](/show_bug.cgi?id=738396#c35 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system"))
> Do comments in the patch, the check-in comment, or tests included in the
> patch paint a bulls-eye on the security problem?
> The code is pretty clear that we didn't audit java's codebase previously.
>
> How likely is this patch to cause regressions; how much testing does it need?
> Low-to-moderate chance of introducing regressions, which would likely only
> affect certain configurations of java embedding.
Give this, I think we should be cautious and fix for the first time in 23/24/25 and the corresponding ESR, to get a full 6 weeks of testing before release.
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=wontfix)
[tracking-firefox23](/buglist.cgi?f1=cf_tracking_firefox23&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox23&o1=equals&v1=%3F) â†’ [+](/buglist.cgi?f1=cf_tracking_firefox23&o1=equals&v1=%2B)
[tracking-firefox24](/buglist.cgi?f1=cf_tracking_firefox24&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox24&o1=equals&v1=%3F) â†’ [+](/buglist.cgi?f1=cf_tracking_firefox24&o1=equals&v1=%2B)
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=%3F) â†’ [23+](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=23%2B)Whiteboard: [sg:high] â†’ [sg:high][land once m-c is FF25]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=738396#c39)â€¢ 12 years ago |
|  | |

The problem is
> [Security approval request comment]
> How easily could an exploit be constructed based on the patch?
> Pretty clearly reveals we are mis-handling java codebase, if the linked bug
> is also a restricted bug, this would quickly give someone the information
> they need to figure out the issue.
>
> Do comments in the patch, the check-in comment, or tests included in the
> patch paint a bulls-eye on the security problem?
> The code is pretty clear that we didn't audit java's codebase previously.
This means that once we check in, we're going to be pretty exposed for the whole six week cycle.

|  | [:Gavin Sharp [email: gavin@gavinsharp.com]](/user_profile?user_id=103593) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=738396#c40)â€¢ 12 years ago |
|  | |

Given this bug's potential impact (this is less severe than remote code execution, and isn't necessarily easy to exploit), I think favoring extra bake time over reduced trunk exposure seems reasonable.

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=738396#c41)â€¢ 12 years ago |
|  | |

There is also [bug 406541](/show_bug.cgi?id=406541 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances"), which is a much less severe bug that depends on the changes here to fix. We could open a public version of that bug, then land these changes folded with 406541 as a "cleanup java codebase handling" patch. Without a locked bug to bring attention to it and the valid-premise for cleaning up this code, it's less obvious that there's a more severe issue to be found.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=738396#c42)â€¢ 12 years ago |
|  | |

Comment on [attachment 731337](/attachment.cgi?id=731337 "Construct codebase URI for Java plugins as java would") [[details]](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") [[diff]](/attachment.cgi?id=731337&action=diff "Construct codebase URI for Java plugins as java would") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731337)
Construct codebase URI for Java plugins as java would
Approving for trunk AFTER trunk becomes Firefox 25 on 6/24 or 25.
[Attachment #731337](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") -
Flags: sec-approval? â†’ sec-approval+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=738396#c43)â€¢ 12 years ago |
|  | |

Comment on [attachment 740385](/attachment.cgi?id=740385 "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") [[details]](/attachment.cgi?id=740385&action=edit "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") [[diff]](/attachment.cgi?id=740385&action=diff "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=740385)
Only pass canonicalized codebase to Java. r=bsmedberg sr=jst
Approving for trunk AFTER trunk becomes Firefox 25 on 6/24 or 25.
[Attachment #740385](/attachment.cgi?id=740385&action=edit "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") -
Flags: sec-approval? â†’ sec-approval+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a37602483_280903)â€¢ 12 years ago |

Whiteboard: [sg:high][land once m-c is FF25] â†’ [sg:high][checkin after 6/25]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a37602717_280903)â€¢ 12 years ago |

[Attachment #731956](/attachment.cgi?id=731956&action=edit "[Branches only, foldme] Avoid changing nsIObjectLoadingContent IID on branches") -
Flags: sec-approval?

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a37833215_7044)â€¢ 12 years ago |

[Attachment #755508](/attachment.cgi?id=755508&action=edit "Add nptest java plugin") -
Flags: review?(benjamin) â†’ review+

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=738396#c44)â€¢ 12 years ago |
|  | |

Comment on [attachment 755510](/attachment.cgi?id=755510 "Test") [[details]](/attachment.cgi?id=755510&action=edit "Test") [[diff]](/attachment.cgi?id=755510&action=diff "Test") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=755510)
Test
The printf in nptest.cpp seems like a testing leftover? r=me with that gone
[Attachment #755510](/attachment.cgi?id=755510&action=edit "Test") -
Flags: review?(benjamin) â†’ review+

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=738396#c45)â€¢ 12 years ago |
|  | |

Comment on [attachment 731337](/attachment.cgi?id=731337 "Construct codebase URI for Java plugins as java would") [[details]](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") [[diff]](/attachment.cgi?id=731337&action=diff "Construct codebase URI for Java plugins as java would") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731337)
Construct codebase URI for Java plugins as java would
<https://hg.mozilla.org/integration/mozilla-inbound/rev/de553526d1f8>
[Attachment #731337](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") -
Flags: checkin+

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=738396#c46)â€¢ 12 years ago |
|  | |

Comment on [attachment 740385](/attachment.cgi?id=740385 "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") [[details]](/attachment.cgi?id=740385&action=edit "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") [[diff]](/attachment.cgi?id=740385&action=diff "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=740385)
Only pass canonicalized codebase to Java. r=bsmedberg sr=jst
<https://hg.mozilla.org/integration/mozilla-inbound/rev/5d38d2a6e4c1>
[Attachment #740385](/attachment.cgi?id=740385&action=edit "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") -
Flags: checkin+

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=738396#c47)â€¢ 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/de553526d1f8>
<https://hg.mozilla.org/mozilla-central/rev/5d38d2a6e4c1>Status: ASSIGNED â†’ RESOLVEDClosed: 12 years agoResolution: --- â†’ FIXEDTarget Milestone: --- â†’ mozilla25

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a40266600_429621)â€¢ 12 years ago |

Depends on: [888834](/show_bug.cgi?id=888834 "VERIFIED FIXED - Java won't load Runescape applet in Firefox Nightly 25.0a1(6-30), works in other browsers")

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=738396#c48)â€¢ 12 years ago |
|  | |

Attached patch

[Test. r=bsmedberg](attachment.cgi?id=769872&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=769872&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=769872)

Folds in a few more cases for the regression in [bug 888834](/show_bug.cgi?id=888834 "VERIFIED FIXED - Java won't load Runescape applet in Firefox Nightly 25.0a1(6-30), works in other browsers"), carrying over r+
[Attachment #755510](/attachment.cgi?id=755510&action=edit "Test") -
Attachment is obsolete: true

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a40273395_429621)â€¢ 12 years ago |

[Attachment #769872](/attachment.cgi?id=769872&action=edit "Test. r=bsmedberg") -
Flags: review+

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a40365119_429621)â€¢ 12 years ago |

Flags: in-testsuite?Whiteboard: [sg:high][checkin after 6/25] â†’ [sg:high]

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=738396#c49)â€¢ 12 years ago |
|  | |

Comment on [attachment 731337](/attachment.cgi?id=731337 "Construct codebase URI for Java plugins as java would") [[details]](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") [[diff]](/attachment.cgi?id=731337&action=diff "Construct codebase URI for Java plugins as java would") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731337)
Construct codebase URI for Java plugins as java would
[Approval Request Comment]
Bug caused by (feature/regressing bug #):
Technically a java bug: It assumes the browser will security-check its plugin-specific parameters, but we do not.
User impact if declined:
sec-high. Potential for untrusted java applets to get read-only access to the user's filesystem if used in conjunction with some method to download a file to a guessable path.
Testing completed (on m-c, etc.):
Has test case, on m-c. One minor regression found in [bug 888834](/show_bug.cgi?id=888834 "VERIFIED FIXED - Java won't load Runescape applet in Firefox Nightly 25.0a1(6-30), works in other browsers"), which is now fixed and would be folded into the uplift patch.
Risk to taking this patch (and alternatives if risky):
In relation to java, there is a moderate regression risk. Java does not construct its "codebase" attribute in a very sane fashion, mis-constructing URLs and assuming |codebase=""| means |codebase="/"| among other things. Because we now force agreement on the codebase parameter, any quirks in java we did not emulate properly would break some java applets (e.g. [bug 888834](/show_bug.cgi?id=888834 "VERIFIED FIXED - Java won't load Runescape applet in Firefox Nightly 25.0a1(6-30), works in other browsers")). These would be trivial fixes, if found.
Outside of embedded java, the risk is low, as all new code only applies to Java.
String or IDL/UUID changes made by this patch:
None
[Attachment #731337](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") -
Flags: approval-mozilla-esr17?
[Attachment #731337](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") -
Flags: approval-mozilla-beta?
[Attachment #731337](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") -
Flags: approval-mozilla-aurora?

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=738396#c50)â€¢ 12 years ago |
|  | |

Comment on [attachment 740385](/attachment.cgi?id=740385 "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") [[details]](/attachment.cgi?id=740385&action=edit "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") [[diff]](/attachment.cgi?id=740385&action=diff "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=740385)
Only pass canonicalized codebase to Java. r=bsmedberg sr=jst
(see [comment 49](/show_bug.cgi?id=738396#c49 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system"))
[Attachment #740385](/attachment.cgi?id=740385&action=edit "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") -
Flags: approval-mozilla-esr17?
[Attachment #740385](/attachment.cgi?id=740385&action=edit "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") -
Flags: approval-mozilla-beta?
[Attachment #740385](/attachment.cgi?id=740385&action=edit "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") -
Flags: approval-mozilla-aurora?

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=738396#c51)â€¢ 12 years ago |
|  | |

Comment on [attachment 731337](/attachment.cgi?id=731337 "Construct codebase URI for Java plugins as java would") [[details]](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") [[diff]](/attachment.cgi?id=731337&action=diff "Construct codebase URI for Java plugins as java would") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=731337)
Construct codebase URI for Java plugins as java would
after 6/25 so let's uplift.
[Attachment #731337](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") -
Flags: approval-mozilla-esr17?
[Attachment #731337](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") -
Flags: approval-mozilla-esr17+
[Attachment #731337](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") -
Flags: approval-mozilla-beta?
[Attachment #731337](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") -
Flags: approval-mozilla-beta+
[Attachment #731337](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") -
Flags: approval-mozilla-aurora?
[Attachment #731337](/attachment.cgi?id=731337&action=edit "Construct codebase URI for Java plugins as java would") -
Flags: approval-mozilla-aurora+

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a40530825_272375)â€¢ 12 years ago |

[Attachment #740385](/attachment.cgi?id=740385&action=edit "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") -
Flags: approval-mozilla-esr17?
[Attachment #740385](/attachment.cgi?id=740385&action=edit "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") -
Flags: approval-mozilla-esr17+
[Attachment #740385](/attachment.cgi?id=740385&action=edit "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") -
Flags: approval-mozilla-beta?
[Attachment #740385](/attachment.cgi?id=740385&action=edit "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") -
Flags: approval-mozilla-beta+
[Attachment #740385](/attachment.cgi?id=740385&action=edit "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") -
Flags: approval-mozilla-aurora?
[Attachment #740385](/attachment.cgi?id=740385&action=edit "Only pass canonicalized codebase to Java. r=bsmedberg sr=jst") -
Flags: approval-mozilla-aurora+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=738396#c52)â€¢ 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/819cefc60ade>
<https://hg.mozilla.org/releases/mozilla-aurora/rev/20a1cd5be4fb>
There are some conflicts in nsObjectLoadingContent.cpp on esr17 that will need resolving. Also, this requires binary approval to land on beta due to the changes to nsIObjectLoadingContent.idl ([comment 49](/show_bug.cgi?id=738396#c49 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system") said no IDL changes?!?!).
[status-b2g-v1.1hd](/buglist.cgi?f1=cf_status_b2g_1_1_hd&o1=isnotempty):
--- â†’ [unaffected](/buglist.cgi?f1=cf_status_b2g_1_1_hd&o1=equals&v1=unaffected)
[status-firefox24](/buglist.cgi?f1=cf_status_firefox24&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=fixed)
[status-firefox25](/buglist.cgi?f1=cf_status_firefox25&o1=isnotempty):
--- â†’ [fixed](/buglist.cgi?f1=cf_status_firefox25&o1=equals&v1=fixed)Flags: needinfo?(jschoenick)Keywords: [branch-patch-needed](/buglist.cgi?keywords=branch-patch-needed&resolution=---)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=738396#c53)â€¢ 12 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM UTC-4] from [comment #52](/show_bug.cgi?id=738396#c52 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system"))
> Also, this requires binary approval to land on beta due to
> the changes to nsIObjectLoadingContent.idl ([comment 49](/show_bug.cgi?id=738396#c49 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system") said no IDL
> changes?!?!).
This is why the |Avoid changing IID on branches| patch exists. I should've clarified in the whiteboard, apologies.
<https://hg.mozilla.org/releases/mozilla-beta/rev/24df0a207416>
<https://hg.mozilla.org/releases/mozilla-beta/rev/10544c91e1d6>
[status-firefox23](/buglist.cgi?f1=cf_status_firefox23&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=fixed)Flags: needinfo?(jschoenick)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=738396#c54)â€¢ 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-esr17/rev/331fa2b73ddf>
<https://hg.mozilla.org/releases/mozilla-esr17/rev/6e57263710ec>
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=fixed)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=738396#c55)â€¢ 12 years ago |
|  | |

Attached file
[Test case demonstrating this issue](attachment.cgi?id=772768)
â€” [Details](attachment.cgi?id=772768&action=edit)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a40959242_75935)â€¢ 12 years ago |

Keywords: [branch-patch-needed](/buglist.cgi?keywords=branch-patch-needed&resolution=---)

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=738396#c56)â€¢ 12 years ago |
|  | |

QA has completed an extensive pass on this bug and signs off.
Confirmed original path loading exploit on OpenJDK6, Linux, FF22.
Verified fixed in FF25 m-c, 2013-07-08.
Verified fixed in FF24, 2013-07-10.
Verified fixed in FF23, 2013-07-10.
Verified fixed in FF17esr, 2013-07-10.
Verified that:
- Bad paths prevent JRE from loading applet at all, or
- Bad paths cause applet not to display, with error from JRE (security error or class not found).
- Normal use cases for applet loading - via object, embed and applet tags - work correctly.
- Other test cases for applet loading - nested tags, redirects, site vs root relative URLs, edge cases - work correctly.
JDKs used:
OpenJDK6u45/Ubuntu 13.0.4
OpenJDK7u21/Ubuntu 13.0.4
Oracle JDK 7u21/Ubuntu 13.0.4
Oracle JDK 7u25/Ubuntu 13.0.4
Oracle JDK 7u21/Mac OSX 10.8
Oracle JDK 7u25/Mac OSX 10.8Status: RESOLVED â†’ VERIFIED
[status-firefox23](/buglist.cgi?f1=cf_status_firefox23&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=verified)
[status-firefox24](/buglist.cgi?f1=cf_status_firefox24&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=verified)
[status-firefox25](/buglist.cgi?f1=cf_status_firefox25&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox25&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox25&o1=equals&v1=verified)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=fixed) â†’ [verified](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=verified)Keywords: [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a42675114_280903)â€¢ 11 years ago |

Whiteboard: [sg:high] â†’ [sg:high][adv-main23+][adv-esr1708+]

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=738396#c58)â€¢ 11 years ago |
|  | |

The blog post linked in [bug 964055](/show_bug.cgi?id=964055 "RESOLVED DUPLICATE - vulnerability") doesn't talk about Java plugins at all.

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=738396#c59)â€¢ 11 years ago |
|  | |

Attached patch

[Test. r=bsmedberg](attachment.cgi?id=8379263&action=diff)
â€” [Details](attachment.cgi?id=8379263&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=8379263)

Un-bitrotted, rebased on java test plugin which was split out and added in [bug 971279](/show_bug.cgi?id=971279 "RESOLVED FIXED - Add Java Test Plugin")
[Attachment #755508](/attachment.cgi?id=755508&action=edit "Add nptest java plugin") -
Attachment is obsolete: true
[Attachment #769872](/attachment.cgi?id=769872&action=edit "Test. r=bsmedberg") -
Attachment is obsolete: true
[Attachment #8379263](/attachment.cgi?id=8379263&action=edit "Test. r=bsmedberg") -
Flags: review+

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=738396#c60)â€¢ 11 years ago |
|  | |

Comment on [attachment 8379263](/attachment.cgi?id=8379263 "Test. r=bsmedberg") [[details]](/attachment.cgi?id=8379263&action=edit "Test. r=bsmedberg") [[diff]](/attachment.cgi?id=8379263&action=diff "Test. r=bsmedberg") [[review]](/page.cgi?id=splinter.html&ignore=&bug=738396&attachment=8379263)
Test. r=bsmedberg
Pushed test:
<https://hg.mozilla.org/integration/mozilla-inbound/rev/b24d1437c6f3>
Try:
<https://tbpl.mozilla.org/?tree=Try&rev=fd55a944e195>
[Attachment #8379263](/attachment.cgi?id=8379263&action=edit "Test. r=bsmedberg") -
Flags: checkin+

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=738396#c61)â€¢ 11 years ago |
|  | |

I backed this (and everything else from that push to inbound) out in <http://hg.mozilla.org/integration/mozilla-inbound/rev/128cbf1edc40> due to various Java/plugin related failures they caused:
Crashtest failure: <https://tbpl.mozilla.org/php/getParsedLog.php?id=35003251&tree=Mozilla-Inbound>
XPCShell failure: <https://tbpl.mozilla.org/php/getParsedLog.php?id=35003355&tree=Mozilla-Inbound>

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a60498739_308534)â€¢ 11 years ago |

Flags: needinfo?(jschoenick)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=738396#c62)â€¢ 11 years ago |
|  | |

(In reply to Wes Kocher (:KWierso) from [comment #61](/show_bug.cgi?id=738396#c61 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system"))
> I backed this (and everything else from that push to inbound) out in
> <http://hg.mozilla.org/integration/mozilla-inbound/rev/128cbf1edc40> due to
> various Java/plugin related failures they caused:
> Crashtest failure:
> <https://tbpl.mozilla.org/php/getParsedLog.php?id=35003251&tree=Mozilla>-
> Inbound
> XPCShell failure:
> <https://tbpl.mozilla.org/php/getParsedLog.php?id=35003355&tree=Mozilla>-
> Inbound
Attempt 2 to push test:
<https://hg.mozilla.org/integration/mozilla-inbound/rev/19a4abd04dce>
Extensive try run since this push burned the tree before:
<https://tbpl.mozilla.org/?tree=Try&rev=b656bdd77ce1>Flags: needinfo?(jschoenick)

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=738396#c63)â€¢ 11 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/19a4abd04dce>
[status-firefox27](/buglist.cgi?f1=cf_status_firefox27&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_status_firefox27&o1=equals&v1=%3F)
[status-firefox28](/buglist.cgi?f1=cf_status_firefox28&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_status_firefox28&o1=equals&v1=%3F)
[status-firefox29](/buglist.cgi?f1=cf_status_firefox29&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_status_firefox29&o1=equals&v1=%3F)
[status-firefox30](/buglist.cgi?f1=cf_status_firefox30&o1=isnotempty):
--- â†’ [fixed](/buglist.cgi?f1=cf_status_firefox30&o1=equals&v1=fixed)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=738396#c64)â€¢ 11 years ago |
|  | |

This was fixed in 25, the additional landing here only applies to the mochitest
[status-firefox27](/buglist.cgi?f1=cf_status_firefox27&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox27&o1=equals&v1=%3F) â†’ ---
[status-firefox28](/buglist.cgi?f1=cf_status_firefox28&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox28&o1=equals&v1=%3F) â†’ ---
[status-firefox29](/buglist.cgi?f1=cf_status_firefox29&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox29&o1=equals&v1=%3F) â†’ ---
[status-firefox30](/buglist.cgi?f1=cf_status_firefox30&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox30&o1=equals&v1=fixed) â†’ ---Flags: in-testsuite? â†’ in-testsuite+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a84012662_1689)â€¢ 10 years ago |

Group: core-security

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=738396#a320287134_546015)â€¢ 3 years ago |

Product: Core â†’ Core Graveyard
You need to [log in](/show_bug.cgi?id=738396&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [John Schoenick [:johns]](/user_profile?user_id=429621)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_04480c11_20250126_010148.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")â€Ž | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_0efcbc70_20250126_010143.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/406541)
* [XML](/show_bug.cgi?ctype=xml&id=406541)

Closed
[Bug 406541](/show_bug.cgi?id=406541)
(CVE-2013-1717)

Opened 17 years ago
Closed 12 years ago

# local java applet may read arbitrary files under certain circumstances

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

local java applet may read arbitrary files under certain circumstances

## Categories

### (Core Graveyard :: Plug-ins, defect)

[Product:](/describecomponents.cgi?product=Core%20Graveyard)

Core Graveyard
â–¾

Core Graveyard
Old, retired Core components
[See Open Bugs in This Product](/buglist.cgi?product=Core%20Graveyard&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core%20Graveyard)
Watch This Product

[Component:](/describecomponents.cgi?product=Core%20Graveyard&component=Plug-ins#Plug-ins)

Plug-ins
â–¾

Core Graveyard :: Plug-ins
Bugs in core Mozilla code that supports registering and using plug-ins. For bugs in specific plugins, please file those bugs under External Software Affecting Firefox.
[See Open Bugs in This Component](/buglist.cgi?product=Core%20Graveyard&component=Plug-ins&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core%20Graveyard&component=Plug-ins&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core%20Graveyard&component=Plug-ins)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

## Tracking

### (firefox20 wontfix, firefox21 wontfix, firefox22+ wontfix, firefox23+ fixed, firefox24+ fixed, firefox25 fixed, firefox-esr17- wontfix, b2g18 unaffected, b2g-v1.1hd unaffected)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla25

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox20 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=wontfix) |
| firefox21 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=wontfix) |
| firefox22 | [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=wontfix) |
| firefox23 | [+](/buglist.cgi?f1=cf_tracking_firefox23&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=fixed) |
| firefox24 | [+](/buglist.cgi?f1=cf_tracking_firefox24&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=fixed) |
| firefox25 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox25&o1=equals&v1=fixed) |
| firefox-esr17 | [-](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=wontfix) |
| b2g18 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected) |
| b2g-v1.1hd | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g_1_1_hd&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox20 |  | wontfix |
| firefox21 |  | wontfix |
| firefox22 | + | wontfix |
| firefox23 | + | fixed |
| firefox24 | + | fixed |
| firefox25 |  | fixed |
| firefox-esr17 | - | wontfix |
| b2g18 |  | unaffected |
| b2g-v1.1hd |  | unaffected |

## People

### (Reporter: guninski, Assigned: johns)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/e015aca8c2ea64974b5d4c29ae1ee603?d=mm&size=40)  [johns](/user_profile?user_id=429621)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/eb49beecdde375e0927ad6ebd7302ec1?d=mm&size=40)  [guninski](/user_profile?user_id=23768)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](extensions/Gravatar/web/default.jpg)  [jimm](/user_profile?user_id=279663)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

23 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[731947](/show_bug.cgi?id=731947 "RESOLVED FIXED - Permanent Orange: TEST-UNEXPECTED-FAIL | test-plugins-policy.js - Plugins no longer being blocked in email on trunk"), [736965](/show_bug.cgi?id=736965 "RESOLVED FIXED - Java applet would not run on certain site"), [738396](/show_bug.cgi?id=738396 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system"), [741758](/show_bug.cgi?id=741758 "RESOLVED FIXED - Class not found exception in JAVA applets with Aurora and Nightly (Affects webmin file manager)"), [744898](/show_bug.cgi?id=744898 "RESOLVED DUPLICATE - Some Java applets not working using Nightly/Aurora builds"), [752746](/show_bug.cgi?id=752746 "RESOLVED FIXED - can't make liveconnect calls from javascript to applet's method"), [902375](/show_bug.cgi?id=902375 "VERIFIED FIXED - Firefox 23: The Load of a local java applet (*jar) fails silently")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=406541&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=406541)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-moderate, Whiteboard: [adv-main23+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2013-1717

[Keywords:](/describekeywords.cgi)

[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main23+]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [johns](/user_profile?user_id=429621) | [in-testsuite](#c119 "12 years ago") | + |
| --- | --- | --- |
| [johns](/user_profile?user_id=429621) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 30 obsolete files)

| [a1.java - compiled a1.class must be saved in /tmp/DumbUglyB1llMarriedDumbUglyB1tch](/attachment.cgi?id=291181)  [17 years ago](#c0)  [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)   692 bytes, text/plain |  | [Details](/attachment.cgi?id=291181&action=edit) |
| --- | --- | --- |
| [a1.html - open it locally after placing the applet in correct dir](/attachment.cgi?id=291182)  [17 years ago](#c1)  [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)   342 bytes, text/html |  | [Details](/attachment.cgi?id=291182&action=edit) |
| [[1/3] Make GetObjectBaseURI xpcom callable, mimic java's empty-codebase quirk](/attachment.cgi?id=594006)  [13 years ago](#c7)  [John Schoenick [:johns]](/user_profile?user_id=429621)   7.21 KB, patch |  | [Details](/attachment.cgi?id=594006&action=edit) | [Diff](/attachment.cgi?id=594006&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=594006) |
| [[2/3] Check file:/// URIs for same-directory as a sort of same-origin check](/attachment.cgi?id=594007)  [13 years ago](#c8)  [John Schoenick [:johns]](/user_profile?user_id=429621)   3.33 KB, patch |  | [Details](/attachment.cgi?id=594007&action=edit) | [Diff](/attachment.cgi?id=594007&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=594007) |
| [[3/3] Canonicalize the codebase as we see it for plugins](/attachment.cgi?id=594008)  [13 years ago](#c9)  [John Schoenick [:johns]](/user_profile?user_id=429621)   3.61 KB, patch |  | [Details](/attachment.cgi?id=594008&action=edit) | [Diff](/attachment.cgi?id=594008&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=594008) |
| [[1/2] GetObjectBaseURI should mimic java's behavior](/attachment.cgi?id=597984)  [13 years ago](#c11)  [John Schoenick [:johns]](/user_profile?user_id=429621)   5.51 KB, patch | jst : [review+](#a132766508_12352 "13 years ago") | [Details](/attachment.cgi?id=597984&action=edit) | [Diff](/attachment.cgi?id=597984&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=597984) |
| [[2/2] Enforce same-directory for plugin codebase on file URIs](/attachment.cgi?id=597985)  [13 years ago](#c12)  [John Schoenick [:johns]](/user_profile?user_id=429621)   3.62 KB, patch | jst : [review-](#c13 "13 years ago") | [Details](/attachment.cgi?id=597985&action=edit) | [Diff](/attachment.cgi?id=597985&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=597985) |
| [[1/4] GetObjectBaseURI should match java's empty-string quirk](/attachment.cgi?id=600231)  [13 years ago](#c14)  [John Schoenick [:johns]](/user_profile?user_id=429621)   5.50 KB, patch |  | [Details](/attachment.cgi?id=600231&action=edit) | [Diff](/attachment.cgi?id=600231&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600231) |
| [[2/4] Make GetObjectBaseURI xpcomable](/attachment.cgi?id=600232)  [13 years ago](#c15)  [John Schoenick [:johns]](/user_profile?user_id=429621)   5.02 KB, patch |  | [Details](/attachment.cgi?id=600232&action=edit) | [Diff](/attachment.cgi?id=600232&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600232) |
| [[3/4] Run same-directory check on file URIs](/attachment.cgi?id=600233)  [13 years ago](#c16)  [John Schoenick [:johns]](/user_profile?user_id=429621)   5.21 KB, patch |  | [Details](/attachment.cgi?id=600233&action=edit) | [Diff](/attachment.cgi?id=600233&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600233) |
| [[4/4] Canonicalize the codebase pushed to java](/attachment.cgi?id=600237)  [13 years ago](#c17)  [John Schoenick [:johns]](/user_profile?user_id=429621)   4.45 KB, patch |  | [Details](/attachment.cgi?id=600237&action=edit) | [Diff](/attachment.cgi?id=600237&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600237) |
| [[4/4] Canonicalize the codebase pushed to java](/attachment.cgi?id=600256)  [13 years ago](#c18)  [John Schoenick [:johns]](/user_profile?user_id=429621)   4.37 KB, patch |  | [Details](/attachment.cgi?id=600256&action=edit) | [Diff](/attachment.cgi?id=600256&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600256) |
| [[1/4] GetObjectBaseURI should match java's empty-string quirk](/attachment.cgi?id=600481)  [13 years ago](#c19)  [John Schoenick [:johns]](/user_profile?user_id=429621)   5.49 KB, patch | jst : [review+](#a133449992_12352 "13 years ago") | [Details](/attachment.cgi?id=600481&action=edit) | [Diff](/attachment.cgi?id=600481&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600481) |
| [[2/4] Make GetObjectBaseURI xpcomable](/attachment.cgi?id=600482)  [13 years ago](#c20)  [John Schoenick [:johns]](/user_profile?user_id=429621)   5.02 KB, patch | jst : [review+](#a133450185_12352 "13 years ago") | [Details](/attachment.cgi?id=600482&action=edit) | [Diff](/attachment.cgi?id=600482&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600482) |
| [[3/4] Run same-directory check on file URIs](/attachment.cgi?id=600483)  [13 years ago](#c21)  [John Schoenick [:johns]](/user_profile?user_id=429621)   4.98 KB, patch | jst : [review+](#c24 "13 years ago") | [Details](/attachment.cgi?id=600483&action=edit) | [Diff](/attachment.cgi?id=600483&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600483) |
| [[4/4] Canonicalize the codebase pushed to java](/attachment.cgi?id=600484)  [13 years ago](#c22)  [John Schoenick [:johns]](/user_profile?user_id=429621)   4.37 KB, patch | jst : [review+](#c25 "13 years ago") | [Details](/attachment.cgi?id=600484&action=edit) | [Diff](/attachment.cgi?id=600484&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600484) |
| [Ensure we agree with java on applet codebase, and run security checks for file: codebase URIs. r=jst](/attachment.cgi?id=601053)  [13 years ago](#c26)  [John Schoenick [:johns]](/user_profile?user_id=429621)   16.20 KB, patch | jst : [review+](#c27 "13 years ago") | [Details](/attachment.cgi?id=601053&action=edit) | [Diff](/attachment.cgi?id=601053&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=601053) |
| [Always return a codebase for plugins, even if URI creation fails](/attachment.cgi?id=602167)  [13 years ago](#c35)  [John Schoenick [:johns]](/user_profile?user_id=429621)   1.59 KB, patch |  | [Details](/attachment.cgi?id=602167&action=edit) | [Diff](/attachment.cgi?id=602167&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=602167) |
| [Followup - Handle failed URI creation, fix typo](/attachment.cgi?id=602461)  [13 years ago](#c39)  [John Schoenick [:johns]](/user_profile?user_id=429621)   2.68 KB, patch | bzbarsky : [review+](#c40 "13 years ago") | [Details](/attachment.cgi?id=602461&action=edit) | [Diff](/attachment.cgi?id=602461&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=602461) |
| [[checkin-needed] Followup - Handle failed URI creation, fix typo. r=bzbarsky](/attachment.cgi?id=602486)  [13 years ago](#c41)  [John Schoenick [:johns]](/user_profile?user_id=429621)   2.67 KB, patch |  | [Details](/attachment.cgi?id=602486&action=edit) | [Diff](/attachment.cgi?id=602486&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=602486) |
| [aurora backout of the fix + followup in this bug.](/attachment.cgi?id=614666)  [13 years ago](#c46)  [Johnny Stenback (:jst)](/user_profile?user_id=12352)   11.57 KB, patch | jst : [review+](#c46 "13 years ago")  akeybl : [approval-mozilla-aurora+](#c47 "13 years ago") | [Details](/attachment.cgi?id=614666&action=edit) | [Diff](/attachment.cgi?id=614666&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=614666) |
| [Backout of aurora (14) for regressions](/attachment.cgi?id=629267)  [13 years ago](#c50)  [John Schoenick [:johns]](/user_profile?user_id=429621)   16.43 KB, patch | jst : [review+](#a141905451_12352 "13 years ago")  akeybl : [approval-mozilla-aurora+](#c52 "13 years ago") | [Details](/attachment.cgi?id=629267&action=edit) | [Diff](/attachment.cgi?id=629267&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=629267) |
| [Backout of 15](/attachment.cgi?id=634674)  [13 years ago](#c56)  [John Schoenick [:johns]](/user_profile?user_id=429621)   16.29 KB, patch | jst : [review+](#a144179248_12352 "13 years ago")  akeybl : [approval-mozilla-aurora+](#c61 "13 years ago") | [Details](/attachment.cgi?id=634674&action=edit) | [Diff](/attachment.cgi?id=634674&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=634674) |
| [Backout of 16](/attachment.cgi?id=634675)  [13 years ago](#c57)  [John Schoenick [:johns]](/user_profile?user_id=429621)   16.29 KB, patch | jst : [review+](#a144179263_12352 "13 years ago") | [Details](/attachment.cgi?id=634675&action=edit) | [Diff](/attachment.cgi?id=634675&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=634675) |
| [Add an allowFileDirectories argument to nsPrincipal::CheckMayLoad](/attachment.cgi?id=733642)  [12 years ago](#c68)  [John Schoenick [:johns]](/user_profile?user_id=429621)   28.55 KB, patch |  | [Details](/attachment.cgi?id=733642&action=edit) | [Diff](/attachment.cgi?id=733642&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=733642) |
| [Add check for java file codebase security](/attachment.cgi?id=733644)  [12 years ago](#c69)  [John Schoenick [:johns]](/user_profile?user_id=429621)   4.14 KB, patch | benjamin : [review+](#a173601593_7044 "12 years ago") | [Details](/attachment.cgi?id=733644&action=edit) | [Diff](/attachment.cgi?id=733644&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=733644) |
| [[Fold into patch on branches] Move strict file origin checking blob into nsOBJLC](/attachment.cgi?id=733645)  [12 years ago](#c70)  [John Schoenick [:johns]](/user_profile?user_id=429621)   6.57 KB, patch | benjamin : [review+](#a173601642_7044 "12 years ago") | [Details](/attachment.cgi?id=733645&action=edit) | [Diff](/attachment.cgi?id=733645&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=733645) |
| [Test](/attachment.cgi?id=755520)  [12 years ago](#c71)  [John Schoenick [:johns]](/user_profile?user_id=429621)   3.95 KB, patch | benjamin : [review+](#a173601683_7044 "12 years ago") | [Details](/attachment.cgi?id=755520&action=edit) | [Diff](/attachment.cgi?id=755520&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=755520) |
| [Add NS\_URIIsLocalFile and NS\_CheckStrictFileOriginPolicy](/attachment.cgi?id=758043)  [12 years ago](#c85)  [John Schoenick [:johns]](/user_profile?user_id=429621)   4.22 KB, patch | bzbarsky : [review+](#c88 "12 years ago") | [Details](/attachment.cgi?id=758043&action=edit) | [Diff](/attachment.cgi?id=758043&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758043) |
| [Use NS\_CheckStrictOriginPolicy in CheckMayLoad](/attachment.cgi?id=758046)  [12 years ago](#c86)  [John Schoenick [:johns]](/user_profile?user_id=429621)   5.66 KB, patch | bzbarsky : [review-](#c89 "12 years ago") | [Details](/attachment.cgi?id=758046&action=edit) | [Diff](/attachment.cgi?id=758046&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758046) |
| [Add check for java file codebase security. r=bsmedberg](/attachment.cgi?id=758053)  [12 years ago](#c87)  [John Schoenick [:johns]](/user_profile?user_id=429621)   4.72 KB, patch | johns : [review+](#a173694783_429621 "12 years ago") | [Details](/attachment.cgi?id=758053&action=edit) | [Diff](/attachment.cgi?id=758053&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758053) |
| [Split NS\_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad](/attachment.cgi?id=758243)  [12 years ago](#c90)  [John Schoenick [:johns]](/user_profile?user_id=429621)   10.08 KB, patch | bzbarsky : [review+](#c92 "12 years ago")  lsblakk : [approval-mozilla-aurora+](#a176298577_272375 "12 years ago")  lsblakk : [approval-mozilla-beta+](#a176298577_272375 "12 years ago")  akeybl : [approval-mozilla-esr17-](#a177925355_425645 "12 years ago")  abillings : [sec-approval+](#a173880298_280903 "12 years ago")  johns : [checkin+](#c98 "12 years ago") | [Details](/attachment.cgi?id=758243&action=edit) | [Diff](/attachment.cgi?id=758243&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758243) |
| [Add check for java file codebase security. r=bsmedberg](/attachment.cgi?id=758249)  [12 years ago](#c91)  [John Schoenick [:johns]](/user_profile?user_id=429621)   4.76 KB, patch | johns : [review+](#a173708985_429621 "12 years ago")  lsblakk : [approval-mozilla-aurora+](#a176298557_272375 "12 years ago")  lsblakk : [approval-mozilla-beta+](#a176298557_272375 "12 years ago")  bajaj : [approval-mozilla-esr17-](#a178482049_448925 "12 years ago")  abillings : [sec-approval+](#c95 "12 years ago")  johns : [checkin+](#c99 "12 years ago") | [Details](/attachment.cgi?id=758249&action=edit) | [Diff](/attachment.cgi?id=758249&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758249) |
| [Test. r=bsmedberg](/attachment.cgi?id=787151)  [11 years ago](#c110)  [John Schoenick [:johns]](/user_profile?user_id=429621)   4.49 KB, patch | johns : [review+](#a179237887_429621 "11 years ago") | [Details](/attachment.cgi?id=787151&action=edit) | [Diff](/attachment.cgi?id=787151&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=787151) |
| [Test. r=bsmedberg](/attachment.cgi?id=8379262)  [11 years ago](#c114)  [John Schoenick [:johns]](/user_profile?user_id=429621)   4.80 KB, patch | johns : [review+](#c114 "11 years ago")  johns : [checkin+](#c115 "11 years ago") | [Details](/attachment.cgi?id=8379262&action=edit) | [Diff](/attachment.cgi?id=8379262&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=8379262) |

Show Obsolete

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=406541#c0)â€¢ 17 years ago |
|  | |

Attached file
[a1.java - compiled a1.class must be saved in /tmp/DumbUglyB1llMarriedDumbUglyB1tch](attachment.cgi?id=291181)
â€” [Details](attachment.cgi?id=291181&action=edit)

recent trunk has restrictions on what local html can access
in [bug 402998 Comment #8](/show_bug.cgi?id=402998#c8 "RESOLVED FIXED - java in local file can read any files") someone with sun.com email asked to "post a test" for local applet circumventing restrictions.
it is like beating a death horse, but here it is:
if the path of the locally saved applet is known at applet compile time, the applet can read any file.
note that if the luser saves files in a single directory, a two stage attack may be successful with high probability.
suppose the applet is saved in directory:
/tmp/DumbUglyB1llMarriedDumbUglyB1tch
it should be instantiated like this:
<applet codebase="file:///"
code="tmp.DumbUglyB1llMarriedDumbUglyB1tch.a1">
</applet>
and the applet should contain:
/\*
\* This is the path to the applet filename:
\* \*/
package tmp.DumbUglyB1llMarriedDumbUglyB1tch;
public class a1 extends Applet {

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=406541#c1)â€¢ 17 years ago |
|  | |

Attached file
[a1.html - open it locally after placing the applet in correct dir](attachment.cgi?id=291182)
â€” [Details](attachment.cgi?id=291182&action=edit)

|  | [:Gavin Sharp [email: gavin@gavinsharp.com]](/user_profile?user_id=103593) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a24728_103593)â€¢ 17 years ago |

Assignee: nobody â†’ dveditzProduct: Firefox â†’ CoreQA Contact: firefox â†’ toolkit

|  | [Kenneth Russell](/user_profile?user_id=262289) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=406541#c2)â€¢ 17 years ago |
|  | |

Agreed, this should not be possible and is a bug on the Java side. Appropriate people have been notified, and we will update this bug with progress.

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=406541#c3)â€¢ 17 years ago |
|  | |

when i was a coder in the old dos days, we were instructed to call our application bugs "uncontrollable process in the operating systems" whenever possible ;)

|  | [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=406541#c4)â€¢ 17 years ago |
|  | |

[sg:moderate] imoWhiteboard: [sg:moderate]

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=406541#c5)â€¢ 13 years ago |
|  | |

georgi, is this still a problem with an up to date java plugin?

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=406541#c6)â€¢ 13 years ago |
|  | |

I just tested, and it still is a problem with the testcase as written. The reason being that the testcase sets a codebase of file:///, which means anything on the users filesystem is considered same origin. If I change the testcase to not set a codebase (and move the class file around so it's found) then I get a permission denied error.
I guess we could consider something along the lines of forbidding setting of the codebase to a file:// uri at all, which would force the codebase to be the location of the containing page. Not great, but better than what we have now.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a125341715_1689)â€¢ 13 years ago |

Assignee: dveditz â†’ nobody

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a125928537_429621)â€¢ 13 years ago |

Assignee: nobody â†’ jschoenick

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=406541#c7)â€¢ 13 years ago |
|  | |

Attached patch

[[1/3] Make GetObjectBaseURI xpcom callable, mimic java's empty-codebase quirk](attachment.cgi?id=594006&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=594006&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=594006)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=406541#c8)â€¢ 13 years ago |
|  | |

Attached patch

[[2/3] Check file:/// URIs for same-directory as a sort of same-origin check](attachment.cgi?id=594007&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=594007&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=594007)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=406541#c9)â€¢ 13 years ago |
|  | |

Attached patch

[[3/3] Canonicalize the codebase as we see it for plugins](attachment.cgi?id=594008&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=594008&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=594008)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a131553317_429621)â€¢ 13 years ago |

[Attachment #594006](/attachment.cgi?id=594006&action=edit "[1/3] Make GetObjectBaseURI xpcom callable, mimic java's empty-codebase quirk") -
Attachment description: [1/3] Make GetObjectBaseURI xpcom callable, remove superfluous argument â†’ [1/3] Make GetObjectBaseURI xpcom callable, mimic java's empty-codebase quirk

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=406541#c10)â€¢ 13 years ago |
|  | |

WIP patches
#1 - Makes GetObjectBaseURI xpcom-able so we can use this as the canonical base URI, to avoid duplicating logic. It also adds a mimicry of java's empty-codebase quirk (previously we were security checking different URLs than java)
#2 - Using the now-correct GetObjectBaseURI, check file-URLs for same-directory.
#3 - In the code that caches attributes for communication with the plugin, force codebase to the processed result of GetObjectBaseURI, such that we ensure agreement upon codebase.

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=406541#c11)â€¢ 13 years ago |
|  | |

Attached patch

[[1/2] GetObjectBaseURI should mimic java's behavior](attachment.cgi?id=597984&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=597984&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=597984)

[Attachment #594006](/attachment.cgi?id=594006&action=edit "[1/3] Make GetObjectBaseURI xpcom callable, mimic java's empty-codebase quirk") -
Attachment is obsolete: true
[Attachment #594007](/attachment.cgi?id=594007&action=edit "[2/3] Check file:/// URIs for same-directory as a sort of same-origin check") -
Attachment is obsolete: true
[Attachment #594008](/attachment.cgi?id=594008&action=edit "[3/3] Canonicalize the codebase as we see it for plugins") -
Attachment is obsolete: true
[Attachment #597984](/attachment.cgi?id=597984&action=edit "[1/2] GetObjectBaseURI should mimic java's behavior") -
Flags: review?(jst)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=406541#c12)â€¢ 13 years ago |
|  | |

Attached patch

[[2/2] Enforce same-directory for plugin codebase on file URIs](attachment.cgi?id=597985&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=597985&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=597985)

Simpler approach to this - since we don't know of any other java bugs/quirks with parsing the codebase, forcing the attribute to be the normalized path is probably overkill.
These patches ensure GetObjectBaseURI() matches what the plugin will see by emulating java's quirk, and then runs a security check on same-directory for file URIs
[Attachment #597985](/attachment.cgi?id=597985&action=edit "[2/2] Enforce same-directory for plugin codebase on file URIs") -
Flags: review?(jst)

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a132766508_12352)â€¢ 13 years ago |

[Attachment #597984](/attachment.cgi?id=597984&action=edit "[1/2] GetObjectBaseURI should mimic java's behavior") -
Flags: review?(jst) â†’ review+

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=406541#c13)â€¢ 13 years ago |
|  | |

Comment on [attachment 597985](/attachment.cgi?id=597985 "[2/2] Enforce same-directory for plugin codebase on file URIs") [[details]](/attachment.cgi?id=597985&action=edit "[2/2] Enforce same-directory for plugin codebase on file URIs") [[diff]](/attachment.cgi?id=597985&action=diff "[2/2] Enforce same-directory for plugin codebase on file URIs") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=597985)
[2/2] Enforce same-directory for plugin codebase on file URIs
It's unfortunately that we can't share some of this logic with nsPrincipal::CheckMayLoad(), but I don't really see an easy way to do that, given the differences. However, I'd like to see the guts of this file related stuff split out into its own function, that would simplify the return paths etc, you can do the fallback only once in the calling code, and it would make this code a bit easier to read. Other than that, this looks correct to me.
r- to get this split into its own function.
[Attachment #597985](/attachment.cgi?id=597985&action=edit "[2/2] Enforce same-directory for plugin codebase on file URIs") -
Flags: review?(jst) â†’ review-

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=406541#c14)â€¢ 13 years ago |
|  | |

Attached patch

[[1/4] GetObjectBaseURI should match java's empty-string quirk](attachment.cgi?id=600231&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=600231&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600231)

[Attachment #597984](/attachment.cgi?id=597984&action=edit "[1/2] GetObjectBaseURI should mimic java's behavior") -
Attachment is obsolete: true
[Attachment #597985](/attachment.cgi?id=597985&action=edit "[2/2] Enforce same-directory for plugin codebase on file URIs") -
Attachment is obsolete: true

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=406541#c15)â€¢ 13 years ago |
|  | |

Attached patch

[[2/4] Make GetObjectBaseURI xpcomable](attachment.cgi?id=600232&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=600232&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600232)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=406541#c16)â€¢ 13 years ago |
|  | |

Attached patch

[[3/4] Run same-directory check on file URIs](attachment.cgi?id=600233&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=600233&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600233)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=406541#c17)â€¢ 13 years ago |
|  | |

Attached patch

[[4/4] Canonicalize the codebase pushed to java](attachment.cgi?id=600237&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=600237&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600237)

So I discovered that "file:" also triggers bad behavior from java. This should switch the scheme to file but keep the path unchanged, but java also interprets this as "/" path on the new scheme.
Because we don't particularly care about preserving this behavior, resurrect the canonicalize-codebase patch to ensure agreement (and effectively break anyone relying on "scheme:" codebases). This avoids adding even more code to mimic java (especially since we can't parse relative URIs easily with nsIURI) and protects against any other unexpected issues in its URI parsing.

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=406541#c18)â€¢ 13 years ago |
|  | |

Attached patch

[[4/4] Canonicalize the codebase pushed to java](attachment.cgi?id=600256&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=600256&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600256)

Fix CnP error
[Attachment #600237](/attachment.cgi?id=600237&action=edit "[4/4] Canonicalize the codebase pushed to java") -
Attachment is obsolete: true

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=406541#c19)â€¢ 13 years ago |
|  | |

Attached patch

[[1/4] GetObjectBaseURI should match java's empty-string quirk](attachment.cgi?id=600481&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=600481&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600481)

Fix whitespace
[Attachment #600231](/attachment.cgi?id=600231&action=edit "[1/4] GetObjectBaseURI should match java's empty-string quirk") -
Attachment is obsolete: true

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=406541#c20)â€¢ 13 years ago |
|  | |

Attached patch

[[2/4] Make GetObjectBaseURI xpcomable](attachment.cgi?id=600482&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=600482&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600482)

fixup whitespace
[Attachment #600232](/attachment.cgi?id=600232&action=edit "[2/4] Make GetObjectBaseURI xpcomable") -
Attachment is obsolete: true

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=406541#c21)â€¢ 13 years ago |
|  | |

Attached patch

[[3/4] Run same-directory check on file URIs](attachment.cgi?id=600483&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=600483&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600483)

Fixup whitespace, remove debugging LOG() statement
[Attachment #600233](/attachment.cgi?id=600233&action=edit "[3/4] Run same-directory check on file URIs") -
Attachment is obsolete: true

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=406541#c22)â€¢ 13 years ago |
|  | |

Attached patch

[[4/4] Canonicalize the codebase pushed to java](attachment.cgi?id=600484&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=600484&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600484)

whitespace.
[Attachment #600256](/attachment.cgi?id=600256&action=edit "[4/4] Canonicalize the codebase pushed to java") -
Attachment is obsolete: true

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=406541#c23)â€¢ 13 years ago |
|  | |

Survived a try build here
<https://tbpl.mozilla.org/?tree=Try&rev=498965274875>

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a133439916_429621)â€¢ 13 years ago |

[Attachment #600481](/attachment.cgi?id=600481&action=edit "[1/4] GetObjectBaseURI should match java's empty-string quirk") -
Flags: review?(jst)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a133439956_429621)â€¢ 13 years ago |

[Attachment #600482](/attachment.cgi?id=600482&action=edit "[2/4] Make GetObjectBaseURI xpcomable") -
Flags: review?(jst)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a133440008_429621)â€¢ 13 years ago |

[Attachment #600483](/attachment.cgi?id=600483&action=edit "[3/4] Run same-directory check on file URIs") -
Flags: review?(jst)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a133440087_429621)â€¢ 13 years ago |

[Attachment #600484](/attachment.cgi?id=600484&action=edit "[4/4] Canonicalize the codebase pushed to java") -
Flags: review?(jst)

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a133449992_12352)â€¢ 13 years ago |

[Attachment #600481](/attachment.cgi?id=600481&action=edit "[1/4] GetObjectBaseURI should match java's empty-string quirk") -
Flags: review?(jst) â†’ review+

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a133450185_12352)â€¢ 13 years ago |

[Attachment #600482](/attachment.cgi?id=600482&action=edit "[2/4] Make GetObjectBaseURI xpcomable") -
Flags: review?(jst) â†’ review+

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=406541#c24)â€¢ 13 years ago |
|  | |

Comment on [attachment 600483](/attachment.cgi?id=600483 "[3/4] Run same-directory check on file URIs") [[details]](/attachment.cgi?id=600483&action=edit "[3/4] Run same-directory check on file URIs") [[diff]](/attachment.cgi?id=600483&action=diff "[3/4] Run same-directory check on file URIs") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600483)
[3/4] Run same-directory check on file URIs
...
+ nsCOMPtr<nsIURI> docURI;
+ nsCOMPtr<nsIURI> baseURI;
+ GetObjectBaseURI(aTypeHint, getter\_AddRefs(baseURI));
+ rv = thisContent->NodePrincipal()->GetURI(getter\_AddRefs(docURI));
Given that docURI comes from the principal, I'd recommending doing s/doc(ument)?/origin/ in this whole patch, as the document uri can be different from the origin uri (especially when dealing with javascript: and data: URIs). Making that change would make this naming follow surrounding code better.
+ if (NS\_FAILED(docURI->SchemeIs("file", &isfile)) ||
+ (isfile && !IsFileCodebaseAllowable(baseURI.get(), docURI.get()))) {
No need for those .get() calls.
r=jst with those changes made.
[Attachment #600483](/attachment.cgi?id=600483&action=edit "[3/4] Run same-directory check on file URIs") -
Flags: review?(jst) â†’ review+

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=406541#c25)â€¢ 13 years ago |
|  | |

Comment on [attachment 600484](/attachment.cgi?id=600484 "[4/4] Canonicalize the codebase pushed to java") [[details]](/attachment.cgi?id=600484&action=edit "[4/4] Canonicalize the codebase pushed to java") [[diff]](/attachment.cgi?id=600484&action=diff "[4/4] Canonicalize the codebase pushed to java") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=600484)
[4/4] Canonicalize the codebase pushed to java
Looks good! r=jst
[Attachment #600484](/attachment.cgi?id=600484&action=edit "[4/4] Canonicalize the codebase pushed to java") -
Flags: review?(jst) â†’ review+

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=406541#c26)â€¢ 13 years ago |
|  | |

Attached patch

[Ensure we agree with java on applet codebase, and run security checks for file: codebase URIs. r=jst](attachment.cgi?id=601053&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=601053&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=601053)

docURI renamed to originURI, and rolled into one since the latter wont apply cleanly without the former.
[Attachment #600481](/attachment.cgi?id=600481&action=edit "[1/4] GetObjectBaseURI should match java's empty-string quirk") -
Attachment is obsolete: true
[Attachment #600482](/attachment.cgi?id=600482&action=edit "[2/4] Make GetObjectBaseURI xpcomable") -
Attachment is obsolete: true
[Attachment #600483](/attachment.cgi?id=600483&action=edit "[3/4] Run same-directory check on file URIs") -
Attachment is obsolete: true
[Attachment #600484](/attachment.cgi?id=600484&action=edit "[4/4] Canonicalize the codebase pushed to java") -
Attachment is obsolete: true
[Attachment #601053](/attachment.cgi?id=601053&action=edit "Ensure we agree with java on applet codebase, and run security checks for file: codebase URIs. r=jst") -
Flags: review?(jst)

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=406541#c27)â€¢ 13 years ago |
|  | |

Comment on [attachment 601053](/attachment.cgi?id=601053 "Ensure we agree with java on applet codebase, and run security checks for file: codebase URIs. r=jst") [[details]](/attachment.cgi?id=601053&action=edit "Ensure we agree with java on applet codebase, and run security checks for file: codebase URIs. r=jst") [[diff]](/attachment.cgi?id=601053&action=diff "Ensure we agree with java on applet codebase, and run security checks for file: codebase URIs. r=jst") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=601053)
Ensure we agree with java on applet codebase, and run security checks for file: codebase URIs. r=jst
r=jst
[Attachment #601053](/attachment.cgi?id=601053&action=edit "Ensure we agree with java on applet codebase, and run security checks for file: codebase URIs. r=jst") -
Flags: review?(jst) â†’ review+

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=406541#c28)â€¢ 13 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/1e4675fb8fc9>

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=406541#c29)â€¢ 13 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/1e4675fb8fc9>Status: NEW â†’ RESOLVEDClosed: 13 years ago
[status-firefox13](/buglist.cgi?f1=cf_status_firefox13&o1=isnotempty):
--- â†’ [fixed](/buglist.cgi?f1=cf_status_firefox13&o1=equals&v1=fixed)Resolution: --- â†’ FIXEDTarget Milestone: --- â†’ mozilla13

|  | [Mark Banner (:standard8)](/user_profile?user_id=112088) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a133924775_112088)â€¢ 13 years ago |

Depends on: [731947](/show_bug.cgi?id=731947 "RESOLVED FIXED - Permanent Orange: TEST-UNEXPECTED-FAIL | test-plugins-policy.js - Plugins no longer being blocked in email on trunk")

|  | [Mark Banner (:standard8)](/user_profile?user_id=112088) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=406541#c30)â€¢ 13 years ago |
|  | |

This has caused a serious regression in Thunderbird - [bug 731947](/show_bug.cgi?id=731947 "RESOLVED FIXED - Permanent Orange: TEST-UNEXPECTED-FAIL | test-plugins-policy.js - Plugins no longer being blocked in email on trunk") - Plugins are no longer blocked in email as per Thunderbird's content policy (or at least the application/x-test plugin isn't blocked).

|  | [Mark Banner (:standard8)](/user_profile?user_id=112088) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=406541#c31)â€¢ 13 years ago |
|  | |

So I've just confirmed that although the code is trying to set allowPlugins and allowJavascript to false on the docShell (this is via nsMsgContentPolicy::ShouldLoad), it is no longer happening on the message pane docShell.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=406541#c32)â€¢ 13 years ago |
|  | |

Which is no longer happening? The call doesn't get to the docshell? Or the docshell setting is ignored?
Is the issue that nsObjectLoadingContent::GetObjectBaseURI got changed for the case of not-applets so that the "instantiate without a URI" codepath is now not passing in a useful URI anymore and security checks that rely on that fail?

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=406541#c33)â€¢ 13 years ago |
|  | |

We should probably get a core bug followup filed blocking this one on the issue, and request tracking13 on it.

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=406541#c34)â€¢ 13 years ago |
|  | |

I'm looking into this

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=406541#c35)â€¢ 13 years ago |
|  | |

Attached patch

[Always return a codebase for plugins, even if URI creation fails](attachment.cgi?id=602167&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=602167&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=602167)

The problem is this call is failing:
> nsContentUtils::NewURIWithDocumentCharset(aURI, codebase,
> thisContent->OwnerDoc(),
> baseURI);
With codebase "" and base "mailbox:///home/johns/moz/tb-dbg/mozilla/\_tests/mozmill/mozmillprofile/Mail/Local%20Folders/pluginPolicy?number=0"
Causing this function to return NS\_OK, but not return a URI. This could happen before, but only if the object had a codebase attribute, which the test doesn't cover.
Attached patch returns the object's baseURI if codebase URI creation fails.
[Attachment #602167](/attachment.cgi?id=602167&action=edit "Always return a codebase for plugins, even if URI creation fails") -
Flags: review?(jst)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=406541#c36)â€¢ 13 years ago |
|  | |

Why do you need to clone? Can you not swap like the old code used to?

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=406541#c37)â€¢ 13 years ago |
|  | |

@bz - The function is exposed to xpcom now, so the old assert(aURI = null) quirk is undesirable. (especially as this is a trivial function performance-wise)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=406541#c38)â€¢ 13 years ago |
|  | |

> @bz - The function is exposed to xpcom now, so the old assert(aURI = null) quirk is
> undesirable.
If you want to, you can set \*aURI to null before swapping to make the swap safe. I agree that just asserting that \*aURI is null is no longer OK.
> especially as this is a trivial function performance-wise
Cloning some URIs can copy megabytes of data. Let's just not do it unless we really really have to.
(On a separate note, why exactly is this function capitalized in the IDL? The convention it lowercase first letter in IDL....)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a133999381_429621)â€¢ 13 years ago |

[Attachment #602167](/attachment.cgi?id=602167&action=edit "Always return a codebase for plugins, even if URI creation fails") -
Flags: review?(jst)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=406541#c39)â€¢ 13 years ago |
|  | |

Attached patch

[Followup - Handle failed URI creation, fix typo](attachment.cgi?id=602461&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=602461&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=602461)

New patch - restores using uri swapping when possible, and fixes the capitalization in the idl
[Attachment #602167](/attachment.cgi?id=602167&action=edit "Always return a codebase for plugins, even if URI creation fails") -
Attachment is obsolete: true
[Attachment #602461](/attachment.cgi?id=602461&action=edit "Followup - Handle failed URI creation, fix typo") -
Flags: review?(bzbarsky)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=406541#c40)â€¢ 13 years ago |
|  | |

Comment on [attachment 602461](/attachment.cgi?id=602461 "Followup - Handle failed URI creation, fix typo") [[details]](/attachment.cgi?id=602461&action=edit "Followup - Handle failed URI creation, fix typo") [[diff]](/attachment.cgi?id=602461&action=diff "Followup - Handle failed URI creation, fix typo") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=602461)
Followup - Handle failed URI creation, fix typo
Drop the unnecessary else after return, return the rv that succeeded instead of NS\_OK, and r=me.
[Attachment #602461](/attachment.cgi?id=602461&action=edit "Followup - Handle failed URI creation, fix typo") -
Flags: review?(bzbarsky) â†’ review+

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=406541#c41)â€¢ 13 years ago |
|  | |

Attached patch

[[checkin-needed] Followup - Handle failed URI creation, fix typo. r=bzbarsky](attachment.cgi?id=602486&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=602486&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=602486)

changes per bz, checkin-needed
[Attachment #602461](/attachment.cgi?id=602461&action=edit "Followup - Handle failed URI creation, fix typo") -
Attachment is obsolete: true

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a134051593_429621)â€¢ 13 years ago |

[Attachment #601053](/attachment.cgi?id=601053&action=edit "Ensure we agree with java on applet codebase, and run security checks for file: codebase URIs. r=jst") -
Attachment description: [checkin-needed] Ensure we agree with java on applet codebase, and run security checks for file: codebase URIs. r=jst â†’ Ensure we agree with java on applet codebase, and run security checks for file: codebase URIs. r=jst

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=406541#c42)â€¢ 13 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/b0b135e60d35>

|  | [Ed Morley [:emorley]](/user_profile?user_id=373476) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=406541#c43)â€¢ 13 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/b0b135e60d35>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a134579123_1689)â€¢ 13 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=affected)
[status-firefox11](/buglist.cgi?f1=cf_status_firefox11&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox11&o1=equals&v1=wontfix)
[status-firefox12](/buglist.cgi?f1=cf_status_firefox12&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox12&o1=equals&v1=affected)
[tracking-firefox-esr10](/buglist.cgi?f1=cf_tracking_esr10&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=%3F)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=406541#c44)â€¢ 13 years ago |
|  | |

Tracking for the ESR that is released alongside Firefox 13. We'll want to make sure that we fix [bug 731947](/show_bug.cgi?id=731947 "RESOLVED FIXED - Permanent Orange: TEST-UNEXPECTED-FAIL | test-plugins-policy.js - Plugins no longer being blocked in email on trunk") at the same time.
[tracking-firefox-esr10](/buglist.cgi?f1=cf_tracking_esr10&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=%3F) â†’ [13+](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=13%2B)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a135491390_20209)â€¢ 13 years ago |

Depends on: [736965](/show_bug.cgi?id=736965 "RESOLVED FIXED - Java applet would not run on certain site")

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a135768548_429621)â€¢ 13 years ago |

Blocks: [738396](/show_bug.cgi?id=738396 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system")

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=406541#c45)â€¢ 13 years ago |
|  | |

The regression in [Bug 736965](/show_bug.cgi?id=736965 "RESOLVED FIXED - Java applet would not run on certain site") cannot be fully fixed without a bigger change to make our codebase detection in ObjectLoadingContent and cached parameters in PluginInstanceHost take <param> tags into consideration. Given that the code is very fragile and that we have almost no tests covering plugin loading and java specifically, this is rather risky regression-wise.
There are also and there are other much bigger security issues in ObjectLoadingContent that require refactoring of the class. This is happening in [Bug 738396](/show_bug.cgi?id=738396 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system"), which will also include better tests for java loading.
After talking with jst, I think the best course of action is to back this patch out of aurora, and address the regressions along with the further security issues in 738396.

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a137344448_429621)â€¢ 13 years ago |

OS: Linux â†’ AllHardware: x86 â†’ All

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a137521094_20209)â€¢ 13 years ago |

Depends on: [741758](/show_bug.cgi?id=741758 "RESOLVED FIXED - Class not found exception in JAVA applets with Aurora and Nightly (Affects webmin file manager)")

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a137592165_67806)â€¢ 13 years ago |

Depends on: [744898](/show_bug.cgi?id=744898 "RESOLVED DUPLICATE - Some Java applets not working using Nightly/Aurora builds")

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=406541#c46)â€¢ 13 years ago |
|  | |

Attached patch

[aurora backout of the fix + followup in this bug.](attachment.cgi?id=614666&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=614666&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=614666)

[Approval Request Comment]
Reason: The fix for this caused several regressions which are too risky to fix on aurora (see earlier comments).
User impact if declined: java won't load in several cases
Testing completed (on m-c, etc.): This is a backout to a known good state (with a moderate security bug w/o this fix).
Risk to taking this patch (and alternatives if risky): We either take this, or we ship with java broken in significant ways, or we take a much riskier fix (which isn't quite done yet), i.e. not an option.
String changes made by this patch: n/a
[Attachment #614666](/attachment.cgi?id=614666&action=edit "aurora backout of the fix + followup in this bug.") -
Flags: review+
[Attachment #614666](/attachment.cgi?id=614666&action=edit "aurora backout of the fix + followup in this bug.") -
Flags: approval-mozilla-aurora?

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=406541#c47)â€¢ 13 years ago |
|  | |

Comment on [attachment 614666](/attachment.cgi?id=614666 "aurora backout of the fix + followup in this bug.") [[details]](/attachment.cgi?id=614666&action=edit "aurora backout of the fix + followup in this bug.") [[diff]](/attachment.cgi?id=614666&action=diff "aurora backout of the fix + followup in this bug.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=614666)
aurora backout of the fix + followup in this bug.
[Triage Comment]
Approved for Aurora 13 given the regressions tracked in [bug 736965](/show_bug.cgi?id=736965 "RESOLVED FIXED - Java applet would not run on certain site") and [bug 741758](/show_bug.cgi?id=741758 "RESOLVED FIXED - Class not found exception in JAVA applets with Aurora and Nightly (Affects webmin file manager)").
[Attachment #614666](/attachment.cgi?id=614666&action=edit "aurora backout of the fix + followup in this bug.") -
Flags: approval-mozilla-aurora? â†’ approval-mozilla-aurora+

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=406541#c48)â€¢ 13 years ago |
|  | |

Backout landed on aurora:
<https://hg.mozilla.org/releases/mozilla-aurora/rev/96a1b7f055c9>
[status-firefox12](/buglist.cgi?f1=cf_status_firefox12&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox12&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox12&o1=equals&v1=wontfix)
[status-firefox13](/buglist.cgi?f1=cf_status_firefox13&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox13&o1=equals&v1=fixed) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox13&o1=equals&v1=wontfix)
[tracking-firefox-esr10](/buglist.cgi?f1=cf_tracking_esr10&o1=isnotempty):
[13+](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=13%2B) â†’ ---

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a138201943_272375)â€¢ 13 years ago |

[tracking-firefox-esr10](/buglist.cgi?f1=cf_tracking_esr10&o1=isnotempty):
--- â†’ [13+](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=13%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a138202232_1689)â€¢ 13 years ago |

[status-firefox14](/buglist.cgi?f1=cf_status_firefox14&o1=isnotempty):
--- â†’ [fixed](/buglist.cgi?f1=cf_status_firefox14&o1=equals&v1=fixed)
[tracking-firefox-esr10](/buglist.cgi?f1=cf_tracking_esr10&o1=isnotempty):
[13+](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=13%2B) â†’ [14+](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=14%2B)Target Milestone: mozilla13 â†’ mozilla14

|  | [Josh Aas](/user_profile?user_id=18821) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a140019382_18821)â€¢ 13 years ago |

Blocks: [752746](/show_bug.cgi?id=752746 "RESOLVED FIXED - can't make liveconnect calls from javascript to applet's method")

|  | [Steven Michaud [:smichaud] (Retired)](/user_profile?user_id=67806) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a140072066_67806)â€¢ 13 years ago |

No longer blocks: [752746](/show_bug.cgi?id=752746 "RESOLVED FIXED - can't make liveconnect calls from javascript to applet's method")Depends on: [752746](/show_bug.cgi?id=752746 "RESOLVED FIXED - can't make liveconnect calls from javascript to applet's method")

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=406541#c49)â€¢ 13 years ago |
|  | |

The original issue in [comment 0](/show_bug.cgi?id=406541#c0 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances") is fixed now. It is not entirely clear which changes the current bug state is tracking. Are we now tracking the status of the regressions caused by the initial checkin within this bug?

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=406541#c50)â€¢ 13 years ago |
|  | |

Attached patch

[Backout of aurora (14) for regressions](attachment.cgi?id=629267&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=629267&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=629267)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=406541#c51)â€¢ 13 years ago |
|  | |

Comment on [attachment 629267](/attachment.cgi?id=629267 "Backout of aurora (14) for regressions") [[details]](/attachment.cgi?id=629267&action=edit "Backout of aurora (14) for regressions") [[diff]](/attachment.cgi?id=629267&action=diff "Backout of aurora (14) for regressions") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=629267)
Backout of aurora (14) for regressions
Back out of 14 as well for the same reasons as above. [Bug 745030](/show_bug.cgi?id=745030 "RESOLVED FIXED - Refactor nsObjectLoadingContent") should be landing shortly as a proper fix for this as well as unfixed security issues in [Bug 738396](/show_bug.cgi?id=738396 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system") - but wont be suitable for aurora.
[Approval Request Comment]
User impact if declined: Major plugin loading regressions, mainly with java.
Testing completed (on m-c, etc.): Returning to known-good state
Risk to taking this patch (and alternatives if risky): Re-introduces sg-moderate issue
String or UUID changes made by this patch: Changes nsIObjectLoadingContent uuid (cannot revert to original UUID due to subsequent changes)
[Attachment #629267](/attachment.cgi?id=629267&action=edit "Backout of aurora (14) for regressions") -
Attachment description: Backout of aurora for regressions â†’ Backout of aurora (14) for regressions
[Attachment #629267](/attachment.cgi?id=629267&action=edit "Backout of aurora (14) for regressions") -
Flags: review?(jst)
[Attachment #629267](/attachment.cgi?id=629267&action=edit "Backout of aurora (14) for regressions") -
Flags: approval-mozilla-aurora?

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a141905451_12352)â€¢ 13 years ago |

[Attachment #629267](/attachment.cgi?id=629267&action=edit "Backout of aurora (14) for regressions") -
Flags: review?(jst) â†’ review+

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a141912315_272375)â€¢ 13 years ago |

[tracking-firefox-esr10](/buglist.cgi?f1=cf_tracking_esr10&o1=isnotempty):
[14+](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=14%2B) â†’ [?](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=%3F)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=406541#c52)â€¢ 13 years ago |
|  | |

Comment on [attachment 629267](/attachment.cgi?id=629267 "Backout of aurora (14) for regressions") [[details]](/attachment.cgi?id=629267&action=edit "Backout of aurora (14) for regressions") [[diff]](/attachment.cgi?id=629267&action=diff "Backout of aurora (14) for regressions") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=629267)
Backout of aurora (14) for regressions
[Triage Comment]
Approving the backout. Please make sure to update the status flags once landed. Thanks!
[Attachment #629267](/attachment.cgi?id=629267&action=edit "Backout of aurora (14) for regressions") -
Flags: approval-mozilla-aurora? â†’ approval-mozilla-aurora+

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=406541#c53)â€¢ 13 years ago |
|  | |

Backed out from beta 14.
<https://hg.mozilla.org/releases/mozilla-beta/rev/4782adb17edf>
[status-firefox14](/buglist.cgi?f1=cf_status_firefox14&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox14&o1=equals&v1=fixed) â†’ [affected](/buglist.cgi?f1=cf_status_firefox14&o1=equals&v1=affected)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=406541#c54)â€¢ 13 years ago |
|  | |

I guess 15 is still "fixed", although we may get around to backing it out later if [bug 745030](/show_bug.cgi?id=745030 "RESOLVED FIXED - Refactor nsObjectLoadingContent") doesn't land soon.
[status-firefox15](/buglist.cgi?f1=cf_status_firefox15&o1=isnotempty):
--- â†’ [fixed](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=fixed)
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
--- â†’ [fixed](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=fixed)
[tracking-firefox-esr10](/buglist.cgi?f1=cf_tracking_esr10&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=%3F) â†’ ---

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=406541#c55)â€¢ 13 years ago |
|  | |

Is FIrefox 14 a "wontfix", or do we expect to somehow get this checked in again? I'm assuming it's simply not in this release. Are the regressions likely to get fixed before Firefox 15 makes it to Beta? Maybe we should just back it out from there now if that's not likely.
[tracking-firefox14](/buglist.cgi?f1=cf_tracking_firefox14&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox14&o1=equals&v1=%2B)
[tracking-firefox15](/buglist.cgi?f1=cf_tracking_firefox15&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox15&o1=equals&v1=%2B)
[tracking-firefox16](/buglist.cgi?f1=cf_tracking_firefox16&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=%2B)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=406541#c56)â€¢ 13 years ago |
|  | |

Attached patch

[Backout of 15](attachment.cgi?id=634674&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=634674&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=634674)

[Attachment #634674](/attachment.cgi?id=634674&action=edit "Backout of 15") -
Flags: review?(jst)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=406541#c57)â€¢ 13 years ago |
|  | |

Attached patch

[Backout of 16](attachment.cgi?id=634675&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=634675&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=634675)

[Attachment #634675](/attachment.cgi?id=634675&action=edit "Backout of 16") -
Flags: review?(jst)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=406541#c58)â€¢ 13 years ago |
|  | |

Comment on [attachment 634674](/attachment.cgi?id=634674 "Backout of 15") [[details]](/attachment.cgi?id=634674&action=edit "Backout of 15") [[diff]](/attachment.cgi?id=634674&action=diff "Backout of 15") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=634674)
Backout of 15
[Bug 745030](/show_bug.cgi?id=745030 "RESOLVED FIXED - Refactor nsObjectLoadingContent") may not land this cycle and [bug 738396](/show_bug.cgi?id=738396 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system") will need to land on top of it to fix further issues with java. Additionally, fully fixing the regressions here might require some of the changes in 738396.
I talked with jst and he agrees the best course of action is to back this out from remaining branches, and re-land it merged with the 738396 changes once 745030 is landed (when it can be done without regressions)
[Approval Request Comment]
User impact if declined: Significant Java regressions
Testing completed (on m-c, etc.): Returning to known good state
Risk to taking this patch (and alternatives if risky): re-introduces sg-moderate issue
String or UUID changes made by this patch: Changes nsIObjectLoadingContent UUID to match FF14
[Attachment #634674](/attachment.cgi?id=634674&action=edit "Backout of 15") -
Flags: approval-mozilla-aurora?

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=406541#c59)â€¢ 13 years ago |
|  | |

(In reply to John Schoenick [:johns] from [comment #58](/show_bug.cgi?id=406541#c58 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances"))
> String or UUID changes made by this patch: Changes nsIObjectLoadingContent
> UUID to match FF14
Does this have any possibility of compatibility regressions? If we're not sure, we should loop somebody in from AMO (like jorgev).

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=406541#c60)â€¢ 13 years ago |
|  | |

(In reply to Alex Keybl [:akeybl] from [comment #59](/show_bug.cgi?id=406541#c59 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances"))
> Does this have any possibility of compatibility regressions? If we're not
> sure, we should loop somebody in from AMO (like jorgev).
I don't believe so - this removes a single call addons were not likely to be using (getObjectBaseURI) and thus changes the interface and its UUID to match what is on beta and aurora - addons that have compatibility there should be fine through trunk.
Additionally, I believe we will get away with fixing this properly with 745030 + 738396 without changing the interface again, the changes in [bug 745030](/show_bug.cgi?id=745030 "RESOLVED FIXED - Refactor nsObjectLoadingContent") mean we don't actually need to export this function via the IDL

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a144179248_12352)â€¢ 13 years ago |

[Attachment #634674](/attachment.cgi?id=634674&action=edit "Backout of 15") -
Flags: review?(jst) â†’ review+

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a144179263_12352)â€¢ 13 years ago |

[Attachment #634675](/attachment.cgi?id=634675&action=edit "Backout of 16") -
Flags: review?(jst) â†’ review+

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=406541#c61)â€¢ 13 years ago |
|  | |

Comment on [attachment 634674](/attachment.cgi?id=634674 "Backout of 15") [[details]](/attachment.cgi?id=634674&action=edit "Backout of 15") [[diff]](/attachment.cgi?id=634674&action=diff "Backout of 15") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=634674)
Backout of 15
Thanks John and Johnny. Approving for Aurora 15 given r+ and the above risk assessment.
[Attachment #634674](/attachment.cgi?id=634674&action=edit "Backout of 15") -
Flags: approval-mozilla-aurora? â†’ approval-mozilla-aurora+

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=406541#c62)â€¢ 13 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/419408a8db2f>
<https://hg.mozilla.org/mozilla-central/rev/47f814827db6>Status: RESOLVED â†’ REOPENED
[status-firefox14](/buglist.cgi?f1=cf_status_firefox14&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox14&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox14&o1=equals&v1=wontfix)
[status-firefox15](/buglist.cgi?f1=cf_status_firefox15&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=fixed) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=wontfix)
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=fixed) â†’ [affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected)Resolution: FIXED â†’ ---

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a144671858_429621)â€¢ 13 years ago |

No longer blocks: [738396](/show_bug.cgi?id=738396 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system")Depends on: [738396](/show_bug.cgi?id=738396 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a145382933_1689)â€¢ 13 years ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=406541#c63)â€¢ 12 years ago |
|  | |

Just to clarify, this was reopened because the last checkin here was a backout. There's a new version of this fix coming, but that builds on some significant changes that were needed in order to be able to fix this sanely.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a150893648_1689)â€¢ 12 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=wontfix)
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix)
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
--- â†’ [fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed)
[tracking-firefox16](/buglist.cgi?f1=cf_tracking_firefox16&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=%2B) â†’ [-](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=-)
[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a160506949_280903)â€¢ 12 years ago |

Whiteboard: [sg:moderate] â†’ [sg:moderate][adv-track18+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a160563364_280903)â€¢ 12 years ago |

Whiteboard: [sg:moderate][adv-track18+] â†’ [sg:moderate][adv-main18+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a160578527_280903)â€¢ 12 years ago |

Alias: CVE-2013-0749

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=406541#c64)â€¢ 12 years ago |
|  | |

Hang on, why was this marked fixed in 18? AFAIK this is still an issue, along with [bug 738396](/show_bug.cgi?id=738396 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system"). [Bug 745030](/show_bug.cgi?id=745030 "RESOLVED FIXED - Refactor nsObjectLoadingContent") and it's follow-ups make this possible to fix sanely, but any fix could not be landed on esr10, so nothing has been pushed yet.
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=fixed) â†’ [affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 65](/show_bug.cgi?id=406541#c65)â€¢ 12 years ago |
|  | |

Removing CVE number and advisory tags.Alias: CVE-2013-0749Whiteboard: [sg:moderate][adv-main18+] â†’ [sg:moderate]

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a160582930_425645)â€¢ 12 years ago |

[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=wontfix)

|  | [Johnny Stenback (:jst)](/user_profile?user_id=12352) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a167232391_12352)â€¢ 12 years ago |

Component: Security â†’ Plug-ins

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 66](/show_bug.cgi?id=406541#c66)â€¢ 12 years ago |
|  | |

[Bug 738396](/show_bug.cgi?id=738396 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system") fixes most of the codebase handling issues here, so all we need to fix this is the proper same-directory policy for file:/// URIs

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a168249788_429621)â€¢ 12 years ago |

[Attachment #634675](/attachment.cgi?id=634675&action=edit "Backout of 16") -
Attachment is obsolete: true

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a168249793_429621)â€¢ 12 years ago |

[Attachment #634674](/attachment.cgi?id=634674&action=edit "Backout of 15") -
Attachment is obsolete: true

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a168249798_429621)â€¢ 12 years ago |

[Attachment #629267](/attachment.cgi?id=629267&action=edit "Backout of aurora (14) for regressions") -
Attachment is obsolete: true

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a168249802_429621)â€¢ 12 years ago |

[Attachment #614666](/attachment.cgi?id=614666&action=edit "aurora backout of the fix + followup in this bug.") -
Attachment is obsolete: true

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a168249834_429621)â€¢ 12 years ago |

[Attachment #602486](/attachment.cgi?id=602486&action=edit "[checkin-needed] Followup - Handle failed URI creation, fix typo. r=bzbarsky") -
Attachment is obsolete: true

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 67](/show_bug.cgi?id=406541#c67)â€¢ 12 years ago |
|  | |

Comment on [attachment 601053](/attachment.cgi?id=601053 "Ensure we agree with java on applet codebase, and run security checks for file: codebase URIs. r=jst") [[details]](/attachment.cgi?id=601053&action=edit "Ensure we agree with java on applet codebase, and run security checks for file: codebase URIs. r=jst") [[diff]](/attachment.cgi?id=601053&action=diff "Ensure we agree with java on applet codebase, and run security checks for file: codebase URIs. r=jst") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=601053)
Ensure we agree with java on applet codebase, and run security checks for file: codebase URIs. r=jst
This needs a new approach based on [bug 745030](/show_bug.cgi?id=745030 "RESOLVED FIXED - Refactor nsObjectLoadingContent") and [bug 738396](/show_bug.cgi?id=738396 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system")
[Attachment #601053](/attachment.cgi?id=601053&action=edit "Ensure we agree with java on applet codebase, and run security checks for file: codebase URIs. r=jst") -
Attachment is obsolete: true

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a168249983_429621)â€¢ 12 years ago |

[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
--- â†’ [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected)
[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=wontfix) â†’ ---
[status-firefox11](/buglist.cgi?f1=cf_status_firefox11&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox11&o1=equals&v1=wontfix) â†’ ---
[status-firefox12](/buglist.cgi?f1=cf_status_firefox12&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox12&o1=equals&v1=wontfix) â†’ ---
[status-firefox13](/buglist.cgi?f1=cf_status_firefox13&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox13&o1=equals&v1=wontfix) â†’ ---
[status-firefox14](/buglist.cgi?f1=cf_status_firefox14&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox14&o1=equals&v1=wontfix) â†’ ---
[status-firefox15](/buglist.cgi?f1=cf_status_firefox15&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox15&o1=equals&v1=wontfix) â†’ ---
[status-firefox16](/buglist.cgi?f1=cf_status_firefox16&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix) â†’ ---
[status-firefox17](/buglist.cgi?f1=cf_status_firefox17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=affected) â†’ ---
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=wontfix) â†’ ---
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=wontfix)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected)
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected)
[status-firefox23](/buglist.cgi?f1=cf_status_firefox23&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=affected)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a168250567_406194)â€¢ 12 years ago |

[tracking-firefox14](/buglist.cgi?f1=cf_tracking_firefox14&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox14&o1=equals&v1=%2B) â†’ ---
[tracking-firefox15](/buglist.cgi?f1=cf_tracking_firefox15&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox15&o1=equals&v1=%2B) â†’ ---
[tracking-firefox16](/buglist.cgi?f1=cf_tracking_firefox16&o1=isnotempty):
[-](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=-) â†’ ---
[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B) â†’ ---

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 68](/show_bug.cgi?id=406541#c68)â€¢ 12 years ago |
|  | |

Attached patch

[Add an allowFileDirectories argument to nsPrincipal::CheckMayLoad](attachment.cgi?id=733642&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=733642&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=733642)

Allows us to do same origin file checking while bypassing the no-directories rule

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 69](/show_bug.cgi?id=406541#c69)â€¢ 12 years ago |
|  | |

Attached patch

[Add check for java file codebase security](attachment.cgi?id=733644&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=733644&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=733644)

Based on the patches in [bug 738396](/show_bug.cgi?id=738396 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system") -- add a same origin check to the codebase if the plugin is java and the codebase is a file URI

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 70](/show_bug.cgi?id=406541#c70)â€¢ 12 years ago |
|  | |

Attached patch

[[Fold into patch on branches] Move strict file origin checking blob into nsOBJLC](attachment.cgi?id=733645&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=733645&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=733645)

We presumably wont want to land the CheckMayLoad change on branches, this just duplicates that code into ObjectLoadingContent minus the directory check. This patch would be landed into the add-codebase-check patch on branches only.

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 71](/show_bug.cgi?id=406541#c71)â€¢ 12 years ago |
|  | |

Attached patch

[Test](attachment.cgi?id=755520&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=755520&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=755520)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 72](/show_bug.cgi?id=406541#c72)â€¢ 12 years ago |
|  | |

Comment on [attachment 733642](/attachment.cgi?id=733642 "Add an allowFileDirectories argument to nsPrincipal::CheckMayLoad") [[details]](/attachment.cgi?id=733642&action=edit "Add an allowFileDirectories argument to nsPrincipal::CheckMayLoad") [[diff]](/attachment.cgi?id=733642&action=diff "Add an allowFileDirectories argument to nsPrincipal::CheckMayLoad") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=733642)
Add an allowFileDirectories argument to nsPrincipal::CheckMayLoad
bz, would you be the right person to review this?
[Attachment #733642](/attachment.cgi?id=733642&action=edit "Add an allowFileDirectories argument to nsPrincipal::CheckMayLoad") -
Flags: review?(bzbarsky)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 73](/show_bug.cgi?id=406541#c73)â€¢ 12 years ago |
|  | |

Comment on [attachment 733644](/attachment.cgi?id=733644 "Add check for java file codebase security") [[details]](/attachment.cgi?id=733644&action=edit "Add check for java file codebase security") [[diff]](/attachment.cgi?id=733644&action=diff "Add check for java file codebase security") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=733644)
Add check for java file codebase security
Based on the fixes in [bug 738396](/show_bug.cgi?id=738396 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system") - do a same-origin check on file URIs to enforce our strict file origin policy (but note that we don't same-origin check java otherwise :-/)
[Attachment #733644](/attachment.cgi?id=733644&action=edit "Add check for java file codebase security") -
Flags: review?(benjamin)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 74](/show_bug.cgi?id=406541#c74)â€¢ 12 years ago |
|  | |

Comment on [attachment 733645](/attachment.cgi?id=733645 "[Fold into patch on branches] Move strict file origin checking blob into nsOBJLC") [[details]](/attachment.cgi?id=733645&action=edit "[Fold into patch on branches] Move strict file origin checking blob into nsOBJLC") [[diff]](/attachment.cgi?id=733645&action=diff "[Fold into patch on branches] Move strict file origin checking blob into nsOBJLC") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=733645)
[Fold into patch on branches] Move strict file origin checking blob into nsOBJLC
If we take this on any branches we probably wont want to uplift the CheckMayLoad() change - this just duplicates some same-file-origin policy code into ObjectLoadingContent for branches only.
[Attachment #733645](/attachment.cgi?id=733645&action=edit "[Fold into patch on branches] Move strict file origin checking blob into nsOBJLC") -
Flags: review?(benjamin)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 75](/show_bug.cgi?id=406541#c75)â€¢ 12 years ago |
|  | |

Comment on [attachment 755520](/attachment.cgi?id=755520 "Test") [[details]](/attachment.cgi?id=755520&action=edit "Test") [[diff]](/attachment.cgi?id=755520&action=diff "Test") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=755520)
Test
Test that java plugins whose codebase violates the strict file origin policy don't spawn.
[Attachment #755520](/attachment.cgi?id=755520&action=edit "Test") -
Flags: review?(benjamin)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a173186762_429621)â€¢ 12 years ago |

[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=wontfix)
[status-firefox24](/buglist.cgi?f1=cf_status_firefox24&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=affected)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a173187056_429621)â€¢ 12 years ago |

Target Milestone: mozilla14 â†’ ---

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 76](/show_bug.cgi?id=406541#c76)â€¢ 12 years ago |
|  | |

Why do we need that CheckMayLoad change, exactly?Flags: needinfo?(jschoenick)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 77](/show_bug.cgi?id=406541#c77)â€¢ 12 years ago |
|  | |

(In reply to Boris Zbarsky (:bz) from [comment #76](/show_bug.cgi?id=406541#c76 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances"))
> Why do we need that CheckMayLoad change, exactly?
We want to do a same origin check for java's codebase value when it is on the local filesystem, to enforce our strict file origin checks, but it needs to allow directory targets. We could move the strict file origin stuff out of CheckMayLoad to another utility function, but it constitutes the bulk of the function and didn't really seem any less messy. If you have a suggestion for a cleaner way I'm more than willing to rework it.Flags: needinfo?(jschoenick)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 78](/show_bug.cgi?id=406541#c78)â€¢ 12 years ago |
|  | |

So the codebase can be a directory?
I would rather have some sort of utility function called from both places, honestly, since CheckMayLoad() is really supposed to be about loading things and that's not what we're doing here. Unless we need logic from CheckMayLoad other than the file:// handling?

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 79](/show_bug.cgi?id=406541#c79)â€¢ 12 years ago |
|  | |

(In reply to Boris Zbarsky (:bz) from [comment #78](/show_bug.cgi?id=406541#c78 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances"))
> So the codebase can be a directory?
>
> I would rather have some sort of utility function called from both places,
> honestly, since CheckMayLoad() is really supposed to be about loading things
> and that's not what we're doing here. Unless we need logic from
> CheckMayLoad other than the file:// handling?
The problem is java assumes everything under codebase is fair game for it to load, but doesn't go through us to open channels, so checking that the page may load that base URI is as close as we can get.
We normally skip the same-origin check, but we want to do the strict file same-origin check in the case of file:// URIs, which is what CheckMayLoad is enforcing.
However, CheckMayLoad is now basically a wrapper around SecurityCompareURIs that also implements strict file origin. If we split it out, All that would remain of CheckMayLoad would be:
> NS\_IMETHODIMP
> nsPrincipal::CheckMayLoad(nsIURI\* aURI, bool aReport, bool aAllowIfInheritsPrincipal)
> {
> if (aAllowIfInheritsPrincipal) {
> // If the caller specified to allow loads of URIs that inherit
> // our principal, allow the load if this URI inherits its principal
> if (nsPrincipal::IsPrincipalInherited(aURI)) {
> return NS\_OK;
> }
> }
>
> if (!nsScriptSecurityManager::SecurityCompareURIs(mCodebase, aURI) && !CheckStrictFileOriginPolicy()) {
> return NS\_ERROR\_DOM\_BAD\_URI;
> }
>
> return NS\_OK;
> }
So assuming that SecurityCompareURIs is going to succeed on two file:// URIs, the other checks are redundant. Though, if we did add some additional file restrictions to SecurityCompareURIs at some point, we would conceivably want them to apply here.
Perhaps CheckMayLoad should just be merged with SecurityCompareURIs? Or the strict-file-origin policy moved to SecurityCompareURIs instead of CheckMayLoad?

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Comment 80](/show_bug.cgi?id=406541#c80)â€¢ 12 years ago |
|  | |

Could we just disallow java on file: URIs completely (behind a pref, I guess)?

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 81](/show_bug.cgi?id=406541#c81)â€¢ 12 years ago |
|  | |

> So assuming that SecurityCompareURIs is going to succeed on two file:// URIs
It's not. It's going to fail on two distinct file:// URIs if the file origin policy is strict. The CheckStrictFileOriginPolicy() bit actually allows the check to pass even though two different file:// URIs are normally considered different origins.
> Perhaps CheckMayLoad should just be merged with SecurityCompareURIs?
No, because SecurityCompareURIs is a stricter and symmetric check while CheckMayLoad is a looser and asymmetric check.
> All that would remain of CheckMayLoad would be:
That seems perfectly reasonable to me if we have a second consumer who in fact wants the modified CheckMayLoad file://-related behavior there.

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 82](/show_bug.cgi?id=406541#c82)â€¢ 12 years ago |
|  | |

Comment on [attachment 733642](/attachment.cgi?id=733642 "Add an allowFileDirectories argument to nsPrincipal::CheckMayLoad") [[details]](/attachment.cgi?id=733642&action=edit "Add an allowFileDirectories argument to nsPrincipal::CheckMayLoad") [[diff]](/attachment.cgi?id=733642&action=diff "Add an allowFileDirectories argument to nsPrincipal::CheckMayLoad") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=733642)
Add an allowFileDirectories argument to nsPrincipal::CheckMayLoad
(In reply to Benjamin Smedberg [:bsmedberg] from [comment #80](/show_bug.cgi?id=406541#c80 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances"))
> Could we just disallow java on file: URIs completely (behind a pref, I
> guess)?
With the work on [bug 738396](/show_bug.cgi?id=738396 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system") this is actually not too hard to fix, changes to CheckMayLoad aside. If java behaves and stays confined to its codebase its risk shouldn't be any higher than on a site, though it is java...
(In reply to Boris Zbarsky (:bz) from [comment #81](/show_bug.cgi?id=406541#c81 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances"))
> > So assuming that SecurityCompareURIs is going to succeed on two file:// URIs
>
> It's not. It's going to fail on two distinct file:// URIs if the file
> origin policy is strict. The CheckStrictFileOriginPolicy() bit actually
> allows the check to pass even though two different file:// URIs are normally
> considered different origins.
>
> > Perhaps CheckMayLoad should just be merged with SecurityCompareURIs?
>
> No, because SecurityCompareURIs is a stricter and symmetric check while
> CheckMayLoad is a looser and asymmetric check.
>
> > All that would remain of CheckMayLoad would be:
>
> That seems perfectly reasonable to me if we have a second consumer who in
> fact wants the modified CheckMayLoad file://-related behavior there.
Okay, that sounds sane then. Do you have any preference as to where this should live?
[Attachment #733642](/attachment.cgi?id=733642&action=edit "Add an allowFileDirectories argument to nsPrincipal::CheckMayLoad") -
Flags: review?(bzbarsky)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 83](/show_bug.cgi?id=406541#c83)â€¢ 12 years ago |
|  | |

Comment on [attachment 733645](/attachment.cgi?id=733645 "[Fold into patch on branches] Move strict file origin checking blob into nsOBJLC") [[details]](/attachment.cgi?id=733645&action=edit "[Fold into patch on branches] Move strict file origin checking blob into nsOBJLC") [[diff]](/attachment.cgi?id=733645&action=diff "[Fold into patch on branches] Move strict file origin checking blob into nsOBJLC") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=733645)
[Fold into patch on branches] Move strict file origin checking blob into nsOBJLC
This patch is just duplicating the strict file origin code into nsObjectLoadingContent for branches only, it'll remain necessary independent of how we factor it on trunk
[Attachment #733645](/attachment.cgi?id=733645&action=edit "[Fold into patch on branches] Move strict file origin checking blob into nsOBJLC") -
Attachment description: [Fold into patch on branches] Move CheckMayLoad blob into nsOBJLC â†’ [Fold into patch on branches] Move strict file origin checking blob into nsOBJLC

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 84](/show_bug.cgi?id=406541#c84)â€¢ 12 years ago |
|  | |

If we can put the file:// bits in nsNetUtil, I would vote there, but I haven't read them that carefully... Failing that, nsContentUtils?

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a173601593_7044)â€¢ 12 years ago |

[Attachment #733644](/attachment.cgi?id=733644&action=edit "Add check for java file codebase security") -
Flags: review?(benjamin) â†’ review+

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a173601642_7044)â€¢ 12 years ago |

[Attachment #733645](/attachment.cgi?id=733645&action=edit "[Fold into patch on branches] Move strict file origin checking blob into nsOBJLC") -
Flags: review?(benjamin) â†’ review+

|  | [Benjamin Smedberg](/user_profile?user_id=7044) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a173601683_7044)â€¢ 12 years ago |

[Attachment #755520](/attachment.cgi?id=755520&action=edit "Test") -
Flags: review?(benjamin) â†’ review+

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 85](/show_bug.cgi?id=406541#c85)â€¢ 12 years ago |
|  | |

Attached patch

[Add NS\_URIIsLocalFile and NS\_CheckStrictFileOriginPolicy](attachment.cgi?id=758043&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=758043&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758043)

Add these bits to nsNetUtil. URIIsLocalFile is wanted by nsObjectLoadingContent when it is doing the checks, so I promoted it as well.
[Attachment #733642](/attachment.cgi?id=733642&action=edit "Add an allowFileDirectories argument to nsPrincipal::CheckMayLoad") -
Attachment is obsolete: true
[Attachment #758043](/attachment.cgi?id=758043&action=edit "Add NS_URIIsLocalFile and NS_CheckStrictFileOriginPolicy") -
Flags: review?(bzbarsky)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 86](/show_bug.cgi?id=406541#c86)â€¢ 12 years ago |
|  | |

Attached patch

[Use NS\_CheckStrictOriginPolicy in CheckMayLoad](attachment.cgi?id=758046&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=758046&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758046)

Split out to avoid touching this on branches.
[Attachment #733645](/attachment.cgi?id=733645&action=edit "[Fold into patch on branches] Move strict file origin checking blob into nsOBJLC") -
Attachment is obsolete: true
[Attachment #758046](/attachment.cgi?id=758046&action=edit "Use NS_CheckStrictOriginPolicy in CheckMayLoad") -
Flags: review?(bzbarsky)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 87](/show_bug.cgi?id=406541#c87)â€¢ 12 years ago |
|  | |

Attached patch

[Add check for java file codebase security. r=bsmedberg](attachment.cgi?id=758053&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=758053&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758053)

Use NS\_CheckStrictFileOriginPolicy instead of CheckMayLoad, carrying over r+
[Attachment #733644](/attachment.cgi?id=733644&action=edit "Add check for java file codebase security") -
Attachment is obsolete: true

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a173694783_429621)â€¢ 12 years ago |

[Attachment #758053](/attachment.cgi?id=758053&action=edit "Add check for java file codebase security. r=bsmedberg") -
Flags: review+

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 88](/show_bug.cgi?id=406541#c88)â€¢ 12 years ago |
|  | |

Comment on [attachment 758043](/attachment.cgi?id=758043 "Add NS_URIIsLocalFile and NS_CheckStrictFileOriginPolicy") [[details]](/attachment.cgi?id=758043&action=edit "Add NS_URIIsLocalFile and NS_CheckStrictFileOriginPolicy") [[diff]](/attachment.cgi?id=758043&action=diff "Add NS_URIIsLocalFile and NS_CheckStrictFileOriginPolicy") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758043)
Add NS\_URIIsLocalFile and NS\_CheckStrictFileOriginPolicy
>+ MOZ\_ASSERT(util, "should have netutil");
Then why do we null-check it later?
>+NS\_CheckStrictFileOriginPolicy(nsIURI \*aURI,
This should probably be called NS\_RelaxStrictFileOriginPolicy.
And aURI should be aTargetURI, while aCodebaseURI is aSourceURI, I think, with appropriate renaming for fileURL, codebaseFileURL, codebaseIsDir, codebaseFile, codebaseParent. Otherwise it's not clear what's going on with this check; recall that this is an \_asymmetric\_ check, so the order of arguments is very important. Worth documenting exactly what this function is meant for and what the arguments mean.
For example, your call to this function in the other patch got the order backwards... Which would have been easier to notice if the two changes had been in the same patch, by the way. That way blame would be easier to track too. Please do combine the patches like that.
>+ (!aAllowDirectoryURIs &&
>+ (NS\_FAILED(targetFile->IsDirectory(&targetIsDir)) || targetIsDir))) {
That second line needs to be indented one more space.
r=me with the above fixed.
[Attachment #758043](/attachment.cgi?id=758043&action=edit "Add NS_URIIsLocalFile and NS_CheckStrictFileOriginPolicy") -
Flags: review?(bzbarsky) â†’ review+

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 89](/show_bug.cgi?id=406541#c89)â€¢ 12 years ago |
|  | |

Comment on [attachment 758046](/attachment.cgi?id=758046 "Use NS_CheckStrictOriginPolicy in CheckMayLoad") [[details]](/attachment.cgi?id=758046&action=edit "Use NS_CheckStrictOriginPolicy in CheckMayLoad") [[diff]](/attachment.cgi?id=758046&action=diff "Use NS_CheckStrictOriginPolicy in CheckMayLoad") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758046)
Use NS\_CheckStrictOriginPolicy in CheckMayLoad
This gets the check backwards. And this should be part of the patch that adds the new method anyway, I think.
[Attachment #758046](/attachment.cgi?id=758046&action=edit "Use NS_CheckStrictOriginPolicy in CheckMayLoad") -
Flags: review?(bzbarsky) â†’ review-

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 90](/show_bug.cgi?id=406541#c90)â€¢ 12 years ago |
|  | |

Attached patch

[Split NS\_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad](attachment.cgi?id=758243&action=diff)
â€” [Details](attachment.cgi?id=758243&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758243)

I made enough changes to this that I'd appreciate a second look, this would be bad code to make a mistake in (like swapping argument orders)
(In reply to Boris Zbarsky (:bz) from [comment #88](/show_bug.cgi?id=406541#c88 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances"))
> Comment on [attachment 758043](/attachment.cgi?id=758043 "Add NS_URIIsLocalFile and NS_CheckStrictFileOriginPolicy") [[details]](/attachment.cgi?id=758043&action=edit "Add NS_URIIsLocalFile and NS_CheckStrictFileOriginPolicy") [[diff]](/attachment.cgi?id=758043&action=diff "Add NS_URIIsLocalFile and NS_CheckStrictFileOriginPolicy") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758043)
> Add NS\_URIIsLocalFile and NS\_CheckStrictFileOriginPolicy
>
> >+ MOZ\_ASSERT(util, "should have netutil");
>
> Then why do we null-check it later?
Removed
> >+NS\_CheckStrictFileOriginPolicy(nsIURI \*aURI,
>
> This should probably be called NS\_RelaxStrictFileOriginPolicy.
>
> And aURI should be aTargetURI, while aCodebaseURI is aSourceURI, I think,
> with appropriate renaming for fileURL, codebaseFileURL, codebaseIsDir,
> codebaseFile, codebaseParent. Otherwise it's not clear what's going on with
> this check; recall that this is an \_asymmetric\_ check, so the order of
> arguments is very important. Worth documenting exactly what this function
> is meant for and what the arguments mean.
I renamed these as such, and added an explanatory comment
> For example, your call to this function in the other patch got the order
> backwards... Which would have been easier to notice if the two changes had
> been in the same patch, by the way. That way blame would be easier to track
> too. Please do combine the patches like that.
I originally split these such that CheckMayLoad could be unchanged should we land this on branches, but we can split it if deemed necessary at that point.
> >+ (!aAllowDirectoryURIs &&
> >+ (NS\_FAILED(targetFile->IsDirectory(&targetIsDir)) || targetIsDir))) {
>
> That second line needs to be indented one more space.
>
> r=me with the above fixed.
(In reply to Boris Zbarsky (:bz) from [comment #89](/show_bug.cgi?id=406541#c89 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances"))
> Comment on [attachment 758046](/attachment.cgi?id=758046 "Use NS_CheckStrictOriginPolicy in CheckMayLoad") [[details]](/attachment.cgi?id=758046&action=edit "Use NS_CheckStrictOriginPolicy in CheckMayLoad") [[diff]](/attachment.cgi?id=758046&action=diff "Use NS_CheckStrictOriginPolicy in CheckMayLoad") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758046)
> Use NS\_CheckStrictOriginPolicy in CheckMayLoad
>
> This gets the check backwards. And this should be part of the patch that
> adds the new method anyway, I think.
Indeed it does, I had swapped the argument order to the call at one point and neglected to update the callers. However, while trying to figure out why my test didn't catch this, I found that nsIFile::Contains() recursion argument is ignored now, so we actually don't implement file same origin policy as described at:
[https://developer.mozilla.org/en-US/docs/Same-origin\_policy\_for\_file:\_URIs](https://developer.mozilla.org/en-US/docs/Same-origin_policy_for_file%3A_URIs) -- I'll open a followup for this
[Attachment #758043](/attachment.cgi?id=758043&action=edit "Add NS_URIIsLocalFile and NS_CheckStrictFileOriginPolicy") -
Attachment is obsolete: true
[Attachment #758046](/attachment.cgi?id=758046&action=edit "Use NS_CheckStrictOriginPolicy in CheckMayLoad") -
Attachment is obsolete: true
[Attachment #758243](/attachment.cgi?id=758243&action=edit "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") -
Flags: review?(bzbarsky)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 91](/show_bug.cgi?id=406541#c91)â€¢ 12 years ago |
|  | |

Attached patch

[Add check for java file codebase security. r=bsmedberg](attachment.cgi?id=758249&action=diff)
â€” [Details](attachment.cgi?id=758249&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758249)

[Attachment #758053](/attachment.cgi?id=758053&action=edit "Add check for java file codebase security. r=bsmedberg") -
Attachment is obsolete: true

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a173708985_429621)â€¢ 12 years ago |

[Attachment #758249](/attachment.cgi?id=758249&action=edit "Add check for java file codebase security. r=bsmedberg") -
Flags: review+

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 92](/show_bug.cgi?id=406541#c92)â€¢ 12 years ago |
|  | |

Comment on [attachment 758243](/attachment.cgi?id=758243 "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") [[details]](/attachment.cgi?id=758243&action=edit "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") [[diff]](/attachment.cgi?id=758243&action=diff "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758243)
Split NS\_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad
This looks great. r=me, and sorry for the lag....
[Attachment #758243](/attachment.cgi?id=758243&action=edit "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") -
Flags: review?(bzbarsky) â†’ review+

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 93](/show_bug.cgi?id=406541#c93)â€¢ 12 years ago |
|  | |

Comment on [attachment 758249](/attachment.cgi?id=758249 "Add check for java file codebase security. r=bsmedberg") [[details]](/attachment.cgi?id=758249&action=edit "Add check for java file codebase security. r=bsmedberg") [[diff]](/attachment.cgi?id=758249&action=diff "Add check for java file codebase security. r=bsmedberg") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758249)
Add check for java file codebase security. r=bsmedberg
[Security approval request comment]
This is just an enhancement on top of [bug 738396](/show_bug.cgi?id=738396 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system") to enforce our file origin policy to java's codebase for sites loaded from a file URI:
[https://developer.mozilla.org/en-US/docs/Same-origin\_policy\_for\_file:\_URIs](https://developer.mozilla.org/en-US/docs/Same-origin_policy_for_file%3A_URIs)
It requires 738396, but does not introduce any significant risk on top of it.
How easily could an exploit be constructed based on the patch?
The only functional change is an explicit check for file strict origin policy for java codebase, so pretty easily.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
A new comment explains the check, which is pretty obvious regardless.
Which older supported branches are affected by this flaw?
All, but not relevant to b2g where java is not present.
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
Should not be difficult to rebase on all branches where 738396 lands
How likely is this patch to cause regressions; how much testing does it need?
Fairly low, only adds one additional check to java's codebase, and only when loading a local file:/// URI. Might break some odd enterprise setups that involve running java on the local disk, but there is already a pref to disable strict file origin checking.
[Attachment #758249](/attachment.cgi?id=758249&action=edit "Add check for java file codebase security. r=bsmedberg") -
Flags: sec-approval?

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a173869215_429621)â€¢ 12 years ago |

[Attachment #758243](/attachment.cgi?id=758243&action=edit "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") -
Flags: sec-approval?

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 94](/show_bug.cgi?id=406541#c94)â€¢ 12 years ago |
|  | |

Re-tracking now that there's a ready patch
[tracking-firefox22](/buglist.cgi?f1=cf_tracking_firefox22&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%3F)
[tracking-firefox23](/buglist.cgi?f1=cf_tracking_firefox23&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox23&o1=equals&v1=%3F)
[tracking-firefox24](/buglist.cgi?f1=cf_tracking_firefox24&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox24&o1=equals&v1=%3F)
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=%3F)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 95](/show_bug.cgi?id=406541#c95)â€¢ 12 years ago |
|  | |

Comment on [attachment 758249](/attachment.cgi?id=758249 "Add check for java file codebase security. r=bsmedberg") [[details]](/attachment.cgi?id=758249&action=edit "Add check for java file codebase security. r=bsmedberg") [[diff]](/attachment.cgi?id=758249&action=diff "Add check for java file codebase security. r=bsmedberg") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758249)
Add check for java file codebase security. r=bsmedberg
Sec-approval+ but since this is only a sec-moderate, it doesn't \*require\* sec-approval to go into trunk.
[Attachment #758249](/attachment.cgi?id=758249&action=edit "Add check for java file codebase security. r=bsmedberg") -
Flags: sec-approval? â†’ sec-approval+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a173880298_280903)â€¢ 12 years ago |

[Attachment #758243](/attachment.cgi?id=758243&action=edit "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") -
Flags: sec-approval? â†’ sec-approval+

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 96](/show_bug.cgi?id=406541#c96)â€¢ 12 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #95](/show_bug.cgi?id=406541#c95 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances"))
> Sec-approval+ but since this is only a sec-moderate, it doesn't \*require\*
> sec-approval to go into trunk.
Ack, good point.Whiteboard: [sg:moderate] â†’ [waiting on 738396 landing]

|  | [bhavana bajaj [:bajaj]](/user_profile?user_id=448925) |  |
| --- | --- | --- |
| [Comment 97](/show_bug.cgi?id=406541#c97)â€¢ 12 years ago |
|  | |

Tracking the issue due to the risk called out in [comment #93](/show_bug.cgi?id=406541#c93 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances") and already marking it as wontfix as it looks like the dependent [bug 738396](/show_bug.cgi?id=738396 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system") will be fixed on FX23.
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=wontfix)
[tracking-firefox22](/buglist.cgi?f1=cf_tracking_firefox22&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%3F) â†’ [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B)
[tracking-firefox23](/buglist.cgi?f1=cf_tracking_firefox23&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox23&o1=equals&v1=%3F) â†’ [+](/buglist.cgi?f1=cf_tracking_firefox23&o1=equals&v1=%2B)
[tracking-firefox24](/buglist.cgi?f1=cf_tracking_firefox24&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox24&o1=equals&v1=%3F) â†’ [+](/buglist.cgi?f1=cf_tracking_firefox24&o1=equals&v1=%2B)
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=%3F) â†’ [23+](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=23%2B)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 98](/show_bug.cgi?id=406541#c98)â€¢ 12 years ago |
|  | |

Comment on [attachment 758243](/attachment.cgi?id=758243 "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") [[details]](/attachment.cgi?id=758243&action=edit "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") [[diff]](/attachment.cgi?id=758243&action=diff "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758243)
Split NS\_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad
<https://hg.mozilla.org/integration/mozilla-inbound/rev/9eafe94ea972>
[Attachment #758243](/attachment.cgi?id=758243&action=edit "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") -
Flags: checkin+

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 99](/show_bug.cgi?id=406541#c99)â€¢ 12 years ago |
|  | |

Comment on [attachment 758249](/attachment.cgi?id=758249 "Add check for java file codebase security. r=bsmedberg") [[details]](/attachment.cgi?id=758249&action=edit "Add check for java file codebase security. r=bsmedberg") [[diff]](/attachment.cgi?id=758249&action=diff "Add check for java file codebase security. r=bsmedberg") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758249)
Add check for java file codebase security. r=bsmedberg
<https://hg.mozilla.org/integration/mozilla-inbound/rev/b06bd5858999>
[Attachment #758249](/attachment.cgi?id=758249&action=edit "Add check for java file codebase security. r=bsmedberg") -
Flags: checkin+

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a176133519_429621)â€¢ 12 years ago |

Whiteboard: [waiting on 738396 landing]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 100](/show_bug.cgi?id=406541#c100)â€¢ 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/9eafe94ea972>
<https://hg.mozilla.org/mozilla-central/rev/b06bd5858999>Status: REOPENED â†’ RESOLVEDClosed: 13 years ago â†’ 12 years ago
[status-firefox25](/buglist.cgi?f1=cf_status_firefox25&o1=isnotempty):
--- â†’ [fixed](/buglist.cgi?f1=cf_status_firefox25&o1=equals&v1=fixed)Flags: in-testsuite?Resolution: --- â†’ FIXEDTarget Milestone: --- â†’ mozilla25

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 101](/show_bug.cgi?id=406541#c101)â€¢ 12 years ago |
|  | |

Are we intending to uplift these to 23/24?Flags: needinfo?(jschoenick)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 102](/show_bug.cgi?id=406541#c102)â€¢ 12 years ago |
|  | |

Comment on [attachment 758249](/attachment.cgi?id=758249 "Add check for java file codebase security. r=bsmedberg") [[details]](/attachment.cgi?id=758249&action=edit "Add check for java file codebase security. r=bsmedberg") [[diff]](/attachment.cgi?id=758249&action=diff "Add check for java file codebase security. r=bsmedberg") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758249)
Add check for java file codebase security. r=bsmedberg
[Approval Request Comment]
Bug caused by (feature/regressing bug #):
Not a FF bug, works around java having lax security checks with file:/// URIs
User impact if declined:
sec-low - saving a malicious site locally, with embedded java applets, and then running it, would allow read-only access to the full filesystem.
Testing completed (on m-c, etc.):
On m-c
Risk to taking this patch (and alternatives if risky):
Low, the bulk of the patch is moving functions around to be accessible by plugin code, and additional checks are only done for sites running on file:/// URIs.
String or IDL/UUID changes made by this patch:
None
[Attachment #758249](/attachment.cgi?id=758249&action=edit "Add check for java file codebase security. r=bsmedberg") -
Flags: approval-mozilla-beta?
[Attachment #758249](/attachment.cgi?id=758249&action=edit "Add check for java file codebase security. r=bsmedberg") -
Flags: approval-mozilla-aurora?

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 103](/show_bug.cgi?id=406541#c103)â€¢ 12 years ago |
|  | |

Comment on [attachment 758243](/attachment.cgi?id=758243 "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") [[details]](/attachment.cgi?id=758243&action=edit "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") [[diff]](/attachment.cgi?id=758243&action=diff "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758243)
Split NS\_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad
see [comment 102](/show_bug.cgi?id=406541#c102 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances")
[Attachment #758243](/attachment.cgi?id=758243&action=edit "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") -
Flags: approval-mozilla-beta?
[Attachment #758243](/attachment.cgi?id=758243&action=edit "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") -
Flags: approval-mozilla-aurora?

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 104](/show_bug.cgi?id=406541#c104)â€¢ 12 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM UTC-4] from [comment #101](/show_bug.cgi?id=406541#c101 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances"))
> Are we intending to uplift these to 23/24?
beat me by 11 seconds :-PFlags: needinfo?(jschoenick)

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a176298557_272375)â€¢ 12 years ago |

[Attachment #758249](/attachment.cgi?id=758249&action=edit "Add check for java file codebase security. r=bsmedberg") -
Flags: approval-mozilla-beta?
[Attachment #758249](/attachment.cgi?id=758249&action=edit "Add check for java file codebase security. r=bsmedberg") -
Flags: approval-mozilla-beta+
[Attachment #758249](/attachment.cgi?id=758249&action=edit "Add check for java file codebase security. r=bsmedberg") -
Flags: approval-mozilla-aurora?
[Attachment #758249](/attachment.cgi?id=758249&action=edit "Add check for java file codebase security. r=bsmedberg") -
Flags: approval-mozilla-aurora+

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a176298577_272375)â€¢ 12 years ago |

[Attachment #758243](/attachment.cgi?id=758243&action=edit "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") -
Flags: approval-mozilla-beta?
[Attachment #758243](/attachment.cgi?id=758243&action=edit "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") -
Flags: approval-mozilla-beta+
[Attachment #758243](/attachment.cgi?id=758243&action=edit "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") -
Flags: approval-mozilla-aurora?
[Attachment #758243](/attachment.cgi?id=758243&action=edit "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") -
Flags: approval-mozilla-aurora+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 105](/show_bug.cgi?id=406541#c105)â€¢ 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/462bf273f287>
<https://hg.mozilla.org/releases/mozilla-aurora/rev/3967f5179aab>
This doesn't apply cleanly to beta without [bug 738396](/show_bug.cgi?id=738396 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system"). I'll land it there once [bug 738396](/show_bug.cgi?id=738396 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system") gets ba+.
[status-b2g-v1.1hd](/buglist.cgi?f1=cf_status_b2g_1_1_hd&o1=isnotempty):
--- â†’ [unaffected](/buglist.cgi?f1=cf_status_b2g_1_1_hd&o1=equals&v1=unaffected)
[status-firefox24](/buglist.cgi?f1=cf_status_firefox24&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=fixed)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 106](/show_bug.cgi?id=406541#c106)â€¢ 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/fc3d9e72357b>
<https://hg.mozilla.org/releases/mozilla-beta/rev/363615b93e48>
[status-firefox23](/buglist.cgi?f1=cf_status_firefox23&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=fixed)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 107](/show_bug.cgi?id=406541#c107)â€¢ 12 years ago |
|  | |

Comment on [attachment 758249](/attachment.cgi?id=758249 "Add check for java file codebase security. r=bsmedberg") [[details]](/attachment.cgi?id=758249&action=edit "Add check for java file codebase security. r=bsmedberg") [[diff]](/attachment.cgi?id=758249&action=diff "Add check for java file codebase security. r=bsmedberg") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758249)
Add check for java file codebase security. r=bsmedberg
This was tracked for esr17, so nominating for a call on whether or not to uplift there -- See [comment 102](/show_bug.cgi?id=406541#c102 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances")
[Attachment #758249](/attachment.cgi?id=758249&action=edit "Add check for java file codebase security. r=bsmedberg") -
Flags: approval-mozilla-esr17?

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 108](/show_bug.cgi?id=406541#c108)â€¢ 12 years ago |
|  | |

Comment on [attachment 758243](/attachment.cgi?id=758243 "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") [[details]](/attachment.cgi?id=758243&action=edit "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") [[diff]](/attachment.cgi?id=758243&action=diff "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=758243)
Split NS\_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad
(see [comment 107](/show_bug.cgi?id=406541#c107 "RESOLVED FIXED - local java applet may read arbitrary files under certain circumstances"))
[Attachment #758243](/attachment.cgi?id=758243&action=edit "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") -
Flags: approval-mozilla-esr17?

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 109](/show_bug.cgi?id=406541#c109)â€¢ 12 years ago |
|  | |

Since this is sec-low, let's be risk averse.
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=wontfix)
[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
[23+](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=23%2B) â†’ [-](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=-)

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a177925355_425645)â€¢ 12 years ago |

[Attachment #758243](/attachment.cgi?id=758243&action=edit "Split NS_CheckStrictFileOriginPolicy out of nsPrincipal::CheckMayLoad") -
Flags: approval-mozilla-esr17? â†’ approval-mozilla-esr17-

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a178199758_280903)â€¢ 12 years ago |

Whiteboard: [adv-main23+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a178466560_280903)â€¢ 11 years ago |

Alias: CVE-2013-1717

|  | [bhavana bajaj [:bajaj]](/user_profile?user_id=448925) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a178482049_448925)â€¢ 11 years ago |

[Attachment #758249](/attachment.cgi?id=758249&action=edit "Add check for java file codebase security. r=bsmedberg") -
Flags: approval-mozilla-esr17? â†’ approval-mozilla-esr17-

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 110](/show_bug.cgi?id=406541#c110)â€¢ 11 years ago |
|  | |

Attached patch

[Test. r=bsmedberg](attachment.cgi?id=787151&action=diff) (obsolete)
â€” [Details](attachment.cgi?id=787151&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=787151)

Add third case to test for issue found by [bug 902375](/show_bug.cgi?id=902375 "VERIFIED FIXED - Firefox 23: The Load of a local java applet (*jar) fails silently").
This just adds a third applet tag to the existing logic, keeping r+

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a179237872_429621)â€¢ 11 years ago |

[Attachment #755520](/attachment.cgi?id=755520&action=edit "Test") -
Attachment is obsolete: true

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a179237887_429621)â€¢ 11 years ago |

[Attachment #787151](/attachment.cgi?id=787151&action=edit "Test. r=bsmedberg") -
Flags: review+

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a179238063_429621)â€¢ 11 years ago |

Depends on: [902375](/show_bug.cgi?id=902375 "VERIFIED FIXED - Firefox 23: The Load of a local java applet (*jar) fails silently")

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 111](/show_bug.cgi?id=406541#c111)â€¢ 11 years ago |
|  | |

@dveditz - Can this bug and [bug 738396](/show_bug.cgi?id=738396 "VERIFIED FIXED - Java applets may read arbitrary files on a user's system") have their test cases landed now that this is on all branches? (Is there a specific policy for test cases and other follow ups as such?)Flags: needinfo?(dveditz)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 112](/show_bug.cgi?id=406541#c112)â€¢ 11 years ago |
|  | |

John, please land the tests.
Generally, six to eight weeks after release of the fix to the public (or when the \*following\* release comes out) is the guideline.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 113](/show_bug.cgi?id=406541#c113)â€¢ 11 years ago |
|  | |

Yes that's fine now, we stopped supporting ESR-17 (where this isn't fixed) in December.Flags: needinfo?(dveditz)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 114](/show_bug.cgi?id=406541#c114)â€¢ 11 years ago |
|  | |

Attached patch

[Test. r=bsmedberg](attachment.cgi?id=8379262&action=diff)
â€” [Details](attachment.cgi?id=8379262&action=edit)
â€” [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=8379262)

Un-bitrotted
[Attachment #787151](/attachment.cgi?id=787151&action=edit "Test. r=bsmedberg") -
Attachment is obsolete: true
[Attachment #8379262](/attachment.cgi?id=8379262&action=edit "Test. r=bsmedberg") -
Flags: review+

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 115](/show_bug.cgi?id=406541#c115)â€¢ 11 years ago |
|  | |

Comment on [attachment 8379262](/attachment.cgi?id=8379262 "Test. r=bsmedberg") [[details]](/attachment.cgi?id=8379262&action=edit "Test. r=bsmedberg") [[diff]](/attachment.cgi?id=8379262&action=diff "Test. r=bsmedberg") [[review]](/page.cgi?id=splinter.html&ignore=&bug=406541&attachment=8379262)
Test. r=bsmedberg
Pushed test:
<https://hg.mozilla.org/integration/mozilla-inbound/rev/fb56bd7c0feb>
Try:
<https://tbpl.mozilla.org/?tree=Try&rev=fd55a944e195>
[Attachment #8379262](/attachment.cgi?id=8379262&action=edit "Test. r=bsmedberg") -
Flags: checkin+

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 116](/show_bug.cgi?id=406541#c116)â€¢ 11 years ago |
|  | |

I backed this (and everything else from that push to inbound) out in <http://hg.mozilla.org/integration/mozilla-inbound/rev/128cbf1edc40> due to various Java/plugin related failures they caused:
Crashtest failure: <https://tbpl.mozilla.org/php/getParsedLog.php?id=35003251&tree=Mozilla-Inbound>
XPCShell failure: <https://tbpl.mozilla.org/php/getParsedLog.php?id=35003355&tree=Mozilla-Inbound>

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a196267278_308534)â€¢ 11 years ago |

Flags: needinfo?(jschoenick)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 117](/show_bug.cgi?id=406541#c117)â€¢ 11 years ago |
|  | |

Attempt 2 at test:
<https://hg.mozilla.org/integration/mozilla-inbound/rev/277862f099a4>
Extensive try run since this push burned the tree before:
<https://tbpl.mozilla.org/?tree=Try&rev=b656bdd77ce1>Flags: needinfo?(jschoenick)

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 118](/show_bug.cgi?id=406541#c118)â€¢ 11 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/277862f099a4>
[status-firefox27](/buglist.cgi?f1=cf_status_firefox27&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_status_firefox27&o1=equals&v1=%3F)
[status-firefox28](/buglist.cgi?f1=cf_status_firefox28&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_status_firefox28&o1=equals&v1=%3F)
[status-firefox29](/buglist.cgi?f1=cf_status_firefox29&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_status_firefox29&o1=equals&v1=%3F)
[status-firefox30](/buglist.cgi?f1=cf_status_firefox30&o1=isnotempty):
--- â†’ [fixed](/buglist.cgi?f1=cf_status_firefox30&o1=equals&v1=fixed)

|  | [John Schoenick [:johns]](/user_profile?user_id=429621)  Assignee |  |
| --- | --- | --- |
| [Comment 119](/show_bug.cgi?id=406541#c119)â€¢ 11 years ago |
|  | |

This was fixed in 25, the additional landing here only applies to the mochitest
[status-firefox27](/buglist.cgi?f1=cf_status_firefox27&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox27&o1=equals&v1=%3F) â†’ ---
[status-firefox28](/buglist.cgi?f1=cf_status_firefox28&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox28&o1=equals&v1=%3F) â†’ ---
[status-firefox29](/buglist.cgi?f1=cf_status_firefox29&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox29&o1=equals&v1=%3F) â†’ ---
[status-firefox30](/buglist.cgi?f1=cf_status_firefox30&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox30&o1=equals&v1=fixed) â†’ ---Flags: in-testsuite? â†’ in-testsuite+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a219781200_1689)â€¢ 10 years ago |

Group: core-security

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=406541#a456055682_546015)â€¢ 3 years ago |

Product: Core â†’ Core Graveyard
You need to [log in](/show_bug.cgi?id=406541&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [georgi - hopefully not receiving bugspam](/user_profile?user_id=23768)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_3659d679_20250126_010146.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")â€Ž | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)


