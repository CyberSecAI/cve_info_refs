=== Content from bugzilla.mozilla.org_66f138f1_20250126_034951.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/811557)
* [XML](/show_bug.cgi?ctype=xml&id=811557)

Closed
[Bug 811557](/show_bug.cgi?id=811557)

Opened 12 years ago
Closed 12 years ago

# DLL Hijacking - Firefox Stub installer

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

DLL Hijacking - Firefox Stub installer

## Categories

### (Firefox :: Installer, defect)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=Installer#Installer)

Installer
▾

Firefox :: Installer
Bugs and feature requests for the Firefox application install wizard.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=Installer&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=Installer&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=Installer)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

Windows 7

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla24

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Install Update Workflow | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox16 | [-](/buglist.cgi?f1=cf_tracking_firefox16&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox16&o1=equals&v1=wontfix) |
| firefox17 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox17&o1=equals&v1=wontfix) |
| firefox18 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=wontfix) |
| firefox19 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix) |
| firefox20 | [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=wontfix) |
| firefox21 | [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=wontfix) |
| firefox22 | [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=verified) |
| firefox23 | [+](/buglist.cgi?f1=cf_tracking_firefox23&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=verified) |
| firefox24 | [+](/buglist.cgi?f1=cf_tracking_firefox24&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=verified) |
| firefox-esr10 | --- | [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected) |
| firefox-esr17 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected) |
| b2g18 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox16 | - | wontfix |
| firefox17 |  | wontfix |
| firefox18 |  | wontfix |
| firefox19 |  | wontfix |
| firefox20 | + | wontfix |
| firefox21 | + | wontfix |
| firefox22 | + | verified |
| firefox23 | + | verified |
| firefox24 | + | verified |
| firefox-esr10 |  | unaffected |
| firefox-esr17 |  | unaffected |
| b2g18 |  | unaffected |
| relnote-firefox |  | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: bbondy, Assigned: robert.strong.bugs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [robert.strong.bugs](/user_profile?user_id=141755)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/47d8644c0ad8d89635fca422dd6d3ab5?d=mm&size=40)  [bbondy](/user_profile?user_id=407790)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/50e82ef70720dfcf1385f583e34f9ba9?d=mm&size=40)  [erchen](/user_profile?user_id=753852)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

26 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[CVE-2012-4206](/show_bug.cgi?id=792106 "VERIFIED FIXED - DLL Hijacking - Firefox installer")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[CVE-2013-1715](/show_bug.cgi?id=883165 "VERIFIED FIXED - Medium integrity DLL Hijacking - Firefox Full installer and Stub installer"), [883322](/show_bug.cgi?id=883322 "RESOLVED FIXED - Medium integrity DLL Hijacking - Thunderbird and SeaMonkey Full installer")

Dependency [tree](/showdependencytree.cgi?id=811557&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=811557)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-priv-escalation, sec-high, verifyme, Whiteboard: [stub?][adv-main22-])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[stub?][adv-main22-]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 1 obsolete file)

| [Stub for testing](/attachment.cgi?id=747803)  [12 years ago](#c21)  [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)   630.44 KB, application/octet-stream |  | [Details](/attachment.cgi?id=747803&action=edit) |
| --- | --- | --- |
| [patch rev1](/attachment.cgi?id=757779)  [12 years ago](#c30)  [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)   6.44 KB, patch | bbondy : [review+](#c32 "12 years ago") | [Details](/attachment.cgi?id=757779&action=edit) | [Diff](/attachment.cgi?id=757779&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=811557&attachment=757779) |
| [patch rev2](/attachment.cgi?id=758155)  [12 years ago](#c33)  [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)   4.53 KB, patch | bbondy : [review+](#a17544388_407790 "12 years ago")  lsblakk : [approval-mozilla-aurora+](#a17778308_272375 "12 years ago")  lsblakk : [approval-mozilla-beta+](#a17778308_272375 "12 years ago")  abillings : [sec-approval+](#c36 "12 years ago") | [Details](/attachment.cgi?id=758155&action=edit) | [Diff](/attachment.cgi?id=758155&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=811557&attachment=758155) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=811557#c0)• 12 years ago |
|  | |

+++ This bug was initially created as a clone of [Bug #792106](/show_bug.cgi?id=792106 "VERIFIED FIXED - DLL Hijacking - Firefox installer") +++
This bug is to fix the stub installer.
A problem with this is that the below DLLs are loaded before the NSIS .onInit is called.
(In reply to Anthony Hughes, Mozilla QA (:ashughes) from [comment #141](/show_bug.cgi?id=811557#c141 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer"))
> Some results from testing last week. The following DLLs were found to have
> launched cmd.exe processes and are not listed as Known DLLs using the WinObj
> tool.
>
> Win32 Stub Installer
> \* cabinet.dll: Windows 7 64-bit, Windows 7 32-bit, Windows Vista 32-bit
> \* credssp.dll: Windows Vista 32-bit
> \* cryptbase.dll: Windows 7 32-bit
> \* cryptnet.dll: Windows 7 32-bit, Windows 7 64-bit
> \* cryptsp.dll: Windows 7 32-bit, Windows 7 64-bit, Windows Vista 32-bit
> \* devrtl.dll: Windows 7 32-bit, Windows 7 64-bit
> \* dnsapi.dll: Windows 7 32-bit, Windows 7 64-bit, Windows Vista 32-bit
> \* dwmapi.dll: Windows 7 64-bit
> \* gpapi.dll: Windows 7 32-bit, Windows 7 64-bit, Windows Vista 32-bit
> \* IPHLPAPI.dll: Windows 7 32-bit, Windows 7 64-bit, Windows Vista 32-bit
> \* linkinfo.dll: Windows Vista 32-bit
> \* ncrypt.dll: Windows 7 32-bit, Windows 7 64-bit, Windows Vista 32-bit
> \* netapi32.dll: Windows Vista 32-bit
> \* ntmarta.dll: Windows 7 64-bit, Windows Vista 32-bit
> \* ntshrui.dll: Windows Vista 32-bit
> \* profapi.dll: Windows 7 32-bit, Windows 7 64-bit
> \* propsys.dll: Windows Vista 32-bit
> \* rasadhlp.dll: Windows 7 32-bit, Windows 7 64-bit, Windows Vista 32-bit
> \* rasapi32.dll: Windows 7 64-bit, Windows Vista 32-bit
> \* riched20.dll: Windows 7 32-bit, Windows 7 64-bit, Windows Vista 32-bit
> \* RpcRtRemote.dll: Windows 7 64-bit, Windows Vista 32-bit
> \* rtutils.dll: Windows 7 32-bit, Windows 7 64-bit
> \* secur32.dll: Windows 7 32-bit, Windows 7 64-bit, Windows Vista 32-bit
> \* SensApi.dll: Windows 7 32-bit, Windows 7 64-bit, Windows Vista 32-bit
> \* shfolder.dll: Windows 7 64-bit, Windows Vista 32-bit
> \* SLC.dll: Windows Vista 32-bit
> \* userenv.dll: Windows 7 32-bit, Windows 7 64-bit
> \* uxtheme.dll: Windows Vista 32-bit
>
> Keep in mind that we are only a third of the way through testing. Though I
> suspect we've caught the lion's share of DLLs already (at least one would
> hope).
>
> Full results are being added here as we test:
> [https://intranet.mozilla.org/User:Ahughes@mozilla.com/DLL\_Hijacking](https://intranet.mozilla.org/User%3AAhughes%40mozilla.com/DLL_Hijacking)

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=811557#a71_407790)• 12 years ago |

[status-firefox-esr10](/buglist.cgi?f1=cf_status_esr10&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=affected) → [unaffected](/buglist.cgi?f1=cf_status_esr10&o1=equals&v1=unaffected)
[tracking-firefox-esr10](/buglist.cgi?f1=cf_tracking_esr10&o1=isnotempty):
[18+](/buglist.cgi?f1=cf_tracking_esr10&o1=equals&v1=18%2B) → ---
[tracking-firefox17](/buglist.cgi?f1=cf_tracking_firefox17&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox17&o1=equals&v1=%2B) → ---
[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B) → [?](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%3F)
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%3F)

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=811557#c1)• 12 years ago |
|  | |

So I think either a patch to makensis itself or add code to:
toolkit/mozapps/installer/windows/nsis/makensis.mk
which wraps the stub in a 7zip self extracting archive and then put extra fixes into the 7zip Main.

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=811557#c2)• 12 years ago |
|  | |

Patch NSIS and upstream.

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=811557#c3)• 12 years ago |
|  | |

We'll have to update all of our talos builders, is that OK? Or maybe we could just add makensis itself as a binary to the tree?

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=811557#c4)• 12 years ago |
|  | |

It is ok to update our build system as we did when we had to for NSIS 2.46. Let's talk about adding makensis to the tree though I must say that I am not leaning in that direction atm. If we were to add it then I would also say that we should add many other build tools that are currently in MozillaBuild.

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=811557#c5)• 12 years ago |
|  | |

OK so we can build 2.46 with scons and VS2005. Should we track the source code in mozilla-build? Or only upstream the patch and use our own build? Maybe just zip up the changed source code to this ticket after?

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=811557#c6)• 12 years ago |
|  | |

Tracking for FF18, in case we actually hit this release with the stub installer.
[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B)
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%2B)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=811557#c7)• 12 years ago |
|  | |

It is extremely unlikely we are going to have this fixed for 18 or 19 due to other work. If this is considered a high priority please let me know and we'll evaluate this work with other work in progress.

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=811557#c8)• 12 years ago |
|  | |

I believe QA has done all the testing required for the time being so I'm removing the qawanted/verifyme keywords. Please re-add if/when there is more needed from us.Keywords: [qawanted](/buglist.cgi?keywords=qawanted&resolution=---),
[verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=811557#c9)• 12 years ago |
|  | |

Has QA verified that the problems are fixed on the mentioned branches? It would be good to go over the affected DLLs only, not on every affected platform, but just one platform per affected DLL where the issue could be reproduced before.

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=811557#c10)• 12 years ago |
|  | |

I don't see that this has been fixed anywhere yet. Please let me know where this has been fixed so I can test those installers.

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=811557#c11)• 12 years ago |
|  | |

My bad I thought this was the original installer bug.

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=811557#c12)• 12 years ago |
|  | |

(In reply to Alex Keybl [:akeybl] from [comment #6](/show_bug.cgi?id=811557#c6 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer"))
> Tracking for FF18, in case we actually hit this release with the stub
> installer.
We'll leave this on the tracking FF18 list as a reminder in case we do end up shipping the stub installer in the FF18 timeframe. We could always just re-spin the stub installer if necessary.

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=811557#c13)• 12 years ago |
|  | |

(In reply to Brian R. Bondy [:bbondy] from [comment #11](/show_bug.cgi?id=811557#c11 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer"))
> My bad I thought this was the original installer bug.
Any updates here? It doesn't look like we'll have a stub in time for FF19, but it's possible that we'll want to push it out while FF19 is on release (needinfo:rstrong to confirm timelines). If so, we should get a fix on all branches soon.Flags: needinfo?(robert.bugzilla)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=811557#c14)• 12 years ago |
|  | |

No updates at this time. We could possibly wrap the stub inside of a 7-zip self-extracting archive to get a temporary fix with the real fix being what is noted in [comment #2](/show_bug.cgi?id=811557#c2 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer") through [comment #4](/show_bug.cgi?id=811557#c4 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer") though there is other work that would not get done if we do fix this. I think it would be a good thing to evaluate that fact along with the fact that there have been a ton of NSIS installers out in the world for many years that all have this potential vulnerability without it being exploited.Flags: needinfo?(robert.bugzilla)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=811557#a7888536_1689)• 12 years ago |

[status-b2g18](/buglist.cgi?f1=cf_status_b2g18&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected)
[status-firefox18](/buglist.cgi?f1=cf_status_firefox18&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox18&o1=equals&v1=wontfix)
[status-firefox19](/buglist.cgi?f1=cf_status_firefox19&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox19&o1=equals&v1=wontfix)
[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected)
[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected)
[tracking-firefox18](/buglist.cgi?f1=cf_tracking_firefox18&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox18&o1=equals&v1=%2B) → ---
[tracking-firefox19](/buglist.cgi?f1=cf_tracking_firefox19&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox19&o1=equals&v1=%2B) → ---
[tracking-firefox20](/buglist.cgi?f1=cf_tracking_firefox20&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox20&o1=equals&v1=%2B)
[tracking-firefox21](/buglist.cgi?f1=cf_tracking_firefox21&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox21&o1=equals&v1=%2B)

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=811557#c15)• 12 years ago |
|  | |

quick update: I'm working on this again but am having trouble getting NSIS to build. The problem is because SCONS is picking up newer MSVC versions I have installed as well. I tried configuring it but without success. I'm setting up a new WinXP VM now in which I'll re-install only the tools for NSIS and I expect that will compile fine.

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=811557#c16)• 12 years ago |
|  | |

bbondy and I discussed [bug 744669](/show_bug.cgi?id=744669 "NEW") yesterday and concluded that to properly fix [bug 744669](/show_bug.cgi?id=744669 "NEW") the need for the 7-Zip self extracting archive should be removed and the files should be packaged in the installer itself. If this was done then this would reintroduce the dll hijacking bug to the regular installer. So, this bug will need to be fixed to fix [bug 744669](/show_bug.cgi?id=744669 "NEW") by patching NSIS which will fix dll hijacking for both the complete and the stub installers.

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=811557#c17)• 12 years ago |
|  | |

I built nsis-u successfully by modifying some of the scripts to force include, lib and rc directories.
But I'm getting some strange side effects after I build the installer with the new makensis and run the installer.
After zip extracts the exe it gives a infinite loop of:
Copying 1 file from nsa440B.tmp to 7zSD6a.tmp
The destination already has a file named "System.dll"
()Replace the file in the destination
()Skip this file
() Compare info for both files
I'll play around with it more to try to build with different include/lib directories but just wanted to provide an interim update.

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=811557#c18)• 12 years ago |
|  | |

Summary so far:
So the 2005 toolchain is for the official NSIS version here:
<http://nsis.sourceforge.net/>
To build this you can't have 2008 toolchain installed or else the old scons that it requires will fail.
Later I found out what I really need is here:
<http://www.scratchpaper.com/>
To build this you have to use 2008 or later.
I built makensis successfully with 2008, 2010, and 2012 toolsets.
Each one produces a Firefox installer and looks correct but they fail with either a crash when you start the installer or else the issue mentioned in [Comment 17](/show_bug.cgi?id=811557#c17 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer").
I need to investigate why it's crashing or getting the above error more still.

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=811557#a10793242_425645)• 12 years ago |

[status-firefox20](/buglist.cgi?f1=cf_status_firefox20&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox20&o1=equals&v1=wontfix)Whiteboard: [leave open] → [leave open][stub?]

|  | [bhavana bajaj [:bajaj]](/user_profile?user_id=448925) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=811557#a14489567_448925)• 12 years ago |

[status-firefox21](/buglist.cgi?f1=cf_status_firefox21&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=wontfix)
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected)
[tracking-firefox22](/buglist.cgi?f1=cf_tracking_firefox22&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B)

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=811557#c19)• 12 years ago |
|  | |

Not currently working on this one and I have some other security ones I'll be doing before this. Last time I worked on this I successfully built NSIS as per [Comment 18](/show_bug.cgi?id=811557#c18 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer") toolsets. But the produced installers crashed on startup. In hindsight it was probably due to a loaded plugin on startup. I didn't have time to investigate the crash at all.Assignee: netzen → nobody

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=811557#c20)• 12 years ago |
|  | |

Taking a look to see if I have any better luckQA Contact: robert.bugzilla

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=811557#a15269756_141755)• 12 years ago |

Assignee: nobody → robert.bugzillaQA Contact: robert.bugzilla

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=811557#c21)• 12 years ago |
|  | |

Attached file
[Stub for testing](attachment.cgi?id=747803)
— [Details](attachment.cgi?id=747803&action=edit)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=811557#c22)• 12 years ago |
|  | |

:ashughes, could you run the attached "Stub for testing" through the test suite?
[https://intranet.mozilla.org/User:Ahughes@mozilla.com/DLL\_Hijacking#Firefox\_19.0a1\_win32\_Stub\_Installer](https://intranet.mozilla.org/User%3AAhughes%40mozilla.com/DLL_Hijacking#Firefox_19.0a1_win32_Stub_Installer)
This passed on Win7 but I wouldn't be surprised if there are some one-offs that still fail. Thanks!Flags: needinfo?(anthony.s.hughes)

|  | [u279076](/user_profile?user_id=279076) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=811557#c23)• 12 years ago |
|  | |

(In reply to Robert Strong [:rstrong] (do not email) from [comment #22](/show_bug.cgi?id=811557#c22 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer"))
> :ashughes, could you run the attached "Stub for testing" through the test
> suite?
> [https://intranet.mozilla.org/User:Ahughes@mozilla.com/](https://intranet.mozilla.org/User%3AAhughes%40mozilla.com/)
> DLL\_Hijacking#Firefox\_19.0a1\_win32\_Stub\_Installer
>
> This passed on Win7 but I wouldn't be surprised if there are some one-offs
> that still fail. Thanks!
I won't have time to look at this for at least a couple of weeks. Matt can you please handle Robert's request? I think Kamil could probably assist.Flags: needinfo?(anthony.s.hughes) → needinfo?(mwobensmith)

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=811557#c24)• 12 years ago |
|  | |

Robert did you want me to review the code change first? I know it's not part of Mozilla code but it may be useful to have a second set of eyes on the change anyway. Testing this takes a non trivial amount of time.

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=811557#c25)• 12 years ago |
|  | |

(In reply to Brian R. Bondy [:bbondy] from [comment #24](/show_bug.cgi?id=811557#c24 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer"))
> Robert did you want me to review the code change first? I know it's not part
> of Mozilla code but it may be useful to have a second set of eyes on the
> change anyway. Testing this takes a non trivial amount of time.
No, I took a different approach that preloads the dlls that NSIS loads early (only 3 so far vs. the 20) and preloads the others in .oninit in the hope that I can get this upstreamed easily. I need to know if others are needed for other Windows versions besides Windows 7 and the testing will provide that info.

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=811557#c26)• 12 years ago |
|  | |

I have Win7 and Vista systems so I can check those (already did a brief check of Win7) fairly easily.

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=811557#c27)• 12 years ago |
|  | |

Hey Robert, Kamil was going to start on this, but before he does I just wanted to see if you wanted to wait for the 7zip stub implementation we discussed instead?

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=811557#c28)• 12 years ago |
|  | |

Hey Brian, I would still like to know if it fixes it for those Windows versions since it might be a good idea to get a fix upstreamed for NSIS as well.

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=811557#c29)• 12 years ago |
|  | |

nightly stub installer sizes
631 KB - current local build
665 KB - wrapped in 7zip stub with NSIS compression (34 KB more)
656 KB - wrapped in 7zip stub without NSIS compression (25 KB more)
656 KB - wrapped in 7zip stub without NSIS compression and bmps inside of 7zip
stub instead of the stub installer (25 KB more)
The reason for the last test is that we have been asked to include the artwork outside of the installer for distributions.
Note: I would still like the info requested in [comment #22](/show_bug.cgi?id=811557#c22 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer")... if this is important to us it should be important to others and it is a good thing to give back to the project that has been providing to us.

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=811557#c30)• 12 years ago |
|  | |

Attached patch

[patch rev1](attachment.cgi?id=757779&action=diff) (obsolete)
— [Details](attachment.cgi?id=757779&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=811557&attachment=757779)

Brian, I'd like to run this by you first. Thanks!
[Attachment #757779](/attachment.cgi?id=757779&action=edit "patch rev1") -
Flags: review?(netzen)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=811557#c31)• 12 years ago |
|  | |

(In reply to Robert Strong [:rstrong] (do not email) from [comment #30](/show_bug.cgi?id=811557#c30 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer"))
> Created [attachment 757779](/attachment.cgi?id=757779 "patch rev1") [[details]](/attachment.cgi?id=757779&action=edit "patch rev1") [[diff]](/attachment.cgi?id=757779&action=diff "patch rev1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=811557&attachment=757779)
> patch rev1
>
> Brian, I'd like to run this by you first. Thanks!
I am going to refactor the toolkit nsis make code a little and I mainly want your r+ for the browser nsis code.

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=811557#c32)• 12 years ago |
|  | |

Comment on [attachment 757779](/attachment.cgi?id=757779 "patch rev1") [[details]](/attachment.cgi?id=757779&action=edit "patch rev1") [[diff]](/attachment.cgi?id=757779&action=diff "patch rev1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=811557&attachment=757779)
patch rev1
Review of [attachment 757779](/attachment.cgi?id=757779 "patch rev1") [[details]](/attachment.cgi?id=757779&action=edit "patch rev1") [[diff]](/attachment.cgi?id=757779&action=diff "patch rev1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=811557&attachment=757779):
-----------------------------------------------------------------
Looks good but I'll leave it to your discretion whether or not you want someone from build config to also take a look.
[Attachment #757779](/attachment.cgi?id=757779&action=edit "patch rev1") -
Flags: review?(netzen) → review+

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=811557#c33)• 12 years ago |
|  | |

Attached patch

[patch rev2](attachment.cgi?id=758155&action=diff)
— [Details](attachment.cgi?id=758155&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=811557&attachment=758155)

Brian, since glandium is high latency atm could you review the changes to the build process. I was able to take a much cleaner and safer approach.
[Attachment #757779](/attachment.cgi?id=757779&action=edit "patch rev1") -
Attachment is obsolete: true
[Attachment #758155](/attachment.cgi?id=758155&action=edit "patch rev2") -
Flags: review?(netzen)

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=811557#a17544388_407790)• 12 years ago |

[Attachment #758155](/attachment.cgi?id=758155&action=edit "patch rev2") -
Flags: review?(netzen) → review+

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=811557#c34)• 12 years ago |
|  | |

Comment on [attachment 758155](/attachment.cgi?id=758155 "patch rev2") [[details]](/attachment.cgi?id=758155&action=edit "patch rev2") [[diff]](/attachment.cgi?id=758155&action=diff "patch rev2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=811557&attachment=758155)
patch rev2
[Security approval request comment]
How easily could an exploit be constructed based on the patch? Not easily and less easily from code inspection from the landing of [bug 792106](/show_bug.cgi?id=792106 "VERIFIED FIXED - DLL Hijacking - Firefox installer").
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem? No
Which older supported branches are affected by this flaw? This affects all NSIS installers. This mitigates this bug by wrapping the stub installer in our custom 7-Zip stub which also had the same flaw and has been patched.
If not all supported branches, which bug introduced the flaw? [bug 322206](/show_bug.cgi?id=322206 "VERIFIED FIXED - Firefox net / stub installer for x86")
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be? This is easily backported.
How likely is this patch to cause regressions; how much testing does it need? Unlikely since we have been doing the same thing with the full installer.
[Attachment #758155](/attachment.cgi?id=758155&action=edit "patch rev2") -
Flags: sec-approval?

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=811557#c35)• 12 years ago |
|  | |

Comment on [attachment 758155](/attachment.cgi?id=758155 "patch rev2") [[details]](/attachment.cgi?id=758155&action=edit "patch rev2") [[diff]](/attachment.cgi?id=758155&action=diff "patch rev2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=811557&attachment=758155)
patch rev2
[Approval Request Comment]
Bug caused by (feature/regressing bug #): [bug 322206](/show_bug.cgi?id=322206 "VERIFIED FIXED - Firefox net / stub installer for x86")
User impact if declined: potential security exploit
Testing completed (on m-c, etc.): We use this same method with the full installer and I have tested locally
Risk to taking this patch (and alternatives if risky): minimal
String or IDL/UUID changes made by this patch: none
[Attachment #758155](/attachment.cgi?id=758155&action=edit "patch rev2") -
Flags: approval-mozilla-beta?
[Attachment #758155](/attachment.cgi?id=758155&action=edit "patch rev2") -
Flags: approval-mozilla-aurora?

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=811557#a17546101_141755)• 12 years ago |

[status-firefox23](/buglist.cgi?f1=cf_status_firefox23&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=affected)
[status-firefox24](/buglist.cgi?f1=cf_status_firefox24&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=affected)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected)
[tracking-firefox23](/buglist.cgi?f1=cf_tracking_firefox23&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox23&o1=equals&v1=%3F)
[tracking-firefox24](/buglist.cgi?f1=cf_tracking_firefox24&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox24&o1=equals&v1=%3F)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=811557#c36)• 12 years ago |
|  | |

Comment on [attachment 758155](/attachment.cgi?id=758155 "patch rev2") [[details]](/attachment.cgi?id=758155&action=edit "patch rev2") [[diff]](/attachment.cgi?id=758155&action=diff "patch rev2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=811557&attachment=758155)
patch rev2
sec-approval+ for trunk. Please nominate for branches once it is in.
[Attachment #758155](/attachment.cgi?id=758155&action=edit "patch rev2") -
Flags: sec-approval? → sec-approval+

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=811557#c37)• 12 years ago |
|  | |

Pushed to mozilla-inbound
<https://hg.mozilla.org/integration/mozilla-inbound/rev/642a020ef752>Status: NEW → ASSIGNED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=811557#c38)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/642a020ef752>Status: ASSIGNED → RESOLVEDClosed: 12 years ago
[status-firefox24](/buglist.cgi?f1=cf_status_firefox24&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla24

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=811557#a17610737_75935)• 12 years ago |

Status: RESOLVED → REOPENEDResolution: FIXED → ---

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=811557#a17610846_141755)• 12 years ago |

Status: REOPENED → RESOLVEDClosed: 12 years ago → 12 years agoResolution: --- → FIXEDWhiteboard: [leave open][stub?] → [stub?]

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=811557#a17610883_141755)• 12 years ago |

No longer blocks: [804979](/show_bug.cgi?id=804979 "RESOLVED FIXED - DLL Hijacking - Seamonkey installer"), [803515](/show_bug.cgi?id=803515 "RESOLVED FIXED - DLL Hijacking - Thunderbird installer"), [805032](/show_bug.cgi?id=805032 "RESOLVED FIXED - Latest esr10 nightly installer sometimes fails on Windows 2000 because it requires Windows XP SP2"), [811227](/show_bug.cgi?id=811227 "RESOLVED FIXED - DLL Hijacking - Thunderbird installer - Part 2")

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=811557#c39)• 12 years ago |
|  | |

The current nightly has the stub installer wrapped by the 7-Zip stub just like the full installer so this can be verified.Keywords: [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=811557#c40)• 12 years ago |
|  | |

I also checked that everything is signed correctly for en-US and de so l10n appears to be building correctly.

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=811557#a17778290_272375)• 12 years ago |

[tracking-firefox23](/buglist.cgi?f1=cf_tracking_firefox23&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox23&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox23&o1=equals&v1=%2B)
[tracking-firefox24](/buglist.cgi?f1=cf_tracking_firefox24&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox24&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox24&o1=equals&v1=%2B)

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=811557#a17778308_272375)• 12 years ago |

[Attachment #758155](/attachment.cgi?id=758155&action=edit "patch rev2") -
Flags: approval-mozilla-beta?
[Attachment #758155](/attachment.cgi?id=758155&action=edit "patch rev2") -
Flags: approval-mozilla-beta+
[Attachment #758155](/attachment.cgi?id=758155&action=edit "patch rev2") -
Flags: approval-mozilla-aurora?
[Attachment #758155](/attachment.cgi?id=758155&action=edit "patch rev2") -
Flags: approval-mozilla-aurora+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=811557#c41)• 12 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/280c2e3a5216>
<https://hg.mozilla.org/releases/mozilla-beta/rev/e063cbfd1c9b>
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=fixed)
[status-firefox23](/buglist.cgi?f1=cf_status_firefox23&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=fixed)

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=811557#c42)• 12 years ago |
|  | |

Firefox 24 Testing/Verification Results:
Steps Used:
- Downloaded the latest stub executable & renamed it to stub.exe
- Configured procmon as follows:
Process Name is stub.exe
Path contains .dll
Operation is Load Image
Matched the listed DLL's in procmon against the KnownDlls32 list under Winobj. Listed the unknown DLL's below.
Reproduced original issue using the stub executable from the following build:
<http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2012/11/2012-11-07-04-58-42-mozilla-central/>
Tested the issue using the stub executable from the following build:
<http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2013-06-13-03-12-37-mozilla-central/>
Windows 8 x64:
C:\Windows\System32\wow64.dll -> Passed (cmd.exe was not executed)
C:\Windows\System32\wow64win.dll -> Passed (cmd.exe was not executed)
C:\Windows\System32\wow64cpu.dll -> Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\dwmapi.dll -> Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\SHCore.dll -> Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\uxtheme.dll -> Passed (cmd.exe was not executed)
C:\Program Files (x86)\Common Files\Microsoft Shared\Ink\tiptsf.dll -> Passed (cmd.exe was not executed)
C:\Program Files\ThinkPad\Bluetooth Software\syswow64\BtMmHook.dll -> Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\oleacc.dll -> cmd.exe was launched in MEDIUM integrity
C:\Windows\SysWOW64\apphelp.dll -> Passed (cmd.exe was not executed)
Windows 7 Home Premium SP1 x64:
C:\Windows\System32\wow64.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64win.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64cpu.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\dwmapi.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\uxtheme.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\apphelp.dll <- Passed (cmd.exe was not executed)
Windows Vista Ultimate SP2 x64:
C:\Windows\System32\ntdll.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\ntdll.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64win.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64cpu.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\dwmapi.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\uxtheme.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\apphelp.dll <- Passed (cmd.exe was not executed)
Windows XP Pro SP2 x64:
C:\WINDOWS\system32\wow64.dll <- Passed (cmd.exe was not executed)
C:\WINDOWS\system32\wow64win.dll <- Passed (cmd.exe was not executed)
C:\WINDOWS\system32\wow64cpu.dll <- Passed (cmd.exe was not executed)
C:\WINDOWS\SysWOW64\imm32.dll <- Passed (cmd.exe was not executed)
C:\WINDOWS\SysWOW64\uxtheme.dll <- Passed (cmd.exe was not executed)
C:\WINDOWS\SysWOW64\msctf.dll <- Passed (cmd.exe was not executed)
C:\WINDOWS\SysWOW64\apphelp.dll <- Several CMD.EXE where launched (not sure what integrity level)
Possible Issues:
Windows 8 x64:
C:\Windows\SysWOW64\oleacc.dll -> cmd.exe was launched in MEDIUM integrity
Windows XP Pro SP2 x64:
C:\WINDOWS\SysWOW64\apphelp.dll <- Several CMD.EXE where launched (not sure what integrity level)
Before verifying Firefox 24, could someone please double check and see if the two DLL's listed above are possible issues.

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=811557#c43)• 12 years ago |
|  | |

Firefox 23 Testing/Verification Results:
Steps Used:
- Downloaded the latest stub executable & renamed it to stub.exe
- Configured procmon as follows:
Process Name is stub.exe
Path contains .dll
Operation is Load Image
Matched the listed DLL's in procmon against the KnownDlls32 list under Winobj. Listed the unknown DLL's below
Tested the issue using the stub executable from the following build:
<http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2013-06-13-00-40-19-mozilla-aurora/>
Windows 8 x64:
C:\Windows\System32\wow64.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64win.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64cpu.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\apphelp.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\dwmapi.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\SHCore.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\uxtheme.dll <- Passed (cmd.exe was not executed)
C:\Program Files (x86)\Common Files\Microsoft Shared\Ink\tiptsf.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\oleacc.dll <- CMD.EXE was launched in MEDIUM integrity
Windows 7 Home Premium SP1 x64:
C:\Windows\System32\wow64.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64win.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64cpu.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\dwmapi.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\uxtheme.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\apphelp.dll <- Passed (cmd.exe was not executed)
Windows Vista Ultimate SP2 x64:
C:\Windows\System32\ntdll.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\ntdll.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64win.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64cpu.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\dwmapi.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\uxtheme.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\apphelp.dll <- Passed (cmd.exe was not executed)
Windows XP Pro SP2 x64:
C:\WINDOWS\system32\wow64.dll <- Passed (cmd.exe was not executed)
C:\WINDOWS\system32\wow64win.dll <- Passed (cmd.exe was not executed)
C:\WINDOWS\system32\wow64cpu.dll <- Passed (cmd.exe was not executed)
C:\WINDOWS\SysWOW64\imm32.dll <- Passed (cmd.exe was not executed)
C:\WINDOWS\SysWOW64\uxtheme.dll <- Passed (cmd.exe was not executed)
C:\WINDOWS\SysWOW64\msctf.dll <- Passed (cmd.exe was not executed)
C:\WINDOWS\SysWOW64\apphelp.dll <- Several CMD.EXE where launched (not sure what integrity level)
Possible Issues:
Windows 8 x64:
C:\Windows\SysWOW64\oleacc.dll <- CMD.EXE was launched in MEDIUM integrity
Windows XP Pro SP2 x64:
C:\WINDOWS\SysWOW64\apphelp.dll <- Several CMD.EXE where launched (not sure what integrity level)
Before verifying Firefox 23, could someone please double check and see if the two DLL's listed above are possible issues.

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=811557#c44)• 12 years ago |
|  | |

I won't be able to check due to only having Win Vista and Win 7 at this time.
Brian, could you check the above two dll's?Flags: needinfo?(netzen)

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=811557#c45)• 12 years ago |
|  | |

Firefox 22 Testing/Verification Results:
Steps Used:
- Downloaded the latest stub executable & renamed it to stub.exe
- Configured procmon as follows:
Process Name is stub.exe
Path contains .dll
Operation is Load Image
Matched the listed DLL's in procmon against the KnownDlls32 list under Winobj. Listed the unknown DLL's below
Tested the issue using the stub executable from the following build:
<http://ftp.mozilla.org/pub/mozilla.org/firefox/releases/22.0b5/win32/en-US/>
Windows 8 x64:
C:\Windows\System32\wow64.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64win.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64cpu.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\apphelp.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\dwmapi.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\SHCore.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\uxtheme.dll <- Passed (cmd.exe was not executed)
C:\Program Files (x86)\Common Files\Microsoft Shared\Ink\tiptsf.dll <- Passed (cmd.exe was not executed)
C:\Program Files\ThinkPad\Bluetooth Software\syswow64\BtMmHook.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\oleacc.dll <- CMD.EXE was launched in MEDIUM integrity
Windows 7 Home Premium SP1 x64:
C:\Windows\System32\wow64.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64win.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64cpu.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\dwmapi.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\uxtheme.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\apphelp.dll <- Passed (cmd.exe was not executed)
Windows Vista Ultimate SP2 x64:
C:\Windows\System32\ntdll.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\ntdll.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64win.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64cpu.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\dwmapi.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\uxtheme.dll <- Passed (cmd.exe was not executed)
C:\Windows\SysWOW64\apphelp.dll <- Passed (cmd.exe was not executed)
Windows XP Pro SP2 x64:
C:\Windows\System32\wow64.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64win.dll <- Passed (cmd.exe was not executed)
C:\Windows\System32\wow64cpu.dll <- Passed (cmd.exe was not executed)
C:\WINDOWS\SysWOW64\imm32.dll <- Passed (cmd.exe was not executed)
C:\WINDOWS\SysWOW64\uxtheme.dll <- Passed (cmd.exe was not executed)
C:\WINDOWS\SysWOW64\msctf.dll <- Passed (cmd.exe was not executed)
C:\WINDOWS\SysWOW64\apphelp.dll <- Several CMD.EXE where launched (not sure what integrity level)
Possible Issues:
Windows 8 x64:
C:\Windows\SysWOW64\oleacc.dll <- CMD.EXE was launched in MEDIUM integrity
Windows XP Pro SP2 x64:
C:\WINDOWS\SysWOW64\apphelp.dll <- Several CMD.EXE where launched (not sure what integrity level)
Before verifying Firefox 22, could someone please double check and see if the two DLL's listed above are possible issues.

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=811557#c46)• 12 years ago |
|  | |

(In reply to Robert Strong [:rstrong] (do not email) from [comment #44](/show_bug.cgi?id=811557#c44 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer"))
> I won't be able to check due to only having Win Vista and Win 7 at this time.
>
> Brian, could you check the above two dll's?
I reproduced medium integrity level with oleacc.dll on win8x64. This is not an easy to exploit escalation of privs problem, but we should still fix for these 2 cases:
i) User downloads a bad dll into their downloads directory, and then downloads the stub, then executes the stub. The dll can then run on the machine with medium integrity. Which isn't as bad as high, but is at least something.
ii) The user downloads the stub and right clicks it and runs it as admin, or runs it from an elevated cmd. The dll then gets high integirty.
The same logic applies to apphelp.dll, although I didn't verify this one because I don't have WinXPx64 locally here. There's no per-user integrity level on XP like there is on Vista+ so I trust this result.
I think both should be fixed in the delayDLLs array of the AutoLoadSystemDependencies struct in this file:
other-licenses/7zstub/src/7zip/Bundles/SFXSetup-moz/Main.cpp
---
After this fix, Kamil you can only retest the affected platforms and DLLs, you don't need to retry everything. Thanks for the huge amount of work by the way!Flags: needinfo?(netzen)

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=811557#c47)• 12 years ago |
|  | |

See [bug 792106](/show_bug.cgi?id=792106 "VERIFIED FIXED - DLL Hijacking - Firefox installer") for a similar fix.

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=811557#c48)• 12 years ago |
|  | |

no problem Brian! Robert, just needinfo me when its ready to go again and I will test the two DLL's on the affected platforms.

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=811557#c49)• 12 years ago |
|  | |

Brian, do those dll's also affect the full installer? I would suspect so.Flags: needinfo?(netzen)

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=811557#c50)• 12 years ago |
|  | |

The win8 one is yup, the x64xp one I don't have it locally to try but I'm sure it's the same too.
I think originally we were just fixing the high integrity processes but then we learnt that it can be a security risk if a user downloads a dll off the internet and then downloads an installer and executes it. I personally don't think sec-high but worth fixing.Flags: needinfo?(netzen)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=811557#c51)• 12 years ago |
|  | |

Thanks Brian! With this affecting both the full installer and the stub installer I'd like to do those in a separate bug.
Thanks Kamil! I know the test matrix to verify this is a pain and your efforts are much appreciated.

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=811557#a18367983_141755)• 12 years ago |

Blocks: [CVE-2013-1715](/show_bug.cgi?id=883165 "VERIFIED FIXED - Medium integrity DLL Hijacking - Firefox Full installer and Stub installer")

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790)  Reporter |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=811557#c52)• 12 years ago |
|  | |

Followup for the dll pre-loading from a known path sounds right to me.

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=811557#c53)• 12 years ago |
|  | |

This is as fixed as much as [bug 792106](/show_bug.cgi?id=792106 "VERIFIED FIXED - DLL Hijacking - Firefox installer") is fixed per the checks Kamil performed so changing to verified based on [comment #42](/show_bug.cgi?id=811557#c42 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer"), [comment #43](/show_bug.cgi?id=811557#c43 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer"), and [comment #45](/show_bug.cgi?id=811557#c45 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer"). [Bug 883165](/show_bug.cgi?id=883165 "VERIFIED FIXED - Medium integrity DLL Hijacking - Firefox Full installer and Stub installer") will handle the medium integrity dll's.Status: RESOLVED → VERIFIED
[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=verified)
[status-firefox23](/buglist.cgi?f1=cf_status_firefox23&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=verified)
[status-firefox24](/buglist.cgi?f1=cf_status_firefox24&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=verified)

|  | [Justin Wood (:Callek)](/user_profile?user_id=129968) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=811557#a18384337_129968)• 12 years ago |

Blocks: [883322](/show_bug.cgi?id=883322 "RESOLVED FIXED - Medium integrity DLL Hijacking - Thunderbird and SeaMonkey Full installer")

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=811557#a18917653_280903)• 12 years ago |

Whiteboard: [stub?] → [stub?][adv-main22-]

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=811557#c54)• 11 years ago |
|  | |

Hey Kamil, [comment 46](/show_bug.cgi?id=811557#c46 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer") and [comment 48](/show_bug.cgi?id=811557#c48 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer") - can you do a quick verify?Flags: needinfo?(mwobensmith) → needinfo?(kamiljoz)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=811557#c55)• 11 years ago |
|  | |

Matt, the medium integrity case referenced in [comment #46](/show_bug.cgi?id=811557#c46 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer") and [comment #48](/show_bug.cgi?id=811557#c48 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer") was moved to [bug 883165](/show_bug.cgi?id=883165 "VERIFIED FIXED - Medium integrity DLL Hijacking - Firefox Full installer and Stub installer").Flags: needinfo?(kamiljoz)

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=811557#c56)• 11 years ago |
|  | |

Indeed, thanks Robert, and sorry for spacing that. Too much info spread across too many DLL bugs. :(

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=811557#a63601015_1689)• 10 years ago |

Group: core-security

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=811557#a339182329_1)• 1 years ago |

Component: NSIS Installer → InstallerProduct: Toolkit → Firefox
You need to [log in](/show_bug.cgi?id=811557&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_bfbccbb0_20250126_034950.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/883165)
* [XML](/show_bug.cgi?ctype=xml&id=883165)

Closed
[Bug 883165](/show_bug.cgi?id=883165)
(CVE-2013-1715)

Opened 12 years ago
Closed 12 years ago

# Medium integrity DLL Hijacking - Firefox Full installer and Stub installer

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Medium integrity DLL Hijacking - Firefox Full installer and Stub installer

## Categories

### (Firefox :: Installer, defect)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=Installer#Installer)

Installer
▾

Firefox :: Installer
Bugs and feature requests for the Firefox application install wizard.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=Installer&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=Installer&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=Installer)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

Windows 7

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla24

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Install Update Workflow | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox21 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox21&o1=equals&v1=wontfix) |
| firefox22 | [+](/buglist.cgi?f1=cf_tracking_firefox22&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=wontfix) |
| firefox23 | [+](/buglist.cgi?f1=cf_tracking_firefox23&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=verified) |
| firefox24 | [+](/buglist.cgi?f1=cf_tracking_firefox24&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=verified) |
| firefox-esr17 | [-](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=wontfix) |
| b2g18 | --- | [unaffected](/buglist.cgi?f1=cf_status_b2g18&o1=equals&v1=unaffected) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox21 |  | wontfix |
| firefox22 | + | wontfix |
| firefox23 | + | verified |
| firefox24 | + | verified |
| firefox-esr17 | - | wontfix |
| b2g18 |  | unaffected |
| relnote-firefox |  | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: robert.strong.bugs, Assigned: robert.strong.bugs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [robert.strong.bugs](/user_profile?user_id=141755)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](extensions/Gravatar/web/default.jpg)  [robert.strong.bugs](/user_profile?user_id=141755)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/50e82ef70720dfcf1385f583e34f9ba9?d=mm&size=40)  [erchen](/user_profile?user_id=753852)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

26 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[CVE-2012-4206](/show_bug.cgi?id=792106 "VERIFIED FIXED - DLL Hijacking - Firefox installer"), [811557](/show_bug.cgi?id=811557 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[883322](/show_bug.cgi?id=883322 "RESOLVED FIXED - Medium integrity DLL Hijacking - Thunderbird and SeaMonkey Full installer")

Dependency [tree](/showdependencytree.cgi?id=883165&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=883165)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-priv-escalation, sec-moderate, Whiteboard: [adv-main23+][include 811557 in this advisory])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2013-1715

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main23+][include 811557 in this advisory]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [robert.strong.bugs](/user_profile?user_id=141755) | [in-testsuite](#a288314_141755 "12 years ago") | - |
| --- | --- | --- |
| [robert.strong.bugs](/user_profile?user_id=141755) | in-testsuite | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [patch rev1 - oleacc.dll and apphelp.dll](/attachment.cgi?id=762724)  [12 years ago](#c1)  [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)   1.35 KB, patch | bbondy : [review+](#c2 "12 years ago")  akeybl : [approval-mozilla-aurora+](#a286608_425645 "12 years ago") | [Details](/attachment.cgi?id=762724&action=edit) | [Diff](/attachment.cgi?id=762724&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=883165&attachment=762724) |
| --- | --- | --- |
| [new 7zip sfx](/attachment.cgi?id=762747)  [12 years ago](#c4)  [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)   80.24 KB, patch | bbondy : [review+](#a7141_407790 "12 years ago") | [Details](/attachment.cgi?id=762747&action=edit) | [Diff](/attachment.cgi?id=762747&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=883165&attachment=762747) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=883165#c0)• 12 years ago |
|  | |

+++ This bug was initially created as a clone of [Bug #811557](/show_bug.cgi?id=811557 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer") which was initially created as a clone of [Bug #792106](/show_bug.cgi?id=792106 "VERIFIED FIXED - DLL Hijacking - Firefox installer") +++
Specifically (from [bug 811557 comment #42](/show_bug.cgi?id=811557#c42 "VERIFIED FIXED - DLL Hijacking - Firefox Stub installer"))
Windows 8 x64:
C:\Windows\SysWOW64\oleacc.dll <- CMD.EXE was launched in MEDIUM integrity
Windows XP Pro SP2 x64:
C:\WINDOWS\SysWOW64\apphelp.dll <- Several CMD.EXE where launched (not sure what integrity level)
Full results are being added here as we test:
[https://intranet.mozilla.org/User:Ahughes@mozilla.com/DLL\_Hijacking](https://intranet.mozilla.org/User%3AAhughes%40mozilla.com/DLL_Hijacking)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=883165#c1)• 12 years ago |
|  | |

Attached patch

[patch rev1 - oleacc.dll and apphelp.dll](attachment.cgi?id=762724&action=diff)
— [Details](attachment.cgi?id=762724&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=883165&attachment=762724)

Assignee: nobody → robert.bugzillaStatus: NEW → ASSIGNED
[Attachment #762724](/attachment.cgi?id=762724&action=edit "patch rev1 - oleacc.dll and apphelp.dll") -
Flags: review?(netzen)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=883165#a3514_141755)• 12 years ago |

Whiteboard: [stub?]

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=883165#c2)• 12 years ago |
|  | |

Comment on [attachment 762724](/attachment.cgi?id=762724 "patch rev1 - oleacc.dll and apphelp.dll") [[details]](/attachment.cgi?id=762724&action=edit "patch rev1 - oleacc.dll and apphelp.dll") [[diff]](/attachment.cgi?id=762724&action=diff "patch rev1 - oleacc.dll and apphelp.dll") [[review]](/page.cgi?id=splinter.html&ignore=&bug=883165&attachment=762724)
patch rev1 - oleacc.dll and apphelp.dll
Review of [attachment 762724](/attachment.cgi?id=762724 "patch rev1 - oleacc.dll and apphelp.dll") [[details]](/attachment.cgi?id=762724&action=edit "patch rev1 - oleacc.dll and apphelp.dll") [[diff]](/attachment.cgi?id=762724&action=diff "patch rev1 - oleacc.dll and apphelp.dll") [[review]](/page.cgi?id=splinter.html&ignore=&bug=883165&attachment=762724):
-----------------------------------------------------------------
We need another patch with a new sfx too
[Attachment #762724](/attachment.cgi?id=762724&action=edit "patch rev1 - oleacc.dll and apphelp.dll") -
Flags: review?(netzen) → review+

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=883165#c3)• 12 years ago |
|  | |

Yep, I'll create one today

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=883165#c4)• 12 years ago |
|  | |

Attached patch

[new 7zip sfx](attachment.cgi?id=762747&action=diff)
— [Details](attachment.cgi?id=762747&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=883165&attachment=762747)

Brian, could you verify that I got the version and manifest correct? Thanks!
[Attachment #762747](/attachment.cgi?id=762747&action=edit "new 7zip sfx") -
Flags: review?(netzen)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=883165#c5)• 12 years ago |
|  | |

Changing from sec-high to sec-moderate since this is for medium integrity dll'sKeywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Brian R. Bondy [:bbondy]](/user_profile?user_id=407790) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=883165#a7141_407790)• 12 years ago |

[Attachment #762747](/attachment.cgi?id=762747&action=edit "new 7zip sfx") -
Flags: review?(netzen) → review+

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=883165#a14345_425645)• 12 years ago |

[status-firefox22](/buglist.cgi?f1=cf_status_firefox22&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox22&o1=equals&v1=wontfix)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=883165#c6)• 12 years ago |
|  | |

Pushed to mozilla-inbound
<https://hg.mozilla.org/integration/mozilla-inbound/rev/1393fe579803>Target Milestone: --- → mozilla24

|  | [Justin Wood (:Callek)](/user_profile?user_id=129968) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=883165#c7)• 12 years ago |
|  | |

This will also need a comm-central/ patch (likely in a new bug) for TB and SeaMonkey
<https://hg.mozilla.org/comm-central/file/788084ca950a/other-licenses/7zstub>

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=883165#c8)• 12 years ago |
|  | |

(In reply to Justin Wood (:Callek) from [comment #7](/show_bug.cgi?id=883165#c7 "VERIFIED FIXED - Medium integrity DLL Hijacking - Firefox Full installer and Stub installer"))
> This will also need a comm-central/ patch (likely in a new bug) for TB and
> SeaMonkey
>
> <https://hg.mozilla.org/comm-central/file/788084ca950a/other-licenses/7zstub>
If you file the bug I'll submit the patch.

|  | [Justin Wood (:Callek)](/user_profile?user_id=129968) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=883165#a16354_129968)• 12 years ago |

Blocks: [883322](/show_bug.cgi?id=883322 "RESOLVED FIXED - Medium integrity DLL Hijacking - Thunderbird and SeaMonkey Full installer")

|  | [Justin Wood (:Callek)](/user_profile?user_id=129968) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=883165#c9)• 12 years ago |
|  | |

(In reply to Robert Strong [:rstrong] (do not email) from [comment #8](/show_bug.cgi?id=883165#c8 "VERIFIED FIXED - Medium integrity DLL Hijacking - Firefox Full installer and Stub installer"))
> (In reply to Justin Wood (:Callek) from [comment #7](/show_bug.cgi?id=883165#c7 "VERIFIED FIXED - Medium integrity DLL Hijacking - Firefox Full installer and Stub installer"))
> > This will also need a comm-central/ patch (likely in a new bug) for TB and
> > SeaMonkey
> >
> > <https://hg.mozilla.org/comm-central/file/788084ca950a/other-licenses/7zstub>
> If you file the bug I'll submit the patch.
[Bug 883322](/show_bug.cgi?id=883322 "RESOLVED FIXED - Medium integrity DLL Hijacking - Thunderbird and SeaMonkey Full installer")

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=883165#c10)• 12 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/1393fe579803>Status: ASSIGNED → RESOLVEDClosed: 12 years ago
[status-firefox24](/buglist.cgi?f1=cf_status_firefox24&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=883165#c11)• 12 years ago |
|  | |

Kamil, could you verify the two dll's that have been added? Thanks!Flags: needinfo?(kamiljoz)Keywords: [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=883165#c12)• 12 years ago |
|  | |

Comment on [attachment 762724](/attachment.cgi?id=762724 "patch rev1 - oleacc.dll and apphelp.dll") [[details]](/attachment.cgi?id=762724&action=edit "patch rev1 - oleacc.dll and apphelp.dll") [[diff]](/attachment.cgi?id=762724&action=diff "patch rev1 - oleacc.dll and apphelp.dll") [[review]](/page.cgi?id=splinter.html&ignore=&bug=883165&attachment=762724)
patch rev1 - oleacc.dll and apphelp.dll
For both patches
[Approval Request Comment]
Bug caused by (feature/regressing bug #): This has been around since we have had Firefox installers.
User impact if declined: possibility of launching a process in the user's security context.
Testing completed (on m-c, etc.): has baked for a few days on m-c. This only adds 2 dll's to the existing dll's to preload and this code has been in use for some time now.
Risk to taking this patch (and alternatives if risky): minimal
String or IDL/UUID changes made by this patch: none
[Attachment #762724](/attachment.cgi?id=762724&action=edit "patch rev1 - oleacc.dll and apphelp.dll") -
Flags: approval-mozilla-aurora?

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=883165#a286608_425645)• 12 years ago |

[Attachment #762724](/attachment.cgi?id=762724&action=edit "patch rev1 - oleacc.dll and apphelp.dll") -
Flags: approval-mozilla-aurora? → approval-mozilla-aurora+

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=883165#c13)• 12 years ago |
|  | |

Pushed combined patch to mozilla-aurora
<https://hg.mozilla.org/releases/mozilla-aurora/rev/3f7234d9c1d9>
Note: this affects the full installer as well so adding affected to esr as well.
[status-firefox23](/buglist.cgi?f1=cf_status_firefox23&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=fixed)
[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=883165#a288314_141755)• 12 years ago |

Flags: in-testsuite-

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=883165#c14)• 12 years ago |
|  | |

Firefox 23 Testing/Verification Results:
Tested the issue using the full installer & stub executable from the following build:
<http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2013-06-18-00-40-18-mozilla-aurora/>
Windows 8 x64:
C:\Windows\SysWOW64\oleacc.dll <- Passed (cmd.exe was not executed)
- Went through both FULL & Stub installers
Windows XP Pro SP2 x64:
C:\WINDOWS\SysWOW64\apphelp.dll <- Passed (cmd.exe was not executed)
- Went through both FULL & STUB installers
[status-firefox24](/buglist.cgi?f1=cf_status_firefox24&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox24&o1=equals&v1=verified)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=883165#c15)• 12 years ago |
|  | |

Thanks Kamil!

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=883165#a387109_141755)• 12 years ago |

Flags: needinfo?(kamiljoz)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=883165#a387116_141755)• 12 years ago |

Keywords: [verifyme](/buglist.cgi?keywords=verifyme&resolution=---)

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=883165#c16)• 12 years ago |
|  | |

Firefox 24 Testing/Verification Results:
Tested the issue using the full installer & stub executable from the following build:
<http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2013-06-18-03-13-35-mozilla-central/>
Windows 8 x64:
C:\Windows\SysWOW64\oleacc.dll <- Passed (cmd.exe was not executed)
- Went through both the FULL & STUB installers
Windows XP Pro SP2 x64:
C:\WINDOWS\SysWOW64\apphelp.dll <- Passed (cmd.exe was not executed)
- Went through both FULL & STUB installers
[status-firefox23](/buglist.cgi?f1=cf_status_firefox23&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox23&o1=equals&v1=verified)

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=883165#c17)• 12 years ago |
|  | |

(In reply to Robert Strong [:rstrong] (do not email) from [comment #15](/show_bug.cgi?id=883165#c15 "VERIFIED FIXED - Medium integrity DLL Hijacking - Firefox Full installer and Stub installer"))
> Thanks Kamil!
no worries! I accidentally selected the incorrect build to mark as verified so the "Verified" messages are switched but tested both and everything works without any issues.

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=883165#a396627_141755)• 12 years ago |

Status: RESOLVED → VERIFIED

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=883165#a549653_280903)• 12 years ago |

Whiteboard: [include 811557 in this advisory]

|  | [Alex Keybl [:akeybl]](/user_profile?user_id=425645) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=883165#a3378665_425645)• 12 years ago |

[tracking-firefox-esr17](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=isnotempty):
--- → [-](/buglist.cgi?f1=cf_tracking_firefox_esr17&o1=equals&v1=-)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=883165#a3899227_280903)• 11 years ago |

Whiteboard: [include 811557 in this advisory] → [adv-main23+][include 811557 in this advisory]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=883165#a3919197_280903)• 11 years ago |

Alias: CVE-2013-1715

|  | [Lukas Blakk [:lsblakk] use ?needinfo](/user_profile?user_id=272375) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=883165#a6485669_272375)• 11 years ago |

[status-firefox-esr17](/buglist.cgi?f1=cf_status_firefox_esr17&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr17&o1=equals&v1=wontfix)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=883165#a45233923_1689)• 10 years ago |

Group: core-security

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=883165#a320814346_1)• 1 years ago |

Component: NSIS Installer → InstallerProduct: Toolkit → Firefox
You need to [log in](/show_bug.cgi?id=883165&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_678761f0_20250124_220434.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2013-74

## Firefox full and stub installer DLL hijacking

Announced
August 6, 2013
Reporter
Robert Kugler, Brian Bondy, Robert Strong
Impact
High
Products
Firefox, SeaMonkey
Fixed in

* Firefox 23
* SeaMonkey 2.20

### Description

Security researcher **Robert Kugler** [reported
in 2012](http://www.mozilla.org/security/announce/2012/mfsa2012-98.html) that when a specifically named DLL file on a Windows computer is
placed in the default downloads directory with the Firefox installer, the
Firefox installer will load this DLL file when it is launched. Mozilla
developers **Brian Bondy** and **Robert Strong** then
discovered that the stub installer was vulnerable to this same issue with a
number of DLL files and there were additionally vulnerable named DLL files with
the full installer. In circumstances where an installer is run by an
administrator privileged account, this allows for a downloaded DLL file to be
run with those administrator privileges.

### References

* [Medium integrity DLL Hijacking - Firefox Full installer and Stub
  installer](https://bugzilla.mozilla.org/show_bug.cgi?id=883165) ([CVE-2013-1715](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1715))
* [DLL Hijacking - Firefox Stub installer](https://bugzilla.mozilla.org/show_bug.cgi?id=811557)
* [Medium integrity DLL Hijacking - Thunderbird and SeaMonkey Full installer](https://bugzilla.mozilla.org/show_bug.cgi?id=883322)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_3659d679_20250126_034948.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from wiki.mozilla.org_73f8d6fa_20250126_034948.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)


