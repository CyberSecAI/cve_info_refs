=== Content from github.com_e084aef7_20250126_054117.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffail2ban%2Ffail2ban%2Fcommit%2Feb2f0c927257120dfc32d2450fd63f1962f38821)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffail2ban%2Ffail2ban%2Fcommit%2Feb2f0c927257120dfc32d2450fd63f1962f38821)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=fail2ban%2Ffail2ban)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[fail2ban](/fail2ban)
/
**[fail2ban](/fail2ban/fail2ban)**
Public

* [Notifications](/login?return_to=%2Ffail2ban%2Ffail2ban) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2Ffail2ban%2Ffail2ban)
* [Star
   13k](/login?return_to=%2Ffail2ban%2Ffail2ban)

* [Code](/fail2ban/fail2ban)
* [Issues
  145](/fail2ban/fail2ban/issues)
* [Pull requests
  99](/fail2ban/fail2ban/pulls)
* [Discussions](/fail2ban/fail2ban/discussions)
* [Actions](/fail2ban/fail2ban/actions)
* [Projects
  0](/fail2ban/fail2ban/projects)
* [Wiki](/fail2ban/fail2ban/wiki)
* [Security](/fail2ban/fail2ban/security)
* [Insights](/fail2ban/fail2ban/pulse)

Additional navigation options

* [Code](/fail2ban/fail2ban)
* [Issues](/fail2ban/fail2ban/issues)
* [Pull requests](/fail2ban/fail2ban/pulls)
* [Discussions](/fail2ban/fail2ban/discussions)
* [Actions](/fail2ban/fail2ban/actions)
* [Projects](/fail2ban/fail2ban/projects)
* [Wiki](/fail2ban/fail2ban/wiki)
* [Security](/fail2ban/fail2ban/security)
* [Insights](/fail2ban/fail2ban/pulse)

## Commit

[Permalink](/fail2ban/fail2ban/commit/eb2f0c927257120dfc32d2450fd63f1962f38821)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

ENH: Improve postfix regex and add more samples

[Browse files](/fail2ban/fail2ban/tree/eb2f0c927257120dfc32d2450fd63f1962f38821)
Browse the repository at this point in the history

* Loading branch information

[![@kwirk](https://avatars.githubusercontent.com/u/328405?s=40&v=4)](/kwirk)

[kwirk](/fail2ban/fail2ban/commits?author=kwirk "View all commits by kwirk")
committed
Jul 20, 2013

1 parent
[a012b54](/fail2ban/fail2ban/commit/a012b5411715f3a478cd7b19acd70e652044d625)

commit eb2f0c9

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**15 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* config/filter.d

  + config/filter.d/postfix.conf
    [postfix.conf](#diff-5dd3b7c175c0aeb8de6bbc86eecd3a969f46b54764d2fa5cddf7155c32dd26a3)
* testcases/files/logs

  + testcases/files/logs/postfix
    [postfix](#diff-27711a1d717fe41b51f1ec1fc03f718d049fb79330a2ec0e47a9d3b698c4e724)

## There are no files selected for viewing

13 changes: 11 additions & 2 deletions

13
[config/filter.d/postfix.conf](#diff-5dd3b7c175c0aeb8de6bbc86eecd3a969f46b54764d2fa5cddf7155c32dd26a3 "config/filter.d/postfix.conf")

Show comments

[View file](/fail2ban/fail2ban/blob/eb2f0c927257120dfc32d2450fd63f1962f38821/config/filter.d/postfix.conf)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,17 +4,26 @@ |
|  |  | # |
|  |  | # |
|  |  |  |
|  |  | [INCLUDES] |
|  |  |  |
|  |  | # Read common prefixes. If any customizations available -- read them from |
|  |  | # common.local |
|  |  | before = common.conf |
|  |  |  |
|  |  |  |
|  |  | [Definition] |
|  |  |  |
|  |  | \_daemon = postfix/smtpd |
|  |  |  |
|  |  | # Option: failregex |
|  |  | # Notes.: regex to match the password failures messages in the logfile. The |
|  |  | # host must be matched by a group named "host". The tag "<HOST>" can |
|  |  | # be used for standard IP/hostname matching and is only an alias for |
|  |  | # (?:::f{4,6}:)?(?P<host>[\w\-.^\_]+) |
|  |  | # Values: TEXT |
|  |  | # |
|  |  | failregex = reject: RCPT from (.\*)\[<HOST>\]: 554 |
|  |  | reject: RCPT from (.\*)\[<HOST>\]: 450 4\.7\.1 : Helo command rejected: Host not found; from=<> to=<> proto=ESMTP helo= \*$ |
|  |  | failregex = ^%(\_\_prefix\_line)sNOQUEUE: reject: RCPT from \S+\[<HOST>\]: 554 5\.7\.1 .\*$ |
|  |  | ^%(\_\_prefix\_line)sNOQUEUE: reject: RCPT from \S+\[<HOST>\]: 450 4\.7\.1 : Helo command rejected: Host not found; from=<> to=<> proto=ESMTP helo= \*$ |
|  |  |  |
|  |  | # Option: ignoreregex |
|  |  | # Notes.: regex to ignore. If this regex matches, the line is ignored. |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[testcases/files/logs/postfix](#diff-27711a1d717fe41b51f1ec1fc03f718d049fb79330a2ec0e47a9d3b698c4e724 "testcases/files/logs/postfix")

Show comments

[View file](/fail2ban/fail2ban/blob/eb2f0c927257120dfc32d2450fd63f1962f38821/testcases/files/logs/postfix)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,3 +4,7 @@ |
|  |  | Feb 21 09:21:54 xxx postfix/smtpd[14398]: NOQUEUE: reject: RCPT from example.com[192.0.43.10]: 450 4.7.1 : Helo command rejected: Host not found; from=<> to=<> proto=ESMTP helo= |
|  |  | # failJSON: { "time": "2005-07-12T07:47:48", "match": true , "host": "1.2.3.4" } |
|  |  | Jul 12 07:47:48 saturn postfix/smtpd[8738]: NOQUEUE: reject: RCPT from 1-2-3-4-example.com[1.2.3.4]: 554 5.7.1 <smtp@example.com>: Relay access denied; from=<john@example.com> to=<smtp@example.org> proto=SMTP helo=<198.51.100.17> |
|  |  | # failJSON: { "time": "2005-07-18T23:12:56", "match": true , "host": "192.51.100.65" } |
|  |  | Jul 18 23:12:56 xxx postfix/smtpd[8738]: NOQUEUE: reject: RCPT from foo[192.51.100.65]: 554 5.7.1 <bad.domain>: Helo command rejected: match bad.domain; from=<foo@good.domain> to=<foo@porcupine.org> proto=SMTP helo=<bad.domain> |
|  |  | # failJSON: { "time": "2005-07-18T23:12:56", "match": true , "host": "192.51.100.43" } |
|  |  | Jul 18 23:12:56 xxx postfix/smtpd[8738]: NOQUEUE: reject: RCPT from foo[192.51.100.43]: 554 5.7.1 <foo@bad.domain>: Sender address rejected: match bad.domain; from=<foo@bad.domain> to=<foo@porcupine.org> proto=SMTP helo=<192.51.100.43> |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `eb2f0c9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffail2ban%2Ffail2ban%2Fcommit%2Feb2f0c927257120dfc32d2450fd63f1962f38821) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_1b1ff805_20250126_054119.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffail2ban%2Ffail2ban%2Fcommit%2Fbd175f026737d66e7110868fb50b3760ff75e087)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffail2ban%2Ffail2ban%2Fcommit%2Fbd175f026737d66e7110868fb50b3760ff75e087)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=fail2ban%2Ffail2ban)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[fail2ban](/fail2ban)
/
**[fail2ban](/fail2ban/fail2ban)**
Public

* [Notifications](/login?return_to=%2Ffail2ban%2Ffail2ban) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2Ffail2ban%2Ffail2ban)
* [Star
   13k](/login?return_to=%2Ffail2ban%2Ffail2ban)

* [Code](/fail2ban/fail2ban)
* [Issues
  145](/fail2ban/fail2ban/issues)
* [Pull requests
  99](/fail2ban/fail2ban/pulls)
* [Discussions](/fail2ban/fail2ban/discussions)
* [Actions](/fail2ban/fail2ban/actions)
* [Projects
  0](/fail2ban/fail2ban/projects)
* [Wiki](/fail2ban/fail2ban/wiki)
* [Security](/fail2ban/fail2ban/security)
* [Insights](/fail2ban/fail2ban/pulse)

Additional navigation options

* [Code](/fail2ban/fail2ban)
* [Issues](/fail2ban/fail2ban/issues)
* [Pull requests](/fail2ban/fail2ban/pulls)
* [Discussions](/fail2ban/fail2ban/discussions)
* [Actions](/fail2ban/fail2ban/actions)
* [Projects](/fail2ban/fail2ban/projects)
* [Wiki](/fail2ban/fail2ban/wiki)
* [Security](/fail2ban/fail2ban/security)
* [Insights](/fail2ban/fail2ban/pulse)

## Commit

[Permalink](/fail2ban/fail2ban/commit/bd175f026737d66e7110868fb50b3760ff75e087)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

ENH: Improve cyrus-imap regex and add sample log file

[Browse files](/fail2ban/fail2ban/tree/bd175f026737d66e7110868fb50b3760ff75e087)
Browse the repository at this point in the history

* Loading branch information

[![@kwirk](https://avatars.githubusercontent.com/u/328405?s=40&v=4)](/kwirk)

[kwirk](/fail2ban/fail2ban/commits?author=kwirk "View all commits by kwirk")
committed
Jul 20, 2013

1 parent
[83a80a2](/fail2ban/fail2ban/commit/83a80a29ea51d1cb2dc1ce45a33b1d44a8619c9c)

commit bd175f0

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**22 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* config/filter.d

  + config/filter.d/cyrus-imap.conf
    [cyrus-imap.conf](#diff-eaf2d2abdc27b37822883d0e1cd60e75910c8e10d89e16c354b4befa47740401)
* testcases/files/logs

  + testcases/files/logs/cyrus-imap
    [cyrus-imap](#diff-5ee6db86d1860bdfafc99f38275d15e788b5df0ef02f3affc479ad3017eba7a0)

## There are no files selected for viewing

16 changes: 12 additions & 4 deletions

16
[config/filter.d/cyrus-imap.conf](#diff-eaf2d2abdc27b37822883d0e1cd60e75910c8e10d89e16c354b4befa47740401 "config/filter.d/cyrus-imap.conf")

Show comments

[View file](/fail2ban/fail2ban/blob/bd175f026737d66e7110868fb50b3760ff75e087/config/filter.d/cyrus-imap.conf)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,19 +4,27 @@ |
|  |  | # |
|  |  | # |
|  |  |  |
|  |  | [INCLUDES] |
|  |  |  |
|  |  | # Read common prefixes. If any customizations available -- read them from |
|  |  | # common.local |
|  |  | before = common.conf |
|  |  |  |
|  |  |  |
|  |  | [Definition] |
|  |  |  |
|  |  | \_daemon = (?:cyrus/)?(?:imapd?|pop3d?) |
|  |  |  |
|  |  | # Option: failregex |
|  |  | # Notes.: regex to match the password failures messages in the logfile. The |
|  |  | # host must be matched by a group named "host". The tag "<HOST>" can |
|  |  | # be used for standard IP/hostname matching and is only an alias for |
|  |  | # (?:::f{4,6}:)?(?P<host>[\w\-.^\_]+) |
|  |  | # Values: TEXT |
|  |  | # |
|  |  | failregex = : badlogin: .\*\[<HOST>\] plaintext .\*SASL\(-13\): authentication failure: checkpass failed$ |
|  |  | : badlogin: .\*\[<HOST>\] LOGIN \[SASL\(-13\): authentication failure: checkpass failed\]$ |
|  |  | : badlogin: .\*\[<HOST>\] (?:CRAM-MD5|NTLM) \[SASL\(-13\): authentication failure: incorrect (?:digest|NTLM) response\]$ |
|  |  | : badlogin: .\*\[<HOST>\] DIGEST-MD5 \[SASL\(-13\): authentication failure: client response doesn't match what we generated\]$ |
|  |  | failregex = ^%(\_\_prefix\_line)sbadlogin: \S+ \[<HOST>\] (?:plaintext|LOGIN) .\* \[?SASL\(-13\): authentication failure: checkpass failed\]?$ |
|  |  | ^%(\_\_prefix\_line)sbadlogin: \S+ \[<HOST>\] (?:CRAM-MD5|NTLM) \[SASL\(-13\): authentication failure: incorrect (?:digest|NTLM) response\]$ |
|  |  | ^%(\_\_prefix\_line)sbadlogin: \S+ \[<HOST>\] DIGEST-MD5 \[SASL\(-13\): authentication failure: client response doesn't match what we generated\]$ |
|  |  |  |
|  |  | # Option: ignoreregex |
|  |  | # Notes.: regex to ignore. If this regex matches, the line is ignored. |
| Expand Down | |  |

10 changes: 10 additions & 0 deletions

10
[testcases/files/logs/cyrus-imap](#diff-5ee6db86d1860bdfafc99f38275d15e788b5df0ef02f3affc479ad3017eba7a0 "testcases/files/logs/cyrus-imap")

Show comments

[View file](/fail2ban/fail2ban/blob/bd175f026737d66e7110868fb50b3760ff75e087/testcases/files/logs/cyrus-imap)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,10 @@ |
|  |  | # failJSON: { "time": "2005-01-04T21:51:05", "match": true , "host": "127.0.0.1" } |
|  |  | Jan 4 21:51:05 hostname cyrus/imap[5355]: badlogin: localhost.localdomain [127.0.0.1] plaintext cyrus@localdomain SASL(-13): authentication failure: checkpass failed |
|  |  | # failJSON: { "time": "2005-02-20T17:23:32", "match": true , "host": "198.51.100.23" } |
|  |  | Feb 20 17:23:32 domain cyrus/pop3[18635]: badlogin: localhost [198.51.100.23] plaintext administrator SASL(-13): authentication failure: checkpass failed |
|  |  | # failJSON: { "time": "2005-02-20T17:23:32", "match": true , "host": "1.2.3.4" } |
|  |  | Feb 20 17:23:32 cyrus/pop3[4297]: badlogin: example.com [1.2.3.4] plaintext mail0001 SASL(-13): authentication failure: checkpass failed |
|  |  | # failJSON: { "time": "2005-06-08T18:11:13", "match": true , "host": "198.51.100.45" } |
|  |  | Jun 8 18:11:13 lampserver imap[4480]: badlogin: example.com [198.51.100.45] DIGEST-MD5 [SASL(-13): authentication failure: client response doesn't match what we generated] |
|  |  | # failJSON: { "time": "2004-12-21T10:01:57", "match": true , "host": "198.51.100.57" } |
|  |  | Dec 21 10:01:57 hostname imapd[18454]: badlogin: example.com [198.51.100.57] CRAM-MD5 [SASL(-13): authentication failure: incorrect digest response] |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `bd175f0`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffail2ban%2Ffail2ban%2Fcommit%2Fbd175f026737d66e7110868fb50b3760ff75e087) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.kb.cert.org_0cfcb20e_20250125_032014.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#686662

## Fail2ban postfix and cyrus-imap filters contain denial-of-service vulnerabilities

#### Vulnerability Note VU#686662

Original Release Date: 2014-01-28 | Last Revised: 2014-01-28

---

### Overview

Fail2ban versions prior to 0.8.11 are susceptible to a denial-of-service attack when a maliciously crafted email address is parsed by the postfix or cyrus-imap filters. If users have not deployed either of these filters then they are not affected.

### Description

| Fail2ban versions prior to 0.8.11 are susceptible to a denial-of-service attack when a maliciously crafted email address is parsed by the postfix or cyrus-imap filters. An attacker can cause arbitrary IP addresses to be blocked by fail2ban.  CVE-2013-7177: cyrus-imap<https://github.com/fail2ban/fail2ban/commit/bd175f026737d66e7110868fb50b3760ff75e087>CVE-2013-7176: postfix<https://github.com/fail2ban/fail2ban/commit/eb2f0c927257120dfc32d2450fd63f1962f38821> |
| --- |

### Impact

| A remote unauthenticated attacker may cause arbitrary IP addresses to be blocked by Fail2ban causing legitimate users to be blocked from accessing services protected by Fail2ban. |
| --- |

### Solution

| **Apply an Update**[Fail2Ban 0.8.11](http://www.fail2ban.org/wiki/index.php/Downloads) addresses these vulnerabilities. Users are advised to upgrade to Fail2ban 0.8.11 or later. |
| --- |

### Vendor Information

686662
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23686662/) to view vendors.**
### [Fail2ban](#JALR-9FMTFN) Affected

Updated:  January 23, 2014

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 7.8 | AV:N/AC:L/Au:N/C:N/I:N/A:C |
| Temporal | 6.4 | E:F/RL:OF/RC:C |
| Environmental | 4.8 | CDP:ND/TD:M/CR:ND/IR:ND/AR:ND |

### References

* <http://www.fail2ban.org>
* <https://github.com/fail2ban/fail2ban/commit/bd175f026737d66e7110868fb50b3760ff75e087>
* <https://github.com/fail2ban/fail2ban/commit/eb2f0c927257120dfc32d2450fd63f1962f38821>
### Acknowledgements

Thanks to Steven Hiscocks for reporting this vulnerability.

This document was written by Jared Allar.

### Other Information

| **CVE IDs:** | [CVE-2013-7176](http://web.nvd.nist.gov/vuln/detail/CVE-2013-7176), [CVE-2013-7177](http://web.nvd.nist.gov/vuln/detail/CVE-2013-7177) |
| --- | --- |
| **Date Public:** | 2014-01-20 |
| **Date First Published:** | 2014-01-28 |
| **Date Last Updated:** | 2014-01-28 15:09 UTC |
| **Document Revision:** | 14 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from bugzilla.novell.com_d380ebb6_20250126_054130.html ===




=== Content from bugzilla.novell.com_ae583ca2_20250126_054132.html ===




=== Content from bugzilla.novell.com_6d795bcf_20250126_054127.html ===




=== Content from www.debian.org_c07e8300_20250125_032014.html ===


---

[[Date Prev](msg00160.html)][[Date Next](msg00162.html)]
[[Thread Prev](msg00160.html)][[Thread Next](msg00162.html)]
[[Date Index](maillist.html#00161)]
[[Thread Index](threads.html#00161)]

# [SECURITY] [DSA 2979-1] fail2ban security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 2979-1] fail2ban security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Thu, 17 Jul 2014 17:59:11 +0200
* *Message-id*: <[[🔎]](/msgid-search/20140717155911.GA2481%40pisco.westfalen.local) [20140717155911.GA2481@pisco.westfalen.local](msg00161.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-2979-1                   security@debian.org
<http://www.debian.org/security/>                        Moritz Muehlenhoff
July 17, 2014                          <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : fail2ban
CVE ID         : CVE-2013-7176 CVE-2013-7177

Two vulnerabilities were discovered in Fail2ban, a solution to ban hosts
that cause multiple authentication errors. When using Fail2ban to monitor
Postfix or Cyrus IMAP logs, improper input validation in log parsing
could enable a remote attacker to trigger an IP ban on arbitrary
addresses, resulting in denial of service.

For the stable distribution (wheezy), these problems have been fixed in
version 0.8.6-3wheezy3.

For the testing distribution (jessie), these problems have been fixed in
version 0.8.11-1.

For the unstable distribution (sid), these problems have been fixed in
version 0.8.11-1.

We recommend that you upgrade your fail2ban packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <http://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBAgAGBQJTx/KVAAoJEBDCk7bDfE42Wc8QAIbUSUMrVOA2cu12hu/mJYtk
sm1qSRnpcGWvfTnBvQgMEbaYJWSb1JcVRLGZYtJsD5TCukK/Y1vUoI2XzznPvbN0
Qxcjrk92XteTga9wJHmB4Rm2C6I/qhgI7JqdywARRh8qpdT5aJoqMcy+cOJfypW3
AJ+Y61333bObYKthUVyABhLHdEEZkJKN7lcwx/75vxqHYGs+kZI/MKr1Rxlr3xBd
uZazEXNgBsVgqAeeEzHRvIDVyLoccxqd5yyvbZcodHSuLz9wgelPsydZOndO4RNL
zlb6GzE7hon0/e9I2wIJhFWogdMDgE69U0PrLvZotboPUkcxiwHuwHb2y6L2FUb9
qsoZgD/KdvrDm7hcPqKbU3r1V1cDtcR1VeKm2NOhA2AEP/6jK1iIodVQhJuMOarI
PmxNRkUnVJvhg6wuMQLczDfaEQubMTrdwQnimJxoBllACXeXXSYhap0sHYNA96iD
/5SadvTAOAYGbPqYHVN9FoFgR26n6O24NCAv9JHTzIi/YCx5DlpA47alPj/43XVL
ulZ3BEMbFeKtnb6AkuDI4QVaU9ywtKOeWECZRjbx3xx/6m/cYDBcDPuHiileBJWA
JiYgVISepN74MYDbeE4w3kGjzE9+9RYnLjJtdv6+yY/rNzWrrZ6spdoT1xHgOhAm
8OltDtMXSTd74mNlOou9
=I7tY
-----END PGP SIGNATURE-----

```

---



=== Content from lists.opensuse.org_b2b4abcd_20250125_032013.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/JG3BFBSMKVU35NIQ2VKH63TSFZRQMU3F/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/JG3BFBSMKVU35NIQ2VKH63TSFZRQMU3F/)

[Manage this list](/manage/lists/updates.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/JG3BFBSMKVU35NIQ2VKH63TSFZRQMU3F/)
[Sign Up](/accounts/signup/?next=/archives/list/updates%40lists.opensuse.org/message/JG3BFBSMKVU35NIQ2VKH63TSFZRQMU3F/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/updates%40lists.opensuse.org/thread/JG3BFBSMKVU35NIQ2VKH63TSFZRQMU3F/#JG3BFBSMKVU35NIQ2VKH63TSFZRQMU3F)

# openSUSE-SU-2014:0348-1: moderate: fail2ban: security and bugfix upgrade to version 0.8.12

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

8 Mar
2014

8 Mar
'14

19:04

openSUSE Security Update: fail2ban: security and bugfix upgrade to version 0.8.12
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2014:0348-1
Rating: moderate
References: #824710 #861503 #861504
Cross-References: CVE-2013-2178 CVE-2013-7176 CVE-2013-7177
Affected Products:
openSUSE 13.1
openSUSE 12.3
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes three vulnerabilities is now available.
Description:
The fail2ban tool was updated to version 0.8.12 to fix
various security issues and also brings bugfixes and
features.
Security issues fixed: A remote unauthenticated attacker
may cause arbitrary IP addresses to be blocked by Fail2ban
causing legitimate users to be blocked from accessing
services protected by Fail2ban. CVE-2013-7177 (cyrus-imap)
and CVE-2013-7176 (postfix)
- Use new flushlogs syntax after logrotate
- Update to version 0.8.12
\* Log rotation can now occur with the command "flushlogs"
rather than reloading fail2ban or keeping the logtarget
settings consistent in jail.conf/local and
/etc/logrotate.d/fail2ban. (dep#697333, rh#891798).
\* Added ignorecommand option for allowing dynamic
determination as to ignore and IP or not.
\* Remove indentation of name and loglevel while logging
to SYSLOG to resolve syslog(-ng) parsing problems.
(dep#730202). Log lines now also report "[PID]" after
the name portion too.
\* Epoch dates can now be enclosed within []
\* New actions: badips, firewallcmd-ipset, ufw,
blocklist\_de
\* New filters: solid-pop3d, nsd, openwebmail, horde,
freeswitch, squid, ejabberd, openwebmail, groupoffice
\* Filter improvements:
- apache-noscript now includes php cgi scripts
- exim-spam filter to match spamassassin log entry for
option SAdevnull.
- Added to sshd filter expression for "Received
disconnect from : 3: Auth fail"
- Improved ACL-handling for Asterisk
- Added improper command pipelining to postfix filter.
\* General fixes:
- Added lots of jail.conf entries for missing filters
that creaped in over the last year.
- synchat changed to use push method which verifies
whether all data was send. This ensures that all data is
sent before closing the connection.
- Fixed python 2.4 compatibility (as sub-second in date
patterns weren't 2.4 compatible)
- Complain/email actions fixed to only include relevant
IPs to reporting
\* Filter fixes:
- Added HTTP referrer bit of the apache access log to
the apache filters.
- Apache 2.4 perfork regexes fixed
- Kernel syslog expression can have leading spaces
- allow for ",milliseconds" in the custom date format
of proftpd.log
- recidive jail to block all protocols
- smtps not a IANA standard so may be missing from
/etc/services. Due to (still) common use 465 has been used
as the explicit port number
- Filter dovecot reordered session and TLS items in
regex with wider scope for session characters
\* Ugly Fixes (Potentially incompatible changes):
- Unfortunately at the end of last release when the
action firewall-cmd-direct-new was added it was too long
and had a broken action check. The action was renamed to
firewallcmd-new to fit within jail name name length.
(gh#fail2ban/fail2ban#395).
- Last release added mysqld-syslog-iptables as a jail
configuration. This jailname was too long and it has been
renamed to mysqld-syslog.
- Fixed formating of github references in changelog
- reformatted spec-file
- Update to version 0.8.11
- In light of CVE-2013-2178 that triggered our last release
we have put a significant effort into tightening all of
the regexs of our filters to avoid another similar
vulnerability. We haven't examined all of these for a
potential DoS scenario however it is possible that
another DoS vulnerability exists that is fixed by this
release. A large number of filters have been updated to
include more failure regexs supporting previously
unbanned failures and support newer application versions
too. We have test cases for most of these now however if
you have other examples that demonstrate that a filter is
insufficient we welcome your feedback. During the
tightening of the regexs to avoid DoS vulnerabilities
there is the possibility that we have inadvertently,
despite our best intentions, incorrectly allowed a
failure to continue.
Addresses a possible DoS. Closes
gh#fail2ban/fail2ban#248, bnc#824710 within [Init]. Closes
gh#fail2ban/fail2ban#232
\* Updates to asterisk filter. Closes
gh#fail2ban/fail2ban#227, gh#fail2ban/fail2ban#230.
\* Updates to asterisk to include AUTH\_UNKNOWN\_DOMAIN.
Closes gh#fail2ban/fail2ban#244. on Fedora. Closes
gh#fail2ban/fail2ban#112. Thanks to Camusensei for the
bug report. insight. Closes gh#fail2ban/fail2ban#103.
\* [f2156604] pyinotify -- monitor IN\_MOVED\_TO events.
Closes gh#fail2ban/fail2ban#184. Thanks to Jon Foster for
report and troubleshooting. Orion Poplawski
\* [39667ff6] Avoid leaking file descriptors. Closes
gh#fail2ban/fail2ban#167. Closes gh#fail2ban/fail2ban#147,
gh#fail2ban/fail2ban#148.
\* [b6a68f51] Fix delaction on server side. Closes
gh#fail2ban/fail2ban#124. the fail2ban-client. Closes
gh#fail2ban/fail2ban#134. gh#fail2ban/fail2ban#70. Thanks
to iGeorgeX for the idea.
\* [96eb8986] ' and " should also be escaped in action
tags Closes gh#fail2ban/fail2ban#109 beilber for the idea.
Closes gh#fail2ban/fail2ban#114. fail2ban is running.
Closes gh#fail2ban/fail2ban#166.
\* [29d0df5] Add mysqld filter. Closes
gh#fail2ban/fail2ban#152.
\* [bba3fd8] Add Sogo filter. Closes
gh#fail2ban/fail2ban#117.
\* [be06b1b] Add action for iptables-ipsets. Closes
gh#fail2ban/fail2ban#102.
\* [f336d9f] Add filter for webmin. Closes
gh#fail2ban/fail2ban#99. consistently. Closes
gh#fail2ban/fail2ban#172.
\* [b36835f] Add get cinfo to fail2ban-client. Closes
gh#fail2ban/fail2ban#124. Closes gh#fail2ban/fail2ban#142.
Closes gh#fail2ban/fail2ban#126. Bug report by Michael
Heuberger.
\* [3aeb1a9] Add jail.conf manual page. Closes
gh#fail2ban/fail2ban#143. banning due to misconfigured DNS.
Close gh#fail2ban/fail2ban#64
\* [0935566,5becaf8] Various python 2.4 and 2.5
compatibility fixes. Close gh#fail2ban/fail2ban#83 in the
console. Close gh#fail2ban/fail2ban#91 the log file to take
'banip' or 'unbanip' in effect. Close
gh#fail2ban/fail2ban#81, gh#fail2ban/fail2ban#86
\* [f52ba99] downgraded "already banned" from WARN to
INFO level. Closes gh#fail2ban/fail2ban#79 for this
gh#fail2ban/fail2ban#87) message stays non-unicode. Close
gh#fail2ban/fail2ban#32 friend to developers stuck with
Windows (Closes gh#fail2ban/fail2ban#66) repeated
offenders. Close gh#fail2ban/fail2ban#19 Close
gh#fail2ban/fail2ban#47 (Closes: #669063)
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 13.1:
zypper in -t patch openSUSE-2014-194
- openSUSE 12.3:
zypper in -t patch openSUSE-2014-194
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 13.1 (noarch):
fail2ban-0.8.12-2.5.1
- openSUSE 12.3 (noarch):
fail2ban-0.8.12-2.12.1
References:
<http://support.novell.com/security/cve/CVE-2013-2178.html>
<http://support.novell.com/security/cve/CVE-2013-7176.html>
<http://support.novell.com/security/cve/CVE-2013-7177.html>
<https://bugzilla.novell.com/824710>
<https://bugzilla.novell.com/861503>
<https://bugzilla.novell.com/861504>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/updates%40lists.opensuse.org/message/JG3BFBSMKVU35NIQ2VKH63TSFZRQMU3F/)
Use email software

[Back to the thread](/archives/list/updates%40lists.opensuse.org/thread/JG3BFBSMKVU35NIQ2VKH63TSFZRQMU3F/#JG3BFBSMKVU35NIQ2VKH63TSFZRQMU3F)

[Back to the list](/archives/list/updates%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.


