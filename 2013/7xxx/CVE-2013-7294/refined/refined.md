The provided content is a code commit from the libreswan project, specifically addressing a security vulnerability related to handling IKEv2 I1 notification packets without a KE payload.

**Root Cause:**
The vulnerability stems from improper handling of IKEv2 Initial Exchange (I1) packets that contain a notification payload but are missing a Key Exchange (KE) payload. The code was previously not properly rejecting these packets and could potentially lead to issues with state management.

**Weaknesses/Vulnerabilities:**
- **Missing KE Payload Check:** The code lacked a proper check to ensure that an IKEv2 I1 packet contained a KE payload when expected.
- **State Corruption:**  Improper handling of the missing KE payload could lead to state corruption and potentially unexpected behavior in the IKE daemon.

**Impact of Exploitation:**
The impact of exploiting this vulnerability is not detailed, but it could potentially cause denial of service due to the mismanaged state.

**Attack Vectors:**
- The attack vector is a malicious IKEv2 peer sending a specially crafted IKEv2 I1 packet that contains a notification payload but omits the expected KE payload.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to send network packets to the vulnerable IKE daemon.
- The attacker needs to understand the IKEv2 protocol and be able to craft malicious packets.

**Code Changes:**
The commit includes code changes to specifically check for the presence of the KE payload in I1 messages and log the notification if present, but then reject the message if the KE payload is absent. Additionally, the commit contains some cleanup related to resetting globals. The code was changed to handle the missing KE payload in IKEv2 I1 packets more strictly by rejecting the packet and logging the event. Additionally, the log message was changed to include the peer's IP address and port to assist debugging. The commit also includes a log message when an invalid DH group is received in the KE payload.