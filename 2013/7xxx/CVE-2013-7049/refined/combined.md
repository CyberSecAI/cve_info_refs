=== Content from seclists.org_e650ae2c_20250125_061927.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](481)
[By Date](date.html#482)
[![Next](/images/right-icon-16x16.png)](483)

[![Previous](/images/left-icon-16x16.png)](480)
[By Thread](index.html#482)
[![Next](/images/right-icon-16x16.png)](489)

![](/shared/images/nst-icons.svg#search)

# CVE Request: ZNC IRC Bouncer DoS in FiSH Plugin

---

*From*: Jurriaan Bremer <jurriaanbremer () gmail com>

*Date*: Wed, 11 Dec 2013 22:38:01 +0100

---

```
Hi,

There's an issue in the way FiSH loads public keys from users when
initiating a new private conversation (or "query" in irc.)

The main ZNC repository [1] does *not* ship with the FiSH extension by
default. However, the Windows port [2] of ZNC does ship with the FiSH
extension [3] by default. (You have to enable it manually though.)

The vulnerable part of the code can be found at line 606 of fish.cpp
[4]. When initiating a new query, both users send their public key to
each other - FiSH does this automatically for you. The public keys are
encoded using base64 when sent to the other user. In [4] you can see
that the FiSH plugin decodes the base64 stream to obtain the other
user's public key. However, no bounds are checked, and thus the buffer
"raw_buf" can be overflowed.

Luckily both x86 and x64 builds of the FiSH extension on Windows have
stack cookies, rendering this vulnerability unexploitable. However, even
though it's unexploitable, the stack cookie check does raise an
exception when overflown, after which the process crashes, and the
daemon won't function anymore - making it an easy Denial of Service.

An important side-note for non-Windows platforms. Even though ZNC
doesn't ship with the FiSH plugin by default, it does reference the
vulnerable Windows port implementation in their wiki [5] (see the
"mirror" - the link to the SVN repository is dead.) Furthermore, the two
referenced pastes [6][7] share the same vulnerability.

PoC: Having opened a query with a user running ZNC with the FiSH
extension loaded, send the following message. Right after this message
has been sent the user will be disconnected as his or her ZNC daemon has
crashed.

/notice <user> DH1080_INIT QUFBQUFBQUFBQUFBQUFBQUFBQUF...

(Repeat the "QUFB" pattern until the string is, let's say, 400
characters in length. Note, "QUFB" is "AAA" after base64 decoding.)

Or, when scripting a simple DoS bot, you'd do something like this:

buf = ('A'*300).encode('base64').replace('\n', '')
s.send("NOTICE %s :DH1080_INIT %s\r\n" % (user, buf))

Workaround: Adding a simple buffer size argument to the b64toh function
would suffice. An easier approach would be to check the length of the
base64 encoded string. I.e., it must not exceed ~265 bytes if it has to
fit in a 200-byte sized buffer after decoding.

Another fine workaround would be using this [8] implementation. (I'm
honestly not really sure which version, if not a stripped down / merged
into one file version, of FiSH is used by the Windows port.)

Also CC'd the maintainer of the Windows port - hi! :p

Best Regards,
Jurriaan

[1] <https://github.com/znc/znc>
[2] <https://code.google.com/p/znc-msvc/>
[3]
<https://code.google.com/p/znc-msvc/source/browse/trunk/main/znc-msvc/modules/extra_win32/fish.cpp>
[4]
<https://code.google.com/p/znc-msvc/source/browse/trunk/main/znc-msvc/modules/extra_win32/fish.cpp#606>
[5] <http://wiki.znc.in/Fish#Getting_the_Code>
[6] <http://pastebin.com/NDVtfcVG> (Line 609)
[7] <http://slexy.org/view/s2poFq0BaF> (Line 605)
[8] <http://mewbies.com/how_to_install_fish_for_irssi_tutorial.htm>

```

---

[![Previous](/images/left-icon-16x16.png)](481)
[By Date](date.html#482)
[![Next](/images/right-icon-16x16.png)](483)

[![Previous](/images/left-icon-16x16.png)](480)
[By Thread](index.html#482)
[![Next](/images/right-icon-16x16.png)](489)

### Current thread:

* **CVE Request: ZNC IRC Bouncer DoS in FiSH Plugin** *Jurriaan Bremer (Dec 11)*
  + [Re: CVE Request: ZNC IRC Bouncer DoS in FiSH Plugin](489) *cve-assign (Dec 11)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from seclists.org_2669fac2_20250125_061927.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](488)
[By Date](date.html#489)
[![Next](/images/right-icon-16x16.png)](490)

[![Previous](/images/left-icon-16x16.png)](482)
[By Thread](index.html#489)
[![Next](/images/right-icon-16x16.png)](491)

![](/shared/images/nst-icons.svg#search)

# Re: CVE Request: ZNC IRC Bouncer DoS in FiSH Plugin

---

*From*: cve-assign () mitre org

*Date*: Thu, 12 Dec 2013 00:09:01 -0500 (EST)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

```
> ```
> no bounds are checked, and thus the buffer "raw_buf" can be overflowed
>
> ```

```

Use CVE-2013-7049.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJSqUS5AAoJEKllVAevmvmsFP8H/2nnWV/ZvMeRPco9M7N5YcrL
gBL2I1hXcL3nh+NblNaEnP+mCdM3Q5zNgiStLtyjE39slCZoElyIbQSnSn2BjWAw
NE29+PcpKnOqgfu7SjS5HePF+U/f788ksQdizoCtQ3lRcWzaGWj3gv/es7pPg4Dg
W1HbB9Gmp8SvOkt0DAeFBK93eC+QOw/HGRnQeM32ScGLg0Qac9dCwbGIG3AM5bV9
1v73xWv1XnU41LPbwir/eGPdiGNGC4vtjsABEL9CJzw4v5frPnLjznySc2rOCGqq
+sOUGZKUXpJox/lXmCzkD2MAVuK8vKIAyGXMZGkode3Hvu2VhVr1/l8BK2TwYw8=
=moi9
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](488)
[By Date](date.html#489)
[![Next](/images/right-icon-16x16.png)](490)

[![Previous](/images/left-icon-16x16.png)](482)
[By Thread](index.html#489)
[![Next](/images/right-icon-16x16.png)](491)

### Current thread:

* [CVE Request: ZNC IRC Bouncer DoS in FiSH Plugin](482) *Jurriaan Bremer (Dec 11)*
  + **Re: CVE Request: ZNC IRC Bouncer DoS in FiSH Plugin** *cve-assign (Dec 11)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


