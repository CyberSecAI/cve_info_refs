=== Content from www.nongnu.org_618c85fe_20250125_162703.html ===

Â»[Home](index.html)
Â»[News](NEWS.html)
Â»[Download](download.html)
Â»[Documentation](docs.html)
Â Â Â Â Â Â»[oathtool(1)](oathtool.1.html)
Â Â Â Â Â Â»[pskctool(1)](pskctool.1.html)
Â Â Â Â Â Â»[LiboathÂ API](liboath-api/liboath-oath.h.html)
Â Â Â Â Â Â»[PSKC Tutorial](libpskc-api/pskc-tutorial.html)
Â Â Â Â Â Â»[LibpskcÂ API](libpskc-api/pskc-reference.html)
Â Â Â Â Â Â»[pam\_oath](pam_oath.html)
Â»[Contribute](contrib.html)

OATH Toolkit
One-time password components

# OATH Toolkit NEWS

Version 2.6.12 (released 2024-10-03)

* Reported by Fabian Vogt (SUSE), and associated with CVE-2024-47191.
  See <https://gitlab.com/oath-toolkit/oath-toolkit/-/issues/43>.
  Security bug triggered by new feature in pam\_oath v2.6.7 released on
  2021-05-01 with the USER/HOME placeholder strings, see
  <https://gitlab.com/oath-toolkit/oath-toolkit/-/merge_requests/12>.

Quoting a writeup in an alternate patch by Matthias Gerstner (SUSE):
With the addition of the possibility to place a usersfile also into a
the `usersfile=` path specification, security issues sneaked in. The
PAM process usually runs with root privileges. The file operations in
an unprivileged userâs home directory follow symlinks both when
reading and creating files, allowing for a potential local root
exploit, because of the `fchown()` performed on the newly created
usersfile.

We drop privileges to the user that is being logged into, assuming it
has the necessary permissions for the usersfile belonging in their
home directory. This restricts the ability for non-root users to
affect files beyond their control via liboath.

* liboath: Donât follow symbolic links for usersfile updates.
  Reported by Fabian Vogt (SUSE), and associated with CVE-2024-47191.
  See <https://gitlab.com/oath-toolkit/oath-toolkit/-/issues/43>.
  Security bug triggered by new feature in pam\_oath v2.6.7 released on
  2021-05-01 with the USER/HOME placeholder strings, see
  <https://gitlab.com/oath-toolkit/oath-toolkit/-/merge_requests/12>.

The fix is to open files for writing in exclusive mode (i.e., fail if
the file exists including if it is a symbolic link).

We offer a brief self-test to reproduce the problem in
liboath/tests/tst\_fopen-wx.c which you may use as follows:

cc -o tst\_fopen-wx tst\_fopen-wx.c $(pkg-config --libs --cflags liboath)
rm -f cve.oath cve.oath.new cve.sshd-config cve.oath.lock
printf *HOTP/E/8\tsilver\t4711\t3132333435363738393031323334353637383930313233343536373839303132\n* > cve.oath
echo my-magic-cookie > cve.sshd-config
ln -s cve.sshd-config cve.oath.new
./tst\_fopen-wx cve.oath silver 670691 4711

If this is linked with a vulnerable liboath it will print:

FAIL: Liboath VULNERABLE to fopen(wx) bug.

If you link it to a fixed liboath it will print:

PASS: Your liboath is NOT VULNERABLE to fopen(wx) bug.

For convenience, the liboath/tests/tst\_fopen-wx.sh script can be used
to setup and invoke tst\_fopen-wx.

* We publish a minimal source-only tarball generated by *git archive*.
  This tarball only contains the files stored in version controlled
  sources, and no auxilliary files. The source-only tarball may be
  reproduced on a Trisquel 11 platform using Git at (or near) version
  2.46 from Guix. If something results in the *git archive* format
  changing again, the tarball can only be reproduced using an earlier
  system. The git version in AlmaLinux 8, AlmaLinux 9, RockyLinux 8 and
  RockyLinux 9 should all produce the same identical *git archive*
  tarball. The git version used on Debian 11, PureOS 10, Trisquel 11
  and Ubuntu 22.04 should all produce an identical tarball. These two
  *git archive* outputs are not the same, due to how Git works.
* oathtool: Fix test suite on 32-bit big-endian platforms. Fixes: #44.
  Patch by Helge Deller and thanks to Jan Zerebecki. See
  <https://lists.nongnu.org/archive/html/oath-toolkit-help/2024-04/msg00000.html>
  and <https://gitlab.com/oath-toolkit/oath-toolkit/-/issues/44>.
* libpskc: Donât call deprecated xmlMemoryDump.
* libpskc: fix implicit declaration with musl.
  See <https://gitlab.com/oath-toolkit/oath-toolkit/-/merge_requests/39>.
* libpskc: Fix linker warning when linked with mold.
  Thanks to Jan Palus, see
  <https://gitlab.com/oath-toolkit/oath-toolkit/-/merge_requests/30> and
  <https://gitlab.com/oath-toolkit/oath-toolkit/-/merge_requests/36> for
  regression testing.
* Various build fixes including updated gnulib files.
  Fixes Windows tzset build errors, among other things.

Version 2.6.11 (released 2024-01-11)

* liboath: Handle invalid base32 encoded secrets. Fixes: #41.
  The gnulib update in version 2.6.10 made the base32 encoding functions
  reject invalid encodings, but it appears as if these are wildly used.
  We now accept invalid encodings again. Thanks to DorancÃÂ© MartÃÂ­nez and
  Seres BendegÃÂºz for reports.

Version 2.6.10 (released 2024-01-03)

* Building from git uses a ./bootstrap script instead of *make bootstrap*.
* Build fixes for Windows.
  In particular, donât use filenames "aux.h" and "aux.c" which interact
  badly with the AUX special filename.
* Build fixes for Arch Linux.
* Various build fixes including updated gnulib files.
  One remaining gnulib self-test disabled.

Version 2.6.9 (released 2023-07-09)

* Improve compatibility with recent libxmlsec.
* Update gnulib files, dropping gnulib self-tests.

Version 2.6.8 (released 2023-07-09)

* libpskc: Fixes for recent libxmlsec releases.
* pam\_oath: Provide fallback pam\_modutil\_getpwnam implementation.
  Fixes <https://gitlab.com/oath-toolkit/oath-toolkit/-/issues/26> on
  Mac OS. Patch from Nick Gaya <nicholasgaya+github@gmail.com>.
* pam\_oath: Donât fail authentication when pam\_modutil\_getpwnam doesnât
* Regression introduced in previous release. Reported by Nick Gaya
  <nicholasgaya+github@gmail.com>.
* pam\_oath: Self-test improvements.
  Patch from Nick Gaya <nicholasgaya+github@gmail.com>.
* liboath: Builds on Windows.
  The oath\_authenticate\_usersfile function is just a stub that returns
  an error. This allows for use of the rest of the library on Windows.
  Thanks to David Woodhouse, see
  <https://gitlab.com/oath-toolkit/oath-toolkit/-/merge_requests/15>.
* Disable PAM self-tests on Mac. Fix --enable-root-tests logic.
* Donât ship gtk-doc PDFâs in tarball.
* Use gitlog-to-changelog instead of git2cl.
* Codespell typo fixes.
  Patch by Dimitri Papadopoulos.

Version 2.6.7 (released 2021-05-01)

* pam\_oath: Support variables in usersfile string parameter.
  the usersfile string in the pam\_oath configuration file. The
  placeholder values allow the user credentials file to be stored in a
  file path that is relative to the user, and mimics similar behavior
  found in google-authenticator-libpam.

The motivation for these changes is to allow for non-privileged
processes to use pam\_oath (e.g., for 2FA with
xscreensaver). Non-privileged and non-suid programs are unable to use
pam\_oath. These changes are a proposed alternative to a suid helper
binary as well.

Thanks to Jason Graham <jgraham@compukix.net> for the patch. See
<https://gitlab.com/oath-toolkit/oath-toolkit/-/merge_requests/12>.

* doc: Fix project URL in man pages.
  Thanks to Jason Graham <jgraham@compukix.net> for the patch. Fixes
  <https://gitlab.com/oath-toolkit/oath-toolkit/-/issues/19>.
* build: Drop use of libxmlâs AM\_PATH\_XML2 in favor of pkg-config.
* build: Modernize autotools usage.
  Most importantly, no longer use -Werror with AM\_INIT\_AUTOMAKE to make
  rebuilding from source more safe with future automake versions.
* Updated gnulib files.

Version 2.6.6 (released 2021-01-20)

* oathtool: Handle HOTP --counter values larger than 0x7FFFFFFFFFFFFFFF.
  Thanks to Jason Lai <jason99.lai@gmail.com> for report.
* doc: GTK-DOC manual improvements.
* Updated gnulib files.
  Fixes test-parse-datetime self-check. Fixes
  <https://gitlab.com/oath-toolkit/oath-toolkit/-/issues/20>.

Version 2.6.5 (released 2020-12-29)

* oathtool: Support for reading KEY and OTP from standard input or filename.
  KEY and OTP may now be given as *-* to mean stdin, or @FILE to read
  from a particular file. This is recommended on multi-user systems,
  since secrets as command line parameters leak. Based on a patch from
  Ian Jackson <ijackson@chiark.greenend.org.uk>. Fixes #6.
* pam\_oath: Fix unlikely logic fail on out of memory conditions.
  Patch from Matthias Gerstner.
* Doc fixes.

Version 2.6.4 (released 2020-11-11)

* libpskc: New --with-xmlsec-crypto-engine to hard-code crypto engine.
  Fixes <https://gitlab.com/oath-toolkit/oath-toolkit/-/issues/16>.
  Use it like --with-xmlsec-crypto-engine=gnutls or
  --with-xmlsec-crypto-engine=openssl if the default dynamic loading
  fails because of runtime linker search path issues.
* oathtool --totp --verbose now prints TOTP hash mode.
  Fixes <https://gitlab.com/oath-toolkit/oath-toolkit/-/issues/4>.
* oathtool: Hash names (e.g., SHA256) for --totp are now upper case.
  Fixes <https://gitlab.com/oath-toolkit/oath-toolkit/-/issues/3>.
  Lower/mixed case hash names are supported for compatibility.
* pam\_oath: Fail gracefully for missing users.
  Fixes <https://savannah.nongnu.org/support/index.php?109111>.
  This allows you to incrementally add support for OATH authentication
  instead of forcing it on all users. See updated pam\_oath/README on
  the *[user\_unknown=ignore success=ok]* parameter that can now be
  supplied to PAM configuration. Patch by Antoine BeauprÃÂ©
  <anarcat@debian.org>.
* Fix libpskc memory corruption bug.
  Fixes <https://savannah.nongnu.org/support/?108736>. Thanks to David
  Woodhouse and Jaroslav ÃÂ karvada for report, self check and patch.
* Fix man pages.
  Fixes <https://savannah.nongnu.org/support/?108312>. Thanks to
  Jaroslav ÃÂ karvada for the patch.
* Build fixes.

Version 2.6.3 (released 2020-11-07)

* pam\_oath: Fix self-tests.
* build: Update gnulib. Fix compiler warnings.
* Doc fixes.

Version 2.6.2 (released 2016-08-27)

* doc: Version controlled source code repository moved to GitLab.

Version 2.6.1 (released 2015-07-31)

* liboath: Fix *make check* on 32-bit systems.
  Report and patch by Christian Hesse.

Version 2.6.0 (released 2015-05-19)

* liboath: Support TOTP with HMAC-SHA256 and HMAC-SHA512.
  This adds new APIs oath\_totp\_generate2, oath\_totp\_validate4 and
  oath\_totp\_validate4\_callback.
* oathtool: The --totp parameter now take an optional argument to specify MAC.
  For example use --totp=sha256 to use HMAC-SHA256. When --totp is used
  the default HMAC-SHA1 is used, as before.
* pam\_oath: Mention in README that you shouldnât use insecure keys.
  Suggested by Robin.
* pam\_oath: Check return value from strdup.
  Patch by Eero HÃÂ¤kkinen.
* The files *gdoc* and *expect.oath* are now included in the tarball.
  Suggested by Jaroslav ÃÂ karvada.

Version 2.4.1 (released 2014-02-12)

* liboath: Fix usersfile bug that caused it to update the wrong line.
  When an usersfile contain multiple lines for the same user but with an
  unparsable token type (e.g., HOTP vs TOTP), the code would update the
  wrong line of the file. Since the then updated line could be a
  commented out line, this can lead to the same OTP being accepted
  multiple times which is a security vulnerability. Reported by Bas van
  Schaik <bas@sj-vs.net> and patch provided by Ilkka Virta
  <itvirta@iki.fi>. CVE-2013-7322

Version 2.4.0 (released 2013-07-21)

* liboath: Add new API methods for validating TOTP OTPs
  The new methods (oath\_totp\_validate3 and oath\_totp\_validate3\_callback)
  introduce a new parameter \*otp\_counter, which is set to the actual
  counter used to calculate the OTP (unless it is a NULL pointer). This
  allows for easier OTP replay detection in applications using liboath.
  Patch from Fabian GrÃÂ¼nbichler <fabian.gruenbichler@tuwien.ac.at>.

Version 2.2.0 (released 2013-07-07)

* libpskc: Add functions for setting PSKC data.
  The new functions are pskc\_add\_keypackage and all pskc\_set\_\* functions
  (see libpskc/include/pskc/keypackage.h). This allow you to write
  programs that generate new PSKC structures.
* liboath: Permit different passwords for different tokens for the same user.
  Thanks to Christian Hesse <list@eworm.de>.
* build: Improve building from git with most recent automake and gengetopt.
  Thanks to Christian Hesse <list@eworm.de>.
* build: Valgrind is not enabled by default.
  It causes too much false positives. For developers who want, use
  --enable-valgrind-tests. It is still enabled by default when building
  from the version controlled sources (see cfg.mk). Thanks to Christian
  Hesse <list@eworm.de>.
* liboath: Make header file usable from C++ (extern "C" guard).
  Reported by Alan Markus <alan.markus@gmail.com>.

Version 2.0.2 (released 2013-01-08)

* oathtool: Base32 decoding of keys are now more liberal in what accepts.
  It can now accept keys on the "gr6d 5br7 25s6 vnck v4vl hlao re"
  format, i.e., base32 data delimited using SPC and without padding.
  The old proper base32 format is still supported.
* liboath: oath\_base32\_decode now ignores SPC and adds pad characters.
* liboath: If password in usersfile is + then ignore supplied password.
  This enables the pam\_oath module to be used with external password
  verification. Based on patch from Ilkka Virta <itvirta@iki.fi>.
* tests: Fixed expiry date of some certificates used in the test suite.
  The last release would only complete *make check* during a 30 day window.
* API and ABI is backwards compatible with the previous version.

Version 2.0.1 (released 2012-10-24)

* libpskc, pskctool: Support sign and verify of PSKC data using XML DigSig.
* libpskc: XML Schema validation modified.
  The entire PSKC schema is now supported (before the XML Digital
  Signatures and Encryption parts were removed). The code now assumes
  that the schema is available in the local XML catalog. Thanks to Liam
  Quin for hints about XML catalogs.
* pskctool: the --check (-c) parameter was renamed to --info (-i).
* API and ABI is backwards compatible with the previous version.

Version 2.0.0 (released 2012-10-10)

* libpskc, pskctool: New components.
  The OATH Toolkit now supports the Portable Symmetric Key Container
  (PSKC) data format specified in RFC 6030 for dealing with key
  provisioning. There is a new low-level library libpskc for managing
  PSKC data for application developers and a new command line tool
  pskctool for interacting with PSKC data for users. The PSKC
  functionality depends on Libxml2 <http://xmlsoft.org/>. It can be
  disabled unconditionally using the ./configure-parameter
  --disable-pskc.
* liboath: Add manpages for library API.
* API and ABI is backwards compatible with the previous version.

Version 1.12.6 (released 2012-09-04)

* liboath: The usersfile is now fflushâed and fsyncâed.
* liboath: A memory leak fixed.
  Patch from Jed Laundry <jlaundry@jlaundry.com>, somewhat modified.
* oathtool: The --counter parameter now works on 32-bit platforms.
* API and ABI is backwards compatible with the previous version.
  OATH\_FILE\_FLUSH\_ERROR: Added.
  OATH\_FILE\_SYNC\_ERROR: Added.
  OATH\_FILE\_CLOSE\_ERROR: Added.
  OATH\_LAST\_ERROR: Added.

Version 1.12.5 (released 2012-08-19)

* oathtool: The --counter parameter now supports larger values.
  Before it used an *int* type and now it uses a *longlong* type.
  Needed for eSecuTech tokens as they use a 64-bit value for their
  initial counter. Reported by <cameron.bradley@wiretap.net.nz> see
  <https://savannah.nongnu.org/support/?108114>.
* Added gnulib self-tests.
* API and ABI is backwards compatible with the previous version.

Version 1.12.4 (released 2012-06-17)

* liboath: Usersfile code handles multiple lines for a single user.
  This can be used when a single user carries multiple tokens (with
  different OATH secrets) and any of them should be permitted.
  Suggested by Tim Eggleston <lists@timeggleston.co.uk>.
* API and ABI is backwards compatible with the previous version.

Version 1.12.3 (released 2012-05-31)

* pam\_oath: Fix "try\_first\_pass".
  Patch from Christian Hesse <list@eworm.de>.
* API and ABI is backwards compatible with the previous version.

Version 1.12.2 (released 2012-04-04)

* liboath: usersfile function now works on FreeBSD.
  Reported by Fredrik Lindgren <fredrik@lindgren.pp.se>.
* tests: liboath usersfile self-test is skipped if there is no datefudge.
  Reported by Fredrik Lindgren <fredrik@lindgren.pp.se>.
* API and ABI is backwards compatible with the previous version.

Version 1.12.1 (released 2012-04-01)

* liboath, oathtool: Base32 decoding now permit lowercase characters.
  Reported by Martin Michlmayr <tbm@cyrius.com>.
* API and ABI is backwards compatible with the previous version.

Version 1.12.0 (released 2012-04-01)

* oathtool: Added --base32 parameter to decode base32 keys.
  Suggested by Martin Michlmayr <tbm@cyrius.com>.
* oathtool: Verbose output (-v) now print key data in base32 format too.
* liboath: Added base32 functions. Added hex encoding function.
  The new APIs are oath\_bin2hex, oath\_base32\_decode, and
  oath\_base32\_encode.
* liboath: Gnulibâs snprintf is used for better portability.
  The system snprintf is known to have bugs on some systems, see the
  Gnulib manual for more information.
* API and ABI is backwards compatible with the previous version.
  oath\_bin2hex: New function.
  oath\_base32\_decode: New function.
  oath\_base32\_encode: New function.
  OATH\_INVALID\_BASE32: New error code.
  OATH\_BASE32\_OVERFLOW: New error code.
  OATH\_MALLOC\_ERROR: New error code.

Version 1.10.5 (released 2012-01-03)

* Build fixes.
  From Linus Nordberg <linus@nordberg.se> and Arno Hautala
  <arno@alum.wpi.edu>.
* Update gnulib files.
* API and ABI is backwards compatible with the previous version.

Version 1.10.4 (released 2011-08-12)

* liboath: Fix build so that OATH\_VERSION\_NUMBER is actually defined.
  It was an empty value in the last release due to a bug in the build
  scripts.
* API and ABI is backwards compatible with the previous version.

Version 1.10.3 (released 2011-08-12)

* liboath: Allow strcmp callback to return negative to signal errors.
  Patch by Daniel Pocock <daniel@pocock.com.au>.
* Fix bugs in build scripts for generating version numbers.
* Update gnulib files.
* API and ABI is backwards compatible with the previous version.

Version 1.10.2 (released 2011-06-12)

* liboath: Fix self tests to cope with slow build hosts.
  Reported by Christoph Egger <christoph@debian.org> in
  <http://bugs.debian.org/630222>.
* API and ABI is backwards compatible with the previous version.

Version 1.10.1 (released 2011-06-12)

* liboath: Fix self tests to work regardless of local time zone.
* Update gnulib files.
* API and ABI is backwards compatible with the previous version.

Version 1.10.0 (released 2011-05-24)

* liboath: Added new TOTP validation functions that return search position.
  Before the absolute value of the search position was in the return
  code of the TOTP validate function, but it seems we need to know
  whether the search position was before or after the current time. The
  new functions are oath\_totp\_validate2 and oath\_totp\_validate2\_callback
  and behave the same asoath\_totp\_validate and
  oath\_totp\_validate\_callback, respectively, but they take another
  optional *int\** parameter to store the search position.
* liboath: Usersfile can now validate TOTP as well.
  Supported algorithms are HOTP/T30/D and HOTP/T60/D where D is 6, 7, or
  8 digits. This means that the PAM module now supports TOTP as well.
* API and ABI is backwards compatible with the previous version.

Version 1.8.2 (released 2011-05-04)

* build: Fix conflict between ACLOCAL\_AMFLAGS and AC\_CONFIG\_MACRO\_DIR.
  Reported by Mitya <mitya@cargosoft.ru>.
* API and ABI is backwards compatible with the previous version.

Version 1.8.1 (released 2011-05-03)

* build: Make autoreconf work again.
  Reported by Christian Hesse <list@eworm.de>.
* API and ABI is backwards compatible with the previous version.

Version 1.8.0 (released 2011-05-03)

* liboath: Add new APIs oath\_strerror and oath\_strerror\_name.
  The functions are used to get a human readable description of liboath
  error codes. Suggested by Christian Hesse <mail@eworm.de>.
* liboath: Self-tests improvements.
* API and ABI is backwards compatible with the previous version.

Version 1.6.4 (released 2011-05-01)

* liboath: Increase usersfile max secret length to 32 bytes.
  Reported by Mitya <mitya@cargosoft.ru>.
* oathtool: Support --window together with --totp.
* pam\_oath: Re-add the pam\_sm\_setcred function and make it return success.
  Apparently the function need to exist even if it is not used.
  Reported by Christian Hesse <list@eworm.de>.
* pam\_oath: Link to -lpam for PAM symbols.
  Reported by Mitya <mitya@cargosoft.ru>.
* pam\_oath: Donât install pam\_oath.la file.
  Reported by Mitya <mitya@cargosoft.ru>.
* build: Use pammoddir automake variable instead of overriding libdir.
  Reported by Mitya <mitya@cargosoft.ru>.
* build: Make autoreconf work in released tar archives.
  Reported by Mitya <mitya@cargosoft.ru>.
* API and ABI is backwards compatible with the previous version.

Version 1.6.3 (released 2011-04-25)

* pam\_oath: Work under SSH by no-opâing the setcred function.
  Reported by Fanis Dokianakis <fanis@infloop.gr>.
* build: Fix srcdir != builddir issues.
  Patches from Linus Nordberg <linus@nordberg.se>.
* build: Gnulib files were updated.
* API and ABI is backwards compatible with the previous version.

Version 1.6.2 (released 2011-03-10)

* pam\_oath: Add ./configure --enable-root-tests parameter.
  Now this configure parameter is needed to run the self-tests that
  needs root permission. The fix in the last release was apparently not
  sufficient. Reported by Jean-Michel PourÃÂ© - GOOZE <jmpoure@gooze.eu>.
* API and ABI is backwards compatible with the previous version.

Version 1.6.1 (released 2011-02-22)

* pam\_oath: Improve reliability of root self test when /etc is not writable.
  Reported by Jean-Michel PourÃÂ© - GOOZE <jmpoure@gooze.eu>.
* API and ABI is backwards compatible with the previous version.

Version 1.6.0 (released 2011-02-22)

* liboath: Added APIs to perform TOTP validation.
  The APIs are oath\_totp\_validate and oath\_totp\_validate\_callback,
  similar to the corresponding HOTP functions.
* liboath: The function type oath\_hotp\_validate\_strcmp\_function was
* renamed to oath\_validate\_strcmp\_function.
  It is used by both HOTP and TOTP validation. The old name will
  continue to work through a compatibility-#define.
* oathtool: Support TOTP validation.
* API and ABI is backwards compatible with the previous version.

Version 1.4.6 (released 2011-02-07)

* liboath: Improve portability by using more gnulib modules.
  Some non-portable constructions were fixed. From now on gnulib will
  warn for some non-portable constructs.
* Fix some minor clang warnings.
* API and ABI is backwards compatible with the previous version.

Version 1.4.5 (released 2011-01-27)

* liboath: Make sure gnulib files are licensed under the LGPLv2.1+.
  Thanks to Tollef Fog Heen <tfheen@debian.org>.
* API and ABI is backwards compatible with the previous version.

Version 1.4.4 (released 2011-01-27)

* liboath: Fix OATH\_VERSION and OATH\_VERSION\_NUMBER.
  I forgot to increment these symbols for the last release. From now
  on, these symbols are generated from the package version instead.
* oathtool: Fix typo in man page.
  Patch from Linus Nordberg <linus@nordberg.se>.
* API and ABI is backwards compatible with the previous version.

Version 1.4.3 (released 2011-01-20)

* liboath: Really make usersfile logic for *-* passwords work.
  Reported by Michael Stevens <mstevens@etla.org>.
* pam\_oath: Added better self-test suite (requires root privileges).
* API and ABI is backwards compatible with the previous version.

Version 1.4.2 (released 2011-01-16)

* oathtool: Really replace - with \- in man page, pointed out by lintian.
  We now also have a self check to catch any regressions in this area.
* liboath: Make TOTP self check work on platforms with 32-bit time\_t.
  The final test requires >32 bit time\_t.
* API and ABI is backwards compatible with the previous version.

Version 1.4.1 (released 2011-01-16)

* liboath: New configure parameter --enable-gcc-warnings.
  Use to enable many compiler warnings. Enabled by default during
  development.
* oathtool: Replace - with \- in man page, pointed out by lintian.
* API and ABI is backwards compatible with the previous version.

Version 1.4.0 (released 2011-01-15)

* liboath: Added pkg-config script.
* liboath: Support time-variant TOTP based on draft-mraihi-totp-timebased-07.
  New function oath\_totp\_generate. New symbols
  OATH\_TOTP\_DEFAULT\_TIME\_STEP\_SIZE and OATH\_TOTP\_DEFAULT\_START\_TIME for
  default system parameters.
* liboath: New API oath\_hotp\_validate\_callback().
  Used when you are validating hashed OTPs. Inspired by discussions
  with Daniel Pocock <daniel@pocock.com.au>.
* oathtool: New parameter --totp to generate time-variant TOTPâs.
  New sub-parameter --time-step-size, --start-time and --now used to
  specify TOTP configuration.
* liboath: Added self-tests of validate functions.
* API and ABI is backwards compatible with the previous version.

Version 1.2.2 (released 2011-01-01)

* Cleanups related to name change.
* API and ABI is backwards compatible with the previous version.

Version 1.2.1 (released 2010-12-28)

* liboath: Install header file "oath.h".
  And various other namespace cleanups.
* API and ABI is backwards compatible with the previous version.

Version 1.2.0 (released 2010-12-27)

* Project renamed from "HOTP Toolkit" to "OATH Toolkit".
* liboath: The header file is "oath.h" and library is "liboath.so".
  Functions were renamed, but functionality is retained so updating code
  is a matter of changing the symbol names only.
* oathtool: Renamed from "hotptool". Added --hotp flag (the default).
  This is to plan for the future when the tool will also support TOTP/OCRA.
* pam\_oath: Renamed from pam\_hotp.
* API and ABI is not backwards compatible.

Version 1.0.1 (released 2010-12-27)

* libhotp: Fix build failure due to missing sys/stat.h include on FreeBSD 7.2.
  Reported by Kevin Quinlan <Kevin.Quinlan@polidoris.com>.
* libhotp: Make usersfile logic for *-* passwords work.
  Reported by Rick van Rein <rick@openfortress.nl>.
* libhotp DOC: Added GTK-DOC manual in PDF format.
* build: Gnulib files were updated.

Version 1.0.0 (released 2009-12-08)

* Initial release.

[![Valid XHTML 1.0](https://www.w3.org/Icons/valid-xhtml10)](https://validator.w3.org/check?uri=referer)
[![Valid CSS!](https://jigsaw.w3.org/css-validator/images/vcss)](https://jigsaw.w3.org/css-validator/check/referer)



=== Content from lists.nongnu.org_0689fef2_20250125_162700.html ===


| | **oath-toolkit-help** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=oath-toolkit-help)

---

[Date Prev][[Date Next](msg00001.html)][Thread Prev][[Thread Next](msg00001.html)][[Date Index](index.html#00000)][[Thread Index](threads.html#00000)]

## [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of

---

| **From**: | Bas van Schaik |
| --- | --- |

| **Subject**: | [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file? |
| **Date**: | Mon, 09 Dec 2013 11:31:43 +0000 |
| **User-agent**: | Mozilla/5.0 (X11; Linux x86\_64; rv:24.0) Gecko/20100101 Thunderbird/24.1.1 |

---

| Dear maintainers (cc. Debian Security Team),  It appears that libpam-oath (part of oath-toolkit) in Debian Wheezy (version 1.12.4-1) incorrectly parses comments in its users file (e.g. /etc/users.oath), resulting in it failing to invalidate a used one-time-password (OTP), leaving it vulnerable to replay of OTPs. I didn't file this as a bug because of possible security implications - even though the risk seems small. Also, I'm not sure whether the problem is specific to libpam-oath, or whether any of the other packages derived from the oath-toolkit source are affected as well.  Here's a description of the problem by example. The users.oath file consists of lines like the following: HOTP    bas    [my-optional-secret-password]    [my-secret-key]    [last-used-OTP-index]    [last-used-OTP]    [last-used-datetime]  To prevent replay of a used OTP, the index and last OTP are updated whenever an OTP is used. However, libpam-oath fails to update said file if it contains a commented-out line that matches the username. For example, consider this users.oath in which the administrator decided to replace the old secret key "abcd" with a new key "efgh": #HOTP    bas    -    abcd    55    12345678    2013-12-06T23:13:40L HOTP    bas    -    efgh  After using "efgh" for the first time with OTP 98765432, the users.oath /should/ contain the following: #HOTP    bas    -    abcd    55    12345678    2013-12-06T23:13:40L       [unchanged] HOTP    bas    -    efgh    1    98765432    2013-12-07T23:13:40L         [invalidating OTP 98765432]  However, libpam-oath incorrectly parses users.oath and actually updates the commented-out entry. So the users.oath file after using OTP "98765432" with key "efgh" looks like this: #HOTP    bas    -    abcd    56    98765432    2013-12-07T23:13:40L           [changed - even though it was commented out] HOTP    bas    -    efgh                 [didn't change!]  Note that the entry for secret key "efgh" remains unchanged, and the commented-out entry for key "abcd" was updated (even though 98765432 is an OTP for key "efgh", hence unlikely to be a valid OTP for key "abcd"). Consequently, libpam-oath actually accepts the used OTP "98765432" again, and again, and again. It will keep on updating the commented-out entry, whilst leaving the entry for secret "efgh" untouched. Furthermore, it will accept any new OTP as well, as long as this OTP lies within the preconfigured search window.  It appears that libpam-oath correctly ignores commented-out lines when searching users.oath for matching entries, but does not ignore commented-out lines when updating users.oath. If the file contains multiple keys for the same user, the file is updated correctly. E.g.: HOTP    bas    -    abcd    55    12345678    2013-12-06T23:13:40L HOTP    bas    -    efgh  Is updated to: HOTP    bas    -    abcd    55    12345678    2013-12-06T23:13:40L HOTP    bas    -    efgh    1    98765432    2013-12-08T23:13:40L  After using OTP "98765432" for key "efgh".  Unfortunately I haven't been able to test this vulnerability using the libpam-oath in Debian testing, as this version depends on packages that are unavailable for Wheezy. I'd be happy to provide any additional information if needed, and am more than happy to test alternative configurations or patches.    Bas van Schaik |
| --- |

---

reply via email to

---

| [Prev in Thread] | **Current Thread** | [[Next in Thread](msg00001.html)] |
| --- | --- | --- |

* **[OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?**,
  *Bas van Schaik* **<=**
  + **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00001.html)**, *Thijs Kinkhorst*, 2013/12/12
    - **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00002.html)**, *Jed Laundry*, 2013/12/13
      * **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00003.html)**, *Bas van Schaik*, 2013/12/14
      * **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00005.html)**, *Ilkka Virta*, 2013/12/14* **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00006.html)**, *Simon Josefsson*, 2013/12/16* **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00008.html)**, *Ilkka Virta*, 2013/12/21

---

* Next by Date:
  **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00001.html)**
* Next by thread:
  **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00001.html)**
* Index(es):
  + [**Date**](index.html#00000)
  + [**Thread**](threads.html#00000)



=== Content from lists.nongnu.org_4020fed0_20250125_162700.html ===


| | **oath-toolkit-help** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=oath-toolkit-help)

---

[[Date Prev](msg00002.html)][[Date Next](msg00004.html)][[Thread Prev](msg00002.html)][[Thread Next](msg00005.html)][[Date Index](index.html#00003)][[Thread Index](threads.html#00003)]

## Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as res

---

| **From**: | Bas van Schaik |
| --- | --- |

| **Subject**: | Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file? |
| **Date**: | Sat, 14 Dec 2013 14:42:55 +0100 |
| **User-agent**: | Roundcube Webmail/0.9.2 |

---

```

Hi,

```
> ```
>
> (...)
>
> Simon, how do you want to proceed? AFAICT, comments in the usersfile
> aren't explicitly supported and one is supposed to maintain separation
> between the usersfile, which controls authentication, and an
> authorisation file/mechanism, but I imagine that because it Just Works
> for usersfiles that don't contain duplicate usernames that there are a
> few people using it in this way...
>
> ```

```

```
Thanks for looking into this. I didn't expect comments to work in the
user file, and they are indeed not documented. It seems, however, that a
simple typo might have the same result and lead pam-oath to update the
wrong line? Note the example in my original email: even if the
commented-out line contains information regarding a completely different
secret key K', pam-oath will still update that line as long as the
username matches that of an OTP generated using key K.
```

```
On an unrelated note: how is the users file protected against concurrent
modification by two processes using pam-oath?
```

Cheers,

  Bas

```

---

reply via email to

---

| [[Prev in Thread](msg00002.html)] | **Current Thread** | [[Next in Thread](msg00005.html)] |
| --- | --- | --- |

* **[[OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00000.html)**, *Bas van Schaik*, 2013/12/09
  + **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00001.html)**, *Thijs Kinkhorst*, 2013/12/12
    - **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00002.html)**, *Jed Laundry*, 2013/12/13
      * **Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?**,
        *Bas van Schaik* **<=**
      * **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00005.html)**, *Ilkka Virta*, 2013/12/14* **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00006.html)**, *Simon Josefsson*, 2013/12/16* **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00008.html)**, *Ilkka Virta*, 2013/12/21

---

* Prev by Date:
  **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00002.html)**
* Next by Date:
  **[[OATH-Toolkit-help] [sr #108456] PAM module does not check whether strdup allocation succeeded](msg00004.html)**
* Previous by thread:
  **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00002.html)**
* Next by thread:
  **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00005.html)**
* Index(es):
  + [**Date**](index.html#00003)
  + [**Thread**](threads.html#00003)



=== Content from seclists.org_753f9324_20250125_162702.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](295)
[By Date](date.html#296)
[![Next](/images/right-icon-16x16.png)](297)

[![Previous](/images/left-icon-16x16.png)](279)
[By Thread](index.html#296)
[![Next](/images/right-icon-16x16.png)](281)

![](/shared/images/nst-icons.svg#search)

# Re: oath-toolkit PAM module OTP token invalidation issue

---

*From*: cve-assign () mitre org

*Date*: Sun, 9 Feb 2014 19:34:47 -0500 (EST)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

```
> ```
> <http://lists.nongnu.org/archive/html/oath-toolkit-help/2013-12/msg00000.html>
>
> ```

```

```
> ```
> There is a test file with comments in the distribution, so I believe
> this is an actual bug with security implications
>
> ```

```

```
> ```
> leaving it vulnerable to replay of OTPs
>
> ```

```

```
> ```
> It will keep on updating the commented-out entry, whilst leaving the
> entry for secret "efgh" untouched.
>
> ```

```

```
> ```
> because skipped_users wasn't incremented, writes the update to the
> commented out line.
>
> ```

```

Use CVE-2013-7322.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJS+B46AAoJEKllVAevmvmsO2YIAJSIxibnCt7XB5FsnFJcBuF9
7annA5UGUk75GAEo9t4aSZ/DwbFpnEdlhLmxkOB4GZev2qtHCcue3K5q/eFxVn4M
oivsISYzL+9rt0w1uEADIsxBb47cEXckEYSOQDOsHB5nO0CXo2+iNzkrqf5Z0oCo
BhiVM2rxX14QH69L0u1NxFJELgZRixEv13VdJwLuIblkElYqASK9G+rjQeYGpQta
7PA6+7uQQILZ6NmRE/Ypd97XE6/5LREizbFBso/ww1CfTwfCDkANDdNLNaz13Io8
2ZPIt6WNJQ1ToR5E+BE7tuyIvIkrRhZNLyqX0aXXBZyYMeTDOozRuNouXx0ucr8=
=NIuV
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](295)
[By Date](date.html#296)
[![Next](/images/right-icon-16x16.png)](297)

[![Previous](/images/left-icon-16x16.png)](279)
[By Thread](index.html#296)
[![Next](/images/right-icon-16x16.png)](281)

### Current thread:

* [oath-toolkit PAM module OTP token invalidation issue](279) *Florian Weimer (Feb 07)*
  + **Re: oath-toolkit PAM module OTP token invalidation issue** *cve-assign (Feb 09)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from lists.nongnu.org_0a378ddd_20250125_162700.html ===


| | **oath-toolkit-help** | | --- | |
| --- | --- |

[[Top](../)][[All Lists](/archive/html)]

[Advanced](/archive/cgi-bin/namazu.cgi?idxname=oath-toolkit-help)

---

[[Date Prev](msg00001.html)][[Date Next](msg00003.html)][[Thread Prev](msg00001.html)][[Thread Next](msg00003.html)][[Date Index](index.html#00002)][[Thread Index](threads.html#00002)]

## Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as resul

---

| **From**: | Jed Laundry |
| --- | --- |

| **Subject**: | Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file? |
| **Date**: | Sat, 14 Dec 2013 09:01:53 +1300 |

---

Hi,

Looking at the code, the problem exists in usersfile.c

The problem is that parse\_usersfile() is called first to find the matching usersfile entry, and uses parse\_type() to find the type of OTP; #HOTP doesn't match any known type and therefore skipped\_users isn't incremented. Later, once the correct username is found and the OTP token verifies, update\_usersfile2() then only uses the username and skipped\_users counter to find the line to replace (tokenising the type, secret, pin etc), and because skipped\_users wasn't incremented, writes the update to the commented out line.

Hmmm.

Simon, how do you want to proceed? AFAICT, comments in the usersfile aren't explicitly supported and one is supposed to maintain separation between the usersfile, which controls authentication, and an authorisation file/mechanism, but I imagine that because it Just Works for usersfiles that don't contain duplicate usernames that there are a few people using it in this way...

Thanks,
Jed.

On 13 December 2013 05:11, Thijs Kinkhorst <address@hidden> wrote:
> Hi Oath-maintainers,
>
>
>
> Any news on the below issue?
>
>
>
>
>
> Thijs
>
>
>
> On Mon, December 9, 2013 12:31, Bas van Schaik wrote:
>
> > Dear maintainers (cc. Debian Security Team),
>
> >
>
> > It appears that libpam-oath (part of oath-toolkit) in Debian Wheezy
>
> > (version 1.12.4-1) incorrectly parses comments in its users file (e.g.
>
> > /etc/users.oath), resulting in it failing to invalidate a used
>
> > one-time-password (OTP), leaving it vulnerable to replay of OTPs. I
>
> > didn't file this as a bug because of possible security implications -
>
> > even though the risk seems small. Also, I'm not sure whether the problem
>
> > is specific to libpam-oath, or whether any of the other packages derived
>
> > from the oath-toolkit source are affected as well.
>
> >
>
> > Here's a description of the problem by example. The users.oath file
>
> > consists of lines like the following:
>
> >> HOTP Â  Â bas Â  Â [my-optional-secret-password] Â  Â [my-secret-key]
>
> >> [last-used-OTP-index] Â  Â [last-used-OTP] [last-used-datetime]
>
> >
>
> > To prevent replay of a used OTP, the index and last OTP are updated
>
> > whenever an OTP is used. However, libpam-oath fails to update said file
>
> > if it contains a commented-out line that matches the username. For
>
> > example, consider this users.oath in which the administrator decided to
>
> > replace the old secret key "abcd" with a new key "efgh":
>
> >> #HOTP Â  Â bas Â  Â - Â  Â abcd Â  Â 55 Â  Â 12345678 Â  Â 2013-12-06T23:13:40L
>
> >> HOTP Â  Â bas Â  Â - Â  Â efgh
>
> >
>
> > After using "efgh" for the first time with OTP 98765432, the users.oath
>
> > /should/ contain the following:
>
> >> #HOTP Â  Â bas Â  Â - Â  Â abcd Â  Â 55 Â  Â 12345678
>
> >> 2013-12-06T23:13:40L Â  Â  Â  [unchanged]
>
> >> HOTP Â  Â bas Â  Â - Â  Â efgh Â  Â 1 Â  Â 98765432 2013-12-07T23:13:40L
>
> >> [invalidating OTP 98765432]
>
> >
>
> > However, libpam-oath incorrectly parses users.oath and actually updates
>
> > the commented-out entry. So the users.oath file after using OTP
>
> > "98765432" with key "efgh" looks like this:
>
> >> #HOTP Â  Â bas Â  Â - Â  Â abcd Â  Â 56 Â  Â 98765432
>
> >> 2013-12-07T23:13:40L Â  Â  Â  Â  Â  [changed - even though it was commented
>
> >> out]
>
> >> HOTP Â  Â bas Â  Â - Â  Â efgh Â  Â  Â  Â  Â  Â  Â  Â  [didn't change!]
>
> >
>
> > Note that the entry for secret key "efgh" remains unchanged, and the
>
> > commented-out entry for key "abcd" was updated (even though 98765432 is
>
> > an OTP for key "efgh", hence unlikely to be a valid OTP for key "abcd").
>
> > Consequently, libpam-oath actually accepts the used OTP "98765432"
>
> > again, and again, and again. It will keep on updating the commented-out
>
> > entry, whilst leaving the entry for secret "efgh" untouched.
>
> > Furthermore, it will accept any new OTP as well, as long as this OTP
>
> > lies within the preconfigured search window.
>
> >
>
> > It appears that libpam-oath correctly ignores commented-out lines when
>
> > searching users.oath for matching entries, but does not ignore
>
> > commented-out lines when updating users.oath. If the file contains
>
> > multiple keys for the same user, the file is updated correctly. E.g.:
>
> >> HOTP Â  Â bas Â  Â - Â  Â abcd Â  Â 55 Â  Â 12345678 Â  Â 2013-12-06T23:13:40L
>
> >> HOTP Â  Â bas Â  Â - Â  Â efgh
>
> >
>
> > Is updated to:
>
> >> HOTP Â  Â bas Â  Â - Â  Â abcd Â  Â 55 Â  Â 12345678 Â  Â 2013-12-06T23:13:40L
>
> >> HOTP Â  Â bas Â  Â - Â  Â efgh Â  Â 1 Â  Â 98765432 Â  Â 2013-12-08T23:13:40L
>
> >
>
> > After using OTP "98765432" for key "efgh".
>
> >
>
> > Unfortunately I haven't been able to test this vulnerability using the
>
> > libpam-oath in Debian testing, as this version depends on packages that
>
> > are unavailable for Wheezy. I'd be happy to provide any additional
>
> > information if needed, and am more than happy to test alternative
>
> > configurations or patches.
>
> >
>
> > Â  Â Bas van Schaik
>
> >

---

reply via email to

---

| [[Prev in Thread](msg00001.html)] | **Current Thread** | [[Next in Thread](msg00003.html)] |
| --- | --- | --- |

* **[[OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00000.html)**, *Bas van Schaik*, 2013/12/09
  + **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00001.html)**, *Thijs Kinkhorst*, 2013/12/12
    - **Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?**,
      *Jed Laundry* **<=**
      * **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00003.html)**, *Bas van Schaik*, 2013/12/14
      * **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00005.html)**, *Ilkka Virta*, 2013/12/14* **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00006.html)**, *Simon Josefsson*, 2013/12/16* **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00008.html)**, *Ilkka Virta*, 2013/12/21

---

* Prev by Date:
  **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00001.html)**
* Next by Date:
  **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00003.html)**
* Previous by thread:
  **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00001.html)**
* Next by thread:
  **[Re: [OATH-Toolkit-help] libpam-oath vulnerable to replay of OTP as result of incorrectly parsing comments in users file?](msg00003.html)**
* Index(es):
  + [**Date**](index.html#00002)
  + [**Thread**](threads.html#00002)


