```
{
  "vulnerability": {
    "root_cause": "Lack of state validation in the Z-Wave door lock firmware during key exchange. The door lock does not verify if a shared key already exists before loading a hardcoded temporary key, allowing an attacker to overwrite the existing key.",
    "weaknesses": [
      "Insufficient state validation during key exchange",
      "Use of a hardcoded temporary key during the initial steps of key exchange",
      "Unencrypted and unauthenticated Node Info command"
    ],
    "impact": "An attacker can remotely reset the encryption key of a Z-Wave door lock to a known value and gain unauthorized access (unlocking the door, changing PIN codes). The attack can be performed without needing the current encryption key.",
    "attack_vectors": [
      "By sending a spoofed Node Info command during the pairing process to force a downgrade from S2 to S0 (or no security)",
      "By initiating a key exchange process on a previously paired lock, forcing the use of the hardcoded temporary key and allowing the attacker to set the shared key"
    ],
    "required_capabilities": "An attacker needs to be within RF range of the Z-Wave network, have knowledge of the Z-Wave protocol and the key exchange process, and possess a packet injection tool similar to Z-Force or other tools that can capture and inject raw packets."
  }
}
```