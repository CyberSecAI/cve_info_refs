=== Content from www.vtiger.com_0d2cd36d_20250125_182907.html ===


[Skip to content](#content)
[![](https://www.vtiger.com/blog/wp-content/uploads/2023/02/vtiger-logo-only.png)](https://www.vtiger.com/blog/ "← Vtiger CRM Blog")

**[Vtiger Blog](https://www.vtiger.com/blog)**

Subscribe

[![](https://www.vtiger.com/blog/wp-content/uploads/2023/02/vtiger-logo-only.png)](https://www.vtiger.com/ "Vtiger CRM Blog")

**[Vtiger Blog](https://www.vtiger.com/blog)**

Subscribe

×
## Sign up for Vtiger Bytes - Our Monthly Newsletter

Explore Vtiger CRM updates, feature releases, blogs, best practices, customer feedback, and news.

\*Please enter a valid email address.

Subscribe to Newsletter

By subscribing, you agree to our [Privacy Policy](https://www.vtiger.com/policy-legal-center/privacy-policy/)

[Home](https://www.vtiger.com/blog/) » Vtiger 5.4.0 Security Patch Released
# Vtiger 5.4.0 Security Patch Released

* [All](https://www.vtiger.com/blog/category/all/)
* 2 min read
* Written by [Kieran Kay](https://www.vtiger.com/blog/author/kieran/ "Posts by Kieran Kay")

 **Last Updated: July 13, 2023**

Posted: March 26, 2013

**\*\*\*April 2nd, 2012 UPDATE: Some users may experience performance issues after applying the security patch below. If you do experience performance issues, please download and apply [this patch](http://sourceforge.net/projects/vtigercrm/files/vtiger%20CRM%205.4.0/Core%20Product/VtigerCRM-5.4.0-Performance_Patch.zip/download) after applying the security patch.**

As many of you are aware, Vtiger CRM Open Source 6.0 is still under development and is slated for a May release. For those currently using Vtiger CRM Open Source 5.4, we would like to recommend applying a new security patch, which fixes a series of vulnerabilities reported by Mr. Nick Freeman from [security-assessment.com](http://security-assessment.com) and Mr. Egidio. The patch covers the following discovered vulnerabilities:

Local File Inclusion

Local File Deletion

SQL Injection

PHP Code Injection

Cross site scripting

Arbitrary File Upload

Authentication Bypass vulnerabilities(SOAP API’s)

**1. Before deploying the patch**

It is essential to have an available backup of your Vtiger installation in the result of any errors. To do this, create a copy of the entire Vtiger folder, and place it in a different location. As there is no database change in this particular case, a database dump is unnecessary.

**2. Obtaining the patch files**

Download the patch files from:

[SourceForge](http://sourceforge.net/projects/vtigercrm/files/vtiger%20CRM%205.4.0/Core%20Product/VtigerCRM540_Security_Patch.zip) Vtiger Link

**3. Upload the patch files to your Vtiger CRM 5.4.0 folder**

**4. Extract the patch files to that directory, overwriting any files as necessary**

[previousMarch 2013 – Update 2 – QuickBooks Online with Vtiger Integration](https://www.vtiger.com/blog/march-2013-update-2-connect-vtiger-and-quickbooks-online/)[nextWebinar – 8 Ways to Make Your Vtiger Experience More Productive](https://www.vtiger.com/blog/webinar-8-ways-to-make-your-vtiger-experience-more-productive/)
## Related Posts

[![](data:image/svg+xml...)](https://www.vtiger.com/blog/big-little-things-dependent-fields-blocks/)
### [Big Little Things – Dependent Fields/Blocks](https://www.vtiger.com/blog/big-little-things-dependent-fields-blocks/)

* 6 min read

 **Last Updated: June 23, 2023**

Posted: May 31, 2023

[![](data:image/svg+xml...)](https://www.vtiger.com/blog/big-little-things-merge-tags/)
### [Big Little Things – Merge Tags](https://www.vtiger.com/blog/big-little-things-merge-tags/)

* 5 min read

 **Last Updated: June 23, 2023**

Posted: April 20, 2023

[![](data:image/svg+xml...)](https://www.vtiger.com/blog/quality-audit-and-its-benefits-to-your-business/)
### [Quality audit and its benefits to your business](https://www.vtiger.com/blog/quality-audit-and-its-benefits-to-your-business/)

* 5 min read

 **Last Updated: June 23, 2023**

Posted: March 29, 2023

   Copyright 2025 [Vtiger](https://www.vtiger.com/) | [Privacy](https://www.vtiger.com/policy-legal-center/privacy-policy/) | [Policy & Legal Center](https://www.vtiger.com/policy-legal-center/)



=== Content from karmainsecurity.com_f4b67e80_20250125_182906.html ===

[egix@karmainsecurity ~ $](https://karmainsecurity.com/)

* [~/research](https://karmainsecurity.com/research)
* [~/blog](https://karmainsecurity.com/blog)
* [~/about](https://karmainsecurity.com/about)

# vtiger CRM <= 5.4.0 (SOAP Services) Multiple SQL Injection Vulnerabilities

#### â¢ Software Link:

<http://www.vtiger.com>

#### â¢ Affected Versions:

All versions from 5.0.0 to 5.4.0.

#### â¢ Vulnerabilities Description:

1. The vulnerable code is located in the `get_picklists()` SOAP method defined in **/soap/customerportal.php**:

```
1177$id = $input_array['id'];
1178$sessionid = $input_array['sessionid'];
1179$picklist_name = $adb->sql_escape_string($input_array['picklist_name']);
1180
1181if(!validateSession($id,$sessionid))
1182return null;
1183
1184$picklist_array = Array();
1185
1186$admin_role = 'H2';
1187$userid = getPortalUserid();
1188$roleres = $adb->pquery("SELECT roleid from vtiger_user2role where userid = ?", array($userid));
1189$RowCount = $adb->num_rows($roleres);
1190if($RowCount > 0){
1191    $admin_role = $adb->query_result($roleres,0,'roleid');
1192}
1193
1194$res = $adb->pquery("select vtiger_". $picklist_name.".* from vtiger_". $picklist_name." inner join vtiger_role2picklist on vtiger_role2picklist.picklistvalueid = vtiger_". $picklist_name.".picklist_valueid and vtiger_role2picklist.roleid='$admin_role'", array());
```

User input passed through the **“picklist\_name”** parameter seems to be correctly sanitised by the
`sql_escape_string()` method, but the vulnerability exists because itâs used in the query at line 1194
without single or double quotes. This can be exploited to conduct blind SQL injection attacks.

2. The vulnerable code is located in the `get_tickets_list()` SOAP method defined in **/soap/customerportal.php**:

```
654$id = $input_array['id'];
655$only_mine = $input_array['onlymine'];
656$where = $input_array['where']; //addslashes is already added with where condition fields in portal itself
657$match = $input_array['match'];
658$sessionid = $input_array['sessionid'];
659
660if(!validateSession($id,$sessionid))
661    return null;
662
663// Prepare where conditions based on search query
664$join_type = '';
665$where_conditions = '';
666if(trim($where) != '') {
667    if($match == 'all' || $match == '') {
668        $join_type = " AND ";
669    } elseif($match == 'any') {
670        $join_type = " OR ";
671    }
672    $where = explode("&&&",$where);
673    $where_conditions = implode($join_type, $where);
674}
```

```
707$query = "SELECT vtiger_troubletickets.*, vtiger_crmentity.smownerid,vtiger_crmentity.createdtime, vtiger_crmentity.modifiedtime, '' AS setype
708    FROM vtiger_troubletickets
709    INNER JOIN vtiger_crmentity ON vtiger_crmentity.crmid = vtiger_troubletickets.ticketid AND vtiger_crmentity.deleted = 0
710    WHERE vtiger_troubletickets.parent_id IN (". generateQuestionMarks($entity_ids_list) .")";
711// Add conditions if there are any search parameters
712if ($join_type != '' && $where_conditions != '') {
713    $query .= " AND (".$where_conditions.")";
714}
```

User input passed through the **“where”** parameter isnât properly validated before being
used in a SQL query at line 713. This can be exploited to conduct SQL injection attacks.

3. The vulnerable code is located in the `SearchContactsByEmail()` SOAP method defined in **/soap/thunderbirdplugin.php**:

```
186function SearchContactsByEmail($username,$password,$emailaddress)
187{
188  if(authentication($username,$password))
189  {
190     require_once('modules/Contacts/Contacts.php');
191
192     $seed_contact = new Contacts();
193     $output_list = Array();
194
195     $response = $seed_contact->get_searchbyemailid($username,$emailaddress);
```

User input passed through the **“emailaddress”** parameter isnât properly validated before being used
in a call to the `Contacts::get_searchbyemailid()` method at line 195. This can be exploited to conduct
SQL injection attacks. Successful exploitation of this vulnerability requires authentication.

4. The vulnerable code is located in the `SearchContactsByEmail()` SOAP method defined in **/soap/vtigerolservice.php**:

```
282function SearchContactsByEmail($username,$session,$emailaddress)
283{
284    if(!validateSession($username,$session))
285    return null;
286    require_once('modules/Contacts/Contacts.php');
287
288     $seed_contact = new Contacts();
289     $output_list = Array();
290
291     $response = $seed_contact->get_searchbyemailid($username,$emailaddress);
```

User input passed through the **“emailaddress”** parameter isnât properly validated before being used in
a call to the `Contacts::get_searchbyemailid()` method at line 291. This can be exploited to conduct SQL
injection attacks. Successful exploitation of this vulnerability requires knowledge of a valid username.

#### â¢ Solution:

Apply the vendor patch: <http://www.vtiger.com/blogs/?p=1467>

#### â¢ Disclosure Timeline:

[13/01/2013] â Vendor notified

[06/02/2013] â Vendor asked feedback about this changeset

[05/03/2013] â Feedback provided to the vendor

[26/03/2013] â Vendor patch released

[18/04/2013] â CVE number requested

[20/04/2013] â CVE number assigned

[01/08/2013] â Public disclosure

#### â¢ CVE Reference:

The Common Vulnerabilities and Exposures project ([cve.mitre.org](http://cve.mitre.org)) has assigned the name [CVE-2013-3213](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-3213) to these vulnerabilities.

#### â¢ Credits:

Vulnerabilities discovered by Egidio Romano.

Karma(In)Security © 2025


