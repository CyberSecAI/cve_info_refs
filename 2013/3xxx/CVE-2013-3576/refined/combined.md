=== Content from www.kb.cert.org_afd67f03_20250125_071644.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#735364

## HP System Management Homepage contains a command injection vulnerability

#### Vulnerability Note VU#735364

Original Release Date: 2013-06-11 | Last Revised: 2013-09-24

---

### Overview

HP System Management Homepage contains a command injection vulnerability ([CWE-77](http://cwe.mitre.org/data/definitions/77.html)) that may result in arbitrary command execution and privilege escalation.

### Description

| Markus Wulftange from Daimler TSS reports:     *The vulnerability is located in the `ginkgosnmp.inc` PHP file in the `C:\hp\hpsmh\data\smhutil` or `/opt/hp/hpsmh/data/smhutil` directory, respectively. Inside the `ginkgosnmp.inc` script, the last path segment of the current requested URL path is used in a `exec` call without proper escaping:**$tempfilename = "$sessiondir/" . substr($\_SERVER["SCRIPT\_URL"], 1 + strrpos($\_SERVER["SCRIPT\_URL"], '/')) . uniqid(".", true) . time() . ".txt";**[...]**if("Linux" == PHP\_OS)**$cmd = "../../webapp-data/webagent/csginkgo -f$tempfilename";**else**{**$windrive = substr( $\_SERVER["WINDIR"], 0, 2 );**$cmd = "$windrive\\hp\\hpsmh\\data\\smhutil\\csginkgo.exe -f$tempfilename";**}**exec( $cmd, $out );**This script is reachable via the URL path `**https://<host>:2381/smhutil/snmpchp.php.en`**. Due to [Apache’s \*MultiViews\*] [2] it can also be referenced with any additional path segments after the `snmpchp.php.en` segment: `**https://<host>:2381/smhutil/snmpchp.php.en/foo/bar`* *still triggers `**https://<host>:2381/smhutil/snmpchp.php.en`* *but `**$\_SERVER["SCRIPT\_URL"]`* *is `**https://<host>:2381/smhutil/snmpchp.php.en/foo/bar`**. This can be exploited as follows:**https://<host>:2381/smhutil/snmpchp.php.en/&&<cmd>&&echo* *(full file name)**https://<host>:2381/smhutil/snmpchp.php/&&<cmd>&&echo* *(without "en" language indicator)**https://<host>:2381/smhutil/snmpchp/&&<cmd>&&echo* *(without any file name extension)**Besides the path segment separator `/`, the characters `<`, `>`, and `|` are also not allowed, which makes exploiting this vulnerability a little hard.**https://<host>:2381/smhutil/snmpchp/&&whoami&&echo* |
| --- |

### Impact

| A remote authenticated user may be able to run arbitrary commands on the HP System Management Homepage server. |
| --- |

### Solution

| **Apply an Update**[HP System Management Homepage (SMH) version 7.2.2](https://h20564.www2.hp.com/portal/site/hpsc/public/kb/docDisplay?docId=emr_na-c03895050) and later address this vulnerability. If you cannot upgrade for whatever reason, please consider the following workarounds. |
| --- |

| **Restrict Network Access**As a general good security practice, only allow connections from trusted hosts and networks. Restricting access would prevent an attacker from connecting to the service from a blocked network location. |
| --- |

### Vendor Information

735364
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23735364/) to view vendors.**
### [Hewlett-Packard Company](#BLUU-96WRYV) Affected

Notified:  April 19, 2013  Updated: June 10, 2013

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 9 | AV:N/AC:L/Au:S/C:C/I:C/A:C |
| Temporal | 8.5 | E:H/RL:W/RC:C |
| Environmental | 6.4 | CDP:ND/TD:M/CR:ND/IR:ND/AR:ND |

### References

* <https://h20564.www2.hp.com/portal/site/hpsc/public/kb/docDisplay?docId=emr_na-c03895050>
* <http://www.hp.com/go/SMH>
* <http://cwe.mitre.org/data/definitions/77.html>
### Acknowledgements

Thanks to Markus Wulftange from Daimler TSS for reporting this vulnerability.

This document was written by Jared Allar.

### Other Information

| **CVE IDs:** | [CVE-2013-3576](http://web.nvd.nist.gov/vuln/detail/CVE-2013-3576) |
| --- | --- |
| **Date Public:** | 2013-06-10 |
| **Date First Published:** | 2013-06-11 |
| **Date Last Updated:** | 2013-09-24 14:18 UTC |
| **Document Revision:** | 19 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from marc.info_44f770d8_20250125_071644.html ===

```
[[prev in list](?l=bugtraq&m=137952422705356&w=2)] [[next in list](?l=bugtraq&m=137952653606197&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [security bulletin] HPSBMU02917 rev.1 - HP System Management Homepage (SMH) running on Linux and Win
From:       [security-alert () hp ! com](?a=90366096700007&r=1&w=2)
Date:       [2013-09-18 15:25:31](?l=bugtraq&r=1&w=2&b=201309)
Message-ID: [20130918152531.7A26520B85 () security ! hp ! com](?i=20130918152531.7A26520B85%20()%20security%20!%20hp%20!%20com)
[Download RAW [message](?l=bugtraq&m=137952496405683&q=mbox) or [body](?l=bugtraq&m=137952496405683&q=raw)]

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Note: the current version of the following document is available here:
<https://h20564.www2.hp.com/portal/site/hpsc/public/kb/>
docDisplay?docId=emr_na-c03895050

SUPPORT COMMUNICATION - SECURITY BULLETIN

Document ID: c03895050
Version: 1

HPSBMU02917 rev.1 - HP System Management Homepage (SMH) running on Linux and
Windows, Remote Command Execution and Privilege Escalation

NOTICE: The information in this Security Bulletin should be acted upon as
soon as possible.

Release Date: 2013-09-18
Last Updated: 2013-09-18

Potential Security Impact: Remote command execution and privilege escalation.

Source: Hewlett-Packard Company, HP Software Security Response Team

VULNERABILITY SUMMARY
Potential security vulnerabilities have been identified with HP System
Management Homepage (SMH) running on Linux and Windows. The vulnerabilities
could be exploited remotely resulting in command execution and privilege
gain.

References:
CVE-2013-3576 (SSRT101183, VU#735364) Remote Command Execution and privilege
escalation.

SUPPORTED SOFTWARE VERSIONS*: ONLY impacted versions are listed.
HP System Management Homepage (SMH) v7.2.1 and earlier running on Linux and
Windows.

BACKGROUND

CVSS 2.0 Base Metrics
===========================================================
  Reference              Base Vector             Base Score
CVE-2013-3576    (AV:N/AC:L/Au:S/C:C/I:C/A:C)       9.0
===========================================================
             Information on CVSS is documented
            in HP Customer Notice: HPSN-2008-002

The Hewlett-Packard Company thanks Markus Wulftange for reporting
vulnerability CVE-2013-3576 to security-alert@hp.com

RESOLUTION

HP has made System Management Homepage (SMH) v7.2.2 or subsequent available
for Windows and Linux to resolve the vulnerabilities.

Information and updates for SMH can be found at the following location:

<http://h18013.www1.hp.com/products/servers/management/agents/index.html>

HISTORY
Version:1 (rev.1) - 18 September 2013 Initial release

Third Party Security Patches: Third party security patches that are to be
installed on systems running HP software products should be applied in
accordance with the customer's patch management policy.

Support: For issues about implementing the recommendations of this Security
Bulletin, contact normal HP Services support channel.  For other issues about
the content of this Security Bulletin, send e-mail to security-alert@hp.com.

Report: To report a potential security vulnerability with any HP supported
product, send Email to: security-alert@hp.com

Subscribe: To initiate a subscription to receive future HP Security Bulletin
alerts via Email:
<http://h41183.www4.hp.com/signup_alerts.php?jumpid=hpsc_secbulletins>

Security Bulletin Archive: A list of recently released Security Bulletins is
available here:
<https://h20564.www2.hp.com/portal/site/hpsc/public/kb/secBullArchive/>

Software Product Category: The Software Product Category is represented in
the title by the two characters following HPSB.

3C = 3COM
3P = 3rd Party Software
GN = HP General Software
HF = HP Hardware and Firmware
MP = MPE/iX
MU = Multi-Platform Software
NS = NonStop Servers
OV = OpenVMS
PI = Printing and Imaging
PV = ProCurve
ST = Storage Software
TU = Tru64 UNIX
UX = HP-UX

Copyright 2013 Hewlett-Packard Development Company, L.P.
Hewlett-Packard Company shall not be liable for technical or editorial errors
or omissions contained herein. The information provided is provided "as is"
without warranty of any kind. To the extent permitted by law, neither HP or
its affiliates, subcontractors or suppliers will be liable for
incidental,special or consequential damages including downtime cost; lost
profits;damages relating to the procurement of substitute products or
services; or damages for loss of data, or software restoration. The
information in this document is subject to change without notice.
Hewlett-Packard Company and the names of Hewlett-Packard products referenced
herein are trademarks of Hewlett-Packard Company in the United States and
other countries. Other product and company names mentioned herein may be
trademarks of their respective owners.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)

iEYEARECAAYFAlI5xcwACgkQ4B86/C0qfVnHyQCbBWrIQB9THtAXKN2Lm/015P91
zcAAoKK75QOhN9pw1+WPImbroXR+ic5H
=p5wX
-----END PGP SIGNATURE-----
[[prev in list](?l=bugtraq&m=137952422705356&w=2)] [[next in list](?l=bugtraq&m=137952653606197&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


