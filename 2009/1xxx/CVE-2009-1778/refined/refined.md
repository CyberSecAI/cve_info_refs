- **Root cause of vulnerability:** The user registration module is vulnerable to SQL injection due to insufficient input sanitization. Specifically, the username field is vulnerable, allowing an attacker to inject malicious SQL code.
- **Weaknesses/vulnerabilities present:** SQL Injection vulnerability in the username field of the user registration form. The vulnerability exists due to the lack of proper sanitization of user input before it's used in an SQL query.
- **Impact of exploitation:** An attacker can exploit this vulnerability to modify existing user account information by using the `ON DUPLICATE KEY UPDATE` clause. For instance, they could change an administrator's password by using a valid username and crafting a specific SQL injection payload to update the password field in the database. If the attacker provides a non-existent username, a new user will be inserted in the database.
- **Attack vectors:** The vulnerability is exploited via a web interface during the user registration process. An attacker needs to send a malicious POST request to the vulnerable registration endpoint, including a crafted username that contains SQL injection code.
- **Required attacker capabilities/position:**
    - The attacker needs to be able to access the vulnerable user registration page.
    - The attacker needs to know a valid username to be able to modify an existing user password.
    - The attacker needs to solve the captcha to send the request.
    - If the captcha uses securimage, the attacker also needs a valid PHPSESSID.
    - The `magic_quotes_gpc` needs to be set to `off` on the server for the injection to work.