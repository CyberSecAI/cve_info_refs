- **Root cause of vulnerability:** A stack-based buffer overflow exists in the `Base64FileEncode()` method of the `api.dll` library within Icewarp Merak Mail Server.
- **Weaknesses/vulnerabilities present:** The vulnerability lies in the insufficient bounds checking of the second argument passed to the `Base64FileEncode()` method.
- **Impact of exploitation:** An attacker can overwrite parts of the stack, including the return address, potentially leading to arbitrary code execution. The provided proof-of-concept (PoC) demonstrates this by overwriting the return address and injecting shellcode. The impact of successful exploitation could be a denial-of-service (DoS) or full system compromise, depending on the injected shellcode.
- **Attack vectors:** The vulnerable `api.dll` library is loaded by the Icewarp PHP extension, which can be accessed via the webmail service. The vulnerability can be triggered if the final argument of the `icewarp_apiobjectcall()` function, which is used to call the vulnerable `Base64FileEncode()` method, is exposed to remote user input.
- **Required attacker capabilities/position:** An attacker would need to be able to send a crafted request through the webmail service which calls the `icewarp_apiobjectcall()` function with a malicious payload to trigger the vulnerability. This implies an attacker with some level of access to the web service.