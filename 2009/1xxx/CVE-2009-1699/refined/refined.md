```
{
  "cveId": "CVE-2009-1699",
  "relatedContent": [
    {
      "source": "lists.opensuse.org_80ebef0a_20250125_073007.html",
      "vulnerability": "This document lists CVE-2009-1699 as one of many vulnerabilities fixed in a SUSE Security Summary Report related to libwebkit."
    },
    {
      "source": "scarybeastsecurity.blogspot.com_842ee2d4_20250125_073009.html",
      "vulnerability": "This blog post discusses the fix for an XXE vulnerability in Safari 4 related to XSL XML parsing which is identified as CVE-2009-1699. It also provides links to proof-of-concept demos for Safari 3 (MacOS and Windows)."
    },
    {
      "source": "support.apple.com_869139d5_20250125_073014.html",
      "vulnerability": "This Apple support document describes the security content of iOS 3.0 Software Update and lists CVE-2009-1699. It states that an XML External Entity issue exists in WebKit's handling of XML. Visiting a maliciously crafted website may result in the website being able to read files from the user's system. The update addresses the issue by not loading external entities across origins."
    },
    {
      "source": "support.apple.com_8768779f_20250125_073013.html",
       "vulnerability": "This Apple support document describes the security content of Safari 4.0 and lists CVE-2009-1699. It states that an XML External Entity issue exists in WebKit's handling of XML. A maliciously crafted website may be able to read files from the user's system. The update addresses the issue by not loading external entities across origins. This vulnerability affects Mac OS X, Mac OS X Server, and Windows systems."
     },
     {
      "source": "scary.beasts.org_9e4b9dcf_20250125_073008.html",
      "vulnerability": "This page provides details on CESA-2009-006, which is the Safari local file theft bug, also known as CVE-2009-1699. It describes how Safari's XSL stylesheets were vulnerable to XXE attacks, allowing an attacker to steal local files by referencing them in the XSL resource's DTD. Example code for an evil DTD and links to demos are provided."
    },
    {
      "source": "launchpad.net_cabfcc1c_20250126_071438.html",
      "vulnerability": "This changelog for the qt4-x11 package mentions CVE-2009-1699 as an arbitrary file disclosure vulnerability via crafted DTD.  It details the fix in `src/3rdparty/webkit/WebCore/dom/XMLTokenizer.cpp`"
    },
     {
      "source": "www.exploit-db.com_a3b624cb_20250125_073018.html",
      "vulnerability": "Exploit-DB entry EDB-ID 8907 describes an Apple Safari 3.2.x XML External Entity Local File Theft vulnerability.  The vulnerability occurs in Safari prior to version 4 where an evil web page can steal local files through an XXE attack against XSL XML parsing.  It provides the sample evil XSL file with an example DTD that attempts the XXE attack and the XML used to call the evil XSL file.  The advisory links to other pages for more information."
     },
    {
      "source": "www.ubuntu.com_1965d18d_20250125_073016.html",
      "vulnerability": "This Ubuntu Security Notice (USN-857-1) details Qt vulnerabilities including CVE-2009-1699, stating that QtWebKit did not properly handle certain XSL stylesheets allowing an attacker to read arbitrary local files and possibly files from different security zones if a user were tricked into viewing a malicious website."
    }
  ],
  "vulnerabilityDetails": {
    "rootCause": "The root cause is an XML External Entity (XXE) vulnerability in WebKit's handling of XML, specifically related to XSL stylesheets.",
    "weaknesses": [
      "XML External Entity (XXE) injection",
      "Insufficient input validation",
        "Improper handling of external entities"
    ],
    "impact": "A successful exploit allows a malicious website to read local files from the user's system, potentially leading to information disclosure.",
    "attackVectors": [
      "Visiting a maliciously crafted website",
      "Serving an XML document with an XSL stylesheet that references local files via an external entity",
      "Web page with XML MIME type styled with a malicious XSL file"
    ],
    "attackerCapabilities": [
      "Ability to serve malicious web content",
        "Knowledge of XML and XSLT"
    ],
     "additionalDetails": "The vulnerability can be triggered through an XSL file which includes a DTD that attempts the XXE attack. WebKit does not prevent the loading of external entities across origins.",
        "affectedProducts": [
          "Safari prior to version 4",
          "iOS 1.0 through 2.2.1",
          "iOS for iPod touch 1.1 through 2.2.1",
            "WebKit",
          "QtWebKit",
            "Ubuntu 8.10, 9.04"
        ]
  }
}
```