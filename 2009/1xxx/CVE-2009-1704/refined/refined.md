```text
RELATED
```

### Summary of Vulnerability Information:

The vulnerability **CVE-2009-1704** is present in **CFNetwork** affects **Safari 4.0** on **Mac OS X v10.4.11, Mac OS X Server v10.4.11, Mac OS X v10.5.7, Mac OS X Server v10.5.7, Windows XP or Vista**.

*   **Root Cause:** The vulnerability arises because Safari may fail to correctly identify the file type of certain local image files. In such cases, Safari examines the content of these files and may mistakenly treat them as HTML.
*   **Weakness:** Incorrect file type identification.
*   **Impact:** If a downloaded image file contains JavaScript, it will be executed without warning the user. This can lead to unintended execution of scripts in the local context, which normally requires user consent.
*   **Attack Vector:** An attacker can craft a malicious image file containing embedded JavaScript code. When a user downloads this image file, Safari may misidentify it as HTML and execute the JavaScript code without prompting the user.
*   **Mitigation:** The issue is addressed by treating files of unknown type as generic binary data and correctly identifying the image file types known to have this issue.
*   **Credit:** Sergio 'shadown' Alvarez of Recurity Labs GmbH for reporting this issue.