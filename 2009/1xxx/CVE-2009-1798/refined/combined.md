=== Content from www.kb.cert.org_2667a81f_20250125_195042.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#166739

## APC Network Management Card web interface vulnerable to cross-site scripting and cross-site request forgery

#### Vulnerability Note VU#166739

Original Release Date: 2010-02-25 | Last Revised: 2010-04-29

---

### Overview

The web management interface for the APC Network Monitoring Card (NMC) used in various APC devices contains cross-site scripting (XSS) and cross-site request forgery (CSRF/XSRF) vulnerabilities. By convincing a victim to load a specially crafted URL while authenticated to an NMC, an attacker could obtain credentials or perform certain actions as the victim, including turning off the NMC-based device and any systems attached to it.

### Description

| Some APC uninterruptible power supplies (UPS) support remote network management using several types of Network Monitoring Card (NMC).  The NMC web management interface does not adequately filter user-supplied data before that data is included in dynamically generated web pages, creating cross-site scripting (XSS) vulnerabilities. One XSS vulnerability occurs in the /Forms/login1?login\_username field ([CVE-2009-4406](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4406)). There may be other XSS vulnerabilities in the NMC web management interface ([CVE-2009-1798](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1798)).The web interface also fails to adequately authenticate some requests, creating cross-site request forgery (CSRF/XSRF) vulnerabilities ([CVE-2009-1797](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1797)). |
| --- |

### Impact

| By convincing a victim to load a specially crafted URL while authenticated to an NMC, an attacker could obtain user credentials or perform certain actions as that user. It is possible to exploit the XSS vulnerabilities to obtain cookies and other page content, so an attacker could obtain administrative credentials. If the attacker were able to access the NMC directly, the attacker would have complete control and could reconfigure the UPS or turn it off, thereby turning off any systems connected to the UPS. Exploiting the CSRF vulnerabilities could allow an attacker to take certain actions via the web interface, including turning off the UPS and any connected systems. |
| --- |

### Solution

| **Update firmware**Update NMC firmware as specified by APC. [Release notes](http://www.apcmedia.com/salestools/PMAR-82BMH5_R0_EN.zip) indicate that these vulnerabilities are addressed in firmware version 3.7.2 for certain NMCs. APC has indicated that the vulnerabilities are also addressed in firmware version 5.1.1. |
| --- |

| **Disable web interface**Disabling the web management interface will prevent exploitation of these vulnerabilities.**Restrict access**As a general good security practice, only allow connections from trusted hosts and networks. Consider setting up management networks as separate and dedicated channels. Note that restricting access does not prevent XSS or CSRF attacks since the attack comes as an HTTP request from a legitimate user's host. Restricting access would prevent an attacker from accessing an NMC using stolen credentials from a blocked network location. |
| --- |

### Vendor Information

166739
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23166739/) to view vendors.**
### [American Power Conversion Corp.](#AAMN-7Z6RN9) Affected

Updated:  February 24, 2010

**Statement Date:   December 23, 2009**

### Status

Affected

### Vendor Statement

Please see [Cross Site Scripting & Forgery Issue (XSS/CSRF) in NMC-Based Products](http://nam-en.apc.com/cgi-bin/nam_en.cfg/php/enduser/std_adp.php?p_faqid=10887&p_created=1261587018&p_topview=1).

### Vendor Information

Update NMC firmware as specified by APC. [Release notes](http://www.apcmedia.com/salestools/PMAR-82BMH5_R0_EN.zip) indicate that these vulnerabilities are addressed in firmware version 3.7.2 for certain NMCs. APC has indicated that the vulnerabilities are also addressed in firmware version 5.1.1.

### Vendor References

* <http://nam-en.apc.com/cgi-bin/nam_en.cfg/php/enduser/std_adp.php?p_faqid=10887&p_created=1261587018&p_topview=1>
* <http://www.apcmedia.com/salestools/PMAR-82BMH5_R0_EN.zip>

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://holisticinfosec.org/content/view/111/45/>
* <http://nam-en.apc.com/cgi-bin/nam_en.cfg/php/enduser/std_adp.php?p_faqid=10887&p_created=1261587018&p_topview=1>
* <http://www.securityfocus.com/archive/1/508468/30/60/threaded>
* <http://www.securityfocus.com/archive/1/508468/100/0/threaded>
* <http://www.securityfocus.com/bid/37338/info>
* <http://www.apcmedia.com/salestools/PMAR-82BMH5_R0_EN.zip>
### Acknowledgements

These vulnerabilities were researched and reported by Russ McRee. Jamal Pecou also reported CVE-2009-4406.

This document was written by Art Manion.

### Other Information

| **CVE IDs:** | [CVE-2009-1797](http://web.nvd.nist.gov/vuln/detail/CVE-2009-1797), [CVE-2009-1798](http://web.nvd.nist.gov/vuln/detail/CVE-2009-1798), [CVE-2009-4406](http://web.nvd.nist.gov/vuln/detail/CVE-2009-4406) |
| --- | --- |
| **Date Public:** | 2009-12-14 |
| **Date First Published:** | 2010-02-25 |
| **Date Last Updated:** | 2010-04-29 16:25 UTC |
| **Document Revision:** | 27 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


