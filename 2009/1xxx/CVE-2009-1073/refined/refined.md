```
Message-Id: <1237810902.3229.15.camel@dhcp-lab-164.englab.brq.redhat.com>
Date: Mon, 23 Mar 2009 13:21:42 +0100
From: Jan Lieskovsky <jlieskov@...hat.com>
To: "Steven M. Christey" <coley@...us.mitre.org>
Cc: oss-security <oss-security@...ts.openwall.com>
Subject: CVE request -- ucd-snmp / net-snmp, libnss-ldapd / nss_ldap

Hello Steve,

  could you please assign CVE ids for following
two low security issues:

1, ucd-snmp / net-snmp snmpd runs with privileges of privileged user
   a, Red Hat Enterprise Linux / Fedora snmpd runs with UID=0, GID=0
   b, Debian snmpd runs with GID=0
   References:
   <https://bugzilla.redhat.com/show_bug.cgi?id=491621>
   <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=520724>

2, libnss-ldapd / nss_ldap: LDAP service configuration file
                                 shipped with world readable permissions
   References:
   <https://bugzilla.redhat.com/show_bug.cgi?id=491623>
   <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=520476>

Thanks, Jan.
--
Jan iankko Lieskovsky / Red Hat Security Response Team
```
```
Message-ID: <20090325021952.GJ4170@redhat.com>
Date: Tue, 24 Mar 2009 20:19:52 -0600
From: Vincent Danen <vdanen@...hat.com>
To: oss-security@...ts.openwall.com
Cc: "Steven M. Christey" <coley@...us.mitre.org>
Subject: Re: CVE request -- ucd-snmp / net-snmp,
	libnss-ldapd / nss_ldap

* [2009-03-24 21:05:49 -0400] Steven M. Christey wrote:

>> >2, libnss-ldapd / nss_ldap: LDAP service configuration file
>> >                                 shipped with world readable permissions
>> >   References:
>> >   <https://bugzilla.redhat.com/show_bug.cgi?id=491623>
>> >   <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=520476>
>>
>> On a side note, this is pretty specific to libnss-ldapd and not so much
>> nss_ldap.
>
>So, the various bug reports and followups list:
>
>  libnss-ldapd
>  nss_ldap
>  nss-ldapd
>  openldap
>
>Which package is actually affected and what versions might they be?

nss-ldapd is the name of the upstream package.  I suppose Debian and
others may package it with a package name of libnss-ldapd.

nss-ldapd is a fork of nss_ldap... I don't know enough to say how much
it differs, but for nss_ldap at least, /etc/ldap.conf should be
world-readable (or at least typically is, with no real exposure since
using non-anonymous binds to LDAP would be unusual -- at least from
everything I've seen and done with LDAP authentication).

/etc/ldap.conf has nothing to do with openldap and while the filename,
and probably file contents are the same, it sounds like libnss-ldap may
require more protection and/or be meant to run with a protected
configuration file.

It also, and someone correct me if I'm wrong, be due to the debian
package allowing someone to specify a bindpw at install and then not
protecting the file contents if someone does specify a bindpw.  With
RHEL and Fedora, there are no mechanisms to ask a user for a bindpw
(because it is not typical), so we would expect that an admin who puts a
bindpw in there for a user that is meant to be protected (i.e. something
other than an unprivileged user that suits the criteria for anonymous
binds for the purpose of obtaining certain non-privileged user
information), would also adequately protect the file when manually
setting the password.

And, if that is the case, then I would argue this is a debconf-specific
issue for this package than a general nss-ldapd-specific issue.

In fact, if you look here:

<http://ch.tudelft.nl/~arthur/nss-ldapd/news.html#20090322>

you'll see that this is noted as a "security problem in ... the Debian
package configuration".

>Use CVE-2009-1073, to be filled in once I have some more detail.

--
Vincent Danen / Red Hat Security Response Team
```
```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- ------------------------------------------------------------------------
Debian Security Advisory DSA-1758-1                  security@debian.org
<http://www.debian.org/security/>                       Moritz Muehlenhoff
March 30, 2009                        <http://www.debian.org/security/faq>
- ------------------------------------------------------------------------

Package        : nss-ldapd
Vulnerability  : insecure config file creation
Problem-Type   : local
Debian-specific: yes
CVE ID         : CVE-2009-1073
Debian Bug     : 520476

Leigh James that discovered that nss-ldapd, an NSS module for using
LDAP as a naming service, by default creates the configuration file
/etc/nss-ldapd.conf world-readable which could leak the configured
LDAP password if one is used for connecting to the LDAP server.

The old stable distribution (etch) doesn't contain nss-ldapd.

For the stable distribution (lenny) this problem has been fixed in
version 0.6.7.1.

For the unstable distribution (sid) this problem has been fixed in
version 0.6.8.

We recommend that you upgrade your nss-ldapd package.

Upgrade instructions
- --------------------
```
```
# CVE 2009-1073

nss-ldapd before 0.6.8 uses world-readable permissions for the /etc/nss-ldapd.conf file, which allows local users to obtain a cleartext password for the LDAP server by reading the bindpw field.

See the ![](/@@/link)
[CVE page on Mitre.org](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2009-1073)
for more details.

```
```
Package:
[libnss-ldapd](pkgreport.cgi?package=libnss-ldapd);
...
Reported by: [Leigh James <leigh@bms.qld.edu.au>](pkgreport.cgi?submitter=leigh%40bms.qld.edu.au)

Date: Fri, 20 Mar 2009 04:36:02 UTC

Severity: important

Tags: security

Found in version nss-ldapd/0.6.7

Fixed in versions nss-ldapd/0.6.8, nss-ldapd/0.6.7.1

**Done:** Arthur de Jong <adejong@debian.org>

...
```
```
Message #5 received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=520476;msg=5), [mbox](bugreport.cgi?bug=520476;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=leigh%40bms.qld.edu.au)
From: Leigh James <leigh@bms.qld.edu.au>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: libnss-ldapd: /etc/nss-ldapd.conf is created world-readable, exposing bindpw
Date: Fri, 20 Mar 2009 14:32:03 +1000
```
```
Package: libnss-ldapd
Version: 0.6.7
Severity: important

Hi, I believe there is a security issue with the default permissions on file /etc/nss-ldapd.conf
It is created as follows:
owner: root
group: root
mode: 644

My LDAP server requires authentication to access the posix user/group attributes,
but the clear text credentials I have provided to debconf are world-readable
when saved in this file. I suggest the following permissions as a new default:
owner: root
group: nslcd
mode: 640
```
```
Message #10 received at 520476@bugs.debian.org ([full text](bugreport.cgi?bug=520476;msg=10), [mbox](bugreport.cgi?bug=520476;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=adejong%40debian.org)
From: Arthur de Jong <adejong@debian.org>
To: Leigh James <leigh@bms.qld.edu.au>, 520476@bugs.debian.org
Subject: Re: Bug#520476: libnss-ldapd: /etc/nss-ldapd.conf is created
world-readable, exposing bindpw
Date: Fri, 20 Mar 2009 13:13:36 +0100
```
```
tags 520476 + pending
thanks

On Fri, 2009-03-20 at 14:32 +1000, Leigh James wrote:
> Hi, I believe there is a security issue with the default permissions
> on file /etc/nss-ldapd.conf It is created as follows:
> owner: root
> group: root
> mode: 644
>
> My LDAP server requires authentication to access the posix user/group
> attributes, but the clear text credentials I have provided to debconf
> are world-readable when saved in this file. I suggest the following
> permissions as a new default:
> owner: root
> group: nslcd
> mode: 640

Thanks for your report. This has been a TODO item in the package
configuration that has now been fixed. A patch is available here:
<http://arthurenhella.demon.nl/viewvc/nss-ldapd/nss-ldapd/debian/libnss-ldapd.postinst?r1=795&r2=813>

It changes permissions to 600 if the package is installed with a
password in it or if it's reconfigured width dpkg-reconfigure.

Additionally this patch:
<http://arthurenhella.demon.nl/viewvc/nss-ldapd/nss-ldapd/man/nss-ldapd.conf.5.xml?r1=805&r2=806>
mentions setting proper permissions in the manual page.
```
```
Message #17 received at 520476@bugs.debian.org ([full text](bugreport.cgi?bug=520476;msg=17), [mbox](bugreport.cgi?bug=520476;mbox=yes;msg=17), reply):

![](/cgi-bin/libravatar.cgi?email=adejong%40debian.org)
From: Arthur de Jong <adejong@debian.org>
To: Leigh James <leigh@bms.qld.edu.au>
Cc: 520476 <520476@bugs.debian.org>
Subject: Re: Bug#520476: libnss-ldapd: /etc/nss-ldapd.conf is created
world-readable, exposing bindpw
Date: Sat, 21 Mar 2009 14:03:30 +0100
```
```
tags 520476 + security
thanks

On Fri, 2009-03-20 at 13:13 +0100, Arthur de Jong wrote:
> Thanks for your report. This has been a TODO item in the package
> configuration that has now been fixed.
[...]
> It changes permissions to 600 if the package is installed with a
> password in it or if it's reconfigured width dpkg-reconfigure.

After discussing this with the Debian security team I will make a
slightly different solution that would always set the permissions of the
file so that it is no longer world-readable.

I will prepare an updated package.
```
```
Message #24 received at 520476-close@bugs.debian.org ([full text](bugreport.cgi?bug=520476;msg=24), [mbox](bugreport.cgi?bug=520476;mbox=yes;msg=24), reply):

![](/cgi-bin/libravatar.cgi?email=adejong%40debian.org)
From: Arthur de Jong <adejong@debian.org>
To: 520476-close@bugs.debian.org
Subject: Bug#520476: fixed in nss-ldapd 0.6.8
Date: Sun, 22 Mar 2009 22:17:03 +0000
```
```
Source: nss-ldapd
Source-Version: 0.6.8

We believe that the bug you reported is fixed in the latest version of
nss-ldapd, which is due to be installed in the Debian FTP archive:

libnss-ldapd_0.6.8_i386.deb
  to pool/main/n/nss-ldapd/libnss-ldapd_0.6.8_i386.deb
nss-ldapd_0.6.8.dsc
  to pool/main/n/nss-ldapd/nss-ldapd_0.6.8.dsc
nss-ldapd_0.6.8.tar.gz
  to pool/main/n/nss-ldapd/nss-ldapd_0.6.8.tar.gz

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 520476@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

...
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
...
Changes:
 nss-ldapd (0.6.8) unstable; urgency=high
 .
   * SECURITY FIX: the nss-ldapd.conf file that is installed was created
                   world-readable which could cause problems if the bindpw
                   option is used
                   this has been fixed and warnings have been added to the
                   manual page and sample nss-ldapd.conf (closes: #[520476](bugreport.cgi?bug=520476))
```
```
Message #29 received at 520476-close@bugs.debian.org ([full text](bugreport.cgi?bug=520476;msg=29), [mbox](bugreport.cgi?bug=520476;mbox=yes;msg=29), reply):

![](/cgi-bin/libravatar.cgi?email=adejong%40debian.org)
From: Arthur de Jong <adejong@debian.org>
To: 520476-close@bugs.debian.org
Subject: Bug#520476: fixed in nss-ldapd 0.6.7.1
Date: Thu, 02 Apr 2009 13:54:03 +0000
```
```
Source: nss-ldapd
Source-Version: 0.6.7.1

We believe that the bug you reported is fixed in the latest version of
nss-ldapd, which is due to be installed in the Debian FTP archive:

libnss-ldapd_0.6.7.1_i386.deb
  to pool/main/n/nss-ldapd/libnss-ldapd_0.6.7.1_i386.deb
nss-ldapd_0.6.7.1.dsc
  to pool/main/n/nss-ldapd/nss-ldapd_0.6.7.1.dsc
nss-ldapd_0.6.7.1.tar.gz
  to pool/main/n/nss-ldapd/nss-ldapd_0.6.7.1.tar.gz

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 520476@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.
...
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
...
Changes:
 nss-ldapd (0.6.7.1) stable-security; urgency=high
 .
   * security upload
   * fix the permissions of /etc/nss-ldapd.conf to not be world readable
     (file can be used to store LDAP password) (closes: #[520476](bugreport.cgi?bug=520476))
```
```
Message-ID: <Pine.GSO.4.51.0903242102270.18572@faron.mitre.org>
Date: Tue, 24 Mar 2009 21:05:49 -0400 (EDT)
From: "Steven M. Christey" <coley@...us.mitre.org>
To: oss-security@...ts.openwall.com
cc: "Steven M. Christey" <coley@...us.mitre.org>
Subject: Re: CVE request -- ucd-snmp / net-snmp, libnss-ldapd
 / nss_ldap

On Tue, 24 Mar 2009, Vincent Danen wrote:

> * [2009-03-23 13:21:42 +0100] Jan Lieskovsky wrote:
>
> >2, libnss-ldapd / nss_ldap: LDAP service configuration file
> >                                 shipped with world readable permissions
> >   References:
> >   <https://bugzilla.redhat.com/show_bug.cgi?id=491623>
> >   <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=520476>
>
> On a side note, this is pretty specific to libnss-ldapd and not so much
> nss_ldap.

So, the various bug reports and followups list:

  libnss-ldapd
  nss_ldap
  nss-ldapd
  openldap

Which package is actually affected and what versions might they be?

Use CVE-2009-1073, to be filled in once I have some more detail.

- Steve
```
```
Message-ID: <20090324144725.GA4170@redhat.com>
Date: Tue, 24 Mar 2009 08:47:25 -0600
From: Vincent Danen <vdanen@...hat.com>
To: oss-security@...ts.openwall.com
Cc: "Steven M. Christey" <coley@...us.mitre.org>
Subject: Re: CVE request -- ucd-snmp / net-snmp,
	libnss-ldapd / nss_ldap

* [2009-03-23 13:21:42 +0100] Jan Lieskovsky wrote:

>2, libnss-ldapd / nss_ldap: LDAP service configuration file
>                                 shipped with world readable permissions
>   References:
>   <https://bugzilla.redhat.com/show_bug.cgi?id=491623>
>   <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=520476>

On a side note, this is pretty specific to libnss-ldapd and not so much
nss_ldap.
```

Based on the provided information, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**

- The `nss-ldapd` package, specifically the Debian packaging of it as `libnss-ldapd`, creates the configuration file `/etc/nss-ldapd.conf` with world-readable permissions (mode 644) by default.

**Weaknesses/vulnerabilities present:**

- **Information Disclosure:** The configuration file `/etc/nss-ldapd.conf` may contain sensitive information, specifically a cleartext password (`bindpw`) used to connect to the LDAP server. Because the file is world-readable, any local user can access this password.
- **Insecure Default Permissions:** The default permissions of the configuration file are too permissive and expose sensitive information.

**Impact of exploitation:**

- A local attacker could read the `/etc/nss-ldapd.conf` file and obtain the cleartext password for the LDAP server.
- This password could be used to gain unauthorized access to the LDAP server and potentially modify or steal data.

**Attack vectors:**

- Local access is required to exploit this vulnerability. Any local user on the system where `nss-ldapd` is installed can read the file.

**Required attacker capabilities/position:**

- The attacker must be a local user on a system with the vulnerable `libnss-ldapd` package installed.
- No special privileges are required to read a world-readable file.

**Additional notes**
- The issue is Debian-specific, related to how the package was configured to handle the `bindpw` option during installation.
- Upstream nss-ldapd was also affected because the package created the configuration with insecure default permissions.
- The vulnerability has been fixed in nss-ldapd versions 0.6.8 and 0.6.7.1 (for Debian stable distribution).
- Patches were made to the package scripts, setting permissions to 600 to prevent world-readability.