=== Content from www.vupen.com_801a966d_20250125_210737.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from www.redteam-pentesting.de_e7743924_20250125_210735.html ===
+49 241 510081-0kontakt@redteam-pentesting.de[DE](/de/advisories/rt-sa-2009-001/)[![RedTeam Pentesting Logo](/img/redteam-logo_hub5a66d245245ce30f53b50d2b4dfb31b_19123_120x0_resize_q100_h2_box_3.webp)](/)[DE](/de/advisories/rt-sa-2009-001/ "Deutsche Version")

* Company
  Company
  + [About us](/en/redteam/)
  + [History](/en/redteam/history/)
  + [Press](/en/press/)
  + [News Archive](/en/archive/)
* Pentest
  Pentest
  + [Definition](/en/pentest/)
  + [Types of Tests](/en/pentest/types/)
  + [Workflow](/en/pentest/workflow/)
  + [FAQ](/en/faq/)
* Publications
  Publications
  + [Overview](/en/publications/)
  + [Advisories](/en/advisories/)
  + [Talks](/en/talks/)
  + [Other Publications](/en/publications-other/)
* [Career](https://jobs.redteam-pentesting.de/)
* [Blog](https://blog.redteam-pentesting.de/)
* [Contact](#contactform)

Contact

Contact us

+49 241 510081-0kontakt@redteam-pentesting.de[Contact form](#contactform)JavaScript is not enabled in your browser. Please consider that some functions might not be available for you.![RedTeam Pentesting Header](/img/header/hl_header-1_hu0f2d230fb5185511a90e67c2e597c0b5_900546_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-2_hub774373357e916cb041b4943299d8717_1132770_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-3_hub8fc12cb70b2021e589c6810b4b53d04_895916_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-4_hu27d71f64bf1f030161a23c2dcd666f59_1015002_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-5_hud32f8d698ff23308f4d8b8566aae5928_933115_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-6_hu1bc03534cd122894ef676fff89833ac5_1144618_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-7_hu91e55bd77169043ae9e542f1b5f8f2f4_1354043_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-8_hu155130647c165410f2ffa35227549138_1321813_1000x0_resize_q100_h2_box.webp)[newer](https://www.redteam-pentesting.de/en/advisories/rt-sa-2009-002/)[back to overview](/en/advisories)[older](https://www.redteam-pentesting.de/en/advisories/rt-sa-2008-002/)

[Text Version](/en/advisories/rt-sa-2009-001.txt)

## IceWarp WebMail Server: Cross Site Scripting in Email View

During a penetration test, RedTeam Pentesting discovered that the IceWarp
WebMail Server is prone to Cross Site Scripting attacks in its email view.
This enables attackers to send emails with embedded JavaScript code,
for example, to steal users’ session IDs.

### Details

* Product: IceWarp eMail Server / WebMail Server
* Affected Versions: 9.4.1
* Fixed Versions: 9.4.2
* Vulnerability Type: Cross Site Scripting
* Security Risk: high
* Vendor URL: `http://www.icewarp.com/`
* Vendor Status: notified, fixed version released
* Advisory URL: `https://www.redteam-pentesting.de/advisories/rt-sa-2009-001`
* Advisory Status: published
* CVE: CVE-2009-1467
* CVE URL: `https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1467`

### Introduction

“Feature complete yet easy to use, WebMail Server Pro provides feature
rich Web 2.0 web-based access to email, calendars, contacts, files and
shared data from any computer with browser and internet connection,
without the usual configuration hassle. Thanks to advanced technologies
and application-like look and feel, Pro suggests it was born to become the
ultimate replacement of Outlook and similar desktop mail clients.”

(from the vendor’s homepage)

### More Details

To prevent the execution of JavaScript and VBScript code in HTML emails
and to remove unwanted HTML tags, the IceWarp WebMail Server filters HTML
emails with the function cleanHTML() that is defined in the PHP file

`html/webmail/server/inc/tools.php`

This filtering function can be circumvented in various ways, to still
allow XSS to happen.

#### Tag Removal

Beginning in line 462 down to line 482, the cleanHTML() function removes
or changes a variety of keywords which are considered malicious. This
includes the removal of all attributes starting with “on” (e.g.
onmouseover, onload etc.) and the rewriting of the words “javascript” and
“vbscript” to “noscript”.

Later, in line 485, the cleanHTML() function completely removes various HTML
tags from the email:

```
$string = preg_replace('#</*(meta|xml|blink|link|embed|object|iframe|
          frame|frameset|ilayer|layer|bgsound)[^>]*>#i',"",$string);

```

By inserting one of these HTML tags, which gets removed by the filtering
function, between the keywords which get filtered before, the cleanHTML()
function will not recognize them anymore. Later, it will remove the HTML
tag and thereby make the keyword valid again.

#### Proof of Concept Tag Removal

An HTML email with the following content will open an alert box in
victims’ browsers when they move the mouse over the “XSS” text of the

```
<div o<xml>nmouseover="alert('XSS')";>XSS</div>

```

This circumvention should work in all recent browsers with JavaScript
support, during the penetration test Firefox 3.x was used.

#### Hex Encoding

Another way to circumvent the filtering is to use hex-encoded HTML
entities. The character “j” can e.g. be encoded as “j”. The
cleanHTML() function decodes the given string once in line 459:

```
$string = html_entity_decode($string, ENT_COMPAT, "UTF-8");

```

By double encoding the input, all regular expressions used for filtering
will fail to recognize malicious content even after the first decoding.

The effect of this vulnerability is limited by the fact that HTML
encoded entities are recognized by browsers only if they are part of a
text node or attribute values.

#### Proof of Concept Hex Encoding

The “src” attribute value of the HTML tag

`<img src=javascript:alert(RedTeam)>`

can be double encoded as

```
<img src=&#x26;&#x23;&#x78;&#x36;&#x61;&#x3b;&#x26;&#x23;&#x78;&#x36;
&#x31;&#x3b;&#x26;&#x23;&#x78;&#x37;&#x36;&#x3b;&#x26;&#x23;&#x78;
&#x36;&#x31;&#x3b;&#x26;&#x23;&#x78;&#x37;&#x33;&#x3b;&#x26;&#x23;
&#x78;&#x36;&#x33;&#x3b;&#x26;&#x23;&#x78;&#x37;&#x32;&#x3b;&#x26;
&#x23;&#x78;&#x36;&#x39;&#x3b;&#x26;&#x23;&#x78;&#x37;&#x30;&#x3b;
&#x26;&#x23;&#x78;&#x37;&#x34;&#x3b;&#x26;&#x23;&#x78;&#x33;&#x61;
&#x3b;&#x26;&#x23;&#x78;&#x36;&#x31;&#x3b;&#x26;&#x23;&#x78;&#x36;
&#x63;&#x3b;&#x26;&#x23;&#x78;&#x36;&#x35;&#x3b;&#x26;&#x23;&#x78;
&#x37;&#x32;&#x3b;&#x26;&#x23;&#x78;&#x37;&#x34;&#x3b;&#x26;&#x23;
&#x78;&#x32;&#x38;&#x3b;&#x26;&#x23;&#x78;&#x33;&#x34;&#x3b;&#x26;
&#x23;&#x78;&#x33;&#x32;&#x3b;&#x26;&#x23;&#x78;&#x32;&#x39;&#x3b;>

```

This will be decoded by the html\_entity\_decode() function in line 459 to
the string

```
<img src=&#x6a;&#x61;&#x76;&#x61;&#x73;&#x63;&#x72;&#x69;&#x70;&#x74;
         &#x3a;&#x61;&#x6c;&#x65;&#x72;&#x74;&#x28;&#x34;&#x32;&#x29;>

```

The value of the “src” attribute will not be recognized by the filtering
attempts following the decoding in the cleanHTML() function.

A message with such an image tag in the body will trigger the JavaScript
and open a popup box if the browser supports “javascript:” attribute
values in image elements’ “src” attributes. This particular proof of
concept works with Internet Explorer 6, the newest Firefox will not
execute the JavaScript.

### Workaround

Users can disable the HTML message view in their configuration, so emails
are only displayed as plaintext.

### Fix

Upgrade to version 9.4.2.

### Security Risk

The risk of this vulnerability is estimated as high. Attackers have the
possibility to execute arbitrary JavaScript code in users’ browsers and
are thereby able to steal, for example, the users’ session IDs. Users
also cannot disallow JavaScript, as it is needed by the application
itself to work properly.

### History

* 2009-03-23 Vulnerabilities identified during a penetration test
* 2009-04-01 Meeting with customer and vendor
* 2009-04-28 CVE number assigned
* 2009-05-05 Vendor publishes fixed version
* 2009-05-05 Advisory released

### RedTeam Pentesting GmbH

RedTeam Pentesting offers individual penetration tests, short pentests,
performed by a team of specialised IT-security experts. Hereby, security
weaknesses in company networks or products are uncovered and can be
fixed immediately.

As there are only few experts in this field, RedTeam Pentesting wants to
share its knowledge and enhance the public knowledge with research in
security-related areas. The results are made available as public
security advisories.

More information about RedTeam Pentesting can be found at
<https://www.redteam-pentesting.de>.

# Contact us

We are happy to advise you and answer your questions.Contact dataPhone: +49 241 510081-0
Email: kontakt@redteam-pentesting.de
([GnuPG/PGP public key](/gpg/RedTeam-Pentesting-GPG-Kontakt-Key.asc))Visit and Postal AddressRedTeam Pentesting GmbH
Alter Posthof 1
52062 AachenEmployees of RedTeam Pentesting may be contacted directly at
firstname.lastname@redteam-pentesting.de:
([GnuPG/PGP public keys](/gpg/RedTeam-Pentesting-GPG-All-Keys.asc))Contact formâ![CAPTCHA]()
I agree to the transmission and processing of my data to RedTeam Pentesting according to RedTeam Pentesting’s [privacy policy](/en/imprint/privacy).
Company

* [About us](/en/redteam/)
* [History](/en/redteam/history/)
* [Press](/en/press/)
* [News Archive](/en/archive/)
Pentest

* [Definition](/en/pentest/)
* [Types of Tests](/en/pentest/types/)
* [Workflow](/en/pentest/workflow/)
* [FAQ](/en/faq/)
Publications

* [Overview](/en/publications/)
* [Advisories](/en/advisories/)
* [Talks](/en/talks/)
* [Other Publications](/en/publications-other/)
[Career](https://jobs.redteam-pentesting.de/)[Blog](https://blog.redteam-pentesting.de/)[Contact](#contactform)[Imprint](/en/imprint/) |
[Privacy Policy](/en/imprint/privacy/)

=== Content from www.redteam-pentesting.de_1d59b20b_20250125_210737.html ===
+49 241 510081-0kontakt@redteam-pentesting.de[DE](/de/advisories/rt-sa-2009-002/)[![RedTeam Pentesting Logo](/img/redteam-logo_hub5a66d245245ce30f53b50d2b4dfb31b_19123_120x0_resize_q100_h2_box_3.webp)](/)[DE](/de/advisories/rt-sa-2009-002/ "Deutsche Version")

* Company
  Company
  + [About us](/en/redteam/)
  + [History](/en/redteam/history/)
  + [Press](/en/press/)
  + [News Archive](/en/archive/)
* Pentest
  Pentest
  + [Definition](/en/pentest/)
  + [Types of Tests](/en/pentest/types/)
  + [Workflow](/en/pentest/workflow/)
  + [FAQ](/en/faq/)
* Publications
  Publications
  + [Overview](/en/publications/)
  + [Advisories](/en/advisories/)
  + [Talks](/en/talks/)
  + [Other Publications](/en/publications-other/)
* [Career](https://jobs.redteam-pentesting.de/)
* [Blog](https://blog.redteam-pentesting.de/)
* [Contact](#contactform)

Contact

Contact us

+49 241 510081-0kontakt@redteam-pentesting.de[Contact form](#contactform)JavaScript is not enabled in your browser. Please consider that some functions might not be available for you.![RedTeam Pentesting Header](/img/header/hl_header-1_hu0f2d230fb5185511a90e67c2e597c0b5_900546_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-2_hub774373357e916cb041b4943299d8717_1132770_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-3_hub8fc12cb70b2021e589c6810b4b53d04_895916_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-4_hu27d71f64bf1f030161a23c2dcd666f59_1015002_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-5_hud32f8d698ff23308f4d8b8566aae5928_933115_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-6_hu1bc03534cd122894ef676fff89833ac5_1144618_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-7_hu91e55bd77169043ae9e542f1b5f8f2f4_1354043_1000x0_resize_q100_h2_box.webp)![RedTeam Pentesting Header](/img/header/hl_header-8_hu155130647c165410f2ffa35227549138_1321813_1000x0_resize_q100_h2_box.webp)[newer](https://www.redteam-pentesting.de/en/advisories/rt-sa-2009-003/)[back to overview](/en/advisories)[older](https://www.redteam-pentesting.de/en/advisories/rt-sa-2009-001/)

[Text Version](/en/advisories/rt-sa-2009-002.txt)

## IceWarp WebMail Server: User-assisted Cross Site Scripting in RSS Feed Reader

During a penetration test, RedTeam Pentesting discovered that the
IceWarp WebMail Server is prone to user-assisted Cross Site Scripting
attacks in its RSS feed reader. If attackers control or compromise an
RSS feed users are subscribed to, they can run arbitrary JavaScript code
in the users’ browsers by embedding it within the feed.

### Details

* Product: IceWarp eMail Server / WebMail Server
* Affected Versions: 9.4.1
* Fixed Versions: 9.4.2
* Vulnerability Type: Cross Site Scripting
* Security Risk: medium
* Vendor URL: `http://www.icewarp.com/`
* Vendor Status: notified, fixed version released
* Advisory URL: `https://www.redteam-pentesting.de/advisories/rt-sa-2009-002`
* Advisory Status: published
* CVE: CVE-2009-1467
* CVE URL: `https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1467`

### Introduction

“Feature complete yet easy to use, WebMail Server Pro provides feature
rich Web 2.0 web-based access to email, calendars, contacts, files and
shared data from any computer with browser and internet connection,
without the usual configuration hassle. Thanks to advanced technologies
and application-like look and feel, Pro suggests it was born to become
the ultimate replacement of Outlook and similar desktop mail clients.”

(from the vendor’s homepage)

### More Details

Users of the IceWarp WebMail Server can add RSS feeds as folders to
their folder list. The parsing of such feeds is done in the PHP file

`html/webmail/server/inc/rss/rss.php`

The individual items of an RSS channel are handled in

`html/webmail/server/inc/rss/item.php`

In the function getHTML(), the final HTML page for an item is assembled
and returned. The “title” and “description” keys correspond to the
<title> and <description> elements in the feed, the “href” key to the
<link> element:

```
159   public function getHTML(&$aItem)
160   {
161       $aHTML['title'] = $this->subject;
162       $aHTML['href'] = $this->to;
163       $aHTML['description'] = Tools::cleanHTML($this->body,$base);
164
165       $aURL = parse_url($this->to);
166       $aItem['base'] = $aURL['host'];
167
168       @$sHTML = htmlspecialchars(
                        template('inc/templates/rss.tpl',$aHTML)
                    );
169
170       return $sHTML;
171   }

```

Only the description gets sanitised by the cleanHTML() function, “title”
and “href” are embedded unmodified into the final HTML page.

This means that HTML or JavaScript code embedded in an item’s <title> or
<link> element of an RSS feed users are subscribed to will be executed
as soon as they click on the item to display it. HTML and JavaScript
code within the <description> element of an item is sanitised, but the
sanitisation can be bypassed in the same way as described in RedTeam
Pentesting’s advisory [IceWarp WebMail Server: Cross
Site Scripting in Email View](../rt-sa-2009-001).

Attackers have two options for exploiting this vulnerability: First,
they can embed malicious code in a feed they control and convince users
to subscribe to this feed. Second, they can change RSS feeds the users
are already subscribed to by exploiting vulnerabilities in the systems
providing these feeds.

### Proof of Concept

The following RSS feed contains JavaScript code in the <title> and
<description> elements that displays a message containing the user’s
session ID. This code gets executed when users click on the item to view
it:

```
<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
<channel>
    <title>RedTeam Pentesting</title>
    <link
      href="https://www.redteam-pentesting.de"
      rel="self"
      type="application/rss+xml" />
    <link>https://www.redteam-pentesting.de</link>
    <description>Seeing your network from the attacker's perspective</description>
    <pubDate>Mon, 16 Apr 2009 05:23:42 +0000</pubDate>
    <language>de</language>
    <item>
      <title>&lt;script&gt;alert('Title: Your session id is: ' + window.top.sSID);&lt;/script&gt;</title>
      <link>https://www.redteam-pentesting.de/pentest</link>
      <pubDate>Mon, 16 Apr 2009 05:23:42 +0000</pubDate>
      <description>
        &lt;div o&lt;xml&gt;nmouseover=&quot;alert('Description: Your session id is: ' + window.top.sSID)&quot;&gt;
          RedTeam Pentesting XSS
        &lt;/div&gt;
      </description>
    </item>
  </channel>
</rss>

```
### Workaround

None.

### Fix

Upgrade to version 9.4.2.

### Security Risk

Attackers who can inject JavaScript code into RSS feeds that users are
subscribed to, or who can get users to subscribe to such RSS feeds, can
execute any JavaScript code on the users’ behalf. This will let them
control the web application on a victim user’s behalf and access any
information accessible to that user, for example emails and files. It
can also be used to to steal the users’ sessions and hijack their
accounts. Therefore the risk is estimated as medium.

### History

* 2009-03-23 Vulnerabilities identified during a penetration test
* 2009-04-01 Meeting with customer and vendor
* 2009-04-28 CVE number assigned
* 2009-05-05 Vendor publishes fixed version
* 2009-05-05 Advisory released

### RedTeam Pentesting GmbH

RedTeam Pentesting offers individual penetration tests, short pentests,
performed by a team of specialised IT-security experts. Hereby, security
weaknesses in company networks or products are uncovered and can be
fixed immediately.

As there are only few experts in this field, RedTeam Pentesting wants to
share its knowledge and enhance the public knowledge with research in
security-related areas. The results are made available as public
security advisories.

More information about RedTeam Pentesting can be found at
<https://www.redteam-pentesting.de>.

# Contact us

We are happy to advise you and answer your questions.Contact dataPhone: +49 241 510081-0
Email: kontakt@redteam-pentesting.de
([GnuPG/PGP public key](/gpg/RedTeam-Pentesting-GPG-Kontakt-Key.asc))Visit and Postal AddressRedTeam Pentesting GmbH
Alter Posthof 1
52062 AachenEmployees of RedTeam Pentesting may be contacted directly at
firstname.lastname@redteam-pentesting.de:
([GnuPG/PGP public keys](/gpg/RedTeam-Pentesting-GPG-All-Keys.asc))Contact formâ![CAPTCHA]()
I agree to the transmission and processing of my data to RedTeam Pentesting according to RedTeam Pentesting’s [privacy policy](/en/imprint/privacy).
Company

* [About us](/en/redteam/)
* [History](/en/redteam/history/)
* [Press](/en/press/)
* [News Archive](/en/archive/)
Pentest

* [Definition](/en/pentest/)
* [Types of Tests](/en/pentest/types/)
* [Workflow](/en/pentest/workflow/)
* [FAQ](/en/faq/)
Publications

* [Overview](/en/publications/)
* [Advisories](/en/advisories/)
* [Talks](/en/talks/)
* [Other Publications](/en/publications-other/)
[Career](https://jobs.redteam-pentesting.de/)[Blog](https://blog.redteam-pentesting.de/)[Contact](#contactform)[Imprint](/en/imprint/) |
[Privacy Policy](/en/imprint/privacy/)
