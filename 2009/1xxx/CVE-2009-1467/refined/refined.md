The provided content relates to CVE-2009-1467.

**Root cause of vulnerability:**
The IceWarp WebMail Server's HTML filtering function (`cleanHTML()`) in `html/webmail/server/inc/tools.php` can be circumvented to allow Cross-Site Scripting (XSS) attacks. The vulnerability is present both in email view and in the RSS feed reader.

**Weaknesses/vulnerabilities present:**
1.  **Insufficient HTML Filtering:** The `cleanHTML()` function attempts to remove or alter potentially malicious HTML and JavaScript code. However, it can be bypassed in multiple ways:
    *   **Tag Removal Circumvention:** By inserting an HTML tag (that is subsequently removed by the filter) between keywords that are subject to filtering, the filter can be bypassed, rendering the keywords valid after the tag is removed.
    *   **Double Hex Encoding:** By double-encoding HTML entities, the filter fails to recognize the malicious code after the first decoding. The browser decodes the entities to the original malicious code.
2.  **Unsanitized RSS Feed Elements:** The `title` and `href` elements of RSS feed items are embedded directly into the final HTML page without sanitization. This allows malicious code within these elements to be executed by a user when the item is displayed.

**Impact of exploitation:**
An attacker can inject arbitrary JavaScript code into the victim's browser. This can lead to:
* Stealing user session IDs
* Hijacking user accounts
* Accessing user emails and files
* Full control of the web application on a victim's behalf

**Attack vectors:**
1.  **Email XSS:**
    * An attacker sends a specially crafted email containing malicious JavaScript code. The vulnerabilities in `cleanHTML()` allows the execution of this code when the user views the email.
2.  **RSS Feed XSS:**
    * An attacker embeds malicious JavaScript code in the title or link elements of an RSS feed, or circumvents sanitization of the description element. This code is executed when a user views the RSS item. This can be achieved by either:
        *   Compromising an existing feed the user is already subscribed to.
        *   Convincing a user to subscribe to a malicious feed.

**Required attacker capabilities/position:**
*   **Email XSS:** Ability to send emails to the target.
*   **RSS Feed XSS:** Ability to control or compromise an RSS feed that the user is subscribed to, or the ability to convince a user to subscribe to a controlled feed.