- **Root cause of vulnerability**: The Profense Web Application Firewall, when configured in positive model (whitelist), can be bypassed due to improper handling of URL-encoded newline characters. The pattern matching in multi-line mode matches non-hostile lines, incorrectly marking the entire request as legitimate, thus bypassing the whitelist.
- **Weaknesses/vulnerabilities present**: Improper input validation, specifically regarding newline characters in the context of a positive security model. The application fails to correctly interpret and sanitize requests containing URL-encoded newline characters, which are then able to bypass the whitelist rules.
- **Impact of exploitation**: Successful exploitation allows an attacker to bypass the positive security model and launch various attacks, including Cross-Site Scripting (XSS), SQL Injection, and remote command execution.
- **Attack vectors**: The attack vector is through HTTP requests containing a URL-encoded newline character (%0A). The attacker injects malicious code within the request, which is passed through due to the bypass.
- **Required attacker capabilities/position**: The attacker needs the ability to send HTTP requests to a web application protected by a vulnerable version of Profense. They don't require any special privileges other than being able to send HTTP requests. They also need knowledge of the bypass technique, which can be as simple as inserting a '%0A' in the request.