=== Content from foswiki.org_4feaae9e_20250125_011024.html ===


| [Powered by Foswiki, The Free and Open Source Wiki](http://foswiki.org/Home/WebHome) |  | * Default Български 简体中文 正體中文 Čeština Dansk Nederlands English Suomi Français Deutsch Italiano 日本語 한글 Ελληνικά Norsk Polski Português Português brasileiro Русский Español Svenska Türkçe Українська |
| --- | --- | --- |

* [About](http://foswiki.org/About/WebHome)
* [Blog](http://blog.foswiki.org)
* [Extensions](http://foswiki.org/Extensions/WebHome)
* [Documentation](http://foswiki.org/System/WebHome)
* [Community](http://foswiki.org/Community/WebHome)
* [Development](http://foswiki.org/Development/WebHome)
* [Tasks](http://foswiki.org/Tasks/WebHome)
* [Download](http://foswiki.org/Download/FoswikiRelease02x01x09)
* [Support](http://foswiki.org/Support/WebHome)
* [Sandbox](http://foswiki.org/Sandbox/WebHome)

You are here: [Foswiki](/)>[Support Web](/Support/WebHome)>[SecurityAlert-CVE-2009-1434](/Support/SecurityAlert-CVE-2009-1434 "Topic revision: 19 (11 Feb 2012 - 14:48:29)") (11 Feb 2012, [PaulHarvey](/Main/PaulHarvey))[Log In](/bin/login?foswiki_origin=GET%2cview%2c/Support/SecurityAlert-CVE-2009-1434)[Register](/System/UserRegistration)  [![txt](/pub/System/DocumentGraphics/txt.png) plain text](/Support/SecurityAlert-CVE-2009-1434?skin=plain;template=SecurityAlertTextView)
# Security Alert: Foswiki Page View Cross-Site Request Forgery (CSRF)

 ![IDEA!](/pub/System/DocumentGraphics/tip.png "IDEA!") ***Get Alerted:*** *to get immediate alerts* of high priority security issues, please join the low-volume `foswiki-announce` list - details at [Mailing Lists](/Community/MailingLists) This advisory alerts you of a potential Cross-Site Request Forgery security issue with your Foswiki installation via HTTP GET requests, thereby allowing an attack to occur by simply viewing a web page that takes advantage of the exploit. This web page can be served by any web site, including the one hosting the Foswiki installation.![HELP](/pub/System/DocumentGraphics/help.png "HELP") Note: This advisory has been updated with new countermeasures (22 Jun 2009).

* [Severity Level](#Severity_Level)
* [MITRE Name for this Vulnerability](#MITRE_Name_for_this_Vulnerability)
* [Vulnerable Software Versions](#Vulnerable_Software_Versions)
## Severity Level

Severity 3 issue: Foswiki content or browser is compromisedThe severity level was assigned by the Foswiki [SecurityTaskTeam](/Community/SecurityTaskTeam) as documented in [SecurityAlertProcess](/Development/SecurityAlertProcess)
## MITRE Name for this Vulnerability

The Common Vulnerabilities and Exposures project has assigned the name [CVE-2009-1434](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1434) to this vulnerability.
## Vulnerable Software Versions

* [Foswiki 1.0.0](/Download/FoswikiRelease01x00x00), [Foswiki 1.0.1](/Download/FoswikiRelease01x00x01), [Foswiki 1.0.2](/Download/FoswikiRelease01x00x02), [Foswiki 1.0.3](/Download/FoswikiRelease01x00x03), [Foswiki 1.0.4](/Download/FoswikiRelease01x00x04)

Fixed in [Foswiki 1.0.6](/Download/FoswikiRelease01x00x06)[Foswiki versions 1.0.5](/Download/FoswikiRelease01x00x05) is protected against the most basic CSRF attacks where simple HTML tags can alter content.[Foswiki versions 1.0.6](/Download/FoswikiRelease01x00x06) and later contain a major security enhancement, protecting against Cross-Site Request Forgery. The extra safe "double submit" algorithm, as recommended by the [Open Web Application Security Project (OWASP)](http://www.owasp.org) project has been used.
## Attack Vectors

Prior to version 1.0.5, Foswiki allows HTTP GET requests to modify pages, allowing for [Cross-Site Request Forgery attacks](http://en.wikipedia.org/wiki/Cross-site_request_forgery) to occur by simply viewing a malicious page that uses this exploit. As with all cross-site request forgery attacks, the user viewing the malicious page must be already logged into the Foswiki installation in order for the attack to succeed. The Foswiki installation itself can be used to host the attack code, which increases the chance that the potential victim is already logged in.Any HTML tag that triggers a browser to automatically access an URL can be crafted and added to a malicious page that will update a Foswiki web site with the content specified in the URL, using the identity of the user viewing the page. Examples of HTML tags that can be used for this exploit include <img>, <script>, <iframe>, and <obj> tags. An <a> element can also be used, though the user must follow the link in order for the attack to occur.
## Impact

Using this vulnerability, an exploit can perform any operation while assuming the identity of the victim. This includes changing access permissions to Foswiki pages, or modifying the definition of access groups, including the Foswiki AdminGroup. Lower-privileged Foswiki users can insert the attack into a commonly visited page and thus elevate their access to that of the users visiting the page. The attack is transparent to victims (the victim's browser may display indications that it is accessing the network for an unexpected period of time).
## Details

The exploit takes advantage of Foswiki allowing data to be saved/modified by a browser sending an HTTP GET request, which includes accesses via an <img>, <script>, <iframe>, <obj>, or <a> element.
### Examples

#### Edit a topic using an image tag

```

<img src="/bin/save/Sandbox/TestTopic?text=Evil text" alt="" />

```
#### Edit user configuration using an image tag:

```

<img src="/bin/save/Main/WikiGuest?text=3y3%2520have%2520been%25200wn3d%2520by
%2520ashcrow%250A%250a---%252B%252B%2520Related%2520Topics%250A%250A%2520%2520%2520
%252A%2520Set%2520ALLOWTOPICCHANGE%2520=%2520Main.WikiGuest%252C%2520%
USERSWEB%.WikiUsers" alt="" />

```
#### Modify table cell

Note that the `view` operation can be attacked as well, as some extensions save data when `view` operations are performed. For example, EditTablePlugin can be exploited to alter the contents of a table cell:
```

<img src="/bin/viewauth/Myweb/TopicWithEditTable?ettablenr=1;
etcell2x2=New_value;etrows=5;etsave=Save%20table" alt="" />

```
#### Edit a topic using a hypertext link

Simple HTML anchor tags can be used to save data. Unless users inspect a target URL before following the link, they will not be aware that data will be modified by following the link, using their identity.
```

<a href="http://some.foswiki.site/bin/save/Myweb/TargetTopic?text=TheTextWeWantSaved">
Innocent looking text</a>

```
### Resolution in 1.0.5

To prevent Foswiki sites from being vulnerable to silent attacks using image tags or other tags that cause the browser to initiate HTTP GET requests, and attacks by following hypertext links, the Foswiki team has restricted the ability to save data to HTTP POST requests. The Foswiki core and all extensions that are bundled with the basic Foswiki distribution have been altered so that no data can be saved unless the change is submitted using an HTTP POST request (typically via an HTTP form).This affects any Foswiki applications that depended on using the GET method to modify data. Examples of applications that may need to be modified include the following:

* If you have implemented an application that creates new topics or changes existing topics using an HTML form, you must explicitly specify `method="post"` in the attributes for the form. Note the default value for the method attribute is `get`, so if no method attribute is specified, then the form will be unable to modify data.

* If you have implemented an application that generates links to the Foswiki `save` or `view` scripts, you will need to alter this application to instead display HTML forms with a submit button.

### Further security enhancements in 1.0.6

[Foswiki versions 1.0.6](/Download/FoswikiRelease01x00x06) and later contain a major security enhancement, protecting against Cross-Site Request Forgery using HTTP POST requests. The extra safe "double submit" algorithm, as recommended by the [Open Web Application Security Project (OWASP)](http://www.owasp.org) project has been used. This is the same algorithm used by several major banks and other security-conscious institutions, and requires that users have Javascript enabled.
## Countermeasures

To protect your Foswiki installation, upgrade to the latest production [release 1.0.6](/Download/FoswikiRelease01x00x06) or later.Releaes 1.0.6 is available as an upgrade package that can be applied to a Foswiki installation running any version from 1.0.0 to 1.0.5.
## Authors and Credits

* Steve 'Ashcrow' Milner and Richard Monk of Red Hat Infosec Team for disclosing the issue
* [CrawfordCurrie](/Main/CrawfordCurrie) and [KennethLavrsen](/Main/KennethLavrsen) for contributing to the fix, the 1.0.5 and 1.0.6 releases and advisory
* Members of the Foswiki security team for discussions and ideas, for testing the 1.0.5 beta, for testing the new 1.0.6 "double submit" code and for editing this security advice

## Action Plan with Timeline

| # | Action | Date/ Deadline | Status | Who |
| --- | --- | --- | --- | --- |
| 1. | User discloses issue to foswiki security mailing list | 2009-04-15 | Done | Steve 'Ashcrow' Milner (Red Hat) |
| 2. | Developer verifies issue | 2009-04-16 | Done | Crawford Currie |
| 3. | Security team triage the issue | 2009-04-16 | Done | Kenneth Lavrsen |
| 4. | Developer fixes code | 2009-04-16 | Done | Crawford Currie and Kenneth Lavrsen |
| 5. | Security team creates advisory with hotfix | 2009-04-26 | Done | Kenneth Lavrsen |
| 6. | Release Manager builds patch release | 2009-04-25 | Done | Kenneth Lavrsen |
| 7. | Send alert to foswiki-announce and foswiki-discuss mailing lists | 2009-04-27 | Done | Kenneth Lavrsen |
| 8. | Publish advisory in Support web and update all related topics | 2009-04-29 | Done | Kenneth Lavrsen |
| 9. | Reference to public advisory on Download page and Known Issues | 2009-04-29 | Done | Kenneth Lavrsen |
| 10. | Issue a public security advisory (vuln@secunia.com, cert@cert.org, bugs@securitytracker.com, full-disclosure@lists.netsys.com, vulnwatch@vulnwatch.org) | 2009-04-29 | Done | Kenneth Lavrsen |
| 11. | Develop a secure token / double submit CSRF countermeasure feature to be released in next regular patch release | 2009-06-19 | Done | Crawford Currie |
| 12. | Release 1.0.6 which includes the enhanced CSRF countermeasure feature | 2009-06-21 | Done | Kenneth Lavrsen |
| 13. | Add the information about the additional countermeasures in 1.0.6 to the security advisory | 2009-06-22 | Done | Kenneth Lavrsen |
| 14. | Send a notification about the update to the CVE to the same recipients that received the original advisory | 2009-06-22 | Done | Kenneth Lavrsen |

* Set ALLOWTOPICCHANGE = [SecurityGroup](/Main/SecurityGroup), [IsaacLin](/Main/IsaacLin)

## Attachments ($count)

Show options
**Search:**

**Sort by:**
Name
Date
Author
Size
Type

**Results per page:**
6
12
24
48
all

**Display hidden:**

| More actions Create link(s) Embed Download Hide Unhide Move Delete | 0 attachment(s) |
| --- | --- |

Select all
Clear all

Topic revision: r19 - 11 Feb 2012, [PaulHarvey](/Main/PaulHarvey)

[Support](/Support/WebHome)

## Quick Links

* [Support questions](/Support/SupportQuestions)
* [FAQ's](/Support/FAQ)
* [Tips](/Support/BestPracticeTips)
* [Extensions support](/Support/Extensions)
* [Supplemental documents](/Support/SupplementalDocuments)
* [Wiki consultants](/Support/WikiConsultants)

## Tools

* [![newtopic](/pub/System/DocumentGraphics/newtopic.png) Create New Topic](/Support/WebCreateNewTopic?topicparent=SecurityAlert-CVE-2009-1434)
* [![index](/pub/System/DocumentGraphics/index.png) Index](/Support/WebTopicList)
* [![searchtopic](/pub/System/DocumentGraphics/searchtopic.png) Search](/Support/WebSearch)
* [![changes](/pub/System/DocumentGraphics/changes.png) Changes](/Support/WebChanges)
* [![notify](/pub/System/DocumentGraphics/notify.png) Notifications](/Support/WebNotify)
* [![feed](/pub/System/DocumentGraphics/feed.png) RSS Feed](/Support/WebRss)
* [![statistics](/pub/System/DocumentGraphics/statistics.png) Statistics](/Support/WebStatistics)
* [![wrench](/pub/System/DocumentGraphics/wrench.png) Preferences](/Support/WebPreferences)

The copyright of the content on this website is held by the contributing authors, except where stated elsewhere. See [Copyright Statement](/Community/CopyrightStatement). [![Creative Commons License](https://foswiki.org/pub/System/SiteGraphics/cc-by-sa-3.0-88x31.png)](http://creativecommons.org/licenses/by-sa/3.0/)    [Legal Imprint](/About/LegalImprint)    [Privacy Policy](/Community/PrivacyPolicy)



=== Content from launchpad.net_5f76283a_20250126_045908.html ===

[Log in / Register](https://launchpad.net/bugs/cve/2009-1434/%2Blogin)

![](/@@/launchpad-logo)

## Launchpad.net

* [Launchpad Home](https://launchpad.net/)
* [Code](https://code.launchpad.net/)
* [Bugs](https://bugs.launchpad.net/)
* [Blueprints](https://blueprints.launchpad.net/)
* [Translations](https://translations.launchpad.net/)
* [Answers](https://answers.launchpad.net/)

[Launchpad CVE tracker](/bugs/cve)
# CVE 2009-1434

Cross-site request forgery (CSRF) vulnerability in Foswiki before 1.0.5 allows remote attackers to hijack the authentication of arbitrary users for requests that modify pages, change permissions, or change group memberships, as demonstrated by a URL for a (1) save or (2) view script in the SRC attribute of an IMG element, a related issue to CVE-2009-1339.

See the ![](/@@/link)
[CVE page on Mitre.org](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2009-1434)
for more details.

## Related bugs

*No related bugs.*

* [Link to bug](%2Blinkbug)
* [Remove bug link](%2Bunlinkbug)

## References

* CONFIRM:
  [http://foswiki.org/Sup...](http://foswiki.org/Support/SecurityAlert-CVE-2009-1434)
* CONFIRM:
  [https://launchpad.net/...](https://launchpad.net/bugs/cve/2009-1434)
* SECUNIA:
  [34863](http://secunia.com/advisories/34863)
* OSVDB:
  [54148](http://osvdb.org/54148)
* MLIST:
  [[foswiki-announce] 200...](http://sourceforge.net/mailarchive/forum.php?thread_name=49F61C4E.2040806%40lavrsen.dk&amp;forum_name=foswiki-announce)
* XF:
  [foswiki-unspecified-cs...](https://exchange.xforce.ibmcloud.com/vulnerabilities/50256)

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_389ce8f4_20250126_045908.html ===

[Log in / Register](https://launchpad.net/%2Blogin)

![Launchpad logo and name](/@@/launchpad-logo-and-name.svg)

---

Search

Search

**47,168** projects,
**2,043,835** bugs,
**1,009,617** branches,
**86,958** Git repositories,
**3,149,475** translations,
**817,744** answers,
**76,153** blueprints,
and counting...

## Launchpad

#### A software collaboration platform that provides

#### [Bug tracking](https://bugs.launchpad.net/)

One place to track bugs across project boundaries and tools

#### [Code hosting](https://code.launchpad.net/) using [Git](https://git-scm.com/) and [Bazaar](http://bazaar.canonical.com/)

Easy for anyone to get your project's code using Git or Bazaar

#### [Code reviews](https://help.launchpad.net/Code/Review)

Full control of who can land code in your project remains with you

#### [Ubuntu package building and hosting](https://launchpad.net/ubuntu)

Publishing your software is simple with Personal Package Archives

#### [Crowd source translations](https://translations.launchpad.net/)

Build an open community to translate your software into almost any language

#### [Mailing lists](https://help.launchpad.net/Teams/MailingLists)

Find and work with the right people by building a social network of individuals and teams around projects

#### [Answer tracking and FAQs](https://answers.launchpad.net/)

Free software thrives on people helping each other when the unexpected happens

#### [Specification tracking](https://blueprints.launchpad.net/)

Track ideas and chunks of work as “blueprints”

## Get started

Learn more about Launchpad in the
[user guide](https://help.launchpad.net/).

If you're ready, you can:

* ![add](/@@/add-homepage.png)
  #### [Create an account](/%2Blogin)
* ![tour](/@@/tour-homepage.png)
  #### [Take the tour](/%2Btour)
* ![question](/@@/question-homepage.png)
  #### [Find answers](https://answers.launchpad.net/)

## Featured projects

* ![Beautiful Soup](/@@/product-logo)
  #### [Beautiful Soup](/beautifulsoup)

  A program designed for screen-scraping HTML. The discussion group is at: http://groups.google.com...
* ![Breezy](/@@/product-logo)
  #### [Breezy](/brz)

  Breezy is a friendly powerful distributed version control system.
* ![Inkscape](https://launchpadlibrarian.net/66795469/ink-lp-logo.png)
  #### [Inkscape](/inkscape)

  Inkscape is an SVG-based graphics editor featuring alpha
  blending, node editing, SVG to PNG exp...
* ![Launchpad itself](https://launchpadlibrarian.net/600817174/Canonical_Launchpad_icon_64px.png)
  #### [Launchpad itself](/launchpad)

  Launchpad is a set of Web services to help software developers collaborate.
* ![OpenMW](/@@/product-logo)
  #### [OpenMW](/openmw)

  OpenMW is an attempt to reimplement the popular role playing game Morrowind. It aims to be a full...
* ![OpenShot Video Editor](https://launchpadlibrarian.net/250357498/OpenShot-2-Logo.png)
  #### [OpenShot Video Editor](/openshot)

  OpenShot Video Editor is a free, open-source, non-linear video editor. It can create and edit vid...
* ![OpenStack](https://launchpadlibrarian.net/52042558/os64.png)
  #### [OpenStack](/openstack)

  The OpenStack Open Source Cloud Mission: to produce the ubiquitous Open Source Cloud Computing pl...
* ![txpkgupload](/@@/product-logo)
  #### [txpkgupload](/txpkgupload)

  Package upload server used by Launchpad.
* ![Ubuntu](https://launchpadlibrarian.net/606381979/CoF%2064px.png)
  #### [Ubuntu](/ubuntu)

  Ubuntu is a complete Linux-based operating system, freely available with both community and profe...

* **[Browse all
  47168
  projects](/projects)!**

## Recent Launchpad blog posts

[Read the blog](http://blog.launchpad.net)

* [Introducing Launchpad Bug Templates](https://blog.launchpad.net/general/introducing-launchpad-bug-templates)
  – 03 Dec 2024

  The new feature bug templates in Launchpad aims to streamline the bug reporting process, making it more efficient for both users and project maintainers. In the past, Launchpad provided only a basic description field for filling bug reports. This often led to incomplete or vague submissions, as users may not include essential details or steps […]
* [Launchpad’s new homepage](https://blog.launchpad.net/general/launchpads-new-homepage)
  – 01 Mar 2024

  Launchpad’s new homepage Launchpad has been around for a while, and its frontpage has remained untouched for a few years now. If you go into launchpad.net, you’ll notice it looks quite different from what it has looked like for the past 10 years – it has been updated! The goal was to modernize it while […]
* [Launchpad-linked federated Matrix accounts](https://blog.launchpad.net/general/launchpad-verified-federated-matrix-accounts)
  – 22 Jan 2024

  Users can now add their Matrix accounts to their profile in Launchpad, as requested by Canonical’s Community team. We also took the chance to slightly rework the frontend and how we display social accounts in the user profiles. Instead of having different sections in the profile for each social account , all social accounts are […]
* [Self-service riscv64 builds](https://blog.launchpad.net/ppa/self-service-riscv64-builds)
  – 22 Nov 2023

  Launchpad has supported building for riscv64 for a while, since it was a requirement to get Ubuntu’s riscv64 port going. We don’t actually have riscv64 hardware in our datacentre, since we’d need server-class hardware with the hypervisor extension and that’s still in its infancy; instead, we do full-system emulation of riscv64 on beefy amd64 hardware […]
* [Introducing Project-Scoped Access Tokens](https://blog.launchpad.net/general/introducing-project-scoped-access-tokens)
  – 20 Nov 2023

  Access tokens can be used to access repositories on behalf of someone. They have scope limitations, optional expiry dates, and can be revoked at any time. They are a stricter and safer alternative to using real user authentication when needing to automate pushing and/or pulling from your git repositories. This is a concept that has […]
* [New domain names for PPAs](https://blog.launchpad.net/ppa/new-domain-names-for-ppas)
  – 16 Feb 2022

  Since they were introduced in 2007, Launchpad’s Personal Package Archives (PPAs) have always been hosted on ppa.launchpad.net. This has generally worked well, but one significant snag became clear later on: it was difficult to add HTTPS support for PPAs due to the way that cookies work on the web. Launchpad uses a cookie for your […]

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))


