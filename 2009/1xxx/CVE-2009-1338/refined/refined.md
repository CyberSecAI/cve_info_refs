```
{
  "CVE-2009-1338": {
    "related": true,
    "summary": "The Linux kernel's signal handling did not correctly limit signals to process namespaces. A local user could bypass namespace restrictions, possibly leading to a denial of service by sending signals to arbitrary processes outside the current namespace.",
    "details": [
      {
        "type": "Root cause",
        "content": "The vulnerability was caused by the `kill()` system call not properly checking if the target process was within the caller's PID namespace before sending a signal. Specifically, when `kill()` was called with a PID of -1, it attempted to send the signal to all processes, including those in different namespaces. The kernel failed to use `task_pid_vnr()` to ensure that the process was within the caller's namespace before killing."
      },
      {
        "type": "Weaknesses",
        "content": "The main weakness is incorrect access control in the `kill()` system call and the failure to check namespace boundaries for signal delivery."
      },
       {
        "type": "Impact",
        "content": "A local user could send signals to arbitrary processes, including those in other namespaces, potentially leading to a denial of service by terminating or otherwise disrupting these processes and breaking the isolation of namespaces."
      },
      {
        "type": "Attack vectors",
        "content": "The attack vector is a local user using the `kill()` system call with a PID of -1 (`kill <sig> -1`)."
      },
      {
        "type": "Required attacker capabilities",
        "content": "The attacker needs to have local access to the system and the ability to execute the `kill()` system call."
      },
      {
        "type": "Additional Details",
         "content": "The issue affects kernels with PID namespaces merged in, which was introduced in Linux kernel 2.6.24. The fix involves using `task_pid_vnr()` to check if the process is outside of the caller's namespace before sending the signal. Commit `d25141a8` addressed part of the problem, but a follow-up commit `44c4e1b2` was also required to fully fix it. An initial incorrect check (`task_pid_vnr() > 1`) was used, and the fix also corrects an error with `task_pid_vnr()` returning 0 for processes outside the namespace."
      }
    ]
  }
}
```