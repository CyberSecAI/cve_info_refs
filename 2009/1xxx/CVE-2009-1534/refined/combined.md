=== Content from www.us-cert.gov_cb9cd099_20250125_042858.html ===

[Skip to main content](#main)

![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)

An official website of the United States government

Here’s how you know

Here’s how you know

![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)

**Official websites use .gov**

 A **.gov** website belongs to an official government organization in the United States.

![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)

**Secure .gov websites use HTTPS**

 A **lock** (LockA locked padlock) or **https://** means you’ve safely connected to the .gov website. Share sensitive information only on official, secure websites.

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

[![Cybersecurity & Infrastructure Security Agency logo America’s Cyber Security Defense Agency National Coordinator For Critical Infrastructure Security and Resilience](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)

[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)

Search

Menu

![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)

Close

* Topics

  [Topics](/topics)

  [Cybersecurity Best Practices](/topics/cybersecurity-best-practices)

  [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)

  [Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)

  [Election Security](/topics/election-security)

  [Emergency Communications](/topics/emergency-communications)

  [Industrial Control Systems](/topics/industrial-control-systems)

  [Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)

  [Partnerships and Collaboration](/topics/partnerships-and-collaboration)

  [Physical Security](/topics/physical-security)

  [Risk Management](/topics/risk-management)

   [How can we help?](/audiences)
  [Government](/topics/government)[Educational Institutions](/topics/educational-institutions)[Industry](/topics/industry)[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial)[Individuals and Families](/topics/individuals-and-families)[Small and Medium Businesses](/topics/small-and-medium-businesses)[Find Help Locally](/audiences/find-help-locally)[Faith-Based Community](/audiences/faith-based-community)[Executives](/audiences/executives)[High-Risk Communities](/audiences/high-risk-communities)
* [Spotlight](/spotlight)
* Resources & Tools

  [Resources & Tools](/resources-tools)

  [All Resources & Tools](/resources-tools/all-resources-tools)

  [Services](/resources-tools/services)

  [Programs](/resources-tools/programs)

  [Resources](/resources-tools/resources)

  [Training](/resources-tools/training)

  [Groups](/resources-tools/groups)
* News & Events

  [News & Events](/news-events)

  [News](/news-events/news)

  [Events](/news-events/events)

  [Cybersecurity Alerts & Advisories](/news-events/cybersecurity-advisories)

  [Directives](/news-events/directives)

  [Request a CISA Speaker](/news-events/request-speaker)

  [Congressional Testimony](/news-events/congressional-testimony)

  [CISA Conferences](/cisa-conferences)

  [CISA Live!](/cisa-live)
* Careers

  [Careers](/careers)

  [Benefits & Perks](/careers/benefits-perks)

  [HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)

  [Hiring](/general-recruitment-and-hiring-faqs)

  [Resume & Application Tips](/careers/resume-application-tips)

  [Students & Recent Graduates](/students-recent-graduates-employment-opportunities)

  [Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)

  [Work @ CISA](/careers/work-cisa)
* About

  [About](/about)

  [Divisions & Offices](/about/divisions-offices)

  [Regions](/about/regions)

  [Leadership](/about/leadership)

  [Doing Business with CISA](/doing-business-cisa)

  [Site Links](/site-links)

  [Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)

  [CISA GitHub](/cisa-github)

  [CISA Central](/cisa-central)

  [2024 Year In Review](/about/2024YIR)

  [Contact Us](/about/contact-us)

  [Equal Employment Opportunity](/eeo)

  [Subscribe](/about/contact-us/subscribe-updates-cisa)

  [Reasonable Accommodations & Accessibility](/rap)

  [Special Emphasis Programs](/sep)

  [No FEAR Act Notice & Reports](/no-fear-act)

  [Policies & Plans](/eeo-policies)

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

Breadcrumb

1. [Home](/)
2. [News & Events](/news-events)
3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)
4. [Alert](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A93)

Share:

Alert
# Microsoft Updates for Multiple Vulnerabilities

Last RevisedJanuary 24, 2013
Alert CodeTA09-223A

### Systems Affected

* Microsoft Windows and Windows Server
* Microsoft Office
* Remote Desktop Connection Client for Mac 2.0

### Overview

Microsoft has released updates to address vulnerabilities in Microsoft Windows, Windows Server, Office Web Components and Remote Desktop Connection for Mac.

Microsoft has released multiple security bulletins for critical vulnerabilities in Windows, Windows Server, Office Web Components, and Remote Desktop Connection for Mac. These bulletins are described in the [Microsoft Security Bulletin Summary for August 2009](http://www.microsoft.com/technet/security/bulletin/ms09-aug.mspx).

Microsoft Security Bulletin [MS09-037](http://www.microsoft.com/technet/security/bulletin/MS09-037.mspx) includes updates for Microsoft components to address vulnerabilities in the Active Template Library ([ATL](http://msdn.microsoft.com/en-us/library/3ax346b7%28VS.71%29.aspx)). Vulnerabilities present in the ATL can cause vulnerabilities in the resulting ActiveX controls and COM components. Any ActiveX control or COM component that was created with a vulnerable version of the ATL may be vulnerable, including ones distributed by third-party developers.

Developers should update the ATL as described in the previously released Microsoft Security Bulletin [MS09-035](http://www.microsoft.com/technet/security/bulletin/ms09-035.mspx) in order to stop creating vulnerable controls. To address vulnerabilities in existing controls, recompile the controls using the updated ATL. Further discussion about the ATL vulnerabilities can be found in the [Microsoft Security Advisory 973882](http://www.microsoft.com/technet/security/advisory/973882.mspx).

### Impact

An attacker may be able to execute arbitrary code, in some cases without user interaction.

### Solution

**Apply updates from Microsoft**

Microsoft has provided updates for these vulnerabilities in the [Microsoft Security Bulletin Summary for August 2009](http://www.microsoft.com/technet/security/bulletin/ms09-aug.mspx). The security bulletin describes any known issues related to the updates. Administrators are encouraged to note these issues and test for any potentially adverse effects. Administrators should consider using an automated update distribution system such as [Windows Server Update Services](http://www.microsoft.com/windowsserversystem/updateservices/default.mspx) (WSUS).

### References

[Microsoft Security Bulletin Summary for August 2009](http://www.microsoft.com/technet/security/bulletin/ms09-aug.mspx)
[Microsoft Security Advisory 973882](http://www.microsoft.com/technet/security/advisory/973882.mspx)
[Microsoft Update](https://www.update.microsoft.com/microsoftupdate)
[Windows Server Update Services](http://www.microsoft.com/windowsserversystem/updateservices/default.mspx)
### Revisions

August 11, 2009: Initial release

This product is provided subject to this [Notification](/notification "Follow link") and this [Privacy & Use](/privacy-policy "Follow link") policy.

## Please share your thoughts

We recently updated our anonymous [product survey](https://cisasurvey.gov1.qualtrics.com/jfe/form/SV_9n4TtB8uttUPaM6?product=https://www.cisa.gov/news-events/alerts/2009/08/11/microsoft-updates-multiple-vulnerabilities); we’d welcome your feedback.

Return to top

* [Topics](/topics)
* [Spotlight](/spotlight)
* [Resources & Tools](/resources-tools)
* [News & Events](/news-events)
* [Careers](/careers)
* [About](/about)

[Cybersecurity & Infrastructure Security Agency](/ "Go to the Cybersecurity & Infrastructure Security Agency homepage")

* [Facebook](https://www.facebook.com/CISA)
* [Twitter](https://twitter.com/CISAgov)
* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)
* [YouTube](https://www.youtube.com/%40cisagov)
* [Instagram](https://www.instagram.com/cisagov)
* [RSS](/subscribe-updates-cisa)

CISA Central
1-844-Say-CISA
SayCISA@cisa.dhs.gov

DHS Seal
CISA.gov
An official website of the U.S. Department of Homeland Security

* [About CISA](/about "About CISA")
* [Budget and Performance](https://www.dhs.gov/performance-financial-reports "Budget and Performance")
* [DHS.gov](https://www.dhs.gov "Department of Homeland Security")
* [FOIA Requests](https://www.dhs.gov/foia "FOIA Requests")
* [No FEAR Act](/no-fear-act "No FEAR Act Reporting")
* [Office of Inspector General](https://www.oig.dhs.gov/ "Office of Inspector General")
* [Privacy Policy](/privacy-policy "Privacy Policy")
* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 "Subscribe to Email Updates")
* [The White House](https://www.whitehouse.gov/ "The White House")
* [USA.gov](https://www.usa.gov/ "USA.gov")
* [Website Feedback](/forms/feedback "Website Feedback")



=== Content from docs.microsoft.com_c3181044_20250125_042859.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2009/ms09-043.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 06/08/2023
* 8 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS09-043 - Critical

## Vulnerabilities in Microsoft Office Web Components Could Allow Remote Code Execution (957638)

Published: August 11, 2009 | Updated: October 27, 2009

**Version:** 2.0

### General Information

#### Executive Summary

This security update resolves several privately reported vulnerabilities in Microsoft Office Web Components that could allow remote code execution if a user viewed a specially crafted Web page. An attacker who successfully exploited these vulnerabilities could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

This security update is rated Critical for all supported editions of Microsoft Office XP, Microsoft Office 2003, Microsoft Office 2000 Web Components, Microsoft Office XP Web Components, Microsoft Office 2003 Web Components, Microsoft Office 2003 Web Components for the 2007 Microsoft Office system, Microsoft Internet Security and Acceleration Server 2004 Standard Edition, Microsoft Internet Security and Acceleration Server 2004 Enterprise Edition, Microsoft Internet Security and Acceleration Server 2006, Microsoft BizTalk Server 2002, Microsoft Visual Studio .NET 2003, and Microsoft Office Small Business Accounting 2006. For more information, see the subsection, **Affected and Non-Affected Software**, in this section.

The security update addresses the vulnerabilities by correctly handling memory allocation when the ActiveX control is used in Internet Explorer, correcting validation logic for Office Web Components ActiveX control methods, and performing additional parameter validation. For more information about the vulnerabilities, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, **Vulnerability Information**.

This security update also addresses the vulnerability first described in [Microsoft Security Advisory 973472](https://technet.microsoft.com/security/advisory/973472). The security updates addressed in this bulletin are not related to the vulnerabilities described in [Microsoft Security Advisory 973882](https://technet.microsoft.com/security/advisory/973882).

**Recommendation.** Microsoft recommends that customers apply the update immediately.

**Known Issues.** [Microsoft Knowledge Base Article 957638](https://support.microsoft.com/kb/957638) documents the currently known issues that customers may experience when installing this security update. The article also documents recommended solutions for these issues. When currently known issues and recommended solutions pertain only to specific releases of this software, this article provides links to further articles.

#### Affected and Non-Affected Software

The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

**Affected Software**

| Office Suite and Other Software | Maximum Security Impact | Aggregate Severity Rating | Bulletins Replaced by this Update |
| --- | --- | --- | --- |
| Microsoft Office Suites |  |  |  |
| [Microsoft Office XP Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=60e2e4e7-aa75-441d-b6fc-7e850bf8e580) (KB947320) | Remote Code Execution | Critical | [MS08-017](https://go.microsoft.com/fwlink/?linkid=112114) |
| [Microsoft Office 2003 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=95c94c9a-6aca-42fb-9679-3234f06c72f7) (KB947319) | Remote Code Execution | Critical | None |
| Microsoft Office Web Components |  |  |  |
| [Microsoft Office 2000 Web Components Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=60e2e4e7-aa75-441d-b6fc-7e850bf8e580) (KB947320) | Remote Code Execution | Critical | [MS08-017](https://go.microsoft.com/fwlink/?linkid=112114) |
| [Microsoft Office XP Web Components Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=60e2e4e7-aa75-441d-b6fc-7e850bf8e580) (KB947320) | Remote Code Execution | Critical | [MS08-017](https://go.microsoft.com/fwlink/?linkid=112114) |
| [Microsoft Office 2003 Web Components Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=95c94c9a-6aca-42fb-9679-3234f06c72f7) (KB947319) | Remote Code Execution | Critical | None |
| [Microsoft Office 2003 Web Components Service Pack 1 for the 2007 Microsoft Office System](https://www.microsoft.com/download/details.aspx?familyid=644008e0-77c9-4a02-ac9b-e30d0930c4be)\*\* (KB947318) | Remote Code Execution | Critical | None |
| Microsoft Internet Security and Acceleration Server |  |  |  |
| [Microsoft Internet Security and Acceleration Server 2004 Standard Edition Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=8f79a073-27e8-46ef-87d8-f09b93521326)\* (KB947826) | Remote Code Execution | Critical | None |
| [Microsoft Internet Security and Acceleration Server 2004 Enterprise Edition Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=8f79a073-27e8-46ef-87d8-f09b93521326) (KB947826) | Remote Code Execution | Critical | None |
| [Microsoft Internet Security and Acceleration Server 2006 Standard Edition Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=8f79a073-27e8-46ef-87d8-f09b93521326) (KB947826) | Remote Code Execution | Critical | None |
| [Microsoft Internet Security and Acceleration Server 2006 Enterprise Edition Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=8f79a073-27e8-46ef-87d8-f09b93521326) (KB947826) | Remote Code Execution | Critical | None |
| Other Microsoft Software |  |  |  |
| [Microsoft BizTalk Server 2002](https://www.microsoft.com/download/details.aspx?familyid=495839b6-0322-4755-997d-4a7762c53333) (KB971388) | Remote Code Execution | Critical | [MS08-017](https://go.microsoft.com/fwlink/?linkid=112114) |
| [Microsoft Visual Studio .NET 2003 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=ba2915a0-f5f4-4e18-b0c0-534d2a948585) (KB969172) | Remote Code Execution | Critical | [MS08-017](https://go.microsoft.com/fwlink/?linkid=112114) |
| [Microsoft Office Small Business Accounting 2006](https://www.microsoft.com/download/details.aspx?familyid=0d77ddb3-4d34-4cfe-913b-d05981f59a82) (KB968377) | Remote Code Execution | Critical | None |

\*Microsoft ISA Server 2004 Standard Edition is delivered as a standalone product. Microsoft ISA Server 2004 Standard Edition is also delivered as a component of Windows Small Business Server 2003 Premium Edition Service Pack 1 and Windows Small Business Server 2003 R2 Premium Edition.

\*\*SQL Server 2008 and Microsoft Forefront Threat Management Gateway Medium Business Edition redistribute the affected component Office 2003 Web Components for the 2007 Microsoft Office System. The update for the Office 2003 Web Components for the 2007 Microsoft Office System component detects for SQL Server 2008 and Microsoft Forefront Threat Management Gateway Medium Business Edition and will offer the update to customers.

**Non-Affected Software**

| Office and Other Software |
| --- |
| 2007 Microsoft Office Suite Service Pack 1 and 2007 Microsoft Office Suite Service Pack 2 |
| Microsoft Office 2004 for Mac |
| Microsoft Office 2008 for Mac |
| Microsoft Office PowerPoint Viewer 2003 |
| Microsoft Office Word Viewer 2003 |
| Microsoft Office Word Viewer 2003 Service Pack 3 |
| Microsoft Office Excel Viewer 2003 |
| Microsoft Office Excel Viewer 2003 Service Pack 3 |
| Microsoft Office Excel Viewer |
| Microsoft Office PowerPoint 2007 Viewer |
| Microsoft Office PowerPoint Viewer 2007 Service Pack 1 |
| Microsoft Office Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats Service Pack 1 and Microsoft Office Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats Service Pack 2 |
| Microsoft Internet Security and Acceleration Server 2000 Service Pack 2\* |
| Microsoft BizTalk Server 2004 |
| Microsoft BizTalk Server 2006 |
| Microsoft BizTalk Server 2009 |
| Microsoft Visual Studio 2005 |
| Microsoft Visual Studio 2005 Service Pack 1 |
| Microsoft Visual Studio 2008 |
| Microsoft Visual Studio 2008 Service Pack 1 |
| Microsoft Visual Studio 2010 |

\*Microsoft Internet Security and Acceleration Server 2000 Service Pack 2 is not-affected because the previous OWC release, [MS08-017](https://go.microsoft.com/fwlink/?linkid=112114), set the [kill bit](https://support.microsoft.com/kb/240797) needed to prevent this exploit.

## Frequently Asked Questions (FAQ) Related to This Security Update

**Why was this bulletin rereleased on October 27, 2009?**

Microsoft rereleased this bulletin to reoffer the update for Microsoft Office 2003 Service Pack 3 and Microsoft Office 2003 Web Components Service Pack 3 to fix a detection issue when Microsoft Office Access Runtime 2003 is installed. This is a detection change only; there were no changes to the binaries. Customers who have successfully updated their systems do not need to reinstall this update.

**How do I know which versions of OWC are still in support and which versions of Office they shipped with?**

There are three versions of Office Web Components:

* Office 2000 Web Components
* Office XP Web Components
* Office 2003 Web Components

Each version was released as a Web download and on the CDs of the corresponding version of Microsoft Office. In addition, each version was re-released together with the next version of Office. Therefore, there is a version of Office 2000 Web Components on the Office XP CDs and a version of Office XP Web Components on the Office 2003 CDs. The Office 2003 Web Components were not released on Office 2007 CDs. However, they were re-released to the Web and included with Microsoft Office Project Server 2007. Although these re-releases carry the same names and functionality as the original release, for technical reasons they are considered separate products for patching purposes.

Each version of OWC, and this includes the re-releases, is supported according to the version of Office with which it shipped. Therefore, the version of Office 2000 Web Components that shipped with Office 2000 was in extended support until Office 2000 left extended support on July 14, 2009. However, the version of Office 2000 Web Components that shipped with Office XP is in extended support until Office XP leaves extended support on July 12, 2011. This same rule applies to the other versions of OWC. The following table lists the support milestone dates and release locations for all the different versions of OWC:

| OWC Version | Release Location | Mainstream Support Ends | Extended Support Ends |
| --- | --- | --- | --- |
| OWC 2000 (Office 2000 version) | Office 2000 CD, Web | Mainstream support has ended. | Extended support has ended. |
| OWC 2000 (Office XP version) | Office XP CD | Mainstream support has ended. | 7/12/2011 |
| OWC XP (Office XP version) | Office XP CD, Web | Mainstream support has ended. | 7/12/2011 |
| OWC XP (Office 2003 version) | Office 2003 CD | Mainstream support has ended. | 4/8/2014 |
| OWC 2003 (Office 2003 version) | Office 2003 CD, Web (versions 1-3) | Mainstream support has ended. | 4/8/2014 |
| OWC 2003 (2007 Office system version) | Project Server 2007 CD, Web (version 4) | 4/10/2012 | 4/11/2017 |

For more information about the support life cycle of Microsoft Office products, visit the [Office Products](https://support.microsoft.com/gp/lifeselectoff) Web site at Microsoft Help and Support.

**Where are the file information details?**

Refer to the reference tables in the **Security Update Deployment** section for the location of the file information details.

**Why does this update address several reported security vulnerabilities?**

This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only.

**Does this update contain any security-related changes to functionality?**

For affected versions of ISA Server, the update sets the kill bit for all OWC CLSIDs blocking known attack vectors within Internet Explorer. This action does not affect ISA Server functionality.

**I am using an older release of the software discussed in this security bulletin. What should I do?**

The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. To determine the support life cycle for your software release, visit [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. For more information about the Windows Product Lifecycle, visit [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742). For more information about the extended security update support period for these software versions or editions, visit [Microsoft Product Support Services](https://go.microsoft.com/fwlink/?linkid=33328).

Customers who require custom support for older releases must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit [Microsoft Worldwide Information](https://go.microsoft.com/fwlink/?linkid=33329), select the country, and then click **Go** to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the [Windows Operating System Product Support Lifecycle FAQ](https://go.microsoft.com/fwlink/?linkid=33330).

### Vulnerability Information

## Severity Ratings and Vulnerability Identifiers

The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [August bulletin summary](https://technet.microsoft.com/security/bulletin/ms09-aug). For more information, see [Microsoft Exploitability Index](https://technet.microsoft.com/security/cc998259.aspx).

| Affected Software | Office Web Components Memory Allocation Vulnerability - CVE-2009-0562 | Office Web Components Heap Corruption Vulnerability - CVE-2009-2496 | Office Web Components HTML Script Vulnerability - CVE-2009-1136 | Office Web Components Buffer Overflow Vulnerability - CVE-2009-1534 | Aggregate Severity Rating |
| --- | --- | --- | --- | --- | --- |
| Microsoft Office Suites |  |  |  |  |  |
| Microsoft Office XP Service Pack 3 | **Critical** Remote Code Execution | **Critical** Remote Code Execution | **Critical** Remote Code Execution | **Critical** Remote Code Execution | **Critical** |
| Microsoft Office 2003 Service Pack 3 | **Critical** Remote Code Execution | **Critical** Remote Code Execution | **Critical** Remote Code Execution | Not applicable | **Critical** |
| Microsoft Office Web Components |  |  |  |  |  |
| Microsoft Office 2000 Web Components Service Pack 3 | Not applicable | Not applicable | Not applicable | **Critical** Remote Code Execution | **Critical** |
| Microsoft Office XP Web Components Service Pack 3 | **Critical** Remote Code Execution | **Critical** Remote Code Execution | **Critical** Remote Code Execution | **Critical** Remote Code Execution | **Critical** |
| Microsoft Office 2003 Web Components Service Pack 3 | **Critical** Remote Code Execution | **Critical** Remote Code Execution | **Critical** Remote Code Execution | Not applicable | **Critical** |
| Microsoft Office 2003 Web Components Service Pack 1 for the 2007 Microsoft Office System | **Critical** Remote Code Execution | **Critical** Remote Code Execution | **Critical** Remote Code Execution | Not applicable | **Critical** |
| Microsoft Internet Security and Acceleration Server |  |  |  |  |  |
| Microsoft Internet Security and Acceleration Server 2004 Standard Edition Service Pack 3 | **Critical** Remote Code Execution | **Critical** Remote Code Execution | **Critical** Remote Code Execution | Not applicable | **Critical** |
| Microsoft Internet Security and Acceleration Server 2004 Enterprise Edition Service Pack 3 | **Critical** Remote Code Execution | **Critical** Remote Code Execution | **Critical** Remote Code Execution | Not applicable | **Critical** |
| Microsoft Internet Security and Acceleration Server 2006 Standard Edition Service Pack 1 | **Critical** Remote Code Execution | **Critical** Remote Code Execution | **Critical** Remote Code Execution | Not applicable | **Critical** |
| Microsoft Internet Security and Acceleration Server 2006 Enterprise Edition Service Pack 1 | **Critical** Remote Code Execution | **Critical** Remote Code Execution | **Critical** Remote Code Execution | Not applicable | **Critical** |
| Other Microsoft Software |  |  |  |  |  |
| Microsoft BizTalk Server 2002 | Not applicable | Not applicable | Not applicable | **Critical** Remote Code Execution | **Critical** |
| Microsoft Visual Studio .NET 2003 Service Pack 1 | Not applicable | Not applicable | Not applicable | **Critical** Remote Code Execution | **Critical** |
| Microsoft Office Small Business Accounting 2006 | **Critical** Remote Code Execution | **Critical** Remote Code Execution | **Critical** Remote Code Execution | Not applicable | **Critical** |

## Office Web Components Memory Allocation Vulnerability - CVE-2009-0562

A remote code execution vulnerability exists in the Office Web Components ActiveX Control. An attacker could exploit the vulnerability by constructing a specially crafted Web page. When a user views the Web page, the vulnerability could allow remote code execution. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2009-0562](https://www.cve.org/CVERecord?id=CVE-2009-0562).

#### Mitigating Factors for Office Web Components Memory Allocation Vulnerability - CVE-2009-0562

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* By default, Internet Explorer on Windows Server 2003 and 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://msdn.microsoft.com/library/default.asp?url=/workshop/security/szone/overview/esc_changes.asp). This mode mitigates this vulnerability. See the FAQ section of this security update for more information about Internet Explorer Enhanced Security Configuration.
* By default, Outlook Express 6, Outlook 2002, and Outlook 2003 open HTML e-mail messages in the Restricted sites zone. Additionally, Outlook 2000 opens HTML e-mail messages in the Restricted sites zone if the [Outlook E-mail Security Update](https://go.microsoft.com/fwlink/?linkid=33334) has been installed. Outlook Express 5.5 Service Pack 2 opens HTML e-mail messages in the Restricted sites zone if [Microsoft Security Bulletin MS04-018](https://go.microsoft.com/fwlink/?linkid=19527) has been installed.
  The Restricted sites zone helps reduce attacks that could try to exploit this vulnerability by preventing ActiveX controls from being used when reading HTML e-mail messages. However, if a user clicks a link in an e-mail message, they could still be vulnerable to this issue through the Web-based attack scenario.
* In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site.
* An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

#### Workarounds for Office Web Components Memory Allocation Vulnerability - CVE-2009-0562

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Prevent Office Web Components Library from running in Internet Explorer**.

  You can prevent the Office Web Components Library from running in Internet Explorer by setting the kill bit for the control in the registry.

  **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.

  **Note** We recommend backing up the registry before you edit it.

  **Note** This is the action taken by the ISA Server update package. No binaries are included in this update for ISA Server.

  For detailed steps that you can use to prevent a control from running in Office Web Components, see [Microsoft Knowledge Base Article 240797](https://support.microsoft.com/kb/240797). Follow these steps in this article to create a Compatibility Flags value in the registry to prevent the Office Web Components library from running.

  **Note** The Class Identifiers and corresponding files where the library objects are contained are documented in the FAQ "What does the update do?"

  + To set the kill bit for a CLSID with a value of {0002E543-0000-0000-C000-000000000046} and {0002E55B-0000-0000-C000-000000000046}, paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension.
    Windows Registry Editor Version 5.00
    [HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{0002E543-0000-0000-C000-000000000046}]
    "Compatibility Flags"=dword:00000400
    [HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{0002E55B-0000-0000-C000-000000000046}]
    "Compatibility Flags"=dword:00000400

  You can apply this .reg file to individual systems by double-clicking it. You can also apply it across domains by using Group Policy. For more information about Group Policy, visit the following Microsoft Web sites:

  + [Group Policy Collection](https://technet.microsoft.com/windowsserver/en/library/6d7cb788-b31d-4d17-9f1e-b5ddaa6deecd)
  + [What is Group Policy Object Editor?](https://technet.microsoft.com/windowsserver/en/library/47ba1311-6cca-414f-98c9-2d7f99fca8a3)
  + [Core Group Policy Tools and Settings](https://technet.microsoft.com/windowsserver/en/library/e926577a-5619-4912-b5d9-e73d4bdc9491)

  **Note** You must restart Internet Explorer for your changes to take effect.

  **Impact of Workaround**: After the kill bit is set, you will no longer be able to use the OWC Spreadsheet functionality within the Office Web Components ActiveX Control in Internet Explorer, Microsoft Office, or any application that honors kill bits. This will not affect the standard operation of Microsoft Office and most users will not notice any change after setting the kill bit. OWC is primarily used by Web applications, including internal business applications, Microsoft Office Project Web Access, and the [Office 2003 Add-in: Web Parts and Components](https://www.microsoft.com/download/details.aspx?familyid=38be67a5-2056-46a1-84b1-337ffb549c5c&displaylang;=en). It may also be used in some VBA solutions within Microsoft Office. Once the kill bit is set, these applications will not be able to use any functionality that relies on the OWC Spreadsheet control within the Office Web Components ActiveX Control.

  **How to undo the Workaround**: You can undo the workaround documented above by following these steps:

  **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.

  **Note** We recommend backing up the registry before you edit it.

  + To undo the kill bit for a CLSID with a value of {0002E543-0000-0000-C000-000000000046} and {0002E55B-0000-0000-C000-000000000046}, paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension.
    Windows Registry Editor Version 5.00
    CLSID\_OWC10\_Spreadsheet, {0002E541-0000-0000-C000-000000000046}[-HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{0002E543-0000-0000-C000-000000000046}]
    CLSID\_OWC11\_Spreadsheet, {0002E559-0000-0000-C000-000000000046}[-HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{0002E55B-0000-0000-C000-000000000046}]
* **Unregister the Office Web Components Library**

  **Note** This action will not work on an ISA Server computer because:

  + The Office Web components are installed in the ISA Server program directory (â%ProgramFiles%\Microsoft ISA Serverâ by default)
  + The Office Web Components are re-registered by the ISA Server report job mechanism each time a report job is executed.

  **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.

  **Note** We recommend backing up the registry before you edit it.

  + For OWC 10, type the following at the command prompt and select **Run:**
    Regsvr32.exe /u "C:\Program Files\Common Files\Microsoft Shared\Web Components\10\owc10.dll"
  + For OWC 11, type the following at the command prompt and select **Run:**
    Regsvr32.exe /u "C:\Program Files\Common Files\Microsoft Shared\Web Components\11\owc11.dll"

  **Impact of Workaround**: Applications requiring Office Web Components functionality will not function.

  **How to undo the Workaround:** To re-register the Office Web Components, follow these steps:

  + For OWC 10, type the following at the command prompt and select **Run:**
    Regsvr32.exe "C:\Program Files\Common Files\Microsoft Shared\Web Components\10\owc10.dll"
  + For OWC 11, type the following at the command prompt and select **Run:**
    Regsvr32.exe "C:\Program Files\Common Files\Microsoft Shared\Web Components\11\owc11.dll"
* **Restrict Web sites to only your trusted Web sites**

  After you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to Internet Explorer's Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.

  To do this, follow these steps:

  1. In Internet Explorer, click **Tools**, click **Internet Options**, and then click the **Security** tab.
  2. In the **Select a Web content zone to specify its current security settings** box, click **Trusted Sites**, and then click **Sites**.
  3. If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:) for all sites in this zone** check box.
  4. In the **Add this Web site to the zone** box, type the URL of a site that you trust, and then click **Add**.
  5. Repeat these steps for each site that you want to add to the zone.
  6. Click **OK** two times to accept the changes and return to Internet Explorer.

  Add any sites that you trust not to take malicious action on your computer. Two in particular that you may want to add are "\*.windowsupdate.microsoft.com" and "\*.update.microsoft.com" (without the quotation marks). This is the site that will host the update, and it requires an ActiveX control to install the update.
* **Set Internet and Local intranet security zone settings to "High" to prompt before running ActiveX controls in these zones**

  You can help protect against these vulnerabilities by changing your settings for the Internet security zone to prompt before running ActiveX controls. You can do this by setting your browser security to **High**.

  To raise the browsing security level in Microsoft Internet Explorer, follow these steps:

  1. On the Internet Explorer **Tools** menu, click **Internet Options**.
  2. In the **Internet Options** dialog box, click the **Security** tab, and then click the **Internet** icon.
  3. Under **Security level for this zone**, move the slider to **High**. This sets the security level for all Web sites you visit to High.

  **Note** If no slider is visible, click **Default Level**, and then move the slider to **High**.

  **Note** Setting the level to **High** may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly even with the security setting set to **High**.

#### FAQ for Office Web Components Memory Allocation Vulnerability - CVE-2009-0562

**What is the scope of the vulnerability?**

This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

**What causes the vulnerability?**

When the ActiveX control is used in Internet Explorer, the control may corrupt the system state in such a way that an attacker could run arbitrary code.

**What are Office Web Components?**

Microsoft Office Web Components are a collection of Component Object Model (COM) controls for publishing spreadsheets, charts, and databases to the Web, and for viewing the published components on the Web.

**What might an attacker use the vulnerability to do?**

If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

**How could an attacker exploit the vulnerability?**

An attacker could exploit the vulnerability by hosting a specially crafted Web site that is designed to invoke the ActiveX control through Internet Explorer. This can also include compromised Web sites and Web sites that accept or host user-provided content or advertisements. These Web sites could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or in an Instant Messenger request that takes users to the attacker's Web site. It could also be possible to display specially crafted Web content by using banner advertisements or by using other methods to deliver Web content to affected systems.

**What systems are primarily at risk from the vulnerability?**

This vulnerability requires that a user be logged on and visit a Web site for any malicious action to occur. Therefore, any systems where Internet Explorer is used frequently, such as workstations or terminal servers, are at the most risk from this vulnerability. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this.

**I am running Internet Explorer for Windows Server 2003 or Windows Server 2008. Does this mitigate this vulnerability?**

Yes. By default, Internet Explorer on Windows Server 2003 and Windows Server 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92039). Enhanced Security Configuration is a group of preconfigured settings in Internet Explorer that can reduce the likelihood of a user or administrator downloading and running specially crafted Web content on a server. This is a mitigating factor for Web sites that you have not added to the Internet Explorer Trusted sites zone. See also [Managing Internet Explorer Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92055).

**What is the ActiveX opt-in feature in Windows Internet Explorer 7?**

Windows Internet Explorer 7 includes an ActiveX opt-in feature, which means that nearly all pre-installed ActiveX controls are off by default. Users are prompted by the Information Bar before they can instantiate a previously installed ActiveX control that has not yet been used on the Internet. This enables a user to permit or deny access on a control-by-control basis. For more information about this and other new features, see the [Windows Internet Explorer 7 features page](https://www.microsoft.com/windows/products/winfamily/ie/features.mspx).

**What does the update do?**

The update removes the vulnerability by correctly handling memory allocation when the ActiveX control is used in Internet Explorer.

For affected versions of ISA Server, the update sets the [kill bit](https://support.microsoft.com/kb/240797) for all OWC CLSIDs blocking known attack vectors within Internet Explorer. This action does not affect ISA Server functionality.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

No. Microsoft received information about this vulnerability through responsible disclosure.

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers and had not seen any examples of proof of concept code published when this security bulletin was originally issued.

## Office Web Components Heap Corruption Vulnerability - CVE-2009-2496

A remote code execution vulnerability exists in the Office Web Components ActiveX Control. An attacker could exploit the vulnerability by constructing a specially crafted Web page. When a user views the Web page, the vulnerability could allow remote code execution. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2009-2496](https://www.cve.org/CVERecord?id=CVE-2009-2496).

#### Mitigating Factors for Office Web Components Heap Corruption Vulnerability - CVE-2009-2496

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* By default, Internet Explorer on Windows Server 2003 and 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://msdn.microsoft.com/library/default.asp?url=/workshop/security/szone/overview/esc_changes.asp). This mode mitigates this vulnerability. See the FAQ section of this security update for more information about Internet Explorer Enhanced Security Configuration.
* By default, Outlook Express 6, Outlook 2002, and Outlook 2003 open HTML e-mail messages in the Restricted sites zone. Additionally, Outlook 98 and Outlook 2000 open HTML e-mail messages in the Restricted sites zone if the [Outlook E-mail Security Update](https://go.microsoft.com/fwlink/?linkid=33334) has been installed. Outlook Express 5.5 Service Pack 2 opens HTML e-mail messages in the Restricted sites zone if [Microsoft Security Bulletin MS04-018](https://go.microsoft.com/fwlink/?linkid=19527) has been installed.
  The Restricted sites zone helps reduce attacks that could try to exploit this vulnerability by preventing ActiveX controls from being used when reading HTML e-mail messages. However, if a user clicks a link in an e-mail message, they could still be vulnerable to this issue through the Web-based attack scenario.
* In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site.
* An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

#### Workarounds for Office Web Components Heap Corruption Vulnerability - CVE-2009-2496

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Prevent Office Web Components Library from running in Internet Explorer**.

  You can prevent the Office Web Components Library from running in Internet Explorer by setting the kill bit for the control in the registry.

  **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.

  **Note** We recommend backing up the registry before you edit it.

  **Note** This is the action taken by the ISA Server update package. No binaries are included in this update for ISA Server.

  For detailed steps that you can use to prevent a control from running in Office Web Components, see [Microsoft Knowledge Base Article 240797](https://support.microsoft.com/kb/240797). Follow these steps in this article to create a Compatibility Flags value in the registry to prevent the Office Web Components library from running.

  **Note** The Class Identifiers and corresponding files where the library objects are contained are documented in the FAQ "What does the update do?"

  + To set the kill bit for a CLSID with a value of {0002E541-0000-0000-C000-000000000046} and {0002E559-0000-0000-C000-000000000046}, paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension.
    Windows Registry Editor Version 5.00
    [HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{0002E541-0000-0000-C000-000000000046}]
    "Compatibility Flags"=dword:00000400
    [HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{0002E559-0000-0000-C000-000000000046}]
    "Compatibility Flags"=dword:00000400

  You can apply this .reg file to individual systems by double-clicking it. You can also apply it across domains by using Group Policy. For more information about Group Policy, visit the following Microsoft Web sites:

  + [Group Policy Collection](https://technet.microsoft.com/windowsserver/en/library/6d7cb788-b31d-4d17-9f1e-b5ddaa6deecd)
  + [What is Group Policy Object Editor?](https://technet.microsoft.com/windowsserver/en/library/47ba1311-6cca-414f-98c9-2d7f99fca8a3)
  + [Core Group Policy Tools and Settings](https://technet.microsoft.com/windowsserver/en/library/e926577a-5619-4912-b5d9-e73d4bdc9491)

  **Note** You must restart Internet Explorer for your changes to take effect.

  **Impact of Workaround**: After the kill bit is set, you will no longer be able to use the OWC Spreadsheet functionality within the Office Web Components ActiveX Control in Internet Explorer, Microsoft Office, or any application that honors kill bits. This will not affect the standard operation of Microsoft Office and most users will not notice any change after setting the kill bit. OWC is primarily used by Web applications, including internal business applications, Microsoft Office Project Web Access, and the [Office 2003 Add-in: Web Parts and Components](https://www.microsoft.com/download/details.aspx?familyid=38be67a5-2056-46a1-84b1-337ffb549c5c&displaylang;=en). It may also be used in some VBA solutions within Microsoft Office. Once the kill bit is set, these applications will not be able to use any functionality that relies on the OWC Spreadsheet control within the Office Web Components ActiveX Control.

  **How to undo the Workaround**: You can undo the workaround documented above by following these steps:

  **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.

  **Note** We recommend backing up the registry before you edit it.

  + To undo the kill bit for a CLSID with a value of {0002E541-0000-0000-C000-000000000046} and {0002E559-0000-0000-C000-000000000046}, paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension.
    Windows Registry Editor Version 5.00
    CLSID\_OWC10\_Spreadsheet, {0002E541-0000-0000-C000-000000000046}[-HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{0002E541-0000-0000-C000-000000000046}]
    CLSID\_OWC11\_Spreadsheet, {0002E559-0000-0000-C000-000000000046}[-HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{0002E559-0000-0000-C000-000000000046}]
* **Unregister the Office Web Components Library**

  **Note** This action will not work on an ISA Server computer because:

  + The Office Web components are installed in the ISA Server program directory (â%ProgramFiles%\Microsoft ISA Serverâ by default)
  + The Office Web Components are re-registered by the ISA Server report job mechanism each time a report job is executed.

  **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.

  **Note** We recommend backing up the registry before you edit it.

  + For OWC 10, type the following at the command prompt and select **Run:**
    Regsvr32.exe /u "C:\Program Files\Common Files\Microsoft Shared\Web Components\10\owc10.dll"
  + For OWC 11, type the following at the command prompt and select **Run:**
    Regsvr32.exe /u "C:\Program Files\Common Files\Microsoft Shared\Web Components\11\owc11.dll"

  **Impact of Workaround**: Applications requiring Office Web Components functionality will not function.

  **How to undo the Workaround:** To re-register the Office Web Components, follow these steps:

  + For OWC 10, type the following at the command prompt and select **Run:**
    Regsvr32.exe "C:\Program Files\Common Files\Microsoft Shared\Web Components\10\owc10.dll"
  + For OWC 11, type the following at the command prompt and select **Run:**
    Regsvr32.exe "C:\Program Files\Common Files\Microsoft Shared\Web Components\11\owc11.dll"
* **Restrict Web sites to only your trusted Web sites**

  After you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to Internet Explorer's Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.

  To do this, follow these steps:

  1. In Internet Explorer, click **Tools**, click **Internet Options**, and then click the **Security** tab.
  2. In the **Select a Web content zone to specify its current security settings** box, click **Trusted Sites**, and then click **Sites**.
  3. If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:) for all sites in this zone** check box.
  4. In the **Add this Web site to the zone** box, type the URL of a site that you trust, and then click **Add**.
  5. Repeat these steps for each site that you want to add to the zone.
  6. Click **OK** two times to accept the changes and return to Internet Explorer.

  Add any sites that you trust not to take malicious action on your computer. Two in particular that you may want to add are "\*.windowsupdate.microsoft.com" and "\*.update.microsoft.com" (without the quotation marks). This is the site that will host the update, and it requires an ActiveX control to install the update.
* **Set Internet and Local intranet security zone settings to "High" to prompt before running ActiveX controls in these zones**

  You can help protect against these vulnerabilities by changing your settings for the Internet security zone to prompt before running ActiveX controls. You can do this by setting your browser security to **High**.

  To raise the browsing security level in Microsoft Internet Explorer, follow these steps:

  1. On the Internet Explorer **Tools** menu, click **Internet Options**.
  2. In the **Internet Options** dialog box, click the **Security** tab, and then click the **Internet** icon.
  3. Under **Security level for this zone**, move the slider to **High**. This sets the security level for all Web sites you visit to High.

  **Note** If no slider is visible, click **Default Level**, and then move the slider to **High**.

  **Note** Setting the level to **High** may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly even with the security setting set to **High**.

#### FAQ for Office Web Components Heap Corruption Vulnerability - CVE-2009-2496

**What is the scope of the vulnerability?**

This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

**What causes the vulnerability?**

When the ActiveX control is used in Internet Explorer, the control methods do not perform sufficient parameter validation which may result in a heap overflow in such a way that an attacker could run arbitrary code.

**What are Office Web Components?**

Microsoft Office Web Components are a collection of Component Object Model (COM) controls for publishing spreadsheets, charts, and databases to the Web, and for viewing the published components on the Web.

**What might an attacker use the vulnerability to do?**

If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

**How could an attacker exploit the vulnerability?**

An attacker could exploit the vulnerability by hosting a specially crafted Web site that is designed to invoke the ActiveX control through Internet Explorer. This can also include compromised Web sites and Web sites that accept or host user-provided content or advertisements. These Web sites could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or in an Instant Messenger request that takes users to the attacker's Web site. It could also be possible to display specially crafted Web content by using banner advertisements or by using other methods to deliver Web content to affected systems.

**What systems are primarily at risk from the vulnerability?**

This vulnerability requires that a user be logged on and visit a Web site for any malicious action to occur. Therefore, any systems where Internet Explorer is used frequently, such as workstations or terminal servers, are at the most risk from this vulnerability. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this.

**I am running Internet Explorer for Windows Server 2003 or Windows Server 2008. Does this mitigate this vulnerability?**

Yes. By default, Internet Explorer on Windows Server 2003 and Windows Server 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92039). Enhanced Security Configuration is a group of preconfigured settings in Internet Explorer that can reduce the likelihood of a user or administrator downloading and running specially crafted Web content on a server. This is a mitigating factor for Web sites that you have not added to the Internet Explorer Trusted sites zone. See also [Managing Internet Explorer Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92055).

**What is the ActiveX opt-in feature in Windows Internet Explorer 7?**

Windows Internet Explorer 7 includes an ActiveX opt-in feature, which means that nearly all pre-installed ActiveX controls are off by default. Users are prompted by the Information Bar before they can instantiate a previously installed ActiveX control that has not yet been used on the Internet. This enables a user to permit or deny access on a control-by-control basis. For more information about this and other new features, see the [Windows Internet Explorer 7 features page](https://www.microsoft.com/windows/products/winfamily/ie/features.mspx).

**What does the update do?**

The update removes the vulnerability by correcting validation logic for Office Web Components ActiveX control methods.

For affected versions of ISA Server, the update sets the [kill bit](https://support.microsoft.com/kb/240797) for all OWC CLSIDs blocking known attack vectors within Internet Explorer.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

No. Microsoft received information about this vulnerability through responsible disclosure.

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers and had not seen any examples of proof of concept code published when this security bulletin was originally issued.

## Office Web Components HTML Script Vulnerability - CVE-2009-1136

A remote code execution vulnerability exists in the Office Web Components ActiveX Control. An attacker could exploit the vulnerability by constructing a specially crafted Web page. When a user views the Web page, the vulnerability could allow remote code execution. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2009-1136](https://www.cve.org/CVERecord?id=CVE-2009-1136).

#### Mitigating Factors for Office Web Components HTML Script Vulnerability - CVE-2009-1136

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* By default, Internet Explorer on Windows Server 2003 and 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://msdn.microsoft.com/library/default.asp?url=/workshop/security/szone/overview/esc_changes.asp). This mode mitigates this vulnerability. See the FAQ section of this security update for more information about Internet Explorer Enhanced Security Configuration.
* By default, Outlook Express 6, Outlook 2002, and Outlook 2003 open HTML e-mail messages in the Restricted sites zone. Additionally, Outlook 98 and Outlook 2000 open HTML e-mail messages in the Restricted sites zone if the [Outlook E-mail Security Update](https://go.microsoft.com/fwlink/?linkid=33334) has been installed. Outlook Express 5.5 Service Pack 2 opens HTML e-mail messages in the Restricted sites zone if [Microsoft Security Bulletin MS04-018](https://go.microsoft.com/fwlink/?linkid=19527) has been installed.
  The Restricted sites zone helps reduce attacks that could try to exploit this vulnerability by preventing ActiveX controls from being used when reading HTML e-mail messages. However, if a user clicks a link in an e-mail message, they could still be vulnerable to this issue through the Web-based attack scenario.
* In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site.
* An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

#### Workarounds for Office Web Components HTML Script Vulnerability - CVE-2009-1136

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Prevent Office Web Components Library from running in Internet Explorer**.

  You can prevent the Office Web Components Library from running in Internet Explorer by setting the kill bit for the control in the registry.

  **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.

  **Note** We recommend backing up the registry before you edit it.

  **Note** This is the action taken by the ISA Server update package. No binaries are included in this update for ISA Server.

  For detailed steps that you can use to prevent a control from running in Office Web Components, see [Microsoft Knowledge Base Article 240797](https://support.microsoft.com/kb/240797). Follow these steps in this article to create a Compatibility Flags value in the registry to prevent the Office Web Components library from running.

  **Note** The Class Identifiers and corresponding files where the library objects are contained are documented in the FAQ "What does the update do?"

  + To set the kill bit for a CLSID with a value of {0002E541-0000-0000-C000-000000000046} and {0002E559-0000-0000-C000-000000000046}, paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension.
    Windows Registry Editor Version 5.00
    [HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{0002E541-0000-0000-C000-000000000046}]
    "Compatibility Flags"=dword:00000400
    [HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{0002E559-0000-0000-C000-000000000046}]
    "Compatibility Flags"=dword:00000400

  You can apply this .reg file to individual systems by double-clicking it. You can also apply it across domains by using Group Policy. For more information about Group Policy, visit the following Microsoft Web sites:

  + [Group Policy Collection](https://technet.microsoft.com/windowsserver/en/library/6d7cb788-b31d-4d17-9f1e-b5ddaa6deecd)
  + [What is Group Policy Object Editor?](https://technet.microsoft.com/windowsserver/en/library/47ba1311-6cca-414f-98c9-2d7f99fca8a3)
  + [Core Group Policy Tools and Settings](https://technet.microsoft.com/windowsserver/en/library/e926577a-5619-4912-b5d9-e73d4bdc9491)

  **Note** You must restart Internet Explorer for your changes to take effect.

  **Impact of Workaround**: After the kill bit is set, you will no longer be able to use the OWC Spreadsheet functionality within the Office Web Components ActiveX Control in Internet Explorer, Microsoft Office, or any application that honors kill bits. This will not affect the standard operation of Microsoft Office and most users will not notice any change after setting the kill bit. OWC is primarily used by Web applications, including internal business applications, Microsoft Office Project Web Access, and the [Office 2003 Add-in: Web Parts and Components](https://www.microsoft.com/download/details.aspx?familyid=38be67a5-2056-46a1-84b1-337ffb549c5c&displaylang;=en). It may also be used in some VBA solutions within Microsoft Office. Once the kill bit is set, these applications will not be able to use any functionality that relies on the OWC Spreadsheet control within the Office Web Components ActiveX Control.

  **How to undo the Workaround**: You can undo the workaround documented above by following these steps:

  **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.

  **Note** We recommend backing up the registry before you edit it.

  + To undo the kill bit for a CLSID with a value of {0002E541-0000-0000-C000-000000000046} and {0002E559-0000-0000-C000-000000000046}, paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension.
    Windows Registry Editor Version 5.00
    CLSID\_OWC10\_Spreadsheet, {0002E541-0000-0000-C000-000000000046}[-HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{0002E541-0000-0000-C000-000000000046}]
    CLSID\_OWC11\_Spreadsheet, {0002E559-0000-0000-C000-000000000046}[-HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{0002E559-0000-0000-C000-000000000046}]
* **Unregister the Office Web Components Library**

  **Note** This action will not work on an ISA Server computer because:

  + The Office Web components are installed in the ISA Server program directory (â%ProgramFiles%\Microsoft ISA Serverâ by default)
  + The Office Web Components are re-registered by the ISA Server report job mechanism each time a report job is executed.

  **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.

  **Note** We recommend backing up the registry before you edit it.

  + For OWC 10, type the following at the command prompt and select **Run:**
    Regsvr32.exe /u "C:\Program Files\Common Files\Microsoft Shared\Web Components\10\owc10.dll"
  + For OWC 11, type the following at the command prompt and select **Run:**
    Regsvr32.exe /u "C:\Program Files\Common Files\Microsoft Shared\Web Components\11\owc11.dll"

  **Impact of Workaround**: Applications requiring Office Web Components functionality will not function.

  **How to undo the Workaround:** To re-register the Office Web Components, follow these steps:

  + For OWC 10, type the following at the command prompt and select **Run:**
    Regsvr32.exe "C:\Program Files\Common Files\Microsoft Shared\Web Components\10\owc10.dll"
  + For OWC 11, type the following at the command prompt and select **Run:**
    Regsvr32.exe "C:\Program Files\Common Files\Microsoft Shared\Web Components\11\owc11.dll"
* **Restrict Web sites to only your trusted Web sites**

  After you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to Internet Explorer's Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.

  To do this, follow these steps:

  1. In Internet Explorer, click **Tools**, click **Internet Options**, and then click the **Security** tab.
  2. In the **Select a Web content zone to specify its current security settings** box, click **Trusted Sites**, and then click **Sites**.
  3. If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:) for all sites in this zone** check box.
  4. In the **Add this Web site to the zone** box, type the URL of a site that you trust, and then click **Add**.
  5. Repeat these steps for each site that you want to add to the zone.
  6. Click **OK** two times to accept the changes and return to Internet Explorer.

  Add any sites that you trust not to take malicious action on your computer. Two in particular that you may want to add are "\*.windowsupdate.microsoft.com" and "\*.update.microsoft.com" (without the quotation marks). This is the site that will host the update, and it requires an ActiveX control to install the update.
* **Set Internet and Local intranet security zone settings to "High" to prompt before running ActiveX controls in these zones**

  You can help protect against these vulnerabilities by changing your settings for the Internet security zone to prompt before running ActiveX controls. You can do this by setting your browser security to **High**.

  To raise the browsing security level in Microsoft Internet Explorer, follow these steps:

  1. On the Internet Explorer **Tools** menu, click **Internet Options**.
  2. In the **Internet Options** dialog box, click the **Security** tab, and then click the **Internet** icon.
  3. Under **Security level for this zone**, move the slider to **High**. This sets the security level for all Web sites you visit to High.

  **Note** If no slider is visible, click **Default Level**, and then move the slider to **High**.

  **Note** Setting the level to **High** may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly even with the security setting set to **High**.

#### FAQ for Office Web Components HTML Script Vulnerability - CVE-2009-1136

**What is the scope of the vulnerability?**

This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

**What causes the vulnerability?**

When the ActiveX control is used in Internet Explorer, the control does not correctly handle parameter values and may corrupt the system state in such a way that an attacker could run arbitrary code.

**What are Office Web Components?**

Microsoft Office Web Components are a collection of Component Object Model (COM) controls for publishing spreadsheets, charts, and databases to the Web, and for viewing the published components on the Web.

**What might an attacker use the vulnerability to do?**

If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

**How could an attacker exploit the vulnerability?**

An attacker could exploit the vulnerability by hosting a specially crafted Web site that is designed to invoke the ActiveX control through Internet Explorer. This can also include compromised Web sites and Web sites that accept or host user-provided content or advertisements. These Web sites could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or in an Instant Messenger request that takes users to the attacker's Web site. It could also be possible to display specially crafted Web content by using banner advertisements or by using other methods to deliver Web content to affected systems.

**What systems are primarily at risk from the vulnerability?**

This vulnerability requires that a user be logged on and visit a Web site for any malicious action to occur. Therefore, any systems where Internet Explorer is used frequently, such as workstations or terminal servers, are at the most risk from this vulnerability. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this.

**I am running Internet Explorer for Windows Server 2003 or Windows Server 2008. Does this mitigate this vulnerability?**

Yes. By default, Internet Explorer on Windows Server 2003 and Windows Server 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92039). Enhanced Security Configuration is a group of preconfigured settings in Internet Explorer that can reduce the likelihood of a user or administrator downloading and running specially crafted Web content on a server. This is a mitigating factor for Web sites that you have not added to the Internet Explorer Trusted sites zone. See also [Managing Internet Explorer Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92055).

**What is the ActiveX opt-in feature in Windows Internet Explorer 7?**

Windows Internet Explorer 7 includes an ActiveX opt-in feature, which means that nearly all pre-installed ActiveX controls are off by default. Users are prompted by the Information Bar before they can instantiate a previously installed ActiveX control that has not yet been used on the Internet. This enables a user to permit or deny access on a control-by-control basis. For more information about this and other new features, see the [Windows Internet Explorer 7 features page](https://www.microsoft.com/windows/products/winfamily/ie/features.mspx).

**What does the update do?**

The security update addresses the vulnerability by performing additional parameter validation.

For affected versions of ISA Server, the update sets the [kill bit](https://support.microsoft.com/kb/240797) for all OWC CLSIDs blocking known attack vectors within Internet Explorer. This action does not affect ISA Server functionality.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

While the initial report was provided through responsible disclosure, the vulnerability was later disclosed publicly by a separate party. This security bulletin addresses the publicly disclosed vulnerability, as well as additional issues discovered through internal investigations. This vulnerability was first described in [Microsoft Security Advisory 973472](https://technet.microsoft.com/security/advisory/973472).

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

Yes. Microsoft is aware of limited, targeted attacks attempting to exploit the vulnerability.

## Office Web Components Buffer Overflow Vulnerability - CVE-2009-1534

A remote code execution vulnerability exists in the Office Web Components ActiveX Control. An attacker could exploit the vulnerability by constructing a specially crafted Web page. When a user views the Web page, the vulnerability could allow remote code execution. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user.

To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2009-1534](https://www.cve.org/CVERecord?id=CVE-2009-1534).

#### Mitigating Factors for Office Web Components Buffer Overflow Vulnerability - CVE-2009-1534

Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:

* By default, Internet Explorer on Windows Server 2003 and 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://msdn.microsoft.com/library/default.asp?url=/workshop/security/szone/overview/esc_changes.asp). This mode mitigates this vulnerability. See the FAQ section of this security update for more information about Internet Explorer Enhanced Security Configuration.
* By default, Outlook Express 6, Outlook 2002, and Outlook 2003 open HTML e-mail messages in the Restricted sites zone. Additionally, Outlook 98 and Outlook 2000 open HTML e-mail messages in the Restricted sites zone if the [Outlook E-mail Security Update](https://go.microsoft.com/fwlink/?linkid=33334) has been installed. Outlook Express 5.5 Service Pack 2 opens HTML e-mail messages in the Restricted sites zone if [Microsoft Security Bulletin MS04-018](https://go.microsoft.com/fwlink/?linkid=19527) has been installed.
  The Restricted sites zone helps reduce attacks that could try to exploit this vulnerability by preventing ActiveX controls from being used when reading HTML e-mail messages. However, if a user clicks a link in an e-mail message, they could still be vulnerable to this issue through the Web-based attack scenario.
* In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site.
* An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

#### Workarounds for Office Web Components Buffer Overflow Vulnerability - CVE-2009-1534

Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:

* **Prevent Office Web Components Library from running in Internet Explorer**.

  You can prevent the Office Web Components Library from running in Internet Explorer by setting the kill bit for the control in the registry.

  **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.

  **Note** We recommend backing up the registry before you edit it.

  **Note** This is the action taken by the ISA Server update package. No binaries are included in this update for ISA Server.

  For detailed steps that you can use to prevent a control from running in Office Web Components, see [Microsoft Knowledge Base Article 240797](https://support.microsoft.com/kb/240797). Follow these steps in this article to create a Compatibility Flags value in the registry to prevent the Office Web Components library from running.

  **Note** The Class Identifiers and corresponding files where the library objects are contained are documented in the FAQ "What does the update do?"

  + To set the kill bit for a CLSID with a value of {0002E512-0000-0000-C000-000000000046}, paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension.
    Windows Registry Editor Version 5.00
    [HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{0002E512-0000-0000-C000-000000000046}]
    "Compatibility Flags"=dword:00000400

  You can apply this .reg file to individual systems by double-clicking it. You can also apply it across domains by using Group Policy. For more information about Group Policy, visit the following Microsoft Web sites:

  + [Group Policy Collection](https://technet.microsoft.com/windowsserver/en/library/6d7cb788-b31d-4d17-9f1e-b5ddaa6deecd)
  + [What is Group Policy Object Editor?](https://technet.microsoft.com/windowsserver/en/library/47ba1311-6cca-414f-98c9-2d7f99fca8a3)
  + [Core Group Policy Tools and Settings](https://technet.microsoft.com/windowsserver/en/library/e926577a-5619-4912-b5d9-e73d4bdc9491)

  **Note** You must restart Internet Explorer for your changes to take effect.

  **Impact of Workaround**: After the kill bit is set, you will no longer be able to use the OWC Spreadsheet functionality within the Office Web Components ActiveX Control in Internet Explorer, Microsoft Office, or any application that honors kill bits. This will not affect the standard operation of Microsoft Office and most users will not notice any change after setting the kill bit. OWC is primarily used by Web applications, including internal business applications, Microsoft Office Project Web Access, and the [Office 2003 Add-in: Web Parts and Components](https://www.microsoft.com/download/details.aspx?familyid=38be67a5-2056-46a1-84b1-337ffb549c5c&displaylang;=en). It may also be used in some VBA solutions within Microsoft Office. Once the kill bit is set, these applications will not be able to use any functionality that relies on the OWC Spreadsheet control within the Office Web Components ActiveX Control.

  **How to undo the Workaround**: You can undo the workaround documented above by following these steps:

  **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.

  **Note** We recommend backing up the registry before you edit it.

  + To undo the kill bit for a CLSID with a value of {0002E512-0000-0000-C000-000000000046}, paste the following text in a text editor such as Notepad. Then, save the file by using the .reg file name extension.
    Windows Registry Editor Version 5.00
    [-HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{0002E512-0000-0000-C000-000000000046}]
* **Unregister the Office Web Components Library**

  **Note** This action will not work on an ISA Server computer because:

  + The Office Web components are installed in the ISA Server program directory (â%ProgramFiles%\Microsoft ISA Serverâ by default)
  + The Office Web Components are re-registered by the ISA Server report job mechanism each time a report job is executed.

  **Warning** If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use the Registry Editor at your own risk. For information about how to edit the registry, view the "Changing Keys And Values" Help topic in Registry Editor (Regedit.exe) or view the "Add and Delete Information in the Registry" and "Edit Registry Data" Help topics in Regedt32.exe.

  **Note** We recommend backing up the registry before you edit it.

  + For Office 2000, type the following at the command prompt and select **Run:**
    Regsvr32.exe /u "C:\Program Files\Microsoft Office\Office\msowc.dll"
  + For Office XP, type the following at the command prompt and select **Run:**
    Regsvr32.exe /u "C:\Program Files\Microsoft Office\Office10\msowc.dll"

  **Impact of Workaround**: Applications requiring Office Web Components functionality will not function.

  **How to undo the Workaround:** To re-register the Office Web Components, follow these steps:

  + For Office 2000, type the following at the command prompt and select **Run:**
    Regsvr32.exe "C:\Program Files\Microsoft Office\Office\msowc.dll"
  + For Office XP, type the following at the command prompt and select **Run:**
    Regsvr32.exe "C:\Program Files\Microsoft Office\Office10\msowc.dll
* **Restrict Web sites to only your trusted Web sites**

  After you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to Internet Explorer's Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.

  To do this, follow these steps:

  1. In Internet Explorer, click **Tools**, click **Internet Options**, and then click the **Security** tab.
  2. In the **Select a Web content zone to specify its current security settings** box, click **Trusted Sites**, and then click **Sites**.
  3. If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:) for all sites in this zone** check box.
  4. In the **Add this Web site to the zone** box, type the URL of a site that you trust, and then click **Add**.
  5. Repeat these steps for each site that you want to add to the zone.
  6. Click **OK** two times to accept the changes and return to Internet Explorer.

  Add any sites that you trust not to take malicious action on your computer. Two in particular that you may want to add are "\*.windowsupdate.microsoft.com" and "\*.update.microsoft.com" (without the quotation marks). This is the site that will host the update, and it requires an ActiveX control to install the update.
* **Set Internet and Local intranet security zone settings to "High" to prompt before running ActiveX controls in these zones**

  You can help protect against these vulnerabilities by changing your settings for the Internet security zone to prompt before running ActiveX controls. You can do this by setting your browser security to **High**.

  To raise the browsing security level in Microsoft Internet Explorer, follow these steps:

  1. On the Internet Explorer **Tools** menu, click **Internet Options**.
  2. In the **Internet Options** dialog box, click the **Security** tab, and then click the **Internet** icon.
  3. Under **Security level for this zone**, move the slider to **High**. This sets the security level for all Web sites you visit to High.

  **Note** If no slider is visible, click **Default Level**, and then move the slider to **High**.

  **Note** Setting the level to **High** may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting, and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly even with the security setting set to **High**.

#### FAQ for Office Web Components Buffer Overflow Vulnerability - CVE-2009-1534

**What is the scope of the vulnerability?**

This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

**What causes the vulnerability?**

When the ActiveX control is used in Internet Explorer, the control may corrupt the system state in such a way that an attacker could run arbitrary code.

**What are Office Web Components?**

Microsoft Office Web Components are a collection of Component Object Model (COM) controls for publishing spreadsheets, charts, and databases to the Web, and for viewing the published components on the Web.

**What might an attacker use the vulnerability to do?**

If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.

**How could an attacker exploit the vulnerability?**

An attacker could exploit the vulnerability by hosting a specially crafted Web site that is designed to invoke the ActiveX control through Internet Explorer. This can also include compromised Web sites and Web sites that accept or host user-provided content or advertisements. These Web sites could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or in an Instant Messenger request that takes users to the attacker's Web site. It could also be possible to display specially crafted Web content by using banner advertisements or by using other methods to deliver Web content to affected systems.

**What systems are primarily at risk from the vulnerability?**

This vulnerability requires that a user be logged on and visit a Web site for any malicious action to occur. Therefore, any systems where Internet Explorer is used frequently, such as workstations or terminal servers, are at the most risk from this vulnerability. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this.

**I am running Internet Explorer for Windows Server 2003 or Windows Server 2008. Does this mitigate this vulnerability?**

Yes. By default, Internet Explorer on Windows Server 2003 and Windows Server 2008 runs in a restricted mode that is known as [Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92039). Enhanced Security Configuration is a group of preconfigured settings in Internet Explorer that can reduce the likelihood of a user or administrator downloading and running specially crafted Web content on a server. This is a mitigating factor for Web sites that you have not added to the Internet Explorer Trusted sites zone. See also [Managing Internet Explorer Enhanced Security Configuration](https://go.microsoft.com/fwlink/?linkid=92055).

**What is the ActiveX opt-in feature in Windows Internet Explorer 7?**

Windows Internet Explorer 7 includes an ActiveX opt-in feature, which means that nearly all pre-installed ActiveX controls are off by default. Users are prompted by the Information Bar before they can instantiate a previously installed ActiveX control that has not yet been used on the Internet. This enables a user to permit or deny access on a control-by-control basis. For more information about this and other new features, see the [Windows Internet Explorer 7 features page](https://www.microsoft.com/windows/products/winfamily/ie/features.mspx).

**What does the update do?**

The update removes the vulnerability by validating property values with boundary checks when the ActiveX control is used in Internet Explorer.

**When this security bulletin was issued, had this vulnerability been publicly disclosed?**

No. Microsoft received information about this vulnerability through responsible disclosure.

**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**

No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers and had not seen any examples of proof of concept code published when this security bulletin was originally issued.

### Update Information

## Detection and Deployment Tools and Guidance

Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](https://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](https://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products.

Security updates are available from [Microsoft Update](https://go.microsoft.com/fwlink/?linkid=40747) and [Windows Update](https://go.microsoft.com/fwlink/?linkid=21130). Security updates are also available from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for "security update."

Finally, security updates can be downloaded from the [Microsoft Update Catalog](https://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, "MS07-036"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](https://go.microsoft.com/fwlink/?linkid=97900).

**Note** Starting August 1, 2009, Microsoft will discontinue support for Office Update and the Office Update Inventory Tool. To continue getting the latest updates for Microsoft Office products, use [Microsoft Update](https://go.microsoft.com/fwlink/?linkid=40747). For more information, see [About Office Update: Frequently Asked Questions](https://office.microsoft.com/downloads/fx010402221033.aspx).

**Detection and Deployment Guidance**

Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see [Microsoft Knowledge Base Article 961747](https://support.microsoft.com/kb/961747).

**Microsoft Baseline Security Analyzer**

Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](https://www.microsoft.com/technet/security/tools/mbsahome.mspx).

The following table provides the MBSA detection summary for this security update.

| Software | MBSA 2.1 |
| --- | --- |
| Microsoft Office XP Service Pack 3 | Yes |
| Microsoft Office 2003 Service Pack 3 | Yes |
| Microsoft Office 2000 Web Components Service Pack 3 | No |
| Microsoft Office XP Web Components Service Pack 3 | Yes |
| Microsoft Office 2003 Web Components Service Pack 3 | Yes |
| Microsoft Office 2003 Web Components Service Pack 1 for the 2007 Microsoft Office System | Yes |
| Microsoft Internet Security and Acceleration Server 2004 Standard Edition Service Pack 3 | Yes |
| Microsoft Internet Security and Acceleration Server 2004 Enterprise Edition Service Pack 3 | Yes |
| Microsoft Internet Security and Acceleration Server 2006 Standard Edition Service Pack 1 | Yes |
| Microsoft Internet Security and Acceleration Server 2006 Enterprise Edition Service Pack 1 | Yes |
| Microsoft BizTalk Server 2002 | Yes |
| Microsoft Visual Studio .NET 2003 Service Pack 1 | No |
| Microsoft Office Small Business Accounting 2006 | Yes |

For more information about MBSA 2.1, see [MBSA 2.1 Frequently Asked Questions](https://www.microsoft.com/technet/security/tools/mbsa2/qa.mspx).

**Note** For customers using legacy software not supported by MBSA 2.1, Microsoft Update, and Windows Server Update Services: please visit [Microsoft Baseline Security Analyzer](https://www.microsoft.com/technet/security/tools/mbsahome.mspx) and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools.

**Windows Server Update Services**

By using Windows Server Update Services (WSUS), administrators can deploy the latest critical updates and security updates for Windows 2000 operating systems and later, Office XP and later, Exchange Server 2003, and SQL Server 2000. For more information about how to deploy this security update using Windows Server Update Services, visit the [Windows Server Update Services Web site](https://go.microsoft.com/fwlink/?linkid=50120).

**Systems Management Server**

The following table provides the SMS detection and deployment summary for this security update.

| Software | SMS 2.0 | SMS 2003 with SUIT | SMS 2003 with ITMU | Configuration Manager 2007 |
| --- | --- | --- | --- | --- |
| Microsoft Office XP Service Pack 3 | No | No | Yes | Yes |
| Microsoft Office 2003 Service Pack 3 | No | No | Yes | Yes |
| Microsoft Office 2000 Web Components Service Pack 3 | No | No | No | No |
| Microsoft Office XP Web Components Service Pack 3 | No | No | Yes | Yes |
| Microsoft Office 2003 Web Components Service Pack 3 | No | No | Yes | Yes |
| Microsoft Office 2003 Web Components Service Pack 1 for the 2007 Microsoft Office System | No | No | Yes | Yes |
| Microsoft Internet Security and Acceleration Server 2004 Standard Edition Service Pack 3 | No | No | Yes | Yes |
| Microsoft Internet Security and Acceleration Server 2004 Enterprise Edition Service Pack 3 | No | No | Yes | Yes |
| Microsoft Internet Security and Acceleration Server 2006 Standard Edition Service Pack 1 | No | No | Yes | Yes |
| Microsoft Internet Security and Acceleration Server 2006 Enterprise Edition Service Pack 1 | No | No | Yes | Yes |
| Microsoft BizTalk Server 2002 | Yes | Yes | Yes | Yes |
| Microsoft Visual Studio .NET 2003 Service Pack 1 | Yes | Yes | No | No |
| Microsoft Office Small Business Accounting 2006 | No | No | Yes | Yes |

For SMS 2.0 and SMS 2003, the Security Update Inventory Tool (SUIT) can be used by SMS to detect security updates. See also [Downloads for Systems Management Server 2.0](https://technet.microsoft.com/sms/bb676799.aspx).

For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](https://update.microsoft.com/microsoftupdate) and that are supported by [Windows Server Update Services](https://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](https://technet.microsoft.com/sms/bb676783.aspx). For more information about SMS scanning tools, see [SMS 2003 Software Update Scanning Tools](https://technet.microsoft.com/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](https://technet.microsoft.com/sms/bb676766.aspx).

System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](https://technet.microsoft.com/library/bb735860.aspx).

For more information about SMS, visit the [SMS Web site](https://go.microsoft.com/fwlink/?linkid=21158).

For more detailed information, see [Microsoft Knowledge Base Article 910723](https://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles.

**Note** If you have used an Administrative Installation Point (AIP) for deploying Office 2000, Office XP or Office 2003, you may not be able to deploy the update using SMS if you have updated the AIP from the original baseline. For more information, see the **Office Administrative Installation Point** heading in this section.

**Office Administrative Installation Point**

If you installed your application from a server location, the server administrator must update the server location with the administrative update and deploy that update to your system.

* For supported versions of Microsoft Office 2000, see [How to Create an Administrative Installation Point](https://office.microsoft.com/ork2000/ha011380221033.aspx). For more information about how to change the source for a client system from an updated administrative installation point to an Office 2000 Service Pack 3 (SP3), see [Microsoft Knowledge Base Article 932889](https://support.microsoft.com/kb/932889).

  **Note** If you plan to manage software updates centrally from an updated administrative image, you can find more information in the article [Updating Office 2000 Clients from a Patched Administrative Image](https://office.microsoft.com/ork2000/ha011525661033.aspx?pid=ch102053491033).
* For supported versions of Microsoft Office XP, see [Creating an Administrative Installation Point](https://office.microsoft.com/orkxp/ha011363091033.aspx). For more information on how to change the source for a client system from an updated administrative installation point to an Office XP original baseline source, see [Microsoft Knowledge Base Article 922665](https://support.microsoft.com/kb/922665).

  **Note** If you plan to manage software updates centrally from an updated administrative image, you can find more information in the article [Updating Office XP Clients from a Patched Administrative Image](https://office.microsoft.com/orkxp/ha011525721033.aspx).
* For supported versions of Microsoft Office 2003, see [Creating an Administrative Installation Point](https://office.microsoft.com/ork2003/ha011401931033.aspx). For more information on how to change the source for a client computer from an updated administrative installation point to an Office 2003 original baseline source or Service Pack 3 (SP3), see [Microsoft Knowledge Base Article 902349](https://support.microsoft.com/kb/902349).

  **Note** If you plan to manage software updates centrally from an updated administrative image, you can find more information in the article, [Distributing Office 2003 Product Upgrades](https://office.microsoft.com/ork2003/ha011402381033.aspx?pid=ch011480761033).
* For supported versions of the 2007 Microsoft Office system, see [Create a network installation point for the 2007 Office system](https://technet.microsoft.com/library/cc179063.aspx).

  **Note** If you plan to manage security updates centrally, use Windows Server Update Services. For more information about how to deploy security updates for the 2007 Microsoft Office system using Windows Server Update Services, visit the [Windows Server Update Services Web site](https://go.microsoft.com/fwlink/?linkid=50120).

**Update Compatibility Evaluator and Application Compatibility Toolkit**

Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](https://technet.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de) components included with [Application Compatibility Toolkit 5.0](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang;=en).

The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment.

## Security Update Deployment

**Affected Software**

For information about the specific security update for your affected software, click the appropriate link:

#### Office XP, Office XP Web Components, and Office 2000 Web Components (all editions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

| **Inclusion in Future Service Packs** | There are no more service packs planned for this software. The update for this issue may be included in a future update rollup. |
| --- | --- |
| **Deployment** |  |
| Installing without user intervention | OfficeXP-KB947320-FullFile-enu /q:a |
| Installing without restarting | OfficeXP-KB947320-FullFile-enu /r:n |
| Update log file | Not applicable |
| Further information | For detection and deployment, see the earlier section, **Detection and Deployment Tools and Guidance.** \ \ For features you can selectively install, see the **Office Features for Administrative Installations** subsection in this section. |
| **Restart Requirement** |  |
| Restart required? | In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.\ \ To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see [Microsoft Knowledge Base Article 887012](https://support.microsoft.com/kb/887012). |
| Hotpatching | Not applicable |
| **Removal Information** | After you install the update, you cannot remove it. To revert to an installation before the update was installed; you must remove the application, and then install it again from the original media. |
| **File Information** | See [Microsoft Knowledge Base Article 947320](https://support.microsoft.com/kb/947320) |
| **Registry Key Verification** | Not applicable |

#### Office Features

The following table contains the list of feature names (case sensitive) that must be reinstalled for the update. To install all features, you can use **REINSTALL=ALL** or you can install the following features:

| Product | Feature |
| --- | --- |
| ACCESS, PROPLUS, PRO | OfficeWebComponents,ACCESSNonBootFiles,OfficeWebComponents10 |
| FP, PIPC1, SBE, STD, STDEDU, EXCEL | OfficeWebComponents,OfficeWebComponents10 |
| OWC10, OWC10SE | ProductFiles |
| ACCESSRT | OfficeWebComponents,ACCESSNonBootFiles |
| PRJPRO, PRJSTD | OfficeWebComponents10 |
| 6626.0\_o10pro\_cexs\_bgr\_PRO, 6626.0\_o10pro\_CEXS\_ETI\_PRO, 6626.0\_o10pro\_CEXS\_LTH\_PRO, 6626.0\_o10pro\_CEXS\_LVI\_PRO, 6626.0\_o10pro\_crxs\_bgr\_PRORET, 6626.0\_o10pro\_CRXS\_ETI\_PRORET, 6626.0\_o10pro\_CRXS\_LTH\_PRORET, 6626.0\_o10pro\_CRXS\_LVI\_PRORET | OfficeWebComponents,ACCESSNonBootFiles,OfficeWebComponents10\_1033 |
| 6626.0\_O10PRO\_CEXS\_HRV\_PRO, 6626.0\_O10PRO\_CRXS\_HRV\_PRORET | OfficeWebComponents,OfficeWebComponents10\_1033,ACCESSNonBootFiles |
| 6626.0\_o10sbe\_COXS\_BGR\_SBERET, 6626.0\_o10sbe\_COXS\_ETI\_SBERET, 6626.0\_o10sbe\_COXS\_LTH\_SBERET, 6626.0\_o10sbe\_COXS\_LVI\_SBERET, 6626.0\_O10SBE\_CRXS\_HRV\_SBERET, 6626.0\_o10std\_cexs\_bgr\_STD, 6626.0\_o10std\_crxs\_bgr\_STDRET | OfficeWebComponents,OfficeWebComponents10\_1033 |

**Note** Administrators working in managed environments can find complete resources for deploying Office updates in an organization at the Office Admin Update Center. At that site, scroll down and look under the **Update Resources** section for the software version you are updating. The [Windows Installer Documentation](https://go.microsoft.com/fwlink/?linkid=21685) also provides more information about the parameters supported by Windows Installer.

#### Deployment Information

**Installing the Update**

You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection.

This security update requires that Windows Installer 2.0 or later be installed on the system. All supported versions of Windows include Windows Installer 2.0 or a later version.

To install the 2.0 or later version of Windows Installer, visit one of the following Microsoft Web sites:

* [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang;=en)
* [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang;=en)
* [Windows Installer 2.0 Redistributable for Windows 2000 and Windows NT 4.0](https://go.microsoft.com/fwlink/?linkid=33338)

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

Supported Security Update Installation Switches

| Switch | Description |
| --- | --- |
| **/q** | Specifies quiet mode, or suppresses prompts, when files are being extracted. |
| **/q:u** | Specifies user-quiet mode, which presents some dialog boxes to the user. |
| **/q:a** | Specifies administrator-quiet mode, which does not present any dialog boxes to the user. |
| **/t:path** | Specifies the target folder for extracting files. |
| **/c** | Extracts the files without installing them. If **/t:path** is not specified, you are prompted for a target folder. |
| **/c:path** | Overrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file. |
| **/r:n** | Never restarts the system after installation. |
| **/r:I** | Prompts the user to restart the system if a restart is required, except when used with **/q:a**. |
| **/r:a** | Always restarts the system after installation. |
| **/r:s** | Restarts the system after installation without prompting the user. |
| **/n:v** | No version checking - Install the program over any earlier version. |

**Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841).

**Removing the Update**

After you install the update, you cannot remove it. To revert to an installation before the update was installed; you must remove the application, and then install it again from the original media.

**Verifying That the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, **Detection and Deployment Tools and Guidance**, earlier in this bulletin for more information.
* **File Version Verification**

  Because there are several versions and editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

  1. Click **Start**, and then click **Search**.
  2. In the **Search Results** pane, click **All files and folders** under **Search Companion**.
  3. In the **All or part of the file name** box, type a file name from the appropriate file information table, and then click **Search**.
  4. In the list of files, right-click a file name from the appropriate file information table, and then click **Properties**.

     **Note** Depending on the version of the operating system or programs installed, some of the files that are listed in the file information table may not be installed.
  5. On the **Version** tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.

     **Note** Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.

#### Office 2003, Office 2003 Web Components, and Office 2003 Web Components for the 2007 Microsoft Office system (all editions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

| **Inclusion in Future Service Packs** | There are no more service packs planned for this software. The update for this issue may be included in a future update rollup. |
| --- | --- |
| **Deployment** |  |
| Installing without user intervention | For Microsoft Office 2003 Service Pack 3 and Microsoft Office 2003 Web Components:\ Office2003-KB947319-FullFile-enu /q:a\ \ For Microsoft Office 2003 Web Components Service Pack 1 for the 2007 Microsoft Office System:\ Office2007-KB947318-FullFile-x86-en /q:a |
| Installing without restarting | For Microsoft Office 2003 Service Pack 3 and Microsoft Office 2003 Web Components:\ Office2003-KB947319-FullFile-enu /r:n\ \ For Microsoft Office 2003 Web Components Service Pack 1 for the 2007 Microsoft Office System:\ Office2007-KB947318-FullFile-x86-en /r:n |
| Update log file | Not applicable |
| Further information | For detection and deployment, see the earlier section, **Detection and Deployment Tools and Guidance.** \ \ For features you can selectively install, see the **Office Features for Administrative Installations** subsection in this section. |
| **Restart Requirement** |  |
| Restart required? | In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.\ \ To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see [Microsoft Knowledge Base Article 887012](https://support.microsoft.com/kb/887012). |
| Hotpatching | Not applicable |
| **Removal Information** | For Microsoft Office 2003 Service Pack 3 and Microsoft Office 2003 Web Components:\ After you install the update, you cannot remove it. To revert to an installation before the update was installed; you must remove the application, and then install it again from the original media.\ \ For Microsoft Office 2003 Web Components Service Pack 1 for the 2007 Microsoft Office System:\ Use Add or Remove Programs tool in Control Panel. |
| **File Information** | For Microsoft Office 2003 Service Pack 3 and Microsoft Office 2003 Web Components:\ See [Microsoft Knowledge Base Article 947319](https://support.microsoft.com/kb/947319)\ \ For Microsoft Office 2003 Web Components Service Pack 1 for the 2007 Microsoft Office System:\ See [Microsoft Knowledge Base Article 947318](https://support.microsoft.com/kb/947318) |
| **Registry Key Verification** | Not applicable |

#### Office Features

The following table contains the list of feature names (case sensitive) that must be reinstalled for the update. To install all features, you can use **REINSTALL=ALL** or you can install the following features:

| Product | Feature |
| --- | --- |
| ACCESSRT, ACC11 | ACCESSNonBootFiles,ProductFiles |
| OUTLS11, VISVEA, PPT11, FP11, ONOTE11, OUTL11, OUTLSM11, PUB11, INF11, PRJPROE, PRJPRO, PRJSTDE, PRJSTD, VISPRO, VISPROR, VISSTD, VISSTDR | ProductFiles |
| XLVIEW | ExcelViewer |
| WORDVIEW | WORDVIEWFiles |
| RMS | RMSFiles,ProductFiles |
| BASIC11, PERS11, STDP11, STD11 | WORDNonBootFiles,EXCELNonBootFiles,ProductFiles |
| PRO11SB, PROI11, PRO11 | WORDNonBootFiles,ACCESSNonBootFiles,EXCELNonBootFiles,ProductFiles |
| WORD11 | WORDNonBootFiles,ProductFiles |
| EXCEL11 | EXCELNonBootFiles,ProductFiles |

**Note** Administrators working in managed environments can find complete resources for deploying Office updates in an organization at the Office Admin Update Center. At that site, scroll down and look under the **Update Resources** section for the software version you are updating. The [Windows Installer Documentation](https://go.microsoft.com/fwlink/?linkid=21685) also provides more information about the parameters supported by Windows Installer.

#### Deployment Information

**Installing the Update**

You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection.

This security update requires that Windows Installer 2.0 or later be installed on the system. All supported versions of Windows include Windows Installer 2.0 or a later version.

To install the 2.0 or later version of Windows Installer, visit one of the following Microsoft Web sites:

* [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang;=en)
* [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang;=en)
* [Windows Installer 2.0 Redistributable for Windows 2000 and Windows NT 4.0](https://go.microsoft.com/fwlink/?linkid=33338)

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

Supported Security Update Installation Switches

| Switch | Description |
| --- | --- |
| **/q** | Specifies quiet mode, or suppresses prompts, when files are being extracted. |
| **/q:u** | Specifies user-quiet mode, which presents some dialog boxes to the user. |
| **/q:a** | Specifies administrator-quiet mode, which does not present any dialog boxes to the user. |
| **/t:path** | Specifies the target folder for extracting files. |
| **/c** | Extracts the files without installing them. If **/t:path** is not specified, you are prompted for a target folder. |
| **/c:path** | Overrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file. |
| **/r:n** | Never restarts the system after installation. |
| **/r:I** | Prompts the user to restart the system if a restart is required, except when used with **/q:a**. |
| **/r:a** | Always restarts the system after installation. |
| **/r:s** | Restarts the system after installation without prompting the user. |
| **/n:v** | No version checking - Install the program over any earlier version. |

**Note** You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841).

**Removing the Update**

To remove this security update, use the Add or Remove Programs tool in Control Panel.

**Note** When you remove this update, you may be prompted to insert the Microsoft Office 2003 CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs tool in Control Panel. There are several possible causes for this issue. For more information about the removal, see [Microsoft Knowledge Base Article 903771](https://support.microsoft.com/kb/903771).

**Verifying that the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, **Detection and Deployment Tools and Guidance**, earlier in this bulletin for more information.
* **File Version Verification**

  Because there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

  1. Click **Start** and then enter an update file name in **Start Search**.
  2. When the file appears under **Programs**, right-click on the file name and click **Properties**.
  3. Under the **General** tab, compare the file size with the file information tables provided in the bulletin KB article.
  4. You may also click on the **Details** tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.
  5. Finally, you may also click on the **Previous Versions** tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file.

#### Internet Security and Acceleration Server 2004 and Internet Security and Acceleration Server 2006 (all editions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

|  |  |
| --- | --- |
| **Inclusion in Future Service Packs** | There are no more service packs planned for this software. The update for this issue may be included in a future update rollup. |
| **Deployment** |  |
| Installing without user intervention | ISAServer-KB947826-FullFile-x86-glb /quiet |
| Installing without restarting | ISAServer-KB947826-FullFile-x86-glb /norestart |
| Update log file | Not applicable |
| Further information | See the subsection, **Detection and Deployment Tools and Guidance.** |
| **Restart Requirement** |  |
| Restart required? | Not required |
| Hotpatching | Not applicable |
| **Removal Information** | This update cannot be uninstalled from Add or Remove Programs in the Control Panel. To undo the kill bit, please see the workaround section on how to perform this action manually. |
| **File Information** | This update makes no changes to Internet Security and Acceleration (ISA) Server. Instead, this security update sets the kill bit in the registry for the Microsoft Office 2003 Web Components control. |
| **Registry Key Verification** | HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Self-Extractor\Package\{0002E55B-0000-0000-C000-000000000046} |

#### Deployment Information

**Installing the Update**

You can install the update from the appropriate download link in the Affected and Non-Affected Software section.

This security update requires that Windows Installer 2.0 or later be installed on the system. All supported versions of Windows include Windows Installer 2.0 or a later version.

To install the latest version of Windows Installer, visit one of the following Microsoft Web sites:

* [Windows Installer 3.1 Redistributable](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang;=en)
* [Windows Installer 2.0 Redistributable for Windows 2000 and Windows NT 4.0](https://go.microsoft.com/fwlink/?linkid=33338)
* [Windows Installer 2.0 Redistributable for Windows 95, Windows 98, Windows 98 SE, and Windows Millennium Edition](https://go.microsoft.com/fwlink/?linkid=33337)

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

Supported Security Update Installation Switches

| Switch | Description |
| --- | --- |
| **/?** or **/help** | Displays usage dialog. |
| **/passive** | Specifies passive mode. Requires no user interaction; users see basic progress dialogs but cannot cancel. |
| **/quiet** | Specifies quiet mode, or suppresses prompts, when files are being extracted. |
| **/norestart** | Suppresses restarting the system if the update requires a restart. |
| **/forcerestart** | Automatically restarts the system after applying the update, regardless of whether the update requires the restart. |
| **/extract** | Extracts the files without installing them. You are prompted for a target folder. |
| **/extract:<path>** | Overrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file. |
| **/lang:<LCID>** | Forces the use of a specific language, when the update package supports that language. |
| **/log:<log file>** | Enables logging, by both Vnox and Installer, during the update installation. |

**Note** You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841).

**Verifying That the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you can use the Microsoft Baseline Security Analyzer (MBSA) tool. MBSA allows administrators to scan local and remote systems for missing security updates and for common security misconfigurations. For more information about MBSA, visit the [Microsoft Baseline Security Analyzer Web site](https://go.microsoft.com/fwlink/?linkid=21134).
* **Update Installation Verification**

  Because there are no files included in the update for ISA Server, validation of a successful installation can be performed by verifying the following registry key:

  Windows Registry Editor Version 5.00

  HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Internet Explorer\ActiveX Compatibility\{0002E55B-0000-0000-C000-000000000046}]

  "Compatibility Flags"=dword:00000400

#### Microsoft BizTalk Server (all editions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

|  |  |
| --- | --- |
| **Inclusion in Future Service Packs** | There are no more service packs planned for this software. The update for this issue may be included in a future update rollup. |
| **Deployment** |  |
| Installing without user intervention | MicrosoftBizTalkServer2002-KB971388-enu /q:a |
| Installing without restarting | MicrosoftBizTalkServer2002-KB971388-enu /r:n |
| Update log file | Not applicable |
| Further information | See the subsection, **Detection and Deployment Tools and Guidance.** |
| **Restart Requirement** |  |
| Restart required? | To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see [Microsoft Knowledge Base Article 887012](https://support.microsoft.com/kb/887012). |
| Hotpatching | Not applicable |
| **Removal Information** | Use Add or Remove Programs tool in Control Panel. |
| **File Information** | See [Microsoft Knowledge Base Article 971388](https://support.microsoft.com/kb/971388) |
| **Registry Key Verification** | Not applicable |

#### Deployment Information

**Installing the Update**

You can install the update from the appropriate download link in the Affected and Non-Affected Software section.

This security update requires that Windows Installer 2.0 or later be installed on the system. All supported versions of Windows include Windows Installer 2.0 or a later version.

To install the latest version of Windows Installer, visit one of the following Microsoft Web sites:

* [Windows Installer 3.1 Redistributable](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang;=en)
* [Windows Installer 2.0 Redistributable for Windows 2000 and Windows NT 4.0](https://go.microsoft.com/fwlink/?linkid=33338)
* [Windows Installer 2.0 Redistributable for Windows 95, Windows 98, Windows 98 SE, and Windows Millennium Edition](https://go.microsoft.com/fwlink/?linkid=33337)

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

Supported Security Update Installation Switches

| Switch | Description |
| --- | --- |
| **/q** | Specifies quiet mode, or suppresses prompts, when files are being extracted. |
| **/q:u** | Specifies user-quiet mode, which presents some dialog boxes to the user. |
| **/q:a** | Specifies administrator-quiet mode, which does not present any dialog boxes to the user. |
| **/t:path** | Specifies the target folder for extracting files. |
| **/c** | Extracts the files without installing them. If **/t:path** is not specified, you are prompted for a target folder. |
| **/c:path** | Overrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file. |
| **/r:n** | Never restarts the system after installation. |
| **/r:I** | Prompts the user to restart the system if a restart is required, except when used with **/q:a**. |
| **/r:a** | Always restarts the system after installation. |
| **/r:s** | Restarts the system after installation without prompting the user. |
| **/n:v** | No version checking - Install the program over any earlier version. |

**Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841). For more information about the Package Installer, visit the [Microsoft TechNet Web site](https://go.microsoft.com/fwlink/?linkid=38951).

**Removing the Update**

To remove this security update, use the Add or Remove Programs tool in Control Panel.

**Verifying That the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you can use the Microsoft Baseline Security Analyzer (MBSA) tool. MBSA allows administrators to scan local and remote systems for missing security updates and for common security misconfigurations. For more information about MBSA, visit the [Microsoft Baseline Security Analyzer Web site](https://go.microsoft.com/fwlink/?linkid=21134).
* **File Version Verification**

  Because there are several versions and editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

  1. Click **Start**, and then click **Search**.
  2. In the **Search Results** pane, click **All files and folders** under **Search Companion**.
  3. In the **All or part of the file name** box, type a file name from the appropriate file information table, and then click **Search**.
  4. In the list of files, right-click a file name from the appropriate file information table, and then click **Properties**.

     **Note** Depending on the version of the operating system or programs installed, some of the files that are listed in the file information table may not be installed.
  5. On the **Version** tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.

     **Note** Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.

#### Visual Studio .NET 2003 (all editions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

| **Inclusion in Future Service Packs** | Visual Studio .NET 2003 Service Pack 2 |
| --- | --- |
| **Deployment** |  |
| Installing without user intervention | VS7.1sp1-KB969172-x86-INTL /q |
| Installing without restarting | VS7.1sp1-KB969172-x86-INTL /norestart |
| Update log file | VS7.1SP1-KB969172-X86-intl-msi.0.log\ VS7.1SP1-KB969172-X86-intl-wrapper.log |
| Further information | See the subsection, **Detection and Deployment Tools and Guidance.** |
| **Restart Requirement** |  |
| Restart required? | To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see [Microsoft Knowledge Base Article 887012](https://support.microsoft.com/kb/887012). |
| Hotpatching | Not applicable |
| **Removal Information** | Use Add or Remove Programs tool in Control Panel. |
| **File Information** | See [Microsoft Knowledge Base Article 969172](https://support.microsoft.com/kb/969172) |
| **Registry Key Verification** | HKEY\_LOCAL\_MACHINE\Software\Microsoft\Updates\Visual Studio\7.1\M969172\ "Installed" = dword:1 |

#### Deployment Information

**Installing the Update**

You can install the update from the appropriate download link in the Affected and Non-Affected Software section.

This security update requires that Windows Installer 2.0 or later be installed on the system. All supported versions of Windows include Windows Installer 2.0 or a later version.

To install the latest version of Windows Installer, visit one of the following Microsoft Web sites:

* [Windows Installer 3.1 Redistributable](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang;=en)

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

| Switch | Description |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| /? or /h or /help | Display usage dialog box. |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| **Setup Mode** |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| /q[n | b | r | f] | Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI |  |  |  |  |  |  |  |  |  |  |  |
| /quiet | Same as /q |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| /passive | Same as /qb |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| **Install Options** |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| /extract [directory] | Extract the package to the specified directory |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| /uninstall or /u | Uninstall this update |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| /addsource or /as | Specifies the source path of the product msi. This option may be used when installing the the update results in a prompt to insert the installation source media for the product. For example:<update executable> /addsource "C:\Product MSI\Visual Studio\enu\vs\_setup.msi" /addsource "C:\Product MSI\Net\Netfx.msi" |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| **Restart Options** |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| /norestart | Do not restart after the installation is complete |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| /promptrestart | Prompts the user for restart if necessary |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| /forcerestart | Always restart the computer after installation |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| **Logging Options** |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| /l[i | w | e | a | r | u | c | m | o | p | v | x | + | ! | \*] <LogFile> | i - Status messagesw - Nonfatal warningse - All error messagesa - Start up of actionsr - Action-specific recordsu - User requestsc - Initial UI parametersm - Out-of-memory or fatal exit informationo - Out-of-disk-space messagesp - Terminal propertiesv - Verbose outputx - Extra debugging information+ - Append to existing log file! - Flush each line to the log\* - Log all information, except for v and x options |
| /log <LogFile> | Equivalent of /l\* <LogFile> |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| /sendreport | Send installation data for this update to Microsoft as a Watson report. No personally identifiable information is sent |  |  |  |  |  |  |  |  |  |  |  |  |  |  |

**Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841). For more information about the Package Installer, visit the [Microsoft TechNet Web site](https://go.microsoft.com/fwlink/?linkid=38951).

**Removing the Update**

To remove this security update, use the Add or Remove Programs tool in Control Panel.

**Verifying That the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you can use the Microsoft Baseline Security Analyzer (MBSA) tool. MBSA allows administrators to scan local and remote systems for missing security updates and for common security misconfigurations. For more information about MBSA, visit the [Microsoft Baseline Security Analyzer Web site](https://go.microsoft.com/fwlink/?linkid=21134).
* **File Version Verification**

  Because there are several versions and editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

  1. Click **Start**, and then click **Search**.
  2. In the **Search Results** pane, click **All files and folders** under **Search Companion**.
  3. In the **All or part of the file name** box, type a file name from the appropriate file information table, and then click **Search**.
  4. In the list of files, right-click a file name from the appropriate file information table, and then click **Properties**.

     **Note** Depending on the version of the operating system or programs installed, some of the files that are listed in the file information table may not be installed.
  5. On the **Version** tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.

     **Note** Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.

#### Microsoft Office Small Business Accounting 2006 (all editions)

**Reference Table**

The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section.

| **Inclusion in Future Service Packs** | The update for this issue will be included in a future service pack or update rollup |
| --- | --- |
| **Deployment** |  |
| Installing without user intervention | OfficeSmallBusinessAccounting2006-KB968377-FullFile-enu /passive |
| Installing without restarting | OfficeSmallBusinessAccounting2006-KB968377-FullFile-enu /norestart |
| Update log file | Not applicable |
| Further information | For detection and deployment, see the earlier section, **Detection and Deployment Tools and Guidance**. |
| **Restart Requirement** |  |
| Restart required? | In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.\ \ To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see [Microsoft Knowledge Base Article 887012](https://support.microsoft.com/kb/887012). |
| Hotpatching | Not applicable |
| **Removal Information** | Use **Add or Remove Programs** tool in Control Panel. |
| **File Information** | See [Microsoft Knowledge Base Article 968377](https://support.microsoft.com/kb/968377) |
| **Registry Key Verification** | Not applicable |

#### Deployment Information

**Installing the Update**

You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection.

This security update requires that Windows Installer 3.1 or later be installed on the system.

To install the 3.1 or later version of Windows Installer, visit one of the following Microsoft Web sites:

* [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang;=en)
* [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang;=en)

For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](https://support.microsoft.com/kb/824684).

This security update supports the following setup switches.

Supported Security Update Installation Switches

| Switch | Description |
| --- | --- |
| **/?** or **/help** | Displays usage dialog. |
| **/passive** | Specifies passive mode. Requires no user interaction; users see basic progress dialogs but cannot cancel. |
| **/quiet** | Specifies quiet mode, or suppresses prompts, when files are being extracted. |
| **/norestart** | Suppresses restarting the system if the update requires a restart. |
| **/forcerestart** | Automatically restarts the system after applying the update, regardless of whether the update requires the restart. |
| **/extract** | Extracts the files without installing them. You are prompted for a target folder. |
| **/extract:<path>** | Overrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file. |
| **/lang:<LCID>** | Forces the use of a specific language, when the update package supports that language. |
| **/log:<log file>** | Enables logging, by both Vnox and Installer, during the update installation. |

**Note** You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](https://support.microsoft.com/kb/262841).

**Removing the Update**

To remove this security update, use the Add or Remove Programs tool in Control Panel.

**Note** When you remove this update, you may be prompted to insert the 2007 Microsoft Office CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs tool in Control Panel. There are several possible causes for this issue. For more information about the removal, see [Microsoft Knowledge Base Article 903771](https://support.microsoft.com/kb/903771).

**Verifying that the Update Has Been Applied**

* **Microsoft Baseline Security Analyzer**

  To verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, **Detection and Deployment Tools and Guidance**, earlier in this bulletin for more information.
* **File Version Verification**

  Because there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.

  1. Click **Start** and then enter an update file name in **Start Search**.
  2. When the file appears under **Programs**, right-click on the file name and click **Properties**.
  3. Under the **General** tab, compare the file size with the file information tables provided in the bulletin KB article.
  4. You may also click on the **Details** tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.
  5. Finally, you may also click on the **Previous Versions** tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file.

### Other Information

#### Acknowledgments

Microsoft [thanks](https://go.microsoft.com/fwlink/?linkid=21127) the following for working with us to help protect customers:

* Peter Vreugdenhil of [Zero Day Initiative](https://www.zerodayinitiative.com/) for reporting the Office Web Components Memory Allocation Vulnerability (CVE-2009-0562).
* Peter Vreugdenhil of [Zero Day Initiative](https://www.zerodayinitiative.com/) for reporting the Office Web Components Heap Corruption Vulnerability (CVE-2009-2496).
* Peter Vreugdenhil of [Zero Day Initiative](https://www.zerodayinitiative.com/) and Haifei Li of Fortinetâs [FortiGuard Global Security Research Team](https://www.fortiguardcenter.com/) for reporting the Office Web Components HTML Script Vulnerability (CVE-2009-1136).
* Sean Larsson of [VeriSign iDefense Labs](https://labs.idefense.com/) for reporting the Office Web Components Buffer Overflow Vulnerability (CVE-2009-1534).

#### Microsoft Active Protections Program (MAPP)

To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in [Microsoft Active Protections Program (MAPP) Partners](https://www.microsoft.com/security/msrc/mapp/partners.mspx).

#### Support

* Customers in the U.S. and Canada can receive technical support from [Security Support](https://go.microsoft.com/fwlink/?linkid=21131) or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see [Microsoft Help and Support](https://support.microsoft.com/).
* International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the [International Support Web site](https://go.microsoft.com/fwlink/?linkid=21155).

#### Disclaimer

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

#### Revisions

* V1.0 (August 11, 2009): Bulletin published.
* V1.1 (August 12, 2009): Corrected the restart requirement for Visual Studio .NET 2003; updated the tables in the **Detection and Deployment Tools and Guidance** section; updated the impact description of the workaround, "Prevent Office Web Components Library from running in Internet Explorer;" corrected the update installation switches for Internet Security and Acceleration Server 2004 and Internet Security and Acceleration Server 2006; and performed miscellaneous edits.
* V2.0 (October 27, 2009): Bulletin revised to communicate the rerelease of the update for Microsoft Office 2003 Service Pack 3 and Microsoft Office 2003 Web Components Service Pack 3 to fix a detection issue. This is a detection change only; there were no changes to the binaries. Customers who have successfully updated their systems do not need to reinstall this update.

*Built at 2014-04-18T13:49:36Z-07:00*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025


