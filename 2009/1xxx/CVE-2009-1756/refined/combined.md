=== Content from secunia.com_4163c206_20250124_214758.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from bugs.debian.org_1e571ba5_20250124_214755.html ===

# Debian Bug report logs - #529306 slim: insecure xauth secret

[![version graph](version.cgi?height=2;collapse=1;width=2;fixed=slim%2F1.3.1-2;absolute=0;found=slim%2F1.3.0-2;package=slim)](version.cgi?package=slim;found=slim%2F1.3.0-2;info=1;absolute=0;fixed=slim%2F1.3.1-2;collapse=1)

Package:
[slim](pkgreport.cgi?package=slim);
Maintainer for [slim](pkgreport.cgi?package=slim) is [Nobuhiro Iwamatsu <iwamatsu@debian.org>](pkgreport.cgi?maint=iwamatsu%40debian.org); Source for [slim](pkgreport.cgi?package=slim) is [src:slim](pkgreport.cgi?src=slim) ([PTS](https://tracker.debian.org/pkg/slim), [buildd](https://buildd.debian.org/slim), [popcon](https://qa.debian.org/popcon.php?package=slim)).

Reported by: [Nico Golde <nion@debian.org>](pkgreport.cgi?submitter=nion%40debian.org)

Date: Mon, 18 May 2009 14:57:01 UTC

Severity: *grave*

Tags: security

Found in version slim/1.3.0-2

Fixed in version slim/1.3.1-2

**Done:** Nobuhiro Iwamatsu <iwamatsu@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=529306;mbox=yes), [status mbox](bugreport.cgi?bug=529306;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=529306;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Mike Massonnet <mmassonnet@gmail.com>`:

`Bug#529306`; Package `slim`.
(Mon, 18 May 2009 14:57:04 GMT) ([full text](bugreport.cgi?bug=529306;msg=2), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Nico Golde <nion@debian.org>`:

New Bug report received and forwarded. Copy sent to `Mike Massonnet <mmassonnet@gmail.com>`.
(Mon, 18 May 2009 14:57:04 GMT) ([full text](bugreport.cgi?bug=529306;msg=4), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=529306;msg=5), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: slim: insecure xauth secret
Date: Mon, 18 May 2009 16:53:35 +0200
```
Package: slim
Version: 1.3.0-2
Severity: grave
Tags: security

Hi,
>From app.cpp:
1134 void App::CreateServerAuth() {
1135     /* create mit cookie */
1136     int i, r;
1137     int hexcount = 0;
1138         string authfile;
1139     string cmd;
1140     char *digits = "0123456789abcdef";
1141         srand( time(NULL) );
1142     for ( i = 0; i < 31; i++ ) {
1143         r = rand()%16;
1144                 mcookie[i] = digits[r];
1145                 if (r>9)
1146                         hexcount++;
1147     }
1148         /* MIT-COOKIE: even occurrences of digits and hex digits */
1149         if ((hexcount%2) == 0) {
1150                 r = rand()%10;
1151         } else {
1152                 r = rand()%5+10;
1153         }
1154         mcookie[31] = digits[r];
1155     /* reinitialize auth file */
1156     authfile = cfg->getOption("authfile");
1157     remove(authfile.c_str());
1158     putenv(StrConcat("XAUTHORITY=", authfile.c_str()));
1159     cmd = cfg->getOption("xauth_path") + " -q -f " + authfile + " add :0 . " + mcookie;
1160     system(cmd.c_str());
1161 }

This function is used to create the x authority file in /var/run which is
then copied into the users home directory on login. However this function somehow defeats the
purpose of xauth as the file itself is generated by executing xauth via system and includes
mcookie (the secret hex string) in the command line. So as an attacker I can watch the process
list, grab the mcookie string and generate my own x auth cookie to have fun with the victims
X session. The same problem exists in switchuser.cpp.

The easy fix would be to read this from stdin, xauth supports this. As small remark...
I think using the time as a source for random data is also suboptimal in this case.

Cheers
Nico

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Mike Massonnet <mmassonnet@gmail.com>`:

`Bug#529306`; Package `slim`.
(Wed, 20 May 2009 15:27:02 GMT) ([full text](bugreport.cgi?bug=529306;msg=7), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Eygene Ryabinkin <rea@codelabs.ru>`:

Extra info received and forwarded to list. Copy sent to `Mike Massonnet <mmassonnet@gmail.com>`.
(Wed, 20 May 2009 15:27:02 GMT) ([full text](bugreport.cgi?bug=529306;msg=9), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 529306@bugs.debian.org ([full text](bugreport.cgi?bug=529306;msg=10), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=rea%40codelabs.ru)
From: Eygene Ryabinkin <rea@codelabs.ru>
To: 529306@bugs.debian.org
Subject: [PATCH] Do not specify magic cookie for xauth in the xauth command
line
Date: Wed, 20 May 2009 19:24:10 +0400
```
Instead, open xauth as a pipe and feed commands via its stdin.

Signed-off-by: Eygene Ryabinkin <rea@codelabs.ru>
---
 Makefile         |    3 ++-
 Makefile.freebsd |    3 ++-
 Makefile.netbsd  |    3 ++-
 Makefile.openbsd |    3 ++-
 app.cpp          |    8 +++++---
 switchuser.cpp   |    7 ++++---
 util.cpp         |   32 ++++++++++++++++++++++++++++++++
 util.h           |   19 +++++++++++++++++++
 8 files changed, 68 insertions(+), 10 deletions(-)
 create mode 100644 util.cpp
 create mode 100644 util.h

diff --git a/Makefile b/Makefile
index f7d3d2d..240669d 100644
--- a/Makefile
+++ b/Makefile
@@ -25,7 +25,8 @@ VERSION=1.3.1
 DEFINES=-DPACKAGE=\"$(NAME)\" -DVERSION=\"$(VERSION)\" \
 		-DPKGDATADIR=\"$(PREFIX)/share/slim\" -DSYSCONFDIR=\"$(CFGDIR)\"

-OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o panel.o
+OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o \
+	panel.o util.o
 ifdef USE_PAM
 OBJECTS+=PAM.o
 endif
diff --git a/Makefile.freebsd b/Makefile.freebsd
index 3ff326e..c925a39 100644
--- a/Makefile.freebsd
+++ b/Makefile.freebsd
@@ -24,7 +24,8 @@ VERSION=1.3.1
 DEFINES=-DPACKAGE=\"$(NAME)\" -DVERSION=\"$(VERSION)\" \
 		-DPKGDATADIR=\"$(PREFIX)/share/slim\" -DSYSCONFDIR=\"$(CFGDIR)\"

-OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o panel.o
+OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o \
+	panel.o util.o
 .ifdef USE_PAM
   OBJECTS+=PAM.o
 .endif
diff --git a/Makefile.netbsd b/Makefile.netbsd
index ad8bb8b..45f33e6 100644
--- a/Makefile.netbsd
+++ b/Makefile.netbsd
@@ -24,7 +24,8 @@ VERSION=1.3.1
 DEFINES=-DPACKAGE=\"$(NAME)\" -DVERSION=\"$(VERSION)\" \
 		-DPKGDATADIR=\"$(PREFIX)/share/slim\" -DSYSCONFDIR=\"$(CFGDIR)\"

-OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o panel.o
+OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o \
+	panel.o util.o
 .ifdef USE_PAM
   OBJECTS+=PAM.o
 .endif
diff --git a/Makefile.openbsd b/Makefile.openbsd
index b1829f8..1205b84 100644
--- a/Makefile.openbsd
+++ b/Makefile.openbsd
@@ -20,7 +20,8 @@ VERSION=1.3.1
 DEFINES=-DPACKAGE=\"$(NAME)\" -DVERSION=\"$(VERSION)\" \
 		-DPKGDATADIR=\"$(PREFIX)/share/slim\" -DSYSCONFDIR=\"$(CFGDIR)\"

-OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o panel.o
+OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o \
+	util.o panel.o

 .SUFFIXES: .c.o .cpp.o

diff --git a/app.cpp b/app.cpp
index 83ae947..2502b0b 100644
--- a/app.cpp
+++ b/app.cpp
@@ -24,6 +24,7 @@
 #include <algorithm>
 #include "app.h"
 #include "numlock.h"
+#include "util.h"

 #ifdef HAVE_SHADOW
@@ -1162,7 +1163,8 @@ void App::replaceVariables(string& input,

 void App::CreateServerAuth() {
     /* create mit cookie */
-    int i, r;
+    bool r;
+    int i;
     int hexcount = 0;
         string authfile;
     string cmd;
@@ -1185,8 +1187,8 @@ void App::CreateServerAuth() {
     authfile = cfg->getOption("authfile");
     remove(authfile.c_str());
     putenv(StrConcat("XAUTHORITY=", authfile.c_str()));
-    cmd = cfg->getOption("xauth_path") + " -q -f " + authfile + " add :0 . " + mcookie;
-    system(cmd.c_str());
+    r = Util::add_mcookie(mcookie, ":0", cfg->getOption("xauth_path"),
+      authfile);
 }

 char* App::StrConcat(const char* str1, const char* str2) {
diff --git a/switchuser.cpp b/switchuser.cpp
index e72a8fc..ec298e1 100644
--- a/switchuser.cpp
+++ b/switchuser.cpp
@@ -10,6 +10,7 @@
 */

 #include "switchuser.h"
+#include "util.h"

 using namespace std;

@@ -53,10 +54,10 @@ void SwitchUser::Execute(const char* cmd) {
 }

 void SwitchUser::SetClientAuth(const char* mcookie) {
-    int r;
+    bool r;
     string home = string(Pw->pw_dir);
     string authfile = home + "/.Xauthority";
     remove(authfile.c_str());
-    string cmd = cfg->getOption("xauth_path") + " -q -f " + authfile + " add :0 . " + mcookie;
-    r = system(cmd.c_str());
+    r = Util::add_mcookie(mcookie, ":0", cfg->getOption("xauth_path"),
+      authfile);
 }
diff --git a/util.cpp b/util.cpp
new file mode 100644
index 0000000..050d83d
--- /dev/null
+++ b/util.cpp
@@ -0,0 +1,32 @@
+/* SLiM - Simple Login Manager
+   Copyright (C) 2009 Eygene Ryabinkin <rea@codelabs.ru>
+
+   This program is free software; you can redistribute it and/or modify
+   it under the terms of the GNU General Public License as published by
+   the Free Software Foundation; either version 2 of the License, or
+   (at your option) any later version.
+*/
+
+#include <stdio.h>
+#include "util.h"
+
+/*
+ * Adds the given cookie to the specified Xauthority file.
+ * Returns true on success, false on fault.
+ */
+bool Util::add_mcookie(const std::string &mcookie, const char *display,
+    const std::string &xauth_cmd, const std::string &authfile)
+{
+	FILE *fp;
+	std::string cmd = xauth_cmd + " -f " + authfile + " -q";
+
+	fp = popen(cmd.c_str(), "w");
+	if (!fp)
+		return false;
+	fprintf(fp, "remove %s\n", display);
+	fprintf(fp, "add %s %s %s\n", display, ".", mcookie.c_str());
+	fprintf(fp, "quit\n");
+
+	pclose(fp);
+	return true;
+}
diff --git a/util.h b/util.h
new file mode 100644
index 0000000..8bd52be
--- /dev/null
+++ b/util.h
@@ -0,0 +1,19 @@
+/* SLiM - Simple Login Manager
+   Copyright (C) 2009 Eygene Ryabinkin <rea@codelabs.ru>
+
+   This program is free software; you can redistribute it and/or modify
+   it under the terms of the GNU General Public License as published by
+   the Free Software Foundation; either version 2 of the License, or
+   (at your option) any later version.
+*/
+#ifndef __UTIL_H__
+#define __UTIL_H__
+
+#include <string>
+
+namespace Util {
+	bool add_mcookie(const std::string &mcookie, const char *display,
+	    const std::string &xauth_cmd, const std::string &authfile);
+};
+
+#endif /* __UTIL_H__ */
--
1.6.3.1

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#529306`; Package `slim`.
(Wed, 20 May 2009 15:42:04 GMT) ([full text](bugreport.cgi?bug=529306;msg=12), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Mike Massonnet <mmassonnet@gmail.com>`:

Extra info received and forwarded to list.
(Wed, 20 May 2009 15:42:04 GMT) ([full text](bugreport.cgi?bug=529306;msg=14), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 529306@bugs.debian.org ([full text](bugreport.cgi?bug=529306;msg=15), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=mmassonnet%40gmail.com)
From: Mike Massonnet <mmassonnet@gmail.com>
To: Eygene Ryabinkin <rea@codelabs.ru>, 529306@bugs.debian.org
Subject: Re: Bug#529306: [PATCH] Do not specify magic cookie for xauth in the
xauth command line
Date: Wed, 20 May 2009 17:39:08 +0200
```
Wow, nice! I didn't take time yet to investigate, thanks for a lot for
providing this patch. I will make a package for stable asap.

Mike

2009/5/20 Eygene Ryabinkin <rea@codelabs.ru>:
> Instead, open xauth as a pipe and feed commands via its stdin.
>
> Signed-off-by: Eygene Ryabinkin <rea@codelabs.ru>
> ---
>  Makefile         |    3 ++-
>  Makefile.freebsd |    3 ++-
>  Makefile.netbsd  |    3 ++-
>  Makefile.openbsd |    3 ++-
>  app.cpp          |    8 +++++---
>  switchuser.cpp   |    7 ++++---
>  util.cpp         |   32 ++++++++++++++++++++++++++++++++
>  util.h           |   19 +++++++++++++++++++
>  8 files changed, 68 insertions(+), 10 deletions(-)
>  create mode 100644 util.cpp
>  create mode 100644 util.h
>
> diff --git a/Makefile b/Makefile
> index f7d3d2d..240669d 100644
> --- a/Makefile
> +++ b/Makefile
> @@ -25,7 +25,8 @@ VERSION=1.3.1
>  DEFINES=-DPACKAGE=\"$(NAME)\" -DVERSION=\"$(VERSION)\" \
>                -DPKGDATADIR=\"$(PREFIX)/share/slim\" -DSYSCONFDIR=\"$(CFGDIR)\"
>
> -OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o panel.o
> +OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o \
> +       panel.o util.o
>  ifdef USE_PAM
>  OBJECTS+=PAM.o
>  endif
> diff --git a/Makefile.freebsd b/Makefile.freebsd
> index 3ff326e..c925a39 100644
> --- a/Makefile.freebsd
> +++ b/Makefile.freebsd
> @@ -24,7 +24,8 @@ VERSION=1.3.1
>  DEFINES=-DPACKAGE=\"$(NAME)\" -DVERSION=\"$(VERSION)\" \
>                -DPKGDATADIR=\"$(PREFIX)/share/slim\" -DSYSCONFDIR=\"$(CFGDIR)\"
>
> -OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o panel.o
> +OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o \
> +       panel.o util.o
>  .ifdef USE_PAM
>   OBJECTS+=PAM.o
>  .endif
> diff --git a/Makefile.netbsd b/Makefile.netbsd
> index ad8bb8b..45f33e6 100644
> --- a/Makefile.netbsd
> +++ b/Makefile.netbsd
> @@ -24,7 +24,8 @@ VERSION=1.3.1
>  DEFINES=-DPACKAGE=\"$(NAME)\" -DVERSION=\"$(VERSION)\" \
>                -DPKGDATADIR=\"$(PREFIX)/share/slim\" -DSYSCONFDIR=\"$(CFGDIR)\"
>
> -OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o panel.o
> +OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o \
> +       panel.o util.o
>  .ifdef USE_PAM
>   OBJECTS+=PAM.o
>  .endif
> diff --git a/Makefile.openbsd b/Makefile.openbsd
> index b1829f8..1205b84 100644
> --- a/Makefile.openbsd
> +++ b/Makefile.openbsd
> @@ -20,7 +20,8 @@ VERSION=1.3.1
>  DEFINES=-DPACKAGE=\"$(NAME)\" -DVERSION=\"$(VERSION)\" \
>                -DPKGDATADIR=\"$(PREFIX)/share/slim\" -DSYSCONFDIR=\"$(CFGDIR)\"
>
> -OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o panel.o
> +OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o \
> +       util.o panel.o
>
>  .SUFFIXES: .c.o .cpp.o
>
> diff --git a/app.cpp b/app.cpp
> index 83ae947..2502b0b 100644
> --- a/app.cpp
> +++ b/app.cpp
> @@ -24,6 +24,7 @@
>  #include <algorithm>
>  #include "app.h"
>  #include "numlock.h"
> +#include "util.h"
>
>
>  #ifdef HAVE_SHADOW
> @@ -1162,7 +1163,8 @@ void App::replaceVariables(string& input,
>
>  void App::CreateServerAuth() {
>     /* create mit cookie */
> -    int i, r;
> +    bool r;
> +    int i;
>     int hexcount = 0;
>         string authfile;
>     string cmd;
> @@ -1185,8 +1187,8 @@ void App::CreateServerAuth() {
>     authfile = cfg->getOption("authfile");
>     remove(authfile.c_str());
>     putenv(StrConcat("XAUTHORITY=", authfile.c_str()));
> -    cmd = cfg->getOption("xauth_path") + " -q -f " + authfile + " add :0 . " + mcookie;
> -    system(cmd.c_str());
> +    r = Util::add_mcookie(mcookie, ":0", cfg->getOption("xauth_path"),
> +      authfile);
>  }
>
>  char* App::StrConcat(const char* str1, const char* str2) {
> diff --git a/switchuser.cpp b/switchuser.cpp
> index e72a8fc..ec298e1 100644
> --- a/switchuser.cpp
> +++ b/switchuser.cpp
> @@ -10,6 +10,7 @@
>  */
>
>  #include "switchuser.h"
> +#include "util.h"
>
>  using namespace std;
>
> @@ -53,10 +54,10 @@ void SwitchUser::Execute(const char* cmd) {
>  }
>
>  void SwitchUser::SetClientAuth(const char* mcookie) {
> -    int r;
> +    bool r;
>     string home = string(Pw->pw_dir);
>     string authfile = home + "/.Xauthority";
>     remove(authfile.c_str());
> -    string cmd = cfg->getOption("xauth_path") + " -q -f " + authfile + " add :0 . " + mcookie;
> -    r = system(cmd.c_str());
> +    r = Util::add_mcookie(mcookie, ":0", cfg->getOption("xauth_path"),
> +      authfile);
>  }
> diff --git a/util.cpp b/util.cpp
> new file mode 100644
> index 0000000..050d83d
> --- /dev/null
> +++ b/util.cpp
> @@ -0,0 +1,32 @@
> +/* SLiM - Simple Login Manager
> +   Copyright (C) 2009 Eygene Ryabinkin <rea@codelabs.ru>
> +
> +   This program is free software; you can redistribute it and/or modify
> +   it under the terms of the GNU General Public License as published by
> +   the Free Software Foundation; either version 2 of the License, or
> +   (at your option) any later version.
> +*/
> +
> +#include <stdio.h>
> +#include "util.h"
> +
> +/*
> + * Adds the given cookie to the specified Xauthority file.
> + * Returns true on success, false on fault.
> + */
> +bool Util::add_mcookie(const std::string &mcookie, const char *display,
> +    const std::string &xauth_cmd, const std::string &authfile)
> +{
> +       FILE *fp;
> +       std::string cmd = xauth_cmd + " -f " + authfile + " -q";
> +
> +       fp = popen(cmd.c_str(), "w");
> +       if (!fp)
> +               return false;
> +       fprintf(fp, "remove %s\n", display);
> +       fprintf(fp, "add %s %s %s\n", display, ".", mcookie.c_str());
> +       fprintf(fp, "quit\n");
> +
> +       pclose(fp);
> +       return true;
> +}
> diff --git a/util.h b/util.h
> new file mode 100644
> index 0000000..8bd52be
> --- /dev/null
> +++ b/util.h
> @@ -0,0 +1,19 @@
> +/* SLiM - Simple Login Manager
> +   Copyright (C) 2009 Eygene Ryabinkin <rea@codelabs.ru>
> +
> +   This program is free software; you can redistribute it and/or modify
> +   it under the terms of the GNU General Public License as published by
> +   the Free Software Foundation; either version 2 of the License, or
> +   (at your option) any later version.
> +*/
> +#ifndef __UTIL_H__
> +#define __UTIL_H__
> +
> +#include <string>
> +
> +namespace Util {
> +       bool add_mcookie(const std::string &mcookie, const char *display,
> +           const std::string &xauth_cmd, const std::string &authfile);
> +};
> +
> +#endif /* __UTIL_H__ */
> --
> 1.6.3.1
>
>
>

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Mike Massonnet <mmassonnet@gmail.com>`:

`Bug#529306`; Package `slim`.
(Thu, 21 May 2009 05:51:02 GMT) ([full text](bugreport.cgi?bug=529306;msg=17), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent**
to `rea@codelabs.ru`:

Extra info received and forwarded to list. Copy sent to `Mike Massonnet <mmassonnet@gmail.com>`.
(Thu, 21 May 2009 05:51:02 GMT) ([full text](bugreport.cgi?bug=529306;msg=19), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 529306@bugs.debian.org ([full text](bugreport.cgi?bug=529306;msg=20), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=rea%40codelabs.ru)
From: Eygene Ryabinkin <rea@codelabs.ru>
To: Mike Massonnet <mmassonnet@gmail.com>
Cc: 529306@bugs.debian.org
Subject: Re: Bug#529306: [PATCH] Do not specify magic cookie for xauth in
the xauth command line
Date: Thu, 21 May 2009 09:50:12 +0400
```
Wed, May 20, 2009 at 05:39:08PM +0200, Mike Massonnet wrote:
> Wow, nice! I didn't take time yet to investigate, thanks for a lot for
> providing this patch. I will make a package for stable asap.

Erm, sorry, sent old patch variant that doesn't produce .Xauthority:
'quit' should be replaced with 'exit'.  Sorry, wasn't updated the
patchfile.  Here is the proper one:

From 91a9c953723d602c3da0e375785a9c62401781c2 Mon Sep 17 00:00:00 2001
From: Eygene Ryabinkin <rea@codelabs.ru>
Date: Wed, 20 May 2009 18:44:57 +0400
Subject: [PATCH] Do not specify magic cookie for xauth in the xauth command line

Instead, open xauth as a pipe and feed commands via its stdin.

Signed-off-by: Eygene Ryabinkin <rea@codelabs.ru>
---
 Makefile         |    3 ++-
 Makefile.freebsd |    3 ++-
 Makefile.netbsd  |    3 ++-
 Makefile.openbsd |    3 ++-
 app.cpp          |    8 +++++---
 switchuser.cpp   |    7 ++++---
 util.cpp         |   32 ++++++++++++++++++++++++++++++++
 util.h           |   19 +++++++++++++++++++
 8 files changed, 68 insertions(+), 10 deletions(-)
 create mode 100644 util.cpp
 create mode 100644 util.h

diff --git a/Makefile b/Makefile
index f7d3d2d..240669d 100644
--- a/Makefile
+++ b/Makefile
@@ -25,7 +25,8 @@ VERSION=1.3.1
 DEFINES=-DPACKAGE=\"$(NAME)\" -DVERSION=\"$(VERSION)\" \
 		-DPKGDATADIR=\"$(PREFIX)/share/slim\" -DSYSCONFDIR=\"$(CFGDIR)\"

-OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o panel.o
+OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o \
+	panel.o util.o
 ifdef USE_PAM
 OBJECTS+=PAM.o
 endif
diff --git a/Makefile.freebsd b/Makefile.freebsd
index 3ff326e..c925a39 100644
--- a/Makefile.freebsd
+++ b/Makefile.freebsd
@@ -24,7 +24,8 @@ VERSION=1.3.1
 DEFINES=-DPACKAGE=\"$(NAME)\" -DVERSION=\"$(VERSION)\" \
 		-DPKGDATADIR=\"$(PREFIX)/share/slim\" -DSYSCONFDIR=\"$(CFGDIR)\"

-OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o panel.o
+OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o \
+	panel.o util.o
 .ifdef USE_PAM
   OBJECTS+=PAM.o
 .endif
diff --git a/Makefile.netbsd b/Makefile.netbsd
index ad8bb8b..45f33e6 100644
--- a/Makefile.netbsd
+++ b/Makefile.netbsd
@@ -24,7 +24,8 @@ VERSION=1.3.1
 DEFINES=-DPACKAGE=\"$(NAME)\" -DVERSION=\"$(VERSION)\" \
 		-DPKGDATADIR=\"$(PREFIX)/share/slim\" -DSYSCONFDIR=\"$(CFGDIR)\"

-OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o panel.o
+OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o \
+	panel.o util.o
 .ifdef USE_PAM
   OBJECTS+=PAM.o
 .endif
diff --git a/Makefile.openbsd b/Makefile.openbsd
index b1829f8..1205b84 100644
--- a/Makefile.openbsd
+++ b/Makefile.openbsd
@@ -20,7 +20,8 @@ VERSION=1.3.1
 DEFINES=-DPACKAGE=\"$(NAME)\" -DVERSION=\"$(VERSION)\" \
 		-DPKGDATADIR=\"$(PREFIX)/share/slim\" -DSYSCONFDIR=\"$(CFGDIR)\"

-OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o panel.o
+OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o \
+	util.o panel.o

 .SUFFIXES: .c.o .cpp.o

diff --git a/app.cpp b/app.cpp
index 83ae947..2502b0b 100644
--- a/app.cpp
+++ b/app.cpp
@@ -24,6 +24,7 @@
 #include <algorithm>
 #include "app.h"
 #include "numlock.h"
+#include "util.h"

 #ifdef HAVE_SHADOW
@@ -1162,7 +1163,8 @@ void App::replaceVariables(string& input,

 void App::CreateServerAuth() {
     /* create mit cookie */
-    int i, r;
+    bool r;
+    int i;
     int hexcount = 0;
         string authfile;
     string cmd;
@@ -1185,8 +1187,8 @@ void App::CreateServerAuth() {
     authfile = cfg->getOption("authfile");
     remove(authfile.c_str());
     putenv(StrConcat("XAUTHORITY=", authfile.c_str()));
-    cmd = cfg->getOption("xauth_path") + " -q -f " + authfile + " add :0 . " + mcookie;
-    system(cmd.c_str());
+    r = Util::add_mcookie(mcookie, ":0", cfg->getOption("xauth_path"),
+      authfile);
 }

 char* App::StrConcat(const char* str1, const char* str2) {
diff --git a/switchuser.cpp b/switchuser.cpp
index e72a8fc..ec298e1 100644
--- a/switchuser.cpp
+++ b/switchuser.cpp
@@ -10,6 +10,7 @@
 */

 #include "switchuser.h"
+#include "util.h"

 using namespace std;

@@ -53,10 +54,10 @@ void SwitchUser::Execute(const char* cmd) {
 }

 void SwitchUser::SetClientAuth(const char* mcookie) {
-    int r;
+    bool r;
     string home = string(Pw->pw_dir);
     string authfile = home + "/.Xauthority";
     remove(authfile.c_str());
-    string cmd = cfg->getOption("xauth_path") + " -q -f " + authfile + " add :0 . " + mcookie;
-    r = system(cmd.c_str());
+    r = Util::add_mcookie(mcookie, ":0", cfg->getOption("xauth_path"),
+      authfile);
 }
diff --git a/util.cpp b/util.cpp
new file mode 100644
index 0000000..309ce4f
--- /dev/null
+++ b/util.cpp
@@ -0,0 +1,32 @@
+/* SLiM - Simple Login Manager
+   Copyright (C) 2009 Eygene Ryabinkin <rea@codelabs.ru>
+
+   This program is free software; you can redistribute it and/or modify
+   it under the terms of the GNU General Public License as published by
+   the Free Software Foundation; either version 2 of the License, or
+   (at your option) any later version.
+*/
+
+#include <stdio.h>
+#include "util.h"
+
+/*
+ * Adds the given cookie to the specified Xauthority file.
+ * Returns true on success, false on fault.
+ */
+bool Util::add_mcookie(const std::string &mcookie, const char *display,
+    const std::string &xauth_cmd, const std::string &authfile)
+{
+	FILE *fp;
+	std::string cmd = xauth_cmd + " -f " + authfile + " -q";
+
+	fp = popen(cmd.c_str(), "w");
+	if (!fp)
+		return false;
+	fprintf(fp, "remove %s\n", display);
+	fprintf(fp, "add %s %s %s\n", display, ".", mcookie.c_str());
+	fprintf(fp, "exit\n");
+
+	pclose(fp);
+	return true;
+}
diff --git a/util.h b/util.h
new file mode 100644
index 0000000..8bd52be
--- /dev/null
+++ b/util.h
@@ -0,0 +1,19 @@
+/* SLiM - Simple Login Manager
+   Copyright (C) 2009 Eygene Ryabinkin <rea@codelabs.ru>
+
+   This program is free software; you can redistribute it and/or modify
+   it under the terms of the GNU General Public License as published by
+   the Free Software Foundation; either version 2 of the License, or
+   (at your option) any later version.
+*/
+#ifndef __UTIL_H__
+#define __UTIL_H__
+
+#include <string>
+
+namespace Util {
+	bool add_mcookie(const std::string &mcookie, const char *display,
+	    const std::string &xauth_cmd, const std::string &authfile);
+};
+
+#endif /* __UTIL_H__ */
--
1.6.3.1

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Mike Massonnet <mmassonnet@gmail.com>`:

`Bug#529306`; Package `slim`.
(Thu, 21 May 2009 06:42:02 GMT) ([full text](bugreport.cgi?bug=529306;msg=22), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=22), [link](#21)).

---

**Acknowledgement sent**
to `rea@codelabs.ru`:

Extra info received and forwarded to list. Copy sent to `Mike Massonnet <mmassonnet@gmail.com>`.
(Thu, 21 May 2009 06:42:02 GMT) ([full text](bugreport.cgi?bug=529306;msg=24), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=24), [link](#23)).

---

[Message #25](#25) received at 529306@bugs.debian.org ([full text](bugreport.cgi?bug=529306;msg=25), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=25), reply):

![](/cgi-bin/libravatar.cgi?email=rea%40codelabs.ru)
From: Eygene Ryabinkin <rea@codelabs.ru>
To: Mike Massonnet <mmassonnet@gmail.com>
Cc: 529306@bugs.debian.org
Subject: Re: Bug#529306: [PATCH] Do not specify magic cookie for xauth in
the xauth command line
Date: Thu, 21 May 2009 10:39:36 +0400
```
Thu, May 21, 2009 at 09:50:12AM +0400, Eygene Ryabinkin wrote:
> Wed, May 20, 2009 at 05:39:08PM +0200, Mike Massonnet wrote:
> > Wow, nice! I didn't take time yet to investigate, thanks for a lot for
> > providing this patch. I will make a package for stable asap.
>
> Erm, sorry, sent old patch variant that doesn't produce .Xauthority:
> 'quit' should be replaced with 'exit'.  Sorry, wasn't updated the
> patchfile.  Here is the proper one:

And found one more issue -- mcookie was weakened because I am blindly
substituted 'int r' for 'bool r'.  Fixed now.

From 72625a9dacfbd448ba7a84725d66bb2bfc9801f0 Mon Sep 17 00:00:00 2001
From: Eygene Ryabinkin <rea@codelabs.ru>
Date: Wed, 20 May 2009 18:44:57 +0400
Subject: [PATCH] Do not specify magic cookie for xauth in the xauth command line

Instead, open xauth as a pipe and feed commands via its stdin.

Signed-off-by: Eygene Ryabinkin <rea@codelabs.ru>
---
 Makefile         |    3 ++-
 Makefile.freebsd |    3 ++-
 Makefile.netbsd  |    3 ++-
 Makefile.openbsd |    3 ++-
 app.cpp          |    5 +++--
 switchuser.cpp   |    7 ++++---
 util.cpp         |   32 ++++++++++++++++++++++++++++++++
 util.h           |   19 +++++++++++++++++++
 8 files changed, 66 insertions(+), 9 deletions(-)
 create mode 100644 util.cpp
 create mode 100644 util.h

diff --git a/Makefile b/Makefile
index f7d3d2d..240669d 100644
--- a/Makefile
+++ b/Makefile
@@ -25,7 +25,8 @@ VERSION=1.3.1
 DEFINES=-DPACKAGE=\"$(NAME)\" -DVERSION=\"$(VERSION)\" \
 		-DPKGDATADIR=\"$(PREFIX)/share/slim\" -DSYSCONFDIR=\"$(CFGDIR)\"

-OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o panel.o
+OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o \
+	panel.o util.o
 ifdef USE_PAM
 OBJECTS+=PAM.o
 endif
diff --git a/Makefile.freebsd b/Makefile.freebsd
index 3ff326e..c925a39 100644
--- a/Makefile.freebsd
+++ b/Makefile.freebsd
@@ -24,7 +24,8 @@ VERSION=1.3.1
 DEFINES=-DPACKAGE=\"$(NAME)\" -DVERSION=\"$(VERSION)\" \
 		-DPKGDATADIR=\"$(PREFIX)/share/slim\" -DSYSCONFDIR=\"$(CFGDIR)\"

-OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o panel.o
+OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o \
+	panel.o util.o
 .ifdef USE_PAM
   OBJECTS+=PAM.o
 .endif
diff --git a/Makefile.netbsd b/Makefile.netbsd
index ad8bb8b..45f33e6 100644
--- a/Makefile.netbsd
+++ b/Makefile.netbsd
@@ -24,7 +24,8 @@ VERSION=1.3.1
 DEFINES=-DPACKAGE=\"$(NAME)\" -DVERSION=\"$(VERSION)\" \
 		-DPKGDATADIR=\"$(PREFIX)/share/slim\" -DSYSCONFDIR=\"$(CFGDIR)\"

-OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o panel.o
+OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o \
+	panel.o util.o
 .ifdef USE_PAM
   OBJECTS+=PAM.o
 .endif
diff --git a/Makefile.openbsd b/Makefile.openbsd
index b1829f8..1205b84 100644
--- a/Makefile.openbsd
+++ b/Makefile.openbsd
@@ -20,7 +20,8 @@ VERSION=1.3.1
 DEFINES=-DPACKAGE=\"$(NAME)\" -DVERSION=\"$(VERSION)\" \
 		-DPKGDATADIR=\"$(PREFIX)/share/slim\" -DSYSCONFDIR=\"$(CFGDIR)\"

-OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o panel.o
+OBJECTS=jpeg.o png.o main.o image.o numlock.o cfg.o switchuser.o app.o \
+	util.o panel.o

 .SUFFIXES: .c.o .cpp.o

diff --git a/app.cpp b/app.cpp
index 83ae947..04caaa1 100644
--- a/app.cpp
+++ b/app.cpp
@@ -24,6 +24,7 @@
 #include <algorithm>
 #include "app.h"
 #include "numlock.h"
+#include "util.h"

 #ifdef HAVE_SHADOW
@@ -1185,8 +1186,8 @@ void App::CreateServerAuth() {
     authfile = cfg->getOption("authfile");
     remove(authfile.c_str());
     putenv(StrConcat("XAUTHORITY=", authfile.c_str()));
-    cmd = cfg->getOption("xauth_path") + " -q -f " + authfile + " add :0 . " + mcookie;
-    system(cmd.c_str());
+    Util::add_mcookie(mcookie, ":0", cfg->getOption("xauth_path"),
+      authfile);
 }

 char* App::StrConcat(const char* str1, const char* str2) {
diff --git a/switchuser.cpp b/switchuser.cpp
index e72a8fc..ec298e1 100644
--- a/switchuser.cpp
+++ b/switchuser.cpp
@@ -10,6 +10,7 @@
 */

 #include "switchuser.h"
+#include "util.h"

 using namespace std;

@@ -53,10 +54,10 @@ void SwitchUser::Execute(const char* cmd) {
 }

 void SwitchUser::SetClientAuth(const char* mcookie) {
-    int r;
+    bool r;
     string home = string(Pw->pw_dir);
     string authfile = home + "/.Xauthority";
     remove(authfile.c_str());
-    string cmd = cfg->getOption("xauth_path") + " -q -f " + authfile + " add :0 . " + mcookie;
-    r = system(cmd.c_str());
+    r = Util::add_mcookie(mcookie, ":0", cfg->getOption("xauth_path"),
+      authfile);
 }
diff --git a/util.cpp b/util.cpp
new file mode 100644
index 0000000..309ce4f
--- /dev/null
+++ b/util.cpp
@@ -0,0 +1,32 @@
+/* SLiM - Simple Login Manager
+   Copyright (C) 2009 Eygene Ryabinkin <rea@codelabs.ru>
+
+   This program is free software; you can redistribute it and/or modify
+   it under the terms of the GNU General Public License as published by
+   the Free Software Foundation; either version 2 of the License, or
+   (at your option) any later version.
+*/
+
+#include <stdio.h>
+#include "util.h"
+
+/*
+ * Adds the given cookie to the specified Xauthority file.
+ * Returns true on success, false on fault.
+ */
+bool Util::add_mcookie(const std::string &mcookie, const char *display,
+    const std::string &xauth_cmd, const std::string &authfile)
+{
+	FILE *fp;
+	std::string cmd = xauth_cmd + " -f " + authfile + " -q";
+
+	fp = popen(cmd.c_str(), "w");
+	if (!fp)
+		return false;
+	fprintf(fp, "remove %s\n", display);
+	fprintf(fp, "add %s %s %s\n", display, ".", mcookie.c_str());
+	fprintf(fp, "exit\n");
+
+	pclose(fp);
+	return true;
+}
diff --git a/util.h b/util.h
new file mode 100644
index 0000000..8bd52be
--- /dev/null
+++ b/util.h
@@ -0,0 +1,19 @@
+/* SLiM - Simple Login Manager
+   Copyright (C) 2009 Eygene Ryabinkin <rea@codelabs.ru>
+
+   This program is free software; you can redistribute it and/or modify
+   it under the terms of the GNU General Public License as published by
+   the Free Software Foundation; either version 2 of the License, or
+   (at your option) any later version.
+*/
+#ifndef __UTIL_H__
+#define __UTIL_H__
+
+#include <string>
+
+namespace Util {
+	bool add_mcookie(const std::string &mcookie, const char *display,
+	    const std::string &xauth_cmd, const std::string &authfile);
+};
+
+#endif /* __UTIL_H__ */
--
1.6.3.1
--
rea

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Mike Massonnet <mmassonnet@gmail.com>`:

`Bug#529306`; Package `slim`.
(Thu, 21 May 2009 09:06:05 GMT) ([full text](bugreport.cgi?bug=529306;msg=27), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=27), [link](#26)).

---

**Acknowledgement sent**
to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Mike Massonnet <mmassonnet@gmail.com>`.
(Thu, 21 May 2009 09:06:05 GMT) ([full text](bugreport.cgi?bug=529306;msg=29), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=29), [link](#28)).

---

[Message #30](#30) received at 529306@bugs.debian.org ([full text](bugreport.cgi?bug=529306;msg=30), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=30), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: rea@codelabs.ru, 529306@bugs.debian.org
Cc: Mike Massonnet <mmassonnet@gmail.com>
Subject: Re: Bug#529306: [PATCH] Do not specify magic cookie for xauth in the xauth command line
Date: Thu, 21 May 2009 11:00:23 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=529306;msg=30) (text/plain, inline)]
```
```
Hi,
* Eygene Ryabinkin <rea@codelabs.ru> [2009-05-21 10:24]:
> Thu, May 21, 2009 at 09:50:12AM +0400, Eygene Ryabinkin wrote:
> > Wed, May 20, 2009 at 05:39:08PM +0200, Mike Massonnet wrote:
> > > Wow, nice! I didn't take time yet to investigate, thanks for a lot for
> > > providing this patch. I will make a package for stable asap.
> >
> > Erm, sorry, sent old patch variant that doesn't produce .Xauthority:
> > 'quit' should be replaced with 'exit'.  Sorry, wasn't updated the
> > patchfile.  Here is the proper one:
>
> And found one more issue -- mcookie was weakened because I am blindly
> substituted 'int r' for 'bool r'.  Fixed now.

Thanks very much, the patch looks good! While you're at it,
mind to fix the insecure "random" hexstring generation as
well?

Cheers
Nico
--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=529306;msg=30) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Mike Massonnet <mmassonnet@gmail.com>`:

`Bug#529306`; Package `slim`.
(Thu, 21 May 2009 09:18:17 GMT) ([full text](bugreport.cgi?bug=529306;msg=32), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=32), [link](#31)).

---

**Acknowledgement sent**
to `rea@codelabs.ru`:

Extra info received and forwarded to list. Copy sent to `Mike Massonnet <mmassonnet@gmail.com>`.
(Thu, 21 May 2009 09:18:17 GMT) ([full text](bugreport.cgi?bug=529306;msg=34), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=34), [link](#33)).

---

[Message #35](#35) received at 529306@bugs.debian.org ([full text](bugreport.cgi?bug=529306;msg=35), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=35), reply):

![](/cgi-bin/libravatar.cgi?email=rea%40codelabs.ru)
From: Eygene Ryabinkin <rea@codelabs.ru>
To: Nico Golde <nion@debian.org>
Cc: 529306@bugs.debian.org, Mike Massonnet <mmassonnet@gmail.com>
Subject: Re: Bug#529306: [PATCH] Do not specify magic cookie for xauth in
the xauth command line
Date: Thu, 21 May 2009 13:16:00 +0400
```
Nico, good day.

Thu, May 21, 2009 at 11:00:23AM +0200, Nico Golde wrote:
> * Eygene Ryabinkin <rea@codelabs.ru> [2009-05-21 10:24]:
> > Thu, May 21, 2009 at 09:50:12AM +0400, Eygene Ryabinkin wrote:
> > > Wed, May 20, 2009 at 05:39:08PM +0200, Mike Massonnet wrote:
> > > > Wow, nice! I didn't take time yet to investigate, thanks for a lot for
> > > > providing this patch. I will make a package for stable asap.
> > >
> > > Erm, sorry, sent old patch variant that doesn't produce .Xauthority:
> > > 'quit' should be replaced with 'exit'.  Sorry, wasn't updated the
> > > patchfile.  Here is the proper one:
> >
> > And found one more issue -- mcookie was weakened because I am blindly
> > substituted 'int r' for 'bool r'.  Fixed now.
>

> Thanks very much, the patch looks good! While you're at it, mind to
> fix the insecure "random" hexstring generation as well?

Sure, did it already, tested and just wanted to send it out.

From 5beb217296e3074cadc5bcb3e40355f54ee705f0 Mon Sep 17 00:00:00 2001
From: Eygene Ryabinkin <rea@shadow.codelabs.ru>
Date: Thu, 21 May 2009 11:56:27 +0400
Subject: [PATCH] Create interface for random number generator and use it everywhere

Don't use rand()/srand() at all -- they are very weak.  Provide our
wrappers for random()/srandom() and make utility function that will
generate seed for srandom.

Rework MIT magic cookie generation: consume 4 bytes of input in one
pass -- random() should produce values that are usable for this purpose.

Signed-off-by: Eygene Ryabinkin <rea@shadow.codelabs.ru>
---
 app.cpp  |   49 ++++++++++++++++++++++++++-----------------------
 app.h    |    2 ++
 util.cpp |   37 +++++++++++++++++++++++++++++++++++++
 util.h   |    5 +++++
 4 files changed, 70 insertions(+), 23 deletions(-)

diff --git a/app.cpp b/app.cpp
index 04caaa1..0ac8c3a 100644
--- a/app.cpp
+++ b/app.cpp
@@ -129,15 +129,18 @@ void User1Signal(int sig) {

 #ifdef USE_PAM
-App::App(int argc, char** argv):
-    pam(conv, static_cast<void*>(&LoginPanel)){
+App::App(int argc, char** argv)
+  : pam(conv, static_cast<void*>(&LoginPanel)),
 #else
-App::App(int argc, char** argv){
+App::App(int argc, char** argv)
+  :
 #endif
+    mcookiesize(32)		// Must be divisible by 4
+{
     int tmp;
     ServerPID = -1;
     testing = false;
-    mcookie = "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa";
+    mcookie = string(App::mcookiesize, 'a');
     daemonmode = false;
     force_nodaemon = false;
     firstlogin = true;
@@ -1128,13 +1131,13 @@ string App::findValidRandomTheme(const string& set)
         name = name.substr(0, name.length() - 1);
     }

-    srandom(getpid()+time(NULL));
+    Util::srandom(Util::makeseed());

     vector<string> themes;
     string themefile;
     Cfg::split(themes, name, ',');
     do {
-        int sel = random() % themes.size();
+        int sel = Util::random() % themes.size();

         name = Cfg::Trim(themes[sel]);
         themefile = string(THEMESDIR) +"/" + name + THEMESFILE;
@@ -1161,27 +1164,27 @@ void App::replaceVariables(string& input,
 }

+/*
+ * We rely on the fact that all bits generated by Util::random()
+ * are usable, so we are taking full words from its output.
+ */
 void App::CreateServerAuth() {
     /* create mit cookie */
-    int i, r;
-    int hexcount = 0;
-        string authfile;
-    string cmd;
+    uint16_t word;
+    uint8_t hi, lo;
+    int i;
+    string authfile;
     const char *digits = "0123456789abcdef";
-        srand( time(NULL) );
-    for ( i = 0; i < 31; i++ ) {
-        r = rand()%16;
-                mcookie[i] = digits[r];
-                if (r>9)
-                        hexcount++;
+    Util::srandom(Util::makeseed());
+    for (i = 0; i < App::mcookiesize; i+=4) {
+        word = Util::random() & 0xffff;
+        lo = word & 0xff;
+        hi = word >> 8;
+        mcookie[i] = digits[lo & 0x0f];
+        mcookie[i+1] = digits[lo >> 4];
+        mcookie[i+2] = digits[hi & 0x0f];
+        mcookie[i+3] = digits[hi >> 4];
     }
-        /* MIT-COOKIE: even occurrences of digits and hex digits */
-        if ((hexcount%2) == 0) {
-                r = rand()%10;
-        } else {
-                r = rand()%5+10;
-        }
-        mcookie[31] = digits[r];
     /* reinitialize auth file */
     authfile = cfg->getOption("authfile");
     remove(authfile.c_str());
diff --git a/app.h b/app.h
index 7b4bd10..9a44269 100644
--- a/app.h
+++ b/app.h
@@ -101,6 +101,8 @@ private:

     std::string themeName;
     std::string mcookie;
+
+    const int mcookiesize;
 };

diff --git a/util.cpp b/util.cpp
index 309ce4f..5ed972f 100644
--- a/util.cpp
+++ b/util.cpp
@@ -7,7 +7,13 @@
    (at your option) any later version.
 */

+#include <sys/types.h>
+
 #include <stdio.h>
+#include <stdlib.h>
+#include <time.h>
+#include <unistd.h>
+
 #include "util.h"

 /*
@@ -30,3 +36,34 @@ bool Util::add_mcookie(const std::string &mcookie, const char *display,
 	pclose(fp);
 	return true;
 }
+
+/*
+ * Interface for random number generator.  Just now it uses ordinary
+ * random/srandom routines and serves as a wrapper for them.
+ */
+void Util::srandom(unsigned long seed)
+{
+	::srandom(seed);
+}
+
+long Util::random(void)
+{
+	return ::random();
+}
+
+/*
+ * Makes seed for the srandom() using "random" values obtained from
+ * getpid(), time(NULL) and others.
+ */
+long Util::makeseed(void)
+{
+	struct timespec ts;
+	long pid = getpid();
+	long tm = time(NULL);
+
+	if (clock_gettime(CLOCK_MONOTONIC, &ts) != 0) {
+		ts.tv_sec = ts.tv_nsec = 0;
+	}
+
+	return pid + tm + (ts.tv_sec ^ ts.tv_nsec);
+}
diff --git a/util.h b/util.h
index 8bd52be..b8d2993 100644
--- a/util.h
+++ b/util.h
@@ -14,6 +14,11 @@
 namespace Util {
 	bool add_mcookie(const std::string &mcookie, const char *display,
 	    const std::string &xauth_cmd, const std::string &authfile);
+
+	void srandom(unsigned long seed);
+	long random(void);
+
+	long makeseed(void);
 };

 #endif /* __UTIL_H__ */
--
1.6.3.1
--
rea

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Mike Massonnet <mmassonnet@gmail.com>`:

`Bug#529306`; Package `slim`.
(Tue, 02 Jun 2009 21:27:02 GMT) ([full text](bugreport.cgi?bug=529306;msg=37), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=37), [link](#36)).

---

**Acknowledgement sent**
to `Moritz Muehlenhoff <jmm@inutil.org>`:

Extra info received and forwarded to list. Copy sent to `Mike Massonnet <mmassonnet@gmail.com>`.
(Tue, 02 Jun 2009 21:27:02 GMT) ([full text](bugreport.cgi?bug=529306;msg=39), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=39), [link](#38)).

---

[Message #40](#40) received at 529306@bugs.debian.org ([full text](bugreport.cgi?bug=529306;msg=40), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=40), reply):

![](/cgi-bin/libravatar.cgi?email=jmm%40inutil.org)
From: Moritz Muehlenhoff <jmm@inutil.org>
To: Mike Massonnet <mmassonnet@gmail.com>
Cc: Eygene Ryabinkin <rea@codelabs.ru>, 529306@bugs.debian.org
Subject: Re: Bug#529306: [PATCH] Do not specify magic cookie for xauth in the xauth command line
Date: Tue, 2 Jun 2009 23:21:10 +0200
```
On Wed, May 20, 2009 at 05:39:08PM +0200, Mike Massonnet wrote:
> Wow, nice! I didn't take time yet to investigate, thanks for a lot for
> providing this patch. I will make a package for stable asap.

Hi Mike,
this issue doesn't warrant a stable-security update through a DSA.
However, you could fix this through a stable point update. If you want to do
that please send a proposed debdiff to debian-release@lists.debian.org
so that the stable release managers can review it.

Cheers,
        Moritz

```

---

**Tags added: pending**
Request was from `Mike Massonnet <mmassonnet@gmail.com>`
to `control@bugs.debian.org`.
(Mon, 08 Jun 2009 21:06:09 GMT) ([full text](bugreport.cgi?bug=529306;msg=42), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=42), [link](#41)).

---

**Reply sent**
to `Marco Rodrigues <gothicx@sapo.pt>`:

You have taken responsibility.
(Tue, 18 Aug 2009 21:46:10 GMT) ([full text](bugreport.cgi?bug=529306;msg=44), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=44), [link](#43)).

---

**Notification sent**
to `Nico Golde <nion@debian.org>`:

Bug acknowledged by developer.
(Tue, 18 Aug 2009 21:46:10 GMT) ([full text](bugreport.cgi?bug=529306;msg=46), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=46), [link](#45)).

---

[Message #47](#47) received at 529306-done@bugs.debian.org ([full text](bugreport.cgi?bug=529306;msg=47), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=47), reply):

![](/cgi-bin/libravatar.cgi?email=gothicx%40sapo.pt)
From: Marco Rodrigues <gothicx@sapo.pt>
To: 529306-done@bugs.debian.org
Subject: Package slim has been removed from Debian
Date: Tue, 18 Aug 2009 22:41:18 +0100
```
Version: 1.3.0-2+rm

You filled the bug <http://bugs.debian.org/529306> in Debian BTS
against the package slim. I'm closing it as fixed in *unstable*,
but it will remain open for older distributions.

For more information about this package's removal, read
<http://bugs.debian.org/538921>. That bug might give the reasons why
this package was removed and suggestions of possible replacements.

Don't hesitate to reply to this mail if you have any question.

Thank you for your contribution to Debian.

--
Marco Rodrigues

```

---

**Bug No longer marked as fixed in versions 1.3.0-2+rm.**
Request was from `Piotr Engelking <inkerman42@gmail.com>`
to `control@bugs.debian.org`.
(Tue, 08 Sep 2009 06:57:31 GMT) ([full text](bugreport.cgi?bug=529306;msg=49), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=49), [link](#48)).

---

**Did not alter fixed versions and reopened.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Tue, 08 Sep 2009 16:45:35 GMT) ([full text](bugreport.cgi?bug=529306;msg=51), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=51), [link](#50)).

---

**Reply sent**
to `Nobuhiro Iwamatsu <iwamatsu@debian.org>`:

You have taken responsibility.
(Fri, 16 Oct 2009 04:39:11 GMT) ([full text](bugreport.cgi?bug=529306;msg=53), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=53), [link](#52)).

---

**Notification sent**
to `Nico Golde <nion@debian.org>`:

Bug acknowledged by developer.
(Fri, 16 Oct 2009 04:39:11 GMT) ([full text](bugreport.cgi?bug=529306;msg=55), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=55), [link](#54)).

---

[Message #56](#56) received at 529306-close@bugs.debian.org ([full text](bugreport.cgi?bug=529306;msg=56), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=56), reply):

![](/cgi-bin/libravatar.cgi?email=iwamatsu%40debian.org)
From: Nobuhiro Iwamatsu <iwamatsu@debian.org>
To: 529306-close@bugs.debian.org
Subject: Bug#529306: fixed in slim 1.3.1-2
Date: Fri, 16 Oct 2009 04:17:48 +0000
```
Source: slim
Source-Version: 1.3.1-2

We believe that the bug you reported is fixed in the latest version of
slim, which is due to be installed in the Debian FTP archive:

slim_1.3.1-2.diff.gz
  to pool/main/s/slim/slim_1.3.1-2.diff.gz
slim_1.3.1-2.dsc
  to pool/main/s/slim/slim_1.3.1-2.dsc
slim_1.3.1-2_i386.deb
  to pool/main/s/slim/slim_1.3.1-2_i386.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 529306@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Nobuhiro Iwamatsu <iwamatsu@debian.org> (supplier of updated slim package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Mon, 21 Sep 2009 15:52:33 +0900
Source: slim
Binary: slim
Architecture: source i386
Version: 1.3.1-2
Distribution: unstable
Urgency: low
Maintainer: Nobuhiro Iwamatsu <iwamatsu@debian.org>
Changed-By: Nobuhiro Iwamatsu <iwamatsu@debian.org>
Description:
 slim       - desktop-independent graphical login manager for X11
Closes: [505332](bugreport.cgi?bug=505332) [510469](bugreport.cgi?bug=510469) [529306](bugreport.cgi?bug=529306) [536542](bugreport.cgi?bug=536542)
Changes:
 slim (1.3.1-2) unstable; urgency=low
 .
   * Add Jens Peter Secher to Uploaders list.
   * Update es.po (Closes: #[510469](bugreport.cgi?bug=510469))
   * Fix FTBFS with GCC 4.4. (Closes: #[505332](bugreport.cgi?bug=505332))
   * Fix insecure xauth secret. (Closes: #[529306](bugreport.cgi?bug=529306))
   * Fix allows login as root without password. (Closes: #[536542](bugreport.cgi?bug=536542))
      - Wrote explanation about this problem to README.Debian.
Checksums-Sha1:
 5119604aacafbdaa7262c6354ea393c2ac9e0d74 1116 slim_1.3.1-2.dsc
 ed59be2979a66da6991f6845f5a3139428423ca3 661700 slim_1.3.1-2.diff.gz
 cd3bccc47f109c65e5b8332c968949be73328a45 817378 slim_1.3.1-2_i386.deb
Checksums-Sha256:
 05bc56c6e0b8b1f7885528db5c95ce1eaf8a126a2d3ab64b82c0e0619124bf89 1116 slim_1.3.1-2.dsc
 dec450826bf00393f7a4e5ddab0266c33bdec1b4340c886e1d6cd6b44d74d6a5 661700 slim_1.3.1-2.diff.gz
 731d0ec9702594dd51154957b542a38896c4ee92cf36c8f98260751557b8edbf 817378 slim_1.3.1-2_i386.deb
Files:
 6a2e27f370abb242163e3c2b10ddc266 1116 x11 optional slim_1.3.1-2.dsc
 1feb39759d74b09e4823008f549573a6 661700 x11 optional slim_1.3.1-2.diff.gz
 38f1310801713ba27b9cf03dce0385ea 817378 x11 optional slim_1.3.1-2_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iEYEARECAAYFAkrX7qUACgkQQSHHQzFw6+npRQCfeL+5qMhjIkD/J0lG0cNoLpzc
yDgAnigOADGH0YOhAkGVfylIGGcmWET8
=RjkV
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Tue, 17 Nov 2009 07:28:50 GMT) ([full text](bugreport.cgi?bug=529306;msg=58), [mbox](bugreport.cgi?bug=529306;mbox=yes;msg=58), [link](#57)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=529306).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 21:47:54 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from www.openwall.com_77909881_20250124_214759.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[thread-next>]](../../../2009/05/22/4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20090518145618.GA24851@ngolde.de>
Date: Mon, 18 May 2009 16:56:19 +0200
From: Nico Golde <oss-security+ml@...lde.de>
To: oss-security@...ts.openwall.com
Subject: CVE id request: slim

Hi,
slim insecurely generates the x authorization file:
<http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=529306>

Can I get a CVE id for this one?

Cheers
Nico

--
Nico Golde - <http://www.ngolde.de> - nion@...ber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

Content of type "application/pgp-signature" skipped

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


