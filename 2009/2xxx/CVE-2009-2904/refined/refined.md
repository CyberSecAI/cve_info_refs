```
{
  "Root cause of vulnerability": "OpenSSH in Red Hat Enterprise Linux 5 and Fedora 11 relaxed the ownership check on chroot directories used with the ChrootDirectory option, allowing directories to be owned by the user, instead of requiring root ownership. This was done to make the '%h' setting work as expected but introduced a security vulnerability.",
  "Weaknesses/vulnerabilities present": "Insecure permissions check on chroot directories. The relaxed check allowed users to own the chroot directory, which should have been owned by root. This allowed users to potentially create hard links to setuid programs outside of the chroot.",
  "Impact of exploitation": "Privilege escalation. A user with non-chrooted shell access could create hard links to setuid programs outside the chroot environment and, if the program's behavior was controlled by configuration files, use attacker controlled versions of these files inside the chroot to gain higher privileges.",
  "Attack vectors": "Local access is required to create the malicious chroot setup, then exploiting the vulnerability by logging in via ssh with a ChrootDirectory configuration.",
  "Required attacker capabilities/position": "The attacker needs non-chrooted shell access to the system to create the malicious setup prior to ssh login with the ChrootDirectory option. The target setuid program must reside on the same filesystem as the user's home directory. The attacker would then have to control configuration files that influence a setuid program's behavior when it is run inside the chroot."
}
```