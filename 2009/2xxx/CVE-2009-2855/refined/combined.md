=== Content from www.openwall.com_f19d6992_20250124_235938.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](../../../2009/08/05/1) [[<thread-prev]](4) [[thread-next>]](../../../2009/08/18/9) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20090804174813.GF7560@ngolde.de>
Date: Tue, 4 Aug 2009 19:48:13 +0200
From: Nico Golde <oss-security+ml@...lde.de>
To: oss-security@...ts.openwall.com
Subject: Re: squid DoS in external auth header parser

Hi,
* Vincent Danen <vdanen@...hat.com> [2009-08-04 17:20]:
> * [2009-08-04 12:13:29 +0200] Nico Golde wrote:
[...]
> >CVE-2009-2622
> >CVE-2009-2621
>
> Are you sure?
>
> According to MITRE's descriptions, CVE-2009-2621 deals with a lack of
> enforcing "buffer limites and related bound checks", and CVE-2009-2622
> deals with malformed requests.  When I was looking, it didn't seem like
> either of these were the issue noted in the Debian bug.  Bug #2704 on
> the squid site is still UNCONFIRMED with no additional comments made to
> it, so I don't think this is fixed in the latest upstream release (and
> wouldn't fall under one of these CVE's).
>
> I don't think a CVE has been assigned to this issue, and I don't think
> it has been fixed.

Oergs sorry, yes you are right. I mixed up the issues here.
Cheers
Nico
--
Nico Golde - <http://www.ngolde.de> - nion@...ber.ccc.de - GPG: 0xA0A0AAAA
For security reasons, all text in this mail is double-rot13 encrypted.

Content of type "application/pgp-signature" skipped

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_fe770795_20250124_235936.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](9) [[next>]](11) [[thread-next>]](../../../2009/08/03/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20090720173329.GH4372@redhat.com>
Date: Mon, 20 Jul 2009 11:33:29 -0600
From: Vincent Danen <vdanen@...hat.com>
To: oss-security@...ts.openwall.com
Subject: squid DoS in external auth header parser

I noticed this on Debian's bts [1] and also on upstream's bugzilla [2]
but no CVE has been assigned (not sure if one has been requested or not,
but I've not seen a request come through here).

By the initial looks of things, it seems to be a fairly low severity
issue and may not be easy to duplicate/trigger.  The reporter didn't really
provide much in the way of a reproducer or relevant configs (and the
reference to zope auths makes me not even want to touch it).

Has anyone taken a look at this or has a CVE been requested for it?
Upstream has done nothing with this despite it being reported two weeks
ago.

[1] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=534982>
[2] <http://www.squid-cache.org/bugs/show_bug.cgi?id=2704>

--
Vincent Danen / Red Hat Security Response Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from access.redhat.com_62968bc0_20250126_043941.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugs.debian.org_d91244fb_20250124_235934.html ===

# Debian Bug report logs - #534982 squid - DoS in external auth header parser

[![version graph](version.cgi?absolute=0;found=squid%2F2.7.STABLE3-4.1;fixed=squid%2F2.7.STABLE7-1;fixed=squid%2F2.6.5-6etch5;fixed=squid%2F2.7.STABLE3-4.1lenny1;height=2;collapse=1;package=squid;width=2)](version.cgi?absolute=0;fixed=squid%2F2.7.STABLE7-1;fixed=squid%2F2.6.5-6etch5;fixed=squid%2F2.7.STABLE3-4.1lenny1;found=squid%2F2.7.STABLE3-4.1;package=squid;collapse=1;info=1)

Package:
[squid](pkgreport.cgi?package=squid);
Maintainer for [squid](pkgreport.cgi?package=squid) is [Luigi Gangitano <luigi@debian.org>](pkgreport.cgi?maint=luigi%40debian.org); Source for [squid](pkgreport.cgi?package=squid) is [src:squid](pkgreport.cgi?src=squid) ([PTS](https://tracker.debian.org/pkg/squid), [buildd](https://buildd.debian.org/squid), [popcon](https://qa.debian.org/popcon.php?package=squid)).

Reported by: [Bastian Blank <waldi@debian.org>](pkgreport.cgi?submitter=waldi%40debian.org)

Date: Sun, 28 Jun 2009 18:21:02 UTC

Severity: *critical*

Tags: fixed-upstream, security

Found in version squid/2.7.STABLE3-4.1

Fixed in versions squid/2.7.STABLE7-1, squid/2.6.5-6etch5, squid/2.7.STABLE3-4.1lenny1

**Done:** Luigi Gangitano <luigi@debian.org>

Bug is archived. No further changes may be made.

Forwarded to <http://www.squid-cache.org/bugs/show_bug.cgi?id=2704>, merged-upstream: <http://www.squid-cache.org/bugs/show_bug.cgi?id=2541>

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=534982;mbox=yes), [status mbox](bugreport.cgi?bug=534982;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=534982;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Luigi Gangitano <luigi@debian.org>`:

`Bug#534982`; Package `squid`.
(Sun, 28 Jun 2009 18:21:04 GMT) ([full text](bugreport.cgi?bug=534982;msg=2), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Bastian Blank <waldi@debian.org>`:

New Bug report received and forwarded. Copy sent to `Luigi Gangitano <luigi@debian.org>`.
(Sun, 28 Jun 2009 18:21:04 GMT) ([full text](bugreport.cgi?bug=534982;msg=4), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=534982;msg=5), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=waldi%40debian.org)
From: Bastian Blank <waldi@debian.org>
To: submit@bugs.debian.org
Subject: squid - DoS in external auth header parser
Date: Sun, 28 Jun 2009 20:19:34 +0200
```
Package: squid
Version: 2.7.STABLE3-4.1
Severity: normal

My main squid reverse proxy suddenly stopped working after some days.
The last time it happened, I managed to dig a bit around and also got a
core dump and analyzed it as far as this works without debugging
symbols. This happened on my own rebuild with SSL enabled, but the
affected code region does not even consider SSL support.

Config excerpt:

| http_port 80 accel vhost defaultsite=example.com
| https_port 443 accel vhost defaultsite=example.com cert=/etc/squid/ssl/all options=NO_SSLv2
| icp_port 3130
|
| logformat combined %>a %ui %un [%tl] "%rm %ru HTTP/%rv" %Hs %<st %Ss %Sh/%<A "%{Referer}>h" "%{User-Agent}>h"
| cache_access_log /srv/squid/prod/log/access.log
| cache_access_log /srv/squid/prod/log/combined.log combined
| cache_log /srv/squid/prod/log/cache.log
| cache_store_log /srv/squid/prod/log/store.log
|
| acl accelerated_domains dstdomain example.com
| acl accelerated_protocols proto http https
|
| external_acl_type zope_auth ttl=0 %PATH %{Cookie:;__ac} /etc/squid/auth/auth /etc/squid/zope_auth.conf
| acl zope_auth external zope_auth
|
| http_access allow accelerated_domains accelerated_protocols zope_auth
| http_access deny all

Available threads:

| (gdb) info threads
|   17 process 17096  0x00002b7100488bc8 in strcspn () from /lib/libc.so.6
|   16 process 17138  0x00002b70ffd60d29 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0
|   15 process 17137  0x00002b70ffd60d29 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0
|   14 process 17136  0x00002b70ffd60d29 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0
|   13 process 17135  0x00002b70ffd60d29 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0
|   12 process 17134  0x00002b70ffd60d29 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0
|   11 process 17133  0x00002b70ffd60d29 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0
|   10 process 17132  0x00002b70ffd60d29 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0
|   9 process 17131  0x00002b70ffd60d29 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0
|   8 process 17130  0x00002b70ffd60d29 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0
|   7 process 17129  0x00002b70ffd60d29 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0
|   6 process 17128  0x00002b70ffd60d29 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0
|   5 process 17127  0x00002b70ffd60d29 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0
|   4 process 17126  0x00002b70ffd60d29 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0
|   3 process 17125  0x00002b70ffd60d29 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0
|   2 process 17124  0x00002b70ffd60d29 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0
| * 1 process 17123  0x00002b70ffd60d29 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/libpthread.so.0

So 16 threads suddenly waited for something shared and only the 17th did
something usefull.

Annotated backtrace of thread 17 (I had to reconstruct the function names from
a similar binary):

| (gdb) bt
| #0  0x00002b7100488bc8 in strcspn () from /lib/libc.so.6
| #1  0x0000000000456021 in ?? ()
0000000000455f80 g     F .text  0000000000000191              strListGetItem
| #2  0x000000000045395e in ?? ()
00000000004538b0 g     F .text  000000000000014a              httpHeaderGetListMember
| #3  0x000000000043923a in ?? ()
0000000000438e60 l     F .text  0000000000000648              makeExternalAclKey
| #4  0x0000000000439f6b in ?? ()
0000000000439e70 g     F .text  000000000000048c              aclMatchExternal
| #5  0x000000000040a24c in ?? ()
0000000000409f30 g     F .text  0000000000000eef              aclMatchAclList
| #6  0x000000000040ae61 in ?? ()
000000000040ae20 l     F .text  000000000000044d              aclCheck
| #7  0x000000000042652b in ?? ()
| #8  0x0000000000431105 in ?? ()
| #9  0x00000000004601a0 in ?? ()
| #10 0x00002b710042c1a6 in __libc_start_main () from /lib/libc.so.6

Register dump to show the parameters for strcspn:

| (gdb) info registers
| rax            0x0      0
| rbx            0x199d93d        26859837
| rcx            0x3      3
| rdx            0x199d93d        26859837
| rsi            0x700690 7341712
| rdi            0x199d93d        26859837
| rbp            0x0      0x0
| rsp            0x7fffab99df88   0x7fffab99df88
| r8             0x199d93d        26859837
| r9             0x1      1
| r10            0x353a39353a333220       3835440933431882272
| r11            0x2b71005153a0   47764336628640
| r12            0x7fffab99e130   140736072376624
| r13            0x7fffab99e128   140736072376616
| r14            0x3b     59
| r15            0x7fffab99e13c   140736072376636
| rip            0x2b7100488bc8   0x2b7100488bc8 <strcspn+24>

Parameters are in rsi and rdi:

| (gdb) print {char[5]}0x700690
| $14 = "\";,\000"
| (gdb) print {char[50]}0x199d93d
| $16 = ", 31-Dec-97 23:59:59 GMT; Max-Age=0", '\0' <repeats 14 times>

So it calls
| strcspn("\";,", ", 31-Dec-97 23:59:59 GMT; Max-Age=0")

But suddenly the value starts with ",", which is defined as a field
delimiter in the Cookie-header, but incorrectly used in this case.

More data:

| (gdb) print {char[100]}0x199d910
| $18 = "statusmessages=\"deleted\"; Path=/; Expires=Wed, 31-Dec-97 23:59:59 GMT; Max-Age=0", '\0' <repeats 19 times>

It loops around this strcspn call all the time. As far as I know always
with the same parameters.

Bastian

--
There is an order of things in this universe.
		-- Apollo, "Who Mourns for Adonais?" stardate 3468.1

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Luigi Gangitano <luigi@debian.org>`:

`Bug#534982`; Package `squid`.
(Sun, 28 Jun 2009 18:48:02 GMT) ([full text](bugreport.cgi?bug=534982;msg=7), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Bastian Blank <waldi@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Luigi Gangitano <luigi@debian.org>`.
(Sun, 28 Jun 2009 18:48:02 GMT) ([full text](bugreport.cgi?bug=534982;msg=9), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 534982@bugs.debian.org ([full text](bugreport.cgi?bug=534982;msg=10), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=waldi%40debian.org)
From: Bastian Blank <waldi@debian.org>
To: 534982@bugs.debian.org
Subject: Re: Bug#534982: Acknowledgement (squid - DoS in external auth
header parser)
Date: Sun, 28 Jun 2009 20:46:23 +0200
```
Digging into the code shows that this behaviour is clearly written
their[1]. It it only triggerable by either external auth or access log
formats which includes parts of headers with delimiters.

Bastian

[1]: src/HttpHeaderTools.c:239-283
--
Without facts, the decision cannot be made logically.  You must rely on
your human intuition.
		-- Spock, "Assignment: Earth", stardate unknown

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Luigi Gangitano <luigi@debian.org>`:

`Bug#534982`; Package `squid`.
(Mon, 06 Jul 2009 10:12:06 GMT) ([full text](bugreport.cgi?bug=534982;msg=12), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Bastian Blank <waldi@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Luigi Gangitano <luigi@debian.org>`.
(Mon, 06 Jul 2009 10:12:06 GMT) ([full text](bugreport.cgi?bug=534982;msg=14), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 534982@bugs.debian.org ([full text](bugreport.cgi?bug=534982;msg=15), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=waldi%40debian.org)
From: Bastian Blank <waldi@debian.org>
To: 534982@bugs.debian.org
Subject: squid - DoS in external auth helper
Date: Mon, 6 Jul 2009 12:09:17 +0200
```
severity 534982 important
tags 534982 security
thanks

No response from maintainer. As the cause is clear, I'm setting it to
appropriate values.

Bastian

--
There's coffee in that nebula!
		-- Capt. Kathryn Janeway, Star Trek: Voyager, "The Cloud"

```

---

**Severity set to `important' from `normal'**
Request was from `Bastian Blank <waldi@debian.org>`
to `control@bugs.debian.org`.
(Mon, 06 Jul 2009 10:12:07 GMT) ([full text](bugreport.cgi?bug=534982;msg=17), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=17), [link](#16)).

---

**Tags added: security**
Request was from `Bastian Blank <waldi@debian.org>`
to `control@bugs.debian.org`.
(Mon, 06 Jul 2009 10:12:08 GMT) ([full text](bugreport.cgi?bug=534982;msg=19), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=19), [link](#18)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#534982`; Package `squid`.
(Mon, 06 Jul 2009 17:15:03 GMT) ([full text](bugreport.cgi?bug=534982;msg=21), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=21), [link](#20)).

---

**Acknowledgement sent**
to `Luigi Gangitano <luigi@debian.org>`:

Extra info received and forwarded to list.
(Mon, 06 Jul 2009 17:15:03 GMT) ([full text](bugreport.cgi?bug=534982;msg=23), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=23), [link](#22)).

---

[Message #24](#24) received at 534982@bugs.debian.org ([full text](bugreport.cgi?bug=534982;msg=24), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=24), reply):

![](/cgi-bin/libravatar.cgi?email=luigi%40debian.org)
From: Luigi Gangitano <luigi@debian.org>
To: Bastian Blank <waldi@debian.org>,
534982@bugs.debian.org
Cc: control@bugs.debian.org
Subject: Re: Bug#534982: squid - DoS in external auth helper
Date: Mon, 6 Jul 2009 19:09:05 +0200
```
forwarded 534982 <http://www.squid-cache.org/bugs/show_bug.cgi?id=2704>
thanks

Hi Bastian,
sorry for the late reply. I'm forwarding this bug upstream, since the
issue is better handled there.

Regards,

L

--
Luigi Gangitano -- <luigi@debian.org> -- <gangitano@lugroma3.org>
GPG: 1024D/924C0C26: 12F8 9C03 89D3 DB4A 9972  C24A F19B A618 924C 0C26

```

---

**Noted your statement that Bug has been forwarded to <http://www.squid-cache.org/bugs/show_bug.cgi?id=2704>.**
Request was from `Luigi Gangitano <luigi@debian.org>`
to `control@bugs.debian.org`.
(Mon, 06 Jul 2009 17:15:04 GMT) ([full text](bugreport.cgi?bug=534982;msg=26), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=26), [link](#25)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Luigi Gangitano <luigi@debian.org>`:

`Bug#534982`; Package `squid`.
(Mon, 10 Aug 2009 18:30:02 GMT) ([full text](bugreport.cgi?bug=534982;msg=28), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=28), [link](#27)).

---

**Acknowledgement sent**
to `Bastian Blank <waldi@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Luigi Gangitano <luigi@debian.org>`.
(Mon, 10 Aug 2009 18:30:02 GMT) ([full text](bugreport.cgi?bug=534982;msg=30), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=30), [link](#29)).

---

[Message #31](#31) received at 534982@bugs.debian.org ([full text](bugreport.cgi?bug=534982;msg=31), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=31), reply):

![](/cgi-bin/libravatar.cgi?email=waldi%40debian.org)
From: Bastian Blank <waldi@debian.org>
To: 534982@bugs.debian.org
Subject: patch
Date: Mon, 10 Aug 2009 20:22:19 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=534982;msg=31) (text/plain, inline)]
```
```
The attached patch fixes the problem by eliminating the additional ","
as seperator. I found no sign why this was added in the first place
after some code reconstruction. Also it makes the code reentrant.

Bastian

--
We have phasers, I vote we blast 'em!
		-- Bailey, "The Corbomite Maneuver", stardate 1514.2

```
```
[[diff](bugreport.cgi?att=1;bug=534982;filename=diff;msg=31) (text/plain, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=2;bug=534982;filename=signature.asc;msg=31) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Luigi Gangitano <luigi@debian.org>`:

`Bug#534982`; Package `squid`.
(Wed, 19 Aug 2009 12:06:05 GMT) ([full text](bugreport.cgi?bug=534982;msg=33), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=33), [link](#32)).

---

**Acknowledgement sent**
to `Henrik Nordstrom <henrik@henriknordstrom.net>`:

Extra info received and forwarded to list. Copy sent to `Luigi Gangitano <luigi@debian.org>`.
(Wed, 19 Aug 2009 12:06:05 GMT) ([full text](bugreport.cgi?bug=534982;msg=35), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=35), [link](#34)).

---

[Message #36](#36) received at 534982@bugs.debian.org ([full text](bugreport.cgi?bug=534982;msg=36), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=36), reply):

![](/cgi-bin/libravatar.cgi?email=henrik%40henriknordstrom.net)
From: Henrik Nordstrom <henrik@henriknordstrom.net>
To: 534982@bugs.debian.org
Subject: Re: Bug#534982: squid - DoS in external auth helper
Date: Wed, 19 Aug 2009 13:47:34 +0200
```
The comma is there because comma is always a valid list separator in
HTTP headers due to rules on how multiple values of the same header may
be combined.

Regards
Henrik

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Luigi Gangitano <luigi@debian.org>`:

`Bug#534982`; Package `squid`.
(Wed, 19 Aug 2009 23:12:19 GMT) ([full text](bugreport.cgi?bug=534982;msg=38), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=38), [link](#37)).

---

**Acknowledgement sent**
to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Luigi Gangitano <luigi@debian.org>`.
(Wed, 19 Aug 2009 23:12:19 GMT) ([full text](bugreport.cgi?bug=534982;msg=40), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=40), [link](#39)).

---

[Message #41](#41) received at 534982@bugs.debian.org ([full text](bugreport.cgi?bug=534982;msg=41), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=41), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: 534982@bugs.debian.org
Subject: CVE id assigned
Date: Thu, 20 Aug 2009 01:04:40 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=534982;msg=41) (text/plain, inline)]
```
```
Hi,
[CVE-2009-2855](https://security-tracker.debian.org/tracker/CVE-2009-2855) was assigned to this issue, please make sure
to reference it in the changelog if you fix this bug.

Cheers
Nico

--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0xA0A0AAAA
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=534982;msg=41) (application/pgp-signature, inline)]
```

---

**Changed Bug forwarded-to-address to '<http://www.squid-cache.org/bugs/show_bug.cgi?id=2704>, merged-upstream: <http://www.squid-cache.org/bugs/show_bug.cgi?id=2541>' from '[http://www.squid-cache.org/bugs/show\_bug.cgi?id=2704'](http://www.squid-cache.org/bugs/show_bug.cgi?id=2704'</strong>)**
Request was from `bts-link-upstream@lists.alioth.debian.org`
to `control@bugs.debian.org`.
(Mon, 24 Aug 2009 19:48:19 GMT) ([full text](bugreport.cgi?bug=534982;msg=43), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=43), [link](#42)).

---

**Added tag(s) fixed-upstream.**
Request was from `bts-link-upstream@lists.alioth.debian.org`
to `control@bugs.debian.org`.
(Mon, 24 Aug 2009 19:48:19 GMT) ([full text](bugreport.cgi?bug=534982;msg=45), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=45), [link](#44)).

---

**Reply sent**
to `Luigi Gangitano <luigi@debian.org>`:

You have taken responsibility.
(Sun, 20 Sep 2009 13:09:06 GMT) ([full text](bugreport.cgi?bug=534982;msg=47), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=47), [link](#46)).

---

**Notification sent**
to `Bastian Blank <waldi@debian.org>`:

Bug acknowledged by developer.
(Sun, 20 Sep 2009 13:09:06 GMT) ([full text](bugreport.cgi?bug=534982;msg=49), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=49), [link](#48)).

---

[Message #50](#50) received at 534982-close@bugs.debian.org ([full text](bugreport.cgi?bug=534982;msg=50), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=50), reply):

![](/cgi-bin/libravatar.cgi?email=luigi%40debian.org)
From: Luigi Gangitano <luigi@debian.org>
To: 534982-close@bugs.debian.org
Subject: Bug#534982: fixed in squid 2.7.STABLE7-1
Date: Sun, 20 Sep 2009 12:48:47 +0000
```
Source: squid
Source-Version: 2.7.STABLE7-1

We believe that the bug you reported is fixed in the latest version of
squid, which is due to be installed in the Debian FTP archive:

squid-cgi_2.7.STABLE7-1_i386.deb
  to pool/main/s/squid/squid-cgi_2.7.STABLE7-1_i386.deb
squid-common_2.7.STABLE7-1_all.deb
  to pool/main/s/squid/squid-common_2.7.STABLE7-1_all.deb
squid_2.7.STABLE7-1.diff.gz
  to pool/main/s/squid/squid_2.7.STABLE7-1.diff.gz
squid_2.7.STABLE7-1.dsc
  to pool/main/s/squid/squid_2.7.STABLE7-1.dsc
squid_2.7.STABLE7-1_i386.deb
  to pool/main/s/squid/squid_2.7.STABLE7-1_i386.deb
squid_2.7.STABLE7.orig.tar.gz
  to pool/main/s/squid/squid_2.7.STABLE7.orig.tar.gz

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 534982@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Luigi Gangitano <luigi@debian.org> (supplier of updated squid package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Sun, 20 Sep 2009 01:25:52 +0200
Source: squid
Binary: squid squid-common squid-cgi
Architecture: source all i386
Version: 2.7.STABLE7-1
Distribution: unstable
Urgency: low
Maintainer: Luigi Gangitano <luigi@debian.org>
Changed-By: Luigi Gangitano <luigi@debian.org>
Description:
 squid      - Internet object cache (WWW proxy cache)
 squid-cgi  - Squid cache manager CGI program
 squid-common - Internet object cache (WWW proxy cache) - common files
Closes: [534982](bugreport.cgi?bug=534982) [541460](bugreport.cgi?bug=541460) [542723](bugreport.cgi?bug=542723)
Changes:
 squid (2.7.STABLE7-1) unstable; urgency=low
 .
   * New upstream release
     - Fixes DoS in exthernal auth header parser (Ref: [CVE-2009-2855](https://security-tracker.debian.org/tracker/CVE-2009-2855))
       (Closes: #[534982](bugreport.cgi?bug=534982))
 .
   * debian/squid.rc
     - Fixed init.d script dependencies, thanks to Petter Reinholdtsen
       (Closes: #[541460](bugreport.cgi?bug=541460))
 .
   * debian/{control,rules}
     - Added hardening build options (Closes: #[542723](bugreport.cgi?bug=542723))
 .
   * debian/control
     - Bumped Standard-Version to 3.8.3, no change needed
 .
   * debian/rules
     - Make link to squid-langpack directory relative
Checksums-Sha1:
 d8f1acc9eb27c6abce8021e2590e37f5e9ffef33 1149 squid_2.7.STABLE7-1.dsc
 94a385a494f50cf3394e226ce743ae3a3ad51440 1784325 squid_2.7.STABLE7.orig.tar.gz
 224e01851db33de12922a23bac8db76376eb1540 300374 squid_2.7.STABLE7-1.diff.gz
 8c8e1086d548cd9404a5219cf4f6e7fa7f46ec9f 351002 squid-common_2.7.STABLE7-1_all.deb
 4ce3033cd50e4b41022a03fe263d87f894ddcb92 759998 squid_2.7.STABLE7-1_i386.deb
 fab88dc10c8e7d40ea96b06bfbbb319d9870b956 121302 squid-cgi_2.7.STABLE7-1_i386.deb
Checksums-Sha256:
 d12f3409fabd082461ca9e3f91bc92d7666dfb41307915a7cc3c2ec82d712542 1149 squid_2.7.STABLE7-1.dsc
 2b926aece7d4beac0370d9b72899d3be7f48c29e973a1328666938a2e4c4ffa6 1784325 squid_2.7.STABLE7.orig.tar.gz
 9c84ede0dbb25df4d6f628b62d967f7b4c264b097290d31f5ff0215d5a836fb9 300374 squid_2.7.STABLE7-1.diff.gz
 e856b380dce72ae41bb6a8a05fe30fe3825b53d65c1263b7b5bad6b85670f331 351002 squid-common_2.7.STABLE7-1_all.deb
 3ab49ccb3a922e1fa7e15d8b6e7a5c0ba6ffa926409015300c06fe3087509d1d 759998 squid_2.7.STABLE7-1_i386.deb
 1516617bdf77a0b2f2cf401d74da6888d6d01a326591631acbe0fbbf436c5762 121302 squid-cgi_2.7.STABLE7-1_i386.deb
Files:
 03b8ffc57fffb5afa81b891aa8888da1 1149 web optional squid_2.7.STABLE7-1.dsc
 c506207f921a6da1878b4085e202e190 1784325 web optional squid_2.7.STABLE7.orig.tar.gz
 8fcd6411b77bfc1c2d7061c4f9dfabcc 300374 web optional squid_2.7.STABLE7-1.diff.gz
 401495f9e634e7ebfed42363c19cf0f8 351002 web optional squid-common_2.7.STABLE7-1_all.deb
 139c822f0553cb03cd1c4cb3dc89f13b 759998 web optional squid_2.7.STABLE7-1_i386.deb
 d3cb67378334c83132279663d584f3e4 121302 web optional squid-cgi_2.7.STABLE7-1_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (Darwin)

iEYEARECAAYFAkq2Ix0ACgkQ8ZumGJJMDCbdtACfW+YqEE/BUJQ4ULW0B3BnOBes
8W0AoIDtAuw7D/6tp0IaN14jjCtDmJuL
=QcCl
-----END PGP SIGNATURE-----

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Luigi Gangitano <luigi@debian.org>`:

`Bug#534982`; Package `squid`.
(Wed, 30 Sep 2009 16:21:09 GMT) ([full text](bugreport.cgi?bug=534982;msg=52), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=52), [link](#51)).

---

**Acknowledgement sent**
to `Terry Burton <tez@terryburton.co.uk>`:

Extra info received and forwarded to list. Copy sent to `Luigi Gangitano <luigi@debian.org>`.
(Wed, 30 Sep 2009 16:21:10 GMT) ([full text](bugreport.cgi?bug=534982;msg=54), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=54), [link](#53)).

---

[Message #55](#55) received at 534982@bugs.debian.org ([full text](bugreport.cgi?bug=534982;msg=55), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=55), reply):

![](/cgi-bin/libravatar.cgi?email=tez%40terryburton.co.uk)
From: Terry Burton <tez@terryburton.co.uk>
To: 534982@bugs.debian.org
Cc: team@security.debian.org
Subject: squid - DoS in external auth header parser
Date: Wed, 30 Sep 2009 17:08:42 +0100
```
reopen 534982
severity 534982 critical

This bug has recently hit us hard resulting in repeated DoS of a
production web service running on Debian Lenny.

What is the intended mitigation strategy for this DoS for users of
Debian Stable who rely on Squid support for external_acl_type? For the
time being I have had to rebuild appropriately patched squid packages
for Lenny to guard against this.

Since there will redoubtably be many production web servers running
Debian that are vulnerable to [CVE-2009-2855](https://security-tracker.debian.org/tracker/CVE-2009-2855) the patch should be
backported into the squid packages shipped with Lenny and released
through the security repository.

Thanks,

Terry

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Luigi Gangitano <luigi@debian.org>`:

`Bug#534982`; Package `squid`.
(Wed, 30 Sep 2009 17:30:04 GMT) ([full text](bugreport.cgi?bug=534982;msg=57), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=57), [link](#56)).

---

**Acknowledgement sent**
to `Florian Weimer <fw@deneb.enyo.de>`:

Extra info received and forwarded to list. Copy sent to `Luigi Gangitano <luigi@debian.org>`.
(Wed, 30 Sep 2009 17:30:04 GMT) ([full text](bugreport.cgi?bug=534982;msg=59), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=59), [link](#58)).

---

[Message #60](#60) received at 534982@bugs.debian.org ([full text](bugreport.cgi?bug=534982;msg=60), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=60), reply):

![](/cgi-bin/libravatar.cgi?email=fw%40deneb.enyo.de)
From: Florian Weimer <fw@deneb.enyo.de>
To: Terry Burton <tez@terryburton.co.uk>
Cc: 534982@bugs.debian.org, team@security.debian.org
Subject: Re: squid - DoS in external auth header parser
Date: Wed, 30 Sep 2009 16:49:49 +0000
```
* Terry Burton:

> This bug has recently hit us hard resulting in repeated DoS of a
> production web service running on Debian Lenny.

Do you know if this was triggered accidentally or deliberately?

> Since there will redoubtably be many production web servers running
> Debian that are vulnerable to [CVE-2009-2855](https://security-tracker.debian.org/tracker/CVE-2009-2855) the patch should be
> backported into the squid packages shipped with Lenny and released
> through the security repository.

Luigi, do you plan to prepare an update for (old)stable?

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Luigi Gangitano <luigi@debian.org>`:

`Bug#534982`; Package `squid`.
(Wed, 30 Sep 2009 17:30:07 GMT) ([full text](bugreport.cgi?bug=534982;msg=62), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=62), [link](#61)).

---

**Acknowledgement sent**
to `Terry Burton <tez@terryburton.co.uk>`:

Extra info received and forwarded to list. Copy sent to `Luigi Gangitano <luigi@debian.org>`.
(Wed, 30 Sep 2009 17:30:07 GMT) ([full text](bugreport.cgi?bug=534982;msg=64), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=64), [link](#63)).

---

[Message #65](#65) received at 534982@bugs.debian.org ([full text](bugreport.cgi?bug=534982;msg=65), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=65), reply):

![](/cgi-bin/libravatar.cgi?email=tez%40terryburton.co.uk)
From: Terry Burton <tez@terryburton.co.uk>
To: Florian Weimer <fw@deneb.enyo.de>
Cc: 534982@bugs.debian.org, team@security.debian.org
Subject: Re: squid - DoS in external auth header parser
Date: Wed, 30 Sep 2009 17:58:36 +0100
```
On Wed, Sep 30, 2009 at 5:49 PM, Florian Weimer <fw@deneb.enyo.de> wrote:
> * Terry Burton:
>
>> This bug has recently hit us hard resulting in repeated DoS of a
>> production web service running on Debian Lenny.
>
> Do you know if this was triggered accidentally or deliberately?

Florian,

Probably accidentally, though it may possibly have been deliberate.

(I will disclose further information privately as a follow up to this message.)

Many thanks,

Terry

```

---

**Bug No longer marked as fixed in versions squid/2.7.STABLE7-1 and reopened.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Wed, 30 Sep 2009 17:33:41 GMT) ([full text](bugreport.cgi?bug=534982;msg=67), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=67), [link](#66)).

---

**Severity set to 'critical' from 'important'**
Request was from `Terry Burton <tez@terryburton.co.uk>`
to `control@bugs.debian.org`.
(Wed, 30 Sep 2009 17:33:42 GMT) ([full text](bugreport.cgi?bug=534982;msg=69), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=69), [link](#68)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Luigi Gangitano <luigi@debian.org>`:

`Bug#534982`; Package `squid`.
(Mon, 12 Oct 2009 22:30:02 GMT) ([full text](bugreport.cgi?bug=534982;msg=71), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=71), [link](#70)).

---

**Acknowledgement sent**
to `Amos Jeffries <squid3@treenet.co.nz>`:

Extra info received and forwarded to list. Copy sent to `Luigi Gangitano <luigi@debian.org>`.
(Mon, 12 Oct 2009 22:30:03 GMT) ([full text](bugreport.cgi?bug=534982;msg=73), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=73), [link](#72)).

---

[Message #74](#74) received at 534982@bugs.debian.org ([full text](bugreport.cgi?bug=534982;msg=74), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=74), reply):

![](/cgi-bin/libravatar.cgi?email=squid3%40treenet.co.nz)
From: Amos Jeffries <squid3@treenet.co.nz>
To: <534982@bugs.debian.org>
Cc: <team@security.debian.org>
Subject: Re: squid - DoS in external auth header parser
Date: Tue, 13 Oct 2009 11:23:47 +1300
```
I see "Bug No longer marked as fixed in versions squid/2.7.STABLE7-1 and
reopened." above.

Is this correct and 2.7.STABLE7 still showing the vulnerable behaviour?

Terry:  If possible I'd like to see some details of the event, for my
interest.

Amos
Squid Team

```

---

**Bug Marked as fixed in versions squid/2.7.STABLE7-1.**
Request was from `Luigi Gangitano <luigi@debian.org>`
to `control@bugs.debian.org`.
(Thu, 03 Dec 2009 17:21:04 GMT) ([full text](bugreport.cgi?bug=534982;msg=76), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=76), [link](#75)).

---

**Reply sent**
to `Steffen Joeris <white@debian.org>`:

You have taken responsibility.
(Tue, 23 Feb 2010 20:18:05 GMT) ([full text](bugreport.cgi?bug=534982;msg=78), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=78), [link](#77)).

---

**Notification sent**
to `Bastian Blank <waldi@debian.org>`:

Bug acknowledged by developer.
(Tue, 23 Feb 2010 20:18:06 GMT) ([full text](bugreport.cgi?bug=534982;msg=80), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=80), [link](#79)).

---

[Message #81](#81) received at 534982-close@bugs.debian.org ([full text](bugreport.cgi?bug=534982;msg=81), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=81), reply):

![](/cgi-bin/libravatar.cgi?email=white%40debian.org)
From: Steffen Joeris <white@debian.org>
To: 534982-close@bugs.debian.org
Subject: Bug#534982: fixed in squid 2.6.5-6etch5
Date: Tue, 23 Feb 2010 20:16:21 +0000
```
Source: squid
Source-Version: 2.6.5-6etch5

We believe that the bug you reported is fixed in the latest version of
squid, which is due to be installed in the Debian FTP archive:

squid-cgi_2.6.5-6etch5_i386.deb
  to main/s/squid/squid-cgi_2.6.5-6etch5_i386.deb
squid-common_2.6.5-6etch5_all.deb
  to main/s/squid/squid-common_2.6.5-6etch5_all.deb
squid_2.6.5-6etch5.diff.gz
  to main/s/squid/squid_2.6.5-6etch5.diff.gz
squid_2.6.5-6etch5.dsc
  to main/s/squid/squid_2.6.5-6etch5.dsc
squid_2.6.5-6etch5_i386.deb
  to main/s/squid/squid_2.6.5-6etch5_i386.deb
squidclient_2.6.5-6etch5_i386.deb
  to main/s/squid/squidclient_2.6.5-6etch5_i386.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 534982@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Steffen Joeris <white@debian.org> (supplier of updated squid package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.7
Date: Wed,  3 Feb 2010 13:07:51 +0000
Source: squid
Binary: squid squid-cgi squidclient squid-common
Architecture: source i386 all
Version: 2.6.5-6etch5
Distribution: oldstable-security
Urgency: high
Maintainer: Luigi Gangitano <luigi@debian.org>
Changed-By: Steffen Joeris <white@debian.org>
Description:
 squid      - Internet Object Cache (WWW proxy cache)
 squid-cgi  - Squid cache manager CGI program
 squid-common - Internet Object Cache (WWW proxy cache) - common file
 squidclient - Command line URL extractor that talks to (a) squid
Closes: [534982](bugreport.cgi?bug=534982)
Changes:
 squid (2.6.5-6etch5) oldstable-security; urgency=high
 .
   * Non-maintainer upload by the security team
   * Fix denial of service via invalid DNS header-only packets
     Fixes: [CVE-2010-0308](https://security-tracker.debian.org/tracker/CVE-2010-0308)
   * Fix denial of service via a crafted auth header with certain comma
     delimiters (Closes: #[534982](bugreport.cgi?bug=534982))
     Fixes: [CVE-2009-2855](https://security-tracker.debian.org/tracker/CVE-2009-2855)
Files:
 2e53013dd1d22bc98d694c4b0775a715 678 web optional squid_2.6.5-6etch5.dsc
 f35fba0ebbd63b22786d04c8775aacf6 274283 web optional squid_2.6.5-6etch5.diff.gz
 69401a11436668a2e47c1886ed671d97 439698 web optional squid-common_2.6.5-6etch5_all.deb
 d63eacb8a0dec6db6f789e40bbcbc404 654880 web optional squid_2.6.5-6etch5_i386.deb
 6688fcc15664c2eb7c8326bac53188bb 86030 web optional squidclient_2.6.5-6etch5_i386.deb
 1a907bd4666d4de8298b99a6b97d8b9c 117372 web optional squid-cgi_2.6.5-6etch5_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iEYEARECAAYFAktpd1kACgkQ62zWxYk/rQfpwACfezXjR/f51W3MEwaNO3Sao7r3
Q9IAoJsdaxSIH3+yPtTJdCsXSOQn41OH
=AYM8
-----END PGP SIGNATURE-----

```

---

**Reply sent**
to `Luigi Gangitano <luigi@debian.org>`:

You have taken responsibility.
(Thu, 30 Sep 2010 02:00:03 GMT) ([full text](bugreport.cgi?bug=534982;msg=83), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=83), [link](#82)).

---

**Notification sent**
to `Bastian Blank <waldi@debian.org>`:

Bug acknowledged by developer.
(Thu, 30 Sep 2010 02:00:03 GMT) ([full text](bugreport.cgi?bug=534982;msg=85), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=85), [link](#84)).

---

[Message #86](#86) received at 534982-close@bugs.debian.org ([full text](bugreport.cgi?bug=534982;msg=86), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=86), reply):

![](/cgi-bin/libravatar.cgi?email=luigi%40debian.org)
From: Luigi Gangitano <luigi@debian.org>
To: 534982-close@bugs.debian.org
Subject: Bug#534982: fixed in squid 2.7.STABLE3-4.1lenny1
Date: Thu, 30 Sep 2010 01:57:16 +0000
```
Source: squid
Source-Version: 2.7.STABLE3-4.1lenny1

We believe that the bug you reported is fixed in the latest version of
squid, which is due to be installed in the Debian FTP archive:

squid-cgi_2.7.STABLE3-4.1lenny1_i386.deb
  to main/s/squid/squid-cgi_2.7.STABLE3-4.1lenny1_i386.deb
squid-common_2.7.STABLE3-4.1lenny1_all.deb
  to main/s/squid/squid-common_2.7.STABLE3-4.1lenny1_all.deb
squid_2.7.STABLE3-4.1lenny1.diff.gz
  to main/s/squid/squid_2.7.STABLE3-4.1lenny1.diff.gz
squid_2.7.STABLE3-4.1lenny1.dsc
  to main/s/squid/squid_2.7.STABLE3-4.1lenny1.dsc
squid_2.7.STABLE3-4.1lenny1_i386.deb
  to main/s/squid/squid_2.7.STABLE3-4.1lenny1_i386.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 534982@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Luigi Gangitano <luigi@debian.org> (supplier of updated squid package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Thu, 14 Jan 2010 23:10:06 +0100
Source: squid
Binary: squid squid-common squid-cgi
Architecture: source all i386
Version: 2.7.STABLE3-4.1lenny1
Distribution: stable-security
Urgency: high
Maintainer: Luigi Gangitano <luigi@debian.org>
Changed-By: Luigi Gangitano <luigi@debian.org>
Description:
 squid      - Internet object cache (WWW proxy cache)
 squid-cgi  - Squid cache manager CGI program
 squid-common - Internet object cache (WWW proxy cache) - common files
Closes: [534982](bugreport.cgi?bug=534982)
Changes:
 squid (2.7.STABLE3-4.1lenny1) stable-security; urgency=high
 .
   * Urgency high due to security fixes
 .
   * debian/patches/71-CVE-2009-2855
     - Fix DoS vuln (Ref: [CVE-2009-2855](https://security-tracker.debian.org/tracker/CVE-2009-2855))(Closes: #[534982](bugreport.cgi?bug=534982))
 .
   [Steffen Joeris]
   * Fix denial of service via invalid DNS header-only packets
     Fixes: [CVE-2010-0308](https://security-tracker.debian.org/tracker/CVE-2010-0308)
Checksums-Sha1:
 ab93a45f872d6a2e35331c587d0b10b83e617227 1165 squid_2.7.STABLE3-4.1lenny1.dsc
 0c99054d5fd6537da467acbf299ffe5f1a542ae3 1782040 squid_2.7.STABLE3.orig.tar.gz
 18646954a58b9429955a7debe953af8294580e74 304919 squid_2.7.STABLE3-4.1lenny1.diff.gz
 d3695cc6bb47f272b182e6e7a457aca8e4766e07 493526 squid-common_2.7.STABLE3-4.1lenny1_all.deb
 f489a0cfe3b1850928bded323a5561bb2b0a970a 688540 squid_2.7.STABLE3-4.1lenny1_i386.deb
 948c43ac408a887055da4925ac5baa83d7f10b77 117732 squid-cgi_2.7.STABLE3-4.1lenny1_i386.deb
Checksums-Sha256:
 c3fc3dbe7375a94e6cf26c06c6558333318ba0f438eab0b61780a3d4daa353fe 1165 squid_2.7.STABLE3-4.1lenny1.dsc
 d987578c6ca26ca8c8d6fad920580cc39b6ebe95c8ff727b1b6d3c5625fe428d 1782040 squid_2.7.STABLE3.orig.tar.gz
 733555967e6cbd9c1b1cc6f6653a4b84b53a819676c7236badbfa58dc328ef47 304919 squid_2.7.STABLE3-4.1lenny1.diff.gz
 43069bf07797f0a95e674a1f96deaf5bc22aed687111537e110f8791d7caa9af 493526 squid-common_2.7.STABLE3-4.1lenny1_all.deb
 ea094591664aa9b1e2af44e554928ca12333080f302d5b34140849cdcfcd313c 688540 squid_2.7.STABLE3-4.1lenny1_i386.deb
 71e23af41990dd19c43c39ff8bdf52b86d906f1409041b942f8ce2cfb95fc6ba 117732 squid-cgi_2.7.STABLE3-4.1lenny1_i386.deb
Files:
 3d00959e8a0e1b88d81a1c3bdaef1676 1165 web optional squid_2.7.STABLE3-4.1lenny1.dsc
 a4d7608696e2b617aa5853c7d23e25b0 1782040 web optional squid_2.7.STABLE3.orig.tar.gz
 c9b0294c475b0d3118d25a60e8bb17d1 304919 web optional squid_2.7.STABLE3-4.1lenny1.diff.gz
 812524fc4efa57618ed4d1def3dcc720 493526 web optional squid-common_2.7.STABLE3-4.1lenny1_all.deb
 30387d06ef752feb274c3e3171028296 688540 web optional squid_2.7.STABLE3-4.1lenny1_i386.deb
 ae221ec979f6984ca5ed89b76239df13 117732 web optional squid-cgi_2.7.STABLE3-4.1lenny1_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iEYEARECAAYFAktpcPUACgkQ62zWxYk/rQeR2QCdGpM/AVZGiWPOEzDzNoN8PdJZ
dnEAnj53gWrrg7c+OjHLk2Qts8nmjtUu
=aRrj
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sun, 28 Nov 2010 07:33:48 GMT) ([full text](bugreport.cgi?bug=534982;msg=88), [mbox](bugreport.cgi?bug=534982;mbox=yes;msg=88), [link](#87)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=534982).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 23:59:33 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from bugzilla.redhat.com_35fb552b_20250124_235941.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D518182)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D518182)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D518182)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 518182

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 518182**](show_bug.cgi?id=518182)
(CVE-2009-2855)
- [CVE-2009-2855](https://access.redhat.com/security/cve/CVE-2009-2855) squid: DoS (100% CPU use) while processing certain external ACL helper HTTP headers

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2009-2855 squid: DoS (100% CPU use) while processing certain external ACL...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2009-2855 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [http://www.squid-cache.org/bugs/show\_...](http://www.squid-cache.org/bugs/show_bug.cgi?id=2704) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | Duplicates (1): | [509895](show_bug.cgi?id=509895 "CLOSED DUPLICATE - squid DoS in external auth header parser")  ([view as bug list](buglist.cgi?bug_id=509895)) | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [561828](show_bug.cgi?id=561828) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=518182&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=518182&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2009-08-19 11:22 UTC by Jan Lieskovsky | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-11-12 19:59 UTC ([History](show_activity.cgi?id=518182)) | | [CC List:](page.cgi?id=fields.html#cclist) | 6 users (show)  henrik jskala kreilly mbacovsk mjc vdanen | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2010-03-31 06:58:59 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2010:0221](https://access.redhat.com/errata/RHSA-2010%3A0221) | 0 | normal | SHIPPED\_LIVE | Low: squid security and bug fix update | 2010-03-29 12:32:22 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=518182#c0)  Jan Lieskovsky    2009-08-19 11:22:25 UTC  ``` A denial of service flaw was found in the way Squid used to process certain external ACL helper HTTP-Header fields (%{header:<delimiter>member}), where <delimiter> is not a comma. Remote attacker could use this flaw to cause an excessive CPU use by issuing such a request to the Squid server.   Common Vulnerabilities and Exposures assigned an identifier [CVE-2009-2855](https://access.redhat.com/security/cve/CVE-2009-2855) to this vulnerability: ------------------------------------------------------------------------------  The strListGetItem function in src/HttpHeaderTools.c in Squid 2.7 allows remote attackers to cause a denial of service via a crafted auth header with certain comma delimiters that trigger an infinite loop of calls to the strcspn function.  References: ----------- [1] <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2855> [2] <http://www.openwall.com/lists/oss-security/2009/07/20/10> [3] <http://www.openwall.com/lists/oss-security/2009/08/03/3> [4] <http://www.openwall.com/lists/oss-security/2009/08/04/6> [5] <http://bugs.debian.org/cgi-bin/bugreport.cgi?msg=31;filename=diff;att=1;bug=534982> [6] <http://www.squid-cache.org/bugs/show_bug.cgi?id=2704> [7] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=534982>  Note: The proposed patch from Debian [6] isn't the upstream one.       Please wait, while upstream confirms it or comes with another       one.  Upstream bug report: --------------------      <http://www.squid-cache.org/bugs/show_bug.cgi?id=2541>   ```  [Comment 1](show_bug.cgi?id=518182#c1)  Henrik Nordström    2009-08-19 11:59:59 UTC  ``` Upstream resport updated.  Correction to description: It's not related to auth but the use of external_acl_type %{header:<delimiter>member} where <delimiter> is not a comma. This is most often used for extracting cookie details for use in access controls.  The debian proposed patch is not correct, and was never reported upstream. But there is another patch reported upstream which is on the right track.   ```  [Comment 2](show_bug.cgi?id=518182#c2)  Jan Lieskovsky    2009-08-19 12:38:26 UTC  ``` (In reply to [comment #1](show_bug.cgi?id=518182#c1)) > Upstream resport updated.  Hello Henrik,      thank you for your prompt reaction.   >  > Correction to description: It's not related to auth but the use of > external_acl_type %{header:<delimiter>member} where <delimiter> is not a comma. > This is most often used for extracting cookie details for use in access > controls.  Ok, will find out more background details from the relevant, affected code and change it.  >  > The debian proposed patch is not correct, and was never reported upstream. But > there is another patch reported upstream which is on the right track.    Which of the two patches is considered to be applied by upstream?:      <http://www.squid-cache.org/bugs/attachment.cgi?id=1854>  or the second one:      <http://www.squid-cache.org/bugs/show_bug.cgi?id=2541#c1>  Both of them don't seem to affect not only Squid 2.7 (as mentioned in the CVE description), but also older versions (found same relevant code parts also in squid-2.5.STABLE3, squid-2.5.STABLE14 and also squid-2.6.STABLE21) -- could you confirm?  Also -- is the comma as separator the only problematic case, or should we consider also handling of "?,", "\", "\\" cases within the patch?  Thanks, Jan.   ```  [Comment 3](show_bug.cgi?id=518182#c3)  Henrik Nordström    2009-08-19 15:07:55 UTC  ``` Thanks for the reminder. I hadn't noticed the debian bug report, and the other report with a patch that is on the right track had a bad subject which made it go unnoticed as well..  As already commented by Alex the suggestion by Amos is not correct. The attachment is more in line with the needed changes. I have not yet studied the code to say if that patch is fine as it is or need cleanup before commit.  The issue affects most Squid versions sine that format was introduced in external_acl_type, 2.6 is quite likely affected as well.   ```  [Comment 4](show_bug.cgi?id=518182#c4)  Vincent Danen    2009-08-24 14:26:00 UTC  ``` *** [Bug 509895](show_bug.cgi?id=509895 "CLOSED DUPLICATE - squid DoS in external auth header parser") has been marked as a duplicate of this bug. ***   ```  [Comment 5](show_bug.cgi?id=518182#c5)  Henrik Nordström    2009-08-24 21:38:27 UTC  ``` A fix for this is available in Squid-2.HEAD since some days. Should backport easily to earlier releases, and will get backported to 2.7 and maybe 2.6 in the next upstream maintenance round.  <http://www.squid-cache.org/Versions/v2/HEAD/changesets/12541.patch>   A sample test case is as follows:  -- test-helper.sh (executable) --- #!/bin/sh while read line; do   echo OK done -- end test-helper.sh  -- squid.conf  (before where access is normally allowed) -- external_acl_type test %{Test:;test} /path/to/test-helper.sh acl test external test http_access deny !test -- end squid.conf --  -- test command -- /usr/bin/squidclient -H "Test: a, b, test=test\n" <http://www.squid-cache.org/> -- end test command --  Regards Henrik   ```  [Comment 7](show_bug.cgi?id=518182#c7)  Jan Lieskovsky    2009-09-11 13:04:44 UTC  ``` This issue does NOT affect the versions of the Squid package, as shipped with Red Hat Enterprise Linux 3 and 4.  This issue affects the version of the Squid package, as shipped with Red Hat Enterprise Linux 5.  This issue does NOT affect the versions of the Squid package, as shipped with Fedora releases of 10 and 11.   ```  [Comment 8](show_bug.cgi?id=518182#c8)  Jan Lieskovsky    2009-09-11 13:06:17 UTC  ``` Official statement from Red Hat Security Response Team regarding this issue: ----------------------------------------------------------------------------  The Red Hat Security Response Team has rated this issue as having low security impact, a future Squid package update may address this flaw in Red Hat Enterprise Linux 5. More information regarding issue severity can be found here: <http://www.redhat.com/security/updates/classification/>   ```  [Comment 10](show_bug.cgi?id=518182#c10)  errata-xmlrpc    2010-03-30 08:18:19 UTC  ``` This issue has been addressed in following products:    Red Hat Enterprise Linux 5  Via RHSA-2010:0221 <https://rhn.redhat.com/errata/RHSA-2010-0221.html>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=518182&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.openwall.com_eff2d8ae_20250124_235937.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](../../../2009/08/04/1) [[<thread-prev]](../../../2009/07/20/10) [[thread-next>]](../../../2009/08/04/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <Pine.LNX.4.64.0908032141170.29719@forced.attrition.org>
Date: Mon, 3 Aug 2009 21:43:38 +0000 (UTC)
From: security curmudgeon <jericho@...rition.org>
To: oss-security@...ts.openwall.com
Subject: Re: squid DoS in external auth header parser

: I noticed this on Debian's bts [1] and also on upstream's bugzilla [2]
: but no CVE has been assigned (not sure if one has been requested or not,
: but I've not seen a request come through here).
:
: By the initial looks of things, it seems to be a fairly low severity
: issue and may not be easy to duplicate/trigger.  The reporter didn't really
: provide much in the way of a reproducer or relevant configs (and the
: reference to zope auths makes me not even want to touch it).
:
: Has anyone taken a look at this or has a CVE been requested for it?
: Upstream has done nothing with this despite it being reported two weeks
: ago.
:
: [1] <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=534982>
: [2] <http://www.squid-cache.org/bugs/show_bug.cgi?id=2704>

Were these fixed with the recent release?

<http://www.squid-cache.org/Advisories/SQUID-2009_2.txt>

The creditee section does not mention Bastian Blank (original) or Luigi
Gangitano (Debian, reported upstream). The related Squid bug report (2704)
is still marked UNCONFIRMED and has no resolution.

I'm guessing this is still an outstanding issue.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from security-tracker.debian.org_2372547e_20250126_043940.html ===

# CVE-2009-2855

| **Name** | CVE-2009-2855 |
| --- | --- |
| **Description** | The strListGetItem function in src/HttpHeaderTools.c in Squid 2.7 allows remote attackers to cause a denial of service via a crafted auth header with certain comma delimiters that trigger an infinite loop of calls to the strcspn function. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2009-2855) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2009-2855); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2009-2855), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2009-2855), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2009-2855), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2009-2855), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2009-2855), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2009-2855), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2009-2855), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2009-2855)/[CVE](https://www.suse.com/security/cve/CVE-2009-2855/), GitHub [advisories](https://github.com/advisories?query=CVE-2009-2855)/[code](https://github.com/search?type=Code&q=%22CVE-2009-2855%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2009-2855%22), [web search](https://duckduckgo.com/html?q=%22CVE-2009-2855%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DSA-1991-1](/tracker/DSA-1991-1) |
| **Debian Bugs** | [534982](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=534982) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [squid](/tracker/source-package/squid) ([PTS](https://tracker.debian.org/pkg/squid)) | bullseye (security), bullseye | 4.13-10+deb11u3 | fixed |
|  | bookworm, bookworm (security) | 5.7-2+deb12u2 | fixed |
|  | sid, trixie | 6.12-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [squid](/tracker/source-package/squid) | source | etch | 2.6.5-6etch5 |  | [DSA-1991-1](/tracker/DSA-1991-1) |  |
| [squid](/tracker/source-package/squid) | source | lenny | 2.7.STABLE3-4.1lenny1 |  | [DSA-1991-1](/tracker/DSA-1991-1) |  |
| [squid](/tracker/source-package/squid) | source | (unstable) | 2.7.STABLE7-1 | low |  | [534982](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=534982) |
| [squid3](/tracker/source-package/squid3) | source | etch | 3.0.PRE5-5+etch2 |  | [DSA-1991-1](/tracker/DSA-1991-1) |  |
| [squid3](/tracker/source-package/squid3) | source | lenny | 3.0.STABLE8-3+lenny3 |  | [DSA-1991-1](/tracker/DSA-1991-1) |  |
| [squid3](/tracker/source-package/squid3) | source | (unstable) | 3.0.STABLE19-1 |  |  |  |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)


