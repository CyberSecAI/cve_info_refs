```
{
  "CVE-2009-2228": {
    "related": true,
    "summary": "Kasseler CMS is vulnerable to file disclosure and cross-site scripting (XSS).",
    "details": {
      "File Disclosure": {
        "root_cause": "The `download()` function in `engine.php` uses user-supplied input from the `file` parameter without sufficient sanitization to construct a file path, leading to arbitrary file disclosure.",
        "vulnerability": "The vulnerability lies in the following code within the `download()` function:\n```php\n$file = \"uploads/\" . $_GET['file'];\n```\nBy manipulating the `file` parameter (e.g., using `../` sequences), an attacker can access files outside the intended `uploads` directory, such as the configuration file (`configdb.php`).",
         "impact": "An attacker can read sensitive files on the server, potentially exposing database credentials and other configuration information.",
        "attack_vector": "By sending a crafted HTTP GET request to `engine.php?do=download&file=...` with a manipulated `file` parameter.",
        "attacker_capabilities": "The attacker needs to be able to send HTTP requests to the server hosting the vulnerable application."
      },
       "Cross-Site Scripting (XSS)": {
        "root_cause": "The `redirect()` function in `engine.php` directly uses user-supplied input from the `url` parameter without sanitization, allowing execution of arbitrary Javascript.",
        "vulnerability": "The vulnerability lies in the `redirect` function, where the `url` parameter from the request is directly used without sanitization. This allows for the injection of arbitrary javascript using a `data:` URI.",
        "impact": "An attacker can execute arbitrary JavaScript in the victim's browser, which can be used to steal cookies, redirect the user to malicious websites, or perform other malicious actions on behalf of the user.",
         "attack_vector": "By sending a crafted HTTP GET request to `engine.php?do=redirect&url=...` with a malicious `data:` URI.",
        "attacker_capabilities": "The attacker needs to be able to send HTTP requests to the server hosting the vulnerable application."
      }
    }
  }
}
```