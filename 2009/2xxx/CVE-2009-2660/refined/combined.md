=== Content from bugs.gentoo.org_66ae535b_20250124_115514.html ===
Index: src/gifread.c
===================================================================
--- src/gifread.c.orig
+++ src/gifread.c
@@ -20,6 +20,8 @@
#include
#include
+#include "oversized.h"
+
#include
#include
@@ -191,6 +193,9 @@ value dGifGetLine( value hdl )
GifFileType \*GifFile = (GifFileType\*) hdl;
+ if( oversized( GifFile->Image.Width, sizeof(GifPixelType) ) ){
+ failwith\_oversized("gif");
+ }
buf = alloc\_string( GifFile->Image.Width \* sizeof(GifPixelType) );
if( DGifGetLine(GifFile, String\_val(buf), GifFile->Image.Width )
Index: src/jpegread.c
===================================================================
--- src/jpegread.c.orig
+++ src/jpegread.c
@@ -20,6 +20,8 @@
#include
#include
+#include "oversized.h"
+
#include
#include
@@ -156,6 +158,12 @@ read\_JPEG\_file (value name)
\*/
/\* JSAMPLEs per row in output buffer \*/
+ if( oversized(cinfo.output\_width, cinfo.output\_components) ){
+ jpeg\_destroy\_decompress(&cinfo);
+ fclose(infile);
+ failwith\_oversized("jpeg");
+ }
+
row\_stride = cinfo.output\_width \* cinfo.output\_components;
/\* Make a one-row-high sample array that will go away when done with image \*/
@@ -177,6 +185,12 @@ read\_JPEG\_file (value name)
jpeg\_read\_scanlines(&cinfo, buffer + cinfo.output\_scanline, 1);
}
+ if( oversized(row\_stride, cinfo.output\_height) ){
+ jpeg\_destroy\_decompress(&cinfo);
+ fclose(infile);
+ failwith\_oversized("jpeg");
+ }
+
{
CAMLlocalN(r,3);
r[0] = Val\_int(cinfo.output\_width);
@@ -352,6 +366,7 @@ value open\_jpeg\_file\_for\_read\_start( jpe
{
CAMLlocalN(r,3);
+ // CR jfuruse: integer overflow
r[0] = Val\_int(cinfop->output\_width);
r[1] = Val\_int(cinfop->output\_height);
r[2] = alloc\_tuple(3);
Index: src/oversized.h
===================================================================
--- /dev/null
+++ src/oversized.h
@@ -0,0 +1,9 @@
+#include
+/\* Test if x or y are negative, or if multiplying x \* y would cause an
+ \* arithmetic overflow.
+ \*/
+#define oversized(x, y) \
+ ((x) < 0 || (y) < 0 || ((y) != 0 && (x) > INT\_MAX / (y)))
+
+#define failwith\_oversized(lib) \
+ failwith("#lib error: image contains oversized or bogus width and height");
Index: src/pngread.c
===================================================================
--- src/pngread.c.orig
+++ src/pngread.c
@@ -17,6 +17,8 @@
#include
+#include "oversized.h"
+
#include
#include
#include
@@ -81,6 +83,9 @@ value read\_png\_file\_as\_rgb24( name )
png\_get\_IHDR(png\_ptr, info\_ptr, &width, &height, &bit\_depth, &color\_type,
&interlace\_type, NULL, NULL);
+ if (oversized (width, height))
+ failwith\_oversized("png");
+
if ( color\_type == PNG\_COLOR\_TYPE\_GRAY ||
color\_type == PNG\_COLOR\_TYPE\_GRAY\_ALPHA ) {
png\_set\_gray\_to\_rgb(png\_ptr);
@@ -102,10 +107,16 @@ value read\_png\_file\_as\_rgb24( name )
rowbytes = png\_get\_rowbytes(png\_ptr, info\_ptr);
+ if (oversized (rowbytes, height))
+ failwith\_oversized("png");
+
{
int i;
png\_bytep \*row\_pointers;
+ if (oversized (sizeof (png\_bytep), height))
+ failwith\_oversized("png");
+
row\_pointers = (png\_bytep\*) stat\_alloc(sizeof(png\_bytep) \* height);
res = alloc\_tuple(3);
@@ -235,6 +246,9 @@ value read\_png\_file( name )
png\_get\_IHDR(png\_ptr, info\_ptr, &width, &height, &bit\_depth, &color\_type,
&interlace\_type, NULL, NULL);
+ if (oversized (width, height))
+ failwith\_oversized("png");
+
if ( color\_type == PNG\_COLOR\_TYPE\_GRAY ||
color\_type == PNG\_COLOR\_TYPE\_GRAY\_ALPHA ) {
png\_set\_gray\_to\_rgb(png\_ptr);
@@ -251,6 +265,9 @@ value read\_png\_file( name )
rowbytes = png\_get\_rowbytes(png\_ptr, info\_ptr);
+ if (oversized (rowbytes, height))
+ failwith\_oversized("png");
+
/\*
fprintf(stderr, "pngread.c: actual loading\n"); fflush(stderr);
\*/
@@ -259,6 +276,9 @@ fprintf(stderr, "pngread.c: actual loadi
png\_bytep \*row\_pointers;
char mesg[256];
+ if (oversized (sizeof (png\_bytep), height))
+ failwith\_oversized("png");
+
row\_pointers = (png\_bytep\*)stat\_alloc(sizeof(png\_bytep) \* height);
res = alloc\_tuple(3);


=== Content from www.debian.org_cfcb3daf_20250124_115507.html ===


---

[[Date Prev](msg00173.html)][[Date Next](msg00175.html)]
[[Thread Prev](msg00173.html)][[Thread Next](msg00175.html)]
[[Date Index](maillist.html#00174)]
[[Thread Index](threads.html#00174)]

# [SECURITY] [DSA 1857-1] New camlimages packages fix arbitrary code execution

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 1857-1] New camlimages packages fix arbitrary code execution
* *From*: white@debian.org (Steffen Joeris)
* *Date*: Mon, 10 Aug 2009 10:55:14 +1000 (EST)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20090810005514.DAEAB84846F%40hannah.localdomain)Â [20090810005514.DAEAB84846F@hannah.localdomain](msg00174.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- ------------------------------------------------------------------------
Debian Security Advisory DSA-1857-1                  security@debian.org
<http://www.debian.org/security/>                      Steffen Joeris
August 10, 2009                       <http://www.debian.org/security/faq>
- ------------------------------------------------------------------------

Package        : camlimages
Vulnerability  : integer overflow
Problem type   : local (remote)
Debian-specific: no
CVE Ids        : CVE-2009-2660
Debian Bug     : 540146

Tielei Wang discovered that CamlImages, an open source image processing
library, suffers from several integer overflows which may lead to a
potentially exploitable heap overflow and result in arbitrary code
execution. This advisory addresses issues with the reading of JPEG and
GIF Images, while DSA 1832-1 addressed the issue with PNG images.

For the oldstable distribution (etch), this problem has been fixed in
version 2.20-8+etch2.

For the stable distribution (lenny), this problem has been fixed in
version 1:2.2.0-4+lenny2.

For the unstable distribution (sid), this problem has been fixed in
version 1:3.0.1-3.

We recommend that you upgrade your camlimages package.

Upgrade instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 4.0 alias etch
- -------------------------------

Debian (oldstable)
- ------------------

Oldstable updates are available for alpha, amd64, arm, hppa, i386, ia64, mips, mipsel, powerpc, s390 and sparc.

Source archives:

  [http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.20-8+etch2.diff.gz](http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.20-8%2Betch2.diff.gz)
    Size/MD5 checksum:     9346 cf4767d4ac5521e64b409605f3803506
  <http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.20.orig.tar.gz>
    Size/MD5 checksum:  1385525 d933eb58c7983f70b1a000fa01893aa4
  [http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.20-8+etch2.dsc](http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.20-8%2Betch2.dsc)
    Size/MD5 checksum:      904 9dc39921e9569777eeb24c38b0ba0fae

Architecture independent packages:

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-doc_2.20-8+etch2_all.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-doc_2.20-8%2Betch2_all.deb)
    Size/MD5 checksum:   600500 16d54539aab49f9f6c7cc5a8fe7bbf92

alpha architecture (DEC Alpha)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch2_alpha.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch2_alpha.deb)
    Size/MD5 checksum:  1024080 5bb5670e039095dd74fc09831faacb25
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch2_alpha.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch2_alpha.deb)
    Size/MD5 checksum:    29454 c48de53b96d1358e56a1b9f1b0795527

amd64 architecture (AMD x86_64 (AMD64))

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch2_amd64.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch2_amd64.deb)
    Size/MD5 checksum:   820030 668fab0f7d5416229ec40bcbb508db82
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch2_amd64.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch2_amd64.deb)
    Size/MD5 checksum:    27888 d54c0e9a04629c4226b61a9b49f538e3

arm architecture (ARM)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch2_arm.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch2_arm.deb)
    Size/MD5 checksum:   879818 60f8dc22fb087ee654ff9375ac38359f
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch2_arm.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch2_arm.deb)
    Size/MD5 checksum:    26028 3b3bf2cdf56485a29b871274519b6bc6

hppa architecture (HP PA RISC)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch2_hppa.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch2_hppa.deb)
    Size/MD5 checksum:   482842 d5573f24528c510df3144e0096e1a7f1
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch2_hppa.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch2_hppa.deb)
    Size/MD5 checksum:    30270 530aca3cc44c9b4d1afedc89dbb19722

i386 architecture (Intel ia32)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch2_i386.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch2_i386.deb)
    Size/MD5 checksum:    24594 2a25218e9ad03594f8c22f884e850cff
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch2_i386.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch2_i386.deb)
    Size/MD5 checksum:   845868 a4abd61aa97cfb9996e0641c9ed9f378

ia64 architecture (Intel ia64)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch2_ia64.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch2_ia64.deb)
    Size/MD5 checksum:  1101544 a4c3c311105476617a51f6067d91f015
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch2_ia64.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch2_ia64.deb)
    Size/MD5 checksum:    36510 368745aec6d1ea85becb03c0b8028fed

mips architecture (MIPS (Big Endian))

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch2_mips.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch2_mips.deb)
    Size/MD5 checksum:   467426 40b73c7cb6ebb04a02a29663828652d1
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch2_mips.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch2_mips.deb)
    Size/MD5 checksum:    25758 e882e1deca67f0c8860a645a14460967

mipsel architecture (MIPS (Little Endian))

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch2_mipsel.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch2_mipsel.deb)
    Size/MD5 checksum:    25730 0e46cf01caa08a6ab71f71a28e2cd8a1
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch2_mipsel.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch2_mipsel.deb)
    Size/MD5 checksum:   427706 1b8a689d484552d08f564548f4d3abf9

powerpc architecture (PowerPC)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch2_powerpc.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch2_powerpc.deb)
    Size/MD5 checksum:    33080 0f1a2238accd05c53d919b7d3856cca9
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch2_powerpc.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch2_powerpc.deb)
    Size/MD5 checksum:   963968 1b0e5da88c0cdf5679d08699a8403173

sparc architecture (Sun SPARC/UltraSPARC)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch2_sparc.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch2_sparc.deb)
    Size/MD5 checksum:   915706 1c5379e299fea7eb8bceaaa2d01b86af
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch2_sparc.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch2_sparc.deb)
    Size/MD5 checksum:    24820 84a97496ae1366cf589e725ce2d2add9

Debian GNU/Linux 5.0 alias lenny
- --------------------------------

Debian (stable)
- ---------------

Stable updates are available for alpha, amd64, arm, armel, hppa, i386, ia64, mips, mipsel, powerpc, s390 and sparc.

Source archives:

  <http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.2.0.orig.tar.gz>
    Size/MD5 checksum:  1385525 d933eb58c7983f70b1a000fa01893aa4
  [http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.2.0-4+lenny2.dsc](http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.2.0-4%2Blenny2.dsc)
    Size/MD5 checksum:     1704 e31602e616bfb495c440e6ff2d4a8cc4
  [http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.2.0-4+lenny2.diff.gz](http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.2.0-4%2Blenny2.diff.gz)
    Size/MD5 checksum:    10276 9951858aae15e9eaeeeb8bda63ee49a2

Architecture independent packages:

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-doc_2.2.0-4+lenny2_all.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-doc_2.2.0-4%2Blenny2_all.deb)
    Size/MD5 checksum:   601216 8c425e344795481cb0c7080b7a9bcf27

alpha architecture (DEC Alpha)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny2_alpha.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny2_alpha.deb)
    Size/MD5 checksum:   543736 b6e09d20f6e1a8164bbbae7d22b62e31
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny2_alpha.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny2_alpha.deb)
    Size/MD5 checksum:    32438 ea87852f43bb8c43ae5a339606f7ee1e

amd64 architecture (AMD x86_64 (AMD64))

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny2_amd64.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny2_amd64.deb)
    Size/MD5 checksum:   978978 9f9a77d4efc81fda2cf930dd5fa7a4d2
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny2_amd64.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny2_amd64.deb)
    Size/MD5 checksum:    31546 56c8c4e3e7cfce3a1f7ee50fd2b42697

arm architecture (ARM)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny2_arm.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny2_arm.deb)
    Size/MD5 checksum:   571634 b67876154217a5a0c66c896bec6ef46d
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny2_arm.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny2_arm.deb)
    Size/MD5 checksum:    29200 4f0a1b4fa67cf8b3dbc6f640768a8a3b

armel architecture (ARM EABI)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny2_armel.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny2_armel.deb)
    Size/MD5 checksum:   572294 919fa4aac6b6c3c44e8dbda6dc8aba3a
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny2_armel.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny2_armel.deb)
    Size/MD5 checksum:    30012 b3fda0b39e0fe5a94f608b2664076b0e

hppa architecture (HP PA RISC)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny2_hppa.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny2_hppa.deb)
    Size/MD5 checksum:   588858 f80e9e8768c7782f14ec9a695b3f0dee
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny2_hppa.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny2_hppa.deb)
    Size/MD5 checksum:    33210 83d6ac320847d66c843d82450fe147ad

i386 architecture (Intel ia32)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny2_i386.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny2_i386.deb)
    Size/MD5 checksum:   953792 e9b7136b5706fce67e6ff199b6b85148
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny2_i386.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny2_i386.deb)
    Size/MD5 checksum:    27806 c70d399a74066ded2a200bce05f857ee

ia64 architecture (Intel ia64)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny2_ia64.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny2_ia64.deb)
    Size/MD5 checksum:   546404 d3c66dbcd96b2c979561ce88130fe4d5
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny2_ia64.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny2_ia64.deb)
    Size/MD5 checksum:    39908 836473e40186da716daa1706b0847b8b

mips architecture (MIPS (Big Endian))

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny2_mips.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny2_mips.deb)
    Size/MD5 checksum:    28564 5d9082f4da49378377cd6f474c5cd2de
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny2_mips.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny2_mips.deb)
    Size/MD5 checksum:   517662 9214d6a0e3c2ea0bb2168407d807231b

mipsel architecture (MIPS (Little Endian))

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny2_mipsel.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny2_mipsel.deb)
    Size/MD5 checksum:   516288 9a1097c612de8ccc91334e9739d992bc
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny2_mipsel.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny2_mipsel.deb)
    Size/MD5 checksum:    28586 9bab86b4ac11757c66bfda987415a577

powerpc architecture (PowerPC)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny2_powerpc.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny2_powerpc.deb)
    Size/MD5 checksum:    39032 ac500e3472c118015b8b22716b16663e
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny2_powerpc.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny2_powerpc.deb)
    Size/MD5 checksum:   988710 63c40e8f37fd9724ced5c09ec0cebae3

s390 architecture (IBM S/390)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny2_s390.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny2_s390.deb)
    Size/MD5 checksum:   542084 79beed9662ba01af642d472f4918d720
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny2_s390.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny2_s390.deb)
    Size/MD5 checksum:    30950 7b4400fe856c9d197da23128e1983b66

sparc architecture (Sun SPARC/UltraSPARC)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny2_sparc.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny2_sparc.deb)
    Size/MD5 checksum:    28182 0b8f98591ab9dc3650b0951510a80336
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny2_sparc.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny2_sparc.deb)
    Size/MD5 checksum:  1040682 517ca3b7c2ebc8c090e91521b22cd20b

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iEYEARECAAYFAkp/b5UACgkQ62zWxYk/rQeGgACgsOS9mIn5ElhLXjXhpanTM3xX
C1kAoJHPbaMLsDe/P9Haus9eyu+tiBNk
=dXvE
-----END PGP SIGNATURE-----

```

---



=== Content from www.openwall.com_866dab19_20250124_115508.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <200907251424.07073.rbu@gentoo.org>
Date: Sat, 25 Jul 2009 14:24:01 +0200
From: Robert Buchholz <rbu@...too.org>
To: oss-security@...ts.openwall.com
Cc: Andrea Barisani <lcars@...rt.org>,
 cve@...re.org
Subject: camlimages: Integer overflows in GIF and JPEG readers

Hello,

oCERT reported integer overflows in camlimages when reading PNG images
earlier this month (oCERT-2009-009), CVE-2009-2295 was assigned.

Upstream has since incorporated the RedHat patch into their CVS:
<http://camlcvs.inria.fr/cgi-bin/cvsweb.cgi/bazar-ocaml/camlimages/src/?sortby=date>

They also fixed similar integer overflows in gifread.c and jpegread.c
for values that are used in memory allocations and memcpy().
At least Debian used the existing CVE identifier only for the PNG
vulnerabilities, so a new identifier might be needed.

A stripped down [by Alexis Ballier] version of the patch is in out BZ:
<https://bugs.gentoo.org/show_bug.cgi?id=276235>
<https://bugs.gentoo.org/attachment.cgi?id=199108>

Robert

Download attachment "[signature.asc](2/1) " of type "application/pgp-signature" (837 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.debian.org_83e762b8_20250124_115507.html ===


---

[[Date Prev](msg00233.html)][[Date Next](msg00235.html)]
[[Thread Prev](msg00233.html)][[Thread Next](msg00235.html)]
[[Date Index](maillist.html#00234)]
[[Thread Index](threads.html#00234)]

# [SECURITY] [DSA 1912-1] New camlimages fix arbitrary code execution

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 1912-1] New camlimages fix arbitrary code execution
* *From*: white@debian.org (Steffen Joeris)
* *Date*: Fri, 16 Oct 2009 21:31:46 +1100 (EST)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20091016103146.3D57DB1000E%40hannah.localdomain)Â [20091016103146.3D57DB1000E@hannah.localdomain](msg00234.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- ------------------------------------------------------------------------
Debian Security Advisory DSA-1912-1                  security@debian.org
<http://www.debian.org/security/>                      Steffen Joeris
October 16, 2009                      <http://www.debian.org/security/faq>
- ------------------------------------------------------------------------

Package        : camlimages
Vulnerability  : integer overflow
Problem type   : local (remote)
Debian-specific: no
CVE Ids        : CVE-2009-3296 CVE-2009-2660

It was discovered that CamlImages, an open source image processing
library, suffers from several integer overflows, which may lead to a
potentially exploitable heap overflow and result in arbitrary code
execution. This advisory addresses issues with the reading of TIFF
files. It also expands the patch for CVE-2009-2660 to cover another
potential overflow in the processing of JPEG images.

For the oldstable distribution (etch), this problem has been fixed in
version 2.20-8+etch3.

For the stable distribution (lenny), this problem has been fixed in
version 1:2.2.0-4+lenny3.

For the testing distribution (squeeze) and the unstable distribution
(sid), this problem will be fixed soon.

We recommend that you upgrade your camlimages package.

Upgrade instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 4.0 alias etch
- -------------------------------

Debian (oldstable)
- ------------------

Oldstable updates are available for alpha, amd64, arm, hppa, i386, ia64, mips, mipsel, powerpc, s390 and sparc.

Source archives:

  [http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.20-8+etch3.dsc](http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.20-8%2Betch3.dsc)
    Size/MD5 checksum:     1545 1170baf359b7ca7bd0490a4482e2cdcd
  [http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.20-8+etch3.diff.gz](http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.20-8%2Betch3.diff.gz)
    Size/MD5 checksum:     9758 0c6c814cf06b854f2078747d166d714f
  <http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.20.orig.tar.gz>
    Size/MD5 checksum:  1385525 d933eb58c7983f70b1a000fa01893aa4

Architecture independent packages:

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-doc_2.20-8+etch3_all.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-doc_2.20-8%2Betch3_all.deb)
    Size/MD5 checksum:   598648 ee530d7dc14ff4250358f7354fc4a8a1

alpha architecture (DEC Alpha)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch3_alpha.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch3_alpha.deb)
    Size/MD5 checksum:  1024484 72e9aea9c06f1ae264d70d1f7a6c85d2
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch3_alpha.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch3_alpha.deb)
    Size/MD5 checksum:    29570 eaa6ec5925c36acc5a155c72c7f29b01

amd64 architecture (AMD x86_64 (AMD64))

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch3_amd64.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch3_amd64.deb)
    Size/MD5 checksum:   872188 24f06eda9f7ca39b28b25932981b4cda
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch3_amd64.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch3_amd64.deb)
    Size/MD5 checksum:    28126 7d3cf0404d52d005103206dd7f30aa8a

arm architecture (ARM)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch3_arm.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch3_arm.deb)
    Size/MD5 checksum:    26196 6c735d474717b7025b1b594bf515a2de
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch3_arm.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch3_arm.deb)
    Size/MD5 checksum:   880106 7e9b0c0b13949b71f1a23010f5ef68c8

hppa architecture (HP PA RISC)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch3_hppa.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch3_hppa.deb)
    Size/MD5 checksum:    30408 6c6afd274d1f944887d318394efe1dc2
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch3_hppa.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch3_hppa.deb)
    Size/MD5 checksum:   483264 1f1f707859dca186cc518241390f6b84

i386 architecture (Intel ia32)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch3_i386.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch3_i386.deb)
    Size/MD5 checksum:    24670 01ed837cea61b5fd6143edaede81636c
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch3_i386.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch3_i386.deb)
    Size/MD5 checksum:   845016 a2a7c9d64df8e2be8933ff994c9ace7e

ia64 architecture (Intel ia64)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch3_ia64.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch3_ia64.deb)
    Size/MD5 checksum:  1102148 001cb473b718078fbe7186f7e772633e
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch3_ia64.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch3_ia64.deb)
    Size/MD5 checksum:    36800 d877b308032849966a1f6cb5c2a00b6a

mips architecture (MIPS (Big Endian))

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch3_mips.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch3_mips.deb)
    Size/MD5 checksum:   428882 bd86f4f9c1158b4776008370b41be622
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch3_mips.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch3_mips.deb)
    Size/MD5 checksum:    25790 de5ac9debe1bb1348b951cb9f1dfd388

mipsel architecture (MIPS (Little Endian))

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch3_mipsel.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch3_mipsel.deb)
    Size/MD5 checksum:    25834 768d6a896e11ae46e179f35190995f57
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch3_mipsel.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch3_mipsel.deb)
    Size/MD5 checksum:   428224 58c7839e5389a64094606de277d087ba

powerpc architecture (PowerPC)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch3_powerpc.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch3_powerpc.deb)
    Size/MD5 checksum:   895248 43b16604d6881ab4804f94456048a48a
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch3_powerpc.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch3_powerpc.deb)
    Size/MD5 checksum:    32570 f1af72abb55c3e32f9ae222bdfc22056

sparc architecture (Sun SPARC/UltraSPARC)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch3_sparc.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.20-8%2Betch3_sparc.deb)
    Size/MD5 checksum:    25030 210e8127fb4036a1f1992e07d2157352
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch3_sparc.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8%2Betch3_sparc.deb)
    Size/MD5 checksum:   935978 15ef02c3ce9d7459f8671312167549e0

Debian GNU/Linux 5.0 alias lenny
- --------------------------------

Debian (stable)
- ---------------

Stable updates are available for alpha, amd64, arm, armel, hppa, i386, ia64, mips, mipsel, powerpc, s390 and sparc.

Source archives:

  [http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.2.0-4+lenny3.diff.gz](http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.2.0-4%2Blenny3.diff.gz)
    Size/MD5 checksum:    10720 d4f5baa708d8aa4712fcc33c1f7ffff3
  [http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.2.0-4+lenny3.dsc](http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.2.0-4%2Blenny3.dsc)
    Size/MD5 checksum:     2345 4ad8de6c2d37f872d7c2e2b0ab43b808
  <http://security.debian.org/pool/updates/main/c/camlimages/camlimages_2.2.0.orig.tar.gz>
    Size/MD5 checksum:  1385525 d933eb58c7983f70b1a000fa01893aa4

Architecture independent packages:

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-doc_2.2.0-4+lenny3_all.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-doc_2.2.0-4%2Blenny3_all.deb)
    Size/MD5 checksum:   599582 10bab3213572595c00e0352af8f4dfe4

alpha architecture (DEC Alpha)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny3_alpha.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny3_alpha.deb)
    Size/MD5 checksum:   592116 06ab9d71856b10193bc79f01aedf8756
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny3_alpha.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny3_alpha.deb)
    Size/MD5 checksum:    32984 a17be3ec372d3c4d6a1a8168f8e9f32e

amd64 architecture (AMD x86_64 (AMD64))

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny3_amd64.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny3_amd64.deb)
    Size/MD5 checksum:   980586 f534bd73c8d30474e828a240b3e2b4a5
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny3_amd64.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny3_amd64.deb)
    Size/MD5 checksum:    31590 80a337fa12104d9c0fce29ff8f461ed2

arm architecture (ARM)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny3_arm.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny3_arm.deb)
    Size/MD5 checksum:   572050 605f010519b443711d7cd522583bb926
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny3_arm.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny3_arm.deb)
    Size/MD5 checksum:    29434 f76c8d0f13a1543951849c977f4e70b1

armel architecture (ARM EABI)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny3_armel.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny3_armel.deb)
    Size/MD5 checksum:   571320 3c100fd7afae68885505eecc94af093e
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny3_armel.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny3_armel.deb)
    Size/MD5 checksum:    30372 fe84c2007671320780b8a728e6273764

hppa architecture (HP PA RISC)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny3_hppa.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny3_hppa.deb)
    Size/MD5 checksum:    33366 8a28b12eae0b4e3b7286b3f891f3568f
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny3_hppa.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny3_hppa.deb)
    Size/MD5 checksum:   589268 e25d4c0c1e381e3d694cc71a1ea2d7b5

i386 architecture (Intel ia32)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny3_i386.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny3_i386.deb)
    Size/MD5 checksum:   935914 0fb5e0b4a858dcbdd5d90e743ef90226
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny3_i386.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny3_i386.deb)
    Size/MD5 checksum:    28040 468978ba1d5eab25954dea743ed7676c

ia64 architecture (Intel ia64)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny3_ia64.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny3_ia64.deb)
    Size/MD5 checksum:    40320 0cad2f2198840bd55f29ba2e3554faa8
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny3_ia64.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny3_ia64.deb)
    Size/MD5 checksum:   546854 4d0e5c2498ff2de52a7657d6c9fb570d

mips architecture (MIPS (Big Endian))

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny3_mips.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny3_mips.deb)
    Size/MD5 checksum:    28634 b16e535428d491997508a80036624255
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny3_mips.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny3_mips.deb)
    Size/MD5 checksum:   517920 519bc5fab6b7de22b9f14da703f2def8

mipsel architecture (MIPS (Little Endian))

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny3_mipsel.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny3_mipsel.deb)
    Size/MD5 checksum:    28662 93f62626a5451e1721b6bbacf8124e15
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny3_mipsel.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny3_mipsel.deb)
    Size/MD5 checksum:   516758 91cf3745a3cca541514057f4a7ac628a

powerpc architecture (PowerPC)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny3_powerpc.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny3_powerpc.deb)
    Size/MD5 checksum:    39120 13370abfdd27dd90c30bad71752ac033
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny3_powerpc.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny3_powerpc.deb)
    Size/MD5 checksum:   988834 0eebdfd25514ec7449fd345f42df562f

sparc architecture (Sun SPARC/UltraSPARC)

  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny3_sparc.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml_2.2.0-4%2Blenny3_sparc.deb)
    Size/MD5 checksum:    28332 147a027feb48eabf9e836d553ca3da94
  [http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny3_sparc.deb](http://security.debian.org/pool/updates/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4%2Blenny3_sparc.deb)
    Size/MD5 checksum:  1041264 3de6d0ac50434c647e544181d115cee1

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iEYEARECAAYFAkrYSTYACgkQ62zWxYk/rQeunQCdHYBog6ekM3gl3yEHxHbCjdJ6
09AAoL91LGNRUgz8XqN2ywg6g66vVe22
=HoVL
-----END PGP SIGNATURE-----

```

---



=== Content from security-tracker.debian.org_b45f2b54_20250126_005703.html ===

# CVE-2009-2660

| **Name** | CVE-2009-2660 |
| --- | --- |
| **Description** | Multiple integer overflows in CamlImages 2.2 might allow context-dependent attackers to execute arbitrary code via images containing large width and height values that trigger a heap-based buffer overflow, related to (1) crafted GIF files (gifread.c) and (2) crafted JPEG files (jpegread.c), a different vulnerability than CVE-2009-2295. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2009-2660) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2009-2660); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2009-2660), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2009-2660), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2009-2660), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2009-2660), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2009-2660), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2009-2660), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2009-2660), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2009-2660)/[CVE](https://www.suse.com/security/cve/CVE-2009-2660/), GitHub [advisories](https://github.com/advisories?query=CVE-2009-2660)/[code](https://github.com/search?type=Code&q=%22CVE-2009-2660%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2009-2660%22), [web search](https://duckduckgo.com/html?q=%22CVE-2009-2660%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DSA-1857-1](/tracker/DSA-1857-1), [DSA-1912-1](/tracker/DSA-1912-1), [DSA-1912-2](/tracker/DSA-1912-2) |
| **Debian Bugs** | [540146](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=540146), [551282](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=551282) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [advi](/tracker/source-package/advi) ([PTS](https://tracker.debian.org/pkg/advi)) | bookworm, bullseye | 1.10.2-9 | fixed |
|  | sid, trixie | 2.0.0-4 | fixed |
| [camlimages](/tracker/source-package/camlimages) ([PTS](https://tracker.debian.org/pkg/camlimages)) | bullseye | 1:5.0.4-1 | fixed |
|  | bookworm | 1:5.0.4-2 | fixed |
|  | sid, trixie | 1:5.0.5-2 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [advi](/tracker/source-package/advi) | source | etch | 1.6.0-12+etch2 |  | [DSA-1912-2](/tracker/DSA-1912-2) |  |
| [advi](/tracker/source-package/advi) | source | lenny | 1.6.0-13+lenny2 |  | [DSA-1912-2](/tracker/DSA-1912-2) |  |
| [advi](/tracker/source-package/advi) | source | (unstable) | 1.6.0-15 | low |  | [551282](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=551282) |
| [camlimages](/tracker/source-package/camlimages) | source | etch | 2.20-8+etch3 |  | [DSA-1912-1](/tracker/DSA-1912-1) |  |
| [camlimages](/tracker/source-package/camlimages) | source | lenny | 1:2.2.0-4+lenny3 |  | [DSA-1912-1](/tracker/DSA-1912-1) |  |
| [camlimages](/tracker/source-package/camlimages) | source | (unstable) | 1:3.0.1-3 | low |  | [540146](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=540146) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from secunia.com_fdb3c57a_20250124_115507.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from GartnerÂ®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexeraâ€™s 2025 IT Priorities Report highlight whatâ€™s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The worldâ€™s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the worldâ€™s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoftâ€™s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that arenâ€™t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNowÂ® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Â© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

Ã—

...



=== Content from bugs.debian.org_3ddb11d2_20250124_115506.html ===

# Debian Bug report logs - #540146 CVE-2009-2660: Multiple integer overflows

[![version graph](version.cgi?package=camlimages;fixed=camlimages%2F1%3A3.0.1-3;fixed=camlimages%2F1%3A2.2.0-4%2Blenny2;fixed=camlimages%2F2.20-8%2Betch2;collapse=1;width=2;height=2;absolute=0)](version.cgi?absolute=0;info=1;collapse=1;package=camlimages;fixed=camlimages%2F1%3A3.0.1-3;fixed=camlimages%2F1%3A2.2.0-4%2Blenny2;fixed=camlimages%2F2.20-8%2Betch2)

Package:
[camlimages](pkgreport.cgi?package=camlimages);
Maintainer for [camlimages](pkgreport.cgi?package=camlimages) is [Debian OCaml Maintainers <debian-ocaml-maint@lists.debian.org>](pkgreport.cgi?maint=debian-ocaml-maint%40lists.debian.org);

Reported by: [Giuseppe Iuculano <giuseppe@iuculano.it>](pkgreport.cgi?submitter=giuseppe%40iuculano.it)

Date: Thu, 6 Aug 2009 07:18:02 UTC

Severity: *grave*

Tags: patch, security

Fixed in versions camlimages/1:3.0.1-3, camlimages/1:2.2.0-4+lenny2, camlimages/2.20-8+etch2

**Done:** Steffen Joeris <white@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=540146;mbox=yes), [status mbox](bugreport.cgi?bug=540146;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=540146;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Debian OCaml Maintainers <debian-ocaml-maint@lists.debian.org>`:

`Bug#540146`; Package `camlimages`.
(Thu, 06 Aug 2009 07:18:04 GMT) ([full text](bugreport.cgi?bug=540146;msg=2), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Giuseppe Iuculano <giuseppe@iuculano.it>`:

New Bug report received and forwarded. Copy sent to `team@security.debian.org, secure-testing-team@lists.alioth.debian.org, Debian OCaml Maintainers <debian-ocaml-maint@lists.debian.org>`.
(Thu, 06 Aug 2009 07:18:04 GMT) ([full text](bugreport.cgi?bug=540146;msg=4), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=540146;msg=5), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=giuseppe%40iuculano.it)
From: Giuseppe Iuculano <giuseppe@iuculano.it>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: CVE-2009-2660: Multiple integer overflows
Date: Thu, 06 Aug 2009 09:11:01 +0200
```
Package: camlimages
Severity: grave
Tags: security

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi,
the following CVE (Common Vulnerabilities & Exposures) id was
published for camlimages.

[CVE-2009-2660](https://security-tracker.debian.org/tracker/CVE-2009-2660)[0]:
| Multiple integer overflows in CamlImages 2.2 might allow
| context-dependent attackers to execute arbitrary code via images
| containing large width and height values that trigger a heap-based
| buffer overflow, related to (1) crafted GIF files (gifread.c) and (2)
| crafted JPEG files (jpegread.c), a different vulnerability than
| [CVE-2009-2295](https://security-tracker.debian.org/tracker/CVE-2009-2295).

If you fix the vulnerability please also make sure to include the
CVE id in your changelog entry.

For further information see:

[0] <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2660>
    <http://security-tracker.debian.net/tracker/CVE-2009-2660>

Cheers,
Giuseppe.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iEYEARECAAYFAkp6ggEACgkQNxpp46476ar1/gCfc/keILkLon57EJQMFCRtSlB4
NxQAn0yvAYKn3Cmg6YUGr1bX10Ju+wa/
=4KlA
-----END PGP SIGNATURE-----

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian OCaml Maintainers <debian-ocaml-maint@lists.debian.org>`:

`Bug#540146`; Package `camlimages`.
(Sat, 08 Aug 2009 08:03:03 GMT) ([full text](bugreport.cgi?bug=540146;msg=7), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Steffen Joeris <steffen.joeris@skolelinux.de>`:

Extra info received and forwarded to list. Copy sent to `Debian OCaml Maintainers <debian-ocaml-maint@lists.debian.org>`.
(Sat, 08 Aug 2009 08:03:03 GMT) ([full text](bugreport.cgi?bug=540146;msg=9), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 540146@bugs.debian.org ([full text](bugreport.cgi?bug=540146;msg=10), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=steffen.joeris%40skolelinux.de)
From: Steffen Joeris <steffen.joeris@skolelinux.de>
To: 540146@bugs.debian.org
Subject: gentoo's patch and debdiff
Date: Sat, 8 Aug 2009 17:59:04 +1000
```
[[Message part 1](bugreport.cgi?att=0;bug=540146;msg=10) (text/plain, inline)]
```
```
Hi

I'd suggest going with gentoo's approach of using a separate oversized.h file.
Any objections? I've tried building this, but the debdiff between the -dev
binary packages was quite huge, so I am not uploading anything.

Cheers
Steffen

[0]: <https://bugs.gentoo.org/attachment.cgi?id=199108&action=view>

```
```
[[debdiff](bugreport.cgi?att=1;bug=540146;filename=debdiff;msg=10) (text/x-patch, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=2;bug=540146;filename=signature.asc;msg=10) (application/pgp-signature, inline)]
```

---

**Added tag(s) patch.**
Request was from `Steffen Joeris <white@debian.org>`
to `control@bugs.debian.org`.
(Sat, 08 Aug 2009 08:03:04 GMT) ([full text](bugreport.cgi?bug=540146;msg=12), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=12), [link](#11)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian OCaml Maintainers <debian-ocaml-maint@lists.debian.org>`:

`Bug#540146`; Package `camlimages`.
(Sat, 08 Aug 2009 08:30:06 GMT) ([full text](bugreport.cgi?bug=540146;msg=14), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=14), [link](#13)).

---

**Acknowledgement sent**
to `Sylvain Le Gall <gildor@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian OCaml Maintainers <debian-ocaml-maint@lists.debian.org>`.
(Sat, 08 Aug 2009 08:30:06 GMT) ([full text](bugreport.cgi?bug=540146;msg=16), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=16), [link](#15)).

---

[Message #17](#17) received at 540146@bugs.debian.org ([full text](bugreport.cgi?bug=540146;msg=17), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=17), reply):

![](/cgi-bin/libravatar.cgi?email=gildor%40debian.org)
From: Sylvain Le Gall <gildor@debian.org>
To: Steffen Joeris <steffen.joeris@skolelinux.de>, 540146@bugs.debian.org
Subject: Re: Bug#540146: gentoo's patch and debdiff
Date: Sat, 8 Aug 2009 10:26:38 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=540146;msg=17) (text/plain, inline)]
```
```
Hello,

I fix this bug yesterday in the git repository. Please contact me before
working on it next time (I am not yet on VAC). I appreciate your work
but I am sorry it is a duplicate (and not using the same approach, since
I split the patch).

Thanks anyway.

Regards
Sylvain Le Gall

On Sat, Aug 08, 2009 at 05:59:04PM +1000, Steffen Joeris wrote:
> Hi
>
> I'd suggest going with gentoo's approach of using a separate oversized.h file.
> Any objections? I've tried building this, but the debdiff between the -dev
> binary packages was quite huge, so I am not uploading anything.
>
> Cheers
> Steffen
>
> [0]: <https://bugs.gentoo.org/attachment.cgi?id=199108&action=view>

> diff -u camlimages-3.0.1/debian/changelog camlimages-3.0.1/debian/changelog
> --- camlimages-3.0.1/debian/changelog
> +++ camlimages-3.0.1/debian/changelog
> @@ -1,3 +1,12 @@
> +camlimages (1:3.0.1-2.1) unstable; urgency=high
> +
> +  * Non-maintainer upload by the security team
> +  * Expand security patch for integer overflows to also cover other
> +    image types (Closes: #[540146](bugreport.cgi?bug=540146))
> +    Fixes: [CVE-2009-2660](https://security-tracker.debian.org/tracker/CVE-2009-2660)
> +
> + -- Steffen Joeris <white@debian.org>  Sat, 08 Aug 2009 07:05:38 +0000
> +
>  camlimages (1:3.0.1-2) unstable; urgency=low
>
>    [ Mehdi Dogguy ]
> diff -u camlimages-3.0.1/debian/patches/fix_integer_overflows.dpatch camlimages-3.0.1/debian/patches/fix_integer_overflows.dpatch
> --- camlimages-3.0.1/debian/patches/fix_integer_overflows.dpatch
> +++ camlimages-3.0.1/debian/patches/fix_integer_overflows.dpatch
> @@ -8,82 +8,155 @@
> -diff -urNad camlimages~/src/pngread.c camlimages/src/pngread.c
> ---- camlimages~/src/pngread.c	2009-06-23 11:22:20.000000000 +0200
> -+++ camlimages/src/pngread.c	2009-07-03 17:51:31.000000000 +0200
> -@@ -15,6 +15,8 @@
> - #include "config.h"
> - #endif
> -
> -+#include <limits.h>
> +Index: src/gifread.c
> +===================================================================
> +--- src/gifread.c.orig
> ++++ camlimages-3.0.1/src/gifread.c
> +@@ -20,6 +20,8 @@
> + #include <caml/memory.h>
> + #include <caml/fail.h>
> +
> ++#include "oversized.h"
> ++
> + #include <stdio.h>
> + #include <string.h>
> +
> +@@ -191,6 +193,9 @@ value dGifGetLine( value hdl )
> +
> +   GifFileType *GifFile = (GifFileType*) hdl;
> +
> ++  if( oversized( GifFile->Image.Width, sizeof(GifPixelType) ) ){
> ++    failwith_oversized("gif");
> ++  }
> +   buf = alloc_string( GifFile->Image.Width * sizeof(GifPixelType) );
> +
> +   if( DGifGetLine(GifFile, String_val(buf), GifFile->Image.Width )
> +Index: src/jpegread.c
> +===================================================================
> +--- src/jpegread.c.orig
> ++++ camlimages-3.0.1/src/jpegread.c
> +@@ -20,6 +20,8 @@
> + #include <caml/memory.h>
> + #include <caml/fail.h>
> +
> ++#include "oversized.h"
> ++
> + #include <stdio.h>
> + #include <string.h>
> +
> +@@ -156,6 +158,12 @@ read_JPEG_file (value name)
> +    */
> +   /* JSAMPLEs per row in output buffer */
> +
> ++  if( oversized(cinfo.output_width, cinfo.output_components) ){
> ++    jpeg_destroy_decompress(&cinfo);
> ++    fclose(infile);
> ++    failwith_oversized("jpeg");
> ++  }
> ++
> +   row_stride = cinfo.output_width * cinfo.output_components;
> +
> +   /* Make a one-row-high sample array that will go away when done with image */
> +@@ -177,6 +185,12 @@ read_JPEG_file (value name)
> +     jpeg_read_scanlines(&cinfo, buffer + cinfo.output_scanline, 1);
> +   }
> +
> ++  if( oversized(row_stride, cinfo.output_height) ){
> ++    jpeg_destroy_decompress(&cinfo);
> ++    fclose(infile);
> ++    failwith_oversized("jpeg");
> ++  }
>  +
> - #include <png.h>
> -
> - #include <caml/mlvalues.h>
> -@@ -26,6 +28,12 @@
> - #define PNG_TAG_INDEX16 2
> - #define PNG_TAG_INDEX4 3
> -
> +   {
> +     CAMLlocalN(r,3);
> +     r[0] = Val_int(cinfo.output_width);
> +@@ -352,6 +366,7 @@ value open_jpeg_file_for_read_start( jpe
> +
> +   {
> +     CAMLlocalN(r,3);
> ++    // CR jfuruse: integer overflow
> +     r[0] = Val_int(cinfop->output_width);
> +     r[1] = Val_int(cinfop->output_height);
> +     r[2] = alloc_tuple(3);
> +Index: src/oversized.h
> +===================================================================
> +--- /dev/null
> ++++ camlimages-3.0.1/src/oversized.h
> +@@ -0,0 +1,9 @@
> ++#include <limits.h>
>  +/* Test if x or y are negative, or if multiplying x * y would cause an
>  + * arithmetic overflow.
>  + */
>  +#define oversized(x, y)						\
>  +  ((x) < 0 || (y) < 0 || ((y) != 0 && (x) > INT_MAX / (y)))
>  +
> - value read_png_file_as_rgb24( name )
> -      value name;
> - {
> -@@ -81,6 +89,9 @@
> ++#define failwith_oversized(lib) \
> ++  failwith("#lib error: image contains oversized or bogus width and height");
> +Index: src/pngread.c
> +===================================================================
> +--- src/pngread.c.orig
> ++++ camlimages-3.0.1/src/pngread.c
> +@@ -17,6 +17,8 @@
> +
> + #include <png.h>
> +
> ++#include "oversized.h"
> ++
> + #include <caml/mlvalues.h>
> + #include <caml/alloc.h>
> + #include <caml/memory.h>
> +@@ -81,6 +83,9 @@ value read_png_file_as_rgb24( name )
>     png_get_IHDR(png_ptr, info_ptr, &width, &height, &bit_depth, &color_type,
>   	       &interlace_type, NULL, NULL);
>
>  +  if (oversized (width, height))
> -+    failwith ("png error: image contains oversized or bogus width and height");
> ++    failwith_oversized("png");
>  +
>     if ( color_type == PNG_COLOR_TYPE_GRAY ||
>          color_type == PNG_COLOR_TYPE_GRAY_ALPHA ) {
>       png_set_gray_to_rgb(png_ptr);
> -@@ -102,10 +113,16 @@
> +@@ -102,10 +107,16 @@ value read_png_file_as_rgb24( name )
>
>     rowbytes = png_get_rowbytes(png_ptr, info_ptr);
>
>  +  if (oversized (rowbytes, height))
> -+    failwith ("png error: image contains oversized or bogus rowbytes and height");
> ++    failwith_oversized("png");
>  +
>     {
>       int i;
>       png_bytep *row_pointers;
>
>  +    if (oversized (sizeof (png_bytep), height))
> -+      failwith ("png error: image contains oversized or bogus height");
> ++      failwith_oversized("png");
>  +
>       row_pointers = (png_bytep*) stat_alloc(sizeof(png_bytep) * height);
>
>       res = alloc_tuple(3);
> -@@ -235,6 +252,9 @@
> +@@ -235,6 +246,9 @@ value read_png_file( name )
>     png_get_IHDR(png_ptr, info_ptr, &width, &height, &bit_depth, &color_type,
>   	       &interlace_type, NULL, NULL);
>
>  +  if (oversized (width, height))
> -+    failwith ("png error: image contains oversized or bogus width and height");
> ++    failwith_oversized("png");
>  +
>     if ( color_type == PNG_COLOR_TYPE_GRAY ||
>          color_type == PNG_COLOR_TYPE_GRAY_ALPHA ) {
>       png_set_gray_to_rgb(png_ptr);
> -@@ -251,6 +271,9 @@
> +@@ -251,6 +265,9 @@ value read_png_file( name )
>
>     rowbytes = png_get_rowbytes(png_ptr, info_ptr);
>
>  +  if (oversized (rowbytes, height))
> -+    failwith ("png error: image contains oversized or bogus rowbytes and height");
> ++    failwith_oversized("png");
>  +
>   /*
>   fprintf(stderr, "pngread.c: actual loading\n"); fflush(stderr);
>   */
> -@@ -259,6 +282,9 @@
> +@@ -259,6 +276,9 @@ fprintf(stderr, "pngread.c: actual loadi
>       png_bytep *row_pointers;
>       char mesg[256];
>
>  +    if (oversized (sizeof (png_bytep), height))
> -+      failwith ("png error: image contains oversized or bogus height");
> ++      failwith_oversized("png");
>  +
>       row_pointers = (png_bytep*)stat_alloc(sizeof(png_bytep) * height);
>       res = alloc_tuple(3);
>
> +

```
```
[[signature.asc](bugreport.cgi?att=1;bug=540146;filename=signature.asc;msg=17) (application/pgp-signature, inline)]
```

---

**Reply sent**
to `Sylvain Le Gall <gildor@debian.org>`:

You have taken responsibility.
(Sat, 08 Aug 2009 10:31:16 GMT) ([full text](bugreport.cgi?bug=540146;msg=19), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=19), [link](#18)).

---

**Notification sent**
to `Giuseppe Iuculano <giuseppe@iuculano.it>`:

Bug acknowledged by developer.
(Sat, 08 Aug 2009 10:31:16 GMT) ([full text](bugreport.cgi?bug=540146;msg=21), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=21), [link](#20)).

---

[Message #22](#22) received at 540146-close@bugs.debian.org ([full text](bugreport.cgi?bug=540146;msg=22), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=22), reply):

![](/cgi-bin/libravatar.cgi?email=gildor%40debian.org)
From: Sylvain Le Gall <gildor@debian.org>
To: 540146-close@bugs.debian.org
Subject: Bug#540146: fixed in camlimages 1:3.0.1-3
Date: Sat, 08 Aug 2009 09:32:31 +0000
```
Source: camlimages
Source-Version: 1:3.0.1-3

We believe that the bug you reported is fixed in the latest version of
camlimages, which is due to be installed in the Debian FTP archive:

camlimages_3.0.1-3.diff.gz
  to pool/main/c/camlimages/camlimages_3.0.1-3.diff.gz
camlimages_3.0.1-3.dsc
  to pool/main/c/camlimages/camlimages_3.0.1-3.dsc
libcamlimages-ocaml-dev_3.0.1-3_amd64.deb
  to pool/main/c/camlimages/libcamlimages-ocaml-dev_3.0.1-3_amd64.deb
libcamlimages-ocaml-doc_3.0.1-3_all.deb
  to pool/main/c/camlimages/libcamlimages-ocaml-doc_3.0.1-3_all.deb
libcamlimages-ocaml_3.0.1-3_amd64.deb
  to pool/main/c/camlimages/libcamlimages-ocaml_3.0.1-3_amd64.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 540146@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Sylvain Le Gall <gildor@debian.org> (supplier of updated camlimages package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Fri, 07 Aug 2009 23:56:55 +0200
Source: camlimages
Binary: libcamlimages-ocaml libcamlimages-ocaml-dev libcamlimages-ocaml-doc
Architecture: source all amd64
Version: 1:3.0.1-3
Distribution: unstable
Urgency: low
Maintainer: Debian OCaml Maintainers <debian-ocaml-maint@lists.debian.org>
Changed-By: Sylvain Le Gall <gildor@debian.org>
Description:
 libcamlimages-ocaml - OCaml image processing library
 libcamlimages-ocaml-dev - OCaml image processing library
 libcamlimages-ocaml-doc - OCaml CamlImages library documentation
Closes: [540146](bugreport.cgi?bug=540146)
Changes:
 camlimages (1:3.0.1-3) unstable; urgency=low
 .
   * Add a patch fix_more_integer_overflows to fix security issues,
    (Closes: [540146](bugreport.cgi?bug=540146))
    Fixes: [CVE-2009-2660](https://security-tracker.debian.org/tracker/CVE-2009-2660)
Checksums-Sha1:
 7eee6a3482cbbaa9a1ebe6f234abea8d78ba25cf 1687 camlimages_3.0.1-3.dsc
 8bc0c961cc0f8e53bc403c22f48bbdc591b8434d 9999 camlimages_3.0.1-3.diff.gz
 af8e4f44a894025336e03c9f4a3b2b0dd375defb 683120 libcamlimages-ocaml-doc_3.0.1-3_all.deb
 67947cb0ca8dd694d0a221c54c095fc491e6ef49 27292 libcamlimages-ocaml_3.0.1-3_amd64.deb
 c8190a0e02fedc7f372310583402581b1fd17acd 394818 libcamlimages-ocaml-dev_3.0.1-3_amd64.deb
Checksums-Sha256:
 eec2f2692ac568d0d2e7b38b39872415d413d262305ec13faa3fe2e95da67864 1687 camlimages_3.0.1-3.dsc
 9837c48934475350f3760cee26bb3c80731181b3ca6c47cba4b46ed25d7251b8 9999 camlimages_3.0.1-3.diff.gz
 4a03587b640d9adedcbb3058c673b032289aa60cdd1c7f1c9780e3d94e28343f 683120 libcamlimages-ocaml-doc_3.0.1-3_all.deb
 d542ebee12ca81e8a79690d2f45954df0f29d0027299d2247c7e338598429904 27292 libcamlimages-ocaml_3.0.1-3_amd64.deb
 4b95322647a2621aa73f63b2fa59cfc49110cecac4c0a0e0180ad23eef10c4bb 394818 libcamlimages-ocaml-dev_3.0.1-3_amd64.deb
Files:
 46cf0bed0f99ca1119eb7eeb2f65ec9f 1687 devel optional camlimages_3.0.1-3.dsc
 2f76c7d4741e28a89949d5c112f94089 9999 devel optional camlimages_3.0.1-3.diff.gz
 e7f60df1c86df53b791c0879508a2dc5 683120 doc optional libcamlimages-ocaml-doc_3.0.1-3_all.deb
 04543ba0c33a5335da120ec7730b543f 27292 ocaml optional libcamlimages-ocaml_3.0.1-3_amd64.deb
 3e80203c15f7182ab266f9d3f7ab0801 394818 ocaml optional libcamlimages-ocaml-dev_3.0.1-3_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iEYEARECAAYFAkp9OTQACgkQir2bofsN/pvh9gCglclQo5wk3sf8F9AR+JsufG4J
xYkAnjP2BFIcLo4frUAriX7FWRDiVHMz
=DEy7
-----END PGP SIGNATURE-----

```

---

**Reply sent**
to `Steffen Joeris <white@debian.org>`:

You have taken responsibility.
(Tue, 11 Aug 2009 02:33:03 GMT) ([full text](bugreport.cgi?bug=540146;msg=24), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=24), [link](#23)).

---

**Notification sent**
to `Giuseppe Iuculano <giuseppe@iuculano.it>`:

Bug acknowledged by developer.
(Tue, 11 Aug 2009 02:33:03 GMT) ([full text](bugreport.cgi?bug=540146;msg=26), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=26), [link](#25)).

---

[Message #27](#27) received at 540146-close@bugs.debian.org ([full text](bugreport.cgi?bug=540146;msg=27), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=27), reply):

![](/cgi-bin/libravatar.cgi?email=white%40debian.org)
From: Steffen Joeris <white@debian.org>
To: 540146-close@bugs.debian.org
Subject: Bug#540146: fixed in camlimages 1:2.2.0-4+lenny2
Date: Tue, 11 Aug 2009 01:57:39 +0000
```
Source: camlimages
Source-Version: 1:2.2.0-4+lenny2

We believe that the bug you reported is fixed in the latest version of
camlimages, which is due to be installed in the Debian FTP archive:

camlimages_2.2.0-4+lenny2.diff.gz
  to pool/main/c/camlimages/camlimages_2.2.0-4+lenny2.diff.gz
camlimages_2.2.0-4+lenny2.dsc
  to pool/main/c/camlimages/camlimages_2.2.0-4+lenny2.dsc
libcamlimages-ocaml-dev_2.2.0-4+lenny2_i386.deb
  to pool/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny2_i386.deb
libcamlimages-ocaml-doc_2.2.0-4+lenny2_all.deb
  to pool/main/c/camlimages/libcamlimages-ocaml-doc_2.2.0-4+lenny2_all.deb
libcamlimages-ocaml_2.2.0-4+lenny2_i386.deb
  to pool/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny2_i386.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 540146@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Steffen Joeris <white@debian.org> (supplier of updated camlimages package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Sat, 08 Aug 2009 09:38:11 +0200
Source: camlimages
Binary: libcamlimages-ocaml libcamlimages-ocaml-dev libcamlimages-ocaml-doc
Architecture: source all i386
Version: 1:2.2.0-4+lenny2
Distribution: stable-security
Urgency: high
Maintainer: Debian OCaml Maintainers <debian-ocaml-maint@lists.debian.org>
Changed-By: Steffen Joeris <white@debian.org>
Description:
 libcamlimages-ocaml - OCaml image processing library
 libcamlimages-ocaml-dev - OCaml image processing library
 libcamlimages-ocaml-doc - OCaml CamlImages library documentation
Closes: [540146](bugreport.cgi?bug=540146)
Changes:
 camlimages (1:2.2.0-4+lenny2) stable-security; urgency=high
 .
   * Non-maintainer upload by the security team
   * Expand patch to also cover integer overflows in jpegread.c and
     gifread.c (Closes: #[540146](bugreport.cgi?bug=540146))
     Fixes: [CVE-2009-2660](https://security-tracker.debian.org/tracker/CVE-2009-2660)
Checksums-Sha1:
 10ab5646bea418457420747192a3be4651c33a41 1704 camlimages_2.2.0-4+lenny2.dsc
 69b01cacd66464aa8c7cedf484ab0e99ec9863fe 10276 camlimages_2.2.0-4+lenny2.diff.gz
 cbabd12a3a284dd8340d96a45507db8fe8ca398d 601216 libcamlimages-ocaml-doc_2.2.0-4+lenny2_all.deb
 bcc77e04c8103aec65dc10739797f828c4b349fc 27806 libcamlimages-ocaml_2.2.0-4+lenny2_i386.deb
 ca6e5e7cb86ce81ec4961bee7db0202f4605d328 953792 libcamlimages-ocaml-dev_2.2.0-4+lenny2_i386.deb
Checksums-Sha256:
 9eb28d9ac9e49599c6595782f7c3f1d4218631d061e6a1fc9994f9bd8e216447 1704 camlimages_2.2.0-4+lenny2.dsc
 f2956f512267f496d75e0a940de44521cc9289b961dfb13439d8210d14f2f3ce 10276 camlimages_2.2.0-4+lenny2.diff.gz
 e44a8d135005bba41ec77783a70b6f0768e0dcf84c7d06c278e262768fa910c9 601216 libcamlimages-ocaml-doc_2.2.0-4+lenny2_all.deb
 563798cfb5081b7c187be654d732c5044921661d2ad6d164a607a5120b1ad944 27806 libcamlimages-ocaml_2.2.0-4+lenny2_i386.deb
 f1c0f7c2dcbbf3624d850bdbdfcf2eed9f4254aa5ab69d5efcc14c6ea3be7e8e 953792 libcamlimages-ocaml-dev_2.2.0-4+lenny2_i386.deb
Files:
 e31602e616bfb495c440e6ff2d4a8cc4 1704 devel optional camlimages_2.2.0-4+lenny2.dsc
 9951858aae15e9eaeeeb8bda63ee49a2 10276 devel optional camlimages_2.2.0-4+lenny2.diff.gz
 8c425e344795481cb0c7080b7a9bcf27 601216 doc optional libcamlimages-ocaml-doc_2.2.0-4+lenny2_all.deb
 c70d399a74066ded2a200bce05f857ee 27806 libs optional libcamlimages-ocaml_2.2.0-4+lenny2_i386.deb
 e9b7136b5706fce67e6ff199b6b85148 953792 libdevel optional libcamlimages-ocaml-dev_2.2.0-4+lenny2_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iEYEARECAAYFAkp9MOsACgkQ62zWxYk/rQcGSACeMQsqZHrYdIwea9KrQy52AnrD
Y6YAn1AGJg48KvvmxwRHhZLoMCytIq4q
=twBo
-----END PGP SIGNATURE-----

```

---

**Reply sent**
to `Steffen Joeris <white@debian.org>`:

You have taken responsibility.
(Sun, 30 Aug 2009 14:30:18 GMT) ([full text](bugreport.cgi?bug=540146;msg=29), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=29), [link](#28)).

---

**Notification sent**
to `Giuseppe Iuculano <giuseppe@iuculano.it>`:

Bug acknowledged by developer.
(Sun, 30 Aug 2009 14:30:19 GMT) ([full text](bugreport.cgi?bug=540146;msg=31), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=31), [link](#30)).

---

[Message #32](#32) received at 540146-close@bugs.debian.org ([full text](bugreport.cgi?bug=540146;msg=32), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=32), reply):

![](/cgi-bin/libravatar.cgi?email=white%40debian.org)
From: Steffen Joeris <white@debian.org>
To: 540146-close@bugs.debian.org
Subject: Bug#540146: fixed in camlimages 2.20-8+etch2
Date: Sun, 30 Aug 2009 14:01:58 +0000
```
Source: camlimages
Source-Version: 2.20-8+etch2

We believe that the bug you reported is fixed in the latest version of
camlimages, which is due to be installed in the Debian FTP archive:

camlimages_2.20-8+etch2.diff.gz
  to pool/main/c/camlimages/camlimages_2.20-8+etch2.diff.gz
camlimages_2.20-8+etch2.dsc
  to pool/main/c/camlimages/camlimages_2.20-8+etch2.dsc
libcamlimages-ocaml-dev_2.20-8+etch2_i386.deb
  to pool/main/c/camlimages/libcamlimages-ocaml-dev_2.20-8+etch2_i386.deb
libcamlimages-ocaml-doc_2.20-8+etch2_all.deb
  to pool/main/c/camlimages/libcamlimages-ocaml-doc_2.20-8+etch2_all.deb
libcamlimages-ocaml_2.20-8+etch2_i386.deb
  to pool/main/c/camlimages/libcamlimages-ocaml_2.20-8+etch2_i386.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 540146@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Steffen Joeris <white@debian.org> (supplier of updated camlimages package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.7
Date: Sat, 08 Aug 2009 09:54:48 +0200
Source: camlimages
Binary: libcamlimages-ocaml libcamlimages-ocaml-doc libcamlimages-ocaml-dev
Architecture: source i386 all
Version: 2.20-8+etch2
Distribution: oldstable-security
Urgency: high
Maintainer: Debian OCaml Maintainers <debian-ocaml-maint@lists.debian.org>
Changed-By: Steffen Joeris <white@debian.org>
Description:
 libcamlimages-ocaml - OCaml image processing library
 libcamlimages-ocaml-dev - OCaml image processing library
 libcamlimages-ocaml-doc - OCaml CamlImages library documentation
Closes: [540146](bugreport.cgi?bug=540146)
Changes:
 camlimages (2.20-8+etch2) oldstable-security; urgency=high
 .
   * Non-maintainer upload by the security team
   * Expand patch to also cover integer overflows in jpegread.c and
     gifread.c (Closes: #[540146](bugreport.cgi?bug=540146))
     Fixes: [CVE-2009-2660](https://security-tracker.debian.org/tracker/CVE-2009-2660)
Files:
 9dc39921e9569777eeb24c38b0ba0fae 904 devel optional camlimages_2.20-8+etch2.dsc
 cf4767d4ac5521e64b409605f3803506 9346 devel optional camlimages_2.20-8+etch2.diff.gz
 16d54539aab49f9f6c7cc5a8fe7bbf92 600500 doc optional libcamlimages-ocaml-doc_2.20-8+etch2_all.deb
 2a25218e9ad03594f8c22f884e850cff 24594 libs optional libcamlimages-ocaml_2.20-8+etch2_i386.deb
 a4abd61aa97cfb9996e0641c9ed9f378 845868 libdevel optional libcamlimages-ocaml-dev_2.20-8+etch2_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iEYEARECAAYFAkp9MPEACgkQ62zWxYk/rQfsWwCghE4wmjRYQ7+0FfN0FV4Ye/mE
6eEAnizf7yT0sBDfKtYt1KOwp2IyZw9G
=jqun
-----END PGP SIGNATURE-----

```

---

**Reply sent**
to `Steffen Joeris <white@debian.org>`:

You have taken responsibility.
(Fri, 04 Sep 2009 19:09:20 GMT) ([full text](bugreport.cgi?bug=540146;msg=34), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=34), [link](#33)).

---

**Notification sent**
to `Giuseppe Iuculano <giuseppe@iuculano.it>`:

Bug acknowledged by developer.
(Fri, 04 Sep 2009 19:09:21 GMT) ([full text](bugreport.cgi?bug=540146;msg=36), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=36), [link](#35)).

---

[Message #37](#37) received at 540146-close@bugs.debian.org ([full text](bugreport.cgi?bug=540146;msg=37), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=37), reply):

![](/cgi-bin/libravatar.cgi?email=white%40debian.org)
From: Steffen Joeris <white@debian.org>
To: 540146-close@bugs.debian.org
Subject: Bug#540146: fixed in camlimages 1:2.2.0-4+lenny2
Date: Fri, 04 Sep 2009 18:31:46 +0000
```
Source: camlimages
Source-Version: 1:2.2.0-4+lenny2

We believe that the bug you reported is fixed in the latest version of
camlimages, which is due to be installed in the Debian FTP archive:

camlimages_2.2.0-4+lenny2.diff.gz
  to pool/main/c/camlimages/camlimages_2.2.0-4+lenny2.diff.gz
camlimages_2.2.0-4+lenny2.dsc
  to pool/main/c/camlimages/camlimages_2.2.0-4+lenny2.dsc
libcamlimages-ocaml-dev_2.2.0-4+lenny2_i386.deb
  to pool/main/c/camlimages/libcamlimages-ocaml-dev_2.2.0-4+lenny2_i386.deb
libcamlimages-ocaml-doc_2.2.0-4+lenny2_all.deb
  to pool/main/c/camlimages/libcamlimages-ocaml-doc_2.2.0-4+lenny2_all.deb
libcamlimages-ocaml_2.2.0-4+lenny2_i386.deb
  to pool/main/c/camlimages/libcamlimages-ocaml_2.2.0-4+lenny2_i386.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 540146@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Steffen Joeris <white@debian.org> (supplier of updated camlimages package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Sat, 08 Aug 2009 09:38:11 +0200
Source: camlimages
Binary: libcamlimages-ocaml libcamlimages-ocaml-dev libcamlimages-ocaml-doc
Architecture: source all i386
Version: 1:2.2.0-4+lenny2
Distribution: stable-security
Urgency: high
Maintainer: Debian OCaml Maintainers <debian-ocaml-maint@lists.debian.org>
Changed-By: Steffen Joeris <white@debian.org>
Description:
 libcamlimages-ocaml - OCaml image processing library
 libcamlimages-ocaml-dev - OCaml image processing library
 libcamlimages-ocaml-doc - OCaml CamlImages library documentation
Closes: [540146](bugreport.cgi?bug=540146)
Changes:
 camlimages (1:2.2.0-4+lenny2) stable-security; urgency=high
 .
   * Non-maintainer upload by the security team
   * Expand patch to also cover integer overflows in jpegread.c and
     gifread.c (Closes: #[540146](bugreport.cgi?bug=540146))
     Fixes: [CVE-2009-2660](https://security-tracker.debian.org/tracker/CVE-2009-2660)
Checksums-Sha1:
 10ab5646bea418457420747192a3be4651c33a41 1704 camlimages_2.2.0-4+lenny2.dsc
 69b01cacd66464aa8c7cedf484ab0e99ec9863fe 10276 camlimages_2.2.0-4+lenny2.diff.gz
 cbabd12a3a284dd8340d96a45507db8fe8ca398d 601216 libcamlimages-ocaml-doc_2.2.0-4+lenny2_all.deb
 bcc77e04c8103aec65dc10739797f828c4b349fc 27806 libcamlimages-ocaml_2.2.0-4+lenny2_i386.deb
 ca6e5e7cb86ce81ec4961bee7db0202f4605d328 953792 libcamlimages-ocaml-dev_2.2.0-4+lenny2_i386.deb
Checksums-Sha256:
 9eb28d9ac9e49599c6595782f7c3f1d4218631d061e6a1fc9994f9bd8e216447 1704 camlimages_2.2.0-4+lenny2.dsc
 f2956f512267f496d75e0a940de44521cc9289b961dfb13439d8210d14f2f3ce 10276 camlimages_2.2.0-4+lenny2.diff.gz
 e44a8d135005bba41ec77783a70b6f0768e0dcf84c7d06c278e262768fa910c9 601216 libcamlimages-ocaml-doc_2.2.0-4+lenny2_all.deb
 563798cfb5081b7c187be654d732c5044921661d2ad6d164a607a5120b1ad944 27806 libcamlimages-ocaml_2.2.0-4+lenny2_i386.deb
 f1c0f7c2dcbbf3624d850bdbdfcf2eed9f4254aa5ab69d5efcc14c6ea3be7e8e 953792 libcamlimages-ocaml-dev_2.2.0-4+lenny2_i386.deb
Files:
 e31602e616bfb495c440e6ff2d4a8cc4 1704 devel optional camlimages_2.2.0-4+lenny2.dsc
 9951858aae15e9eaeeeb8bda63ee49a2 10276 devel optional camlimages_2.2.0-4+lenny2.diff.gz
 8c425e344795481cb0c7080b7a9bcf27 601216 doc optional libcamlimages-ocaml-doc_2.2.0-4+lenny2_all.deb
 c70d399a74066ded2a200bce05f857ee 27806 libs optional libcamlimages-ocaml_2.2.0-4+lenny2_i386.deb
 e9b7136b5706fce67e6ff199b6b85148 953792 libdevel optional libcamlimages-ocaml-dev_2.2.0-4+lenny2_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iEYEARECAAYFAkp9MOsACgkQ62zWxYk/rQcGSACeMQsqZHrYdIwea9KrQy52AnrD
Y6YAn1AGJg48KvvmxwRHhZLoMCytIq4q
=twBo
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sat, 03 Oct 2009 07:39:11 GMT) ([full text](bugreport.cgi?bug=540146;msg=39), [mbox](bugreport.cgi?bug=540146;mbox=yes;msg=39), [link](#38)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=540146).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 11:55:05 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from bugs.gentoo.org_4b307bbb_20250124_115515.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla â€“ BugÂ 276235
<dev-ml/camlimages-3.0.1 integer overflows (CVE-2009-{2295,2660})
Last modified: 2010-06-01 15:44:34 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)â€“[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [NewÂ Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=276235&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=276235&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**BugÂ 276235**](show_bug.cgi?id=276235)
(CVE-2009-2295)
- <dev-ml/camlimages-3.0.1 integer overflows (CVE-2009-{2295,2660})

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
<dev-ml/camlimages-3.0.1 integer overflows (CVE-2009-{2295,2660})

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2009-2295 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [http://www.ocert.org/advisories/ocert...](http://www.ocert.org/advisories/ocert-2009-009.html) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B2 [glsa] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2009-07-02 13:48 UTC by Robert Buchholz (RETIRED) | | --- | --- | | Modified: | 2010-06-01 15:44 UTC ([History](show_activity.cgi?id=276235)) | | CC List: | 2 users (show)  ml newt | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [**camlimages-3.0.1-CVE-2009-2295.patch**](attachment.cgi?id=199108 "View the content of the attachment") (camlimages-3.0.1-CVE-2009-2295.patch,4.25 KB, patch)  [2009-07-25 11:38 UTC](#attach_199108 "Go to the comment associated with the attachment"), Robert Buchholz (RETIRED) | *no flags* | [Details](attachment.cgi?id=199108&action=edit) | [Diff](attachment.cgi?id=199108&action=diff) | | [**testsuite for PoC**](attachment.cgi?id=201702 "View the content of the attachment") (CVE-2009-2295.tar.gz,433.33 KB, text/plain)  [2009-08-19 12:03 UTC](#attach_201702 "Go to the comment associated with the attachment"), Steffen Joeris | *no flags* | [Details](attachment.cgi?id=201702&action=edit) | | [View All](attachment.cgi?bugid=276235&action=viewall)  [Add an attachment](attachment.cgi?bugid=276235&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=276235&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Robert Buchholz (RETIRED)   gentoo-dev  2009-07-02 13:48:04 UTC  ``` oCERT #2009-009 CamlImages integer overflows  CamlImages, an open source image processing library, suffers from several integer overflows which may lead to a potentially exploitable heap overflow and result in arbitrary code execution.  The vulnerability is triggered by PNG image parsing, the read_png_file and read_png_file_as_rgb24 functions do not properly validate the width and height of the image. Specific PNG images with large width and height can be crafted to trigger the vulnerability.  Affected version:  CamlImages <= 2.2  Fixed version:  Unfortunately oCERT has been unable to get feedback from CamlImages maintainers and the package seems unmaintained, it's therefore suggested to avoid CamlImages usage on production or any environment where strong security is needed.  Credit: vulnerability report and PoC code received from Tielei Wang <wangtielei [at] icst [dot] pku [dot] edu [dot] cn>, ICST-ERCIS.  CVE: CVE-2009-2295 Timeline:  2009-05-21: vulnerability reported received 2009-05-21: contacted camlimages maintainers 2009-06-30: due to lack of feedback oCERT asks reporter to disclose the issue 2009-07-01: reporter agrees to disclosure 2009-07-02: assigned CVE 2009-07-02: advisory release ```  [Comment 1](#c1)  Robert Buchholz (RETIRED)   gentoo-dev  2009-07-02 13:55:00 UTC  ``` ml: app-text/active-dvi seems to be using this library, so in case of removal, both would have to go. Do you have contact to upstream? ```  [Comment 2](#c2)  Alexis Ballier   gentoo-dev  2009-07-02 14:16:50 UTC  ``` There is a new version (3.0.1) at <http://gallium.inria.fr/camlimages/> (it seems it has been released a long time ago: 2007-10-11 according to the tarball mtime) Is it also exploitable? Considering the timeline I'd suspect it is, but the advisory is about <=2.2. ```  [Comment 3](#c3)  Robert Buchholz (RETIRED)   gentoo-dev  2009-07-03 07:19:45 UTC  ``` The advisory has been updates to reflect that 3.0.1 is also affected. Alexis, I forwarded the reproducer to you. The email to upstream bounced for one of the two authors (Jun.Furuse). ```  [Comment 4](#c4)  Alex Legler (RETIRED)   archtester gentoo-dev Security  2009-07-05 23:27:07 UTC  ``` CVE-2009-2295 (<http://nvd.nist.gov/nvd.cfm?cvename=CVE-2009-2295>):   Multiple integer overflows in CamlImages 2.2 and earlier might allow   context-dependent attackers to execute arbitrary code via a crafted   PNG image with large width and height values that trigger a   heap-based buffer overflow in the (1) read_png_file or (2)   read_png_file_as_rgb24 function.   ```  [Comment 5](#c5)  Alexis Ballier   gentoo-dev  2009-07-24 20:52:12 UTC  ``` 3.0.1 in tree with upstream patches; it checks for oversized images in gif, jpeg and png so maybe there were other vulns. in jpeg & gif readers. ```  [Comment 6](#c6)  Robert Buchholz (RETIRED)   gentoo-dev  2009-07-25 11:38:38 UTC  ``` Created [attachment 199108](attachment.cgi?id=199108 "camlimages-3.0.1-CVE-2009-2295.patch") [[details](attachment.cgi?id=199108&action=edit "camlimages-3.0.1-CVE-2009-2295.patch"), [diff](attachment.cgi?id=199108&action=diff "camlimages-3.0.1-CVE-2009-2295.patch")] camlimages-3.0.1-CVE-2009-2295.patch  Fixes for CVE-2009-2295 and gif/jpeg overflows. ```  [Comment 7](#c7)  Robert Buchholz (RETIRED)   gentoo-dev  2009-07-25 12:25:34 UTC  ``` Arches, please test and mark stable: =dev-ml/camlimages-3.0.1 Target keywords : "ppc x86" ```  [Comment 8](#c8)  Markus Meier   gentoo-dev  2009-07-27 22:01:34 UTC  ``` this will break it's only reverse-dep app-text/active-dvi-1.7.3:  /usr/bin/ocamlc.opt  -I /usr/lib/ocaml/lablgtk2 -I /usr/lib/ocaml -I /usr/lib/ocaml/site-packages/camlimages -o dvi.cmo -c dvi.ml /usr/bin/ocamlc.opt  -I /usr/lib/ocaml/lablgtk2 -I /usr/lib/ocaml -I /usr/lib/ocaml/site-packages/camlimages -o drawimage.cmo -c drawimage.ml File "drawimage.ml", line 304, characters 8-18: Unbound value Ps.load_ps make[2]: *** [drawimage.cmo] Error 2 make[2]: *** Waiting for unfinished jobs.... make[2]: Leaving directory `/var/tmp/portage/app-text/active-dvi-1.7.3/work/advi-1.7.3/src' make[1]: *** [all] Error 2 make[1]: Leaving directory `/var/tmp/portage/app-text/active-dvi-1.7.3/work/advi-1.7.3/src' make: *** [all-recursive] Error 1  *   * ERROR: app-text/active-dvi-1.7.3 failed.  * Call stack:  *               ebuild.sh, line   49:  Called src_compile  *             environment, line 2672:  Called die  * The specific snippet of code:  *       emake || die "emake failed";  *  The die message:  *   emake failed  [ebuild   R   ] dev-ml/camlimages-3.0.1  USE="gif gtk jpeg tiff truetype -doc -gs -xpm" 0 kB [ebuild   R   ] app-text/active-dvi-1.7.3  USE="ocamlopt -tk" 0 kB  Portage 2.1.6.13 (default/linux/x86/2008.0/desktop, gcc-4.3.2, glibc-2.9_p20081201-r2, 2.6.30.1 i686) ================================================================= System uname: Linux-2.6.30.1-i686-Intel-R-_Core-TM-2_Duo_CPU_T8300_@_2.40GHz-with-glibc2.0 Timestamp of tree: Mon, 27 Jul 2009 21:00:01 +0000 app-shells/bash:     3.2_p39 dev-java/java-config: 2.1.7 dev-lang/python:     2.5.4-r3 dev-python/pycrypto: 2.0.1-r8 dev-util/cmake:      2.6.4 sys-apps/baselayout: 1.12.11.1 sys-apps/sandbox:    1.6-r2 sys-devel/autoconf:  2.13, 2.63-r1 sys-devel/automake:  1.4_p6, 1.5, 1.7.9-r1, 1.9.6-r2, 1.10.2 sys-devel/binutils:  2.18-r3 sys-devel/gcc-config: 1.4.1 sys-devel/libtool:   1.5.26 virtual/os-headers:  2.6.27-r2 ACCEPT_KEYWORDS="x86" CBUILD="i686-pc-linux-gnu" CFLAGS="-O2 -march=i686 -pipe" CHOST="i686-pc-linux-gnu" CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/config" CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c /etc/udev/rules.d" CXXFLAGS="-O2 -march=i686 -pipe" DISTDIR="/usr/portage/distfiles" FEATURES="collision-protect distlocks fixpackages parallel-fetch protect-owned sandbox sfperms strict test unmerge-orphans userfetch userpriv usersandbox" GENTOO_MIRRORS="<http://distfiles.gentoo.org> <http://distro.ibiblio.org/pub/linux/distributions/gentoo>" LDFLAGS="-Wl,-O1" LINGUAS="en en_GB de" MAKEOPTS="-j2" PKGDIR="/mnt/packages" PORTAGE_CONFIGROOT="/" PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages" PORTAGE_TMPDIR="/var/tmp" PORTDIR="/usr/portage" SYNC="rsync://rsync.gentoo.org/gentoo-portage" USE="X acl acpi alsa apache2 avahi berkdb bluetooth branding bzip2 cairo cdr cli cracklib crypt cups dbus dri dvd dvdr dvdread eds emboss encode esd evo examples fam firefox fortran gdbm gif gnome gpm gstreamer gtk hal iconv ipv6 isdnlog jpeg kde ldap libnotify mad midi mikmod mp3 mpeg mudflap ncurses nls nptl nptlonly ogg opengl openmp pam pcre pdf perl png ppds pppd python qt3 qt3support qt4 quicktime readline reflection sdl session source spell spl ssl startup-notification svg sysfs tcpd test tiff truetype unicode usb vorbis win32codecs x86 xml xorg xulrunner xv zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en en_GB de" USERLAND="GNU" VIDEO_CARDS="fbdev glint i810 intel mach64 mga neomagic nv r128 radeon savage sis tdfx trident vesa vga via vmware voodoo" Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LANG, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY ```  [Comment 9](#c9)  Alexis Ballier   gentoo-dev  2009-07-27 22:28:23 UTC  ``` Its just missing usedeps from advi part; added active-dvi-1.7.3-r1 that fixes that. Please mark it stable together with camlimages 3.0.1 and remove the old active-dvi revision while at it. ```  [Comment 10](#c10)  Markus Meier   gentoo-dev  2009-07-29 21:18:00 UTC  ``` x86 stable ```  [Comment 11](#c11)  Robert Buchholz (RETIRED)   gentoo-dev  2009-08-07 17:21:46 UTC  ``` CVE-2009-2660 (<http://nvd.nist.gov/nvd.cfm?cvename=CVE-2009-2660>):   Multiple integer overflows in CamlImages 2.2 might allow   context-dependent attackers to execute arbitrary code via images   containing large width and height values that trigger a heap-based   buffer overflow, related to (1) crafted GIF files (gifread.c) and (2)   crafted JPEG files (jpegread.c), a different vulnerability than   CVE-2009-2295.   ```  [Comment 12](#c12)  nixnut (RETIRED)   gentoo-dev  2009-08-09 13:12:28 UTC  ``` ppc stable ```  [Comment 13](#c13)  Greg Roelofs    2009-08-14 20:53:33 UTC  ``` The PNG patch appears to be incomplete (rowbytes itself is never checked, unless in libpng; I personally would always include my own, explicit check), and oversized() seems unnecessarily complex (why not check for x and y <= 0 and avoid the explicit "y != 0" in the third clause?  images with zero-dimensions aren't valid, either).  The GIF and JPEG checks appear to depend on third-party data structures and may break in the future if those ever switch to unsigned values (though I imagine that's unlikely). ```  [Comment 14](#c14)  Robert Buchholz (RETIRED)   gentoo-dev  2009-08-15 23:49:56 UTC  ``` (In reply to [comment #13](show_bug.cgi?id=276235#c13)) > The PNG patch appears to be incomplete (rowbytes itself is never checked, > unless in libpng; I personally would always include my own, explicit check),  I'm not sure I'm following. rowbytes is declared as size_t and libpng's png_get_rowbytes() returns a uint_32, which is an identical type. What else do you want to check? rowbytes is only used in memory allocations or access in multiplications with height, and that case is checked.   > and oversized() seems unnecessarily complex (why not check for x and y <= 0 and > avoid the explicit "y != 0" in the third clause?  images with zero-dimensions > aren't valid, either).   0 height or width are certainly not errors to cause an overflow message, so the additional case of oversized() returning false for x=0 or y=0 seems sane to me.   > The GIF and JPEG checks appear to depend on third-party > data structures and may break in the future if those ever switch to unsigned > values (though I imagine that's unlikely).  The members of the GifFileType struct and the jpeg_decompress_struct that are accessed are explicitly not marked private. How else should camlimages get access to these values? ```  [Comment 15](#c15)  Greg Roelofs    2009-08-18 20:36:40 UTC  ``` (In reply to [comment #14](show_bug.cgi?id=276235#c14)) >> The PNG patch appears to be incomplete (rowbytes itself is never checked, >> unless in libpng; I personally would always include my own, explicit check),  > I'm not sure I'm following. rowbytes is declared as size_t and libpng's > png_get_rowbytes() returns a uint_32, which is an identical type. What > else do you want to check?  rowbytes is only used in memory allocations > or access in multiplications with height, and that case is checked.  rowbytes itself is a product, and you never check that.  Consider an RGB image with w = 1431655766:  rowbytes = 2.  Does libpng catch the overflow? Maybe so, maybe not, or maybe now but not in the future due to an oversight; the point is that you're depending on it to do so, and I'm saying that's not a very good approach to security.  (As you noted, you're using rowbytes in memory allocations, but none of your rowbytes*h checks will catch the problem. Oopsie.)  >> and oversized() seems unnecessarily complex (why not check for x and y <= 0 and >> avoid the explicit "y != 0" in the third clause?  images with zero-dimensions >> aren't valid, either).  > 0 height or width are certainly not errors to cause an overflow message, > so the additional case of oversized() returning false for x=0 or y=0 > seems sane to me.  The point is simply that zero-dimensioned images serve no valid purpose, and you can save a few clock cycles by disallowing them:  #define oversized(x, y)    ((x) <= 0 || (y) <= 0 || (x) > INT_MAX / (y))  Cheap optimization, though undoubtedly not measurable...  >> The GIF and JPEG checks appear to depend on third-party >> data structures and may break in the future if those ever switch to unsigned >> values (though I imagine that's unlikely).  > The members of the GifFileType struct and the jpeg_decompress_struct > that are accessed are explicitly not marked private. How else should > camlimages get access to these values?  Simply by copying to your own integer variables.  I'm not claiming you necessarily gain anything by doing so--nothing in the patch screams at me "I will break if x is unsigned"--but I have seen other, similar (security) code depend on the signedness of integers that turned out not to be signed. You may want to do a quick mini-audit and make sure there are no signed/ unsigned dependencies in nearby code.  ```  [Comment 16](#c16)  Steffen Joeris    2009-08-19 12:01:31 UTC  ``` Hi (My first post to gentoo's bugzilla :) )  Just a general remark on this bug, has anyone checked tiffread.c? I can't find any validation checking in there and was wondering, whether it is required. Also, I am still getting a segmentation fault for the crafted jpeg image that was sent as a PoC via vendor-sec (I can hand that out via private email). Just wondering, whether someone checked it. I am attaching some code to test it, provided by our camlimages maintainer, maybe it's useful.  Cheers Steffen ```  [Comment 17](#c17)  Steffen Joeris    2009-08-19 12:03:11 UTC  ``` Created [attachment 201702](attachment.cgi?id=201702 "testsuite for PoC") [[details](attachment.cgi?id=201702&action=edit "testsuite for PoC")] testsuite for PoC ```  [Comment 18](#c18)  Alex Legler (RETIRED)   archtester gentoo-dev Security  2009-10-23 10:01:07 UTC  ``` (In reply to [comment #16](show_bug.cgi?id=276235#c16)) > Just a general remark on this bug, has anyone checked tiffread.c?  I think those issues are confirmed now, [bug 290222](show_bug.cgi?id=290222 "RESOLVED FIXED - <dev-ml/camlimages-3.0.2 Integer Overflows (CVE-2009-3296)"). ;)   ```  [Comment 19](#c19)  Alex Legler (RETIRED)   archtester gentoo-dev Security  2010-06-01 15:44:34 UTC  ``` GLSA 201006-02 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=276235)
* -Â [XML](show_bug.cgi?ctype=xml&id=276235)
* -Â [Clone This Bug](enter_bug.cgi?cloned_bug_id=276235)
* -Â [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=276235&product=Gentoo%20Security)
* -Â Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)â€“[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [NewÂ Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=276235&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=276235&GoAheadAndLogIn=1#forgot)
    Login:

    [x]


