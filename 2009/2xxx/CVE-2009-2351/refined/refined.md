The provided content discusses multiple cross-site scripting (XSS) vulnerabilities related to how browsers handle redirects, particularly through the `Refresh` and `Location` headers. It details various attack vectors using `javascript:` and `data:` URIs.

**Vulnerability Details:**

*   **Root Cause:** The core issue lies in browsers interpreting and executing JavaScript code embedded within redirect URLs specified in `Refresh` and `Location` headers. Instead of treating these as simple redirects, browsers like older versions of Mozilla, Firefox, Internet Explorer, Opera, and Chrome would execute the malicious JavaScript.

*   **Weaknesses:**
    *   **Improper Handling of `javascript:` URIs:** Browsers fail to sanitize or block the execution of JavaScript code within `javascript:` URIs when used in redirect headers.
    *   **Improper Handling of `data:` URIs:**  Browsers execute code within `data:` URIs when used in redirect headers, sometimes bypassing the security context of the originating site (modern browsers)
    *   **Inconsistent Behavior:** Different browsers, and even different versions of the same browser, exhibit inconsistent behavior when handling redirects, leading to vulnerabilities in some and not others.

*  **Attack Vectors:**
    *  **Refresh Header XSS:**
        *   A malicious redirect is injected using a `Refresh` header with a `javascript:` URI. For example `Refresh: 0; URL=javascript:alert(document.cookie)`.
        *   A malicious redirect is injected using a `Refresh` header with a `data:` URI containing HTML and script. For example `refresh: 0; URL=data:text/html;base64,PHNjcmlwdD5hbGVydChkb2N1bWVudC5jb29raWUpPC9zY3JpcHQ%2b`
    *  **Location Header XSS:**
        *   A malicious redirect is injected using a `Location` header with a `javascript:` URI. For example `Location: javascript:alert%28document.cookie%29` and the server returns 302/301 code
        *    A malicious redirect is injected using a `Location` header with a `data:` URI containing HTML and script. For example `Location:Â data:text/html;base64,PHNjcmlwdD5hbGVydChkb2N1bWVudC5jb29raWUpPC9zY3JpcHQ+`

*   **Impact of Exploitation:**
    *   **Cookie Stealing:** In older browsers, code executes in the context of the site, allowing access to cookies and potentially sensitive user data.
    *   **Phishing Attacks:**  Malicious JavaScript can be executed to display fake login forms or other content to deceive users.
    *   **Malware Distribution:**  Redirects can lead to malicious sites or directly execute code within the browser for malware distribution.
    *   **Strictly social XSS:** Some browsers present a confirmation page when redirects to javascript URIs happen. If the user confirms the redirection, the malicious code will execute.

*   **Required Attacker Capabilities/Position:**
    *   **Vulnerable Web Server:**  The attacker needs to exploit a web application vulnerability that allows them to inject malicious redirect headers (`Refresh` or `Location`).
    *   **Social Engineering:**  For some attacks, particularly those involving "Object moved" or similar pages, the attacker might need to rely on social engineering to convince users to click on the confirmation link.

**Specific Attack Examples:**

*   **Attack #1:** XSS via `refresh-header` redirectors using `javascript:` URI in older versions of browsers.
*   **Attack #2:** XSS via `refresh-header` redirectors using `data:` URI in older and modern browsers.
*   **Attack #3:** XSS via `location-header` redirectors using `data:` URI in older versions of Firefox and Opera.
*   **Attack #4:** XSS via `location-header` redirectors with "302 Object moved" using `javascript:` URI in older versions of Mozilla and Firefox
*   **Attack #5:** XSS via `location-header` redirectors using `javascript:` URI in Maxthon 3 Alpha in Ultramode.
*   **Attack #6:** XSS via `location-header` redirectors with "302 Found" using `javascript:` URI in older versions of Mozilla and Firefox.
*   **Attacks #7,8:** XSS via `location-header` with 301/303 status codes using `javascript:` and `data:` URIs.

**Browser Versions Affected (as per the provided content):**

*   **Mozilla:** 1.7.x and earlier, Firefox 3.0.8 and earlier, 3.0.12, 3.0.13, 3.0.19, 3.5.11, 3.5.19, 3.6.8, 3.6.28, 3.6 a1 pre, 3.7 a1 pre, 4.0b2.
*   **Internet Explorer:** 6 and earlier.
*   **Opera:** 9.52 and earlier, 10.00 Beta 3 Build 1699, 10.53, 10.62.
*   **Google Chrome:** 1.0.154.48 and earlier, 2.0.172.28, 2.0.172.37, 3.0.193.2 Beta.
*  **QtWeb:** 3.0 Build 001 and 3.0 Build 003
*  **Safari:** 4.0.3
*  **SeaMonkey:** 1.1.17
*  **Maxthon:** 3 Alpha (3.0.0.145 and 3.0.2.2) with Ultramode
*  **Orca Browser:** 1.2 build 5

**Additional Notes:**

* The content mentions that these vulnerabilities can bypass anti-phishing and anti-malware filters because `data:` URIs are not typically included in the filter databases.
* The author emphasizes the need for browsers to block JavaScript execution from redirects, regardless of whether they use the `Refresh` or `Location` header to prevent such attacks.
* The author notes that the attacks with `javascript:` URI are executing the malicious code in the context of the website (for most browsers and attacks), so the malicious code can steal cookies and sensitive data.
* The author notes that in modern browsers (for some attacks) the javascript code is not executed in the context of the website and it's only possible to execute arbitrary javascript code, so the attack is suitable for phishing and malware distribution purposes.

This content provides more detail than a typical CVE description, outlining specific attack vectors, affected browsers, and the underlying mechanisms causing the vulnerabilities.

**Summary:**
The document describes a series of cross-site scripting vulnerabilities arising from improper handling of `javascript:` and `data:` URIs within redirect headers (`Refresh` and `Location`) by various web browsers. This can lead to cookie stealing, phishing, and malware distribution. The content also highlights that while some browsers may block such redirects in one context, they might fail to do so in another, leading to inconsistencies and increased attack surface.