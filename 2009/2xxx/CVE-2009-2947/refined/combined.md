=== Content from www.debian.org_846c9f84_20250125_214049.html ===


---

[[Date Prev](msg00200.html)][[Date Next](msg00202.html)]
[[Thread Prev](msg00200.html)][[Thread Next](msg00202.html)]
[[Date Index](maillist.html#00201)]
[[Thread Index](threads.html#00201)]

# [SECURITY] [DSA 1882-1] New xapian-omega packages fix cross-site scripting

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 1882-1] New xapian-omega packages fix cross-site scripting
* *From*: Nico Golde <nion@debian.org>
* *Date*: Wed, 9 Sep 2009 15:30:17 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20090909133017.GA23064%40ngolde.de)Â [20090909133017.GA23064@ngolde.de](msg00201.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- --------------------------------------------------------------------------
Debian Security Advisory DSA-1882-1                    security@debian.org
<http://www.debian.org/security/>                                 Nico Golde
September 9th, 2009                     <http://www.debian.org/security/faq>
- --------------------------------------------------------------------------

Package        : xapian-omega
Vulnerability  : missing input sanitization
Problem type   : remote
Debian-specific: no
CVE ID         : CVE-2009-2947

It was discovered that xapian-omega, a CGI interface for searching xapian
databases, is not properly escaping user supplied input when printing
exceptions.  An attacker can use this to conduct cross-site scripting
attacks via crafted search queries resulting in an exception and steal
potentially sensitive data from web applications running on the same domain
or embedding the search engine into a website.

For the oldstable distribution (etch), this problem has been fixed in
version 0.9.9-1+etch1.

For the stable distribution (lenny), this problem has been fixed in
version 1.0.7-3+lenny1.

For the testing (squeeze) and unstable (sid) distribution, this problem
will be fixed soon.

We recommend that you upgrade your xapian-omega packages.

Upgrade instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 4.0 alias etch
- -------------------------------

Debian (oldstable)
- ------------------

Oldstable updates are available for alpha, amd64, arm, hppa, i386, ia64, mips, mipsel, powerpc, s390 and sparc.

Source archives:

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1+etch1.dsc](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1%2Betch1.dsc)
    Size/MD5 checksum:     1309 5a6c3eb3466e76a5cd0195da96d646c8
  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1+etch1.diff.gz](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1%2Betch1.diff.gz)
    Size/MD5 checksum:     7283 fa1327788649c4b702555552484298ca
  <http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9.orig.tar.gz>
    Size/MD5 checksum:   456940 cf2cfa2d98948ba6c5440db5e5baabc6

alpha architecture (DEC Alpha)

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1+etch1_alpha.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1%2Betch1_alpha.deb)
    Size/MD5 checksum:   264408 37050849b159d950718961ee8c9fc53a

amd64 architecture (AMD x86_64 (AMD64))

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1+etch1_amd64.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1%2Betch1_amd64.deb)
    Size/MD5 checksum:   243398 039ab294a191863a6f11f9461d442fdb

arm architecture (ARM)

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1+etch1_arm.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1%2Betch1_arm.deb)
    Size/MD5 checksum:   271312 71c448519cc2952134c3c604d46e364b

hppa architecture (HP PA RISC)

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1+etch1_hppa.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1%2Betch1_hppa.deb)
    Size/MD5 checksum:   261640 6ec25e571ae0f72f2ce677d02f7a33c0

i386 architecture (Intel ia32)

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1+etch1_i386.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1%2Betch1_i386.deb)
    Size/MD5 checksum:   247156 79d32ec1534b0c47306adc9e34ff7a2c

ia64 architecture (Intel ia64)

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1+etch1_ia64.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1%2Betch1_ia64.deb)
    Size/MD5 checksum:   295998 0d0b0e45a813c5c3384beea87bf67d70

mips architecture (MIPS (Big Endian))

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1+etch1_mips.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1%2Betch1_mips.deb)
    Size/MD5 checksum:   242622 75cbb4b5d4ccb7b17ebc5e43d3964550

mipsel architecture (MIPS (Little Endian))

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1+etch1_mipsel.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1%2Betch1_mipsel.deb)
    Size/MD5 checksum:   242346 ea46d3fee9009a61628a40d548677579

powerpc architecture (PowerPC)

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1+etch1_powerpc.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1%2Betch1_powerpc.deb)
    Size/MD5 checksum:   249362 13726168ebf17a82cde5d53b839b4921

s390 architecture (IBM S/390)

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1+etch1_s390.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1%2Betch1_s390.deb)
    Size/MD5 checksum:   235796 1190383d3c937065802b81fae40fdaa1

sparc architecture (Sun SPARC/UltraSPARC)

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1+etch1_sparc.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_0.9.9-1%2Betch1_sparc.deb)
    Size/MD5 checksum:   242226 b7d5339d30fb2c16fcd2efe4364b36f7

Debian GNU/Linux 5.0 alias lenny
- --------------------------------

Debian (stable)
- ---------------

Stable updates are available for alpha, amd64, arm, armel, hppa, i386, ia64, mips, mipsel, powerpc, s390 and sparc.

Source archives:

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3+lenny1.dsc](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3%2Blenny1.dsc)
    Size/MD5 checksum:     1802 cfe788a8d23049aa8424c4c6ff572989
  <http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7.orig.tar.gz>
    Size/MD5 checksum:   498784 8a143dcee3f6463277dc63cd1c9ef39d
  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3+lenny1.diff.gz](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3%2Blenny1.diff.gz)
    Size/MD5 checksum:     9310 57f3cb25f1a6b8355e0922d083cb8e54

alpha architecture (DEC Alpha)

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3+lenny1_alpha.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3%2Blenny1_alpha.deb)
    Size/MD5 checksum:   280398 374175b22352fd3375430756f134e392

amd64 architecture (AMD x86_64 (AMD64))

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3+lenny1_amd64.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3%2Blenny1_amd64.deb)
    Size/MD5 checksum:   255794 da184e290012863e97bb0b91bb7e61c3

arm architecture (ARM)

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3+lenny1_arm.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3%2Blenny1_arm.deb)
    Size/MD5 checksum:   270630 55379e802f6532e59e78d75300d86093

armel architecture (ARM EABI)

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3+lenny1_armel.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3%2Blenny1_armel.deb)
    Size/MD5 checksum:   243456 f2020f9eb2927a0688bacde831f6e8c7

hppa architecture (HP PA RISC)

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3+lenny1_hppa.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3%2Blenny1_hppa.deb)
    Size/MD5 checksum:   274178 2f08d1aebded06cd3fae819f1395fc70

i386 architecture (Intel ia32)

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3+lenny1_i386.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3%2Blenny1_i386.deb)
    Size/MD5 checksum:   255186 f482f45caaef44e4b69009652f61dc4f

ia64 architecture (Intel ia64)

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3+lenny1_ia64.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3%2Blenny1_ia64.deb)
    Size/MD5 checksum:   303624 e4d9ed8617e10e1f7d3f65181f13b4fd

mips architecture (MIPS (Big Endian))

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3+lenny1_mips.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3%2Blenny1_mips.deb)
    Size/MD5 checksum:   251162 dbf38b5195aa541201fab2a5a4dbcfc6

mipsel architecture (MIPS (Little Endian))

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3+lenny1_mipsel.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3%2Blenny1_mipsel.deb)
    Size/MD5 checksum:   249966 f9e4ef33ba44d55a4f7d6b7cf400a4c7

powerpc architecture (PowerPC)

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3+lenny1_powerpc.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3%2Blenny1_powerpc.deb)
    Size/MD5 checksum:   265718 6b631cbffaa25046e9772f933fd7c18e

s390 architecture (IBM S/390)

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3+lenny1_s390.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3%2Blenny1_s390.deb)
    Size/MD5 checksum:   253984 5d2b17a735cb2775559bde3dc7f74048

sparc architecture (Sun SPARC/UltraSPARC)

  [http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3+lenny1_sparc.deb](http://security.debian.org/pool/updates/main/x/xapian-omega/xapian-omega_1.0.7-3%2Blenny1_sparc.deb)
    Size/MD5 checksum:   259420 fc3bc1f75ed01b7e8ea723d0e4f6b822

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iEYEARECAAYFAkqnrekACgkQHYflSXNkfP8DbgCgoD7kFKcBAWh+pn720fNct5A0
rgwAoIPhlz0aYW9OV9Hn9V4h1us82Oe9
=89aO
-----END PGP SIGNATURE-----

```

---



=== Content from lists.xapian.org_cebc680b_20250125_214047.html ===

# [Xapian-discuss] Cross-site scripting issue in Omega

**Olly Betts**
olly at survex.com

*Wed Sep 9 14:25:06 BST 2009*

* Previous message: [[Xapian-discuss] how can i search and add document at same time](007116.html)
* Next message: [[Xapian-discuss] Cross-site scripting issue in Omega](007125.html)
* **Messages sorted by:**
  [[ date ]](date.html#7115)
  [[ thread ]](thread.html#7115)
  [[ subject ]](subject.html#7115)
  [[ author ]](author.html#7115)

---

```
There's a cross-site scripting issue in Omega - exception messages
don't currently get HTML entities escaped, but can contain CGI parameter
values in some cases.

This issue was reported to me through Debian's security team who have
allocated CVE-2009-2947 to it, and have notified other vendors.

If you're not familiar with such vulnerabilities, this one is what is
termed a "Non-persistent" vulnerability here:

<http://en.wikipedia.org/wiki/Cross-site_scripting>

Because Omega itself doesn't use cookies, the potential impact is low
unless you host Omega on a domain name which runs other web applications
which do have sensitive cookies (or if such cookies are set on the parent
domain), but the fix is extremely unlikely to have side-effects, so I'd
recommend everyone should apply it.

I've attached a patch which which escapes HTML entities in exception
messages which should apply to 1.0.9 and later versions (including all
1.1.x).

1.0.8 and earlier don't catch std::exception but otherwise the same
patch should work, though you should consider upgrading to a more
recent release.

If anyone cares about 0.9.x then the query.h header guard macro name is
different, but otherwise the code is the same as older 1.0.x.

Patched Debian packages should appear shortly, and I intend to release
1.0.16 soon including this fix.

Cheers,
    Olly
-------------- next part --------------
A non-text attachment was scrubbed...
Name: omega-xss-fix-cve-2009-2947.patch
Type: text/x-diff
Size: 1329 bytes
Desc: not available
Url : <http://lists.xapian.org/pipermail/xapian-discuss/attachments/20090909/ddd9b51a/attachment.patch>

```

---

* Previous message: [[Xapian-discuss] how can i search and add document at same time](007116.html)
* Next message: [[Xapian-discuss] Cross-site scripting issue in Omega](007125.html)
* **Messages sorted by:**
  [[ date ]](date.html#7115)
  [[ thread ]](thread.html#7115)
  [[ subject ]](subject.html#7115)
  [[ author ]](author.html#7115)

---

[More information about the Xapian-discuss
mailing list](http://lists.xapian.org/mailman/listinfo/xapian-discuss)


