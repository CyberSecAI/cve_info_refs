```
{
  "vulnerability": {
    "root_cause": "The browser incorrectly processes non-200 responses to CONNECT requests through a proxy when accessing HTTPS websites. It allows the proxy to return arbitrary content that is then executed in the security context of the intended HTTPS site.",
    "weaknesses": [
      "Improper handling of non-200 HTTP responses during proxy CONNECT requests for HTTPS.",
      "Lack of validation of the response origin when an SSL connection fails.",
	  "Failure to isolate proxy error pages from the target site's security context."
    ],
    "impact": "An attacker can execute arbitrary web scripts within the security context of the target HTTPS website, potentially leading to: stealing cookies, impersonating users, and phishing attacks.",
    "attack_vectors": "A man-in-the-middle attacker intercepts the browser's CONNECT request to a proxy server and responds with malicious content.",
    "required_capabilities": "The attacker needs to be positioned to intercept and manipulate network traffic between the browser and the proxy server. They also need to be able to inject a malicious HTTP response to a CONNECT request."
  },
  "additional_details": {
    "mitigation": "The vulnerability is fixed by treating all non-200 responses to a proxy CONNECT request (except for 407 authentication responses) as a network error, preventing the malicious content from being processed. The fix also ensures that even when a 407 proxy authentication response is received, any data in the response body is not treated as coming from the target site.",
    "discussion_points": [
      "There were discussions about whether to display the proxy's error page or a generic error page. The decision was to display a generic error page for security reasons.",
      "The issue has a complex interaction with proxy authentication (407 response) where the browser needs to handle the authentication challenge dialog correctly without exposing the vulnerability."
     ]
  }
}
```