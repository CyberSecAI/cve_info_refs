=== Content from mantisbt.org_7b46b536_20250126_055709.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview_user_page.php%3Fid%3D17784)
[Signup for a new account](/bugs/signup_page.php)

#### User Information

| Username | dregad |
| --- | --- |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1539 seconds



=== Content from mantisbt.org_8b6062a0_20250125_042126.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview.php%3Fid%3D27976)
[Signup for a new account](/bugs/signup_page.php)

#### View Issue Details

[Wiki](wiki.php?id=27976)[Related Changesets](#changesets)[Jump to Notes](#bugnotes)

|  | | | | | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| --- | --- | --- | --- | --- | --- |
| 0027976 | mantisbt | security | public | 2021-02-12 06:37 | 2024-01-31 05:49 |
|  | | | | | |
|
| Reporter | [vaibhs](https://mantisbt.org/bugs/view_user_page.php?id=50349) | Assigned To | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) |  | |
| Priority | high | Severity | major | Reproducibility | always |
| Status | closed | Resolution | fixed |  | |
| Target Version | 2.24.5 | Fixed in Version | 2.24.5 |  | |
|  | | | | | |
|
| Summary | 0027976: CVE-2009-20001: User cookie string is not reset upon logout | | | | |
| Description | VULNERABILITY NAME: SESSION HIJACKING.  VULNERABILITY URL: <https://bugs.kali.org/>  DESCRIPTION: In computer science, session hijacking, sometimes also known as cookie hijacking is the exploitation of a valid computer session—sometimes also called a session key—to gain unauthorized access to information or services in a computer system.  Please check this issue I sent this issue on <https://bugs.kali.org/> but on there Mr. rhertzog said to send this issue on here that's why I send this issue here...please check and replay back regarding this vulnerability issue. | | | | |
| Steps To Reproduce | STEPS TO REPRODUCED: 1) Log in to your account 2) Copy your cookies 3) Logout 4) Clear browser cookies 5) Paste the cookies (copied in step 2) 6) Refresh the page 7) Now you will be logged into the account | | | | |
| Additional Information | The Patch: Cookies should expire after the logout and previous cookies should not be used for logging into the account, they should expire!  IMPACT:  The malicious attacker can enter the server and access its information without having to hack a registered account. In addition, he can also make modifications on the server to help him hack it in the future or to simplify a data-stealing operation.  Please check this issue I sent this issue on <https://bugs.kali.org/> but on there Mr. rhertzog said to send this issue on here that's why I send this issue here...please check and replay back regarding this vulnerability issue. | | | | |
| Tags | No tags attached. | | | | |
| Attached Files | [bandicam 2021-02-12 16-47-08-562.mp4](file_download.php?file_id=9532&type=bug) (1,775,895 bytes)    [Your browser does not support video tag.](file_download.php?file_id=9532&type=bug)  [bandicam 2021-02-12 16-47-08-562.mp4](file_download.php?file_id=9532&type=bug) (1,775,895 bytes)     [bandicam 2021-02-09 14-59-05-295.mp4](file_download.php?file_id=9533&type=bug) (1,273,295 bytes)    [Your browser does not support video tag.](file_download.php?file_id=9533&type=bug)  [bandicam 2021-02-09 14-59-05-295.mp4](file_download.php?file_id=9533&type=bug) (1,273,295 bytes) | | | | |
|  | | | | | |
|

#### Relationships

[Relationship Graph](bug_relationship_graph.php?bug_id=27976&graph=relation)[Dependency Graph](bug_relationship_graph.php?bug_id=27976&graph=dependency)

| related to | [0011296](view.php?id=11296) | acknowledged |  | Mantis BT is using fix cookies in the DB |
| --- | --- | --- | --- | --- |
| has duplicate | [0033587](view.php?id=33587) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | "MANTIS\_STRING\_COOKIE" cookie reusable after user logout |
| related to | [0028385](view.php?id=28385) | new |  | The RSS url is functionnal a short time |

#### Activities

| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2021-02-13 13:02  developer    [~0065100](view.php?id=27976#c65100 "Direct link to note") | Thanks for your report.  In the future, please **submit security issues as private**, which avoids unwanted early general disclosure before we have time to review and possibly patch the issue. I would also kindly suggest you ask the people at kali.org to do the same for <https://bugs.kali.org/view.php?id=7044>.  I need to analyze this, but here are some preliminary remarks:   * When logging in, users have options to restrict session validity to their current IP, which mitigates the risk * By default, the session cookie's validity is limited to the browser session; users also have the option to create a "permanent" cookie, if this feature is enabled by admin (see $g\_allow\_permanent\_cookie) with a validity defined by $g\_cookie\_time\_length (defaults to 1 year) * This behavior could be altered by custom authentication plugins, over which we have no control. |
| --- | --- |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2021-02-13 13:24  developer    [~0065101](view.php?id=27976#c65101 "Direct link to note") | Also, as a side note, you're only hijacking yourself here... How would an attacker obtain your cookies (and use them, if you restrict your session by IP) ? |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2021-02-13 15:41  developer    [~0065102](view.php?id=27976#c65102 "Direct link to note") | So after a quick check, I can confirm that we *do* delete the session cookie, when logging out, yet the behavior described does allow to login with the previously stored cookie string.  So the problem's root cause is actually the reuse of the cookie string, as discussed in [0011296](/bugs/view.php?id=11296 "[acknowledged] Mantis BT is using fix cookies in the DB").  Without going for a full rewrite as discussed there, we could probably mitigate the risk by invalidating the user's cookie string upon logout. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2021-02-13 19:55  developer    [~0065105](view.php?id=27976#c65105 "Direct link to note") | Proposed fix: PR <https://github.com/mantisbt/mantisbt/pull/1737>  Note: I'm setting this back to *public*, considering that it's basically the same issue as [0011296](/bugs/view.php?id=11296 "[acknowledged] Mantis BT is using fix cookies in the DB"), which has been out in the open for over 12 years... |
|  | |
| [vaibhs](https://mantisbt.org/bugs/view_user_page.php?id=50349)   [vaibhs](https://mantisbt.org/bugs/view_user_page.php?id=50349)  2021-02-15 06:20  reporter    [~0065124](view.php?id=27976#c65124 "Direct link to note") | Hello Team, Sir this is a different issue than 0011296 because if you check that is also depend upon cookie but not as same issue which I sent. If the cookie editor copy the cookie and reusable that cookie if you are login in account then this is valid issue I get 600$ and 400$ for this issue from RDP program so please check and replay back again regarding my reward because this is valid issue.  Regards, Vaibhav |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2021-02-15 11:22  developer    [~0065126](view.php?id=27976#c65126 "Direct link to note") | [@vaibhs](https://mantisbt.org/bugs/view_user_page.php?id=50349) I don't know what you're talking about. I never said the issue is not valid (I would have closed it if that were the case), in fact I even proposed a fix for it which is currently being discussed....  Also, no idea where this reward thing is coming from. If you're getting paid for it then good for you but it's not our concern. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2021-03-05 19:31  developer    [~0065181](view.php?id=27976#c65181 "Direct link to note") | Changed target to 2.24.5 |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2021-03-05 20:03  developer    [~0065185](view.php?id=27976#c65185 "Direct link to note") | CVE Request 1039557 sent |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2021-03-11 20:20  developer    [~0065225](view.php?id=27976#c65225 "Direct link to note") | CVE-2009-20001 assigned |
|  | |

#### Related Changesets

| MantisBT: master 6f369a5a  2021-02-13 12:33  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=25652) [Diff](https://github.com/mantisbt/mantisbt/commit/6f369a5a98d8d3e3513b3487938581f671d4b4ee) | Reset user session cookie string upon logout | | Affected Issues[0011296](/bugs/view.php?id=11296 "[acknowledged] Mantis BT is using fix cookies in the DB"), [0027976](/bugs/view.php?id=27976 "[closed] CVE-2009-20001: User cookie string is not reset upon logout") |
| --- | --- | --- | --- |
| mod - core/authentication\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/6f369a5a98d8d3e3513b3487938581f671d4b4ee) [File](https://github.com/mantisbt/mantisbt/blob/6f369a5a98d8d3e3513b3487938581f671d4b4ee/core/authentication_api.php) |
| MantisBT: master d8181a54  2021-02-24 08:16  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=25653) [Diff](https://github.com/mantisbt/mantisbt/commit/d8181a548e5131eede5d3b891bec0df68b472ba9) | Set a new random cookie string upon logout | | Affected Issues[0027976](/bugs/view.php?id=27976 "[closed] CVE-2009-20001: User cookie string is not reset upon logout") |
| mod - core/authentication\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/d8181a548e5131eede5d3b891bec0df68b472ba9) [File](https://github.com/mantisbt/mantisbt/blob/d8181a548e5131eede5d3b891bec0df68b472ba9/core/authentication_api.php) |
| MantisBT: master-2.24 79a78c09  2021-02-24 08:16  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=25658) [Diff](https://github.com/mantisbt/mantisbt/commit/79a78c09d5ef5ce098adc73f6f1416f00fc238a5) | Set a new random cookie string upon logout | | Affected Issues[0011296](/bugs/view.php?id=11296 "[acknowledged] Mantis BT is using fix cookies in the DB"), [0027976](/bugs/view.php?id=27976 "[closed] CVE-2009-20001: User cookie string is not reset upon logout") |
| mod - core/authentication\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/79a78c09d5ef5ce098adc73f6f1416f00fc238a5) [File](https://github.com/mantisbt/mantisbt/blob/79a78c09d5ef5ce098adc73f6f1416f00fc238a5/core/authentication_api.php) |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1688 seconds



=== Content from bugs.kali.org_d9124e18_20250126_055649.html ===


Toggle sidebar [Kali Linux Bug Tracker](/my_view_page.php) Toggle user menu

* anonymous
  + [RSS](https://bugs.kali.org/issues_rss.php)
  + [Logout](/logout_page.php)

* [My View](/my_view_page.php)
* [View Issues](/view_all_bug_page.php)
* [Change Log](/changelog_page.php)
* [Weekly Images](https://cdimage.kali.org/kali-weekly/)
* [Build Logs](https://repo.kali.org/build-logs/)
* [Package Tracker](https://pkg.kali.org/)
* [Community Forums](https://forums.kali.org/)
* [Discord](https://discord.kali.org/)

* Anonymous
[Login](/login_page.php?return=%2Fmy_view_page.php)
[Signup for a new account](/signup_page.php)

#### [Unassigned](view_all_set.php?type=1&temporary=y&handler_id=[none]&hide_status=90) 1 - 10 / 356

[View Issues](view_all_set.php?type=1&temporary=y&handler_id=[none]&hide_status=90)

| [0009079](/view.php?id=9079) | [Invalid - Error in desktopconfig.py / Invalid - Error install reconspider](view.php?id=9079) [All Projects] Kali Package Improvement - **2025-01-26 01:58** |
| --- | --- |
| [0009078](/view.php?id=9078) | [codeinjection-scan-ml-ai](view.php?id=9078) [All Projects] New Tool Requests - 2025-01-25 18:11 |
| [0009049](/view.php?id=9049) | [<< Forum Home NetHunter Forums NetHunter General/Troubleshooting Sudo: unable to find terminal name for device 136, 0 Sudo: unab](view.php?id=9049) [All Projects] General Bug - 2025-01-25 17:13 |
| [0009050](/view.php?id=9050) | [Sudo Need upgrade to latest version in nethunter and vnc should fix in root season](view.php?id=9050) [All Projects] Tool Upgrade Request - 2025-01-25 14:38 |
| [0009024](/view.php?id=9024) | [Intframework - provides an extensive array of tools for penetration testing, exploit development, and vulnerability assessment](view.php?id=9024) [All Projects] New Tool Requests - 2025-01-23 14:44 |
| [0009077](/view.php?id=9077) | [Issue with python3-fastapi during Package Installation/Upgrade on Kali Linux Rolling (2024.4) in VirtualBox](view.php?id=9077) [All Projects] Kali Package Bug - 2025-01-23 08:10 |
| [0007387](/view.php?id=7387) | [Qu1cksc0pe - All in One malware analysis tool](view.php?id=7387) [All Projects] Queued Tool Addition - 2025-01-22 14:39 |
| [0009076](/view.php?id=9076) | [Command-line tool to identify useragents that bypasses proxy restrictions](view.php?id=9076) [All Projects] New Tool Requests - 2025-01-21 23:26 |
| [0009029](/view.php?id=9029) | [gitxray - multifaceted security tool which leverages Public GitHub REST APIs for OSINT, Forensics, Pentesting and more.](view.php?id=9029) [All Projects] New Tool Requests - 2025-01-21 09:57 |
| [0009075](/view.php?id=9075) | ['Settings' bug in gnome doesn't work due to some issue/error.](view.php?id=9075) [All Projects] General Bug - 2025-01-20 19:56 |

#### [Resolved](view_all_set.php?type=1&temporary=y&status=80&hide_status=90) 1 - 10 / 2468

[View Issues](view_all_set.php?type=1&temporary=y&status=80&hide_status=90)

| [0009053](/view.php?id=9053) | [Missing packages for Sickle v3.1.0](view.php?id=9053) [All Projects] Tool Upgrade Request - 2025-01-24 10:24 |
| --- | --- |
| [0009065](/view.php?id=9065) | [Super + Left / Right Arrow Key Shortcut not functioning in Kali 2024.4](view.php?id=9065) [All Projects] General Bug - 2025-01-14 07:35 |
| [0009067](/view.php?id=9067) | [ZAP 2.16.0 has been released](view.php?id=9067) [All Projects] Tool Upgrade Request - 2025-01-14 07:32 |
| [0009041](/view.php?id=9041) | [Kali-Dark and Kali-Light terminal theme unavailable on XFCE when installing fresh from netinstaller](view.php?id=9041) [All Projects] General Bug - 2025-01-13 08:45 |
| [0009064](/view.php?id=9064) | [white terminal theme](view.php?id=9064) [All Projects] Feature Requests - 2025-01-13 08:43 |
| [0009062](/view.php?id=9062) | [Error in Fierce pythod code](view.php?id=9062) [All Projects] Kali Package Bug - 2025-01-13 03:44 |
| [0009048](/view.php?id=9048) | [Kali-Dark and Kali-Light terminal themes missing after updating to qt6](view.php?id=9048) [All Projects] General Bug - 2025-01-07 08:59 |
| [0009038](/view.php?id=9038) | [gimp is not available](view.php?id=9038) [All Projects] Kali Package Bug - 2024-12-21 04:23 |
| [0009037](/view.php?id=9037) | [after update libqt6svg6 kali kde menu crash again](view.php?id=9037) [All Projects] General Bug - 2024-12-20 02:04 |
| [0009032](/view.php?id=9032) | [nmap - privilege wrapper breaks --resume](view.php?id=9032) [All Projects] Kali Package Bug - 2024-12-19 19:30 |

#### [Recently Modified (30 Days)](view_all_set.php?type=1&temporary=y&hide_status=none&filter_by_last_updated_date=1&last_updated_end_day=26&last_updated_end_month=1&last_updated_end_year=2025&last_updated_start_day=27&last_updated_start_month=12&last_updated_start_year=2024) 1 - 10 / 52

[View Issues](view_all_set.php?type=1&temporary=y&hide_status=none&filter_by_last_updated_date=1&last_updated_end_day=26&last_updated_end_month=1&last_updated_end_year=2025&last_updated_start_day=27&last_updated_start_month=12&last_updated_start_year=2024)

| [0009079](/view.php?id=9079) | [Invalid - Error in desktopconfig.py / Invalid - Error install reconspider](view.php?id=9079) [All Projects] Kali Package Improvement - **2025-01-26 01:58** |
| --- | --- |
| [0009078](/view.php?id=9078) | [codeinjection-scan-ml-ai](view.php?id=9078) [All Projects] New Tool Requests - 2025-01-25 18:11 |
| [0009049](/view.php?id=9049) | [<< Forum Home NetHunter Forums NetHunter General/Troubleshooting Sudo: unable to find terminal name for device 136, 0 Sudo: unab](view.php?id=9049) [All Projects] General Bug - 2025-01-25 17:13 |
| [0009050](/view.php?id=9050) | [Sudo Need upgrade to latest version in nethunter and vnc should fix in root season](view.php?id=9050) [All Projects] Tool Upgrade Request - 2025-01-25 14:38 |
| [0009053](/view.php?id=9053) | [Missing packages for Sickle v3.1.0](view.php?id=9053) [All Projects] Tool Upgrade Request - 2025-01-24 10:24 |
| [0009024](/view.php?id=9024) | [Intframework - provides an extensive array of tools for penetration testing, exploit development, and vulnerability assessment](view.php?id=9024) [All Projects] New Tool Requests - 2025-01-23 14:44 |
| [0009077](/view.php?id=9077) | [Issue with python3-fastapi during Package Installation/Upgrade on Kali Linux Rolling (2024.4) in VirtualBox](view.php?id=9077) [All Projects] Kali Package Bug - 2025-01-23 08:10 |
| [0008959](/view.php?id=8959) | [Extension suggestion for "Submitting Bugs for Kali Linux" documentation](view.php?id=8959) [All Projects] Kali Websites & Docs - 2025-01-22 17:41 |
| [0007387](/view.php?id=7387) | [Qu1cksc0pe - All in One malware analysis tool](view.php?id=7387) [All Projects] Queued Tool Addition - 2025-01-22 14:39 |
| [0009076](/view.php?id=9076) | [Command-line tool to identify useragents that bypasses proxy restrictions](view.php?id=9076) [All Projects] New Tool Requests - 2025-01-21 23:26 |

#### Timeline

   2025-01-19  ..  2025-01-26    [Prev](my_view_page.php?days=7)

[![incanato](https://secure.gravatar.com/avatar/5ea592c8480e7efaa57c2e26dfdda39a?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=19345)[incanato](https://bugs.kali.org/view_user_page.php?id=19345) created issue [0009079](/view.php?id=9079 "[new] Invalid - Error in desktopconfig.py / Invalid - Error install reconspider") 2025-01-26 01:58[![kali-bugreport](https://secure.gravatar.com/avatar/b45650fc91232f4dd2c1349ca5e81c05?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=7410)[kali-bugreport](https://bugs.kali.org/view_user_page.php?id=7410) commented on issue [0009078](/view.php?id=9078 "[new] codeinjection-scan-ml-ai") 2025-01-25 18:11[![mrharoonawan](https://secure.gravatar.com/avatar/c3fdc30f4388de0b29984fbcae0b3a14?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8945)[mrharoonawan](https://bugs.kali.org/view_user_page.php?id=8945) commented on issue [0009078](/view.php?id=9078 "[new] codeinjection-scan-ml-ai") 2025-01-25 17:36[![mrharoonawan](https://secure.gravatar.com/avatar/c3fdc30f4388de0b29984fbcae0b3a14?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8945)[mrharoonawan](https://bugs.kali.org/view_user_page.php?id=8945) created issue [0009078](/view.php?id=9078 "[new] codeinjection-scan-ml-ai") 2025-01-25 17:35[![Liikala96](https://secure.gravatar.com/avatar/0342d016e158802c8f009dbe4bd79e65?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=18410)[Liikala96](https://bugs.kali.org/view_user_page.php?id=18410) commented on issue [0009049](/view.php?id=9049 "[new] << Forum Home NetHunter Forums NetHunter General/Troubleshooting Sudo: unable to find terminal name for device 136, 0 Sudo: unab") 2025-01-25 16:53[![kali-bugreport](https://secure.gravatar.com/avatar/b45650fc91232f4dd2c1349ca5e81c05?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=7410)[kali-bugreport](https://bugs.kali.org/view_user_page.php?id=7410) commented on issue [0009049](/view.php?id=9049 "[new] << Forum Home NetHunter Forums NetHunter General/Troubleshooting Sudo: unable to find terminal name for device 136, 0 Sudo: unab") 2025-01-25 16:46[![Liikala96](https://secure.gravatar.com/avatar/0342d016e158802c8f009dbe4bd79e65?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=18410)[Liikala96](https://bugs.kali.org/view_user_page.php?id=18410) commented on issue [0009049](/view.php?id=9049 "[new] << Forum Home NetHunter Forums NetHunter General/Troubleshooting Sudo: unable to find terminal name for device 136, 0 Sudo: unab") 2025-01-25 16:35[![kali-bugreport](https://secure.gravatar.com/avatar/b45650fc91232f4dd2c1349ca5e81c05?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=7410)[kali-bugreport](https://bugs.kali.org/view_user_page.php?id=7410) commented on issue [0009049](/view.php?id=9049 "[new] << Forum Home NetHunter Forums NetHunter General/Troubleshooting Sudo: unable to find terminal name for device 136, 0 Sudo: unab") 2025-01-25 16:12[![Liikala96](https://secure.gravatar.com/avatar/0342d016e158802c8f009dbe4bd79e65?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=18410)[Liikala96](https://bugs.kali.org/view_user_page.php?id=18410) commented on issue [0009049](/view.php?id=9049 "[new] << Forum Home NetHunter Forums NetHunter General/Troubleshooting Sudo: unable to find terminal name for device 136, 0 Sudo: unab") 2025-01-25 14:41[![sbrun](https://secure.gravatar.com/avatar/1947bf34ace0e13f9a2368d7c76e40b7?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=3364)[sbrun](https://bugs.kali.org/view_user_page.php?id=3364) resolved issue [0009053](/view.php?id=9053 "[resolved] Missing packages for Sickle v3.1.0") 2025-01-24 10:24[![sbrun](https://secure.gravatar.com/avatar/1947bf34ace0e13f9a2368d7c76e40b7?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=3364)[sbrun](https://bugs.kali.org/view_user_page.php?id=3364) commented on issue [0009053](/view.php?id=9053 "[resolved] Missing packages for Sickle v3.1.0") 2025-01-24 10:24[![intapp21](https://secure.gravatar.com/avatar/fb13d0010fc609bf00654a0ff74b2c70?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=18886)[intapp21](https://bugs.kali.org/view_user_page.php?id=18886) commented on issue [0009024](/view.php?id=9024 "[new] Intframework - provides an extensive array of tools for penetration testing, exploit development, and vulnerability assessment") 2025-01-23 14:44[![daniruiz](https://secure.gravatar.com/avatar/0438bcc500308552a562d0d5d6b0baeb?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8943)[daniruiz](https://bugs.kali.org/view_user_page.php?id=8943) commented on issue [0009077](/view.php?id=9077 "[new] Issue with python3-fastapi during Package Installation/Upgrade on Kali Linux Rolling (2024.4) in VirtualBox") 2025-01-23 08:10[![kali-bugreport](https://secure.gravatar.com/avatar/b45650fc91232f4dd2c1349ca5e81c05?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=7410)[kali-bugreport](https://bugs.kali.org/view_user_page.php?id=7410) commented on issue [0008959](/view.php?id=8959 "[assigned] Extension suggestion for \"Submitting Bugs for Kali Linux\" documentation") 2025-01-22 17:41[![kali-bugreport](https://secure.gravatar.com/avatar/b45650fc91232f4dd2c1349ca5e81c05?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=7410)[kali-bugreport](https://bugs.kali.org/view_user_page.php?id=7410) commented on issue [0009077](/view.php?id=9077 "[new] Issue with python3-fastapi during Package Installation/Upgrade on Kali Linux Rolling (2024.4) in VirtualBox") 2025-01-22 17:18[![kali-bugreport](https://secure.gravatar.com/avatar/b45650fc91232f4dd2c1349ca5e81c05?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=7410)[kali-bugreport](https://bugs.kali.org/view_user_page.php?id=7410) commented on issue [0009077](/view.php?id=9077 "[new] Issue with python3-fastapi during Package Installation/Upgrade on Kali Linux Rolling (2024.4) in VirtualBox") 2025-01-22 17:18[![wetw0rk](https://secure.gravatar.com/avatar/90e07c6e12eddb6d3677df68e303e8dd?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=6702)[wetw0rk](https://bugs.kali.org/view_user_page.php?id=6702) commented on issue [0009053](/view.php?id=9053 "[resolved] Missing packages for Sickle v3.1.0") 2025-01-22 15:34[![AggroSchlumpf](https://secure.gravatar.com/avatar/79de8f14f9bee7b7d6db901079fb3a38?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=19319)[AggroSchlumpf](https://bugs.kali.org/view_user_page.php?id=19319) attached file *2025-01-22-160138\_1368x768\_scrot.png* to issue [0009077](/view.php?id=9077 "[new] Issue with python3-fastapi during Package Installation/Upgrade on Kali Linux Rolling (2024.4) in VirtualBox") 2025-01-22 15:19[![AggroSchlumpf](https://secure.gravatar.com/avatar/79de8f14f9bee7b7d6db901079fb3a38?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=19319)[AggroSchlumpf](https://bugs.kali.org/view_user_page.php?id=19319) created issue [0009077](/view.php?id=9077 "[new] Issue with python3-fastapi during Package Installation/Upgrade on Kali Linux Rolling (2024.4) in VirtualBox") 2025-01-22 15:19[![sbrun](https://secure.gravatar.com/avatar/1947bf34ace0e13f9a2368d7c76e40b7?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=3364)[sbrun](https://bugs.kali.org/view_user_page.php?id=3364) commented on issue [0009053](/view.php?id=9053 "[resolved] Missing packages for Sickle v3.1.0") 2025-01-22 13:32[![Karthick-Siva](https://secure.gravatar.com/avatar/61bb7eb9e5d59c37dd3c24e5dcee1a4f?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=19294)[Karthick-Siva](https://bugs.kali.org/view_user_page.php?id=19294) commented on issue [0009076](/view.php?id=9076 "[new] Command-line tool to identify useragents that bypasses proxy restrictions") 2025-01-21 23:26[![kali-bugreport](https://secure.gravatar.com/avatar/b45650fc91232f4dd2c1349ca5e81c05?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=7410)[kali-bugreport](https://bugs.kali.org/view_user_page.php?id=7410) commented on issue [0009060](/view.php?id=9060 "[assigned] Lock screen activated despite settings set to not lock screen in Kali 2024.4") 2025-01-21 21:23[![fiktion5](https://secure.gravatar.com/avatar/627464ec46e9e83b707e114f02210200?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=19195)[fiktion5](https://bugs.kali.org/view_user_page.php?id=19195) commented on issue [0009060](/view.php?id=9060 "[assigned] Lock screen activated despite settings set to not lock screen in Kali 2024.4") 2025-01-21 21:00[![kali-bugreport](https://secure.gravatar.com/avatar/b45650fc91232f4dd2c1349ca5e81c05?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=7410)[kali-bugreport](https://bugs.kali.org/view_user_page.php?id=7410) commented on issue [0009060](/view.php?id=9060 "[assigned] Lock screen activated despite settings set to not lock screen in Kali 2024.4") 2025-01-21 20:52[![kpd](https://secure.gravatar.com/avatar/e9b40ec4dd7e3b5b3d703bfba190306b?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=19193)[kpd](https://bugs.kali.org/view_user_page.php?id=19193) commented on issue [0009060](/view.php?id=9060 "[assigned] Lock screen activated despite settings set to not lock screen in Kali 2024.4") 2025-01-21 18:13[![kali-bugreport](https://secure.gravatar.com/avatar/b45650fc91232f4dd2c1349ca5e81c05?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=7410)[kali-bugreport](https://bugs.kali.org/view_user_page.php?id=7410) commented on issue [0009060](/view.php?id=9060 "[assigned] Lock screen activated despite settings set to not lock screen in Kali 2024.4") 2025-01-21 17:52[![daniruiz](https://secure.gravatar.com/avatar/0438bcc500308552a562d0d5d6b0baeb?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8943)[daniruiz](https://bugs.kali.org/view_user_page.php?id=8943) picked up issue [0009060](/view.php?id=9060 "[assigned] Lock screen activated despite settings set to not lock screen in Kali 2024.4") 2025-01-21 12:45[![daniruiz](https://secure.gravatar.com/avatar/0438bcc500308552a562d0d5d6b0baeb?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8943)[daniruiz](https://bugs.kali.org/view_user_page.php?id=8943) closed issue [0008991](/view.php?id=8991 "[closed] Automatic deauthentication does not work") 2025-01-21 10:00[![daniruiz](https://secure.gravatar.com/avatar/0438bcc500308552a562d0d5d6b0baeb?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8943)[daniruiz](https://bugs.kali.org/view_user_page.php?id=8943) picked up issue [0008991](/view.php?id=8991 "[closed] Automatic deauthentication does not work") 2025-01-21 10:00[![daniruiz](https://secure.gravatar.com/avatar/0438bcc500308552a562d0d5d6b0baeb?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8943)[daniruiz](https://bugs.kali.org/view_user_page.php?id=8943) commented on issue [0008991](/view.php?id=8991 "[closed] Automatic deauthentication does not work") 2025-01-21 10:00[![daniruiz](https://secure.gravatar.com/avatar/0438bcc500308552a562d0d5d6b0baeb?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8943)[daniruiz](https://bugs.kali.org/view_user_page.php?id=8943) commented on issue [0009029](/view.php?id=9029 "[new] gitxray -  multifaceted security tool which leverages Public GitHub REST APIs for OSINT, Forensics, Pentesting and more.") 2025-01-21 09:57[![daniruiz](https://secure.gravatar.com/avatar/0438bcc500308552a562d0d5d6b0baeb?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8943)[daniruiz](https://bugs.kali.org/view_user_page.php?id=8943) closed issue [0009070](/view.php?id=9070 "[closed] Can't find hard when installing") 2025-01-21 08:41[![daniruiz](https://secure.gravatar.com/avatar/0438bcc500308552a562d0d5d6b0baeb?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8943)[daniruiz](https://bugs.kali.org/view_user_page.php?id=8943) picked up issue [0009070](/view.php?id=9070 "[closed] Can't find hard when installing") 2025-01-21 08:41[![daniruiz](https://secure.gravatar.com/avatar/0438bcc500308552a562d0d5d6b0baeb?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8943)[daniruiz](https://bugs.kali.org/view_user_page.php?id=8943) commented on issue [0009070](/view.php?id=9070 "[closed] Can't find hard when installing") 2025-01-21 08:39[![daniruiz](https://secure.gravatar.com/avatar/0438bcc500308552a562d0d5d6b0baeb?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8943)[daniruiz](https://bugs.kali.org/view_user_page.php?id=8943) closed issue [0009072](/view.php?id=9072 "[closed] 7zip issue with docx") 2025-01-21 08:37[![daniruiz](https://secure.gravatar.com/avatar/0438bcc500308552a562d0d5d6b0baeb?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8943)[daniruiz](https://bugs.kali.org/view_user_page.php?id=8943) picked up issue [0009072](/view.php?id=9072 "[closed] 7zip issue with docx") 2025-01-21 08:37[![daniruiz](https://secure.gravatar.com/avatar/0438bcc500308552a562d0d5d6b0baeb?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8943)[daniruiz](https://bugs.kali.org/view_user_page.php?id=8943) commented on issue [0009072](/view.php?id=9072 "[closed] 7zip issue with docx") 2025-01-21 08:36[![daniruiz](https://secure.gravatar.com/avatar/0438bcc500308552a562d0d5d6b0baeb?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8943)[daniruiz](https://bugs.kali.org/view_user_page.php?id=8943) closed issue [0009071](/view.php?id=9071 "[closed] upgrade to linux-image-6.11.2-arm64 & Desktop broken") 2025-01-21 08:35[![daniruiz](https://secure.gravatar.com/avatar/0438bcc500308552a562d0d5d6b0baeb?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8943)[daniruiz](https://bugs.kali.org/view_user_page.php?id=8943) picked up issue [0009071](/view.php?id=9071 "[closed] upgrade to linux-image-6.11.2-arm64 & Desktop broken") 2025-01-21 08:35[![daniruiz](https://secure.gravatar.com/avatar/0438bcc500308552a562d0d5d6b0baeb?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8943)[daniruiz](https://bugs.kali.org/view_user_page.php?id=8943) commented on issue [0009071](/view.php?id=9071 "[closed] upgrade to linux-image-6.11.2-arm64 & Desktop broken") 2025-01-21 08:33[![daniruiz](https://secure.gravatar.com/avatar/0438bcc500308552a562d0d5d6b0baeb?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8943)[daniruiz](https://bugs.kali.org/view_user_page.php?id=8943) closed issue [0009073](/view.php?id=9073 "[closed] WiFi deauthentication failure") 2025-01-21 08:29[![daniruiz](https://secure.gravatar.com/avatar/0438bcc500308552a562d0d5d6b0baeb?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=8943)[daniruiz](https://bugs.kali.org/view_user_page.php?id=8943) picked up issue [0009073](/view.php?id=9073 "[closed] WiFi deauthentication failure") 2025-01-21 08:29[![Karthick-Siva](https://secure.gravatar.com/avatar/61bb7eb9e5d59c37dd3c24e5dcee1a4f?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=19294)[Karthick-Siva](https://bugs.kali.org/view_user_page.php?id=19294) created issue [0009076](/view.php?id=9076 "[new] Command-line tool to identify useragents that bypasses proxy restrictions") 2025-01-21 06:59[![DeadshotXIV](https://secure.gravatar.com/avatar/0f6714bad199585ee53b4eb5271dcb97?d=identicon&r=G&s=40)](https://bugs.kali.org/view_user_page.php?id=19303)[DeadshotXIV](https://bugs.kali.org/view_user_page.php?id=19303) created issue [0009075](/view.php?id=9075 "[new] 'Settings' bug in gnome doesn't work due to some issue/error.") 2025-01-20 19:56

**Powered by [MantisBT](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact [administrator](/cdn-cgi/l/email-protection#c1b6a4a3aca0b2b5a4b3e19ae1a0b5e19ce1aaa0ada8e19aa5f1b59ce1aeb3a6 "Contact the webmaster via e-mail.") for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")



=== Content from github.com_4a245772_20250126_055649.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fd8181a548e5131eede5d3b891bec0df68b472ba9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fd8181a548e5131eede5d3b891bec0df68b472ba9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/d8181a548e5131eede5d3b891bec0df68b472ba9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Set a new random cookie string upon logout

[Browse files](/mantisbt/mantisbt/tree/d8181a548e5131eede5d3b891bec0df68b472ba9)
Browse the repository at this point in the history

```
Per [@vboctor](https://github.com/vboctor)'s request in PR review [1].

This reverts the earlier implementation, where the cookie string was set
to '' and a new one generated at next login.

Fixes #27976

[1]: [#1737](https://github.com/mantisbt/mantisbt/pull/1737)
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Mar 6, 2021

1 parent
[6f369a5](/mantisbt/mantisbt/commit/6f369a5a98d8d3e3513b3487938581f671d4b4ee)

commit d8181a5

Showing
**1 changed file**
with
**2 additions**
and
**9 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

11 changes: 2 additions & 9 deletions

11
[core/authentication\_api.php](#diff-7c80b0f77a7edfae64a1d30d5a4a6780656de39493ebbdeb1031eabf6606ffa7 "core/authentication_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/d8181a548e5131eede5d3b891bec0df68b472ba9/core/authentication_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -659,11 +659,11 @@ function auth\_logout() { |
|  |  | global $g\_cache\_current\_user\_id, $g\_cache\_cookie\_valid; |
|  |  |  |
|  |  | if( !user\_is\_protected( $g\_cache\_current\_user\_id ) ) { |
|  |  | # Clear the user's cookie string |
|  |  | # Reset the user's cookie string |
|  |  | user\_set\_field( |
|  |  | $g\_cache\_current\_user\_id, |
|  |  | 'cookie\_string', |
|  |  | '' |
|  |  | auth\_generate\_unique\_cookie\_string() |
|  |  | ); |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -845,13 +845,6 @@ function auth\_generate\_confirm\_hash( $p\_user\_id ) { |
|  |  | \*/ |
|  |  | function auth\_set\_cookies( $p\_user\_id, $p\_perm\_login = false ) { |
|  |  | $t\_cookie\_string = user\_get\_field( $p\_user\_id, 'cookie\_string' ); |
|  |  |  |
|  |  | # If cookie string is not set in DB, generate a new one |
|  |  | if( !$t\_cookie\_string ) { |
|  |  | $t\_cookie\_string = auth\_generate\_unique\_cookie\_string(); |
|  |  | user\_set\_field( $p\_user\_id, 'cookie\_string', $t\_cookie\_string ); |
|  |  | } |
|  |  |  |
|  |  | $t\_cookie\_name = config\_get\_global( 'string\_cookie' ); |
|  |  | gpc\_set\_cookie( $t\_cookie\_name, $t\_cookie\_string, auth\_session\_expiry( $p\_user\_id, $p\_perm\_login ) ); |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d8181a5`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fd8181a548e5131eede5d3b891bec0df68b472ba9) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e82fef6c_20250126_055703.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F79a78c09d5ef5ce098adc73f6f1416f00fc238a5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F79a78c09d5ef5ce098adc73f6f1416f00fc238a5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/79a78c09d5ef5ce098adc73f6f1416f00fc238a5)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Set a new random cookie string upon logout

[Browse files](/mantisbt/mantisbt/tree/79a78c09d5ef5ce098adc73f6f1416f00fc238a5)
Browse the repository at this point in the history

```
When a user logs out from Mantis, we reset their session cookie string.
This ensures that anyone knowing its value is no longer able to login
with it.

While not a complete fix for issue #11296, this does improve the
situation by providing an easy and logical means for users to
effectively invalidate all their previous sessions.

Additionally, using an empty value to indicate an invalidated cookie
string instead of directly generating a new hash makes it easy to:
- identify user records which should be considered as logged out
  (e.g. last_visit older than $g_cookie_time_length)
- invalidate login cookies (set them to '')
Leveraging this is left for future improvements.

Note: an empty string in the session cookie always triggers an anonymous
login (or sends the user back to login page if anonymous login is
disabled).

Fixes #27976

(cherry picked from commit [d8181a5](https://github.com/mantisbt/mantisbt/commit/d8181a548e5131eede5d3b891bec0df68b472ba9))
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Mar 6, 2021

1 parent
[4aa1c22](/mantisbt/mantisbt/commit/4aa1c22b9412752ac210ee36f23b7872e9f13029)

commit 79a78c0

Showing
**1 changed file**
with
**9 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

9 changes: 9 additions & 0 deletions

9
[core/authentication\_api.php](#diff-7c80b0f77a7edfae64a1d30d5a4a6780656de39493ebbdeb1031eabf6606ffa7 "core/authentication_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/79a78c09d5ef5ce098adc73f6f1416f00fc238a5/core/authentication_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -658,6 +658,15 @@ function auth\_attempt\_script\_login( $p\_username, $p\_password = null ) { |
|  |  | function auth\_logout() { |
|  |  | global $g\_cache\_current\_user\_id, $g\_cache\_cookie\_valid; |
|  |  |  |
|  |  | if( !user\_is\_protected( $g\_cache\_current\_user\_id ) ) { |
|  |  | # Reset the user's cookie string |
|  |  | user\_set\_field( |
|  |  | $g\_cache\_current\_user\_id, |
|  |  | 'cookie\_string', |
|  |  | auth\_generate\_unique\_cookie\_string() |
|  |  | ); |
|  |  | } |
|  |  |  |
|  |  | # clear cached userid |
|  |  | user\_clear\_cache( $g\_cache\_current\_user\_id ); |
|  |  | current\_user\_set( null ); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `79a78c0`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F79a78c09d5ef5ce098adc73f6f1416f00fc238a5) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from mantisbt.org_d1e9ce25_20250125_042125.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview.php%3Fid%3D11296)
[Signup for a new account](/bugs/signup_page.php)

#### View Issue Details

[Wiki](wiki.php?id=11296)[Related Changesets](#changesets)[Jump to Notes](#bugnotes)

|  | | | | | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| --- | --- | --- | --- | --- | --- |
| 0011296 | mantisbt | security | public | 2009-12-21 11:46 | 2024-01-31 05:49 |
|  | | | | | |
|
| Reporter | [Buffer](https://mantisbt.org/bugs/view_user_page.php?id=15920) | Assigned To |  |  | |
| Priority | high | Severity | major | Reproducibility | always |
| Status | acknowledged | Resolution | open |  | |
| Product Version | 1.1.8 |  | | | |
|  | | | | | |
|
| Summary | 0011296: Mantis BT is using fix cookies in the DB | | | | |
| Description | Dear Mantis developers,  During testing Clientless SSL VPN vulnerability, with a malicious webpage to steal cookie through SSL VPN, I found something a little bit bizarre in Mantis BugTracker.  In fact, the cookie for each user is fixed and never changes. As I remember, cookie must change for each server session, and must be unique for each server session.  This is the not the case with your BT application, because cookie is simply fixed and stored in the database. Just for advise, I'm not sure this is the right design, as anyone can steal cookies using XSS or many other attacks' vectors. When the cookie is stolen, even if you click on logout, session never expired.  With Tamper Data or any Firefox plugin, I just logged in as the user I want just by filling HTTP Cookie header with MANTIS\_STRING\_COOKIE right value, for targeted user (and even if the user logout before!). | | | | |
| Steps To Reproduce | * Login as a known user * Copy the MANTIS\_STRING\_COOKIE value available in HTTP Cookie Header, or copy the "cookie\_string" value for the specified user in the SQL table "mantis\_user\_table". * Click logout when viewing my\_view\_page.php (normally at this time, cookie string must be destroyed/changed as the session or any authentication value). * Set the value MANTIS\_STRING\_COOKIE when viewing the login page with the stolen cookie, with TamperData/LiveHeaders or any Firefox plugin to alterate HTTP headers/data. * Now you're login fraudulently without login / password provided ! Moreover, you can change user options, user password or profile, without providing any form of authentication ... just great for hackers ... | | | | |
| Additional Information | Waiting for your update / ack or patch / release information before Full-Disclosure on SecFocus(BugTraq), as it's an important security issue. | | | | |
| Tags | No tags attached. | | | | |
|  | | | | | |
|

#### Relationships

[Relationship Graph](bug_relationship_graph.php?bug_id=11296&graph=relation)[Dependency Graph](bug_relationship_graph.php?bug_id=11296&graph=dependency)

| related to | [0010709](view.php?id=10709) | closed | [dhx](https://mantisbt.org/bugs/view_user_page.php?id=13334) | Use HttpOnly cookie flag to protect cookies from client-side Javascript manipulation/theft |
| --- | --- | --- | --- | --- |
| has duplicate | [0012277](view.php?id=12277) | closed | [dhx](https://mantisbt.org/bugs/view_user_page.php?id=13334) | Cookie tokens are constant for a particular user |
| related to | [0027976](view.php?id=27976) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | CVE-2009-20001: User cookie string is not reset upon logout |
| related to | [0033587](view.php?id=33587) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | "MANTIS\_STRING\_COOKIE" cookie reusable after user logout |

#### Activities

| [Buffer](https://mantisbt.org/bugs/view_user_page.php?id=15920)   [Buffer](https://mantisbt.org/bugs/view_user_page.php?id=15920)  2009-12-26 12:41  reporter    [~0023987](view.php?id=11296#c23987 "Direct link to note")  Last edited: 2009-12-26 12:44 | Any news / ACK to this potential vulnerability ?  If no quick update, will be published next week on SecFocus FD Mailing ... |
| --- | --- |
|  | |
| [vboctor](https://mantisbt.org/bugs/view_user_page.php?id=3081)   [vboctor](https://mantisbt.org/bugs/view_user_page.php?id=3081)  2009-12-27 04:31  manager    [~0023988](view.php?id=11296#c23988 "Direct link to note") | We've done the work to protect the cookie in 1.2.0rc2 (issue [0010709](/bugs/view.php?id=10709 "[closed] Use HttpOnly cookie flag to protect cookies from client-side Javascript manipulation/theft")). We currently change the cookie when the user changes their password. However, we could potentially do that more often, i.e. for each session.  If we do that, we should make sure that a SOAP login doesn't log the user out of a web session.  That would also mean that if a user logs in, the user would be automatically logged out on other browsers / computers. |
|  | |
| [jreese](https://mantisbt.org/bugs/view_user_page.php?id=9562)   [jreese](https://mantisbt.org/bugs/view_user_page.php?id=9562)  2009-12-27 08:27  reporter    [~0023990](view.php?id=11296#c23990 "Direct link to note") | First, there is a user-controlled option already to limit sessions to a single IP address, and is allowed to be disabled by the user in cases where the user is behind a proxy setup with multiple exit points. Secondly, I think the *real* solution is to not store the user's cookie in the database. This is what the user's session ID is for, and I really think Mantis' existing concept of verifying the user's cookie from a value stored in the database is useless and outdated.  The real question is exactly how do we proceed from this point forward? I personally would like to see the current cookie verification routines replaced by special handling in the session API. Thoughts? |
|  | |
| [vboctor](https://mantisbt.org/bugs/view_user_page.php?id=3081)   [vboctor](https://mantisbt.org/bugs/view_user_page.php?id=3081)  2009-12-28 03:19  manager    [~0023993](view.php?id=11296#c23993 "Direct link to note") | [@jreese](https://mantisbt.org/bugs/view_user_page.php?id=9562), I agree with your suggestion and I like the fact that it supports multiple sessions.  However, I like the currently ability for a user to expire all their active sessions independent on the computer / browser by changing their password. The actual change of password doesn't affect the cookie, but at one point I've made this roll a new cookie. This is useful if a user remembers that he/she forgot to logout on some other machine they used.  Hence, I think it would be great if we would be have a solution to support both. But, for simplification, I'm OK with compromising the remote logout feature if necessary. |
|  | |
| [giallu](https://mantisbt.org/bugs/view_user_page.php?id=4599)   [giallu](https://mantisbt.org/bugs/view_user_page.php?id=4599)  2009-12-28 03:51  reporter    [~0023994](view.php?id=11296#c23994 "Direct link to note") | I've just read the Zend\_Session class docs, in particular <http://bit.ly/5m92La> and they suggest regenerating a new session ID at *each* client request with the regenerateId() static method.  I wonder if we could let our MantisSession class derive from Zend\_Session, call regenerateId() early in the page generation and be done with this. |
|  | |
| [vboctor](https://mantisbt.org/bugs/view_user_page.php?id=3081)   [vboctor](https://mantisbt.org/bugs/view_user_page.php?id=3081)  2009-12-28 04:08  manager    [~0023995](view.php?id=11296#c23995 "Direct link to note") | The technique they are using looks good, but I expect that we are looking at fixing this for 1.2.x and maybe 1.1.x and hence we shouldn't be taking a dependency on ZF. |
|  | |
| [dhx](https://mantisbt.org/bugs/view_user_page.php?id=13334)   [dhx](https://mantisbt.org/bugs/view_user_page.php?id=13334)  2009-12-28 07:51  reporter    [~0023999](view.php?id=11296#c23999 "Direct link to note") | One of the problems with using PHP sessions is that the lifetime of the PHP session cookies is (generally) set with a global PHP option. One of the use cases of MantisBT is that someone may leave a message half typed on a Friday afternoon with the expectation that they can finish it off on Monday and submit it. You may have PHP setup differently for another application where you want much shorter session expiry times. I'm fine with requiring them to reauthenticate due to an expired session cookie - as long as the data they're posting isn't lost.  Users may login to the same account simultaneously from different devices (a mobile phone and a desktop computer for example). Therefore we can't just delete a session cookie that may still be in use by another device/login instance. We really need to remember a session key for each session (in the previous example, once for the mobile phone and then again for the desktop computer).  Changing the session ID won't work as giallu suggested because users may open up 10 forms/pages in Mantis and submit them in any random order. We can't assume that users are browsing within their session using a linear one-page-at-a-time approach. Unless of course giallu was just referring to creating a new session key upon a new login, and using this key for all page requests until the user logs out.  PHP's inbuilt session support would be the ideal method to use if we can figure out the maximum session lifetime correctly. In other words, we need to ensure all submitted forms remain intact while re-authentication is occurring.  In the future I'd really like to add user audit logs that are viewable by not only administrators, but the users themselves. This would allow users to see the last 5 times they logged in, where those logins originated from, etc. The users would also be able to view all current sessions they've got open, with the ability to terminate any or all of them. |
|  | |
| [jreese](https://mantisbt.org/bugs/view_user_page.php?id=9562)   [jreese](https://mantisbt.org/bugs/view_user_page.php?id=9562)  2009-12-28 09:25  reporter    [~0024000](view.php?id=11296#c24000 "Direct link to note") | Perhaps we could reuse the existing reauth methods, and combine the existing db-stored cookie with a per-session id. If the user's PHP session get's flushed/expired before submitting a form, we could pop the reauth dialog to make sure the user knows the correct password. This would also solve the underlying security issue, such that when a malicious user starts a new session with someone else's db cookie, it will trigger a reauth rather than simply giving them access.  Thoughts? |
|  | |
| [giallu](https://mantisbt.org/bugs/view_user_page.php?id=4599)   [giallu](https://mantisbt.org/bugs/view_user_page.php?id=4599)  2009-12-28 09:34  reporter    [~0024001](view.php?id=11296#c24001 "Direct link to note") | [@dhx](https://mantisbt.org/bugs/view_user_page.php?id=13334): I'm no expert here, but as I understand it, the approach Zend advocates is something like:   1. login, your browser get a session with a certain ID 2. browse to another page, your browser is given another random ID so it's nearly impossible to spoof it   [@vboctor](https://mantisbt.org/bugs/view_user_page.php?id=3081), 1.1 is tricky but if we think the approach is good and the PHP requirement matches ours I can't see why we shouldn't; I checked and this particular class does not depend on anything else in the ZF.  Alternatively, we could just grab the logic and implement it in our classes. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2020-04-18 12:12  developer    [~0063851](view.php?id=11296#c63851 "Direct link to note") | Community-proposed PR <https://github.com/mantisbt/mantisbt/pull/1653>  As per my [review comment](https://github.com/mantisbt/mantisbt/pull/1653#pullrequestreview-395927110), I think the proposed change is not acceptable as it prevents simultaneous sessions from multiple devices. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2021-02-13 16:01  developer    [~0065103](view.php?id=11296#c65103 "Direct link to note")  Last edited: 2021-02-13 17:28 | Community-proposed solution (source: <https://github.com/mantisbt/mantisbt/pull/1653#issuecomment-707803945>)   ---   Currently, when a user logs into Mantis for the first time, or when the user changes their password, Mantis will generate a unique session key, store it in the database, and then set it as a cookie on the client. This has a few unintended security implications:   1. The session cookie never expires on the server, giving an attacker a theoretically unlimited window in which to steal and take advantage of it. 2. The session cookie only changes when the user’s password changes, which means that if an attacker is able to steal the cookie, they can use it for a very long time.   To fix this, we need a solution that:   1. Allows users to log in from multiple devices simultaneously 2. Assigns a unique session ID to each session 3. Allows session IDs to expire when they reach a certain age and/or a certain period of inactivity  Current design In the Mantis database’s user table, there is a “session\_cookie” column that stores a single, rarely-changing cookie. The database also stores the date and time of the user’s last visit, but there is no way to know when the cookie was first set, or from where the user logged in. Proposed design Create a new table, named “mantis\_session\_table”, containing the following columns:   * User ID * Client IP address (note: may be IPv4 or IPv6) * User agent * Session cookie * Date created * Date last accessed   The user ID, IP address, and user agent will be used to uniquely identify each session, each of which will have a unique, randomly-generated session cookie. The date created and date last accessed will be used to expire session cookies when they become too old and/or when too much time has passed since they were last used.  New options will be added to mantis\_config\_defaults\_inc.php to specify two new settings:   * The maximum age of a session. After this much time has elapsed, the session will be deleted and the user will need to reauthenticate. * Session timeout. If this much time passes without a session being used, the session will be deleted and the user will need to reauthenticate.   Note that it is not necessary to delete sessions immediately when these thresholds are reached. We can wait until the session is next validated, at which point we decide if we continue to use it or delete it. |
|  | |

#### Related Changesets

| MantisBT: master 6f369a5a  2021-02-13 12:33  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=25652) [Diff](https://github.com/mantisbt/mantisbt/commit/6f369a5a98d8d3e3513b3487938581f671d4b4ee) | Reset user session cookie string upon logout | | Affected Issues[0011296](/bugs/view.php?id=11296 "[acknowledged] Mantis BT is using fix cookies in the DB"), [0027976](/bugs/view.php?id=27976 "[closed] CVE-2009-20001: User cookie string is not reset upon logout") |
| --- | --- | --- | --- |
| mod - core/authentication\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/6f369a5a98d8d3e3513b3487938581f671d4b4ee) [File](https://github.com/mantisbt/mantisbt/blob/6f369a5a98d8d3e3513b3487938581f671d4b4ee/core/authentication_api.php) |
| MantisBT: master-2.24 79a78c09  2021-02-24 08:16  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=25658) [Diff](https://github.com/mantisbt/mantisbt/commit/79a78c09d5ef5ce098adc73f6f1416f00fc238a5) | Set a new random cookie string upon logout | | Affected Issues[0011296](/bugs/view.php?id=11296 "[acknowledged] Mantis BT is using fix cookies in the DB"), [0027976](/bugs/view.php?id=27976 "[closed] CVE-2009-20001: User cookie string is not reset upon logout") |
| mod - core/authentication\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/79a78c09d5ef5ce098adc73f6f1416f00fc238a5) [File](https://github.com/mantisbt/mantisbt/blob/79a78c09d5ef5ce098adc73f6f1416f00fc238a5/core/authentication_api.php) |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1759 seconds



=== Content from github.com_4cdef9cb_20250126_055710.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F6f369a5a98d8d3e3513b3487938581f6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F6f369a5a98d8d3e3513b3487938581f6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/6f369a5a98d8d3e3513b3487938581f671d4b4ee)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Reset user session cookie string upon logout

[Browse files](/mantisbt/mantisbt/tree/6f369a5a98d8d3e3513b3487938581f671d4b4ee)
Browse the repository at this point in the history

```
When a user logs out from Mantis, we clear their session cookie string
(i.e. set mantis_user_table.cookie_string column to an empty string).
This ensures that anyone knowing its value is no longer able to login
with it.

On login, after successfully authenticating the user, when setting
the cookies in auth_set_cookies() we check if the cookie_string is
defined in the DB, and if not a new hash is generated and stored.

While not a complete fix for issue #11296, this does improve the
situation by providing an easy and logical means for users to
effectively invalidate all their previous sessions.

Additionally, using an empty value to indicate an invalidated cookie
string instead of directly generating a new hash makes it easy to:
- identify user records which should be considered as logged out
  (e.g. last_visit older than $g_cookie_time_length)
- invalidate login cookies (set them to '')
Leveraging this is left for future improvements.

Note: an empty string in the session cookie always triggers an anonymous
login (or sends the user back to login page if anonymous login is
disabled).

Fixes #27976
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Mar 6, 2021

1 parent
[c2ed5da](/mantisbt/mantisbt/commit/c2ed5da600bc99f6d7489fc98c16d52e17e342f4)

commit 6f369a5

Showing
**1 changed file**
with
**16 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

16 changes: 16 additions & 0 deletions

16
[core/authentication\_api.php](#diff-7c80b0f77a7edfae64a1d30d5a4a6780656de39493ebbdeb1031eabf6606ffa7 "core/authentication_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/6f369a5a98d8d3e3513b3487938581f671d4b4ee/core/authentication_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -658,6 +658,15 @@ function auth\_attempt\_script\_login( $p\_username, $p\_password = null ) { |
|  |  | function auth\_logout() { |
|  |  | global $g\_cache\_current\_user\_id, $g\_cache\_cookie\_valid; |
|  |  |  |
|  |  | if( !user\_is\_protected( $g\_cache\_current\_user\_id ) ) { |
|  |  | # Clear the user's cookie string |
|  |  | user\_set\_field( |
|  |  | $g\_cache\_current\_user\_id, |
|  |  | 'cookie\_string', |
|  |  | '' |
|  |  | ); |
|  |  | } |
|  |  |  |
|  |  | # clear cached userid |
|  |  | user\_clear\_cache( $g\_cache\_current\_user\_id ); |
|  |  | current\_user\_set( null ); |
| Expand Down  Expand Up | | @@ -836,6 +845,13 @@ function auth\_generate\_confirm\_hash( $p\_user\_id ) { |
|  |  | \*/ |
|  |  | function auth\_set\_cookies( $p\_user\_id, $p\_perm\_login = false ) { |
|  |  | $t\_cookie\_string = user\_get\_field( $p\_user\_id, 'cookie\_string' ); |
|  |  |  |
|  |  | # If cookie string is not set in DB, generate a new one |
|  |  | if( !$t\_cookie\_string ) { |
|  |  | $t\_cookie\_string = auth\_generate\_unique\_cookie\_string(); |
|  |  | user\_set\_field( $p\_user\_id, 'cookie\_string', $t\_cookie\_string ); |
|  |  | } |
|  |  |  |
|  |  | $t\_cookie\_name = config\_get\_global( 'string\_cookie' ); |
|  |  | gpc\_set\_cookie( $t\_cookie\_name, $t\_cookie\_string, auth\_session\_expiry( $p\_user\_id, $p\_perm\_login ) ); |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `6f369a5`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F6f369a5a98d8d3e3513b3487938581f6) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


