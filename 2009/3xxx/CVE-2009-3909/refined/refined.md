```
{
  "cve": "CVE-2009-3909",
  "description": "The GIMP (GNU Image Manipulation Program) is an image composition and editing program. Multiple integer overflow flaws, leading to heap-based buffer overflows, were found in the GIMP's Adobe Photoshop (PSD) image file plug-in. An attacker could create a specially-crafted PSD image file that, when opened, could cause the PSD plug-in to crash or, potentially, execute arbitrary code with the privileges of the user running the GIMP.",
  "vulnerability": {
    "root_cause": "Integer overflow in the `read_channel_data()` function within the PSD plugin (psd-load.c), specifically in line 1764 and subsequent calculations in lines 1803, 1808 and 1813. The `layer_size` calculation, `layer_size = lm_w * lm_h`, is also vulnerable to an integer overflow.",
    "weaknesses": [
      "Integer overflow leading to a heap-based buffer overflow."
    ],
    "impact": "A remote attacker could execute arbitrary code with the privileges of the user running GIMP or cause a denial of service (crash).",
    "attack_vector": "By tricking a user into opening a specially crafted PSD file.",
     "required_capabilities": "A remote attacker needs to create a malformed PSD file. No authentication is needed."
  },
    "affected_products": [
    "GIMP versions prior to 2.6.12-r2.",
    "Red Hat Enterprise Linux 5",
    "openSUSE 11.0, 11.1, 11.2",
    "Debian Lenny (0.8.7-3)",
      "SLE10-SP2, SLE10-SP3, SLE11"
  ],
  "patch": "The vulnerability is fixed by adding integer overflow checks using divisions to prevent overflows and adding a few more sanity checks to prevent channel data with ->rows or ->columns equal to 0. A commit on the master branch of GIMP also corrected the signedness of the top/bottom/left/right bbox coordinates in the PSD structs, to be fully effective."
}
```