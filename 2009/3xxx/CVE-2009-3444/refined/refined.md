```
{
  "vulnerability_details": {
    "root_cause": "The application does not properly sanitize the Referer header when sending a news item via email.",
    "weaknesses": [
      "Cross-Site Scripting (XSS)"
    ],
    "impact": "An attacker can inject arbitrary JavaScript code into the page, potentially stealing cookies or performing other malicious actions on behalf of the victim.",
     "attack_vectors": [
      "The attacker can send a crafted HTTP request with a malicious Referer header to the `email.php` script, specifically when sending a news item.",
      "The crafted Referer header can be sent via a Flash object."
    ],
    "attacker_capabilities": "The attacker needs to be able to send HTTP requests with a custom Referer header or use Flash to inject the header. No specific position is required, but a user interaction with the vulnerable e107 installation is necessary for the code to be executed.",
    "affected_versions": "E107 version 0.7.16 and earlier are vulnerable."
  }
}
```