```
{
  "CVE-2009-3604": {
    "Description": "Multiple integer overflow flaws were found in KPDF. An attacker could create a malicious PDF file that would cause KPDF to crash or, potentially, execute arbitrary code when opened.",
    "Root cause": "The vulnerability stems from an integer overflow and a missing allocation return value check within the `Splash::drawImage` function of xpdf/poppler. Specifically, the size calculations for memory allocations related to image processing were susceptible to integer overflows due to values derived from a potentially malicious PDF file. When a crafted PDF file containing large values for image dimensions is processed, the calculated size for memory allocation can overflow, resulting in an allocation of insufficient memory. Subsequent operations attempt to use the underallocated buffer as if it were properly sized, which can result in a heap-based buffer overflow or a null pointer dereference if `gmalloc` returns NULL. The use of `gmalloc` instead of `gmallocn` further contributes to this, as `gmallocn` provides built-in protection against integer overflow issues by checking that the product of the multiplied arguments won't overflow.",
    "Weaknesses": [
      "Integer overflow vulnerability.",
      "Missing allocation size check.",
      "Missing allocation return value check.",
	  "Use of gmalloc which does not protect against integer overflows"
    ],
    "Impact": "Successful exploitation of the integer overflow can lead to several critical impacts. The application may crash due to a NULL pointer dereference or heap buffer overflow, leading to a denial of service. Furthermore, the heap buffer overflow can potentially allow the attacker to execute arbitrary code with the privileges of the user opening the malicious PDF file.",
    "Attack vectors": "The attack vector involves a specially crafted malicious PDF document. The attacker manipulates image dimensions and other related parameters within the PDF to cause the integer overflow and consequent buffer overflow or NULL pointer dereference.",
    "Required attacker capabilities": "The attacker must be able to create a specially crafted PDF file and trick the victim into opening it. No special privileges are required on the target system. The attacker needs to understand the way xpdf/poppler parses and process images in PDF files to craft such a malicious document."
  }
}
```