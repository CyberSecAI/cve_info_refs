This document describes multiple cross-site scripting (XSS) vulnerabilities affecting various browsers when handling redirects, specifically through the `javascript:` and `data:` URI schemes. The core issue stems from browsers not properly sanitizing or handling these URI schemes within redirect contexts.

**Root Cause of Vulnerability:**

The root cause of these vulnerabilities lies in the way different browsers interpret and execute JavaScript code embedded within `javascript:` and `data:` URIs when encountered through HTTP redirects (both `Location` and `Refresh` headers). Instead of treating the redirects as a navigation to a new page, some browsers execute the JavaScript code embedded in the URI.

**Weaknesses/Vulnerabilities Present:**

*   **Improper handling of `javascript:` URIs:** Some browsers, when encountering a `javascript:` URI in a `Location` or `Refresh` header, directly execute the JavaScript code, leading to XSS.
*   **Improper handling of `data:` URIs:** Similarly, some browsers execute HTML/JavaScript code embedded within a `data:` URI in redirect headers.
*   **Inconsistent Context Handling:** Some browsers execute JavaScript within the context of the vulnerable site, allowing access to cookies and other sensitive data, while others execute it in a different context, limiting the impact to phishing and JavaScript code execution.
*   **Social Engineering:** The vulnerabilities also involve some social engineering, where users have to click on a link to trigger the execution of the Javascript code, such as a link on a "Object Moved" page

**Impact of Exploitation:**

*   **Cookie Theft:** If JavaScript executes within the site's context, attackers can steal cookies.
*   **Phishing Attacks:** Attackers can display fake login forms or other misleading content by injecting arbitrary HTML.
*   **Malware Distribution:** Attackers can redirect users to sites hosting malware or execute malware through JavaScript code.
*   **Arbitrary JavaScript Execution:** Attackers can execute arbitrary JavaScript code in the user's browser.
*   **Bypass of filters:** Attackers can bypass anti-phishing and anti-malware filters because of the use of `data:` URIs.
*   **Strictly Social XSS:** Some vulnerabilities require the user to click on a link to trigger code execution

**Attack Vectors:**

*   **Manipulated Redirectors:** An attacker crafts a request to a redirector script on a website, injecting a malicious `javascript:` or `data:` URI into the `param` variable, which will then be used to generate the `Location` or `Refresh` header.

**Required Attacker Capabilities/Position:**

*   **Ability to inject URLs into redirectors:** The attacker must be able to inject their crafted `javascript:` or `data:` URI into the redirector script's parameter.
*   **User Interaction:** For some attack vectors, user interaction is required, such as clicking on a link on a "Object moved" or a "Unable to connect to the site" page.

**Specific Attacks Described:**

*   **Attack #1:** XSS via `refresh-header` redirectors using `javascript:` URIs. (Mozilla 1.7.x, Firefox <= 3.0.8, IE6, Opera <= 9.52, Chrome <= 1.0.154.48)
*   **Attack #2:** XSS via `refresh-header` redirectors using `data:` URIs. (Mozilla 1.7.x, Firefox <= 3.0.12, Chrome <= 1.0.154.48)
*   **Attack #3:** XSS via `location-header` redirectors using `data:` URIs. (Firefox <= 3.0.12, Opera <= 9.52)
*  **Attack #4:** XSS via `location-header` redirectors using `javascript:` URI and `302 Object moved` response. (Mozilla 1.7.x, Firefox <= 3.0.12)
*   **Attack #5:** XSS via `location-header` redirectors using `javascript:` URI with `301` and `302` responses in Maxthon 3 Alpha with Ultramode
*   **Attack #6:** XSS via `location-header` redirectors using `javascript:` URI and `302 Found` response. (Mozilla 1.7.x, Firefox <= 3.0.19)
*   **Attack #7 & 8:** XSS via `location-header` redirectors using `data:` and `javascript:` URIs with `301` and `303` responses.

**Additional Information:**

*   The article mentions specific browser versions that are vulnerable and includes updates with additional vulnerable browsers.
*   The author notes that `location-header` redirects are more widespread than `refresh-header` redirects and therefore pose a greater risk.
*   The author stresses the difficulty in tracing such attacks since the attack vector does not rely on a malicious website and also bypasses common anti-phishing/anti-malware filters.
*  The article was updated multiple times with new information about vulnerable browsers and attack vectors.

This content provides more detailed information than would typically be found in a standard CVE description, detailing the various attack vectors and vulnerable browser versions.