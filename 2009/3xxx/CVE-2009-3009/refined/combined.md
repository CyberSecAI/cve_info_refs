=== Content from lists.opensuse.org_58f6f19c_20250124_120217.html ===


[![openSUSE](https://static.opensuse.org/favicon.svg)
Mailing Lists](/archives/ "openSUSE Mailing Lists")

[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/WLEQAE5ZU7UH4KZNKCUCE2NOQYOZK7SM/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/WLEQAE5ZU7UH4KZNKCUCE2NOQYOZK7SM/)

[Manage this list](/manage/lists/security-announce.lists.opensuse.org/)
[Sign In](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/WLEQAE5ZU7UH4KZNKCUCE2NOQYOZK7SM/)
[Sign Up](/accounts/signup/?next=/archives/list/security-announce%40lists.opensuse.org/message/WLEQAE5ZU7UH4KZNKCUCE2NOQYOZK7SM/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

[thread](/archives/list/security-announce%40lists.opensuse.org/thread/WLEQAE5ZU7UH4KZNKCUCE2NOQYOZK7SM/#WLEQAE5ZU7UH4KZNKCUCE2NOQYOZK7SM)

# [security-announce] SUSE Security Summary Report: SUSE-SR:2009:017

![](https://seccdn.libravatar.org/avatar/f9fb86af86ef66b34b610f49ebc61f39.jpg?s=120&d=mm&r=g)
## [Ludwig Nussel](/archives/users/f83f7752aa2e4583bb45e373b99f41c3/ "See the profile for Ludwig Nussel")

26 Oct
2009

26 Oct
'09

12:18

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
SUSE Security Summary Report
Announcement ID: SUSE-SR:2009:017
Date: Mon, 26 Oct 2009 12:00:00 +0000
Cross-References: CVE-2008-5349, CVE-2009-2625, CVE-2009-2687
CVE-2009-2813, CVE-2009-2905, CVE-2009-2906
CVE-2009-2948, CVE-2009-3009, CVE-2009-3086
CVE-2009-3229, CVE-2009-3230, CVE-2009-3231
CVE-2009-3291, CVE-2009-3292, CVE-2009-3293
CVE-2009-3618, CVE-2009-3619, CVE-2009-3696
CVE-2009-3697
Content of this advisory:
1) Solved Security Vulnerabilities:
- php5
- newt
- rubygem-actionpack
- rubygem-activesupport
- java-1\_4\_2-ibm
- postgresql
- samba
- phpMyAdmin
- viewvc
2) Pending Vulnerabilities, Solutions, and Work-Arounds:
none
3) Authenticity Verification and Additional Information
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
1) Solved Security Vulnerabilities
To avoid flooding mailing lists with SUSE Security Announcements for minor
issues, SUSE Security releases weekly summary reports for the low profile
vulnerability fixes. The SUSE Security Summary Reports do not list or
download URLs like the SUSE Security Announcements that are released for
more severe vulnerabilities.
Fixed packages for the following incidents are already available on our FTP
server and via the YaST Online Update.
- php5
php5 has been updated to fix problems with SSL certificate
validation and overflows in the exif and gd modules
(CVE-2009-3291,CVE-2009-3292, CVE-2009-3293, CVE-2009-2687).
Affected Products: SLE10-SP2, SLE10-SP3, SLE11, openSUSE 10.3-11.1
- newt
A heap-based buffer overflow was found in the way newt used to process
content, to be rendered in text dialog box. Local attacker could issue
a specially-crafted text dialog box rendering request (direct or via
custom application), leading to denial of service (application crash)
or, potentially, to execution of arbitrary code with the privileges of
the user running the application (CVE-2009-2905).
Affected Products: SLE10-SP3, SLE11, openSUSE 10.3-11.1
- rubygem-actionpack
This update improves the escaping in the helper code of Ruby on
Rails to protect against XSS attacks (CVE-2009-3009) and an
information leak (CVE-2009-3086).
Affected Products: SLE11, openSUSE 11.1
- rubygem-activesupport
This update improves the escaping in the helper code of Ruby on
Rails to protect against XSS attacks (CVE-2009-3009) and an
information leak (CVE-2009-3086).
Affected Products: SLE11, openSUSE 11.1
- java-1\_4\_2-ibm
IBM Java 1.4.2 was updated to SR13 FP1.
It fixes following two security issues:
CVE-2009-2625: A vulnerability in the Java Runtime Environment (JRE)
with parsing XML data might allow a remote client to create a
denial-of-service condition on the system that the JRE runs on.
CVE-2008-5349: A vulnerability in how the Java Runtime Environment
(JRE) handles certain RSA public keys might cause the JRE to consume
an excessive amount of CPU resources. This might lead to a Denial of
Service (DoS) condition on affected systems. Such keys could be
provided by a remote client of an application.
This issue affects the following security providers:
IBMJCE, IBMPKCS11Impl and IBMJCEFIPS.
Affected Products: SLES9, SLE10-SP2, SLE10-SP3, SLE11
- postgresql
Multiple security vulnerabilities have been fixed in PostgrSQL
- CVE-2009-3229: allows remote authenticated users to cause a denial
of service
- CVE-2009-3230: allows remote authenticated users to gain higher
privileges
- CVE-2009-3231: when using LDAP authentication with anonymous
binds, allows remote attackers to bypass authentication via an
empty password
Affected Products: SLES9, SLE10-SP2, SLE10-SP3, SLE11, openSUSE 10.3-11.1
- samba
samba's make\_connection\_snum() handles certain input incorrectly,
which may lead to disclosure of the root directory (CVE-2009-2813).
Additionally an information disclosure vulnerability in mount.cifs
has been fixed (CVE-2009-2948) as well as a DoS condition
(CVE-2009-2906).
Affected Products: SLES9, SLE10-SP2, SLE10-SP3, SLE11, openSUSE 10.3-11.1
- phpMyAdmin
phpMyAdmin has been updated to version 2.11.9.6 to fix a cross-site
scripting (XSS) issue (CVE-2009-3696) and an SQL injection
vulnerability (CVE-2009-3697).
Affected Products: openSUSE 10.3, openSUSE 11.0
- viewvc
Update of viewvc to version 1.0.9 fixes a cross-site scripting (XSS)
problem and enhances filtering of illegal characters when displaying
error messages (CVE-2009-3618, CVE-2009-3619).
Affected Products: openSUSE 10.3-11.1
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
2) Pending Vulnerabilities, Solutions, and Work-Arounds
none
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
3) Authenticity Verification and Additional Information
- Announcement authenticity verification:
SUSE security announcements are published via mailing lists and on Web
sites. The authenticity and integrity of a SUSE security announcement is
guaranteed by a cryptographic signature in each announcement. All SUSE
security announcements are published with a valid signature.
To verify the signature of the announcement, save it as text into a file
and run the command
gpg --verify <file>
replacing <file> with the name of the file containing the announcement.
The output for a valid signature looks like:
gpg: Signature made <DATE> using RSA key ID 3D25D3D9
gpg: Good signature from "SuSE Security Team <security@suse.de>"
where <DATE> is replaced by the date the document was signed.
If the security team's key is not contained in your key ring, you can
import it from the first installation CD. To import the key, use the
command
gpg --import gpg-pubkey-3d25d3d9-36e12d04.asc
- Package authenticity verification:
SUSE update packages are available on many mirror FTP servers all over the
world. While this service is considered valuable and important to the free
and open source software community, the authenticity and integrity of a
package needs to be verified to ensure that it has not been tampered with.
The internal RPM package signatures provide an easy way to verify the
authenticity of an RPM package. Use the command
rpm -v --checksig <file.rpm>
to verify the signature of the package, replacing <file.rpm> with the
filename of the RPM package downloaded. The package is unmodified if it
contains a valid signature from build@suse.de with the key ID 9C800ACA.
This key is automatically imported into the RPM database (on RPMv4-based
distributions) and the gpg key ring of 'root' during installation. You can
also find it on the first installation CD and included at the end of this
announcement.
- SUSE runs two security mailing lists to which any interested party may
subscribe:
opensuse-security@opensuse.org
- General Linux and SUSE security discussion.
All SUSE security announcements are sent to this list.
To subscribe, send an e-mail to
<opensuse-security+subscribe@opensuse.org>.
opensuse-security-announce@opensuse.org
- SUSE's announce-only mailing list.
Only SUSE's security announcements are sent to this list.
To subscribe, send an e-mail to
<opensuse-security-announce+subscribe@opensuse.org>.
=====================================================================
SUSE's security contact is <security@suse.com> or <security@suse.de>.
The <security@suse.de> public key is listed below.
=====================================================================
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
The information in this advisory may be distributed or reproduced,
provided that the advisory is not modified in any way. In particular, the
clear text signature should show proof of the authenticity of the text.
SUSE Linux Products GmbH provides no warranties of any kind whatsoever
with respect to the information contained in this security advisory.
Type Bits/KeyID Date User ID
pub 2048R/3D25D3D9 1999-03-06 SuSE Security Team <security@suse.de>
pub 1024D/9C800ACA 2000-10-19 SuSE Package Signing Key <build@suse.de>
- -----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1.4.2 (GNU/Linux)
mQENAzbhLQQAAAEIAKAkXHe0lWRBXLpn38hMHy03F0I4Sszmoc8aaKJrhfhyMlOA
BqvklPLE2f9UrI4Xc860gH79ZREwAgPt0pi6+SleNFLNcNFAuuHMLQOOsaMFatbz
JR9i4m/lf6q929YROu5zB48rBAlcfTm+IBbijaEdnqpwGib45wE/Cfy6FAttBHQh
1Kp+r/jPbf1mYAvljUfHKuvbg8t2EIQz/5yGp+n5trn9pElfQO2cRBq8LFpf1l+U
P7EKjFmlOq+Gs/fF98/dP3DfniSd78LQPq5vp8RL8nr/o2i7jkAQ33m4f1wOBWd+
cZovrKXYlXiR+Bf7m2hpZo+/sAzhd7LmAD0l09kABRG0JVN1U0UgU2VjdXJpdHkg
VGVhbSA8c2VjdXJpdHlAc3VzZS5kZT6JARUDBRA24S1H5Fiyh7HKPEUBAVcOB/9b
yHYji1/+4Xc2GhvXK0FSJN0MGgeXgW47yxDL7gmR4mNgjlIOUHZj0PEpVjWepOJ7
tQS3L9oP6cpj1Fj/XxuLbkp5VCQ61hpt54coQAvYrnT9rtWEGN+xmwejT1WmYmDJ
xG+EGBXKr+XP69oIUl1E2JO3rXeklulgjqRKos4cdXKgyjWZ7CP9V9daRXDtje63
Om8gwSdU/nCvhdRIWp/Vwbf7Ia8iZr9OJ5YuQl0DBG4qmGDDrvImgPAFkYFzwlqo
choXFQ9y0YVCV41DnR+GYhwl2qBd81T8aXhihEGPIgaw3g8gd8B5o6mPVgl+nJqI
BkEYGBusiag2pS6qwznZiQEVAwUQNuEtBHey5gA9JdPZAQFtOAf+KVh939b0J94u
v/kpg4xs1LthlhquhbHcKNoVTNspugiC3qMPyvSX4XcBr2PC0cVkS4Z9PY9iCfT+
x9WM96g39dAF+le2CCx7XISk9XXJ4ApEy5g4AuK7NYgAJd39PPbERgWnxjxir9g0
Ix30dS30bW39D+3NPU5Ho9TD/B7UDFvYT5AWHl3MGwo3a1RhTs6sfgL7yQ3U+mvq
MkTExZb5mfN1FeaYKMopoI4VpzNVeGxQWIz67VjJHVyUlF20ekOz4kWVgsxkc8G2
saqZd6yv2EwqYTi8BDAduweP33KrQc4KDDommQNDOXxaKOeCoESIdM4p7Esdjq1o
L0oixF12CohGBBARAgAGBQI7HmHDAAoJEJ5A4xAACqukTlQAoI4QzP9yjPohY7OU
F7J3eKBTzp25AJ42BmtSd3pvm5ldmognWF3Trhp+GYkAlQMFEDe3O8IWkDf+zvyS
FQEBAfkD/3GG5UgJj18UhYmh1gfjIlDcPAeqMwSytEHDENmHC+vlZQ/p0mT9tPiW
tp34io54mwr+bLPN8l6B5GJNkbGvH6M+mO7R8Lj4nHL6pyAv3PQr83WyLHcaX7It
Klj371/4yzKV6qpz43SGRK4MacLo2rNZ/dNej7lwPCtzCcFYwqkiiEYEEBECAAYF
AjoaQqQACgkQx1KqMrDf94ArewCfWnTUDG5gNYkmHG4bYL8fQcizyA4An2eVo/n+
3J2KRWSOhpAMsnMxtPbBmQGiBDnu9IERBACT8Y35+2vv4MGVKiLEMOl9GdST6MCk
YS3yEKeueNWc+z/0Kvff4JctBsgs47tjmiI9sl0eHjm3gTR8rItXMN6sJEUHWzDP
+Y0PFPboMvKx0FXl/A0dM+HFrruCgBlWt6FA+okRySQiliuI5phwqkXefl9AhkwR
8xocQSVCFxcwvwCglVcOQliHu8jwRQHxlRE0tkwQQI0D+wfQwKdvhDplxHJ5nf7U
8c/yE/vdvpN6lF0tmFrKXBUX+K7u4ifrZlQvj/81M4INjtXreqDiJtr99Rs6xa0S
cZqITuZC4CWxJa9GynBED3+D2t1V/f8l0smsuYoFOF7Ib49IkTdbtwAThlZp8bEh
ELBeGaPdNCcmfZ66rKUdG5sRA/9ovnc1krSQF2+sqB9/o7w5/q2qiyzwOSTnkjtB
UVKn4zLUOf6aeBAoV6NMCC3Kj9aZHfA+ND0ehPaVGJgjaVNFhPi4x0e7BULdvgOo
AqajLfvkURHAeSsxXIoEmyW/xC1sBbDkDUIBSx5oej73XCZgnj/inphRqGpsb+1n
KFvF+rQoU3VTRSBQYWNrYWdlIFNpZ25pbmcgS2V5IDxidWlsZEBzdXNlLmRlPohi
BBMRAgAiBQJA2AY+AhsDBQkObd+9BAsHAwIDFQIDAxYCAQIeAQIXgAAKCRCoTtro
nIAKypCfAJ9RuZ6ZSV7QW4pTgTIxQ+ABPp0sIwCffG9bCNnrETPlgOn+dGEkAWeg
KL+IRgQQEQIABgUCOnBeUgAKCRCeQOMQAAqrpNzOAKCL512FZvv4VZx94TpbA9lx
yoAejACeOO1HIbActAevk5MUBhNeLZa/qM2JARUDBRA6cGBvd7LmAD0l09kBATWn
B/9An5vfiUUE1VQnt+T/EYklES3tXXaJJp9pHMa4fzFa8jPVtv5UBHGee3XoUNDV
wM2OgSEISZxbzdXGnqIlcT08TzBUD9i579uifklLsnr35SJDZ6ram51/CWOnnaVh
UzneOA9gTPSr+/fT3WeVnwJiQCQ30kNLWVXWATMnsnT486eAOlT6UNBPYQLpUprF
5Yryk23pQUPAgJENDEqeU6iIO9Ot1ZPtB0lniw+/xCi13D360o1tZDYOp0hHHJN3
D3EN8C1yPqZd5CvvznYvB6bWBIpWcRgdn2DUVMmpU661jwqGlRz1F84JG/xe4jGu
zgpJt9IXSzyohEJB6XG5+D0BuQINBDnu9JIQCACEkdBN6Mxf5WvqDWkcMRy6wnrd
9DYJ8UUTmIT2iQf07tRUKJJ9v0JXfx2Z4d08IQSMNRaq4VgSe+PdYgIy0fbj23Vi
a5/gO7fJEpD2hd2f+pMnOWvH2rOOIbeYfuhzAc6BQjAKtmgR0ERUTafTM9Wb6F13
CNZZNZfDqnFDP6L12w3z3F7FFXkz07Rs3AIto1ZfYZd4sCSpMr/0S5nLrHbIvGLp
271hhQBeRmmoGEKO2JRelGgUJ2CUzOdtwDIKT0LbCpvaP8PVnYF5IFoYJIWRHqlE
t5ucTXstZy7vYjL6vTP4l5xs+LIOkNmPhqmfsgLzVo0UaLt80hOwc4NvDCOLAAMG
B/9g+9V3ORzw4LvO1pwRYJqfDKUq/EJ0rNMMD4N8RLpZRhKHKJUm9nNHLbksnlZw
rbSTM5LpC/U6sheLP+l0bLVoq0lmsCcUSyh+mY6PxWirLIWCn/IAZAGnXb6Zd6Tt
IJlGG6pqUN8QxGJYQnonl0uTJKHJENbI9sWHQdcTtBMc34gorHFCo1Bcvpnc1LFL
rWn7mfoGx6INQjf3HGQpMXAWuSBQhzkazY6vaWFpa8bBJ+gKbBuySWzNm3rFtT5H
RKMWpO+M9bHp4d+puY0L1YwN1OMatcMMpcWnZpiWiR83oi32+xtWUY2U7Ae38mMa
g8zFbpeqPQUsDv9V7CAJ1dbriEwEGBECAAwFAkDYBnoFCQ5t3+gACgkQqE7a6JyA
CspnpgCfRbYwxT3iq+9l/PgNTUNTZOlof2oAn25y0eGi0371jap9kOV6uq71sUuO
=ypVs
- -----END PGP PUBLIC KEY BLOCK-----
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.12 (GNU/Linux)
iQEVAwUBSuWAQney5gA9JdPZAQLTvwf/YvN6uqKVFhg6zH3dMwe1ruhg9hcmT8j1
KvGkHuE7zo7KfJ/Hohub0ZE68dMhfbJd8qv7oRXzG6Lo74Z/5q0OtAT0RFozgEAS
nFElPSH4cqRtIrcGUy+utIqxI3DWp6yl3PX0iZzAf9ohkBQJbf8kyHV4koeXEC4w
16Th5btNCtSXkmVGPGnPq20+idL8VH4g/KEMnUifZol4jPrBuHQOCnbJ6F/eujlB
mZuePowvWCX1ojFw/c5TON3gGwXQJXDn1nMqOaokr8wBo/hINTyrD86oUun9oFxl
mAdUOsT/PDvZPh4uc5CtY6/uoYjwsIu/arKBiTn4ocq7UVzQQHaigg==
=4HGt
-----END PGP SIGNATURE-----
--
To unsubscribe, e-mail: opensuse-security-announce+unsubscribe@opensuse.org
For additional commands, e-mail: opensuse-security-announce+help@opensuse.org

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Sign in to reply online](/accounts/login/?next=/archives/list/security-announce%40lists.opensuse.org/message/WLEQAE5ZU7UH4KZNKCUCE2NOQYOZK7SM/)
Use email software

[Back to the thread](/archives/list/security-announce%40lists.opensuse.org/thread/WLEQAE5ZU7UH4KZNKCUCE2NOQYOZK7SM/#WLEQAE5ZU7UH4KZNKCUCE2NOQYOZK7SM)

[Back to the list](/archives/list/security-announce%40lists.opensuse.org/)

![HyperKitty](/static/hyperkitty/img/logo.png)
Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.12.



=== Content from secunia.com_423a57a5_20250124_120218.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from www.vupen.com_9cfd9bd4_20250124_120220.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from groups.google.com_ee04f01f_20250126_005910.html ===
>From e3db21fe4f54539be7fc212167553665970a955f Mon Sep 17 00:00:00 2001
From: Manfred Stienstra
Date: Tue, 1 Sep 2009 20:16:11 +0200
Subject: [PATCH] Add methods for string verification and encoding cleanup code.
Signed-off-by: Michael Koziarski
---
activesupport/lib/active\_support/multibyte.rb | 18 ++++
.../multibyte/handlers/utf8\_handler.rb | 13 +--
.../lib/active\_support/multibyte/utils.rb | 39 +++++++
activesupport/test/multibyte\_utils\_test.rb | 106 ++++++++++++++++++++
4 files changed, 165 insertions(+), 11 deletions(-)
create mode 100644 activesupport/lib/active\_support/multibyte/utils.rb
create mode 100644 activesupport/test/multibyte\_utils\_test.rb
diff --git a/activesupport/lib/active\_support/multibyte.rb b/activesupport/lib/active\_support/multibyte.rb
index 27c0d18..f76cfba 100644
--- a/activesupport/lib/active\_support/multibyte.rb
+++ b/activesupport/lib/active\_support/multibyte.rb
@@ -3,7 +3,25 @@ module ActiveSupport
DEFAULT\_NORMALIZATION\_FORM = :kc
NORMALIZATIONS\_FORMS = [:c, :kc, :d, :kd]
UNICODE\_VERSION = '5.0.0'
+
+ # Regular expressions that describe valid byte sequences for a character
+ VALID\_CHARACTER = {
+ # Borrowed from the Kconv library by Shinji KONO - (also as seen on the W3C site)
+ 'UTF-8' => /\A(?:
+ [\x00-\x7f] |
+ [\xc2-\xdf] [\x80-\xbf] |
+ \xe0 [\xa0-\xbf] [\x80-\xbf] |
+ [\xe1-\xef] [\x80-\xbf] [\x80-\xbf] |
+ \xf0 [\x90-\xbf] [\x80-\xbf] [\x80-\xbf] |
+ [\xf1-\xf3] [\x80-\xbf] [\x80-\xbf] [\x80-\xbf] |
+ \xf4 [\x80-\x8f] [\x80-\xbf] [\x80-\xbf])\z /xn,
+ # Quick check for valid Shift-JIS characters, disregards the odd-even pairing
+ 'Shift\_JIS' => /\A(?:
+ [\x00-\x7e \xa1-\xdf] |
+ [\x81-\x9f \xe0-\xef] [\x40-\x7e \x80-\x9e \x9f-\xfc])\z /xn
+ }
end
end
require 'active\_support/multibyte/chars'
+require 'active\_support/multibyte/utils'
\ No newline at end of file
diff --git a/activesupport/lib/active\_support/multibyte/handlers/utf8\_handler.rb b/activesupport/lib/active\_support/multibyte/handlers/utf8\_handler.rb
index aa9c16f..2bbb2fa 100644
--- a/activesupport/lib/active\_support/multibyte/handlers/utf8\_handler.rb
+++ b/activesupport/lib/active\_support/multibyte/handlers/utf8\_handler.rb
@@ -100,16 +100,7 @@ module ActiveSupport::Multibyte::Handlers #:nodoc:
# between little and big endian. This is not an issue in utf-8, so it must be ignored.
UNICODE\_LEADERS\_AND\_TRAILERS = UNICODE\_WHITESPACE + [65279] # ZERO-WIDTH NO-BREAK SPACE aka BOM
- # Borrowed from the Kconv library by Shinji KONO - (also as seen on the W3C site)
- UTF8\_PAT = /\A(?:
- [\x00-\x7f] |
- [\xc2-\xdf] [\x80-\xbf] |
- \xe0 [\xa0-\xbf] [\x80-\xbf] |
- [\xe1-\xef] [\x80-\xbf] [\x80-\xbf] |
- \xf0 [\x90-\xbf] [\x80-\xbf] [\x80-\xbf] |
- [\xf1-\xf3] [\x80-\xbf] [\x80-\xbf] [\x80-\xbf] |
- \xf4 [\x80-\x8f] [\x80-\xbf] [\x80-\xbf]
- )\*\z/xn
+ UTF8\_PAT = ActiveSupport::Multibyte::VALID\_CHARACTER['UTF-8']
# Returns a regular expression pattern that matches the passed Unicode codepoints
def self.codepoints\_to\_pattern(array\_of\_codepoints) #:nodoc:
@@ -357,7 +348,7 @@ module ActiveSupport::Multibyte::Handlers #:nodoc:
# Replaces all the non-utf-8 bytes by their iso-8859-1 or cp1252 equivalent resulting in a valid utf-8 string
def tidy\_bytes(str)
str.split(//u).map do |c|
- if !UTF8\_PAT.match(c)
+ if !ActiveSupport::Multibyte::VALID\_CHARACTER['UTF-8'].match(c)
n = c.unpack('C')[0]
n < 128 ? n.chr :
n < 160 ? [UCD.cp1252[n] || n].pack('U') :
diff --git a/activesupport/lib/active\_support/multibyte/utils.rb b/activesupport/lib/active\_support/multibyte/utils.rb
new file mode 100644
index 0000000..094e856
--- /dev/null
+++ b/activesupport/lib/active\_support/multibyte/utils.rb
@@ -0,0 +1,39 @@
+module ActiveSupport #:nodoc:
+ module Multibyte #:nodoc:
+ # Returns a regular expression that matches valid characters in the current encoding
+ def self.valid\_character
+ case $KCODE
+ when 'UTF8'
+ VALID\_CHARACTER['UTF-8']
+ when 'SJIS'
+ VALID\_CHARACTER['Shift\_JIS']
+ end
+ end
+
+ # Verifies the encoding of a string
+ def self.verify(string)
+ if expression = valid\_character
+ for c in string.split(//)
+ return false unless valid\_character.match(c)
+ end
+ end
+ true
+ end
+
+ # Verifies the encoding of the string and raises an exception when it's not valid
+ def self.verify!(string)
+ raise ActiveSupport::Multibyte::Handlers::EncodingError.new("Found characters with invalid encoding") unless verify(string)
+ end
+
+ # Removes all invalid characters from the string
+ def self.clean(string)
+ if expression = valid\_character
+ stripped = []; for c in string.split(//)
+ stripped << c if valid\_character.match(c)
+ end; stripped.join
+ else
+ string
+ end
+ end
+ end
+end
\ No newline at end of file
diff --git a/activesupport/test/multibyte\_utils\_test.rb b/activesupport/test/multibyte\_utils\_test.rb
new file mode 100644
index 0000000..a4bcfc8
--- /dev/null
+++ b/activesupport/test/multibyte\_utils\_test.rb
@@ -0,0 +1,106 @@
+require 'abstract\_unit'
+
+class MultibyteUtilsTest < Test::Unit::TestCase
+
+ def test\_valid\_character\_returns\_an\_expression\_for\_the\_current\_encoding
+ with\_kcode('None') do
+ assert\_nil ActiveSupport::Multibyte.valid\_character
+ end
+ with\_kcode('UTF8') do
+ assert\_equal ActiveSupport::Multibyte::VALID\_CHARACTER['UTF-8'], ActiveSupport::Multibyte.valid\_character
+ end
+ with\_kcode('SJIS') do
+ assert\_equal ActiveSupport::Multibyte::VALID\_CHARACTER['Shift\_JIS'], ActiveSupport::Multibyte.valid\_character
+ end
+ end
+
+ def test\_verify\_verifies\_ASCII\_strings\_are\_properly\_encoded
+ with\_kcode('None') do
+ examples.each do |example|
+ assert ActiveSupport::Multibyte.verify(example)
+ end
+ end
+ end
+
+ def test\_verify\_verifies\_UTF\_8\_strings\_are\_properly\_encoded
+ with\_kcode('UTF8') do
+ assert ActiveSupport::Multibyte.verify(example('valid UTF-8'))
+ assert !ActiveSupport::Multibyte.verify(example('invalid UTF-8'))
+ end
+ end
+
+ def test\_verify\_verifies\_Shift\_JIS\_strings\_are\_properly\_encoded
+ with\_kcode('SJIS') do
+ assert ActiveSupport::Multibyte.verify(example('valid Shift-JIS'))
+ assert !ActiveSupport::Multibyte.verify(example('invalid Shift-JIS'))
+ end
+ end
+
+ def test\_verify\_bang\_raises\_an\_exception\_when\_it\_finds\_an\_invalid\_character
+ with\_kcode('UTF8') do
+ assert\_raises(ActiveSupport::Multibyte::Handlers::EncodingError) do
+ ActiveSupport::Multibyte.verify!(example('invalid UTF-8'))
+ end
+ end
+ end
+
+ def test\_verify\_bang\_doesnt\_raise\_an\_exception\_when\_the\_encoding\_is\_valid
+ with\_kcode('UTF8') do
+ assert\_nothing\_raised do
+ ActiveSupport::Multibyte.verify!(example('valid UTF-8'))
+ end
+ end
+ end
+
+ def test\_clean\_leaves\_ASCII\_strings\_intact
+ with\_kcode('None') do
+ [
+ 'word', "\270\236\010\210\245"
+ ].each do |string|
+ assert\_equal string, ActiveSupport::Multibyte.clean(string)
+ end
+ end
+ end
+
+ def test\_clean\_cleans\_invalid\_characters\_from\_UTF\_8\_encoded\_strings
+ with\_kcode('UTF8') do
+ cleaned\_utf8 = [8].pack('C\*')
+ assert\_equal example('valid UTF-8'), ActiveSupport::Multibyte.clean(example('valid UTF-8'))
+ assert\_equal cleaned\_utf8, ActiveSupport::Multibyte.clean(example('invalid UTF-8'))
+ end
+ end
+
+ def test\_clean\_cleans\_invalid\_characters\_from\_Shift\_JIS\_encoded\_strings
+ with\_kcode('SJIS') do
+ cleaned\_sjis = [184, 0, 136, 165].pack('C\*')
+ assert\_equal example('valid Shift-JIS'), ActiveSupport::Multibyte.clean(example('valid Shift-JIS'))
+ assert\_equal cleaned\_sjis, ActiveSupport::Multibyte.clean(example('invalid Shift-JIS'))
+ end
+ end
+
+ private
+
+ STRINGS = {
+ 'valid ASCII' => [65, 83, 67, 73, 73].pack('C\*'),
+ 'invalid ASCII' => [128].pack('C\*'),
+ 'valid UTF-8' => [227, 129, 147, 227, 129, 171, 227, 129, 161, 227, 130, 143].pack('C\*'),
+ 'invalid UTF-8' => [184, 158, 8, 136, 165].pack('C\*'),
+ 'valid Shift-JIS' => [131, 122, 129, 91, 131, 128].pack('C\*'),
+ 'invalid Shift-JIS' => [184, 158, 8, 0, 255, 136, 165].pack('C\*')
+ }
+
+ def example(key)
+ STRINGS[key]
+ end
+
+ def examples
+ STRINGS.values
+ end
+
+ def with\_kcode(code)
+ before = $KCODE
+ $KCODE = code
+ yield
+ $KCODE = before
+ end
+end
\ No newline at end of file
--
1.6.0.1
>From 9af2823b32e001358babde7644e5cc1c0ec29d6e Mon Sep 17 00:00:00 2001
From: Michael Koziarski
Date: Mon, 31 Aug 2009 12:07:30 -0700
Subject: [PATCH] Clean tag attributes before passing through the escape\_once logic.
Addresses CVE-2009-3009
---
actionpack/lib/action\_view/helpers/tag\_helper.rb | 2 +-
1 files changed, 1 insertions(+), 1 deletions(-)
diff --git a/actionpack/lib/action\_view/helpers/tag\_helper.rb b/actionpack/lib/action\_view/helpers/tag\_helper.rb
index ba43b5e..623b8f7 100644
--- a/actionpack/lib/action\_view/helpers/tag\_helper.rb
+++ b/actionpack/lib/action\_view/helpers/tag\_helper.rb
@@ -101,7 +101,7 @@ module ActionView
# escape\_once("<< Accept & Checkout")
# # => "<< Accept & Checkout"
def escape\_once(html)
- html.to\_s.gsub(/[\"><]|&(?!([a-zA-Z]+|(#\d+));)/) { |special| ERB::Util::HTML\_ESCAPE[special] }
+ ActiveSupport::Multibyte.clean(html.to\_s).gsub(/[\"><]|&(?!([a-zA-Z]+|(#\d+));)/) { |special| ERB::Util::HTML\_ESCAPE[special] }
end
private
--
1.6.0.1


=== Content from security-tracker.debian.org_6e715cee_20250126_005912.html ===

# CVE-2009-3009

| **Name** | CVE-2009-3009 |
| --- | --- |
| **Description** | Cross-site scripting (XSS) vulnerability in Ruby on Rails 2.x before 2.2.3, and 2.3.x before 2.3.4, allows remote attackers to inject arbitrary web script or HTML by placing malformed Unicode strings into a form helper. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2009-3009) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2009-3009); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2009-3009), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2009-3009), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2009-3009), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2009-3009), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2009-3009), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2009-3009), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2009-3009), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2009-3009)/[CVE](https://www.suse.com/security/cve/CVE-2009-3009/), GitHub [advisories](https://github.com/advisories?query=CVE-2009-3009)/[code](https://github.com/search?type=Code&q=%22CVE-2009-3009%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2009-3009%22), [web search](https://duckduckgo.com/html?q=%22CVE-2009-3009%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DSA-1887-1](/tracker/DSA-1887-1) |
| **Debian Bugs** | [545063](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=545063) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [rails](/tracker/source-package/rails) ([PTS](https://tracker.debian.org/pkg/rails)) | bullseye (security), bullseye | 2:6.0.3.7+dfsg-2+deb11u2 | fixed |
|  | bookworm | 2:6.1.7.3+dfsg-2~deb12u1 | fixed |
|  | sid, trixie | 2:6.1.7.3+dfsg-6 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [rails](/tracker/source-package/rails) | source | lenny | 2.1.0-7 |  | [DSA-1887-1](/tracker/DSA-1887-1) |  |
| [rails](/tracker/source-package/rails) | source | (unstable) | 2.2.3-1 | low |  | [545063](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=545063) |

## Notes

```
[etch] - rails <no-dsa> (Unsupported)

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from secunia.com_2efbd983_20250124_120218.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from groups.google.com_28aa6d2f_20250126_005905.html ===
[![](https://fonts.gstatic.com/s/i/productlogos/groups/v9/web-48dp/logo_groups_color_1x_web_48dp.png)Groups](./my-groups "Groups")All groups and messagesSend feedback to GoogleHelpTraining[Sign in](https://accounts.google.com/ServiceLogin?hl=en&passive=true&continue=https://groups.google.com&ec=GAZA0AM)[Groups](./my-groups "Groups")
[Privacy](https://policies.google.com/privacy?hl=en_US) • [Terms](https://policies.google.com/terms?hl=en_US)



Content unavailable

[Click here to try again.](https://groups.google.com/g/rubyonrails-s)
If you've seen this page more than once, try [switching accounts](https://accounts.google.com/AccountChooser?continue=https://groups.google.com/g/rubyonrails-s&faa=1).



=== Content from groups.google.com_d43d266e_20250124_120216.html ===
[![](https://fonts.gstatic.com/s/i/productlogos/groups/v9/web-48dp/logo_groups_color_1x_web_48dp.png)Groups](./my-groups "Groups")ConversationsAll groups and messagesSend feedback to GoogleHelpTraining[Sign in](https://accounts.google.com/ServiceLogin?hl=en&passive=true&continue=https://groups.google.com&ec=GAZA0AM)[Groups](./my-groups "Groups")
## Ruby on Rails: Security

[Conversations](./g/rubyonrails-security)[About](./g/rubyonrails-security/about)[Privacy](https://policies.google.com/privacy?hl=en_US) • [Terms](https://policies.google.com/terms?hl=en_US)

Groups keyboard shortcuts have been updatedDismissSee shortcuts
# XSS Vulnerability in Ruby on Rails

 322 viewsSkip to first unread message![Michael Koziarski's profile photo](//lh3.googleusercontent.com/a-/ALV-UjVPSYPB9ITyAjUMAnpyRDU40F6tJ1DG2wyk-8wCip2RQtpLCg=s40-c)
### Michael Koziarski

unread,Sep 4, 2009, 12:34:09 AM9/4/09Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto rubyonrail...@googlegroups.comXSS Vulnerability in Ruby on Rails
==================================

There is a vulnerability in the escaping code for the form helpers in
Ruby on Rails. Attackers who can inject deliberately malformed unicode
strings into the form helpers can defeat the escaping checks and inject
arbitrary HTML.

Versions Affected: 2.0.0 and \*all\* subsequent versions.
Not affected: Applications running on ruby 1.9
Fixed Versions: 2.3.4, 2.2.3
Candidate CVE: CVE-2009-3009

Impact
------

Due to the way that most databases either don't accept or actively
cleanse malformed unicode strings this vulnerability is most likely to
be exploited by non-persistent attacks however persistent attacks may
still be possible in some configurations.

\*All\* users of affected versions are advised to upgrade to a fixed versions.

Releases
--------

The 2.3.4 and 2.2.3 releases will be made available later today and
tomorrow which will contain fixes for this issue amongst others.

Patches
-------

In order to provide the fixes for users who are running unsupported
releases, or are unable to upgrade at present we have provided patches
against all affected stable release branches.

The patches are in a format suitable for git-am and consist of two
changesets. The code for cleansing multi-byte strings, and the
introduction of that code to the relevant helpers.

\* 2-0-CVE-2009-3009.patch - Patch for 2.0 series
\* 2-1-CVE-2009-3009.patch - Patch for 2.1 series
\* 2-2-CVE-2009-3009.patch - Patch for 2.2 series
\* 2-3-CVE-2009-3009.patch - Patch for 2.3 series

Please note that only the 2.2.x and 2.3.x series are supported at
present. Users of earlier unsupported releases are advised to upgrade
sooner rather than later as we cannot guarantee that future issues will
be backported in this manner.

Credits
-------

Thanks to Brian Mastenbrook for reporting the vulnerability to us, and
Manfred Stienstra from Fingertips for his work with us on the fix.

--
Cheers,

Koz

2-1-CVE-2009-3009.patch[](https://groups.google.com/group/rubyonrails-security/attach/7f57cd7794e1d1b4/2-1-CVE-2009-3009.patch?part=0.1&view=1)2-2-CVE-2009-3009.patch[](https://groups.google.com/group/rubyonrails-security/attach/7f57cd7794e1d1b4/2-2-CVE-2009-3009.patch?part=0.2&view=1)2-3-CVE-2009-3009.patch[](https://groups.google.com/group/rubyonrails-security/attach/7f57cd7794e1d1b4/2-3-CVE-2009-3009.patch?part=0.3&view=1)2-0-CVE-2009-3009.patch[](https://groups.google.com/group/rubyonrails-security/attach/7f57cd7794e1d1b4/2-0-CVE-2009-3009.patch?part=0.4&view=1)Reply allReply to authorForward0 new messages

=== Content from groups.google.com_c3de6495_20250126_005911.html ===
>From 9c61eb32c534c706815f80eb375012cdcf854e71 Mon Sep 17 00:00:00 2001
From: Michael Koziarski
Date: Mon, 31 Aug 2009 12:20:46 -0700
Subject: [PATCH] Add verify and clean methods to ActiveSupport::Multibyte.
When accepting character input from outside of your application you can't
blindly trust that all strings are properly encoded. With these methods
you can check incoming strings and clean them up if necessary.
Signed-off-by: Michael Koziarski
Conflicts:
activesupport/lib/active\_support/multibyte/chars.rb
---
activesupport/lib/active\_support/multibyte.rb | 36 ++++-
.../lib/active\_support/multibyte/chars.rb | 25 ++---
.../lib/active\_support/multibyte/utils.rb | 61 +++++++++
activesupport/test/multibyte\_utils\_test.rb | 141 ++++++++++++++++++++
4 files changed, 241 insertions(+), 22 deletions(-)
create mode 100644 activesupport/lib/active\_support/multibyte/utils.rb
create mode 100644 activesupport/test/multibyte\_utils\_test.rb
diff --git a/activesupport/lib/active\_support/multibyte.rb b/activesupport/lib/active\_support/multibyte.rb
index 65a96af..b6354ee 100644
--- a/activesupport/lib/active\_support/multibyte.rb
+++ b/activesupport/lib/active\_support/multibyte.rb
@@ -1,9 +1,5 @@
# encoding: utf-8
-require 'active\_support/multibyte/chars'
-require 'active\_support/multibyte/exceptions'
-require 'active\_support/multibyte/unicode\_database'
-
module ActiveSupport #:nodoc:
module Multibyte
# A list of all available normalization forms. See http://www.unicode.org/reports/tr15/tr15-29.html for more
@@ -27,7 +23,35 @@ module ActiveSupport #:nodoc:
#
# Example:
# ActiveSupport::Multibyte.proxy\_class = CharsForUTF32
- mattr\_accessor :proxy\_class
- self.proxy\_class = ActiveSupport::Multibyte::Chars
+ def self.proxy\_class=(klass)
+ @proxy\_class = klass
+ end
+
+ # Returns the currect proxy class
+ def self.proxy\_class
+ @proxy\_class ||= ActiveSupport::Multibyte::Chars
+ end
+
+ # Regular expressions that describe valid byte sequences for a character
+ VALID\_CHARACTER = {
+ # Borrowed from the Kconv library by Shinji KONO - (also as seen on the W3C site)
+ 'UTF-8' => /\A(?:
+ [\x00-\x7f] |
+ [\xc2-\xdf] [\x80-\xbf] |
+ \xe0 [\xa0-\xbf] [\x80-\xbf] |
+ [\xe1-\xef] [\x80-\xbf] [\x80-\xbf] |
+ \xf0 [\x90-\xbf] [\x80-\xbf] [\x80-\xbf] |
+ [\xf1-\xf3] [\x80-\xbf] [\x80-\xbf] [\x80-\xbf] |
+ \xf4 [\x80-\x8f] [\x80-\xbf] [\x80-\xbf])\z /xn,
+ # Quick check for valid Shift-JIS characters, disregards the odd-even pairing
+ 'Shift\_JIS' => /\A(?:
+ [\x00-\x7e \xa1-\xdf] |
+ [\x81-\x9f \xe0-\xef] [\x40-\x7e \x80-\x9e \x9f-\xfc])\z /xn
+ }
end
end
+
+require 'active\_support/multibyte/chars'
+require 'active\_support/multibyte/exceptions'
+require 'active\_support/multibyte/unicode\_database'
+require 'active\_support/multibyte/utils'
diff --git a/activesupport/lib/active\_support/multibyte/chars.rb b/activesupport/lib/active\_support/multibyte/chars.rb
index a00b165..5199bf9 100644
--- a/activesupport/lib/active\_support/multibyte/chars.rb
+++ b/activesupport/lib/active\_support/multibyte/chars.rb
@@ -73,16 +73,7 @@ module ActiveSupport #:nodoc:
UNICODE\_TRAILERS\_PAT = /(#{codepoints\_to\_pattern(UNICODE\_LEADERS\_AND\_TRAILERS)})+\Z/
UNICODE\_LEADERS\_PAT = /\A(#{codepoints\_to\_pattern(UNICODE\_LEADERS\_AND\_TRAILERS)})+/
- # Borrowed from the Kconv library by Shinji KONO - (also as seen on the W3C site)
- UTF8\_PAT = /\A(?:
- [\x00-\x7f] |
- [\xc2-\xdf] [\x80-\xbf] |
- \xe0 [\xa0-\xbf] [\x80-\xbf] |
- [\xe1-\xef] [\x80-\xbf] [\x80-\xbf] |
- \xf0 [\x90-\xbf] [\x80-\xbf] [\x80-\xbf] |
- [\xf1-\xf3] [\x80-\xbf] [\x80-\xbf] [\x80-\xbf] |
- \xf4 [\x80-\x8f] [\x80-\xbf] [\x80-\xbf]
- )\*\z/xn
+ UTF8\_PAT = ActiveSupport::Multibyte::VALID\_CHARACTER['UTF-8']
attr\_reader :wrapped\_string
alias to\_s wrapped\_string
@@ -292,23 +283,23 @@ module ActiveSupport #:nodoc:
def rstrip
chars(@wrapped\_string.gsub(UNICODE\_TRAILERS\_PAT, ''))
end
-
+
# Strips entire range of Unicode whitespace from the left of the string.
def lstrip
chars(@wrapped\_string.gsub(UNICODE\_LEADERS\_PAT, ''))
end
-
+
# Strips entire range of Unicode whitespace from the right and left of the string.
def strip
rstrip.lstrip
end
-
+
# Returns the number of codepoints in the string
def size
self.class.u\_unpack(@wrapped\_string).size
end
alias\_method :length, :size
-
+
# Reverses all characters in the string.
#
# Example:
@@ -316,7 +307,7 @@ module ActiveSupport #:nodoc:
def reverse
chars(self.class.u\_unpack(@wrapped\_string).reverse.pack('U\*'))
end
-
+
# Implements Unicode-aware slice with codepoints. Slicing on one point returns the codepoints for that
# character.
#
@@ -617,7 +608,9 @@ module ActiveSupport #:nodoc:
# Replaces all ISO-8859-1 or CP1252 characters by their UTF-8 equivalent resulting in a valid UTF-8 string.
def tidy\_bytes(string)
string.split(//u).map do |c|
- if !UTF8\_PAT.match(c)
+ c.force\_encoding(Encoding::ASCII) if c.respond\_to?(:force\_encoding)
+
+ if !ActiveSupport::Multibyte::VALID\_CHARACTER['UTF-8'].match(c)
n = c.unpack('C')[0]
n < 128 ? n.chr :
n < 160 ? [UCD.cp1252[n] || n].pack('U') :
diff --git a/activesupport/lib/active\_support/multibyte/utils.rb b/activesupport/lib/active\_support/multibyte/utils.rb
new file mode 100644
index 0000000..acef84d
--- /dev/null
+++ b/activesupport/lib/active\_support/multibyte/utils.rb
@@ -0,0 +1,61 @@
+# encoding: utf-8
+
+module ActiveSupport #:nodoc:
+ module Multibyte #:nodoc:
+ if Kernel.const\_defined?(:Encoding)
+ # Returns a regular expression that matches valid characters in the current encoding
+ def self.valid\_character
+ VALID\_CHARACTER[Encoding.default\_internal.to\_s]
+ end
+ else
+ def self.valid\_character
+ case $KCODE
+ when 'UTF8'
+ VALID\_CHARACTER['UTF-8']
+ when 'SJIS'
+ VALID\_CHARACTER['Shift\_JIS']
+ end
+ end
+ end
+
+ if 'string'.respond\_to?(:valid\_encoding?)
+ # Verifies the encoding of a string
+ def self.verify(string)
+ string.valid\_encoding?
+ end
+ else
+ def self.verify(string)
+ if expression = valid\_character
+ for c in string.split(//)
+ return false unless valid\_character.match(c)
+ end
+ end
+ true
+ end
+ end
+
+ # Verifies the encoding of the string and raises an exception when it's not valid
+ def self.verify!(string)
+ raise EncodingError.new("Found characters with invalid encoding") unless verify(string)
+ end
+
+ if 'string'.respond\_to?(:force\_encoding)
+ # Removes all invalid characters from the string.
+ #
+ # Note: this method is a no-op in Ruby 1.9
+ def self.clean(string)
+ string
+ end
+ else
+ def self.clean(string)
+ if expression = valid\_character
+ stripped = []; for c in string.split(//)
+ stripped << c if valid\_character.match(c)
+ end; stripped.join
+ else
+ string
+ end
+ end
+ end
+ end
+end
\ No newline at end of file
diff --git a/activesupport/test/multibyte\_utils\_test.rb b/activesupport/test/multibyte\_utils\_test.rb
new file mode 100644
index 0000000..d8ac5ff
--- /dev/null
+++ b/activesupport/test/multibyte\_utils\_test.rb
@@ -0,0 +1,141 @@
+# encoding: utf-8
+
+require 'abstract\_unit'
+require 'multibyte\_test\_helpers'
+
+class MultibyteUtilsTest < ActiveSupport::TestCase
+ include MultibyteTestHelpers
+
+ test "valid\_character returns an expression for the current encoding" do
+ with\_encoding('None') do
+ assert\_nil ActiveSupport::Multibyte.valid\_character
+ end
+ with\_encoding('UTF8') do
+ assert\_equal ActiveSupport::Multibyte::VALID\_CHARACTER['UTF-8'], ActiveSupport::Multibyte.valid\_character
+ end
+ with\_encoding('SJIS') do
+ assert\_equal ActiveSupport::Multibyte::VALID\_CHARACTER['Shift\_JIS'], ActiveSupport::Multibyte.valid\_character
+ end
+ end
+
+ test "verify verifies ASCII strings are properly encoded" do
+ with\_encoding('None') do
+ examples.each do |example|
+ assert ActiveSupport::Multibyte.verify(example)
+ end
+ end
+ end
+
+ test "verify verifies UTF-8 strings are properly encoded" do
+ with\_encoding('UTF8') do
+ assert ActiveSupport::Multibyte.verify(example('valid UTF-8'))
+ assert !ActiveSupport::Multibyte.verify(example('invalid UTF-8'))
+ end
+ end
+
+ test "verify verifies Shift-JIS strings are properly encoded" do
+ with\_encoding('SJIS') do
+ assert ActiveSupport::Multibyte.verify(example('valid Shift-JIS'))
+ assert !ActiveSupport::Multibyte.verify(example('invalid Shift-JIS'))
+ end
+ end
+
+ test "verify! raises an exception when it finds an invalid character" do
+ with\_encoding('UTF8') do
+ assert\_raises(ActiveSupport::Multibyte::EncodingError) do
+ ActiveSupport::Multibyte.verify!(example('invalid UTF-8'))
+ end
+ end
+ end
+
+ test "verify! doesn't raise an exception when the encoding is valid" do
+ with\_encoding('UTF8') do
+ assert\_nothing\_raised do
+ ActiveSupport::Multibyte.verify!(example('valid UTF-8'))
+ end
+ end
+ end
+
+ if RUBY\_VERSION < '1.9'
+ test "clean leaves ASCII strings intact" do
+ with\_encoding('None') do
+ [
+ 'word', "\270\236\010\210\245"
+ ].each do |string|
+ assert\_equal string, ActiveSupport::Multibyte.clean(string)
+ end
+ end
+ end
+
+ test "clean cleans invalid characters from UTF-8 encoded strings" do
+ with\_encoding('UTF8') do
+ cleaned\_utf8 = [8].pack('C\*')
+ assert\_equal example('valid UTF-8'), ActiveSupport::Multibyte.clean(example('valid UTF-8'))
+ assert\_equal cleaned\_utf8, ActiveSupport::Multibyte.clean(example('invalid UTF-8'))
+ end
+ end
+
+ test "clean cleans invalid characters from Shift-JIS encoded strings" do
+ with\_encoding('SJIS') do
+ cleaned\_sjis = [184, 0, 136, 165].pack('C\*')
+ assert\_equal example('valid Shift-JIS'), ActiveSupport::Multibyte.clean(example('valid Shift-JIS'))
+ assert\_equal cleaned\_sjis, ActiveSupport::Multibyte.clean(example('invalid Shift-JIS'))
+ end
+ end
+ else
+ test "clean is a no-op" do
+ with\_encoding('UTF8') do
+ assert\_equal example('invalid Shift-JIS'), ActiveSupport::Multibyte.clean(example('invalid Shift-JIS'))
+ end
+ end
+ end
+
+ private
+
+ STRINGS = {
+ 'valid ASCII' => [65, 83, 67, 73, 73].pack('C\*'),
+ 'invalid ASCII' => [128].pack('C\*'),
+ 'valid UTF-8' => [227, 129, 147, 227, 129, 171, 227, 129, 161, 227, 130, 143].pack('C\*'),
+ 'invalid UTF-8' => [184, 158, 8, 136, 165].pack('C\*'),
+ 'valid Shift-JIS' => [131, 122, 129, 91, 131, 128].pack('C\*'),
+ 'invalid Shift-JIS' => [184, 158, 8, 0, 255, 136, 165].pack('C\*')
+ }
+
+ if Kernel.const\_defined?(:Encoding)
+ def example(key)
+ STRINGS[key].force\_encoding(Encoding.default\_internal)
+ end
+
+ def examples
+ STRINGS.values.map { |s| s.force\_encoding(Encoding.default\_internal) }
+ end
+ else
+ def example(key)
+ STRINGS[key]
+ end
+
+ def examples
+ STRINGS.values
+ end
+ end
+
+ if 'string'.respond\_to?(:encoding)
+ def with\_encoding(enc)
+ before = Encoding.default\_internal
+
+ case enc
+ when 'UTF8'
+ Encoding.default\_internal = Encoding::UTF\_8
+ when 'SJIS'
+ Encoding.default\_internal = Encoding::Shift\_JIS
+ else
+ Encoding.default\_internal = Encoding::BINARY
+ end
+ yield
+
+ Encoding.default\_internal = before
+ end
+ else
+ alias with\_encoding with\_kcode
+ end
+end
\ No newline at end of file
--
1.6.0.1
>From 31678df21276f0a986a4e39a69a4c10a2236a2ce Mon Sep 17 00:00:00 2001
From: Michael Koziarski
Date: Mon, 31 Aug 2009 12:07:30 -0700
Subject: [PATCH] Clean tag attributes before passing through the escape\_once logic.
Addresses CVE-2009-3009
---
actionpack/lib/action\_view/helpers/tag\_helper.rb | 2 +-
1 files changed, 1 insertions(+), 1 deletions(-)
diff --git a/actionpack/lib/action\_view/helpers/tag\_helper.rb b/actionpack/lib/action\_view/helpers/tag\_helper.rb
index 1c8d2db..54a9df4 100644
--- a/actionpack/lib/action\_view/helpers/tag\_helper.rb
+++ b/actionpack/lib/action\_view/helpers/tag\_helper.rb
@@ -104,7 +104,7 @@ module ActionView
# escape\_once("<< Accept & Checkout")
# # => "<< Accept & Checkout"
def escape\_once(html)
- html.to\_s.gsub(/[\"><]|&(?!([a-zA-Z]+|(#\d+));)/) { |special| ERB::Util::HTML\_ESCAPE[special] }
+ ActiveSupport::Multibyte.clean(html.to\_s).gsub(/[\"><]|&(?!([a-zA-Z]+|(#\d+));)/) { |special| ERB::Util::HTML\_ESCAPE[special] }
end
private
--
1.6.0.1


=== Content from support.apple.com_9ea67d90_20250124_120219.html ===


* [Apple](https://www.apple.com/)
* + [Store](https://www.apple.com/us/shop/goto/store)
  + [Mac](https://www.apple.com/mac/)
  + [iPad](https://www.apple.com/ipad/)
  + [iPhone](https://www.apple.com/iphone/)
  + [Watch](https://www.apple.com/watch/)
  + [Vision](https://www.apple.com/apple-vision-pro/)
  + [AirPods](https://www.apple.com/airpods/)
  + [TV & Home](https://www.apple.com/tv-home/)
  + [Entertainment](https://www.apple.com/entertainment/)
  + [Accessories](https://www.apple.com/us/shop/goto/buy_accessories)
  + [Support](https://support.apple.com/?cid=gn-ols-home-hp-tab)
* 0+

This article has been archived and is no longer updated by Apple.
# About the security content of Security Update 2010-002 / Mac OS X v10.6.3

This document describes the security content of Security Update 2010-002 / Mac OS X v10.6.3.

For the protection of our customers, Apple does not disclose, discuss, or confirm security issues until a full investigation has occurred and any necessary patches or releases are available. To learn more about Apple Product Security, see the [Apple Product Security](http://www.apple.com/support/security/) website.

For information about the Apple Product Security PGP Key, see "[How to use the Apple Product Security PGP Key](http://support.apple.com/kb/HT1620)."

Where possible, [CVE IDs](http://cve.mitre.org/about/) are used to reference the vulnerabilities for further information.

To learn about other Security Updates, see "[Apple Security Updates](http://support.apple.com/kb/HT1222)."

#### Security Update 2010-002 / Mac OS X v10.6.3

* **AppKit**

  CVE-ID: CVE-2010-0056

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: Spell checking a maliciously crafted document may lead to an unexpected application termination or arbitrary code execution

  Description: A buffer overflow exists in the spell checking feature used by Cocoa applications. Spell checking a maliciously crafted document may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. This issue does not affect Mac OS X v10.6 systems. Credit: Apple.

* **Application Firewall**

  CVE-ID: CVE-2009-2801

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: Certain rules in the Application Firewall may become inactive after restart

  Description: A timing issue in the Application Firewall may cause certain rules to become inactive after reboot. The issue is addressed through improved handling of Firewall rules. This issue does not affect Mac OS X v10.6 systems. Credit to Michael Kisor of OrganicOrb.com for reporting this issue.

* **AFP Server**

  CVE-ID: CVE-2010-0057

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: When guest access is disabled, a remote user may be able to mount AFP shares as a guest

  Description: An access control issue in AFP Server may allow a remote user to mount AFP shares as a guest, even if guest access is disabled. This issue is addressed through improved access control checks. Credit: Apple.

* **AFP Server**

  CVE-ID: CVE-2010-0533

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A remote user with guest access to an AFP share may access the contents of world-readable files outside the Public share

  Description: A directory traversal issue exists in the path validation for AFP shares. A remote user may enumerate the parent directory of the share root, and read or write files within that directory that are accessible to the 'nobody' user. This issue is addressed through improved handling of file paths. Credit to Patrik Karlsson of cqure.net for reporting this issue.

* **Apache**

  CVE-ID: CVE-2009-3095

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A remote attacker may be able to bypass access control restrictions

  Description: An input validation issue exists in Apache's handling of proxied FTP requests. A remote attacker with the ability to issue requests through the proxy may be able to bypass access control restrictions specified in the Apache configuration. This issue is addressed by updating Apache to version 2.2.14.

* **ClamAV**

  CVE-ID: CVE-2010-0058

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: ClamAV virus definitions may not receive updates

  Description: A configuration issue introduced in Security Update 2009-005 prevents freshclam from running. This may prevent virus definitions from being updated. This issue is addressed by updating freshclam's launchd plist ProgramArguments key values. This issue does not affect Mac OS X v10.6 systems. Credit to Bayard Bell, Wil Shipley of Delicious Monster, and David Ferrero of Zion Software, LLC for reporting this issue.

* **CoreAudio**

  CVE-ID: CVE-2010-0059

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Playing maliciously crafted audio content may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue exists in the handling of QDM2 encoded audio content. Playing maliciously crafted audio content may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. Credit to an anonymous researcher working with TippingPoint's Zero Day Initiative for reporting this issue.

* **CoreAudio**

  CVE-ID: CVE-2010-0060

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Playing maliciously crafted audio content may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue exists in the handling of QDMC encoded audio content. Playing maliciously crafted audio content may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. Credit to an anonymous researcher working with TippingPoint's Zero Day Initiative for reporting this issue.

* **CoreMedia**

  CVE-ID: CVE-2010-0062

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A heap buffer overflow exists in CoreMedia's handling of H.263 encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of H.263 encoded movie files. Credit to Damian Put and an anonymous researcher working with TippingPoint's Zero Day Initiative for reporting this issue.

* **CoreTypes**

  CVE-ID: CVE-2010-0063

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Users are not warned before opening certain potentially unsafe content types

  Description: This update adds .ibplugin and .url to the system's list of content types that will be flagged as potentially unsafe under certain circumstances, such as when they are downloaded from a web page. While these content types are not automatically launched, if manually opened they could lead to the execution of a malicious JavaScript payload or arbitrary code execution. This update improves the system's ability to notify users before handling content types used by Safari. Credit to Clint Ruoho of Laconic Security for reporting this issue.

* **CUPS**

  CVE-ID: CVE-2010-0393

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A local user may be able to obtain system privileges

  Description: A format string issue exists in the lppasswd CUPS utility. This may allow a local user to obtain system privileges. Mac OS X v10.6 systems are only affected if the setuid bit has been set on the binary. This issue is addressed by using default directories when running as a setuid process. Credit to Ronald Volgers for reporting this issue.

* **curl**

  CVE-ID: CVE-2009-2417

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A man-in-the-middle attacker may be able to impersonate a trusted server

  Description: A canonicalization issue exists in curl's handling of NULL characters in the subject's Common Name (CN) field of X.509 certificates. This may lead to man-in-the-middle attacks against users of the curl command line tool, or applications using libcurl. This issue is addressed through improved handling of NULL characters.

* **curl**

  CVE-ID: CVE-2009-0037

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: Using curl with -L may allow a remote attacker to read or write local files

  Description: curl will follow HTTP and HTTPS redirects when used with the -L option. When curl follows a redirect, it allows file:// URLs. This may allow a remote attacker to access local files. This issue is addressed through improved validation of redirects. This issue does not affect Mac OS X v10.6 systems. Credit to Daniel Stenberg of Haxx AB for reporting this issue.

* **Cyrus IMAP**

  CVE-ID: CVE-2009-2632

  Available for: Mac OS X Server v10.5.8

  Impact: A local user may be able to obtain the privileges of the Cyrus user

  Description: A buffer overflow exists in the handling of sieve scripts. By running a maliciously crafted sieve script, a local user may be able to obtain the privileges of the Cyrus user. This issue is addressed through improved bounds checking. This issue does not affect Mac OS X v10.6 systems.

* **Cyrus SASL**

  CVE-ID: CVE-2009-0688

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: An unauthenticated remote attacker may cause unexpected application termination or arbitrary code execution

  Description: A buffer overflow exists in the Cyrus SASL authentication module. Using Cyrus SASL authentication may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. This issue does not affect Mac OS X v10.6 systems.

* **DesktopServices**

  CVE-ID: CVE-2010-0064

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Items copied in the Finder may be assigned an unexpected file owner

  Description: When performing an authenticated copy in the Finder, original file ownership may be unexpectedly copied. This update addresses the issue by ensuring that copied files are owned by the user performing the copy. This issue does not affect systems prior to Mac OS X v10.6. Credit to Gerrit DeWitt of Auburn University (Auburn, AL) for reporting this issue.

* **DesktopServices**

  CVE-ID: CVE-2010-0537

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A remote attacker may gain access to user data via a multi-stage attack

  Description: A path resolution issue in DesktopServices is vulnerable to a multi-stage attack. A remote attacker must first entice the user to mount an arbitrarily named share, which may be done via a URL scheme. When saving a file using the default save panel in any application, and using "Go to folder" or dragging folders to the save panel, the data may be unexpectedly saved to the malicious share. This issue is addressed through improved path resolution. This issue does not affect systems prior to Mac OS X v10.6. Credit to Sidney San Martin working with DeepTech, Inc. for reporting this issue.

* **Disk Images**

  CVE-ID: CVE-2010-0065

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Mounting a maliciously crafted disk image may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue exists in the handling of bzip2 compressed disk images. Mounting a maliciously crafted disk image may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. Credit: Apple.

* **Disk Images**

  CVE-ID: CVE-2010-0497

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Mounting a maliciously crafted disk image may lead to arbitrary code execution

  Description: A design issue exists in the handling of internet enabled disk images. Mounting an internet enabled disk image containing a package file type will open it rather than revealing it in the Finder. This file quarantine feature helps to mitigate this issue by providing a warning dialog for unsafe file types. This issue is addressed through improved handling of package file types on internet enabled disk images. Credit to Brian Mastenbrook working with TippingPoint's Zero Day Initiative for reporting this issue.

* **Directory Services**

  CVE-ID: CVE-2010-0498

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A local user may obtain system privileges

  Description: An authorization issue in Directory Services' handling of record names may allow a local user to obtain system privileges. This issue is addressed through improved authorization checks. Credit: Apple.

* **Dovecot**

  CVE-ID: CVE-2010-0535

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: An authenticated user may be able to send and receive mail even if the user is not on the SACL of users who are permitted to do so

  Description: An access control issue exists in Dovecot when Kerberos authentication is enabled. This may allow an authenticated user to send and receive mail even if the user is not on the service access control list (SACL) of users who are permitted to do so. This issue is addressed through improved access control checks. This issue does not affect systems prior to Mac OS X v10.6.

* **Event Monitor**

  CVE-ID: CVE-2010-0500

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A remote attacker may cause arbitrary systems to be added to the firewall blacklist

  Description: A reverse DNS lookup is performed on remote ssh clients that fail to authenticate. A plist injection issue exists in the handling of resolved DNS names. This may allow a remote attacker to cause arbitrary systems to be added to the firewall blacklist. This issue is addressed by properly escaping resolved DNS names. Credit: Apple.

* **FreeRADIUS**

  CVE-ID: CVE-2010-0524

  Available for: Mac OS X Server v10.5.8, Mac OS X Server v10.6 through v10.6.2

  Impact: A remote attacker may obtain access to a network via RADIUS authentication

  Description: A certificate authentication issue exists in the default Mac OS X configuration of the FreeRADIUS server. A remote attacker may use EAP-TLS with an arbitrary valid certificate to authenticate and connect to a network configured to use FreeRADIUS for authentication. This issue is addressed by disabling support for EAP-TLS in the configuration. RADIUS clients should use EAP-TTLS instead. This issue only affects Mac OS X Server systems. Credit to Chris Linstruth of Qnet for reporting this issue.

* **FTP Server**

  CVE-ID: CVE-2010-0501

  Available for: Mac OS X Server v10.5.8, Mac OS X Server v10.6 through v10.6.2

  Impact: Users may be able to retrieve files outside the FTP root directory

  Description: A directory traversal issue exists in FTP Server. This may allow a user to retrieve files outside the FTP root directory. This issue is addressed through improved handling of file names. This issue only affects Mac OS X Server systems. Credit: Apple.

* **iChat Server**

  CVE-ID: CVE-2006-1329

  Available for: Mac OS X Server v10.5.8, Mac OS X Server v10.6 through v10.6.2

  Impact: A remote attacker may be able to cause a denial of service

  Description: An implementation issue exists in jabberd's handling of SASL negotiation. A remote attacker may be able to terminate the operation of jabberd. This issue is addressed through improved handling of SASL negotiation. This issue only affects Mac OS X Server systems.

* **iChat Server**

  CVE-ID: CVE-2010-0502

  Available for: Mac OS X Server v10.5.8, Mac OS X Server v10.6 through v10.6.2

  Impact: Chat messages may not be logged

  Description: A design issue exists in iChat Server's support for configurable group chat logging. iChat Server only logs messages with certain message types. This may allow a remote user to send a message through the server without it being logged. The issue is addressed by removing the capability to disable group chat logs, and logging all messages that are sent through the server. This issue only affects Mac OS X Server systems. Credit: Apple.

* **iChat Server**

  CVE-ID: CVE-2010-0503

  Available for: Mac OS X Server v10.5.8

  Impact: An authenticated user may be able to cause an unexpected application termination or arbitrary code execution

  Description: A use-after-free issue exists in iChat Server. An authenticated user may be able to cause an unexpected application termination or arbitrary code execution. This issue is addressed through improved memory reference tracking. This issue only affects Mac OS X Server systems, and does not affect versions 10.6 or later.

* **iChat Server**

  CVE-ID: CVE-2010-0504

  Available for: Mac OS X Server v10.5.8, Mac OS X Server v10.6 through v10.6.2

  Impact: An authenticated user may be able to cause an unexpected application termination or arbitrary code execution

  Description: Multiple stack buffer overflow issues exist in iChat Server. An authenticated user may be able to cause an unexpected application termination or arbitrary code execution. These issues are addressed through improved memory management. These issues only affect Mac OS X Server systems. Credit: Apple.

* **ImageIO**

  CVE-ID: CVE-2010-0505

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted JP2 image may lead to an unexpected application termination or arbitrary code execution

  Description: A heap buffer overflow exists in the handling of JP2 images. Viewing a maliciously crafted JP2 image may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. Credit to Chris Ries of Carnegie Mellon University Computing Service, and researcher "85319bb6e6ab398b334509c50afce5259d42756e" working with TippingPoint's Zero Day Initiative for reporting this issue.

* **ImageIO**

  CVE-ID: CVE-2010-0041

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Visiting a maliciously crafted website may result in sending data from Safari's memory to the website

  Description: An uninitialized memory access issue exists in ImageIO's handling of BMP images. Visiting a maliciously crafted website may result in sending data from Safari's memory to the website. This issue is addressed through improved memory initialization and additional validation of BMP images. Credit to Matthew 'j00ru' Jurczyk of Hispasec for reporting this issue.

* **ImageIO**

  CVE-ID: CVE-2010-0042

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Visiting a maliciously crafted website may result in sending data from Safari's memory to the website

  Description: An uninitialized memory access issue exists in ImageIO's handling of TIFF images. Visiting a maliciously crafted website may result in sending data from Safari's memory to the website. This issue is addressed through improved memory initialization and additional validation of TIFF images. Credit to Matthew 'j00ru' Jurczyk of Hispasec for reporting this issue.

* **ImageIO**

  CVE-ID: CVE-2010-0043

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Processing a maliciously crafted TIFF image may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue exists in the handling of TIFF images. Processing a maliciously crafted TIFF image may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved memory handling. This issue does not affect systems prior to Mac OS X v10.6. Credit to Gus Mueller of Flying Meat for reporting this issue.

* **Image RAW**

  CVE-ID: CVE-2010-0506

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: Viewing a maliciously crafted NEF image may lead to an unexpected application termination or arbitrary code execution

  Description: A buffer overflow exists in Image RAW's handling of NEF images. Viewing a maliciously crafted NEF image may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. This issue does not affect Mac OS X v10.6 systems. Credit: Apple.

* **Image RAW**

  CVE-ID: CVE-2010-0507

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted PEF image may lead to an unexpected application termination or arbitrary code execution

  Description: A buffer overflow exists in Image RAW's handling of PEF images. Viewing a maliciously crafted PEF image may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. Credit to Chris Ries of Carnegie Mellon University Computing Services for reporting this issue.

* **Libsystem**

  CVE-ID: CVE-2009-0689

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Applications that convert untrusted data between binary floating point and text may be vulnerable to an unexpected application termination or arbitrary code execution

  Description: A buffer overflow exists in the floating point binary to text conversion code within Libsystem. An attacker who can cause an application to convert a floating point value into a long string, or to parse a maliciously crafted string as a floating point value, may be able to cause an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. Credit to Maksymilian Arciemowicz of SecurityReason.com for reporting this issue.

* **Mail**

  CVE-ID: CVE-2010-0508

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Rules associated with a deleted mail account remain in effect

  Description: When a mail account is deleted, user-defined filter rules associated with that account remain active. This may result in unexpected actions. This issue is addressed by disabling associated rules when a mail account is deleted.

* **Mail**

  CVE-ID: CVE-2010-0525

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Mail may use a weaker encryption key for outgoing email

  Description: A logic issue exists in Mail's handling of encryption certificates. When multiple certificates for the recipient exist in the keychain, Mail may select an encryption key that is not intended for encipherment. This may lead to a security issue if the chosen key is weaker than expected. This issue is addressed by ensuring that the key usage extension within certificates is evaluated when selecting a mail encryption key. Credit to Paul Suh of ps Enable, Inc. for reporting this issue.

* **Mailman**

  CVE-ID: CVE-2008-0564

  Available for: Mac OS X Server v10.5.8

  Impact: Multiple vulnerabilities in Mailman 2.1.9

  Description: Multiple cross-site scripting issues exist in Mailman 2.1.9. These issues are addressed by updating Mailman to version 2.1.13. Further information is available via the Mailman site at <http://mail.python.org/pipermail/mailman-announce/2009-January/000128.html> These issues only affect Mac OS X Server systems, and do not affect versions 10.6 or later.

* **MySQL**

  CVE-ID: CVE-2008-4456, CVE-2008-7247, CVE-2009-2446, CVE-2009-4019, CVE-2009-4030

  Available for: Mac OS X Server v10.6 through v10.6.2

  Impact: Multiple vulnerabilities in MySQL 5.0.82

  Description: MySQL is updated to version 5.0.88 to address multiple vulnerabilities, the most serious of which may lead to arbitrary code execution. These issues only affect Mac OS X Server systems. Further information is available via the MySQL web site at <http://dev.mysql.com/doc/refman/5.0/en/news-5-0-88.html>

* **OS Services**

  CVE-ID: CVE-2010-0509

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A local user may be able to obtain elevated privileges

  Description: A privilege escalation issue exists in SFLServer, as it runs as group 'wheel' and accesses files in users' home directories. This issue is addressed through improved privilege management. Credit to Kevin Finisterre of DigitalMunition for reporting this issue.

* **Password Server**

  CVE-ID: CVE-2010-0510

  Available for: Mac OS X Server v10.5.8, Mac OS X Server v10.6 through v10.6.2

  Impact: A remote attacker may be able to log in with an outdated password

  Description: An implementation issue in Password Server's handling of replication may cause passwords to not be replicated. A remote attacker may be able to log in to a system using an outdated password. This issue is addressed through improved handling of password replication. This issue only affects Mac OS X Server systems. Credit to Jack Johnson of Anchorage School District for reporting this issue.

* **perl**

  CVE-ID: CVE-2008-5302, CVE-2008-5303

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: A local user may cause arbitrary files to be deleted

  Description: Multiple race condition issues exist in the rmtree function of the perl module File::Path. A local user with write access to a directory that is being deleted may cause arbitrary files to be removed with the privileges of the perl process. This issue is addressed through improved handling of symbolic links. This issue does not affect Mac OS X v10.6 systems.

* **PHP**

  CVE-ID: CVE-2009-3557, CVE-2009-3558, CVE-2009-3559, CVE-2009-4017

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Multiple vulnerabilities in PHP 5.3.0

  Description: PHP is updated to version 5.3.1 to address multiple vulnerabilities, the most serious of which may lead to arbitrary code execution. Further information is available via the PHP website at <http://www.php.net/>

* **PHP**

  CVE-ID: CVE-2009-3557, CVE-2009-3558, CVE-2009-3559, CVE-2009-4142, CVE-2009-4143

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: Multiple vulnerabilities in PHP 5.2.11

  Description: PHP is updated to version 5.2.12 to address multiple vulnerabilities, the most serious of which may lead to cross-site scripting. Further information is available via the PHP website at <http://www.php.net/>

* **Podcast Producer**

  CVE-ID: CVE-2010-0511

  Available for: Mac OS X Server v10.6 through v10.6.2

  Impact: An unauthorized user may be able to access a Podcast Composer workflow

  Description: When a Podcast Composer workflow is overwritten, the access restrictions are removed. This may allow an unauthorized user to access a Podcast Composer workflow. This issue is addressed through improved handling of workflow access restrictions. Podcast Composer was introduced in Mac OS X Server v10.6.

* **Preferences**

  CVE-ID: CVE-2010-0512

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A network user may be able to bypass system login restrictions

  Description: An implementation issue exists in the handling of system login restrictions for network accounts. If the network accounts allowed to log in to the system at the Login Window are identified by group membership only, the restriction will not be enforced, and all network users will be allowed to log in to the system. The issue is addressed through improved group restriction management in the Accounts preference pane. This issue only affects systems configured to use a network account server, and does not affect systems prior to Mac OS X v10.6. Credit to Christopher D. Grieb of University of Michigan MSIS for reporting this issue.

* **PS Normalizer**

  CVE-ID: CVE-2010-0513

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted PostScript file may lead to an unexpected application termination or arbitrary code execution

  Description: A stack buffer overflow exists in the handling of PostScript files. Viewing a maliciously crafted PostScript file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of PostScript files. On Mac OS X v10.6 systems this issue is mitigated by the -fstack-protector compiler flag. Credit: Apple.

* **QuickTime**

  CVE-ID: CVE-2010-0062

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A heap buffer overflow exists in QuickTime's handling of H.263 encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of H.263 encoded movie files. Credit to Damian Put and an anonymous researcher working with TippingPoint's Zero Day Initiative for reporting this issue.

* **QuickTime**

  CVE-ID: CVE-2010-0514

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A heap buffer overflow exists in the handling of H.261 encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of H.261 encoded movie files. Credit to Will Dormann of the CERT/CC for reporting this issue.

* **QuickTime**

  CVE-ID: CVE-2010-0515

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption in the handling of H.264 encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of H.264 encoded movie files. Credit to an anonymous researcher working with TippingPoint's Zero Day Initiative for reporting this issue.

* **QuickTime**

  CVE-ID: CVE-2010-0516

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A heap buffer overflow in the handling of RLE encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of RLE encoded movie files. Credit to an anonymous researcher working with TippingPoint's Zero Day Initiative for reporting this issue.

* **QuickTime**

  CVE-ID: CVE-2010-0517

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A heap buffer overflow in the handling of M-JPEG encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of M-JPEG encoded movie files. Credit to Damian Put and an anonymous researcher working with TippingPoint's Zero Day Initiative for reporting this issue.

* **QuickTime**

  CVE-ID: CVE-2010-0518

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue exists in the handling of Sorenson encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of Sorenson encoded movie files. Credit to Will Dormann of the CERT/CC for reporting this issue.

* **QuickTime**

  CVE-ID: CVE-2010-0519

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: An integer overflow exists in the handling of FlashPix encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. Credit to an anonymous researcher working with TippingPoint's Zero Day Initiative for reporting this issue.

* **QuickTime**

  CVE-ID: CVE-2010-0520

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A heap buffer overflow exists in the handling of FLC encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of FLC encoded movie files. Credit to Moritz Jodeit of n.runs AG, working with TippingPoint's Zero Day Initiative, and Nicolas Joly of VUPEN Security for reporting this issue.

* **QuickTime**

  CVE-ID: CVE-2010-0526

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted MPEG file may lead to an unexpected application termination or arbitrary code execution

  Description: A heap buffer overflow exists in the handling of MPEG encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of MPEG encoded movie files. Credit to an anonymous researcher working with TippingPoint's Zero Day Initiative for reporting this issue.

* **Ruby**

  CVE-ID: CVE-2009-2422, CVE-2009-3009, CVE-2009-4214

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Multiple issues in Ruby on Rails

  Description: Multiple vulnerabilities exist in Ruby on Rails, the most serious of which may lead to cross-site scripting. On Mac OS X v10.6 systems, these issues are addressed by updating Ruby on Rails to version 2.3.5. Mac OS X v10.5 systems are affected only by CVE-2009-4214, and this issue is addressed through improved validation of arguments to strip\_tags.

* **Ruby**

  CVE-ID: CVE-2009-1904

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Running a Ruby script that uses untrusted input to initialize a BigDecimal object may lead to an unexpected application termination

  Description: A stack exhaustion issue exists in Ruby's handling of BigDecimal objects with very large values. Running a Ruby script that uses untrusted input to initialize a BigDecimal object may lead to an unexpected application termination. For Mac OS X v10.6 systems, this issue is addressed by updating Ruby to version 1.8.7-p173. For Mac OS v10.5 systems, this issue is addressed by updating Ruby to version 1.8.6-p369.

* **Server Admin**

  CVE-ID: CVE-2010-0521

  Available for: Mac OS X Server v10.5.8, Mac OS X Server v10.6 through v10.6.2

  Impact: A remote attacker may extract information from Open Directory

  Description: A design issue exists in the handling of authenticated directory binding. A remote attacker may be able to anonymously extract information from Open Directory, even if the "Require authenticated binding between directory and clients" option is enabled. The issue is addressed by removing this configuration option. This issue only affects Mac OS X Server systems. Credit to Scott Gruby of Gruby Solutions, and Mathias Haack of GRAVIS Computervertriebsgesellschaft mbH for reporting this issue.

* **Server Admin**

  CVE-ID: CVE-2010-0522

  Available for: Mac OS X Server v10.5.8

  Impact: A former administrator may have unauthorized access to screen sharing

  Description: A user who is removed from the 'admin' group may still connect to the server using screen sharing. This issue is addressed through improved handling of administrator privileges. This issue only affects Mac OS X Server systems, and does not affect version 10.6 or later. Credit: Apple.

* **SMB**

  CVE-ID: CVE-2009-2906

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A remote attacker may be able to cause a denial of service

  Description: An infinite loop issue exists in Samba's handling of SMB 'oplock' break notifications. A remote attacker may be able to trigger an infinite loop in smbd, causing it to consume excessive CPU resources. The issue is addressed through improved handling of 'oplock' break notifications.

* **Tomcat**

  CVE-ID: CVE-2009-0580, CVE-2009-0033, CVE-2009-0783, CVE-2008-5515, CVE-2009-0781, CVE-2009-2901, CVE-2009-2902, CVE-2009-2693

  Available for: Mac OS X Server v10.5.8, Mac OS X Server v10.6 through v10.6.2

  Impact: Multiple vulnerabilities in Tomcat 6.0.18

  Description: Tomcat is updated to version 6.0.24 to address multiple vulnerabilities, the most serious of which may lead to a cross site scripting attack. Tomcat is only provided on Mac OS X Server systems. Further information is available via the Tomcat site at <http://tomcat.apache.org/>

* **unzip**

  CVE-ID: CVE-2008-0888

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: Extracting maliciously crafted zip files using the unzip command tool may lead to an unexpected application termination or code execution

  Description: An uninitialized pointer issue exists is the handling of zip files. Extracting maliciously crafted zip files using the unzip command tool may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of zip files. This issue does not affect Mac OS X v10.6 systems.

* **vim**

  CVE-ID: CVE-2008-2712, CVE-2008-4101, CVE-2009-0316

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: Multiple vulnerabilities in vim 7.0

  Description: Multiple vulnerabilities exist in vim 7.0, the most serious of which may lead to arbitrary code execution when working with maliciously crafted files. These issues are addressed by updating to vim 7.2.102. These issues do not affect Mac OS X v10.6 systems. Further information is available via the vim website at <http://www.vim.org/>

* **Wiki Server**

  CVE-ID: CVE-2010-0523

  Available for: Mac OS X Server v10.5.8

  Impact: Uploading a maliciously crafted applet may lead to the disclosure of sensitive information

  Description: Wiki Server allows users to upload active content such as Java applets. A remote attacker may obtain sensitive information by uploading a maliciously crafted applet and directing a Wiki Server user to view it. The issue is addressed by using a special one-time authentication cookie which is only useable to download a particular attachment. This issue only affects Mac OS X Server systems, and does not affect versions 10.6 or later.

* **Wiki Server**

  CVE-ID: CVE-2010-0534

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: An authenticated user may bypass weblog creation restrictions

  Description: Wiki Server supports service access control lists (SACLs), allowing an administrator to control the publication of content. Wiki Server fails to consult the weblog SACL during the creation of a user's weblog. This may allow an authenticated user to publish content to the Wiki Server, even though publication should be disallowed by the service ACL. This issue does not affect systems prior to Mac OS X v10.6.

* **X11**

  CVE-ID: CVE-2009-2042

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted image may lead to the disclosure of sensitive information

  Description: libpng is updated to version 1.2.37 to address an issue that may result in the disclosure of sensitive information. Further information is available via the libpng site at <http://www.libpng.org/pub/png/libpng.html>

* **X11**

  CVE-ID: CVE-2003-0063

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Displaying maliciously crafted data within an xterm terminal may lead to arbitrary code execution

  Description: The xterm program supports a command sequence to change the window title, and to print the window title to the terminal. The information returned is provided to the terminal as though it were keyboard input from the user. Within an xterm terminal, displaying maliciously crafted data containing such sequences may result in command injection. The issue is addressed by disabling the affected command sequence.

* **xar**

  CVE-ID: CVE-2010-0055

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: A modified package may appear as validly signed

  Description: A design issue exists in xar when validating a package signature. This may allow a modified package to appear as validly signed. This issue is fixed through improved package signature validation. This issue does not affect Mac OS X v10.6 systems. Credit: Apple.

**Important:** Mention of third-party websites and products is for informational purposes only and constitutes neither an endorsement nor a recommendation. Apple assumes no responsibility with regard to the selection, performance or use of information or products found at third-party websites. Apple provides this only as a convenience to our users. Apple has not tested the information found on these sites and makes no representations regarding its accuracy or reliability. There are risks inherent in the use of any information or products found on the Internet, and Apple assumes no responsibility in this regard. Please understand that a third-party site is independent from Apple and that Apple has no control over the content on that website. Please [contact the vendor](http://support.apple.com/kb/HT2693?viewlocale=en_US) for additional information.

Published Date: April 11, 2024

Helpful?

Yes

No

Character limit:
250

Maximum character limit is 250.

Please don’t include any personal information in your comment.
Submit

Thanks for your feedback.

## Apple Footer

[
Apple](https://www.apple.com)

1. [Support](https://support.apple.com)
2. About the security content of Security Update 2010-002 / Mac OS X v10.6.3

[United States](https://support.apple.com/en-us/104159/localeselector "Choose your country or region")

Copyright © 2025 Apple Inc. All rights reserved.
 [Privacy Policy](https://www.apple.com/legal/privacy/en-ww/) [Terms of Use](https://www.apple.com/legal/internet-services/terms/site.html) [Sales and Refunds](https://www.apple.com/shop/goto/help/sales_refunds) [Site Map](https://www.apple.com/sitemap/)



=== Content from security-tracker.debian.org_e3732558_20250126_005912.html ===

# CVE-2009-3086

| **Name** | CVE-2009-3086 |
| --- | --- |
| **Description** | A certain algorithm in Ruby on Rails 2.1.0 through 2.2.2, and 2.3.x before 2.3.4, leaks information about the complexity of message-digest signature verification in the cookie store, which might allow remote attackers to forge a digest via multiple attempts. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2009-3086) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2009-3086); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2009-3086), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2009-3086), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2009-3086), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2009-3086), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2009-3086), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2009-3086), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2009-3086), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2009-3086)/[CVE](https://www.suse.com/security/cve/CVE-2009-3086/), GitHub [advisories](https://github.com/advisories?query=CVE-2009-3086)/[code](https://github.com/search?type=Code&q=%22CVE-2009-3086%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2009-3086%22), [web search](https://duckduckgo.com/html?q=%22CVE-2009-3086%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DSA-2260-1](/tracker/DSA-2260-1) |
| **Debian Bugs** | [545063](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=545063) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [rails](/tracker/source-package/rails) ([PTS](https://tracker.debian.org/pkg/rails)) | bullseye (security), bullseye | 2:6.0.3.7+dfsg-2+deb11u2 | fixed |
|  | bookworm | 2:6.1.7.3+dfsg-2~deb12u1 | fixed |
|  | sid, trixie | 2:6.1.7.3+dfsg-6 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [rails](/tracker/source-package/rails) | source | lenny | 2.1.0-7+lenny0.2 |  | [DSA-2260-1](/tracker/DSA-2260-1) |  |
| [rails](/tracker/source-package/rails) | source | (unstable) | 2.2.3-1 | low |  | [545063](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=545063) |

## Notes

```
[etch] - rails <no-dsa> (Minor issue)

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from groups.google.com_0d05aedc_20250126_005906.html ===
>From b4115148c5175c986f5c21144b0e55c3ed7d9d0c Mon Sep 17 00:00:00 2001
From: Manfred Stienstra
Date: Wed, 26 Aug 2009 22:38:10 +0200
Subject: [PATCH] Add verify and clean methods to ActiveSupport::Multibyte.
When accepting character input from outside of your application you can't
blindly trust that all strings are properly encoded. With these methods
you can check incoming strings and clean them up if necessary.
Signed-off-by: Michael Koziarski
---
activesupport/lib/active\_support/multibyte.rb | 36 ++++-
.../lib/active\_support/multibyte/chars.rb | 23 +---
.../lib/active\_support/multibyte/utils.rb | 61 +++++++++
activesupport/test/multibyte\_utils\_test.rb | 141 ++++++++++++++++++++
4 files changed, 239 insertions(+), 22 deletions(-)
create mode 100644 activesupport/lib/active\_support/multibyte/utils.rb
create mode 100644 activesupport/test/multibyte\_utils\_test.rb
diff --git a/activesupport/lib/active\_support/multibyte.rb b/activesupport/lib/active\_support/multibyte.rb
index 65a96af..b6354ee 100644
--- a/activesupport/lib/active\_support/multibyte.rb
+++ b/activesupport/lib/active\_support/multibyte.rb
@@ -1,9 +1,5 @@
# encoding: utf-8
-require 'active\_support/multibyte/chars'
-require 'active\_support/multibyte/exceptions'
-require 'active\_support/multibyte/unicode\_database'
-
module ActiveSupport #:nodoc:
module Multibyte
# A list of all available normalization forms. See http://www.unicode.org/reports/tr15/tr15-29.html for more
@@ -27,7 +23,35 @@ module ActiveSupport #:nodoc:
#
# Example:
# ActiveSupport::Multibyte.proxy\_class = CharsForUTF32
- mattr\_accessor :proxy\_class
- self.proxy\_class = ActiveSupport::Multibyte::Chars
+ def self.proxy\_class=(klass)
+ @proxy\_class = klass
+ end
+
+ # Returns the currect proxy class
+ def self.proxy\_class
+ @proxy\_class ||= ActiveSupport::Multibyte::Chars
+ end
+
+ # Regular expressions that describe valid byte sequences for a character
+ VALID\_CHARACTER = {
+ # Borrowed from the Kconv library by Shinji KONO - (also as seen on the W3C site)
+ 'UTF-8' => /\A(?:
+ [\x00-\x7f] |
+ [\xc2-\xdf] [\x80-\xbf] |
+ \xe0 [\xa0-\xbf] [\x80-\xbf] |
+ [\xe1-\xef] [\x80-\xbf] [\x80-\xbf] |
+ \xf0 [\x90-\xbf] [\x80-\xbf] [\x80-\xbf] |
+ [\xf1-\xf3] [\x80-\xbf] [\x80-\xbf] [\x80-\xbf] |
+ \xf4 [\x80-\x8f] [\x80-\xbf] [\x80-\xbf])\z /xn,
+ # Quick check for valid Shift-JIS characters, disregards the odd-even pairing
+ 'Shift\_JIS' => /\A(?:
+ [\x00-\x7e \xa1-\xdf] |
+ [\x81-\x9f \xe0-\xef] [\x40-\x7e \x80-\x9e \x9f-\xfc])\z /xn
+ }
end
end
+
+require 'active\_support/multibyte/chars'
+require 'active\_support/multibyte/exceptions'
+require 'active\_support/multibyte/unicode\_database'
+require 'active\_support/multibyte/utils'
diff --git a/activesupport/lib/active\_support/multibyte/chars.rb b/activesupport/lib/active\_support/multibyte/chars.rb
index 3d392d2..16bc130 100644
--- a/activesupport/lib/active\_support/multibyte/chars.rb
+++ b/activesupport/lib/active\_support/multibyte/chars.rb
@@ -73,16 +73,7 @@ module ActiveSupport #:nodoc:
UNICODE\_TRAILERS\_PAT = /(#{codepoints\_to\_pattern(UNICODE\_LEADERS\_AND\_TRAILERS)})+\Z/
UNICODE\_LEADERS\_PAT = /\A(#{codepoints\_to\_pattern(UNICODE\_LEADERS\_AND\_TRAILERS)})+/
- # Borrowed from the Kconv library by Shinji KONO - (also as seen on the W3C site)
- UTF8\_PAT = /\A(?:
- [\x00-\x7f] |
- [\xc2-\xdf] [\x80-\xbf] |
- \xe0 [\xa0-\xbf] [\x80-\xbf] |
- [\xe1-\xef] [\x80-\xbf] [\x80-\xbf] |
- \xf0 [\x90-\xbf] [\x80-\xbf] [\x80-\xbf] |
- [\xf1-\xf3] [\x80-\xbf] [\x80-\xbf] [\x80-\xbf] |
- \xf4 [\x80-\x8f] [\x80-\xbf] [\x80-\xbf]
- )\*\z/xn
+ UTF8\_PAT = ActiveSupport::Multibyte::VALID\_CHARACTER['UTF-8']
attr\_reader :wrapped\_string
alias to\_s wrapped\_string
@@ -307,23 +298,23 @@ module ActiveSupport #:nodoc:
def rstrip
chars(@wrapped\_string.gsub(UNICODE\_TRAILERS\_PAT, ''))
end
-
+
# Strips entire range of Unicode whitespace from the left of the string.
def lstrip
chars(@wrapped\_string.gsub(UNICODE\_LEADERS\_PAT, ''))
end
-
+
# Strips entire range of Unicode whitespace from the right and left of the string.
def strip
rstrip.lstrip
end
-
+
# Returns the number of codepoints in the string
def size
self.class.u\_unpack(@wrapped\_string).size
end
alias\_method :length, :size
-
+
# Reverses all characters in the string.
#
# Example:
@@ -331,7 +322,7 @@ module ActiveSupport #:nodoc:
def reverse
chars(self.class.u\_unpack(@wrapped\_string).reverse.pack('U\*'))
end
-
+
# Implements Unicode-aware slice with codepoints. Slicing on one point returns the codepoints for that
# character.
#
@@ -646,7 +637,7 @@ module ActiveSupport #:nodoc:
string.split(//u).map do |c|
c.force\_encoding(Encoding::ASCII) if c.respond\_to?(:force\_encoding)
- if !UTF8\_PAT.match(c)
+ if !ActiveSupport::Multibyte::VALID\_CHARACTER['UTF-8'].match(c)
n = c.unpack('C')[0]
n < 128 ? n.chr :
n < 160 ? [UCD.cp1252[n] || n].pack('U') :
diff --git a/activesupport/lib/active\_support/multibyte/utils.rb b/activesupport/lib/active\_support/multibyte/utils.rb
new file mode 100644
index 0000000..acef84d
--- /dev/null
+++ b/activesupport/lib/active\_support/multibyte/utils.rb
@@ -0,0 +1,61 @@
+# encoding: utf-8
+
+module ActiveSupport #:nodoc:
+ module Multibyte #:nodoc:
+ if Kernel.const\_defined?(:Encoding)
+ # Returns a regular expression that matches valid characters in the current encoding
+ def self.valid\_character
+ VALID\_CHARACTER[Encoding.default\_internal.to\_s]
+ end
+ else
+ def self.valid\_character
+ case $KCODE
+ when 'UTF8'
+ VALID\_CHARACTER['UTF-8']
+ when 'SJIS'
+ VALID\_CHARACTER['Shift\_JIS']
+ end
+ end
+ end
+
+ if 'string'.respond\_to?(:valid\_encoding?)
+ # Verifies the encoding of a string
+ def self.verify(string)
+ string.valid\_encoding?
+ end
+ else
+ def self.verify(string)
+ if expression = valid\_character
+ for c in string.split(//)
+ return false unless valid\_character.match(c)
+ end
+ end
+ true
+ end
+ end
+
+ # Verifies the encoding of the string and raises an exception when it's not valid
+ def self.verify!(string)
+ raise EncodingError.new("Found characters with invalid encoding") unless verify(string)
+ end
+
+ if 'string'.respond\_to?(:force\_encoding)
+ # Removes all invalid characters from the string.
+ #
+ # Note: this method is a no-op in Ruby 1.9
+ def self.clean(string)
+ string
+ end
+ else
+ def self.clean(string)
+ if expression = valid\_character
+ stripped = []; for c in string.split(//)
+ stripped << c if valid\_character.match(c)
+ end; stripped.join
+ else
+ string
+ end
+ end
+ end
+ end
+end
\ No newline at end of file
diff --git a/activesupport/test/multibyte\_utils\_test.rb b/activesupport/test/multibyte\_utils\_test.rb
new file mode 100644
index 0000000..d8ac5ff
--- /dev/null
+++ b/activesupport/test/multibyte\_utils\_test.rb
@@ -0,0 +1,141 @@
+# encoding: utf-8
+
+require 'abstract\_unit'
+require 'multibyte\_test\_helpers'
+
+class MultibyteUtilsTest < ActiveSupport::TestCase
+ include MultibyteTestHelpers
+
+ test "valid\_character returns an expression for the current encoding" do
+ with\_encoding('None') do
+ assert\_nil ActiveSupport::Multibyte.valid\_character
+ end
+ with\_encoding('UTF8') do
+ assert\_equal ActiveSupport::Multibyte::VALID\_CHARACTER['UTF-8'], ActiveSupport::Multibyte.valid\_character
+ end
+ with\_encoding('SJIS') do
+ assert\_equal ActiveSupport::Multibyte::VALID\_CHARACTER['Shift\_JIS'], ActiveSupport::Multibyte.valid\_character
+ end
+ end
+
+ test "verify verifies ASCII strings are properly encoded" do
+ with\_encoding('None') do
+ examples.each do |example|
+ assert ActiveSupport::Multibyte.verify(example)
+ end
+ end
+ end
+
+ test "verify verifies UTF-8 strings are properly encoded" do
+ with\_encoding('UTF8') do
+ assert ActiveSupport::Multibyte.verify(example('valid UTF-8'))
+ assert !ActiveSupport::Multibyte.verify(example('invalid UTF-8'))
+ end
+ end
+
+ test "verify verifies Shift-JIS strings are properly encoded" do
+ with\_encoding('SJIS') do
+ assert ActiveSupport::Multibyte.verify(example('valid Shift-JIS'))
+ assert !ActiveSupport::Multibyte.verify(example('invalid Shift-JIS'))
+ end
+ end
+
+ test "verify! raises an exception when it finds an invalid character" do
+ with\_encoding('UTF8') do
+ assert\_raises(ActiveSupport::Multibyte::EncodingError) do
+ ActiveSupport::Multibyte.verify!(example('invalid UTF-8'))
+ end
+ end
+ end
+
+ test "verify! doesn't raise an exception when the encoding is valid" do
+ with\_encoding('UTF8') do
+ assert\_nothing\_raised do
+ ActiveSupport::Multibyte.verify!(example('valid UTF-8'))
+ end
+ end
+ end
+
+ if RUBY\_VERSION < '1.9'
+ test "clean leaves ASCII strings intact" do
+ with\_encoding('None') do
+ [
+ 'word', "\270\236\010\210\245"
+ ].each do |string|
+ assert\_equal string, ActiveSupport::Multibyte.clean(string)
+ end
+ end
+ end
+
+ test "clean cleans invalid characters from UTF-8 encoded strings" do
+ with\_encoding('UTF8') do
+ cleaned\_utf8 = [8].pack('C\*')
+ assert\_equal example('valid UTF-8'), ActiveSupport::Multibyte.clean(example('valid UTF-8'))
+ assert\_equal cleaned\_utf8, ActiveSupport::Multibyte.clean(example('invalid UTF-8'))
+ end
+ end
+
+ test "clean cleans invalid characters from Shift-JIS encoded strings" do
+ with\_encoding('SJIS') do
+ cleaned\_sjis = [184, 0, 136, 165].pack('C\*')
+ assert\_equal example('valid Shift-JIS'), ActiveSupport::Multibyte.clean(example('valid Shift-JIS'))
+ assert\_equal cleaned\_sjis, ActiveSupport::Multibyte.clean(example('invalid Shift-JIS'))
+ end
+ end
+ else
+ test "clean is a no-op" do
+ with\_encoding('UTF8') do
+ assert\_equal example('invalid Shift-JIS'), ActiveSupport::Multibyte.clean(example('invalid Shift-JIS'))
+ end
+ end
+ end
+
+ private
+
+ STRINGS = {
+ 'valid ASCII' => [65, 83, 67, 73, 73].pack('C\*'),
+ 'invalid ASCII' => [128].pack('C\*'),
+ 'valid UTF-8' => [227, 129, 147, 227, 129, 171, 227, 129, 161, 227, 130, 143].pack('C\*'),
+ 'invalid UTF-8' => [184, 158, 8, 136, 165].pack('C\*'),
+ 'valid Shift-JIS' => [131, 122, 129, 91, 131, 128].pack('C\*'),
+ 'invalid Shift-JIS' => [184, 158, 8, 0, 255, 136, 165].pack('C\*')
+ }
+
+ if Kernel.const\_defined?(:Encoding)
+ def example(key)
+ STRINGS[key].force\_encoding(Encoding.default\_internal)
+ end
+
+ def examples
+ STRINGS.values.map { |s| s.force\_encoding(Encoding.default\_internal) }
+ end
+ else
+ def example(key)
+ STRINGS[key]
+ end
+
+ def examples
+ STRINGS.values
+ end
+ end
+
+ if 'string'.respond\_to?(:encoding)
+ def with\_encoding(enc)
+ before = Encoding.default\_internal
+
+ case enc
+ when 'UTF8'
+ Encoding.default\_internal = Encoding::UTF\_8
+ when 'SJIS'
+ Encoding.default\_internal = Encoding::Shift\_JIS
+ else
+ Encoding.default\_internal = Encoding::BINARY
+ end
+ yield
+
+ Encoding.default\_internal = before
+ end
+ else
+ alias with\_encoding with\_kcode
+ end
+end
\ No newline at end of file
--
1.6.0.1
>From b066ffe93fb88af3b1e4795783bb71a7b8095ac5 Mon Sep 17 00:00:00 2001
From: Michael Koziarski
Date: Mon, 31 Aug 2009 12:07:30 -0700
Subject: [PATCH] Clean tag attributes before passing through the escape\_once logic.
Addresses CVE-2009-3009
---
actionpack/lib/action\_view/helpers/tag\_helper.rb | 2 +-
1 files changed, 1 insertions(+), 1 deletions(-)
diff --git a/actionpack/lib/action\_view/helpers/tag\_helper.rb b/actionpack/lib/action\_view/helpers/tag\_helper.rb
index af8c4d5..db99a0e 100644
--- a/actionpack/lib/action\_view/helpers/tag\_helper.rb
+++ b/actionpack/lib/action\_view/helpers/tag\_helper.rb
@@ -103,7 +103,7 @@ module ActionView
# escape\_once("<< Accept & Checkout")
# # => "<< Accept & Checkout"
def escape\_once(html)
- html.to\_s.gsub(/[\"><]|&(?!([a-zA-Z]+|(#\d+));)/) { |special| ERB::Util::HTML\_ESCAPE[special] }
+ ActiveSupport::Multibyte.clean(html.to\_s).gsub(/[\"><]|&(?!([a-zA-Z]+|(#\d+));)/) { |special| ERB::Util::HTML\_ESCAPE[special] }
end
private
--
1.6.0.1


=== Content from groups.google.com_afe08c0a_20250126_005908.html ===
>From e31d29fae766daa358ed6e6bf278e75b95a317d3 Mon Sep 17 00:00:00 2001
From: Manfred Stienstra
Date: Tue, 1 Sep 2009 20:16:11 +0200
Subject: [PATCH] Add methods for string verification and encoding cleanup code.
Signed-off-by: Michael Koziarski
---
activesupport/lib/active\_support/multibyte.rb | 18 ++++
.../multibyte/handlers/utf8\_handler.rb | 13 +--
.../lib/active\_support/multibyte/utils.rb | 39 +++++++
activesupport/test/multibyte\_utils\_test.rb | 106 ++++++++++++++++++++
4 files changed, 165 insertions(+), 11 deletions(-)
create mode 100644 activesupport/lib/active\_support/multibyte/utils.rb
create mode 100644 activesupport/test/multibyte\_utils\_test.rb
diff --git a/activesupport/lib/active\_support/multibyte.rb b/activesupport/lib/active\_support/multibyte.rb
index 27c0d18..f76cfba 100644
--- a/activesupport/lib/active\_support/multibyte.rb
+++ b/activesupport/lib/active\_support/multibyte.rb
@@ -3,7 +3,25 @@ module ActiveSupport
DEFAULT\_NORMALIZATION\_FORM = :kc
NORMALIZATIONS\_FORMS = [:c, :kc, :d, :kd]
UNICODE\_VERSION = '5.0.0'
+
+ # Regular expressions that describe valid byte sequences for a character
+ VALID\_CHARACTER = {
+ # Borrowed from the Kconv library by Shinji KONO - (also as seen on the W3C site)
+ 'UTF-8' => /\A(?:
+ [\x00-\x7f] |
+ [\xc2-\xdf] [\x80-\xbf] |
+ \xe0 [\xa0-\xbf] [\x80-\xbf] |
+ [\xe1-\xef] [\x80-\xbf] [\x80-\xbf] |
+ \xf0 [\x90-\xbf] [\x80-\xbf] [\x80-\xbf] |
+ [\xf1-\xf3] [\x80-\xbf] [\x80-\xbf] [\x80-\xbf] |
+ \xf4 [\x80-\x8f] [\x80-\xbf] [\x80-\xbf])\z /xn,
+ # Quick check for valid Shift-JIS characters, disregards the odd-even pairing
+ 'Shift\_JIS' => /\A(?:
+ [\x00-\x7e \xa1-\xdf] |
+ [\x81-\x9f \xe0-\xef] [\x40-\x7e \x80-\x9e \x9f-\xfc])\z /xn
+ }
end
end
require 'active\_support/multibyte/chars'
+require 'active\_support/multibyte/utils'
\ No newline at end of file
diff --git a/activesupport/lib/active\_support/multibyte/handlers/utf8\_handler.rb b/activesupport/lib/active\_support/multibyte/handlers/utf8\_handler.rb
index 66fe47a..f95349e 100644
--- a/activesupport/lib/active\_support/multibyte/handlers/utf8\_handler.rb
+++ b/activesupport/lib/active\_support/multibyte/handlers/utf8\_handler.rb
@@ -100,16 +100,7 @@ module ActiveSupport::Multibyte::Handlers #:nodoc:
# between little and big endian. This is not an issue in utf-8, so it must be ignored.
UNICODE\_LEADERS\_AND\_TRAILERS = UNICODE\_WHITESPACE + [65279] # ZERO-WIDTH NO-BREAK SPACE aka BOM
- # Borrowed from the Kconv library by Shinji KONO - (also as seen on the W3C site)
- UTF8\_PAT = /\A(?:
- [\x00-\x7f] |
- [\xc2-\xdf] [\x80-\xbf] |
- \xe0 [\xa0-\xbf] [\x80-\xbf] |
- [\xe1-\xef] [\x80-\xbf] [\x80-\xbf] |
- \xf0 [\x90-\xbf] [\x80-\xbf] [\x80-\xbf] |
- [\xf1-\xf3] [\x80-\xbf] [\x80-\xbf] [\x80-\xbf] |
- \xf4 [\x80-\x8f] [\x80-\xbf] [\x80-\xbf]
- )\*\z/xn
+ UTF8\_PAT = ActiveSupport::Multibyte::VALID\_CHARACTER['UTF-8']
# Returns a regular expression pattern that matches the passed Unicode codepoints
def self.codepoints\_to\_pattern(array\_of\_codepoints) #:nodoc:
@@ -357,7 +348,7 @@ module ActiveSupport::Multibyte::Handlers #:nodoc:
# Replaces all the non-utf-8 bytes by their iso-8859-1 or cp1252 equivalent resulting in a valid utf-8 string
def tidy\_bytes(str)
str.split(//u).map do |c|
- if !UTF8\_PAT.match(c)
+ if !ActiveSupport::Multibyte::VALID\_CHARACTER['UTF-8'].match(c)
n = c.unpack('C')[0]
n < 128 ? n.chr :
n < 160 ? [UCD.cp1252[n] || n].pack('U') :
diff --git a/activesupport/lib/active\_support/multibyte/utils.rb b/activesupport/lib/active\_support/multibyte/utils.rb
new file mode 100644
index 0000000..094e856
--- /dev/null
+++ b/activesupport/lib/active\_support/multibyte/utils.rb
@@ -0,0 +1,39 @@
+module ActiveSupport #:nodoc:
+ module Multibyte #:nodoc:
+ # Returns a regular expression that matches valid characters in the current encoding
+ def self.valid\_character
+ case $KCODE
+ when 'UTF8'
+ VALID\_CHARACTER['UTF-8']
+ when 'SJIS'
+ VALID\_CHARACTER['Shift\_JIS']
+ end
+ end
+
+ # Verifies the encoding of a string
+ def self.verify(string)
+ if expression = valid\_character
+ for c in string.split(//)
+ return false unless valid\_character.match(c)
+ end
+ end
+ true
+ end
+
+ # Verifies the encoding of the string and raises an exception when it's not valid
+ def self.verify!(string)
+ raise ActiveSupport::Multibyte::Handlers::EncodingError.new("Found characters with invalid encoding") unless verify(string)
+ end
+
+ # Removes all invalid characters from the string
+ def self.clean(string)
+ if expression = valid\_character
+ stripped = []; for c in string.split(//)
+ stripped << c if valid\_character.match(c)
+ end; stripped.join
+ else
+ string
+ end
+ end
+ end
+end
\ No newline at end of file
diff --git a/activesupport/test/multibyte\_utils\_test.rb b/activesupport/test/multibyte\_utils\_test.rb
new file mode 100644
index 0000000..a4bcfc8
--- /dev/null
+++ b/activesupport/test/multibyte\_utils\_test.rb
@@ -0,0 +1,106 @@
+require 'abstract\_unit'
+
+class MultibyteUtilsTest < Test::Unit::TestCase
+
+ def test\_valid\_character\_returns\_an\_expression\_for\_the\_current\_encoding
+ with\_kcode('None') do
+ assert\_nil ActiveSupport::Multibyte.valid\_character
+ end
+ with\_kcode('UTF8') do
+ assert\_equal ActiveSupport::Multibyte::VALID\_CHARACTER['UTF-8'], ActiveSupport::Multibyte.valid\_character
+ end
+ with\_kcode('SJIS') do
+ assert\_equal ActiveSupport::Multibyte::VALID\_CHARACTER['Shift\_JIS'], ActiveSupport::Multibyte.valid\_character
+ end
+ end
+
+ def test\_verify\_verifies\_ASCII\_strings\_are\_properly\_encoded
+ with\_kcode('None') do
+ examples.each do |example|
+ assert ActiveSupport::Multibyte.verify(example)
+ end
+ end
+ end
+
+ def test\_verify\_verifies\_UTF\_8\_strings\_are\_properly\_encoded
+ with\_kcode('UTF8') do
+ assert ActiveSupport::Multibyte.verify(example('valid UTF-8'))
+ assert !ActiveSupport::Multibyte.verify(example('invalid UTF-8'))
+ end
+ end
+
+ def test\_verify\_verifies\_Shift\_JIS\_strings\_are\_properly\_encoded
+ with\_kcode('SJIS') do
+ assert ActiveSupport::Multibyte.verify(example('valid Shift-JIS'))
+ assert !ActiveSupport::Multibyte.verify(example('invalid Shift-JIS'))
+ end
+ end
+
+ def test\_verify\_bang\_raises\_an\_exception\_when\_it\_finds\_an\_invalid\_character
+ with\_kcode('UTF8') do
+ assert\_raises(ActiveSupport::Multibyte::Handlers::EncodingError) do
+ ActiveSupport::Multibyte.verify!(example('invalid UTF-8'))
+ end
+ end
+ end
+
+ def test\_verify\_bang\_doesnt\_raise\_an\_exception\_when\_the\_encoding\_is\_valid
+ with\_kcode('UTF8') do
+ assert\_nothing\_raised do
+ ActiveSupport::Multibyte.verify!(example('valid UTF-8'))
+ end
+ end
+ end
+
+ def test\_clean\_leaves\_ASCII\_strings\_intact
+ with\_kcode('None') do
+ [
+ 'word', "\270\236\010\210\245"
+ ].each do |string|
+ assert\_equal string, ActiveSupport::Multibyte.clean(string)
+ end
+ end
+ end
+
+ def test\_clean\_cleans\_invalid\_characters\_from\_UTF\_8\_encoded\_strings
+ with\_kcode('UTF8') do
+ cleaned\_utf8 = [8].pack('C\*')
+ assert\_equal example('valid UTF-8'), ActiveSupport::Multibyte.clean(example('valid UTF-8'))
+ assert\_equal cleaned\_utf8, ActiveSupport::Multibyte.clean(example('invalid UTF-8'))
+ end
+ end
+
+ def test\_clean\_cleans\_invalid\_characters\_from\_Shift\_JIS\_encoded\_strings
+ with\_kcode('SJIS') do
+ cleaned\_sjis = [184, 0, 136, 165].pack('C\*')
+ assert\_equal example('valid Shift-JIS'), ActiveSupport::Multibyte.clean(example('valid Shift-JIS'))
+ assert\_equal cleaned\_sjis, ActiveSupport::Multibyte.clean(example('invalid Shift-JIS'))
+ end
+ end
+
+ private
+
+ STRINGS = {
+ 'valid ASCII' => [65, 83, 67, 73, 73].pack('C\*'),
+ 'invalid ASCII' => [128].pack('C\*'),
+ 'valid UTF-8' => [227, 129, 147, 227, 129, 171, 227, 129, 161, 227, 130, 143].pack('C\*'),
+ 'invalid UTF-8' => [184, 158, 8, 136, 165].pack('C\*'),
+ 'valid Shift-JIS' => [131, 122, 129, 91, 131, 128].pack('C\*'),
+ 'invalid Shift-JIS' => [184, 158, 8, 0, 255, 136, 165].pack('C\*')
+ }
+
+ def example(key)
+ STRINGS[key]
+ end
+
+ def examples
+ STRINGS.values
+ end
+
+ def with\_kcode(code)
+ before = $KCODE
+ $KCODE = code
+ yield
+ $KCODE = before
+ end
+end
\ No newline at end of file
--
1.6.0.1
>From 5b8b41732f385131d4e1f1a8862d71f44dcc992d Mon Sep 17 00:00:00 2001
From: Michael Koziarski
Date: Mon, 31 Aug 2009 12:07:30 -0700
Subject: [PATCH] Clean tag attributes before passing through the escape\_once logic.
Addresses CVE-2009-3009
---
actionpack/lib/action\_view/helpers/tag\_helper.rb | 2 +-
1 files changed, 1 insertions(+), 1 deletions(-)
diff --git a/actionpack/lib/action\_view/helpers/tag\_helper.rb b/actionpack/lib/action\_view/helpers/tag\_helper.rb
index 999cbfb..bde5581 100644
--- a/actionpack/lib/action\_view/helpers/tag\_helper.rb
+++ b/actionpack/lib/action\_view/helpers/tag\_helper.rb
@@ -99,7 +99,7 @@ module ActionView
# escape\_once("<< Accept & Checkout")
# # => "<< Accept & Checkout"
def escape\_once(html)
- html.to\_s.gsub(/[\"><]|&(?!([a-zA-Z]+|(#\d+));)/) { |special| ERB::Util::HTML\_ESCAPE[special] }
+ ActiveSupport::Multibyte.clean(html.to\_s).gsub(/[\"><]|&(?!([a-zA-Z]+|(#\d+));)/) { |special| ERB::Util::HTML\_ESCAPE[special] }
end
private
--
1.6.0.1


=== Content from bugs.debian.org_b09634d1_20250124_120214.html ===

# Debian Bug report logs - #545063 Security fixes (incl. CVE-2009-3009)

[![version graph](version.cgi?absolute=0;fixed=rails%2F2.2.3-1;collapse=1;package=rails;height=2;width=2)](version.cgi?package=rails;collapse=1;info=1;fixed=rails%2F2.2.3-1;absolute=0)

Package:
[rails](pkgreport.cgi?package=rails);
Maintainer for [rails](pkgreport.cgi?package=rails) is [Debian Ruby Team <pkg-ruby-extras-maintainers@lists.alioth.debian.org>](pkgreport.cgi?maint=pkg-ruby-extras-maintainers%40lists.alioth.debian.org); Source for [rails](pkgreport.cgi?package=rails) is [src:rails](pkgreport.cgi?src=rails) ([PTS](https://tracker.debian.org/pkg/rails), [buildd](https://buildd.debian.org/rails), [popcon](https://qa.debian.org/popcon.php?package=rails)).

Reported by: [Jan Lühr <yanosz@gmx.net>](pkgreport.cgi?submitter=yanosz%40gmx.net)

Date: Fri, 4 Sep 2009 18:18:01 UTC

Severity: *grave*

Tags: security

Fixed in version rails/2.2.3-1

**Done:** Adam Majer <adamm@zombino.com>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=545063;mbox=yes), [status mbox](bugreport.cgi?bug=545063;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=545063;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Adam Majer <adamm@zombino.com>`:

`Bug#545063`; Package `rails`.
(Fri, 04 Sep 2009 18:18:05 GMT) ([full text](bugreport.cgi?bug=545063;msg=2), [mbox](bugreport.cgi?bug=545063;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Jan Lühr <yanosz@gmx.net>`:

New Bug report received and forwarded. Copy sent to `Adam Majer <adamm@zombino.com>`.

Your message had a Version: pseudo-header with an invalid package
version:

2.1, 2.2

please either use found or fixed to the control server with a correct
version, or reply to this report indicating the correct version so the
maintainer (or someone else) can correct it for you.

(Fri, 04 Sep 2009 18:18:05 GMT) ([full text](bugreport.cgi?bug=545063;msg=4), [mbox](bugreport.cgi?bug=545063;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=545063;msg=5), [mbox](bugreport.cgi?bug=545063;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=yanosz%40gmx.net)
From: Jan Lühr <yanosz@gmx.net>
To: submit@bugs.debian.org
Subject: Security fixes (incl. CVE-2009-3009)
Date: Fri, 4 Sep 2009 20:08:23 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=545063;msg=5) (text/plain, inline)]
```
```
Package: rails
Version: 2.1, 2.2
Tags: security
Severity: grave

Rails in stable and testing are probably affected by:
<http://weblog.rubyonrails.org/2009/9/4/xss-vulnerability-in-ruby-on-rails>
<http://weblog.rubyonrails.org/2009/9/4/timing-weakness-in-ruby-on-rails>

Fixes have been released today.

Keep smiling
yanosz

```
```
[[signature.asc](bugreport.cgi?att=1;bug=545063;filename=signature.asc;msg=5) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Adam Majer <adamm@zombino.com>`:

`Bug#545063`; Package `rails`.
(Thu, 10 Sep 2009 08:48:04 GMT) ([full text](bugreport.cgi?bug=545063;msg=7), [mbox](bugreport.cgi?bug=545063;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Giuseppe Iuculano <giuseppe@iuculano.it>`:

Extra info received and forwarded to list. Copy sent to `Adam Majer <adamm@zombino.com>`.
(Thu, 10 Sep 2009 08:48:04 GMT) ([full text](bugreport.cgi?bug=545063;msg=9), [mbox](bugreport.cgi?bug=545063;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 545063@bugs.debian.org ([full text](bugreport.cgi?bug=545063;msg=10), [mbox](bugreport.cgi?bug=545063;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=giuseppe%40iuculano.it)
From: Giuseppe Iuculano <giuseppe@iuculano.it>
To: Debian Bug Tracking System <545063@bugs.debian.org>
Subject: CVE-2009-3086 CVE-2009-3009
Date: Thu, 10 Sep 2009 10:30:38 +0200
```
Package: rails

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi,
the following CVE (Common Vulnerabilities & Exposures) ids were
published for rails.

[CVE-2009-3086](https://security-tracker.debian.org/tracker/CVE-2009-3086)[0]:
| A certain algorithm in Ruby on Rails 2.1.0 through 2.2.2, and 2.3.x
| before 2.3.4, leaks information about the complexity of message-digest
| signature verification in the cookie store, which might allow remote
| attackers to forge a digest via multiple attempts.

[CVE-2009-3009](https://security-tracker.debian.org/tracker/CVE-2009-3009)[1]:
| Cross-site scripting (XSS) vulnerability in Ruby on Rails 2.x before
| 2.2.3, and 2.3.x before 2.3.4, allows remote attackers to inject
| arbitrary web script or HTML by placing malformed Unicode strings into
| a form helper.

If you fix the vulnerabilities please also make sure to include the
CVE ids in your changelog entry.

For further information see:

[0] <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3086>
    <http://security-tracker.debian.net/tracker/CVE-2009-3086>
[1] <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3009>
    <http://security-tracker.debian.net/tracker/CVE-2009-3009>

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iEYEARECAAYFAkqouSsACgkQNxpp46476ao1ZQCaAil8vKbQ/JQGNc+DBApQl3eW
89wAnjuPfrGmejg7FLzABM88h/n4rdpa
=OeAa
-----END PGP SIGNATURE-----

```

---

**Reply sent**
to `Adam Majer <adamm@zombino.com>`:

You have taken responsibility.
(Fri, 11 Sep 2009 22:54:11 GMT) ([full text](bugreport.cgi?bug=545063;msg=12), [mbox](bugreport.cgi?bug=545063;mbox=yes;msg=12), [link](#11)).

---

**Notification sent**
to `Jan Lühr <yanosz@gmx.net>`:

Bug acknowledged by developer.
(Fri, 11 Sep 2009 22:54:11 GMT) ([full text](bugreport.cgi?bug=545063;msg=14), [mbox](bugreport.cgi?bug=545063;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 545063-close@bugs.debian.org ([full text](bugreport.cgi?bug=545063;msg=15), [mbox](bugreport.cgi?bug=545063;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=adamm%40zombino.com)
From: Adam Majer <adamm@zombino.com>
To: 545063-close@bugs.debian.org
Subject: Bug#545063: fixed in rails 2.2.3-1
Date: Fri, 11 Sep 2009 22:38:20 +0000
```
Source: rails
Source-Version: 2.2.3-1

We believe that the bug you reported is fixed in the latest version of
rails, which is due to be installed in the Debian FTP archive:

rails_2.2.3-1.diff.gz
  to pool/main/r/rails/rails_2.2.3-1.diff.gz
rails_2.2.3-1.dsc
  to pool/main/r/rails/rails_2.2.3-1.dsc
rails_2.2.3-1_all.deb
  to pool/main/r/rails/rails_2.2.3-1_all.deb
rails_2.2.3.orig.tar.gz
  to pool/main/r/rails/rails_2.2.3.orig.tar.gz

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 545063@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Adam Majer <adamm@zombino.com> (supplier of updated rails package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Fri, 11 Sep 2009 13:53:42 -0500
Source: rails
Binary: rails
Architecture: source all
Version: 2.2.3-1
Distribution: unstable
Urgency: high
Maintainer: Adam Majer <adamm@zombino.com>
Changed-By: Adam Majer <adamm@zombino.com>
Description:
 rails      - MVC ruby based framework geared for web application development
Closes: [538982](bugreport.cgi?bug=538982) [545063](bugreport.cgi?bug=545063)
Changes:
 rails (2.2.3-1) unstable; urgency=high
 .
   * New upstream release (closes: #[545063](bugreport.cgi?bug=545063))
     + Fixes XSS security hole [[CVE-2009-3009](https://security-tracker.debian.org/tracker/CVE-2009-3009)]
     + Fixes timing issue with cookie store [[CVE-2009-3086](https://security-tracker.debian.org/tracker/CVE-2009-3086)]
   * Remove dependency on ruby-dbi, as it is not required by any of the
     sources.
   * Correct dependency on fixed libxml-simple-ruby to 1.0.11-2 or later
     (closes: #[538982](bugreport.cgi?bug=538982))
   * debian/control
     + Change section from web to ruby
     + Updated to debhelper 7.0+
     + Standards updated to 3.8.3 - no changes
Checksums-Sha1:
 c103547f2fb632f4aa9e2807121ba0bd7c36b22a 1252 rails_2.2.3-1.dsc
 4e092e34beeebe376b204f75dc6d5364364c0314 3042735 rails_2.2.3.orig.tar.gz
 90125f29d38e20fe649769f73de732b211ab3fbb 13592 rails_2.2.3-1.diff.gz
 0eee5721fb52aac2bc0c65e2f050abafe7998a50 3437430 rails_2.2.3-1_all.deb
Checksums-Sha256:
 9eb7c66982db8288c87e118687c486dbc56e7557cf1b61b06c71761d11f0a4fd 1252 rails_2.2.3-1.dsc
 c79b0690d8079bea4fab3c7f01c73b5cc1bf6678d967c740ed0aac61789e8ba7 3042735 rails_2.2.3.orig.tar.gz
 5948a2f87d3ef6cb235a3d05144eebeaa076d0258b9c7ea47d79a8977d9df161 13592 rails_2.2.3-1.diff.gz
 b0e3093dff6014b049e400aa6e61daf5c551012dcba476553f715e2586b6bffa 3437430 rails_2.2.3-1_all.deb
Files:
 c7d28306e5a8626342d3b0a829bd0366 1252 ruby optional rails_2.2.3-1.dsc
 56640ae2ce3e5a8fd4eafd7617b6cb74 3042735 ruby optional rails_2.2.3.orig.tar.gz
 927f5aa729f0c56d4f33a29ac88e0555 13592 ruby optional rails_2.2.3-1.diff.gz
 7934c6fa9c8f39fd9a58e5e5b6259510 3437430 ruby optional rails_2.2.3-1_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iEYEARECAAYFAkqqt98ACgkQ73/bNdaAYUWPdQCffEOYh47f1HxRdySp1cXJjO9n
NysAn070ju1bHpbnbc1H/WOUtZisUZaF
=blp3
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Mon, 12 Oct 2009 07:38:12 GMT) ([full text](bugreport.cgi?bug=545063;msg=17), [mbox](bugreport.cgi?bug=545063;mbox=yes;msg=17), [link](#16)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=545063).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 12:02:14 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from www.debian.org_72af743a_20250124_120220.html ===


---

[[Date Prev](msg00207.html)][[Date Next](msg00209.html)]
[[Thread Prev](msg00207.html)][[Thread Next](msg00209.html)]
[[Date Index](maillist.html#00208)]
[[Thread Index](threads.html#00208)]

# [SECURITY] [DSA 1887-1] New rails packages fix cross-site scripting

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 1887-1] New rails packages fix cross-site scripting
* *From*: white@debian.org (Steffen Joeris)
* *Date*: Wed, 16 Sep 2009 02:47:38 +1000 (EST)
* *Message-id*: <[[🔎]](/msgid-search/20090915164738.29D69AB0029%40hannah.localdomain) [20090915164738.29D69AB0029@hannah.localdomain](msg00208.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- ------------------------------------------------------------------------
Debian Security Advisory DSA-1887-1                  security@debian.org
<http://www.debian.org/security/>                      Steffen Joeris
September 15, 2009                    <http://www.debian.org/security/faq>
- ------------------------------------------------------------------------

Package        : rails
Vulnerability  : missing input sanitising
Problem type   : remote
Debian-specific: no
CVE Id         : CVE-2009-3009
Debian Bug     : 545063

Brian Mastenbrook discovered that rails, the MVC ruby based framework
geared for web application development, is prone to cross-site scripting
attacks via malformed strings in the form helper.

For the stable distribution (lenny), this problem has been fixed in
version 2.1.0-7.

For the oldstable distribution (etch) security support has been
discontinued. It has been reported that rails in oldstable is unusable
and several features that are affected by security issues are broken due
to programming issues. It is highly recommended to upgrade to the
version in stable (lenny).

For the testing distribution (squeeze) and the unstable distribution
(sid), this problem has been fixed in version 2.2.3-1.

We recommend that you upgrade your rails packages.

Upgrade instructions
- --------------------

wget url
        will fetch the file for you
dpkg -i file.deb
        will install the referenced file.

If you are using the apt-get package manager, use the line for
sources.list as given below:

apt-get update
        will update the internal database
apt-get upgrade
        will install corrected packages

You may use an automated update by adding the resources from the
footer to the proper configuration.

Debian GNU/Linux 5.0 alias lenny
- --------------------------------

Debian (stable)
- ---------------

Stable updates are available for alpha, amd64, arm, armel, hppa, i386, ia64, mips, mipsel, powerpc, s390 and sparc.

Source archives:

  <http://security.debian.org/pool/updates/main/r/rails/rails_2.1.0-7.diff.gz>
    Size/MD5 checksum:    17520 866f4225a0496c3a2fbeae5da52b36a9
  <http://security.debian.org/pool/updates/main/r/rails/rails_2.1.0-7.dsc>
    Size/MD5 checksum:     1203 60d2bd20b3dae00c2675ed1d45ee99af
  <http://security.debian.org/pool/updates/main/r/rails/rails_2.1.0.orig.tar.gz>
    Size/MD5 checksum:  1953333 edcc03e7177e1557653fcb92c90db0d1

Architecture independent packages:

  <http://security.debian.org/pool/updates/main/r/rails/rails_2.1.0-7_all.deb>
    Size/MD5 checksum:  2374598 0a1648b6ff0105c4969f54f8c8bed8af

  These files will probably be moved into the stable distribution on
  its next update.

- ---------------------------------------------------------------------------------
For apt-get: deb <http://security.debian.org/> stable/updates main
For dpkg-ftp: ftp://security.debian.org/debian-security dists/stable/updates/main
Mailing list: debian-security-announce@lists.debian.org
Package info: `apt-cache show <pkg>' and <http://packages.debian.org/><pkg>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iEYEARECAAYFAkqvxQUACgkQ62zWxYk/rQepTACeMylU2PMJePwDfaGAAGFLLP6s
Rz0AoLvIQHNfBsLVmXXG8xF9b5gsA+23
=tRi9
-----END PGP SIGNATURE-----

```

---


