Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

The vulnerability stems from the BackupPC application's improper restriction of the `ClientNameAlias` option, specifically within the `CgiUserConfigEdit` functionality. This allows users, who should not have the ability to modify this setting, to change the alias associated with a client machine.

**Weaknesses/Vulnerabilities:**

*   **Insufficient Access Control:** The primary issue is the lack of proper access control for the `ClientNameAlias` configuration. Normal users were able to modify this setting, which should have been restricted to administrators only.
*   **Insecure Default Configuration:** The default configuration of BackupPC, specifically the `CgiUserConfigEdit` option, allowed modification of `ClientNameAlias` by non-admin users.
*  **Parameter Injection**: A user could modify the `ClientNameAlias` parameter by adding `&override_ClientNameAlias=1&v_zZ_ClientNameAlias=xxxx` to their POST request.

**Impact of Exploitation:**

*   **Unauthorized Data Access:** By changing the `ClientNameAlias`, a user could initiate backups from a different machine than they are authorized to. This allowed an attacker to read data from any machine where the BackupPC server's SSH key was authorized to log in (often as root).
*   **Arbitrary File Overwrite/Modification:** The attacker could also restore data to the target machine, potentially overwriting arbitrary files and leading to privilege escalation if, for instance, they overwrote the `/etc/shadow` file.
*   **Privilege Escalation:** The ability to read sensitive data and modify system files as root can lead to complete compromise of the target machine.

**Attack Vectors:**

*   **Web Interface:** The vulnerability was exploited through the BackupPC's web interface where users could modify their configuration settings.
*   **HTTP POST Request Manipulation**: Users can manipulate parameters in the HTTP POST request to change the `ClientNameAlias`.

**Required Attacker Capabilities/Position:**

*   **Authenticated User:** The attacker needs to be an authenticated user of the BackupPC web interface.
*   **Knowledge of Target:** The attacker would need to know the `ClientNameAlias` of the target machine they want to exploit.
*   **Access to backup server:** The attacker needs access to the BackupPC server that has SSH keys that allow access to other machines.

**Additional Details:**

*   The initial fix for this vulnerability in backuppc 3.1.0-7 was incomplete. The issue was that the check to disable modification of the alias was performed *after* the settings were applied, allowing the user to use HTTP parameter injection to bypass the fix. This was addressed in later versions, most notably backuppc 3.1.0-8.
*   The vulnerability affected multiple Debian releases (Lenny), as well as Fedora 10 and 11 and EPEL-5.

In summary, the vulnerability allowed unauthorized users to manipulate backup configurations, gaining access to sensitive data and the ability to overwrite system files by impersonating other backup clients.