Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from Piwik's improper handling of user-supplied data within cookies. Specifically, Piwik uses the `unserialize()` function on cookie data without sufficient sanitization.

**Weaknesses/Vulnerabilities:**

*   **Insecure Unserialization:** The core vulnerability is the usage of PHP's `unserialize()` function on data from cookies without proper validation. This allows attackers to inject malicious serialized PHP objects.
*   **Object Injection:**  Attackers can craft serialized objects of Piwik classes to exploit the vulnerability. Specifically, they can inject `Piwik_Config`, `Zend_Log` and `Piwik_View` objects.
*   **File Write via Piwik_Config:** By controlling the properties of a unserialized `Piwik_Config` object, attackers can write arbitrary configurations to arbitrary locations. This was initially used to inject PHP code after bypassing the initial protection with base64 filter.
*   **Arbitrary Code Execution via Zend_Log and Smarty:**  More recent versions of Piwik with upgraded Zend Framework allowed for arbitrary code execution. By crafting `Zend_Log`, `Zend_Log_Writer_Mail`, and `Piwik_View` objects, an attacker could control parameters passed to Smarty.  The attacker can execute arbitrary PHP code by controlling which method of Smarty is called with attacker controlled parameters. The function `_eval` within smarty can be used with this exploit.

**Impact of Exploitation:**

*   **Arbitrary File Write:** Attackers can write arbitrary files to writable locations on the web server. This includes potentially uploading PHP files to the webserver's document root.
*   **Arbitrary Code Execution:**  Attackers can execute arbitrary PHP code on the server, enabling them to take control of the web application. This can lead to complete compromise of the Piwik installation and the underlying system.
*   **Data Breach:** Potentially, attackers can access, modify, or delete sensitive data collected by Piwik.

**Attack Vectors:**

*   **HTTP Cookies:** The primary attack vector is through specially crafted HTTP cookies sent to the Piwik application.
*   **Unserialize Function:** The vulnerability is triggered when the application uses the `unserialize()` function on the attacker-controlled cookie data.

**Required Attacker Capabilities/Position:**

*   **Network Access:** Attackers need network access to the Piwik installation to send malicious HTTP cookies.
*   **Knowledge of Piwik Internals:** Attackers require knowledge of Piwik's internal classes (`Piwik_Config`, `Zend_Log`, `Zend_Log_Writer_Mail` and `Piwik_View`), their properties, and available methods to craft effective exploit payloads.
*   **Ability to craft serialized PHP objects**: Knowledge on how PHP serialize and unserialize works is required to build the malicious objects.

**Additional details:**
* The original advisory provides a deep dive into the specific vulnerable code and exploitation techniques.
* It highlights how to bypass the file protection mechanism by using the `php://filter` stream wrapper combined with base64 encoding.
* It also details the exploitation chain utilizing the destructor of `Zend_Log` together with  `Zend_Log_Writer_Mail` and `Piwik_View` to reach the `eval` statement in the `smarty` class.

This vulnerability was considered critical due to the potential for full system compromise. The Piwik team released version 0.5 to address it, along with a patch for those who couldn't immediately upgrade.