=== Content from www.openwall.com_0a9a28ed_20250124_222131.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2009/12/09/2) [[next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <106755777.1035741260462270839.JavaMail.root@zmail01.collab.prod.int.phx2.redhat.com>
Date: Thu, 10 Dec 2009 11:24:30 -0500 (EST)
From: Josh Bressers <bressers@...hat.com>
To: oss-security@...ts.openwall.com
Cc: coley <coley@...re.org>
Subject: Re: Piwik <= 0.4.5 Cookie Unserialize()
 Vulnerability

Please use CVE-2009-4137 for this.

Sadly I can't find other references. Even the Piwik changelog is a bit slient
on this.

Thanks.

--
    JB

----- "Eren Türkay" <eren@...dus.org.tr> wrote:

> Hello,
>
> Piwik is an open source web analytics software program used by various
>
> sites.
>
> Stefan Esser found a vulnerability in Piwik, which can allow arbitrary
> files
> to be written into writable locations on the webserver. He says, it is
> also
> possible to execute arbitrary PHP code directly in newer versions of
> Piwik.
>
> The original advisory is here:
> <http://www.suspekt.org/2009/12/09/advisory-032009-piwik-cookie->
> unserialize-vulnerability/
>
> I think, it is worth assigning a CVE.
>
> Regards,
> Eren

--
    JB

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_69837f02_20250124_222130.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](../../../2009/12/10/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <200912092203.56421.eren@pardus.org.tr>
Date: Wed, 9 Dec 2009 22:03:56 +0200
From: Eren Türkay <eren@...dus.org.tr>
To: OSS Security <oss-security@...ts.openwall.com>
Subject: Piwik <= 0.4.5 Cookie Unserialize() Vulnerability

Hello,

Piwik is an open source web analytics software program used by various
sites.

Stefan Esser found a vulnerability in Piwik, which can allow arbitrary files
to be written into writable locations on the webserver. He says, it is also
possible to execute arbitrary PHP code directly in newer versions of Piwik.

The original advisory is here:
<http://www.suspekt.org/2009/12/09/advisory-032009-piwik-cookie->
unserialize-vulnerability/

I think, it is worth assigning a CVE.

Regards,
Eren

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_3815fc6f_20250124_222131.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <85f64f890912140900m691b7c6es56d1ade0cb9b2fd@mail.gmail.com>
Date: Mon, 14 Dec 2009 12:00:58 -0500
From: Anthon Pang <anthon.pang@...il.com>
To: oss-security@...ts.openwall.com
Subject: Re: Piwik <= 0.4.5 Cookie Unserialize() Vulnerability

The Piwik advisory is here:
<http://piwik.org/blog/2009/12/piwik-response-to-shocking-news-in-php-exploitation/>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from piwik.org_3c145cff_20250124_222126.html ===

[Skip to content](#content "Skip to content")
Menu
[![](data:image/svg+xml;base64...)![](https://m-img.org/spai/q_lossless+ret_img+to_webp/matomo.org/wp-content/uploads/2020/03/matomo-logo-winner-mobile3.png)](https://matomo.org)MENUMENU

* [![](data:image/svg+xml;base64...)![](https://m-img.org/spai/q_lossless+ret_img+to_webp/matomo.org/wp-content/uploads/2018/10/matomo-logo-final-1-170x25.png)](/)
* Why Matomo?
  + [100% Data Ownership](https://matomo.org/100-data-ownership/)
  + [Privacy Protection](https://matomo.org/privacy/)
  + [Product Features](https://matomo.org/product-features/)
  + [Open Source](https://matomo.org/free-software/)
  + [Flexibility](https://matomo.org/flexibility/)
  + [No Data Sampling](https://matomo.org/no-data-sampling/)
  + [GDPR](https://matomo.org/gdpr-analytics/)
  + [Google Analytics Alternative](https://matomo.org/google-analytics-alternative/)
* Use Cases
  + [Complete Analytics](https://matomo.org/feature-overview/)
  + [Intranet Analytics](https://matomo.org/intranet-analytics/)
  + [Consent-Free Tracking](https://matomo.org/cookie-consent-banners/)
  + [Tracking Personal Data](https://matomo.org/tracking-personal-data-with-matomo/)
  + [Marketing Attribution](https://matomo.org/multi-attribution/)
  + [No Limitations](https://matomo.org/no-data-limitations-with-matomo/)
  + [Log Analytics](https://matomo.org/log-analytics/)
* [Cloud](https://matomo.org/matomo-cloud/)
* On-Premise
  + [Matomo On-Premise](https://matomo.org/matomo-on-premise/)
  + [On-Premise vs Cloud](https://matomo.org/what-is-on-premise/)
  + [Download for free](https://matomo.org/download/)
  + [Marketplace](https://plugins.matomo.org)
  + [Support Plans](https://matomo.org/support-plans/)
* [Pricing](https://matomo.org/pricing/)
  + [Pricing](https://matomo.org/pricing/)
  + [Contact Sales](https://matomo.org/contact-sales/)
* Resources
  + [Help](https://matomo.org/help/)
  + [Blog](https://matomo.org/blog/)
  + [Guides](https://matomo.org/resources/)
  + [Masterclasses](https://matomo.org/masterclass/)
  + [Case Studies](https://matomo.org/case-studies/)
  + [Integrations](https://matomo.org/integrate/)
  + [Contact the Matomo team](https://matomo.org/contact/)
  + [List of all features](https://matomo.org/features/)
  + [Get involved](https://matomo.org/get-involved/)
* [Log in](/login)[Help](/help/?header)[TRY IT FOR FREE](https://matomo.org/start-free-analytics-trial/)

##### [EU Financial Services Analytics Maturity Report: Explore trends, challenges, and strategies. Get your copy](https://matomo.org/resources/analytics-maturity-report-for-eu-financial-services/)

# Matomo 0.5, response to “Shocking News in PHP Exploitation”

* December 9, 2009

Contents

The Matomo (Piwik) project acknowledges its exposure to the cookie exploit vulnerability described in Stefan Esser’s presentation, [“*Shocking News in PHP Exploitation*“](https://www.suspekt.org/2009/11/28/shocking-news-in-php-exploitation/).

The potential security vulnerability exists in all versions of Matomo prior to version 0.5. While no exploit code has been posted, this is a serious threat given Matomo’s increasing popularity. As such, we strongly encourage all Matomo users to upgrade as soon as possible to the latest version of Matomo.

If you are unable to update to Matomo 0.5 or later, a small patch (released Dec. 8, 2009) to “core/Cookie.php” is available [here](https://developer.matomo.org/trac/changeset/1637).

Updated Dec 10, 2009: Candidate CVE identifier assigned: CVE-2009-4137

Updated Jan 14, 2011: Related CVE identifier: CVE-2009-4417

Recommended for you

[![Open Banking Safety featured image](data:image/svg+xml;base64...)![Open Banking Safety featured image](https://m-img.org/spai/q_lossless+ret_img+to_webp/matomo.org/wp-content/uploads/2024/11/image4-3.png)](https://matomo.org/blog/2024/12/open-banking-security-101-is-open-banking-safe/)
##### [Open Banking Security 101: Is open banking safe?](https://matomo.org/blog/2024/12/open-banking-security-101-is-open-banking-safe/)

[![two people exchanging a coin.](data:image/svg+xml;base64...)![two people exchanging a coin.](https://m-img.org/spai/q_lossless+ret_img+to_webp/matomo.org/wp-content/uploads/2024/10/data-strategies-in-banking.png)](https://matomo.org/blog/2024/10/banking-data-strategies-a-primer-to-zero-party-first-party-second-party-and-third-party-data/)
##### [Banking Data Strategies – A Primer to Zero-party, First-party, Second-party and Third-party data](https://matomo.org/blog/2024/10/banking-data-strategies-a-primer-to-zero-party-first-party-second-party-and-third-party-data/)

[![Featured image for the advancing analytics maturity webinar](data:image/svg+xml;base64...)![Featured image for the advancing analytics maturity webinar](https://m-img.org/spai/q_lossless+ret_img+to_webp/matomo.org/wp-content/uploads/2024/02/Marketing-Attribution-Software.png)](https://matomo.org/blog/2024/11/how-hsbc-and-ing-are-transforming-banking-with-ai/)
##### [How HSBC and ING are transforming banking with AI](https://matomo.org/blog/2024/11/how-hsbc-and-ing-are-transforming-banking-with-ai/)

Enjoyed this post?

Join the 160,000+ subscribers who receive the Matomo Newsletter straight to their inbox every month

Email(Required)

Subscribe to our newsletter to receive regular information about Matomo. You can unsubscribe at any time from it. This service uses MadMimi. Learn more about it within our [privacy Policy](https://matomo.org/privacy-policy/) page.

Δ

Get started with Matomo

A powerful web analytics platform that gives you and your business 100% data ownership and user privacy protection.

[Try Cloud for free](https://matomo.org/start-free-analytics-trial/?blog-footer)

[Download On-Premise](https://matomo.org/download/?blog-footer)

No credit card required.

Free forever.

Get started with Matomo

A powerful web analytics platform that gives you and your business 100% data ownership and user privacy protection.

[Try Cloud for free](https://matomo.org/start-free-analytics-trial/?blog-footer)

No credit card required.

[Download On-Premise](https://matomo.org/download/?blog-footer)

Free forever.

## Company

* [About Matomo](https://matomo.org/about/)
* [History](https://matomo.org/history/)
* [Contributors](https://matomo.org/team/)
* [Hiring](https://matomo.org/jobs/)
* [Contact Us](https://matomo.org/contact/)
* [Partner Programme](https://matomo.org/partner-programme/)
## Support

* [Help Centre](https://matomo.org/help/?footer)
* [Developers](https://developer.matomo.org/?footer)
* [Contact support](https://matomo.org/support/?footer)

## Sales

* [Contact Sales](https://matomo.org/contact-sales/)
* [BigQuery & Data Warehouse Export Feature](https://matomo.org/access-matomo-bigquery-export-feature/)
## Product

* [Tag Manager](https://matomo.org/guide/tag-manager/getting-started-with-tag-manager/?footer)
* [WordPress Plugin](https://matomo.org/blog/2019/10/matomo-analytics-for-wordpress/?footer)
* [URL Campaign Builder](https://matomo.org/faq/tracking-campaigns-url-builder/?footer)
* [Integrations](https://matomo.org/integrate/?footer)
* [Open Source](https://matomo.org/free-software/?footer)
* [Download Matomo](https://matomo.org/download/?footer)
* [Changelog](https://matomo.org/changelog/?footer)
* [Issue Tracker](https://github.com/matomo-org/matomo/issues/?footer)
* [GitHub](https://github.com/matomo-org/?footer)
* [Feedback Panel](https://matomo.org/resources/matomo-feedback-panel/)

## Privacy

* [Cookie Notice](https://matomo.org/privacy-policy/cookies/)
* [Data ownership](https://matomo.org/100-data-ownership/)
* [GDPR](https://matomo.org/gdpr-analytics/)
* [Security](https://matomo.org/security/)
* [Matomo Cloud Privacy Policy](https://matomo.org/matomo-cloud-privacy-policy/)
* [Website Privacy Policy](https://matomo.org/privacy-policy/)
## Resources

* [Blog](https://matomo.org/blog/)
* [Case Studies](https://matomo.org/case-studies/)
* [Newsletter](https://matomo.org/newsletter/)
* [Guides](https://matomo.org/resources/)
* [Masterclasses](https://matomo.org/masterclass/)
* [Matomo in the Press](https://matomo.org/press/)
* [Press Enquiries](https://matomo.org/media/)
* [GDPR Timeline](https://matomo.org/gdpr-timeline/)
* [How to Check Website Traffic](https://matomo.org/blog/2023/08/how-to-check-website-traffic/)

## Comparisons

* [vs Google Analytics](https://matomo.org/matomo-vs-google-analytics-comparison/)
* [vs Amplitude](https://matomo.org/amplitude-vs-matomo/)
* [vs Adobe Analytics vs Google Analytics](https://matomo.org/adobe-analytics-vs-google-analytics-vs-matomo/)
* [vs Piwik PRO](https://matomo.org/piwik-pro-vs-matomo/)
* [vs Firebase](https://matomo.org/firebase-vs-matomo-features-pricing-and-key-differences/)
* [vs Plausible](https://matomo.org/plausible-vs-matomo/)
* [vs Fathom](https://matomo.org/fathom-vs-matomo/)
* [vs Hotjar](https://matomo.org/hotjar-alternative/)
* [vs WP-Statistics](https://matomo.org/blog/2020/04/matomo-vs-wp-statistics/)
* [Top Web Analytics Tools](https://matomo.org/blog/2023/08/top-web-analytics-tools/)
## Industries

* [Banks](https://matomo.org/banking/)
* [Enterprise](https://matomo.org/enterprise/)
* [Financial Institutions](https://matomo.org/financial-institutions/)
* [Fintech](https://matomo.org/fintech/)

© 2025 matomo.org



=== Content from www.suspekt.org_da596e72_20250124_222136.html ===

[Skip to content](#content "Skip to content")
[![SuspeK](data:image/svg+xml... "SuspeK")![SuspeK](https://www.suspek.org/wp-content/uploads/2023/09/Suspek-logo.jpg "SuspeK")](https://www.suspek.org/ "SuspeK")

Menu

* [Spy Apps](https://www.suspek.org/category/spy-apps/)
  + [9 Best Hidden Spy Apps for Android and iPhone [May 2023]](https://www.suspek.org/best-spy-apps/)
  + [Best Phone Tracker Apps Without Permission](https://www.suspek.org/best-phone-tracker-apps-without-permission/)
* [VPN](https://www.suspek.org/category/vpn/)
* [Antivirus](https://www.suspek.org/category/antivirus/)
* [Password Managers](https://www.suspek.org/category/password-managers/)
* [About](https://www.suspek.org/about/)
* [Contact](https://www.suspek.org/contact/)

[![SuspeK](data:image/svg+xml...)![SuspeK](https://www.suspek.org/wp-content/uploads/2021/05/suspekt-mobile-logo.jpg)](https://www.suspek.org/ "SuspeK")

Menu

* [Spy Apps](https://www.suspek.org/category/spy-apps/)
  + [9 Best Hidden Spy Apps for Android and iPhone [May 2023]](https://www.suspek.org/best-spy-apps/)
  + [Best Phone Tracker Apps Without Permission](https://www.suspek.org/best-phone-tracker-apps-without-permission/)
* [VPN](https://www.suspek.org/category/vpn/)
* [Antivirus](https://www.suspek.org/category/antivirus/)
* [Password Managers](https://www.suspek.org/category/password-managers/)
* [About](https://www.suspek.org/about/)
* [Contact](https://www.suspek.org/contact/)

## Featured Guides

[![Hidden Spy Apps For Iphone & Android](data:image/svg+xml...)![Hidden Spy Apps For Iphone & Android](https://www.suspek.org/wp-content/uploads/2021/08/Hidden-Spy-Apps-For-Iphone-Android.jpg)](https://www.suspek.org/best-spy-apps/ "9 Best Hidden Spy Apps for Android and iPhone [May 2023]")
## [9 Best Hidden Spy Apps for Android and iPhone [May 2023]](https://www.suspek.org/best-spy-apps/ "9 Best Hidden Spy Apps for Android and iPhone [May 2023]")

Looking to spy on someone’s phone secretly? This comprehensive guide will list

[​Read More](https://www.suspek.org/best-spy-apps/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/best-phone-tracker-apps-without-permission/ "6 Best Phone Tracker Apps Without Permission [May 2023]")
## [6 Best Phone Tracker Apps Without Permission [May 2023]](https://www.suspek.org/best-phone-tracker-apps-without-permission/ "6 Best Phone Tracker Apps Without Permission [May 2023]")

Looking to track someone’s cell phone location secretly without permission? You don’t

[​Read More](https://www.suspek.org/best-phone-tracker-apps-without-permission/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/best-keylogger-android/ "6 Best Hidden and No-Root Keyloggers For Android in 2023")
## [6 Best Hidden and No-Root Keyloggers For Android in 2023](https://www.suspek.org/best-keylogger-android/ "6 Best Hidden and No-Root Keyloggers For Android in 2023")

Choosing the right Android keylogger can be overwhelming and dangerous – considering

[​Read More](https://www.suspek.org/best-keylogger-android/)

## Password Managers

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/best-password-manager/ "10 Best Password Manager Apps 2023 [Most Secure]")
## [10 Best Password Manager Apps 2023 [Most Secure]](https://www.suspek.org/best-password-manager/ "10 Best Password Manager Apps 2023 [Most Secure]")

It is time to ditch the sticky notes and get a peace

[​Read More](https://www.suspek.org/best-password-manager/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/splashid-review/ "SplashID Review (2023): Decent With Limitations")
## [SplashID Review (2023): Decent With Limitations](https://www.suspek.org/splashid-review/ "SplashID Review (2023): Decent With Limitations")

Compared to a lot of password management software you can find on

[​Read More](https://www.suspek.org/splashid-review/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/safeincloud-review/ "SafeInCloud Review (2023): Good for Newbies")
## [SafeInCloud Review (2023): Good for Newbies](https://www.suspek.org/safeincloud-review/ "SafeInCloud Review (2023): Good for Newbies")

SafeInCloud is a password manager that offers cross-platform password services that gives

[​Read More](https://www.suspek.org/safeincloud-review/)

## ​VPN Guides

[![](data:image/svg+xml...)](https://www.suspek.org/best-vpn-for-android/ "Best VPN for Android in 2023 – Our Top Picks Reviewed")
## [Best VPN for Android in 2023 – Our Top Picks Reviewed](https://www.suspek.org/best-vpn-for-android/ "Best VPN for Android in 2023 – Our Top Picks Reviewed")

The internet has greatly evolved over the years to grant us access

[​Read More](https://www.suspek.org/best-vpn-for-android/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/nordvpn-vs-private-internet-access/ "NordVPN vs Private Internet Access (PIA) in 2023")
## [NordVPN vs Private Internet Access (PIA) in 2023](https://www.suspek.org/nordvpn-vs-private-internet-access/ "NordVPN vs Private Internet Access (PIA) in 2023")

NordVPN and Private Internet Access (PIA) are among the big names in

[​Read More](https://www.suspek.org/nordvpn-vs-private-internet-access/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/nordvpn-vs-ipvanish/ "NordVPN vs IPVanish (2023) – Compared and Reviewed")
## [NordVPN vs IPVanish (2023) – Compared and Reviewed](https://www.suspek.org/nordvpn-vs-ipvanish/ "NordVPN vs IPVanish (2023) – Compared and Reviewed")

NordVPN and IPVanish are among the top names in the VPN industry.

[​Read More](https://www.suspek.org/nordvpn-vs-ipvanish/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/nordvpn-vs-expressvpn/ "NordVPN vs ExpressVPN (2023) – The Ultimate Battle")
## [NordVPN vs ExpressVPN (2023) – The Ultimate Battle](https://www.suspek.org/nordvpn-vs-expressvpn/ "NordVPN vs ExpressVPN (2023) – The Ultimate Battle")

NordVPN and ExpressVPN are the two most popular service provider in the

[​Read More](https://www.suspek.org/nordvpn-vs-expressvpn/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/expressvpn-vs-ipvanish/ "ExpressVPN vs IPVanish (2023) – The Comparison You Need")
## [ExpressVPN vs IPVanish (2023) – The Comparison You Need](https://www.suspek.org/expressvpn-vs-ipvanish/ "ExpressVPN vs IPVanish (2023) – The Comparison You Need")

ExpressVPN and IPVanish are the two most popular service provider in the

[​Read More](https://www.suspek.org/expressvpn-vs-ipvanish/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/best-vpn-for-streaming/ "Best VPN For Streaming – Our Picks (2023)")
## [Best VPN For Streaming – Our Picks (2023)](https://www.suspek.org/best-vpn-for-streaming/ "Best VPN For Streaming – Our Picks (2023)")

This is probably not the first time you are looking for a

[​Read More](https://www.suspek.org/best-vpn-for-streaming/)

## ​Best Spy Apps by applications

[![how to catch a cheater](data:image/svg+xml...)](https://www.suspek.org/catch-a-cheater-app/ "The Best “Catch a Cheater” Apps Review [Updated April 2023] – Time to Call It Quit")
## [The Best “Catch a Cheater” Apps Review [Updated April 2023] – Time to Call It Quit](https://www.suspek.org/catch-a-cheater-app/ "The Best “Catch a Cheater” Apps Review [Updated April 2023] – Time to Call It Quit")

Ready to discover if your suspicions are right and uncover the truth

[​Read More](https://www.suspek.org/catch-a-cheater-app/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/snapchat-monitoring-apps/ "9 Best Snapchat Monitoring and Spy Apps Review (2023)")
## [9 Best Snapchat Monitoring and Spy Apps Review (2023)](https://www.suspek.org/snapchat-monitoring-apps/ "9 Best Snapchat Monitoring and Spy Apps Review (2023)")

If you are a parent of a teenager, you may be reading

[​Read More](https://www.suspek.org/snapchat-monitoring-apps/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/best-sim-card-trackers/ "5 Best SIM Card Trackers Review in 2023")
## [5 Best SIM Card Trackers Review in 2023](https://www.suspek.org/best-sim-card-trackers/ "5 Best SIM Card Trackers Review in 2023")

A SIM Card Tracker is essentially a tracking software and technology that

[​Read More](https://www.suspek.org/best-sim-card-trackers/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/whatsapp-spy-apps-for-android/ "6 Best WhatsApp Spy Apps for Android and iPhone 2023")
## [6 Best WhatsApp Spy Apps for Android and iPhone 2023](https://www.suspek.org/whatsapp-spy-apps-for-android/ "6 Best WhatsApp Spy Apps for Android and iPhone 2023")

​If you are looking to spy on Whatsapp, the best way is

[​Read More](https://www.suspek.org/whatsapp-spy-apps-for-android/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/best-sms-trackers-review/ "Best Free SMS Trackers without touching Target Phone (2023)")
## [Best Free SMS Trackers without touching Target Phone (2023)](https://www.suspek.org/best-sms-trackers-review/ "Best Free SMS Trackers without touching Target Phone (2023)")

Quick Navigation Introduction to SMS TrackersBest Free SMS Trackers to Intercept text

[​Read More](https://www.suspek.org/best-sms-trackers-review/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/best-facebook-messenger-spy-apps/ "The 10 Best Facebook Messenger Spy Apps Review in 2023")
## [The 10 Best Facebook Messenger Spy Apps Review in 2023](https://www.suspek.org/best-facebook-messenger-spy-apps/ "The 10 Best Facebook Messenger Spy Apps Review in 2023")

Facebook Messenger is among the most favorite social networks in the world

[​Read More](https://www.suspek.org/best-facebook-messenger-spy-apps/)

## ​Top Spy App Reviews

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/mspy-review/ "mSpy Reviews in 2023 – Does it really work?")
## [mSpy Reviews in 2023 – Does it really work?](https://www.suspek.org/mspy-review/ "mSpy Reviews in 2023 – Does it really work?")

The smartphone app market is saturated with various applications that let a

[​Read More](https://www.suspek.org/mspy-review/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/cocospy-review/ "Cocospy Review (2023) – Is It Worth All the Bucks?")
## [Cocospy Review (2023) – Is It Worth All the Bucks?](https://www.suspek.org/cocospy-review/ "Cocospy Review (2023) – Is It Worth All the Bucks?")

For concerned parents wanting to keep tabs on their children’s smartphone activities,

[​Read More](https://www.suspek.org/cocospy-review/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/spybubble-app-review/ "SpyBubble Review (2023) – Simplistic, Straightforward")
## [SpyBubble Review (2023) – Simplistic, Straightforward](https://www.suspek.org/spybubble-app-review/ "SpyBubble Review (2023) – Simplistic, Straightforward")

SpyBubble is another leading spy app available in the markets. Marketed as

[​Read More](https://www.suspek.org/spybubble-app-review/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/spyzie-review/ "Spyzie Review (2023) : Made for Parents")
## [Spyzie Review (2023) : Made for Parents](https://www.suspek.org/spyzie-review/ "Spyzie Review (2023) : Made for Parents")

Spyzie markets itself as an “all in one parental control” app. Advertised

[​Read More](https://www.suspek.org/spyzie-review/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/spyic-review/ "Spyic Review in 2023 – Is this app legit?")
## [Spyic Review in 2023 – Is this app legit?](https://www.suspek.org/spyic-review/ "Spyic Review in 2023 – Is this app legit?")

​Among all the mobile trackers and the competition, Spyic is one of

[​Read More](https://www.suspek.org/spyic-review/)

[![](data:image/svg+xml...)![](https://www.suspek.org/wp-content/plugins/thrive-visual-editor/editor/css/images/featured_image.png)](https://www.suspek.org/flexispy-review/ "FlexiSPY Review – A Comprehensive Review in 2023")
## [FlexiSPY Review – A Comprehensive Review in 2023](https://www.suspek.org/flexispy-review/ "FlexiSPY Review – A Comprehensive Review in 2023")

There are many spying and monitoring apps in the market, but a

[​Read More](https://www.suspek.org/flexispy-review/)

Suspek.org - © Copyright 2025. [Privacy Policy](https://www.suspek.org/privacy-policy/) | [Terms and Conditions](https://www.suspek.org/terms-and-conditions/)



=== Content from www.suspekt.org_a1597a55_20250124_222134.html ===

[Skip to content](#content "Skip to content")
[![SuspeK](data:image/svg+xml... "SuspeK")![SuspeK](https://www.suspek.org/wp-content/uploads/2023/09/Suspek-logo.jpg "SuspeK")](https://www.suspek.org/ "SuspeK")

Menu

* [Spy Apps](https://www.suspek.org/category/spy-apps/)
  + [9 Best Hidden Spy Apps for Android and iPhone [May 2023]](https://www.suspek.org/best-spy-apps/)
  + [Best Phone Tracker Apps Without Permission](https://www.suspek.org/best-phone-tracker-apps-without-permission/)
* [VPN](https://www.suspek.org/category/vpn/)
* [Antivirus](https://www.suspek.org/category/antivirus/)
* [Password Managers](https://www.suspek.org/category/password-managers/)
* [About](https://www.suspek.org/about/)
* [Contact](https://www.suspek.org/contact/)

[![SuspeK](data:image/svg+xml...)![SuspeK](https://www.suspek.org/wp-content/uploads/2021/05/suspekt-mobile-logo.jpg)](https://www.suspek.org/ "SuspeK")

Menu

* [Spy Apps](https://www.suspek.org/category/spy-apps/)
  + [9 Best Hidden Spy Apps for Android and iPhone [May 2023]](https://www.suspek.org/best-spy-apps/)
  + [Best Phone Tracker Apps Without Permission](https://www.suspek.org/best-phone-tracker-apps-without-permission/)
* [VPN](https://www.suspek.org/category/vpn/)
* [Antivirus](https://www.suspek.org/category/antivirus/)
* [Password Managers](https://www.suspek.org/category/password-managers/)
* [About](https://www.suspek.org/about/)
* [Contact](https://www.suspek.org/contact/)

# Advisory 032009 Piwik Cookie Unserialize Vulnerability

I released an important advisory about a remotely exploitable unserialize() vulnerability in Piwik today.

```
                         SektionEins GmbH
                        www.sektioneins.de

                     -= Security  Advisory =-

     Advisory: Piwik Cookie Unserialize() Vulnerability
 Release Date: 2009/12/09
Last Modified: 2009/12/09
       Author: Stefan Esser [stefan.esser[at]sektioneins.de]

  Application: Piwik <= 0.4.5
     Severity: Piwik unserializes() user input which allows an attacker
               to send a carefully crafted cookie that when unserialized
               utilizes Piwik's classes to upload arbitrary files or
               execute arbitrary PHP code
         Risk: Critical
Vendor Status: Piwik 0.5.0 was released which fixes this vulnerability
    Reference: [advisory-032009-piwik-cookie-unserialize-vulnerability](http://www.sektioneins.de/en/advisories/advisory-032009-piwik-cookie-unserialize-vulnerability/)
               [RSS09-WebApplicationFirewallBypassesAndPHPExploits.pdf](https://www.suspek.org/downloads/RSS09-WebApplicationFirewallBypassesAndPHPExploits.pdf)
               [POC2009-ShockingNewsInPHPExploitation.pdf](https://www.suspek.org/downloads/POC2009-ShockingNewsInPHPExploitation.pdf)

Overview:

  Quote from http://www.piwik.org
  "Piwik is a downloadable, open source (GPL licensed) web analytics
   software program. It provides you with detailed real time reports
   on your website visitors: the search engines and keywords they
   used, the language they speak, your popular pages… and so much more.

   Piwik aims to be an open source alternative to Google Analytics."

  Piwik recently became sourceforge project of the month and won the
  Infoworld Bossie Award for best open source enterprise software which
  made it quite popular. Therefore Piwik is nowadays installed on many
  high profile websites like: banking websites, political party websites,
  gaming websites, blogs and even security company websites.

  During our research in unserialize() vulnerabilities it was discovered
  that Piwik unserializes data from the user supplied cookie. By
  unserializing some of Piwik's objects it is possible to write
  arbitrary files to writable locations on the webserver which
  can be used to upload e.g. PHP files to writable directories
  within the webserver's document root which usually exist in a
  standard Piwik installation. In newer versions of Piwik it is
  also possible to execute arbitrary PHP code directly.

  Combined with the interruption vulnerability exploits demonstrated
  by SektionEins at Syscan and Blackhat it is possible to disable
  all internal PHP security protections and execute arbitrary code
  e.g. local kernel exploits to become root.

Details:

  SektionEins recently demonstrated how it is sometimes possible
  to execute arbitrary PHP code in an application using unserialize()
  on user supplied data. In detail various exploits were shown that
  work against all Zend Framework based applications that unserialize()
  user input. Part of this research was to find popular PHP open
  source applications that are vulnerable to this.

  During our search it was discovered that Piwik does unserialize()
  data from the cookie and uses parts of the Zend Framework:

  protected function loadContentFromCookie()
  {
    $cookieStr = $_COOKIE[$this->name];
    $values = explode( self::VALUE_SEPARATOR, $cookieStr);
    foreach($values as $nameValue)
    {
      $equalPos = strpos($nameValue, '=');
      $varName = substr($nameValue,0,$equalPos);
      $varValue = substr($nameValue,$equalPos+1);

      // no numeric value are base64 encoded so we need to decode them
      if(!is_numeric($varValue))
      {
        $varValue = base64_decode($varValue);

        // some of the values may be serialized array so we try to...
        if( ($arrayValue = @unserialize($varValue)) !== false
            // we set the unserialized version only for arrays...
            && is_array($arrayValue)
            )
        {
          $varValue = $arrayValue;
        }
      }
      $this->set($varName, $varValue);
    }
  }

  While this allows to unserialize() user input the previously
  demonstrated exploits will not work on Piwik because only parts of
  the Zend Framework are shipped with the Piwik source code. Because
  of this we had to evaluate if Piwik's own classes can be utilized
  in exploits.

  When trying to exploit an unserialize() vulnerability in a PHP
  application the first step is to enumerate the objects that contain
  __wakeup() or __destruct() methods and read their code to analyze if
  these methods are doing something interesting.

  When looking at the Piwik source code one particular class can be
  found that allows writing arbitrary configuration files to the
  webserver. This class is called Piwik_Config and contains the
  following code.

  function __destruct()
  {
    if($this->configFileUpdated === true
        && $this->doWriteFileWhenUpdated === true)
    {
      $configFile = "; <?php exit; ?> DO NOT REMOVE THIS LINE\n";
      $configFile .= "; file automatically generated or modified by "
                     "Piwik; you can manually override the default "
                     "values in global.ini.php by redefining them "
                     "in this file.\n";

      foreach($this->userConfig as $section => $arraySection)
      {
        $arraySection = $arraySection->toArray();
        $configFile .= "[$section]\n";
        foreach($arraySection as $name => $value)
        {
          ...
          $configFile .= $name.' = '.$value."\n";
          ...
        }
        $configFile .= "\n";
      }
      chdir($this->correctCwd);
      file_put_contents($this->pathIniFileUserConfig, $configFile );
    }
  }

  It should be obvious that when unserializing a Piwik_Config object
  it is possible to write arbitrary configurations to arbitrary
  locations by just setting the properties of the object correctly.
  However it should also be obvious that executing arbitrary PHP code
  is not that simple because the authors of Piwik add a show stopper
  to the beginning of every configuration file "; <?php exit; ...".
  Because of this it is not possible to just write PHP code into a
  file and execute it.

  There is however a lesser known and nearly never used feature of PHP5
  that allows exploiting this situation. By using the PHP5 filter
  stream wrapper through the php://filter URI scheme it is possible to
  write arbitrary files to the server. By crafting a configuration
  filename like
  php://filter/write=convert.base64-decode/resource=/var/www/x.php it
  is possible to channel all writes to the file through a base64
  decoder. Because PHP does ignore invalid characters during base64
  decoding it is possible to destroy the show stopper by a single
  base64 decoding. By calculating how many base64 compatible characters
  are contained in the show stopper it is possible to find out how
  many padding bytes are necessary so that base64 injected PHP payload
  ends up correctly decoded in the written configuration file.

  Because the filter wrapper can be stacked several times before data
  is written to the actual file it is possible to construct payloads
  that do not only destroy the show stopper but also get rid of all the
  bytes. In current Piwik versions 5 times base64 decode is required
  for this. In earlier versions of Piwik there have been 3 different
  show stoppers strings. Therefore in order to exploit older Piwik
  versions different exploits are required.

  In order to execute arbitrary code it is possible to overwrite one
  of Piwik cache files and triggering a tracking event. Alternatively
  it is possible to first write a .htaccess file to one of the
  directories within Piwik's tmp directory that allows accessing its
  content and then dropping a PHP file in there.

  In the most recent Piwik version the Zend Framework components were
  upgraded which allows executing arbitrary PHP code directly. To
  achieve this the Zend_Log destructor is utilized.

  public function __destruct()
  {
    foreach($this->_writers as $writer) {
      $writer->shutdown();
    }
  }

  The Zend_Log destructor iterates through an array which it expects
  inside the _writers property. Each element of this array is then
  expected to have a method called shutdown() which is then executed.
  The next step in creating an exploit is to find classes that contain
  a shutdown() method. The best fitting class is Zend_Log_Writer_Mail.
  It is the same class that is also utilized in the generic Zend
  Framework exploit.

  public function shutdown()
  {
    // If there are events to mail, use them as message body.  Otherwise,
    // there is no mail to be sent.
    if (empty($this->_eventsToMail)) {
      return;
    }

    if ($this->_subjectPrependText !== null) {
      // Tack on the summary of entries per-priority to the subject
      // line and set it on the Zend_Mail object.
      $numEntries = $this->_getFormattedNumEntriesPerPriority();
      $this->_mail->setSubject(
      "{$this->_subjectPrependText} ({$numEntries})");
    }

    // Always provide events to mail as plaintext.
    $this->_mail->setBodyText(implode('', $this->_eventsToMail));

    // If a Zend_Layout instance is being used, set its "events"
    // value to the lines formatted for use with the layout.
    if ($this->_layout) {
      // Set the required "messages" value for the layout.  Here we
      // are assuming that the layout is for use with HTML.
      $this->_layout->events = implode('', $this->_layoutEventsToMail);

      // If an exception occurs during rendering, convert it to a notice
      // so we can avoid an exception thrown without a stack frame.
      try {
        $this->_mail->setBodyHtml($this->_layout->render());
      } catch (Exception $e) {
        ...
      }

      // Finally, send the mail.  If an exception occurs, convert ...
      // warning-level message so we can avoid an exception thrown ...
      // stack frame.
      try {
          $this->_mail->send();
      } catch (Exception $e) {
          ...
      }
  }

  This shutdown method will check if there are events not yet mailed
  and if there are, it will mail them to the address specified in the
  Zend_Mail object which has to be within the _mail property. This
  allows anyone to send out arbitrary spam to arbitrary mail addresses.
  However there is a more interesting exploiting path hidden here that
  once again utilizes the HTML rendering. Therefore an attacker has to
  find a class that contains a render method. The most promising class
  in case of Piwik is Piwik_View. Its render method will do a lot of
  things that can be ignored and finally call smarty to render the
  template.

  public function render()
  {
    try {
      ...
    } catch(Exception $e) {
      // can fail, for example at installation (no plugin loaded yet)
    }

    ...

    @header('Content-Type: text/html; charset=utf-8');
    @header("Pragma: ");
    @header("Cache-Control: no-store, must-revalidate");

    return $this->smarty->fetch($this->template);
  }

  Because most of the code in the render method is within a try and
  catch block it can be ignored. The only interesting part of the
  method is the fetch method called on the smarty property. Because
  smarty templates can execute PHP code the smarty class is the first
  one should look at and indeed smarty can be used to execute PHP
  code.

  function fetch($resource_name, $cache_id = null, ...)
  {
    ...
    if ($display && !$this->caching && count($this->_plugins['outputfilter']) == 0) {
      if ($this->_is_compiled($resource_name, $_smarty_compile_path)
          || $this->_compile_resource($resource_name, $_smarty_compile_path))
      {
        include($_smarty_compile_path);
      }
    } else {
    ...

  The supplied template name is then given to the _compile_resource
  method to compile the resource.

  function _compile_resource($resource_name, $compile_path)
  {

    $_params = array('resource_name' => $resource_name);
    if (!$this->_fetch_resource_info($_params)) {
      return false;
    }
    ...

  Before the resource is being compiled the _fetch_resource_info
  method is called to determine more information about the resource.

  function _fetch_resource_info(&$params)
  {
    ...
    $_params = array('resource_name' => $params['resource_name']) ;
    ...

    if ($this->_parse_resource_name($_params)) {
      $_resource_type = $_params['resource_type'];
      $_resource_name = $_params['resource_name'];
      switch ($_resource_type) {
        case 'file':
          ...
          break;

        default:
          // call resource functions to fetch the template source and timestamp
          if ($params['get_source']) {
            $_source_return = isset($this->_plugins['resource'][$_resource_type]) &&
            call_user_func_array($this->_plugins['resource'][$_resource_type][0][0],
             array($_resource_name, &$params['source_content'], &$this));
          } else {
            $_source_return = true;
          }
          ...
        }

  The _fetch_resource_info method first calls _parse_resource_name to
  determine the type and name of resource. The expected format is
  resource_type:resource_name. For non file resources a function will
  be determined by a lookup in the _plugins[resource] lookup table
  that will be called to retrieve the resource data. Because all
  properties are attacker supplied an exploit can freely choose what
  function should be called.

  Because the called function is called with three parameters and only
  the first one is user supplied it gets a bit tricky to execute
  arbitrary PHP code. Calling eval() is not possible because it is a
  language construct and not a function and calling assert() instead
  will also fail, because it only accepts one parameter. The trick
  here is to use one of the methods inside the smarty class which is
  a wrapper around eval().

  function _eval($code, $params=null)
  {
    return eval($code);
  }

  While this function does only define two parameters in its signature
  it is possible to call this function with more than two parameters.
  The reason for this is that unlike internal functions that usually
  bail out when too many parameters are supplied internal functions
  will not do this because otherwise it would not be possible to have
  functions with an arbitrary number of parameters.

  So to summarize the attack: By carefully crafting a user supplied
  cookie it is possible to utilize Piwik's own objects and execute
  arbitrary PHP code by supplying the argument to an eval() statement.

Proof of Concept:

  SektionEins GmbH is not going to release a proof of concept
  exploit for this vulnerability.

Disclosure Timeline:

  28. November 2009 - Notified hello@piwik.org
  09. December 2009 - Piwik developers released Piwik 0.5.0
  09. December 2009 - Public Disclosure

Recommendation:

  It is recommended to upgrade to the latest version of Piwik.

  Grab your copy at:
  http://piwik.org/latest.zip

CVE Information:

  The Common Vulnerabilities and Exposures project (cve.mitre.org) has
  not assigned a name to this vulnerability.

GPG-Key:

  pub  1024D/15ABDA78 2004-10-17 Stefan Esser
  Key fingerprint = 7806 58C8 CFA8 CE4A 1C2C  57DD 4AE1 795E 15AB DA78

Copyright 2009 SektionEins GmbH. All rights reserved.
```

Suspek.org - © Copyright 2025. [Privacy Policy](https://www.suspek.org/privacy-policy/) | [Terms and Conditions](https://www.suspek.org/terms-and-conditions/)


