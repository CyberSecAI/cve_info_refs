```
{
  "cve": "CVE-2009-4020",
  "description": "A specially-crafted Hierarchical File System (HFS) filesystem could cause a buffer overflow to occur in a process's kernel stack during a memcpy() call within the hfs_bnode_read() function (at fs/hfs/bnode.c:24).  The attacker can provide the source buffer and length, and the destination buffer is a local variable of a fixed length.  This local variable (passed as \"&entry\" from fs/hfs/dir.c:112 and allocated on line 60) is stored in the stack frame of hfs_bnode_read()'s caller, which is hfs_readdir(). Because the hfs_readdir() function executes upon any attempt to read a directory on the filesystem, it gets called whenever a user attempts to inspect any filesystem contents.",
  "affected_software": {
    "component": "HFS filesystem implementation in the Linux kernel",
     "vulnerable_code": "hfs_bnode_read() function (at fs/hfs/bnode.c:24) called from hfs_readdir() function (fs/hfs/dir.c:112)"
  },
  "vulnerability_details": {
    "root_cause": "Insufficient bounds checking on the source buffer length before copying data to a fixed-size destination buffer on the stack using memcpy().",
    "weakness": "A buffer overflow vulnerability exists due to the lack of proper validation of the source buffer length in the memcpy operation within the hfs_bnode_read function.",
      "impact": "An attacker can cause a denial of service by overflowing a local variable on the kernel stack. Remote code execution may also be possible, but it isn't explicitly stated.",
      "attack_vector": "A specially crafted HFS filesystem can trigger the vulnerability.",
     "required_capabilities": "An attacker needs the ability to mount and browse the malicious HFS filesystem (by executing `ls` on a directory in the filesystem)"
  },
  "references": [
        "http://marc.info/?l=linux-mm-commits&m=125987755823047&w=2",
        "https://bugzilla.redhat.com/CVE-2009-4020",
        "https://www.redhat.com/security/data/cve/CVE-2009-4020.html",
         "https://rhn.redhat.com/errata/RHSA-2010-0046.html",
        "https://rhn.redhat.com/errata/RHSA-2010-0095.html",
    "https://rhn.redhat.com/errata/RHSA-2010-0076.html",
      "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/message/D5G4PTV5M2INPXOCAW5ONECG6YT3HVXP/",
         "https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/message/YRJM6AABPE7I4ELSYAKTGTNGOMJ4AUMU/",
     "https://support.avaya.com/css/P8/documents/100073967"
   ]
}
```