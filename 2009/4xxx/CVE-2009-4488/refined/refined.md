- **Root cause of vulnerability**: The web servers log user-controlled input without sanitizing escape sequences. When these logs are viewed in a terminal or with tools like `cat` or `tail`, the escape sequences are interpreted by the terminal, potentially leading to unintended actions.

- **Weaknesses/vulnerabilities present**: Log escape sequence injection. The web servers do not filter or sanitize terminal escape sequences in log files.

- **Impact of exploitation**: An attacker can inject escape sequences that, when displayed in a terminal, can modify the terminal's behavior, potentially leading to the execution of commands or dumping the buffer to a file. This could cause denial of service, information disclosure, or arbitrary command execution on the system where the logs are being viewed.

- **Attack vectors**: The attack vector is through HTTP requests containing specially crafted escape sequences in the URL or header that are then logged by the web server.

- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the vulnerable web server. No other special privileges are needed.

- **Affected software**:
  - nginx 0.7.64 and earlier
  - Varnish 2.0.6 and earlier
  - Cherokee 0.99.30 and earlier
  - mini_httpd 1.19 and earlier
  - thttpd 2.25b0 and earlier
  - WEBrick 1.3.1 and earlier
  - Orion 2.0.7 and earlier
  - AOLserver 4.5.1 and earlier
  - Yaws 1.85 and earlier
  - Boa 0.94.14rc21 and earlier

- **Specific Exploit Details:** The provided content includes proof of concept exploits using curl and netcat that insert escape sequences into the HTTP request path to be logged by the vulnerable servers. An example is:
`curl -kis http://localhost/%1b%5d%32%3b%6f%77%6e%65%64%07%0a`
or
`echo -en "GET /\x1b]2;owned?\x07\x0a\x0d\x0a\x0d" > payload`
`nc localhost 80 < payload`
These sequences inject the escape sequence `\e]2;owned?\a` into the log, which when printed to a terminal changes the terminal title to "owned?".

- **Workarounds/Fixes:**
  - Cherokee has released a patch.
  - WEBrick (Ruby) has released a patch, details available at http://www.ruby-lang.org/en/news/2010/01/10/webrick-escape-sequence-injection
  - The provided webrick patch sanitizes the log output using `AccessLog.escape` which encodes control characters using the `.dump[1...-1]` method.
  - Varnish has marked the issue as "WONTFIX"

- **Additional Details:**
  - The advisory details the disclosure timeline and communication with each vendor.
  - The advisory also discusses a similar past vulnerability in Apache (CVE-2003-0020).
  - It acknowledges that the root cause is an issue with terminal emulators.
  - The advisory states that the authors contacted vendors and 3 released fixes, one acknowledged the issue, and one will not fix.