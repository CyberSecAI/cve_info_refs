=== Content from www.acunetix.com_0402a371_20250125_031419.html ===


[Get a demo](/web-vulnerability-scanner/demo/ "Get a demo")
Toggle navigation

[![Acunetix Website Security Scanner](https://www.acunetix.com/wp-content/themes/acunetix/img/logo-1.svg)](https://www.acunetix.com)

[Get a demo](/web-vulnerability-scanner/demo/ "Get a demo")

* [Product](/product/)
* Why Acunetix?
  + Solutions
    - INDUSTRIES
      * [IT & Telecom](/solutions/it-telecom/)
      * [Government](/solutions/government/)
      * [Financial Services](/solutions/financial-services/)
      * [Education](/solutions/education/)
      * [Healthcare](/solutions/healthcare/)
    - ROLES
      * [CTO & CISO](/solutions/cto-ciso/)
      * [Engineering Manager](/solutions/engineering-manager/)
      * [Security Engineer](/solutions/security-engineer/)
      * [DevSecOps](/solutions/devsecops/)
  + [Case Studies](https://www.acunetix.com/case-studies/)
  + [Customers](https://www.acunetix.com/vulnerability-scanner/customers/)
  + [Testimonials](/vulnerability-scanner/customer_testimonials/)
* [Pricing](https://www.acunetix.com/pricing/)
* About Us
  + [Our story](/about/)
  + [In the news](/blog/category/news/)
  + [Careers](/careers/)
  + [Contact](/contact/)
* Resources
  + [Blog](/blog/)
  + [Webinars](https://www.acunetix.com/webinars/)
  + [White papers](https://www.acunetix.com/white-papers/)
  + [Buyer’s guide](https://www.acunetix.com/resources/buyers-guide/)
  + [Partners](https://www.acunetix.com/partners/)
  + [Support](/support/)
* [Get a demo](https://www.acunetix.com/web-vulnerability-scanner/demo/)

[THE ACUNETIX BLOG](/blog/)

[News](https://www.acunetix.com/blog/category/news/)
# [AcuSensor, curl and Zen Cart](https://www.acunetix.com/blog/news/acusensor-curl-and-zen-cart/)

![](https://cdn.acunetix.com/wp-content/uploads/2019/01/22141821/image5.jpg)

Recently we’ve released a new build, build number [20091124](https://www.acunetix.com/blog/productnews/acunetix-wvs-version-6-5-build-20091124-released/). This build includes a new [AcuSensor](https://www.acunetix.com/websitesecurity/rightwvs/) check named “curl\_exec() url is controlled by user”. This new check will verify if the user can control the URL passed to **curl\_exec**.

In case you are not familiar with **curl**, below is a short abstract about curl taken from [PHP’s manual](http://www.php.net/manual/en/intro.curl.php):

> *PHP supports libcurl, a library created by Daniel Stenberg, that allows you to connect and communicate to many different types of servers with many different types of protocols. libcurl currently supports the http, https, ftp, gopher, telnet, dict, file, and ldap protocols. libcurl also supports HTTPS certificates, HTTP POST, HTTP PUT, FTP uploading (this can also be done with PHP’s ftp extension), HTTP form based upload, proxies, cookies, and user+password authentication.*

Usually, curl is used to connect and retrieve data from a remote URL using the http protocol. However, curl supports a bunch of protocols as you can see in the description above. One of these protocols is the **file** protocol. Using this protocol you can read local files by using an URL like **file:///etc/passwd**. Therefore, if the user can control the URL passed to curl\_exec, in some cases (if the content is echoed back) it can read local files.

While testing this new AcuSensor check on different applications, I’ve found a real-life example of a vulnerable application.  I’m talking about [Zen Cart](http://www.zen-cart.com/).  Acunetix WVS issued the following alert:

![curl_exec_zen_cart](https://cdn.acunetix.com/wp_content/uploads/2009/12/curl_exec_zen_cart.png "curl_exec_zen_cart")

From [Wikipedia](https://en.wikipedia.org/wiki/Zen_Cart):

> **Zen Cart** is an open source online store management system. It is PHP-based, using a MySQL database and HTML components. Support is provided for several languages and currencies, and it is freely available under the GNU General Public License.

Zen Cart contains a directory named **extras** where there are different test scripts. One of these scripts is **curltest.php**. This script is used for testing is the curl PHP library is installed and is working properly.

The source code of this script looks like this (only relevant pieces of code are shown):

![zen_cart_code](https://cdn.acunetix.com/wp_content/uploads/2009/12/zen_cart_code.png "zen_cart_code")

As you can see above, the URL passed to the curl\_setopt (CURLOPT\_URL) function and later used by curl\_exec comes from user input ($\_GET[‘url’]).

Also, the file contents (saved in the $result) are echoed back to the user. Therefore we cane read the contents of any file from the remote server.

![zen_cart_curl_etc_passwd](https://cdn.acunetix.com/wp_content/uploads/2009/12/zen_cart_curl_etc_passwd1.png "zen_cart_curl_etc_passwd")

As you can see in the screenshot above, it’s possible to read the contents of the /etc/passwd file.

However, the extras directory contains other test scripts. One of them, named **ipn\_test\_return.php**, is not properly written and will display an error message when called directly:

If you issue a request like http://bld02:80/zen-cart/extras/ipn\_test\_return.php

you will receive the following error message:

<br />

<b>Fatal error</b>: require() [<a href=’function.require’>function.require</a>]: Failed opening required ‘includes/application\_top.php’ (include\_path=’.:/usr/share/php:/usr/share/pear’) in <b>/var/www/bld/bld02/zen-cart/extras/ipn\_test\_return.php</b> on line <b>14</b><br />

This error message reveals the local path, so now we know where the application is installed. This could be useful to read the contents of the configuration file (includes/configure.php). This file contains the database credentials. If the Zen Cart database is not stored on the local server, it’s possible to access the database remotely.

Also, even without the file:// protocol, it’s possible to access hosts behind the firewall by issuing requests like

http://bld02/zen-cart/extras/curltest.php?url=http://192.168.0.1 or

http://bld02/zen-cart/extras/curltest.php?url=http://192.168.1.1.

The vendor released a security alert after being notified by us. They advise users to completely remove the extras directory as it’s not required by Zen Cart and it was distributed only for troubleshooting.

The security alert can be found [here](http://www.zen-cart.com/forum/showthread.php?t=142784).

Get the latest content on web security
 in your inbox each week.

We respect your
[privacy](//www.acunetix.com/company/privacy)

##### SHARE THIS POST

###### THE AUTHOR

![](https://cdn.acunetix.com/wp-content/uploads/2019/01/22141821/image5.jpg)

**Bogdan Calin**

Acunetix developers and tech agents regularly contribute to the blog. All the Acunetix developers come with years of experience in the web security sphere.

### Related Posts:

* [![library_seobusiness_featured](https://cdn.acunetix.com/wp-content/uploads/2021/05/11112633/ACX-Business-oriented-cybersecurity-non-technical-SEO-posts-600x315-1-230x121.png "What is server-side request forgery (SSRF)?")What is server-side request forgery (SSRF)?](https://www.acunetix.com/blog/articles/server-side-request-forgery-vulnerability/)Read more
* [![business-oriented-cybersecurity](https://cdn.acunetix.com/wp-content/uploads/2021/11/11112755/business-oriented-cybersecurity-230x121.png "DevSecOps: How to get there from DevOps")DevSecOps: How to get there from DevOps](https://www.acunetix.com/blog/web-security-zone/devsecops-from-devops/)Read more
* [![library_seobusiness_featured](https://cdn.acunetix.com/wp-content/uploads/2021/05/11112633/ACX-Business-oriented-cybersecurity-non-technical-SEO-posts-600x315-1-230x121.png "How to build a cyber incident response plan")How to build a cyber incident response plan](https://www.acunetix.com/blog/web-security-zone/cyber-incident-response-plan/)Read more

### Most Popular Articles:

* [![Acunetix](https://www.acunetix.com/wp-content/themes/acunetix/img/acunetix-logo.png)What is SQL Injection (SQLi) and How to Prevent It](https://www.acunetix.com/websitesecurity/sql-injection/)[Read more](https://www.acunetix.com/websitesecurity/sql-injection/)
* [![cross site scripting](https://cdn.acunetix.com/wp-content/uploads/2019/02/20104229/image1-5-300x133.png)Cross-site Scripting (XSS)](https://www.acunetix.com/websitesecurity/cross-site-scripting/)[Read more](https://www.acunetix.com/websitesecurity/cross-site-scripting/)
* [![Acunetix](https://www.acunetix.com/wp-content/themes/acunetix/img/acunetix-logo.png)Google Hacking: What is a Google Hack?](https://www.acunetix.com/websitesecurity/google-hacking/)[Read more](https://www.acunetix.com/websitesecurity/google-hacking/)

* [Older](https://www.acunetix.com/blog/news/changes-coming-to-the-owasp-top-10-in-2010/)
* [Newer](https://www.acunetix.com/blog/releases/acunetix-wvs-version-6-5-build-20091215-released/)

##### Subscribe by Email

Get the latest content on web security in your inbox each week.

We respect your
[privacy](//www.acunetix.com/company/privacy)

##### Learn More

* [IIS Security](https://www.acunetix.com/websitesecurity/iis-security/)
* [Apache Troubleshooting](https://www.acunetix.com/websitesecurity/troubleshooting-tips-for-apache/)
* [Security Scanner](https://www.acunetix.com/websitesecurity/security-scanner/)
* [DAST vs SAST](https://www.acunetix.com/blog/articles/dast-dynamic-application-security-testing/)
* [Threats, Vulnerabilities, & Risks](https://www.acunetix.com/blog/articles/cyber-threats-vulnerabilities-risks/)
* [Vulnerability Assessment vs Pen Testing](https://www.acunetix.com/blog/articles/difference-vulnerability-assessment-penetration-testing/)
* [Server Security](https://www.acunetix.com/websitesecurity/webserver-security/)
* [Google Hacking](https://www.acunetix.com/websitesecurity/google-hacking/)
##### Blog Categories

* [Articles](https://www.acunetix.com/blog/category/articles/)
* [Web Security Zone](https://www.acunetix.com/blog/category/web-security-zone/)
* [News](https://www.acunetix.com/blog/category/news/)
* [Events](https://www.acunetix.com/blog/category/events/)
* [Product Releases](https://www.acunetix.com/blog/category/releases/)
* [Product Articles](https://www.acunetix.com/blog/category/docs/)

![Client: AWS](https://cdn.acunetix.com/wp-content/uploads/2021/06/11112839/client-aws.svg "Client: AWS")
![Client: Cognizant](https://cdn.acunetix.com/wp-content/uploads/2021/06/11112839/client-cognizant.svg "Client: Cognizant")
![Client: Garmin](https://cdn.acunetix.com/wp-content/uploads/2021/06/08064354/client-garmin-white.svg "Client: Garmin")
![Client: Airforce](https://cdn.acunetix.com/wp-content/uploads/2021/06/11112839/client-airforce.svg "Client: Airforce")
![Client: NASA](https://cdn.acunetix.com/wp-content/uploads/2021/06/08081912/client-nasa.svg "Client: NASA")
![Client: American Express](https://cdn.acunetix.com/wp-content/uploads/2021/06/11112839/client-american-express.svg "Client: American Express")

##### Product Information

* [AcuSensor Technology](https://www.acunetix.com/vulnerability-scanner/acusensor-technology/)
* [AcuMonitor Technology](https://www.acunetix.com/vulnerability-scanner/acumonitor-technology/)
* [Acunetix Integrations](https://www.acunetix.com/vulnerability-scanner/acunetix-integrations/)
* [Vulnerability Scanner](/vulnerability-scanner/)
* [Support Plans](https://www.acunetix.com/support-plans/)

##### Use Cases

* [Penetration Testing Software](https://www.acunetix.com/vulnerability-scanner/penetration-testing-software/)
* [Website Security Scanner](https://www.acunetix.com/vulnerability-scanner/website-security-scanner/)
* [External Vulnerability Scanner](https://www.acunetix.com/vulnerability-scanner/external-vulnerability-scanner/)
* [Web Application Security](https://www.acunetix.com/vulnerability-scanner/web-application-security/)
* [Vulnerability Management Software](https://www.acunetix.com/vulnerability-scanner/vulnerability-management-software/)

##### Website Security

* [Cross-site Scripting](https://www.acunetix.com/websitesecurity/cross-site-scripting/)
* [SQL Injection](https://www.acunetix.com/websitesecurity/sql-injection/)
* [Reflected XSS](https://www.acunetix.com/websitesecurity/xss/)
* [CSRF Attacks](https://www.acunetix.com/websitesecurity/csrf-attacks/)
* [Directory Traversal](https://www.acunetix.com/websitesecurity/directory-traversal/)

##### Learn More

* [White Papers](https://www.acunetix.com/white-papers/)
* [TLS Security](https://www.acunetix.com/blog/articles/tls-security-what-is-tls-ssl-part-1/)
* [WordPress Security](https://www.acunetix.com/vulnerability-scanner/wordpress-security-scan/)
* [Web Service Security](https://www.acunetix.com/websitesecurity/web-services-wp/)
* [Prevent SQL Injection](https://www.acunetix.com/blog/articles/prevent-sql-injection-vulnerabilities-in-php-applications/)

##### Company

* [About Us](https://www.acunetix.com/about/)
* [Customers](https://www.acunetix.com/vulnerability-scanner/customers/)
* [Become a Partner](https://www.acunetix.com/partners/)
* [Careers](https://www.acunetix.com/careers/)
* [Contact](https://www.acunetix.com/contact/)

##### Documentation

* [Case Studies](https://www.acunetix.com/case-studies/)
* [Support](https://www.acunetix.com/support/)
* [Videos](https://www.acunetix.com/support/videos/)
* [Vulnerability Index](/vulnerabilities)
* [Webinars](https://www.acunetix.com/webinars/)

* [Login](https://online.acunetix.com)
* [Invicti Subscription Services Agreement](https://www.invicti.com/legal/ssa/)
* [Privacy Policy](https://www.invicti.com/legal/privacy-policy/)
* [Terms of Use](https://www.acunetix.com/about/terms_conditions/)
* [Sitemap](https://www.acunetix.com/sitemap/)

* [Find us on Facebook](https://www.facebook.com/Acunetix)
* [Follow us on Twiter](https://www.twitter.com/Acunetix)
* [Follow us on LinkedIn](https://www.linkedin.com/company/acunetix)

[© Acunetix 2025, by Invicti](https://www.acunetix.com)


