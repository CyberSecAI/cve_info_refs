```
Message-Id: <200903020017.41042.steffen.joeris@skolelinux.de>
Date: Mon, 2 Mar 2009 00:17:40 +1100
From: Steffen Joeris <steffen.joeris@...lelinux.de>
To: oss-security@...ts.openwall.com
Subject: CVE id request: dkim-milter

Hi

I don't think anyone requested a CVE id for this yet.
dkim-milter suffers is prone to a DoS attack via crafted or revoked public key
record in DNS.

Links:

<http://sourceforge.net/tracker/index.php?func=detail&aid=2508602&group_id=139420&atid=744358>

<http://www.debian.org/security/2009/dsa-1728>

Could I please get a CVE id for this?

Cheers
Steffen
```
- **Root cause of vulnerability**: dkim-milter may crash during DKIM verification if it encounters a specially-crafted or revoked public key record in DNS.
- **Weaknesses/vulnerabilities present**: Improper assertion leading to a denial of service.
- **Impact of exploitation**: Denial of service by crashing the dkim-milter service.
- **Attack vectors**: Sending an email that requires DKIM verification which contains a crafted or revoked public key record in the DNS.
- **Required attacker capabilities/position**: The attacker needs to send an email to a mail server that uses dkim-milter for DKIM verification and include the crafted/revoked public key information.

```
Debian Security Advisory DSA-1728-1                  security@debian.org
<http://www.debian.org/security/>                           Florian Weimer
February 27, 2009                     <http://www.debian.org/security/faq>
- ------------------------------------------------------------------------

Package        : dkim-milter
Vulnerability  : improper assertion
Problem type   : remote
Debian-specific: no

It was discovered that dkim-milter, an implementation of the DomainKeys
Identified Mail protocol, may crash during DKIM verification if it
encounters a specially-crafted or revoked public key record in DNS.

The old stable distribution (etch) does not contain dkim-milter packages.

For the stable distribution (lenny), this problem has been fixed in
version 2.6.0.dfsg-1+lenny1.

For the unstable distribution (sid), this problem has been fixed in
version 2.6.0.dfsg-2.

We recommend that you upgrade your dkim-milter packages.
```
- **Root cause of vulnerability**: dkim-milter may crash during DKIM verification if it encounters a specially-crafted or revoked public key record in DNS.
- **Weaknesses/vulnerabilities present**: Improper assertion.
- **Impact of exploitation**: Remote denial of service.
- **Attack vectors**: Sending an email that requires DKIM verification which contains a crafted or revoked public key record in the DNS.
- **Required attacker capabilities/position**: The attacker needs to send an email to a mail server that uses dkim-milter for DKIM verification.
```
```
Based on the provided information, the following can be determined for CVE-2009-0770:

- **Root cause of vulnerability:** The dkim-milter software crashes when it encounters a crafted or revoked public key record in DNS during DKIM verification.
- **Weaknesses/vulnerabilities present:** The vulnerability is caused by an improper assertion in the code when handling the crafted/revoked public key.
- **Impact of exploitation:** A remote attacker can cause a denial-of-service (DoS) by crashing the dkim-milter service.
- **Attack vectors:** The attack vector is through sending a crafted email that triggers the vulnerability during DKIM verification.
- **Required attacker capabilities/position:** The attacker needs to be able to send emails to a server using dkim-milter and craft the email to include the malicious DNS record.