=== Content from www.blackhat.com_1c7782ce_20250125_004137.html ===

[home](https://www.blackhat.com)
[registration](../bh-registration/bh-registration.html)
[archives](../bh-media-archives/bh-multimedia-archives-index.html)
[press](../bh-press/press.html)
[blackpages](../blackpages/blackpages.html)
[sponsors](../bh-sponsors/sponsors.html)
[webcasts](../bh-webinars/webinars-index.html)

[![rss feed link](../images/rssfeed.gif)](https://www.blackhat.com/BlackHatRSS.xml)
![header graphic](../images/masthead.jpg)

## Speakers

* [Colin Ames](#Smith)
* [Ryan C. Barnett](#Barnett)
* [Cesar Cerrudo](#Cerrudo)
* [Matthew Flick](#Flick)
* [Xinwen Fu](#Fu)
* [Travis Goodspeed](#Goodspeed)
* [Vincenzo Iozzo](#Iozzo)
* [Ms. Jagdale](#Jagdale)
* [Dan Kaminsky](#Kaminsky)
* [WIlliam Kimball](#Kimball)
* [Brian Krumheuer](#Krumheuer)
* [Paul Kurtz](#Kurtz)
* [Adam Laurie](#Laurie)
* [Andrew Lindell](#Lindell)
* [David Litchfield](#Litchfield)
* [Moxie Marlinspike](#Marlinspike)
* [Michael Muckin](#Muckin)
* [Duc Nguyen](#Nguyen)
* [Jason Raber](#Krumheuer)
* [Joanna Rutkowska](#Wojtczuk)
* [Peter Silberman](#Silberman)
* [Val Smith](#Smith)
* [Michael Sutton](#Sutton)
* [Rafal Wojtczuk](#Wojtczuk)
* [Paul Wouters](#Wouters)
* [Earl Zmijewski](#Zmijewski)

# Black Hat DC 2009 Briefings Speakers

## Hyatt Regency Crystal City • February 16-17

# Speakers and Topics

[![capitol dome at night](../images/nightdome.gif "abe")](html/bh-dc-09/bh-dc-09-main.html)
## Ryan C. Barnett

### WAF Virtual Patching Challenge: Securing WebGoat with ModSecurity

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Barnett/BlackHat_DC_2009_Barnett_Virtual_Patching_ModSecurity.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Barnett_Virtual_Patching_ModSecurity.mp3)
[![presentation](../images/presentation.gif)](../../presentations/bh-dc-09/Barnett/BlackHat-DC-09-Barnett-WAF-Patching-Challenge-Whitepaper.pdf)
[![ppt](../images/ppt.gif)](../../presentations/bh-dc-09/Barnett/BlackHat-DC-09-Barnett-WAF-Patching-Challenge-slides.pdf)

## Cesar Cerrudo

### SQL Server Anti-Forensics

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Cerrudo/BlackHat_DC_2009_Cerrudo_SQL_Anti_Forensics.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Cerrudo_SQL_Anti_Forensics.mp3)
[![presentation](../images/presentation.gif)](../../presentations/bh-dc-09/Cerrudo/BlackHat-dc-09-Cerrudo-SQL-Anti-Forensics.pdf)
[![ppt](../images/ppt.gif)](../../presentations/bh-dc-09/Cerrudo/BlackHat-dc-09-Cerrudo-SQL-Anti-Forensics-slides.pdf)

## Matthew Flick

### XSS Anonymous Browser

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Flick/BlackHat_DC_2009_Flick_Yestrumskas_XSS_Anonymous_Browser.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Flick_Yestrumskas_XSS_Anonymous_Browser.mp3)
[![presentation](../images/presentation.gif)](../../presentations/bh-dc-09/Flick/BlackHat-DC-09-Flick-XAB-wp.pdf)
[![ppt](../images/ppt.gif)](../../presentations/bh-dc-09/Flick/BlackHat-DC-09-Flick-XAB_Slides.pdf)

## Xinwen Fu

### One Cell is Enough to Break Tor's Anonymity

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Fu/BlackHat_DC_2009_Fu_Break_Tor_Anonymity.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Fu_Break_Tor_Anonymity.mp3)
[![presentation](../images/presentation.gif)](../../presentations/bh-dc-09/Fu/BlackHat-DC-09-Fu-Break-Tors-Anonymity.pdf)
[![ppt](../images/ppt.gif)](../../presentations/bh-dc-09/Fu/BlackHat-DC-09-Fu-Break-Tors-Anonymity-slides.pdf)

## Travis Goodspeed

### Reversing and Exploiting Wireless Sensors

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Goodspeed/BlackHat_DC_2009_Goodspeed_Reversing_Wireless_Sensors.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Goodspeed_Reversing_Wireless_Sensors.mp3)
[![presentation](../images/presentation-off.gif)](../../presentations/bh-dc-09/Goodspeed/BlackHat-DC-09-Goodspeed-Reversing-Wireless-Sensors.pdf)
![ppt](../images/ppt-off.gif)

## Vincenzo Iozzo

### Let Your Mach-O Fly

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Iozzo/BlackHat_DC_2009_Iozzo_Let_Your_Mach-0_fly.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Iozzo_Let_Your_Mach-0_fly.mp3)
[![presentation](../images/presentation.gif)](../../presentations/bh-dc-09/Iozzo/BlackHat-DC-09-Iozzo-let-your-mach0-fly-whitepaper.pdf)
[![ppt](../images/ppt.gif)](../../presentations/bh-dc-09/Iozzo/BlackHat-DC-09-Iozzo-Macho-on-the-fly.pdf)
[![ppt](../images/tools.gif)](../../presentations/bh-dc-09/Iozzo/macho-on-the-fly.zip)

## Prajakta Jagdale

### Blinded by Flash: Widespread Security Risks Flash Developers Don't See

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Jagdale/BlackHat_DC_2009_Jagdale_Blinded_by_Flash.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Jagdale_Blinded_by_Flash.mp3)
![presentation](../images/presentation-off.gif)
[![ppt](../images/ppt.gif)](../../presentations/bh-dc-09/Jagdale/BlackHat-DC-09-Jagdale-Blinded-by-Flash.pdf)

## Dan Kaminsky

### DNS 2008 and the New (old) Nature of Critical Infrastructure

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Kaminsky/BlackHat_DC_2009_Kaminsky_DNS.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Kaminsky_DNS.mp3)
![presentation](../images/presentation-off.gif)
[![ppt](../images/ppt.gif)](../../presentations/bh-dc-09/Kaminsky/BlackHat-DC-09-Kaminsky-DNS-Critical-Infrastructure.pdf)

## William Kimball

### Emulation-based Software Protection Providing Encrypted Code Execution and Page Granularity Code Signing

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Kimball/BlackHat_DC_2009_Kimball_SecureQEMU.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Kimball_SecureQEMU.mp3)
[![presentation](../images/presentation.gif)](../../presentations/bh-dc-09/Kimball/BlackHat-DC-09-Kimball-Emulation-Software-Protection.pdf)
![ppt](../images/ppt-off.gif)

## Paul Kurtz

### **Keynote:** The Move from Strategic Indecision to Leadership in Cyberspace

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Kurtz/blackhat-dc-09-kurtz-keynote-slide.m4v)

## Brian Krumheuer, Jason Raber

### QuietRIATT: Rebuilding the Import Address Table Using Hooked DLL Calls

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Raber/BlackHat_DC_2009_Raber_Krumheuer_QuietRIATT.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Raber_Krumheuer_QuietRIATT.mp3)
[![presentation](../images/presentation.gif)](../../presentations/bh-dc-09/Krumheuer_Raber/BlackHat-DC-09-Krumheuer-Raber-QuietRIATT-WhitePaper.pdf)
[![ppt](../images/ppt.gif)](../../presentations/bh-dc-09/Krumheuer_Raber/BlackHat-DC-09-Krumheuer-Raber-QuietRIATT-Slides.pdf)

## Adam Laurie

### Satellite Hacking for Fun and Profit

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Laurie/BlackHat_DC_2009_Laurie_Satellite_Hacking.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Laurie_Satellite_Hacking.mp3)
![presentation](../images/presentation-off.gif)
[![ppt](../images/ppt.gif)](../../presentations/bh-dc-09/Laurie/BlackHat-DC-09-Laurie-Satellite-Hacking.pdf)

## Andrew Lindell

### Making Privacy-Preserving Data Mining Practical with Smartcards

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Lindell/BlackHat_DC_2009_Lindell_Data_Mining_Smartcards.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Lindell_Data_Mining_Smartcards.mp3)
[![presentation](../images/presentation.gif)](../../presentations/bh-dc-09/Lindell/BlackHat-DC-09-Lindell-Privacy-Data-Mining-whitepaper.pdf)
[![ppt](../images/ppt.gif)](../../presentations/bh-dc-09/Lindell/BlackHat-DC-09-Lindell-Privacy-Data-Mining-slides.pdf)

## David Litchfield

### The Forensic Investigation of a Compromised Oracle Database Server

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Litchfield/BlackHat_DC_2009_Litchfield_Oracle_Forensics.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Litchfield_Oracle_Forensics.mp3)
![presentation](../images/presentation-off.gif)
![ppt](../images/ppt-off.gif)

## Moxie Marlinspike

### New Techniques for Defeating SSL/TLS

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Marlinspike/BlackHat_DC_2009_Moxie_Marlinespike_Defeating_SSL_in_Practice.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Moxie_Marlinespike_Defeating_SSL_in_Practice.mp3)
![presentation](../images/presentation-off.gif)
[![ppt](../images/ppt.gif)](../../presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf)

## Michael Muckin

### Windows Vista Security Internals

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Muckin/BlackHat_DC_2009_Muckin_Vista_Security_Internals.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Muckin_Vista_Security_Internals.mp3)
[![presentation](../images/presentation.gif)](../../presentations/bh-dc-09/Muckin/BlackHat-DC-09-Muckin-vista-security-internals.pdf)
![ppt](../images/ppt-off.gif)

## Duc Nguyen

### Your Face Is NOT Your Password

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Nguyen/BlackHat_DC_2009_Nguyen_Face_Not_Password.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Nguyen_Face_Not_Password.mp3)
[![presentation](../images/presentation.gif)](../../presentations/bh-dc-09/Nguyen/BlackHat-DC-09-Nguyen-Face-not-your-password.pdf)
[![ppt](../images/ppt.gif)](../../presentations/bh-dc-09/Nguyen/BlackHat-DC-09-Nguyen-Face-not-your-password-slides.pdf)

##

## Peter Silberman

### Snort My Memory

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Silberman/BlackHat_DC_2009_Silberman_Snort_Memory.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Silberman_Snort_Memory.mp3)
[![presentation](../images/presentation.gif)](../../presentations/bh-dc-09/Silberman/BlackHat-DC-09-Silberman-Snort-My-Memory-Whitepaper.pdf)
[![ppt](../images/ppt.gif)](../../presentations/bh-dc-09/Silberman/BlackHat-DC-09-Silberman-Snort-My-Memory-slides.pdf)
[![ppt](../images/tools.gif)](../../presentations/bh-dc-09/Silberman/MindSniffer-BETA-0.01.zip)

## Val Smith, Colin Ames

### Dissecting Web Attacks

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Smith/BlackHat_DC_2009_Smith_Ames_Delchi_Dissecting_Attacks.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Smith_Ames_Delchi_Dissecting_Attacks.mp3)
[![presentation](../images/presentation.gif)](../../presentations/bh-dc-09/ValSmith/BlackHat-DC-09-valsmith-colin-Dissecting-Web-Attacks.pdf)
[![ppt](../images/ppt.gif)](../../presentations/bh-dc-09/ValSmith/BlackHat-DC-09-valsmith-colin-Web-Attack-Disection-slides.pdf)

## Michael Sutton

### A Wolf in Sheep's Clothing: The Dangers of Persistent Web Browser Storage

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Sutton/BlackHat_DC_2009_Sutton_Persistent_Browser_Storage.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Sutton_Persistent_Browser_Storage.mp3)
![presentation](../images/presentation-off.gif)
[![ppt](../images/ppt.gif)](../../presentations/bh-dc-09/Sutton/blackhat-dc-09-Sutton-persistent-storage.pdf)

## Rafal Wojtczuk & Joanna Rutkowska

### Attacking IntelÂ® Trusted Execution Technology

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Wojtczuk_Rutkowska/BlackHat_DC_2009_Rutkowska_Wojtczuk_Intel_TXT.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Rutkowska_Wojtczuk_Intel_TXT.mp3)
[![presentation](../images/presentation.gif)](../../presentations/bh-dc-09/Wojtczuk_Rutkowska/BlackHat-DC-09-Rutkowska-Attacking-Intel-TXT.zip)
[![ppt](../images/ppt.gif)](../../presentations/bh-dc-09/Wojtczuk_Rutkowska/BlackHat-DC-09-Rutkowska-Attacking-Intel-TXT-slides.pdf)

## Paul Wouters

### Defending Your DNS in a Post-Kaminsky World

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Wouters/BlackHat_DC_2009_Wouters_Defending_DNS.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Wouters_Defending_DNS.mp3)
[![presentation](../images/presentation.gif)](../../presentations/bh-dc-09/Wouters/BlackHat-DC-09-Wouters-Post-Dan-Kaminsky.pdf)
[![ppt](../images/ppt.gif)](../../presentations/bh-dc-09/Wouters/BlackHat-DC-09-Wouters-Post-Dan-Kaminsky-slides.pdf)

## Earl Zmijewski

### Defending Against BGP Man-In-The-Middle Attacks

---

[![video](../images/video.gif)](http://media.blackhat.com/bh-dc-09/video/Hepner/BlackHat_DC_2009_Hepner_Zmijewski_Defending_BGP.m4v)
[![audio](../images/audio.gif)](http://media.blackhat.com/bh-dc-09/audio/BlackHat_DC_2009_Hepner_Zmijewski_Defending_BGP.mp3)
[![presentation](../images/presentation-off.gif)](#"")
[![ppt](../images/ppt.gif)](../../presentations/bh-dc-09/Zmijewski/BlackHat-DC-09-Zmijewski-Defend-BGP-MITM.pdf)

## [Black Hat USA 2009](../bh-europe-09/bh-eu-09-main.html)

[![black hat logo](../images/webcast-sm.gif)](../bh-usa-09/bh-us-09-main.html)
July 25-30

Caesars Palace

Las Vegas, NV

[Training](../bh-usa-09/train-bh-usa-09-index.html) July 25-28
 [Briefings](../bh-usa-09/bh-us-09-main.html) July 29-30

[Black Hat USA Briefings Main page](../bh-usa-09/bh-us-09-main.html) is online now.

Find out about [our 2009 venue, Caesars Palace.](https://www.blackhat.com/html/bh-usa-09/bh-usa-09-venue.html)

[![Register Button](../images/register.gif)](../bh-registration/bh-registration-us-09.html "Black Hat USA 2009")

## [Black Hat Webcasts](../webinars/webinars-index.html)

[![webcast logo](../images/webcast-sm.gif)](../webinars/webinars-index.html)
On the third Thursday of every month, Black Hat does a free infosec webcast.
Meet security thought leaders and get your questions answered.

[![webcast logo](../images/rss-sm.gif)](https://www.blackhat.com/BlackHat-webcasts.xml)
Can't make it to our live webcast events? Subscribe to the [Black Hat Webcast RSS feed](https://www.blackhat.com/BlackHat-webcasts.xml) and take the webcasts with you in podcast form.

#### Upcoming Topics

* May 2009 - [Mobility and Security](../webinars/mobility.html)
* Jun 2009 - USA 2009 Preview
* Aug 2009 - USA 2009 Wrapup
* Sep 2009 - Privacy/Anonymity
* Oct 2009 - Forensics
* Nov 2009 - Year in Malware
* Dec 2009 - Hardware Hacking
* Jan 2009 - Virtualization
* Feb 2010 - Policy/Management

## Black Hat Social

### [LinkedIn](http://www.linkedin.com/groups?gid=37658&trk=hb_side_g)

[![linkedin logo](../images/linkedin-sm.gif)](http://www.linkedin.com/groups?gid=37658&trk=hb_side_g)
LinkedIn members can join our Black Hat Group and post news articles of interest to the community, make connections and discuss security topics.

### [Facebook](http://www.facebook.com/pages/Black-Hat-Briefings/107691635153)

[![flickr logo](../images/facebook-sm.gif)](http://www.facebook.com/pages/Black-Hat-Briefings/107691635153)
We have a Facebook fan page now. Please check us out there - share your ideas, your photos, and your videos with us.

### [Flickr](http://www.flickr.com/photos/30017677%40N05/)

[![flickr logo](../images/flickr-sm.gif)](http://www.flickr.com/photos/30017677%40N05/)
Check out our Black Hat photostream. Comment. Contribute. Got great pix? Share with the community.

### [Twitter](https://twitter.com/BlackHatevents)

[![twitter logo](../images/twitter-sm.gif)](https://twitter.com/BlackHatevents)
Find out what's going on with Black Hat in real time by following us on Twitter. Meet other Black Hat speakers and attendees, share what matters to you.

### [Delicious](http://delicious.com/BlackHatBriefings)

[![delicious logo](../images/delicious-sm.gif)](http://delicious.com/BlackHatBriefings)
When something in the news catches our eye at Black Hat HQ, we post the link on Delicious.

 [About Black Hat](../bh-about/about.html)  |
[Privacy Policy](../bh-about/privacy.html) |
Sponsorship Inquiry |
[DEFCON](https://www.defcon.org) |
[Black Hat Main RSS Feed](https://www.blackhat.com/BlackHatRSS.xml)



=== Content from www.blackhat.com_88e0e64f_20250125_004140.html ===
One Cell is Enough to Break Tor’s Anonymity

Xinwen Fu and Zhen Ling
White Paper for Black Hat DC 2009

1

Abstract— Tor is a real-world, circuit-based low-latency anony-
mous communication network, supporting TCP applications
over the Internet. In this paper, we present a new class of
attacks, protocol-level attacks, against Tor. Different from existing
attacks, these attacks can conﬁrm anonymous communication
relationships quickly and accurately by manipulating one single
cell and pose a serious threat against Tor. In protocol-level
attacks, a malicious entry onion router may duplicate, modify,
insert, or delete cells of a TCP stream from a sender. The
manipulated cells traverse middle onion routers and arrive at an
exit onion router along a circuit. Because Tor uses the counter
mode AES (AES-CTR) for encrypting cells, the manipulated
cells disrupt the normal counter at exit onion routers and
decryption at the exit onion router incurs cell recognition errors,
which are unique to the investigated protocol-level attacks. If
an accomplice of the attacker at the entry onion router also
controls the exit onion router and recognizes such cell recognition
errors, the communication relationship between the sender and
receiver will be conﬁrmed. Protocol-level attacks can also be
used for launching the denial-of-service (DoS) attack to disrupt
the operation of Tor. We have implemented these attacks on Tor
and our experiments validate their feasibility and effectiveness.
We also present guidelines for defending against such attacks.

Index Terms— Protocol-level Attacks, Anonymity, Mix Net-

works, Tor

I. INTRODUCTION

Concerns about privacy and security have received greater
attention with the rapid growth and public acceptance of
the Internet and the pervasive deployment of various wire-
less technologies. Anonymity has become a necessary and
legitimate aim in many applications, including anonymous
web browsing, location-based services (LBS), and E-voting.
In these applications, encryption alone cannot maintain the
anonymity required by participants [1], [2], [3].

Since Chaum pioneered the basic idea of anonymous
communication systems, referred to as mixes [4], in 1981,
researchers have developed various anonymity systems for
different applications. Mix techniques can be used for ei-
ther message-based (high-latency) or ﬂow-based (low-latency)
anonymity applications. Email
is a typical message-based
anonymity application, which has been thoroughly investigated
[5], [6]. Research on ﬂow-based anonymity applications has
recently received a lot of attention in order to preserve
anonymity in low-latency applications, including web brows-
ing and peer-to-peer ﬁle sharing [7], [8], [9].

Tor [8] is a popular low-latency anonymous communication
network, supporting TCP applications on the Internet. On
October 18, 2008, there were 1164 active Tor onion routers

Xinwen Fu is with Department of Computer Science, University of
Massachusetts Lowell (Email: xinwenfu@cs.uml.edu). Zhen Ling is with
School of Computer Science and Engineering, Southeast University, Li-
wenzheng Building (North) #241, Nanjing 210096, P.R. China (Email:
zhen ling@seu.edu.cn).

operating around the world, which form an overlay-based mix
network1. To communicate with an application server, a Tor
client selects an entry onion router, a middle onion router
and an exit onion router in the case of default path length
of 3. A circuit is ﬁrst built through this chain of three onion
routers and the client negotiates a session key with each onion
router. Then, application data is packed into cells, encrypted
and decrypted in an onion-like fashion and transmitted through
the circuit to the server [8].

Extensive research work has been carried out to investigate
attacks which can degrade the anonymous communication over
Tor. Most existing approaches are based on trafﬁc analysis
[3], [10], [11], [12], [13], [14], [15]. Speciﬁcally, to determine
whether Alice is communicating with Bob through Tor, such
attacks measure the similarity between the sender’s outbound
trafﬁc and the receiver’s inbound trafﬁc in order to conﬁrm
their communication relationship. However, attacks based on
trafﬁc analysis may suffer a high rate of false positives due to
various factors, such as Internet trafﬁc dynamics and the need
for a number of packets for the statistical analysis of trafﬁc.
In this paper, we present a new class of attacks against
Tor, namely protocol-level attacks, which do not rely on trafﬁc
analysis. In these attacks, the attacker needs to manipulate only
one cell to conﬁrm the communication relationship between
the sender and receiver and poses a serious threat against
Tor. In order to do so, the attacker may control multiple
onion routers, similar to assumptions in existing attacks [3],
[12]. A malicious entry onion router may duplicate, modify,
insert, or delete cells of a TCP stream from a sender. The
manipulated cells traverse middle onion routers and arrive at
exit onion routers along circuits. Tor uses the counter mode
of Advanced Encryption Standard (AES-CTR) for encryption
and decryption of cells at onion routers. The manipulated cells
will disrupt the normal counter at the middle and exit onion
routers and the decryption at the exit onion router will incur
cell recognition errors. Our investigation shows that such cell
recognition errors are unique to protocol-level attacks. If an
accomplice of the attacker at the entry onion router controls the
exit onion router and detects such cell recognition errors, the
communication relationship between the sender and receiver
will be conﬁrmed.

We have implemented these protocol-level attacks on Tor
and our experiments validate the feasibility and effectiveness
of these attacks. These attacks may also threaten the availabil-
ity of the anonymity service by Tor since a malicious onion
entry may release the circuits passing through it. We also
provide guidelines for defending against these attacks. The
attacks presented in this paper are one of the ﬁrst to exploit the

1In this paper, we use Tor router and onion router interchangeably. For
brevity, router is used for the same purpose and the meaning should be clear
from the context.

2

implementation of known anonymous communication systems
such as Tor.

can edit a conﬁguration ﬁle and conﬁgure a server to have
different combinations of those functions.

The remainder of this paper is organized as follows: We
introduce the basic operation of Tor in Section II. We present
the details of the protocol-level attacks, including the basic
principle, algorithms, and discussion, in Section III. In Sec-
tion IV, we show experimental results on Tor and validate
our ﬁndings. We give guidelines for defending against these
protocol-level attacks in Section V. We review related work
in Section VI and conclude this paper in Section VII.

II. BASIC COMPONENTS AND OPERATION OF TOR

In this section, we ﬁrst introduce the basic components
of the Tor network. We then present its operation, including
the circuit setup and its usage for transmitting TCP streams
anonymously.

A. Components of the Tor Network

Tor is a popular overlay network for anonymous commu-
nication over the Internet. It is an open source project and
provides anonymity service for TCP applications [16]. Figure
1 illustrates the basic components of Tor [17]. As shown in
Figure 1, there are four basic components:

1) Alice (i.e. Client). The client runs a local software called
onion proxy (OP) to anonymize the client data into Tor.
2) Bob (i.e. Server). It runs TCP applications such as a
web service and anonymously communicates with Alice
as the client over Tor.

3) Onion routers (OR). Onion routers are special proxies
that relay the application data between Alice and Bob.
In Tor, Transport Layer Security (TLS) connections are
used for the overlay link encryption between two onion
routers. The application data is packed into equal-sized
cells (512 bytes as shown in Figure 2) carried through
TLS connections.

4) Directory servers. They hold onion router information
such as public keys for onion routers. There are directory
authorities and directory caches. Directory authorities
hold authoritative information on onion routers and di-
rectory caches download directory information of onion
routers from authorities. The client downloads the onion
router directory from directory caches.

Alice
(OP)

Tor Network

Bob

Exit
(OR3)

Entry
(OR1)

Middle
(OR2)

Legend:

Client or Server

Onion Router

Directory Server

Fig. 1. Tor Network

Functions of onion proxy, onion router, and directory servers
are integrated into the Tor released software package. A user

Figure 2 illustrates the cell format used by Tor. All cells
have a three-bytes header, which is not encrypted in the
onion-like fashion so that the intermediate Tor routers can
see this header. The other 509 bytes are encrypted in the
onion-like fashion. There are two types of cells: the con-
trol cell shown in Figure 2 (a) and relay cell shown in
Figure 2 (b). The command ﬁeld (Command) of a con-
trol cell can be: CELL PADDING, used for keepalive and
optionally usable for link padding, although not used cur-
rently; CELL CREATE or CELL CREATED, used for setting
up a new circuit; and CELL DESTROY, used for releasing
a circuit. The command ﬁeld (Command) of a relay cell
is CELL RELAY. Notice that relay cells are used to carry
TCP stream data from Alice to Bob. The relay cell has an
additional header, namely the relay header. There are numer-
ous types of relay commands (Relay Command), including
RELAY COMMAND BEGIN, RELAY COMMAND DATA, RE-
LAY COMMAND END, RELAY COMMAND SENDME, RE-
LAY COMMAND EXTEND, RELAY COMMAND DROP, and
RELAY COMMAND RESOLVE2. We will explain these com-
mands further in later sections of the paper when we discuss
the Tor operations from protocol-level attacks perspective.

2

1

Circ_id Command

509

Data

(a) Tor Cell Format

2

1

1

2

2

4

2

498

Circ_id Command

Relay
Command

Recognized Stream_id Intergrity

Length

Data

(b) Tor Realy Cell Format

Fig. 2. Cell Format By Tor [8]

B. Selecting a Path and Creating a Circuit

In order to anonymously communicate with applications,
i.e., browsing a web server, a client uses a way of source
routing and chooses a series of onion routers from the locally
cached directory, downloaded from the directory caches [18].
We denote the series of onion routers as the path through Tor
[19]. The number of onion routers is referred to as the path
length. We use the default path length of 3 as an example
in Figure 1 to illustrate how the path is chosen. The client
ﬁrst chooses an appropriate exit onion router OR3, which
should have an exit policy supporting the relay of the TCP
stream from the sender. Then, the client chooses an appropriate
entry onion router OR1 (referred to as entry guard and used
to prevent certain proﬁling attacks [20]) and a middle onion
router OR2.

Once the path is chosen, the client initiates the procedure
of creating a circuit over the path incrementally, one hop
at a time. Figure 3 illustrates the procedure of creating a
circuit when the path has a default length of 3. Tor uses
TLS/SSLv3 for link authentication and encryption. In Figure

2All these can be found in or.h in released source code package by Tor.

Entry OR
(OR1)

Middle OR
(OR2)
(link is TLS-encrypted)  (link is TLS-encrypted)

Exit OR
(OR3)

Bob

(unencrypted)

Alice
(OP)

(link is TLS-encrypted)

Create C1,
E(g^x1)

Created C1,
g^y1, H(K1)

Legend:
E(x) --- RSA encryption
{X} --- AES encryption
CN --- a circuit ID numbered N

Relay C1,
{Extend, OR2, E(g^x2)}

Create C2,
E(g^x2)

Relay C1,
{Extended, g^y2, H(K2)}

Created C2
g^y2, H(K2)

Relay C1,
{{Extend, OR3, E(g^x2)}}

Relay C2,
{{Extend, OR3, E(g^x2)}}

Create C3,
E(g^x2)

Relay C1,
{{Extend, g^y3, H(K3)}}

Relay C2
{Extend, g^y3, H(K3)}

Created C3
Extend, g^y3, H(K3)

t

t

t

t

t

Fig. 3. Tor Circuit Creation [8]

3, OP ﬁrst sets up a TLS connection with OR1 using the
TLS protocol. Then, tunneling through this connection, OP
sends a CELL CREATE cell and uses the Difﬁe-Hellman (DH)
handshake protocol to negotiate a base key K1 = gxy with
OR1, which responds with a CELL CREATED cell. From
this base key material, a forward symmetric key kf1 and a
backward symmetric key kb1 are produced [17]. In this way,
a one-hop circuit C1 is created.

To extend the circuit one hop further,

the OP sends
to OR1 a RELAY COMMAND EXTEND cell, specifying the
i.e., OR2 in Figure 3.
address of the next onion router,
This RELAY COMMAND EXTEND cell is encrypted by AES
in the counter mode (AES-CTR) with kf1. Once OR1 re-
ceives this cell,
it decrypts the cell and negotiates secret
keys with OR2 using the DH handshake protocol. There-
fore, a second segment C2 of the 2-hop circuit
is cre-
ated. OR1 sends OP a RELAY COMMAND EXTENDED cell,
which holds information for OP generating the shared se-
cret keys: forward key kf2 and backward key kb2, with
OR2. This RELAY COMMAND EXTENDED cell is encrypted
by AES-CTR with key kb1. OP will decrypt
the RE-
LAY COMMAND EXTENDED cell and use the information
to create the corresponding keys. Encryption of later cells by
these secret keys uses AES-CTR as well.

Consequently, to extend the circuit to a 3-hop circuit, OP
sends OR2 a RELAY COMMAND EXTEND cell, specifying
the address of the third onion router, e.g., the OR3 shown
in Figure 3, through the 2-hop circuit. As we can see, the
cell is encrypted in an onion-like fashion [17]. The payload is
ﬁrst encrypted by kf2 and then by kf1. The encrypted cell,
like an onion, becomes thinner when it traverses an onion
router, which removes one layer of onion skin by decrypting
the encrypted cell. Therefore, when OR2 decrypts the cell,
it ﬁnds that the cell is meant to create another segment of
the circuit to OR3. OR2 negotiates with OR3 and sends a
RELAY COMMAND EXTENDED cell back to OP. This cell
is ﬁrst encrypted by kb2 at OR2 and then by kb1 at OR1. OP
decrypts the encrypted backward onion-like cell and derives
the shared secret keys with OR3, including the forward key

3

kf3 and backward key kb3.

In summary, OP negotiates secret keys with the three onion
routers one by one and consequently creates a circuit along
the path3. With the exception that the connection from the
exit onion router to the server is not link encrypted, other
connections along the path are all protected by TLS within Tor.
That is, cells encrypted in the onion-like fashion are protected
by link encryption. In the description above, we simply use a
circuit of path length 3 as an example and a circuit of path
length greater than 3 can be set up in a similar manner.

C. Transmitting TCP Streams

Without loss of generality, we will use a short TCP stream,
transferring 5 bytes of data “Hello” from Alice (OP) to Bob, as
an example to illustrate how a TCP stream is tunneled through
the circuit that has already been created by the procedures
described in Section II.B. Figure 4 illustrates this simple
example. Recall that at this stage, a client’s OP has established
secret keys with other onion routers and can encrypt the
application payload.

Alice
(OP)

(link is TLS-encrypted)

Entry OR
(OR1)

Middle OR
(OR2)
(link is TLS-encrypted)  (link is TLS-encrypted)

Exit OR
(OR3)

(unencrypted)

Bob

Relay C1,
{{{Begin<IP, Port>}}}

Relay C2,
{{Begin<IP, Port>}}

Relay C3,
{Begin<IP, Port>}

TCP Handshake
<IP, Port>

Relay C1,
{{{Connected}}}

Relay C2,
{{Connected}}

Relay C3,
{Connected}

Relay C1,
{{{Data, “Hello”}}}

Relay C2,
{{Data, “Hello”}}

Relay C3,
{Data, “Hello”}

“Hello”

Relay C1,
{{{End, Reason}}}

Relay C2,
{{End, Reason>}}

Relay C3,
{End, Reason}

TCP Teardown

t

t

t

t

t

Fig. 4. TCP Connection Creation and Data Transmission on Tor

To transmit data to Bob, Alice’s application (such as web
browser) ﬁrst contacts the OP, which is implemented as
a SOCKS proxy locally. The OP learns the destination IP
address and port. OP sends a RELAY COMMAND BEGIN cell
to the exit onion router OR3, and the cell is encrypted as
{{{Begin < IP, P ort >}kf3 }kf2 }kf1 , where the subscript
refers to the key used for encryption of one onion skin. The
three layers of onion skin are removed one by one each time
the cell traverses an onion router through the circuit as we de-
scribed in Section II.B. When OR3 removes the last onion skin
by decryption, it recognizes that the request intends to open a
TCP stream to a port at the destination IP, which belongs to
Bob. Therefore, OR3 acts as a proxy, sets up a TCP connection
with Bob, and sends a RELAY COMMAND CONNECTED
cell back to Alice’s OP. The OP then accepts data from
Alice’s application, packs it into relay cells with the Relay
Command of RELAY COMMAND DATA and transmits it to
Bob through the circuit. The whole process is transparent to
Alice, who only needs to conﬁgure the application to use the
OP. When Alice’s application ﬁnishes the data transmission,

3Each onion router checks the ﬂag, “Recognized” ﬁeld within the relay cell
shown in Figure 2 (b) to determine whether the cell reaches its end. In this
way, the encrypted cell has a ﬁxed size and its length does not swell as in
the public key encryption case [4].

the connection from Alice’s application to the OP will be
released. As shown in Figure 4, after 5 bytes of data “Hello”
in a RELAY COMMAND DATA cell is transmitted, Alice’s
application releases the connection to OP. OP then sends
a RELAY COMMAND END cell
to OR3 and OR3 ﬁnally
releases the connection to Bob. In this way, the circuit of path
over Tor will be released completely.

III. PROTOCOL-LEVEL ATTACKS

In this section, we ﬁrst introduce the basic principle of these
protocol-level attacks. We then present the detailed algorithms
followed by discussion.

A. Basic Principle

that

Recall

the purpose of these attacks is to conﬁrm
that Alice is communicating with Bob over Tor. We assume
that an attacker can control the entry and exit onion routers
(also called the malicious onion routers) used by a given
circuit for a TCP stream and launch protocol-level attacks by
manipulating the cells associated with the given circuit. The
malicious entry onion router logs the information, including
the source IP address and port used for a given circuit, the
circuit ID, and the time of the cell being manipulated. The
attacker may launch protocol-level attacks in the following
ways: (i) duplicating a target cell along the given circuit
and then sending the duplicated cell at an appropriate time;
(ii) modifying some bits of 509-bytes data of a target cell
and forwarding such a modiﬁed cell to the next hop along
the circuit over Tor; (iii) inserting an artiﬁcial cell into the
victim circuit at an appropriate time; and (iv) deleting a target
cell without forwarding it to the next hop. The duplicated
cell, modiﬁed cell, artiﬁcially inserted cell, or the cell after
the deleted cell traverses the circuit and arrives at the exit
onion router. The attacker at the malicious exit onion router
can detect cell recognition errors raised by those manipulated
cells. The attacker records the time of the cell recognition
error, the destination IP address and port associated with the
circuit, and the corresponding circuit ID. In this way, the
attackers can conﬁrm that the target cell enters Tor through
the malicious entry onion router and the target cell exits Tor
from the malicious exit onion router. Since the entry onion
router knows the source IP address of the TCP stream and the
exit onion router knows the destination IP address of the TCP
stream, the communication relationship between the sender
and receiver will be conﬁrmed. In the following, we will
explain the detailed algorithms of these protocol-level attacks.

B. Algorithms of Protocol-Level Attacks

We studied and implemented these four protocol-level at-
tacks based on the Tor release version of 0.2.0.284. To validate
such attacks, we need to modify the source code of the
malicious entry onion router and exit onion router. From the
description in Section III.A, we know that for a successful
protocol-level attack, there are two important issues. One is
how to choose the time to launch the attack and how to select

4Newer release versions of Tor have not changed the algorithms investigated

in this paper.

4

the cell to manipulate at the entry onion router. The other is
how to recognize the error at the exit onion router.

At an entry onion router, the attacker needs to carefully
choose the time to launch the attack and identify the cell to
be manipulated. For example, if a cell is selected during the
circuit setup process, the duplicated cell traversing through the
victim circuit will cause numerous protocol errors and imme-
diately cause the circuit to fail upon its creation. Therefore, the
protocol-level attacks need to manipulate cells carrying TCP
stream data instead of cells carrying control commands for
circuit setup. Although cells are encrypted, the attacker at the
entry onion router can determine the relay cells based on the
relay command in the cell header. We now present the detailed
steps of launching these protocol-level attacks.

Step 1: The attacker at entry onion routers receives many
requests from an OP or other onion routers. The attacker needs
to verify whether these requests originate from an OP, not
from other onion routers that use the malicious entry onion
router as a middle onion router or an exit onion router.

The rule of the veriﬁcation is that, if the source IP address of
the request is not in the list of directory servers, this request is
from an OP. From the procedure of creating a circuit shown in
Figure 3, we know that the attacker can determine the moment
when the circuit is created. In terms of a circuit with default
path length of 3, the circuit is created if one CELL CREATE
and two CELL RELAY cells are transmitted on the forward
path, and one CELL CREATED cell and two CELL RELAY
cells on the backward path. Therefore, at a malicious entry
onion router, after one CELL CREATE and two CELL RELAY
cells are transmitted on the forward path, the attacker knows
that this circuit is completely created.

Step 2: Now the attacker needs to determine the time to

launch the attack and select appropriate target cells.

the circuit
is created, according to the proce-
After
dure of
transmitting a TCP stream shown in Figure 4,
OP will send a relay cell with the relay command RE-
LAY COMMAND BEGIN in the relay header of the cell.
This speciﬁc cell is used to request the exit onion router
to setup a TCP connection to the server. After receiving the
cell, the exit onion router creates a TCP connection to the
server directly. Then the next relay cell sent by an OP shall
contain TCP stream data and relay command of this cell is
CELL RELAY DATA. After an OP successfully sends all data
to the server, it will receive and forward the ﬁnal relay cell
with relay command CELL RELAY END. When the exit router
receives this cell, it releases the TCP connection to the server.
Therefore, according to the procedures of creating a circuit
and transmitting TCP streams over the circuit, the attacker at
the entry onion router can determine the CELL RELAY BEGIN
cell and the ﬁrst CELL RELAY DATA cell. To summarize,
after the attacker at
the entry onion router records one
CELL CREATE cell and three CELL RELAY cells on the
forward path with the same circuit ID, the attacker decides
that the third CELL RELAY cell on the forward path will be a
CELL RELAY BEGIN cell. Then the relay cell after that will
be CELL RELAY DATA cell, i.e., the ﬁrst cell with TCP stream
data from an OP.

Step 3: Since the cells from an OP are identiﬁed in the
second step, the attacker can now launch the protocol-level

attacks in the following different ways:

1. Replay A Cell: Figure 5 illustrates the basic principle of
this attack. At an entry onion router, the attacker identiﬁes
the ﬁrst CELL RELAY DATA cell on a victim circuit and
duplicates it. Then, the duplicated cell will traverse the circuit
and arrive at the exit onion router. The attacker at the malicious
exit onion router will detect a cell recognition error caused by
this duplicated cell.

We now go through cases and explain details that cause the
cell recognition error. When a data cell is duplicated at OR1,
the decryption at OR2 and OR3 will fail. The reason is that
the cell’s onion layers are encrypted using AES in the counter
mode and the counter is disturbed by the duplicated cell.
Speciﬁcally, in the counter mode, encryption and decryption
operations need to keep a synchronized value, a counter. The
encryption of a cell at an OP increases the AES counter by
one. The three routers along the path increase the counter for
each cell they receive and decrypt the original cell successfully.
When OR1 duplicates a cell, the duplicate cell causes OR2 and
OR3 to increase the counter and this makes the decryption
of this cell on OR2 and OR3 unsynchronized and incurs a
decryption error. In the current Tor implementation, default
actions to this error are: OR3 releases the circuit and an OP
creates another circuit for continuous communication. Notice
that although the decryption at OR2 is wrong, it does not raise
any action on the circuit. This is because the cell is onion-like
encrypted, the two ﬁelds, Recognized and Integrity (in Figure 2
(b)) used for integrity checking can only be recognized after all
layers of encryption are removed, and OR2 cannot recognize
the decryption error associated with the duplicated cell. OR3
can use the ﬁelds of “Recognized” or “Integrity” of the relay
header in Figure 2 (b) to recognize the error since all the onion
layers should have been removed at OR3.

Alice
(OP)

Entry OR
(OR1)

Middel OR
(OR2)
(link is TLS-encrypted) (link is TLS-encrypted)

Exit OR
(OR3)

Bob

(unencrypted)

(link is TLS-encrypted)

Relay C1,
{{{Begin<IP,Port>}}}

Relay C2,
{{Begin<IP,Port>}}

Relay C1,
{{{Connected}}}

Relay C2,
{{Connected}}

Relay C3,
{Begin<IP,Port>}

Relay C3,
{Connected}

TCP Handshake
<IP,Port>

Relay C1,
{{{Data,”Hello”}}}

Relay C2,
{{Data,”Hello”}}

Relay C3,
{Data,”Hello”}

“Hello”

Relay C2,
{{Data,”Hello”}}

Relay C3,
{Data,”Hello”}

TCP Teardown

Relay C1,
{{{End,Reason}}}

Relay C2,
{{End,Reason}}

Relay C3,
{End,Reason}

t

t

t

t

t

Fig. 5. Replay a Cell on Tor

2. Modify A Cell: Figure 6 illustrates the basic principle of
this attack. At an entry router, the attacker captures the ﬁrst
CELL RELAY DATA cell on a circuit and modiﬁes certain data
in the encrypted payload. For example, the attacker can set the
ﬁrst byte of the encrypted payload to zero. When this modiﬁed

5

cell passes through the circuit and arrives at the exit onion
router, the attacker at the malicious exit onion router will also
detect the cell recognition error caused by this modiﬁed cell
since the modiﬁed cell destroys the integrity of the cell and
the exit onion router will not be able to decrypt it correctly.

Alice
(OP)

Entry OR
(OR1)

Middel OR
(OR2)
(link is TLS-encrypted) (link is TLS-encrypted)

Exit OR
(OR3)

Bob

(unencrypted)

(link is TLS-encrypted)

Relay C1,
{{{Begin<IP,Port>}}}

Relay C2,
{{Begin<IP,Port>}}

Relay C3,
{Begin<IP,Port>}

TCP Handshake
<IP,Port>

Relay C1,
{{{Connected}}}

Relay C2,
{{Connected}}

Relay C3,
{Connected}

Relay C1,
{{{Data,”Hello”}}}

Relay C2,
{{Data,”XXXX”}}

Relay C3,
{Data,”XXXX”}

TCP Teardown

Relay C1,
{{{End,Reason}}}

Relay C2,
{{End,Reason}}

Relay C3,
{End,Reason}

t

t

t

t

t

Fig. 6. Modify a Cell on Tor

The attack of modifying a cell shares some similarity with
“tagging” attack described in [8]. The work in [8] claimed that
Tor can prevent tagging attacks by applying integrity checks.
However, the attacks we investigated in this paper utilize the
error information created by the integrity check at malicious
routers. The attack of modifying a cell can still conﬁrm the
communication relationship and pose a serious threat against
Tor.

3. Insert a Faked Cell: Figure 7 illustrates the basic
principle of this attack. When the attacker relays the ﬁrst
CELL RELAY DATA cell on a circuit, the attacker at an entry
onion router inserts a new faked relay cell constructed by
himself on the forward path. The circuit ID of the faked cell
will be the same as other cells on the target circuit. However,
the payload of this faked cell will be randomly generated. Then
the faked cell will traverse the circuit and arrive at the exit
onion router. The attacker at the malicious exit onion router
will detect a cell recognition error caused by this faked cell.
The principle of the cell recognition error caused at the exit
onion router is similar to the one which replays a cell on the
circuit. When OR1 inserts a new faked cell, the inserted cell
causes OR2 and OR3 to increase the counter. This will make
the encryption and decryption of the faked cell at OR2 and
OR3 unsynchronized.

4. Delete A Cell: Figure 8 illustrates the basic principle
of this attack. An attacker at the entry onion router identiﬁes
the ﬁrst CELL RELAY DATA cell on a circuit and deletes it.
Then, the attacker relays the second relay cell, as usual. The
second relay cell will traverse the circuit and arrive at the
exit onion router. The attacker at the malicious exit onion
router will detect a cell recognition error caused by the deleted
cell. The principle of the recognition error caused at the exit
onion router is also similar to replaying a cell on the circuit.

Alice
(OP)

Entry OR
(OR1)

Middel OR
(OR2)
(link is TLS-encrypted) (link is TLS-encrypted)

Exit OR
(OR3)

Bob

(unencrypted)

(link is TLS-encrypted)

Relay C1,
{{{Begin<IP,Port>}}}

Relay C2,
{{Begin<IP,Port>}}

Relay C3,
{Begin<IP,Port>}

TCP Handshake
<IP,Port>

Relay C1,
{{{Connected}}}

Relay C2,
{{Connected}}

Relay C3,
{Connected}

Relay C1,
{{{Data,”Hello”}}}

Relay C2,
{{Data,”Hello”}}

Relay C3,
{Data,”Hello”}

“Hello”

Relay C2,
{{Data,”0000”}}

Relay C3,
{Data,”0000”}

TCP Teardown

Relay C1,
{{{End,Reason}}}

Relay C2,
{{End,Reason}}

Relay C3,
{End,Reason}

t

t

t

t

t

Fig. 7.

Insert a Faked Cell on Tor

When OR1 deletes a cell, the deleted cell causes OR2 and
OR3 to not be able to increase the counter. This makes the
encryption and decryption of succeeding cells at OR2 and OR3
unsynchronized.

Alice
(OP)

Entry OR
(OR1)

Middel OR
(OR2)
(link is TLS-encrypted) (link is TLS-encrypted)

Exit OR
(OR3)

Bob

(unencrypted)

(link is TLS-encrypted)

Relay C1,
{{{Begin<IP,Port>}}}

Relay C2,
{{Begin<IP,Port>}}

Relay C1,
{{{Connected}}}

Relay C2,
{{Connected}}

Relay C3,
{Begin<IP,Port>}

Relay C3,
{Connected}

TCP Handshake
<IP,Port>

Relay C1,
{{{Data,”Hello”}}}

Relay C2,
{{Data,”Hello”}}

Relay C1,
{{{End,Reason}}}

Relay C2,
{{End,Reason}}

Relay C3,
{End,Reason}

TCP Teardown

t

t

t

t

t

Fig. 8. Delete a Cell on Tor

Step 4: At this step, the attackers will conﬁrm the commu-

nication relationship between Alice and Bob.

Recall that when cells of a given circuit are manipulated
at the malicious entry onion router, cell recognition errors
will show up at the exit onion router if the TCP stream is
transmitted through that circuit. The exit onion router records
the circuit ID, the destination IP address, the port number,
and timestamp. The entry router records the timestamp of
manipulation, the circuit ID, and the source IP address. We use
Network Time Protocol (NTP) to synchronize the malicious
entry and onion routers. By correlating the time of sending a
manipulated cell with the time of detecting a cell recognition
error, we can conﬁrm that the recognition error is actually

6

caused by the manipulated cell. To the best of our knowledge,
based on extensive experiments on Tor over months, these
cell recognition errors are unique to protocol-level attacks and
the probability of other facts causing such errors is very low.
Once there is a cell manipulation at the entry onion router
and a cell recognition error shows up at the exit onion router
simultaneously, the attackers know that the circuit segment
IDs recorded at the entry and exit routers belong to the same
circuit, which carries the target TCP stream data. Since the
entry onion router knows the source IP address of the TCP
stream and the exit onion router knows the destination IP
address of the TCP stream, the attackers can link the commu-
nication relationship between Alice and Bob. In Section IV,
we will use the time correlation as a measure to demonstrate
the correlation between the cell manipulation and recognition
error.

We can see that these protocol-level attacks are a very
powerful threat against Tor, since the attackers only need to
manipulate one cell and detect recognition errors. Therefore,
these attacks are simple, fast, and accurate. All these make
these attacks quite different from other existing attacks based
on trafﬁc analysis, which require lengthy parameter tuning for
the trade-off between the false positive rate and detection rate
[21], [11], [3], [12], [14], [15]. Additionally, these protocol-
level attacks are robust to the network size, trafﬁc dynamics,
and other anti-trafﬁc analysis strategies, including batching,
reordering, and dummy trafﬁc schemes [2], [22].

C. Discussion

1) Making Attacks Stealthy: In order to make the attack
stealthy, the attacker can choose an appropriate time to ma-
nipulate cells. Notice that once there is a cell recognition error,
the corresponding circuit will be released by default because
the AES counter is disturbed along the circuit. If the attacker
manipulates the cells when a TCP connection is still running,
the circuit will be released and other circuits will have to be
created to relay the rest of the TCP stream data from Alice to
Bob. This may raise Alice and Bob’s attention. Therefore, the
attacker shall replay the cells at the moment when the circuit
is not occupied with the stream data from Alice and before the
circuit is released by Alice. Such an attack will not degrade
the TCP performance and can be stealthy.

The attacker may even use a loop-control way to detect the
status of the TCP stream data and send the duplicated cell in
a proper time. One possible way is that the attacker at the exit
onion router with the full information of the target TCP stream
notiﬁes the attacker at the entry onion router. The attacker at
the entry onion router identities the ﬁrst CELL RELAY DATA
cell on a circuit and holds the duplicated cell until he or
she receives the indication from the attacker at the exit onion
router. When a CELL RELAY END cell is received at the exit
onion router, the attacker at the exit onion router will notify
the attacker at the entry onion router to send the duplicated
cell. After the duplicated cell arrives at the exit onion router,
the attacker at the exit onion router will detect an error caused
by the cell duplication. In this case, the TCP connection will
be disconnected by the OP as usual, and such an attack will
not be as detectable detected by Alice and Bob.

Figure 9 illustrates one example of this type of stealthy
attack. In a stealthy attack of replaying a cell, the attacker can
duplicate a cell, hold it, and replay the cell when the current
TCP session from OP is complete.

Alice
(OP)

Entry OR
(OR1)

Middel OR
(OR2)
(link is TLS-encrypted) (link is TLS-encrypted)

Exit OR
(OR3)

Bob

(unencrypted)

(link is TLS-encrypted)

Relay C1,
{{{Begin<IP,Port>}}}

Relay C2,
{{Begin<IP,Port>}}

Relay C3,
{Begin<IP,Port>}

TCP Handshake
<IP,Port>

Relay C1,
{{{Connected}}}

Relay C2,
{{Connected}}

Relay C3,
{Connected}

Relay C1,
{{{Data,”Hello”}}}

Relay C2,
{{Data,”Hello”}}

Relay C3,
{Data,”Hello”}

“Hello”

Relay C1,
{{{END,Reason}}}

Relay C2,
{{END,Reason}}

Relay C3,
{END,Reason}

TCP Teardown

Relay C2,
{{Data,”Hello”}}

Relay C3,
{Data,”Hello”}

t

t

t

t

t

Fig. 9. Duplicate and Hold a Cell on Tor

2) Controlling Onion Routers: In the discussion of these
protocol-level attacks, we assume that the attacker controls
some entry and exit onion routers. This is a reasonable
assumption due to the design principle of Tor, i.e., volunteer-
based operation [8]. Anyone can set up entry onion routers
and exit onion routers and join Tor. As long as a router has
an exit policy enabling access to external services, this onion
router becomes an exit onion router. To become an entry onion
router, a Tor router must meet some criteria. If an onion router
has a mean time between failure (MTBF) not less than the
median for active onion routers or at least 10 days, it becomes
a stable onion router. A stable onion router can be promoted
to an entry onion router if its bandwidth is either at least the
median among known active onion routers or at least 250KB/s
[18]. This set of criteria are not difﬁcult to meet by attackers
in real-world practice. Experiments in Section IV-B conﬁrm
this claim.

These protocol-level attacks can be more ﬂexible. The
requirement of a malicious exit onion router is not necessary
in these protocol-level attacks if an attacker can monitor
outbound streams from an exit onion router. This kind of
trafﬁc monitoring capability has been widely used by other
existing attacks [21], [11], [3], [12], [14], [15]. To this end,
using network trafﬁc monitoring tools, the attacker can record
the destination IP address and port number of outbound TCP
streams from an exit onion router. When the manipulated cell
arrives at the exit onion router and the monitored TCP stream
from this exit onion router aborts abruptly, this gives a positive
sign that the TCP stream from the sender travels along that
exit onion router, addressed to the corresponding receiver.

3) Reducing Noise: We now discuss the noise reduction
related to these protocol-level attacks. The false positive of
these attacks comes from unexpected cell recognition errors
caused by attacks. Based on our month-long experiments

7

on exit onion routers in Tor, we have not recorded such
unexpected errors. This conﬁrms that the false positive rate
of protocol-level attacks against Tor is very low.

In order to further decrease the false positive rate,
the
attacker may process multiple buffered cells from a single TCP
stream simultaneously. For each processed cell, we assume
that the detection rate and false positive rate of the protocol-
level attacks is pd and pf , respectively. We now derive the
detection rate PD and false positive rate PF for processing n
cells. When n cell recognition errors are detected at the exit
onion router, the probability that all errors are not caused by
the cell manipulation becomes (1−pd)n and the detection rate
becomes PD = 1−(1−pd)n. The corresponding false positive
rate is PF = pn
f . Therefore, by choosing an appropriate n, the
attacker can achieve a high detection rate and a small false
positive rate.

4) Launching DoS Attack: These protocol-level attacks can
also be used to launch other attacks, including DoS attack. In
order to launch DoS attack, the attacker only needs to control
entry onion routers. If the malicious entry onion router ma-
nipulates cells, it will cause corresponding exit onion routers
to disconnect the circuit and release the TCP connection. This
will slow the operation of Tor network if the attacker control
multiple malicious entry onion routers. In addition, Tor’s
directory authorities monitor the activities of onion routers
and may blacklist those innocent exit onion routers which
unexpectedly drop circuits and TCP connections. Although
those malicious entry routers are the root-cause for this, those
innocent exit onion routers become scapegoats. Due to the
anonymity naturally maintained by Tor, it will be non-trivial
to trace back to those malicious entry onion routers.

IV. EVALUATION

We have implemented the four protocol-level attacks with
schemes presented in Section III on Tor [23]. In this section,
we use real-world experiments to demonstrate the effectiveness
and feasibility of these protocol-level attacks on Tor. All the
experiments were conducted in a controlled manner and we
experimented on TCP ﬂows generated by ourselves in order
to avoid legal issues.

A. Experiment Setup

Figure 10 shows the experiment setup. We use two mali-
cious onion routers as the Tor entry onion router and exit onion
router. The entry onion router, client (Alice) and server (Bob)
are located in an ofﬁce on campus. The exit onion router is
located in an off-campus location. Computers on campus and
off-campus are on different public IP segments connecting to
different Internet service providers (ISPs).

To minimize the side effects of the protocol-level attacks
on Tor’s normal operation, we conduct experiments in a
partially controlled environment. We modify the Tor client
code for attack veriﬁcation purposes. The Tor client would
only build circuits through the designated malicious exit onion
router and entry onion router in Figure 10. The middle onion
router is selected using the default routing selection algorithm
released by Tor. Recall that the goal of the protocol-level
attacks is to conﬁrm whether the client communicates with the

Campus

Off-campus

Client

Malicious
Entry Router

Tor Network

Server

Malicious
Exit Router

Fig. 10. Experiment Setup

server. For veriﬁcation purposes, we created a simple client/
server application which transmits data through TCP. The
server in our experiments binds to port 41, receives packets,
and outputs relevant connection information to the server’s
screen for debugging and measurement purpose. The Tor client
utilizes tsocks [24] to automatically transport its outbound
TCP stream through the OP using SOCKS. By using the
Tor conﬁguration ﬁle and manipulatable parameters, such as
EntryNodes, ExitNodes, StrictEntryNodes, and StrictExitNodes
[19], we setup the client to select the malicious onion routers
along the circuit. The exit onion router uses the default exit
policy from Tor and the entry onion router’s exit policy only
allows it to be used as either an entry or middle router.

B. Experimental Results of Protocol-Level Attacks

The publicly available bandwidth information of onion
routers from the Tor directory servers conﬁrms that the set
of criteria for becoming an entry onion router is not difﬁcult
to meet. According to the bandwidth information collected
from the directory server on October 18, 2008, there were
1164 active onion routers on Tor, including 239 pure entry
onion routers, 411 pure exit onion routers, and 117 EE routers.
Figure 11 shows the bandwidth distribution of onion routers on
Tor, based on the directory information collected on August
18, 2008. The mean value of the bandwidth is only around
57KB/s. After running for only about 5 days, our onion router
with a bandwidth of 200KB/s was promoted to be an entry
guard.

To validate the accuracy of these protocol-level attacks, in
our experiments we let the client send a message packed in one
cell to the server approximately every 10 seconds. The revised
code at the entry onion router records the time of manipulating
cells. The revised code at the exit onion router records the
time of recognition errors and carries out the correlation test
to conﬁrm the communication relationship between the sender
and receiver. We use the correlation coefﬁcient r to measure
the strength of correlation between the time of manipulating
cells and the time of detecting the cell recognition errors.
Correlation coefﬁcient is deﬁned as

r =

(cid:3)(cid:2)

(cid:2)

x,y

(x − ¯x)(y − ¯y)
(cid:4)(cid:2)

(x − ¯x)2

(y − ¯y)2

x

y

,

(1)

8

exit onion router, and ¯x and ¯y are the mean values of x and
y, respectively.

Figures 12, 13, 14, 15 and 16 show the relationship between
the time of duplicating, modifying, inserting, and deleting cells
and the time of incurring cell recognition errors. Notice that
the Figure 13 shows the enhanced strategy to replay cells in a
stealthy manner as we discussed in Section III-C.1. As we can
see from these ﬁgures, there is a perfect linear correlation in
all the cases, since the actual correlation coefﬁcient between
them is one. This strongly conﬁrms that these protocol-level
attacks can accurately conﬁrm the communication relationship
if the sender and receiver use Tor to anonymize their commu-
nication. In addition to the high accuracy, these protocol-level
attacks can be very quick and efﬁcient, since the attacker only
needs to manipulate one cell and recognize the error caused
by the manipulated cell. Notice that the time correlation is
not necessary for these protocol-level attacks against Tor. The
perfect time correlation just validates the accuracy of these
attacks.

V. GUIDELINE OF COUNTERMEASURES

We have demonstrated the threat of several protocol-level
attacks against Tor. We now discuss possible countermeasures
to these attacks.

1) Minimizing Number of Compromised Entry Routers:
Recall that the protocol-level attacks require an attacker to
fully control at least one entry router. To achieve this, the
attacker may advertise the false bandwidth resource and pro-
mote compromised servers to be entry routers of Tor. There
are two possible ways to minimize the chance that compro-
mised servers become entry routers. First, the path selection
algorithm may be evolved and select only fully trusted and
dedicated ones through strict authentication and authorization
processes. Second, countermeasures may be developed to
detect false bandwidth advertisements from a compromised
router that intends to become Tor entry router via the attack
similar to Sybil attack [25]. For example, the path selection
protocols used by Tor can be augmented to allow onion
routers to proactively monitor each other and validate other
onion routers’ bandwidth [26]. A reputation-oriented defensive
scheme can be develop to further facilitate the countermeasure
to the attacks. In this way, the attacker will have less chance
to control the entry onion router and the effectiveness of these
protocol-level attacks will be reduced. However, this approach
cannot completely defend against these protocol-level attacks,
since the attackers may still contribute servers with high
bandwidth if enough bandwidth resources are available.

that

2) Monitoring Manipulated Cells: Recall

these
protocol-level attacks need to send the manipulated cells. If
manipulated cells can be detected and dropped at a middle
router before they reach to the exit onion router, the effective-
ness of such attacks will be signiﬁcantly reduced. To this end,
one naive way is to allow the middle onion router along the
circuit to detect manipulated cells by buffering historical cells.
However, this will raise more overhead to onion routers, since
Tor requires using a pair of memory buffers for reading and
writing data from each TCP stream [27].

where x is the time of manipulating cells at the entry onion
router, y is the time of cell recognition errors incurring at the

Another way to detect these protocol-level attacks is to
have the Tor’s clients and exit routers monitor the connections

1

0

1000

2000

3000

4000

5000

(a)  Box−and−whisker diagram

)
x
(
F

1

0.8

0.6

0.4

0.2

0
0

1000

2000

3000
Bandwidth (KB/s)

(b)  Cummulative probability function

4000

5000

median=57KB/s

9

1000

800

600

400

200

t
i
x
E
e
h
t

t
a

s
r
o
r
r

E
n
o
i
t
p
y
r
c
e
D

f
o

e
m
T

i

0
0

1000

800

600

400

200

t
i
x
E
e
h
t

t
a

s
r
o
r
r

E
n
o
i
t
y
r
c
e
D

f
o
e
m
T

i

0
0

200

400

600

800

1000

Time of Duplicating Cells at the Entry

(r=1)

200

400

600

800

Time of Holding Duplicated Cells at the Entry

1000

(r=1)

Fig. 11.
Onion Routers’ Bandwidth Distri-
bution on Tor: Bandwidth Median=57KB/s; (a)
Box and Whisker Plot of Bandwidth; (b) Cumu-
lative Distribution Function of Bandwidth

Fig. 12. Correlation Between Time of Dupli-
cated Cells and Time of Cell Recognition Errors

Fig. 13. Correlation Between Time of Holding
Duplicated Cells and Time of Cell Recognition
Errors

1000

800

600

400

200

t
i
x
E
e
h
t

t
a
s
r
o
r
r

E
n
o

i
t

p
y
r
c
e
D

f

o

e
m
T

i

0
0

1000

800

600

400

200

t
i
x
E
e
h
t

t
a
s
r
o
r
r

E
n
o

i
t
y
r
c
e
D

f

o
e
m
T

i

0
0

200

400

600

800

1000

Time of Modifying Cells at the Entry

(r=1)

1000

800

600

400

200

t
i
x
E
e
h
t

t
a
s
r
o
r
r

E
n
o

i
t
y
r
c
e
D

f

o
e
m
T

i

0
0

200

400

600

800

1000

Time of Inserting Cells at the Entry

(r=1)

200

400

600

800

1000

Time of Deleting Cells at the Entry

(r=1)

Fig. 14. Correlation Between Time of Modiﬁed
Cells and Time of Cell Recognition Errors

Fig. 15. Correlation Between Time of Inserted
Cells and Time of Cell Recognition Errors

Fig. 16. Correlation Between Time of Deleted
Cells and Time of Cell Recognition Errors

which have anomaly behavior. Since these attacks will cause
connections to be released and force the client switch to a
new circuit, a frequent connection release and circuit switch
may indicate the possibility of these protocol-level attacks.
The client cannot solely rely on the reported reason codes for
circuit release for detection purpose since the malicious exit
router may manipulate the reason code on purpose. When a
protocol-level attack is launched to conﬁrm the communication
relationship which does not exist, exit routers other than
the malicious ones will receive manipulated cells and detect
decryption errors. Such decryption errors may indicate a high
possibility of such attacks.

VI. RELATED WORK

Chaum pioneered the idea of anonymous communication
systems in [4]. A good review of various mix systems can be
found in [8], [5]. There has been much research on how to
degrade anonymous communication through mix networks. To
determine whether Alice is communicating with Bob, through
a mix network, similarity between Alice’s outbound trafﬁc
and Bob’s inbound trafﬁc may be measured. For example,
Zhu et al. [11] proposed the scheme of using mutual in-
formation for the similarity measurement. Levine et al. [10]
investigated a cross correlation technique. Murdoch et al.
[12] also investigated the timing-based attacks on Tor by
using some compromised Tor routers. Fu et al. [2] studied
a ﬂow marking scheme to actively embed a speciﬁc pattern
in the target ﬂow and conﬁrm the communication relationship

between the sender and receiver. Overlier et al. [3] studied
a scheme using one compromised mix node to identify the
“hidden server” anonymized by Tor. Yu et al. [15] proposed
an invisible traceback approach based on the direct sequence
spread spectrum (DSSS) technique. This approach could be
used by attackers to secretly trace the communication rela-
tionship via the anonymous communication networks.

Interval-based watermarks are proposed to trace attackers
through the stepping stones. For example, Wang et al. [28]
proposed a scheme that injected nondisplayable content into
packets. Wang et al. [29] proposed an active watermarking
scheme that was robust to random timing perturbation. They
analyzed the tradeoffs between the true positive rate, the max-
imum timing perturbation added by attackers, and the number
of packets needed to successfully decode the watermark. Wang
et al. [30] also investigated the feasibility of a timing-based
watermarking scheme in identifying the encrypted peer-to-
peer VoIP calls. By slightly changing the timing of packets,
their approach can correlate encrypted network connections.
Nevertheless, these timing-based schemes are not effective at
tracing communication through a mix network with batch-
ing strategies that manipulate inter-packet delivery timing,
as indicated in [15]. Peng et al. [31] analyzed the secrecy
of timing-based watermarking traceback proposed in [29],
based on the distribution of trafﬁc timing. Kiyavash et al.
[32] proposed a multi-ﬂow approach detecting the interval-
based watermarks [33], [34] and DSSS-based watermarks [15].
This multi-ﬂow based approach intends to average the rate

of multiple synchronized watermarked ﬂows and expects to
observe a unusual long silence period without packets or a
unusual long period of low-rate trafﬁc.

There is little research that has been conducted on the
attacks based on non-trafﬁc analysis. To the best of our
knowledge, Murdoch et al. [35] investigated an attack to reveal
hidden servers of Tor by exploiting the fact that the clock
deviations of a target server should be consistent with the
server’s load. Differently, the protocol-level attacks studied in
this paper exploit the fundamental protocol design in Tor. Our
investigated attacks are simple, accurate, quick, and easy to
deploy.

VII. CONCLUSION

In this paper, we introduced a new class of protocol-level
attacks on Tor, which allows the attacker to quickly and
accurately conﬁrm the anonymous communication over Tor. In
these attacks, the attacker at the malicious entry onion router
manipulates cells from the sender’s outbound TCP stream.
The manipulated cell will be carried along a circuit of Tor
and causes the cell recognition errors at the exit onion router.
Since such cell recognition errors are unique to these new
attacks, the attacker can conﬁrm the communication relation-
ship between the sender and receiver accurately and quickly.
Via extensive theoretical analysis and real-world experiments,
the effectiveness and feasibility of the protocol-level attacks
are validated. Our other preliminary data showed that these
protocol-level attacks may drastically degrade the anonymity
service that Tor provides, if the attacker is able to control a
small number of Tor routers. Such attacks may also be used
to threaten the availability of the anonymity service by Tor.

Due to Tor’s fundamental design, defending against these
protocol-level attacks remains a challenging task that we will
investigate in our future research.

ACKNOWLEDGMENT

We acknowledge the fruitful discussion of these protocol-
level attacks with Tor developers and researchers including
Roger Dingledine and Nick Mathewson.

REFERENCES

[1] Q. X. Sun, D. R. Simon, Y. Wang, W. Russell, V. N. Padmanabhan, and
L. L. Qiu, “Statistical identiﬁcation of encrypted web browsing trafﬁc,”
in Proceedings of IEEE Symposium on Security and Privacy (S&P),
May 2002.

[2] X. Fu, Y. Zhu, B. Graham, R. Bettati, and W. Zhao, “On ﬂow marking
attacks in wireless anonymous communication networks,” in Proceed-
ings of the IEEE International Conference on Distributed Computing
Systems (ICDCS), April 2005.

[3] L. Overlier and P. Syverson, “Locating hidden servers,” in Proceedings
of the IEEE Security and Privacy Symposium (S&P), May 2006.
[4] D. Chaum, “Untraceable electronic mail, return addresses, and digital
pseudonyms,” Communications of the ACM, vol. 4, no. 2, February 1981.
[5] G. Danezis, R. Dingledine, and N. Mathewson, “Mixminion: design of a
type iii anonymous remailer protocol,” in Proceedings of the 2003 IEEE
Symposium on Security and Privacy (S&P), May 2003.

[6] C. G¨ulc¨u and G. Tsudik, “Mixing email with babel,” in Proceedings
of the Network and Distributed Security Symposium (NDSS), February
1996.

[7] M. Reiter and A. Rubin, “Crowds: Anonymity for web transactions,”
ACM Transactions on Information and System Security, vol. 1, no. 1,
1998.

10

[8] R. Dingledine, N. Mathewson, and P. Syverson, “Tor: The second-
generation onion router,” in Proceedings of the 13th USENIX Security
Symposium, August 2004.

[9] Anonymizer, Inc., http://www.anonymizer.com/, 2008.
[10] B. N. Levine, M. K. Reiter, C. Wang, and M. Wright, “Timing attacks
in low-latency mix-based systems,” in Proceedings of Financial Cryp-
tography (FC), February 2004.

[11] Y. Zhu, X. Fu, B. Graham, R. Bettati, and W. Zhao, “On ﬂow correla-
tion attacks and countermeasures in mix networks,” in Proceedings of
Workshop on Privacy Enhancing Technologies (PET), May 2004.
[12] S. J. Murdoch and G. Danezis, “Low-cost trafﬁc analysis of tor,” in
Proceedings of the IEEE Security and Privacy Symposium (S&P), May
2006.

[13] K. Bauer, D. McCoy, D. Grunwald, T. Kohno, and D. Sicker, “Low-
resource routing attacks against anonymous systems,” in Proceedings of
ACM Workshop on Privacy in the Electronic Society (WPES), October
2007.

[14] X. Wang, S. Chen, and S. Jajodia, “Network ﬂow watermarking attack
on low-latency anonymous communication systems,” in Proceedings of
the IEEE Symposium on Security & Privacy (S&P), May 2008.
[15] W. Yu, X. Fu, S. Graham, D. Xuan, and W. Zhao, “Dsss-based ﬂow
marking technique for invisible traceback,” in Proceedings of the 2007
IEEE Symposium on Security and Privacy (S&P), 2007 May.

[16] R. Dingledine, N. Mathewson, and P. Syverson, “Tor: anonymity online,”

http://tor.eff.org/index.html.en, 2008.

[17] R. Dingledine and N. Mathewson, “Tor protocol speciﬁcation,” http:

//tor.eff.org/svn/trunk/doc/spec/tor-spec.txt, 2008.

[18] N. Mathewson, “Tor directory protocol, version 3,” http://tor.eff.org/svn/

trunk/doc/spec/dir-spec.txt, 2008.

[19] R. Dingledine and N. Mathewson, “Tor path speciﬁcation,” http://tor.eff.

org/svn/trunk/doc/spec/path-spec.txt, 2008.

[20] G. Danezis and R. Clayton, “Route ﬁngerprinting in anonymous commu-
nications,” in Proceedings of the Sixth IEEE International Conference
on Peer-to-Peer Computing, September 2006.

[21] M. Wright, M. Adler, B. N. Levine, and C. Shields, “Defending anony-
mous communication against passive logging attacks,” in Proceedings
of the IEEE Symposium on Security and Privacy, May 2003.

[22] A. Serjantov, R. Dingledine, and P. Syverson, “From a trickle to a ﬂood:
active attacks on several mix types,” in Proceedings of Information
Hiding Workshop (IH), February 2002.

[23] “Tor: anonymity online,” http://tor.eff.org/, 2008.
[24] “A transparent socks proxying library,” http://tsocks.sourceforge.net,

2008.

[25] K. Bauer, D. McCoy, D. Grunwald, T. Kohno, and D. Sicker, “Low-
resource routing attacks against anonymous systems,” University of
Colorado at Boulder, Tech. Rep., August 2007.

[26] K. Harfoush, A. Bestavros, and J. W. Byers, “Measuring bottleneck
the IEEE

bandwidth of targeted path segments,” in Proceedings of
INFOCOM, April 2003.
[27] “Theonionrouter/torfaq,”

http://wiki.noreply.org/noreply/

TheOnionRouter/TorFAQ, 2008.

[28] X. Wang, D. S. Reeves, S. F. Wu, and J. Yuill, “Sleepy watermark
tracing: An active network-based intrusion response framework,” in
Proceedings of 16th International Conference on Information Security
(IFIP/Sec), June 2001.

[29] X. Wang and D. S. Reeves, “Robust correlation of encrypted attack
trafﬁc through stepping stones by manipulation of inter-packet delays,”
in Proceedings of the 2003 ACM Conference on Computer and Com-
munications Security (CCS), November 2003.

[30] X. Wang, S. Chen, and S. Jajodia, “Tracking anonymous peer-to-peer
voip calls on the internet,” in Proceedings of the 12th ACM Conference
on Computer Communications Security (CCS), November 2005.
[31] P. Peng, P. Ning, and D. S. Reeves, “On the secrecy of timing-based
active watermarking trace-back techniques,” in Proceedings of the IEEE
Security and Privacy Symposium (S&P), May 2006.

[32] N. Kiyavash, A. Houmansadr, and N. Borisov, “Multi-ﬂow attacks
against network ﬂow watermarking schemes,” in Proceedings of USENIX
Security, 2008.

[33] Y. J. Pyun, Y. H. Park, X. Wang, D. S. Reeves, and P. Ning, “Tracing
trafﬁc through intermediate hosts that repacketize ﬂows,” in Proceedings
of IEEE INFOCOM, May 2007.

[34] S. C. X. Wang and S. Jajodia, “Network ﬂow watermarking attack on
low-latency anonymous communication systems,” in Proceedings of the
2007 IEEE Symposium on Security and Privacy (S&P), May 2007.
[35] S. J. Murdoch, “Hot or not: Revealing hidden services by their clock
skew,” in Proceedings of the 13th ACM Conference on Computer and
Communications Security (CCS), November 2006.


