```
{
  "CVE-2009-0787": {
    "Description": "A flaw was found in the ecryptfs_write_metadata_to_contents() function of the Linux kernel eCryptfs implementation. On systems with a 4096 byte page-size, this flaw may have caused 4096 bytes of uninitialized kernel memory to be written into the eCryptfs file headers, leading to an information leak. Note: Encrypted files created on systems running the vulnerable version of eCryptfs may contain leaked data in the eCryptfs file headers.",
    "Root cause of vulnerability": "The vulnerability lies in the `ecryptfs_write_metadata_to_contents()` function where the memory allocated for the eCryptfs header was smaller than the amount of data being written to the lower filesystem for the file header. Specifically a zeroed page was allocated using `get_zeroed_page()` but the size of the eCryptfs header was calculated using `num_header_bytes_at_front`, which could be larger than the size of the zeroed page. When writing the header to the file system the code would read beyond the bounds of the allocated memory, leading to an information leak.",
    "Weaknesses": [
      "Memory Leak",
      "Out-of-bounds Read"
    ],
    "Impact of exploitation": "The vulnerability could lead to an information leak, where random areas of kernel memory were written to the eCryptfs file header, which is then written to disk. An attacker could potentially gain sensitive information from the leaked kernel memory within ecryptfs headers.",
    "Attack vectors": "Local access to the system is required to create an eCryptfs mount and write files with potentially leaked header information.",
    "Required attacker capabilities/position": "The attacker requires the ability to create an eCryptfs mount. This means an unprivileged local user can trigger this vulnerability by creating and writing to an encrypted file, leaking kernel data into the header.",
    "Additional Details": "The vulnerability occurs when the page size is 4K, which causes a 4K page of uninitialized kernel memory to be written into the eCryptfs file header. Files created on systems running a vulnerable version of eCryptfs may contain the leaked data. This vulnerability was introduced in upstream commit 87b811c3f9 and affects upstream kernels version 2.6.28 onwards. The fix involves allocating memory for the header that matches the size calculated by `num_header_bytes_at_front`."
  }
}
```