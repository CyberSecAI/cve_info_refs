Based on the provided information, here's an analysis of CVE-2009-0502:

**Root cause of vulnerability:**

The root cause is insufficient sanitization of user input within the "Login as" functionality of Moodle. Specifically, certain input fields were not properly checked or encoded, leading to the injection of arbitrary web script.

**Weaknesses/vulnerabilities present:**

*   **Cross-Site Scripting (XSS):** The primary weakness is the presence of an XSS vulnerability. The lack of proper sanitization allows an attacker to inject malicious client-side scripts into a web page viewed by other users.

**Impact of exploitation:**

*   **Arbitrary Script Execution:** By injecting malicious scripts, attackers could potentially:
    *   Steal user session cookies
    *   Redirect users to phishing sites
    *   Perform actions on behalf of the user
    *   Deface the web page
    *   Potentially escalate privileges
    *   Other malicious actions limited by the context of the web application

**Attack vectors:**

*   The attack vector is through the "Login as" function in Moodle.
*   An attacker would need to find the vulnerable input field(s) and craft malicious JavaScript payloads within that input.
*   The crafted payload would be stored, and then executed when another user interacts with the vulnerable page or views the affected content.

**Required attacker capabilities/position:**

*   The attacker would need to have a valid account within the Moodle system with permission to use the "Login as" functionality.
*   The attacker would need to identify the specific vulnerable input point(s).

**Summary of Information from Different Sources:**

*   **Moodle.org:** Provides a general announcement of the vulnerability and refers to it as "XSS vulnerabilities in HTML blocks if 'Login as' used," listing affected versions and links to code changes in CVS.
*   **Debian.org:** Includes CVE-2009-0502 in a security advisory, describing it as an issue where "certain input via the 'Login as' function was not properly sanitized leading to the injection of arbitrary web script."
*  **Openwall.com:** References a request for a CVS update, mentioning that new versions of Moodle were released to fix multiple vulnerabilities including the XSS vulnerability.
*   **lists.opensuse.org:** Lists CVE-2009-0502 as one of the vulnerabilities fixed in a Moodle update, within a larger security report.
*  **Secunia.com:** Provides general information about Secunia Research and their vulnerability intelligence services, but does not specifically analyze this vulnerability.

**Additional details not present in the original CVE description**

* The Debian advisory clarifies that this is a "remote" vulnerability.
* The openSUSE advisory highlights that the vulnerability was fixed as a part of a larger set of security fixes.
* The Moodle advisory references code changes, which provide more details about the specific location of the bug.

In summary, CVE-2009-0502 describes an XSS vulnerability in the "Login as" function of Moodle, caused by insufficient sanitization of user-provided input. This could allow an attacker to execute arbitrary JavaScript code in the context of other users' browsers.