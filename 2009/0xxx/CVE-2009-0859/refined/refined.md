```
{
  "cve": "CVE-2009-0859",
  "analyzed_content": [
    {
      "type": "suse_security_advisory",
      "data": {
        "root_cause": "The `shm_get_stat` function in the shm subsystem of the Linux kernel, when `CONFIG_SHMEM` is disabled, misinterprets the data type of an inode.",
        "vulnerabilities": [
          "Incorrect data type interpretation",
          "Denial of service"
        ],
        "impact": "Local users can cause a denial of service (system hang) via an `SHM_INFO shmctl` call, which can be triggered by running the `ipcs` program.",
        "attack_vectors": [
          "Local exploitation by executing `shmctl` with `SHM_INFO` or running the `ipcs` command."
        ],
        "required_capabilities": [
          "Local user access"
        ],
         "affected_products": [
          "SLE SDK 10 SP2",
          "SUSE Linux Enterprise Desktop 10 SP2",
          "SUSE Linux Enterprise 10 SP2 DEBUGINFO",
          "SUSE Linux Enterprise Server 10 SP2",
            "openSUSE 10.3"
        ],
          "additional_notes": "SUSE is enabling CONFIG_SHMEM by default, so is not affected, but the fix was provided for completeness. Affected systems must disable the CONFIG_SHMEM kernel option during compilation. The issue was described as a system hang, and not just a crash. This advisory also mentions the GCC option -fwrapv which was added to compilation to work around potentially removing integer overflow checks."
      }
    },
     {
      "type": "debian_security_advisory",
      "data": {
        "root_cause": "A local user can cause a denial of service (system hang) using a `SHM_INFO shmctl` call on kernels compiled with `CONFIG_SHMEM` disabled.",
        "vulnerabilities": [
           "Incorrect data type interpretation",
           "Denial of service"
        ],
        "impact": "Local users can cause a denial of service (system hang) via an `SHM_INFO shmctl` call on kernels compiled with `CONFIG_SHMEM` disabled. This issue does not affect prebuilt Debian kernels.",
        "attack_vectors": [
          "Local exploitation by executing `shmctl` with `SHM_INFO`"
        ],
        "required_capabilities": [
          "Local user access"
        ],
          "affected_products": [
           "Debian 5.0 (lenny)",
           "Debian 4.0 (etch)"
        ],
        "additional_notes": "This issue does not affect prebuilt Debian kernels because they enable the `CONFIG_SHMEM` option. This also mentions numerous other CVEs that were resolved in this update."
      }
    },
     {
      "type": "secunia",
      "data": {
        "root_cause": "Not specified",
        "vulnerabilities": [
          "Not specified"
        ],
        "impact": "Not specified",
         "attack_vectors": [
          "Not specified"
        ],
        "required_capabilities": [
          "Not specified"
        ],
          "affected_products": [
         ],
        "additional_notes": "This entry only provides a general overview of the vulnerability research team at Secunia and has no specific information about the vulnerability. It does mention that the team produces security advisories based on research of the vulnerabilities."
      }
    },
    {
      "type": "kernel_commit_log",
      "data": {
        "root_cause": "The `shm_get_stat` function incorrectly assumes that the inode is always of type `shmem_inode_info`, which is not true when `CONFIG_SHMEM` is disabled. The function then attempts to access the `lock` field of the incorrect type.",
        "vulnerabilities": [
           "Incorrect data type interpretation",
           "Denial of service"
         ],
         "impact": "Invoking `shmctl(SHM_INFO)` can cause a system lockup due to the incorrect type assumption and subsequent access to a non-existent field when `CONFIG_SHMEM` is disabled.",
        "attack_vectors": [
           "Local exploitation by executing `shmctl` with `SHM_INFO` or running `ipcs`"
         ],
        "required_capabilities": [
           "Local user access"
         ],
          "affected_products": [
         ],
        "additional_notes": "The commit message mentions the vulnerability was reported by Jiri Olsa in February 2008."
      }
    },
    {
      "type": "suse_security_advisory",
      "data": {
        "root_cause": "The shm_get_stat function in ipc/shm.c in the shm subsystem in the Linux kernel, when CONFIG_SHMEM is disabled, misinterprets the data type of an inode.",
        "vulnerabilities": [
            "Incorrect data type interpretation",
           "Denial of service"
         ],
        "impact": "Local users to cause a denial of service (system hang) via an SHM_INFO shmctl call, as demonstrated by running the ipcs program.",
         "attack_vectors": [
          "Local exploitation by executing `shmctl` with `SHM_INFO` or running the `ipcs` command."
         ],
        "required_capabilities": [
          "Local user access"
        ],
        "affected_products": [
          "openSUSE 10.3"
        ],
        "additional_notes": "SUSE is enabling CONFIG_SHMEM, so is by default not affected, the fix is just for completeness. The description of the issue is that a system hang occurs, and not just a crash. This advisory also lists multiple other CVEs fixed in this update."
      }
    },
    {
      "type": "debian_security_advisory",
      "data": {
        "root_cause": "A local user can cause a denial of service (system hang) using a SHM_INFO shmctl call on kernels compiled with CONFIG_SHMEM disabled.",
        "vulnerabilities": [
            "Incorrect data type interpretation",
           "Denial of service"
        ],
        "impact": "Local user can cause a denial of service (system hang) using a SHM_INFO shmctl call on kernels compiled with CONFIG_SHMEM disabled. This issue does not affect prebuilt Debian kernels.",
         "attack_vectors": [
          "Local exploitation by executing `shmctl` with `SHM_INFO`"
        ],
        "required_capabilities": [
          "Local user access"
        ],
          "affected_products": [
           "Debian 5.0 (lenny)"
        ],
        "additional_notes": "The issue is described as affecting kernels compiled with CONFIG_SHMEM disabled. Prebuilt Debian kernels are not affected because they enable CONFIG_SHMEM. This advisory also lists numerous other CVEs fixed in this update."
      }
    },
    {
      "type": "kernel_commit_log",
      "data": {
        "root_cause": "The shm_get_stat function in ipc/shm.c incorrectly assumes that the inode it's operating on is always a `struct shmem_inode_info`, which is only true if `CONFIG_SHMEM` is enabled. This assumption leads to an attempt to access the lock field which does not exist when `CONFIG_SHMEM` is disabled.",
         "vulnerabilities": [
           "Incorrect data type interpretation",
           "Denial of service"
        ],
        "impact": "When `CONFIG_SHMEM` is disabled, a user can cause a system lockup by calling `shmctl(SHM_INFO)` due to the incorrect inode type assumption and subsequent attempted access to a non-existent lock field.",
        "attack_vectors": [
           "Local exploitation by executing `shmctl` with `SHM_INFO` or running the ipcs command"
         ],
         "required_capabilities": [
          "Local user access"
        ],
          "affected_products": [
        ],
        "additional_notes": "The bug was reported by Jiri Olsa in February 2008. The fix uses a conditional compilation to handle the `CONFIG_SHMEM` disabled case.  This fixes the shmctl(SHM_INFO) lockup with !CONFIG_SHMEM."
      }
    },
      {
      "type": "ubuntu_security_notice",
      "data": {
        "root_cause": "The shared memory subsystem did not correctly handle certain shmctl calls when CONFIG_SHMEM was disabled.",
          "vulnerabilities": [
           "Incorrect data type interpretation",
           "Denial of service"
         ],
        "impact": "Local users can cause a denial of service by making calls to shmctl. Ubuntu kernels were not vulnerable, since CONFIG_SHMEM is enabled by default.",
        "attack_vectors": [
            "Local exploitation by calling shmctl"
         ],
        "required_capabilities": [
             "Local user access"
        ],
          "affected_products": [
         "Ubuntu 8.10",
         "Ubuntu 8.04",
         "Ubuntu 7.10"
        ],
        "additional_notes": "Ubuntu kernels were not vulnerable as CONFIG_SHMEM is enabled by default. This notice contains several other vulnerabilities which were fixed in the update."
      }
    }
        ,
    {
      "type": "openwall",
      "data": {
        "root_cause": "The `shm_get_stat()` function assumes the inode is a 'struct shmem_inode_info', which is not true when `CONFIG_SHMEM` is disabled.",
        "vulnerabilities": [
           "Incorrect data type interpretation",
           "Denial of service"
         ],
        "impact": "This incorrect assumption leads to a lockup when `shm_get_stat()` tries to acquire a spinlock on the wrong data structure via `spin_lock(&info->lock)`. Invoking `ipcs` can trigger this lockup.",
        "attack_vectors": [
            "Local exploitation by executing `shmctl` with `SHM_INFO` or running the `ipcs` command."
         ],
        "required_capabilities": [
          "Local user access"
        ],
          "affected_products": [
        ],
        "additional_notes": "This is a CVE request for the issue, which was reported by Jiri Olsa back in February 2008."
      }
    }

  ]
}
```