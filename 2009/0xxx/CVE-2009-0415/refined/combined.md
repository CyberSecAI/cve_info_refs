=== Content from www.openwall.com_7058d929_20250125_053824.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](../../../2009/01/30/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <914336965.2985431233255231152.JavaMail.root@zmail01.collab.prod.int.phx2.redhat.com>
Date: Thu, 29 Jan 2009 13:53:51 -0500 (EST)
From: Josh Bressers <bressers@...hat.com>
To: oss-security <oss-security@...ts.openwall.com>
Cc: coley@...re.org
Subject: CVE Request (trickle)

Hi Steve,

trickle has what is similar to all the RPATH flaws that got CVE ids a while back:
<http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=513456>

It seems it could set a bad LD_PRELOAD path when the trickle command is run.

Thanks.

--
    JB

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugs.debian.org_3395b5ff_20250125_053824.html ===

# Debian Bug report logs - #513456 trickle: may load arbitrary code from the current working directory

[![version graph](version.cgi?fixed=trickle%2F1.07-6;collapse=1;package=trickle;width=2;height=2;found=trickle%2F1.07-5;absolute=0)](version.cgi?package=trickle;absolute=0;fixed=trickle%2F1.07-6;found=trickle%2F1.07-5;collapse=1;info=1)

Package:
[trickle](pkgreport.cgi?package=trickle);
Maintainer for [trickle](pkgreport.cgi?package=trickle) is [Alex Myczko <tar@debian.org>](pkgreport.cgi?maint=tar%40debian.org); Source for [trickle](pkgreport.cgi?package=trickle) is [src:trickle](pkgreport.cgi?src=trickle) ([PTS](https://tracker.debian.org/pkg/trickle), [buildd](https://buildd.debian.org/trickle), [popcon](https://qa.debian.org/popcon.php?package=trickle)).

Reported by: [Adeodato Simó <dato@net.com.org.es>](pkgreport.cgi?submitter=dato%40net.com.org.es)

Date: Thu, 29 Jan 2009 08:30:01 UTC

Severity: normal

Tags: security, upstream

Found in version trickle/1.07-5

Fixed in version trickle/1.07-6

**Done:** Robert Lemmen <robertle@semistable.com>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=513456;mbox=yes), [status mbox](bugreport.cgi?bug=513456;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=513456;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Robert Lemmen <robertle@semistable.com>`:

`Bug#513456`; Package `trickle`.
(Thu, 29 Jan 2009 08:30:04 GMT) ([full text](bugreport.cgi?bug=513456;msg=2), [mbox](bugreport.cgi?bug=513456;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Adeodato Simó <dato@net.com.org.es>`:

New Bug report received and forwarded. Copy sent to `Robert Lemmen <robertle@semistable.com>`.
(Thu, 29 Jan 2009 08:30:04 GMT) ([full text](bugreport.cgi?bug=513456;msg=4), [mbox](bugreport.cgi?bug=513456;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=513456;msg=5), [mbox](bugreport.cgi?bug=513456;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=dato%40net.com.org.es)
From: Adeodato Simó <dato@net.com.org.es>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: trickle: may load arbitrary code from the current working directory
Date: Thu, 29 Jan 2009 09:21:27 +0100
```
Package: trickle
Version: 1.07-5
Severity: normal
Tags: upstream

Hello, here's a copy of a mail I recently sent to the Security Team:

-8<-
Yesterday I was looking at the code of the trickle package, to see how
it worked. It uses the LD_PRELOAD mechanism to load a library that will
take care that no more bandwidth than the configured limits will be used.

This library lives in /usr/lib/trickle/trickle-overload.so. However,
the trickle.c program will prefer loading it from the current working
directory if a file named trickle-overload.so exists there.

I was wondering if this consitutes any kind of vulnerability, loading by
default arbitrary code from the current directory. The code can be seen
in trickle-1.07/trickle.c:

        char *trypaths[]  = {
                LIBNAME,
                LIBDIR "/" LIBNAME,
                NULL
        };

        ...

        for (pathp = trypaths; *pathp != NULL; pathp++)
                if (lstat(*pathp, &sb) == 0)
                        break;

        ...

        if (path[0] != '/') {
                /* make path absolute */
        }

        ...

        setenv("LD_PRELOAD", path, 1);

-8<-

Their response was:

-8<-
It should only load the library from a static system path under the exclusive
control of the local admin, otherwise someone could trick a user into running
trickle from a directory where the attacker has write access and placed a
manipulated library.

I'm not convinced this would warrant a DSA, but you should report this
upstream.
-8<-

Cheers,

--
Adeodato Simó                                     dato at net.com.org.es
Debian Developer                                  adeodato at debian.org

                              Listening to: Manolo Tena - Loco por verte

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#513456`; Package `trickle`.
(Thu, 29 Jan 2009 10:09:03 GMT) ([full text](bugreport.cgi?bug=513456;msg=7), [mbox](bugreport.cgi?bug=513456;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Robert Lemmen <robertle@semistable.com>`:

Extra info received and forwarded to list.
(Thu, 29 Jan 2009 10:09:03 GMT) ([full text](bugreport.cgi?bug=513456;msg=9), [mbox](bugreport.cgi?bug=513456;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 513456@bugs.debian.org ([full text](bugreport.cgi?bug=513456;msg=10), [mbox](bugreport.cgi?bug=513456;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=robertle%40semistable.com)
From: Robert Lemmen <robertle@semistable.com>
To: Adeodato Simó <dato@net.com.org.es>,
513456@bugs.debian.org
Subject: Re: Bug#513456: trickle: may load arbitrary code from the current
working directory
Date: Thu, 29 Jan 2009 10:19:31 +0000
```
[[Message part 1](bugreport.cgi?att=0;bug=513456;msg=10) (text/plain, inline)]
```
```
On Thu, Jan 29, 2009 at 09:21:27AM +0100, Adeodato Simó wrote:
> Yesterday I was looking at the code of the trickle package, to see how
> it worked. It uses the LD_PRELOAD mechanism to load a library that will
> take care that no more bandwidth than the configured limits will be used.
>
> This library lives in /usr/lib/trickle/trickle-overload.so. However,
> the trickle.c program will prefer loading it from the current working
> directory if a file named trickle-overload.so exists there.

excellent thanks for that, i'll take care of it

cu  robert

--
Robert Lemmen                               <http://www.semistable.com>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=513456;filename=signature.asc;msg=10) (application/pgp-signature, inline)]
```

---

**Tags added: security**
Request was from `Robert Lemmen <robertle@semistable.com>`
to `control@bugs.debian.org`.
(Thu, 29 Jan 2009 10:12:03 GMT) ([full text](bugreport.cgi?bug=513456;msg=12), [mbox](bugreport.cgi?bug=513456;mbox=yes;msg=12), [link](#11)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Robert Lemmen <robertle@semistable.com>`:

`Bug#513456`; Package `trickle`.
(Fri, 30 Jan 2009 09:06:05 GMT) ([full text](bugreport.cgi?bug=513456;msg=14), [mbox](bugreport.cgi?bug=513456;mbox=yes;msg=14), [link](#13)).

---

**Acknowledgement sent**
to `513456@bugs.debian.org, Adeodato Simó <dato@net.com.org.es>`:

Extra info received and forwarded to list. Copy sent to `Robert Lemmen <robertle@semistable.com>`.
(Fri, 30 Jan 2009 09:06:05 GMT) ([full text](bugreport.cgi?bug=513456;msg=16), [mbox](bugreport.cgi?bug=513456;mbox=yes;msg=16), [link](#15)).

---

[Message #17](#17) received at 513456@bugs.debian.org ([full text](bugreport.cgi?bug=513456;msg=17), [mbox](bugreport.cgi?bug=513456;mbox=yes;msg=17), reply):

![](/cgi-bin/libravatar.cgi?email=dato%40net.com.org.es)
From: Adeodato Simó <dato@net.com.org.es>
To: Robert Lemmen <robertle@semistable.com>, 513456@bugs.debian.org
Subject: Re: Bug#513456: trickle: may load arbitrary code from the current
working directory
Date: Fri, 30 Jan 2009 09:56:07 +0100
```
* Robert Lemmen [Thu, 29 Jan 2009 10:19:31 +0000]:

> On Thu, Jan 29, 2009 at 09:21:27AM +0100, Adeodato Simó wrote:
> > Yesterday I was looking at the code of the trickle package, to see how
> > it worked. It uses the LD_PRELOAD mechanism to load a library that will
> > take care that no more bandwidth than the configured limits will be used.

> > This library lives in /usr/lib/trickle/trickle-overload.so. However,
> > the trickle.c program will prefer loading it from the current working
> > directory if a file named trickle-overload.so exists there.

> excellent thanks for that, i'll take care of it

Great.

I'll note, however, that said insecure feature was actually useful to
me: I wanted to trickle a 32-bit application on an amd64 system. Of
course, the system-wide trickle-overload.so failed to load. So I grabbed
trickle_1.07-5_i386.deb, and started my application so that the 32-bit
overlay would be used instead.

If you'll be working with upstream to address this issue, maybe it would
be useful to add an --overload-file option to indicate the path of the
library to LD_PRELOAD.

Cheers,

--
Adeodato Simó                                     dato at net.com.org.es
Debian Developer                                  adeodato at debian.org

Russian roulette in bash: ((RANDOM%6)) || rm -rf ~

```

---

**Reply sent**
to `Robert Lemmen <robertle@semistable.com>`:

You have taken responsibility.
(Mon, 09 Feb 2009 22:48:11 GMT) ([full text](bugreport.cgi?bug=513456;msg=19), [mbox](bugreport.cgi?bug=513456;mbox=yes;msg=19), [link](#18)).

---

**Notification sent**
to `Adeodato Simó <dato@net.com.org.es>`:

Bug acknowledged by developer.
(Mon, 09 Feb 2009 22:48:12 GMT) ([full text](bugreport.cgi?bug=513456;msg=21), [mbox](bugreport.cgi?bug=513456;mbox=yes;msg=21), [link](#20)).

---

[Message #22](#22) received at 513456-close@bugs.debian.org ([full text](bugreport.cgi?bug=513456;msg=22), [mbox](bugreport.cgi?bug=513456;mbox=yes;msg=22), reply):

![](/cgi-bin/libravatar.cgi?email=robertle%40semistable.com)
From: Robert Lemmen <robertle@semistable.com>
To: 513456-close@bugs.debian.org
Subject: Bug#513456: fixed in trickle 1.07-6
Date: Mon, 09 Feb 2009 22:17:08 +0000
```
Source: trickle
Source-Version: 1.07-6

We believe that the bug you reported is fixed in the latest version of
trickle, which is due to be installed in the Debian FTP archive:

trickle_1.07-6.diff.gz
  to pool/main/t/trickle/trickle_1.07-6.diff.gz
trickle_1.07-6.dsc
  to pool/main/t/trickle/trickle_1.07-6.dsc
trickle_1.07-6_amd64.deb
  to pool/main/t/trickle/trickle_1.07-6_amd64.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 513456@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Robert Lemmen <robertle@semistable.com> (supplier of updated trickle package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Mon, 02 Feb 2009 17:43:16 +0000
Source: trickle
Binary: trickle
Architecture: source amd64
Version: 1.07-6
Distribution: unstable
Urgency: low
Maintainer: robertle@semistable.com
Changed-By: Robert Lemmen <robertle@semistable.com>
Description:
 trickle    - user-space bandwidth shaper
Closes: [513456](bugreport.cgi?bug=513456)
Changes:
 trickle (1.07-6) unstable; urgency=low
 .
   * Disables default loading of the .so from the local dir, this might be a
     security issue (closes: #[513456](bugreport.cgi?bug=513456))
   * Added dependency to libbsd and modified build scripts to fix FTBFS under
     lenny
   * Bumped Standards-Version since it is compliant with the new version without
     further changes
Checksums-Sha1:
 14c13a3a324266dd443f20e48b796ce0b8c63394 988 trickle_1.07-6.dsc
 77b04181020f9e9f0c51595b7ddcbe1a8885236e 243038 trickle_1.07-6.diff.gz
 c807ca1b95792d30bfeb8defcbd2b8e4bd9b3487 43368 trickle_1.07-6_amd64.deb
Checksums-Sha256:
 e7d0637d9cc0e606e831a4e15c19d5ea1d6c7cfb36f825d76cbb5962958a6351 988 trickle_1.07-6.dsc
 9aa084fb6a1a4d62bb982ad8303922b8a334a4245c7fdeef75ba6442f63411a2 243038 trickle_1.07-6.diff.gz
 49e4fab8785e9a38ea16917bcbcbcc9f0a5cfe9b8dc74f97047bc614e59ac50b 43368 trickle_1.07-6_amd64.deb
Files:
 ebb566b13ebc7c6653074a7b54744742 988 net optional trickle_1.07-6.dsc
 b037af3d26b3d5bd0df3d6489935a711 243038 net optional trickle_1.07-6.diff.gz
 636633d3d2674aedc95eb69828b5f50f 43368 net optional trickle_1.07-6_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iD8DBQFJkKiQS6AOchRbaWYRAnOFAKC64UFJavpngP72k1kUfLP6PcNVxwCgmqGM
8wNpM1ax5M5awmqbOQ6vzvU=
=P1Ep
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sat, 14 Mar 2009 07:30:36 GMT) ([full text](bugreport.cgi?bug=513456;msg=24), [mbox](bugreport.cgi?bug=513456;mbox=yes;msg=24), [link](#23)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=513456).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 05:38:24 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.


