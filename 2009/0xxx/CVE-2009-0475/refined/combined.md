=== Content from www.ocert.org_fa3e0544_20250124_163037.html ===


**oCERT-2009-002 OpenCORE insufficient boundary checking during MP3 decoding**

**Description**:

OpenCORE, an open source multimedia decoding subsystem, suffers
from an integer underflow during Huffman decoding resulting in
improper bounds checking when writing to a heap allocated buffer.
Decoding a specially crafted mp3 file will result in unexpected
process termination or, potentially, arbitrary code execution due to
heap corruption.

Patches have been made available by PacketVideo:

 [OpenCORE patch](../patches/2009-002/opencore_mp3_dec.patch)

 [public changelist](http://review.source.android.com/Gerrit#change,8815)

**Affected version**:

[OpenCORE](http://www.packetvideo.com/products/core/index.html) <= 2.0

(secondary affected versions)

[Android](http://android.com) without [8815](http://review.source.android.com/Gerrit#change,8815)

**Fixed version**:

[OpenCORE](http://www.packetvideo.com) with [8815](http://review.source.android.com/Gerrit#change,8815)

[Android](http://android.com) with [8815](http://review.source.android.com/Gerrit#change,8815)

**Credit**: Initial vulnerability report and sample crasher provided by
Owen Arden <owen [at] securityevaluators [dot] com> and
Charlie Miller <cmiller [at] securityevaluators
[dot] com>. In addition, oCERT would like to
thank PacketVideo for the comprehensive analysis
and patch.

**CVE**: [CVE-2009-0475](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0475)

**Timeline**:

2009-01-21: Android Security Team informed of issues

2009-01-23: Android Security Team requested coordination aid from oCERT

2009-01-24: oCERT investigated for other potential affected projects

2009-02-05: vendor supplied patch

2009-02-05: indicated that no other open source projects appear affected

2009-02-05: emailed vendor-sec@lst.de as a cross-check

2009-02-06: supplied vulnerability analysis to upstream vendor

2009-02-06: walked through affected code with upstream vendor

2009-02-06: CVE assignment requested and assigned

2009-02-07: advisory release

**References**:

[pvmp3\_huffman\_parsing.cpp](http://android.git.kernel.org/?p=platform/external/opencore.git;a=blob;f=codecs_v2/audio/mp3/dec/src/pvmp3_huffman_parsing.cpp;h=491c0cc1b05adecb4ed2d53489c82e7fb4f46108;hb=d8b443ddaa386ed85ba31fbd663c40423a8d4ded)

[pvmp3\_mpeg2\_stereo\_proc.cpp](http://android.git.kernel.org/?p=platform/external/opencore.git;a=blob;f=codecs_v2/audio/mp3/dec/src/pvmp3_mpeg2_stereo_proc.cpp;h=bc4c227fbd60f3f0a90355d7d52c71d46cd4a87c;hb=d8b443ddaa386ed85ba31fbd663c40423a8d4ded)

[OpenCORE 2.0 submission](http://review.source.android.com/Gerrit#change,8604)

[Android Git Repository](http://android.git.kernel.org/?p=platform/external/opencore.git;a=summary)


