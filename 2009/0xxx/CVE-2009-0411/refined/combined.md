=== Content from codereview.chromium.org_24e9430a_20250124_231251.html ===


Keyboard Shortcuts

---

| |  | File | | --- | --- | | u **:** | up to issue | | j / k **:** | jump to file after / before current file | | J / K **:** | jump to next file with a comment after / before current file | |  | Side-by-side diff | | i **:** | toggle intra-line diffs | | e **:** | expand all comments | | c **:** | collapse all comments | | s **:** | toggle showing all comments | | n / p **:** | next / previous diff chunk or comment | | N / P **:** | next / previous comment | | <Up> / <Down> **:** | next / previous line | | |  | Issue | | --- | --- | | u **:** | up to list of issues | | j / k **:** | jump to patch after / before current patch | | o / <Enter> **:** | open current patch in side-by-side view | | i **:** | open current patch in unified diff view | |  | |  | Issue List | | j / k **:** | jump to issue after / before current issue | | o / <Enter> **:** | open current issue | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

![](/static/chromium-24.png) Chromium Code Reviews
**chromiumcodereview-hr@appspot.gserviceaccount.com (chromiumcodereview-hr)**
|
Please choose your nickname with
[Settings](/settings)
|
[Help](http://code.google.com/p/rietveld/wiki/CodeReviewHelp)
|
[Chromium Project](http://www.chromium.org/)
|
[Gerrit Changes](https://chromium-review.googlesource.com/dashboard/self?polygerrit=1)
|
[Sign out](https://codereview.chromium.org/_ah/logout?continue=https://accounts.google.com/Logout%3Fcontinue%3Dhttps://uc.appengine.google.com/_ah/logout%253Fcontinue%253Dhttps://google.com/url%25253Fsa%25253DD%252526q%25253Dhttps://codereview.chromium.org/18533%252526ust%25253D1608694831531900%252526usg%25253DAFQjCNFbwzRWs6puYGXeFXk8Z7T3g5z9eA%26service%3Dah)

(238)

[Issues](/)
[Search](/search)

[My Issues](/mine)
|
[Starred](/starred)

[Open](/all?closed=0)
|
[Closed](/all?closed=1)
|
[All](/all)

## Issue [18533](/18533/): Merge r5767 - Protect cookie headers from XHR... (Closed)

| **Created:** 11 years, 11 months ago by [laforge](/user/laforge)  **Modified:** 9 years, 7 months ago  **Reviewers:** [darin (slow to review)](/user/darin%20%28slow%20to%20review%29)  **CC:** chromium-reviews\_googlegroups.com  **Base URL:** [svn://chrome-svn/chrome/branches/release\_154.next/src/](http://src.chromium.org/viewvc/chrome/branches/release_154.next/src/)  **Visibility:** Public. | DescriptionMerge r5767 - Protect cookie headers from XHR Add a flags to further control response header persistence. We use this to filter out Set-Cookie and Set-Cookie2 response headers from being forwarded to the renderer. This serves to prevent the renderer from having any access to HttpOnly cookies, and it also prevents XMLHttpRequest consumers from being able to read cookies in the HTTP response headers. This is consistent with changes made to Firefox and WebKit. Patch by marius.schilder@gmail.com R=deanm,darin Review URL: <http://codereview.chromium.org/11264> TBR=darin@chromium.org Committed: <http://src.chromium.org/viewvc/chrome?view=rev&revision=8529> [Patch Set 1 #](/18533/#ps1) *Created:* 11 years, 11 months ago  Download [[raw]](/download/issue18533_1.diff "Patchset in text format") [[tar.bz2]](/tarball/18533/1 "Tarball containing the original and patched files")   |  | | Unified diffs | Side-by-side diffs | Delta from patch set | Stats (*+152 lines, -61 lines*) | | | Patch | | --- | --- | --- | --- | --- | --- | --- | --- | --- | |  | M | [chrome/common/render\_messages.h](/18533/patch/1/6) | [View](/18533/diff/1/chrome/common/render_messages.h) |  | 1 chunk | +4 lines, -2 lines | 0 comments | [Download](/download/issue18533_1_6.diff "Download patch for chrome/common/render_messages.h") | |  | M | [net/http/http\_cache.cc](/18533/patch/1/2) | [View](/18533/diff/1/net/http/http_cache.cc) |  | 1 chunk | +12 lines, -1 line | 0 comments | [Download](/download/issue18533_1_2.diff "Download patch for net/http/http_cache.cc") | |  | M | [net/http/http\_response\_headers.h](/18533/patch/1/5) | [View](/18533/diff/1/net/http/http_response_headers.h) |  | 2 chunks | +26 lines, -8 lines | 0 comments | [Download](/download/issue18533_1_5.diff "Download patch for net/http/http_response_headers.h") | |  | M | [net/http/http\_response\_headers.cc](/18533/patch/1/4) | [View](/18533/diff/1/net/http/http_response_headers.cc) |  | 4 chunks | +72 lines, -37 lines | 0 comments | [Download](/download/issue18533_1_4.diff "Download patch for net/http/http_response_headers.cc") | |  | M | [net/http/http\_response\_headers\_unittest.cc](/18533/patch/1/3) | [View](/18533/diff/1/net/http/http_response_headers_unittest.cc) |  | 12 chunks | +38 lines, -13 lines | 0 comments | [Download](/download/issue18533_1_3.diff "Download patch for net/http/http_response_headers_unittest.cc") |   Messages*Total messages: 2 (0 generated)* Expand Messages | Collapse Messages  | **laforge** | |  | | --- | | 11 years, 11 months ago (2009-01-23 00:50:11 UTC) [#1](#msg1) | | --- | --- | --- | --- |     | **darin (slow to review)** | | LGTM | | --- | | 11 years, 11 months ago (2009-01-23 00:52:56 UTC) [#2](#msg2) | | --- | --- | --- | --- |   ``` LGTM ```     Expand Messages | Collapse Messages |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

**Issue 18533: Merge r5767 - Protect cookie headers from XHR...
(Closed)**

Created 11 years, 11 months ago by laforge

Modified 9 years, 7 months ago

Reviewers: darin (slow to review)

Base URL: svn://chrome-svn/chrome/branches/release\_154.next/src/

Comments: 0
[![Powered by Google App Engine](/static/appengine-noborder-120x30.gif)](http://code.google.com/appengine/)

This is Rietveld [408576698](http://code.google.com/p/rietveld/source/list)



=== Content from sites.google.com_3cbcdd98_20250124_231253.html ===

# Sign in

Use your Google AccountEmail or phoneForgot email?![CAPTCHA image of text used to distinguish humans from robots]()Type the text you hear or seeNot your computer? Use Guest mode to sign in privately. [Learn more about using Guest mode](https://support.google.com/chrome/answer/6130773?hl=en-US)NextCreate account

=== Content from src.chromium.org_965b0fa7_20250124_231254.html ===


This site used to contain a view of the SVN repo used in the early days of Chromium.

Full commit history for Chromium can now be found at
[https://chromium.googlesource.com/chromium/src/+/refs/heads/main](https://chromium.googlesource.com/chromium/src/%2B/refs/heads/main).

For any questions or concerns, please file a bug under the
[Infra>SDK](https://issues.chromium.org/issues/new?noWizard=true&component=1456102) component.



=== Content from codereview.chromium.org_7b64cc73_20250124_231250.html ===


Keyboard Shortcuts

---

| |  | File | | --- | --- | | u **:** | up to issue | | j / k **:** | jump to file after / before current file | | J / K **:** | jump to next file with a comment after / before current file | |  | Side-by-side diff | | i **:** | toggle intra-line diffs | | e **:** | expand all comments | | c **:** | collapse all comments | | s **:** | toggle showing all comments | | n / p **:** | next / previous diff chunk or comment | | N / P **:** | next / previous comment | | <Up> / <Down> **:** | next / previous line | | |  | Issue | | --- | --- | | u **:** | up to list of issues | | j / k **:** | jump to patch after / before current patch | | o / <Enter> **:** | open current patch in side-by-side view | | i **:** | open current patch in unified diff view | |  | |  | Issue List | | j / k **:** | jump to issue after / before current issue | | o / <Enter> **:** | open current issue | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

![](/static/chromium-24.png) Chromium Code Reviews
**chromiumcodereview-hr@appspot.gserviceaccount.com (chromiumcodereview-hr)**
|
Please choose your nickname with
[Settings](/settings)
|
[Help](http://code.google.com/p/rietveld/wiki/CodeReviewHelp)
|
[Chromium Project](http://www.chromium.org/)
|
[Gerrit Changes](https://chromium-review.googlesource.com/dashboard/self?polygerrit=1)
|
[Sign out](https://codereview.chromium.org/_ah/logout?continue=https://accounts.google.com/Logout%3Fcontinue%3Dhttps://uc.appengine.google.com/_ah/logout%253Fcontinue%253Dhttps://google.com/url%25253Fsa%25253DD%252526q%25253Dhttps://codereview.chromium.org/11264%252526ust%25253D1608718690846888%252526usg%25253DAFQjCNH2LCxLRQy3MUopgBUUtRQieZ7CWw%26service%3Dah)

(170)

[Issues](/)
[Search](/search)

[My Issues](/mine)
|
[Starred](/starred)

[Open](/all?closed=0)
|
[Closed](/all?closed=1)
|
[All](/all)

## Issue [11264](/11264/): Drop Set-Cookie from XHR response headers (Closed)

| **Created:** 12 years, 1 month ago by [mschilder](/user/mschilder)  **Modified:** 9 years, 7 months ago  **Reviewers:** [Dean McNamee](/user/Dean%20McNamee), [darin (slow to review)](/user/darin%20%28slow%20to%20review%29)  **CC:** chromium-reviews\_googlegroups.com  **Base URL:** [http://src.chromium.org/svn/trunk/src/](http://src.chromium.org/viewvc/chrome/trunk/src/)  **Visibility:** Public. | DescriptionAdd a third flavor to response header persistence. XMLHttpRequest response headers should not contain Set-Cookie or Set-Cookie2 headers. [Patch Set 1 #](/11264/#ps1) [Patch Set 2 : '' #](/11264/#ps402) [Patch Set 3 : '' #](/11264/#ps408) [Patch Set 4 : '' #](/11264/#ps411) [Patch Set 5 : '' #](/11264/#ps412) [Patch Set 6 : '' #](/11264/#ps419) [Patch Set 7 : '' #](/11264/#ps420) [Patch Set 8 : '' #](/11264/#ps426) *Created:* 12 years, 1 month ago  Download [[raw]](/download/issue11264_426.diff "Patchset in text format") [[tar.bz2]](/tarball/11264/426 "Tarball containing the original and patched files")   |  | | Unified diffs | Side-by-side diffs | Delta from patch set | Stats (*+152 lines, -61 lines*) | | | Patch | | --- | --- | --- | --- | --- | --- | --- | --- | --- | |  | M | [chrome/common/render\_messages.h](/11264/patch/426/38) | [View](/11264/diff/426/chrome/common/render_messages.h) | [1](/11264/diff2/1%3A426/chrome/common/render_messages.h "Delta from patch set 1") [2](/11264/diff2/402%3A426/chrome/common/render_messages.h "Delta from patch set 2") [3](/11264/diff2/408%3A426/chrome/common/render_messages.h "Delta from patch set 3") [4](/11264/diff2/411%3A426/chrome/common/render_messages.h "Delta from patch set 4") [5](/11264/diff2/412%3A426/chrome/common/render_messages.h "Delta from patch set 5") [6](/11264/diff2/419%3A426/chrome/common/render_messages.h "Delta from patch set 6") [7](/11264/diff2/420%3A426/chrome/common/render_messages.h "Delta from patch set 7") | 1 chunk | +4 lines, -2 lines | 0 comments | [Download](/download/issue11264_426_38.diff "Download patch for chrome/common/render_messages.h") | |  | M | [net/http/http\_cache.cc](/11264/patch/426/34) | [View](/11264/diff/426/net/http/http_cache.cc) | [1](/11264/diff2/1%3A426/net/http/http_cache.cc "Delta from patch set 1") [2](/11264/diff2/402%3A426/net/http/http_cache.cc "Delta from patch set 2") [3](/11264/diff2/408%3A426/net/http/http_cache.cc "Delta from patch set 3") [4](/11264/diff2/411%3A426/net/http/http_cache.cc "Delta from patch set 4") [5](/11264/diff2/412%3A426/net/http/http_cache.cc "Delta from patch set 5") | 1 chunk | +12 lines, -1 line | 0 comments | [Download](/download/issue11264_426_34.diff "Download patch for net/http/http_cache.cc") | |  | M | [net/http/http\_response\_headers.h](/11264/patch/426/37) | [View](/11264/diff/426/net/http/http_response_headers.h) | [1](/11264/diff2/1%3A426/net/http/http_response_headers.h "Delta from patch set 1") [2](/11264/diff2/402%3A426/net/http/http_response_headers.h "Delta from patch set 2") [3](/11264/diff2/408%3A426/net/http/http_response_headers.h "Delta from patch set 3") [4](/11264/diff2/411%3A426/net/http/http_response_headers.h "Delta from patch set 4") [5](/11264/diff2/412%3A426/net/http/http_response_headers.h "Delta from patch set 5") | 2 chunks | +26 lines, -8 lines | 0 comments | [Download](/download/issue11264_426_37.diff "Download patch for net/http/http_response_headers.h") | |  | M | [net/http/http\_response\_headers.cc](/11264/patch/426/36) | [View](/11264/diff/426/net/http/http_response_headers.cc) | [1](/11264/diff2/1%3A426/net/http/http_response_headers.cc "Delta from patch set 1") [2](/11264/diff2/402%3A426/net/http/http_response_headers.cc "Delta from patch set 2") [3](/11264/diff2/408%3A426/net/http/http_response_headers.cc "Delta from patch set 3") [4](/11264/diff2/411%3A426/net/http/http_response_headers.cc "Delta from patch set 4") [5](/11264/diff2/412%3A426/net/http/http_response_headers.cc "Delta from patch set 5") [6](/11264/diff2/419%3A426/net/http/http_response_headers.cc "Delta from patch set 6") | 4 chunks | +72 lines, -37 lines | 0 comments | [Download](/download/issue11264_426_36.diff "Download patch for net/http/http_response_headers.cc") | |  | M | [net/http/http\_response\_headers\_unittest.cc](/11264/patch/426/35) | [View](/11264/diff/426/net/http/http_response_headers_unittest.cc) | [1](/11264/diff2/1%3A426/net/http/http_response_headers_unittest.cc "Delta from patch set 1") [2](/11264/diff2/402%3A426/net/http/http_response_headers_unittest.cc "Delta from patch set 2") [3](/11264/diff2/408%3A426/net/http/http_response_headers_unittest.cc "Delta from patch set 3") [4](/11264/diff2/411%3A426/net/http/http_response_headers_unittest.cc "Delta from patch set 4") [5](/11264/diff2/412%3A426/net/http/http_response_headers_unittest.cc "Delta from patch set 5") | 12 chunks | +38 lines, -13 lines | 0 comments | [Download](/download/issue11264_426_35.diff "Download patch for net/http/http_response_headers_unittest.cc") |   Messages*Total messages: 11 (0 generated)* Expand Messages | Collapse Messages  | **Dean McNamee** | | Just skimmed it, looks really good over all. Removing the true / false parameter is ... | | --- | | 12 years, 1 month ago (2008-11-19 17:04:59 UTC) [#1](#msg1) | | --- | --- | --- | --- |   ``` Just skimmed it, looks really good over all.  Removing the true / false parameter is nice even without the additional mode, because it makes the callers much more clear.  <http://codereview.chromium.org/11264/diff/1/4> File net/http/http_response_headers.cc (right):  <http://codereview.chromium.org/11264/diff/1/4#newcode69> Line 69: // over IPC. Maybe say why, that we want to filter http only cookies, but instead we're just filtering all cookies, because we don't want to leak this knowledge into the renderer.  <http://codereview.chromium.org/11264/diff/1/4#newcode108> Line 108: switch (options) { I think a switch for 2 cases is overkill.  <http://codereview.chromium.org/11264/diff/1/4#newcode120> Line 120: // this just copies the status line w/ terminator I saw this code before and thought it was a little bit sketchy.  Might just want to improve the comment, noting that raw_headers_ has embedded nulls, and we want the substring before the first null.  I realize this isn't your code.  <http://codereview.chromium.org/11264/diff/1/4#newcode135> Line 135: // includes terminator // We write comments like this.  Realize it isn't your code, but might as well clean it up.  <http://codereview.chromium.org/11264/diff/1/4#newcode630> Line 630: // statically cached hash_set to avoid duplicated work? Should this be a TODO?  <http://codereview.chromium.org/11264/diff/1/5> File net/http/http_response_headers.h (right):  <http://codereview.chromium.org/11264/diff/1/5#newcode53> Line 53: // Appends a representation of this object to the given pickle.  If options equals 80 cols  <http://codereview.chromium.org/11264/diff/1/5#newcode256> Line 256: // Returns the headers that should not be passed to IPC requests. Could you improve this comment a bit.  Which headers?  Why are they special? ```     | **darin (slow to review)** | | Do we need this change given: http://trac.webkit.org/changeset/38566 https://bugs.webkit.org/show\_bug.cgi?id=10957 http://codereview.chromium.org/11264/diff/1/5 File net/http/http\_response\_headers.h (right): http://codereview.chromium.org/11264/diff/1/5#newcode50 Line 50: ... | | --- | | 12 years, 1 month ago (2008-11-19 17:11:37 UTC) [#2](#msg2) | | --- | --- | --- | --- |   ``` Do we need this change given: <http://trac.webkit.org/changeset/38566> <https://bugs.webkit.org/show_bug.cgi?id=10957>  <http://codereview.chromium.org/11264/diff/1/5> File net/http/http_response_headers.h (right):  <http://codereview.chromium.org/11264/diff/1/5#newcode50> Line 50: PERSIST_FOR_IPC = 2, it is a little strange to mention things like IPC here in the HttpCache code.  that implies knowledge of chrome internals, which this layer knows nothing of otherwise.  is there a better way to describe what this alternative mode is doing? ```     | **Dean McNamee** | | http://codereview.chromium.org/11264/diff/1/4 File net/http/http\_response\_headers.cc (right): http://codereview.chromium.org/11264/diff/1/4#newcode110 Line 110: GetNonIPCHeaders(&filtered\_headers); I guess now this should be GetCookieHeaders, ... | | --- | | 12 years, 1 month ago (2008-11-19 17:34:50 UTC) [#3](#msg3) | | --- | --- | --- | --- |   ``` <http://codereview.chromium.org/11264/diff/1/4> File net/http/http_response_headers.cc (right):  <http://codereview.chromium.org/11264/diff/1/4#newcode110> Line 110: GetNonIPCHeaders(&filtered_headers); I guess now this should be GetCookieHeaders, and this should be PERSIST_WITHOUT_COOKIES or something.  <http://codereview.chromium.org/11264/diff/1/5> File net/http/http_response_headers.h (right):  <http://codereview.chromium.org/11264/diff/1/5#newcode50> Line 50: PERSIST_FOR_IPC = 2, As Darin pointed out, it's definitely important to keep these components conceptually isolated, so FOR_IPC doesn't make sense here.  Maybe a better name would just be to make it explicit as to what it's doing.  PERSIST_WITHOUT_COOKIE_HEADERS ?  I'm not familiar with the code that much, I'm guessing _RAW is everything, _CACHE has some things filtered, is your _IPC the same filtering as _CACHE plus cookies?  Maybe that should be denoted some how, like FOR_CACHE_WITHOUT_COOKIES.  Dunno.  <http://codereview.chromium.org/11264/diff/1/5#newcode257> Line 257: static void GetNonIPCHeaders(HeaderSet* header_names); On second reading, this name is really strange.  Do you mean GetHeadersThatAreUnsafeForIPC? ```     | **Dean McNamee** | | Looks better, still some nits. It's up to Darin on the real code. http://codereview.chromium.org/11264/diff/408/18 File ... | | --- | | 12 years, 1 month ago (2008-11-19 22:13:38 UTC) [#4](#msg4) | | --- | --- | --- | --- |   ``` Looks better, still some nits.  It's up to Darin on the real code.  <http://codereview.chromium.org/11264/diff/408/18> File chrome/common/render_messages.h (right):  <http://codereview.chromium.org/11264/diff/408/18#newcode1392> Line 1392: net::HttpResponseHeaders::PERSIST_WITHOUT_SENSITIVE_HEADERS); p->Persist(     m, net:: ... );  <http://codereview.chromium.org/11264/diff/408/16> File net/http/http_response_headers.cc (right):  <http://codereview.chromium.org/11264/diff/408/16#newcode112> Line 112: } I find the switch here strange.  I liked it better the way you had it I think.  Can you just early terminate on RAW, and then handle the case for _CACHE / SENESITVE.  filter_headers will be empty in the else case. ```     | **mschilder** | | On 2008/11/19 22:13:38, Dean McNamee wrote: > Looks better, still some nits. It's up to ... | | --- | | 12 years, 1 month ago (2008-11-19 22:29:38 UTC) [#5](#msg5) | | --- | --- | --- | --- |   ``` On 2008/11/19 22:13:38, Dean McNamee wrote: > Looks better, still some nits.  It's up to Darin on the real code. >  > <http://codereview.chromium.org/11264/diff/408/18> > File chrome/common/render_messages.h (right): >  > <http://codereview.chromium.org/11264/diff/408/18#newcode1392> > Line 1392: net::HttpResponseHeaders::PERSIST_WITHOUT_SENSITIVE_HEADERS); > p->Persist( >     m, net:: ... );  done  >  > <http://codereview.chromium.org/11264/diff/408/16> > File net/http/http_response_headers.cc (right): >  > <http://codereview.chromium.org/11264/diff/408/16#newcode112> > Line 112: } > I find the switch here strange.  I liked it better the way you had it I think.  > Can you just early terminate on RAW, and then handle the case for _CACHE / > SENESITVE.  filter_headers will be empty in the else case.  done. Added a comment and NOREACHED for else as well. Overkill? ```     | **mschilder** | | On 2008/11/19 17:11:37, darin wrote: > Do we need this change given: > http://trac.webkit.org/changeset/38566 > ... | | --- | | 12 years, 1 month ago (2008-11-19 22:30:27 UTC) [#6](#msg6) | | --- | --- | --- | --- |   ``` On 2008/11/19 17:11:37, darin wrote: > Do we need this change given: > <http://trac.webkit.org/changeset/38566> > <https://bugs.webkit.org/show_bug.cgi?id=10957>  I think it still has merit to filter on the trusted end of the IPC, whether webkit also filters or not.  >  > <http://codereview.chromium.org/11264/diff/1/5> > File net/http/http_response_headers.h (right): >  > <http://codereview.chromium.org/11264/diff/1/5#newcode50> > Line 50: PERSIST_FOR_IPC = 2, > it is a little strange to mention things like IPC here in the HttpCache code.  > that implies knowledge of chrome internals, which this layer knows nothing of > otherwise.  is there a better way to describe what this alternative mode is > doing?  fixed ```     | **Dean McNamee** | | Style wise looks ok by me. Darin on the rest. http://codereview.chromium.org/11264/diff/412/416 File net/http/http\_response\_headers.h (right): http://codereview.chromium.org/11264/diff/412/416#newcode257 ... | | --- | | 12 years, 1 month ago (2008-11-19 22:32:42 UTC) [#7](#msg7) | | --- | --- | --- | --- |   ``` Style wise looks ok by me.  Darin on the rest.  <http://codereview.chromium.org/11264/diff/412/416> File net/http/http_response_headers.h (right):  <http://codereview.chromium.org/11264/diff/412/416#newcode257> Line 257: // e.g. Set-Cookie, Set-Cookie2. it actually returns them lower cased, right?  So maybe your example is misleading. ```     | **darin (slow to review)** | | http://codereview.chromium.org/11264/diff/411/23 File net/http/http\_response\_headers.h (right): http://codereview.chromium.org/11264/diff/411/23#newcode50 Line 50: PERSIST\_WITHOUT\_SENSITIVE\_HEADERS = 2, hmm... vaguely naming this seems ... | | --- | | 12 years, 1 month ago (2008-11-19 22:35:42 UTC) [#8](#msg8) | | --- | --- | --- | --- |   ``` <http://codereview.chromium.org/11264/diff/411/23> File net/http/http_response_headers.h (right):  <http://codereview.chromium.org/11264/diff/411/23#newcode50> Line 50: PERSIST_WITHOUT_SENSITIVE_HEADERS = 2, hmm... vaguely naming this seems not so great.  i think it is better to be specific here so that the caller, who needs to make the choice about renderer security, can be the one making the policy decision about what "sensitive headers" means.  so, i would name these like so:    PERSIST_ALL,   PERSIST_SANS_COOKIES,   PERSIST_SANS_TRANSIENTS  you could comment that 'cookies' are a subset of 'transients', where transients also include the hop-by-hop response headers (as defined by RFC 2616), response headers deemed non-cacheable by the server, and auth challenge response headers.  we could also break this down further into an exclusive set:    PERSIST_ALL,   PERSIST_SANS_COOKIES,   PERSIST_SANS_CHALLENGES,   PERSIST_SANS_HOP_BY_HOP,   PERSIST_SANS_NON_CACHEABLE,  then the HttpCache code could combine all of these to get its desired behavior.  i'm fine with either breakdown of flags. ```     | **mschilder** | | On 2008/11/19 22:32:42, Dean McNamee wrote: > Style wise looks ok by me. Darin on ... | | --- | | 12 years, 1 month ago (2008-11-19 22:40:25 UTC) [#9](#msg9) | | --- | --- | --- | --- |   ``` On 2008/11/19 22:32:42, Dean McNamee wrote: > Style wise looks ok by me.  Darin on the rest. >  > <http://codereview.chromium.org/11264/diff/412/416> > File net/http/http_response_headers.h (right): >  > <http://codereview.chromium.org/11264/diff/412/416#newcode257> > Line 257: // e.g. Set-Cookie, Set-Cookie2. > it actually returns them lower cased, right?  So maybe your example is > misleading.  yeah, habit. The actual matching is done case-insensitive due to lower-casing the other input. I'll update the comment to lower-case. ```     | **mschilder** | | On 2008/11/19 22:35:42, darin wrote: > http://codereview.chromium.org/11264/diff/411/23 > File net/http/http\_response\_headers.h (right): > > http://codereview.chromium.org/11264/diff/411/23#newcode50 > ... | | --- | | 12 years, 1 month ago (2008-11-20 02:37:50 UTC) [#10](#msg10) | | --- | --- | --- | --- |   ``` On 2008/11/19 22:35:42, darin wrote: > <http://codereview.chromium.org/11264/diff/411/23> > File net/http/http_response_headers.h (right): >  > <http://codereview.chromium.org/11264/diff/411/23#newcode50> > Line 50: PERSIST_WITHOUT_SENSITIVE_HEADERS = 2, > hmm... vaguely naming this seems not so great.  i think it is better to be > specific here so that the caller, who needs to make the choice about renderer > security, can be the one making the policy decision about what "sensitive > headers" means. >  > so, i would name these like so: >  >   PERSIST_ALL, >   PERSIST_SANS_COOKIES, >   PERSIST_SANS_TRANSIENTS >  > you could comment that 'cookies' are a subset of 'transients', where transients > also include the hop-by-hop response headers (as defined by RFC 2616), response > headers deemed non-cacheable by the server, and auth challenge response headers. >  > we could also break this down further into an exclusive set: >  >   PERSIST_ALL, >   PERSIST_SANS_COOKIES, >   PERSIST_SANS_CHALLENGES, >   PERSIST_SANS_HOP_BY_HOP, >   PERSIST_SANS_NON_CACHEABLE, >  > then the HttpCache code could combine all of these to get its desired behavior.  Ok, i took the latter suggestion and broke the options down to bits. Not sure whether the bitmask/const int approach is clearer than say a PersistOptions object. I see either approach in the codebase..  >  > i'm fine with either breakdown of flags. ```     | **darin (slow to review)** | | LGTM ! | | --- | | 12 years, 1 month ago (2008-11-20 03:50:17 UTC) [#11](#msg11) | | --- | --- | --- | --- |   ``` LGTM ! ```     Expand Messages | Collapse Messages |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

**Issue 11264: Drop Set-Cookie from XHR response headers
(Closed)**

Created 12 years, 1 month ago by mschilder

Modified 9 years, 7 months ago

Reviewers: darin (slow to review), Dean McNamee

Base URL: http://src.chromium.org/svn/trunk/src/

Comments: 15
[![Powered by Google App Engine](/static/appengine-noborder-120x30.gif)](http://code.google.com/appengine/)

This is Rietveld [408576698](http://code.google.com/p/rietveld/source/list)


