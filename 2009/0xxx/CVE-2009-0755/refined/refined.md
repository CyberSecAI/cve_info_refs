```
Message-ID: <20090219212536.GA11769@logo.rdu.rpath.com>
Date: Thu, 19 Feb 2009 16:25:36 -0500
From: "Michael K. Johnson" <johnsonm@...th.com>
To: oss-security@...ts.openwall.com
Subject: Re: CVE Request: Poppler -Two Denial of Service Vulnerabilities

On Fri, Feb 13, 2009 at 11:20:40AM +0200, Pinar Yanardag wrote:
> 1) An uninitialised memory access error in the
> "FormWidgetChoice::loadDefaults()" function can be exploited to cause a
> crash via a specially crafted PDF document.

This is changeset 1fc342eadcbbb41302f190b215c5daf23c9ec9b1 in poppler's
git and is associated with poppler bug 19790

> 2) An error in the "JBIG2Stream::readSymbolDictSeg()" function can be
> exploited to cause a crash via a specially crafted PDF document.

This is changeset d3f04f537fb3e963c149a7e2d8d83c7cb19da8c0 in poppler's
git and is associated with poppler bug 19702

These bugs were reported fixed in poppler-0.10.4.tar.gz, released on
February 10, 2009
```

- **Root cause of vulnerability**:
    - An uninitialized memory access error in the `FormWidgetChoice::loadDefaults()` function.
    - An error in the `JBIG2Stream::readSymbolDictSeg()` function.
- **Weaknesses/vulnerabilities present**:
    - Uninitialized memory access.
    - Improper handling of data within a stream.
- **Impact of exploitation**:
    - Denial of service (crash).
- **Attack vectors**:
    - Specially crafted PDF document.
- **Required attacker capabilities/position**:
    - Ability to create/modify PDF documents.
    - Ability to deliver the malicious PDF to a user/system that will process it.

```
Subject: CVE Request: Poppler -Two Denial of Service Vulnerabilities

 From Secunia [1]:

--->8---
Two vulnerabilities have been reported in Poppler, which can be
exploited by malicious people to cause a DoS (Denial of Service).

1) An uninitialised memory access error in the
"FormWidgetChoice::loadDefaults()" function can be exploited to cause a
crash via a specially crafted PDF document.

2) An error in the "JBIG2Stream::readSymbolDictSeg()" function can be
exploited to cause a crash via a specially crafted PDF document.
--->8---
```
- **Root cause of vulnerability**:
    - An uninitialized memory access error in the `FormWidgetChoice::loadDefaults()` function.
    - An error in the `JBIG2Stream::readSymbolDictSeg()` function.
- **Weaknesses/vulnerabilities present**:
    - Uninitialized memory access.
    - Improper handling of data within a stream.
- **Impact of exploitation**:
    - Denial of service (crash).
- **Attack vectors**:
    - Specially crafted PDF document.
- **Required attacker capabilities/position**:
    - Ability to create/modify PDF documents.
    - Ability to deliver the malicious PDF to a user/system that will process it.

```
Bugzilla – Bug 19790
evince crashed at GooString::cmp ()
[...]
Thread 1 (process 18847): #0  0xb6f313ce in GooString::cmp () from /usr/lib/libpoppler.so.2 #1  0xb6eaaf87 in FormWidgetChoice::loadDefaults ()    from /usr/lib/libpoppler.so.2 #2  0xb6ea6261 in FormField::loadChildrenDefaults ()    from /usr/lib/libpoppler.so.2 #3  0xb6ea98ea in Form::createFieldFromDict () from /usr/lib/libpoppler.so.2 #4  0xb6eaa330 in FormField::FormField () from /usr/lib/libpoppler.so.2 #5  0xb6ea98cd in Form::createFieldFromDict () from /usr/lib/libpoppler.so.2 #6  0xb6ea9ba5 in Form::Form () from /usr/lib/libpoppler.so.2 #7  0xb6e9f098 in Catalog::Catalog () from /usr/lib/libpoppler.so.2 #8  0xb6efe926 in PDFDoc::setup () from /usr/lib/libpoppler.so.2 #9  0xb6efebc3 in PDFDoc::PDFDoc () from /usr/lib/libpoppler.so.2 #10 0xb76a23b5 in poppler_document_new_from_file ()    from /usr/lib/libpoppler-glib.so.2 
[...]
```
- **Root cause of vulnerability**:
    - Crash due to uninitialized memory access in `FormWidgetChoice::loadDefaults()` which leads to a crash in `GooString::cmp()`.
- **Weaknesses/vulnerabilities present**:
    - Uninitialized memory access.
-  **Impact of exploitation**:
    - Denial of service (crash) of applications using poppler such as evince.
- **Attack vectors**:
   - Malformed PDF document
- **Required attacker capabilities/position**:
    - Ability to create/modify PDF documents.
    - Ability to deliver the malicious PDF to a user/system that will process it.

```
 poppler/Form.cc |    4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

New commits:
commit 1fc342eadcbbb41302f190b215c5daf23c9ec9b1
Author: Albert Astals Cid <[aacid at kde.org](http://lists.freedesktop.org/mailman/listinfo/poppler)>
Date:   Wed Jan 28 22:53:43 2009 +0100

    Fix crash on unexepcted Form Opt value

    Fixes crash on bug 19790

diff --git a/poppler/Form.cc b/poppler/Form.cc
index be58180..89e18a3 100644
--- a/poppler/Form.cc
+++ b/poppler/Form.cc
@@ -449,7 +449,9 @@ void FormWidgetChoice::loadDefaults ()
         obj3.free();
         obj4.free();
       } else {
-        error(-1, "FormWidgetChoice:: invalid Opt entry\n");
+        error(-1, "FormWidgetChoice:: invalid %d Opt entry\n", i);
+        parent->_setChoiceExportVal(i, new GooString(""));
+        parent->_setChoiceOptionName(i, new GooString(""));
       }
       obj2.free();
     }
```
- **Root cause of vulnerability**:
    - The code did not properly handle invalid or unexpected values in the `Opt` entry of form fields, leading to a crash.
- **Weaknesses/vulnerabilities present**:
    - Improper error handling and lack of input validation in `FormWidgetChoice::loadDefaults()` when processing form fields.
- **Impact of exploitation**:
    - Denial of service (crash).
- **Attack vectors**:
    - Specially crafted PDF document with a malformed `Opt` entry in a form field.
- **Required attacker capabilities/position**:
    - Ability to create/modify PDF documents.
    - Ability to deliver the malicious PDF to a user/system that will process it.

```
Debian Security Advisory DSA-1941-1                  security@debian.org
<http://www.debian.org/security/>                       Moritz Muehlenhoff
November 25, 2009                     <http://www.debian.org/security/faq>
- ------------------------------------------------------------------------

Package        : poppler
Vulnerability  : several
Problem type   : local(remote)
Debian-specific: no
CVE Id(s)      : CVE-2009-0755 CVE-2009-3903 CVE-2009-3904 CVE-2009-3905 CVE-2009-3906 CVE-2009-3907 CVE-2009-3908 CVE-2009-3909 CVE-2009-3938

Several integer overflows, buffer overflows and memory allocation
errors were discovered in the Poppler PDF rendering library, which may
lead to denial of service or the execution of arbitrary code if a user
is tricked into opening a malformed PDF document.

For the stable distribution (lenny), these problems have been fixed in
version 0.8.7-3.
```

- **Root cause of vulnerability**:
    - Integer overflows, buffer overflows, and memory allocation errors in the Poppler library.
- **Weaknesses/vulnerabilities present**:
    - Integer overflows leading to potential buffer overflows or other memory corruption issues.
    - Improper memory allocation, possibly leading to use-after-free scenarios.
- **Impact of exploitation**:
    - Denial of service.
    - Execution of arbitrary code with the privileges of the user invoking the program.
- **Attack vectors**:
    - Malformed PDF documents.
- **Required attacker capabilities/position**:
    - Ability to create/modify PDF documents.
    - Ability to deliver the malicious PDF to a user/system that will process it.

```
USN-850-1: poppler vulnerabilities

21 October 2009

poppler vulnerabilities

### Reduce your security exposure
[...]
## Details

It was discovered that poppler contained multiple security issues when

parsing malformed PDF documents. If a user or automated system were tricked

into opening a crafted PDF file, an attacker could cause a denial of

service or execute arbitrary code with privileges of the user invoking the

program.
```

- **Root cause of vulnerability**:
    - Multiple security issues while parsing malformed PDF documents.
- **Weaknesses/vulnerabilities present**:
    - Undefined or unexpected behavior when handling malformed PDF data, leading to memory corruption or code execution.
- **Impact of exploitation**:
    - Denial of service.
    - Execution of arbitrary code with the privileges of the user invoking the program.
- **Attack vectors**:
    - Crafted PDF files.
- **Required attacker capabilities/position**:
    - Ability to create/modify PDF documents.
    - Ability to deliver the malicious PDF to a user/system that will process it.

```
SUSE Security Summary Report
Announcement ID: SUSE-SR:2009:012
Date: Fri, 03 Jul 2009 16:00:00 +0000
[...]
- poppler/libpoppler3/libpoppler4
This update of poppler: fix various security bugs that occur while decoding
JBIG2 (CVE-2009-0146, CVE-2009-0147, CVE-2009-0165, CVE-2009-0166,
CVE-2009-0799, CVE-2009-0800, CVE-2009-1179, CVE-2009-1180, CVE-2009-1181,
CVE-2009-1182, CVE-2009-1183).
Further a denial of service bug in function FormWidgetChoice::loadDefaults()
(CVE-2009-0755) and JBIG2Stream::readSymbolDictSeg() (CVE-2009-0756) was closed
that could be triggered via malformed PDF files.
Affected products: openSUSE 10.3-11.1, SLE9-11
```
- **Root cause of vulnerability**:
    - Vulnerabilities in decoding JBIG2 data within PDF files.
    - Denial of service vulnerability in `FormWidgetChoice::loadDefaults()`.
    - Denial of service vulnerability in `JBIG2Stream::readSymbolDictSeg()`.
- **Weaknesses/vulnerabilities present**:
    - Improper handling of JBIG2 stream data.
    - Unhandled cases or missing input validation in `FormWidgetChoice::loadDefaults()`.
    - Improper data processing in `JBIG2Stream::readSymbolDictSeg()`.
- **Impact of exploitation**:
    - Denial of service (crash)
- **Attack vectors**:
    - Malformed PDF files.
- **Required attacker capabilities/position**:
    - Ability to create/modify PDF documents.
    - Ability to deliver the malicious PDF to a user/system that will process it.

```
poppler (0.5.1-0ubuntu7.6) dapper-security; urgency=low

  * SECURITY UPDATE: unsafe malloc usage
    - debian/patches/104_security_CVE-2009-3605.patch: introduce gmallocn3
      and add additional allocation size checks in goo/gmem.{c,h}, replace
      malloc calls with safe versions in glib/poppler-page.cc,
      poppler/{ArthurOutputDev,CairoOutputDev,GfxState,JBIG2Stream,
      PSOutputDev,SplashOutputDev}.cc, splash/{Splash,SplashFTFont}.cc.
    - CVE-2009-3605
  * SECURITY UPDATE: denial of service or arbitrary code execution via
    overflow in rowSize computation
    - debian/patches/105_security_CVE-2009-360x.patch: make sure width
      value is sane in splash/SplashBitmap.cc.
    - CVE-2009-3603
  * SECURITY UPDATE: denial of service or arbitrary code execution via
    overflow in pixel buffer size calculation
    - debian/patches/105_security_CVE-2009-360x.patch: make sure yp value
      is sane in splash/Splash.cc, splash/SplashErrorCodes.h.
    - CVE-2009-3604
  * SECURITY UPDATE: denial of service or arbitrary code execution via
    overflow in object stream handling
    - debian/patches/105_security_CVE-2009-360x.patch: limit number of
      nObjects in poppler/XRef.cc.
    - CVE-2009-3608
  * SECURITY UPDATE: denial of service or arbitrary code execution via
    integer overflow in ImageStream::ImageStream
    - debian/patches/105_security_CVE-2009-360x.patch: check size of width
      and nComps in poppler/Stream.cc.
    - CVE-2009-3609
```
- **Root cause of vulnerability**:
  - Unsafe use of malloc and insufficient size checks during memory allocation.
  - Integer overflows in computation of `rowSize`, pixel buffer sizes, object stream handling and `ImageStream` object construction.
- **Weaknesses/vulnerabilities present**:
   - Integer overflows when calculating sizes for memory allocation.
   - Unsafe `malloc` usage.
   - Lack of input validation or bounds checking for some data in pdf files leading to overflows.
- **Impact of exploitation**:
   - Denial of service.
   - Arbitrary code execution with privileges of the user/process opening the PDF file.
-  **Attack vectors**:
   - Maliciously crafted PDF document with overflowing size values.
- **Required attacker capabilities/position**:
    - Ability to create/modify PDF documents.
    - Ability to deliver the malicious PDF to a user/system that will process it.

Based on the provided content, CVE-2009-0755 refers to a denial-of-service vulnerability in Poppler's `FormWidgetChoice::loadDefaults()` function due to an uninitialized memory access error. The vulnerability can be exploited by crafting a malicious PDF document, leading to a crash of the application processing the document. The vulnerability was fixed in Poppler version 0.10.4.