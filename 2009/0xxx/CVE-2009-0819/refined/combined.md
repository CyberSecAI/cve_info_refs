=== Content from www.vupen.com_b639c17b_20250124_165412.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from bugs.mysql.com_3fc50f54_20250124_165410.html ===

[![MySQL](/images/mysql_100x52-64.gif)](http://dev.mysql.com/)

[Login](https://dev.mysql.com/auth/login/?dest=http%3A%2F%2Fbugs.mysql.com%2Fbug.php%3Fid%3D42495) /
[Register](https://dev.mysql.com/auth/register/)

* [Developer Zone](http://dev.mysql.com/)
* [Bugs Home](/)
* [Report a bug](/report.php)
* [Advanced search](/search.php)
* [Saved searches](/search-saved.php)
* [Tags](/tags.php)

| Bug #42495 | updatexml: Assertion failed: xpath->context, file .\item\_xmlfunc.cc, line 2507 | | |
| --- | --- | --- | --- |
| Submitted: | 31 Jan 2009 8:26 | Modified: | 16 Feb 2009 17:07 |
| Reporter: | [Shane Bester](/search.php?cmd=display&status=All&severity=all&reporter=233657) (Platinum Quality Contributor) | Email Updates: |  |
| Status: | [Closed](http://lists.mysql.com/commits/65127) | Impact on me: | None |
| Category: | MySQL Server: XML functions | Severity: | S1 (Critical) |
| Version: | 5.1.15, 5.1.30, 5.1.32-bzr, 6.0.9, 6.0.10-bzr | OS: | Any |
| Assigned to: | [Sergei Glukhov](/search.php?cmd=display&status=Under+Development&assign=14429) | CPU Architecture: | Any |
| Tags: | [DoS](/search.php?cmd=display&status=Active&tags=DoS), [ExtractValue](/search.php?cmd=display&status=Active&tags=ExtractValue), [updatexml](/search.php?cmd=display&status=Active&tags=updatexml) | | |

* View
* [Add Comment](/bug.php?id=42495&edit=3)
* [Files](/bug.php?id=42495&files=1)
* [Developer](/bug.php?id=42495&edit=1)
* [Edit Submission](/bug.php?id=42495&edit=2)
* [View Progress Log](/bug.php?id=42495&log=1)
* [Contributions](/bug.php?id=42495&contribs=1)

[31 Jan 2009 8:26]
Shane Bester
```
Description:
mysqld.exe!Item_nodeset_func::Item_nodeset_func()[item_xmlfunc.cc:161]
mysqld.exe!nametestfunc()[item_xmlfunc.cc:1006]
mysqld.exe!my_xpath_parse_NodeTest_QName()[item_xmlfunc.cc:2510]
mysqld.exe!my_xpath_parse_NameTest()[item_xmlfunc.cc:2526]
mysqld.exe!my_xpath_parse_NodeTest()[item_xmlfunc.cc:1799]
mysqld.exe!my_xpath_parse_AxisSpecifier_NodeTest_opt_Predicate_list()
mysqld.exe!my_xpath_parse_Step()[item_xmlfunc.cc:1708]
mysqld.exe!my_xpath_parse_RelativeLocationPath()[item_xmlfunc.cc:1625]
mysqld.exe!my_xpath_parse_PathExpr()[item_xmlfunc.cc:1978]
mysqld.exe!my_xpath_parse_UnionExpr()[item_xmlfunc.cc:1929]
mysqld.exe!my_xpath_parse_MultiplicativeExpr()[item_xmlfunc.cc:2266]
mysqld.exe!my_xpath_parse_AdditiveExpr()[item_xmlfunc.cc:2218]
mysqld.exe!my_xpath_parse_RelationalExpr()[item_xmlfunc.cc:2176]
mysqld.exe!my_xpath_parse_EqualityExpr()[item_xmlfunc.cc:2115]
mysqld.exe!my_xpath_parse_AndExpr()[item_xmlfunc.cc:2050]
mysqld.exe!my_xpath_parse_OrExpr()[item_xmlfunc.cc:2019]
mysqld.exe!my_xpath_parse()[item_xmlfunc.cc:2552]
mysqld.exe!Item_xml_str_func::fix_length_and_dec()[item_xmlfunc.cc:2593]
mysqld.exe!Item_func::fix_fields()[item_func.cc:199]
mysqld.exe!Item_str_func::fix_fields()[item_strfunc.cc:56]
mysqld.exe!setup_fields()[sql_base.cc:7387]
mysqld.exe!JOIN::prepare()[sql_select.cc:492]
mysqld.exe!mysql_select()[sql_select.cc:2341]
mysqld.exe!handle_select()[sql_select.cc:269]
mysqld.exe!execute_sqlcom_select()[sql_parse.cc:4889]
mysqld.exe!mysql_execute_command()[sql_parse.cc:2184]
mysqld.exe!mysql_parse()[sql_parse.cc:5791]
mysqld.exe!dispatch_command()[sql_parse.cc:1202]
mysqld.exe!do_command()[sql_parse.cc:857]
mysqld.exe!handle_one_connection()[sql_connect.cc:1115]
mysqld.exe!pthread_start()[my_winthread.c:85]
mysqld.exe!_callthreadstart()[thread.c:295]
mysqld.exe!_threadstart()[thread.c:275]
kernel32.dll!BaseThreadStart()

How to repeat:
select updatexml('','0/a','');
select extractvalue('','0/a');
```

[31 Jan 2009 15:55]
Valeriy Kravchuk
```
Verified just as described on Windows XP SP2.
```

[3 Feb 2009 7:25]
Sergey Petrunya
```
Omer,

Are all crashes now DoSes? If not, could you please explain how this crash is special?
```

[3 Feb 2009 7:26]
Sergey Petrunya
```
In particular, why is this marked DoS, and <http://bugs.mysql.com/bug.php?id=37740> isn't ??
```

[3 Feb 2009 7:44]
Valeriy Kravchuk
```
Verified with recent 5.1.32-bzr and 6.0.10-bzr.
```

[3 Feb 2009 13:08]
Bugs System
```
A patch for this bug has been committed. After review, it may
be pushed to the relevant source trees for release in the next
version. You can access the patch from:

  <http://lists.mysql.com/commits/65001>

2768 Sergey Glukhov	2009-02-03
      [Bug#42495](https://bugs.mysql.com/bug.php?id=42495) updatexml: Assertion failed: xpath->context, file .\item_xmlfunc.cc, line 2507
      Problem:
      RelativeLocationPath can appear only after a node-set expression
      in the third and the fourth branches of this rule:
        PathExpr :: =  LocationPath
                       | FilterExpr
                       | FilterExpr '/' RelativeLocationPath
                       | FilterExpr '//' RelativeLocationPath
      XPatch code didn't check the type of FilterExpr and crashed.
      Fix:
      If FilterExpr is a scalar expression
      (variable reference, literal, number, scalar function call)
      return error.
```

[3 Feb 2009 13:11]
Alexander Barkov
```
The patch is ok to push.
```

[4 Feb 2009 11:40]
Bugs System
```
A patch for this bug has been committed. After review, it may
be pushed to the relevant source trees for release in the next
version. You can access the patch from:

  <http://lists.mysql.com/commits/65127>

2770 Sergey Glukhov	2009-02-04
      [Bug#42495](https://bugs.mysql.com/bug.php?id=42495) updatexml: Assertion failed: xpath->context, file .\item_xmlfunc.cc, line 2507
      Problem:
         RelativeLocationPath can appear only after a node-set expression
         in the third and the fourth branches of this rule:
           PathExpr :: =  LocationPath
                          | FilterExpr
                          | FilterExpr '/' RelativeLocationPath
                          | FilterExpr '//' RelativeLocationPath
         XPatch code didn't check the type of FilterExpr and crashed.
      Fix:
         If FilterExpr is a scalar expression
         (variable reference, literal, number, scalar function call)
         return error.
```

[9 Feb 2009 22:34]
Bugs System
```
Pushed into 5.1.32 (revid:davi.arnaut@sun.com-20090209214102-gj3sb3ujpnvpiy4c) (version source revid:davi.arnaut@sun.com-20090209214102-gj3sb3ujpnvpiy4c) (merge vers: 5.1.32) (pib:6)
```

[14 Feb 2009 13:01]
Bugs System
```
Pushed into 6.0.10-alpha (revid:matthias.leich@sun.com-20090212211028-y72faag15q3z3szy) (version source revid:sergey.glukhov@sun.com-20090204123759-a3v1pwjukl5nkr8n) (merge vers: 6.0.10-alpha) (pib:6)
```

[16 Feb 2009 17:07]
Jon Stephens
```
Documented as a security fix in the 5.1.32 and 6.0.10 changelogs, as follows:

        Using an XPath expression employing a scalar expression as a
        FilterExpr with ExtractValue() or UpdateXML() caused the server
        to crash. Such expressions now cause an error instead.
```

[17 Feb 2009 14:59]
Bugs System
```
Pushed into 5.1.32-ndb-6.3.23 (revid:tomas.ulin@sun.com-20090217131017-6u8qz1edkjfiobef) (version source revid:tomas.ulin@sun.com-20090216083408-rmvyaxjt6mk8sg1y) (merge vers: 5.1.32-ndb-6.3.23) (pib:6)
```

[17 Feb 2009 16:47]
Bugs System
```
Pushed into 5.1.32-ndb-6.4.3 (revid:tomas.ulin@sun.com-20090217134419-5ha6xg4dpedrbmau) (version source revid:tomas.ulin@sun.com-20090216083646-m8st11oj1hhfuuh5) (merge vers: 5.1.32-ndb-6.4.3) (pib:6)
```

[17 Feb 2009 18:23]
Bugs System
```
Pushed into 5.1.32-ndb-6.2.17 (revid:tomas.ulin@sun.com-20090217134216-5699eq74ws4oxa0j) (version source revid:tomas.ulin@sun.com-20090211111208-wf0acl7c1vl5653e) (merge vers: 5.1.32-ndb-6.2.17) (pib:6)
```

[13 Mar 2009 22:39]
James Day
```
To exploit this you need a valid login account on the MySQL server that is authorised to connect from the location from which the account is attempting the access, normally a specified host with matching reverse DNS lookup or IP address.

Versions affected are 5.1.5 through 5.1.31 inclusive and 6.0.0(?) through 6.0.9 inclusive. No versions of 5.0, 4.1, 4.0 or 3.n are affected.

This is reported as vulnerability BID33972.

James Day, MySQL Senior Support Engineer, Sun Microsystems
```

[2 Nov 2009 19:57]
James Day
```
This has been assigned a candidate CVE-2009-0819 . Note that it is only possible to exploit this if all of these conditions are true:

1. You're an authorised direct user of the MySQL server, able to run arbitrary SQL statements on it.
2. No firewall blocks your access, as it normally would in a secure server environment.
3. You're accessing from an authorised location for your user account.

This set of requirements makes it unlikely to be exploitable in a secured environment, particularly one where applications are doing all database accessing. In this environment an added precondition is an SQL injection bug in the application that allows application users to run SQL statements.
```

* [Legal Policies](http://www.mysql.com/about/legal/)
* [Your Privacy Rights](http://www.oracle.com/us/legal/privacy/index.htm)
* [Terms of Use](http://www.oracle.com/html/terms.html)
* [Contact Us](https://www.mysql.com/about/contact/)

Portions of this website are [copyright © 2001, 2002 The PHP Group](http://www.php.net/copyright.php)

Page generated in 0.075 sec. using MySQL 8.0.36-u5-cloud

Timestamp references displayed by the system are UTC.

Content reproduced on this site is the property of the
respective copyright holders.
It is not reviewed in advance
by Oracle and does not necessarily represent the opinion of
Oracle or any other party.

[![Oracle](/images/logo-oracle-red-91x22.gif)](http://www.oracle.com/)  © 2025, Oracle Corporation and/or its affiliates


