```
{
  "CVE-2009-0040": {
    "description": "libpng allows context-dependent attackers to cause a denial of service (application crash) or possibly execute arbitrary code via a crafted PNG file that triggers a free of an uninitialized pointer in (1) the png_read_png function, (2) pCAL chunk handling, or (3) setup of 16-bit gamma tables.",
    "vulnerability_details": {
      "root_cause": "The vulnerability is due to an off-by-one error in multiple functions that results in uninitialized element pointers. If the application runs out of memory during a loop, some element pointers will be uninitialized. Libpng will then longjmp to a cleanup process that attempts to free all of the elements in the array, including the uninitialized ones.",
      "weaknesses": [
        "Improper handling of out-of-memory conditions",
        "Use of uninitialized pointer in memory deallocation."
       ],
      "impact": "A remote attacker may be able to execute arbitrary code or cause a denial of service (application crash). Also, memory corruption could occur due to deallocating memory pointed to by uninitialized pointers.",
      "attack_vectors": [
        "Processing specially crafted PNG file"
      ],
      "required_capabilities": [
        "Ability to create a maliciously crafted PNG file.",
        "Ability to deliver the crafted PNG file to the targeted application"
        ]
    },
    "affected_products": [
      "Multiple applications using vulnerable versions of libpng.",
          "Apple Mac OS X versions prior to and including 10.4.11 (Tiger) and 10.5.6 (Leopard)",
          "Apple Mac OS X Server versions prior to and including 10.4.11 (Tiger) and 10.5.6 (Leopard)",
          "iOS versions prior to 3.0",
           "Safari 3.2.3 for Windows, Mac OS X 10.4, and Mac OS X 10.5",
        "Red Hat Enterprise Linux",
         "Avaya CMS R15",
        "Mozilla Firefox",
        "Mozilla Thunderbird",
        "Seamonkey",
           "VMware Workstation 6.5.1 and earlier, VMware Player 2.5.1 and earlier, VMware ACE 2.5.1 and earlier, VMware Server 2.0, VMware Server 1.0.8 and earlier, VMware Fusion 2.0.1 and earlier",
      "VMware ESXi 3.5 without patch ESXe350-200904402-T-BG",
      "VMware ESX 3.5 without patch ESX350-200904401-BG",
      "VMware ESX 3.0.3 without patch ESX303-200905401-SG",
      "VMware ESX 3.0.2 without patch ESX-1008420",
      "VMware ESX 2.5.5 without update patch 13"
        ]
  }
}
```