Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
The vulnerability stems from the fact that `XMLHttpRequest` in Mozilla Firefox (and other browsers initially) allowed JavaScript to access `Set-Cookie` headers in HTTP responses, even when those cookies were marked with the `HttpOnly` flag. This flag is intended to prevent client-side scripts from accessing cookies, offering protection against cross-site scripting (XSS) attacks.

**Weaknesses/Vulnerabilities:**
*   **Bypassing `HttpOnly`:** The core issue is that `XMLHttpRequest` exposed `HttpOnly` cookies, defeating their purpose.
*   **Information Leakage:** Scripts could potentially read session cookies and other sensitive data marked with `HttpOnly`, exposing users to potential attacks.

**Impact of Exploitation:**
*   **Session Hijacking:** An attacker could use JavaScript code to steal session cookies, allowing them to impersonate a user and perform actions on the user's behalf.
*   **Data Theft:** Attackers could access other sensitive data stored in `HttpOnly` cookies.
*   **XSS Amplification:** This vulnerability could amplify the impact of XSS vulnerabilities by providing attackers with access to sensitive cookies.

**Attack Vectors:**
*   **Malicious JavaScript:** An attacker could inject malicious JavaScript into a website, either through an XSS vulnerability or by compromising the website itself.
*   **Cross-Site Scripting (XSS):** XSS vulnerabilities are the primary attack vector, allowing attackers to inject malicious scripts into a vulnerable web page.
*   **Man-in-the-middle (MitM):** While less likely, a MitM attacker could modify a response to include malicious JavaScript that exploits this vulnerability.

**Required Attacker Capabilities/Position:**
*   **Ability to inject and execute javascript:** The attacker needs to be able to inject and execute Javascript on a page viewed by a victim
*   **Vulnerable website:** Requires a vulnerable website with XSS issues or a compromised site.

**Additional details:**
*   The vulnerability existed because `XMLHttpRequest.getAllResponseHeaders()` and `XMLHttpRequest.getResponseHeader("Set-Cookie")` methods returned `Set-Cookie` headers, including ones with `HttpOnly` attributes.
*   The fix involved preventing these methods from returning `Set-Cookie` and `Set-Cookie2` headers to unprivileged JavaScript.
*   Chrome privileged scripts were still allowed to access these headers.
*   Initially, there was a debate on how to handle it - whether to remove only `HttpOnly` cookies or to completely block access to `Set-Cookie` headers. The decision was to block access to `Set-Cookie` headers entirely for unprivileged scripts, for simplicity and security.
*   There were discussions about the correct parsing of Set-Cookie headers which can be comma-separated, but the final decision was to not modify the cookie parsing logic and block the header completely.
*   The fix was implemented for Firefox 3.0.6, 1.9.1, 1.8.1, and 1.8.0 branches.
*   Other browsers like IE7 were also vulnerable, but IE was patched to filter out the `HttpOnly` cookies.