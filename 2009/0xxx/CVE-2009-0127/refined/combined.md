=== Content from access.redhat.com_f37c6fc8_20250126_060126.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugs.debian.org_d96b24af_20250125_044034.html ===

# Debian Bug report logs - #511515 m2crypto: openssl return values.

Package:
[m2crypto](pkgreport.cgi?package=m2crypto);
Maintainer for [m2crypto](pkgreport.cgi?package=m2crypto) is [Debian Python Team <team+python@tracker.debian.org>,](pkgreport.cgi?maint=team%2Bpython%40tracker.debian.org);

Reported by: [Kurt Roeckx <kurt@roeckx.be>](pkgreport.cgi?submitter=kurt%40roeckx.be)

Date: Sun, 11 Jan 2009 19:18:01 UTC

Severity: important

Tags: security

Reply or subscribe to this bug.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=511515;mbox=yes), [status mbox](bugreport.cgi?bug=511515;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=511515;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Dima Barsky <dima@debian.org>`:

`Bug#511515`; Package `m2crypto`.
(Sun, 11 Jan 2009 19:18:04 GMT) ([full text](bugreport.cgi?bug=511515;msg=2), [mbox](bugreport.cgi?bug=511515;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Kurt Roeckx <kurt@roeckx.be>`:

New Bug report received and forwarded. Copy sent to `Dima Barsky <dima@debian.org>`.
(Sun, 11 Jan 2009 19:18:04 GMT) ([full text](bugreport.cgi?bug=511515;msg=4), [mbox](bugreport.cgi?bug=511515;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=511515;msg=5), [mbox](bugreport.cgi?bug=511515;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=kurt%40roeckx.be)
From: Kurt Roeckx <kurt@roeckx.be>
To: submit@bugs.debian.org
Subject: m2crypto: openssl return values.
Date: Sun, 11 Jan 2009 20:17:24 +0100
```
Package: m2crypto
Severity: important
Tags: security

Hi,

I've been checking packages to see if they properly check the return
value of some of the functions in openssl.  Your package seems to
be calling a few of them:

In SWIG/_evp.i, in verify_final() there is a call to EVP_VerifyFinal
and just return that.  M2Crypto/EVP.py seems to document that
as only returning 0 for failure but it can also return -1 on failure.

There are also calls to DSA_verify(), ECDSA_verify(), DSA_do_verify()
and ECDSA_do_verify() that seem to think that -1 means error,
and then return the return code.  But 0 is also an error case.

For all the functions mentioned, 0 and -1 are errors, 1 mean success.

I have no idea how this is being used.  I think this is being used
by other packages in Debian (dtc-xen, python-pyxmpp) that might
need to be checked instead.

Kurt

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Dima Barsky <dima@debian.org>`:

`Bug#511515`; Package `m2crypto`.
(Thu, 29 Jan 2009 23:33:03 GMT) ([full text](bugreport.cgi?bug=511515;msg=7), [mbox](bugreport.cgi?bug=511515;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Kurt Roeckx <kurt@roeckx.be>`:

Extra info received and forwarded to list. Copy sent to `Dima Barsky <dima@debian.org>`.
(Thu, 29 Jan 2009 23:33:04 GMT) ([full text](bugreport.cgi?bug=511515;msg=9), [mbox](bugreport.cgi?bug=511515;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 511515@bugs.debian.org ([full text](bugreport.cgi?bug=511515;msg=10), [mbox](bugreport.cgi?bug=511515;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=kurt%40roeckx.be)
From: Kurt Roeckx <kurt@roeckx.be>
To: 511515@bugs.debian.org
Subject: Re: m2crypto: openssl return values.
Date: Fri, 30 Jan 2009 00:30:50 +0100
```
On Sun, Jan 11, 2009 at 08:17:24PM +0100, Kurt Roeckx wrote:
> Package: m2crypto
> Severity: important
> Tags: security
>
> Hi,
>
> I've been checking packages to see if they properly check the return
> value of some of the functions in openssl.  Your package seems to
> be calling a few of them:
>
> In SWIG/_evp.i, in verify_final() there is a call to EVP_VerifyFinal
> and just return that.  M2Crypto/EVP.py seems to document that
> as only returning 0 for failure but it can also return -1 on failure.
>
> There are also calls to DSA_verify(), ECDSA_verify(), DSA_do_verify()
> and ECDSA_do_verify() that seem to think that -1 means error,
> and then return the return code.  But 0 is also an error case.
>
> For all the functions mentioned, 0 and -1 are errors, 1 mean success.
>
> I have no idea how this is being used.  I think this is being used
> by other packages in Debian (dtc-xen, python-pyxmpp) that might
> need to be checked instead.

There might be simular problems with calls like X509_REQ_verify
and X509_verify.

Kurt

```

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=511515).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 04:40:34 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from bugzilla.redhat.com_46c5f385_20250125_044035.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D479676)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D479676)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D479676)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 479676

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 479676**](show_bug.cgi?id=479676)
(CVE-2009-0127)
- [CVE-2009-0127](https://access.redhat.com/security/cve/CVE-2009-0127) m2crypto: OpenSSL incorrect checks for malformed signatures

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2009-0127 m2crypto: OpenSSL incorrect checks for malformed signatures

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED NOTABUG | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2009-0127 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | high | | [Severity:](page.cgi?id=fields.html#bug_severity) | high | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [http://bugs.debian.org/cgi-bin/bugrep...](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=511515) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=479676&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=479676&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2009-01-12 13:15 UTC by Jan Lieskovsky | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-11-12 19:55 UTC ([History](show_activity.cgi?id=479676)) | | [CC List:](page.cgi?id=fields.html#cclist) | 1 user (show)  mitr | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2009-01-12 14:48:42 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=479676#c0)  Jan Lieskovsky    2009-01-12 13:15:00 UTC  ``` The m2crypto package (allowing to call OpenSSL functions from python scripts) incorrectly checked the result after calling various cryptographic decryption functions, allowing a malformed signature to be treated as a good signature rather than as an error.  This issue affected the signature checks on DSA keys  and ECDSA keys used with SSL/TLS.  There are also calls to DSA_verify(), ECDSA_verify(), DSA_do_verify() and ECDSA_do_verify() that seem to think that -1 means error, and then return the return code.  But 0 is also an error case (see man DSA_do_verify for example).  Relevant part of the code: (SWIG/_dsa.i):     261     ret = DSA_do_verify(vbuf, vlen, sig, dsa);     262     DSA_SIG_free(sig);     263     if (ret == -1)     264         PyErr_SetString(_dsa_err, ERR_reason_error_string(ERR_get_error()));     265     return ret;   SWIG/_ec.i      248     ret = ECDSA_do_verify(vbuf, vlen, sig, key);     249     ECDSA_SIG_free(sig);     250     if (ret == -1)     251         PyErr_SetString(_ec_err, ERR_reason_error_string(ERR_get_error()));     252     return ret;  Occurences of other above mentioned functions: SWIG]# grep -r DSA_verify * | more _dsa.i:    if ((ret = DSA_verify(0, vbuf, vlen, sbuf, slen, dsa)) == -1) _ec.i:    if ((ret = ECDSA_verify(0, vbuf, vlen, sbuf, slen, key)) == -1)  SWIG]# grep -r ECDSA_verify * | more _ec.i:    if ((ret = ECDSA_verify(0, vbuf, vlen, sbuf, slen, key)) == -1)  SWIG]# grep -r ECDSA_do_verify * | more _ec.i:    ret = ECDSA_do_verify(vbuf, vlen, sig, key);   Please check also the following two issues:  The implementation of the verify_final() function in SWIG/_evp.i calls OpenSSL's EVP_VerifyFinal function (which was vulnerable to the recent OpenSSL's [CVE-2008-5077](https://access.redhat.com/security/cve/CVE-2008-5077) flaw) and 'only' returns its value.  M2Crypto/EVP.py seems to document that as only returning 0 for failure but it can also return -1 on failure.  All these issues are related with recent OpenSSL's [CVE-2008-5077](https://access.redhat.com/security/cve/CVE-2008-5077) flaw. Please see:  [https://bugzilla.redhat.com/show_bug.cgi?id=476671](show_bug.cgi?id=476671 "CLOSED ERRATA - CVE-2008-5077 OpenSSL Incorrect checks for malformed signatures")  for more information.  References: <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=511515>   ```  [Comment 1](show_bug.cgi?id=479676#c1)  Miloslav Trmač    2009-01-12 14:48:42 UTC  ``` The interface of these functions is: * return 1 if the signature is correct * return 0 if the signature is incorrect * raise an exception "on failure" (when OpenSSL returns -1)  I'm not sure why OpenSSL separates "failure" and "error", but it doesn't really matter.  AFAICS these functions are not used anywhere in m2crypto.  Nor are thery used anywhere in Fedora (nothing in Fedora depends on m2crypto) or in RHEL (python-urlgrabber depends on M2Crypto, but it doesn't use any of the signature verification functions).  If they are not used, they are never used incorrectly.  The only thing that is incorrect is EVP.py:PKey.verify_final - either the comment is correct and the function should raise an exception on -1, or the comment is missing a description of the -1 return value.  I'll submit a patch upstream to document the -1 return value.  (Please reopen the bug report if I have missed something.)   ```  [Comment 2](show_bug.cgi?id=479676#c2)  Jan Lieskovsky    2009-01-16 14:17:34 UTC  ``` Common Vulnerabilities and Exposures assigned an identifier [CVE-2009-0127](https://access.redhat.com/security/cve/CVE-2009-0127) to the following vulnerability:  ** DISPUTED ** M2Crypto does not properly check the return value from the OpenSSL EVP_VerifyFinal, DSA_verify, ECDSA_verify, DSA_do_verify, and ECDSA_do_verify functions, which might allow remote attackers to bypass validation of the certificate chain via a malformed SSL/TLS signature, a similar vulnerability to [CVE-2008-5077](https://access.redhat.com/security/cve/CVE-2008-5077). NOTE: a Linux vendor disputes the relevance of this report to the M2Crypto product because "these functions are not used anywhere in m2crypto."  References: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0127> <http://openwall.com/lists/oss-security/2009/01/12/4> <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=511515>   ```  [Comment 3](show_bug.cgi?id=479676#c3)  Miloslav Trmač    2009-01-16 15:09:56 UTC  ``` Perhaps a better description of my objection is the following:  "There is no vulnerability in M2Crypto.  Nowhere in the functions are the return values of OpenSSL functions interpreted incorrectly.  The functions provide an interface to their users that may be considered confusing, but is not incorrect, nor it is a vulnerability.  We have searched for uses of these functions in $our distribution to identify potential incorrect uses of the interface, and to the best of our knowledge  these functions are never used in $our_distribution."   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=479676&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from openwall.com_0b65795d_20250125_044034.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](../../../2009/01/13/1) [[thread-next>]](../../../2009/01/21/6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <1231767584.3228.13.camel@dhcp-lab-164.englab.brq.redhat.com>
Date: Mon, 12 Jan 2009 14:39:44 +0100
From: Jan Lieskovsky <jlieskov@...hat.com>
To: "Steven M. Christey" <coley@...us.mitre.org>
Cc: oss-security@...ts.openwall.com
Subject: CVE Request -- tsqllib, slurm-llnl, libnasl,
	libcrypt-openssl-dsa-perl, erlang, boinc-client, m2crypto

Hello Steve,

  could you please allocate CVE ids for the following OpenSSL's
CVE-2008-5077 related issues:

tsqllib:  <https://bugzilla.redhat.com/show_bug.cgi?id=479650>
          <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=511509>

libnasl: <https://bugzilla.redhat.com/show_bug.cgi?id=479655>
         <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=511517>

boinc-client: <https://bugzilla.redhat.com/show_bug.cgi?id=479664>
              <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=511521>

m2crypto: <https://bugzilla.redhat.com/show_bug.cgi?id=479676>
          <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=511515>

Other related issues (probably more to come):
slurm-llnl:                 <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=511511>
libcrypt-openssl-dsa-perl:  <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=511519>
erlang:                     <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=511520>
                            (Lower severity issue due the fact, the output of
                             DSA_do_verify function is further processed and
                             sent back to the caller, where it is compared against 1:

>>From lib/crypto/src/crypto.erl:

dss_verify(Dgst,Signature,Key) ->
    control(?DSS_VERIFY, [Dgst,Signature,Key]) == <<1>>.

Thanks, Jan.
--
Jan iankko Lieskovsky / Red Hat Security Response Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


