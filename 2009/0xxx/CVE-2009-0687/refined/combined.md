=== Content from www.vupen.com_cf4aa86e_20250124_140820.html ===

[![](/__ovh/common/img/logo-white.png)](https://www.ovhcloud.com/)

![](/__ovh/common/img/icon-traffic-cone.png)

# Site en construction

![](/__ovh/common/img/shadow.png)

Besoin d'assistance ou d'informations ?

[![](/__ovh/common/img/icon-book.png)
Guides](https://docs.ovh.com/fr/hosting/ "Guides")
[![](/__ovh/common/img/icon-speech-bubble.png)
Forum](https://community.ovh.com/ "Forum")
[![](/__ovh/common/img/icon-user-support.png)
Contact](https://help.ovhcloud.com/fr/ "Contact")
[![](/__ovh/common/img/icon-app-gear.png)
Espace Client](https://www.ovh.com/manager/ "Espace Client")

© Copyright 1999 [OVHcloud](https://www.ovhcloud.com/)

v1v2v3v4v5v6v7v8v9v10v11v12v13v14v15v16v17v18v19v20v21v22v23v24v25v26v27v28v29v30v31v32v33v34v35v36v37v38v39v40v41v42v43v44v45v46v47v48v49v50v51v52v53v54v55v56v57v58v59v60v61v62v63v64v65v66v67v68v69v70

u1u2u3u4u5u6u7u8u9u10u11u12u13u14u15u16u17u18u19u20u21u22u23u24u25u26u27u28u29u30u31u32u33u34u35u36u37u38u39u40u41u42u43u44u45u46u47u48u49u50u51u52u53u54u55u56u57u58u59u60u61u62u63u64u65u66u67u68u69

p1p2p3p4p5p6p7p8p9p10p11p12p13p14p15p16p17p18p19p20p21p22p23p24p25p26p27p28p29p30p31p32p33p34p35p36p37p38p39p40p41p42p43p44p45p46p47p48p49p50p51p52p53p54p55p56p57p58p59p60p61p62p63p64

e1e2e3e4e5e6e7e8e9e10e11e12e13e14e15e16e17e18e19e20e21e22e23e24e25e26e27e28e29e30e31e32e33e34e35e36e37e38e39e40e41e42e43e44e45e46e47e48e49e50e51e52e53

n1n2n3n4n5n6n7n8n9n10n11n12n13n14n15n16n17n18n19n20n21n22n23n24n25n26n27n28n29n30n31n32n33n34n35n36n37n38n39n40n41n42n43n44n45n46n47n48n49n50n51n52n53n54n55n56n57n58n59n60n61n62

---

c1c2c3c4c5c6c7c8c9c10c11c12c13c14c15c16c17c18c19c20c21c22c23c24c25c26c27c28c29c30c31c32c33c34c35c36c37c38c39c40c41c42c43c44c45c46c47c48c49c50c51

o1o2o3o4o5o6o7o8o9o10o11o12o13o14o15o16o17o18o19o20o21o22o23o24o25o26o27o28o29o30o31o32o33o34o35o36o37o38o39o40o41o42o43o44o45o46o47o48o49o50o51o52o53o54o55o56o57o58o59o60o61o62o63

m1m2m3m4m5m6m7m8m9m10m11m12m13m14m15m16m17m18m19m20m21m22m23m24m25m26m27m28m29m30m31m32m33m34m35m36m37m38m39m40m41m42m43m44m45m46m47m48m49m50m51m52m53m54m55m56m57m58m59m60m61



=== Content from www.openbsd.org_5bb4e2ad_20250124_140820.html ===


OpenBSD 4.4 Errata

## [*Open***BSD**](index.html) 4.4 Errata

---

For errata on a certain release, click below:

[2.0](errata20.html),
[2.1](errata21.html),
[2.2](errata22.html),
[2.3](errata23.html),
[2.4](errata24.html),
[2.5](errata25.html),
[2.6](errata26.html),
[2.7](errata27.html),
[2.8](errata28.html),
[2.9](errata29.html),
[3.0](errata30.html),
[3.1](errata31.html),
[3.2](errata32.html),
[3.3](errata33.html),
[3.4](errata34.html),
[3.5](errata35.html),

[3.6](errata36.html),
[3.7](errata37.html),
[3.8](errata38.html),
[3.9](errata39.html),
[4.0](errata40.html),
[4.1](errata41.html),
[4.2](errata42.html),
[4.3](errata43.html),
[4.5](errata45.html),
[4.6](errata46.html),
[4.7](errata47.html),
[4.8](errata48.html),
[4.9](errata49.html),
[5.0](errata50.html),
[5.1](errata51.html),
[5.2](errata52.html),

[5.3](errata53.html),
[5.4](errata54.html),
[5.5](errata55.html),
[5.6](errata56.html),
[5.7](errata57.html),
[5.8](errata58.html),
[5.9](errata59.html),
[6.0](errata60.html),
[6.1](errata61.html),
[6.2](errata62.html),
[6.3](errata63.html),
[6.4](errata64.html),
[6.5](errata65.html),
[6.6](errata66.html),
[6.7](errata67.html),
[6.8](errata68.html),

[6.9](errata69.html),
[7.0](errata70.html),
[7.1](errata71.html),
[7.2](errata72.html),
[7.3](errata73.html),
[7.4](errata74.html),
[7.5](errata75.html),
[7.6](errata76.html).

---

Patches for the OpenBSD base system are distributed as unified diffs.
Each patch contains usage instructions.
All the following patches are also available in one
[tar.gz file](https://ftp.openbsd.org/pub/OpenBSD/patches/4.4.tar.gz)
for convenience.

Patches for supported releases are also incorporated into the
[-stable branch](stable.html).

---

* **001: SECURITY FIX: November 2, 2008**
    *All architectures*

  The Neighbor Discovery Protocol (ndp) did not correctly verify neighbor
  solicitation requests maybe allowing a nearby attacker to intercept traffic.
  The attacker must have IPv6 connectivity to the same router as their target for
  this vulnerability to be exploited.
  [CVE-2008-2476](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2476).

  [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.4/common/001_ndp.patch)

  * **002: RELIABILITY FIX: November 2, 2008**
      *All architectures*

    Due to a bug in the vr(4) driver it is possible for a system using the vr(4)
    driver to panic under heavy load if the RX path runs out of mbufs.

    [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.4/common/002_vr.patch)

    * **003: RELIABILITY FIX: November 6, 2008**
        *All architectures*

      Fix the IPv4 TCP/IP stack's TIME\_WAIT socket recycling. Due to the bug this
      can result in TCP connections between two IPs being reset instead of accepted
      if being received on a socket in the TIME\_WAIT state.

      [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.4/common/003_tcpinput.patch)

      * **004: RELIABILITY FIX: November 6, 2008**
          *All architectures*

        Fix
        [httpd(8)](https://man.openbsd.org/OpenBSD-4.4/httpd.8)'s
        mod\_proxy module which is broken on 64-bit architectures. Due to the bug this
        will result in child processes crashing when utilizing proxy rules during an
        HTTP session.

        [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.4/common/004_httpd.patch)

        * **005: RELIABILITY FIX: November 7, 2008**
            *All architectures*

          A software bug could cause memory allocation to cause a kernel panic
          accessing an array out of its bounds, when physical memory is exhausted.

          [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.4/common/005_pglistalloc.patch)

          * **006: RELIABILITY FIX: November 19, 2008**
              *All architectures*

            Due to changes in the options handling this caused problems with some
            DHCP clients such as Solaris/OpenSolaris and some embedded routers not
            accepting DHCP offers.

            [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.4/common/006_dhcpd.patch)

            * **007: SECURITY FIX: January 9, 2009**
                *All architectures*

              The OpenSSL libraries did not correctly check the return value from
              certain verification functions, allowing validation to be bypassed and
              permitting a remote attacker to conduct a "man in the middle attack"
              against SSL/TLS connections if the server is configured with a DSA or ECDSA
              certificate.
              [CVE-2008-5077](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5077).

              [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.4/common/007_openssl.patch)

              * **008: SECURITY FIX: January 14, 2009**
                  *All architectures*

                named(8) did not correctly check the return value of a DSA verification
                function, potentially allowing bypass of verification of DNSSEC DSA
                signatures.
                [CVE-2009-0025](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0025).

                [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.4/common/008_bind.patch)

                * **009: RELIABILITY FIX: January 30, 2009**
                    *All architectures*

                  Upon reception of an invalid update with 4-byte AS attributes, bgpd -
                  adhering to the RFCs - closed the session to the neighbor.
                  This error in the specification allowed 3rd parties to close remote BGP
                  sessions.
                  In the worst case Internet connectivity could be lost.

                  [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.4/common/009_bgpd.patch)

                  * **010: RELIABILITY FIX: February 18, 2009**
                      *All architectures*

                    bgpd(8) did not correctly prepend its own AS to very long AS paths, causing
                    the process to terminate because of the resulting corrupt path.

                    [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.4/common/010_bgpd.patch)

                    * **011: SECURITY FIX: February 22, 2009**
                        *All architectures*

                      sudo(8) may allow a user listed in the sudoers file to run a command
                      as a different user than their access rule specifies when a Unix
                      group is used in the RunAs portion of the rule. The bug only manifests
                      when the user being granted privileges is also a member of the group
                      in the RunAs portion of the rule.

                      [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.4/common/011_sudo.patch)

                      * **012: RELIABILITY FIX: April 8, 2009**
                          *All architectures*

                        The OpenSSL ASN.1 handling code could be forced to perform invalid memory
                        accesses through the use of certain invalid strings
                        ([CVE-2009-0590](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0590))
                        or under certain error conditions triggerable by invalid ASN.1 structures
                        ([CVE-2009-0789](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0789)).
                        These vulnerabilities could be exploited to achieve a
                        denial-of-service. A more detailed description of these problems is available
                        in the
                        [OpenSSL security advisory](http://www.openssl.org/news/secadv_20090325.txt), but note that the other issue described there "Incorrect Error
                        Checking During CMS verification" relates to code not enabled in OpenBSD.

                        [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.4/common/012_openssl.patch)

                        * **013: RELIABILITY FIX: April 11, 2009**
                            *All architectures*

                          When pf attempts to perform translation on a specially crafted IP datagram,
                          a null pointer dereference will occur, resulting in a kernel panic.
                          In certain configurations this may be triggered by a remote attacker.

                          Restricting translation rules to protocols that are specific to the IP version
                          in use, is an effective workaround until the patch can be installed. As an
                          example, for IPv4 nat/binat/rdr rules you can use:
                          ```

                              nat/rdr ... inet proto { tcp udp icmp } ...

                          ```
                          Or for IPv6 nat/binat/rdr rules you can use:
                          ```

                              nat/rdr ... inet6 proto { tcp udp icmp6 } ...

                          ```
                          [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.4/common/013_pf.patch)

                          * **014: RELIABILITY FIX: July 29, 2009**
                              *All architectures*

                            A vulnerability has been found in BIND's named server
                            ([CVE-2009-0696](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0696)).
                            An attacker could crash a server with a specially crafted dynamic update message to a
                            zone for which the server is master.

                            [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.4/common/014_bind.patch)

                            * **015: RELIABILITY FIX: October 05, 2009**
                                *i386 only*

                              XMM exceptions are not correctly handled resulting in a kernel panic.

                              [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.4/i386/015_xmm.patch)

                              * **016: RELIABILITY FIX: October 28, 2009**
                                  *All architectures*

                                getsockopt(2) with any of IP\_AUTH\_LEVEL, IP\_ESP\_TRANS\_LEVEL, IP\_ESP\_NETWORK\_LEVEL,
                                IP\_IPCOMP\_LEVEL will crash the system.

                                [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.4/common/016_getsockopt.patch)

---



=== Content from ftp.netbsd.org_42008785_20250124_140819.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
NetBSD Security Advisory 2009-001
=================================
Topic: PF firewall remote Denial Of Service attack
Version: NetBSD-current: affected
NetBSD 5.0: not affected
NetBSD 4.0.\*: not affected
NetBSD 4.0: not affected
NetBSD 3.1.\*: not affected
NetBSD 3.1: not affected
NetBSD 3.0.\*: not affected
NetBSD 3.0: not affected
Severity: Denial of service
Fixed: NetBSD-current: April 14, 2009
NetBSD-5 branch: April 14, 2009
(5.0 includes the fix)
Please note that NetBSD releases prior to 4.0 are no longer supported.
It is recommended that all users upgrade to a supported release.
Abstract
========
PF firewalls suffer from a remote denial of service attack (system
panic) due to mishandling of some ICMP and ICMPV6 packets.
Technical Details
=================
When a PF firewall using nat or rdr receives a specially crafted
packet, a null pointer dereference causes a kernel panic.
In pf\_test\_rule() ICMP logic was implied for IPv6 packets and ICMPv6 logic
was implied for IPv4 packets. The wrong ICMP header length is used and an
assertion fails due to the attempt to access unallocated memory.
See also:
http://www.securityfocus.com/archive/1/502634
http://www.helith.net/txt/multiple\_vendor-PF\_null\_pointer\_dereference.txt
Solutions and Workarounds
=========================
Only kernels compiled with the following option are vulnerable to this issue:
pseudo-device pf
As a temporary workaround recompile the kernel with the above option
commented out. The default NetBSD GENERIC kernels do not have this
option enabled. In addition to this the system must be running
with nat and/or rdr rules present in the active ruleset.
An additional workaround can be to add the following rules to your
/etc/pf.conf configuration file:
nat/rdr ... inet proto { tcp udp icmp } ...
nat/rdr ... inet6 proto { tcp udp icmp6 } ...
For all NetBSD versions, you need to obtain fixed kernel sources,
rebuild and install the new kernel, and reboot the system.
The fixed source may be obtained from the NetBSD CVS repository.
The following instructions briefly summarize how to upgrade your
kernel. In these instructions, replace:
ARCH with your architecture (from uname -m), and
KERNCONF with the name of your kernel configuration file.
To update from CVS, re-build, and re-install the kernel:
# cd src
# cvs update -d -P sys/dist/pf/net/pf.c
# ./build.sh kernel=KERNCONF
# mv /netbsd /netbsd.old
# cp sys/arch/ARCH/compile/obj/KERNCONF/netbsd /netbsd
# shutdown -r now
For more information on how to do this, see:
http://www.NetBSD.org/guide/en/chap-kernel.html
Thanks To
=========
"Rembrandt" is credited with the discovery of this issue.
Christos Zoulas for applying the OpenBSD fix.
Revision History
================
2009-03-15 Initial release
More Information
================
Advisories may be updated as new information becomes available.
The most recent version of this advisory (PGP signed) can be found at
ftp://ftp.NetBSD.org/pub/NetBSD/security/advisories/NetBSD-SA2009-001.txt.asc
Information about NetBSD and NetBSD security can be found at
http://www.NetBSD.org/ and http://www.NetBSD.org/Security/.
Copyright 2009, The NetBSD Foundation, Inc. All Rights Reserved.
Redistribution permitted only in full, unmodified form.
$NetBSD: NetBSD-SA2009-001.txt,v 1.1 2009/06/22 19:31:01 tonnerre Exp $
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (NetBSD)
iQCVAwUBSj/8Cj5Ru2/4N2IFAQJlDwP9Eggc2LerlYb8vqLDBxP5hP2nQSZmW4Go
sUdsUTVif28lroTl4JA7Jk5pws65KaD9ST9hMgALk7w0g6G0xm17yJwBQxobzmpw
mY87797lDxFGWAyTBbY00ChyrSKSnsq6hTeMjt3/45hlkClIMk0nnL6oJ9DvkzMr
sg759/2biBo=
=vrEJ
-----END PGP SIGNATURE-----


=== Content from www.openbsd.org_8d1b1ada_20250124_140820.html ===


OpenBSD 4.5 Errata

## [*Open***BSD**](index.html) 4.5 Errata

---

[For OpenBSD patch branch information, please refer here.](stable.html)

For errata on a certain release, click below:

[2.0](errata20.html),
[2.1](errata21.html),
[2.2](errata22.html),
[2.3](errata23.html),
[2.4](errata24.html),
[2.5](errata25.html),
[2.6](errata26.html),
[2.7](errata27.html),
[2.8](errata28.html),
[2.9](errata29.html),
[3.0](errata30.html),
[3.1](errata31.html),
[3.2](errata32.html),
[3.3](errata33.html),
[3.4](errata34.html),
[3.5](errata35.html),

[3.6](errata36.html),
[3.7](errata37.html),
[3.8](errata38.html),
[3.9](errata39.html),
[4.0](errata40.html),
[4.1](errata41.html),
[4.2](errata42.html),
[4.3](errata43.html),
[4.4](errata44.html),
[4.6](errata46.html),
[4.7](errata47.html),
[4.8](errata48.html),
[4.9](errata49.html),
[5.0](errata50.html),
[5.1](errata51.html),
[5.2](errata52.html),

[5.3](errata53.html),
[5.4](errata54.html),
[5.5](errata55.html),
[5.6](errata56.html),
[5.7](errata57.html),
[5.8](errata58.html),
[5.9](errata59.html),
[6.0](errata60.html),
[6.1](errata61.html),
[6.2](errata62.html),
[6.3](errata63.html),
[6.4](errata64.html),
[6.5](errata65.html),
[6.6](errata66.html),
[6.7](errata67.html),
[6.8](errata68.html),

[6.9](errata69.html),
[7.0](errata70.html),
[7.1](errata71.html),
[7.2](errata72.html),
[7.3](errata73.html),
[7.4](errata74.html),
[7.5](errata75.html),
[7.6](errata76.html).

---

Patches for the OpenBSD base system are distributed as unified diffs.
Each patch contains usage instructions.
All the following patches are also available in one
[tar.gz file](https://ftp.openbsd.org/pub/OpenBSD/patches/4.5.tar.gz)
for convenience.

Patches for supported releases are also incorporated into the
[-stable branch](stable.html).

---

* **001: RELIABILITY FIX: April 8, 2009**
    *All architectures*

  The OpenSSL ASN.1 handling code could be forced to perform invalid memory
  accesses through the use of certain invalid strings
  ([CVE-2009-0590](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0590))
  or under certain error conditions triggerable by invalid ASN.1 structures
  ([CVE-2009-0789](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0789)).
  These vulnerabilities could be exploited to achieve a
  denial-of-service. A more detailed description of these problems is available
  in the
  [OpenSSL security advisory](http://www.openssl.org/news/secadv_20090325.txt), but note that the other issue described there "Incorrect Error
  Checking During CMS verification" relates to code not enabled in OpenBSD.

  [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.5/common/001_openssl.patch)

  * **002: RELIABILITY FIX: April 11, 2009**
      *All architectures*

    When pf attempts to perform translation on a specially crafted IP datagram,
    a null pointer dereference will occur, resulting in a kernel panic.
    In certain configurations this may be triggered by a remote attacker.

    Restricting translation rules to protocols that are specific to the IP version
    in use, is an effective workaround until the patch can be installed. As an
    example, for IPv4 nat/binat/rdr rules you can use:
    ```

        nat/rdr ... inet proto { tcp udp icmp } ...

    ```
    Or for IPv6 nat/binat/rdr rules you can use:
    ```

        nat/rdr ... inet6 proto { tcp udp icmp6 } ...

    ```
    [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.5/common/002_pf.patch)

    * **003: RELIABILITY FIX: April 24, 2009**
        *i386 only*

      When DMA'able memory is mapped by device drivers, the
      mapping flags and protection are partially uninitialized.
      Depending on the calling context, this may cause devices to misbehave, like
      [audio(4)](https://man.openbsd.org/OpenBSD-4.5/audio.4)
      to stutter, but other anomalies might be observed for other
      device types.

      [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.5/i386/003_bus_dma.patch)

      * **004: RELIABILITY FIX: April 24, 2009**
          *All architectures*

        In server mode when in full-duplex mode (the default)
        [aucat(1)](https://man.openbsd.org/OpenBSD-4.5/aucat.1)
        will send each synchronization message twice, causing client applications
        to think that buffer underruns are occurring. Depending on the
        application, this may cause the sound to stutter.

        [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.5/common/004_aucat.patch)

        * **005: RELIABILITY FIX: April 24, 2009**
            *All architectures*

          On very high system load, an audio interrupt may occur while the
          audio process is filling audio ring buffers. This triggers bogus
          (and useless) correction code in the
          [audio(4)](https://man.openbsd.org/OpenBSD-4.5/audio.4)
          driver causing the audio application to go out of sync, and in turn causing
          continuous stuttering until the application is restarted.

          [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.5/common/005_audio.patch)

          * **006: RELIABILITY FIX: June 24, 2009**
              *All architectures*

            An off-by-one error in the inflate function in Zlib.xs in the
            Compress::Raw::Zlib perl module before 2.017 ([CVE-2009-1391](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1391)),
            as used in AMaViS, SpamAssassin, and possibly other products,
            allows context-dependent attackers to cause a denial of service
            (hang or crash) via a crafted zlib compressed stream that
            triggers a heap-based buffer overflow.

            [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.5/common/006_perl_zlib.patch)

            * **007: RELIABILITY FIX: July 29, 2009**
                *All architectures*

              A vulnerability has been found in BIND's named server
              ([CVE-2009-0696](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0696)).
              An attacker could crash a server with a specially crafted dynamic update message to a
              zone for which the server is master.

              [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.5/common/007_bind.patch)

              * **008: RELIABILITY FIX: October 05, 2009**
                  *i386 only*

                XMM exceptions are not correctly handled resulting in a kernel panic.

                [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.5/i386/008_xmm.patch)

                * **009: RELIABILITY FIX: October 28, 2009**
                    *All architectures*

                  getsockopt(2) with any of IP\_AUTH\_LEVEL, IP\_ESP\_TRANS\_LEVEL, IP\_ESP\_NETWORK\_LEVEL,
                  IP\_IPCOMP\_LEVEL will crash the system.

                  [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.5/common/009_getsockopt.patch)

                  * **010: SECURITY FIX: November 26, 2009**
                      *All architectures*

                    The SSL/TLS protocol is subject to man-in-the-middle attacks related to
                    renegotiation (see CVE-2009-3555, draft-ietf-tls-renegotiation-00).
                    OpenSSL permitted this protocol feature by default and had no way to
                    disable it.

                    [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.5/common/010_openssl.patch)

                    * **011: RELIABILITY FIX: January 29, 2010**
                        *All architectures*

                      By using ptrace(2) on an ancestor process, a loop in the process tree
                      could be created, violating assumptions in other parts of the kernel
                      and resulting in infinite loops.

                      [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.5/common/011_ptrace.patch)

                      * **012: SECURITY FIX: March 12, 2010**
                          *All architectures*

                        OpenSSL is susceptible to a buffer overflow due to a failure
                        to check for NULL returns from bn\_wexpand function calls.

                        [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.5/common/012_openssl.patch)

                        * **013: RELIABILITY FIX: March 12, 2010**
                            *All architectures*

                          Due to a null pointer dereference, it would be possible to crash ftpd when
                          handling glob(3)'ing requests. This is non-exploitable.

                          [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.5/common/013_ftpd.patch)

                          * **014: RELIABILITY FIX: March 31, 2010**
                              *All architectures*

                            When decrypting packets, the internal decryption functions were not
                            paranoid enough in checking for underruns, which could potentially
                            lead to crashes.

                            [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.5/common/014_kerberos.patch)

                            * **015: RELIABILITY FIX: April 4, 2010**
                                *All architectures*

                              When updating sensors showing the state of RAID volumes
                              [mpi(4)](https://man.openbsd.org/OpenBSD-4.5/mpi.4)
                              allocates temporary memory and then returns it to the kernel as
                              device memory.
                              This causes kernel memory usage to be misrepresented, eventually
                              leading to a denial of service when a resource limit is apparently
                              reached.

                              [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.5/common/015_mpi.patch)

                              * **016: SECURITY FIX: April 14, 2010**
                                  *All architectures*

                                In TLS connections, certain incorrectly formatted records can cause
                                an OpenSSL client or server to crash due to a read attempt at NULL.

                                [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.5/common/016_openssl.patch)

---



=== Content from www.openbsd.org_038d20f2_20250124_140819.html ===


OpenBSD 4.3 Errata

## [*Open***BSD**](index.html) 4.3 Errata

---

For errata on a certain release, click below:

[2.0](errata20.html),
[2.1](errata21.html),
[2.2](errata22.html),
[2.3](errata23.html),
[2.4](errata24.html),
[2.5](errata25.html),
[2.6](errata26.html),
[2.7](errata27.html),
[2.8](errata28.html),
[2.9](errata29.html),
[3.0](errata30.html),
[3.1](errata31.html),
[3.2](errata32.html),
[3.3](errata33.html),
[3.4](errata34.html),
[3.5](errata35.html),

[3.6](errata36.html),
[3.7](errata37.html),
[3.8](errata38.html),
[3.9](errata39.html),
[4.0](errata40.html),
[4.1](errata41.html),
[4.2](errata42.html),
[4.4](errata44.html),
[4.5](errata45.html),
[4.6](errata46.html),
[4.7](errata47.html),
[4.8](errata48.html),
[4.9](errata49.html),
[5.0](errata50.html),
[5.1](errata51.html),
[5.2](errata52.html),

[5.3](errata53.html),
[5.4](errata54.html),
[5.5](errata55.html),
[5.6](errata56.html),
[5.7](errata57.html),
[5.8](errata58.html),
[5.9](errata59.html),
[6.0](errata60.html),
[6.1](errata61.html),
[6.2](errata62.html),
[6.3](errata63.html),
[6.4](errata64.html),
[6.5](errata65.html),
[6.6](errata66.html),
[6.7](errata67.html),
[6.8](errata68.html),

[6.9](errata69.html),
[7.0](errata70.html),
[7.1](errata71.html),
[7.2](errata72.html),
[7.3](errata73.html),
[7.4](errata74.html),
[7.5](errata75.html),
[7.6](errata76.html).

---

Patches for the OpenBSD base system are distributed as unified diffs.
Each patch contains usage instructions.
All the following patches are also available in one
[tar.gz file](https://ftp.openbsd.org/pub/OpenBSD/patches/4.3.tar.gz)
for convenience.

Patches for supported releases are also incorporated into the
[-stable branch](stable.html).

---

* **001: SECURITY FIX: March 30, 2008**
    *All architectures*

  sshd(8) would execute ~/.ssh/rc even when a sshd\_config(5) *ForceCommand*
  directive was in effect, allowing users with write access to this file to
  execute arbitrary commands. This behaviour was documented, but was an unsafe
  default and an extra hassle for administrators.

  [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.3/common/001_openssh.patch)

  * **002: SECURITY FIX: April 3, 2008**
      *All architectures*

    Avoid possible hijacking of X11-forwarded connections with sshd(8)
    by refusing to listen on a port unless all address families bind
    successfully.

    [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.3/common/002_openssh2.patch)

    * **003: SECURITY FIX: July 15, 2008**
        *All architectures*

      Multiple vulnerabilities have been discovered in X.Org.

      RENDER Extension heap buffer overflow,
      RENDER Extension crash,
      RENDER Extension memory corruption,
      MIT-SHM arbitrary memory read,
      RECORD and Security extensions memory corruption.
      [CVE-2008-2360](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2360),
      [CVE-2008-2361](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2361),
      [CVE-2008-2362](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2362),
      [CVE-2008-1379](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1379),
      [CVE-2008-1377](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1377).

      [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.3/common/003_xorg.patch)

      * **004: SECURITY FIX: July 23, 2008**
          *All architectures*

        **2nd revision, July 23, 2008**

        A vulnerability has been found with BIND. An attacker could use this vulnerability
        to poison the cache of a recursive resolving name server.
        [CVE-2008-1447](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1447).

        [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.3/common/004_bind.patch)

        * **005: RELIABILITY FIX: July 29, 2008**
            *All architectures*

          Some kinds of IPv6 usage would leak kernel memory (in particular, this path
          was exercised by the named(8) patch for port randomization). Since INET6 is
          enabled by default, this condition affects all systems.

          [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.3/common/005_pcb.patch)

          * **006: SECURITY FIX: October 2, 2008**
              *All architectures*

            The Neighbor Discovery Protocol (ndp) did not correctly verify neighbor
            solicitation requests maybe allowing a nearby attacker to intercept traffic.
            The attacker must have IPv6 connectivity to the same router as their target for
            this vulnerability to be exploited.
            [CVE-2008-2476](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2476).

            [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.3/common/006_ndp.patch)

            * **007: SECURITY FIX: January 9, 2009**
                *All architectures*

              The OpenSSL libraries did not correctly check the return value from
              certain verification functions, allowing validation to be bypassed and
              permitting a remote attacker to conduct a "man in the middle attack"
              against SSL/TLS connections if the server is configured with a DSA or ECDSA
              certificate.
              [CVE-2008-5077](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5077).

              [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.3/common/007_openssl.patch)

              * **008: SECURITY FIX: January 14, 2009**
                  *All architectures*

                named(8) did not correctly check the return value of a DSA verification
                function, potentially allowing bypass of verification of DNSSEC DSA
                signatures.
                [CVE-2009-0025](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0025).

                [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.3/common/008_bind.patch)

                * **009: RELIABILITY FIX: January 30, 2009**
                    *All architectures*

                  Upon reception of an invalid update with 4-byte AS attributes, bgpd -
                  adhering to the RFCs - closed the session to the neighbor.
                  This error in the specification allowed 3rd parties to close remote BGP
                  sessions.
                  In the worst case Internet connectivity could be lost.

                  [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.3/common/009_bgpd.patch)

                  * **010: RELIABILITY FIX: February 18, 2009**
                      *All architectures*

                    bgpd(8) did not correctly prepend its own AS to very long AS paths, causing
                    the process to terminate because of the resulting corrupt path.

                    [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.3/common/010_bgpd.patch)

                    * **011: SECURITY FIX: February 22, 2009**
                        *All architectures*

                      sudo(8) may allow a user listed in the sudoers file to run a command
                      as a different user than their access rule specifies when a Unix
                      group is used in the RunAs portion of the rule. The bug only manifests
                      when the user being granted privileges is also a member of the group
                      in the RunAs portion of the rule.

                      [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.3/common/011_sudo.patch)

                      * **012: RELIABILITY FIX: April 8, 2009**
                          *All architectures*

                        The OpenSSL ASN.1 handling code could be forced to perform invalid memory
                        accesses through the use of certain invalid strings
                        ([CVE-2009-0590](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0590))
                        or under certain error conditions triggerable by invalid ASN.1 structures
                        ([CVE-2009-0789](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0789)).
                        These vulnerabilities could be exploited to achieve a
                        denial-of-service. A more detailed description of these problems is available
                        in the
                        [OpenSSL security advisory](http://www.openssl.org/news/secadv_20090325.txt), but note that the other issue described there "Incorrect Error
                        Checking During CMS verification" relates to code not enabled in OpenBSD.

                        [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.3/common/012_openssl.patch)

                        * **013: RELIABILITY FIX: April 11, 2009**
                            *All architectures*

                          When pf attempts to perform translation on a specially crafted IP datagram,
                          a null pointer dereference will occur, resulting in a kernel panic.
                          In certain configurations this may be triggered by a remote attacker.

                          Restricting translation rules to protocols that are specific to the IP version
                          in use, is an effective workaround until the patch can be installed. As an
                          example, for IPv4 nat/binat/rdr rules you can use:
                          ```

                              nat/rdr ... inet proto { tcp udp icmp } ...

                          ```
                          Or for IPv6 nat/binat/rdr rules you can use:
                          ```

                              nat/rdr ... inet6 proto { tcp udp icmp6 } ...

                          ```
                          [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/4.3/common/013_pf.patch)

---

1



=== Content from www.helith.net_85e13e71_20250124_140819.html ===
 \_ \_ \_\_\_\_\_ \_ \_\_\_ \_\_\_\_\_ \_ \_
/ / / / \_\_\_\_/ / / \_/\_ \_\_/ / / /
/ /\_/ / \_\_/ / / / / / / / /\_/ /
/ \_\_ / /\_\_\_/ /\_\_\_\_/ / / / / \_\_ /
/\_/ /\_/\_\_\_\_\_/\_\_\_\_\_/\_\_\_/ /\_/ /\_/ /\_/
Helith - 0815
--------------------------------------------------------------------------------
Author : Rembrandt
Date : 2009-04-30
Found : 2009-04-09
Affected Software: PF (OpenBSD Packet Filter)
Affected OS : OpenBSD 4.2 up to 4.5 and HEAD branch up to 2009-04-11
NetBSD 5.x up to RC3 and HEAD branch up to 2009-04-13
MirOS #10 and earlier
MidnightBSD 0.3-current
Not affected OS : FreeBSD
NetBSD 3.x, 4.x, 5.x (patched before release)
DragonflyBSD
Debian GNU/kFreeBSD
MidnightBSD prior 0.3
Older versions of OpenBSD PF and products based
thereon might be affected as well.
The Bug was introduced between the OpenBSD 4.1 and 4.2
release.
Type : Denial of Service
OSVDB : 53608
Milw0rm : 8406,8581
CVE : 2009-0687
ISS X-Force: : 49837
BID : 34482
Secunia : 34676
VUPEN ID : ADV-2009-1015
This advisory supercedes the original advisory which was just related to
OpenBSD because we had to publish an announcement in response to OpenBSD's
reaction.
Trying to fix it responsibly and get in contact with the vendor:
-- OpenBSD --
Contacted 2009-04-09 16:35 UTC
Patch available 2009-04-11 23:43 UTC
We received no response nor a notification about an upcoming patch.
Also we had no chance to coordinate or inform other projects before OpenBSD
issued the patch and a statement.
We like to mention that the issued patch is just a workaround and does not
patch or remove the affected code.
-- NetBSD --
Contacted and asked for confirmation 2009-04-15 06:00 UTC
Were informed about further investigations 2009-04-15 9:42 UTC
Received information about upcoming Patches 2009-04-15 11:57 UTC
Received confirmation for 5.x up to RC3 and HEAD 2009-04-15 12:17 UTC
We thank the NetBSD team that they patched the PF bug prior the 5.x release!
-- FreeBSD --
Contacted and asked for confirmation 2009-04-15 06:56 UTC
Were informed about further investigations 2009-04-15 7:56 UTC
Were informed about not being vulnerable 2009-04-15 22:05 UTC
-- DragonflyBSD --
Contacted and asked for confirmation 2009-04-15 06:10 UTC
Were informed about not being vulnerable 2009-04-15 21:35 UTC
-- MirOS (MirBSD) --
Contacted and asked for official confirmation 2009-04-15 06:36 UTC
Received confirmation for MirBSD 10 and prior 2009-04-15 17:57 UTC
-- MidnightBSD --
Contacted and asked for official confirmation 2009-04-15 20:17 UTC
Received confirmation for MidnightBSD 2009-04-15 22:37 UTC
-- Debian GNU/kFreeBSD --
Contacted and asked for official confirmation 2009-04-15 22:41 UTC
Were informed about not being vulnerable 2009-04-15 23:35 UTC
-- END --
OpenBSDs PF firewall is prone to a remote Denial of Service due to a NULL-
pointer dereference when handling special crafted IP datagrams. If the
firewall handles such a packet the kernel panics.
An example for such a packet would be a IPv4 packet with a ICMPv6 payload.
This affects multiple vendors because PF was incorporated into serveral OS.
The problem stems from the unification of the rule processing in pf\_test\_rule().
With this unification ICMPv6 logic was applied to IPv4 packets and vice versa.
Because the handling logic asserts that the common code in pf\_test has verified
that the packet contains a full ICMP header and has pulled up the mbuf up to
that point. This assertion fails when the wrong AF-version is used by pf\_test
and thus pf\_test\_rule tries to access not allocated memory.
The affected function is in pf\_change\_a6 and the patch is just a workaround
because it filters the packet in pf\_test() except of fixing the affected source
code.
Steps to reproduce:
If you have an affected OS in your network which does NAT or redirecting traffic
you should be able to test your IPv4 device with this simple hping command:
hping -0 -H 58 $a\_host
Patches are provided for:
OpenBSD 4.3 - 4.5 (not for 4.2), HEAD after 2009-04-11
NetBSD 4.x (patched for consistency) - 5.0RC3, HEAD after 2009-04-13
MirBSD 10
MidnightBSD 0.3-current
Workaround:
The OpenBSD developers provide hints for a workaround at their errata
website too.
We like to thank the security teams of the following projects for
their friendly cooperation:
DragonflyBSD
NetBSD
FreeBSD
MidnightBSD
MirBSD
Special thanks goes to Andreas Bogk who assisted in the assembly analysis and
Adrian Portelli of the NetBSD project for his time and permanent suggestions.
Kind regards,
Rembrandt


=== Content from www.exploit-db.com_38b374d4_20250124_140821.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# OpenBSD 4.5 - IP datagrams Remote Denial of Service

#### EDB-ID:

###### 8406

#### CVE:

###### [2009-0687](https://nvd.nist.gov/vuln/detail/CVE-2009-0687)

---

**EDB Verified:**

#### Author:

###### [Rembrandt](/?author=979)

#### Type:

###### [dos](/?type=dos)

---

#### Platform:

###### [OpenBSD](/?platform=openbsd)

#### Date:

###### 2009-04-13

---

**Vulnerable App:**

```
                     _   _ _____ _     ___ _____ _   _
                   / / / / ____/ /   /  _/_  __/ / / /
                  / /_/ / __/ / /    / /  / / / /_/ /
                 / __  / /___/ /____/ /  / / / __  /
                /_/ /_/_____/_____/___/ /_/ /_/ /_/
                           Helith - 0815
--------------------------------------------------------------------------------

Author		 : Rembrandt
Date		 : 2009-04-09
Affected Software: OpenBSD Kernel
Affected OS	 : OpenBSD 4.{3,4,5}, OpenBSD-current
		   Propably older versions are affected as well
Type		 : Denial of Service

OSVDB		 :
Milw0rm		 :
CVE		 :
ISS X-Force:	 :
BID		 :
Secunia		 : 34676
VUPEN ID	 :

Trying to fix it responsible and get in contact with the vendor:

-- OpenBSD --
Contacted 		2009-04-09 15:35 GMT+1
Patch avaiable		2009-04-11 23:43 UTC

We received no response nor a notification about an upcoming patch by
the developers.
-- END --

OpenBSDs PF firewall in OpenBSD 4.3 up to OpenBSD-current is prone to a
remote Denial of Service during a null pointer dereference in relation with
special crafted IP datagrams. If the firewall handles such a packet the kernel
panics.

Steps to reproduce:

If you are behind a OpenBSD firewall this nmap scan should trigger the problem
and crash your firewall device:

nmap -sO $some_host_so_that_the_firewall_handles_the_packets

For more informations please do read the patch issued by OpenBSD.

Patches and Workaround:

Patches are provided for OpenBSD 4.3, 4.4, 4.5 (upcoming, release 1st of may)
and OpenBSD-current (via CVS only) and are avaiable at the errata website.
The developers provide hints for a workaround at their errata website too.

Kind regards,
Rembrandt

# milw0rm.com [2009-04-13]

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from www.exploit-db.com_e7ac1680_20250124_140822.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Multiple Vendor - PF Null Pointer Dereference

#### EDB-ID:

###### 8581

#### CVE:

###### [2009-0687](https://nvd.nist.gov/vuln/detail/CVE-2009-0687)

---

**EDB Verified:**

#### Author:

###### [Rembrandt](/?author=979)

#### Type:

###### [dos](/?type=dos)

---

#### Platform:

###### [BSD](/?platform=bsd)

#### Date:

###### 2009-04-30

---

**Vulnerable App:**

```
                     _   _ _____ _     ___ _____ _   _
                   / / / / ____/ /   /  _/_  __/ / / /
                  / /_/ / __/ / /    / /  / / / /_/ /
                 / __  / /___/ /____/ /  / / / __  /
                /_/ /_/_____/_____/___/ /_/ /_/ /_/
                           Helith - 0815
--------------------------------------------------------------------------------

Author		 : Rembrandt
Date		 : 2009-04-30
Found		 : 2009-04-09
Affected Software: PF (OpenBSD Packet Filter)
Affected OS	 : OpenBSD 4.2 up to 4.5 and HEAD branch up to 2009-04-11
		   NetBSD 5.x up to RC3 and HEAD branch up to 2009-04-13
		   MirOS #10 and earlier
		   MidnightBSD 0.3-current
Not affected OS  : FreeBSD
		   NetBSD 3.x, 4.x, 5.x (patched before release)
		   DragonflyBSD
 		   Debian GNU/kFreeBSD
		   MidnightBSD prior 0.3

		   Older versions of OpenBSD PF and products based
                   thereon might be affected as well.
		   The Bug was introduced between the OpenBSD 4.1 and 4.2
		   release.

Type		 : Denial of Service

OSVDB		 : 53608
Milw0rm		 : 8406
CVE		 :
ISS X-Force:	 :
BID		 : 34482
Secunia		 : 34676
VUPEN ID	 : ADV-2009-1015

This advisory supercedes the original advisory which was just related to
OpenBSD because we had to publish an announcement in response to OpenBSD's
reaction.

Trying to fix it responsibly and get in contact with the vendor:

-- OpenBSD --
Contacted 						2009-04-09 16:35 UTC
Patch available						2009-04-11 23:43 UTC

We received no response nor a notification about an upcoming patch.
Also we had no chance to coordinate or inform other projects before OpenBSD
issued the patch and a statement.

We like to mention that the issued patch is just a workaround and does not
patch or remove the affected code.

-- NetBSD --
Contacted and asked for confirmation			2009-04-15 06:00 UTC
Were informed about further investigations		2009-04-15 9:42  UTC
Received information about upcoming Patches 		2009-04-15 11:57 UTC
Received confirmation for 5.x up to RC3 and HEAD	2009-04-15 12:17 UTC

We thank the NetBSD team that they patched the PF bug prior the 5.x release!

-- FreeBSD --
Contacted and asked for confirmation			2009-04-15 06:56 UTC
Were informed about further investigations		2009-04-15 7:56 UTC
Were informed about not being vulnerable		2009-04-15 22:05 UTC

-- DragonflyBSD --
Contacted and asked for confirmation			2009-04-15 06:10 UTC
Were informed about not being vulnerable		2009-04-15 21:35 UTC

-- MirOS (MirBSD) --
Contacted and asked for official confirmation		2009-04-15 06:36 UTC
Received confirmation for MirBSD 10 and prior		2009-04-15 17:57 UTC

-- MidnightBSD --
Contacted and asked for official confirmation		2009-04-15 20:17 UTC
Received confirmation for MidnightBSD			2009-04-15 22:37 UTC

-- Debian GNU/kFreeBSD --
Contacted and asked for official confirmation		2009-04-15 22:41 UTC
Were informed about not being vulnerable		2009-04-15 23:35 UTC
-- END --

OpenBSDs PF firewall is prone to a remote Denial of Service due to a NULL-
pointer dereference when handling special crafted IP datagrams. If the
firewall handles such a packet the kernel panics.
An example for such a packet would be a IPv4 packet with a ICMPv6 payload.

This affects multiple vendors because PF was incorporated into serveral OS.

The problem stems from the unification of the rule processing in pf_test_rule().
With this unification  ICMPv6 logic was applied to IPv4 packets and vice versa.
Because the handling logic asserts that the common code in pf_test has verified
that the packet contains a full ICMP header and has pulled up the mbuf up to
that point. This assertion fails when the wrong AF-version is used by pf_test
and thus pf_test_rule tries to access not allocated memory.
The affected function is in pf_change_a6 and the patch is just a workaround
because it filters the packet in pf_test() except of fixing the affected source
code.

Steps to reproduce:

If you have an affected OS in your network which does NAT or redirecting traffic
you should be able to test your IPv4 device with this simple hping command:

hping -0 -H 58 $a_host

Patches are provided for:

OpenBSD 4.3 - 4.5 (not for 4.2), HEAD after 2009-04-11
NetBSD  4.x (patched for consistency) - 5.0RC3, HEAD after 2009-04-13
MirBSD 10
MidnightBSD 0.3-current

Workaround:

The OpenBSD developers provide hints for a workaround at their errata
website too.

We like to thank the security teams of the following projects for
their friendly cooperation:

DragonflyBSD
NetBSD
FreeBSD
MidnightBSD
MirBSD

Special thanks goes to Andreas Bogk who assisted in the assembly analysis and
Adrian Portelli of the NetBSD project for his time and permanent suggestions.

Kind regards,
Rembrandt

# milw0rm.com [2009-04-30]

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search


