```
{
  "cveId": "CVE-2009-0687",
  "vulnerability": {
    "rootCause": "The vulnerability is due to incorrect handling of ICMP and ICMPv6 packets in the pf_test_rule() function.",
    "weaknesses": [
      "The code incorrectly applies ICMPv6 logic to IPv4 packets and vice versa.",
      "The pf_test_rule() function assumes that the common code in pf_test has verified the presence of a full ICMP header and has pulled up the mbuf, but this assertion fails when the wrong AF-version is used by pf_test."
    ],
    "impact": "A remote attacker can cause a kernel panic, leading to a denial-of-service (DoS).",
    "attackVectors": [
      "Sending a specially crafted IP datagram.",
      "An example for such a packet would be a IPv4 packet with a ICMPv6 payload."
    ],
    "requiredCapabilities": "The attacker needs to send a crafted packet, possibly using tools like hping or nmap."
  },
  "affectedSystems": [
     "OpenBSD 4.2 up to 4.5 and HEAD branch up to 2009-04-11",
    "NetBSD 5.x up to RC3 and HEAD branch up to 2009-04-13",
    "MirOS #10 and earlier",
    "MidnightBSD 0.3-current"
    ],
    "patches": [
      "Patches are provided for OpenBSD 4.3 - 4.5 (not for 4.2), HEAD after 2009-04-11",
      "NetBSD 4.x (patched for consistency) - 5.0RC3, HEAD after 2009-04-13"
    ],
    "workarounds": [
      "Restricting translation rules to protocols that are specific to the IP version in use (e.g., 'nat/rdr ... inet proto { tcp udp icmp } ...' for IPv4 and 'nat/rdr ... inet6 proto { tcp udp icmp6 } ...' for IPv6)."
    ],
  "additionalNotes": [
    "The affected function is in pf_change_a6.",
    "The patch provided is just a workaround that filters the packet in pf_test(), instead of fixing the affected source code."
    ]
}
```