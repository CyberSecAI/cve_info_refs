```
{
  "cve_id": "CVE-2009-0227",
  "raw_data": "A remote code execution vulnerability exists in the way that Microsoft Office PowerPoint handles specially crafted PowerPoint files. An attacker could exploit the vulnerability by creating a specially crafted PowerPoint file that could be included as an e-mail attachment, or hosted on a specially crafted or compromised Web site.\n\nTo view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2009-0227](https://www.cve.org/CVERecord?id=CVE-2009-0227).\n\n#### Mitigating Factors for Legacy File Format Vulnerability - CVE-2009-0227\n\nMitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation:\n\n*   Microsoft Office 2003 Service Pack 3 blocks the opening and saving of certain files by default upon installation. For Microsoft Office PowerPoint 2003 Service Pack 3, these are files that are older than PowerPoint 97 and that have file types such as .ppt, .pot, .pps, and .ppa. Notice that this feature does not apply to Microsoft Office PowerPoint 97 files. For more information, see [Microsoft Knowledge Base Article 938810](https://support.microsoft.com/kb/938810).\n*   Users who have installed and are using the [Office Document Open Confirmation Tool](https://www.microsoft.com/download/details.aspx?familyid=8b5762d2-077f-4031-9ee6-c9538e9f2a2f) for Office 2000 will be prompted with Open, Save, or Cancel before opening a document. The features of the Office Document Open Confirmation Tool are incorporated in Office XP and later editions of Office.\n*   The vulnerability cannot be exploited automatically through e-mail. For an attack to be successful a user must open an attachment that is sent in an e-mail message.\n*   In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site.\n*   An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.\n*   This vulnerability does not affect PowerPoint 2007, PowerPoint Viewer 2003, and PowerPoint Viewer 2007.\n\n#### Workarounds for Legacy File Format Vulnerability - CVE-2009-0227\n\nWorkaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality:\n\n*   **Restrict access to pp4x322.dll in Microsoft Office PowerPoint 2000 or Microsoft Office PowerPoint 2002**\n\n    **Note** You will need administrator privileges to set these file restrictions.\n\n    +   On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:\n\n        for /F \"tokens=*\" %G IN ('dir /b /s ^\"%programfiles%\\Microsoft Office\\pp4x322.dll^\"') DO cacls \"%G\" /E /P everyone:N\n    +   On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:\n\n        for /F \"tokens=*\" %G IN ('dir /b /s ^\"%programfiles(x86)%\\Microsoft Office\\pp4x322.dll^\"') DO cacls \"%G\" /E /P everyone:N\n    +   On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:\n\n        for /F \"tokens=*\" %G IN ('dir /b /s ^\"%programfiles%\\Microsoft Office\\pp4x322.dll^\"') DO cacls \"%G\" /E /P everyone:N\n    +   On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:\n\n        for /F \"tokens=*\" %G IN ('dir /b /s ^\"%programfiles(x86)%\\Microsoft Office\\pp4x322.dll^\"') DO cacls \"%G\" /E /P everyone:N\n\n    **Impact of Workaround.**\u00a0You will not be able to open PowerPoint 4.0 files.\n\n    **How to Undo the Workaround:**\n\n    +   On 32-bit editions of Microsoft Windows 2000, Windows XP and Windows Server 2003, run the following command from a command prompt:\n\n        for /F \"tokens=*\" %G IN ('dir /b /s ^\"%programfiles%\\Microsoft Office\\pp4x322.dll^\"') DO cacls \"%G\" /E /R everyone\n    +   On 64-bit editions of Windows XP and Windows Server 2003, run the following command from a command prompt:\n\n        for /F \"tokens=*\" %G IN ('dir /b /s ^\"%programfiles(x86)%\\Microsoft Office\\pp4x322.dll^\"') DO cacls \"%G\" /E /R everyone\n    +   On 32-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:\n\n        for /F \"tokens=*\" %G IN ('dir /b /s ^\"%programfiles%\\Microsoft Office\\pp4x322.dll^\"') DO cacls \"%G\" /E /R everyone\n    +   On 64-bit editions of Windows Vista and Windows Server 2008, run the following command from an elevated command prompt:\n\n        for /F \"tokens=*\" %G IN ('dir /b /s ^\"%programfiles(x86)%\\Microsoft Office\\pp4x322.dll^\"') DO cacls \"%G\" /E /R everyone\n\n#### FAQ for Legacy File Format Vulnerability - CVE-2009-0227\n\n**What is the scope of the vulnerability?**\n\nThis is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights.\n\n**What causes the vulnerability?**\n\nWhen PowerPoint reads sound data from specially crafted PowerPoint 4.0 files, an error may corrupt memory in such a way that an attacker could execute arbitrary code.\n\n**What might an attacker use the vulnerability to do?**\n\nAn attacker who successfully exploited this vulnerability could take complete control of an affected system in the context of the current logged-on user. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.\n\n**How could an attacker exploit the vulnerability?**\n\nThis vulnerability requires that a user open a specially crafted PowerPoint 4.0 file with an affected version of Microsoft Office PowerPoint.\n\nIn a Web-based attack scenario, a Web site could contain a PowerPoint file that is used to exploit this vulnerability. An attacker would have to convince users to visit the Web site and open a specially crafted PowerPoint file, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site, and then convincing them to open the specially crafted PowerPoint file.\n\nIn an e-mail attack scenario, an attacker could exploit the vulnerability by sending a specially-crafted PowerPoint file to the user and convincing the user to open the file.\n\n**What systems are primarily at risk from the vulnerability?**\n\nSystems where an affected version of Microsoft Office PowerPoint is used, such as workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this.\n\n**What does the update do?**\n\nThis update prevents Microsoft Office PowerPoint 2000 and Microsoft Office PowerPoint 2002 from opening PowerPoint 4.0 native file formats.\n\n**When this security bulletin was issued, had this vulnerability been publicly disclosed?**\n\nNo. Microsoft received information about this vulnerability through responsible disclosure.\n\n**When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?**\n\nNo. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers and had not seen any examples of proof of concept code published when this security bulletin was originally issued.",
  "summary": "A remote code execution vulnerability exists in Microsoft PowerPoint due to how it handles specially crafted PowerPoint files, specifically when reading sound data from PowerPoint 4.0 files. An attacker can exploit this vulnerability by convincing a user to open a malicious PowerPoint file, potentially leading to arbitrary code execution.",
  "vulnerability_details": {
    "root_cause": "The vulnerability is caused by an error that occurs when Microsoft PowerPoint reads sound data from specially crafted PowerPoint 4.0 files, which leads to memory corruption.",
    "weaknesses": [
      "Memory corruption",
      "Improper handling of file formats",
      "Remote code execution vulnerability"
    ],
    "impact": "Successful exploitation of this vulnerability could allow a remote attacker to gain complete control of the affected system, enabling them to install programs, view/change/delete data, or create new accounts with full user rights.",
    "attack_vector": "The attack vector involves a user opening a specially crafted PowerPoint 4.0 file, either delivered as an email attachment or hosted on a malicious website.",
    "attacker_capabilities": "The attacker must be able to create a malicious PowerPoint 4.0 file and convince the user to open the file, either through social engineering or by hosting it on a website they control."
  },
  "affected_software": [
    "Microsoft Office PowerPoint 2000",
    "Microsoft Office PowerPoint 2002",
  ],
   "additional_information": {
        "mitigations": [
            "Microsoft Office 2003 SP3 blocks opening of older files by default",
            "Office Document Open Confirmation Tool will prompt the user before opening a document",
            "Vulnerability cannot be automatically exploited through email",
            "Web-based attack requires user to visit attacker's website and open the malicious file"
         ],
        "workarounds": [
          "Restrict access to `pp4x322.dll` which disables opening PowerPoint 4.0 files",
         ],
          "other_notes": "This vulnerability is addressed by preventing Microsoft Office PowerPoint 2000 and 2002 from opening PowerPoint 4.0 native file formats."
      }
}
```