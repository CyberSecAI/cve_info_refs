- **Root cause of vulnerability:** Integer overflow leading to out-of-bounds read/write
- **Weaknesses/vulnerabilities present:**
    - The code calculates the y coordinate of a macroblock by dividing `bound` by `mb_width`. If `bound` is large enough, this calculation could result in a `y` value that exceeds the bounds of the `dec->mbs` array in the subsequent access: `mb = &dec->mbs[y * dec->mb_width + x];`. This is because the original calculation `y = bound / mb_width` was not checked against the `mb_height`.
    -  The vulnerability appears in the `decoder_iframe`, `decoder_pframe` and `decoder_bframe` functions.
- **Impact of exploitation:** An attacker could cause an out-of-bounds read or write access to memory, which could lead to a crash, denial-of-service, or potentially arbitrary code execution.
- **Attack vectors:**
    - By providing a specially crafted video stream where the value of `bound` in the video packet header is maliciously crafted to cause a large `y` value after division with `mb_width`.
- **Required attacker capabilities/position:**
    - Attacker needs to provide a malicious encoded video file or stream.
- **Additional notes:**
    - The fix introduces a check to ensure that the calculated `y` value does not exceed the `mb_height` by using the `MIN` macro to set `y = MIN((bound / mb_width), (mb_height-1));`