=== Content from samizdat.nongnu.org_56c37e60_20250125_002214.html ===
Fixes cross-site scripting vulnerability caused by several cases of unescaped
message title and member full name leaking to HTML output.
diff -urN samizdat-0.6.1-orig/lib/samizdat/components/resource.rb samizdat-0.6.1-xss/lib/samizdat/components/resource.rb
--- samizdat-0.6.1-orig/lib/samizdat/components/resource.rb 2008-02-25 16:25:09.000000000 +0200
+++ samizdat-0.6.1-xss/lib/samizdat/components/resource.rb 2009-02-02 15:57:37.000000000 +0200
@@ -129,13 +129,13 @@
# resource title (HTML-escaped)
#
def title
- CGI.escapeHTML(limit\_string(@title.to\_s))
+ escape\_title(@title.to\_s)
end
# render resource as a list item
#
def list\_item
- resource(@id, @title, info)
+ resource(@id, title, info)
end
# short rendering of the resource
@@ -242,7 +242,7 @@
def list\_item
if @message.nrelated > 0
- resource(@id, Focus.focus\_title(@title), info)
+ resource(@id, Focus.focus\_title(title), info)
else
super
end
@@ -325,7 +325,7 @@
body << '

' <<
sprintf(
\_('Account blocked by moderator: %s.'),
- resource\_href(blocked\_by, CGI.escapeHTML(b\_name))
+ resource\_href(blocked\_by, escape\_title(b\_name))
) << '

'
end
end
@@ -413,7 +413,7 @@
(s::fullName ?member ?name)
(s::voteRating #{@id} ?rating)}
@info = sprintf(\_('[%s](%25s) gave rating %4.2f to the [Statement %s](%25s) on %s.'),
- @member, name, rating, @stmt, @stmt, format\_date(date).to\_s)
+ @member, escape\_title(name), rating, @stmt, @stmt, format\_date(date).to\_s)
@links['made'] = @member
end
diff -urN samizdat-0.6.1-orig/lib/samizdat/controllers/message\_controller.rb samizdat-0.6.1-xss/lib/samizdat/controllers/message\_controller.rb
--- samizdat-0.6.1-orig/lib/samizdat/controllers/message\_controller.rb 2008-02-25 13:49:18.000000000 +0200
+++ samizdat-0.6.1-xss/lib/samizdat/controllers/message\_controller.rb 2009-02-02 15:58:50.000000000 +0200
@@ -19,7 +19,7 @@
def source
@message = Message.cached(@id)
- @title = @message.content.title
+ @title = escape\_title(@message.content.title)
@content\_for\_layout = box(@title,
form(nil,
[:label, 'content', \_('Content')],
@@ -438,7 +438,7 @@
@title = \_('Message Preview')
@content\_for\_layout = box(
- @message.content.title,
+ escape\_title(@message.content.title),
message(@message, :full) <<
cut\_warning.to\_s <<
'

' << \_("Press 'Back' button to change the message.") << '

' <<
diff -urN samizdat-0.6.1-orig/lib/samizdat/controllers/resource\_controller.rb samizdat-0.6.1-xss/lib/samizdat/controllers/resource\_controller.rb
--- samizdat-0.6.1-orig/lib/samizdat/controllers/resource\_controller.rb 2008-02-23 00:38:10.000000000 +0200
+++ samizdat-0.6.1-xss/lib/samizdat/controllers/resource\_controller.rb 2009-02-02 15:59:34.000000000 +0200
@@ -16,7 +16,8 @@
# special case: force untranslated title to go with full rendering of a message
@title = ('Message' == @resource.type) ?
- Message.cached(@id).content.title : @resource.title
+ escape\_title(Message.cached(@id).content.title) :
+ @resource.title
@links.update(@resource.links)
end
diff -urN samizdat-0.6.1-orig/lib/samizdat/engine/helpers.rb samizdat-0.6.1-xss/lib/samizdat/engine/helpers.rb
--- samizdat-0.6.1-orig/lib/samizdat/engine/helpers.rb 2008-02-14 20:05:29.000000000 +0200
+++ samizdat-0.6.1-xss/lib/samizdat/engine/helpers.rb 2009-02-02 16:01:23.000000000 +0200
@@ -101,6 +101,12 @@
end
end
+# truncate \_string\_ to the title limit and escape HTML characters in it
+#
+def escape\_title(string)
+ CGI.escapeHTML(limit\_string(string))
+end
+
# transform date to a standard string representation
#
def format\_date(date)
diff -urN samizdat-0.6.1-orig/lib/samizdat/engine.rb samizdat-0.6.1-xss/lib/samizdat/engine.rb
--- samizdat-0.6.1-orig/lib/samizdat/engine.rb 2008-03-04 15:30:17.000000000 +0200
+++ samizdat-0.6.1-xss/lib/samizdat/engine.rb 2009-02-02 16:00:36.000000000 +0200
@@ -38,7 +38,7 @@
# fix bug in standard cgi.rb
def CGI::escapeHTML(string)
- string.gsub(/&/n, '&').gsub(/\"/n, '"').gsub(/\'/n, ''').gsub(/>/n, '>').gsub(//n, '>').gsub(/#{message.creator.full\_name}}
+ \_('guest') :
+ %{[#{escape\_title(message.creator.full\_name)}](#{message.creator.id})}
date = format\_date(message.date)
if :full == mode


=== Content from www.mail-archive.com_8d63eec3_20250125_002215.html ===


[Skip to site navigation (Press enter)](#nav)

# [Security update for Debian Testing - 2009-02-12](/search?l=debian-testing-security-announce@lists.debian.org&q=subject:%22Security+update+for+Debian+Testing+%5C-+2009%5C-02%5C-12%22&o=newest)

[secure-testing-team](/search?l=debian-testing-security-announce@lists.debian.org&q=from:%22secure%5C-testing%5C-team%22)
[Wed, 11 Feb 2009 17:05:19 -0800](/search?l=debian-testing-security-announce@lists.debian.org&q=date:20090211)

```
This automatic mail gives an overview over security issues that were recently
fixed in Debian Testing. The majority of fixed packages migrate to testing
from unstable. If this would take too long, fixed packages are uploaded to the
testing-security repository instead. It can also happen that vulnerable
packages are removed from Debian testing.
```
```

DTSA:
=====
The following issues have been fixed by uploads to testing-security:

samizdat 0.6.1-3lenny1:
DTSA-194-1    : samizdat - cross-site scripting
CVE-2009-0359: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0359>

Migrated from unstable or testing-proposed-updates:
===================================================
squid3 3.0.STABLE8-3:
CVE-2009-0478: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0478>

sun-java5 1.5.0-17-0.1 (non-free):
CVE-2008-5339: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5339>
               <http://bugs.debian.org/508194>
CVE-2008-5340: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5340>
CVE-2008-5341: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5341>
CVE-2008-5342: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5342>
CVE-2008-5343: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5343>
CVE-2008-5344: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5344>
CVE-2008-5345: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5345>
CVE-2008-5346: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5346>
CVE-2008-5347: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5347>
CVE-2008-5348: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5348>
CVE-2008-5349: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5349>
CVE-2008-5350: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5350>
CVE-2008-5351: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5351>
CVE-2008-5352: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5352>
CVE-2008-5353: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5353>
CVE-2008-5354: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5354>
CVE-2008-5356: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5356>
CVE-2008-5357: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5357>
CVE-2008-5358: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5358>
CVE-2008-5359: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5359>
CVE-2008-5360: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-5360>

How to update:
--------------
Make sure the line

        deb <http://security.debian.org> lenny/updates main contrib non-free

is present in your /etc/apt/sources.list. Of course, you also need the line
pointing to your normal lenny mirror. You can use

        aptitude update && aptitude dist-upgrade

to install the updates.

More information:
-----------------
More information about which security issues affect Debian can be found in the
security tracker:

        <http://security-tracker.debian.net/tracker/>

A list of all known unfixed security issues is at

        <http://security-tracker.debian.net/tracker/status/release/testing>

--
To UNSUBSCRIBE, email to
debian-testing-security-announce-requ...@lists.debian.org
with a subject of "unsubscribe". Trouble? Contact listmas...@lists.debian.org

```

* [Previous message](msg00170.html)
* [View by thread](index.html#00171)
* [View by date](maillist.html#00171)
* [Next message](msg00172.html)

## Reply via email to

[![The Mail Archive](/logo.png)](/)

Search the site

* [The Mail Archive home](/)
* [debian-testing-security-announce - all messages](/debian-testing-security-announce%40lists.debian.org/)
* [debian-testing-security-announce - about the list](/debian-testing-security-announce%40lists.debian.org/info.html)
* [Expand](/search?l=debian-testing-security-announce@lists.debian.org&q=subject:%22Security+update+for+Debian+Testing+%5C-+2009%5C-02%5C-12%22&o=newest&f=1 "e")
* [Previous message](msg00170.html "p")
* [Next message](msg00172.html "n")

* [The Mail Archive home](/)
* [Add your mailing list](/faq.html#newlist)
* [FAQ](/faq.html)
* [Support](/faq.html#support)
* [Privacy](/faq.html#privacy)
* E1LXQ0h-0006wH-Gj@eru.sfritsch.de



=== Content from www.nongnu.org_619f5463_20250125_002216.html ===

# Samizdat: Co-op Engine

## [Home](../index.html) | [About](../about.html) | [Documentation](../documentation.html) | [Developers](../developers.html) | [Download](../download.html)

## Dedication

Samizdat 0.6.2 release is dedicated to the memory of Stanislav Markelov and
Anastasia Baburova, activists murdered in Moscow on January 19, 2009.

## Samidat 0.6.2 (2009-02-12)

The most important part of this release is the long list of security
improvements in various parts of Samizdat engine. Password encryption is now as
strong as it gets, HTTPS now gets the emphasis it deserves, cross-site scripting
protection has been tightened, and in general the engine is even more paranoid
about user-submitted data than before.

End users will be most interested in the integration with Flowplayer free
Flash video player and the thumbnailing capabilities of the new image plugin.
Both features are enabled by the new plugin mechanism, which, in addition to
handling different content types, allows to add fancy member profile parameters
and alternative access control schemes.

Due to the number of security improvements in this release, it is highly
recommended that all Samizdat installations update to this version. If you are
not able to update your installation immediately, you should apply the following
patches (applicable to vanilla Samizdat 0.6.1) at the first opportunity:

* <samizdat-0.6.1-xss-escape-title.patch>
* <samizdat-0.6.1-tidy-binary.patch>

## Download

* [samizdat-0.6.2.tar.gz (273k)](http://savannah.nongnu.org/download/samizdat/samizdat-0.6.2.tar.gz)

## What's new

cross-site scripting fixes
several cases of unsanitized user-submitted HTML strings are fixed
in this release; these vulnerabilities allowed attackers to perform
cross-site scripting attacks by publishing specially crafted messages or
user names ([CVE-2009-0359](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2009-0359))
passwords
over the past several years, multiple attacks on the MD5 hash
function were demonstrated, making this algorithm less than optimal for
password encryption; while Samizdat 0.6.2 still supports old MD5
passwords, all new passwords will use salted SHA-512; users of Samizdat
sites are advised to update their passwords to take advantage of
stronger password encryption
HTTPS logins
it is now possible to ensure that all authenticated access to a
Samizdat site goes only over an encrypted HTTPS connection; comments in
the https section of config.yaml explain how to make this work
plugins
the new plugin system allows to augment and customize various parts
of Samizdat engine, including content rendering, member profile
parameters, and access control
image thumbnails
new image plugin automatically generates and uses reduced versions
of uploaded images with help of the [RMagick
library](http://rmagick.rubyforge.org/)
Flowplayer
flowplayer plugin integrates this [free
Flash video player](http://flowplayer.org/) into Samizdat pages, allowing to display FLV and
MP4/H.264 files inline in addition to the usual download link; as of
this release, Flowplayer doesn't reliably work with free Flash plugins
[Gnash](http://www.gnu.org/software/gnash/) and
[SWFdec](http://swfdec.freedesktop.org/), more collaboration
between these projects is needed to implement a fully free Flash video
stack
GPL3
Samizdat license has been upgraded to the [latest version of
GPL](http://www.gnu.org/licenses/gpl-3.0.html) and now reads: "You can distribute/modify this program under the
terms of the GNU General Public License version 3 or later."
Mahoro
instead of relying on inconsistent and untrustworthy content type
headers supplied by web browser, Samizdat now uses [Mahoro bindings](http://mahoro.rubyforge.org/) to libmagic
library to determine real content type of the uploaded files
Sanitize
due to incompatibility of Tidy/DL bindings with the latest Ruby 1.8
releases, Sanitize now prefers to invoke tidy binary through a pipe
instead of linking to a shared library; more Tidy errors are now handled
and reported back to the user, single quote special character is now
escaped as &#39; for compatibility with browsers that don't support
XHTML 1.0 character entities (e.g. Internet Explorer)
member profile
member settings page is split into account, profile, and settings
pages; settings page controls UI preferences available both to members
and guests; profile page allows to edit public information about a
member, such as full name (which is now optional) or occupation (enabled
by the occupation profile plugin); account parameters such as password
and email are edited on the account page
new translations
Japanese translation has been reviewed and corrected by a native
speaker and is now enabled by default, bringing the count of supported
languages up to 10
documentation
several key aspects of Samizdat architecture are explained in new
[Dia diagrams](../documentation.html#diagrams) and the
[LVEE'2008 presentation
slides](../slides/lvee2008_samizdat.html)
other
exported RSS feeds now include item descriptions, tainted data
handling is now more robust, more bugfixes and UI improvements
## How to upgrade

First of all, make sure tidy binary (and not just libtidy shared library) is
installed on your system. By default, sanitize.rb checks for /usr/bin/tidy or
/usr/local/bin/tidy. On Debian 5.0/lenny or later, run `apt-get install tidy`.
Debian 4.0/etch has an old Tidy version that doesn't support some of the options
used in Samizdat 0.6.2, so you may need to install the [backported Tidy package](http://people.debian.org/~angdraug/tidy/).

Update your database schema to allow NULL value in member full name (login is
now used as a substitute when full name is not set):

```

  ALTER TABLE Member ALTER COLUMN full_name DROP NOT NULL;

```

Since moderator list is now stored in database, you need to move your list of
moderators from your yaml config to the database:

```

  CREATE TABLE Role (member INTEGER REFERENCES Member, role TEXT);
  CREATE INDEX Role_member_idx ON Role (member);
  GRANT INSERT, UPDATE, SELECT ON Role TO samizdat;
  INSERT INTO Role (member, role) SELECT id, 'moderator' FROM Member
  WHERE login IN ('moderator1', 'moderator2', ...);

```

In the last line, replace ('moderator1', 'moderator2', ...) with your current
moderator list, that can be produced by the following command line:

```

  grep moderators /etc/samizdat/sites/*|sed "s/, /', '/g"

```

You will also need to update your Apache or Lighttpd configuration to
make js/ directory visible via the Web server (see [examples](http://cvs.savannah.gnu.org/viewvc/samizdat/doc/examples/?root=samizdat)).

Finally, if your access control configuration differs from Samizdat default
(e.g. guests are allowed to post), see [defaults.yaml](http://cvs.savannah.gnu.org/viewvc/%2Acheckout%2A/samizdat/data/samizdat/defaults.yaml?revision=1.21&root=samizdat) on how role
plugin is configured.


