=== Content from access.redhat.com_770be0f1_20250126_094742.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.openwall.com_3a37d02a_20250125_151245.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[thread-next>]](../../../2009/01/28/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <1232979990.3231.38.camel@dhcp-lab-164.englab.brq.redhat.com>
Date: Mon, 26 Jan 2009 15:26:30 +0100
From: Jan Lieskovsky <jlieskov@...hat.com>
To: "Steven M. Christey" <coley@...us.mitre.org>
Cc: oss-security@...ts.openwall.com
Subject: CVE request -- Python < 2.6 PySys_SetArgv issues (epiphany,
	csound, dia, eog, gedit, xchat, vim, nautilus-python, Gnumeric)

Hello Steve,

  initially CVE-2008-4863 has been assigned for the Blender's
untrusted search path issue.

Though this is a Python flaw (insertion of cwd at the
beginning of the Python modules search path), according to our Python
maintainers it can't be fixed on Python's side due the need
of ensuring the work of other numerous packages, when loading
Python modules.

Similar flaw, like the Blender one, has been discovered in
the following packages:

1, epiphany
References:
<http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=504363>
<https://bugzilla.redhat.com/show_bug.cgi?id=481548>
<http://www.nabble.com/Bug-484305%3A-bicyclerepair%3A-bike.vim-imports-untrusted-python-files-from-cwd-td18848099.html> (test case,
mention about other affected packages, Python upstream bug rejection reasons)
Debian patch:
<http://bugs.debian.org/cgi-bin/bugreport.cgi?msg=5;filename=sanitize_sys.path.diff;att=1;bug=504363>

2, csound
References:
<http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=504359>
<https://bugzilla.redhat.com/show_bug.cgi?id=481550>
<http://www.nabble.com/Bug-484305%3A-bicyclerepair%3A-bike.vim-imports-untrusted-python-files-from-cwd-td18848099.html>
Debian patch:
<http://bugs.debian.org/cgi-bin/bugreport.cgi?msg=5;filename=1004-sanitize-sys.path.diff;att=1;bug=504359>

3, dia
References:
<http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=504251>
<https://bugzilla.redhat.com/show_bug.cgi?id=481551>
<http://www.nabble.com/Bug-484305%3A-bicyclerepair%3A-bike.vim-imports-untrusted-python-files-from-cwd-td18848099.html>
Debian patch:
<http://bugs.debian.org/cgi-bin/bugreport.cgi?msg=5;filename=pythonpath.diff;att=1;bug=504251>

4, eog
References:
<http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=504352>
<https://bugzilla.redhat.com/show_bug.cgi?id=481553>
<http://www.nabble.com/Bug-484305%3A-bicyclerepair%3A-bike.vim-imports-untrusted-python-files-from-cwd-td18848099.html>
Debian patch:
<http://bugs.debian.org/cgi-bin/bugreport.cgi?msg=5;filename=02_sanitize_sys.path.patch;att=1;bug=504352>

5, gedit
References:
<https://bugzilla.redhat.com/show_bug.cgi?id=481556>
<http://www.nabble.com/Bug-484305%3A-bicyclerepair%3A-bike.vim-imports-untrusted-python-files-from-cwd-td18848099.html>

6, xchat
References:
<https://bugzilla.redhat.com/show_bug.cgi?id=481560>
<http://www.nabble.com/Bug-484305%3A-bicyclerepair%3A-bike.vim-imports-untrusted-python-files-from-cwd-td18848099.html>

7, vim
References:
<https://bugzilla.redhat.com/show_bug.cgi?id=481565>
<http://www.nabble.com/Bug-484305%3A-bicyclerepair%3A-bike.vim-imports-untrusted-python-files-from-cwd-td18848099.html>

8, nautilus-python
References:
<https://bugzilla.redhat.com/show_bug.cgi?id=481570>
<http://www.nabble.com/Bug-484305%3A-bicyclerepair%3A-bike.vim-imports-untrusted-python-files-from-cwd-td18848099.html>

9, Gnumeric
References:
<https://bugzilla.redhat.com/show_bug.cgi?id=481572>
<http://www.nabble.com/Bug-484305%3A-bicyclerepair%3A-bike.vim-imports-untrusted-python-files-from-cwd-td18848099.html>

Steve, could you please allocate a new CVE ids for the above issues?

Thanks, Jan.
--
Jan iankko Lieskovsky / Red Hat Security Response Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from access.redhat.com_aaf2c2b3_20250126_094741.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugzilla.redhat.com_fcfc8055_20250125_151246.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D481565)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D481565)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D481565)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 481565

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 481565**](show_bug.cgi?id=481565)
(CVE-2009-0316)
- [CVE-2009-0316](https://access.redhat.com/security/cve/CVE-2009-0316) vim: untrusted python modules search path

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2009-0316 vim: untrusted python modules search path

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED WONTFIX | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2009-0316 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [http://www.nabble.com/Bug-484305%3A-b...](http://www.nabble.com/Bug-484305%3A-bicyclerepair%3A-bike.vim-imports-untrusted-python-files-from-cwd-td18848099.html) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [CVE-2008-5983](show_bug.cgi?id=482814 "CLOSED ERRATA - CVE-2008-5983 python: untrusted python modules search path") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=481565&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=481565&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2009-01-26 12:45 UTC by Jan Lieskovsky | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-25 13:40 UTC ([History](show_activity.cgi?id=481565)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  bressers chtan karsten psplicha | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2015-03-02 19:17:21 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=481565#c0)  Jan Lieskovsky    2009-01-26 12:45:30 UTC  ``` Untrusted search path vulnerability in the of Vim allows local users to execute arbitrary code via a Trojan horse Python file in the current working directory, related to an erroneous setting of sys.path by the PySys_SetArgv function.  References (test case, PoC): <http://www.nabble.com/Bug-484305%3A-bicyclerepair%3A-bike.vim-imports-untrusted-python-files-from-cwd-td18848099.html>  Proposed patch: The Debian patch for similar dia's Python related issue, available at:  <http://bugs.debian.org/cgi-bin/bugreport.cgi?msg=5;filename=pythonpath.diff;att=1;bug=504251>  should be sufficient to resolve this issue.   ```  [Comment 1](show_bug.cgi?id=481565#c1)  Jan Lieskovsky    2009-01-26 12:47:15 UTC  ``` This issue does NOT affect the version of the Vim package, as shipped with Red Hat Enterprise Linux 2.1.  This issue affects the versions of the Vim package, as shipped  with Red Hat Enterprise Linux 3, 4, and 5.   Comment relevant to fixes for RHEL-{3,4,5}:  The Red Hat Security Response Team has rated this issue as having low security impact, a future update may address this flaw.  More information regarding issue severity can be found here: <http://www.redhat.com/security/updates/classification/>   ```  [Comment 2](show_bug.cgi?id=481565#c2)  Jan Lieskovsky    2009-01-26 12:48:52 UTC  ``` This issue affects the versions of the Vim package, as shipped  with Fedora releases of 9, 10 and devel.  Please fix.   ```  [Comment 3](show_bug.cgi?id=481565#c3)  Karsten Hopp    2009-01-26 16:24:51 UTC  ``` <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=493937>  This has been fixed upstream with patch 7.2.045 Fedora releases 9, 10 and devel are at least at patchlevel 60 and are not vulnerable.   ```  [Comment 4](show_bug.cgi?id=481565#c4)  Jan Lieskovsky    2009-01-28 10:58:38 UTC  ``` Common Vulnerabilities and Exposures assigned an identifier [CVE-2009-0316](https://access.redhat.com/security/cve/CVE-2009-0316) to this vulnerability:  Untrusted search path vulnerability in the Python module in vim allows local users to execute arbitrary code via a Trojan horse Python file in the current working directory, related to a vulnerability in the PySys_SetArgv function ([CVE-2008-5983](https://access.redhat.com/security/cve/CVE-2008-5983)).  References: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0316> <http://www.nabble.com/Bug-484305%3A-bicyclerepair%3A-bike.vim-imports-untrusted-python-files-from-cwd-td18848099.html> <http://www.openwall.com/lists/oss-security/2009/01/26/2>   ```  [Comment 5](show_bug.cgi?id=481565#c5)  Petr Šplíchal    2009-04-27 13:50:19 UTC  ``` I guess this issue does not affect RHEL-{3,4} as the vim package is compiled without python support on these.  # vim --version VIM - Vi IMproved 6.3 (2004 June 7, compiled Nov 17 2008 08:14:13) ... +path_extra +perl +postscript +printer -python +quickfix +rightleft -ruby   ```  [Comment 6](show_bug.cgi?id=481565#c6)  Tomas Hoger    2009-07-13 12:11:28 UTC  ``` (In reply to [comment #3](show_bug.cgi?id=481565#c3)) > This has been fixed upstream with patch 7.2.045  Upstream fix: <http://vim.svn.sourceforge.net/viewvc/vim/vim7/src/if_python.c?r1=1124&r2=1257> ftp://ftp.vim.org/pub/vim/patches/7.2/7.2.045   ```  [Comment 7](show_bug.cgi?id=481565#c7)  Josh Bressers    2010-05-19 20:46:26 UTC  ``` Statement:  This issue did not affect vim as shipped in Red Hat Enterprise Linux 3 and 4. This issue is not planned to be fixed in vim packages in Red Hat Enterprise Linux 5.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=481565&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.mandriva.com_3a78efd5_20250125_151243.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from bugs.debian.org_97ef23ec_20250125_151234.html ===

# Debian Bug report logs - #484305 bicyclerepair: bike.vim imports untrusted python files from cwd

[![version graph](version.cgi?height=2;width=2;absolute=0;found=bicyclerepair%2F0.9-4.1;package=bicyclerepair;collapse=1)](version.cgi?info=1;absolute=0;package=bicyclerepair;collapse=1;found=bicyclerepair%2F0.9-4.1)

Package:
[bicyclerepair](pkgreport.cgi?package=bicyclerepair);
Maintainer for [bicyclerepair](pkgreport.cgi?package=bicyclerepair) is [Robert Collins <robertc@robertcollins.net>](pkgreport.cgi?maint=robertc%40robertcollins.net); Source for [bicyclerepair](pkgreport.cgi?package=bicyclerepair) is [src:bicyclerepair](pkgreport.cgi?src=bicyclerepair) ([PTS](https://tracker.debian.org/pkg/bicyclerepair), [buildd](https://buildd.debian.org/bicyclerepair), [popcon](https://qa.debian.org/popcon.php?package=bicyclerepair)).

Reported by: [Thomas Arendsen Hein <thomas@intevation.de>](pkgreport.cgi?submitter=thomas%40intevation.de)

Date: Tue, 3 Jun 2008 15:42:02 UTC

Severity: *grave*

Tags: security

Found in version bicyclerepair/0.9-4.1

**Done:** James Vega <jamessan@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=484305;mbox=yes), [status mbox](bugreport.cgi?bug=484305;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=484305;mbox=yes;mboxmaint=yes)

---

**Report forwarded** to `debian-bugs-dist@lists.debian.org, Debian Security Team <team@security.debian.org>, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=484305;msg=2), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent** to `Thomas Arendsen Hein <thomas@intevation.de>`:

New Bug report received and forwarded. Copy sent to `Debian Security Team <team@security.debian.org>, Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=484305;msg=4), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=484305;msg=5), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=thomas%40intevation.de)
From: Thomas Arendsen Hein <thomas@intevation.de>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: bicyclerepair: bike.vim imports untrusted python files from cwd
Date: Tue, 3 Jun 2008 17:40:03 +0200
```
Package: bicyclerepair
Version: 0.9-4.1
Severity: critical
Tags: security
Justification: root security hole

# pwd
/tmp/roundup-1.3.3/roundup
# vim /tmp/whatever
Error detected while processing /usr/share/vim/addons/plugin/bike.vim:
line  110:
Traceback (most recent call last):
  File "<string>", line 6, in ?
  File "/usr/lib/python2.4/site-packages/bike/__init__.py", line 10, in ?
    from bikefacade import init, NotAPythonModuleOrPackageException, CouldntLoca
teASTNodeFromCoordinatesException, UndoStackEmptyException
  File "/usr/lib/python2.4/site-packages/bike/bikefacade.py", line 3, in ?
    import compiler
  File "__init__.py", line 24, in ?

  File "compiler/transformer.py", line 1348, in ?
AttributeError: 'module' object has no attribute 'LESS'
Press ENTER or type command to continue

bicyclerepair contains /usr/share/vim/addons/plugin/bike.vim which is
automatically executed, at least in etch. I don't know about lenny/sid,
see #464817 (bicyclerepair: Conform with Vim addon policy)

It imports (i.e. runs) python code it finds in the current working
directory, in my example from the extracted roundup tarball.

I set Severity to "critical" instead of "grave", because the user who
reported the traceback to me on a multi-user system does not use
bicyclerepair, but just vim. Reportbug forced me to set "root security
hole", because everyone using vim is affected (including root) and
the Justification 5 "unknown / something else" would downgrade the
Severity to "normal". The description for "grave" said, that it only
applies if the security problem affects people actually using the package.

-- System Information:
Debian Release: 4.0
  APT prefers stable
  APT policy: (500, 'stable')
Architecture: i386 (i686)
Shell:  /bin/sh linked to /bin/bash
Kernel: Linux 2.6.24.3-id1-k8-2
Locale: LANG=en_US, LC_CTYPE=de_DE@euro (charmap=ISO-8859-15)

Versions of packages bicyclerepair depends on:
ii  python                        2.4.4-2    An interactive high-level object-o
ii  python-central                0.5.12     register and build utility for Pyt

bicyclerepair recommends no packages.

-- no debconf information

--
thomas@intevation.de - <http://intevation.de/~thomas/> - OpenPGP key: 0x5816791A
Intevation GmbH, Osnabrueck - Register: Amtsgericht Osnabrueck, HR B 18998
Geschaeftsfuehrer: Frank Koormann, Bernhard Reiter, Dr. Jan-Oliver Wagner

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=484305;msg=7), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent** to `Steffen Joeris <steffen.joeris@skolelinux.de>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=484305;msg=9), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=484305;msg=10), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=steffen.joeris%40skolelinux.de)
From: Steffen Joeris <steffen.joeris@skolelinux.de>
To: 484305@bugs.debian.org
Cc: control@bugs.debian.org
Subject: PoC not working for bicyclerepair
Date: Sun, 6 Jul 2008 11:04:13 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=484305;msg=10) (text/plain, inline)]
```
```
severity 484305 important
thanks

Hi

I have troubles reproducing your problem and I've tried an etch and a lenny
chroot.

white@security:/tmp/roundup-1.2.1/roundup$ pwd
/tmp/roundup-1.2.1/roundup
white@security:/tmp/roundup-1.2.1/roundup$ vim /tmp/foo
white@security:/tmp/roundup-1.2.1/roundup$ apt-cache policy bicyclerepair
bicyclerepair:
  Installed: 0.9-4.1
  Candidate: 0.9-4.1
  Version table:
 *** 0.9-4.1 0
        500 <http://ftp.no.debian.org> etch/main Packages
        100 /var/lib/dpkg/status

and

white@security:/tmp/roundup-1.4.4/roundup$ pwd
/tmp/roundup-1.4.4/roundup
white@security:/tmp/roundup-1.4.4/roundup$ vim /tmp/foo
white@security:/tmp/roundup-1.4.4/roundup$ apt-cache policy bicyclerepair
bicyclerepair:
  Installed: 0.9-4.2
  Candidate: 0.9-4.2
  Version table:
 *** 0.9-4.2 0
        500 <http://ftp.no.debian.org> lenny/main Packages
        100 /var/lib/dpkg/status

Also, I can't find /usr/share/vim/addons/plugin/bike.vim. The package
bicyclerepair only contains /usr/share/vim/addons/ftplugin/python_bike.vim,
however I am not so firm with vim plugins after all.
I am using a standard vim config file.

Cheers
Steffen

```
```
[[signature.asc](bugreport.cgi?att=1;bug=484305;filename=signature.asc;msg=10) (application/pgp-signature, inline)]
```

---

**Severity set to `important' from `critical'**
Request was from `Steffen Joeris <steffen.joeris@skolelinux.de>`
to `control@bugs.debian.org`.
(Sun, 06 Jul 2008 09:06:03 GMT) ([full text](bugreport.cgi?bug=484305;msg=12), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=12), [link](#11)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=484305;msg=14), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=14), [link](#13)).

---

**Acknowledgement sent** to `Thomas Arendsen Hein <thomas@intevation.de>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=484305;msg=16), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=16), [link](#15)).

---

[Message #17](#17) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=484305;msg=17), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=17), reply):

![](/cgi-bin/libravatar.cgi?email=thomas%40intevation.de)
From: Thomas Arendsen Hein <thomas@intevation.de>
To: Steffen Joeris <steffen.joeris@skolelinux.de>
Cc: 484305@bugs.debian.org, control@bugs.debian.org
Subject: Re: PoC not working for bicyclerepair
Date: Sun, 6 Jul 2008 22:24:57 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=484305;msg=17) (text/plain, inline)]
```
```
severity 484305 critical
thanks

* Steffen Joeris <steffen.joeris@skolelinux.de> [20080706 11:15]:
> severity 484305 important
> thanks

Please do not downgrade severity without providing a reason. As I
wrote in my original report, this should not be less than "grave":

| I set Severity to "critical" instead of "grave", because the user who
| reported the traceback to me on a multi-user system does not use
| bicyclerepair, but just vim. Reportbug forced me to set "root security
| hole", because everyone using vim is affected (including root) and
| the Justification 5 "unknown / something else" would downgrade the
| Severity to "normal". The description for "grave" said, that it only
| applies if the security problem affects people actually using the package.

> I have troubles reproducing your problem and I've tried an etch and a lenny
> chroot.
>
> white@security:/tmp/roundup-1.2.1/roundup$ pwd
> /tmp/roundup-1.2.1/roundup
> white@security:/tmp/roundup-1.2.1/roundup$ vim /tmp/foo
> white@security:/tmp/roundup-1.2.1/roundup$ apt-cache policy bicyclerepair
> bicyclerepair:
>   Installed: 0.9-4.1
>   Candidate: 0.9-4.1
>   Version table:
>  *** 0.9-4.1 0
>         500 <http://ftp.no.debian.org> etch/main Packages
>         100 /var/lib/dpkg/status
>
> Also, I can't find /usr/share/vim/addons/plugin/bike.vim. The package
> bicyclerepair only contains /usr/share/vim/addons/ftplugin/python_bike.vim,
> however I am not so firm with vim plugins after all.
> I am using a standard vim config file.

On etch:

$ dpkg -l bicyclerepair|grep ^i
ii  bicyclerepair       0.9-4.1             A refactoring tool for python

$ dpkg -L bicyclerepair|grep vim
/usr/share/doc/bicyclerepair/README.vim
/usr/share/vim
/usr/share/vim/vim62
/usr/share/vim/vim62/plugin
/usr/share/vim/vim62/plugin/bike.vim
/usr/share/vim/vim63
/usr/share/vim/vim63/plugin
/usr/share/vim/vim63/plugin/bike.vim
/usr/share/vim/addons
/usr/share/vim/addons/plugin
/usr/share/vim/addons/plugin/bike.vim

Maybe (I haven't verified) you need:
/etc/alternatives/vim -> /usr/bin/vim.python

On lenny the plugin is indeed stored in
/usr/share/vim/addons/ftplugin/python_bike.vim

Regards,
Thomas

--
thomas@intevation.de - <http://intevation.de/~thomas/> - OpenPGP key: 0x5816791A
Intevation GmbH, Osnabrueck - Register: Amtsgericht Osnabrueck, HR B 18998
Geschaeftsfuehrer: Frank Koormann, Bernhard Reiter, Dr. Jan-Oliver Wagner

```
```
[[Message part 2](bugreport.cgi?att=1;bug=484305;msg=17) (application/pgp-signature, inline)]
```

---

**Severity set to `critical' from `important'**
Request was from `Thomas Arendsen Hein <thomas@intevation.de>`
to `control@bugs.debian.org`.
(Sun, 06 Jul 2008 20:30:10 GMT) ([full text](bugreport.cgi?bug=484305;msg=19), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=19), [link](#18)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=484305;msg=21), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=21), [link](#20)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=484305;msg=23), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=23), [link](#22)).

---

[Message #24](#24) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=484305;msg=24), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=24), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: Thomas Arendsen Hein <thomas@intevation.de>, 484305@bugs.debian.org
Cc: Steffen Joeris <steffen.joeris@skolelinux.de>, control@bugs.debian.org,
pkg-vim-maintainers@lists.alioth.debian.org
Subject: Re: Bug#484305: PoC not working for bicyclerepair
Date: Mon, 7 Jul 2008 19:11:10 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=484305;msg=24) (text/plain, inline)]
```
```
severity 484305 grave
thanks

Hi Thomas,
* Thomas Arendsen Hein <thomas@intevation.de> [2008-07-06 22:53]:
> * Steffen Joeris <steffen.joeris@skolelinux.de> [20080706 11:15]:
> > severity 484305 important
> > thanks
>
> Please do not downgrade severity without providing a reason.

"critical makes unrelated software on the system (or the whole system)
break, or causes serious data loss, or introduces a security
hole on systems where you install the package."

I had a look at the issue now and this is not the case
because you have to a) install vim-python and bicyclerepair
together and b) set vim.python as the vim alternative.
Thus downgrading this bug.

> As I
> wrote in my original report, this should not be less than "grave":
>
> | I set Severity to "critical" instead of "grave", because the user who
> | reported the traceback to me on a multi-user system does not use
> | bicyclerepair, but just vim. Reportbug forced me to set "root security
> | hole", because everyone using vim is affected (including root) and
> | the Justification 5 "unknown / something else" would downgrade the
> | Severity to "normal".

I think that this is more like a user security hole because
the security issue itself doesn't automatically result in
root access. root security hole fit better to issues
included in a daemon running as root for example. But I
doubt discussing this gets us anywhere and I personally
don't care about this tag in this case :)

[...]
> On etch:
>
> $ dpkg -l bicyclerepair|grep ^i
> ii  bicyclerepair       0.9-4.1             A refactoring tool for python
>
> $ dpkg -L bicyclerepair|grep vim
> /usr/share/doc/bicyclerepair/README.vim
> /usr/share/vim
> /usr/share/vim/vim62
> /usr/share/vim/vim62/plugin
> /usr/share/vim/vim62/plugin/bike.vim
> /usr/share/vim/vim63
> /usr/share/vim/vim63/plugin
> /usr/share/vim/vim63/plugin/bike.vim
> /usr/share/vim/addons
> /usr/share/vim/addons/plugin
> /usr/share/vim/addons/plugin/bike.vim
>
> Maybe (I haven't verified) you need:
> /etc/alternatives/vim -> /usr/bin/vim.python

Indeed, this is needed (+ installation of vim-python).
So to sum up you need to install vim-python and set the
alternative to vim.python. I am not sure about the status of
this in unstable, at least I could not reproduce this on
unstable but vim.python is also no longer available there,
a lot in the vim structure changed since then and I don't
really have an idea about the scripting support of vim.

That's why I Cc'ed the vim maintainers. Do you think this
should also work in the same way in unstable/testing?
I am also not really sure what is causing the automatic
import.

To reproduce this on stable:
cd /tmp && apt-get source roundup && roundup-1.2.1/roundup/
apt-get install vim-python bicyclerepair
update-alternatives --set vim /usr/bin/vim.python
and edit some random file (e.g. vim /tmp/foobar).

I found out that the file that causes this is token.py in
the roundup sources. Another way to reproduce this would be
to create a file named fcntl:

cat >> fcntl.py << EOF
print "FOOOOBAR"
EOF

This file is also automatically imported besides the files
bike.py, compiler.py, parser.py, symbol.py, token.py, struct.py
cStringIO.py, dis.py, opcode.py, new.py, re.py, sre.py
sre_compile.py, sre_constants.py, sre_parse.py, __future__.py
string.py, strop.py, tempfile.py, random.py, math.py, binascii.py
_random.py and fcntl.py

Something should prepend '.' to syspath but I don't see
anything doing this :/

Kind regards
Nico
--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=484305;msg=24) (application/pgp-signature, inline)]
```

---

**Severity set to `grave' from `critical'**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Mon, 07 Jul 2008 17:15:06 GMT) ([full text](bugreport.cgi?bug=484305;msg=26), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=26), [link](#25)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=484305;msg=28), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=28), [link](#27)).

---

**Acknowledgement sent** to `James Vega <jamessan@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=484305;msg=30), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=30), [link](#29)).

---

[Message #31](#31) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=484305;msg=31), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=31), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James Vega <jamessan@debian.org>
To: Nico Golde <nion@debian.org>
Cc: Thomas Arendsen Hein <thomas@intevation.de>, 484305@bugs.debian.org,
pkg-vim-maintainers@lists.alioth.debian.org,
Steffen Joeris <steffen.joeris@skolelinux.de>
Subject: Re: Bug#484305: PoC not working for bicyclerepair
Date: Mon, 7 Jul 2008 14:10:37 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=484305;msg=31) (text/plain, inline)]
```
```
On Mon, Jul 07, 2008 at 07:11:10PM +0200, Nico Golde wrote:
> Hi Thomas,
> * Thomas Arendsen Hein <thomas@intevation.de> [2008-07-06 22:53]:
> > * Steffen Joeris <steffen.joeris@skolelinux.de> [20080706 11:15]:
> > > severity 484305 important
> > > thanks
> >
> > Please do not downgrade severity without providing a reason.
>
> "critical makes unrelated software on the system (or the whole system)
> break, or causes serious data loss, or introduces a security
> hole on systems where you install the package."
>
> I had a look at the issue now and this is not the case
> because you have to a) install vim-python and bicyclerepair
> together and b) set vim.python as the vim alternative.
> Thus downgrading this bug.

In Lenny/Sid, all Vim packages except vim-tiny and vim contain the
python support, so it is more likely that a user will have a vim binary
that can be scripted via Python.

On the other hand, in Lenny/Sid the path that plugins used to be
installed to (/usr/share/vim/addons) is no longer automatically included
in Vim's runtimepath.  This means that manual work is required to enable
the plugin.

> [...]
> > On etch:
> >
> > $ dpkg -l bicyclerepair|grep ^i
> > ii  bicyclerepair       0.9-4.1             A refactoring tool for python
> >
> > $ dpkg -L bicyclerepair|grep vim
> > /usr/share/doc/bicyclerepair/README.vim
> > /usr/share/vim
> > /usr/share/vim/vim62
> > /usr/share/vim/vim62/plugin
> > /usr/share/vim/vim62/plugin/bike.vim
> > /usr/share/vim/vim63
> > /usr/share/vim/vim63/plugin
> > /usr/share/vim/vim63/plugin/bike.vim
> > /usr/share/vim/addons
> > /usr/share/vim/addons/plugin
> > /usr/share/vim/addons/plugin/bike.vim
> >
> > Maybe (I haven't verified) you need:
> > /etc/alternatives/vim -> /usr/bin/vim.python
>
> Indeed, this is needed (+ installation of vim-python).
> So to sum up you need to install vim-python and set the
> alternative to vim.python. I am not sure about the status of
> this in unstable, at least I could not reproduce this on
> unstable but vim.python is also no longer available there,
> a lot in the vim structure changed since then and I don't
> really have an idea about the scripting support of vim.
>
> That's why I Cc'ed the vim maintainers. Do you think this
> should also work in the same way in unstable/testing?

See above explanation.

Also, taking a look at the current bicyclerepair package, the addon is
now installed to /usr/share/addons/vim/ftplugin/python_bike.vim.  This
means that the functionality will only be used when editing python files
(once the user has enabled the plugin) instead of when editing any file,
as was the case when it was installed to plugins/bike.vim.

> I am also not really sure what is causing the automatic
> import.

Python, by default, has '' as the initial item in its sys.path list

  $ python
  Python 2.5.2 (r252:60911, Jun 25 2008, 17:58:32)
  [GCC 4.3.1] on linux2
  Type "help", "copyright", "credits" or "license" for more information.
  >>> import sys
  >>> sys.path
  ['', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages/Numeric', '/usr/lib/python2.5/site-packages/gst-0.10', '/var/lib/python-support/python2.5', '/var/lib/python-support/python2.5/gtk-2.0']

This means that anything in the current directory is first priority when
trying to use/import a module.

/usr/lib/pythonX.Y/compiler/transformer.py has the following lines that
are run when the module is imported

  import token
  ...
  _cmp_types = {
      token.LESS : '<',
      token.GREATER : '>',
      token.EQEQUAL : '==',
      token.EQUAL : '==',
      token.LESSEQUAL : '<=',
      token.GREATEREQUAL : '>=',
      token.NOTEQUAL : '!=',
      }

When the bike Vim plugin is loaded, it imports the bike python module,
which imports compiler (and therefore compiler.transformer).  Since
Vim's current working directory is roundup-X.Y/roundup, the above lines
from transformer.py combined with '' being the first item in sys.path
cause python to load the token module in the current working directory
(from roundup's source) instead of using /usr/lib/pythonX.Y/token.py.

--
James
GPG Key: 1024D/61326D40 2003-09-02 James Vega <jamessan@debian.org>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=484305;filename=signature.asc;msg=31) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=484305;msg=33), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=33), [link](#32)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=484305;msg=35), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=35), [link](#34)).

---

[Message #36](#36) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=484305;msg=36), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=36), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: Thomas Arendsen Hein <thomas@intevation.de>, 484305@bugs.debian.org,
pkg-vim-maintainers@lists.alioth.debian.org,
Steffen Joeris <steffen.joeris@skolelinux.de>
Subject: Re: Bug#484305: PoC not working for bicyclerepair
Date: Mon, 7 Jul 2008 21:16:21 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=484305;msg=36) (text/plain, inline)]
```
```
Hi James,
* James Vega <jamessan@debian.org> [2008-07-07 20:11]:
> On Mon, Jul 07, 2008 at 07:11:10PM +0200, Nico Golde wrote:
> > * Thomas Arendsen Hein <thomas@intevation.de> [2008-07-06 22:53]:
> > > * Steffen Joeris <steffen.joeris@skolelinux.de> [20080706 11:15]:
[...]
> In Lenny/Sid, all Vim packages except vim-tiny and vim contain the
> python support, so it is more likely that a user will have a vim binary
> that can be scripted via Python.
>
> On the other hand, in Lenny/Sid the path that plugins used to be
> installed to (/usr/share/vim/addons) is no longer automatically included
> in Vim's runtimepath.  This means that manual work is required to enable
> the plugin.

Ok, thanks for this information!

[...]
> > That's why I Cc'ed the vim maintainers. Do you think this
> > should also work in the same way in unstable/testing?
>
> See above explanation.
>
> Also, taking a look at the current bicyclerepair package, the addon is
> now installed to /usr/share/addons/vim/ftplugin/python_bike.vim.  This
> means that the functionality will only be used when editing python files
> (once the user has enabled the plugin) instead of when editing any file,
> as was the case when it was installed to plugins/bike.vim.

Ok

> > I am also not really sure what is causing the automatic
> > import.
>
> Python, by default, has '' as the initial item in its sys.path list
>
>   $ python
>   Python 2.5.2 (r252:60911, Jun 25 2008, 17:58:32)
>   [GCC 4.3.1] on linux2
>   Type "help", "copyright", "credits" or "license" for more information.
>   >>> import sys
>   >>> sys.path
>   ['', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages/Numeric', '/usr/lib/python2.5/site-packages/gst-0.10', '/var/lib/python-support/python2.5', '/var/lib/python-support/python2.5/gtk-2.0']
>
> This means that anything in the current directory is first priority when
> trying to use/import a module.

This should only happen in an interactive session, not!?
nion@coredump:/tmp$] mkdir somedir
[nion@coredump:/tmp$] cd somedir
[nion@coredump:somedir$] cat > /tmp/test.py << EOF
heredoc> import sys
heredoc> print sys.path
heredoc> EOF
[nion@coredump:somedir$] python /tmp/test.py
['/tmp', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages/Numeric', '/usr/lib/python2.5/site-packages/PIL', '/var/lib/python-support/python2.5', '/var/lib/python-support/python2.5/gtk-2.0', '/usr/lib/python2.5/site-packages/wx-2.6-gtk2-unicode']

The python docs also state "As initialized upon program startup, the first item
of this list, path[0], is the directory containing the script that was used to
invoke the Python interpreter."
So this should be no problem unless I missed your point.

> /usr/lib/pythonX.Y/compiler/transformer.py has the following lines that
> are run when the module is imported
>
>   import token
>   ...
>   _cmp_types = {
>       token.LESS : '<',
>       token.GREATER : '>',
>       token.EQEQUAL : '==',
>       token.EQUAL : '==',
>       token.LESSEQUAL : '<=',
>       token.GREATEREQUAL : '>=',
>       token.NOTEQUAL : '!=',
>       }
>
> When the bike Vim plugin is loaded, it imports the bike python module,
> which imports compiler (and therefore compiler.transformer).  Since
> Vim's current working directory is roundup-X.Y/roundup, the above lines
> from transformer.py combined with '' being the first item in sys.path
> cause python to load the token module in the current working directory
> (from roundup's source) instead of using /usr/lib/pythonX.Y/token.py.

I'd agree if that would be the case in a python script, I had this thought
as well first but this doesn't seem to work. That's why I said that I don't
see something like sys.path = [os.curdir] + sys.path in the code.

Did I misunderstand what you wrote?

Thanks for your help James!
Cheers
Nico
--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=484305;msg=36) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=484305;msg=38), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=38), [link](#37)).

---

**Acknowledgement sent** to `James Vega <jamessan@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=484305;msg=40), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=40), [link](#39)).

---

[Message #41](#41) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=484305;msg=41), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=41), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James Vega <jamessan@debian.org>
To: Nico Golde <nion@debian.org>
Cc: Thomas Arendsen Hein <thomas@intevation.de>, 484305@bugs.debian.org,
pkg-vim-maintainers@lists.alioth.debian.org,
Steffen Joeris <steffen.joeris@skolelinux.de>
Subject: Re: Bug#484305: PoC not working for bicyclerepair
Date: Mon, 7 Jul 2008 16:03:53 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=484305;msg=41) (text/plain, inline)]
```
```
On Mon, Jul 07, 2008 at 09:16:21PM +0200, Nico Golde wrote:
> Hi James,
> * James Vega <jamessan@debian.org> [2008-07-07 20:11]:
> > On Mon, Jul 07, 2008 at 07:11:10PM +0200, Nico Golde wrote:
> > > I am also not really sure what is causing the automatic
> > > import.
> >
> > Python, by default, has '' as the initial item in its sys.path list
> >
> >   $ python
> >   Python 2.5.2 (r252:60911, Jun 25 2008, 17:58:32)
> >   [GCC 4.3.1] on linux2
> >   Type "help", "copyright", "credits" or "license" for more information.
> >   >>> import sys
> >   >>> sys.path
> >   ['', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages/Numeric', '/usr/lib/python2.5/site-packages/gst-0.10', '/var/lib/python-support/python2.5', '/var/lib/python-support/python2.5/gtk-2.0']
> >
> > This means that anything in the current directory is first priority when
> > trying to use/import a module.
>
> This should only happen in an interactive session, not!?
> nion@coredump:/tmp$] mkdir somedir
> [nion@coredump:/tmp$] cd somedir
> [nion@coredump:somedir$] cat > /tmp/test.py << EOF
> heredoc> import sys
> heredoc> print sys.path
> heredoc> EOF
> [nion@coredump:somedir$] python /tmp/test.py
> ['/tmp', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages/Numeric', '/usr/lib/python2.5/site-packages/PIL', '/var/lib/python-support/python2.5', '/var/lib/python-support/python2.5/gtk-2.0', '/usr/lib/python2.5/site-packages/wx-2.6-gtk2-unicode']
>
> The python docs also state "As initialized upon program startup, the first item
> of this list, path[0], is the directory containing the script that was used to
> invoke the Python interpreter."

In an interactive session, sys.path[0] is '' because the "script" is
simply the python interpreter.  In your example, if you were in /tmp
when you ran test.py you would have seen '' as sys.path[0] as well.

In the case of Vim, sys.path[0] is always Vim's current working
directory.

/tmp $ mkdir somedir
/tmp $ cat test.vim
function! ShowPath()
    python << EOF
import os
import sys
print os.getcwd()
print repr(sys.path[0])
EOF
endfunction
call ShowPath()
cd somedir
call ShowPath()
q
/tmp $ python -S test.vim
/tmp
''
/tmp/somedir
''

From what I can tell, every time the :python command (which is simply a
thin wrapper to the PyRun_SimpleString function from Python's library)
is run from Vim, it's like running a new script.

This would explain why why sys.path[0] and os.getcwd() are updated when
we change the current working directory of the Vim process.

--
James
GPG Key: 1024D/61326D40 2003-09-02 James Vega <jamessan@debian.org>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=484305;filename=signature.asc;msg=41) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=484305;msg=43), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=43), [link](#42)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=484305;msg=45), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=45), [link](#44)).

---

[Message #46](#46) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=484305;msg=46), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=46), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: Thomas Arendsen Hein <thomas@intevation.de>, 484305@bugs.debian.org,
pkg-vim-maintainers@lists.alioth.debian.org,
Steffen Joeris <steffen.joeris@skolelinux.de>
Subject: Re: Bug#484305: PoC not working for bicyclerepair
Date: Mon, 7 Jul 2008 22:15:44 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=484305;msg=46) (text/plain, inline)]
```
```
Hi James,
* James Vega <jamessan@debian.org> [2008-07-07 22:04]:
> On Mon, Jul 07, 2008 at 09:16:21PM +0200, Nico Golde wrote:
> > * James Vega <jamessan@debian.org> [2008-07-07 20:11]:
> > > On Mon, Jul 07, 2008 at 07:11:10PM +0200, Nico Golde wrote:
[...]
> > [nion@coredump:somedir$] python /tmp/test.py
> > ['/tmp', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages/Numeric', '/usr/lib/python2.5/site-packages/PIL', '/var/lib/python-support/python2.5', '/var/lib/python-support/python2.5/gtk-2.0', '/usr/lib/python2.5/site-packages/wx-2.6-gtk2-unicode']
> >
> > The python docs also state "As initialized upon program startup, the first item
> > of this list, path[0], is the directory containing the script that was used to
> > invoke the Python interpreter."
>
> In an interactive session, sys.path[0] is '' because the "script" is
> simply the python interpreter.  In your example, if you were in /tmp
> when you ran test.py you would have seen '' as sys.path[0] as well.

Yes sure that conforms to the quote from the python docs.

> In the case of Vim, sys.path[0] is always Vim's current working
> directory.
[...]
> From what I can tell, every time the :python command (which is simply a
> thin wrapper to the PyRun_SimpleString function from Python's library)
> is run from Vim, it's like running a new script.
>
> This would explain why why sys.path[0] and os.getcwd() are updated when
> we change the current working directory of the Vim process.

Ok, that explains why this happens. This is somehow bad
because everyone who writes a python vim script needs to be
aware of that.

Can you think of a better solution than the following?
--- /usr/share/vim/addons/plugin/bike.vim       2008-07-07 22:14:28.000000000 +0200
+++ bike.vim.new        2008-07-07 22:14:26.000000000 +0200
@@ -100,6 +100,7 @@
 try:
     if sys.version_info < (2, 2):
         raise ImportError, 'Bicycle Repair Man needs Python 2.2 or newer'
+    sys.path.remove('')
     import bike
     bikectx = bike.init()
     bikectx.isLoaded        # make sure bike package is recent enough

Kind regards
Nico
--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=484305;msg=46) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=484305;msg=48), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=48), [link](#47)).

---

**Acknowledgement sent** to `James Vega <jamessan@jamessan.com>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=484305;msg=50), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=50), [link](#49)).

---

[Message #51](#51) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=484305;msg=51), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=51), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40jamessan.com)
From: James Vega <jamessan@jamessan.com>
To: Nico Golde <nion@debian.org>
Cc: Thomas Arendsen Hein <thomas@intevation.de>, 484305@bugs.debian.org,
pkg-vim-maintainers@lists.alioth.debian.org,
Steffen Joeris <steffen.joeris@skolelinux.de>
Subject: Re: Bug#484305: PoC not working for bicyclerepair
Date: Mon, 7 Jul 2008 17:40:22 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=484305;msg=51) (text/plain, inline)]
```
```
On Mon, Jul 07, 2008 at 10:15:44PM +0200, Nico Golde wrote:
> Can you think of a better solution than the following?
> --- /usr/share/vim/addons/plugin/bike.vim       2008-07-07 22:14:28.000000000 +0200
> +++ bike.vim.new        2008-07-07 22:14:26.000000000 +0200
> @@ -100,6 +100,7 @@
>  try:
>      if sys.version_info < (2, 2):
>          raise ImportError, 'Bicycle Repair Man needs Python 2.2 or newer'
> +    sys.path.remove('')
>      import bike
>      bikectx = bike.init()
>      bikectx.isLoaded        # make sure bike package is recent enough

I think this is being addressed from the wrong perspective.  This is a
Python problem.  Performing "import compiler", where compiler is a
module in the std-lib and performs its own import of another std-lib
module should not cause the module in the user's working directory to be
imported instead.

As evidenced by PEP 328[0] and PEP 366[1], this is an acknowledged
problem upstream and they're working to address it.  As for what that
means for the current bug, this is something that python users have to
deal with when they have a file whose name conflicts with one in the
std-lib.  This also means that the *only* time users will run into
issues like this are specifically when they have a filename in Vim's
working directory that conflicts with the name of a Python module.

[0] - <http://www.python.org/dev/peps/pep-0328/>
[1] - <http://www.python.org/dev/peps/pep-0366/>
--
James
GPG Key: 1024D/61326D40 2003-09-02 James Vega <jamessan@debian.org>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=484305;filename=signature.asc;msg=51) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=484305;msg=53), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=53), [link](#52)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=484305;msg=55), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=55), [link](#54)).

---

[Message #56](#56) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=484305;msg=56), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=56), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: Thomas Arendsen Hein <thomas@intevation.de>, 484305@bugs.debian.org,
pkg-vim-maintainers@lists.alioth.debian.org,
Steffen Joeris <steffen.joeris@skolelinux.de>
Subject: Re: Bug#484305: PoC not working for bicyclerepair
Date: Tue, 8 Jul 2008 22:18:46 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=484305;msg=56) (text/plain, inline)]
```
```
Hi James,
* James Vega <jamessan@jamessan.com> [2008-07-07 23:42]:
> On Mon, Jul 07, 2008 at 10:15:44PM +0200, Nico Golde wrote:
> > Can you think of a better solution than the following?
> > --- /usr/share/vim/addons/plugin/bike.vim       2008-07-07 22:14:28.000000000 +0200
> > +++ bike.vim.new        2008-07-07 22:14:26.000000000 +0200
> > @@ -100,6 +100,7 @@
> >  try:
> >      if sys.version_info < (2, 2):
> >          raise ImportError, 'Bicycle Repair Man needs Python 2.2 or newer'
> > +    sys.path.remove('')
> >      import bike
> >      bikectx = bike.init()
> >      bikectx.isLoaded        # make sure bike package is recent enough
>
> I think this is being addressed from the wrong perspective.

Yes I agree, I would also be not really happy about this
solution as all module writes would need to be aware of this
problem.

> This is a Python problem.  Performing "import compiler", where compiler is a
> module in the std-lib and performs its own import of another std-lib
> module should not cause the module in the user's working directory to be
> imported instead.
>
> As evidenced by PEP 328[0] and PEP 366[1], this is an acknowledged
> problem upstream and they're working to address it.  As for what that
> means for the current bug, this is something that python users have to
> deal with when they have a file whose name conflicts with one in the
> std-lib.  This also means that the *only* time users will run into
> issues like this are specifically when they have a filename in Vim's
> working directory that conflicts with the name of a Python module.

Do you think reassigning this to python would be
appropriate?

Thanks for the PEP links, I wasn't aware of them.

Kind regards
Nico
--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=484305;msg=56) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=484305;msg=58), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=58), [link](#57)).

---

**Acknowledgement sent** to `James Vega <jamessan@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=484305;msg=60), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=60), [link](#59)).

---

[Message #61](#61) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=484305;msg=61), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=61), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James Vega <jamessan@debian.org>
To: Nico Golde <nion@debian.org>
Cc: Thomas Arendsen Hein <thomas@intevation.de>, 484305@bugs.debian.org,
pkg-vim-maintainers@lists.alioth.debian.org,
Steffen Joeris <steffen.joeris@skolelinux.de>
Subject: Re: Bug#484305: PoC not working for bicyclerepair
Date: Tue, 8 Jul 2008 16:51:25 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=484305;msg=61) (text/plain, inline)]
```
```
On Tue, Jul 08, 2008 at 10:18:46PM +0200, Nico Golde wrote:
> Hi James,
> * James Vega <jamessan@jamessan.com> [2008-07-07 23:42]:
> > On Mon, Jul 07, 2008 at 10:15:44PM +0200, Nico Golde wrote:
> > > Can you think of a better solution than the following?
> > > --- /usr/share/vim/addons/plugin/bike.vim       2008-07-07 22:14:28.000000000 +0200
> > > +++ bike.vim.new        2008-07-07 22:14:26.000000000 +0200
> > > @@ -100,6 +100,7 @@
> > >  try:
> > >      if sys.version_info < (2, 2):
> > >          raise ImportError, 'Bicycle Repair Man needs Python 2.2 or newer'
> > > +    sys.path.remove('')
> > >      import bike
> > >      bikectx = bike.init()
> > >      bikectx.isLoaded        # make sure bike package is recent enough
> >
> > I think this is being addressed from the wrong perspective.
>
> Yes I agree, I would also be not really happy about this
> solution as all module writes would need to be aware of this
> problem.
>
> > This is a Python problem.  Performing "import compiler", where compiler is a
> > module in the std-lib and performs its own import of another std-lib
> > module should not cause the module in the user's working directory to be
> > imported instead.
> >
> > As evidenced by PEP 328[0] and PEP 366[1], this is an acknowledged
> > problem upstream and they're working to address it.  As for what that
> > means for the current bug, this is something that python users have to
> > deal with when they have a file whose name conflicts with one in the
> > std-lib.  This also means that the *only* time users will run into
> > issues like this are specifically when they have a filename in Vim's
> > working directory that conflicts with the name of a Python module.
>
> Do you think reassigning this to python would be
> appropriate?

That would probably be a better place for it, yes.  I definitely don't
think it's a bug in Vim or the specific Vim script and I'm unsure
whether it's truly a bug in Python or just less-than-ideal behavior.
Even with the listed PEPs implemented, it sounds like this behavior is
still possible, just not as likely.

--
James
GPG Key: 1024D/61326D40 2003-09-02 James Vega <jamessan@debian.org>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=484305;filename=signature.asc;msg=61) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=484305;msg=63), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=63), [link](#62)).

---

**Acknowledgement sent** to `Simon McVittie <smcv@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=484305;msg=65), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=65), [link](#64)).

---

[Message #66](#66) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=484305;msg=66), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=66), reply):

![](/cgi-bin/libravatar.cgi?email=smcv%40debian.org)
From: Simon McVittie <smcv@debian.org>
To: 484305@bugs.debian.org
Cc: control@bugs.debian.org
Subject: Re: Bug#484305: bicyclerepair: bike.vim imports untrusted python
files from cwd
Date: Wed, 6 Aug 2008 01:39:15 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=484305;msg=66) (text/plain, inline)]
```
```
clone 484305 -1
reassign -1 vim-python
thanks

Shouldn't Python builds of vim avoid this bug by stopping '' from being
prepended to sys.path in the first place?

After looking through Python initialization and vim's if_python.c it
seems that the way forward is to set Python's argv, via PySys_SetArgv(),
to have a non-empty and absolute first argument.

vim sets Python's argv to  { "", NULL }, which according to a comment is to
avoid a crash when warn() is called. Changing that to { "/usr/bin/vim", NULL }
would seem to solve this problem - but for that matter, any safe value is fine.

A safe value for argv[0] is any value where there won't be files dir/*.py or
dir/*/__init__.py, where dir == dirname(argv[0]). So setting argv[0] to
"/", "/usr/lib/something" or "/usr/share/vim" would be safe too, for instance.

I'm afraid I haven't tested this in vim itself (the multiple builds take a
while...) but the attached program demonstrates it:

smcv@carbon% gcc -o484305 `python-config --cflags` `python-config --ldflags` 484305.c
smcv@carbon% ./484305
(I have no argv!)
['/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2',
... more output ...
'/var/lib/python-support/python2.5/pyinotify']
smcv@carbon% ./484305 ""
['']
['', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2',
... more output ...
'/var/lib/python-support/python2.5/pyinotify']
smcv@carbon% ./484305 "/usr/bin/vim"
['/usr/bin/vim']
['/usr/bin', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2',
... more output ...
'/var/lib/python-support/python2.5/pyinotify']

Hope this helps,
    Simon

```
```
[[484305.c](bugreport.cgi?att=1;bug=484305;filename=484305.c;msg=66) (text/x-csrc, attachment)]
```

---

**Bug [484305](bugreport.cgi?bug=484305) cloned as bug [493937](bugreport.cgi?bug=493937).**
Request was from `Simon McVittie <smcv@debian.org>`
to `control@bugs.debian.org`.
(Wed, 06 Aug 2008 00:42:02 GMT) ([full text](bugreport.cgi?bug=484305;msg=68), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=68), [link](#67)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=484305;msg=70), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=70), [link](#69)).

---

**Acknowledgement sent** to `Robert Collins <robertc@robertcollins.net>`:

Extra info received and forwarded to list.
([full text](bugreport.cgi?bug=484305;msg=72), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=72), [link](#71)).

---

[Message #73](#73) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=484305;msg=73), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=73), reply):

![](/cgi-bin/libravatar.cgi?email=robertc%40robertcollins.net)
From: Robert Collins <robertc@robertcollins.net>
To: Simon McVittie <smcv@debian.org>, 484305@bugs.debian.org
Subject: Re: Bug#484305: bicyclerepair: bike.vim imports untrusted python
files from cwd
Date: Wed, 06 Aug 2008 11:13:30 +1000
```
[[Message part 1](bugreport.cgi?att=0;bug=484305;msg=73) (text/plain, inline)]
```
```
thanks, yes - I concur.

-Rob

```
```
[[signature.asc](bugreport.cgi?att=1;bug=484305;filename=signature.asc;msg=73) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=484305;msg=75), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=75), [link](#74)).

---

**Acknowledgement sent** to `James Vega <jamessan@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=484305;msg=77), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=77), [link](#76)).

---

[Message #78](#78) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=484305;msg=78), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=78), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James Vega <jamessan@debian.org>
To: Simon McVittie <smcv@debian.org>, 484305@bugs.debian.org
Cc: 493937@bugs.debian.org, Nico Golde <nion@debian.org>,
Steffen Joeris <steffen.joeris@skolelinux.de>
Subject: Re: Bug#484305: bicyclerepair: bike.vim imports untrusted python
files from cwd
Date: Tue, 5 Aug 2008 23:07:48 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=484305;msg=78) (text/plain, inline)]
```
```
On Wed, Aug 06, 2008 at 01:39:15AM +0100, Simon McVittie wrote:
> Shouldn't Python builds of vim avoid this bug by stopping '' from being
> prepended to sys.path in the first place?

As I mentioned earlier[0][1] in the bug log, I don't think removing ''
from sys.argv is the correct change to make in Vim.

> After looking through Python initialization and vim's if_python.c it
> seems that the way forward is to set Python's argv, via PySys_SetArgv(),
> to have a non-empty and absolute first argument.
>
> vim sets Python's argv to  { "", NULL }, which according to a comment is to
> avoid a crash when warn() is called. Changing that to { "/usr/bin/vim", NULL }
> would seem to solve this problem - but for that matter, any safe value is fine.

The way Vim is using PySys_SetArgv (and therefore the resulting
behavior) is exactly following the recommended use of PySys_SetArgv
according to upstream's documentation[2].

> A safe value for argv[0] is any value where there won't be files dir/*.py or
> dir/*/__init__.py, where dir == dirname(argv[0]). So setting argv[0] to
> "/", "/usr/lib/something" or "/usr/share/vim" would be safe too, for instance.
>
> I'm afraid I haven't tested this in vim itself (the multiple builds take a
> while...) but the attached program demonstrates it:
>
> smcv@carbon% gcc -o484305 `python-config --cflags` `python-config --ldflags` 484305.c
> smcv@carbon% ./484305
> (I have no argv!)
> ['/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2',
> ... more output ...
> '/var/lib/python-support/python2.5/pyinotify']
> smcv@carbon% ./484305 ""
> ['']
> ['', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2',
> ... more output ...
> '/var/lib/python-support/python2.5/pyinotify']
> smcv@carbon% ./484305 "/usr/bin/vim"
> ['/usr/bin/vim']
> ['/usr/bin', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2',
> ... more output ...
> '/var/lib/python-support/python2.5/pyinotify']

While this does provide a workaround for the issue, this is behavior
inherent in the way Python is designed and should be fixed in Python.
If we choose to instead address every application that embeds Python,
we're just creating an endless stream of work for ourselves.

From a quick check via Google's codesearch, at least X-Chat[3],
Gnumeric[4], python-nautilus[5], and gedit[6] are likely to have this
same problem.

N.B., most of the above projects use a single-element argv of the
project name.  This is no different than using a single-element argv of
"" since PySys_SetArgv attempts to resolve argv[0] to an absolute path
and uses "" when it is unable to do so.

[0] - <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=484305#51>
[1] - <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=484305#61>
[2] - "If there isn't a script that will be run, the first entry in argv
      can be an empty string."
      <http://docs.python.org/api/initialization.html#l2h-881>
[3] - <http://ln-s.net/27az>
[4] - <http://ln-s.net/27ay>
[5] - <http://ln-s.net/27b1>
[6] - <http://ln-s.net/27b9>
--
James
GPG Key: 1024D/61326D40 2003-09-02 James Vega <jamessan@debian.org>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=484305;filename=signature.asc;msg=78) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=484305;msg=80), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=80), [link](#79)).

---

**Acknowledgement sent** to `Robert Collins <robertc@robertcollins.net>`:

Extra info received and forwarded to list.
([full text](bugreport.cgi?bug=484305;msg=82), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=82), [link](#81)).

---

[Message #83](#83) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=484305;msg=83), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=83), reply):

![](/cgi-bin/libravatar.cgi?email=robertc%40robertcollins.net)
From: Robert Collins <robertc@robertcollins.net>
To: James Vega <jamessan@debian.org>, 484305@bugs.debian.org
Cc: Simon McVittie <smcv@debian.org>, 493937@bugs.debian.org, Nico Golde <nion@debian.org>, Steffen Joeris <steffen.joeris@skolelinux.de>
Subject: Re: Bug#484305: bicyclerepair: bike.vim imports untrusted python
files from cwd
Date: Wed, 06 Aug 2008 13:21:23 +1000
```
[[Message part 1](bugreport.cgi?att=0;bug=484305;msg=83) (text/plain, inline)]
```
```
On Tue, 2008-08-05 at 23:07 -0400, James Vega wrote:

> While this does provide a workaround for the issue, this is behavior
> inherent in the way Python is designed and should be fixed in Python.
> If we choose to instead address every application that embeds Python,
> we're just creating an endless stream of work for ourselves.

Possibly. I did file a bug [rejected] on reportbug itself just a few
days ago, because it also will load from . if '' is in the pythonpath.

OTOH perhaps having '' in sys.path is always wrong and we should start a
mass set of bugs to prevent it?

-Rob
--
GPG key available at: <<http://www.robertcollins.net/keys.txt>>.

```
```
[[signature.asc](bugreport.cgi?att=1;bug=484305;filename=signature.asc;msg=83) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
(Tue, 07 Oct 2008 15:06:02 GMT) ([full text](bugreport.cgi?bug=484305;msg=85), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=85), [link](#84)).

---

**Acknowledgement sent**
to `<marcos.marado@sonae.com>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
(Tue, 07 Oct 2008 15:06:02 GMT) ([full text](bugreport.cgi?bug=484305;msg=87), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=87), [link](#86)).

---

[Message #88](#88) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=484305;msg=88), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=88), reply):

![](/cgi-bin/libravatar.cgi?email=marcos.marado%40sonae.com)
From: <marcos.marado@sonae.com>
To: <484305@bugs.debian.org>
Subject: Fix python or the apps?
Date: Tue, 7 Oct 2008 16:00:49 +0100
```
Hi there,

It seems to me that there are two choices here:
1) this is considered a python issue, that should be solved in python;
2) this is considered an issue in the python apps that act like this (and
   as it was said, there's probably a handfull of them), and those should be
   solved in each of those apps.

Shouldn't we ask it to the Python Apps Packaging Team [1]?

[1] <http://wiki.debian.org/Teams/PythonAppsPackagingTeam>

Best regards,
--
Marcos Marado

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
(Tue, 07 Oct 2008 15:27:02 GMT) ([full text](bugreport.cgi?bug=484305;msg=90), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=90), [link](#89)).

---

**Acknowledgement sent**
to `<marcos.marado@sonae.com>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
(Tue, 07 Oct 2008 15:27:03 GMT) ([full text](bugreport.cgi?bug=484305;msg=92), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=92), [link](#91)).

---

[Message #93](#93) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=484305;msg=93), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=93), reply):

![](/cgi-bin/libravatar.cgi?email=marcos.marado%40sonae.com)
From: <marcos.marado@sonae.com>
To: <484305@bugs.debian.org>
Subject: Followup
Date: Tue, 7 Oct 2008 16:20:23 +0100
```
Hi there,

Just to add that I found out that this issue is being further discussed in
#499568 : <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=499568> .

Best Regards,
--
Marcos Marado

```

---

**Reply sent**
to `James Vega <jamessan@debian.org>`:

You have taken responsibility.
(Tue, 21 Oct 2008 17:21:03 GMT) ([full text](bugreport.cgi?bug=484305;msg=95), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=95), [link](#94)).

---

**Notification sent**
to `Thomas Arendsen Hein <thomas@intevation.de>`:

Bug acknowledged by developer.
(Tue, 21 Oct 2008 17:21:03 GMT) ([full text](bugreport.cgi?bug=484305;msg=97), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=97), [link](#96)).

---

[Message #98](#98) received at 484305-done@bugs.debian.org ([full text](bugreport.cgi?bug=484305;msg=98), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=98), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James Vega <jamessan@debian.org>
To: marcos.marado@sonae.com, 484305-done@bugs.debian.org
Subject: Re: Bug#484305: Fix python or the apps?
Date: Tue, 21 Oct 2008 13:19:53 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=484305;msg=98) (text/plain, inline)]
```
```
On Tue, Oct 07, 2008 at 04:00:49PM +0100, marcos.marado@sonae.com wrote:
> It seems to me that there are two choices here:
> 1) this is considered a python issue, that should be solved in python;

This problem should be solved in 2.6 since absolute imports are the
default.

> 2) this is considered an issue in the python apps that act like this (and
>    as it was said, there's probably a handfull of them), and those should be
>    solved in each of those apps.

I'm currently looking through the various source packages which provide
a binary that uses PySys_SetArgv and investigating whether they're
affected by this problem.  If so, I'll be filing bug reports (with
patches).

> Shouldn't we ask it to the Python Apps Packaging Team [1]?

This isn't specifically related to PAPT as most of the affected
applications aren't actually Python applications, but applications
embedding Python.

As far as bicyclerepair is concerned, this bug can be closed (and I'm
doing so with this message) now that the Vim packages remove the empty
directory from sys.path.

--
James
GPG Key: 1024D/61326D40 2003-09-02 James Vega <jamessan@debian.org>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=484305;filename=signature.asc;msg=98) (application/pgp-signature, inline)]
```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Wed, 19 Nov 2008 07:26:05 GMT) ([full text](bugreport.cgi?bug=484305;msg=100), [mbox](bugreport.cgi?bug=484305;mbox=yes;msg=100), [link](#99)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=484305).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 15:12:34 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from bugs.debian.org_7e63ddd2_20250125_151239.html ===

# Debian Bug report logs - #493937 bicyclerepair: bike.vim imports untrusted python files from cwd

[![version graph](version.cgi?width=2;collapse=1;height=2;absolute=0;package=vim-python;fixed=vim%2F1%3A7.1.314-3%2Blenny2;fixed=vim%2F2%3A7.2.025-2)](version.cgi?collapse=1;info=1;absolute=0;fixed=vim%2F1%3A7.1.314-3%2Blenny2;fixed=vim%2F2%3A7.2.025-2;package=vim-python)

Package:
[vim-python](pkgreport.cgi?package=vim-python);
Maintainer for [vim-python](pkgreport.cgi?package=vim-python) is [(unknown)](pkgreport.cgi?maint=);

Reported by: [Thomas Arendsen Hein <thomas@intevation.de>](pkgreport.cgi?submitter=thomas%40intevation.de)

Date: Tue, 3 Jun 2008 15:42:02 UTC

Severity: important

Tags: security

Fixed in versions vim/1:7.1.314-3+lenny2, vim/2:7.2.025-2

**Done:** James Vega <jamessan@debian.org>

Bug is archived. No further changes may be made.

Forwarded to Bram Moolenaar <Bram@moolenaar.net>

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=493937;mbox=yes), [status mbox](bugreport.cgi?bug=493937;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=493937;mbox=yes;mboxmaint=yes)

---

**Report forwarded** to `debian-bugs-dist@lists.debian.org, Debian Security Team <team@security.debian.org>, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=493937;msg=2), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent** to `Thomas Arendsen Hein <thomas@intevation.de>`:

New Bug report received and forwarded. Copy sent to `Debian Security Team <team@security.debian.org>, Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=493937;msg=4), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=5), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=thomas%40intevation.de)
From: Thomas Arendsen Hein <thomas@intevation.de>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: bicyclerepair: bike.vim imports untrusted python files from cwd
Date: Tue, 3 Jun 2008 17:40:03 +0200
```
Package: bicyclerepair
Version: 0.9-4.1
Severity: critical
Tags: security
Justification: root security hole

# pwd
/tmp/roundup-1.3.3/roundup
# vim /tmp/whatever
Error detected while processing /usr/share/vim/addons/plugin/bike.vim:
line  110:
Traceback (most recent call last):
  File "<string>", line 6, in ?
  File "/usr/lib/python2.4/site-packages/bike/__init__.py", line 10, in ?
    from bikefacade import init, NotAPythonModuleOrPackageException, CouldntLoca
teASTNodeFromCoordinatesException, UndoStackEmptyException
  File "/usr/lib/python2.4/site-packages/bike/bikefacade.py", line 3, in ?
    import compiler
  File "__init__.py", line 24, in ?

  File "compiler/transformer.py", line 1348, in ?
AttributeError: 'module' object has no attribute 'LESS'
Press ENTER or type command to continue

bicyclerepair contains /usr/share/vim/addons/plugin/bike.vim which is
automatically executed, at least in etch. I don't know about lenny/sid,
see #464817 (bicyclerepair: Conform with Vim addon policy)

It imports (i.e. runs) python code it finds in the current working
directory, in my example from the extracted roundup tarball.

I set Severity to "critical" instead of "grave", because the user who
reported the traceback to me on a multi-user system does not use
bicyclerepair, but just vim. Reportbug forced me to set "root security
hole", because everyone using vim is affected (including root) and
the Justification 5 "unknown / something else" would downgrade the
Severity to "normal". The description for "grave" said, that it only
applies if the security problem affects people actually using the package.

-- System Information:
Debian Release: 4.0
  APT prefers stable
  APT policy: (500, 'stable')
Architecture: i386 (i686)
Shell:  /bin/sh linked to /bin/bash
Kernel: Linux 2.6.24.3-id1-k8-2
Locale: LANG=en_US, LC_CTYPE=de_DE@euro (charmap=ISO-8859-15)

Versions of packages bicyclerepair depends on:
ii  python                        2.4.4-2    An interactive high-level object-o
ii  python-central                0.5.12     register and build utility for Pyt

bicyclerepair recommends no packages.

-- no debconf information

--
thomas@intevation.de - <http://intevation.de/~thomas/> - OpenPGP key: 0x5816791A
Intevation GmbH, Osnabrueck - Register: Amtsgericht Osnabrueck, HR B 18998
Geschaeftsfuehrer: Frank Koormann, Bernhard Reiter, Dr. Jan-Oliver Wagner

```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=493937;msg=7), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent** to `Steffen Joeris <steffen.joeris@skolelinux.de>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=493937;msg=9), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=10), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=steffen.joeris%40skolelinux.de)
From: Steffen Joeris <steffen.joeris@skolelinux.de>
To: 484305@bugs.debian.org
Cc: control@bugs.debian.org
Subject: PoC not working for bicyclerepair
Date: Sun, 6 Jul 2008 11:04:13 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=493937;msg=10) (text/plain, inline)]
```
```
severity 484305 important
thanks

Hi

I have troubles reproducing your problem and I've tried an etch and a lenny
chroot.

white@security:/tmp/roundup-1.2.1/roundup$ pwd
/tmp/roundup-1.2.1/roundup
white@security:/tmp/roundup-1.2.1/roundup$ vim /tmp/foo
white@security:/tmp/roundup-1.2.1/roundup$ apt-cache policy bicyclerepair
bicyclerepair:
  Installed: 0.9-4.1
  Candidate: 0.9-4.1
  Version table:
 *** 0.9-4.1 0
        500 <http://ftp.no.debian.org> etch/main Packages
        100 /var/lib/dpkg/status

and

white@security:/tmp/roundup-1.4.4/roundup$ pwd
/tmp/roundup-1.4.4/roundup
white@security:/tmp/roundup-1.4.4/roundup$ vim /tmp/foo
white@security:/tmp/roundup-1.4.4/roundup$ apt-cache policy bicyclerepair
bicyclerepair:
  Installed: 0.9-4.2
  Candidate: 0.9-4.2
  Version table:
 *** 0.9-4.2 0
        500 <http://ftp.no.debian.org> lenny/main Packages
        100 /var/lib/dpkg/status

Also, I can't find /usr/share/vim/addons/plugin/bike.vim. The package
bicyclerepair only contains /usr/share/vim/addons/ftplugin/python_bike.vim,
however I am not so firm with vim plugins after all.
I am using a standard vim config file.

Cheers
Steffen

```
```
[[signature.asc](bugreport.cgi?att=1;bug=493937;filename=signature.asc;msg=10) (application/pgp-signature, inline)]
```

---

**Severity set to `important' from `critical'**
Request was from `Steffen Joeris <steffen.joeris@skolelinux.de>`
to `control@bugs.debian.org`.
(Sun, 06 Jul 2008 09:06:03 GMT) ([full text](bugreport.cgi?bug=493937;msg=12), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=12), [link](#11)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=493937;msg=14), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=14), [link](#13)).

---

**Acknowledgement sent** to `Thomas Arendsen Hein <thomas@intevation.de>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=493937;msg=16), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=16), [link](#15)).

---

[Message #17](#17) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=17), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=17), reply):

![](/cgi-bin/libravatar.cgi?email=thomas%40intevation.de)
From: Thomas Arendsen Hein <thomas@intevation.de>
To: Steffen Joeris <steffen.joeris@skolelinux.de>
Cc: 484305@bugs.debian.org, control@bugs.debian.org
Subject: Re: PoC not working for bicyclerepair
Date: Sun, 6 Jul 2008 22:24:57 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=493937;msg=17) (text/plain, inline)]
```
```
severity 484305 critical
thanks

* Steffen Joeris <steffen.joeris@skolelinux.de> [20080706 11:15]:
> severity 484305 important
> thanks

Please do not downgrade severity without providing a reason. As I
wrote in my original report, this should not be less than "grave":

| I set Severity to "critical" instead of "grave", because the user who
| reported the traceback to me on a multi-user system does not use
| bicyclerepair, but just vim. Reportbug forced me to set "root security
| hole", because everyone using vim is affected (including root) and
| the Justification 5 "unknown / something else" would downgrade the
| Severity to "normal". The description for "grave" said, that it only
| applies if the security problem affects people actually using the package.

> I have troubles reproducing your problem and I've tried an etch and a lenny
> chroot.
>
> white@security:/tmp/roundup-1.2.1/roundup$ pwd
> /tmp/roundup-1.2.1/roundup
> white@security:/tmp/roundup-1.2.1/roundup$ vim /tmp/foo
> white@security:/tmp/roundup-1.2.1/roundup$ apt-cache policy bicyclerepair
> bicyclerepair:
>   Installed: 0.9-4.1
>   Candidate: 0.9-4.1
>   Version table:
>  *** 0.9-4.1 0
>         500 <http://ftp.no.debian.org> etch/main Packages
>         100 /var/lib/dpkg/status
>
> Also, I can't find /usr/share/vim/addons/plugin/bike.vim. The package
> bicyclerepair only contains /usr/share/vim/addons/ftplugin/python_bike.vim,
> however I am not so firm with vim plugins after all.
> I am using a standard vim config file.

On etch:

$ dpkg -l bicyclerepair|grep ^i
ii  bicyclerepair       0.9-4.1             A refactoring tool for python

$ dpkg -L bicyclerepair|grep vim
/usr/share/doc/bicyclerepair/README.vim
/usr/share/vim
/usr/share/vim/vim62
/usr/share/vim/vim62/plugin
/usr/share/vim/vim62/plugin/bike.vim
/usr/share/vim/vim63
/usr/share/vim/vim63/plugin
/usr/share/vim/vim63/plugin/bike.vim
/usr/share/vim/addons
/usr/share/vim/addons/plugin
/usr/share/vim/addons/plugin/bike.vim

Maybe (I haven't verified) you need:
/etc/alternatives/vim -> /usr/bin/vim.python

On lenny the plugin is indeed stored in
/usr/share/vim/addons/ftplugin/python_bike.vim

Regards,
Thomas

--
thomas@intevation.de - <http://intevation.de/~thomas/> - OpenPGP key: 0x5816791A
Intevation GmbH, Osnabrueck - Register: Amtsgericht Osnabrueck, HR B 18998
Geschaeftsfuehrer: Frank Koormann, Bernhard Reiter, Dr. Jan-Oliver Wagner

```
```
[[Message part 2](bugreport.cgi?att=1;bug=493937;msg=17) (application/pgp-signature, inline)]
```

---

**Severity set to `critical' from `important'**
Request was from `Thomas Arendsen Hein <thomas@intevation.de>`
to `control@bugs.debian.org`.
(Sun, 06 Jul 2008 20:30:10 GMT) ([full text](bugreport.cgi?bug=493937;msg=19), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=19), [link](#18)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=493937;msg=21), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=21), [link](#20)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=493937;msg=23), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=23), [link](#22)).

---

[Message #24](#24) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=24), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=24), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: Thomas Arendsen Hein <thomas@intevation.de>, 484305@bugs.debian.org
Cc: Steffen Joeris <steffen.joeris@skolelinux.de>, control@bugs.debian.org,
pkg-vim-maintainers@lists.alioth.debian.org
Subject: Re: Bug#484305: PoC not working for bicyclerepair
Date: Mon, 7 Jul 2008 19:11:10 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=493937;msg=24) (text/plain, inline)]
```
```
severity 484305 grave
thanks

Hi Thomas,
* Thomas Arendsen Hein <thomas@intevation.de> [2008-07-06 22:53]:
> * Steffen Joeris <steffen.joeris@skolelinux.de> [20080706 11:15]:
> > severity 484305 important
> > thanks
>
> Please do not downgrade severity without providing a reason.

"critical makes unrelated software on the system (or the whole system)
break, or causes serious data loss, or introduces a security
hole on systems where you install the package."

I had a look at the issue now and this is not the case
because you have to a) install vim-python and bicyclerepair
together and b) set vim.python as the vim alternative.
Thus downgrading this bug.

> As I
> wrote in my original report, this should not be less than "grave":
>
> | I set Severity to "critical" instead of "grave", because the user who
> | reported the traceback to me on a multi-user system does not use
> | bicyclerepair, but just vim. Reportbug forced me to set "root security
> | hole", because everyone using vim is affected (including root) and
> | the Justification 5 "unknown / something else" would downgrade the
> | Severity to "normal".

I think that this is more like a user security hole because
the security issue itself doesn't automatically result in
root access. root security hole fit better to issues
included in a daemon running as root for example. But I
doubt discussing this gets us anywhere and I personally
don't care about this tag in this case :)

[...]
> On etch:
>
> $ dpkg -l bicyclerepair|grep ^i
> ii  bicyclerepair       0.9-4.1             A refactoring tool for python
>
> $ dpkg -L bicyclerepair|grep vim
> /usr/share/doc/bicyclerepair/README.vim
> /usr/share/vim
> /usr/share/vim/vim62
> /usr/share/vim/vim62/plugin
> /usr/share/vim/vim62/plugin/bike.vim
> /usr/share/vim/vim63
> /usr/share/vim/vim63/plugin
> /usr/share/vim/vim63/plugin/bike.vim
> /usr/share/vim/addons
> /usr/share/vim/addons/plugin
> /usr/share/vim/addons/plugin/bike.vim
>
> Maybe (I haven't verified) you need:
> /etc/alternatives/vim -> /usr/bin/vim.python

Indeed, this is needed (+ installation of vim-python).
So to sum up you need to install vim-python and set the
alternative to vim.python. I am not sure about the status of
this in unstable, at least I could not reproduce this on
unstable but vim.python is also no longer available there,
a lot in the vim structure changed since then and I don't
really have an idea about the scripting support of vim.

That's why I Cc'ed the vim maintainers. Do you think this
should also work in the same way in unstable/testing?
I am also not really sure what is causing the automatic
import.

To reproduce this on stable:
cd /tmp && apt-get source roundup && roundup-1.2.1/roundup/
apt-get install vim-python bicyclerepair
update-alternatives --set vim /usr/bin/vim.python
and edit some random file (e.g. vim /tmp/foobar).

I found out that the file that causes this is token.py in
the roundup sources. Another way to reproduce this would be
to create a file named fcntl:

cat >> fcntl.py << EOF
print "FOOOOBAR"
EOF

This file is also automatically imported besides the files
bike.py, compiler.py, parser.py, symbol.py, token.py, struct.py
cStringIO.py, dis.py, opcode.py, new.py, re.py, sre.py
sre_compile.py, sre_constants.py, sre_parse.py, __future__.py
string.py, strop.py, tempfile.py, random.py, math.py, binascii.py
_random.py and fcntl.py

Something should prepend '.' to syspath but I don't see
anything doing this :/

Kind regards
Nico
--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=493937;msg=24) (application/pgp-signature, inline)]
```

---

**Severity set to `grave' from `critical'**
Request was from `Nico Golde <nion@debian.org>`
to `control@bugs.debian.org`.
(Mon, 07 Jul 2008 17:15:06 GMT) ([full text](bugreport.cgi?bug=493937;msg=26), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=26), [link](#25)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=493937;msg=28), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=28), [link](#27)).

---

**Acknowledgement sent** to `James Vega <jamessan@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=493937;msg=30), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=30), [link](#29)).

---

[Message #31](#31) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=31), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=31), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James Vega <jamessan@debian.org>
To: Nico Golde <nion@debian.org>
Cc: Thomas Arendsen Hein <thomas@intevation.de>, 484305@bugs.debian.org,
pkg-vim-maintainers@lists.alioth.debian.org,
Steffen Joeris <steffen.joeris@skolelinux.de>
Subject: Re: Bug#484305: PoC not working for bicyclerepair
Date: Mon, 7 Jul 2008 14:10:37 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=493937;msg=31) (text/plain, inline)]
```
```
On Mon, Jul 07, 2008 at 07:11:10PM +0200, Nico Golde wrote:
> Hi Thomas,
> * Thomas Arendsen Hein <thomas@intevation.de> [2008-07-06 22:53]:
> > * Steffen Joeris <steffen.joeris@skolelinux.de> [20080706 11:15]:
> > > severity 484305 important
> > > thanks
> >
> > Please do not downgrade severity without providing a reason.
>
> "critical makes unrelated software on the system (or the whole system)
> break, or causes serious data loss, or introduces a security
> hole on systems where you install the package."
>
> I had a look at the issue now and this is not the case
> because you have to a) install vim-python and bicyclerepair
> together and b) set vim.python as the vim alternative.
> Thus downgrading this bug.

In Lenny/Sid, all Vim packages except vim-tiny and vim contain the
python support, so it is more likely that a user will have a vim binary
that can be scripted via Python.

On the other hand, in Lenny/Sid the path that plugins used to be
installed to (/usr/share/vim/addons) is no longer automatically included
in Vim's runtimepath.  This means that manual work is required to enable
the plugin.

> [...]
> > On etch:
> >
> > $ dpkg -l bicyclerepair|grep ^i
> > ii  bicyclerepair       0.9-4.1             A refactoring tool for python
> >
> > $ dpkg -L bicyclerepair|grep vim
> > /usr/share/doc/bicyclerepair/README.vim
> > /usr/share/vim
> > /usr/share/vim/vim62
> > /usr/share/vim/vim62/plugin
> > /usr/share/vim/vim62/plugin/bike.vim
> > /usr/share/vim/vim63
> > /usr/share/vim/vim63/plugin
> > /usr/share/vim/vim63/plugin/bike.vim
> > /usr/share/vim/addons
> > /usr/share/vim/addons/plugin
> > /usr/share/vim/addons/plugin/bike.vim
> >
> > Maybe (I haven't verified) you need:
> > /etc/alternatives/vim -> /usr/bin/vim.python
>
> Indeed, this is needed (+ installation of vim-python).
> So to sum up you need to install vim-python and set the
> alternative to vim.python. I am not sure about the status of
> this in unstable, at least I could not reproduce this on
> unstable but vim.python is also no longer available there,
> a lot in the vim structure changed since then and I don't
> really have an idea about the scripting support of vim.
>
> That's why I Cc'ed the vim maintainers. Do you think this
> should also work in the same way in unstable/testing?

See above explanation.

Also, taking a look at the current bicyclerepair package, the addon is
now installed to /usr/share/addons/vim/ftplugin/python_bike.vim.  This
means that the functionality will only be used when editing python files
(once the user has enabled the plugin) instead of when editing any file,
as was the case when it was installed to plugins/bike.vim.

> I am also not really sure what is causing the automatic
> import.

Python, by default, has '' as the initial item in its sys.path list

  $ python
  Python 2.5.2 (r252:60911, Jun 25 2008, 17:58:32)
  [GCC 4.3.1] on linux2
  Type "help", "copyright", "credits" or "license" for more information.
  >>> import sys
  >>> sys.path
  ['', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages/Numeric', '/usr/lib/python2.5/site-packages/gst-0.10', '/var/lib/python-support/python2.5', '/var/lib/python-support/python2.5/gtk-2.0']

This means that anything in the current directory is first priority when
trying to use/import a module.

/usr/lib/pythonX.Y/compiler/transformer.py has the following lines that
are run when the module is imported

  import token
  ...
  _cmp_types = {
      token.LESS : '<',
      token.GREATER : '>',
      token.EQEQUAL : '==',
      token.EQUAL : '==',
      token.LESSEQUAL : '<=',
      token.GREATEREQUAL : '>=',
      token.NOTEQUAL : '!=',
      }

When the bike Vim plugin is loaded, it imports the bike python module,
which imports compiler (and therefore compiler.transformer).  Since
Vim's current working directory is roundup-X.Y/roundup, the above lines
from transformer.py combined with '' being the first item in sys.path
cause python to load the token module in the current working directory
(from roundup's source) instead of using /usr/lib/pythonX.Y/token.py.

--
James
GPG Key: 1024D/61326D40 2003-09-02 James Vega <jamessan@debian.org>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=493937;filename=signature.asc;msg=31) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=493937;msg=33), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=33), [link](#32)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=493937;msg=35), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=35), [link](#34)).

---

[Message #36](#36) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=36), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=36), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: Thomas Arendsen Hein <thomas@intevation.de>, 484305@bugs.debian.org,
pkg-vim-maintainers@lists.alioth.debian.org,
Steffen Joeris <steffen.joeris@skolelinux.de>
Subject: Re: Bug#484305: PoC not working for bicyclerepair
Date: Mon, 7 Jul 2008 21:16:21 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=493937;msg=36) (text/plain, inline)]
```
```
Hi James,
* James Vega <jamessan@debian.org> [2008-07-07 20:11]:
> On Mon, Jul 07, 2008 at 07:11:10PM +0200, Nico Golde wrote:
> > * Thomas Arendsen Hein <thomas@intevation.de> [2008-07-06 22:53]:
> > > * Steffen Joeris <steffen.joeris@skolelinux.de> [20080706 11:15]:
[...]
> In Lenny/Sid, all Vim packages except vim-tiny and vim contain the
> python support, so it is more likely that a user will have a vim binary
> that can be scripted via Python.
>
> On the other hand, in Lenny/Sid the path that plugins used to be
> installed to (/usr/share/vim/addons) is no longer automatically included
> in Vim's runtimepath.  This means that manual work is required to enable
> the plugin.

Ok, thanks for this information!

[...]
> > That's why I Cc'ed the vim maintainers. Do you think this
> > should also work in the same way in unstable/testing?
>
> See above explanation.
>
> Also, taking a look at the current bicyclerepair package, the addon is
> now installed to /usr/share/addons/vim/ftplugin/python_bike.vim.  This
> means that the functionality will only be used when editing python files
> (once the user has enabled the plugin) instead of when editing any file,
> as was the case when it was installed to plugins/bike.vim.

Ok

> > I am also not really sure what is causing the automatic
> > import.
>
> Python, by default, has '' as the initial item in its sys.path list
>
>   $ python
>   Python 2.5.2 (r252:60911, Jun 25 2008, 17:58:32)
>   [GCC 4.3.1] on linux2
>   Type "help", "copyright", "credits" or "license" for more information.
>   >>> import sys
>   >>> sys.path
>   ['', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages/Numeric', '/usr/lib/python2.5/site-packages/gst-0.10', '/var/lib/python-support/python2.5', '/var/lib/python-support/python2.5/gtk-2.0']
>
> This means that anything in the current directory is first priority when
> trying to use/import a module.

This should only happen in an interactive session, not!?
nion@coredump:/tmp$] mkdir somedir
[nion@coredump:/tmp$] cd somedir
[nion@coredump:somedir$] cat > /tmp/test.py << EOF
heredoc> import sys
heredoc> print sys.path
heredoc> EOF
[nion@coredump:somedir$] python /tmp/test.py
['/tmp', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages/Numeric', '/usr/lib/python2.5/site-packages/PIL', '/var/lib/python-support/python2.5', '/var/lib/python-support/python2.5/gtk-2.0', '/usr/lib/python2.5/site-packages/wx-2.6-gtk2-unicode']

The python docs also state "As initialized upon program startup, the first item
of this list, path[0], is the directory containing the script that was used to
invoke the Python interpreter."
So this should be no problem unless I missed your point.

> /usr/lib/pythonX.Y/compiler/transformer.py has the following lines that
> are run when the module is imported
>
>   import token
>   ...
>   _cmp_types = {
>       token.LESS : '<',
>       token.GREATER : '>',
>       token.EQEQUAL : '==',
>       token.EQUAL : '==',
>       token.LESSEQUAL : '<=',
>       token.GREATEREQUAL : '>=',
>       token.NOTEQUAL : '!=',
>       }
>
> When the bike Vim plugin is loaded, it imports the bike python module,
> which imports compiler (and therefore compiler.transformer).  Since
> Vim's current working directory is roundup-X.Y/roundup, the above lines
> from transformer.py combined with '' being the first item in sys.path
> cause python to load the token module in the current working directory
> (from roundup's source) instead of using /usr/lib/pythonX.Y/token.py.

I'd agree if that would be the case in a python script, I had this thought
as well first but this doesn't seem to work. That's why I said that I don't
see something like sys.path = [os.curdir] + sys.path in the code.

Did I misunderstand what you wrote?

Thanks for your help James!
Cheers
Nico
--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=493937;msg=36) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=493937;msg=38), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=38), [link](#37)).

---

**Acknowledgement sent** to `James Vega <jamessan@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=493937;msg=40), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=40), [link](#39)).

---

[Message #41](#41) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=41), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=41), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James Vega <jamessan@debian.org>
To: Nico Golde <nion@debian.org>
Cc: Thomas Arendsen Hein <thomas@intevation.de>, 484305@bugs.debian.org,
pkg-vim-maintainers@lists.alioth.debian.org,
Steffen Joeris <steffen.joeris@skolelinux.de>
Subject: Re: Bug#484305: PoC not working for bicyclerepair
Date: Mon, 7 Jul 2008 16:03:53 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=493937;msg=41) (text/plain, inline)]
```
```
On Mon, Jul 07, 2008 at 09:16:21PM +0200, Nico Golde wrote:
> Hi James,
> * James Vega <jamessan@debian.org> [2008-07-07 20:11]:
> > On Mon, Jul 07, 2008 at 07:11:10PM +0200, Nico Golde wrote:
> > > I am also not really sure what is causing the automatic
> > > import.
> >
> > Python, by default, has '' as the initial item in its sys.path list
> >
> >   $ python
> >   Python 2.5.2 (r252:60911, Jun 25 2008, 17:58:32)
> >   [GCC 4.3.1] on linux2
> >   Type "help", "copyright", "credits" or "license" for more information.
> >   >>> import sys
> >   >>> sys.path
> >   ['', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages/Numeric', '/usr/lib/python2.5/site-packages/gst-0.10', '/var/lib/python-support/python2.5', '/var/lib/python-support/python2.5/gtk-2.0']
> >
> > This means that anything in the current directory is first priority when
> > trying to use/import a module.
>
> This should only happen in an interactive session, not!?
> nion@coredump:/tmp$] mkdir somedir
> [nion@coredump:/tmp$] cd somedir
> [nion@coredump:somedir$] cat > /tmp/test.py << EOF
> heredoc> import sys
> heredoc> print sys.path
> heredoc> EOF
> [nion@coredump:somedir$] python /tmp/test.py
> ['/tmp', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages/Numeric', '/usr/lib/python2.5/site-packages/PIL', '/var/lib/python-support/python2.5', '/var/lib/python-support/python2.5/gtk-2.0', '/usr/lib/python2.5/site-packages/wx-2.6-gtk2-unicode']
>
> The python docs also state "As initialized upon program startup, the first item
> of this list, path[0], is the directory containing the script that was used to
> invoke the Python interpreter."

In an interactive session, sys.path[0] is '' because the "script" is
simply the python interpreter.  In your example, if you were in /tmp
when you ran test.py you would have seen '' as sys.path[0] as well.

In the case of Vim, sys.path[0] is always Vim's current working
directory.

/tmp $ mkdir somedir
/tmp $ cat test.vim
function! ShowPath()
    python << EOF
import os
import sys
print os.getcwd()
print repr(sys.path[0])
EOF
endfunction
call ShowPath()
cd somedir
call ShowPath()
q
/tmp $ python -S test.vim
/tmp
''
/tmp/somedir
''

From what I can tell, every time the :python command (which is simply a
thin wrapper to the PyRun_SimpleString function from Python's library)
is run from Vim, it's like running a new script.

This would explain why why sys.path[0] and os.getcwd() are updated when
we change the current working directory of the Vim process.

--
James
GPG Key: 1024D/61326D40 2003-09-02 James Vega <jamessan@debian.org>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=493937;filename=signature.asc;msg=41) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=493937;msg=43), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=43), [link](#42)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=493937;msg=45), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=45), [link](#44)).

---

[Message #46](#46) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=46), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=46), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: Thomas Arendsen Hein <thomas@intevation.de>, 484305@bugs.debian.org,
pkg-vim-maintainers@lists.alioth.debian.org,
Steffen Joeris <steffen.joeris@skolelinux.de>
Subject: Re: Bug#484305: PoC not working for bicyclerepair
Date: Mon, 7 Jul 2008 22:15:44 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=493937;msg=46) (text/plain, inline)]
```
```
Hi James,
* James Vega <jamessan@debian.org> [2008-07-07 22:04]:
> On Mon, Jul 07, 2008 at 09:16:21PM +0200, Nico Golde wrote:
> > * James Vega <jamessan@debian.org> [2008-07-07 20:11]:
> > > On Mon, Jul 07, 2008 at 07:11:10PM +0200, Nico Golde wrote:
[...]
> > [nion@coredump:somedir$] python /tmp/test.py
> > ['/tmp', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages/Numeric', '/usr/lib/python2.5/site-packages/PIL', '/var/lib/python-support/python2.5', '/var/lib/python-support/python2.5/gtk-2.0', '/usr/lib/python2.5/site-packages/wx-2.6-gtk2-unicode']
> >
> > The python docs also state "As initialized upon program startup, the first item
> > of this list, path[0], is the directory containing the script that was used to
> > invoke the Python interpreter."
>
> In an interactive session, sys.path[0] is '' because the "script" is
> simply the python interpreter.  In your example, if you were in /tmp
> when you ran test.py you would have seen '' as sys.path[0] as well.

Yes sure that conforms to the quote from the python docs.

> In the case of Vim, sys.path[0] is always Vim's current working
> directory.
[...]
> From what I can tell, every time the :python command (which is simply a
> thin wrapper to the PyRun_SimpleString function from Python's library)
> is run from Vim, it's like running a new script.
>
> This would explain why why sys.path[0] and os.getcwd() are updated when
> we change the current working directory of the Vim process.

Ok, that explains why this happens. This is somehow bad
because everyone who writes a python vim script needs to be
aware of that.

Can you think of a better solution than the following?
--- /usr/share/vim/addons/plugin/bike.vim       2008-07-07 22:14:28.000000000 +0200
+++ bike.vim.new        2008-07-07 22:14:26.000000000 +0200
@@ -100,6 +100,7 @@
 try:
     if sys.version_info < (2, 2):
         raise ImportError, 'Bicycle Repair Man needs Python 2.2 or newer'
+    sys.path.remove('')
     import bike
     bikectx = bike.init()
     bikectx.isLoaded        # make sure bike package is recent enough

Kind regards
Nico
--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=493937;msg=46) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=493937;msg=48), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=48), [link](#47)).

---

**Acknowledgement sent** to `James Vega <jamessan@jamessan.com>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=493937;msg=50), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=50), [link](#49)).

---

[Message #51](#51) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=51), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=51), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40jamessan.com)
From: James Vega <jamessan@jamessan.com>
To: Nico Golde <nion@debian.org>
Cc: Thomas Arendsen Hein <thomas@intevation.de>, 484305@bugs.debian.org,
pkg-vim-maintainers@lists.alioth.debian.org,
Steffen Joeris <steffen.joeris@skolelinux.de>
Subject: Re: Bug#484305: PoC not working for bicyclerepair
Date: Mon, 7 Jul 2008 17:40:22 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=493937;msg=51) (text/plain, inline)]
```
```
On Mon, Jul 07, 2008 at 10:15:44PM +0200, Nico Golde wrote:
> Can you think of a better solution than the following?
> --- /usr/share/vim/addons/plugin/bike.vim       2008-07-07 22:14:28.000000000 +0200
> +++ bike.vim.new        2008-07-07 22:14:26.000000000 +0200
> @@ -100,6 +100,7 @@
>  try:
>      if sys.version_info < (2, 2):
>          raise ImportError, 'Bicycle Repair Man needs Python 2.2 or newer'
> +    sys.path.remove('')
>      import bike
>      bikectx = bike.init()
>      bikectx.isLoaded        # make sure bike package is recent enough

I think this is being addressed from the wrong perspective.  This is a
Python problem.  Performing "import compiler", where compiler is a
module in the std-lib and performs its own import of another std-lib
module should not cause the module in the user's working directory to be
imported instead.

As evidenced by PEP 328[0] and PEP 366[1], this is an acknowledged
problem upstream and they're working to address it.  As for what that
means for the current bug, this is something that python users have to
deal with when they have a file whose name conflicts with one in the
std-lib.  This also means that the *only* time users will run into
issues like this are specifically when they have a filename in Vim's
working directory that conflicts with the name of a Python module.

[0] - <http://www.python.org/dev/peps/pep-0328/>
[1] - <http://www.python.org/dev/peps/pep-0366/>
--
James
GPG Key: 1024D/61326D40 2003-09-02 James Vega <jamessan@debian.org>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=493937;filename=signature.asc;msg=51) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=493937;msg=53), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=53), [link](#52)).

---

**Acknowledgement sent** to `Nico Golde <nion@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=493937;msg=55), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=55), [link](#54)).

---

[Message #56](#56) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=56), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=56), reply):

![](/cgi-bin/libravatar.cgi?email=nion%40debian.org)
From: Nico Golde <nion@debian.org>
To: Thomas Arendsen Hein <thomas@intevation.de>, 484305@bugs.debian.org,
pkg-vim-maintainers@lists.alioth.debian.org,
Steffen Joeris <steffen.joeris@skolelinux.de>
Subject: Re: Bug#484305: PoC not working for bicyclerepair
Date: Tue, 8 Jul 2008 22:18:46 +0200
```
[[Message part 1](bugreport.cgi?att=0;bug=493937;msg=56) (text/plain, inline)]
```
```
Hi James,
* James Vega <jamessan@jamessan.com> [2008-07-07 23:42]:
> On Mon, Jul 07, 2008 at 10:15:44PM +0200, Nico Golde wrote:
> > Can you think of a better solution than the following?
> > --- /usr/share/vim/addons/plugin/bike.vim       2008-07-07 22:14:28.000000000 +0200
> > +++ bike.vim.new        2008-07-07 22:14:26.000000000 +0200
> > @@ -100,6 +100,7 @@
> >  try:
> >      if sys.version_info < (2, 2):
> >          raise ImportError, 'Bicycle Repair Man needs Python 2.2 or newer'
> > +    sys.path.remove('')
> >      import bike
> >      bikectx = bike.init()
> >      bikectx.isLoaded        # make sure bike package is recent enough
>
> I think this is being addressed from the wrong perspective.

Yes I agree, I would also be not really happy about this
solution as all module writes would need to be aware of this
problem.

> This is a Python problem.  Performing "import compiler", where compiler is a
> module in the std-lib and performs its own import of another std-lib
> module should not cause the module in the user's working directory to be
> imported instead.
>
> As evidenced by PEP 328[0] and PEP 366[1], this is an acknowledged
> problem upstream and they're working to address it.  As for what that
> means for the current bug, this is something that python users have to
> deal with when they have a file whose name conflicts with one in the
> std-lib.  This also means that the *only* time users will run into
> issues like this are specifically when they have a filename in Vim's
> working directory that conflicts with the name of a Python module.

Do you think reassigning this to python would be
appropriate?

Thanks for the PEP links, I wasn't aware of them.

Kind regards
Nico
--
Nico Golde - <http://www.ngolde.de> - nion@jabber.ccc.de - GPG: 0x73647CFF
For security reasons, all text in this mail is double-rot13 encrypted.

```
```
[[Message part 2](bugreport.cgi?att=1;bug=493937;msg=56) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=493937;msg=58), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=58), [link](#57)).

---

**Acknowledgement sent** to `James Vega <jamessan@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=493937;msg=60), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=60), [link](#59)).

---

[Message #61](#61) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=61), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=61), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James Vega <jamessan@debian.org>
To: Nico Golde <nion@debian.org>
Cc: Thomas Arendsen Hein <thomas@intevation.de>, 484305@bugs.debian.org,
pkg-vim-maintainers@lists.alioth.debian.org,
Steffen Joeris <steffen.joeris@skolelinux.de>
Subject: Re: Bug#484305: PoC not working for bicyclerepair
Date: Tue, 8 Jul 2008 16:51:25 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=493937;msg=61) (text/plain, inline)]
```
```
On Tue, Jul 08, 2008 at 10:18:46PM +0200, Nico Golde wrote:
> Hi James,
> * James Vega <jamessan@jamessan.com> [2008-07-07 23:42]:
> > On Mon, Jul 07, 2008 at 10:15:44PM +0200, Nico Golde wrote:
> > > Can you think of a better solution than the following?
> > > --- /usr/share/vim/addons/plugin/bike.vim       2008-07-07 22:14:28.000000000 +0200
> > > +++ bike.vim.new        2008-07-07 22:14:26.000000000 +0200
> > > @@ -100,6 +100,7 @@
> > >  try:
> > >      if sys.version_info < (2, 2):
> > >          raise ImportError, 'Bicycle Repair Man needs Python 2.2 or newer'
> > > +    sys.path.remove('')
> > >      import bike
> > >      bikectx = bike.init()
> > >      bikectx.isLoaded        # make sure bike package is recent enough
> >
> > I think this is being addressed from the wrong perspective.
>
> Yes I agree, I would also be not really happy about this
> solution as all module writes would need to be aware of this
> problem.
>
> > This is a Python problem.  Performing "import compiler", where compiler is a
> > module in the std-lib and performs its own import of another std-lib
> > module should not cause the module in the user's working directory to be
> > imported instead.
> >
> > As evidenced by PEP 328[0] and PEP 366[1], this is an acknowledged
> > problem upstream and they're working to address it.  As for what that
> > means for the current bug, this is something that python users have to
> > deal with when they have a file whose name conflicts with one in the
> > std-lib.  This also means that the *only* time users will run into
> > issues like this are specifically when they have a filename in Vim's
> > working directory that conflicts with the name of a Python module.
>
> Do you think reassigning this to python would be
> appropriate?

That would probably be a better place for it, yes.  I definitely don't
think it's a bug in Vim or the specific Vim script and I'm unsure
whether it's truly a bug in Python or just less-than-ideal behavior.
Even with the listed PEPs implemented, it sounds like this behavior is
still possible, just not as likely.

--
James
GPG Key: 1024D/61326D40 2003-09-02 James Vega <jamessan@debian.org>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=493937;filename=signature.asc;msg=61) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Robert Collins <robertc@robertcollins.net>`:

`Bug#484305`; Package `bicyclerepair`.
([full text](bugreport.cgi?bug=493937;msg=63), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=63), [link](#62)).

---

**Acknowledgement sent** to `Simon McVittie <smcv@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Robert Collins <robertc@robertcollins.net>`.
([full text](bugreport.cgi?bug=493937;msg=65), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=65), [link](#64)).

---

[Message #66](#66) received at 484305@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=66), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=66), reply):

![](/cgi-bin/libravatar.cgi?email=smcv%40debian.org)
From: Simon McVittie <smcv@debian.org>
To: 484305@bugs.debian.org
Cc: control@bugs.debian.org
Subject: Re: Bug#484305: bicyclerepair: bike.vim imports untrusted python
files from cwd
Date: Wed, 6 Aug 2008 01:39:15 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=493937;msg=66) (text/plain, inline)]
```
```
clone 484305 -1
reassign -1 vim-python
thanks

Shouldn't Python builds of vim avoid this bug by stopping '' from being
prepended to sys.path in the first place?

After looking through Python initialization and vim's if_python.c it
seems that the way forward is to set Python's argv, via PySys_SetArgv(),
to have a non-empty and absolute first argument.

vim sets Python's argv to  { "", NULL }, which according to a comment is to
avoid a crash when warn() is called. Changing that to { "/usr/bin/vim", NULL }
would seem to solve this problem - but for that matter, any safe value is fine.

A safe value for argv[0] is any value where there won't be files dir/*.py or
dir/*/__init__.py, where dir == dirname(argv[0]). So setting argv[0] to
"/", "/usr/lib/something" or "/usr/share/vim" would be safe too, for instance.

I'm afraid I haven't tested this in vim itself (the multiple builds take a
while...) but the attached program demonstrates it:

smcv@carbon% gcc -o484305 `python-config --cflags` `python-config --ldflags` 484305.c
smcv@carbon% ./484305
(I have no argv!)
['/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2',
... more output ...
'/var/lib/python-support/python2.5/pyinotify']
smcv@carbon% ./484305 ""
['']
['', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2',
... more output ...
'/var/lib/python-support/python2.5/pyinotify']
smcv@carbon% ./484305 "/usr/bin/vim"
['/usr/bin/vim']
['/usr/bin', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2',
... more output ...
'/var/lib/python-support/python2.5/pyinotify']

Hope this helps,
    Simon

```
```
[[484305.c](bugreport.cgi?att=1;bug=493937;filename=484305.c;msg=66) (text/x-csrc, attachment)]
```

---

**Bug [484305](bugreport.cgi?bug=484305) cloned as bug [493937](bugreport.cgi?bug=493937).**
Request was from `Simon McVittie <smcv@debian.org>`
to `control@bugs.debian.org`.
(Wed, 06 Aug 2008 00:42:02 GMT) ([full text](bugreport.cgi?bug=493937;msg=68), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=68), [link](#67)).

---

**Bug reassigned from package `[bicyclerepair](pkgreport.cgi?package=bicyclerepair)' to `[vim-python](pkgreport.cgi?package=vim-python)'.**
Request was from `Simon McVittie <smcv@debian.org>`
to `control@bugs.debian.org`.
(Wed, 06 Aug 2008 00:42:04 GMT) ([full text](bugreport.cgi?bug=493937;msg=70), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=70), [link](#69)).

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`:

`Bug#493937`; Package `vim-python`.
([full text](bugreport.cgi?bug=493937;msg=72), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=72), [link](#71)).

---

**Acknowledgement sent** to `James Vega <jamessan@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`.
([full text](bugreport.cgi?bug=493937;msg=74), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=74), [link](#73)).

---

[Message #75](#75) received at 493937@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=75), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=75), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James Vega <jamessan@debian.org>
To: Simon McVittie <smcv@debian.org>, 484305@bugs.debian.org
Cc: 493937@bugs.debian.org, Nico Golde <nion@debian.org>,
Steffen Joeris <steffen.joeris@skolelinux.de>
Subject: Re: Bug#484305: bicyclerepair: bike.vim imports untrusted python
files from cwd
Date: Tue, 5 Aug 2008 23:07:48 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=493937;msg=75) (text/plain, inline)]
```
```
On Wed, Aug 06, 2008 at 01:39:15AM +0100, Simon McVittie wrote:
> Shouldn't Python builds of vim avoid this bug by stopping '' from being
> prepended to sys.path in the first place?

As I mentioned earlier[0][1] in the bug log, I don't think removing ''
from sys.argv is the correct change to make in Vim.

> After looking through Python initialization and vim's if_python.c it
> seems that the way forward is to set Python's argv, via PySys_SetArgv(),
> to have a non-empty and absolute first argument.
>
> vim sets Python's argv to  { "", NULL }, which according to a comment is to
> avoid a crash when warn() is called. Changing that to { "/usr/bin/vim", NULL }
> would seem to solve this problem - but for that matter, any safe value is fine.

The way Vim is using PySys_SetArgv (and therefore the resulting
behavior) is exactly following the recommended use of PySys_SetArgv
according to upstream's documentation[2].

> A safe value for argv[0] is any value where there won't be files dir/*.py or
> dir/*/__init__.py, where dir == dirname(argv[0]). So setting argv[0] to
> "/", "/usr/lib/something" or "/usr/share/vim" would be safe too, for instance.
>
> I'm afraid I haven't tested this in vim itself (the multiple builds take a
> while...) but the attached program demonstrates it:
>
> smcv@carbon% gcc -o484305 `python-config --cflags` `python-config --ldflags` 484305.c
> smcv@carbon% ./484305
> (I have no argv!)
> ['/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2',
> ... more output ...
> '/var/lib/python-support/python2.5/pyinotify']
> smcv@carbon% ./484305 ""
> ['']
> ['', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2',
> ... more output ...
> '/var/lib/python-support/python2.5/pyinotify']
> smcv@carbon% ./484305 "/usr/bin/vim"
> ['/usr/bin/vim']
> ['/usr/bin', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2',
> ... more output ...
> '/var/lib/python-support/python2.5/pyinotify']

While this does provide a workaround for the issue, this is behavior
inherent in the way Python is designed and should be fixed in Python.
If we choose to instead address every application that embeds Python,
we're just creating an endless stream of work for ourselves.

From a quick check via Google's codesearch, at least X-Chat[3],
Gnumeric[4], python-nautilus[5], and gedit[6] are likely to have this
same problem.

N.B., most of the above projects use a single-element argv of the
project name.  This is no different than using a single-element argv of
"" since PySys_SetArgv attempts to resolve argv[0] to an absolute path
and uses "" when it is unable to do so.

[0] - <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=484305#51>
[1] - <http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=484305#61>
[2] - "If there isn't a script that will be run, the first entry in argv
      can be an empty string."
      <http://docs.python.org/api/initialization.html#l2h-881>
[3] - <http://ln-s.net/27az>
[4] - <http://ln-s.net/27ay>
[5] - <http://ln-s.net/27b1>
[6] - <http://ln-s.net/27b9>
--
James
GPG Key: 1024D/61326D40 2003-09-02 James Vega <jamessan@debian.org>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=493937;filename=signature.asc;msg=75) (application/pgp-signature, inline)]
```

---

**Information forwarded** to `debian-bugs-dist@lists.debian.org, Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`:

`Bug#493937`; Package `vim-python`.
([full text](bugreport.cgi?bug=493937;msg=77), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=77), [link](#76)).

---

**Acknowledgement sent** to `Robert Collins <robertc@robertcollins.net>`:

Extra info received and forwarded to list. Copy sent to `Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`.
([full text](bugreport.cgi?bug=493937;msg=79), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=79), [link](#78)).

---

[Message #80](#80) received at 493937@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=80), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=80), reply):

![](/cgi-bin/libravatar.cgi?email=robertc%40robertcollins.net)
From: Robert Collins <robertc@robertcollins.net>
To: James Vega <jamessan@debian.org>, 484305@bugs.debian.org
Cc: Simon McVittie <smcv@debian.org>, 493937@bugs.debian.org, Nico Golde <nion@debian.org>, Steffen Joeris <steffen.joeris@skolelinux.de>
Subject: Re: Bug#484305: bicyclerepair: bike.vim imports untrusted python
files from cwd
Date: Wed, 06 Aug 2008 13:21:23 +1000
```
[[Message part 1](bugreport.cgi?att=0;bug=493937;msg=80) (text/plain, inline)]
```
```
On Tue, 2008-08-05 at 23:07 -0400, James Vega wrote:

> While this does provide a workaround for the issue, this is behavior
> inherent in the way Python is designed and should be fixed in Python.
> If we choose to instead address every application that embeds Python,
> we're just creating an endless stream of work for ourselves.

Possibly. I did file a bug [rejected] on reportbug itself just a few
days ago, because it also will load from . if '' is in the pythonpath.

OTOH perhaps having '' in sys.path is always wrong and we should start a
mass set of bugs to prevent it?

-Rob
--
GPG key available at: <<http://www.robertcollins.net/keys.txt>>.

```
```
[[signature.asc](bugreport.cgi?att=1;bug=493937;filename=signature.asc;msg=80) (application/pgp-signature, inline)]
```

---

**Severity set to `important' from `grave'**
Request was from `James Vega <jamessan@debian.org>`
to `control@bugs.debian.org`.
(Tue, 23 Sep 2008 19:03:03 GMT) ([full text](bugreport.cgi?bug=493937;msg=82), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=82), [link](#81)).

---

**Reply sent**
to `James Vega <jamessan@debian.org>`:

You have taken responsibility.
(Fri, 17 Oct 2008 21:33:05 GMT) ([full text](bugreport.cgi?bug=493937;msg=84), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=84), [link](#83)).

---

**Notification sent**
to `Thomas Arendsen Hein <thomas@intevation.de>`:

Bug acknowledged by developer.
(Fri, 17 Oct 2008 21:33:47 GMT) ([full text](bugreport.cgi?bug=493937;msg=86), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=86), [link](#85)).

---

[Message #87](#87) received at 493937-close@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=87), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=87), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James Vega <jamessan@debian.org>
To: 493937-close@bugs.debian.org
Subject: Bug#493937: fixed in vim 1:7.1.314-3+lenny2
Date: Fri, 17 Oct 2008 21:02:41 +0000
```
Source: vim
Source-Version: 1:7.1.314-3+lenny2

We believe that the bug you reported is fixed in the latest version of
vim, which is due to be installed in the Debian FTP archive:

vim-common_7.1.314-3+lenny2_i386.deb
  to pool/main/v/vim/vim-common_7.1.314-3+lenny2_i386.deb
vim-dbg_7.1.314-3+lenny2_i386.deb
  to pool/main/v/vim/vim-dbg_7.1.314-3+lenny2_i386.deb
vim-doc_7.1.314-3+lenny2_all.deb
  to pool/main/v/vim/vim-doc_7.1.314-3+lenny2_all.deb
vim-full_7.1.314-3+lenny2_all.deb
  to pool/main/v/vim/vim-full_7.1.314-3+lenny2_all.deb
vim-gnome_7.1.314-3+lenny2_i386.deb
  to pool/main/v/vim/vim-gnome_7.1.314-3+lenny2_i386.deb
vim-gtk_7.1.314-3+lenny2_i386.deb
  to pool/main/v/vim/vim-gtk_7.1.314-3+lenny2_i386.deb
vim-gui-common_7.1.314-3+lenny2_all.deb
  to pool/main/v/vim/vim-gui-common_7.1.314-3+lenny2_all.deb
vim-lesstif_7.1.314-3+lenny2_i386.deb
  to pool/main/v/vim/vim-lesstif_7.1.314-3+lenny2_i386.deb
vim-nox_7.1.314-3+lenny2_i386.deb
  to pool/main/v/vim/vim-nox_7.1.314-3+lenny2_i386.deb
vim-perl_7.1.314-3+lenny2_all.deb
  to pool/main/v/vim/vim-perl_7.1.314-3+lenny2_all.deb
vim-python_7.1.314-3+lenny2_all.deb
  to pool/main/v/vim/vim-python_7.1.314-3+lenny2_all.deb
vim-ruby_7.1.314-3+lenny2_all.deb
  to pool/main/v/vim/vim-ruby_7.1.314-3+lenny2_all.deb
vim-runtime_7.1.314-3+lenny2_all.deb
  to pool/main/v/vim/vim-runtime_7.1.314-3+lenny2_all.deb
vim-tcl_7.1.314-3+lenny2_all.deb
  to pool/main/v/vim/vim-tcl_7.1.314-3+lenny2_all.deb
vim-tiny_7.1.314-3+lenny2_i386.deb
  to pool/main/v/vim/vim-tiny_7.1.314-3+lenny2_i386.deb
vim_7.1.314-3+lenny2.diff.gz
  to pool/main/v/vim/vim_7.1.314-3+lenny2.diff.gz
vim_7.1.314-3+lenny2.dsc
  to pool/main/v/vim/vim_7.1.314-3+lenny2.dsc
vim_7.1.314-3+lenny2_i386.deb
  to pool/main/v/vim/vim_7.1.314-3+lenny2_i386.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 493937@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
James Vega <jamessan@debian.org> (supplier of updated vim package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Fri, 17 Oct 2008 10:58:00 -0400
Source: vim
Binary: vim-common vim-gui-common vim-runtime vim-doc vim-tiny vim vim-dbg vim-perl vim-python vim-ruby vim-tcl vim-gtk vim-nox vim-lesstif vim-gnome vim-full
Architecture: source all i386
Version: 1:7.1.314-3+lenny2
Distribution: testing-proposed-updates
Urgency: low
Maintainer: Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>
Changed-By: James Vega <jamessan@debian.org>
Description:
 vim        - Vi IMproved - enhanced vi editor
 vim-common - Vi IMproved - Common files
 vim-dbg    - Vi IMproved - enhanced vi editor (debugging symbols)
 vim-doc    - Vi IMproved - HTML documentation
 vim-full   - Vi IMproved - enhanced vi editor (transitional package)
 vim-gnome  - Vi IMproved - enhanced vi editor - with GNOME2 GUI
 vim-gtk    - Vi IMproved - enhanced vi editor - with GTK2 GUI
 vim-gui-common - Vi IMproved - Common GUI files
 vim-lesstif - Vi IMproved - enhanced vi editor - with LessTif GUI
 vim-nox    - Vi IMproved - enhanced vi editor
 vim-perl   - Vi IMproved - enhanced vi editor (transitional package)
 vim-python - Vi IMproved - enhanced vi editor (transitional package)
 vim-ruby   - Vi IMproved - enhanced vi editor (transitional package)
 vim-runtime - Vi IMproved - Runtime files
 vim-tcl    - Vi IMproved - enhanced vi editor (transitional package)
 vim-tiny   - Vi IMproved - enhanced vi editor - compact version
Closes: [493937](bugreport.cgi?bug=493937)
Changes:
 vim (1:7.1.314-3+lenny2) testing-proposed-updates; urgency=low
 .
   * src/if_python.c: Strip empty directories from Python's sys.path to prevent
     Vim from using its current working directory as a module import path.
     (Closes: #[493937](bugreport.cgi?bug=493937))
Checksums-Sha1:
 e1eb91d7c003dbca7a80d486dc66d3ca817990f4 1726 vim_7.1.314-3+lenny2.dsc
 3dd0b8aebbac4e4a1cc70c4a673d1b088965ccde 378498 vim_7.1.314-3+lenny2.diff.gz
 3cf7c4f2c8358c61563586e1cb5031bc3aeb873c 159836 vim-gui-common_7.1.314-3+lenny2_all.deb
 304c785e2c34a21bb38d0f29165700ed4e06bbcb 5594756 vim-runtime_7.1.314-3+lenny2_all.deb
 307bf72162291a4afc1b2276cda0f055069f4069 2151992 vim-doc_7.1.314-3+lenny2_all.deb
 c70e748a649ecf3a423ff19a999900fc4ee1b91b 75312 vim-perl_7.1.314-3+lenny2_all.deb
 9705fa3fe512aab99e6c1098fd0d7ba831c981d8 75318 vim-python_7.1.314-3+lenny2_all.deb
 be476f34e1e7cde3c79523bb4c4d9cc346a433dc 75314 vim-ruby_7.1.314-3+lenny2_all.deb
 44b237673263a5c8f3d1b405434f93fe62d16da3 75310 vim-tcl_7.1.314-3+lenny2_all.deb
 29e2cfd11b7ed0dd946958f47db041e909fd3395 75344 vim-full_7.1.314-3+lenny2_all.deb
 80da23bb7394e5543201690af3c8845e58576d3e 334966 vim-tiny_7.1.314-3+lenny2_i386.deb
 17c1cf84016536d49098409094777a9ac27588dd 994194 vim-gtk_7.1.314-3+lenny2_i386.deb
 6d90a9dfb631d8f4a21b9c59eecb0c5c7e881bce 996140 vim-gnome_7.1.314-3+lenny2_i386.deb
 4ec7e36283b596d2764a322ce7758114b7030a15 986582 vim-lesstif_7.1.314-3+lenny2_i386.deb
 099124132d1a4ad6530471d1d152d074722c8d6d 863142 vim-nox_7.1.314-3+lenny2_i386.deb
 85f33faf19141a2c90b8ffed4e8d9f5a5001a6d2 208160 vim-common_7.1.314-3+lenny2_i386.deb
 8ebebf40b542cf909c62c2b88785d22c07f289c1 776664 vim_7.1.314-3+lenny2_i386.deb
 ee3ab387145da9a367f7947cca1d1be2095191c8 8381078 vim-dbg_7.1.314-3+lenny2_i386.deb
Checksums-Sha256:
 64e1caa7078c871fe47300bdda79407a8be04812dccd527144593054b644578f 1726 vim_7.1.314-3+lenny2.dsc
 dcf59e4e9f306115794a6fbf18fccc04a999abb8300c418db816c3a30df16864 378498 vim_7.1.314-3+lenny2.diff.gz
 a247beec34fbf6f276c5e9142944dd0a085c67df3d73f07dc0cb54fba04cf7cf 159836 vim-gui-common_7.1.314-3+lenny2_all.deb
 4f34be554c01848ed2b00f60efe2d8cc213ad619c78f25689c3702048b838e09 5594756 vim-runtime_7.1.314-3+lenny2_all.deb
 d7d3dd532648f7c32bc1c50e0e1a4270753b933e7b02d1f282b2c3550a2361a5 2151992 vim-doc_7.1.314-3+lenny2_all.deb
 50b47d8f8020ba4d6904c9716174c4f31e11d40a0dfa9066a8b502d5c864e4a5 75312 vim-perl_7.1.314-3+lenny2_all.deb
 089c633e396fe48b0e4832f9b4dc7a9d63ad22cc32741b7fbd5bb4805c8a9d4e 75318 vim-python_7.1.314-3+lenny2_all.deb
 6b89f454a0781120ecdb0a201fae09af025541037ebe5cb9568418f148627c6d 75314 vim-ruby_7.1.314-3+lenny2_all.deb
 4f0249094451003079cfc8e176751d72746e5bf6da29dfb87e838852123c8c0d 75310 vim-tcl_7.1.314-3+lenny2_all.deb
 199666191bd5400ab14d7d3da69f8392da4733ac83c70ed517291506493361eb 75344 vim-full_7.1.314-3+lenny2_all.deb
 da77cea0152fe86f784413dad1449f2b8912a10fac9e1265d8b3caa087d0b5f9 334966 vim-tiny_7.1.314-3+lenny2_i386.deb
 54cb69e0323d4729b1bdb6fc964b60a4d9503a18521b652ef20a3f11b0a78917 994194 vim-gtk_7.1.314-3+lenny2_i386.deb
 e4803c1118edb108529018c308abcb7c15e836670484cc3f3a92e2f46bcd3fc5 996140 vim-gnome_7.1.314-3+lenny2_i386.deb
 333416512585a9da0c05e0da76b80fd3cc99de872f3bc6880d842354aea0941c 986582 vim-lesstif_7.1.314-3+lenny2_i386.deb
 d84a1d9441d2bade2553c4e2d7389d49e17df7eb34fbc75ba635edafdc16197f 863142 vim-nox_7.1.314-3+lenny2_i386.deb
 4589f84fbd84ba01746c828ef8375e27c0963de13a6e88ac28f3556e9bb3ef68 208160 vim-common_7.1.314-3+lenny2_i386.deb
 6c896ce4a6ecf8814b339029847f94cf8ab32f53db7787c7d742a929480e228b 776664 vim_7.1.314-3+lenny2_i386.deb
 fa3b723c69331f539204595418a62e5caff2c5ebb6899f94a785ec775d1d3e8c 8381078 vim-dbg_7.1.314-3+lenny2_i386.deb
Files:
 710afba1b97650cf657e6965c9c0f7cc 1726 editors optional vim_7.1.314-3+lenny2.dsc
 ed6a94bf841c30bc4d7b39477df133cf 378498 editors optional vim_7.1.314-3+lenny2.diff.gz
 b4a0105bbdcc9de7749b2600ce9abf11 159836 editors optional vim-gui-common_7.1.314-3+lenny2_all.deb
 76b98e261d7034b47ed6a3fcb77718d6 5594756 editors optional vim-runtime_7.1.314-3+lenny2_all.deb
 af2015c9671b4a7e89eefb96302d02d6 2151992 doc optional vim-doc_7.1.314-3+lenny2_all.deb
 c502b71fdbdb9ace25f476dc259c1d4d 75312 editors extra vim-perl_7.1.314-3+lenny2_all.deb
 82c36481cafc07118e1ec09feb13798e 75318 editors extra vim-python_7.1.314-3+lenny2_all.deb
 037290fb800b7c6a05d4b69ed43f4ac8 75314 editors extra vim-ruby_7.1.314-3+lenny2_all.deb
 737a051974a3d1b3c23645dc660da48e 75310 editors extra vim-tcl_7.1.314-3+lenny2_all.deb
 3fb1ce09f8b97c7f706594358ae7513f 75344 editors extra vim-full_7.1.314-3+lenny2_all.deb
 f8a80e3e89bb4e1d9f6c5ed1bcda119a 334966 editors important vim-tiny_7.1.314-3+lenny2_i386.deb
 4f8291738a7ce8cf445b3afac264904d 994194 editors extra vim-gtk_7.1.314-3+lenny2_i386.deb
 b1b9fdd93026c9c2f2e610807167020a 996140 editors extra vim-gnome_7.1.314-3+lenny2_i386.deb
 6d32ae98d91f5ec679e3f824d6859b8d 986582 editors extra vim-lesstif_7.1.314-3+lenny2_i386.deb
 977419a826de800ce79a38cc91ce57a5 863142 editors extra vim-nox_7.1.314-3+lenny2_i386.deb
 2673594ec9851f4a18c6c7894afb1abe 208160 editors important vim-common_7.1.314-3+lenny2_i386.deb
 dd63be51e8deddf6425341aaa5f88ef5 776664 editors optional vim_7.1.314-3+lenny2_i386.deb
 720ca4bac095e296a0ccaa4660d24202 8381078 editors extra vim-dbg_7.1.314-3+lenny2_i386.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iEYEARECAAYFAkj43zgACgkQDb3UpmEybUD5vACbBgsXprqPXS3KviBfAD/7CsBI
obgAnRac282VshUbDcl4PgrmAAEXPDXi
=QMsa
-----END PGP SIGNATURE-----

```

---

**Reply sent**
to `James Vega <jamessan@debian.org>`:

You have taken responsibility.
(Mon, 20 Oct 2008 19:21:09 GMT) ([full text](bugreport.cgi?bug=493937;msg=89), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=89), [link](#88)).

---

**Notification sent**
to `Thomas Arendsen Hein <thomas@intevation.de>`:

Bug acknowledged by developer.
(Mon, 20 Oct 2008 19:21:09 GMT) ([full text](bugreport.cgi?bug=493937;msg=91), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=91), [link](#90)).

---

[Message #92](#92) received at 493937-close@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=92), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=92), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James Vega <jamessan@debian.org>
To: 493937-close@bugs.debian.org
Subject: Bug#493937: fixed in vim 2:7.2.025-2
Date: Mon, 20 Oct 2008 19:02:17 +0000
```
Source: vim
Source-Version: 2:7.2.025-2

We believe that the bug you reported is fixed in the latest version of
vim, which is due to be installed in the Debian FTP archive:

vim-common_7.2.025-2_i386.deb
  to pool/main/v/vim/vim-common_7.2.025-2_i386.deb
vim-dbg_7.2.025-2_i386.deb
  to pool/main/v/vim/vim-dbg_7.2.025-2_i386.deb
vim-doc_7.2.025-2_all.deb
  to pool/main/v/vim/vim-doc_7.2.025-2_all.deb
vim-full_7.2.025-2_all.deb
  to pool/main/v/vim/vim-full_7.2.025-2_all.deb
vim-gnome_7.2.025-2_i386.deb
  to pool/main/v/vim/vim-gnome_7.2.025-2_i386.deb
vim-gtk_7.2.025-2_i386.deb
  to pool/main/v/vim/vim-gtk_7.2.025-2_i386.deb
vim-gui-common_7.2.025-2_all.deb
  to pool/main/v/vim/vim-gui-common_7.2.025-2_all.deb
vim-lesstif_7.2.025-2_i386.deb
  to pool/main/v/vim/vim-lesstif_7.2.025-2_i386.deb
vim-nox_7.2.025-2_i386.deb
  to pool/main/v/vim/vim-nox_7.2.025-2_i386.deb
vim-perl_7.2.025-2_all.deb
  to pool/main/v/vim/vim-perl_7.2.025-2_all.deb
vim-python_7.2.025-2_all.deb
  to pool/main/v/vim/vim-python_7.2.025-2_all.deb
vim-ruby_7.2.025-2_all.deb
  to pool/main/v/vim/vim-ruby_7.2.025-2_all.deb
vim-runtime_7.2.025-2_all.deb
  to pool/main/v/vim/vim-runtime_7.2.025-2_all.deb
vim-tcl_7.2.025-2_all.deb
  to pool/main/v/vim/vim-tcl_7.2.025-2_all.deb
vim-tiny_7.2.025-2_i386.deb
  to pool/main/v/vim/vim-tiny_7.2.025-2_i386.deb
vim_7.2.025-2.diff.gz
  to pool/main/v/vim/vim_7.2.025-2.diff.gz
vim_7.2.025-2.dsc
  to pool/main/v/vim/vim_7.2.025-2.dsc
vim_7.2.025-2_i386.deb
  to pool/main/v/vim/vim_7.2.025-2_i386.deb

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 493937@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
James Vega <jamessan@debian.org> (supplier of updated vim package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Mon, 20 Oct 2008 12:13:42 -0400
Source: vim
Binary: vim-common vim-gui-common vim-runtime vim-doc vim-tiny vim vim-dbg vim-perl vim-python vim-ruby vim-tcl vim-gtk vim-nox vim-lesstif vim-gnome vim-full
Architecture: source i386 all
Version: 2:7.2.025-2
Distribution: unstable
Urgency: low
Maintainer: Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>
Changed-By: James Vega <jamessan@debian.org>
Description:
 vim        - Vi IMproved - enhanced vi editor
 vim-common - Vi IMproved - Common files
 vim-dbg    - Vi IMproved - enhanced vi editor (debugging symbols)
 vim-doc    - Vi IMproved - HTML documentation
 vim-full   - Vi IMproved - enhanced vi editor (transitional package)
 vim-gnome  - Vi IMproved - enhanced vi editor - with GNOME2 GUI
 vim-gtk    - Vi IMproved - enhanced vi editor - with GTK2 GUI
 vim-gui-common - Vi IMproved - Common GUI files
 vim-lesstif - Vi IMproved - enhanced vi editor - with LessTif GUI
 vim-nox    - Vi IMproved - enhanced vi editor
 vim-perl   - Vi IMproved - enhanced vi editor (transitional package)
 vim-python - Vi IMproved - enhanced vi editor (transitional package)
 vim-ruby   - Vi IMproved - enhanced vi editor (transitional package)
 vim-runtime - Vi IMproved - Runtime files
 vim-tcl    - Vi IMproved - enhanced vi editor (transitional package)
 vim-tiny   - Vi IMproved - enhanced vi editor - compact version
Closes: [493937](bugreport.cgi?bug=493937)
Changes:
 vim (2:7.2.025-2) unstable; urgency=low
 .
   * Remove "deprecated" warnings about (g)vimrc.local from /etc/vim/(g)vimrc.
   * src/if_python.c: Strip empty directories from Python's sys.path to prevent
     Vim from using its current working directory as a module import path.
     (Closes: #[493937](bugreport.cgi?bug=493937))
   * debian/rules: Do not run tests in parallel as that may interfere with
     their results.
Checksums-Sha1:
 dda410dc07b745a19890dcd6d69855ade2bd6e0b 1703 vim_7.2.025-2.dsc
 669a1bfc2b87af2da9e707658c433ddb7602e302 181366 vim_7.2.025-2.diff.gz
 7607c3d270cc3079c01f3c2d872aa17d6adab10a 999454 vim-gtk_7.2.025-2_i386.deb
 5d70f61c74e7e9b553c8449d47395e529549a146 1000972 vim-gnome_7.2.025-2_i386.deb
 f980c2944b50ad5ddd880ca2dba5ac6ddf83a8c7 868240 vim-nox_7.2.025-2_i386.deb
 b4a6667661a6826d088828424f05833acba89d0b 335102 vim-tiny_7.2.025-2_i386.deb
 1a356a17194a54d6653dc652293f736228e869ea 201310 vim-common_7.2.025-2_i386.deb
 17c97809b5a2bb5c68081775f294c315902d8995 781354 vim_7.2.025-2_i386.deb
 ac3e534cf90342f15826198035a5bec9462a794f 991844 vim-lesstif_7.2.025-2_i386.deb
 d15795017edac0dd7fd9b2909d7674327529700c 8417042 vim-dbg_7.2.025-2_i386.deb
 4749b4b8e8c89d2e956a1ce1e0eca3fffcb84f34 161718 vim-gui-common_7.2.025-2_all.deb
 feeeb56269f738fba476b5c378da5ce2032e0186 5991996 vim-runtime_7.2.025-2_all.deb
 b79fa1d43af98a010bf252b345ed42fd3758e3fe 1971726 vim-doc_7.2.025-2_all.deb
 42379cda62025d160596b9efd696d8935b42b0f6 77526 vim-perl_7.2.025-2_all.deb
 8e8a69b939fac74f62a5f7a0dbed5d5262c01eb4 77536 vim-python_7.2.025-2_all.deb
 fb932d0963189653d5d9db3f050cea1d398d2c74 77528 vim-ruby_7.2.025-2_all.deb
 ad60edf25ffab71b9ed04246df7e3b9f0f55f92e 77528 vim-tcl_7.2.025-2_all.deb
 135fe7d4453d9ec9f0331bba0037d7bfa28e88b2 77548 vim-full_7.2.025-2_all.deb
Checksums-Sha256:
 63aa66292caa640121478bf5a985da9bfad7938d87ba529e844ec1245757160b 1703 vim_7.2.025-2.dsc
 fd4239a9740eba3f699780f47777c6a05b6ede43a9062a88fd4a9212498fd4f7 181366 vim_7.2.025-2.diff.gz
 2974a7ef5bd154faf4ffa40546fdc9dc557361b19a48f2059a24179a71b7cffe 999454 vim-gtk_7.2.025-2_i386.deb
 b3dd66993389fdf8485476fcf2332006403efe121c87d8a3309a04940ea00de2 1000972 vim-gnome_7.2.025-2_i386.deb
 639afda0ce1a3f9487a070f707f0464c44405a78324d2d00319efb08b7ba747b 868240 vim-nox_7.2.025-2_i386.deb
 69776dacc8cc56f84f99a6ff56e82f9acde18349d2bf10b8f97de0589287ff12 335102 vim-tiny_7.2.025-2_i386.deb
 5ed97a57cbd2d3a722326076a08c947afa439691f012037c6cb8a1a0dcedc235 201310 vim-common_7.2.025-2_i386.deb
 5136a9de4cd9ea63a50673e5c6b13dce82fef8c2bd390070b79060491023fd70 781354 vim_7.2.025-2_i386.deb
 15873ceb2e3d960829b24c84558966a41dcc2cdeffda0f7dc9af8c6dd535a96e 991844 vim-lesstif_7.2.025-2_i386.deb
 dc36fe008ea662b428532ea89dca88f82a022e82abce1f1a118f8d77cd3c2981 8417042 vim-dbg_7.2.025-2_i386.deb
 fabbb695df7e449d69e41b90717817b4146dfe571bf0e178e9c707574059403f 161718 vim-gui-common_7.2.025-2_all.deb
 62cb2f32bede91d9a94956915ffd211f3aebeff54192cbd84e3de520a50eb279 5991996 vim-runtime_7.2.025-2_all.deb
 b13d8efb0596b4513a8687b53829634b11f6ff7e63ad840c38fccf7c29e46250 1971726 vim-doc_7.2.025-2_all.deb
 299e67262cd9d226177ce595ba285757638e7c3b319dbb35e246c0538282ed77 77526 vim-perl_7.2.025-2_all.deb
 50ad687b0fe4ab8e98d70a13d96d829102cdd44775187c01835060deb6de8a7e 77536 vim-python_7.2.025-2_all.deb
 d54153f3277b753c0e04975b868f90003945812c8b5da28a970a883f89769a12 77528 vim-ruby_7.2.025-2_all.deb
 60db22487a3d3f7ab5d0c7a5392d35ab660e5f832ff590b9a4c4a21b3f6faf2f 77528 vim-tcl_7.2.025-2_all.deb
 5a30126d0e534a35e18952822c23c9bf9f745f64c595688c5f525ffa72422dfe 77548 vim-full_7.2.025-2_all.deb
Files:
 a1dcda8a537ddc1d0eff71b372075394 1703 editors optional vim_7.2.025-2.dsc
 2cd03a6827cb9694529312db77f54a82 181366 editors optional vim_7.2.025-2.diff.gz
 d7ab5da374ccc2b0dba80796270949c8 999454 editors extra vim-gtk_7.2.025-2_i386.deb
 8d1a5a9334e258648dfe07c93d0b32e6 1000972 editors extra vim-gnome_7.2.025-2_i386.deb
 8e63582e4bb0057feffaa36958a9d631 868240 editors extra vim-nox_7.2.025-2_i386.deb
 213262ad35ebb1ef22dfd238f83b317f 335102 editors important vim-tiny_7.2.025-2_i386.deb
 96ad1405867376e1392a830679dfee12 201310 editors important vim-common_7.2.025-2_i386.deb
 9f426dac179d3872e969a3f601d9d957 781354 editors optional vim_7.2.025-2_i386.deb
 3adfdb41e47950d918cede6553d29128 991844 editors extra vim-lesstif_7.2.025-2_i386.deb
 7d2b5bbdaa0caed837e40fe39b643dc6 8417042 editors extra vim-dbg_7.2.025-2_i386.deb
 c36b7766e7311e39a4fef5e2afe8089b 161718 editors optional vim-gui-common_7.2.025-2_all.deb
 9d5ae3e8b1aaa263bd3fb6614854f01c 5991996 editors optional vim-runtime_7.2.025-2_all.deb
 b0eee745f0accc7a2113eb0bf4abca46 1971726 doc optional vim-doc_7.2.025-2_all.deb
 a4cc106429883e27122546671c908a06 77526 editors extra vim-perl_7.2.025-2_all.deb
 d0524d1a80791288d4400ffc3ca862d1 77536 editors extra vim-python_7.2.025-2_all.deb
 b48b4125a532852b126513b10ffebddc 77528 editors extra vim-ruby_7.2.025-2_all.deb
 5ff0de8c6f1ff2ac43940dff341d1453 77528 editors extra vim-tcl_7.2.025-2_all.deb
 ec95cc52923a9f2d9de7ed9d8f3ae108 77548 editors extra vim-full_7.2.025-2_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)

iEYEARECAAYFAkj8zjgACgkQDb3UpmEybUDojgCfWOs3YJZ/r+12JXo7W2r8a8QR
vl0An0mmDMeISARwm5GNPak3e4wLEGWs
=89Oc
-----END PGP SIGNATURE-----

```

---

**Reply sent**
to `James Vega <jamessan@debian.org>`:

You have marked Bug as forwarded.
(Mon, 03 Nov 2008 03:09:07 GMT) ([full text](bugreport.cgi?bug=493937;msg=94), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=94), [link](#93)).

---

[Message #95](#95) received at 493937-forwarded@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=95), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=95), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James Vega <jamessan@debian.org>
To: Bram Moolenaar <Bram@moolenaar.net>
Cc: 493937-forwarded@bugs.debian.org
Subject: [Patch] Prevent loading of Python modules in working directory
Date: Sun, 2 Nov 2008 22:05:16 -0500
```
[[Message part 1](bugreport.cgi?att=0;bug=493937;msg=95) (text/plain, inline)]
```
```
Bram,

Vim's python interface calls PySys_SetArgv with an argv[0] that doesn't
resolve to a filename.  This causes Python to prepend sys.path with an
empty string which, due to Python's use of relative imports, allows the
possibility to run arbitrary code on the user's system if a file in
Vim's working directory matches the name of a python module a
Python-using vim script tries to import.

This should be fixed by Python 2.6 as it uses absolute imports by
default, but I have not been able to test it.  The attached patch fixes
the problem in Vim by removing any empty strings from sys.path.

--
James
GPG Key: 1024D/61326D40 2003-09-02 James Vega <jamessan@debian.org>

```
```
[[sanitize_sys.path.diff](bugreport.cgi?att=1;bug=493937;filename=sanitize_sys.path.diff;msg=95) (text/x-diff, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=2;bug=493937;filename=signature.asc;msg=95) (application/pgp-signature, inline)]
```

---

[Message #96](#96) received at 493937-forwarded@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=96), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=96), reply):

![](/cgi-bin/libravatar.cgi?email=Bram%40moolenaar.net)
From: Bram Moolenaar <Bram@moolenaar.net>
To: James Vega <jamessan@debian.org>
Cc: 493937-forwarded@bugs.debian.org
Subject: Re: [Patch] Prevent loading of Python modules in working directory
Date: Mon, 03 Nov 2008 22:23:27 +0100
```

James -

> Bram,
>
> Vim's python interface calls PySys_SetArgv with an argv[0] that doesn't
> resolve to a filename.  This causes Python to prepend sys.path with an
> empty string which, due to Python's use of relative imports, allows the
> possibility to run arbitrary code on the user's system if a file in
> Vim's working directory matches the name of a python module a
> Python-using vim script tries to import.
>
> This should be fixed by Python 2.6 as it uses absolute imports by
> default, but I have not been able to test it.  The attached patch fixes
> the problem in Vim by removing any empty strings from sys.path.

This is a Python bug, right?  One should never add an empty entry to
sys.path.  And probably should not add a path relative to the executable
anyway.

Another solution would be to make the first argument to argv[] an
absolute path, e.g. "/".  Is there something against that?

- Bram

--
If Microsoft would build a car...
... the oil, water temperature, and alternator warning lights would
all be replaced by a single "General Protection Fault" warning light.

 /// Bram Moolenaar -- Bram@Moolenaar.net -- <http://www.Moolenaar.net>   \\\
///        sponsor Vim, vote for features -- <http://www.Vim.org/sponsor/> \\\
\\\        download, build and distribute -- <http://www.A-A-P.org>        ///
 \\\            help me help AIDS victims -- <http://ICCF-Holland.org>    ///

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`:

`Bug#493937`; Package `vim-python`.
(Mon, 03 Nov 2008 22:54:26 GMT) ([full text](bugreport.cgi?bug=493937;msg=98), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=98), [link](#97)).

---

**Acknowledgement sent**
to `James Vega <jamessan@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`.
(Mon, 03 Nov 2008 22:54:27 GMT) ([full text](bugreport.cgi?bug=493937;msg=100), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=100), [link](#99)).

---

[Message #101](#101) received at 493937@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=101), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=101), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James Vega <jamessan@debian.org>
To: Bram Moolenaar <Bram@moolenaar.net>
Cc: 493937@bugs.debian.org
Subject: Re: [Patch] Prevent loading of Python modules in working directory
Date: Mon, 3 Nov 2008 17:21:08 -0500
```
[[Message part 1](bugreport.cgi?att=0;bug=493937;msg=101) (text/plain, inline)]
```
```
On Mon, Nov 03, 2008 at 10:23:27PM +0100, Bram Moolenaar wrote:
>
> James -
>
> > Bram,
> >
> > Vim's python interface calls PySys_SetArgv with an argv[0] that doesn't
> > resolve to a filename.  This causes Python to prepend sys.path with an
> > empty string which, due to Python's use of relative imports, allows the
> > possibility to run arbitrary code on the user's system if a file in
> > Vim's working directory matches the name of a python module a
> > Python-using vim script tries to import.
> >
> > This should be fixed by Python 2.6 as it uses absolute imports by
> > default, but I have not been able to test it.  The attached patch fixes
> > the problem in Vim by removing any empty strings from sys.path.
>
> This is a Python bug, right?  One should never add an empty entry to
> sys.path.  And probably should not add a path relative to the executable
> anyway.

Yes, it is a Python bug but it's one that they chose to ignore.  The
code for PySys_SetArgv specifically adds the empty entry when it is not
able to resolve a filename (and therefore its parent directory).  The
default use of absolute imports in Python 2.6 (assuming that also
affects their C interface) will only workaround the issue of empty
entries in sys.path.

> Another solution would be to make the first argument to argv[] an
> absolute path, e.g. "/".  Is there something against that?

That still adds an unnecessary directory to sys.path.  In the case of
Vim, I think the safest measure is to remove the extra entry from
sys.path.  For other applications, where there is a directory from which
they want to load python plugins, it would make sense to add that
directory to sys.path.

--
James
GPG Key: 1024D/61326D40 2003-09-02 James Vega <jamessan@debian.org>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=493937;filename=signature.asc;msg=101) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`:

`Bug#493937`; Package `vim-python`.
(Tue, 04 Nov 2008 21:09:08 GMT) ([full text](bugreport.cgi?bug=493937;msg=103), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=103), [link](#102)).

---

**Acknowledgement sent**
to `Bram Moolenaar <Bram@moolenaar.net>`:

Extra info received and forwarded to list. Copy sent to `Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`.
(Tue, 04 Nov 2008 21:09:09 GMT) ([full text](bugreport.cgi?bug=493937;msg=105), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=105), [link](#104)).

---

[Message #106](#106) received at 493937@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=106), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=106), reply):

![](/cgi-bin/libravatar.cgi?email=Bram%40moolenaar.net)
From: Bram Moolenaar <Bram@moolenaar.net>
To: James Vega <jamessan@debian.org>
Cc: 493937@bugs.debian.org
Subject: Re: [Patch] Prevent loading of Python modules in working directory
Date: Tue, 04 Nov 2008 22:08:09 +0100
```

James -

> > > Vim's python interface calls PySys_SetArgv with an argv[0] that doesn't
> > > resolve to a filename.  This causes Python to prepend sys.path with an
> > > empty string which, due to Python's use of relative imports, allows the
> > > possibility to run arbitrary code on the user's system if a file in
> > > Vim's working directory matches the name of a python module a
> > > Python-using vim script tries to import.
> > >
> > > This should be fixed by Python 2.6 as it uses absolute imports by
> > > default, but I have not been able to test it.  The attached patch fixes
> > > the problem in Vim by removing any empty strings from sys.path.
> >
> > This is a Python bug, right?  One should never add an empty entry to
> > sys.path.  And probably should not add a path relative to the executable
> > anyway.
>
> Yes, it is a Python bug but it's one that they chose to ignore.  The
> code for PySys_SetArgv specifically adds the empty entry when it is not
> able to resolve a filename (and therefore its parent directory).  The
> default use of absolute imports in Python 2.6 (assuming that also
> affects their C interface) will only workaround the issue of empty
> entries in sys.path.
>
> > Another solution would be to make the first argument to argv[] an
> > absolute path, e.g. "/".  Is there something against that?
>
> That still adds an unnecessary directory to sys.path.  In the case of
> Vim, I think the safest measure is to remove the extra entry from
> sys.path.  For other applications, where there is a directory from which
> they want to load python plugins, it would make sense to add that
> directory to sys.path.

I suppose adding "/" won't break anything, but still isn't nice.
Your solution indeed looks like the best solution.

- Bram

--
The CIA drives around in cars with the "Intel inside" logo.

 /// Bram Moolenaar -- Bram@Moolenaar.net -- <http://www.Moolenaar.net>   \\\
///        sponsor Vim, vote for features -- <http://www.Vim.org/sponsor/> \\\
\\\        download, build and distribute -- <http://www.A-A-P.org>        ///
 \\\            help me help AIDS victims -- <http://ICCF-Holland.org>    ///

```

---

[Message #107](#107) received at 493937-forwarded@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=107), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=107), reply):

![](/cgi-bin/libravatar.cgi?email=Bram%40moolenaar.net)
From: Bram Moolenaar <Bram@moolenaar.net>
To: James Vega <jamessan@debian.org>
Cc: 493937-forwarded@bugs.debian.org
Subject: Re: [Patch] Prevent loading of Python modules in working directory
Date: Wed, 12 Nov 2008 12:34:16 +0100
```

James -

> Vim's python interface calls PySys_SetArgv with an argv[0] that doesn't
> resolve to a filename.  This causes Python to prepend sys.path with an
> empty string which, due to Python's use of relative imports, allows the
> possibility to run arbitrary code on the user's system if a file in
> Vim's working directory matches the name of a python module a
> Python-using vim script tries to import.
>
> This should be fixed by Python 2.6 as it uses absolute imports by
> default, but I have not been able to test it.  The attached patch fixes
> the problem in Vim by removing any empty strings from sys.path.

I have now applied and tried this patch.  It does not really work as
expected for me.  Apparently the empty string in argv[0] is interpreted
as the current directory.  My first entry in sys.path is then the
directory above the current directory.  The filter you added in the
patch doesn't change anything.

For me it does work if I use:

   static char *(argv[2]) = {"/must>not&exist/ls", NULL};

The first entry in path is then "/must>not&exist", which we can filter
out with:

   PyRun_SimpleString("import sys; sys.path = filter(lambda x: x != '/must>not&exist', sys.path)");

This is with Python 2.5.  I don't know about other versions...
Does this solution look OK to you?

- Bram

--
Google is kind of like Dr. Who's Tardis; it's wierder on the
inside than on the outside...

 /// Bram Moolenaar -- Bram@Moolenaar.net -- <http://www.Moolenaar.net>   \\\
///        sponsor Vim, vote for features -- <http://www.Vim.org/sponsor/> \\\
\\\        download, build and distribute -- <http://www.A-A-P.org>        ///
 \\\            help me help AIDS victims -- <http://ICCF-Holland.org>    ///

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`:

`Bug#493937`; Package `vim-python`.
(Wed, 12 Nov 2008 22:17:06 GMT) ([full text](bugreport.cgi?bug=493937;msg=109), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=109), [link](#108)).

---

**Acknowledgement sent**
to `James Vega <jamessan@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`.
(Wed, 12 Nov 2008 22:17:35 GMT) ([full text](bugreport.cgi?bug=493937;msg=111), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=111), [link](#110)).

---

[Message #112](#112) received at 493937@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=112), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=112), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James Vega <jamessan@debian.org>
To: Bram Moolenaar <Bram@moolenaar.net>
Cc: 493937@bugs.debian.org
Subject: Re: [Patch] Prevent loading of Python modules in working directory
Date: Wed, 12 Nov 2008 17:00:53 -0500
```
[[Message part 1](bugreport.cgi?att=0;bug=493937;msg=112) (text/plain, inline)]
```
```
On Wed, Nov 12, 2008 at 12:34:16PM +0100, Bram Moolenaar wrote:
>
> James -
>
> > Vim's python interface calls PySys_SetArgv with an argv[0] that doesn't
> > resolve to a filename.  This causes Python to prepend sys.path with an
> > empty string which, due to Python's use of relative imports, allows the
> > possibility to run arbitrary code on the user's system if a file in
> > Vim's working directory matches the name of a python module a
> > Python-using vim script tries to import.
> >
> > This should be fixed by Python 2.6 as it uses absolute imports by
> > default, but I have not been able to test it.  The attached patch fixes
> > the problem in Vim by removing any empty strings from sys.path.
>
> I have now applied and tried this patch.  It does not really work as
> expected for me.  Apparently the empty string in argv[0] is interpreted
> as the current directory.

argv[0] is used to seed the value that is prepended to sys.path.

You can take a look at what PySys_SetArgv does at
<http://svn.python.org/view/python/branches/release25-maint/Python/sysmodule.c?rev=54836&view=markup>

What it boils down to in the simple case is checking for the existence
of a path separator in argv0.  If that doesn't exist, then a PyString is
created from argv0 with size 0 and sys.path is prepended with that --
empty string used for the first element of sys.path.

> My first entry in sys.path is then the directory above the current
> directory.  The filter you added in the patch doesn't change anything.

This is incorrect.  In Vim's current code, PySys_SetArgv is called with
an argv that is simply an empty string (and a terminating NULL
sentinel).  This causes sys.path's first element to be the empty string,
thus causing any Python import statements to use Vim's current working
directory as the first location to check for the requested module.

The filter specifically removes any elements in sys.path that evaluate
to false (i.e., the empty string).

Using the attached print_sys.path.diff, the following is printed when I
start Vim (the sys.path before and after my suggested filter() command):

['', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages']
['/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages']

You can also test it with the simple pytest.c that I've attached by
specifying different arguments as the first element of the argv passed
to PySys_SetArgv.

$ gcc -o pytest $(python-config --cflags) $(python-config --ldflags) pytest.c
$ ./pytest ''
['', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages']
['/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages']
$ ./pytest '/must>not&exist/bogusbinary'
['/must>not&exist', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages']
['/must>not&exist', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages']

> For me it does work if I use:
>
>    static char *(argv[2]) = {"/must>not&exist/ls", NULL};
>
> The first entry in path is then "/must>not&exist", which we can filter
> out with:
>
>    PyRun_SimpleString("import sys; sys.path = filter(lambda x: x != '/must>not&exist', sys.path)");

This is just extra work for no gain.

--
James
GPG Key: 1024D/61326D40 2003-09-02 James Vega <jamessan@debian.org>

```
```
[[pytest.c](bugreport.cgi?att=1;bug=493937;filename=pytest.c;msg=112) (text/x-csrc, attachment)]
```
```
[[print_sys.path.diff](bugreport.cgi?att=2;bug=493937;filename=print_sys.path.diff;msg=112) (text/x-diff, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=3;bug=493937;filename=signature.asc;msg=112) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`:

`Bug#493937`; Package `vim-python`.
(Thu, 13 Nov 2008 10:27:25 GMT) ([full text](bugreport.cgi?bug=493937;msg=114), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=114), [link](#113)).

---

**Acknowledgement sent**
to `Bram Moolenaar <Bram@moolenaar.net>`:

Extra info received and forwarded to list. Copy sent to `Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`.
(Thu, 13 Nov 2008 10:27:26 GMT) ([full text](bugreport.cgi?bug=493937;msg=116), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=116), [link](#115)).

---

[Message #117](#117) received at 493937@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=117), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=117), reply):

![](/cgi-bin/libravatar.cgi?email=Bram%40moolenaar.net)
From: Bram Moolenaar <Bram@moolenaar.net>
To: James Vega <jamessan@debian.org>
Cc: 493937@bugs.debian.org
Subject: Re: [Patch] Prevent loading of Python modules in working directory
Date: Thu, 13 Nov 2008 11:23:07 +0100
```

James -

> > > Vim's python interface calls PySys_SetArgv with an argv[0] that doesn't
> > > resolve to a filename.  This causes Python to prepend sys.path with an
> > > empty string which, due to Python's use of relative imports, allows the
> > > possibility to run arbitrary code on the user's system if a file in
> > > Vim's working directory matches the name of a python module a
> > > Python-using vim script tries to import.
> > >
> > > This should be fixed by Python 2.6 as it uses absolute imports by
> > > default, but I have not been able to test it.  The attached patch fixes
> > > the problem in Vim by removing any empty strings from sys.path.
> >
> > I have now applied and tried this patch.  It does not really work as
> > expected for me.  Apparently the empty string in argv[0] is interpreted
> > as the current directory.
>
> argv[0] is used to seed the value that is prepended to sys.path.
>
> You can take a look at what PySys_SetArgv does at
> <http://svn.python.org/view/python/branches/release25-maint/Python/sysmodule.c?rev=54836&view=markup>
>
> What it boils down to in the simple case is checking for the existence
> of a path separator in argv0.  If that doesn't exist, then a PyString is
> created from argv0 with size 0 and sys.path is prepended with that --
> empty string used for the first element of sys.path.
>
> > My first entry in sys.path is then the directory above the current
> > directory.  The filter you added in the patch doesn't change anything.
>
> This is incorrect.  In Vim's current code, PySys_SetArgv is called with
> an argv that is simply an empty string (and a terminating NULL
> sentinel).  This causes sys.path's first element to be the empty string,
> thus causing any Python import statements to use Vim's current working
> directory as the first location to check for the requested module.
>
> The filter specifically removes any elements in sys.path that evaluate
> to false (i.e., the empty string).

That is not what happens for me.  Somehow somewhere the empty entry is
changed to the full path of the directory above the current directory.
I don't know where, but I see it happening.  I have tried this with:

	:py import sys
	:py print sys.path

> Using the attached print_sys.path.diff, the following is printed when I
> start Vim (the sys.path before and after my suggested filter() command):
>
> ['', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages']
> ['/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages']

As mentioned, for me the first entry is not '' but a path.   The filter
command you suggested doesn't remove it.  I don't know where the
difference between our systems comes from.

> You can also test it with the simple pytest.c that I've attached by
> specifying different arguments as the first element of the argv passed
> to PySys_SetArgv.
>
> $ gcc -o pytest $(python-config --cflags) $(python-config --ldflags) pytest.c
> $ ./pytest ''
> ['', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages']
> ['/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages']
> $ ./pytest '/must>not&exist/bogusbinary'
> ['/must>not&exist', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages']
> ['/must>not&exist', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages']
>
> > For me it does work if I use:
> >
> >    static char *(argv[2]) = {"/must>not&exist/ls", NULL};
> >
> > The first entry in path is then "/must>not&exist", which we can filter
> > out with:
> >
> >    PyRun_SimpleString("import sys; sys.path = filter(lambda x: x != '/must>not&exist', sys.path)");
>
> This is just extra work for no gain.

It does work for me.  Does it also work for you?

- Bram

--
hundred-and-one symptoms of being an internet addict:
249. You've forgotten what the outside looks like.

 /// Bram Moolenaar -- Bram@Moolenaar.net -- <http://www.Moolenaar.net>   \\\
///        sponsor Vim, vote for features -- <http://www.Vim.org/sponsor/> \\\
\\\        download, build and distribute -- <http://www.A-A-P.org>        ///
 \\\            help me help AIDS victims -- <http://ICCF-Holland.org>    ///

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`:

`Bug#493937`; Package `vim-python`.
(Thu, 13 Nov 2008 23:21:05 GMT) ([full text](bugreport.cgi?bug=493937;msg=119), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=119), [link](#118)).

---

**Acknowledgement sent**
to `James Vega <jamessan@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`.
(Thu, 13 Nov 2008 23:21:06 GMT) ([full text](bugreport.cgi?bug=493937;msg=121), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=121), [link](#120)).

---

[Message #122](#122) received at 493937@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=122), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=122), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: James Vega <jamessan@debian.org>
To: Bram Moolenaar <Bram@moolenaar.net>, 493937@bugs.debian.org
Subject: Re: Bug#493937: [Patch] Prevent loading of Python modules in
working directory
Date: Thu, 13 Nov 2008 18:17:24 -0500
```
[[Message part 1](bugreport.cgi?att=0;bug=493937;msg=122) (text/plain, inline)]
```
```
On Thu, Nov 13, 2008 at 11:23:07AM +0100, Bram Moolenaar wrote:
>
> James -
>
> > This is incorrect.  In Vim's current code, PySys_SetArgv is called with
> > an argv that is simply an empty string (and a terminating NULL
> > sentinel).  This causes sys.path's first element to be the empty string,
> > thus causing any Python import statements to use Vim's current working
> > directory as the first location to check for the requested module.
> >
> > The filter specifically removes any elements in sys.path that evaluate
> > to false (i.e., the empty string).
>
> That is not what happens for me.  Somehow somewhere the empty entry is
> changed to the full path of the directory above the current directory.
> I don't know where, but I see it happening.  I have tried this with:
>
> 	:py import sys
> 	:py print sys.path
>
> > Using the attached print_sys.path.diff, the following is printed when I
> > start Vim (the sys.path before and after my suggested filter() command):
> >
> > ['', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages']
> > ['/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages']
>
> As mentioned, for me the first entry is not '' but a path.   The filter
> command you suggested doesn't remove it.  I don't know where the
> difference between our systems comes from.

This is bizarre as I don't see how this could be happening in vanilla
Python code, so it seems like your install has been patched to add this
behavior.  Either way, I see two options:

1) Save sys.path before calling PySys_SetArgv and restore it afterward.
2) Prune the first element of sys.path after calling PySys_SetArgv.

We know that PySys_SetArgv always adds an element to the front of
sys.path and we know that we're giving it a value that isn't valid (to
prevent a segfault in some warn() function I can't find a reference to).

Adding an arbitrary, hopefully non-existent path in order to search for
and remove it just smells bad to me when there's defined behavior.  My
initial idea when I got this bug was to simply do 2) but I changed to
the filter() patch later to be (I thought) more robust.

I'd be interested in knowing where your Python install comes from so I
can see why it's behaving differently.

--
James
GPG Key: 1024D/61326D40 2003-09-02 James Vega <jamessan@debian.org>

```
```
[[signature.asc](bugreport.cgi?att=1;bug=493937;filename=signature.asc;msg=122) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`:

`Bug#493937`; Package `vim-python`.
(Fri, 14 Nov 2008 20:48:02 GMT) ([full text](bugreport.cgi?bug=493937;msg=124), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=124), [link](#123)).

---

**Acknowledgement sent**
to `Bram Moolenaar <Bram@moolenaar.net>`:

Extra info received and forwarded to list. Copy sent to `Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`.
(Fri, 14 Nov 2008 20:48:02 GMT) ([full text](bugreport.cgi?bug=493937;msg=126), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=126), [link](#125)).

---

[Message #127](#127) received at 493937@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=127), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=127), reply):

![](/cgi-bin/libravatar.cgi?email=Bram%40moolenaar.net)
From: Bram Moolenaar <Bram@moolenaar.net>
To: James Vega <jamessan@debian.org>
Cc: 493937@bugs.debian.org
Subject: Re: Bug#493937: [Patch] Prevent loading of Python modules in
working directory
Date: Fri, 14 Nov 2008 21:42:08 +0100
```

James -

> > > This is incorrect.  In Vim's current code, PySys_SetArgv is called with
> > > an argv that is simply an empty string (and a terminating NULL
> > > sentinel).  This causes sys.path's first element to be the empty string,
> > > thus causing any Python import statements to use Vim's current working
> > > directory as the first location to check for the requested module.
> > >
> > > The filter specifically removes any elements in sys.path that evaluate
> > > to false (i.e., the empty string).
> >
> > That is not what happens for me.  Somehow somewhere the empty entry is
> > changed to the full path of the directory above the current directory.
> > I don't know where, but I see it happening.  I have tried this with:
> >
> > 	:py import sys
> > 	:py print sys.path
> >
> > > Using the attached print_sys.path.diff, the following is printed when I
> > > start Vim (the sys.path before and after my suggested filter() command):
> > >
> > > ['', '/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages']
> > > ['/usr/lib/python2.5', '/usr/lib/python2.5/plat-linux2', '/usr/lib/python2.5/lib-tk', '/usr/lib/python2.5/lib-dynload', '/usr/local/lib/python2.5/site-packages', '/usr/lib/python2.5/site-packages']
> >
> > As mentioned, for me the first entry is not '' but a path.   The filter
> > command you suggested doesn't remove it.  I don't know where the
> > difference between our systems comes from.
>
> This is bizarre as I don't see how this could be happening in vanilla
> Python code, so it seems like your install has been patched to add this
> behavior.  Either way, I see two options:
>
> 1) Save sys.path before calling PySys_SetArgv and restore it afterward.
> 2) Prune the first element of sys.path after calling PySys_SetArgv.
>
> We know that PySys_SetArgv always adds an element to the front of
> sys.path and we know that we're giving it a value that isn't valid (to
> prevent a segfault in some warn() function I can't find a reference to).
>
> Adding an arbitrary, hopefully non-existent path in order to search for
> and remove it just smells bad to me when there's defined behavior.  My
> initial idea when I got this bug was to simply do 2) but I changed to
> the filter() patch later to be (I thought) more robust.
>
> I'd be interested in knowing where your Python install comes from so I
> can see why it's behaving differently.

I'm using Python 2.5.  The implementation of PySys_SetArgv() uses
realpath().  It expands "" to the current directory.  I haven't looked
at the details, but I suspect that's what is causing the behavior I
notice.

You can see this file here:
<http://svn.python.org/view/python/trunk/Python/sysmodule.c?rev=64856&view=markup>

I think using a magic directory name works better than assuming
something about the python code, e.g. prepending an entry to sys.path.
A later version may correct the mistake and not change sys.path for an
empty string.  I think my version of the fix handles those situations.

- Bram

--
hundred-and-one symptoms of being an internet addict:
252. You vote for foreign officials.

 /// Bram Moolenaar -- Bram@Moolenaar.net -- <http://www.Moolenaar.net>   \\\
///        sponsor Vim, vote for features -- <http://www.Vim.org/sponsor/> \\\
\\\        download, build and distribute -- <http://www.A-A-P.org>        ///
 \\\            help me help AIDS victims -- <http://ICCF-Holland.org>    ///

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`:

`Bug#493937`; Package `vim-python`.
(Fri, 14 Nov 2008 21:53:19 GMT) ([full text](bugreport.cgi?bug=493937;msg=129), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=129), [link](#128)).

---

**Acknowledgement sent**
to `"James Vega" <jamessan@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`.
(Fri, 14 Nov 2008 21:53:22 GMT) ([full text](bugreport.cgi?bug=493937;msg=131), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=131), [link](#130)).

---

[Message #132](#132) received at 493937@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=132), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=132), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: "James Vega" <jamessan@debian.org>
To: "Bram Moolenaar" <Bram@moolenaar.net>
Cc: 493937@bugs.debian.org
Subject: Re: Bug#493937: [Patch] Prevent loading of Python modules in working directory
Date: Fri, 14 Nov 2008 16:40:00 -0500
```
On Fri, Nov 14, 2008 at 3:42 PM, Bram Moolenaar <Bram@moolenaar.net> wrote:
>
> James -
>
>> Either way, I see two options:
>>
>> 1) Save sys.path before calling PySys_SetArgv and restore it afterward.
>> 2) Prune the first element of sys.path after calling PySys_SetArgv.
>>
>> We know that PySys_SetArgv always adds an element to the front of
>> sys.path and we know that we're giving it a value that isn't valid (to
>> prevent a segfault in some warn() function I can't find a reference to).
>>
>> Adding an arbitrary, hopefully non-existent path in order to search for
>> and remove it just smells bad to me when there's defined behavior.  My
>> initial idea when I got this bug was to simply do 2) but I changed to
>> the filter() patch later to be (I thought) more robust.
>>
>> I'd be interested in knowing where your Python install comes from so I
>> can see why it's behaving differently.
>
> I'm using Python 2.5.  The implementation of PySys_SetArgv() uses
> realpath().  It expands "" to the current directory.  I haven't looked
> at the details, but I suspect that's what is causing the behavior I
> notice.

Then this appears to be a difference (bug?) in your libc.  This is not
the case with glibc 2.7 or 2.8 (the two systems I can currently test
on).  Those error with ENOENT (as specified by SUS[0]).

> You can see this file here:
> <http://svn.python.org/view/python/trunk/Python/sysmodule.c?rev=64856&view=markup>
>
> I think using a magic directory name works better than assuming
> something about the python code, e.g. prepending an entry to sys.path.

This is one of the express purposes of PySys_SetArgv, as I mentioned
earlier.  The Python developers have stated multiple times[1][2] that
they consider the sys.path adjustment to be intended behavior and the
actual bug is implicit relative imports instead of defaulting to
absolute imports and using relative imports when requested.

Either way, thanks for pointing out the issue about using a buggy libc.
I'll keep that in mind when I push patches to other projects.

[0] - <http://www.opengroup.org/onlinepubs/009695399/functions/realpath.html>
[1] - <http://bugs.python.org/issue946373>
[2] - <http://lists.gnu.org/archive/html/emacs-devel/2008-09/msg00215.html>

--
James
GPG Key: 1024D/61326D40 2003-09-02 James Vega <jamessan@debian.org>

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`:

`Bug#493937`; Package `vim-python`.
(Sat, 15 Nov 2008 11:57:02 GMT) ([full text](bugreport.cgi?bug=493937;msg=134), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=134), [link](#133)).

---

**Acknowledgement sent**
to `Bram Moolenaar <Bram@moolenaar.net>`:

Extra info received and forwarded to list. Copy sent to `Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`.
(Sat, 15 Nov 2008 11:57:03 GMT) ([full text](bugreport.cgi?bug=493937;msg=136), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=136), [link](#135)).

---

[Message #137](#137) received at 493937@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=137), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=137), reply):

![](/cgi-bin/libravatar.cgi?email=Bram%40moolenaar.net)
From: Bram Moolenaar <Bram@moolenaar.net>
To: "James Vega" <jamessan@debian.org>
Cc: 493937@bugs.debian.org
Subject: Re: Bug#493937: [Patch] Prevent loading of Python modules in working directory
Date: Sat, 15 Nov 2008 12:52:49 +0100
```

James -

> >> Either way, I see two options:
> >>
> >> 1) Save sys.path before calling PySys_SetArgv and restore it afterward.
> >> 2) Prune the first element of sys.path after calling PySys_SetArgv.
> >>
> >> We know that PySys_SetArgv always adds an element to the front of
> >> sys.path and we know that we're giving it a value that isn't valid (to
> >> prevent a segfault in some warn() function I can't find a reference to).
> >>
> >> Adding an arbitrary, hopefully non-existent path in order to search for
> >> and remove it just smells bad to me when there's defined behavior.  My
> >> initial idea when I got this bug was to simply do 2) but I changed to
> >> the filter() patch later to be (I thought) more robust.
> >>
> >> I'd be interested in knowing where your Python install comes from so I
> >> can see why it's behaving differently.
> >
> > I'm using Python 2.5.  The implementation of PySys_SetArgv() uses
> > realpath().  It expands "" to the current directory.  I haven't looked
> > at the details, but I suspect that's what is causing the behavior I
> > notice.
>
> Then this appears to be a difference (bug?) in your libc.  This is not
> the case with glibc 2.7 or 2.8 (the two systems I can currently test
> on).  Those error with ENOENT (as specified by SUS[0]).

I'm on FreeBSD.  I used this test program:

#include <stdio.h>
#include <sys/param.h>
#include <stdlib.h>
#include <errno.h>

main()
{
        char buf[PATH_MAX];
        char *s;
        errno = 0;
        buf[0] = 0;
        s = realpath("", buf);
        printf("errno = %d; s = %s; buf = %s\n", errno, s, buf);
}

Result (when pwd is /tmp):

errno = 0; s = /tmp; buf = /tmp

The definition of realpath() doesn't say what happens for an empty
string.  It might handle it as "." or give an error.

> > You can see this file here:
> > <http://svn.python.org/view/python/trunk/Python/sysmodule.c?rev=64856&view=markup>
> >
> > I think using a magic directory name works better than assuming
> > something about the python code, e.g. prepending an entry to sys.path.
>
> This is one of the express purposes of PySys_SetArgv, as I mentioned
> earlier.  The Python developers have stated multiple times[1][2] that
> they consider the sys.path adjustment to be intended behavior and the
> actual bug is implicit relative imports instead of defaulting to
> absolute imports and using relative imports when requested.
>
> Either way, thanks for pointing out the issue about using a buggy libc.
> I'll keep that in mind when I push patches to other projects.
>
> [0] - <http://www.opengroup.org/onlinepubs/009695399/functions/realpath.html>
> [1] - <http://bugs.python.org/issue946373>
> [2] - <http://lists.gnu.org/archive/html/emacs-devel/2008-09/msg00215.html>

Did you test my proposed solution on Linux?  I think it should work
everywhere.

- Bram

--
hundred-and-one symptoms of being an internet addict:
255. You work for a newspaper and your editor asks you to write an
     article about Internet addiction...in the "first person."

 /// Bram Moolenaar -- Bram@Moolenaar.net -- <http://www.Moolenaar.net>   \\\
///        sponsor Vim, vote for features -- <http://www.Vim.org/sponsor/> \\\
\\\        download, build and distribute -- <http://www.A-A-P.org>        ///
 \\\            help me help AIDS victims -- <http://ICCF-Holland.org>    ///

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`:

`Bug#493937`; Package `vim-python`.
(Mon, 17 Nov 2008 15:48:06 GMT) ([full text](bugreport.cgi?bug=493937;msg=139), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=139), [link](#138)).

---

**Acknowledgement sent**
to `"James Vega" <jamessan@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`.
(Mon, 17 Nov 2008 15:48:06 GMT) ([full text](bugreport.cgi?bug=493937;msg=141), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=141), [link](#140)).

---

[Message #142](#142) received at 493937@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=142), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=142), reply):

![](/cgi-bin/libravatar.cgi?email=jamessan%40debian.org)
From: "James Vega" <jamessan@debian.org>
To: "Bram Moolenaar" <Bram@moolenaar.net>
Cc: 493937@bugs.debian.org
Subject: Re: Bug#493937: [Patch] Prevent loading of Python modules in working directory
Date: Mon, 17 Nov 2008 10:42:59 -0500
```
On Sat, Nov 15, 2008 at 6:52 AM, Bram Moolenaar <Bram@moolenaar.net> wrote:
>
> James -
>
>> Then this appears to be a difference (bug?) in your libc.  This is not
>> the case with glibc 2.7 or 2.8 (the two systems I can currently test
>> on).  Those error with ENOENT (as specified by SUS[0]).
>
> I'm on FreeBSD.  I used this test program:
>
> #include <stdio.h>
> #include <sys/param.h>
> #include <stdlib.h>
> #include <errno.h>
>
> main()
> {
>        char buf[PATH_MAX];
>        char *s;
>        errno = 0;
>        buf[0] = 0;
>        s = realpath("", buf);
>        printf("errno = %d; s = %s; buf = %s\n", errno, s, buf);
> }
>
> Result (when pwd is /tmp):
>
> errno = 0; s = /tmp; buf = /tmp

errno = 2; s = (null); buf =

> The definition of realpath() doesn't say what happens for an empty
> string.  It might handle it as "." or give an error.

SUS does specify what should happen.  It's an error.  FWIW, I've filed a
bug[0] against FreeBSD's behavior so we'll see what they think about it.

> Did you test my proposed solution on Linux?  I think it should work
> everywhere.

Yes, I did. It works fine.

[0] - <http://www.freebsd.org/cgi/query-pr.cgi?pr=128933>
--
James
GPG Key: 1024D/61326D40 2003-09-02 James Vega <jamessan@debian.org>

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`:

`Bug#493937`; Package `vim-python`.
(Mon, 17 Nov 2008 21:51:24 GMT) ([full text](bugreport.cgi?bug=493937;msg=144), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=144), [link](#143)).

---

**Acknowledgement sent**
to `Bram Moolenaar <Bram@moolenaar.net>`:

Extra info received and forwarded to list. Copy sent to `Debian Vim Maintainers <pkg-vim-maintainers@lists.alioth.debian.org>`.
(Mon, 17 Nov 2008 21:51:25 GMT) ([full text](bugreport.cgi?bug=493937;msg=146), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=146), [link](#145)).

---

[Message #147](#147) received at 493937@bugs.debian.org ([full text](bugreport.cgi?bug=493937;msg=147), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=147), reply):

![](/cgi-bin/libravatar.cgi?email=Bram%40moolenaar.net)
From: Bram Moolenaar <Bram@moolenaar.net>
To: "James Vega" <jamessan@debian.org>
Cc: 493937@bugs.debian.org
Subject: Re: Bug#493937: [Patch] Prevent loading of Python modules in working directory
Date: Mon, 17 Nov 2008 22:38:47 +0100
```

James -

> >> Then this appears to be a difference (bug?) in your libc.  This is not
> >> the case with glibc 2.7 or 2.8 (the two systems I can currently test
> >> on).  Those error with ENOENT (as specified by SUS[0]).
> >
> > I'm on FreeBSD.  I used this test program:
> >
> > #include <stdio.h>
> > #include <sys/param.h>
> > #include <stdlib.h>
> > #include <errno.h>
> >
> > main()
> > {
> >        char buf[PATH_MAX];
> >        char *s;
> >        errno = 0;
> >        buf[0] = 0;
> >        s = realpath("", buf);
> >        printf("errno = %d; s = %s; buf = %s\n", errno, s, buf);
> > }
> >
> > Result (when pwd is /tmp):
> >
> > errno = 0; s = /tmp; buf = /tmp
>
> errno = 2; s = (null); buf =
>
> > The definition of realpath() doesn't say what happens for an empty
> > string.  It might handle it as "." or give an error.
>
> SUS does specify what should happen.  It's an error.  FWIW, I've filed a
> bug[0] against FreeBSD's behavior so we'll see what they think about it.

OK.  It's good to have uniform behavior.  Unspecified behavior is
annoying.

> > Did you test my proposed solution on Linux?  I think it should work
> > everywhere.
>
> Yes, I did. It works fine.

Well, in that case I'll use this not-that-nice-but-works-everywhere
solution.  Thanks for testing.

- Bram

--
hundred-and-one symptoms of being an internet addict:
270. You are subscribed to a mailing list for every piece of software
     you use.

 /// Bram Moolenaar -- Bram@Moolenaar.net -- <http://www.Moolenaar.net>   \\\
///        sponsor Vim, vote for features -- <http://www.Vim.org/sponsor/> \\\
\\\        download, build and distribute -- <http://www.A-A-P.org>        ///
 \\\            help me help AIDS victims -- <http://ICCF-Holland.org>    ///

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Tue, 16 Dec 2008 07:26:36 GMT) ([full text](bugreport.cgi?bug=493937;msg=149), [mbox](bugreport.cgi?bug=493937;mbox=yes;msg=149), [link](#148)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=493937).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 15:12:38 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from support.apple.com_9ea67d90_20250125_151241.html ===


* [Apple](https://www.apple.com/)
* + [Store](https://www.apple.com/us/shop/goto/store)
  + [Mac](https://www.apple.com/mac/)
  + [iPad](https://www.apple.com/ipad/)
  + [iPhone](https://www.apple.com/iphone/)
  + [Watch](https://www.apple.com/watch/)
  + [Vision](https://www.apple.com/apple-vision-pro/)
  + [AirPods](https://www.apple.com/airpods/)
  + [TV & Home](https://www.apple.com/tv-home/)
  + [Entertainment](https://www.apple.com/entertainment/)
  + [Accessories](https://www.apple.com/us/shop/goto/buy_accessories)
  + [Support](https://support.apple.com/?cid=gn-ols-home-hp-tab)
* 0+

This article has been archived and is no longer updated by Apple.
# About the security content of Security Update 2010-002 / Mac OS X v10.6.3

This document describes the security content of Security Update 2010-002 / Mac OS X v10.6.3.

For the protection of our customers, Apple does not disclose, discuss, or confirm security issues until a full investigation has occurred and any necessary patches or releases are available. To learn more about Apple Product Security, see the [Apple Product Security](http://www.apple.com/support/security/) website.

For information about the Apple Product Security PGP Key, see "[How to use the Apple Product Security PGP Key](http://support.apple.com/kb/HT1620)."

Where possible, [CVE IDs](http://cve.mitre.org/about/) are used to reference the vulnerabilities for further information.

To learn about other Security Updates, see "[Apple Security Updates](http://support.apple.com/kb/HT1222)."

#### Security Update 2010-002 / Mac OS X v10.6.3

* **AppKit**

  CVE-ID: CVE-2010-0056

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: Spell checking a maliciously crafted document may lead to an unexpected application termination or arbitrary code execution

  Description: A buffer overflow exists in the spell checking feature used by Cocoa applications. Spell checking a maliciously crafted document may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. This issue does not affect Mac OS X v10.6 systems. Credit: Apple.

* **Application Firewall**

  CVE-ID: CVE-2009-2801

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: Certain rules in the Application Firewall may become inactive after restart

  Description: A timing issue in the Application Firewall may cause certain rules to become inactive after reboot. The issue is addressed through improved handling of Firewall rules. This issue does not affect Mac OS X v10.6 systems. Credit to Michael Kisor of OrganicOrb.com for reporting this issue.

* **AFP Server**

  CVE-ID: CVE-2010-0057

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: When guest access is disabled, a remote user may be able to mount AFP shares as a guest

  Description: An access control issue in AFP Server may allow a remote user to mount AFP shares as a guest, even if guest access is disabled. This issue is addressed through improved access control checks. Credit: Apple.

* **AFP Server**

  CVE-ID: CVE-2010-0533

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A remote user with guest access to an AFP share may access the contents of world-readable files outside the Public share

  Description: A directory traversal issue exists in the path validation for AFP shares. A remote user may enumerate the parent directory of the share root, and read or write files within that directory that are accessible to the 'nobody' user. This issue is addressed through improved handling of file paths. Credit to Patrik Karlsson of cqure.net for reporting this issue.

* **Apache**

  CVE-ID: CVE-2009-3095

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A remote attacker may be able to bypass access control restrictions

  Description: An input validation issue exists in Apache's handling of proxied FTP requests. A remote attacker with the ability to issue requests through the proxy may be able to bypass access control restrictions specified in the Apache configuration. This issue is addressed by updating Apache to version 2.2.14.

* **ClamAV**

  CVE-ID: CVE-2010-0058

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: ClamAV virus definitions may not receive updates

  Description: A configuration issue introduced in Security Update 2009-005 prevents freshclam from running. This may prevent virus definitions from being updated. This issue is addressed by updating freshclam's launchd plist ProgramArguments key values. This issue does not affect Mac OS X v10.6 systems. Credit to Bayard Bell, Wil Shipley of Delicious Monster, and David Ferrero of Zion Software, LLC for reporting this issue.

* **CoreAudio**

  CVE-ID: CVE-2010-0059

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Playing maliciously crafted audio content may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue exists in the handling of QDM2 encoded audio content. Playing maliciously crafted audio content may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. Credit to an anonymous researcher working with TippingPoint's Zero Day Initiative for reporting this issue.

* **CoreAudio**

  CVE-ID: CVE-2010-0060

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Playing maliciously crafted audio content may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue exists in the handling of QDMC encoded audio content. Playing maliciously crafted audio content may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. Credit to an anonymous researcher working with TippingPoint's Zero Day Initiative for reporting this issue.

* **CoreMedia**

  CVE-ID: CVE-2010-0062

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A heap buffer overflow exists in CoreMedia's handling of H.263 encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of H.263 encoded movie files. Credit to Damian Put and an anonymous researcher working with TippingPoint's Zero Day Initiative for reporting this issue.

* **CoreTypes**

  CVE-ID: CVE-2010-0063

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Users are not warned before opening certain potentially unsafe content types

  Description: This update adds .ibplugin and .url to the system's list of content types that will be flagged as potentially unsafe under certain circumstances, such as when they are downloaded from a web page. While these content types are not automatically launched, if manually opened they could lead to the execution of a malicious JavaScript payload or arbitrary code execution. This update improves the system's ability to notify users before handling content types used by Safari. Credit to Clint Ruoho of Laconic Security for reporting this issue.

* **CUPS**

  CVE-ID: CVE-2010-0393

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A local user may be able to obtain system privileges

  Description: A format string issue exists in the lppasswd CUPS utility. This may allow a local user to obtain system privileges. Mac OS X v10.6 systems are only affected if the setuid bit has been set on the binary. This issue is addressed by using default directories when running as a setuid process. Credit to Ronald Volgers for reporting this issue.

* **curl**

  CVE-ID: CVE-2009-2417

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A man-in-the-middle attacker may be able to impersonate a trusted server

  Description: A canonicalization issue exists in curl's handling of NULL characters in the subject's Common Name (CN) field of X.509 certificates. This may lead to man-in-the-middle attacks against users of the curl command line tool, or applications using libcurl. This issue is addressed through improved handling of NULL characters.

* **curl**

  CVE-ID: CVE-2009-0037

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: Using curl with -L may allow a remote attacker to read or write local files

  Description: curl will follow HTTP and HTTPS redirects when used with the -L option. When curl follows a redirect, it allows file:// URLs. This may allow a remote attacker to access local files. This issue is addressed through improved validation of redirects. This issue does not affect Mac OS X v10.6 systems. Credit to Daniel Stenberg of Haxx AB for reporting this issue.

* **Cyrus IMAP**

  CVE-ID: CVE-2009-2632

  Available for: Mac OS X Server v10.5.8

  Impact: A local user may be able to obtain the privileges of the Cyrus user

  Description: A buffer overflow exists in the handling of sieve scripts. By running a maliciously crafted sieve script, a local user may be able to obtain the privileges of the Cyrus user. This issue is addressed through improved bounds checking. This issue does not affect Mac OS X v10.6 systems.

* **Cyrus SASL**

  CVE-ID: CVE-2009-0688

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: An unauthenticated remote attacker may cause unexpected application termination or arbitrary code execution

  Description: A buffer overflow exists in the Cyrus SASL authentication module. Using Cyrus SASL authentication may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. This issue does not affect Mac OS X v10.6 systems.

* **DesktopServices**

  CVE-ID: CVE-2010-0064

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Items copied in the Finder may be assigned an unexpected file owner

  Description: When performing an authenticated copy in the Finder, original file ownership may be unexpectedly copied. This update addresses the issue by ensuring that copied files are owned by the user performing the copy. This issue does not affect systems prior to Mac OS X v10.6. Credit to Gerrit DeWitt of Auburn University (Auburn, AL) for reporting this issue.

* **DesktopServices**

  CVE-ID: CVE-2010-0537

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A remote attacker may gain access to user data via a multi-stage attack

  Description: A path resolution issue in DesktopServices is vulnerable to a multi-stage attack. A remote attacker must first entice the user to mount an arbitrarily named share, which may be done via a URL scheme. When saving a file using the default save panel in any application, and using "Go to folder" or dragging folders to the save panel, the data may be unexpectedly saved to the malicious share. This issue is addressed through improved path resolution. This issue does not affect systems prior to Mac OS X v10.6. Credit to Sidney San Martin working with DeepTech, Inc. for reporting this issue.

* **Disk Images**

  CVE-ID: CVE-2010-0065

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Mounting a maliciously crafted disk image may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue exists in the handling of bzip2 compressed disk images. Mounting a maliciously crafted disk image may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. Credit: Apple.

* **Disk Images**

  CVE-ID: CVE-2010-0497

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Mounting a maliciously crafted disk image may lead to arbitrary code execution

  Description: A design issue exists in the handling of internet enabled disk images. Mounting an internet enabled disk image containing a package file type will open it rather than revealing it in the Finder. This file quarantine feature helps to mitigate this issue by providing a warning dialog for unsafe file types. This issue is addressed through improved handling of package file types on internet enabled disk images. Credit to Brian Mastenbrook working with TippingPoint's Zero Day Initiative for reporting this issue.

* **Directory Services**

  CVE-ID: CVE-2010-0498

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A local user may obtain system privileges

  Description: An authorization issue in Directory Services' handling of record names may allow a local user to obtain system privileges. This issue is addressed through improved authorization checks. Credit: Apple.

* **Dovecot**

  CVE-ID: CVE-2010-0535

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: An authenticated user may be able to send and receive mail even if the user is not on the SACL of users who are permitted to do so

  Description: An access control issue exists in Dovecot when Kerberos authentication is enabled. This may allow an authenticated user to send and receive mail even if the user is not on the service access control list (SACL) of users who are permitted to do so. This issue is addressed through improved access control checks. This issue does not affect systems prior to Mac OS X v10.6.

* **Event Monitor**

  CVE-ID: CVE-2010-0500

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A remote attacker may cause arbitrary systems to be added to the firewall blacklist

  Description: A reverse DNS lookup is performed on remote ssh clients that fail to authenticate. A plist injection issue exists in the handling of resolved DNS names. This may allow a remote attacker to cause arbitrary systems to be added to the firewall blacklist. This issue is addressed by properly escaping resolved DNS names. Credit: Apple.

* **FreeRADIUS**

  CVE-ID: CVE-2010-0524

  Available for: Mac OS X Server v10.5.8, Mac OS X Server v10.6 through v10.6.2

  Impact: A remote attacker may obtain access to a network via RADIUS authentication

  Description: A certificate authentication issue exists in the default Mac OS X configuration of the FreeRADIUS server. A remote attacker may use EAP-TLS with an arbitrary valid certificate to authenticate and connect to a network configured to use FreeRADIUS for authentication. This issue is addressed by disabling support for EAP-TLS in the configuration. RADIUS clients should use EAP-TTLS instead. This issue only affects Mac OS X Server systems. Credit to Chris Linstruth of Qnet for reporting this issue.

* **FTP Server**

  CVE-ID: CVE-2010-0501

  Available for: Mac OS X Server v10.5.8, Mac OS X Server v10.6 through v10.6.2

  Impact: Users may be able to retrieve files outside the FTP root directory

  Description: A directory traversal issue exists in FTP Server. This may allow a user to retrieve files outside the FTP root directory. This issue is addressed through improved handling of file names. This issue only affects Mac OS X Server systems. Credit: Apple.

* **iChat Server**

  CVE-ID: CVE-2006-1329

  Available for: Mac OS X Server v10.5.8, Mac OS X Server v10.6 through v10.6.2

  Impact: A remote attacker may be able to cause a denial of service

  Description: An implementation issue exists in jabberd's handling of SASL negotiation. A remote attacker may be able to terminate the operation of jabberd. This issue is addressed through improved handling of SASL negotiation. This issue only affects Mac OS X Server systems.

* **iChat Server**

  CVE-ID: CVE-2010-0502

  Available for: Mac OS X Server v10.5.8, Mac OS X Server v10.6 through v10.6.2

  Impact: Chat messages may not be logged

  Description: A design issue exists in iChat Server's support for configurable group chat logging. iChat Server only logs messages with certain message types. This may allow a remote user to send a message through the server without it being logged. The issue is addressed by removing the capability to disable group chat logs, and logging all messages that are sent through the server. This issue only affects Mac OS X Server systems. Credit: Apple.

* **iChat Server**

  CVE-ID: CVE-2010-0503

  Available for: Mac OS X Server v10.5.8

  Impact: An authenticated user may be able to cause an unexpected application termination or arbitrary code execution

  Description: A use-after-free issue exists in iChat Server. An authenticated user may be able to cause an unexpected application termination or arbitrary code execution. This issue is addressed through improved memory reference tracking. This issue only affects Mac OS X Server systems, and does not affect versions 10.6 or later.

* **iChat Server**

  CVE-ID: CVE-2010-0504

  Available for: Mac OS X Server v10.5.8, Mac OS X Server v10.6 through v10.6.2

  Impact: An authenticated user may be able to cause an unexpected application termination or arbitrary code execution

  Description: Multiple stack buffer overflow issues exist in iChat Server. An authenticated user may be able to cause an unexpected application termination or arbitrary code execution. These issues are addressed through improved memory management. These issues only affect Mac OS X Server systems. Credit: Apple.

* **ImageIO**

  CVE-ID: CVE-2010-0505

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted JP2 image may lead to an unexpected application termination or arbitrary code execution

  Description: A heap buffer overflow exists in the handling of JP2 images. Viewing a maliciously crafted JP2 image may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. Credit to Chris Ries of Carnegie Mellon University Computing Service, and researcher "85319bb6e6ab398b334509c50afce5259d42756e" working with TippingPoint's Zero Day Initiative for reporting this issue.

* **ImageIO**

  CVE-ID: CVE-2010-0041

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Visiting a maliciously crafted website may result in sending data from Safari's memory to the website

  Description: An uninitialized memory access issue exists in ImageIO's handling of BMP images. Visiting a maliciously crafted website may result in sending data from Safari's memory to the website. This issue is addressed through improved memory initialization and additional validation of BMP images. Credit to Matthew 'j00ru' Jurczyk of Hispasec for reporting this issue.

* **ImageIO**

  CVE-ID: CVE-2010-0042

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Visiting a maliciously crafted website may result in sending data from Safari's memory to the website

  Description: An uninitialized memory access issue exists in ImageIO's handling of TIFF images. Visiting a maliciously crafted website may result in sending data from Safari's memory to the website. This issue is addressed through improved memory initialization and additional validation of TIFF images. Credit to Matthew 'j00ru' Jurczyk of Hispasec for reporting this issue.

* **ImageIO**

  CVE-ID: CVE-2010-0043

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Processing a maliciously crafted TIFF image may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue exists in the handling of TIFF images. Processing a maliciously crafted TIFF image may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved memory handling. This issue does not affect systems prior to Mac OS X v10.6. Credit to Gus Mueller of Flying Meat for reporting this issue.

* **Image RAW**

  CVE-ID: CVE-2010-0506

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: Viewing a maliciously crafted NEF image may lead to an unexpected application termination or arbitrary code execution

  Description: A buffer overflow exists in Image RAW's handling of NEF images. Viewing a maliciously crafted NEF image may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. This issue does not affect Mac OS X v10.6 systems. Credit: Apple.

* **Image RAW**

  CVE-ID: CVE-2010-0507

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted PEF image may lead to an unexpected application termination or arbitrary code execution

  Description: A buffer overflow exists in Image RAW's handling of PEF images. Viewing a maliciously crafted PEF image may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. Credit to Chris Ries of Carnegie Mellon University Computing Services for reporting this issue.

* **Libsystem**

  CVE-ID: CVE-2009-0689

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Applications that convert untrusted data between binary floating point and text may be vulnerable to an unexpected application termination or arbitrary code execution

  Description: A buffer overflow exists in the floating point binary to text conversion code within Libsystem. An attacker who can cause an application to convert a floating point value into a long string, or to parse a maliciously crafted string as a floating point value, may be able to cause an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. Credit to Maksymilian Arciemowicz of SecurityReason.com for reporting this issue.

* **Mail**

  CVE-ID: CVE-2010-0508

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Rules associated with a deleted mail account remain in effect

  Description: When a mail account is deleted, user-defined filter rules associated with that account remain active. This may result in unexpected actions. This issue is addressed by disabling associated rules when a mail account is deleted.

* **Mail**

  CVE-ID: CVE-2010-0525

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Mail may use a weaker encryption key for outgoing email

  Description: A logic issue exists in Mail's handling of encryption certificates. When multiple certificates for the recipient exist in the keychain, Mail may select an encryption key that is not intended for encipherment. This may lead to a security issue if the chosen key is weaker than expected. This issue is addressed by ensuring that the key usage extension within certificates is evaluated when selecting a mail encryption key. Credit to Paul Suh of ps Enable, Inc. for reporting this issue.

* **Mailman**

  CVE-ID: CVE-2008-0564

  Available for: Mac OS X Server v10.5.8

  Impact: Multiple vulnerabilities in Mailman 2.1.9

  Description: Multiple cross-site scripting issues exist in Mailman 2.1.9. These issues are addressed by updating Mailman to version 2.1.13. Further information is available via the Mailman site at <http://mail.python.org/pipermail/mailman-announce/2009-January/000128.html> These issues only affect Mac OS X Server systems, and do not affect versions 10.6 or later.

* **MySQL**

  CVE-ID: CVE-2008-4456, CVE-2008-7247, CVE-2009-2446, CVE-2009-4019, CVE-2009-4030

  Available for: Mac OS X Server v10.6 through v10.6.2

  Impact: Multiple vulnerabilities in MySQL 5.0.82

  Description: MySQL is updated to version 5.0.88 to address multiple vulnerabilities, the most serious of which may lead to arbitrary code execution. These issues only affect Mac OS X Server systems. Further information is available via the MySQL web site at <http://dev.mysql.com/doc/refman/5.0/en/news-5-0-88.html>

* **OS Services**

  CVE-ID: CVE-2010-0509

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A local user may be able to obtain elevated privileges

  Description: A privilege escalation issue exists in SFLServer, as it runs as group 'wheel' and accesses files in users' home directories. This issue is addressed through improved privilege management. Credit to Kevin Finisterre of DigitalMunition for reporting this issue.

* **Password Server**

  CVE-ID: CVE-2010-0510

  Available for: Mac OS X Server v10.5.8, Mac OS X Server v10.6 through v10.6.2

  Impact: A remote attacker may be able to log in with an outdated password

  Description: An implementation issue in Password Server's handling of replication may cause passwords to not be replicated. A remote attacker may be able to log in to a system using an outdated password. This issue is addressed through improved handling of password replication. This issue only affects Mac OS X Server systems. Credit to Jack Johnson of Anchorage School District for reporting this issue.

* **perl**

  CVE-ID: CVE-2008-5302, CVE-2008-5303

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: A local user may cause arbitrary files to be deleted

  Description: Multiple race condition issues exist in the rmtree function of the perl module File::Path. A local user with write access to a directory that is being deleted may cause arbitrary files to be removed with the privileges of the perl process. This issue is addressed through improved handling of symbolic links. This issue does not affect Mac OS X v10.6 systems.

* **PHP**

  CVE-ID: CVE-2009-3557, CVE-2009-3558, CVE-2009-3559, CVE-2009-4017

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Multiple vulnerabilities in PHP 5.3.0

  Description: PHP is updated to version 5.3.1 to address multiple vulnerabilities, the most serious of which may lead to arbitrary code execution. Further information is available via the PHP website at <http://www.php.net/>

* **PHP**

  CVE-ID: CVE-2009-3557, CVE-2009-3558, CVE-2009-3559, CVE-2009-4142, CVE-2009-4143

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: Multiple vulnerabilities in PHP 5.2.11

  Description: PHP is updated to version 5.2.12 to address multiple vulnerabilities, the most serious of which may lead to cross-site scripting. Further information is available via the PHP website at <http://www.php.net/>

* **Podcast Producer**

  CVE-ID: CVE-2010-0511

  Available for: Mac OS X Server v10.6 through v10.6.2

  Impact: An unauthorized user may be able to access a Podcast Composer workflow

  Description: When a Podcast Composer workflow is overwritten, the access restrictions are removed. This may allow an unauthorized user to access a Podcast Composer workflow. This issue is addressed through improved handling of workflow access restrictions. Podcast Composer was introduced in Mac OS X Server v10.6.

* **Preferences**

  CVE-ID: CVE-2010-0512

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A network user may be able to bypass system login restrictions

  Description: An implementation issue exists in the handling of system login restrictions for network accounts. If the network accounts allowed to log in to the system at the Login Window are identified by group membership only, the restriction will not be enforced, and all network users will be allowed to log in to the system. The issue is addressed through improved group restriction management in the Accounts preference pane. This issue only affects systems configured to use a network account server, and does not affect systems prior to Mac OS X v10.6. Credit to Christopher D. Grieb of University of Michigan MSIS for reporting this issue.

* **PS Normalizer**

  CVE-ID: CVE-2010-0513

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted PostScript file may lead to an unexpected application termination or arbitrary code execution

  Description: A stack buffer overflow exists in the handling of PostScript files. Viewing a maliciously crafted PostScript file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of PostScript files. On Mac OS X v10.6 systems this issue is mitigated by the -fstack-protector compiler flag. Credit: Apple.

* **QuickTime**

  CVE-ID: CVE-2010-0062

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A heap buffer overflow exists in QuickTime's handling of H.263 encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of H.263 encoded movie files. Credit to Damian Put and an anonymous researcher working with TippingPoint's Zero Day Initiative for reporting this issue.

* **QuickTime**

  CVE-ID: CVE-2010-0514

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A heap buffer overflow exists in the handling of H.261 encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of H.261 encoded movie files. Credit to Will Dormann of the CERT/CC for reporting this issue.

* **QuickTime**

  CVE-ID: CVE-2010-0515

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption in the handling of H.264 encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of H.264 encoded movie files. Credit to an anonymous researcher working with TippingPoint's Zero Day Initiative for reporting this issue.

* **QuickTime**

  CVE-ID: CVE-2010-0516

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A heap buffer overflow in the handling of RLE encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of RLE encoded movie files. Credit to an anonymous researcher working with TippingPoint's Zero Day Initiative for reporting this issue.

* **QuickTime**

  CVE-ID: CVE-2010-0517

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A heap buffer overflow in the handling of M-JPEG encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of M-JPEG encoded movie files. Credit to Damian Put and an anonymous researcher working with TippingPoint's Zero Day Initiative for reporting this issue.

* **QuickTime**

  CVE-ID: CVE-2010-0518

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A memory corruption issue exists in the handling of Sorenson encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of Sorenson encoded movie files. Credit to Will Dormann of the CERT/CC for reporting this issue.

* **QuickTime**

  CVE-ID: CVE-2010-0519

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: An integer overflow exists in the handling of FlashPix encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed through improved bounds checking. Credit to an anonymous researcher working with TippingPoint's Zero Day Initiative for reporting this issue.

* **QuickTime**

  CVE-ID: CVE-2010-0520

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution

  Description: A heap buffer overflow exists in the handling of FLC encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of FLC encoded movie files. Credit to Moritz Jodeit of n.runs AG, working with TippingPoint's Zero Day Initiative, and Nicolas Joly of VUPEN Security for reporting this issue.

* **QuickTime**

  CVE-ID: CVE-2010-0526

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted MPEG file may lead to an unexpected application termination or arbitrary code execution

  Description: A heap buffer overflow exists in the handling of MPEG encoded movie files. Viewing a maliciously crafted movie file may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of MPEG encoded movie files. Credit to an anonymous researcher working with TippingPoint's Zero Day Initiative for reporting this issue.

* **Ruby**

  CVE-ID: CVE-2009-2422, CVE-2009-3009, CVE-2009-4214

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Multiple issues in Ruby on Rails

  Description: Multiple vulnerabilities exist in Ruby on Rails, the most serious of which may lead to cross-site scripting. On Mac OS X v10.6 systems, these issues are addressed by updating Ruby on Rails to version 2.3.5. Mac OS X v10.5 systems are affected only by CVE-2009-4214, and this issue is addressed through improved validation of arguments to strip\_tags.

* **Ruby**

  CVE-ID: CVE-2009-1904

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Running a Ruby script that uses untrusted input to initialize a BigDecimal object may lead to an unexpected application termination

  Description: A stack exhaustion issue exists in Ruby's handling of BigDecimal objects with very large values. Running a Ruby script that uses untrusted input to initialize a BigDecimal object may lead to an unexpected application termination. For Mac OS X v10.6 systems, this issue is addressed by updating Ruby to version 1.8.7-p173. For Mac OS v10.5 systems, this issue is addressed by updating Ruby to version 1.8.6-p369.

* **Server Admin**

  CVE-ID: CVE-2010-0521

  Available for: Mac OS X Server v10.5.8, Mac OS X Server v10.6 through v10.6.2

  Impact: A remote attacker may extract information from Open Directory

  Description: A design issue exists in the handling of authenticated directory binding. A remote attacker may be able to anonymously extract information from Open Directory, even if the "Require authenticated binding between directory and clients" option is enabled. The issue is addressed by removing this configuration option. This issue only affects Mac OS X Server systems. Credit to Scott Gruby of Gruby Solutions, and Mathias Haack of GRAVIS Computervertriebsgesellschaft mbH for reporting this issue.

* **Server Admin**

  CVE-ID: CVE-2010-0522

  Available for: Mac OS X Server v10.5.8

  Impact: A former administrator may have unauthorized access to screen sharing

  Description: A user who is removed from the 'admin' group may still connect to the server using screen sharing. This issue is addressed through improved handling of administrator privileges. This issue only affects Mac OS X Server systems, and does not affect version 10.6 or later. Credit: Apple.

* **SMB**

  CVE-ID: CVE-2009-2906

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: A remote attacker may be able to cause a denial of service

  Description: An infinite loop issue exists in Samba's handling of SMB 'oplock' break notifications. A remote attacker may be able to trigger an infinite loop in smbd, causing it to consume excessive CPU resources. The issue is addressed through improved handling of 'oplock' break notifications.

* **Tomcat**

  CVE-ID: CVE-2009-0580, CVE-2009-0033, CVE-2009-0783, CVE-2008-5515, CVE-2009-0781, CVE-2009-2901, CVE-2009-2902, CVE-2009-2693

  Available for: Mac OS X Server v10.5.8, Mac OS X Server v10.6 through v10.6.2

  Impact: Multiple vulnerabilities in Tomcat 6.0.18

  Description: Tomcat is updated to version 6.0.24 to address multiple vulnerabilities, the most serious of which may lead to a cross site scripting attack. Tomcat is only provided on Mac OS X Server systems. Further information is available via the Tomcat site at <http://tomcat.apache.org/>

* **unzip**

  CVE-ID: CVE-2008-0888

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: Extracting maliciously crafted zip files using the unzip command tool may lead to an unexpected application termination or code execution

  Description: An uninitialized pointer issue exists is the handling of zip files. Extracting maliciously crafted zip files using the unzip command tool may lead to an unexpected application termination or arbitrary code execution. This issue is addressed by performing additional validation of zip files. This issue does not affect Mac OS X v10.6 systems.

* **vim**

  CVE-ID: CVE-2008-2712, CVE-2008-4101, CVE-2009-0316

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: Multiple vulnerabilities in vim 7.0

  Description: Multiple vulnerabilities exist in vim 7.0, the most serious of which may lead to arbitrary code execution when working with maliciously crafted files. These issues are addressed by updating to vim 7.2.102. These issues do not affect Mac OS X v10.6 systems. Further information is available via the vim website at <http://www.vim.org/>

* **Wiki Server**

  CVE-ID: CVE-2010-0523

  Available for: Mac OS X Server v10.5.8

  Impact: Uploading a maliciously crafted applet may lead to the disclosure of sensitive information

  Description: Wiki Server allows users to upload active content such as Java applets. A remote attacker may obtain sensitive information by uploading a maliciously crafted applet and directing a Wiki Server user to view it. The issue is addressed by using a special one-time authentication cookie which is only useable to download a particular attachment. This issue only affects Mac OS X Server systems, and does not affect versions 10.6 or later.

* **Wiki Server**

  CVE-ID: CVE-2010-0534

  Available for: Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: An authenticated user may bypass weblog creation restrictions

  Description: Wiki Server supports service access control lists (SACLs), allowing an administrator to control the publication of content. Wiki Server fails to consult the weblog SACL during the creation of a user's weblog. This may allow an authenticated user to publish content to the Wiki Server, even though publication should be disallowed by the service ACL. This issue does not affect systems prior to Mac OS X v10.6.

* **X11**

  CVE-ID: CVE-2009-2042

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Viewing a maliciously crafted image may lead to the disclosure of sensitive information

  Description: libpng is updated to version 1.2.37 to address an issue that may result in the disclosure of sensitive information. Further information is available via the libpng site at <http://www.libpng.org/pub/png/libpng.html>

* **X11**

  CVE-ID: CVE-2003-0063

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through v10.6.2, Mac OS X Server v10.6 through v10.6.2

  Impact: Displaying maliciously crafted data within an xterm terminal may lead to arbitrary code execution

  Description: The xterm program supports a command sequence to change the window title, and to print the window title to the terminal. The information returned is provided to the terminal as though it were keyboard input from the user. Within an xterm terminal, displaying maliciously crafted data containing such sequences may result in command injection. The issue is addressed by disabling the affected command sequence.

* **xar**

  CVE-ID: CVE-2010-0055

  Available for: Mac OS X v10.5.8, Mac OS X Server v10.5.8

  Impact: A modified package may appear as validly signed

  Description: A design issue exists in xar when validating a package signature. This may allow a modified package to appear as validly signed. This issue is fixed through improved package signature validation. This issue does not affect Mac OS X v10.6 systems. Credit: Apple.

**Important:** Mention of third-party websites and products is for informational purposes only and constitutes neither an endorsement nor a recommendation. Apple assumes no responsibility with regard to the selection, performance or use of information or products found at third-party websites. Apple provides this only as a convenience to our users. Apple has not tested the information found on these sites and makes no representations regarding its accuracy or reliability. There are risks inherent in the use of any information or products found on the Internet, and Apple assumes no responsibility in this regard. Please understand that a third-party site is independent from Apple and that Apple has no control over the content on that website. Please [contact the vendor](http://support.apple.com/kb/HT2693?viewlocale=en_US) for additional information.

Published Date: April 11, 2024

Helpful?

Yes

No

Character limit:
250

Maximum character limit is 250.

Please don’t include any personal information in your comment.
Submit

Thanks for your feedback.

## Apple Footer

[
Apple](https://www.apple.com)

1. [Support](https://support.apple.com)
2. About the security content of Security Update 2010-002 / Mac OS X v10.6.3

[United States](https://support.apple.com/en-us/104159/localeselector "Choose your country or region")

Copyright © 2025 Apple Inc. All rights reserved.
 [Privacy Policy](https://www.apple.com/legal/privacy/en-ww/) [Terms of Use](https://www.apple.com/legal/internet-services/terms/site.html) [Sales and Refunds](https://www.apple.com/shop/goto/help/sales_refunds) [Site Map](https://www.apple.com/sitemap/)


