=== Content from www.us-cert.gov_d411635f_20250124_131206.html ===

[Skip to main content](#main)

![U.S. flag](/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png)

An official website of the United States government

Here’s how you know

Here’s how you know

![Dot gov](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg)

**Official websites use .gov**

 A **.gov** website belongs to an official government organization in the United States.

![HTTPS](/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg)

**Secure .gov websites use HTTPS**

 A **lock** (LockA locked padlock) or **https://** means you’ve safely connected to the .gov website. Share sensitive information only on official, secure websites.

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

[![Cybersecurity & Infrastructure Security Agency logo America’s Cyber Security Defense Agency National Coordinator For Critical Infrastructure Security and Resilience](/sites/default/files/images/SVG/header_logo_tagline_update.svg)](/)

[![CISA Logo](/sites/default/files/images/SVG/mobile_logo_wordmark.svg)](/)

Search

Menu

![America's Cyber Defense Agency](/sites/default/files/images/SVG/header_tagline_mobile_update.svg)

Close

* Topics

  [Topics](/topics)

  [Cybersecurity Best Practices](/topics/cybersecurity-best-practices)

  [Cyber Threats and Advisories](/topics/cyber-threats-and-advisories)

  [Critical Infrastructure Security and Resilience](/topics/critical-infrastructure-security-and-resilience)

  [Election Security](/topics/election-security)

  [Emergency Communications](/topics/emergency-communications)

  [Industrial Control Systems](/topics/industrial-control-systems)

  [Information and Communications Technology Supply Chain Security](/topics/information-communications-technology-supply-chain-security)

  [Partnerships and Collaboration](/topics/partnerships-and-collaboration)

  [Physical Security](/topics/physical-security)

  [Risk Management](/topics/risk-management)

   [How can we help?](/audiences)
  [Government](/topics/government)[Educational Institutions](/topics/educational-institutions)[Industry](/topics/industry)[State, Local, Tribal, and Territorial](/topics/state-local-tribal-and-territorial)[Individuals and Families](/topics/individuals-and-families)[Small and Medium Businesses](/topics/small-and-medium-businesses)[Find Help Locally](/audiences/find-help-locally)[Faith-Based Community](/audiences/faith-based-community)[Executives](/audiences/executives)[High-Risk Communities](/audiences/high-risk-communities)
* [Spotlight](/spotlight)
* Resources & Tools

  [Resources & Tools](/resources-tools)

  [All Resources & Tools](/resources-tools/all-resources-tools)

  [Services](/resources-tools/services)

  [Programs](/resources-tools/programs)

  [Resources](/resources-tools/resources)

  [Training](/resources-tools/training)

  [Groups](/resources-tools/groups)
* News & Events

  [News & Events](/news-events)

  [News](/news-events/news)

  [Events](/news-events/events)

  [Cybersecurity Alerts & Advisories](/news-events/cybersecurity-advisories)

  [Directives](/news-events/directives)

  [Request a CISA Speaker](/news-events/request-speaker)

  [Congressional Testimony](/news-events/congressional-testimony)

  [CISA Conferences](/cisa-conferences)

  [CISA Live!](/cisa-live)
* Careers

  [Careers](/careers)

  [Benefits & Perks](/careers/benefits-perks)

  [HireVue Applicant Reasonable Accommodations Process](/careers/hirevue-applicant-reasonable-accommodations-process)

  [Hiring](/general-recruitment-and-hiring-faqs)

  [Resume & Application Tips](/careers/resume-application-tips)

  [Students & Recent Graduates](/students-recent-graduates-employment-opportunities)

  [Veteran and Military Spouses](/careers/veteran-and-military-spouse-employment-opportunities)

  [Work @ CISA](/careers/work-cisa)
* About

  [About](/about)

  [Divisions & Offices](/about/divisions-offices)

  [Regions](/about/regions)

  [Leadership](/about/leadership)

  [Doing Business with CISA](/doing-business-cisa)

  [Site Links](/site-links)

  [Reporting Employee and Contractor Misconduct](/reporting-employee-and-contractor-misconduct)

  [CISA GitHub](/cisa-github)

  [CISA Central](/cisa-central)

  [2024 Year In Review](/about/2024YIR)

  [Contact Us](/about/contact-us)

  [Equal Employment Opportunity](/eeo)

  [Subscribe](/about/contact-us/subscribe-updates-cisa)

  [Reasonable Accommodations & Accessibility](/rap)

  [Special Emphasis Programs](/sep)

  [No FEAR Act Notice & Reports](/no-fear-act)

  [Policies & Plans](/eeo-policies)

[Free Cyber Services](/resources-tools/resources/free-cybersecurity-services-and-tools "Free Cyber Services")[Secure by design](/securebydesign) [Secure Our World](/node/18883)[Shields Up](/node/8056)[Report A Cyber Issue](/report)

Breadcrumb

1. [Home](/)
2. [News & Events](/news-events)
3. [Cybersecurity Advisories](/news-events/cybersecurity-advisories)
4. [Alert](/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A93)

Share:

Alert
# Microsoft Windows Does Not Disable AutoRun Properly

Last RevisedApril 05, 2013
Alert CodeTA09-020A

### Systems Affected

* Microsoft Windows

### Overview

Disabling AutoRun on Microsoft Windows systems can help prevent the spread of malicious code. However, Microsoft's guidelines for disabling AutoRun are not fully effective, which could be considered a vulnerability.

Microsoft Windows includes an AutoRun feature, which can automatically run code when removable devices are connected to the computer. AutoRun (and the closely related AutoPlay) can unexpectedly cause arbitrary code execution in the following situations:

1. A removable device is connected to a computer. This includes, but is not limited to, inserting a CD or DVD, connecting a USB or FireWire device, or mapping a network drive. This connection can result in code execution without any additional user interaction.

   ![]()
2. A user clicks the drive icon for a removable device in Windows Explorer. Rather than exploring the drive's contents, this action can cause code execution.

   ![]()
3. The user selects an option from the AutoPlay dialog that is displayed when a removable device is connected.

   ![]()

Malicious software, such as [W32.Downadup](http://www.symantec.com/security_response/writeup.jsp?docid=2008-112203-2408-99), is [using AutoRun](http://www.f-secure.com/weblog/archives/00001586.html) to spread. Disabling AutoRun, as specified in the [CERT/CC Vulnerability Analysis blog](http://www.cert.org/blogs/vuls/2008/04/the_dangers_of_windows_autorun.html), is an effective way of helping to prevent the spread of malicious code.

The [Autorun](http://support.microsoft.com/kb/155217) and [NoDriveTypeAutorun](http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/regentry/91525.mspx) registry values are both ineffective for fully disabling AutoRun capabilities on Microsoft Windows systems. Setting the Autorun registry value to 0 will not prevent newly connected devices from automatically running code specified in the [Autorun.inf](http://msdn.microsoft.com/en-us/library/bb776823%28VS.85%29.aspx) file. It will, however, disable Media Change Notification (MCN) messages, which may prevent Windows from detecting when a CD or DVD is changed. According to Microsoft, setting the NoDriveTypeAutorun registry value to 0xFF "disables Autoplay on all types of drives." Even with this value set, Windows may execute arbitrary code when the user clicks the icon for the device in Windows Explorer.

### Impact

By placing an Autorun.inf file on a device, an attacker may be able to automatically execute arbitrary code when the device is connected to a Windows system. Code execution may also take place when the user attempts to browse to the software location with Windows Explorer.

### Solution

**Disable AutoRun in Microsoft Windows**

To effectively disable AutoRun in Microsoft Windows, import the following registry value:

REGEDIT4
[HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\IniFileMapping\Autorun.inf]
@="@SYS:DoesNotExist"

To import this value, perform the following steps:

1. Copy the text
2. Paste the text into Windows Notepad
3. Save the file as "autorun.reg"
   Note: In certain circumstances, Notepad may automatically add a .txt extension to saved files. To ensure that the file is saved with the proper extension, select **All Files** in the "Save as type:" section of the "Save As" dialog.
4. Navigate to the file location
5. Double-click the file to import it into the Windows registry

Microsoft Windows can also cache the AutoRun information from mounted devices in the MountPoints2 registry key. We recommend restarting Windows after making the registry change so that any cached mount points are reinitialized in a way that ignores the Autorun.inf file. Alternatively, the following registry key may be deleted:

HKEY\_CURRENT\_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\MountPoints2

Once these changes have been made, all of the AutoRun code execution scenarios described above will be mitigated because Windows will no longer parse Autorun.inf files to determine which actions to take. Further details are available in the [CERT/CC Vulnerability Analysis blog](http://www.cert.org/blogs/vuls/2008/04/the_dangers_of_windows_autorun.html). Thanks to Nick Brown and Emin Atac for providing the workaround and to Aryeh Goretsky for pointing out a possible issue with Notepad appending a .txt file extension.

**Update:**

Microsoft has published [Microsoft Knowledge Base Article 967715](http://support.microsoft.com/kb/967715), which describes how to correct the problem of NoDriveTypeAutoRun registry value enforcement. After the update is installed, Windows will obey the NoDriveTypeAutorun registry value. Note that this fix has been released via Microsoft Update to all affected systems. The previous update, described in [Microsoft Knowledge Base Article 953252](http://support.microsoft.com/kb/953252), was only available through Microsoft Update for Windows Vista and Windows Server 2008, and for manual installation on other affected platforms. Microsoft states the that systems that already applied the update from Microsoft Knowledge Base Article 953252 do not need to apply the update from Microsoft Knowledge Base Article 967715 because the changes are the same. Additional details about the update can be found in [Microsoft Security Advisory (967940)](http://www.microsoft.com/technet/security/advisory/967940.mspx). Our testing has shown that installing this update and setting the NoDriveTypeAutoRun registry value to 0xFF will disable AutoRun as effectively as the workaround described above.

### References

[The Dangers of Windows AutoRun](http://www.cert.org/blogs/vuls/2008/04/the_dangers_of_windows_autorun.html)
[US-CERT Vulnerability Note VU#889747](http://www.kb.cert.org/vuls/id/889747)
[Nick Browns blog: Memory stick worms](http://nick.brown.free.fr/blog/2007/10/memory-stick-worms)
[TR08-004 Disabling Autorun](http://www.publicsafety.gc.ca/prg/em/ccirc/2008/tr08-004-eng.aspx)
[How to correct disable Autorun registry key encforcement in Windows](/How%20to%20correct%20disable%20Autorun%20registry%20key%20encforcement%20in%20Windows)
[Microsoft Security Bulletin MS08-038](http://www.microsoft.com/technet/security/Bulletin/MS08-038.mspx)
[How to Enable or Disable Automatically Running CD-ROMs](http://support.microsoft.com/kb/155217)
[NoDriveTypeAutoRun](http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/regentry/91525.mspx)
[Autorun.inf Entries](http://msdn.microsoft.com/en-us/library/bb776823%28VS.85%29.aspx)
[W32.Downadup](http://www.symantec.com/security_response/writeup.jsp?docid=2008-112203-2408-99)
[MS08-067 Worm, Downadup/Conflicker](http://www.f-secure.com/weblog/archives/00001576.html)
[Social Engineering Autoplay and Windows 7](http://www.f-secure.com/weblog/archives/00001586.html)
[Microsoft Security Advisory (967940)](http://www.microsoft.com/technet/security/advisory/967940.mspx)
[Microsoft Knowledge Base Article 967715](http://support.microsoft.com/kb/967715)
[Microsoft Knowledge Base Article 953252](http://support.microsoft.com/kb/953252)
### Revisions

January 20, 2009: Initial release|January 21, 2009: Added reference and details for Microsoft KB953252|January 29, 2009: Added information about Notepad and double file extensions|February 26, 2009: Added information about Microsoft Security Advisory 967940 and KB967715, which supercedes KB953252 |March 2, 2009: Clarified the language comparing the Microsoft update to the workaround

This product is provided subject to this [Notification](/notification "Follow link") and this [Privacy & Use](/privacy-policy "Follow link") policy.

## Please share your thoughts

We recently updated our anonymous [product survey](https://cisasurvey.gov1.qualtrics.com/jfe/form/SV_9n4TtB8uttUPaM6?product=https://www.cisa.gov/news-events/alerts/2009/01/20/microsoft-windows-does-not-disable-autorun-properly); we’d welcome your feedback.

Return to top

* [Topics](/topics)
* [Spotlight](/spotlight)
* [Resources & Tools](/resources-tools)
* [News & Events](/news-events)
* [Careers](/careers)
* [About](/about)

[Cybersecurity & Infrastructure Security Agency](/ "Go to the Cybersecurity & Infrastructure Security Agency homepage")

* [Facebook](https://www.facebook.com/CISA)
* [Twitter](https://twitter.com/CISAgov)
* [LinkedIn](https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency)
* [YouTube](https://www.youtube.com/%40cisagov)
* [Instagram](https://www.instagram.com/cisagov)
* [RSS](/subscribe-updates-cisa)

CISA Central
1-844-Say-CISA
SayCISA@cisa.dhs.gov

DHS Seal
CISA.gov
An official website of the U.S. Department of Homeland Security

* [About CISA](/about "About CISA")
* [Budget and Performance](https://www.dhs.gov/performance-financial-reports "Budget and Performance")
* [DHS.gov](https://www.dhs.gov "Department of Homeland Security")
* [FOIA Requests](https://www.dhs.gov/foia "FOIA Requests")
* [No FEAR Act](/no-fear-act "No FEAR Act Reporting")
* [Office of Inspector General](https://www.oig.dhs.gov/ "Office of Inspector General")
* [Privacy Policy](/privacy-policy "Privacy Policy")
* [Subscribe](https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138 "Subscribe to Email Updates")
* [The White House](https://www.whitehouse.gov/ "The White House")
* [USA.gov](https://www.usa.gov/ "USA.gov")
* [Website Feedback](/forms/feedback "Website Feedback")


