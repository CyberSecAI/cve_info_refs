=== Content from secunia.com_b965b2a8_20250125_000336.html ===


[Skip to main content](#main-content)
[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

[![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

Search

## Main navigation

* Solutions
  + Column 1
    - Business challenge
      * [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
      * [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
      * [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
      * [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
      * [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
      * [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
      * [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
      * [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
      * [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
      * [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
      * [Public sector](https://www.flexera.com/solutions/public-sector)
  + Column 2
    - Spend management by vendor
      * [IBM](https://www.flexera.com/solutions/vendor/ibm)
      * [Oracle](https://www.flexera.com/solutions/vendor/oracle)
      * [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
      * [SAP](https://www.flexera.com/solutions/vendor/sap)
      * [VMware](https://www.flexera.com/solutions/vendor/vmware)
      * [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
      * [AWS](https://www.flexera.com/solutions/vendor/aws)
      * [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
      * [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
      * [Adobe](https://www.flexera.com/solutions/vendor/adobe)

  ### Achieve more through a united FinOps and ITAM function

  The future is hybrid. Break down the walls between ITAM and FinOps to drive more revenue, more customer growth and more innovation.

  [Discover More](https://www.flexera.com/resources/hybrid-itam-finops)
* Products
  + Column 1
    - [Flexera One](https://www.flexera.com/products/flexera-one)
      * [IT Visibility](https://www.flexera.com/products/flexera-one/it-visibility)
      * [ITAM](https://www.flexera.com/products/flexera-one/it-asset-management)
      * [SaaS Management](https://www.flexera.com/products/flexera-one/saas-management)
      * [FinOps](https://www.flexera.com/products/flexera-one/finops)
      * [Technology Intelligence Platform](https://www.flexera.com/products/flexera-one/technology-intelligence-platform)
  + Column 2
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
      * [Snow Spend Optimizer](https://www.flexera.com/products/snow-atlas/snow-spend-optimizer)
      * [Snow SaaS Management](https://www.flexera.com/products/snow-atlas/snow-saas-management)
  + Column 3
    - Hide group
      * [Security](https://www.flexera.com/products/security)
      * [Application Readiness](https://www.flexera.com/products/adminstudio)
      * [All products](https://www.flexera.com/products)
      * [All Snow products](https://www.flexera.com/products/snow)
      * [Integrations](https://www.flexera.com/products/integrations)

  ### Flexera 2024 State of the Cloud Report

  What do transformative initiatives such as GenAI, machine learning and sustainability mean for the cloud? Check out the 2024 State of the Cloud Report to find the answer as well as all the latest cloud computing trends.

  [View Report](https://info.flexera.com/CM-REPORT-State-of-the-Cloud)
* Success
  + Column 1
    - [Customer success](https://www.flexera.com/customer-success)
      * Support
        + [Flexera support portal](https://community.flexera.com/s/support-hub)
        + [Flexera product documentation](https://docs.flexera.com)
        + [Snow product documentation](https://docs.snowsoftware.io/)
      * Services and training
        + [Services](https://www.flexera.com/customer-success/services)
        + [Training](https://www.flexera.com/customer-success/training)
  + Column 2
    - Hide group
      * [Technology Intelligence Awards](https://www.flexera.com/customer-success/awards)
      * [Flexera community](https://community.flexera.com/s/)

  ### Insights from Gartner®

  Find a curated series of actionable and objective insights for IT executives and their teams. Get expert insights from valued analysts, courtesy of Flexera.

  [Discover More](https://www.flexera.com/resources/gartner-analyst-research)
* Resources
  + Column 1
    - [Resources](https://www.flexera.com/resources)
      * [Webinars](https://www.flexera.com/resources?type%5Bwebinar%5D=webinar)
      * [Videos](https://www.flexera.com/resources?type%5Bvideo%5D=video)
      * [Datasheets](https://www.flexera.com/resources?type%5Bdatasheet%5D=datasheet)
      * [White papers & reports](https://www.flexera.com/resources?type%5Bwhite-paper-industry-report%5D=white-paper-industry-report)
  + Column 2
    - Hide group
      * [Blog](/blog/)
      * [Case studies](https://www.flexera.com/resources/case-studies)
      * [Events](https://www.flexera.com/resources?type%5Bevent%5D=event)
      * [Analyst Research](https://www.flexera.com/resources/gartner-analyst-research)
      * [Glossary](https://www.flexera.com/resources/glossary)
      * [Demos & trials](https://www.flexera.com/resources?type%5Bdemo-trials%5D=demo-trials)
      * [Business value calculator](https://www.flexera.com/resources/business-value-calculator)

  ### Flexera 2025 IT Priorities Report

  Insights from Flexera’s 2025 IT Priorities Report highlight what’s top of mind for IT decision makers in the year ahead. Discover the challenges, priorities and opportunities that will shape the future IT landscape.

  [View Report](https://info.flexera.com/ITV-REPORT-IT-Priorities)
* About
  + Column 1
    - [Company](https://www.flexera.com/about-us)
      * [About](https://www.flexera.com/about-us)
      * [Careers](https://www.flexera.com/about-us/careers)
      * [Contact](https://www.flexera.com/about-us/contact-us)
      * [Leadership](https://www.flexera.com/about-us/leadership)
    - [Partners](https://www.flexera.com/about-us/partners)
      * [Partner program](https://www.flexera.com/about-us/partners/partner-program)
      * [Partner directory](https://www.flexera.com/about-us/partners/directory)
  + Column 2
    - [Press center](https://www.flexera.com/about-us/press-center)
      * [Press releases](https://www.flexera.com/about-us/all-press-releases)
      * [Awards](https://www.flexera.com/about-us/press-center#awards)
      * [Articles](https://www.flexera.com/about-us/all-articles)
    - Hide group
      * Social responsibility
        + [ESG](https://www.flexera.com/about-us/environmental-social-governance)
        + [Diversity](https://www.flexera.com/about-us/diversity)

  ### More value with technology intelligence

  The unparalleled synergy of Flexera and Snow provides the Technology Intelligence you need for more efficiency, insight and governance than ever before.

  [Discover More](https://www.flexera.com/more-value-with-technology-intelligence)

Search

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

## External Links

* External Links
  + [Community](https://community.flexera.com/)
  + [Product Access](https://app.flexera.com/login)
  + [Partner Portal](https://flexera.channeltivity.com/Login)

[Book a demo](/about-us/contact-us?C_Interest1=sales)

# Secunia Research

## The world’s best vulnerability intelligence

The Secunia Research team from Flexera provides the most accurate and reliable source of vulnerability intelligence.

[Contact Us](https://www.flexera.com/about-us/contact-us?C_Interest1=sales&C_SolutionInterest=SVM)
Watch video (0:29)

Related links

* [Anatomy of a security advisory](https://www.flexera.com/resources/infographics/anatomy-of-a-security-advisory)
* [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)
* [Software Vulnerability Manager](/products/software-vulnerability-manager)
* [Security advisories from Secunia Research](https://www.flexera.com/products/security/software-vulnerability-advisories)
* [Report a vulnerability](https://www.flexera.com/about-us/contact-us/report-vulnerability)

 ![Secunia Research](/sites/default/files/2022-04/hero-secunia-research-bg.jpg)

Featured Details

## Multiple ways to consume Secunia Research

Secunia delivers software security research that provides reliable, curated and actionable vulnerability intelligence. Organizations can expect to receive standardized, validated and enriched vulnerability research on a specific version of a software product. Secunia Research supports four solutions:

![Software Vulnerability Research](/sites/default/files/2022-04/icon-secunia-research-svr.svg)

### [Software Vulnerability Research](https://www.flexera.com/products/software-vulnerability-research)

Software Vulnerability Research utilizes Secunia Research to drive awareness of vulnerabilities matching your specified criteria

[Learn More](https://www.flexera.com/products/software-vulnerability-research)

![Software Vulnerability Manager](/sites/default/files/2022-04/icon-secunia-research-svm.svg)

### [Software Vulnerability Manager](/products/software-vulnerability-manager)

Software Vulnerability Manager uses Secunia Research data to identify, prioritize and patch known vulnerable software detected in your environment

[Learn More](/products/software-vulnerability-manager)

![Data Platform](/sites/default/files/2022-04/icon-secunia-research-dp.svg)

### [Data Platform](https://www.flexera.com/products/data-platform)

Data Platform leverages Secunia Research to provide high-level insights based on major or minor versions of software in your normalized inventory

[Learn More](https://www.flexera.com/products/data-platform)

![Flexera One](/sites/default/files/2022-04/icon-secunia-research-flexera-one.svg)

### [Flexera One](/flexera-one)

Flexera One utilizes Secunia Research (alongside public NVD data) to provide more granular matching of build-level versions of software in your normalized inventory within its IT Asset Management and IT Visibility solutions

[Learn More](/flexera-one)

How it works

## Accurate, reliable vulnerability insights at your fingertips

The Secunia Research team from Flexera is comprised of several security specialists who conduct vulnerability research in various products in addition to testing, verifying and validating public vulnerability reports. Since its inception in 2002, the goal of the Secunia Research team is to provide the most accurate and reliable source of vulnerability intelligence.

Delivering the world’s best vulnerability intelligence requires skill and passion. Team members continually develop their skills exploring various high-profile closed and open-source software using a variety of approaches, focusing chiefly on thorough code audits and binary analysis. The team has received industry recognition, including naming members to [Microsoft’s Most Valuable Security Researchers](https://msrc-blog.microsoft.com/2019/08/07/announcing-2019-msrc-most-valuable-security-researchers/) list.

Secunia researchers discover hard-to-find vulnerabilities that aren’t normally identified with techniques such as fuzzing, and the results have been impressive. Members of the Secunia Research team have discovered critical vulnerabilities in products from vendors including Microsoft, Symantec, IBM, Adobe, RealNetworks, Trend Micro, HP, Blue Coat, Samba, CA, Mozilla and Apple.

The team produces invaluable security advisories based on research of the vulnerabilities affecting any given software update. Sometimes a single update can address multiple vulnerabilities of varying criticalities and threats; but these advisories aggregate and distill findings down to a single advisory perfect for the prioritization of patching efforts within [Software Vulnerability Manager](/products/software-vulnerability-manager). Criticality scores are consistently applied along with details around attack vector and other valuable details within [Software Vulnerability Research](/products/software-vulnerability-research/secunia-research). Illegitimate vulnerability reports are also investigated and rejected so you can focus only on what truly matters.

Informing IT, Transforming IT

## Industry insights to help keep you informed

[#### Webinar

### Stay Ahead of Cyber Threats: Flexera's Latest Vulnerability Insights

Join us for this session where we'll explore the latest findings from the Flexera Monthly Vulnerability Insights Report.](https://info.flexera.com/SVM-WBNR-Vulnerability-Insights-Roundtable)

[#### Webinar

### Dive deeper into the Flexera Annual Vulnerability Insights

We'll explore the key findings from the Flexera Annual Vulnerability Insights Report. Learn about the latest cybersecurity trends, the most targeted industries, the types of vulnerabilities, plus management and mitigation strategies.](https://info.flexera.com/SVM-WBNR-Flexera-Annual-Vulnerability-Insights?lead_source=Website%20Visitor&id=Flexera.com-Resources)

#### Video

### Close the Risk Window with Software Vulnerability Manager

Stop reacting. Gain control. Stay secure. Build a more effective risk mitigation process leveraging Secunia Research vulnerability intelligence and the largest repository of third-party patch data in the industry.

Remote video URL

[#### Trial

### Software Vulnerability Manager Assessment free trial

Get access to the complete set of modules of Software Vulnerability Manager: Research, Assessment and Patching](https://info.flexera.com/SVM-EVAL-Software-Vulnerability-Manager)

[#### Datasheet

### Protect your ServiceNow® investment with the highest quality data

IT Visibility offers certified ServiceNow integrations that accelerate platform expansion, improve ROI and increase efficiencies across ITIL processes by delivering clean software and hardware asset data directly.](/sites/default/files/datasheet-itv-maximize-servicenow-investment.pdf)

[#### Blog

### Avoid missing crucial vulnerability intelligence amid NVD backlog

Recent developments regarding the National Vulnerability Database (NVD) have some technology leaders on edge. Since February, the U.S. National Institute of Standards and Technology (NIST) has almost completely stopped enriching software vulnerabi...](https://www.flexera.com/blog/vulnerability-management/avoid-missing-crucial-vulnerability-intelligence-amid-nvd-backlog/)

[View all resources](https://www.flexera.com/resources?category%5Bsoftware-vulnerability-management%5D=software-vulnerability-management)

## Footer Menu

* Column
  + Business challenge
    - [Software renewals and audits](https://www.flexera.com/solutions/software-renewals-audits)
    - [Software license management and optimization](https://www.flexera.com/solutions/software-usage-costs)
    - [SaaS spend management](https://www.flexera.com/solutions/saas-spend)
    - [Cloud cost management](https://www.flexera.com/solutions/cloud-cost)
    - [IT asset lifecycle management](https://www.flexera.com/solutions/it-asset-lifecycle)
    - [CMDB data quality](https://www.flexera.com/solutions/cmdb-data-quality)
    - [Accurate IT inventory](https://www.flexera.com/solutions/it-inventory)
    - [Security and regulatory risk management](https://www.flexera.com/solutions/it-security-regulatory-risk)
    - [Sustainable IT](https://www.flexera.com/solutions/sustainable-it)
    - [AI-powered transformation](https://www.flexera.com/solutions/ai-powered-transformation)
    - [Public sector](https://www.flexera.com/solutions/public-sector)
* Column
  + Spend management by vendor
    - [IBM](https://www.flexera.com/solutions/vendor/ibm)
    - [Oracle](https://www.flexera.com/solutions/vendor/oracle)
    - [Microsoft](https://www.flexera.com/solutions/vendor/microsoft)
    - [SAP](https://www.flexera.com/solutions/vendor/sap)
    - [VMware](https://www.flexera.com/solutions/vendor/vmware)
    - [ServiceNow](https://www.flexera.com/solutions/vendor/servicenow)
    - [AWS](https://www.flexera.com/solutions/vendor/aws)
    - [Salesforce](https://www.flexera.com/solutions/vendor/salesforce)
    - [BMC](https://www.flexera.com/solutions/cmdb-data-quality/bmc)
    - [Adobe](https://www.flexera.com/solutions/vendor/adobe)
* Column
  + Products
    - [Flexera One](https://www.flexera.com/products/flexera-one)
    - [Snow Atlas](https://www.flexera.com/products/snow-atlas)
    - [Security](https://www.flexera.com/products/security)
    - [Application Readiness](https://www.flexera.com/products/adminstudio)
    - [All products](https://www.flexera.com/products)
    - [All Snow products](https://www.flexera.com/products/snow)
    - [Integrations](https://www.flexera.com/products/integrations)
* Column
  + Company
    - [About](https://www.flexera.com/about-us)
    - [Careers](https://www.flexera.com/about-us/careers)
    - [Leadership](https://www.flexera.com/about-us/leadership)
    - [Contact us](https://www.flexera.com/about-us/contact-us)
    - [Media / press center](https://www.flexera.com/about-us/press-center)
    - [Revenera.com](https://www.revenera.com)

 +1.800.374.4353

en

* [English](https://www.flexera.com/products/security/software-vulnerability-research/secunia-research?referrer=secunia)
* [Deutsch](https://www.flexera.de/products/security/software-vulnerability-research/secunia-research?referrer=secunia)

 [![Home](/themes/custom/flexera/images/logo.svg)](https://www.flexera.com/)

© 2025 Flexera. All Rights Reserved.

## Footer

* [Privacy Policy](https://www.flexera.com/legal/privacy-policy)
* [Terms and conditions](https://www.flexera.com/legal)
* [Contact Us](https://www.flexera.com/about-us/contact-us)
* [Impressum](https://www.flexera.com/about-us/impressum)
* [Site Map](https://www.flexera.com/sitemap)

#####

×

...



=== Content from github.com_e1eb34cd_20250125_000347.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffail2ban%2Ffail2ban%2Fblob%2Fsdist%2F0.8.5%2FChangeLog)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffail2ban%2Ffail2ban%2Fblob%2Fsdist%2F0.8.5%2FChangeLog)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=fail2ban%2Ffail2ban)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[fail2ban](/fail2ban)
/
**[fail2ban](/fail2ban/fail2ban)**
Public

* [Notifications](/login?return_to=%2Ffail2ban%2Ffail2ban) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2Ffail2ban%2Ffail2ban)
* [Star
   13k](/login?return_to=%2Ffail2ban%2Ffail2ban)

* [Code](/fail2ban/fail2ban/tree/sdist/0.8.5)
* [Issues
  144](/fail2ban/fail2ban/issues)
* [Pull requests
  97](/fail2ban/fail2ban/pulls)
* [Discussions](/fail2ban/fail2ban/discussions)
* [Actions](/fail2ban/fail2ban/actions)
* [Projects
  0](/fail2ban/fail2ban/projects)
* [Wiki](/fail2ban/fail2ban/wiki)
* [Security](/fail2ban/fail2ban/security)
* [Insights](/fail2ban/fail2ban/pulse)

Additional navigation options

* [Code](/fail2ban/fail2ban/tree/sdist/0.8.5)
* [Issues](/fail2ban/fail2ban/issues)
* [Pull requests](/fail2ban/fail2ban/pulls)
* [Discussions](/fail2ban/fail2ban/discussions)
* [Actions](/fail2ban/fail2ban/actions)
* [Projects](/fail2ban/fail2ban/projects)
* [Wiki](/fail2ban/fail2ban/wiki)
* [Security](/fail2ban/fail2ban/security)
* [Insights](/fail2ban/fail2ban/pulse)

## Files

 sdist/0.8.5
## Breadcrumbs

1. [fail2ban](/fail2ban/fail2ban/tree/sdist/0.8.5)
/
# ChangeLog

Copy path Blame  Blame
## Latest commit

## History

[History](/fail2ban/fail2ban/commits/sdist/0.8.5/ChangeLog)439 lines (407 loc) · 19.5 KB sdist/0.8.5
## Breadcrumbs

1. [fail2ban](/fail2ban/fail2ban/tree/sdist/0.8.5)
/
# ChangeLog

Top
## File metadata and controls

* Code
* Blame

439 lines (407 loc) · 19.5 KB[Raw](https://github.com/fail2ban/fail2ban/raw/refs/tags/sdist/0.8.5/ChangeLog)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439 \_\_ \_ \_ \_\_\_ \_  / \_|\_\_ \_(\_) |\_ ) |\_\_ \_\_ \_ \_ \_  | \_/ \_` | | |/ /| '\_ \/ \_` | ' \  |\_| \\_\_,\_|\_|\_/\_\_\_|\_.\_\_/\\_\_,\_|\_||\_|
================================================================================Fail2Ban (version 0.8.5) 2011/07/28================================================================================
ver. 0.8.5 (2011/07/28) - stable----------- Fix: use addfailregex instead of failregex while processing per-jail "failregex" parameter (Fixed Debian bug #635830, LP: #635036). Thanks to Marat Khayrullin for the patch and Daniel T Chen for forwarding to Debian.- Fix: use os.path.join to generate full path - fixes includes in configs given local filename (5 weeks ago) [yarikoptic]- Fix: allowed for trailing spaces in proftpd logs- Fix: escaped () in pure-ftpd filter. Thanks to Teodor- Fix: allowed space in the trailing of failregex for sasl.conf: see http://bugs.debian.org/573314- Fix: use /var/run/fail2ban instead of /tmp for temp files in actions: see http://bugs.debian.org/544232- Fix: Tai64N stores time in GMT, needed to convert to local time before returning- Fix: disabled named-refused-udp jail entirely with a big fat warning- Fix: added time module. Bug reported in buanzo's blog: see http://blogs.buanzo.com.ar/2009/04/fail2ban-patch-ban-ip-address-manually.html- Fix: Patch to make log file descriptors cloexec to stop leaking file descriptors on fork/exec. Thanks to Jonathan Underwood: see https://bugzilla.redhat.com/show\_bug.cgi?id=230191#c24- Enhancement: added author for dovecot filter and pruned unneeded space in the regexp- Enhancement: proftpd filter -- if login failed -- count regardless of the reason for failure- Enhancement: added <chain> to action.d/iptables\*. Thanks to Matthijs Kooijman: see http://bugs.debian.org/515599- Enhancement: added filter.d/dovecot.conf from Martin Waschbuesch- Enhancement: made filter.d/apache-overflows.conf catch more: see http://bugs.debian.org/574182- Enhancement: added dropbear filter from Francis Russell and Zak B. Elep: see http://bugs.debian.org/546913- Enhancement: changed default ignoreip to ignore entire loopback zone (/8): see http://bugs.debian.org/598200- Minor: spell-checked jail.conf. Thanks to Christoph Anton Mitterer- Few minor cosmetic changes
ver. 0.8.4 (2009/09/07) - stable----------- Check the inode number for rotation in addition to checking the first line of the file. Thanks to Jonathan Kamens. Red Hat #503852. Tracker #2800279.- Moved the shutdown of the logging subsystem out of Server.quit() to the end of Server.start(). Fixes the 'cannot release un-acquired lock' error.- Added "Ban IP" command. Thanks to Arturo 'Buanzo' Busleiman.- Added two new filters: lighttpd-fastcgi and php-url-fopen.- Fixed the 'unexpected communication error' problem by means of use\_poll=False in Python >= 2.6.- Merged patches from Debian package. Thanks to Yaroslav Halchenko.- Use current day and month instead of Jan 1st if both are not available in the log. Thanks to Andreas Itzchak Rehberg.- Try to match the regex even if the line does not contain a valid date/time. Described in Debian #491253. Thanks to Yaroslav Halchenko.- Added/improved filters and date formats.- Added actions to report abuse to ISP, DShield and myNetWatchman. Thanks to Russell Odom.- Suse init script. Remove socket file on startup is fail2ban crashed. Thanks to Detlef Reichelt.- Removed begin-line anchor for "standard" timestamp. Fixed Debian bug #500824.- Added nagios script. Thanks to Sebastian Mueller.- Added CPanel date format. Thanks to David Collins. Tracker #1967610.- Improved SASL filter. Thanks to Loic Pefferkorn. Tracker #2310410.- Added NetBSD ipfilter (ipf command) action. Thanks to Ed Ravin. Tracker #2484115.- Added cyrus-imap and sieve filters. Thanks to Jan Wagner. Debian bug #513953.- Changed <HOST> template to be more restrictive. Debian bug #514163.- Use timetuple instead of utctimetuple for ISO 8601. Maybe not a 100% correct fix but seems to work. Tracker #2500276.- Made the named-refused regex a bit less restrictive in order to match logs with "view". Thanks to Stephen Gildea.- Fixed maxretry/findtime rate. Many thanks to Christos Psonis. Tracker #2019714.
ver. 0.8.3 (2008/07/17) - stable----------- Process failtickets as long as failmanager is not empty.- Added "pam-generic" filter and more configuration fixes. Thanks to Yaroslav Halchenko.- Fixed socket path in redhat and suse init script. Thanks to Jim Wight.- Fixed PID file while started in daemon mode. Thanks to Christian Jobic who submitted a similar patch.- Fixed "fail2ban-client get <jail> logpath". Bug #1916986.- Added gssftpd filter. Thanks to Kevin Zembower.- Added "Day/Month/Year Hour:Minute:Second" date template. Thanks to Dennis Winter.- Fixed ignoreregex processing in fail2ban-client. Thanks to René Berber.- Added ISO 8601 date/time format.- Added and changed some logging level and messages.- Added missing ignoreregex to filters. Thanks to Klaus Lehmann.- Use poll instead of select in asyncore.loop. This should solve the "Unknown error 514". Thanks to Michael Geiger and Klaus Lehmann.
ver. 0.8.2 (2008/03/06) - stable----------- Fixed named filter. Thanks to Yaroslav Halchenko- Fixed wrong path for apache-auth in jail.conf. Thanks to Vincent Deffontaines- Fixed timezone bug with epoch date template. Thanks to Michael Hanselmann- Added "full line failregex" patch. Thanks to Yaroslav Halchenko. It will be possible to create stronger failregex against log injection- Fixed ipfw action script. Thanks to Nick Munger- Removed date from logging message when using SYSLOG. Thanks to Iain Lea- Fixed "ignore IPs". Only the first value was taken into account. Thanks to Adrien Clerc- Moved socket to /var/run/fail2ban.- Rewrote the communication server.- Refactoring. Reduced number of files.- Removed Python 2.4. Minimum required version is now Python 2.3.- New log rotation detection algorithm.- Print monitored files in status.- Create a PID file in /var/run/fail2ban/. Thanks to Julien Perez.- Fixed "Feb 29" bug. Thanks to James Andrewartha who pointed this out. Thanks to Yaroslav Halchenko for the fix.- "reload <jail>" reloads a single jail and the parameters in fail2ban.conf.- Added Mac OS/X startup script. Thanks to Bill Heaton.- Absorbed some Debian patches. Thanks to Yaroslav Halchenko.- Replaced "echo" with "printf" in actions. Fix #1839673- Replaced "reject" with "drop" in shorwall action. Fix #1854875- Fixed Debian bug #456567, #468477, #462060, #461426- readline is now optional in fail2ban-client (not needed in fail2ban-server).
ver. 0.8.1 (2007/08/14) - stable----------- Fixed vulnerability in sshd.conf. Thanks to Daniel B. Cid- Expand <HOST> in ignoreregex. Thanks to Yaroslav Halchenko- Improved regular expressions. Thanks to Yaroslav Halchenko and others- Added sendmail actions. The action started with "mail" are now deprecated. Thanks to Raphaël Marichez- Added "ignoreregex" support to fail2ban-regex- Updated suse-initd and added it to MANIFEST. Thanks to Christian Rauch- Tightening up the pid check in redhat-initd. Thanks to David Nutter- Added webmin authentication filter. Thanks to Guillaume Delvit- Removed textToDns() which is not required anymore. Thanks to Yaroslav Halchenko- Added new action iptables-allports. Thanks to Yaroslav Halchenko- Added "named" date format to date detector. Thanks to Yaroslav Halchenko- Added filter file for named (bind9). Thanks to Yaroslav Halchenko- Fixed vsftpd filter. Thanks to Yaroslav Halchenko
ver. 0.8.0 (2007/05/03) - stable----------- Fixed RedHat init script. Thanks to Jonathan Underwood- Added Solaris 10 files. Thanks to Hanno 'Rince' Wagner
ver. 0.7.9 (2007/04/19) - release candidate----------- Close opened handlers. Thanks to Yaroslav Halchenko- Fixed "reload" bug. Many many thanks to Yaroslav Halchenko- Added date format for asctime without year- Modified filters config. Thanks to Michael C. Haller- Fixed a small bug in mail-buffered.conf
ver. 0.7.8 (2007/03/21) - release candidate----------- Fixed asctime pattern in datedetector.py- Added new filters/actions. Thanks to Yaroslav Halchenko- Added Suse init script and modified gentoo-initd. Thanks to Christian Rauch- Moved every locking statements in a try..finally block
ver. 0.7.7 (2007/02/08) - release candidate----------- Added signal handling in fail2ban-client- Added a wonderful visual effect when waiting on the server- fail2ban-client returns an error code if configuration is not valid- Added new filters/actions. Thanks to Yaroslav Halchenko- Call Python interpreter directly (instead of using "env")- Added file support to fail2ban-regex. Benchmark feature has been removed- Added cacti script and template.- Added IP list in "status <JAIL>". Thanks to Eric Gerbier
ver. 0.7.6 (2007/01/04) - beta----------- Added a "sleep 1" in redhat-initd. Thanks to Jim Wight- Use /dev/log for SYSLOG output. Thanks to Joerg Sommrey- Use numeric output for iptables in "actioncheck"- Fixed removal of host in hosts.deny. Thanks to René Berber- Added new date format (2006-12-21 06:43:20) and Exim4 filter. Thanks to mEDI- Several "failregex" and "ignoreregex" are now accepted. Creation of rules should be easier now.- Added license in COPYING. Thanks to Axel Thimm- Allow comma in action options. The value of the option must be escaped with " or '. Thanks to Yaroslav Halchenko- Now Fail2ban goes in /usr/share/fail2ban instead of /usr/lib/fail2ban. This is more compliant with FHS. Thanks to Axel Thimm and Yaroslav Halchenko
ver. 0.7.5 (2006/12/07) - beta----------- Do not ban a host that is currently banned. Thanks to Yaroslav Halchenko- The supported tags in "action(un)ban" are <ip>, <failures> and <time>- Fixed refactoring bug (getLastcommand -> getLastAction)- Added option "ignoreregex" in filter scripts and jail.conf. Feature Request #1283304- Fixed a bug in user defined time regex/pattern- Improved documentation- Moved version.py and protocol.py to common/- Merged "maxtime" option with "findtime"- Added "<HOST>" tag support in failregex which matches default IP address/hostname. "(?P<host>\S)" is still valid and supported- Fixed exception when calling fail2ban-server with unknown option- Fixed Debian bug 400162. The "socket" option is now handled correctly by fail2ban-client- Fixed RedHat init script. Thanks to Justin Shore- Changed timeout to 30 secondes before assuming the server cannot be started. Thanks to Joël Bertrand
ver. 0.7.4 (2006/11/01) - beta----------- Improved configuration files. Thanks to Yaroslav Halchenko- Added man page for "fail2ban-regex"- Moved ban/unban messages from "info" level to "warn"- Added "-s" option to specify the socket path and "socket" option in "fail2ban.conf"- Added "backend" option in "jail.conf"- Added more filters/actions and jail samples. Thanks to Nick Munger, Christoph Haas- Improved testing framework- Fixed a bug in the return code handling of the executed commands. Thanks to Yaroslav Halchenko- Signal handling. There is a bug with join() and signal in Python- Better debugging output for "fail2ban-regex"- Added support for more date format- cPickle does not work with Python 2.5. Use pickle instead (performance is not a problem in our case)
ver. 0.7.3 (2006/09/28) - beta----------- Added man pages. Thanks to Yaroslav Halchenko- Added wildcard support for "logpath"- Added Gamin (file and directory monitoring system) support- (Re)added "ignoreip" option- Added more concurrency protection- First attempt at solving bug #1457620 (locale issue)- Performance improvements- (Re)added permanent banning with banTime < 0- Added DNS support to "ignoreip". Feature Request #1285859
ver. 0.7.2 (2006/09/10) - beta----------- Refactoring and code cleanup- Improved client output- Added more get/set commands- Added more configuration templates- Removed "logpath" and "maxretry" from filter templates. They must be defined in jail.conf now- Added interactive mode. Use "-i"- Added a date detector. "timeregex" and "timepattern" are no more needed- Added "fail2ban-regex". This is a tool to help finding "failregex"- Improved server communication. Start a new thread for each incoming request. Fail2ban is not really thread-safe yet
ver. 0.7.1 (2006/08/23) - alpha----------- Fixed daemon mode bug- Added Gentoo init.d script- Fixed path bug when trying to start "fail2ban-server"- Fixed reload command
ver. 0.7.0 (2006/08/23) - alpha----------- Almost a complete rewrite :) Fail2ban design is really better (IMHO). There is a lot of new features- Client/Server architecture- Multithreading. Each jail has its own threads: one for the log reading and another for the actions- Execute several actions- Split configuration files. They are more readable and easy to use- failregex uses group (<host>) now. This feature was already present in the Debian package- lots of things...
ver. 0.6.1 (2006/03/16) - stable----------- Added permanent banning. Set banTime to a negative value to enable this feature (-1 is perfect). Thanks to Mannone- Fixed locale bug. Thanks to Fernando José- Fixed crash when time format does not match data- Propagated patch from Debian to fix fail2ban search path addition to the path search list: now it is added first. Thanks to Nick Craig-Wood- Added SMTP authentification for mail notification. Thanks to Markus Hoffmann- Removed debug mode as it is confusing for people- Added parsing of timestamp in TAI64N format (#1275325). Thanks to Mark Edgington- Added patch #1382936 (Default formatted syslog logging). Thanks to Patrick B�rjesson- Removed 192.168.0.0/16 from ignoreip. Attacks could also come from the local network.- Robust startup: if iptables module does not get fully initialized after startup of fail2ban, fail2ban will do "maxreinit" attempts to initialize its own firewall. It will sleep between attempts for "polltime" number of seconds (closes Debian: #334272). Thanks to Yaroslav Halchenko- Added "interpolations" in fail2ban.conf. This is provided by the ConfigParser module. Old configuration files still work. Thanks to Yaroslav Halchenko- Added initial support for hosts.deny and shorewall. Need more testing. Please test. Thanks to kojiro from Gentoo forum for hosts.deny support- Added support for vsftpd. Thanks to zugeschmiert
ver. 0.6.0 (2005/11/20) - stable----------- Propagated patches introduced by Debian maintainer (Yaroslav Halchenko): \* Added an option to report local time (including timezone) or GMT in mail notification.
ver. 0.5.5 (2005/10/26) - beta----------- Propagated patches introduced by Debian maintainer (Yaroslav Halchenko): \* Introduced fwcheck option to verify consistency of the chains. Implemented automatic restart of fail2ban main function in case check of fwban or fwunban command failed (closes: #329163, #331695). (Introduced patch was further adjusted by upstream author). \* Added -f command line parameter for [findtime]. \* Added a cleanup of firewall rules on emergency shutdown when unknown exception is catched. \* Fail2ban should not crash now if a wrong file name is specified in config. \* reordered code a bit so that log targets are setup right after background and then only loglevel (verbose, debug) is processed, so the warning could be seen in the logs \* Added a keyword <section> in parsing of the subject and the body of an email sent out by fail2ban (closes: #330311)
ver. 0.5.4 (2005/09/13) - beta----------- Fixed bug #1286222.- Propagated patches introduced by Debian maintainer (Yaroslav Halchenko): \* Fixed handling of SYSLOG logging target. Now it can log to any SYSLOG target and facility as directed by the config \* Format of SYSLOG entries fixed to look closer to standard \* Fixed errata in config/gentoo-confd \* Introduced findtime configuration variable to control the lifetime of caught "failed" log entries ver. 0.5.3 (2005/09/08) - beta----------- Fixed a bug when overriding "maxfailures" or "bantime". Thanks to Yaroslav Halchenko- Added more debug output if an error occurs when sending mail. Thanks to Stephen Gildea- Renamed "maxretry" to "maxfailures" and changed default value to 5. Thanks to Stephen Gildea- Hopefully fixed bug #1256075- Fixed bug #1262345- Fixed exception handling in PIDLock- Removed warning when using "-V" or "-h" with no config file. Thanks to Yaroslav Halchenko- Removed "-i eth0" from config file. Thanks to Yaroslav Halchenko
ver. 0.5.2 (2005/08/06) - beta----------- Better PID lock file handling. Should close #1239562- Added man pages- Removed log4py dependency. Use logging module instead- "maxretry" and "bantime" can be overridden in each section- Fixed bug #1246278 (excessive memory usage)- Fixed crash on wrong option value in configuration file- Changed custom chains to lowercase
ver. 0.5.1 (2005/07/23) - beta----------- Fixed bugs #1241756, #1239557- Added log targets in configuration file. Removed -l option- Changed iptables rules in order to create a separated chain for each section- Fixed static banList in firewall.py- Added an initd script for Debian. Thanks to Yaroslav Halchenko- Check for obsolete files after install
ver. 0.5.0 (2005/07/12) - beta----------- Added support for CIDR mask in ignoreip- Added mail notification support- Fixed bug #1234699- Added tags replacement in rules definition. Should allow a clean solution for Feature Request #1229479- Removed "interface" and "firewall" options- Added start and end commands in the configuration file. Thanks to Yaroslav Halchenko- Added firewall rules definition in the configuration file- Cleaned fail2ban.py- Added an initd script for RedHat/Fedora. Thanks to Andrey G. Grozin
ver. 0.4.1 (2005/06/30) - stable----------- Fixed textToDNS method which generated wrong matches for "rhost=12-xyz...". Thanks to Tom Pike- fail2ban.conf modified for readability. Thanks to Iain Lea- Added an initd script for Gentoo- Changed default PID lock file location from /tmp to /var/run
ver. 0.4.0 (2005/04/24) - stable----------- Fixed textToDNS which did not recognize strings like "12-345-67-890.abcd.mnopqr.xyz"
ver. 0.3.1 (2005/03/31) - beta----------- Corrected level of messages- Added DNS lookup support- Improved parsing speed. Only parse the new log messages- Added a second verbose level (-vv)
ver. 0.3.0 (2005/02/24) - beta----------- Re-writting of parts of the code in order to handle several log files with different rules- Removed sshd.py because it is no more needed- Fixed a bug when exiting with IP in the ban list- Added PID lock file- Improved some parts of the code- Added ipfw-start-rule option (thanks to Robert Edeker)- Added -k option which kills a currently running Fail2Ban
ver. 0.1.2 (2004/11/21) - beta----------- Add ipfw and ipfwadm support. The rules are taken from BlockIt. Thanks to Robert Edeker- Add -e option which allows to set the interface. Thanks to Robert Edeker who reminded me this- Small code cleaning
ver. 0.1.1 (2004/10/23) - beta----------- Add SIGTERM handler in order to exit nicely when in daemon mode- Add -r option which allows to set the maximum number of login failures- Remove the Metalog class as the log file are not so syslog daemon specific- Rewrite log reader to be service centered. Sshd support added. Match "Failed password" and "Illegal user"- Add /etc/fail2ban.conf configuration support- Code documentation
ver. 0.1.0 (2004/10/12) - alpha----------- Initial release

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugs.debian.org_ca321237_20250125_000346.html ===

# Debian Bug report logs - #544232 fail2ban: Insecure creating/writing to tmpfile

[![version graph](version.cgi?fixed=fail2ban%2F0.8.4%2Bsvn20110323-1;collapse=1;width=2;found=fail2ban%2F0.8.4-3;found=fail2ban%2F0.8.3-2sid1;height=2;absolute=0;package=fail2ban)](version.cgi?info=1;collapse=1;fixed=fail2ban%2F0.8.4%2Bsvn20110323-1;absolute=0;package=fail2ban;found=fail2ban%2F0.8.4-3;found=fail2ban%2F0.8.3-2sid1)

Package:
[fail2ban](pkgreport.cgi?package=fail2ban);
Maintainer for [fail2ban](pkgreport.cgi?package=fail2ban) is [Debian Python Team <team+python@tracker.debian.org>](pkgreport.cgi?maint=team%2Bpython%40tracker.debian.org); Source for [fail2ban](pkgreport.cgi?package=fail2ban) is [src:fail2ban](pkgreport.cgi?src=fail2ban) ([PTS](https://tracker.debian.org/pkg/fail2ban), [buildd](https://buildd.debian.org/fail2ban), [popcon](https://qa.debian.org/popcon.php?package=fail2ban)).

Reported by: [Tomasz Papszun <tomek@lodz.tpsa.pl>](pkgreport.cgi?submitter=tomek%40lodz.tpsa.pl)

Date: Sat, 29 Aug 2009 21:09:01 UTC

Severity: important

Tags: lenny, security, squeeze

Found in versions fail2ban/0.8.4-3, fail2ban/0.8.3-2sid1

Fixed in version fail2ban/0.8.4+svn20110323-1

**Done:** Yaroslav Halchenko <debian@onerussian.com>

Bug is archived. No further changes may be made.

Forwarded to Cyril Jaquier <cyril.jaquier@fail2ban.org>

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=544232;mbox=yes), [status mbox](bugreport.cgi?bug=544232;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=544232;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Yaroslav Halchenko <debian@onerussian.com>`:

`Bug#544232`; Package `fail2ban`.
(Sat, 29 Aug 2009 21:09:05 GMT) ([full text](bugreport.cgi?bug=544232;msg=2), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Tomasz Papszun <tomek@lodz.tpsa.pl>`:

New Bug report received and forwarded. Copy sent to `Yaroslav Halchenko <debian@onerussian.com>`.
(Sat, 29 Aug 2009 21:09:05 GMT) ([full text](bugreport.cgi?bug=544232;msg=4), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=544232;msg=5), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=tomek%40lodz.tpsa.pl)
From: Tomasz Papszun <tomek@lodz.tpsa.pl>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: fail2ban: Insecure creating/writing to tmpfile
Date: Sat, 29 Aug 2009 23:07:50 +0200
```
Package: fail2ban
Version: 0.8.3-2sid1
Severity: important

The files  /etc/fail2ban/action.d/mail-buffered.conf  and
/etc/fail2ban/action.d/sendmail-buffered.conf
use file in the writable-for-all directory for appending text, i.e.

printf %%b "`date`: <ip> (<failures> failures)\n" >> <tmpfile>

where  tmpfile = /tmp/fail2ban-mail.txt

Instead of that tmpfile definition, a unique filename should be used,
e.g. by means of mktemp(1), like:

tmpfile=`mktemp /tmp/f2ban-mail.txt.XXXXXXXXXX`

which will safely create a file named like
/tmp/f2ban-mail.txt.SsUtdRJQAg

Currently, tmpfile is defined just once - at the starting of the script,
if I understand the section [Init] correctly. As at the end of each
execution of actionban the tmpfile is removed, simple replacing tmpfile
definition with mktemp(1) in [Init] section won't do because now the
filename is known and the attacker can create it.
So probably, mktemp(1) should be used in the very definition of
actionban, but as I don't know Python, I'm not trying to prepare the
patch myself, sorry :-).

-- System Information:
Debian Release: 5.0.2
  APT prefers stable
  APT policy: (500, 'stable')
Architecture: i386 (i686)

Kernel: Linux 2.6.26-2-686 (SMP w/1 CPU core)
Locale: LANG=C, LC_CTYPE=pl_PL.iso-8859-2 (charmap=ISO-8859-2)
Shell: /bin/sh linked to /bin/bash

Versions of packages fail2ban depends on:
ii  lsb-base                      3.2-20     Linux Standard Base 3.2 init scrip
ii  python                        2.5.2-3    An interactive high-level object-o
ii  python-central                0.6.8      register and build utility for Pyt

Versions of packages fail2ban recommends:
ii  iptables                      1.4.2-6    administration tools for packet fi
ii  whois                         4.7.30     an intelligent whois client

Versions of packages fail2ban suggests:
ii  bsd-mailx [mailx]  8.1.2-0.20071201cvs-3 A simple mail user agent
ii  mailx              1:20071201-3          Transitional package for mailx ren
pn  python-gamin       <none>                (no description available)

-- no debconf information

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#544232`; Package `fail2ban`.
(Sat, 29 Aug 2009 23:00:04 GMT) ([full text](bugreport.cgi?bug=544232;msg=7), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Yaroslav Halchenko <debian@onerussian.com>`:

Extra info received and forwarded to list.
(Sat, 29 Aug 2009 23:00:04 GMT) ([full text](bugreport.cgi?bug=544232;msg=9), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 544232@bugs.debian.org ([full text](bugreport.cgi?bug=544232;msg=10), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40onerussian.com)
From: Yaroslav Halchenko <debian@onerussian.com>
To: Tomasz Papszun <tomek@lodz.tpsa.pl>, 544232@bugs.debian.org
Subject: Re: Bug#544232: fail2ban: Insecure creating/writing to tmpfile
Date: Sat, 29 Aug 2009 18:50:08 -0400
```
could you elaborate on what security implications (since you are talking
about attacks) this bug would result in? to me -- none (besides
'misinformation), since that file to accumulate the body of the email
which is to be sent upon actionstop.

if I am right, and there is no security implications, then I would like
to reduce severity to normal at most

On Sat, 29 Aug 2009, Tomasz Papszun wrote:

> Package: fail2ban
> Version: 0.8.3-2sid1
> Severity: important

> The files  /etc/fail2ban/action.d/mail-buffered.conf  and
> /etc/fail2ban/action.d/sendmail-buffered.conf
> use file in the writable-for-all directory for appending text, i.e.
--
                                  .-.
=------------------------------   /v\  ----------------------------=
Keep in touch                    // \\     (yoh@|www.)onerussian.com
Yaroslav Halchenko              /(   )\               ICQ#: 60653192
                   Linux User    ^^-^^    [175555]

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Yaroslav Halchenko <debian@onerussian.com>`:

`Bug#544232`; Package `fail2ban`.
(Sun, 30 Aug 2009 00:09:06 GMT) ([full text](bugreport.cgi?bug=544232;msg=12), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `Tomasz Papszun <tomek@lodz.tpsa.pl>`:

Extra info received and forwarded to list. Copy sent to `Yaroslav Halchenko <debian@onerussian.com>`.
(Sun, 30 Aug 2009 00:09:06 GMT) ([full text](bugreport.cgi?bug=544232;msg=14), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 544232@bugs.debian.org ([full text](bugreport.cgi?bug=544232;msg=15), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=tomek%40lodz.tpsa.pl)
From: Tomasz Papszun <tomek@lodz.tpsa.pl>
To: Yaroslav Halchenko <debian@onerussian.com>
Cc: 544232@bugs.debian.org
Subject: Re: Bug#544232: fail2ban: Insecure creating/writing to tmpfile
Date: Sun, 30 Aug 2009 01:58:02 +0200
```
On Sat, 29 Aug 2009 at 18:50:08 -0400, Yaroslav Halchenko wrote:
> could you elaborate on what security implications (since you are talking
> about attacks) this bug would result in? to me -- none (besides
> 'misinformation), since that file to accumulate the body of the email
> which is to be sent upon actionstop.

You're welcome!
As the filename is predictable, and the directory is writable for
everybody, an attacker can create a symlink leading to any file, also to
files writable only for root. Then fail2ban (which runs as root) will
damage the target file while writing to the tmpfile. Well, at least the
most spectacular ;-( target (/etc/shadow) won't be overwritten, because,
AFAICS, the script appends (>>), not overwrites (>). But some
important file (e.g. a binary) can be damaged by appending some data to
it.

HTH

> if I am right, and there is no security implications, then I would like
> to reduce severity to normal at most
>
>                                   .-.
> =------------------------------   /v\  ----------------------------=
> Keep in touch                    // \\     (yoh@|www.)onerussian.com
> Yaroslav Halchenko              /(   )\               ICQ#: 60653192
>                    Linux User    ^^-^^    [175555]
>

--
 Tomasz Papszun                                     | And it's only
 tomek at lodz.tpsa.pl <http://www.lodz.tpsa.pl/iso/> | ones and zeros.
 tomek at clamav.net   <http://www.ClamAV.net/>   A GPL virus scanner

```

---

**Reply sent**
to `Yaroslav Halchenko <debian@onerussian.com>`:

You have marked Bug as forwarded.
(Sun, 30 Aug 2009 06:09:16 GMT) ([full text](bugreport.cgi?bug=544232;msg=17), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=17), [link](#16)).

---

[Message #18](#18) received at 544232-forwarded@bugs.debian.org ([full text](bugreport.cgi?bug=544232;msg=18), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=18), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40onerussian.com)
From: Yaroslav Halchenko <debian@onerussian.com>
To: Cyril Jaquier <cyril.jaquier@fail2ban.org>
Cc: Tomasz Papszun <tomek@lodz.tpsa.pl>, 544232-forwarded@bugs.debian.org
Subject: Re: Bug#544232: fail2ban: Insecure creating/writing to tmpfile
Date: Sun, 30 Aug 2009 02:04:03 -0400
```
[[Message part 1](bugreport.cgi?att=0;bug=544232;msg=18) (text/plain, inline)]
```
```

On Sun, 30 Aug 2009, Tomasz Papszun wrote:
> everybody, an attacker can create a symlink leading to any file, also to
> files writable only for root. Then fail2ban (which runs as root) will
ah, right -- I was silly... forwarding upstream for now

Cyril, could you please have a look at <http://bugs.debian.org/544232>

quite a few actions are prone to such a problem
$> git grep  -l tmpfile
action.d/dshield.conf
action.d/mail-buffered.conf
action.d/mynetwatchman.conf
action.d/sendmail-buffered.conf

none of these actions is enabled by default in any jail afaik but still
-- it would be better to work it out in a sane fashion

--
                                  .-.
=------------------------------   /v\  ----------------------------=
Keep in touch                    // \\     (yoh@|www.)onerussian.com
Yaroslav Halchenko              /(   )\               ICQ#: 60653192
                   Linux User    ^^-^^    [175555]

```
```
[[signature.asc](bugreport.cgi?att=1;bug=544232;filename=signature.asc;msg=18) (application/pgp-signature, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Yaroslav Halchenko <debian@onerussian.com>`:

`Bug#544232`; Package `fail2ban`.
(Sun, 31 Oct 2010 21:24:03 GMT) ([full text](bugreport.cgi?bug=544232;msg=20), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=20), [link](#19)).

---

**Acknowledgement sent**
to `Zbyszek Jędrzejewski-Szmek <zbyszek@in.waw.pl>`:

Extra info received and forwarded to list. Copy sent to `Yaroslav Halchenko <debian@onerussian.com>`.
(Sun, 31 Oct 2010 21:24:03 GMT) ([full text](bugreport.cgi?bug=544232;msg=22), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=22), [link](#21)).

---

[Message #23](#23) received at 544232@bugs.debian.org ([full text](bugreport.cgi?bug=544232;msg=23), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=23), reply):

![](/cgi-bin/libravatar.cgi?email=zbyszek%40in.waw.pl)
From: Zbyszek Jędrzejewski-Szmek <zbyszek@in.waw.pl>
To: 544232@bugs.debian.org
Subject: tentative [PATCH] issue5178: use a temporary directory or file
created with mktemp
Date: Sun, 31 Oct 2010 22:11:10 +0100
```
Using a directory is fine, as long as it is used only once: because
mktemp verifies that the directory didn't exists before when creating
it, the same temporary directory name cannot be safely used after
removing it. But actionstop which removes the temporary directory
should be run only once when closing fail2ban. If the configuration is
reloaded, a new temporary directory will be created, which is good.

Patch untested :(
---
 config/action.d/dshield.conf           |    5 +++--
 config/action.d/mail-buffered.conf     |    4 +++-
 config/action.d/mynetwatchman.conf     |    9 ++-------
 config/action.d/sendmail-buffered.conf |    5 +++--
 4 files changed, 11 insertions(+), 12 deletions(-)

diff --git a/config/action.d/dshield.conf b/config/action.d/dshield.conf
index b80698b..8dba15f 100644
--- a/config/action.d/dshield.conf
+++ b/config/action.d/dshield.conf
@@ -44,6 +44,7 @@ actionstop = if [ -f <tmpfile>.buffer ]; then
                  date +%%s > <tmpfile>.lastsent
              fi
              rm -f <tmpfile>.buffer <tmpfile>.first
+             rmdir <tmpdir>

 # Option:  actioncheck
 # Notes.:  command executed once before each actionban command
@@ -206,5 +207,5 @@ dest = reports@dshield.org
 # Notes.:  Base name of temporary files used for buffering
 # Values:  [ STRING ]  Default: /tmp/fail2ban-dshield
 #
-tmpfile = /tmp/fail2ban-dshield
-
+tmpdir = `mktemp --directory --suffix=-f2ban-dshield`
+tmpfile = <tmpdir>/dshield
diff --git a/config/action.d/mail-buffered.conf b/config/action.d/mail-buffered.conf
index 8a33d0e..00b734f 100644
--- a/config/action.d/mail-buffered.conf
+++ b/config/action.d/mail-buffered.conf
@@ -29,6 +29,7 @@ actionstop = if [ -f <tmpfile> ]; then
                  Fail2Ban"|mail -s "[Fail2Ban] <name>: Summary" <dest>
                  rm <tmpfile>
              fi
+             rmdir <tmpdir>
              printf %%b "Hi,\n
              The jail <name> has been stopped.\n
              Regards,\n
@@ -81,7 +82,8 @@ lines = 5

 # Default temporary file
 #
-tmpfile = /tmp/fail2ban-mail.txt
+tmpdir = `mktemp --directory --suffix=-f2ban-mail`
+tmpfile = <tmpdir>/buffer.txt

 # Destination/Addressee of the mail
 #
diff --git a/config/action.d/mynetwatchman.conf b/config/action.d/mynetwatchman.conf
index 15b91b1..9a1600f 100644
--- a/config/action.d/mynetwatchman.conf
+++ b/config/action.d/mynetwatchman.conf
@@ -66,7 +66,8 @@ actionban = MNWLOGIN=`perl -e '$s=shift;$s=~s/([\W])/"%%".uc(sprintf("%%2.2x",or
 	    PROTOCOL=`awk '{IGNORECASE=1;if($1=="<protocol>"){print $2;exit}}' /etc/protocols`
 	    if [ -z "$PROTOCOL" ]; then PROTOCOL=<protocol>; fi
 	    DATETIME=`perl -e '@t=gmtime(<time>);printf "%%4d-%%02d-%%02d+%%02d:%%02d:%%02d",1900+$t[5],$t[4]+1,$t[3],$t[2],$t[1],$t[0]'`
-            <getcmd> "<mnwurl>?AT=2&AV=0&AgentEmail=$MNWLOGIN&AgentPassword=$MNWPASS&AttackerIP=<ip>&SrcPort=<srcport>&ProtocolID=$PROTOCOL&DestPort=<port>&AttackCount=<failures>&VictimIP=<myip>&AttackDateTime=$DATETIME" 2>&1 >> <tmpfile>.out && grep -q 'Attack Report Insert Successful' <tmpfile>.out && rm -f <tmpfile>.out
+            TMPFILE=`mktemp --suffix -f2ban-mynetwatchman.out`
+            <getcmd> "<mnwurl>?AT=2&AV=0&AgentEmail=$MNWLOGIN&AgentPassword=$MNWPASS&AttackerIP=<ip>&SrcPort=<srcport>&ProtocolID=$PROTOCOL&DestPort=<port>&AttackCount=<failures>&VictimIP=<myip>&AttackDateTime=$DATETIME" 2>&1 >> "$TMPFILE" && grep -q 'Attack Report Insert Successful' "$TMPFILE" && rm -f "$TMPFILE"

 # Option:  actionunban
 # Notes.:  command executed when unbanning an IP. Take care that the
@@ -136,9 +137,3 @@ srcport = 0
 # Values:  STRING  Default: <http://mynetwatchman.com/insertwebreport.asp>
 #
 mnwurl = <http://mynetwatchman.com/insertwebreport.asp>
-
-# Option:  tmpfile
-# Notes.:  Base name of temporary files
-# Values:  [ STRING ]  Default: /tmp/fail2ban-mynetwatchman
-#
-tmpfile = /tmp/fail2ban-mynetwatchman
diff --git a/config/action.d/sendmail-buffered.conf b/config/action.d/sendmail-buffered.conf
index de8166a..3a4e950 100644
--- a/config/action.d/sendmail-buffered.conf
+++ b/config/action.d/sendmail-buffered.conf
@@ -35,6 +35,7 @@ actionstop = if [ -f <tmpfile> ]; then
                  Fail2Ban" | /usr/sbin/sendmail -f <sender> <dest>
                  rm <tmpfile>
              fi
+             rmdir <tmpdir>
              printf %%b "Subject: [Fail2Ban] <name>: stopped
              From: Fail2Ban <<sender>>
              To: <dest>\n
@@ -101,5 +102,5 @@ lines = 5

 # Default temporary file
 #
-tmpfile = /tmp/fail2ban-mail.txt
-
+tmpdir = `mktemp --directory --suffix=-f2ban-mail`
+tmpfile = <tmpdir>/buffer.txt
--
1.6.4.124.g27bb1

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#544232`; Package `fail2ban`.
(Mon, 01 Nov 2010 00:33:03 GMT) ([full text](bugreport.cgi?bug=544232;msg=25), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=25), [link](#24)).

---

**Acknowledgement sent**
to `Yaroslav Halchenko <debian@onerussian.com>`:

Extra info received and forwarded to list.
(Mon, 01 Nov 2010 00:33:03 GMT) ([full text](bugreport.cgi?bug=544232;msg=27), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=27), [link](#26)).

---

[Message #28](#28) received at 544232@bugs.debian.org ([full text](bugreport.cgi?bug=544232;msg=28), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=28), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40onerussian.com)
From: Yaroslav Halchenko <debian@onerussian.com>
To: Zbyszek Jędrzejewski-Szmek <zbyszek@in.waw.pl>,
544232@bugs.debian.org
Subject: Re: Bug#544232: tentative [PATCH] issue5178: use a temporary
directory or file created with mktemp
Date: Sun, 31 Oct 2010 20:30:23 -0400
```
Hi Zbyszek,

thanks for looking into it ...

action.d/mynetwatchman.conf  changes -- should be ok
action.d/mail-buffered.conf -- I don't think it would work...

> +tmpdir = `mktemp --directory --suffix=-f2ban-dshield`
> +tmpfile = <tmpdir>/dshield

since this is just a Python config file, it would simply substitute
`mktemp --directory --suffix=-f2ban-dshield`/dshield
for every occurrence of <tmpfile> which would be not what is desired...
am I correct?

as a generic and simple resolution, I think, tmpfiles should simply be
created under /var/run/fail2ban which belongs to root.  I think there
was some discussion in some other bugreport... or it is deja vu

agreed?

--
                                  .-.
=------------------------------   /v\  ----------------------------=
Keep in touch                    // \\     (yoh@|www.)onerussian.com
Yaroslav Halchenko              /(   )\               ICQ#: 60653192
                   Linux User    ^^-^^    [175555]

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Yaroslav Halchenko <debian@onerussian.com>`:

`Bug#544232`; Package `fail2ban`.
(Mon, 01 Nov 2010 08:06:03 GMT) ([full text](bugreport.cgi?bug=544232;msg=30), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=30), [link](#29)).

---

**Acknowledgement sent**
to `Zbyszek Szmek <zbyszek@in.waw.pl>`:

Extra info received and forwarded to list. Copy sent to `Yaroslav Halchenko <debian@onerussian.com>`.
(Mon, 01 Nov 2010 08:06:03 GMT) ([full text](bugreport.cgi?bug=544232;msg=32), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=32), [link](#31)).

---

[Message #33](#33) received at 544232@bugs.debian.org ([full text](bugreport.cgi?bug=544232;msg=33), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=33), reply):

![](/cgi-bin/libravatar.cgi?email=zbyszek%40in.waw.pl)
From: Zbyszek Szmek <zbyszek@in.waw.pl>
To: Yaroslav Halchenko <debian@onerussian.com>
Cc: 544232@bugs.debian.org
Subject: Re: Bug#544232: tentative [PATCH] issue5178: use a temporary
directory or file created with mktemp
Date: Mon, 1 Nov 2010 09:03:16 +0100
```
On Sun, Oct 31, 2010 at 08:30:23PM -0400, Yaroslav Halchenko wrote:
Hi Yaroslav,

> Hi Zbyszek,
>
> thanks for looking into it ...
Thanks for the quick reply :)

> action.d/mynetwatchman.conf  changes -- should be ok
This parts is still valid...

> action.d/mail-buffered.conf -- I don't think it would work...
...but the other three won't work indeed. (I had some strange
notion that the mktemp would get executed tmpdir variable initialization,
but it just gets substituted into the final command like you said.

>
> > +tmpdir = `mktemp --directory --suffix=-f2ban-dshield`
> > +tmpfile = <tmpdir>/dshield
>
> since this is just a Python config file, it would simply substitute
> `mktemp --directory --suffix=-f2ban-dshield`/dshield
> for every occurrence of <tmpfile> which would be not what is desired...
> am I correct?
>
>
> as a generic and simple resolution, I think, tmpfiles should simply be
> created under /var/run/fail2ban which belongs to root.  I think there
> was some discussion in some other bugreport... or it is deja vu
Yes, this is a much better solution! Is the /var/run/fail2ban/
directory exported as a variable so it can be used in action rules
without hardcoding the path?

> agreed?
Yeah, sorry for posting a complete untested patch ;(

```

---

**Reply sent**
to `Yaroslav Halchenko <debian@onerussian.com>`:

You have taken responsibility.
(Thu, 24 Mar 2011 06:57:05 GMT) ([full text](bugreport.cgi?bug=544232;msg=35), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=35), [link](#34)).

---

**Notification sent**
to `Tomasz Papszun <tomek@lodz.tpsa.pl>`:

Bug acknowledged by developer.
(Thu, 24 Mar 2011 06:57:06 GMT) ([full text](bugreport.cgi?bug=544232;msg=37), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=37), [link](#36)).

---

[Message #38](#38) received at 544232-close@bugs.debian.org ([full text](bugreport.cgi?bug=544232;msg=38), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=38), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40onerussian.com)
From: Yaroslav Halchenko <debian@onerussian.com>
To: 544232-close@bugs.debian.org
Subject: Bug#544232: fixed in fail2ban 0.8.4+svn20110323-1
Date: Thu, 24 Mar 2011 06:55:54 +0000
```
Source: fail2ban
Source-Version: 0.8.4+svn20110323-1

We believe that the bug you reported is fixed in the latest version of
fail2ban, which is due to be installed in the Debian FTP archive:

fail2ban_0.8.4+svn20110323-1.diff.gz
  to main/f/fail2ban/fail2ban_0.8.4+svn20110323-1.diff.gz
fail2ban_0.8.4+svn20110323-1.dsc
  to main/f/fail2ban/fail2ban_0.8.4+svn20110323-1.dsc
fail2ban_0.8.4+svn20110323-1_all.deb
  to main/f/fail2ban/fail2ban_0.8.4+svn20110323-1_all.deb
fail2ban_0.8.4+svn20110323.orig.tar.gz
  to main/f/fail2ban/fail2ban_0.8.4+svn20110323.orig.tar.gz

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 544232@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Yaroslav Halchenko <debian@onerussian.com> (supplier of updated fail2ban package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Format: 1.8
Date: Wed, 23 Mar 2011 17:04:56 -0400
Source: fail2ban
Binary: fail2ban
Architecture: source all
Version: 0.8.4+svn20110323-1
Distribution: unstable
Urgency: low
Maintainer: Yaroslav Halchenko <debian@onerussian.com>
Changed-By: Yaroslav Halchenko <debian@onerussian.com>
Description:
 fail2ban   - ban hosts that cause multiple authentication errors
Closes: [515599](bugreport.cgi?bug=515599) [544232](bugreport.cgi?bug=544232) [546913](bugreport.cgi?bug=546913) [573314](bugreport.cgi?bug=573314) [574182](bugreport.cgi?bug=574182) [588176](bugreport.cgi?bug=588176) [598200](bugreport.cgi?bug=598200) [598206](bugreport.cgi?bug=598206) [615952](bugreport.cgi?bug=615952)
Changes:
 fail2ban (0.8.4+svn20110323-1) unstable; urgency=low
 .
   * Fresh upstream snapshot which absorbed some of the patches from Debian
     and
     - [c6d64e9] debug entry for lines ignored due to falling below
       findtime (v2)
     - [fc20f12] Tai64N stores time in GMT, we need to convert to
       local time before returning
     - [b0331bb] default ignoreip to ignore entire loopback zone (/8)
       (Closes: #[598200](bugreport.cgi?bug=598200))
     - [b9f15f6] ENH: dovecot filter
     - [69165b1] ENH: add <chain> to action.d/iptables*. Thanks
       Matthijs Kooijman
     - [8330a20] ENH: make filter.d/apache-overflows.conf catch more
       (Closes: #[574182](bugreport.cgi?bug=574182))
     - [66cc6cb] BF: allow space in the trailing of failregex for sasl.conf
       (Closes: #[573314](bugreport.cgi?bug=573314))
     - [2714019] ENH: dropbear filter (Closes: #[546913](bugreport.cgi?bug=546913))
     - [ea7d352] BF: Use /var/run/fail2ban instead of /tmp for temp files in
       actions (Closes: #[544232](bugreport.cgi?bug=544232))
   * debian/jail.conf:
     - [bc8e22d] spellcheck (Closes: #[598206](bugreport.cgi?bug=598206)). Thanks Christoph Anton Mitterer
     - [d7f3e23] adjusted description for sasl jail (Closes: #[615952](bugreport.cgi?bug=615952))
     - [92fb484] debian/jail.conf: closing " for protocol specification
     - [f828c31] debian/jail.conf: got 'chain' parameter to be specified for
       iptables actions (Closes: #[515599](bugreport.cgi?bug=515599))
   * debian/control:
     - [858af30] slight rewordings of the long description (Closes: #[588176](bugreport.cgi?bug=588176))
     - [167dfd4] Boosted policy compliance version to 3.9.1 (no changes seems
       to be due)
   * [4e1e845] debian/copyright: updated copyright years
Checksums-Sha1:
 c816a57d19f9adbbf71eb2525a4068a88dac01db 1295 fail2ban_0.8.4+svn20110323-1.dsc
 b8d5e30c49f91c9326b58d56f03e90675b95c381 84726 fail2ban_0.8.4+svn20110323.orig.tar.gz
 fd8e842182240957e8bf2d9e03fc9963be013d90 30101 fail2ban_0.8.4+svn20110323-1.diff.gz
 9a84cd18747b5b471a64e13dba90495dfb9c3f31 97716 fail2ban_0.8.4+svn20110323-1_all.deb
Checksums-Sha256:
 d39fceaadb80445b00606c596b5a074a7a67b3e0ee7ae186a5f972293825a974 1295 fail2ban_0.8.4+svn20110323-1.dsc
 1aa7eec3e60043098664c3fd16139b4e5bd5faeb0117ba0c189f0ede48b1cad7 84726 fail2ban_0.8.4+svn20110323.orig.tar.gz
 6b637ba6a423d6cb777186cc2188c8676cd493cb4d4f391a509212e3c516f047 30101 fail2ban_0.8.4+svn20110323-1.diff.gz
 6b03d9c1a505e43df4fdec8662ebce0c9b7fbae65c8806ab300f369d7dcfeb6e 97716 fail2ban_0.8.4+svn20110323-1_all.deb
Files:
 4bc9e43afb40c7e6140448331c1ff92a 1295 net optional fail2ban_0.8.4+svn20110323-1.dsc
 1d0a94394d2bb5c616212839f3552b06 84726 net optional fail2ban_0.8.4+svn20110323.orig.tar.gz
 10ec0cd9c25815782398507053a104bd 30101 net optional fail2ban_0.8.4+svn20110323-1.diff.gz
 4119833765fa7de7ed57c7f055646b6b 97716 net optional fail2ban_0.8.4+svn20110323-1_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)

iEYEARECAAYFAk2KbLwACgkQjRFFY3XAJMhTEQCgoWfJbSIx2te2zcp+yGmUB1CA
bhAAoJORjFxwyF6FR1d6pp8n2+h1YlxV
=Er13
-----END PGP SIGNATURE-----

```

---

**Added tag(s) security.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Tue, 19 Apr 2011 18:33:04 GMT) ([full text](bugreport.cgi?bug=544232;msg=40), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=40), [link](#39)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Wed, 18 May 2011 07:36:14 GMT) ([full text](bugreport.cgi?bug=544232;msg=42), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=42), [link](#41)).

---

**Bug unarchived.**
Request was from `Jonathan Wiltshire <jmw@debian.org>`
to `control@bugs.debian.org`.
(Mon, 04 Jul 2011 20:36:03 GMT) ([full text](bugreport.cgi?bug=544232;msg=44), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=44), [link](#43)).

---

**Bug Marked as found in versions fail2ban/0.8.4-3.**
Request was from `Jonathan Wiltshire <jmw@debian.org>`
to `control@bugs.debian.org`.
(Mon, 04 Jul 2011 20:36:05 GMT) ([full text](bugreport.cgi?bug=544232;msg=46), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=46), [link](#45)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Yaroslav Halchenko <debian@onerussian.com>`:

`Bug#544232`; Package `fail2ban`.
(Mon, 04 Jul 2011 20:39:03 GMT) ([full text](bugreport.cgi?bug=544232;msg=48), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=48), [link](#47)).

---

**Acknowledgement sent**
to `Jonathan Wiltshire <jmw@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Yaroslav Halchenko <debian@onerussian.com>`.
(Mon, 04 Jul 2011 20:39:03 GMT) ([full text](bugreport.cgi?bug=544232;msg=50), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=50), [link](#49)).

---

[Message #51](#51) received at 544232@bugs.debian.org ([full text](bugreport.cgi?bug=544232;msg=51), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=51), reply):

![](/cgi-bin/libravatar.cgi?email=jmw%40debian.org)
From: Jonathan Wiltshire <jmw@debian.org>
To: Yaroslav Halchenko <debian@onerussian.com>, 544232@bugs.debian.org
Subject: (PRSC) Bug#544232: fail2ban: Insecure creating/writing to tmpfile
Date: Mon, 4 Jul 2011 21:37:38 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=544232;msg=51) (text/plain, inline)]
```
```
Dear maintainer,

Recently you fixed one or more security problems and as a result you closed
this bug. These problems were not serious enough for a Debian Security
Advisory, so they are now on my radar for fixing in the following suites
through point releases:

lenny (5.0.9)
squeeze (6.0.2)

Please prepare a minimal-changes upload targetting each of these suites,
and submit a debdiff to the Release Team [0] for consideration. They will
offer additional guidance or instruct you to upload your package.

I will happily assist you at any stage if the patch is straightforward and
you need help or lack time. Please keep me in CC at all times so I can
track the progress of this request.

For details of this process and the rationale, please see the original
announcement [1] and my blog post [2].

0: debian-release@lists.debian.org
1: <201101232332.11736.thijs@debian.org>
2: <http://deb.li/prsc>

Thanks,

with his security hat on:
--
Jonathan Wiltshire                                      jmw@debian.org
Debian Developer                         <http://people.debian.org/~jmw>

4096R: 0xD3524C51 / 0A55 B7C5 1223 3942 86EC  74C3 5394 479D D352 4C51

```
```
[[signature.asc](bugreport.cgi?att=1;bug=544232;filename=signature.asc;msg=51) (application/pgp-signature, inline)]
```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Tue, 02 Aug 2011 07:32:57 GMT) ([full text](bugreport.cgi?bug=544232;msg=53), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=53), [link](#52)).

---

**Bug unarchived.**
Request was from `Jonathan Wiltshire <jmw@debian.org>`
to `control@bugs.debian.org`.
(Mon, 22 Aug 2011 08:51:02 GMT) ([full text](bugreport.cgi?bug=544232;msg=55), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=55), [link](#54)).

---

**Added tag(s) squeeze and lenny.**
Request was from `Jonathan Wiltshire <jmw@debian.org>`
to `control@bugs.debian.org`.
(Mon, 22 Aug 2011 08:51:03 GMT) ([full text](bugreport.cgi?bug=544232;msg=57), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=57), [link](#56)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Tue, 20 Sep 2011 07:40:50 GMT) ([full text](bugreport.cgi?bug=544232;msg=59), [mbox](bugreport.cgi?bug=544232;mbox=yes;msg=59), [link](#58)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=544232).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 00:03:45 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from security.gentoo.org_1104fa65_20250125_000337.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Fail2ban: Multiple vulnerabilities — GLSA **201406-03**

Multiple vulnerabilities have been found in Fail2ban, the worst of
which allows remote attackers to cause a Denial of Service condition.

### Affected packages

| Package | **net-analyzer/fail2ban** on all architectures |
| --- | --- |
| Affected versions | < **0.8.12** |
| Unaffected versions | >= **0.8.12** |

### Background

Fail2ban is a tool for parsing log files and banning IP addresses which
show suspicious behavior.

### Description

Multiple vulnerabilities have been discovered in Fail2ban. Please review
the CVE identifiers referenced below for details.

### Impact

A remote attacker could send a crafted URL to a web site which, when
parsed by Fail2ban, would deny a specific IP address. Also, errors in
regular expressions within certain filters can cause arbitrary IP
addresses to be banned. Furthermore, a local attacker could perform
symlink attacks to overwrite arbitrary files with the privileges of the
user running the application.

### Workaround

There is no known workaround at this time.

### Resolution

All Fail2ban users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-analyzer/fail2ban-0.8.12

```
### References

* [CVE-2009-5023](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2009-5023)
* [CVE-2013-2178](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-2178)
* [CVE-2013-7176](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-7176)

**Release date**

June 01, 2014

**Latest revision**

June 01, 2014: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [364883](https://bugs.gentoo.org/show_bug.cgi?id=364883)
* [473118](https://bugs.gentoo.org/show_bug.cgi?id=473118)
* [499802](https://bugs.gentoo.org/show_bug.cgi?id=499802)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


