=== Content from debbugs.gnu.org_921b9eb7_20250124_120224.html ===

# GNU bug report logs - #34238 Assertion `num >= 0' failed at regexec.c:1363

[Previous](bugreport.cgi?bug=34237) [Next](bugreport.cgi?bug=34239)

Package:
[grep](pkgreport.cgi?package=grep);

Reported by: [Hongxu Chen <leftcopy.chx <at> gmail.com>](pkgreport.cgi?submitter=leftcopy.chx%40gmail.com)

Date: Tue, 29 Jan 2019 02:58:02 UTC

Severity: normal

Merged with [22793](bugreport.cgi?bug=22793),
[32806](bugreport.cgi?bug=32806),
[42946](bugreport.cgi?bug=42946)

To reply to this bug, email your comments to 34238 AT debbugs.gnu.org.

Toggle the display of automated, internal messages from the tracker.

View this report as an [mbox folder](bugreport.cgi?bug=34238;mbox=yes "Folder with messages as they arrived at the tracker"), [status mbox](bugreport.cgi?bug=34238;mboxstat=yes "Folder with a status summary message at the start"), [maintainer mbox](bugreport.cgi?mboxmaint=yes;mbox=yes;bug=34238 "Folder of messages as sent from the tracker to the maintainers")

---

**Report forwarded**
to `bug-grep <at> gnu.org`:

`bug#34238`; Package `grep`.
(Tue, 29 Jan 2019 02:58:02 GMT) [Full text](bugreport.cgi?bug=34238;msg=2) and [rfc822 format](bugreport.cgi?bug=34238;msg=2;mbox=yes) available.

---

**Acknowledgement sent**
to `Hongxu Chen <leftcopy.chx <at> gmail.com>`:

New bug report received and forwarded. Copy sent to `bug-grep <at> gnu.org`.
(Tue, 29 Jan 2019 02:58:02 GMT) [Full text](bugreport.cgi?msg=4;bug=34238) and [rfc822 format](bugreport.cgi?mbox=yes;msg=4;bug=34238) available.

---

[Message #5](#5) received at submit <at> debbugs.gnu.org ([full text](bugreport.cgi?bug=34238;msg=5), [mbox](bugreport.cgi?msg=5;mbox=yes;bug=34238)):

```

From: Hongxu Chen <leftcopy.chx <at> gmail.com>
To: bug-grep <at> gnu.org
Subject: Assertion `num >= 0' failed at regexec.c:1363
Date: Tue, 29 Jan 2019 10:57:18 +0800

```
```
[[Message part 1](bugreport.cgi?att=0;bug=34238;msg=5) (text/plain, inline)]
```
```
Hi,

    GNU grep 3.3.7-8df7 (and other versions such as 3.1) may trigger an
assertion failure by executing the following command.

    echo | grep -f regex.grep

Reading symbols from ./grep...done.
gdb$ run
Starting program: /home/hongxu/FOT/grep-asan/install/bin/grep -q -f
assert_regexec.c:1363.grep assert_regexec.c:1363.input
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
grep: ./regexec.c:1363: Idx pop_fail_stack(struct re_fail_stack_t *, Idx *,
Idx, regmatch_t *, re_node_set *): Assertion `num >= 0' failed.

Program received signal SIGABRT, Aborted.
__GI_raise (sig=sig <at> entry=0x6) at ../sysdeps/unix/sysv/linux/raise.c:51
51      ../sysdeps/unix/sysv/linux/raise.c: No such file or directory.
gdb$ bt
#0  __GI_raise (sig=sig <at> entry=0x6) at ../sysdeps/unix/sysv/linux/raise.c:51
#1  0x00007ffff6bd1801 in __GI_abort () at abort.c:79
#2  0x00007ffff6bc139a in __assert_fail_base (fmt=0x7ffff6d487d8
"%s%s%s:%u: %s%sAssertion `%s' failed.\n%n", assertion=assertion <at> entry=0x5f8d20
<.str.26> "num >= 0", file=file <at> entry=0x5f8a60 <.str.22> "./regexec.c",
line=line <at> entry=0x553, function=function <at> entry=0x5f8d60
<__PRETTY_FUNCTION__.pop_fail_stack> "Idx pop_fail_stack(struct
re_fail_stack_t *, Idx *, Idx, regmatch_t *, re_node_set *)") at assert.c:92
#3  0x00007ffff6bc1412 in __GI___assert_fail (assertion=0x5f8d20 <.str.26>
"num >= 0", file=0x5f8a60 <.str.22> "./regexec.c", line=0x553,
function=0x5f8d60 <__PRETTY_FUNCTION__.pop_fail_stack> "Idx
pop_fail_stack(struct re_fail_stack_t *, Idx *, Idx, regmatch_t *,
re_node_set *)") at assert.c:101
#4  0x00000000005d08f3 in pop_fail_stack (fs=0x7fffffffa3c0,
pidx=0x7fffffffa360, nregs=0x4, regs=0x606000000740,
eps_via_nodes=0x7fffffffa380) at ./regexec.c:1363
#5  0x00000000005b691b in set_regs (preg=0x60c000000380,
mctx=0x7fffffffa6a0, nmatch=0x4, pmatch=0x606000000740, fl_backtrack=0x1)
at ./regexec.c:1467
#6  0x0000000000588820 in re_search_internal (preg=0x60c000000380,
string=0x7fffffffb8d1 "\n", length=0x0, start=0x0, last_start=0x0,
stop=0x0, nmatch=0x4, pmatch=0x606000000740, eflags=0x0) at ./regexec.c:864
#7  0x0000000000589aa8 in re_search_stub (bufp=0x60c000000380,
string=0x7fffffffb8d1 "\n", length=0x0, start=0x0, range=0x0, stop=0x0,
regs=0x607000000430, ret_len=0x0) at ./regexec.c:425
#8  0x0000000000589e32 in rpl_re_search (bufp=0x60c000000380,
string=0x7fffffffb8d1 "\n", length=0x0, start=0x0, range=0x0,
regs=0x607000000430) at ./regexec.c:289
#9  0x00000000005160fe in EGexecute (vdc=0x607000000410, buf=0x7fffffffb8d1
"\n", size=0x1, match_size=0x7fffffffb8e0, start_ptr=0x0) at dfasearch.c:357
#10 0x000000000051abec in main (argc=0x5, argv=0x7fffffffbee8) at
grep.c:2894

    regex.grep is attached.

Best Regards,
Hongxu

```
```
[[Message part 2](bugreport.cgi?msg=5;bug=34238;att=1) (text/html, inline)]
```
```
[[regex.grep](bugreport.cgi?msg=5;att=2;bug=34238;filename=regex.grep) (application/octet-stream, attachment)]
```

---

**Information forwarded**
to `bug-grep <at> gnu.org`:

`bug#34238`; Package `grep`.
(Thu, 31 Jan 2019 03:22:01 GMT) [Full text](bugreport.cgi?msg=7;bug=34238) and [rfc822 format](bugreport.cgi?mbox=yes;msg=7;bug=34238) available.

---

[Message #8](#8) received at 34238 <at> debbugs.gnu.org ([full text](bugreport.cgi?msg=8;bug=34238), [mbox](bugreport.cgi?mbox=yes;msg=8;bug=34238)):

```

From: Paul Eggert <eggert <at> cs.ucla.edu>
To: Hongxu Chen <leftcopy.chx <at> gmail.com>
Cc: 34238 <at> debbugs.gnu.org
Subject: Re: bug#34238: Assertion `num >= 0' failed at regexec.c:1363
Date: Wed, 30 Jan 2019 19:21:36 -0800

```
```
Thanks for the test case. This appears to be the same as bug#22793 so
I'll merge them.

<https://debbugs.gnu.org/22793>

```

---

**Merged [22793](bugreport.cgi?bug=22793) [32806](bugreport.cgi?bug=32806) [34238](bugreport.cgi?bug=34238).**
Request was from `Paul Eggert <eggert <at> cs.ucla.edu>`
to `control <at> debbugs.gnu.org`.
(Thu, 31 Jan 2019 03:23:02 GMT) [Full text](bugreport.cgi?bug=34238;msg=10) and [rfc822 format](bugreport.cgi?mbox=yes;msg=10;bug=34238) available.

---

**Merged [22793](bugreport.cgi?bug=22793) [32806](bugreport.cgi?bug=32806) [34238](bugreport.cgi?bug=34238) [42946](bugreport.cgi?bug=42946).**
Request was from `Paul Eggert <eggert <at> cs.ucla.edu>`
to `control <at> debbugs.gnu.org`.
(Mon, 21 Sep 2020 19:52:02 GMT) [Full text](bugreport.cgi?msg=12;bug=34238) and [rfc822 format](bugreport.cgi?mbox=yes;msg=12;bug=34238) available.

---

This bug report was last modified 4 years and 125 days ago.

---

[Previous](bugreport.cgi?bug=34237) [Next](bugreport.cgi?bug=34239)

---

[GNU bug tracking system](//debbugs.gnu.org/)

Copyright (C) 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson.



=== Content from support.f5.com_54ea62c1_20250124_120232.html ===
Loading×Sorry to interruptCSS ErrorRefresh

=== Content from sourceware.org_b743a216_20250124_120230.html ===


Sourceware Bugzilla – Bug 18986
ERE '0|()0|\1|0' causes regexec undefined behavior
Last modified: 2019-03-05 10:45:59 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=18986&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=18986&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 18986**](show_bug.cgi?id=18986)
(CVE-2009-5155)
- ERE '0|()0|\1|0' causes regexec undefined behavior

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
ERE '0|()0|\1|0' causes regexec undefined behavior

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2009-5155 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | glibc | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=glibc "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | regex ([show other bugs](buglist.cgi?component=regex&product=glibc&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 2.22 | |  | | | [Importance](page.cgi?id=fields.html#importance): | P2 normal | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | 2.28 | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Adhemerval Zanella | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2015-09-20 02:10 UTC by Paul Eggert | | --- | --- | | Modified: | 2019-03-05 10:45 UTC ([History](show_activity.cgi?id=18986)) | | CC List: | 5 users (show)  adhemerval.zanella arekm drepper.fsp fweimer hanno | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Host:](page.cgi?id=fields.html#cf_gcchost "A custom Free Text field in this installation of Bugzilla.") |  | | [Target:](page.cgi?id=fields.html#cf_gcctarget "A custom Free Text field in this installation of Bugzilla.") |  | | [Build:](page.cgi?id=fields.html#cf_gccbuild "A custom Free Text field in this installation of Bugzilla.") |  | | [Last reconfirmed:](page.cgi?id=fields.html#cf_reconfirmed_on "A custom Date/Time field in this installation of Bugzilla.") |  | |  | | | Flags: | eggert: security+ | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**Test program illustrating the bug.**](attachment.cgi?id=8621 "View the content of the attachment") (386 bytes, text/x-csrc)  [2015-09-20 02:10 UTC](#attach_8621 "Go to the comment associated with the attachment"), Paul Eggert | [Details](attachment.cgi?id=8621&action=edit) | | [View All](attachment.cgi?bugid=18986&action=viewall)  [Add an attachment](attachment.cgi?bugid=18986&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=18986&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=18986#c0)  Paul Eggert    2015-09-20 02:10:42 UTC  ``` Created [attachment 8621](attachment.cgi?id=8621 "Test program illustrating the bug.") [[details]](attachment.cgi?id=8621&action=edit "Test program illustrating the bug.") Test program illustrating the bug.  This bug report was inspired by an assertion failure in GNU grep:  <http://bugs.gnu.org/21513>  I tracked it down to undefined behavior in glibc.  Sometimes the behavior causes a core dump, sometimes the wrong answer, sometimes the right answer.  I will attach a C program that illustrates the problem for me: compile and run it, and typically it outputs "match (incorrect)"; it should output either ""regcomp returns REG_ESUBREG (arguably correct)" or "no match (arguably correct)".  I have fixed the bug in the Gnulib version of the regex code, here:  <http://git.savannah.gnu.org/cgit/gnulib.git/commit/?id=5513b40999149090987a0341c018d05d3eea1272>  so when somebody backports Gnulib fixes into Glibc, Glibc should pick up the bug fix as a part of that process. ```  [Comment 1](show_bug.cgi?id=18986#c1)  Sourceware Commits    2018-07-04 12:56:25 UTC  ``` This is an automated email from the git hooks/post-receive script. It was generated because a ref change was pushed to the repository containing the project "GNU C Library master sources".  The branch, master has been updated        via  eb04c21373e2a2885f3d52ff192b0499afe3c672 (commit)       from  b11643c21c5c9d67a69c8ae952e5231ce002e7f1 (commit)  Those revisions listed above that are new to this repository have not appeared on any other notification email; so we list those revisions in full, below.  - Log ----------------------------------------------------------------- <https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=eb04c21373e2a2885f3d52ff192b0499afe3c672>  commit eb04c21373e2a2885f3d52ff192b0499afe3c672 Author: Adhemerval Zanella <adhemerval.zanella@linaro.org> Date:   Wed Dec 20 09:47:44 2017 -0200      posix: Sync gnulib regex implementation          This patch syncs the regex implementation with gnulib (commit 0ee5212).     Only two changes in GLIBC regex testing are required:            1. posix/bug-regex28.c: as previously discussed [1] the change of          expected results on the pattern should be safe.            2. posix/PCRE.tests: the ERE (a)|\1 is malformed (in the sense that          the \1 doesn't mean anything) and although current GLIBC accepts          it has undefined behavior.  This patch removes the specific test.          This sync contains some patches from thread 'Regex: Make libc regex     more usable outside GLIBC.' [2] which have been pushed upstream in     gnulib.  This patches also fixes some regex issues (BZ #23233,     BZ #21163, BZ #18986, BZ #13762) and I did not add testcases for     both #23233 and #13762 because I couldn't think a simple way to     trigger the expected failure path to trigger them.          Checked on x86_64-linux-gnu and i686-linux-gnu.          	[BZ #23233]     	[BZ #21163]     	[BZ #18986]     	[BZ #13762]     	* posix/Makefile (tests): Add bug-regex37 and bug-regex38.     	* posix/PCRE.tests: Remove invalid test.     	* posix/bug-regex28.c: Fix expected values for used syntax.     	* posix/bug-regex37.c: New file.     	* posix/bug-regex38.c: Likewise.     	* posix/regcomp.c: Sync with gnulib.     	* posix/regex.c: Likewise.     	* posix/regex.h: Likewise.     	* posix/regex_internal.c: Likewise.     	* posix/regex_internal.h: Likewise.     	* posix/regexec.c: Likewise.          [1] <https://sourceware.org/ml/libc-alpha/2017-12/msg00807.html>     [2] <https://sourceware.org/ml/libc-alpha/2017-12/msg00237.html>  -----------------------------------------------------------------------  Summary of changes:  ChangeLog                                       |   18 +  posix/Makefile                                  |    3 +-  posix/PCRE.tests                                |   13 -  posix/bug-regex28.c                             |   46 +-  wcsmbs/test-char-types.c => posix/bug-regex37.c |   11 +-  wcsmbs/test-char-types.c => posix/bug-regex38.c |   11 +-  posix/regcomp.c                                 |  597 +++++++++------  posix/regex.c                                   |   21 +-  posix/regex.h                                   |  335 +++++----  posix/regex_internal.c                          |  295 ++++----  posix/regex_internal.h                          |  442 ++++++++----  posix/regexec.c                                 |  936 ++++++++++++-----------  12 files changed, 1557 insertions(+), 1171 deletions(-)  copy wcsmbs/test-char-types.c => posix/bug-regex37.c (78%)  copy wcsmbs/test-char-types.c => posix/bug-regex38.c (78%) ```  [Comment 2](show_bug.cgi?id=18986#c2)  Adhemerval Zanella    2018-07-04 12:59:58 UTC  ``` Fixed by eb04c21373e2a2885f3d52ff192b0499afe3c672 (2.28). ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=18986)
* - [XML](show_bug.cgi?ctype=xml&id=18986)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=18986)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=18986&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=18986&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from debbugs.gnu.org_dfba08e7_20250124_120222.html ===

# GNU bug report logs - #22793 grep -E assertion failure with back references

[Previous](bugreport.cgi?bug=22792) [Next](bugreport.cgi?bug=22794)

Package:
[grep](pkgreport.cgi?package=grep);

Reported by: [santiagorr <at> riseup.net](pkgreport.cgi?submitter=santiagorr%40riseup.net)

Date: Wed, 24 Feb 2016 16:20:02 UTC

Severity: normal

Merged with [32806](bugreport.cgi?bug=32806),
[34238](bugreport.cgi?bug=34238),
[42946](bugreport.cgi?bug=42946)

To reply to this bug, email your comments to 22793 AT debbugs.gnu.org.

Toggle the display of automated, internal messages from the tracker.

View this report as an [mbox folder](bugreport.cgi?bug=22793;mbox=yes "Folder with messages as they arrived at the tracker"), [status mbox](bugreport.cgi?bug=22793;mboxstat=yes "Folder with a status summary message at the start"), [maintainer mbox](bugreport.cgi?mbox=yes;bug=22793;mboxmaint=yes "Folder of messages as sent from the tracker to the maintainers")

---

**Report forwarded**
to `bug-grep <at> gnu.org`:

`bug#22793`; Package `grep`.
(Wed, 24 Feb 2016 16:20:02 GMT) [Full text](bugreport.cgi?msg=2;bug=22793) and [rfc822 format](bugreport.cgi?bug=22793;msg=2;mbox=yes) available.

---

**Acknowledgement sent**
to `santiagorr <at> riseup.net`:

New bug report received and forwarded. Copy sent to `bug-grep <at> gnu.org`.
(Wed, 24 Feb 2016 16:20:02 GMT) [Full text](bugreport.cgi?msg=4;bug=22793) and [rfc822 format](bugreport.cgi?mbox=yes;msg=4;bug=22793) available.

---

[Message #5](#5) received at submit <at> debbugs.gnu.org ([full text](bugreport.cgi?bug=22793;msg=5), [mbox](bugreport.cgi?mbox=yes;bug=22793;msg=5)):

```

From: santiagorr <at> riseup.net
To: bug-grep <at> gnu.org
Subject: grep -E assertion failure with back references
Date: Wed, 24 Feb 2016 17:18:54 +0100

```
```
Hi,

This is a long standing bug reported to Debian, still present in 2.23.
It was forwarded at some point, but I cannot find any reference, so I'm
reforwarding it.

% echo abc | LANG=C grep -E '(.*)(.*)(.*)\3\2\1'
grep: regexec.c:1401: pop_fail_stack: Assertion `num >= 0' failed.

More info at: <https://bugs.debian.org/186568>

Regards,

Santiago

```

---

**Information forwarded**
to `bug-grep <at> gnu.org`:

`bug#22793`; Package `grep`.
(Wed, 24 Feb 2016 18:58:01 GMT) [Full text](bugreport.cgi?msg=7;bug=22793) and [rfc822 format](bugreport.cgi?mbox=yes;bug=22793;msg=7) available.

---

[Message #8](#8) received at 22793 <at> debbugs.gnu.org ([full text](bugreport.cgi?bug=22793;msg=8), [mbox](bugreport.cgi?bug=22793;msg=8;mbox=yes)):

```

From: Jim Meyering <jim <at> meyering.net>
To: santiagorr <at> riseup.net
Cc: 22793 <at> debbugs.gnu.org
Subject: Re: bug#22793: grep -E assertion failure with back references
Date: Wed, 24 Feb 2016 10:56:38 -0800

```
```
forcemerge 21513 22793
thanks

On Wed, Feb 24, 2016 at 8:18 AM,  <santiagorr <at> riseup.net> wrote:
> Hi,
>
> This is a long standing bug reported to Debian, still present in 2.23.
> It was forwarded at some point, but I cannot find any reference, so I'm
> reforwarding it.
>
> % echo abc | LANG=C grep -E '(.*)(.*)(.*)\3\2\1'
> grep: regexec.c:1401: pop_fail_stack: Assertion `num >= 0' failed.
>
> More info at: <https://bugs.debian.org/186568>

Correct, this was reported some time ago,
both here and in the upstream glibc bugzilla:

  <http://bugs.gnu.org/21513>
  <https://sourceware.org/bugzilla/show_bug.cgi?id=18986>

There is currently an "XFAIL" (expected-to-fail) test in grep's
test suite that exercises precisely this bug:

  git.savannah.gnu.org/cgit/grep.git/tree/tests/triple-backref

```

---

**Forcibly Merged [21513](bugreport.cgi?bug=21513) [22793](bugreport.cgi?bug=22793).**
Request was from `Paul Eggert <eggert <at> cs.ucla.edu>`
to `control <at> debbugs.gnu.org`.
(Wed, 24 Feb 2016 19:43:02 GMT) [Full text](bugreport.cgi?msg=10;bug=22793) and [rfc822 format](bugreport.cgi?mbox=yes;bug=22793;msg=10) available.

---

**Information forwarded**
to `bug-grep <at> gnu.org`:

`bug#22793`; Package `grep`.
(Wed, 24 Feb 2016 19:48:01 GMT) [Full text](bugreport.cgi?msg=12;bug=22793) and [rfc822 format](bugreport.cgi?bug=22793;msg=12;mbox=yes) available.

---

[Message #13](#13) received at 22793 <at> debbugs.gnu.org ([full text](bugreport.cgi?msg=13;bug=22793), [mbox](bugreport.cgi?bug=22793;msg=13;mbox=yes)):

```

From: Paul Eggert <eggert <at> cs.ucla.edu>
To: Jim Meyering <jim <at> meyering.net>, santiagorr <at> riseup.net
Cc: 22793 <at> debbugs.gnu.org, 186568 <at> bugs.debian.org
Subject: Re: bug#22793: grep -E assertion failure with back references
Date: Wed, 24 Feb 2016 11:46:55 -0800

```
```
With recent 'grep' you can work around the problem by configuring
--with-included-regex. That has some other undesirable properties, though.

This is really a glibc bug
<<https://sourceware.org/bugzilla/show_bug.cgi?id=18986>> and the glibc
patch could be applied to the Debian copy of glibc. Here's the patch:

<http://git.savannah.gnu.org/cgit/gnulib.git/commit/?id=5513b40999149090987a0341c018d05d3eea1272>

In other words, Debian bug #186568 is really a glibc bug, not a grep
bug. Can you please fix the Debian bug report accordingly? I'll CC: this
message there.

```

---

**Information forwarded**
to `bug-grep <at> gnu.org`:

`bug#22793`; Package `grep`.
(Thu, 25 Feb 2016 06:13:02 GMT) [Full text](bugreport.cgi?bug=22793;msg=15) and [rfc822 format](bugreport.cgi?bug=22793;msg=15;mbox=yes) available.

---

[Message #16](#16) received at 22793 <at> debbugs.gnu.org ([full text](bugreport.cgi?bug=22793;msg=16), [mbox](bugreport.cgi?msg=16;bug=22793;mbox=yes)):

```

From: arnold <at> skeeve.com
To: santiagorr <at> riseup.net, jim <at> meyering.net, eggert <at> cs.ucla.edu
Cc: 22793 <at> debbugs.gnu.org, 186568 <at> bugs.debian.org
Subject: Re: bug#22793: grep -E assertion failure with back references
Date: Wed, 24 Feb 2016 23:12:10 -0700

```
```
Paul Eggert <eggert <at> cs.ucla.edu> wrote:

> With recent 'grep' you can work around the problem by configuring
> --with-included-regex.

Not so. I did a fresh

	./boostrap
	./configure --with-included-regex
	make

and it still core dumps:

$ echo abc | ./src/grep -E  '(.*)(.*)(.*)\3\2\1'
grep: regexec.c:1413: pop_fail_stack: Assertion `((Idx) (num) < ((Idx) -2))' failed.
Aborted (core dumped)

I looked at it in a debugger fs->num before the --fs->num executes looks to
be -1.

Thanks,

Arnold

```

---

**Disconnected #22793 from all other report(s).**
Request was from `Paul Eggert <eggert <at> cs.ucla.edu>`
to `control <at> debbugs.gnu.org`.
(Thu, 25 Feb 2016 07:56:01 GMT) [Full text](bugreport.cgi?bug=22793;msg=18) and [rfc822 format](bugreport.cgi?bug=22793;msg=18;mbox=yes) available.

---

**Information forwarded**
to `bug-grep <at> gnu.org`:

`bug#22793`; Package `grep`.
(Thu, 25 Feb 2016 08:03:02 GMT) [Full text](bugreport.cgi?msg=20;bug=22793) and [rfc822 format](bugreport.cgi?mbox=yes;bug=22793;msg=20) available.

---

[Message #21](#21) received at 22793 <at> debbugs.gnu.org ([full text](bugreport.cgi?bug=22793;msg=21), [mbox](bugreport.cgi?mbox=yes;bug=22793;msg=21)):

```

From: Paul Eggert <eggert <at> cs.ucla.edu>
To: arnold <at> skeeve.com, santiagorr <at> riseup.net, jim <at> meyering.net
Cc: 22793 <at> debbugs.gnu.org, 186568 <at> bugs.debian.org, 21513 <at> debbugs.gnu.org
Subject: Re: bug#22793: grep -E assertion failure with back references
Date: Thu, 25 Feb 2016 00:01:52 -0800

```
```
arnold <at> skeeve.com wrote:
> Paul Eggert <eggert <at> cs.ucla.edu> wrote:
>
>> With recent 'grep' you can work around the problem by configuring
>> --with-included-regex.
>
> Not so. I did a fresh
>
> 	./boostrap
> 	./configure --with-included-regex
> 	make
>
> and it still core dumps:
>
> $ echo abc | ./src/grep -E  '(.*)(.*)(.*)\3\2\1'
> grep: regexec.c:1413: pop_fail_stack: Assertion `((Idx) (num) < ((Idx) -2))' failed.
> Aborted (core dumped)
>
> I looked at it in a debugger fs->num before the --fs->num executes looks to
> be -1.

Sorry, you're right. I got confused into thinking that grep Bug#22793 and grep
Bug#21513 are the same bugs, but they're not. I have unmerged them.

This is still a glibc bug, not a grep bug; it's just that we don't have a fix.

grep Bug#21513 is indeed fixed by configuring --with-included-regex.

```

---

**Information forwarded**
to `bug-grep <at> gnu.org`:

`bug#22793`; Package `grep`.
(Tue, 17 Jan 2017 21:38:01 GMT) [Full text](bugreport.cgi?msg=23;bug=22793) and [rfc822 format](bugreport.cgi?mbox=yes;msg=23;bug=22793) available.

---

[Message #24](#24) received at 22793 <at> debbugs.gnu.org ([full text](bugreport.cgi?msg=24;bug=22793), [mbox](bugreport.cgi?bug=22793;msg=24;mbox=yes)):

```

From: Paul Eggert <eggert <at> cs.ucla.edu>
To: 22793 <at> debbugs.gnu.org
Cc: Paolo Bonzini <bonzini <at> gnu.org>, arnold <at> skeeve.com, santiagorr <at> riseup.net,
 Jim Meyering <jim <at> meyering.net>
Subject: Re: grep -E assertion failure with back references
Date: Tue, 17 Jan 2017 13:37:12 -0800

```
```
> This is still a glibc bug, not a grep bug; it's just that we don't have a fix.

I finally got around to finding the correct glibc bug report for this
grep bug. Here it is:

<https://sourceware.org/bugzilla/show_bug.cgi?id=11053>

I added a comment to the glibc bug, saying that it causes grep Bug#22793
<<https://bugs.gnu.org/22793>>.

Paolo Bonzini reported the glibc bug in 2009 and is the current
assignee. I think he's pretty busy doing other things. It'd be nice if
someone could fix the glibc bug (or at least, fix it in Gnulib), though
I suspect that any fix will not be trivial.

```

---

**Merged [22793](bugreport.cgi?bug=22793) [32806](bugreport.cgi?bug=32806).**
Request was from `Paul Eggert <eggert <at> cs.ucla.edu>`
to `control <at> debbugs.gnu.org`.
(Sat, 22 Sep 2018 21:24:02 GMT) [Full text](bugreport.cgi?bug=22793;msg=26) and [rfc822 format](bugreport.cgi?msg=26;bug=22793;mbox=yes) available.

---

**Merged [22793](bugreport.cgi?bug=22793) [32806](bugreport.cgi?bug=32806) [34238](bugreport.cgi?bug=34238).**
Request was from `Paul Eggert <eggert <at> cs.ucla.edu>`
to `control <at> debbugs.gnu.org`.
(Thu, 31 Jan 2019 03:23:02 GMT) [Full text](bugreport.cgi?msg=28;bug=22793) and [rfc822 format](bugreport.cgi?mbox=yes;bug=22793;msg=28) available.

---

**Merged [22793](bugreport.cgi?bug=22793) [32806](bugreport.cgi?bug=32806) [34238](bugreport.cgi?bug=34238) [42946](bugreport.cgi?bug=42946).**
Request was from `Paul Eggert <eggert <at> cs.ucla.edu>`
to `control <at> debbugs.gnu.org`.
(Mon, 21 Sep 2020 19:52:02 GMT) [Full text](bugreport.cgi?bug=22793;msg=30) and [rfc822 format](bugreport.cgi?mbox=yes;bug=22793;msg=30) available.

---

This bug report was last modified 4 years and 125 days ago.

---

[Previous](bugreport.cgi?bug=22792) [Next](bugreport.cgi?bug=22794)

---

[GNU bug tracking system](//debbugs.gnu.org/)

Copyright (C) 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson.



=== Content from security.netapp.com_ef2e3089_20250124_120225.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [March 2019 GNU C Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20190315-0002)

## March 2019 GNU C Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20190315-0002 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20190315-0002 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20190315-0002 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20190315-0002 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20190315-0002
**Version:**
27.0

**Last updated:**
04/25/2024

**Status:**
Final.

**CVEs:** CVE-2009-5155, CVE-2018-20796, CVE-2019-9169

Overview
#### Summary

Multiple NetApp products incorporate GNU C Library (glibc). Glibc versions through 2.29 are susceptible vulnerabilities which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

Brocade Fabric Operating System Firmware not affected by CVE-2018-20796.

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2009-5155](https://nvd.nist.gov/vuln/detail/CVE-2009-5155) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2018-20796](https://nvd.nist.gov/vuln/detail/CVE-2018-20796) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2019-9169](https://nvd.nist.gov/vuln/detail/CVE-2019-9169) | 9.8 (CRITICAL) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://lists.gnu.org/archive/html/bug-gnulib/2019-01/msg00108.html>
* <https://debbugs.gnu.org/cgi/bugreport.cgi?bug=34140>
* <https://debbugs.gnu.org/cgi/bugreport.cgi?bug=34142>
* <https://debbugs.gnu.org/cgi/bugreport.cgi?bug=22793>
* <https://debbugs.gnu.org/cgi/bugreport.cgi?bug=32806>
* <https://debbugs.gnu.org/cgi/bugreport.cgi?bug=34238>
* <https://debbugs.gnu.org/cgi/bugreport.cgi?bug=34141>

Affected Products
#### Affected Products

* Brocade Fabric Operating System Firmware
* Cluster Network Switch (NetApp CN1610)
* NetApp Cloud Backup (formerly AltaVault)
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SteelStore Cloud Integrated Storage
* ONTAP Select Deploy administration utility
* SnapProtect

#### Products Not Affected

* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Trident
* Brocade Network Advisor Software
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element Plug-in for vCenter Server
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Service Processor - 8080/8060/8040/8020
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM6 SAS Disk Shelf Firmware
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node BIOS
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp VASA Provider for Clustered Data ONTAP 9.7 and above
* ONTAP 9 (formerly Clustered Data ONTAP)
* ONTAP Antivirus Connector
* OnCommand Insight
* OnCommand Workflow Automation
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapManager for Hyper-V
* Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 9.7 and above
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID Baseboard Management Controller (BMC)
* StorageGRID9 (9.x and prior)
* System Manager 9.x
* Virtual Storage Console for VMware vSphere 9.7 and above

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **Brocade Fabric Operating System Firmware** | <https://www.broadcom.com/products/fibre-channel-networking/software/fabric-operating-system> First fixed in FOS 9.0. |
| **Cluster Network Switch (NetApp CN1610)** | Cluster Network Switch (NetApp CN1610) has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2859128.html) for more information. |
| **NetApp Cloud Backup (formerly AltaVault)** | NetApp Cloud Backup (formerly AltaVault) has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2880179.html) for more information. |
| **NetApp HCI Compute Node (Bootstrap OS)** | <https://mysupport.netapp.com/site/products/all/details/netapp-hci/downloads-tab/download/62542/1.8> |
| **NetApp SteelStore Cloud Integrated Storage** | NetApp SteelStore Cloud Integrated Storage has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2397079.html) for more information. |
| **ONTAP Select Deploy administration utility** | <https://mysupport.netapp.com/site/products/all/details/ontapselect-deploy/downloads-tab/download/62910/9.8> |
| **SnapProtect** | SnapProtect has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2426797.html) for more information. |
| **NetApp SolidFire & HCI Storage Node (Element Software)** | <https://mysupport.netapp.com/site/products/all/details/element-software/downloads-tab/download/62654/12.0> <https://mysupport.netapp.com/site/products/all/details/netapp-hci/downloads-tab/download/62542/1.8> |
| **NetApp SolidFire & HCI Management Node** | <https://mysupport.netapp.com/site/products/all/details/element-software/downloads-tab/download/62654/12.5> <https://mysupport.netapp.com/site/products/all/details/netapp-hci/downloads-tab/download/62542/1.10> |
| **NetApp HCI Baseboard Management Controller (BMC) - H410C** | <https://mysupport.netapp.com/site/products/all/details/netapp-hci/downloads-tab/download/62542/Compute_Firmware_Bundle> First included in Compute Firmware Bundle version 2.146.2-12.5.74. |

#### Workarounds

None at this time

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20190315-0002>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20190315 | Initial Public Release |
| 2.0 | 20190319 | E-Series SANtricity OS Controller Software 11.x moved to Affected Products |
| 3.0 | 20190320 | NetApp VASA Provider for Clustered Data ONTAP 7.2 and above, Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 7.2 and above, and Virtual Storage Console for VMware vSphere 7.2 and above moved to Products Not Affected |
| 4.0 | 20190322 | NetApp HCI Compute Nodes and NetApp HCI Storage Nodes moved to Affected Products |
| 5.0 | 20190328 | Element Software (formerly SolidFire Element OS) and Element Software Management Node moved to Affected Products |
| 6.0 | 20190408 | FAS/AFF Baseboard Management Controller (BMC) and Service Processor moved to Products Not Affected |
| 7.0 | 20190531 | SnapProtect moved to Won't Fix status |
| 8.0 | 20190701 | NetApp NFS Plug-in for VMware VAAI moved to Products Not Affected |
| 9.0 | 20190730 | Brocade Network Advisor Software moved to Products Not Affected |
| 10.0 | 20190731 | Cluster Network Switch (NetApp CN1610) moved to Won't Fix status |
| 11.0 | 20200324 | NetApp HCI Baseboard Management Controller (BMC) - H610C, NetApp HCI Baseboard Management Controller (BMC) - H610S and NetApp HCI Baseboard Management Controller (BMC) - H615C moved to Affected Products |
| 12.0 | 20200507 | NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S moved to Affected Products |
| 13.0 | 20200612 | NetApp HCI Compute Node (Bootstrap OS) moved to Products Not Affected |
| 14.0 | 20200616 | After additional review Active IQ Unified Manager (formerly OnCommand Unified Manager) for VMware vSphere 9.5 and above moved from Affected Products to Products Not Affected |
| 15.0 | 20200709 | Brocade Fabric Operating System Firmware added to Software Versions and Fixes |
| 16.0 | 20200730 | NetApp HCI Baseboard Management Controller (BMC) - H410C moved to Affected Products |
| 17.0 | 20200818 | NetApp SolidFire & HCI Storage Node (Element Software) added to Software Versions and Fixes |
| 18.0 | 20200824 | Updated First fix version for Brocade Fabric Operating System Firmware, and After additional review NetApp HCI Baseboard Management Controller (BMC) - H610S moved from Affected Products to Products Not Affected |
| 19.0 | 20200901 | NetApp SteelStore Cloud Integrated Storage moved to Won't Fix status |
| 20.0 | 20200923 | After additional review NetApp HCI Baseboard Management Controller (BMC) - H610C and NetApp HCI Baseboard Management Controller (BMC) - H615C moved from Affected Products to Products Not Affected |
| 21.0 | 20210105 | After additional review NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H300E/H500E/H700E/H410S moved from Affected Products to Products Not Affected |
| 22.0 | 20210617 | After additional review E-Series SANtricity OS Controller Software 11.x moved from Affected Products to Products Not Affected |
| 23.0 | 20211222 | Brocade Fabric Operating System Firmware added to Impact |
| 24.0 | 20220106 | NetApp Cloud Backup (formerly AltaVault) moved to Won't Fix status |
| 25.0 | 20220527 | NetApp SolidFire & HCI Management Node added to Software Versions and Fixes |
| 26.0 | 20220701 | NetApp HCI Baseboard Management Controller (BMC) - H410C added to Software Versions and Fixes |
| 27.0 | 20240425 | ONTAP Select Deploy administration utility added to Software Versions and Fixes, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from lists.apache.org_cd8fe7ff_20250124_120224.html ===


[![Foal logo](images/logo.png)](./)

* ![Display Settings](images/cog.png "Display Settings")
  **Email display mode:**

  ---

   Modern rendering

   Legacy rendering
* ![Logged out](images/user_loggedout.png "Not logged in")

This site requires JavaScript enabled. Please enable it.



=== Content from support.f5.com_4becfc4f_20250124_120231.html ===
Loading×Sorry to interruptCSS ErrorRefresh

=== Content from lists.apache.org_5008bfe2_20250124_120224.html ===


[![Foal logo](images/logo.png)](./)

* ![Display Settings](images/cog.png "Display Settings")
  **Email display mode:**

  ---

   Modern rendering

   Legacy rendering
* ![Logged out](images/user_loggedout.png "Not logged in")

This site requires JavaScript enabled. Please enable it.



=== Content from debbugs.gnu.org_26435628_20250124_120223.html ===

# GNU bug report logs - #32806 An assertion is hit when processing "(|()()0)\2" extended regular expression

[Previous](bugreport.cgi?bug=32805) [Next](bugreport.cgi?bug=32807)

Package:
[grep](pkgreport.cgi?package=grep);

Reported by: [Anatoly Trosinenko <anatoly.trosinenko <at> gmail.com>](pkgreport.cgi?submitter=anatoly.trosinenko%40gmail.com)

Date: Sat, 22 Sep 2018 15:21:03 UTC

Severity: normal

Merged with [22793](bugreport.cgi?bug=22793),
[34238](bugreport.cgi?bug=34238),
[42946](bugreport.cgi?bug=42946)

To reply to this bug, email your comments to 32806 AT debbugs.gnu.org.

Toggle the display of automated, internal messages from the tracker.

View this report as an [mbox folder](bugreport.cgi?mbox=yes;bug=32806 "Folder with messages as they arrived at the tracker"), [status mbox](bugreport.cgi?mboxstat=yes;bug=32806 "Folder with a status summary message at the start"), [maintainer mbox](bugreport.cgi?bug=32806;mbox=yes;mboxmaint=yes "Folder of messages as sent from the tracker to the maintainers")

---

**Report forwarded**
to `bug-grep <at> gnu.org`:

`bug#32806`; Package `grep`.
(Sat, 22 Sep 2018 15:21:03 GMT) [Full text](bugreport.cgi?bug=32806;msg=2) and [rfc822 format](bugreport.cgi?mbox=yes;msg=2;bug=32806) available.

---

**Acknowledgement sent**
to `Anatoly Trosinenko <anatoly.trosinenko <at> gmail.com>`:

New bug report received and forwarded. Copy sent to `bug-grep <at> gnu.org`.
(Sat, 22 Sep 2018 15:21:04 GMT) [Full text](bugreport.cgi?bug=32806;msg=4) and [rfc822 format](bugreport.cgi?msg=4;bug=32806;mbox=yes) available.

---

[Message #5](#5) received at submit <at> debbugs.gnu.org ([full text](bugreport.cgi?msg=5;bug=32806), [mbox](bugreport.cgi?msg=5;bug=32806;mbox=yes)):

```

From: Anatoly Trosinenko <anatoly.trosinenko <at> gmail.com>
To: bug-grep <at> gnu.org
Subject: An assertion is hit when processing "(|()()0)\2" extended regular
 expression
Date: Sat, 22 Sep 2018 18:00:56 +0300

```
```
Hello,

When processing a simple extended regular expression, GNU grep hits an
assertion. This is reproducible on the latest commit from master
branch 51dacfb (Sep 19).

$ export LC_ALL=C
$ gdb -q --args ./grep -E "(|()()0)\2"
Reading symbols from ./grep...(no debugging symbols found)...done.
(gdb) r
Starting program: /path/to/grep -E \(\|\(\)\(\)0\)\\2
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
grep: regexec.c:1342: pop_fail_stack: Assertion `num >= 0' failed.

Program received signal SIGABRT, Aborted.
__GI_raise (sig=sig <at> entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51
51      ../sysdeps/unix/sysv/linux/raise.c: No such file or directory.
(gdb) bt
#0  __GI_raise (sig=sig <at> entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51
#1  0x00007ffff75ae801 in __GI_abort () at abort.c:79
#2  0x00007ffff759e39a in __assert_fail_base (fmt=0x7ffff77257d8
"%s%s%s:%u: %s%sAssertion `%s' failed.\n%n",
assertion=assertion <at> entry=0x7ffff772351f "num >= 0",
file=file <at> entry=0x7ffff7723515 "regexec.c", line=line <at> entry=1342,
    function=function <at> entry=0x7ffff77278a0 <__PRETTY_FUNCTION__.12590>
"pop_fail_stack") at assert.c:92
#3  0x00007ffff759e412 in __GI___assert_fail
(assertion=assertion <at> entry=0x7ffff772351f "num >= 0",
file=file <at> entry=0x7ffff7723515 "regexec.c", line=line <at> entry=1342,
function=function <at> entry=0x7ffff77278a0 <__PRETTY_FUNCTION__.12590>
"pop_fail_stack") at assert.c:101
#4  0x00007ffff758f3f8 in pop_fail_stack
(eps_via_nodes=0x7fffffffd5d0, regs=0x55555578b110, nregs=4,
pidx=<optimized out>, fs=<optimized out>) at regexec.c:1342
#5  0x00007ffff76650e8 in pop_fail_stack (eps_via_nodes=<optimized
out>, regs=<optimized out>, nregs=<optimized out>, pidx=<optimized
out>, fs=<optimized out>) at regexec.c:1427
#6  set_regs (preg=preg <at> entry=0x555555788cd0,
mctx=mctx <at> entry=0x7fffffffd770, nmatch=nmatch <at> entry=4,
pmatch=pmatch <at> entry=0x55555578b110, fl_backtrack=<optimized out>) at
regexec.c:1419
#7  0x00007ffff766e272 in re_search_internal
(preg=preg <at> entry=0x555555788cd0, string=string <at> entry=0x7fffffffdbe6
"\n", length=length <at> entry=0, start=<optimized out>, start <at> entry=0,
range=<optimized out>, range <at> entry=0, stop=stop <at> entry=0, nmatch=4,
pmatch=0x55555578b110,
    eflags=0) at regexec.c:846
#8  0x00007ffff766eb88 in re_search_stub (bufp=0x555555788cd0,
string=<optimized out>, length=<optimized out>, start=0,
range=<optimized out>, stop=<optimized out>, regs=0x5555557883a0,
ret_len=<optimized out>) at regexec.c:420
#9  0x00007ffff766f7e0 in __re_search (bufp=<optimized out>,
string=<optimized out>, length=<optimized out>, start=<optimized out>,
range=<optimized out>, regs=<optimized out>) at regexec.c:291
#10 0x0000555555558857 in EGexecute ()
#11 0x000055555555df08 in main ()

Best regards
Anatoly

```

---

**Information forwarded**
to `bug-grep <at> gnu.org`:

`bug#32806`; Package `grep`.
(Sat, 22 Sep 2018 21:24:02 GMT) [Full text](bugreport.cgi?msg=7;bug=32806) and [rfc822 format](bugreport.cgi?mbox=yes;msg=7;bug=32806) available.

---

[Message #8](#8) received at 32806 <at> debbugs.gnu.org ([full text](bugreport.cgi?msg=8;bug=32806), [mbox](bugreport.cgi?mbox=yes;bug=32806;msg=8)):

```

From: Paul Eggert <eggert <at> cs.ucla.edu>
To: Anatoly Trosinenko <anatoly.trosinenko <at> gmail.com>, 32806 <at> debbugs.gnu.org
Subject: Re: bug#32806: An assertion is hit when processing "(|()()0)\2"
 extended regular expression
Date: Sat, 22 Sep 2018 14:23:41 -0700

```
```
Thanks for the test case. This appears to be the same as bug#22793 so
I'll merge them.

<https://debbugs.gnu.org/22793>

```

---

**Merged [22793](bugreport.cgi?bug=22793) [32806](bugreport.cgi?bug=32806).**
Request was from `Paul Eggert <eggert <at> cs.ucla.edu>`
to `control <at> debbugs.gnu.org`.
(Sat, 22 Sep 2018 21:24:02 GMT) [Full text](bugreport.cgi?msg=10;bug=32806) and [rfc822 format](bugreport.cgi?mbox=yes;bug=32806;msg=10) available.

---

**Merged [22793](bugreport.cgi?bug=22793) [32806](bugreport.cgi?bug=32806) [34238](bugreport.cgi?bug=34238).**
Request was from `Paul Eggert <eggert <at> cs.ucla.edu>`
to `control <at> debbugs.gnu.org`.
(Thu, 31 Jan 2019 03:23:02 GMT) [Full text](bugreport.cgi?msg=12;bug=32806) and [rfc822 format](bugreport.cgi?mbox=yes;msg=12;bug=32806) available.

---

**Merged [22793](bugreport.cgi?bug=22793) [32806](bugreport.cgi?bug=32806) [34238](bugreport.cgi?bug=34238) [42946](bugreport.cgi?bug=42946).**
Request was from `Paul Eggert <eggert <at> cs.ucla.edu>`
to `control <at> debbugs.gnu.org`.
(Mon, 21 Sep 2020 19:52:02 GMT) [Full text](bugreport.cgi?bug=32806;msg=14) and [rfc822 format](bugreport.cgi?mbox=yes;msg=14;bug=32806) available.

---

This bug report was last modified 4 years and 125 days ago.

---

[Previous](bugreport.cgi?bug=32805) [Next](bugreport.cgi?bug=32807)

---

[GNU bug tracking system](//debbugs.gnu.org/)

Copyright (C) 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson.



=== Content from sourceware.org_ec2d266a_20250124_120227.html ===


Sourceware Bugzilla – Bug 11053
Wrong results with backreferences
Last modified: 2022-11-11 16:29:02 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=11053&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=11053&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 11053**](show_bug.cgi?id=11053)
- Wrong results with backreferences

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Wrong results with backreferences

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | glibc | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=glibc "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | regex ([show other bugs](buglist.cgi?component=regex&product=glibc&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 2.11 | |  | | | [Importance](page.cgi?id=fields.html#importance): | P2 normal | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | eggert | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [25149](show_bug.cgi?id=25149 "RESOLVED FIXED - Array bounds violation in proceed_next_node") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | Show dependency [tree](showdependencytree.cgi?id=11053&hide_resolved=1) / [graph](showdependencygraph.cgi?id=11053) | |  | | Reported: | 2009-12-04 19:35 UTC by Paolo Bonzini | | --- | --- | | Modified: | 2022-11-11 16:29 UTC ([History](show_activity.cgi?id=11053)) | | CC List: | 10 users (show)  eggert eggert fweimer glibc-bugs-regex glibc-bugs martin.liska michael.hudson sam simon\_a\_taylor vincent-srcware | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Host:](page.cgi?id=fields.html#cf_gcchost "A custom Free Text field in this installation of Bugzilla.") |  | | [Target:](page.cgi?id=fields.html#cf_gcctarget "A custom Free Text field in this installation of Bugzilla.") |  | | [Build:](page.cgi?id=fields.html#cf_gccbuild "A custom Free Text field in this installation of Bugzilla.") |  | | [Last reconfirmed:](page.cgi?id=fields.html#cf_reconfirmed_on "A custom Date/Time field in this installation of Bugzilla.") |  | |  | | | Flags: | eggert: security+ | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**C code to reproduce the bug**](attachment.cgi?id=9758 "View the content of the attachment") (257 bytes, text/x-csrc)  [2017-01-17 22:01 UTC](#attach_9758 "Go to the comment associated with the attachment"), Paul Eggert | [Details](attachment.cgi?id=9758&action=edit) | | [**This test case silently returns the wrong answer**](attachment.cgi?id=10674 "View the content of the attachment") (203 bytes, text/x-csrc)  [2017-12-08 18:32 UTC](#attach_10674 "Go to the comment associated with the attachment"), eggert | [Details](attachment.cgi?id=10674&action=edit) | | [**regex: fix undefined backref behavior**](attachment.cgi?id=13204 "View the content of the attachment") (5.83 KB, patch)  [2021-02-06 07:37 UTC](#attach_13204 "Go to the comment associated with the attachment"), eggert | [Details](attachment.cgi?id=13204&action=edit) | [Diff](attachment.cgi?id=13204&action=diff) | | [View All](attachment.cgi?bugid=11053&action=viewall)  [Add an attachment](attachment.cgi?bugid=11053&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=11053&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=11053#c0)  Paolo Bonzini    2009-12-04 19:35:39 UTC  ``` $ echo 87654321 | \   grep -E -e '^(.?)(.?)(.?)(.?)(.?)(.?)(.?)(.?)(.?).?\9\8\7\6\5\4\3\2\1$'  Segmentation fault  Will work on a C reproducer soon. ```  [Comment 1](show_bug.cgi?id=11053#c1)  Paolo Bonzini    2010-04-09 17:46:04 UTC  ``` Minimized testcases (same regex):  $ echo 8 | grep -E -e "$regex" 8          # >>> okay $ echo 87 | grep -E -e "$regex" Segmentation fault  $ echo 88 | grep -E -e "$regex" 88         # >>> okay $ echo 887 | grep -E -e "$regex" Segmentation fault  Also, everything I tried to feed that is of length 9 or higher and should not match, gives either a false positive or a segfault:  $ echo 987654321 | grep -E -e "$regex" 887654321 $ echo 484635532 | grep -E -e "$regex" 484635532 $ echo 0123454321 | grep -E -e "$regex" Segmentation fault $ echo 0000123454321 | grep -E -e "$regex" Segmentation fault  ```  [Comment 2](show_bug.cgi?id=11053#c2)  Paul Eggert    2014-09-23 02:28:01 UTC  ``` I ran into what appears to be the same bug independently and came up with a simpler (all-C) reproducer; please see [Bug#17356](show_bug.cgi?id=17356 "REOPENED - regex misbehavior with triple backreferences").  I tried to merge the two bug reports via the web interface, but failed to do so. ```  [Comment 3](show_bug.cgi?id=11053#c3)  Florian Weimer    2014-09-23 07:55:27 UTC  ``` *** [Bug 17356](show_bug.cgi?id=17356 "REOPENED - regex misbehavior with triple backreferences") has been marked as a duplicate of this bug. *** ```  [Comment 4](show_bug.cgi?id=11053#c4)  Paul Eggert    2017-01-17 21:24:04 UTC  ``` This bug causes GNU coreutils [Bug#22793](show_bug.cgi?id=22793 "RESOLVED FIXED - Reachable assertion in find_section (src/binutils/readelf.c)") "grep -E assertion failure with back references"; see <<https://bugs.gnu.org/22793>>. I'm adding comments to both bug reports so that the connection between the two bugs is clearer.  Although this bug's current assignee is Paolo Bonzini (the original reporter), I think Paolo is pretty busy doing other stuff. Is someone else available to work on regex bugs? I suspect the fix for this bug will not be trivial. ```  [Comment 5](show_bug.cgi?id=11053#c5)  Paul Eggert    2017-01-17 22:01:52 UTC  ``` Created [attachment 9758](attachment.cgi?id=9758 "C code to reproduce the bug") [[details]](attachment.cgi?id=9758&action=edit "C code to reproduce the bug") C code to reproduce the bug  I attached a slightly-simpler C-language reproducer for the bug, derived from the attachment in [Bug#17356](show_bug.cgi?id=17356 "REOPENED - regex misbehavior with triple backreferences"). If I compile and run this program, it outputs "a.out: regexec.c:1375: pop_fail_stack: Assertion `num >= 0' failed." and then aborts. ```  [Comment 6](show_bug.cgi?id=11053#c6)  eggert    2017-12-08 18:32:01 UTC  ``` Created [attachment 10674](attachment.cgi?id=10674 "This test case silently returns the wrong answer") [[details]](attachment.cgi?id=10674&action=edit "This test case silently returns the wrong answer") This test case silently returns the wrong answer  Following up on a 'grep' bug report here:  <https://debbugs.gnu.org/29613>  attached is a seemingly-related test case which illustrates a bug that causes 'grep' to quietly return the wrong answer instead of dumping core. This test case should exit successfully, but because of the bug regexec returns 0 so the test case exits with status 1. I compiled and ran it on Fedora 27 x86-64 with "gcc regbug.c; ./a.out". ```  [Comment 7](show_bug.cgi?id=11053#c7)  eggert    2018-09-22 21:27:12 UTC  ``` Another test case for this bug can be found here:  <https://debbugs.gnu.org/32806> ```  [Comment 8](show_bug.cgi?id=11053#c8)  eggert    2019-01-31 03:20:02 UTC  ``` Another test case for this bug can be found here:  <https://debbugs.gnu.org/34238> ```  [Comment 9](show_bug.cgi?id=11053#c9)  Sourceware Commits    2019-11-11 11:27:12 UTC  ``` The master branch has been updated by Andreas Schwab <schwab@sourceware.org>:  <https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=fc141ea78ee3d87c67b18488827fe2d89c9343e7>  commit fc141ea78ee3d87c67b18488827fe2d89c9343e7 Author: Andreas Schwab <schwab@suse.de> Date:   Wed Oct 30 10:38:36 2019 +0100      Fix array bounds violation in regex matcher ([bug 25149](show_bug.cgi?id=25149 "RESOLVED FIXED - Array bounds violation in proceed_next_node"))          If the regex has more subexpressions than the number of elements allocated     in the regmatch_t array passed to regexec then proceed_next_node may     access the regmatch_t array outside its bounds.          No testcase added because even without this bug it would then crash in     pop_fail_stack which is [bug 11053](show_bug.cgi?id=11053 "RESOLVED FIXED - Wrong results with backreferences"). ```  [Comment 10](show_bug.cgi?id=11053#c10)  eggert    2021-02-06 07:37:36 UTC  ``` Created [attachment 13204](attachment.cgi?id=13204&action=diff "regex: fix undefined backref behavior") [[details]](attachment.cgi?id=13204&action=edit "regex: fix undefined backref behavior") regex: fix undefined backref behavior  I am attaching a proposed patch for this longstanding bug. I plan to email this to libc-alpha shortly. ```  [Comment 11](show_bug.cgi?id=11053#c11)  Michael Hudson-Doyle    2021-08-25 05:10:18 UTC  ``` Did the patch ever get sent to libc-alpha? ```  [Comment 12](show_bug.cgi?id=11053#c12)  eggert    2021-08-25 18:09:07 UTC  ``` (In reply to Michael Hudson-Doyle from [comment #11](show_bug.cgi?id=11053#c11)) > Did the patch ever get sent to libc-alpha?  Unfortunately I never got around to it.  Someone else can shepherd it if it's urgent; otherwise I suppose it can wait until someone gets around to syncing Gnulib with glibc. ```  [Comment 13](show_bug.cgi?id=11053#c13)  Sourceware Commits    2021-09-21 15:00:49 UTC  ``` The master branch has been updated by Paul Eggert <eggert@sourceware.org>:  <https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=0b5ca7c3e551e5502f3be3b06453324fe8604e82>  commit 0b5ca7c3e551e5502f3be3b06453324fe8604e82 Author: Paul Eggert <eggert@cs.ucla.edu> Date:   Tue Sep 21 07:47:45 2021 -0700      regex: copy back from Gnulib          Copy regex-related files back from Gnulib, to fix a problem with     static checking of regex calls noted by Martin Sebor.  This merges the     following changes:          * New macro __attribute_nonnull__ in misc/sys/cdefs.h, for use later     when copying other files back from Gnulib.          * Use __GNULIB_CDEFS instead of __GLIBC__ when deciding     whether to include bits/wordsize.h etc.          * Avoid duplicate entries in epsilon closure table.          * New regex.h macro _REGEX_NELTS to let regexec say that its pmatch     arg should contain nmatch elts.  Use that for regexec, instead of     __attr_access (which is incorrect).          * New regex.h macro _Attr_access_ which is like __attr_access except     portable to non-glibc platforms.          * Add some DEBUG_ASSERTs to pacify gcc -fanalyzer and to catch     recently-fixed performance bugs if they recur.          * Add Gnulib-specific stuff to port the dynarray- and lock-using parts     of regex code to non-glibc platforms.          * Fix glibc [bug 11053](show_bug.cgi?id=11053 "RESOLVED FIXED - Wrong results with backreferences").          * Avoid some undefined behavior when popping an empty fail stack. ```  [Comment 14](show_bug.cgi?id=11053#c14)  Vincent Lefèvre    2022-09-05 23:06:50 UTC  ``` (In reply to cvs-commit@gcc.gnu.org from [comment #13](show_bug.cgi?id=11053#c13)) > The master branch has been updated by Paul Eggert <eggert@sourceware.org>: >  > <https://sourceware.org/git/gitweb.cgi?p=glibc.git>; > h=0b5ca7c3e551e5502f3be3b06453324fe8604e82 >  > commit 0b5ca7c3e551e5502f3be3b06453324fe8604e82 > Author: Paul Eggert <eggert@cs.ucla.edu> > Date:   Tue Sep 21 07:47:45 2021 -0700 [...] >     * Fix glibc [bug 11053](show_bug.cgi?id=11053 "RESOLVED FIXED - Wrong results with backreferences").  What is the status of this bug? The comment says that it is fixed, and I could check on an Ubuntu 22.04.1 LTS machine with libc6 2.35-0ubuntu3.1 that regbug.c and rebug2.c no longer fail, but the result is still incorrect with the grep example from Debian bug 884075: <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=884075>  vinc17@gcc92:~$ echo 11111111111 | grep -E '^(11+)\1+$|^1?$' ; echo $? 11111111111 0 ```  [Comment 15](show_bug.cgi?id=11053#c15)  eggert    2022-09-06 00:37:24 UTC  ``` On 9/5/22 18:06, vincent-srcware at vinc17 dot net wrote: > > What is the status of this bug? The comment says that it is fixed, and I could > check on an Ubuntu 22.04.1 LTS machine with libc6 2.35-0ubuntu3.1 that regbug.c > and rebug2.c no longer fail, but the result is still incorrect with the grep > example from Debian bug 884075: > <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=884075> > > vinc17@gcc92:~$ echo 11111111111 | grep -E '^(11+)\1+$|^1?$' ; echo $? > 11111111111 > 0 > It looks like my comment  <<https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=884075#27>> was  incorrect, in that the two bugs are different bugs. glibc [bug 11053](show_bug.cgi?id=11053 "RESOLVED FIXED - Wrong results with backreferences") is  fixed, but Debian bug 884075 is not fixed. Perhaps a better match for  Debian bug 884075 is glibc [bug 10844](show_bug.cgi?id=10844 "ASSIGNED - failure matching regex with backreferences").  It's not an important bug. However, if you have time to fix it please  feel free to send in a fix. ```  [Comment 16](show_bug.cgi?id=11053#c16)  Vincent Lefèvre    2022-09-06 02:47:38 UTC  ``` (In reply to eggert from [comment #15](show_bug.cgi?id=11053#c15)) > glibc [bug 11053](show_bug.cgi?id=11053 "RESOLVED FIXED - Wrong results with backreferences") is fixed,  Shouldn't this bug be resolved as fixed, then?  > but Debian bug 884075 is not fixed. Perhaps a better match for  > Debian bug 884075 is glibc [bug 10844](show_bug.cgi?id=10844 "ASSIGNED - failure matching regex with backreferences").  It seems different. With Debian bug 884075, the "|^1?$" part is important (it yields the incorrect output, even though this part isn't matched), and there is nothing like that in glibc [bug 10844](show_bug.cgi?id=10844 "ASSIGNED - failure matching regex with backreferences"):  vinc17@gcc92:~$ echo 11111111111 | grep --color=auto -E '^(11+)\1+$|^1?$' 11111111111 vinc17@gcc92:~$ echo 11111111111 | grep --color=auto -E '^(11+)\1+$' vinc17@gcc92:~$   Note that for the first command, nothing is colored in "11111111111", i.e. the line is output as appeared to be matched, but no matches are shown by colors. As a comparison, with ten 1s instead of eleven, the line is output and the ten 1s are colored. ```  [Comment 17](show_bug.cgi?id=11053#c17)  Vincent Lefèvre    2022-09-06 02:59:06 UTC  ``` This could be simplified a bit:  vinc17@gcc92:~$ echo 11111111111 | grep --color=auto -E '^(11+)\1+$|^$' 11111111111  (nothing colored). ```  [Comment 18](show_bug.cgi?id=11053#c18)  eggert    2022-09-06 18:47:41 UTC  ``` (In reply to Vincent Lefèvre from [comment #16](show_bug.cgi?id=11053#c16)) > (In reply to eggert from [comment #15](show_bug.cgi?id=11053#c15)) > > glibc [bug 11053](show_bug.cgi?id=11053 "RESOLVED FIXED - Wrong results with backreferences") is fixed, >  > Shouldn't this bug be resolved as fixed, then?  OK, done.   > > Perhaps a better match for  > > Debian bug 884075 is glibc [bug 10844](show_bug.cgi?id=10844 "ASSIGNED - failure matching regex with backreferences"). >  > It seems different.  In that case it might be better to file a new glibc bug report, one that corresponds more closely to Debian bug 884075. ```  [Comment 19](show_bug.cgi?id=11053#c19)  Vincent Lefèvre    2022-09-06 22:56:39 UTC  ``` Sorry, actually both regbug.c and rebug2.c fail as they return the exit status 1 (with my usual configuration, my prompt shows any non-zero exit status, but this is not the case of the machine on which I had done the test, so that I missed the failure initially):  vinc17@gcc92:~$ ./regbug vinc17@gcc92:~$ echo $? 1 vinc17@gcc92:~$ ./rebug2 vinc17@gcc92:~$ echo $? 1  However, in the test from Paolo Bonzini's bug report ([comment 0](show_bug.cgi?id=11053#c0)), grep no longer crashes (while it still crashes with glibc 2.34, which does not have the fix).  regbug.c is derived from the attachment in [Bug#17356](show_bug.cgi?id=17356 "REOPENED - regex misbehavior with triple backreferences") (as said in [comment 5](show_bug.cgi?id=11053#c5)). I've tested this original testcase: with glibc 2.34 on x86_64, it crashes (segmentation fault); with glibc 2.35 on riscv64 (host gcc92), it outputs "no match (incorrect)".  So it seems that the fix mentioned in [comment 13](show_bug.cgi?id=11053#c13) fixed the crashes (which was the initial bug report), but not the misbehavior.  Now, with these new details, is it still OK to regard this bug as fixed and that the misbehavior (rebug.c from [Bug#17356](show_bug.cgi?id=17356 "REOPENED - regex misbehavior with triple backreferences"); regbug.c and rebug2.c from this bug) is actually a new bug? ```  [Comment 20](show_bug.cgi?id=11053#c20)  eggert    2022-09-06 23:41:30 UTC  ``` (In reply to Vincent Lefèvre from [comment #19](show_bug.cgi?id=11053#c19))  > regbug.c is derived from the attachment in [Bug#17356](show_bug.cgi?id=17356 "REOPENED - regex misbehavior with triple backreferences") (as said in [comment 5](show_bug.cgi?id=11053#c5)). > I've tested this original testcase: with glibc 2.34 on x86_64, it crashes > (segmentation fault); with glibc 2.35 on riscv64 (host gcc92), it outputs > "no match (incorrect)". >  > So it seems that the fix mentioned in [comment 13](show_bug.cgi?id=11053#c13) fixed the crashes (which > was the initial bug report), but not the misbehavior.  OK, so in that case how about if we update [Bug#17356](show_bug.cgi?id=17356 "REOPENED - regex misbehavior with triple backreferences") by (1) saying it is no longer a duplicate of [Bug#11053](show_bug.cgi?id=11053 "RESOLVED FIXED - Wrong results with backreferences") (as we've fixed the latter but not the former), and (2) reopening [Bug#17536](show_bug.cgi?id=17536 "RESOLVED DUPLICATE - gdb get top")? If I understand you correctly, that would match the symptoms you describe. ```  [Comment 21](show_bug.cgi?id=11053#c21)  Vincent Lefèvre    2022-09-07 00:17:12 UTC  ``` (In reply to eggert from [comment #20](show_bug.cgi?id=11053#c20)) > OK, so in that case how about if we update [Bug#17356](show_bug.cgi?id=17356 "REOPENED - regex misbehavior with triple backreferences") by (1) saying it is no > longer a duplicate of [Bug#11053](show_bug.cgi?id=11053 "RESOLVED FIXED - Wrong results with backreferences") (as we've fixed the latter but not the > former), and (2) reopening [Bug#17536](show_bug.cgi?id=17536 "RESOLVED DUPLICATE - gdb get top")? If I understand you correctly, that > would match the symptoms you describe.  Yes, I think that this is the best solution. ```  [Comment 22](show_bug.cgi?id=11053#c22)  eggert    2022-09-07 04:31:20 UTC  ``` (In reply to Vincent Lefèvre from [comment #21](show_bug.cgi?id=11053#c21)) > (In reply to eggert from [comment #20](show_bug.cgi?id=11053#c20)) > > OK, so in that case how about if we update [Bug#17356](show_bug.cgi?id=17356 "REOPENED - regex misbehavior with triple backreferences") by (1) saying it is no > > longer a duplicate of [Bug#11053](show_bug.cgi?id=11053 "RESOLVED FIXED - Wrong results with backreferences") (as we've fixed the latter but not the > > former), and (2) reopening [Bug#17536](show_bug.cgi?id=17536 "RESOLVED DUPLICATE - gdb get top")? If I understand you correctly, that > > would match the symptoms you describe. >  > Yes, I think that this is the best solution.  OK, done. ```  [Comment 23](show_bug.cgi?id=11053#c23)  Vincent Lefèvre    2022-09-07 10:31:57 UTC  ``` What about [attachment 10674](attachment.cgi?id=10674 "This test case silently returns the wrong answer") [[details]](attachment.cgi?id=10674&action=edit "This test case silently returns the wrong answer") ("This test case silently returns the wrong answer"), with the pattern "^(11+)\\1+$|^1?$" and the string "1111111111111"?  Should it be regarded as part of [Bug#17356](show_bug.cgi?id=17356 "REOPENED - regex misbehavior with triple backreferences") or another bug? This case seems quite different from [Bug#10844](show_bug.cgi?id=10844 "ASSIGNED - failure matching regex with backreferences") and [Bug#17356](show_bug.cgi?id=17356 "REOPENED - regex misbehavior with triple backreferences"). Unless the intent is to group all the bugs about regexp involving backreferences giving a wrong answer[*] (in which case [Bug#10844](show_bug.cgi?id=10844 "ASSIGNED - failure matching regex with backreferences") and [Bug#17356](show_bug.cgi?id=17356 "REOPENED - regex misbehavior with triple backreferences") should be regarded as duplicates to each other), I think that this should be a new bug.  [*] as opposed to a crash like in this [bug 11053](show_bug.cgi?id=11053 "RESOLVED FIXED - Wrong results with backreferences"). ```  [Comment 24](show_bug.cgi?id=11053#c24)  eggert    2022-09-07 20:57:53 UTC  ``` Sure, feel free to file it as a new bug. ```  [Comment 25](show_bug.cgi?id=11053#c25)  Vincent Lefèvre    2022-09-08 11:44:47 UTC  ``` (In reply to eggert from [comment #24](show_bug.cgi?id=11053#c24)) > Sure, feel free to file it as a new bug.  [Bug 29560](show_bug.cgi?id=29560 "UNCONFIRMED - Wrong result with backreferences (test for non-prime numbers)"). ```  [Comment 26](show_bug.cgi?id=11053#c26)  Sourceware Commits    2022-11-11 16:29:02 UTC  ``` The release/2.34/master branch has been updated by Florian Weimer <fw@sourceware.org>:  <https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=86a701a20479dfbc23540b3143fd5b28660a2447>  commit 86a701a20479dfbc23540b3143fd5b28660a2447 Author: Paul Eggert <eggert@cs.ucla.edu> Date:   Tue Sep 21 07:47:45 2021 -0700      regex: copy back from Gnulib          Copy regex-related files back from Gnulib, to fix a problem with     static checking of regex calls noted by Martin Sebor.  This merges the     following changes:          * New macro __attribute_nonnull__ in misc/sys/cdefs.h, for use later     when copying other files back from Gnulib.          * Use __GNULIB_CDEFS instead of __GLIBC__ when deciding     whether to include bits/wordsize.h etc.          * Avoid duplicate entries in epsilon closure table.          * New regex.h macro _REGEX_NELTS to let regexec say that its pmatch     arg should contain nmatch elts.  Use that for regexec, instead of     __attr_access (which is incorrect).          * New regex.h macro _Attr_access_ which is like __attr_access except     portable to non-glibc platforms.          * Add some DEBUG_ASSERTs to pacify gcc -fanalyzer and to catch     recently-fixed performance bugs if they recur.          * Add Gnulib-specific stuff to port the dynarray- and lock-using parts     of regex code to non-glibc platforms.          * Fix glibc [bug 11053](show_bug.cgi?id=11053 "RESOLVED FIXED - Wrong results with backreferences").          * Avoid some undefined behavior when popping an empty fail stack.          (cherry picked from commit 0b5ca7c3e551e5502f3be3b06453324fe8604e82) ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=11053)
* - [XML](show_bug.cgi?ctype=xml&id=11053)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=11053)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=11053&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=11053&GoAheadAndLogIn=1#forgot)
    Login:

    [x]


