=== Content from wordpress.org_50bd5c4b_20250126_090133.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Filedownload

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Ffiledownload&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Ffiledownload&locale=en_US)

Search plugins

![](https://s.w.org/plugins/geopattern-icon/filedownload.svg)
# filedownload

By [Peter Gross](http://software-regensburg.de/)

* [Details](https://wordpress.org/plugins/filedownload/#description)
* [Reviews](https://wordpress.org/plugins/filedownload/#reviews)
* [Development](https://wordpress.org/plugins/filedownload/#developers)

[Support](https://wordpress.org/support/plugin/filedownload/)

## Description

This plugin has been closed as of November 15, 2015 and is not available for download. Reason: Unknown.

## Reviews

There are no reviews for this plugin.

## Contributors & Developers

“Filedownload” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/81efb5c8edf105518bc1b52e82fada2f0b2f5c9a0c6c404391b25950e47c108d?s=32&d=mm&r=g)

[Translate “Filedownload” into your language.](https://translate.wordpress.org/projects/wp-plugins/filedownload)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/filedownload/), check out the [SVN repository](https://plugins.svn.wordpress.org/filedownload/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/filedownload/) by [RSS](https://plugins.trac.wordpress.org/log/filedownload/?limit=100&mode=stop_on_copy&format=rss).

## Meta

* Version **2.0**
* Last updated **9 years ago**
* Active installations **N/A**
* WordPress version **3.1 or higher**
* Tested up to **4.3.34**
* [Advanced View](https://wordpress.org/plugins/filedownload/advanced/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.vapidlabs.com_438d91f3_20250125_133648.html ===


| Advisory #: 140 |
| --- |
| **Title:** Open Proxy in filedownload v1.4 wordpress plugin |
| **Author:** Larry W. Cashdollar, @\_larry0 |
| **Date:** 2015-07-11 |
| **CVE-ID:**[[CVE-2015-1000002](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1000002)][[CVE-2015-1000003](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1000003)][[CVE-2015-1000004](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1000004)] |
| **CWE:** CWE-20 Input Validation |
| **Download Site:** <https://wordpress.org/plugins/filedownload/> |
| **Vendor:** Peter Gross |
| **Vendor Notified:**  2015-07-11 |
| **Vendor Contact:** plugins@wordpress.org |
| **Advisory:** <http://www.vapidlabs.com/advisory.php?v=140> |
| **Description:** Creates a downloadlink with the browsers SaveAs dialog for all available filetypes. A download counter can be shown on the post and admin area. |
| **Vulnerability:**The code in download.php doesn't check to see if a user is logged in before allowing a request to an external site. This flaw can be used to allow malicious code to be loaded into a browser or mask application attacks directed at a target site from behind vulnerable wordpress plugin sites. CVE-2015-70002 27 $type = $\_GET[type]; 28 $path = $\_GET[path]; 29 $check = $\_GET[check]; 30 31 $forbidden = false; 32 $path\_parts = pathinfo($path); 33 34 // V0.2 Security: not longer allowed relative pathes 35 if (strpos($path, 'http://') === false) $forbidden = true; 36 if (!(strpos($path, '..') === false)) $forbidden = true; 37 if (!(strpos($path, '.php') === false)) $forbidden = true; 38 39 // version 1.4 external downloads allowed? 40 $allow\_external\_download = get\_blog\_option( get\_current\_blog\_id(), "filedown load\_allow\_external\_download", "not available" ); 41 if ($allow\_external\_download == "0") // then external url downloads are not allowed 42 { 43 44 $site\_url = strtolower(get\_site\_url( get\_current\_blog\_id() )); 45 $download\_url = strtolower(substr($path\_parts[dirname], 0, strlen($site\_ur l))); CVE-2015-70003: Possible Blind SQL Injection and Persistent XSS, I haven't been able to successfully exploit these: Lines 53-54 don't handle user-input properly for $filename: 53 $query = 'SELECT \* FROM '.$wpdb->prefix.'filedownload WHERE filename = \''.$filename.'\''; 54 $result=$wpdb->get\_row($query, ARRAY\_A); The filenames are sent back to the user with out any sanitization, I believe if you can create a XSS filename as your payload you maybe able to inject persistent XSS filenames into the database. 149 foreach ($selected as $filename) 150 { 151 filedownload\_Reset($filename); 152 print "filename = $filename<br />"; 153 } 154 } CVE-2015-70004 Reflected XSS Line 61 of download.php echos the contents of referer to the user with out sanitizing its contents first leading to reflected XSS: 61 <meta http-equiv="refresh" content="3; URL=<?php echo $\_GET[referer]; ?>" |
| **Export:** [JSON](export_mitre_v4.py?id=140) [TEXT](txt.php?v=140) [XML](xml.php?s=140) |
| **Exploit Code:** ```   1. $ curl "http://www.vapidlabs.com/wp-content/plugins/filedownload/download.php?path=http://www.google.com" 3. http://www.vapidlabs.com/wp-content/plugins/filedownload/download.php?path=www.google.com&referer="><script>alert(1);</script>  ``` |
| **Screen Shots:** |
| **Notes:** |


