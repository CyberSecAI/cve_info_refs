```
{
  "ID": "CVE-2015-20108",
  "content": "The provided content relates to CVE-2015-20108.\n\nRoot cause of vulnerability:\nThe vulnerability lies in the xml_security.rb file of the ruby-saml gem, specifically in versions prior to 1.0.0. The code was susceptible to XPath injection due to improper handling of user-supplied URIs when constructing XPath queries.\n\nWeaknesses/vulnerabilities present:\n- XPath injection: The code directly embedded user-supplied URI values into XPath queries, making it vulnerable to manipulation.\n\nImpact of exploitation:\nSuccessful exploitation could lead to:\n - Disclosure of sensitive information:\n  An attacker could potentially use XPath injection to extract data from the XML document.\n - Addition or modification of data:\n  An attacker could alter XML document content.\n - Denial of Service (DoS):\n  Crafted XPath queries could cause the application to consume excessive resources, leading to a denial of service.\n\nAttack vectors:\n- Manipulation of URI attributes in SAML messages.\n\nRequired attacker capabilities/position:\n- An attacker needs to be able to supply malicious SAML messages with crafted URI attributes. No specific position is mentioned but it's implied that the attacker has to be external, sending specially crafted SAML messages to the vulnerable application.\n\nAdditional Notes:\n- The NetApp advisory (NTAP-20230703-0003) states that multiple NetApp products incorporate Ruby and therefore this vulnerability may affect them. However, the advisory also lists many products that are not affected by this vulnerability.\n- The GitHub commit log shows a fix for this vulnerability as \"Fix possible xpath injection\" and provides the specific line number change in the `xml_security.rb` file.\n- The NetApp advisory provides a CVSS score of 9.8 (CRITICAL) with vector CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H which confirms the severity of the vulnerability."
}
```