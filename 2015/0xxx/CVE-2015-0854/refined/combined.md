=== Content from bugs.launchpad.net_fa7f35e4_20250125_111444.html ===

[Log in / Register](https://bugs.launchpad.net/shutter/%2Bbug/1495163/%2Blogin)

[![](https://launchpadlibrarian.net/154784443/shutter.png)](https://launchpad.net/shutter)

## [Shutter](https://launchpad.net/shutter)

* [Overview](https://launchpad.net/shutter)
* [Code](https://code.launchpad.net/shutter)
* [Bugs](https://bugs.launchpad.net/shutter)
* [Blueprints](https://blueprints.launchpad.net/shutter)
* [Translations](https://translations.launchpad.net/shutter)
* [Answers](https://answers.launchpad.net/shutter)

# Insecure use of system() allows arbitrary code execution via "Show in Folder"

Bug #1495163 reported by
[Luke Faraone](https://launchpad.net/~lfaraone)
on 2015-09-13

[256](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Shutter](https://bugs.launchpad.net/shutter) | Fix Released | Undecided | Unassigned | [Shutter 0.94](https://launchpad.net/shutter/%2Bmilestone/0.94) |
|  | [shutter (Debian)](https://bugs.launchpad.net/debian/%2Bsource/shutter "Latest release: 0.99.5-1, uploaded to main on 2024-04-03 16:46:07.346164+00:00 by Debian Perl Group (pkg-perl-maintainers-lists-alioth), maintained by Debian Perl Group (pkg-perl-maintainers-lists-alioth)") | Fix Released | Unknown | [debbugs #798862](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=798862) |  |
|  | [shutter (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/shutter "Latest release: 0.99.5-1, uploaded to main on 2024-04-03 16:46:07.346164+00:00 by Debian Perl Group (pkg-perl-maintainers-lists-alioth), maintained by Debian Perl Group (pkg-perl-maintainers-lists-alioth)") | Fix Released | Medium | Unassigned |  |

### Bug Description

Using the "Show in folder" menu option while viewing a file with a specially-crafted path allows for arbitrary code execution with the permissions of the user running Shutter.

STEPS TO REPRODUCE:

     1. Put an image in a folder called "$(xeyes)"

     2. Open the image in Shutter

     3. Right-click the image and click "Show in Folder"

The `xeyes` program (if installed on your system) should start.

Lines 54-65 of share/shutter/resources/modules/Shutter/App/HelperFunctions.pm:

        sub xdg\_open {

                my ( $self, $dialog, $link, $user\_data ) = @\_;

                system("xdg-open $link");

Because `system` is used, the string is scanned for shell

metacharacters[1], and if found the string is executed using a shell.

[1]: <http://perldoc.perl.org/functions/system.html>

CVE-2015-0854 has been assigned for this issue by the Debian Security Team.

Tags:

[patch](/shutter/%2Bbugs?field.tag=patch)

## CVE References

* [2015-0854](/bugs/cve/2015-0854 "App/HelperFunctions.pm in Shutter thr...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Luke Faraone (lfaraone)](https://launchpad.net/~lfaraone) wrote on 2015-09-13: |  |  | [#1](/shutter/%2Bbug/1495163/comments/1) |
| --- | --- | --- | --- |

* [CVE-2015-0854.patch](https://bugs.launchpad.net/shutter/%2Bbug/1495163/%2Battachment/4462719/%2Bfiles/CVE-2015-0854.patch)
  [Edit](/shutter/%2Bbug/1495163/%2Battachment/4462719)
  (2.2 KiB,
  text/plain)

[Luke Faraone (lfaraone)](https://launchpad.net/~lfaraone)
on 2015-09-13

| **information type**: | Private Security → Public Security |
| --- | --- |

[Luke Faraone (lfaraone)](https://launchpad.net/~lfaraone)
on 2015-09-13

| Changed in shutter (Ubuntu): | |
| --- | --- |
| **status**: | New → Triaged |
| **importance**: | Undecided → Medium |

[Bug Watch Updater (bug-watch-updater)](https://launchpad.net/~bug-watch-updater)
on 2015-09-13

| Changed in shutter (Debian): | |
| --- | --- |
| **status**: | Unknown → Confirmed |

[Ubuntu Foundations Team Bug Bot (crichton)](https://launchpad.net/~crichton)
on 2015-09-13

| **tags**: | added: patch |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robin Lee (cheeselee)](https://launchpad.net/~cheeselee) wrote on 2015-09-15: |  |  | [#2](/shutter/%2Bbug/1495163/comments/2) |
| --- | --- | --- | --- |

Luke's patch is not 'strict'. '@args' should have a 'my' declaration.

Luke's patch is not 'strict'. '@args' should have a 'my' declaration.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robin Lee (cheeselee)](https://launchpad.net/~cheeselee) wrote on 2015-09-15: |  |  | [#3](/shutter/%2Bbug/1495163/comments/3) |
| --- | --- | --- | --- |

Shutter has several places using string style 'system'. Is only this 'system' vulnerable?

Shutter has several places using string style 'system'. Is only this 'system' vulnerable?

[Bug Watch Updater (bug-watch-updater)](https://launchpad.net/~bug-watch-updater)
on 2015-11-06

| Changed in shutter (Debian): | |
| --- | --- |
| **status**: | Confirmed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2016-04-02: |  |  | [#4](/shutter/%2Bbug/1495163/comments/4) |
| --- | --- | --- | --- |

This bug was fixed in the package shutter - 0.93.1-1ubuntu1

---------------

shutter (0.93.1-1ubuntu1) xenial; urgency=low

\* Merge from Debian unstable (LP: [#1564122](/bugs/1564122)). Remaining changes:

   - debian/control: Recommend libgtk2-appindicator-perl.

shutter (0.93.1-1) unstable; urgency=medium

\* Non-maintainer upload.

  \* New upstream release.

  \* Fix insecure use of system() (Closes: #798862, LP: [#1495163](/bugs/1495163)).

  \* debian/rules: Install WebService/Dropbox.pm

-- Andrew Starr-Bochicchio <email address hidden> Sat, 02 Apr 2016 11:22:14 -0400

This bug was fixed in the package shutter - 0.93.1-1ubuntu1
---------------
shutter (0.93.1-1ubuntu1) xenial; urgency=low
\* Merge from Debian unstable (LP: #1564122). Remaining changes:
- debian/control: Recommend libgtk2-appindicator-perl.
shutter (0.93.1-1) unstable; urgency=medium
\* Non-maintainer upload.
\* New upstream release.
\* Fix insecure use of system() (Closes: #798862, LP: #1495163).
\* debian/rules: Install WebService/Dropbox.pm
-- Andrew Starr-Bochicchio <a.starr.b@gmail.com> Sat, 02 Apr 2016 11:22:14 -0400

| Changed in shutter (Ubuntu): | |
| --- | --- |
| **status**: | Triaged → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Michael Kogan (michael-kogan)](https://launchpad.net/~michael-kogan) wrote on 2017-08-12: |  |  | [#5](/shutter/%2Bbug/1495163/comments/5) |
| --- | --- | --- | --- |

Applied Debian's patch in rev.1282.

Applied Debian's patch in rev.1282.

| Changed in shutter: | |
| --- | --- |
| **status**: | New → Fix Committed |

[Michael Kogan (michael-kogan)](https://launchpad.net/~michael-kogan)
on 2017-08-14

| Changed in shutter: | |
| --- | --- |
| **milestone**: | none → 0.94 |

[Michael Kogan (michael-kogan)](https://launchpad.net/~michael-kogan)
on 2017-08-16

| Changed in shutter: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

[See full activity log](https://bugs.launchpad.net/shutter/%2Bbug/1495163/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/shutter/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/shutter/%2Bbug/1495163/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/shutter/%2Bbug/1495163/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/shutter/%2Bbug/1495163/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [CVE-2015-0854.patch](https://bugs.launchpad.net/shutter/%2Bbug/1495163/%2Battachment/4462719/%2Bfiles/CVE-2015-0854.patch)
  [Edit](/shutter/%2Bbug/1495163/%2Battachment/4462719 "Change patch details")

* [Add patch](/shutter/%2Bbug/1495163/%2Baddcomment?field.patch=on)

## Remote bug watches

* [debbugs #798862](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=798862)

  [done grave patch security upstream]
  [Edit](/bugs/1495163/%2Bwatch/117247 "Change watch details")

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_a6ca484a_20250126_080937.html ===




=== Content from bugs.launchpad.net_2478d1e0_20250126_080939.html ===
# Bazaar merge directive format 2 (Bazaar 0.90)
# revision\_id: lfaraone@debian.org-20150913015632-omhhhksdbz1j2jno
# target\_branch: bzr+ssh://bazaar.launchpad.net/+branch/shutter/
# testament\_sha1: 657f895d801b5ee567032599e2f961f4537a25db
# timestamp: 2015-09-13 01:59:36 +0000
# base\_revision\_id: mario.kemper@googlemail.com-20141223230202-\
# b58zlfo5qb5e2cxt
#
# Begin patch
=== modified file 'share/shutter/resources/modules/Shutter/App/HelperFunctions.pm'
--- share/shutter/resources/modules/Shutter/App/HelperFunctions.pm 2013-08-25 18:40:51 +0000
+++ share/shutter/resources/modules/Shutter/App/HelperFunctions.pm 2015-09-13 01:56:32 +0000
@@ -53,7 +53,8 @@
sub xdg\_open {
my ( $self, $dialog, $link, $user\_data ) = @\_;
- system("xdg-open $link");
+ @args = ("xdg-open", "$link");
+ system(@args);
if($?){
my $response = $self->{\_dialogs}->dlg\_error\_message(
sprintf( $self->{\_d}->get("Error while executing %s."), "'xdg-open'"),
# Begin bundle
IyBCYXphYXIgcmV2aXNpb24gYnVuZGxlIHY0CiMKQlpoOTFBWSZTWZZuoZoAAW9fgAAwVGf//1tE
AwC///9wUAN1zXYu9esG49hKKaaU/Qyp+inpPSPSNGnk0htRkGTQBkiZNTyNDERMIAaDTQ0GgBJI
CIyamntFNpANAAAA0BtSmCk8psmU9NGo0Mag0BoB6g0Ekk0hPUzRtU09PVPaQ1DT1MmQNDQBBblC
nItOGKCVEFKr4EB+TV5NqXlTTXPaxEQcN441NfLGUe1jMvoUPf93Zo8lTOpwrtjxqi6rujPaNUTV
CagXS99rU4yR4fKPswKdWLkQ5VnuJbY6NKVyUAsM7nT6pQRQzXzlE23uIdEQUEMMZJKbdB5pRKIy
WL1scnBLBNC4at+6OQjGy1T/mLa0YWkVTkCusoYWDle1hRXrGz2YOUzUVdaddmut7OCLS7MSRXeg
caOMglpIqkaoqSvYLzbAsT+V20WStwoXb7rBRTYj4ycKqQLBHRkHWCVzJ0ibdSjXciltChrcqiQF
YgsAZ7MNOYQGgVgpP8OwBDLnM61xWspggxkwGN1KjeLWHDOYBhoHuD7V0EzQRjE9+BzPN6pDFd4W
5mbO1dxUQMJZ1WQhVIGoXzjJtObPAzQaMYhdAk5NBoj5hObdpkZjteVvW9dHtjvycid4PkVRV2w+
2SStovOFXNFQht4TkHBfKUS0mWA3bXY7THAPIN9FWaZKdBn2cr0qUcSkLlR3l5pvSyxEs7LxNIXS
mvErI+rurPau4IOalJSpU81T54yIjOIoquDxU/BXqXpxb5/M6chvLB2a+xbMBmGrnRJp51kfOGzQ
ia23MH3Yy0rg15C2iZbPmQ5RKSoIhYUn8mUK8M6GYsayXUYgwJ0sqga7syWoa3c+w4lJ9679VCcY
iAGhmyI1BsB5lIhh41Vi0gp8qriUeKTQ3/yaeBAIqYzlwY6+Mel9IVBzLrDP5vovFKZXClW3DgEQ
kKjWFoUBM4OT1vC4uG0Ru71+XFsMip2uGNAODnDSsTsxOKTPeYAnGezwmNc05BJ4k2DYocSE5hjD
UtjJyTOMs0Ur+cMwmmFgFHLIK5cDrA4UrVR6tdSSvozJ5EYME6tTuwnxJy71DECoNbwLYORVloIE
0ojtLgetx9uCjjOYYObUq9UOcX9cZNobWDtirXS1ZsJhU0+MrslK3DBAEEBWNjaOeMS1wDwGIbJa
ma5f3PtQMadvqUGhLdV0lL1WmatWtdlWxD5LyMmc/xdyRThQkJZuoZo=


=== Content from launchpad.net_63c5710f_20250126_080938.html ===

[Log in / Register](https://launchpad.net/~lfaraone/%2Blogin)

[![](https://launchpadlibrarian.net/43611899/gotchi-lp.png)](https://launchpad.net/~lfaraone)

## [Luke Faraone](https://launchpad.net/~lfaraone)

* Overview
* [Code](https://code.launchpad.net/~lfaraone)
* [Bugs](https://bugs.launchpad.net/~lfaraone)
* [Blueprints](https://blueprints.launchpad.net/~lfaraone)
* [Translations](https://translations.launchpad.net/~lfaraone)
* [Answers](https://answers.launchpad.net/~lfaraone)

Please see my homepage at https://luke.wf/.

* [Related packages](https://launchpad.net/~lfaraone/%2Brelated-packages)
* [Related projects](https://launchpad.net/~lfaraone/%2Brelated-projects)

## User information

Launchpad Id:
lfaraone

Email:
[Log in](%2Blogin) for email information.

Member since:
2007-03-16

[![Icon of 5 A Day Participants](https://launchpadlibrarian.net/38926872/5-thin.png "Member of 5 A Day Participants")](/~5-a-day-participants)
[![Icon of Daniel Holbach Huggers](https://launchpadlibrarian.net/16635438/dholbach_icon.png "Member of Daniel Holbach Huggers")](/~dholbach-huggers)
[![Icon of Debathena Project](https://launchpadlibrarian.net/23815245/debathena-14.png "Member of Debathena Project")](/~debathena)
[![Icon of Debian Developers](https://launchpadlibrarian.net/139269539/officiallogo-nd.png "Member of Debian Developers")](/~debiandevelopers)
[![Icon of GASP Development Team](https://launchpadlibrarian.net/13050224/hi3.png "Member of GASP Development Team")](/~gasp-dev)
[![Icon of Launchpad Beta Testers](https://launchpadlibrarian.net/600856498/Canonical_Launchpad_icon_14px.png "Member of Launchpad Beta Testers")](/~launchpad-beta-testers)
[![Icon of Launchpad Development mailing list](https://launchpadlibrarian.net/600856571/Canonical_Launchpad_icon_14px.png "Member of Launchpad Development mailing list")](/~launchpad-dev)
[![Icon of Launchpad Documentation Team](https://launchpadlibrarian.net/600856714/Canonical_Launchpad_icon_14px.png "Member of Launchpad Documentation Team")](/~launchpad-doc)
[![Icon of MIT SIPB](https://launchpadlibrarian.net/187191503/sipb-14.png "Member of MIT SIPB")](/~sipb)
[![Icon of MOTU](https://launchpadlibrarian.net/1516491/motu-image-2.png "Member of MOTU")](/~motu)
[![Icon of Not Canonical](https://launchpadlibrarian.net/71133712/not-canonical_aubergine_14.png "Member of Not Canonical")](/~not-canonical)
[![Icon of Ubuntu Bug Control](https://launchpadlibrarian.net/4423778/qa-icon.png "Member of Ubuntu Bug Control")](/~ubuntu-bugcontrol)
[![Icon of Ubuntu Contributing Developers](https://launchpadlibrarian.net/17290192/wrench_emblem-trans.png "Member of Ubuntu Contributing Developers")](/~ubuntu-developer-members)
[![Icon of Ubuntu Development Team](https://launchpadlibrarian.net/1072363/motu.png "Member of Ubuntu Development Team")](/~ubuntu-dev)
[![Icon of Ubuntu Members](https://launchpadlibrarian.net/606495581/CoF%2014px.png "Member of Ubuntu Members")](/~ubuntumembers)
[![Icon of Ubuntu Youth Team](https://launchpadlibrarian.net/51360495/uy14x14.png "Member of Ubuntu Youth Team")](/~ubuntu-youth)
[![Icon of Washington, DC LoCo](https://launchpadlibrarian.net/7094555/launchpad14x14.jpg "Member of Washington, DC LoCo")](/~ubuntu-districtofcolumbia)
[![Icon of Zulip](https://launchpadlibrarian.net/200042468/zulip14.png "Member of Zulip")](/~zulip)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English (United Kingdom)

OpenPGP keys:

8C823DED10AA8041639E12105ACE8D6E0C14A470

SSH keys:

[lfaraone@aqua/floss\_sensitive](%2Bsshkeys)

[lfaraone@sulfur/floss](%2Bsshkeys)

Time zone:

America/Los\_Angeles
(UTC-0800)

Karma:
[0](https://launchpad.net/~lfaraone/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**lfaraone**
 on
**irc.oftc.net**

![IRC](/@@/social-irc "IRC")
**lfaraone**
 on
**irc.libera.chat**

![Jabber](/@@/social-jabber "Jabber")
<email address hidden>

![Matrix](/@@/social-matrix "Matrix") [**@luke:faraone.cc**](https://matrix.to//#/@luke:faraone.cc)

![Matrix](/@@/social-matrix "Matrix") [**@lfaraone:matrix.mit.edu**](https://matrix.to//#/@lfaraone:matrix.mit.edu)

## [All bugs in progress](https://launchpad.net/~lfaraone/%2Bassignedbugs?search=Search&field.status=In+Progress) Assigned bugs

||  | #1102459 [usb-creator-gtk crashed with AttributeError in motion\_cb(): 'gtk.gdk.X11DragContext' object has no attribute 'drag\_status'](https://bugs.launchpad.net/ubuntu/%2Bsource/usb-creator/%2Bbug/1102459) |  |
| --- | --- | --- |
| in [Ubuntu](/ubuntu) | | |

| --- | --- | --- | --- | --- | --- |
||  | #1138033 [autokey-gtk crashed with TypeError in on\_delete\_item(): function takes at most 0 arguments (2 given)](https://bugs.launchpad.net/ubuntu/%2Bsource/autokey/%2Bbug/1138033) |  |
| --- | --- | --- |
| in [Ubuntu](/ubuntu), [AutoKey](/autokey) , [Debian](/debian) | | |

## Personal package archives

| [PPA named pithos-daily for Luke Faraone](/~lfaraone/%2Barchive/ubuntu/pithos-daily) |
| --- |
| [PPA for Luke Faraone](/~lfaraone/%2Barchive/ubuntu/ppa) |
| [Stable PPA for Luke Faraone](/~lfaraone/%2Barchive/ubuntu/stable) |

* [View source package recipes](https://code.launchpad.net/~lfaraone/%2Brecipes)

## [All memberships](https://launchpad.net/~lfaraone/%2Bparticipation) Latest memberships

| [Zulip PPA maintainers](/~zulip-ppa)  Joined on 2015-08-21 | |
| --- | --- |
| [Zulip](/~zulip)  Joined on 2015-03-12 | |
| [Ubuntu SSO 2-factor testers](/~sso-2f-testers)  Joined on 2014-07-10 | |
| [Debian Developers](/~debiandevelopers)  Joined on 2013-11-16 | |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))


