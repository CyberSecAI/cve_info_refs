- **Root cause of vulnerability**: The vulnerability lies in the `textAngular-sanitize.js` code where it fails to properly sanitize HTML content, allowing `onerror` and `onload` events to be triggered for `<img>` elements. This occurs because the code does not prevent the execution of events during the construction of these elements.
- **Weaknesses/vulnerabilities present**: Cross-Site Scripting (XSS) vulnerability due to insufficient sanitization of HTML input. Specifically, the code allows `onerror` and `onload` attributes to execute arbitrary JavaScript.
- **Impact of exploitation**: An attacker can execute arbitrary JavaScript code in the context of the victim's browser, which can lead to various malicious activities, including session hijacking, data theft, or defacement of the web page.
- **Attack vectors**: The attacker injects malicious HTML code containing `<img>` tags with `onerror` or `onload` attributes into the text editor. When the sanitized output is rendered, the injected JavaScript code is executed.
- **Required attacker capabilities/position**: The attacker needs to be able to input and submit malicious HTML content via the text editor. They do not necessarily require any other elevated privileges.