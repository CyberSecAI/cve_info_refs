```
{
  "vulnerability_details": {
    "root_cause": "The wpa_supplicant implementation of certificate subject name checking used `strstr()` for matching, which is vulnerable to extension attacks. Specifically, if the configuration specified a subject match of `/CN=wireless.nikhef.nl`, an attacker could use a certificate with a subject such as `wireless.nikhef.nl.honestachmed.tr` to bypass the check.",
    "weaknesses": [
      "Use of substring matching (`strstr()`) instead of exact matching for certificate subject name verification."
    ],
    "impact": "A man-in-the-middle (MitM) attack can be performed, allowing an attacker to impersonate a legitimate server and potentially gain access to sensitive information.",
    "attack_vectors": "A malicious access point can present a certificate with a subject that includes the required substring, but with additional characters, thus bypassing the check.",
    "required_capabilities": "The attacker needs to be able to present a certificate to the client during the TLS handshake. This is typically done by controlling a rogue access point."
  },
   "additional_details": {
    "intended_behavior": "The `subject_match` parameter was intended and documented to perform a substring match. This was later found to be inadequate for secure certificate validation.",
    "gnutls_issue": "When linked against GnuTLS, the implementation of the subject check was even weaker (or not implemented), leading to a more severe vulnerability.",
        "resolution": "A new parameter, `domain_match`, was introduced to perform full, case-insensitive matching against dNSName entries in the Subject Alternative Name (SAN) field of the certificate, falling back to CN if SAN is absent. The use of `subject_match` was deprecated.",
    "networkmanager_implication": "NetworkManager used the `subject_match` parameter and was also impacted by this vulnerability. Although it was not directly vulnerable to the exploit by extension attacks because it doesn't use substring matches,  it had no easy way to verify the server's identity in the GUI.",
    "backporting": "The fix, including `domain_match` and the ability to retrieve certificate details, was backported to the affected versions of wpa_supplicant.",
    "upstream_discussion": "The issue was discussed extensively with the upstream wpa_supplicant developers, leading to the correct fixes being introduced.",
        "pinning": "The discussion also covered the idea of certificate pinning for a more secure solution. The idea is for wpa_supplicant or Network Manager to remember the server's certificate details on first connection to make the verification procedure more convenient and user friendly."
    }
}
```