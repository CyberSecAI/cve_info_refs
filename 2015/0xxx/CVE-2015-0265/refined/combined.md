=== Content from www.slideshare.net_40b89788_20250124_215212.html ===
[![SlideShare a Scribd company logo](https://public.slidesharecdn.com/images/next/svg/logo/slideshare-scribd-company.svg?w=256&q=75)](https://www.slideshare.net/ "Return to the homepage")Submit Search
# Big problems with big data – Hadoop interfaces security

•3 likes•6,924 views![SecuRing](https://cdn.slidesharecdn.com/profile-photo-wojdwo-48x48.jpg?cb=1682404074)[SecuRing](https://www.slideshare.net/wojdwo "SecuRing")Follow

Did "cloud computing" and "big data" buzzwords bring new challenges for security testers?
Apart from complexity of Hadoop installations and number of interfaces, standard techniques can be applied to test for: web application vulnerabilities, SSL security and encryption at rest. We tested popular Hadoop environments and found a few critical vulnerabilities, which for sure cast a shadow on big data security.Read less

Read more1 of 92Download nowDownloaded 57 times![Big problems with big
data –
Hadoop interfaces
security
Jakub Kaluzny
ZeroNights, Moscow, 2015
Плохо!
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-1-320.jpg)![whoami
Sr. IT Security Consultant at SecuRing
• Consulting all phases of development
• penetration tests
• high-risk applications and systems
Researcher
• Hadoop, FOREX, MFP printers, proprietary network
protocols
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-2-320.jpg)![Agenda
Big data nonsenses
Crash course on hacking Hadoop installations
Ways to protect big data environments
Expect some CVEs
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-3-320.jpg)![Results summary
no account
standard user
admin user
admin
privileges
data access
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-4-320.jpg)![WHAT IS HADOOP?
Know your target
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-5-320.jpg)![Normal database
Users Roles Data Model
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-6-320.jpg)![Normal database architecture
http://hackaday.com/2014/04/04/sql-injection-fools-speed-traps-and-clears-your-record/
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-7-320.jpg)![Still normal database scenario
CWE-xxx: SQL Injection through license plate
http://hackaday.com/2014/04/04/sql-injection-fools-speed-traps-and-clears-your-record/
http://hococonnect.blogspot.com/2015/06/red-light-cameras-in-columbia.html
http://8z4.net/images/ocr-technology
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-8-320.jpg)![Normal database injection points
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-9-320.jpg)![Normal database
Users Roles Data Model
Clear rules
Clear target
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-10-320.jpg)![user db,
a lot of clients
critical
banking data,
one supplier
Anegdote
Only one common table
Q: Why don’t you split it into 2 dbs with a db link?
A: Too much effort and we want to have fast statistics
from all data.
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-11-320.jpg)![What is Hadoop?
https://www.flickr.com/photos/photonquantique/2596581870/
http://fiveprime.org/blackmagic.cgi?id=7007203773
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-12-320.jpg)![Hadoop architecture schema
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-13-320.jpg)![More on Hadoop
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-14-320.jpg)![Hadoop injection points
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-15-320.jpg)![Hadoop scenario
https://en.wikipedia.org/wiki/Moneygami
https://www.flickr.com/photos/mattimattila/8349565473
http://bigdataanalyticsnews.com/tag/hortonworks/
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-16-320.jpg)![21 PB of storage in a single HDFS cluster
2000 machines
12 TB per machine (a few machines have 24 TB each)
1200 machines with 8 cores each + 800 machines with
16 cores each
32 GB of RAM per machine
15 map-reduce tasks per machine
What is a lot of data?
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-17-320.jpg)![Our latest assessment:
• 32 machines, 8 cores each
• 24TB per machine
• 64 GB of RAM per machine
• Almost 1 PB disk space and 2TB of RAM
What is a lot of data?
http://mrrobot.wikia.com/wiki/E_Corp
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-18-320.jpg)![Attacker perspective
https://plus.google.com/+Magiccardtrickszonetips
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-19-320.jpg)![RISK ANALYSIS
Know your threats
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-20-320.jpg)![Who How What
Risk analysis
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-21-320.jpg)![Business perspective: competitor, script-kiddies, APT
Technical perspective:
Who?
External attacker
• Anonymous
• Ex-employee
Insider
• Exployee (with some rights in Hadoop): user, admin
• Infected machine, APT
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-22-320.jpg)![Who How What
Risk analysis
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-23-320.jpg)![Full compromise
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-24-320.jpg)![Data safety vs. data security
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-25-320.jpg)![Q: What will be stored? A: „We do not know what data will be
stored!”
Typical bank scenario
Bigdata analytic says: „People who bought a dashcam are
more likely to take a loan for a new car in the next month”
For what?
All transaction data
All sales data
All client data
http://thewondrous.com/julia-gunthel-worlds-most-flexible-secretary/
https://www.reddit.com/r/gifs/comments/37aara/calculations_intensify/
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-26-320.jpg)![For what? Data theft
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-27-320.jpg)![Other
Privilege escalation
• Authentication bypass
Abuse
• DoS
• Data tampering
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-28-320.jpg)![Who How What
Risk analysis
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-29-320.jpg)![How?
https://en.wikipedia.org/wiki/Dowsing#Rods
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-30-320.jpg)![WHAT HADOOP
REALLY IS
under sales-magic-cloud-big-data cover
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-31-320.jpg)![Typical architecture
http://thebigdatablog.weebly.com/blog/the-hadoop-ecosystem-overview
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-32-320.jpg)![Apache Hue
http://techbusinessintelligence.blogspot.com/2014/11/tableau-software-cloudera-hadoop.html
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-33-320.jpg)![Hadoop injection points
Differs much amongst distros
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-34-320.jpg)![INTERFACES
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-35-320.jpg)![Hadoop
Distros
specifics
Admin
ifaces
external
ifaces
User
ifaces
Interfaces
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-36-320.jpg)![OUR STORY WITH BIG
DATA ASSESSMENT
a.k.a. crash course on hacking big data environments
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-37-320.jpg)![Hadoop
Distros
specifics
Admin
ifaces
external
ifaces
User
ifaces
Interfaces
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-38-320.jpg)![USER INTERFACES
for employees and applications
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-39-320.jpg)![User interfaces
Hadoop
Distros
specifics
Admin
ifaces
external
ifaces
User
ifaces
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-40-320.jpg)![User interfaces
Apache Hue
• Pig, Hive, Impala, Hbase, Zookeeper, Mahout, Oozie
Other
• Tez, Solr, Slider, Spark, Phoenix, Accummulo, Storm
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-41-320.jpg)![Is Hue an internal interface?
H
D
A
E
U
http://9gag.com/gag/awrwVL1/hue-hue-hue
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-42-320.jpg)![Apache Hue overview
H
D
A
E
U
http://gethue.com/
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-43-320.jpg)![Apache Hue DOM XSS
var _anchor = $("a[name='" +
decodeURIComponent(window.location.hash.subs
tring(1)) + "']").last();
Payload: URL/help/#<img src="x"
onerror="alert(1)">
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-44-320.jpg)![Target old Hadoop installation (with Hue 2.6.1, Django
1.2.3)
Target a user with access to Hue
Send him XSS
Get access to all Hadoop data designated for the user
Apache Hue attack scenario
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-45-320.jpg)![Default configurations sucks
X-Frame-Options:ALLOWALL
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-46-320.jpg)![ADMIN INTERFACES
for admins and maintenance
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-47-320.jpg)![Hadoop
Distros
specifics
Admin
ifaces
external
ifaces
User
ifaces
Admin interfaces
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-48-320.jpg)![Admin interfaces
Apache Ambari
• Provisioning, monitoring
Apache Ranger
• Security: authorization, authentication, auditing, data encryption, administration
Other
• Knox, Cloudbreak, Zookeeper, Falcon, Atlas, Sqoop, Flume, Kafka
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-49-320.jpg)![Apache Ambari
Trochę o Ambari
http://www.slideshare.net/hortonworks/ambari-using-a-local-repository?next_slideshow=1
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-50-320.jpg)![Apache Ambari
http://www.slideshare.net/hortonworks/ambari-using-a-local-repository?next_slideshow=1
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-51-320.jpg)![Is Ambari an internal interface?
H
D
A
E
U
http://knowyourmeme.com/memes/facepalm
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-52-320.jpg)![Apache Ambari
• Standard users can sign into Ambari (WHY?)
• Low hanging fruits: directory listing by default, no
cookie flags, no CSRF protection
• Interesting proxy script ->
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-53-320.jpg)![Apache Ambari REST API proxy
Standard request:
/proxy?url=http://XXXXXXXXX:8188/ws/v1/timel
ine/HIVE_QUERY_ID?limit=1&secondaryFilter=te
z:true&_=1424180016625
H
D
A
E
U
Tampered request (logs accessible only
from DMZ):
/proxy?url=http://google.com
/proxy?url=http://XXXXXXX:8088/logs
/proxy?url=http://XXXXXXX:8088/logs/yarn-
yarn-resourcemanager-XXXXXXX.log
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-54-320.jpg)![Apache Ambari Server Side Request Forgery
H
D
A
E
UCVE-2015-1775
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-55-320.jpg)![Apache Ambari attack scenario
Target old Hadoop installation with Ambari 1.5.0 to 2.0.2
Hijack standard account (or use Hue XSS to perform CSRF)
Log into Ambari, use CVE-2015-1775
Get access to local network (DMZ) – HTTP only
Download logs, exploit other Hadoop servers in DMZ
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-56-320.jpg)![Hadoop
Distros
specifics
Admin
ifaces
external
ifaces
User
ifaces
Admin interfaces
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-57-320.jpg)![Apache Ranger overview
Previously: Apache Argus, XA-Secure
Provides central administration for policies,
users/groups, analytics and audit data.
H
D
A
E
U
http://docs.hortonworks.com/HDPDocuments/HDP2/HDP-2.3.2/bk_Sys_Admin_Guides/content/ref-
746ce51a-9bdc-4fef-85a6-69564089a8a6.1.html
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-58-320.jpg)![Apache Ranger overview
H
D
A
E
Uhttp://hortonworks.com/blog/best-practices-for-hive-authorization-using-apache-ranger-in-hdp-2-2/
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-59-320.jpg)![• Low hanging fruits: no HTTP hardening, SlowHTTP
DoS
• Standard users can log into Ranger but have no
permissions
• Interesting function level access control ->
Apache Ranger
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-60-320.jpg)![Apache Ranger vulnerabilities
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-61-320.jpg)![Missing function level access control
H
D
A
E
U
CVE-2015-0266
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-62-320.jpg)![Apache Ranger attack scenario
Target an old Hadoop installation (Apache Ranger 0.4 or XA-Secure v.
3.5.001 )
Hijack standard Hadoop account
Log into Ranger (with low permissions)
Use CVE-2015-0266 to escalate privileges
Edit accounts, authorization rules, access policies
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-63-320.jpg)![Apache Ranger vulnerabilities
H
D
A
E
U
https://cwiki.apache.org/confluence/display/RANGER/Apache+Ranger+0.5+-+User+Guide
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-64-320.jpg)![User-Agent: Mozilla/4.0 (compatible; MSIE
6.0; Windows NT 5.0)
<script>alert(1);</script>
Apache Ranger XSS through UserAgent
H
D
A
E
UCVE-2015-0265
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-65-320.jpg)![Apache Ranger attack scenario
Target an old Hadoop installation (Apache Ranger 0.4 or XA-
Secure v. 3.5.001 )
Network access to Apache Ranger is necessary (either from
the internet or local network)
Log in with any user and password using XSS in UserAgent
You don’t need to escalate privileges, you’re already an
admin (after admin opens session tab)
Deploy BEEF or whatsoever (CSRF script) to create users and
change policies
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-66-320.jpg)![• Affected version: Apache Ranger v 0.4.0, XA Secure
v. 3.5.001
• Both vulnerabilities patched in Ranger v 0.5.0
• For a while developers did a self-full-disclosure ->
Apache Ranger patched
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-67-320.jpg)![RANGER-284 in public Jira now
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-68-320.jpg)![RANGER-284 shortly after vendor contact
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-69-320.jpg)![DISTRIBUTIONS
SPECIFICS
not in every environment
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-70-320.jpg)![Hadoop
Distros
specifics
Admin
ifaces
external
ifaces
User
ifaces
Distribution specifics
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-71-320.jpg)![Distros
H
D
A
E
Uhttp://blog.cloudera.com/blog/2012/07/the-hadoop-ecosystem-visualized-in-datameer/
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-72-320.jpg)![cloud
based
hosted
locally
Basic distinction
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-73-320.jpg)![Distros
How long does it take to create a new distro version?
How many components are outdated at that time?
How long does it take to deploy a new distro at a company?
How many components are outdated at that time?
H
D
A
E
U
Most cases:
• MAJOR – ca. 1 year
• MINOR – ca. 3 months
• PATCH – ca. 1-2 months (differs much)
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-74-320.jpg)![Hortonworks HDP components by version
http://hortonworks.com/hdp/whats-new/
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-75-320.jpg)![Distros
Old components with known issues
• Old OS components (java, php, ruby, etc.)
• Old OS components (e.g. old tomcat used by Oozie and
HDFS)
• Old Hadoop components (e.g. old Hue, Ambari, Ranger)
Default passwords
Default configuration
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-76-320.jpg)![vuln found
(e.g. Ambari)
Hadoop
pached
distro update deployment
Vulnerability timeline
Responsible
Disclosure?
H
D
A
E
U
vuln found
(e.g. jQuery)
jQuery
patched
Django
patched
Hue update
distro
update
deployment
Responsible
disclosure?
Full
disclosure?
Full
disclosure?
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-77-320.jpg)![Distros
Old components with known issues
Default passwords
• SSH keys configured but default passwords still work
• Default mysql passwords, NO mysql passwords
Default configuration
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-78-320.jpg)![Distros
Old components with known issues
Default passwords
Default configuration
• No network level hardening
• No HTTP hardening (clickjacking, session mgmt, errors)
• Hue uses Django with DEBUG turned on by default
• „Hacking virtual appliances” by Jeremy Brown
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-79-320.jpg)![Default configurations sucks
X-Frame-Options:ALLOWALL
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-80-320.jpg)![EXTERNAL
INTERFACES
For clients or whatsoever
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-81-320.jpg)![Hadoop
Distros
specifics
Admin
ifaces
external
ifaces
User
ifaces
External interfaces
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-82-320.jpg)![External
• More than 25 internal Apache apps/modules
• Vendor/distro specific apps/interfaces
• Popular monitoring: Ganglia, Splunk
• Auth providers: LDAP, Kerberos, OAuth
• Many apps, many targets
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-83-320.jpg)![Hadoop
Hadoop
Distros
specifics
Admin
ifaces
external
ifaces
User
ifaces
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-84-320.jpg)![SUMMARY
ways to protect your big data environment
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-85-320.jpg)![Ways to protect your Hadoop environment
Excessive network access
• Keep it super tight!
Excessive user pesmissions
Typical web vulnerabilities
Obsolete software
Distros dependent vulnerabilities
External system connections
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-86-320.jpg)![Ways to protect your Hadoop environment
Excessive network access
Excessive user permissions
• Map business roles to permissions
Typical web vulnerabilities
Obsolete software
Distros dependent vulnerabilities
External system connections
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-87-320.jpg)![Ways to protect your Hadoop environment
Excessive network access
Excessive user permissions
Typical web vulnerabilities
• Pentest it! Introduce application independent security
countermeasures
Obsolete software
Distros dependent vulnerabilities
External system connections
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-88-320.jpg)![Ways to protect your Hadoop environment
Excessive network access
Excessive user permissions
Typical web vulnerabilities
Obsolete software
• Make a list of all components. Monitor bugtracks and CVEs.
Distros dependent vulnerabilities
External system connections
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-89-320.jpg)![Ways to protect your Hadoop environment
Excessive network access
Excessive user permissions
Typical web vulnerabilities
Obsolete software
Distros dependent vulnerabilities
• A pentest after integration is a must. Demand security from software
suppliers.
External system connections
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-90-320.jpg)![Ways to protect your Hadoop environment
Excessive network access
Excessive user permissions
Typical web vulnerabilities
Obsolete software
Distros dependent vulnerabilities
External system connections
• Make a list of all external system connections. Do a threat modeling
and pentest corresponding systems.
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-91-320.jpg)![Thank you
jakub.kaluzny@securing.pl
MORE THAN
SECURITY
TESTING
Contact me for additional materials
@j_kaluzny
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-92-320.jpg)
## More Related Content

## Big problems with big data – Hadoop interfaces security

* 1. [Big problems with](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#1)  big
  data –
  Hadoop interfaces
  security
  Jakub Kaluzny
  ZeroNights, Moscow, 2015
  Плохо!
* 2. [whoami
  Sr. IT Security](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#2)  Consultant at SecuRing
  • Consulting all phases of development
  • penetration tests
  • high-risk applications and systems
  Researcher
  • Hadoop, FOREX, MFP printers, proprietary network
  protocols
* 3. [Agenda
  Big data nonsenses
  Crash](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#3)  course on hacking Hadoop installations
  Ways to protect big data environments
  Expect some CVEs
* 4. [Results summary
  no account
  standard](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#4)  user
  admin user
  admin
  privileges
  data access
* 5. [WHAT IS HADOOP?
  Know](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#5)  your target
* 6. [Normal database
  Users Roles](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#6)  Data Model
* 7. [Normal database architecture
  http://hackaday.com/2014/04/04/sql-injection-fools-speed-traps-and-clears-your-record/](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#7)
* 8. [Still normal database](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#8)  scenario
  CWE-xxx: SQL Injection through license plate
  http://hackaday.com/2014/04/04/sql-injection-fools-speed-traps-and-clears-your-record/
  http://hococonnect.blogspot.com/2015/06/red-light-cameras-in-columbia.html
  http://8z4.net/images/ocr-technology
* 9. [Normal database injection](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#9)  points
* 10. [Normal database
  Users Roles](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#10)  Data Model
  Clear rules
  Clear target
* 11. [user db,
  a lot](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#11)  of clients
  critical
  banking data,
  one supplier
  Anegdote
  Only one common table
  Q: Why don’t you split it into 2 dbs with a db link?
  A: Too much effort and we want to have fast statistics
  from all data.
* 12. [What is Hadoop?
  https://www.flickr.com/photos/photonquantique/2596581870/
  http://fiveprime.org/blackmagic.cgi?id=7007203773](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#12)
* 13. [Hadoop architecture schema](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#13)
* 14. [More on Hadoop](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#14)
* 15. [Hadoop injection points](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#15)
* 16. [Hadoop scenario
  https://en.wikipedia.org/wiki/Moneygami
  https://www.flickr.com/photos/mattimattila/8349565473
  http://bigdataanalyticsnews.com/tag/hortonworks/](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#16)
* 17. [21 PB of](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#17)  storage in a single HDFS cluster
  2000 machines
  12 TB per machine (a few machines have 24 TB each)
  1200 machines with 8 cores each + 800 machines with
  16 cores each
  32 GB of RAM per machine
  15 map-reduce tasks per machine
  What is a lot of data?
* 18. [Our latest assessment:
  •](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#18)  32 machines, 8 cores each
  • 24TB per machine
  • 64 GB of RAM per machine
  • Almost 1 PB disk space and 2TB of RAM
  What is a lot of data?
  http://mrrobot.wikia.com/wiki/E\_Corp
* 19. [Attacker perspective
  https://plus.google.com/+Magiccardtrickszonetips](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#19)
* 20. [RISK ANALYSIS
  Know your](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#20)  threats
* 21. [Who How What
  Risk](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#21)  analysis
* 22. [Business perspective: competitor,](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#22)  script-kiddies, APT
  Technical perspective:
  Who?
  External attacker
  • Anonymous
  • Ex-employee
  Insider
  • Exployee (with some rights in Hadoop): user, admin
  • Infected machine, APT
* 23. [Who How What
  Risk](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#23)  analysis
* 24. [Full compromise](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#24)
* 25. [Data safety vs.](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#25)  data security
* 26. [Q: What will](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#26)  be stored? A: „We do not know what data will be
  stored!”
  Typical bank scenario
  Bigdata analytic says: „People who bought a dashcam are
  more likely to take a loan for a new car in the next month”
  For what?
  All transaction data
  All sales data
  All client data
  http://thewondrous.com/julia-gunthel-worlds-most-flexible-secretary/
  https://www.reddit.com/r/gifs/comments/37aara/calculations\_intensify/
* 27. [For what? Data](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#27)  theft
* 28. [Other
  Privilege escalation
  • Authentication](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#28)  bypass
  Abuse
  • DoS
  • Data tampering
* 29. [Who How What
  Risk](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#29)  analysis
* 30. [How?
  https://en.wikipedia.org/wiki/Dowsing#Rods](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#30)
* 31. [WHAT HADOOP
  REALLY IS
  under](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#31)  sales-magic-cloud-big-data cover
* 32. [Typical architecture
  http://thebigdatablog.weebly.com/blog/the-hadoop-ecosystem-overview](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#32)
* 33. [Apache Hue
  http://techbusinessintelligence.blogspot.com/2014/11/tableau-software-cloudera-hadoop.html](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#33)
* 34. [Hadoop injection points
  Differs](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#34)  much amongst distros
* 35. [INTERFACES](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#35)
* 36. [Hadoop
  Distros
  specifics
  Admin
  ifaces
  external
  ifaces
  User
  ifaces
  Interfaces](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#36)
* 37. [OUR STORY WITH](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#37)  BIG
  DATA ASSESSMENT
  a.k.a. crash course on hacking big data environments
* 38. [Hadoop
  Distros
  specifics
  Admin
  ifaces
  external
  ifaces
  User
  ifaces
  Interfaces](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#38)
* 39. [USER INTERFACES
  for employees](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#39)  and applications
* 40. [User interfaces
  Hadoop
  Distros
  specifics
  Admin
  ifaces
  external
  ifaces
  User
  ifaces](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#40)
* 41. [User interfaces
  Apache Hue
  •](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#41)  Pig, Hive, Impala, Hbase, Zookeeper, Mahout, Oozie
  Other
  • Tez, Solr, Slider, Spark, Phoenix, Accummulo, Storm
  H
  D
  A
  E
  U
* 42. [Is Hue an](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#42)  internal interface?
  H
  D
  A
  E
  U
  http://9gag.com/gag/awrwVL1/hue-hue-hue
* 43. [Apache Hue overview
  H
  D
  A
  E
  U
  http://gethue.com/](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#43)
* 44. [Apache Hue DOM](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#44)  XSS
  var \_anchor = $("a[name='" +
  decodeURIComponent(window.location.hash.subs
  tring(1)) + "']").last();
  Payload: URL/help/#<img src="x"
  onerror="alert(1)">
  H
  D
  A
  E
  U
* 45. [Target old Hadoop](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#45)  installation (with Hue 2.6.1, Django
  1.2.3)
  Target a user with access to Hue
  Send him XSS
  Get access to all Hadoop data designated for the user
  Apache Hue attack scenario
* 46. [Default configurations sucks
  X-Frame-Options:ALLOWALL](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#46)
* 47. [ADMIN INTERFACES
  for admins](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#47)  and maintenance
* 48. [Hadoop
  Distros
  specifics
  Admin
  ifaces
  external
  ifaces
  User
  ifaces
  Admin interfaces](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#48)
* 49. [Admin interfaces
  Apache Ambari
  •](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#49)  Provisioning, monitoring
  Apache Ranger
  • Security: authorization, authentication, auditing, data encryption, administration
  Other
  • Knox, Cloudbreak, Zookeeper, Falcon, Atlas, Sqoop, Flume, Kafka
  H
  D
  A
  E
  U
* 50. [Apache Ambari
  Trochę o](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#50)  Ambari
  http://www.slideshare.net/hortonworks/ambari-using-a-local-repository?next\_slideshow=1
  H
  D
  A
  E
  U
* 51. [Apache Ambari
  http://www.slideshare.net/hortonworks/ambari-using-a-local-repository?next\_slideshow=1
  H
  D
  A
  E
  U](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#51)
* 52. [Is Ambari an](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#52)  internal interface?
  H
  D
  A
  E
  U
  http://knowyourmeme.com/memes/facepalm
* 53. [Apache Ambari
  • Standard](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#53)  users can sign into Ambari (WHY?)
  • Low hanging fruits: directory listing by default, no
  cookie flags, no CSRF protection
  • Interesting proxy script ->
  H
  D
  A
  E
  U
* 54. [Apache Ambari REST](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#54)  API proxy
  Standard request:
  /proxy?url=http://XXXXXXXXX:8188/ws/v1/timel
  ine/HIVE\_QUERY\_ID?limit=1&secondaryFilter=te
  z:true&\_=1424180016625
  H
  D
  A
  E
  U
  Tampered request (logs accessible only
  from DMZ):
  /proxy?url=http://google.com
  /proxy?url=http://XXXXXXX:8088/logs
  /proxy?url=http://XXXXXXX:8088/logs/yarn-
  yarn-resourcemanager-XXXXXXX.log
* 55. [Apache Ambari Server](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#55)  Side Request Forgery
  H
  D
  A
  E
  UCVE-2015-1775
* 56. [Apache Ambari attack](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#56)  scenario
  Target old Hadoop installation with Ambari 1.5.0 to 2.0.2
  Hijack standard account (or use Hue XSS to perform CSRF)
  Log into Ambari, use CVE-2015-1775
  Get access to local network (DMZ) – HTTP only
  Download logs, exploit other Hadoop servers in DMZ
  H
  D
  A
  E
  U
* 57. [Hadoop
  Distros
  specifics
  Admin
  ifaces
  external
  ifaces
  User
  ifaces
  Admin interfaces](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#57)
* 58. [Apache Ranger overview
  Previously:](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#58)  Apache Argus, XA-Secure
  Provides central administration for policies,
  users/groups, analytics and audit data.
  H
  D
  A
  E
  U
  http://docs.hortonworks.com/HDPDocuments/HDP2/HDP-2.3.2/bk\_Sys\_Admin\_Guides/content/ref-
  746ce51a-9bdc-4fef-85a6-69564089a8a6.1.html
* 59. [Apache Ranger overview
  H
  D
  A
  E
  Uhttp://hortonworks.com/blog/best-practices-for-hive-authorization-using-apache-ranger-in-hdp-2-2/](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#59)
* 60. [• Low hanging](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#60)  fruits: no HTTP hardening, SlowHTTP
  DoS
  • Standard users can log into Ranger but have no
  permissions
  • Interesting function level access control ->
  Apache Ranger
* 61. [Apache Ranger vulnerabilities
  H
  D
  A
  E
  U](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#61)
* 62. [Missing function level](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#62)  access control
  H
  D
  A
  E
  U
  CVE-2015-0266
* 63. [Apache Ranger attack](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#63)  scenario
  Target an old Hadoop installation (Apache Ranger 0.4 or XA-Secure v.
  3.5.001 )
  Hijack standard Hadoop account
  Log into Ranger (with low permissions)
  Use CVE-2015-0266 to escalate privileges
  Edit accounts, authorization rules, access policies
  H
  D
  A
  E
  U
* 64. [Apache Ranger vulnerabilities
  H
  D
  A
  E
  U
  https://cwiki.apache.org/confluence/display/RANGER/Apache+Ranger+0.5+-+User+Guide](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#64)
* 65. [User-Agent: Mozilla/4.0 (compatible;](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#65)  MSIE
  6.0; Windows NT 5.0)
  <script>alert(1);</script>
  Apache Ranger XSS through UserAgent
  H
  D
  A
  E
  UCVE-2015-0265
* 66. [Apache Ranger attack](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#66)  scenario
  Target an old Hadoop installation (Apache Ranger 0.4 or XA-
  Secure v. 3.5.001 )
  Network access to Apache Ranger is necessary (either from
  the internet or local network)
  Log in with any user and password using XSS in UserAgent
  You don’t need to escalate privileges, you’re already an
  admin (after admin opens session tab)
  Deploy BEEF or whatsoever (CSRF script) to create users and
  change policies
  H
  D
  A
  E
  U
* 67. [• Affected version:](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#67)  Apache Ranger v 0.4.0, XA Secure
  v. 3.5.001
  • Both vulnerabilities patched in Ranger v 0.5.0
  • For a while developers did a self-full-disclosure ->
  Apache Ranger patched
* 68. [RANGER-284 in public](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#68)  Jira now
  H
  D
  A
  E
  U
* 69. [RANGER-284 shortly after](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#69)  vendor contact
  H
  D
  A
  E
  U
* 70. [DISTRIBUTIONS
  SPECIFICS
  not in every](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#70)  environment
* 71. [Hadoop
  Distros
  specifics
  Admin
  ifaces
  external
  ifaces
  User
  ifaces
  Distribution specifics](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#71)
* 72. [Distros
  H
  D
  A
  E
  Uhttp://blog.cloudera.com/blog/2012/07/the-hadoop-ecosystem-visualized-in-datameer/](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#72)
* 73. [cloud
  based
  hosted
  locally
  Basic distinction](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#73)
* 74. [Distros
  How long does](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#74)  it take to create a new distro version?
  How many components are outdated at that time?
  How long does it take to deploy a new distro at a company?
  How many components are outdated at that time?
  H
  D
  A
  E
  U
  Most cases:
  • MAJOR – ca. 1 year
  • MINOR – ca. 3 months
  • PATCH – ca. 1-2 months (differs much)
* 75. [Hortonworks HDP components](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#75)  by version
  http://hortonworks.com/hdp/whats-new/
* 76. [Distros
  Old components with](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#76)  known issues
  • Old OS components (java, php, ruby, etc.)
  • Old OS components (e.g. old tomcat used by Oozie and
  HDFS)
  • Old Hadoop components (e.g. old Hue, Ambari, Ranger)
  Default passwords
  Default configuration
  H
  D
  A
  E
  U
* 77. [vuln found
  (e.g. Ambari)
  Hadoop
  pached
  distro](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#77)  update deployment
  Vulnerability timeline
  Responsible
  Disclosure?
  H
  D
  A
  E
  U
  vuln found
  (e.g. jQuery)
  jQuery
  patched
  Django
  patched
  Hue update
  distro
  update
  deployment
  Responsible
  disclosure?
  Full
  disclosure?
  Full
  disclosure?
* 78. [Distros
  Old components with](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#78)  known issues
  Default passwords
  • SSH keys configured but default passwords still work
  • Default mysql passwords, NO mysql passwords
  Default configuration
  H
  D
  A
  E
  U
* 79. [Distros
  Old components with](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#79)  known issues
  Default passwords
  Default configuration
  • No network level hardening
  • No HTTP hardening (clickjacking, session mgmt, errors)
  • Hue uses Django with DEBUG turned on by default
  • „Hacking virtual appliances” by Jeremy Brown
  H
  D
  A
  E
  U
* 80. [Default configurations sucks
  X-Frame-Options:ALLOWALL
  H
  D
  A
  E
  U](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#80)
* 81. [EXTERNAL
  INTERFACES
  For clients or](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#81)  whatsoever
* 82. [Hadoop
  Distros
  specifics
  Admin
  ifaces
  external
  ifaces
  User
  ifaces
  External interfaces](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#82)
* 83. [External
  • More than](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#83)  25 internal Apache apps/modules
  • Vendor/distro specific apps/interfaces
  • Popular monitoring: Ganglia, Splunk
  • Auth providers: LDAP, Kerberos, OAuth
  • Many apps, many targets
  H
  D
  A
  E
  U
* 84. [Hadoop
  Hadoop
  Distros
  specifics
  Admin
  ifaces
  external
  ifaces
  User
  ifaces](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#84)
* 85. [SUMMARY
  ways to protect](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#85)  your big data environment
* 86. [Ways to protect](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#86)  your Hadoop environment
  Excessive network access
  • Keep it super tight!
  Excessive user pesmissions
  Typical web vulnerabilities
  Obsolete software
  Distros dependent vulnerabilities
  External system connections
* 87. [Ways to protect](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#87)  your Hadoop environment
  Excessive network access
  Excessive user permissions
  • Map business roles to permissions
  Typical web vulnerabilities
  Obsolete software
  Distros dependent vulnerabilities
  External system connections
* 88. [Ways to protect](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#88)  your Hadoop environment
  Excessive network access
  Excessive user permissions
  Typical web vulnerabilities
  • Pentest it! Introduce application independent security
  countermeasures
  Obsolete software
  Distros dependent vulnerabilities
  External system connections
* 89. [Ways to protect](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#89)  your Hadoop environment
  Excessive network access
  Excessive user permissions
  Typical web vulnerabilities
  Obsolete software
  • Make a list of all components. Monitor bugtracks and CVEs.
  Distros dependent vulnerabilities
  External system connections
* 90. [Ways to protect](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#90)  your Hadoop environment
  Excessive network access
  Excessive user permissions
  Typical web vulnerabilities
  Obsolete software
  Distros dependent vulnerabilities
  • A pentest after integration is a must. Demand security from software
  suppliers.
  External system connections
* 91. [Ways to protect](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#91)  your Hadoop environment
  Excessive network access
  Excessive user permissions
  Typical web vulnerabilities
  Obsolete software
  Distros dependent vulnerabilities
  External system connections
  • Make a list of all external system connections. Do a threat modeling
  and pentest corresponding systems.
* 92. [Thank you
  jakub.kaluzny@securing.pl
  MORE THAN
  SECURITY
  TESTING
  Contact](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#92)  me for additional materials
  @j\_kaluzny
Download[About](/about)[Support](https://support.scribd.com/hc/en/categories/360004792932-SlideShare?userType=SlideShare)[Terms](https://support.scribd.com/hc/en/articles/210129326-General-Terms-of-Use)[Privacy](https://support.scribd.com/hc/en/articles/210129366-Privacy-policy)[Copyright](/copyright-policy)Cookie Preferences[Do not sell or share my personal information](https://support.scribd.com/hc/en-us/articles/360038016931-Privacy-Rights-Request-Form)[Everand](https://www.everand.com)

---

© 2025 SlideShare from Scribd

=== Content from cwiki.apache.org_1766d594_20250124_215212.html ===


[Log in](https://cwiki.apache.org/confluence/login.action?os_destination=%2Fdisplay%2FRANGER%2FVulnerabilities%2Bfound%2Bin%2BRanger)
[Skip to sidebar](#nav-sidebar)
[Skip to main content](#main)
Linked ApplicationsLoading...[Apache Software Foundation](/confluence/)

* [Spaces](/confluence/spacedirectory/view.action "Spaces")

* Hit enter to search
* Help
  + [Online Help](https://docs.atlassian.com/confluence/docs-719/ "Visit the Confluence documentation home")
  + [Keyboard Shortcuts](/confluence "View available keyboard shortcuts")
  + [Feed Builder](/confluence/dashboard/configurerssfeed.action "Create your custom RSS feed.")
  + [What’s new](https://docs.atlassian.com/confluence/docs-719/help.whats.new.iframe.link)
  + [What’s new](https://confluence.atlassian.com/display/DOC/Confluence%2B7.19%2BRelease%2BNotes)
  + [Available Gadgets](/confluence "Browse gadgets provided by Confluence")
  + [About Confluence](/confluence/aboutconfluencepage.action "Get more information about Confluence")
* * [Log in](/confluence/login.action?os_destination=%2Fdisplay%2FRANGER%2FVulnerabilities%2Bfound%2Bin%2BRanger)

[![Ranger](/confluence/images/logo/default-space-logo.svg)](/confluence/display/RANGER/Index "Ranger")[Ranger](/confluence/display/RANGER/Index "Ranger")

* [Blog](/confluence/pages/viewrecentblogposts.action?key=RANGER)
* [Pages](/confluence/collector/pages.action?key=RANGER)
## Space shortcuts

* [File lists](/confluence/display/RANGER/File%2Blists)
## Page tree

Browse pagesConfigureSpace tools

* + [Attachments (0)](/confluence/pages/viewpageattachments.action?pageId=61338764 "View Attachments")
  + [Page History](/confluence/pages/viewpreviousversions.action?pageId=61338764)
  + [Resolved comments](/confluence)
  + [Page Information](/confluence/pages/viewinfo.action?pageId=61338764)
  + [View in Hierarchy](/confluence/pages/reorderpages.action?key=RANGER&openId=61338764#selectedPageInHierarchy)
  + [View Source](/confluence/plugins/viewsource/viewpagesrc.action?pageId=61338764)
  + [Delete comments](/confluence/plugins/aptis/deleteAllComments/ask-user.action?pageId=61338764)
  + [Export to PDF](/confluence/spaces/flyingpdf/pdfpageexport.action?pageId=61338764)
  + [Export to Word](/confluence/exportword?pageId=61338764)
  + [Copy Page Tree](/confluence/plugins/tree-copy/preparing-copying.action?pageId=61338764)

1. [Pages](/confluence/collector/pages.action?key=RANGER)- [Index](/confluence/display/RANGER/Index)- [Security](/confluence/display/RANGER/Security)

* Jira links
# [Vulnerabilities found in Ranger](/confluence/display/RANGER/Vulnerabilities%2Bfound%2Bin%2BRanger)

* Created by  [Velmurugan Periasamy](/confluence/display/~vperiasamy), last modified on [Jan 21, 2025](/confluence/pages/diffpagesbyversion.action?pageId=61338764&selectedPageVersions=19&selectedPageVersions=20 "Show changes")

Before reporting any security related JIRAs, please go through Apache's guidance for [VULNERABILITY HANDLING](http://www.apache.org/security/committers.html)

Please see [Lock down Apache Ranger for production deployments](/confluence/display/RANGER/Lock%2Bdown%2BApache%2BRanger%2Bfor%2Bproduction%2Bdeployments)

## **Fixed in Ranger 2.5.0**

---

**CVE-2024-45478: Stored XSS vulnerability in Edit Service Page of Apache Ranger UI**

Severity: Moderate

Vendor: The Apache Software Foundation

Versions Affected: Apache Ranger versions prior to 2.5.0

Users affected: All users of ranger policy admin tool UI

Description: Apache Ranger was found to be vulnerable to a Stored XSS issue in Edit Service functionality.

Fix detail: Added logic to validate the user input.

Mitigation: Users should upgrade to 2.5.0 or later version of Apache Ranger with the fix.

Credit: Gyujin

**CVE-2024-45479: SSRF vulnerability in Edit Service Page of Apache Ranger UI**

Severity: Moderate

Vendor: The Apache Software Foundation

Versions Affected: Apache Ranger versions prior to 2.5.0

Users affected: All users of ranger policy admin tool UI

Description: Apache Ranger was found to be vulnerable to a SSRF issue in Edit Service functionality.

Fix detail: Added logic to validate the user input.

Mitigation: Users should upgrade to 2.5.0 or later version of Apache Ranger with the fix.

Credit: Gyujin

## **Fixed in Ranger 2.0.0**

---

**CVE-2019-12397: Apache Ranger cross site scripting issue**

Severity: Normal

Vendor: The Apache Software Foundation

Versions Affected: 0.7.0 to 1.2.0 versions of Apache Ranger, prior to 2.0.0

Users affected: All users of ranger policy admin tool

Description: Apache Ranger was found to be vulnerable to a Cross-Site Scripting in policy import functionality.

Fix detail: Added logic to sanitize the user input.

Mitigation: Users should upgrade to 2.0.0 or later version of Apache Ranger with the fix.

Credit: Jan Kaszycki from STM Solutions

## **Fixed in Ranger 1.2.0**

---

**CVE-2018-11778: Apache Ranger Stack based buffer overflow**

Severity: Critical

Vendor: The Apache Software Foundation

Versions Affected: Apache Ranger versions prior to 1.2.0

Users affected: Unix Authentication Service users

Description: Apache Ranger UnixAuthenticationService should properly handle user input to avoid Stack-based buffer overflow.

Fix detail: UnixAuthenticationService was updated to correctly handle user input.

Mitigation: Users should upgrade to 1.2.0 or later version of Apache Ranger with the fix.

Credit: Alexander Klink.

## **Fixed in Ranger 0.7.1**

---

**CVE-2017-7676: Apache Ranger policy evaluation ignores characters after ‘\*’ wildcard character**

Severity: Critical

Vendor: The Apache Software Foundation

Versions Affected: 0.6.x/0.7.0 versions of Apache Ranger

Users affected: Environments that use Ranger policies with characters after ‘\*’ wildcard character – like my\*test, test\*.txt

Description: Policy resource matcher effectively ignores characters after ‘\*’ wildcard character. This can result in affected policies to apply to resources where they should not be applied.

Fix detail: Ranger policy resource matcher was updated to correctly handle wildcard matches.

Mitigation: Users should upgrade to 0.7.1 or later version of Apache Ranger with the fix.

---

**CVE-2017-7677: Apache Ranger Hive Authorizer should check for RWX permission when external location is specified**

Severity: Critical

Vendor: The Apache Software Foundation

Versions Affected: 0.5.x/0.6.x/0.7.0 versions of Apache Ranger

Users affected: Environments that use external location for hive tables

Description: Without Ranger Hive Authorizer checking RWX permission when external location is specified, there is a possibility that right permissions are not required to create the table.

Fix detail: Ranger Hive Authorizer was updated to correctly handle permission check with external location.

Mitigation: Users should upgrade to 0.7.1 or later version of Apache Ranger with the fix.

## **Fixed in Ranger 0.6.3**

---

**CVE-2016-8746: Apache Ranger path matching issue in policy evaluation**

Severity: Normal

Vendor: The Apache Software Foundation

Versions Affected: 0.6.0/0.6.1/0.6.2 versions of Apache Ranger

Users affected: All users of ranger policy admin tool

Description: Ranger policy engine incorrectly matches paths in certain conditions when policy does not contain wildcards and has recursion flag set to true.

Fix detail: Fixed policy evaluation logic.

Mitigation: Users should upgrade to 0.6.3 or later version of Apache Ranger with the fix.

---

**CVE-2016-8751: Apache Ranger stored cross site scripting issue**

Severity: Normal

Vendor: The Apache Software Foundation

Versions Affected: 0.5.x and 0.6.0/0.6.1/0.6.2 versions of Apache Ranger

Users affected: All users of ranger policy admin tool

Description: Apache Ranger was found to be vulnerable to a Stored Cross-Site Scripting in when entering custom policy conditions. Admin users can store some arbitrary javascript code to be executed when normal users login and access policies.

Fix detail: Added logic to sanitize the user input.

Mitigation: Users should upgrade to 0.6.3 or later version of Apache Ranger with the fix.

## **Fixed in Ranger 0.6.2**

---

**CVE-2016-6815: Apache Ranger user privilege vulnerability**

Severity: Normal

Vendor: The Apache Software Foundation

Versions Affected: All 0.5.x versions or 0.6.0/0.6.1 versions of Apache Ranger

Users affected: All users of ranger policy admin tool

Description: Users with "keyadmin" role should not be allowed to change password for users with "admin" role.

Fix detail: Added logic to validate the user privilege in the backend.

Mitigation: Users should upgrade to 0.6.2 or later version of Apache Ranger with the fix.

## **Fixed in Ranger 0.6.1**

---

**CVE-2016-5395: Apache Ranger Stored Cross Site Scripting vulnerability**

Severity: Normal

Vendor: The Apache Software Foundation

Versions Affected: All 0.5.x versions of Apache Ranger and version 0.6.0

Users Affected: All users of ranger policy admin tool

Description: Apache Ranger was found to be vulnerable to a Stored Cross-Site Scripting in the create user functionality. Admin users can store some arbitrary javascript code to be executed when normal users login and access policies.

Fix details: Added logic to sanitize the user input

Mitigation: Users should upgrade to 0.6.1 or later version of Apache Ranger with the fix.

Credit: Thanks to Victor Hora from Securus Global for reporting this issue.

## **Fixed in Ranger 0.5.3**

---

**CVE-2016-2174: Apache Ranger sql injection vulnerability**

Severity: Normal

Vendor: The Apache Software Foundation

Versions Affected: All versions of Apache Ranger from 0.5.0 (up to 0.5.3)

Users Affected: All admin users of ranger policy admin tool

Description: SQL Injection vulnerability in Audit > Access tab. When the user clicks an element from policyId row of the list, there is a call made underneath with eventTime parameter which contains the vulnerability. Admin users can send some arbitrary sql code to be executed along with eventTime parameter using /service/plugins/policies/eventTime url.

Fix details: Replaced native queries with JPA named queries

Mitigation: Users should upgrade to 0.5.3 version of Apache Ranger with the fix.

Credit: Thanks to Mateusz Olejarka from SecuRing for reporting this issue.

## **Fixed in Ranger 0.5.1**

---

**CVE-2015-5167: Restrict REST API data access for non-admin users**

Severity: Important

Vendor: The Apache Software Foundation

Versions Affected: 0.4.0 and 0.5.0 version of Apache Ranger

Users affected: All users of ranger policy admin tool

Description: Data access restrictions via REST API are not consistent with

restrictions in policy admin UI.

Mitigation: Users should upgrade to Ranger 0.5.1 version

---

**CVE-2016-0733: Ranger Admin authentication issue**

Severity: Important

Vendor: The Apache Software Foundation

Versions Affected: 0.4.0 and 0.5.0 version of Apache Ranger

Users affected: All users of ranger policy admin tool

Description: Malicious Users can gain access to ranger admin UI without

proper authentication

Mitigation: Users should upgrade to Ranger 0.5.1 version

---

## **Fixed in Ranger 0.5.0**

---

**CVE-2015-0265: Apache Ranger code injection vulnerability**

Severity: Important

Vendor: The Apache Software Foundation

Versions Affected: 0.4.0 version of Apache Ranger

Users affected: All admin users of ranger policy admin tool

Description: Unauthorized users can send some javascript code to be executed in ranger policy admin tool admin sessions

Fix detail: Added logic to sanitize the user input

Mitigation: Users should upgrade to 0.5.0+ version of Apache Ranger with the fix

Credit: Thanks to Jakub Kałużny from SecuRing for reporting this issue

---

**CVE-2015-0266: Apache Ranger direct url access vulnerability**

Severity: Important

Vendor: The Apache Software Foundation

Versions Affected: 0.4.0 version of Apache Ranger

Users affected: All users of ranger policy admin tool

Description: Regular users can type in the URL of modules that are accessible only to admin users

Fix detail: Added logic in the backend to verify user access

Mitigation: Users should upgrade to 0.5.0+ version of Apache Ranger with the fix

Credit: Thanks to Jakub Kałużny from SecuRing for reporting this issue

---

* No labels

Overview
Content Tools
Apps

Powered by a free **Atlassian Confluence Open Source Project License** granted to Apache Software Foundation. [Evaluate Confluence today](https://www.atlassian.com/software/views/opensource-community-additional-license-offer).

* Powered by [Atlassian Confluence](https://www.atlassian.com/software/confluence) 7.19.30
* Printed by Atlassian Confluence 7.19.30
* [Report a bug](https://support.atlassian.com/confluence-server/)
* [Atlassian News](https://www.atlassian.com/company)

[Atlassian](https://www.atlassian.com/)

{"serverDuration": 100, "requestCorrelationId": "6b8f06b4c4f58175"}


=== Content from www.slideshare.net_72630693_20250126_034600.html ===
[![SlideShare a Scribd company logo](https://public.slidesharecdn.com/images/next/svg/logo/slideshare-scribd-company.svg?w=256&q=75)](https://www.slideshare.net/ "Return to the homepage")Submit Search
# Big problems with big data – Hadoop interfaces security

•3 likes•6,924 views![SecuRing](https://cdn.slidesharecdn.com/profile-photo-wojdwo-48x48.jpg?cb=1682404074)[SecuRing](https://www.slideshare.net/wojdwo "SecuRing")Follow

Did "cloud computing" and "big data" buzzwords bring new challenges for security testers?
Apart from complexity of Hadoop installations and number of interfaces, standard techniques can be applied to test for: web application vulnerabilities, SSL security and encryption at rest. We tested popular Hadoop environments and found a few critical vulnerabilities, which for sure cast a shadow on big data security.Read less

Read more1 of 92Download nowDownloaded 57 times![Big problems with big
data –
Hadoop interfaces
security
Jakub Kaluzny
ZeroNights, Moscow, 2015
Плохо!
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-1-320.jpg)![whoami
Sr. IT Security Consultant at SecuRing
• Consulting all phases of development
• penetration tests
• high-risk applications and systems
Researcher
• Hadoop, FOREX, MFP printers, proprietary network
protocols
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-2-320.jpg)![Agenda
Big data nonsenses
Crash course on hacking Hadoop installations
Ways to protect big data environments
Expect some CVEs
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-3-320.jpg)![Results summary
no account
standard user
admin user
admin
privileges
data access
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-4-320.jpg)![WHAT IS HADOOP?
Know your target
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-5-320.jpg)![Normal database
Users Roles Data Model
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-6-320.jpg)![Normal database architecture
http://hackaday.com/2014/04/04/sql-injection-fools-speed-traps-and-clears-your-record/
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-7-320.jpg)![Still normal database scenario
CWE-xxx: SQL Injection through license plate
http://hackaday.com/2014/04/04/sql-injection-fools-speed-traps-and-clears-your-record/
http://hococonnect.blogspot.com/2015/06/red-light-cameras-in-columbia.html
http://8z4.net/images/ocr-technology
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-8-320.jpg)![Normal database injection points
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-9-320.jpg)![Normal database
Users Roles Data Model
Clear rules
Clear target
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-10-320.jpg)![user db,
a lot of clients
critical
banking data,
one supplier
Anegdote
Only one common table
Q: Why don’t you split it into 2 dbs with a db link?
A: Too much effort and we want to have fast statistics
from all data.
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-11-320.jpg)![What is Hadoop?
https://www.flickr.com/photos/photonquantique/2596581870/
http://fiveprime.org/blackmagic.cgi?id=7007203773
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-12-320.jpg)![Hadoop architecture schema
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-13-320.jpg)![More on Hadoop
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-14-320.jpg)![Hadoop injection points
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-15-320.jpg)![Hadoop scenario
https://en.wikipedia.org/wiki/Moneygami
https://www.flickr.com/photos/mattimattila/8349565473
http://bigdataanalyticsnews.com/tag/hortonworks/
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-16-320.jpg)![21 PB of storage in a single HDFS cluster
2000 machines
12 TB per machine (a few machines have 24 TB each)
1200 machines with 8 cores each + 800 machines with
16 cores each
32 GB of RAM per machine
15 map-reduce tasks per machine
What is a lot of data?
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-17-320.jpg)![Our latest assessment:
• 32 machines, 8 cores each
• 24TB per machine
• 64 GB of RAM per machine
• Almost 1 PB disk space and 2TB of RAM
What is a lot of data?
http://mrrobot.wikia.com/wiki/E_Corp
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-18-320.jpg)![Attacker perspective
https://plus.google.com/+Magiccardtrickszonetips
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-19-320.jpg)![RISK ANALYSIS
Know your threats
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-20-320.jpg)![Who How What
Risk analysis
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-21-320.jpg)![Business perspective: competitor, script-kiddies, APT
Technical perspective:
Who?
External attacker
• Anonymous
• Ex-employee
Insider
• Exployee (with some rights in Hadoop): user, admin
• Infected machine, APT
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-22-320.jpg)![Who How What
Risk analysis
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-23-320.jpg)![Full compromise
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-24-320.jpg)![Data safety vs. data security
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-25-320.jpg)![Q: What will be stored? A: „We do not know what data will be
stored!”
Typical bank scenario
Bigdata analytic says: „People who bought a dashcam are
more likely to take a loan for a new car in the next month”
For what?
All transaction data
All sales data
All client data
http://thewondrous.com/julia-gunthel-worlds-most-flexible-secretary/
https://www.reddit.com/r/gifs/comments/37aara/calculations_intensify/
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-26-320.jpg)![For what? Data theft
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-27-320.jpg)![Other
Privilege escalation
• Authentication bypass
Abuse
• DoS
• Data tampering
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-28-320.jpg)![Who How What
Risk analysis
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-29-320.jpg)![How?
https://en.wikipedia.org/wiki/Dowsing#Rods
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-30-320.jpg)![WHAT HADOOP
REALLY IS
under sales-magic-cloud-big-data cover
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-31-320.jpg)![Typical architecture
http://thebigdatablog.weebly.com/blog/the-hadoop-ecosystem-overview
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-32-320.jpg)![Apache Hue
http://techbusinessintelligence.blogspot.com/2014/11/tableau-software-cloudera-hadoop.html
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-33-320.jpg)![Hadoop injection points
Differs much amongst distros
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-34-320.jpg)![INTERFACES
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-35-320.jpg)![Hadoop
Distros
specifics
Admin
ifaces
external
ifaces
User
ifaces
Interfaces
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-36-320.jpg)![OUR STORY WITH BIG
DATA ASSESSMENT
a.k.a. crash course on hacking big data environments
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-37-320.jpg)![Hadoop
Distros
specifics
Admin
ifaces
external
ifaces
User
ifaces
Interfaces
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-38-320.jpg)![USER INTERFACES
for employees and applications
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-39-320.jpg)![User interfaces
Hadoop
Distros
specifics
Admin
ifaces
external
ifaces
User
ifaces
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-40-320.jpg)![User interfaces
Apache Hue
• Pig, Hive, Impala, Hbase, Zookeeper, Mahout, Oozie
Other
• Tez, Solr, Slider, Spark, Phoenix, Accummulo, Storm
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-41-320.jpg)![Is Hue an internal interface?
H
D
A
E
U
http://9gag.com/gag/awrwVL1/hue-hue-hue
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-42-320.jpg)![Apache Hue overview
H
D
A
E
U
http://gethue.com/
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-43-320.jpg)![Apache Hue DOM XSS
var _anchor = $("a[name='" +
decodeURIComponent(window.location.hash.subs
tring(1)) + "']").last();
Payload: URL/help/#<img src="x"
onerror="alert(1)">
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-44-320.jpg)![Target old Hadoop installation (with Hue 2.6.1, Django
1.2.3)
Target a user with access to Hue
Send him XSS
Get access to all Hadoop data designated for the user
Apache Hue attack scenario
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-45-320.jpg)![Default configurations sucks
X-Frame-Options:ALLOWALL
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-46-320.jpg)![ADMIN INTERFACES
for admins and maintenance
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-47-320.jpg)![Hadoop
Distros
specifics
Admin
ifaces
external
ifaces
User
ifaces
Admin interfaces
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-48-320.jpg)![Admin interfaces
Apache Ambari
• Provisioning, monitoring
Apache Ranger
• Security: authorization, authentication, auditing, data encryption, administration
Other
• Knox, Cloudbreak, Zookeeper, Falcon, Atlas, Sqoop, Flume, Kafka
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-49-320.jpg)![Apache Ambari
Trochę o Ambari
http://www.slideshare.net/hortonworks/ambari-using-a-local-repository?next_slideshow=1
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-50-320.jpg)![Apache Ambari
http://www.slideshare.net/hortonworks/ambari-using-a-local-repository?next_slideshow=1
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-51-320.jpg)![Is Ambari an internal interface?
H
D
A
E
U
http://knowyourmeme.com/memes/facepalm
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-52-320.jpg)![Apache Ambari
• Standard users can sign into Ambari (WHY?)
• Low hanging fruits: directory listing by default, no
cookie flags, no CSRF protection
• Interesting proxy script ->
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-53-320.jpg)![Apache Ambari REST API proxy
Standard request:
/proxy?url=http://XXXXXXXXX:8188/ws/v1/timel
ine/HIVE_QUERY_ID?limit=1&secondaryFilter=te
z:true&_=1424180016625
H
D
A
E
U
Tampered request (logs accessible only
from DMZ):
/proxy?url=http://google.com
/proxy?url=http://XXXXXXX:8088/logs
/proxy?url=http://XXXXXXX:8088/logs/yarn-
yarn-resourcemanager-XXXXXXX.log
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-54-320.jpg)![Apache Ambari Server Side Request Forgery
H
D
A
E
UCVE-2015-1775
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-55-320.jpg)![Apache Ambari attack scenario
Target old Hadoop installation with Ambari 1.5.0 to 2.0.2
Hijack standard account (or use Hue XSS to perform CSRF)
Log into Ambari, use CVE-2015-1775
Get access to local network (DMZ) – HTTP only
Download logs, exploit other Hadoop servers in DMZ
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-56-320.jpg)![Hadoop
Distros
specifics
Admin
ifaces
external
ifaces
User
ifaces
Admin interfaces
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-57-320.jpg)![Apache Ranger overview
Previously: Apache Argus, XA-Secure
Provides central administration for policies,
users/groups, analytics and audit data.
H
D
A
E
U
http://docs.hortonworks.com/HDPDocuments/HDP2/HDP-2.3.2/bk_Sys_Admin_Guides/content/ref-
746ce51a-9bdc-4fef-85a6-69564089a8a6.1.html
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-58-320.jpg)![Apache Ranger overview
H
D
A
E
Uhttp://hortonworks.com/blog/best-practices-for-hive-authorization-using-apache-ranger-in-hdp-2-2/
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-59-320.jpg)![• Low hanging fruits: no HTTP hardening, SlowHTTP
DoS
• Standard users can log into Ranger but have no
permissions
• Interesting function level access control ->
Apache Ranger
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-60-320.jpg)![Apache Ranger vulnerabilities
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-61-320.jpg)![Missing function level access control
H
D
A
E
U
CVE-2015-0266
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-62-320.jpg)![Apache Ranger attack scenario
Target an old Hadoop installation (Apache Ranger 0.4 or XA-Secure v.
3.5.001 )
Hijack standard Hadoop account
Log into Ranger (with low permissions)
Use CVE-2015-0266 to escalate privileges
Edit accounts, authorization rules, access policies
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-63-320.jpg)![Apache Ranger vulnerabilities
H
D
A
E
U
https://cwiki.apache.org/confluence/display/RANGER/Apache+Ranger+0.5+-+User+Guide
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-64-320.jpg)![User-Agent: Mozilla/4.0 (compatible; MSIE
6.0; Windows NT 5.0)
<script>alert(1);</script>
Apache Ranger XSS through UserAgent
H
D
A
E
UCVE-2015-0265
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-65-320.jpg)![Apache Ranger attack scenario
Target an old Hadoop installation (Apache Ranger 0.4 or XA-
Secure v. 3.5.001 )
Network access to Apache Ranger is necessary (either from
the internet or local network)
Log in with any user and password using XSS in UserAgent
You don’t need to escalate privileges, you’re already an
admin (after admin opens session tab)
Deploy BEEF or whatsoever (CSRF script) to create users and
change policies
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-66-320.jpg)![• Affected version: Apache Ranger v 0.4.0, XA Secure
v. 3.5.001
• Both vulnerabilities patched in Ranger v 0.5.0
• For a while developers did a self-full-disclosure ->
Apache Ranger patched
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-67-320.jpg)![RANGER-284 in public Jira now
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-68-320.jpg)![RANGER-284 shortly after vendor contact
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-69-320.jpg)![DISTRIBUTIONS
SPECIFICS
not in every environment
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-70-320.jpg)![Hadoop
Distros
specifics
Admin
ifaces
external
ifaces
User
ifaces
Distribution specifics
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-71-320.jpg)![Distros
H
D
A
E
Uhttp://blog.cloudera.com/blog/2012/07/the-hadoop-ecosystem-visualized-in-datameer/
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-72-320.jpg)![cloud
based
hosted
locally
Basic distinction
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-73-320.jpg)![Distros
How long does it take to create a new distro version?
How many components are outdated at that time?
How long does it take to deploy a new distro at a company?
How many components are outdated at that time?
H
D
A
E
U
Most cases:
• MAJOR – ca. 1 year
• MINOR – ca. 3 months
• PATCH – ca. 1-2 months (differs much)
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-74-320.jpg)![Hortonworks HDP components by version
http://hortonworks.com/hdp/whats-new/
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-75-320.jpg)![Distros
Old components with known issues
• Old OS components (java, php, ruby, etc.)
• Old OS components (e.g. old tomcat used by Oozie and
HDFS)
• Old Hadoop components (e.g. old Hue, Ambari, Ranger)
Default passwords
Default configuration
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-76-320.jpg)![vuln found
(e.g. Ambari)
Hadoop
pached
distro update deployment
Vulnerability timeline
Responsible
Disclosure?
H
D
A
E
U
vuln found
(e.g. jQuery)
jQuery
patched
Django
patched
Hue update
distro
update
deployment
Responsible
disclosure?
Full
disclosure?
Full
disclosure?
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-77-320.jpg)![Distros
Old components with known issues
Default passwords
• SSH keys configured but default passwords still work
• Default mysql passwords, NO mysql passwords
Default configuration
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-78-320.jpg)![Distros
Old components with known issues
Default passwords
Default configuration
• No network level hardening
• No HTTP hardening (clickjacking, session mgmt, errors)
• Hue uses Django with DEBUG turned on by default
• „Hacking virtual appliances” by Jeremy Brown
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-79-320.jpg)![Default configurations sucks
X-Frame-Options:ALLOWALL
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-80-320.jpg)![EXTERNAL
INTERFACES
For clients or whatsoever
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-81-320.jpg)![Hadoop
Distros
specifics
Admin
ifaces
external
ifaces
User
ifaces
External interfaces
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-82-320.jpg)![External
• More than 25 internal Apache apps/modules
• Vendor/distro specific apps/interfaces
• Popular monitoring: Ganglia, Splunk
• Auth providers: LDAP, Kerberos, OAuth
• Many apps, many targets
H
D
A
E
U
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-83-320.jpg)![Hadoop
Hadoop
Distros
specifics
Admin
ifaces
external
ifaces
User
ifaces
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-84-320.jpg)![SUMMARY
ways to protect your big data environment
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-85-320.jpg)![Ways to protect your Hadoop environment
Excessive network access
• Keep it super tight!
Excessive user pesmissions
Typical web vulnerabilities
Obsolete software
Distros dependent vulnerabilities
External system connections
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-86-320.jpg)![Ways to protect your Hadoop environment
Excessive network access
Excessive user permissions
• Map business roles to permissions
Typical web vulnerabilities
Obsolete software
Distros dependent vulnerabilities
External system connections
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-87-320.jpg)![Ways to protect your Hadoop environment
Excessive network access
Excessive user permissions
Typical web vulnerabilities
• Pentest it! Introduce application independent security
countermeasures
Obsolete software
Distros dependent vulnerabilities
External system connections
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-88-320.jpg)![Ways to protect your Hadoop environment
Excessive network access
Excessive user permissions
Typical web vulnerabilities
Obsolete software
• Make a list of all components. Monitor bugtracks and CVEs.
Distros dependent vulnerabilities
External system connections
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-89-320.jpg)![Ways to protect your Hadoop environment
Excessive network access
Excessive user permissions
Typical web vulnerabilities
Obsolete software
Distros dependent vulnerabilities
• A pentest after integration is a must. Demand security from software
suppliers.
External system connections
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-90-320.jpg)![Ways to protect your Hadoop environment
Excessive network access
Excessive user permissions
Typical web vulnerabilities
Obsolete software
Distros dependent vulnerabilities
External system connections
• Make a list of all external system connections. Do a threat modeling
and pentest corresponding systems.
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-91-320.jpg)![Thank you
jakub.kaluzny@securing.pl
MORE THAN
SECURITY
TESTING
Contact me for additional materials
@j_kaluzny
 ](https://image.slidesharecdn.com/zeronights-151203141333-lva1-app6892/85/Big-problems-with-big-data-Hadoop-interfaces-security-92-320.jpg)
## More Related Content

## Big problems with big data – Hadoop interfaces security

* 1. [Big problems with](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#1)  big
  data –
  Hadoop interfaces
  security
  Jakub Kaluzny
  ZeroNights, Moscow, 2015
  Плохо!
* 2. [whoami
  Sr. IT Security](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#2)  Consultant at SecuRing
  • Consulting all phases of development
  • penetration tests
  • high-risk applications and systems
  Researcher
  • Hadoop, FOREX, MFP printers, proprietary network
  protocols
* 3. [Agenda
  Big data nonsenses
  Crash](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#3)  course on hacking Hadoop installations
  Ways to protect big data environments
  Expect some CVEs
* 4. [Results summary
  no account
  standard](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#4)  user
  admin user
  admin
  privileges
  data access
* 5. [WHAT IS HADOOP?
  Know](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#5)  your target
* 6. [Normal database
  Users Roles](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#6)  Data Model
* 7. [Normal database architecture
  http://hackaday.com/2014/04/04/sql-injection-fools-speed-traps-and-clears-your-record/](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#7)
* 8. [Still normal database](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#8)  scenario
  CWE-xxx: SQL Injection through license plate
  http://hackaday.com/2014/04/04/sql-injection-fools-speed-traps-and-clears-your-record/
  http://hococonnect.blogspot.com/2015/06/red-light-cameras-in-columbia.html
  http://8z4.net/images/ocr-technology
* 9. [Normal database injection](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#9)  points
* 10. [Normal database
  Users Roles](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#10)  Data Model
  Clear rules
  Clear target
* 11. [user db,
  a lot](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#11)  of clients
  critical
  banking data,
  one supplier
  Anegdote
  Only one common table
  Q: Why don’t you split it into 2 dbs with a db link?
  A: Too much effort and we want to have fast statistics
  from all data.
* 12. [What is Hadoop?
  https://www.flickr.com/photos/photonquantique/2596581870/
  http://fiveprime.org/blackmagic.cgi?id=7007203773](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#12)
* 13. [Hadoop architecture schema](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#13)
* 14. [More on Hadoop](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#14)
* 15. [Hadoop injection points](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#15)
* 16. [Hadoop scenario
  https://en.wikipedia.org/wiki/Moneygami
  https://www.flickr.com/photos/mattimattila/8349565473
  http://bigdataanalyticsnews.com/tag/hortonworks/](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#16)
* 17. [21 PB of](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#17)  storage in a single HDFS cluster
  2000 machines
  12 TB per machine (a few machines have 24 TB each)
  1200 machines with 8 cores each + 800 machines with
  16 cores each
  32 GB of RAM per machine
  15 map-reduce tasks per machine
  What is a lot of data?
* 18. [Our latest assessment:
  •](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#18)  32 machines, 8 cores each
  • 24TB per machine
  • 64 GB of RAM per machine
  • Almost 1 PB disk space and 2TB of RAM
  What is a lot of data?
  http://mrrobot.wikia.com/wiki/E\_Corp
* 19. [Attacker perspective
  https://plus.google.com/+Magiccardtrickszonetips](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#19)
* 20. [RISK ANALYSIS
  Know your](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#20)  threats
* 21. [Who How What
  Risk](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#21)  analysis
* 22. [Business perspective: competitor,](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#22)  script-kiddies, APT
  Technical perspective:
  Who?
  External attacker
  • Anonymous
  • Ex-employee
  Insider
  • Exployee (with some rights in Hadoop): user, admin
  • Infected machine, APT
* 23. [Who How What
  Risk](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#23)  analysis
* 24. [Full compromise](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#24)
* 25. [Data safety vs.](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#25)  data security
* 26. [Q: What will](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#26)  be stored? A: „We do not know what data will be
  stored!”
  Typical bank scenario
  Bigdata analytic says: „People who bought a dashcam are
  more likely to take a loan for a new car in the next month”
  For what?
  All transaction data
  All sales data
  All client data
  http://thewondrous.com/julia-gunthel-worlds-most-flexible-secretary/
  https://www.reddit.com/r/gifs/comments/37aara/calculations\_intensify/
* 27. [For what? Data](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#27)  theft
* 28. [Other
  Privilege escalation
  • Authentication](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#28)  bypass
  Abuse
  • DoS
  • Data tampering
* 29. [Who How What
  Risk](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#29)  analysis
* 30. [How?
  https://en.wikipedia.org/wiki/Dowsing#Rods](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#30)
* 31. [WHAT HADOOP
  REALLY IS
  under](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#31)  sales-magic-cloud-big-data cover
* 32. [Typical architecture
  http://thebigdatablog.weebly.com/blog/the-hadoop-ecosystem-overview](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#32)
* 33. [Apache Hue
  http://techbusinessintelligence.blogspot.com/2014/11/tableau-software-cloudera-hadoop.html](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#33)
* 34. [Hadoop injection points
  Differs](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#34)  much amongst distros
* 35. [INTERFACES](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#35)
* 36. [Hadoop
  Distros
  specifics
  Admin
  ifaces
  external
  ifaces
  User
  ifaces
  Interfaces](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#36)
* 37. [OUR STORY WITH](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#37)  BIG
  DATA ASSESSMENT
  a.k.a. crash course on hacking big data environments
* 38. [Hadoop
  Distros
  specifics
  Admin
  ifaces
  external
  ifaces
  User
  ifaces
  Interfaces](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#38)
* 39. [USER INTERFACES
  for employees](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#39)  and applications
* 40. [User interfaces
  Hadoop
  Distros
  specifics
  Admin
  ifaces
  external
  ifaces
  User
  ifaces](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#40)
* 41. [User interfaces
  Apache Hue
  •](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#41)  Pig, Hive, Impala, Hbase, Zookeeper, Mahout, Oozie
  Other
  • Tez, Solr, Slider, Spark, Phoenix, Accummulo, Storm
  H
  D
  A
  E
  U
* 42. [Is Hue an](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#42)  internal interface?
  H
  D
  A
  E
  U
  http://9gag.com/gag/awrwVL1/hue-hue-hue
* 43. [Apache Hue overview
  H
  D
  A
  E
  U
  http://gethue.com/](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#43)
* 44. [Apache Hue DOM](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#44)  XSS
  var \_anchor = $("a[name='" +
  decodeURIComponent(window.location.hash.subs
  tring(1)) + "']").last();
  Payload: URL/help/#<img src="x"
  onerror="alert(1)">
  H
  D
  A
  E
  U
* 45. [Target old Hadoop](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#45)  installation (with Hue 2.6.1, Django
  1.2.3)
  Target a user with access to Hue
  Send him XSS
  Get access to all Hadoop data designated for the user
  Apache Hue attack scenario
* 46. [Default configurations sucks
  X-Frame-Options:ALLOWALL](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#46)
* 47. [ADMIN INTERFACES
  for admins](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#47)  and maintenance
* 48. [Hadoop
  Distros
  specifics
  Admin
  ifaces
  external
  ifaces
  User
  ifaces
  Admin interfaces](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#48)
* 49. [Admin interfaces
  Apache Ambari
  •](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#49)  Provisioning, monitoring
  Apache Ranger
  • Security: authorization, authentication, auditing, data encryption, administration
  Other
  • Knox, Cloudbreak, Zookeeper, Falcon, Atlas, Sqoop, Flume, Kafka
  H
  D
  A
  E
  U
* 50. [Apache Ambari
  Trochę o](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#50)  Ambari
  http://www.slideshare.net/hortonworks/ambari-using-a-local-repository?next\_slideshow=1
  H
  D
  A
  E
  U
* 51. [Apache Ambari
  http://www.slideshare.net/hortonworks/ambari-using-a-local-repository?next\_slideshow=1
  H
  D
  A
  E
  U](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#51)
* 52. [Is Ambari an](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#52)  internal interface?
  H
  D
  A
  E
  U
  http://knowyourmeme.com/memes/facepalm
* 53. [Apache Ambari
  • Standard](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#53)  users can sign into Ambari (WHY?)
  • Low hanging fruits: directory listing by default, no
  cookie flags, no CSRF protection
  • Interesting proxy script ->
  H
  D
  A
  E
  U
* 54. [Apache Ambari REST](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#54)  API proxy
  Standard request:
  /proxy?url=http://XXXXXXXXX:8188/ws/v1/timel
  ine/HIVE\_QUERY\_ID?limit=1&secondaryFilter=te
  z:true&\_=1424180016625
  H
  D
  A
  E
  U
  Tampered request (logs accessible only
  from DMZ):
  /proxy?url=http://google.com
  /proxy?url=http://XXXXXXX:8088/logs
  /proxy?url=http://XXXXXXX:8088/logs/yarn-
  yarn-resourcemanager-XXXXXXX.log
* 55. [Apache Ambari Server](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#55)  Side Request Forgery
  H
  D
  A
  E
  UCVE-2015-1775
* 56. [Apache Ambari attack](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#56)  scenario
  Target old Hadoop installation with Ambari 1.5.0 to 2.0.2
  Hijack standard account (or use Hue XSS to perform CSRF)
  Log into Ambari, use CVE-2015-1775
  Get access to local network (DMZ) – HTTP only
  Download logs, exploit other Hadoop servers in DMZ
  H
  D
  A
  E
  U
* 57. [Hadoop
  Distros
  specifics
  Admin
  ifaces
  external
  ifaces
  User
  ifaces
  Admin interfaces](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#57)
* 58. [Apache Ranger overview
  Previously:](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#58)  Apache Argus, XA-Secure
  Provides central administration for policies,
  users/groups, analytics and audit data.
  H
  D
  A
  E
  U
  http://docs.hortonworks.com/HDPDocuments/HDP2/HDP-2.3.2/bk\_Sys\_Admin\_Guides/content/ref-
  746ce51a-9bdc-4fef-85a6-69564089a8a6.1.html
* 59. [Apache Ranger overview
  H
  D
  A
  E
  Uhttp://hortonworks.com/blog/best-practices-for-hive-authorization-using-apache-ranger-in-hdp-2-2/](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#59)
* 60. [• Low hanging](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#60)  fruits: no HTTP hardening, SlowHTTP
  DoS
  • Standard users can log into Ranger but have no
  permissions
  • Interesting function level access control ->
  Apache Ranger
* 61. [Apache Ranger vulnerabilities
  H
  D
  A
  E
  U](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#61)
* 62. [Missing function level](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#62)  access control
  H
  D
  A
  E
  U
  CVE-2015-0266
* 63. [Apache Ranger attack](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#63)  scenario
  Target an old Hadoop installation (Apache Ranger 0.4 or XA-Secure v.
  3.5.001 )
  Hijack standard Hadoop account
  Log into Ranger (with low permissions)
  Use CVE-2015-0266 to escalate privileges
  Edit accounts, authorization rules, access policies
  H
  D
  A
  E
  U
* 64. [Apache Ranger vulnerabilities
  H
  D
  A
  E
  U
  https://cwiki.apache.org/confluence/display/RANGER/Apache+Ranger+0.5+-+User+Guide](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#64)
* 65. [User-Agent: Mozilla/4.0 (compatible;](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#65)  MSIE
  6.0; Windows NT 5.0)
  <script>alert(1);</script>
  Apache Ranger XSS through UserAgent
  H
  D
  A
  E
  UCVE-2015-0265
* 66. [Apache Ranger attack](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#66)  scenario
  Target an old Hadoop installation (Apache Ranger 0.4 or XA-
  Secure v. 3.5.001 )
  Network access to Apache Ranger is necessary (either from
  the internet or local network)
  Log in with any user and password using XSS in UserAgent
  You don’t need to escalate privileges, you’re already an
  admin (after admin opens session tab)
  Deploy BEEF or whatsoever (CSRF script) to create users and
  change policies
  H
  D
  A
  E
  U
* 67. [• Affected version:](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#67)  Apache Ranger v 0.4.0, XA Secure
  v. 3.5.001
  • Both vulnerabilities patched in Ranger v 0.5.0
  • For a while developers did a self-full-disclosure ->
  Apache Ranger patched
* 68. [RANGER-284 in public](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#68)  Jira now
  H
  D
  A
  E
  U
* 69. [RANGER-284 shortly after](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#69)  vendor contact
  H
  D
  A
  E
  U
* 70. [DISTRIBUTIONS
  SPECIFICS
  not in every](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#70)  environment
* 71. [Hadoop
  Distros
  specifics
  Admin
  ifaces
  external
  ifaces
  User
  ifaces
  Distribution specifics](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#71)
* 72. [Distros
  H
  D
  A
  E
  Uhttp://blog.cloudera.com/blog/2012/07/the-hadoop-ecosystem-visualized-in-datameer/](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#72)
* 73. [cloud
  based
  hosted
  locally
  Basic distinction](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#73)
* 74. [Distros
  How long does](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#74)  it take to create a new distro version?
  How many components are outdated at that time?
  How long does it take to deploy a new distro at a company?
  How many components are outdated at that time?
  H
  D
  A
  E
  U
  Most cases:
  • MAJOR – ca. 1 year
  • MINOR – ca. 3 months
  • PATCH – ca. 1-2 months (differs much)
* 75. [Hortonworks HDP components](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#75)  by version
  http://hortonworks.com/hdp/whats-new/
* 76. [Distros
  Old components with](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#76)  known issues
  • Old OS components (java, php, ruby, etc.)
  • Old OS components (e.g. old tomcat used by Oozie and
  HDFS)
  • Old Hadoop components (e.g. old Hue, Ambari, Ranger)
  Default passwords
  Default configuration
  H
  D
  A
  E
  U
* 77. [vuln found
  (e.g. Ambari)
  Hadoop
  pached
  distro](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#77)  update deployment
  Vulnerability timeline
  Responsible
  Disclosure?
  H
  D
  A
  E
  U
  vuln found
  (e.g. jQuery)
  jQuery
  patched
  Django
  patched
  Hue update
  distro
  update
  deployment
  Responsible
  disclosure?
  Full
  disclosure?
  Full
  disclosure?
* 78. [Distros
  Old components with](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#78)  known issues
  Default passwords
  • SSH keys configured but default passwords still work
  • Default mysql passwords, NO mysql passwords
  Default configuration
  H
  D
  A
  E
  U
* 79. [Distros
  Old components with](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#79)  known issues
  Default passwords
  Default configuration
  • No network level hardening
  • No HTTP hardening (clickjacking, session mgmt, errors)
  • Hue uses Django with DEBUG turned on by default
  • „Hacking virtual appliances” by Jeremy Brown
  H
  D
  A
  E
  U
* 80. [Default configurations sucks
  X-Frame-Options:ALLOWALL
  H
  D
  A
  E
  U](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#80)
* 81. [EXTERNAL
  INTERFACES
  For clients or](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#81)  whatsoever
* 82. [Hadoop
  Distros
  specifics
  Admin
  ifaces
  external
  ifaces
  User
  ifaces
  External interfaces](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#82)
* 83. [External
  • More than](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#83)  25 internal Apache apps/modules
  • Vendor/distro specific apps/interfaces
  • Popular monitoring: Ganglia, Splunk
  • Auth providers: LDAP, Kerberos, OAuth
  • Many apps, many targets
  H
  D
  A
  E
  U
* 84. [Hadoop
  Hadoop
  Distros
  specifics
  Admin
  ifaces
  external
  ifaces
  User
  ifaces](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#84)
* 85. [SUMMARY
  ways to protect](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#85)  your big data environment
* 86. [Ways to protect](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#86)  your Hadoop environment
  Excessive network access
  • Keep it super tight!
  Excessive user pesmissions
  Typical web vulnerabilities
  Obsolete software
  Distros dependent vulnerabilities
  External system connections
* 87. [Ways to protect](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#87)  your Hadoop environment
  Excessive network access
  Excessive user permissions
  • Map business roles to permissions
  Typical web vulnerabilities
  Obsolete software
  Distros dependent vulnerabilities
  External system connections
* 88. [Ways to protect](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#88)  your Hadoop environment
  Excessive network access
  Excessive user permissions
  Typical web vulnerabilities
  • Pentest it! Introduce application independent security
  countermeasures
  Obsolete software
  Distros dependent vulnerabilities
  External system connections
* 89. [Ways to protect](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#89)  your Hadoop environment
  Excessive network access
  Excessive user permissions
  Typical web vulnerabilities
  Obsolete software
  • Make a list of all components. Monitor bugtracks and CVEs.
  Distros dependent vulnerabilities
  External system connections
* 90. [Ways to protect](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#90)  your Hadoop environment
  Excessive network access
  Excessive user permissions
  Typical web vulnerabilities
  Obsolete software
  Distros dependent vulnerabilities
  • A pentest after integration is a must. Demand security from software
  suppliers.
  External system connections
* 91. [Ways to protect](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#91)  your Hadoop environment
  Excessive network access
  Excessive user permissions
  Typical web vulnerabilities
  Obsolete software
  Distros dependent vulnerabilities
  External system connections
  • Make a list of all external system connections. Do a threat modeling
  and pentest corresponding systems.
* 92. [Thank you
  jakub.kaluzny@securing.pl
  MORE THAN
  SECURITY
  TESTING
  Contact](https://www.slideshare.net/wojdwo/big-problems-with-big-data-hadoop-interfaces-security#92)  me for additional materials
  @j\_kaluzny
Download[About](/about)[Support](https://support.scribd.com/hc/en/categories/360004792932-SlideShare?userType=SlideShare)[Terms](https://support.scribd.com/hc/en/articles/210129326-General-Terms-of-Use)[Privacy](https://support.scribd.com/hc/en/articles/210129366-Privacy-policy)[Copyright](/copyright-policy)Cookie Preferences[Do not sell or share my personal information](https://support.scribd.com/hc/en-us/articles/360038016931-Privacy-Rights-Request-Form)[Everand](https://www.everand.com)

---

© 2025 SlideShare from Scribd

=== Content from mail-archives.apache.org_682151d7_20250124_215213.html ===


[![Foal logo](images/logo.png)](./)

* ![Display Settings](images/cog.png "Display Settings")
  **Email display mode:**

  ---

   Modern rendering

   Legacy rendering
* ![Logged out](images/user_loggedout.png "Not logged in")

This site requires JavaScript enabled. Please enable it.



=== Content from image.slidesharecdn.com_835f4a54_20250126_034559.html ===
RIFF�,  WEBPVP8 �,  �� �\*@� >Q"�E��!!&q�Pp
e@���'�<��H�%6�v��1~����m��,;�埞~��\_��B��ӳ�\_�����?J� ~�t�����w�����ދ��z�a�
�+��i���w�����O�g�o�\_����}}3���^|�g�����?j?���^/��O�?�\_�{�����?���������u��/;����˿�z��������-����C�O�����������U�����F}��-��������?�����~]����/���?�������U�?��\_�����m�[~�J�o�&�!.���'=�[�sH:==̗�A��D�T�2W3���LM4�ǎP��&s�����.u?����W�N&��#��[��O��}�ѭ��}���` #��
����.Sx�5ك�t���3�B�$\}�>�t�b�n��:&,��w�(2���SԻ�ux�\��ϴ�>7I3rC���b���Sz\_��� �\_�$��>��6s\��~͜uq����z���;�N]��
���W�%�U6��eMS���8��|�=.��*bh���]��b��e\_���F�m g6���PB�ܰ�zh|�S�IIi��8[^�4���A��&Em��
���@�\����u�U�s���N0c���ߜ�d|��]�c\_�?�
`��)�qb��(>r[���l���\_m2�z���o����Oʘ\_�8�8��:�?M@�9�0��b�\?�
�6m`�pCz� Ȣ��V��X��p"����oX���1��v�u���Ҕ3��
�S���0����o�uÌ<�3gk6�n��|�u^>㜰a&[�KA)���\�F���.�0�L�H�P
���\_��߶}4���I�ԫ�\*�$�E¹]��{�>�C3/86�
{�(���M \_?��K� %yKmO\_68���辚�%�b�'��F�
W���{��A]�>=�E�F�w2���7���Z�Gu����2���KK�lQ��ߚj����|KA"�@�C��u�� �.��'¾�%|�{Vf/2��,����wV0�f
�����!7r��[BG���FS~�֜��N5��( �8�Y쵎Ew������� �Gm����&��W�F���t�}xz�ͻId�N���| >pYش�E�H�К.w���o8��m��Eو�t{�%�\*G�\*!';2;En&߫dk"/)8'��K�Q$���75�`C+7[�y��X�px�nڈʹ��( ���kR8O���w��;:B)����ݺ�F�Yp)���\*����i�D�Cf�a��/5�L^��gQ�`b���Z\_i����e��g ���4;9IP�#��ہ�����&�-��k,6�V|�X-a���/�Y9`m�cKM��]P3p頝[�fӻ�<�W/@'� ��?��n�#�L�s4W����z�m����\*�i-x����R�'�O4���7��f����<�>�%�sz���t�Y��3��a��   Ÿ0k=�C`�0�)�t�ӗ��|Z�3A�V�)�U�>yϯ;h�� uH�'O04�K�j.��R)#>�LuN#�V���
�G���8W혞W�Naw
E�@���6�:��^i���3՝���3!y�5�Z�Ղ�E5P.�Ş�����C�Z�|�C�]�
���S�x
��r�ab8�;�/w+�9��"r��v�ҕeq(���'�U \o�:ٍL>HP>LPH0�%�!�%�9�����c���G~����d���2��+L�ם�6;q߬x��LWP.\*5v��6e��f1Q�b2��s���ћ7��W�ۻ��f
10S��R"FBa����<�X{�߇3�./y��sH�������~$ӼS�qJ3T��{6)@9�<��w--9\_�1cA� �6�.��H��-eC��9Rb�;hmkN̍�Q��,�I���싟���2���c�V�a��-k����k��}'��jV2�ݓ'�-�؞�=n 8������7ᤖn(SS�D�"��Ƚ�Ϗm��R�(+jӧ�9�L��D!9���d���M3�@s��uћ�uU�b��W�����C���!,�+|���ꀿ�y��H�Հ�>T�>��J�D�z��E�j���
����t'l�^<���\���
��6|���R��nBGD�s�E\��S���]^�%l�<���sGdݴ����i�${������tK�Z��$.�E����|d���8��B!�E�Һ�6�4ع"����}���nV�+���"s��Z]1XWp\��>gƜI�I|��G�2m���&x�ͱbtVs�^�vWp�5�#��
�!;<�&>�fy$5ֈ�9Yغ˫�jr�sRF���������4�2�/�,�8� <�F���8d��V� ݮC�����:������҉2��$Д$� ��U'7�BA�����ʱ�x�\_h���+n'
�R{���g�x"�h�d4�tL|�mN�Hm>}-QURT��j3�����g=�=�p��w��
�i���3�����ffs����y8��:9;\_&�9WV6-OY��ay���/pW�6\*.g1��K����i�
�dp�y��/2���Q�4;�"��e���`��aHЩo��4�,�C�## 8t��qk���֡.Vqn[�] p�o��u&�I�(�i��d�{G4�=YY|Я���@��؍�k�;��^ފ���ʾ�e��<��5th=�����.ռ�?G8�Li�Q��K�w���N�� ҪV��Ԭ�N,z��������?b�Uc|>5)fg�~�m��a�\*n6)y��e�6 Q�8���SI3t�X$fo��\_E�����X[�wB���UY̋�e2�w�O ��Ȕ\uX���K�X}jk�0�dq\�\*,��B��ȷ��ʯ:�\*�:�����O4׸h �W&������N9~��|�U��s���x2�e�$aS�9���\_����
M ��"7R\ ��T\* ��
=Fw:n?B��<�B�\t�a���fXNOX�e�����Ac�M|?xF���X��ӥL'����D�M��Ŏ�A�h��+8�x��xWh����25[��Ik�%����J�|%�OJ^� w���ˌ��W�݅�Q�l+7T���c�% �u�%x�Τn��~�h�}3y�
J�)�
�i�
VQ�P|��~�5m�L�@�Q�qJK�H�3S���lM\_br����(�3��($�K?�\_����`2�ٸ<����X� ��{\����fŀ�D&f0c7�B�����p ���{��o�`!��8\*�NT%����L$�z�7j��L�����\*�=6�7��& ���?���?�e�q�~��Ή��`&i�:%��X�$�#�a��>��/2��s�aO6�/��lf��
"Zhc�pUq�`,&�4�$/%^��;��!�:�\_��'�
�� £�i�:齮/)&�]��U>��\�+����n�Nl6�n4�ʷ���~��6�$�سQ���b��K���\��wh� U$?�K�Ѯ��ӧ�9fX5�QZ�&�H�
�%���L�=�ʽ�+�� �����'�t��=�=�X4� �<�{P$Ս�P�
��SV�
Ȕ�8Զ!�#8ا���G���Ǩ�����ʐ�n)c�| \wQ���?ܴ���h/��s�;N�����V�Uي�A�|���$%\*i}yWԣK:K�CZ7�O��>./-����D���V�
>��?@��ّ�PU<����G�t��������� ���W�p�)亅�N����I
��5�Mȉ)(\����b���o�(MTx�x�&�D�p�>Qq��r��
��m���jp�i��}�o,s>��h�۫�!��b����3ʹ����~���)�8�
��䗵fKg�q�U\*,ΖZ�Z�y�m�f|o���!�/�Շ8��흥 m�3�R�߾�Ï3�C�w)�����,[1�g�G d'�]e�MU�`�% �"�w����B ]��9r^J��&E�}\�/}�0+�T��f�[�xe�"���\-���������5S�}~\\*Z^|������wg�P�N����������;Q��\y��\*�Ǖ�����i�������w�����h�{מ�}\zy���]�.�w��}O\_�d�g�k�
���f%s
�����{�|al��\*�����ԑ��700P�������Y�Fb"�S467��!oVP���(:S��Rb�c@Q$6���Ã{�R�l��g
�E ���2ِ��`�k�SK0vN2#�>5rp��/��Ӟ�BUq���/̔���D�[$G����SO�4�
�j��Q���8Qse�EY�7��F��}�֟���`��ŷ�$������g+H����Zͪhm��0�A�{�Ȅ�&.m�UG<"C�,��=�$a&� ��sP�����A�^�(V�[x�]c�
��-u��uL3��/Pt�9e��?�}�eH�;ѳ��O�vOɈ/��ҵ�@����9��0�?4[Ce���&�f�F>�\_�pb�Ѿ&!]���S��[��n��"���Ď��v�j����+Dz�+�t���P���I3)t�;�7�3Ȅ�#�%�F���zw�<�O�b.j:c8�k�NU��}U�/G( �\*l���D��V{l�+w�e�&!�K�[��� ;��M���S�����;C�|L������i�!:��!�ӗP�cK�n����7�"�G0�v+��qv�?P�[���a����~����{���v�{=����������0�!P ��l\*O�lbw\*�.('��0�Yj�@F�Q�q�%č����@?�Ӏ�t��")�4�H�`y��ǈv?�хV�:����o��Tr�UΎ�$A-���y;\��A,p�
�gM��$?����xu��T�̸�� 6�V���VuT�{��üշ�Y�}��\*�&�� ]�R$Lt�-G8iNJ�d+\*�(�N��Rg���uM��!&]��oY��v� Gn�:;�K��������]��J~-ߋ��||
������-+���D��9�}����ק1�VXk
J� ��l��M�y�+X$-覇�1�1�l���]�/H^��P/w5���}}&�������FT]H�-��I��@��b ���UU�ؚUF~�@�s��6�-�|
�{�\_@����b�V�m�+Lhn��#Jf�b6c���.
q��\_{ ���Lp�N������O��3�ʌ4��u��b�(���j���j�j)�:&l|'Y�H t�ݼ�? ����Yh1�h�>\_Y� N��h|�F�I���.¿�a���1�Y��Z[�G�}a��z��i�P�\x^Hg�����j��a�TT]Q�]��C1��``"�����:���>����W��p�b�qu&�:��Q�N ��F���.�M��m�;�T�'G�g��YS^���12�p�N�~)�6Z/�O:�1��E��g��'E1��.I=>�&��?/�b�f>�2��2Ϩ�l\��^�]aAC�Ql4�ZLX�\_�~A��D������{�X��> \_mYË�x�X믋ˌ>N��]���4�W��/�~��>& ��k>�l��w��|n�\��;|ދ�l�c�T��:�'-O2��oAnN��g�5!�#TO\*@Y9ג-���L~p�ˆe����4K�����/�\*��:��ˈ"7�/~k&���Q8��W�=ya:�\_��|Y.�+@���.�L7/ٷb�'�Y���IP��'ٌ����J�]V�����bBl����}z������
Bg�vb1?�Mq��"3s�@�?�)p��"�I���0W�!ФS�� �\*����S��T��\�Q���k���9y;����ꆄ�v��ƕ̢:I&��t���m�?`�Eŝ���)+}R���`��8�ۄ�F�/�����ǳH�Z�ӣ)P�PmqL�GL�g�3]��W.�\*���nlw���>k���bU��J���C']��k�����|z��5,���e�G�Ob�<R:�N#哒o{�;G@�ɂ����lx���Eq$W�n �09��"9����p�"�@ \Fhw�s�O���2R�����adq������E'Gn�\_<�����x҈����lrG����QJ��$���E)pl-{1@�g.�~`��Tt�a�����,2;. ���O(ܙ>gNtl;�7�7����|���ɽ~Ig��ߥ��>@�
!!+UD��� 1r�4 ّ"t �"VV.�\c�[��3¦j^�힯�#7�F'� 7)��l=�
����T]ȎS�[n�K$�z�Ƀ@���FFoC�B�ǿ&�
W��LSF��\*uT�>��Aa���Hv��bn�p����պ}�M�B�-u��j�u��D�]o�kS1�ϣՕ|��}h�o���n�z�� �k�J�>an��� S-1��.b�����KV��6
�Wr�3J̮\_�"�l(YЅ܋�M�|�-�~f��J�Jg���J#U����[�z�H\*�[�����N�Q��S#��tPz��$��h���ز�>�'כR�l�� ���=:�����퇒V��Y'�٭iR0���Or��^"yO�Fh��9aY�.�w?��n�l�^���ա�#�����D�ua�! �0  �Q�
Oɒ�c7�k=��>X �\q��!����C�2����"u
}���ִ���l�3u8�sH��`AǺ7c��Ҋ�^Jl� cd?&BKz�P���CF�kS��gʵ�TARGvn3}�{EC`�09]���]
�IO��@��{Xq��(�$�|��L�jt��]�Jj���ZzT�x�XE{bp���{����p��T1��G\�o�0k���\*@1n�F�ɋ�!��N���o��u���ڿ3C�|��^�=iq�ͻ�u=+��#w\*��3C�Y���(��̮�\ m3!Y�Ȭ�F,���'��N;E�F�!���e!0t^@�E�Dn�ֺ��
gqkf�h��
>h��`�s�� �FZ�hi]�b�z�����\_�՟��msF���BYw�������w���GГ�8KQ/$+ ؇Jɪ�Oi�2��IVp�eI��O"���� D֥R>P���[���&3(��\߰��󄅸�����?B;\�ī�e�׊���i�\
�x{^k�\*������D\nQ�޽q]k��͇�7i��8�{�3 ��<0��"�%���/;zl��琟E�^�xݳ��:r����rQ�YI ��"߫����Oì�g���X>\�QV����F��h�G�P,bGq.�U[���N�oS)��!"U��];�6�aJ�.�Zix�.�����\�������W����X�7�2ߺ�v�^3D�2�<9��������Ѕ#��Ri\_�6>���
���8����n{��y��r��\(�ҁ>��%�Eb� {
�!rpj�R�����g�hl:\*�jG���?�R;���Y{�������J��D~
үiw��4�܍�� �����c�ã���Gu��7ɵv{|t�l�(%���G��$��� ɶM��T�v�W�Iq�/�Bp�
��7�[��ʖ�߰[P��6��&?<0T���~��1�ӝN�?艀i�b���T��¹?T�Xj��t��!��I6��c�Ӟ,ɣ{jG@��6�hV:���2o��{�#n41�ue�(�X��t�6��M�u7Ou�0v�uH�?N~��q;���1cY��oΏ�K������L��=�j�T�z�>��E;�d���HJ�A)U\_CX���n�"b��- q�^�˓
0�L��H<՚���M� ��Q�������E'�gϘ�+3�Kd��.v׻�����m
�q"�e�@HG6{-��N;�����W���a�X�0$�C~偢P�`�\�f@Y�����c/�[Pn�w�(�,硜��g��jRU=�f�
��-�2\_DA�r�;𿉹9N�T�~Zx�ˠoR:iE>C8:#{ɘ ���]h���R�Lf�HW��������;a��m��[�fT�@�a9�HeY�v��ވM�Y��ß���aU�~c�Ar�ϧdJ��G�2�O�;u���u�яx�{`�-\_�+���0������������nr��&AV�k�Z��hz�v�0!#�7!�jc3�/���%��!��k�ga��F4��\9`�ɣRe�����ː�wf�|8MX>
s9�j�W��x� �ч�C��XV6?       x\���9�v&�;�xG���(7��s���y��6?0���CW���h�Rdf��P0/Q��ȏl�2d�\�� �h�χ ��?J$o����a�k�C5`�c����8�췰���?�'�Cr:��E�v���Թs�v���c�\_�Jf9�h�僺 �����l`�-��}�U�ER�Q M0�A���Kg���G�onZ.ifH��4�/�%����R�>L����囼ؽD�Lk����!��
A��TzO��W�Q)�O),y] ~����\*�՞!?��\;���!bb��C�m�Θ)
��s�t����$��S��&E�d���R+"�QL!���x.���l�7������Qߊz�dN�P��i�Jc�޾�ی�Y�\*�`�~�A���/6����Q�U�I��\gue(L(����P��Je��H��؊��î%���b�P茀��T�
�s�@J���f)�E�.�S=�F��M���D��~r�46�b:I�p1GI���DPm`�[X�+7~��@���d�r5���-��m�1�D�x�qFt���y(���
A\_�x!��m�6����SA��-6ͼ��S�;�����T��@ti�y
�����9����� �!������P�+��ɵ�i���&�Ǥ��"�B�"8o
�1���\*D�hB&�%j���B�1m�ݲ��C�PI��ɰ~^��P,��
<5-c�:70W"�/��`�ĭx�.���f�P�B�����\����y���9�r�B)�����
�R:�H϶�^�tPJ�6���d�tx+�8�I(��)�U�m�e�k��AG�l%Mw�F��R��6�/y�Y�S�$��k"���m� ����$�o
ݯ~��0�H�������6-�\_p�D)\_f�N��Ϯ��] �C\*Θ���^K4�\*�����qj
W���I�x^���m�D
���f�u�9BY%6B�׿��2��s�l����b0��k��'J��6�s�j�Xe$��SY�`�^X��bLB>��ZG�7�2W\_Hw���,�W����ǌ��#�NU{V�3c��$��=���77|�#o�  *
