```
{
  "CVE-2015-0804": {
    "description": "The HTMLSourceElement::BindToTree function in Mozilla Firefox before 37.0 does not properly constrain a data type after omitting namespace validation during certain tree-binding operations, which allows remote attackers to execute arbitrary code or cause a denial of service (use-after-free) via a crafted HTML document containing a SOURCE element.",
    "affected_products": [
      "Mozilla Firefox",
       "SeaMonkey"
    ],
    "vulnerability_details": {
      "root_cause": "Type confusion due to missing namespace validation in HTMLSourceElement::BindToTree function during tree binding operations.",
      "weaknesses": [
        "Incorrect object casting",
        "Missing namespace validation",
        "Use-after-free"
      ],
      "impact": "Arbitrary code execution or denial of service (use-after-free).",
      "attack_vectors": "Crafted HTML document containing a SOURCE element.",
      "attacker_capabilities": "Remote attacker, user needs to be enticed to open the crafted HTML document."
    },
    "additional_information": {
        "suse_information": {
            "overall_state": "Resolved",
            "severity": "Important",
            "cvss_v2_score": "7.5",
            "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
            "suse_bugzilla_entries": [
              "925368",
              "925400"
              ],
             "suse_security_advisories": [
              "openSUSE-SU-2015:0677-1",
              "openSUSE-SU-2024:14572-1"
              ],
          "fixed_package_versions":{
            "SUSE Enterprise Storage 6, SUSE Linux Enterprise Desktop 15 SP1, SUSE Linux Enterprise High Performance Computing 15 SP1, SUSE Linux Enterprise Module for Desktop Applications 15 SP1, SUSE Linux Enterprise Server 15 SP1, SUSE Linux Enterprise Server for SAP Applications 15 SP1, SUSE Manager Proxy 4.0, SUSE Manager Retail Branch Server 4.0, SUSE Manager Server 4.0": "MozillaFirefox >= 60.6.2-3.32.1, MozillaFirefox-devel >= 60.6.2-3.32.1, MozillaFirefox-translations-common >= 60.6.2-3.32.1, MozillaFirefox-translations-other >= 60.6.2-3.32.1",
            "SUSE Enterprise Storage 7.1, SUSE Linux Enterprise Desktop 15 SP3, SUSE Linux Enterprise High Performance Computing 15 SP3, SUSE Linux Enterprise Module for Desktop Applications 15 SP3, SUSE Linux Enterprise Server 15 SP3, SUSE Linux Enterprise Server for SAP Applications 15 SP3, SUSE Manager Proxy 4.2, SUSE Manager Retail Branch Server 4.2, SUSE Manager Server 4.2": "MozillaFirefox >= 78.10.0-8.38.1, MozillaFirefox-devel >= 78.10.0-8.38.1, MozillaFirefox-translations-common >= 78.10.0-8.38.1, MozillaFirefox-translations-other >= 78.10.0-8.38.1",
            "SUSE Enterprise Storage 7, SUSE Linux Enterprise Desktop 15 SP2, SUSE Linux Enterprise High Performance Computing 15 SP2, SUSE Linux Enterprise Module for Desktop Applications 15 SP2, SUSE Linux Enterprise Server 15 SP2, SUSE Linux Enterprise Server for SAP Applications 15 SP2, SUSE Manager Proxy 4.1, SUSE Manager Retail Branch Server 4.1, SUSE Manager Server 4.1": "MozillaFirefox >= 68.8.0-3.87.1, MozillaFirefox-devel >= 68.8.0-3.87.1, MozillaFirefox-translations-common >= 68.8.0-3.87.1, MozillaFirefox-translations-other >= 68.8.0-3.87.1",
             "SUSE Linux Enterprise Desktop 15 SP4, SUSE Linux Enterprise High Performance Computing 15 SP4, SUSE Linux Enterprise Module for Desktop Applications 15 SP4, SUSE Linux Enterprise Server 15 SP4, SUSE Linux Enterprise Server for SAP Applications 15 SP4, SUSE Manager Proxy 4.3, SUSE Manager Retail Branch Server 4.3, SUSE Manager Server 4.3": "MozillaFirefox >= 91.8.0-150200.152.26.1, MozillaFirefox-devel >= 91.8.0-150200.152.26.1, MozillaFirefox-translations-common >= 91.8.0-150200.152.26.1, MozillaFirefox-translations-other >= 91.8.0-150200.152.26.1",
            "SUSE Linux Enterprise Desktop 15 SP5, SUSE Linux Enterprise High Performance Computing 15 SP5, SUSE Linux Enterprise Module for Desktop Applications 15 SP5, SUSE Linux Enterprise Server 15 SP5, SUSE Linux Enterprise Server for SAP Applications 15 SP5": "MozillaFirefox >= 102.11.0-150200.152.87.1, MozillaFirefox-devel >= 102.11.0-150200.152.87.1, MozillaFirefox-translations-common >= 102.11.0-150200.152.87.1, MozillaFirefox-translations-other >= 102.11.0-150200.152.87.1",
            "SUSE Linux Enterprise Desktop 15 SP6, SUSE Linux Enterprise High Performance Computing 15 SP6, SUSE Linux Enterprise Module for Desktop Applications 15 SP6, SUSE Linux Enterprise Server 15 SP6, SUSE Linux Enterprise Server for SAP Applications 15 SP6": "MozillaFirefox >= 115.10.0-150200.152.134.1, MozillaFirefox-devel >= 102.12.0-150200.152.90.1, MozillaFirefox-translations-common >= 115.10.0-150200.152.134.1, MozillaFirefox-translations-other >= 115.10.0-150200.152.134.1",
           "SUSE Linux Enterprise Desktop 15, SUSE Linux Enterprise High Performance Computing 15, SUSE Linux Enterprise Module for Desktop Applications 15, SUSE Linux Enterprise Server 15, SUSE Linux Enterprise Server for SAP Applications 15": "MozillaFirefox >= 52.7.3-1.35, MozillaFirefox-devel >= 52.7.3-1.35, MozillaFirefox-translations-common >= 52.7.3-1.35, MozillaFirefox-translations-other >= 52.7.3-1.35",
            "openSUSE Leap 15.0": "MozillaFirefox >= 60.0-lp150.2.2, MozillaFirefox-translations-common >= 60.0-lp150.2.2, MozillaFirefox-translations-other >= 60.0-lp150.2.2",
            "openSUSE Leap 15.2": "MozillaFirefox >= 68.9.0-lp152.1.3, MozillaFirefox-translations-common >= 68.9.0-lp152.1.3, MozillaFirefox-translations-other >= 68.9.0-lp152.1.3",
            "openSUSE Leap 15.3": "MozillaFirefox >= 78.10.0-8.38.1, MozillaFirefox-translations-common >= 78.10.0-8.38.1, MozillaFirefox-translations-other >= 78.10.0-8.38.1",
            "openSUSE Leap 15.4": "MozillaFirefox >= 91.8.0-150200.152.26.1, MozillaFirefox-translations-common >= 91.8.0-150200.152.26.1, MozillaFirefox-translations-other >= 91.8.0-150200.152.26.1",
            "openSUSE Tumbleweed": "MozillaFirefox >= 50.1.0-1.1, MozillaFirefox-branding-upstream >= 50.1.0-1.1, MozillaFirefox-buildsymbols >= 50.1.0-1.1, MozillaFirefox-devel >= 50.1.0-1.1, MozillaFirefox-translations-common >= 50.1.0-1.1, MozillaFirefox-translations-other >= 50.1.0-1.1, firefox-esr >= 128.5.1-1.1, firefox-esr-branding-upstream >= 128.5.1-1.1, firefox-esr-translations-common >= 128.5.1-1.1, firefox-esr-translations-other >= 128.5.1-1.1"
           }
        },
        "gentoo_information": {
            "glsa_id": "201512-10",
            "affected_packages": [
                "www-client/firefox < 38.5.0",
                "www-client/firefox-bin < 38.5.0",
                "mail-client/thunderbird < 38.5.0",
                "mail-client/thunderbird-bin < 38.5.0"
            ],
            "impact": "A remote attacker could entice a user to view a specially crafted web page or email, possibly resulting in execution of arbitrary code or a Denial of Service condition."
            },
            "ubuntu_information": {
              "usn_id": "USN-2550-1",
              "affected_packages": ["firefox"],
                 "details": "Several type confusion issues were discovered in Firefox. If a user were\n  tricked in to opening a specially crafted website, an attacker could\n  potentially exploit these to cause a denial of service via application\n  crash, or execute arbitrary code with the privileges of the user invoking\n  Firefox. (CVE-2015-0803, CVE-2015-0804)",
               "update_instructions": {
                    "Ubuntu 14.10": "firefox - 37.0+build2-0ubuntu0.14.10.1",
                     "Ubuntu 14.04": "firefox - 37.0+build2-0ubuntu0.14.04.1",
                     "Ubuntu 12.04": "firefox - 37.0+build2-0ubuntu0.12.04.1"

                 }

            },
            "mozilla_information": {
              "advisory_id": "2015-39",
               "reporter": "Nils",
               "impact": "Critical",
               "fixed_in": [
                 "Firefox 37",
                 "SeaMonkey 2.35"
               ],
                "description": "Security researcher Nils used the Address Sanitizer tool to discover two type confusion flaws. The first of these occurs while setting specific attributes of a source element resulting in incorrect object casting. The second flaw occurs when binding a source to a tree when the function fails to validate the namespace. These flaws lead to use-after-free errors, resulting in potentially exploitable crashes.",
                "references": [
                   "Type confusion in HTMLSourceElement::AfterSetAttr (CVE-2015-0803)",
                   "Type confusion in HTMLSourceElement::BindToTree (CVE-2015-0804)"
                  ]
            },
            "mozilla_bugzilla_information": {
              "bug_id": "1134560",
                 "summary": "Type confusion in HTMLSourceElement::BindToTree",
                  "categories": "Core :: DOM: Core & HTML",
                   "type": "defect",
                     "keywords": [
                        "reporter-external",
                        "sec-critical"
                    ],
                     "whiteboard": "[adv-main37+]",
                      "resolution": "FIXED",
                      "tracking_flags":{
                           "firefox36": "wontfix",
                            "firefox37": "fixed",
                             "firefox38": "fixed",
                             "firefox39": "fixed",
                             "firefox-esr31": "unaffected",
                             "b2g-v1.4": "unaffected",
                             "b2g-v2.0": "unaffected",
                             "b2g-v2.0M": "unaffected",
                             "b2g-v2.1": "disabled",
                             "b2g-v2.1S": "disabled",
                             "b2g-v2.2": "disabled",
                             "b2g-master": "fixed"
                       },
                         "people": {
                             "reporter": "nils",
                            "assigned": "longsonr"
                         },
                         "references": [
                            "Depends on: CVE-2015-0803",
                             "Blocks: 1134280"
                         ],
                       "description_details": "When binding a <source> element to a tree the functions checks for any siblings of the type <img>. It fails to validate the namespace and only checks for the tag name: if (aParent && aParent->IsNodeOfType(nsINode::eMEDIA)) { HTMLMediaElement* media = static_cast<HTMLMediaElement*>(aParent); media->NotifyAddedSource(); } else if (aParent && aParent->Tag() == nsGkAtoms::picture) { // Find any img siblings after this <source> and notify them nsCOMPtr<nsINode> sibling = AsContent(); while ( (sibling = sibling->GetNextSibling()) ) { if (sibling->Tag() == nsGkAtoms::img) { HTMLImageElement *img = static_cast<HTMLImageElement*>(sibling.get()); img->PictureSourceAdded(AsContent()); } } } This can result in a type confusion. See attached testcase which demonstrates the issue. ASan detects this issue as a use-after-free (output attached). This vulnerability can also be triggered on the stable release version of Firefox without <picture> being enabled as the check in the code only validates the tag name. The testcase on crashes on Windows accessing on mapped memory during garbage collection."
            }

    }
  }
}
```