=== Content from www.openwall.com_77ab57af_20250124_113648.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](9) [[next>]](11) [[<thread-prev]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20150410213841.D3FF26C000C@smtpvmsrv1.mitre.org>
Date: Fri, 10 Apr 2015 17:38:41 -0400 (EDT)
From: cve-assign@...re.org
To: admin@...bh.am
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request - NodeBB Persistent XSS through Markdown

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> Could I please get a CVE for a Persistent XSS flaw found in NodeBB versions
> < 0.70. The Github repository for this project can be found here:
> <https://github.com/NodeBB/NodeBB>.
>
> The vulnerability allows for an attacker to insert malicious links within
> forum posts and threads - that lead to the execution of attacker-defined
> JavaScript on click. This vulnerability not only affects NodeBB but also
> affects any project which uses the markdown-it project before 4.1.0.

We have done a limited amount of research on this, and currently feel
that the last sentence above doesn't precisely describe the situation.
Instead, we feel that there are two independent vulnerabilities.

> NodeBB -
> <https://github.com/julianlam/nodebb-plugin-markdown/commit/ab7f2684750882f7baefbfa31db8d5aac71e6ec3>

It appears that, in this single commit, NodeBB had both of these changes:

  1. the Markdown component was changed from remarkable to markdown-it

  2. a workaround was added for the markdown-it vulnerability involving
     data: URLs

Based on references such as:

  <https://www.reddit.com/r/javascript/comments/2qa0hp/markdown_parser_done_right_100_commonmark_support/>
  <http://stackoverflow.com/questions/1690601/markdown-and-xss>

we think the situation is:

  A. A possibly prevailing opinion is that there is no requirement
     that an implementation of the Markdown language have any
     functionality related to preventing XSS attacks. The rationale is
     that XSS prevention is arguably a responsibility of a code layer
     than occurs after Markdown is converted to HTML.

  B. remarkable is an implementation of the Markdown language that, by
     design, intentionally chose not to try to prevent XSS. Therefore,
     there cannot be a CVE ID for XSS in remarkable.

  C. markdown-it is another implementation of the Markdown language
     that has a substantial amount of code in common with remarkable.
     (For purposes of this CVE request, the reasons behind the similar
     and/or dissimilar code are not really relevant.)

  D. markdown-it made a choice to try to prevent some types of XSS
     attacks, e.g., by blocking javascript: URLs. This might be
     considered an advertised security property. Then, it was reported
     that roughly similar types of attacks with data: URLs were not
     prevented. This can be considered an incomplete list of dangerous
     protocols. The markdown-it maintainer made a commit that might be
     considered a required security update. Thus, it's at least
     plausible that an associated CVE should exist.

  E. The markdown-it maintainer also added a comment suggesting that
     XSS prevention was not intended to cover all cases ("This
     validator does not pretent to functionality of full weight
     sanitizers. It's a tradeoff between default security, simplicity
     and usability. If you need different setup - override validator
     method as you wish. Or replace it with dummy function and use
     external sanitizer."). This potentially can become a major
     complication for CVE assignment. Specifically, if the vendor is
     specifically documenting that XSS prevention is intentionally
     incomplete, we do not think that every future XSS report can have
     a CVE ID. This raises the question of: if there may not be CVE ID
     assignments in the future, is it actually useful to have a CVE ID
     assignment for the data: issue.

  F. Regardless of the status of markdown-it CVEs, there is a
     vulnerability in versions of NodeBB before
     ab7f2684750882f7baefbfa31db8d5aac71e6ec3, because these versions
     apparently omitted both of these:

     -- a Markdown language implementation that was capable of
        preventing XSS with either javascript: URLs or data: URLs

     -- a secondary code layer that was capable of preventing XSS with
        either javascript: URLs or data: URLs

Our decision, at least for now, is to have one CVE ID for D and one
CVE ID for F. Specifically:

  - item D

    fix: <https://github.com/markdown-it/markdown-it/commit/f76d3beb46abd121892a2e2e5c78376354c214e3>

    short description: an earlier version of markdown-it blocked
                       javascript: but not data:

    Use CVE-2015-3295. Note that this CVE is not applicable to any
    version of NodeBB. There was never a version of NodeBB that used
    markdown-it with javascript: blocking and no data: blocking.

  - item F

    fix: <https://github.com/julianlam/nodebb-plugin-markdown/commit/ab7f2684750882f7baefbfa31db8d5aac71e6ec3>

    short description: an earlier version of NodeBB had no
                       protection against either javascript: or data:
                       XSS attacks

    Use CVE-2015-3296.

It's possible that other NodeBB XSS issues will be reported in the
future, and will have other CVE IDs. NodeBB is ultimately responsible
for an XSS prevention strategy, regardless of whether it involves
incorporating different third-party HTML sanitization components or
their own unique code. In other words, we don't feel that the NodeBB
security policy could be "we block only the types of XSS attacks that
happen to be covered by markdown-it." At the moment, we have not heard
of any NodeBB XSS attack that isn't addressed by the
ab7f2684750882f7baefbfa31db8d5aac71e6ec3 patch.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJVKEGJAAoJEKllVAevmvms+FoH/R3yE8vdw8RIy2d9G/qSHvQo
bpL3W/U4a/gehD7j6VuDS1az5zbwBVBz/zC+k2QmsQf3PcdJqj/FJB1XOtIiQ8kS
5ln6wOuKWqai0tQFJwKnujX2erZEDlevrGxF+iF/FGm+91H+lWkk40iWfZ9C4Glz
bmc2HEKmmJhKNLSDjP1714peFJx8tfgJGo1u9Fxo1oo7JngMmEzINzG5U1C+tqCT
4iZPfFS8k3+OtcxNO6VdsOLvb6QfQapbndQ9DjseBX3LGWMxi1bImb2StzFkG6Hk
znb19grc2HgWjvQJ/ZC/lsYweNjfktgZKS8TDG7iHHZwOiGPoqV0VE+Pv3iqwmg=
=fP1z
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_fbf30390_20250124_113649.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkdown-it%2Fmarkdown-it%2Fcommit%2Ff76d3beb46abd121892a2e2e5c78376354c214e3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkdown-it%2Fmarkdown-it%2Fcommit%2Ff76d3beb46abd121892a2e2e5c78376354c214e3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=markdown-it%2Fmarkdown-it)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[markdown-it](/markdown-it)
/
**[markdown-it](/markdown-it/markdown-it)**
Public

* [Notifications](/login?return_to=%2Fmarkdown-it%2Fmarkdown-it) You must be signed in to change notification settings
* [Fork
  1.7k](/login?return_to=%2Fmarkdown-it%2Fmarkdown-it)
* [Star
   18.8k](/login?return_to=%2Fmarkdown-it%2Fmarkdown-it)

* [Code](/markdown-it/markdown-it)
* [Issues
  33](/markdown-it/markdown-it/issues)
* [Pull requests
  9](/markdown-it/markdown-it/pulls)
* [Actions](/markdown-it/markdown-it/actions)
* [Projects
  0](/markdown-it/markdown-it/projects)
* [Security](/markdown-it/markdown-it/security)
* [Insights](/markdown-it/markdown-it/pulse)

Additional navigation options

* [Code](/markdown-it/markdown-it)
* [Issues](/markdown-it/markdown-it/issues)
* [Pull requests](/markdown-it/markdown-it/pulls)
* [Actions](/markdown-it/markdown-it/actions)
* [Projects](/markdown-it/markdown-it/projects)
* [Security](/markdown-it/markdown-it/security)
* [Insights](/markdown-it/markdown-it/pulse)

## Commit

[Permalink](/markdown-it/markdown-it/commit/f76d3beb46abd121892a2e2e5c78376354c214e3)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Disabled data URIs (allow only some whitelisted images)

[Browse files](/markdown-it/markdown-it/tree/f76d3beb46abd121892a2e2e5c78376354c214e3)
Browse the repository at this point in the history

* Loading branch information

Vitaly Puzrin
committed
Mar 30, 2015

1 parent
[f7976b2](/markdown-it/markdown-it/commit/f7976b25f79df1599c98787e16873d52bd0b7d05)

commit f76d3be

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**41 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* lib

  + lib/index.js
    [index.js](#diff-92bbac9a308cd5fcf9db165841f2d90ce981baddcb2b1e26cfff170929af3bd1)
* test/fixtures/markdown-it

  + test/fixtures/markdown-it/xss.txt
    [xss.txt](#diff-49704efcb61e4163f7764a0a98e695a8f126db8bec1443142e8b51ceb1839749)

## There are no files selected for viewing

31 changes: 26 additions & 5 deletions

31
[lib/index.js](#diff-92bbac9a308cd5fcf9db165841f2d90ce981baddcb2b1e26cfff170929af3bd1 "lib/index.js")

Show comments

[View file](/markdown-it/markdown-it/blob/f76d3beb46abd121892a2e2e5c78376354c214e3/lib/index.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -20,20 +20,41 @@ var config = { |
|  |  | commonmark: require('./presets/commonmark') |
|  |  | }; |
|  |  |  |
|  |  |  |
|  |  | var BAD\_PROTOCOLS = [ 'vbscript', 'javascript', 'file' ]; |
|  |  | //////////////////////////////////////////////////////////////////////////////// |
|  |  | // |
|  |  | // This validator does not pretent to functionality of full weight sanitizers. |
|  |  | // It's a tradeoff between default security, simplicity and usability. |
|  |  | // If you need different setup - override validator method as you wish. Or |
|  |  | // replace it with dummy function and use external sanitizer. |
|  |  | // |
|  |  |  |
|  |  | var BAD\_PROTOCOLS = [ 'vbscript', 'javascript', 'file', 'data' ]; |
|  |  | var ALLOWED\_DATA\_MIMES = [ |
|  |  | 'data:image/gif', |
|  |  | 'data:image/png', |
|  |  | 'data:image/jpeg', |
|  |  | 'data:image/webp' |
|  |  | ]; |
|  |  |  |
|  |  | function validateLink(url) { |
|  |  | // url should be normalized at this point, and existing entities are decoded |
|  |  | // |
|  |  | var str = url.trim().toLowerCase(); |
|  |  |  |
|  |  | if (str.indexOf(':') >= 0 && BAD\_PROTOCOLS.indexOf(str.split(':')[0]) >= 0) { |
|  |  | var str = url.trim().toLowerCase(), |
|  |  | protocol = str.split(':')[0]; |
|  |  |  |
|  |  | if (str.indexOf(':') >= 0 && BAD\_PROTOCOLS.indexOf(protocol) >= 0) { |
|  |  | if (protocol === 'data' && ALLOWED\_DATA\_MIMES.indexOf(str.split(';')[0]) >= 0) { |
|  |  | return true; |
|  |  | } |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | //////////////////////////////////////////////////////////////////////////////// |
|  |  |  |
|  |  |  |
|  |  | var RECODE\_HOSTNAME\_FOR = [ 'http:', 'https:', 'mailto:' ]; |
|  |  |  |
|  |  | function normalizeLink(url) { |
| Expand Down | |  |

15 changes: 15 additions & 0 deletions

15
[test/fixtures/markdown-it/xss.txt](#diff-49704efcb61e4163f7764a0a98e695a8f126db8bec1443142e8b51ceb1839749 "test/fixtures/markdown-it/xss.txt")

Show comments

[View file](/markdown-it/markdown-it/blob/f76d3beb46abd121892a2e2e5c78376354c214e3/test/fixtures/markdown-it/xss.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -53,6 +53,21 @@ Should not allow some protocols in links and images |
|  |  | . |
|  |  |  |
|  |  |  |
|  |  | Should not allow data-uri except some whitelisted mimes |
|  |  | . |
|  |  | ![](data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7) |
|  |  | . |
|  |  | <p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt=""></p> |
|  |  | . |
|  |  |  |
|  |  | . |
|  |  | [xss link](data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K) |
|  |  | . |
|  |  | <p>[xss link](data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K)</p> |
|  |  | . |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  | Image parser use the same code base. |
|  |  | . |
|  |  | ![xss link](javascript:alert(1)) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f76d3be`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkdown-it%2Fmarkdown-it%2Fcommit%2Ff76d3beb46abd121892a2e2e5c78376354c214e3) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


