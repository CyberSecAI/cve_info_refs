```
{
  "CVE-2015-3222": {
    "Description": "The vulnerability exists in OSSEC versions 2.7 to 2.8.1 within the syscheck daemon, specifically in the 'report_changes' feature. This feature, designed to identify changes in monitored files, uses the system's 'diff' command via the system() function. The raw filename is passed as an argument to the 'diff' command, enabling an attacker to inject and execute arbitrary code with root privileges, because the syscheck daemon runs as root.",
    "Root cause": "The vulnerability stems from the insecure use of the system() function to execute the 'diff' command with user-supplied filenames, which are not properly sanitized.",
    "Weaknesses": [
      "Improper input sanitization",
      "Use of system() function with unsanitized input",
      "Privilege escalation"
    ],
    "Impact": "An attacker can achieve arbitrary code execution with root privileges. This allows for full system compromise.",
    "Attack vectors": "The attack vector involves creating a specially crafted file with shell commands embedded in its name. When 'report_changes' runs diff on this file, the embedded commands are executed with root privileges.",
    "Required attacker capabilities/position": "The attacker must be able to create files in directories monitored by OSSEC's syscheck daemon, and the 'report_changes' option must be enabled for these directories. The attacker does not need to be root."
  }
}
```