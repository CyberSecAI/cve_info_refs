=== Content from bugzilla.redhat.com_9d982946_20250126_061522.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3DCVE-2015-3146)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3DCVE-2015-3146)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3DCVE-2015-3146)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1213775

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1213775**](show_bug.cgi?id=1213775)
(CVE-2015-3146)
- [CVE-2015-3146](https://access.redhat.com/security/cve/CVE-2015-3146) libssh: null pointer dereference due to a logical error in the handling of a SSH\_MSG\_NEWKEYS and KEXDH\_REPLY packets

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2015-3146 libssh: null pointer dereference due to a logical error in the ...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2015-3146 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1214622](show_bug.cgi?id=1214622) [1218076](show_bug.cgi?id=1218076 "CLOSED ERRATA - CVE-2015-3146 libssh: null pointer dereference due to a logical error in the handling of a SSH_MSG_NEWKEYS and KEXDH_REPLY packets [fedora-all]") [1218077](show_bug.cgi?id=1218077 "CLOSED ERRATA - CVE-2015-3146 libssh: null pointer dereference due to a logical error in the handling of a SSH_MSG_NEWKEYS and KEXDH_REPLY packets [epel-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1213779](show_bug.cgi?id=1213779) | | TreeView+ | [depends on](buglist.cgi?bug_id=1213775&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1213775&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2015-04-21 09:24 UTC by Vasyl Kaigorodov | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2023-05-12 08:58 UTC ([History](show_activity.cgi?id=1213775)) | | [CC List:](page.cgi?id=fields.html#cclist) | 6 users (show)  asn carnil fweimer jrusnack security-response-team stefw | | Fixed In Version: | libssh 0.6.5 | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2015-05-28 10:54:49 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**Suggested patch**](attachment.cgi?id=1016896 "View the content of the attachment") (3.36 KB, text/plain)  [2015-04-21 13:58 UTC](#attach_1016896 "Go to the comment associated with the attachment"), Vasyl Kaigorodov | *no flags* | [Details](attachment.cgi?id=1016896&action=edit) | | [Show Obsolete](#a0) (1) [View All](attachment.cgi?bugid=1213775&action=viewall&hide_obsolete=1) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1213775#c0)  Vasyl Kaigorodov    2015-04-21 09:24:38 UTC  ``` libssh versions 0.5.1 and above have a logical error in the handling of a SSH_MSG_NEWKEYS and SSH_MSG_KEXDH_REPLY package. A detected error did not set the session into the error state correctly and further processed the packet which leads to a null pointer dereference. This is the packet after the initial key exchange and doesn't require authentication.  Both client and server are are vulnerable, pre-authentication and pre-crypto and and can be explointed with a MITM attack. This could be used for a Denial of Service (DoS) attack.  Acknowledgements:  Red Hat would like to thank the libssh team for reporting this issue. The libssh team acknowledges Mariusz Ziulek from the Open Web Application Security Project (OWASP) as the original reporter.   ```  [Comment 2](show_bug.cgi?id=1213775#c2)  Vasyl Kaigorodov    2015-04-21 13:58:05 UTC  ``` Created [attachment 1016896](attachment.cgi?id=1016896 "Suggested patch") [[details]](attachment.cgi?id=1016896&action=edit "Suggested patch") Suggested patch   ```  [Comment 3](show_bug.cgi?id=1213775#c3)  Stef Walter    2015-04-21 14:46:21 UTC  ``` The former patch applies to libssh 0.6.4 cleanly. The latter patch does not (perhaps against a different 0.6.x).  Brew build for RHEL 7: <https://brewweb.devel.redhat.com/taskinfo?taskID=9017188>   ```  [Comment 10](show_bug.cgi?id=1213775#c10)  Andreas Schneider    2015-04-30 14:06:33 UTC  ``` libssh 0.6.5 has been released to address the issue!  <https://www.libssh.org/2015/04/30/libssh-0-6-5-security-and-bugfix-release/>   ```  [Comment 11](show_bug.cgi?id=1213775#c11)  Martin Prpič    2015-05-04 07:55:31 UTC  ``` External References:  <https://www.libssh.org/2015/04/30/libssh-0-6-5-security-and-bugfix-release/>   ```  [Comment 12](show_bug.cgi?id=1213775#c12)  Martin Prpič    2015-05-04 07:56:10 UTC  ```  Created libssh tracking bugs for this issue:  Affects: fedora-all [[bug 1218076](show_bug.cgi?id=1218076 "CLOSED ERRATA - CVE-2015-3146 libssh: null pointer dereference due to a logical error in the handling of a SSH_MSG_NEWKEYS and KEXDH_REPLY packets [fedora-all]")] Affects: epel-all [[bug 1218077](show_bug.cgi?id=1218077 "CLOSED ERRATA - CVE-2015-3146 libssh: null pointer dereference due to a logical error in the handling of a SSH_MSG_NEWKEYS and KEXDH_REPLY packets [epel-all]")]   ```  [Comment 13](show_bug.cgi?id=1213775#c13)  Fedora Update System    2015-05-14 11:15:45 UTC  ``` libssh-0.6.5-1.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 14](show_bug.cgi?id=1213775#c14)  Fedora Update System    2015-05-21 05:12:27 UTC  ``` libssh-0.6.5-1.el7 has been pushed to the Fedora EPEL 7 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 15](show_bug.cgi?id=1213775#c15)  Fedora Update System    2015-05-26 21:27:07 UTC  ``` libssh-0.5.5-4.el6 has been pushed to the Fedora EPEL 6 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 16](show_bug.cgi?id=1213775#c16)  Fedora Update System    2015-07-14 15:28:48 UTC  ``` libssh-0.7.1-1.fc22 has been pushed to the Fedora 22 stable repository.  If problems still persist, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1213775&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.libssh.org_d0095a07_20250125_051706.html ===
=======================================================================
== Subject: Null pointer dereference in NEWKEYS + KEXDH\_REPLY packet
==
== CVE ID#: CVE-2015-3146
==
== Versions: All versions of libssh later than 0.5.1
==
== Summary: A malicious SSH\_MSG\_NEWKEYS or SSH\_MSG\_KEXDH\_REPLY
== packet could lead to a null pointer dereference crashing
== the server or client.
==
== This doesn't require any authentication.
==
=======================================================================
===========
Description
===========
libssh versions 0.5.1 and above have a logical error in the handling of a
SSH\_MSG\_NEWKEYS and SSH\_MSG\_KEXDH\_REPLY package. A detected error did not set
the session into the error state correctly and further processed the packet
which leads to a null pointer dereference. This is the packet after the initial
key exchange and doesn't require authentication.
Both client and server are are vulnerable, pre-authentication and pre-crypto
and and can be explointed with a MITM attack. This could be used for a
Denial of Service (DoS) attack.
The bug was found and reported by Mariusz Ziulek from the Open Web Application
Security Project (OWASP).
==================
Patch Availability
==================
Patches addressing the issue have been posted to:
https://www.libssh.org/
libssh versions 0.6.5 has been released to address this issue.
==========
Workaround
==========
None.
=======
Credits
=======
This problem has been found and reported by Mariusz Ziulek from the
Open Web Application Security Project (OWASP).
Patches provided by the libssh Team.
==========================================================
== The libssh Team
==========================================================


=== Content from launchpad.net_ad375936_20250126_061520.html ===

[Log in / Register](https://launchpad.net/ubuntu/%2Bsource/libssh/0.5.2-1ubuntu0.12.04.6/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[libssh package](https://launchpad.net/ubuntu/%2Bsource/libssh)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/libssh)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/libssh)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/libssh)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/libssh)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/libssh)

# libssh 0.5.2-1ubuntu0.12.04.6 source package in Ubuntu

## Changelog

```
libssh (0.5.2-1ubuntu0.12.04.6) precise-security; urgency=medium

  * SECURITY UPDATE: denial of service via incorrect SSH_MSG_NEWKEYS and
    KEXDH_REPLY packet handling
    - debian/patches/CVE-2015-3146.patch: fix state validation in
      src/client.c, src/server.c, src/buffer.c.
    - CVE-2015-3146
  * SECURITY UPDATE: weakness in diffie-hellman secret key generation
    - debian/patches/CVE-2016-0739.patch: fix bits/bytes confusion bug in
      src/dh.c.
    - CVE-2016-0739

 -- Marc Deslauriers <email address hidden>  Tue, 23 Feb 2016 07:36:38 -0500
```

## Upload details

Uploaded by:
[Marc Deslauriers](/~mdeslaur)
on 2016-02-23

Uploaded to:
[Precise](/ubuntu/precise)

Original maintainer:
[Ubuntu Developers](/~ubuntu-devel-discuss-lists)

Architectures:
any all

Section:
libs

Urgency:
Medium Urgency

## [See full publishing history](%2Bpublishinghistory) Publishing

| Series | Pocket | Published | Component | Section |
| --- | --- | --- | --- | --- |
| [Precise](/ubuntu/precise) | updates | on 2016-02-23 | main | libs |
| [Precise](/ubuntu/precise) | security | on 2016-02-23 | main | libs |

## Builds

[Precise](/ubuntu/precise):
![[FULLYBUILT]](/@@/build-success "Successfully built")
[amd64](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/9053172)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[armel](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/9053173)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[armhf](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/9053174)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[i386](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/9053175)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[powerpc](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/9053176)

## Downloads

| File | Size | SHA-256 Checksum |
| --- | --- | --- |
| [libssh\_0.5.2.orig.tar.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/libssh/0.5.2-1ubuntu0.12.04.6/libssh_0.5.2.orig.tar.gz) | 309.9 KiB | 41e8b9c1af077544625e8b398582f101dacc3b8457fee1811a724ca4245ab227 |
| [libssh\_0.5.2-1ubuntu0.12.04.6.debian.tar.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/libssh/0.5.2-1ubuntu0.12.04.6/libssh_0.5.2-1ubuntu0.12.04.6.debian.tar.gz) | 15.1 KiB | 58574e28e3349c029b3bb35035eb5b6b90c850d874b92e7e1eb77eae7d50ab14 |
| [libssh\_0.5.2-1ubuntu0.12.04.6.dsc](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/libssh/0.5.2-1ubuntu0.12.04.6/libssh_0.5.2-1ubuntu0.12.04.6.dsc) | 2.1 KiB | 773dd237ab13b45af409f3447697311f78f0756bad8947a2a6e1cd76c11346d3 |

### Available diffs

* [diff from 0.5.2-1ubuntu0.12.04.4 to 0.5.2-1ubuntu0.12.04.6](http://launchpadlibrarian.net/242212979/libssh_0.5.2-1ubuntu0.12.04.4_0.5.2-1ubuntu0.12.04.6.diff.gz) (1.8 KiB)
* [diff from 0.5.2-1ubuntu0.12.04.5 to 0.5.2-1ubuntu0.12.04.6](http://launchpadlibrarian.net/242089713/libssh_0.5.2-1ubuntu0.12.04.5_0.5.2-1ubuntu0.12.04.6.diff.gz) (1.6 KiB)

[View changes file](http://launchpadlibrarian.net/242078825/libssh_0.5.2-1ubuntu0.12.04.6_source.changes)

## Binary packages built by this source

[libssh-4](/ubuntu/precise/%2Bpackage/libssh-4):
tiny C SSH library

The ssh library was designed to be used by programmers needing a working SSH

 implementation by the mean of a library. The complete control of the client

 is made by the programmer. With libssh, you can remotely execute programs,

 transfer files, use a secure and transparent tunnel for your remote programs.

 With its SFTP implementation, you can play with remote files easily.

[libssh-4-dbgsym](/ubuntu/precise/%2Bpackage/libssh-4-dbgsym):
debug symbols for package libssh-4

The ssh library was designed to be used by programmers needing a working SSH

 implementation by the mean of a library. The complete control of the client

 is made by the programmer. With libssh, you can remotely execute programs,

 transfer files, use a secure and transparent tunnel for your remote programs.

 With its SFTP implementation, you can play with remote files easily.

[libssh-dbg](/ubuntu/precise/%2Bpackage/libssh-dbg):
tiny C SSH library. Debug symbols

The ssh library was designed to be used by programmers needing a working SSH

 implementation by the mean of a library. The complete control of the client

 is made by the programmer. With libssh, you can remotely execute programs,

 transfer files, use a secure and transparent tunnel for your remote programs.

 With its SFTP implementation, you can play with remote files easily.

 .

 This package contains debug symbols.

[libssh-dev](/ubuntu/precise/%2Bpackage/libssh-dev):
tiny C SSH library. Development files

The ssh library was designed to be used by programmers needing a working SSH

 implementation by the mean of a library. The complete control of the client

 is made by the programmer. With libssh, you can remotely execute programs,

 transfer files, use a secure and transparent tunnel for your remote programs.

 With its SFTP implementation, you can play with remote files easily.

 .

 This package contains development files.

[libssh-doc](/ubuntu/precise/%2Bpackage/libssh-doc):
tiny C SSH library. Documentation files

The ssh library was designed to be used by programmers needing a working SSH

 implementation by the mean of a library. The complete control of the client

 is made by the programmer. With libssh, you can remotely execute programs,

 transfer files, use a secure and transparent tunnel for your remote programs.

 With its SFTP implementation, you can play with remote files easily.

 .

 This package contains documentation files.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.ubuntu.com_4aca9cac_20250125_051704.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-2912-1: libssh vulnerabilities

23 February 2016

Several security issues were fixed in libssh.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 15.10](/security/notices?release=wily)
* [Ubuntu 14.04 ESM](/security/notices?release=trusty)
* [Ubuntu 12.04](/security/notices?release=precise)

## Packages

* [libssh](/security/cves?package=libssh) - A tiny C SSH library

## Details

Mariusz Ziulek discovered that libssh incorrectly handled certain packets.

A remote attacker could possibly use this issue to cause libssh to crash,

resulting in a denial of service.

([CVE-2015-3146](/security/CVE-2015-3146))

Aris Adamantiadis discovered that libssh incorrectly generated ephemeral

secret keys of 128 bits instead of the recommended 1024 or 2048 bits when

using the diffie-hellman-group1 and diffie-hellman-group14 methods. If a

remote attacker were able to perform a machine-in-the-middle attack, this flaw

could be exploited to view sensitive information. ([CVE-2016-0739](/security/CVE-2016-0739))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 15.10

* [libssh-4](https://launchpad.net/ubuntu/%2Bsource/libssh)
  -
  [0.6.3-3ubuntu3.2](https://launchpad.net/ubuntu/%2Bsource/libssh/0.6.3-3ubuntu3.2)

##### Ubuntu 14.04

* [libssh-4](https://launchpad.net/ubuntu/%2Bsource/libssh)
  -
  [0.6.1-0ubuntu3.3](https://launchpad.net/ubuntu/%2Bsource/libssh/0.6.1-0ubuntu3.3)

##### Ubuntu 12.04

* [libssh-4](https://launchpad.net/ubuntu/%2Bsource/libssh)
  -
  [0.5.2-1ubuntu0.12.04.6](https://launchpad.net/ubuntu/%2Bsource/libssh/0.5.2-1ubuntu0.12.04.6)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2015-3146](/security/CVE-2015-3146)
* [CVE-2016-0739](/security/CVE-2016-0739)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from www.libssh.org_09f94a49_20250125_051706.html ===

[Skip to content](#content)
[![Back Home](https://www.libssh.org/wp-content/uploads/2015/01/libssh1.png)](https://www.libssh.org/)

The SSH Library!

* [Features](https://www.libssh.org/features/)
* [Download](https://www.libssh.org/get-it/)
* [Communication](https://www.libssh.org/communication/)
* [Development](https://www.libssh.org/development/)
  + [Report a bug](https://www.libssh.org/development/report-a-bug/)
  + [Report a security bug](https://www.libssh.org/development/report-a-security-bug/)
  + [Security Process](https://www.libssh.org/development/security-process/)
  + [Security bug bounty](https://www.libssh.org/development/security-bug-bounty/)
  + [Google Summer of Code](https://www.libssh.org/development/google-summer-of-code/)
* [Imprint](https://www.libssh.org/imprint/)

* Search
  Search

  Search …

[![Back Home](https://www.libssh.org/wp-content/uploads/2015/01/libssh1.png)](https://www.libssh.org/)

The SSH Library!

* Search
  Search

  Search …

  + Search

    Search …
* Menu

* [Features](https://www.libssh.org/features/)
* [Download](https://www.libssh.org/get-it/)
* [Communication](https://www.libssh.org/communication/)
* [Development](https://www.libssh.org/development/)
  + [Report a bug](https://www.libssh.org/development/report-a-bug/)
  + [Report a security bug](https://www.libssh.org/development/report-a-security-bug/)
  + [Security Process](https://www.libssh.org/development/security-process/)
  + [Security bug bounty](https://www.libssh.org/development/security-bug-bounty/)
  + [Google Summer of Code](https://www.libssh.org/development/google-summer-of-code/)
* [Imprint](https://www.libssh.org/imprint/)

 [Release](https://www.libssh.org/category/release/ "View all posts in Release")
# libssh 0.6.5 (Security and bugfix release)

by [Andreas](https://www.libssh.org/author/asn/ "View all posts by Andreas")|Published [April 30, 2015](https://www.libssh.org/2015/04/30/ "16:12")

This is an important SECURITY and maintenance release in order to address [CVE-2015-3146 – Possible double free on a dangling pointer with crafted kexinit packet](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-3146).

libssh versions 0.5.1 and above have a logical error in the handling of a SSH\_MSG\_NEWKEYS and SSH\_MSG\_KEXDH\_REPLY package. A detected error did not set the session into the error state correctly and further processed the packet which leads to a null pointer dereference. This is the packet after the initial key exchange and doesn’t require authentication.

This could be used for a Denial of Service (DoS) attack.

The bug was found and reported by Mariusz Ziulek from the Open Web Application Security Project (OWASP).

Advisories and patches for older versions can be found [here](https://www.libssh.org/security/).

If you are new to libssh read [The Tutorial](http://api.libssh.org/stable/libssh_tutorial.html) how to get started. Please [join our mailing list](http://www.libssh.org/communication/) or visit our IRC channel if you have questions.

You can download libssh 0.6.5 [here](https://red.libssh.org/projects/libssh/files).

## ChangeLog

* Fixed CVE-2015-3146
* Fixed port handling in config file
* Fixed the build with libgcrypt
* Fixed SFTP endian issues (rlo #179)
* Fixed uninitilized sig variable (rlo #167)
* Fixed polling issues which could result in a hang
* Fixed handling of EINTR in ssh\_poll() (rlo #186)
* Fixed C99 issues with \_\_func\_\_
* Fixed some memory leaks
* Improved macro detection on Windows

### You may also like

![libssh 0.9.4 and libssh 0.8.9 security release](https://www.libssh.org/wp-content/themes/customizr-pro/assets/front/img/thumb-standard-empty.png)

Published [April 9, 2020](https://www.libssh.org/2020/04/09/libssh-0-9-4-and-libssh-0-8-9-security-release/ "Permalink to: libssh 0.9.4 and libssh 0.8.9 security release")
## [libssh 0.9.4 and libssh 0.8.9 security release](https://www.libssh.org/2020/04/09/libssh-0-9-4-and-libssh-0-8-9-security-release/)

This is a security release of libssh to address CVE-2020-1730 (moderate impact), a possible Denial of Service (DoS) in client and server […]

![libssh 0.6.4 (Security and bugfix release)](https://www.libssh.org/wp-content/themes/customizr-pro/assets/front/img/thumb-standard-empty.png)

Published [December 19, 2014](https://www.libssh.org/2014/12/19/libssh-0-6-4-security-and-bugfix-release/ "Permalink to: libssh 0.6.4 (Security and bugfix release)")
## [libssh 0.6.4 (Security and bugfix release)](https://www.libssh.org/2014/12/19/libssh-0-6-4-security-and-bugfix-release/)

This is an important SECURITY and maintenance release in order to address CVE-2014-8132 – Double free on dangling pointers in initial key […]

![libssh 0.5.0](https://www.libssh.org/wp-content/themes/customizr-pro/assets/front/img/thumb-standard-empty.png)

Published [June 1, 2011](https://www.libssh.org/2011/06/01/libssh-0-5-0/ "Permalink to: libssh 0.5.0")
## [libssh 0.5.0](https://www.libssh.org/2011/06/01/libssh-0-5-0/)

We are proud to finally announce libssh in version 0.5. It took a lot of time to get this version stable and […]

![libssh 0.4.3](https://www.libssh.org/wp-content/themes/customizr-pro/assets/front/img/thumb-standard-empty.png)

Published [May 18, 2010](https://www.libssh.org/2010/05/18/libssh-0-4-3/ "Permalink to: libssh 0.4.3")
## [libssh 0.4.3](https://www.libssh.org/2010/05/18/libssh-0-4-3/)

This is a new libssh release which fixes important bugs and adds some nice new features. We have rewritten the poll(2)-emulation and […]

Search

Search …

### Tag Cloud

[AES-GCM](https://www.libssh.org/tag/aes-gcm/)
[bugfix](https://www.libssh.org/tag/bugfix/)
[cve](https://www.libssh.org/tag/cve/)
[ed25519](https://www.libssh.org/tag/ed25519/)
[ETM](https://www.libssh.org/tag/etm/)
[FIPS](https://www.libssh.org/tag/fips/)
[gsoc](https://www.libssh.org/tag/gsoc/)
[gssapi](https://www.libssh.org/tag/gssapi/)
[gssproxy](https://www.libssh.org/tag/gssproxy/)
[KDF](https://www.libssh.org/tag/kdf/)
[Release](https://www.libssh.org/tag/release/)
[security](https://www.libssh.org/tag/security/)
[sftp](https://www.libssh.org/tag/sftp/)
[sha2](https://www.libssh.org/tag/sha2/)

## Post navigation

* Previous post
  [Bug tracker and Downloads are working again](https://www.libssh.org/2015/04/02/bug-tracker-and-downloads-are-working-again/)
* [Back to post list](https://www.libssh.org/ "Back to post list")
* Next post
  [libssh 0.7.0](https://www.libssh.org/2015/05/11/libssh-0-7-0/)

##### Projects using libssh …

[![KDE](https://www.libssh.org/wp-content/uploads/2015/01/KDE_Logo.png)](http://www.kde.org/) KDE uses libssh to implement the sftp module to allow secure file transfers between different computers.

##### GitHub

[![GitHub](https://www.libssh.org/wp-content/uploads/2015/01/GitHub_Octocat.png)](https://github.com/) GitHub uses libssh in production to power its git SSH infrastructure, serving millions of requests daily.

##### Cockpit

[![Cockpit](https://www.libssh.org/logo/cockpit-logo.png)](https://cockpit-project.org/)Cockpit uses libssh for SSH public key authentication and to administer multiple machine using one bastion host.

© 2025
[libssh](https://www.libssh.org "libssh") –
All rights reserved - The libssh logo has been created by [Robert Lihm](http://lihm.de/)

Designed with
[Customizr Pro](https://presscustomizr.com/customizr-pro "Customizr Pro")



=== Content from www.debian.org_8348a8a0_20250125_051703.html ===


---

[[Date Prev](msg00057.html)][[Date Next](msg00059.html)]
[[Thread Prev](msg00057.html)][[Thread Next](msg00059.html)]
[[Date Index](maillist.html#00058)]
[[Thread Index](threads.html#00058)]

# [SECURITY] [DSA 3488-1] libssh security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3488-1] libssh security update
* *From*: Salvatore Bonaccorso <carnil@debian.org>
* *Date*: Tue, 23 Feb 2016 16:37:38 +0000
* *Message-id*: <[[🔎]](/msgid-search/E1aYFxy-0003GX-32%40master.debian.org) [E1aYFxy-0003GX-32@master.debian.org](msg00058.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3488-1                   security@debian.org
<https://www.debian.org/security/>                     Salvatore Bonaccorso
February 23, 2016                     <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : libssh
CVE ID         : CVE-2016-0739
Debian Bug     : 815663

Aris Adamantiadis discovered that libssh, a tiny C SSH library,
incorrectly generated a short ephemeral secret for the
diffie-hellman-group1 and diffie-hellman-group14 key exchange methods.
The resulting secret is 128 bits long, instead of the recommended sizes
of 1024 and 2048 bits respectively. This flaw could allow an
eavesdropper with enough resources to decrypt or intercept SSH sessions.

For the oldstable distribution (wheezy), this problem has been fixed in
version 0.5.4-1+deb7u3. This update also includes fixes for
CVE-2014-8132 and CVE-2015-3146, which were previously scheduled for the
next wheezy point release.

For the stable distribution (jessie), this problem has been fixed in
version 0.6.3-4+deb8u2.

We recommend that you upgrade your libssh packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCgAGBQJWzIqnAAoJEAVMuPMTQ89E2MYP/1R6FfgJqP6LNxmk9jmb2Uz6
CSgrEiET/9m8NIV/3f5HP9L8Cwm81MLAZ7MsIQKHzmMBiFs/RW5iMGbQQAE/J5Tx
EkhgngcoA2dgWh/5J0nOaFZJ+XuihKUKYqHxsZRBMNW+YULcE9PT+WsjfBqov49m
FOfwNSlkochCmaWIYTlhL6NbhU3KWjhiG80w/EH8u8T6HZnNo2DbzlR8qizsJ+qj
6d3gGGwbANWdNB+B/9P4iohgsfPoEPjo1yoipKFuw3SJBOeWHxHnFbHfK4U8UJ/f
cI4faiLNAp/pR2peGpL6Ipl7fBsUgnIoycBKJeR9qrCe+GsM61zmGaWWERIsvgPc
t07PVVm/c1CNYuFmT6NEak6UdleOg8gNHAoVq1PnL+CaUgngFFbLeWO2teWg2MLF
L9DasjwRaRB8Wr1fQleX2njH9v6PYwxBYkKXguAY2CG3aUSr64iJL8lbHqB9MA1f
BSYGYuKKQUDY1AVJXa0FJaKJhS9NME3KdgGJbItTrf0dbWNx8TJYVb7K+1G8MDVW
KXxHSacszpIJaP5/4+SDWLewd6RSvrO/rGh3/md4YZo7OmDthrLKU4lDQ3PKbFAb
Nb9wBymWe2JT4SvofexHLtr24bYMg16M0PzQKmqzETd6WGjMv5OkYRkUU5TzWIXo
KxbOPS/xcIXBN1s/9Xx+
=30hF
-----END PGP SIGNATURE-----

```

---



=== Content from git.libssh.org_7f696b15_20250125_051705.html ===


| [cgit logo](/) | [index](/) : [projects/libssh.git](/projects/libssh.git/ "projects/libssh.git") | master master-fix stable-0.10 stable-0.11 stable-0.8 stable-0.9 v0-2 v0-3 v0-4 v0-5 v0-6 v0-7 |
| --- | --- | --- |
| libssh shared repository | libssh git server |

| [about](/projects/libssh.git/about/?h=libssh-0.6.5)[summary](/projects/libssh.git/?h=libssh-0.6.5)[refs](/projects/libssh.git/refs/?h=libssh-0.6.5&id=94f6955fbaee6fda9385a23e505497efe21f5b4f)[log](/projects/libssh.git/log/?h=libssh-0.6.5)[tree](/projects/libssh.git/tree/?h=libssh-0.6.5&id=94f6955fbaee6fda9385a23e505497efe21f5b4f)[commit](/projects/libssh.git/commit/?h=libssh-0.6.5&id=94f6955fbaee6fda9385a23e505497efe21f5b4f)[diff](/projects/libssh.git/diff/?h=libssh-0.6.5&id=94f6955fbaee6fda9385a23e505497efe21f5b4f) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Aris Adamantiadis <aris@0xbadc0de.be> | 2015-04-15 16:08:37 +0200 |
| --- | --- | --- |
| committer | Andreas Schneider <asn@cryptomilk.org> | 2015-04-23 10:34:12 +0200 |
| commit | [94f6955fbaee6fda9385a23e505497efe21f5b4f](/projects/libssh.git/commit/?h=libssh-0.6.5&id=94f6955fbaee6fda9385a23e505497efe21f5b4f) ([patch](/projects/libssh.git/patch/?id=94f6955fbaee6fda9385a23e505497efe21f5b4f)) | |
| tree | [8b6690bb098619050e3216f3842f3fa0aabfe284](/projects/libssh.git/tree/?h=libssh-0.6.5&id=94f6955fbaee6fda9385a23e505497efe21f5b4f) | |
| parent | [d2a990a68ea555d7003edc94eb076356604facea](/projects/libssh.git/commit/?h=libssh-0.6.5&id=d2a990a68ea555d7003edc94eb076356604facea) ([diff](/projects/libssh.git/diff/?h=libssh-0.6.5&id=94f6955fbaee6fda9385a23e505497efe21f5b4f&id2=d2a990a68ea555d7003edc94eb076356604facea)) | |
| download | [libssh-94f6955fbaee6fda9385a23e505497efe21f5b4f.tar.gz](/projects/libssh.git/snapshot/libssh-94f6955fbaee6fda9385a23e505497efe21f5b4f.tar.gz)[libssh-94f6955fbaee6fda9385a23e505497efe21f5b4f.tar.xz](/projects/libssh.git/snapshot/libssh-94f6955fbaee6fda9385a23e505497efe21f5b4f.tar.xz)[libssh-94f6955fbaee6fda9385a23e505497efe21f5b4f.zip](/projects/libssh.git/snapshot/libssh-94f6955fbaee6fda9385a23e505497efe21f5b4f.zip) | |

CVE-2015-3146: Fix state validation in packet handlersThe state validation in the packet handlers for SSH\_MSG\_NEWKEYS and
SSH\_MSG\_KEXDH\_REPLY had a bug which did not raise an error.
The issue has been found and reported by Mariusz Ziule.
Signed-off-by: Aris Adamantiadis <aris@0xbadc0de.be>
Reviewed-by: Andreas Schneider <asn@cryptomilk.org>
(cherry picked from commit bf0c7ae0aeb0ebe661d11ea6785fff2cbf4f3dbe)
[Diffstat](/projects/libssh.git/diff/?h=libssh-0.6.5&id=94f6955fbaee6fda9385a23e505497efe21f5b4f)

| -rw-r--r-- | [src/packet\_cb.c](/projects/libssh.git/diff/src/packet_cb.c?h=libssh-0.6.5&id=94f6955fbaee6fda9385a23e505497efe21f5b4f) | 16 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [src/server.c](/projects/libssh.git/diff/src/server.c?h=libssh-0.6.5&id=94f6955fbaee6fda9385a23e505497efe21f5b4f) | 8 | |  |  |  | | --- | --- | --- | |

2 files changed, 15 insertions, 9 deletions

| diff --git a/src/packet\_cb.c b/src/packet\_cb.cindex a10dd1abb..e6c613fdb 100644--- a/[src/packet\_cb.c](/projects/libssh.git/tree/src/packet_cb.c?h=libssh-0.6.5&id=d2a990a68ea555d7003edc94eb076356604facea)+++ b/[src/packet\_cb.c](/projects/libssh.git/tree/src/packet_cb.c?h=libssh-0.6.5&id=94f6955fbaee6fda9385a23e505497efe21f5b4f)@@ -94,7 +94,7 @@ SSH\_PACKET\_CALLBACK(ssh\_packet\_dh\_reply){ (void)type; (void)user; SSH\_LOG(SSH\_LOG\_PROTOCOL,"Received SSH\_KEXDH\_REPLY");- if(session->session\_state!= SSH\_SESSION\_STATE\_DH &&+ if (session->session\_state != SSH\_SESSION\_STATE\_DH || session->dh\_handshake\_state != DH\_STATE\_INIT\_SENT){ ssh\_set\_error(session,SSH\_FATAL,"ssh\_packet\_dh\_reply called in wrong state : %d:%d", session->session\_state,session->dh\_handshake\_state);@@ -135,12 +135,16 @@ SSH\_PACKET\_CALLBACK(ssh\_packet\_newkeys){ (void)user; (void)type; SSH\_LOG(SSH\_LOG\_PROTOCOL, "Received SSH\_MSG\_NEWKEYS");- if(session->session\_state!= SSH\_SESSION\_STATE\_DH &&- session->dh\_handshake\_state != DH\_STATE\_NEWKEYS\_SENT){- ssh\_set\_error(session,SSH\_FATAL,"ssh\_packet\_newkeys called in wrong state : %d:%d",- session->session\_state,session->dh\_handshake\_state);- goto error;++ if (session->session\_state != SSH\_SESSION\_STATE\_DH ||+ session->dh\_handshake\_state != DH\_STATE\_NEWKEYS\_SENT) {+ ssh\_set\_error(session,+ SSH\_FATAL,+ "ssh\_packet\_newkeys called in wrong state : %d:%d",+ session->session\_state,session->dh\_handshake\_state);+ goto error; }+ if(session->server){ /\* server things are done in server.c \*/ session->dh\_handshake\_state=DH\_STATE\_FINISHED;diff --git a/src/server.c b/src/server.cindex 35281caaf..1637cce86 100644--- a/[src/server.c](/projects/libssh.git/tree/src/server.c?h=libssh-0.6.5&id=d2a990a68ea555d7003edc94eb076356604facea)+++ b/[src/server.c](/projects/libssh.git/tree/src/server.c?h=libssh-0.6.5&id=94f6955fbaee6fda9385a23e505497efe21f5b4f)@@ -165,7 +165,7 @@ static int ssh\_server\_kexdh\_init(ssh\_session session, ssh\_buffer packet){ }  SSH\_PACKET\_CALLBACK(ssh\_packet\_kexdh\_init){- int rc;+ int rc = SSH\_ERROR; (void)type; (void)user; @@ -193,9 +193,11 @@ SSH\_PACKET\_CALLBACK(ssh\_packet\_kexdh\_init){ ssh\_set\_error(session,SSH\_FATAL,"Wrong kex type in ssh\_packet\_kexdh\_init"); rc = SSH\_ERROR; }- if (rc == SSH\_ERROR)++error:+ if (rc == SSH\_ERROR) { session->session\_state = SSH\_SESSION\_STATE\_ERROR;- error:+ }  return SSH\_PACKET\_USED; } |
| --- |

generated by [cgit v1.2.3](https://git.zx2c4.com/cgit/about/) ([git 2.25.1](https://git-scm.com/)) at 2025-01-25 05:17:05 +0000



=== Content from www.libssh.org_991db80a_20250126_061521.html ===

[Skip to content](#content)
[![Back Home](https://www.libssh.org/wp-content/uploads/2015/01/libssh1.png)](https://www.libssh.org/)

The SSH Library!

* [Features](https://www.libssh.org/features/)
* [Download](https://www.libssh.org/get-it/)
* [Communication](https://www.libssh.org/communication/)
* [Development](https://www.libssh.org/development/)
  + [Report a bug](https://www.libssh.org/development/report-a-bug/)
  + [Report a security bug](https://www.libssh.org/development/report-a-security-bug/)
  + [Security Process](https://www.libssh.org/development/security-process/)
  + [Security bug bounty](https://www.libssh.org/development/security-bug-bounty/)
  + [Google Summer of Code](https://www.libssh.org/development/google-summer-of-code/)
* [Imprint](https://www.libssh.org/imprint/)

* Search
  Search

  Search …

[![Back Home](https://www.libssh.org/wp-content/uploads/2015/01/libssh1.png)](https://www.libssh.org/)

The SSH Library!

* Search
  Search

  Search …

  + Search

    Search …
* Menu

* [Features](https://www.libssh.org/features/)
* [Download](https://www.libssh.org/get-it/)
* [Communication](https://www.libssh.org/communication/)
* [Development](https://www.libssh.org/development/)
  + [Report a bug](https://www.libssh.org/development/report-a-bug/)
  + [Report a security bug](https://www.libssh.org/development/report-a-security-bug/)
  + [Security Process](https://www.libssh.org/development/security-process/)
  + [Security bug bounty](https://www.libssh.org/development/security-bug-bounty/)
  + [Google Summer of Code](https://www.libssh.org/development/google-summer-of-code/)
* [Imprint](https://www.libssh.org/imprint/)

# Daily Archives: April 30, 2015

1 post

---

## [libssh 0.6.5 (Security and bugfix release)](https://www.libssh.org/2015/04/30/libssh-0-6-5-security-and-bugfix-release/)

 [Release](https://www.libssh.org/category/release/ "View all posts in Release")

This is an important SECURITY and maintenance release in order to address [CVE-2015-3146 – Possible double free on a dangling pointer with crafted kexinit packet](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-3146).

libssh versions 0.5.1 and above have a logical error in the handling of a SSH\_MSG\_NEWKEYS and SSH\_MSG\_KEXDH\_REPLY package. A detected error did not set the session into the error state correctly and further processed the packet which leads to a null pointer dereference. This is the packet after the initial key exchange and doesn’t require authentication.

This could be used for a Denial of Service (DoS) attack.

The bug was found and reported by Mariusz Ziulek from the Open Web Application Security Project (OWASP).

Advisories and patches for older versions can be found [here](https://www.libssh.org/security/).

If you are new to libssh read [The Tutorial](http://api.libssh.org/stable/libssh_tutorial.html) how to get started. Please [join our mailing list](http://www.libssh.org/communication/) or visit our IRC channel if you have questions.

You can download libssh 0.6.5 [here](https://red.libssh.org/projects/libssh/files).

## ChangeLog

* Fixed CVE-2015-3146
* Fixed port handling in config file
* Fixed the build with libgcrypt
* Fixed SFTP endian issues (rlo #179)
* Fixed uninitilized sig variable (rlo #167)
* Fixed polling issues which could result in a hang
* Fixed handling of EINTR in ssh\_poll() (rlo #186)
* Fixed C99 issues with \_\_func\_\_
* Fixed some memory leaks
* Improved macro detection on Windows

by ![](https://secure.gravatar.com/avatar/ff2f1e3c638391229f288e9449c387f3?s=48&d=mm&r=g)[Andreas](https://www.libssh.org/author/asn/ "View all posts by Andreas")
Published [April 30, 2015](https://www.libssh.org/2015/04/30/libssh-0-6-5-security-and-bugfix-release/ "Permalink to: libssh 0.6.5 (Security and bugfix release)")

Search

Search …

### Tag Cloud

[AES-GCM](https://www.libssh.org/tag/aes-gcm/)
[bugfix](https://www.libssh.org/tag/bugfix/)
[cve](https://www.libssh.org/tag/cve/)
[ed25519](https://www.libssh.org/tag/ed25519/)
[ETM](https://www.libssh.org/tag/etm/)
[FIPS](https://www.libssh.org/tag/fips/)
[gsoc](https://www.libssh.org/tag/gsoc/)
[gssapi](https://www.libssh.org/tag/gssapi/)
[gssproxy](https://www.libssh.org/tag/gssproxy/)
[KDF](https://www.libssh.org/tag/kdf/)
[Release](https://www.libssh.org/tag/release/)
[security](https://www.libssh.org/tag/security/)
[sftp](https://www.libssh.org/tag/sftp/)
[sha2](https://www.libssh.org/tag/sha2/)

##### Projects using libssh …

[![KDE](https://www.libssh.org/wp-content/uploads/2015/01/KDE_Logo.png)](http://www.kde.org/) KDE uses libssh to implement the sftp module to allow secure file transfers between different computers.

##### GitHub

[![GitHub](https://www.libssh.org/wp-content/uploads/2015/01/GitHub_Octocat.png)](https://github.com/) GitHub uses libssh in production to power its git SSH infrastructure, serving millions of requests daily.

##### Cockpit

[![Cockpit](https://www.libssh.org/logo/cockpit-logo.png)](https://cockpit-project.org/)Cockpit uses libssh for SSH public key authentication and to administer multiple machine using one bastion host.

© 2025
[libssh](https://www.libssh.org "libssh") –
All rights reserved - The libssh logo has been created by [Robert Lihm](http://lihm.de/)

Designed with
[Customizr Pro](https://presscustomizr.com/customizr-pro "Customizr Pro")



=== Content from lists.ubuntu.com_be8ed54b_20250126_061520.html ===


| **ubuntu-hardened -- Ubuntu security discussion** | |
| --- | --- |
|  | |
| **About ubuntu-hardened** | English (USA)   Chinese (Taiwan) |
| Discussion on Ubuntu security updates, development of new security technologies, and general "hardening" of the operating system.  A place to talk about MAC systems (SELinux, AppArmor, Smack) in Ubuntu, about both kernel-level and user-land security improvements and technologies, etc.  To see the collection of prior postings to the list, visit the [ubuntu-hardened Archives](https://lists.ubuntu.com/archives/ubuntu-hardened). | |
| **Using ubuntu-hardened** | |
| To post a message to all the list members, send email to ubuntu-hardened@lists.ubuntu.com. You can subscribe to the list, or change your existing subscription, in the sections below. | |
| **Subscribing to ubuntu-hardened** | |
| Subscribe to ubuntu-hardened by filling out the following form. You will be sent email requesting confirmation, to prevent others from gratuitously subscribing you. This is a hidden list, which means that the list of members is available only to the list administrator.    | Your email address: |  |  | | --- | --- | --- | | Your name (optional): |  |  | | You may enter a privacy password below. This provides only mild security, but should prevent others from messing with your subscription. **Do not use a valuable password** as it will occasionally be emailed back to you in cleartext. If you choose not to enter a password, one will be automatically generated for you, and it will be sent to you once you've confirmed your subscription. You can always request a mail-back of your password when you edit your personal options. | | | | Pick a password: |  |  | | Reenter password to confirm: |  |  | | Which language do you prefer to display your messages? | English (USA)   Chinese (Taiwan) |  | | Would you like to receive list mail batched in a daily digest? | No  Yes | |  | | | | |

| **ubuntu-hardened Subscribers** | |
| (*The subscribers list is only available to the list administrator.*) Enter your admin address and password to visit the subscribers list: Admin address: Password:  To unsubscribe from ubuntu-hardened, get a password reminder, or change your subscription options enter your subscription email address: If you leave the field blank, you will be prompted for your email address | |

---

[ubuntu-hardened](../listinfo/ubuntu-hardened) list run by jamie at ubuntu.com, mdeslaur at ubuntu.com, sbeattie at ubuntu.com, alex.murray at canonical.com
[ubuntu-hardened administrative interface](../admin/ubuntu-hardened) (requires authorization)
[Overview of all lists.ubuntu.com mailing lists](../listinfo)

| [Delivered by Mailmanversion 2.1.20](http://www.gnu.org/software/mailman/index.html) | [Python Powered](http://www.python.org/) | [GNU's Not Unix](http://www.gnu.org/) | [Debian Powered](http://www.debian.org/) |
| --- | --- | --- | --- |

[![](http://tuxedo-es.org/images/hardened_debian.png)](http://www.debian-hardened.org)


