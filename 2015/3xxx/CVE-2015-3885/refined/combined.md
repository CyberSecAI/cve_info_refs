=== Content from github.com_7c0e0506_20250126_004046.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLibRaw%2FLibRaw%2Fcommit%2F4606c28f494a750892c5c1ac7903e62dd1c6fdb5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLibRaw%2FLibRaw%2Fcommit%2F4606c28f494a750892c5c1ac7903e62dd1c6fdb5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=LibRaw%2FLibRaw)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[LibRaw](/LibRaw)
/
**[LibRaw](/LibRaw/LibRaw)**
Public

* [Notifications](/login?return_to=%2FLibRaw%2FLibRaw) You must be signed in to change notification settings
* [Fork
  289](/login?return_to=%2FLibRaw%2FLibRaw)
* [Star
   1.2k](/login?return_to=%2FLibRaw%2FLibRaw)

* [Code](/LibRaw/LibRaw)
* [Issues
  2](/LibRaw/LibRaw/issues)
* [Pull requests
  0](/LibRaw/LibRaw/pulls)
* [Actions](/LibRaw/LibRaw/actions)
* [Projects
  0](/LibRaw/LibRaw/projects)
* [Wiki](/LibRaw/LibRaw/wiki)
* [Security](/LibRaw/LibRaw/security)
* [Insights](/LibRaw/LibRaw/pulse)

Additional navigation options

* [Code](/LibRaw/LibRaw)
* [Issues](/LibRaw/LibRaw/issues)
* [Pull requests](/LibRaw/LibRaw/pulls)
* [Actions](/LibRaw/LibRaw/actions)
* [Projects](/LibRaw/LibRaw/projects)
* [Wiki](/LibRaw/LibRaw/wiki)
* [Security](/LibRaw/LibRaw/security)
* [Insights](/LibRaw/LibRaw/pulse)

## Commit

[Permalink](/LibRaw/LibRaw/commit/4606c28f494a750892c5c1ac7903e62dd1c6fdb5)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

0.16.1: fix for dcraw ljpeg\_start() vulnerability

[Browse files](/LibRaw/LibRaw/tree/4606c28f494a750892c5c1ac7903e62dd1c6fdb5)
Browse the repository at this point in the history

* Loading branch information

[![@alextutubalin](https://avatars.githubusercontent.com/u/443031?s=40&v=4)](/alextutubalin)

[alextutubalin](/LibRaw/LibRaw/commits?author=alextutubalin "View all commits by alextutubalin")
committed
May 11, 2015

1 parent
[0217a0d](/LibRaw/LibRaw/commit/0217a0d03cb0ebef1aa3c8e91fdffbf6e93268f8)

commit 4606c28

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**31 additions**
and
**9 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* Changelog.rus
  [Changelog.rus](#diff-c205d216fd5cb7e5a7d63f853410bbbc350c7de8fbe3a06ef02c1486aa589771)
* Changelog.txt
  [Changelog.txt](#diff-7f3eb63360e4d9543b3e304f701e8c66932000254826d424fcafaea4486caf03)
* dcraw

  + dcraw/dcraw.c
    [dcraw.c](#diff-e20713db5a05472ad410f676c1bf5f6ba376dea9820539752dd8cf269ada42c0)
* internal

  + internal/dcraw\_common.cpp
    [dcraw\_common.cpp](#diff-9086e3ad805bc031dff601299aa68d245833693bc8dd34e0f493277efa6493d7)
  + internal/dcraw\_fileio.cpp
    [dcraw\_fileio.cpp](#diff-e01b60e9a2fcbaa53fcd7b2541b7e365c450378f78d3acc7f8ccf57ab2854c2e)
* libraw

  + libraw/libraw\_version.h
    [libraw\_version.h](#diff-f11e50a2c1c83d0b9b726e4394d10a705ad97c85bb51ad3348a0a29d5f896d97)

## There are no files selected for viewing

8 changes: 6 additions & 2 deletions

8
[Changelog.rus](#diff-c205d216fd5cb7e5a7d63f853410bbbc350c7de8fbe3a06ef02c1486aa589771 "Changelog.rus")

Show comments

[View file](/LibRaw/LibRaw/blob/4606c28f494a750892c5c1ac7903e62dd1c6fdb5/Changelog.rus)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,8 @@ |
|  |  | ﻿2014-01-17 Alex Tutubalin <lexa@lexa.ru> |
|  |  | ﻿2015-05-11 Alex Tutubalin <lexa@lexa.ru> |
|  |  | \* Исправлена уязвимость в dcraw:ljpeg\_start() |
|  |  | \* LibRaw 0.16.1 |
|  |  |  |
|  |  | 2014-01-17 Alex Tutubalin <lexa@lexa.ru> |
|  |  | \* Поддержка камер |
|  |  | Добавлены: Fujifilm X-E2,XQ1 |
|  |  | Обновлены цветовые данные: Nikon D4, 1 AW1/J3; Fuji X-M2 |
| Expand All | | @@ -13,7 +17,7 @@ |
|  |  | \* Исправлены ошибки компиляции при сборке VS2012 с включенным |
|  |  | OpenMP |
|  |  | \* Исправлена опечатка, не дававшая использовать Demosaic Pack GPL2 |
|  |  | \* LibRaw 0.16.0-Beta1 |
|  |  | \* LibRaw 0.16.0 |
|  |  |  |
|  |  | 2013-11-12 Alex Tutubalin <lexa@lexa.ru> |
|  |  | \* Поддержка новых камер |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[Changelog.txt](#diff-7f3eb63360e4d9543b3e304f701e8c66932000254826d424fcafaea4486caf03 "Changelog.txt")

Show comments

[View file](/LibRaw/LibRaw/blob/4606c28f494a750892c5c1ac7903e62dd1c6fdb5/Changelog.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,3 +1,7 @@ |
|  |  | 2015-05-11 Alex Tutubalin <lexa@lexa.ru> |
|  |  | \* Fix for dcraw ljpeg\_start() vulnerability |
|  |  | \* LibRaw 0.16.1-Release |
|  |  |  |
|  |  | 2014-01-17 Alex Tutubalin <lexa@lexa.ru> |
|  |  | \* Camera support: |
|  |  | Added: Fujifilm XE2, XQ1 |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[dcraw/dcraw.c](#diff-e20713db5a05472ad410f676c1bf5f6ba376dea9820539752dd8cf269ada42c0 "dcraw/dcraw.c")

Show comments

[View file](/LibRaw/LibRaw/blob/4606c28f494a750892c5c1ac7903e62dd1c6fdb5/dcraw/dcraw.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -841,7 +841,8 @@ struct jhead { |
|  |  |  |
|  |  | int CLASS ljpeg\_start (struct jhead \*jh, int info\_only) |
|  |  | { |
|  |  | int c, tag, len; |
|  |  | int c, tag; |
|  |  | ushort len; |
|  |  | uchar data[0x10000]; |
|  |  | const uchar \*dp; |
|  |  |  |
| Expand Down | |  |

15 changes: 14 additions & 1 deletion

15
[internal/dcraw\_common.cpp](#diff-9086e3ad805bc031dff601299aa68d245833693bc8dd34e0f493277efa6493d7 "internal/dcraw_common.cpp")

Show comments

[View file](/LibRaw/LibRaw/blob/4606c28f494a750892c5c1ac7903e62dd1c6fdb5/internal/dcraw_common.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -21,6 +21,7 @@ it under the terms of the one of three licenses as you choose: |
|  |  | for more information |
|  |  | \*/ |
|  |  |  |
|  |  | #line 261 "dcraw/dcraw.c" |
|  |  | #include <math.h> |
|  |  | #define CLASS LibRaw:: |
|  |  | #include "libraw/libraw\_types.h" |
| Expand All | | @@ -29,6 +30,7 @@ it under the terms of the one of three licenses as you choose: |
|  |  | #include "libraw/libraw.h" |
|  |  | #include "internal/defines.h" |
|  |  | #include "internal/var\_defines.h" |
|  |  | #line 272 "dcraw/dcraw.c" |
|  |  | int CLASS fcol (int row, int col) |
|  |  | { |
|  |  | static const char filter[16][16] = |
| Expand Down  Expand Up | | @@ -75,6 +77,7 @@ char \*my\_strcasestr (char \*haystack, const char \*needle) |
|  |  | } |
|  |  | #define strcasestr my\_strcasestr |
|  |  | #endif |
|  |  | #line 340 "dcraw/dcraw.c" |
|  |  | ushort CLASS sget2 (uchar \*s) |
|  |  | { |
|  |  | if (order == 0x4949) /\* "II" means little-endian \*/ |
| Expand Down  Expand Up | | @@ -564,10 +567,12 @@ void CLASS canon\_load\_raw() |
|  |  | #endif |
|  |  | FORC(2) free (huff[c]); |
|  |  | } |
|  |  | #line 841 "dcraw/dcraw.c" |
|  |  |  |
|  |  | int CLASS ljpeg\_start (struct jhead \*jh, int info\_only) |
|  |  | { |
|  |  | int c, tag, len; |
|  |  | int c, tag; |
|  |  | ushort len; |
|  |  | uchar data[0x10000]; |
|  |  | const uchar \*dp; |
|  |  |  |
| Expand Down  Expand Up | | @@ -1153,6 +1158,7 @@ int CLASS minolta\_z2() |
|  |  | if (tail[i]) nz++; |
|  |  | return nz > 20; |
|  |  | } |
|  |  | #line 1436 "dcraw/dcraw.c" |
|  |  | void CLASS ppm\_thumb() |
|  |  | { |
|  |  | char \*thumb; |
| Expand Down  Expand Up | | @@ -2976,6 +2982,7 @@ void CLASS redcine\_load\_raw() |
|  |  | #endif |
|  |  | #endif |
|  |  | } |
|  |  | #line 3983 "dcraw/dcraw.c" |
|  |  | void CLASS crop\_masked\_pixels() |
|  |  | { |
|  |  | int row, col; |
| Expand Down  Expand Up | | @@ -3081,6 +3088,7 @@ void CLASS remove\_zeroes() |
|  |  | RUN\_CALLBACK(LIBRAW\_PROGRESS\_REMOVE\_ZEROES,1,2); |
|  |  | #endif |
|  |  | } |
|  |  | #line 4254 "dcraw/dcraw.c" |
|  |  | void CLASS gamma\_curve (double pwr, double ts, int mode, int imax) |
|  |  | { |
|  |  | int i; |
| Expand Down  Expand Up | | @@ -4790,6 +4798,7 @@ void CLASS parse\_thumb\_note (int base, unsigned toff, unsigned tlen) |
|  |  | fseek (ifp, save, SEEK\_SET); |
|  |  | } |
|  |  | } |
|  |  | #line 5968 "dcraw/dcraw.c" |
|  |  | void CLASS parse\_makernote (int base, int uptag) |
|  |  | { |
|  |  | static const uchar xlat[2][256] = { |
| Expand Down  Expand Up | | @@ -5349,6 +5358,7 @@ void CLASS parse\_kodak\_ifd (int base) |
|  |  | fseek (ifp, save, SEEK\_SET); |
|  |  | } |
|  |  | } |
|  |  | #line 6533 "dcraw/dcraw.c" |
|  |  | int CLASS parse\_tiff\_ifd (int base) |
|  |  | { |
|  |  | unsigned entries, tag, type, len, plen=16, save; |
| Expand Down  Expand Up | | @@ -6648,6 +6658,7 @@ void CLASS parse\_redcine() |
|  |  | data\_offset = get4(); |
|  |  | } |
|  |  | } |
|  |  | #line 7936 "dcraw/dcraw.c" |
|  |  |  |
|  |  | /\* |
|  |  | All matrices are from Adobe DNG Converter unless otherwise noted. |
| Expand Down  Expand Up | | @@ -8923,6 +8934,7 @@ void CLASS identify() |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | #line 10303 "dcraw/dcraw.c" |
|  |  | void CLASS convert\_to\_rgb() |
|  |  | { |
|  |  | #ifndef LIBRAW\_LIBRARY\_BUILD |
| Expand Down  Expand Up | | @@ -9153,6 +9165,7 @@ int CLASS flip\_index (int row, int col) |
|  |  | if (flip & 1) col = iwidth - 1 - col; |
|  |  | return row \* iwidth + col; |
|  |  | } |
|  |  | #line 10559 "dcraw/dcraw.c" |
|  |  | void CLASS tiff\_set (ushort \*ntag, |
|  |  | ushort tag, ushort type, int count, int val) |
|  |  | { |
| Expand Down | |  |

8 changes: 4 additions & 4 deletions

8
[internal/dcraw\_fileio.cpp](#diff-e01b60e9a2fcbaa53fcd7b2541b7e365c450378f78d3acc7f8ccf57ab2854c2e "internal/dcraw_fileio.cpp")

Show comments

[View file](/LibRaw/LibRaw/blob/4606c28f494a750892c5c1ac7903e62dd1c6fdb5/internal/dcraw_fileio.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -21,15 +21,15 @@ it under the terms of the one of three licenses as you choose: |
|  |  | for more information |
|  |  | \*/ |
|  |  |  |
|  |  | #line 4090 "dcraw/dcraw.c" |
|  |  | #line 4091 "dcraw/dcraw.c" |
|  |  | #include <math.h> |
|  |  | #define CLASS LibRaw:: |
|  |  | #include "libraw/libraw\_types.h" |
|  |  | #define LIBRAW\_LIBRARY\_BUILD |
|  |  | #include "libraw/libraw.h" |
|  |  | #include "internal/defines.h" |
|  |  | #include "internal/var\_defines.h" |
|  |  | #line 4101 "dcraw/dcraw.c" |
|  |  | #line 4102 "dcraw/dcraw.c" |
|  |  | /\* |
|  |  | Seach from the current directory up to the root looking for |
|  |  | a ".badpixels" file, and fix those pixels now. |
| Expand All | | @@ -54,7 +54,7 @@ void CLASS bad\_pixels (const char \*cfname) |
|  |  | #endif |
|  |  | if (cfname) |
|  |  | fp = fopen (cfname, "r"); |
|  |  | #line 4151 "dcraw/dcraw.c" |
|  |  | #line 4152 "dcraw/dcraw.c" |
|  |  | if (!fp) |
|  |  | { |
|  |  | #ifdef LIBRAW\_LIBRARY\_BUILD |
| Expand Down  Expand Up | | @@ -154,7 +154,7 @@ void CLASS subtract (const char \*fname) |
|  |  | RUN\_CALLBACK(LIBRAW\_PROGRESS\_DARK\_FRAME,1,2); |
|  |  | #endif |
|  |  | } |
|  |  | #line 10213 "dcraw/dcraw.c" |
|  |  | #line 10214 "dcraw/dcraw.c" |
|  |  | #ifndef NO\_LCMS |
|  |  | void CLASS apply\_profile (const char \*input, const char \*output) |
|  |  | { |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[libraw/libraw\_version.h](#diff-f11e50a2c1c83d0b9b726e4394d10a705ad97c85bb51ad3348a0a29d5f896d97 "libraw/libraw_version.h")

Show comments

[View file](/LibRaw/LibRaw/blob/4606c28f494a750892c5c1ac7903e62dd1c6fdb5/libraw/libraw_version.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,7 +25,7 @@ it under the terms of the one of three licenses as you choose: |
|  |  |  |
|  |  | #define LIBRAW\_MAJOR\_VERSION 0 |
|  |  | #define LIBRAW\_MINOR\_VERSION 16 |
|  |  | #define LIBRAW\_PATCH\_VERSION 0 |
|  |  | #define LIBRAW\_PATCH\_VERSION 1 |
|  |  | #define LIBRAW\_VERSION\_TAIL Release |
|  |  |  |
|  |  | #define LIBRAW\_SHLIB\_CURRENT 10 |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 1 comment on commit `4606c28`

[![@LibRaw](https://avatars.githubusercontent.com/u/435672?s=80&v=4)](/LibRaw)

Copy link

Owner

### @LibRaw **[LibRaw](/LibRaw)** commented on `[4606c28](/LibRaw/LibRaw/commit/4606c28f494a750892c5c1ac7903e62dd1c6fdb5)` [Jul 1, 2015](#commitcomment-11955246)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Hello,

maximum value of (unsigned short) len is 0xffff, so data[0x10000] will not be overwriten. So, possible stack overflow is fixed.

Checking against len < 2 will not help much against corrupted/random data (try to check case with tag == 0xffc0 and len == 2)

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLibRaw%2FLibRaw%2Fcommit%2F4606c28f494a750892c5c1ac7903e62dd1c6fdb5) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.gentoo.org_bbb4aa63_20250126_004048.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# DCRaw: Buffer overflow — GLSA **201701-54**

A buffer overflow in DCRaw might allow remote attackers to cause a
Denial of Service condition.

### Affected packages

| Package | **media-gfx/dcraw** on all architectures |
| --- | --- |
| Affected versions | < **9.26.0** |
| Unaffected versions | >= **9.26.0** |

### Background

Command-line decoder for raw digital photos.

### Description

An integer overflow was discovered in the ljpeg\_start function in DCRaw.

### Impact

Remote attackers, by enticing a user to open a specially crafted image,
could cause a Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All DCRaw users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=media-gfx/dcraw-9.26.0"

```
### References

* [CVE-2015-3885](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-3885)

**Release date**

January 23, 2017

**Latest revision**

January 23, 2017: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [549336](https://bugs.gentoo.org/show_bug.cgi?id=549336)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from github.com_4e80d03a_20250126_004048.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frawstudio%2Frawstudio%2Fcommit%2F983bda1f0fa5fa86884381208274198a620f006e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frawstudio%2Frawstudio%2Fcommit%2F983bda1f0fa5fa86884381208274198a620f006e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fcommit%2Fshow&source=header-repo&source_repo=rawstudio%2Frawstudio)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rawstudio](/rawstudio)
/
**[rawstudio](/rawstudio/rawstudio)**
Public

* [Notifications](/login?return_to=%2Frawstudio%2Frawstudio) You must be signed in to change notification settings
* [Fork
  21](/login?return_to=%2Frawstudio%2Frawstudio)
* [Star
   86](/login?return_to=%2Frawstudio%2Frawstudio)

* [Code](/rawstudio/rawstudio)
* [Issues
  21](/rawstudio/rawstudio/issues)
* [Pull requests
  3](/rawstudio/rawstudio/pulls)
* [Actions](/rawstudio/rawstudio/actions)
* [Projects
  0](/rawstudio/rawstudio/projects)
* [Wiki](/rawstudio/rawstudio/wiki)
* [Security](/rawstudio/rawstudio/security)
* [Insights](/rawstudio/rawstudio/pulse)

Additional navigation options

* [Code](/rawstudio/rawstudio)
* [Issues](/rawstudio/rawstudio/issues)
* [Pull requests](/rawstudio/rawstudio/pulls)
* [Actions](/rawstudio/rawstudio/actions)
* [Projects](/rawstudio/rawstudio/projects)
* [Wiki](/rawstudio/rawstudio/wiki)
* [Security](/rawstudio/rawstudio/security)
* [Insights](/rawstudio/rawstudio/pulse)

## Commit

[Permalink](/rawstudio/rawstudio/commit/983bda1f0fa5fa86884381208274198a620f006e)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Avoid overflow in ljpeg\_start().

[Browse files](/rawstudio/rawstudio/tree/983bda1f0fa5fa86884381208274198a620f006e)
Browse the repository at this point in the history

* Loading branch information

[![@abrander](https://avatars.githubusercontent.com/u/3726205?s=40&v=4)](/abrander)

[abrander](/rawstudio/rawstudio/commits?author=abrander "View all commits by abrander")
committed
May 11, 2015

1 parent
[6eabf1f](/rawstudio/rawstudio/commit/6eabf1fa2ec5f7db0a2f8ab47157de74f8a3a199)

commit 983bda1

Showing
**1 changed file**
with
**2 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

3 changes: 2 additions & 1 deletion

3
[plugins/load-dcraw/dcraw.cc](#diff-7f1fda9e0b4d0356662126eb17d91239ca5c65b06cb0c8f55aa8c76bee6fc896 "plugins/load-dcraw/dcraw.cc")

Show comments

[View file](/rawstudio/rawstudio/blob/983bda1f0fa5fa86884381208274198a620f006e/plugins/load-dcraw/dcraw.cc)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -890,7 +890,8 @@ struct jhead { |
|  |  |  |
|  |  | int CLASS ljpeg\_start (struct jhead \*jh, int info\_only) |
|  |  | { |
|  |  | int c, tag, len; |
|  |  | int c, tag; |
|  |  | ushort len; |
|  |  | uchar data[0x10000]; |
|  |  | const uchar \*dp; |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 1 comment on commit `983bda1`

[![@abrander](https://avatars.githubusercontent.com/u/3726205?s=80&v=4)](/abrander)

Copy link

Member

Author

### @abrander **[abrander](/abrander)** commented on `[983bda1](/rawstudio/rawstudio/commit/983bda1f0fa5fa86884381208274198a620f006e)` [Jul 1, 2015](#commitcomment-11959107)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

The patch was the one received from David Coffin (author of dcraw) off channel before making the vulnerability public if I remember correctly.

I think the `len < 2` check is related to the line

```
len = (data[2] << 8 | data[3]) - 2;

```

where len can be USHORT-MAX-1, which may result in a possible read error in the following `fread()` call - but you can easily trigger a read error even without underflowing. I don't see any security related bugs triggered by omitting the check, len is an unsigned integer, and the data array is of size USHORT\_MAX+1. Neither overflow nor underflow can occur.

The fix in netpbm and Fedora is somewhat cleaner than the upstream fix in dcraw, but all are good from a security perspective.

For the interested: Rawstudio plans to remove dcraw completely from a future version and rely solely on RawSpeed - and *maybe* calling an external dcraw binary as a fall-back option to support ancient file formats.

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frawstudio%2Frawstudio%2Fcommit%2F983bda1f0fa5fa86884381208274198a620f006e) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.gentoo.org_4fcfd625_20250126_004048.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Kodi: Multiple vulnerabilities — GLSA **201706-17**

Multiple vulnerabilities have been found in Kodi, the worst of
which could allow remote attackers to execute arbitrary code.

### Affected packages

| Package | **media-tv/kodi** on all architectures |
| --- | --- |
| Affected versions | < **17.2** |
| Unaffected versions | >= **17.2** |

### Background

Kodi (formerly XBMC) is a free and open-source media player software
application.

### Description

Multiple vulnerabilities have been discovered in Kodi. Please review the
CVE identifiers referenced below for details.

### Impact

A remote attacker could entice a user to open a specially crafted image
file using Kodi, possibly resulting in a Denial of Service condition.

Furthermore, a remote attacker could entice a user process a specially
crafted ZIP file containing subtitles using Kodi, possibly resulting in
execution of arbitrary code with the privileges of the process or a
Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All Kodi users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=media-tv/kodi-17.2"

```
### References

* [CVE-2015-3885](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-3885)
* [CVE-2017-8314](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-8314)

**Release date**

June 20, 2017

**Latest revision**

June 20, 2017: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [549342](https://bugs.gentoo.org/show_bug.cgi?id=549342)
* [619492](https://bugs.gentoo.org/show_bug.cgi?id=619492)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugs.gentoo.org_0734e850_20250126_131113.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Search by bug number

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?keywords=id&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?keywords=id&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

You may find a single bug by entering its bug id here:

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?keywords=id&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?keywords=id&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from www.ocert.org_62b6232a_20250126_004040.html ===


**oCERT-2015-006 dcraw input sanitization errors**

**Description**:

The [dcraw](http://www.cybercom.net/~dcoffin/dcraw) photo decoder
is an open source project for raw image parsing.

The dcraw tool, as well as several other projects re-using its code,
suffers from an integer overflow condition which lead to a buffer overflow.
The vulnerability concerns the 'len' variable, parsed without validation from
opened images, used in the ljpeg\_start() function.

A maliciously crafted raw image file can be used to trigger the
vulnerability, causing a Denial of Service condition.

**Affected version**:

[dcraw](http://www.cybercom.net/~dcoffin/dcraw) >= 7.00

[UFRaw](http://ufraw.sourceforge.net/) >= 0.5

[LibRaw](http://www.libraw.org/) <= 0.16.0, 0.17-Alpha2

[RawTherapee](http://rawtherapee.com) >= 3.0

[CxImage](http://www.xdp.it/cximage.htm) >= 6.00

[Rawstudio](http://rawstudio.org) >= 0.1

[Kodi](http://kodi.tv) >= 10.0

[ExactImage](http://www.exactcode.com/site/open_source/exactimage) >= 0.1.0

**Fixed version**:

[dcraw](http://www.cybercom.net/~dcoffin/dcraw), N/A

[UFRaw](http://ufraw.sourceforge.net/), N/A

[LibRaw](http://www.libraw.org/) >= 0.16.1, 0.17-Alpha3

[RawTherapee](http://rawtherapee.com), N/A

[CxImage](http://www.xdp.it/cximage.htm), N/A

[Rawstudio](http://rawstudio.org), N/A

[Kodi](http://kodi.tv), N/A

[ExactImage](http://www.exactcode.com/site/open_source/exactimage), N/A

**Credit**: vulnerability report from Eduardo Castellanos <guayin [at] gmail [dot] com>.

**CVE**: [CVE-2015-3885](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-3885)

**Timeline**:

2015-04-24: vulnerability report received

2015-04-27: contacted dcraw maintainer

2015-04-30: patch provided by maintainer

2015-05-04: reporter confirms patch

2015-05-11: contacted additional affected vendors

2015-05-11: advisory release

2015-05-12: assigned CVE

**References**:

<https://github.com/LibRaw/LibRaw/commit/4606c28f494a750892c5c1ac7903e62dd1c6fdb5>

<https://github.com/rawstudio/rawstudio/commit/983bda1f0fa5fa86884381208274198a620f006e>


