=== Content from framework.zend.com_87516a30_20250125_000704.html ===


Toggle navigation

[![Zend Framework](../../img/zend-framework-logo.svg)](../../index.html)

* [ABOUT](../../about.1.html)
* [INSTALL](../../downloads.html)
* [DOCUMENTATION](../../learn.html)
* [TRAINING](https://www.zend.com/en/services/training)
* [BLOG](../../blog/index.html)
* [PARTICIPATE](../../participate.html)

### Security

## Security Advisory: ZF2015-05

# ZF2015-05: Potential XSS and Open Redirect vectors in zend-diactoros

The Drupal Security Team notified us of a potential issue with the
[Diactoros](https://github.com/zendframework/zend-diactoros) URI implementation.
Diactoros is a [PSR-7](http://www.php-fig.org/psr/psr-7/) implementation of HTTP
messages.

If the path from a `Zend\Diactoros\Uri` instance is used to generate links, form
targets, or headers, and omits the scheme and authority, a potential XSS and/or
open redirect vector is possible if the path starts with double slashes and a
path segment that validates as a hostname; in such a situation, it may be
interpreted as a scheme-relative link.

The vulnerability exists in all stable versions of zend-diactoros prior to
1.0.4.

## Action Taken

`Zend\Diactoros\Uri::filterPath()` was updated to ensure that the returned path
will never begin with double slashes. Tests were also added to prevent a
regression in the future.

The patch fixing the issues has been applied in the following versions:

* zend-diactoros 1.0.4

This vulnerability has also been disclosed as [CVE-2015-3257](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-3257).

## Recommendations

If you are using `Zend\Diactoros\Uri` to generate links, form targets, or
headers without including the scheme and authority, we recommend:

* Upgrading immediately to zend-diactoros 1.0.4.
* Consider altering your code to generate absolute URIs (which can be done by
  simply casting the `Uri` instance to a string).

## Other Information

### Acknowledgments

The Zend Framework team thanks the following for identifying the issues and
working with us to help protect its users:

* [The Drupal Security Team](https://security.drupal.org), who notified us of
  the issue and provided the proof-of-vulnerability;
* [Larry Garfield](http://www.garfieldtech.com/), who asked the Drupal Security
  Team to work with us;
* [Matthew Weier O'Phinney](https://mwop.net/), who wrote the patch for the
  issue.

Released 2015-06-25

 [Back to advisories](../advisories/index.html)

* [Overview](../index.html)
* [Advisories](../advisories/index.html)
* [Feed](../feed)

 Have you identified a security vulnerability?

Please report it to us at zf-security@zend.com

**About**

[Overview](../../about.1.html)

[FAQ](../../about/faq.html)

[License](../../license.html)

[Changelog](../../changelog.html)

[Security](../index.html)

[Issues](../../issues.html)

**Install**

[Get started](../../downloads.html)

[MVC skeleton app](../../downloads/skeleton-app.html)

[Expressive skeleton app](../../downloads/expressive.html)

[Archives](../../downloads/latest.html)

**Documentation**

[Overview](../../learn.html)

[Training and Certification](../../learn/training-and-certification/index.html)

[Support and Consulting](../../learn/support-and-consulting/index.html)

[Webinars](http://www.zend.com/en/webinars/recorded/show-by-topic/242_zend%2Bframework)

[Blog](../../blog/index.html)

[Zend Framework 2](../../manual/2.4/en/index.html) - [API](../../docs/api/zf2.html)

[Zend Framework 1](../../manual/1.12/en/manual.html) - [API](../../docs/api/zf1.html)

**Participate**

[Overview](../../participate.html)

[Slack](https://laminas.dev/chat)

[Forums](https://discourse.laminas.dev)

[Contributor guide](../../participate/contributor-guide.html)

[Code Manifesto](../../participate/code-manifesto.html)

[Contributors](../../participate/contributors.html)

[Logos](../../participate/logos.html)

[Get certified](http://www.zend.com/en/services/certification)

[Privacy Policy](https://www.zend.com/privacy-policy)

#### Copyright

Â© 2006-2022 by [Zend](https://www.zend.com) by [Perforce](https://www.perforce.com/). Made with  by awesome [contributors](../../participate/contributors.html).

This website is built using [zend-expressive](https://docs.zendframework.com/zend-expressive/) and it runs on [PHP 7](http://www.zend.com/en/resources/php-7).

#### Contacts

We use cookies to allow you to dismiss dialogs such as the Laminas
Project notification.

Allow Cookies


