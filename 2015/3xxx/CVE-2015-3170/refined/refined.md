Based on the provided information, here's a breakdown of the vulnerability described in CVE-2015-3170:

**Root Cause:**

- The vulnerability stems from how `restorecon` (a tool used to restore SELinux file context labels) handles files with multiple hard links during package updates. Specifically, `restorecon` does not account for the case where different hard links to the same file might have different intended SELinux contexts.

- The SELinux policy update script uses `restorecon -R /home/*/.config` to relabel files in users' home directories, after selinux-policy package updates.

**Weaknesses/Vulnerabilities Present:**

-   **Incorrect Relabeling:** When `restorecon` encounters a file with multiple hard links, it may apply an incorrect SELinux context, which may not match the intended context based on the location of the hardlink.
-   **Hard Link Manipulation:** Attackers can create hard links to critical files like `/etc/passwd` within their `.config` directory, and this hard link will be relabeled when the policy is updated.

**Impact of Exploitation:**

- **Denial of Service:** When critical files like `/etc/passwd` are relabeled with an incorrect context (e.g., `config_home_t` instead of `passwd_file_t`), applications that rely on them (e.g. `unix_chkpwd`) will fail due to SELinux access denials. This could lead to a denial of service, preventing login via SSH and potentially impacting other services.

**Attack Vectors:**

- **Local User Exploitation:** A local user can create hard links within their home directory to system files, such as `/etc/passwd`.
- **SELinux Policy Update:** When an administrator updates the `selinux-policy-targeted` package, `restorecon` is invoked as part of post-install steps, which will relabel all files under `/home/*/.config` recursively, including the malicious hardlinks to system files.
- **Race Condition (Potentially):** The initial description mentions a potential race condition within the relabel code, making exploitation possible even with protected hardlinks. However, this is only a side note and not the primary attack vector.

**Required Attacker Capabilities/Position:**

- **Local User Access:** The attacker needs to have a valid local user account on the affected system.
- **File System Access:** The attacker needs write permissions to a location in their home directory.
- **`fs.protected_hardlinks` set to 0 or the ability to bypass the protection:**  The vulnerability is easier to exploit if `fs.protected_hardlinks` is set to 0, however exploitation is still possible (albeit more difficult) with protected hardlinks enabled.

**Additional Notes:**

-   The bug report indicates that the issue affects both RHEL 6 and RHEL 7, although it was easier to exploit in RHEL 7 due to the specific `restorecon` command added in the `selinux-policy-targeted` package's post-install script.
-   The issue was classified as a low severity security impact and was not planned to be addressed in future updates.
-   The discussion mentions potential mitigations such as checking for hard links before relabeling, or using `O_PATH` to check link counts.