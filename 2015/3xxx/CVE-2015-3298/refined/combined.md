=== Content from developers.yubico.com_bbfe91a2_20250124_165617.html ===


[![](/logo.png)](/)

* [Passkeys](/Passkeys)
* [WebAuthn](/WebAuthn)
* [CTAP](/CTAP)
* [OTP](/OTP)
* [OATH](/OATH)
* [PGP](/PGP)
* [PIV](/PIV)
* [YubiHSM2](/YubiHSM2)
* [Software Projects](/Software_Projects)

1. [Home](/)
2. [ykneo-openpgp](/ykneo-openpgp)
3. SecurityAdvisory 2015-04-14

* [ykneo-openpgp](/ykneo-openpgp)
  + [Releases](/ykneo-openpgp/Releases)
  + [Release Notes](/ykneo-openpgp/Release_Notes.html)
  + [Building](/ykneo-openpgp/Building.html)
  + [InstallCAPFile](/ykneo-openpgp/InstallCAPFile.html)
  + [PinRetries](/ykneo-openpgp/PinRetries.html)
  + [ResetApplet](/ykneo-openpgp/ResetApplet.html)
  + [SecurityAdvisory 2015-04-14](/ykneo-openpgp/SecurityAdvisory%202015-04-14.html)

* [Github](https://github.com/Yubico/ykneo-openpgp)

# SecurityAdvisory 2015-04-14

Tracking IDs: YSA-2015-1 and CVE-2015-3298.

## Background

The YubiKey NEO is a flexible security product from Yubico that
implements the Yubico One-Time Password technology, FIDO Universal 2nd
Factor, OATH codes, PIV card, and OpenPGP card functionality. The
on-card OpenPGP software of the YubiKey NEO is implemented by the free
and open-source software (FOSS) project "ykneo-openpgp", forked from
an earlier implementation called âjavacardopenpgpâ.

Links:

* <https://www.yubico.com/>
* <https://developers.yubico.com/ykneo-openpgp/>
* <https://github.com/Yubico/ykneo-openpgp>
* <http://sourceforge.net/projects/javacardopenpgp/>

## Summary

The source code contains a logical flaw related to user
PIN (aka PW1) verification that allows an attacker with local host privileges
and/or physical proximity (NFC) to perform security operations without
knowledge of the userâs PIN code.

## Mitigation

The flaw is mitigated by the fact that an attacker would typically
require some abilities that would enable the attack even without the
logical flaw.

In particular, any attacker with access to the local host must be
assumed to be able to learn the userâs PIN code, simply by
intercepting communication with the OpenPGP card hardware or through
key logging.

Alternatively, if the attacker has physical proximity to the card, it
could wait for the device to be used normally over NFC and then learn
the PIN code wirelessly and perform the attack at a later point.

If your device is stolen, attackers may use it to perform private-key
operations. If an attacker has gone through the trouble of obtaining
physical access to a key, the conservative approach is to regard it is
possible that the attacker were able to learn the PIN earlier since the
PIN is often unprotected. In situations like this, you should treat the
key as potentially compromised and revoke the key.

Generally the OpenPGP Card specification does not protect against
private key-usage by malware and/or PIN phishing, and any OpenPGP Card
implementation is vulnerable to similar attacks.

Note that the private key is not at jeopardy, and malware cannot learn
the private keyâââthis is in fact the primary threat that the
OpenPGP card specification protects against.

## Analysis

The following description is courtesy of Joey Castillo.

The bug appears to be a typo in the first line of the
computeDigitalSignature, decipher and internalAuthenticate
methods. The goal of each is to establish that the PW1 has been
validated, AND the proper mode has been set (mode 81 for signing, mode
82 for everything else). According to the spec, if either of these
conditions are not satisfied, the security operation should not
proceed.

The application mangles this a bit, as you can see in line 628:

<https://github.com/Yubico/ykneo-openpgp/blob/f82f3e4dc80e4476e90411bc837c52d6e1c9355f/applet/src/openpgpcard/OpenPGPApplet.java#L628>

```
if (!pw1.isValidated() && pw1_modes[PW1_MODE_NO81])
    ISOException.throwIt(SW_SECURITY_STATUS_NOT_SATISFIED);
// otherwise execution continues
```

This truth table shows the outcome of the conditional, and the two
cases where the logic fails:

| Case | PIN valid | Mode 81 | !(PIN valid) | Result | Outcome |
| --- | --- | --- | --- | --- | --- |
| 1 | true | true | false | false | No exception |
| 2 | false | true | true | true | Exception thrown |
| 3 | true | false | false | false | No exception (Incorrect) |
| 4 | false | false | true | false | No exception (Incorrect) |

I discovered this bug due to case #3: OpenKeychain for Android
mistakenly verifies the PIN with mode 82 for signing, which should not
allow a signature to be generated. The Yubikey generates a signature
anyway.

The dire case is #4: when the card is powered up, the PIN has not been
validated, and both modes are set to false. In this state, the card
will issue a signature even though the PIN has not been validated. The
same bug is present in the decipher command (line 659) and the
internalAuthenticate command (line 683), just with the mode set to
82. This means the card will also decrypt session keys and
authenticate challenges unconditionally.

<https://github.com/Yubico/ykneo-openpgp/blob/f82f3e4dc80e4476e90411bc837c52d6e1c9355f/applet/src/openpgpcard/OpenPGPApplet.java#L659>

<https://github.com/Yubico/ykneo-openpgp/blob/f82f3e4dc80e4476e90411bc837c52d6e1c9355f/applet/src/openpgpcard/OpenPGPApplet.java#L683>

## Solution

This is also courtesy of Joey Castillo.

The fix is to change each of the conditionals to the following:

```
if (!pw1.isValidated() || !pw1_modes[PW1_MODE_NO8x])
    ISOException.throwIt(SW_SECURITY_STATUS_NOT_SATISFIED);
// otherwise execution continues
```

This way, if the PIN has not been validated, OR the proper mode has
not been set, an exception is thrown. Execution is only allowed to
continue if both conditions are true.

This fix has been integrated into ykneo-openpgp and is part of the
version 1.0.9 release, but read on for some information about 1.0.10.

## How to check if you are affected

Versions below 1.0.9 are affected by this problem. Unfortunately,
some YubiKey NEOs shipped with a 1.0.9 release that did not contain
the fix. To simplify version checking, we have released 1.0.10 and
NEOs using that version is known to always include the fix. To be
certain that your NEO has the fixed ykneo-openpgp applet installed,
look for a version of 1.0.10 or later.

You may check the applet version with the following command.

```

 gpg-connect-agent --hex "scd apdu 00 f1 00 00" /bye
 D[0000]  01 00 06 90 00                                     .....
 OK

```

The string "01 00 06" means version 1.0.6, which would be affected by
this problem.

## Recommendation

The logical flaw is real and violates assumption of how the OpenPGP
applet works in principle. However its practical consequences are
relatively small as a successful attack requires other privileged
operations (such as local root access) that are normally not available
to an attacker, and would have undermined the security anyway.

Regardless of this assessment, Yubico has decided to replace YubiKey NEO keys for those who are using the OpenPGP applet version 1.0.9 or earlier. This replacement program began on April 26, 2015.
**Update: This replacement program ended on April 18, 2019.**

~~Therefore, we don't see any immediate need for users to upgrade existing
deployed products. We will incorporate the improved code in future
products sold, and add self-tests to our software project to detect any
regression in this area.~~

For stolen devices, we continue to recommend users to follow best-practices
and revoke the key as a conservative measure.

As we take all security related incidents seriously we have prepared a
prompt security advisory and released all information about this
incident that we know about. We welcome further analysis of the
source code, as this will over time increase confidence in the
product, and is the reason the source is available.

If you have additional inquiries related to your YubiKey NEO purchase,
please contact your sales contact for further discussion.

## Related projects

This defect was present in the code we inherited from the âjavacardopenpgpâ
project, and that project has been notified. There may be other forks, public
or not, and we recommend the community to review other code with the same
origin.

## History of events

* 2015-04-11 Reported by Joey Castillo.
* 2015-04-11 Version 1 of security advisory circulated for review.
* 2015-04-13 Mitre assigned id for vulnerability as CVE-2015-3298.
* 2015-04-13 Upstream project âjavacardopenpgpâ notified.
* 2015-04-14 Security advisory published.
* 2015-04-20 Some 1.0.9 NEOs were shipped without the fix, text updated
  to recommend looking for 1.0.10 as a better minimum version.
* 2015-04-27 Add an update about Yubico replacement policy.
* 2019-04-18 Remove the update about Yubico replacement policy.
* 2019-05-02 Clarify previous update, adding date of policy expiration.

**[DEV.YUBICO](https://developers.yubico.com/)**

[Passkeys](/Passkeys)

[WebAuthn](/WebAuthn)

[CTAP](/CTAP)

[OTP](/OTP)

[OATH](/OATH)

[PGP](/PGP)

[PIV](/PIV)

[YubiHSM2](/YubiHSM2)

[Software Projects](/Software_Projects)

**RESOURCES**

[Buy YubiKeys](https://www.yubico.com/store/)

[Blog](https://www.yubico.com/blog/)

[Newsletter](https://www.yubico.com/newsletter/)

[Yubico Forum Archive](https://forum.yubico.com/)

**[YUBICO.COM](https://www.yubico.com/)**

[Why Yubico](https://www.yubico.com/why-yubico/)

[About Yubico](https://www.yubico.com/about/about-us/)

[Cookie](https://www.yubico.com/support/terms-conditions/cookie-notice/)

[Legal](https://www.yubico.com/support/terms-conditions/)

[Privacy](https://www.yubico.com/support/terms-conditions/privacy-notice/)

[Terms of use](https://www.yubico.com/support/terms-conditions/yubico-website-terms-conditions/)

[Trust](https://www.yubico.com/trust/)

|  |  |  |  |  |
| --- | --- | --- | --- | --- |



=== Content from github.com_c56ad535_20250126_022458.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FYubico%2Fykneo-openpgp)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FYubico%2Fykneo-openpgp)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Yubico%2Fykneo-openpgp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Yubico](/Yubico)
/
**[ykneo-openpgp](/Yubico/ykneo-openpgp)**
Public

* [Notifications](/login?return_to=%2FYubico%2Fykneo-openpgp) You must be signed in to change notification settings
* [Fork
  67](/login?return_to=%2FYubico%2Fykneo-openpgp)
* [Star
   214](/login?return_to=%2FYubico%2Fykneo-openpgp)

OpenPGP applet for the YubiKey NEO

[developers.yubico.com/ykneo-openpgp/](https://developers.yubico.com/ykneo-openpgp/ "https://developers.yubico.com/ykneo-openpgp/")

### License

[GPL-2.0 license](/Yubico/ykneo-openpgp/blob/master/LICENSE)

[214
stars](/Yubico/ykneo-openpgp/stargazers) [67
forks](/Yubico/ykneo-openpgp/forks) [Branches](/Yubico/ykneo-openpgp/branches) [Tags](/Yubico/ykneo-openpgp/tags) [Activity](/Yubico/ykneo-openpgp/activity)
 [Star](/login?return_to=%2FYubico%2Fykneo-openpgp)

 [Notifications](/login?return_to=%2FYubico%2Fykneo-openpgp) You must be signed in to change notification settings

* [Code](/Yubico/ykneo-openpgp)
* [Issues
  16](/Yubico/ykneo-openpgp/issues)
* [Pull requests
  2](/Yubico/ykneo-openpgp/pulls)
* [Actions](/Yubico/ykneo-openpgp/actions)
* [Security](/Yubico/ykneo-openpgp/security)
* [Insights](/Yubico/ykneo-openpgp/pulse)

Additional navigation options

* [Code](/Yubico/ykneo-openpgp)
* [Issues](/Yubico/ykneo-openpgp/issues)
* [Pull requests](/Yubico/ykneo-openpgp/pulls)
* [Actions](/Yubico/ykneo-openpgp/actions)
* [Security](/Yubico/ykneo-openpgp/security)
* [Insights](/Yubico/ykneo-openpgp/pulse)

# Yubico/ykneo-openpgp

    master[Branches](/Yubico/ykneo-openpgp/branches)[Tags](/Yubico/ykneo-openpgp/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[177 Commits](/Yubico/ykneo-openpgp/commits/master/) | | |
| [applet/src/openpgpcard](/Yubico/ykneo-openpgp/tree/master/applet/src/openpgpcard "This path skips through empty directories") | | [applet/src/openpgpcard](/Yubico/ykneo-openpgp/tree/master/applet/src/openpgpcard "This path skips through empty directories") |  |  |
| [doc](/Yubico/ykneo-openpgp/tree/master/doc "doc") | | [doc](/Yubico/ykneo-openpgp/tree/master/doc "doc") |  |  |
| [test](/Yubico/ykneo-openpgp/tree/master/test "test") | | [test](/Yubico/ykneo-openpgp/tree/master/test "test") |  |  |
| [util](/Yubico/ykneo-openpgp/tree/master/util "util") | | [util](/Yubico/ykneo-openpgp/tree/master/util "util") |  |  |
| [.gitignore](/Yubico/ykneo-openpgp/blob/master/.gitignore ".gitignore") | | [.gitignore](/Yubico/ykneo-openpgp/blob/master/.gitignore ".gitignore") |  |  |
| [.travis.yml](/Yubico/ykneo-openpgp/blob/master/.travis.yml ".travis.yml") | | [.travis.yml](/Yubico/ykneo-openpgp/blob/master/.travis.yml ".travis.yml") |  |  |
| [BLURB](/Yubico/ykneo-openpgp/blob/master/BLURB "BLURB") | | [BLURB](/Yubico/ykneo-openpgp/blob/master/BLURB "BLURB") |  |  |
| [LICENSE](/Yubico/ykneo-openpgp/blob/master/LICENSE "LICENSE") | | [LICENSE](/Yubico/ykneo-openpgp/blob/master/LICENSE "LICENSE") |  |  |
| [NEWS](/Yubico/ykneo-openpgp/blob/master/NEWS "NEWS") | | [NEWS](/Yubico/ykneo-openpgp/blob/master/NEWS "NEWS") |  |  |
| [README](/Yubico/ykneo-openpgp/blob/master/README "README") | | [README](/Yubico/ykneo-openpgp/blob/master/README "README") |  |  |
| [README.adoc](/Yubico/ykneo-openpgp/blob/master/README.adoc "README.adoc") | | [README.adoc](/Yubico/ykneo-openpgp/blob/master/README.adoc "README.adoc") |  |  |
| [build.xml](/Yubico/ykneo-openpgp/blob/master/build.xml "build.xml") | | [build.xml](/Yubico/ykneo-openpgp/blob/master/build.xml "build.xml") |  |  |
| [do-release.sh](/Yubico/ykneo-openpgp/blob/master/do-release.sh "do-release.sh") | | [do-release.sh](/Yubico/ykneo-openpgp/blob/master/do-release.sh "do-release.sh") |  |  |
| [gpinstall.txt](/Yubico/ykneo-openpgp/blob/master/gpinstall.txt "gpinstall.txt") | | [gpinstall.txt](/Yubico/ykneo-openpgp/blob/master/gpinstall.txt "gpinstall.txt") |  |  |
| [pom.xml](/Yubico/ykneo-openpgp/blob/master/pom.xml "pom.xml") | | [pom.xml](/Yubico/ykneo-openpgp/blob/master/pom.xml "pom.xml") |  |  |
| View all files | | |

## Repository files navigation

* README
* License
## YubiKey NEO App: OpenPGP

| Note | This project is in maintenance mode, it’s in use on the YubiKey NEO but not on newer Yubico products. No development is happening on this. |
| --- | --- |

| Important | Yubico has learned of a security issue with the OpenPGP Card applet project that is used in the YubiKey NEO. This vulnerability applies to you only if you are using OpenPGP, and you have the OpenPGP applet version 1.0.9 or earlier. [SecurityAdvisory 2015-04-14](https://developers.yubico.com/ykneo-openpgp/SecurityAdvisory%202015-04-14.html) |
| --- | --- |

This project implement the OpenPGP card functionality used on the
YubiKey NEO device that is sold by Yubico.

This project is based on the
[Java Card OpenPGP Card](https://github.com/jderuiter/javacard-openpgpcard)
project made by Joeri de Ruiter.
The initial modifications we have made compared to
the upstream project are minor, but we reserve the right to make other
changes and improvements that are specific to the YubiKey NEO
hardware.

### License

The upstream project was released under the GPLv2+ and our fork uses
the same license. All of our changes are released under the same
license. See the file LICENSE for more information.

### Building

See doc/Building.txt for information on how to build the source code
and doc/InstallCAPFile.txt on how to install it.

### Usage

The OpenPGP Card applet is typically used through [GnuPG](http://www.gnupg.org)
so we refer to its documentation for the full reference.

The default PIN set is `123456' and the default admin PIN is `12345678'

We have tutorials on specific topics in at
[developers.yubico.com/PGP](https://developers.yubico.com/PGP), for example card
editing and key import.

## About

OpenPGP applet for the YubiKey NEO

[developers.yubico.com/ykneo-openpgp/](https://developers.yubico.com/ykneo-openpgp/ "https://developers.yubico.com/ykneo-openpgp/")

### Resources

[Readme](#readme-ov-file)
### License

[GPL-2.0 license](#GPL-2.0-1-ov-file)

[Activity](/Yubico/ykneo-openpgp/activity)
[Custom properties](/Yubico/ykneo-openpgp/custom-properties)
### Stars

[**214**
stars](/Yubico/ykneo-openpgp/stargazers)
### Watchers

[**76**
watching](/Yubico/ykneo-openpgp/watchers)
### Forks

[**67**
forks](/Yubico/ykneo-openpgp/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FYubico%2Fykneo-openpgp&report=Yubico+%28user%29)

## [Releases 3](/Yubico/ykneo-openpgp/releases)

[1.0.2
Latest

Jul 4, 2013](/Yubico/ykneo-openpgp/releases/tag/1.0.2)
[+ 2 releases](/Yubico/ykneo-openpgp/releases)

## [Packages 0](/orgs/Yubico/packages?repo_name=ykneo-openpgp)

No packages published

## [Contributors 15](/Yubico/ykneo-openpgp/graphs/contributors)

## Languages

* [Java
  76.9%](/Yubico/ykneo-openpgp/search?l=java)
* [Python
  21.6%](/Yubico/ykneo-openpgp/search?l=python)
* [Shell
  1.5%](/Yubico/ykneo-openpgp/search?l=shell)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


