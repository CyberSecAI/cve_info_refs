=== Content from bugzilla.redhat.com_64f5dc86_20250124_161338.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1215020)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1215020)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1215020)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1215020

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1215020**](show_bug.cgi?id=1215020)
(CVE-2015-3160)
- Beaker is vulnerable to "XXE" attacks from authenticated users, due to external entity expansion in job XML

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Beaker is vulnerable to "XXE" attacks from authenticated users, due to extern...

| | [Keywords](describekeywords.cgi): | Patch  Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED CURRENTRELEASE | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2015-3160 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Beaker | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Retired | | [Component:](describecomponents.cgi?product=Beaker "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | general | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 19 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | unspecified | | [Severity:](page.cgi?id=fields.html#bug_severity) | unspecified | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | 20.1 | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Dan Callaghan | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | tools-bugs | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1215894](show_bug.cgi?id=1215894) | | TreeView+ | [depends on](buglist.cgi?bug_id=1215020&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1215020&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2015-04-24 06:58 UTC by Dan Callaghan | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2018-02-06 00:41 UTC ([History](show_activity.cgi?id=1215020)) | | [CC List:](page.cgi?id=fields.html#cclist) | 18 users (show)  aigao asaha dcallagh dowang ebaak huiwang ineilsen jskeoch junichi.nomura kueda lzhuang mjia naoya.horiguchi pen-test rpotts security-response-team tatsu-ab1 tflink | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2015-05-08 04:05:50 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**proposed patch**](attachment.cgi?id=1020003 "View the content of the attachment") (4.87 KB, patch)  [2015-04-29 07:21 UTC](#attach_1020003 "Go to the comment associated with the attachment"), Dan Callaghan | *no flags* | [Details](attachment.cgi?id=1020003&action=edit) | [Diff](attachment.cgi?id=1020003&action=diff) | | [View All](attachment.cgi?bugid=1215020&action=viewall) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1215020#c0)  Dan Callaghan    2015-04-24 06:58:04 UTC  ``` Description of problem: Beaker is vulnerable to "XXE" (XML external entity) attacks. An authenticated user can submit a job XML to the scheduler containing entity references which reference files from the Beaker server's filesystem, thereby causing the contents to be disclosed in the web UI.  For example:  <!DOCTYPE foo [ <!ELEMENT foo ANY > <!ENTITY xxe SYSTEM "file:///etc/passwd" >]> <job>   <whiteboard>&xxe;</whiteboard>   <recipeSet>     <recipe>       <distroRequires>       <distro_arch op="=" value="x86_64"/>         </distroRequires>       <hostRequires/>       <task name="/distribution/install" role="STANDALONE"/>     </recipe>   </recipeSet> </job>  This can be exploited to reveal sensitive information from the filesystem accessible by the apache user, including Kerberos keytabs and the database password in /etc/beaker/server.cfg.  Note that there are no known ways to exploit this as an anonymous user. It requires malicious action from a user with a valid Beaker account.  Version-Release number of selected component (if applicable): all Beaker versions are vulnerable  Steps to Reproduce: 1. Log in to Beaker as any user account 2. Submit a specially craft job using external entity expansion, as per the above example 3. View the job in the web UI  Actual results: Contents of /etc/passwd are revealed in the job whiteboard.  Expected results: Job should not be accepted, it should fail to parse due to an undefined entity.  Additional info: <https://www.owasp.org/index.php/XML_External_Entity_%28XXE%29_Processing>   ```  [Comment 2](show_bug.cgi?id=1215020#c2)  Dan Callaghan    2015-04-29 07:21:38 UTC  ``` Created [attachment 1020003](attachment.cgi?id=1020003&action=diff "proposed patch") [[details]](attachment.cgi?id=1020003&action=edit "proposed patch") proposed patch   ```  [Comment 5](show_bug.cgi?id=1215020#c5)  Hui Wang    2015-05-04 06:39:19 UTC  ``` Verified this issue. The result is PASS. Version: Beaker 20.1.git.5.24dc482 Steps: 1. Log in to Beaker as any user account 2. Submit a specially craft job using external entity expansion, as per the above example in description  Result:  Failed to import job   ```  [Comment 6](show_bug.cgi?id=1215020#c6)  Dan Callaghan    2015-05-08 04:05:50 UTC  ``` Beaker 20.1 has been released.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1215020&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.redhat.com_212af2c8_20250124_161337.html ===
From 9947b26993d8ca4996dec4d574b0f5a82c5f24f5 Mon Sep 17 00:00:00 2001
From: Dan Callaghan
Date: Wed, 29 Apr 2015 16:11:10 +1000
Subject: [PATCH 1/3] disallow external entities in job XML
Bug: 1215020
Change-Id: I19f2554a15a4965c29f365ea873c093fc5910d1b
---
.../src/bkr/inttest/server/selenium/test\_jobs.py | 32 ++++++++++++++++++++++
Server/bkr/server/jobs.py | 6 ++--
Server/bkr/server/util.py | 21 ++++++++++++++
3 files changed, 56 insertions(+), 3 deletions(-)
diff --git a/IntegrationTests/src/bkr/inttest/server/selenium/test\_jobs.py b/IntegrationTests/src/bkr/inttest/server/selenium/test\_jobs.py
index d006e93..7671ccb 100644
--- a/IntegrationTests/src/bkr/inttest/server/selenium/test\_jobs.py
+++ b/IntegrationTests/src/bkr/inttest/server/selenium/test\_jobs.py
@@ -745,6 +745,38 @@ def test\_useful\_error\_message\_on\_ksmeta\_syntax\_error(self):
'Failed to import job because of: '
'Error parsing ks\_meta: No closing quotation')
+ # https://bugzilla.redhat.com/show\_bug.cgi?id=1215020
+ def test\_xml\_external\_entities\_are\_rejected(self):
+ b = self.browser
+ login(b)
+ b.get(get\_server\_base())
+ click\_menu\_item(b, 'Scheduler', 'New Job')
+ xml\_file = tempfile.NamedTemporaryFile()
+ xml\_file.write('''
+
+ ]>
+
+ &xxe
+
+
+
+
+
+
+
+
+
+
+ ''')
+ xml\_file.flush()
+ b.find\_element\_by\_id('jobs\_filexml').send\_keys(xml\_file.name)
+ b.find\_element\_by\_xpath('//button[text()="Submit Data"]').click()
+ b.find\_element\_by\_xpath('//button[text()="Queue"]').click()
+ self.assertEquals(b.find\_element\_by\_class\_name('flash').text,
+ 'Failed to import job because of: '
+ 'XML entity with id file:///etc/passwd not permitted')
+
class JobAttributeChangeTest(WebDriverTestCase):
diff --git a/Server/bkr/server/jobs.py b/Server/bkr/server/jobs.py
index 9821ef4..0236675 100644
--- a/Server/bkr/server/jobs.py
+++ b/Server/bkr/server/jobs.py
@@ -38,7 +38,7 @@
from bkr.common.bexceptions import BeakerException, BX
-import xmltramp
+from bkr.server.util import xmltramp\_parse\_untrusted
from bkr.server.jobxml import XmlJob
import cgi
from bkr.server.job\_utilities import Utility
@@ -334,7 +334,7 @@ def upload(self, jobxml, ignore\_missing\_tasks=False):
# xml.sax (and thus, xmltramp) expect raw bytes, not unicode
if isinstance(jobxml, unicode):
jobxml = jobxml.encode('utf8')
- xml = xmltramp.parse(jobxml)
+ xml = xmltramp\_parse\_untrusted(jobxml)
xmljob = XmlJob(xml)
job = self.process\_xmljob(xmljob,identity.current.user,
ignore\_missing\_tasks=ignore\_missing\_tasks)
@@ -390,7 +390,7 @@ def clone(self, job\_id=None, recipe\_id=None, recipeset\_id=None,
options = {'xsd\_errors': job\_schema.error\_log},
value = dict(textxml=textxml, confirmed=True),
)
- xmljob = XmlJob(xmltramp.parse(textxml))
+ xmljob = XmlJob(xmltramp\_parse\_untrusted(textxml))
job = self.process\_xmljob(xmljob,identity.current.user)
session.flush()
except Exception,err:
diff --git a/Server/bkr/server/util.py b/Server/bkr/server/util.py
index 0802f22..cfda061 100644
--- a/Server/bkr/server/util.py
+++ b/Server/bkr/server/util.py
@@ -229,3 +229,24 @@ def convert\_db\_lookup\_error(msg):
yield
except NoResultFound:
raise DatabaseLookupError(msg)
+
+def xmltramp\_parse\_untrusted(s):
+ """
+ Like xmltramp.parse but for untrusted (user-supplied) input.
+ """
+ from StringIO import StringIO
+ import xmltramp
+ from xml.sax import make\_parser
+ from xml.sax.handler import feature\_namespaces
+ class SafeSeeder(xmltramp.Seeder):
+ def resolveEntity(self, publicId, systemId):
+ raise ValueError('XML entity with id %s not permitted' % (publicId or systemId))
+ def skippedEntity(self, name):
+ raise ValueError('Undeclared XML entity &%s;' % name)
+ seeder = SafeSeeder()
+ parser = make\_parser()
+ parser.setFeature(feature\_namespaces, 1)
+ parser.setContentHandler(seeder)
+ parser.setEntityResolver(seeder)
+ parser.parse(StringIO(s))
+ return seeder.result
--
1.9.3


=== Content from beaker-project.org_688b236d_20250126_020712.html ===

[![Beaker](images/logo.png)](.)

[docs](docs/)
[develop](dev/)
[download](download.html)

# Pre-built packages

Server packages are available via yum for Red Hat Enterprise
Linux 6 and 7 (and compatible distros) and Fedora 20+:

[beaker-server-RedHatEnterpriseLinux.repo](yum/beaker-server-RedHatEnterpriseLinux.repo)
[beaker-server-Fedora.repo](yum/beaker-server-Fedora.repo)

Client packages are available via yum for RHEL6, RHEL7 (and corresponding CentOS releases) and
Fedora:

[beaker-client-RedHatEnterpriseLinux.repo](yum/beaker-client-RedHatEnterpriseLinux.repo)
[beaker-client-CentOS.repo](yum/beaker-client-CentOS.repo)
[beaker-client-Fedora.repo](yum/beaker-client-Fedora.repo)

# Source tarballs

Refer to the [archive of all Beaker releases](releases/).

# Git repositories

Beaker’s git repos are hosted on [GitHub](https://github.com/beaker-project).



=== Content from www.openwall.com_8a2ebdf7_20250124_161335.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2015/05/07/10) [[next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <554C3D5C.3070304@redhat.com>
Date: Thu, 07 May 2015 22:36:44 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>
Subject: beaker vulns fixed in version 20.1

So some flaws were found in Beaker and fixed in version 20.1:

<https://beaker-project.org/download.html>

In Red Hat Bugzilla:

CVE-2015-3160 - 1215020 Beaker is vulnerable to "XXE" attacks from
authenticated  users, due to external entity expansion in job XML

CVE-2015-3161 - 1215024 search bar does not escape </script> tags when
producing JSON

CVE-2015-3162 - 1215030 HTML tags in recipe set comments are not escaped
in the "edit comment" dialog

CVE-2015-3163 - 1215034 anonymous users can modify key types and power types

--
Kurt Seifried -- Red Hat -- Product Security -- Cloud
PGP A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

Download attachment "[signature.asc](1/1)" of type "application/pgp-signature" (837 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


