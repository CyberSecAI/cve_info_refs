=== Content from bugzilla.redhat.com_79cd28f6_20250125_070234.html ===
From 4039cf9c8bd394a8d870cb83045f4a68f196f906 Mon Sep 17 00:00:00 2001
From: Dan Callaghan
Date: Wed, 29 Apr 2015 16:41:23 +1000
Subject: [PATCH 2/3] fix remaining usages of turbojson.jsonify.encode to be
HTML-safe
Bug: 1215024
Change-Id: Ibad4e34415be9c7d0c026588f10d8d6dfd7ab1d3
---
.../inttest/server/selenium/test\_system\_search.py | 13 ++++++++++
Server/bkr/server/widgets.py | 28 +++++++++++-----------
2 files changed, 27 insertions(+), 14 deletions(-)
diff --git a/IntegrationTests/src/bkr/inttest/server/selenium/test\_system\_search.py b/IntegrationTests/src/bkr/inttest/server/selenium/test\_system\_search.py
index 15e8e42..d29eca0 100644
--- a/IntegrationTests/src/bkr/inttest/server/selenium/test\_system\_search.py
+++ b/IntegrationTests/src/bkr/inttest/server/selenium/test\_system\_search.py
@@ -543,6 +543,19 @@ def test\_date\_picker(self):
b.find\_element\_by\_id('searchform').submit()
check\_system\_search\_results(b, present=[old\_system], absent=[new\_system])
+ # https://bugzilla.redhat.com/show\_bug.cgi?id=1215024
+ def test\_closing\_script\_tag\_escaped\_in\_search\_bar(self):
+ with session.begin():
+ Key.lazy\_create(key\_name=u'')
+ b = self.browser
+ b.get(get\_server\_base())
+ b.find\_element\_by\_link\_text('Show Search Options').click()
+ wait\_for\_animation(b, '#searchform')
+ Select(b.find\_element\_by\_name('systemsearch-0.table'))\
+ .select\_by\_visible\_text('Key/Value')
+ Select(b.find\_element\_by\_name('systemsearch-0.keyvalue'))\
+ .select\_by\_visible\_text('')
+
class SystemVisibilityTest(WebDriverTestCase):
diff --git a/Server/bkr/server/widgets.py b/Server/bkr/server/widgets.py
index 1ae209c..dc44a91 100644
--- a/Server/bkr/server/widgets.py
+++ b/Server/bkr/server/widgets.py
@@ -8,7 +8,7 @@
from kid import Element
import time
import turbogears as tg
-from turbojson import jsonify
+from bkr.server.stdvars import jsonify\_for\_html
from turbogears.widgets.rpc import RPC
from sqlalchemy import distinct
import re
@@ -176,7 +176,7 @@ class InlineRemoteForm(RPC, InlineForm):
def update\_params(self, d):
super(InlineRemoteForm, self).update\_params(d)
d['form\_attrs']['onSubmit'] = "return !remoteFormRequest(this, '%s', %s);" % (
- d.get("update", ''), jsonify.encode(self.get\_options(d)))
+ d.get("update", ''), jsonify\_for\_html(self.get\_options(d)))
class RadioButtonList(SelectionField):
@@ -306,7 +306,7 @@ def display(self, value=None, \*\*params):
raise ValueError('Missing arguments to %s: %s' %
(self.\_\_class\_\_.\_\_name\_\_, ','.join(dict(missing).keys())))
params['action\_type'] = params.get('action\_type', 'delete')
- params['data'] = jsonify.encode(params['data'])
+ params['data'] = jsonify\_for\_html(params['data'])
return super(DeleteLinkWidgetAJAX, self).display(value, \*\*params)
@@ -686,7 +686,7 @@ def \_\_init\_\_(self, table, search\_controller=None, extra\_selects=None,
self.fields = [table\_field, operation\_field, value\_field]
new\_selects = []
self.extra\_callbacks = {}
- self.search\_object = jsonify.encode(table)
+ self.search\_object = jsonify\_for\_html(table)
if extra\_selects is not None:
new\_class = []
@@ -726,7 +726,7 @@ def \_\_init\_\_(self, table, search\_controller=None, extra\_selects=None,
log.error('Quick searches expects vals as --. The following is incorrect: %s' % (elem))
else:
self.quickly\_searches.append((name, '%s-%s-%s' % (vals[0],vals[1],vals[2])))
- self.date\_picker = jsonify.encode(kw.get('date\_picker',list()) )
+ self.date\_picker = jsonify\_for\_html(kw.get('date\_picker',list()) )
controllers = kw.get('table\_search\_controllers',dict())
self.table\_search\_controllers\_stringified = str(controllers)
self.extra\_callbacks\_stringified = str(self.extra\_callbacks)
@@ -743,7 +743,7 @@ def display(self, value=None, \*\*params):
json\_this = {}
for elem in params['options']['result\_columns']:
json\_this.update({elem : 1})
- params['default\_result\_columns'] = jsonify.encode(json\_this)
+ params['default\_result\_columns'] = jsonify\_for\_html(json\_this)
else:
params['default\_result\_columns'] = 'null'
if 'col\_options' in params['options']:
@@ -1152,7 +1152,7 @@ def update\_params(self, d):
if d['recipe']:
d['hidden\_fields'].append(HiddenField(name='recipe\_id', attrs={'value' : d['recipe'].id}))
d['submit'].attrs.update({'onClick' : "return ! system\_action\_remote\_form\_request('%s', %s, '%s');" % (
- d['options']['name'], jsonify.encode(self.get\_options(d)), d['action'])})
+ d['options']['name'], jsonify\_for\_html(self.get\_options(d)), d['action'])})
class RecipeActionWidget(CompoundWidget):
@@ -1220,8 +1220,8 @@ def update\_params(self, d):
d['attrs']['class'] = 'input-block-level'
d['attrs']['onchange'] = "ProductChange('%s',%s, %s)" % (
url(d.get('action')),
- jsonify.encode({'id': d.get('job\_id')}),
- jsonify.encode(self.get\_options(d)),
+ jsonify\_for\_html({'id': d.get('job\_id')}),
+ jsonify\_for\_html(self.get\_options(d)),
)
class RetentionTagWidget(SingleSelectField, RPC): #FIXME perhaps I shoudl create a parent that both Retention and Priority inherit from
@@ -1247,8 +1247,8 @@ def update\_params(self, d):
d['attrs']['id'] = 'job\_retentiontag'
d['attrs']['onchange'] = "RetentionTagChange('%s',%s, %s)" % (
url(d.get('action')),
- jsonify.encode({'id': d.get('job\_id')}),
- jsonify.encode(self.get\_options(d)),
+ jsonify\_for\_html({'id': d.get('job\_id')}),
+ jsonify\_for\_html(self.get\_options(d)),
)
@@ -1309,7 +1309,7 @@ class JobWhiteboard(RPC, CompoundWidget):
def update\_params(self, d):
super(JobWhiteboard, self).update\_params(d)
d['form\_attrs']['onsubmit'] = "return !remoteFormRequest(this, null, %s);" % (
- jsonify.encode(self.get\_options(d)))
+ jsonify\_for\_html(self.get\_options(d)))
class TaskActionWidget(RPC):
@@ -1334,8 +1334,8 @@ def update\_params(self, d):
super(TaskActionWidget, self).update\_params(d)
d['task\_details']['onclick'] = "TaskDisable('%s',%s, %s); return false;" % (
d.get('action'),
- jsonify.encode({'t\_id': d['task\_details'].get('t\_id')}),
- jsonify.encode(self.get\_options(d)),
+ jsonify\_for\_html({'t\_id': d['task\_details'].get('t\_id')}),
+ jsonify\_for\_html(self.get\_options(d)),
)
class JobActionWidget(CompoundWidget):
--
1.9.3


=== Content from www.openwall.com_8a2ebdf7_20250125_070231.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2015/05/07/10) [[next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <554C3D5C.3070304@redhat.com>
Date: Thu, 07 May 2015 22:36:44 -0600
From: Kurt Seifried <kseifried@...hat.com>
To: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>
Subject: beaker vulns fixed in version 20.1

So some flaws were found in Beaker and fixed in version 20.1:

<https://beaker-project.org/download.html>

In Red Hat Bugzilla:

CVE-2015-3160 - 1215020 Beaker is vulnerable to "XXE" attacks from
authenticated  users, due to external entity expansion in job XML

CVE-2015-3161 - 1215024 search bar does not escape </script> tags when
producing JSON

CVE-2015-3162 - 1215030 HTML tags in recipe set comments are not escaped
in the "edit comment" dialog

CVE-2015-3163 - 1215034 anonymous users can modify key types and power types

--
Kurt Seifried -- Red Hat -- Product Security -- Cloud
PGP A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993

Download attachment "[signature.asc](1/1)" of type "application/pgp-signature" (837 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from beaker-project.org_688b236d_20250126_070416.html ===

[![Beaker](images/logo.png)](.)

[docs](docs/)
[develop](dev/)
[download](download.html)

# Pre-built packages

Server packages are available via yum for Red Hat Enterprise
Linux 6 and 7 (and compatible distros) and Fedora 20+:

[beaker-server-RedHatEnterpriseLinux.repo](yum/beaker-server-RedHatEnterpriseLinux.repo)
[beaker-server-Fedora.repo](yum/beaker-server-Fedora.repo)

Client packages are available via yum for RHEL6, RHEL7 (and corresponding CentOS releases) and
Fedora:

[beaker-client-RedHatEnterpriseLinux.repo](yum/beaker-client-RedHatEnterpriseLinux.repo)
[beaker-client-CentOS.repo](yum/beaker-client-CentOS.repo)
[beaker-client-Fedora.repo](yum/beaker-client-Fedora.repo)

# Source tarballs

Refer to the [archive of all Beaker releases](releases/).

# Git repositories

Beaker’s git repos are hosted on [GitHub](https://github.com/beaker-project).



=== Content from bugzilla.redhat.com_9b36ccd9_20250125_070236.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1215024)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1215024)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1215024)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1215024

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1215024**](show_bug.cgi?id=1215024)
(CVE-2015-3161)
- search bar does not escape </script> tags when producing JSON

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
search bar does not escape </script> tags when producing JSON

| | [Keywords](describekeywords.cgi): | Patch  Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED CURRENTRELEASE | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2015-3161 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Beaker | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Retired | | [Component:](describecomponents.cgi?product=Beaker "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | general | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 19 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | unspecified | | [Severity:](page.cgi?id=fields.html#bug_severity) | unspecified | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | 20.1 | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Dan Callaghan | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | tools-bugs | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1215894](show_bug.cgi?id=1215894) | | TreeView+ | [depends on](buglist.cgi?bug_id=1215024&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1215024&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2015-04-24 07:13 UTC by Dan Callaghan | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2018-02-06 00:41 UTC ([History](show_activity.cgi?id=1215024)) | | [CC List:](page.cgi?id=fields.html#cclist) | 18 users (show)  aigao asaha dcallagh dowang ebaak huiwang ineilsen jskeoch junichi.nomura kueda lzhuang mjia naoya.horiguchi pen-test rpotts security-response-team tatsu-ab1 tflink | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2015-05-08 04:05:56 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**proposed patch**](attachment.cgi?id=1020004 "View the content of the attachment") (6.90 KB, patch)  [2015-04-29 07:21 UTC](#attach_1020004 "Go to the comment associated with the attachment"), Dan Callaghan | *no flags* | [Details](attachment.cgi?id=1020004&action=edit) | [Diff](attachment.cgi?id=1020004&action=diff) | | [View All](attachment.cgi?bugid=1215024&action=viewall) | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1215024#c0)  Dan Callaghan    2015-04-24 07:13:06 UTC  ``` Description of problem: The search bar code for emitting the "search object" onto the page (JS object defining all possible search fields, operations, and values) does not correctly escape </script> tags appearing in string literals.  If the admin defines a key type or arch containing </script>... it will appear unescaped in the page.  Basically a dupe of [bug 1209736](show_bug.cgi?id=1209736) because the search bar code is not using tg.to_json like everything else.  Version-Release number of selected component (if applicable): affects all Beaker versions since 2011 or earlier  How reproducible: with admin access  Steps to Reproduce: 1. As an admin, add a key type: <script>alert('xss')</script> 2. Go to the systems page  Actual results: 'xss' alert appears. </script> is unescaped inside the JS string literal.  Expected results: </script> is escaped correctly.   ```  [Comment 1](show_bug.cgi?id=1215024#c1)  Dan Callaghan    2015-04-29 07:21:59 UTC  ``` Created [attachment 1020004](attachment.cgi?id=1020004&action=diff "proposed patch") [[details]](attachment.cgi?id=1020004&action=edit "proposed patch") proposed patch   ```  [Comment 4](show_bug.cgi?id=1215024#c4)  Hui Wang    2015-05-04 06:44:21 UTC  ``` Verified this issue. The result is PASS. Version: Beaker 20.1.git.5.24dc482   ```  [Comment 5](show_bug.cgi?id=1215024#c5)  Dan Callaghan    2015-05-08 04:05:56 UTC  ``` Beaker 20.1 has been released.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1215024&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)


