=== Content from codex.wordpress.org_22980461_20250124_234553.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Documentation](https://wordpress.org/documentation)

Version 4.1.2

* [WordPress Overview](https://wordpress.org/documentation/overview/)
* [Technical Guides](https://wordpress.org/documentation/technical-guides/)
* [Support Guides](https://wordpress.org/documentation/support-guides/)
* [Customization](https://wordpress.org/documentation/customization/)
* [Get Involved](https://make.wordpress.org/docs/)

* [WordPress Overview](https://wordpress.org/documentation/overview/)
* [Technical Guides](https://wordpress.org/documentation/technical-guides/)
* [Support Guides](https://wordpress.org/documentation/support-guides/)
* [Customization](https://wordpress.org/documentation/customization/)
* [Get Involved](https://make.wordpress.org/docs/)

[Home](https://wordpress.org/documentation)Version 4.1.2

Search documentation

# Version 4.1.2

## In this article

Table of Contents

* [Installation/Update Information](#installation-update-information)
* [Summary](#summary)
* [List of Files Revised](#list-of-files-revised)

[↑ Back to top](#wp--skip-link--target)

On April 21, 2015, WordPress 4.1.2 was released to the public. This is a security update for all previous WordPress versions.

## [Installation/Update Information](#installation-update-information)

To download WordPress 4.1.2, update automatically from the Dashboard > Updates menu in your site’s admin area or visit <https://wordpress.org/download/release-archive/>.

For step-by-step instructions on installing and updating WordPress:

* [Updating WordPress](https://wordpress.org/documentation/article/updating-wordpress/)

If you are new to WordPress, we recommend that you begin with the following:

* [New To WordPress – Where to Start](/support/article/new_to_wordpress_-_where_to_start/)
* [First Steps With WordPress](/support/article/first-steps-with-wordpress/) or [Upgrading WordPress Extended](https://wordpress.org/documentation/article/upgrading-wordpress-extended-instructions/)
* [WordPress Lessons](/support/article/wordpress-lessons/)

## [Summary](#summary)

From the [announcement post](https://wordpress.org/news/2015/04/wordpress-4-1-2/):

* A serious critical cross-site scripting vulnerability, which could enable anonymous users to compromise a site.
* Files with invalid or unsafe names could be uploaded.
* Some plugins are vulnerable to an SQL injection attack.
* A very limited cross-site scripting vulnerability could be used as part of a social engineering attack.
* Four hardening changes, including better validation of post titles within the Dashboard.

## [List of Files Revised](#list-of-files-revised)

```
readme.html
wp-admin/includes/class-wp-comments-list-table.php
wp-admin/includes/dashboard.php
wp-admin/includes/template.php
wp-admin/js/nav-menu.js
wp-includes/capabilities.php
wp-includes/class-wp-editor.php
wp-includes/formatting.php
wp-includes/functions.php
wp-includes/js/plupload/plupload.flash.swf
wp-includes/version.php
wp-includes/wp-db.php
```

First published

March 13, 2019

Last updated

## Get more help

[Support forums](https://wordpress.org/support/forums/)

Ask questions in the support forums.

[Developers](https://developer.wordpress.org/)

Check out the developer documentation.

[Content suggestions](https://github.com/WordPress/Documentation-Issue-Tracker/issues)

Report an error or change in the documentation issue tracker.

[Get involved](https://make.wordpress.org/docs/)

Learn about the Documentation Team and how to contribute.

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.debian.org_a9a7d872_20250124_234556.html ===


---

[[Date Prev](msg00137.html)][[Date Next](msg00139.html)]
[[Thread Prev](msg00137.html)][[Thread Next](msg00139.html)]
[[Date Index](maillist.html#00138)]
[[Thread Index](threads.html#00138)]

# [SECURITY] [DSA 3250-1] wordpress security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3250-1] wordpress security update
* *From*: Alessandro Ghedini <ghedo@debian.org>
* *Date*: Mon, 04 May 2015 20:50:54 +0200
* *Message-id*: <[[🔎]](/msgid-search/20150504185100.AAE48CB%40bendel.debian.org) [20150504185100.AAE48CB@bendel.debian.org](msg00138.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3250-1                   security@debian.org
<http://www.debian.org/security/>                        Alessandro Ghedini
May 04, 2015                           <http://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : wordpress
CVE ID         : CVE-2015-3438 CVE-2015-3439 CVE-2015-3440
Debian Bug     : 783347 783554

Multiple security issues have been discovered in Wordpress, a weblog
manager, that could allow remote attackers to upload files with invalid
or unsafe names, mount social engineering attacks or compromise a site
via cross-site scripting, and inject SQL commands.

More information can be found in the upstream advisories at
<https://wordpress.org/news/2015/04/wordpress-4-1-2/> and
<https://wordpress.org/news/2015/04/wordpress-4-2-1/>

For the oldstable distribution (wheezy), these problems have been fixed
in version 3.6.1+dfsg-1~deb7u6.

For the stable distribution (jessie), these problems have been fixed in
version 4.1+dfsg-1+deb8u1.

For the testing distribution (stretch), these problems have been fixed in
version 4.2.1+dfsg-1.

For the unstable distribution (sid), these problems have been fixed in
version 4.2.1+dfsg-1.

We recommend that you upgrade your wordpress packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCgAGBQJVR7+OAAoJEK+lG9bN5XPL7YgP/0kHKf4aTa4H/XlOy9L7/Oqz
IKaG69pbpzAN0ulrFt/flIWWN//SHzoY8jOfIZnrm4pnsDd6O2qS4TpTGa/911KQ
IEBhEuGsNrkSEjQZDW/NHsf1cdhTf3O3yWrtFMnaQSW2ksZnJb0GlgpSY1y/9bGH
AQWxhL6moG/ILO3e1j4gdr4bMKNBC1p1RK2+b7PQROQjdWjtdRCUKeDCpK9Qdt3P
bO/DaRdO07RjX4h92ozxKIpvsTfTaxlPDwFm2Sn2SSpkLS507QGDHdEkI2hu4Fj3
qT+BjSxPbqt767AlibehtoqF7UPz9zw6J06Wg37YBHTBWit1s6MO8K9y65B5ZO0a
pdRGjoaUprnGNvskaGXLPb80lASNQQ0m6aMdmbHgvzfTtPDG0MpNxLvCxpR5rLc+
z6YClWL+GzKHxKfpU0m8iC/0UnxrGsJ6jsYqElbDDoIf5ztrrJov6m5xpoME7vsS
9jaE4F1YWrhluNGTp4pAa/x78FLNOdVaDs/lPQ0f1dmq6EI1GaD9iuUp4XEANo76
SM0vjnzJ2Jo0kakcHiHbt7YX2tQilkrAkIMYAzDew1jtkvofLxW9jbeJ9NDWE5Hb
2d1mIvlRTRBFIMCS+5M83TSiIFeNOe7DjK19KTAYSAiLYf8LXuGWB2Y/eZF2j3Bq
RKxnRPe6EBh+NRIvZyaa
=nORs
-----END PGP SIGNATURE-----

```

---



=== Content from cedricvb.be_7ae97651_20250124_234602.html ===


# [Cedric’s Cruft](/)

* [Blog](/)

Select a page ↵
Blog

[![](/wp-content/themes/StrictOne/framework/assets/images/icons/18/social/color/GitHub.png "GitHub")](https://github.com/c3c)
[![](/wp-content/themes/StrictOne/framework/assets/images/icons/18/social/color/LinkedIn.png "LinkedIn")](https://www.linkedin.com/in/cedricvb)
[![](/wp-content/themes/StrictOne/framework/assets/images/icons/18/social/color/Twitter.png "Twitter")](https://twitter.com/c3c)

Browse: [Home](/ "Cedric's Cruft") > WordPress up to version 4.1.2 Stored XSS vulnerability

## WordPress up to version 4.1.2 Stored XSS vulnerability

*WordPress 4.1.2 is available as of April 21, 2015. WordPress versions 4.1.1 and earlier are affected by a critical cross-site scripting vulnerability, which could enable anonymous users to compromise a site ([WP blog](https://wordpress.org/news/2015/04/wordpress-4-1-2/)).*

*tldr; mysql → special characters → truncation → input validation → output sanitisation → xss → time to update WordPress.*

#### Introduction: MySQL strict mode

Early this last year, I was reading a blog post about how MySQL’s [utf8](https://dev.mysql.com/doc/refman/5.5/en/charset-unicode-utf8.html) charsets only support 3-byte characters. I recommend reading [the article](https://mathiasbynens.be/notes/mysql-utf8mb4) if you like PILE OF POOs (by which I mean the character of course). In short: a character that is encoded in UTF-8 can technically be between one and four bytes in length as per [RFC3629](http://tools.ietf.org/html/rfc3629). You would need a [utf8mb4](https://dev.mysql.com/doc/refman/5.5/en/charset-unicode-utf8mb4.html) charset if you’d actually want to store 4-byte characters.

When you insert a string containing a 4-byte character into a utf8 column, the default MySQL behaviour is to **truncate** the rest of the string after (and including) the occurence of the 4-byte character. This is prevented by using MySQL’s [strict mode](https://dev.mysql.com/doc/refman/5.0/en/sql-mode.html#sql-mode-strict) which ensures that the data is valid before it gets stored.

> Strict mode controls how MySQL handles invalid or missing values in data-change statements such as INSERT or UPDATE. A value can be invalid for several reasons. For example, it might have the wrong data type for the column, or it might be out of range.
> If strict mode is not in effect, MySQL inserts adjusted values for invalid or missing values and produces warnings.

The adjusted value in this case is the truncated string. I should mention that MySQL displays this truncation behaviour not only for 4-byte characters, but also invalid byte sequences for all character sets, which means that utf8mb4 is just as vulnerable, as well as more exotic charsets. The only exception is latin1, which accepts just about anything. To prevent these truncations issues, you would have to enable MySQL strict mode manually when establishing a connection to the MySQL server, as it is not enabled by default.

* Example (before insert): ex𝌆tic
* Example (after insert): ex

I was wondering how this knowledge could be used as a possible attack vector. The behaviour of MySQL when it is not in strict mode reminded me a lot of null-byte vulnerabilities that popped up in the past. [Things](https://bugs.php.net/bug.php?id=39863) [go](http://hakipedia.com/index.php/Poison_Null_Byte) [wrong](http://www.mantisbt.org/bugs/view.php?id=17640) when data truncation is in play.

#### How this affects WordPress

I started picking web applications which would be my victims to try this behaviour on. Some projects enabled MySQL strict mode when establishing the database connection. WordPress did not have strict mode enabled. Perfect.

I did not have to look far. WordPress’s core comment functionality appeared to truncate my crafted strings! By default, placing comments is handled in the WP core, although plug-ins such as Disqus can replace this functionality.

Additionally, you are allowed use a limited set of HTML tags in your comments: <a href="" title=""> <abbr title=""> <acronym title=""> <b> <blockquote cite=""> <cite> <code> <del datetime=""> <em> <i> <q cite=""> <strike> <strong>

* A nice user could comment: <abbr title='Web log'>blog!</abbr>
* A not so nice user could comment: <abbr title='Web𝌆log'>blog!</abbr>

Both comments pass through the input validator of WordPress, but only the first one gets stored correctly. The second one is stored as <abbr title='Web. This comment effectively breaks the well-formedness of the HTML page, since the closing quote and tag token are not there.

Now imagine what would happen if you made another comment under a crafted username such as:
cedric' onmouseover='alert(1)' style='position:fixed;top:0;left:0;width:100%;height:100%'

After successful submission of both comments, the HTML output would look as follows:

XHTML

<div class="comment" id="comment-1">
<div class="comment-author">
Testing
</div>
<div class="comment-content">
<p>
<abbr title='Web
</p>
</div>
<div class="comment" id="comment-2">
<div class="comment-author">
cedric' onmouseover='alert(1)' style='position:fixed;top:0;left:0;width:100%;height:100%'
</div>
<div class="comment-content">
<p>
Injected
</p>
<div>
</div>

| 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 | <div class="comment" id="comment-1">      <div class="comment-author">          Testing     </div>      <div class="comment-content">          <p>              <abbr title='Web          </p>     </div> <div class="comment" id="comment-2">     <div class="comment-author">         cedric' onmouseover='alert(1)' style='position:fixed;top:0;left:0;width:100%;height:100%'      </div>      <div class="comment-content">          <p>              Injected         </p>      <div>  </div> |
| --- | --- |

You get the following HTML as a result:

XHTML

<abbr title='Web......cedric' onmouseover='alert(1)' style='position:fixed;top:0;left:0;width:100%;height:100%'>

| 1 | <abbr title='Web......cedric' onmouseover='alert(1)' style='position:fixed;top:0;left:0;width:100%;height:100%'> |
| --- | --- |

This piece of code will effectively result in script execution as soon as the victim hovers the element. This technique works only when there are no other single quotes between the comment text and the author name, and is thus dependent on the current WordPress theme.

##### Output sanitisation

Now, if the above was too difficult, there appears to be another way. As long as your comment contains a newline, some sort of output sanitisation will happen which will replace the quote character with &#8220;.

This means that submitting the following payload would be enough:

XHTML

sometext
<blockquote cite='x onmouseover=alert(1) 𝌆'>

| 1 2 | sometext <blockquote cite='x onmouseover=alert(1) 𝌆'> |
| --- | --- |

We now have script execution that is no longer dependent on the current WordPress theme since quotes get escaped.

XHTML

<blockquote cite=&#8220;x onmouseover=alert(1) ...>

| 1 | <blockquote cite=&#8220;x onmouseover=alert(1) ...> |
| --- | --- |

Payload screenshot:

[![wpxss](https://cedricvb.be/wp-content/uploads/2015/04/wpxss.png)](https://cedricvb.be/wp-content/uploads/2015/04/wpxss.png)

Payloads can be crafted in a way that they are invisible to the victim. When the victim now reaches the comments page, script execution will occur. As a proof of concept, I created a payload that adds a new user to the adminstration panel, meaning you need an administrator to visit the injected comment page. The same could be done to download and install a plug-in that executes malicious server-side code. I will not share the PoC right now as it got lost (see below…).

#### Some limiting factors

The vulnerability only affects certain character sets. If you’re using the latin1 charset for columns in your database, you are likely to be safe. However, utf8 was the default in WordPress, which has now changed to utf8mb4 and has [several advantages](https://core.trac.wordpress.org/ticket/21212).

It’s worth noting that in the default setup, comments need approval from the admin.
Although (also by default), when your first comment gets approved, you won’t need approval for your next comment 😉
This leaves ample opportunity to first convince the admin that you are prim and proper, and then go scriptkiddy on him.

Be aware that data truncation not only affects the comment functionality but really all of the WordPress core and plug-ins. You should upgrade your WordPress version either way. Many other yet undiscovered attack vectors may exist because of this. For instance, while writing this blog post, I accidentally truncated half of the post by inserting an invalid byte sequence *\*sigh\**.

#### Fixing this issue

Fixing this issue was a long process. As it affected the WordPress core at the database layer, the fix had to be tested thoroughly to make sure that websites in all kinds of set-ups would still work as expected, regardless of the charset they are using. WordPress is written to work on any system that has PHP and a webserver, regardless of installed features. As a consequence, installing WordPress is a breeze, but development requires the introduction of complex cases to ensure (backwards-) compatibility. Tests were done to see if it was possible to enable strict mode in WordPress, but this was [reverted](https://github.com/WordPress/WordPress/commit/8990b1c1fc09afe8e40b588c78337c30914430ac) later on because it broke compatibility with too many plug-ins.

Bits and pieces of the patched code were being pushed to the VCS trunk as soon as October 2014. Meaning that it is unlikely that you can conduct a successful XSS on version 4.1.1, the previous WordPress version.

I believe a lot of websites were vulnerable for this stored XSS vulnerability. The Forbes website mentions that there were [60 million WordPress websites](http://www.forbes.com/sites/jjcolao/2012/09/05/the-internets-mother-tongue/) in 2012, and that number is increasing each day. If only one out of 60 is vulnerable, then still more than a million websites are open for exploitation. Thankfully, WordPress has an auto-update mechanism in place, so you are probably already patched up by now if you’re a blog owner.

I’d like to thank Andrew Nacin, Gary Pendergast and Mike Adams from the WordPress team, and everyone else who worked on patching this issue. I hope to see some more details on the patching process from their side on the WordPress blog or at a conference in the future.

##### Timeline

| 23 Feb 2014 | Responsible disclosure to WP team |
| --- | --- |
| 31 Mar 2014 | Issue acknowleged |
| 7 May 2014 | Initial patch received from WP team |
| 6 Sep 2014 | More details sent to WP team |
| 20 Oct 2014 | Things are happening in the background |
| 20 Feb 2015 | More things are happening in the background |
| 21 April 2015 | WordPress 4.1.2 security release |
| 23 April 2015 | Blog post made public |

[Reverse engineering the HITB binary 100 CTF challenge](/post/reverse-engineering-the-hitb-binary-100-ctf-challenge/ "Previous")[SECCON 2015 - Reverse engineering Android APK 2 - 400 writeup](/post/seccon-2015-reverse-engineering-android-apk-2-400-writeup/ "Next")

[![](https://secure.gravatar.com/avatar/9645d67a0d90d6154928ba9062077d22?s=110&d=mm&r=g)](/post/author/cedric/)
##### cedric

[Uncategorized](/post/category/uncategorized/)

9 Apr 2015

##### Recent Posts

* [Adding an external hard drive to the Unifi Cloud Key Gen2 Plus](/post/adding-an-external-hard-drive-to-the-unifi-cloud-key-gen2-plus/)
* [Tracing API calls in Burp with Frida](/post/tracing-api-calls-in-burp-with-frida/)
* [SANS Holiday Hack Challenge 2015 writeup](/post/sans-holiday-hack-challenge-2015-writeup/)
* [SECCON 2015 – Reverse engineering Android APK 2 – 400 writeup](/post/seccon-2015-reverse-engineering-android-apk-2-400-writeup/)
* [WordPress up to version 4.1.2 Stored XSS vulnerability](/post/wordpress-stored-xss-vulnerability-4-1-2/)

##### Recent Comments

##### Archives

* [February 2022](/post/2022/02/)
* [January 2017](/post/2017/01/)
* [January 2016](/post/2016/01/)
* [December 2015](/post/2015/12/)
* [April 2015](/post/2015/04/)
* [June 2014](/post/2014/06/)
* [December 2013](/post/2013/12/)

© 2013-2022 Cedric Van Bockhaven



=== Content from wordpress.org_a26d2d47_20250124_234603.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[News](https://wordpress.org/news)

WordPress 4.1.2 Security Release

All posts

Search results

* Categories
  + [All Posts](https://wordpress.org/news/all-posts/)
  + [Awards](https://wordpress.org/news/category/awards/)
  + [Community](https://wordpress.org/news/category/community/)
  + [Design](https://wordpress.org/news/category/design/)
  + [Development](https://wordpress.org/news/category/development/)
  + [Documentation](https://wordpress.org/news/category/documentation/)
  + [Events](https://wordpress.org/news/category/events/)
  + [Features](https://wordpress.org/news/category/features/)
  + [General](https://wordpress.org/news/category/general/)
  + [Interviews](https://wordpress.org/news/category/interviews/)
  + [Meta](https://wordpress.org/news/category/meta/)
  + [Month in WordPress](https://wordpress.org/news/category/month-in-wordpress/)
  + [Performance](https://wordpress.org/news/category/performance/)
  + [Podcast](https://wordpress.org/news/podcast/)
  + [Releases](https://wordpress.org/news/category/releases/)
  + [Security](https://wordpress.org/news/category/security/)
  + [Store](https://wordpress.org/news/category/store/)
  + [Testing](https://wordpress.org/news/category/testing/)
  + [Updates](https://wordpress.org/news/category/updates/)
  + [WordCamp](https://wordpress.org/news/category/wordcamp/)

* Categories
  + [All Posts](https://wordpress.org/news/all-posts/)
  + [Awards](https://wordpress.org/news/category/awards/)
  + [Community](https://wordpress.org/news/category/community/)
  + [Design](https://wordpress.org/news/category/design/)
  + [Development](https://wordpress.org/news/category/development/)
  + [Documentation](https://wordpress.org/news/category/documentation/)
  + [Events](https://wordpress.org/news/category/events/)
  + [Features](https://wordpress.org/news/category/features/)
  + [General](https://wordpress.org/news/category/general/)
  + [Interviews](https://wordpress.org/news/category/interviews/)
  + [Meta](https://wordpress.org/news/category/meta/)
  + [Month in WordPress](https://wordpress.org/news/category/month-in-wordpress/)
  + [Performance](https://wordpress.org/news/category/performance/)
  + [Podcast](https://wordpress.org/news/podcast/)
  + [Releases](https://wordpress.org/news/category/releases/)
  + [Security](https://wordpress.org/news/category/security/)
  + [Store](https://wordpress.org/news/category/store/)
  + [Testing](https://wordpress.org/news/category/testing/)
  + [Updates](https://wordpress.org/news/category/updates/)
  + [WordCamp](https://wordpress.org/news/category/wordcamp/)

April 21, 2015
By [Gary Pendergast](https://profiles.wordpress.org/pento/)
in [Releases](https://wordpress.org/news/category/releases/), [Security](https://wordpress.org/news/category/security/)
# WordPress 4.1.2 Security Release

---

WordPress 4.1.2 is now available. This is a **critical security release** for all previous versions and we strongly encourage you to update your sites immediately.

WordPress versions 4.1.1 and earlier are affected by a critical cross-site scripting vulnerability, which could enable anonymous users to compromise a site. This was reported by [Cedric Van Bockhaven](https://cedricvb.be) and fixed by [Gary Pendergast](http://pento.net/), [Mike Adams](http://blogwaffe.com/), and [Andrew Nacin](http://nacin.com/) of the WordPress security team.

We also fixed three other security issues:

* In WordPress 4.1 and higher, files with invalid or unsafe names could be uploaded. Discovered by [Michael Kapfer and Sebastian Kraemer of HSASec](http://HSASec.de).
* In WordPress 3.9 and higher, a very limited cross-site scripting vulnerability could be used as part of a social engineering attack. Discovered by [Jakub Zoczek](http://zoczus.blogspot.com/).
* Some plugins were vulnerable to an SQL injection vulnerability. Discovered by Ben Bidner of the WordPress security team.

We also made four hardening changes, discovered by [J.D. Grimes](http://codesymphony.co/), Divyesh Prajapati, [Allan Collins](http://www.allancollins.net/), [Marc-Alexandre Montpas](https://sucuri.net/) and [Jeff Bowen](https://profiles.wordpress.org/jblz/).

We appreciated the [responsible disclosure](https://make.wordpress.org/core/handbook/reporting-security-vulnerabilities/) of these issues directly to our security team. For more information, see the [release notes](https://codex.wordpress.org/Version_4.1.2) or consult the [list of changes](https://core.trac.wordpress.org/log/branches/4.1?rev=32234&stop_rev=32144).

[Download WordPress 4.1.2](https://wordpress.org/download/) or venture over to **Dashboard → Updates** and simply click “Update Now.” Sites that support automatic background updates are already beginning to update to WordPress 4.1.2.

Thanks to everyone who contributed to 4.1.2: [Allan Collins](https://profiles.wordpress.org/collinsinternet/), [Alex Concha](https://profiles.wordpress.org/xknown/), [Andrew Nacin](https://profiles.wordpress.org/nacin/), [Andrew Ozz](https://profiles.wordpress.org/azaozz/), [Ben Bidner](https://profiles.wordpress.org/vortfu/), [Boone Gorges](https://profiles.wordpress.org/boonbgorges/), [Dion Hulse](https://profiles.wordpress.org/dd32/), [Dominik Schilling](https://profiles.wordpress.org/ocean90/), [Drew Jaynes](https://profiles.wordpress.org/DrewAPicture/), [Gary Pendergast](https://profiles.wordpress.org/pento/), [Helen Hou-Sandí](https://profiles.wordpress.org/helen/), [John Blackbourn](https://profiles.wordpress.org/johnbillion/), and [Mike Adams](https://profiles.wordpress.org/mdawaffe/).

A number of plugins also released security fixes yesterday. Keep everything updated to stay secure. If you’re a plugin author, please read [this post](https://make.wordpress.org/plugins/2015/04/20/fixing-add_query_arg-and-remove_query_arg-usage/) to confirm that your plugin is not affected by the same issue. Thank you to all of the plugin authors who worked closely with our security team to ensure a coordinated response.

*Already testing WordPress 4.2? The third release candidate is now available ([zip](https://wordpress.org/wordpress-4.2-RC3.zip)) and it contains these fixes. For more on 4.2, see [the RC 1 announcement post](https://wordpress.org/news/2015/04/wordpress-4-2-release-candidate/).*

Share this:

* [Threads](https://wordpress.org/news/2015/04/wordpress-4-1-2/?share=threads&nb=1)
* [Mastodon](https://wordpress.org/news/2015/04/wordpress-4-1-2/?share=mastodon&nb=1)
* [Bluesky](https://wordpress.org/news/2015/04/wordpress-4-1-2/?share=bluesky&nb=1)
* [X](https://wordpress.org/news/2015/04/wordpress-4-1-2/?share=x&nb=1)
* [Facebook](https://wordpress.org/news/2015/04/wordpress-4-1-2/?share=facebook&nb=1)
* [LinkedIn](https://wordpress.org/news/2015/04/wordpress-4-1-2/?share=linkedin&nb=1)

---

[Previous WordPress 4.2 Release Candidate](https://wordpress.org/news/2015/04/wordpress-4-2-release-candidate/)
[Next WordPress 4.2 “Powell”](https://wordpress.org/news/2015/04/powell/)

## Get the Latest Updates

### Subscribe to WordPress News

Email Address

Subscribe

Join 18.7K other subscribers

### WP Briefing — The WordPress Podcast

Learn about where WordPress is going and how you can get involved.

* [Apple Podcasts](https://podcasts.apple.com/us/podcast/wp-briefing/id1551691710)
* [Pocket Casts](https://pca.st/uqvvmt8t)
* [RSS](https://wordpress.org/news/feed/podcast)
* [Spotify](https://open.spotify.com/show/6BxgmE9Qg2TZA8EKZLJ4zS)
* [Stitcher](https://www.stitcher.com/show/wp-briefing)

[Listen to all episodes](https://wordpress.org/news/podcast/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


