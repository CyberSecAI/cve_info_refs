### Relevant Content:
The provided content relates to CVE-2015-3238.

**Root cause of vulnerability:**
The `_unix_run_helper_binary` function in the `pam_unix` module of Linux-PAM could become unresponsive due to writing to a blocking pipe with a limited capacity. When a long password (65536+ bytes on a system with 4K pages) was provided to the authentication process, the `write(2)` call would block indefinitely as the pipe's capacity was exceeded. This occurs because the helper function tries to write the length of the password plus one byte to the blocking pipe.

**Weaknesses/vulnerabilities present:**
- Denial of Service (DoS) vulnerability due to the blocking write operation.
- Username enumeration, as an attacker could determine valid usernames based on whether the system hangs or responds to the authentication attempt with an extremely large password.
- The vulnerability is located in the `_unix_run_helper_binary` function of the `pam_unix` module.

**Impact of exploitation:**
- An attacker could cause a denial of service by supplying an overly long password during authentication, making the system unresponsive.
- An attacker could use the DoS behavior to enumerate valid user accounts by observing whether the authentication process hangs or returns an error.

**Attack vectors:**
- A local attacker can exploit this vulnerability by attempting authentication with a password longer than the pipe's capacity (65536 bytes on systems with 4KB pages).
- The attack requires an interface or method to provide this long password string to the vulnerable function.

**Required attacker capabilities/position:**
- The attacker must have local or possibly remote access to a system that utilizes the vulnerable Linux-PAM version and module.
- The attacker does not require root access.
- The attacker must be able to initiate the authentication process and provide a password of sufficient length to trigger the vulnerability.
- When SELinux is enabled, the `_unix_run_helper_binary` function is called when the process executing the authentication is not privileged enough to check the password.

**Additional Details:**
- The fix implemented limits the verifiable password length to `PAM_MAX_RESP_SIZE` bytes (512 bytes), preventing the write call to ever block.
- An alternative, more complex fix would be to temporarily ignore `SIGPIPE` and check for a failed/short write, but was considered too complex for a security fix.
- The similar issue was present in the code implementing `pam_exec expose_authtok` option and `pam_unix_passwd.c`, but its security implication was not clear.
- This vulnerability was reported by Sebastien Macke of Trustwave SpiderLabs.

**Affected Packages:**
- libpam-modules prior to version 1.2.1 (Ubuntu, RedHat).