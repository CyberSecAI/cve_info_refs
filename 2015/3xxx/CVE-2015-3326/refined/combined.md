=== Content from blog.malerisch.net_1dcc5ab9_20250125_084003.html ===

[Skip to main content](#main)

# [malerisch.net](http://blog.malerisch.net/)

Security research, divulgations and food for thought.

Search

### Search This Blog

### Pages

* [Home](http://blog.malerisch.net/)
* [Security Research](http://blog.malerisch.net/p/security-research.html)
* [Advisories](http://blog.malerisch.net/p/advisories.html)
* [Presentations](http://blog.malerisch.net/p/presentations.html)
* [White Papers](http://blog.malerisch.net/p/white-papers.html)
* [Tools](http://blog.malerisch.net/p/tools.html)
* [Videos](https://www.youtube.com/user/malerischnet)

More…

### TrendMicro ScanMail for Microsoft Exchange (SMEX) predictable session token - CVE-2015-3326

[May 20, 2016](http://blog.malerisch.net/2016/05/trendmicro-smex-session-predictable-cve-2015-3326.html "permanent link")

It's time for another advisory ([CVE-2015-3326](http://www.cvedetails.com/cve/CVE-2015-3326/)), a simple one, for a vulnerability which can be found quickly and trivially. For those of you who just want to give a glance at the post, I suggest to directly watch the picture which says it all!

The following vulnerability was discovered on TrendMicro SMEX (ScanMail for Microsoft Exchange) 10 SP2 but it affects [other versions](http://esupport.trendmicro.com/solution/en-US/1109669.aspx) as well.

While surfing the SMEX web administrative interface using a web proxy, I have noticed something in the HTTP request - the session token itself and its format, a number.

After observing a significant number of logins, the session token was always represented with an number composed of minimum 4 digits and maximum 5 digits, as shown in the screen shot below:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhoJuIjtjHHC4BxqIRLTHmr5WX1G0gVqHiQtF-d3s5sKBRD_S0cH8g0t39i7QZ1lvh9rm0kfN0N6FVuGByImDgeYnqKLUGDFe2DVbKJ1quz3Y61focJDSyk4jNUAJTYRg7SK7vehOE1INk/s640/s1.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhoJuIjtjHHC4BxqIRLTHmr5WX1G0gVqHiQtF-d3s5sKBRD_S0cH8g0t39i7QZ1lvh9rm0kfN0N6FVuGByImDgeYnqKLUGDFe2DVbKJ1quz3Y61focJDSyk4jNUAJTYRg7SK7vehOE1INk/s1600/s1.png)

Although the observed session tokens were never generated sequentially, the lack of a cryptographically strong PRNG for the session identifier, allows a malicious user to trivially guess the token. This attack can be easily automated.

For example, in Burp proxy, the cool feature of [Intruder](https://portswigger.net/burp/help/intruder_using.html#uses_enumerating) combined with a "[number](https://portswigger.net/burp/help/intruder_payloads_types.html#numbers)" payload and even a single thread would suffice to guess a valid session token in a reasonable time.

By targeting a "protected" page of SMEX administrative interface as a baseline request for Intruder and by examining the HTTP response, it is possible to infer whether the session token is valid or not.

Once a valid token is obtained, a malicious user can impersonate another user's session on the system and gain unauthorised access to the SMEX administrative interface.

References:

Trend Micro Reference: <http://esupport.trendmicro.com/solution/en-US/1109669.aspx>

CVE reference: <http://www.cvedetails.com/cve/CVE-2015-3326/>

Session Prediction: <https://www.owasp.org/index.php/Session_Prediction>

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Labels

[0days](http://blog.malerisch.net/search/label/0days)
[poc](http://blog.malerisch.net/search/label/poc)
[smex](http://blog.malerisch.net/search/label/smex)
[trendmicro](http://blog.malerisch.net/search/label/trendmicro)

Labels:
[0days](http://blog.malerisch.net/search/label/0days)
[poc](http://blog.malerisch.net/search/label/poc)
[smex](http://blog.malerisch.net/search/label/smex)
[trendmicro](http://blog.malerisch.net/search/label/trendmicro)

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Comments

1. ![]()[John Barness](https://www.blogger.com/profile/05985210033843770891)[17 June 2016 at 17:16](http://blog.malerisch.net/2016/05/trendmicro-smex-session-predictable-cve-2015-3326.html?showComment=1466176590559#c2978876568552239458)

   Thank you for the good article.

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5593108060941425908&postID=2978876568552239458)Replies
   Reply

Add commentLoad more...

#### Post a Comment

### Popular posts from this blog

### [Alcatel Lucent Omnivista or: How I learned GIOP and gained Unauthenticated Remote Code Execution (CVE-2016-9796)](http://blog.malerisch.net/2016/12/alcatel-omnivista-8770-unauth-rce-giop-corba.html)

[December 01, 2016](http://blog.malerisch.net/2016/12/alcatel-omnivista-8770-unauth-rce-giop-corba.html "permanent link")

It is time for another advisory or better a blog post about Alcatel Lucent Omnivista  and its vulnerabilities. Omnivista is a central management network tool and it is typically used in medium/large organisation with a complex VoIP/SIP infrastructure. Interestingly enough, this software belongs to the niche of "undownloadable" software and it requires a license to work as well. My "luck" came during an engagement where it was already installed and this post documents one of the many 0days discovered during such audit. The reasons why I wanted to dedicate a single blog post on this vulnerability are several. First, remote code execution (RCE) is always a sweet bug to show. Second, I strongly believe that documenting vulnerabilities in applications using old protocols and standards, respectively GIOP and CORBA, can be beneficial for the infosec community, since no many examples of vulnerabilities in such applications are available or published on the Interne...

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[6 comments](http://blog.malerisch.net/2016/12/alcatel-omnivista-8770-unauth-rce-giop-corba.html#comments)

[Read more](http://blog.malerisch.net/2016/12/alcatel-omnivista-8770-unauth-rce-giop-corba.html "Alcatel Lucent Omnivista or: How I learned GIOP and gained Unauthenticated Remote Code Execution (CVE-2016-9796)")

### [Microsoft .NET MVC ReDoS (Denial of Service) Vulnerability - CVE-2015-2526 (MS15-101)](http://blog.malerisch.net/2015/09/net-mvc-redos-denial-of-service-vulnerability-cve-2015-2526.html)

[September 10, 2015](http://blog.malerisch.net/2015/09/net-mvc-redos-denial-of-service-vulnerability-cve-2015-2526.html "permanent link")

Microsoft released a security bulletin ( MS15-101 ) describing a .NET MVC Denial of Service vulnerability ( CVE-2015-2526 ) that I reported back in April. This blog post analyses the vulnerability in details, starting from the theory and then providing a PoC exploit against a MVC web application developed with Visual Studio 2013. For those of you who want to see the bug, you can directly skip to the last part of this post or watch the video directly... ;-) A bit of theory The .NET framework (4.5 tested version) uses backtracking regular expression matcher when performing a match against an expression. Backtracking is based on the NFA (non-deterministic finite automata) algorithm engine which is designed to validate all input states. By providing an “evil” regex expression – an expression for which the engine can be forced to calculate an exponential number of states - it is possible to force the engine to calculate an exponential number of states, leading to a condition defined su...

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[3 comments](http://blog.malerisch.net/2015/09/net-mvc-redos-denial-of-service-vulnerability-cve-2015-2526.html#comments)

[Read more](http://blog.malerisch.net/2015/09/net-mvc-redos-denial-of-service-vulnerability-cve-2015-2526.html "Microsoft .NET MVC ReDoS (Denial of Service) Vulnerability - CVE-2015-2526 (MS15-101)")

### Archive

* [2017
  2](http://blog.malerisch.net/2017/)

  + [April
    2](http://blog.malerisch.net/2017/04/)

* [2016
  4](http://blog.malerisch.net/2016/)

  + [December
    1](http://blog.malerisch.net/2016/12/)
  + [October
    1](http://blog.malerisch.net/2016/10/)
  + [September
    1](http://blog.malerisch.net/2016/09/)
  + [May
    1](http://blog.malerisch.net/2016/05/)

    - [TrendMicro ScanMail for Microsoft Exchange (SMEX) ...](http://blog.malerisch.net/2016/05/trendmicro-smex-session-predictable-cve-2015-3326.html)
* [2015
  3](http://blog.malerisch.net/2015/)

  + [September
    1](http://blog.malerisch.net/2015/09/)
  + [April
    2](http://blog.malerisch.net/2015/04/)
* [2014
  1](http://blog.malerisch.net/2014/)

  + [August
    1](http://blog.malerisch.net/2014/08/)
* [2013
  3](http://blog.malerisch.net/2013/)

  + [December
    1](http://blog.malerisch.net/2013/12/)
  + [September
    2](http://blog.malerisch.net/2013/09/)
* [2012
  13](http://blog.malerisch.net/2012/)

  + [December
    8](http://blog.malerisch.net/2012/12/)
  + [October
    1](http://blog.malerisch.net/2012/10/)
  + [June
    1](http://blog.malerisch.net/2012/06/)
  + [April
    3](http://blog.malerisch.net/2012/04/)
* [2011
  2](http://blog.malerisch.net/2011/)

  + [December
    2](http://blog.malerisch.net/2011/12/)

Show more
Show less

### Labels

* [.net](http://blog.malerisch.net/search/label/.net)
* [0day](http://blog.malerisch.net/search/label/0day)
* [0days](http://blog.malerisch.net/search/label/0days)
* [advisory](http://blog.malerisch.net/search/label/advisory)
* [alcatel](http://blog.malerisch.net/search/label/alcatel)
* [avant browser](http://blog.malerisch.net/search/label/avant%20browser)
* [beef](http://blog.malerisch.net/search/label/beef)
* [bookmark](http://blog.malerisch.net/search/label/bookmark)
* [brute force pin callmanager cisco phone](http://blog.malerisch.net/search/label/brute%20force%20pin%20callmanager%20cisco%20phone)
* [burp](http://blog.malerisch.net/search/label/burp)

* [burp extension](http://blog.malerisch.net/search/label/burp%20extension)
* [burp pro](http://blog.malerisch.net/search/label/burp%20pro)
* [burpcsj](http://blog.malerisch.net/search/label/burpcsj)
* [corba](http://blog.malerisch.net/search/label/corba)
* [cors](http://blog.malerisch.net/search/label/cors)
* [crash](http://blog.malerisch.net/search/label/crash)
* [crawljax](http://blog.malerisch.net/search/label/crawljax)
* [csrf](http://blog.malerisch.net/search/label/csrf)
* [CVE-2016-2246](http://blog.malerisch.net/search/label/CVE-2016-2246)
* [cve2015-2526](http://blog.malerisch.net/search/label/cve2015-2526)
* [cve2016-3374](http://blog.malerisch.net/search/label/cve2016-3374)
* [dos](http://blog.malerisch.net/search/label/dos)
* [edge](http://blog.malerisch.net/search/label/edge)
* [exploit](http://blog.malerisch.net/search/label/exploit)
* [feed](http://blog.malerisch.net/search/label/feed)
* [file upload](http://blog.malerisch.net/search/label/file%20upload)
* [firefox](http://blog.malerisch.net/search/label/firefox)
* [giop](http://blog.malerisch.net/search/label/giop)
* [hitb2012ams](http://blog.malerisch.net/search/label/hitb2012ams)
* [hitb2017ams](http://blog.malerisch.net/search/label/hitb2017ams)
* [hp](http://blog.malerisch.net/search/label/hp)
* [html5](http://blog.malerisch.net/search/label/html5)
* [i.maxthon.com](http://blog.malerisch.net/search/label/i.maxthon.com)
* [integer overflow](http://blog.malerisch.net/search/label/integer%20overflow)
* [junit](http://blog.malerisch.net/search/label/junit)
* [kemp](http://blog.malerisch.net/search/label/kemp)
* [kiosk hacking](http://blog.malerisch.net/search/label/kiosk%20hacking)
* [load master](http://blog.malerisch.net/search/label/load%20master)
* [lucent](http://blog.malerisch.net/search/label/lucent)
* [maxthon](http://blog.malerisch.net/search/label/maxthon)
* [mcafee](http://blog.malerisch.net/search/label/mcafee)
* [metasploit](http://blog.malerisch.net/search/label/metasploit)
* [microsoft](http://blog.malerisch.net/search/label/microsoft)
* [ms16-115](http://blog.malerisch.net/search/label/ms16-115)
* [mvc](http://blog.malerisch.net/search/label/mvc)
* [omniorb](http://blog.malerisch.net/search/label/omniorb)
* [omnivista](http://blog.malerisch.net/search/label/omnivista)
* [oracle glassfish](http://blog.malerisch.net/search/label/oracle%20glassfish)
* [pdf](http://blog.malerisch.net/search/label/pdf)
* [poc](http://blog.malerisch.net/search/label/poc)
* [rce](http://blog.malerisch.net/search/label/rce)
* [redos](http://blog.malerisch.net/search/label/redos)
* [regex](http://blog.malerisch.net/search/label/regex)
* [remote code execution](http://blog.malerisch.net/search/label/remote%20code%20execution)
* [root shell](http://blog.malerisch.net/search/label/root%20shell)
* [security](http://blog.malerisch.net/search/label/security)
* [security conference](http://blog.malerisch.net/search/label/security%20conference)
* [selenium](http://blog.malerisch.net/search/label/selenium)
* [selenium ide](http://blog.malerisch.net/search/label/selenium%20ide)
* [smex](http://blog.malerisch.net/search/label/smex)
* [sop](http://blog.malerisch.net/search/label/sop)
* [thinpro](http://blog.malerisch.net/search/label/thinpro)
* [trend micro](http://blog.malerisch.net/search/label/trend%20micro)
* [trendmicro](http://blog.malerisch.net/search/label/trendmicro)
* [tutorial](http://blog.malerisch.net/search/label/tutorial)
* [unauthenticated](http://blog.malerisch.net/search/label/unauthenticated)
* [uxss](http://blog.malerisch.net/search/label/uxss)
* [web application testing](http://blog.malerisch.net/search/label/web%20application%20testing)
* [web hacking](http://blog.malerisch.net/search/label/web%20hacking)
* [xcs](http://blog.malerisch.net/search/label/xcs)
* [xhr](http://blog.malerisch.net/search/label/xhr)
* [xsrf](http://blog.malerisch.net/search/label/xsrf)
* [xss](http://blog.malerisch.net/search/label/xss)
* [zero client](http://blog.malerisch.net/search/label/zero%20client)

Show more
Show less

[Powered by Blogger](https://www.blogger.com)



=== Content from www.owasp.org_a11bbb34_20250126_073543.html ===


For full functionality of this site it is necessary to enable JavaScript. Here are the  [instructions how to enable JavaScript in your web browser](http://turnonjs.com/).

[![OWASP logo](https://owasp.org/assets/images/logo.png)](https://owasp.org/)

[![](https://owasp.org/assets/images/logo.png)](https://owasp.org/)

 [Store](https://owasp.org/store)
[Donate](https://owasp.org/donate?reponame=www-community)
[Join](https://owasp.org/membership)

This website uses cookies to analyze our traffic and only share that information with our analytics partners.

Accept

x

[Store](https://owasp.org/store)
[Donate](https://owasp.org/donate?reponame=www-community)
[Join](https://owasp.org/membership)

# Session Prediction

Thank you for visiting OWASP.org. We have migrated our community to a new web platform and regretably the content for this page needed to be programmatically ported from its previous wiki page. There’s still some work to be done.

This is an example of a Project or Chapter Page.

## Description

The session prediction attack focuses on predicting session ID values
that permit an attacker to bypass the authentication schema of an
application. By analyzing and understanding the session ID generation
process, an attacker can predict a valid session ID value and get access
to the application.

In the first step, the attacker needs to collect some valid session ID
values that are used to identify authenticated users. Then, they must
understand the structure of session ID, the information that is used to
create it, and the encryption or hash algorithm used by application to
protect it. Some bad implementations use sessions IDs composed by
username or other predictable information, like timestamp or client IP
address. In the worst case, this information is used in clear text or
coded using some weak algorithm like base64 encoding.

In addition, the attacker can implement a brute force technique to
generate and test different values of session ID until they successfully
get access to the application.

## Examples

The session ID information for a certain application is normally
composed by a string of fixed width. Randomness is very important to
avoid its prediction. Looking at the example in Figure 1, the session ID
variable is represented by JSESSIONID and its value is “user01”, which
corresponds to the username. By trying new values for it, like “user02”,
it could be possible to get inside the application without prior
authentication.

![Predictable cookie](../assets/images/attacks/predictable-cookie.jpg)

*Figure 1. Predictable cookie*

## External References

<http://www.iss.net/security_center/advice/Exploits/TCP/session_hijacking/default.htm>

[http://en.wikipedia.org/wiki/HTTP\_cookie](https://en.wikipedia.org/wiki/HTTP_cookie)

## Related Threats

[:Category: Authorization](%3ACategory%3A_Authorization "wikilink")

## Related Attacks

* [Man-in-the-middle attack](Man-in-the-middle_attack "wikilink")
* [Session hijacking attack](Session_hijacking_attack "wikilink")
* [Manipulating User Permission
  Identifier](Manipulating_User_Permission_Identifier "wikilink")

## Related Vulnerabilities

[:Category:Input Validation
Vulnerability](%3ACategory%3AInput_Validation_Vulnerability "wikilink")

## Related Countermeasures

[:Category:Session Management
Control](%3ACategory%3ASession_Management_Control "wikilink")

## Categories

Category:Exploitation of
Authentication
Category:Attack

---

[Watch](https://github.com/owasp/www-community/subscription)
[Star](https://github.com/owasp/www-community)

**The OWASP® Foundation** works to improve the security of software through its community-led open source software projects,
hundreds of chapters worldwide, tens of thousands of members, and by hosting local and global conferences.
### Important Community Links

* [Community](/www-community/)
* Attacks (You are here)
* [Vulnerabilities](/www-community/vulnerabilities)
* [Controls](/www-community/controls)

### Upcoming OWASP Global Events

## Corporate Supporters

[Become a corporate supporter](https://owasp.org/supporters)

* [HOME](https://owasp.org/)
* [PROJECTS](https://owasp.org/projects/)
* [CHAPTERS](https://owasp.org/chapters/)
* [EVENTS](https://owasp.org/events/)
* [ABOUT](https://owasp.org/about/)
* [PRIVACY](https://owasp.org/www-policy/operational/privacy)
* [SITEMAP](https://owasp.org/sitemap/)
* [CONTACT](https://owasp.org/contact/)

OWASP, the OWASP logo, and Global AppSec are registered trademarks and AppSec Days, AppSec California, AppSec Cali, SnowFROC, OWASP Boston Application Security Conference, and LASCON are trademarks of the OWASP Foundation, Inc. Unless otherwise specified, all content on the site is Creative Commons Attribution-ShareAlike v4.0 and provided without warranty of service or accuracy. For more information, please refer to our [General Disclaimer](/www-policy/operational/general-disclaimer.html). OWASP does not endorse or recommend commercial products or services, allowing our community to remain vendor neutral with the collective wisdom of the best minds in software security worldwide. Copyright 2025, OWASP Foundation, Inc.


