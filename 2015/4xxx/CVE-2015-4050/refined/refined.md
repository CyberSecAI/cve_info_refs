Based on the provided content, here's a breakdown of the vulnerability described in CVE-2015-4050:

**Root Cause of Vulnerability:**

The vulnerability stems from a flaw in how Symfony's `FragmentListener` handles sub-requests when ESI (Edge Side Includes) or SSI (Server Side Includes) support is enabled. The `FragmentListener` is responsible for handling requests to the `/_fragment` path, which are used to render fragments of a page.

**Weaknesses/Vulnerabilities Present:**

*   **Bypassed URL Signing:** The `FragmentListener` checks for a valid signature in the URL to prevent unauthorized access. However, this check is bypassed when the `ExceptionListener` triggers kernel events by creating sub-requests.
*   **Lack of Sub-Request Signing:** The `FragmentListener` does not perform URL signing for sub-requests, allowing a malicious user to call any controller via the `/_fragment` path by providing an invalid hash or removing it completely. This bypasses both the signature validation and the security rules that are intended to prevent direct access to the controller.
*   **ExceptionListener Sub-Request Issue:**  When the `FragmentListener` throws an `AccessDeniedHttpException` due to an invalid signature, the `ExceptionListener` triggers a sub-request, unintentionally bypassing the access control.

**Impact of Exploitation:**

*   **Unauthorized Access:** Attackers can bypass security rules and directly call any controller, potentially executing arbitrary code or accessing sensitive data.
*   **Information Disclosure:** By accessing controllers they were not meant to, attackers could obtain information they are not authorized to see.
*   **Arbitrary Code Execution:** In vulnerable systems, an attacker might be able to execute arbitrary code depending on the controllers being called.

**Attack Vectors:**

*   **Direct Request to `/_fragment` path:** The attacker crafts a request to the `/_fragment` path with an invalid or missing URL signature.
*   **Exploitation of ESI/SSI support:** The vulnerability relies on the application having ESI or SSI support enabled and using the `FragmentListener`.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to send HTTP requests to the application.
*   The attacker needs to know that the target application uses Symfony with ESI/SSI support enabled and the FragmentListener.
*   No special privileges on the server are required for exploitation.

**Affected Versions:**
* 2.3.19 - 2.3.28
* 2.4.9 - 2.4.10
* 2.5.4 - 2.5.11
* 2.6.0 - 2.6.7

**Patched Versions:**

* 2.3.29
* 2.5.12
* 2.6.8
* 2.7.0 (and later)

**Additional Notes:**

*   The fix implements a check in the `FragmentListener` to prevent it from being called if the `_controller` attribute has already been set, preventing the bypass during sub-requests.
*   The vulnerability is only exploitable if the application has ESI or SSI support enabled in configuration and has not disabled the `FragmentListener` explicitly