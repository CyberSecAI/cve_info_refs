```
{
  "CVE-2015-4410": {
    "description": "The vulnerability lies in the `legal?` method of the `BSON::ObjectId` class in the bson-ruby gem. This method was initially implemented with a regular expression `/^[0-9a-f]{24}$/i` to validate if a string was a valid ObjectId. However, in Ruby regular expressions, `^` and `$` match the start and end of a line, not necessarily the start and end of the string. This allowed attackers to inject newline characters (`\\n`) into the ObjectId string, causing unexpected behavior in MongoDB and leading to a Denial of Service.",
    "root_cause": "The root cause is the usage of the regular expression `/^[0-9a-f]{24}$/i` in the `legal?` method, which incorrectly treats newlines as string boundaries, due to Ruby's multiline mode for regex matching.",
    "vulnerabilities": [
      "Incorrect regular expression usage: Using `^` and `$` in Ruby regex without considering the multiline mode.",
      "BSON Injection: Injection of arbitrary data via crafted ObjectIds due to insufficient input validation.",
       "Denial of Service: Crafted ObjectIds causing Moped to repeatedly ping the MongoDB server."
    ],
    "impact": "An attacker could cause a Denial of Service by sending crafted ObjectId strings that trigger excessive pings from Moped to the MongoDB server, keeping workers busy. Additionally, a BSON injection is possible where arbitrary data can be injected into the BSON object by crafting malicious ObjectIds. This bypasses authentication and can potentially alter data, execute arbitrary operations and DoS the system.",
    "attack_vectors": [
      "Sending a crafted ObjectId string with newline characters.",
       "Injecting malicious BSON data via the ObjectId."
    ],
    "attacker_capabilities": "The attacker needs to be able to send a crafted string to the application which will then be used to construct a MongoDB query via the vulnerable `legal?` method in the BSON-ruby library.",
     "additional_details": "The issue was introduced on 2012-01-23 with the initial implementation of `legal?`. It was temporarily fixed on 2012-04-17, but reintroduced on 2013-04-07. The vulnerability is present in `bson-ruby` gem, and is exploitable via `moped` gem which is used in `mongoid` and `mongo_mapper` ORMs."
  }
}
```