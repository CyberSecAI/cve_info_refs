=== Content from bugs.gentoo.org_497c16e0_20250126_041731.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 55165
linux-headers-2.6.4-unistd-nptl-fix.patch fails to patch when emerging linux-headers-2.6.7 on amd64
Last modified: 2004-07-03 02:55:13 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=55165&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=55165&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 55165**](show_bug.cgi?id=55165)
- linux-headers-2.6.4-unistd-nptl-fix.patch fails to patch when emerging linux-headers-2.6.7 on amd64

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
linux-headers-2.6.4-unistd-nptl-fix.patch fails to patch when emerging linux-...

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Linux | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Linux "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | New packages ([show other bugs](buglist.cgi?component=New%20packages&product=Gentoo%20Linux&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | AMD64 Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Kernel Bug Wranglers and Kernel Maintainers | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2004-06-25 10:03 UTC by LordKow | | --- | --- | | Modified: | 2004-07-03 02:55 UTC ([History](show_activity.cgi?id=55165)) | | CC List: | 1 user (show)  kumba | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**Fixed patch**](attachment.cgi?id=34145 "View the content of the attachment") (linux-headers-2.6.7-unistd-nptl-fix.patch,403 bytes, patch)  [2004-06-25 10:04 UTC](#attach_34145 "Go to the comment associated with the attachment"), LordKow | [Details](attachment.cgi?id=34145&action=edit) | [Diff](attachment.cgi?id=34145&action=diff) | | [View All](attachment.cgi?bugid=55165&action=viewall)  [Add an attachment](attachment.cgi?bugid=55165&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=55165&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  LordKow    2004-06-25 10:03:11 UTC  ``` The code has been altered by kernel devels in linux-2.6.7/include/asm-x86_64/unistd.h from  #ifndef __ASSEMBLY__ to a one line && statement... this time including #ifdef __KERNEL in it, however there is no #endif  /* __KERNEL__ */ at the end of the header file, I'm not sure if this is needed or not but I created a patch to do that.  Reproducible: Always Steps to Reproduce: 1.emerge linux-headers-2.6.7 on a amd64 system. 2. 3.  Actual Results:   linux-headers-2.6.4-unistd-nptl-fix.patch fails because it cannot find the right code to patch.  Expected Results:   It shouldn't have failed. :)  Patch created, however not sure if needed or not. ```  [Comment 1](#c1)  LordKow    2004-06-25 10:04:36 UTC  ``` Created [attachment 34145](attachment.cgi?id=34145 "Fixed patch") [[details](attachment.cgi?id=34145&action=edit "Fixed patch"), [diff](attachment.cgi?id=34145&action=diff "Fixed patch")] Fixed patch  Try implementing this patch into the current linux-headers-2.6.7.ebuild and see what happens and if it actually does what the original fix was supposed to do... My linux-headers compiled successfully however I don't know how this affects other apps that require use of these headers. ```  [Comment 2](#c2)  Michal Januszewski (RETIRED)   gentoo-dev  2004-07-03 02:55:13 UTC  ``` Actually, with the changes made in 2.6.7, no patch is necessary any longer. This should now be fixed in our CVS. Thanks. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=55165)
* - [XML](show_bug.cgi?ctype=xml&id=55165)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=55165)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=55165&product=Gentoo%20Linux)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=55165&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=55165&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from openwall.com_a2fef100_20250124_225929.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](10) [[next>]](12) [[thread-next>]](12) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20150203155205.GA14955@eldamar.local>
Date: Tue, 3 Feb 2015 16:52:05 +0100
From: Salvatore Bonaccorso <carnil@...ian.org>
To: OSS Security Mailinglist <oss-security@...ts.openwall.com>
Cc: CVE Assignments MITRE <cve-assign@...re.org>
Subject: Possible CVE Requests: libmspack: several issues

Hi

Several issues with the libmspack library were reported recently in
the Debian bugtracker by Jakub Wilk. An (older) copy of libmspack is
also embedded in ClamAV (not verified if this version is also affected
by these issues).

The reported bugs are the following:

null pointer dereference on a crafted CAB:
 - <https://bugs.debian.org/774665>

CHM decompression: division by zero
 - <https://bugs.debian.org/774725>

CHM decompression: pointer arithmetic overflow
 - <https://bugs.debian.org/774726>

off-by-one buffer over-read in mspack/mszipd.c
 - <https://bugs.debian.org/775498>

off-by-one buffer under-read in mspack/lzxd.c
 - <https://bugs.debian.org/775499>

CHM decompression: another pointer arithmetic overflow
 - <https://bugs.debian.org/775687>

Could CVEs be assigned for these issues?

Regards,
Salvatore

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from security.gentoo.org_75d389d3_20250124_225934.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Adobe Flash Player: Multiple vulnerabilities — GLSA **201506-01**

Multiple vulnerabilities have been found in Adobe Flash Player, the
worst of which allows remote attackers to execute arbitrary code.

### Affected packages

| Package | **www-plugins/adobe-flash** on all architectures |
| --- | --- |
| Affected versions | < **11.2.202.466** |
| Unaffected versions | >= **11.2.202.466** |

### Background

The Adobe Flash Player is a renderer for the SWF file format, which is
commonly used to provide interactive websites.

### Description

Multiple vulnerabilities have been discovered in Adobe Flash Player.
Please review the CVE identifiers referenced below for details.

### Impact

A remote attacker could possibly execute arbitrary code with the
privileges of the process, cause a Denial of Service condition, obtain
sensitive information, or bypass security restrictions.

### Workaround

There is no known workaround at this time.

### Resolution

All Adobe Flash Player users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=www-plugins/adobe-flash-11.2.202.466"

```
### References

* [CVE-2015-3096](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-3096)
* [CVE-2015-3097](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-3097)
* [CVE-2015-3098](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-3098)
* [CVE-2015-3099](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-3099)
* [CVE-2015-3100](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-3100)
* [CVE-2015-3101](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-3101)
* [CVE-2015-3102](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-3102)
* [CVE-2015-3103](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-3103)
* [CVE-2015-3104](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-3104)
* [CVE-2015-3105](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-3105)
* [CVE-2015-3106](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-3106)
* [CVE-2015-3107](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-3107)
* [CVE-2015-3108](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-3108)
* [CVE-2015-4472](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-4472)

**Release date**

June 21, 2015

**Latest revision**

June 21, 2015: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [551658](https://bugs.gentoo.org/show_bug.cgi?id=551658)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugs.debian.org_2953963a_20250124_225933.html ===

# Debian Bug report logs - #775687 libmspack: CVE-2015-4472: CHM decompression: another pointer arithmetic overflow

[![version graph](version.cgi?width=2;package=libmspack0;found=libmspack%2F0.4-3;collapse=1;absolute=0;fixed=libmspack%2F0.5-1;height=2)](version.cgi?absolute=0;info=1;fixed=libmspack%2F0.5-1;package=libmspack0;collapse=1;found=libmspack%2F0.4-3)

Package:
[libmspack0](pkgreport.cgi?package=libmspack0);
Maintainer for [libmspack0](pkgreport.cgi?package=libmspack0) is [Marc Dequènes (Duck) <Duck@DuckCorp.org>](pkgreport.cgi?maint=Duck%40DuckCorp.org); Source for [libmspack0](pkgreport.cgi?package=libmspack0) is [src:libmspack](pkgreport.cgi?src=libmspack) ([PTS](https://tracker.debian.org/pkg/libmspack), [buildd](https://buildd.debian.org/libmspack), [popcon](https://qa.debian.org/popcon.php?package=libmspack)).

Reported by: [Jakub Wilk <jwilk@debian.org>](pkgreport.cgi?submitter=jwilk%40debian.org)

Date: Sun, 18 Jan 2015 18:00:11 UTC

Severity: *grave*

Tags: security

Found in version libmspack/0.4-3

Fixed in version libmspack/0.5-1

**Done:** Marc Dequènes (Duck) <Duck@DuckCorp.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=775687;mbox=yes), [status mbox](bugreport.cgi?bug=775687;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=775687;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, jwilk@debian.org, pkg-clamav-devel@lists.alioth.debian.org, team@security.debian.org, Marc Dequènes (Duck) <Duck@DuckCorp.org>`:

`Bug#775687`; Package `libmspack0`.
(Sun, 18 Jan 2015 18:00:15 GMT) ([full text](bugreport.cgi?bug=775687;msg=2), [mbox](bugreport.cgi?bug=775687;mbox=yes;msg=2), [link](#1)).

---

[Message #3](#3) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=775687;msg=3), [mbox](bugreport.cgi?bug=775687;mbox=yes;msg=3), reply):

![](/cgi-bin/libravatar.cgi?email=jwilk%40debian.org)
From: Jakub Wilk <jwilk@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: libmspack: CHM decompression: another pointer arithmetic overflow
Date: Sun, 18 Jan 2015 18:59:33 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=775687;msg=3) (text/plain, inline)]
```
```
Package: libmspack0
Version: 0.4-3
Severity: grave
Tags: security
Usertags: afl

Sorry, it's me again! libmspack crashes on the attached file:

$ gpg -d < crash.chm.asc > crash.chm
$ test/chmd_md5 crash.chm
*** crash.chm
WARNING; contents are corrupt
d41d8cd98f00b204e9800998ecf8427e /#ITBITS
5c9d7ff7a1fdaf9bcb9b3fc78b677972 /#SYSTEM
Segmentation fault

Backtrace:
#0  0x56559ca6 in search_chunk (chm=0x565641a8, chunk=0x565652e8 "PMGL\323\r", filename=0x5656098c "::DataSpace/Storage/MSCompressed/ControlData", result=0xffffd3a4, result_end=0xffffd3a8) at mspack/chmd.c:805
#1  0x5655943b in chmd_fast_find (base=0x56564008, chm=0x565641a8, filename=0x5656098c "::DataSpace/Storage/MSCompressed/ControlData", f_ptr=0xffffd430, f_size=28) at mspack/chmd.c:581
#2  0x5655b3c7 in find_sys_file (self=0x56564008, sec=0x565641d8, f_ptr=0x565641e4, name=0x5656098c "::DataSpace/Storage/MSCompressed/ControlData") at mspack/chmd.c:1304
#3  0x5655aa4a in chmd_init_decomp (self=0x56564008, file=0x56565228) at mspack/chmd.c:1075
#4  0x5655a787 in chmd_extract (base=0x56564008, file=0x56565228, filename=0x0) at mspack/chmd.c:998
#5  0x56556304 in main (argc=2, argv=0xffffd848) at test/chmd_md5.c:44

The problem is that the bounds check in mspack/chmd.c:788:

       if (name_len > end - p) goto chunk_end;

doesn't work on 32-bit systems if "p" is already bigger than "end" (as
is the case for crash.chm), because negative "end - p" gets
automatically converted to unsigned int.

A quick and dirty fix would be to rewrite the bounds checks as

       if (p > end || name_len > end - p) goto chunk_end;

but it'd be better to fix the thing that sets "p" to a value past the
"end".

-- System Information:
Debian Release: 8.0
 APT prefers unstable
 APT policy: (990, 'unstable'), (500, 'experimental')
Architecture: i386 (x86_64)
Foreign Architectures: amd64

Kernel: Linux 3.2.0-4-amd64 (SMP w/2 CPU cores)
Locale: LANG=C, LC_CTYPE=pl_PL.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash
Init: sysvinit (via /sbin/init)

Versions of packages libmspack0 depends on:
ii  libc6              2.19-13
ii  multiarch-support  2.19-13

--
Jakub Wilk

```
```
[[crash.chm.asc](bugreport.cgi?att=1;bug=775687;filename=crash.chm.asc;msg=3) (text/plain, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Marc Dequènes (Duck) <Duck@DuckCorp.org>`:

`Bug#775687`; Package `libmspack0`.
(Sun, 18 Jan 2015 22:03:05 GMT) ([full text](bugreport.cgi?bug=775687;msg=5), [mbox](bugreport.cgi?bug=775687;mbox=yes;msg=5), [link](#4)).

---

**Acknowledgement sent**
to `Sebastian Andrzej Siewior <sebastian@breakpoint.cc>`:

Extra info received and forwarded to list. Copy sent to `Marc Dequènes (Duck) <Duck@DuckCorp.org>`.
(Sun, 18 Jan 2015 22:03:05 GMT) ([full text](bugreport.cgi?bug=775687;msg=7), [mbox](bugreport.cgi?bug=775687;mbox=yes;msg=7), [link](#6)).

---

[Message #8](#8) received at 775687@bugs.debian.org ([full text](bugreport.cgi?bug=775687;msg=8), [mbox](bugreport.cgi?bug=775687;mbox=yes;msg=8), reply):

![](/cgi-bin/libravatar.cgi?email=sebastian%40breakpoint.cc)
From: Sebastian Andrzej Siewior <sebastian@breakpoint.cc>
To: Jakub Wilk <jwilk@debian.org>, 775687@bugs.debian.org
Cc: pkg-clamav-devel@lists.alioth.debian.org,
Stuart Caie <kyzer@cabextract.org.uk>
Subject: Re: Bug#775687: libmspack: CHM decompression: another pointer
arithmetic overflow
Date: Sun, 18 Jan 2015 23:00:33 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=775687;msg=8) (text/plain, inline)]
```
```
On 2015-01-18 18:59:33 [+0100], Jakub Wilk wrote:
> Sorry, it's me again! libmspack crashes on the attached file:
As I've seen your ubsan reports, I assumed you were done. Wrong this
was.

> $ gpg -d < crash.chm.asc > crash.chm
> $ test/chmd_md5 crash.chm
> *** crash.chm
>
> but it'd be better to fix the thing that sets "p" to a value past the "end".

So something like the patch attached then?. But this should be
double-checked in case we properly come to end and don't continue
using p anymore. But not today…

Sebastian

```
```
[[0001-mspack-chmd-check-p-end-also-after-we-left.patch](bugreport.cgi?att=1;bug=775687;filename=0001-mspack-chmd-check-p-end-also-after-we-left.patch;msg=8) (text/x-diff, attachment)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Marc Dequènes (Duck) <Duck@DuckCorp.org>`:

`Bug#775687`; Package `libmspack0`.
(Mon, 19 Jan 2015 00:30:08 GMT) ([full text](bugreport.cgi?bug=775687;msg=10), [mbox](bugreport.cgi?bug=775687;mbox=yes;msg=10), [link](#9)).

---

**Acknowledgement sent**
to `Stuart Caie <kyzer@cabextract.org.uk>`:

Extra info received and forwarded to list. Copy sent to `Marc Dequènes (Duck) <Duck@DuckCorp.org>`.
(Mon, 19 Jan 2015 00:30:08 GMT) ([full text](bugreport.cgi?bug=775687;msg=12), [mbox](bugreport.cgi?bug=775687;mbox=yes;msg=12), [link](#11)).

---

[Message #13](#13) received at 775687@bugs.debian.org ([full text](bugreport.cgi?bug=775687;msg=13), [mbox](bugreport.cgi?bug=775687;mbox=yes;msg=13), reply):

![](/cgi-bin/libravatar.cgi?email=kyzer%40cabextract.org.uk)
From: Stuart Caie <kyzer@cabextract.org.uk>
To: Sebastian Andrzej Siewior <sebastian@breakpoint.cc>,
Jakub Wilk <jwilk@debian.org>,
775687@bugs.debian.org
Cc: pkg-clamav-devel@lists.alioth.debian.org,
Stuart Caie <kyzer@cabextract.org.uk>
Subject: Re: Bug#775687: libmspack: CHM decompression: another pointer arithmetic
overflow
Date: Mon, 19 Jan 2015 00:07:04 +0000
```
On 18/01/2015 22:00, Sebastian Andrzej Siewior wrote:
> On 2015-01-18 18:59:33 [+0100], Jakub Wilk wrote:
>> Sorry, it's me again! libmspack crashes on the attached file:
> As I've seen your ubsan reports, I assumed you were done. Wrong this
> was.
>
>> $ gpg -d < crash.chm.asc > crash.chm
>> $ test/chmd_md5 crash.chm
>> *** crash.chm
>>
>> but it'd be better to fix the thing that sets "p" to a value past the "end".
> So something like the patch attached then?. But this should be
> double-checked in case we properly come to end and don't continue
> using p anymore. But not today…
>
I made this change instead.

@@ -254,7 +254,7 @@
 #define READ_ENCINT(var) do {                  \
     (var) = 0;                                 \
     do {                                       \
-       if (p > end) goto chunk_end;            \
+       if (p >= end) goto chunk_end;           \
        (var) = ((var) << 7) | (*p & 0x7F);     \
     } while (*p++ & 0x80);                     \
 } while (0)

Regards
Stuart

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Marc Dequènes (Duck) <Duck@DuckCorp.org>`:

`Bug#775687`; Package `libmspack0`.
(Thu, 29 Jan 2015 12:30:04 GMT) ([full text](bugreport.cgi?bug=775687;msg=15), [mbox](bugreport.cgi?bug=775687;mbox=yes;msg=15), [link](#14)).

---

**Acknowledgement sent**
to `Sebastian Andrzej Siewior <sebastian@breakpoint.cc>`:

Extra info received and forwarded to list. Copy sent to `Marc Dequènes (Duck) <Duck@DuckCorp.org>`.
(Thu, 29 Jan 2015 12:30:05 GMT) ([full text](bugreport.cgi?bug=775687;msg=17), [mbox](bugreport.cgi?bug=775687;mbox=yes;msg=17), [link](#16)).

---

[Message #18](#18) received at 775687@bugs.debian.org ([full text](bugreport.cgi?bug=775687;msg=18), [mbox](bugreport.cgi?bug=775687;mbox=yes;msg=18), reply):

![](/cgi-bin/libravatar.cgi?email=sebastian%40breakpoint.cc)
From: Sebastian Andrzej Siewior <sebastian@breakpoint.cc>
To: 775687@bugs.debian.org
Cc: pkg-clamav-devel@lists.alioth.debian.org
Subject: Re: Bug#775687: libmspack: CHM decompression: another pointer
arithmetic overflow
Date: Thu, 29 Jan 2015 13:27:21 +0100
```
0.5alpha has been just released [0] with this issue fixed. If you
package that one you get rid of all currently known bugs :)

[0] <http://www.cabextract.org.uk/libmspack/libmspack-0.5alpha.tar.gz>

Sebastian

```

---

**Reply sent**
to `Marc Dequènes (Duck) <Duck@DuckCorp.org>`:

You have taken responsibility.
(Mon, 02 Feb 2015 19:09:21 GMT) ([full text](bugreport.cgi?bug=775687;msg=20), [mbox](bugreport.cgi?bug=775687;mbox=yes;msg=20), [link](#19)).

---

**Notification sent**
to `Jakub Wilk <jwilk@debian.org>`:

Bug acknowledged by developer.
(Mon, 02 Feb 2015 19:09:21 GMT) ([full text](bugreport.cgi?bug=775687;msg=22), [mbox](bugreport.cgi?bug=775687;mbox=yes;msg=22), [link](#21)).

---

[Message #23](#23) received at 775687-close@bugs.debian.org ([full text](bugreport.cgi?bug=775687;msg=23), [mbox](bugreport.cgi?bug=775687;mbox=yes;msg=23), reply):

![](/cgi-bin/libravatar.cgi?email=Duck%40DuckCorp.org)
From: Marc Dequènes (Duck) <Duck@DuckCorp.org>
To: 775687-close@bugs.debian.org
Subject: Bug#775687: fixed in libmspack 0.5-1
Date: Mon, 02 Feb 2015 19:04:56 +0000
```
Source: libmspack
Source-Version: 0.5-1

We believe that the bug you reported is fixed in the latest version of
libmspack, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 775687@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Marc Dequènes (Duck) <Duck@DuckCorp.org> (supplier of updated libmspack package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Mon, 02 Feb 2015 19:41:59 +0100
Source: libmspack
Binary: libmspack0 libmspack-dev libmspack-dbg libmspack-doc
Architecture: source amd64 all
Version: 0.5-1
Distribution: unstable
Urgency: medium
Maintainer: Marc Dequènes (Duck) <Duck@DuckCorp.org>
Changed-By: Marc Dequènes (Duck) <Duck@DuckCorp.org>
Description:
 libmspack-dbg - library for Microsoft compression formats (debugging symbols)
 libmspack-dev - library for Microsoft compression formats (development files)
 libmspack-doc - library for Microsoft compression formats (documentation)
 libmspack0 - library for Microsoft compression formats (shared library)
Closes: [774665](bugreport.cgi?bug=774665) [775498](bugreport.cgi?bug=775498) [775499](bugreport.cgi?bug=775499) [775687](bugreport.cgi?bug=775687)
Changes:
 libmspack (0.5-1) unstable; urgency=medium
 .
   * New upstream fix-only release:
     + Fix previously reported bugs with an upstream approved patch
       (#773041, #774725, #774726)
     + Fixes many security-sensitive bugs (Closes: #[775687](bugreport.cgi?bug=775687), #[775498](bugreport.cgi?bug=775498),
       #[774665](bugreport.cgi?bug=774665), #[775499](bugreport.cgi?bug=775499)).
Checksums-Sha1:
 5ee31e4bee00c8d898f8748cc57d7783dc533dc3 2064 libmspack_0.5-1.dsc
 226f19b1fc58e820671a1749983b06896e108cc4 654193 libmspack_0.5.orig.tar.gz
 0b25b953e95874cd6f3c4faff1d89b5080f5460e 2732 libmspack_0.5-1.debian.tar.xz
 3455afb116161bb800208c5e5315c9c0ef74931d 46518 libmspack0_0.5-1_amd64.deb
 e039f7f9a29d0369e7bca3216d1711b906badf64 64864 libmspack-dev_0.5-1_amd64.deb
 d7e03f123dd5ac4b8744d9aeb7acf4aeb84aeab1 83962 libmspack-dbg_0.5-1_amd64.deb
 aa481d5f1bfc4b234005d542a79c4c542380573e 101792 libmspack-doc_0.5-1_all.deb
Checksums-Sha256:
 eb9e63d0dd75cb28180f5ed02178c436a723697dab285b5a484729acc4039a2c 2064 libmspack_0.5-1.dsc
 8967f275525f5067b364cee43b73e44d0433668c39f9376dfff19f653d1c8110 654193 libmspack_0.5.orig.tar.gz
 42bf17c5b1dd0a44da06117ff4deb52ee06063b002bd8289f8d1ca9df1753cc3 2732 libmspack_0.5-1.debian.tar.xz
 805a49cc478460e920930864770071184dc90818bdaf23b81a36bbf6deafa96a 46518 libmspack0_0.5-1_amd64.deb
 703badb6b5ca7eaeac15779030c4dbe07fc6d355870da9acdc31a2e7b90c54c4 64864 libmspack-dev_0.5-1_amd64.deb
 5992fa23531e125ae07437ca0fc78c1da0dcf573f558fcf1fec3259ec0b6620d 83962 libmspack-dbg_0.5-1_amd64.deb
 6852556f9e730725b9820365eeaced90b8affeb648a385ec0fab82d5cffcb6e8 101792 libmspack-doc_0.5-1_all.deb
Files:
 6a821d5a21543cac7e931cb2d574f906 2064 libs optional libmspack_0.5-1.dsc
 3aa3f6b9ef101463270c085478fda1da 654193 libs optional libmspack_0.5.orig.tar.gz
 e795c2066af466550f9a19c79addb364 2732 libs optional libmspack_0.5-1.debian.tar.xz
 bdacfcaa023672fbd2d6e5351775c85b 46518 libs optional libmspack0_0.5-1_amd64.deb
 c88a0b861ce8ef9de6ea119f6db22c9f 64864 libdevel optional libmspack-dev_0.5-1_amd64.deb
 6a47691d38eb3bcaeac00b051e1e6f86 83962 debug extra libmspack-dbg_0.5-1_amd64.deb
 60e609c122d314710d819847ac9c3e8a 101792 doc optional libmspack-doc_0.5-1_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCgAGBQJUz8edAAoJEFXp+fesHEQ/vzYP+gI2sbMP3ABuE6rOJeLdLtcH
JZyPz+xkqzFgQENkKboo8IRYRp9JUSmQjJGLXDjTd3SmMZ7zJzl+miVvMHYZuMJm
K9UJRtDw+0nXphYIZ86Jci0/UbgvMrwMDhgDbR8hZMdzanoAul0oyynDLqINc/q4
Myl+fG8c8hEgY96dWxkytRJkOIWiZ7F+vdjPtP1ASuT+3MFGql5nLRaQDXFQh7me
UQAmq32baaD/9HdEQHCbjVyzSGIMPmO+sTutqu+mmRKCrJUBhucb4ALj4Z1cBsGA
/r72kMKx1jeDmzisvFCSweVIBzukVAuOhndzdv1tpZedgNuKaJhPNFz4sb6aFvuY
r6X4Zr5o3qv8VzizcRoSmuI+eR52FZQ77z1ydqRqxMdi2bJgDj2YN3XKsZ6IQnod
YVMPujdeSVCe40m5ZC6eAvC/LHW6AfpbDrWamvBAZZZfRd/mkq3ZXA55BQE5GixD
cfv7FNv0050is1H8mWiS4r9Qjb0np4MeGPYqJQxiQcKyXMvZdt3gk60dFFVdqsrN
rbdHKdKlncTLaNtGllCiwylozaGctgnoGPBfaSEaurfZmZirV+dezcJ7xnGBiIIq
V9kKQNnT73iMHQnwChXKZa7YZEPxEDnFiNFXRqHnksUVCIO+tRumk2hfKTKVxLJP
3/Ri1tZ38Kmjl+Pwg1wB
=F8TC
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sat, 07 Mar 2015 07:34:27 GMT) ([full text](bugreport.cgi?bug=775687;msg=25), [mbox](bugreport.cgi?bug=775687;mbox=yes;msg=25), [link](#24)).

---

**Bug unarchived.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Thu, 11 Jun 2015 15:21:12 GMT) ([full text](bugreport.cgi?bug=775687;msg=27), [mbox](bugreport.cgi?bug=775687;mbox=yes;msg=27), [link](#26)).

---

**Changed Bug title to 'libmspack: CVE-2015-4472: CHM decompression: another pointer arithmetic overflow' from 'libmspack: CHM decompression: another pointer arithmetic overflow'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Thu, 11 Jun 2015 15:21:13 GMT) ([full text](bugreport.cgi?bug=775687;msg=29), [mbox](bugreport.cgi?bug=775687;mbox=yes;msg=29), [link](#28)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Fri, 10 Jul 2015 07:32:44 GMT) ([full text](bugreport.cgi?bug=775687;msg=31), [mbox](bugreport.cgi?bug=775687;mbox=yes;msg=31), [link](#30)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=775687).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 22:59:33 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.


