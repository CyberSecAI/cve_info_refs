=== Content from github.com_b946e94e_20250125_124913.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdevttys0%2Fsasquatch%2Fpull%2F5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdevttys0%2Fsasquatch%2Fpull%2F5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=devttys0%2Fsasquatch)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[devttys0](/devttys0)
/
**[sasquatch](/devttys0/sasquatch)**
Public

* [Notifications](/login?return_to=%2Fdevttys0%2Fsasquatch) You must be signed in to change notification settings
* [Fork
  160](/login?return_to=%2Fdevttys0%2Fsasquatch)
* [Star
   524](/login?return_to=%2Fdevttys0%2Fsasquatch)

* [Code](/devttys0/sasquatch)
* [Issues
  21](/devttys0/sasquatch/issues)
* [Pull requests
  14](/devttys0/sasquatch/pulls)
* [Actions](/devttys0/sasquatch/actions)
* [Projects
  0](/devttys0/sasquatch/projects)
* [Wiki](/devttys0/sasquatch/wiki)
* [Security](/devttys0/sasquatch/security)
* [Insights](/devttys0/sasquatch/pulse)

Additional navigation options

* [Code](/devttys0/sasquatch)
* [Issues](/devttys0/sasquatch/issues)
* [Pull requests](/devttys0/sasquatch/pulls)
* [Actions](/devttys0/sasquatch/actions)
* [Projects](/devttys0/sasquatch/projects)
* [Wiki](/devttys0/sasquatch/wiki)
* [Security](/devttys0/sasquatch/security)
* [Insights](/devttys0/sasquatch/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fdevttys0%2Fsasquatch%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fdevttys0%2Fsasquatch%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# read\_fragment\_table\_n: Fix recommendation for stack overflow. #5

 Closed

[ghost](/ghost)
wants to merge
1
commit into
[devttys0:master](/devttys0/sasquatch/tree/master "devttys0/sasquatch:master")
from
unknown repository

 Closed

# [read\_fragment\_table\_n: Fix recommendation for stack overflow.](#top) #5

[ghost](/ghost)
wants to merge
1
commit into
[devttys0:master](/devttys0/sasquatch/tree/master "devttys0/sasquatch:master")
from
unknown repository

[Conversation
2](/devttys0/sasquatch/pull/5)
[Commits
1](/devttys0/sasquatch/pull/5/commits)
[Checks
0](/devttys0/sasquatch/pull/5/checks)
[Files changed](/devttys0/sasquatch/pull/5/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![ghost](https://avatars.githubusercontent.com/u/10137?s=60&v=4)](/ghost)

Copy link

### @ghost **[ghost](/ghost)** commented [Jun 17, 2015](#issue-88907922)

There seems to be a stack overflow and an integer overflow in read\_fragment\_table\_4.

##### [CVE-2015-4645](https://github.com/advisories/GHSA-j67g-6r6x-5v63 "CVE-2015-4645")

The first problem overflows the bytes variable, so that the allocation of fragments\_bytes[] has an erroneous size.

```
int bytes = SQUASHFS_FRAGMENT_BYTES(sBlk.s.fragments);
...
fragment_table = malloc(bytes);
```
##### [CVE-2015-4646](https://github.com/advisories/GHSA-m77j-hm9g-ppq8 "CVE-2015-4646")

If we fix this by making the variable size\_t, we run into an unrelated problem in which the stack VLA allocation of fragment\_table\_index[] can easily exceed RLIMIT\_STACK.

```
long long fragment_table_index[indexes];
```

In the case of my system, the RLIMIT\_STACK is 8388608 bytes, and VLA is asking for 15728648 bytes. This is what I believe ultimately leads to the stack overflow. Plus the stack probably already has a bunch of other things, and I don't know a portable way to check how much stack space is available.

Afterwards, the disastrous call to read\_fs\_bytes is made, which initiates the transfer from the squashfs image to the stack. At this stage, a stack overflow appears to be in full effect.

```
 res = read_fs_bytes(fd, sBlk.s.fragment_table_start,
         SQUASHFS_FRAGMENT_INDEX_BYTES(sBlk.s.fragments),
         fragment_table_index);
```
#### ASAN Output

```
Parallel unsquashfs: Using 8 processors
ASAN:SIGSEGV
=================================================================
==8221==ERROR: AddressSanitizer: stack-overflow on address 0x7ffef3ae9608 (pc 0x000000559011 bp 0x7ffef49e9670 sp 0x7ffef3ae9610 T0)
    #0 0x559010 in read_fragment_table_4 /home/septimus/vr/squashfs-vr/squashfs-tools/unsquash-4.c:40:9
    #1 0x525073 in main /home/septimus/vr/squashfs-vr/squashfs-tools/unsquashfs.c:2763:5
    #2 0x7fb56c533a3f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x20a3f)
    #3 0x418468 in _start (/home/septimus/vr/squashfs-vr/squashfs-tools/unsquashfs+0x418468)
SUMMARY: AddressSanitizer: stack-overflow /home/septimus/vr/squashfs-vr/squashfs-tools/unsquash-4.c:40:9 in read_fragment_table_4
==8221==ABORTING

```
#### Proposed Fix

Perhaps we should avoid using VLA altogether, and allocate fragment\_table\_index to the heap? It's likely that the fragment\_table\_index[] can be a lot bigger than 8388608 bytes, according to the squashfs specification.

*This problem is present in other read\_fragment\_table\_N functions, and in in the original squashfs-tools.*

This pull request is an example implementation of the recommended fix for unsquash-4, but I don't have enough test vectors to verify it doesn't break anything. All code that uses VLA should probably be converted to use the heap instead.

#### VLA Usages (In squashfs-tools)

```
unsquashfs.c:693:14: warning: variable length array used [-Wvla]
                char buffer[c_byte];
                           ^
unsquash-2.c:35:27: warning: variable length array used [-Wvla]
                unsigned int sblock_list[blocks];
                                        ^
unsquash-2.c:48:35: warning: variable length array used [-Wvla]
        unsigned int fragment_table_index[indexes];
                                         ^
unsquash-2.c:65:38: warning: variable length array used [-Wvla]
                 unsigned int sfragment_table_index[indexes];
                                                   ^
unsquash-3.c:35:32: warning: variable length array used [-Wvla]
        long long fragment_table_index[indexes];
                                      ^
unsquash-3.c:52:34: warning: variable length array used [-Wvla]
                long long sfragment_table_index[indexes];
                                               ^
unsquash-1.c:335:26: warning: variable length array used [-Wvla]
                unsigned int suid_table[sBlk.no_uids + sBlk.no_guids];

unsquashfs.c:2099:10: warning: variable length array used [-Wvla]
        char tmp[block_size];
                ^
unsquash-4.c:374:26: warning: variable length array used [-Wvla]
        long long id_index_table[indexes];

```

Please let me know what you think.

Thanks.

Sorry, something went wrong.

All reactions

[![@gcanalesb](https://avatars.githubusercontent.com/u/37164759?s=40&v=4)](/gcanalesb)

`[Update unsquash-4.c](/devttys0/sasquatch/pull/5/commits/6777e08cc38bc780d27c69c1d8c272867b74524f "Update unsquash-4.c

There seems to be a stack overflow in read_fragment_table_4 at via what seems to be an integer overflow. Still looking into this problem, it seems like two or three different problems combined.

The first problem overflows the bytes variable, so that the allocation is enormous.
```c
int bytes = SQUASHFS_FRAGMENT_BYTES(sBlk.s.fragments);
```

If we fix this by making the variable size_t, we run into an unrelated problem in which the stack VLA allocation of fragment_table_index can easily exceed RLIMIT_STACK.
```c
long long fragment_table_index[indexes];
```

In the case of my system, the RLIMIT_STACK is 8388608, and VLA is asking for 15728648. Plus the stack probably already has a bunch of other things. This is what I believe ultimately leads to the stack overflow.

Afterwards, the heap allocation seems to succeed, and the disastrous call to read_fs_bytes is made, which initiates transfer from the squashfs image to the stack. At this stage, a stack overflow appears to be in full effect.

```c
 res = read_fs_bytes(fd, sBlk.s.fragment_table_start,
         SQUASHFS_FRAGMENT_INDEX_BYTES(sBlk.s.fragments),
         fragment_table_index);
```
This problem is also present in other read_fragment_table_N functions, and in in the original squashfs-tools.

```
Parallel unsquashfs: Using 8 processors
ASAN:SIGSEGV
=================================================================
==8221==ERROR: AddressSanitizer: stack-overflow on address 0x7ffef3ae9608 (pc 0x000000559011 bp 0x7ffef49e9670 sp 0x7ffef3ae9610 T0)
    #0 0x559010 in read_fragment_table_4 /home/septimus/vr/squashfs-vr/squashfs-tools/unsquash-4.c:40:9
    #1 0x525073 in main /home/septimus/vr/squashfs-vr/squashfs-tools/unsquashfs.c:2763:5
    #2 0x7fb56c533a3f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x20a3f)
    #3 0x418468 in _start (/home/septimus/vr/squashfs-vr/squashfs-tools/unsquashfs+0x418468)
SUMMARY: AddressSanitizer: stack-overflow /home/septimus/vr/squashfs-vr/squashfs-tools/unsquash-4.c:40:9 in read_fragment_table_4
==8221==ABORTING
```

Perhaps we should avoid using VLA altogether, and allocate fragment_table_index to the heap?
This pull request is an example implementation of the fix for unsquash-4, but I don't have enough test vectors to verify it will not break anything.")`
 …

`[6777e08](/devttys0/sasquatch/pull/5/commits/6777e08cc38bc780d27c69c1d8c272867b74524f)`

```
There seems to be a stack overflow in read_fragment_table_4 at via what seems to be an integer overflow. Still looking into this problem, it seems like two or three different problems combined.

The first problem overflows the bytes variable, so that the allocation is enormous.
```c
int bytes = SQUASHFS_FRAGMENT_BYTES(sBlk.s.fragments);
```

If we fix this by making the variable size_t, we run into an unrelated problem in which the stack VLA allocation of fragment_table_index can easily exceed RLIMIT_STACK.
```c
long long fragment_table_index[indexes];
```

In the case of my system, the RLIMIT_STACK is 8388608, and VLA is asking for 15728648. Plus the stack probably already has a bunch of other things. This is what I believe ultimately leads to the stack overflow.

Afterwards, the heap allocation seems to succeed, and the disastrous call to read_fs_bytes is made, which initiates transfer from the squashfs image to the stack. At this stage, a stack overflow appears to be in full effect.

```c
 res = read_fs_bytes(fd, sBlk.s.fragment_table_start,
         SQUASHFS_FRAGMENT_INDEX_BYTES(sBlk.s.fragments),
         fragment_table_index);
```
This problem is also present in other read_fragment_table_N functions, and in in the original squashfs-tools.

```
Parallel unsquashfs: Using 8 processors
ASAN:SIGSEGV
=================================================================
==8221==ERROR: AddressSanitizer: stack-overflow on address 0x7ffef3ae9608 (pc 0x000000559011 bp 0x7ffef49e9670 sp 0x7ffef3ae9610 T0)
    #0 0x559010 in read_fragment_table_4 /home/septimus/vr/squashfs-vr/squashfs-tools/unsquash-4.c:40:9
    [#1](https://github.com/devttys0/sasquatch/issues/1) 0x525073 in main /home/septimus/vr/squashfs-vr/squashfs-tools/unsquashfs.c:2763:5
    [#2](https://github.com/devttys0/sasquatch/issues/2) 0x7fb56c533a3f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x20a3f)
    [#3](https://github.com/devttys0/sasquatch/pull/3) 0x418468 in _start (/home/septimus/vr/squashfs-vr/squashfs-tools/unsquashfs+0x418468)
SUMMARY: AddressSanitizer: stack-overflow /home/septimus/vr/squashfs-vr/squashfs-tools/unsquash-4.c:40:9 in read_fragment_table_4
==8221==ABORTING
```

Perhaps we should avoid using VLA altogether, and allocate fragment_table_index to the heap?
This pull request is an example implementation of the fix for unsquash-4, but I don't have enough test vectors to verify it will not break anything.
```

![@ghost](https://avatars.githubusercontent.com/u/10137?s=32&v=4)
**ghost**
mentioned this pull request
[Jun 17, 2015](#ref-pullrequest-88889577)

[Update unsquash-4.c
#4](/devttys0/sasquatch/pull/4)
 Closed

![@ghost](https://avatars.githubusercontent.com/u/10137?s=32&v=4)
**ghost**
changed the title
~~Update unsquash-4.c~~
read\_fragment\_table\_N: Recommended fix for stack overflow.
[Jun 20, 2015](#event-335971096)

![@ghost](https://avatars.githubusercontent.com/u/10137?s=32&v=4)
**ghost**
changed the title
~~read\_fragment\_table\_N: Recommended fix for stack overflow.~~
read\_fragment\_table\_n: Fix recommendation for stack overflow.
[Jun 20, 2015](#event-335971213)

[![@andreasstieger](https://avatars.githubusercontent.com/u/2847525?s=80&u=3c5a94595830886205b67f26f2d3997bcc399dc0&v=4)](/andreasstieger)

Copy link

### **[andreasstieger](/andreasstieger)** commented [Jul 17, 2015](#issuecomment-122235575)

| Is there any response from the project regarding this issue? |
| --- |

All reactions

Sorry, something went wrong.

[![@devttys0](https://avatars.githubusercontent.com/u/5703146?s=80&u=940e670fff1e509355d4f6ded1e16d3811ed1aaa&v=4)](/devttys0)

Copy link

Owner

### **[devttys0](/devttys0)** commented [May 22, 2018](#issuecomment-390988066)

| Since this project is just a patch file to add functionality to the original squashfs tools, this should be fixed upstream in the SquashFS project itself. |
| --- |

All reactions

Sorry, something went wrong.

[![@devttys0](https://avatars.githubusercontent.com/u/5703146?s=40&u=940e670fff1e509355d4f6ded1e16d3811ed1aaa&v=4)](/devttys0)
[devttys0](/devttys0)
closed this
[May 22, 2018](#event-1639297638)

[![@Pamplemousse](https://avatars.githubusercontent.com/u/2647236?s=40&v=4)](/Pamplemousse)
[Pamplemousse](/Pamplemousse)
mentioned this pull request
[Sep 3, 2019](#ref-pullrequest-480441169)

[sasquatch: init
NixOS/nixpkgs#66600](/NixOS/nixpkgs/pull/66600)
 Merged

6 tasks

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fdevttys0%2Fsasquatch%2Fpull%2F5)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@andreasstieger](https://avatars.githubusercontent.com/u/2847525?s=52&v=4)](/andreasstieger) [![@devttys0](https://avatars.githubusercontent.com/u/5703146?s=52&v=4)](/devttys0) [![@gcanalesb](https://avatars.githubusercontent.com/u/37164759?s=52&v=4)](/gcanalesb)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e17dfc2d_20250125_124913.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplougher%2Fsquashfs-tools%2Fcommit%2Ff95864afe8833fe3ad782d714b41378e860977b1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplougher%2Fsquashfs-tools%2Fcommit%2Ff95864afe8833fe3ad782d714b41378e860977b1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=plougher%2Fsquashfs-tools)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[plougher](/plougher)
/
**[squashfs-tools](/plougher/squashfs-tools)**
Public

* [Notifications](/login?return_to=%2Fplougher%2Fsquashfs-tools) You must be signed in to change notification settings
* [Fork
  200](/login?return_to=%2Fplougher%2Fsquashfs-tools)
* [Star
   804](/login?return_to=%2Fplougher%2Fsquashfs-tools)

* [Code](/plougher/squashfs-tools)
* [Issues
  18](/plougher/squashfs-tools/issues)
* [Pull requests
  10](/plougher/squashfs-tools/pulls)
* [Actions](/plougher/squashfs-tools/actions)
* [Projects
  0](/plougher/squashfs-tools/projects)
* [Wiki](/plougher/squashfs-tools/wiki)
* [Security](/plougher/squashfs-tools/security)
* [Insights](/plougher/squashfs-tools/pulse)

Additional navigation options

* [Code](/plougher/squashfs-tools)
* [Issues](/plougher/squashfs-tools/issues)
* [Pull requests](/plougher/squashfs-tools/pulls)
* [Actions](/plougher/squashfs-tools/actions)
* [Projects](/plougher/squashfs-tools/projects)
* [Wiki](/plougher/squashfs-tools/wiki)
* [Security](/plougher/squashfs-tools/security)
* [Insights](/plougher/squashfs-tools/pulse)

## Commit

[Permalink](/plougher/squashfs-tools/commit/f95864afe8833fe3ad782d714b41378e860977b1)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

unsquashfs-4: Add more sanity checks + fix [CVE-2015-4645](https://github.com/advisories/GHSA-j67g-6r6x-5v63 "CVE-2015-4645")/6

[Browse files](/plougher/squashfs-tools/tree/f95864afe8833fe3ad782d714b41378e860977b1)
Browse the repository at this point in the history

```
Add more filesystem table sanity checks to Unsquashfs-4 and
also properly fix [CVE-2015-4645](https://github.com/advisories/GHSA-j67g-6r6x-5v63 "CVE-2015-4645") and [CVE-2015-4646](https://github.com/advisories/GHSA-m77j-hm9g-ppq8 "CVE-2015-4646").

The CVEs were raised due to Unsquashfs having variable
oveflow and stack overflow in a number of vulnerable
functions.

The suggested patch only "fixed" one such function and fixed
it badly, and so it was buggy and introduced extra bugs!

The suggested patch was not only buggy, but, it used the
essentially wrong approach too.  It was "fixing" the
symptom but not the cause.  The symptom is wrong values
causing overflow, the cause is filesystem corruption.
This corruption should be detected and the filesystem
rejected *before* trying to allocate memory.

This patch applies the following fixes:

1. The filesystem super-block tables are checked, and the values
   must match across the filesystem.

   This will trap corrupted filesystems created by Mksquashfs.

2. The maximum (theorectical) size the filesystem tables could grow
   to, were analysed, and some variables were increased from int to
   long long.

   This analysis has been added as comments.

3. Stack allocation was removed, and a shared buffer (which is
   checked and increased as necessary) is used to read the
   table indexes.

Signed-off-by: Phillip Lougher <phillip@squashfs.org.uk>
```

* Loading branch information

[![@plougher](https://avatars.githubusercontent.com/u/1834249?s=40&v=4)](/plougher)

[plougher](/plougher/squashfs-tools/commits?author=plougher "View all commits by plougher")
committed
Jul 16, 2019

1 parent
[5883059](/plougher/squashfs-tools/commit/588305949bd25d5f6375e0cdaddee74d3b9b7b2d)

commit f95864a

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**239 additions**
and
**54 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* squashfs-tools

  + squashfs-tools/read\_xattrs.c
    [read\_xattrs.c](#diff-196502be6c18a66b54421b0a83678f2fe1c0c4e3eefc6c4a17c70dad7a098b57)
  + squashfs-tools/unsquash-4.c
    [unsquash-4.c](#diff-e277fd6325be3a71de1615806187a7540a0df70054c3edf5b1060eba90fb4916)
  + squashfs-tools/unsquashfs.c
    [unsquashfs.c](#diff-2c9ccd1eccb7c606e7724f92eadf146add8b4ab510f8bc80989ced922a8fe859)

## There are no files selected for viewing

57 changes: 43 additions & 14 deletions

57
[squashfs-tools/read\_xattrs.c](#diff-196502be6c18a66b54421b0a83678f2fe1c0c4e3eefc6c4a17c70dad7a098b57 "squashfs-tools/read_xattrs.c")

Show comments

[View file](/plougher/squashfs-tools/blob/f95864afe8833fe3ad782d714b41378e860977b1/squashfs-tools/read_xattrs.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -150,7 +150,16 @@ static int read\_xattr\_entry(struct xattr\_list \*xattr, |
|  |  | \*/ |
|  |  | int read\_xattrs\_from\_disk(int fd, struct squashfs\_super\_block \*sBlk, int flag, long long \*table\_start) |
|  |  | { |
|  |  | int res, bytes, i, indexes, index\_bytes, ids; |
|  |  | /\* |
|  |  | \* Note on overflow limits: |
|  |  | \* Size of ids (id\_table.xattr\_ids) is 2^32 (unsigned int) |
|  |  | \* Max size of bytes is 2^32\*16 or 2^36 |
|  |  | \* Max indexes is (2^32\*16)/8K or 2^23 |
|  |  | \* Max index\_bytes is ((2^32\*16)/8K)\*8 or 2^26 or 64M |
|  |  | \*/ |
|  |  | int res, i, indexes, index\_bytes; |
|  |  | unsigned int ids; |
|  |  | long long bytes; |
|  |  | long long \*index, start, end; |
|  |  | struct squashfs\_xattr\_table id\_table; |
|  |  |  |
| Expand All | | @@ -170,24 +179,44 @@ int read\_xattrs\_from\_disk(int fd, struct squashfs\_super\_block \*sBlk, int flag, l |
|  |  |  |
|  |  | SQUASHFS\_INSWAP\_XATTR\_TABLE(&id\_table); |
|  |  |  |
|  |  | if(flag) { |
|  |  | /\* |
|  |  | \* id\_table.xattr\_table\_start stores the start of the compressed xattr |
|  |  | \* \* metadata blocks. This by definition is also the end of the previous |
|  |  | \* filesystem table - the id lookup table. |
|  |  | \*/ |
|  |  | /\* |
|  |  | \* Compute index table values |
|  |  | \*/ |
|  |  | ids = id\_table.xattr\_ids; |
|  |  | xattr\_table\_start = id\_table.xattr\_table\_start; |
|  |  | index\_bytes = SQUASHFS\_XATTR\_BLOCK\_BYTES((long long) ids); |
|  |  | indexes = SQUASHFS\_XATTR\_BLOCKS((long long) ids); |
|  |  |  |
|  |  | /\* |
|  |  | \* The size of the index table (index\_bytes) should match the |
|  |  | \* table start and end points |
|  |  | \*/ |
|  |  | if(index\_bytes != (sBlk->bytes\_used - (sBlk->xattr\_id\_table\_start + sizeof(id\_table)))) { |
|  |  | ERROR("read\_xattrs\_from\_disk: Bad xattr\_ids count in super block\n"); |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | /\* |
|  |  | \* id\_table.xattr\_table\_start stores the start of the compressed xattr |
|  |  | \* metadata blocks. This by definition is also the end of the previous |
|  |  | \* filesystem table - the id lookup table. |
|  |  | \*/ |
|  |  | if(table\_start != NULL) |
|  |  | \*table\_start = id\_table.xattr\_table\_start; |
|  |  |  |
|  |  | /\* |
|  |  | \* If flag is set then return once we've read the above |
|  |  | \* table\_start. That value is necessary for sanity checking, |
|  |  | \* but we don't actually want to extract the xattrs, and so |
|  |  | \* stop here. |
|  |  | \*/ |
|  |  | if(flag) |
|  |  | return id\_table.xattr\_ids; |
|  |  | } |
|  |  |  |
|  |  | /\* |
|  |  | \* Allocate and read the index to the xattr id table metadata |
|  |  | \* blocks |
|  |  | \*/ |
|  |  | ids = id\_table.xattr\_ids; |
|  |  | xattr\_table\_start = id\_table.xattr\_table\_start; |
|  |  | index\_bytes = SQUASHFS\_XATTR\_BLOCK\_BYTES(ids); |
|  |  | indexes = SQUASHFS\_XATTR\_BLOCKS(ids); |
|  |  | index = malloc(index\_bytes); |
|  |  | if(index == NULL) |
|  |  | MEM\_ERROR(); |
| Expand All | | @@ -203,7 +232,7 @@ int read\_xattrs\_from\_disk(int fd, struct squashfs\_super\_block \*sBlk, int flag, l |
|  |  | \* Allocate enough space for the uncompressed xattr id table, and |
|  |  | \* read and decompress it |
|  |  | \*/ |
|  |  | bytes = SQUASHFS\_XATTR\_BYTES(ids); |
|  |  | bytes = SQUASHFS\_XATTR\_BYTES((long long) ids); |
|  |  | xattr\_ids = malloc(bytes); |
|  |  | if(xattr\_ids == NULL) |
|  |  | MEM\_ERROR(); |
| Expand All | | @@ -213,7 +242,7 @@ int read\_xattrs\_from\_disk(int fd, struct squashfs\_super\_block \*sBlk, int flag, l |
|  |  | bytes & (SQUASHFS\_METADATA\_SIZE - 1); |
|  |  | int length = read\_block(fd, index[i], NULL, expected, |
|  |  | ((unsigned char \*) xattr\_ids) + |
|  |  | (i \* SQUASHFS\_METADATA\_SIZE)); |
|  |  | ((long long) i \* SQUASHFS\_METADATA\_SIZE)); |
|  |  | TRACE("Read xattr id table block %d, from 0x%llx, length " |
|  |  | "%d\n", i, index[i], length); |
|  |  | if(length == 0) { |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f95864a`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fplougher%2Fsquashfs-tools%2Fcommit%2Ff95864afe8833fe3ad782d714b41378e860977b1) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.gentoo.org_0f8e89fb_20250125_124914.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# SQUASHFS: Multiple vulnerabilities — GLSA **201701-73**

Multiple vulnerabilities have been discovered in SQUASHFS, the
worst of which may allow execution of arbitrary code

### Affected packages

| Package | **sys-fs/squashfs-tools** on all architectures |
| --- | --- |
| Affected versions | < **4.3-r1** |
| Unaffected versions | >= **4.3-r1** |

### Background

Squashfs is a compressed read-only filesystem for Linux. Squashfs is
intended for general read-only filesystem use, for archival use (i.e. in
cases where a .tar.gz file may be used), and in constrained block
device/memory systems (e.g. embedded systems) where low overhead is
needed.

### Description

Multiple vulnerabilities have been discovered in SQUASHFS. Please review
the CVE identifiers referenced below for details.

### Impact

Remote attackers, by enticing a user to process a specially crafted
SQUASHFS image, could execute arbitrary code with the privileges of the
process.

### Workaround

There is no known workaround at this time.

### Resolution

All SQUASHFS users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=sys-fs/squashfs-tools-4.3-r1"

```
### References

* [CVE-2015-4645](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-4645)
* [CVE-2015-4646](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-4646)

**Release date**

January 29, 2017

**Latest revision**

January 29, 2017: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [552484](https://bugs.gentoo.org/show_bug.cgi?id=552484)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from github.com_9cd109bb_20250126_084039.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-j67g-6r6x-5v63)

**CVE-2015-4645**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-j67g-6r6x-5v63)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2015-4645](/advisories/GHSA-j67g-6r6x-5v63)

## Integer overflow in the read\_fragment\_table\_4 function in...

Moderate severity

Unreviewed

Published
May 13, 2022
to the GitHub Advisory Database
•
Updated Feb 1, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-j67g-6r6x-5v63/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

Integer overflow in the read\_fragment\_table\_4 function in unsquash-4.c in Squashfs and sasquatch allows remote attackers to cause a denial of service (application crash) via a crafted input, which triggers a stack-based buffer overflow.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2015-4645>
* [devttys0/sasquatch#5](https://github.com/devttys0/sasquatch/pull/5)
* [plougher/squashfs-tools@f95864a](https://github.com/plougher/squashfs-tools/commit/f95864afe8833fe3ad782d714b41378e860977b1)
* <https://bugzilla.redhat.com/show_bug.cgi?id=1234886>
* <https://security.gentoo.org/glsa/201701-73>
* <http://lists.fedoraproject.org/pipermail/package-announce/2015-July/162171.html>
* <http://lists.fedoraproject.org/pipermail/package-announce/2015-July/162226.html>
* <http://www.securityfocus.com/bid/75272>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2015-4645)
Mar 17, 2017

Published to the GitHub Advisory Database
May 13, 2022

Last updated
Feb 1, 2023

### Severity

Moderate

5.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H

### EPSS score

0.999%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (84th percentile)

### Weaknesses

[CWE-190](/advisories?query=cwe%3A190)

### CVE ID

CVE-2015-4645

### GHSA ID

GHSA-j67g-6r6x-5v63

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-j67g-6r6x-5v63/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from access.redhat.com_a95b352e_20250126_084043.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from github.com_2b171659_20250126_084041.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-m77j-hm9g-ppq8)

**CVE-2015-4646**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-m77j-hm9g-ppq8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2015-4646](/advisories/GHSA-m77j-hm9g-ppq8)

## (1) unsquash-1.c, (2) unsquash-2.c, (3) unsquash-3.c, and...

High severity

Unreviewed

Published
May 13, 2022
to the GitHub Advisory Database
•
Updated Feb 1, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-m77j-hm9g-ppq8/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

(1) unsquash-1.c, (2) unsquash-2.c, (3) unsquash-3.c, and (4) unsquash-4.c in Squashfs and sasquatch allow remote attackers to cause a denial of service (application crash) via a crafted input.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2015-4646>
* [plougher/squashfs-tools@f95864a](https://github.com/plougher/squashfs-tools/commit/f95864afe8833fe3ad782d714b41378e860977b1)
* <https://security.gentoo.org/glsa/201701-73>
* <http://seclists.org/oss-sec/2015/q2/756>
* <http://www.securityfocus.com/bid/75272>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2015-4646)
Apr 13, 2017

Published to the GitHub Advisory Database
May 13, 2022

Last updated
Feb 1, 2023

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### EPSS score

0.614%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (79th percentile)

### Weaknesses

[CWE-20](/advisories?query=cwe%3A20)

### CVE ID

CVE-2015-4646

### GHSA ID

GHSA-m77j-hm9g-ppq8

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-m77j-hm9g-ppq8/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugzilla.redhat.com_0059afb6_20250125_124912.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1234886)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1234886)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1234886)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1234886

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1234886**](show_bug.cgi?id=1234886)
(CVE-2015-4645)
- [CVE-2015-4645](https://access.redhat.com/security/cve/CVE-2015-4645) squashfs-tools: integer overflow in read\_fragment\_table\_4

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2015-4645 squashfs-tools: integer overflow in read\_fragment\_table\_4

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED WONTFIX | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2015-4645 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1234888](show_bug.cgi?id=1234888 "CLOSED ERRATA - CVE-2015-4645 CVE-2015-4646 squashfs-tools: various flaws [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1234889](show_bug.cgi?id=1234889) | | TreeView+ | [depends on](buglist.cgi?bug_id=1234886&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1234886&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2015-06-23 12:54 UTC by Vasyl Kaigorodov | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 13:34 UTC ([History](show_activity.cgi?id=1234886)) | | [CC List:](page.cgi?id=fields.html#cclist) | 7 users (show)  bruno carnil jarod jrusnack peterm plougher tcallawa | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2015-10-09 21:01:33 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1234886#c0)  Vasyl Kaigorodov    2015-06-23 12:54:27 UTC  ``` Integer overflow issue was reported in squashfs-tools. Following code in unsquash-4.c overflows the bytes variable, so that the allocation of fragments_bytes[] has an erroneous size.    int bytes = SQUASHFS_FRAGMENT_BYTES(sBlk.s.fragments);   ...   fragment_table = malloc(bytes)  Upstream bug report: <https://github.com/devttys0/sasquatch/pull/5> Upstream fix: <https://github.com/gcanalesb/sasquatch/commit/6777e08cc38bc780d27c69c1d8c272867b74524f>   ```  [Comment 1](show_bug.cgi?id=1234886#c1)  Vasyl Kaigorodov    2015-06-23 12:58:20 UTC  ```  Created squashfs-tools tracking bugs for this issue:  Affects: fedora-all [[bug 1234888](show_bug.cgi?id=1234888 "CLOSED ERRATA - CVE-2015-4645 CVE-2015-4646 squashfs-tools: various flaws [fedora-all]")]   ```  [Comment 2](show_bug.cgi?id=1234886#c2)  Bruno Wolff III    2015-06-23 22:50:32 UTC  ``` While the code in question is in Phillip's branch, note that this issue is being reported against an upstream version of squashfs-tools that has diverged from the one we use.  The patch with the final set of fixes looks reasonable at first glance and we care carry it as a patch. But given they haven't been keeping up with changes Phillip has made since 4.3 was released, I don't want to switch over to using them as an upstream (at least not at this time).   ```  [Comment 3](show_bug.cgi?id=1234886#c3)  Bruno Wolff III    2015-06-24 16:20:58 UTC  ``` The upstream patch really should have fixed the trace statement output as well. I don't think there is a security issue with the output formats being too narrow, but the output could be confusing. Casting to unsigned long is probably the most portable way to print size_t. The 'z' modifier is too new. I did find some comments that said it is possible for size_t to be wider than unsigned long, but this seemed rare and as long as the value to be printed fit in an unsigned long, the output would still be OK.   ```  [Comment 4](show_bug.cgi?id=1234886#c4)  Fedora Update System    2015-07-19 01:57:45 UTC  ``` squashfs-tools-4.3-11.fc22 has been pushed to the Fedora 22 stable repository.  If problems still persist, please make note of it in this bug report.   ```  [Comment 5](show_bug.cgi?id=1234886#c5)  Phillip Lougher    2015-07-20 23:56:20 UTC  ``` (In reply to Bruno Wolff III from [comment #2](show_bug.cgi?id=1234886#c2))  > The patch with the final set of fixes looks reasonable at first glance and > we care carry it as a patch. But given they haven't been keeping up with > changes Phillip has made since 4.3 was released, I don't want to switch over > to using them as an upstream (at least not at this time).  That's good to know because I'm extremely unhappy with sasquatch.  Whilst it's aims are laudable, it simply promulgates all the bad practices inherent in the hacked and extremely poor vendor specific implementations which have plagued Squashfs for years.  Many of these hacked implementations are full of bugs, and will make Unsquashfs extremely unstable...  In addition Squashfs has a specific filesystem layout, and divergences from that are treated as errors and possible security attack vectors (trying to make Squashfs do something wrong).  To move to a non-deterministic "guess work" system where filesystem differences are merely treated as "hints" it's been generated by a "vendor variant" makes a mockery of any security checks, and the two years of security hardening I put into Squashfs-tools 4.3.  In otherwords you can either make Squashfs-tools secure from attacks by carefully checking the filesystem is correct, OR you can make Squashfs flexible and tolerant of hacked up vendor messes by using kludges and guess work.  You can't do both.  I think it is outrageous a distribution would even consider moving from the official tools to an entirely unofficial and unendorsed fork.  To make myself clear it is not simply unendorsed, I publically denounce it now.   ```  [Comment 6](show_bug.cgi?id=1234886#c6)  Bruno Wolff III    2015-07-21 00:35:24 UTC  ``` Phillip, I'm glad you commented here. I was wondering if you were aware of the CVE as it didn't seem to be reported at sourceforge. While the bug does seem to plausibly apply to your version of squashfs, I wasn't sure if there were earlier checks that would keep the data from being out of range at the point where the patch changed things.   ```  [Comment 7](show_bug.cgi?id=1234886#c7)  Phillip Lougher    2015-07-21 02:50:54 UTC  ``` (In reply to Bruno Wolff III from [comment #6](show_bug.cgi?id=1234886#c6)) > Phillip, I'm glad you commented here. I was wondering if you were aware of > the CVE as it didn't seem to be reported at sourceforge. While the bug does > seem to plausibly apply to your version of squashfs, I wasn't sure if there > were earlier checks that would keep the data from being out of range at the > point where the patch changed things.  No, this isn't checked in Unsquashfs.  Compared to the Squashfs kernel code and the Mksquashfs code-base Unsquashfs has fewer sanity checks.  This is for two reasons: one simply a matter of prioritisation, and the other due to the expected use-case.  The prioritisation issue should be simple to understand.  In terms of vulnerability the kernel is most critical, then Mksquashfs and last Unsquashfs, and the hardening and addition of sanity checks have been prioritised in that order.  The expected use-case is a little less obvious.  With the kernel code hardening, it has become increasingly impossible to mount a corrupted Squashfs filesystem.  Given we would like to allow users to extract the good data in a corrupted filesystem using Unsquashfs, it stand to reason that Unsquashfs by definition needs to be more tolerant of filesystem corruption and have less sanity checks.  Unfortunately this means Unsquashfs is more vulnerable to CVEs than the other code.  The question here is what to do about this raised CVE, and what to do in the future.  With regards to this CVE, the posted patch is a band-aid, it fixes the symptom but not the cause.  The cause is a corrupted fragments superblock entry, the symptom is this value unchecked then leads to a variable overflow and a stack overflow.  The fix isn't to paper over the variable overflow and the stack overflow, this will probably simply lead to incorrect behaviour later on.  On the one hand the correct fix is obvious, and that is to introduce more sanity checks of the superblock information.  But on the other hand this goes against the idea that Unsquashfs is supposed to be more tolerant of filesystem corruption.  The ultimate fix in the future is likely to mean making Unsquashfs more actively tolerant of filesystem corruption, rather than at the moment turning a blind eye to filesystem corruption and hoping for the best.  What this means is Unsquashfs will need to actively detect filesystem corruption, and rather than simply aborting, try to actively work around the known filesystem corruption.  To do this completely is a big task.  In the meantime I will work on a more focused patch for this CVE that fixes the cause and not the symptom.   ```  [Comment 8](show_bug.cgi?id=1234886#c8)  Fedora Update System    2015-07-21 08:12:59 UTC  ``` squashfs-tools-4.3-11.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1234886&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)


