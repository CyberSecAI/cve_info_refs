The provided content relates to CVE-2015-4020.

**Root cause of vulnerability:**
- The vulnerability lies in the `api_endpoint` method of the `Gem::RemoteFetcher` class in RubyGems. This method constructs a new URI based on the target domain returned by a DNS query. The code did not properly validate the returned target, allowing an attacker to inject a malicious domain.

**Weaknesses/vulnerabilities present:**
- Insufficient validation of the target domain returned from a DNS query.
- The code was using a regular expression that only checked if the target *ended* with the expected host, allowing for arbitrary subdomains of the intended domain to be introduced.

**Impact of exploitation:**
- An attacker could potentially redirect the RubyGems client to a malicious server. This can allow for a man-in-the-middle attack allowing the attacker to supply malicious gems.

**Attack vectors:**
- By controlling the DNS response for the target domain.
- The attacker would need to perform a DNS spoofing attack or be in a position to control the DNS server that is queried by the vulnerable system.

**Required attacker capabilities/position:**
- Ability to manipulate DNS records or perform a DNS spoofing attack.
- The attacker must be able to intercept or control the DNS resolution process.