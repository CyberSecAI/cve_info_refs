=== Content from www-01.ibm.com_ad8ffb10_20250125_140659.html ===


[IBM Support](https://www.ibm.com/mysupport/)

##

No results were found for your search query.

---

##### **Tips**

To return expected results, you can:

* **Reduce the number of search terms.** Each term you use focuses the search further.
* **Check your spelling.** A single misspelled or incorrectly typed term can change your result.
* **Try substituting synonyms for your original terms.** For example, instead of searching for "java classes", try "java training"
* **Did you search for an IBM acquired or sold product ?** If so, follow the appropriate link below to find the content you need.

Our apologies

Search results are not available at this time. Please try again later or use one of the other support options on this page.

# Security Bulletin: Weak file permissions vulnerability affects IBM Tivoli Monitoring for Tivoli Storage Manager (CVE-2015-4927)

### Security Bulletin

## Summary

Weak file permissions exist on several files after the installation of Tivoli Storage Manager Reporting and Monitoring in a Linux or AIX environment. This has the potential of privilege escalation by an attacker.

## Vulnerability Details

**CVEID:** [CVE-2015-4927](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4927) The installation of Tivoli Storage Manager Reporting & Monitoring leaves world-writable files with root ownership on the system for Unix and Linux versions. There is the potential of privilege escalation by an attacker making use of these files.

CVSS Base Score: 7.2

CVSS Temporal Score: See <https://exchange.xforce.ibmcloud.com/vulnerabilities/104087> for the current score

CVSS Environmental Score\*: Undefined

CVSS Vector: (AV:L/AC:L/Au:N/C:C/I:C/A:C)

## Affected Products and Versions

IBM Tivoli Monitoring for Tivoli Storage Manager (Reporting and Monitoring) 7.1, 6.3, 6.2, and 6.1 versions are affected by this vulnerability.

## Remediation/Fixes

If the IBM Tivoli Monitoring for Tivoli Storage Manager product is already installed, please use the instructions provided in the Workarounds and Mitigations section.

| ***Tivoli Storage Monitoring for Tivoli Storage Manager Version (Reporting and Monitoring)*** | ***First Fixing VRMF Level*** | ***Client*** ***Platform*** | ***Link to Fix / Fix Availability Target*** |
| --- | --- | --- | --- |
| 7.1 | 7.1.3 | AIX Linux | ftp://public.dhe.ibm.com/storage/tivoli-storage-management/maintenance/reporting/v7r1/7.1.3.000/ |
| 6.3 | 6.3.6 | AIX Linux | ftp://public.dhe.ibm.com/storage/tivoli-storage-management/maintenance/reporting/v6r3/6.3.6.000/ |

**NOTES:**

The Windows platform is not affected by this security issue.

Extended support customers using IBM Tivoli Monitoring versions 6.2 or 6.1 for Tivoli Storage Manager can use the instructions provided in the Workaround and Mitigations section.

## Workarounds and Mitigations

After installation of IBM Tivoli Monitoring for Tivoli Storage Manager Reporting and Monitoring feature, the secureMain command should be run to set your required security levels for the installed directories.

To update the permission levels on the installed directories, you need to run the secureMain command.

**Syntax**

<install\_dir>/bin/secureMain [-h install\_dir] [-g common\_group] [-t type\_code] lock

<install\_dir>/bin/secureMain [-h install\_dir] [-g common\_group] unlock

**Parameters**

*install\_dir* - is the directory path for the IBM Tivoli Monitoring installation. If this parameter is not supplied, the script attempts to determine the location of the installation directory.

For example: /opt/tivoli/tsm/reporting/itm

 *common\_group* - is a group ID common to all of the user IDs that are used to run components in this installation. The user ID that is used to run the installation must also be a member of the group ID specified. The only exception is the root ID, which is not required to be a member of the group ID specified.

*type\_code* - is a component code that belongs to an installed component. You can specify multiple -t options to create a list of component codes to be processed.

**Notes**

If the secureMain command is started with no parameters, the usage text is displayed.

The lock parameter is used to set more restrictive permissions in an IBM Tivoli Monitoring installation. It must be run after you install or configure components.

When the secureMain command with the lock parameter is run with no other parameters, the permissions are set to execute permissions (755) for most directories. However, world write permissions (777) are set on a number of directories. When certain components that are commonly run by using multiple user IDs are present in the installation, many more files have world write permissions set.

When the secureMain command is run with the lock and -g common\_group parameters set, the permissions are set to execute permissions and the directories have their group owner changed to the common\_group specified. No directories are left with world write permissions. Even when components that are commonly run by using multiple user IDs are present in the installation, no files are set to world write permissions. Additionally, the common\_group value is written to a file and is used for all future invocations of secureMain command with the lock parameter in the same installation, unless the -g common\_group parameter is specified and the common\_group is different from the previous value.

When the secureMain command is run with the lock and -t type\_code parameters set, sections of the installation might be skipped when you set permissions to execute permission. Common directories, like bin, config, registry, and logs are always processed. Only directories specific to the specified type\_code components are processed. The other component directory trees are skipped.

You can run the secureMain command with the unlock parameter to set less strict permissions in an IBM Tivoli Monitoring installation.

Running the secureMain command with the unlock parameter is normally not necessary, but can be run if required. You must run the command before you install or configure components.

When the secureMain command is run with the unlock parameter does not return the installation to the permission state that it was in before you ran the secureMain command with the lock parameter. It processes only the common directories, like bin, config, registry, and logs.

**Example**

The following example locks the installation by using the common group itmgroup:

secureMain -g itmgroup lock

The following example locks the base and mq component directories by using the common group itmgroup:

secureMain -g itmgroup -t mq lock

## Get Notified about Future Security Bulletins

Subscribe to [My Notifications](https://www.ibm.com/support/pages/node/718119) to be notified of important product support alerts like this.

### References

[Complete CVSS v2 Guide](http://www.first.org/cvss/v2/guide "Link resides outside of ibm.com")

[On-line Calculator v2](http://nvd.nist.gov/CVSS-v2-Calculator "Link resides outside of ibm.com")

Off

## Related Information

[IBM Secure Engineering Web Portal](http://www.ibm.com/security/secure-engineering/bulletins.html)

[IBM Product Security Incident Response Blog](http://www.ibm.com/blogs/psirt)

## Acknowledgement

Joe Hart working with NCC Group

## Change History

27 October 2015 - Initially published

04 November 2015 - Updated Acknowledgement and target date for 6.3 fix.

25 July 2016 - Added fix for 6.3.6

\*The CVSS Environment Score is customer environment specific and will ultimately impact the Overall CVSS Score. Customers can evaluate the impact of this vulnerability in their environments by accessing the links in the Reference section of this Security Bulletin.

## Disclaimer

Review the [IBM security bulletin disclaimer and definitions](https://www.ibm.com/support/pages/node/6610583#disclaimer) regarding your responsibilities for assessing potential impact of security vulnerabilities to your environment.

[{"Product":{"code":"SSGSG7","label":"Tivoli Storage Manager"},"Business Unit":{"code":"BU058","label":"IBM Infrastructure w\/TPS"},"Component":"Server","Platform":[{"code":"PF002","label":"AIX"},{"code":"PF016","label":"Linux"}],"Version":"All Supported Versions","Edition":"All Editions","Line of Business":{"code":"LOB26","label":"Storage"}}]

## Was this topic helpful?

### Document Information

**Modified date:**

17 June 2018

## UID

swg21969340

Page Feedback

## Share your feedback

### Need support?

* Submit feedback to IBM Support
* 1-800-IBM-7378 (**USA**)
* [Directory of worldwide contacts](//www.ibm.com/planetwide/index.html#region)


