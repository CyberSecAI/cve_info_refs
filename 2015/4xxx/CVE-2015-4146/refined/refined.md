```
{
  "CVE-2015-4146": {
    "Description": "A vulnerability was found in EAP-pwd server and peer implementation used in hostapd and wpa_supplicant, respectively. The EAP-pwd/Commit and EAP-pwd/Confirm message payload is processed without verifying that the received frame is long enough to include all the fields. This results in a buffer read overflow of up to couple of hundred bytes.  Further research into this issue found that the fragment reassembly processing is also missing a check for the Total-Length field and this could result in the payload length becoming negative. This itself would not add more to the vulnerability due to the payload length not being verified anyway. However, it is possible that a related reassembly step would result in hitting an internal security check on buffer use and result in the processing being terminated.",
    "Root cause": "The EAP-pwd peer implementation incorrectly handles asymmetric fragmentation behavior. The L (Length) and M (More) flags are not cleared before deciding whether a locally generated response requires fragmentation. This could lead to the use of invalid flags from the server which would cause a security check to be triggered, terminating the process due to invalid buffer allocation.",
    "Vulnerabilities": [
      "Buffer read overflow due to missing payload length validation.",
      "Missing check for Total-Length field in fragment reassembly leading to potential negative payload length.",
      "Incorrect handling of L and M flags in fragmentation, leading to security check termination."
    ],
    "Impact": "Denial of service by process termination due to a buffer read overflow being detected or triggering an internal security check on buffer use due to invalid buffer allocation.",
      "Attack vectors": [
      "Sending specially crafted EAP-pwd/Commit and EAP-pwd/Confirm messages with insufficient payload length.",
      "Manipulating the Total-Length field during fragment reassembly to cause a negative length.",
      "Exploiting incorrect handling of L and M flags in fragmentation during message exchange."
    ],
    "Required attacker capabilities": "Attacker needs to be able to send network traffic to vulnerable hostapd or wpa_supplicant instances, specifically crafted EAP-pwd messages.",
     "Affected configurations": [
      "hostapd v1.0-v2.4 with CONFIG_EAP_PWD=y in the build configuration and EAP-pwd authentication server enabled in runtime configuration.",
      "wpa_supplicant v1.0-v2.4 with CONFIG_EAP_PWD=y in the build configuration and EAP-pwd enabled in a network profile at runtime."
    ]
  }
}
```