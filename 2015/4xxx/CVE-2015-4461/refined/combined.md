=== Content from mohankallepalli.blogspot.in_61e09cd0_20250125_000610.html ===

[Skip to main content](#main)

### Search This Blog

# [Mohan Kallepalli's](https://mohankallepalli.blogspot.com/)

### Multiple Vulnerabilities in eFront CMS v3.6.15.4

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[May 23, 2015](https://mohankallepalli.blogspot.com/2015/05/eFront-cms-multiple-bugs.html "permanent link")

Hi friends,

I am back with Three stories Today. There are multiple critical bugs effecting the e-front, one of the Top 10 e-learing cms available, version 3.6.15.4 build 18023. The details are as follows.

1. Directory Traversal       ([CVE : 2015-4461](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4461))
2. Local File Inclusion      ([CVE : 2015-4462](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4462))
3. Bypass for Blocked extension file uploads      ([CVE : 2015-4463](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4463))

About the e-front:

E-front is one of the Top 10 e-learning cms available free on the market till date. A small description from the vendor's site:

"The core of eFront is distributed as an open-source project. We have created a superior training product and we are not afraid to let you try it! The open-source edit of eFront will cover a wide range of your needs. If you are looking for a specialized solution then take a look at [different efront editions](http://www.efrontlearning.net/functionality-matrix "eFront editions")."

The Issues are fixed as part of new release, efront v3.6.15.5 build 18024. You can find the change log [here](http://forum.efrontlearning.net/viewtopic.php?f=15&t=9841)

Point of the Story:

e-front has a wide range of security precautions when using publicly. For example, server side files like php, jsp, asp and/or exe files are not supported to use within e-front. So, as a security researcher, I am curious to find the security holes in the cms and hence started to dissect the code and application. Finally I was able to find 3 critical vulnerabilities effecting the latest version of the cms (v3.6.15.4 build 18023).

Background Story:

Once the CMS is installed successfully, it creates 3 user roles namely Admin, Professor and Student. The user privilege required for these attacks is the Professor role. The issues are effecting all the e-front editions earlier than 3.6.15.4 and also applicable for both environments on Linux and Windows (32bit and 64bit editions).

Foreground Story:

1. Directory Traversal Attack :

For Professor role users, there is a feature designed to upload files as the content for different lessons. In the same feature, professor's can create multiple directories within the content/lessons directory. After creating the new directory, while opening the directory contents through the application, application sends a GET request with the absolute path of the directory as follows.

<http://localhost/www/professor.php?ctg=file_manager&ajax=filesTable&limit=20&offset=0&sort=&order=desc&other=C:/xampp/htdocs/Portal/www/content/lessons/1/java/>

The Parameter "**other**" is found to be vulnerable to path traversal attack. By pointing the parameter "**other**" to your target directory, we can traverse to the directory and lists all the contents of the directory.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjMIfdbuEEMYOzOzq4D_OzCTd2IzW-2eHekRUzqNWlpBtBP5tKdwrRtuUV4dB-RMl6XIk7HaoARwTf5xpRR9VCSertjTW386KJcaX9Ir_E5LDuO0GZnZfOTQ5uM1JYaKdJ_GwV2D0hlB_fS/s640/Directory_Traverse_Attack.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjMIfdbuEEMYOzOzq4D_OzCTd2IzW-2eHekRUzqNWlpBtBP5tKdwrRtuUV4dB-RMl6XIk7HaoARwTf5xpRR9VCSertjTW386KJcaX9Ir_E5LDuO0GZnZfOTQ5uM1JYaKdJ_GwV2D0hlB_fS/s1600/Directory_Traverse_Attack.jpg)

2. Local File Inclusion :

In the same file uploading feature, we will have two options to upload files into the directory. one is using file upload and the second options is using files from remote urls.

e-front before 3.6.15.4 version accepts local files also within this 'files from remote url' option. By exploiting this weakness, I was able to upload local files into the application server file system.

For example, php.ini file of the server:

vulnerable url: <http://localhost/www/professor.php?ctg=file_manager>

vulnerable parameter:  url\_upload
vulnerable payload : c:\xampp\php\php.ini

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhub2SqF4cNfq4VzMW3xih75qKOlXBMN7ddDoSIulOTnxWthx96cCAvCX_kwhSZboKZkSRX2AqMtPD9tvtiNAvg0tVEA_lR6LesrCzH1taFBo-xFLjldrM8JgEez6I5eVMQgutTHXG2QBBJ/s640/lfi_1.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhub2SqF4cNfq4VzMW3xih75qKOlXBMN7ddDoSIulOTnxWthx96cCAvCX_kwhSZboKZkSRX2AqMtPD9tvtiNAvg0tVEA_lR6LesrCzH1taFBo-xFLjldrM8JgEez6I5eVMQgutTHXG2QBBJ/s1600/lfi_1.jpg)

once the request is processed, an instance of php.ini file is copied into the current directory and can be accessed directly from the location : /www/content/lessons/<lesson no>/<directory name>/php.ini

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgnUI_4zw4yefIWT2p0NLNYhPslPbu-vLgRB3cpZnesQLX8NMMX-3GMllauUDHaJi9N33jOAKd8dJFlsRUfFXApRDxuJnqAPtXzYDZDGAJ85Oe5XaDe4wrP2iM8rZmbQ_5cggBA5cpkt8IM/s640/lfi_2.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgnUI_4zw4yefIWT2p0NLNYhPslPbu-vLgRB3cpZnesQLX8NMMX-3GMllauUDHaJi9N33jOAKd8dJFlsRUfFXApRDxuJnqAPtXzYDZDGAJ85Oe5XaDe4wrP2iM8rZmbQ_5cggBA5cpkt8IM/s1600/lfi_2.jpg)

The same can be directly access from the url  <http://localhost/www/content/lessons/2/Test/php.ini>

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj4nCSY92TBApeGWnqCkorbLOSKN44ghyIN5OLT_lbP_zZQPgGVYAf6u621_9Buqyn4g_F7H7HEqXRU7SFN9GhAyLCo-lYprijEe5QppNwtoZgZ4OQMiPt_TriMy5rHa6vwgz6OBmpNNIwl/s640/php_ini.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj4nCSY92TBApeGWnqCkorbLOSKN44ghyIN5OLT_lbP_zZQPgGVYAf6u621_9Buqyn4g_F7H7HEqXRU7SFN9GhAyLCo-lYprijEe5QppNwtoZgZ4OQMiPt_TriMy5rHa6vwgz6OBmpNNIwl/s1600/php_ini.jpg)

3. Unrestricted Remote file Inclusion :

The same file upload feature has another weakness which enabled me to upload blocked extension files including php and exe files into the target server file system.

e-front has inbuilt security features to block file uploads of restricted file types like php, jsp and exe etc. If we try to upload any remote file with extension php, application throws an exception related to blocked file extensions.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhc9mezHeX8RVueiqqnG2a5AX9-tFzf6WQN0o6m797Cq-r1y88Pt06Vh0P1ZuGpXiT30GM5zWFLeDcWABue3ZIrRUq5RHe0EjZ70QCoeCjn5jAgllvgfWKvV8FVi8fMssJRcJjJcfXnetTl/s640/rfi_1.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhc9mezHeX8RVueiqqnG2a5AX9-tFzf6WQN0o6m797Cq-r1y88Pt06Vh0P1ZuGpXiT30GM5zWFLeDcWABue3ZIrRUq5RHe0EjZ70QCoeCjn5jAgllvgfWKvV8FVi8fMssJRcJjJcfXnetTl/s1600/rfi_1.jpg)

Here, we can see that the application is validating the file extension of the given URL. But I was able to find a bypass for this blacklist based input validation.

To bypass this validation, I added an additional parameter at the end of the url, such as login=test. Here, login and test are not having any significance apart from bypassing the validation.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj1rPk4Q3xDD3xvilX4i1Ewp-dea1AbTEyttGxwBCI-Rke4DPNNlwq6sFzgPyULpjFFliGrGG3lzwNav2mD_C39KOy7Cr-EqNWAoZJZSmRQ_4TpBUlD-N3rRubpKm-XpQ15SadiHMZTx4Ud/s640/rfi_21.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj1rPk4Q3xDD3xvilX4i1Ewp-dea1AbTEyttGxwBCI-Rke4DPNNlwq6sFzgPyULpjFFliGrGG3lzwNav2mD_C39KOy7Cr-EqNWAoZJZSmRQ_4TpBUlD-N3rRubpKm-XpQ15SadiHMZTx4Ud/s1600/rfi_21.jpg)

By adding an additional parameter at the end of the url, extension based validation is bypassed and the file is uploaded successfully into the file server. However, the file content is not as I expected.

In this process, when I uploaded the phpinfo.php file, a file with the exact name is created, but the content of HTML code which is a result of the file execution on my own domain. So when I executed the file, the output is always same and also it is not from the original server.

So my challenge is to upload a php file with content of php code. For this, I created my own php file with name phpinfo.php with the following content.

phpinfo.php ( on 192.168.6.58 - attacker controlled domain):

<?php

    echo "<?php  phpinfo();  ?>";

?>

which is executed on the 192.168.6.58 (my own domain) and sends <?php  phpinfo();  ?> as the output and hence   <?php  phpinfo();  ?>    is written into phpinfo.php  on target server.

phpinfo.php ( on 192.168.0.55 - target victim domain):

<?php

    phpinfo();

?>

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiSeLLVLM4YZp4KPHvb_X1cdGpwInOlx6V0quo4itbOfzfCprSslBjdbh13RQFmzF6KN4sfuy3LzPQKXDRxlM8ul2el0jybhMbHJrqBeXn-0acsYLOPYjHveF-Q0GxB3HFwkZVgxoa4uVYc/s640/rfi_3.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiSeLLVLM4YZp4KPHvb_X1cdGpwInOlx6V0quo4itbOfzfCprSslBjdbh13RQFmzF6KN4sfuy3LzPQKXDRxlM8ul2el0jybhMbHJrqBeXn-0acsYLOPYjHveF-Q0GxB3HFwkZVgxoa4uVYc/s1600/rfi_3.jpg)

Once the php file is created, the file is available in the same location as previous, which is, <http://localhost/www/content/lessons/18/phpinfo.php>

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjnsREU58IgtkKCwAakQL8lCVnlvZ7SaRvQOkNLHiEg-5vU4Tlp0YuYa92PCtGALAKsdW0JcBEcK22L88U8yPbUnp-2d_qfSi9ntILKWFVOLRr6rosh_SxIgrWTDasAB_bT32_vjELIC_Ev/s640/rfi_4.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjnsREU58IgtkKCwAakQL8lCVnlvZ7SaRvQOkNLHiEg-5vU4Tlp0YuYa92PCtGALAKsdW0JcBEcK22L88U8yPbUnp-2d_qfSi9ntILKWFVOLRr6rosh_SxIgrWTDasAB_bT32_vjELIC_Ev/s1600/rfi_4.jpg)

In this way, I was able to upload any blacklisted extension files into the file server and can execute also.

This is it guys... Done for today... Will be back with more again.. stay tuned.

As always, suggestions and questions are always welcome.. Thanks for reading.... Bye

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Comments

1. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Anika](https://www.blogger.com/profile/03454651125810453352)[16 November 2018 at 06:10](https://mohankallepalli.blogspot.com/2015/05/eFront-cms-multiple-bugs.html?showComment=1542377451601#c5845127401389915994)

   Extra blog
   [London Escorts Agency](https://www.park-lane-escorts.co/)

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=1302518404522331696&postID=5845127401389915994)Replies
   Reply

Add commentLoad more...

#### Post a Comment

### Popular posts from this blog

### [Cross Site Scripting through callback functionality](https://mohankallepalli.blogspot.com/2014/04/cross-site-scripting-through-callback.html)

[April 06, 2014](https://mohankallepalli.blogspot.com/2014/04/cross-site-scripting-through-callback.html "permanent link")

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj35JWEmZHq0Bq5dpym9sOx0e70Wn0fdLQDqHQH9qw8nyjgcz2JZSny_3-FeIyQDhSxh2PQPg4Iyh8qf5AOXpkb96HuinEjvSiqvKWWOas4kZDawvvzH-9b5j-vOunEh-DQpJ0p-9d_VBwV/s1600/blog_2_0.jpg)](https://mohankallepalli.blogspot.com/2014/04/cross-site-scripting-through-callback.html)

Hello Guys, Today i would like to share a Cross Site Scripting Vulnerability that was existing in JSON/AJAX callback functionality. I found this vulnerability a few days back, but as the bug is fixed now, i'd like to share the story. The vulnerability is existing in the forgot password functionality. The forgot password functionality uses an ajax based request/response mechanism within the login page. While testing the application, i observed that the application is using a callback function to render the response into the application. This callback function name is being passed as a GET parameter. With a little analysis, i found that the callback parameter is vulnerable to Cross Site Scripting vulnerability. So i extracted the forget password request and crafted a GET based URL request with a simple XSS payload as the callback value. https://www.DUMMY-WEBSITE.com/users/ajaxonforgotpassword.php?callback=<script>alert(document.cookie)</script>...

[Read more](https://mohankallepalli.blogspot.com/2014/04/cross-site-scripting-through-callback.html "Cross Site Scripting through callback functionality")

### [How I could Delete Instagram Captions and Comments ***that are not mine,***.....](https://mohankallepalli.blogspot.com/2016/04/instagram-unauthorized-comment-deletion.html)

[April 16, 2016](https://mohankallepalli.blogspot.com/2016/04/instagram-unauthorized-comment-deletion.html "permanent link")

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj2SJvWuNBtNUdlkz9ZSfuxZcsglNXaNpZKyH1tHHp5Bch5UE7fewouDIUHBiGxOjpwcVN1bnmE5vi40U1MM-7AzfdjH-uuq3B7AZ4OdhHBswOh7jKSLRGGVLq6C-h3FuM7TDoa9Hk7OEwD/s400/Screen+Shot+2016-03-29+at+5.30.19+am.png)](https://mohankallepalli.blogspot.com/2016/04/instagram-unauthorized-comment-deletion.html)

Its been a while since i published my last post. So, here i come with a write up for chaining of multiple issues in Facebook Acquisition - Instagram, that could allowed me to delete entire comments/captions from the Instagram DB . Instagram Web and mobile Applications For the first 2 hours or so, I could not find anything as each request is added with a signature and I am lazy enough not to understand/reverse the signature logic. So as usual, i was about the close my Mac and then, saw a request without signature. request without a signature Bingo..something to play around. so i started working on the request, trying to find most common bugs, like sqli,xss, csrf etc.. Then to cross verify a csrf issue, I used my browser. But to my surprise, in later requests in browser app, there is no signature at all, but of-course csrf issue is properly protected. So while testing with both the App and Browser together, I realised that there is an authorisation ...

[Read more](https://mohankallepalli.blogspot.com/2016/04/instagram-unauthorized-comment-deletion.html "<marquee behavior=\"alternate\" direction=\"left\">How I could Delete Instagram Captions and Comments <i><b>that are not mine,</b></i>.....</marquee>")

[Powered by Blogger](https://www.blogger.com)

Theme images by [Michael Elkan](http://www.offset.com/photos/394244)

[Google Security Team](https://www.blogger.com/profile/18367333964535156075)

[Visit profile](https://www.blogger.com/profile/18367333964535156075)

### Archive

* [2017
  2](https://mohankallepalli.blogspot.com/2017/)

  + [December
    1](https://mohankallepalli.blogspot.com/2017/12/)
  + [January
    1](https://mohankallepalli.blogspot.com/2017/01/)

* [2016
  3](https://mohankallepalli.blogspot.com/2016/)

  + [May
    1](https://mohankallepalli.blogspot.com/2016/05/)
  + [April
    2](https://mohankallepalli.blogspot.com/2016/04/)
* [2015
  1](https://mohankallepalli.blogspot.com/2015/)

  + [May
    1](https://mohankallepalli.blogspot.com/2015/05/)

    - [Multiple Vulnerabilities in eFront CMS v3.6.15.4](https://mohankallepalli.blogspot.com/2015/05/eFront-cms-multiple-bugs.html)
* [2014
  8](https://mohankallepalli.blogspot.com/2014/)

  + [November
    2](https://mohankallepalli.blogspot.com/2014/11/)
  + [July
    1](https://mohankallepalli.blogspot.com/2014/07/)
  + [April
    4](https://mohankallepalli.blogspot.com/2014/04/)
  + [March
    1](https://mohankallepalli.blogspot.com/2014/03/)

Show more
Show less

### [Report Abuse](https://www.blogger.com/go/report-abuse)


