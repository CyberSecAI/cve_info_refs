=== Content from bugs.debian.org_29db1f00_20250124_134850.html ===

# Debian Bug report logs - #774725 libmspack: CVE-2015-4467: CHM decompression: division by zero

[![version graph](version.cgi?height=2;width=2;absolute=0;package=libmspack0;fixed=libmspack%2F0.4-3;collapse=1;found=libmspack%2F0.4-2)](version.cgi?fixed=libmspack%2F0.4-3;collapse=1;info=1;absolute=0;package=libmspack0;found=libmspack%2F0.4-2)

Package:
[libmspack0](pkgreport.cgi?package=libmspack0);
Maintainer for [libmspack0](pkgreport.cgi?package=libmspack0) is [Marc Dequènes (Duck) <Duck@DuckCorp.org>](pkgreport.cgi?maint=Duck%40DuckCorp.org); Source for [libmspack0](pkgreport.cgi?package=libmspack0) is [src:libmspack](pkgreport.cgi?src=libmspack) ([PTS](https://tracker.debian.org/pkg/libmspack), [buildd](https://buildd.debian.org/libmspack), [popcon](https://qa.debian.org/popcon.php?package=libmspack)).

Reported by: [Jakub Wilk <jwilk@debian.org>](pkgreport.cgi?submitter=jwilk%40debian.org)

Date: Tue, 6 Jan 2015 20:21:01 UTC

Severity: *grave*

Tags: patch, security

Found in version libmspack/0.4-2

Fixed in version libmspack/0.4-3

**Done:** Marc Dequènes (Duck) <Duck@DuckCorp.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=774725;mbox=yes), [status mbox](bugreport.cgi?bug=774725;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=774725;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, jwilk@debian.org, pkg-clamav-devel@lists.alioth.debian.org, team@security.debian.org, Marc Dequènes (Duck) <Duck@DuckCorp.org>`:

`Bug#774725`; Package `libmspack0`.
(Tue, 06 Jan 2015 20:21:06 GMT) ([full text](bugreport.cgi?bug=774725;msg=2), [mbox](bugreport.cgi?bug=774725;mbox=yes;msg=2), [link](#1)).

---

[Message #3](#3) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=774725;msg=3), [mbox](bugreport.cgi?bug=774725;mbox=yes;msg=3), reply):

![](/cgi-bin/libravatar.cgi?email=jwilk%40debian.org)
From: Jakub Wilk <jwilk@debian.org>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: libmspack: CHM decompression: division by zero
Date: Tue, 6 Jan 2015 21:18:17 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=774725;msg=3) (text/plain, inline)]
```
```
Package: libmspack0
Version: 0.4-2
Severity: grave
Tags: security patch
Usertags: afl

libmspack crashes with SIGFPE on the attached CHM file:

$ gpg -d < sigfpe.chm.asc > sigfpe.chm
$ test/chmd_md5 sigfpe.chm
*** sigfpe.chm
d41d8cd98f00b204e9800998ecf8427e /#ITBITS
Floating point exception

Backtrace:
#0  0x5655d37b in __divdi3 ()
#1  0x56559ebb in chmd_init_decomp (file=0x56563378, self=0x56562008) at mspack/chmd.c:1132
#2  chmd_extract (base=0x56562008, file=0x56563378, filename=0x0) at mspack/chmd.c:996
#3  0x56555c40 in main (argc=2, argv=0xffffd888) at test/chmd_md5.c:44

This bug does affect ClamAV.

The attached patch should fix the problem. (But I'm not familiar with
the code base, so please double-check it.)

This bug was found using American fuzzy lop:
<https://packages.debian.org/experimental/afl>

-- System Information:
Debian Release: 8.0
 APT prefers unstable
 APT policy: (990, 'unstable'), (500, 'experimental')
Architecture: i386 (x86_64)
Foreign Architectures: amd64

Kernel: Linux 3.2.0-4-amd64 (SMP w/2 CPU cores)
Locale: LANG=C, LC_CTYPE=pl_PL.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash
Init: sysvinit (via /sbin/init)

Versions of packages libmspack0 depends on:
ii  libc6              2.19-13
ii  multiarch-support  2.19-13

--
Jakub Wilk

```
```
[[fix-division-by-zero.diff](bugreport.cgi?att=1;bug=774725;filename=fix-division-by-zero.diff;msg=3) (text/x-diff, attachment)]
```
```
[[sigfpe.chm.asc](bugreport.cgi?att=2;bug=774725;filename=sigfpe.chm.asc;msg=3) (text/plain, attachment)]
```

---

**Bug [774725](bugreport.cgi?bug=774725) cloned as bug [774766](bugreport.cgi?bug=774766)**
Request was from `Sebastian Andrzej Siewior <sebastian@breakpoint.cc>`
to `control@bugs.debian.org`.
(Wed, 07 Jan 2015 11:27:05 GMT) ([full text](bugreport.cgi?bug=774725;msg=5), [mbox](bugreport.cgi?bug=774725;mbox=yes;msg=5), [link](#4)).

---

**Added tag(s) pending.**
Request was from `Marc Dequènes (Duck) <Duck@DuckCorp.org>`
to `control@bugs.debian.org`.
(Tue, 13 Jan 2015 17:45:04 GMT) ([full text](bugreport.cgi?bug=774725;msg=7), [mbox](bugreport.cgi?bug=774725;mbox=yes;msg=7), [link](#6)).

---

**Reply sent**
to `Marc Dequènes (Duck) <Duck@DuckCorp.org>`:

You have taken responsibility.
(Tue, 13 Jan 2015 23:06:08 GMT) ([full text](bugreport.cgi?bug=774725;msg=9), [mbox](bugreport.cgi?bug=774725;mbox=yes;msg=9), [link](#8)).

---

**Notification sent**
to `Jakub Wilk <jwilk@debian.org>`:

Bug acknowledged by developer.
(Tue, 13 Jan 2015 23:06:08 GMT) ([full text](bugreport.cgi?bug=774725;msg=11), [mbox](bugreport.cgi?bug=774725;mbox=yes;msg=11), [link](#10)).

---

[Message #12](#12) received at 774725-close@bugs.debian.org ([full text](bugreport.cgi?bug=774725;msg=12), [mbox](bugreport.cgi?bug=774725;mbox=yes;msg=12), reply):

![](/cgi-bin/libravatar.cgi?email=Duck%40DuckCorp.org)
From: Marc Dequènes (Duck) <Duck@DuckCorp.org>
To: 774725-close@bugs.debian.org
Subject: Bug#774725: fixed in libmspack 0.4-3
Date: Tue, 13 Jan 2015 23:03:41 +0000
```
Source: libmspack
Source-Version: 0.4-3

We believe that the bug you reported is fixed in the latest version of
libmspack, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 774725@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Marc Dequènes (Duck) <Duck@DuckCorp.org> (supplier of updated libmspack package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Tue, 13 Jan 2015 22:51:40 +0100
Source: libmspack
Binary: libmspack0 libmspack-dev libmspack-dbg libmspack-doc
Architecture: source amd64 all
Version: 0.4-3
Distribution: unstable
Urgency: medium
Maintainer: Marc Dequènes (Duck) <Duck@DuckCorp.org>
Changed-By: Marc Dequènes (Duck) <Duck@DuckCorp.org>
Description:
 libmspack-dbg - library for Microsoft compression formats (debugging symbols)
 libmspack-dev - library for Microsoft compression formats (development files)
 libmspack-doc - library for Microsoft compression formats (documentation)
 libmspack0 - library for Microsoft compression formats (shared library)
Closes: [774725](bugreport.cgi?bug=774725) [774726](bugreport.cgi?bug=774726)
Changes:
 libmspack (0.4-3) unstable; urgency=medium
 .
   * Added (slightly modified/split) patches from Jakub Wilk to fix
     programmation errors causing segfaults and security issues:
     - fix-division-by-zero.patch
     - fix-pointer-arithmetic-overflow.patch
     - fix-name-field-boundaries.patch
     (Closes: #[774725](bugreport.cgi?bug=774725), #[774726](bugreport.cgi?bug=774726))
Checksums-Sha1:
 457bdda8573d0884706dffea347507a10486585c 2064 libmspack_0.4-3.dsc
 ef3753b20531415e59c60d2fbd9c6480cfbb4e98 4244 libmspack_0.4-3.debian.tar.xz
 f596e7aaa2a6d6fcae58bf0624be1ba68c8f193d 45774 libmspack0_0.4-3_amd64.deb
 6eb3b4483388106af402232b9cfe233821c9e70c 64114 libmspack-dev_0.4-3_amd64.deb
 725577d98a928a255ba98c088773a7baa2ede06f 83356 libmspack-dbg_0.4-3_amd64.deb
 4de4711f4279e1760b8aa93228016a2bf4c3e93f 87904 libmspack-doc_0.4-3_all.deb
Checksums-Sha256:
 52e28bac82106ccadaf36e3c071017eda75c01745b0a871f6fd97686fc045b21 2064 libmspack_0.4-3.dsc
 d76bd7b1a5299cafa2ef571904d8464e867cc668ea5020f1156de1ad3dd0ec09 4244 libmspack_0.4-3.debian.tar.xz
 7c8ebd7214b428b85840347d9355abc72dac1b9fb148a9bba7f50ebe525f52d8 45774 libmspack0_0.4-3_amd64.deb
 fb19edd1bd2b150872e6f08b2326440bdd214be16e0009f4e2060987b544dc73 64114 libmspack-dev_0.4-3_amd64.deb
 8d057d985ff2a8eae59190e9cb77a1f523e59803a9f080c2daae35574f266d51 83356 libmspack-dbg_0.4-3_amd64.deb
 9ba195e3bb9dbbb831191ade6ea63b2f1374a0a72dbd4adecd788fa8dc3b1a75 87904 libmspack-doc_0.4-3_all.deb
Files:
 e31c3ae80b05e8741989767e5d0829fc 2064 libs optional libmspack_0.4-3.dsc
 a0ec9b85e6006129cf79da080e93f0b6 4244 libs optional libmspack_0.4-3.debian.tar.xz
 268a598d587596279a137d27d73d26e4 45774 libs optional libmspack0_0.4-3_amd64.deb
 9e44a664d26d225ac9ab92c767e84920 64114 libdevel optional libmspack-dev_0.4-3_amd64.deb
 f257da36c8a8f31419b5181fbaab1296 83356 debug extra libmspack-dbg_0.4-3_amd64.deb
 c263e26a473926aea0d45d447fd601f2 87904 doc optional libmspack-doc_0.4-3_all.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCgAGBQJUtaFtAAoJEFXp+fesHEQ/XHcP/i+6WhqKDEg8SFr/UTGN5rL1
v5Ax3beEU1gEUF7yFjCDhBX3wdY2HkFfBtg1woteqCUymevRsdGkCYWInVau5ROq
Auwoc19oCFLc39wYqGx8ujj7soXZXvMzvveguBUy86hrWigGWXmXTui7TXdNjb56
osdkOic8uVPFTY2V0SF5Nf4Wjd8hXo4kJbhxSDZfICdmbxlO5GRm0gOW7JbjTJUb
bFULLjZSoSB7z8n7bKeEi2BGOieLu9+xXLwkI0/cFzVw0sr5NiyWXmtxNttN5OlC
RoM0vb0SVklnpsFssFpNYvznC0UU4fLI5FDU1D3umKd+x57fdlWOF7JoHn4dXF68
vydd3MJbm1GI6oavQnfsXXeyRBaZkyQilCkB1m15T7IQfGcvdWAo2yPS+tmuFXuK
LSjtNu8MAiHQ7GqMk+/0iKIBr4XKsJsYESwhT+3QnFkPVv7N5XE5UwqB8Nys24WH
hZg/m/m12I54R3jbO6iZDrBUngGm/93z1qNcsQrknNkpvcGaTDu/3tAmmthLbzHE
6h17rIyMcAr3jPZVp2K4OwHJugk62x3ajPZ9xPcq21qcHf2TbrmgdYGPVKGeUhth
nLZiC8RmYT7pzQqPg/MzXSPcZk2cUFkxPu0CPSGumhddTX9KTL4rGeuRZECgiIAS
99zjhgbtuhzvZT5dFB4w
=xnzY
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Thu, 12 Feb 2015 07:26:03 GMT) ([full text](bugreport.cgi?bug=774725;msg=14), [mbox](bugreport.cgi?bug=774725;mbox=yes;msg=14), [link](#13)).

---

**Bug unarchived.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Thu, 11 Jun 2015 15:21:05 GMT) ([full text](bugreport.cgi?bug=774725;msg=16), [mbox](bugreport.cgi?bug=774725;mbox=yes;msg=16), [link](#15)).

---

**Changed Bug title to 'libmspack: CVE-2015-4467: CHM decompression: division by zero' from 'libmspack: CHM decompression: division by zero'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Thu, 11 Jun 2015 15:21:06 GMT) ([full text](bugreport.cgi?bug=774725;msg=18), [mbox](bugreport.cgi?bug=774725;mbox=yes;msg=18), [link](#17)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Fri, 10 Jul 2015 07:27:46 GMT) ([full text](bugreport.cgi?bug=774725;msg=20), [mbox](bugreport.cgi?bug=774725;mbox=yes;msg=20), [link](#19)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=774725).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 13:48:49 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from openwall.com_a2fef100_20250124_134848.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](10) [[next>]](12) [[thread-next>]](12) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20150203155205.GA14955@eldamar.local>
Date: Tue, 3 Feb 2015 16:52:05 +0100
From: Salvatore Bonaccorso <carnil@...ian.org>
To: OSS Security Mailinglist <oss-security@...ts.openwall.com>
Cc: CVE Assignments MITRE <cve-assign@...re.org>
Subject: Possible CVE Requests: libmspack: several issues

Hi

Several issues with the libmspack library were reported recently in
the Debian bugtracker by Jakub Wilk. An (older) copy of libmspack is
also embedded in ClamAV (not verified if this version is also affected
by these issues).

The reported bugs are the following:

null pointer dereference on a crafted CAB:
 - <https://bugs.debian.org/774665>

CHM decompression: division by zero
 - <https://bugs.debian.org/774725>

CHM decompression: pointer arithmetic overflow
 - <https://bugs.debian.org/774726>

off-by-one buffer over-read in mspack/mszipd.c
 - <https://bugs.debian.org/775498>

off-by-one buffer under-read in mspack/lzxd.c
 - <https://bugs.debian.org/775499>

CHM decompression: another pointer arithmetic overflow
 - <https://bugs.debian.org/775687>

Could CVEs be assigned for these issues?

Regards,
Salvatore

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


