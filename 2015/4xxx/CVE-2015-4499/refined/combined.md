=== Content from bug1202447.bmoattachments.org_f0277369_20250124_133517.html ===
Vulnerability Disclosure

Vulnerability Disclosure

Authentication Mechanism Bypass

In

Bugzilla

Netanel Rubin

06.09.2015

Vulnerability Disclosure

Vulnerable Versions

? – Fully Patched (5.0.0)

Summary

Bugzilla is a very popular open source bug tracking software written in Perl. It allows an

organization to easily organize the bugs in its products and developers to conveniently
document any bug they’ve found or fixed.

This vulnerability allows an attacker to register under any email address, causing the

system to grant permissions the attacker should not have obtained otherwise.

This vulnerability has been tested and found working on `Bugzilla.mozilla.org` - the

Bugzilla for the Mozilla corporation and on `Bugzilla.wikimedia.org` - the Bugzilla for the
Wikimedia foundation. On both domains we’ve been granted permissions that allowed us to
view confidential data among other things.

Vulnerability Disclosure

Technical Description

Bugzilla authentication mechanism relies on email validation. Prior to the actual registration the
user enters his email and an activation link is sent there by the system. This link contains a
token which allows the user to set his real name and his account password. After that every
change to the email address requires both the old and new addresses to be validated.

When the user registers with his email address it is saved in the `tokens` DB table along with
the token to activate the address. The email address is stored in a special column named
‘evendata’, which supposed to contain the data associated with the token.

When the user validates his email address using the token mailed to him, his email address is
fetched from that column and is used to create his account.
After his account is created, the auto-assign group regex is triggered and it validates the user
email address against group matching regexes.

This makes the email address of the user an extremely important part in the permissions
mechanism in the system, but in order to use a certain address an attacker must validate he
owns it using the token sent to that address.

After the system validates the email address entered for dangerous characters, a new
registration token is created for it. This can be seen in the following code:

sub check_and_send_account_creation_confirmation {
    my ($self, $login) = @_;

# Check the email address of the user

    $login = $self->check_login_name($login);
    if ($login !~ /$creation_regexp/i) {
        ThrowUserError('account_creation_restricted');
    }

    # Create and send a token for this new account.
    require Bugzilla::Token;
    Bugzilla::Token::issue_new_user_account_token($login);
}

Bugzilla/User.pm::check_and_send_account_creation_confirmation()

Vulnerability Disclosure

Following the code to ‘issue_new_user_account_token()’:

sub issue_new_user_account_token {
    my $login_name = shift; # The email address we entered
    my $template = Bugzilla->template;
    my $vars = {};

# Create the new token in the DB

    my ($token, $token_ts) = _create_token(undef, 'account', $login_name);

# Set the email address, expiration date, and token as the email message

variables

# (Bugzilla->params->{'emailsuffix'} is empty by default [and in almost all

installations])
    $vars->{'email'} = $login_name . Bugzilla->params->{'emailsuffix'};
    $vars->{'expiration_ts'} = ctime($token_ts + MAX_TOKEN_AGE * 86400);
    $vars->{'token'} = $token;

# Render the email message using the complied variables

    my $message;
    $template->process('account/email/request-new.txt.tmpl', $vars, \$message)
      || ThrowTemplateError($template->error());

# Send the confirmation email

    MessageToMTA($message);
}

Bugzilla/Token.pm::issue_new_user_account_token()

Looking at this code we realize the token for our user registration is created in the DB and then
inserted into the email message sent to our address.
It is important to note that the system doesn’t validate our token has been created correctly in
the database. Instead, it just assumes it did and sends us the confirmation email.

We need to find a way to corrupt the email address as it is being inserted into the DB. The
column the address is stored in, ‘eventdata’, is of type ‘tinytext’. This data type represents a
text string and is limited to 255 bytes in MySQL. For other DBs not supporting this data type
Bugzilla specifies 255 bytes as the exact size of the column using the regular ‘text’ data type.

But what happens when we insert more than 255 bytes? Does the DB raise an exception? Does
it crash? No – It automatically truncates the data so it fits the column size.
We can use this behavior to create an email address larger than 255 bytes in a way that will
cause the system to miss identify our domain (the only part we cannot entirely control).

We will use an address ending with the domain we want so it is exactly 255 bytes in length.
Then, we will append our owned domain to that address so the email will be sent to us.
When the email will be inserted into the DB, it will be truncated, so the application will assume
we identified an email under the domain we actually wanted, causing a privilege escalation.

Vulnerability Disclosure

POC

POST /createaccount.cgi HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 76

login=[MALICIOUS_EMAIL_ADDRESS]&token=[CSRF_TOKEN]

Suggested Fix

Make sure the length of the email address doesn’t exceed the size of the DB column.



=== Content from wiki.mozilla.org_73f8d6fa_20250126_012044.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from seclists.org_5ae42fba_20250124_133516.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![bugtraq logo](/images/bugtraq-logo.png)](/bugtraq/)
## [Bugtraq](/bugtraq/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](48)
[By Date](date.html#49)
[![Next](/images/right-icon-16x16.png)](50)

[![Previous](/images/left-icon-16x16.png)](48)
[By Thread](index.html#49)
[![Next](/images/right-icon-16x16.png)](50)

![](/shared/images/nst-icons.svg#search)

# Security Advisory for Bugzilla 5.0.1, 4.4.10 and 4.2.15

---

*From*: LpSolit () gmail com

*Date*: Thu, 10 Sep 2015 23:46:26 GMT

---

```
Summary
=======

Bugzilla is a Web-based bug-tracking system used by a large number of
software projects. The following security issue has been discovered
in Bugzilla:

* Login names longer than 127 characters can be corrupted, which could
  lead to the creation of a user account with an unexpected email
  address.

All affected installations are encouraged to upgrade as soon as
possible.

Vulnerability Details
=====================

Class:       Unauthorized Account Creation
Versions:    Bugzilla 2.0 to 4.2.14, 4.3.1 to 4.4.9, 4.5.1 to 5.0
Fixed In:    4.2.15, 4.4.10, 5.0.1
Description: Login names (usually an email address) longer than 127
             characters are silently truncated in MySQL which could
             cause the domain name of the email address to be
             corrupted. An attacker could use this vulnerability to
             create an account with an email address different from the
             one originally requested. The login name could then be
             automatically added to groups based on the group's regular
             expression setting.
References:  <https://bugzilla.mozilla.org/show_bug.cgi?id=1202447>
CVE Number:  CVE-2015-4499

Vulnerability Solutions
=======================

The fix for this issue is included in the 4.2.15, 4.4.10 and 5.0.1
releases. Upgrading to a release with the relevant fix will
protect your installation from possible exploits of this issue.

If you are unable to upgrade but would like to patch just the security
vulnerability, there are patches available for the issue at the
"References" URL.

Full release downloads, patches to upgrade Bugzilla from previous
versions, and git upgrade instructions are available at:

  <https://www.bugzilla.org/download/>

Credits
=======

The Bugzilla team wish to thank the following people for their
assistance in locating, advising us of, and assisting us to fix these
issues:

Byron Jones
Frédéric Buclin
Netanel Rubin

General information about the Bugzilla bug-tracking system can be found
at:

  <https://www.bugzilla.org/>

Comments and follow-ups can be directed to the mozilla.support.bugzilla
newsgroup or the support-bugzilla mailing list.
<https://www.bugzilla.org/support/> has directions for accessing these
forums.

```

---

[![Previous](/images/left-icon-16x16.png)](48)
[By Date](date.html#49)
[![Next](/images/right-icon-16x16.png)](50)

[![Previous](/images/left-icon-16x16.png)](48)
[By Thread](index.html#49)
[![Next](/images/right-icon-16x16.png)](50)

### Current thread:

* **Security Advisory for Bugzilla 5.0.1, 4.4.10 and 4.2.15** *LpSolit (Sep 11)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from packetstormsecurity.com_6cd021e6_20250124_133514.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from bugzilla.mozilla.org_581cc976_20250126_012047.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1202447)
* [XML](/show_bug.cgi?ctype=xml&id=1202447)

Closed
[Bug 1202447](/show_bug.cgi?id=1202447)
(CVE-2015-4499)

Opened 9 years ago
Closed 9 years ago

# [SECURITY] The email address is not properly validated during registration if longer than 127 characters

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[SECURITY] The email address is not properly validated during registration if longer than 127 characters

## Categories

### (Bugzilla :: User Accounts, defect)

[Product:](/describecomponents.cgi?product=Bugzilla)

Bugzilla
▾

Bugzilla
The [Bugzilla](http://www.bugzilla.org) bug-tracking system.

**Note:** This is **not** the place to request configuration, permission, or account changes to this installation of Bugzilla (bugzilla.mozilla.org). File such changes under the appropriate component in the [**bugzilla.mozilla.org**](enter_bug.cgi?product=bugzilla.mozilla.org) product.
[See Open Bugs in This Product](/buglist.cgi?product=Bugzilla&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Bugzilla)
Watch This Product

[Component:](/describecomponents.cgi?product=Bugzilla&component=User%20Accounts#User%20Accounts)

User Accounts
▾

Bugzilla :: User Accounts
Anything about managing a user account from the user's perspective. `userprefs.cgi`, saved queries, creating accounts, changing passwords, logging in, etc.
[See Open Bugs in This Component](/buglist.cgi?product=Bugzilla&component=User%20Accounts&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Bugzilla&component=User%20Accounts&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Bugzilla&component=User%20Accounts)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

5.0

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Bugzilla 4.2

## People

### (Reporter: nati, Assigned: glob)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/a83cecb36e10da3bed34ec3eec89138a?d=mm&size=40)  [glob](/user_profile?user_id=13647)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/9df24a05a7e63cf07e49d30ddfeee31a?d=mm&size=40)  [default-qa](/user_profile?user_id=5086)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d4943320596eabe91d0914d2bfb27cff?d=mm&size=40)  [nati](/user_profile?user_id=519118)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

32 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1202467](/show_bug.cgi?id=1202467 "RESOLVED FIXED - Security advisory for Bugzilla 5.0.1, 4.4.10 and 4.2.15")

Dependency [tree](/showdependencytree.cgi?id=1202447&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1202447)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: reporter-external, sec-high, Whiteboard: [newcomers: read comment 22])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2015-4499

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[newcomers: read comment 22]

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [justdave](/user_profile?user_id=10297) | [approval](#c32 "9 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [approval5.0](#c32 "9 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval5.0 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [blocking5.0.1](#a5948_120380 "9 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | blocking5.0.1 | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [approval4.4](#c32 "9 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval4.4 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [blocking4.4.10](#a5948_120380 "9 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | blocking4.4.10 | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | [approval4.2](#c32 "9 years ago") | + |
| --- | --- | --- |
| [justdave](/user_profile?user_id=10297) | approval4.2 | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [blocking4.2.15](#a5948_120380 "9 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | blocking4.2.15 | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a610469_1689 "9 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | [testcase](#c41 "9 years ago") | + |
| --- | --- | --- |
| [LpSolit](/user_profile?user_id=120380) | testcase | + | | |
| --- | --- | --- | --- | --- |
|  | approval5.2 | ? |
| --- | --- | --- |
|  | approval6.0 | ? |
|  | blocking5.0.4.1 | ? |
|  | blocking5.2 | ? |
|  | blocking6.0 | ? |
|  | blocking4.4.14 | ? |
|  | sec-bounty-hof |  |
|  | documentation | ? + - |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 2 obsolete files)

| [Bugzilla - Authentication Mechanism Bypass.pdf](/attachment.cgi?id=8657861)  [9 years ago](#c3)  [Netanel Rubin](/user_profile?user_id=519118)   441.43 KB, application/pdf |  | [Details](/attachment.cgi?id=8657861&action=edit) |
| --- | --- | --- |
| [Patch for 4.4, 5.0 and master](/attachment.cgi?id=8657874)  [9 years ago](#c6)  [:glob ✱](/user_profile?user_id=13647)   857 bytes, patch | LpSolit : [review-](#c14 "9 years ago") | [Details](/attachment.cgi?id=8657874&action=edit) | [Diff](/attachment.cgi?id=8657874&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1202447&attachment=8657874) |
| [patch for 4.2](/attachment.cgi?id=8657881)  [9 years ago](#c11)  [:glob ✱](/user_profile?user_id=13647)   778 bytes, patch | LpSolit : [review-](#c15 "9 years ago") | [Details](/attachment.cgi?id=8657881&action=edit) | [Diff](/attachment.cgi?id=8657881&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1202447&attachment=8657881) |
| [patch for 4.4, 5.0 and master](/attachment.cgi?id=8658072)  [9 years ago](#c18)  [:glob ✱](/user_profile?user_id=13647)   984 bytes, patch | LpSolit : [review+](#c20 "9 years ago") | [Details](/attachment.cgi?id=8658072&action=edit) | [Diff](/attachment.cgi?id=8658072&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1202447&attachment=8658072) |
| [patch for 4.2](/attachment.cgi?id=8658073)  [9 years ago](#c19)  [:glob ✱](/user_profile?user_id=13647)   906 bytes, patch | LpSolit : [review+](#c21 "9 years ago") | [Details](/attachment.cgi?id=8658073&action=edit) | [Diff](/attachment.cgi?id=8658073&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1202447&attachment=8658073) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Netanel Rubin](/user_profile?user_id=519118)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1202447#c0)• 9 years ago |
|  | |

User Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.157 Safari/537.36
Steps to reproduce:
Hello,
My name is Netanel Rubin, I work as a vulnerability researcher at PerimeterX.
This is a critical vulnerability report for an issue I discovered in the Bugzilla platform. The successful exploitation of the vulnerability allows the creation of a user account under any email address, even those which are not under the attacker control.
As a PoC, I've created a test account under bugzilla.mozilla.org:
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb@mozilla.com
I apologize for the length, it is required for the vulnerability.
I would like to report the complete vulnerability description over a private channel. I can post it here like the last time or can mail it to you, so please contact me at nati (-at-) perimeterx or in this thread.
Please assign a CVE number for this issue. We would also like to coordinate the public disclosure with you.
Best regards,
Netanel.

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1202447#c1)• 9 years ago |
|  | |

Please paste the details here.

|  | [:glob ✱](/user_profile?user_id=13647)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1202447#c2)• 9 years ago |
|  | |

confirming.
looks like the account was created as
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb@mozilla.com.perimeterx.com
mysql truncates that to 255 chars when we insert into the db, resulting in
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb@mozilla.comStatus: UNCONFIRMED → NEWEver confirmed: true

|  | [:glob ✱](/user_profile?user_id=13647)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1202447#a782_13647)• 9 years ago |

Assignee: user-accounts → glob

|  | [Netanel Rubin](/user_profile?user_id=519118)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1202447#c3)• 9 years ago |
|  | |

Attached file
[Bugzilla - Authentication Mechanism Bypass.pdf](attachment.cgi?id=8657861)
— [Details](attachment.cgi?id=8657861&action=edit)

|  | [Netanel Rubin](/user_profile?user_id=519118)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1202447#c4)• 9 years ago |
|  | |

@Byron - precisely.

|  | [:glob ✱](/user_profile?user_id=13647)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1202447#a1297_13647)• 9 years ago |

Flags: sec-bounty?

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1202447#c5)• 9 years ago |
|  | |

Nice catch! :)Severity: normal → criticalFlags: blocking5.0.1?Flags: blocking4.4.10?Flags: blocking4.2.15?Summary: The email address is not properly validated during registration → [SECURITY] The email address is not properly validated during registration if longer than 255 charactersTarget Milestone: --- → Bugzilla 4.2

|  | [:glob ✱](/user_profile?user_id=13647)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1202447#c6)• 9 years ago |
|  | |

Attached patch

[Patch for 4.4, 5.0 and master](attachment.cgi?id=8657874&action=diff) (obsolete)
— [Details](attachment.cgi?id=8657874&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1202447&attachment=8657874)

[Attachment #8657874](/attachment.cgi?id=8657874&action=edit "Patch for 4.4, 5.0 and master") -
Flags: review?(LpSolit)

|  | [Netanel Rubin](/user_profile?user_id=519118)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1202447#c7)• 9 years ago |
|  | |

Thank you very much Frédéric :)
Any estimate about when you will release a patch?

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1202447#c8)• 9 years ago |
|  | |

(In reply to Netanel Rubin, from [comment #7](/show_bug.cgi?id=1202447#c7 "RESOLVED FIXED - [SECURITY] The email address is not properly validated during registration if longer than 127 characters"))
> Any estimate about when you will release a patch?
Very soon, I hope. But please do not disclose this vulnerability before new releases are publicly available from our website.Status: NEW → ASSIGNED

|  | [Netanel Rubin](/user_profile?user_id=519118)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1202447#c9)• 9 years ago |
|  | |

(In reply to Frédéric Buclin from [comment #8](/show_bug.cgi?id=1202447#c8 "RESOLVED FIXED - [SECURITY] The email address is not properly validated during registration if longer than 127 characters"))
> (In reply to Netanel Rubin, from [comment #7](/show_bug.cgi?id=1202447#c7 "RESOLVED FIXED - [SECURITY] The email address is not properly validated during registration if longer than 127 characters"))
> But please do not disclose this vulnerability before newreleases are publicly available from our website.
Of course, just let us know a couple of days prior to your release so we can get prepared.

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1202447#c10)• 9 years ago |
|  | |

Comment on [attachment 8657874](/attachment.cgi?id=8657874 "Patch for 4.4, 5.0 and master") [[details]](/attachment.cgi?id=8657874&action=edit "Patch for 4.4, 5.0 and master") [[diff]](/attachment.cgi?id=8657874&action=diff "Patch for 4.4, 5.0 and master") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1202447&attachment=8657874)
Patch for 4.4, 5.0 and master
r=LpSolit
A backport is needed for 4.2.
[Attachment #8657874](/attachment.cgi?id=8657874&action=edit "Patch for 4.4, 5.0 and master") -
Attachment description: 1202447\_1.patch → Patch for 4.4, 5.0 and master
[Attachment #8657874](/attachment.cgi?id=8657874&action=edit "Patch for 4.4, 5.0 and master") -
Flags: review?(LpSolit) → review+

|  | [:glob ✱](/user_profile?user_id=13647)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1202447#c11)• 9 years ago |
|  | |

Attached patch

[patch for 4.2](attachment.cgi?id=8657881&action=diff) (obsolete)
— [Details](attachment.cgi?id=8657881&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1202447&attachment=8657881)

[Attachment #8657881](/attachment.cgi?id=8657881&action=edit "patch for 4.2") -
Flags: review?(LpSolit)

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1202447#c12)• 9 years ago |
|  | |

Comment on [attachment 8657881](/attachment.cgi?id=8657881 "patch for 4.2") [[details]](/attachment.cgi?id=8657881&action=edit "patch for 4.2") [[diff]](/attachment.cgi?id=8657881&action=diff "patch for 4.2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1202447&attachment=8657881)
patch for 4.2
>+ && length($addr) < 255)
For consistency with the patch for 4.4+, please use <= 255 instead of < 255. r=LpSolit with this fix.
Note that here, we check the length of $addr while in the patch for 4.4+, we check the length of $email (i.e. $addr + emailsuffix). So 4.2 could potentially allow longer email addresses, but the string is not truncated by MySQL anyway, so this is fine. Said differently, in the patch for 4.4+, we could check the length of $addr instead of the length of $email. I'm fine with both approaches.
[Attachment #8657881](/attachment.cgi?id=8657881&action=edit "patch for 4.2") -
Flags: review?(LpSolit) → review+

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1202447#a5867_120380)• 9 years ago |

Flags: testcase?Flags: approval?Flags: approval5.0?Flags: approval4.4?Flags: approval4.2?

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1202447#a5948_120380)• 9 years ago |

Flags: blocking5.0.1?Flags: blocking5.0.1+Flags: blocking4.4.10?Flags: blocking4.4.10+Flags: blocking4.2.15?Flags: blocking4.2.15+

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1202447#a6625_120380)• 9 years ago |

Blocks: [1202467](/show_bug.cgi?id=1202467 "RESOLVED FIXED - Security advisory for Bugzilla 5.0.1, 4.4.10 and 4.2.15")

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1202447#c13)• 9 years ago |
|  | |

Oops, your fix doesn't cover all cases. While testing your patch, I wondered why I got a trick\_taint() error, and the reason is that the tokens.eventdata DB column is also of type TINYTEXT. So if the combination of old\_address:new\_address is longer than 255, then the string is truncated again and you can again abuse checks.
STR:
- your initial email address is a valid foo@company.com (15 characters long).
- you go to userprefs.cgi and change your email address to xxx...xxx@mozilla.com.company.com where xxx...xxx is 255 - 28 characters long.
- the concatenated string stored in tokens.eventdata should be foo@company.com:xxx...xxx@mozilla.com.company.com, but this string is too long and is truncated to foo@company.com:xxx...xxx@mozilla.com.
- when the user gets the confirmation email and confirms the change, the token will point to the truncated string and you now have a @mozilla.com email address, getting all the privileges associated to such accounts.
So to not be abused, the email address should not be longer than 127 characters, so that 127+1+127=255, 1 being for the ":" character used to concatenate the old and new addresses. The only problem is that if there are already email addresses longer than 127 characters, they could use this trick to abuse Bugzilla. One way to fix it is to increase the size of the tokens.eventdata DB column to 512 characters, but this would be a DB schema change. Not good for branches.Flags: approval?Flags: approval5.0?Flags: approval4.4?Flags: approval4.2?

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1202447#c14)• 9 years ago |
|  | |

Comment on [attachment 8657874](/attachment.cgi?id=8657874 "Patch for 4.4, 5.0 and master") [[details]](/attachment.cgi?id=8657874&action=edit "Patch for 4.4, 5.0 and master") [[diff]](/attachment.cgi?id=8657874&action=diff "Patch for 4.4, 5.0 and master") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1202447&attachment=8657874)
Patch for 4.4, 5.0 and master
r- per my previous comment.
[Attachment #8657874](/attachment.cgi?id=8657874&action=edit "Patch for 4.4, 5.0 and master") -
Flags: review+ → review-

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1202447#c15)• 9 years ago |
|  | |

Comment on [attachment 8657881](/attachment.cgi?id=8657881 "patch for 4.2") [[details]](/attachment.cgi?id=8657881&action=edit "patch for 4.2") [[diff]](/attachment.cgi?id=8657881&action=diff "patch for 4.2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1202447&attachment=8657881)
patch for 4.2
r- per my previous comment.
[Attachment #8657881](/attachment.cgi?id=8657881&action=edit "patch for 4.2") -
Flags: review+ → review-

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1202447#c16)• 9 years ago |
|  | |

forcing addresses to 127 or fewer in order to accommodate the size of the token table is probably a good idea. Just for safety (and another security measure) we could also read the email address back out of the database after writing it to make sure us and the database have the same concept of reality before sending the validation mails. That would cause the validation mail to go to the spoofed address, correctly blocking it. Telling MySQL to error instead of truncating would probably be good long-term but I'd be hesitant to do that on a branch. We probably want to do that on trunk.

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1202447#c17)• 9 years ago |
|  | |

(In reply to Dave Miller from [comment #16](/show_bug.cgi?id=1202447#c16 "RESOLVED FIXED - [SECURITY] The email address is not properly validated during registration if longer than 127 characters"))
> Telling MySQL to error
> instead of truncating would probably be good long-term but I'd be hesitant
> to do that on a branch. We probably want to do that on trunk.
This is certainly not doable for branches without heavy DB changes. For trunk, I filed [bug 1202509](/show_bug.cgi?id=1202509 "NEW - Force MySQL to use mode STRICT_ALL_TABLES").

|  | [:glob ✱](/user_profile?user_id=13647)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1202447#c18)• 9 years ago |
|  | |

Attached patch

[patch for 4.4, 5.0 and master](attachment.cgi?id=8658072&action=diff)
— [Details](attachment.cgi?id=8658072&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1202447&attachment=8658072)

[Attachment #8657874](/attachment.cgi?id=8657874&action=edit "Patch for 4.4, 5.0 and master") -
Attachment is obsolete: true
[Attachment #8658072](/attachment.cgi?id=8658072&action=edit "patch for 4.4, 5.0 and master") -
Flags: review?(LpSolit)

|  | [:glob ✱](/user_profile?user_id=13647)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1202447#c19)• 9 years ago |
|  | |

Attached patch

[patch for 4.2](attachment.cgi?id=8658073&action=diff)
— [Details](attachment.cgi?id=8658073&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1202447&attachment=8658073)

[Attachment #8657881](/attachment.cgi?id=8657881&action=edit "patch for 4.2") -
Attachment is obsolete: true
[Attachment #8658073](/attachment.cgi?id=8658073&action=edit "patch for 4.2") -
Flags: review?(LpSolit)

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1202447#c20)• 9 years ago |
|  | |

Comment on [attachment 8658072](/attachment.cgi?id=8658072 "patch for 4.4, 5.0 and master") [[details]](/attachment.cgi?id=8658072&action=edit "patch for 4.4, 5.0 and master") [[diff]](/attachment.cgi?id=8658072&action=diff "patch for 4.4, 5.0 and master") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1202447&attachment=8658072)
patch for 4.4, 5.0 and master
r=LpSolit
[Attachment #8658072](/attachment.cgi?id=8658072&action=edit "patch for 4.4, 5.0 and master") -
Flags: review?(LpSolit) → review+

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1202447#c21)• 9 years ago |
|  | |

Comment on [attachment 8658073](/attachment.cgi?id=8658073 "patch for 4.2") [[details]](/attachment.cgi?id=8658073&action=edit "patch for 4.2") [[diff]](/attachment.cgi?id=8658073&action=diff "patch for 4.2") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1202447&attachment=8658073)
patch for 4.2
r=LpSolit
[Attachment #8658073](/attachment.cgi?id=8658073&action=edit "patch for 4.2") -
Flags: review?(LpSolit) → review+

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1202447#a68006_120380)• 9 years ago |

Flags: approval?Flags: approval5.0?Flags: approval4.4?Flags: approval4.2?

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1202447#a68254_120380)• 9 years ago |

Summary: [SECURITY] The email address is not properly validated during registration if longer than 255 characters → [SECURITY] The email address is not properly validated during registration if longer than 127 characters

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1202447#c22)• 9 years ago |
|  | |

Bugzilla maintainers: you have been CC'ed to this bug to get early access to a critical security vulnerability which affects all supported Bugzilla versions. Patches are available for Bugzilla 5.0.1, 4.4.10 and 4.2.15, see the attachments table above.
We ask you to not disclose this vulnerability in any way before new releases are available from <https://www.bugzilla.org/>. This means for instance that you shouldn't use git/bzr/cvs to commit this patch to your local installation if untrusted users may read the commit message and guess what's going on. In this case, applying the patch manually should be prefered.
The ETA for releases is not set yet. We will let you know once we have this information.Whiteboard: [newcomers: read comment 22]

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1202447#a88285_120380)• 9 years ago |

[Attachment #8658072](/attachment.cgi?id=8658072&action=edit "patch for 4.4, 5.0 and master") -
Attachment description: patch for 4.4+ → patch for 4.4, 5.0 and master

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1202447#c23)• 9 years ago |
|  | |

GCC Bugzilla patched.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1202447#c24)• 9 years ago |
|  | |

[CVE-2015-4499](https://www.cve.org/CVERecord?id=CVE-2015-4499) is assigned to this issue.Alias: CVE-2015-4499

|  | [Netanel Rubin](/user_profile?user_id=519118)  Reporter |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1202447#c25)• 9 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #24](/show_bug.cgi?id=1202447#c24 "RESOLVED FIXED - [SECURITY] The email address is not properly validated during registration if longer than 127 characters"))
> [CVE-2015-4499](https://www.cve.org/CVERecord?id=CVE-2015-4499) is assigned to this issue.
Thanks. Do you have any updates on the patch ETA?

|  | [austinenglish](/user_profile?user_id=485571) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1202447#c26)• 9 years ago |
|  | |

WineHQ Bugzilla is patched.

|  | [Matt Tyson](/user_profile?user_id=450059) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1202447#c27)• 9 years ago |
|  | |

Red Hat Bugzilla has been patched, thanks for the heads up.

|  | [Denis Roy](/user_profile?user_id=128581) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1202447#c28)• 9 years ago |
|  | |

Just to be clear, if we're using LDAP and have disabled Bugzilla account creation, we're not affected, right?

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1202447#c29)• 9 years ago |
|  | |

(In reply to Denis Roy from [comment #28](/show_bug.cgi?id=1202447#c28 "RESOLVED FIXED - [SECURITY] The email address is not properly validated during registration if longer than 127 characters"))
> Just to be clear, if we're using LDAP and have disabled Bugzilla account
> creation, we're not affected, right?
Shouldn't be affected, right.

|  | [Robin H. Johnson [:robbat2]](/user_profile?user_id=185972) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1202447#c30)• 9 years ago |
|  | |

FYI, meant to say before, Gentoo bugzilla is patched, but patch is explicitly NOT committed to our Bugzilla tracking git pending the official release.

|  | [David D. Kilzer (ddk)](/user_profile?user_id=33620) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1202447#c31)• 9 years ago |
|  | |

bugs.webkit.org has been patched locally on the server without committing the fix to the svn.webkit.org repository.

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1202447#c32)• 9 years ago |
|  | |

OK, The plan at this point is that we're going to release today. This is a volunteer-driven process, and dependent on working in time around day jobs, and the process can take 2 to 3 hours to complete once it's set in motion, if everything goes smoothly and people don't get called away. I hate to put uncertainty on the exact time like that, but it'd be appreciated if posting about this elsewhere could be held off at least until the information about it is live on the website (which usually gets posted after the files are available for download).
dkl plans to commit this as part of the release process.Flags: approval?Flags: approval5.0?Flags: approval5.0+Flags: approval4.4?Flags: approval4.4+Flags: approval4.2?Flags: approval4.2+Flags: approval+

|  | [Netanel Rubin](/user_profile?user_id=519118)  Reporter |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1202447#c33)• 9 years ago |
|  | |

We would have appreciated a few days heads up, but do you have an estimate of the exact time the patch will be released?

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1202447#c34)• 9 years ago |
|  | |

(In reply to Netanel Rubin, from [comment #33](/show_bug.cgi?id=1202447#c33 "RESOLVED FIXED - [SECURITY] The email address is not properly validated during registration if longer than 127 characters"))
> We would have appreciated a few days heads up, but do you have an estimate
> of the exact time the patch will be released?
No, I just said that. :-) It depends on how long it takes to finish the release process. I do apologize for short notice, but the opportunity arose to get time to do the release and we had to take it (or chance it not happening later)

|  | [Netanel Rubin](/user_profile?user_id=519118)  Reporter |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1202447#c35)• 9 years ago |
|  | |

(In reply to Dave Miller [:justdave] (justdave@bugzilla.org) from [comment #34](/show_bug.cgi?id=1202447#c34 "RESOLVED FIXED - [SECURITY] The email address is not properly validated during registration if longer than 127 characters"))
> (In reply to Netanel Rubin, from [comment #33](/show_bug.cgi?id=1202447#c33 "RESOLVED FIXED - [SECURITY] The email address is not properly validated during registration if longer than 127 characters"))
> > We would have appreciated a few days heads up, but do you have an estimate
> > of the exact time the patch will be released?
>
> No, I just said that. :-) It depends on how long it takes to finish the
> release process. I do apologize for short notice, but the opportunity arose
> to get time to do the release and we had to take it (or chance it not
> happening later)
I understand. Please keep us updated.

|  | [Dave Miller [:justdave]](/user_profile?user_id=10297) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1202447#c36)• 9 years ago |
|  | |

It may end up taking longer than expected to get it out the door anyway, the upload process for ftp.mozilla.org has changed since our last release and we're having issues getting it to work, so it's dependent on getting that straightened out as well.

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1202447#c37)• 9 years ago |
|  | |

To ssh://gitolite3@git.mozilla.org/bugzilla/bugzilla.git
[7e3042e..10b1fef 4.2 -> 4.2](https://github.com/bugzilla/bugzilla/commit/10b1fef)
To ssh://gitolite3@git.mozilla.org/bugzilla/bugzilla.git
[2fdebb9..be1be8c 4.4 -> 4.4](https://github.com/bugzilla/bugzilla/commit/be1be8c)
To ssh://gitolite3@git.mozilla.org/bugzilla/bugzilla.git
[eff343a..69386c5 5.0 -> 5.0](https://github.com/bugzilla/bugzilla/commit/69386c5)
To ssh://gitolite3@git.mozilla.org/bugzilla/bugzilla.git
[e32682d..9d64d15 master -> master](https://github.com/bugzilla/bugzilla/commit/9d64d15)
(In reply to Dave Miller [:justdave] (justdave@bugzilla.org) from [comment #36](/show_bug.cgi?id=1202447#c36 "RESOLVED FIXED - [SECURITY] The email address is not properly validated during registration if longer than 127 characters"))
> It may end up taking longer than expected to get it out the door anyway, the
> upload process for ftp.mozilla.org has changed since our last release and
> we're having issues getting it to work, so it's dependent on getting that
> straightened out as well.
The tar files should be available for download and website updated in a couple hours or less.
dklStatus: ASSIGNED → RESOLVEDClosed: 9 years agoResolution: --- → FIXED

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1202447#a279200_5898)• 9 years ago |

Group: bugzilla-security

|  | [Netanel Rubin](/user_profile?user_id=519118)  Reporter |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1202447#c38)• 9 years ago |
|  | |

Just wanted to make sure - the CVE you assigned for this vuln has already been reserved June 10th (<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4499>), it is the correct CVE?

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1202447#c39)• 9 years ago |
|  | |

(In reply to Netanel Rubin, from [comment #38](/show_bug.cgi?id=1202447#c38 "RESOLVED FIXED - [SECURITY] The email address is not properly validated during registration if longer than 127 characters"))
> (<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4499>), it is the
> correct CVE?
That page says: "The entry creation date may reflect when the CVE-ID was allocated or reserved, and does not necessarily indicate when this vulnerability was discovered".

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1202447#a610469_1689)• 9 years ago |

Flags: sec-bounty? → sec-bounty+Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [austinenglish](/user_profile?user_id=485571) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1202447#c40)• 9 years ago |
|  | |

(In reply to Frédéric Buclin from [comment #39](/show_bug.cgi?id=1202447#c39 "RESOLVED FIXED - [SECURITY] The email address is not properly validated during registration if longer than 127 characters"))
> (In reply to Netanel Rubin, from [comment #38](/show_bug.cgi?id=1202447#c38 "RESOLVED FIXED - [SECURITY] The email address is not properly validated during registration if longer than 127 characters"))
> > (<http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4499>), it is the
> > correct CVE?
>
> That page says: "The entry creation date may reflect when the CVE-ID was
> allocated or reserved, and does not necessarily indicate when this
> vulnerability was discovered".
FWIW, there aren't any other recent CVE's published for bugzilla, at least:
<https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=bugzilla>

|  | [Frédéric Buclin](/user_profile?user_id=120380) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1202447#c41)• 9 years ago |
|  | |

Tests for too long login names added to test\_create\_user\_accounts.t and webservice\_user\_create.t.Flags: testcase? → testcase+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1202447#c42)• 9 years ago |
|  | |

(In reply to Netanel Rubin, from [comment #38](/show_bug.cgi?id=1202447#c38 "RESOLVED FIXED - [SECURITY] The email address is not properly validated during registration if longer than 127 characters"))
> Just wanted to make sure - the CVE you assigned for this vuln has already
> been reserved June 10th [...], it is the correct CVE?
MITRE assigns CVE numbers in blocks to CNAs, of which Mozilla is one. We then assign numbers from these blocks as issues come up.

|  | [Netanel Rubin](/user_profile?user_id=519118)  Reporter |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1202447#c43)• 9 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #42](/show_bug.cgi?id=1202447#c42 "RESOLVED FIXED - [SECURITY] The email address is not properly validated during registration if longer than 127 characters"))
> (In reply to Netanel Rubin, from [comment #38](/show_bug.cgi?id=1202447#c38 "RESOLVED FIXED - [SECURITY] The email address is not properly validated during registration if longer than 127 characters"))
> > Just wanted to make sure - the CVE you assigned for this vuln has already
> > been reserved June 10th [...], it is the correct CVE?
>
> MITRE assigns CVE numbers in blocks to CNAs, of which Mozilla is one. We
> then assign numbers from these blocks as issues come up.
Got it. Thanks!

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1202447#a275444068_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1202447&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Netanel Rubin](/user_profile?user_id=519118)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from seclists.org_de6ad7ff_20250124_133515.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![bugtraq logo](/images/bugtraq-logo.png)](/bugtraq/)
## [Bugtraq](/bugtraq/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](47)
[By Date](date.html#48)
[![Next](/images/right-icon-16x16.png)](49)

[![Previous](/images/left-icon-16x16.png)](46)
[By Thread](index.html#48)
[![Next](/images/right-icon-16x16.png)](49)

![](/shared/images/nst-icons.svg#search)

# Security advisory for Bugzilla 5.0, 4.4.9, and 4.2.14

---

*From*: dkl () mozilla com

*Date*: Thu, 10 Sep 2015 20:39:07 GMT

---

```
Summary
=======

Bugzilla is a Web-based bug-tracking system used by a large number of
software projects. The following security issue has been discovered
in Bugzilla:

* Login names longer than 127 characters can be corrupted, which could
  lead to the creation of a user account with an unexpected email
  address.

All affected installations are encouraged to upgrade as soon as
possible.

Vulnerability Details
=====================

Class:       Unauthorized Account Creation
Versions:    Bugzilla 2.0 to 4.2.14, 4.3.1 to 4.4.9, 4.5.1 to 5.0
Fixed In:    4.2.15, 4.4.10, 5.0.1
Description: Login names (usually an email address) longer than 127
             characters are silently truncated in MySQL which could
             cause the domain name of the email address to be
             corrupted. An attacker could use this vulnerability to
             create an account with an email address different from the
             one originally requested. The login name could then be
             automatically added to groups based on the group's regular
             expression setting.
References:  <https://bugzilla.mozilla.org/show_bug.cgi?id=1202447>
CVE Number:  CVE-2015-4499

Vulnerability Solutions
=======================

The fix for this issue is included in the 4.2.15, 4.4.10 and 5.0.1
releases. Upgrading to a release with the relevant fix will
protect your installation from possible exploits of this issue.

If you are unable to upgrade but would like to patch just the security
vulnerability, there are patches available for the issue at the
"References" URL.

Full release downloads, patches to upgrade Bugzilla from previous
versions, and git upgrade instructions are available at:

  <https://www.bugzilla.org/download/>

Credits
=======

The Bugzilla team wish to thank the following people for their
assistance in locating, advising us of, and assisting us to fix these
issues:

Byron Jones
Frédéric Buclin
Netanel Rubin

General information about the Bugzilla bug-tracking system can be found
at:

  <https://www.bugzilla.org/>

Comments and follow-ups can be directed to the mozilla.support.bugzilla
newsgroup or the support-bugzilla mailing list.
<https://www.bugzilla.org/support/> has directions for accessing these
forums.

```

---

[![Previous](/images/left-icon-16x16.png)](47)
[By Date](date.html#48)
[![Next](/images/right-icon-16x16.png)](49)

[![Previous](/images/left-icon-16x16.png)](46)
[By Thread](index.html#48)
[![Next](/images/right-icon-16x16.png)](49)

### Current thread:

* **Security advisory for Bugzilla 5.0, 4.4.9, and 4.2.14** *dkl (Sep 11)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


