=== Content from wordpress.org_19fc8830_20250124_143038.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

WP-ViperGB

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fwp-vipergb&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fwp-vipergb&locale=en_US)

Search plugins

![](https://s.w.org/plugins/geopattern-icon/wp-vipergb.svg)
# WP-ViperGB

By [Justin Klein](https://www.justin-klein.com/)

[Download](https://downloads.wordpress.org/plugin/wp-vipergb.1.6.2.zip)

* [Details](https://wordpress.org/plugins/wp-vipergb/#description)
* [Reviews](https://wordpress.org/plugins/wp-vipergb/#reviews)
* [Installation](https://wordpress.org/plugins/wp-vipergb/#installation)
* [Development](https://wordpress.org/plugins/wp-vipergb/#developers)

[Support](https://wordpress.org/support/plugin/wp-vipergb/)

## Description

WP-ViperGB is a WordPress plugin designed to replicate the appearance and behavior of the discontinued [Viper Guestbook](http://www.vipergb.de.vu/) project. It makes it easy to add a stylish and user-friendly guestbook to your blog.

Features:

* Create user-friendly guestbooks without writing a single line of code.
* Lives in a standard WordPress page and uses comments for entries, so moderation and antispam functionality works as normal.
* Two-View layout provides one view for submitting entries and another for reading them.
* Automatic paging of entries to customizable length.
* Show icons for country, browser, and OS in visitor signatures.
* Admin-panel stylesheet selector allows easy skinning to suit your theme.
* No bloat: Uses existing WordPress faculties so no custom database tables are required.
* Simple PHP template function allows programmers to manually embed standalone guestbooks in any template they wish.

For a Demo, see the [plugin’s homepage](https://www.justin-klein.com/projects/wp-vipergb#demo).

### Donate

Many hours have gone into developing & maintaining this plugin, far beyond my own personal needs. If you find it useful, [a donation](https://www.justin-klein.com/projects/wp-vipergb/#donate) would be greatly appreciated.

### Privacy

This plugin uses standard WordPress comments for its entries – it is essentially a fancy whole-page comment form skin. It does not collect any data beyond that which would normally be included in standard WordPress comments. Please refer to the WordPress documentation for details on what information is stored with comments.

### Support

Please direct all support requests [here](https://www.justin-klein.com/projects/wp-vipergb#feedback)

## Installation

1. Download the most recent version of the plugin from [here](https://wordpress.org/extend/plugins/wp-vipergb/), unzip it, and upload the extracted files to your `/wp-content/plugins` directory.
2. Login to your WordPress admin panel and activate the plugin.
3. Create a new Page (i.e. “Guestbook”).
4. Navigate to Settings -> WP-ViperGB.
5. Use the provided dropdown to select the Page you created above.
6. Click “Save,” and you’re done! You can now enjoy your new guestbook.

Customization options are discussed on the [plugin’s website](https://www.justin-klein.com/projects/wp-vipergb#customization).

## FAQ

[FAQ](https://www.justin-klein.com/projects/wp-vipergb#faq)

## Reviews

![](https://secure.gravatar.com/avatar/859e284a9f055af249d143d26cb1c16325ed3319bcd7990f754f1f44c826e7f9?s=60&d=retro&r=g)
### [good plugin](https://wordpress.org/support/topic/good-plugin-4999/)

[Anonymous User 15932932](https://profiles.wordpress.org/anonymized-15932932/ "Posts by Anonymous User 15932932")
February 13, 2021

good plugin

![](https://secure.gravatar.com/avatar/461a938cdf14872ee9e7491274ae05f2c9a7ce8c64f201c61b905d7645d2fbb2?s=60&d=retro&r=g)
### [WP-ViperGB](https://wordpress.org/support/topic/wp-vipergb/)

[Bullies of NC](https://profiles.wordpress.org/bullies-of-nc/ "Posts by Bullies of NC")
October 7, 2018
1 reply

Decent Guestbook but it doesn’t have enough controls to customize the options. I’ve been using it for a couple years now but recently noticed a Huge influx of Spam comments coming in from those who are only wanting to use their website as a back link. I wish there was an option to restrict people from posting their own website. Even the ability to use a Capcha would be helpful. I hope to see an update one day with some upgrades.

![](https://secure.gravatar.com/avatar/667216bf509797aefe496a81ae3af56fd8200b378994c13a22a5593a63b9be41?s=60&d=retro&r=g)
### [nice and easy](https://wordpress.org/support/topic/nice-and-easy-113/)

[mighty2003](https://profiles.wordpress.org/mighty2003/ "Posts by mighty2003")
September 3, 2016

simple and easy to use. All what I need. Use it over some years now.

[Read all 5 reviews](https://wordpress.org/support/plugin/wp-vipergb/reviews/)
## Contributors & Developers

“WP-ViperGB” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/ea3fd8cb4d94f3b41e970ec56bcf297f12621f96c863e1deb46ae12a2dabb7e8?s=32&d=mm&r=g) [justin\_k](https://profiles.wordpress.org/justin_k/)

“WP-ViperGB” has been translated into 2 locales. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/wp-vipergb/contributors) for their contributions.

[Translate “WP-ViperGB” into your language.](https://translate.wordpress.org/projects/wp-plugins/wp-vipergb)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/wp-vipergb/), check out the [SVN repository](https://plugins.svn.wordpress.org/wp-vipergb/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/wp-vipergb/) by [RSS](https://plugins.trac.wordpress.org/log/wp-vipergb/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 1.6.2 (2024-05-22)

* Fix minor security vulnerability related to saving options in the admin panel

#### 1.6.1 (2022-11-05)

* Fix an error\_log when visiting a nonexistent page (404), introduced in the previous release

#### 1.6.0 (2022-11-05)

* Compatible with block themes (i.e. Twenty Twenty-Three)
* Tested with WP 6.1

#### 1.5.0 (2022-01-14)

* Compatible w/ PHP 8

#### 1.4.8 (2021-03-24)

* Fixed button css class in the admin panel
* Changed the donate link
* Tested with WP 5.7

#### 1.4.7 (2020-12-08)

* CSS fixes for TwentyTwentyone
* Tested with WP 5.6

#### 1.4.6.2 (2020-08-27)

* Fix a regression in the previous commit – sorry about that!

#### 1.4.6.1 (2020-08-26)

* Minor: Added a bitcoin donation address to the admin panel & readme
* Tested on WP 5.5

#### 1.4.6 (2019-11-22)

* CSS fixes for TwentyTwenty
* Tested on WP 5.3

#### 1.4.5 (2018-11-22)

* Minor: tested against WP 5.0, & updated some links to https

#### 1.4.4 (2018-06-20)

* CSS fixes for TwentyFifteen
* Added privacy policy
* Tested on WP 4.9.6

#### 1.4.3 (2016-12-09)

* Fix a rare Notice that may occur if WP\_DEBUG is defined and you have very old entries that still include user-uploaded images
* CSS fixes for TwentySeventeen
* Minor CSS tweaks to improve spacing on the Sign Guestbook page
* Add an id to the section of the Sign Guestbook page populated by the “comment\_form” action
* Tested on WP 4.7

#### 1.4.2 (2016-04-23)

* Fix an erroneous message if saving the guestbook page as “None”
* Verified with WP 4.5

#### 1.4.1 (2016-01-09)

* Language Pack fix: Add a Domain Path
* Language Pack fix: Remove markup from a few translateable strings

#### 1.4.0 (2016-01-09)

* Add support for WordPress Language Packs
* Add filter vgb\_author\_name, so you can customize how the author names are displayed (i.e. wrap them in a link, etc)
* Increase copyright year

#### 1.3.18 (2015-12-02)

* CSS fixes for TwentySixteen
* Tested with WP 4.4

#### 1.3.17 (2015-08-08)

* WP 4.3 defaults to ‘comments off’ for new pages. WP-ViperGB will now detect this, & automatically enable comments on the page selected to be used as a guestbook (as required for it to function).

#### 1.3.16 (2015-06-05)

* XSS security fix ([this](https://make.wordpress.org/plugins/2015/04/20/fixing-add_query_arg-and-remove_query_arg-usage/))

#### 1.3.15 (2015-04-28)

* Add Arabic translation
* Fix a deprecated function call when processing embedded images
* CSS fixes for compatibility with twentyfourteen & twentyfifteen
* Tested with WP 4.2.1

#### 1.3.14 (2015-02-06)

* Trim leftover code from the “upload images” feature (removed long ago)
* Fix some harmless admin panel notices when saving options if WP\_DEBUG is defined
* Fix some harmless frontend notices shown when the “Digg Pagination” option is enabled & WP\_DEBUG is defined

#### 1.3.13 (2014-12-22)

* Updated Norwegian translation
* Add .gbPagination css class to avoid confusion with “pagination” (used in twentyfourteen & twentyfifteen)
* Add a note to admin page about using pretty permalinks with digg-style pagination
* CSS fixes for twentyfifteen
* Set language of default .po file
* Tested with WP4.1

#### 1.3.12 (2014-12-12)

* Added Norwegian translation (Thanks Hermod Svingerud)

#### 1.3.11 (2014-11-27)

* Fix potential vulneratility with some unescaped options in the admin panel
* Tested with WP 4.0.1

#### 1.3.10 (2014-04-17)

* Tested with WP 3.9
* Change email to link in the copyright notice

#### 1.3.9 (2013-12-12)

* Tested with WP 3.8

#### 1.3.8 (2013-10-25)

* Tested with WP 3.7

#### 1.3.7 (2013-06-10)

* Updated Russian translations

#### 1.3.6 (2013-05-07)

* Remove auth()

#### 1.3.5 (2012-12-26)

* Add “Prev” & “Next” strings in digg-style pagination to .po for localization
* Add “required” strings next to “Name” and “Email”
* Update the main .po file with the above & some other new items
* Convert some HTML5-invalid attributes (i.e. cellspacing, valign) to CSS
* Updated Hungarian translations

#### 1.3.4 (2012-12-19)

* Add Spanish translation (Thanks William Galeano @ http://ingenero.com.co)

#### 1.3.3 (2012-11-26)

* Fix a few more WP\_DEBUG warnings I missed in 1.3.2

#### 1.3.2 (2012-11-26)

* Fix a couple harmless warnings that appear if WP\_DEBUG is defined
* Update the ‘Tested Up To’ version

#### 1.3.1 (2012-11-03)

* Update Russian translations

#### 1.3.0 (2012-10-02)

* New option: Digg-style pagination (thanks Sascha Nebel!)

#### 1.2.1 (2012-09-28)

* New option: only allow registered blog users to sign the guestbook (to discourage spammers)
* The ‘guestbook page’ dropdown in the admin panel now lists both published and private pages

#### 1.2.0 (2012-08-16)

* Remove the ability to embed images in user signatures. Due to a security exploit discovered in Easy-Comment-Uploads, the script upon which this feature was built, it had to be removed to satisfy WordPress’ safety guidelines and keep this plugin available.

#### 1.1.30 (2012-03-25)

* Add Dutch translation

#### 1.1.29 (2012-03-24)

* Add Hungarian translation
* Update WordPress compatibility number

#### 1.1.28 (2012-01-28)

* Add Ukrainian translation
* More Swedish translation fixes

#### 1.1.27 (2012-01-28)

* Swedish translation fixes

#### 1.1.26 (2012-01-27)

* Add Swedish translation

#### 1.1.25 (2011-12-09)

* Add Danish translation
* Remove the wp-fb-autoconnect premium button from the “sign” page

#### 1.1.24 (2011-12-01)

* Remove the “subscribe\_reloaded\_show” action from the “sign” page

#### 1.1.23 (2011-11-28)

* Removed plugin sponsorship messages. See [Automattic Bullies WordPress Plugin Developers — Again](http://gregsplugins.com/lib/2011/11/26/automattic-bullies/).
* Update compatibility number

#### 1.1.22 (2011-06-20)

* Updated Turkish translation (now 100% complete)

#### 1.1.21 (2011-06-20)

* Add Turkish translation

#### 1.1.20 (2011-06-14)

* Add Polish translation
* Add Sponsorship message to admin panel
* Update ‘Tested Up To’ version

#### 1.1.19 (2011-04-20)

* Add French and Czech translations

#### 1.1.18 (2011-04-11)

* Still not working, attempt #2…

#### 1.1.17 (2011-04-11)

* Mark as compatible to 3.1
* Attempt to fix “The plugin does not have a valid header”

#### 1.1.16 (2011-01-25)

* Add German translation

#### 1.1.15 (2011-01-13)

* Updated Russian translation

#### 1.1.14 (2011-01-12)

* Add Italian translation

#### 1.1.13 (2011-01-12)

* Fix parse error

#### 1.1.12 (2011-01-11)

* Add Russian translation

#### 1.1.11 (2011-01-07)

* Even more localization

#### 1.1.10 (2011-01-07)

* Date format is now translatable

#### 1.1.9 (2011-01-07)

* One more untranslated string

#### 1.1.8 (2011-01-07)

* Add a few more untranslated strings

#### 1.1.7 (2011-01-07)

* Oops – more localization fixes

#### 1.1.5 (2011-01-07)

* Fix textdomain for localization

#### 1.1.4 (2010-12-24)

* Add missing UK flag
* Increase “tested up to” version number

#### 1.1.3 (2010-12-13)

* Works with SI CAPTCHA Anti-Spam plugin

#### 1.1.2 (2010-10-30)

* Add return URL to paypal donate button

#### 1.1.1 (2010-08-24)

* Get rid of i18n folder in /easy-comment-uploads (unused)

#### 1.1.0 (2010-08-08)

* Add localization support
* Add flag icon for Serbia

#### 1.0.5 (2010-03-16)

* Use php long tags instead of short tags for server compatability

#### 1.0.4 (2010-03-12)

* New version of easy-comment-uploads; should now work on Windows servers

#### 1.0.3 (2010-03-10)

* More CSS fixes for some themes

#### 1.0.2 (2010-03-09)

* CSS fixes

#### 1.0.1 (2010-03-09)

* Add version number to plugin code
* Small bug fixes & cleanups

#### 1.0.0 (2010-03-08)

* First Release

## Meta

* Version **1.6.2**
* Last updated **8 months ago**
* Active installations **500+**
* WordPress version **2.5 or higher**
* Tested up to **6.5.5**
* Languages
  See all 3

  Close

  [English (US)](https://wordpress.org/plugins/wp-vipergb/), [German](https://de.wordpress.org/plugins/wp-vipergb/), and [Swedish](https://sv.wordpress.org/plugins/wp-vipergb/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/wp-vipergb)
* Tag [guestbook](https://wordpress.org/plugins/tags/guestbook/)
* [Advanced View](https://wordpress.org/plugins/wp-vipergb/advanced/)

## Ratings

4.5 out of 5 stars.

* [3 5-star reviews
  5 stars

  3](https://wordpress.org/support/plugin/wp-vipergb/reviews/?filter=5)
* [0 4-star reviews
  4 stars

  0](https://wordpress.org/support/plugin/wp-vipergb/reviews/?filter=4)
* [1 3-star review
  3 stars

  1](https://wordpress.org/support/plugin/wp-vipergb/reviews/?filter=3)
* [0 2-star reviews
  2 stars

  0](https://wordpress.org/support/plugin/wp-vipergb/reviews/?filter=2)
* [0 1-star reviews
  1 star

  0](https://wordpress.org/support/plugin/wp-vipergb/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/wp-vipergb/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/wp-vipergb/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/ea3fd8cb4d94f3b41e970ec56bcf297f12621f96c863e1deb46ae12a2dabb7e8?s=32&d=mm&r=g) [justin\_k](https://profiles.wordpress.org/justin_k/)
## Support

Got something to say? Need help?

[View support forum](https://wordpress.org/support/plugin/wp-vipergb/)

## Donate

Would you like to support the advancement of this plugin?

[Donate to this plugin](https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=BUMTK5NRRG8UN)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from make.wordpress.org_3a45cef8_20250124_143038.html ===

[Skip to content](#primary)

* [Log In](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fmake.wordpress.org%2Fplugins%2F2015%2F04%2F20%2Ffixing-add_query_arg-and-remove_query_arg-usage%2F&locale=en_US)
* [Register](https://login.wordpress.org/register?locale=en_US)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Make WordPress Plugins](https://make.wordpress.org/plugins)

* [Plugin Directory Reviewer’s Handbook](https://make.wordpress.org/plugins/handbook/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fmake.wordpress.org%2Fplugins%2F2015%2F04%2F20%2Ffixing-add_query_arg-and-remove_query_arg-usage&locale=en_US)

* [Plugin Directory Reviewer’s Handbook](https://make.wordpress.org/plugins/handbook/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fmake.wordpress.org%2Fplugins%2F2015%2F04%2F20%2Ffixing-add_query_arg-and-remove_query_arg-usage&locale=en_US)

**Menu**
Hide welcome box

### Welcome to the official blog for the PluginPlugin A plugin is a piece of software containing a group of functions that can be added to a WordPress website. They can extend functionality or add new features to your WordPress websites. WordPress plugins are written in the PHP programming language and integrate seamlessly with WordPress. These can be free in the WordPress.org Plugin Directory https://wordpress.org/plugins/ or can be cost-based plugin from a third-party Review Team.

The review team acts as gate-keepers and fresh eyes on newly submitted plugins, as well as reviewing any reported security or guideline violations.

**Quick Links**

* [Handbook](https://make.wordpress.org/plugins/handbook)
* [Reporting Plugin Issues](https://developer.wordpress.org/plugins/wordpress-org/plugin-security/reporting-plugin-security-issues/)
* [Plugin Developer Resources](https://developer.wordpress.org/plugins/)
* [Plugin Directory Resources](https://developer.wordpress.org/plugins/wordpress-org/)

### Communication

We can be reached by email at **plugins＠wordpress.orgWordPress.org The community site where WordPress code is created and shared by the users. This is where you can download the source code for WordPress core, plugins and themes as well as the central location for community conversations and organization. <https://wordpress.org/>**, or via the [**#pluginreview**](https://wordpress.slack.com/messages/pluginreview) channel on [Slack](https://make.wordpress.org/chat/).

* [Login to Reply](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fmake.wordpress.org%2Fplugins%2Fwelcome%2F%23respond&locale=en_US "Login to Reply")

##

[![](https://secure.gravatar.com/avatar/e522019adbe7cb4145f9e01c344c036baaa8bf76cd5d76e6b737b60be9af88cc?s=48&d=mm&r=g)](https://profiles.wordpress.org/pento/ "Posts by Gary Pendergast ( @pento )")
[Gary Pendergast](https://profiles.wordpress.org/pento/ "Posts by Gary Pendergast ( @pento )")
5:00 pm *on* April 20, 2015

Tags: [security ( 15 )](https://make.wordpress.org/plugins/tag/security/)

# Fixing add\_query\_arg() and remove\_query\_arg() usage

*Background: Due to a now-fixed ambiguity in the documentation for the `[add_query_arg()](https://developer.wordpress.org/reference/functions/add_query_arg/)` and `[remove_query_arg()](https://developer.wordpress.org/reference/functions/remove_query_arg/)` functions, many plugins were using them incorrectly, allowing for potential XSS attack vectors in their code.*

Both `add_query_arg()` and `remove_query_arg()` have an optional argument to define the base query string to use. If this argument is undefined, it will use `$_SERVER['REQUEST_URI']`, which is unescaped. When printed out to a page, this could be used as an XSS attack vector.

The easiest way to fix this in your pluginPlugin A plugin is a piece of software containing a group of functions that can be added to a WordPress website. They can extend functionality or add new features to your WordPress websites. WordPress plugins are written in the PHP programming language and integrate seamlessly with WordPress. These can be free in the WordPress.org Plugin Directory https://wordpress.org/plugins/ or can be cost-based plugin from a third-party is to escape the output of `add_query_arg()` and `remove_query_arg()`. When it’s being printed to a page (for example as a link), you should use `[esc_url()](https://developer.wordpress.org/reference/functions/esc_url/)`. When it’s being used in HTTPHTTP HTTP is an acronym for Hyper Text Transfer Protocol. HTTP is the underlying protocol used by the World Wide Web and this protocol defines how messages are formatted and transmitted, and what actions Web servers and browsers should take in response to various commands. headers or as part of a HTTP request (for example, as part of a location redirect headerHeader The header of your site is typically the first thing people will experience. The masthead or header art located across the top of your page is part of the look and feel of your website. It can influence a visitor’s opinion about your content and you/ your organization’s brand. It may also look different on different screen sizes. or in a `[wp_remote_get()](https://developer.wordpress.org/reference/functions/wp_remote_get/)` call), you should use `[esc_url_raw()](https://developer.wordpress.org/reference/functions/esc_url_raw/)`.

*Edit by Ipstenu: Also read [Sucuri’s reasonable disclosure on the matter](https://blog.sucuri.net/2015/04/security-advisory-xss-vulnerability-affecting-multiple-wordpress-plugins.html). Many plugins have been patched and auto-updated in a massive coordinated effort to stem this one before it gets nasty.*

[#security](https://make.wordpress.org/plugins/tag/security/)

### Share this:

* [Click to share on Threads (Opens in new window)](https://make.wordpress.org/plugins/2015/04/20/fixing-add_query_arg-and-remove_query_arg-usage/?share=threads "Click to share on Threads")
* [Click to share on Mastodon (Opens in new window)](https://make.wordpress.org/plugins/2015/04/20/fixing-add_query_arg-and-remove_query_arg-usage/?share=mastodon "Click to share on Mastodon")
* [Click to share on Bluesky (Opens in new window)](https://make.wordpress.org/plugins/2015/04/20/fixing-add_query_arg-and-remove_query_arg-usage/?share=bluesky "Click to share on Bluesky")
* [Click to share on X (Opens in new window)](https://make.wordpress.org/plugins/2015/04/20/fixing-add_query_arg-and-remove_query_arg-usage/?share=x "Click to share on X")
* [Click to share on Facebook (Opens in new window)](https://make.wordpress.org/plugins/2015/04/20/fixing-add_query_arg-and-remove_query_arg-usage/?share=facebook "Click to share on Facebook")
* [Click to share on LinkedIn (Opens in new window)](https://make.wordpress.org/plugins/2015/04/20/fixing-add_query_arg-and-remove_query_arg-usage/?share=linkedin "Click to share on LinkedIn")

1. ![](https://secure.gravatar.com/avatar/27180c82524020e7339e2b30818b6d8ab004c54f730f12b1434b1e365be0e175?s=32&d=mm&r=g)
   [Ipstenu (Mika Epstein)](https://profiles.wordpress.org/ipstenu/)
   5:15 pm *on* April 20, 2015

   Edited: Also read Sucuri’s reasonable disclosure on the matter here: <https://blog.sucuri.net/2015/04/security-advisory-xss-vulnerability-affecting-multiple-wordpress-plugins.html>

   Many plugins have been patched and auto-updated in a massive coordinated effort to stem this one before it gets nasty. Thanks [@pento](https://profiles.wordpress.org/pento/) and everyone else who was in there working on this. You all make WP awesome.
3. ![](https://secure.gravatar.com/avatar/14db6fbd5f16b02164b1ed0a729be42654e2ac86c3e04f42c2a70f4a884b3314?s=32&d=mm&r=g)
   [Pau Iglesias](https://profiles.wordpress.org/pauiglesias/)
   5:53 pm *on* April 20, 2015

   Hi, a question, wp\_safe\_redirect argument need esc\_url when the URLURL A specific web address of a website or web page on the Internet, such as a website’s URL www.wordpress.org value comes from add\_query\_arg o remove\_query\_arg?

   * ![](https://secure.gravatar.com/avatar/b5f16acb1bc24ca6bf644adb593384de64046fa69c5de867a7647c7f736a1271?s=32&d=mm&r=g)
     [Alex Mills (Viper007Bond)](https://profiles.wordpress.org/viper007bond/)
     8:03 pm *on* April 20, 2015

     Always, always use `esc_url()` or `esc_url_raw()`. There’s just zero reason not to.

     + ![](https://secure.gravatar.com/avatar/14db6fbd5f16b02164b1ed0a729be42654e2ac86c3e04f42c2a70f4a884b3314?s=32&d=mm&r=g)
       [Pau Iglesias](https://profiles.wordpress.org/pauiglesias/)
       7:52 am *on* April 21, 2015

       Thanks Alex, beside this, I think it would be right to add esc\_url natively to add\_query\_arg function in next WordPress version.
   * ![](https://secure.gravatar.com/avatar/250257111d1248c34046552bbcdf6999949ef56b2f992dd5eb39bf45cabeb18a?s=32&d=mm&r=g)
     [Samuel Wood (Otto)](https://profiles.wordpress.org/otto42/)
     11:42 pm *on* April 20, 2015

     Yes, if you’re using wp\_safe\_redirect with a value obtained from one of the query\_arg functions, then you should pass it through esc\_url\_raw first. The reason to use the raw version is because a redirect is essentially sending a Location: headerHeader The header of your site is typically the first thing people will experience. The masthead or header art located across the top of your page is part of the look and feel of your website. It can influence a visitor’s opinion about your content and you/ your organization’s brand. It may also look different on different screen sizes..

     + ![](https://secure.gravatar.com/avatar/14db6fbd5f16b02164b1ed0a729be42654e2ac86c3e04f42c2a70f4a884b3314?s=32&d=mm&r=g)
       [Pau Iglesias](https://profiles.wordpress.org/pauiglesias/)
       7:48 am *on* April 21, 2015

       Ok, I’ve been inspecting the code and esc\_url\_raw is intented to use to avoid esc\_url escapes ampersand and single quotes, necessary to work with Location URLURL A specific web address of a website or web page on the Internet, such as a website’s URL www.wordpress.org’s, I understand now, thanks Samuel.
   * ![](https://secure.gravatar.com/avatar/b5f16acb1bc24ca6bf644adb593384de64046fa69c5de867a7647c7f736a1271?s=32&d=mm&r=g)
     [Alex Mills (Viper007Bond)](https://profiles.wordpress.org/viper007bond/)
     12:38 am *on* September 10, 2015

     I’d like to follow up here and state that I think I was wrong. `wp_redirect()` uses `wp_sanitize_redirect()`. Plus if coreCore Core is the set of software required to run WordPress. The Core Development Team builds WordPress. thought it was important to do, it’d be using the function itself (it’s not) or even better automatically doing it at the code level (which it is).
5. ![](https://secure.gravatar.com/avatar/6601fea5593bacaa9868b8335f7dcf5aaaf60cd856e15cc49d6d7e182ec702a9?s=32&d=mm&r=g)
   [Tomas Mackevicius](https://profiles.wordpress.org/tomasm/)
   10:51 pm *on* April 20, 2015

   Does it apply also for themes? I see that Twenty Fifteen is using it in functions.php:

    `if ( $fonts ) {

   $fonts_url = add_query_arg( array(

   'family' => urlencode( implode( '|', $fonts ) ),

   'subset' => urlencode( $subsets ),

   ), '//fonts.googleapis.com/css' );

   }:`

   * ![](https://secure.gravatar.com/avatar/250257111d1248c34046552bbcdf6999949ef56b2f992dd5eb39bf45cabeb18a?s=32&d=mm&r=g)
     [Samuel Wood (Otto)](https://profiles.wordpress.org/otto42/)
     11:46 pm *on* April 20, 2015

     It applies to everything, however, note that the returned value is only potentially unsafe when you’re not passing a URLURL A specific web address of a website or web page on the Internet, such as a website’s URL www.wordpress.org (the second parameter) to the the add\_query\_arg function.

     If you don’t pass a URL to the function, then it uses $\_SERVER[‘REQUEST\_URI’] instead. That’s the potential problem, because that URL originally comes from the web browser. If you’re passing in your own URL, like ‘//fonts.googleapis.com/css’, then there’s no data being used which comes from the browser, and so the result will be safe.

     You can, and probably should, use escaping functions anyway, just as a good practice. But it’s a very specific type of use-case that is affected here, one which was not obvious from the documentation of those functions.
   * ![](https://secure.gravatar.com/avatar/81a6c81f384c9d0bf3864240e1f5f197c6a3a1052c7cfc9e3e8fd977365cad4a?s=32&d=mm&r=g)
     [SimonRWaters](https://profiles.wordpress.org/simonrwaters/)
     10:21 am *on* April 21, 2015

     As Samuel says this usage looks safe.

     However tweaking URLs for this kind of XSS issue is done by all good web security tools.

     We used Burp Suite to find a couple of these issues in common plugins (WP\_Supercache and Simple Page Ordering).

     You may want to run such a tool over your plugins, especially if you handle a lot of user input, or do clever stuff with URLs. I found a common case of this was people making “tabbed” interfaces, probably cut and paste propagation.

     Also any pluginPlugin A plugin is a piece of software containing a group of functions that can be added to a WordPress website. They can extend functionality or add new features to your WordPress websites. WordPress plugins are written in the PHP programming language and integrate seamlessly with WordPress. These can be free in the WordPress.org Plugin Directory https://wordpress.org/plugins/ or can be cost-based plugin from a third-party exposing functionality to roles below editor should make sure those roles can’t inject JavaScriptJavaScript JavaScript or JS is an object-oriented computer programming language commonly used to create interactive effects within web browsers. WordPress makes extensive use of JS for a better user experience. While PHP is executed on the server, JS executes within a user’s browser. <https://www.javascript.com/>. that will be run by editor/admin.

     The most obvious attacks against these weaknesses are caught by XSS auditors in Chrome and IE, but Firefox doesn’t have such an auditor, and they aren’t foolproof by any means.
7. ![](https://secure.gravatar.com/avatar/242c0cad5e2da1eca9c7246640d2f0a20dc5d21f2046333a6ce3cec6f4acc9c1?s=32&d=mm&r=g)
   [\_smartik\_](https://profiles.wordpress.org/_smartik_/)
   7:50 pm *on* April 21, 2015

   To fix this in my plugins quick and easy I will simply replace the function names with with custom functions.

   Here is how I did it: <http://smartik.ws/2015/04/safe-add_query_var-and-remove_query_var/>

   Hope this helps.
9. ![](https://secure.gravatar.com/avatar/7995c292f2516bd888aa767cac3e24eff18befc29cd65bd39acd870e7789f3f6?s=32&d=mm&r=g)
   [modifiedcontent](https://profiles.wordpress.org/modifiedcontent/)
   5:13 pm *on* April 22, 2015

   How can I fix this in plugins that are no longer maintained/updated and custom theme code?

   I tried \_smartik’s solution, but it only caused more errors – and then notices he is targeting the wrong functions anyway, ‘var’ instead of ‘arg’

   Could someone please give a ‘for dummies’ explanation how to replace this?

   FeedWordPress has this for example:

   ```
   " wp_redirect( add_query_arg( array('zapped' => 1, 'ids' => $post_id), $sendback ) ); "
   ```

   How do I ‘escape the output of add\_query\_arg() and remove\_query\_arg()’?

   * ![](https://secure.gravatar.com/avatar/242c0cad5e2da1eca9c7246640d2f0a20dc5d21f2046333a6ce3cec6f4acc9c1?s=32&d=mm&r=g)
     [\_smartik\_](https://profiles.wordpress.org/_smartik_/)
     10:57 am *on* April 23, 2015

     Try `esc_url($sendback)`  or if this still not works esc\_url\_raw($sendback).

     As for the link. Sorry I miswritten the function names.
11. ![](https://secure.gravatar.com/avatar/21cb756d1e1160afa6db6a8e1950e4cf2a713a0203767e5f44b8b115f17fa93f?s=32&d=mm&r=g)
    [beda69](https://profiles.wordpress.org/beda69/)
    7:04 pm *on* April 29, 2015

    I am a noob but concerned

    REDUX is using this:

    `<a class="nav-tab "

    href=" 'redux-about' ), 'tools.php' ) ) ); ?>">`

    at least 6 times.

    since the second argument here is tools.php, no need to escape that, right?

    * ![](https://secure.gravatar.com/avatar/21cb756d1e1160afa6db6a8e1950e4cf2a713a0203767e5f44b8b115f17fa93f?s=32&d=mm&r=g)
      [beda69](https://profiles.wordpress.org/beda69/)
      7:06 pm *on* April 29, 2015

      sorry, code got cut off

      `<a class="nav-tab "

      href=" 'redux-about' ), 'tools.php' ) ) ); ?>">`

      main issue:

      `echo esc_url( admin_url( add_query_arg( array( 'page' => 'redux-about' ), 'tools.php' ) ) );`
13. ![](https://secure.gravatar.com/avatar/64b51769e7b80312023eb6c3f766cb512cf79adf7265812b15442f9573a9a056?s=32&d=mm&r=g)
    [Tran Ngoc Tuan Anh](https://profiles.wordpress.org/rilwis/)
    4:53 am *on* August 18, 2015

    Thanks for this very helpful note.
15. ![](https://secure.gravatar.com/avatar/21ff2fc12e09dbbeec1097ebe7372192fa19606d1e19b03e00451c4c5958be98?s=32&d=mm&r=g)
    [tech\_hutch](https://profiles.wordpress.org/tech_hutch/)
    4:58 pm *on* June 23, 2016

    Since `esc\_url` encodes ampersands, wouldn’t it make more sense to always use `esc\_url\_raw` instead with `add\_query\_arg`, or am I missing something?

    * ![](https://secure.gravatar.com/avatar/21ff2fc12e09dbbeec1097ebe7372192fa19606d1e19b03e00451c4c5958be98?s=32&d=mm&r=g)
      [tech\_hutch](https://profiles.wordpress.org/tech_hutch/)
      8:32 pm *on* June 23, 2016

      Actually, never mind; `esc\_url\_raw` encodes ampersands as well, and also it doesn’t matter if ampersands are escaped in attributes like ‘href’ and ‘src’.

Comments are closed.

# Post navigation

[← Isotope 2.2 And Up is GPL Compatible](https://make.wordpress.org/plugins/2015/04/14/isotope-2-2-and-up-is-gpl-compatible/) [Reminder: Please Test Your Plugins With 4.2 →](https://make.wordpress.org/plugins/2015/04/21/reminder-please-test-your-plugins-with-4-2/)

## Site resources

Search

### Email Updates

Enter your email address to subscribe to this blog and receive notifications of new posts by email.

Type your email…

Subscribe

Join 3,017 other subscribers

### Help Topics

* [Plugin Guidelines](https://developer.wordpress.org/plugins/wordpress-org/detailed-plugin-guidelines/)
* [Developer FAQ](https://developer.wordpress.org/plugins/wordpress-org/plugin-developer-faq/)
* [Using Subversion](https://developer.wordpress.org/plugins/wordpress-org/how-to-use-subversion/)
* [Using Plugin Assets](https://developer.wordpress.org/plugins/wordpress-org/plugin-assets/)
* [How Your Readme.txt works](https://developer.wordpress.org/plugins/wordpress-org/how-your-readme-txt-works/)

* [Recent Updates](https://make.wordpress.org/plugins/)
* [Recent Comments](https://make.wordpress.org/plugins/?o2_recent_comments=1)
* [No Replies](https://make.wordpress.org/plugins/?replies=none)

Recent UpdatesRecent CommentsNo Replies
### Recent Activity

### Search

Search

### Team Pledges

[429 people](https://make.wordpress.org/plugins/pledges/) have pledged time to contribute to Plugins Team efforts! When looking for help on a project or program, try starting by reaching out to them!

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

ssearch
ccompose new post
r reply
e edit
t go to top
j go to the next post or comment
k go to the previous post or comment
o toggle comment visibility
esc cancel edit post or comment

Please enable JavaScript to view this page properly.


