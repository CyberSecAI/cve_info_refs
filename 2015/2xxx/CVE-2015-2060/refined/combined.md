=== Content from www.openwall.com_6b01bb8c_20250125_164956.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[thread-next>]](../../../2015/02/23/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <54E4656B.3060606@openwall.com>
Date: Wed, 18 Feb 2015 13:11:55 +0300
From: Alexander Cherepanov <ch3root@...nwall.com>
To: oss-security@...ts.openwall.com
Subject: CVE Request: cabextract -- directory traversal

Hi!

cabextract is susceptible to a directory traversal vulnerability. While
extracting files from an archive, it removes leading slashes from
filenames but does it before possibly decoding UTF-8 and doesn't check
for invalid UTF-8. Hence an absolute filename can be shoved through by
using overlong encoding for the leading slash (and setting utf8
attribute in the header). This can be exploited by a malicious archive
to write files outside the current directory.

Illustration:

$ touch xxxxxxxxxx
$ lcab xxxxxxxxxx test.cab
$ sed -i 's|\x20\x00xxxxxxxxxx|\xa0\x00\xe0\x80\xaftmp/abs|g' test.cab
$ rm xxxxxxxxxx

$ ls /tmp/abs
ls: cannot access /tmp/abs: No such file or directory

$ ./cabextract test.cab
Extracting cabinet: test.cab
   extracting /tmp/abs

All done, no errors.

$ ls /tmp/abs
/tmp/abs

In the sed command above, \xe0\x80\xaf is an overlong encoding for '/',
\xa0\x00 are flags updated to include utf-8 flag.

The issue was found in cabextract 1.4 and 2-byte encoding (\xc0\xaf) was
enough to hide '/'. cabextract 1.5 tightened utf-8 checks and 3-byte
encoding is now necessary.

The issue was reported to Stuart Caie today and fixed in less than 4h:

<http://sourceforge.net/p/libmspack/code/217/>

Another release of cabextract is expected in the next few days.

Could CVE please be assigned?

--
Alexander Cherepanov

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_4e9178da_20250125_164957.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](23) [[next>]](25) [[<thread-prev]](16) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20150223211254.889226C0057@smtpvmsrv1.mitre.org>
Date: Mon, 23 Feb 2015 16:12:54 -0500 (EST)
From: cve-assign@...re.org
To: ch3root@...nwall.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE Request: cabextract -- directory traversal

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Use CVE-2015-2060 for this issue in which directory traversal occurs
because the unpatched code does neither of the following:

  - checking for slashes after decoding
  - checking for ordinary slashes before decoding and prohibiting
    overlong encodings

>> What happens if the .cab archive contains only one file, and \/tmp/abs
>> is the filename?

> $ ls *abs
> \tmp\abs

Thanks very much for this additional analysis. This seems to be an
absolute path traversal for the current Cygwin version of cabextract
(1.4-1). In other words, typing "cabextract test.cab" in Cygwin64
Terminal creates %SYSTEMDRIVE%\tmp\abs within the machine's Windows
filesystem, at least if %SYSTEMDRIVE%\tmp already exists. Because
Cygwin is specifically advertised as an available platform on the
<http://www.cabextract.org.uk/> page, it appears that this should be
considered a separate vulnerability and fixed.

> the code seems to be accurate in this regard

We think you mean that there's no traversal on Linux because \tmp\abs
is simply a filename within the current directory. Do you agree that
there should be a CVE for the %SYSTEMDRIVE%\tmp\abs outcome with
Cygwin?

Finally, here's additional discussion (which is probably unimportant
and can be skipped) about whether \tmp\abs is an appropriate outcome
on Linux.

Essentially, creating \tmp\abs in response to \/tmp/abs seems to be
undocumented and potentially dangerous, but we don't (yet) know of any
realistic scenario in which it would be exploitable.
<http://www.cabextract.org.uk/#usage> says "cabextract will extract all
files in all cabinets to the current directory, preserving any
internal directory structure." If the filename \/tmp/abs is found,
this would seem to imply that a pathname of \/tmp/abs should be
created under the current directory (i.e., create a directory named \
and then create a directory named tmp and then create a plain file
named abs). Instead, the code guesses that the user wants something
entirely different: a plain file named \tmp\abs in the top level of
the current directory.

A security problem would occur if the current directory is unsafe, but
the \ directory tree is safe. Specifically, suppose that the current
directory is a production directory used as an argument to a program
similar to run-parts (not run-parts itself, but another program that
executes every script -- regardless of name or permissions -- within a
single directory). Also, the \ directory tree happens to be used for
working copies of scripts that are not yet validated for production.
The threat model is that the user obtains a valid .cab file that was
created elsewhere with other tools, and is sure that it contains an
intended \/tmp/abs filename. Then, the user runs cabextract and is
surprised to see the "wrong" filename and resulting code execution.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJU65dbAAoJEKllVAevmvmsWQQH/jNyIG6RqCmtJnz221QJg1NP
sCOu3mmj3NwdUeyADYr+bKxTFZxpeTRbfxHozfEDDZm7lEqp6ksbRGk2XGQAPrR9
SPAwd4avo7S/hcoZ7mQK5lkaeCsxrTHkuI+lkNlJVLHP9sQ/omR4qtuWNfmj6ifH
PkP0KgSoLfF4Ky7AyI7Xi3Jhryptdz3IG5hyDa/eCuLs3k6AG5gQF1uWN2D2zmsN
Hnx4dDfHuhXQXX5MMYty+B0YVvFHPLoqaNrdUJWcxPYOZHRKwnhrt9AF5eTbXbah
PkJ7mB+V0gl+BqXN9zjrmsnXkEakdA5ksy/xDgIaF6mJ1qCcVerr/DvdKWNMVqI=
=PnB3
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.mandriva.com_3d8c8155_20250125_164956.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from www.openwall.com_e17ca946_20250125_164957.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](15) [[next>]](17) [[<thread-prev]](3) [[thread-next>]](24) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <54EB32C0.9010808@openwall.com>
Date: Mon, 23 Feb 2015 17:01:36 +0300
From: Alexander Cherepanov <ch3root@...nwall.com>
To: oss-security@...ts.openwall.com
CC: cve-assign@...re.org
Subject: Re: Re: CVE Request: cabextract -- directory traversal

On 2015-02-23 10:38, cve-assign@...re.org wrote:
>> it removes leading slashes from filenames but does it before possibly
>> decoding UTF-8 and doesn't check for invalid UTF-8
>
>> The issue was reported to Stuart Caie today and fixed in less than 4h:
>
>> <http://sourceforge.net/p/libmspack/code/217/>
>
> Your report seems to be about the need for the "/* remove leading
> slashes */" code to occur after (not before) the "/* get next UTF-8
> character */" code.

That's right (more or less, see below).

> Is this the only vulnerability being reported, or

Yes.

> is the stated behavior of "This doesn't reject bad UTF-8 with overlong
> encodings, but does re-encode it as valid UTF-8" an independent
> vulnerability?

Not that I know of.

More precisely, I see two ways to fix the problem with overlong encoding
of leading slashes:
- by checking for slashes after decoding;
- by checking for ordinary slashes before decoding and prohibiting
overlong encodings.

My report didn't imply any particular fix. The first way seems to be
easier and it was chosen by Stuart. I don't readily see any other
problem with overlong encodings.

>> /* special case if there's only one file - just take the first slash */
>
>> if (c == '\\') return 0; /* backslash = MS-DOS */

The code quoted above is from the unix_path_seperators function which
determines the type of slashes used in the archive.

>> isunix = unix_path_seperators(cab->files);
>
>> sep   = (isunix) ? '/'  : '\\'; /* the path-seperator */

This line is from the create_output_name function. The next line:

   slash = (isunix) ? '\\' : '/';  /* the other slash */

>>   while (*fname == sep) fname++;

This is from non-utf8 code path. It skips leading "sep"s, then all
"sep"s are converted to '/' and all "slash"es are converted to '\\':

     do {
       c = *fname++;
       if      (c == sep)   c = '/';
       else if (c == slash) c = '\\';
       else if (lower)      c = (unsigned char) tolower((int) c);
     } while ((*p++ = c));

The utf8 code path is similar.

> What happens if the .cab archive contains only one file, and \/tmp/abs
> is the filename?

In this case, the unix_path_seperators function will determine that
MS-DOS path separators are used. Hence sep == '\\' && slash == '/' in
the create_output_name function. Then the leading '\' is skipped and all
'/' are converted to '\\'.

Indeed:

$ touch xxxxxxxxx
$ lcab xxxxxxxxx test.cab > /dev/null
$ sed -i 's|xxxxxxxxx|\\/tmp/abs|g' test.cab
$ rm xxxxxxxxx

$ ls *abs
ls: cannot access *abs: No such file or directory

$ ./cabextract test.cab
Extracting cabinet: test.cab
   extracting \tmp\abs

All done, no errors.

$ ls *abs
\tmp\abs

It's important that all checks of input filename are against "sep" and
"slash" and all checks of output filename (e.g. for "../") are against
explicit '/' and '\\' but the code seems to be accurate in this regard.

Another thing which gives me uneasy feeling is the use of tolower:
- if there is a locale where you can get '/' with tolower from another
character this will lead to a dir traversal;
- passing an arbitrary unicode value to tolower (in utf8 code path) is
at least an undefined behavior.
The former doesn't seem probable. The latter, I'll send it now to
Stuart. If someone can see security implications of this it would be
nice to hear it.

--
Alexander Cherepanov

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


