=== Content from plugins.trac.wordpress.org_3a201fca_20250125_022933.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F1199120)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/1199119 "Changeset 1199119")
* [Next Changeset](/changeset/1199121 "Changeset 1199121") →

---

# Changeset 1199120

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
07/15/2015 02:59:01 AM
([10 years](/timeline?from=2015-07-15T02%3A59%3A01Z&precision=second "See timeline at 07/15/2015 02:59:01 AM") ago)

Author:
uscnanbu
Message:

0001100,0001101 nanbu

Location:
[usc-e-shop/trunk](/browser/usc-e-shop/trunk?rev=1199120)
Files:

13 edited

* [classes/dataList.class.php](/browser/usc-e-shop/trunk/classes/dataList.class.php?rev=1199120 "Show entry in browser")
  (modified)
  ([4 diffs](#file0 "Show differences"))
* [classes/itemList.class.php](/browser/usc-e-shop/trunk/classes/itemList.class.php?rev=1199120 "Show entry in browser")
  (modified)
  ([5 diffs](#file1 "Show differences"))
* [classes/orderList.class.php](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1199120 "Show entry in browser")
  (modified)
  ([11 diffs](#file2 "Show differences"))
* [classes/usceshop.class.php](/browser/usc-e-shop/trunk/classes/usceshop.class.php?rev=1199120 "Show entry in browser")
  (modified)
  ([3 diffs](#file3 "Show differences"))
* [includes/edit-form-advanced.php](/browser/usc-e-shop/trunk/includes/edit-form-advanced.php?rev=1199120 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [includes/edit-form-advanced30.php](/browser/usc-e-shop/trunk/includes/edit-form-advanced30.php?rev=1199120 "Show entry in browser")
  (modified)
  ([2 diffs](#file5 "Show differences"))
* [includes/edit-form-advanced34.php](/browser/usc-e-shop/trunk/includes/edit-form-advanced34.php?rev=1199120 "Show entry in browser")
  (modified)
  ([2 diffs](#file6 "Show differences"))
* [includes/member\_edit\_form.php](/browser/usc-e-shop/trunk/includes/member_edit_form.php?rev=1199120 "Show entry in browser")
  (modified)
  ([1 diff](#file7 "Show differences"))
* [includes/order\_edit\_form.php](/browser/usc-e-shop/trunk/includes/order_edit_form.php?rev=1199120 "Show entry in browser")
  (modified)
  ([2 diffs](#file8 "Show differences"))
* [includes/order\_list.php](/browser/usc-e-shop/trunk/includes/order_list.php?rev=1199120 "Show entry in browser")
  (modified)
  ([1 diff](#file9 "Show differences"))
* [includes/purchase\_button.php](/browser/usc-e-shop/trunk/includes/purchase_button.php?rev=1199120 "Show entry in browser")
  (modified)
  ([2 diffs](#file10 "Show differences"))
* [includes/usces\_item\_master\_list.php](/browser/usc-e-shop/trunk/includes/usces_item_master_list.php?rev=1199120 "Show entry in browser")
  (modified)
  ([3 diffs](#file11 "Show differences"))
* [usc-e-shop.php](/browser/usc-e-shop/trunk/usc-e-shop.php?rev=1199120 "Show entry in browser")
  (modified)
  ([1 diff](#file12 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [usc-e-shop/trunk/classes/dataList.class.php](/changeset/1199120/usc-e-shop/trunk/classes/dataList.class.php "Show the changeset 1199120 restricted to usc-e-shop/trunk/classes/dataList.class.php")

  | [r1155963](/browser/usc-e-shop/trunk/classes/dataList.class.php?rev=1155963#L218 "Show revision 1155963 of this file in browser") | [r1199120](/browser/usc-e-shop/trunk/classes/dataList.class.php?rev=1199120#L218 "Show revision 1199120 of this file in browser") |  |
  | --- | --- | --- |
  | 218 | 218 |  |
  | 219 | 219 | $this->action = 'changePage'; |
  | 220 |  | $this->currentPage = $\_REQUEST['changePage']; |
  |  | 220 | $this->currentPage = (int)$\_REQUEST['changePage']; |
  | 221 | 221 |  |
  | 222 | 222 | $this->sortColumn = $\_SESSION[$this->table]['sortColumn']; |
  | […](/browser/usc-e-shop/trunk/classes/dataList.class.php?rev=1155963#L237) | […](/browser/usc-e-shop/trunk/classes/dataList.class.php?rev=1199120#L237) |  |
  | 237 | 237 | $this->action = 'changeSort'; |
  | 238 | 238 | $this->sortOldColumn = $this->sortColumn; |
  | 239 |  | $this->sortColumn = $\_REQUEST['changeSort']; |
  |  | 239 | $this->sortColumn = str\_replace('(', '', $\_REQUEST['changeSort']); |
  |  | 240 | $this->sortColumn = str\_replace(',', '', $this->sortColumn); |
  | 240 | 241 | $this->sortSwitchs = $\_SESSION[$this->table]['sortSwitchs']; |
  | 241 | 242 | $this->sortSwitchs[$this->sortColumn] = $\_REQUEST['switch']; |
  | […](/browser/usc-e-shop/trunk/classes/dataList.class.php?rev=1155963#L256) | […](/browser/usc-e-shop/trunk/classes/dataList.class.php?rev=1199120#L257) |  |
  | 256 | 257 |  |
  | 257 | 258 | $this->action = 'searchIn'; |
  | 258 |  | $this->arr\_search['column'] = ~~$\_REQUEST['search']['column']~~; |
  |  | 259 | $this->arr\_search['column'] = str\_replace(',', '', $\_REQUEST['search']['column']); |
  | 259 | 260 | $this->arr\_search['word'] = $\_REQUEST['search']['word']; |
  | 260 | 261 | $this->arr\_search['period'] = isset($\_REQUEST['search']['period']) ? intval($\_REQUEST['search']['period']) : 0; |
  | 261 |  | $this->searchSwitchStatus = ~~$\_REQUEST['searchSwitchStatus']~~; |
  |  | 262 | $this->searchSwitchStatus = str\_replace(',', '', $\_REQUEST['searchSwitchStatus']); |
  | 262 | 263 |  |
  | 263 | 264 | $this->currentPage = 1; |
  | […](/browser/usc-e-shop/trunk/classes/dataList.class.php?rev=1155963#L278) | […](/browser/usc-e-shop/trunk/classes/dataList.class.php?rev=1199120#L279) |  |
  | 278 | 279 | $this->arr\_search['word'] = ''; |
  | 279 | 280 | $this->arr\_search['period'] = $\_SESSION[$this->table]['arr\_search']['period']; |
  | 280 |  | $this->searchSwitchStatus = ~~$\_REQUEST['searchSwitchStatus']~~; |
  |  | 281 | $this->searchSwitchStatus = str\_replace(',', '', $\_REQUEST['searchSwitchStatus']); |
  | 281 | 282 |  |
  | 282 | 283 | $this->currentPage = 1; |
* ## [usc-e-shop/trunk/classes/itemList.class.php](/changeset/1199120/usc-e-shop/trunk/classes/itemList.class.php "Show the changeset 1199120 restricted to usc-e-shop/trunk/classes/itemList.class.php")

  | [r1155963](/browser/usc-e-shop/trunk/classes/itemList.class.php?rev=1155963#L161 "Show revision 1155963 of this file in browser") | [r1199120](/browser/usc-e-shop/trunk/classes/itemList.class.php?rev=1199120#L161 "Show revision 1199120 of this file in browser") |  |
  | --- | --- | --- |
  | 161 | 161 |  |
  | 162 | 162 | $this->action = 'changePage'; |
  | 163 |  | $this->currentPage = $\_REQUEST['changePage']; |
  |  | 163 | $this->currentPage = (int)$\_REQUEST['changePage']; |
  | 164 | 164 |  |
  | 165 | 165 | $this->sortColumn = $\_SESSION[$this->table]['sortColumn']; |
  | […](/browser/usc-e-shop/trunk/classes/itemList.class.php?rev=1155963#L176) | […](/browser/usc-e-shop/trunk/classes/itemList.class.php?rev=1199120#L176) |  |
  | 176 | 176 | $this->action = 'changeSort'; |
  | 177 | 177 | $this->sortOldColumn = $this->sortColumn; |
  | 178 |  | $this->sortColumn = $\_REQUEST['changeSort']; |
  |  | 178 | $this->sortColumn = str\_replace('(', '', $\_REQUEST['changeSort']); |
  |  | 179 | $this->sortColumn = str\_replace(',', '', $this->sortColumn); |
  | 179 | 180 | $this->sortSwitchs = $\_SESSION[$this->table]['sortSwitchs']; |
  | 180 |  | $this->sortSwitchs[$this->sortColumn] = $\_REQUEST['switch']; |
  |  | 181 | $this->sortSwitchs[$this->sortColumn] = str\_replace('(', '', $\_REQUEST['switch']); |
  |  | 182 | $this->sortSwitchs[$this->sortColumn] = str\_replace(',', '', $this->sortSwitchs[$this->sortColumn]); |
  | 181 | 183 |  |
  | 182 | 184 | $this->currentPage = $\_SESSION[$this->table]['currentPage']; |
  | […](/browser/usc-e-shop/trunk/classes/itemList.class.php?rev=1155963#L191) | […](/browser/usc-e-shop/trunk/classes/itemList.class.php?rev=1199120#L193) |  |
  | 191 | 193 |  |
  | 192 | 194 | $this->action = 'searchIn'; |
  | 193 |  | $this->arr\_search['column'] = isset($\_REQUEST['search']['column']) ? ~~$\_REQUEST['search']['column']~~ : ''; |
  |  | 195 | $this->arr\_search['column'] = isset($\_REQUEST['search']['column']) ? str\_replace(',', '', $\_REQUEST['search']['column']) : ''; |
  | 194 | 196 | $this->arr\_search['word'] = isset($\_REQUEST['search']['word']) ? $\_REQUEST['search']['word'] : ''; |
  | 195 | 197 | $this->arr\_search['period'] = isset($\_REQUEST['search']['period']) ? (int)$\_REQUEST['search']['period'] : ''; |
  | […](/browser/usc-e-shop/trunk/classes/itemList.class.php?rev=1155963#L208) | […](/browser/usc-e-shop/trunk/classes/itemList.class.php?rev=1199120#L210) |  |
  | 208 | 210 | $this->arr\_search['word'] = ''; |
  | 209 | 211 | $this->arr\_search['period'] = $\_SESSION[$this->table]['arr\_search']['period']; |
  | 210 |  | $this->searchSwitchStatus = isset($\_REQUEST['searchSwitchStatus']) ? ~~$\_REQUEST['searchSwitchStatus']~~ : ''; |
  |  | 212 | $this->searchSwitchStatus = isset($\_REQUEST['searchSwitchStatus']) ? str\_replace(',', '', $\_REQUEST['searchSwitchStatus']) : ''; |
  | 211 | 213 |  |
  | 212 | 214 | $this->currentPage = 1; |
  | […](/browser/usc-e-shop/trunk/classes/itemList.class.php?rev=1155963#L233) | […](/browser/usc-e-shop/trunk/classes/itemList.class.php?rev=1199120#L235) |  |
  | 233 | 235 | }else if(isset($\_REQUEST['collective'])){ |
  | 234 | 236 |  |
  | 235 |  | $this->action = 'collective\_' . ~~$\_POST['allchange']['column']~~; |
  |  | 237 | $this->action = 'collective\_' . str\_replace(',', '', $\_POST['allchange']['column']); |
  | 236 | 238 | $this->currentPage = $\_SESSION[$this->table]['currentPage']; |
  | 237 | 239 | $this->sortColumn = $\_SESSION[$this->table]['sortColumn']; |
* ## [usc-e-shop/trunk/classes/orderList.class.php](/changeset/1199120/usc-e-shop/trunk/classes/orderList.class.php "Show the changeset 1199120 restricted to usc-e-shop/trunk/classes/orderList.class.php")

  | [r1155963](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1155963#L72 "Show revision 1155963 of this file in browser") | [r1199120](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1199120#L72 "Show revision 1199120 of this file in browser") |  |
  | --- | --- | --- |
  | 72 | 72 | function SetSelects() |
  | 73 | 73 | { |
  |  | 74 | global $wpdb; |
  |  | 75 |  |
  | 74 | 76 | $status\_sql = ''; |
  | 75 | 77 | foreach( $this->management\_status as $status\_key => $status\_name ) { |
  | 76 |  | $status\_sql .= ~~" WHEN LOCATE('".$status\_key."', order\_status) > 0 THEN '".$status\_name."'"~~; |
  |  | 78 | $status\_sql .= $wpdb->prepare(" WHEN LOCATE(%s, order\_status) > 0 THEN %s", $status\_key, $status\_name ); |
  | 77 | 79 | } |
  | 78 | 80 |  |
  | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1155963#L214) | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1199120#L216) |  |
  | 214 | 216 |  |
  | 215 | 217 | $this->action = 'changePage'; |
  | 216 |  | $this->currentPage = $\_REQUEST['changePage']; |
  |  | 218 | $this->currentPage = (int)$\_REQUEST['changePage']; |
  | 217 | 219 | $this->sortColumn = $\_SESSION[$this->table]['sortColumn']; |
  | 218 | 220 | $this->sortSwitchs = $\_SESSION[$this->table]['sortSwitchs']; |
  | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1155963#L229) | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1199120#L231) |  |
  | 229 | 231 | $this->action = 'changeSort'; |
  | 230 | 232 | $this->sortOldColumn = $this->sortColumn; |
  | 231 |  | $this->sortColumn = $\_REQUEST['changeSort']; |
  |  | 233 | $this->sortColumn = str\_replace('(', '', $\_REQUEST['changeSort']); |
  |  | 234 | $this->sortColumn = str\_replace(',', '', $this->sortColumn); |
  | 232 | 235 | $this->sortSwitchs = $\_SESSION[$this->table]['sortSwitchs']; |
  | 233 |  | $this->sortSwitchs[$this->sortColumn] = $\_REQUEST['switch']; |
  |  | 236 | $this->sortSwitchs[$this->sortColumn] = str\_replace('(', '', $\_REQUEST['switch']); |
  |  | 237 | $this->sortSwitchs[$this->sortColumn] = str\_replace(',', '', $this->sortSwitchs[$this->sortColumn]); |
  | 234 | 238 | $this->currentPage = $\_SESSION[$this->table]['currentPage']; |
  | 235 | 239 | $this->userHeaderNames = $\_SESSION[$this->table]['userHeaderNames']; |
  | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1155963#L244) | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1199120#L248) |  |
  | 244 | 248 |  |
  | 245 | 249 | $this->action = 'searchIn'; |
  | 246 |  | $this->arr\_search['column'] = isset($\_REQUEST['search']['column']) ? ~~$\_REQUEST['search']['column']~~ : ''; |
  |  | 250 | $this->arr\_search['column'] = isset($\_REQUEST['search']['column']) ? str\_replace(',', '', $\_REQUEST['search']['column']) : ''; |
  | 247 | 251 | $this->arr\_search['sku'] = isset($\_REQUEST['search']['sku']) ? $\_REQUEST['search']['sku'] : ''; |
  | 248 | 252 | $this->arr\_search['word'] = isset($\_REQUEST['search']['word']) ? $\_REQUEST['search']['word'] : ''; |
  | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1155963#L264) | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1199120#L268) |  |
  | 264 | 268 | $this->arr\_search['skuword'] = ''; |
  | 265 | 269 | $this->arr\_search['period'] = $\_SESSION[$this->table]['arr\_search']['period']; |
  | 266 |  | $this->searchSwitchStatus = isset($\_REQUEST['searchSwitchStatus']) ? ~~$\_REQUEST['searchSwitchStatus']~~ : ''; |
  |  | 270 | $this->searchSwitchStatus = isset($\_REQUEST['searchSwitchStatus']) ? str\_replace(',', '', $\_REQUEST['searchSwitchStatus']) : ''; |
  | 267 | 271 | $this->currentPage = 1; |
  | 268 | 272 | $this->sortColumn = $\_SESSION[$this->table]['sortColumn']; |
  | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1155963#L287) | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1199120#L291) |  |
  | 287 | 291 | }else if(isset($\_REQUEST['collective'])){ |
  | 288 | 292 |  |
  | 289 |  | $this->action = 'collective\_' . ~~$\_POST['allchange']['column']~~; |
  |  | 293 | $this->action = 'collective\_' . str\_replace(',', '', $\_POST['allchange']['column']); |
  | 290 | 294 | $this->currentPage = $\_SESSION[$this->table]['currentPage']; |
  | 291 | 295 | $this->sortColumn = $\_SESSION[$this->table]['sortColumn']; |
  | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1155963#L310) | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1199120#L314) |  |
  | 310 | 314 | global $wpdb; |
  | 311 | 315 | $where = $this->GetWhere(); |
  | 312 |  | $order = ' ORDER BY `' . ~~$this->sortColumn . '` ' . $this->sortSwitchs[$this->sortColumn]~~; |
  |  | 316 | $order = ' ORDER BY `' . esc\_sql($this->sortColumn) . '` ' . esc\_sql($this->sortSwitchs[$this->sortColumn]); |
  | 313 | 317 | $order = apply\_filters( 'usces\_filter\_order\_list\_get\_orderby', $order, $this ); |
  | 314 | 318 |  |
  | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1155963#L351) | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1199120#L355) |  |
  | 351 | 355 | function GetWhere() |
  | 352 | 356 | { |
  |  | 357 | global $wpdb; |
  | 353 | 358 | $str = ''; |
  | 354 | 359 | $where = ""; |
  | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1155963#L360) | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1199120#L365) |  |
  | 360 | 365 | switch ( $this->arr\_search['period'] ) { |
  | 361 | 366 | case 0: |
  | 362 |  | $where = ~~" WHERE order\_date >= '{$thismonth}' "~~; |
  |  | 367 | $where = $wpdb->prepare(" WHERE order\_date >= %s ", $thismonth ); |
  | 363 | 368 | break; |
  | 364 | 369 | case 1: |
  | 365 |  | $where = ~~" WHERE order\_date >= '{$lastmonth}' AND order\_date < '{$thismonth}' "~~; |
  |  | 370 | $where = $wpdb->prepare(" WHERE order\_date >= %s AND order\_date < %s ", $lastmonth, $thismonth ); |
  | 366 | 371 | break; |
  | 367 | 372 | case 2: |
  | 368 |  | $where = ~~" WHERE order\_date >= '{$lastweek}' "~~; |
  |  | 373 | $where = $wpdb->prepare(" WHERE order\_date >= %s ", $thismonth ); |
  | 369 | 374 | break; |
  | 370 | 375 | case 3: |
  | 371 |  | $where = ~~" WHERE order\_date >= '{$last30}' "~~; |
  |  | 376 | $where = $wpdb->prepare(" WHERE order\_date >= %s ", $thismonth ); |
  | 372 | 377 | break; |
  | 373 | 378 | case 4: |
  | 374 |  | $where = ~~" WHERE order\_date >= '{$last90}' "~~; |
  |  | 379 | $where = $wpdb->prepare(" WHERE order\_date >= %s ", $thismonth ); |
  | 375 | 380 | break; |
  | 376 | 381 | case 5: |
  | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1155963#L409) | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1199120#L414) |  |
  | 409 | 414 | case 'ID': |
  | 410 | 415 | $column = 'ID'; |
  | 411 |  | $this->searchSql = ~~$column~~ . ' = ' . (int)$this->arr\_search['word']['ID']; |
  |  | 416 | $this->searchSql = esc\_sql($column) . ' = ' . (int)$this->arr\_search['word']['ID']; |
  | 412 | 417 | break; |
  | 413 | 418 | case 'deco\_id': |
  | 414 | 419 | $column = 'deco\_id'; |
  | 415 |  | $this->searchSql = ~~$column~~ . ' LIKE '."'%" . esc\_sql($this->arr\_search['word']['deco\_id']) . "%'"; |
  |  | 420 | $this->searchSql = esc\_sql($column) . ' LIKE '."'%" . esc\_sql($this->arr\_search['word']['deco\_id']) . "%'"; |
  | 416 | 421 | break; |
  | 417 | 422 | case 'date': |
  | 418 | 423 | $column = 'date'; |
  | 419 |  | $this->searchSql = ~~$column~~ . ' LIKE '."'%" . esc\_sql($this->arr\_search['word']['date']) . "%'"; |
  |  | 424 | $this->searchSql = esc\_sql($column) . ' LIKE '."'%" . esc\_sql($this->arr\_search['word']['date']) . "%'"; |
  | 420 | 425 | break; |
  | 421 | 426 | case 'mem\_id': |
  | 422 | 427 | $column = 'mem\_id'; |
  | 423 |  | $this->searchSql = ~~$column~~ . ' = ' . (int)$this->arr\_search['word']['mem\_id']; |
  |  | 428 | $this->searchSql = esc\_sql($column) . ' = ' . (int)$this->arr\_search['word']['mem\_id']; |
  | 424 | 429 | break; |
  | 425 | 430 | case 'name': |
  | 426 | 431 | $column = 'name'; |
  | 427 |  | $this->searchSql = ~~$column~~ . ' LIKE '."'%" . esc\_sql($this->arr\_search['word']['name']) . "%'"; |
  |  | 432 | $this->searchSql = esc\_sql($column) . ' LIKE '."'%" . esc\_sql($this->arr\_search['word']['name']) . "%'"; |
  | 428 | 433 | break; |
  | 429 | 434 | case 'order\_modified': |
  | 430 | 435 | $column = 'order\_modified'; |
  | 431 |  | $this->searchSql = ~~$column~~ . ' LIKE '."'%" . esc\_sql($this->arr\_search['word']['order\_modified']) . "%'"; |
  |  | 436 | $this->searchSql = esc\_sql($column) . ' LIKE '."'%" . esc\_sql($this->arr\_search['word']['order\_modified']) . "%'"; |
  | 432 | 437 | break; |
  | 433 | 438 | case 'pref': |
  | 434 | 439 | $column = 'pref'; |
  | 435 |  | $this->searchSql = ~~$column~~ . " = '" . esc\_sql($this->arr\_search['word']['pref']) . "'"; |
  |  | 440 | $this->searchSql = esc\_sql($column) . " = '" . esc\_sql($this->arr\_search['word']['pref']) . "'"; |
  | 436 | 441 | break; |
  | 437 | 442 | case 'delivery\_method': |
  | 438 | 443 | $column = 'delivery\_method'; |
  | 439 |  | $this->searchSql = ~~$column~~ . " = '" . esc\_sql($this->arr\_search['word']['delivery\_method']) . "'"; |
  |  | 444 | $this->searchSql = esc\_sql($column) . " = '" . esc\_sql($this->arr\_search['word']['delivery\_method']) . "'"; |
  | 440 | 445 | break; |
  | 441 | 446 | case 'payment\_name': |
  | 442 | 447 | $column = 'payment\_name'; |
  | 443 |  | $this->searchSql = ~~$column~~ . " = '" . esc\_sql($this->arr\_search['word']['payment\_name']) . "'"; |
  |  | 448 | $this->searchSql = esc\_sql($column) . " = '" . esc\_sql($this->arr\_search['word']['payment\_name']) . "'"; |
  | 444 | 449 | break; |
  | 445 | 450 | case 'receipt\_status': |
  | 446 | 451 | $column = 'receipt\_status'; |
  | 447 |  | $this->searchSql = ~~$column~~ . " = '" . esc\_sql($this->arr\_search['word']['receipt\_status']) . "'"; |
  |  | 452 | $this->searchSql = esc\_sql($column) . " = '" . esc\_sql($this->arr\_search['word']['receipt\_status']) . "'"; |
  | 448 | 453 | break; |
  | 449 | 454 | case 'order\_status': |
  | 450 | 455 | $column = 'order\_status'; |
  | 451 |  | $this->searchSql = ~~$column~~ . " = '" . esc\_sql($this->arr\_search['word']['order\_status']) . "'"; |
  |  | 456 | $this->searchSql = esc\_sql($column) . " = '" . esc\_sql($this->arr\_search['word']['order\_status']) . "'"; |
  | 452 | 457 | break; |
  | 453 | 458 | } |
  | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1155963#L455) | […](/browser/usc-e-shop/trunk/classes/orderList.class.php?rev=1199120#L460) |  |
  | 455 | 460 | case 'item\_code': |
  | 456 | 461 | $column = 'item\_code'; |
  | 457 |  | $this->searchSkuSql = ~~$column~~ . ' LIKE '."'%" . esc\_sql($this->arr\_search['skuword']['item\_code']) . "%'"; |
  |  | 462 | $this->searchSkuSql = esc\_sql($column) . ' LIKE '."'%" . esc\_sql($this->arr\_search['skuword']['item\_code']) . "%'"; |
  | 458 | 463 | break; |
  | 459 | 464 | case 'item\_name': |
  | 460 | 465 | $column = 'item\_name'; |
  | 461 |  | $this->searchSkuSql = ~~$column~~ . ' LIKE '."'%" . esc\_sql($this->arr\_search['skuword']['item\_name']) . "%'"; |
  |  | 466 | $this->searchSkuSql = esc\_sql($column) . ' LIKE '."'%" . esc\_sql($this->arr\_search['skuword']['item\_name']) . "%'"; |
  | 462 | 467 | break; |
  | 463 | 468 | } |
* ## [usc-e-shop/trunk/classes/usceshop.class.php](/changeset/1199120/usc-e-shop/trunk/classes/usceshop.class.php "Show the changeset 1199120 restricted to usc-e-shop/trunk/classes/usceshop.class.php")

  | [r1199108](/browser/usc-e-shop/trunk/classes/usceshop.class.php?rev=1199108#L576 "Show revision 1199108 of this file in browser") | [r1199120](/browser/usc-e-shop/trunk/classes/usceshop.class.php?rev=1199120#L576 "Show revision 1199120 of this file in browser") |  |
  | --- | --- | --- |
  | 576 | 576 | $res = usces\_update\_orderdata(); |
  | 577 | 577 | if ( 1 === $res ) { |
  | 578 |  | $this->set\_action\_status('success', \_\_('order date is updated','usces').' <a href="'.~~stripslashes( $\_POST['usces\_referer']~~ ).'">'.\_\_('back to the summary','usces').'</a>'); |
  |  | 578 | $this->set\_action\_status('success', \_\_('order date is updated','usces').' <a href="'.esc\_url(stripslashes( $\_POST['usces\_referer'] )).'">'.\_\_('back to the summary','usces').'</a>'); |
  | 579 | 579 | } elseif ( 0 === $res ) { |
  | 580 | 580 | $this->set\_action\_status('none', ''); |
  | […](/browser/usc-e-shop/trunk/classes/usceshop.class.php?rev=1199108#L2728) | […](/browser/usc-e-shop/trunk/classes/usceshop.class.php?rev=1199120#L2728) |  |
  | 2728 | 2728 | $post\_id = (int)$\_GET['post']; |
  | 2729 | 2729 | $new\_id = usces\_item\_dupricate($post\_id); |
  | 2730 |  | $ref = isset($\_REQUEST['usces\_referer']) ? urlencode(~~$\_REQUEST['usces\_referer']~~) : ''; |
  |  | 2730 | $ref = isset($\_REQUEST['usces\_referer']) ? urlencode(esc\_url($\_REQUEST['usces\_referer'])) : ''; |
  | 2731 | 2731 | $url = USCES\_ADMIN\_URL . '?page=usces\_itemedit&action=edit&post=' . $new\_id . '&usces\_referer=' . $ref; |
  | 2732 | 2732 | wp\_redirect($url); |
  | […](/browser/usc-e-shop/trunk/classes/usceshop.class.php?rev=1199108#L4757) | […](/browser/usc-e-shop/trunk/classes/usceshop.class.php?rev=1199120#L4757) |  |
  | 4757 | 4757 | if( false === strpos($\_POST['usces\_referer'], 'http') ){ |
  | 4758 | 4758 | $parse\_url = parse\_url(get\_home\_url()); |
  | 4759 |  | header('location: ' . $parse\_url['scheme'] . '://' . $parse\_url['host'] . ~~$\_POST['usces\_referer']~~ . '#cart\_button'); |
  |  | 4759 | header('location: ' . $parse\_url['scheme'] . '://' . $parse\_url['host'] . esc\_url($\_POST['usces\_referer']) . '#cart\_button'); |
  | 4760 | 4760 | }else{ |
  | 4761 |  | header('location: ' . ~~$\_POST['usces\_referer']~~ . '#cart\_button'); |
  |  | 4761 | header('location: ' . esc\_url($\_POST['usces\_referer']) . '#cart\_button'); |
  | 4762 | 4762 | } |
  | 4763 | 4763 | exit; |
* ## [usc-e-shop/trunk/includes/edit-form-advanced.php](/changeset/1199120/usc-e-shop/trunk/includes/edit-form-advanced.php "Show the changeset 1199120 restricted to usc-e-shop/trunk/includes/edit-form-advanced.php")

  | [r1080215](/browser/usc-e-shop/trunk/includes/edit-form-advanced.php?rev=1080215#L662 "Show revision 1080215 of this file in browser") | [r1199120](/browser/usc-e-shop/trunk/includes/edit-form-advanced.php?rev=1199120#L662 "Show revision 1199120 of this file in browser") |  |
  | --- | --- | --- |
  | 662 | 662 | <input type="hidden" id="original\_post\_status" name="original\_post\_status" value="<?php echo $post->post\_status; ?>" /> |
  | 663 | 663 | <input name="referredby" type="hidden" id="referredby" value="<?php echo clean\_url(stripslashes(wp\_get\_referer())); ?>" /> |
  | 664 |  | <input name="usces\_referer" type="hidden" id="usces\_referer" value="<?php if(isset($\_REQUEST['usces\_referer'])) echo ~~$\_REQUEST['usces\_referer']~~; ?>" /> |
  |  | 664 | <input name="usces\_referer" type="hidden" id="usces\_referer" value="<?php if(isset($\_REQUEST['usces\_referer'])) echo esc\_url($\_REQUEST['usces\_referer']); ?>" /> |
  | 665 | 665 | <?php if ( 'draft' != $post->post\_status ) wp\_original\_referer\_field(true, 'previous'); ?> |
  | 666 | 666 |  |
  | 667 | 667 | <?php echo $form\_extra ?> |
  | 668 |  | <div id="refbutton"><a href="<?php echo USCES\_ADMIN\_URL . '?page=usces\_itemedit&amp;action=duplicate&amp;post='.$post->ID.'&usces\_referer='.urlencode(~~$\_REQUEST['usces\_referer']); ?>">[<?php \_e('make a copy', 'usces'); ?>]</a> <a href="<?php if(isset($\_REQUEST['usces\_referer'])) echo $\_REQUEST['usces\_referer']~~; ?>">[<?php \_e('back to item list', 'usces'); ?>]</a></div> |
  |  | 668 | <div id="refbutton"><a href="<?php echo USCES\_ADMIN\_URL . '?page=usces\_itemedit&amp;action=duplicate&amp;post='.$post->ID.'&usces\_referer='.urlencode(esc\_url($\_REQUEST['usces\_referer'])); ?>">[<?php \_e('make a copy', 'usces'); ?>]</a> <a href="<?php if(isset($\_REQUEST['usces\_referer'])) echo esc\_url($\_REQUEST['usces\_referer']); ?>">[<?php \_e('back to item list', 'usces'); ?>]</a></div> |
  | 669 | 669 | <div id="poststuff" class="metabox-holder has-right-sidebar"> |
  | 670 | 670 |  |
* ## [usc-e-shop/trunk/includes/edit-form-advanced30.php](/changeset/1199120/usc-e-shop/trunk/includes/edit-form-advanced30.php "Show the changeset 1199120 restricted to usc-e-shop/trunk/includes/edit-form-advanced30.php")

  | [r866657](/browser/usc-e-shop/trunk/includes/edit-form-advanced30.php?rev=866657#L311 "Show revision 866657 of this file in browser") | [r1199120](/browser/usc-e-shop/trunk/includes/edit-form-advanced30.php?rev=1199120#L311 "Show revision 1199120 of this file in browser") |  |
  | --- | --- | --- |
  | 311 | 311 | <input type="hidden" name="post\_mime\_type" value="item" /> |
  | 312 | 312 | <input type="hidden" name="page" value="usces\_itemedit" /> |
  | 313 |  | <input name="usces\_referer" type="hidden" id="usces\_referer" value="<?php if(isset($\_REQUEST['usces\_referer'])) echo ~~$\_REQUEST['usces\_referer']~~; ?>" /> |
  |  | 313 | <input name="usces\_referer" type="hidden" id="usces\_referer" value="<?php if(isset($\_REQUEST['usces\_referer'])) echo esc\_url($\_REQUEST['usces\_referer']); ?>" /> |
  | 314 | 314 |  |
  | 315 | 315 | <?php |
  | […](/browser/usc-e-shop/trunk/includes/edit-form-advanced30.php?rev=866657#L324) | […](/browser/usc-e-shop/trunk/includes/edit-form-advanced30.php?rev=1199120#L324) |  |
  | 324 | 324 | ?> |
  | 325 | 325 |  |
  | 326 |  | <div id="refbutton"><a href="<?php echo USCES\_ADMIN\_URL . '?page=usces\_itemedit&amp;action=duplicate&amp;post='.$post->ID.'&usces\_referer='.(isset($\_REQUEST['usces\_referer']) ? urlencode(~~$\_REQUEST['usces\_referer']) : ''); ?>">[<?php \_e('make a copy', 'usces'); ?>]</a> <a href="<?php if(isset($\_REQUEST['usces\_referer'])) echo $\_REQUEST['usces\_referer']~~; ?>">[<?php \_e('back to item list', 'usces'); ?>]</a></div> |
  |  | 326 | <div id="refbutton"><a href="<?php echo USCES\_ADMIN\_URL . '?page=usces\_itemedit&amp;action=duplicate&amp;post='.$post->ID.'&usces\_referer='.(isset($\_REQUEST['usces\_referer']) ? urlencode(esc\_url($\_REQUEST['usces\_referer'])) : ''); ?>">[<?php \_e('make a copy', 'usces'); ?>]</a> <a href="<?php if(isset($\_REQUEST['usces\_referer'])) echo esc\_url($\_REQUEST['usces\_referer']); ?>">[<?php \_e('back to item list', 'usces'); ?>]</a></div> |
  | 327 | 327 | <div id="poststuff" class="metabox-holder has-right-sidebar"> |
  | 328 | 328 | <div id="side-info-column" class="inner-sidebar"> |
* ## [usc-e-shop/trunk/includes/edit-form-advanced34.php](/changeset/1199120/usc-e-shop/trunk/includes/edit-form-advanced34.php "Show the changeset 1199120 restricted to usc-e-shop/trunk/includes/edit-form-advanced34.php")

  | [r866657](/browser/usc-e-shop/trunk/includes/edit-form-advanced34.php?rev=866657#L257 "Show revision 866657 of this file in browser") | [r1199120](/browser/usc-e-shop/trunk/includes/edit-form-advanced34.php?rev=1199120#L257 "Show revision 1199120 of this file in browser") |  |
  | --- | --- | --- |
  | 257 | 257 | <input type="hidden" name="post\_mime\_type" value="item" /> |
  | 258 | 258 | <input type="hidden" name="page" value="usces\_itemedit" /> |
  | 259 |  | <input name="usces\_referer" type="hidden" id="usces\_referer" value="<?php if(isset($\_REQUEST['usces\_referer'])) echo ~~$\_REQUEST['usces\_referer']~~; ?>" /> |
  |  | 259 | <input name="usces\_referer" type="hidden" id="usces\_referer" value="<?php if(isset($\_REQUEST['usces\_referer'])) echo esc\_url($\_REQUEST['usces\_referer']); ?>" /> |
  | 260 | 260 |  |
  | 261 | 261 | <?php |
  | […](/browser/usc-e-shop/trunk/includes/edit-form-advanced34.php?rev=866657#L270) | […](/browser/usc-e-shop/trunk/includes/edit-form-advanced34.php?rev=1199120#L270) |  |
  | 270 | 270 | ?> |
  | 271 | 271 |  |
  | 272 |  | <div id="refbutton"><a href="<?php echo USCES\_ADMIN\_URL . '?page=usces\_itemedit&amp;action=duplicate&amp;post='.$post->ID.'&usces\_referer='.(isset($\_REQUEST['usces\_referer']) ? urlencode(~~$\_REQUEST['usces\_referer']) : ''); ?>">[<?php \_e('make a copy', 'usces'); ?>]</a> <a href="<?php if(isset($\_REQUEST['usces\_referer'])) echo $\_REQUEST['usces\_referer']~~; ?>">[<?php \_e('back to item list', 'usces'); ?>]</a></div> |
  |  | 272 | <div id="refbutton"><a href="<?php echo USCES\_ADMIN\_URL . '?page=usces\_itemedit&amp;action=duplicate&amp;post='.$post->ID.'&usces\_referer='.(isset($\_REQUEST['usces\_referer']) ? urlencode(esc\_url($\_REQUEST['usces\_referer'])) : ''); ?>">[<?php \_e('make a copy', 'usces'); ?>]</a> <a href="<?php if(isset($\_REQUEST['usces\_referer'])) echo esc\_url($\_REQUEST['usces\_referer']); ?>">[<?php \_e('back to item list', 'usces'); ?>]</a></div> |
  | 273 | 273 | <!--<div id="poststuff" class="metabox-holder has-right-sidebar">--> |
  | 274 | 274 | <div id="poststuff"> |
* ## [usc-e-shop/trunk/includes/member\_edit\_form.php](/changeset/1199120/usc-e-shop/trunk/includes/member_edit_form.php "Show the changeset 1199120 restricted to usc-e-shop/trunk/includes/member_edit_form.php")

  | [r1032350](/browser/usc-e-shop/trunk/includes/member_edit_form.php?rev=1032350#L274 "Show revision 1032350 of this file in browser") | [r1199120](/browser/usc-e-shop/trunk/includes/member_edit_form.php?rev=1199120#L274 "Show revision 1199120 of this file in browser") |  |
  | --- | --- | --- |
  | 274 | 274 | <tr> |
  | 275 | 275 | <td><?php echo $umhs['date']; ?></td> |
  | 276 |  | <td><a href="<?php echo USCES\_ADMIN\_URL; ?>?page=usces\_orderlist&order\_action=edit&order\_id=<?php echo $order\_id; ?>&usces\_referer=<?php echo ~~$curent\_url~~; ?>"><?php echo usces\_get\_deco\_order\_id( $order\_id ); ?></a></td> |
  |  | 276 | <td><a href="<?php echo USCES\_ADMIN\_URL; ?>?page=usces\_orderlist&order\_action=edit&order\_id=<?php echo $order\_id; ?>&usces\_referer=<?php echo esc\_url($curent\_url); ?>"><?php echo usces\_get\_deco\_order\_id( $order\_id ); ?></a></td> |
  | 277 | 277 | <td class="rightnum"><?php usces\_crform( $this->get\_total\_price($cart)-$umhs['usedpoint']+$umhs['discount']+$umhs['shipping\_charge']+$umhs['cod\_fee']+$umhs['tax'], true, false ); ?></td> |
  | 278 | 278 | <td class="rightnum"><?php echo number\_format($umhs['usedpoint']); ?></td> |
* ## [usc-e-shop/trunk/includes/order\_edit\_form.php](/changeset/1199120/usc-e-shop/trunk/includes/order_edit_form.php "Show the changeset 1199120 restricted to usc-e-shop/trunk/includes/order_edit_form.php")

  | [r1120284](/browser/usc-e-shop/trunk/includes/order_edit_form.php?rev=1120284#L877 "Show revision 1120284 of this file in browser") | [r1199120](/browser/usc-e-shop/trunk/includes/order_edit_form.php?rev=1199120#L877 "Show revision 1199120 of this file in browser") |  |
  | --- | --- | --- |
  | 877 | 877 | </div> |
  | 878 | 878 | <div class="mailVisiLink"> |
  | 879 |  | <a style="cursor:pointer;" id="mailVisiLink" onclick="toggleVisibility('mailBox');"><?php \_e('show the mail/print field', 'usces'); ?></a><br /><a href="<?php if(isset($\_REQUEST['usces\_referer'])) echo ~~$\_REQUEST['usces\_referer']~~; ?>"><?php \_e('Back', 'usces'); ?></a> |
  |  | 879 | <a style="cursor:pointer;" id="mailVisiLink" onclick="toggleVisibility('mailBox');"><?php \_e('show the mail/print field', 'usces'); ?></a><br /><a href="<?php if(isset($\_REQUEST['usces\_referer'])) echo esc\_url($\_REQUEST['usces\_referer']); ?>"><?php \_e('Back', 'usces'); ?></a> |
  | 880 | 880 | </div> |
  | 881 | 881 | <div class="ordernavi"><input name="upButton" class="upButton" type="submit" value="<?php \_e('change decision', 'usces'); ?>" /><?php \_e("When you change amount, please click 'Edit' before you finish your process.", 'usces'); ?></div> |
  | […](/browser/usc-e-shop/trunk/includes/order_edit_form.php?rev=1120284#L1236) | […](/browser/usc-e-shop/trunk/includes/order_edit_form.php?rev=1199120#L1236) |  |
  | 1236 | 1236 | </fieldset> |
  | 1237 | 1237 | </div> |
  | 1238 |  | <input name="usces\_referer" type="hidden" id="usces\_referer" value="<?php if(isset($\_REQUEST['usces\_referer'])) echo ~~$\_REQUEST['usces\_referer']~~; ?>" /> |
  |  | 1238 | <input name="usces\_referer" type="hidden" id="usces\_referer" value="<?php if(isset($\_REQUEST['usces\_referer'])) echo esc\_url($\_REQUEST['usces\_referer']); ?>" /> |
  | 1239 | 1239 | <?php wp\_nonce\_field( 'order\_edit', 'wc\_nonce' ); ?> |
  | 1240 | 1240 | </form> |
* ## [usc-e-shop/trunk/includes/order\_list.php](/changeset/1199120/usc-e-shop/trunk/includes/order_list.php "Show the changeset 1199120 restricted to usc-e-shop/trunk/includes/order_list.php")

  | [r1176613](/browser/usc-e-shop/trunk/includes/order_list.php?rev=1176613#L664 "Show revision 1176613 of this file in browser") | [r1199120](/browser/usc-e-shop/trunk/includes/order_list.php?rev=1199120#L664 "Show revision 1199120 of this file in browser") |  |
  | --- | --- | --- |
  | 664 | 664 | if( WCUtils::is\_blank($value) ) $value = '&nbsp;'; |
  | 665 | 665 | if( $key === 'ID' || $key === 'deco\_id' ) { |
  | 666 |  | $list\_detail .= '<td><a href="'.USCES\_ADMIN\_URL.'?page=usces\_orderlist&order\_action=edit&order\_id='.$array['ID'].'&usces\_referer='.~~$curent\_url~~.'&wc\_nonce='.wp\_create\_nonce( 'order\_list' ).'">'.esc\_html($value).'</a></td>'; |
  |  | 666 | $list\_detail .= '<td><a href="'.USCES\_ADMIN\_URL.'?page=usces\_orderlist&order\_action=edit&order\_id='.$array['ID'].'&usces\_referer='.esc\_url($curent\_url).'&wc\_nonce='.wp\_create\_nonce( 'order\_list' ).'">'.esc\_html($value).'</a></td>'; |
  | 667 | 667 | } elseif( $key === 'date' ) { |
  | 668 | 668 | $list\_detail .= '<td>'.esc\_html($value).'</td>'; |
* ## [usc-e-shop/trunk/includes/purchase\_button.php](/changeset/1199120/usc-e-shop/trunk/includes/purchase_button.php "Show the changeset 1199120 restricted to usc-e-shop/trunk/includes/purchase_button.php")

  | [r1186055](/browser/usc-e-shop/trunk/includes/purchase_button.php?rev=1186055#L368 "Show revision 1186055 of this file in browser") | [r1199120](/browser/usc-e-shop/trunk/includes/purchase_button.php?rev=1199120#L368 "Show revision 1199120 of this file in browser") |  |
  | --- | --- | --- |
  | 368 | 368 | $sf = ( !empty($usces\_entries['order']['shipping\_charge']) ) ? $usces\_entries['order']['shipping\_charge'] : 0; |
  | 369 | 369 | $am = $usces\_entries['order']['total\_full\_price'] - $tx - $sf; |
  | 370 |  | $~~html .~~= '<form id="purchase\_form" name="purchase\_form" action="'.$acting\_opts['send\_url'].'" method="post" onKeyDown="if(event.keyCode == 13) {return false;}" > |
  |  | 370 | $purchase\_html = '<form id="purchase\_form" name="purchase\_form" action="'.$acting\_opts['send\_url'].'" method="post" onKeyDown="if(event.keyCode == 13) {return false;}" > |
  | 371 | 371 | <input type="hidden" name="aid" value="'.$acting\_opts['aid'].'" /> |
  | 372 | 372 | <input type="hidden" name="cod" value="'.$rand.'" /> |
  | […](/browser/usc-e-shop/trunk/includes/purchase_button.php?rev=1186055#L384) | […](/browser/usc-e-shop/trunk/includes/purchase_button.php?rev=1199120#L384) |  |
  | 384 | 384 | <input type="hidden" name="uscesid" value="' . $usces->get\_uscesid(false) . '"> |
  | 385 | 385 | '; |
  | 386 |  | $html .= '<div class="send"><input name="purchase\_jpayment" type="submit" id="purchase\_button" class="checkout\_button" value="'.\_\_('Checkout', 'usces').'"'.apply\_filters('usces\_filter\_confirm\_nextbutton', NULL).$purchase\_disabled.' /></div>'; |
  | 387 |  | $html ~~= apply\_filters('usces\_filter\_confirm\_inform', $~~html, $payments, $acting\_flag, $rand, $purchase\_disabled); |
  | 388 |  | $html .= '</form>'; |
  | 389 |  | $~~html .~~= '<form action="'.USCES\_CART\_URL.'" method="post" onKeyDown="if(event.keyCode == 13) {return false;}"> |
  | 390 |  | <div class="send"><input name="backDelivery" type="submit" id="back\_button" class="back\_to\_delivery\_button" value="'.\_\_('Back', 'usces').'"'.apply\_filters('usces\_filter\_confirm\_prebutton', NULL).' /></div>'; |
  | 391 |  | $html ~~= apply\_filters('usces\_filter\_confirm\_inform\_back', $~~html); |
  |  | 386 | $purchase\_html .= '<div class="send"><input name="purchase\_jpayment" type="submit" id="purchase\_button" class="checkout\_button" value="'.\_\_('Checkout', 'usces').'"'.apply\_filters('usces\_filter\_confirm\_nextbutton', NULL).$purchase\_disabled.' /></div>'; |
  |  | 387 | $html .= apply\_filters('usces\_filter\_confirm\_inform', $purchase\_html, $payments, $acting\_flag, $rand, $purchase\_disabled); |
  |  | 388 | $html .= '</form>'; |
  |  | 389 | $purchase\_html = '<form action="'.USCES\_CART\_URL.'" method="post" onKeyDown="if(event.keyCode == 13) {return false;}"> |
  |  | 390 | <div class="send"><input name="backDelivery" type="submit" id="back\_button" class="back\_to\_delivery\_button" value="'.\_\_('Back', 'usces').'"'.apply\_filters('usces\_filter\_confirm\_prebutton', NULL).' /></div>'; |
  |  | 391 | $html .= apply\_filters('usces\_filter\_confirm\_inform\_back', $purchase\_html); |
  | 392 | 392 | $html .= '</form>'."\n"; |
  | 393 | 393 | break; |
* ## [usc-e-shop/trunk/includes/usces\_item\_master\_list.php](/changeset/1199120/usc-e-shop/trunk/includes/usces_item_master_list.php "Show the changeset 1199120 restricted to usc-e-shop/trunk/includes/usces_item_master_list.php")

  | [r1080215](/browser/usc-e-shop/trunk/includes/usces_item_master_list.php?rev=1080215#L405 "Show revision 1080215 of this file in browser") | [r1199120](/browser/usc-e-shop/trunk/includes/usces_item_master_list.php?rev=1199120#L405 "Show revision 1199120 of this file in browser") |  |
  | --- | --- | --- |
  | 405 | 405 | <tr> |
  | 406 | 406 | <td width="20px" align="center"><input name="listcheck[]" type="checkbox" value="<?php echo (int)$array['ID']; ?>" /></td> |
  | 407 |  | <td width="50px"><a href="<?php echo USCES\_ADMIN\_URL.'?page=usces\_itemedit&action=edit&post='.$array['ID'].'&usces\_referer='.~~$curent\_url~~; ?>" title="<?php echo esc\_attr($array['item\_name']); ?>"><?php echo wp\_get\_attachment\_image( $pctid, array(50, 50), true ); ?></a></td> |
  |  | 407 | <td width="50px"><a href="<?php echo USCES\_ADMIN\_URL.'?page=usces\_itemedit&action=edit&post='.$array['ID'].'&usces\_referer='.esc\_url($curent\_url); ?>" title="<?php echo esc\_attr($array['item\_name']); ?>"><?php echo wp\_get\_attachment\_image( $pctid, array(50, 50), true ); ?></a></td> |
  | 408 | 408 | <?php foreach ( (array)$array as $key => $value ) : ?> |
  | 409 | 409 | <?php if( $key == 'item\_code') : ?> |
  | […](/browser/usc-e-shop/trunk/includes/usces_item_master_list.php?rev=1080215#L423) | […](/browser/usc-e-shop/trunk/includes/usces_item_master_list.php?rev=1199120#L423) |  |
  | 423 | 423 | <?php endif; ?> |
  | 424 | 424 | <ul class="item\_list\_navi"> |
  | 425 |  | <li><a href="<?php echo USCES\_ADMIN\_URL.'?page=usces\_itemedit&action=edit&post='.$array['ID'].'&usces\_referer='.~~$curent\_url~~; ?>"><?php \_e('edit', 'usces'); ?></a></li> |
  |  | 425 | <li><a href="<?php echo USCES\_ADMIN\_URL.'?page=usces\_itemedit&action=edit&post='.$array['ID'].'&usces\_referer='.esc\_url($curent\_url); ?>"><?php \_e('edit', 'usces'); ?></a></li> |
  | 426 | 426 | <li>&nbsp;|&nbsp;</li> |
  | 427 | 427 | <!--<li><a href="<?php echo wp\_nonce\_url("post.php?action=delete&amp;post=".$array['ID'], 'delete-post\_' . $array['ID']); ?>" onclick="return deleteconfirm('<?php echo esc\_attr($array['item\_code']); ?>');"><?php \_e('Delete', 'usces'); ?></a></li>--> |
  | […](/browser/usc-e-shop/trunk/includes/usces_item_master_list.php?rev=1080215#L451) | […](/browser/usc-e-shop/trunk/includes/usces_item_master_list.php?rev=1199120#L451) |  |
  | 451 | 451 | <?php endif; ?> |
  | 452 | 452 | <ul class="item\_list\_navi"> |
  | 453 |  | <li><a href="<?php echo USCES\_ADMIN\_URL.'?page=usces\_itemedit&action=edit&post='.$array['ID'].'&usces\_referer='.~~$curent\_url~~; ?>"><?php \_e('edit', 'usces'); ?></a></li> |
  |  | 453 | <li><a href="<?php echo USCES\_ADMIN\_URL.'?page=usces\_itemedit&action=edit&post='.$array['ID'].'&usces\_referer='.esc\_url($curent\_url); ?>"><?php \_e('edit', 'usces'); ?></a></li> |
  | 454 | 454 | <li>&nbsp;|&nbsp;</li> |
  | 455 | 455 | <li><a href="<?php echo wp\_nonce\_url("post.php?action=delete&amp;post=".$array['ID'], 'delete-post\_' . $array['ID']); ?>" onclick="return deleteconfirm('<?php echo esc\_attr($array['item\_code']); ?>');"><?php \_e('Delete', 'usces'); ?></a></li> |
* ## [usc-e-shop/trunk/usc-e-shop.php](/changeset/1199120/usc-e-shop/trunk/usc-e-shop.php "Show the changeset 1199120 restricted to usc-e-shop/trunk/usc-e-shop.php")

  | [r1199108](/browser/usc-e-shop/trunk/usc-e-shop.php?rev=1199108#L8 "Show revision 1199108 of this file in browser") | [r1199120](/browser/usc-e-shop/trunk/usc-e-shop.php?rev=1199120#L8 "Show revision 1199120 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | Author URI: http://www.collne.com/ |
  | 9 | 9 | \*/ |
  | 10 |  | define('USCES\_VERSION', '1.4.17.150715~~1~~'); |
  |  | 10 | define('USCES\_VERSION', '1.4.17.1507152'); |
  | 11 | 11 | define('USCES\_DB\_ACCESS', '1.5'); |
  | 12 | 12 | define('USCES\_DB\_MEMBER', '1.1'); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=1199120)
* [Zip Archive](?format=zip&new=1199120)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from jvndb.jvn.jp_8c0d1417_20250125_022930.html ===


![JVN iPedia](/en/common/img/en_logo.gif)
Last Updated:2015/07/28

| [[Japanese]](/ja/contents/2015/JVNDB-2015-000103.html) | |
| --- | --- |
| JVNDB-2015-000103 | |
| Welcart vulnerable to cross-site scripting | |
| Overview | |
| Welcart provided by Collne Inc. is a WordPress plugin for creating shopping websites. Welcart contains a cross-site scripting (CWE-79) vulnerability due to the processing of usces\_referer parameter in admin.php. | |
| CVSS Severity ([What is CVSS?](/en/nav/jvndbhelp.html#jvndb3)) | |
| **CVSS V2 Severity:Base Metrics [2.6](/cvss/en/v2.html#AV:N/AC:H/Au:N/C:N/I:P/A:N) (Low) [IPA Score]**  * Access Vector: Network * Access Complexity: High * Authentication: None * Confidentiality Impact: None * Integrity Impact: Partial * Availability Impact: None | |
| Affected Products | |
|  | |
| Collne Inc.  * Welcart 1.4.17 and earlier | |
|  | |
| Impact | |
| If a user views a malicious page while logged into WordPress with this plugin enabled, an arbitrary script may be executed on the user's web browser. | |
| Solution | |
| [Apply an Update] | |
| Vendor Information | |
| Collne Inc.  * Collne Inc. : [Changes in usc-e-shop [1199108:1199120]](https://goo.gl/5iLFBV) * Collne Inc. : [Changeset 1199120](https://plugins.trac.wordpress.org/changeset/1199120) * Welcart : [Community Top](http://www.welcart.com/community/) (in Japanese) | |
| CWE ([What is CWE?](http://www.ipa.go.jp/security/english/vuln/CWE_en.html)) | |
| 1. [Cross-site Scripting](http://www.ipa.go.jp/security/english/vuln/CWE_en.html#CWE79)(CWE-79) [IPA Evaluation] | |
| CVE ([What is CVE?](http://www.ipa.go.jp/security/english/vuln/CVE_en.html)) | |
| 1. [CVE-2015-2973](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2973) | |
| References | |
| 1. JVN : [JVN#97971874](http://jvn.jp/en/jp/JVN97971874/index.html) 2. National Vulnerability Database (NVD) : [CVE-2015-2973](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-2973) | |
| Revision History | |
| * [2015/07/24] | |

| --- | |
| --- | --- |
| Date Public | 2015/07/24 |
| Date First Published | 2015/07/24 |
| Date Last Updated | 2015/07/28 |
| --- | |

* JVN
* [HOME](http://jvn.jp/en/)
* [What is JVN ?](http://jvn.jp/en/nav/jvn.html)
* [Instructions](http://jvn.jp/en/nav/jvnhelp.html)
* [List of Vulnerability Report](http://jvn.jp/en/report/index.html)
* [VN\_JP](http://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](http://jvn.jp/en/adj/index.html)
* [VN\_VU](http://jvn.jp/en/vu/index.html)
* [TA](http://jvn.jp/en/ta/index.html)
* [TRnotes](http://jvn.jp/en/tr/index.html)
* [JVN iPedia](/en/)
* [Search](/search/index.php?mode=_vulnerability_search_IA_VulnSearch&lang=en)
* [What is JVN iPedia?](/en/nav/jvndb.html)
* [How to Use?](/en/nav/jvndbhelp.html)
* [MyJVN](/en/apis/myjvn/index.html)
* [JVNJS/RSS](http://jvn.jp/en/rss/index.html)
* [Vendor List](http://jvn.jp/en/nav/index.html)
* [List of unreachable developers](http://jvn.jp/en/reply/index.html)
* [Contact](http://jvn.jp/en/contact/index.html)

![Copyright © 2007- IPA. All rights reserved.](/common/img/copyright.png)



=== Content from jvn.jp_f61f248a_20250125_022928.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2015/07/24  Last Updated:2015/07/24
# JVN#97971874 Welcart vulnerable to cross-site scripting

## Overview

Welcart contains a cross-site scripting vulnerability.

## Products Affected

* Welcart 1.4.17 and earlier

## Description

Welcart provided by Collne Inc. is a WordPress plugin for creating shopping websites. Welcart contains a cross-site scripting ([CWE-79](https://cwe.mitre.org/data/definitions/79.html)) vulnerability due to the processing of usces\_referer parameter in admin.php.

## Impact

If a user views a malicious page while logged into WordPress with this plugin enabled, an arbitrary script may be executed on the user's web browser.

## Solution

**Apply an Update**

Apply the update according to the information provided by the developer.

## Vendor Status

| Vendor | Link |
| --- | --- |
| Collne Inc. | [Community Top](http://www.welcart.com/community/) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

**Analyzed on 2015.07.24 (CVSS Base Metrics)**

[What is CVSS?](/en/nav/jvnhelp.html#cvssv2)

| Measures | Severity | | | Description |
| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) | A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access. Such a vulnerability is often termed "remotely exploitable". |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) | Specialized access conditions exist. |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) | Authentication is not required to exploit the vulnerability. |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) | There is no impact to the confidentiality of the system. |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) | Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited. |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) | There is no impact to the availability of the system. |

Base Score:2.6

## Credit

Shoji Baba reported this vulnerability to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2015-2973](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2973) |
| JVN iPedia | [JVNDB-2015-000103](http://jvndb.jvn.jp/jvndb/JVNDB-2015-000103) |

* JVN
* HOME
* What is JVN ?
* Instructions
* List of Vulnerability Report
* [VN\_JP](http://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](http://jvn.jp/en/adj/index.html)
* [VN\_VU](http://jvn.jp/en/vu/index.html)
* [TA](http://jvn.jp/en/ta/index.html)
* TRnotes
* JVN iPedia
* MyJVN
* JVNJS/RSS
* Vendor List
* List of unreachable developers
* Contact

Copyright (c) 2000-2015 JPCERT/CC and IPA. All rights reserved.


