=== Content from security.gentoo.org_ee772b69_20250125_205712.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# MediaWiki: Multiple vulnerabilities — GLSA **201510-05**

Multiple vulnerabilities have been found in MediaWiki, the worst of
which may allow remote attackers to cause a Denial of Service.

### Affected packages

| Package | **www-apps/mediawiki** on all architectures |
| --- | --- |
| Affected versions | < **1.25.2** |
| Unaffected versions | >= **1.25.2**revision >= **1.24.3**revision >= **1.23.10** |

### Background

MediaWiki is a collaborative editing software used by large projects
such as Wikipedia.

### Description

Multiple vulnerabilities have been discovered in MediaWiki. Please
review the CVE identifiers referenced below for details.

### Impact

A remote attacker may be able to create a Denial of Service condition,
obtain sensitive information, bypass security restrictions, and inject
arbitrary web script or HTML.

### Workaround

There is no known workaround at this time.

### Resolution

All MediaWiki 1.25 users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-apps/mediawiki-1.25.2"

```

All MediaWiki 1.24 users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-apps/mediawiki-1.24.3"

```

All MediaWiki 1.23 users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-apps/mediawiki-1.23.10"

```
### References

* [CVE-2015-2931](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2931)
* [CVE-2015-2932](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2932)
* [CVE-2015-2933](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2933)
* [CVE-2015-2934](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2934)
* [CVE-2015-2935](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2935)
* [CVE-2015-2936](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2936)
* [CVE-2015-2937](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2937)
* [CVE-2015-2938](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2938)
* [CVE-2015-2939](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2939)
* [CVE-2015-2940](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2940)
* [CVE-2015-2941](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2941)
* [CVE-2015-2942](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-2942)
* [CVE-2015-6728](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6728)
* [CVE-2015-6729](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6729)
* [CVE-2015-6730](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6730)
* [CVE-2015-6731](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6731)
* [CVE-2015-6732](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6732)
* [CVE-2015-6733](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6733)
* [CVE-2015-6734](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6734)
* [CVE-2015-6735](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6735)
* [CVE-2015-6736](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6736)
* [CVE-2015-6737](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-6737)

**Release date**

October 31, 2015

**Latest revision**

October 31, 2015: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [545944](https://bugs.gentoo.org/show_bug.cgi?id=545944)
* [557844](https://bugs.gentoo.org/show_bug.cgi?id=557844)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mandriva.com_3c30de47_20250125_205708.html ===


* [Tuxedo.org](https://tuxedo.org/ "Go to: Tuxedo")
* Store
* Mandriva Linux
* Enterprise Solutions
* Contact Us
* Language ![](/sites/all/themes/mandriva_customer/images/arrow-grey-bottom.gif)
  + English (International)
  + Français
  + Ð ÑÑÑÐºÐ¸Ð¹

# [Mandriva](/mandriva/)

* Download
* Mandriva Linux
* Community
* Help

## One

### The Linux desktopthat's easy to try and easy to keep

Download
![Mandriva One](/sites/all/themes/mandriva_customer/images/front/packshot_Mandriva_One.png)

## Powerpack

### Mandriva Linux- and more

Download
![Mandriva Linux Powerpack](/sites/all/themes/mandriva_customer/images/front/en-49.png)

## Mandriva Flash

### The mobile and installable Linux desktopon a USB key

Buy on Store
![Mandriva Flash](/sites/all/themes/mandriva_customer/images/front/mandriva-flash2.png)

### [Community](community)

* User Forums
* Support - FAQ
* Free Software
* Become a member

### Enterprise Solutions

* Enterprise Linux Products
* Asset Management Solution
* Professional Services
* Support & Maintenance

* Go to site »

### Mandriva Partners

* Worldwide offices
* Partner Program
* Technology Partners
* OEM
* Classmate PC with Mandriva Linux

### News

* Mandriva presents the launch of its new mobile desktop: Mandriva Flash 2008 Spring
* Speaking about Mandriva Linux 2008 Spring in media
* Speaking about Mandriva Linux 2008 Spring in media
* Mandriva presents its latest distribution: Mandriva Linux 2008 Spring
* Mandriva and Novatice Technologies present Edutice, The ready to use solution dedicated to educationand multimedia spaces
* # [Top 50 Online Casinos UK in 2023](https://montycasinos.com/online-casinos/)

more

* Download
  + Mandriva Linux 2008
  + Writing an ISO image
* Mandriva Linux
  + One
  + Powerpack
  + Mandriva Flash
* Community
  + Start
  + Register
  + Stay informed
  + Participate
  + Free software
* Help
  + Getting help
  + Knowledge Base
  + Documentation
  + Forums
  + Support Requests
  + Customer Care
  + Enterprise Support
* Enterprise Solutions
  + Products
  + Support
  + Services
  + Partners
  + Go to site »

Language
English (International)
Français
Ð ÑÑÑÐºÐ¸Ð¹

* © 2007 Mandriva S.A.
* About Us
* Legal Information
* Privacy Policy
* Contact Us



=== Content from gerrit.wikimedia.org_7da17dea_20250126_115454.html ===




=== Content from www.openwall.com_473cc16a_20250125_205708.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2015/03/31/9) [[next>]](2) [[thread-next>]](../../../2015/04/07/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAKcmtDzP7GhQWdTNb2XaVD1dzfDPXzyjWRhoYaKPrZy+NALygA@mail.gmail.com>
Date: Tue, 31 Mar 2015 18:34:21 -0700
From: Chris Steipp <csteipp@...imedia.org>
To: oss-security@...ts.openwall.com
Subject: CVE request: MediaWiki 1.24.2/1.23.9/1.19.24

Hi, we patched several security issues in MediaWiki today. Could we get
CVE's assigned?

* iSEC Partners discovered a way to circumvent the SVG MIME blacklist for
embedded resources (iSEC-WMF1214-11). This allowed an attacker to embed
JavaScript in the SVG. The issue was additionally identified by Mario
Heiderich / Cure53. MIME types are now whitelisted.
<<https://phabricator.wikimedia.org/T85850>>

* MediaWiki user Bawolff pointed out that the SVG filter to prevent
injecting JavaScript using animate elements was incorrect.
<<https://phabricator.wikimedia.org/T86711>>

* MediaWiki user Bawolff reported a stored XSS vulnerability due to the way
attributes were expanded in MediaWiki's Html class, in combination with
LanguageConverter substitutions.
<<https://phabricator.wikimedia.org/T73394>>

* Internal review discovered that MediaWiki's SVG filtering could be
bypassed with entity encoding under the Zend interpreter. This could be
used to inject JavaScript. This issue was also discovered by Mario Gomes /
Beyond Security.
<<https://phabricator.wikimedia.org/T88310>>

* iSEC Partners discovered a way to bypass the style filtering for SVG
files (iSEC-WMF1214-3) to load external resource. This could violate the
anonymity of users viewing the SVG.
<<https://phabricator.wikimedia.org/T85349>>

* Internal review and iSEC Partners discovered (iSEC-WMF1214-1) that
MediaWiki versions using PBKDF2 for password hashing (the default since
1.24) are vulnerable to DoS attacks using extremely long passwords.
<<https://phabricator.wikimedia.org/T64685>>

* Internal review found that MediaWiki is vulnerable to "Quadratic Blowup"
DoS attacks, under both HHVM and Zend PHP.
<<https://phabricator.wikimedia.org/T71210>>

* iSEC Partners reported that the MediaWiki feature allowing a user to
preview another user's custom JavaScript could be abused for privilege
escalation (iSEC-WMF1214-10). This feature has been removed.
<<https://phabricator.wikimedia.org/T85855>>

* Extension:Scribunto - MediaWiki user Jackmcbarn discovered that function
names were sanitized in Lua error backtraces, which could lead to XSS.
<<https://phabricator.wikimedia.org/T85113>>

* Extension:CheckUser - iSEC Partners discovered that the CheckUser
extension did not prevent CSRF attacks on the form allowing checkusers to
look up sensitive information about other users (iSEC-WMF1214-6). Since the
use of CheckUser is logged, the CSRF could be abused to defame a trusted
user or flood the logs with noise.
<<https://phabricator.wikimedia.org/T85858>>

These next issues came up because of the difference in how HHVM handles PHP
code vs Zend. I'm not sure if CVE's are assigned for specific runtime
configurations? For MediaWiki, we say that HHVM support is experimental,
although we do run Wikipedia on it.

* iSEC Partners discovered a XSS vulnerability in the way api errors were
reflected under HHVM versions before 3.6.1 (iSEC-WMF1214-8). MediaWiki now
detects and mitigates this issue on older versions of HHVM.
<<https://phabricator.wikimedia.org/T85851>>

* iSEC Partners discovered that MediaWiki's SVG and XMP parsing running
under HHVM was susceptible to "Billion Laughs" DoS attacks
(iSEC-WMF1214-13).
<<https://phabricator.wikimedia.org/T85848>>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from phabricator.wikimedia.org_f327691e_20250126_115457.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT88310)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T88310
# xml\_parse doesn't expand internal entities sometimesClosed, Resolved[Public](/policy/explain/PHID-TASK-g37m27vu4yf5bechubmg/view/)Actions

* [Edit Task](/maniphest/task/edit/88310/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/88310/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-g37m27vu4yf5bechubmg/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-g37m27vu4yf5bechubmg/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-g37m27vu4yf5bechubmg/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-g37m27vu4yf5bechubmg/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-g37m27vu4yf5bechubmg/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-g37m27vu4yf5bechubmg/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-g37m27vu4yf5bechubmg/)
* [Protect as security issue](/wmf/escalate-task/88310/)
* [Award Token](/token/give/PHID-TASK-g37m27vu4yf5bechubmg/)
* [Flag For Later](/flag/edit/PHID-TASK-g37m27vu4yf5bechubmg/)

Assigned To

|  | [• csteipp](/p/csteipp/) |
| --- | --- |

Authored By

|  | [• csteipp](/p/csteipp/) |
| --- | --- |
| Feb 2 2015, 7:08 PM2015-02-02 19:08:02 (UTC+0) |

Tags

* [MediaWiki-Core-Team](/tag/mediawiki-core-team/)
* [Patch-For-Review](/tag/patch-for-review/)
* [Vuln-XSS](/tag/vuln-xss/)
* [Security](/tag/security/)
Referenced Files

|  | [F106280: T88310f-REL1\_24.patch](/F106280) |
| --- | --- |
| Mar 28 2015, 5:12 AM2015-03-28 05:12:31 (UTC+0) |

|  | [F106279: T88310f-REL1\_19.patch](/F106279) |
| --- | --- |
| Mar 28 2015, 5:12 AM2015-03-28 05:12:31 (UTC+0) |

|  | [F104172: T88310f.patch](/F104172) |
| --- | --- |
| Mar 25 2015, 5:38 PM2015-03-25 17:38:20 (UTC+0) |

|  | [F40500: T88310e.patch](/F40500) |
| --- | --- |
| Feb 13 2015, 1:23 AM2015-02-13 01:23:43 (UTC+0) |

|  | [F39131: T88310d.patch](/F39131) |
| --- | --- |
| Feb 10 2015, 11:43 PM2015-02-10 23:43:32 (UTC+0) |

|  | [F38800: T88310c.patch](/F38800) |
| --- | --- |
| Feb 10 2015, 2:00 AM2015-02-10 02:00:48 (UTC+0) |

|  | [F37106: entityscript.svg](/F37106) |
| --- | --- |
| Feb 4 2015, 3:06 PM2015-02-04 15:06:08 (UTC+0) |

|  | [F36753: T88310.patch](/F36753) |
| --- | --- |
| Feb 4 2015, 2:06 AM2015-02-04 02:06:36 (UTC+0) |

Subscribers

|  | [Aklapper](/p/Aklapper/) |
| --- | --- |

|  | [• csteipp](/p/csteipp/) |
| --- | --- |

|  | [gerritbot](/p/gerritbot/) |
| --- | --- |

|  | [Grunny](/p/Grunny/) |
| --- | --- |

|  | [ProgramCeltic](/p/ProgramCeltic/) |
| --- | --- |

|  | [tstarling](/p/tstarling/) |
| --- | --- |

# Description

Libxml was changed a while back to not expand xml entities by default (preventing many XXE and DoS vulnerabilities by default). It seems like that either caused, or influenced another change, so that xml\_parse in the zend engine doesn't expand entities either.

In our SVG filtering, we assume the xml is expanded while filtering, since Adobe seems to frequently output svg's with entities (so we can't prevent them categorically). There doesn't seem to be any options to force xml\_parse to do the expansion.

Tim heard a recommendation to move to XMLReader in general, over xml\_parse. We can pretty easily convert XmlTypeCheck to use XMLReader behind the existing interface.

---

**Patch**: T88310f.patch13 KB[Download](https://phab.wmfusercontent.org/file/download/bwz5bc74rfav5ki7gvm5/PHID-FILE-u7mbczyskqcfmhvke5ly/T88310f.patch)

* 1.24: T88310f-REL1\_24.patch13 KB[Download](https://phab.wmfusercontent.org/file/download/s2ozdxirvnyxopkyzeoy/PHID-FILE-3n2mfxrotmyvdoazlqaq/T88310f-REL1_24.patch)
* 1.23: T88310f-REL1\_24.patch13 KB[Download](https://phab.wmfusercontent.org/file/download/s2ozdxirvnyxopkyzeoy/PHID-FILE-3n2mfxrotmyvdoazlqaq/T88310f-REL1_24.patch)
* 1.19: T88310f-REL1\_19.patch11 KB[Download](https://phab.wmfusercontent.org/file/download/yye7ystiabsvmqsmxg5u/PHID-FILE-2k7jcosqousxkrcmpyfa/T88310f-REL1_19.patch)

**Affected Versions**: (needed)

**Type**: xss

**CVE**: CVE-2015-2934

# Details

|  | Subject | Repo | Branch | Lines +/- |
| --- | --- | --- | --- | --- |
|  | [SECURITY: Always expand xml entities when checking SVG's](https://gerrit.wikimedia.org/r/c/201223) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/master) | +206 -105 |
|  | [SECURITY: Always expand xml entities when checking SVG's](https://gerrit.wikimedia.org/r/c/201028) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_23](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_23) | +206 -105 |
|  | [SECURITY: Always expand xml entities when checking SVG's](https://gerrit.wikimedia.org/r/c/201017) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_24](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_24) | +206 -105 |
|  | [SECURITY: Always expand xml entities when checking SVG's](https://gerrit.wikimedia.org/r/c/201038) | [mediawiki/core](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core) | [REL1\_19](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/core/%2B/REL1_19) | +201 -84 |

[Customize query in gerrit](https://gerrit.wikimedia.org/r/#/q/bug:T88310)
# Related ObjectsSearch...

* Task Graph
* Mentions

|  |  | Status | Subtype | Assigned | Task |
| --- | --- | --- | --- | --- | --- |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T88120 [Release MW 1.24.2 and 1.23.9 tarballs](/T88120) |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T85862 [Make iSec assessment public](/T85862) |
|  |  | Declined |  | [• csteipp](/p/csteipp/) | T85860 [User access roles are public](/T85860) |
|  |  | Resolved |  | [Bawolff](/p/Bawolff/) | T85856 [Add warning to user Javascript files, warning the contents is public](/T85856) |
|  |  |  |  |  | Restricted Task |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T89744 [External reference in PDF](/T89744) |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T89745 [Stored XSS in PDF files](/T89745) |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T87275 [MediaWiki Security release 1.24.2](/T87275) |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T85850 [Stored XSS in SVG via embedded SVG](/T85850) |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T85858 [Check User page lacks CSRF protection](/T85858) |
|  |  | Resolved |  | [Parent5446](/p/Parent5446/) | T64685 [Extremely large passwords as DoS](/T64685) |
|  |  | Resolved |  | [Parent5446](/p/Parent5446/) | T85349 [SVG @import style validation bypass](/T85349) |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T85851 [Reflected XSS in api.php using wddx formatting](/T85851) |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T71210 [MediaWiki is vulnerable to XML quadratic blowup attacks](/T71210) |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T85848 [Billion Laughs attack in SVG and XMP Metadata](/T85848) |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T88310 [xml\_parse doesn't expand internal entities sometimes](/T88310) |
|  |  | Resolved |  | [• csteipp](/p/csteipp/) | T85855 [Custom JavaScript may yield privilege escalation](/T85855) |

Mentioned In [rMWb7ee3aca3877: SECURITY: Always expand xml entities when checking SVG's](/rMWb7ee3aca3877519a823b836de8fb2437187fcaa4)
[rMWb196d0519783: SECURITY: Always expand xml entities when checking SVG's](/rMWb196d05197837d87fca2eb8c34c23710e725721d)
[rMW02b6f29a69a5: SECURITY: Always expand xml entities when checking SVG's](/rMW02b6f29a69a534b1d4ae8b246cde6a983cd54f4d)
[rMW59c1bf8cc668: SECURITY: Always expand xml entities when checking SVG's](/rMW59c1bf8cc668237b41a4e29fba45be7c0760fd43)
[T71210: MediaWiki is vulnerable to XML quadratic blowup attacks](/T71210)
[T85848: Billion Laughs attack in SVG and XMP Metadata](/T85848) Mentioned Here [T85848: Billion Laughs attack in SVG and XMP Metadata](/T85848)
### Event Timeline

[• csteipp](/p/csteipp/) created this task.[Feb 2 2015, 7:08 PM2015-02-02 19:08:02 (UTC+0)](#1008928)[• csteipp](/p/csteipp/) claimed this task.[• csteipp](/p/csteipp/) raised the priority of this task from  to High.[• csteipp](/p/csteipp/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-vpz2ryace6xaqvz/)[• csteipp](/p/csteipp/) added projects: [MediaWiki-Core-Team](/tag/mediawiki-core-team/), [acl\*security](/tag/acl_security/).[• csteipp](/p/csteipp/) changed the visibility from "Public (No Login Required)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-2rni6pw45dk2ae2/)".[• csteipp](/p/csteipp/) changed the edit policy from "All Users" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-vksxzvg45if57fc/)".[• csteipp](/p/csteipp/) changed Security from None to Software security bug.[• csteipp](/p/csteipp/) added subscribers: [tstarling](/p/tstarling/), [Aklapper](/p/Aklapper/), [• csteipp](/p/csteipp/).[• csteipp](/p/csteipp/) moved this task from [Backlog](/project/board/37/) to [In Dev/Progress](/project/board/37/) on the [MediaWiki-Core-Team](/tag/mediawiki-core-team/) board.[Feb 2 2015, 10:03 PM2015-02-02 22:03:58 (UTC+0)](#1009677)[• csteipp](/p/csteipp/) added a comment.[Feb 4 2015, 2:06 AM2015-02-04 02:06:36 (UTC+0)](#1013499)Comment Actions

T88310.patch14 KB[Download](https://phab.wmfusercontent.org/file/download/zaqrijfrbnqdiz3fo4ym/PHID-FILE-yq6ngdfh27vznxviqpwo/T88310.patch)

This mostly duplicates how XmlTypeCheck interacted with the filter callbacks, but uses XMLReader instead of xml\_parse.

The differences between this and XmlTypeCheck are

1. Internal xml entities always expanded (to fix this bug)
2. When an external entity is encountered, XmlReaderTypeCheck will stop parsing (since libxml\_disable\_entity\_loader is set, so the parser throws an exception) and set wellFormed = false, where xml\_parse passed the unexpanded entity to the filtering callback.
3. Minor whitespace differences in TEXT nodes, but our filtering doesn't rely on the whitespace being exact

[@tstarling](/p/tstarling/), does this look like the approach you had in mind? I could also replace XmlTypeCheck entirely, but this approach is about 35% slower (when run across all of my svg's), so I left the old version for cases where we just want to know if the xml is well formed, and don't care about filtering exact values.

[• csteipp](/p/csteipp/) added a comment.[Feb 4 2015, 3:06 PM2015-02-04 15:06:08 (UTC+0)](#1014696)Comment Actions

entityscript.svg730 B[Download](https://phab.wmfusercontent.org/file/download/vy5rhmykrnsnpfeno3sj/PHID-FILE-b3hvy5g3o2vj5i3iecpt/entityscript.svg)

Reported by Noam from beyondsecurity this morning. It looks like the same issue, and with the XmlReaderTypeCheck patch, the script tag is correctly interpreted, sent to the filter, and upload is prevented.

[• csteipp](/p/csteipp/) moved this task from [In Dev/Progress](/project/board/37/) to [Needs Review/Feedback](/project/board/37/) on the [MediaWiki-Core-Team](/tag/mediawiki-core-team/) board.[Feb 4 2015, 8:13 PM2015-02-04 20:13:34 (UTC+0)](#1015787)[tstarling](/p/tstarling/) added a comment.Edited · [Feb 6 2015, 4:20 AM2015-02-06 04:20:19 (UTC+0)](#1020098)Comment Actions

Spelling error getAttrubtesArray -> getAttributesArray

Is wfSuppressWarnings() really needed around the whole of XmlReaderTypeCheck::validate()? Maybe we could just have an error suppressing wrapper around XMLReader::read().

Or better still, let's capture errors from XMLReader::read() using set\_error\_handler() and mark the input invalid if anything is captured. XMLReader::read() calls xmlTextReaderRead:

```
/**
 * xmlTextReaderRead:
 * @reader:  the xmlTextReaderPtr used
 *
 *  Moves the position of the current instance to the next node in
 *  the stream, exposing its properties.
 *
 *  Returns 1 if the node was read successfully, 0 if there is no more
 *          nodes to read, or -1 in case of error
 */
```

It returns -1 for all sorts of reasons, and HHVM's XMLReader::read() responds to a return value of -1 by just raising a warning and returning false. It concerns me because if the user can find some way to make libxml2 give an error halfway through the document, say due to limit exhaustion, the read loop in XmlReaderTypeCheck::validate() will mistake the error for the end of the document, and the second half of the document will be passed without validation.

I guess the stack depth check on line 231 is meant to prevent partially validated documents from getting through the filter, but do we really know how clients will respond to XML documents with multiple document elements? Or PIs after the end of the document element? libxml2 has its own well-formedness flag, which is not directly exposed by HHVM, but it looks like xmlTextReaderRead() will return -1 in response to it being false:

```
    if (reader->ctxt->wellFormed == 0) {
	reader->mode = XML_TEXTREADER_MODE_EOF;
        return(-1);
    }

    return(0);
```

So a check for a warning should be sufficient.

Otherwise looks fine.

[• csteipp](/p/csteipp/) moved this task from [Needs Review/Feedback](/project/board/37/) to [In Dev/Progress](/project/board/37/) on the [MediaWiki-Core-Team](/tag/mediawiki-core-team/) board.[Feb 9 2015, 10:14 PM2015-02-09 22:14:45 (UTC+0)](#1026212)[• csteipp](/p/csteipp/) added a comment.[Feb 10 2015, 2:00 AM2015-02-10 02:00:48 (UTC+0)](#1026891)Comment Actions

T88310c.patch15 KB[Download](https://phab.wmfusercontent.org/file/download/yrbbyuvnolpnyes2hand/PHID-FILE-eh7e5dyl3ertox4cwdvw/T88310c.patch) Update to catch warnings.

[• csteipp](/p/csteipp/) added a subscriber: [Anomie](/p/Anomie/).[Feb 10 2015, 7:52 PM2015-02-10 19:52:30 (UTC+0)](#1028816)Comment Actions

Re-ran this through all my svg's, and doesn't seem to create any unexpected issues with the filtering. Performance isn't great-- run times are 4-10x using XMLReader vs xml\_parse (using 5.4/zend).

[@Anomie](/p/Anomie/), would you be able to sanity check this patch?

[• csteipp](/p/csteipp/) added a comment.[Feb 10 2015, 11:43 PM2015-02-10 23:43:32 (UTC+0)](#1029483)Comment Actions

T88310d.patch17 KB[Download](https://phab.wmfusercontent.org/file/download/l4cnhmeg4vteof2s45vz/PHID-FILE-kxekkzdkara2s2opp46i/T88310d.patch)

Added Beyond Security's report to the unit tests, and a test that external entities shouldn't be allowed.

[Anomie](/p/Anomie/) added a comment.[Feb 11 2015, 6:02 PM2015-02-11 18:02:11 (UTC+0)](#1031822)Comment Actions

Short answer: A few bits of funny whitespace ("$errno , $errstr", "set\_error\_handler ( "), but otherwise looks sane.

Other comments:

You're missing some optimization if no $filterCallback was passed to the constructor, but the only use does pass a callback so that could be left for later.

You have a comment in the default case "One of COMMENT, DOC, DOC\_TYPE, ENTITY, END\_ENTITY, NOTATION, or XML\_DECLARATION", but you actually handle COMMENT earlier in the switch. There doesn't seem to be any particular reason to not let COMMENT use the default case.

I wonder if moving the set\_error\_handler()/restore\_error\_handler() back up to validateFromInput() would be a worthwhile speedup, and if so whether the possibility of unrelated warnings from callbacks causing false failures is worth worrying about.

If the slowdown is that bad and HHVM's xml\_parse works right, it might be worth detecting whether xml\_parse is going to recursively expand entities and choosing XmlReaderTypeCheck vs XmlTypeCheck based on that. Maybe something like this:

```
$xml = '<?xml version="1.0" encoding="UTF-8" standalone="yes"?><!DOCTYPE foo [<!ENTITY test "expanded"><!ENTITY test2 "&test;">]><foo>&test2;</foo>';
$parser = xml_parser_create_ns( 'UTF-8' );
xml_set_character_data_handler( $parser, 'someFunction' ); // Unfortunately HHVM doesn't like a Closure here
xml_parse( $parser, $xml, true );
xml_parser_free( $parser );
// Look at what 'someFunction' got called with
// * "expanded" = Entities recursively expanded (HHVM)
// * "&test;"   = Only one level of expansion (Zend, apparently)
// * "&test2;"  = No expansion
// * multiple calls, or something else = WTF?
```
[• csteipp](/p/csteipp/) added a comment.[Feb 13 2015, 1:23 AM2015-02-13 01:23:43 (UTC+0)](#1035864)Comment Actions

Thanks for the comments [@Anomie](/p/Anomie/), fixed most of them in T88310e.patch17 KB[Download](https://phab.wmfusercontent.org/file/download/urehot7syf5cgjjpwnsk/PHID-FILE-bbjbr3wdqnxhu2j2gdyo/T88310e.patch). I kept the COMMENT block separate just to keep the comment about not passing it explicit.

I reran these on hhvm, and performance for XMLReader is actually 25% faster for small svgs, and 7-40% slower for some sets of larger files, so I'm much less worried about it in production.

[• csteipp](/p/csteipp/) moved this task from [In Dev/Progress](/project/board/37/) to [Needs Review/Feedback](/project/board/37/) on the [MediaWiki-Core-Team](/tag/mediawiki-core-team/) board.[Feb 14 2015, 12:38 AM2015-02-14 00:38:26 (UTC+0)](#1038248)[• csteipp](/p/csteipp/) closed this task as Resolved.[Feb 17 2015, 10:43 PM2015-02-17 22:43:39 (UTC+0)](#1045001)[• csteipp](/p/csteipp/) mentioned this in [T85848: Billion Laughs attack in SVG and XMP Metadata](/T85848).[Feb 18 2015, 12:35 AM2015-02-18 00:35:51 (UTC+0)](#1045318)[bd808](/p/bd808/) moved this task from [Needs Review/Feedback](/project/board/37/) to [Done](/project/board/37/) on the [MediaWiki-Core-Team](/tag/mediawiki-core-team/) board.[Feb 18 2015, 10:14 PM2015-02-18 22:14:37 (UTC+0)](#1048260)[bd808](/p/bd808/) moved this task from [Done](/project/board/37/) to [Archive](/project/board/37/) on the [MediaWiki-Core-Team](/tag/mediawiki-core-team/) board.[Feb 23 2015, 11:58 PM2015-02-23 23:58:15 (UTC+0)](#1060978)[• csteipp](/p/csteipp/) added a parent task: [T87275: MediaWiki Security release 1.24.2](/T87275).[Mar 19 2015, 8:20 PM2015-03-19 20:20:43 (UTC+0)](#1133214)[• csteipp](/p/csteipp/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-rekusmqy36ycuo7/)[Mar 19 2015, 8:25 PM2015-03-19 20:25:32 (UTC+0)](#1133228)[• csteipp](/p/csteipp/) added a parent task: [T71210: MediaWiki is vulnerable to XML quadratic blowup attacks](/T71210).[Mar 19 2015, 8:59 PM2015-03-19 20:59:51 (UTC+0)](#1133313)[• csteipp](/p/csteipp/) mentioned this in [T71210: MediaWiki is vulnerable to XML quadratic blowup attacks](/T71210).[Mar 19 2015, 9:15 PM2015-03-19 21:15:01 (UTC+0)](#1133345)[• csteipp](/p/csteipp/) added a comment.[Mar 25 2015, 1:27 AM2015-03-25 01:27:17 (UTC+0)](#1147435)Comment Actions

Started backporting T88310e.patch17 KB[Download](https://phab.wmfusercontent.org/file/download/urehot7syf5cgjjpwnsk/PHID-FILE-bbjbr3wdqnxhu2j2gdyo/T88310e.patch), and in light of the outcome of [T85848](/T85848), I think it would make more sense to just convert XmlTypeCheck instead of having both XmlTypeCheck and XmlReaderTypeCheck in parallel. There's more risk of breaking our 3rd party installs, but having 2 implementations is going to be a headache too, and on hhvm, XmlTypeCheck isn't safe to use at all.

[• csteipp](/p/csteipp/) added a comment.[Mar 25 2015, 5:38 PM2015-03-25 17:38:20 (UTC+0)](#1149601)Comment Actions

T88310f.patch13 KB[Download](https://phab.wmfusercontent.org/file/download/bwz5bc74rfav5ki7gvm5/PHID-FILE-u7mbczyskqcfmhvke5ly/T88310f.patch) - [@Anomie](/p/Anomie/), does that seem more sane?

[Anomie](/p/Anomie/) added a comment.[Mar 25 2015, 6:19 PM2015-03-25 18:19:18 (UTC+0)](#1149827)Comment Actions

Looks ok to me. Haven't tested.

[• csteipp](/p/csteipp/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-fzuydbwqcxsw5vs/)[Mar 27 2015, 7:01 PM2015-03-27 19:01:46 (UTC+0)](#1157732)[• csteipp](/p/csteipp/) added a comment.[Mar 28 2015, 5:12 AM2015-03-28 05:12:31 (UTC+0)](#1159128)Comment Actions

T88310f-REL1\_19.patch11 KB[Download](https://phab.wmfusercontent.org/file/download/yye7ystiabsvmqsmxg5u/PHID-FILE-2k7jcosqousxkrcmpyfa/T88310f-REL1_19.patch)

T88310f-REL1\_24.patch13 KB[Download](https://phab.wmfusercontent.org/file/download/s2ozdxirvnyxopkyzeoy/PHID-FILE-3n2mfxrotmyvdoazlqaq/T88310f-REL1_24.patch)

[• csteipp](/p/csteipp/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-wj2imf64ssontg4/)[Mar 28 2015, 5:13 AM2015-03-28 05:13:50 (UTC+0)](#1159129)[• csteipp](/p/csteipp/) added a comment.[Mar 28 2015, 5:19 AM2015-03-28 05:19:48 (UTC+0)](#1159141)Comment Actions

Deployed this afternoon as part of,

21:10 csteipp: redeploy security patches to wmf22

21:02 csteipp: redeploy security patches to wmf23

[• csteipp](/p/csteipp/) added subscribers: [Grunny](/p/Grunny/), [ProgramCeltic](/p/ProgramCeltic/).[Mar 30 2015, 8:01 PM2015-03-30 20:01:12 (UTC+0)](#1164341)[• csteipp](/p/csteipp/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-fezqtvytxwjjrte/)" to "[Custom Policy](/transactions/new/PHID-XACT-TASK-fezqtvytxwjjrte/)".[Mar 31 2015, 12:36 PM2015-03-31 12:36:24 (UTC+0)](#1166654)[• csteipp](/p/csteipp/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-wszyhdoj6yxbne7/)" to "Public (No Login Required)".[Mar 31 2015, 9:14 PM2015-03-31 21:14:44 (UTC+0)](#1168307)[• csteipp](/p/csteipp/) changed the edit policy from "[Custom Policy](/transactions/old/PHID-XACT-TASK-cjt4xpnnw5b4xxt/)" to "All Users".[• csteipp](/p/csteipp/) changed Security from Software security bug to None.[gerritbot](/p/gerritbot/) subscribed.[Mar 31 2015, 9:22 PM2015-03-31 21:22:26 (UTC+0)](#1168374)Comment Actions

Change 201017 had a related patch set uploaded (by CSteipp):

SECURITY: Always expand xml entities when checking SVG's

<https://gerrit.wikimedia.org/r/201017>

[gerritbot](/p/gerritbot/) added a project: [Patch-For-Review](/tag/patch-for-review/).[Mar 31 2015, 9:22 PM2015-03-31 21:22:27 (UTC+0)](#1168375)[gerritbot](/p/gerritbot/) added a comment.[Mar 31 2015, 9:30 PM2015-03-31 21:30:04 (UTC+0)](#1168413)Comment Actions

Change 201028 had a related patch set uploaded (by CSteipp):

SECURITY: Always expand xml entities when checking SVG's

<https://gerrit.wikimedia.org/r/201028>

[gerritbot](/p/gerritbot/) added a comment.[Mar 31 2015, 9:35 PM2015-03-31 21:35:36 (UTC+0)](#1168438)Comment Actions

Change 201038 had a related patch set uploaded (by CSteipp):

SECURITY: Always expand xml entities when checking SVG's

<https://gerrit.wikimedia.org/r/201038>

[gerritbot](/p/gerritbot/) added a comment.[Mar 31 2015, 10:05 PM2015-03-31 22:05:04 (UTC+0)](#1168505)Comment Actions

Change 201017 merged by jenkins-bot:

SECURITY: Always expand xml entities when checking SVG's

<https://gerrit.wikimedia.org/r/201017>

[• csteipp](/p/csteipp/) mentioned this in [rMW59c1bf8cc668: SECURITY: Always expand xml entities when checking SVG's](/rMW59c1bf8cc668237b41a4e29fba45be7c0760fd43).[Mar 31 2015, 10:05 PM2015-03-31 22:05:32 (UTC+0)](#1168517)[gerritbot](/p/gerritbot/) added a comment.[Mar 31 2015, 10:21 PM2015-03-31 22:21:59 (UTC+0)](#1168591)Comment Actions

Change 201028 merged by jenkins-bot:

SECURITY: Always expand xml entities when checking SVG's

<https://gerrit.wikimedia.org/r/201028>

[• csteipp](/p/csteipp/) mentioned this in [rMW02b6f29a69a5: SECURITY: Always expand xml entities when checking SVG's](/rMW02b6f29a69a534b1d4ae8b246cde6a983cd54f4d).[Mar 31 2015, 10:22 PM2015-03-31 22:22:17 (UTC+0)](#1168605)[gerritbot](/p/gerritbot/) added a comment.[Mar 31 2015, 10:22 PM2015-03-31 22:22:24 (UTC+0)](#1168616)Comment Actions

Change 201038 merged by jenkins-bot:

SECURITY: Always expand xml entities when checking SVG's

<https://gerrit.wikimedia.org/r/201038>

[• csteipp](/p/csteipp/) mentioned this in [rMWb196d0519783: SECURITY: Always expand xml entities when checking SVG's](/rMWb196d05197837d87fca2eb8c34c23710e725721d).[Mar 31 2015, 10:22 PM2015-03-31 22:22:48 (UTC+0)](#1168623)[gerritbot](/p/gerritbot/) added a comment.[Apr 1 2015, 4:57 PM2015-04-01 16:57:23 (UTC+0)](#1170743)Comment Actions

Change 201223 had a related patch set uploaded (by CSteipp):

SECURITY: Always expand xml entities when checking SVG's

<https://gerrit.wikimedia.org/r/201223>

[gerritbot](/p/gerritbot/) added a comment.[Apr 1 2015, 5:40 PM2015-04-01 17:40:11 (UTC+0)](#1170939)Comment Actions

Change 201223 merged by jenkins-bot:

SECURITY: Always expand xml entities when checking SVG's

<https://gerrit.wikimedia.org/r/201223>

[• csteipp](/p/csteipp/) mentioned this in [rMWb7ee3aca3877: SECURITY: Always expand xml entities when checking SVG's](/rMWb7ee3aca3877519a823b836de8fb2437187fcaa4).[Apr 1 2015, 5:40 PM2015-04-01 17:40:25 (UTC+0)](#1170944)[• csteipp](/p/csteipp/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-gjxdmfjhpnuasce/)[Apr 9 2015, 10:49 PM2015-04-09 22:49:26 (UTC+0)](#1196355)[• csteipp](/p/csteipp/) added a project: [Vuln-XSS](/tag/vuln-xss/).[Apr 9 2015, 10:51 PM2015-04-09 22:51:38 (UTC+0)](#1196357)[• chasemp](/p/chasemp/) added a project: [Security](/tag/security/).[Feb 10 2020, 10:56 PM2020-02-10 22:56:07 (UTC+0)](#5868761) · [• chasemp](/p/chasemp/) removed a project: [acl\*security](/tag/acl_security/).[Feb 20 2020, 8:16 PM2020-02-20 20:16:12 (UTC+0)](#5904308) · [Aklapper](/p/Aklapper/) removed a subscriber: [Anomie](/p/Anomie/).[Oct 16 2020, 5:41 PM2020-10-16 17:41:11 (UTC+0)](#6554388) · [Log In to Comment](/login/?next=)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)

=== Content from www.openwall.com_697f15b9_20250125_205708.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](../../../2015/04/01/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20150407073412.354C26C0003@smtpvmsrv1.mitre.org>
Date: Tue,  7 Apr 2015 03:34:12 -0400 (EDT)
From: cve-assign@...re.org
To: csteipp@...imedia.org
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request: MediaWiki 1.24.2/1.23.9/1.19.24

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> * iSEC Partners discovered a way to circumvent the SVG MIME blacklist for
> embedded resources (iSEC-WMF1214-11). This allowed an attacker to embed
> JavaScript in the SVG. The issue was additionally identified by Mario
> Heiderich / Cure53. MIME types are now whitelisted.
> <https://phabricator.wikimedia.org/T85850>

Use CVE-2015-2931 for this issue involving an incomplete list of
disallowed MIME types for data: URIs (the application/xml type wasn't
in this list). In other words, CVE-2015-2931 does not refer more
generally to the desirability of the "MIME types are now whitelisted"
decision.

> * MediaWiki user Bawolff pointed out that the SVG filter to prevent
> injecting JavaScript using animate elements was incorrect.
> <https://phabricator.wikimedia.org/T86711>

Use CVE-2015-2932 for this issue involving an incomplete list of
dangerous parts of HTML5. (The list is supposed to include all uses of
'animate attributename="xlink:href"' in SVG documents.)

> * MediaWiki user Bawolff reported a stored XSS vulnerability due to the way
> attributes were expanded in MediaWiki's Html class, in combination with
> LanguageConverter substitutions.
> <https://phabricator.wikimedia.org/T73394>

Use CVE-2015-2933 for this XSS issue.

Also, this part of T73394 seems potentially interesting although it is
apparently neither a MediaWiki bug nor a PHP bug:

  <https://phabricator.wikimedia.org/T73394#750588>
  preg_match() silently returns false on limit exhaustion

In other words, if a PHP application uses
"ini_set('pcre.recursion_limit'" and does not properly handle the
preg_match return value, then a hard-to-find XSS vulnerability might
exist.

> * Internal review discovered that MediaWiki's SVG filtering could be
> bypassed with entity encoding under the Zend interpreter. This could be
> used to inject JavaScript. This issue was also discovered by Mario Gomes /
> Beyond Security.
> <https://phabricator.wikimedia.org/T88310>

Use CVE-2015-2934 for this interaction issue in which (roughly
speaking) secure operation of MediaWiki had been relying on a libxml
behavior that was removed for unrelated security reasons. (In other
words, it's apparently an usual type of vulnerability whose avoidance
requires studying all "improvements" in new releases of library code,
and determining whether any of them have unintended adverse
consequences.)

> * iSEC Partners discovered a way to bypass the style filtering for SVG
> files (iSEC-WMF1214-3) to load external resource. This could violate the
> anonymity of users viewing the SVG.
> <https://phabricator.wikimedia.org/T85349>

Use CVE-2015-2935 for this issue of information leaks observable in
log files on an attacker-controlled web server. This issue exists
because of an incomplete fix for CVE-2014-7199.

> * Internal review and iSEC Partners discovered (iSEC-WMF1214-1) that
> MediaWiki versions using PBKDF2 for password hashing (the default since
> 1.24) are vulnerable to DoS attacks using extremely long passwords.
> <https://phabricator.wikimedia.org/T64685>

Use CVE-2015-2936 for this vulnerability with a CPU consumption impact.

> * Internal review found that MediaWiki is vulnerable to "Quadratic Blowup"
> DoS attacks, under both HHVM and Zend PHP.
> <https://phabricator.wikimedia.org/T71210>

Use CVE-2015-2937. This is a quadratic issue and isn't the same as the
CVE-2015-2942 exponential issue affecting only HHVM (see below).

> * iSEC Partners reported that the MediaWiki feature allowing a user to
> preview another user's custom JavaScript could be abused for privilege
> escalation (iSEC-WMF1214-10). This feature has been removed.
> <https://phabricator.wikimedia.org/T85855>

Use CVE-2015-2938 for this XSS issue.

> * Extension:Scribunto - MediaWiki user Jackmcbarn discovered that function
> names were sanitized in Lua error backtraces, which could lead to XSS.
> <https://phabricator.wikimedia.org/T85113>

Use CVE-2015-2939 for this XSS issue. In the above quoted text, "were
sanitized" should be "were not sanitized" instead.

> * Extension:CheckUser - iSEC Partners discovered that the CheckUser
> extension did not prevent CSRF attacks on the form allowing checkusers to
> look up sensitive information about other users (iSEC-WMF1214-6). Since the
> use of CheckUser is logged, the CSRF could be abused to defame a trusted
> user or flood the logs with noise.
> <https://phabricator.wikimedia.org/T85858>

For purposes of CVE, we'll accept reports from a software's author
stating that there is a CSRF vulnerability for a request to read data.
Use CVE-2015-2940. This does not mean that similar reports from
arbitrary researchers about arbitrary products would have CVE IDs
assigned. For many products, the implied security policy does not
include a CSRF protection mechanism that prevents all
undesirable/confusing log entries.

> I'm not sure if CVE's are assigned for specific runtime
> configurations? For MediaWiki, we say that HHVM support is experimental,
> although we do run Wikipedia on it.

There isn't a general rule that CVE IDs are assigned for arbitrary
unsupported deployments of a product. Our impression is that users may
realistically decide that the HHVM support is "complete enough" for
their purposes. Also, in some cases, HHVM support is referenced or
documented in places that don't directly discuss the experimental
nature, such as on the <http://www.mediawiki.org/wiki/HHVM> and
[http://www.mediawiki.org/wiki/Manual:How_to_debug](http://www.mediawiki.org/wiki/Manual%3AHow_to_debug) pages. So, here, we
do want to assign CVE IDs applicable only to HHVM deployments.

> * iSEC Partners discovered a XSS vulnerability in the way api errors were
> reflected under HHVM versions before 3.6.1 (iSEC-WMF1214-8). MediaWiki now
> detects and mitigates this issue on older versions of HHVM.
> <https://phabricator.wikimedia.org/T85851>

It seems that the major concern here is the HHVM vulnerability fixed
by the
<https://github.com/facebook/hhvm/commit/324701c9fd31beb4f070f1b7ef78b115fbdfec34>
commit. Use CVE-2014-9714 for that HHVM vulnerability.

As far as we can tell, T85851 is recommending
<https://gerrit.wikimedia.org/r/#/c/201020/1/includes/api/ApiFormatWddx.php,unified>
as a vulnerability fix for MediaWiki deployments that use an older
version of HHVM. Use CVE-2015-2941 for this MediaWiki vulnerability in
which unsafe calls to wddx_serialize_value can occur.

> * iSEC Partners discovered that MediaWiki's SVG and XMP parsing running
> under HHVM was susceptible to "Billion Laughs" DoS attacks
> (iSEC-WMF1214-13).
> <https://phabricator.wikimedia.org/T85848>

Use CVE-2015-2942 for this exponential issue, which is different from
the CVE-2015-2937 quadratic issue mentioned above.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJVI4etAAoJEKllVAevmvmsxk0H/R0orjbDyN56mEOJ9a/rlowS
D5cuaiDe4dzWbqEOzii8g+3d2iVsb1BUJHxfuGOFjf0zstb2KhJP5iaKN6hsXcHn
HKdtHE8uKMzs5DYxxeGsbphrp/J/Uff1+G7vwPmBTG3Z+tcLNXstuoIO18Pg3HuP
yT/P37KKJvlyhn5l325M4h0ln3kRu7egDHEctsJGNnb0IHoSoT8VmaiMYs/OwdP/
GT0XZVc7iNIBpXx0Ao03HxaSMgEfFs5X8PNnO95j9V9ngcP7zKQVT9ycsBHAhawP
dP+etPml55OJJKViqVZji5Dvv6BxZWnBACgzDI9ZcNFSHSykgr6Y3E+6nxmEKWY=
=vxIE
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from phab.wmfusercontent.org_0ba60917_20250126_115455.html ===
From 4bf050c51455c7585d6f578891fb2f8eaee3b0dc Mon Sep 17 00:00:00 2001
From: csteipp
Date: Fri, 27 Mar 2015 15:52:56 -0700
Subject: [PATCH] SECURITY: Always expand xml entities when checking SVG's
XmlTypeCheck's use of xml\_parse for filtering SVG's sometimes left xml
entities unexpanded, which can lead to false-negatives when the
callback was used for filtering. Update XmlTypeCheck to use XMLReader
instead, tell the library to fully expand entities, and rely on the
library to error out if it encounters XML that is likely to cause a DoS
if parsed.
Bug: T88310
Change-Id: I77c77a2d6d22f549e7ef969811f7edd77a45dbba
---
includes/XmlTypeCheck.php | 261 +++++++++++++++++++++++++++++++++-------------
1 file changed, 189 insertions(+), 72 deletions(-)
diff --git a/includes/XmlTypeCheck.php b/includes/XmlTypeCheck.php
index 2062101..693580d 100644
--- a/includes/XmlTypeCheck.php
+++ b/includes/XmlTypeCheck.php
@@ -1,11 +1,36 @@
php
+/\*\*
+ \* XML syntax and type checker.
+ \*
+ \* Since 1.24.2, it uses XMLReader instead of xml\_parse, which gives us
+ \* more control over the expansion of XML entities. When passed to the
+ \* callback, entities will be fully expanded, but may report the XML is
+ \* invalid if expanding the entities are likely to cause a DoS.
+ \*
+ \* This program is free software; you can redistribute it and/or modify
+ \* it under the terms of the GNU General Public License as published by
+ \* the Free Software Foundation; either version 2 of the License, or
+ \* (at your option) any later version.
+ \*
+ \* This program is distributed in the hope that it will be useful,
+ \* but WITHOUT ANY WARRANTY; without even the implied warranty of
+ \* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+ \* GNU General Public License for more details.
+ \*
+ \* You should have received a copy of the GNU General Public License along
+ \* with this program; if not, write to the Free Software Foundation, Inc.,
+ \* 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ \* http://www.gnu.org/copyleft/gpl.html
+ \*
+ \* @file
+ \*/
class XmlTypeCheck {
/\*\*
\* Will be set to true or false to indicate whether the file is
\* well-formed XML. Note that this doesn't check schema validity.
\*/
- public $wellFormed = false;
+ public $wellFormed = null;
/\*\*
\* Will be set to true if the optional element filter returned
@@ -19,7 +44,7 @@ class XmlTypeCheck {
\*/
public $rootElement = '';
- /\*\*
+ /\*\*
\* A stack of strings containing the data of each xml element as it's processed. Append
\* data to the top string of the stack, then pop off the string and process it when the
\* element is closed.
@@ -44,19 +69,19 @@ class XmlTypeCheck {
);
/\*\*
- \* @param $file string filename
- \* @param $filterCallback callable (optional)
+ \* @param string $input a filename
+ \* @param callable $filterCallback (optional)
\* Function to call to do additional custom validity checks from the
\* SAX element handler event. This gives you access to the element
\* namespace, name, attributes, and text contents.
\* Filter should return 'true' to toggle on $this-filterMatch
\* @param array $options list of additional parsing options:
- \* processing\_instruction\_handler: Callback for xml\_set\_processing\_instruction\_handler
+ \* processing\_instruction\_handler: Callback for xml\_set\_processing\_instruction\_handler
\*/
- function \_\_construct( $file, $filterCallback=null, $options=array() ) {
+ function \_\_construct( $input, $filterCallback = null, $options = array() ) {
$this->filterCallback = $filterCallback;
$this->parserOptions = array\_merge( $this->parserOptions, $options );
- $this->run( $file );
+ $this->validateFromInput( $input, true );
}
/\*\*
@@ -68,119 +93,211 @@ class XmlTypeCheck {
return $this->rootElement;
}
+
/\*\*
- \* @param $fname
+ \* @param string $fname the filename
\*/
- private function run( $fname ) {
- $parser = xml\_parser\_create\_ns( 'UTF-8' );
+ private function validateFromInput( $xml, $isFile ) {
+ $reader = new XMLReader();
+ if ( $isFile ) {
+ $s = $reader->open( $xml, null, LIBXML\_NOERROR | LIBXML\_NOWARNING );
+ } else {
+ $s = $reader->XML( $xml, null, LIBXML\_NOERROR | LIBXML\_NOWARNING );
+ }
+ if ( $s !== true ) {
+ // Couldn't open the XML
+ $this->wellFormed = false;
+ } else {
+ $oldDisable = libxml\_disable\_entity\_loader( true );
+ $reader->setParserProperty( XMLReader::SUBST\_ENTITIES, true );
+ try {
+ $this->validate( $reader );
+ } catch ( Exception $e ) {
+ // Calling this malformed, because we didn't parse the whole
+ // thing. Maybe just an external entity refernce.
+ $this->wellFormed = false;
+ $reader->close();
+ libxml\_disable\_entity\_loader( $oldDisable );
+ throw $e;
+ }
+ $reader->close();
+ libxml\_disable\_entity\_loader( $oldDisable );
+ }
+ }
- // case folding violates XML standard, turn it off
- xml\_parser\_set\_option( $parser, XML\_OPTION\_CASE\_FOLDING, false );
+ private function readNext( XMLReader $reader ) {
+ set\_error\_handler( array( $this, 'XmlErrorHandler' ) );
+ $ret = $reader->read();
+ restore\_error\_handler();
+ return $ret;
+ }
- xml\_set\_element\_handler( $parser, array( $this, 'rootElementOpen' ), false );
+ public function XmlErrorHandler( $errno, $errstr ) {
+ $this->wellFormed = false;
+ }
- if ( $this->parserOptions['processing\_instruction\_handler'] ) {
- xml\_set\_processing\_instruction\_handler(
- $parser,
- array( $this, 'processingInstructionHandler' )
- );
- }
+ private function validate( $reader ) {
+
+ // First, move through anything that isn't an element, and
+ // handle any processing instructions with the callback
+ do {
+ if( !$this->readNext( $reader ) ) {
+ // Hit the end of the document before any elements
+ $this->wellFormed = false;
+ return;
+ }
+ if ( $reader->nodeType === XMLReader::PI ) {
+ $this->processingInstructionHandler( $reader->name, $reader->value );
+ }
+ } while ( $reader->nodeType != XMLReader::ELEMENT );
- if ( file\_exists( $fname ) ) {
- $file = fopen( $fname, "rb" );
- if ( $file ) {
- do {
- $chunk = fread( $file, 32768 );
- $ret = xml\_parse( $parser, $chunk, feof( $file ) );
- if( $ret == 0 ) {
- // XML isn't well-formed!
- fclose( $file );
- xml\_parser\_free( $parser );
- return;
+ // Process the rest of the document
+ do {
+ switch ( $reader->nodeType ) {
+ case XMLReader::ELEMENT:
+ $name = $this->expandNS(
+ $reader->name,
+ $reader->namespaceURI
+ );
+ if ( $this->rootElement === '' ) {
+ $this->rootElement = $name;
}
- } while( !feof( $file ) );
+ $empty = $reader->isEmptyElement;
+ $attrs = $this->getAttributesArray( $reader );
+ $this->elementOpen( $name, $attrs );
+ if ( $empty ) {
+ $this->elementClose();
+ }
+ break;
+
+ case XMLReader::END\_ELEMENT:
+ $this->elementClose();
+ break;
- fclose( $file );
+ case XMLReader::WHITESPACE:
+ case XMLReader::SIGNIFICANT\_WHITESPACE:
+ case XMLReader::CDATA:
+ case XMLReader::TEXT:
+ $this->elementData( $reader->value );
+ break;
+
+ case XMLReader::ENTITY\_REF:
+ // Unexpanded entity (maybe external?),
+ // don't send to the filter (xml\_parse didn't)
+ break;
+
+ case XMLReader::COMMENT:
+ // Don't send to the filter (xml\_parse didn't)
+ break;
+
+ case XMLReader::PI:
+ // Processing instructions can happen after the header too
+ $this->processingInstructionHandler(
+ $reader->name,
+ $reader->value
+ );
+ break;
+ default:
+ // One of DOC, DOC\_TYPE, ENTITY, END\_ENTITY,
+ // NOTATION, or XML\_DECLARATION
+ // xml\_parse didn't send these to the filter, so we won't.
}
+
+ } while ( $this->readNext( $reader ) );
+
+ if ( $this->stackDepth !== 0 ) {
+ $this->wellFormed = false;
+ } elseif ( $this->wellFormed === null ) {
+ $this->wellFormed = true;
}
- $this->wellFormed = true;
+ }
- xml\_parser\_free( $parser );
+ /\*\*
+ \* Get all of the attributes for an XMLReader's current node
+ \* @param $r XMLReader
+ \* @return array of attributes
+ \*/
+ private function getAttributesArray( XMLReader $r ) {
+ $attrs = array();
+ while ( $r->moveToNextAttribute() ) {
+ if ( $r->namespaceURI === 'http://www.w3.org/2000/xmlns/' ) {
+ // XMLReader treats xmlns attributes as normal
+ // attributes, while xml\_parse doesn't
+ continue;
+ }
+ $name = $this->expandNS( $r->name, $r->namespaceURI );
+ $attrs[$name] = $r->value;
+ }
+ return $attrs;
}
/\*\*
- \* @param $parser
- \* @param $name
- \* @param $attribs
+ \* @param $name element or attribute name, maybe with a full or short prefix
+ \* @param $namespaceURI the namespaceURI
+ \* @return string the name prefixed with namespaceURI
\*/
- private function rootElementOpen( $parser, $name, $attribs ) {
- $this->rootElement = $name;
-
- if( is\_callable( $this->filterCallback ) ) {
- xml\_set\_element\_handler(
- $parser,
- array( $this, 'elementOpen' ),
- array( $this, 'elementClose' )
- );
- xml\_set\_character\_data\_handler( $parser, array( $this, 'elementData' ) );
- $this->elementOpen( $parser, $name, $attribs );
- } else {
- // We only need the first open element
- xml\_set\_element\_handler( $parser, false, false );
+ private function expandNS( $name, $namespaceURI ) {
+ if ( $namespaceURI ) {
+ $parts = explode( ':', $name );
+ $localname = array\_pop( $parts );
+ return "$namespaceURI:$localname";
}
+ return $name;
}
/\*\*
- \* @param $parser
\* @param $name
\* @param $attribs
\*/
- private function elementOpen( $parser, $name, $attribs ) {
+ private function elementOpen( $name, $attribs ) {
$this->elementDataContext[] = array( $name, $attribs );
$this->elementData[] = '';
$this->stackDepth++;
}
/\*\*
- \* @param $parser
- \* @param $name
\*/
- private function elementClose( $parser, $name ) {
+ private function elementClose() {
list( $name, $attribs ) = array\_pop( $this->elementDataContext );
$data = array\_pop( $this->elementData );
$this->stackDepth--;
- if ( call\_user\_func(
- $this->filterCallback,
- $name,
- $attribs,
- $data
- ) ) {
- // Filter hit!
+ if ( is\_callable( $this->filterCallback )
+ && call\_user\_func(
+ $this->filterCallback,
+ $name,
+ $attribs,
+ $data
+ )
+ ) {
+ // Filter hit
$this->filterMatch = true;
}
}
/\*\*
- \* @param $parser
\* @param $data
\*/
- private function elementData( $parser, $data ) {
- // xml\_set\_character\_data\_handler breaks the data on & characters, so
- // we collect any data here, and we'll run the callback in elementClose
+ private function elementData( $data ) {
+ // Collect any data here, and we'll run the callback in elementClose
$this->elementData[ $this->stackDepth - 1 ] .= trim( $data );
}
/\*\*
- \* @param $parser
\* @param $target
\* @param $data
\*/
- private function processingInstructionHandler( $parser, $target, $data ) {
- if ( call\_user\_func( $this->parserOptions['processing\_instruction\_handler'], $target, $data ) ) {
- // Filter hit!
- $this->filterMatch = true;
+ private function processingInstructionHandler( $target, $data ) {
+ if ( $this->parserOptions['processing\_instruction\_handler'] ) {
+ if ( call\_user\_func(
+ $this->parserOptions['processing\_instruction\_handler'],
+ $target,
+ $data
+ ) ) {
+ // Filter hit!
+ $this->filterMatch = true;
+ }
}
}
}
--
1.8.4.5


=== Content from lists.wikimedia.org_c65686ea_20250125_205709.html ===


[lists.wikimedia.org](/hyperkitty/)

[Sign In](/accounts/login/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN/)
[Sign Up](/accounts/signup/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN/)

* [Sign In](/accounts/login/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN/)
* [Sign Up](/accounts/signup/?next=/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/message/OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN/)

* [Manage this list](/postorius/lists/mediawiki-announce.lists.wikimedia.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2025/1/)

### 2024

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2024/1/)

### 2023

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2023/1/)

### 2022

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2022/1/)

### 2021

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2021/1/)

### 2020

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2020/1/)

### 2019

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2019/1/)

### 2018

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2018/1/)

### 2017

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2017/1/)

### 2016

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2016/1/)

### 2015

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2015/1/)

### 2014

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2014/1/)

### 2013

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2013/1/)

### 2012

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2012/1/)

### 2011

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2011/1/)

### 2010

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2010/1/)

### 2009

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2009/1/)

### 2008

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2008/1/)

### 2007

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2007/1/)

### 2006

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2006/1/)

### 2005

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/12/)
* [November](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/11/)
* [October](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/10/)
* [September](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/9/)
* [August](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/8/)
* [July](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/7/)
* [June](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/6/)
* [May](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/5/)
* [April](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/4/)
* [March](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/3/)
* [February](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/2/)
* [January](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2005/1/)

### 2004

* [December](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/2004/12/)

[List overview](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/)

[Download](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/export/mediawiki-announce%40lists.wikimedia.org-OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN.mbox.gz?message=OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN "This message in gzipped mbox format")

[thread](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/thread/OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN/#OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN)

# [MediaWiki-announce] MediaWiki Security and Maintenance Releases: 1.19.24, 1.23.9, and 1.24.2

[Chris Steipp](/hyperkitty/users/dd272b532a8d4667a37daa128483ef95/ "See the profile for Chris Steipp")

31 Mar
2015

31 Mar
'15

11:20 p.m.

I would like to announce the release of MediaWiki 1.24.2, 1.23.9 and
1.19.24. These releases fix 10 security issues, in addition to other bug
fixes. Download links are given at the end of this email.

== Security fixes ==

\* iSEC Partners discovered a way to circumvent the SVG MIME blacklist for
embedded resources (iSEC-WMF1214-11). This allowed an attacker to embed
JavaScript in the SVG. The issue was additionally identified by Mario
Heiderich / Cure53. MIME types are now whitelisted.
<https://phabricator.wikimedia.org/T85850>

\* MediaWiki user Bawolff pointed out that the SVG filter to prevent
injecting JavaScript using animate elements was incorrect.
<https://phabricator.wikimedia.org/T86711>

\* MediaWiki user Bawolff reported a stored XSS vulnerability due to the way
attributes were expanded in MediaWiki's Html class, in combination with
LanguageConverter substitutions.
<https://phabricator.wikimedia.org/T73394>

\* Internal review discovered that MediaWiki's SVG filtering could be
bypassed with entity encoding under the Zend interpreter. This could be
used to inject JavaScript. This issue was also discovered by Mario Gomes
from Beyond Security.
<https://phabricator.wikimedia.org/T88310>

\* iSEC Partners discovered a XSS vulnerability in the way api errors were
reflected when running under HHVM versions before 3.6.1 (iSEC-WMF1214-8).
MediaWiki now detects and mitigates this issue on older versions of HHVM.
<https://phabricator.wikimedia.org/T85851>

\* Internal review and iSEC Partners discovered (iSEC-WMF1214-1) that
MediaWiki versions using PBKDF2 for password hashing (the default since
1.24) are vulnerable to DoS attacks using extremely long passwords.
<https://phabricator.wikimedia.org/T64685>

\* iSEC Partners discovered that MediaWiki's SVG and XMP parsing, running
under HHVM, was susceptible to "Billion Laughs" DoS attacks
(iSEC-WMF1214-13).
<https://phabricator.wikimedia.org/T85848>

\* Internal review found that MediaWiki is vulnerable to "Quadratic Blowup"
DoS attacks, under both HHVM and Zend PHP.
<https://phabricator.wikimedia.org/T71210>

\* iSEC Partners discovered a way to bypass the style filtering for SVG
files (iSEC-WMF1214-3). This could violate the anonymity of users viewing
the SVG.
<https://phabricator.wikimedia.org/T85349>

\* iSEC Partners reported that the MediaWiki feature allowing a user to
preview another user's custom JavaScript could be abused for privilege
escalation (iSEC-WMF1214-10). This feature has been removed.
<https://phabricator.wikimedia.org/T85855>

Additionally, the following extensions have been updated to fix security
issues:

\* Extension:Scribunto - MediaWiki user Jackmcbarn discovered that function
names were not sanitized in Lua error backtraces, which could lead to XSS.
<https://phabricator.wikimedia.org/T85113>

\* Extension:CheckUser - iSEC Partners discovered that the CheckUser
extension did not prevent CSRF attacks on the form allowing checkusers to
look up sensitive information about other users (iSEC-WMF1214-6). Since the
use of CheckUser is logged, the CSRF could be abused to defame a trusted
user or flood the logs with noise.
<https://phabricator.wikimedia.org/T85858>

== Bug fixes ==

=== 1.24 ===

\* Fix case of SpecialAllPages/SpecialAllMessages in SpecialPageFactory to
fix loading these special pages when $wgAutoloadAttemptLowercase is false.
\* (bug T76254) Fix deleting of pages with PostgreSQL. Requires a schema
change and running update.php to fix.

== 1.23 & 1.24 ==

\* (bug T70087) Fix Special:ActiveUsers page for installations using
PostgreSQL.

\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

Full release notes:
<https://www.mediawiki.org/wiki/Release_notes/1.24>
<https://www.mediawiki.org/wiki/Release_notes/1.23>
<https://www.mediawiki.org/wiki/Release_notes/1.19>

Download:
<http://download.wikimedia.org/mediawiki/1.24/mediawiki-1.24.2.tar.gz>
<http://download.wikimedia.org/mediawiki/1.23/mediawiki-1.23.9.tar.gz>
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.24.tar.gz>

Patch to previous version:
<http://download.wikimedia.org/mediawiki/1.24/mediawiki-1.24.2.patch.gz>
<http://download.wikimedia.org/mediawiki/1.23/mediawiki-1.23.9.patch.gz>
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.24.patch.gz>

GPG signatures:
<http://download.wikimedia.org/mediawiki/1.24/mediawiki-1.24.2.tar.gz.sig>
<http://download.wikimedia.org/mediawiki/1.24/mediawiki-1.24.2.patch.gz.sig>
<http://download.wikimedia.org/mediawiki/1.23/mediawiki-1.23.9.tar.gz.sig>
<http://download.wikimedia.org/mediawiki/1.23/mediawiki-1.23.9.patch.gz.sig>
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.24.tar.gz.sig>
<http://download.wikimedia.org/mediawiki/1.19/mediawiki-1.19.24.patch.gz.sig>

Extensions:
[http://www.mediawiki.org/wiki/Extension:Scribunto](http://www.mediawiki.org/wiki/Extension%3AScribunto)
[http://www.mediawiki.org/wiki/Extension:CheckUser](http://www.mediawiki.org/wiki/Extension%3ACheckUser)

Public keys:
<https://www.mediawiki.org/keys/keys.html>

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/thread/OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN/#OTOGQLR6TBG7FPQ2OKWLZ4LKLLR5UAKN)

[Back to the list](/hyperkitty/list/mediawiki-announce%40lists.wikimedia.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.


