=== Content from www.h-fj.com_a66eb41c_20250126_000147.html ===


Toggle navigation

[H.Fujimoto](https://www.h-fj.com/)

* [Blog](https://www.h-fj.com/blog/)
* [MT Plugins](https://www.h-fj.com//mtplugins/)
* [Contact](https://www.h-fj.com/mailform.php)

[The blog of H.Fujimoto](https://www.h-fj.com/blog/)

Personal Computer, Financial Planning, etc...

* [Home](https://www.h-fj.com/)
* [The blog of H.Fujimoto](https://www.h-fj.com/blog/)
* mt-phpincgi.phpセキュリティアップデート

2024年2月1日 拙作プラグインの譲渡について

拙作のMovable Typeのプラグインを、[株式会社ワールドイズマインに譲渡](https://www.wim.jp/news/2024/02/fujimoto-wim.html)いたしました。
長きにわたり拙作のプラグインをご愛顧いただき、ありがとうございました。

## お知らせ

* 2014年7月 5日

[![wpphp01.jpg](https://www.h-fj.com/recommend_info/pic/wpphp01.jpg "wpphp01.jpg")](http://www.amazon.co.jp/exec/obidos/ASIN/B00LKATFSM/hajimefujimos-22/ref%3Dnosim/)

「[WordPressで学ぶPHP(1)変数・制御構造編](http://www.amazon.co.jp/exec/obidos/ASIN/B00LKATFSM/hajimefujimos-22/ref%3Dnosim/)」が発売されました。

「WordPressで学ぶPHP」シリーズの第1巻で、WordPressを通してPHPを学んでいく本です。

この本では、PHPの基本となる変数と制御構造について解説します。

Kindle本で、定価500円です。

# mt-phpincgi.phpセキュリティアップデート

* 投稿日:2015年5月15日
* by [壱](https://www.h-fj.com/blog/)
* カテゴリ: [カスタマイズ・TIPS](https://www.h-fj.com/blog/archives/pc/movabletype/customize/)

当ブログで公開していたmt-phpincgi.php(コメント／検索テンプレートのPHP化用スクリプト)に対し、脆弱性のご指摘をいただきました。

修正版を公開しますので、mt-phpincgi.phpをご利用の方は、早急にアップデートしていただきますようお願いいたします。

ご迷惑をおかけして大変申し訳ありません。

## 1.脆弱性の概要

mt-phpincgi.phpを通して、任意のサーバ上にあるPHPのコードを実行され得ます。

ファイル改ざんや奪取、またバックドア設置などに悪用される可能性があります。

## 2.対策版のダウンロード

対策版のコードは以下からダウンロードします。

[mt-phpincgi.txt](https://www.h-fj.com/mt_plugins/mt-phpincgi.txt)

## 3.アクセス可能URLの設定

ファイルをダウンロードしたら、mt-phpincgi.phpでアクセス可能なURLを設定します。

ダウンロードしたファイルをテキストエディタで開き、最初の方にある「http://www.foo.com/bar/mt-comments.cgi」と「http://www.foo.com/bar/mt-search.cgi」を、ご自分のMovable Typeのmt-comments.cgiとmt-search.cgiのアドレスに書き換えます。

そして、ファイル名を「mt-phpincgi.php」にして保存し、ご自分のサーバーのMovable Typeのインストール先ディレクトリにアップロードします。

## 4.一時ファイル出力用ディレクトリの設定

一時ファイル出力用ディレクトリ（mt-phpincgi.phpファイルと同じディレクトリに作る「cgitmp」ディレクトリ）に対して、HTTPでのアクセスを禁止します。

サーバーがApacheであれば、cgitmpディレクトリの直下に以下のような.htaccessファイルを設置します。

```

order deny,allow
deny from all

```

また、cgitmpディレクトリにファイルが残っている場合は、それらのファイルを削除してください。

* [前の記事](https://www.h-fj.com/blog/archives/2015/05/13-140305.php "管理画面左上のメニューで表示されるブログ／ウェブサイトの数を変える")
* [次の記事](https://www.h-fj.com/blog/archives/2015/05/18-103338.php "FreeLayoutCustomFieldプラグイン1.10＆拡張パック1.00リリース")

### 検索

サイト全体
Movable Type Plugins
The blog of H.Fujimoto

検索

### おすすめ

[![](https://www26.a8.net/svt/bgt?aid=150622692075&wid=002&eno=01&mid=s00000003166001014000&mc=1)](https://px.a8.net/svt/ejp?a8mat=2HOD7O+18NJX6+OFG+61C2P)
![](https://www15.a8.net/0.gif?a8mat=2HOD7O+18NJX6+OFG+61C2P)

### カテゴリ

* パソコン
  + [全般 (26)](https://www.h-fj.com/blog/archives/pc/general/)
  + [ハードウェア (178)](https://www.h-fj.com/blog/archives/pc/hardware/)
  + [ソフトウェア (134)](https://www.h-fj.com/blog/archives/pc/software/)
  + [インターネット (235)](https://www.h-fj.com/blog/archives/pc/internet/)
    - [HTML5 (16)](https://www.h-fj.com/blog/archives/pc/internet/html5/)
      * [API (2)](https://www.h-fj.com/blog/archives/pc/internet/html5/api/)
    - [Facebook (4)](https://www.h-fj.com/blog/archives/pc/internet/facebook/)
      * [開発 (47)](https://www.h-fj.com/blog/archives/pc/internet/facebook/development/)
      * [Facebookページ (36)](https://www.h-fj.com/blog/archives/pc/internet/facebook/facebook-1/)
      * [TIPS (6)](https://www.h-fj.com/blog/archives/pc/internet/facebook/tips/)
    - [ロケタッチ (5)](https://www.h-fj.com/blog/archives/pc/internet/loctouch/)
  + [プログラミング (70)](https://www.h-fj.com/blog/archives/pc/cat49/)
    - [Xamarin (12)](https://www.h-fj.com/blog/archives/pc/cat49/xamarin/)
      * 入門
    - [JavaScript (2)](https://www.h-fj.com/blog/archives/pc/cat49/javascript/)
    - [Node.js (10)](https://www.h-fj.com/blog/archives/pc/cat49/nodejs/)
  + [YouTube (1)](https://www.h-fj.com/blog/archives/pc/youtube/)
  + [モバイル (57)](https://www.h-fj.com/blog/archives/pc/mobile/)
  + [工作系 (1)](https://www.h-fj.com/blog/archives/pc/craft/)
    - [3Dプリンタ (12)](https://www.h-fj.com/blog/archives/pc/craft/3d/)
    - [はじめての電子工作 (13)](https://www.h-fj.com/blog/archives/pc/craft/basic/)
    - [Raspberry Pi (14)](https://www.h-fj.com/blog/archives/pc/craft/raspberry-pi/)
    - [Arduino (23)](https://www.h-fj.com/blog/archives/pc/craft/arduino/)
    - [Tinker Board (9)](https://www.h-fj.com/blog/archives/pc/craft/tinker-board/)
    - [ロボット (1)](https://www.h-fj.com/blog/archives/pc/craft/robot/)
  + [電子出版 (31)](https://www.h-fj.com/blog/archives/pc/epublishing/ "電子出版についての記事です")
  + Movable Type
    - [自作プラグイン (752)](https://www.h-fj.com/blog/archives/pc/movabletype/myplugin/)
    - [カスタマイズ・TIPS (286)](https://www.h-fj.com/blog/archives/pc/movabletype/customize/)
    - [プラグイン紹介 (40)](https://www.h-fj.com/blog/archives/pc/movabletype/plugin-intro/)
    - [Data API (26)](https://www.h-fj.com/blog/archives/pc/movabletype/data-api/)
    - [テーマ (7)](https://www.h-fj.com/blog/archives/pc/movabletype/cat78/)
    - [イベント (366)](https://www.h-fj.com/blog/archives/pc/movabletype/cat51/)
    - [MTでPerlを学ぶ (17)](https://www.h-fj.com/blog/archives/pc/movabletype/mtperl/)
    - [MTの将来を考える (10)](https://www.h-fj.com/blog/archives/pc/movabletype/future-mt/ "MTの将来を考える記事を集めたカテゴリです。")
    - [各種情報 (421)](https://www.h-fj.com/blog/archives/pc/movabletype/info/)
  + WordPress
    - [自作プラグイン (11)](https://www.h-fj.com/blog/archives/pc/wordpress/myplugin/)
    - [カスタマイズ・TIPS (13)](https://www.h-fj.com/blog/archives/pc/wordpress/customize/)
    - [プラグイン紹介 (4)](https://www.h-fj.com/blog/archives/pc/wordpress/plugin-intro/)
    - [イベント (46)](https://www.h-fj.com/blog/archives/pc/wordpress/event/)
    - [各種情報 (56)](https://www.h-fj.com/blog/archives/pc/wordpress/info/)
  + [Serene Bach (20)](https://www.h-fj.com/blog/archives/pc/serenebach/)
  + CMS
    - [a-blog cms (10)](https://www.h-fj.com/blog/archives/pc/cms/a-blog-cms/ "a-blog cmsに関する情報です")
    - [SOY CMS (8)](https://www.h-fj.com/blog/archives/pc/cms/soy-cms/)
    - [MODx (2)](https://www.h-fj.com/blog/archives/pc/cms/modx/ "MODxに関する情報です")
    - [RCMS (2)](https://www.h-fj.com/blog/archives/pc/cms/rcms/)
    - [各種情報 (15)](https://www.h-fj.com/blog/archives/pc/cms/cat65/)
  + [Ajax (18)](https://www.h-fj.com/blog/archives/pc/ajax/)
  + [ネットでお小遣い (9)](https://www.h-fj.com/blog/archives/pc/netmoney/)
  + [ブログ一般 (82)](https://www.h-fj.com/blog/archives/pc/blog/)
  + [ブログパーツ (57)](https://www.h-fj.com/blog/archives/pc/bpc/)
    - [Sidebar Widget Changer (9)](https://www.h-fj.com/blog/archives/pc/bpc/swc/)
* FP
  + [全般 (53)](https://www.h-fj.com/blog/archives/fp/general/)
  + [預貯金 (15)](https://www.h-fj.com/blog/archives/fp/saving/)
  + [株式・投資 (350)](https://www.h-fj.com/blog/archives/fp/invest/)
  + [ローン・クレジット (4)](https://www.h-fj.com/blog/archives/fp/roan/)
  + [ライフプラン (3)](https://www.h-fj.com/blog/archives/fp/lifeplan/)
  + [不動産 (1)](https://www.h-fj.com/blog/archives/fp/real-estate/)
  + [公的年金・社会保険 (15)](https://www.h-fj.com/blog/archives/fp/pension/)
  + [生命保険・損害保険 (13)](https://www.h-fj.com/blog/archives/fp/insurance/)
  + [税金 (32)](https://www.h-fj.com/blog/archives/fp/tax/)
  + [問題・事件 (9)](https://www.h-fj.com/blog/archives/fp/matter/)
* 群馬
  + [全般 (20)](https://www.h-fj.com/blog/archives/gunma/general/)
  + [言葉 (6)](https://www.h-fj.com/blog/archives/gunma/word/)
  + [文化 (12)](https://www.h-fj.com/blog/archives/gunma/culture/)
  + [温泉・浴場 (12)](https://www.h-fj.com/blog/archives/gunma/spa/)
  + [観光・旅行 (27)](https://www.h-fj.com/blog/archives/gunma/sightseeing/)
  + [名産 (3)](https://www.h-fj.com/blog/archives/gunma/cat71/)
  + [食べ物 (5)](https://www.h-fj.com/blog/archives/gunma/foods/)
  + [その他 (39)](https://www.h-fj.com/blog/archives/gunma/others/)
* 趣味
  + [音楽 (70)](https://www.h-fj.com/blog/archives/hobby/music/)
  + [鉄道 (47)](https://www.h-fj.com/blog/archives/hobby/railroad/)
  + [作品 (2)](https://www.h-fj.com/blog/archives/hobby/works/)
  + [お酒 (5)](https://www.h-fj.com/blog/archives/hobby/liquor/)
* その他
  + [全般 (38)](https://www.h-fj.com/blog/archives/others/general/)
  + [新刊・掲載 (151)](https://www.h-fj.com/blog/archives/others/newbook/)
  + [各種情報 (48)](https://www.h-fj.com/blog/archives/others/information/)
  + [日記 (234)](https://www.h-fj.com/blog/archives/others/diary/)
  + [お知らせ (52)](https://www.h-fj.com/blog/archives/others/cat52/)

### アーカイブ

月を選択...
2022年5月(1)
2020年11月(1)
2020年10月(1)
2020年9月(4)
2020年8月(2)
2020年7月(4)
2020年6月(5)
2020年5月(2)
2020年4月(2)
2020年3月(3)
2020年2月(8)
2020年1月(11)
2019年12月(1)
2019年9月(1)
2019年5月(1)
2019年4月(2)
2019年1月(4)
2018年12月(4)
2018年11月(5)
2018年10月(13)
2018年9月(3)
2018年8月(2)
2018年7月(9)
2018年6月(4)
2018年5月(9)
2018年4月(4)
2018年3月(8)
2018年2月(1)
2018年1月(3)
2017年12月(3)
2017年11月(4)
2017年10月(9)
2017年9月(2)
2017年8月(14)
2017年7月(3)
2017年6月(4)
2017年5月(5)
2017年4月(12)
2017年3月(12)
2017年2月(9)
2017年1月(4)
2016年12月(10)
2016年11月(4)
2016年10月(4)
2016年9月(4)
2016年8月(7)
2016年7月(5)
2016年6月(7)
2016年5月(9)
2016年4月(12)
2016年3月(10)
2016年2月(12)
2016年1月(11)
2015年12月(10)
2015年11月(15)
2015年10月(18)
2015年9月(16)
2015年8月(15)
2015年7月(21)
2015年6月(13)
2015年5月(12)
2015年4月(10)
2015年3月(15)
2015年2月(18)
2015年1月(19)
2014年12月(19)
2014年11月(15)
2014年10月(19)
2014年9月(22)
2014年8月(26)
2014年7月(21)
2014年6月(20)
2014年5月(20)
2014年4月(21)
2014年3月(24)
2014年2月(23)
2014年1月(21)
2013年12月(24)
2013年11月(22)
2013年10月(27)
2013年9月(26)
2013年8月(26)
2013年7月(27)
2013年6月(30)
2013年5月(25)
2013年4月(29)
2013年3月(24)
2013年2月(22)
2013年1月(28)
2012年12月(29)
2012年11月(29)
2012年10月(27)
2012年9月(24)
2012年8月(27)
2012年7月(23)
2012年6月(22)
2012年5月(22)
2012年4月(27)
2012年3月(30)
2012年2月(27)
2012年1月(30)
2011年12月(30)
2011年11月(30)
2011年10月(31)
2011年9月(30)
2011年8月(32)
2011年7月(31)
2011年6月(32)
2011年5月(32)
2011年4月(30)
2011年3月(32)
2011年2月(28)
2011年1月(31)
2010年12月(32)
2010年11月(30)
2010年10月(31)
2010年9月(31)
2010年8月(31)
2010年7月(31)
2010年6月(30)
2010年5月(31)
2010年4月(31)
2010年3月(31)
2010年2月(28)
2010年1月(32)
2009年12月(35)
2009年11月(32)
2009年10月(32)
2009年9月(30)
2009年8月(31)
2009年7月(31)
2009年6月(33)
2009年5月(31)
2009年4月(30)
2009年3月(32)
2009年2月(29)
2009年1月(30)
2008年12月(35)
2008年11月(31)
2008年10月(32)
2008年9月(30)
2008年8月(36)
2008年7月(33)
2008年6月(31)
2008年5月(31)
2008年4月(32)
2008年3月(31)
2008年2月(29)
2008年1月(35)
2007年12月(36)
2007年11月(30)
2007年10月(31)
2007年9月(30)
2007年8月(35)
2007年7月(31)
2007年6月(33)
2007年5月(33)
2007年4月(31)
2007年3月(31)
2007年2月(29)
2007年1月(34)
2006年12月(31)
2006年11月(30)
2006年10月(31)
2006年9月(30)
2006年8月(31)
2006年7月(31)
2006年6月(30)
2006年5月(31)
2006年4月(30)
2006年3月(31)
2006年2月(28)
2006年1月(31)
2005年12月(32)
2005年11月(37)
2005年10月(31)
2005年9月(33)
2005年8月(33)
2005年7月(31)
2005年6月(33)
2005年5月(33)
2005年4月(36)
2005年3月(29)
2005年2月(24)
2005年1月(18)
2004年12月(13)
2004年11月(11)
2004年10月(6)
2004年9月(1)

![購読する](https://www.h-fj.com/czr/mt-static/images/status_icons/feed.gif)

© Copyright 2024 by H.Fujimoto



=== Content from jvndb.jvn.jp_1730444d_20250126_000143.html ===


![JVN iPedia](/en/common/img/en_logo.gif)
Last Updated:2015/05/28

| [[Japanese]](/ja/contents/2015/JVNDB-2015-000067.html) | |
| --- | --- |
| JVNDB-2015-000067 | |
| mt-phpincgi vulnerable to PHP object injection | |
| Overview | |
| mt-phpincgi is script that runs Movable Type templates as PHP. mt-phpincgi contains a PHP object Injection vulnerability. | |
| CVSS Severity ([What is CVSS?](/en/nav/jvndbhelp.html#jvndb3)) | |
| **CVSS V2 Severity:Base Metrics [7.5](/cvss/en/v2.html#AV:N/AC:L/Au:N/C:P/I:P/A:P) (High) [IPA Score]**  * Access Vector: Network * Access Complexity: Low * Authentication: None * Confidentiality Impact: Partial * Integrity Impact: Partial * Availability Impact: Partial | |
| Affected Products | |
|  | |
| Ichi Fujimoto  * mt-phpincgi | |
| This vulnerability has been addressed in [mt-phpincgi.php security update](http://www.h-fj.com/blog/archives/2015/05/15-112843.php) (in Japanese) released on 2015/05/15. | |
| Impact | |
| Arbitrary PHP code may be executed on the server by an unauthenticated attacker. | |
| Solution | |
| [Apply the update] | |
| Vendor Information | |
| Ichi Fujimoto  * The blog of H.Fujimoto : [Hajime Fujimoto website](http://www.h-fj.com/blog/) (in Japanese) * The blog of H.Fujimoto : [mt-phpincgi.php security update](http://www.h-fj.com/blog/archives/2015/05/15-112843.php) (in Japanese) | |
| CWE ([What is CWE?](http://www.ipa.go.jp/security/english/vuln/CWE_en.html)) | |
| 1. [Code Injection](http://www.ipa.go.jp/security/english/vuln/CWE_en.html#CWE94)(CWE-94) [IPA Evaluation] | |
| CVE ([What is CVE?](http://www.ipa.go.jp/security/english/vuln/CVE_en.html)) | |
| 1. [CVE-2015-2945](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2945) | |
| References | |
| 1. JVN : [JVN#64459670](http://jvn.jp/en/jp/JVN64459670/index.html) 2. National Vulnerability Database (NVD) : [CVE-2015-2945](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-2945) 3. IPA SECURITY ALERTS : [Security Alert for Vulnerability in mt-phpincgi (JVN#64459670)](https://www.ipa.go.jp/security/ciadr/vul/20150520-jvn.html) (in Japanese) | |
| Revision History | |
| * [2015/05/20] | |

| --- | |
| --- | --- |
| Date Public | 2015/05/20 |
| Date First Published | 2015/05/20 |
| Date Last Updated | 2015/05/28 |
| --- | |

* JVN
* [HOME](http://jvn.jp/en/)
* [What is JVN ?](http://jvn.jp/en/nav/jvn.html)
* [Instructions](http://jvn.jp/en/nav/jvnhelp.html)
* [List of Vulnerability Report](http://jvn.jp/en/report/index.html)
* [VN\_JP](http://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](http://jvn.jp/en/adj/index.html)
* [VN\_VU](http://jvn.jp/en/vu/index.html)
* [TA](http://jvn.jp/en/ta/index.html)
* [TRnotes](http://jvn.jp/en/tr/index.html)
* [JVN iPedia](/en/)
* [Search](/search/index.php?mode=_vulnerability_search_IA_VulnSearch&lang=en)
* [What is JVN iPedia?](/en/nav/jvndb.html)
* [How to Use?](/en/nav/jvndbhelp.html)
* [MyJVN](/en/apis/myjvn/index.html)
* [JVNJS/RSS](http://jvn.jp/en/rss/index.html)
* [Vendor List](http://jvn.jp/en/nav/index.html)
* [List of unreachable developers](http://jvn.jp/en/reply/index.html)
* [Contact](http://jvn.jp/en/contact/index.html)

![Copyright © 2007- IPA. All rights reserved.](/common/img/copyright.png)



=== Content from jvn.jp_52e31943_20250126_000140.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2015/05/20  Last Updated:2015/05/22
# JVN#64459670 mt-phpincgi vulnerable to PHP object injection

## Overview

mt-phpincgi contains a PHP object Injection vulnerability.

## Products Affected

* mt-phpincgi

This vulnerability has been addressed in [mt-phpincgi.php security update](http://www.h-fj.com/blog/archives/2015/05/15-112843.php) released on 2015/05/15.

## Description

mt-phpincgi is script that runs Movable Type templates as PHP. mt-phpincgi contains a PHP object Injection vulnerability.

According to the reporter, attacks that attempt to exploit this vulnerability have been confirmed.

## Impact

Arbitrary PHP code may be executed on the server by an unauthenticated attacker.

## Solution

**Apply the update**

The developer has released an update at [mt-phpincgi.php security update](http://www.h-fj.com/blog/archives/2015/05/15-112843.php).

Apply the update according to the information provided by the developer.

## Vendor Status

| Vendor | Status | Last Update | Vendor Notes |
| --- | --- | --- | --- |
| Hajime Fujimoto | [Vulnerable](995237/index.html) | 2015/05/20 | [Hajime Fujimoto website](http://www.h-fj.com/blog/) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

**Analyzed on 2015.05.20 (CVSS Base Metrics)**

[What is CVSS?](/en/nav/jvnhelp.html#cvssv2)

| Measures | Severity | | | Description |
| Access Vector(AV) | Local (L) | Adjacent Network (A) | Network (N) | A vulnerability exploitable with network access means the vulnerable software is bound to the network stack and the attacker does not require local network access or local access. Such a vulnerability is often termed "remotely exploitable". |
| Access Complexity(AC) | High (H) | Medium (M) | Low (L) | Specialized access conditions or extenuating circumstances do not exist. |
| Authentication(Au) | Multiple (M) | Single (S) | None (N) | Authentication is not required to exploit the vulnerability. |
| Confidentiality Impact(C) | None (N) | Partial (P) | Complete (C) | There is considerable informational disclosure. Access to some system files is possible, but the attacker does not have control over what is obtained, or the scope of the loss is constrained. |
| Integrity Impact(I) | None (N) | Partial (P) | Complete (C) | Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited. |
| Availability Impact(A) | None (N) | Partial (P) | Complete (C) | There is reduced performance or interruptions in resource availability. |

Base Score:7.5

## Credit

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2015-2945](//cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-2945) |
| JVN iPedia | [JVNDB-2015-000067](http://jvndb.jvn.jp/jvndb/JVNDB-2015-000067) |

## Update History

2015/05/22
Fixed wording error under "Solution".

* JVN
* HOME
* What is JVN ?
* Instructions
* List of Vulnerability Report
* [VN\_JP](http://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](http://jvn.jp/en/adj/index.html)
* [VN\_VU](http://jvn.jp/en/vu/index.html)
* [TA](http://jvn.jp/en/ta/index.html)
* TRnotes
* JVN iPedia
* MyJVN
* JVNJS/RSS
* Vendor List
* List of unreachable developers
* Contact

Copyright (c) 2000-2015 JPCERT/CC and IPA. All rights reserved.


