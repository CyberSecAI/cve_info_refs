=== Content from bugs.debian.org_ccdbbe93_20250124_180104.html ===

# Debian Bug report logs - #780566 capnproto: CVE-2015-2311: Integer underflow in pointer validation

[![version graph](version.cgi?fixed=capnproto%2F0.4.1-3;height=2;package=capnproto;absolute=0;collapse=1;width=2;found=capnproto%2F0.4.1-2)](version.cgi?package=capnproto;absolute=0;collapse=1;found=capnproto%2F0.4.1-2;info=1;fixed=capnproto%2F0.4.1-3)

Package:
[capnproto](pkgreport.cgi?package=capnproto);
Maintainer for [capnproto](pkgreport.cgi?package=capnproto) is [Tom Lee <debian@tomlee.co>](pkgreport.cgi?maint=debian%40tomlee.co); Source for [capnproto](pkgreport.cgi?package=capnproto) is [src:capnproto](pkgreport.cgi?src=capnproto) ([PTS](https://tracker.debian.org/pkg/capnproto), [buildd](https://buildd.debian.org/capnproto), [popcon](https://qa.debian.org/popcon.php?package=capnproto)).

Reported by: [Tom Lee <debian@tomlee.co>](pkgreport.cgi?submitter=debian%40tomlee.co)

Date: Mon, 16 Mar 2015 04:45:02 UTC

Severity: *grave*

Tags: security

Found in version capnproto/0.4.1-2

Fixed in version capnproto/0.4.1-3

**Done:** Tom Lee <debian@tomlee.co>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=780566;mbox=yes), [status mbox](bugreport.cgi?bug=780566;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=780566;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#780566`; Package `capnproto`.
(Mon, 16 Mar 2015 04:45:06 GMT) ([full text](bugreport.cgi?bug=780566;msg=2), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Tom Lee <debian@tomlee.co>`:

New Bug report received and forwarded.
(Mon, 16 Mar 2015 04:45:06 GMT) ([full text](bugreport.cgi?bug=780566;msg=4), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=780566;msg=5), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40tomlee.co)
From: Tom Lee <debian@tomlee.co>
To: submit@bugs.debian.org
Subject: Integer underflow in pointer validation
Date: Sun, 15 Mar 2015 21:43:13 -0700
```
[[Message part 1](bugreport.cgi?att=0;bug=780566;msg=5) (text/plain, inline)]
```
```
Package: capnproto
Version: 0.4.1-2
Severity: critical

Upstream has reported a number of security issues in capnproto 0.4.1.
Creating bugs to track these issues while I work on getting them fixed.

This bug is tracking the "Integer underflow in pointer validation" bug
reported on 2015-03-02.

Full details + patch:
<https://github.com/sandstorm-io/capnproto/blob/master/security-advisories/2015-03-02-1-c%2B%2B-integer-underflow.md>

--
*Tom Lee */ <http://tomlee.co> / @tglee <<http://twitter.com/tglee>>

```
```
[[Message part 2](bugreport.cgi?att=1;bug=780566;msg=5) (text/html, inline)]
```

---

**Added tag(s) security.**
Request was from `Paul Wise <pabs@debian.org>`
to `control@bugs.debian.org`.
(Mon, 16 Mar 2015 05:00:05 GMT) ([full text](bugreport.cgi?bug=780566;msg=7), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=7), [link](#6)).

---

**Changed Bug title to 'capnproto: CVE-2015-2311: Integer underflow in pointer validation' from 'Integer underflow in pointer validation'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Tue, 17 Mar 2015 05:06:09 GMT) ([full text](bugreport.cgi?bug=780566;msg=9), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=9), [link](#8)).

---

**Severity set to 'grave' from 'critical'**
Request was from `Tom Lee <debian@tomlee.co>`
to `control@bugs.debian.org`.
(Wed, 18 Mar 2015 03:27:10 GMT) ([full text](bugreport.cgi?bug=780566;msg=11), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=11), [link](#10)).

---

**Reply sent**
to `Tom Lee <debian@tomlee.co>`:

You have taken responsibility.
(Sat, 28 Mar 2015 10:06:15 GMT) ([full text](bugreport.cgi?bug=780566;msg=13), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=13), [link](#12)).

---

**Notification sent**
to `Tom Lee <debian@tomlee.co>`:

Bug acknowledged by developer.
(Sat, 28 Mar 2015 10:06:15 GMT) ([full text](bugreport.cgi?bug=780566;msg=15), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=15), [link](#14)).

---

[Message #16](#16) received at 780566-close@bugs.debian.org ([full text](bugreport.cgi?bug=780566;msg=16), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=16), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40tomlee.co)
From: Tom Lee <debian@tomlee.co>
To: 780566-close@bugs.debian.org
Subject: Bug#780566: fixed in capnproto 0.4.1-3
Date: Sat, 28 Mar 2015 10:04:31 +0000
```
Source: capnproto
Source-Version: 0.4.1-3

We believe that the bug you reported is fixed in the latest version of
capnproto, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 780566@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Tom Lee <debian@tomlee.co> (supplier of updated capnproto package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Tue, 17 Mar 2015 19:53:24 -0800
Source: capnproto
Binary: libcapnp-0.4.1 libcapnp-dev capnproto
Architecture: source amd64
Version: 0.4.1-3
Distribution: unstable
Urgency: high
Maintainer: Tom Lee <debian@tomlee.co>
Changed-By: Tom Lee <debian@tomlee.co>
Description:
 capnproto  - tool for working with the Cap'n Proto data interchange format
 libcapnp-0.4.1 - Cap'n Proto C++ library
 libcapnp-dev - Cap'n Proto C++ library (development files)
Closes: [780565](bugreport.cgi?bug=780565) [780566](bugreport.cgi?bug=780566) [780567](bugreport.cgi?bug=780567) [780568](bugreport.cgi?bug=780568)
Changes:
 capnproto (0.4.1-3) unstable; urgency=high
 .
   * Fix [CVE-2015-2310](https://security-tracker.debian.org/tracker/CVE-2015-2310): Integer overflow in pointer validation (Closes: [780565](bugreport.cgi?bug=780565))
   * Fix [CVE-2015-2311](https://security-tracker.debian.org/tracker/CVE-2015-2311): Integer underflow in pointer validation (Closes: [780566](bugreport.cgi?bug=780566))
   * Fix [CVE-2015-2312](https://security-tracker.debian.org/tracker/CVE-2015-2312): CPU usage amplification attack (Closes: [780567](bugreport.cgi?bug=780567))
   * Fix [CVE-2015-2313](https://security-tracker.debian.org/tracker/CVE-2015-2313): CPU usage amplification attack #2 (Closes: [780568](bugreport.cgi?bug=780568))
Checksums-Sha1:
 bfe5a1cea8070a5dee0121ecd7068e87ef7f6c9d 2054 capnproto_0.4.1-3.dsc
 2f251b205c665c7b72817ae6d4c52f047f5c0282 10984 capnproto_0.4.1-3.debian.tar.xz
 9cde11cd029b8767494d450fb4979853af4bcbaa 526256 libcapnp-0.4.1_0.4.1-3_amd64.deb
 2da025c247379fdb44705116e11a921b65bcfe69 745964 libcapnp-dev_0.4.1-3_amd64.deb
 9ef5ca198cad87de6501049ca92ddf4ec44ac910 170350 capnproto_0.4.1-3_amd64.deb
Checksums-Sha256:
 32f86d39b12d26d0edeb36a8df51ce4be6a431f579f6b415edeb9b9900d5d300 2054 capnproto_0.4.1-3.dsc
 d2855bd37291847b7dea7a9d0c9aa632088da6ec16a038ece0ba403d4b12cfe5 10984 capnproto_0.4.1-3.debian.tar.xz
 0cc882278276f9c09eb7bcec86e5f9a35f5896f78a5595d1b87df17eeeb4608b 526256 libcapnp-0.4.1_0.4.1-3_amd64.deb
 1054d6f3d786748edd83fb59a0c840a7f03212b44c9137aee51108fd2fd228b7 745964 libcapnp-dev_0.4.1-3_amd64.deb
 22b6714c52a57d29670320c0746e6f68627f1dc963e16edcbf5d1ee15befa0b8 170350 capnproto_0.4.1-3_amd64.deb
Files:
 eb595ceebeb49db8ecdd480acebc34f0 2054 devel optional capnproto_0.4.1-3.dsc
 41613a343a27107b43f7cc7d4439601c 10984 devel optional capnproto_0.4.1-3.debian.tar.xz
 96655f2e7aeb70fe31105e401dbb0547 526256 libs optional libcapnp-0.4.1_0.4.1-3_amd64.deb
 0ae5bbd903cab58907f25d1e798c6d36 745964 libdevel optional libcapnp-dev_0.4.1-3_amd64.deb
 43056c2e59c9ada3d7999d585593d2ab 170350 devel optional capnproto_0.4.1-3_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJVFlyVAAoJEJWkL+g1NSX51QgP/3+VZopWCBf4EVHsMnuuVvZP
iQ2DyQ7dLLzwsoRiipjd1dP22sfqH6JN0Ac1stPxkHS9vt4QO/sTYi4KoydM9Mp3
qbbEJt9ivGo4l/gEcDA9wKR0FV1V40KYy0WXHwvXK16s6t3VU14Caf3wt8zSnAxA
b4ZZDGac8LNrI5Q2cViGU11FRa16UuJVI4EfWhyPxsb9OxH+2bKlOwGCcTdnqXw1
tPZrMuFv88pWCG7G7H/vUazu4GJD/V3AsIqYRKdF1bIHVcLkfSKtasJ89c2GE3jm
urKCcdJs0UcjJRa3yAxUGPtCwerubfLxUyYVacciC0g5UcJgcfM+im8xbqT0h4CP
cYpGe2xs5thVo426tfoO/JBxqDKhf/2sQb63axOECmsHliRjgcQmHx9pz9Am/mIO
ZKKEvPq9DZNr2zhC/NG0kdMJDCYzDC2+Je0ttNbIXY98rKqeAe/u3h1ffaX2IN95
c56VA7Pjjto03Nqd0di4mudtSwNSwvJ8auiFqetRjfD+OZaJPyGEDBCN2wCDjU6u
Rsybuqx8v/j0B39E9yGcmzrxnaahm2jfFg1yy4GCob0txQ2eX4ukqwIdB8kZJjfK
8CKnjzpV4xSYrqcVnK8AS0UMiFkZ7owRNbW+G2zMGXy1O7uIj2ebb+mnzDEgkN+3
A717zs6cgpIwyHp+UAxu
=GxxL
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Mon, 11 May 2015 07:28:29 GMT) ([full text](bugreport.cgi?bug=780566;msg=18), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=18), [link](#17)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=780566).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Fri Jan 24 18:01:03 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from security-tracker.debian.org_b98fc416_20250126_024248.html ===

# CVE-2015-2310

| **Name** | CVE-2015-2310 |
| --- | --- |
| **Description** | Integer overflow in layout.c++ in Sandstorm Cap'n Proto before 0.4.1.1 and 0.5.x before 0.5.1.1 allows remote peers to cause a denial of service or possibly obtain sensitive information from memory via a crafted message, related to pointer validation. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2015-2310) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2015-2310); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2015-2310), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2015-2310), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2015-2310), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2015-2310), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-2310), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2015-2310), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2015-2310), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2015-2310)/[CVE](https://www.suse.com/security/cve/CVE-2015-2310/), GitHub [advisories](https://github.com/advisories?query=CVE-2015-2310)/[code](https://github.com/search?type=Code&q=%22CVE-2015-2310%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2015-2310%22), [web search](https://duckduckgo.com/html?q=%22CVE-2015-2310%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [780565](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=780565) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [capnproto](/tracker/source-package/capnproto) ([PTS](https://tracker.debian.org/pkg/capnproto)) | bullseye | 0.7.0-7 | fixed |
|  | bookworm | 0.9.2-2 | fixed |
|  | sid, trixie | 1.1.0-2 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [capnproto](/tracker/source-package/capnproto) | source | (unstable) | 0.4.1-3 |  |  | [780565](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=780565) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from github.com_61cf4904_20250124_180106.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapnproto%2Fcapnproto%2Fcommit%2F26bcceda72372211063d62aab7e45665faa83633)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapnproto%2Fcapnproto%2Fcommit%2F26bcceda72372211063d62aab7e45665faa83633)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=capnproto%2Fcapnproto)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[capnproto](/capnproto)
/
**[capnproto](/capnproto/capnproto)**
Public

* [Notifications](/login?return_to=%2Fcapnproto%2Fcapnproto) You must be signed in to change notification settings
* [Fork
  934](/login?return_to=%2Fcapnproto%2Fcapnproto)
* [Star
   11.9k](/login?return_to=%2Fcapnproto%2Fcapnproto)

* [Code](/capnproto/capnproto)
* [Issues
  180](/capnproto/capnproto/issues)
* [Pull requests
  71](/capnproto/capnproto/pulls)
* [Discussions](/capnproto/capnproto/discussions)
* [Actions](/capnproto/capnproto/actions)
* [Projects
  0](/capnproto/capnproto/projects)
* [Wiki](/capnproto/capnproto/wiki)
* [Security](/capnproto/capnproto/security)
* [Insights](/capnproto/capnproto/pulse)

Additional navigation options

* [Code](/capnproto/capnproto)
* [Issues](/capnproto/capnproto/issues)
* [Pull requests](/capnproto/capnproto/pulls)
* [Discussions](/capnproto/capnproto/discussions)
* [Actions](/capnproto/capnproto/actions)
* [Projects](/capnproto/capnproto/projects)
* [Wiki](/capnproto/capnproto/wiki)
* [Security](/capnproto/capnproto/security)
* [Insights](/capnproto/capnproto/pulse)

## Commit

[Permalink](/capnproto/capnproto/commit/26bcceda72372211063d62aab7e45665faa83633)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

SECURITY: Integer underflow in pointer validation.

[Browse files](/capnproto/capnproto/tree/26bcceda72372211063d62aab7e45665faa83633)
Browse the repository at this point in the history

```
Details: [https://github.com/sandstorm-io/capnproto/tree/master/security-advisories/2014-03-02-1-c++-integer-underflow.md](https://github.com/sandstorm-io/capnproto/tree/master/security-advisories/2014-03-02-1-c%2B%2B-integer-underflow.md)
```

* Loading branch information

[![@kentonv](https://avatars.githubusercontent.com/u/4001805?s=40&v=4)](/kentonv)

[kentonv](/capnproto/capnproto/commits?author=kentonv "View all commits by kentonv")
committed
Mar 2, 2015

1 parent
[f343f0d](/capnproto/capnproto/commit/f343f0dbd0a2e87f17cd74f14186ed73e3fbdbfa)

commit 26bcced

Showing
**1 changed file**
with
**8 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

10 changes: 8 additions & 2 deletions

10
[c++/src/capnp/layout.c++](#diff-aaaac703062430549c1acd93e348a76eb2ddc42aabdcd0ecc04df1696f884d5b "c++/src/capnp/layout.c++")

Show comments

[View file](/capnproto/capnproto/blob/26bcceda72372211063d62aab7e45665faa83633/c%2B%2B/src/capnp/layout.c%2B%2B)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1430,6 +1430,7 @@ struct WireHelpers { |
|  |  | WirePointer\* ref, word\* refTarget, SegmentBuilder\* segment, |
|  |  | const void\* defaultValue, ByteCount defaultSize)) { |
|  |  | if (ref->isNull()) { |
|  |  | useDefault: |
|  |  | if (defaultSize == 0 \* BYTES) { |
|  |  | return nullptr; |
|  |  | } else { |
| Expand All | | @@ -1439,14 +1440,19 @@ struct WireHelpers { |
|  |  | } |
|  |  | } else { |
|  |  | word\* ptr = followFars(ref, refTarget, segment); |
|  |  | char\* cptr = reinterpret\_cast<char\*>(ptr); |
|  |  |  |
|  |  | KJ\_REQUIRE(ref->kind() == WirePointer::LIST, |
|  |  | "Called getText{Field,Element}() but existing pointer is not a list."); |
|  |  | KJ\_REQUIRE(ref->listRef.elementSize() == ElementSize::BYTE, |
|  |  | "Called getText{Field,Element}() but existing list pointer is not byte-sized."); |
|  |  |  |
|  |  | // Subtract 1 from the size for the NUL terminator. |
|  |  | return Text::Builder(reinterpret\_cast<char\*>(ptr), ref->listRef.elementCount() / ELEMENTS - 1); |
|  |  | size\_t size = ref->listRef.elementCount() / ELEMENTS; |
|  |  | KJ\_REQUIRE(size > 0 && cptr[size-1] == '\0', "Text blob missing NUL terminator.") { |
|  |  | goto useDefault; |
|  |  | } |
|  |  |  |
|  |  | return Text::Builder(cptr, size - 1); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `26bcced`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapnproto%2Fcapnproto%2Fcommit%2F26bcceda72372211063d62aab7e45665faa83633) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.



=== Content from security-tracker.debian.org_76d6097c_20250126_024248.html ===

# CVE-2015-2312

| **Name** | CVE-2015-2312 |
| --- | --- |
| **Description** | Sandstorm Cap'n Proto before 0.4.1.1 and 0.5.x before 0.5.1.1 allows remote peers to cause a denial of service (CPU and possibly general resource consumption) via a list with a large number of elements. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2015-2312) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2015-2312); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2015-2312), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2015-2312), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2015-2312), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2015-2312), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-2312), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2015-2312), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2015-2312), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2015-2312)/[CVE](https://www.suse.com/security/cve/CVE-2015-2312/), GitHub [advisories](https://github.com/advisories?query=CVE-2015-2312)/[code](https://github.com/search?type=Code&q=%22CVE-2015-2312%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2015-2312%22), [web search](https://duckduckgo.com/html?q=%22CVE-2015-2312%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [780567](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=780567) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [capnproto](/tracker/source-package/capnproto) ([PTS](https://tracker.debian.org/pkg/capnproto)) | bullseye | 0.7.0-7 | fixed |
|  | bookworm | 0.9.2-2 | fixed |
|  | sid, trixie | 1.1.0-2 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [capnproto](/tracker/source-package/capnproto) | source | (unstable) | 0.4.1-3 |  |  | [780567](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=780567) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from www.openwall.com_cc6ca536_20250124_180102.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](../../../2015/03/16/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20150317045059.C7BA842E06C@smtpvbsrv1.mitre.org>
Date: Tue, 17 Mar 2015 00:50:59 -0400 (EDT)
From: cve-assign@...re.org
To: carnil@...ian.org
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com, debian@...lee.co, bernat@...ian.org
Subject: Re: CVE Request: Cap'n Proto: Several issues

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> Can you assign CVEs for the following issues in Cap'n Proto? Details
> and fixing commits are referenced in upstream problem descriptions:

> 1/ Integer overflow in pointer validation
>   - <https://github.com/sandstorm-io/capnproto/blob/master/security-advisories/2015-03-02-0-c%2B%2B-integer-overflow.md>
>   - <https://bugs.debian.org/780565>

> Discovered by Ben Laurie

> KJ_REQUIRE(elementTag->structRef.wordSize() / ELEMENTS * ElementCount64(count) <= wordCount,

> KJ_REQUIRE(wordsPerElement * ElementCount64(elementCount) <= wordCount,

> KJ_REQUIRE(ElementCount64(size) * wordsPerElement <= wordCount,

Use CVE-2015-2310.

> 2/ Integer underflow in pointer validation
>   - <https://github.com/sandstorm-io/capnproto/blob/master/security-advisories/2015-03-02-1-c%2B%2B-integer-underflow.md>
>   - <https://bugs.debian.org/780566>

> Discovered by Kenton Varda

> KJ_REQUIRE(size > 0

Use CVE-2015-2311.

> 3/ CPU usage amplification attack
>   - <https://github.com/sandstorm-io/capnproto/blob/master/security-advisories/2015-03-02-2-all-cpu-amplification.md>
>   - <https://bugs.debian.org/780567>

> Discovered by Ben Laurie

> Cap'n Proto takes the philosophy that any security mistake that is
> likely to be common in naively-written application code is in fact a
> bug in Cap'n Proto

> list could claim to have up to 2^29-1 elements while only taking 8 or
> 16 bytes on the wire

> application may notice nothing wrong and proceed to iterate through
> and handle each element in the list, potentially taking a lot of time
> and resources

Use CVE-2015-2312.

> 4/ CPU usage amplification attack #2
>   - <https://github.com/sandstorm-io/capnproto/blob/master/security-advisories/2015-03-05-0-c%2B%2B-addl-cpu-amplification.md>
>   - <https://bugs.debian.org/780568>

> Discovered by David Renshaw

> The new case occurs only if the application invokes the totalSize()
> method on an object reader.

Use CVE-2015-2313.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJVB7HrAAoJEKllVAevmvms508IAKyyZQLBjgtp7bTd7lpZ5bKQ
tkHPwBKJLt5AyjkgFN+J1lF0ijW1sInbuzs/n35R/yDk7y1LByOqSUqacPiQma2T
XU+yaK13+7H4Cn3w3t9Vukix6CdhvRTlTKpK5ijF9o3PK+oWgFhcvwSiNvQ7H5nW
V3L7cxYOjUlJabqvWI60rHW1mrVSLc5GMOSFrH7Aau39KbDJAa8EkfkRITYz2Ip2
XZWvqobldBY9wgRvDGdDgpgFGvZM5nMv7irNtSnU3va8eEWXTmh5Mzu1IaKwIuZZ
LH5uX91LbcCeRSRgxfHSIn9xuyMhoQrE+GvfXVzzO54U8r6WgitKD3OguALaXU8=
=9zKY
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugs.debian.org_9d463e7f_20250126_024251.html ===

# Debian Bug report logs - #780567 capnproto: CVE-2015-2312: CPU usage amplification attack

[![version graph](version.cgi?fixed=capnproto%2F0.4.1-3;found=capnproto%2F0.4.1-2;absolute=0;width=2;collapse=1;height=2;package=capnproto)](version.cgi?package=capnproto;collapse=1;fixed=capnproto%2F0.4.1-3;found=capnproto%2F0.4.1-2;info=1;absolute=0)

Package:
[capnproto](pkgreport.cgi?package=capnproto);
Maintainer for [capnproto](pkgreport.cgi?package=capnproto) is [Tom Lee <debian@tomlee.co>](pkgreport.cgi?maint=debian%40tomlee.co); Source for [capnproto](pkgreport.cgi?package=capnproto) is [src:capnproto](pkgreport.cgi?src=capnproto) ([PTS](https://tracker.debian.org/pkg/capnproto), [buildd](https://buildd.debian.org/capnproto), [popcon](https://qa.debian.org/popcon.php?package=capnproto)).

Reported by: [Tom Lee <debian@tomlee.co>](pkgreport.cgi?submitter=debian%40tomlee.co)

Date: Mon, 16 Mar 2015 04:48:01 UTC

Severity: *grave*

Tags: security

Found in version capnproto/0.4.1-2

Fixed in version capnproto/0.4.1-3

**Done:** Tom Lee <debian@tomlee.co>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=780567;mbox=yes), [status mbox](bugreport.cgi?bug=780567;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=780567;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#780567`; Package `capnproto`.
(Mon, 16 Mar 2015 04:48:06 GMT) ([full text](bugreport.cgi?bug=780567;msg=2), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Tom Lee <debian@tomlee.co>`:

New Bug report received and forwarded.
(Mon, 16 Mar 2015 04:48:06 GMT) ([full text](bugreport.cgi?bug=780567;msg=4), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=780567;msg=5), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40tomlee.co)
From: Tom Lee <debian@tomlee.co>
To: submit@bugs.debian.org
Subject: CPU usage amplification attack
Date: Sun, 15 Mar 2015 21:44:41 -0700
```
[[Message part 1](bugreport.cgi?att=0;bug=780567;msg=5) (text/plain, inline)]
```
```
Package: capnproto
Version: 0.4.1-2
Severity: critical

Upstream has reported a number of security issues in capnproto 0.4.1.
Creating bugs to track these issues while I work on getting them fixed.

This bug is tracking the "CPU usage amplification attack" bug reported on
2015-03-02.

Full details + patch:
<https://github.com/sandstorm-io/capnproto/blob/master/security-advisories/2015-03-02-2-all-cpu-amplification.md>

--
*Tom Lee */ <http://tomlee.co> / @tglee <<http://twitter.com/tglee>>

```
```
[[Message part 2](bugreport.cgi?att=1;bug=780567;msg=5) (text/html, inline)]
```

---

**Added tag(s) security.**
Request was from `Paul Wise <pabs@debian.org>`
to `control@bugs.debian.org`.
(Mon, 16 Mar 2015 05:00:06 GMT) ([full text](bugreport.cgi?bug=780567;msg=7), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=7), [link](#6)).

---

**Changed Bug title to 'capnproto: CVE-2015-2312: CPU usage amplification attack' from 'CPU usage amplification attack'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Tue, 17 Mar 2015 05:06:10 GMT) ([full text](bugreport.cgi?bug=780567;msg=9), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=9), [link](#8)).

---

**Severity set to 'grave' from 'critical'**
Request was from `Tom Lee <debian@tomlee.co>`
to `control@bugs.debian.org`.
(Wed, 18 Mar 2015 03:27:11 GMT) ([full text](bugreport.cgi?bug=780567;msg=11), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=11), [link](#10)).

---

**Reply sent**
to `Tom Lee <debian@tomlee.co>`:

You have taken responsibility.
(Sat, 28 Mar 2015 10:06:19 GMT) ([full text](bugreport.cgi?bug=780567;msg=13), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=13), [link](#12)).

---

**Notification sent**
to `Tom Lee <debian@tomlee.co>`:

Bug acknowledged by developer.
(Sat, 28 Mar 2015 10:06:19 GMT) ([full text](bugreport.cgi?bug=780567;msg=15), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=15), [link](#14)).

---

[Message #16](#16) received at 780567-close@bugs.debian.org ([full text](bugreport.cgi?bug=780567;msg=16), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=16), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40tomlee.co)
From: Tom Lee <debian@tomlee.co>
To: 780567-close@bugs.debian.org
Subject: Bug#780567: fixed in capnproto 0.4.1-3
Date: Sat, 28 Mar 2015 10:04:31 +0000
```
Source: capnproto
Source-Version: 0.4.1-3

We believe that the bug you reported is fixed in the latest version of
capnproto, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 780567@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Tom Lee <debian@tomlee.co> (supplier of updated capnproto package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Tue, 17 Mar 2015 19:53:24 -0800
Source: capnproto
Binary: libcapnp-0.4.1 libcapnp-dev capnproto
Architecture: source amd64
Version: 0.4.1-3
Distribution: unstable
Urgency: high
Maintainer: Tom Lee <debian@tomlee.co>
Changed-By: Tom Lee <debian@tomlee.co>
Description:
 capnproto  - tool for working with the Cap'n Proto data interchange format
 libcapnp-0.4.1 - Cap'n Proto C++ library
 libcapnp-dev - Cap'n Proto C++ library (development files)
Closes: [780565](bugreport.cgi?bug=780565) [780566](bugreport.cgi?bug=780566) [780567](bugreport.cgi?bug=780567) [780568](bugreport.cgi?bug=780568)
Changes:
 capnproto (0.4.1-3) unstable; urgency=high
 .
   * Fix [CVE-2015-2310](https://security-tracker.debian.org/tracker/CVE-2015-2310): Integer overflow in pointer validation (Closes: [780565](bugreport.cgi?bug=780565))
   * Fix [CVE-2015-2311](https://security-tracker.debian.org/tracker/CVE-2015-2311): Integer underflow in pointer validation (Closes: [780566](bugreport.cgi?bug=780566))
   * Fix [CVE-2015-2312](https://security-tracker.debian.org/tracker/CVE-2015-2312): CPU usage amplification attack (Closes: [780567](bugreport.cgi?bug=780567))
   * Fix [CVE-2015-2313](https://security-tracker.debian.org/tracker/CVE-2015-2313): CPU usage amplification attack #2 (Closes: [780568](bugreport.cgi?bug=780568))
Checksums-Sha1:
 bfe5a1cea8070a5dee0121ecd7068e87ef7f6c9d 2054 capnproto_0.4.1-3.dsc
 2f251b205c665c7b72817ae6d4c52f047f5c0282 10984 capnproto_0.4.1-3.debian.tar.xz
 9cde11cd029b8767494d450fb4979853af4bcbaa 526256 libcapnp-0.4.1_0.4.1-3_amd64.deb
 2da025c247379fdb44705116e11a921b65bcfe69 745964 libcapnp-dev_0.4.1-3_amd64.deb
 9ef5ca198cad87de6501049ca92ddf4ec44ac910 170350 capnproto_0.4.1-3_amd64.deb
Checksums-Sha256:
 32f86d39b12d26d0edeb36a8df51ce4be6a431f579f6b415edeb9b9900d5d300 2054 capnproto_0.4.1-3.dsc
 d2855bd37291847b7dea7a9d0c9aa632088da6ec16a038ece0ba403d4b12cfe5 10984 capnproto_0.4.1-3.debian.tar.xz
 0cc882278276f9c09eb7bcec86e5f9a35f5896f78a5595d1b87df17eeeb4608b 526256 libcapnp-0.4.1_0.4.1-3_amd64.deb
 1054d6f3d786748edd83fb59a0c840a7f03212b44c9137aee51108fd2fd228b7 745964 libcapnp-dev_0.4.1-3_amd64.deb
 22b6714c52a57d29670320c0746e6f68627f1dc963e16edcbf5d1ee15befa0b8 170350 capnproto_0.4.1-3_amd64.deb
Files:
 eb595ceebeb49db8ecdd480acebc34f0 2054 devel optional capnproto_0.4.1-3.dsc
 41613a343a27107b43f7cc7d4439601c 10984 devel optional capnproto_0.4.1-3.debian.tar.xz
 96655f2e7aeb70fe31105e401dbb0547 526256 libs optional libcapnp-0.4.1_0.4.1-3_amd64.deb
 0ae5bbd903cab58907f25d1e798c6d36 745964 libdevel optional libcapnp-dev_0.4.1-3_amd64.deb
 43056c2e59c9ada3d7999d585593d2ab 170350 devel optional capnproto_0.4.1-3_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJVFlyVAAoJEJWkL+g1NSX51QgP/3+VZopWCBf4EVHsMnuuVvZP
iQ2DyQ7dLLzwsoRiipjd1dP22sfqH6JN0Ac1stPxkHS9vt4QO/sTYi4KoydM9Mp3
qbbEJt9ivGo4l/gEcDA9wKR0FV1V40KYy0WXHwvXK16s6t3VU14Caf3wt8zSnAxA
b4ZZDGac8LNrI5Q2cViGU11FRa16UuJVI4EfWhyPxsb9OxH+2bKlOwGCcTdnqXw1
tPZrMuFv88pWCG7G7H/vUazu4GJD/V3AsIqYRKdF1bIHVcLkfSKtasJ89c2GE3jm
urKCcdJs0UcjJRa3yAxUGPtCwerubfLxUyYVacciC0g5UcJgcfM+im8xbqT0h4CP
cYpGe2xs5thVo426tfoO/JBxqDKhf/2sQb63axOECmsHliRjgcQmHx9pz9Am/mIO
ZKKEvPq9DZNr2zhC/NG0kdMJDCYzDC2+Je0ttNbIXY98rKqeAe/u3h1ffaX2IN95
c56VA7Pjjto03Nqd0di4mudtSwNSwvJ8auiFqetRjfD+OZaJPyGEDBCN2wCDjU6u
Rsybuqx8v/j0B39E9yGcmzrxnaahm2jfFg1yy4GCob0txQ2eX4ukqwIdB8kZJjfK
8CKnjzpV4xSYrqcVnK8AS0UMiFkZ7owRNbW+G2zMGXy1O7uIj2ebb+mnzDEgkN+3
A717zs6cgpIwyHp+UAxu
=GxxL
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Mon, 11 May 2015 07:28:38 GMT) ([full text](bugreport.cgi?bug=780567;msg=18), [mbox](bugreport.cgi?bug=780567;mbox=yes;msg=18), [link](#17)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=780567).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sun Jan 26 02:42:51 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from security-tracker.debian.org_1dc07bf2_20250126_024248.html ===

# CVE-2015-2311

| **Name** | CVE-2015-2311 |
| --- | --- |
| **Description** | Integer underflow in Sandstorm Cap'n Proto before 0.4.1.1 and 0.5.x before 0.5.1.1 might allow remote peers to cause a denial of service or possibly obtain sensitive information from memory or execute arbitrary code via a crafted message. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2015-2311) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2015-2311); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2015-2311), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2015-2311), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2015-2311), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2015-2311), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-2311), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2015-2311), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2015-2311), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2015-2311)/[CVE](https://www.suse.com/security/cve/CVE-2015-2311/), GitHub [advisories](https://github.com/advisories?query=CVE-2015-2311)/[code](https://github.com/search?type=Code&q=%22CVE-2015-2311%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2015-2311%22), [web search](https://duckduckgo.com/html?q=%22CVE-2015-2311%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [780566](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=780566) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [capnproto](/tracker/source-package/capnproto) ([PTS](https://tracker.debian.org/pkg/capnproto)) | bullseye | 0.7.0-7 | fixed |
|  | bookworm | 0.9.2-2 | fixed |
|  | sid, trixie | 1.1.0-2 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [capnproto](/tracker/source-package/capnproto) | source | (unstable) | 0.4.1-3 |  |  | [780566](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=780566) |

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from bugs.debian.org_6c442926_20250126_024252.html ===

# Debian Bug report logs - #780566 capnproto: CVE-2015-2311: Integer underflow in pointer validation

[![version graph](version.cgi?width=2;found=capnproto%2F0.4.1-2;absolute=0;height=2;package=capnproto;collapse=1;fixed=capnproto%2F0.4.1-3)](version.cgi?package=capnproto;fixed=capnproto%2F0.4.1-3;info=1;absolute=0;collapse=1;found=capnproto%2F0.4.1-2)

Package:
[capnproto](pkgreport.cgi?package=capnproto);
Maintainer for [capnproto](pkgreport.cgi?package=capnproto) is [Tom Lee <debian@tomlee.co>](pkgreport.cgi?maint=debian%40tomlee.co); Source for [capnproto](pkgreport.cgi?package=capnproto) is [src:capnproto](pkgreport.cgi?src=capnproto) ([PTS](https://tracker.debian.org/pkg/capnproto), [buildd](https://buildd.debian.org/capnproto), [popcon](https://qa.debian.org/popcon.php?package=capnproto)).

Reported by: [Tom Lee <debian@tomlee.co>](pkgreport.cgi?submitter=debian%40tomlee.co)

Date: Mon, 16 Mar 2015 04:45:02 UTC

Severity: *grave*

Tags: security

Found in version capnproto/0.4.1-2

Fixed in version capnproto/0.4.1-3

**Done:** Tom Lee <debian@tomlee.co>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=780566;mbox=yes), [status mbox](bugreport.cgi?bug=780566;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=780566;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#780566`; Package `capnproto`.
(Mon, 16 Mar 2015 04:45:06 GMT) ([full text](bugreport.cgi?bug=780566;msg=2), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Tom Lee <debian@tomlee.co>`:

New Bug report received and forwarded.
(Mon, 16 Mar 2015 04:45:06 GMT) ([full text](bugreport.cgi?bug=780566;msg=4), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=780566;msg=5), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40tomlee.co)
From: Tom Lee <debian@tomlee.co>
To: submit@bugs.debian.org
Subject: Integer underflow in pointer validation
Date: Sun, 15 Mar 2015 21:43:13 -0700
```
[[Message part 1](bugreport.cgi?att=0;bug=780566;msg=5) (text/plain, inline)]
```
```
Package: capnproto
Version: 0.4.1-2
Severity: critical

Upstream has reported a number of security issues in capnproto 0.4.1.
Creating bugs to track these issues while I work on getting them fixed.

This bug is tracking the "Integer underflow in pointer validation" bug
reported on 2015-03-02.

Full details + patch:
<https://github.com/sandstorm-io/capnproto/blob/master/security-advisories/2015-03-02-1-c%2B%2B-integer-underflow.md>

--
*Tom Lee */ <http://tomlee.co> / @tglee <<http://twitter.com/tglee>>

```
```
[[Message part 2](bugreport.cgi?att=1;bug=780566;msg=5) (text/html, inline)]
```

---

**Added tag(s) security.**
Request was from `Paul Wise <pabs@debian.org>`
to `control@bugs.debian.org`.
(Mon, 16 Mar 2015 05:00:05 GMT) ([full text](bugreport.cgi?bug=780566;msg=7), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=7), [link](#6)).

---

**Changed Bug title to 'capnproto: CVE-2015-2311: Integer underflow in pointer validation' from 'Integer underflow in pointer validation'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Tue, 17 Mar 2015 05:06:09 GMT) ([full text](bugreport.cgi?bug=780566;msg=9), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=9), [link](#8)).

---

**Severity set to 'grave' from 'critical'**
Request was from `Tom Lee <debian@tomlee.co>`
to `control@bugs.debian.org`.
(Wed, 18 Mar 2015 03:27:10 GMT) ([full text](bugreport.cgi?bug=780566;msg=11), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=11), [link](#10)).

---

**Reply sent**
to `Tom Lee <debian@tomlee.co>`:

You have taken responsibility.
(Sat, 28 Mar 2015 10:06:15 GMT) ([full text](bugreport.cgi?bug=780566;msg=13), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=13), [link](#12)).

---

**Notification sent**
to `Tom Lee <debian@tomlee.co>`:

Bug acknowledged by developer.
(Sat, 28 Mar 2015 10:06:15 GMT) ([full text](bugreport.cgi?bug=780566;msg=15), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=15), [link](#14)).

---

[Message #16](#16) received at 780566-close@bugs.debian.org ([full text](bugreport.cgi?bug=780566;msg=16), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=16), reply):

![](/cgi-bin/libravatar.cgi?email=debian%40tomlee.co)
From: Tom Lee <debian@tomlee.co>
To: 780566-close@bugs.debian.org
Subject: Bug#780566: fixed in capnproto 0.4.1-3
Date: Sat, 28 Mar 2015 10:04:31 +0000
```
Source: capnproto
Source-Version: 0.4.1-3

We believe that the bug you reported is fixed in the latest version of
capnproto, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 780566@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Tom Lee <debian@tomlee.co> (supplier of updated capnproto package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Format: 1.8
Date: Tue, 17 Mar 2015 19:53:24 -0800
Source: capnproto
Binary: libcapnp-0.4.1 libcapnp-dev capnproto
Architecture: source amd64
Version: 0.4.1-3
Distribution: unstable
Urgency: high
Maintainer: Tom Lee <debian@tomlee.co>
Changed-By: Tom Lee <debian@tomlee.co>
Description:
 capnproto  - tool for working with the Cap'n Proto data interchange format
 libcapnp-0.4.1 - Cap'n Proto C++ library
 libcapnp-dev - Cap'n Proto C++ library (development files)
Closes: [780565](bugreport.cgi?bug=780565) [780566](bugreport.cgi?bug=780566) [780567](bugreport.cgi?bug=780567) [780568](bugreport.cgi?bug=780568)
Changes:
 capnproto (0.4.1-3) unstable; urgency=high
 .
   * Fix [CVE-2015-2310](https://security-tracker.debian.org/tracker/CVE-2015-2310): Integer overflow in pointer validation (Closes: [780565](bugreport.cgi?bug=780565))
   * Fix [CVE-2015-2311](https://security-tracker.debian.org/tracker/CVE-2015-2311): Integer underflow in pointer validation (Closes: [780566](bugreport.cgi?bug=780566))
   * Fix [CVE-2015-2312](https://security-tracker.debian.org/tracker/CVE-2015-2312): CPU usage amplification attack (Closes: [780567](bugreport.cgi?bug=780567))
   * Fix [CVE-2015-2313](https://security-tracker.debian.org/tracker/CVE-2015-2313): CPU usage amplification attack #2 (Closes: [780568](bugreport.cgi?bug=780568))
Checksums-Sha1:
 bfe5a1cea8070a5dee0121ecd7068e87ef7f6c9d 2054 capnproto_0.4.1-3.dsc
 2f251b205c665c7b72817ae6d4c52f047f5c0282 10984 capnproto_0.4.1-3.debian.tar.xz
 9cde11cd029b8767494d450fb4979853af4bcbaa 526256 libcapnp-0.4.1_0.4.1-3_amd64.deb
 2da025c247379fdb44705116e11a921b65bcfe69 745964 libcapnp-dev_0.4.1-3_amd64.deb
 9ef5ca198cad87de6501049ca92ddf4ec44ac910 170350 capnproto_0.4.1-3_amd64.deb
Checksums-Sha256:
 32f86d39b12d26d0edeb36a8df51ce4be6a431f579f6b415edeb9b9900d5d300 2054 capnproto_0.4.1-3.dsc
 d2855bd37291847b7dea7a9d0c9aa632088da6ec16a038ece0ba403d4b12cfe5 10984 capnproto_0.4.1-3.debian.tar.xz
 0cc882278276f9c09eb7bcec86e5f9a35f5896f78a5595d1b87df17eeeb4608b 526256 libcapnp-0.4.1_0.4.1-3_amd64.deb
 1054d6f3d786748edd83fb59a0c840a7f03212b44c9137aee51108fd2fd228b7 745964 libcapnp-dev_0.4.1-3_amd64.deb
 22b6714c52a57d29670320c0746e6f68627f1dc963e16edcbf5d1ee15befa0b8 170350 capnproto_0.4.1-3_amd64.deb
Files:
 eb595ceebeb49db8ecdd480acebc34f0 2054 devel optional capnproto_0.4.1-3.dsc
 41613a343a27107b43f7cc7d4439601c 10984 devel optional capnproto_0.4.1-3.debian.tar.xz
 96655f2e7aeb70fe31105e401dbb0547 526256 libs optional libcapnp-0.4.1_0.4.1-3_amd64.deb
 0ae5bbd903cab58907f25d1e798c6d36 745964 libdevel optional libcapnp-dev_0.4.1-3_amd64.deb
 43056c2e59c9ada3d7999d585593d2ab 170350 devel optional capnproto_0.4.1-3_amd64.deb

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJVFlyVAAoJEJWkL+g1NSX51QgP/3+VZopWCBf4EVHsMnuuVvZP
iQ2DyQ7dLLzwsoRiipjd1dP22sfqH6JN0Ac1stPxkHS9vt4QO/sTYi4KoydM9Mp3
qbbEJt9ivGo4l/gEcDA9wKR0FV1V40KYy0WXHwvXK16s6t3VU14Caf3wt8zSnAxA
b4ZZDGac8LNrI5Q2cViGU11FRa16UuJVI4EfWhyPxsb9OxH+2bKlOwGCcTdnqXw1
tPZrMuFv88pWCG7G7H/vUazu4GJD/V3AsIqYRKdF1bIHVcLkfSKtasJ89c2GE3jm
urKCcdJs0UcjJRa3yAxUGPtCwerubfLxUyYVacciC0g5UcJgcfM+im8xbqT0h4CP
cYpGe2xs5thVo426tfoO/JBxqDKhf/2sQb63axOECmsHliRjgcQmHx9pz9Am/mIO
ZKKEvPq9DZNr2zhC/NG0kdMJDCYzDC2+Je0ttNbIXY98rKqeAe/u3h1ffaX2IN95
c56VA7Pjjto03Nqd0di4mudtSwNSwvJ8auiFqetRjfD+OZaJPyGEDBCN2wCDjU6u
Rsybuqx8v/j0B39E9yGcmzrxnaahm2jfFg1yy4GCob0txQ2eX4ukqwIdB8kZJjfK
8CKnjzpV4xSYrqcVnK8AS0UMiFkZ7owRNbW+G2zMGXy1O7uIj2ebb+mnzDEgkN+3
A717zs6cgpIwyHp+UAxu
=GxxL
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Mon, 11 May 2015 07:28:29 GMT) ([full text](bugreport.cgi?bug=780566;msg=18), [mbox](bugreport.cgi?bug=780566;mbox=yes;msg=18), [link](#17)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=780566).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sun Jan 26 02:42:52 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright Â© 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from github.com_8e5055de_20250124_180104.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapnproto%2Fcapnproto%2Fblob%2Fmaster%2Fsecurity-advisories%2F2015-03-02-1-c%252B%252B-integer-underflow.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapnproto%2Fcapnproto%2Fblob%2Fmaster%2Fsecurity-advisories%2F2015-03-02-1-c%252B%252B-integer-underflow.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=capnproto%2Fcapnproto)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[capnproto](/capnproto)
/
**[capnproto](/capnproto/capnproto)**
Public

* [Notifications](/login?return_to=%2Fcapnproto%2Fcapnproto) You must be signed in to change notification settings
* [Fork
  934](/login?return_to=%2Fcapnproto%2Fcapnproto)
* [Star
   11.9k](/login?return_to=%2Fcapnproto%2Fcapnproto)

* [Code](/capnproto/capnproto/tree/master)
* [Issues
  180](/capnproto/capnproto/issues)
* [Pull requests
  71](/capnproto/capnproto/pulls)
* [Discussions](/capnproto/capnproto/discussions)
* [Actions](/capnproto/capnproto/actions)
* [Projects
  0](/capnproto/capnproto/projects)
* [Wiki](/capnproto/capnproto/wiki)
* [Security](/capnproto/capnproto/security)
* [Insights](/capnproto/capnproto/pulse)

Additional navigation options

* [Code](/capnproto/capnproto/tree/master)
* [Issues](/capnproto/capnproto/issues)
* [Pull requests](/capnproto/capnproto/pulls)
* [Discussions](/capnproto/capnproto/discussions)
* [Actions](/capnproto/capnproto/actions)
* [Projects](/capnproto/capnproto/projects)
* [Wiki](/capnproto/capnproto/wiki)
* [Security](/capnproto/capnproto/security)
* [Insights](/capnproto/capnproto/pulse)

## Files

Â master
## Breadcrumbs

1. [capnproto](/capnproto/capnproto/tree/master)
2. /[security-advisories](/capnproto/capnproto/tree/master/security-advisories)
/
# 2015-03-02-1-c++-integer-underflow.md

Copy path Blame  Blame
## Latest commit

## History

[History](/capnproto/capnproto/commits/master/security-advisories/2015-03-02-1-c%2B%2B-integer-underflow.md)110 lines (84 loc) Â· 4.5 KBÂ master
## Breadcrumbs

1. [capnproto](/capnproto/capnproto/tree/master)
2. /[security-advisories](/capnproto/capnproto/tree/master/security-advisories)
/
# 2015-03-02-1-c++-integer-underflow.md

Top
## File metadata and controls

* Preview
* Code
* Blame

110 lines (84 loc) Â· 4.5 KB[Raw](https://github.com/capnproto/capnproto/raw/refs/heads/master/security-advisories/2015-03-02-1-c%2B%2B-integer-underflow.md)
# Problem

Integer underflow in pointer validation.

# Discovered by

Kenton Varda <kenton@sandstorm.io>

# Announced

2015-03-02

# CVE

CVE-2015-2311

# Impact

* Remotely segfault a peer by sending it a malicious message.
* Possible exfiltration of memory, depending on application behavior.
* If the application performs a sequence of operations that "probably" no
  application does (see below), possible memory corruption / code execution.

# Fixed in

* git commit [26bcceda72372211063d62aab7e45665faa83633](https://github.com/capnproto/capnproto/commit/26bcceda72372211063d62aab7e45665faa83633)
* release 0.5.1.1:
  + Unix: [https://capnproto.org/capnproto-c++-0.5.1.1.tar.gz](https://capnproto.org/capnproto-c%2B%2B-0.5.1.1.tar.gz)
  + Windows: [https://capnproto.org/capnproto-c++-win32-0.5.1.1.zip](https://capnproto.org/capnproto-c%2B%2B-win32-0.5.1.1.zip)
* release 0.4.1.1:
  + Unix: [https://capnproto.org/capnproto-c++-0.4.1.1.tar.gz](https://capnproto.org/capnproto-c%2B%2B-0.4.1.1.tar.gz)
* release 0.6 (future)

# Details

*The following text contains speculation about the exploitability of this
bug. This is provided for informational purposes, but as such speculation is
often shown to be wrong, you should not rely on the accuracy of this
section for the safety of your service. Please update your library.*

A `Text` pointer, when non-null, must point to a NUL-terminated string, meaning
it must have a size of at least 1. Under most circumstances, Cap'n Proto will
reject zero-size text objects. However, if an application performs the
following sequence, they may hit a code path that was missing a check:

1. Receive a message containing a `Text` value, but do not actually look at
   that value.
2. Copy the message into a `MessageBuilder`.
3. Call the `get()` method for the `Text` value within the `MessageBuilder`,
   obtaining a `Text::Builder` for the *copy*.

In this case, the `Text::Builder` will appear to point at a string with size
2^32-1, starting at a location within the Cap'n Proto message.

The `Text::Builder` is writable. If the application decided to overwrite the
text in-place, it could overwrite arbitrary memory in the next 4GB of virtual
address space. However, there are several reasons to believe this is unusual:

* Usually, when an application `get()`s a text field, it only intends to
  read it. Overwriting the text in-place is unusual.
* Calling `set()` on the field -- the usual way to overwrite text -- will
  create an all-new text object and harmlessly discard the old, invalid
  pointer.

Note that even if an application does overwrite the text, it would still be
hard for the attacker to exploit this for code execution unless the attacker
also controls the data that the application writes into the field.

This vulnerability is somewhat more likely to allow exfiltration of memory.
However, this requires the app to additionally echo the text back to the
attacker. To do this without segfaulting, the app would either need to attempt
to read only a subset of the text, or would need to have 2^32 contiguous bytes
of virtual memory mapped into its address space.

A related problem, also fixed in this change, occurs when a `Text` value
has non-zero size but lacks a NUL terminator. Again, if an application
performs the series of operations described above, the NUL terminator check
may be bypassed. If the app then passes the string to an API that assumes
NUL-terminated strings, the contents of memory after the text blob may be
interpreted as being part of the string, up to the next zero-valued byte.
This again could lead to exfiltration of data, this time without the high
chance of segfault, although only up to the next zero-valued byte, which
are typically quite common.

# Preventative measures

This problem was discovered through preventative measures implemented after
the security problem discussed in the [previous advisory](https://github.com/capnproto/capnproto/tree/master/security-advisories/2015-03-02-0-c%2B%2B-integer-overflow.md). Specifically, this
problem was found by using template metaprogramming to implement integer
bounds analysis in order to effectively "prove" that there are no integer
overflows in the core pointer validation code (capnp/layout.c++).
Tentatively, I believe that this analysis exhaustively covers this file.
The instrumentation has not been merged into master yet as it requires some
cleanup, but [check the Cap'n Proto blog for an in-depth discussion](https://capnproto.org/news/2015-03-02-security-advisory-and-integer-overflow-protection.html).

This problem is also caught by capnp/fuzz-test.c++, which *has* been
merged into master but likely doesn't have as broad coverage.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.



=== Content from github.com_3473b281_20250126_024249.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapnproto%2Fcapnproto%2Fblob%2Fmaster%2Fsecurity-advisories%2F2015-03-02-2-all-cpu-amplification.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcapnproto%2Fcapnproto%2Fblob%2Fmaster%2Fsecurity-advisories%2F2015-03-02-2-all-cpu-amplification.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=capnproto%2Fcapnproto)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[capnproto](/capnproto)
/
**[capnproto](/capnproto/capnproto)**
Public

* [Notifications](/login?return_to=%2Fcapnproto%2Fcapnproto) You must be signed in to change notification settings
* [Fork
  934](/login?return_to=%2Fcapnproto%2Fcapnproto)
* [Star
   11.9k](/login?return_to=%2Fcapnproto%2Fcapnproto)

* [Code](/capnproto/capnproto/tree/master)
* [Issues
  180](/capnproto/capnproto/issues)
* [Pull requests
  71](/capnproto/capnproto/pulls)
* [Discussions](/capnproto/capnproto/discussions)
* [Actions](/capnproto/capnproto/actions)
* [Projects
  0](/capnproto/capnproto/projects)
* [Wiki](/capnproto/capnproto/wiki)
* [Security](/capnproto/capnproto/security)
* [Insights](/capnproto/capnproto/pulse)

Additional navigation options

* [Code](/capnproto/capnproto/tree/master)
* [Issues](/capnproto/capnproto/issues)
* [Pull requests](/capnproto/capnproto/pulls)
* [Discussions](/capnproto/capnproto/discussions)
* [Actions](/capnproto/capnproto/actions)
* [Projects](/capnproto/capnproto/projects)
* [Wiki](/capnproto/capnproto/wiki)
* [Security](/capnproto/capnproto/security)
* [Insights](/capnproto/capnproto/pulse)

## Files

Â master
## Breadcrumbs

1. [capnproto](/capnproto/capnproto/tree/master)
2. /[security-advisories](/capnproto/capnproto/tree/master/security-advisories)
/
# 2015-03-02-2-all-cpu-amplification.md

Copy path Blame  Blame
## Latest commit

## History

[History](/capnproto/capnproto/commits/master/security-advisories/2015-03-02-2-all-cpu-amplification.md)74 lines (55 loc) Â· 2.61 KBÂ master
## Breadcrumbs

1. [capnproto](/capnproto/capnproto/tree/master)
2. /[security-advisories](/capnproto/capnproto/tree/master/security-advisories)
/
# 2015-03-02-2-all-cpu-amplification.md

Top
## File metadata and controls

* Preview
* Code
* Blame

74 lines (55 loc) Â· 2.61 KB[Raw](https://github.com/capnproto/capnproto/raw/refs/heads/master/security-advisories/2015-03-02-2-all-cpu-amplification.md)
# Problem

CPU usage amplification attack.

# Discovered by

Ben Laurie <ben@links.org> using [American Fuzzy Lop](http://lcamtuf.coredump.cx/afl/)

# Announced

2015-03-02

# CVE

CVE-2015-2312

# Impact

* Remotely cause a peer to use excessive CPU time and other resources to
  process a very small message, possibly enabling a DoS attack.

# Fixed in

* git commit [104870608fde3c698483fdef6b97f093fc15685d](https://github.com/capnproto/capnproto/commit/104870608fde3c698483fdef6b97f093fc15685d)
* release 0.5.1.1:
  + Unix: [https://capnproto.org/capnproto-c++-0.5.1.1.tar.gz](https://capnproto.org/capnproto-c%2B%2B-0.5.1.1.tar.gz)
  + Windows: [https://capnproto.org/capnproto-c++-win32-0.5.1.1.zip](https://capnproto.org/capnproto-c%2B%2B-win32-0.5.1.1.zip)
* release 0.4.1.1:
  + Unix: [https://capnproto.org/capnproto-c++-0.4.1.1.tar.gz](https://capnproto.org/capnproto-c%2B%2B-0.4.1.1.tar.gz)
* release 0.6 (future)

# Details

The Cap'n Proto list pointer format allows encoding a list whose elements are
claimed each to have a size of zero. Such a list could claim to have up to
2^29-1 elements while only taking 8 or 16 bytes on the wire. The receiving
application may expect, say, a list of structs. A zero-size struct is a
perfectly legal (and, in fact, canonical) encoding for a struct whose fields
are all set to their default values. Therefore, the application may notice
nothing wrong and proceed to iterate through and handle each element in the
list, potentially taking a lot of time and resources to do so.

Note that this kind of vulnerability is very common in other systems. Any
system which accepts compressed input can allow an attacker to deliver an
arbitrarily large uncompressed message using very little compressed bandwidth.
Applications should do their own validation to ensure that lists and blobs
inside a message have reasonable size. However, Cap'n Proto takes the
philosophy that any security mistake that is likely to be common in
naively-written application code is in fact a bug in Cap'n Proto -- we should
provide defenses so that the application developer doesn't have to.

To fix the problem, this change institutes the policy that, for the purpose of
the "message traversal limit", a list of zero-sized elements will be counted as
if each element were instead one word wide. The message traversal limit is an
existing anti-amplification measure implemented by Cap'n Proto; see:

<https://capnproto.org/encoding.html#amplification-attack>

# Preventative measures

This problem was discovered through fuzz testing using American Fuzzy Lop,
which identified the problem as a "hang", although in fact the test case just
took a very long time to complete. We are incorporating testing with AFL into
our release process going forward.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.


